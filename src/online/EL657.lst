* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL657.cbl
* Options: int("EL657.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL657.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL657.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL657.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL657 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/14/96 12:01:06.
     7*                            VMOD=2.010.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL657.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION - EXH1 - REINSURANCE TABLES TEST CASE.
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 040208  IR2008032700001  PEMA  FIX LFPRM,AHPRM,LFBEN,AHBEN FLDS
    34******************************************************************
    35
    36 ENVIRONMENT DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL657.cbl
    38 DATA DIVISION.
    39 WORKING-STORAGE SECTION.
    40 01  DFH-START PIC X(04).
    41 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
    42 77  FILLER  PIC X(32)  VALUE '********************************'.
    43 77  FILLER  PIC X(32)  VALUE '*    EL657 WORKING STORAGE     *'.
    44 77  FILLER   PIC X(32) VALUE '******** VMOD=2.010 ************'.
    45
    46 77  INCR1                           PIC S999    VALUE +1  COMP-3.
    47 77  INCR2                           PIC S999    VALUE +1  COMP-3.
    48
    49 01  WS-WORK-AREA.
    50     05  WS-LF-PREMIUM-AMT           PIC S9(7)V99 VALUE ZEROS.
    51     05  WS-LF-BENEFIT-AMT           PIC S9(9)V99 VALUE ZEROS.
    52
    53 01  WS-DATE-AREA.
    54     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    55     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    56
    57*                                    COPY ELCREIN.
    58******************************************************************
    59*                                                                *
    60*                                                                *
    61*                            ELCREIN.                            *
    62*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    63*                            VMOD=2.006                          *
    64*                                                                *
    65*   DESCRIPTION:  CALCULATE REINSURANCE TEST CASE                *
    66*                                                                *
    67*  PASSED TO ELREIN                                              *
    68*  -----------------                                             *
    69*  TABLE CODE                                                    *
    70*  EFFECTIVE DATE                                                *
    71*  ISSUE AGE                                                     *
    72*  ORIGINAL TERM                                                 *
    73*  LIFE TYPE                                                     *
    74*  LIFE PREMIUM                                                  *
    75*  LIFE BENEFIT                                                  *
    76*  LIFE REFUND                                                   *
    77*  A/H  TYPE                                                     *
    78*  A/H  PREMIUM                                                  *
    79*  A/H  BENEFIT                                                  *
    80*  A/H  REFUND                                                   *
    81*  I/G  CODE                                                     *
    82*  CLAIM AMOUNT                                                  *
    83*                                                                *
    84*  RETURNED FROM ELREIN                                          *
    85*  --------------------                                          *
    86*  CEDED TO                                                      *
    87*  LIFE PREMIUM                                                  *
    88*  LIFE BENEFIT                                                  *
    89*  LIFE REFUND                                                   *
    90*  LIFE CLAIM                                                    *
    91*  A/H  PREMIUM                                                  *
    92*  A/H  BENEFIT                                                  *
    93*  A/H  REFUND                                                   *
    94*  A/H  CLAIM                                                    *
    95*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL657.cbl
    96******************************************************************
    97
    98 01  REINSURANCE-PASS-AREA.
    99     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +2868
   100                                     COMP.
   101
   102     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   103       88  NO-CP-ERROR                             VALUE ZERO.
   104       88  CP-ERROR-OCCURED                        VALUE '1'  '2'
   105                                                         '3'  '4'
   106                                                         '5'.
   107       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   108       88  CP-ERROR-IN-DATES                       VALUE '2'.
   109       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   110       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   111       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   112
   113***********************  INPUT AREAS ****************************
   114
   115     12  CP-CALCULATION-AREA.
   116         16  CP-TBCOD              PIC X(3).
   117         16  CP-COMPANY-CD         PIC X.
   118         16  CP-COMPANY-ID         PIC X(3).
   119         16  CP-EFF-DT             PIC XX.
   120         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   121                                     COMP-3.
   122         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   123                                     COMP-3.
   124         16  CP-LF-TYPE            PIC XX.
   125         16  CP-LF-PREM            PIC S9(7)V99      VALUE ZERO
   126                                     COMP-3.
   127         16  CP-LF-BEN             PIC S9(9)V99      VALUE ZERO
   128                                     COMP-3.
   129         16  CP-LF-REF             PIC S9(7)V99      VALUE ZERO
   130                                     COMP-3.
   131         16  CP-AH-TYPE            PIC XX.
   132         16  CP-AH-PREM            PIC S9(7)V99      VALUE ZERO
   133                                     COMP-3.
   134         16  CP-AH-BEN             PIC S9(7)V99      VALUE ZERO
   135                                     COMP-3.
   136         16  CP-AH-REF             PIC S9(7)V99      VALUE ZERO
   137                                     COMP-3.
   138         16  CP-CLAIM-AMT          PIC S9(9)V99      VALUE ZERO
   139                                     COMP-3.
   140         16  CP-IG-CODE            PIC X.
   141
   142         16  CP-LFPRM-ALT          PIC S9(07)V99     VALUE +0
   143                                     COMP-3.
   144         16  CP-LFAMT-ALT          PIC S9(09)V99     VALUE +0
   145                                     COMP-3.
   146         16  FILLER                PIC X(59).
   147
   148****************** OUTPUT AREA **********************************
   149     12  REIN-WORK-AREAS.
   150         16  RW-LFAMT        PIC S9(9)V99   VALUE +0    COMP-3.
   151         16  RW-AHWRK        PIC S9(7)V99   VALUE +0    COMP-3.
   152         16  RW-LFPRM        PIC S9(7)V99   VALUE +0    COMP-3.
   153         16  RW-LFPRMC       PIC S9(7)V99   VALUE +0    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL657.cbl
   154         16  RW-AHPRM        PIC S9(7)V99   VALUE +0    COMP-3.
   155         16  RW-AHPRMC       PIC S9(7)V99   VALUE +0    COMP-3.
   156         16  RW-LFCLMWK      PIC S9(9)V99   VALUE +0    COMP-3.
   157         16  RW-AHCLMWK      PIC S9(9)V99   VALUE +0    COMP-3.
   158         16  RW-LFCLM        PIC S9(9)V99   VALUE +0    COMP-3.
   159         16  RW-AHCLM        PIC S9(9)V99   VALUE +0    COMP-3.
   160         16  RW-AH-LIMIT     PIC S9(7)V99   VALUE +0    COMP-3.
   161         16  RW-LFIBNR       PIC S9(7)V99   VALUE +0    COMP-3.
   162         16  RW-LFPAYCUR     PIC S9(7)V99   VALUE +0    COMP-3.
   163         16  RW-LFFUTRSV     PIC S9(7)V99   VALUE +0    COMP-3.
   164         16  RW-AHIBNR       PIC S9(7)V99   VALUE +0    COMP-3.
   165         16  RW-AHPAYCUR     PIC S9(7)V99   VALUE +0    COMP-3.
   166         16  RW-AHFUTRSV     PIC S9(7)V99   VALUE +0    COMP-3.
   167         16  RW-LFIBNRWK     PIC S9(7)V99   VALUE +0    COMP-3.
   168         16  RW-LFPAYCURWK   PIC S9(7)V99   VALUE +0    COMP-3.
   169         16  RW-LFFUTRSVWK   PIC S9(7)V99   VALUE +0    COMP-3.
   170         16  RW-AHIBNRWK     PIC S9(7)V99   VALUE +0    COMP-3.
   171         16  RW-AHPAYCURWK   PIC S9(7)V99   VALUE +0    COMP-3.
   172         16  RW-AHFUTRSVWK   PIC S9(7)V99   VALUE +0    COMP-3.
   173         16  RW-AHLIM-LO     PIC S9(9)V99   VALUE +0    COMP-3.
   174         16  RW-AHLIM-HI     PIC S9(9)V99   VALUE +0    COMP-3.
   175         16  RW-ACCUM-LF     PIC S9(5)V99   VALUE +0    COMP-3.
   176         16  RW-ACCUM-AH     PIC S9(5)V99   VALUE +0    COMP-3.
   177         16  RW-ACCUM-CLM    PIC S9(5)V99   VALUE +0    COMP-3.
   178         16  RW-ACCUM-IBNR   PIC S9(5)V99   VALUE +0    COMP-3.
   179         16  RW-ACCUM-PAYCUR PIC S9(5)V99   VALUE +0    COMP-3.
   180         16  RW-ACCUM-FUTRSV PIC S9(5)V99   VALUE +0    COMP-3.
   181
   182     12  REIN-HOLD-AREAS.
   183         16  REIN-LEVELS                 OCCURS 30 TIMES.
   184             20  REIN-COMP.
   185                 24  REIN-CO-PRIME       PIC XXX.
   186                 24  REIN-CO-SUB         PIC XXX.
   187             20  REIN-LF-AH-FLGS.
   188                 24  REIN-LF-FLG         PIC X.
   189                 24  REIN-AH-FLG         PIC X.
   190
   191             20  REIN-WORK-FLDS.
   192                 24  REIN-LFAMT          PIC S9(9)V99   COMP-3.
   193                 24  REIN-LFPRM          PIC S9(7)V99   COMP-3.
   194                 24  REIN-AHAMT          PIC S9(7)V99   COMP-3.
   195                 24  REIN-AHPRM          PIC S9(7)V99   COMP-3.
   196                 24  REIN-LFRFND         PIC S9(7)V99   COMP-3.
   197                 24  REIN-AHRFND         PIC S9(7)V99   COMP-3.
   198                 24  REIN-LFCLM          PIC S9(9)V99   COMP-3.
   199                 24  REIN-AHCLM          PIC S9(9)V99   COMP-3.
   200                 24  REIN-LFCLML         PIC S9(9)V99   COMP-3.
   201                 24  REIN-AHCLML         PIC S9(9)V99   COMP-3.
   202                 24  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.
   203                 24  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.
   204                 24  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.
   205                 24  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.
   206                 24  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.
   207                 24  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.
   208                 24  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.
   209                 24  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.
   210                 24  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.
   211                 24  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL657.cbl
   212                 24  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.
   213                 24  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.
   214                 24  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.
   215                 24  REIN-REM-SW         PIC X.
   216                 24  REIN-REM-AH-100     PIC X.
   217     12  REIN-LEVELS-END                 PIC X(6).
   218
   219     12  RWF-FIELDS.
   220         16  RWF-LFAMT                   PIC S9(9)V99   COMP-3.
   221         16  RWF-LFPRM                   PIC S9(7)V99   COMP-3.
   222         16  RWF-AHAMT                   PIC S9(7)V99   COMP-3.
   223         16  RWF-AHPRM                   PIC S9(7)V99   COMP-3.
   224         16  RWF-LFRFND                  PIC S9(7)V99   COMP-3.
   225         16  RWF-AHRFND                  PIC S9(7)V99   COMP-3.
   226         16  RWF-LFCLM                   PIC S9(9)V99   COMP-3.
   227         16  RWF-AHCLM                   PIC S9(9)V99   COMP-3.
   228         16  RWF-LFCLML                  PIC S9(9)V99   COMP-3.
   229         16  RWF-AHCLML                  PIC S9(9)V99   COMP-3.
   230         16  RWF-DIS-IBNR                PIC S9(7)V99   COMP-3.
   231         16  RWF-DIS-PAYCUR              PIC S9(7)V99   COMP-3.
   232         16  RWF-DIS-FUTRSV              PIC S9(7)V99   COMP-3.
   233         16  RWF-DIS-IBNRL               PIC S9(7)V99   COMP-3.
   234         16  RWF-DIS-PAYCURL             PIC S9(7)V99   COMP-3.
   235         16  RWF-DIS-FUTRSVL             PIC S9(7)V99   COMP-3.
   236         16  RWF-DTH-IBNR                PIC S9(7)V99   COMP-3.
   237         16  RWF-DTH-PAYCUR              PIC S9(7)V99   COMP-3.
   238         16  RWF-DTH-FUTRSV              PIC S9(7)V99   COMP-3.
   239         16  RWF-DTH-IBNRL               PIC S9(7)V99   COMP-3.
   240         16  RWF-DTH-PAYCURL             PIC S9(7)V99   COMP-3.
   241         16  RWF-DTH-FUTRSVL             PIC S9(7)V99   COMP-3.
   242         16  RWF-AH-LIMIT                PIC S9(7)V99   COMP-3.
   243         16  RWF-REM-SW                  PIC X.
   244         16  RWF-REM-AH-100              PIC X.
   245
   246     12  WT-COMP-INFO.
   247         16  WT-REI-COMP.
   248             20  WT-REIN-PRIME           PIC XXX.
   249             20  WT-REIN-SUB             PIC XXX.
   250         16  WT-LF-QC                    PIC X.
   251         16  WT-AH-QC                    PIC X.
   252         16  WT-LO-DATE                  PIC 9(11)  COMP-3.
   253         16  WT-HI-DATE                  PIC 9(11)  COMP-3.
   254         16  WT-LFAGE-LO                 PIC 99.
   255         16  WT-LFAGE-HI                 PIC 99.
   256         16  WT-AHAGE-LO                 PIC 99.
   257         16  WT-AHAGE-HI                 PIC 99.
   258         16  WT-LFTRM-LO                 PIC S9(3)      COMP-3.
   259         16  WT-LFTRM-HI                 PIC S9(3)      COMP-3.
   260         16  WT-AHTRM-LO                 PIC S9(3)      COMP-3.
   261         16  WT-AHTRM-HI                 PIC S9(3)      COMP-3.
   262         16  WT-LF-PCT                   PIC S9V9999    COMP-3.
   263         16  WT-AH-PCT                   PIC S9V9999    COMP-3.
   264         16  WT-LF-LIM-LO                PIC S9(9)V99   COMP-3.
   265         16  WT-LF-LIM-HI                PIC S9(9)V99   COMP-3.
   266         16  WT-LF-LO                    PIC S9(9)V99   COMP-3.
   267         16  WT-LF-HI                    PIC S9(9)V99   COMP-3.
   268         16  WT-AHBEN-LIM-LO             PIC S9(7)V99   COMP-3.
   269         16  WT-AHBEN-LIM-HI             PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL657.cbl
   270         16  WT-AHBEN-LO                 PIC S9(7)V99   COMP-3.
   271         16  WT-AHBEN-HI                 PIC S9(7)V99   COMP-3.
   272         16  WT-AHMOA-LIM-LO             PIC S9(7)V99   COMP-3.
   273         16  WT-AHMOA-LIM-HI             PIC S9(7)V99   COMP-3.
   274         16  WT-AHMOA-LO                 PIC S9(7)V99   COMP-3.
   275         16  WT-AHMOA-HI                 PIC S9(7)V99   COMP-3.
   276         16  WT-LF-BEN-CODE              PIC X.
   277         16  WT-AH-BEN-CODE              PIC X.
   278         16  WT-INTERACTIVE              PIC X.
   279         16  WT-REMAINING                PIC X.
   280
   281     12  REIN-MISC-WORK-FIELDS.
   282         16  SUB1                    PIC S9(3)      COMP.
   283         16  SUB2                    PIC S9(3)      COMP.
   284         16  CO-SUB                  PIC S9(3)      COMP.
   285         16  REIN-FACTOR             PIC S99V9(7) COMP-3 VALUE +0.
   286         16  REIN-CALCED-LIFE        PIC S9(7)V99 COMP-3 VALUE +0.
   287         16  REIN-CALCED-AH          PIC S9(7)V99 COMP-3 VALUE +0.
   288
   289         16  REIN-SW-DTE             PIC  9(11)  COMP-3.
   290         16  REIN-OPEN-SW            PIC  X          VALUE SPACE.
   291         16  REIN-SEARCH.
   292             20  REIN-SRCH-CODE      PIC  X          VALUE SPACE.
   293             20  REIN-SRCH           PIC  XXX        VALUE SPACE.
   294         16  SAVE-REIN-SRCH          PIC  X(4)       VALUE SPACE.
   295         16  REIN-BUS-FLAG           PIC  X          VALUE SPACE.
   296         16  RATE-WORK               PIC S9(8)V9(5) COMP-3.
   297         16  RATE-WORK-L             PIC S9(8)V9(5) COMP-3.
   298         16  RATE-WORK-A             PIC S9(8)V9(5) COMP-3.
   299         16  REIN-WRK                PIC S9(7)V99   COMP-3.
   300         16  REIN-WRK-2              PIC S9(7)V99   COMP-3.
   301         16  RS-LIFE-BEN       PIC S9(9)V99   COMP-3    VALUE +0.
   302         16  RS-LIFE-PREM      PIC S9(7)V99   COMP-3    VALUE +0.
   303         16  RS-AH-BEN         PIC S9(7)V99   COMP-3    VALUE +0.
   304         16  RS-AH-PREM        PIC S9(7)V99   COMP-3    VALUE +0.
   305         16  RS-LP-CALC        PIC S9(7)V99   COMP-3    VALUE +0.
   306         16  RS-AP-CALC        PIC S9(7)V99   COMP-3    VALUE +0.
   307         16  RS-R-LB           PIC S9(9)V99   COMP-3    VALUE +0.
   308         16  RS-R-LP           PIC S9(7)V99   COMP-3    VALUE +0.
   309         16  RS-R-AB           PIC S9(9)V99   COMP-3    VALUE +0.
   310         16  RS-R-AP           PIC S9(7)V99   COMP-3    VALUE +0.
   311         16  RS-R-LPC          PIC S9(7)V99   COMP-3    VALUE +0.
   312         16  RS-R-APC          PIC S9(7)V99   COMP-3    VALUE +0.
   313
   314     12  REIN-CO-HOLD-TABLE.
   315         16  REIN-CO-HOLD-ENTRIES  OCCURS 200 TIMES.
   316             20  RCT-REIN-CO.
   317                 24  RCT-REIN-PRIME   PIC XXX.
   318                 24  RCT-REIN-SUB     PIC XXX.
   319             20  RCT-CLM-CUTOFF-DT    PIC 9(11)  COMP-3.
   320             20  RCT-LF-CLM-PCT       PIC S9V9(4)    COMP-3.
   321             20  RCT-LF-CLM-MAX       PIC S9(7)V99   COMP-3.
   322             20  RCT-AH-CLM-PCT       PIC S9V9(4)    COMP-3.
   323             20  RCT-AH-CLM-MAX       PIC S9(7)V99   COMP-3.
   324
   325     12  REIN-CO-TABLE-ENT-CNT     PIC S9(3) COMP-3    VALUE +200.
   326******************************************************************
   327
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL657.cbl
   329 01  STANDARD-AREAS.
   330     12  MAP-NAME                    PIC X(8)    VALUE 'EL657A'.
   331     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL657S'.
   332     12  TRANS-ID                    PIC X(4)    VALUE 'EXH1'.
   333     12  PGM-NAME                    PIC X(8)    VALUE SPACES.
   334     12  THIS-PGM                    PIC X(8)    VALUE 'EL657'.
   335     12  LINK-ELREIN                 PIC X(8)    VALUE 'ELREIN'.
   336     12  CERT-FILE-ID                PIC X(8)    VALUE 'ELCERT'.
   337     12  CNTL-FILE-ID                PIC X(8)    VALUE 'ELCNTL'.
   338     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   339     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   340     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   341     12  LINK-005                    PIC X(8)    VALUE 'EL005'.
   342     12  LINK-010                    PIC X(8)    VALUE 'EL010'.
   343     12  LINK-126                    PIC X(8)    VALUE 'EL126'.
   344     12  TIME-IN                     PIC S9(7).
   345     12  TIME-OUT-R   REDEFINES TIME-IN.
   346         16  FILLER                  PIC X.
   347         16  TIME-OUT                PIC 99V99.
   348         16  FILLER                  PIC XX.
   349     12  REIN-LENGTH                 PIC S9(4)   VALUE +4000 COMP.
   350     12  ITEM-VALUE                  PIC S9(4)   VALUE +1    COMP.
   351     12  QID.
   352         16  QID-TERM                PIC X(4).
   353         16  FILLER                  PIC X(4)    VALUE '657A'.
   354
   355 01  BLD-LINE.
   356     12  FILLER                      PIC X       VALUE SPACE.
   357     12  BL-CEDED                    PIC XXX.
   358     12  FILLER                      PIC X       VALUE SPACE.
   359     12  BL-CEDED-SUB                PIC XXX.
   360     12  FILLER                      PIC X(6)    VALUE SPACE.
   361     12  BL-LF-PREMIUM               PIC ZZZZ,ZZZ.ZZ.
   362     12  FILLER                      PIC XXX     VALUE SPACE.
   363     12  BL-LF-BENEFIT               PIC ZZZ,ZZZ,ZZZ.ZZ.
   364     12  FILLER                      PIC X(7)    VALUE SPACE.
   365     12  BL-AH-PREMIUM               PIC ZZZZ,ZZZ.ZZ.
   366     12  FILLER                      PIC XXX     VALUE SPACE.
   367     12  BL-AH-BENEFIT               PIC ZZZZ,ZZZ.ZZ.
   368     12  FILLER                      PIC X(5).
   369
   370 01  SAVE-REIN-WORK.
   371     12  REIN-SUB-1                  PIC S9(4)   VALUE +0   COMP.
   372     12  REIN-SUB-2                  PIC S9(4)   VALUE +0   COMP.
   373     12  REIN-MAX                    PIC S9(4)   VALUE +30  COMP.
   374     12  REIN-LOW-TIME               PIC 9(6)    VALUE  999999.
   375     12  REIN-LOW-SUB                PIC S9(4)   VALUE +1   COMP.
   376
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL657.cbl
   378 01  ERROR-MESSAGES.
   379     12  ER-0008                     PIC X(4)    VALUE '0008'.
   380     12  ER-0029                     PIC X(4)    VALUE '0029'.
   381     12  ER-0130                     PIC X(4)    VALUE '0130'.
   382     12  ER-0131                     PIC X(4)    VALUE '0131'.
   383     12  ER-0195                     PIC X(4)    VALUE '0195'.
   384     12  ER-0196                     PIC X(4)    VALUE '0196'.
   385     12  ER-0197                     PIC X(4)    VALUE '0197'.
   386     12  ER-0203                     PIC X(4)    VALUE '0203'.
   387     12  ER-0244                     PIC X(4)    VALUE '0244'.
   388     12  ER-2203                     PIC X(4)    VALUE '2203'.
   389     12  ER-2205                     PIC X(4)    VALUE '2205'.
   390     12  ER-2223                     PIC X(4)    VALUE '2223'.
   391     12  ER-2301                     PIC X(4)    VALUE '2301'.
   392     12  ER-2341                     PIC X(4)    VALUE '2341'.
   393     12  ER-2425                     PIC X(4)    VALUE '2425'.
   394     12  ER-2429                     PIC X(4)    VALUE '2429'.
   395     12  ER-2473                     PIC X(4)    VALUE '2473'.
   396     12  ER-2474                     PIC X(4)    VALUE '2474'.
   397     12  ER-2482                     PIC X(4)    VALUE '2482'.
   398     12  ER-2484                     PIC X(4)    VALUE '2484'.
   399     12  ER-2485                     PIC X(4)    VALUE '2485'.
   400     12  ER-2489                     PIC X(4)    VALUE '2489'.
   401     12  ER-2504                     PIC X(4)    VALUE '2504'.
   402     12  ER-2505                     PIC X(4)    VALUE '2505'.
   403     12  ER-2615                     PIC X(4)    VALUE '2615'.
   404
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL657.cbl
   406 01  MISC-WORK-AREAS.
   407     12  WS-CONTROL-PRIMARY.
   408       16  WS-COMPANY-CD             PIC X.
   409       16  WS-CARRIER                PIC X.
   410       16  WS-GROUPING               PIC X(6).
   411       16  WS-STATE                  PIC XX.
   412       16  WS-ACCOUNT                PIC X(10).
   413       16  WS-CERT-EFF-DT            PIC XX.
   414       16  WS-CERT-NO                PIC X(11).
   415
   416     12  WS-COMPANY-CODE             PIC S9(4)   VALUE +0   COMP.
   417     12  WS-COMPANY-CODE-R      REDEFINES WS-COMPANY-CODE.
   418         16  FILLER                  PIC X.
   419         16  WS-COMP-CD              PIC X.
   420
   421     12  TEXT-AREA                   PIC X(66).
   422     12  TEXT-LENGTH                 PIC S9(4)   VALUE +66  COMP.
   423
   424 01  TEXT-MESSAGES.
   425     12  TRAN-COMPLETE-MSG.
   426         16  FILLER                  PIC X(45)
   427           VALUE '     CLEAR ENTERED - SESSION ENDED'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL657.cbl
   429*                                    COPY ELCDATE.
   430******************************************************************
   431*                                                                *
   432*                                                                *
   433*                            ELCDATE.                            *
   434*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   435*                            VMOD=2.003
   436*                                                                *
   437*                                                                *
   438*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   439*                 LENGTH = 200                                   *
   440******************************************************************
   441
   442 01  DATE-CONVERSION-DATA.
   443     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   444     12  DC-OPTION-CODE                PIC X.
   445         88  BIN-TO-GREG                VALUE ' '.
   446         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   447         88  EDIT-GREG-TO-BIN           VALUE '2'.
   448         88  YMD-GREG-TO-BIN            VALUE '3'.
   449         88  MDY-GREG-TO-BIN            VALUE '4'.
   450         88  JULIAN-TO-BIN              VALUE '5'.
   451         88  BIN-PLUS-ELAPSED           VALUE '6'.
   452         88  FIND-CENTURY               VALUE '7'.
   453         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   454         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   455         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   456         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   457         88  JULIAN-TO-BIN-3            VALUE 'C'.
   458         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   459         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   460         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   461         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   462         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   463         88  CHECK-LEAP-YEAR            VALUE 'H'.
   464         88  BIN-3-TO-GREG              VALUE 'I'.
   465         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   466         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   467         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   468         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   469         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   470         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   471         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   472         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   473         88  THREE-CHARACTER-BIN
   474                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   475         88  GREGORIAN-TO-BIN
   476                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   477         88  BIN-TO-GREGORIAN
   478                  VALUES ' ' '1' 'I' '8' 'G'.
   479         88  JULIAN-TO-BINARY
   480                  VALUES '5' 'C' 'E' 'F'.
   481     12  DC-ERROR-CODE                 PIC X.
   482         88  NO-CONVERSION-ERROR        VALUE ' '.
   483         88  DATE-CONVERSION-ERROR
   484                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   485         88  DATE-IS-ZERO               VALUE '1'.
   486         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL657.cbl
   487         88  DATE-IS-INVALID            VALUE '3'.
   488         88  DATE1-GREATER-DATE2        VALUE '4'.
   489         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   490         88  DATE-INVALID-OPTION        VALUE '9'.
   491         88  INVALID-CENTURY            VALUE 'A'.
   492         88  ONLY-CENTURY               VALUE 'B'.
   493         88  ONLY-LEAP-YEAR             VALUE 'C'.
   494         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   495     12  DC-END-OF-MONTH               PIC X.
   496         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   497     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   498         88  USE-NORMAL-PROCESS         VALUE ' '.
   499         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   500         88  ADJUST-UP-100-YRS          VALUE '2'.
   501     12  FILLER                        PIC X.
   502     12  DC-CONVERSION-DATES.
   503         16  DC-BIN-DATE-1             PIC XX.
   504         16  DC-BIN-DATE-2             PIC XX.
   505         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   506         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   507                       DC-GREG-DATE-1-EDIT.
   508             20  DC-EDIT1-MONTH        PIC 99.
   509             20  SLASH1-1              PIC X.
   510             20  DC-EDIT1-DAY          PIC 99.
   511             20  SLASH1-2              PIC X.
   512             20  DC-EDIT1-YEAR         PIC 99.
   513         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   514         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   515                     DC-GREG-DATE-2-EDIT.
   516             20  DC-EDIT2-MONTH        PIC 99.
   517             20  SLASH2-1              PIC X.
   518             20  DC-EDIT2-DAY          PIC 99.
   519             20  SLASH2-2              PIC X.
   520             20  DC-EDIT2-YEAR         PIC 99.
   521         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   522         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   523                     DC-GREG-DATE-1-YMD.
   524             20  DC-YMD-YEAR           PIC 99.
   525             20  DC-YMD-MONTH          PIC 99.
   526             20  DC-YMD-DAY            PIC 99.
   527         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   528         16  DC-GREG-DATE-1-MDY-R REDEFINES
   529                      DC-GREG-DATE-1-MDY.
   530             20  DC-MDY-MONTH          PIC 99.
   531             20  DC-MDY-DAY            PIC 99.
   532             20  DC-MDY-YEAR           PIC 99.
   533         16  DC-GREG-DATE-1-ALPHA.
   534             20  DC-ALPHA-MONTH        PIC X(10).
   535             20  DC-ALPHA-DAY          PIC 99.
   536             20  FILLER                PIC XX.
   537             20  DC-ALPHA-CENTURY.
   538                 24 DC-ALPHA-CEN-N     PIC 99.
   539             20  DC-ALPHA-YEAR         PIC 99.
   540         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   541         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   542         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   543         16  DC-JULIAN-DATE            PIC 9(05).
   544         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL657.cbl
   545                                       PIC 9(05).
   546         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   547             20  DC-JULIAN-YEAR        PIC 99.
   548             20  DC-JULIAN-DAYS        PIC 999.
   549         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   550         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   551         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   552     12  DATE-CONVERSION-VARIBLES.
   553         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   554         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   555             20  FILLER                PIC 9(3).
   556             20  HOLD-CEN-1-CCYY.
   557                 24  HOLD-CEN-1-CC     PIC 99.
   558                 24  HOLD-CEN-1-YY     PIC 99.
   559             20  HOLD-CEN-1-MO         PIC 99.
   560             20  HOLD-CEN-1-DA         PIC 99.
   561         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   562             20  HOLD-CEN-1-R-MO       PIC 99.
   563             20  HOLD-CEN-1-R-DA       PIC 99.
   564             20  HOLD-CEN-1-R-CCYY.
   565                 24  HOLD-CEN-1-R-CC   PIC 99.
   566                 24  HOLD-CEN-1-R-YY   PIC 99.
   567             20  FILLER                PIC 9(3).
   568         16  HOLD-CENTURY-1-X.
   569             20  FILLER                PIC X(3)  VALUE SPACES.
   570             20  HOLD-CEN-1-X-CCYY.
   571                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   572                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   573             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   574             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   575         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   576             20  HOLD-CEN-1-R-X-MO     PIC XX.
   577             20  HOLD-CEN-1-R-X-DA     PIC XX.
   578             20  HOLD-CEN-1-R-X-CCYY.
   579                 24  HOLD-CEN-1-R-X-CC PIC XX.
   580                 24  HOLD-CEN-1-R-X-YY PIC XX.
   581             20  FILLER                PIC XXX.
   582         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   583         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   584         16  DC-JULIAN-DATE-1          PIC 9(07).
   585         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   586             20  DC-JULIAN-1-CCYY.
   587                 24  DC-JULIAN-1-CC    PIC 99.
   588                 24  DC-JULIAN-1-YR    PIC 99.
   589             20  DC-JULIAN-DA-1        PIC 999.
   590         16  DC-JULIAN-DATE-2          PIC 9(07).
   591         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   592             20  DC-JULIAN-2-CCYY.
   593                 24  DC-JULIAN-2-CC    PIC 99.
   594                 24  DC-JULIAN-2-YR    PIC 99.
   595             20  DC-JULIAN-DA-2        PIC 999.
   596         16  DC-GREG-DATE-A-EDIT.
   597             20  DC-EDITA-MONTH        PIC 99.
   598             20  SLASHA-1              PIC X VALUE '/'.
   599             20  DC-EDITA-DAY          PIC 99.
   600             20  SLASHA-2              PIC X VALUE '/'.
   601             20  DC-EDITA-CCYY.
   602                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL657.cbl
   603                 24  DC-EDITA-YEAR     PIC 99.
   604         16  DC-GREG-DATE-B-EDIT.
   605             20  DC-EDITB-MONTH        PIC 99.
   606             20  SLASHB-1              PIC X VALUE '/'.
   607             20  DC-EDITB-DAY          PIC 99.
   608             20  SLASHB-2              PIC X VALUE '/'.
   609             20  DC-EDITB-CCYY.
   610                 24  DC-EDITB-CENT     PIC 99.
   611                 24  DC-EDITB-YEAR     PIC 99.
   612         16  DC-GREG-DATE-CYMD         PIC 9(08).
   613         16  DC-GREG-DATE-CYMD-R REDEFINES
   614                              DC-GREG-DATE-CYMD.
   615             20  DC-CYMD-CEN           PIC 99.
   616             20  DC-CYMD-YEAR          PIC 99.
   617             20  DC-CYMD-MONTH         PIC 99.
   618             20  DC-CYMD-DAY           PIC 99.
   619         16  DC-GREG-DATE-MDCY         PIC 9(08).
   620         16  DC-GREG-DATE-MDCY-R REDEFINES
   621                              DC-GREG-DATE-MDCY.
   622             20  DC-MDCY-MONTH         PIC 99.
   623             20  DC-MDCY-DAY           PIC 99.
   624             20  DC-MDCY-CEN           PIC 99.
   625             20  DC-MDCY-YEAR          PIC 99.
   626    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   627        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   628    12  DC-EL310-DATE                  PIC X(21).
   629    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL657.cbl
   631*                                    COPY ELCATTR.
   632******************************************************************
   633*                                                                *
   634*                            ELCATTR.                            *
   635*                            VMOD=2.001                          *
   636*                                                                *
   637*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   638*                                                                *
   639*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   640*                                                                *
   641*                   POS 1   P=PROTECTED                          *
   642*                           U=UNPROTECTED                        *
   643*                           S=ASKIP                              *
   644*                   POS 2   A=ALPHA/NUMERIC                      *
   645*                           N=NUMERIC                            *
   646*                   POS 3   N=NORMAL                             *
   647*                           B=BRIGHT                             *
   648*                           D=DARK                               *
   649*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   650*                           OF=MODIFIED DATA TAG OFF             *
   651*                                                                *
   652*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   653******************************************************************
   654 01  ATTRIBUTE-LIST.
   655     12  AL-PABOF            PIC X       VALUE 'Y'.
   656     12  AL-PABON            PIC X       VALUE 'Z'.
   657     12  AL-PADOF            PIC X       VALUE '%'.
   658     12  AL-PADON            PIC X       VALUE '_'.
   659     12  AL-PANOF            PIC X       VALUE '-'.
   660     12  AL-PANON            PIC X       VALUE '/'.
   661     12  AL-SABOF            PIC X       VALUE '8'.
   662     12  AL-SABON            PIC X       VALUE '9'.
   663     12  AL-SADOF            PIC X       VALUE '@'.
   664     12  AL-SADON            PIC X       VALUE QUOTE.
   665     12  AL-SANOF            PIC X       VALUE '0'.
   666     12  AL-SANON            PIC X       VALUE '1'.
   667     12  AL-UABOF            PIC X       VALUE 'H'.
   668     12  AL-UABON            PIC X       VALUE 'I'.
   669     12  AL-UADOF            PIC X       VALUE '<'.
   670     12  AL-UADON            PIC X       VALUE '('.
   671     12  AL-UANOF            PIC X       VALUE ' '.
   672     12  AL-UANON            PIC X       VALUE 'A'.
   673     12  AL-UNBOF            PIC X       VALUE 'Q'.
   674     12  AL-UNBON            PIC X       VALUE 'R'.
   675     12  AL-UNDOF            PIC X       VALUE '*'.
   676     12  AL-UNDON            PIC X       VALUE ')'.
   677     12  AL-UNNOF            PIC X       VALUE '&'.
   678     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL657.cbl
   680*                                    COPY ELCEMIB.
   681******************************************************************
   682*                                                                *
   683*                                                                *
   684*                            ELCEMIB.                            *
   685*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   686*                            VMOD=2.005                          *
   687*                                                                *
   688*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   689*                                                                *
   690******************************************************************
   691 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   692     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   693     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   694     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   695     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   696     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   697     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   698     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   699     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   700     12  EMI-SWITCH1             PIC X        VALUE '1'.
   701         88  EMI-NO-ERRORS                    VALUE '1'.
   702         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   703         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   704     12  EMI-SWITCH2             PIC X        VALUE '1'.
   705         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   706     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   707         88  EMI-AREA1-EMPTY                  VALUE '1'.
   708         88  EMI-AREA1-FULL                   VALUE '2'.
   709     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   710         88  EMI-AREA2-EMPTY                  VALUE '1'.
   711         88  EMI-AREA2-FULL                   VALUE '2'.
   712     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   713         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   714         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   715         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   716         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   717         88  EMI-BYPASS-FATALS                VALUE 'X'.
   718     12  EMI-ERROR-LINES.
   719         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   720         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   721         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   722         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   723             20  EMI-ERR-CODES OCCURS 10 TIMES.
   724                 24  EMI-ERR-NUM         PIC X(4).
   725                 24  EMI-FILLER          PIC X.
   726                 24  EMI-SEV             PIC X.
   727                 24  FILLER              PIC X.
   728             20  FILLER                  PIC X(02).
   729     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   730         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   731             20  EMI-ERROR-NUMBER    PIC X(4).
   732             20  EMI-FILL            PIC X.
   733             20  EMI-SEVERITY        PIC X.
   734             20  FILLER              PIC X.
   735             20  EMI-ERROR-TEXT.
   736                 24  EMI-TEXT-VARIABLE   PIC X(10).
   737                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL657.cbl
   738     12  EMI-SEVERITY-SAVE           PIC X.
   739         88  EMI-NOTE                    VALUE 'N'.
   740         88  EMI-WARNING                 VALUE 'W'.
   741         88  EMI-FORCABLE                VALUE 'F'.
   742         88  EMI-FATAL                   VALUE 'X'.
   743     12  EMI-MESSAGE-FLAG            PIC X.
   744         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   745         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   746     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   747     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   748         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   749         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   750         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   751     12  FILLER                      PIC X(137)  VALUE SPACES.
   752     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   753     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   754     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   755     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL657.cbl
   757*                                    COPY ELCAID.
   758******************************************************************
   759*                                                                *
   760*                            ELCAID.                             *
   761*                            VMOD=2.001                          *
   762*                                                                *
   763*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   764*                                                                *
   765*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   766*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   767******************************************************************
   768
   769 01  DFHAID.
   770   02  DFHNULL   PIC  X  VALUE  ' '.
   771   02  DFHENTER  PIC  X  VALUE  QUOTE.
   772   02  DFHCLEAR  PIC  X  VALUE  '_'.
   773   02  DFHPEN    PIC  X  VALUE  '='.
   774   02  DFHOPID   PIC  X  VALUE  'W'.
   775   02  DFHPA1    PIC  X  VALUE  '%'.
   776   02  DFHPA2    PIC  X  VALUE  '>'.
   777   02  DFHPA3    PIC  X  VALUE  ','.
   778   02  DFHPF1    PIC  X  VALUE  '1'.
   779   02  DFHPF2    PIC  X  VALUE  '2'.
   780   02  DFHPF3    PIC  X  VALUE  '3'.
   781   02  DFHPF4    PIC  X  VALUE  '4'.
   782   02  DFHPF5    PIC  X  VALUE  '5'.
   783   02  DFHPF6    PIC  X  VALUE  '6'.
   784   02  DFHPF7    PIC  X  VALUE  '7'.
   785   02  DFHPF8    PIC  X  VALUE  '8'.
   786   02  DFHPF9    PIC  X  VALUE  '9'.
   787   02  DFHPF10   PIC  X  VALUE  ':'.
   788   02  DFHPF11   PIC  X  VALUE  '#'.
   789   02  DFHPF12   PIC  X  VALUE  '@'.
   790   02  DFHPF13   PIC  X  VALUE  'A'.
   791   02  DFHPF14   PIC  X  VALUE  'B'.
   792   02  DFHPF15   PIC  X  VALUE  'C'.
   793   02  DFHPF16   PIC  X  VALUE  'D'.
   794   02  DFHPF17   PIC  X  VALUE  'E'.
   795   02  DFHPF18   PIC  X  VALUE  'F'.
   796   02  DFHPF19   PIC  X  VALUE  'G'.
   797   02  DFHPF20   PIC  X  VALUE  'H'.
   798   02  DFHPF21   PIC  X  VALUE  'I'.
   799*00039    02  DFHPF22   PIC  X  VALUE  ''.
   800   02  DFHPF22   PIC  X  VALUE  '['.
   801   02  DFHPF23   PIC  X  VALUE  '.'.
   802   02  DFHPF24   PIC  X  VALUE  '<'.
   803   02  DFHMSRE   PIC  X  VALUE  'X'.
   804   02  DFHSTRF   PIC  X  VALUE  'h'.
   805   02  DFHTRIG   PIC  X  VALUE  '"'.
   806
   807 01  FILLER REDEFINES DFHAID.
   808     05  FILLER                      PIC X(8).
   809     05  PF-VALUES                   PIC X  OCCURS 24.
   810
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL657.cbl
   812*                                    COPY ELCLOGOF.
   813******************************************************************
   814*                                                                *
   815*                                                                *
   816*                            ELCLOGOF.                           *
   817*                            VMOD=2.001                          *
   818*                                                                *
   819*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   820*                                                                *
   821******************************************************************
   822 01  CLASIC-LOGOFF.
   823     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   824     12  LOGOFF-TEXT.
   825         16  FILLER          PIC X(5)    VALUE SPACES.
   826         16  LOGOFF-MSG.
   827             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   828             20  FILLER      PIC X       VALUE SPACES.
   829             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   830         16  FILLER          PIC X(80)
   831           VALUE '* YOU ARE NOW LOGGED OFF'.
   832         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   833         16  FILLER          PIC X       VALUE QUOTE.
   834         16  LOGOFF-SYS-MSG  PIC X(17)
   835           VALUE 'S CLAS-IC SYSTEM '.
   836     12  TEXT-MESSAGES.
   837         16  UNACCESS-MSG    PIC X(29)
   838             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   839         16  PGMIDERR-MSG    PIC X(17)
   840             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL657.cbl
   842*                                    COPY EL657S.
   843 01  EL657AI.
   844     05  FILLER            PIC  X(0012).
   845*    -------------------------------
   846     05  DATEL PIC S9(0004) COMP.
   847     05  DATEF PIC  X(0001).
   848     05  FILLER REDEFINES DATEF.
   849         10  DATEA PIC  X(0001).
   850     05  DATEI PIC  X(0008).
   851*    -------------------------------
   852     05  TIMEL PIC S9(0004) COMP.
   853     05  TIMEF PIC  X(0001).
   854     05  FILLER REDEFINES TIMEF.
   855         10  TIMEA PIC  X(0001).
   856     05  TIMEI PIC  X(0005).
   857*    -------------------------------
   858     05  TBCODL PIC S9(0004) COMP.
   859     05  TBCODF PIC  X(0001).
   860     05  FILLER REDEFINES TBCODF.
   861         10  TBCODA PIC  X(0001).
   862     05  TBCODI PIC  X(0003).
   863*    -------------------------------
   864     05  EFFDTL PIC S9(0004) COMP.
   865     05  EFFDTF PIC  X(0001).
   866     05  FILLER REDEFINES EFFDTF.
   867         10  EFFDTA PIC  X(0001).
   868     05  EFFDTI PIC  X(0006).
   869*    -------------------------------
   870     05  LFHDG1L PIC S9(0004) COMP.
   871     05  LFHDG1F PIC  X(0001).
   872     05  FILLER REDEFINES LFHDG1F.
   873         10  LFHDG1A PIC  X(0001).
   874     05  LFHDG1I PIC  X(0002).
   875*    -------------------------------
   876     05  LFTYPL PIC S9(0004) COMP.
   877     05  LFTYPF PIC  X(0001).
   878     05  FILLER REDEFINES LFTYPF.
   879         10  LFTYPA PIC  X(0001).
   880     05  LFTYPI PIC  X(0002).
   881*    -------------------------------
   882     05  LFHDG2L PIC S9(0004) COMP.
   883     05  LFHDG2F PIC  X(0001).
   884     05  FILLER REDEFINES LFHDG2F.
   885         10  LFHDG2A PIC  X(0001).
   886     05  LFHDG2I PIC  X(0002).
   887*    -------------------------------
   888     05  LFPRML PIC S9(0004) COMP.
   889     05  LFPRMF PIC  X(0001).
   890     05  FILLER REDEFINES LFPRMF.
   891         10  LFPRMA PIC  X(0001).
   892     05  LFPRMI PIC  9(9)V99.
   893*    -------------------------------
   894     05  LFHDG3L PIC S9(0004) COMP.
   895     05  LFHDG3F PIC  X(0001).
   896     05  FILLER REDEFINES LFHDG3F.
   897         10  LFHDG3A PIC  X(0001).
   898     05  LFHDG3I PIC  X(0002).
   899*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL657.cbl
   900     05  LFBENL PIC S9(0004) COMP.
   901     05  LFBENF PIC  X(0001).
   902     05  FILLER REDEFINES LFBENF.
   903         10  LFBENA PIC  X(0001).
   904     05  LFBENI PIC  9(12)V99.
   905*    -------------------------------
   906     05  ORIGTRML PIC S9(0004) COMP.
   907     05  ORIGTRMF PIC  X(0001).
   908     05  FILLER REDEFINES ORIGTRMF.
   909         10  ORIGTRMA PIC  X(0001).
   910     05  ORIGTRMI PIC  9(3).
   911*    -------------------------------
   912     05  IGCODEL PIC S9(0004) COMP.
   913     05  IGCODEF PIC  X(0001).
   914     05  FILLER REDEFINES IGCODEF.
   915         10  IGCODEA PIC  X(0001).
   916     05  IGCODEI PIC  X(0001).
   917*    -------------------------------
   918     05  ISSAGEL PIC S9(0004) COMP.
   919     05  ISSAGEF PIC  X(0001).
   920     05  FILLER REDEFINES ISSAGEF.
   921         10  ISSAGEA PIC  X(0001).
   922     05  ISSAGEI PIC  X(0002).
   923*    -------------------------------
   924     05  AHHDG1L PIC S9(0004) COMP.
   925     05  AHHDG1F PIC  X(0001).
   926     05  FILLER REDEFINES AHHDG1F.
   927         10  AHHDG1A PIC  X(0001).
   928     05  AHHDG1I PIC  X(0002).
   929*    -------------------------------
   930     05  AHTYPL PIC S9(0004) COMP.
   931     05  AHTYPF PIC  X(0001).
   932     05  FILLER REDEFINES AHTYPF.
   933         10  AHTYPA PIC  X(0001).
   934     05  AHTYPI PIC  X(0002).
   935*    -------------------------------
   936     05  AHHDG2L PIC S9(0004) COMP.
   937     05  AHHDG2F PIC  X(0001).
   938     05  FILLER REDEFINES AHHDG2F.
   939         10  AHHDG2A PIC  X(0001).
   940     05  AHHDG2I PIC  X(0002).
   941*    -------------------------------
   942     05  AHPRML PIC S9(0004) COMP.
   943     05  AHPRMF PIC  X(0001).
   944     05  FILLER REDEFINES AHPRMF.
   945         10  AHPRMA PIC  X(0001).
   946     05  AHPRMI PIC  9(9)V99.
   947*    -------------------------------
   948     05  AHHDG3L PIC S9(0004) COMP.
   949     05  AHHDG3F PIC  X(0001).
   950     05  FILLER REDEFINES AHHDG3F.
   951         10  AHHDG3A PIC  X(0001).
   952     05  AHHDG3I PIC  X(0002).
   953*    -------------------------------
   954     05  AHBENL PIC S9(0004) COMP.
   955     05  AHBENF PIC  X(0001).
   956     05  FILLER REDEFINES AHBENF.
   957         10  AHBENA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL657.cbl
   958     05  AHBENI PIC  9(9)V99.
   959*    -------------------------------
   960     05  CARRL PIC S9(0004) COMP.
   961     05  CARRF PIC  X(0001).
   962     05  FILLER REDEFINES CARRF.
   963         10  CARRA PIC  X(0001).
   964     05  CARRI PIC  X(0001).
   965*    -------------------------------
   966     05  GROUPL PIC S9(0004) COMP.
   967     05  GROUPF PIC  X(0001).
   968     05  FILLER REDEFINES GROUPF.
   969         10  GROUPA PIC  X(0001).
   970     05  GROUPI PIC  X(0006).
   971*    -------------------------------
   972     05  STATEL PIC S9(0004) COMP.
   973     05  STATEF PIC  X(0001).
   974     05  FILLER REDEFINES STATEF.
   975         10  STATEA PIC  X(0001).
   976     05  STATEI PIC  X(0002).
   977*    -------------------------------
   978     05  ACCTL PIC S9(0004) COMP.
   979     05  ACCTF PIC  X(0001).
   980     05  FILLER REDEFINES ACCTF.
   981         10  ACCTA PIC  X(0001).
   982     05  ACCTI PIC  X(0010).
   983*    -------------------------------
   984     05  CERTL PIC S9(0004) COMP.
   985     05  CERTF PIC  X(0001).
   986     05  FILLER REDEFINES CERTF.
   987         10  CERTA PIC  X(0001).
   988     05  CERTI PIC  X(0011).
   989*    -------------------------------
   990     05  CEFDTL PIC S9(0004) COMP.
   991     05  CEFDTF PIC  X(0001).
   992     05  FILLER REDEFINES CEFDTF.
   993         10  CEFDTA PIC  X(0001).
   994     05  CEFDTI PIC  X(0006).
   995*    -------------------------------
   996     05  LFHDG4L PIC S9(0004) COMP.
   997     05  LFHDG4F PIC  X(0001).
   998     05  FILLER REDEFINES LFHDG4F.
   999         10  LFHDG4A PIC  X(0001).
  1000     05  LFHDG4I PIC  X(0002).
  1001*    -------------------------------
  1002     05  LFHDG5L PIC S9(0004) COMP.
  1003     05  LFHDG5F PIC  X(0001).
  1004     05  FILLER REDEFINES LFHDG5F.
  1005         10  LFHDG5A PIC  X(0001).
  1006     05  LFHDG5I PIC  X(0002).
  1007*    -------------------------------
  1008     05  AHHDG4L PIC S9(0004) COMP.
  1009     05  AHHDG4F PIC  X(0001).
  1010     05  FILLER REDEFINES AHHDG4F.
  1011         10  AHHDG4A PIC  X(0001).
  1012     05  AHHDG4I PIC  X(0002).
  1013*    -------------------------------
  1014     05  AHHDG5L PIC S9(0004) COMP.
  1015     05  AHHDG5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL657.cbl
  1016     05  FILLER REDEFINES AHHDG5F.
  1017         10  AHHDG5A PIC  X(0001).
  1018     05  AHHDG5I PIC  X(0002).
  1019     05  REPLINED OCCURS 10  TIMES.
  1020*    -------------------------------
  1021         10  REPLINEL PIC S9(0004) COMP.
  1022         10  REPLINEF PIC  X(0001).
  1023         10  FILLER REDEFINES REPLINEF.
  1024             15  REPLINEA PIC  X(0001).
  1025         10  REPLINEI PIC  X(0079).
  1026*    -------------------------------
  1027     05  MSGL PIC S9(0004) COMP.
  1028     05  MSGF PIC  X(0001).
  1029     05  FILLER REDEFINES MSGF.
  1030         10  MSGA PIC  X(0001).
  1031     05  MSGI PIC  X(0079).
  1032*    -------------------------------
  1033     05  PFKEYL PIC S9(0004) COMP.
  1034     05  PFKEYF PIC  X(0001).
  1035     05  FILLER REDEFINES PFKEYF.
  1036         10  PFKEYA PIC  X(0001).
  1037     05  PFKEYI PIC  99.
  1038 01  EL657AO REDEFINES EL657AI.
  1039     05  FILLER            PIC  X(0012).
  1040*    -------------------------------
  1041     05  FILLER            PIC  X(0003).
  1042     05  DATEO PIC  X(0008).
  1043*    -------------------------------
  1044     05  FILLER            PIC  X(0003).
  1045     05  TIMEO PIC  99.99.
  1046*    -------------------------------
  1047     05  FILLER            PIC  X(0003).
  1048     05  TBCODO PIC  X(0003).
  1049*    -------------------------------
  1050     05  FILLER            PIC  X(0003).
  1051     05  EFFDTO PIC  X(0006).
  1052*    -------------------------------
  1053     05  FILLER            PIC  X(0003).
  1054     05  LFHDG1O PIC  X(0002).
  1055*    -------------------------------
  1056     05  FILLER            PIC  X(0003).
  1057     05  LFTYPO PIC  X(0002).
  1058*    -------------------------------
  1059     05  FILLER            PIC  X(0003).
  1060     05  LFHDG2O PIC  X(0002).
  1061*    -------------------------------
  1062     05  FILLER            PIC  X(0003).
  1063     05  LFPRMO PIC  ZZZZ,ZZ9.99.
  1064*    -------------------------------
  1065     05  FILLER            PIC  X(0003).
  1066     05  LFHDG3O PIC  X(0002).
  1067*    -------------------------------
  1068     05  FILLER            PIC  X(0003).
  1069     05  LFBENO PIC  ZZZ,ZZZ,ZZ9.99.
  1070*    -------------------------------
  1071     05  FILLER            PIC  X(0003).
  1072     05  ORIGTRMO PIC  ZZ9.
  1073*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL657.cbl
  1074     05  FILLER            PIC  X(0003).
  1075     05  IGCODEO PIC  X(0001).
  1076*    -------------------------------
  1077     05  FILLER            PIC  X(0003).
  1078     05  ISSAGEO PIC  X(0002).
  1079*    -------------------------------
  1080     05  FILLER            PIC  X(0003).
  1081     05  AHHDG1O PIC  X(0002).
  1082*    -------------------------------
  1083     05  FILLER            PIC  X(0003).
  1084     05  AHTYPO PIC  X(0002).
  1085*    -------------------------------
  1086     05  FILLER            PIC  X(0003).
  1087     05  AHHDG2O PIC  X(0002).
  1088*    -------------------------------
  1089     05  FILLER            PIC  X(0003).
  1090     05  AHPRMO PIC  ZZZZ,ZZ9.99.
  1091*    -------------------------------
  1092     05  FILLER            PIC  X(0003).
  1093     05  AHHDG3O PIC  X(0002).
  1094*    -------------------------------
  1095     05  FILLER            PIC  X(0003).
  1096     05  AHBENO PIC  ZZZZ,ZZ9.99.
  1097*    -------------------------------
  1098     05  FILLER            PIC  X(0003).
  1099     05  CARRO PIC  X(0001).
  1100*    -------------------------------
  1101     05  FILLER            PIC  X(0003).
  1102     05  GROUPO PIC  X(0006).
  1103*    -------------------------------
  1104     05  FILLER            PIC  X(0003).
  1105     05  STATEO PIC  X(0002).
  1106*    -------------------------------
  1107     05  FILLER            PIC  X(0003).
  1108     05  ACCTO PIC  X(0010).
  1109*    -------------------------------
  1110     05  FILLER            PIC  X(0003).
  1111     05  CERTO PIC  X(0011).
  1112*    -------------------------------
  1113     05  FILLER            PIC  X(0003).
  1114     05  CEFDTO PIC  X(0006).
  1115*    -------------------------------
  1116     05  FILLER            PIC  X(0003).
  1117     05  LFHDG4O PIC  X(0002).
  1118*    -------------------------------
  1119     05  FILLER            PIC  X(0003).
  1120     05  LFHDG5O PIC  X(0002).
  1121*    -------------------------------
  1122     05  FILLER            PIC  X(0003).
  1123     05  AHHDG4O PIC  X(0002).
  1124*    -------------------------------
  1125     05  FILLER            PIC  X(0003).
  1126     05  AHHDG5O PIC  X(0002).
  1127*    -------------------------------
  1128     05  REPLINED OCCURS 10  TIMES.
  1129         10  FILLER        PIC  X(0003).
  1130         10  REPLINEO PIC  X(0079).
  1131*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL657.cbl
  1132     05  FILLER            PIC  X(0003).
  1133     05  MSGO PIC  X(0079).
  1134*    -------------------------------
  1135     05  FILLER            PIC  X(0003).
  1136     05  PFKEYO PIC  99.
  1137*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL657.cbl
  1139*                                    COPY ELCINTF.
  1140******************************************************************
  1141*                                                                *
  1142*                                                                *
  1143*                            ELCINTF.                            *
  1144*                            VMOD=2.017                          *
  1145*                                                                *
  1146*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1147*                                                                *
  1148*       LENGTH = 1024                                            *
  1149*                                                                *
  1150******************************************************************
  1151 01  PROGRAM-INTERFACE-BLOCK.
  1152     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1153     12  PI-CALLING-PROGRAM              PIC X(8).
  1154     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1155     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1156     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1157     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1158     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1159     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1160     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1161     12  PI-COMPANY-ID                   PIC XXX.
  1162     12  PI-COMPANY-CD                   PIC X.
  1163
  1164     12  PI-COMPANY-PASSWORD             PIC X(8).
  1165
  1166     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1167
  1168     12  PI-CONTROL-IN-PROGRESS.
  1169         16  PI-CARRIER                  PIC X.
  1170         16  PI-GROUPING                 PIC X(6).
  1171         16  PI-STATE                    PIC XX.
  1172         16  PI-ACCOUNT                  PIC X(10).
  1173         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1174                                         PIC X(10).
  1175         16  PI-CLAIM-CERT-GRP.
  1176             20  PI-CLAIM-NO             PIC X(7).
  1177             20  PI-CERT-NO.
  1178                 25  PI-CERT-PRIME       PIC X(10).
  1179                 25  PI-CERT-SFX         PIC X.
  1180             20  PI-CERT-EFF-DT          PIC XX.
  1181         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1182             20  PI-PLAN-CODE            PIC X(2).
  1183             20  PI-REVISION-NUMBER      PIC X(3).
  1184             20  PI-PLAN-EFF-DT          PIC X(2).
  1185             20  PI-PLAN-EXP-DT          PIC X(2).
  1186             20  FILLER                  PIC X(11).
  1187         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1188             20  PI-OE-REFERENCE-1.
  1189                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1190                 25  PI-OE-REF-1-SUFF    PIC XX.
  1191
  1192     12  PI-SESSION-IN-PROGRESS          PIC X.
  1193         88  CLAIM-SESSION                   VALUE '1'.
  1194         88  CREDIT-SESSION                  VALUE '2'.
  1195         88  WARRANTY-SESSION                VALUE '3'.
  1196         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL657.cbl
  1197         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1198
  1199
  1200*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1201
  1202     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1203     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1204
  1205     12  PI-CREDIT-USER                  PIC X.
  1206         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1207         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1208
  1209     12  PI-CLAIM-USER                   PIC X.
  1210         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1211         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1212
  1213     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1214         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1215         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1216         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1217         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1218         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1219
  1220     12  PI-PROCESSOR-ID                 PIC X(4).
  1221
  1222     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1223
  1224     12  PI-MEMBER-CAPTION               PIC X(10).
  1225
  1226     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1227         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1228
  1229     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1230     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1231     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1232     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1233
  1234     12  PI-AH-OVERRIDE-L1               PIC X.
  1235     12  PI-AH-OVERRIDE-L2               PIC XX.
  1236     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1237     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1238
  1239     12  PI-NEW-SYSTEM                   PIC X(2).
  1240
  1241     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1242     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1243         88  PI-USES-PAID-TO                 VALUE '1'.
  1244     12  PI-CRDTCRD-SYSTEM.
  1245         16  PI-CRDTCRD-USER             PIC X.
  1246             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1247             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1248         16  PI-CC-MONTH-END-DT          PIC XX.
  1249     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1250
  1251     12  PI-OE-REFERENCE-2.
  1252         16  PI-OE-REF-2-PRIME           PIC X(10).
  1253         16  PI-OE-REF-2-SUFF            PIC X.
  1254
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL657.cbl
  1255     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1256
  1257     12  PI-LANGUAGE-TYPE                PIC X.
  1258             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1259             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1260             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1261
  1262     12  PI-POLICY-LINKAGE-IND           PIC X.
  1263         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1264         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1265                                                   LOW-VALUES.
  1266
  1267     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1268     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1269         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1270         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1271     12  FILLER                          PIC X(4).
  1272
  1273     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1274
  1275     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1276         PI-SYSTEM-LEVEL.
  1277
  1278         16  PI-ENTRY-CODES.
  1279             20  PI-ENTRY-CD-1           PIC X.
  1280             20  PI-ENTRY-CD-2           PIC X.
  1281
  1282         16  PI-RETURN-CODES.
  1283             20  PI-RETURN-CD-1          PIC X.
  1284             20  PI-RETURN-CD-2          PIC X.
  1285
  1286         16  PI-UPDATE-STATUS-SAVE.
  1287             20  PI-UPDATE-BY            PIC X(4).
  1288             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1289
  1290         16  PI-LOWER-CASE-LETTERS       PIC X.
  1291             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1292
  1293*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1294*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1295*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1296
  1297         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1298             88  ST-ACCNT-CNTL               VALUE ' '.
  1299             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1300             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1301             88  ACCNT-CNTL                  VALUE '3'.
  1302             88  CARR-ACCNT-CNTL             VALUE '4'.
  1303
  1304         16  PI-PROCESSOR-CAP-LIST.
  1305             20  PI-SYSTEM-CONTROLS.
  1306                24 PI-SYSTEM-DISPLAY     PIC X.
  1307                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1308                24 PI-SYSTEM-MODIFY      PIC X.
  1309                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1310             20  FILLER                  PIC XX.
  1311             20  PI-DISPLAY-CAP          PIC X.
  1312                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL657.cbl
  1313             20  PI-MODIFY-CAP           PIC X.
  1314                 88  MODIFY-CAP              VALUE 'Y'.
  1315             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1316                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1317             20  PI-FORCE-CAP            PIC X.
  1318                 88  FORCE-CAP               VALUE 'Y'.
  1319
  1320         16  PI-PROGRAM-CONTROLS.
  1321             20  PI-PGM-PRINT-OPT        PIC X.
  1322             20  PI-PGM-FORMAT-OPT       PIC X.
  1323             20  PI-PGM-PROCESS-OPT      PIC X.
  1324             20  PI-PGM-TOTALS-OPT       PIC X.
  1325
  1326         16  PI-HELP-INTERFACE.
  1327             20  PI-LAST-ERROR-NO        PIC X(4).
  1328             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1329
  1330         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1331             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1332
  1333         16  PI-CR-CONTROL-IN-PROGRESS.
  1334             20  PI-CR-CARRIER           PIC X.
  1335             20  PI-CR-GROUPING          PIC X(6).
  1336             20  PI-CR-STATE             PIC XX.
  1337             20  PI-CR-ACCOUNT           PIC X(10).
  1338             20  PI-CR-FIN-RESP          PIC X(10).
  1339             20  PI-CR-TYPE              PIC X.
  1340
  1341         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1342
  1343         16  PI-CR-MONTH-END-DT          PIC XX.
  1344
  1345         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1346             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1347             88  PI-ZERO-CARRIER             VALUE '1'.
  1348             88  PI-ZERO-GROUPING            VALUE '2'.
  1349             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1350
  1351         16  PI-CARRIER-SECURITY         PIC X.
  1352             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1353
  1354         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1355             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1356             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1357
  1358         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1359             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1360                                         INDEXED BY PI-ACCESS-NDX
  1361                                         PIC X.
  1362
  1363         16  PI-GA-BILLING-CONTROL       PIC X.
  1364             88  PI-GA-BILLING               VALUE '1'.
  1365
  1366         16  PI-MAIL-PROCESSING          PIC X.
  1367             88  PI-MAIL-YES                 VALUE 'Y'.
  1368
  1369         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1370
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL657.cbl
  1371         16  PI-AR-SYSTEM.
  1372             20  PI-AR-PROCESSING-CNTL   PIC X.
  1373                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1374             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1375             20  PI-AR-MONTH-END-DT      PIC XX.
  1376
  1377         16  PI-MP-SYSTEM.
  1378             20  PI-MORTGAGE-USER            PIC X.
  1379                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1380                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1381             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1382                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1383                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1384                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1385                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1386                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1387             20  PI-MP-MONTH-END-DT          PIC XX.
  1388             20  PI-MP-REFERENCE-NO.
  1389                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1390                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1391
  1392         16  PI-LABEL-CONTROL            PIC X(01).
  1393             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1394             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1395
  1396         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1397             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1398
  1399         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1400             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1401             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1402
  1403         16  FILLER                      PIC X(14).
  1404
  1405     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1406******************************************************************
  1407     12  PI-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1408         16  FILLER                  PIC X(4).
  1409         16  PI-TBCOD                PIC XXX.
  1410         16  FILLER                  PIC XXX.
  1411         16  PI-SAVE-INCR1           PIC S999    COMP-3.
  1412         16  PI-FIRST-SW             PIC X.
  1413         16  FILLER                  PIC X(97).
  1414         16  PI-SAVE-SW              PIC X.
  1415         16  PI-SAVE-TBCOD           PIC XXX.
  1416         16  PI-SAVE-EFFDT           PIC X(6).
  1417         16  PI-SAVE-AGE             PIC 99.
  1418         16  PI-SAVE-TERM            PIC 999.
  1419         16  PI-SAVE-LFTYP           PIC XX.
  1420         16  PI-SAVE-LFPRM           PIC 9(7)V99.
  1421         16  PI-SAVE-LFBEN           PIC 9(9)V99.
  1422         16  PI-SAVE-AHTYP           PIC XX.
  1423         16  PI-SAVE-AHPRM           PIC 9(7)V99.
  1424         16  PI-SAVE-AHBEN           PIC 9(7)V99.
  1425         16  PI-SAVE-IGCOD           PIC X.
  1426         16  PI-SAVE-CARR            PIC X.
  1427         16  PI-SAVE-GRP             PIC X(6).
  1428         16  PI-SAVE-STATE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL657.cbl
  1429         16  PI-SAVE-ACCT            PIC X(10).
  1430         16  PI-SAVE-CERT            PIC X(11).
  1431         16  PI-SAVE-CEFDT           PIC X(6).
  1432         16  FILLER                  PIC X(436).
  1433
  1434****************************************************************
  1435*
  1436* Copyright (c) 2007 by Clerity Solutions, Inc.
  1437* All rights reserved.
  1438*
  1439****************************************************************
  1440 01  DFHEIV.
  1441   02  DFHEIV0               PIC X(35).
  1442   02  DFHEIV1               PIC X(08).
  1443   02  DFHEIV2               PIC X(08).
  1444   02  DFHEIV3               PIC X(08).
  1445   02  DFHEIV4               PIC X(06).
  1446   02  DFHEIV5               PIC X(04).
  1447   02  DFHEIV6               PIC X(04).
  1448   02  DFHEIV7               PIC X(02).
  1449   02  DFHEIV8               PIC X(02).
  1450   02  DFHEIV9               PIC X(01).
  1451   02  DFHEIV10              PIC S9(7) COMP-3.
  1452   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1453   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1454   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1455   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1456   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1457   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1458   02  DFHEIV17              PIC X(04).
  1459   02  DFHEIV18              PIC X(04).
  1460   02  DFHEIV19              PIC X(04).
  1461   02  DFHEIV20              USAGE IS POINTER.
  1462   02  DFHEIV21              USAGE IS POINTER.
  1463   02  DFHEIV22              USAGE IS POINTER.
  1464   02  DFHEIV23              USAGE IS POINTER.
  1465   02  DFHEIV24              USAGE IS POINTER.
  1466   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1467   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1468   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1469   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1470   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1471   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1472   02  FILLER                PIC X(02).
  1473   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1474   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1475   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1476   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1477   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1478 LINKAGE  SECTION.
  1479*****************************************************************
  1480*                                                               *
  1481* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1482* All rights reserved.                                          *
  1483*                                                               *
  1484*****************************************************************
  1485 01  dfheiblk.
  1486     02  eibtime          pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL657.cbl
  1487     02  eibdate          pic s9(7) comp-3.
  1488     02  eibtrnid         pic x(4).
  1489     02  eibtaskn         pic s9(7) comp-3.
  1490     02  eibtrmid         pic x(4).
  1491     02  dfheigdi         pic s9(4) comp.
  1492     02  eibcposn         pic s9(4) comp.
  1493     02  eibcalen         pic s9(4) comp.
  1494     02  eibaid           pic x(1).
  1495     02  eibfiller1       pic x(1).
  1496     02  eibfn            pic x(2).
  1497     02  eibfiller2       pic x(2).
  1498     02  eibrcode         pic x(6).
  1499     02  eibfiller3       pic x(2).
  1500     02  eibds            pic x(8).
  1501     02  eibreqid         pic x(8).
  1502     02  eibrsrce         pic x(8).
  1503     02  eibsync          pic x(1).
  1504     02  eibfree          pic x(1).
  1505     02  eibrecv          pic x(1).
  1506     02  eibsend          pic x(1).
  1507     02  eibatt           pic x(1).
  1508     02  eibeoc           pic x(1).
  1509     02  eibfmh           pic x(1).
  1510     02  eibcompl         pic x(1).
  1511     02  eibsig           pic x(1).
  1512     02  eibconf          pic x(1).
  1513     02  eiberr           pic x(1).
  1514     02  eibrldbk         pic x(1).
  1515     02  eiberrcd         pic x(4).
  1516     02  eibsynrb         pic x(1).
  1517     02  eibnodat         pic x(1).
  1518     02  eibfiller5       pic x(2).
  1519     02  eibresp          pic 9(09) comp.
  1520     02  eibresp2         pic 9(09) comp.
  1521     02  dfheigdj         pic s9(4) comp.
  1522     02  dfheigdk         pic s9(4) comp.
  1523 01  DFHCOMMAREA                     PIC X(1024).
  1524*01 PARMLIST    COMP.
  1525*    02  FILLER                      PIC S9(8).
  1526*    02  ELCERT-POINTER              PIC S9(8).
  1527
  1528*                                    COPY ELCCERT.
  1529******************************************************************
  1530*                                                                *
  1531*                            ELCCERT.                            *
  1532*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1533*                            VMOD=2.013                          *
  1534*                                                                *
  1535*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1536*                                                                *
  1537*   FILE TYPE = VSAM,KSDS                                        *
  1538*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1539*                                                                *
  1540*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1541*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1542*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1543*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1544*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL657.cbl
  1545*                                                                *
  1546*   LOG = YES                                                    *
  1547*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1548******************************************************************
  1549*                   C H A N G E   L O G
  1550*
  1551* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1552*-----------------------------------------------------------------
  1553*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1554* EFFECTIVE    NUMBER
  1555*-----------------------------------------------------------------
  1556* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1557* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1558* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1559* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1560* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1561* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1562* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1563******************************************************************
  1564
  1565 01  CERTIFICATE-MASTER.
  1566     12  CM-RECORD-ID                      PIC XX.
  1567         88  VALID-CM-ID                      VALUE 'CM'.
  1568
  1569     12  CM-CONTROL-PRIMARY.
  1570         16  CM-COMPANY-CD                 PIC X.
  1571         16  CM-CARRIER                    PIC X.
  1572         16  CM-GROUPING.
  1573             20  CM-GROUPING-PREFIX        PIC X(3).
  1574             20  CM-GROUPING-PRIME         PIC X(3).
  1575         16  CM-STATE                      PIC XX.
  1576         16  CM-ACCOUNT.
  1577             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1578             20  CM-ACCOUNT-PRIME          PIC X(6).
  1579         16  CM-CERT-EFF-DT                PIC XX.
  1580         16  CM-CERT-NO.
  1581             20  CM-CERT-PRIME             PIC X(10).
  1582             20  CM-CERT-SFX               PIC X.
  1583
  1584     12  CM-CONTROL-BY-NAME.
  1585         16  CM-COMPANY-CD-A1              PIC X.
  1586         16  CM-INSURED-LAST-NAME          PIC X(15).
  1587         16  CM-INSURED-INITIALS.
  1588             20  CM-INSURED-INITIAL1       PIC X.
  1589             20  CM-INSURED-INITIAL2       PIC X.
  1590
  1591     12  CM-CONTROL-BY-SSN.
  1592         16  CM-COMPANY-CD-A2              PIC X.
  1593         16  CM-SOC-SEC-NO.
  1594             20  CM-SSN-STATE              PIC XX.
  1595             20  CM-SSN-ACCOUNT            PIC X(6).
  1596             20  CM-SSN-LN3.
  1597                 25  CM-INSURED-INITIALS-A2.
  1598                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1599                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1600                 25 CM-PART-LAST-NAME-A2         PIC X.
  1601
  1602     12  CM-CONTROL-BY-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL657.cbl
  1603         16  CM-COMPANY-CD-A4              PIC X.
  1604         16  CM-CERT-NO-A4                 PIC X(11).
  1605
  1606     12  CM-CONTROL-BY-MEMB.
  1607         16  CM-COMPANY-CD-A5              PIC X.
  1608         16  CM-MEMBER-NO.
  1609             20  CM-MEMB-STATE             PIC XX.
  1610             20  CM-MEMB-ACCOUNT           PIC X(6).
  1611             20  CM-MEMB-LN4.
  1612                 25  CM-INSURED-INITIALS-A5.
  1613                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1614                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1615                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1616
  1617     12  CM-INSURED-PROFILE-DATA.
  1618         16  CM-INSURED-FIRST-NAME.
  1619             20  CM-INSURED-1ST-INIT       PIC X.
  1620             20  FILLER                    PIC X(9).
  1621         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1622         16  CM-INSURED-SEX                PIC X.
  1623             88  CM-SEX-MALE                  VALUE 'M'.
  1624             88  CM-SEX-FEMAL                 VALUE 'F'.
  1625         16  CM-INSURED-JOINT-AGE          PIC 99.
  1626         16  CM-JOINT-INSURED-NAME.
  1627             20  CM-JT-LAST-NAME           PIC X(15).
  1628             20  CM-JT-FIRST-NAME.
  1629                 24  CM-JT-1ST-INIT        PIC X.
  1630                 24  FILLER                PIC X(9).
  1631             20  CM-JT-INITIAL             PIC X.
  1632
  1633     12  CM-LIFE-DATA.
  1634         16  CM-LF-BENEFIT-CD              PIC XX.
  1635         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1636         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1637         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1638         16  CM-LF-DEV-CODE                PIC XXX.
  1639         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1640         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1641         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1642         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1643         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1644         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1645         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1646         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1647         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1648         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1649         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1650         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1651         16  FILLER                        PIC XX.
  1652
  1653     12  CM-AH-DATA.
  1654         16  CM-AH-BENEFIT-CD              PIC XX.
  1655         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1656         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1657         16  CM-AH-DEV-CODE                PIC XXX.
  1658         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1659         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1660         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL657.cbl
  1661         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1662         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1663         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1664         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1665         16  CM-AH-PAID-THRU-DT            PIC XX.
  1666             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1667         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1668         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1669         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1670         16  FILLER                        PIC X.
  1671
  1672     12  CM-LOAN-INFORMATION.
  1673         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1674         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1675         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1676         16  CM-PAY-FREQUENCY              PIC S99.
  1677         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1678         16  CM-RATE-CLASS                 PIC XX.
  1679         16  CM-BENEFICIARY                PIC X(25).
  1680         16  CM-POLICY-FORM-NO             PIC X(12).
  1681         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1682         16  CM-LAST-ADD-ON-DT             PIC XX.
  1683         16  CM-DEDUCTIBLE-AMOUNTS.
  1684             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1685             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1686         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1687             20  CM-RESIDENT-STATE         PIC XX.
  1688             20  CM-RATE-CODE              PIC X(4).
  1689             20  FILLER                    PIC XX.
  1690         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1691             20  CM-LOAN-OFFICER           PIC X(5).
  1692             20  FILLER                    PIC XXX.
  1693         16  CM-CSR-CODE                   PIC XXX.
  1694         16  CM-UNDERWRITING-CODE          PIC X.
  1695             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1696         16  CM-POST-CARD-IND              PIC X.
  1697         16  CM-NH-INTERFACE-SW            PIC X.
  1698         16  CM-PREMIUM-TYPE               PIC X.
  1699             88  CM-SING-PRM                  VALUE '1'.
  1700             88  CM-O-B-COVERAGE              VALUE '2'.
  1701             88  CM-OPEN-END                  VALUE '3'.
  1702         16  CM-IND-GRP-TYPE               PIC X.
  1703             88  CM-INDIVIDUAL                VALUE 'I'.
  1704             88  CM-GROUP                     VALUE 'G'.
  1705         16  CM-SKIP-CODE                  PIC X.
  1706             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1707             88  SKIP-JULY                    VALUE '1'.
  1708             88  SKIP-AUGUST                  VALUE '2'.
  1709             88  SKIP-SEPTEMBER               VALUE '3'.
  1710             88  SKIP-JULY-AUG                VALUE '4'.
  1711             88  SKIP-AUG-SEPT                VALUE '5'.
  1712             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1713             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1714             88  SKIP-JUNE                    VALUE '8'.
  1715             88  SKIP-JUNE-JULY               VALUE '9'.
  1716             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1717             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1718         16  CM-PAYMENT-MODE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL657.cbl
  1719             88  PAY-MONTHLY                  VALUE SPACE.
  1720             88  PAY-WEEKLY                   VALUE '1'.
  1721             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1722             88  PAY-BI-WEEKLY                VALUE '3'.
  1723             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1724         16  CM-LOAN-NUMBER                PIC X(8).
  1725         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1726         16  CM-OLD-LOF                    PIC XXX.
  1727*        16  CM-LOAN-OFFICER               PIC XXX.
  1728         16  CM-REIN-TABLE                 PIC XXX.
  1729         16  CM-SPECIAL-REIN-CODE          PIC X.
  1730         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1731         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1732         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1733
  1734     12  CM-STATUS-DATA.
  1735         16  CM-ENTRY-STATUS               PIC X.
  1736         16  CM-ENTRY-DT                   PIC XX.
  1737
  1738         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1739         16  CM-LF-CANCEL-DT               PIC XX.
  1740         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1741
  1742         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1743         16  CM-LF-DEATH-DT                PIC XX.
  1744         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1745
  1746         16  CM-LF-CURRENT-STATUS          PIC X.
  1747             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1748                                                'M' '4' '5' '9'.
  1749             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1750             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1751             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1752             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1753             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1754             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1755             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1756             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1757             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1758             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1759             88  CM-LF-DECLINED               VALUE 'D'.
  1760             88  CM-LF-VOIDED                 VALUE 'V'.
  1761
  1762         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1763         16  CM-AH-CANCEL-DT               PIC XX.
  1764         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1765
  1766         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1767         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1768         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1769
  1770         16  CM-AH-CURRENT-STATUS          PIC X.
  1771             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1772                                                'M' '4' '5' '9'.
  1773             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1774             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1775             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1776             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL657.cbl
  1777             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1778             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1779             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1780             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1781             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1782             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1783             88  CM-AH-DECLINED               VALUE 'D'.
  1784             88  CM-AH-VOIDED                 VALUE 'V'.
  1785
  1786         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1787             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1788             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1789             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1790         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1791
  1792         16  CM-ENTRY-BATCH                PIC X(6).
  1793         16  CM-LF-EXIT-BATCH              PIC X(6).
  1794         16  CM-AH-EXIT-BATCH              PIC X(6).
  1795         16  CM-LAST-MONTH-END             PIC XX.
  1796
  1797     12  CM-NOTE-SW                        PIC X.
  1798         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1799         88  CERT-NOTES-PRESENT               VALUE '1'.
  1800         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1801         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1802         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1803         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1804         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1805         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1806     12  CM-COMP-EXCP-SW                   PIC X.
  1807         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1808         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1809     12  CM-INSURED-ADDRESS-SW             PIC X.
  1810         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1811         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1812
  1813*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1814     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1815     12  FILLER                            PIC X.
  1816
  1817*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1818     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1819     12  FILLER                            PIC X.
  1820*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1821     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  1822
  1823     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1824         88  CERT-ADDED-BATCH                 VALUE ' '.
  1825         88  CERT-ADDED-ONLINE                VALUE '1'.
  1826         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1827         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1828         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1829     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1830         88  CERT-AS-LOADED                   VALUE ' '.
  1831         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1832         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1833         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1834         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL657.cbl
  1835         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1836         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1837         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1838
  1839     12  CM-ACCOUNT-COMM-PCTS.
  1840         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1841         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1842
  1843     12  CM-USER-FIELD                     PIC X.
  1844     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1845     12  CM-CLP-STATE                      PIC XX.
  1846     12  CM-USER-RESERVED                  PIC XXX.
  1847******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL657.cbl
  1849 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  1850                          CERTIFICATE-MASTER.
  1851 0000-DFHEXIT SECTION.
  1852     MOVE '9#                    $   ' TO DFHEIV0.
  1853     MOVE 'EL657' TO DFHEIV1.
  1854     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1855
  1856     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  1857     MOVE '5'                    TO  DC-OPTION-CODE.
  1858     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  1859     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  1860     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  1861
  1862     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  1863
  1864     MOVE EIBTRMID               TO  QID-TERM.
  1865
  1866     IF EIBCALEN = 0
  1867         GO TO 8800-UNAUTHORIZED-ACCESS.
  1868
  1869     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1870         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1871             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  1872             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  1873             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  1874             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  1875             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  1876             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  1877             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  1878             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM.
  1879
  1880     IF EIBTRNID  = TRANS-ID
  1881        GO TO SAME-TRAN.
  1882
  1883     MOVE LOW-VALUES             TO  EL657AI.
  1884
  1885     IF PI-TBCOD NOT = PI-SAVE-TBCOD
  1886         MOVE PI-TBCOD           TO  TBCODO
  1887         MOVE AL-UANON           TO  TBCODA
  1888         GO TO 8100-SEND-INITIAL-MAP.
  1889
  1890     IF PI-SAVE-SW = 'X'
  1891         MOVE PI-SAVE-TBCOD      TO  TBCODO
  1892         MOVE PI-SAVE-EFFDT      TO  EFFDTO
  1893         MOVE PI-SAVE-AGE        TO  ISSAGEO
  1894         MOVE PI-SAVE-TERM       TO  ORIGTRMO
  1895         MOVE PI-SAVE-LFTYP      TO  LFTYPO
  1896         MOVE PI-SAVE-LFPRM      TO  LFPRMO
  1897         MOVE PI-SAVE-LFBEN      TO  LFBENO
  1898         MOVE PI-SAVE-AHTYP      TO  AHTYPO
  1899         MOVE PI-SAVE-AHPRM      TO  AHPRMO
  1900         MOVE PI-SAVE-AHBEN      TO  AHBENO
  1901         MOVE PI-SAVE-IGCOD      TO  IGCODEO
  1902         MOVE PI-SAVE-CARR       TO  CARRO
  1903         MOVE PI-SAVE-GRP        TO  GROUPO
  1904         MOVE PI-SAVE-STATE      TO  STATEO
  1905         MOVE PI-SAVE-ACCT       TO  ACCTO
  1906         MOVE PI-SAVE-CERT       TO  CERTO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL657.cbl
  1907         MOVE PI-SAVE-CEFDT      TO  CEFDTO
  1908         MOVE AL-UNNON           TO  ISSAGEA ORIGTRMA
  1909                                     LFPRMA  AHPRMA   EFFDTA
  1910                                     LFBENA  AHBENA
  1911         MOVE AL-UANON           TO  TBCODA  LFTYPA
  1912                                     AHTYPA  IGCODEA.
  1913
  1914     GO TO 8100-SEND-INITIAL-MAP.
  1915
  1916 SAME-TRAN.
  1917     IF EIBAID = DFHCLEAR
  1918         GO TO 9400-CLEAR.
  1919
  1920
  1921* EXEC CICS HANDLE CONDITION
  1922*        MAPFAIL (8100-SEND-INITIAL-MAP)
  1923*    END-EXEC.
  1924*    MOVE '"$?                   ! " #00001916' TO DFHEIV0
  1925     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  1926     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1927     MOVE X'2220233030303031393136' TO DFHEIV0(25:11)
  1928     CALL 'kxdfhei1' USING DFHEIV0
  1929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1930
  1931
  1932
  1933* EXEC CICS RECEIVE
  1934*        MAP    (MAP-NAME)
  1935*        MAPSET (MAPSET-NAME)
  1936*        INTO   (EL657AI)
  1937*    END-EXEC.
  1938     MOVE LENGTH OF
  1939      EL657AI
  1940       TO DFHEIV11
  1941*    MOVE '8"T I  L              ''   #00001920' TO DFHEIV0
  1942     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1943     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1944     MOVE X'2020233030303031393230' TO DFHEIV0(25:11)
  1945     CALL 'kxdfhei1' USING DFHEIV0,
  1946           MAP-NAME,
  1947           EL657AI,
  1948           DFHEIV11,
  1949           MAPSET-NAME,
  1950           DFHEIV99,
  1951           DFHEIV99
  1952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1953
  1954
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL657.cbl
  1956
  1957     IF PFKEYL = 0
  1958         GO TO 0200-CHECK-PFKEYS.
  1959
  1960     IF EIBAID NOT = DFHENTER
  1961         MOVE ER-0008            TO  EMI-ERROR
  1962         MOVE -1                 TO  PFKEYL
  1963         GO TO 0320-INPUT-ERROR.
  1964
  1965     IF PFKEYI GREATER 0 AND LESS 25
  1966             MOVE PF-VALUES (PFKEYI)    TO  EIBAID
  1967     ELSE
  1968         MOVE ER-0029                    TO  EMI-ERROR
  1969         GO TO 0320-INPUT-ERROR.
  1970
  1971 0200-CHECK-PFKEYS.
  1972     IF EIBAID = DFHPF12
  1973         MOVE LINK-010           TO  PGM-NAME
  1974         GO TO 9300-XCTL.
  1975
  1976     IF EIBAID = DFHPF23
  1977         GO TO 9000-RETURN-CICS.
  1978
  1979     IF EIBAID = DFHPF24
  1980         MOVE LINK-126           TO  PGM-NAME
  1981         GO TO 9300-XCTL.
  1982
  1983     IF (EIBAID = DFHPF1 OR DFHPF2)  AND
  1984        (PI-FIRST-SW NOT = 'X')
  1985         GO TO 0320-INPUT-ERROR
  1986       ELSE
  1987         PERFORM 7200-RECOVER-TEMP-STORAGE THRU 7200-EXIT.
  1988
  1989     IF EIBAID = DFHPF1
  1990         GO TO 6000-PAGE-FORWARD.
  1991     IF EIBAID = DFHPF2
  1992         GO TO 7000-PAGE-BACKWARD.
  1993
  1994     IF EIBAID = DFHENTER
  1995         GO TO 1000-EDIT-INPUT.
  1996
  1997 0320-INPUT-ERROR.
  1998     MOVE ER-0029                TO  EMI-ERROR.
  1999     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2000     MOVE -1                     TO  TBCODL.
  2001     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL657.cbl
  2003
  2004 1000-EDIT-INPUT.
  2005     IF CARRL NOT = ZEROS
  2006         GO TO 2000-EDIT-CERT.
  2007
  2008*******************************TABLE CODE
  2009     IF TBCODL NOT = ZEROS
  2010         MOVE TBCODI             TO  CP-TBCOD PI-SAVE-TBCOD
  2011                                              PI-TBCOD
  2012         MOVE AL-UANON           TO  TBCODA
  2013     ELSE
  2014         MOVE ER-2341            TO  EMI-ERROR
  2015         MOVE -1                 TO  TBCODL
  2016         MOVE AL-UABON           TO  TBCODA
  2017         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2018
  2019*****************************EFFECTIVE DATE
  2020     IF EFFDTL NOT = ZEROS
  2021         IF EFFDTI NUMERIC
  2022             MOVE EFFDTI         TO  DC-GREG-DATE-1-MDY
  2023                                     PI-SAVE-EFFDT
  2024             MOVE 4              TO  DC-OPTION-CODE
  2025             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  2026             IF NO-CONVERSION-ERROR
  2027                 MOVE DC-BIN-DATE-1  TO  CP-EFF-DT
  2028                 MOVE AL-UNNON   TO  EFFDTA
  2029             ELSE
  2030                 MOVE ER-2474    TO  EMI-ERROR
  2031                 MOVE -1         TO  EFFDTL
  2032                 MOVE AL-UNBON   TO  EFFDTA
  2033                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2034         ELSE
  2035             MOVE ER-2482        TO  EMI-ERROR
  2036             MOVE -1             TO  EFFDTL
  2037             MOVE AL-UNBON       TO  EFFDTA
  2038             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2039     ELSE
  2040         MOVE ER-2473            TO  EMI-ERROR
  2041         MOVE -1                 TO  EFFDTL
  2042         MOVE AL-UNBON           TO  EFFDTA
  2043         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2044
  2045*****************************ISSUE AGE
  2046     IF ISSAGEL NOT = ZEROS
  2047         IF ISSAGEI NUMERIC
  2048             MOVE ISSAGEI        TO  CP-ISSUE-AGE PI-SAVE-AGE
  2049                                     ISSAGEO
  2050             MOVE AL-UNNON       TO  ISSAGEA
  2051         ELSE
  2052             MOVE ER-2505        TO  EMI-ERROR
  2053             MOVE -1             TO  ISSAGEL
  2054             MOVE AL-UNBON       TO  ISSAGEA
  2055             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2056       ELSE
  2057          MOVE ZEROS             TO  CP-ISSUE-AGE PI-SAVE-AGE.
  2058
  2059*******************************ORIGINAL TERM
  2060
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL657.cbl
  2061* EXEC CICS BIF DEEDIT
  2062*        FIELD  (ORIGTRMI)
  2063*        LENGTH (3)
  2064*    END-EXEC.
  2065     MOVE 3
  2066       TO DFHEIV11
  2067*    MOVE '@"L                   #   #00002031' TO DFHEIV0
  2068     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2069     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2070     MOVE X'2020233030303032303331' TO DFHEIV0(25:11)
  2071     CALL 'kxdfhei1' USING DFHEIV0,
  2072           ORIGTRMI,
  2073           DFHEIV11
  2074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2075
  2076
  2077     IF ORIGTRML NOT = ZEROS
  2078         IF ORIGTRMI NUMERIC
  2079             MOVE ORIGTRMI       TO  CP-ORIGINAL-TERM
  2080                                     PI-SAVE-TERM
  2081                                     ORIGTRMO
  2082             MOVE AL-UANON       TO  ORIGTRMA
  2083         ELSE
  2084             MOVE ER-2504        TO  EMI-ERROR
  2085             MOVE -1             TO  ORIGTRML
  2086             MOVE AL-UABON       TO  ORIGTRMA
  2087             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2088      ELSE
  2089          MOVE ZEROS             TO  CP-ORIGINAL-TERM
  2090                                     ORIGTRMO
  2091                                     PI-SAVE-TERM.
  2092
  2093*******************************LF TYPE
  2094     IF LFTYPL NOT = ZEROS
  2095         MOVE LFTYPI             TO  CP-LF-TYPE  PI-SAVE-LFTYP
  2096         MOVE AL-UANON           TO  LFTYPA
  2097      ELSE
  2098        MOVE ZEROS               TO  CP-LF-TYPE PI-SAVE-LFTYP.
  2099
  2100******************************LF PREMIUM
  2101
  2102* EXEC CICS BIF DEEDIT
  2103*        FIELD  (LFPRMI)
  2104*        LENGTH (11)
  2105*    END-EXEC.
  2106     MOVE 11
  2107       TO DFHEIV11
  2108*    MOVE '@"L                   #   #00002060' TO DFHEIV0
  2109     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2110     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2111     MOVE X'2020233030303032303630' TO DFHEIV0(25:11)
  2112     CALL 'kxdfhei1' USING DFHEIV0,
  2113           LFPRMI,
  2114           DFHEIV11
  2115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2116
  2117
  2118       IF LFPRML NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL657.cbl
  2119         IF LFPRMI NUMERIC
  2120             MOVE LFPRMI         TO  CP-LF-PREM  PI-SAVE-LFPRM
  2121             MOVE PI-SAVE-LFPRM  TO  LFPRMO
  2122             MOVE AL-UNNON       TO  LFPRMA
  2123         ELSE
  2124             MOVE ER-2484        TO  EMI-ERROR
  2125             MOVE -1             TO  LFPRML
  2126             MOVE AL-UNBON       TO  LFPRMA
  2127             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2128       ELSE
  2129          MOVE ZEROS             TO  CP-LF-PREM PI-SAVE-LFPRM
  2130                                     LFPRMO.
  2131
  2132******************************LF BENEFIT
  2133
  2134* EXEC CICS BIF DEEDIT
  2135*        FIELD  (LFBENI)
  2136*        LENGTH (14)
  2137*    END-EXEC.
  2138     MOVE 14
  2139       TO DFHEIV11
  2140*    MOVE '@"L                   #   #00002080' TO DFHEIV0
  2141     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2142     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2143     MOVE X'2020233030303032303830' TO DFHEIV0(25:11)
  2144     CALL 'kxdfhei1' USING DFHEIV0,
  2145           LFBENI,
  2146           DFHEIV11
  2147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2148
  2149
  2150     IF LFBENL NOT = ZEROS
  2151         IF LFBENI NUMERIC
  2152             MOVE LFBENI         TO  CP-LF-BEN PI-SAVE-LFBEN
  2153             MOVE PI-SAVE-LFBEN  TO  LFBENO
  2154             MOVE AL-UNNON       TO  LFBENA
  2155         ELSE
  2156             MOVE ER-2485        TO  EMI-ERROR
  2157             MOVE -1             TO  LFBENL
  2158             MOVE AL-UNBON       TO  LFBENA
  2159             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2160       ELSE
  2161          MOVE ZEROS             TO  CP-LF-BEN PI-SAVE-LFBEN
  2162                                     LFBENO.
  2163
  2164*******************************AH TYPE
  2165     IF AHTYPL NOT = ZEROS
  2166         MOVE AHTYPI             TO  CP-AH-TYPE  PI-SAVE-AHTYP
  2167         MOVE AL-UANON           TO  AHTYPA
  2168      ELSE
  2169       MOVE ZERO                 TO  CP-AH-TYPE PI-SAVE-AHTYP.
  2170
  2171******************************AH PREMIUM
  2172
  2173* EXEC CICS BIF DEEDIT
  2174*        FIELD  (AHPRMI)
  2175*        LENGTH (11)
  2176*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL657.cbl
  2177     MOVE 11
  2178       TO DFHEIV11
  2179*    MOVE '@"L                   #   #00002107' TO DFHEIV0
  2180     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2181     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2182     MOVE X'2020233030303032313037' TO DFHEIV0(25:11)
  2183     CALL 'kxdfhei1' USING DFHEIV0,
  2184           AHPRMI,
  2185           DFHEIV11
  2186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2187
  2188
  2189     IF AHPRML NOT = ZEROS
  2190         IF AHPRMI NUMERIC
  2191             MOVE AHPRMI         TO  CP-AH-PREM  PI-SAVE-AHPRM
  2192             MOVE PI-SAVE-AHPRM  TO  AHPRMO
  2193             MOVE AL-UNNON       TO  AHPRMA
  2194         ELSE
  2195             MOVE ER-2484        TO  EMI-ERROR
  2196             MOVE -1             TO  AHPRML
  2197             MOVE AL-UNBON       TO  AHPRMA
  2198             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2199       ELSE
  2200           MOVE ZEROS            TO  CP-AH-PREM PI-SAVE-AHPRM
  2201                                     AHPRMO.
  2202
  2203******************************AH BENEFIT
  2204
  2205* EXEC CICS BIF DEEDIT
  2206*        FIELD  (AHBENI)
  2207*        LENGTH (11)
  2208*    END-EXEC.
  2209     MOVE 11
  2210       TO DFHEIV11
  2211*    MOVE '@"L                   #   #00002127' TO DFHEIV0
  2212     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2213     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2214     MOVE X'2020233030303032313237' TO DFHEIV0(25:11)
  2215     CALL 'kxdfhei1' USING DFHEIV0,
  2216           AHBENI,
  2217           DFHEIV11
  2218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2219
  2220
  2221     IF AHBENL NOT = ZEROS
  2222         IF AHBENI NUMERIC
  2223             MOVE AHBENI         TO  CP-AH-BEN  PI-SAVE-AHBEN
  2224             MOVE PI-SAVE-AHBEN  TO  AHBENO
  2225             MOVE AL-UNNON       TO  AHBENA
  2226         ELSE
  2227             MOVE ER-2485        TO  EMI-ERROR
  2228             MOVE -1             TO  AHBENL
  2229             MOVE AL-UNBON       TO  AHBENA
  2230             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2231       ELSE
  2232           MOVE ZEROS            TO  CP-AH-BEN PI-SAVE-AHBEN
  2233                                     AHBENO.
  2234
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL657.cbl
  2235*******************************I/G
  2236     IF IGCODEI = 'I' OR 'G'
  2237         MOVE IGCODEI            TO  CP-IG-CODE  PI-SAVE-IGCOD
  2238         MOVE AL-UANON           TO  IGCODEA
  2239     ELSE
  2240         MOVE SPACE              TO  CP-IG-CODE  PI-SAVE-IGCOD
  2241                                     IGCODEO
  2242         MOVE AL-UANON           TO  IGCODEA.
  2243
  2244     GO TO 3000-PERFORM-CALC-ROUTINE.
  2245
  2246 2000-EDIT-CERT.
  2247*******************************CARRIER
  2248     IF CARRI NOT = SPACES
  2249         MOVE CARRI              TO  WS-CARRIER PI-SAVE-CARR
  2250         MOVE AL-UANON           TO  CARRA
  2251     ELSE
  2252         MOVE ZEROS              TO  CARRL
  2253         MOVE SPACES             TO  GROUPI STATEI CERTI
  2254                                     ACCTI CEFDTI
  2255         GO TO 1000-EDIT-INPUT.
  2256
  2257*******************************GROUPING
  2258     IF GROUPI NOT = SPACES
  2259         MOVE GROUPI             TO  WS-GROUPING  PI-SAVE-GRP
  2260         MOVE AL-UANON           TO  GROUPA
  2261     ELSE
  2262         MOVE ER-0195            TO  EMI-ERROR
  2263         MOVE -1                 TO  GROUPL
  2264         MOVE AL-UABON           TO  GROUPA
  2265         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2266
  2267*******************************STATE
  2268     IF STATEI NOT = SPACES
  2269         MOVE STATEI             TO  WS-STATE  PI-SAVE-STATE
  2270         MOVE AL-UANON           TO  STATEA
  2271     ELSE
  2272         MOVE ER-0196            TO  EMI-ERROR
  2273         MOVE -1                 TO  STATEL
  2274         MOVE AL-UABON           TO  STATEA
  2275         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2276
  2277*******************************ACCOUNT
  2278     IF ACCTI NOT = SPACES
  2279         MOVE ACCTI              TO  WS-ACCOUNT PI-SAVE-ACCT
  2280         MOVE AL-UANON           TO  ACCTA
  2281     ELSE
  2282         MOVE ER-0197            TO  EMI-ERROR
  2283         MOVE -1                 TO  ACCTL
  2284         MOVE AL-UABON           TO  ACCTA
  2285         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2286
  2287*******************************CERT
  2288     IF CERTI NOT = SPACES
  2289         MOVE CERTI              TO  WS-CERT-NO  PI-SAVE-CERT
  2290         MOVE AL-UANON           TO  CERTA
  2291     ELSE
  2292         MOVE ER-0203            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL657.cbl
  2293         MOVE -1                 TO  CERTL
  2294         MOVE AL-UABON           TO  CERTA
  2295         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2296
  2297*****************************EFFECTIVE DATE
  2298     IF CEFDTL NOT = ZEROS
  2299         IF CEFDTI NUMERIC
  2300             MOVE CEFDTI         TO  DC-GREG-DATE-1-MDY
  2301                                     PI-SAVE-CEFDT
  2302             MOVE 4              TO  DC-OPTION-CODE
  2303             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  2304             IF NO-CONVERSION-ERROR
  2305                 MOVE DC-BIN-DATE-1  TO  WS-CERT-EFF-DT
  2306                 MOVE AL-UNNON   TO  CEFDTA
  2307             ELSE
  2308                 MOVE ER-2474    TO  EMI-ERROR
  2309                 MOVE -1         TO  CEFDTL
  2310                 MOVE AL-UNBON   TO  CEFDTA
  2311                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2312         ELSE
  2313             MOVE ER-2482        TO  EMI-ERROR
  2314             MOVE -1             TO  CEFDTL
  2315             MOVE AL-UNBON       TO  CEFDTA
  2316             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2317     ELSE
  2318         MOVE ER-2473            TO  EMI-ERROR
  2319         MOVE -1                 TO  CEFDTL
  2320         MOVE AL-UNBON           TO  CEFDTA
  2321         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2322
  2323     MOVE PI-COMPANY-CD          TO  WS-COMPANY-CD.
  2324
  2325
  2326* EXEC CICS HANDLE CONDITION
  2327*        NOTFND (2500-CERT-NOT-FOUND)
  2328*    END-EXEC.
  2329*    MOVE '"$I                   ! # #00002236' TO DFHEIV0
  2330     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2332     MOVE X'2320233030303032323336' TO DFHEIV0(25:11)
  2333     CALL 'kxdfhei1' USING DFHEIV0
  2334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2335
  2336
  2337
  2338* EXEC CICS READ
  2339*         SET      (ADDRESS OF CERTIFICATE-MASTER)
  2340*         DATASET  ('ELCERT')
  2341*         RIDFLD   (WS-CONTROL-PRIMARY)
  2342*    END-EXEC.
  2343     MOVE 'ELCERT' TO DFHEIV1
  2344*    MOVE '&"S        E          (   #00002240' TO DFHEIV0
  2345     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2346     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2347     MOVE X'2020233030303032323430' TO DFHEIV0(25:11)
  2348     CALL 'kxdfhei1' USING DFHEIV0,
  2349           DFHEIV1,
  2350           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL657.cbl
  2351           DFHEIV99,
  2352           WS-CONTROL-PRIMARY,
  2353           DFHEIV99,
  2354           DFHEIV99,
  2355           DFHEIV99
  2356     SET ADDRESS OF CERTIFICATE-MASTER TO
  2357         DFHEIV20
  2358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2359
  2360
  2361     IF TBCODL = ZERO  OR
  2362        TBCODI = SPACES
  2363        MOVE CM-REIN-TABLE       TO  CP-TBCOD PI-SAVE-TBCOD
  2364                                     PI-TBCOD TBCODO
  2365       ELSE
  2366         MOVE TBCODI             TO  CP-TBCOD PI-SAVE-TBCOD
  2367                                     PI-TBCOD
  2368         MOVE AL-UANON           TO  TBCODA.
  2369
  2370     MOVE CM-CERT-EFF-DT         TO  CP-EFF-DT.
  2371     MOVE CP-EFF-DT              TO  DC-BIN-DATE-1.
  2372     MOVE SPACES                 TO  DC-OPTION-CODE.
  2373     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  2374     MOVE DC-GREG-DATE-1-MDY     TO  EFFDTO PI-SAVE-CEFDT
  2375                                     CEFDTO PI-SAVE-EFFDT.
  2376
  2377     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE ISSAGEO
  2378                                     PI-SAVE-AGE.
  2379     IF CM-LF-BENEFIT-CD NOT = ZEROS  AND  SPACES
  2380         MOVE CM-LF-ORIG-TERM    TO  CP-ORIGINAL-TERM ORIGTRMO
  2381                                     PI-SAVE-TERM
  2382     ELSE
  2383         MOVE CM-AH-ORIG-TERM    TO  CP-ORIGINAL-TERM ORIGTRMO
  2384                                     PI-SAVE-TERM.
  2385     MOVE CM-LF-BENEFIT-CD       TO  CP-LF-TYPE    LFTYPO
  2386                                     PI-SAVE-LFTYP.
  2387     MOVE CM-AH-BENEFIT-CD       TO  CP-AH-TYPE    AHTYPO
  2388                                     PI-SAVE-AHTYP.
  2389
  2390     ADD CM-LF-ALT-PREMIUM-AMT
  2391         CM-LF-PREMIUM-AMT       GIVING WS-LF-PREMIUM-AMT.
  2392
  2393     MOVE WS-LF-PREMIUM-AMT      TO  CP-LF-PREM    LFPRMO
  2394                                     PI-SAVE-LFPRM.
  2395     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-LFPRM-ALT.
  2396
  2397     MOVE CM-AH-PREMIUM-AMT      TO  CP-AH-PREM    AHPRMO
  2398                                     PI-SAVE-AHPRM.
  2399     ADD CM-LF-ALT-BENEFIT-AMT
  2400         CM-LF-BENEFIT-AMT       GIVING WS-LF-BENEFIT-AMT.
  2401
  2402     MOVE WS-LF-BENEFIT-AMT      TO  CP-LF-BEN     LFBENO
  2403                                     PI-SAVE-LFBEN.
  2404     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-LFAMT-ALT.
  2405     MOVE CM-AH-BENEFIT-AMT      TO  CP-AH-BEN     AHBENO
  2406                                     PI-SAVE-AHBEN.
  2407     MOVE CM-IND-GRP-TYPE        TO  CP-IG-CODE    IGCODEO
  2408                                     PI-SAVE-IGCOD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL657.cbl
  2409
  2410     MOVE AL-UNNON               TO  ISSAGEA  ORIGTRMA  LFPRMA
  2411                                     AHPRMA   EFFDTA    LFBENA
  2412                                     AHBENA.
  2413     MOVE AL-UANON               TO  TBCODA   LFTYPA    AHTYPA
  2414                                     IGCODEA.
  2415
  2416     GO TO 3000-PERFORM-CALC-ROUTINE.
  2417
  2418 2500-CERT-NOT-FOUND.
  2419     MOVE ER-0244                TO  EMI-ERROR
  2420     MOVE -1                     TO  CARRL.
  2421     MOVE AL-UABON               TO  CARRA.
  2422     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2423     GO TO 8200-SEND-DATAONLY.
  2424
  2425 3000-PERFORM-CALC-ROUTINE.
  2426     IF EMI-ERROR NOT = ZEROS
  2427         GO TO 8200-SEND-DATAONLY.
  2428
  2429     MOVE 'X'                    TO  PI-SAVE-SW PI-FIRST-SW.
  2430     MOVE PI-COMPANY-CD          TO  CP-COMPANY-CD.
  2431     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  2432     MOVE ZERO                   TO  CP-RETURN-CODE.
  2433     MOVE LINK-ELREIN            TO  PGM-NAME.
  2434
  2435     PERFORM 9700-LINK THRU 9700-EXIT.
  2436     PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT.
  2437
  2438 4000-DISPLAY-RESULTS.
  2439     IF CP-RETURN-CODE NOT = 0
  2440         GO TO 4000-ERROR.
  2441
  2442     MOVE 1                      TO  INCR1 PI-SAVE-INCR1.
  2443
  2444     PERFORM 5000-BLD-LINE THRU 5000-XIT.
  2445
  2446     IF CARRL NOT = ZEROS
  2447         MOVE -1                 TO  CARRL
  2448     ELSE
  2449         MOVE -1                 TO  TBCODL.
  2450
  2451     GO TO 8200-SEND-DATAONLY.
  2452
  2453 4000-ERROR.
  2454     IF CP-RETURN-CODE = 1
  2455         MOVE ER-2425            TO  EMI-ERROR
  2456         MOVE -1                 TO  LFTYPL
  2457         MOVE AL-UABON           TO  LFTYPA
  2458         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2459     IF CP-RETURN-CODE = 2
  2460         MOVE ER-2429            TO  EMI-ERROR
  2461         MOVE -1                 TO  AHTYPL
  2462         MOVE AL-UABON           TO  AHTYPA
  2463         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2464     IF CP-RETURN-CODE = 3
  2465         MOVE ER-2615            TO  EMI-ERROR
  2466         MOVE -1                 TO  TBCODL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL657.cbl
  2467         MOVE AL-UABON           TO  TBCODA
  2468         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2469
  2470     GO TO 8200-SEND-DATAONLY.
  2471
  2472 5000-BLD-LINE.
  2473     MOVE 1                      TO  INCR2.
  2474     MOVE SPACES       TO  REPLINEO (1) REPLINEO (2) REPLINEO (3)
  2475                           REPLINEO (4) REPLINEO (5) REPLINEO (6)
  2476                           REPLINEO (7) REPLINEO (8) REPLINEO (9)
  2477                           REPLINEO (10).
  2478
  2479 5000-BLD-LINE-LOOP.
  2480     IF REIN-COMP (INCR1) = SPACES
  2481         GO TO 5000-XIT.
  2482
  2483     MOVE SPACES                     TO  BLD-LINE.
  2484     MOVE REIN-CO-PRIME (INCR1)      TO  BL-CEDED.
  2485     MOVE REIN-CO-SUB   (INCR1)      TO  BL-CEDED-SUB.
  2486     MOVE REIN-LFPRM    (INCR1)      TO  BL-LF-PREMIUM.
  2487     MOVE REIN-AHPRM    (INCR1)      TO  BL-AH-PREMIUM.
  2488     MOVE REIN-LFAMT    (INCR1)      TO  BL-LF-BENEFIT.
  2489     MOVE REIN-AHAMT    (INCR1)      TO  BL-AH-BENEFIT.
  2490
  2491     MOVE BLD-LINE               TO  REPLINEO (INCR2).
  2492     ADD  1                      TO  INCR1 INCR2  PI-SAVE-INCR1.
  2493     IF INCR2 = 11
  2494          GO TO 5000-XIT.
  2495
  2496     GO TO 5000-BLD-LINE-LOOP.
  2497
  2498 5000-XIT.
  2499     EXIT.
  2500
  2501 6000-PAGE-FORWARD.
  2502     MOVE PI-SAVE-INCR1          TO  INCR1.
  2503     IF REIN-COMP (INCR1) = SPACES
  2504         MOVE -1                 TO  TBCODL
  2505         MOVE ER-0130            TO  EMI-ERROR
  2506         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2507         GO TO 8200-SEND-DATAONLY.
  2508
  2509*    MOVE 11                     TO  INCR1 PI-SAVE-INCR1.
  2510     PERFORM 5000-BLD-LINE THRU 5000-XIT.
  2511     MOVE -1                     TO  TBCODL.
  2512     GO TO 8200-SEND-DATAONLY.
  2513
  2514 7000-PAGE-BACKWARD.
  2515     MOVE PI-SAVE-INCR1          TO  INCR1.
  2516     IF INCR1 LESS 12
  2517         MOVE -1                 TO  TBCODL
  2518         MOVE ER-0131            TO  EMI-ERROR
  2519         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2520         GO TO 8200-SEND-DATAONLY.
  2521
  2522     MOVE 1                      TO  INCR1 PI-SAVE-INCR1.
  2523     PERFORM 5000-BLD-LINE THRU 5000-XIT.
  2524     MOVE -1                     TO  TBCODL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL657.cbl
  2525     GO TO 8200-SEND-DATAONLY.
  2526
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL657.cbl
  2528 7100-CREATE-TEMP-STORAGE.
  2529     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  2530
  2531* EXEC CICS WRITEQ TS
  2532*        QUEUE   (QID)
  2533*        FROM    (REIN-HOLD-AREAS)
  2534*        LENGTH  (REIN-LENGTH)
  2535*        ITEM    (ITEM-VALUE)
  2536*    END-EXEC.
  2537*    MOVE '*" I                  ''   #00002415' TO DFHEIV0
  2538     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  2539     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2540     MOVE X'2020233030303032343135' TO DFHEIV0(25:11)
  2541     CALL 'kxdfhei1' USING DFHEIV0,
  2542           QID,
  2543           REIN-HOLD-AREAS,
  2544           REIN-LENGTH,
  2545           ITEM-VALUE,
  2546           DFHEIV99,
  2547           DFHEIV99
  2548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2549
  2550
  2551 7100-EXIT.
  2552      EXIT.
  2553
  2554 7200-RECOVER-TEMP-STORAGE.
  2555
  2556* EXEC CICS HANDLE CONDITION
  2557*        QIDERR  (7200-EXIT)
  2558*    END-EXEC.
  2559*    MOVE '"$N                   ! $ #00002426' TO DFHEIV0
  2560     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  2561     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2562     MOVE X'2420233030303032343236' TO DFHEIV0(25:11)
  2563     CALL 'kxdfhei1' USING DFHEIV0
  2564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2565
  2566
  2567
  2568* EXEC CICS READQ TS
  2569*        QUEUE    (QID)
  2570*        INTO     (REIN-HOLD-AREAS)
  2571*        LENGTH   (REIN-LENGTH)
  2572*        ITEM     (ITEM-VALUE)
  2573*    END-EXEC.
  2574*    MOVE '*$II   L              ''   #00002430' TO DFHEIV0
  2575     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  2576     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2577     MOVE X'2020233030303032343330' TO DFHEIV0(25:11)
  2578     CALL 'kxdfhei1' USING DFHEIV0,
  2579           QID,
  2580           REIN-HOLD-AREAS,
  2581           REIN-LENGTH,
  2582           ITEM-VALUE,
  2583           DFHEIV99,
  2584           DFHEIV99
  2585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL657.cbl
  2586
  2587
  2588 7200-EXIT.
  2589      EXIT.
  2590
  2591 7300-DELETE-TEMP-STORAGE.
  2592
  2593* EXEC CICS HANDLE CONDITION
  2594*        QIDERR  (7300-EXIT)
  2595*    END-EXEC.
  2596*    MOVE '"$N                   ! % #00002441' TO DFHEIV0
  2597     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  2598     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2599     MOVE X'2520233030303032343431' TO DFHEIV0(25:11)
  2600     CALL 'kxdfhei1' USING DFHEIV0
  2601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2602
  2603
  2604
  2605* EXEC CICS DELETEQ TS
  2606*        QUEUE  (QID)
  2607*    END-EXEC.
  2608*    MOVE '*&                    #   #00002445' TO DFHEIV0
  2609     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  2610     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2611     MOVE X'2020233030303032343435' TO DFHEIV0(25:11)
  2612     CALL 'kxdfhei1' USING DFHEIV0,
  2613           QID,
  2614           DFHEIV99
  2615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2616
  2617
  2618 7300-EXIT.
  2619      EXIT.
  2620
  2621 8100-SEND-INITIAL-MAP.
  2622     MOVE SAVE-DATE              TO  DATEO.
  2623     MOVE EIBTIME                TO  TIME-IN.
  2624     MOVE TIME-OUT               TO  TIMEO.
  2625     MOVE -1                     TO  TBCODL.
  2626     MOVE EMI-MESSAGE-AREA (1)   TO  MSGO.
  2627
  2628     MOVE PI-LIFE-OVERRIDE-L2    TO  LFHDG1O
  2629                                     LFHDG2O
  2630                                     LFHDG3O
  2631                                     LFHDG4O
  2632                                     LFHDG5O.
  2633     MOVE PI-AH-OVERRIDE-L2      TO  AHHDG1O
  2634                                     AHHDG2O
  2635                                     AHHDG3O
  2636                                     AHHDG4O
  2637                                     AHHDG5O.
  2638     MOVE AL-SABON               TO  LFHDG1A  LFHDG2A  LFHDG3A
  2639                                     LFHDG4A  LFHDG5A
  2640                                     AHHDG1A  AHHDG2A  AHHDG3A
  2641                                     AHHDG4A  AHHDG5A.
  2642
  2643
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL657.cbl
  2644* EXEC CICS SEND
  2645*        MAP    (MAP-NAME)
  2646*        MAPSET (MAPSET-NAME)
  2647*        FROM   (EL657AI)
  2648*        ERASE
  2649*        CURSOR
  2650*    END-EXEC.
  2651     MOVE LENGTH OF
  2652      EL657AI
  2653       TO DFHEIV12
  2654     MOVE -1
  2655       TO DFHEIV11
  2656*    MOVE '8$     CT  E    H L F ,   #00002474' TO DFHEIV0
  2657     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2658     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2659     MOVE X'2020233030303032343734' TO DFHEIV0(25:11)
  2660     CALL 'kxdfhei1' USING DFHEIV0,
  2661           MAP-NAME,
  2662           EL657AI,
  2663           DFHEIV12,
  2664           MAPSET-NAME,
  2665           DFHEIV99,
  2666           DFHEIV99,
  2667           DFHEIV99,
  2668           DFHEIV11,
  2669           DFHEIV99,
  2670           DFHEIV99,
  2671           DFHEIV99
  2672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2673
  2674
  2675     GO TO 9100-RETURN-TRAN.
  2676
  2677 8200-SEND-DATAONLY.
  2678     MOVE SAVE-DATE              TO  DATEO.
  2679     MOVE EIBTIME                TO  TIME-IN.
  2680     MOVE TIME-OUT               TO  TIMEO.
  2681     MOVE EMI-MESSAGE-AREA (1)   TO  MSGO.
  2682
  2683     MOVE PI-LIFE-OVERRIDE-L2    TO  LFHDG1O
  2684                                     LFHDG2O
  2685                                     LFHDG3O
  2686                                     LFHDG4O
  2687                                     LFHDG5O.
  2688     MOVE PI-AH-OVERRIDE-L2      TO  AHHDG1O
  2689                                     AHHDG2O
  2690                                     AHHDG3O
  2691                                     AHHDG4O
  2692                                     AHHDG5O.
  2693     MOVE AL-SABON               TO  LFHDG1A  LFHDG2A  LFHDG3A
  2694                                     LFHDG4A  LFHDG5A
  2695                                     AHHDG1A  AHHDG2A  AHHDG3A
  2696                                     AHHDG4A  AHHDG5A.
  2697
  2698
  2699* EXEC CICS SEND
  2700*        MAP    (MAP-NAME)
  2701*        MAPSET (MAPSET-NAME)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL657.cbl
  2702*        FROM   (EL657AI)
  2703*        DATAONLY
  2704*        CURSOR
  2705*    END-EXEC.
  2706     MOVE LENGTH OF
  2707      EL657AI
  2708       TO DFHEIV12
  2709     MOVE -1
  2710       TO DFHEIV11
  2711*    MOVE '8$D    CT       H L F ,   #00002505' TO DFHEIV0
  2712     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2713     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2714     MOVE X'2020233030303032353035' TO DFHEIV0(25:11)
  2715     CALL 'kxdfhei1' USING DFHEIV0,
  2716           MAP-NAME,
  2717           EL657AI,
  2718           DFHEIV12,
  2719           MAPSET-NAME,
  2720           DFHEIV99,
  2721           DFHEIV99,
  2722           DFHEIV99,
  2723           DFHEIV11,
  2724           DFHEIV99,
  2725           DFHEIV99,
  2726           DFHEIV99
  2727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2728
  2729
  2730     GO TO 9100-RETURN-TRAN.
  2731
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL657.cbl
  2733 8300-SEND-TEXT SECTION.
  2734
  2735* EXEC CICS SEND TEXT
  2736*        FROM   (LOGOFF-TEXT)
  2737*        LENGTH (LOGOFF-LENGTH)
  2738*        ERASE
  2739*        FREEKB
  2740*    END-EXEC.
  2741*    MOVE '8&      T  E F  H   F -   #00002517' TO DFHEIV0
  2742     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2743     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2744     MOVE X'2020233030303032353137' TO DFHEIV0(25:11)
  2745     CALL 'kxdfhei1' USING DFHEIV0,
  2746           LOGOFF-TEXT,
  2747           LOGOFF-LENGTH,
  2748           DFHEIV99,
  2749           DFHEIV99,
  2750           DFHEIV99,
  2751           DFHEIV99,
  2752           DFHEIV99,
  2753           DFHEIV99,
  2754           DFHEIV99,
  2755           DFHEIV99,
  2756           DFHEIV99,
  2757           DFHEIV99
  2758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2759
  2760
  2761
  2762* EXEC CICS RETURN
  2763*    END-EXEC.
  2764*    MOVE '.(                    &   #00002524' TO DFHEIV0
  2765     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2766     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2767     MOVE X'2020233030303032353234' TO DFHEIV0(25:11)
  2768     CALL 'kxdfhei1' USING DFHEIV0,
  2769           DFHEIV99,
  2770           DFHEIV99,
  2771           DFHEIV99,
  2772           DFHEIV99,
  2773           DFHEIV99
  2774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2775
  2776
  2777 8300-EXIT.
  2778     EXIT.
  2779
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL657.cbl
  2781 8500-DATE-CONVERT.
  2782     MOVE LINK-ELDATCV           TO  PGM-NAME.
  2783
  2784* EXEC CICS LINK
  2785*        PROGRAM    (PGM-NAME)
  2786*        COMMAREA   (DATE-CONVERSION-DATA)
  2787*        LENGTH     (DC-COMM-LENGTH)
  2788*    END-EXEC.
  2789*    MOVE '."C                   ''   #00002533' TO DFHEIV0
  2790     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2791     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2792     MOVE X'2020233030303032353333' TO DFHEIV0(25:11)
  2793     CALL 'kxdfhei1' USING DFHEIV0,
  2794           PGM-NAME,
  2795           DATE-CONVERSION-DATA,
  2796           DC-COMM-LENGTH,
  2797           DFHEIV99,
  2798           DFHEIV99,
  2799           DFHEIV99
  2800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2801
  2802
  2803 8500-EXIT.
  2804     EXIT.
  2805
  2806 8800-UNAUTHORIZED-ACCESS.
  2807     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  2808     GO TO 8300-SEND-TEXT.
  2809
  2810 8950-CLEAR-RETURN.
  2811     MOVE TRAN-COMPLETE-MSG      TO  TEXT-AREA.
  2812
  2813 8990-SEND-TEXT.
  2814
  2815* EXEC CICS SEND TEXT
  2816*        FROM    (TEXT-AREA)
  2817*        LENGTH  (TEXT-LENGTH)
  2818*        ERASE
  2819*        FREEKB
  2820*    END-EXEC.
  2821*    MOVE '8&      T  E F  H   F -   #00002550' TO DFHEIV0
  2822     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2823     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2824     MOVE X'2020233030303032353530' TO DFHEIV0(25:11)
  2825     CALL 'kxdfhei1' USING DFHEIV0,
  2826           TEXT-AREA,
  2827           TEXT-LENGTH,
  2828           DFHEIV99,
  2829           DFHEIV99,
  2830           DFHEIV99,
  2831           DFHEIV99,
  2832           DFHEIV99,
  2833           DFHEIV99,
  2834           DFHEIV99,
  2835           DFHEIV99,
  2836           DFHEIV99,
  2837           DFHEIV99
  2838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL657.cbl
  2839
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL657.cbl
  2841
  2842 9000-RETURN-CICS.
  2843     MOVE LINK-005               TO  PGM-NAME.
  2844     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  2845     GO TO 9300-XCTL.
  2846
  2847 9100-RETURN-TRAN.
  2848     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  2849     MOVE '657A'                 TO  PI-CURRENT-SCREEN-NO.
  2850
  2851
  2852* EXEC CICS RETURN
  2853*        TRANSID   (TRANS-ID)
  2854*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  2855*        LENGTH    (PI-COMM-LENGTH)
  2856*    END-EXEC.
  2857*    MOVE '.(CT                  &   #00002567' TO DFHEIV0
  2858     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2859     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2860     MOVE X'2020233030303032353637' TO DFHEIV0(25:11)
  2861     CALL 'kxdfhei1' USING DFHEIV0,
  2862           TRANS-ID,
  2863           PROGRAM-INTERFACE-BLOCK,
  2864           PI-COMM-LENGTH,
  2865           DFHEIV99,
  2866           DFHEIV99
  2867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2868
  2869
  2870
  2871* GOBACK.
  2872     MOVE '9%                    "   ' TO DFHEIV0
  2873     MOVE 'EL657' TO DFHEIV1
  2874     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2875     GOBACK.
  2876
  2877 9300-XCTL.
  2878
  2879* EXEC CICS XCTL
  2880*        PROGRAM    (PGM-NAME)
  2881*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2882*        LENGTH     (PI-COMM-LENGTH)
  2883*    END-EXEC.
  2884*    MOVE '.$C                   $   #00002576' TO DFHEIV0
  2885     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2886     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2887     MOVE X'2020233030303032353736' TO DFHEIV0(25:11)
  2888     CALL 'kxdfhei1' USING DFHEIV0,
  2889           PGM-NAME,
  2890           PROGRAM-INTERFACE-BLOCK,
  2891           PI-COMM-LENGTH
  2892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2893
  2894
  2895 9400-CLEAR.
  2896     MOVE SPACE                  TO  PI-FIRST-SW.
  2897     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  2898     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL657.cbl
  2899
  2900 9700-LINK.
  2901
  2902* EXEC CICS LINK
  2903*        PROGRAM   (PGM-NAME)
  2904*        COMMAREA  (REINSURANCE-PASS-AREA)
  2905*        LENGTH    (CP-COMM-LENGTH)
  2906*    END-EXEC.
  2907*    MOVE '."C                   ''   #00002588' TO DFHEIV0
  2908     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2909     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2910     MOVE X'2020233030303032353838' TO DFHEIV0(25:11)
  2911     CALL 'kxdfhei1' USING DFHEIV0,
  2912           PGM-NAME,
  2913           REINSURANCE-PASS-AREA,
  2914           CP-COMM-LENGTH,
  2915           DFHEIV99,
  2916           DFHEIV99,
  2917           DFHEIV99
  2918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2919
  2920
  2921 9700-EXIT.
  2922      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL657.cbl
  2924
  2925 9900-ERROR-FORMAT.
  2926     IF NOT EMI-ERRORS-COMPLETE
  2927         MOVE LINK-001           TO  PGM-NAME
  2928
  2929* EXEC CICS LINK
  2930*            PROGRAM   (PGM-NAME)
  2931*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  2932*            LENGTH    (EMI-COMM-LENGTH)
  2933*         END-EXEC.
  2934*    MOVE '."C                   ''   #00002601' TO DFHEIV0
  2935     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2936     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2937     MOVE X'2020233030303032363031' TO DFHEIV0(25:11)
  2938     CALL 'kxdfhei1' USING DFHEIV0,
  2939           PGM-NAME,
  2940           ERROR-MESSAGE-INTERFACE-BLOCK,
  2941           EMI-COMM-LENGTH,
  2942           DFHEIV99,
  2943           DFHEIV99,
  2944           DFHEIV99
  2945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2946
  2947
  2948 9900-EXIT.
  2949     EXIT.
  2950
  2951 9990-ABEND.
  2952     MOVE LINK-004               TO  PGM-NAME.
  2953     MOVE DFHEIBLK               TO  EMI-LINE1.
  2954
  2955* EXEC CICS LINK
  2956*        PROGRAM   (PGM-NAME)
  2957*        COMMAREA  (EMI-LINE1)
  2958*        LENGTH    (72)
  2959*    END-EXEC.
  2960     MOVE 72
  2961       TO DFHEIV11
  2962*    MOVE '."C                   ''   #00002613' TO DFHEIV0
  2963     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2964     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2965     MOVE X'2020233030303032363133' TO DFHEIV0(25:11)
  2966     CALL 'kxdfhei1' USING DFHEIV0,
  2967           PGM-NAME,
  2968           EMI-LINE1,
  2969           DFHEIV11,
  2970           DFHEIV99,
  2971           DFHEIV99,
  2972           DFHEIV99
  2973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2974
  2975
  2976     GO TO 8200-SEND-DATAONLY.
  2977
  2978 9999-DFHBACK SECTION.
  2979     MOVE '9%                    "   ' TO DFHEIV0
  2980     MOVE 'EL657' TO DFHEIV1
  2981     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL657.cbl
  2982     GOBACK.
  2983 9999-DFHEXIT.
  2984     IF DFHEIGDJ EQUAL 0001
  2985         NEXT SENTENCE
  2986     ELSE IF DFHEIGDJ EQUAL 2
  2987         GO TO 8100-SEND-INITIAL-MAP
  2988         DEPENDING ON DFHEIGDI
  2989     ELSE IF DFHEIGDJ EQUAL 3
  2990         GO TO 2500-CERT-NOT-FOUND
  2991         DEPENDING ON DFHEIGDI
  2992     ELSE IF DFHEIGDJ EQUAL 4
  2993         GO TO 7200-EXIT
  2994         DEPENDING ON DFHEIGDI
  2995     ELSE IF DFHEIGDJ EQUAL 5
  2996         GO TO 7300-EXIT
  2997         DEPENDING ON DFHEIGDI.
  2998     MOVE '9%                    "   ' TO DFHEIV0
  2999     MOVE 'EL657' TO DFHEIV1
  3000     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3001     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14832     Code:        7409
