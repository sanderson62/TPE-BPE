* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL1324.cbl
* Options: int("EL1324.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1324.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1324.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1324.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1324.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/13/96 09:48:12.
     7*                            VMOD=2.003
     8*
     9*
    10*AUTHOR.    LOGIC, INC.
    11*           DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL1324.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM PROVIDES THE QUALIFICATION NECESSARY FOR
    27*    THE ALPHA LOOK-UP.
    28
    29*    SCREENS     - EL132D  - ALPHA LOOK-UP QUALIFICATION
    30
    31*    ENTERED BY  - EL126 - MAINTENANCE MENU
    32*                  EL132 - CLAIM LOOK-UP
    33
    34*    EXIT TO     - CALLING PROGRAM
    35*                  EL1322 - CLAIM LOOK-UP FOR STATUS
    36
    37*    INPUT FILE  - ELALPH - ALPHA FILE
    38
    39*    OUTPUT FILE - NONE
    40
    41*    COMMAREA    - PASSED.  IF A NAME IS SELECED, THE CONTROL OF
    42*                  THAT NAME IS PLACED IN THE APPROPRIATE FIELDS
    43*                  OF THE COMMAREA FOR REFERENCE BY SUCCESSIVE
    44*                  PROGRAMS.  THE PROGRAM WORK AREA OF THE
    45*                  COMMAREA IS USED TO PASS THE RECORD KEY
    46*                  INFORMATION NEEDED BY EL1325 TO LOCATE THE
    47*                  NAME.
    48
    49*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL101.  ON
    50*                  FIRST ENTRY, A SKELETON SCREEN IS SENT AND THE
    51*                  PROGRAM EXITS TO WAIT FOR INPUT.  ON SUCCESSIVE
    52*                  ENTRIES (XCTL FROM CICS VIA EX21) THE SCREEN
    53*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    54*                  MAINTENANCE TYPE INDICATED.
    55******************************************************************
    56*                   C H A N G E   L O G
    57*
    58* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    59*-----------------------------------------------------------------
    60*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    61* EFFECTIVE    NUMBER
    62*-----------------------------------------------------------------
    63* 101501    2001100100006  SMVA  ADD USERID & CO ID TO SCREEN
    64******************************************************************
    65
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL1324.cbl
    67 ENVIRONMENT DIVISION.
    68
    69 DATA DIVISION.
    70
    71 WORKING-STORAGE SECTION.
    72 01  DFH-START PIC X(04).
    73
    74 77  FILLER  PIC X(32)  VALUE '********************************'.
    75 77  FILLER  PIC X(32)  VALUE '*  EL1324  WORKING STORAGE     *'.
    76 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.003 **********'.
    77
    78*                                COPY ELCSCTM.
    79******************************************************************
    80*                                                                *
    81*                                                                *
    82*                            ELCSCTM                             *
    83*                            VMOD=2.001                          *
    84*                                                                *
    85*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    86*                                                                *
    87******************************************************************
    88 01  SECURITY-MESSAGE.
    89     12  FILLER                          PIC X(30)
    90            VALUE '** LOGIC SECURITY VIOLATION -'.
    91     12  SM-READ                         PIC X(6).
    92     12  FILLER                          PIC X(5)
    93            VALUE ' PGM='.
    94     12  SM-PGM                          PIC X(6).
    95     12  FILLER                          PIC X(5)
    96            VALUE ' OPR='.
    97     12  SM-PROCESSOR-ID                 PIC X(4).
    98     12  FILLER                          PIC X(6)
    99            VALUE ' TERM='.
   100     12  SM-TERMID                       PIC X(4).
   101     12  FILLER                          PIC XX   VALUE SPACE.
   102     12  SM-JUL-DATE                     PIC 9(5).
   103     12  FILLER                          PIC X    VALUE SPACE.
   104     12  SM-TIME                         PIC 99.99.
   105
   106
   107*                                COPY ELCSCRTY.
   108******************************************************************
   109*                                                                *
   110*                                                                *
   111*                            ELCSCRTY                            *
   112*                            VMOD=2.001                          *
   113*                                                                *
   114*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   115*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   116*        SAVED IN PI-SECURITY-ADDRESS.                           *
   117*                                                                *
   118******************************************************************
   119 01  SECURITY-CONTROL.
   120     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   121     12  FILLER                       PIC XX    VALUE 'SC'.
   122     12  SC-CREDIT-CODES.
   123         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   124             20  SC-CREDIT-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL1324.cbl
   125             20  SC-CREDIT-UPDATE     PIC X.
   126     12  SC-CLAIMS-CODES.
   127         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   128             20  SC-CLAIMS-DISPLAY    PIC X.
   129             20  SC-CLAIMS-UPDATE     PIC X.
   130
   131 01  WS-DATE-AREA.
   132     12  SAVE-DATE               PIC X(8)    VALUE SPACES.
   133     12  SAVE-BIN-DATE           PIC X(2)    VALUE SPACES.
   134
   135 01  FILLER                          COMP-3.
   136
   137     12  TIME-IN                 PIC S9(7)   VALUE ZERO.
   138     12  TIME-OUT                    REDEFINES
   139         TIME-IN                 PIC S9(3)V9(4).
   140     12  WS-CALL-SW              PIC S9      VALUE ZERO.
   141
   142 01  FILLER                          COMP  SYNC.
   143
   144     12  SC-ITEM                 PIC S9(4)   VALUE +0001.
   145     12  WS-INDEX                PIC S9(4)   VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL1324.cbl
   147
   148 01  FILLER.
   149
   150     12  ALPHA-INDEX-DSID        PIC X(8)    VALUE 'ELALPH'.
   151     12  ALPHA2-INDEX-DSID       PIC X(8)    VALUE 'ELALPH2'.
   152     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   153     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   154     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   155
   156     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   157     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   158     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   159     12  XCTL-132                PIC X(8)    VALUE 'EL132'.
   160     12  XCTL-150                PIC X(8)    VALUE 'EL150'.
   161     12  XCTL-1324               PIC X(8)    VALUE 'EL1324'.
   162     12  XCTL-1325               PIC X(8)    VALUE 'EL1325'.
   163     12  THIS-PGM                PIC X(8)    VALUE 'EL1324'.
   164
   165     12  WS-MAPSET-NAME          PIC X(8)  VALUE 'EL1324S'.
   166     12  WS-MAP-NAME             PIC X(8)  VALUE 'EL1324A'.
   167     12  FILLER                      REDEFINES
   168         WS-MAP-NAME.
   169         16  FILLER              PIC X(2).
   170         16  WS-MAP-NUMBER       PIC X(4).
   171         16  FILLER              PIC X(2).
   172
   173     12  WS-TRANS-ID             PIC X(4)   VALUE 'E033'.
   174
   175     12  WS-INPUT-FIELD          PIC X(50)  VALUE SPACES.
   176     12  WS-INPUT-CHAR  REDEFINES  WS-INPUT-FIELD  PIC X(01)
   177              OCCURS 50 TIMES   INDEXED BY  INPUT-INDEX.
   178
   179 01  ERROR-MESSAGES.
   180     12  ER-0000                 PIC X(4)  VALUE '0000'.
   181     12  ER-0004                 PIC X(4)  VALUE '0004'.
   182     12  ER-0008                 PIC X(4)  VALUE '0008'.
   183     12  ER-0029                 PIC X(4)  VALUE '0029'.
   184     12  ER-0070                 PIC X(4)  VALUE '0070'.
   185     12  ER-0194                 PIC X(4)  VALUE '0194'.
   186     12  ER-0195                 PIC X(4)  VALUE '0195'.
   187     12  ER-0196                 PIC X(4)  VALUE '0196'.
   188     12  ER-0197                 PIC X(4)  VALUE '0197'.
   189     12  ER-0203                 PIC X(4)  VALUE '0203'.
   190     12  ER-0209                 PIC X(4)  VALUE '0209'.
   191     12  ER-0216                 PIC X(4)  VALUE '0216'.
   192     12  ER-0284                 PIC X(4)  VALUE '0284'.
   193     12  ER-0348                 PIC X(4)  VALUE '0348'.
   194     12  ER-0488                 PIC X(4)  VALUE '0488'.
   195     12  ER-0777                 PIC X(4)  VALUE '0777'.
   196     12  ER-2370                 PIC X(4)  VALUE '2370'.
   197     12  ER-2374                 PIC X(4)  VALUE '2374'.
   198
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL1324.cbl
   200*                                COPY ELCINTF.
   201******************************************************************
   202*                                                                *
   203*                                                                *
   204*                            ELCINTF.                            *
   205*                            VMOD=2.017                          *
   206*                                                                *
   207*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   208*                                                                *
   209*       LENGTH = 1024                                            *
   210*                                                                *
   211******************************************************************
   212 01  PROGRAM-INTERFACE-BLOCK.
   213     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   214     12  PI-CALLING-PROGRAM              PIC X(8).
   215     12  PI-SAVED-PROGRAM-1              PIC X(8).
   216     12  PI-SAVED-PROGRAM-2              PIC X(8).
   217     12  PI-SAVED-PROGRAM-3              PIC X(8).
   218     12  PI-SAVED-PROGRAM-4              PIC X(8).
   219     12  PI-SAVED-PROGRAM-5              PIC X(8).
   220     12  PI-SAVED-PROGRAM-6              PIC X(8).
   221     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   222     12  PI-COMPANY-ID                   PIC XXX.
   223     12  PI-COMPANY-CD                   PIC X.
   224
   225     12  PI-COMPANY-PASSWORD             PIC X(8).
   226
   227     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   228
   229     12  PI-CONTROL-IN-PROGRESS.
   230         16  PI-CARRIER                  PIC X.
   231         16  PI-GROUPING                 PIC X(6).
   232         16  PI-STATE                    PIC XX.
   233         16  PI-ACCOUNT                  PIC X(10).
   234         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   235                                         PIC X(10).
   236         16  PI-CLAIM-CERT-GRP.
   237             20  PI-CLAIM-NO             PIC X(7).
   238             20  PI-CERT-NO.
   239                 25  PI-CERT-PRIME       PIC X(10).
   240                 25  PI-CERT-SFX         PIC X.
   241             20  PI-CERT-EFF-DT          PIC XX.
   242         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   243             20  PI-PLAN-CODE            PIC X(2).
   244             20  PI-REVISION-NUMBER      PIC X(3).
   245             20  PI-PLAN-EFF-DT          PIC X(2).
   246             20  PI-PLAN-EXP-DT          PIC X(2).
   247             20  FILLER                  PIC X(11).
   248         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   249             20  PI-OE-REFERENCE-1.
   250                 25  PI-OE-REF-1-PRIME   PIC X(18).
   251                 25  PI-OE-REF-1-SUFF    PIC XX.
   252
   253     12  PI-SESSION-IN-PROGRESS          PIC X.
   254         88  CLAIM-SESSION                   VALUE '1'.
   255         88  CREDIT-SESSION                  VALUE '2'.
   256         88  WARRANTY-SESSION                VALUE '3'.
   257         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL1324.cbl
   258         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   259
   260
   261*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   262
   263     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   264     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   265
   266     12  PI-CREDIT-USER                  PIC X.
   267         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   268         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   269
   270     12  PI-CLAIM-USER                   PIC X.
   271         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   272         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   273
   274     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   275         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   276         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   277         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   278         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   279         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   280
   281     12  PI-PROCESSOR-ID                 PIC X(4).
   282
   283     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   284
   285     12  PI-MEMBER-CAPTION               PIC X(10).
   286
   287     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   288         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   289
   290     12  PI-LIFE-OVERRIDE-L1             PIC X.
   291     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   292     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   293     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   294
   295     12  PI-AH-OVERRIDE-L1               PIC X.
   296     12  PI-AH-OVERRIDE-L2               PIC XX.
   297     12  PI-AH-OVERRIDE-L6               PIC X(6).
   298     12  PI-AH-OVERRIDE-L12              PIC X(12).
   299
   300     12  PI-NEW-SYSTEM                   PIC X(2).
   301
   302     12  PI-PRIMARY-CERT-NO              PIC X(11).
   303     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   304         88  PI-USES-PAID-TO                 VALUE '1'.
   305     12  PI-CRDTCRD-SYSTEM.
   306         16  PI-CRDTCRD-USER             PIC X.
   307             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   308             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   309         16  PI-CC-MONTH-END-DT          PIC XX.
   310     12  PI-PROCESSOR-PRINTER            PIC X(4).
   311
   312     12  PI-OE-REFERENCE-2.
   313         16  PI-OE-REF-2-PRIME           PIC X(10).
   314         16  PI-OE-REF-2-SUFF            PIC X.
   315
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL1324.cbl
   316     12  PI-REM-TRM-CALC-OPTION          PIC X.
   317
   318     12  PI-LANGUAGE-TYPE                PIC X.
   319             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   320             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   321             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   322
   323     12  PI-POLICY-LINKAGE-IND           PIC X.
   324         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   325         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   326                                                   LOW-VALUES.
   327
   328     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   329     12  PI-CLAIM-PW-SESSION             PIC X(1).
   330         88  PI-CLAIM-CREDIT                 VALUE '1'.
   331         88  PI-CLAIM-CONVEN                 VALUE '2'.
   332     12  FILLER                          PIC X(4).
   333
   334     12  PI-SYSTEM-LEVEL                 PIC X(145).
   335
   336     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   337         PI-SYSTEM-LEVEL.
   338
   339         16  PI-ENTRY-CODES.
   340             20  PI-ENTRY-CD-1           PIC X.
   341             20  PI-ENTRY-CD-2           PIC X.
   342
   343         16  PI-RETURN-CODES.
   344             20  PI-RETURN-CD-1          PIC X.
   345             20  PI-RETURN-CD-2          PIC X.
   346
   347         16  PI-UPDATE-STATUS-SAVE.
   348             20  PI-UPDATE-BY            PIC X(4).
   349             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   350
   351         16  PI-LOWER-CASE-LETTERS       PIC X.
   352             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   353
   354*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   355*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   356*            88  CARRIER-CLM-CNTL            VALUE '2'.
   357
   358         16  PI-CERT-ACCESS-CONTROL      PIC X.
   359             88  ST-ACCNT-CNTL               VALUE ' '.
   360             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   361             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   362             88  ACCNT-CNTL                  VALUE '3'.
   363             88  CARR-ACCNT-CNTL             VALUE '4'.
   364
   365         16  PI-PROCESSOR-CAP-LIST.
   366             20  PI-SYSTEM-CONTROLS.
   367                24 PI-SYSTEM-DISPLAY     PIC X.
   368                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   369                24 PI-SYSTEM-MODIFY      PIC X.
   370                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   371             20  FILLER                  PIC XX.
   372             20  PI-DISPLAY-CAP          PIC X.
   373                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL1324.cbl
   374             20  PI-MODIFY-CAP           PIC X.
   375                 88  MODIFY-CAP              VALUE 'Y'.
   376             20  PI-MSG-AT-LOGON-CAP     PIC X.
   377                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   378             20  PI-FORCE-CAP            PIC X.
   379                 88  FORCE-CAP               VALUE 'Y'.
   380
   381         16  PI-PROGRAM-CONTROLS.
   382             20  PI-PGM-PRINT-OPT        PIC X.
   383             20  PI-PGM-FORMAT-OPT       PIC X.
   384             20  PI-PGM-PROCESS-OPT      PIC X.
   385             20  PI-PGM-TOTALS-OPT       PIC X.
   386
   387         16  PI-HELP-INTERFACE.
   388             20  PI-LAST-ERROR-NO        PIC X(4).
   389             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   390
   391         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   392             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   393
   394         16  PI-CR-CONTROL-IN-PROGRESS.
   395             20  PI-CR-CARRIER           PIC X.
   396             20  PI-CR-GROUPING          PIC X(6).
   397             20  PI-CR-STATE             PIC XX.
   398             20  PI-CR-ACCOUNT           PIC X(10).
   399             20  PI-CR-FIN-RESP          PIC X(10).
   400             20  PI-CR-TYPE              PIC X.
   401
   402         16  PI-CR-BATCH-NUMBER          PIC X(6).
   403
   404         16  PI-CR-MONTH-END-DT          PIC XX.
   405
   406         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   407             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   408             88  PI-ZERO-CARRIER             VALUE '1'.
   409             88  PI-ZERO-GROUPING            VALUE '2'.
   410             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   411
   412         16  PI-CARRIER-SECURITY         PIC X.
   413             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   414
   415         16  PI-ACCOUNT-SECURITY         PIC X(10).
   416             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   417             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   418
   419         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   420             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   421                                         INDEXED BY PI-ACCESS-NDX
   422                                         PIC X.
   423
   424         16  PI-GA-BILLING-CONTROL       PIC X.
   425             88  PI-GA-BILLING               VALUE '1'.
   426
   427         16  PI-MAIL-PROCESSING          PIC X.
   428             88  PI-MAIL-YES                 VALUE 'Y'.
   429
   430         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   431
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL1324.cbl
   432         16  PI-AR-SYSTEM.
   433             20  PI-AR-PROCESSING-CNTL   PIC X.
   434                 88  PI-AR-PROCESSING        VALUE 'Y'.
   435             20  PI-AR-SUMMARY-CODE      PIC X(6).
   436             20  PI-AR-MONTH-END-DT      PIC XX.
   437
   438         16  PI-MP-SYSTEM.
   439             20  PI-MORTGAGE-USER            PIC X.
   440                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   441                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   442             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   443                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   444                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   445                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   446                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   447                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   448             20  PI-MP-MONTH-END-DT          PIC XX.
   449             20  PI-MP-REFERENCE-NO.
   450                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   451                 24  PI-MP-REFERENCE-SFX     PIC XX.
   452
   453         16  PI-LABEL-CONTROL            PIC X(01).
   454             88  PI-CREATE-LABELS                    VALUE 'Y'.
   455             88  PI-BYPASS-LABELS                    VALUE 'N'.
   456
   457         16  PI-BILL-GROUPING-CODE       PIC X(01).
   458             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   459
   460         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   461             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   462             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   463
   464         16  FILLER                      PIC X(14).
   465
   466     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   467******************************************************************
   468
   469*                                COPY ELC132PI.
   470*****************************************************************
   471*                                                               *
   472*                                                               *
   473*                            ELC132PI.                          *
   474*                            VMOD=2.004                         *
   475*****************************************************************.
   476
   477     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
   478         16  PI-1ST-TIME-SW              PIC S9       COMP-3.
   479         16  PI-LINE-COUNT               PIC S9(3)    COMP-3.
   480         16  PI-AIX-RECORD-COUNT         PIC S9(5)    COMP-3.
   481         16  PI-BROWSE-SW                PIC S9       COMP-3.
   482         16  PI-START-SW                 PIC S9       COMP-3.
   483         16  PI-END-OF-FILE              PIC S9       COMP-3.
   484         16  PI-DSID                     PIC X(8).
   485
   486         16  PI-KEEP-CERT-NO     PIC X(11)   OCCURS 16
   487                     INDEXED BY PI-K-INDEX.
   488
   489         16  PI-OPTION                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL1324.cbl
   490             88  NO-OPTION-SELECTED           VALUE ZERO.
   491             88  OPTION-ONE-SELECTED          VALUE '1'.
   492             88  OPTION-TWO-SELECTED          VALUE '2'.
   493             88  OPTION-THREE-SELECTED        VALUE '3'.
   494             88  OPTION-FOUR-SELECTED         VALUE '4'.
   495             88  OPTION-FIVE-SELECTED         VALUE '5'.
   496
   497         16  PI-SELECTION-CRITERIA.
   498             20  PI-SC-COMPANY-CD        PIC X.
   499             20  PI-SC-CARRIER           PIC X.
   500             20  PI-SC-CLAIM-NO          PIC X(7).
   501             20  PI-SC-CERT-NO.
   502                 25  PI-SC-CERT-PRIME    PIC X(10).
   503                 25  PI-SC-CERT-SFX      PIC X.
   504             20  FILLER                  PIC X(09).
   505
   506         16  FILLER REDEFINES PI-SELECTION-CRITERIA.
   507             20  FILLER                  PIC X.
   508             20  PI-SC-LAST-NAME         PIC X(15).
   509             20  PI-SC-INITIALS.
   510                 25  PI-SC-FIRST-NAME    PIC X(12).
   511                 25  PI-SC-INITIAL2      PIC X.
   512
   513         16  FILLER REDEFINES PI-SELECTION-CRITERIA.
   514             20  FILLER                  PIC X.
   515             20  PI-SC-SOC-SEC-NO        PIC X(11).
   516             20  FILLER                  PIC X(17).
   517
   518         16  FILLER REDEFINES PI-SELECTION-CRITERIA.
   519             20  FILLER                  PIC X.
   520             20  PI-SC-CERT-NO-A4.
   521                 25  PI-SC-CERT-PRIME-A4 PIC X(10).
   522                 25  PI-SC-CERT-SFX-A4   PIC X.
   523             20  FILLER                  PIC X(17).
   524
   525         16  FILLER REDEFINES PI-SELECTION-CRITERIA.
   526             20  FILLER                  PIC X.
   527             20  PI-SC-CCN-NO-A5         PIC X(20).
   528             20  FILLER                  PIC X(8).
   529
   530         16  PI-CLAIM-KEY.
   531             20  PI-CK-COMPANY-CD        PIC X.
   532             20  PI-CK-CARRIER           PIC X.
   533             20  PI-CK-CLAIM             PIC X(7).
   534             20  PI-CK-CERT-NO.
   535                 25  PI-CK-CERT-PRIME    PIC X(10).
   536                 25  PI-CK-CERT-SFX      PIC X.
   537             20  FILLER                  PIC X(09).
   538
   539         16  FILLER REDEFINES PI-CLAIM-KEY.
   540             20  FILLER                  PIC X.
   541             20  PI-CK-INSURED-LAST-NAME PIC X(15).
   542             20  PI-CK-INSURED-FRST-NAME PIC X(12).
   543             20  PI-CK-INSURED-MID-INIT  PIC X.
   544
   545         16  FILLER REDEFINES PI-CLAIM-KEY.
   546             20  FILLER                  PIC X.
   547             20  PI-CK-SOC-SEC-NO        PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL1324.cbl
   548             20  FILLER                  PIC X(17).
   549
   550         16  FILLER REDEFINES PI-CLAIM-KEY.
   551             20  FILLER                  PIC X.
   552             20  PI-CK-CERT-NO-A4.
   553                 25  PI-CK-CERT-PRIME-A4 PIC X(10).
   554                 25  PI-CK-CERT-SFX-A4   PIC X.
   555             20  FILLER                  PIC X(17).
   556
   557         16  FILLER REDEFINES PI-CLAIM-KEY.
   558             20  FILLER                  PIC X.
   559             20  PI-CK-CCN-NO-A5         PIC X(20).
   560             20  FILLER                  PIC X(8).
   561
   562         16  PI-LAST-EIBAID              PIC X.
   563         16  PI-SCREEN-COUNT             PIC S9(5)  COMP-3.
   564
   565         16  PI-KEY-LENGTH               PIC S9(4) COMP SYNC.
   566         16  PI-TS-ITEM                  PIC S9(4) COMP SYNC.
   567         16  PI-1ST-ALPH-KEY.
   568             20  PI-1ST-KEY            PIC X(29).
   569             20  FILLER                PIC X(15).
   570         16  PI-LAST-ALPH-KEY.
   571             20  PI-LAST-KEY           PIC X(29).
   572             20  FILLER                PIC X(15).
   573
   574         16  PI-SAVE-AREA            OCCURS 16 TIMES
   575             INDEXED BY PI-INDEX.
   576             20  PI-SA-STATE             PIC X(2).
   577             20  PI-SA-GROUP             PIC X(6).
   578             20  PI-SA-EFF-DATE          PIC X(2).
   579
   580         16  PI-LAST-NAME                PIC X(15).
   581         16  PI-ACCOUNT-NUMBER           PIC X(10).
   582         16  PI-CCN-NO                   PIC X(20).
   583         16  PI-CREDIT-CARD-INDEX        PIC X.
   584             88  CREDIT-CARD-INDEX            VALUE 'Y'.
   585
   586         16  PI-ALPH-CLAIM-KEY.
   587             20  PI-ALPH-CO-CD          PIC X(01).
   588             20  PI-ALPH-SOURCE         PIC X(01).
   589             20  PI-ALPH-NAME.
   590                 24  PI-ALPH-LAST-NAME  PIC X(15).
   591                 24  PI-ALPH-FRST-NAME.
   592                     28  PI-ALPH-F-INIT PIC X(01).
   593                     28  FILLER         PIC X(11).
   594                 24  PI-ALPH-MID-INIT   PIC X(01).
   595             20  PI-ALPH-DATE           PIC X(08).
   596             20  PI-ALPH-TIME           PIC S9(04)  COMP.
   597
   598         16  PI-ALPH-ADMIN-KEY.
   599             20  PI-ADM-COMP-CD        PIC X(01).
   600             20  PI-ADM-SOURCE         PIC X(01).
   601             20  PI-ADM-CARRIER        PIC X(01).
   602             20  PI-ADM-GROUPING.
   603                 24  PI-ADM-GRP-PREFIX PIC X(03).
   604                 24  PI-ADM-GRP-PRIME  PIC X(03).
   605             20  PI-ADM-STATE          PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL1324.cbl
   606             20  PI-ADM-PRODUCER.
   607                 24  PI-ADM-PROD-PRE   PIC X(04).
   608                 24  PI-ADM-PROD-PRM   PIC X(06).
   609             20  PI-ADM-CERT-EFF-DT    PIC X(02).
   610             20  PI-ADM-CERT-NUMBER.
   611                 24  PI-ADM-CERT-PRM   PIC X(10).
   612                 24  PI-ADM-CERT-SFX   PIC X(01).
   613             20  PI-ADM-DATE           PIC X(08).
   614             20  PI-ADM-TIME           PIC S9(04)  COMP.
   615
   616         16  P1-CLAIM-KEY   REDEFINES PI-ALPH-ADMIN-KEY.
   617             20  PI-CLM-COMP-CD        PIC X(01).
   618             20  PI-CLM-SOURCE         PIC X(01).
   619             20  PI-CLM-CARRIER        PIC X(01).
   620             20  PI-CLM-CLAIM-NO       PIC X(07).
   621             20  PI-CLM-CERT-NUMBER.
   622                 24  PI-CLM-CERT-PRM   PIC X(10).
   623                 24  PI-CLM-CERT-SFX   PIC X(01).
   624             20  PI-CLM-DATE           PIC X(08).
   625             20  PI-CLM-TIME           PIC S9(04)  COMP.
   626             20  FILLER                PIC X(13).
   627
   628         16  FILLER                    PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL1324.cbl
   630*                                COPY ELCEMIB.
   631******************************************************************
   632*                                                                *
   633*                                                                *
   634*                            ELCEMIB.                            *
   635*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   636*                            VMOD=2.005                          *
   637*                                                                *
   638*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   639*                                                                *
   640******************************************************************
   641 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   642     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   643     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   644     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   645     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   646     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   647     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   648     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   649     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   650     12  EMI-SWITCH1             PIC X        VALUE '1'.
   651         88  EMI-NO-ERRORS                    VALUE '1'.
   652         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   653         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   654     12  EMI-SWITCH2             PIC X        VALUE '1'.
   655         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   656     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   657         88  EMI-AREA1-EMPTY                  VALUE '1'.
   658         88  EMI-AREA1-FULL                   VALUE '2'.
   659     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   660         88  EMI-AREA2-EMPTY                  VALUE '1'.
   661         88  EMI-AREA2-FULL                   VALUE '2'.
   662     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   663         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   664         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   665         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   666         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   667         88  EMI-BYPASS-FATALS                VALUE 'X'.
   668     12  EMI-ERROR-LINES.
   669         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   670         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   671         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   672         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   673             20  EMI-ERR-CODES OCCURS 10 TIMES.
   674                 24  EMI-ERR-NUM         PIC X(4).
   675                 24  EMI-FILLER          PIC X.
   676                 24  EMI-SEV             PIC X.
   677                 24  FILLER              PIC X.
   678             20  FILLER                  PIC X(02).
   679     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   680         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   681             20  EMI-ERROR-NUMBER    PIC X(4).
   682             20  EMI-FILL            PIC X.
   683             20  EMI-SEVERITY        PIC X.
   684             20  FILLER              PIC X.
   685             20  EMI-ERROR-TEXT.
   686                 24  EMI-TEXT-VARIABLE   PIC X(10).
   687                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL1324.cbl
   688     12  EMI-SEVERITY-SAVE           PIC X.
   689         88  EMI-NOTE                    VALUE 'N'.
   690         88  EMI-WARNING                 VALUE 'W'.
   691         88  EMI-FORCABLE                VALUE 'F'.
   692         88  EMI-FATAL                   VALUE 'X'.
   693     12  EMI-MESSAGE-FLAG            PIC X.
   694         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   695         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   696     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   697     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   698         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   699         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   700         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   701     12  FILLER                      PIC X(137)  VALUE SPACES.
   702     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   703     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   704     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   705     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   706
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL1324.cbl
   708*                                COPY ELCDATE.
   709******************************************************************
   710*                                                                *
   711*                                                                *
   712*                            ELCDATE.                            *
   713*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   714*                            VMOD=2.003
   715*                                                                *
   716*                                                                *
   717*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   718*                 LENGTH = 200                                   *
   719******************************************************************
   720
   721 01  DATE-CONVERSION-DATA.
   722     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   723     12  DC-OPTION-CODE                PIC X.
   724         88  BIN-TO-GREG                VALUE ' '.
   725         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   726         88  EDIT-GREG-TO-BIN           VALUE '2'.
   727         88  YMD-GREG-TO-BIN            VALUE '3'.
   728         88  MDY-GREG-TO-BIN            VALUE '4'.
   729         88  JULIAN-TO-BIN              VALUE '5'.
   730         88  BIN-PLUS-ELAPSED           VALUE '6'.
   731         88  FIND-CENTURY               VALUE '7'.
   732         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   733         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   734         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   735         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   736         88  JULIAN-TO-BIN-3            VALUE 'C'.
   737         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   738         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   739         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   740         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   741         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   742         88  CHECK-LEAP-YEAR            VALUE 'H'.
   743         88  BIN-3-TO-GREG              VALUE 'I'.
   744         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   745         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   746         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   747         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   748         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   749         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   750         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   751         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   752         88  THREE-CHARACTER-BIN
   753                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   754         88  GREGORIAN-TO-BIN
   755                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   756         88  BIN-TO-GREGORIAN
   757                  VALUES ' ' '1' 'I' '8' 'G'.
   758         88  JULIAN-TO-BINARY
   759                  VALUES '5' 'C' 'E' 'F'.
   760     12  DC-ERROR-CODE                 PIC X.
   761         88  NO-CONVERSION-ERROR        VALUE ' '.
   762         88  DATE-CONVERSION-ERROR
   763                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   764         88  DATE-IS-ZERO               VALUE '1'.
   765         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL1324.cbl
   766         88  DATE-IS-INVALID            VALUE '3'.
   767         88  DATE1-GREATER-DATE2        VALUE '4'.
   768         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   769         88  DATE-INVALID-OPTION        VALUE '9'.
   770         88  INVALID-CENTURY            VALUE 'A'.
   771         88  ONLY-CENTURY               VALUE 'B'.
   772         88  ONLY-LEAP-YEAR             VALUE 'C'.
   773         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   774     12  DC-END-OF-MONTH               PIC X.
   775         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   776     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   777         88  USE-NORMAL-PROCESS         VALUE ' '.
   778         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   779         88  ADJUST-UP-100-YRS          VALUE '2'.
   780     12  FILLER                        PIC X.
   781     12  DC-CONVERSION-DATES.
   782         16  DC-BIN-DATE-1             PIC XX.
   783         16  DC-BIN-DATE-2             PIC XX.
   784         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   785         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   786                       DC-GREG-DATE-1-EDIT.
   787             20  DC-EDIT1-MONTH        PIC 99.
   788             20  SLASH1-1              PIC X.
   789             20  DC-EDIT1-DAY          PIC 99.
   790             20  SLASH1-2              PIC X.
   791             20  DC-EDIT1-YEAR         PIC 99.
   792         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   793         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   794                     DC-GREG-DATE-2-EDIT.
   795             20  DC-EDIT2-MONTH        PIC 99.
   796             20  SLASH2-1              PIC X.
   797             20  DC-EDIT2-DAY          PIC 99.
   798             20  SLASH2-2              PIC X.
   799             20  DC-EDIT2-YEAR         PIC 99.
   800         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   801         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   802                     DC-GREG-DATE-1-YMD.
   803             20  DC-YMD-YEAR           PIC 99.
   804             20  DC-YMD-MONTH          PIC 99.
   805             20  DC-YMD-DAY            PIC 99.
   806         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   807         16  DC-GREG-DATE-1-MDY-R REDEFINES
   808                      DC-GREG-DATE-1-MDY.
   809             20  DC-MDY-MONTH          PIC 99.
   810             20  DC-MDY-DAY            PIC 99.
   811             20  DC-MDY-YEAR           PIC 99.
   812         16  DC-GREG-DATE-1-ALPHA.
   813             20  DC-ALPHA-MONTH        PIC X(10).
   814             20  DC-ALPHA-DAY          PIC 99.
   815             20  FILLER                PIC XX.
   816             20  DC-ALPHA-CENTURY.
   817                 24 DC-ALPHA-CEN-N     PIC 99.
   818             20  DC-ALPHA-YEAR         PIC 99.
   819         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   820         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   821         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   822         16  DC-JULIAN-DATE            PIC 9(05).
   823         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL1324.cbl
   824                                       PIC 9(05).
   825         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   826             20  DC-JULIAN-YEAR        PIC 99.
   827             20  DC-JULIAN-DAYS        PIC 999.
   828         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   829         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   830         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   831     12  DATE-CONVERSION-VARIBLES.
   832         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   833         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   834             20  FILLER                PIC 9(3).
   835             20  HOLD-CEN-1-CCYY.
   836                 24  HOLD-CEN-1-CC     PIC 99.
   837                 24  HOLD-CEN-1-YY     PIC 99.
   838             20  HOLD-CEN-1-MO         PIC 99.
   839             20  HOLD-CEN-1-DA         PIC 99.
   840         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   841             20  HOLD-CEN-1-R-MO       PIC 99.
   842             20  HOLD-CEN-1-R-DA       PIC 99.
   843             20  HOLD-CEN-1-R-CCYY.
   844                 24  HOLD-CEN-1-R-CC   PIC 99.
   845                 24  HOLD-CEN-1-R-YY   PIC 99.
   846             20  FILLER                PIC 9(3).
   847         16  HOLD-CENTURY-1-X.
   848             20  FILLER                PIC X(3)  VALUE SPACES.
   849             20  HOLD-CEN-1-X-CCYY.
   850                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   851                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   852             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   853             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   854         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   855             20  HOLD-CEN-1-R-X-MO     PIC XX.
   856             20  HOLD-CEN-1-R-X-DA     PIC XX.
   857             20  HOLD-CEN-1-R-X-CCYY.
   858                 24  HOLD-CEN-1-R-X-CC PIC XX.
   859                 24  HOLD-CEN-1-R-X-YY PIC XX.
   860             20  FILLER                PIC XXX.
   861         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   862         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   863         16  DC-JULIAN-DATE-1          PIC 9(07).
   864         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   865             20  DC-JULIAN-1-CCYY.
   866                 24  DC-JULIAN-1-CC    PIC 99.
   867                 24  DC-JULIAN-1-YR    PIC 99.
   868             20  DC-JULIAN-DA-1        PIC 999.
   869         16  DC-JULIAN-DATE-2          PIC 9(07).
   870         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   871             20  DC-JULIAN-2-CCYY.
   872                 24  DC-JULIAN-2-CC    PIC 99.
   873                 24  DC-JULIAN-2-YR    PIC 99.
   874             20  DC-JULIAN-DA-2        PIC 999.
   875         16  DC-GREG-DATE-A-EDIT.
   876             20  DC-EDITA-MONTH        PIC 99.
   877             20  SLASHA-1              PIC X VALUE '/'.
   878             20  DC-EDITA-DAY          PIC 99.
   879             20  SLASHA-2              PIC X VALUE '/'.
   880             20  DC-EDITA-CCYY.
   881                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL1324.cbl
   882                 24  DC-EDITA-YEAR     PIC 99.
   883         16  DC-GREG-DATE-B-EDIT.
   884             20  DC-EDITB-MONTH        PIC 99.
   885             20  SLASHB-1              PIC X VALUE '/'.
   886             20  DC-EDITB-DAY          PIC 99.
   887             20  SLASHB-2              PIC X VALUE '/'.
   888             20  DC-EDITB-CCYY.
   889                 24  DC-EDITB-CENT     PIC 99.
   890                 24  DC-EDITB-YEAR     PIC 99.
   891         16  DC-GREG-DATE-CYMD         PIC 9(08).
   892         16  DC-GREG-DATE-CYMD-R REDEFINES
   893                              DC-GREG-DATE-CYMD.
   894             20  DC-CYMD-CEN           PIC 99.
   895             20  DC-CYMD-YEAR          PIC 99.
   896             20  DC-CYMD-MONTH         PIC 99.
   897             20  DC-CYMD-DAY           PIC 99.
   898         16  DC-GREG-DATE-MDCY         PIC 9(08).
   899         16  DC-GREG-DATE-MDCY-R REDEFINES
   900                              DC-GREG-DATE-MDCY.
   901             20  DC-MDCY-MONTH         PIC 99.
   902             20  DC-MDCY-DAY           PIC 99.
   903             20  DC-MDCY-CEN           PIC 99.
   904             20  DC-MDCY-YEAR          PIC 99.
   905    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   906        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   907    12  DC-EL310-DATE                  PIC X(21).
   908    12  FILLER                         PIC X(28).
   909
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL1324.cbl
   911*                                COPY EL1324S.
   912 01  EL1324AI.
   913     05  FILLER            PIC  X(0012).
   914*    -------------------------------
   915     05  ALDATEL PIC S9(0004) COMP.
   916     05  ALDATEF PIC  X(0001).
   917     05  FILLER REDEFINES ALDATEF.
   918         10  ALDATEA PIC  X(0001).
   919     05  ALDATEI PIC  X(0008).
   920*    -------------------------------
   921     05  ALTIMEL PIC S9(0004) COMP.
   922     05  ALTIMEF PIC  X(0001).
   923     05  FILLER REDEFINES ALTIMEF.
   924         10  ALTIMEA PIC  X(0001).
   925     05  ALTIMEI PIC  X(0005).
   926*    -------------------------------
   927     05  ALCOMPL PIC S9(0004) COMP.
   928     05  ALCOMPF PIC  X(0001).
   929     05  FILLER REDEFINES ALCOMPF.
   930         10  ALCOMPA PIC  X(0001).
   931     05  ALCOMPI PIC  X(0003).
   932*    -------------------------------
   933     05  USERIDL PIC S9(0004) COMP.
   934     05  USERIDF PIC  X(0001).
   935     05  FILLER REDEFINES USERIDF.
   936         10  USERIDA PIC  X(0001).
   937     05  USERIDI PIC  X(0004).
   938*    -------------------------------
   939     05  ALLNAMEL PIC S9(0004) COMP.
   940     05  ALLNAMEF PIC  X(0001).
   941     05  FILLER REDEFINES ALLNAMEF.
   942         10  ALLNAMEA PIC  X(0001).
   943     05  ALLNAMEI PIC  X(0015).
   944*    -------------------------------
   945     05  ALFNAMEL PIC S9(0004) COMP.
   946     05  ALFNAMEF PIC  X(0001).
   947     05  FILLER REDEFINES ALFNAMEF.
   948         10  ALFNAMEA PIC  X(0001).
   949     05  ALFNAMEI PIC  X(0012).
   950*    -------------------------------
   951     05  ALINTALL PIC S9(0004) COMP.
   952     05  ALINTALF PIC  X(0001).
   953     05  FILLER REDEFINES ALINTALF.
   954         10  ALINTALA PIC  X(0001).
   955     05  ALINTALI PIC  X(0001).
   956*    -------------------------------
   957     05  ALCLMNOL PIC S9(0004) COMP.
   958     05  ALCLMNOF PIC  X(0001).
   959     05  FILLER REDEFINES ALCLMNOF.
   960         10  ALCLMNOA PIC  X(0001).
   961     05  ALCLMNOI PIC  X(0007).
   962*    -------------------------------
   963     05  ALCARNOL PIC S9(0004) COMP.
   964     05  ALCARNOF PIC  X(0001).
   965     05  FILLER REDEFINES ALCARNOF.
   966         10  ALCARNOA PIC  X(0001).
   967     05  ALCARNOI PIC  X(0001).
   968*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL1324.cbl
   969     05  ALCERTL PIC S9(0004) COMP.
   970     05  ALCERTF PIC  X(0001).
   971     05  FILLER REDEFINES ALCERTF.
   972         10  ALCERTA PIC  X(0001).
   973     05  ALCERTI PIC  X(0010).
   974*    -------------------------------
   975     05  ALCRTSXL PIC S9(0004) COMP.
   976     05  ALCRTSXF PIC  X(0001).
   977     05  FILLER REDEFINES ALCRTSXF.
   978         10  ALCRTSXA PIC  X(0001).
   979     05  ALCRTSXI PIC  X(0001).
   980*    -------------------------------
   981     05  ALFCARRL PIC S9(0004) COMP.
   982     05  ALFCARRF PIC  X(0001).
   983     05  FILLER REDEFINES ALFCARRF.
   984         10  ALFCARRA PIC  X(0001).
   985     05  ALFCARRI PIC  X(0001).
   986*    -------------------------------
   987     05  ALFGRPL PIC S9(0004) COMP.
   988     05  ALFGRPF PIC  X(0001).
   989     05  FILLER REDEFINES ALFGRPF.
   990         10  ALFGRPA PIC  X(0001).
   991     05  ALFGRPI PIC  X(0006).
   992*    -------------------------------
   993     05  ALFSTL PIC S9(0004) COMP.
   994     05  ALFSTF PIC  X(0001).
   995     05  FILLER REDEFINES ALFSTF.
   996         10  ALFSTA PIC  X(0001).
   997     05  ALFSTI PIC  X(0002).
   998*    -------------------------------
   999     05  ALFACCTL PIC S9(0004) COMP.
  1000     05  ALFACCTF PIC  X(0001).
  1001     05  FILLER REDEFINES ALFACCTF.
  1002         10  ALFACCTA PIC  X(0001).
  1003     05  ALFACCTI PIC  X(0010).
  1004*    -------------------------------
  1005     05  ALFEFDTL PIC S9(0004) COMP.
  1006     05  ALFEFDTF PIC  X(0001).
  1007     05  FILLER REDEFINES ALFEFDTF.
  1008         10  ALFEFDTA PIC  X(0001).
  1009     05  ALFEFDTI PIC  X(0008).
  1010*    -------------------------------
  1011     05  ALFCERTL PIC S9(0004) COMP.
  1012     05  ALFCERTF PIC  X(0001).
  1013     05  FILLER REDEFINES ALFCERTF.
  1014         10  ALFCERTA PIC  X(0001).
  1015     05  ALFCERTI PIC  X(0010).
  1016*    -------------------------------
  1017     05  ALFCRTXL PIC S9(0004) COMP.
  1018     05  ALFCRTXF PIC  X(0001).
  1019     05  FILLER REDEFINES ALFCRTXF.
  1020         10  ALFCRTXA PIC  X(0001).
  1021     05  ALFCRTXI PIC  X(0001).
  1022*    -------------------------------
  1023     05  ALFLNMEL PIC S9(0004) COMP.
  1024     05  ALFLNMEF PIC  X(0001).
  1025     05  FILLER REDEFINES ALFLNMEF.
  1026         10  ALFLNMEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL1324.cbl
  1027     05  ALFLNMEI PIC  X(0015).
  1028*    -------------------------------
  1029     05  ALFFNMEL PIC S9(0004) COMP.
  1030     05  ALFFNMEF PIC  X(0001).
  1031     05  FILLER REDEFINES ALFFNMEF.
  1032         10  ALFFNMEA PIC  X(0001).
  1033     05  ALFFNMEI PIC  X(0012).
  1034*    -------------------------------
  1035     05  ALFINTLL PIC S9(0004) COMP.
  1036     05  ALFINTLF PIC  X(0001).
  1037     05  FILLER REDEFINES ALFINTLF.
  1038         10  ALFINTLA PIC  X(0001).
  1039     05  ALFINTLI PIC  X(0001).
  1040*    -------------------------------
  1041     05  ALFMSG1L PIC S9(0004) COMP.
  1042     05  ALFMSG1F PIC  X(0001).
  1043     05  FILLER REDEFINES ALFMSG1F.
  1044         10  ALFMSG1A PIC  X(0001).
  1045     05  ALFMSG1I PIC  X(0079).
  1046*    -------------------------------
  1047     05  ALFMSG2L PIC S9(0004) COMP.
  1048     05  ALFMSG2F PIC  X(0001).
  1049     05  FILLER REDEFINES ALFMSG2F.
  1050         10  ALFMSG2A PIC  X(0001).
  1051     05  ALFMSG2I PIC  X(0079).
  1052*    -------------------------------
  1053     05  ALFPFKL PIC S9(0004) COMP.
  1054     05  ALFPFKF PIC  X(0001).
  1055     05  FILLER REDEFINES ALFPFKF.
  1056         10  ALFPFKA PIC  X(0001).
  1057     05  ALFPFKI PIC  99.
  1058 01  EL1324AO REDEFINES EL1324AI.
  1059     05  FILLER            PIC  X(0012).
  1060*    -------------------------------
  1061     05  FILLER            PIC  X(0003).
  1062     05  ALDATEO PIC  X(0008).
  1063*    -------------------------------
  1064     05  FILLER            PIC  X(0003).
  1065     05  ALTIMEO PIC  99.99.
  1066*    -------------------------------
  1067     05  FILLER            PIC  X(0003).
  1068     05  ALCOMPO PIC  X(0003).
  1069*    -------------------------------
  1070     05  FILLER            PIC  X(0003).
  1071     05  USERIDO PIC  X(0004).
  1072*    -------------------------------
  1073     05  FILLER            PIC  X(0003).
  1074     05  ALLNAMEO PIC  X(0015).
  1075*    -------------------------------
  1076     05  FILLER            PIC  X(0003).
  1077     05  ALFNAMEO PIC  X(0012).
  1078*    -------------------------------
  1079     05  FILLER            PIC  X(0003).
  1080     05  ALINTALO PIC  X(0001).
  1081*    -------------------------------
  1082     05  FILLER            PIC  X(0003).
  1083     05  ALCLMNOO PIC  X(0007).
  1084*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL1324.cbl
  1085     05  FILLER            PIC  X(0003).
  1086     05  ALCARNOO PIC  X(0001).
  1087*    -------------------------------
  1088     05  FILLER            PIC  X(0003).
  1089     05  ALCERTO PIC  X(0010).
  1090*    -------------------------------
  1091     05  FILLER            PIC  X(0003).
  1092     05  ALCRTSXO PIC  X(0001).
  1093*    -------------------------------
  1094     05  FILLER            PIC  X(0003).
  1095     05  ALFCARRO PIC  X(0001).
  1096*    -------------------------------
  1097     05  FILLER            PIC  X(0003).
  1098     05  ALFGRPO PIC  X(0006).
  1099*    -------------------------------
  1100     05  FILLER            PIC  X(0003).
  1101     05  ALFSTO PIC  X(0002).
  1102*    -------------------------------
  1103     05  FILLER            PIC  X(0003).
  1104     05  ALFACCTO PIC  X(0010).
  1105*    -------------------------------
  1106     05  FILLER            PIC  X(0003).
  1107     05  ALFEFDTO PIC  X(0008).
  1108*    -------------------------------
  1109     05  FILLER            PIC  X(0003).
  1110     05  ALFCERTO PIC  X(0010).
  1111*    -------------------------------
  1112     05  FILLER            PIC  X(0003).
  1113     05  ALFCRTXO PIC  X(0001).
  1114*    -------------------------------
  1115     05  FILLER            PIC  X(0003).
  1116     05  ALFLNMEO PIC  X(0015).
  1117*    -------------------------------
  1118     05  FILLER            PIC  X(0003).
  1119     05  ALFFNMEO PIC  X(0012).
  1120*    -------------------------------
  1121     05  FILLER            PIC  X(0003).
  1122     05  ALFINTLO PIC  X(0001).
  1123*    -------------------------------
  1124     05  FILLER            PIC  X(0003).
  1125     05  ALFMSG1O PIC  X(0079).
  1126*    -------------------------------
  1127     05  FILLER            PIC  X(0003).
  1128     05  ALFMSG2O PIC  X(0079).
  1129*    -------------------------------
  1130     05  FILLER            PIC  X(0003).
  1131     05  ALFPFKO PIC  X(0002).
  1132*    -------------------------------
  1133
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL1324.cbl
  1135*                                COPY ELCLOGOF.
  1136******************************************************************
  1137*                                                                *
  1138*                                                                *
  1139*                            ELCLOGOF.                           *
  1140*                            VMOD=2.001                          *
  1141*                                                                *
  1142*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1143*                                                                *
  1144******************************************************************
  1145 01  CLASIC-LOGOFF.
  1146     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1147     12  LOGOFF-TEXT.
  1148         16  FILLER          PIC X(5)    VALUE SPACES.
  1149         16  LOGOFF-MSG.
  1150             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1151             20  FILLER      PIC X       VALUE SPACES.
  1152             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1153         16  FILLER          PIC X(80)
  1154           VALUE '* YOU ARE NOW LOGGED OFF'.
  1155         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1156         16  FILLER          PIC X       VALUE QUOTE.
  1157         16  LOGOFF-SYS-MSG  PIC X(17)
  1158           VALUE 'S CLAS-IC SYSTEM '.
  1159     12  TEXT-MESSAGES.
  1160         16  UNACCESS-MSG    PIC X(29)
  1161             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1162         16  PGMIDERR-MSG    PIC X(17)
  1163             VALUE 'PROGRAM NOT FOUND'.
  1164
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL1324.cbl
  1166*                                COPY ELCATTR.
  1167******************************************************************
  1168*                                                                *
  1169*                            ELCATTR.                            *
  1170*                            VMOD=2.001                          *
  1171*                                                                *
  1172*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1173*                                                                *
  1174*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1175*                                                                *
  1176*                   POS 1   P=PROTECTED                          *
  1177*                           U=UNPROTECTED                        *
  1178*                           S=ASKIP                              *
  1179*                   POS 2   A=ALPHA/NUMERIC                      *
  1180*                           N=NUMERIC                            *
  1181*                   POS 3   N=NORMAL                             *
  1182*                           B=BRIGHT                             *
  1183*                           D=DARK                               *
  1184*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1185*                           OF=MODIFIED DATA TAG OFF             *
  1186*                                                                *
  1187*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1188******************************************************************
  1189 01  ATTRIBUTE-LIST.
  1190     12  AL-PABOF            PIC X       VALUE 'Y'.
  1191     12  AL-PABON            PIC X       VALUE 'Z'.
  1192     12  AL-PADOF            PIC X       VALUE '%'.
  1193     12  AL-PADON            PIC X       VALUE '_'.
  1194     12  AL-PANOF            PIC X       VALUE '-'.
  1195     12  AL-PANON            PIC X       VALUE '/'.
  1196     12  AL-SABOF            PIC X       VALUE '8'.
  1197     12  AL-SABON            PIC X       VALUE '9'.
  1198     12  AL-SADOF            PIC X       VALUE '@'.
  1199     12  AL-SADON            PIC X       VALUE QUOTE.
  1200     12  AL-SANOF            PIC X       VALUE '0'.
  1201     12  AL-SANON            PIC X       VALUE '1'.
  1202     12  AL-UABOF            PIC X       VALUE 'H'.
  1203     12  AL-UABON            PIC X       VALUE 'I'.
  1204     12  AL-UADOF            PIC X       VALUE '<'.
  1205     12  AL-UADON            PIC X       VALUE '('.
  1206     12  AL-UANOF            PIC X       VALUE ' '.
  1207     12  AL-UANON            PIC X       VALUE 'A'.
  1208     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1209     12  AL-UNBON            PIC X       VALUE 'R'.
  1210     12  AL-UNDOF            PIC X       VALUE '*'.
  1211     12  AL-UNDON            PIC X       VALUE ')'.
  1212     12  AL-UNNOF            PIC X       VALUE '&'.
  1213     12  AL-UNNON            PIC X       VALUE 'J'.
  1214
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL1324.cbl
  1216*                                COPY ELCAID.
  1217******************************************************************
  1218*                                                                *
  1219*                            ELCAID.                             *
  1220*                            VMOD=2.001                          *
  1221*                                                                *
  1222*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1223*                                                                *
  1224*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1225*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1226******************************************************************
  1227
  1228 01  DFHAID.
  1229   02  DFHNULL   PIC  X  VALUE  ' '.
  1230   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1231   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1232   02  DFHPEN    PIC  X  VALUE  '='.
  1233   02  DFHOPID   PIC  X  VALUE  'W'.
  1234   02  DFHPA1    PIC  X  VALUE  '%'.
  1235   02  DFHPA2    PIC  X  VALUE  '>'.
  1236   02  DFHPA3    PIC  X  VALUE  ','.
  1237   02  DFHPF1    PIC  X  VALUE  '1'.
  1238   02  DFHPF2    PIC  X  VALUE  '2'.
  1239   02  DFHPF3    PIC  X  VALUE  '3'.
  1240   02  DFHPF4    PIC  X  VALUE  '4'.
  1241   02  DFHPF5    PIC  X  VALUE  '5'.
  1242   02  DFHPF6    PIC  X  VALUE  '6'.
  1243   02  DFHPF7    PIC  X  VALUE  '7'.
  1244   02  DFHPF8    PIC  X  VALUE  '8'.
  1245   02  DFHPF9    PIC  X  VALUE  '9'.
  1246   02  DFHPF10   PIC  X  VALUE  ':'.
  1247   02  DFHPF11   PIC  X  VALUE  '#'.
  1248   02  DFHPF12   PIC  X  VALUE  '@'.
  1249   02  DFHPF13   PIC  X  VALUE  'A'.
  1250   02  DFHPF14   PIC  X  VALUE  'B'.
  1251   02  DFHPF15   PIC  X  VALUE  'C'.
  1252   02  DFHPF16   PIC  X  VALUE  'D'.
  1253   02  DFHPF17   PIC  X  VALUE  'E'.
  1254   02  DFHPF18   PIC  X  VALUE  'F'.
  1255   02  DFHPF19   PIC  X  VALUE  'G'.
  1256   02  DFHPF20   PIC  X  VALUE  'H'.
  1257   02  DFHPF21   PIC  X  VALUE  'I'.
  1258*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1259   02  DFHPF22   PIC  X  VALUE  '['.
  1260   02  DFHPF23   PIC  X  VALUE  '.'.
  1261   02  DFHPF24   PIC  X  VALUE  '<'.
  1262   02  DFHMSRE   PIC  X  VALUE  'X'.
  1263   02  DFHSTRF   PIC  X  VALUE  'h'.
  1264   02  DFHTRIG   PIC  X  VALUE  '"'.
  1265
  1266 01  FILLER      REDEFINES
  1267     DFHAID.
  1268
  1269     12  FILLER                  PIC X(8).
  1270
  1271     12  PF-VALUES               PIC X
  1272         OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL1324.cbl
  1274****************************************************************
  1275*
  1276* Copyright (c) 2007 by Clerity Solutions, Inc.
  1277* All rights reserved.
  1278*
  1279****************************************************************
  1280 01  DFHEIV.
  1281   02  DFHEIV0               PIC X(35).
  1282   02  DFHEIV1               PIC X(08).
  1283   02  DFHEIV2               PIC X(08).
  1284   02  DFHEIV3               PIC X(08).
  1285   02  DFHEIV4               PIC X(06).
  1286   02  DFHEIV5               PIC X(04).
  1287   02  DFHEIV6               PIC X(04).
  1288   02  DFHEIV7               PIC X(02).
  1289   02  DFHEIV8               PIC X(02).
  1290   02  DFHEIV9               PIC X(01).
  1291   02  DFHEIV10              PIC S9(7) COMP-3.
  1292   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1293   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1294   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1295   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1296   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1297   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1298   02  DFHEIV17              PIC X(04).
  1299   02  DFHEIV18              PIC X(04).
  1300   02  DFHEIV19              PIC X(04).
  1301   02  DFHEIV20              USAGE IS POINTER.
  1302   02  DFHEIV21              USAGE IS POINTER.
  1303   02  DFHEIV22              USAGE IS POINTER.
  1304   02  DFHEIV23              USAGE IS POINTER.
  1305   02  DFHEIV24              USAGE IS POINTER.
  1306   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1307   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1308   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1309   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1310   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1311   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1312   02  FILLER                PIC X(02).
  1313   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1314   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1315   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1316   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1317   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1318 LINKAGE  SECTION.
  1319*****************************************************************
  1320*                                                               *
  1321* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1322* All rights reserved.                                          *
  1323*                                                               *
  1324*****************************************************************
  1325 01  dfheiblk.
  1326     02  eibtime          pic s9(7) comp-3.
  1327     02  eibdate          pic s9(7) comp-3.
  1328     02  eibtrnid         pic x(4).
  1329     02  eibtaskn         pic s9(7) comp-3.
  1330     02  eibtrmid         pic x(4).
  1331     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL1324.cbl
  1332     02  eibcposn         pic s9(4) comp.
  1333     02  eibcalen         pic s9(4) comp.
  1334     02  eibaid           pic x(1).
  1335     02  eibfiller1       pic x(1).
  1336     02  eibfn            pic x(2).
  1337     02  eibfiller2       pic x(2).
  1338     02  eibrcode         pic x(6).
  1339     02  eibfiller3       pic x(2).
  1340     02  eibds            pic x(8).
  1341     02  eibreqid         pic x(8).
  1342     02  eibrsrce         pic x(8).
  1343     02  eibsync          pic x(1).
  1344     02  eibfree          pic x(1).
  1345     02  eibrecv          pic x(1).
  1346     02  eibsend          pic x(1).
  1347     02  eibatt           pic x(1).
  1348     02  eibeoc           pic x(1).
  1349     02  eibfmh           pic x(1).
  1350     02  eibcompl         pic x(1).
  1351     02  eibsig           pic x(1).
  1352     02  eibconf          pic x(1).
  1353     02  eiberr           pic x(1).
  1354     02  eibrldbk         pic x(1).
  1355     02  eiberrcd         pic x(4).
  1356     02  eibsynrb         pic x(1).
  1357     02  eibnodat         pic x(1).
  1358     02  eibfiller5       pic x(2).
  1359     02  eibresp          pic 9(09) comp.
  1360     02  eibresp2         pic 9(09) comp.
  1361     02  dfheigdj         pic s9(4) comp.
  1362     02  dfheigdk         pic s9(4) comp.
  1363
  1364 01  DFHCOMMAREA                 PIC X(1024).
  1365
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL1324.cbl
  1367*                                COPY ELCALPH.
  1368******************************************************************
  1369*                                                                *
  1370*                            ELCALPH.                            *
  1371*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1372*                            VMOD=2.003                          *
  1373*                                                                *
  1374*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  1375*                                                                *
  1376*   FILE TYPE = VSAM,KSDS                                        *
  1377*   RECORD SIZE = 128  RECFORM = FIXED                           *
  1378*                                                                *
  1379*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  1380*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  1381*                                                                *
  1382*   LOG = YES                                                    *
  1383*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1384*                                                                *
  1385*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  1386******************************************************************
  1387
  1388 01  ALPHA-INDEX.
  1389     12  AI-RECORD-ID                         PIC XX.
  1390         88  VALID-AI-ID                  VALUE 'AI'.
  1391     12  AI-CONTROL-PRIMARY.
  1392         16  AI-COMPANY-CD                     PIC X.
  1393         16  AI-SOURCE                         PIC X.
  1394             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  1395             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  1396         16  AI-NAME.
  1397             20  AI-LAST-NAME                  PIC X(15).
  1398             20  AI-FIRST-NAME.
  1399                 24  AI-FIRST-INITIAL          PIC X.
  1400                 24  FILLER                    PIC X(11).
  1401             20  AI-MIDDLE-INIT                PIC X.
  1402         16  AI-DATE                           PIC X(8).
  1403         16  AI-TIME                           PIC S9(07) COMP-3.
  1404
  1405     12  AI-CONTROL-BY-ADMIN-KEY.
  1406         16  AI-CM-COMPANY-CD                  PIC X.
  1407         16  AI-CM-SOURCE                      PIC X.
  1408         16  AI-CM-CARRIER                     PIC X.
  1409         16  AI-CM-GROUPING.
  1410             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  1411             20  AI-CM-GROUPING-PRIME          PIC X(3).
  1412         16  AI-CM-STATE                       PIC XX.
  1413         16  AI-CM-PRODUCER.
  1414             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  1415             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  1416         16  AI-CM-CERT-EFF-DT                 PIC XX.
  1417         16  AI-CM-CERTIFICATE-NUMBER.
  1418             20  AI-CM-CERT-PRIME              PIC X(10).
  1419             20  AI-CM-CERT-SFX                PIC X.
  1420         16  AI-CM-DATE                        PIC X(8).
  1421         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  1422         16  FILLER                            PIC X(11).
  1423
  1424     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL1324.cbl
  1425         AI-CONTROL-BY-ADMIN-KEY.
  1426         16  AI-CL-COMPANY-CD                  PIC X.
  1427         16  AI-CL-SOURCE                      PIC X.
  1428         16  AI-CL-CARRIER                     PIC X.
  1429         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  1430         16  AI-CL-CERTIFICATE-NUMBER.
  1431             20  AI-CL-CERT-PRIME              PIC X(10).
  1432             20  AI-CL-CERT-SFX                PIC X.
  1433         16  AI-CL-DATE                        PIC X(8).
  1434         16  AI-CL-INCURRED-DATE               PIC XX.
  1435         16  AI-CL-CLOSE-DATE                  PIC XX.
  1436         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  1437         16  AI-CREDIT-CARD-NUMBER.
  1438             20  AI-CCN.
  1439                 24  AI-CCN-PREFIX             PIC X(4).
  1440                 24  AI-CCN-PRIME              PIC X(12).
  1441             20  AI-CCN-FILLER                 PIC X(4).
  1442
  1443     12  AI-MAINT-INFO.
  1444         16  AI-LAST-MAINT-BY                  PIC X(4).
  1445         16  AI-LAST-MAINT-DT                  PIC XX.
  1446         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1447
  1448     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  1449
  1450     12  FILLER                                PIC X(15).
  1451
  1452
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL1324.cbl
  1454 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ALPHA-INDEX.
  1455 0000-DFHEXIT SECTION.
  1456     MOVE '9#                    $   ' TO DFHEIV0.
  1457     MOVE 'EL1324' TO DFHEIV1.
  1458     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1459
  1460     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1461     MOVE '5'                    TO DC-OPTION-CODE.
  1462     PERFORM 8500-DATE-CONVERSION THRU 8500-EXIT.
  1463     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  1464     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  1465
  1466     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  1467
  1468     MOVE +2                     TO  EMI-NUMBER-OF-LINES
  1469                                     EMI-SWITCH2.
  1470
  1471*    NOTE *******************************************************
  1472*         *      ACCESS TO THIS MODULE CAN BE ONLY FROM AN XCTL *
  1473*         *  FROM ANOTHER MODULE.                               *
  1474*         *******************************************************.
  1475
  1476     IF EIBCALEN NOT GREATER ZERO
  1477         MOVE UNACCESS-MSG       TO  LOGOFF-MSG
  1478         GO TO 8300-SEND-TEXT.
  1479
  1480
  1481* EXEC CICS HANDLE CONDITION
  1482*        PGMIDERR (9600-PGMIDERR)
  1483*        NOTOPEN  (8800-NOTOPEN)
  1484*        ERROR    (9990-ERROR)
  1485*    END-EXEC.
  1486*    MOVE '"$LJ.                 ! " #00001476' TO DFHEIV0
  1487     MOVE X'22244C4A2E20202020202020' TO DFHEIV0(1:12)
  1488     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1489     MOVE X'2220233030303031343736' TO DFHEIV0(25:11)
  1490     CALL 'kxdfhei1' USING DFHEIV0
  1491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1492
  1493
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL1324.cbl
  1495 0010-MAIN-LOGIC.
  1496*    NOTE *******************************************************
  1497*         *      IF THE TRANSACTION CODE OF THE TASK THAT       *
  1498*         *  INVOKED THIS MODULE IS NOT EX21, THIS IS THE FIRST *
  1499*         *  TIME THROUGH THIS MODULE.                          *
  1500*         *******************************************************.
  1501
  1502     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1503         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1504             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  1505             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  1506             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  1507             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  1508             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  1509             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  1510             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  1511             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  1512           ELSE
  1513             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  1514             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  1515             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  1516             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  1517             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  1518             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  1519             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  1520             MOVE SPACES               TO  PI-SAVED-PROGRAM-6
  1521             PERFORM 7000-BUILD-SCREEN
  1522             MOVE +1             TO  WS-CALL-SW
  1523       ELSE
  1524         GO TO 0020-MAIN-LOGIC.
  1525
  1526 0015-MAIN-LOGIC.
  1527*    NOTE *******************************************************
  1528*         *      INITALIZE THE WORK FIELDS FOR THE PROGRAM      *
  1529*         *  INTERFACE BLOCK FOR THIS MODULE.                   *
  1530*         *******************************************************.
  1531
  1532     MOVE SPACES                 TO  PI-PROGRAM-WORK-AREA.
  1533
  1534     MOVE ZERO                   TO  PI-1ST-TIME-SW
  1535                                     PI-LINE-COUNT
  1536                                     PI-AIX-RECORD-COUNT
  1537                                     PI-BROWSE-SW
  1538                                     PI-KEY-LENGTH
  1539                                     PI-TS-ITEM
  1540                                     PI-END-OF-FILE
  1541                                     PI-START-SW.
  1542
  1543     MOVE LOW-VALUES             TO  EL1324AO.
  1544
  1545 0018-MAIN-LOGIC.
  1546     MOVE SPACES                 TO  PI-CONTROL-IN-PROGRESS.
  1547
  1548     GO TO 8100-SEND-INITIAL-MAP.
  1549
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL1324.cbl
  1551 0020-MAIN-LOGIC.
  1552     IF PI-1ST-TIME-SW NOT = ZERO
  1553         GO TO 0015-MAIN-LOGIC.
  1554
  1555*    NOTE *******************************************************
  1556*         *      AFTER THE FIRST TIME THROUGH THE PROPER ATTEN- *
  1557*         *  TION KEY USAGE NEEDS TO BE CHECKED FOR VALIDITY    *
  1558*         *  BEFORE ANY FURTHER PROCESSING CAN BE DONE.         *
  1559*         *******************************************************.
  1560
  1561     IF EIBAID = DFHCLEAR
  1562         GO TO 9400-CLEAR.
  1563
  1564     IF EIBAID EQUAL DFHPA1 OR DFHPA2 OR DFHPA3
  1565         MOVE LOW-VALUES         TO  EL1324AI
  1566         MOVE -1                 TO  ALFPFKL
  1567         MOVE ER-0008            TO  EMI-ERROR
  1568         GO TO 8200-SEND-DATAONLY.
  1569
  1570
  1571* EXEC CICS RECEIVE
  1572*        INTO   (EL1324AO)
  1573*        MAPSET (WS-MAPSET-NAME)
  1574*        MAP    (WS-MAP-NAME)
  1575*    END-EXEC.
  1576     MOVE LENGTH OF
  1577      EL1324AO
  1578       TO DFHEIV11
  1579*    MOVE '8"T I  L              ''   #00001558' TO DFHEIV0
  1580     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1581     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1582     MOVE X'2020233030303031353538' TO DFHEIV0(25:11)
  1583     CALL 'kxdfhei1' USING DFHEIV0,
  1584           WS-MAP-NAME,
  1585           EL1324AO,
  1586           DFHEIV11,
  1587           WS-MAPSET-NAME,
  1588           DFHEIV99,
  1589           DFHEIV99
  1590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1591
  1592
  1593     IF ALFPFKL GREATER THAN  ZERO
  1594         IF EIBAID NOT = DFHENTER
  1595             MOVE ER-0004        TO  EMI-ERROR
  1596             MOVE AL-UNBOF       TO  ALFPFKA
  1597             MOVE -1             TO  ALFPFKL
  1598             GO TO  8200-SEND-DATAONLY
  1599         ELSE
  1600             IF ALFPFKO  GREATER ZERO AND LESS '25'
  1601                 MOVE PF-VALUES (ALFPFKI) TO  EIBAID
  1602             ELSE
  1603                 MOVE ER-0029        TO  EMI-ERROR
  1604                 MOVE AL-UNBOF       TO  ALFPFKA
  1605                 MOVE -1             TO  ALFPFKL
  1606                 GO TO  8200-SEND-DATAONLY.
  1607
  1608     IF EIBAID = DFHPF12
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL1324.cbl
  1609         MOVE XCTL-010           TO  THIS-PGM
  1610         GO TO 9300-XCTL.
  1611
  1612     IF EIBAID = DFHPF23
  1613         GO TO 9000-RETURN-CICS.
  1614
  1615     IF EIBAID = DFHPF24
  1616         MOVE XCTL-126           TO  THIS-PGM
  1617         GO TO 9300-XCTL.
  1618
  1619     IF EIBAID = DFHENTER
  1620         GO TO 0025-MAIN-LOGIC.
  1621
  1622     IF EIBAID NOT = DFHENTER
  1623         MOVE -1                 TO  ALFPFKL
  1624         MOVE ER-0008            TO  EMI-ERROR
  1625         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL1324.cbl
  1627 0025-MAIN-LOGIC.
  1628
  1629     MOVE  SPACES                    TO  PI-ALPH-CLAIM-KEY
  1630                                         PI-ALPH-ADMIN-KEY.
  1631
  1632     MOVE  PI-COMPANY-CD             TO  PI-ALPH-CO-CD
  1633                                         PI-ADM-COMP-CD
  1634                                         PI-CLM-COMP-CD.
  1635
  1636     MOVE  XCTL-1325                 TO  THIS-PGM.
  1637
  1638     IF PI-PROCESSOR-ID = 'LGXX'
  1639         NEXT SENTENCE
  1640     ELSE
  1641
  1642* EXEC CICS READQ TS
  1643*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  1644*            INTO    (SECURITY-CONTROL)
  1645*            LENGTH  (SC-COMM-LENGTH)
  1646*            ITEM    (SC-ITEM)
  1647*        END-EXEC
  1648*    MOVE '*$II   L              ''   #00001612' TO DFHEIV0
  1649     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1650     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1651     MOVE X'2020233030303031363132' TO DFHEIV0(25:11)
  1652     CALL 'kxdfhei1' USING DFHEIV0,
  1653           PI-SECURITY-TEMP-STORE-ID,
  1654           SECURITY-CONTROL,
  1655           SC-COMM-LENGTH,
  1656           SC-ITEM,
  1657           DFHEIV99,
  1658           DFHEIV99
  1659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1660         MOVE SC-CLAIMS-DISPLAY (21)   TO  PI-DISPLAY-CAP
  1661         MOVE SC-CLAIMS-UPDATE  (21)   TO  PI-MODIFY-CAP
  1662         IF NOT DISPLAY-CAP
  1663             MOVE 'READ'               TO  SM-READ
  1664             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1665             MOVE ER-0070              TO  EMI-ERROR
  1666             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1667             GO TO 8100-SEND-INITIAL-MAP.
  1668
  1669******************************************************************
  1670*           O P T I O N  1  P R O C E S S I N G                  *
  1671******************************************************************
  1672
  1673     IF PI-SESSION-IN-PROGRESS = '1'
  1674         NEXT SENTENCE
  1675     ELSE
  1676        IF PI-SESSION-IN-PROGRESS  =  '2'
  1677           MOVE -1              TO ALFCARRL
  1678           GO TO 0200-MAIN-LOGIC.
  1679
  1680     IF (ALLNAMEL  GREATER THAN ZERO)  OR
  1681        (ALFNAMEL  GREATER THAN ZERO)  OR
  1682        (ALINTALL  GREATER THAN ZERO)
  1683         NEXT SENTENCE
  1684     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL1324.cbl
  1685         GO TO 0100-MAIN-LOGIC.
  1686
  1687     IF (ALFNAMEL GREATER THAN +0    OR
  1688         ALINTALL GREATER THAN +0)   AND
  1689         ALLNAMEL NOT GREATER  ZERO
  1690          MOVE ER-0488          TO  EMI-ERROR
  1691          MOVE -1               TO  ALLNAMEL
  1692          GO TO 8200-SEND-DATAONLY.
  1693
  1694     IF ALLNAMEL GREATER THAN ZEROS
  1695        IF ALLNAMEI  IS EQUAL TO  SPACES OR LOW-VALUES
  1696           MOVE ER-0284          TO  EMI-ERROR
  1697           MOVE -1               TO  ALLNAMEL
  1698           GO TO 8200-SEND-DATAONLY.
  1699
  1700     MOVE ALPHA-INDEX-DSID       TO  PI-DSID.
  1701     MOVE '1'                    TO  PI-OPTION.
  1702     MOVE PI-COMPANY-CD          TO  PI-ALPH-CO-CD.
  1703     MOVE 'C'                    TO  PI-ALPH-SOURCE.
  1704
  1705     MOVE +2                     TO  PI-KEY-LENGTH.
  1706
  1707     IF ALLNAMEL GREATER ZERO
  1708        MOVE ALLNAMEI            TO  PI-ALPH-LAST-NAME
  1709                                     WS-INPUT-FIELD
  1710        IF (ALFNAMEL  EQUAL +0)   AND
  1711           (ALINTALL  EQUAL +0)
  1712              PERFORM 0030-MAIN-LOGIC THRU 0030-MAIN-LOGIC-EXIT
  1713                 VARYING INPUT-INDEX FROM ALLNAMEL BY -1
  1714                   UNTIL WS-INPUT-CHAR (INPUT-INDEX) NOT = SPACE
  1715           ADD ALLNAMEL         TO  PI-KEY-LENGTH
  1716        ELSE
  1717           MOVE +17             TO  PI-KEY-LENGTH.
  1718
  1719     IF ALFNAMEL  GREATER ZERO
  1720        MOVE ALFNAMEI           TO  PI-ALPH-FRST-NAME
  1721        IF ALINTALL  GREATER ZERO
  1722           ADD +13              TO  PI-KEY-LENGTH
  1723           MOVE ALINTALI        TO  PI-ALPH-MID-INIT
  1724        ELSE
  1725           MOVE ALFNAMEI       TO  WS-INPUT-FIELD
  1726              PERFORM 0050-MAIN-LOGIC THRU 0050-MAIN-LOGIC-EXIT
  1727                 VARYING INPUT-INDEX FROM ALFNAMEL BY -1
  1728                   UNTIL WS-INPUT-CHAR (INPUT-INDEX) NOT = SPACE
  1729           ADD ALFNAMEL           TO  PI-KEY-LENGTH.
  1730
  1731     IF ALLNAMEL GREATER ZERO
  1732         MOVE AL-UABON           TO  ALLNAMEA
  1733     ELSE
  1734         MOVE AL-UABOF           TO  ALLNAMEA.
  1735
  1736     IF ALFNAMEL GREATER ZERO
  1737         MOVE AL-UABON           TO  ALFNAMEA
  1738     ELSE
  1739         MOVE AL-UABOF           TO  ALFNAMEA.
  1740
  1741     IF ALINTALL GREATER ZERO
  1742         MOVE AL-UABON           TO  ALINTALA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL1324.cbl
  1743     ELSE
  1744         MOVE AL-UABOF           TO  ALINTALA.
  1745
  1746     MOVE -1                     TO  ALLNAMEL.
  1747     PERFORM 4000-READ-ALPHA-FILE.
  1748
  1749     MOVE +1                     TO  PI-1ST-TIME-SW.
  1750
  1751     IF PI-RETURN-TO-PROGRAM = 'EL132   '
  1752         MOVE  XCTL-150          TO  THIS-PGM
  1753     ELSE
  1754         MOVE  XCTL-1325         TO  THIS-PGM.
  1755
  1756     PERFORM 9300-XCTL.
  1757
  1758 0030-MAIN-LOGIC.
  1759     SUBTRACT +1 FROM ALLNAMEL.
  1760
  1761 0030-MAIN-LOGIC-EXIT.
  1762     EXIT.
  1763
  1764 0050-MAIN-LOGIC.
  1765     SUBTRACT +1 FROM ALFNAMEL.
  1766
  1767 0050-MAIN-LOGIC-EXIT.
  1768     EXIT.
  1769
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL1324.cbl
  1771 0100-MAIN-LOGIC SECTION.
  1772
  1773******************************************************************
  1774*           O P T I O N  2  P R O C E S S I N G                  *
  1775******************************************************************
  1776
  1777     IF (ALCLMNOL  GREATER ZERO)  OR
  1778        (ALCARNOL  GREATER ZERO)  OR
  1779        (ALCERTL   GREATER ZERO)  OR
  1780        (ALCRTSXL  GREATER ZERO)
  1781         NEXT SENTENCE
  1782       ELSE
  1783         GO TO 0200-MAIN-LOGIC.
  1784
  1785     MOVE ALPHA2-INDEX-DSID      TO  PI-DSID.
  1786     MOVE '2'                    TO  PI-OPTION.
  1787     MOVE PI-COMPANY-CD          TO  PI-ADM-COMP-CD
  1788                                     PI-CLM-COMP-CD.
  1789     MOVE 'C'                    TO  PI-CLM-SOURCE.
  1790
  1791     IF ALCLMNOL  GREATER THAN ZERO
  1792        IF ALCLMNOI  IS EQUAL TO  SPACES OR LOW-VALUES
  1793            MOVE ER-0284         TO  EMI-ERROR
  1794            MOVE -1              TO  ALCLMNOL
  1795            GO TO 8200-SEND-DATAONLY.
  1796
  1797******************************************************************
  1798*              SECURITY CHECK FOR CARRIER                        *
  1799*                    04/02/84                                    *
  1800******************************************************************
  1801
  1802     IF  PI-NO-CARRIER-SECURITY
  1803         GO TO 0128-BUILD-CARRIER-NO.
  1804
  1805     IF ALCARNOL GREATER ZERO
  1806        IF  ALCARNOI = PI-CARRIER-SECURITY
  1807            GO TO 0128-BUILD-CARRIER-NO.
  1808
  1809     MOVE ER-2370                TO  EMI-ERROR.
  1810     MOVE -1                     TO  ALCARNOL.
  1811     MOVE AL-UABON               TO  ALCARNOA.
  1812     GO TO 8200-SEND-DATAONLY.
  1813
  1814 0128-BUILD-CARRIER-NO.
  1815     IF ALCARNOL GREATER ZERO
  1816         MOVE ALCARNOI           TO  PI-CLM-CARRIER
  1817                                     PI-CARRIER
  1818         MOVE +3                 TO  PI-KEY-LENGTH
  1819     ELSE
  1820         MOVE ER-0194            TO  EMI-ERROR
  1821         PERFORM 9900-ERROR-FORMAT
  1822         MOVE -1                 TO  ALCARNOL.
  1823
  1824     IF ALCLMNOL  GREATER ZERO
  1825         MOVE ALCLMNOI           TO  PI-CLM-CLAIM-NO
  1826                                     PI-CLAIM-NO
  1827                                     WS-INPUT-FIELD
  1828         PERFORM 0130-MAIN-LOGIC THRU 0130-MAIN-LOGIC-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL1324.cbl
  1829             VARYING INPUT-INDEX FROM ALCLMNOL  BY -1
  1830                 UNTIL WS-INPUT-CHAR (INPUT-INDEX) NOT = SPACE
  1831         ADD +3  ALCLMNOL GIVING PI-KEY-LENGTH
  1832       ELSE
  1833         MOVE ER-0209           TO  EMI-ERROR
  1834         PERFORM 9900-ERROR-FORMAT
  1835         MOVE -1                TO  ALCLMNOL.
  1836
  1837     IF ALCERTL  GREATER ZERO
  1838         MOVE ALCERTI            TO  PI-CLM-CERT-PRM
  1839                                     WS-INPUT-FIELD
  1840         MOVE +20                TO  PI-KEY-LENGTH.
  1841
  1842     IF ALCRTSXL GREATER ZERO
  1843         MOVE +21                TO  PI-KEY-LENGTH
  1844         MOVE ALCRTSXI           TO  PI-CLM-CERT-SFX.
  1845
  1846     MOVE PI-CLM-CERT-NUMBER     TO  PI-CERT-NO.
  1847
  1848     IF EMI-FATAL-CTR GREATER ZERO
  1849         GO TO 8200-SEND-DATAONLY.
  1850
  1851     IF ALCLMNOL  GREATER ZERO
  1852         MOVE AL-UABON           TO  ALCLMNOA
  1853       ELSE
  1854         MOVE AL-UABOF           TO  ALCLMNOA.
  1855
  1856     IF ALCARNOL GREATER ZERO
  1857         MOVE AL-UABON           TO  ALCARNOA
  1858       ELSE
  1859         MOVE AL-UABOF           TO  ALCARNOA.
  1860
  1861     IF ALCERTL  GREATER ZERO
  1862         MOVE AL-UABON           TO  ALCERTA
  1863       ELSE
  1864         MOVE AL-UABOF           TO  ALCERTA.
  1865
  1866     IF ALCRTSXL GREATER ZERO
  1867         MOVE AL-UABON           TO  ALCRTSXA
  1868       ELSE
  1869         MOVE AL-UABOF           TO  ALCRTSXA.
  1870
  1871     MOVE -1                     TO  ALCLMNOL.
  1872     PERFORM 4000-READ-ALPHA-FILE.
  1873
  1874 0130-MAIN-LOGIC.
  1875     SUBTRACT +1 FROM ALCLMNOL.
  1876
  1877 0130-MAIN-LOGIC-EXIT.
  1878     EXIT.
  1879
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL1324.cbl
  1881 0200-MAIN-LOGIC SECTION.
  1882******************************************************************
  1883*           O P T I O N  3  P R O C E S S I N G                  *
  1884******************************************************************
  1885
  1886     IF (ALFCARRL  GREATER ZERO)  OR
  1887        (ALFGRPL   GREATER ZERO)  OR
  1888        (ALFSTL    GREATER ZERO)  OR
  1889        (ALFACCTL  GREATER ZERO)  OR
  1890        (ALFEFDTL  GREATER ZERO)  OR
  1891        (ALFCERTL  GREATER ZERO)
  1892         NEXT SENTENCE
  1893       ELSE
  1894         GO TO 0300-MAIN-LOGIC.
  1895
  1896     MOVE '3'                    TO  PI-OPTION.
  1897     MOVE PI-COMPANY-CD          TO  PI-ADM-COMP-CD.
  1898     MOVE 'A'                    TO  PI-ADM-SOURCE.
  1899
  1900******************************************************************
  1901*              SECURITY CHECK FOR CARRIER                        *
  1902*                    04/02/84                                    *
  1903******************************************************************
  1904
  1905     IF  PI-NO-CARRIER-SECURITY
  1906         GO TO 0200-BUILD-ADMIN-KEY.
  1907
  1908     IF ALFCARRL GREATER ZERO
  1909        IF  ALFCARRI = PI-CARRIER-SECURITY
  1910            GO TO 0200-BUILD-ADMIN-KEY.
  1911
  1912     MOVE ER-2370                TO  EMI-ERROR.
  1913     MOVE -1                     TO  ALFCARRL.
  1914     MOVE AL-UABON               TO  ALFCARRA.
  1915     GO TO 8200-SEND-DATAONLY.
  1916
  1917 0200-BUILD-ADMIN-KEY.
  1918     IF ALFCARRL GREATER ZERO
  1919         MOVE ALFCARRI           TO  PI-ADM-CARRIER
  1920                                     PI-CARRIER
  1921         MOVE +1                 TO  PI-KEY-LENGTH
  1922     ELSE
  1923         MOVE ER-0194            TO  EMI-ERROR
  1924         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  1925         MOVE  -1                TO  ALFCARRL.
  1926
  1927     IF ALFGRPL  GREATER THAN  +0
  1928        MOVE ALFGRPI             TO  PI-ADM-GROUPING
  1929                                     PI-GROUPING
  1930        ADD  +6                  TO  PI-KEY-LENGTH
  1931     ELSE
  1932        MOVE ER-0195             TO  EMI-ERROR
  1933        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  1934        MOVE  -1                 TO  ALFGRPL.
  1935
  1936     IF ALFSTL  GREATER THAN  +0
  1937        MOVE ALFSTI              TO  PI-ADM-STATE
  1938                                     PI-STATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL1324.cbl
  1939        ADD  +2                  TO  PI-KEY-LENGTH
  1940     ELSE
  1941        MOVE ER-0196             TO  EMI-ERROR
  1942        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  1943        MOVE  -1                 TO  ALFSTL.
  1944
  1945     IF ALFACCTL  GREATER THAN  +0
  1946        MOVE ALFACCTI            TO  PI-ADM-PRODUCER
  1947                                     PI-PRODUCER
  1948        ADD +10                  TO  PI-KEY-LENGTH
  1949     ELSE
  1950        MOVE ER-0197             TO  EMI-ERROR
  1951        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  1952        MOVE  -1                 TO  ALFACCTL.
  1953
  1954     IF ALFEFDTL  GREATER THAN  +0
  1955        MOVE  ALFEFDTI           TO  DC-GREG-DATE-1-EDIT
  1956        MOVE  '2'                TO  DC-OPTION-CODE
  1957        PERFORM 8500-DATE-CONVERSION  THRU 8500-EXIT
  1958        IF DATE-CONVERSION-ERROR
  1959           MOVE  ER-0348         TO  EMI-ERROR
  1960           MOVE  -1              TO  ALFEFDTL
  1961           MOVE AL-UABON         TO  ALFEFDTA
  1962           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1963        ELSE
  1964           MOVE  DC-BIN-DATE-1   TO  PI-ADM-CERT-EFF-DT
  1965                                     PI-CERT-EFF-DT
  1966           ADD +08               TO  PI-KEY-LENGTH
  1967     ELSE
  1968        MOVE ER-0216             TO  EMI-ERROR
  1969        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  1970        MOVE  -1                 TO  ALFEFDTL.
  1971
  1972     IF ALFCERTL  GREATER THAN  +0
  1973         MOVE ALFCERTI           TO  PI-ADM-CERT-PRM
  1974         ADD  +10                TO  PI-KEY-LENGTH
  1975     ELSE
  1976        MOVE ER-0203             TO  EMI-ERROR
  1977        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  1978        MOVE  -1                 TO  ALFEFDTL.
  1979
  1980     IF ALFCRTXL GREATER ZERO
  1981         ADD  +01                TO  PI-KEY-LENGTH
  1982         MOVE ALFCRTXI           TO  PI-ADM-CERT-SFX.
  1983
  1984     MOVE PI-CLM-CERT-NUMBER     TO  PI-CERT-NO.
  1985
  1986     IF ALFCARRL  GREATER THAN  +0
  1987         MOVE AL-UABON           TO  ALFCARRA
  1988     ELSE
  1989         MOVE AL-UABOF           TO  ALFCARRA.
  1990
  1991     IF ALFGRPL   GREATER THAN  +0
  1992         MOVE AL-UABON           TO  ALFGRPA
  1993     ELSE
  1994         MOVE AL-UABOF           TO  ALFGRPA.
  1995
  1996     IF ALFSTL    GREATER THAN  +0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL1324.cbl
  1997         MOVE AL-UABON           TO  ALFSTA
  1998     ELSE
  1999         MOVE AL-UABOF           TO  ALFSTA.
  2000
  2001     IF ALFACCTL  GREATER THAN  +0
  2002         MOVE AL-UABON           TO  ALFACCTA
  2003     ELSE
  2004         MOVE AL-UABOF           TO  ALFACCTA.
  2005
  2006     IF ALFEFDTL  GREATER THAN  +0
  2007         MOVE AL-UABON           TO  ALFEFDTA
  2008     ELSE
  2009         MOVE AL-UABOF           TO  ALFEFDTA.
  2010
  2011     IF ALFCERTL  GREATER THAN  +0
  2012         MOVE AL-UABON           TO  ALFCERTA
  2013     ELSE
  2014         MOVE AL-UABOF           TO  ALFCERTA.
  2015
  2016     IF ALFCRTXL  GREATER THAN  +0
  2017         MOVE AL-UABON           TO  ALFCRTXA
  2018     ELSE
  2019         MOVE AL-UABOF           TO  ALFCRTXA.
  2020
  2021     MOVE -1                     TO  ALFCARRL.
  2022     MOVE ALPHA2-INDEX-DSID      TO  PI-DSID.
  2023     PERFORM 4000-READ-ALPHA-FILE.
  2024
  2025 0220-MAIN-LOGIC-EXIT.
  2026     EXIT.
  2027
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL1324.cbl
  2029 0300-MAIN-LOGIC SECTION.
  2030******************************************************************
  2031*           O P T I O N  4  P R O C E S S I N G                  *
  2032******************************************************************
  2033
  2034     IF (ALFLNMEL  GREATER ZERO)  OR
  2035        (ALFFNMEL  GREATER ZERO)  OR
  2036        (ALFINTLL  GREATER ZERO)
  2037         NEXT SENTENCE
  2038       ELSE
  2039         GO TO 0400-MAIN-LOGIC.
  2040
  2041     IF (ALFFNMEL GREATER THAN ZERO  OR
  2042         ALFINTLL GREATER THAN ZERO) AND
  2043         ALFLNMEL NOT GREATER  ZERO
  2044         MOVE ER-0488            TO  EMI-ERROR
  2045         MOVE -1                 TO  ALFLNMEL
  2046         GO TO 8200-SEND-DATAONLY.
  2047
  2048     MOVE ALPHA-INDEX-DSID       TO  PI-DSID.
  2049     MOVE '4'                    TO  PI-OPTION.
  2050     MOVE PI-COMPANY-CD          TO  PI-ALPH-CO-CD.
  2051     MOVE 'A'                    TO  PI-ALPH-SOURCE.
  2052
  2053     MOVE +1                     TO  PI-KEY-LENGTH.
  2054
  2055     IF ALFLNMEL GREATER ZERO
  2056        MOVE ALFLNMEI            TO  PI-ALPH-LAST-NAME
  2057                                     WS-INPUT-FIELD
  2058        IF ALFFNMEL  EQUAL +0
  2059                  AND
  2060           ALFINTLL  EQUAL +0
  2061           PERFORM 0320-MAIN-LOGIC THRU 0320-MAIN-LOGIC-EXIT
  2062             VARYING INPUT-INDEX FROM ALFLNMEL BY -1
  2063             UNTIL WS-INPUT-CHAR (INPUT-INDEX) NOT = SPACE
  2064           ADD ALFLNMEL  TO  PI-KEY-LENGTH
  2065        ELSE
  2066           MOVE +15     TO  PI-KEY-LENGTH.
  2067
  2068     IF ALFFNMEL  GREATER ZERO
  2069        MOVE ALFFNMEI           TO  PI-ALPH-FRST-NAME
  2070        IF ALFINTLL  GREATER ZERO
  2071           ADD +13              TO  PI-KEY-LENGTH
  2072           MOVE ALFINTLI        TO  PI-ALPH-MID-INIT
  2073        ELSE
  2074           MOVE ALFFNMEI       TO  WS-INPUT-FIELD
  2075           PERFORM 0325-MAIN-LOGIC THRU 0325-MAIN-LOGIC-EXIT
  2076             VARYING INPUT-INDEX FROM ALFFNMEL BY -1
  2077             UNTIL WS-INPUT-CHAR (INPUT-INDEX) NOT = SPACE
  2078           ADD ALFFNMEL           TO  PI-KEY-LENGTH.
  2079
  2080     IF ALFLNMEL GREATER ZERO
  2081         MOVE AL-UABON           TO  ALFLNMEA
  2082     ELSE
  2083         MOVE AL-UABOF           TO  ALFLNMEA.
  2084
  2085     IF ALFFNMEL GREATER ZERO
  2086         MOVE AL-UABON           TO  ALFFNMEA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL1324.cbl
  2087     ELSE
  2088         MOVE AL-UABOF           TO  ALFFNMEA.
  2089
  2090     IF ALFINTLL GREATER ZERO
  2091         MOVE AL-UABON           TO  ALFINTLA
  2092     ELSE
  2093         MOVE AL-UABOF           TO  ALFINTLA.
  2094
  2095     MOVE -1                     TO  ALFLNMEL.
  2096     PERFORM 4000-READ-ALPHA-FILE.
  2097
  2098 0320-MAIN-LOGIC.
  2099     SUBTRACT +1 FROM ALFLNMEL.
  2100
  2101 0320-MAIN-LOGIC-EXIT.
  2102     EXIT.
  2103
  2104 0325-MAIN-LOGIC.
  2105     SUBTRACT +1 FROM ALFFNMEL.
  2106
  2107 0325-MAIN-LOGIC-EXIT.
  2108     EXIT.
  2109
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL1324.cbl
  2111 0400-MAIN-LOGIC.
  2112
  2113     MOVE ZERO                   TO  PI-OPTION.
  2114     MOVE +1                     TO  PI-KEY-LENGTH.
  2115     MOVE ALPHA-INDEX-DSID       TO  PI-DSID.
  2116     MOVE ZERO                   TO  PI-OPTION.
  2117     MOVE -1                     TO  ALLNAMEL.
  2118     PERFORM 4000-READ-ALPHA-FILE.
  2119
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL1324.cbl
  2121 4000-READ-ALPHA-FILE SECTION.
  2122
  2123
  2124* EXEC CICS HANDLE CONDITION
  2125*        DUPKEY (9300-XCTL)
  2126*        NOTFND (4080-NOTFND)
  2127*    END-EXEC.
  2128*    MOVE '"$$I                  ! # #00002081' TO DFHEIV0
  2129     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  2130     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2131     MOVE X'2320233030303032303831' TO DFHEIV0(25:11)
  2132     CALL 'kxdfhei1' USING DFHEIV0
  2133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2134
  2135
  2136     IF (PI-OPTION  =  ZERO) OR
  2137        (PI-OPTION  =  '1')  OR
  2138        (PI-OPTION  =  '4')
  2139          NEXT SENTENCE
  2140     ELSE
  2141         GO TO 4010-READ-ALPHA-FILE.
  2142
  2143     IF (PI-DSID = ALPHA-INDEX-DSID)  AND
  2144        (PI-KEY-LENGTH  LESS THAN +31)
  2145                     OR
  2146        (PI-DSID = ALPHA-INDEX-DSID) AND
  2147        (PI-KEY-LENGTH  LESS THAN +31)
  2148          MOVE +1             TO  PI-START-SW
  2149
  2150* EXEC CICS READ
  2151*             DATASET   (PI-DSID)
  2152*             RIDFLD    (PI-ALPH-CLAIM-KEY)
  2153*             SET       (ADDRESS OF ALPHA-INDEX)
  2154*             GENERIC   EQUAL
  2155*             KEYLENGTH (PI-KEY-LENGTH)
  2156*         END-EXEC
  2157*    MOVE '&"S  KG    E          (   #00002099' TO DFHEIV0
  2158     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  2159     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2160     MOVE X'2020233030303032303939' TO DFHEIV0(25:11)
  2161     CALL 'kxdfhei1' USING DFHEIV0,
  2162           PI-DSID,
  2163           DFHEIV20,
  2164           DFHEIV99,
  2165           PI-ALPH-CLAIM-KEY,
  2166           PI-KEY-LENGTH,
  2167           DFHEIV99,
  2168           DFHEIV99
  2169     SET ADDRESS OF ALPHA-INDEX TO
  2170         DFHEIV20
  2171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2172     ELSE
  2173          MOVE ZERO           TO  PI-START-SW
  2174
  2175* EXEC CICS READ
  2176*             DATASET   (PI-DSID)
  2177*             RIDFLD    (PI-ALPH-CLAIM-KEY)
  2178*             SET       (ADDRESS OF ALPHA-INDEX)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL1324.cbl
  2179*         END-EXEC.
  2180*    MOVE '&"S        E          (   #00002108' TO DFHEIV0
  2181     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2182     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2183     MOVE X'2020233030303032313038' TO DFHEIV0(25:11)
  2184     CALL 'kxdfhei1' USING DFHEIV0,
  2185           PI-DSID,
  2186           DFHEIV20,
  2187           DFHEIV99,
  2188           PI-ALPH-CLAIM-KEY,
  2189           DFHEIV99,
  2190           DFHEIV99,
  2191           DFHEIV99
  2192     SET ADDRESS OF ALPHA-INDEX TO
  2193         DFHEIV20
  2194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2195
  2196
  2197     GO TO 9300-XCTL.
  2198
  2199 4010-READ-ALPHA-FILE.
  2200
  2201     IF (PI-DSID = ALPHA2-INDEX-DSID) AND
  2202        (PI-KEY-LENGTH  LESS THAN +22)
  2203                    OR
  2204        (PI-KEY-LENGTH  LESS THAN +41)
  2205          MOVE +1             TO  PI-START-SW
  2206
  2207* EXEC CICS READ
  2208*             DATASET   (PI-DSID)
  2209*             RIDFLD    (PI-ALPH-ADMIN-KEY)
  2210*             SET       (ADDRESS OF ALPHA-INDEX)
  2211*             GENERIC   EQUAL
  2212*             KEYLENGTH (PI-KEY-LENGTH)
  2213*         END-EXEC
  2214*    MOVE '&"S  KG    E          (   #00002123' TO DFHEIV0
  2215     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  2216     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2217     MOVE X'2020233030303032313233' TO DFHEIV0(25:11)
  2218     CALL 'kxdfhei1' USING DFHEIV0,
  2219           PI-DSID,
  2220           DFHEIV20,
  2221           DFHEIV99,
  2222           PI-ALPH-ADMIN-KEY,
  2223           PI-KEY-LENGTH,
  2224           DFHEIV99,
  2225           DFHEIV99
  2226     SET ADDRESS OF ALPHA-INDEX TO
  2227         DFHEIV20
  2228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2229     ELSE
  2230          MOVE ZERO           TO  PI-START-SW
  2231
  2232* EXEC CICS READ
  2233*             DATASET   (PI-DSID)
  2234*             RIDFLD    (PI-ALPH-ADMIN-KEY)
  2235*             SET       (ADDRESS OF ALPHA-INDEX)
  2236*         END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL1324.cbl
  2237*    MOVE '&"S        E          (   #00002132' TO DFHEIV0
  2238     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2239     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2240     MOVE X'2020233030303032313332' TO DFHEIV0(25:11)
  2241     CALL 'kxdfhei1' USING DFHEIV0,
  2242           PI-DSID,
  2243           DFHEIV20,
  2244           DFHEIV99,
  2245           PI-ALPH-ADMIN-KEY,
  2246           DFHEIV99,
  2247           DFHEIV99,
  2248           DFHEIV99
  2249     SET ADDRESS OF ALPHA-INDEX TO
  2250         DFHEIV20
  2251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2252
  2253
  2254     GO TO 9300-XCTL.
  2255
  2256 4000-EXIT.
  2257     EXIT.
  2258 4080-NOTFND.
  2259     MOVE ER-0284                   TO  EMI-ERROR.
  2260
  2261     IF PI-RETURN-TO-PROGRAM = 'EL127   '
  2262       AND WS-CALL-SW = ZERO
  2263         GO TO 4090-EXIT.
  2264
  2265     GO TO 8200-SEND-DATAONLY.
  2266
  2267 4090-EXIT.
  2268     EXIT.
  2269
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL1324.cbl
  2271 7000-BUILD-SCREEN     SECTION.
  2272******************************************************************
  2273*          REBUILD ORIGNAL SCREEN AND ERROR MESSAGE IF EL1322    *
  2274*          DID NOT FIND ANY CLAIM RECORDS DURING BROWSE OF FILE. *
  2275******************************************************************
  2276     IF EIBTRNID = WS-TRANS-ID
  2277         NEXT SENTENCE
  2278       ELSE
  2279         GO TO 7099-EXIT.
  2280
  2281     IF  PI-BROWSE-SW = +9
  2282         NEXT SENTENCE
  2283        ELSE
  2284         GO TO 7099-EXIT.
  2285
  2286     MOVE LOW-VALUES             TO  EL1324AO.
  2287
  2288     MOVE ER-2374                TO  EMI-ERROR.
  2289
  2290     IF OPTION-ONE-SELECTED
  2291        GO TO 7099-EXIT.
  2292
  2293     IF OPTION-TWO-SELECTED
  2294        NEXT SENTENCE
  2295     ELSE
  2296        GO TO 7030-OPTION-THREE.
  2297
  2298 7020-OPTION-TWO.
  2299
  2300     IF  PI-CLM-CLAIM-NO   GREATER SPACES
  2301         MOVE PI-CLM-CLAIM-NO        TO ALCLMNOO
  2302         MOVE AL-UANON               TO ALCLMNOA.
  2303
  2304     IF  PI-CLM-CARRIER    GREATER SPACES
  2305         MOVE PI-CLM-CARRIER         TO ALCARNOO
  2306         MOVE AL-UANON               TO ALCARNOA.
  2307
  2308     IF  PI-CLM-CERT-PRM   GREATER SPACES
  2309         MOVE PI-CLM-CERT-PRM        TO ALCERTO
  2310         MOVE AL-UANON               TO ALCERTA.
  2311
  2312     IF  PI-CLM-CERT-SFX   GREATER SPACES
  2313         MOVE PI-CLM-CERT-SFX        TO ALCRTSXO
  2314         MOVE AL-UANON               TO ALCRTSXA.
  2315
  2316     GO TO   7090-INITIALIZE-WORK-AREAS.
  2317
  2318 7030-OPTION-THREE.
  2319
  2320     IF OPTION-THREE-SELECTED
  2321        NEXT SENTENCE
  2322     ELSE
  2323        GO TO 7040-OPTION-FOUR.
  2324
  2325     MOVE -1                          TO ALFCARRL.
  2326
  2327     IF PI-ADM-CARRIER   GREATER SPACES
  2328        MOVE PI-ADM-CARRIER           TO ALFCARRO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL1324.cbl
  2329        MOVE AL-UANON                 TO ALFCARRA.
  2330
  2331     IF PI-ADM-GROUPING  GREATER SPACES
  2332        MOVE PI-ADM-GROUPING          TO ALFGRPO
  2333        MOVE AL-UANON                 TO ALFGRPA.
  2334
  2335     IF PI-ADM-STATE     GREATER SPACES
  2336        MOVE PI-ADM-STATE             TO ALFSTO
  2337        MOVE AL-UANON                 TO ALFSTA.
  2338
  2339     IF PI-ADM-PRODUCER  GREATER SPACES
  2340        MOVE PI-ADM-PRODUCER          TO ALFACCTO
  2341        MOVE AL-UANON                 TO ALFACCTA.
  2342
  2343     IF PI-ADM-CERT-EFF-DT   GREATER SPACES
  2344        MOVE PI-ADM-CERT-EFF-DT       TO ALFEFDTO
  2345        MOVE AL-UANON                 TO ALFEFDTA.
  2346
  2347     IF PI-ADM-CERT-NUMBER   GREATER SPACES
  2348        MOVE PI-ADM-CERT-PRM          TO ALFCERTO
  2349        MOVE AL-UANON                 TO ALFCERTA
  2350        MOVE PI-ADM-CERT-SFX          TO ALFCRTXO
  2351        MOVE AL-UANON                 TO ALFCRTXA.
  2352
  2353     GO TO   7090-INITIALIZE-WORK-AREAS.
  2354
  2355 7040-OPTION-FOUR.
  2356     MOVE -1                    TO ALFLNMEL.
  2357
  2358     IF  PI-ALPH-LAST-NAME GREATER SPACES
  2359         MOVE PI-ALPH-LAST-NAME       TO ALFLNMEO
  2360         MOVE AL-UANON                TO ALFLNMEA
  2361         IF  PI-ALPH-F-INIT GREATER SPACES
  2362             MOVE PI-ALPH-FRST-NAME   TO ALFFNMEO
  2363             MOVE PI-ALPH-MID-INIT    TO ALFINTLO
  2364             MOVE AL-UANON            TO ALFFNMEA
  2365             MOVE AL-UANON            TO ALFINTLA.
  2366
  2367
  2368 7090-INITIALIZE-WORK-AREAS.
  2369     MOVE SPACES                 TO  PI-PROGRAM-WORK-AREA.
  2370
  2371     MOVE ZERO                   TO  PI-1ST-TIME-SW
  2372                                     PI-LINE-COUNT
  2373                                     PI-AIX-RECORD-COUNT
  2374                                     PI-BROWSE-SW
  2375                                     PI-KEY-LENGTH
  2376                                     PI-TS-ITEM
  2377                                     PI-END-OF-FILE
  2378                                     PI-START-SW.
  2379
  2380     GO TO 8100-SEND-INITIAL-MAP.
  2381
  2382 7099-EXIT.
  2383     EXIT.
  2384
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL1324.cbl
  2386 8100-SEND-INITIAL-MAP SECTION.
  2387
  2388     MOVE EIBTIME                TO  TIME-IN.
  2389     MOVE SAVE-DATE              TO  ALDATEO.
  2390     MOVE TIME-OUT               TO  ALTIMEO.
  2391     MOVE PI-COMPANY-ID          TO  ALCOMPO.
  2392     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  2393
  2394     IF EMI-ERROR NOT = ZERO
  2395         PERFORM 9900-ERROR-FORMAT.
  2396
  2397     IF PI-SESSION-IN-PROGRESS  =  '1'
  2398         MOVE -1                 TO  ALLNAMEL
  2399     ELSE
  2400         MOVE -1                 TO  ALFCARRL.
  2401
  2402     MOVE EMI-MESSAGE-AREA (1)   TO  ALFMSG1O.
  2403     MOVE EMI-MESSAGE-AREA (2)   TO  ALFMSG2O.
  2404
  2405*    IF PI-ORIGINAL-COMPANY-ID NOT EQUAL SPACES
  2406*        MOVE PI-COMPANY-ID          TO  ALCOMPO
  2407*    ELSE
  2408*        MOVE SPACES                 TO  ALCOMPO.
  2409
  2410
  2411* EXEC CICS SEND
  2412*        FROM   (EL1324AO)
  2413*        MAPSET (WS-MAPSET-NAME)
  2414*        MAP    (WS-MAP-NAME)
  2415*        CURSOR
  2416*        ERASE
  2417*    END-EXEC.
  2418     MOVE LENGTH OF
  2419      EL1324AO
  2420       TO DFHEIV12
  2421     MOVE -1
  2422       TO DFHEIV11
  2423*    MOVE '8$     CT  E    H L F ,   #00002294' TO DFHEIV0
  2424     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2425     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2426     MOVE X'2020233030303032323934' TO DFHEIV0(25:11)
  2427     CALL 'kxdfhei1' USING DFHEIV0,
  2428           WS-MAP-NAME,
  2429           EL1324AO,
  2430           DFHEIV12,
  2431           WS-MAPSET-NAME,
  2432           DFHEIV99,
  2433           DFHEIV99,
  2434           DFHEIV99,
  2435           DFHEIV11,
  2436           DFHEIV99,
  2437           DFHEIV99,
  2438           DFHEIV99
  2439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2440
  2441
  2442     GO TO 9100-RETURN-TRAN.
  2443
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL1324.cbl
  2444 8100-EXIT.
  2445     EXIT.
  2446
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL1324.cbl
  2448 8200-SEND-DATAONLY SECTION.
  2449
  2450     MOVE EIBTIME                TO  TIME-IN.
  2451     MOVE SAVE-DATE              TO  ALDATEO.
  2452     MOVE TIME-OUT               TO  ALTIMEO.
  2453     MOVE PI-COMPANY-ID          TO  ALCOMPO.
  2454     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  2455
  2456     IF EMI-ERROR NOT = ZERO
  2457         PERFORM 9900-ERROR-FORMAT.
  2458
  2459     MOVE EMI-MESSAGE-AREA (1)   TO  ALFMSG1O.
  2460     MOVE EMI-MESSAGE-AREA (2)   TO  ALFMSG2O.
  2461
  2462*    IF PI-ORIGINAL-COMPANY-ID NOT = SPACES
  2463*        MOVE PI-COMPANY-ID      TO  ALCOMPO
  2464*    ELSE
  2465*        MOVE SPACES             TO  ALCOMPO.
  2466
  2467
  2468* EXEC CICS SEND DATAONLY
  2469*        FROM   (EL1324AO)
  2470*        MAPSET (WS-MAPSET-NAME)
  2471*        MAP    (WS-MAP-NAME)
  2472*        CURSOR
  2473*    END-EXEC.
  2474     MOVE LENGTH OF
  2475      EL1324AO
  2476       TO DFHEIV12
  2477     MOVE -1
  2478       TO DFHEIV11
  2479*    MOVE '8$D    CT       H L F ,   #00002327' TO DFHEIV0
  2480     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2481     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2482     MOVE X'2020233030303032333237' TO DFHEIV0(25:11)
  2483     CALL 'kxdfhei1' USING DFHEIV0,
  2484           WS-MAP-NAME,
  2485           EL1324AO,
  2486           DFHEIV12,
  2487           WS-MAPSET-NAME,
  2488           DFHEIV99,
  2489           DFHEIV99,
  2490           DFHEIV99,
  2491           DFHEIV11,
  2492           DFHEIV99,
  2493           DFHEIV99,
  2494           DFHEIV99
  2495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2496
  2497
  2498     GO TO 9100-RETURN-TRAN.
  2499
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL1324.cbl
  2501 8300-SEND-TEXT SECTION.
  2502
  2503* EXEC CICS SEND TEXT
  2504*        FROM   (LOGOFF-TEXT)
  2505*        LENGTH (LOGOFF-LENGTH)
  2506*        ERASE  FREEKB
  2507*    END-EXEC.
  2508*    MOVE '8&      T  E F  H   F -   #00002338' TO DFHEIV0
  2509     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2510     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2511     MOVE X'2020233030303032333338' TO DFHEIV0(25:11)
  2512     CALL 'kxdfhei1' USING DFHEIV0,
  2513           LOGOFF-TEXT,
  2514           LOGOFF-LENGTH,
  2515           DFHEIV99,
  2516           DFHEIV99,
  2517           DFHEIV99,
  2518           DFHEIV99,
  2519           DFHEIV99,
  2520           DFHEIV99,
  2521           DFHEIV99,
  2522           DFHEIV99,
  2523           DFHEIV99,
  2524           DFHEIV99
  2525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2526
  2527
  2528
  2529* EXEC CICS RETURN
  2530*    END-EXEC.
  2531*    MOVE '.(                    &   #00002344' TO DFHEIV0
  2532     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2533     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2534     MOVE X'2020233030303032333434' TO DFHEIV0(25:11)
  2535     CALL 'kxdfhei1' USING DFHEIV0,
  2536           DFHEIV99,
  2537           DFHEIV99,
  2538           DFHEIV99,
  2539           DFHEIV99,
  2540           DFHEIV99
  2541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2542
  2543
  2544 8300-EXIT.
  2545     EXIT.
  2546
  2547 8500-DATE-CONVERSION SECTION.
  2548
  2549* EXEC CICS LINK
  2550*        PROGRAM  ('ELDATCV')
  2551*        COMMAREA (DATE-CONVERSION-DATA)
  2552*        LENGTH   (DC-COMM-LENGTH)
  2553*    END-EXEC.
  2554     MOVE 'ELDATCV' TO DFHEIV1
  2555*    MOVE '."C                   ''   #00002351' TO DFHEIV0
  2556     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2557     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2558     MOVE X'2020233030303032333531' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL1324.cbl
  2559     CALL 'kxdfhei1' USING DFHEIV0,
  2560           DFHEIV1,
  2561           DATE-CONVERSION-DATA,
  2562           DC-COMM-LENGTH,
  2563           DFHEIV99,
  2564           DFHEIV99,
  2565           DFHEIV99
  2566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2567
  2568
  2569 8500-EXIT.
  2570     EXIT.
  2571
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL1324.cbl
  2573 8800-NOTOPEN SECTION.
  2574
  2575     MOVE ER-0777                TO  EMI-ERROR
  2576     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  2577     GO TO  8200-SEND-DATAONLY.
  2578
  2579
  2580 9000-RETURN-CICS SECTION.
  2581     MOVE XCTL-005               TO  THIS-PGM.
  2582     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  2583     PERFORM 9300-XCTL.
  2584
  2585 9000-EXIT.
  2586     EXIT.
  2587
  2588 9100-RETURN-TRAN SECTION.
  2589     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  2590     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  2591
  2592
  2593* EXEC CICS RETURN
  2594*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2595*        LENGTH   (PI-COMM-LENGTH)
  2596*        TRANSID  (WS-TRANS-ID)
  2597*    END-EXEC.
  2598*    MOVE '.(CT                  &   #00002380' TO DFHEIV0
  2599     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2600     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2601     MOVE X'2020233030303032333830' TO DFHEIV0(25:11)
  2602     CALL 'kxdfhei1' USING DFHEIV0,
  2603           WS-TRANS-ID,
  2604           PROGRAM-INTERFACE-BLOCK,
  2605           PI-COMM-LENGTH,
  2606           DFHEIV99,
  2607           DFHEIV99
  2608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2609
  2610
  2611 9100-EXIT.
  2612     EXIT.
  2613
  2614 9300-XCTL SECTION.
  2615     MOVE DFHENTER               TO  EIBAID.
  2616
  2617
  2618* EXEC CICS XCTL
  2619*        PROGRAM  (THIS-PGM)
  2620*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2621*        LENGTH   (PI-COMM-LENGTH)
  2622*    END-EXEC.
  2623*    MOVE '.$C                   $   #00002392' TO DFHEIV0
  2624     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2625     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2626     MOVE X'2020233030303032333932' TO DFHEIV0(25:11)
  2627     CALL 'kxdfhei1' USING DFHEIV0,
  2628           THIS-PGM,
  2629           PROGRAM-INTERFACE-BLOCK,
  2630           PI-COMM-LENGTH
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL1324.cbl
  2631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2632
  2633
  2634 9300-EXIT.
  2635     EXIT.
  2636
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL1324.cbl
  2638 9400-CLEAR SECTION.
  2639     MOVE PI-RETURN-TO-PROGRAM  TO  THIS-PGM
  2640     GO TO 9300-XCTL.
  2641
  2642 9400-EXIT.
  2643     EXIT.
  2644
  2645 9600-PGMIDERR SECTION.
  2646
  2647* EXEC CICS HANDLE CONDITION
  2648*        PGMIDERR (8300-SEND-TEXT)
  2649*    END-EXEC.
  2650*    MOVE '"$L                   ! $ #00002410' TO DFHEIV0
  2651     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2652     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2653     MOVE X'2420233030303032343130' TO DFHEIV0(25:11)
  2654     CALL 'kxdfhei1' USING DFHEIV0
  2655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2656
  2657
  2658     MOVE THIS-PGM               TO  PI-CALLING-PROGRAM
  2659                                     LOGOFF-PGM.
  2660
  2661     MOVE XCTL-005               TO  THIS-PGM.
  2662     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  2663     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  2664     GO TO 9300-XCTL.
  2665
  2666 9600-EXIT.
  2667     EXIT.
  2668
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL1324.cbl
  2670 9900-ERROR-FORMAT SECTION.
  2671
  2672     MOVE LINK-001                TO  THIS-PGM.
  2673
  2674
  2675* EXEC CICS LINK
  2676*        PROGRAM  (THIS-PGM)
  2677*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  2678*        LENGTH   (EMI-COMM-LENGTH)
  2679*    END-EXEC.
  2680*    MOVE '."C                   ''   #00002430' TO DFHEIV0
  2681     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2682     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2683     MOVE X'2020233030303032343330' TO DFHEIV0(25:11)
  2684     CALL 'kxdfhei1' USING DFHEIV0,
  2685           THIS-PGM,
  2686           ERROR-MESSAGE-INTERFACE-BLOCK,
  2687           EMI-COMM-LENGTH,
  2688           DFHEIV99,
  2689           DFHEIV99,
  2690           DFHEIV99
  2691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2692
  2693
  2694     MOVE ER-0000                   TO  EMI-ERROR.
  2695
  2696 9900-EXIT.
  2697     EXIT.
  2698
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL1324.cbl
  2700 9990-ERROR SECTION.
  2701     MOVE DFHEIBLK TO EMI-LINE1.
  2702     MOVE LINK-004                TO  THIS-PGM.
  2703
  2704
  2705* EXEC CICS LINK
  2706*        PROGRAM  (THIS-PGM)
  2707*        COMMAREA (EMI-LINE1)
  2708*        LENGTH   (72)
  2709*    END-EXEC.
  2710     MOVE 72
  2711       TO DFHEIV11
  2712*    MOVE '."C                   ''   #00002446' TO DFHEIV0
  2713     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2714     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2715     MOVE X'2020233030303032343436' TO DFHEIV0(25:11)
  2716     CALL 'kxdfhei1' USING DFHEIV0,
  2717           THIS-PGM,
  2718           EMI-LINE1,
  2719           DFHEIV11,
  2720           DFHEIV99,
  2721           DFHEIV99,
  2722           DFHEIV99
  2723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2724
  2725
  2726     GO TO 8200-SEND-DATAONLY.
  2727
  2728 9990-EXIT.
  2729     EXIT.
  2730
  2731 9995-SECURITY-VIOLATION.
  2732*           COPY ELCSCTP.
  2733******************************************************************
  2734*                                                                *
  2735*                            ELCSCTP                             *
  2736*                            VMOD=2.001                          *
  2737*                                                                *
  2738*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2739******************************************************************
  2740
  2741
  2742     MOVE EIBDATE          TO SM-JUL-DATE.
  2743     MOVE EIBTRMID         TO SM-TERMID.
  2744     MOVE THIS-PGM         TO SM-PGM.
  2745     MOVE EIBTIME          TO TIME-IN.
  2746     MOVE TIME-OUT         TO SM-TIME.
  2747     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2748
  2749
  2750* EXEC CICS LINK
  2751*         PROGRAM  ('EL003')
  2752*         COMMAREA (SECURITY-MESSAGE)
  2753*         LENGTH   (80)
  2754*    END-EXEC.
  2755     MOVE 'EL003' TO DFHEIV1
  2756     MOVE 80
  2757       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL1324.cbl
  2758*    MOVE '."C                   ''   #00002475' TO DFHEIV0
  2759     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2760     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2761     MOVE X'2020233030303032343735' TO DFHEIV0(25:11)
  2762     CALL 'kxdfhei1' USING DFHEIV0,
  2763           DFHEIV1,
  2764           SECURITY-MESSAGE,
  2765           DFHEIV11,
  2766           DFHEIV99,
  2767           DFHEIV99,
  2768           DFHEIV99
  2769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2770
  2771
  2772******************************************************************
  2773
  2774
  2775 9995-EXIT.
  2776     EXIT.
  2777
  2778
  2780
  2781 9999-DFHBACK SECTION.
  2782     MOVE '9%                    "   ' TO DFHEIV0
  2783     MOVE 'EL1324' TO DFHEIV1
  2784     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2785     GOBACK.
  2786 9999-DFHEXIT.
  2787     IF DFHEIGDJ EQUAL 0001
  2788         NEXT SENTENCE
  2789     ELSE IF DFHEIGDJ EQUAL 2
  2790         GO TO 9600-PGMIDERR,
  2791               8800-NOTOPEN,
  2792               9990-ERROR
  2793         DEPENDING ON DFHEIGDI
  2794     ELSE IF DFHEIGDJ EQUAL 3
  2795         GO TO 9300-XCTL,
  2796               4080-NOTFND
  2797         DEPENDING ON DFHEIGDI
  2798     ELSE IF DFHEIGDJ EQUAL 4
  2799         GO TO 8300-SEND-TEXT
  2800         DEPENDING ON DFHEIGDI.
  2801     MOVE '9%                    "   ' TO DFHEIV0
  2802     MOVE 'EL1324' TO DFHEIV1
  2803     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2804     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3904     Code:        7120
