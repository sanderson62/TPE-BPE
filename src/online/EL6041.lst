* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6041.cbl
* Options: int("EL6041.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6041.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6041.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6041.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6041.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 17:00:55.
     7*                            VMOD=2.004.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6041.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.    TRANSACTION - EX67 - REPORT CUSTOMIZATION.
    26
    27 ENVIRONMENT DIVISION.
    28
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6041.cbl
    30 DATA DIVISION.
    31 WORKING-STORAGE SECTION.
    32 01  DFH-START PIC X(04).
    33 77  FILLER  PIC X(32)  VALUE '********************************'.
    34 77  FILLER  PIC X(32)  VALUE '*    EL6041  WORKING STORAGE   *'.
    35 77  FILLER  PIC X(32)  VALUE '************VMOD=2.004 *********'.
    36
    37*                                COPY ELCSCTM.
    38******************************************************************
    39*                                                                *
    40*                                                                *
    41*                            ELCSCTM                             *
    42*                            VMOD=2.001                          *
    43*                                                                *
    44*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    45*                                                                *
    46******************************************************************
    47 01  SECURITY-MESSAGE.
    48     12  FILLER                          PIC X(30)
    49            VALUE '** LOGIC SECURITY VIOLATION -'.
    50     12  SM-READ                         PIC X(6).
    51     12  FILLER                          PIC X(5)
    52            VALUE ' PGM='.
    53     12  SM-PGM                          PIC X(6).
    54     12  FILLER                          PIC X(5)
    55            VALUE ' OPR='.
    56     12  SM-PROCESSOR-ID                 PIC X(4).
    57     12  FILLER                          PIC X(6)
    58            VALUE ' TERM='.
    59     12  SM-TERMID                       PIC X(4).
    60     12  FILLER                          PIC XX   VALUE SPACE.
    61     12  SM-JUL-DATE                     PIC 9(5).
    62     12  FILLER                          PIC X    VALUE SPACE.
    63     12  SM-TIME                         PIC 99.99.
    64
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6041.cbl
    66*                                COPY ELCSCRTY.
    67******************************************************************
    68*                                                                *
    69*                                                                *
    70*                            ELCSCRTY                            *
    71*                            VMOD=2.001                          *
    72*                                                                *
    73*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    74*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    75*        SAVED IN PI-SECURITY-ADDRESS.                           *
    76*                                                                *
    77******************************************************************
    78 01  SECURITY-CONTROL.
    79     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    80     12  FILLER                       PIC XX    VALUE 'SC'.
    81     12  SC-CREDIT-CODES.
    82         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    83             20  SC-CREDIT-DISPLAY    PIC X.
    84             20  SC-CREDIT-UPDATE     PIC X.
    85     12  SC-CLAIMS-CODES.
    86         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    87             20  SC-CLAIMS-DISPLAY    PIC X.
    88             20  SC-CLAIMS-UPDATE     PIC X.
    89
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6041.cbl
    91 01  WS-DATE-AREA.
    92     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    93     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    94
    95 01  STANDARD-AREAS.
    96     12  SC-ITEM                     PIC S9(4) COMP VALUE +1.
    97     12  WS-TEST-CARRIER             PIC X       VALUE SPACES.
    98     12  WS-TEST-STATE               PIC XX      VALUE SPACES.
    99     12  WS-TEST-BUSTYP              PIC 99      VALUE ZEROS.
   100     12  WS-TEST-BEN                 PIC XX      VALUE SPACES.
   101         88  INVALID-BENEFIT-CODE       VALUE '00'
   102                                              '90' THRU '99'.
   103     12  WS-TEST-LEN                 PIC S9(4)   VALUE +0.
   104     12  WS-TEST-ATTRB               PIC X       VALUE SPACES.
   105     12  WS-SUB                      PIC S9(4)   VALUE +0 COMP.
   106     12  WS-BROWSE-SW                PIC X       VALUE SPACES.
   107     12  WS-SEQ-AREA.
   108         16  WS-SEQ-NO OCCURS 6 TIMES PIC X.
   109     12  WS-LO-EFF                   PIC XX      VALUE LOW-VALUES.
   110     12  WS-HI-EFF                   PIC XX      VALUE LOW-VALUES.
   111     12  WS-LO-ENT                   PIC XX      VALUE LOW-VALUES.
   112     12  WS-HI-ENT                   PIC XX      VALUE LOW-VALUES.
   113     12  WS-LO-LOSS                  PIC S9(3)V99 VALUE +0.
   114     12  WS-HI-LOSS                  PIC S9(3)V99 VALUE +0.
   115     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   116     12  MAP-NAME                    PIC X(8)    VALUE 'EL6041A'.
   117     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL6041S'.
   118     12  SCREEN-NUMBER               PIC X(4)    VALUE '604B'.
   119     12  TRANS-ID                    PIC X(4)    VALUE 'EX67'.
   120     12  THIS-PGM                    PIC X(8)    VALUE 'EL6041'.
   121     12  PGM-NAME                    PIC X(8).
   122     12  TIME-IN                     PIC S9(7).
   123     12  TIME-OUT-R  REDEFINES TIME-IN.
   124         16  FILLER                  PIC X.
   125         16  TIME-OUT                PIC 99V99.
   126         16  FILLER                  PIC XX.
   127     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   128     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   129     12  XCTL-EL126                  PIC X(8)    VALUE 'EL126'.
   130     12  XCTL-EL626                  PIC X(8)    VALUE 'EL626'.
   131     12  XCTL-EM626                  PIC X(8)    VALUE 'EM626'.
   132     12  XCTL-GL800                  PIC X(8)    VALUE 'GL800'.
   133     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   134     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   135     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   136     12  ELCNTL-FILE-ID              PIC X(8)    VALUE 'ELCNTL'.
   137     12  WS-JOURNAL-RECORD-LENGTH PIC S9(4)   COMP VALUE +750.
   138
   139     12  DEEDIT-FIELD                PIC X(15).
   140     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD   PIC S9(15).
   141     12  DEEDIT-FIELD-V1 REDEFINES DEEDIT-FIELD   PIC S9(14)V9.
   142     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD   PIC S9(13)V99.
   143
   144     12  RETURN-FROM                 PIC X(8).
   145     12  WS-REPORT-FOUND-SW          PIC X       VALUE 'N'.
   146         88  REPORT-WAS-FOUND                    VALUE 'Y'.
   147         88  REPORT-WAS-NOT-FOUND                VALUE 'N'.
   148
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6041.cbl
   149 01  WS-MISC-WORK.
   150     12  WS-COMBINED-LIFE-AH-OPT.
   151         16  WS-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
   152         16  WS-SINGLE-MO-PREM-PCT      PIC S9(02).
   153         16  WS-EARN-PREM-DECLINE       PIC S9(02).
   154         16  WS-CANCELLATION-RATIO      PIC S9(02).
   155         16  WS-RETENTION-LIMIT         PIC S9(07).
   156
   157     12  WS-LIFE-OPT.
   158         16  WS-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
   159         16  WS-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
   160         16  WS-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
   161         16  WS-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
   162         16  WS-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
   163         16  WS-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
   164         16  WS-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
   165         16  WS-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
   166         16  WS-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
   167         16  WS-LF-AVG-AGE-MAX          PIC S9(02).
   168
   169     12  WS-AH-OPT.
   170         16  WS-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
   171         16  WS-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
   172         16  WS-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
   173         16  WS-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
   174         16  WS-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
   175         16  WS-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
   176         16  WS-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
   177         16  WS-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
   178         16  WS-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
   179         16  WS-AH-AVG-AGE-MAX          PIC S9(02).
   180
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6041.cbl
   182 01   ERROR-MESSAGES.
   183     12  ER-0000                     PIC  X(4)   VALUE '0000'.
   184     12  ER-0004                     PIC  X(4)   VALUE '0004'.
   185     12  ER-0021                     PIC  X(4)   VALUE '0021'.
   186     12  ER-0023                     PIC  X(4)   VALUE '0023'.
   187     12  ER-0028                     PIC  X(4)   VALUE '0028'.
   188     12  ER-0029                     PIC  X(4)   VALUE '0029'.
   189     12  ER-0050                     PIC  X(4)   VALUE '0050'.
   190     12  ER-0068                     PIC  X(4)   VALUE '0068'.
   191     12  ER-0070                     PIC  X(4)   VALUE '0070'.
   192     12  ER-0132                     PIC  X(4)   VALUE '0132'.
   193     12  ER-0138                     PIC  X(4)   VALUE '0138'.
   194     12  ER-0139                     PIC  X(4)   VALUE '0139'.
   195     12  ER-0142                     PIC  X(4)   VALUE '0142'.
   196     12  ER-2001                     PIC  X(4)   VALUE '2001'.
   197     12  ER-2178                     PIC  X(4)   VALUE '2178'.
   198     12  ER-2223                     PIC  X(4)   VALUE '2223'.
   199     12  ER-2237                     PIC  X(4)   VALUE '2237'.
   200     12  ER-2238                     PIC  X(4)   VALUE '2238'.
   201     12  ER-2845                     PIC  X(4)   VALUE '2845'.
   202     12  ER-2848                     PIC  X(4)   VALUE '2848'.
   203     12  ER-7008                     PIC  X(4)   VALUE '7008'.
   204     12  ER-7123                     PIC  X(4)   VALUE '7123'.
   205     12  ER-7125                     PIC  X(4)   VALUE '7125'.
   206     12  ER-7354                     PIC  X(4)   VALUE '7354'.
   207     12  ER-7680                     PIC  X(4)   VALUE '7680'.
   208     12  ER-7681                     PIC  X(4)   VALUE '7681'.
   209     12  ER-7682                     PIC  X(4)   VALUE '7682'.
   210     12  ER-7683                     PIC  X(4)   VALUE '7683'.
   211     12  ER-7684                     PIC  X(4)   VALUE '7684'.
   212     12  ER-7685                     PIC  X(4)   VALUE '7685'.
   213     12  ER-9096                     PIC  X(4)   VALUE '9096'.
   214     12  ER-9097                     PIC  X(4)   VALUE '9097'.
   215
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6041.cbl
   217
   218 01  ACCESS-KEYS.
   219     12  ELCNTL-KEY.
   220         16  ELCNTL-COMPANY-ID          PIC  XXX.
   221         16  ELCNTL-RECORD-TYPE         PIC  X.
   222         16  FILLER                     PIC  X.
   223         16  ELCNTL-REPORT              PIC  999.
   224         16  ELCNTL-SEQ-NO              PIC  S9(4)   COMP.
   225
   226     12  ELCNTL-TEST-KEY.
   227         16  ELCNTL-TEST-COMP-ID        PIC  XXX.
   228         16  ELCNTL-TEST-REC-TYPE       PIC  X.
   229         16  ELCNTL-ACCESS-KEY.
   230             20  FILLER                 PIC  XXX.
   231             20  ELCNTL-TEST-CAR        PIC  X.
   232         16  ELCNTL-ACCESS-KEY1 REDEFINES ELCNTL-ACCESS-KEY.
   233             20  ELCNTL-TEST-STATE      PIC  XX.
   234             20  FILLER                 PIC  XX.
   235         16  ELCNTL-ACCESS-KEY2 REDEFINES ELCNTL-ACCESS-KEY.
   236             20  FILLER                 PIC  XX.
   237             20  ELCNTL-TEST-BEN        PIC  XX.
   238         16  ELCNTL-ACCESS-KEY3 REDEFINES ELCNTL-ACCESS-KEY.
   239             20  FILLER                 PIC  XX.
   240             20  ELCNTL-TEST-BUSTYP     PIC  99.
   241         16  ELCNTL-TEST-SEQ-NO         PIC  S9(4)   COMP.
   242
   243     12  ELCNTL-LENGTH           PIC S9(4) COMP VALUE +750.
   244
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6041.cbl
   246*                                COPY ELCDATE.
   247******************************************************************
   248*                                                                *
   249*                                                                *
   250*                            ELCDATE.                            *
   251*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   252*                            VMOD=2.003
   253*                                                                *
   254*                                                                *
   255*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   256*                 LENGTH = 200                                   *
   257******************************************************************
   258
   259 01  DATE-CONVERSION-DATA.
   260     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   261     12  DC-OPTION-CODE                PIC X.
   262         88  BIN-TO-GREG                VALUE ' '.
   263         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   264         88  EDIT-GREG-TO-BIN           VALUE '2'.
   265         88  YMD-GREG-TO-BIN            VALUE '3'.
   266         88  MDY-GREG-TO-BIN            VALUE '4'.
   267         88  JULIAN-TO-BIN              VALUE '5'.
   268         88  BIN-PLUS-ELAPSED           VALUE '6'.
   269         88  FIND-CENTURY               VALUE '7'.
   270         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   271         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   272         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   273         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   274         88  JULIAN-TO-BIN-3            VALUE 'C'.
   275         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   276         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   277         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   278         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   279         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   280         88  CHECK-LEAP-YEAR            VALUE 'H'.
   281         88  BIN-3-TO-GREG              VALUE 'I'.
   282         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   283         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   284         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   285         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   286         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   287         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   288         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   289         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   290         88  THREE-CHARACTER-BIN
   291                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   292         88  GREGORIAN-TO-BIN
   293                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   294         88  BIN-TO-GREGORIAN
   295                  VALUES ' ' '1' 'I' '8' 'G'.
   296         88  JULIAN-TO-BINARY
   297                  VALUES '5' 'C' 'E' 'F'.
   298     12  DC-ERROR-CODE                 PIC X.
   299         88  NO-CONVERSION-ERROR        VALUE ' '.
   300         88  DATE-CONVERSION-ERROR
   301                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   302         88  DATE-IS-ZERO               VALUE '1'.
   303         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6041.cbl
   304         88  DATE-IS-INVALID            VALUE '3'.
   305         88  DATE1-GREATER-DATE2        VALUE '4'.
   306         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   307         88  DATE-INVALID-OPTION        VALUE '9'.
   308         88  INVALID-CENTURY            VALUE 'A'.
   309         88  ONLY-CENTURY               VALUE 'B'.
   310         88  ONLY-LEAP-YEAR             VALUE 'C'.
   311         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   312     12  DC-END-OF-MONTH               PIC X.
   313         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   314     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   315         88  USE-NORMAL-PROCESS         VALUE ' '.
   316         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   317         88  ADJUST-UP-100-YRS          VALUE '2'.
   318     12  FILLER                        PIC X.
   319     12  DC-CONVERSION-DATES.
   320         16  DC-BIN-DATE-1             PIC XX.
   321         16  DC-BIN-DATE-2             PIC XX.
   322         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   323         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   324                       DC-GREG-DATE-1-EDIT.
   325             20  DC-EDIT1-MONTH        PIC 99.
   326             20  SLASH1-1              PIC X.
   327             20  DC-EDIT1-DAY          PIC 99.
   328             20  SLASH1-2              PIC X.
   329             20  DC-EDIT1-YEAR         PIC 99.
   330         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   331         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   332                     DC-GREG-DATE-2-EDIT.
   333             20  DC-EDIT2-MONTH        PIC 99.
   334             20  SLASH2-1              PIC X.
   335             20  DC-EDIT2-DAY          PIC 99.
   336             20  SLASH2-2              PIC X.
   337             20  DC-EDIT2-YEAR         PIC 99.
   338         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   339         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   340                     DC-GREG-DATE-1-YMD.
   341             20  DC-YMD-YEAR           PIC 99.
   342             20  DC-YMD-MONTH          PIC 99.
   343             20  DC-YMD-DAY            PIC 99.
   344         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   345         16  DC-GREG-DATE-1-MDY-R REDEFINES
   346                      DC-GREG-DATE-1-MDY.
   347             20  DC-MDY-MONTH          PIC 99.
   348             20  DC-MDY-DAY            PIC 99.
   349             20  DC-MDY-YEAR           PIC 99.
   350         16  DC-GREG-DATE-1-ALPHA.
   351             20  DC-ALPHA-MONTH        PIC X(10).
   352             20  DC-ALPHA-DAY          PIC 99.
   353             20  FILLER                PIC XX.
   354             20  DC-ALPHA-CENTURY.
   355                 24 DC-ALPHA-CEN-N     PIC 99.
   356             20  DC-ALPHA-YEAR         PIC 99.
   357         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   358         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   359         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   360         16  DC-JULIAN-DATE            PIC 9(05).
   361         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6041.cbl
   362                                       PIC 9(05).
   363         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   364             20  DC-JULIAN-YEAR        PIC 99.
   365             20  DC-JULIAN-DAYS        PIC 999.
   366         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   367         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   368         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   369     12  DATE-CONVERSION-VARIBLES.
   370         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   371         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   372             20  FILLER                PIC 9(3).
   373             20  HOLD-CEN-1-CCYY.
   374                 24  HOLD-CEN-1-CC     PIC 99.
   375                 24  HOLD-CEN-1-YY     PIC 99.
   376             20  HOLD-CEN-1-MO         PIC 99.
   377             20  HOLD-CEN-1-DA         PIC 99.
   378         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   379             20  HOLD-CEN-1-R-MO       PIC 99.
   380             20  HOLD-CEN-1-R-DA       PIC 99.
   381             20  HOLD-CEN-1-R-CCYY.
   382                 24  HOLD-CEN-1-R-CC   PIC 99.
   383                 24  HOLD-CEN-1-R-YY   PIC 99.
   384             20  FILLER                PIC 9(3).
   385         16  HOLD-CENTURY-1-X.
   386             20  FILLER                PIC X(3)  VALUE SPACES.
   387             20  HOLD-CEN-1-X-CCYY.
   388                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   389                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   390             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   391             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   392         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   393             20  HOLD-CEN-1-R-X-MO     PIC XX.
   394             20  HOLD-CEN-1-R-X-DA     PIC XX.
   395             20  HOLD-CEN-1-R-X-CCYY.
   396                 24  HOLD-CEN-1-R-X-CC PIC XX.
   397                 24  HOLD-CEN-1-R-X-YY PIC XX.
   398             20  FILLER                PIC XXX.
   399         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   400         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   401         16  DC-JULIAN-DATE-1          PIC 9(07).
   402         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   403             20  DC-JULIAN-1-CCYY.
   404                 24  DC-JULIAN-1-CC    PIC 99.
   405                 24  DC-JULIAN-1-YR    PIC 99.
   406             20  DC-JULIAN-DA-1        PIC 999.
   407         16  DC-JULIAN-DATE-2          PIC 9(07).
   408         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   409             20  DC-JULIAN-2-CCYY.
   410                 24  DC-JULIAN-2-CC    PIC 99.
   411                 24  DC-JULIAN-2-YR    PIC 99.
   412             20  DC-JULIAN-DA-2        PIC 999.
   413         16  DC-GREG-DATE-A-EDIT.
   414             20  DC-EDITA-MONTH        PIC 99.
   415             20  SLASHA-1              PIC X VALUE '/'.
   416             20  DC-EDITA-DAY          PIC 99.
   417             20  SLASHA-2              PIC X VALUE '/'.
   418             20  DC-EDITA-CCYY.
   419                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6041.cbl
   420                 24  DC-EDITA-YEAR     PIC 99.
   421         16  DC-GREG-DATE-B-EDIT.
   422             20  DC-EDITB-MONTH        PIC 99.
   423             20  SLASHB-1              PIC X VALUE '/'.
   424             20  DC-EDITB-DAY          PIC 99.
   425             20  SLASHB-2              PIC X VALUE '/'.
   426             20  DC-EDITB-CCYY.
   427                 24  DC-EDITB-CENT     PIC 99.
   428                 24  DC-EDITB-YEAR     PIC 99.
   429         16  DC-GREG-DATE-CYMD         PIC 9(08).
   430         16  DC-GREG-DATE-CYMD-R REDEFINES
   431                              DC-GREG-DATE-CYMD.
   432             20  DC-CYMD-CEN           PIC 99.
   433             20  DC-CYMD-YEAR          PIC 99.
   434             20  DC-CYMD-MONTH         PIC 99.
   435             20  DC-CYMD-DAY           PIC 99.
   436         16  DC-GREG-DATE-MDCY         PIC 9(08).
   437         16  DC-GREG-DATE-MDCY-R REDEFINES
   438                              DC-GREG-DATE-MDCY.
   439             20  DC-MDCY-MONTH         PIC 99.
   440             20  DC-MDCY-DAY           PIC 99.
   441             20  DC-MDCY-CEN           PIC 99.
   442             20  DC-MDCY-YEAR          PIC 99.
   443    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   444        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   445    12  DC-EL310-DATE                  PIC X(21).
   446    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6041.cbl
   448*                                COPY ELCLOGOF.
   449******************************************************************
   450*                                                                *
   451*                                                                *
   452*                            ELCLOGOF.                           *
   453*                            VMOD=2.001                          *
   454*                                                                *
   455*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   456*                                                                *
   457******************************************************************
   458 01  CLASIC-LOGOFF.
   459     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   460     12  LOGOFF-TEXT.
   461         16  FILLER          PIC X(5)    VALUE SPACES.
   462         16  LOGOFF-MSG.
   463             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   464             20  FILLER      PIC X       VALUE SPACES.
   465             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   466         16  FILLER          PIC X(80)
   467           VALUE '* YOU ARE NOW LOGGED OFF'.
   468         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   469         16  FILLER          PIC X       VALUE QUOTE.
   470         16  LOGOFF-SYS-MSG  PIC X(17)
   471           VALUE 'S CLAS-IC SYSTEM '.
   472     12  TEXT-MESSAGES.
   473         16  UNACCESS-MSG    PIC X(29)
   474             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   475         16  PGMIDERR-MSG    PIC X(17)
   476             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6041.cbl
   478*                                COPY ELCATTR.
   479******************************************************************
   480*                                                                *
   481*                            ELCATTR.                            *
   482*                            VMOD=2.001                          *
   483*                                                                *
   484*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   485*                                                                *
   486*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   487*                                                                *
   488*                   POS 1   P=PROTECTED                          *
   489*                           U=UNPROTECTED                        *
   490*                           S=ASKIP                              *
   491*                   POS 2   A=ALPHA/NUMERIC                      *
   492*                           N=NUMERIC                            *
   493*                   POS 3   N=NORMAL                             *
   494*                           B=BRIGHT                             *
   495*                           D=DARK                               *
   496*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   497*                           OF=MODIFIED DATA TAG OFF             *
   498*                                                                *
   499*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   500******************************************************************
   501 01  ATTRIBUTE-LIST.
   502     12  AL-PABOF            PIC X       VALUE 'Y'.
   503     12  AL-PABON            PIC X       VALUE 'Z'.
   504     12  AL-PADOF            PIC X       VALUE '%'.
   505     12  AL-PADON            PIC X       VALUE '_'.
   506     12  AL-PANOF            PIC X       VALUE '-'.
   507     12  AL-PANON            PIC X       VALUE '/'.
   508     12  AL-SABOF            PIC X       VALUE '8'.
   509     12  AL-SABON            PIC X       VALUE '9'.
   510     12  AL-SADOF            PIC X       VALUE '@'.
   511     12  AL-SADON            PIC X       VALUE QUOTE.
   512     12  AL-SANOF            PIC X       VALUE '0'.
   513     12  AL-SANON            PIC X       VALUE '1'.
   514     12  AL-UABOF            PIC X       VALUE 'H'.
   515     12  AL-UABON            PIC X       VALUE 'I'.
   516     12  AL-UADOF            PIC X       VALUE '<'.
   517     12  AL-UADON            PIC X       VALUE '('.
   518     12  AL-UANOF            PIC X       VALUE ' '.
   519     12  AL-UANON            PIC X       VALUE 'A'.
   520     12  AL-UNBOF            PIC X       VALUE 'Q'.
   521     12  AL-UNBON            PIC X       VALUE 'R'.
   522     12  AL-UNDOF            PIC X       VALUE '*'.
   523     12  AL-UNDON            PIC X       VALUE ')'.
   524     12  AL-UNNOF            PIC X       VALUE '&'.
   525     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6041.cbl
   527*                                COPY ELCEMIB.
   528******************************************************************
   529*                                                                *
   530*                                                                *
   531*                            ELCEMIB.                            *
   532*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   533*                            VMOD=2.005                          *
   534*                                                                *
   535*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   536*                                                                *
   537******************************************************************
   538 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   539     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   540     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   541     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   542     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   543     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   544     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   545     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   546     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   547     12  EMI-SWITCH1             PIC X        VALUE '1'.
   548         88  EMI-NO-ERRORS                    VALUE '1'.
   549         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   550         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   551     12  EMI-SWITCH2             PIC X        VALUE '1'.
   552         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   553     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   554         88  EMI-AREA1-EMPTY                  VALUE '1'.
   555         88  EMI-AREA1-FULL                   VALUE '2'.
   556     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   557         88  EMI-AREA2-EMPTY                  VALUE '1'.
   558         88  EMI-AREA2-FULL                   VALUE '2'.
   559     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   560         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   561         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   562         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   563         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   564         88  EMI-BYPASS-FATALS                VALUE 'X'.
   565     12  EMI-ERROR-LINES.
   566         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   567         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   568         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   569         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   570             20  EMI-ERR-CODES OCCURS 10 TIMES.
   571                 24  EMI-ERR-NUM         PIC X(4).
   572                 24  EMI-FILLER          PIC X.
   573                 24  EMI-SEV             PIC X.
   574                 24  FILLER              PIC X.
   575             20  FILLER                  PIC X(02).
   576     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   577         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   578             20  EMI-ERROR-NUMBER    PIC X(4).
   579             20  EMI-FILL            PIC X.
   580             20  EMI-SEVERITY        PIC X.
   581             20  FILLER              PIC X.
   582             20  EMI-ERROR-TEXT.
   583                 24  EMI-TEXT-VARIABLE   PIC X(10).
   584                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6041.cbl
   585     12  EMI-SEVERITY-SAVE           PIC X.
   586         88  EMI-NOTE                    VALUE 'N'.
   587         88  EMI-WARNING                 VALUE 'W'.
   588         88  EMI-FORCABLE                VALUE 'F'.
   589         88  EMI-FATAL                   VALUE 'X'.
   590     12  EMI-MESSAGE-FLAG            PIC X.
   591         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   592         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   593     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   594     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   595         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   596         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   597         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   598     12  FILLER                      PIC X(137)  VALUE SPACES.
   599     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   600     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   601     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   602     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6041.cbl
   604*                                COPY ELCINTF.
   605******************************************************************
   606*                                                                *
   607*                                                                *
   608*                            ELCINTF.                            *
   609*                            VMOD=2.017                          *
   610*                                                                *
   611*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   612*                                                                *
   613*       LENGTH = 1024                                            *
   614*                                                                *
   615******************************************************************
   616 01  PROGRAM-INTERFACE-BLOCK.
   617     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   618     12  PI-CALLING-PROGRAM              PIC X(8).
   619     12  PI-SAVED-PROGRAM-1              PIC X(8).
   620     12  PI-SAVED-PROGRAM-2              PIC X(8).
   621     12  PI-SAVED-PROGRAM-3              PIC X(8).
   622     12  PI-SAVED-PROGRAM-4              PIC X(8).
   623     12  PI-SAVED-PROGRAM-5              PIC X(8).
   624     12  PI-SAVED-PROGRAM-6              PIC X(8).
   625     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   626     12  PI-COMPANY-ID                   PIC XXX.
   627     12  PI-COMPANY-CD                   PIC X.
   628
   629     12  PI-COMPANY-PASSWORD             PIC X(8).
   630
   631     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   632
   633     12  PI-CONTROL-IN-PROGRESS.
   634         16  PI-CARRIER                  PIC X.
   635         16  PI-GROUPING                 PIC X(6).
   636         16  PI-STATE                    PIC XX.
   637         16  PI-ACCOUNT                  PIC X(10).
   638         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   639                                         PIC X(10).
   640         16  PI-CLAIM-CERT-GRP.
   641             20  PI-CLAIM-NO             PIC X(7).
   642             20  PI-CERT-NO.
   643                 25  PI-CERT-PRIME       PIC X(10).
   644                 25  PI-CERT-SFX         PIC X.
   645             20  PI-CERT-EFF-DT          PIC XX.
   646         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   647             20  PI-PLAN-CODE            PIC X(2).
   648             20  PI-REVISION-NUMBER      PIC X(3).
   649             20  PI-PLAN-EFF-DT          PIC X(2).
   650             20  PI-PLAN-EXP-DT          PIC X(2).
   651             20  FILLER                  PIC X(11).
   652         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   653             20  PI-OE-REFERENCE-1.
   654                 25  PI-OE-REF-1-PRIME   PIC X(18).
   655                 25  PI-OE-REF-1-SUFF    PIC XX.
   656
   657     12  PI-SESSION-IN-PROGRESS          PIC X.
   658         88  CLAIM-SESSION                   VALUE '1'.
   659         88  CREDIT-SESSION                  VALUE '2'.
   660         88  WARRANTY-SESSION                VALUE '3'.
   661         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6041.cbl
   662         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   663
   664
   665*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   666
   667     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   668     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   669
   670     12  PI-CREDIT-USER                  PIC X.
   671         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   672         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   673
   674     12  PI-CLAIM-USER                   PIC X.
   675         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   676         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   677
   678     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   679         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   680         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   681         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   682         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   683         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   684
   685     12  PI-PROCESSOR-ID                 PIC X(4).
   686
   687     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   688
   689     12  PI-MEMBER-CAPTION               PIC X(10).
   690
   691     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   692         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   693
   694     12  PI-LIFE-OVERRIDE-L1             PIC X.
   695     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   696     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   697     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   698
   699     12  PI-AH-OVERRIDE-L1               PIC X.
   700     12  PI-AH-OVERRIDE-L2               PIC XX.
   701     12  PI-AH-OVERRIDE-L6               PIC X(6).
   702     12  PI-AH-OVERRIDE-L12              PIC X(12).
   703
   704     12  PI-NEW-SYSTEM                   PIC X(2).
   705
   706     12  PI-PRIMARY-CERT-NO              PIC X(11).
   707     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   708         88  PI-USES-PAID-TO                 VALUE '1'.
   709     12  PI-CRDTCRD-SYSTEM.
   710         16  PI-CRDTCRD-USER             PIC X.
   711             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   712             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   713         16  PI-CC-MONTH-END-DT          PIC XX.
   714     12  PI-PROCESSOR-PRINTER            PIC X(4).
   715
   716     12  PI-OE-REFERENCE-2.
   717         16  PI-OE-REF-2-PRIME           PIC X(10).
   718         16  PI-OE-REF-2-SUFF            PIC X.
   719
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6041.cbl
   720     12  PI-REM-TRM-CALC-OPTION          PIC X.
   721
   722     12  PI-LANGUAGE-TYPE                PIC X.
   723             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   724             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   725             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   726
   727     12  PI-POLICY-LINKAGE-IND           PIC X.
   728         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   729         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   730                                                   LOW-VALUES.
   731
   732     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   733     12  PI-CLAIM-PW-SESSION             PIC X(1).
   734         88  PI-CLAIM-CREDIT                 VALUE '1'.
   735         88  PI-CLAIM-CONVEN                 VALUE '2'.
   736     12  FILLER                          PIC X(4).
   737
   738     12  PI-SYSTEM-LEVEL                 PIC X(145).
   739
   740     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   741         PI-SYSTEM-LEVEL.
   742
   743         16  PI-ENTRY-CODES.
   744             20  PI-ENTRY-CD-1           PIC X.
   745             20  PI-ENTRY-CD-2           PIC X.
   746
   747         16  PI-RETURN-CODES.
   748             20  PI-RETURN-CD-1          PIC X.
   749             20  PI-RETURN-CD-2          PIC X.
   750
   751         16  PI-UPDATE-STATUS-SAVE.
   752             20  PI-UPDATE-BY            PIC X(4).
   753             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   754
   755         16  PI-LOWER-CASE-LETTERS       PIC X.
   756             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   757
   758*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   759*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   760*            88  CARRIER-CLM-CNTL            VALUE '2'.
   761
   762         16  PI-CERT-ACCESS-CONTROL      PIC X.
   763             88  ST-ACCNT-CNTL               VALUE ' '.
   764             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   765             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   766             88  ACCNT-CNTL                  VALUE '3'.
   767             88  CARR-ACCNT-CNTL             VALUE '4'.
   768
   769         16  PI-PROCESSOR-CAP-LIST.
   770             20  PI-SYSTEM-CONTROLS.
   771                24 PI-SYSTEM-DISPLAY     PIC X.
   772                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   773                24 PI-SYSTEM-MODIFY      PIC X.
   774                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   775             20  FILLER                  PIC XX.
   776             20  PI-DISPLAY-CAP          PIC X.
   777                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6041.cbl
   778             20  PI-MODIFY-CAP           PIC X.
   779                 88  MODIFY-CAP              VALUE 'Y'.
   780             20  PI-MSG-AT-LOGON-CAP     PIC X.
   781                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   782             20  PI-FORCE-CAP            PIC X.
   783                 88  FORCE-CAP               VALUE 'Y'.
   784
   785         16  PI-PROGRAM-CONTROLS.
   786             20  PI-PGM-PRINT-OPT        PIC X.
   787             20  PI-PGM-FORMAT-OPT       PIC X.
   788             20  PI-PGM-PROCESS-OPT      PIC X.
   789             20  PI-PGM-TOTALS-OPT       PIC X.
   790
   791         16  PI-HELP-INTERFACE.
   792             20  PI-LAST-ERROR-NO        PIC X(4).
   793             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   794
   795         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   796             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   797
   798         16  PI-CR-CONTROL-IN-PROGRESS.
   799             20  PI-CR-CARRIER           PIC X.
   800             20  PI-CR-GROUPING          PIC X(6).
   801             20  PI-CR-STATE             PIC XX.
   802             20  PI-CR-ACCOUNT           PIC X(10).
   803             20  PI-CR-FIN-RESP          PIC X(10).
   804             20  PI-CR-TYPE              PIC X.
   805
   806         16  PI-CR-BATCH-NUMBER          PIC X(6).
   807
   808         16  PI-CR-MONTH-END-DT          PIC XX.
   809
   810         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   811             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   812             88  PI-ZERO-CARRIER             VALUE '1'.
   813             88  PI-ZERO-GROUPING            VALUE '2'.
   814             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   815
   816         16  PI-CARRIER-SECURITY         PIC X.
   817             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   818
   819         16  PI-ACCOUNT-SECURITY         PIC X(10).
   820             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   821             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   822
   823         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   824             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   825                                         INDEXED BY PI-ACCESS-NDX
   826                                         PIC X.
   827
   828         16  PI-GA-BILLING-CONTROL       PIC X.
   829             88  PI-GA-BILLING               VALUE '1'.
   830
   831         16  PI-MAIL-PROCESSING          PIC X.
   832             88  PI-MAIL-YES                 VALUE 'Y'.
   833
   834         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   835
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6041.cbl
   836         16  PI-AR-SYSTEM.
   837             20  PI-AR-PROCESSING-CNTL   PIC X.
   838                 88  PI-AR-PROCESSING        VALUE 'Y'.
   839             20  PI-AR-SUMMARY-CODE      PIC X(6).
   840             20  PI-AR-MONTH-END-DT      PIC XX.
   841
   842         16  PI-MP-SYSTEM.
   843             20  PI-MORTGAGE-USER            PIC X.
   844                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   845                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   846             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   847                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   848                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   849                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   850                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   851                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   852             20  PI-MP-MONTH-END-DT          PIC XX.
   853             20  PI-MP-REFERENCE-NO.
   854                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   855                 24  PI-MP-REFERENCE-SFX     PIC XX.
   856
   857         16  PI-LABEL-CONTROL            PIC X(01).
   858             88  PI-CREATE-LABELS                    VALUE 'Y'.
   859             88  PI-BYPASS-LABELS                    VALUE 'N'.
   860
   861         16  PI-BILL-GROUPING-CODE       PIC X(01).
   862             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   863
   864         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   865             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   866             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   867
   868         16  FILLER                      PIC X(14).
   869
   870     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   871******************************************************************
   872
   873     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
   874         16  PI-LAST-REPORT        PIC 9(3).
   875         16  FILLER                PIC X(637).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6041.cbl
   877*                            COPY ELCJPFX.
   878******************************************************************
   879*                                                                *
   880*                                                                *
   881*                            ELCJPFX.                            *
   882*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   883*                            VMOD=2.002                          *
   884*                                                                *
   885*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   886*                                                                *
   887*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   888*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   889*        ELCNTL - CONTROL FILE                                   *
   890*        ELMSTR - CLAIM MASTERS                                  *
   891*        ELTRLR - ACTIVITY TRAILERS                              *
   892*        ELCHKQ - CHECK QUE                                      *
   893******************************************************************
   894 01  JOURNAL-RECORD.
   895     12  JP-USER-ID                  PIC X(4).
   896     12  JP-FILE-ID                  PIC X(8).
   897     12  JP-PROGRAM-ID               PIC X(8).
   898     12  JP-RECORD-TYPE              PIC X.
   899         88 JP-ADD              VALUE 'A'.
   900         88 JP-BEFORE-CHANGE    VALUE 'B'.
   901         88 JP-AFTER-CHANGE     VALUE 'C'.
   902         88 JP-DELETE           VALUE 'D'.
   903         88 JP-GENERIC-DELETE   VALUE 'G'.
   904         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   905         88 JP-KEY-CHG-ADD      VALUE 'N'.
   906     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   907     12  JP-RECORD-AREA
   908
   909
   910                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6041.cbl
   912*                            COPY ELCAID.
   913******************************************************************
   914*                                                                *
   915*                            ELCAID.                             *
   916*                            VMOD=2.001                          *
   917*                                                                *
   918*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   919*                                                                *
   920*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   921*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   922******************************************************************
   923
   924 01  DFHAID.
   925   02  DFHNULL   PIC  X  VALUE  ' '.
   926   02  DFHENTER  PIC  X  VALUE  QUOTE.
   927   02  DFHCLEAR  PIC  X  VALUE  '_'.
   928   02  DFHPEN    PIC  X  VALUE  '='.
   929   02  DFHOPID   PIC  X  VALUE  'W'.
   930   02  DFHPA1    PIC  X  VALUE  '%'.
   931   02  DFHPA2    PIC  X  VALUE  '>'.
   932   02  DFHPA3    PIC  X  VALUE  ','.
   933   02  DFHPF1    PIC  X  VALUE  '1'.
   934   02  DFHPF2    PIC  X  VALUE  '2'.
   935   02  DFHPF3    PIC  X  VALUE  '3'.
   936   02  DFHPF4    PIC  X  VALUE  '4'.
   937   02  DFHPF5    PIC  X  VALUE  '5'.
   938   02  DFHPF6    PIC  X  VALUE  '6'.
   939   02  DFHPF7    PIC  X  VALUE  '7'.
   940   02  DFHPF8    PIC  X  VALUE  '8'.
   941   02  DFHPF9    PIC  X  VALUE  '9'.
   942   02  DFHPF10   PIC  X  VALUE  ':'.
   943   02  DFHPF11   PIC  X  VALUE  '#'.
   944   02  DFHPF12   PIC  X  VALUE  '@'.
   945   02  DFHPF13   PIC  X  VALUE  'A'.
   946   02  DFHPF14   PIC  X  VALUE  'B'.
   947   02  DFHPF15   PIC  X  VALUE  'C'.
   948   02  DFHPF16   PIC  X  VALUE  'D'.
   949   02  DFHPF17   PIC  X  VALUE  'E'.
   950   02  DFHPF18   PIC  X  VALUE  'F'.
   951   02  DFHPF19   PIC  X  VALUE  'G'.
   952   02  DFHPF20   PIC  X  VALUE  'H'.
   953   02  DFHPF21   PIC  X  VALUE  'I'.
   954*00039    02  DFHPF22   PIC  X  VALUE  ''.
   955   02  DFHPF22   PIC  X  VALUE  '['.
   956   02  DFHPF23   PIC  X  VALUE  '.'.
   957   02  DFHPF24   PIC  X  VALUE  '<'.
   958   02  DFHMSRE   PIC  X  VALUE  'X'.
   959   02  DFHSTRF   PIC  X  VALUE  'h'.
   960   02  DFHTRIG   PIC  X  VALUE  '"'.
   961
   962 01  FILLER    REDEFINES DFHAID.
   963     12  FILLER              PIC X(8).
   964     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
   965
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6041.cbl
   967*                                COPY EL6041S.
   968 01  EL6041AI.
   969     05  FILLER            PIC  X(0012).
   970*    -------------------------------
   971     05  RUNDTEL PIC S9(0004) COMP.
   972     05  RUNDTEF PIC  X(0001).
   973     05  FILLER REDEFINES RUNDTEF.
   974         10  RUNDTEA PIC  X(0001).
   975     05  RUNDTEI PIC  X(0008).
   976*    -------------------------------
   977     05  RUNTIMEL PIC S9(0004) COMP.
   978     05  RUNTIMEF PIC  X(0001).
   979     05  FILLER REDEFINES RUNTIMEF.
   980         10  RUNTIMEA PIC  X(0001).
   981     05  RUNTIMEI PIC  X(0005).
   982*    -------------------------------
   983     05  MAINTL PIC S9(0004) COMP.
   984     05  MAINTF PIC  X(0001).
   985     05  FILLER REDEFINES MAINTF.
   986         10  MAINTA PIC  X(0001).
   987     05  MAINTI PIC  X(0001).
   988*    -------------------------------
   989     05  REPORTL PIC S9(0004) COMP.
   990     05  REPORTF PIC  X(0001).
   991     05  FILLER REDEFINES REPORTF.
   992         10  REPORTA PIC  X(0001).
   993     05  REPORTI PIC  X(0003).
   994*    -------------------------------
   995     05  CPYRPTL PIC S9(0004) COMP.
   996     05  CPYRPTF PIC  X(0001).
   997     05  FILLER REDEFINES CPYRPTF.
   998         10  CPYRPTA PIC  X(0001).
   999     05  CPYRPTI PIC  X(0003).
  1000*    -------------------------------
  1001     05  LTONEYL PIC S9(0004) COMP.
  1002     05  LTONEYF PIC  X(0001).
  1003     05  FILLER REDEFINES LTONEYF.
  1004         10  LTONEYA PIC  X(0001).
  1005     05  LTONEYI PIC  X(0001).
  1006*    -------------------------------
  1007     05  ZERMPDL PIC S9(0004) COMP.
  1008     05  ZERMPDF PIC  X(0001).
  1009     05  FILLER REDEFINES ZERMPDF.
  1010         10  ZERMPDA PIC  X(0001).
  1011     05  ZERMPDI PIC  X(0001).
  1012*    -------------------------------
  1013     05  ISSCNTL PIC S9(0004) COMP.
  1014     05  ISSCNTF PIC  X(0001).
  1015     05  FILLER REDEFINES ISSCNTF.
  1016         10  ISSCNTA PIC  X(0001).
  1017     05  ISSCNTI PIC  99999.
  1018*    -------------------------------
  1019     05  SMPRMPL PIC S9(0004) COMP.
  1020     05  SMPRMPF PIC  X(0001).
  1021     05  FILLER REDEFINES SMPRMPF.
  1022         10  SMPRMPA PIC  X(0001).
  1023     05  SMPRMPI PIC  99.
  1024*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6041.cbl
  1025     05  EPRMDCL PIC S9(0004) COMP.
  1026     05  EPRMDCF PIC  X(0001).
  1027     05  FILLER REDEFINES EPRMDCF.
  1028         10  EPRMDCA PIC  X(0001).
  1029     05  EPRMDCI PIC  99.
  1030*    -------------------------------
  1031     05  CNCRATL PIC S9(0004) COMP.
  1032     05  CNCRATF PIC  X(0001).
  1033     05  FILLER REDEFINES CNCRATF.
  1034         10  CNCRATA PIC  X(0001).
  1035     05  CNCRATI PIC  99.
  1036*    -------------------------------
  1037     05  RETLIML PIC S9(0004) COMP.
  1038     05  RETLIMF PIC  X(0001).
  1039     05  FILLER REDEFINES RETLIMF.
  1040         10  RETLIMA PIC  X(0001).
  1041     05  RETLIMI PIC  9999999.
  1042*    -------------------------------
  1043     05  LBENTPL PIC S9(0004) COMP.
  1044     05  LBENTPF PIC  X(0001).
  1045     05  FILLER REDEFINES LBENTPF.
  1046         10  LBENTPA PIC  X(0001).
  1047     05  LBENTPI PIC  X(0006).
  1048*    -------------------------------
  1049     05  ABENTPL PIC S9(0004) COMP.
  1050     05  ABENTPF PIC  X(0001).
  1051     05  FILLER REDEFINES ABENTPF.
  1052         10  ABENTPA PIC  X(0001).
  1053     05  ABENTPI PIC  X(0006).
  1054*    -------------------------------
  1055     05  LLSRATL PIC S9(0004) COMP.
  1056     05  LLSRATF PIC  X(0001).
  1057     05  FILLER REDEFINES LLSRATF.
  1058         10  LLSRATA PIC  X(0001).
  1059     05  LLSRATI PIC  999.
  1060*    -------------------------------
  1061     05  LLTLRSL PIC S9(0004) COMP.
  1062     05  LLTLRSF PIC  X(0001).
  1063     05  FILLER REDEFINES LLTLRSF.
  1064         10  LLTLRSA PIC  X(0001).
  1065     05  LLTLRSI PIC  999.
  1066*    -------------------------------
  1067     05  ALSRATL PIC S9(0004) COMP.
  1068     05  ALSRATF PIC  X(0001).
  1069     05  FILLER REDEFINES ALSRATF.
  1070         10  ALSRATA PIC  X(0001).
  1071     05  ALSRATI PIC  999.
  1072*    -------------------------------
  1073     05  ALTLRSL PIC S9(0004) COMP.
  1074     05  ALTLRSF PIC  X(0001).
  1075     05  FILLER REDEFINES ALTLRSF.
  1076         10  ALTLRSA PIC  X(0001).
  1077     05  ALTLRSI PIC  999.
  1078*    -------------------------------
  1079     05  LPDPROL PIC S9(0004) COMP.
  1080     05  LPDPROF PIC  X(0001).
  1081     05  FILLER REDEFINES LPDPROF.
  1082         10  LPDPROA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6041.cbl
  1083     05  LPDPROI PIC  999.
  1084*    -------------------------------
  1085     05  LLTPRPL PIC S9(0004) COMP.
  1086     05  LLTPRPF PIC  X(0001).
  1087     05  FILLER REDEFINES LLTPRPF.
  1088         10  LLTPRPA PIC  X(0001).
  1089     05  LLTPRPI PIC  S9(3)V9(1).
  1090*    -------------------------------
  1091     05  APDPROL PIC S9(0004) COMP.
  1092     05  APDPROF PIC  X(0001).
  1093     05  FILLER REDEFINES APDPROF.
  1094         10  APDPROA PIC  X(0001).
  1095     05  APDPROI PIC  999.
  1096*    -------------------------------
  1097     05  ALTPRPL PIC S9(0004) COMP.
  1098     05  ALTPRPF PIC  X(0001).
  1099     05  FILLER REDEFINES ALTPRPF.
  1100         10  ALTPRPA PIC  X(0001).
  1101     05  ALTPRPI PIC  S9(3)V9(1).
  1102*    -------------------------------
  1103     05  LLTIDCL PIC S9(0004) COMP.
  1104     05  LLTIDCF PIC  X(0001).
  1105     05  FILLER REDEFINES LLTIDCF.
  1106         10  LLTIDCA PIC  X(0001).
  1107     05  LLTIDCI PIC  S9(3)V9(1).
  1108*    -------------------------------
  1109     05  ALTIDCL PIC S9(0004) COMP.
  1110     05  ALTIDCF PIC  X(0001).
  1111     05  FILLER REDEFINES ALTIDCF.
  1112         10  ALTIDCA PIC  X(0001).
  1113     05  ALTIDCI PIC  S9(3)V9(1).
  1114*    -------------------------------
  1115     05  LLTTRML PIC S9(0004) COMP.
  1116     05  LLTTRMF PIC  X(0001).
  1117     05  FILLER REDEFINES LLTTRMF.
  1118         10  LLTTRMA PIC  X(0001).
  1119     05  LLTTRMI PIC  S9(3)V9(1).
  1120*    -------------------------------
  1121     05  ALTTRML PIC S9(0004) COMP.
  1122     05  ALTTRMF PIC  X(0001).
  1123     05  FILLER REDEFINES ALTTRMF.
  1124         10  ALTTRMA PIC  X(0001).
  1125     05  ALTTRMI PIC  S9(3)V9(1).
  1126*    -------------------------------
  1127     05  LTRMAVL PIC S9(0004) COMP.
  1128     05  LTRMAVF PIC  X(0001).
  1129     05  FILLER REDEFINES LTRMAVF.
  1130         10  LTRMAVA PIC  X(0001).
  1131     05  LTRMAVI PIC  S9(3)V9(1).
  1132*    -------------------------------
  1133     05  ATRMAVL PIC S9(0004) COMP.
  1134     05  ATRMAVF PIC  X(0001).
  1135     05  FILLER REDEFINES ATRMAVF.
  1136         10  ATRMAVA PIC  X(0001).
  1137     05  ATRMAVI PIC  S9(3)V9(1).
  1138*    -------------------------------
  1139     05  LLTAGPL PIC S9(0004) COMP.
  1140     05  LLTAGPF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6041.cbl
  1141     05  FILLER REDEFINES LLTAGPF.
  1142         10  LLTAGPA PIC  X(0001).
  1143     05  LLTAGPI PIC  S9(3)V9(1).
  1144*    -------------------------------
  1145     05  ALTAGPL PIC S9(0004) COMP.
  1146     05  ALTAGPF PIC  X(0001).
  1147     05  FILLER REDEFINES ALTAGPF.
  1148         10  ALTAGPA PIC  X(0001).
  1149     05  ALTAGPI PIC  S9(3)V9(1).
  1150*    -------------------------------
  1151     05  LAVAGWL PIC S9(0004) COMP.
  1152     05  LAVAGWF PIC  X(0001).
  1153     05  FILLER REDEFINES LAVAGWF.
  1154         10  LAVAGWA PIC  X(0001).
  1155     05  LAVAGWI PIC  S9(3)V9(1).
  1156*    -------------------------------
  1157     05  AAVAGWL PIC S9(0004) COMP.
  1158     05  AAVAGWF PIC  X(0001).
  1159     05  FILLER REDEFINES AAVAGWF.
  1160         10  AAVAGWA PIC  X(0001).
  1161     05  AAVAGWI PIC  S9(3)V9(1).
  1162*    -------------------------------
  1163     05  LAVAGML PIC S9(0004) COMP.
  1164     05  LAVAGMF PIC  X(0001).
  1165     05  FILLER REDEFINES LAVAGMF.
  1166         10  LAVAGMA PIC  X(0001).
  1167     05  LAVAGMI PIC  99.
  1168*    -------------------------------
  1169     05  AAVAGML PIC S9(0004) COMP.
  1170     05  AAVAGMF PIC  X(0001).
  1171     05  FILLER REDEFINES AAVAGMF.
  1172         10  AAVAGMA PIC  X(0001).
  1173     05  AAVAGMI PIC  99.
  1174*    -------------------------------
  1175     05  ERRMSG1L PIC S9(0004) COMP.
  1176     05  ERRMSG1F PIC  X(0001).
  1177     05  FILLER REDEFINES ERRMSG1F.
  1178         10  ERRMSG1A PIC  X(0001).
  1179     05  ERRMSG1I PIC  X(0079).
  1180*    -------------------------------
  1181     05  PFKEYL PIC S9(0004) COMP.
  1182     05  PFKEYF PIC  X(0001).
  1183     05  FILLER REDEFINES PFKEYF.
  1184         10  PFKEYA PIC  X(0001).
  1185     05  PFKEYI PIC  99.
  1186 01  EL6041AO REDEFINES EL6041AI.
  1187     05  FILLER            PIC  X(0012).
  1188*    -------------------------------
  1189     05  FILLER            PIC  X(0003).
  1190     05  RUNDTEO PIC  X(0008).
  1191*    -------------------------------
  1192     05  FILLER            PIC  X(0003).
  1193     05  RUNTIMEO PIC  99.99.
  1194*    -------------------------------
  1195     05  FILLER            PIC  X(0003).
  1196     05  MAINTO PIC  X(0001).
  1197*    -------------------------------
  1198     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6041.cbl
  1199     05  REPORTO PIC  X(0003).
  1200*    -------------------------------
  1201     05  FILLER            PIC  X(0003).
  1202     05  CPYRPTO PIC  X(0003).
  1203*    -------------------------------
  1204     05  FILLER            PIC  X(0003).
  1205     05  LTONEYO PIC  X(0001).
  1206*    -------------------------------
  1207     05  FILLER            PIC  X(0003).
  1208     05  ZERMPDO PIC  X(0001).
  1209*    -------------------------------
  1210     05  FILLER            PIC  X(0003).
  1211     05  ISSCNTO PIC  ZZZZ9.
  1212*    -------------------------------
  1213     05  FILLER            PIC  X(0003).
  1214     05  SMPRMPO PIC  X(0002).
  1215*    -------------------------------
  1216     05  FILLER            PIC  X(0003).
  1217     05  EPRMDCO PIC  X(0002).
  1218*    -------------------------------
  1219     05  FILLER            PIC  X(0003).
  1220     05  CNCRATO PIC  X(0002).
  1221*    -------------------------------
  1222     05  FILLER            PIC  X(0003).
  1223     05  RETLIMO PIC  ZZZZZZ9.
  1224*    -------------------------------
  1225     05  FILLER            PIC  X(0003).
  1226     05  LBENTPO PIC  X(0006).
  1227*    -------------------------------
  1228     05  FILLER            PIC  X(0003).
  1229     05  ABENTPO PIC  X(0006).
  1230*    -------------------------------
  1231     05  FILLER            PIC  X(0003).
  1232     05  LLSRATO PIC  X(0003).
  1233*    -------------------------------
  1234     05  FILLER            PIC  X(0003).
  1235     05  LLTLRSO PIC  X(0003).
  1236*    -------------------------------
  1237     05  FILLER            PIC  X(0003).
  1238     05  ALSRATO PIC  X(0003).
  1239*    -------------------------------
  1240     05  FILLER            PIC  X(0003).
  1241     05  ALTLRSO PIC  X(0003).
  1242*    -------------------------------
  1243     05  FILLER            PIC  X(0003).
  1244     05  LPDPROO PIC  X(0003).
  1245*    -------------------------------
  1246     05  FILLER            PIC  X(0003).
  1247     05  LLTPRPO PIC  99.9.
  1248*    -------------------------------
  1249     05  FILLER            PIC  X(0003).
  1250     05  APDPROO PIC  X(0003).
  1251*    -------------------------------
  1252     05  FILLER            PIC  X(0003).
  1253     05  ALTPRPO PIC  99.9.
  1254*    -------------------------------
  1255     05  FILLER            PIC  X(0003).
  1256     05  LLTIDCO PIC  99.9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6041.cbl
  1257*    -------------------------------
  1258     05  FILLER            PIC  X(0003).
  1259     05  ALTIDCO PIC  99.9.
  1260*    -------------------------------
  1261     05  FILLER            PIC  X(0003).
  1262     05  LLTTRMO PIC  99.9.
  1263*    -------------------------------
  1264     05  FILLER            PIC  X(0003).
  1265     05  ALTTRMO PIC  99.9.
  1266*    -------------------------------
  1267     05  FILLER            PIC  X(0003).
  1268     05  LTRMAVO PIC  99.9.
  1269*    -------------------------------
  1270     05  FILLER            PIC  X(0003).
  1271     05  ATRMAVO PIC  99.9.
  1272*    -------------------------------
  1273     05  FILLER            PIC  X(0003).
  1274     05  LLTAGPO PIC  99.9.
  1275*    -------------------------------
  1276     05  FILLER            PIC  X(0003).
  1277     05  ALTAGPO PIC  99.9.
  1278*    -------------------------------
  1279     05  FILLER            PIC  X(0003).
  1280     05  LAVAGWO PIC  99.9.
  1281*    -------------------------------
  1282     05  FILLER            PIC  X(0003).
  1283     05  AAVAGWO PIC  99.9.
  1284*    -------------------------------
  1285     05  FILLER            PIC  X(0003).
  1286     05  LAVAGMO PIC  X(0002).
  1287*    -------------------------------
  1288     05  FILLER            PIC  X(0003).
  1289     05  AAVAGMO PIC  X(0002).
  1290*    -------------------------------
  1291     05  FILLER            PIC  X(0003).
  1292     05  ERRMSG1O PIC  X(0079).
  1293*    -------------------------------
  1294     05  FILLER            PIC  X(0003).
  1295     05  PFKEYO PIC  ZZ.
  1296*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6041.cbl
  1298
  1299****************************************************************
  1300*
  1301* Copyright (c) 2007 by Clerity Solutions, Inc.
  1302* All rights reserved.
  1303*
  1304****************************************************************
  1305 01  DFHEIV.
  1306   02  DFHEIV0               PIC X(35).
  1307   02  DFHEIV1               PIC X(08).
  1308   02  DFHEIV2               PIC X(08).
  1309   02  DFHEIV3               PIC X(08).
  1310   02  DFHEIV4               PIC X(06).
  1311   02  DFHEIV5               PIC X(04).
  1312   02  DFHEIV6               PIC X(04).
  1313   02  DFHEIV7               PIC X(02).
  1314   02  DFHEIV8               PIC X(02).
  1315   02  DFHEIV9               PIC X(01).
  1316   02  DFHEIV10              PIC S9(7) COMP-3.
  1317   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1318   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1319   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1320   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1321   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1322   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1323   02  DFHEIV17              PIC X(04).
  1324   02  DFHEIV18              PIC X(04).
  1325   02  DFHEIV19              PIC X(04).
  1326   02  DFHEIV20              USAGE IS POINTER.
  1327   02  DFHEIV21              USAGE IS POINTER.
  1328   02  DFHEIV22              USAGE IS POINTER.
  1329   02  DFHEIV23              USAGE IS POINTER.
  1330   02  DFHEIV24              USAGE IS POINTER.
  1331   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1332   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1333   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1334   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1335   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1336   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1337   02  FILLER                PIC X(02).
  1338   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1339   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1340   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1341   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1342   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1343 LINKAGE  SECTION.
  1344*****************************************************************
  1345*                                                               *
  1346* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1347* All rights reserved.                                          *
  1348*                                                               *
  1349*****************************************************************
  1350 01  dfheiblk.
  1351     02  eibtime          pic s9(7) comp-3.
  1352     02  eibdate          pic s9(7) comp-3.
  1353     02  eibtrnid         pic x(4).
  1354     02  eibtaskn         pic s9(7) comp-3.
  1355     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6041.cbl
  1356     02  dfheigdi         pic s9(4) comp.
  1357     02  eibcposn         pic s9(4) comp.
  1358     02  eibcalen         pic s9(4) comp.
  1359     02  eibaid           pic x(1).
  1360     02  eibfiller1       pic x(1).
  1361     02  eibfn            pic x(2).
  1362     02  eibfiller2       pic x(2).
  1363     02  eibrcode         pic x(6).
  1364     02  eibfiller3       pic x(2).
  1365     02  eibds            pic x(8).
  1366     02  eibreqid         pic x(8).
  1367     02  eibrsrce         pic x(8).
  1368     02  eibsync          pic x(1).
  1369     02  eibfree          pic x(1).
  1370     02  eibrecv          pic x(1).
  1371     02  eibsend          pic x(1).
  1372     02  eibatt           pic x(1).
  1373     02  eibeoc           pic x(1).
  1374     02  eibfmh           pic x(1).
  1375     02  eibcompl         pic x(1).
  1376     02  eibsig           pic x(1).
  1377     02  eibconf          pic x(1).
  1378     02  eiberr           pic x(1).
  1379     02  eibrldbk         pic x(1).
  1380     02  eiberrcd         pic x(4).
  1381     02  eibsynrb         pic x(1).
  1382     02  eibnodat         pic x(1).
  1383     02  eibfiller5       pic x(2).
  1384     02  eibresp          pic 9(09) comp.
  1385     02  eibresp2         pic 9(09) comp.
  1386     02  dfheigdj         pic s9(4) comp.
  1387     02  dfheigdk         pic s9(4) comp.
  1388 01  DFHCOMMAREA             PIC X(1024).
  1389
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6041.cbl
  1391
  1392*01 PARMLIST .
  1393*    12  FILLER                      PIC S9(8)   COMP.
  1394*    12  ELCNTL-POINTER              PIC S9(8)   COMP.
  1395
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6041.cbl
  1397
  1398*                            COPY ELCCNTL.
  1399******************************************************************
  1400*                                                                *
  1401*                                                                *
  1402*                            ELCCNTL.                            *
  1403*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1404*                            VMOD=2.059                          *
  1405*                                                                *
  1406*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1407*                                                                *
  1408*   FILE TYPE = VSAM,KSDS                                        *
  1409*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1410*                                                                *
  1411*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1412*       ALTERNATE INDEX = NONE                                   *
  1413*                                                                *
  1414*   LOG = YES                                                    *
  1415*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1416******************************************************************
  1417*                   C H A N G E   L O G
  1418*
  1419* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1420*-----------------------------------------------------------------
  1421*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1422* EFFECTIVE    NUMBER
  1423*-----------------------------------------------------------------
  1424* 082503                   PEMA  ADD BENEFIT GROUP
  1425* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1426* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1427* 092705    2005050300006  PEMA  ADD SPP LEASES
  1428* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1429* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1430* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1431* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1432******************************************************************
  1433*
  1434 01  CONTROL-FILE.
  1435     12  CF-RECORD-ID                       PIC XX.
  1436         88  VALID-CF-ID                        VALUE 'CF'.
  1437
  1438     12  CF-CONTROL-PRIMARY.
  1439         16  CF-COMPANY-ID                  PIC XXX.
  1440         16  CF-RECORD-TYPE                 PIC X.
  1441             88  CF-COMPANY-MASTER              VALUE '1'.
  1442             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1443             88  CF-STATE-MASTER                VALUE '3'.
  1444             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1445             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1446             88  CF-CARRIER-MASTER              VALUE '6'.
  1447             88  CF-MORTALITY-MASTER            VALUE '7'.
  1448             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1449             88  CF-TERMINAL-MASTER             VALUE '9'.
  1450             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1451             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1452             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1453             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1454             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6041.cbl
  1455             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1456             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1457             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1458             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1459         16  CF-ACCESS-CD-GENL              PIC X(4).
  1460         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1461             20  CF-PROCESSOR               PIC X(4).
  1462         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1463             20  CF-STATE-CODE              PIC XX.
  1464             20  FILLER                     PIC XX.
  1465         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1466             20  FILLER                     PIC XX.
  1467             20  CF-HI-BEN-IN-REC           PIC XX.
  1468         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1469             20  FILLER                     PIC XXX.
  1470             20  CF-CARRIER-CNTL            PIC X.
  1471         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1472             20  FILLER                     PIC XX.
  1473             20  CF-HI-TYPE-IN-REC          PIC 99.
  1474         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1475             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1476                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1477             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1478             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1479         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1480             20  FILLER                     PIC X.
  1481             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1482         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1483             20  FILLER                     PIC XX.
  1484             20  CF-MORTGAGE-PLAN           PIC XX.
  1485         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1486
  1487     12  CF-LAST-MAINT-DT                   PIC XX.
  1488     12  CF-LAST-MAINT-BY                   PIC X(4).
  1489     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1490
  1491     12  CF-RECORD-BODY                     PIC X(728).
  1492
  1493
  1494****************************************************************
  1495*             COMPANY MASTER RECORD                            *
  1496****************************************************************
  1497
  1498     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1499         16  CF-COMPANY-ADDRESS.
  1500             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1501             20  CF-CL-IN-CARE-OF           PIC X(30).
  1502             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1503             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1504             20  CF-CL-CITY-STATE           PIC X(30).
  1505             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1506             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1507         16  CF-COMPANY-CD                  PIC X.
  1508         16  CF-COMPANY-PASSWORD            PIC X(8).
  1509         16  CF-SECURITY-OPTION             PIC X.
  1510             88  ALL-SECURITY                   VALUE '1'.
  1511             88  COMPANY-VERIFY                 VALUE '2'.
  1512             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6041.cbl
  1513             88  NO-SECURITY                    VALUE '4'.
  1514             88  ALL-BUT-TERM                   VALUE '5'.
  1515         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1516             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1517         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1518             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1519         16  CF-INFORCE-LOCATION            PIC X.
  1520             88  CERTS-ARE-ONLINE               VALUE '1'.
  1521             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1522             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1523         16  CF-LOWER-CASE-LETTERS          PIC X.
  1524         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1525             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1526             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1527             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1528             88  CF-ACCNT-CNTL                  VALUE '3'.
  1529             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1530
  1531         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1532         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1533
  1534         16  CF-LGX-CREDIT-USER             PIC X.
  1535             88  CO-IS-NOT-USER                 VALUE 'N'.
  1536             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1537
  1538         16 CF-CREDIT-CALC-CODES.
  1539             20  CF-CR-REM-TERM-CALC PIC X.
  1540               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1541               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1542               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1543               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1544               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1545               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1546               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1547             20  CF-CR-R78-METHOD           PIC X.
  1548               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1549               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1550
  1551         16  CF-CLAIM-CONTROL-COUNTS.
  1552             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1553                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1554
  1555             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1556                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1557
  1558             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1559                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1560
  1561             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1562                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1563
  1564         16  CF-CURRENT-MONTH-END           PIC XX.
  1565
  1566         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1567             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1568             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1569             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1570             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6041.cbl
  1571                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1572                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1573             20  CF-CO-PREM-REJECT-SW       PIC X.
  1574                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1575                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1576             20  CF-CO-REF-REJECT-SW        PIC X.
  1577                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1578                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1579
  1580         16  CF-CO-REPORTING-DT             PIC XX.
  1581         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1582         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1583           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1584           88  CF-CO-MONTH-END                  VALUE '1'.
  1585
  1586         16  CF-LGX-CLAIM-USER              PIC X.
  1587             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1588             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1589
  1590         16  CF-CREDIT-EDIT-CONTROLS.
  1591             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1592             20  CF-MIN-AGE                 PIC 99.
  1593             20  CF-DEFAULT-AGE             PIC 99.
  1594             20  CF-MIN-TERM                PIC S999      COMP-3.
  1595             20  CF-MAX-TERM                PIC S999      COMP-3.
  1596             20  CF-DEFAULT-SEX             PIC X.
  1597             20  CF-JOINT-AGE-INPUT         PIC X.
  1598                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1599             20  CF-BIRTH-DATE-INPUT        PIC X.
  1600                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1601             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1602                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1603                 88  CF-ZERO-CARRIER            VALUE '1'.
  1604                 88  CF-ZERO-GROUPING           VALUE '2'.
  1605                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1606             20  CF-EDIT-SW                 PIC X.
  1607                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1608             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1609             20  CF-CR-PR-METHOD            PIC X.
  1610               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1611               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1612             20  FILLER                     PIC X.
  1613
  1614         16  CF-CREDIT-MISC-CONTROLS.
  1615             20  CF-REIN-TABLE-SW           PIC X.
  1616                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1617             20  CF-COMP-TABLE-SW           PIC X.
  1618                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1619             20  CF-EXPERIENCE-RETENTION-AGE
  1620                                            PIC S9        COMP-3.
  1621             20  CF-CONVERSION-DT           PIC XX.
  1622             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1623             20  CF-RUN-FREQUENCY-SW        PIC X.
  1624                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1625                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1626
  1627             20  CF-CR-CHECK-NO-CONTROL.
  1628                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6041.cbl
  1629                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1630                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1631                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1632                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1633                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1634
  1635                 24  CF-CR-CHECK-COUNT       REDEFINES
  1636                     CF-CR-CHECK-COUNTER      PIC X(4).
  1637
  1638                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1639                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1640
  1641                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1642                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1643                 24  CF-MAIL-PROCESSING       PIC X.
  1644                     88  MAIL-PROCESSING          VALUE 'Y'.
  1645
  1646         16  CF-MISC-SYSTEM-CONTROL.
  1647             20  CF-SYSTEM-C                 PIC X.
  1648                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1649             20  CF-SYSTEM-D                 PIC X.
  1650                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1651             20  CF-SOC-SEC-NO-SW            PIC X.
  1652                 88  SOC-SEC-NO-USED             VALUE '1'.
  1653             20  CF-MEMBER-NO-SW             PIC X.
  1654                 88  MEMBER-NO-USED              VALUE '1'.
  1655             20  CF-TAX-ID-NUMBER            PIC X(11).
  1656             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1657             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1658                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1659                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1660                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1661                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1662             20  CF-SYSTEM-E                 PIC X.
  1663                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1664
  1665         16  CF-LGX-LIFE-USER               PIC X.
  1666             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1667             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1668
  1669         16  CF-CR-MONTH-END-DT             PIC XX.
  1670
  1671         16  CF-FILE-MAINT-DATES.
  1672             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1673                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1674             20  CF-LAST-BATCH       REDEFINES
  1675                 CF-LAST-BATCH-NO               PIC X(4).
  1676             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1677             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1678             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1679             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1680             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1681             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1682             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1683             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1684             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1685             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1686
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6041.cbl
  1687         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1688         16  FILLER                         PIC X.
  1689
  1690         16  CF-ALT-MORT-CODE               PIC X(4).
  1691         16  CF-MEMBER-CAPTION              PIC X(10).
  1692
  1693         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1694             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1695             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1696             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1697             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1698             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1699
  1700         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1701
  1702         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1703         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1704         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1705         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1706
  1707         16  CF-AH-OVERRIDE-L1              PIC X.
  1708         16  CF-AH-OVERRIDE-L2              PIC XX.
  1709         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1710         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1711
  1712         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1713         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1714
  1715         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1716         16  CF-AR-LAST-EL860-DT            PIC XX.
  1717         16  CF-MP-MONTH-END-DT             PIC XX.
  1718
  1719         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1720         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1721             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1722
  1723         16  CF-AR-MONTH-END-DT             PIC XX.
  1724
  1725         16  CF-CRDTCRD-USER                PIC X.
  1726             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1727             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1728
  1729         16  CF-CC-MONTH-END-DT             PIC XX.
  1730
  1731         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1732
  1733         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1734             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1735             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1736             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1737         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1738         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1739         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1740         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1741             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1742             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1743         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1744         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6041.cbl
  1745         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1746             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1747         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1748
  1749         16  CF-CL-ZIP-CODE.
  1750             20  CF-CL-ZIP-PRIME.
  1751                 24  CF-CL-ZIP-1ST          PIC X.
  1752                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1753                 24  FILLER                 PIC X(4).
  1754             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1755         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1756             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1757             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1758             20  FILLER                     PIC XXX.
  1759
  1760         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1761         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1762         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1763         16  CF-CO-OPTION-START-DATE        PIC XX.
  1764         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1765           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1766                                                      '3' '4'.
  1767           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1768           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1769           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1770           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1771           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1772           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1773
  1774         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1775
  1776         16  CF-PAYMENT-APPROVAL-LEVELS.
  1777             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1778             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1779             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1780             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1781             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1782             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1783
  1784         16  CF-END-USER-REPORTING-USER     PIC X.
  1785             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1786             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1787
  1788         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1789             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1790             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1791
  1792         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1793
  1794         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1795         16  FILLER                         PIC X.
  1796
  1797         16  CF-CREDIT-ARCHIVE-CNTL.
  1798             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1799             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1800             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1801
  1802         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6041.cbl
  1803
  1804         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1805             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1806             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1807
  1808         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1809             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1810             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1811
  1812         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1813
  1814         16  CF-CO-ACH-ID-CODE              PIC  X.
  1815             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1816             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1817             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1818         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1819         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1820         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1821         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1822         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1823         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1824         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1825         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1826         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1827                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1828         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1829                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1830
  1831         16  CF-CO-OVER-SHORT.
  1832             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1833             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1834
  1835*         16  FILLER                         PIC X(102).
  1836         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1837             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1838             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1839
  1840         16  CF-AH-APPROVAL-DAYS.
  1841             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1842             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1843             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1844             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1845
  1846         16  FILLER                         PIC X(82).
  1847****************************************************************
  1848*             PROCESSOR/USER RECORD                            *
  1849****************************************************************
  1850
  1851     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1852         16  CF-PROCESSOR-NAME              PIC X(30).
  1853         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1854         16  CF-PROCESSOR-TITLE             PIC X(26).
  1855         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1856                 88  MESSAGE-YES                VALUE 'Y'.
  1857                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1858
  1859*****************************************************
  1860****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6041.cbl
  1861****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1862****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1863****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1864*****************************************************
  1865
  1866         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1867             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1868             20  CF-APPLICATION-FORCE       PIC X.
  1869             20  CF-INDIVIDUAL-APP.
  1870                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1871                     28  CF-BROWSE-APP      PIC X.
  1872                     28  CF-UPDATE-APP      PIC X.
  1873
  1874         16  CF-CURRENT-TERM-ON             PIC X(4).
  1875         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1876             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1877             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1878             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1879             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1880             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1881             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1882             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1883         16  CF-PROCESSOR-CARRIER           PIC X.
  1884             88  NO-CARRIER-SECURITY            VALUE ' '.
  1885         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1886             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1887         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1888             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1889         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1890             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1891
  1892         16  CF-PROC-SYS-ACCESS-SW.
  1893             20  CF-PROC-CREDIT-CLAIMS-SW.
  1894                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1895                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1896                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1897                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1898             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1899                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1900                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1901             20  CF-PROC-LIFE-GNRLDGR-SW.
  1902                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1903                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1904                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1905                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1906             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1907                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1908                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1909         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1910             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1911             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1912         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1913
  1914         16  CF-APPROVAL-LEVEL                  PIC X.
  1915             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1916             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1917             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1918             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6041.cbl
  1919
  1920         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1921
  1922         16  CF-LANGUAGE-TYPE                   PIC X.
  1923             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1924             88  CF-LANG-IS-FR                      VALUE 'F'.
  1925         16  FILLER                             PIC  X(240).
  1926
  1927****************************************************************
  1928*             PROCESSOR/REMINDERS RECORD                       *
  1929****************************************************************
  1930
  1931     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1932         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1933             20  CF-START-REMIND-DT         PIC XX.
  1934             20  CF-END-REMIND-DT           PIC XX.
  1935             20  CF-REMINDER-TEXT           PIC X(50).
  1936         16  FILLER                         PIC X(296).
  1937
  1938
  1939****************************************************************
  1940*             STATE MASTER RECORD                              *
  1941****************************************************************
  1942
  1943     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1944         16  CF-STATE-ABBREVIATION          PIC XX.
  1945         16  CF-STATE-NAME                  PIC X(25).
  1946         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1947         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1948             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1949             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1950             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1951             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1952                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1953                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1954             20  CF-ST-PREM-REJECT-SW       PIC X.
  1955                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1956                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1957             20  CF-ST-REF-REJECT-SW        PIC X.
  1958                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1959                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1960         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1961         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1962         16  CF-ST-REFUND-RULES.
  1963             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1964             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1965             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1966         16  CF-ST-FST-PMT-EXTENSION.
  1967             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1968             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1969                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1970                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1971                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1972                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1973         16  CF-ST-STATE-CALL.
  1974             20  CF-ST-CALL-UNEARNED        PIC X.
  1975             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1976             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6041.cbl
  1977         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1978             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1979             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1980         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1981         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1982         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1983         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1984         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1985         16  FILLER                         PIC X.
  1986         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1987             20  CF-ST-BENEFIT-CD           PIC XX.
  1988             20  CF-ST-BENEFIT-KIND         PIC X.
  1989                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1990                 88  CF-ST-AH-KIND              VALUE 'A'.
  1991             20  CF-ST-REM-TERM-CALC        PIC X.
  1992                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1993                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1994                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1995                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1996                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1997                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1998                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1999                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2000
  2001             20  CF-ST-REFUND-CALC          PIC X.
  2002                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2003                 88  ST-REFD-BY-R78             VALUE '1'.
  2004                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2005                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2006                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2007                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2008                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2009                 88  ST-REFD-UTAH               VALUE '7'.
  2010                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2011                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2012                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2013
  2014             20  CF-ST-EARNING-CALC         PIC X.
  2015                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2016                 88  ST-EARN-BY-R78             VALUE '1'.
  2017                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2018                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2019                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2020                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2021                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2022                 88  ST-EARN-MEAN               VALUE '8'.
  2023                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2024
  2025             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2026                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2027                 88  ST-OVRD-BY-R78             VALUE '1'.
  2028                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2029                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2030                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2031                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2032                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2033                 88  ST-OVRD-MEAN               VALUE '8'.
  2034                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6041.cbl
  2035             20  FILLER                     PIC X.
  2036
  2037         16  CF-ST-COMMISSION-CAPS.
  2038             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2039             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2040             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2041             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2042         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2043                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2044
  2045         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2046
  2047         16  CF-ST-STATUTORY-INTEREST.
  2048             20  CF-ST-STAT-DATE-FROM       PIC X.
  2049                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2050                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2051             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2052             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2053             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2054             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2055             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2056
  2057         16  CF-ST-OVER-SHORT.
  2058             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2059             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2060
  2061         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2062
  2063         16  CF-ST-RT-CALC                  PIC X.
  2064
  2065         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2066         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2067         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2068         16  CF-ST-RF-LR-CALC               PIC X.
  2069         16  CF-ST-RF-LL-CALC               PIC X.
  2070         16  CF-ST-RF-LN-CALC               PIC X.
  2071         16  CF-ST-RF-AH-CALC               PIC X.
  2072         16  CF-ST-RF-CP-CALC               PIC X.
  2073*        16  FILLER                         PIC X(206).
  2074*CIDMOD         16  FILLER                         PIC X(192).
  2075         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2076             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2077         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2078         16  FILLER                         PIC X(187).
  2079
  2080****************************************************************
  2081*             BENEFIT MASTER RECORD                            *
  2082****************************************************************
  2083
  2084     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2085         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2086             20  CF-BENEFIT-CODE            PIC XX.
  2087             20  CF-BENEFIT-NUMERIC  REDEFINES
  2088                 CF-BENEFIT-CODE            PIC XX.
  2089             20  CF-BENEFIT-ALPHA           PIC XXX.
  2090             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2091             20  CF-BENEFIT-COMMENT         PIC X(10).
  2092
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6041.cbl
  2093             20  CF-LF-COVERAGE-TYPE        PIC X.
  2094                 88  CF-REDUCING                VALUE 'R'.
  2095                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2096
  2097             20  CF-SPECIAL-CALC-CD         PIC X.
  2098                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2099                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2100                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2101                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2102                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2103                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2104                 88  CF-FARM-PLAN               VALUE 'F'.
  2105                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2106                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2107                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2108                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2109                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2110                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2111                 88  CF-PRUDENTIAL              VALUE 'P'.
  2112                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2113                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2114                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2115                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2116                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2117                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2118
  2119             20  CF-JOINT-INDICATOR         PIC X.
  2120                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2121
  2122*            20  FILLER                     PIC X(12).
  2123             20  FILLER                     PIC X(11).
  2124             20  CF-BENEFIT-CATEGORY        PIC X.
  2125             20  CF-LOAN-TYPE               PIC X(8).
  2126
  2127             20  CF-CO-REM-TERM-CALC        PIC X.
  2128                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2129                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2130                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2131                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2132                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2133
  2134             20  CF-CO-EARNINGS-CALC        PIC X.
  2135                 88  CO-EARN-BY-R78             VALUE '1'.
  2136                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2137                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2138                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2139                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2140                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2141                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2142                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2143
  2144             20  CF-CO-REFUND-CALC          PIC X.
  2145                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2146                 88  CO-REFD-BY-R78             VALUE '1'.
  2147                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2148                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2149                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2150                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6041.cbl
  2151                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2152                 88  CO-REFD-MEAN               VALUE '8'.
  2153                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2154                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2155                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2156
  2157             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2158                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2159                 88  CO-OVRD-BY-R78             VALUE '1'.
  2160                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2161                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2162                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2163                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2164                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2165                 88  CO-OVRD-MEAN               VALUE '8'.
  2166                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2167
  2168             20  CF-CO-BEN-I-G-CD           PIC X.
  2169                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2170                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2171                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2172
  2173         16  FILLER                         PIC X(304).
  2174
  2175
  2176****************************************************************
  2177*             CARRIER MASTER RECORD                            *
  2178****************************************************************
  2179
  2180     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2181         16  CF-ADDRESS-DATA.
  2182             20  CF-MAIL-TO-NAME            PIC X(30).
  2183             20  CF-IN-CARE-OF              PIC X(30).
  2184             20  CF-ADDRESS-LINE-1          PIC X(30).
  2185             20  CF-ADDRESS-LINE-2          PIC X(30).
  2186             20  CF-CITY-STATE              PIC X(30).
  2187             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2188             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2189
  2190         16  CF-CLAIM-NO-CONTROL.
  2191             20  CF-CLAIM-NO-METHOD         PIC X.
  2192                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2193                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2194                 88  CLAIM-NO-SEQ               VALUE '3'.
  2195                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2196             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2197                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2198                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2199                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2200
  2201         16  CF-CHECK-NO-CONTROL.
  2202             20  CF-CHECK-NO-METHOD         PIC X.
  2203                 88  CHECK-NO-MANUAL            VALUE '1'.
  2204                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2205                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2206                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2207             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2208                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6041.cbl
  2209
  2210         16  CF-DOMICILE-STATE              PIC XX.
  2211
  2212         16  CF-EXPENSE-CONTROLS.
  2213             20  CF-EXPENSE-METHOD          PIC X.
  2214                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2215                 88  DOLLARS-PER-PMT            VALUE '2'.
  2216                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2217                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2218             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2219             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2220
  2221         16  CF-CORRESPONDENCE-CONTROL.
  2222             20  CF-LETTER-RESEND-OPT       PIC X.
  2223                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2224                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2225             20  FILLER                     PIC X(4).
  2226
  2227         16  CF-RESERVE-CONTROLS.
  2228             20  CF-MANUAL-SW               PIC X.
  2229                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2230             20  CF-FUTURE-SW               PIC X.
  2231                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2232             20  CF-PTC-SW                  PIC X.
  2233                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2234             20  CF-IBNR-SW                 PIC X.
  2235                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2236             20  CF-PTC-LF-SW               PIC X.
  2237                 88  CF-LF-PTC-USED             VALUE '1'.
  2238             20  CF-CDT-ACCESS-METHOD       PIC X.
  2239                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2240                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2241                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2242             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2243
  2244         16  CF-CLAIM-CALC-METHOD           PIC X.
  2245             88  360-PLUS-MONTHS                VALUE '1'.
  2246             88  365-PLUS-MONTHS                VALUE '2'.
  2247             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2248             88  360-DAILY                      VALUE '4'.
  2249             88  365-DAILY                      VALUE '5'.
  2250
  2251         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2252         16  FILLER                         PIC X(11).
  2253
  2254         16  CF-LIMIT-AMOUNTS.
  2255             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2256             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2257             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2258             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2259             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2260             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2261             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2262             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2263             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2264             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2265
  2266         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6041.cbl
  2267         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2268         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2269
  2270         16  CF-ZIP-CODE.
  2271             20  CF-ZIP-PRIME.
  2272                 24  CF-ZIP-1ST             PIC X.
  2273                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2274                 24  FILLER                 PIC X(4).
  2275             20  CF-ZIP-PLUS4               PIC X(4).
  2276         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2277             20  CF-CAN-POSTAL-1            PIC XXX.
  2278             20  CF-CAN-POSTAL-2            PIC XXX.
  2279             20  FILLER                     PIC XXX.
  2280
  2281         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2282         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2283         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2284
  2285         16  CF-RATING-SWITCH               PIC X.
  2286             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2287             88  CF-NO-RATING                   VALUE 'N'.
  2288
  2289         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2290
  2291         16  CF-CARRIER-OVER-SHORT.
  2292             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2293             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2294
  2295         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2296         16  CF-SECPAY-SWITCH               PIC X.
  2297             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2298             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2299         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2300         16  FILLER                         PIC X(448).
  2301*        16  FILLER                         PIC X(452).
  2302
  2303
  2304****************************************************************
  2305*             MORTALITY MASTER RECORD                          *
  2306****************************************************************
  2307
  2308     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2309         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2310                                INDEXED BY CF-MORT-NDX.
  2311             20  CF-MORT-TABLE              PIC X(5).
  2312             20  CF-MORT-TABLE-TYPE         PIC X.
  2313                 88  CF-MORT-JOINT              VALUE 'J'.
  2314                 88  CF-MORT-SINGLE             VALUE 'S'.
  2315                 88  CF-MORT-COMBINED           VALUE 'C'.
  2316                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2317                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2318             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2319             20  CF-MORT-AGE-METHOD         PIC XX.
  2320                 88  CF-AGE-LAST                VALUE 'AL'.
  2321                 88  CF-AGE-NEAR                VALUE 'AN'.
  2322             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2323             20  CF-MORT-ADJUSTMENT-DIRECTION
  2324                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6041.cbl
  2325                 88  CF-MINUS                   VALUE '-'.
  2326                 88  CF-PLUS                    VALUE '+'.
  2327             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2328             20  CF-MORT-JOINT-CODE         PIC X.
  2329                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2330             20  CF-MORT-PC-Q               PIC X.
  2331                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2332             20  CF-MORT-TABLE-CODE         PIC X(4).
  2333             20  CF-MORT-COMMENTS           PIC X(15).
  2334             20  FILLER                     PIC X(14).
  2335
  2336         16  FILLER                         PIC X(251).
  2337
  2338
  2339****************************************************************
  2340*             BUSSINESS TYPE MASTER RECORD                     *
  2341****************************************************************
  2342
  2343     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2344* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2345* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2346* AND RECORD 05 IS TYPES 81-99
  2347         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2348             20  CF-BUSINESS-TITLE          PIC  X(19).
  2349             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2350                                            PIC S9V9(4) COMP-3.
  2351             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2352             20  FILLER                     PIC  X.
  2353         16  FILLER                         PIC  X(248).
  2354
  2355
  2356****************************************************************
  2357*             TERMINAL MASTER RECORD                           *
  2358****************************************************************
  2359
  2360     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2361
  2362         16  CF-COMPANY-TERMINALS.
  2363             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2364                                  PIC X(4).
  2365         16  FILLER               PIC X(248).
  2366
  2367
  2368****************************************************************
  2369*             LIFE EDIT MASTER RECORD                          *
  2370****************************************************************
  2371
  2372     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2373         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2374             20  CF-LIFE-CODE-IN            PIC XX.
  2375             20  CF-LIFE-CODE-OUT           PIC XX.
  2376         16  FILLER                         PIC X(248).
  2377
  2378
  2379****************************************************************
  2380*             AH EDIT MASTER RECORD                            *
  2381****************************************************************
  2382
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6041.cbl
  2383     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2384         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2385             20  CF-AH-CODE-IN              PIC XXX.
  2386             20  CF-AH-CODE-OUT             PIC XX.
  2387         16  FILLER                         PIC X(248).
  2388
  2389
  2390****************************************************************
  2391*             CREDIBILITY TABLES                               *
  2392****************************************************************
  2393
  2394     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2395         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2396                             INDEXED BY CF-CRDB-NDX.
  2397             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2398             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2399             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2400         16  FILLER                         PIC  X(332).
  2401
  2402
  2403****************************************************************
  2404*             REPORT CUSTOMIZATION RECORD                      *
  2405****************************************************************
  2406
  2407     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2408         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2409             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2410             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2411             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2412**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2413****       A T-TRANSFER.                                   ****
  2414             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2415
  2416         16  FILLER                         PIC XX.
  2417
  2418         16  CF-CARRIER-CNTL-OPT.
  2419             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2420                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2421                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2422             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2423                                            PIC X.
  2424         16  CF-GROUP-CNTL-OPT.
  2425             20  CF-GROUP-OPT-SEQ           PIC 9.
  2426                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2427                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2428             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2429                                            PIC X(6).
  2430         16  CF-STATE-CNTL-OPT.
  2431             20  CF-STATE-OPT-SEQ           PIC 9.
  2432                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2433                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2434             20  CF-STATE-SELECT OCCURS 3 TIMES
  2435                                            PIC XX.
  2436         16  CF-ACCOUNT-CNTL-OPT.
  2437             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2438                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2439                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2440             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6041.cbl
  2441                                            PIC X(10).
  2442         16  CF-BUS-TYP-CNTL-OPT.
  2443             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2444                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2445                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2446             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2447                                            PIC XX.
  2448         16  CF-LF-TYP-CNTL-OPT.
  2449             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2450                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2451                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2452             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2453                                            PIC XX.
  2454         16  CF-AH-TYP-CNTL-OPT.
  2455             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2456                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2457                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2458             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2459                                            PIC XX.
  2460         16  CF-REPTCD1-CNTL-OPT.
  2461             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2462                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2463                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2464             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2465                                            PIC X(10).
  2466         16  CF-REPTCD2-CNTL-OPT.
  2467             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2468                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2469                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2470             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2471                                            PIC X(10).
  2472         16  CF-USER1-CNTL-OPT.
  2473             20  CF-USER1-OPT-SEQ           PIC 9.
  2474                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2475                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2476             20  CF-USER1-SELECT OCCURS 3 TIMES
  2477                                            PIC X(10).
  2478         16  CF-USER2-CNTL-OPT.
  2479             20  CF-USER2-OPT-SEQ           PIC 9.
  2480                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2481                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2482             20  CF-USER2-SELECT OCCURS 3 TIMES
  2483                                            PIC X(10).
  2484         16  CF-USER3-CNTL-OPT.
  2485             20  CF-USER3-OPT-SEQ           PIC 9.
  2486                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2487                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2488             20  CF-USER3-SELECT OCCURS 3 TIMES
  2489                                            PIC X(10).
  2490         16  CF-USER4-CNTL-OPT.
  2491             20  CF-USER4-OPT-SEQ           PIC 9.
  2492                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2493                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2494             20  CF-USER4-SELECT OCCURS 3 TIMES
  2495                                            PIC X(10).
  2496         16  CF-USER5-CNTL-OPT.
  2497             20  CF-USER5-OPT-SEQ           PIC 9.
  2498                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6041.cbl
  2499                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2500             20  CF-USER5-SELECT OCCURS 3 TIMES
  2501                                            PIC X(10).
  2502         16  CF-REINS-CNTL-OPT.
  2503             20  CF-REINS-OPT-SEQ           PIC 9.
  2504                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2505                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2506             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2507                 24  CF-REINS-PRIME         PIC XXX.
  2508                 24  CF-REINS-SUB           PIC XXX.
  2509
  2510         16  CF-AGENT-CNTL-OPT.
  2511             20  CF-AGENT-OPT-SEQ           PIC 9.
  2512                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2513                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2514             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2515                                            PIC X(10).
  2516
  2517         16  FILLER                         PIC X(43).
  2518
  2519         16  CF-LOSS-RATIO-SELECT.
  2520             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2521             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2522         16  CF-ENTRY-DATE-SELECT.
  2523             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2524             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2525         16  CF-EFFECTIVE-DATE-SELECT.
  2526             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2527             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2528
  2529         16  CF-EXCEPTION-LIST-IND          PIC X.
  2530             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2531
  2532         16  FILLER                         PIC X(318).
  2533
  2534****************************************************************
  2535*                  EXCEPTION REPORTING RECORD                  *
  2536****************************************************************
  2537
  2538     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2539         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2540             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2541
  2542         16  CF-COMBINED-LIFE-AH-OPT.
  2543             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2544             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2545             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2546             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2547
  2548         16  CF-LIFE-OPT.
  2549             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2550             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2551             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2552             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2553             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2554             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2555             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2556             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL6041.cbl
  2557             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2558             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2559
  2560         16  CF-AH-OPT.
  2561             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2562             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2563             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2564             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2565             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2566             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2567             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2568             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2569             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2570             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2571
  2572         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2573             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2574             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2575             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2576
  2577         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2578
  2579         16  FILLER                         PIC X(673).
  2580
  2581
  2582****************************************************************
  2583*             MORTGAGE SYSTEM PLAN RECORD                      *
  2584****************************************************************
  2585
  2586     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2587         16  CF-PLAN-TYPE                   PIC X.
  2588             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2589             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2590             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2591         16  CF-PLAN-ABBREV                 PIC XXX.
  2592         16  CF-PLAN-DESCRIPT               PIC X(10).
  2593         16  CF-PLAN-NOTES                  PIC X(20).
  2594         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2595         16  CF-PLAN-UNDERWRITING.
  2596             20  CF-PLAN-TERM-DATA.
  2597                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2598                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2599             20  CF-PLAN-AGE-DATA.
  2600                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2601                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2602                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2603             20  CF-PLAN-BENEFIT-DATA.
  2604                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2605                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2606                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2607                                            PIC S9(7)V99  COMP-3.
  2608         16  CF-PLAN-POLICY-FORMS.
  2609             20  CF-POLICY-FORM             PIC X(12).
  2610             20  CF-MASTER-APPLICATION      PIC X(12).
  2611             20  CF-MASTER-POLICY           PIC X(12).
  2612         16  CF-PLAN-RATING.
  2613             20  CF-RATE-CODE               PIC X(5).
  2614             20  CF-SEX-RATING              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL6041.cbl
  2615                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2616                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2617             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2618             20  CF-SUB-STD-TYPE            PIC X.
  2619                 88  CF-PCT-OF-PREM            VALUE '1'.
  2620                 88  CF-PCT-OF-BENE            VALUE '2'.
  2621         16  CF-PLAN-PREM-TOLERANCES.
  2622             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2623             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2624         16  CF-PLAN-PYMT-TOLERANCES.
  2625             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2626             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2627         16  CF-PLAN-MISC-DATA.
  2628             20  FILLER                     PIC X.
  2629             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2630             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2631         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2632         16  CF-PLAN-IND-GRP                PIC X.
  2633             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2634                                                     '1'.
  2635             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2636                                                     '2'.
  2637         16  CF-MIB-SEARCH-SW               PIC X.
  2638             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2639             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2640             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2641             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2642         16  CF-ALPHA-SEARCH-SW             PIC X.
  2643             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2644             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2645             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2646             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2647             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2648             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2649             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2650             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2651             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2652             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2653                                                     'A' 'B' 'C'
  2654                                                     'X' 'Y' 'Z'.
  2655         16  CF-EFF-DT-RULE-SW              PIC X.
  2656             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2657             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2658             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2659             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2660             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2661         16  FILLER                         PIC X(4).
  2662         16  CF-HEALTH-QUESTIONS            PIC X.
  2663             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2664         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2665         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2666         16  CF-PLAN-SNGL-JNT               PIC X.
  2667             88  CF-COMBINED-PLAN              VALUE 'C'.
  2668             88  CF-JNT-PLAN                   VALUE 'J'.
  2669             88  CF-SNGL-PLAN                  VALUE 'S'.
  2670         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2671         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2672         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL6041.cbl
  2673         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2674         16  CF-RERATE-CNTL                 PIC  X.
  2675             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2676             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2677             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2678             88  CF-AUTO-RECALC                 VALUE '4'.
  2679         16  CF-BENEFIT-TYPE                PIC  X.
  2680             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2681             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2682         16  CF-POLICY-FEE                  PIC S999V99
  2683                                                    COMP-3.
  2684         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2685         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2686         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2687         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2688         16  FILLER                         PIC  X(32).
  2689         16  CF-TERMINATION-FORM            PIC  X(04).
  2690         16  FILLER                         PIC  X(08).
  2691         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2692                                                       COMP-3.
  2693         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2694         16  CF-ISSUE-LETTER                PIC  X(4).
  2695         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2696         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2697             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2698             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2699         16  CF-MP-REFUND-CALC              PIC X.
  2700             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2701             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2702             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2703             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2704             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2705             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2706             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2707             88  CF-MP-REFD-MEAN                VALUE '8'.
  2708         16  CF-ALT-RATE-CODE               PIC  X(5).
  2709
  2710
  2711         16  FILLER                         PIC X(498).
  2712****************************************************************
  2713*             MORTGAGE COMPANY MASTER RECORD                   *
  2714****************************************************************
  2715
  2716     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2717         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2718         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2719             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2720             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2721             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2722             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2723             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2724
  2725         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2726         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2727         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2728         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2729         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2730
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL6041.cbl
  2731         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2732             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2733         16  CF-MP-RECON-USE-IND            PIC X(1).
  2734             88  CF-MP-USE-RECON             VALUE 'Y'.
  2735         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2736             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2737         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2738             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2739             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2740         16  FILLER                         PIC X(1).
  2741         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2742             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2743         16  CF-MORTG-MIB-VERSION           PIC X.
  2744             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2745             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2746             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2747         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2748             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2749                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2750             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2751                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2752             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2753                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2754             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2755                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2756             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2757                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2758             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2759                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2760         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2761         16  FILLER                         PIC X(7).
  2762         16  CF-MORTG-DESTINATION-SYMBOL.
  2763             20  CF-MORTG-MIB-COMM          PIC X(5).
  2764             20  CF-MORTG-MIB-TERM          PIC X(5).
  2765         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2766             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2767         16  FILLER                         PIC X(03).
  2768         16  CF-MP-CHECK-NO-CONTROL.
  2769             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2770                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2771                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2772                                                ' ' LOW-VALUES.
  2773                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2774                                               VALUE '3'.
  2775         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2776         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2777         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2778             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2779                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2780             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2781                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2782             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2783                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2784             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2785                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2786             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2787                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2788             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL6041.cbl
  2789                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2790         16  CF-MORTG-BILLING-AREA.
  2791             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2792                                            PIC X.
  2793         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2794         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2795         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2796         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2797             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2798             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2799         16  FILLER                         PIC X.
  2800         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2801             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2802             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2803         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2804         16  FILLER                         PIC X(8).
  2805         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2806         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2807         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2808         16  CF-ACH-COMPANY-ID.
  2809             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2810                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2811                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2812                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2813             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2814         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2815             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2816         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2817             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2818             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2819         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2820         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2821         16  FILLER                         PIC X(536).
  2822
  2823****************************************************************
  2824*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2825****************************************************************
  2826
  2827     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2828         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2829             20  CF-FEMALE-HEIGHT.
  2830                 24  CF-FEMALE-FT           PIC 99.
  2831                 24  CF-FEMALE-IN           PIC 99.
  2832             20  CF-FEMALE-MIN-WT           PIC 999.
  2833             20  CF-FEMALE-MAX-WT           PIC 999.
  2834         16  FILLER                         PIC X(428).
  2835
  2836     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2837         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2838             20  CF-MALE-HEIGHT.
  2839                 24  CF-MALE-FT             PIC 99.
  2840                 24  CF-MALE-IN             PIC 99.
  2841             20  CF-MALE-MIN-WT             PIC 999.
  2842             20  CF-MALE-MAX-WT             PIC 999.
  2843         16  FILLER                         PIC X(428).
  2844******************************************************************
  2845*             AUTOMATIC ACTIVITY RECORD                          *
  2846******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL6041.cbl
  2847     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2848         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2849             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2850             20  CF-SYS-LETTER-ID           PIC X(04).
  2851             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2852             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2853             20  CF-SYS-RESET-SW            PIC X(01).
  2854             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2855             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2856
  2857         16  FILLER                         PIC X(50).
  2858
  2859         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2860             20  CF-USER-ACTIVE-SW          PIC X(01).
  2861             20  CF-USER-LETTER-ID          PIC X(04).
  2862             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2863             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2864             20  CF-USER-RESET-SW           PIC X(01).
  2865             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2866             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2867             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2868
  2869         16  FILLER                         PIC X(246).
  2870
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL6041.cbl
  2872 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE.
  2873 0000-DFHEXIT SECTION.
  2874     MOVE '9#                    $   ' TO DFHEIV0.
  2875     MOVE 'EL6041' TO DFHEIV1.
  2876     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2877
  2878     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2879     MOVE '5'                    TO DC-OPTION-CODE.
  2880     PERFORM 9700-DATE-LINK.
  2881     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  2882     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  2883
  2884     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  2885     MOVE 1                      TO EMI-NUMBER-OF-LINES.
  2886
  2887     IF EIBCALEN = 0
  2888         GO TO 8800-UNAUTHORIZED-ACCESS.
  2889
  2890     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2891         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2892             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  2893             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2894             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2895             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2896             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2897             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2898             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2899             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  2900             PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  2901         ELSE
  2902             MOVE PI-CALLING-PROGRAM   TO RETURN-FROM
  2903             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  2904             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  2905             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  2906             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  2907             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  2908             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  2909             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  2910             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  2911
  2912
  2913* EXEC CICS    HANDLE    CONDITION
  2914*         PGMIDERR          (9600-PGMID-ERROR)
  2915*         ERROR             (9990-ABEND)
  2916*    END-EXEC.
  2917*    MOVE '"$L.                  ! " #00002908' TO DFHEIV0
  2918     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  2919     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2920     MOVE X'2220233030303032393038' TO DFHEIV0(25:11)
  2921     CALL 'kxdfhei1' USING DFHEIV0
  2922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2923
  2924
  2925     IF  EIBTRNID NOT = TRANS-ID
  2926         MOVE LOW-VALUES         TO EL6041AI
  2927         GO TO 8100-SEND-INITIAL-MAP.
  2928
  2929     IF  EIBAID = DFHCLEAR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL6041.cbl
  2930             OR
  2931         NOT SYSTEM-DISPLAY-CAP
  2932         GO TO 9400-CLEAR.
  2933
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL6041.cbl
  2935
  2936 0200-RECEIVE.
  2937     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  2938        MOVE ER-7008            TO EMI-ERROR
  2939        PERFORM 9900-ERROR-FORMAT
  2940        MOVE -1                 TO MAINTL
  2941        GO TO 8200-SEND-DATAONLY.
  2942
  2943
  2944* EXEC CICS RECEIVE
  2945*        MAP      (MAP-NAME)
  2946*        MAPSET   (MAPSET-NAME)
  2947*        INTO     (EL6041AI)
  2948*    END-EXEC.
  2949     MOVE LENGTH OF
  2950      EL6041AI
  2951       TO DFHEIV11
  2952*    MOVE '8"T I  L              ''   #00002931' TO DFHEIV0
  2953     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2954     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2955     MOVE X'2020233030303032393331' TO DFHEIV0(25:11)
  2956     CALL 'kxdfhei1' USING DFHEIV0,
  2957           MAP-NAME,
  2958           EL6041AI,
  2959           DFHEIV11,
  2960           MAPSET-NAME,
  2961           DFHEIV99,
  2962           DFHEIV99
  2963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2964
  2965
  2966     IF  PFKEYL = +0
  2967         GO TO 0300-CHECK-PFKEYS.
  2968
  2969     IF  EIBAID NOT = DFHENTER
  2970         MOVE ER-0004            TO EMI-ERROR
  2971         GO TO 0320-INPUT-ERROR.
  2972
  2973     IF PFKEYI NOT NUMERIC
  2974        MOVE ER-0029     TO EMI-ERROR
  2975        GO TO 0320-INPUT-ERROR.
  2976
  2977     IF PFKEYI GREATER 01 AND LESS 25
  2978        MOVE PF-VALUES (PFKEYI) TO EIBAID
  2979     ELSE
  2980        MOVE ER-0029        TO EMI-ERROR
  2981        GO TO 0320-INPUT-ERROR.
  2982
  2983 0300-CHECK-PFKEYS.
  2984     IF EIBAID = DFHPF23
  2985         GO TO 8810-PF23.
  2986
  2987     IF EIBAID = DFHPF24
  2988         GO TO 9200-RETURN-MAIN-MENU.
  2989
  2990     IF EIBAID = DFHPF12
  2991         GO TO 9500-PF12.
  2992
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL6041.cbl
  2993     IF MAINTL GREATER THAN +0 AND
  2994              EIBAID NOT = DFHENTER
  2995        MOVE -1             TO  MAINTL
  2996        MOVE  ER-0050       TO  EMI-ERROR
  2997        PERFORM 9900-ERROR-FORMAT
  2998        GO TO 8200-SEND-DATAONLY.
  2999
  3000     IF  EIBAID = DFHPF1
  3001         PERFORM 7000-BROWSE-FWRD-NEXT-ACCOUNT THRU 7090-EXIT
  3002         GO TO 4000-SHOW-REPORT.
  3003
  3004     IF  EIBAID = DFHPF2
  3005         PERFORM 7100-BROWSE-BWRD-NEXT-ACCOUNT THRU 7190-EXIT
  3006         GO TO 4000-SHOW-REPORT.
  3007
  3008     IF EIBAID = DFHENTER
  3009         GO TO 0400-EDIT-INPUT-DATA.
  3010
  3011     MOVE ER-0029                TO EMI-ERROR.
  3012
  3013 0320-INPUT-ERROR.
  3014     PERFORM 9900-ERROR-FORMAT.
  3015     MOVE AL-UNBON               TO PFKEYA.
  3016     IF PFKEYL = 0
  3017         MOVE -1                 TO MAINTL
  3018     ELSE
  3019         MOVE -1                 TO PFKEYL.
  3020
  3021     GO TO 8200-SEND-DATAONLY.
  3022
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL6041.cbl
  3024
  3025 0400-EDIT-INPUT-DATA.
  3026     IF MAINTI = 'S'
  3027        GO TO 4000-SHOW-REPORT.
  3028
  3029     IF   NOT SYSTEM-MODIFY-CAP
  3030          MOVE 'UPDATE'       TO SM-READ
  3031          PERFORM 9995-SECURITY-VIOLATION
  3032          MOVE ER-0070        TO EMI-ERROR
  3033          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3034          GO TO 8100-SEND-INITIAL-MAP.
  3035
  3036     IF MAINTI = 'A'
  3037        GO TO 1000-ADD-REPORT.
  3038
  3039     IF MAINTI = 'C'
  3040        GO TO 2000-CHANGE-REPORT.
  3041
  3042     IF MAINTI = 'D'
  3043        GO TO 2500-DELETE-REPORT.
  3044
  3045     IF MAINTI = 'K'
  3046        GO TO 3000-COPY-REPORT.
  3047
  3048     MOVE  ER-0023            TO EMI-ERROR
  3049     MOVE -1                  TO MAINTL
  3050     MOVE AL-UABON            TO MAINTA
  3051     PERFORM 9900-ERROR-FORMAT
  3052     GO TO 8200-SEND-DATAONLY.
  3053
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL6041.cbl
  3055
  3056 1000-ADD-REPORT.
  3057     IF REPORTL GREATER +0 AND
  3058        REPORTI NUMERIC
  3059        NEXT SENTENCE
  3060     ELSE
  3061        MOVE ER-7680     TO EMI-ERROR
  3062        MOVE -1          TO REPORTL
  3063        MOVE AL-UNBON    TO REPORTA
  3064        PERFORM 9900-ERROR-FORMAT
  3065        GO TO 8200-SEND-DATAONLY.
  3066
  3067     MOVE SPACES            TO ELCNTL-KEY.
  3068     MOVE PI-COMPANY-ID     TO ELCNTL-COMPANY-ID.
  3069     MOVE REPORTI           TO ELCNTL-REPORT.
  3070     MOVE 'C'               TO ELCNTL-RECORD-TYPE.
  3071     MOVE +0002             TO ELCNTL-SEQ-NO.
  3072
  3073
  3074* EXEC CICS HANDLE CONDITION
  3075*         NOTFND     (1100-EDIT-REPORT-SCREEN)
  3076*    END-EXEC.
  3077*    MOVE '"$I                   ! # #00003044' TO DFHEIV0
  3078     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3079     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3080     MOVE X'2320233030303033303434' TO DFHEIV0(25:11)
  3081     CALL 'kxdfhei1' USING DFHEIV0
  3082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3083
  3084
  3085
  3086* EXEC CICS READ
  3087*         DATASET    (ELCNTL-FILE-ID)
  3088*         RIDFLD     (ELCNTL-KEY)
  3089*         SET        (ADDRESS OF CONTROL-FILE)
  3090*    END-EXEC.
  3091*    MOVE '&"S        E          (   #00003048' TO DFHEIV0
  3092     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3093     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3094     MOVE X'2020233030303033303438' TO DFHEIV0(25:11)
  3095     CALL 'kxdfhei1' USING DFHEIV0,
  3096           ELCNTL-FILE-ID,
  3097           DFHEIV20,
  3098           DFHEIV99,
  3099           ELCNTL-KEY,
  3100           DFHEIV99,
  3101           DFHEIV99,
  3102           DFHEIV99
  3103     SET ADDRESS OF CONTROL-FILE TO
  3104         DFHEIV20
  3105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3106
  3107
  3108     MOVE -1                     TO REPORTL.
  3109     MOVE  ER-0132               TO  EMI-ERROR.
  3110     PERFORM 9900-ERROR-FORMAT.
  3111     GO TO 8200-SEND-DATAONLY.
  3112
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL6041.cbl
  3113 1100-EDIT-REPORT-SCREEN.
  3114     IF LTONEYL GREATER +0
  3115        IF LTONEYI = 'Y' OR 'N'
  3116           NEXT SENTENCE
  3117        ELSE
  3118           MOVE ER-2001            TO EMI-ERROR
  3119           MOVE -1                 TO LTONEYL
  3120           MOVE AL-UABON           TO LTONEYA
  3121           PERFORM 9900-ERROR-FORMAT.
  3122
  3123     IF ZERMPDL GREATER +0
  3124        IF ZERMPDI = 'A' OR 'B' OR 'C'
  3125           NEXT SENTENCE
  3126        ELSE
  3127           MOVE ER-7354            TO EMI-ERROR
  3128           MOVE -1                 TO ZERMPDL
  3129           MOVE AL-UABON           TO ZERMPDA
  3130           PERFORM 9900-ERROR-FORMAT.
  3131
  3132     IF ISSCNTL GREATER THAN +0
  3133         MOVE ISSCNTI TO DEEDIT-FIELD
  3134         PERFORM 8600-DEEDIT
  3135         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3136             MOVE -1 TO ISSCNTL
  3137             MOVE AL-UNBON TO ISSCNTA
  3138             MOVE ER-2223 TO EMI-ERROR
  3139             PERFORM 9900-ERROR-FORMAT
  3140         ELSE
  3141             MOVE DEEDIT-FIELD-V0 TO WS-ISS-COUNT-DIFF.
  3142
  3143     IF SMPRMPL GREATER THAN +0
  3144         MOVE SMPRMPI TO DEEDIT-FIELD
  3145         PERFORM 8600-DEEDIT
  3146         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3147             MOVE -1 TO SMPRMPL
  3148             MOVE AL-UNBON TO SMPRMPA
  3149             MOVE ER-2223 TO EMI-ERROR
  3150             PERFORM 9900-ERROR-FORMAT
  3151         ELSE
  3152             MOVE DEEDIT-FIELD-V0 TO WS-SINGLE-MO-PREM-PCT.
  3153
  3154     IF EPRMDCL GREATER THAN +0
  3155         MOVE EPRMDCI TO DEEDIT-FIELD
  3156         PERFORM 8600-DEEDIT
  3157         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3158             MOVE -1 TO EPRMDCL
  3159             MOVE AL-UNBON TO EPRMDCA
  3160             MOVE ER-2223 TO EMI-ERROR
  3161             PERFORM 9900-ERROR-FORMAT
  3162         ELSE
  3163             MOVE DEEDIT-FIELD-V0 TO WS-EARN-PREM-DECLINE.
  3164
  3165     IF CNCRATL GREATER THAN +0
  3166         MOVE CNCRATI TO DEEDIT-FIELD
  3167         PERFORM 8600-DEEDIT
  3168         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3169             MOVE -1 TO CNCRATL
  3170             MOVE AL-UNBON TO CNCRATA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL6041.cbl
  3171             MOVE ER-2223 TO EMI-ERROR
  3172             PERFORM 9900-ERROR-FORMAT
  3173         ELSE
  3174             MOVE DEEDIT-FIELD-V0 TO WS-CANCELLATION-RATIO.
  3175
  3176     IF RETLIML GREATER THAN +0
  3177         MOVE RETLIMI TO DEEDIT-FIELD
  3178         PERFORM 8600-DEEDIT
  3179         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3180             MOVE -1 TO RETLIML
  3181             MOVE AL-UNBON TO RETLIMA
  3182             MOVE ER-2223 TO EMI-ERROR
  3183             PERFORM 9900-ERROR-FORMAT
  3184         ELSE
  3185             MOVE DEEDIT-FIELD-V0 TO WS-RETENTION-LIMIT.
  3186
  3187     IF LLSRATL GREATER THAN +0
  3188         MOVE LLSRATI TO DEEDIT-FIELD
  3189         PERFORM 8600-DEEDIT
  3190         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3191             MOVE -1 TO LLSRATL
  3192             MOVE AL-UNBON TO LLSRATA
  3193             MOVE ER-2223 TO EMI-ERROR
  3194             PERFORM 9900-ERROR-FORMAT
  3195         ELSE
  3196             MOVE DEEDIT-FIELD-V0 TO WS-LF-LOSS-RATIO-PCT.
  3197
  3198     IF LLTLRSL GREATER THAN +0
  3199         MOVE LLTLRSI TO DEEDIT-FIELD
  3200         PERFORM 8600-DEEDIT
  3201         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3202             MOVE -1 TO LLTLRSL
  3203             MOVE AL-UNBON TO LLTLRSA
  3204             MOVE ER-2223 TO EMI-ERROR
  3205             PERFORM 9900-ERROR-FORMAT
  3206         ELSE
  3207             MOVE DEEDIT-FIELD-V0 TO WS-LF-LTM-LOSS-RATIO.
  3208
  3209     IF LPDPROL GREATER THAN +0
  3210         MOVE LPDPROI TO DEEDIT-FIELD
  3211         PERFORM 8600-DEEDIT
  3212         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3213             MOVE -1 TO LPDPROL
  3214             MOVE AL-UNBON TO LPDPROA
  3215             MOVE ER-2223 TO EMI-ERROR
  3216             PERFORM 9900-ERROR-FORMAT
  3217         ELSE
  3218             MOVE DEEDIT-FIELD-V0 TO WS-LF-PERIOD-PROFIT.
  3219
  3220     IF LLTPRPL GREATER THAN +0
  3221         MOVE LLTPRPI TO DEEDIT-FIELD
  3222         PERFORM 8600-DEEDIT
  3223         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3224             MOVE -1 TO LLTPRPL
  3225             MOVE AL-UNBON TO LLTPRPA
  3226             MOVE ER-2223 TO EMI-ERROR
  3227             PERFORM 9900-ERROR-FORMAT
  3228         ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL6041.cbl
  3229             MOVE DEEDIT-FIELD-V1 TO WS-LF-LTM-PROFIT-PCT.
  3230
  3231     IF LLTIDCL GREATER THAN +0
  3232         MOVE LLTIDCI TO DEEDIT-FIELD
  3233         PERFORM 8600-DEEDIT
  3234         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3235             MOVE -1 TO LLTIDCL
  3236             MOVE AL-UNBON TO LLTIDCA
  3237             MOVE ER-2223 TO EMI-ERROR
  3238             PERFORM 9900-ERROR-FORMAT
  3239         ELSE
  3240             MOVE DEEDIT-FIELD-V1 TO WS-LF-LTM-INFORCE-DECR.
  3241
  3242     IF LLTTRML GREATER THAN +0
  3243         MOVE LLTTRMI TO DEEDIT-FIELD
  3244         PERFORM 8600-DEEDIT
  3245         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3246             MOVE -1 TO LLTTRML
  3247             MOVE AL-UNBON TO LLTTRMA
  3248             MOVE ER-2223 TO EMI-ERROR
  3249             PERFORM 9900-ERROR-FORMAT
  3250         ELSE
  3251             MOVE DEEDIT-FIELD-V1 TO WS-LF-LTM-TERM-CHG.
  3252
  3253     IF LTRMAVL GREATER THAN +0
  3254         MOVE LTRMAVI TO DEEDIT-FIELD
  3255         PERFORM 8600-DEEDIT
  3256         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3257             MOVE -1 TO LTRMAVL
  3258             MOVE AL-UNBON TO LTRMAVA
  3259             MOVE ER-2223 TO EMI-ERROR
  3260             PERFORM 9900-ERROR-FORMAT
  3261         ELSE
  3262             MOVE DEEDIT-FIELD-V1 TO WS-LF-TERM-AVG-WEIGHTED.
  3263
  3264     IF LLTAGPL GREATER THAN +0
  3265         MOVE LLTAGPI TO DEEDIT-FIELD
  3266         PERFORM 8600-DEEDIT
  3267         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3268             MOVE -1 TO LLTAGPL
  3269             MOVE AL-UNBON TO LLTAGPA
  3270             MOVE ER-2223 TO EMI-ERROR
  3271             PERFORM 9900-ERROR-FORMAT
  3272         ELSE
  3273             MOVE DEEDIT-FIELD-V1 TO WS-LF-LTM-AGE-PCT.
  3274
  3275     IF LAVAGWL GREATER THAN +0
  3276         MOVE LAVAGWI TO DEEDIT-FIELD
  3277         PERFORM 8600-DEEDIT
  3278         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3279             MOVE -1 TO LAVAGWL
  3280             MOVE AL-UNBON TO LAVAGWA
  3281             MOVE ER-2223 TO EMI-ERROR
  3282             PERFORM 9900-ERROR-FORMAT
  3283         ELSE
  3284             MOVE DEEDIT-FIELD-V1 TO WS-LF-AGE-AVG-WEIGHTED.
  3285
  3286     IF LAVAGML GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL6041.cbl
  3287         MOVE LAVAGMI TO DEEDIT-FIELD
  3288         PERFORM 8600-DEEDIT
  3289         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3290             MOVE -1 TO LAVAGML
  3291             MOVE AL-UNBON TO LAVAGMA
  3292             MOVE ER-2223 TO EMI-ERROR
  3293             PERFORM 9900-ERROR-FORMAT
  3294         ELSE
  3295             MOVE DEEDIT-FIELD-V0 TO WS-LF-AVG-AGE-MAX.
  3296
  3297     IF ALSRATL GREATER THAN +0
  3298         MOVE ALSRATI TO DEEDIT-FIELD
  3299         PERFORM 8600-DEEDIT
  3300         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3301             MOVE -1 TO ALSRATL
  3302             MOVE AL-UNBON TO ALSRATA
  3303             MOVE ER-2223 TO EMI-ERROR
  3304             PERFORM 9900-ERROR-FORMAT
  3305         ELSE
  3306             MOVE DEEDIT-FIELD-V0 TO WS-AH-LOSS-RATIO-PCT.
  3307
  3308     IF ALTLRSL GREATER THAN +0
  3309         MOVE ALTLRSI TO DEEDIT-FIELD
  3310         PERFORM 8600-DEEDIT
  3311         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3312             MOVE -1 TO ALTLRSL
  3313             MOVE AL-UNBON TO ALTLRSA
  3314             MOVE ER-2223 TO EMI-ERROR
  3315             PERFORM 9900-ERROR-FORMAT
  3316         ELSE
  3317             MOVE DEEDIT-FIELD-V0 TO WS-AH-LTM-LOSS-RATIO.
  3318
  3319     IF APDPROL GREATER THAN +0
  3320         MOVE APDPROI TO DEEDIT-FIELD
  3321         PERFORM 8600-DEEDIT
  3322         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3323             MOVE -1 TO APDPROL
  3324             MOVE AL-UNBON TO APDPROA
  3325             MOVE ER-2223 TO EMI-ERROR
  3326             PERFORM 9900-ERROR-FORMAT
  3327         ELSE
  3328             MOVE DEEDIT-FIELD-V0 TO WS-AH-PERIOD-PROFIT.
  3329
  3330     IF ALTPRPL GREATER THAN +0
  3331         MOVE ALTPRPI TO DEEDIT-FIELD
  3332         PERFORM 8600-DEEDIT
  3333         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3334             MOVE -1 TO ALTPRPL
  3335             MOVE AL-UNBON TO ALTPRPA
  3336             MOVE ER-2223 TO EMI-ERROR
  3337             PERFORM 9900-ERROR-FORMAT
  3338         ELSE
  3339             MOVE DEEDIT-FIELD-V1 TO WS-AH-LTM-PROFIT-PCT.
  3340
  3341     IF ALTIDCL GREATER THAN +0
  3342         MOVE ALTIDCI TO DEEDIT-FIELD
  3343         PERFORM 8600-DEEDIT
  3344         IF DEEDIT-FIELD-V0  NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL6041.cbl
  3345             MOVE -1 TO ALTIDCL
  3346             MOVE AL-UNBON TO ALTIDCA
  3347             MOVE ER-2223 TO EMI-ERROR
  3348             PERFORM 9900-ERROR-FORMAT
  3349         ELSE
  3350             MOVE DEEDIT-FIELD-V1 TO WS-AH-LTM-INFORCE-DECR.
  3351
  3352     IF ALTTRML GREATER THAN +0
  3353         MOVE ALTTRMI TO DEEDIT-FIELD
  3354         PERFORM 8600-DEEDIT
  3355         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3356             MOVE -1 TO ALTTRML
  3357             MOVE AL-UNBON TO ALTTRMA
  3358             MOVE ER-2223 TO EMI-ERROR
  3359             PERFORM 9900-ERROR-FORMAT
  3360         ELSE
  3361             MOVE DEEDIT-FIELD-V1 TO WS-AH-LTM-TERM-CHG.
  3362
  3363     IF ATRMAVL GREATER THAN +0
  3364         MOVE ATRMAVI TO DEEDIT-FIELD
  3365         PERFORM 8600-DEEDIT
  3366         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3367             MOVE -1 TO ATRMAVL
  3368             MOVE AL-UNBON TO ATRMAVA
  3369             MOVE ER-2223 TO EMI-ERROR
  3370             PERFORM 9900-ERROR-FORMAT
  3371         ELSE
  3372             MOVE DEEDIT-FIELD-V1 TO WS-AH-TERM-AVG-WEIGHTED.
  3373
  3374     IF ALTAGPL GREATER THAN +0
  3375         MOVE ALTAGPI TO DEEDIT-FIELD
  3376         PERFORM 8600-DEEDIT
  3377         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3378             MOVE -1 TO ALTAGPL
  3379             MOVE AL-UNBON TO ALTAGPA
  3380             MOVE ER-2223 TO EMI-ERROR
  3381             PERFORM 9900-ERROR-FORMAT
  3382         ELSE
  3383             MOVE DEEDIT-FIELD-V1 TO WS-AH-LTM-AGE-PCT.
  3384
  3385     IF AAVAGWL GREATER THAN +0
  3386         MOVE AAVAGWI TO DEEDIT-FIELD
  3387         PERFORM 8600-DEEDIT
  3388         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3389             MOVE -1 TO AAVAGWL
  3390             MOVE AL-UNBON TO AAVAGWA
  3391             MOVE ER-2223 TO EMI-ERROR
  3392             PERFORM 9900-ERROR-FORMAT
  3393         ELSE
  3394             MOVE DEEDIT-FIELD-V1 TO WS-AH-AGE-AVG-WEIGHTED.
  3395
  3396     IF AAVAGML GREATER THAN +0
  3397         MOVE AAVAGMI TO DEEDIT-FIELD
  3398         PERFORM 8600-DEEDIT
  3399         IF DEEDIT-FIELD-V0  NOT NUMERIC
  3400             MOVE -1 TO AAVAGML
  3401             MOVE AL-UNBON TO AAVAGMA
  3402             MOVE ER-2223 TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL6041.cbl
  3403             PERFORM 9900-ERROR-FORMAT
  3404         ELSE
  3405             MOVE DEEDIT-FIELD-V0 TO WS-AH-AVG-AGE-MAX.
  3406
  3407     IF NOT EMI-NO-ERRORS
  3408        GO TO 8200-SEND-DATAONLY.
  3409
  3410 1200-ADD-REPORT-RECORD.
  3411
  3412* EXEC CICS GETMAIN
  3413*        SET       (ADDRESS OF CONTROL-FILE)
  3414*        LENGTH    (ELCNTL-LENGTH)
  3415*        INITIMG   (GETMAIN-SPACE)
  3416*    END-EXEC.
  3417*    MOVE ',"IL                  $   #00003357' TO DFHEIV0
  3418     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  3419     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3420     MOVE X'2020233030303033333537' TO DFHEIV0(25:11)
  3421     CALL 'kxdfhei1' USING DFHEIV0,
  3422           DFHEIV20,
  3423           ELCNTL-LENGTH,
  3424           GETMAIN-SPACE
  3425     SET ADDRESS OF CONTROL-FILE TO
  3426         DFHEIV20
  3427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3428
  3429
  3430     MOVE 'N'                   TO CF-ACCOUNTS-LT-ONE-YEAR.
  3431
  3432     MOVE ZEROS                 TO CF-ISS-COUNT-DIFF
  3433                                   CF-SINGLE-MO-PREM-PCT
  3434                                   CF-EARN-PREM-DECR-PCT
  3435                                   CF-CANCELLATION-RATIO
  3436                                   CF-RETENTION-LIMIT
  3437                                   CF-LF-LOSS-RATIO-PCT
  3438                                   CF-LF-LTM-LOSS-RATIO
  3439                                   CF-LF-PERIOD-PROFIT
  3440                                   CF-LF-LTM-PROFIT-PCT
  3441                                   CF-LF-LTM-INFORCE-DECR
  3442                                   CF-LF-LTM-TERM-CHG
  3443                                   CF-LF-TERM-AVG-WEIGHTED
  3444                                   CF-LF-LTM-AGE-PCT
  3445                                   CF-LF-AGE-AVG-WEIGHTED
  3446                                   CF-LF-AVG-AGE-MAX
  3447                                   CF-AH-LOSS-RATIO-PCT
  3448                                   CF-AH-LTM-LOSS-RATIO
  3449                                   CF-AH-PERIOD-PROFIT
  3450                                   CF-AH-LTM-PROFIT-PCT
  3451                                   CF-AH-LTM-INFORCE-DECR
  3452                                   CF-AH-LTM-TERM-CHG
  3453                                   CF-AH-TERM-AVG-WEIGHTED
  3454                                   CF-AH-LTM-AGE-PCT
  3455                                   CF-AH-AGE-AVG-WEIGHTED
  3456                                   CF-AH-AVG-AGE-MAX.
  3457
  3458 1500-BUILD-RECORD.
  3459
  3460     MOVE 'CF'                  TO CF-RECORD-ID
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL6041.cbl
  3461     MOVE PI-COMPANY-ID         TO CF-COMPANY-ID
  3462     MOVE 'C'                   TO CF-RECORD-TYPE
  3463     MOVE REPORTI               TO CF-CUSTOM-REPORT-NO
  3464     MOVE +0002                 TO CF-SEQUENCE-NO.
  3465
  3466     MOVE SAVE-BIN-DATE         TO CF-LAST-MAINT-DT
  3467     MOVE PI-PROCESSOR-ID       TO CF-LAST-MAINT-BY
  3468     MOVE EIBTIME               TO CF-LAST-MAINT-HHMMSS.
  3469
  3470     MOVE CF-CUSTOM-REPORT-NO          TO PI-LAST-REPORT
  3471                                          REPORTO.
  3472
  3473     IF CF-ISS-COUNT-DIFF NOT NUMERIC
  3474          MOVE ZEROS TO CF-ISS-COUNT-DIFF.
  3475
  3476     IF CF-SINGLE-MO-PREM-PCT NOT NUMERIC
  3477         MOVE ZEROS TO CF-SINGLE-MO-PREM-PCT.
  3478
  3479     IF CF-EARN-PREM-DECR-PCT NOT NUMERIC
  3480         MOVE ZEROS TO CF-SINGLE-MO-PREM-PCT.
  3481
  3482     IF CF-CANCELLATION-RATIO NOT NUMERIC
  3483         MOVE ZEROS TO CF-CANCELLATION-RATIO.
  3484
  3485     IF CF-RETENTION-LIMIT NOT NUMERIC
  3486          MOVE ZEROS TO CF-RETENTION-LIMIT.
  3487
  3488     IF CF-LF-LOSS-RATIO-PCT NOT NUMERIC
  3489         MOVE ZEROS TO CF-LF-LOSS-RATIO-PCT.
  3490
  3491     IF CF-LF-LTM-LOSS-RATIO NOT NUMERIC
  3492         MOVE ZEROS TO CF-LF-LTM-LOSS-RATIO.
  3493
  3494     IF CF-LF-PERIOD-PROFIT NOT NUMERIC
  3495         MOVE ZEROS TO CF-LF-PERIOD-PROFIT.
  3496
  3497     IF CF-LF-LTM-PROFIT-PCT NOT NUMERIC
  3498         MOVE ZEROS TO CF-LF-LTM-PROFIT-PCT.
  3499
  3500     IF CF-LF-LTM-INFORCE-DECR NOT NUMERIC
  3501         MOVE ZEROS TO CF-LF-LTM-INFORCE-DECR.
  3502
  3503     IF CF-LF-LTM-TERM-CHG NOT NUMERIC
  3504         MOVE ZEROS TO CF-LF-LTM-TERM-CHG.
  3505
  3506     IF CF-LF-TERM-AVG-WEIGHTED NOT NUMERIC
  3507         MOVE ZEROS TO CF-LF-TERM-AVG-WEIGHTED.
  3508
  3509     IF CF-LF-LTM-AGE-PCT NOT NUMERIC
  3510         MOVE ZEROS TO CF-LF-LTM-AGE-PCT.
  3511
  3512     IF CF-LF-AGE-AVG-WEIGHTED NOT NUMERIC
  3513         MOVE ZEROS TO CF-LF-AGE-AVG-WEIGHTED.
  3514
  3515     IF CF-LF-AVG-AGE-MAX NOT NUMERIC
  3516         MOVE ZEROS TO CF-LF-AVG-AGE-MAX.
  3517
  3518     IF CF-AH-LOSS-RATIO-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL6041.cbl
  3519         MOVE ZEROS TO CF-AH-LOSS-RATIO-PCT.
  3520
  3521     IF CF-AH-LTM-LOSS-RATIO NOT NUMERIC
  3522         MOVE ZEROS TO CF-AH-LTM-LOSS-RATIO.
  3523
  3524     IF CF-AH-PERIOD-PROFIT NOT NUMERIC
  3525         MOVE ZEROS TO CF-AH-PERIOD-PROFIT.
  3526
  3527     IF CF-AH-LTM-PROFIT-PCT NOT NUMERIC
  3528         MOVE ZEROS TO CF-AH-LTM-PROFIT-PCT.
  3529
  3530     IF CF-AH-LTM-INFORCE-DECR NOT NUMERIC
  3531         MOVE ZEROS TO CF-AH-LTM-INFORCE-DECR.
  3532
  3533     IF CF-AH-LTM-TERM-CHG NOT NUMERIC
  3534         MOVE ZEROS TO CF-AH-LTM-TERM-CHG.
  3535
  3536     IF CF-AH-TERM-AVG-WEIGHTED NOT NUMERIC
  3537         MOVE ZEROS TO CF-AH-TERM-AVG-WEIGHTED.
  3538
  3539     IF CF-AH-LTM-AGE-PCT NOT NUMERIC
  3540         MOVE ZEROS TO CF-AH-LTM-AGE-PCT.
  3541
  3542     IF CF-AH-AGE-AVG-WEIGHTED NOT NUMERIC
  3543         MOVE ZEROS TO CF-AH-AGE-AVG-WEIGHTED.
  3544
  3545     IF CF-AH-AVG-AGE-MAX NOT NUMERIC
  3546         MOVE ZEROS TO CF-AH-AVG-AGE-MAX.
  3547
  3548     IF LTONEYL GREATER THAN +0
  3549         MOVE LTONEYI TO  CF-ACCOUNTS-LT-ONE-YEAR.
  3550
  3551     IF ZERMPDL GREATER THAN +0
  3552         MOVE ZERMPDI TO  CF-ACCT-ZERO-MONTH-PRODUCTION.
  3553
  3554     IF ISSCNTL GREATER THAN +0
  3555         MOVE WS-ISS-COUNT-DIFF TO  CF-ISS-COUNT-DIFF.
  3556
  3557     IF SMPRMPL GREATER THAN +0
  3558         MOVE WS-SINGLE-MO-PREM-PCT TO  CF-SINGLE-MO-PREM-PCT.
  3559
  3560     IF EPRMDCL GREATER THAN +0
  3561         MOVE WS-EARN-PREM-DECLINE TO  CF-EARN-PREM-DECR-PCT.
  3562
  3563     IF CNCRATL GREATER THAN +0
  3564         MOVE WS-CANCELLATION-RATIO TO  CF-CANCELLATION-RATIO.
  3565
  3566     IF RETLIML GREATER THAN +0
  3567         MOVE WS-RETENTION-LIMIT TO CF-RETENTION-LIMIT.
  3568
  3569     IF LLSRATL GREATER THAN +0
  3570         MOVE WS-LF-LOSS-RATIO-PCT TO  CF-LF-LOSS-RATIO-PCT.
  3571
  3572     IF LLTLRSL GREATER THAN +0
  3573         MOVE WS-LF-LTM-LOSS-RATIO TO  CF-LF-LTM-LOSS-RATIO.
  3574
  3575     IF LPDPROL GREATER THAN +0
  3576         MOVE WS-LF-PERIOD-PROFIT TO  CF-LF-PERIOD-PROFIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL6041.cbl
  3577
  3578     IF LLTPRPL GREATER THAN +0
  3579         MOVE WS-LF-LTM-PROFIT-PCT TO  CF-LF-LTM-PROFIT-PCT.
  3580
  3581     IF LLTIDCL GREATER THAN +0
  3582         MOVE WS-LF-LTM-INFORCE-DECR TO CF-LF-LTM-INFORCE-DECR.
  3583
  3584     IF LLTTRML GREATER THAN +0
  3585         MOVE WS-LF-LTM-TERM-CHG TO  CF-LF-LTM-TERM-CHG.
  3586
  3587     IF LTRMAVL GREATER THAN +0
  3588         MOVE WS-LF-TERM-AVG-WEIGHTED
  3589                                 TO  CF-LF-TERM-AVG-WEIGHTED.
  3590
  3591     IF LLTAGPL GREATER THAN +0
  3592         MOVE WS-LF-LTM-AGE-PCT TO  CF-LF-LTM-AGE-PCT.
  3593
  3594     IF LAVAGWL GREATER THAN +0
  3595         MOVE WS-LF-AGE-AVG-WEIGHTED TO  CF-LF-AGE-AVG-WEIGHTED.
  3596
  3597     IF LAVAGML GREATER THAN +0
  3598         MOVE WS-LF-AVG-AGE-MAX TO  CF-LF-AVG-AGE-MAX.
  3599
  3600     IF ALSRATL GREATER THAN +0
  3601         MOVE WS-AH-LOSS-RATIO-PCT TO  CF-AH-LOSS-RATIO-PCT.
  3602
  3603     IF ALTLRSL GREATER THAN +0
  3604         MOVE WS-AH-LTM-LOSS-RATIO TO  CF-AH-LTM-LOSS-RATIO.
  3605
  3606     IF APDPROL GREATER THAN +0
  3607         MOVE WS-AH-PERIOD-PROFIT TO  CF-AH-PERIOD-PROFIT.
  3608
  3609     IF ALTPRPL GREATER THAN +0
  3610         MOVE WS-AH-LTM-PROFIT-PCT TO  CF-AH-LTM-PROFIT-PCT.
  3611
  3612     IF ALTIDCL GREATER THAN +0
  3613         MOVE WS-AH-LTM-INFORCE-DECR TO  CF-AH-LTM-INFORCE-DECR.
  3614
  3615     IF ALTTRML GREATER THAN +0
  3616         MOVE WS-AH-LTM-TERM-CHG TO  CF-AH-LTM-TERM-CHG.
  3617
  3618     IF ATRMAVL GREATER THAN +0
  3619         MOVE WS-AH-TERM-AVG-WEIGHTED
  3620                                 TO  CF-AH-TERM-AVG-WEIGHTED.
  3621
  3622     IF ALTAGPL GREATER THAN +0
  3623         MOVE WS-AH-LTM-AGE-PCT TO  CF-AH-LTM-AGE-PCT.
  3624
  3625     IF AAVAGWL GREATER THAN +0
  3626         MOVE WS-AH-AGE-AVG-WEIGHTED
  3627                                 TO  CF-AH-AGE-AVG-WEIGHTED.
  3628
  3629     IF AAVAGML GREATER THAN +0
  3630         MOVE WS-AH-AVG-AGE-MAX TO  CF-AH-AVG-AGE-MAX.
  3631
  3632     MOVE CF-LAST-MAINT-BY            TO PI-UPDATE-BY.
  3633     MOVE CF-LAST-MAINT-HHMMSS        TO PI-UPDATE-HHMMSS.
  3634
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL6041.cbl
  3635 1600-WRITE-REPORT-RECORD.
  3636
  3637
  3638* EXEC CICS WRITE
  3639*         DATASET(ELCNTL-FILE-ID)
  3640*         FROM   (CONTROL-FILE)
  3641*         RIDFLD (ELCNTL-KEY)
  3642*    END-EXEC.
  3643     MOVE LENGTH OF
  3644      CONTROL-FILE
  3645       TO DFHEIV11
  3646*    MOVE '&$ L                  ''   #00003570' TO DFHEIV0
  3647     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3648     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3649     MOVE X'2020233030303033353730' TO DFHEIV0(25:11)
  3650     CALL 'kxdfhei1' USING DFHEIV0,
  3651           ELCNTL-FILE-ID,
  3652           CONTROL-FILE,
  3653           DFHEIV11,
  3654           ELCNTL-KEY,
  3655           DFHEIV99,
  3656           DFHEIV99
  3657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3658
  3659
  3660     MOVE ER-0000      TO EMI-ERROR.
  3661     PERFORM 9900-ERROR-FORMAT.
  3662     GO TO 4000-SHOW-REPORT.
  3663
  3664 2000-CHANGE-REPORT.
  3665     IF REPORTI NOT NUMERIC
  3666        MOVE ER-7680            TO EMI-ERROR
  3667        MOVE -1                 TO REPORTL
  3668        MOVE AL-UNBON           TO REPORTA
  3669        PERFORM 9900-ERROR-FORMAT
  3670        GO TO 8200-SEND-DATAONLY.
  3671
  3672     IF REPORTI NOT = PI-LAST-REPORT
  3673        MOVE ER-0138            TO EMI-ERROR
  3674        MOVE -1                 TO REPORTL
  3675        MOVE AL-UNBON           TO REPORTA
  3676        PERFORM 9900-ERROR-FORMAT
  3677        GO TO 8200-SEND-DATAONLY.
  3678
  3679     MOVE SPACES                 TO ELCNTL-KEY
  3680     MOVE PI-COMPANY-ID          TO ELCNTL-COMPANY-ID.
  3681     MOVE 'C'                    TO ELCNTL-RECORD-TYPE.
  3682     MOVE REPORTI                TO ELCNTL-REPORT.
  3683     MOVE +0002                  TO ELCNTL-SEQ-NO.
  3684
  3685
  3686* EXEC CICS HANDLE CONDITION
  3687*         NOTFND     (2100-NOT-FOUND)
  3688*    END-EXEC.
  3689*    MOVE '"$I                   ! $ #00003601' TO DFHEIV0
  3690     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3691     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3692     MOVE X'2420233030303033363031' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL6041.cbl
  3693     CALL 'kxdfhei1' USING DFHEIV0
  3694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3695
  3696
  3697
  3698* EXEC CICS READ
  3699*         DATASET    (ELCNTL-FILE-ID)
  3700*         SET        (ADDRESS OF CONTROL-FILE)
  3701*         RIDFLD     (ELCNTL-KEY)
  3702*    END-EXEC.
  3703*    MOVE '&"S        E          (   #00003605' TO DFHEIV0
  3704     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3705     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3706     MOVE X'2020233030303033363035' TO DFHEIV0(25:11)
  3707     CALL 'kxdfhei1' USING DFHEIV0,
  3708           ELCNTL-FILE-ID,
  3709           DFHEIV20,
  3710           DFHEIV99,
  3711           ELCNTL-KEY,
  3712           DFHEIV99,
  3713           DFHEIV99,
  3714           DFHEIV99
  3715     SET ADDRESS OF CONTROL-FILE TO
  3716         DFHEIV20
  3717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3718
  3719
  3720     IF (CF-LAST-MAINT-BY NOT = PI-UPDATE-BY) OR
  3721        (CF-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS)
  3722        MOVE ER-0068          TO EMI-ERROR
  3723        MOVE -1               TO MAINTL
  3724        PERFORM 9900-ERROR-FORMAT
  3725        GO TO 8200-SEND-DATAONLY.
  3726
  3727     PERFORM 1100-EDIT-REPORT-SCREEN.
  3728
  3729     IF NOT EMI-NO-ERRORS
  3730        GO TO 8200-SEND-DATAONLY.
  3731
  3732
  3733* EXEC CICS READ
  3734*         DATASET    (ELCNTL-FILE-ID)
  3735*         SET        (ADDRESS OF CONTROL-FILE)
  3736*         RIDFLD     (ELCNTL-KEY)
  3737*         UPDATE
  3738*    END-EXEC.
  3739*    MOVE '&"S        EU         (   #00003623' TO DFHEIV0
  3740     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3741     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3742     MOVE X'2020233030303033363233' TO DFHEIV0(25:11)
  3743     CALL 'kxdfhei1' USING DFHEIV0,
  3744           ELCNTL-FILE-ID,
  3745           DFHEIV20,
  3746           DFHEIV99,
  3747           ELCNTL-KEY,
  3748           DFHEIV99,
  3749           DFHEIV99,
  3750           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL6041.cbl
  3751     SET ADDRESS OF CONTROL-FILE TO
  3752         DFHEIV20
  3753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3754
  3755
  3756     PERFORM 1500-BUILD-RECORD.
  3757
  3758     IF NOT EMI-NO-ERRORS
  3759
  3760* EXEC CICS UNLOCK
  3761*            DATASET   (ELCNTL-FILE-ID)
  3762*       END-EXEC
  3763*    MOVE '&*                    #   #00003633' TO DFHEIV0
  3764     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  3765     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3766     MOVE X'2020233030303033363333' TO DFHEIV0(25:11)
  3767     CALL 'kxdfhei1' USING DFHEIV0,
  3768           ELCNTL-FILE-ID,
  3769           DFHEIV99
  3770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3771        GO TO 8200-SEND-DATAONLY.
  3772
  3773
  3774* EXEC CICS REWRITE
  3775*         DATASET   (ELCNTL-FILE-ID)
  3776*         FROM      (CONTROL-FILE)
  3777*    END-EXEC.
  3778     MOVE LENGTH OF
  3779      CONTROL-FILE
  3780       TO DFHEIV11
  3781*    MOVE '&& L                  %   #00003638' TO DFHEIV0
  3782     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3783     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3784     MOVE X'2020233030303033363338' TO DFHEIV0(25:11)
  3785     CALL 'kxdfhei1' USING DFHEIV0,
  3786           ELCNTL-FILE-ID,
  3787           CONTROL-FILE,
  3788           DFHEIV11,
  3789           DFHEIV99
  3790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3791
  3792
  3793     MOVE ER-0000      TO EMI-ERROR.
  3794     PERFORM 9900-ERROR-FORMAT.
  3795     GO TO 4000-SHOW-REPORT.
  3796
  3797 2100-NOT-FOUND.
  3798     MOVE ER-0139              TO EMI-ERROR.
  3799     MOVE -1                   TO REPORTL.
  3800     MOVE AL-UNBON             TO REPORTA.
  3801     PERFORM 9900-ERROR-FORMAT.
  3802     GO TO 8200-SEND-DATAONLY.
  3803
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL6041.cbl
  3805
  3806 2500-DELETE-REPORT.
  3807     IF REPORTI NOT NUMERIC
  3808        MOVE ER-7680            TO EMI-ERROR
  3809        MOVE -1                 TO REPORTL
  3810        MOVE AL-UNBON           TO REPORTA
  3811        PERFORM 9900-ERROR-FORMAT
  3812        GO TO 8200-SEND-DATAONLY.
  3813
  3814     IF REPORTI NOT = PI-LAST-REPORT
  3815        MOVE ER-0138            TO EMI-ERROR
  3816        MOVE -1                 TO REPORTL
  3817        MOVE AL-UNBON           TO REPORTA
  3818        PERFORM 9900-ERROR-FORMAT
  3819        GO TO 8200-SEND-DATAONLY.
  3820
  3821
  3822* EXEC CICS HANDLE CONDITION
  3823*        NOTFND   (2890-NOT-FOUND)
  3824*    END-EXEC.
  3825*    MOVE '"$I                   ! % #00003671' TO DFHEIV0
  3826     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3827     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3828     MOVE X'2520233030303033363731' TO DFHEIV0(25:11)
  3829     CALL 'kxdfhei1' USING DFHEIV0
  3830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3831
  3832
  3833     MOVE SPACES                 TO ELCNTL-KEY.
  3834
  3835     MOVE PI-COMPANY-ID          TO ELCNTL-COMPANY-ID.
  3836     MOVE 'C'                    TO ELCNTL-RECORD-TYPE.
  3837     MOVE REPORTI                TO ELCNTL-REPORT.
  3838     MOVE +0002                  TO ELCNTL-SEQ-NO.
  3839
  3840
  3841* EXEC CICS DELETE
  3842*         DATASET   (ELCNTL-FILE-ID)
  3843*         RIDFLD    (ELCNTL-KEY)
  3844*    END-EXEC.
  3845*    MOVE '&(  R                 &   #00003682' TO DFHEIV0
  3846     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3847     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3848     MOVE X'2020233030303033363832' TO DFHEIV0(25:11)
  3849     CALL 'kxdfhei1' USING DFHEIV0,
  3850           ELCNTL-FILE-ID,
  3851           ELCNTL-KEY,
  3852           DFHEIV99,
  3853           DFHEIV99,
  3854           DFHEIV99
  3855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3856
  3857
  3858     MOVE LOW-VALUES TO EL6041AI.
  3859     MOVE ER-0000      TO EMI-ERROR.
  3860     PERFORM 9900-ERROR-FORMAT.
  3861     GO TO 8100-SEND-INITIAL-MAP.
  3862
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL6041.cbl
  3863 2890-NOT-FOUND.
  3864     MOVE  ER-0142               TO EMI-ERROR.
  3865     MOVE -1                     TO REPORTL.
  3866     MOVE AL-UNBON               TO REPORTA.
  3867     PERFORM 9900-ERROR-FORMAT.
  3868     GO TO 8200-SEND-DATAONLY.
  3869
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL6041.cbl
  3871 3000-COPY-REPORT.
  3872     IF REPORTL GREATER +0 AND
  3873        REPORTI NUMERIC
  3874        NEXT SENTENCE
  3875     ELSE
  3876        MOVE ER-7680     TO EMI-ERROR
  3877        MOVE -1          TO REPORTL
  3878        MOVE AL-UNBON    TO REPORTA
  3879        PERFORM 9900-ERROR-FORMAT
  3880        GO TO 8200-SEND-DATAONLY.
  3881
  3882     IF CPYRPTL GREATER +0 AND
  3883        CPYRPTI NUMERIC
  3884        NEXT SENTENCE
  3885     ELSE
  3886        MOVE ER-7680     TO EMI-ERROR
  3887        MOVE -1          TO CPYRPTL
  3888        MOVE AL-UNBON    TO CPYRPTA
  3889        PERFORM 9900-ERROR-FORMAT
  3890        GO TO 8200-SEND-DATAONLY.
  3891
  3892     MOVE SPACES            TO ELCNTL-KEY.
  3893     MOVE PI-COMPANY-ID     TO ELCNTL-COMPANY-ID.
  3894     MOVE REPORTI           TO ELCNTL-REPORT.
  3895     MOVE 'C'               TO ELCNTL-RECORD-TYPE.
  3896     MOVE +0002             TO ELCNTL-SEQ-NO.
  3897
  3898
  3899* EXEC CICS HANDLE CONDITION
  3900*         NOTFND     (3100-CONTINUE)
  3901*    END-EXEC.
  3902*    MOVE '"$I                   ! & #00003727' TO DFHEIV0
  3903     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3904     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3905     MOVE X'2620233030303033373237' TO DFHEIV0(25:11)
  3906     CALL 'kxdfhei1' USING DFHEIV0
  3907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3908
  3909
  3910
  3911* EXEC CICS READ
  3912*         DATASET    (ELCNTL-FILE-ID)
  3913*         RIDFLD     (ELCNTL-KEY)
  3914*         SET        (ADDRESS OF CONTROL-FILE)
  3915*    END-EXEC.
  3916*    MOVE '&"S        E          (   #00003731' TO DFHEIV0
  3917     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3918     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3919     MOVE X'2020233030303033373331' TO DFHEIV0(25:11)
  3920     CALL 'kxdfhei1' USING DFHEIV0,
  3921           ELCNTL-FILE-ID,
  3922           DFHEIV20,
  3923           DFHEIV99,
  3924           ELCNTL-KEY,
  3925           DFHEIV99,
  3926           DFHEIV99,
  3927           DFHEIV99
  3928     SET ADDRESS OF CONTROL-FILE TO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL6041.cbl
  3929         DFHEIV20
  3930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3931
  3932
  3933     MOVE -1                     TO REPORTL.
  3934     MOVE  ER-0132               TO  EMI-ERROR.
  3935     PERFORM 9900-ERROR-FORMAT.
  3936     GO TO 8200-SEND-DATAONLY.
  3937
  3938 3100-CONTINUE.
  3939     MOVE SPACES            TO ELCNTL-KEY.
  3940     MOVE PI-COMPANY-ID     TO ELCNTL-COMPANY-ID.
  3941     MOVE CPYRPTI           TO ELCNTL-REPORT.
  3942     MOVE 'C'               TO ELCNTL-RECORD-TYPE.
  3943     MOVE +0002             TO ELCNTL-SEQ-NO.
  3944
  3945
  3946* EXEC CICS HANDLE CONDITION
  3947*         NOTFND     (3900-NOT-FOUND)
  3948*    END-EXEC.
  3949*    MOVE '"$I                   ! '' #00003749' TO DFHEIV0
  3950     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3951     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3952     MOVE X'2720233030303033373439' TO DFHEIV0(25:11)
  3953     CALL 'kxdfhei1' USING DFHEIV0
  3954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3955
  3956
  3957
  3958* EXEC CICS READ
  3959*         DATASET    (ELCNTL-FILE-ID)
  3960*         RIDFLD     (ELCNTL-KEY)
  3961*         SET        (ADDRESS OF CONTROL-FILE)
  3962*    END-EXEC.
  3963*    MOVE '&"S        E          (   #00003753' TO DFHEIV0
  3964     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3965     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3966     MOVE X'2020233030303033373533' TO DFHEIV0(25:11)
  3967     CALL 'kxdfhei1' USING DFHEIV0,
  3968           ELCNTL-FILE-ID,
  3969           DFHEIV20,
  3970           DFHEIV99,
  3971           ELCNTL-KEY,
  3972           DFHEIV99,
  3973           DFHEIV99,
  3974           DFHEIV99
  3975     SET ADDRESS OF CONTROL-FILE TO
  3976         DFHEIV20
  3977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3978
  3979
  3980     MOVE SPACES            TO ELCNTL-KEY.
  3981     MOVE 'CF'                  TO CF-RECORD-ID
  3982     MOVE PI-COMPANY-ID         TO CF-COMPANY-ID
  3983                                   ELCNTL-COMPANY-ID.
  3984     MOVE 'C'                   TO CF-RECORD-TYPE
  3985                                   ELCNTL-RECORD-TYPE.
  3986     MOVE REPORTI               TO CF-CUSTOM-REPORT-NO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL6041.cbl
  3987                                   ELCNTL-REPORT.
  3988     MOVE +0002                 TO CF-SEQUENCE-NO
  3989                                   ELCNTL-SEQ-NO.
  3990
  3991     MOVE SAVE-BIN-DATE         TO CF-LAST-MAINT-DT
  3992     MOVE PI-PROCESSOR-ID       TO CF-LAST-MAINT-BY
  3993     MOVE EIBTIME               TO CF-LAST-MAINT-HHMMSS.
  3994
  3995     MOVE CF-CUSTOM-REPORT-NO          TO PI-LAST-REPORT
  3996                                          REPORTO.
  3997
  3998     MOVE CF-LAST-MAINT-BY            TO PI-UPDATE-BY.
  3999     MOVE CF-LAST-MAINT-HHMMSS        TO PI-UPDATE-HHMMSS.
  4000
  4001
  4002* EXEC CICS WRITE
  4003*         DATASET(ELCNTL-FILE-ID)
  4004*         FROM   (CONTROL-FILE)
  4005*         RIDFLD (ELCNTL-KEY)
  4006*    END-EXEC.
  4007     MOVE LENGTH OF
  4008      CONTROL-FILE
  4009       TO DFHEIV11
  4010*    MOVE '&$ L                  ''   #00003780' TO DFHEIV0
  4011     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4012     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4013     MOVE X'2020233030303033373830' TO DFHEIV0(25:11)
  4014     CALL 'kxdfhei1' USING DFHEIV0,
  4015           ELCNTL-FILE-ID,
  4016           CONTROL-FILE,
  4017           DFHEIV11,
  4018           ELCNTL-KEY,
  4019           DFHEIV99,
  4020           DFHEIV99
  4021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4022
  4023
  4024     MOVE ER-0000      TO EMI-ERROR.
  4025     PERFORM 9900-ERROR-FORMAT.
  4026     GO TO 4000-SHOW-REPORT.
  4027
  4028 3900-NOT-FOUND.
  4029     MOVE  ER-0142               TO EMI-ERROR.
  4030     MOVE -1                     TO CPYRPTL.
  4031     MOVE AL-UNBON               TO CPYRPTA.
  4032     PERFORM 9900-ERROR-FORMAT.
  4033     GO TO 8200-SEND-DATAONLY.
  4034
  4035 4000-SHOW-REPORT.
  4036     IF MAINTI = 'S'
  4037        IF REPORTL GREATER THAN +0 AND
  4038           REPORTI NUMERIC
  4039           NEXT SENTENCE
  4040        ELSE
  4041           MOVE ER-7680     TO EMI-ERROR
  4042           MOVE -1          TO REPORTL
  4043           MOVE AL-UNBON    TO REPORTA
  4044           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL6041.cbl
  4045           GO TO 8200-SEND-DATAONLY.
  4046
  4047     IF MAINTI = 'S'
  4048        MOVE SPACES              TO ELCNTL-KEY
  4049        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  4050        MOVE 'C'                 TO ELCNTL-RECORD-TYPE
  4051        MOVE REPORTI             TO ELCNTL-REPORT
  4052        MOVE +0002               TO ELCNTL-SEQ-NO.
  4053
  4054
  4055* EXEC CICS HANDLE CONDITION
  4056*         NOTFND     (4100-NOT-FOUND)
  4057*    END-EXEC.
  4058*    MOVE '"$I                   ! ( #00003816' TO DFHEIV0
  4059     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4060     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4061     MOVE X'2820233030303033383136' TO DFHEIV0(25:11)
  4062     CALL 'kxdfhei1' USING DFHEIV0
  4063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4064
  4065
  4066
  4067* EXEC CICS READ
  4068*         DATASET     (ELCNTL-FILE-ID)
  4069*         RIDFLD      (ELCNTL-KEY)
  4070*         SET         (ADDRESS OF CONTROL-FILE)
  4071*    END-EXEC.
  4072*    MOVE '&"S        E          (   #00003820' TO DFHEIV0
  4073     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4074     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4075     MOVE X'2020233030303033383230' TO DFHEIV0(25:11)
  4076     CALL 'kxdfhei1' USING DFHEIV0,
  4077           ELCNTL-FILE-ID,
  4078           DFHEIV20,
  4079           DFHEIV99,
  4080           ELCNTL-KEY,
  4081           DFHEIV99,
  4082           DFHEIV99,
  4083           DFHEIV99
  4084     SET ADDRESS OF CONTROL-FILE TO
  4085         DFHEIV20
  4086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4087
  4088
  4089     MOVE LOW-VALUES                   TO EL6041AI.
  4090
  4091     MOVE CF-CUSTOM-REPORT-NO          TO PI-LAST-REPORT
  4092                                          REPORTO.
  4093
  4094     MOVE CF-ACCOUNTS-LT-ONE-YEAR       TO  LTONEYO.
  4095     MOVE CF-ACCT-ZERO-MONTH-PRODUCTION TO  ZERMPDO.
  4096     MOVE CF-ISS-COUNT-DIFF            TO  ISSCNTO.
  4097     MOVE CF-SINGLE-MO-PREM-PCT        TO  SMPRMPO.
  4098     MOVE CF-EARN-PREM-DECR-PCT        TO  EPRMDCO.
  4099     MOVE CF-CANCELLATION-RATIO        TO  CNCRATO.
  4100
  4101     IF CF-RETENTION-LIMIT NUMERIC
  4102         MOVE CF-RETENTION-LIMIT       TO  RETLIMO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL6041.cbl
  4103
  4104     MOVE CF-LF-LOSS-RATIO-PCT         TO  LLSRATO.
  4105     MOVE CF-LF-LTM-LOSS-RATIO         TO  LLTLRSO.
  4106     MOVE CF-LF-PERIOD-PROFIT          TO  LPDPROO.
  4107     MOVE CF-LF-LTM-PROFIT-PCT         TO  LLTPRPO.
  4108     MOVE CF-LF-LTM-INFORCE-DECR       TO  LLTIDCO.
  4109     MOVE CF-LF-LTM-TERM-CHG           TO  LLTTRMO.
  4110     MOVE CF-LF-TERM-AVG-WEIGHTED      TO  LTRMAVO.
  4111     MOVE CF-LF-LTM-AGE-PCT            TO  LLTAGPO.
  4112     MOVE CF-LF-AGE-AVG-WEIGHTED       TO  LAVAGWO.
  4113     MOVE CF-LF-AVG-AGE-MAX            TO  LAVAGMO.
  4114
  4115     MOVE CF-AH-LOSS-RATIO-PCT         TO  ALSRATO.
  4116     MOVE CF-AH-LTM-LOSS-RATIO         TO  ALTLRSO.
  4117     MOVE CF-AH-PERIOD-PROFIT          TO  APDPROO.
  4118     MOVE CF-AH-LTM-PROFIT-PCT         TO  ALTPRPO.
  4119     MOVE CF-AH-LTM-INFORCE-DECR       TO  ALTIDCO.
  4120     MOVE CF-AH-LTM-TERM-CHG           TO  ALTTRMO.
  4121     MOVE CF-AH-TERM-AVG-WEIGHTED      TO  ATRMAVO.
  4122     MOVE CF-AH-LTM-AGE-PCT            TO  ALTAGPO.
  4123     MOVE CF-AH-AGE-AVG-WEIGHTED       TO  AAVAGWO.
  4124     MOVE CF-AH-AVG-AGE-MAX            TO  AAVAGMO.
  4125
  4126     MOVE CF-LAST-MAINT-BY            TO PI-UPDATE-BY.
  4127     MOVE CF-LAST-MAINT-HHMMSS        TO PI-UPDATE-HHMMSS.
  4128
  4129     GO TO 8100-SEND-INITIAL-MAP.
  4130
  4131 4100-NOT-FOUND.
  4132     MOVE  ER-0142               TO EMI-ERROR.
  4133     MOVE -1                     TO REPORTL.
  4134     MOVE AL-UNBON               TO REPORTA.
  4135     PERFORM 9900-ERROR-FORMAT.
  4136     GO TO 8200-SEND-DATAONLY.
  4137
  4138 5000-VERIFY-CARRIER.
  4139
  4140* EXEC CICS HANDLE CONDITION
  4141*         NOTFND    (5010-NOT-FOUND)
  4142*         ENDFILE   (5010-NOT-FOUND)
  4143*    END-EXEC.
  4144*    MOVE '"$I''                  ! ) #00003876' TO DFHEIV0
  4145     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4146     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4147     MOVE X'2920233030303033383736' TO DFHEIV0(25:11)
  4148     CALL 'kxdfhei1' USING DFHEIV0
  4149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4150
  4151
  4152     MOVE SPACES TO ELCNTL-TEST-KEY.
  4153     MOVE PI-COMPANY-ID      TO ELCNTL-TEST-COMP-ID.
  4154     MOVE '6'                TO ELCNTL-TEST-REC-TYPE.
  4155     MOVE WS-TEST-CARRIER    TO ELCNTL-TEST-CAR.
  4156     MOVE +0                 TO ELCNTL-TEST-SEQ-NO.
  4157
  4158
  4159* EXEC CICS READ
  4160*         DATASET    (ELCNTL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL6041.cbl
  4161*         RIDFLD     (ELCNTL-TEST-KEY)
  4162*         SET        (ADDRESS OF CONTROL-FILE)
  4163*    END-EXEC.
  4164*    MOVE '&"S        E          (   #00003887' TO DFHEIV0
  4165     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4166     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4167     MOVE X'2020233030303033383837' TO DFHEIV0(25:11)
  4168     CALL 'kxdfhei1' USING DFHEIV0,
  4169           ELCNTL-FILE-ID,
  4170           DFHEIV20,
  4171           DFHEIV99,
  4172           ELCNTL-TEST-KEY,
  4173           DFHEIV99,
  4174           DFHEIV99,
  4175           DFHEIV99
  4176     SET ADDRESS OF CONTROL-FILE TO
  4177         DFHEIV20
  4178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4179
  4180
  4181     GO TO 5019-EXIT.
  4182
  4183 5010-NOT-FOUND.
  4184     MOVE ER-2845           TO EMI-ERROR
  4185     MOVE -1                TO WS-TEST-LEN.
  4186     MOVE AL-UNBON          TO WS-TEST-ATTRB.
  4187     PERFORM 9900-ERROR-FORMAT.
  4188
  4189 5019-EXIT.
  4190     EXIT.
  4191
  4192 5020-VERIFY-STATE.
  4193
  4194* EXEC CICS HANDLE CONDITION
  4195*         NOTFND    (5030-NOT-FOUND)
  4196*         ENDFILE   (5030-NOT-FOUND)
  4197*    END-EXEC.
  4198*    MOVE '"$I''                  ! * #00003905' TO DFHEIV0
  4199     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4200     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4201     MOVE X'2A20233030303033393035' TO DFHEIV0(25:11)
  4202     CALL 'kxdfhei1' USING DFHEIV0
  4203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4204
  4205
  4206     MOVE SPACES TO ELCNTL-TEST-KEY.
  4207     MOVE PI-COMPANY-ID      TO ELCNTL-TEST-COMP-ID.
  4208     MOVE '3'                TO ELCNTL-TEST-REC-TYPE.
  4209     MOVE WS-TEST-STATE      TO ELCNTL-TEST-STATE.
  4210     MOVE +0                 TO ELCNTL-TEST-SEQ-NO.
  4211
  4212
  4213* EXEC CICS READ
  4214*         DATASET    (ELCNTL-FILE-ID)
  4215*         RIDFLD     (ELCNTL-TEST-KEY)
  4216*         SET        (ADDRESS OF CONTROL-FILE)
  4217*    END-EXEC.
  4218*    MOVE '&"S        E          (   #00003916' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL6041.cbl
  4219     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4220     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4221     MOVE X'2020233030303033393136' TO DFHEIV0(25:11)
  4222     CALL 'kxdfhei1' USING DFHEIV0,
  4223           ELCNTL-FILE-ID,
  4224           DFHEIV20,
  4225           DFHEIV99,
  4226           ELCNTL-TEST-KEY,
  4227           DFHEIV99,
  4228           DFHEIV99,
  4229           DFHEIV99
  4230     SET ADDRESS OF CONTROL-FILE TO
  4231         DFHEIV20
  4232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4233
  4234
  4235     GO TO 5039-EXIT.
  4236
  4237 5030-NOT-FOUND.
  4238     MOVE ER-2848           TO EMI-ERROR
  4239     MOVE -1                TO WS-TEST-LEN.
  4240     MOVE AL-UNBON          TO WS-TEST-ATTRB.
  4241     PERFORM 9900-ERROR-FORMAT.
  4242
  4243 5039-EXIT.
  4244     EXIT.
  4245
  4246 5040-VERIFY-BEN.
  4247     IF WS-TEST-BEN = SPACES
  4248         GO TO 5059-EXIT.
  4249
  4250     MOVE SPACES TO WS-BROWSE-SW.
  4251
  4252
  4253* EXEC CICS HANDLE CONDITION
  4254*         NOTFND    (5050-NOT-FOUND)
  4255*         ENDFILE   (5050-NOT-FOUND)
  4256*    END-EXEC.
  4257*    MOVE '"$I''                  ! + #00003939' TO DFHEIV0
  4258     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4259     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4260     MOVE X'2B20233030303033393339' TO DFHEIV0(25:11)
  4261     CALL 'kxdfhei1' USING DFHEIV0
  4262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4263
  4264
  4265     MOVE PI-COMPANY-ID      TO ELCNTL-TEST-COMP-ID.
  4266     MOVE WS-TEST-BEN        TO ELCNTL-TEST-BEN.
  4267     MOVE +0                 TO ELCNTL-TEST-SEQ-NO.
  4268
  4269
  4270* EXEC CICS STARTBR
  4271*         DATASET    (ELCNTL-FILE-ID)
  4272*         RIDFLD     (ELCNTL-TEST-KEY)
  4273*    END-EXEC.
  4274     MOVE 0
  4275       TO DFHEIV11
  4276*    MOVE '&,         G          &   #00003948' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL6041.cbl
  4277     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4278     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4279     MOVE X'2020233030303033393438' TO DFHEIV0(25:11)
  4280     CALL 'kxdfhei1' USING DFHEIV0,
  4281           ELCNTL-FILE-ID,
  4282           ELCNTL-TEST-KEY,
  4283           DFHEIV99,
  4284           DFHEIV11,
  4285           DFHEIV99
  4286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4287
  4288
  4289     MOVE 'Y'    TO WS-BROWSE-SW.
  4290
  4291
  4292* EXEC CICS READNEXT
  4293*         DATASET    (ELCNTL-FILE-ID)
  4294*         RIDFLD     (ELCNTL-TEST-KEY)
  4295*         SET        (ADDRESS OF CONTROL-FILE)
  4296*    END-EXEC.
  4297     MOVE 0
  4298       TO DFHEIV11
  4299*    MOVE '&.S                   )   #00003955' TO DFHEIV0
  4300     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4301     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4302     MOVE X'2020233030303033393535' TO DFHEIV0(25:11)
  4303     CALL 'kxdfhei1' USING DFHEIV0,
  4304           ELCNTL-FILE-ID,
  4305           DFHEIV20,
  4306           DFHEIV99,
  4307           ELCNTL-TEST-KEY,
  4308           DFHEIV99,
  4309           DFHEIV11,
  4310           DFHEIV99,
  4311           DFHEIV99
  4312     SET ADDRESS OF CONTROL-FILE TO
  4313         DFHEIV20
  4314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4315
  4316
  4317     MOVE +1  TO WS-SUB.
  4318
  4319 5041-SEARCH-BEN-TYPE.
  4320     IF WS-SUB  GREATER THAN +8
  4321        GO TO 5050-NOT-FOUND.
  4322
  4323     IF CF-BENEFIT-CODE (WS-SUB) = WS-TEST-BEN
  4324        GO TO 5055-ENDBR
  4325     ELSE
  4326        ADD +1 TO WS-SUB
  4327        GO TO 5041-SEARCH-BEN-TYPE.
  4328
  4329 5050-NOT-FOUND.
  4330     MOVE ER-7685           TO EMI-ERROR
  4331     MOVE -1                TO WS-TEST-LEN.
  4332     MOVE AL-UNBON          TO WS-TEST-ATTRB.
  4333     PERFORM 9900-ERROR-FORMAT.
  4334
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL6041.cbl
  4335 5055-ENDBR.
  4336     IF WS-BROWSE-SW = 'Y'
  4337
  4338* EXEC CICS ENDBR
  4339*            DATASET    (ELCNTL-FILE-ID)
  4340*       END-EXEC.
  4341     MOVE 0
  4342       TO DFHEIV11
  4343*    MOVE '&2                    $   #00003981' TO DFHEIV0
  4344     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4345     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4346     MOVE X'2020233030303033393831' TO DFHEIV0(25:11)
  4347     CALL 'kxdfhei1' USING DFHEIV0,
  4348           ELCNTL-FILE-ID,
  4349           DFHEIV11,
  4350           DFHEIV99
  4351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4352
  4353
  4354 5059-EXIT.
  4355     EXIT.
  4356
  4357 5060-VERIFY-BUS-TYPE.
  4358     MOVE SPACES TO WS-BROWSE-SW.
  4359
  4360
  4361* EXEC CICS HANDLE CONDITION
  4362*         NOTFND    (5070-NOT-FOUND)
  4363*         ENDFILE   (5070-NOT-FOUND)
  4364*    END-EXEC.
  4365*    MOVE '"$I''                  ! , #00003991' TO DFHEIV0
  4366     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4367     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4368     MOVE X'2C20233030303033393931' TO DFHEIV0(25:11)
  4369     CALL 'kxdfhei1' USING DFHEIV0
  4370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4371
  4372
  4373     MOVE SPACES             TO ELCNTL-TEST-KEY.
  4374     MOVE PI-COMPANY-ID      TO ELCNTL-TEST-COMP-ID.
  4375     MOVE '8'                TO ELCNTL-TEST-REC-TYPE.
  4376     MOVE WS-TEST-BUSTYP     TO ELCNTL-TEST-BUSTYP.
  4377     MOVE +0                 TO ELCNTL-TEST-SEQ-NO.
  4378
  4379
  4380* EXEC CICS STARTBR
  4381*         DATASET    (ELCNTL-FILE-ID)
  4382*         RIDFLD     (ELCNTL-TEST-KEY)
  4383*    END-EXEC.
  4384     MOVE 0
  4385       TO DFHEIV11
  4386*    MOVE '&,         G          &   #00004002' TO DFHEIV0
  4387     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4388     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4389     MOVE X'2020233030303034303032' TO DFHEIV0(25:11)
  4390     CALL 'kxdfhei1' USING DFHEIV0,
  4391           ELCNTL-FILE-ID,
  4392           ELCNTL-TEST-KEY,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL6041.cbl
  4393           DFHEIV99,
  4394           DFHEIV11,
  4395           DFHEIV99
  4396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4397
  4398
  4399     MOVE 'Y' TO WS-BROWSE-SW.
  4400
  4401
  4402* EXEC CICS READNEXT
  4403*         DATASET    (ELCNTL-FILE-ID)
  4404*         RIDFLD     (ELCNTL-TEST-KEY)
  4405*         SET        (ADDRESS OF CONTROL-FILE)
  4406*    END-EXEC.
  4407     MOVE 0
  4408       TO DFHEIV11
  4409*    MOVE '&.S                   )   #00004009' TO DFHEIV0
  4410     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4411     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4412     MOVE X'2020233030303034303039' TO DFHEIV0(25:11)
  4413     CALL 'kxdfhei1' USING DFHEIV0,
  4414           ELCNTL-FILE-ID,
  4415           DFHEIV20,
  4416           DFHEIV99,
  4417           ELCNTL-TEST-KEY,
  4418           DFHEIV99,
  4419           DFHEIV11,
  4420           DFHEIV99,
  4421           DFHEIV99
  4422     SET ADDRESS OF CONTROL-FILE TO
  4423         DFHEIV20
  4424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4425
  4426
  4427     COMPUTE WS-SUB = WS-TEST-BUSTYP -
  4428                    (ELCNTL-TEST-BUSTYP - 20).
  4429
  4430     IF ELCNTL-TEST-BUSTYP = 99
  4431        SUBTRACT +1 FROM WS-SUB.
  4432
  4433     IF CF-BUSINESS-TITLE (WS-SUB) = SPACES
  4434        GO TO 5070-NOT-FOUND.
  4435
  4436     GO TO 5075-ENDBR.
  4437
  4438 5070-NOT-FOUND.
  4439
  4440     MOVE ER-2178           TO EMI-ERROR
  4441     MOVE -1                TO WS-TEST-LEN.
  4442     MOVE AL-UNBON          TO WS-TEST-ATTRB.
  4443     PERFORM 9900-ERROR-FORMAT.
  4444
  4445 5075-ENDBR.
  4446     IF WS-BROWSE-SW = 'Y'
  4447
  4448* EXEC CICS ENDBR
  4449*            DATASET    (ELCNTL-FILE-ID)
  4450*       END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL6041.cbl
  4451     MOVE 0
  4452       TO DFHEIV11
  4453*    MOVE '&2                    $   #00004035' TO DFHEIV0
  4454     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4455     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4456     MOVE X'2020233030303034303335' TO DFHEIV0(25:11)
  4457     CALL 'kxdfhei1' USING DFHEIV0,
  4458           ELCNTL-FILE-ID,
  4459           DFHEIV11,
  4460           DFHEIV99
  4461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4462
  4463
  4464 5079-EXIT.
  4465     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL6041.cbl
  4467
  4468 7000-BROWSE-FWRD-NEXT-ACCOUNT.
  4469     MOVE SPACES            TO ELCNTL-KEY.
  4470     MOVE PI-COMPANY-ID     TO ELCNTL-COMPANY-ID.
  4471     MOVE 'C'               TO ELCNTL-RECORD-TYPE.
  4472     MOVE +0003             TO ELCNTL-SEQ-NO.
  4473
  4474     IF REPORTL GREATER THAN +0
  4475        MOVE REPORTI            TO ELCNTL-REPORT
  4476     ELSE
  4477        MOVE ZEROS              TO ELCNTL-REPORT.
  4478
  4479     MOVE 'N'                    TO WS-REPORT-FOUND-SW.
  4480
  4481
  4482* EXEC CICS HANDLE CONDITION
  4483*        NOTFND   (7080-END-OF-SEARCH)
  4484*    END-EXEC.
  4485*    MOVE '"$I                   ! - #00004056' TO DFHEIV0
  4486     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4487     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4488     MOVE X'2D20233030303034303536' TO DFHEIV0(25:11)
  4489     CALL 'kxdfhei1' USING DFHEIV0
  4490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4491
  4492
  4493
  4494* EXEC CICS STARTBR
  4495*        DATASET  (ELCNTL-FILE-ID)
  4496*        RIDFLD   (ELCNTL-KEY)
  4497*    END-EXEC.
  4498     MOVE 0
  4499       TO DFHEIV11
  4500*    MOVE '&,         G          &   #00004060' TO DFHEIV0
  4501     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4502     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4503     MOVE X'2020233030303034303630' TO DFHEIV0(25:11)
  4504     CALL 'kxdfhei1' USING DFHEIV0,
  4505           ELCNTL-FILE-ID,
  4506           ELCNTL-KEY,
  4507           DFHEIV99,
  4508           DFHEIV11,
  4509           DFHEIV99
  4510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4511
  4512
  4513
  4514* EXEC CICS HANDLE CONDITION
  4515*        NOTFND   (7070-END-OF-BROWSE)
  4516*        ENDFILE  (7070-END-OF-BROWSE)
  4517*    END-EXEC.
  4518*    MOVE '"$I''                  ! . #00004065' TO DFHEIV0
  4519     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4520     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4521     MOVE X'2E20233030303034303635' TO DFHEIV0(25:11)
  4522     CALL 'kxdfhei1' USING DFHEIV0
  4523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4524
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL6041.cbl
  4525
  4526 7010-READ-FWRD-NEXT-RECORD.
  4527
  4528* EXEC CICS READNEXT
  4529*        DATASET  (ELCNTL-FILE-ID)
  4530*        RIDFLD   (ELCNTL-KEY)
  4531*        SET      (ADDRESS OF CONTROL-FILE)
  4532*    END-EXEC.
  4533     MOVE 0
  4534       TO DFHEIV11
  4535*    MOVE '&.S                   )   #00004071' TO DFHEIV0
  4536     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4537     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4538     MOVE X'2020233030303034303731' TO DFHEIV0(25:11)
  4539     CALL 'kxdfhei1' USING DFHEIV0,
  4540           ELCNTL-FILE-ID,
  4541           DFHEIV20,
  4542           DFHEIV99,
  4543           ELCNTL-KEY,
  4544           DFHEIV99,
  4545           DFHEIV11,
  4546           DFHEIV99,
  4547           DFHEIV99
  4548     SET ADDRESS OF CONTROL-FILE TO
  4549         DFHEIV20
  4550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4551
  4552
  4553     IF ELCNTL-COMPANY-ID = PI-COMPANY-ID AND
  4554        ELCNTL-RECORD-TYPE = 'C'
  4555        NEXT SENTENCE
  4556     ELSE
  4557        GO TO 7070-END-OF-BROWSE.
  4558
  4559     IF ELCNTL-SEQ-NO = +0002
  4560        NEXT SENTENCE
  4561     ELSE
  4562        GO TO 7010-READ-FWRD-NEXT-RECORD.
  4563
  4564     MOVE 'Y'                    TO WS-REPORT-FOUND-SW.
  4565
  4566 7070-END-OF-BROWSE.
  4567
  4568* EXEC CICS ENDBR
  4569*        DATASET  (ELCNTL-FILE-ID)
  4570*    END-EXEC.
  4571     MOVE 0
  4572       TO DFHEIV11
  4573*    MOVE '&2                    $   #00004091' TO DFHEIV0
  4574     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4575     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4576     MOVE X'2020233030303034303931' TO DFHEIV0(25:11)
  4577     CALL 'kxdfhei1' USING DFHEIV0,
  4578           ELCNTL-FILE-ID,
  4579           DFHEIV11,
  4580           DFHEIV99
  4581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4582
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL6041.cbl
  4583
  4584      IF REPORT-WAS-NOT-FOUND
  4585         NEXT SENTENCE
  4586      ELSE
  4587         GO TO 7090-EXIT.
  4588
  4589 7080-END-OF-SEARCH.
  4590     MOVE -1                     TO MAINTL.
  4591     MOVE  ER-2237               TO EMI-ERROR.
  4592     PERFORM 9900-ERROR-FORMAT.
  4593     GO TO 8200-SEND-DATAONLY.
  4594
  4595 7090-EXIT.
  4596     EXIT.
  4597
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL6041.cbl
  4599 7100-BROWSE-BWRD-NEXT-ACCOUNT.
  4600     MOVE 'N'                    TO WS-REPORT-FOUND-SW.
  4601
  4602     MOVE SPACES                 TO ELCNTL-KEY.
  4603     MOVE PI-COMPANY-ID          TO ELCNTL-COMPANY-ID.
  4604     MOVE 'C'                    TO ELCNTL-RECORD-TYPE.
  4605     MOVE +0                     TO ELCNTL-SEQ-NO.
  4606
  4607     IF REPORTL GREATER THAN +0
  4608        MOVE REPORTI            TO ELCNTL-REPORT
  4609     ELSE
  4610        MOVE PI-LAST-REPORT     TO ELCNTL-REPORT.
  4611
  4612
  4613* EXEC CICS HANDLE CONDITION
  4614*        NOTFND   (7180-END-OF-SEARCH)
  4615*    END-EXEC.
  4616*    MOVE '"$I                   ! / #00004123' TO DFHEIV0
  4617     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4618     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4619     MOVE X'2F20233030303034313233' TO DFHEIV0(25:11)
  4620     CALL 'kxdfhei1' USING DFHEIV0
  4621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4622
  4623
  4624
  4625* EXEC CICS STARTBR
  4626*        DATASET  (ELCNTL-FILE-ID)
  4627*        RIDFLD   (ELCNTL-KEY)
  4628*    END-EXEC.
  4629     MOVE 0
  4630       TO DFHEIV11
  4631*    MOVE '&,         G          &   #00004127' TO DFHEIV0
  4632     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4633     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4634     MOVE X'2020233030303034313237' TO DFHEIV0(25:11)
  4635     CALL 'kxdfhei1' USING DFHEIV0,
  4636           ELCNTL-FILE-ID,
  4637           ELCNTL-KEY,
  4638           DFHEIV99,
  4639           DFHEIV11,
  4640           DFHEIV99
  4641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4642
  4643
  4644
  4645* EXEC CICS HANDLE CONDITION
  4646*        NOTFND   (7170-END-OF-BROWSE)
  4647*        ENDFILE  (7170-END-OF-BROWSE)
  4648*    END-EXEC.
  4649*    MOVE '"$I''                  ! 0 #00004132' TO DFHEIV0
  4650     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4651     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4652     MOVE X'3020233030303034313332' TO DFHEIV0(25:11)
  4653     CALL 'kxdfhei1' USING DFHEIV0
  4654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4655
  4656
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL6041.cbl
  4657 7110-READ-FWRD-NEXT-RECORD.
  4658
  4659* EXEC CICS READNEXT
  4660*        DATASET  (ELCNTL-FILE-ID)
  4661*        RIDFLD   (ELCNTL-KEY)
  4662*        SET      (ADDRESS OF CONTROL-FILE)
  4663*    END-EXEC.
  4664     MOVE 0
  4665       TO DFHEIV11
  4666*    MOVE '&.S                   )   #00004138' TO DFHEIV0
  4667     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4668     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4669     MOVE X'2020233030303034313338' TO DFHEIV0(25:11)
  4670     CALL 'kxdfhei1' USING DFHEIV0,
  4671           ELCNTL-FILE-ID,
  4672           DFHEIV20,
  4673           DFHEIV99,
  4674           ELCNTL-KEY,
  4675           DFHEIV99,
  4676           DFHEIV11,
  4677           DFHEIV99,
  4678           DFHEIV99
  4679     SET ADDRESS OF CONTROL-FILE TO
  4680         DFHEIV20
  4681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4682
  4683
  4684
  4685* EXEC CICS READPREV
  4686*        DATASET  (ELCNTL-FILE-ID)
  4687*        RIDFLD   (ELCNTL-KEY)
  4688*        SET      (ADDRESS OF CONTROL-FILE)
  4689*    END-EXEC.
  4690     MOVE 0
  4691       TO DFHEIV11
  4692*    MOVE '&0S                   )   #00004144' TO DFHEIV0
  4693     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4694     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4695     MOVE X'2020233030303034313434' TO DFHEIV0(25:11)
  4696     CALL 'kxdfhei1' USING DFHEIV0,
  4697           ELCNTL-FILE-ID,
  4698           DFHEIV20,
  4699           DFHEIV99,
  4700           ELCNTL-KEY,
  4701           DFHEIV99,
  4702           DFHEIV11,
  4703           DFHEIV99,
  4704           DFHEIV99
  4705     SET ADDRESS OF CONTROL-FILE TO
  4706         DFHEIV20
  4707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4708
  4709
  4710 7110-READ-BWRD-NEXT-RECORD.
  4711
  4712* EXEC CICS READPREV
  4713*        DATASET  (ELCNTL-FILE-ID)
  4714*        RIDFLD   (ELCNTL-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL6041.cbl
  4715*        SET      (ADDRESS OF CONTROL-FILE)
  4716*    END-EXEC.
  4717     MOVE 0
  4718       TO DFHEIV11
  4719*    MOVE '&0S                   )   #00004151' TO DFHEIV0
  4720     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4721     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4722     MOVE X'2020233030303034313531' TO DFHEIV0(25:11)
  4723     CALL 'kxdfhei1' USING DFHEIV0,
  4724           ELCNTL-FILE-ID,
  4725           DFHEIV20,
  4726           DFHEIV99,
  4727           ELCNTL-KEY,
  4728           DFHEIV99,
  4729           DFHEIV11,
  4730           DFHEIV99,
  4731           DFHEIV99
  4732     SET ADDRESS OF CONTROL-FILE TO
  4733         DFHEIV20
  4734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4735
  4736
  4737     IF ELCNTL-COMPANY-ID = PI-COMPANY-ID AND
  4738        ELCNTL-RECORD-TYPE = 'C'
  4739        NEXT SENTENCE
  4740     ELSE
  4741        GO TO 7170-END-OF-BROWSE.
  4742
  4743     IF ELCNTL-SEQ-NO = +0002
  4744        NEXT SENTENCE
  4745     ELSE
  4746        GO TO 7110-READ-BWRD-NEXT-RECORD.
  4747
  4748     MOVE 'Y'                    TO WS-REPORT-FOUND-SW.
  4749
  4750 7170-END-OF-BROWSE.
  4751
  4752* EXEC CICS ENDBR
  4753*        DATASET  (ELCNTL-FILE-ID)
  4754*    END-EXEC.
  4755     MOVE 0
  4756       TO DFHEIV11
  4757*    MOVE '&2                    $   #00004171' TO DFHEIV0
  4758     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4759     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4760     MOVE X'2020233030303034313731' TO DFHEIV0(25:11)
  4761     CALL 'kxdfhei1' USING DFHEIV0,
  4762           ELCNTL-FILE-ID,
  4763           DFHEIV11,
  4764           DFHEIV99
  4765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4766
  4767
  4768     IF REPORT-WAS-NOT-FOUND
  4769        NEXT SENTENCE
  4770     ELSE
  4771        GO TO 7190-EXIT.
  4772
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL6041.cbl
  4773 7180-END-OF-SEARCH.
  4774     MOVE -1                     TO MAINTL.
  4775     MOVE  ER-2238               TO EMI-ERROR.
  4776     PERFORM 9900-ERROR-FORMAT.
  4777     GO TO 8200-SEND-DATAONLY.
  4778
  4779  7190-EXIT.
  4780     EXIT.
  4781
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL6041.cbl
  4783 8100-SEND-INITIAL-MAP.
  4784     MOVE SAVE-DATE              TO RUNDTEO.
  4785     MOVE EIBTIME                TO TIME-IN.
  4786     MOVE TIME-OUT               TO RUNTIMEO.
  4787     MOVE SPACES                 TO MAINTO.
  4788     MOVE -1                     TO MAINTL.
  4789     MOVE PI-LIFE-OVERRIDE-L6    TO LBENTPO.
  4790     MOVE PI-AH-OVERRIDE-L6      TO ABENTPO.
  4791     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  4792*****MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  4793
  4794 8150-SEND-INITIAL-MAP.
  4795
  4796* EXEC CICS SEND
  4797*        MAP      (MAP-NAME)
  4798*        MAPSET   (MAPSET-NAME)
  4799*        FROM     (EL6041AO)
  4800*        ERASE
  4801*        CURSOR
  4802*    END-EXEC.
  4803     MOVE LENGTH OF
  4804      EL6041AO
  4805       TO DFHEIV12
  4806     MOVE -1
  4807       TO DFHEIV11
  4808*    MOVE '8$     CT  E    H L F ,   #00004202' TO DFHEIV0
  4809     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  4810     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4811     MOVE X'2020233030303034323032' TO DFHEIV0(25:11)
  4812     CALL 'kxdfhei1' USING DFHEIV0,
  4813           MAP-NAME,
  4814           EL6041AO,
  4815           DFHEIV12,
  4816           MAPSET-NAME,
  4817           DFHEIV99,
  4818           DFHEIV99,
  4819           DFHEIV99,
  4820           DFHEIV11,
  4821           DFHEIV99,
  4822           DFHEIV99,
  4823           DFHEIV99
  4824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4825
  4826
  4827     GO TO 9100-RETURN-TRAN.
  4828
  4829 8200-SEND-DATAONLY.
  4830     MOVE SAVE-DATE              TO RUNDTEO
  4831     MOVE EIBTIME                TO TIME-IN.
  4832     MOVE TIME-OUT               TO RUNTIMEO
  4833     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  4834*****MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  4835
  4836* EXEC CICS SEND
  4837*        MAP      (MAP-NAME)
  4838*        MAPSET   (MAPSET-NAME)
  4839*        FROM     (EL6041AO)
  4840*        DATAONLY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL6041.cbl
  4841*        CURSOR
  4842*    END-EXEC.
  4843     MOVE LENGTH OF
  4844      EL6041AO
  4845       TO DFHEIV12
  4846     MOVE -1
  4847       TO DFHEIV11
  4848*    MOVE '8$D    CT       H L F ,   #00004218' TO DFHEIV0
  4849     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  4850     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4851     MOVE X'2020233030303034323138' TO DFHEIV0(25:11)
  4852     CALL 'kxdfhei1' USING DFHEIV0,
  4853           MAP-NAME,
  4854           EL6041AO,
  4855           DFHEIV12,
  4856           MAPSET-NAME,
  4857           DFHEIV99,
  4858           DFHEIV99,
  4859           DFHEIV99,
  4860           DFHEIV11,
  4861           DFHEIV99,
  4862           DFHEIV99,
  4863           DFHEIV99
  4864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4865
  4866
  4867     GO TO 9100-RETURN-TRAN.
  4868
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL6041.cbl
  4870 8300-SEND-TEXT.
  4871
  4872* EXEC CICS SEND TEXT
  4873*        FROM     (LOGOFF-TEXT)
  4874*        LENGTH   (LOGOFF-LENGTH)
  4875*        ERASE
  4876*        FREEKB
  4877*    END-EXEC.
  4878*    MOVE '8&      T  E F  H   F -   #00004230' TO DFHEIV0
  4879     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  4880     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  4881     MOVE X'2020233030303034323330' TO DFHEIV0(25:11)
  4882     CALL 'kxdfhei1' USING DFHEIV0,
  4883           LOGOFF-TEXT,
  4884           LOGOFF-LENGTH,
  4885           DFHEIV99,
  4886           DFHEIV99,
  4887           DFHEIV99,
  4888           DFHEIV99,
  4889           DFHEIV99,
  4890           DFHEIV99,
  4891           DFHEIV99,
  4892           DFHEIV99,
  4893           DFHEIV99,
  4894           DFHEIV99
  4895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4896
  4897
  4898
  4899* EXEC CICS RETURN
  4900*    END-EXEC.
  4901*    MOVE '.(                    &   #00004237' TO DFHEIV0
  4902     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4903     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4904     MOVE X'2020233030303034323337' TO DFHEIV0(25:11)
  4905     CALL 'kxdfhei1' USING DFHEIV0,
  4906           DFHEIV99,
  4907           DFHEIV99,
  4908           DFHEIV99,
  4909           DFHEIV99,
  4910           DFHEIV99
  4911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4912
  4913
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL6041.cbl
  4915 8400-LOG-JOURNAL-RECORD.
  4916     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
  4917     MOVE ELCNTL-FILE-ID         TO JP-FILE-ID.
  4918     MOVE THIS-PGM               TO JP-PROGRAM-ID.
  4919*    EXEC CICS JOURNAL
  4920*        JFILEID     (PI-JOURNAL-FILE-ID)
  4921*        JTYPEID     ('CR')
  4922*        FROM        (JOURNAL-RECORD)
  4923*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
  4924*    END-EXEC.
  4925
  4926 8400-EXIT.
  4927     EXIT.
  4928
  4929 8600-DEEDIT.
  4930
  4931* EXEC CICS BIF DEEDIT
  4932*         FIELD   (DEEDIT-FIELD)
  4933*         LENGTH  (15)
  4934*     END-EXEC.
  4935     MOVE 15
  4936       TO DFHEIV11
  4937*    MOVE '@"L                   #   #00004256' TO DFHEIV0
  4938     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4939     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4940     MOVE X'2020233030303034323536' TO DFHEIV0(25:11)
  4941     CALL 'kxdfhei1' USING DFHEIV0,
  4942           DEEDIT-FIELD,
  4943           DFHEIV11
  4944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4945
  4946
  4947 8800-UNAUTHORIZED-ACCESS.
  4948     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  4949     GO TO 8300-SEND-TEXT.
  4950
  4951 8810-PF23.
  4952     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  4953     MOVE XCTL-005               TO PGM-NAME.
  4954     GO TO 9300-XCTL.
  4955
  4956 9000-RETURN-CICS.
  4957
  4958* EXEC CICS RETURN
  4959*    END-EXEC.
  4960*    MOVE '.(                    &   #00004271' TO DFHEIV0
  4961     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4962     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4963     MOVE X'2020233030303034323731' TO DFHEIV0(25:11)
  4964     CALL 'kxdfhei1' USING DFHEIV0,
  4965           DFHEIV99,
  4966           DFHEIV99,
  4967           DFHEIV99,
  4968           DFHEIV99,
  4969           DFHEIV99
  4970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4971
  4972
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL6041.cbl
  4973 9100-RETURN-TRAN.
  4974     MOVE    EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  4975     MOVE SCREEN-NUMBER             TO PI-CURRENT-SCREEN-NO.
  4976
  4977* EXEC CICS RETURN
  4978*        TRANSID    (TRANS-ID)
  4979*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  4980*        LENGTH     (PI-COMM-LENGTH)
  4981*    END-EXEC.
  4982*    MOVE '.(CT                  &   #00004277' TO DFHEIV0
  4983     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  4984     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4985     MOVE X'2020233030303034323737' TO DFHEIV0(25:11)
  4986     CALL 'kxdfhei1' USING DFHEIV0,
  4987           TRANS-ID,
  4988           PROGRAM-INTERFACE-BLOCK,
  4989           PI-COMM-LENGTH,
  4990           DFHEIV99,
  4991           DFHEIV99
  4992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4993
  4994
  4995 9200-RETURN-MAIN-MENU.
  4996
  4997     IF  CREDIT-SESSION
  4998         MOVE XCTL-EL626         TO PGM-NAME
  4999
  5000     ELSE
  5001         IF  CLAIM-SESSION
  5002             MOVE XCTL-EL126     TO PGM-NAME
  5003
  5004         ELSE
  5005             IF  MORTGAGE-SESSION
  5006                 MOVE XCTL-EM626 TO PGM-NAME
  5007
  5008             ELSE
  5009                 IF  GENERAL-LEDGER-SESSION
  5010                     MOVE XCTL-GL800
  5011                                 TO PGM-NAME.
  5012
  5013     GO TO 9300-XCTL.
  5014
  5015 9300-XCTL.
  5016
  5017* EXEC CICS XCTL
  5018*        PROGRAM    (PGM-NAME)
  5019*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  5020*        LENGTH     (PI-COMM-LENGTH)
  5021*    END-EXEC.
  5022*    MOVE '.$C                   $   #00004304' TO DFHEIV0
  5023     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5024     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5025     MOVE X'2020233030303034333034' TO DFHEIV0(25:11)
  5026     CALL 'kxdfhei1' USING DFHEIV0,
  5027           PGM-NAME,
  5028           PROGRAM-INTERFACE-BLOCK,
  5029           PI-COMM-LENGTH
  5030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL6041.cbl
  5031
  5032
  5033 9400-CLEAR.
  5034     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  5035     GO TO 9300-XCTL.
  5036
  5037 9500-PF12.
  5038     MOVE XCTL-010               TO PGM-NAME.
  5039     GO TO 9300-XCTL.
  5040
  5041 9600-PGMID-ERROR.
  5042
  5043* EXEC CICS HANDLE CONDITION
  5044*        PGMIDERR    (8300-SEND-TEXT)
  5045*    END-EXEC.
  5046*    MOVE '"$L                   ! 1 #00004319' TO DFHEIV0
  5047     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5048     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5049     MOVE X'3120233030303034333139' TO DFHEIV0(25:11)
  5050     CALL 'kxdfhei1' USING DFHEIV0
  5051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5052
  5053
  5054     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  5055     MOVE ' '                    TO PI-ENTRY-CD-1.
  5056     MOVE XCTL-005               TO PGM-NAME.
  5057     MOVE PGM-NAME               TO LOGOFF-PGM.
  5058     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  5059     GO TO 9300-XCTL.
  5060
  5061 9700-DATE-LINK.
  5062     MOVE LINK-ELDATCV           TO PGM-NAME
  5063
  5064* EXEC CICS LINK
  5065*        PROGRAM    (PGM-NAME)
  5066*        COMMAREA   (DATE-CONVERSION-DATA)
  5067*        LENGTH     (DC-COMM-LENGTH)
  5068*    END-EXEC.
  5069*    MOVE '."C                   ''   #00004332' TO DFHEIV0
  5070     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5071     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5072     MOVE X'2020233030303034333332' TO DFHEIV0(25:11)
  5073     CALL 'kxdfhei1' USING DFHEIV0,
  5074           PGM-NAME,
  5075           DATE-CONVERSION-DATA,
  5076           DC-COMM-LENGTH,
  5077           DFHEIV99,
  5078           DFHEIV99,
  5079           DFHEIV99
  5080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5081
  5082
  5083 9900-ERROR-FORMAT.
  5084     IF NOT EMI-ERRORS-COMPLETE
  5085         MOVE LINK-001           TO PGM-NAME
  5086
  5087* EXEC CICS LINK
  5088*            PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL6041.cbl
  5089*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  5090*            LENGTH     (EMI-COMM-LENGTH)
  5091*        END-EXEC.
  5092*    MOVE '."C                   ''   #00004341' TO DFHEIV0
  5093     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5094     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5095     MOVE X'2020233030303034333431' TO DFHEIV0(25:11)
  5096     CALL 'kxdfhei1' USING DFHEIV0,
  5097           PGM-NAME,
  5098           ERROR-MESSAGE-INTERFACE-BLOCK,
  5099           EMI-COMM-LENGTH,
  5100           DFHEIV99,
  5101           DFHEIV99,
  5102           DFHEIV99
  5103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5104
  5105
  5106 9900-EXIT.
  5107     EXIT.
  5108
  5109 9990-ABEND.
  5110     MOVE LINK-004               TO PGM-NAME.
  5111     MOVE DFHEIBLK               TO EMI-LINE1
  5112
  5113
  5114* EXEC CICS LINK
  5115*        PROGRAM   (PGM-NAME)
  5116*        COMMAREA  (EMI-LINE1)
  5117*        LENGTH    (72)
  5118*    END-EXEC.
  5119     MOVE 72
  5120       TO DFHEIV11
  5121*    MOVE '."C                   ''   #00004354' TO DFHEIV0
  5122     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5123     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5124     MOVE X'2020233030303034333534' TO DFHEIV0(25:11)
  5125     CALL 'kxdfhei1' USING DFHEIV0,
  5126           PGM-NAME,
  5127           EMI-LINE1,
  5128           DFHEIV11,
  5129           DFHEIV99,
  5130           DFHEIV99,
  5131           DFHEIV99
  5132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5133
  5134
  5135     MOVE -1                     TO MAINTL.
  5136     GO TO 8200-SEND-DATAONLY.
  5137
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL6041.cbl
  5139 9910-INITIALIZE-SECURITY.
  5140******************************************************************
  5141*                                                                *
  5142*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  5143*       USER SECURITY RECORD SET UP BY EL125.  THIS PROGRAM      *
  5144*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  5145*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  5146*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  5147*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  5148*                                                                *
  5149******************************************************************
  5150
  5151     IF  PI-PROCESSOR-ID NOT = 'LGXX'
  5152          MOVE 'Y'                     TO PI-DISPLAY-CAP
  5153                                          PI-MODIFY-CAP
  5154          IF  NOT SYSTEM-DISPLAY-CAP
  5155                 MOVE 'READ'         TO SM-READ
  5156                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5157                 MOVE ER-9097        TO EMI-ERROR
  5158                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5159                 GO TO 8100-SEND-INITIAL-MAP
  5160
  5161          ELSE
  5162              GO TO 9910-EXIT.
  5163
  5164 9910-EXIT.
  5165     EXIT.
  5166
  5167 9995-SECURITY-VIOLATION.
  5168*           COPY ELCSCTP.
  5169******************************************************************
  5170*                                                                *
  5171*                            ELCSCTP                             *
  5172*                            VMOD=2.001                          *
  5173*                                                                *
  5174*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5175******************************************************************
  5176
  5177
  5178     MOVE EIBDATE          TO SM-JUL-DATE.
  5179     MOVE EIBTRMID         TO SM-TERMID.
  5180     MOVE THIS-PGM         TO SM-PGM.
  5181     MOVE EIBTIME          TO TIME-IN.
  5182     MOVE TIME-OUT         TO SM-TIME.
  5183     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5184
  5185
  5186* EXEC CICS LINK
  5187*         PROGRAM  ('EL003')
  5188*         COMMAREA (SECURITY-MESSAGE)
  5189*         LENGTH   (80)
  5190*    END-EXEC.
  5191     MOVE 'EL003' TO DFHEIV1
  5192     MOVE 80
  5193       TO DFHEIV11
  5194*    MOVE '."C                   ''   #00004410' TO DFHEIV0
  5195     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5196     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL6041.cbl
  5197     MOVE X'2020233030303034343130' TO DFHEIV0(25:11)
  5198     CALL 'kxdfhei1' USING DFHEIV0,
  5199           DFHEIV1,
  5200           SECURITY-MESSAGE,
  5201           DFHEIV11,
  5202           DFHEIV99,
  5203           DFHEIV99,
  5204           DFHEIV99
  5205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5206
  5207
  5208******************************************************************
  5209
  5210
  5211 9995-EXIT.
  5212      EXIT.
  5213
  5214
  5215 9999-DFHBACK SECTION.
  5216     MOVE '9%                    "   ' TO DFHEIV0
  5217     MOVE 'EL6041' TO DFHEIV1
  5218     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5219     GOBACK.
  5220 9999-DFHEXIT.
  5221     IF DFHEIGDJ EQUAL 0001
  5222         NEXT SENTENCE
  5223     ELSE IF DFHEIGDJ EQUAL 2
  5224         GO TO 9600-PGMID-ERROR,
  5225               9990-ABEND
  5226         DEPENDING ON DFHEIGDI
  5227     ELSE IF DFHEIGDJ EQUAL 3
  5228         GO TO 1100-EDIT-REPORT-SCREEN
  5229         DEPENDING ON DFHEIGDI
  5230     ELSE IF DFHEIGDJ EQUAL 4
  5231         GO TO 2100-NOT-FOUND
  5232         DEPENDING ON DFHEIGDI
  5233     ELSE IF DFHEIGDJ EQUAL 5
  5234         GO TO 2890-NOT-FOUND
  5235         DEPENDING ON DFHEIGDI
  5236     ELSE IF DFHEIGDJ EQUAL 6
  5237         GO TO 3100-CONTINUE
  5238         DEPENDING ON DFHEIGDI
  5239     ELSE IF DFHEIGDJ EQUAL 7
  5240         GO TO 3900-NOT-FOUND
  5241         DEPENDING ON DFHEIGDI
  5242     ELSE IF DFHEIGDJ EQUAL 8
  5243         GO TO 4100-NOT-FOUND
  5244         DEPENDING ON DFHEIGDI
  5245     ELSE IF DFHEIGDJ EQUAL 9
  5246         GO TO 5010-NOT-FOUND,
  5247               5010-NOT-FOUND
  5248         DEPENDING ON DFHEIGDI
  5249     ELSE IF DFHEIGDJ EQUAL 10
  5250         GO TO 5030-NOT-FOUND,
  5251               5030-NOT-FOUND
  5252         DEPENDING ON DFHEIGDI
  5253     ELSE IF DFHEIGDJ EQUAL 11
  5254         GO TO 5050-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL6041.cbl
  5255               5050-NOT-FOUND
  5256         DEPENDING ON DFHEIGDI
  5257     ELSE IF DFHEIGDJ EQUAL 12
  5258         GO TO 5070-NOT-FOUND,
  5259               5070-NOT-FOUND
  5260         DEPENDING ON DFHEIGDI
  5261     ELSE IF DFHEIGDJ EQUAL 13
  5262         GO TO 7080-END-OF-SEARCH
  5263         DEPENDING ON DFHEIGDI
  5264     ELSE IF DFHEIGDJ EQUAL 14
  5265         GO TO 7070-END-OF-BROWSE,
  5266               7070-END-OF-BROWSE
  5267         DEPENDING ON DFHEIGDI
  5268     ELSE IF DFHEIGDJ EQUAL 15
  5269         GO TO 7180-END-OF-SEARCH
  5270         DEPENDING ON DFHEIGDI
  5271     ELSE IF DFHEIGDJ EQUAL 16
  5272         GO TO 7170-END-OF-BROWSE,
  5273               7170-END-OF-BROWSE
  5274         DEPENDING ON DFHEIGDI
  5275     ELSE IF DFHEIGDJ EQUAL 17
  5276         GO TO 8300-SEND-TEXT
  5277         DEPENDING ON DFHEIGDI.
  5278     MOVE '9%                    "   ' TO DFHEIV0
  5279     MOVE 'EL6041' TO DFHEIV1
  5280     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5281     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4752     Code:       13517
