* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL1524.cbl
* Options: int("EL1524.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1524.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1524.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1524.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1524.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/13/96 09:53:52.
     7*                            VMOD=2.003.
     8*
     9*AUTHOR.           LOGIC,INC.
    10*                  DALLAS,TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL1524.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            * THIS PROGRAM IS THE PROPERTY OF LOCIC, INC. *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS. TRANSACTION EXL2 - ACTIVITY QUEUE LETTER WRITER.
    25*        THIS PROGRAM IS USED TO PRINT LETTERS TO THE COMPANY
    26*        SPECIFIED PRINTER.  IT IS ACTIVATED THROUGH A START
    27*        COMMAND FROM EL178 AND WILL HAVE THE PROGRAM INTERFACE
    28*        BLOCK PASSED.
    29*        THIS PROGRAM WILL READ THE ACTIVITY QUEUE FILE ELACTQ
    30*        SELECTING THOSE RECORDS CORRESPONDING TO THE COMPANY
    31*        BEING PROCESSED AND CALL EL1523 TO CREATE ARCHIVE ENTRIES
    32*        FOR EACH ACTIVITY RECORD THAT CONTAINS A VALID FORM NUMBE
    33
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL1524.cbl
    35 ENVIRONMENT DIVISION.
    36 DATA DIVISION.
    37 WORKING-STORAGE SECTION.
    38 01  DFH-START PIC X(04).
    39 77  FILLER  PIC X(32) VALUE '********************************'.
    40 77  FILLER  PIC X(32) VALUE '*   EL1524 WORKING STORAGE     *'.
    41 77  FILLER  PIC X(32) VALUE '******* VMOD=2.003 *************'.
    42
    43 01  W-PROGRAM-WORK-AREA.
    44     12  THIS-PGM                PIC  X(06) VALUE 'EL1524'.
    45     12  FILLER                  PIC  X(17)
    46                                 VALUE 'PROGRAM WORK AREA'.
    47     12  W-ACTQ-EXIT-SW          PIC X.
    48         88  W-ACTQ-EXIT-YES                      VALUE 'Y'.
    49     12  W-ASKTIME-CTR           PIC S9(04)  COMP.
    50     12  W-PGM-ID                PIC S9(04)  COMP VALUE +1524.
    51     12  W-INCOMING-LINES        PIC S9(04)  COMP VALUE +56.
    52     12  W-LINE-COUNT            PIC S9(04)  COMP VALUE +56.
    53
    54     12  W-ACTQ-RCRD-CHANGED     PIC S9(07)  COMP-3 VALUE +0.
    55     12  W-ACTQ-RCRD-DELETED     PIC S9(07)  COMP-3 VALUE +0.
    56     12  W-ACTQ-RCRD-READ        PIC S9(07)  COMP-3 VALUE +0.
    57     12  W-ACTQ-RCRD-USED        PIC S9(07)  COMP-3 VALUE +0.
    58     12  W-COMBINED-SPACES       PIC S9(07)  COMP-3 VALUE +0.
    59     12  W-FATAL-ERRORS          PIC S9(07)  COMP-3 VALUE +0.
    60     12  W-LETTERS-CREATED       PIC S9(07)  COMP-3 VALUE +0.
    61     12  W-LETTERS-WITH-ERRORS   PIC S9(07)  COMP-3 VALUE +0.
    62     12  W-PAGE                  PIC S9(04)  COMP-3 VALUE +0.
    63
    64     12  W-ACTQ-FILE-ID          PIC  X(08)  VALUE 'ELACTQ'.
    65     12  W-ACTQ-KEY.
    66         16  W-ACTQ-COMPANY-CD   PIC  X(01).
    67         16  W-ACTQ-CARRIER      PIC  X(01).
    68         16  W-ACTQ-CLAIM-NO     PIC  X(07).
    69         16  W-ACTQ-CERT-NO      PIC  X(11).
    70
    71     12  W-CNTL-FILE-ID          PIC  X(08)  VALUE 'ELCNTL'.
    72     12  W-CNTL-KEY.
    73         16  W-CNTL-COMPANY-ID   PIC  X(03).
    74         16  W-CNTL-RECORD-TYPE  PIC  X(01).
    75         16  FILLER              PIC  X(04).
    76         16  W-CNTL-SEQ          PIC S9(04)  COMP.
    77
    78     12  W-COMPANY.
    79         16  W-CO-CHAR OCCURS 30 TIMES
    80                       INDEXED BY W-CO-NDX
    81                                 PIC  X(01).
    82
    83     12  W-FLAGS.
    84         88  W-NO-PENDING-ACTIVITY         VALUE SPACES.
    85         16  FILLER              PIC  X(02).
    86         16  W-PENDING-LETTER-FLAG
    87                                 PIC  X(01).
    88
    89     12  W-MESSAGES.
    90         16  W-REPORT-TITLE.
    91             20  FILLER          PIC  X(01)
    92                 VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL1524.cbl
    93             20  W-DATE          PIC  X(08)
    94                 VALUE 'XX/XX/XX'.
    95             20  FILLER          PIC  X(14)
    96                 VALUE SPACES.
    97             20  FILLER          PIC  X(35)
    98                 VALUE 'ACTIVITY QUEUE LETTERS CREATED LIST'.
    99             20  FILLER          PIC  X(11)
   100                 VALUE SPACES.
   101             20  FILLER          PIC  X(09)
   102                 VALUE 'EL1524'.
   103         16  W-COMPANY-TITLE.
   104             20  FILLER          PIC  X(26)
   105                 VALUE SPACES.
   106             20  W-CT-COMPANY.
   107                 24  W-CT-CHAR OCCURS 30 TIMES
   108                               INDEXED BY W-CT-NDX
   109                                 PIC  X(01).
   110             20  FILLER          PIC  X(14)  VALUE SPACES.
   111             20  FILLER          PIC  X(05)
   112                 VALUE 'PAGE '.
   113             20  W-CT-PAGE       PIC  ZZZ9.
   114         16  W-FATAL-ERROR-MSG.
   115             20  FILLER          PIC  X(12)
   116                 VALUE 'FATAL ERROR '.
   117             20  W-FATAL-ERROR   PIC  9(04).
   118             20  FILLER          PIC  X(18)
   119                                 VALUE ' DETECTED FOR CLM '.
   120             20  W-CLAIM-NO-F    PIC  X(07) VALUE 'XXXXXXX'.
   121             20  FILLER          PIC  X(07) VALUE ', CERT '.
   122             20  W-CERT-NO-F     PIC  X(11) VALUE 'XXXXXXXXXXX'.
   123             20  FILLER          PIC  X(20)
   124                 VALUE ', LETTER NOT CREATED'.
   125         16  W-GENERAL-ERROR.
   126             20  FILLER          PIC  X(06) VALUE 'CLAIM '.
   127             20  W-CLAIM-NO      PIC  X(07) VALUE 'XXXXXXX'.
   128             20  FILLER          PIC  X(10) VALUE ' FOR CERT '.
   129             20  W-CERT-NO       PIC  X(11) VALUE 'XXXXXXXXXXX'.
   130             20  FILLER          PIC  X(11) VALUE ' HAD ERROR '.
   131             20  W-ERROR         PIC  9(04) VALUE 9999.
   132         16  W-LETTER-SENT.
   133             20  FILLER          PIC  X(26)
   134                 VALUE 'LETTER ARCHIVED FOR CLAIM '.
   135             20  W-CLAIM-X       PIC  X(07) VALUE 'XXXXXXX'.
   136             20  FILLER          PIC  X(10) VALUE ' AND CERT '.
   137             20  W-CERT-X        PIC  X(11) VALUE 'XXXXXXXXXXX'.
   138             20  FILLER          PIC  X(10)
   139                                 VALUE ', ARCHIVE '.
   140             20  W-ARCHIVE       PIC  9(08) VALUE 99999999.
   141         16  W-SEVERE-ERROR.
   142             20  FILLER          PIC  X(10)
   143                 VALUE ' ******** '.
   144             20  FILLER          PIC  X(26)
   145                 VALUE 'A SEVERE ERROR DETECTED.'.
   146             20  FILLER          PIC  X(26)
   147                 VALUE 'ALL PROCESSING STOPPED.'.
   148         16  W-TOTAL1.
   149             20  FILLER          PIC  X(35)
   150                 VALUE 'ACTQ RCRDS READ - '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL1524.cbl
   151             20  W-TOTAL-AMT1    PIC  ZZZ,ZZ9.
   152         16  W-TOTAL2.
   153             20  FILLER          PIC  X(35)
   154                 VALUE 'ACTQ RCRDS QUALIFIED - '.
   155             20  W-TOTAL-AMT2    PIC  ZZZ,ZZ9.
   156         16  W-TOTAL3.
   157             20  FILLER          PIC  X(35)
   158                 VALUE 'RCRDS WITH FATAL ERRORS DETECTED - '.
   159             20  W-TOTAL-AMT3    PIC  ZZZ,ZZ9.
   160         16  W-TOTAL4.
   161             20  FILLER          PIC  X(35)
   162                 VALUE 'LETTERS ARCHIVED - '.
   163             20  W-TOTAL-AMT4    PIC  ZZZ,ZZ9.
   164         16  W-TOTAL5.
   165             20  FILLER          PIC  X(35)
   166                 VALUE 'ACTQ RCRDS DELETED - '.
   167             20  W-TOTAL-AMT5    PIC  ZZZ,ZZ9.
   168         16  W-TOTAL6.
   169             20  FILLER          PIC  X(35)
   170                 VALUE 'ACTQ RCRDS CHANGED - '.
   171             20  W-TOTAL-AMT6    PIC  ZZZ,ZZ9.
   172         16  W-TOTAL7.
   173             20  FILLER          PIC  X(35)
   174                 VALUE 'LETTERS WITH ERRORS - '.
   175             20  W-TOTAL-AMT7    PIC  ZZZ,ZZ9.
   176
   177     12  W-MESSAGE-LINE.
   178         16  W-ML-CC             PIC  X(01).
   179         16  W-ML-DATA           PIC  X(79).
   180
   181     12  W-NEXT-TRAN             PIC  X(04).
   182
   183     12  W-TERMINAL-ID.
   184         18  W-TERM-PREFIX       PIC  X(02).
   185         18  FILLER              PIC  X(02).
   186
   187 01  W-PROGRAM-CONSTANTS.
   188     12  FILLER                  PIC  X(17)
   189                                 VALUE 'PROGRAM CONSTANTS'.
   190     12  W-PGM-EL178             PIC  X(08)  VALUE 'EL178'.
   191*                                COPY ELCDMD34.
   192******************************************************************
   193*                                                                *
   194*                                                                *
   195*                            ELCDMD34.                           *
   196*                            VMOD=2.001                          *
   197*                                                                *
   198*   FILE DESCRIPTION = DMD DLO034 PARAMETER AREA                 *
   199*                                                                *
   200*    LENGTH = 272    RECFRM = FIXED                              *
   201*                                                                *
   202******************************************************************
   203 01  DLO034-COMMUNICATION-AREA.
   204     12  DL34-PROCESS-TYPE             PIC X.
   205     12  DL34-COMPANY-ID               PIC XXX.
   206     12  DL34-PRINT-PROGRAM-ID         PIC X(8).
   207     12  DL34-USERID                   PIC X(4).
   208     12  DL34-PRINT-LINE               PIC X(250).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL1524.cbl
   209     12  DL34-OVERRIDE-PRINTER-ID      PIC X(4).
   210     12  DL34-RETURN-CODE              PIC XX.
   211 01  DLO034-REC-LENGTH                 PIC S9(4) COMP VALUE +272.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL1524.cbl
   213*                                COPY ELCINTF.
   214******************************************************************
   215*                                                                *
   216*                                                                *
   217*                            ELCINTF.                            *
   218*                            VMOD=2.017                          *
   219*                                                                *
   220*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   221*                                                                *
   222*       LENGTH = 1024                                            *
   223*                                                                *
   224******************************************************************
   225 01  PROGRAM-INTERFACE-BLOCK.
   226     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   227     12  PI-CALLING-PROGRAM              PIC X(8).
   228     12  PI-SAVED-PROGRAM-1              PIC X(8).
   229     12  PI-SAVED-PROGRAM-2              PIC X(8).
   230     12  PI-SAVED-PROGRAM-3              PIC X(8).
   231     12  PI-SAVED-PROGRAM-4              PIC X(8).
   232     12  PI-SAVED-PROGRAM-5              PIC X(8).
   233     12  PI-SAVED-PROGRAM-6              PIC X(8).
   234     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   235     12  PI-COMPANY-ID                   PIC XXX.
   236     12  PI-COMPANY-CD                   PIC X.
   237
   238     12  PI-COMPANY-PASSWORD             PIC X(8).
   239
   240     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   241
   242     12  PI-CONTROL-IN-PROGRESS.
   243         16  PI-CARRIER                  PIC X.
   244         16  PI-GROUPING                 PIC X(6).
   245         16  PI-STATE                    PIC XX.
   246         16  PI-ACCOUNT                  PIC X(10).
   247         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   248                                         PIC X(10).
   249         16  PI-CLAIM-CERT-GRP.
   250             20  PI-CLAIM-NO             PIC X(7).
   251             20  PI-CERT-NO.
   252                 25  PI-CERT-PRIME       PIC X(10).
   253                 25  PI-CERT-SFX         PIC X.
   254             20  PI-CERT-EFF-DT          PIC XX.
   255         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   256             20  PI-PLAN-CODE            PIC X(2).
   257             20  PI-REVISION-NUMBER      PIC X(3).
   258             20  PI-PLAN-EFF-DT          PIC X(2).
   259             20  PI-PLAN-EXP-DT          PIC X(2).
   260             20  FILLER                  PIC X(11).
   261         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   262             20  PI-OE-REFERENCE-1.
   263                 25  PI-OE-REF-1-PRIME   PIC X(18).
   264                 25  PI-OE-REF-1-SUFF    PIC XX.
   265
   266     12  PI-SESSION-IN-PROGRESS          PIC X.
   267         88  CLAIM-SESSION                   VALUE '1'.
   268         88  CREDIT-SESSION                  VALUE '2'.
   269         88  WARRANTY-SESSION                VALUE '3'.
   270         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL1524.cbl
   271         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   272
   273
   274*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   275
   276     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   277     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   278
   279     12  PI-CREDIT-USER                  PIC X.
   280         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   281         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   282
   283     12  PI-CLAIM-USER                   PIC X.
   284         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   285         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   286
   287     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   288         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   289         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   290         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   291         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   292         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   293
   294     12  PI-PROCESSOR-ID                 PIC X(4).
   295
   296     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   297
   298     12  PI-MEMBER-CAPTION               PIC X(10).
   299
   300     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   301         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   302
   303     12  PI-LIFE-OVERRIDE-L1             PIC X.
   304     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   305     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   306     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   307
   308     12  PI-AH-OVERRIDE-L1               PIC X.
   309     12  PI-AH-OVERRIDE-L2               PIC XX.
   310     12  PI-AH-OVERRIDE-L6               PIC X(6).
   311     12  PI-AH-OVERRIDE-L12              PIC X(12).
   312
   313     12  PI-NEW-SYSTEM                   PIC X(2).
   314
   315     12  PI-PRIMARY-CERT-NO              PIC X(11).
   316     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   317         88  PI-USES-PAID-TO                 VALUE '1'.
   318     12  PI-CRDTCRD-SYSTEM.
   319         16  PI-CRDTCRD-USER             PIC X.
   320             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   321             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   322         16  PI-CC-MONTH-END-DT          PIC XX.
   323     12  PI-PROCESSOR-PRINTER            PIC X(4).
   324
   325     12  PI-OE-REFERENCE-2.
   326         16  PI-OE-REF-2-PRIME           PIC X(10).
   327         16  PI-OE-REF-2-SUFF            PIC X.
   328
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL1524.cbl
   329     12  PI-REM-TRM-CALC-OPTION          PIC X.
   330
   331     12  PI-LANGUAGE-TYPE                PIC X.
   332             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   333             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   334             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   335
   336     12  PI-POLICY-LINKAGE-IND           PIC X.
   337         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   338         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   339                                                   LOW-VALUES.
   340
   341     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   342     12  PI-CLAIM-PW-SESSION             PIC X(1).
   343         88  PI-CLAIM-CREDIT                 VALUE '1'.
   344         88  PI-CLAIM-CONVEN                 VALUE '2'.
   345     12  FILLER                          PIC X(4).
   346
   347     12  PI-SYSTEM-LEVEL                 PIC X(145).
   348
   349     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   350         PI-SYSTEM-LEVEL.
   351
   352         16  PI-ENTRY-CODES.
   353             20  PI-ENTRY-CD-1           PIC X.
   354             20  PI-ENTRY-CD-2           PIC X.
   355
   356         16  PI-RETURN-CODES.
   357             20  PI-RETURN-CD-1          PIC X.
   358             20  PI-RETURN-CD-2          PIC X.
   359
   360         16  PI-UPDATE-STATUS-SAVE.
   361             20  PI-UPDATE-BY            PIC X(4).
   362             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   363
   364         16  PI-LOWER-CASE-LETTERS       PIC X.
   365             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   366
   367*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   368*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   369*            88  CARRIER-CLM-CNTL            VALUE '2'.
   370
   371         16  PI-CERT-ACCESS-CONTROL      PIC X.
   372             88  ST-ACCNT-CNTL               VALUE ' '.
   373             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   374             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   375             88  ACCNT-CNTL                  VALUE '3'.
   376             88  CARR-ACCNT-CNTL             VALUE '4'.
   377
   378         16  PI-PROCESSOR-CAP-LIST.
   379             20  PI-SYSTEM-CONTROLS.
   380                24 PI-SYSTEM-DISPLAY     PIC X.
   381                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   382                24 PI-SYSTEM-MODIFY      PIC X.
   383                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   384             20  FILLER                  PIC XX.
   385             20  PI-DISPLAY-CAP          PIC X.
   386                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL1524.cbl
   387             20  PI-MODIFY-CAP           PIC X.
   388                 88  MODIFY-CAP              VALUE 'Y'.
   389             20  PI-MSG-AT-LOGON-CAP     PIC X.
   390                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   391             20  PI-FORCE-CAP            PIC X.
   392                 88  FORCE-CAP               VALUE 'Y'.
   393
   394         16  PI-PROGRAM-CONTROLS.
   395             20  PI-PGM-PRINT-OPT        PIC X.
   396             20  PI-PGM-FORMAT-OPT       PIC X.
   397             20  PI-PGM-PROCESS-OPT      PIC X.
   398             20  PI-PGM-TOTALS-OPT       PIC X.
   399
   400         16  PI-HELP-INTERFACE.
   401             20  PI-LAST-ERROR-NO        PIC X(4).
   402             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   403
   404         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   405             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   406
   407         16  PI-CR-CONTROL-IN-PROGRESS.
   408             20  PI-CR-CARRIER           PIC X.
   409             20  PI-CR-GROUPING          PIC X(6).
   410             20  PI-CR-STATE             PIC XX.
   411             20  PI-CR-ACCOUNT           PIC X(10).
   412             20  PI-CR-FIN-RESP          PIC X(10).
   413             20  PI-CR-TYPE              PIC X.
   414
   415         16  PI-CR-BATCH-NUMBER          PIC X(6).
   416
   417         16  PI-CR-MONTH-END-DT          PIC XX.
   418
   419         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   420             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   421             88  PI-ZERO-CARRIER             VALUE '1'.
   422             88  PI-ZERO-GROUPING            VALUE '2'.
   423             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   424
   425         16  PI-CARRIER-SECURITY         PIC X.
   426             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   427
   428         16  PI-ACCOUNT-SECURITY         PIC X(10).
   429             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   430             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   431
   432         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   433             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   434                                         INDEXED BY PI-ACCESS-NDX
   435                                         PIC X.
   436
   437         16  PI-GA-BILLING-CONTROL       PIC X.
   438             88  PI-GA-BILLING               VALUE '1'.
   439
   440         16  PI-MAIL-PROCESSING          PIC X.
   441             88  PI-MAIL-YES                 VALUE 'Y'.
   442
   443         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   444
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL1524.cbl
   445         16  PI-AR-SYSTEM.
   446             20  PI-AR-PROCESSING-CNTL   PIC X.
   447                 88  PI-AR-PROCESSING        VALUE 'Y'.
   448             20  PI-AR-SUMMARY-CODE      PIC X(6).
   449             20  PI-AR-MONTH-END-DT      PIC XX.
   450
   451         16  PI-MP-SYSTEM.
   452             20  PI-MORTGAGE-USER            PIC X.
   453                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   454                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   455             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   456                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   457                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   458                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   459                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   460                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   461             20  PI-MP-MONTH-END-DT          PIC XX.
   462             20  PI-MP-REFERENCE-NO.
   463                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   464                 24  PI-MP-REFERENCE-SFX     PIC XX.
   465
   466         16  PI-LABEL-CONTROL            PIC X(01).
   467             88  PI-CREATE-LABELS                    VALUE 'Y'.
   468             88  PI-BYPASS-LABELS                    VALUE 'N'.
   469
   470         16  PI-BILL-GROUPING-CODE       PIC X(01).
   471             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   472
   473         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   474             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   475             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   476
   477         16  FILLER                      PIC X(14).
   478
   479     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   480******************************************************************
   481     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   482         16  PI-PRINT-DATE       PIC X(08).
   483         16  PI-PRINT-DATE-BIN   PIC X(02).
   484         16  PI-PRINT-ID         PIC X(04).
   485         16  PI-STARTING-ARCH-NO PIC S9(08) COMP.
   486         16  PI-PRINT-BY-CARR    PIC X.
   487             88  PRINT-BY-CARR              VALUE 'Y'.
   488         16  PI-PRINT-CARRIER    PIC X.
   489         16  PI-LETTER-TYPE      PIC X.
   490         16  PI-PRINT-REPORT     PIC X(05).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL1524.cbl
   492*                                COPY ELCLNKLT.
   493******************************************************************
   494*                                                                *
   495*                                                                *
   496*                           ELCLNKLT                             *
   497*                            VMOD=2.003                          *
   498*                                                                *
   499*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   500*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   501*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   502*                                                                *
   503*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   504*   COMPLETING THE REQUIRED FIELDS.                              *
   505*                                                                *
   506*   THE CALLING PROGRAM SHOULD CHECK:                            *
   507*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   508*                              9999 INDICATES AN UNKNOWN ABEND   *
   509*                                   WAS DETECTED.                *
   510*                              ALL OTHER VALUES ARE NORMAL ERROR *
   511*                              CODES FOUND IN THE ERROR FILE.    *
   512******************************************************************
   513 01  W-1523-LINKDATA.
   514     12  W-1523-COMMON-PI-DATA.
   515         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   516         16  FILLER              PIC  X(67).
   517         16  W-1523-COMPANY-CD   PIC  X(01).
   518         16  FILLER              PIC  X(10).
   519         16  W-1523-CONTROL-IN-PROGRESS.
   520             20  W-1523-CARRIER  PIC  X(01).
   521             20  W-1523-GROUPING PIC  X(06).
   522             20  W-1523-STATE    PIC  X(02).
   523             20  W-1523-ACCOUNT  PIC  X(10).
   524             20  W-1523-CLAIM-CERT-GRP.
   525                 24  W-1523-CLAIM-NO
   526                                 PIC  X(07).
   527                 24  W-1523-CERT-NO.
   528                     28  W-1523-CERT-PRIME
   529                                 PIC  X(10).
   530                     28  W-1523-CERT-SFX
   531                                 PIC  X(01).
   532                 24  W-1523-CERT-EFF-DT
   533                                 PIC  X(02).
   534         16  FILLER              PIC X(265).
   535
   536     12  W-1523-WORK-AREA.
   537         16  W-1523-FORM-NUMBER  PIC  X(04).
   538         16  W-1523-NUMBER-COPIES
   539                                 PIC  9(01).
   540         16  W-1523-ADDR-TYPE    PIC  X(02).
   541         16  W-1523-FOLLOW-UP-DATE
   542                                 PIC  X(02).
   543         16  W-1523-RESEND-DATE  PIC  X(02).
   544         16  W-1523-ERROR-CODE   PIC  9(04).
   545             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   546             88  W-1523-FATAL-ERROR
   547                                    VALUES  0006 0013 0042
   548                                            0154 0168 0169
   549                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL1524.cbl
   550                                            0179 0186 0281
   551                                            0332 2055 3697
   552                                            3698 3699 3770
   553                                            3771 3772 7675
   554                                            9106 9808 9883
   555                                            9887.
   556             88  W-1523-STOP-ERRORS
   557                                    VALUES  0013 0042 0154
   558                                            0168 0169 0172
   559                                            0281 0332 2055
   560                                            3698 3699 7675
   561                                            9106 9808 9883
   562                                            9999.
   563         16  W-1523-REASON       PIC  X(70).
   564         16  W-1523-ARCHIVE-NUMBER
   565                                 PIC  9(08).
   566     12  W-1523-POINTER-AREA.
   567         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   568         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   569         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   570         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   571         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL1524.cbl
   573*                                COPY ELCDATE.
   574******************************************************************
   575*                                                                *
   576*                                                                *
   577*                            ELCDATE.                            *
   578*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   579*                            VMOD=2.003
   580*                                                                *
   581*                                                                *
   582*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   583*                 LENGTH = 200                                   *
   584******************************************************************
   585
   586 01  DATE-CONVERSION-DATA.
   587     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   588     12  DC-OPTION-CODE                PIC X.
   589         88  BIN-TO-GREG                VALUE ' '.
   590         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   591         88  EDIT-GREG-TO-BIN           VALUE '2'.
   592         88  YMD-GREG-TO-BIN            VALUE '3'.
   593         88  MDY-GREG-TO-BIN            VALUE '4'.
   594         88  JULIAN-TO-BIN              VALUE '5'.
   595         88  BIN-PLUS-ELAPSED           VALUE '6'.
   596         88  FIND-CENTURY               VALUE '7'.
   597         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   598         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   599         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   600         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   601         88  JULIAN-TO-BIN-3            VALUE 'C'.
   602         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   603         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   604         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   605         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   606         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   607         88  CHECK-LEAP-YEAR            VALUE 'H'.
   608         88  BIN-3-TO-GREG              VALUE 'I'.
   609         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   610         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   611         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   612         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   613         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   614         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   615         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   616         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   617         88  THREE-CHARACTER-BIN
   618                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   619         88  GREGORIAN-TO-BIN
   620                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   621         88  BIN-TO-GREGORIAN
   622                  VALUES ' ' '1' 'I' '8' 'G'.
   623         88  JULIAN-TO-BINARY
   624                  VALUES '5' 'C' 'E' 'F'.
   625     12  DC-ERROR-CODE                 PIC X.
   626         88  NO-CONVERSION-ERROR        VALUE ' '.
   627         88  DATE-CONVERSION-ERROR
   628                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   629         88  DATE-IS-ZERO               VALUE '1'.
   630         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL1524.cbl
   631         88  DATE-IS-INVALID            VALUE '3'.
   632         88  DATE1-GREATER-DATE2        VALUE '4'.
   633         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   634         88  DATE-INVALID-OPTION        VALUE '9'.
   635         88  INVALID-CENTURY            VALUE 'A'.
   636         88  ONLY-CENTURY               VALUE 'B'.
   637         88  ONLY-LEAP-YEAR             VALUE 'C'.
   638         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   639     12  DC-END-OF-MONTH               PIC X.
   640         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   641     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   642         88  USE-NORMAL-PROCESS         VALUE ' '.
   643         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   644         88  ADJUST-UP-100-YRS          VALUE '2'.
   645     12  FILLER                        PIC X.
   646     12  DC-CONVERSION-DATES.
   647         16  DC-BIN-DATE-1             PIC XX.
   648         16  DC-BIN-DATE-2             PIC XX.
   649         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   650         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   651                       DC-GREG-DATE-1-EDIT.
   652             20  DC-EDIT1-MONTH        PIC 99.
   653             20  SLASH1-1              PIC X.
   654             20  DC-EDIT1-DAY          PIC 99.
   655             20  SLASH1-2              PIC X.
   656             20  DC-EDIT1-YEAR         PIC 99.
   657         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   658         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   659                     DC-GREG-DATE-2-EDIT.
   660             20  DC-EDIT2-MONTH        PIC 99.
   661             20  SLASH2-1              PIC X.
   662             20  DC-EDIT2-DAY          PIC 99.
   663             20  SLASH2-2              PIC X.
   664             20  DC-EDIT2-YEAR         PIC 99.
   665         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   666         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   667                     DC-GREG-DATE-1-YMD.
   668             20  DC-YMD-YEAR           PIC 99.
   669             20  DC-YMD-MONTH          PIC 99.
   670             20  DC-YMD-DAY            PIC 99.
   671         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   672         16  DC-GREG-DATE-1-MDY-R REDEFINES
   673                      DC-GREG-DATE-1-MDY.
   674             20  DC-MDY-MONTH          PIC 99.
   675             20  DC-MDY-DAY            PIC 99.
   676             20  DC-MDY-YEAR           PIC 99.
   677         16  DC-GREG-DATE-1-ALPHA.
   678             20  DC-ALPHA-MONTH        PIC X(10).
   679             20  DC-ALPHA-DAY          PIC 99.
   680             20  FILLER                PIC XX.
   681             20  DC-ALPHA-CENTURY.
   682                 24 DC-ALPHA-CEN-N     PIC 99.
   683             20  DC-ALPHA-YEAR         PIC 99.
   684         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   685         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   686         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   687         16  DC-JULIAN-DATE            PIC 9(05).
   688         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL1524.cbl
   689                                       PIC 9(05).
   690         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   691             20  DC-JULIAN-YEAR        PIC 99.
   692             20  DC-JULIAN-DAYS        PIC 999.
   693         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   694         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   695         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   696     12  DATE-CONVERSION-VARIBLES.
   697         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   698         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   699             20  FILLER                PIC 9(3).
   700             20  HOLD-CEN-1-CCYY.
   701                 24  HOLD-CEN-1-CC     PIC 99.
   702                 24  HOLD-CEN-1-YY     PIC 99.
   703             20  HOLD-CEN-1-MO         PIC 99.
   704             20  HOLD-CEN-1-DA         PIC 99.
   705         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   706             20  HOLD-CEN-1-R-MO       PIC 99.
   707             20  HOLD-CEN-1-R-DA       PIC 99.
   708             20  HOLD-CEN-1-R-CCYY.
   709                 24  HOLD-CEN-1-R-CC   PIC 99.
   710                 24  HOLD-CEN-1-R-YY   PIC 99.
   711             20  FILLER                PIC 9(3).
   712         16  HOLD-CENTURY-1-X.
   713             20  FILLER                PIC X(3)  VALUE SPACES.
   714             20  HOLD-CEN-1-X-CCYY.
   715                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   716                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   717             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   718             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   719         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   720             20  HOLD-CEN-1-R-X-MO     PIC XX.
   721             20  HOLD-CEN-1-R-X-DA     PIC XX.
   722             20  HOLD-CEN-1-R-X-CCYY.
   723                 24  HOLD-CEN-1-R-X-CC PIC XX.
   724                 24  HOLD-CEN-1-R-X-YY PIC XX.
   725             20  FILLER                PIC XXX.
   726         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   727         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   728         16  DC-JULIAN-DATE-1          PIC 9(07).
   729         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   730             20  DC-JULIAN-1-CCYY.
   731                 24  DC-JULIAN-1-CC    PIC 99.
   732                 24  DC-JULIAN-1-YR    PIC 99.
   733             20  DC-JULIAN-DA-1        PIC 999.
   734         16  DC-JULIAN-DATE-2          PIC 9(07).
   735         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   736             20  DC-JULIAN-2-CCYY.
   737                 24  DC-JULIAN-2-CC    PIC 99.
   738                 24  DC-JULIAN-2-YR    PIC 99.
   739             20  DC-JULIAN-DA-2        PIC 999.
   740         16  DC-GREG-DATE-A-EDIT.
   741             20  DC-EDITA-MONTH        PIC 99.
   742             20  SLASHA-1              PIC X VALUE '/'.
   743             20  DC-EDITA-DAY          PIC 99.
   744             20  SLASHA-2              PIC X VALUE '/'.
   745             20  DC-EDITA-CCYY.
   746                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL1524.cbl
   747                 24  DC-EDITA-YEAR     PIC 99.
   748         16  DC-GREG-DATE-B-EDIT.
   749             20  DC-EDITB-MONTH        PIC 99.
   750             20  SLASHB-1              PIC X VALUE '/'.
   751             20  DC-EDITB-DAY          PIC 99.
   752             20  SLASHB-2              PIC X VALUE '/'.
   753             20  DC-EDITB-CCYY.
   754                 24  DC-EDITB-CENT     PIC 99.
   755                 24  DC-EDITB-YEAR     PIC 99.
   756         16  DC-GREG-DATE-CYMD         PIC 9(08).
   757         16  DC-GREG-DATE-CYMD-R REDEFINES
   758                              DC-GREG-DATE-CYMD.
   759             20  DC-CYMD-CEN           PIC 99.
   760             20  DC-CYMD-YEAR          PIC 99.
   761             20  DC-CYMD-MONTH         PIC 99.
   762             20  DC-CYMD-DAY           PIC 99.
   763         16  DC-GREG-DATE-MDCY         PIC 9(08).
   764         16  DC-GREG-DATE-MDCY-R REDEFINES
   765                              DC-GREG-DATE-MDCY.
   766             20  DC-MDCY-MONTH         PIC 99.
   767             20  DC-MDCY-DAY           PIC 99.
   768             20  DC-MDCY-CEN           PIC 99.
   769             20  DC-MDCY-YEAR          PIC 99.
   770    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   771        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   772    12  DC-EL310-DATE                  PIC X(21).
   773    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL1524.cbl
   775*                                COPY ELCEMIB.
   776******************************************************************
   777*                                                                *
   778*                                                                *
   779*                            ELCEMIB.                            *
   780*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   781*                            VMOD=2.005                          *
   782*                                                                *
   783*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   784*                                                                *
   785******************************************************************
   786 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   787     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   788     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   789     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   790     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   791     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   792     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   793     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   794     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   795     12  EMI-SWITCH1             PIC X        VALUE '1'.
   796         88  EMI-NO-ERRORS                    VALUE '1'.
   797         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   798         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   799     12  EMI-SWITCH2             PIC X        VALUE '1'.
   800         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   801     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   802         88  EMI-AREA1-EMPTY                  VALUE '1'.
   803         88  EMI-AREA1-FULL                   VALUE '2'.
   804     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   805         88  EMI-AREA2-EMPTY                  VALUE '1'.
   806         88  EMI-AREA2-FULL                   VALUE '2'.
   807     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   808         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   809         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   810         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   811         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   812         88  EMI-BYPASS-FATALS                VALUE 'X'.
   813     12  EMI-ERROR-LINES.
   814         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   815         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   816         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   817         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   818             20  EMI-ERR-CODES OCCURS 10 TIMES.
   819                 24  EMI-ERR-NUM         PIC X(4).
   820                 24  EMI-FILLER          PIC X.
   821                 24  EMI-SEV             PIC X.
   822                 24  FILLER              PIC X.
   823             20  FILLER                  PIC X(02).
   824     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   825         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   826             20  EMI-ERROR-NUMBER    PIC X(4).
   827             20  EMI-FILL            PIC X.
   828             20  EMI-SEVERITY        PIC X.
   829             20  FILLER              PIC X.
   830             20  EMI-ERROR-TEXT.
   831                 24  EMI-TEXT-VARIABLE   PIC X(10).
   832                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL1524.cbl
   833     12  EMI-SEVERITY-SAVE           PIC X.
   834         88  EMI-NOTE                    VALUE 'N'.
   835         88  EMI-WARNING                 VALUE 'W'.
   836         88  EMI-FORCABLE                VALUE 'F'.
   837         88  EMI-FATAL                   VALUE 'X'.
   838     12  EMI-MESSAGE-FLAG            PIC X.
   839         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   840         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   841     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   842     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   843         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   844         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   845         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   846     12  FILLER                      PIC X(137)  VALUE SPACES.
   847     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   848     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   849     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   850     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   851
   852 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL1524.cbl
   854*                                COPY ELPRTCVD.
   855*****************************************************************
   856*                                                               *
   857*                            ELPRTCVD.                          *
   858*                            VMOD=2.001                         *
   859*****************************************************************.
   860
   861******************************************************************
   862***   WORK AREAS  FOR TERMINAL ONLINE PRINT ROUTINE
   863***                 -ELPRTCVD-
   864***   TO BE USED WITH PROCEDURE COPY MEMBER -ELPRTCVP-
   865******************************************************************
   866
   867 01  S-WORK-AREA                     SYNC.
   868     12  WS-LINE-LEN                 PIC S9(4)       VALUE +80
   869                                     COMP.
   870
   871     12  WS-LINE-LENGTH              PIC S9(4)       VALUE ZERO
   872                                     COMP.
   873
   874     12  WS-BUFFER-SIZE              PIC S9(4)       VALUE +1916
   875                                     COMP.
   876
   877     12  WS-BUFFER-LENGTH            PIC S9(4)       VALUE ZERO
   878                                     COMP.
   879
   880     12  WS-PROG-END                 PIC X           VALUE SPACES.
   881
   882     12  WS-PRINT-AREA.
   883         16  WS-PASSED-CNTL-CHAR     PIC X           VALUE SPACES.
   884           88  SINGLE-SPACE                          VALUE ' '.
   885           88  DOUBLE-SPACE                          VALUE '0'.
   886           88  TRIPLE-SPACE                          VALUE '-'.
   887           88  TOP-PAGE                              VALUE '1'.
   888
   889         16  WS-PASSED-DATA.
   890             20  WS-PRINT-BYTE       PIC X
   891                 OCCURS 132 TIMES    INDEXED BY PRT-INDEX.
   892
   893     12  WS-LINE-CNT                 PIC S9(3)        VALUE ZERO
   894                                     COMP-3.
   895     12  WS-WCC-CNTL                 PIC X(1)         VALUE 'H'.
   896
   897     12  WS-EM                       PIC S9(4)        VALUE +25
   898                                     COMP.
   899     12  FILLER   REDEFINES WS-EM.
   900         16  FILLER                  PIC X.
   901         16  T-EM                    PIC X.
   902
   903*    12  WS-SS                       PIC S9(4)        VALUE +21
   904     12  WS-SS                       PIC S9(4)        VALUE +10
   905                                     COMP.
   906     12  FILLER   REDEFINES WS-SS.
   907         16  FILLER                  PIC X.
   908         16  T-SS                    PIC X.
   909
   910     12  WS-TP                       PIC S9(4)      VALUE +12
   911                                     COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL1524.cbl
   912     12  FILLER   REDEFINES WS-TP.
   913         16  FILLER                  PIC X.
   914         16  T-TP                    PIC X.
   915
   916     12  WS-FIRST-TIME-SW            PIC X           VALUE '1'.
   917         88  FIRST-TIME                              VALUE '1'.
   918         88  FIRST-LINE-NEXT-BUFFER                  VALUE '2'.
   919
   920     12  WS-BUFFER-AREA.
   921         16  WS-BUFFER-BYTE          PIC X
   922             OCCURS 1920 TIMES       INDEXED BY BUFFER-INDEX
   923                                                BUFFER-INDEX2.
   924
   925******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL1524.cbl
   927****************************************************************
   928*
   929* Copyright (c) 2007 by Clerity Solutions, Inc.
   930* All rights reserved.
   931*
   932****************************************************************
   933 01  DFHEIV.
   934   02  DFHEIV0               PIC X(35).
   935   02  DFHEIV1               PIC X(08).
   936   02  DFHEIV2               PIC X(08).
   937   02  DFHEIV3               PIC X(08).
   938   02  DFHEIV4               PIC X(06).
   939   02  DFHEIV5               PIC X(04).
   940   02  DFHEIV6               PIC X(04).
   941   02  DFHEIV7               PIC X(02).
   942   02  DFHEIV8               PIC X(02).
   943   02  DFHEIV9               PIC X(01).
   944   02  DFHEIV10              PIC S9(7) COMP-3.
   945   02  DFHEIV11              PIC S9(4) COMP SYNC.
   946   02  DFHEIV12              PIC S9(4) COMP SYNC.
   947   02  DFHEIV13              PIC S9(4) COMP SYNC.
   948   02  DFHEIV14              PIC S9(4) COMP SYNC.
   949   02  DFHEIV15              PIC S9(4) COMP SYNC.
   950   02  DFHEIV16              PIC S9(9) COMP SYNC.
   951   02  DFHEIV17              PIC X(04).
   952   02  DFHEIV18              PIC X(04).
   953   02  DFHEIV19              PIC X(04).
   954   02  DFHEIV20              USAGE IS POINTER.
   955   02  DFHEIV21              USAGE IS POINTER.
   956   02  DFHEIV22              USAGE IS POINTER.
   957   02  DFHEIV23              USAGE IS POINTER.
   958   02  DFHEIV24              USAGE IS POINTER.
   959   02  DFHEIV25              PIC S9(9) COMP SYNC.
   960   02  DFHEIV26              PIC S9(9) COMP SYNC.
   961   02  DFHEIV27              PIC S9(9) COMP SYNC.
   962   02  DFHEIV28              PIC S9(9) COMP SYNC.
   963   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   964   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   965   02  FILLER                PIC X(02).
   966   02  DFHEIV99              PIC X(08) VALUE SPACE.
   967   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   968   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   969   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   970   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   971 LINKAGE  SECTION.
   972*****************************************************************
   973*                                                               *
   974* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   975* All rights reserved.                                          *
   976*                                                               *
   977*****************************************************************
   978 01  dfheiblk.
   979     02  eibtime          pic s9(7) comp-3.
   980     02  eibdate          pic s9(7) comp-3.
   981     02  eibtrnid         pic x(4).
   982     02  eibtaskn         pic s9(7) comp-3.
   983     02  eibtrmid         pic x(4).
   984     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL1524.cbl
   985     02  eibcposn         pic s9(4) comp.
   986     02  eibcalen         pic s9(4) comp.
   987     02  eibaid           pic x(1).
   988     02  eibfiller1       pic x(1).
   989     02  eibfn            pic x(2).
   990     02  eibfiller2       pic x(2).
   991     02  eibrcode         pic x(6).
   992     02  eibfiller3       pic x(2).
   993     02  eibds            pic x(8).
   994     02  eibreqid         pic x(8).
   995     02  eibrsrce         pic x(8).
   996     02  eibsync          pic x(1).
   997     02  eibfree          pic x(1).
   998     02  eibrecv          pic x(1).
   999     02  eibsend          pic x(1).
  1000     02  eibatt           pic x(1).
  1001     02  eibeoc           pic x(1).
  1002     02  eibfmh           pic x(1).
  1003     02  eibcompl         pic x(1).
  1004     02  eibsig           pic x(1).
  1005     02  eibconf          pic x(1).
  1006     02  eiberr           pic x(1).
  1007     02  eibrldbk         pic x(1).
  1008     02  eiberrcd         pic x(4).
  1009     02  eibsynrb         pic x(1).
  1010     02  eibnodat         pic x(1).
  1011     02  eibfiller5       pic x(2).
  1012     02  eibresp          pic 9(09) comp.
  1013     02  eibresp2         pic 9(09) comp.
  1014     02  dfheigdj         pic s9(4) comp.
  1015     02  dfheigdk         pic s9(4) comp.
  1016 01  DFHCOMMAREA                 PIC X(1024).
  1017
  1018*    COPY ELCACTQ.
  1019******************************************************************
  1020*                                                                *
  1021*                            ELCACTQ.                            *
  1022*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  1023*                            VMOD=2.004                          *
  1024*                                                                *
  1025*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  1026*                                                                *
  1027*   FILE TYPE = VSAM,KSDS                                        *
  1028*   RECORD SIZE = 60     RECFORM = FIXED                         *
  1029*                                                                *
  1030*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  1031*       ALTERNATE INDEX = NONE                                   *
  1032*                                                                *
  1033*   LOG = YES                                                    *
  1034*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1035*                                                                *
  1036*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  1037******************************************************************
  1038
  1039 01  ACTIVITY-QUE.
  1040     12  AQ-RECORD-ID                PIC XX.
  1041         88  VALID-AQ-ID                VALUE 'AQ'.
  1042
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL1524.cbl
  1043     12  AQ-CONTROL-PRIMARY.
  1044         16  AQ-COMPANY-CD           PIC X.
  1045         16  AQ-CARRIER              PIC X.
  1046         16  AQ-CLAIM-NO             PIC X(7).
  1047         16  AQ-CERT-NO.
  1048             20  AQ-CERT-PRIME       PIC X(10).
  1049             20  AQ-CERT-SFX         PIC X.
  1050
  1051     12  AQ-PENDING-ACTIVITY-FLAGS.
  1052         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  1053         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  1054             88  PENDING-PAYMENTS       VALUE '1'.
  1055         16  AQ-PENDING-STATUS-FLAG  PIC X.
  1056             88  PENDING-FULL-PRINT     VALUE '1'.
  1057             88  PENDING-PART-PRINT     VALUE '2'.
  1058         16  AQ-PENDING-LETTER-FLAG  PIC X.
  1059             88  PENDING-LETTERS        VALUE '1'.
  1060         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  1061             88  PENDING-RESTORE        VALUE 'C'.
  1062             88  PENDING-RESTORE-LETTER VALUE 'L'.
  1063
  1064     12  FILLER                      PIC X(20).
  1065
  1066     12  AQ-RESEND-DATE              PIC XX.
  1067     12  AQ-FOLLOWUP-DATE            PIC XX.
  1068     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  1069     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  1070     12  AQ-AUTO-LETTER              PIC X(4).
  1071     12  FILLER                      PIC XX.
  1072     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  1073*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL1524.cbl
  1075*    COPY ELCCNTL.
  1076******************************************************************
  1077*                                                                *
  1078*                                                                *
  1079*                            ELCCNTL.                            *
  1080*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1081*                            VMOD=2.059                          *
  1082*                                                                *
  1083*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1084*                                                                *
  1085*   FILE TYPE = VSAM,KSDS                                        *
  1086*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1087*                                                                *
  1088*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1089*       ALTERNATE INDEX = NONE                                   *
  1090*                                                                *
  1091*   LOG = YES                                                    *
  1092*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1093******************************************************************
  1094*                   C H A N G E   L O G
  1095*
  1096* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1097*-----------------------------------------------------------------
  1098*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1099* EFFECTIVE    NUMBER
  1100*-----------------------------------------------------------------
  1101* 082503                   PEMA  ADD BENEFIT GROUP
  1102* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1103* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1104* 092705    2005050300006  PEMA  ADD SPP LEASES
  1105* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1106* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1107* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1108* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1109******************************************************************
  1110*
  1111 01  CONTROL-FILE.
  1112     12  CF-RECORD-ID                       PIC XX.
  1113         88  VALID-CF-ID                        VALUE 'CF'.
  1114
  1115     12  CF-CONTROL-PRIMARY.
  1116         16  CF-COMPANY-ID                  PIC XXX.
  1117         16  CF-RECORD-TYPE                 PIC X.
  1118             88  CF-COMPANY-MASTER              VALUE '1'.
  1119             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1120             88  CF-STATE-MASTER                VALUE '3'.
  1121             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1122             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1123             88  CF-CARRIER-MASTER              VALUE '6'.
  1124             88  CF-MORTALITY-MASTER            VALUE '7'.
  1125             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1126             88  CF-TERMINAL-MASTER             VALUE '9'.
  1127             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1128             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1129             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1130             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1131             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1132             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL1524.cbl
  1133             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1134             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1135             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1136         16  CF-ACCESS-CD-GENL              PIC X(4).
  1137         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1138             20  CF-PROCESSOR               PIC X(4).
  1139         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1140             20  CF-STATE-CODE              PIC XX.
  1141             20  FILLER                     PIC XX.
  1142         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1143             20  FILLER                     PIC XX.
  1144             20  CF-HI-BEN-IN-REC           PIC XX.
  1145         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1146             20  FILLER                     PIC XXX.
  1147             20  CF-CARRIER-CNTL            PIC X.
  1148         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1149             20  FILLER                     PIC XX.
  1150             20  CF-HI-TYPE-IN-REC          PIC 99.
  1151         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1152             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1153                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1154             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1155             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1156         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1157             20  FILLER                     PIC X.
  1158             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1159         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1160             20  FILLER                     PIC XX.
  1161             20  CF-MORTGAGE-PLAN           PIC XX.
  1162         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1163
  1164     12  CF-LAST-MAINT-DT                   PIC XX.
  1165     12  CF-LAST-MAINT-BY                   PIC X(4).
  1166     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1167
  1168     12  CF-RECORD-BODY                     PIC X(728).
  1169
  1170
  1171****************************************************************
  1172*             COMPANY MASTER RECORD                            *
  1173****************************************************************
  1174
  1175     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1176         16  CF-COMPANY-ADDRESS.
  1177             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1178             20  CF-CL-IN-CARE-OF           PIC X(30).
  1179             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1180             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1181             20  CF-CL-CITY-STATE           PIC X(30).
  1182             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1183             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1184         16  CF-COMPANY-CD                  PIC X.
  1185         16  CF-COMPANY-PASSWORD            PIC X(8).
  1186         16  CF-SECURITY-OPTION             PIC X.
  1187             88  ALL-SECURITY                   VALUE '1'.
  1188             88  COMPANY-VERIFY                 VALUE '2'.
  1189             88  PROCESSOR-VERIFY               VALUE '3'.
  1190             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL1524.cbl
  1191             88  ALL-BUT-TERM                   VALUE '5'.
  1192         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1193             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1194         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1195             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1196         16  CF-INFORCE-LOCATION            PIC X.
  1197             88  CERTS-ARE-ONLINE               VALUE '1'.
  1198             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1199             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1200         16  CF-LOWER-CASE-LETTERS          PIC X.
  1201         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1202             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1203             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1204             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1205             88  CF-ACCNT-CNTL                  VALUE '3'.
  1206             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1207
  1208         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1209         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1210
  1211         16  CF-LGX-CREDIT-USER             PIC X.
  1212             88  CO-IS-NOT-USER                 VALUE 'N'.
  1213             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1214
  1215         16 CF-CREDIT-CALC-CODES.
  1216             20  CF-CR-REM-TERM-CALC PIC X.
  1217               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1218               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1219               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1220               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1221               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1222               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1223               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1224             20  CF-CR-R78-METHOD           PIC X.
  1225               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1226               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1227
  1228         16  CF-CLAIM-CONTROL-COUNTS.
  1229             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1230                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1231
  1232             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1233                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1234
  1235             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1236                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1237
  1238             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1239                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1240
  1241         16  CF-CURRENT-MONTH-END           PIC XX.
  1242
  1243         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1244             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1245             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1246             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1247             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1248                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL1524.cbl
  1249                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1250             20  CF-CO-PREM-REJECT-SW       PIC X.
  1251                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1252                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1253             20  CF-CO-REF-REJECT-SW        PIC X.
  1254                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1255                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1256
  1257         16  CF-CO-REPORTING-DT             PIC XX.
  1258         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1259         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1260           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1261           88  CF-CO-MONTH-END                  VALUE '1'.
  1262
  1263         16  CF-LGX-CLAIM-USER              PIC X.
  1264             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1265             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1266
  1267         16  CF-CREDIT-EDIT-CONTROLS.
  1268             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1269             20  CF-MIN-AGE                 PIC 99.
  1270             20  CF-DEFAULT-AGE             PIC 99.
  1271             20  CF-MIN-TERM                PIC S999      COMP-3.
  1272             20  CF-MAX-TERM                PIC S999      COMP-3.
  1273             20  CF-DEFAULT-SEX             PIC X.
  1274             20  CF-JOINT-AGE-INPUT         PIC X.
  1275                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1276             20  CF-BIRTH-DATE-INPUT        PIC X.
  1277                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1278             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1279                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1280                 88  CF-ZERO-CARRIER            VALUE '1'.
  1281                 88  CF-ZERO-GROUPING           VALUE '2'.
  1282                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1283             20  CF-EDIT-SW                 PIC X.
  1284                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1285             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1286             20  CF-CR-PR-METHOD            PIC X.
  1287               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1288               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1289             20  FILLER                     PIC X.
  1290
  1291         16  CF-CREDIT-MISC-CONTROLS.
  1292             20  CF-REIN-TABLE-SW           PIC X.
  1293                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1294             20  CF-COMP-TABLE-SW           PIC X.
  1295                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1296             20  CF-EXPERIENCE-RETENTION-AGE
  1297                                            PIC S9        COMP-3.
  1298             20  CF-CONVERSION-DT           PIC XX.
  1299             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1300             20  CF-RUN-FREQUENCY-SW        PIC X.
  1301                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1302                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1303
  1304             20  CF-CR-CHECK-NO-CONTROL.
  1305                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1306                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL1524.cbl
  1307                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1308                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1309                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1310                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1311
  1312                 24  CF-CR-CHECK-COUNT       REDEFINES
  1313                     CF-CR-CHECK-COUNTER      PIC X(4).
  1314
  1315                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1316                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1317
  1318                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1319                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1320                 24  CF-MAIL-PROCESSING       PIC X.
  1321                     88  MAIL-PROCESSING          VALUE 'Y'.
  1322
  1323         16  CF-MISC-SYSTEM-CONTROL.
  1324             20  CF-SYSTEM-C                 PIC X.
  1325                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1326             20  CF-SYSTEM-D                 PIC X.
  1327                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1328             20  CF-SOC-SEC-NO-SW            PIC X.
  1329                 88  SOC-SEC-NO-USED             VALUE '1'.
  1330             20  CF-MEMBER-NO-SW             PIC X.
  1331                 88  MEMBER-NO-USED              VALUE '1'.
  1332             20  CF-TAX-ID-NUMBER            PIC X(11).
  1333             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1334             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1335                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1336                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1337                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1338                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1339             20  CF-SYSTEM-E                 PIC X.
  1340                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1341
  1342         16  CF-LGX-LIFE-USER               PIC X.
  1343             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1344             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1345
  1346         16  CF-CR-MONTH-END-DT             PIC XX.
  1347
  1348         16  CF-FILE-MAINT-DATES.
  1349             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1350                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1351             20  CF-LAST-BATCH       REDEFINES
  1352                 CF-LAST-BATCH-NO               PIC X(4).
  1353             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1354             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1355             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1356             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1357             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1358             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1359             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1360             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1361             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1362             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1363
  1364         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL1524.cbl
  1365         16  FILLER                         PIC X.
  1366
  1367         16  CF-ALT-MORT-CODE               PIC X(4).
  1368         16  CF-MEMBER-CAPTION              PIC X(10).
  1369
  1370         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1371             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1372             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1373             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1374             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1375             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1376
  1377         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1378
  1379         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1380         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1381         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1382         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1383
  1384         16  CF-AH-OVERRIDE-L1              PIC X.
  1385         16  CF-AH-OVERRIDE-L2              PIC XX.
  1386         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1387         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1388
  1389         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1390         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1391
  1392         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1393         16  CF-AR-LAST-EL860-DT            PIC XX.
  1394         16  CF-MP-MONTH-END-DT             PIC XX.
  1395
  1396         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1397         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1398             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1399
  1400         16  CF-AR-MONTH-END-DT             PIC XX.
  1401
  1402         16  CF-CRDTCRD-USER                PIC X.
  1403             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1404             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1405
  1406         16  CF-CC-MONTH-END-DT             PIC XX.
  1407
  1408         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1409
  1410         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1411             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1412             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1413             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1414         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1415         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1416         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1417         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1418             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1419             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1420         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1421         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1422         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL1524.cbl
  1423             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1424         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1425
  1426         16  CF-CL-ZIP-CODE.
  1427             20  CF-CL-ZIP-PRIME.
  1428                 24  CF-CL-ZIP-1ST          PIC X.
  1429                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1430                 24  FILLER                 PIC X(4).
  1431             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1432         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1433             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1434             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1435             20  FILLER                     PIC XXX.
  1436
  1437         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1438         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1439         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1440         16  CF-CO-OPTION-START-DATE        PIC XX.
  1441         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1442           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1443                                                      '3' '4'.
  1444           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1445           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1446           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1447           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1448           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1449           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1450
  1451         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1452
  1453         16  CF-PAYMENT-APPROVAL-LEVELS.
  1454             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1455             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1456             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1457             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1458             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1459             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1460
  1461         16  CF-END-USER-REPORTING-USER     PIC X.
  1462             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1463             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1464
  1465         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1466             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1467             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1468
  1469         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1470
  1471         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1472         16  FILLER                         PIC X.
  1473
  1474         16  CF-CREDIT-ARCHIVE-CNTL.
  1475             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1476             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1477             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1478
  1479         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1480
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL1524.cbl
  1481         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1482             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1483             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1484
  1485         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1486             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1487             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1488
  1489         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1490
  1491         16  CF-CO-ACH-ID-CODE              PIC  X.
  1492             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1493             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1494             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1495         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1496         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1497         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1498         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1499         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1500         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1501         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1502         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1503         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1504                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1505         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1506                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1507
  1508         16  CF-CO-OVER-SHORT.
  1509             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1510             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1511
  1512*         16  FILLER                         PIC X(102).
  1513         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1514             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1515             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1516
  1517         16  CF-AH-APPROVAL-DAYS.
  1518             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1519             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1520             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1521             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1522
  1523         16  FILLER                         PIC X(82).
  1524****************************************************************
  1525*             PROCESSOR/USER RECORD                            *
  1526****************************************************************
  1527
  1528     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1529         16  CF-PROCESSOR-NAME              PIC X(30).
  1530         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1531         16  CF-PROCESSOR-TITLE             PIC X(26).
  1532         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1533                 88  MESSAGE-YES                VALUE 'Y'.
  1534                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1535
  1536*****************************************************
  1537****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1538****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL1524.cbl
  1539****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1540****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1541*****************************************************
  1542
  1543         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1544             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1545             20  CF-APPLICATION-FORCE       PIC X.
  1546             20  CF-INDIVIDUAL-APP.
  1547                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1548                     28  CF-BROWSE-APP      PIC X.
  1549                     28  CF-UPDATE-APP      PIC X.
  1550
  1551         16  CF-CURRENT-TERM-ON             PIC X(4).
  1552         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1553             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1554             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1555             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1556             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1557             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1558             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1559             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1560         16  CF-PROCESSOR-CARRIER           PIC X.
  1561             88  NO-CARRIER-SECURITY            VALUE ' '.
  1562         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1563             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1564         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1565             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1566         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1567             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1568
  1569         16  CF-PROC-SYS-ACCESS-SW.
  1570             20  CF-PROC-CREDIT-CLAIMS-SW.
  1571                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1572                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1573                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1574                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1575             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1576                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1577                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1578             20  CF-PROC-LIFE-GNRLDGR-SW.
  1579                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1580                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1581                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1582                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1583             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1584                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1585                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1586         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1587             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1588             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1589         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1590
  1591         16  CF-APPROVAL-LEVEL                  PIC X.
  1592             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1593             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1594             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1595             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1596
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL1524.cbl
  1597         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1598
  1599         16  CF-LANGUAGE-TYPE                   PIC X.
  1600             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1601             88  CF-LANG-IS-FR                      VALUE 'F'.
  1602         16  FILLER                             PIC  X(240).
  1603
  1604****************************************************************
  1605*             PROCESSOR/REMINDERS RECORD                       *
  1606****************************************************************
  1607
  1608     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1609         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1610             20  CF-START-REMIND-DT         PIC XX.
  1611             20  CF-END-REMIND-DT           PIC XX.
  1612             20  CF-REMINDER-TEXT           PIC X(50).
  1613         16  FILLER                         PIC X(296).
  1614
  1615
  1616****************************************************************
  1617*             STATE MASTER RECORD                              *
  1618****************************************************************
  1619
  1620     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1621         16  CF-STATE-ABBREVIATION          PIC XX.
  1622         16  CF-STATE-NAME                  PIC X(25).
  1623         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1624         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1625             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1626             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1627             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1628             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1629                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1630                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1631             20  CF-ST-PREM-REJECT-SW       PIC X.
  1632                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1633                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1634             20  CF-ST-REF-REJECT-SW        PIC X.
  1635                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1636                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1637         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1638         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1639         16  CF-ST-REFUND-RULES.
  1640             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1641             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1642             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1643         16  CF-ST-FST-PMT-EXTENSION.
  1644             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1645             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1646                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1647                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1648                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1649                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1650         16  CF-ST-STATE-CALL.
  1651             20  CF-ST-CALL-UNEARNED        PIC X.
  1652             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1653             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1654         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL1524.cbl
  1655             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1656             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1657         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1658         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1659         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1660         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1661         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1662         16  FILLER                         PIC X.
  1663         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1664             20  CF-ST-BENEFIT-CD           PIC XX.
  1665             20  CF-ST-BENEFIT-KIND         PIC X.
  1666                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1667                 88  CF-ST-AH-KIND              VALUE 'A'.
  1668             20  CF-ST-REM-TERM-CALC        PIC X.
  1669                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1670                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1671                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1672                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1673                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1674                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1675                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1676                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1677
  1678             20  CF-ST-REFUND-CALC          PIC X.
  1679                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1680                 88  ST-REFD-BY-R78             VALUE '1'.
  1681                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1682                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1683                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1684                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1685                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1686                 88  ST-REFD-UTAH               VALUE '7'.
  1687                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1688                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1689                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1690
  1691             20  CF-ST-EARNING-CALC         PIC X.
  1692                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1693                 88  ST-EARN-BY-R78             VALUE '1'.
  1694                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1695                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1696                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1697                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1698                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1699                 88  ST-EARN-MEAN               VALUE '8'.
  1700                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1701
  1702             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1703                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1704                 88  ST-OVRD-BY-R78             VALUE '1'.
  1705                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1706                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1707                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1708                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1709                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1710                 88  ST-OVRD-MEAN               VALUE '8'.
  1711                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1712             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL1524.cbl
  1713
  1714         16  CF-ST-COMMISSION-CAPS.
  1715             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1716             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1717             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1718             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1719         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1720                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1721
  1722         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1723
  1724         16  CF-ST-STATUTORY-INTEREST.
  1725             20  CF-ST-STAT-DATE-FROM       PIC X.
  1726                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1727                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1728             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1729             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1730             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1731             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1732             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1733
  1734         16  CF-ST-OVER-SHORT.
  1735             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1736             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1737
  1738         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1739
  1740         16  CF-ST-RT-CALC                  PIC X.
  1741
  1742         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1743         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1744         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1745         16  CF-ST-RF-LR-CALC               PIC X.
  1746         16  CF-ST-RF-LL-CALC               PIC X.
  1747         16  CF-ST-RF-LN-CALC               PIC X.
  1748         16  CF-ST-RF-AH-CALC               PIC X.
  1749         16  CF-ST-RF-CP-CALC               PIC X.
  1750*        16  FILLER                         PIC X(206).
  1751*CIDMOD         16  FILLER                         PIC X(192).
  1752         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1753             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1754         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1755         16  FILLER                         PIC X(187).
  1756
  1757****************************************************************
  1758*             BENEFIT MASTER RECORD                            *
  1759****************************************************************
  1760
  1761     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1762         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1763             20  CF-BENEFIT-CODE            PIC XX.
  1764             20  CF-BENEFIT-NUMERIC  REDEFINES
  1765                 CF-BENEFIT-CODE            PIC XX.
  1766             20  CF-BENEFIT-ALPHA           PIC XXX.
  1767             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1768             20  CF-BENEFIT-COMMENT         PIC X(10).
  1769
  1770             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL1524.cbl
  1771                 88  CF-REDUCING                VALUE 'R'.
  1772                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1773
  1774             20  CF-SPECIAL-CALC-CD         PIC X.
  1775                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1776                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1777                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1778                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1779                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1780                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1781                 88  CF-FARM-PLAN               VALUE 'F'.
  1782                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1783                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1784                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1785                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1786                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1787                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1788                 88  CF-PRUDENTIAL              VALUE 'P'.
  1789                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1790                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1791                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1792                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1793                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1794                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1795
  1796             20  CF-JOINT-INDICATOR         PIC X.
  1797                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1798
  1799*            20  FILLER                     PIC X(12).
  1800             20  FILLER                     PIC X(11).
  1801             20  CF-BENEFIT-CATEGORY        PIC X.
  1802             20  CF-LOAN-TYPE               PIC X(8).
  1803
  1804             20  CF-CO-REM-TERM-CALC        PIC X.
  1805                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1806                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1807                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1808                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1809                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1810
  1811             20  CF-CO-EARNINGS-CALC        PIC X.
  1812                 88  CO-EARN-BY-R78             VALUE '1'.
  1813                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1814                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1815                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1816                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1817                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1818                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1819                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1820
  1821             20  CF-CO-REFUND-CALC          PIC X.
  1822                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1823                 88  CO-REFD-BY-R78             VALUE '1'.
  1824                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1825                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1826                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1827                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1828                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL1524.cbl
  1829                 88  CO-REFD-MEAN               VALUE '8'.
  1830                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1831                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1832                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1833
  1834             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1835                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1836                 88  CO-OVRD-BY-R78             VALUE '1'.
  1837                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1838                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1839                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1840                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1841                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1842                 88  CO-OVRD-MEAN               VALUE '8'.
  1843                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1844
  1845             20  CF-CO-BEN-I-G-CD           PIC X.
  1846                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1847                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1848                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1849
  1850         16  FILLER                         PIC X(304).
  1851
  1852
  1853****************************************************************
  1854*             CARRIER MASTER RECORD                            *
  1855****************************************************************
  1856
  1857     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1858         16  CF-ADDRESS-DATA.
  1859             20  CF-MAIL-TO-NAME            PIC X(30).
  1860             20  CF-IN-CARE-OF              PIC X(30).
  1861             20  CF-ADDRESS-LINE-1          PIC X(30).
  1862             20  CF-ADDRESS-LINE-2          PIC X(30).
  1863             20  CF-CITY-STATE              PIC X(30).
  1864             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1865             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1866
  1867         16  CF-CLAIM-NO-CONTROL.
  1868             20  CF-CLAIM-NO-METHOD         PIC X.
  1869                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1870                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1871                 88  CLAIM-NO-SEQ               VALUE '3'.
  1872                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1873             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1874                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1875                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1876                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1877
  1878         16  CF-CHECK-NO-CONTROL.
  1879             20  CF-CHECK-NO-METHOD         PIC X.
  1880                 88  CHECK-NO-MANUAL            VALUE '1'.
  1881                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1882                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1883                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1884             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1885                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1886
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL1524.cbl
  1887         16  CF-DOMICILE-STATE              PIC XX.
  1888
  1889         16  CF-EXPENSE-CONTROLS.
  1890             20  CF-EXPENSE-METHOD          PIC X.
  1891                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1892                 88  DOLLARS-PER-PMT            VALUE '2'.
  1893                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1894                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1895             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1896             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1897
  1898         16  CF-CORRESPONDENCE-CONTROL.
  1899             20  CF-LETTER-RESEND-OPT       PIC X.
  1900                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1901                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1902             20  FILLER                     PIC X(4).
  1903
  1904         16  CF-RESERVE-CONTROLS.
  1905             20  CF-MANUAL-SW               PIC X.
  1906                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1907             20  CF-FUTURE-SW               PIC X.
  1908                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1909             20  CF-PTC-SW                  PIC X.
  1910                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1911             20  CF-IBNR-SW                 PIC X.
  1912                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1913             20  CF-PTC-LF-SW               PIC X.
  1914                 88  CF-LF-PTC-USED             VALUE '1'.
  1915             20  CF-CDT-ACCESS-METHOD       PIC X.
  1916                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1917                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1918                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1919             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1920
  1921         16  CF-CLAIM-CALC-METHOD           PIC X.
  1922             88  360-PLUS-MONTHS                VALUE '1'.
  1923             88  365-PLUS-MONTHS                VALUE '2'.
  1924             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1925             88  360-DAILY                      VALUE '4'.
  1926             88  365-DAILY                      VALUE '5'.
  1927
  1928         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1929         16  FILLER                         PIC X(11).
  1930
  1931         16  CF-LIMIT-AMOUNTS.
  1932             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1933             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1934             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1935             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1936             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1937             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1938             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1939             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1940             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1941             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1942
  1943         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1944         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL1524.cbl
  1945         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1946
  1947         16  CF-ZIP-CODE.
  1948             20  CF-ZIP-PRIME.
  1949                 24  CF-ZIP-1ST             PIC X.
  1950                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1951                 24  FILLER                 PIC X(4).
  1952             20  CF-ZIP-PLUS4               PIC X(4).
  1953         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1954             20  CF-CAN-POSTAL-1            PIC XXX.
  1955             20  CF-CAN-POSTAL-2            PIC XXX.
  1956             20  FILLER                     PIC XXX.
  1957
  1958         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1959         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1960         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1961
  1962         16  CF-RATING-SWITCH               PIC X.
  1963             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1964             88  CF-NO-RATING                   VALUE 'N'.
  1965
  1966         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1967
  1968         16  CF-CARRIER-OVER-SHORT.
  1969             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1970             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1971
  1972         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1973         16  CF-SECPAY-SWITCH               PIC X.
  1974             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1975             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1976         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1977         16  FILLER                         PIC X(448).
  1978*        16  FILLER                         PIC X(452).
  1979
  1980
  1981****************************************************************
  1982*             MORTALITY MASTER RECORD                          *
  1983****************************************************************
  1984
  1985     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1986         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1987                                INDEXED BY CF-MORT-NDX.
  1988             20  CF-MORT-TABLE              PIC X(5).
  1989             20  CF-MORT-TABLE-TYPE         PIC X.
  1990                 88  CF-MORT-JOINT              VALUE 'J'.
  1991                 88  CF-MORT-SINGLE             VALUE 'S'.
  1992                 88  CF-MORT-COMBINED           VALUE 'C'.
  1993                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1994                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1995             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1996             20  CF-MORT-AGE-METHOD         PIC XX.
  1997                 88  CF-AGE-LAST                VALUE 'AL'.
  1998                 88  CF-AGE-NEAR                VALUE 'AN'.
  1999             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2000             20  CF-MORT-ADJUSTMENT-DIRECTION
  2001                                            PIC X.
  2002                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL1524.cbl
  2003                 88  CF-PLUS                    VALUE '+'.
  2004             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2005             20  CF-MORT-JOINT-CODE         PIC X.
  2006                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2007             20  CF-MORT-PC-Q               PIC X.
  2008                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2009             20  CF-MORT-TABLE-CODE         PIC X(4).
  2010             20  CF-MORT-COMMENTS           PIC X(15).
  2011             20  FILLER                     PIC X(14).
  2012
  2013         16  FILLER                         PIC X(251).
  2014
  2015
  2016****************************************************************
  2017*             BUSSINESS TYPE MASTER RECORD                     *
  2018****************************************************************
  2019
  2020     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2021* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2022* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2023* AND RECORD 05 IS TYPES 81-99
  2024         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2025             20  CF-BUSINESS-TITLE          PIC  X(19).
  2026             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2027                                            PIC S9V9(4) COMP-3.
  2028             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2029             20  FILLER                     PIC  X.
  2030         16  FILLER                         PIC  X(248).
  2031
  2032
  2033****************************************************************
  2034*             TERMINAL MASTER RECORD                           *
  2035****************************************************************
  2036
  2037     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2038
  2039         16  CF-COMPANY-TERMINALS.
  2040             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2041                                  PIC X(4).
  2042         16  FILLER               PIC X(248).
  2043
  2044
  2045****************************************************************
  2046*             LIFE EDIT MASTER RECORD                          *
  2047****************************************************************
  2048
  2049     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2050         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2051             20  CF-LIFE-CODE-IN            PIC XX.
  2052             20  CF-LIFE-CODE-OUT           PIC XX.
  2053         16  FILLER                         PIC X(248).
  2054
  2055
  2056****************************************************************
  2057*             AH EDIT MASTER RECORD                            *
  2058****************************************************************
  2059
  2060     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL1524.cbl
  2061         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2062             20  CF-AH-CODE-IN              PIC XXX.
  2063             20  CF-AH-CODE-OUT             PIC XX.
  2064         16  FILLER                         PIC X(248).
  2065
  2066
  2067****************************************************************
  2068*             CREDIBILITY TABLES                               *
  2069****************************************************************
  2070
  2071     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2072         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2073                             INDEXED BY CF-CRDB-NDX.
  2074             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2075             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2076             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2077         16  FILLER                         PIC  X(332).
  2078
  2079
  2080****************************************************************
  2081*             REPORT CUSTOMIZATION RECORD                      *
  2082****************************************************************
  2083
  2084     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2085         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2086             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2087             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2088             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2089**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2090****       A T-TRANSFER.                                   ****
  2091             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2092
  2093         16  FILLER                         PIC XX.
  2094
  2095         16  CF-CARRIER-CNTL-OPT.
  2096             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2097                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2098                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2099             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2100                                            PIC X.
  2101         16  CF-GROUP-CNTL-OPT.
  2102             20  CF-GROUP-OPT-SEQ           PIC 9.
  2103                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2104                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2105             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2106                                            PIC X(6).
  2107         16  CF-STATE-CNTL-OPT.
  2108             20  CF-STATE-OPT-SEQ           PIC 9.
  2109                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2110                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2111             20  CF-STATE-SELECT OCCURS 3 TIMES
  2112                                            PIC XX.
  2113         16  CF-ACCOUNT-CNTL-OPT.
  2114             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2115                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2116                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2117             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2118                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL1524.cbl
  2119         16  CF-BUS-TYP-CNTL-OPT.
  2120             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2121                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2122                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2123             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2124                                            PIC XX.
  2125         16  CF-LF-TYP-CNTL-OPT.
  2126             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2127                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2128                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2129             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2130                                            PIC XX.
  2131         16  CF-AH-TYP-CNTL-OPT.
  2132             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2133                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2134                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2135             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2136                                            PIC XX.
  2137         16  CF-REPTCD1-CNTL-OPT.
  2138             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2139                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2140                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2141             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2142                                            PIC X(10).
  2143         16  CF-REPTCD2-CNTL-OPT.
  2144             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2145                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2146                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2147             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2148                                            PIC X(10).
  2149         16  CF-USER1-CNTL-OPT.
  2150             20  CF-USER1-OPT-SEQ           PIC 9.
  2151                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2152                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2153             20  CF-USER1-SELECT OCCURS 3 TIMES
  2154                                            PIC X(10).
  2155         16  CF-USER2-CNTL-OPT.
  2156             20  CF-USER2-OPT-SEQ           PIC 9.
  2157                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2158                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2159             20  CF-USER2-SELECT OCCURS 3 TIMES
  2160                                            PIC X(10).
  2161         16  CF-USER3-CNTL-OPT.
  2162             20  CF-USER3-OPT-SEQ           PIC 9.
  2163                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2164                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2165             20  CF-USER3-SELECT OCCURS 3 TIMES
  2166                                            PIC X(10).
  2167         16  CF-USER4-CNTL-OPT.
  2168             20  CF-USER4-OPT-SEQ           PIC 9.
  2169                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2170                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2171             20  CF-USER4-SELECT OCCURS 3 TIMES
  2172                                            PIC X(10).
  2173         16  CF-USER5-CNTL-OPT.
  2174             20  CF-USER5-OPT-SEQ           PIC 9.
  2175                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2176                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL1524.cbl
  2177             20  CF-USER5-SELECT OCCURS 3 TIMES
  2178                                            PIC X(10).
  2179         16  CF-REINS-CNTL-OPT.
  2180             20  CF-REINS-OPT-SEQ           PIC 9.
  2181                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2182                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2183             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2184                 24  CF-REINS-PRIME         PIC XXX.
  2185                 24  CF-REINS-SUB           PIC XXX.
  2186
  2187         16  CF-AGENT-CNTL-OPT.
  2188             20  CF-AGENT-OPT-SEQ           PIC 9.
  2189                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2190                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2191             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2192                                            PIC X(10).
  2193
  2194         16  FILLER                         PIC X(43).
  2195
  2196         16  CF-LOSS-RATIO-SELECT.
  2197             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2198             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2199         16  CF-ENTRY-DATE-SELECT.
  2200             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2201             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2202         16  CF-EFFECTIVE-DATE-SELECT.
  2203             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2204             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2205
  2206         16  CF-EXCEPTION-LIST-IND          PIC X.
  2207             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2208
  2209         16  FILLER                         PIC X(318).
  2210
  2211****************************************************************
  2212*                  EXCEPTION REPORTING RECORD                  *
  2213****************************************************************
  2214
  2215     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2216         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2217             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2218
  2219         16  CF-COMBINED-LIFE-AH-OPT.
  2220             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2221             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2222             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2223             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2224
  2225         16  CF-LIFE-OPT.
  2226             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2227             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2228             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2229             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2230             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2231             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2232             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2233             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2234             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL1524.cbl
  2235             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2236
  2237         16  CF-AH-OPT.
  2238             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2239             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2240             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2241             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2242             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2243             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2244             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2245             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2246             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2247             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2248
  2249         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2250             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2251             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2252             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2253
  2254         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2255
  2256         16  FILLER                         PIC X(673).
  2257
  2258
  2259****************************************************************
  2260*             MORTGAGE SYSTEM PLAN RECORD                      *
  2261****************************************************************
  2262
  2263     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2264         16  CF-PLAN-TYPE                   PIC X.
  2265             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2266             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2267             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2268         16  CF-PLAN-ABBREV                 PIC XXX.
  2269         16  CF-PLAN-DESCRIPT               PIC X(10).
  2270         16  CF-PLAN-NOTES                  PIC X(20).
  2271         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2272         16  CF-PLAN-UNDERWRITING.
  2273             20  CF-PLAN-TERM-DATA.
  2274                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2275                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2276             20  CF-PLAN-AGE-DATA.
  2277                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2278                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2279                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2280             20  CF-PLAN-BENEFIT-DATA.
  2281                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2282                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2283                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2284                                            PIC S9(7)V99  COMP-3.
  2285         16  CF-PLAN-POLICY-FORMS.
  2286             20  CF-POLICY-FORM             PIC X(12).
  2287             20  CF-MASTER-APPLICATION      PIC X(12).
  2288             20  CF-MASTER-POLICY           PIC X(12).
  2289         16  CF-PLAN-RATING.
  2290             20  CF-RATE-CODE               PIC X(5).
  2291             20  CF-SEX-RATING              PIC X.
  2292                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL1524.cbl
  2293                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2294             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2295             20  CF-SUB-STD-TYPE            PIC X.
  2296                 88  CF-PCT-OF-PREM            VALUE '1'.
  2297                 88  CF-PCT-OF-BENE            VALUE '2'.
  2298         16  CF-PLAN-PREM-TOLERANCES.
  2299             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2300             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2301         16  CF-PLAN-PYMT-TOLERANCES.
  2302             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2303             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2304         16  CF-PLAN-MISC-DATA.
  2305             20  FILLER                     PIC X.
  2306             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2307             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2308         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2309         16  CF-PLAN-IND-GRP                PIC X.
  2310             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2311                                                     '1'.
  2312             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2313                                                     '2'.
  2314         16  CF-MIB-SEARCH-SW               PIC X.
  2315             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2316             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2317             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2318             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2319         16  CF-ALPHA-SEARCH-SW             PIC X.
  2320             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2321             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2322             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2323             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2324             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2325             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2326             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2327             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2328             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2329             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2330                                                     'A' 'B' 'C'
  2331                                                     'X' 'Y' 'Z'.
  2332         16  CF-EFF-DT-RULE-SW              PIC X.
  2333             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2334             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2335             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2336             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2337             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2338         16  FILLER                         PIC X(4).
  2339         16  CF-HEALTH-QUESTIONS            PIC X.
  2340             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2341         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2342         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2343         16  CF-PLAN-SNGL-JNT               PIC X.
  2344             88  CF-COMBINED-PLAN              VALUE 'C'.
  2345             88  CF-JNT-PLAN                   VALUE 'J'.
  2346             88  CF-SNGL-PLAN                  VALUE 'S'.
  2347         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2348         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2349         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2350         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL1524.cbl
  2351         16  CF-RERATE-CNTL                 PIC  X.
  2352             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2353             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2354             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2355             88  CF-AUTO-RECALC                 VALUE '4'.
  2356         16  CF-BENEFIT-TYPE                PIC  X.
  2357             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2358             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2359         16  CF-POLICY-FEE                  PIC S999V99
  2360                                                    COMP-3.
  2361         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2362         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2363         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2364         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2365         16  FILLER                         PIC  X(32).
  2366         16  CF-TERMINATION-FORM            PIC  X(04).
  2367         16  FILLER                         PIC  X(08).
  2368         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2369                                                       COMP-3.
  2370         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2371         16  CF-ISSUE-LETTER                PIC  X(4).
  2372         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2373         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2374             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2375             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2376         16  CF-MP-REFUND-CALC              PIC X.
  2377             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2378             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2379             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2380             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2381             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2382             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2383             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2384             88  CF-MP-REFD-MEAN                VALUE '8'.
  2385         16  CF-ALT-RATE-CODE               PIC  X(5).
  2386
  2387
  2388         16  FILLER                         PIC X(498).
  2389****************************************************************
  2390*             MORTGAGE COMPANY MASTER RECORD                   *
  2391****************************************************************
  2392
  2393     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2394         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2395         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2396             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2397             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2398             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2399             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2400             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2401
  2402         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2403         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2404         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2405         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2406         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2407
  2408         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL1524.cbl
  2409             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2410         16  CF-MP-RECON-USE-IND            PIC X(1).
  2411             88  CF-MP-USE-RECON             VALUE 'Y'.
  2412         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2413             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2414         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2415             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2416             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2417         16  FILLER                         PIC X(1).
  2418         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2419             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2420         16  CF-MORTG-MIB-VERSION           PIC X.
  2421             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2422             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2423             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2424         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2425             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2426                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2427             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2428                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2429             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2430                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2431             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2432                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2433             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2434                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2435             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2436                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2437         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2438         16  FILLER                         PIC X(7).
  2439         16  CF-MORTG-DESTINATION-SYMBOL.
  2440             20  CF-MORTG-MIB-COMM          PIC X(5).
  2441             20  CF-MORTG-MIB-TERM          PIC X(5).
  2442         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2443             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2444         16  FILLER                         PIC X(03).
  2445         16  CF-MP-CHECK-NO-CONTROL.
  2446             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2447                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2448                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2449                                                ' ' LOW-VALUES.
  2450                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2451                                               VALUE '3'.
  2452         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2453         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2454         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2455             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2456                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2457             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2458                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2459             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2460                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2461             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2462                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2463             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2464                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2465             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2466                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL1524.cbl
  2467         16  CF-MORTG-BILLING-AREA.
  2468             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2469                                            PIC X.
  2470         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2471         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2472         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2473         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2474             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2475             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2476         16  FILLER                         PIC X.
  2477         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2478             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2479             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2480         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2481         16  FILLER                         PIC X(8).
  2482         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2483         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2484         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2485         16  CF-ACH-COMPANY-ID.
  2486             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2487                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2488                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2489                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2490             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2491         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2492             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2493         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2494             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2495             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2496         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2497         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2498         16  FILLER                         PIC X(536).
  2499
  2500****************************************************************
  2501*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2502****************************************************************
  2503
  2504     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2505         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2506             20  CF-FEMALE-HEIGHT.
  2507                 24  CF-FEMALE-FT           PIC 99.
  2508                 24  CF-FEMALE-IN           PIC 99.
  2509             20  CF-FEMALE-MIN-WT           PIC 999.
  2510             20  CF-FEMALE-MAX-WT           PIC 999.
  2511         16  FILLER                         PIC X(428).
  2512
  2513     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2514         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2515             20  CF-MALE-HEIGHT.
  2516                 24  CF-MALE-FT             PIC 99.
  2517                 24  CF-MALE-IN             PIC 99.
  2518             20  CF-MALE-MIN-WT             PIC 999.
  2519             20  CF-MALE-MAX-WT             PIC 999.
  2520         16  FILLER                         PIC X(428).
  2521******************************************************************
  2522*             AUTOMATIC ACTIVITY RECORD                          *
  2523******************************************************************
  2524     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL1524.cbl
  2525         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2526             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2527             20  CF-SYS-LETTER-ID           PIC X(04).
  2528             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2529             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2530             20  CF-SYS-RESET-SW            PIC X(01).
  2531             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2532             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2533
  2534         16  FILLER                         PIC X(50).
  2535
  2536         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2537             20  CF-USER-ACTIVE-SW          PIC X(01).
  2538             20  CF-USER-LETTER-ID          PIC X(04).
  2539             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2540             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2541             20  CF-USER-RESET-SW           PIC X(01).
  2542             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2543             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2544             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2545
  2546         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL1524.cbl
  2548 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACTIVITY-QUE
  2549                          CONTROL-FILE.
  2550 0000-DFHEXIT SECTION.
  2551     MOVE '9#                    $   ' TO DFHEIV0.
  2552     MOVE 'EL1524' TO DFHEIV1.
  2553     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2554
  2555     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  2556     MOVE 1                      TO EMI-NUMBER-OF-LINES.
  2557     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  2558                                 TO EMI-SAVE-AREA.
  2559
  2560     MOVE SPACES                 TO DL34-PROCESS-TYPE.
  2561
  2562
  2563* EXEC CICS HANDLE CONDITION
  2564*         ENDDATA (0200-END-DATA)
  2565*         NOTFND  (0300-NOT-FOUND)
  2566*         ERROR   (8020-ERROR-ABEND)
  2567*         INVREQ  (8020-ERROR-ABEND)
  2568*    END-EXEC.
  2569*    MOVE '"$&I.8                ! " #00002558' TO DFHEIV0
  2570     MOVE X'222426492E38202020202020' TO DFHEIV0(1:12)
  2571     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2572     MOVE X'2220233030303032353538' TO DFHEIV0(25:11)
  2573     CALL 'kxdfhei1' USING DFHEIV0
  2574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2575
  2576
  2577 0100-RETRIEVE-LOOP.
  2578
  2579
  2580* EXEC CICS RETRIEVE
  2581*         INTO   (PROGRAM-INTERFACE-BLOCK)
  2582*         LENGTH (PI-COMM-LENGTH)
  2583*    END-EXEC.
  2584*    MOVE '0*I L                 &   #00002567' TO DFHEIV0
  2585     MOVE X'302A49204C20202020202020' TO DFHEIV0(1:12)
  2586     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2587     MOVE X'2020233030303032353637' TO DFHEIV0(25:11)
  2588     CALL 'kxdfhei1' USING DFHEIV0,
  2589           PROGRAM-INTERFACE-BLOCK,
  2590           PI-COMM-LENGTH,
  2591           DFHEIV99,
  2592           DFHEIV99,
  2593           DFHEIV99
  2594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2595
  2596
  2597* DLO034 OPEN WHEN DMD OR CID
  2598     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  2599         IF DL34-PROCESS-TYPE IS EQUAL TO SPACES
  2600             MOVE 'O'                TO DL34-PROCESS-TYPE
  2601             MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  2602             MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  2603             MOVE PI-PROCESSOR-ID    TO DL34-USERID
  2604             MOVE SPACES             TO DL34-PRINT-LINE
  2605             MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL1524.cbl
  2606
  2607* EXEC CICS LINK
  2608*                PROGRAM    ('DLO034')
  2609*                COMMAREA   (DLO034-COMMUNICATION-AREA)
  2610*                LENGTH     (DLO034-REC-LENGTH)
  2611*            END-EXEC
  2612     MOVE 'DLO034' TO DFHEIV1
  2613*    MOVE '."C                   ''   #00002581' TO DFHEIV0
  2614     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2615     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2616     MOVE X'2020233030303032353831' TO DFHEIV0(25:11)
  2617     CALL 'kxdfhei1' USING DFHEIV0,
  2618           DFHEIV1,
  2619           DLO034-COMMUNICATION-AREA,
  2620           DLO034-REC-LENGTH,
  2621           DFHEIV99,
  2622           DFHEIV99,
  2623           DFHEIV99
  2624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2625             IF DL34-RETURN-CODE NOT = 'OK'
  2626                 MOVE '8332'             TO EMI-ERROR
  2627                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2628                 MOVE 'EX48'  TO W-NEXT-TRAN
  2629
  2630* EXEC CICS RETURN
  2631*                     TRANSID  (W-NEXT-TRAN)
  2632*                     COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2633*                     LENGTH   (PI-COMM-LENGTH)
  2634*                END-EXEC.
  2635*    MOVE '.(CT                  &   #00002590' TO DFHEIV0
  2636     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2637     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2638     MOVE X'2020233030303032353930' TO DFHEIV0(25:11)
  2639     CALL 'kxdfhei1' USING DFHEIV0,
  2640           W-NEXT-TRAN,
  2641           PROGRAM-INTERFACE-BLOCK,
  2642           PI-COMM-LENGTH,
  2643           DFHEIV99,
  2644           DFHEIV99
  2645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2646
  2647
  2648     IF  PI-CALLING-PROGRAM = W-PGM-EL178
  2649*        MOVE 'F'                TO DRS-SW
  2650*        PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  2651*        MOVE ' '                TO DRS-SW
  2652         MOVE LOW-VALUES         TO W-1523-LINKDATA
  2653         PERFORM 5000-GET-COMPANY-NAME THRU 5000-EXIT
  2654         PERFORM 1000-PROCESS-ACTQ-FILE THRU 1000-EXIT
  2655         PERFORM 4000-PRINT-TOTALS THRU 4000-EXIT
  2656         MOVE 'X'                TO WS-PROG-END
  2657*        MOVE ' '                TO DRS-SW
  2658         PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  2659         GO TO 0100-RETRIEVE-LOOP.
  2660
  2661     GO TO 0100-RETRIEVE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL1524.cbl
  2663 0200-END-DATA.
  2664*    MOVE 'L'                TO DRS-SW.
  2665*      PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  2666
  2667
  2668     MOVE 'EX48'                 TO W-NEXT-TRAN.
  2669
  2670     MOVE EIBTRMID               TO W-TERMINAL-ID.
  2671
  2672* DLO034 CLOSE
  2673     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  2674         MOVE 'C'                TO DL34-PROCESS-TYPE
  2675         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  2676         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  2677         MOVE PI-PROCESSOR-ID    TO DL34-USERID
  2678         MOVE SPACES             TO DL34-PRINT-LINE
  2679                                    DL34-OVERRIDE-PRINTER-ID
  2680
  2681* EXEC CICS LINK
  2682*            PROGRAM    ('DLO034')
  2683*            COMMAREA   (DLO034-COMMUNICATION-AREA)
  2684*            LENGTH     (DLO034-REC-LENGTH)
  2685*        END-EXEC
  2686     MOVE 'DLO034' TO DFHEIV1
  2687*    MOVE '."C                   ''   #00002628' TO DFHEIV0
  2688     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2689     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2690     MOVE X'2020233030303032363238' TO DFHEIV0(25:11)
  2691     CALL 'kxdfhei1' USING DFHEIV0,
  2692           DFHEIV1,
  2693           DLO034-COMMUNICATION-AREA,
  2694           DLO034-REC-LENGTH,
  2695           DFHEIV99,
  2696           DFHEIV99,
  2697           DFHEIV99
  2698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2699         IF DL34-RETURN-CODE NOT = 'OK'
  2700             MOVE '8333'             TO EMI-ERROR
  2701             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2702
  2703* EXEC CICS RETURN
  2704*                 TRANSID  (W-NEXT-TRAN)
  2705*                 COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2706*                 LENGTH   (PI-COMM-LENGTH)
  2707*            END-EXEC.
  2708*    MOVE '.(CT                  &   #00002636' TO DFHEIV0
  2709     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2710     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2711     MOVE X'2020233030303032363336' TO DFHEIV0(25:11)
  2712     CALL 'kxdfhei1' USING DFHEIV0,
  2713           W-NEXT-TRAN,
  2714           PROGRAM-INTERFACE-BLOCK,
  2715           PI-COMM-LENGTH,
  2716           DFHEIV99,
  2717           DFHEIV99
  2718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2719
  2720
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL1524.cbl
  2721     IF  W-TERM-PREFIX = 'DU'
  2722
  2723* EXEC CICS RETURN
  2724*             TRANSID  (W-NEXT-TRAN)
  2725*             COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2726*             LENGTH   (PI-COMM-LENGTH)
  2727*        END-EXEC
  2728*    MOVE '.(CT                  &   #00002643' TO DFHEIV0
  2729     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2730     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2731     MOVE X'2020233030303032363433' TO DFHEIV0(25:11)
  2732     CALL 'kxdfhei1' USING DFHEIV0,
  2733           W-NEXT-TRAN,
  2734           PROGRAM-INTERFACE-BLOCK,
  2735           PI-COMM-LENGTH,
  2736           DFHEIV99,
  2737           DFHEIV99
  2738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2739     ELSE
  2740
  2741* EXEC CICS RETURN
  2742*        END-EXEC.
  2743*    MOVE '.(                    &   #00002649' TO DFHEIV0
  2744     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2745     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2746     MOVE X'2020233030303032363439' TO DFHEIV0(25:11)
  2747     CALL 'kxdfhei1' USING DFHEIV0,
  2748           DFHEIV99,
  2749           DFHEIV99,
  2750           DFHEIV99,
  2751           DFHEIV99,
  2752           DFHEIV99
  2753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2754
  2755
  2756 0300-NOT-FOUND.
  2757
  2758     IF  PI-COMPANY-ID NOT = 'MON'
  2759         MOVE 'NO COMMUNICATION AREA FOUND' TO W-MESSAGE-LINE
  2760         PERFORM 0400-SEND-TEXT.
  2761
  2762     GO TO 0200-END-DATA.
  2763
  2764 0400-SEND-TEXT.
  2765
  2766
  2767* EXEC CICS SEND TEXT
  2768*         FROM   (W-MESSAGE-LINE)
  2769*         LENGTH (70)
  2770*    END-EXEC.
  2771     MOVE 70
  2772       TO DFHEIV11
  2773*    MOVE '8&      T       H   F -   #00002662' TO DFHEIV0
  2774     MOVE X'382620202020202054202020' TO DFHEIV0(1:12)
  2775     MOVE X'202020204820202046202D20' TO DFHEIV0(13:12)
  2776     MOVE X'2020233030303032363632' TO DFHEIV0(25:11)
  2777     CALL 'kxdfhei1' USING DFHEIV0,
  2778           W-MESSAGE-LINE,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL1524.cbl
  2779           DFHEIV11,
  2780           DFHEIV99,
  2781           DFHEIV99,
  2782           DFHEIV99,
  2783           DFHEIV99,
  2784           DFHEIV99,
  2785           DFHEIV99,
  2786           DFHEIV99,
  2787           DFHEIV99,
  2788           DFHEIV99,
  2789           DFHEIV99
  2790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2791
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL1524.cbl
  2793 1000-PROCESS-ACTQ-FILE.
  2794
  2795     MOVE +80                    TO WS-LINE-LEN.
  2796     MOVE '1'                    TO W-ML-CC.
  2797
  2798     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2799     MOVE '5'                    TO DC-OPTION-CODE.
  2800
  2801
  2802* EXEC CICS LINK
  2803*        PROGRAM   ('ELDATCV')
  2804*        COMMAREA  (DATE-CONVERSION-DATA)
  2805*        LENGTH    (DC-COMM-LENGTH)
  2806*    END-EXEC.
  2807     MOVE 'ELDATCV' TO DFHEIV1
  2808*    MOVE '."C                   ''   #00002675' TO DFHEIV0
  2809     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2810     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2811     MOVE X'2020233030303032363735' TO DFHEIV0(25:11)
  2812     CALL 'kxdfhei1' USING DFHEIV0,
  2813           DFHEIV1,
  2814           DATE-CONVERSION-DATA,
  2815           DC-COMM-LENGTH,
  2816           DFHEIV99,
  2817           DFHEIV99,
  2818           DFHEIV99
  2819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2820
  2821
  2822     MOVE DC-GREG-DATE-1-EDIT    TO W-DATE.
  2823     MOVE +56                    TO W-LINE-COUNT.
  2824
  2825     MOVE LOW-VALUES             TO W-ACTQ-KEY.
  2826
  2827     MOVE PI-COMPANY-CD          TO W-ACTQ-COMPANY-CD.
  2828
  2829 1000-READ-ACTQ.
  2830
  2831
  2832* EXEC CICS HANDLE CONDITION
  2833*         NOTOPEN (8000-ACTQ-NOT-OPEN)
  2834*         NOTFND  (8010-ACTQ-NOT-FOUND)
  2835*         ENDFILE (1000-EXIT)
  2836*    END-EXEC.
  2837*    MOVE '"$JI''                 ! # #00002690' TO DFHEIV0
  2838     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  2839     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2840     MOVE X'2320233030303032363930' TO DFHEIV0(25:11)
  2841     CALL 'kxdfhei1' USING DFHEIV0
  2842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2843
  2844
  2845     PERFORM 3400-STARTBR-ACTQ THRU 3400-EXIT.
  2846
  2847 1000-READ-NEXT.
  2848
  2849     PERFORM 3500-READNEXT-ACTQ THRU 3500-EXIT.
  2850
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL1524.cbl
  2851     MOVE EMI-SAVE-AREA          TO ERROR-MESSAGE-INTERFACE-BLOCK.
  2852
  2853     IF  AQ-COMPANY-CD LESS THAN PI-COMPANY-CD
  2854         GO TO 1000-READ-ACTQ
  2855
  2856     ELSE
  2857         IF  AQ-COMPANY-CD GREATER THAN PI-COMPANY-CD
  2858             GO TO 1000-ENDBR.
  2859
  2860     ADD +1                      TO W-ACTQ-RCRD-READ.
  2861
  2862     IF  NOT PENDING-LETTERS
  2863             OR
  2864         AQ-AUTO-LETTER NOT GREATER THAN SPACES
  2865         GO TO 1000-READ-NEXT.
  2866
  2867     ADD +1                      TO W-ACTQ-RCRD-USED.
  2868
  2869     MOVE LOW-VALUES             TO W-1523-WORK-AREA.
  2870     MOVE PROGRAM-INTERFACE-BLOCK
  2871                                 TO W-1523-COMMON-PI-DATA.
  2872     MOVE AQ-CARRIER             TO W-1523-CARRIER.
  2873     MOVE AQ-CLAIM-NO            TO W-CLAIM-X
  2874                                    W-1523-CLAIM-NO.
  2875     MOVE AQ-CERT-NO             TO W-CERT-X
  2876                                    W-1523-CERT-NO.
  2877     MOVE AQ-AUTO-LETTER         TO W-1523-FORM-NUMBER.
  2878     MOVE AQ-RESEND-DATE         TO W-1523-RESEND-DATE.
  2879     MOVE AQ-FOLLOWUP-DATE       TO W-1523-FOLLOW-UP-DATE.
  2880     MOVE AQ-PENDING-ACTIVITY-FLAGS
  2881                                 TO W-FLAGS.
  2882
  2883
  2884* EXEC CICS LINK
  2885*         PROGRAM   ('EL1523')
  2886*         COMMAREA  (W-1523-LINKDATA)
  2887*         LENGTH    (W-1523-COMM-LENGTH)
  2888*    END-EXEC.
  2889     MOVE 'EL1523' TO DFHEIV1
  2890*    MOVE '."C                   ''   #00002734' TO DFHEIV0
  2891     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2892     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2893     MOVE X'2020233030303032373334' TO DFHEIV0(25:11)
  2894     CALL 'kxdfhei1' USING DFHEIV0,
  2895           DFHEIV1,
  2896           W-1523-LINKDATA,
  2897           W-1523-COMM-LENGTH,
  2898           DFHEIV99,
  2899           DFHEIV99,
  2900           DFHEIV99
  2901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2902
  2903
  2904     IF  W-1523-FATAL-ERROR
  2905         ADD +1                  TO W-FATAL-ERRORS
  2906         MOVE W-1523-ERROR-CODE  TO W-FATAL-ERROR
  2907         MOVE W-1523-CLAIM-NO    TO W-CLAIM-NO-F
  2908         MOVE W-1523-CERT-NO     TO W-CERT-NO-F
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL1524.cbl
  2909         MOVE W-FATAL-ERROR-MSG  TO W-ML-DATA
  2910         MOVE '0'                TO W-ML-CC
  2911         MOVE +3                 TO W-INCOMING-LINES
  2912         PERFORM 8100-TOP-OF-PAGE THRU 8100-EXIT
  2913         MOVE W-MESSAGE-LINE     TO WS-PRINT-AREA
  2914*        MOVE ' '                TO DRS-SW
  2915         PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  2916         MOVE W-1523-ERROR-CODE  TO EMI-ERROR
  2917         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2918         MOVE EMI-ERROR-TEXT (1) TO W-ML-DATA
  2919         MOVE SPACES             TO W-ML-CC
  2920         MOVE W-MESSAGE-LINE     TO WS-PRINT-AREA
  2921*        MOVE ' '                TO DRS-SW
  2922         PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  2923
  2924         IF  W-1523-STOP-ERRORS
  2925             MOVE W-SEVERE-ERROR TO W-ML-DATA
  2926             MOVE SPACES         TO W-ML-CC
  2927             MOVE W-MESSAGE-LINE TO WS-PRINT-AREA
  2928*            MOVE ' '                TO DRS-SW
  2929             PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  2930             GO TO 1000-EXIT
  2931
  2932         ELSE
  2933             PERFORM 3400-STARTBR-ACTQ THRU 3400-EXIT
  2934             PERFORM 3500-READNEXT-ACTQ THRU 3500-EXIT
  2935             GO TO 1000-READ-NEXT
  2936
  2937     ELSE
  2938         IF  W-1523-ERROR-CODE EQUAL 0191
  2939             ADD +1              TO W-LETTERS-WITH-ERRORS
  2940             MOVE W-1523-CLAIM-NO
  2941                                 TO W-CLAIM-NO
  2942             MOVE W-1523-CERT-NO TO W-CERT-NO
  2943             MOVE W-1523-ERROR-CODE
  2944                                 TO W-ERROR
  2945             MOVE W-GENERAL-ERROR
  2946                                 TO W-ML-DATA
  2947             MOVE '0'            TO W-ML-CC
  2948             MOVE +2             TO W-INCOMING-LINES
  2949             PERFORM 8100-TOP-OF-PAGE THRU 8100-EXIT
  2950             MOVE W-MESSAGE-LINE TO WS-PRINT-AREA
  2951*            MOVE ' '                TO DRS-SW
  2952             PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  2953
  2954     ADD +1                      TO W-LETTERS-CREATED.
  2955     MOVE SPACE                  TO W-PENDING-LETTER-FLAG.
  2956
  2957     MOVE W-1523-ARCHIVE-NUMBER  TO W-ARCHIVE.
  2958     MOVE W-LETTER-SENT          TO W-ML-DATA.
  2959
  2960     IF  W-1523-ERROR-CODE EQUAL 0191
  2961         MOVE SPACES             TO W-ML-CC
  2962         MOVE +1                 TO W-INCOMING-LINES
  2963         PERFORM 8100-TOP-OF-PAGE THRU 8100-EXIT
  2964
  2965     ELSE
  2966         MOVE '0'                TO W-ML-CC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL1524.cbl
  2967         MOVE +2                 TO W-INCOMING-LINES
  2968         PERFORM 8100-TOP-OF-PAGE THRU 8100-EXIT.
  2969
  2970     MOVE W-MESSAGE-LINE         TO WS-PRINT-AREA.
  2971*    MOVE ' '                TO DRS-SW
  2972     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  2973
  2974     IF  W-NO-PENDING-ACTIVITY
  2975         PERFORM 3000-DELETE-ACTQ-RCRD THRU 3000-EXIT
  2976         GO TO 1000-READ-ACTQ
  2977
  2978     ELSE
  2979         PERFORM 2000-UPDATE-ACTQ-RCRD THRU 2000-EXIT
  2980         PERFORM 3400-STARTBR-ACTQ THRU 3400-EXIT
  2981         PERFORM 3500-READNEXT-ACTQ THRU 3500-EXIT
  2982         GO TO 1000-READ-NEXT.
  2983
  2984 1000-ENDBR.
  2985
  2986
  2987* EXEC CICS ENDBR
  2988*         DATASET (W-ACTQ-FILE-ID)
  2989*    END-EXEC.
  2990     MOVE 0
  2991       TO DFHEIV11
  2992*    MOVE '&2                    $   #00002822' TO DFHEIV0
  2993     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2994     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2995     MOVE X'2020233030303032383232' TO DFHEIV0(25:11)
  2996     CALL 'kxdfhei1' USING DFHEIV0,
  2997           W-ACTQ-FILE-ID,
  2998           DFHEIV11,
  2999           DFHEIV99
  3000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3001
  3002
  3003 1000-EXIT.
  3004     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL1524.cbl
  3006 2000-UPDATE-ACTQ-RCRD.
  3007
  3008
  3009* EXEC CICS READ
  3010*        SET      (ADDRESS OF ACTIVITY-QUE)
  3011*        DATASET  (W-ACTQ-FILE-ID)
  3012*        RIDFLD   (W-ACTQ-KEY)
  3013*        UPDATE
  3014*    END-EXEC.
  3015*    MOVE '&"S        EU         (   #00002831' TO DFHEIV0
  3016     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3017     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3018     MOVE X'2020233030303032383331' TO DFHEIV0(25:11)
  3019     CALL 'kxdfhei1' USING DFHEIV0,
  3020           W-ACTQ-FILE-ID,
  3021           DFHEIV20,
  3022           DFHEIV99,
  3023           W-ACTQ-KEY,
  3024           DFHEIV99,
  3025           DFHEIV99,
  3026           DFHEIV99
  3027     SET ADDRESS OF ACTIVITY-QUE TO
  3028         DFHEIV20
  3029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3030
  3031
  3032     MOVE W-PGM-ID               TO AQ-LAST-UPDATED-BY.
  3033     MOVE SPACE                  TO AQ-PENDING-LETTER-FLAG
  3034                                    AQ-AUTO-LETTER.
  3035
  3036
  3037* EXEC CICS REWRITE
  3038*        DATASET  (W-ACTQ-FILE-ID)
  3039*        FROM     (ACTIVITY-QUE)
  3040*    END-EXEC.
  3041     MOVE LENGTH OF
  3042      ACTIVITY-QUE
  3043       TO DFHEIV11
  3044*    MOVE '&& L                  %   #00002842' TO DFHEIV0
  3045     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3046     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3047     MOVE X'2020233030303032383432' TO DFHEIV0(25:11)
  3048     CALL 'kxdfhei1' USING DFHEIV0,
  3049           W-ACTQ-FILE-ID,
  3050           ACTIVITY-QUE,
  3051           DFHEIV11,
  3052           DFHEIV99
  3053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3054
  3055
  3056     ADD +1                      TO W-ACTQ-RCRD-CHANGED.
  3057
  3058 2000-EXIT.
  3059     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL1524.cbl
  3061 3000-DELETE-ACTQ-RCRD.
  3062
  3063     MOVE 'N' TO W-ACTQ-EXIT-SW.
  3064
  3065* EXEC CICS HANDLE CONDITION
  3066*        ENDFILE (3000-EXIT)
  3067*        NOTFND  (3000-EXIT)
  3068*    END-EXEC.
  3069*    MOVE '"$''I                  ! $ #00002855' TO DFHEIV0
  3070     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  3071     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3072     MOVE X'2420233030303032383535' TO DFHEIV0(25:11)
  3073     CALL 'kxdfhei1' USING DFHEIV0
  3074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3075
  3076
  3077
  3078* EXEC CICS READ
  3079*        SET      (ADDRESS OF ACTIVITY-QUE)
  3080*        DATASET  (W-ACTQ-FILE-ID)
  3081*        RIDFLD   (W-ACTQ-KEY)
  3082*        UPDATE
  3083*    END-EXEC.
  3084*    MOVE '&"S        EU         (   #00002860' TO DFHEIV0
  3085     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3086     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3087     MOVE X'2020233030303032383630' TO DFHEIV0(25:11)
  3088     CALL 'kxdfhei1' USING DFHEIV0,
  3089           W-ACTQ-FILE-ID,
  3090           DFHEIV20,
  3091           DFHEIV99,
  3092           W-ACTQ-KEY,
  3093           DFHEIV99,
  3094           DFHEIV99,
  3095           DFHEIV99
  3096     SET ADDRESS OF ACTIVITY-QUE TO
  3097         DFHEIV20
  3098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3099
  3100
  3101
  3102* EXEC CICS DELETE
  3103*        DATASET  (W-ACTQ-FILE-ID)
  3104*    END-EXEC.
  3105*    MOVE '&(                    &   #00002867' TO DFHEIV0
  3106     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  3107     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3108     MOVE X'2020233030303032383637' TO DFHEIV0(25:11)
  3109     CALL 'kxdfhei1' USING DFHEIV0,
  3110           W-ACTQ-FILE-ID,
  3111           DFHEIV99,
  3112           DFHEIV99,
  3113           DFHEIV99,
  3114           DFHEIV99
  3115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3116
  3117
  3118     ADD +1                      TO W-ACTQ-RCRD-DELETED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL1524.cbl
  3119
  3120 3000-EXIT.
  3121     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL1524.cbl
  3123 3400-STARTBR-ACTQ.
  3124
  3125
  3126* EXEC CICS STARTBR
  3127*        DATASET (W-ACTQ-FILE-ID)
  3128*        RIDFLD  (W-ACTQ-KEY)
  3129*        GTEQ
  3130*    END-EXEC.
  3131     MOVE 0
  3132       TO DFHEIV11
  3133*    MOVE '&,         G          &   #00002878' TO DFHEIV0
  3134     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3135     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3136     MOVE X'2020233030303032383738' TO DFHEIV0(25:11)
  3137     CALL 'kxdfhei1' USING DFHEIV0,
  3138           W-ACTQ-FILE-ID,
  3139           W-ACTQ-KEY,
  3140           DFHEIV99,
  3141           DFHEIV11,
  3142           DFHEIV99
  3143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3144
  3145
  3146 3400-EXIT.
  3147     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL1524.cbl
  3149 3500-READNEXT-ACTQ.
  3150
  3151
  3152* EXEC CICS READNEXT
  3153*        DATASET (W-ACTQ-FILE-ID)
  3154*        RIDFLD  (W-ACTQ-KEY)
  3155*        SET     (ADDRESS OF ACTIVITY-QUE)
  3156*    END-EXEC.
  3157     MOVE 0
  3158       TO DFHEIV11
  3159*    MOVE '&.S                   )   #00002889' TO DFHEIV0
  3160     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3161     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3162     MOVE X'2020233030303032383839' TO DFHEIV0(25:11)
  3163     CALL 'kxdfhei1' USING DFHEIV0,
  3164           W-ACTQ-FILE-ID,
  3165           DFHEIV20,
  3166           DFHEIV99,
  3167           W-ACTQ-KEY,
  3168           DFHEIV99,
  3169           DFHEIV11,
  3170           DFHEIV99,
  3171           DFHEIV99
  3172     SET ADDRESS OF ACTIVITY-QUE TO
  3173         DFHEIV20
  3174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3175
  3176
  3177 3500-EXIT.
  3178     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL1524.cbl
  3180 4000-PRINT-TOTALS.
  3181
  3182     MOVE +56                    TO W-INCOMING-LINES.
  3183     PERFORM 8100-TOP-OF-PAGE THRU 8100-EXIT.
  3184*
  3185*    MOVE '1'                    TO W-ML-CC.
  3186*    MOVE SPACES                 TO W-ML-DATA.
  3187*    MOVE W-MESSAGE-LINE         TO WS-PRINT-AREA.
  3188*    PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  3189
  3190     MOVE W-ACTQ-RCRD-READ       TO W-TOTAL-AMT1.
  3191     MOVE SPACES                 TO W-ML-CC.
  3192     MOVE W-TOTAL1               TO W-ML-DATA.
  3193     MOVE W-MESSAGE-LINE         TO WS-PRINT-AREA.
  3194*    MOVE ' '                TO DRS-SW
  3195     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  3196
  3197     MOVE W-ACTQ-RCRD-USED       TO W-TOTAL-AMT2.
  3198     MOVE '0'                    TO W-ML-CC.
  3199     MOVE W-TOTAL2               TO W-ML-DATA.
  3200     MOVE W-MESSAGE-LINE         TO WS-PRINT-AREA.
  3201*    MOVE ' '                TO DRS-SW
  3202     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  3203
  3204     MOVE W-ACTQ-RCRD-CHANGED    TO W-TOTAL-AMT6.
  3205     MOVE '0'                    TO W-ML-CC.
  3206     MOVE W-TOTAL6               TO W-ML-DATA.
  3207     MOVE W-MESSAGE-LINE         TO WS-PRINT-AREA.
  3208*    MOVE ' '                TO DRS-SW
  3209     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  3210
  3211     MOVE W-ACTQ-RCRD-DELETED    TO W-TOTAL-AMT5.
  3212     MOVE '0'                    TO W-ML-CC.
  3213     MOVE W-TOTAL5               TO W-ML-DATA.
  3214     MOVE W-MESSAGE-LINE         TO WS-PRINT-AREA.
  3215*    MOVE ' '                TO DRS-SW
  3216     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  3217
  3218     MOVE W-FATAL-ERRORS         TO W-TOTAL-AMT3.
  3219     MOVE '0'                    TO W-ML-CC.
  3220     MOVE W-TOTAL3               TO W-ML-DATA.
  3221     MOVE W-MESSAGE-LINE         TO WS-PRINT-AREA.
  3222*    MOVE ' '                TO DRS-SW
  3223     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  3224
  3225     MOVE W-LETTERS-CREATED      TO W-TOTAL-AMT4.
  3226     MOVE '0'                    TO W-ML-CC.
  3227     MOVE W-TOTAL4               TO W-ML-DATA.
  3228     MOVE W-MESSAGE-LINE         TO WS-PRINT-AREA.
  3229*    MOVE ' '                TO DRS-SW
  3230     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  3231
  3232     MOVE W-LETTERS-WITH-ERRORS  TO W-TOTAL-AMT7.
  3233     MOVE '0'                    TO W-ML-CC.
  3234     MOVE W-TOTAL7               TO W-ML-DATA.
  3235     MOVE W-MESSAGE-LINE         TO WS-PRINT-AREA.
  3236*    MOVE ' '                TO DRS-SW
  3237     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL1524.cbl
  3238
  3239     MOVE '1'                    TO W-ML-CC.
  3240     MOVE SPACES                 TO W-ML-DATA.
  3241     MOVE W-MESSAGE-LINE         TO WS-PRINT-AREA.
  3242*    MOVE ' '                TO DRS-SW
  3243     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  3244
  3245 4000-EXIT.
  3246     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL1524.cbl
  3248 5000-GET-COMPANY-NAME.
  3249
  3250
  3251* EXEC CICS HANDLE CONDITION
  3252*         NOTOPEN (5000-EXIT)
  3253*         NOTFND  (5000-EXIT)
  3254*    END-EXEC.
  3255*    MOVE '"$JI                  ! % #00002968' TO DFHEIV0
  3256     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  3257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3258     MOVE X'2520233030303032393638' TO DFHEIV0(25:11)
  3259     CALL 'kxdfhei1' USING DFHEIV0
  3260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3261
  3262
  3263     MOVE SPACES                 TO W-CNTL-KEY.
  3264     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  3265     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
  3266     MOVE ZEROS                  TO W-CNTL-SEQ.
  3267
  3268
  3269* EXEC CICS READ
  3270*         DATASET (W-CNTL-FILE-ID)
  3271*         SET     (ADDRESS OF CONTROL-FILE)
  3272*         RIDFLD  (W-CNTL-KEY)
  3273*    END-EXEC.
  3274*    MOVE '&"S        E          (   #00002978' TO DFHEIV0
  3275     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3276     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3277     MOVE X'2020233030303032393738' TO DFHEIV0(25:11)
  3278     CALL 'kxdfhei1' USING DFHEIV0,
  3279           W-CNTL-FILE-ID,
  3280           DFHEIV20,
  3281           DFHEIV99,
  3282           W-CNTL-KEY,
  3283           DFHEIV99,
  3284           DFHEIV99,
  3285           DFHEIV99
  3286     SET ADDRESS OF CONTROL-FILE TO
  3287         DFHEIV20
  3288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3289
  3290
  3291     MOVE CF-CL-MAIL-TO-NAME     TO W-COMPANY.
  3292     MOVE SPACES                 TO W-CT-COMPANY.
  3293     PERFORM 5100-CENTER-NAME THRU 5100-EXIT.
  3294
  3295 5000-EXIT.
  3296     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL1524.cbl
  3298 5100-CENTER-NAME.
  3299
  3300     MOVE ZEROS                  TO W-COMBINED-SPACES.
  3301
  3302     PERFORM 5120-FIND-LAST-CHAR THRU 5120-EXIT
  3303             VARYING
  3304         W-CO-NDX FROM 30 BY -1
  3305             UNTIL
  3306         W-CO-NDX LESS THAN +1
  3307             OR
  3308         W-CO-CHAR (W-CO-NDX) NOT EQUAL SPACES.
  3309
  3310     COMPUTE W-COMBINED-SPACES = W-COMBINED-SPACES / 2.
  3311
  3312     SET W-CT-NDX                TO W-COMBINED-SPACES.
  3313
  3314     PERFORM 5140-MOVE-NAME-CHAR THRU 5140-EXIT
  3315             VARYING
  3316         W-CO-NDX FROM +1 BY +1
  3317             UNTIL
  3318         W-CO-NDX GREATER THAN +30
  3319             OR
  3320         W-CT-NDX EQUAL +30.
  3321
  3322 5100-EXIT.
  3323     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL1524.cbl
  3325 5120-FIND-LAST-CHAR.
  3326
  3327     IF  W-CO-CHAR (W-CO-NDX) EQUAL SPACE
  3328         ADD +1                  TO W-COMBINED-SPACES.
  3329
  3330 5120-EXIT.
  3331     EXIT.
  3332
  3333 5140-MOVE-NAME-CHAR.
  3334
  3335     SET W-CT-NDX UP BY +1.
  3336     MOVE W-CO-CHAR (W-CO-NDX)   TO W-CT-CHAR (W-CT-NDX).
  3337
  3338 5140-EXIT.
  3339     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL1524.cbl
  3341 8000-ACTQ-NOT-OPEN.
  3342
  3343     MOVE +56                    TO W-INCOMING-LINES
  3344     PERFORM 8100-TOP-OF-PAGE THRU 8100-EXIT.
  3345
  3346     MOVE 'ELACTQ FILE IS NOT OPENED'
  3347                                 TO W-ML-DATA.
  3348     MOVE '0'                    TO W-ML-CC.
  3349     MOVE W-MESSAGE-LINE         TO WS-PRINT-AREA.
  3350*    MOVE ' '                TO DRS-SW
  3351     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  3352     GO TO 1000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL1524.cbl
  3354 8010-ACTQ-NOT-FOUND.
  3355
  3356     MOVE +2                     TO W-INCOMING-LINES
  3357     PERFORM 8100-TOP-OF-PAGE THRU 8100-EXIT.
  3358
  3359     MOVE 'UNACCEPTABLE ERROR DETECTED WHILE READING ACTQ.'
  3360                                 TO W-ML-DATA.
  3361     MOVE '0'                    TO W-ML-CC.
  3362     MOVE W-MESSAGE-LINE         TO WS-PRINT-AREA.
  3363*    MOVE ' '                TO DRS-SW
  3364     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  3365     GO TO 1000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL1524.cbl
  3367 8020-ERROR-ABEND.
  3368
  3369     MOVE +2                     TO W-INCOMING-LINES
  3370     PERFORM 8100-TOP-OF-PAGE THRU 8100-EXIT.
  3371
  3372     MOVE 'UNACCEPTABLE ERROR DETECTED DURING PROCESSING.'
  3373                                 TO W-ML-DATA.
  3374     MOVE '0'                    TO W-ML-CC.
  3375     MOVE W-MESSAGE-LINE         TO WS-PRINT-AREA.
  3376*    MOVE ' '                TO DRS-SW
  3377     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  3378     GO TO 1000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL1524.cbl
  3380 8100-TOP-OF-PAGE.
  3381
  3382     COMPUTE W-LINE-COUNT = W-LINE-COUNT + W-INCOMING-LINES.
  3383
  3384     IF  W-LINE-COUNT GREATER THAN +56
  3385         COMPUTE W-LINE-COUNT = W-INCOMING-LINES + 3
  3386         ADD +1                  TO W-PAGE
  3387         MOVE W-PAGE             TO W-CT-PAGE
  3388         MOVE W-REPORT-TITLE     TO WS-PRINT-AREA
  3389*        MOVE ' '                TO DRS-SW
  3390         PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  3391         MOVE W-COMPANY-TITLE    TO WS-PRINT-AREA
  3392*        MOVE ' '                TO DRS-SW
  3393         PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  3394         MOVE SPACES             TO WS-PRINT-AREA
  3395*        MOVE ' '                TO DRS-SW
  3396         PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  3397
  3398 8100-EXIT.
  3399     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL1524.cbl
  3401 9900-ERROR-FORMAT.
  3402
  3403
  3404* EXEC CICS LINK
  3405*        PROGRAM  ('EL001')
  3406*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  3407*        LENGTH   (EMI-COMM-LENGTH)
  3408*    END-EXEC.
  3409     MOVE 'EL001' TO DFHEIV1
  3410*    MOVE '."C                   ''   #00003096' TO DFHEIV0
  3411     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3412     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3413     MOVE X'2020233030303033303936' TO DFHEIV0(25:11)
  3414     CALL 'kxdfhei1' USING DFHEIV0,
  3415           DFHEIV1,
  3416           ERROR-MESSAGE-INTERFACE-BLOCK,
  3417           EMI-COMM-LENGTH,
  3418           DFHEIV99,
  3419           DFHEIV99,
  3420           DFHEIV99
  3421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3422
  3423
  3424 9900-EXIT.
  3425     EXIT.
  3426*                                COPY ELPRTCVP.
  3427******************************************************************
  3428***                                                              *
  3429***                          ELPRTCVP.                           *
  3430***                          VMOD=2.003                          *
  3431***                                                              *
  3432***     COPY MEMBER FOR TERMINAL ONLINE PRINT ROUTINE.           *
  3433***     THIS ROUTINE WILL ACCOMODATE PRINTING TO A 3270          *
  3434***     TERMINAL PRINTER. A BUFFER OF UP TO 1920 CHARACTERS      *
  3435***     IS ACCUMULATED AND PRINTED COLLECTIVELY.                 *
  3436***                                                              *
  3437***     THIS ROUTINE TO BE USED ONLY WITH ACCOMPANIMENT          *
  3438***      OF THE WORKING-STORAGE COPY MEMBER ( ELPRTCVD )         *
  3439***     THE HOST PROGRAM MUST INITIALIZE THE FOLLOWING 3 FIELDS  *
  3440***      FROM THE ABOVE COPY MEMBER FOR THIS PROCEDURE TO BE     *
  3441***      SUCCESSFUL.                                             *
  3442***      05  WS-LINE-LEN    PIC  S9(4)  COMP  VALUE +80.         *
  3443***                         LENGTH OF THE LINE TO BE PRINTED     *
  3444***                         DEFAULT IS 80, YOU CAN USE ANY NUMBER*
  3445***                         UP TO 132.  THIS FIELD IS ONLY ACCEP-*
  3446***                         TED THE FIRST TIME THRU THE ROUTINE. *
  3447***      05  WS-PROG-END    PIC  X  VALUE SPACES.                *
  3448***                         PROGRAM END SWITCH. INITIALIZED      *
  3449***                         TO SPACE-     MOVE IN ANY NONBLANK   *
  3450***                         TO IT WHEN PROGRAM IS FINISHED.      *
  3451***      05  WS-PRINT-AREA.                                      *
  3452***          10  WS-PASSED-CNTL-CHAR     PIC X.                  *
  3453***          10  WS-PASSED-DATA          PIC X(132).             *
  3454***                         USE THE DATA TO BE PRINTED IN THE    *
  3455***                         WS-PASSED-DATA.                      *
  3456***                         USE THE STANDARD CARRIAGE CONTROL    *
  3457***                         CHARACTER IN THE WS-PASSED-CNTL-CHAR *
  3458***                           SINGLE-SPACE            VALUE ' '  *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL1524.cbl
  3459***                           DOUBLE-SPACE            VALUE '0'  *
  3460***                           TRIPLE-SPACE            VALUE '-'  *
  3461***                           TOP-PAGE                VALUE '1'  *
  3462***      NOTE: A LINE COUNT IS PROVIDED IN FIELDNAME -WS-LINE-CNT*
  3463***            THE USE OF THIS FIELD IS OPTIONAL.                *
  3464***            THIS ROUTINE WILL ONLY ADD 1, 2, OR 3             *
  3465***            TO THIS COUNT DEPENDING ON THE WS-PASSED-CNTL-CHAR*
  3466***            AND RESET THE COUNT TO ZERO WHEN TOP-PAGE         *
  3467***            CONDITION.                                        *
  3468***                                                              *
  3469******************************************************************
  3470
  3471 ELPRTCVP.
  3472
  3473*    IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'CID'
  3474     IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'XXX'
  3475         MOVE 'P'                TO DL34-PROCESS-TYPE
  3476         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  3477         MOVE PI-PROCESSOR-ID    TO DL34-USERID
  3478         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  3479         MOVE WS-PRINT-AREA      TO DL34-PRINT-LINE
  3480         MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
  3481
  3482
  3483* EXEC CICS LINK
  3484*            PROGRAM    ('DLO034')
  3485*            COMMAREA   (DLO034-COMMUNICATION-AREA)
  3486*            LENGTH     (DLO034-REC-LENGTH)
  3487*        END-EXEC
  3488     MOVE 'DLO034' TO DFHEIV1
  3489*    MOVE '."C                   ''   #00003160' TO DFHEIV0
  3490     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3491     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3492     MOVE X'2020233030303033313630' TO DFHEIV0(25:11)
  3493     CALL 'kxdfhei1' USING DFHEIV0,
  3494           DFHEIV1,
  3495           DLO034-COMMUNICATION-AREA,
  3496           DLO034-REC-LENGTH,
  3497           DFHEIV99,
  3498           DFHEIV99,
  3499           DFHEIV99
  3500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3501
  3502            IF DL34-RETURN-CODE = 'OK'
  3503                GO TO ELPRTCVP-EXIT
  3504            ELSE
  3505*               MOVE '8339'     TO EMI-ERROR ?????ERROR MESSAGE???
  3506                GO TO ELPRTCVP-EXIT.
  3507
  3508     IF NOT FIRST-TIME
  3509         GO TO ELPRTCVP-020.
  3510
  3511     IF WS-LINE-LEN NOT GREATER ZERO
  3512         GO TO ELPRTCVP-EXIT.
  3513
  3514     MOVE '2'                    TO WS-FIRST-TIME-SW.
  3515     MOVE LOW-VALUES             TO WS-BUFFER-AREA.
  3516
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL1524.cbl
  3517     SET BUFFER-INDEX TO +1
  3518
  3519     IF EIBTRMID IS EQUAL TO 'AFLP'
  3520         NEXT SENTENCE
  3521     ELSE
  3522         IF NOT TOP-PAGE
  3523             MOVE T-TP           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  3524             SET BUFFER-INDEX UP BY +1.
  3525
  3526 ELPRTCVP-020.
  3527     IF WS-PROG-END = SPACES
  3528         GO TO ELPRTCVP-030.
  3529
  3530     MOVE SPACES                 TO WS-PROG-END.
  3531
  3532     IF BUFFER-INDEX GREATER +1
  3533         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  3534
  3535     MOVE '1'                    TO WS-FIRST-TIME-SW.
  3536
  3537     GO TO ELPRTCVP-EXIT.
  3538
  3539 ELPRTCVP-030.
  3540     IF WS-PASSED-DATA = SPACES
  3541         SET PRT-INDEX TO +1
  3542         GO TO ELPRTCVP-050.
  3543
  3544     SET PRT-INDEX TO WS-LINE-LEN.
  3545
  3546 ELPRTCVP-040.
  3547     IF WS-PRINT-BYTE (PRT-INDEX) NOT = SPACES
  3548         GO TO ELPRTCVP-050.
  3549
  3550     IF PRT-INDEX GREATER +1
  3551         SET PRT-INDEX DOWN BY +1
  3552         GO TO ELPRTCVP-040.
  3553
  3554 ELPRTCVP-050.
  3555     SET WS-LINE-LENGTH TO PRT-INDEX.
  3556     SET BUFFER-INDEX2 TO BUFFER-INDEX.
  3557     SET BUFFER-INDEX2 UP BY WS-LINE-LENGTH.
  3558
  3559     IF BUFFER-INDEX2 NOT LESS WS-BUFFER-SIZE
  3560         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  3561
  3562     IF TRIPLE-SPACE
  3563          ADD +2  TO  WS-LINE-CNT
  3564          MOVE T-SS           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  3565                                 WS-BUFFER-BYTE (BUFFER-INDEX + 1)
  3566          SET BUFFER-INDEX UP BY +2.
  3567
  3568     IF DOUBLE-SPACE
  3569          ADD +1  TO  WS-LINE-CNT
  3570          MOVE T-SS             TO WS-BUFFER-BYTE (BUFFER-INDEX)
  3571          SET BUFFER-INDEX UP BY +1.
  3572
  3573     ADD +1 TO WS-LINE-CNT
  3574************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL1524.cbl
  3575*     BYPASS NEW LINE SYMBOL                               *
  3576*        IF FIRST BUFFER SENT AND TOP-OF-FORM SET.         *
  3577*     OR IF FIRST LINE OF SUBSEQUENT BUFFERS.              *
  3578************************************************************
  3579
  3580     IF (BUFFER-INDEX GREATER +1 AND
  3581         WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-TP)  OR
  3582         FIRST-LINE-NEXT-BUFFER
  3583         MOVE ZERO               TO WS-FIRST-TIME-SW
  3584     ELSE
  3585         MOVE T-SS               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  3586         SET BUFFER-INDEX UP BY +1.
  3587
  3588**   NOTE, SINGLE SPACE IS REQUIRED BEFORE TOP PAGE CHAR
  3589
  3590     IF TOP-PAGE
  3591         MOVE +1                TO WS-LINE-CNT
  3592         MOVE T-TP              TO WS-BUFFER-BYTE (BUFFER-INDEX)
  3593         SET BUFFER-INDEX UP BY +1.
  3594
  3595     SET PRT-INDEX TO +1.
  3596
  3597 ELPRTCVP-060.
  3598     MOVE WS-PRINT-BYTE (PRT-INDEX)
  3599                                 TO WS-BUFFER-BYTE (BUFFER-INDEX).
  3600     SET BUFFER-INDEX UP BY +1.
  3601
  3602     IF PRT-INDEX LESS WS-LINE-LENGTH
  3603         SET PRT-INDEX UP BY +1
  3604         GO TO ELPRTCVP-060.
  3605
  3606 ELPRTCVP-EXIT.
  3607     EXIT.
  3608
  3609 ELPRTCVP-PRINT-BUFFER.
  3610     IF WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-SS
  3611        MOVE SPACE               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  3612        SET BUFFER-INDEX UP BY 1.
  3613
  3614     MOVE  T-EM                  TO  WS-BUFFER-BYTE (BUFFER-INDEX)
  3615     SET WS-BUFFER-LENGTH TO BUFFER-INDEX.
  3616
  3617
  3618* EXEC CICS SEND
  3619*        FROM    (WS-BUFFER-AREA)
  3620*        LENGTH  (WS-BUFFER-LENGTH)
  3621*        CTLCHAR (WS-WCC-CNTL)
  3622*        ERASE
  3623*    END-EXEC.
  3624*    MOVE '$$    C E         L F ,   #00003281' TO DFHEIV0
  3625     MOVE X'242420202020432045202020' TO DFHEIV0(1:12)
  3626     MOVE X'2020202020204C2046202C20' TO DFHEIV0(13:12)
  3627     MOVE X'2020233030303033323831' TO DFHEIV0(25:11)
  3628     CALL 'kxdfhei1' USING DFHEIV0,
  3629           WS-BUFFER-AREA,
  3630           WS-BUFFER-LENGTH,
  3631           DFHEIV99,
  3632           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL1524.cbl
  3633           WS-WCC-CNTL,
  3634           DFHEIV99,
  3635           DFHEIV99,
  3636           DFHEIV99,
  3637           DFHEIV99,
  3638           DFHEIV99,
  3639           DFHEIV99
  3640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3641
  3642
  3643     SET BUFFER-INDEX TO +1.
  3644     MOVE '2'                    TO WS-FIRST-TIME-SW.
  3645
  3646 ELPRTCVP-PRINT-EXIT.
  3647     EXIT.
  3648
  3649
  3650
  3651
  3652 9999-DFHBACK SECTION.
  3653     MOVE '9%                    "   ' TO DFHEIV0
  3654     MOVE 'EL1524' TO DFHEIV1
  3655     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3656     GOBACK.
  3657 9999-DFHEXIT.
  3658     IF DFHEIGDJ EQUAL 0001
  3659         NEXT SENTENCE
  3660     ELSE IF DFHEIGDJ EQUAL 2
  3661         GO TO 0200-END-DATA,
  3662               0300-NOT-FOUND,
  3663               8020-ERROR-ABEND,
  3664               8020-ERROR-ABEND
  3665         DEPENDING ON DFHEIGDI
  3666     ELSE IF DFHEIGDJ EQUAL 3
  3667         GO TO 8000-ACTQ-NOT-OPEN,
  3668               8010-ACTQ-NOT-FOUND,
  3669               1000-EXIT
  3670         DEPENDING ON DFHEIGDI
  3671     ELSE IF DFHEIGDJ EQUAL 4
  3672         GO TO 3000-EXIT,
  3673               3000-EXIT
  3674         DEPENDING ON DFHEIGDI
  3675     ELSE IF DFHEIGDJ EQUAL 5
  3676         GO TO 5000-EXIT,
  3677               5000-EXIT
  3678         DEPENDING ON DFHEIGDI.
  3679     MOVE '9%                    "   ' TO DFHEIV0
  3680     MOVE 'EL1524' TO DFHEIV1
  3681     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3682     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6996     Code:        6614
