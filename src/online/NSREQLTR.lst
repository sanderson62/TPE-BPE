* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page   1
* NSREQLTR.cbl
* Options: int("NSREQLTR.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSREQLTR.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSREQLTR.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "NSREQLTR.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSREQLTR.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM INDEX.HTML
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page   2
* NSREQLTR.cbl
    14* 121802    2009122800001  PEMA  NEW PROGRAM
    15* 022212    2011120900003  AJRA  ADD AHL
    16* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    17* 061421  CR2017031500001  PEMA  Update to CCM8
    18******************************************************************
    19 ENVIRONMENT DIVISION.
    20 DATA DIVISION.
    21 working-storage section.
    22 01  DFH-START PIC X(04).
    23 01  P pointer.
    24 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    25 01  var-ptr pointer.
    26 01  env-var-len                 pic 9(4)  binary.
    27 01  rc                          pic 9(9)  binary.
    28 01  filler.
    29     05  a1                      pic s999 comp-3 value +0.
    30     05  a2                      pic s999 comp-3 value +0.
    31     05  m1                      pic s999 comp-3 value +0.
    32     05  v1                      pic s999 comp-3 value +0.
    33     05  v2                      pic s999 comp-3 value +0.
    34     05  WS-WORK-FIELD           PIC X(90)    VALUE SPACES.
    35 01  WS-KIXSYS.
    36     05  WS-KIX-FIL1             PIC X(10).
    37     05  WS-KIX-APPS             PIC X(10).
    38     05  WS-KIX-ENV              PIC X(10).
    39     05  WS-KIX-MYENV            PIC X(10).
    40     05  WS-KIX-SYS              PIC X(10).
    41************************************************
    42* commarea passed to the business logic
    43************************************************
    44 01 srch-commarea.
    45*                                copy ELCLTRSPI.
    46******************************************************************
    47*                   C H A N G E   L O G
    48*
    49* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    50*-----------------------------------------------------------------
    51*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    52* EFFECTIVE    NUMBER
    53*-----------------------------------------------------------------
    54* 121802    2009122800001  PEMA  NEW COPYBOOK
    55******************************************************************
    56****************************************
    57*  commarea for NaperSoft On Demand Claim letters
    58*  (business logic input & output)
    59****************************************
    60     03  BL-INPUT.
    61         05  BL-CARRIER          PIC X.
    62         05  BL-CLAIM-NO         PIC X(7).
    63         05  BL-CERT-NO          PIC X(11).
    64         05  BL-LETTER-ID        PIC XXXX.
    65         05  BL-FOLLOW-UP-DT     PIC X(10).
    66         05  BL-RESEND-DT        PIC X(10).
    67         05  BL-NO-OF-COPIES     PIC 99.
    68         05  BL-PROC-ID          PIC XXXX.
    69         05  BL-COMP-ID          PIC XXX.
    70         05  BL-PRINT-NOW-SW     PIC X.
    71         05  BL-ENC-CD           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page   3
* NSREQLTR.cbl
    72         05  BL-ARCHIVE-NO       PIC 9(8).
    73         05  BL-REGARDING        PIC X(70).
    74     03  BL-OUTPUT.
    75         05  BL-STATUS                   PIC X.
    76             88  BL-OK                      VALUE "P".
    77             88  BL-FAIL                  VALUE "F".
    78         05  BL-MESSAGE          PIC X(50).
    79     03  BL-RECORD-PASSED-DATA   PIC X(2500).
    80 01  INPUT-FROM-FORM.
    81     05  IFF-CARRIER             PIC X.
    82     05  IFF-CLAIM-NO            PIC X(7).
    83     05  IFF-CERT-NO             PIC X(11).
    84     05  IFF-LETTER-ID           PIC XXXX.
    85     05  IFF-FOLLOW-UP-DT        PIC X(10).
    86     05  IFF-RESEND-DT           PIC X(10).
    87     05  IFF-NO-OF-COPIES        PIC 99.
    88     05  IFF-PROC-ID             PIC XXXX.
    89     05  IFF-COMP-ID             PIC XXX.
    90     05  IFF-PRINT-NOW-SW        PIC X.
    91     05  IFF-ENC-CD              PIC XXX.
    92     05  IFF-REGARDING           PIC X(70).
    93************************************
    94* fields used to read web data
    95************************************
    96 01  w-form-name       pic x(80).
    97 01  w-form-value      pic x(80).
    98 01  w-form-name-len   pic s9(8) comp.
    99 01  w-form-value-len  pic s9(8) comp.
   100 01  w-resp            pic s9(8) comp.
   101 01  w-doctoken        pic x(16).
   102* COMP ID TPE REGION   GROUP NAME       HOST          HTTP PORT
   103*
   104*  CID      CID1P      BatchClaims     sdv-nsft01       7001
   105*  CID      MDOFF      BatchClaims     hov-nsft01       7003
   106*  CID      CID1T      BatchClaims     hov-nsft01       6002
   107*  CID      PAUL       BatchClaims     hov-nsft01       5002
   108*  CID      TONY       BatchClaims     hov-nsft01       6003
   109*  DCC      CID1P      BatchDCCClaims  sdv-nsft01       7001
   110*  DCC      MDOFF      BatchDCCClaims  hov-nsft01       7003
   111*  DCC      CID1T      BatchDCCClaims  hov-nsft01       6002
   112*  DCC      PAUL       BatchDCCClaims  hov-nsft01       5002
   113*  DCC      TONY       BatchDCCClaims  hov-nsft01       6003
   114*  AHL      CID1P      BatchAHLClaims  sdv-nsft01       7001
   115*  AHL      MDOFF      BatchAHLClaims  hov-nsft01       7003
   116*  AHL      CID1T      BatchAHLClaims  hov-nsft01       6002
   117*  AHL      PAUL       BatchAHLClaims  hov-nsft01       5002
   118*  AHL      TONY       BatchAHLClaims  hov-nsft01       6003
   119*  AHL      AHLTST     BatchAHLClaims  hov-nsft01       6007
   120*  FNL      CID1P      BatchFNLClaims  sdv-nsft01       7001
   121*  FNL      MDOFF      BatchFNLClaims  hov-nsft01       7003
   122*  FNL      CID1T      BatchFNLClaims  hov-nsft01       6002
   123*  FNL      PAUL       BatchFNLClaims  hov-nsft01       5002
   124*  FNL      TONY       BatchFNLClaims  hov-nsft01       6003
   125*  FNL      AHLTST     BatchFNLClaims  hov-nsft01       6007
   126******************************************
   127* symbol list text for PEMHDR template
   128******************************************
   129 01  WS-PROD-CID-PEMHDR.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page   4
* NSREQLTR.cbl
   130     05  F                       PIC X(7)  VALUE "SERVER=".
   131     05  F                       PIC X(20) VALUE
   132                                    'sdv-nsft01.cso.local'.
   133     05  F                       PIC X(11) VALUE '&GROUPNAME='.
   134     05  F                       PIC X(11) VALUE 'BatchClaims'.
   135     05  F                       PIC X(7)  VALUE '&UNAME='.
   136     05  F                       PIC X(8)  VALUE 'batchjob'.
   137     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   138     05  F                       PIC X(8)  VALUE 'batchjob'.
   139 01  WS-PROD-DCC-PEMHDR.
   140     05  F                       PIC X(7)  VALUE "SERVER=".
   141     05  F                       PIC X(20) VALUE
   142                                    'sdv-nsft01.cso.local'.
   143     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   144     05  F                       PIC X(14) VALUE 'BatchDCCClaims'.
   145     05  F                       PIC X(7)  VALUE '&UNAME='.
   146     05  F                       PIC X(8)  VALUE 'batchjob'.
   147     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   148     05  F                       PIC X(8)  VALUE 'batchjob'.
   149 01  WS-PROD-VPP-PEMHDR.
   150     05  F                       PIC X(7)  VALUE "SERVER=".
   151     05  F                       PIC X(20) VALUE
   152                                    'sdv-nsft01.cso.local'.
   153     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   154     05  F                       PIC X(14) VALUE 'BatchVPPClaims'.
   155     05  F                       PIC X(7)  VALUE '&UNAME='.
   156     05  F                       PIC X(8)  VALUE 'batchjob'.
   157     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   158     05  F                       PIC X(8)  VALUE 'batchjob'.
   159 01  WS-PROD-AHL-PEMHDR.
   160     05  F                       PIC X(7)  VALUE "SERVER=".
   161     05  F                       PIC X(20) VALUE
   162                                    'sdv-nsft01.cso.local'.
   163     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   164     05  F                       PIC X(14) VALUE 'BatchAHLClaims'.
   165     05  F                       PIC X(7)  VALUE '&UNAME='.
   166     05  F                       PIC X(8)  VALUE 'batchjob'.
   167     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   168     05  F                       PIC X(8)  VALUE 'batchjob'.
   169
   170 01  WS-PROD-FNL-PEMHDR.
   171     05  F                       PIC X(7)  VALUE "SERVER=".
   172     05  F                       PIC X(20) VALUE
   173                                    'sdv-nsft01.cso.local'.
   174     05  F                       PIC X(11) VALUE '&GROUPNAME='.
   175     05  F                       PIC X(14) VALUE 'BatchFNLClaims'.
   176     05  F                       PIC X(7)  VALUE '&UNAME='.
   177     05  F                       PIC X(8)  VALUE 'batchjob'.
   178     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   179     05  F                       PIC X(8)  VALUE 'batchjob'.
   180 01  WS-TEST-CID-PEMHDR.
   181     05  F                       PIC X(7)  VALUE "SERVER=".
   182     05  F                       PIC X(20) VALUE
   183                          'hov-nsft02.cso.local'.
   184     05  F                       PIC X(11) VALUE '&GROUPNAME='.
   185     05  F                       PIC X(11) VALUE 'BatchClaims'.
   186     05  F                       PIC X(7)  VALUE '&UNAME='.
   187     05  F                       PIC X(8)  VALUE 'batchjob'.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page   5
* NSREQLTR.cbl
   188     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   189     05  F                       PIC X(8)  VALUE 'batchjob'.
   190 01  WS-TEST-DCC-PEMHDR.
   191     05  F                       PIC X(7)  VALUE "SERVER=".
   192     05  F                       PIC X(20) VALUE
   193                          'hov-nsft02.cso.local'.
   194     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   195     05  F                       PIC X(14) VALUE 'BatchDCCClaims'.
   196     05  F                       PIC X(7)  VALUE '&UNAME='.
   197     05  F                       PIC X(8)  VALUE 'batchjob'.
   198     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   199     05  F                       PIC X(8)  VALUE 'batchjob'.
   200 01  WS-TEST-VPP-PEMHDR.
   201     05  F                       PIC X(7)  VALUE "SERVER=".
   202     05  F                       PIC X(20) VALUE
   203                          'hov-nsft02.cso.local'.
   204     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   205     05  F                       PIC X(14) VALUE 'BatchVPPClaims'.
   206     05  F                       PIC X(7)  VALUE '&UNAME='.
   207     05  F                       PIC X(8)  VALUE 'batchjob'.
   208     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   209     05  F                       PIC X(8)  VALUE 'batchjob'.
   210 01  WS-TEST-AHL-PEMHDR.
   211     05  F                       PIC X(7)  VALUE "SERVER=".
   212     05  F                       PIC X(20) VALUE
   213                          'hov-nsft02.cso.local'.
   214     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   215     05  F                       PIC X(14) VALUE 'BatchAHLClaims'.
   216     05  F                       PIC X(7)  VALUE '&UNAME='.
   217     05  F                       PIC X(8)  VALUE 'batchjob'.
   218     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   219     05  F                       PIC X(8)  VALUE 'batchjob'.
   220 01  WS-TEST-FNL-PEMHDR.
   221     05  F                       PIC X(7)  VALUE "SERVER=".
   222     05  F                       PIC X(20) VALUE
   223                          'hov-nsft02.cso.local'.
   224     05  F                       PIC X(11) VALUE '&GROUPNAME='.
   225     05  F                       PIC X(14) VALUE 'BatchFNLClaims'.
   226     05  F                       PIC X(7)  VALUE '&UNAME='.
   227     05  F                       PIC X(8)  VALUE 'batchjob'.
   228     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   229     05  F                       PIC X(8)  VALUE 'batchjob'.
   230******************************************
   231* symbol list text for PEMFTR template
   232******************************************
   233 01  ws-sl-var-length pic s9(8) comp value +33.
   234 01  WS-VAR-SLUNIKIX.
   235     05  FILLER                  PIC X(09) VALUE "HOSTINFO=".
   236     05  WS-SL-HOST-INFO         PIC X(09) VALUE 'slunikix:'.
   237     05  WS-SL-PORT              PIC XXXX  VALUE '7001'.
   238     05  WS-SL-REST              PIC X(200) VALUE SPACES.
   239 01  ws-lt-var-length pic s9(8) comp value +34.
   240 01  WS-VAR-LOGICTEST.
   241     05  FILLER                  PIC X(09) VALUE "HOSTINFO=".
   242     05  WS-LT-HOST-INFO         PIC X(10) VALUE 'logictest:'.
   243     05  WS-LT-PORT              PIC XXXX  VALUE '6002'.
   244     05  WS-LT-REST              PIC X(200) VALUE SPACES.
   245 01  finished-string.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page   6
* NSREQLTR.cbl
   246     05  FILLER                   PIC X(11)  VALUE "&URLVARLST=".
   247     05  var-string               pic x(200) value spaces.
   248 01 WS-TEST-TESTER.
   249    05  FILLER                   PIC X(11)  VALUE "&URLVARLST=".
   250    05  WS-KEY.
   251        10  OT-CARRIER           PIC X.
   252        10  OT-CLMNO             PIC X(7).
   253        10  OT-CRTNO             PIC X(11).
   254        10  OT-LETTER-ID         PIC X(4).
   255        10  OT-FOLLOW-UP-DT      PIC X(10).
   256        10  OT-RESEND-DT         PIC X(10).
   257        10  OT-NO-OF-COPIES      PIC 99.
   258        10  OT-PROC-ID           PIC XXXX.
   259        10  OT-COMP-ID           PIC XXX.
   260        10  OT-PRINT-NOW-SW      PIC X.
   261        10  OT-ENC-CD            PIC XXX.
   262        10  OT-ARCHIVE-NO        PIC 9(08).
   263        10  OT-REGARDING         PIC X(70).
   264 01  WS-ELMSTR-KEY.
   265     05  WS-ELMSTR-COMPANY-CD    PIC X.
   266     05  WS-ELMSTR-CARRIER       PIC X.
   267     05  WS-ELMSTR-CLAIM-NO      PIC X(7).
   268     05  WS-ELMSTR-CERT-NO       PIC X(11).
   269*                                COPY ELCMSTR.
   270******************************************************************
   271*                                                                *
   272*                            ELCMSTR.                            *
   273*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   274*                            VMOD=2.012                          *
   275*                                                                *
   276*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   277*                                                                *
   278*   FILE TYPE = VSAM,KSDS                                        *
   279*   RECORD SIZE = 350  RECFORM = FIXED                           *
   280*                                                                *
   281*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   282*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   283*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   284*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   285*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   286*                                                 RKP=75,LEN=21  *
   287*                                                                *
   288*   **** NOTE ****                                               *
   289*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   290*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   291*                                                                *
   292*   LOG = YES                                                    *
   293*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   294******************************************************************
   295*                   C H A N G E   L O G
   296*
   297* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   298*-----------------------------------------------------------------
   299*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   300* EFFECTIVE    NUMBER
   301*-----------------------------------------------------------------
   302* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   303* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page   7
* NSREQLTR.cbl
   304* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   305* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   306* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   307* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
   308* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   309******************************************************************
   310 01  CLAIM-MASTER.
   311     12  CL-RECORD-ID                PIC XX.
   312         88  VALID-CL-ID         VALUE 'CL'.
   313
   314     12  CL-CONTROL-PRIMARY.
   315         16  CL-COMPANY-CD           PIC X.
   316         16  CL-CARRIER              PIC X.
   317         16  CL-CLAIM-NO             PIC X(7).
   318         16  CL-CERT-NO.
   319             20  CL-CERT-PRIME       PIC X(10).
   320             20  CL-CERT-SFX         PIC X.
   321
   322     12  CL-CONTROL-BY-NAME.
   323         16  CL-COMPANY-CD-A1        PIC X.
   324         16  CL-INSURED-LAST-NAME    PIC X(15).
   325         16  CL-INSURED-NAME.
   326             20  CL-INSURED-1ST-NAME PIC X(12).
   327             20  CL-INSURED-MID-INIT PIC X.
   328
   329     12  CL-CONTROL-BY-SSN.
   330         16  CL-COMPANY-CD-A2        PIC X.
   331         16  CL-SOC-SEC-NO.
   332             20  CL-SSN-STATE        PIC XX.
   333             20  CL-SSN-ACCOUNT      PIC X(6).
   334             20  CL-SSN-LN3          PIC X(3).
   335
   336     12  CL-CONTROL-BY-CERT-NO.
   337         16  CL-COMPANY-CD-A4        PIC X.
   338         16  CL-CERT-NO-A4.
   339             20  CL-CERT-A4-PRIME    PIC X(10).
   340             20  CL-CERT-A4-SFX      PIC X.
   341
   342     12  CL-CONTROL-BY-CCN.
   343         16  CL-COMPANY-CD-A5        PIC X.
   344         16  CL-CCN-A5.
   345             20  CL-CCN.
   346                 24  CL-CCN-PREFIX-A5 PIC X(4).
   347                 24  CL-CCN-PRIME-A5 PIC X(12).
   348             20  CL-CCN-FILLER-A5    PIC X(4).
   349
   350     12  CL-INSURED-PROFILE-DATA.
   351         16  CL-INSURED-BIRTH-DT     PIC XX.
   352         16  CL-INSURED-SEX-CD       PIC X.
   353             88  INSURED-IS-MALE        VALUE 'M'.
   354             88  INSURED-IS-FEMALE      VALUE 'F'.
   355             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   356         16  CL-INSURED-OCC-CD       PIC X(6).
   357         16  FILLER                  PIC X(5).
   358
   359     12  CL-PROCESSING-INFO.
   360         16  CL-PROCESSOR-ID         PIC X(4).
   361         16  CL-CLAIM-STATUS         PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page   8
* NSREQLTR.cbl
   362             88  CLAIM-IS-OPEN          VALUE 'O'.
   363             88  CLAIM-IS-CLOSED        VALUE 'C'.
   364         16  CL-CLAIM-TYPE           PIC X.
   365*            88  AH-CLAIM               VALUE 'A'.
   366*            88  LIFE-CLAIM             VALUE 'L'.
   367*            88  PROPERTY-CLAIM         VALUE 'P'.
   368*            88  IUI-CLAIM              VALUE 'I'.
   369*            88  GAP-CLAIM              VALUE 'G'.
   370*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   371*            88  OTHER-CLAIM            VALUE 'O'.
   372         16  CL-CLAIM-PREM-TYPE      PIC X.
   373             88  SINGLE-PREMIUM         VALUE '1'.
   374             88  O-B-COVERAGE           VALUE '2'.
   375             88  OPEN-END-COVERAGE      VALUE '3'.
   376         16  CL-INCURRED-DT          PIC XX.
   377         16  CL-REPORTED-DT          PIC XX.
   378         16  CL-FILE-ESTABLISH-DT    PIC XX.
   379         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   380         16  CL-LAST-PMT-DT          PIC XX.
   381         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   382         16  CL-PAID-THRU-DT         PIC XX.
   383         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   384         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   385         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   386         16  CL-PMT-CALC-METHOD      PIC X.
   387             88  CL-360-DAY-YR          VALUE '1'.
   388             88  CL-365-DAY-YR          VALUE '2'.
   389             88  CL-FULL-MONTHS         VALUE '3'.
   390         16  CL-CAUSE-CD             PIC X(6).
   391
   392         16  CL-PRIME-CERT-NO.
   393             20  CL-PRIME-CERT-PRIME PIC X(10).
   394             20  CL-PRIME-CERT-SFX   PIC X.
   395
   396         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   397             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   398             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   399
   400         16  CL-MICROFILM-NO         PIC X(10).
   401         16  FILLER REDEFINES CL-MICROFILM-NO.
   402             20  CL-BENEFIT-PERIOD   PIC 99.
   403             20  FILLER              PIC X(8).
   404         16  CL-PROG-FORM-TYPE       PIC X.
   405         16  CL-LAST-ADD-ON-DT       PIC XX.
   406
   407         16  CL-LAST-REOPEN-DT       PIC XX.
   408         16  CL-LAST-CLOSE-DT        PIC XX.
   409         16  CL-LAST-CLOSE-REASON    PIC X(01).
   410             88  FINAL-PAID             VALUE '1'.
   411             88  CLAIM-DENIED           VALUE '2'.
   412             88  AUTO-CLOSE             VALUE '3'.
   413             88  MANUAL-CLOSE           VALUE '4'.
   414             88  BENEFITS-CHANGED       VALUE 'C'.
   415             88  SETUP-ERRORS           VALUE 'E'.
   416         16  CL-ASSOC-CERT-SEQU      PIC S99.
   417         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   418         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   419             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page   9
* NSREQLTR.cbl
   420         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   421         16  FILLER                  PIC X.
   422
   423     12  CL-CERTIFICATE-DATA.
   424         16  CL-CERT-ORIGIN          PIC X.
   425             88  CERT-WAS-ONLINE        VALUE '1'.
   426             88  CERT-WAS-CREATED       VALUE '2'.
   427             88  COVERAGE-WAS-ADDED     VALUE '3'.
   428         16  CL-CERT-KEY-DATA.
   429             20  CL-CERT-CARRIER     PIC X.
   430             20  CL-CERT-GROUPING    PIC X(6).
   431             20  CL-CERT-STATE       PIC XX.
   432             20  CL-CERT-ACCOUNT.
   433                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   434                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   435             20  CL-CERT-EFF-DT      PIC XX.
   436
   437     12  CL-STATUS-CONTROLS.
   438         16  CL-PRIORITY-CD          PIC X.
   439             88  CONFIDENTIAL-DATA      VALUE '8'.
   440             88  HIGHEST-PRIORITY       VALUE '9'.
   441         16  CL-SUPV-ATTN-CD         PIC X.
   442             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   443             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   444         16  CL-PURGED-DT            PIC XX.
   445         16  CL-RESTORED-DT          PIC XX.
   446         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   447         16  CL-NEXT-RESEND-DT       PIC XX.
   448         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   449         16  CL-CRITICAL-PERIOD      PIC 99.
   450*        16  FILLER                  PIC XX.
   451         16  CL-LAST-MAINT-DT        PIC XX.
   452         16  CL-LAST-MAINT-USER      PIC X(4).
   453         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   454         16  CL-LAST-MAINT-TYPE      PIC X.
   455             88  CLAIM-SET-UP           VALUE ' '.
   456             88  PAYMENT-MADE           VALUE '1'.
   457             88  LETTER-SENT            VALUE '2'.
   458             88  MASTER-WAS-ALTERED     VALUE '3'.
   459             88  MASTER-WAS-RESTORED    VALUE '4'.
   460             88  INCURRED-DATE-CHANGED  VALUE '5'.
   461             88  FILE-CONVERTED         VALUE '6'.
   462             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   463             88  ERROR-CORRECTION       VALUE 'E'.
   464         16  CL-RELATED-CLAIM-NO     PIC X(7).
   465         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   466         16  CL-BENEFICIARY          PIC X(10).
   467         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   468         16  CL-DENIAL-TYPE          PIC X.
   469             88  CL-TYPE-DENIAL          VALUE '1'.
   470             88  CL-TYPE-RESCISSION      VALUE '2'.
   471             88  CL-TYPE-REFORMATION     VALUE '3'.
   472             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   473             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   474         16  CL-NO-OF-EXTENSIONS     PIC 99.
   475         16  filler                  pic x(3).
   476*        16  CL-CRIT-PER-RECURRENT   PIC X.
   477*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  10
* NSREQLTR.cbl
   478*        16  CL-RTW-DT               PIC XX.
   479
   480     12  CL-TRAILER-CONTROLS.
   481         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   482             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   483             88  CL-LAST-TRL-AVAIL      VALUE +100.
   484             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   485         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   486         16  FILLER                  PIC XX.
   487         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   488         16  CL-ADDRESS-TRAILER-CNT.
   489             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   490                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   491             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   492                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   493             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   494                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   495             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   496                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   497             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   498                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   499             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   500                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   501             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   502                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   503
   504     12  CL-CV-REFERENCE-NO.
   505         16  CL-CV-REFNO-PRIME       PIC X(18).
   506         16  CL-CV-REFNO-SFX         PIC XX.
   507
   508     12  CL-FILE-LOCATION            PIC X(4).
   509
   510     12  CL-PROCESS-ERRORS.
   511         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   512             88  NO-FATAL-ERRORS        VALUE ZERO.
   513         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   514             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   515
   516     12  CL-PRODUCT-CD               PIC X.
   517
   518     12  CL-CURRENT-KEY-DATA.
   519         16  CL-CURRENT-CARRIER      PIC X.
   520         16  CL-CURRENT-GROUPING     PIC X(6).
   521         16  CL-CURRENT-STATE        PIC XX.
   522         16  CL-CURRENT-ACCOUNT      PIC X(10).
   523
   524     12  CL-ASSOCIATES               PIC X.
   525         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   526         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   527         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   528         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   529
   530     12  CL-ACTIVITY-CODE            PIC 99.
   531     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   532     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   533
   534     12  CL-LAPSE-REPORT-CODE        PIC 9.
   535     12  CL-LAG-REPORT-CODE          PIC 9.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  11
* NSREQLTR.cbl
   536     12  CL-LOAN-TYPE                PIC XX.
   537     12  CL-LEGAL-STATE              PIC XX.
   538
   539     12  CL-YESNOSW                  PIC X.
   540     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   541         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   542         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   543         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   544     12  cl-insured-type             pic x.
   545         88  cl-claim-on-primary         value 'P'.
   546         88  cl-claim-on-co-borrower     value 'C'.
   547     12  cl-benefit-expiration-dt    PIC XX.
   548 01 output-msg.
   549    05 filler              pic x(4) value "MSG=".
   550    05 out-msg-text        pic x(50).
   551 01  MISC.
   552     12  WS-RESPONSE             PIC S9(8)   COMP.
   553         88  RESP-NORMAL                  VALUE +00.
   554         88  RESP-NOTFND                  VALUE +13.
   555         88  RESP-DUPREC                  VALUE +14.
   556         88  RESP-DUPKEY                  VALUE +15.
   557         88  RESP-NOTOPEN                 VALUE +19.
   558         88  RESP-ENDFILE                 VALUE +20.
   559*****************************************
   560* symbol list for the PEMBOD template
   561*****************************************
   562*                                COPY NSCVARS.
   563******************************************************************
   564*                   C H A N G E   L O G
   565*
   566* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   567*-----------------------------------------------------------------
   568*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   569* EFFECTIVE    NUMBER
   570*-----------------------------------------------------------------
   571* 031912    2011110200002  AJRA  AHL CLAIM NUM
   572* 013013    2012110080002  AJRA  ADD ACCOUNT GPCD
   573* 031116    2015110400001  TANA  ADD EL150D FIELDS
   574* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
   575* 071719    2019011600010  TANA  ADD VERIF CODE
   576******************************************************************
   577 01 NAPER-OUTPUT-DATA.
   578    05 FILLER              PIC X(6) VALUE "TEMPL=".
   579    05 OUT-TEMP            PIC X(4).
   580    05 FILLER              PIC X(8) VALUE "&LETTER=".
   581    05 OUT-LETTER          PIC X(4).
   582    05 FILLER              PIC X(6) VALUE "&CARR=".
   583    05 OUT-CARR            PIC X.
   584    05 FILLER              PIC X(7) VALUE "&CLMNO=".
   585    05 OUT-CLMNO           PIC X(7).
   586    05 FILLER              PIC X(7) VALUE "&CRTNO=".
   587    05 OUT-CRTNO           PIC X(11).
   588    05 FILLER              PIC X(7) VALUE "&ACTNO=".
   589    05 OUT-ACTNO           PIC X(10).
   590    05 FILLER              PIC X(8) VALUE "&ILNAME=".
   591    05 OUT-ILNAME          PIC X(15).
   592    05 FILLER              PIC X(8) VALUE "&IFNAME=".
   593    05 OUT-IFNAME          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  12
* NSREQLTR.cbl
   594    05 FILLER              PIC X(7) VALUE "&SEXCD=".
   595    05 OUT-SEX-CD          PIC X.
   596    05 FILLER              PIC X(5) VALUE "&SSN=".
   597    05 OUT-SSN             PIC X(11).
   598    05 FILLER              PIC X(9) VALUE "&CLMSTAT=".
   599    05 OUT-CLMSTAT         PIC X.
   600    05 FILLER              PIC X(8) VALUE "&CLMTYP=".
   601    05 OUT-CLMTYPE         PIC X.
   602    05 FILLER              PIC X(7) VALUE "&ESTDT=".
   603    05 OUT-EST-DT          PIC X(21).
   604    05 FILLER              PIC X(7) VALUE "&INCDT=".
   605    05 OUT-INC-DT          PIC X(21).
   606    05 FILLER              PIC X(7) VALUE "&RPTDT=".
   607    05 OUT-RPT-DT          PIC X(21).
   608    05 FILLER              PIC X(10) VALUE "&PDTHRUDT=".
   609    05 OUT-PD-THRU-DT      PIC X(21).
   610    05 FILLER              PIC X(11) VALUE "&FORMDUEDT=".
   611    05 OUT-FORM-DUE-DT     PIC X(21).
   612    05 FILLER              PIC X(8) VALUE "&LPMTDT=".
   613    05 OUT-LST-PMT-DT      PIC X(21).
   614    05 FILLER              PIC X(8) VALUE "&NOPMTS=".
   615    05 OUT-NO-OF-PMTS      PIC X(10).
   616    05 FILLER              PIC X(9) VALUE "&TOTPAID=".
   617    05 OUT-TOT-PAID        PIC 9999999.99.
   618    05 FILLER              PIC X(8) VALUE "&LPDAMT=".
   619    05 OUT-LST-PD-AMT      PIC 9999999.99.
   620    05 FILLER              PIC X(9) VALUE "&ADDRCNT=".
   621    05 OUT-ADDR-CNT        PIC 9.
   622    05 FILLER              PIC X(7) VALUE "&CRTST=".
   623    05 OUT-CRT-ST          PIC XX.
   624    05 FILLER              PIC X(10) VALUE "&CERTACCT=".
   625    05 OUT-CERTACCT        PIC X(10).
   626    05 FILLER              PIC X(7) VALUE "&EFFDT=".
   627    05 OUT-EFF-DT          PIC X(21).
   628    05 FILLER              PIC X(8) VALUE "&LMNTDT=".
   629    05 OUT-LST-MAINT-DT    PIC X(21).
   630    05 FILLER              PIC X(10) VALUE "&LMNTUSER=".
   631    05 OUT-LST-MAINT-USER  PIC X(10).
   632    05 FILLER              PIC X(10) VALUE "&LMNTTYPE=".
   633    05 OUT-LST-MAINT-TYPE  PIC X(10).
   634    05 FILLER              PIC X(6) VALUE "&DIAG=".
   635    05 OUT-DIAG            PIC X(66).
   636    05 FILLER              PIC X(7) VALUE "&EXPDT=".
   637    05 OUT-EXP-DT          PIC X(21).
   638    05 FILLER              PIC X(12) VALUE "&LCLSREASON=".
   639    05 OUT-LST-CLS-REA     PIC X(10).
   640    05 FILLER              PIC X(8) VALUE "&BRTHDT=".
   641    05 OUT-BIRTH-DT        PIC X(21).
   642    05 FILLER              PIC X(6) VALUE "&TERM=".
   643    05 OUT-TERM            PIC 999.
   644    05 FILLER              PIC X(7) VALUE "&BENCD=".
   645    05 OUT-BEN-CD          PIC XX.
   646    05 FILLER              PIC X(8) VALUE "&BENAMT=".
   647    05 OUT-BENAMT          PIC 9999999.99.
   648    05 FILLER              PIC X(9) VALUE "&CRITPER=".
   649    05 OUT-CRIT-PER        PIC 999.
   650    05 FILLER              PIC X(9) VALUE "&WAITPER=".
   651    05 OUT-WAIT-PER        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  13
* NSREQLTR.cbl
   652    05 FILLER              PIC X(11)  VALUE "&LFINTRATE=".
   653    05 OUT-LF-INT-RATE     PIC 99.99999.
   654    05 FILLER              PIC X(10) VALUE "&AUTOPYDT=".
   655    05 OUT-AUTO-PY-DT      PIC X(21).
   656    05 FILLER              PIC X(12) VALUE "&AUTOSCHEND=".
   657    05 OUT-AUTO-SCHD-END   PIC X(21).
   658    05 FILLER              PIC X(8) VALUE "&LOANNO=".
   659    05 OUT-LOAN-NO         PIC X(25).
   660    05 FILLER              PIC X(5) VALUE "&APR=".
   661    05 OUT-APR             PIC 99.99999.
   662    05 FILLER              PIC X(8) VALUE "&LACTDT=".
   663    05 OUT-LST-ACT-DT      PIC X(21).
   664    05 FILLER              PIC X(7) VALUE "&ACTDT=".
   665    05 OUT-ACT-DT          PIC X(21).
   666    05 FILLER              PIC X(10) VALUE "&LACTTYPE=".
   667    05 OUT-LST-ACT-TYPE    PIC X(15).
   668    05 FILLER              PIC X(9) VALUE "&ACTTYPE=".
   669    05 OUT-ACT-TYPE        PIC X(15).
   670    05 FILLER              PIC X(6) VALUE "&FORM=".
   671    05 OUT-FORM            PIC X(4).
   672    05 FILLER              PIC X(9) VALUE "&INSNAME=".
   673    05 OUT-INS-NAME        PIC X(36).
   674    05 FILLER              PIC X(10) VALUE "&INSADDR1=".
   675    05 OUT-INS-ADDR1       PIC X(36).
   676    05 FILLER              PIC X(10) VALUE "&INSADDR2=".
   677    05 OUT-INS-ADDR2       PIC X(36).
   678    05 FILLER              PIC X(9) VALUE "&INSCITY=".
   679    05 OUT-INS-CITY        PIC X(28).
   680    05 FILLER              PIC X(10) VALUE "&INSSTATE=".
   681    05 OUT-INS-STATE       PIC XX.
   682    05 FILLER              PIC X(8) VALUE "&INSZIP=".
   683    05 OUT-INS-ZIP         PIC X(10).
   684    05 FILLER              PIC X(10) VALUE "&INSPHONE=".
   685    05 OUT-INS-PHONE       PIC X(13).
   686    05 FILLER              PIC X(10) VALUE "&BENENAME=".
   687    05 OUT-BEN-NAME        PIC X(32).
   688    05 FILLER              PIC X(11) VALUE "&BENEADDR1=".
   689    05 OUT-BEN-ADDR1       PIC X(36).
   690    05 FILLER              PIC X(11) VALUE "&BENEADDR2=".
   691    05 OUT-BEN-ADDR2       PIC X(32).
   692    05 FILLER              PIC X(10) VALUE "&BENECITY=".
   693    05 OUT-BEN-CITY        PIC X(28).
   694    05 FILLER              PIC X(11) VALUE "&BENESTATE=".
   695    05 OUT-BEN-STATE       PIC XX.
   696    05 FILLER              PIC X(9) VALUE "&BENEZIP=".
   697    05 OUT-BEN-ZIP         PIC X(10).
   698    05 FILLER              PIC X(11) VALUE "&BENEPHONE=".
   699    05 OUT-BEN-PHONE       PIC X(13).
   700    05 FILLER              PIC X(8) VALUE "&OANAME=".
   701    05 OUT-ORIG-NAME       PIC X(32).
   702    05 FILLER              PIC X(10) VALUE "&ACCTNAME=".
   703    05 OUT-ACCT-NAME       PIC X(32).
   704    05 FILLER              PIC X(11) VALUE "&ACCTADDR1=".
   705    05 OUT-ACCT-ADDR1      PIC X(36).
   706    05 FILLER              PIC X(11) VALUE "&ACCTADDR2=".
   707    05 OUT-ACCT-ADDR2      PIC X(32).
   708    05 FILLER              PIC X(10) VALUE "&ACCTCITY=".
   709    05 OUT-ACCT-CITY       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  14
* NSREQLTR.cbl
   710    05 FILLER              PIC X(11) VALUE "&ACCTSTATE=".
   711    05 OUT-ACCT-STATE      PIC XX.
   712    05 FILLER              PIC X(9)  VALUE "&ACCTZIP=".
   713    05 OUT-ACCT-ZIP        PIC X(10).
   714    05 FILLER              PIC X(11) VALUE "&ACCTPHONE=".
   715    05 OUT-ACCT-PHONE      PIC X(13).
   716    05 FILLER              PIC X(7) VALUE "&ENCCD=".
   717    05 OUT-ENC-CODE        PIC XXX.
   718    05 FILLER              PIC X(7) VALUE "&ENCST=".
   719    05 OUT-ENC-ST          PIC XX.
   720    05 FILLER              PIC X(8) VALUE "&ARCHNO=".
   721    05 OUT-ARCHNO          PIC 999999999.
   722    05 FILLER              PIC X(11) VALUE "&FLTRPRTDT=".
   723    05 OUT-1ST-LTR-PRT-DT  PIC X(21).
   724    05 FILLER              PIC X(11) VALUE "&NEXTDUEDT=".
   725    05 OUT-NEXT-DUE-DT     PIC X(21).
   726    05 FILLER              PIC X(8) VALUE "&JLNAME=".
   727    05 OUT-JLNAME          PIC X(15).
   728    05 FILLER              PIC X(8) VALUE "&JFNAME=".
   729    05 OUT-JFNAME          PIC X(10).
   730    05 FILLER              PIC X(9)  VALUE "&ENCLINE=".
   731    05 OUT-ENCLINE         PIC X(100).
   732    05 FILLER              PIC X(9) VALUE "&ENCATTS=".
   733    05 OUT-ENCATTS         PIC X(255).
   734    05 FILLER              PIC X(10) VALUE "&OUTSTACK=".
   735    05 OUT-OUTSTACK        PIC X.
   736    05 FILLER              PIC X(8) VALUE "&PROCID=".
   737    05 OUT-PROCID          PIC XXXX.
   738    05 FILLER              PIC X(8) VALUE "&COMPID=".
   739    05 OUT-COMPID          PIC XXX.
   740    05 FILLER              PIC X(8) VALUE "&PRTNOW=".
   741    05 OUT-PRINT-NOW-SW    PIC X.
   742    05 FILLER              PIC X(11) VALUE "&CYCLEDATE=".
   743    05 OUT-CYCLE-DATE      PIC X(8).
   744    05 FILLER              PIC X(11) VALUE "&ENCSTNAME=".
   745    05 OUT-ENC-ST-NAME     PIC XX.
   746    05 FILLER              PIC X(10) VALUE "&CARRIDLU=".
   747    05 OUT-CARR-LU         PIC X.
   748    05 FILLER              PIC X(5)  VALUE "&CCN=".
   749    05 OUT-AHL-CLAIM-NO    PIC X(9).
   750    05 FILLER              PIC X(4) VALUE "&GP=".
   751    05 OUT-ACCT-GPCD       PIC 99.
   752    05 FILLER              PIC X(9) VALUE "&MAXBENS=".
   753    05 OUT-MAX-BENS        PIC 9(3).
   754    05 FILLER              PIC X(10) VALUE "&PAIDBENS=".
   755    05 OUT-PAID-BENS       PIC 9(3).
   756    05 FILLER              PIC X(9) VALUE "&REMBENS=".
   757    05 OUT-REM-BENS        PIC 9(3).
   758    05 FILLER              PIC X(9) VALUE "&EXCLPER=".
   759    05 OUT-EXCL-PER        PIC 9(3).
   760    05 FILLER              PIC X(8) VALUE "&RECMOS=".
   761    05 OUT-REC-MOS         PIC 9(2).
   762    05 FILLER              PIC X(8) VALUE "&INSTYP=".
   763    05 OUT-INS-TYP         PIC X(4).
   764    05 FILLER              PIC X(8) VALUE "&BENPER=".
   765    05 OUT-BEN-PER         PIC 9(2).
   766    05 FILLER              PIC X(7) VALUE "&ACCSW=".
   767    05 OUT-ACC-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  15
* NSREQLTR.cbl
   768    05 FILLER              PIC X(7) VALUE "&VERCD=".
   769    05 OUT-VER-CD          PIC X(5).
   770****************************************************************
   771*
   772* Copyright (c) 2007-2013 Dell Inc.
   773* All rights reserved.
   774*
   775****************************************************************
   776 01  DFHEIV.
   777   02  DFHEIV0               PIC X(35).
   778   02  DFHEIV1               PIC X(08).
   779   02  DFHEIV2               PIC X(08).
   780   02  DFHEIV3               PIC X(08).
   781   02  DFHEIV4               PIC X(06).
   782   02  DFHEIV5               PIC X(04).
   783   02  DFHEIV6               PIC X(04).
   784   02  DFHEIV7               PIC X(02).
   785   02  DFHEIV8               PIC X(02).
   786   02  DFHEIV9               PIC X(01).
   787   02  DFHEIV10              PIC S9(7) COMP-3.
   788   02  DFHEIV11              PIC S9(4) COMP SYNC.
   789   02  DFHEIV12              PIC S9(4) COMP SYNC.
   790   02  DFHEIV13              PIC S9(4) COMP SYNC.
   791   02  DFHEIV14              PIC S9(4) COMP SYNC.
   792   02  DFHEIV15              PIC S9(4) COMP SYNC.
   793   02  DFHEIV16              PIC S9(9) COMP SYNC.
   794   02  DFHEIV17              PIC X(04).
   795   02  DFHEIV18              PIC X(04).
   796   02  DFHEIV19              PIC X(04).
   797   02  DFHEIV20              USAGE IS POINTER.
   798   02  DFHEIV21              USAGE IS POINTER.
   799   02  DFHEIV22              USAGE IS POINTER.
   800   02  DFHEIV23              USAGE IS POINTER.
   801   02  DFHEIV24              USAGE IS POINTER.
   802   02  DFHEIV25              PIC S9(9) COMP SYNC.
   803   02  DFHEIV26              PIC S9(9) COMP SYNC.
   804   02  DFHEIV27              PIC S9(9) COMP SYNC.
   805   02  DFHEIV28              PIC S9(9) COMP SYNC.
   806   02  DFHEIV29              PIC S9(9) COMP SYNC.
   807   02  DFHEIV30              PIC S9(9) COMP SYNC.
   808   02  DFHEIV31              PIC S9(9) COMP SYNC.
   809   02  DFHEIV32              PIC S9(4) COMP SYNC.
   810   02  DFHEIV33              PIC S9(4) COMP SYNC.
   811   02  DFHEIV34              PIC S9(4) COMP SYNC.
   812   02  DFHEIV35              PIC S9(4) COMP SYNC.
   813   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   814   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   815   02  FILLER                PIC X(02).
   816   02  DFHEIV99              PIC X(08) VALUE SPACE.
   817   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   818   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   819   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   820   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   821   02  DFHEIVL4              PIC X(255) VALUE SPACE.
   822   02  DFHEIVL5              PIC X(255) VALUE SPACE.
   823 LINKAGE  SECTION.
   824*****************************************************************
   825*                                                               *
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  16
* NSREQLTR.cbl
   826* Copyright (c) 2007-2013 Dell Inc.                             *
   827* All rights reserved.                                          *
   828*                                                               *
   829*****************************************************************
   830 01  dfheiblk.
   831     02  eibtime          pic s9(7) comp-3.
   832     02  eibdate          pic s9(7) comp-3.
   833     02  eibtrnid         pic x(4).
   834     02  eibtaskn         pic s9(7) comp-3.
   835     02  eibtrmid         pic x(4).
   836     02  dfheigdi         pic s9(4) comp.
   837     02  eibcposn         pic s9(4) comp.
   838     02  eibcalen         pic s9(4) comp.
   839     02  eibaid           pic x(1).
   840     02  eibfiller1       pic x(1).
   841     02  eibfn            pic x(2).
   842     02  eibfiller2       pic x(2).
   843     02  eibrcode         pic x(6).
   844     02  eibfiller3       pic x(2).
   845     02  eibds            pic x(8).
   846     02  eibreqid         pic x(8).
   847     02  eibrsrce         pic x(8).
   848     02  eibsync          pic x(1).
   849     02  eibfree          pic x(1).
   850     02  eibrecv          pic x(1).
   851     02  eibsend          pic x(1).
   852     02  eibatt           pic x(1).
   853     02  eibeoc           pic x(1).
   854     02  eibfmh           pic x(1).
   855     02  eibcompl         pic x(1).
   856     02  eibsig           pic x(1).
   857     02  eibconf          pic x(1).
   858     02  eiberr           pic x(1).
   859     02  eibrldbk         pic x(1).
   860     02  eiberrcd         pic x(4).
   861     02  eibsynrb         pic x(1).
   862     02  eibnodat         pic x(1).
   863     02  eibfiller5       pic x(2).
   864     02  eibresp          pic s9(8) comp.
   865     02  eibresp2         pic s9(8) comp.
   866     02  dfheigdj         pic s9(4) comp.
   867     02  dfheigdk         pic s9(4) comp.
   868 01  DFHCOMMAREA       PIC X(01).
   869 01  var  pic x(30).
   870 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
   871 0000-DFHEXIT SECTION.
   872     MOVE '9#                    $   ' TO DFHEIV0.
   873     MOVE 'NSREQLTR' TO DFHEIV1.
   874     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   875*********************
   876* Receive web input
   877*********************
   878     set P to address of KIXSYS
   879     CALL "getenv" using by value P returning var-ptr
   880     if var-ptr = null then
   881        display ' kixsys not set '
   882     else
   883        set address of var to var-ptr
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  17
* NSREQLTR.cbl
   884        move 0 to env-var-len
   885        inspect var tallying env-var-len
   886          for characters before X'00'
   887*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
   888        unstring var (1:env-var-len) delimited by '/'
   889           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
   890              WS-KIX-SYS
   891        end-unstring
   892*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
   893*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
   894     end-if
   895
   896* exec cics web
   897*       startbr formfield resp(w-resp)
   898*     end-exec.
   899*    MOVE 'X(f                   &  N#00000891' TO DFHEIV0
   900     MOVE X'582866202020202020202020' TO DFHEIV0(1:12)
   901     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   902     MOVE X'204E233030303030383931' TO DFHEIV0(25:11)
   903     CALL 'kxdfhei1' USING DFHEIV0,
   904           DFHEIV99,
   905           DFHEIV99,
   906           DFHEIV99,
   907           DFHEIV99,
   908           DFHEIV99
   909     MOVE EIBRESP  TO w-resp
   910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   911
   912      perform read-form thru read-form-exit
   913         until w-resp not = 0 .
   914*   dfhresp(normal)
   915
   916* exec cics web
   917*       endbr formfield
   918*     end-exec.
   919*    MOVE 'X,f                   #   #00000896' TO DFHEIV0
   920     MOVE X'582C66202020202020202020' TO DFHEIV0(1:12)
   921     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
   922     MOVE X'2020233030303030383936' TO DFHEIV0(25:11)
   923     CALL 'kxdfhei1' USING DFHEIV0,
   924           DFHEIV99,
   925           DFHEIV99
   926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   927
   928     MOVE IFF-CARRIER             TO OT-CARRIER
   929     MOVE IFF-CLAIM-NO            TO OT-CLMNO
   930     MOVE IFF-CERT-NO             TO OT-CRTNO
   931     MOVE IFF-LETTER-ID           TO OT-LETTER-ID
   932     MOVE IFF-FOLLOW-UP-DT        TO OT-FOLLOW-UP-DT
   933     MOVE IFF-RESEND-DT           TO OT-RESEND-DT
   934     MOVE IFF-NO-OF-COPIES        TO OT-NO-OF-COPIES
   935     MOVE IFF-PROC-ID             TO OT-PROC-ID
   936     MOVE IFF-COMP-ID             TO OT-COMP-ID
   937     MOVE IFF-PRINT-NOW-SW        TO OT-PRINT-NOW-SW
   938     MOVE IFF-ENC-CD              TO OT-ENC-CD
   939     MOVE ZEROS                   TO OT-ARCHIVE-NO
   940     MOVE IFF-REGARDING           TO OT-REGARDING
   941*    DISPLAY ' INPUT FORM ' WS-KEY
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  18
* NSREQLTR.cbl
   942*****************************************
   943* Invoke the LETTER business logic
   944*****************************************
   945
   946* exec cics link
   947*       program('NSRLTRBL')
   948*       commarea(srch-commarea)
   949*    end-exec.
   950     MOVE LENGTH OF
   951      srch-commarea
   952       TO DFHEIV11
   953     MOVE 'NSRLTRBL' TO DFHEIV1
   954*    MOVE '."C                   (   #00000916' TO DFHEIV0
   955     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
   956     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
   957     MOVE X'2020233030303030393136' TO DFHEIV0(25:11)
   958     CALL 'kxdfhei1' USING DFHEIV0,
   959           DFHEIV1,
   960           srch-commarea,
   961           DFHEIV11,
   962           DFHEIV99,
   963           DFHEIV99,
   964           DFHEIV99,
   965           DFHEIV99
   966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   967
   968     IF BL-OK
   969*       DISPLAY ' BL OK ' BL-ARCHIVE-NO
   970        MOVE BL-RECORD-PASSED-DATA
   971                                 TO NAPER-OUTPUT-DATA
   972        MOVE BL-ARCHIVE-NO          TO OT-ARCHIVE-NO
   973     END-IF
   974     move +1 to v2
   975     perform varying v1 from +1 by +1 until v1 > +1
   976        if ot-carrier (v1:1) <> spaces
   977           move ot-carrier(v1:1) to var-string(v2:1)
   978           add +1 to v2
   979        end-if
   980     end-perform
   981
   982     move '~~' to var-string(v2:2)
   983     add +2 to v2
   984     perform varying v1 from +1 by +1 until v1 > +7
   985        if ot-clmno (v1:1) <> spaces
   986           move ot-clmno(v1:1) to var-string(v2:1)
   987           add +1 to v2
   988        end-if
   989     end-perform
   990
   991     move '~~' to var-string(v2:2)
   992     add +2 to v2
   993     perform varying v1 from +1 by +1 until v1 > +11
   994        if ot-crtno (v1:1) <> spaces
   995           move ot-crtno(v1:1) to var-string(v2:1)
   996           add +1 to v2
   997        end-if
   998     end-perform
   999
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  19
* NSREQLTR.cbl
  1000     move '~~' to var-string(v2:2)
  1001     add +2 to v2
  1002     perform varying v1 from +1 by +1 until v1 > +4
  1003        if ot-letter-id (v1:1) <> spaces
  1004           move ot-letter-id(v1:1) to var-string(v2:1)
  1005           add +1 to v2
  1006        end-if
  1007     end-perform
  1008
  1009     move '~~' to var-string(v2:2)
  1010     add +2 to v2
  1011     perform varying v1 from +1 by +1 until v1 > +10
  1012        if ot-follow-up-dt (v1:1) <> spaces
  1013           move ot-follow-up-dt(v1:1) to var-string(v2:1)
  1014           add +1 to v2
  1015        end-if
  1016     end-perform
  1017
  1018     move '~~' to var-string(v2:2)
  1019     add +2 to v2
  1020     perform varying v1 from +1 by +1 until v1 > +10
  1021        if ot-resend-dt (v1:1) <> spaces
  1022           move ot-resend-dt(v1:1) to var-string(v2:1)
  1023           add +1 to v2
  1024        end-if
  1025     end-perform
  1026
  1027     move '~~' to var-string(v2:2)
  1028     add +2 to v2
  1029     perform varying v1 from +1 by +1 until v1 > +2
  1030        if ot-no-of-copies (v1:1) <> spaces
  1031           move ot-no-of-copies(v1:1) to var-string(v2:1)
  1032           add +1 to v2
  1033        end-if
  1034     end-perform
  1035
  1036     move '~~' to var-string(v2:2)
  1037     add +2 to v2
  1038     perform varying v1 from +1 by +1 until v1 > +4
  1039        if ot-proc-id (v1:1) <> spaces
  1040           move ot-proc-id(v1:1) to var-string(v2:1)
  1041           add +1 to v2
  1042        end-if
  1043     end-perform
  1044
  1045     move '~~' to var-string(v2:2)
  1046     add +2 to v2
  1047     perform varying v1 from +1 by +1 until v1 > +3
  1048        if ot-comp-id (v1:1) <> spaces
  1049           move ot-comp-id(v1:1) to var-string(v2:1)
  1050           add +1 to v2
  1051        end-if
  1052     end-perform
  1053
  1054     move '~~' to var-string(v2:2)
  1055     add +2 to v2
  1056     perform varying v1 from +1 by +1 until v1 > +1
  1057        if ot-print-now-sw (v1:1) <> spaces
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  20
* NSREQLTR.cbl
  1058           move ot-print-now-sw(v1:1) to var-string(v2:1)
  1059           add +1 to v2
  1060        end-if
  1061     end-perform
  1062
  1063     move '~~' to var-string(v2:2)
  1064     add +2 to v2
  1065     perform varying v1 from +1 by +1 until v1 > +3
  1066        if ot-enc-cd (v1:1) <> spaces
  1067           move ot-enc-cd(v1:1) to var-string(v2:1)
  1068           add +1 to v2
  1069        end-if
  1070     end-perform
  1071
  1072     move '~~' to var-string(v2:2)
  1073     add +2 to v2
  1074     perform varying v1 from +1 by +1 until v1 > +8
  1075        if ot-archive-no (v1:1) <> spaces
  1076           move ot-archive-no(v1:1) to var-string(v2:1)
  1077           add +1 to v2
  1078        end-if
  1079     end-perform
  1080
  1081     perform varying m1 from +70 by -1 until
  1082        (m1 < +1)
  1083        or (ot-regarding(m1:1) <> spaces)
  1084     end-perform
  1085
  1086     move +1 to a2
  1087     if m1 > +0
  1088        MOVE SPACES              TO WS-WORK-FIELD
  1089        perform varying a1 from +1 by +1 until a1 > m1
  1090           if ot-regarding(a1:1) = ' '
  1091              move '~'           to ws-work-field(a2:1)
  1092              add +1 to a2
  1093           else
  1094              move ot-regarding(a1:1) to ws-work-field(a2:1)
  1095              add +1 to a2
  1096           end-if
  1097        end-perform
  1098     end-if
  1099
  1100     move ws-work-field to ot-regarding
  1101
  1102     move '~~' to var-string(v2:2)
  1103     add +2 to v2
  1104     perform varying v1 from +1 by +1 until v1 > +70
  1105        if ot-regarding (v1:1) <> spaces and '&'
  1106           move ot-regarding(v1:1) to var-string(v2:1)
  1107           add +1 to v2
  1108        end-if
  1109     end-perform
  1110     move finished-string        to ws-lt-rest
  1111     evaluate ws-kix-myenv
  1112        when 'cid1p'
  1113           move finished-string  to ws-sl-rest
  1114           move '7001'           to ws-sl-port
  1115        when 'mdoff'
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  21
* NSREQLTR.cbl
  1116           move finished-string  to ws-sl-rest
  1117           move '7003'           to ws-sl-port
  1118        when 'paul'
  1119           move '5002'           to ws-lt-port
  1120        when 'tony'
  1121           move '6003'           to ws-lt-port
  1122        when 'ahltst'
  1123           move '6007'           to ws-lt-port
  1124        when other
  1125           move '6002'           to ws-lt-port
  1126     end-evaluate
  1127*    MOVE X'04'                  TO WS-ELMSTR-COMPANY-CD
  1128*    MOVE IFF-CARRIER            TO WS-ELMSTR-CARRIER
  1129*    MOVE IFF-CLAIM-NO           TO WS-ELMSTR-CLAIM-NO
  1130*    MOVE IFF-CERT-NO            TO WS-ELMSTR-CERT-NO
  1131*
  1132*    EXEC CICS READ
  1133*         DATASET    ('ELMSTR')
  1134*         INTO       (CLAIM-MASTER)
  1135*         RIDFLD     (WS-ELMSTR-KEY)
  1136*         RESP       (WS-RESPONSE)
  1137*    END-EXEC.
  1138*
  1139*    IF RESP-NORMAL
  1140*       MOVE IFF-LETTER-ID       TO OUT-TEMP
  1141*                                   OUT-LETTER
  1142*       MOVE CL-CARRIER          TO OUT-CARR
  1143*       MOVE CL-INSURED-LAST-NAME
  1144*                                TO OUT-ILNAME
  1145*       MOVE CL-INSURED-1ST-NAME TO OUT-IFNAME
  1146*       MOVE CL-CLAIM-NO         TO OUT-CLMNO
  1147*       MOVE CL-CERT-NO          TO OUT-CRTNO
  1148*       MOVE CL-CERT-ACCOUNT     TO OUT-ACTNO
  1149*    END-IF
  1150
  1151*    exec cics link program('NSRLTRBL')
  1152*       commarea(srch-commarea)
  1153*    end-exec.
  1154***********************************************************
  1155* Build output document.  There are three templates used
  1156* for this document.  PEMHDR and PEMFTR are the header
  1157* and footer, respectively.  PEMBOD is used for the
  1158* actual data.  For each array entry in the business
  1159* logic output, set the symbol list from the array
  1160* entry and insert into the document using the PEMBOD
  1161* template.
  1162***********************************************************
  1163*    move bl-output-message to out-msg-text.
  1164     evaluate true
  1165        when iff-comp-id = 'DCC'
  1166           IF WS-KIX-MYENV = 'cid1p'
  1167
  1168* exec cics document create
  1169*                doctoken   (w-doctoken)
  1170*                template   ('PEMHDR')
  1171*                symbollist (WS-PROD-DCC-PEMHDR)
  1172*                resp       (WS-RESPONSE)
  1173*             end-exec
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  22
* NSREQLTR.cbl
  1174     MOVE LENGTH OF
  1175      WS-PROD-DCC-PEMHDR
  1176       TO DFHEIV16
  1177     MOVE 'PEMHDR' TO DFHEIV1
  1178*    MOVE '\"D tSL               )  N#00001120' TO DFHEIV0
  1179     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1180     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1181     MOVE X'204E233030303031313230' TO DFHEIV0(25:11)
  1182     CALL 'kxdfhei1' USING DFHEIV0,
  1183           w-doctoken,
  1184           DFHEIV99,
  1185           DFHEIV1,
  1186           WS-PROD-DCC-PEMHDR,
  1187           DFHEIV16,
  1188           DFHEIV99,
  1189           DFHEIV99,
  1190           DFHEIV99
  1191     MOVE EIBRESP  TO WS-RESPONSE
  1192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1193           ELSE
  1194
  1195* exec cics document create
  1196*                doctoken   (w-doctoken)
  1197*                template   ('PEMHDR')
  1198*                symbollist (WS-TEST-DCC-PEMHDR)
  1199*                resp       (WS-RESPONSE)
  1200*             end-exec
  1201     MOVE LENGTH OF
  1202      WS-TEST-DCC-PEMHDR
  1203       TO DFHEIV16
  1204     MOVE 'PEMHDR' TO DFHEIV1
  1205*    MOVE '\"D tSL               )  N#00001127' TO DFHEIV0
  1206     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1207     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1208     MOVE X'204E233030303031313237' TO DFHEIV0(25:11)
  1209     CALL 'kxdfhei1' USING DFHEIV0,
  1210           w-doctoken,
  1211           DFHEIV99,
  1212           DFHEIV1,
  1213           WS-TEST-DCC-PEMHDR,
  1214           DFHEIV16,
  1215           DFHEIV99,
  1216           DFHEIV99,
  1217           DFHEIV99
  1218     MOVE EIBRESP  TO WS-RESPONSE
  1219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1220           END-IF
  1221        when IFF-COMP-ID = 'AHL'
  1222           IF WS-KIX-MYENV = 'cid1p'
  1223
  1224* exec cics document create
  1225*                doctoken   (w-doctoken)
  1226*                template   ('PEMHDR')
  1227*                symbollist (WS-PROD-AHL-PEMHDR)
  1228*                resp       (WS-RESPONSE)
  1229*             end-exec
  1230     MOVE LENGTH OF
  1231      WS-PROD-AHL-PEMHDR
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  23
* NSREQLTR.cbl
  1232       TO DFHEIV16
  1233     MOVE 'PEMHDR' TO DFHEIV1
  1234*    MOVE '\"D tSL               )  N#00001136' TO DFHEIV0
  1235     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1236     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1237     MOVE X'204E233030303031313336' TO DFHEIV0(25:11)
  1238     CALL 'kxdfhei1' USING DFHEIV0,
  1239           w-doctoken,
  1240           DFHEIV99,
  1241           DFHEIV1,
  1242           WS-PROD-AHL-PEMHDR,
  1243           DFHEIV16,
  1244           DFHEIV99,
  1245           DFHEIV99,
  1246           DFHEIV99
  1247     MOVE EIBRESP  TO WS-RESPONSE
  1248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1249           ELSE
  1250
  1251* exec cics document create
  1252*                doctoken   (w-doctoken)
  1253*                template   ('PEMHDR')
  1254*                symbollist (WS-TEST-AHL-PEMHDR)
  1255*                resp       (WS-RESPONSE)
  1256*             end-exec
  1257     MOVE LENGTH OF
  1258      WS-TEST-AHL-PEMHDR
  1259       TO DFHEIV16
  1260     MOVE 'PEMHDR' TO DFHEIV1
  1261*    MOVE '\"D tSL               )  N#00001143' TO DFHEIV0
  1262     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1263     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1264     MOVE X'204E233030303031313433' TO DFHEIV0(25:11)
  1265     CALL 'kxdfhei1' USING DFHEIV0,
  1266           w-doctoken,
  1267           DFHEIV99,
  1268           DFHEIV1,
  1269           WS-TEST-AHL-PEMHDR,
  1270           DFHEIV16,
  1271           DFHEIV99,
  1272           DFHEIV99,
  1273           DFHEIV99
  1274     MOVE EIBRESP  TO WS-RESPONSE
  1275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1276           END-IF
  1277        when IFF-COMP-ID = 'VPP'
  1278           IF WS-KIX-MYENV = 'cid1p'
  1279
  1280* exec cics document create
  1281*                doctoken   (w-doctoken)
  1282*                template   ('PEMHDR')
  1283*                symbollist (WS-PROD-VPP-PEMHDR)
  1284*                resp       (WS-RESPONSE)
  1285*             end-exec
  1286     MOVE LENGTH OF
  1287      WS-PROD-VPP-PEMHDR
  1288       TO DFHEIV16
  1289     MOVE 'PEMHDR' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  24
* NSREQLTR.cbl
  1290*    MOVE '\"D tSL               )  N#00001152' TO DFHEIV0
  1291     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1292     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1293     MOVE X'204E233030303031313532' TO DFHEIV0(25:11)
  1294     CALL 'kxdfhei1' USING DFHEIV0,
  1295           w-doctoken,
  1296           DFHEIV99,
  1297           DFHEIV1,
  1298           WS-PROD-VPP-PEMHDR,
  1299           DFHEIV16,
  1300           DFHEIV99,
  1301           DFHEIV99,
  1302           DFHEIV99
  1303     MOVE EIBRESP  TO WS-RESPONSE
  1304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1305           ELSE
  1306
  1307* exec cics document create
  1308*                doctoken   (w-doctoken)
  1309*                template   ('PEMHDR')
  1310*                symbollist (WS-TEST-VPP-PEMHDR)
  1311*                resp       (WS-RESPONSE)
  1312*             end-exec
  1313     MOVE LENGTH OF
  1314      WS-TEST-VPP-PEMHDR
  1315       TO DFHEIV16
  1316     MOVE 'PEMHDR' TO DFHEIV1
  1317*    MOVE '\"D tSL               )  N#00001159' TO DFHEIV0
  1318     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1319     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1320     MOVE X'204E233030303031313539' TO DFHEIV0(25:11)
  1321     CALL 'kxdfhei1' USING DFHEIV0,
  1322           w-doctoken,
  1323           DFHEIV99,
  1324           DFHEIV1,
  1325           WS-TEST-VPP-PEMHDR,
  1326           DFHEIV16,
  1327           DFHEIV99,
  1328           DFHEIV99,
  1329           DFHEIV99
  1330     MOVE EIBRESP  TO WS-RESPONSE
  1331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1332           END-IF
  1333        when IFF-COMP-ID = 'FNL'
  1334           IF WS-KIX-MYENV = 'cid1p'
  1335
  1336* exec cics document create
  1337*                doctoken   (w-doctoken)
  1338*                template   ('PEMHDR')
  1339*                symbollist (WS-PROD-FNL-PEMHDR)
  1340*                resp       (WS-RESPONSE)
  1341*             end-exec
  1342     MOVE LENGTH OF
  1343      WS-PROD-FNL-PEMHDR
  1344       TO DFHEIV16
  1345     MOVE 'PEMHDR' TO DFHEIV1
  1346*    MOVE '\"D tSL               )  N#00001168' TO DFHEIV0
  1347     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  25
* NSREQLTR.cbl
  1348     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1349     MOVE X'204E233030303031313638' TO DFHEIV0(25:11)
  1350     CALL 'kxdfhei1' USING DFHEIV0,
  1351           w-doctoken,
  1352           DFHEIV99,
  1353           DFHEIV1,
  1354           WS-PROD-FNL-PEMHDR,
  1355           DFHEIV16,
  1356           DFHEIV99,
  1357           DFHEIV99,
  1358           DFHEIV99
  1359     MOVE EIBRESP  TO WS-RESPONSE
  1360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1361           ELSE
  1362
  1363* exec cics document create
  1364*                doctoken   (w-doctoken)
  1365*                template   ('PEMHDR')
  1366*                symbollist (WS-TEST-FNL-PEMHDR)
  1367*                resp       (WS-RESPONSE)
  1368*             end-exec
  1369     MOVE LENGTH OF
  1370      WS-TEST-FNL-PEMHDR
  1371       TO DFHEIV16
  1372     MOVE 'PEMHDR' TO DFHEIV1
  1373*    MOVE '\"D tSL               )  N#00001175' TO DFHEIV0
  1374     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1375     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1376     MOVE X'204E233030303031313735' TO DFHEIV0(25:11)
  1377     CALL 'kxdfhei1' USING DFHEIV0,
  1378           w-doctoken,
  1379           DFHEIV99,
  1380           DFHEIV1,
  1381           WS-TEST-FNL-PEMHDR,
  1382           DFHEIV16,
  1383           DFHEIV99,
  1384           DFHEIV99,
  1385           DFHEIV99
  1386     MOVE EIBRESP  TO WS-RESPONSE
  1387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1388           END-IF
  1389        when other
  1390           IF WS-KIX-MYENV = 'cid1p'
  1391
  1392* exec cics document create
  1393*                doctoken   (w-doctoken)
  1394*                template   ('PEMHDR')
  1395*                symbollist (WS-PROD-CID-PEMHDR)
  1396*                resp       (WS-RESPONSE)
  1397*             end-exec
  1398     MOVE LENGTH OF
  1399      WS-PROD-CID-PEMHDR
  1400       TO DFHEIV16
  1401     MOVE 'PEMHDR' TO DFHEIV1
  1402*    MOVE '\"D tSL               )  N#00001184' TO DFHEIV0
  1403     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1404     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1405     MOVE X'204E233030303031313834' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  26
* NSREQLTR.cbl
  1406     CALL 'kxdfhei1' USING DFHEIV0,
  1407           w-doctoken,
  1408           DFHEIV99,
  1409           DFHEIV1,
  1410           WS-PROD-CID-PEMHDR,
  1411           DFHEIV16,
  1412           DFHEIV99,
  1413           DFHEIV99,
  1414           DFHEIV99
  1415     MOVE EIBRESP  TO WS-RESPONSE
  1416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1417           ELSE
  1418
  1419* exec cics document create
  1420*                doctoken   (w-doctoken)
  1421*                template   ('PEMHDR')
  1422*                symbollist (WS-TEST-CID-PEMHDR)
  1423*                resp       (WS-RESPONSE)
  1424*             end-exec
  1425     MOVE LENGTH OF
  1426      WS-TEST-CID-PEMHDR
  1427       TO DFHEIV16
  1428     MOVE 'PEMHDR' TO DFHEIV1
  1429*    MOVE '\"D tSL               )  N#00001191' TO DFHEIV0
  1430     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1431     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1432     MOVE X'204E233030303031313931' TO DFHEIV0(25:11)
  1433     CALL 'kxdfhei1' USING DFHEIV0,
  1434           w-doctoken,
  1435           DFHEIV99,
  1436           DFHEIV1,
  1437           WS-TEST-CID-PEMHDR,
  1438           DFHEIV16,
  1439           DFHEIV99,
  1440           DFHEIV99,
  1441           DFHEIV99
  1442     MOVE EIBRESP  TO WS-RESPONSE
  1443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1444           END-IF
  1445     end-evaluate
  1446*    DISPLAY ' PEMHDR DOC CREATE ' WS-RESPONSE
  1447*    move 1 to bl-index.
  1448*
  1449*    perform bl-output-record-count times
  1450*
  1451*        move bl-output-account-number(bl-index)
  1452*          to out-account-number
  1453*        move bl-output-last-name(bl-index)
  1454*          to out-last-name
  1455*        move bl-output-first-name(bl-index)
  1456*          to out-first-name
  1457*        move bl-output-middle-initial(bl-index)
  1458*          to out-middle-initial
  1459*
  1460*    MOVE 'CICM'                 TO OUT-TEMP
  1461*    MOVE 'CICM'                 TO OUT-LETTER
  1462*    MOVE '9'                    TO OUT-CARR
  1463*    MOVE 'MCDANIEL'             TO OUT-ILNAME
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  27
* NSREQLTR.cbl
  1464*    MOVE 'KATHI'                TO OUT-IFNAME
  1465*    MOVE '0151216'              TO OUT-CLMNO
  1466*    MOVE '0009235906 '          TO OUT-CRTNO
  1467*    MOVE '0990000208'           TO OUT-ACTNO
  1468
  1469* exec cics document set
  1470*       doctoken(w-doctoken)
  1471*       symbollist(NAPER-OUTPUT-DATA)
  1472*       length(length of NAPER-OUTPUT-DATA)
  1473*                   resp   (WS-RESPONSE)
  1474*    end-exec
  1475     MOVE LENGTH OF
  1476      NAPER-OUTPUT-DATA TO DFHEIV16
  1477*    MOVE '\(Ds L                ''  N#00001221' TO DFHEIV0
  1478     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1479     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1480     MOVE X'204E233030303031323231' TO DFHEIV0(25:11)
  1481     CALL 'kxdfhei1' USING DFHEIV0,
  1482           w-doctoken,
  1483           NAPER-OUTPUT-DATA,
  1484           DFHEIV99,
  1485           DFHEIV16,
  1486           DFHEIV99,
  1487           DFHEIV99
  1488     MOVE EIBRESP  TO WS-RESPONSE
  1489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1490
  1491* exec cics document insert
  1492*       doctoken(w-doctoken)
  1493*       template('PEMBOD')
  1494*                   resp   (WS-RESPONSE)
  1495*    end-exec
  1496     MOVE 'PEMBOD' TO DFHEIV1
  1497*    MOVE '\$Dt                  (  N#00001227' TO DFHEIV0
  1498     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
  1499     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1500     MOVE X'204E233030303031323237' TO DFHEIV0(25:11)
  1501     CALL 'kxdfhei1' USING DFHEIV0,
  1502           w-doctoken,
  1503           DFHEIV1,
  1504           DFHEIV99,
  1505           DFHEIV99,
  1506           DFHEIV99,
  1507           DFHEIV99,
  1508           DFHEIV99
  1509     MOVE EIBRESP  TO WS-RESPONSE
  1510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1511     INSPECT OT-REGARDING REPLACING ALL '&' BY ' '
  1512     if ws-kix-myenv = 'cid1p' or 'mdoff'
  1513        compute ws-sl-var-length =
  1514           (ws-sl-var-length + v2) - +1
  1515
  1516* exec cics document set
  1517*          doctoken(w-doctoken)
  1518*          symbollist(WS-VAR-SLUNIKIX)
  1519*          length(ws-sl-var-length)
  1520*                      resp   (WS-RESPONSE)
  1521*       end-exec
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  28
* NSREQLTR.cbl
  1522*    MOVE '\(Ds L                ''  N#00001236' TO DFHEIV0
  1523     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1524     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1525     MOVE X'204E233030303031323336' TO DFHEIV0(25:11)
  1526     CALL 'kxdfhei1' USING DFHEIV0,
  1527           w-doctoken,
  1528           WS-VAR-SLUNIKIX,
  1529           DFHEIV99,
  1530           ws-sl-var-length,
  1531           DFHEIV99,
  1532           DFHEIV99
  1533     MOVE EIBRESP  TO WS-RESPONSE
  1534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1535     else
  1536        compute ws-lt-var-length =
  1537           (ws-lt-var-length + v2) - +1
  1538
  1539* exec cics document set
  1540*          doctoken(w-doctoken)
  1541*          symbollist(WS-VAR-LOGICTEST)
  1542*          length(ws-lt-var-length)
  1543*                      resp   (WS-RESPONSE)
  1544*       end-exec
  1545*    MOVE '\(Ds L                ''  N#00001245' TO DFHEIV0
  1546     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1547     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1548     MOVE X'204E233030303031323435' TO DFHEIV0(25:11)
  1549     CALL 'kxdfhei1' USING DFHEIV0,
  1550           w-doctoken,
  1551           WS-VAR-LOGICTEST,
  1552           DFHEIV99,
  1553           ws-lt-var-length,
  1554           DFHEIV99,
  1555           DFHEIV99
  1556     MOVE EIBRESP  TO WS-RESPONSE
  1557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1558     end-if
  1559
  1560* exec cics document insert
  1561*       doctoken(w-doctoken)
  1562*       template('PEMFTR')
  1563*                   resp   (WS-RESPONSE)
  1564*    end-exec
  1565     MOVE 'PEMFTR' TO DFHEIV1
  1566*    MOVE '\$Dt                  (  N#00001252' TO DFHEIV0
  1567     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
  1568     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1569     MOVE X'204E233030303031323532' TO DFHEIV0(25:11)
  1570     CALL 'kxdfhei1' USING DFHEIV0,
  1571           w-doctoken,
  1572           DFHEIV1,
  1573           DFHEIV99,
  1574           DFHEIV99,
  1575           DFHEIV99,
  1576           DFHEIV99,
  1577           DFHEIV99
  1578     MOVE EIBRESP  TO WS-RESPONSE
  1579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  29
* NSREQLTR.cbl
  1580****************************************
  1581* Send the document and return.
  1582****************************************
  1583
  1584* exec cics web send
  1585*       doctoken(w-doctoken)
  1586*                   resp   (WS-RESPONSE)
  1587*    end-exec.
  1588*    MOVE 'X$D                   *  N#00001260' TO DFHEIV0
  1589     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  1590     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  1591     MOVE X'204E233030303031323630' TO DFHEIV0(25:11)
  1592     CALL 'kxdfhei1' USING DFHEIV0,
  1593           w-doctoken,
  1594           DFHEIV99,
  1595           DFHEIV99,
  1596           DFHEIV99,
  1597           DFHEIV99,
  1598           DFHEIV99,
  1599           DFHEIV99,
  1600           DFHEIV99,
  1601           DFHEIV99
  1602     MOVE EIBRESP  TO WS-RESPONSE
  1603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1604
  1605*    DISPLAY ' WEB SEND  ' WS-RESPONSE
  1606*    DISPLAY ' ABOUT TO RETURN '
  1607
  1608* exec cics
  1609*       return
  1610*    end-exec.
  1611*    MOVE '.(                    ''   #00001266' TO DFHEIV0
  1612     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1613     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1614     MOVE X'2020233030303031323636' TO DFHEIV0(25:11)
  1615     CALL 'kxdfhei1' USING DFHEIV0,
  1616           DFHEIV99,
  1617           DFHEIV99,
  1618           DFHEIV99,
  1619           DFHEIV99,
  1620           DFHEIV99,
  1621           DFHEIV99
  1622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1623
  1624******************************************************
  1625* Read all fields of the incoming form, moving
  1626* each to the corresponding field of the commarea
  1627* (business logic input fields).
  1628******************************************************
  1629 read-form.
  1630     move spaces to w-form-name.
  1631     move length of w-form-name to w-form-name-len.
  1632           move spaces to w-form-value.
  1633     move length of w-form-value to w-form-value-len.
  1634
  1635* exec cics web readnext
  1636*                  formfield(w-form-name)
  1637*                  namelength(w-form-name-len)
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  30
* NSREQLTR.cbl
  1638*                  value(w-form-value)
  1639*                  valuelength(w-form-value-len)
  1640*                  resp(w-resp)
  1641*    end-exec.
  1642*    MOVE 'X*FLVL                &  N#00001279' TO DFHEIV0
  1643     MOVE X'582A464C564C202020202020' TO DFHEIV0(1:12)
  1644     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1645     MOVE X'204E233030303031323739' TO DFHEIV0(25:11)
  1646     CALL 'kxdfhei1' USING DFHEIV0,
  1647           w-form-name,
  1648           w-form-name-len,
  1649           w-form-value,
  1650           w-form-value-len,
  1651           DFHEIV99
  1652     MOVE EIBRESP  TO w-resp
  1653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1654
  1655     evaluate w-resp
  1656        when 0
  1657*   dfhresp(normal)
  1658           evaluate w-form-name(1:w-form-name-len)
  1659              when 'carrier'
  1660                 if w-form-value-len not = 0
  1661                    move w-form-value(1:w-form-value-len)
  1662                                                   to IFF-CARRIER
  1663                                                      BL-CARRIER
  1664                 else
  1665                                move spaces to IFF-CARRIER
  1666                 end-if
  1667              when 'claim_no'
  1668                             if w-form-value-len not = 0
  1669                    move w-form-value(1:w-form-value-len)
  1670                                                   to IFF-CLAIM-NO
  1671                                                      BL-CLAIM-NO
  1672                 else
  1673                                move spaces  to IFF-CLAIM-NO
  1674                 end-if
  1675              when 'cert_no'
  1676                             if w-form-value-len not = 0
  1677                    move w-form-value(1:w-form-value-len)
  1678                                 to IFF-CERT-NO
  1679                                    BL-CERT-NO
  1680                 else
  1681                                move spaces  to IFF-CERT-NO
  1682                 end-if
  1683              when 'letter_id'
  1684                             if w-form-value-len not = 0
  1685                    move w-form-value(1:w-form-value-len)
  1686                                 to IFF-LETTER-ID
  1687                                    BL-LETTER-ID
  1688                 else
  1689                    move spaces  to IFF-LETTER-ID
  1690                 end-if
  1691              when 'fu_date'
  1692                             if w-form-value-len not = 0
  1693                    move w-form-value(1:w-form-value-len)
  1694                                 to IFF-FOLLOW-UP-DT
  1695                                    BL-FOLLOW-UP-DT
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  31
* NSREQLTR.cbl
  1696                 else
  1697                                move spaces  to IFF-FOLLOW-UP-DT
  1698                 end-if
  1699              when 'rs_date'
  1700                             if w-form-value-len not = 0
  1701                    move w-form-value(1:w-form-value-len)
  1702                                 to IFF-RESEND-DT
  1703                                    BL-RESEND-DT
  1704                 else
  1705                                move spaces  to IFF-RESEND-DT
  1706                 end-if
  1707              when 'no_copies'
  1708                             if w-form-value-len not = 0
  1709                    move w-form-value(1:w-form-value-len)
  1710                                 to IFF-NO-OF-COPIES
  1711                                    BL-NO-OF-COPIES
  1712                 else
  1713                    move zeros   to IFF-NO-OF-COPIES
  1714                 end-if
  1715              when 'proc_id'
  1716                             if w-form-value-len not = 0
  1717                    move w-form-value(1:w-form-value-len)
  1718                                 to IFF-PROC-ID
  1719                                    BL-PROC-ID
  1720                 else
  1721                    move 'KMSB'  to IFF-PROC-ID
  1722                 end-if
  1723              when 'comp_id'
  1724                             if w-form-value-len not = 0
  1725                    move w-form-value(1:w-form-value-len)
  1726                                 to IFF-COMP-ID
  1727                                    BL-COMP-ID
  1728                 else
  1729                    move 'CID'   to IFF-COMP-ID
  1730                 end-if
  1731              when 'prt_now'
  1732                             if w-form-value-len not = 0
  1733                    move w-form-value(1:w-form-value-len)
  1734                                 to IFF-PRINT-NOW-SW
  1735                                    BL-PRINT-NOW-SW
  1736                 else
  1737                    move 'N'     to IFF-PRINT-NOW-SW
  1738                 end-if
  1739              when 'enc_cd'
  1740                             if w-form-value-len not = 0
  1741                    move w-form-value(1:w-form-value-len)
  1742                                 to IFF-ENC-CD
  1743                                    BL-ENC-CD
  1744                 else
  1745                    move '0'     to IFF-ENC-CD
  1746                 end-if
  1747              when 'regarding'
  1748                             if w-form-value-len not = 0
  1749                    move w-form-value(1:w-form-value-len)
  1750                                 to IFF-REGARDING
  1751                                    BL-REGARDING
  1752                 else
  1753                    move SPACES  to IFF-REGARDING BL-REGARDING
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 08:56 Page  32
* NSREQLTR.cbl
  1754                 end-if
  1755           end-evaluate
  1756        when other
  1757           continue
  1758     end-evaluate.
  1759 read-form-exit.
  1760
  1761 9999-DFHBACK SECTION.
  1762     MOVE '9%                    "   ' TO DFHEIV0
  1763     MOVE 'NSREQLTR' TO DFHEIV1
  1764     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1765     GOBACK.
  1766 9999-DFHEXIT.
  1767     IF DFHEIGDJ EQUAL 0001
  1768         NEXT SENTENCE.
  1769     MOVE '9%                    "   ' TO DFHEIV0
  1770     MOVE 'NSREQLTR' TO DFHEIV1
  1771     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1772     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        9332     Code:        6320
