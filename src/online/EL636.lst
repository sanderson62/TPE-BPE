* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL636.cbl
* Options: int("EL636.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL636.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL636.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL636.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL636 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/13/94 13:34:15.
     7*                            VMOD=2.026
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL636.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS. TRANSACTION - EXJA - COMMISSION CHECK WORK FILE
    26*                              MAINTENANCE.
    27
    28 ENVIRONMENT DIVISION.
    29
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL636.cbl
    31 DATA DIVISION.
    32 WORKING-STORAGE SECTION.
    33 01  DFH-START PIC X(04).
    34
    35 77  FILLER  PIC X(32)  VALUE '********************************'.
    36 77  FILLER  PIC X(32)  VALUE '*    EL636 WORKING STORAGE     *'.
    37 77  FILLER  PIC X(32)  VALUE '************ V/M 2.026 *********'.
    38
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL636.cbl
    40
    41*                            COPY ELCSCTM.
    42******************************************************************
    43*                                                                *
    44*                                                                *
    45*                            ELCSCTM                             *
    46*                            VMOD=2.001                          *
    47*                                                                *
    48*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    49*                                                                *
    50******************************************************************
    51 01  SECURITY-MESSAGE.
    52     12  FILLER                          PIC X(30)
    53            VALUE '** LOGIC SECURITY VIOLATION -'.
    54     12  SM-READ                         PIC X(6).
    55     12  FILLER                          PIC X(5)
    56            VALUE ' PGM='.
    57     12  SM-PGM                          PIC X(6).
    58     12  FILLER                          PIC X(5)
    59            VALUE ' OPR='.
    60     12  SM-PROCESSOR-ID                 PIC X(4).
    61     12  FILLER                          PIC X(6)
    62            VALUE ' TERM='.
    63     12  SM-TERMID                       PIC X(4).
    64     12  FILLER                          PIC XX   VALUE SPACE.
    65     12  SM-JUL-DATE                     PIC 9(5).
    66     12  FILLER                          PIC X    VALUE SPACE.
    67     12  SM-TIME                         PIC 99.99.
    68
    69*                            COPY ELCSCRTY.
    70******************************************************************
    71*                                                                *
    72*                                                                *
    73*                            ELCSCRTY                            *
    74*                            VMOD=2.001                          *
    75*                                                                *
    76*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    77*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    78*        SAVED IN PI-SECURITY-ADDRESS.                           *
    79*                                                                *
    80******************************************************************
    81 01  SECURITY-CONTROL.
    82     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    83     12  FILLER                       PIC XX    VALUE 'SC'.
    84     12  SC-CREDIT-CODES.
    85         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    86             20  SC-CREDIT-DISPLAY    PIC X.
    87             20  SC-CREDIT-UPDATE     PIC X.
    88     12  SC-CLAIMS-CODES.
    89         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    90             20  SC-CLAIMS-DISPLAY    PIC X.
    91             20  SC-CLAIMS-UPDATE     PIC X.
    92
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL636.cbl
    94
    95******************************************************************
    96*                                                                *
    97*              S T A N D A R D   A R E A S                       *
    98*                                                                *
    99******************************************************************
   100
   101 01  STANDARD-AREAS.
   102     12  SC-ITEM                     PIC S9(4)   VALUE +1   COMP.
   103     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   104     12  EL636A                      PIC X(8)    VALUE 'EL636A'.
   105     12  MAPSET-EL636S               PIC X(8)    VALUE 'EL636S'.
   106     12  TRANS-EXJA                  PIC X(4)    VALUE 'EXJA'.
   107     12  THIS-PGM                    PIC X(8)    VALUE 'EL636 '.
   108     12  PGM-NAME                    PIC X(8).
   109     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   110     12  TIME-IN                     PIC S9(7).
   111     12  TIME-OUT-R  REDEFINES TIME-IN.
   112         16  FILLER                  PIC X.
   113         16  TIME-OUT                PIC 99V99.
   114         16  FILLER                  PIC X(2).
   115     12  LINK-EL001                  PIC X(8)    VALUE 'EL001'.
   116     12  LINK-EL004                  PIC X(8)    VALUE 'EL004'.
   117     12  XCTL-EL005                  PIC X(8)    VALUE 'EL005'.
   118     12  XCTL-EL6361                 PIC X(8)    VALUE 'EL6361'.
   119     12  XCTL-EL010                  PIC X(8)    VALUE 'EL010'.
   120     12  XCTL-EL626                  PIC X(8)    VALUE 'EL626'.
   121     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   122     12  FILE-ID-ERCMCK              PIC X(8)    VALUE 'ERCMCK'.
   123     12  FILE-ID-ERCKWK              PIC X(8)    VALUE 'ERCKWK '.
   124     12  FILE-ID-ERCOMP              PIC X(8)    VALUE 'ERCOMP '.
   125     12  CNTL-FILE-ID                PIC X(8)    VALUE 'ELCNTL '.
   126     12  WS-CURRENT-DT               PIC X(8)    VALUE SPACES.
   127     12  WS-CURRENT-BIN-DT           PIC XX      VALUE SPACES.
   128     12  QID.
   129         16  QID-TERM                PIC X(4)    VALUE SPACES.
   130         16  FILLER                  PIC X(4)    VALUE '125D'.
   131     12  WS-TIME                     PIC 9(6)    VALUE ZEROS.
   132     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   133         16  WS-HR-MINS              PIC 99V99.
   134         16  FILLER                  PIC XX.
   135     12  CLIENT-HER                  PIC X(3)    VALUE 'HER'.
   136     12  CLIENT-LGX                  PIC X(3)    VALUE 'LGX'.
   137     12  ERCOMP-SW                   PIC X       VALUE ' '.
   138
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL636.cbl
   140
   141 01  WORK-AREA.
   142     12  DEEDIT-FIELD                PIC X(12).
   143     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD   PIC S9(10)V99.
   144     12  WS-SEQUENCE-NO              PIC S9(4)    VALUE +0 COMP.
   145     12  WS-DETAMT OCCURS 5 TIMES    PIC S9(7)V99.
   146     12  WS-DETAIL-AMOUNT            PIC S9(7)V99 VALUE +0 COMP-3.
   147     12  WS-SPACE-AGENT-SW           PIC X        VALUE SPACE.
   148     12  WS-UPDATE-SW                PIC X        VALUE SPACE.
   149         88  WS-ENTRIES-UPDATED                   VALUE 'Y'.
   150     12  WS-SUB1                     PIC S9(4)    VALUE +0 COMP.
   151     12  WS-SUB2                     PIC S9(4)    VALUE +0 COMP.
   152     12  WS-BROWSE-SW                PIC X        VALUE SPACE.
   153         88  WS-BROWSE-STARTED                    VALUE 'Y'.
   154     12  WS-FIRST-DETAIL-SW          PIC X        VALUE SPACE.
   155         88  FIRST-DETAIL-READ                    VALUE 'Y'.
   156     12  WS-HEADER-INFO.
   157         16  WS-PAYEE-NAME           PIC X(30)    VALUE SPACES.
   158         16  WS-PAYEE-ADDRESS-1      PIC X(30)    VALUE SPACES.
   159         16  WS-PAYEE-ADDRESS-2      PIC X(30)    VALUE SPACES.
   160         16  WS-PAYEE-CITY-ST        PIC X(30)    VALUE SPACES.
   161         16  WS-PAYEE-ZIP-CODE.
   162             20  WS-PAYEE-ZIP        PIC X(5)     VALUE SPACES.
   163             20  WS-PAYEE-ZIP-EXT    PIC X(4)     VALUE SPACES.
   164         16  WS-AMOUNT-PAID          PIC S9(7)V99 VALUE +0 COMP-3.
   165         16  WS-TOTAL-ENTRIES        PIC S9(3)    VALUE +0 COMP-3.
   166     12  WS-SEQ-NINES                PIC S9(4)    VALUE +9999
   167                                                  COMP.
   168     12  WS-PAY-SEQ-NUM              PIC S9(4)    VALUE +0 COMP.
   169     12  WS-NOFIRST                  PIC S9(4)    VALUE +0 COMP.
   170     12  WS-DELETE-SEQ-NO            PIC S9(4)    VALUE +0 COMP.
   171     12  WS-DELETE-AMOUNT            PIC S9(7)V99 VALUE +0 COMP-3.
   172     12  WS-DELETE-COUNT             PIC S9(3)    VALUE +0 COMP-3.
   173     12  WS-HOLD-AMOUNT              PIC S9(7)V99 VALUE +0 COMP-3.
   174     12  WS-HOLD-COUNT               PIC S9(3)    VALUE +0 COMP-3.
   175     12  WS-OFF-HOLD-AMOUNT          PIC S9(7)V99 VALUE +0 COMP-3.
   176     12  WS-OFF-HOLD-COUNT           PIC S9(3)    VALUE +0 COMP-3.
   177     12  WS-SAVE-ACTION-CODE         PIC X        VALUE SPACES.
   178         88 SHOW-FUNCTION            VALUE 'S'.
   179     12  WS-HOLD-MAINT OCCURS 5 TIMES    PIC X.
   180     12  FILLER        PIC X(16) VALUE 'ZZZZZZZZZZZZZZZZ'.
   181     12  HOLD-CSR                 PIC X(04)  VALUE LOW-VALUES.
   182
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL636.cbl
   184
   185******************************************************************
   186*                                                                *
   187*                E R R O R   M E S S A G E S                     *
   188*                                                                *
   189******************************************************************
   190
   191 01  ERROR-MESSAGES.
   192     12  ER-0000                 PIC X(4)  VALUE '0000'.
   193     12  ER-0004                 PIC X(4)  VALUE '0004'.
   194     12  ER-0008                 PIC X(4)  VALUE '0008'.
   195     12  ER-0023                 PIC X(4)  VALUE '0023'.
   196     12  ER-0029                 PIC X(4)  VALUE '0029'.
   197     12  ER-0070                 PIC X(4)  VALUE '0070'.
   198     12  ER-0194                 PIC X(4)  VALUE '0194'.
   199     12  ER-0195                 PIC X(4)  VALUE '0195'.
   200     12  ER-1883                 PIC X(4)  VALUE '1883'.
   201     12  ER-1999                 PIC X(4)  VALUE '1999'.
   202     12  ER-2056                 PIC X(4)  VALUE '2056'.
   203     12  ER-2132                 PIC X(4)  VALUE '2132'.
   204     12  ER-2223                 PIC X(4)  VALUE '2223'.
   205     12  ER-2251                 PIC X(4)  VALUE '2251'.
   206     12  ER-2252                 PIC X(4)  VALUE '2252'.
   207     12  ER-2800                 PIC X(4)  VALUE '2800'.
   208     12  ER-2869                 PIC X(4)  VALUE '2869'.
   209     12  ER-3139                 PIC X(4)  VALUE '3139'.
   210     12  ER-3146                 PIC X(4)  VALUE '3146'.
   211     12  ER-3147                 PIC X(4)  VALUE '3147'.
   212     12  ER-3148                 PIC X(4)  VALUE '3148'.
   213     12  ER-3149                 PIC X(4)  VALUE '3149'.
   214     12  ER-3158                 PIC X(4)  VALUE '3158'.
   215     12  ER-3159                 PIC X(4)  VALUE '3159'.
   216     12  ER-3160                 PIC X(4)  VALUE '3160'.
   217     12  ER-3161                 PIC X(4)  VALUE '3161'.
   218     12  ER-3162                 PIC X(4)  VALUE '3162'.
   219     12  ER-3163                 PIC X(4)  VALUE '3163'.
   220     12  ER-3164                 PIC X(4)  VALUE '3164'.
   221     12  ER-3165                 PIC X(4)  VALUE '3165'.
   222     12  ER-3167                 PIC X(4)  VALUE '3167'.
   223     12  ER-3169                 PIC X(4)  VALUE '3169'.
   224     12  ER-3173                 PIC X(4)  VALUE '3173'.
   225     12  ER-3179                 PIC X(4)  VALUE '3179'.
   226     12  ER-3189                 PIC X(4)  VALUE '3189'.
   227     12  ER-3190                 PIC X(4)  VALUE '3190'.
   228     12  ER-3198                 PIC X(4)  VALUE '3198'.
   229     12  ER-3256                 PIC X(4)  VALUE '3256'.
   230     12  ER-7043                 PIC X(4)  VALUE '7043'.
   231     12  ER-7082                 PIC X(4)  VALUE '7082'.
   232     12  ER-7804                 PIC X(4)  VALUE '7804'.
   233
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL636.cbl
   235
   236******************************************************************
   237*                                                                *
   238*              A C C E S S   K E Y S                             *
   239*                                                                *
   240******************************************************************
   241
   242 01  ACCESS-KEYS.
   243
   244     12  ELCNTL-KEY.
   245          16  CNTL-COMP-ID           PIC X(3)       VALUE SPACES.
   246          16  CNTL-REC-TYPE          PIC X          VALUE SPACES.
   247          16  CNTL-ACCESS            PIC X(4)       VALUE SPACES.
   248          16  CNTL-SEQ-NO            PIC S9(4)     VALUE +0  COMP.
   249     12  ERCMCK-KEY.
   250         16  ERCMCK-COMPANY-CD       PIC X          VALUE SPACES.
   251         16  ERCMCK-CSR              PIC X(4)   VALUE LOW-VALUES.
   252         16  ERCMCK-CARRIER          PIC X          VALUE SPACES.
   253         16  ERCMCK-GROUPING         PIC X(6)       VALUE SPACES.
   254         16  ERCMCK-PAYEE            PIC X(10)      VALUE SPACES.
   255         16  ERCMCK-PAYEE-SEQ        PIC S9(4) COMP VALUE +0.
   256         16  ERCMCK-SEQUENCE-NO      PIC S9(4) COMP VALUE +0.
   257
   258     12  SAVE-ERCMCK-CONTROL.
   259         16  SVCMCK-COMPANY-CD       PIC X          VALUE SPACES.
   260         16  SVCMCK-CSR              PIC X(4)    VALUE LOW-VALUES.
   261         16  SVCMCK-CARRIER          PIC X          VALUE SPACES.
   262         16  SVCMCK-GROUPING         PIC X(6)       VALUE SPACES.
   263         16  SVCMCK-PAYEE            PIC X(10)      VALUE SPACES.
   264         16  SVCMCK-PAYEE-SEQ        PIC S9(4) COMP VALUE +0.
   265         16  SVCMCK-SEQUENCE-NO      PIC S9(4) COMP VALUE +0.
   266
   267     12  ERCKWK-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   268
   269     12  ERCKWK-KEY.
   270         16  ERCKWK-COMPANY-CD       PIC X           VALUE SPACES.
   271         16  ERCKWK-CSR              PIC X(4)   VALUE LOW-VALUES.
   272         16  ERCKWK-CARRIER          PIC X           VALUE SPACES.
   273         16  ERCKWK-GROUPING         PIC X(6)        VALUE SPACES.
   274         16  ERCKWK-PAYEE            PIC X(10)       VALUE SPACES.
   275         16  ERCKWK-PAYEE-SEQ        PIC S9(4)  COMP VALUE +0.
   276         16  ERCKWK-SEQUENCE-NO      PIC S9(4)  COMP VALUE +0.
   277
   278     12  ERCKWK-COMPARE-KEY          PIC X(26)       VALUE SPACE.
   279
   280     12  SAVE-ERCKWK-CONTROL.
   281         16  SVCKWK-COMPANY-CD       PIC X           VALUE SPACES.
   282         16  SVCKWK-CSR              PIC X(4)  VALUE LOW-VALUES.
   283         16  SVCKWK-CARRIER          PIC X           VALUE SPACES.
   284         16  SVCKWK-GROUPING         PIC X(6)        VALUE SPACES.
   285         16  SVCKWK-PAYEE            PIC X(10)       VALUE SPACES.
   286         16  SVCKWK-PAYEE-SEQ        PIC S9(4) COMP  VALUE +0.
   287         16  SVCKWK-SEQUENCE-NO      PIC S9(4) COMP  VALUE +0.
   288
   289     12  SVCKWK-COMPARE-KEY          PIC X(26)       VALUE SPACE.
   290
   291     12  SAVE-ERCKWK-RECORD.
   292         16  FILLER                  PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL636.cbl
   293         16  SAVE-CKWK-SEQ-NO        PIC S9(4) COMP  VALUE +0.
   294         16  FILLER                  PIC X(172).
   295
   296
   297
   298     12  ERCMCK-RECORD-LENGTH        PIC S9(4) COMP VALUE +2000.
   299
   300     12  ERCOMP-KEY.
   301         16  ERCOMP-COMP-CD      PIC X     VALUE SPACE.
   302         16  ERCOMP-CARRIER      PIC X     VALUE SPACES.
   303         16  ERCOMP-GROUPING     PIC X(6)  VALUE SPACES.
   304         16  ERCOMP-FIN-RESP     PIC X(10) VALUE SPACES.
   305         16  ERCOMP-ACCT         PIC X(10) VALUE SPACES.
   306         16  ERCOMP-RECORD-TYPE  PIC X     VALUE SPACES.
   307
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL636.cbl
   309
   310*                            COPY ELCDATE.
   311******************************************************************
   312*                                                                *
   313*                                                                *
   314*                            ELCDATE.                            *
   315*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   316*                            VMOD=2.003
   317*                                                                *
   318*                                                                *
   319*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   320*                 LENGTH = 200                                   *
   321******************************************************************
   322
   323 01  DATE-CONVERSION-DATA.
   324     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   325     12  DC-OPTION-CODE                PIC X.
   326         88  BIN-TO-GREG                VALUE ' '.
   327         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   328         88  EDIT-GREG-TO-BIN           VALUE '2'.
   329         88  YMD-GREG-TO-BIN            VALUE '3'.
   330         88  MDY-GREG-TO-BIN            VALUE '4'.
   331         88  JULIAN-TO-BIN              VALUE '5'.
   332         88  BIN-PLUS-ELAPSED           VALUE '6'.
   333         88  FIND-CENTURY               VALUE '7'.
   334         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   335         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   336         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   337         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   338         88  JULIAN-TO-BIN-3            VALUE 'C'.
   339         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   340         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   341         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   342         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   343         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   344         88  CHECK-LEAP-YEAR            VALUE 'H'.
   345         88  BIN-3-TO-GREG              VALUE 'I'.
   346         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   347         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   348         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   349         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   350         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   351         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   352         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   353         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   354         88  THREE-CHARACTER-BIN
   355                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   356         88  GREGORIAN-TO-BIN
   357                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   358         88  BIN-TO-GREGORIAN
   359                  VALUES ' ' '1' 'I' '8' 'G'.
   360         88  JULIAN-TO-BINARY
   361                  VALUES '5' 'C' 'E' 'F'.
   362     12  DC-ERROR-CODE                 PIC X.
   363         88  NO-CONVERSION-ERROR        VALUE ' '.
   364         88  DATE-CONVERSION-ERROR
   365                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   366         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL636.cbl
   367         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   368         88  DATE-IS-INVALID            VALUE '3'.
   369         88  DATE1-GREATER-DATE2        VALUE '4'.
   370         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   371         88  DATE-INVALID-OPTION        VALUE '9'.
   372         88  INVALID-CENTURY            VALUE 'A'.
   373         88  ONLY-CENTURY               VALUE 'B'.
   374         88  ONLY-LEAP-YEAR             VALUE 'C'.
   375         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   376     12  DC-END-OF-MONTH               PIC X.
   377         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   378     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   379         88  USE-NORMAL-PROCESS         VALUE ' '.
   380         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   381         88  ADJUST-UP-100-YRS          VALUE '2'.
   382     12  FILLER                        PIC X.
   383     12  DC-CONVERSION-DATES.
   384         16  DC-BIN-DATE-1             PIC XX.
   385         16  DC-BIN-DATE-2             PIC XX.
   386         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   387         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   388                       DC-GREG-DATE-1-EDIT.
   389             20  DC-EDIT1-MONTH        PIC 99.
   390             20  SLASH1-1              PIC X.
   391             20  DC-EDIT1-DAY          PIC 99.
   392             20  SLASH1-2              PIC X.
   393             20  DC-EDIT1-YEAR         PIC 99.
   394         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   395         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   396                     DC-GREG-DATE-2-EDIT.
   397             20  DC-EDIT2-MONTH        PIC 99.
   398             20  SLASH2-1              PIC X.
   399             20  DC-EDIT2-DAY          PIC 99.
   400             20  SLASH2-2              PIC X.
   401             20  DC-EDIT2-YEAR         PIC 99.
   402         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   403         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   404                     DC-GREG-DATE-1-YMD.
   405             20  DC-YMD-YEAR           PIC 99.
   406             20  DC-YMD-MONTH          PIC 99.
   407             20  DC-YMD-DAY            PIC 99.
   408         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   409         16  DC-GREG-DATE-1-MDY-R REDEFINES
   410                      DC-GREG-DATE-1-MDY.
   411             20  DC-MDY-MONTH          PIC 99.
   412             20  DC-MDY-DAY            PIC 99.
   413             20  DC-MDY-YEAR           PIC 99.
   414         16  DC-GREG-DATE-1-ALPHA.
   415             20  DC-ALPHA-MONTH        PIC X(10).
   416             20  DC-ALPHA-DAY          PIC 99.
   417             20  FILLER                PIC XX.
   418             20  DC-ALPHA-CENTURY.
   419                 24 DC-ALPHA-CEN-N     PIC 99.
   420             20  DC-ALPHA-YEAR         PIC 99.
   421         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   422         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   423         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   424         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL636.cbl
   425         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   426                                       PIC 9(05).
   427         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   428             20  DC-JULIAN-YEAR        PIC 99.
   429             20  DC-JULIAN-DAYS        PIC 999.
   430         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   431         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   432         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   433     12  DATE-CONVERSION-VARIBLES.
   434         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   435         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   436             20  FILLER                PIC 9(3).
   437             20  HOLD-CEN-1-CCYY.
   438                 24  HOLD-CEN-1-CC     PIC 99.
   439                 24  HOLD-CEN-1-YY     PIC 99.
   440             20  HOLD-CEN-1-MO         PIC 99.
   441             20  HOLD-CEN-1-DA         PIC 99.
   442         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   443             20  HOLD-CEN-1-R-MO       PIC 99.
   444             20  HOLD-CEN-1-R-DA       PIC 99.
   445             20  HOLD-CEN-1-R-CCYY.
   446                 24  HOLD-CEN-1-R-CC   PIC 99.
   447                 24  HOLD-CEN-1-R-YY   PIC 99.
   448             20  FILLER                PIC 9(3).
   449         16  HOLD-CENTURY-1-X.
   450             20  FILLER                PIC X(3)  VALUE SPACES.
   451             20  HOLD-CEN-1-X-CCYY.
   452                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   453                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   454             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   455             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   456         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   457             20  HOLD-CEN-1-R-X-MO     PIC XX.
   458             20  HOLD-CEN-1-R-X-DA     PIC XX.
   459             20  HOLD-CEN-1-R-X-CCYY.
   460                 24  HOLD-CEN-1-R-X-CC PIC XX.
   461                 24  HOLD-CEN-1-R-X-YY PIC XX.
   462             20  FILLER                PIC XXX.
   463         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   464         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   465         16  DC-JULIAN-DATE-1          PIC 9(07).
   466         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   467             20  DC-JULIAN-1-CCYY.
   468                 24  DC-JULIAN-1-CC    PIC 99.
   469                 24  DC-JULIAN-1-YR    PIC 99.
   470             20  DC-JULIAN-DA-1        PIC 999.
   471         16  DC-JULIAN-DATE-2          PIC 9(07).
   472         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   473             20  DC-JULIAN-2-CCYY.
   474                 24  DC-JULIAN-2-CC    PIC 99.
   475                 24  DC-JULIAN-2-YR    PIC 99.
   476             20  DC-JULIAN-DA-2        PIC 999.
   477         16  DC-GREG-DATE-A-EDIT.
   478             20  DC-EDITA-MONTH        PIC 99.
   479             20  SLASHA-1              PIC X VALUE '/'.
   480             20  DC-EDITA-DAY          PIC 99.
   481             20  SLASHA-2              PIC X VALUE '/'.
   482             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL636.cbl
   483                 24  DC-EDITA-CENT     PIC 99.
   484                 24  DC-EDITA-YEAR     PIC 99.
   485         16  DC-GREG-DATE-B-EDIT.
   486             20  DC-EDITB-MONTH        PIC 99.
   487             20  SLASHB-1              PIC X VALUE '/'.
   488             20  DC-EDITB-DAY          PIC 99.
   489             20  SLASHB-2              PIC X VALUE '/'.
   490             20  DC-EDITB-CCYY.
   491                 24  DC-EDITB-CENT     PIC 99.
   492                 24  DC-EDITB-YEAR     PIC 99.
   493         16  DC-GREG-DATE-CYMD         PIC 9(08).
   494         16  DC-GREG-DATE-CYMD-R REDEFINES
   495                              DC-GREG-DATE-CYMD.
   496             20  DC-CYMD-CEN           PIC 99.
   497             20  DC-CYMD-YEAR          PIC 99.
   498             20  DC-CYMD-MONTH         PIC 99.
   499             20  DC-CYMD-DAY           PIC 99.
   500         16  DC-GREG-DATE-MDCY         PIC 9(08).
   501         16  DC-GREG-DATE-MDCY-R REDEFINES
   502                              DC-GREG-DATE-MDCY.
   503             20  DC-MDCY-MONTH         PIC 99.
   504             20  DC-MDCY-DAY           PIC 99.
   505             20  DC-MDCY-CEN           PIC 99.
   506             20  DC-MDCY-YEAR          PIC 99.
   507    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   508        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   509    12  DC-EL310-DATE                  PIC X(21).
   510    12  FILLER                         PIC X(28).
   511
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL636.cbl
   513*                            COPY ELCLOGOF.
   514******************************************************************
   515*                                                                *
   516*                                                                *
   517*                            ELCLOGOF.                           *
   518*                            VMOD=2.001                          *
   519*                                                                *
   520*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   521*                                                                *
   522******************************************************************
   523 01  CLASIC-LOGOFF.
   524     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   525     12  LOGOFF-TEXT.
   526         16  FILLER          PIC X(5)    VALUE SPACES.
   527         16  LOGOFF-MSG.
   528             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   529             20  FILLER      PIC X       VALUE SPACES.
   530             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   531         16  FILLER          PIC X(80)
   532           VALUE '* YOU ARE NOW LOGGED OFF'.
   533         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   534         16  FILLER          PIC X       VALUE QUOTE.
   535         16  LOGOFF-SYS-MSG  PIC X(17)
   536           VALUE 'S CLAS-IC SYSTEM '.
   537     12  TEXT-MESSAGES.
   538         16  UNACCESS-MSG    PIC X(29)
   539             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   540         16  PGMIDERR-MSG    PIC X(17)
   541             VALUE 'PROGRAM NOT FOUND'.
   542
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL636.cbl
   544*                            COPY ELCATTR.
   545******************************************************************
   546*                                                                *
   547*                            ELCATTR.                            *
   548*                            VMOD=2.001                          *
   549*                                                                *
   550*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   551*                                                                *
   552*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   553*                                                                *
   554*                   POS 1   P=PROTECTED                          *
   555*                           U=UNPROTECTED                        *
   556*                           S=ASKIP                              *
   557*                   POS 2   A=ALPHA/NUMERIC                      *
   558*                           N=NUMERIC                            *
   559*                   POS 3   N=NORMAL                             *
   560*                           B=BRIGHT                             *
   561*                           D=DARK                               *
   562*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   563*                           OF=MODIFIED DATA TAG OFF             *
   564*                                                                *
   565*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   566******************************************************************
   567 01  ATTRIBUTE-LIST.
   568     12  AL-PABOF            PIC X       VALUE 'Y'.
   569     12  AL-PABON            PIC X       VALUE 'Z'.
   570     12  AL-PADOF            PIC X       VALUE '%'.
   571     12  AL-PADON            PIC X       VALUE '_'.
   572     12  AL-PANOF            PIC X       VALUE '-'.
   573     12  AL-PANON            PIC X       VALUE '/'.
   574     12  AL-SABOF            PIC X       VALUE '8'.
   575     12  AL-SABON            PIC X       VALUE '9'.
   576     12  AL-SADOF            PIC X       VALUE '@'.
   577     12  AL-SADON            PIC X       VALUE QUOTE.
   578     12  AL-SANOF            PIC X       VALUE '0'.
   579     12  AL-SANON            PIC X       VALUE '1'.
   580     12  AL-UABOF            PIC X       VALUE 'H'.
   581     12  AL-UABON            PIC X       VALUE 'I'.
   582     12  AL-UADOF            PIC X       VALUE '<'.
   583     12  AL-UADON            PIC X       VALUE '('.
   584     12  AL-UANOF            PIC X       VALUE ' '.
   585     12  AL-UANON            PIC X       VALUE 'A'.
   586     12  AL-UNBOF            PIC X       VALUE 'Q'.
   587     12  AL-UNBON            PIC X       VALUE 'R'.
   588     12  AL-UNDOF            PIC X       VALUE '*'.
   589     12  AL-UNDON            PIC X       VALUE ')'.
   590     12  AL-UNNOF            PIC X       VALUE '&'.
   591     12  AL-UNNON            PIC X       VALUE 'J'.
   592
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL636.cbl
   594*                            COPY ELCEMIB.
   595******************************************************************
   596*                                                                *
   597*                                                                *
   598*                            ELCEMIB.                            *
   599*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   600*                            VMOD=2.005                          *
   601*                                                                *
   602*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   603*                                                                *
   604******************************************************************
   605 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   606     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   607     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   608     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   609     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   610     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   611     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   612     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   613     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   614     12  EMI-SWITCH1             PIC X        VALUE '1'.
   615         88  EMI-NO-ERRORS                    VALUE '1'.
   616         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   617         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   618     12  EMI-SWITCH2             PIC X        VALUE '1'.
   619         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   620     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   621         88  EMI-AREA1-EMPTY                  VALUE '1'.
   622         88  EMI-AREA1-FULL                   VALUE '2'.
   623     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   624         88  EMI-AREA2-EMPTY                  VALUE '1'.
   625         88  EMI-AREA2-FULL                   VALUE '2'.
   626     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   627         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   628         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   629         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   630         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   631         88  EMI-BYPASS-FATALS                VALUE 'X'.
   632     12  EMI-ERROR-LINES.
   633         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   634         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   635         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   636         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   637             20  EMI-ERR-CODES OCCURS 10 TIMES.
   638                 24  EMI-ERR-NUM         PIC X(4).
   639                 24  EMI-FILLER          PIC X.
   640                 24  EMI-SEV             PIC X.
   641                 24  FILLER              PIC X.
   642             20  FILLER                  PIC X(02).
   643     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   644         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   645             20  EMI-ERROR-NUMBER    PIC X(4).
   646             20  EMI-FILL            PIC X.
   647             20  EMI-SEVERITY        PIC X.
   648             20  FILLER              PIC X.
   649             20  EMI-ERROR-TEXT.
   650                 24  EMI-TEXT-VARIABLE   PIC X(10).
   651                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL636.cbl
   652     12  EMI-SEVERITY-SAVE           PIC X.
   653         88  EMI-NOTE                    VALUE 'N'.
   654         88  EMI-WARNING                 VALUE 'W'.
   655         88  EMI-FORCABLE                VALUE 'F'.
   656         88  EMI-FATAL                   VALUE 'X'.
   657     12  EMI-MESSAGE-FLAG            PIC X.
   658         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   659         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   660     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   661     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   662         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   663         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   664         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   665     12  FILLER                      PIC X(137)  VALUE SPACES.
   666     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   667     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   668     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   669     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   670
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL636.cbl
   672*                            COPY ELCINTF.
   673******************************************************************
   674*                                                                *
   675*                                                                *
   676*                            ELCINTF.                            *
   677*                            VMOD=2.017                          *
   678*                                                                *
   679*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   680*                                                                *
   681*       LENGTH = 1024                                            *
   682*                                                                *
   683******************************************************************
   684 01  PROGRAM-INTERFACE-BLOCK.
   685     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   686     12  PI-CALLING-PROGRAM              PIC X(8).
   687     12  PI-SAVED-PROGRAM-1              PIC X(8).
   688     12  PI-SAVED-PROGRAM-2              PIC X(8).
   689     12  PI-SAVED-PROGRAM-3              PIC X(8).
   690     12  PI-SAVED-PROGRAM-4              PIC X(8).
   691     12  PI-SAVED-PROGRAM-5              PIC X(8).
   692     12  PI-SAVED-PROGRAM-6              PIC X(8).
   693     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   694     12  PI-COMPANY-ID                   PIC XXX.
   695     12  PI-COMPANY-CD                   PIC X.
   696
   697     12  PI-COMPANY-PASSWORD             PIC X(8).
   698
   699     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   700
   701     12  PI-CONTROL-IN-PROGRESS.
   702         16  PI-CARRIER                  PIC X.
   703         16  PI-GROUPING                 PIC X(6).
   704         16  PI-STATE                    PIC XX.
   705         16  PI-ACCOUNT                  PIC X(10).
   706         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   707                                         PIC X(10).
   708         16  PI-CLAIM-CERT-GRP.
   709             20  PI-CLAIM-NO             PIC X(7).
   710             20  PI-CERT-NO.
   711                 25  PI-CERT-PRIME       PIC X(10).
   712                 25  PI-CERT-SFX         PIC X.
   713             20  PI-CERT-EFF-DT          PIC XX.
   714         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   715             20  PI-PLAN-CODE            PIC X(2).
   716             20  PI-REVISION-NUMBER      PIC X(3).
   717             20  PI-PLAN-EFF-DT          PIC X(2).
   718             20  PI-PLAN-EXP-DT          PIC X(2).
   719             20  FILLER                  PIC X(11).
   720         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   721             20  PI-OE-REFERENCE-1.
   722                 25  PI-OE-REF-1-PRIME   PIC X(18).
   723                 25  PI-OE-REF-1-SUFF    PIC XX.
   724
   725     12  PI-SESSION-IN-PROGRESS          PIC X.
   726         88  CLAIM-SESSION                   VALUE '1'.
   727         88  CREDIT-SESSION                  VALUE '2'.
   728         88  WARRANTY-SESSION                VALUE '3'.
   729         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL636.cbl
   730         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   731
   732
   733*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   734
   735     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   736     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   737
   738     12  PI-CREDIT-USER                  PIC X.
   739         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   740         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   741
   742     12  PI-CLAIM-USER                   PIC X.
   743         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   744         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   745
   746     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   747         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   748         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   749         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   750         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   751         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   752
   753     12  PI-PROCESSOR-ID                 PIC X(4).
   754
   755     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   756
   757     12  PI-MEMBER-CAPTION               PIC X(10).
   758
   759     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   760         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   761
   762     12  PI-LIFE-OVERRIDE-L1             PIC X.
   763     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   764     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   765     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   766
   767     12  PI-AH-OVERRIDE-L1               PIC X.
   768     12  PI-AH-OVERRIDE-L2               PIC XX.
   769     12  PI-AH-OVERRIDE-L6               PIC X(6).
   770     12  PI-AH-OVERRIDE-L12              PIC X(12).
   771
   772     12  PI-NEW-SYSTEM                   PIC X(2).
   773
   774     12  PI-PRIMARY-CERT-NO              PIC X(11).
   775     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   776         88  PI-USES-PAID-TO                 VALUE '1'.
   777     12  PI-CRDTCRD-SYSTEM.
   778         16  PI-CRDTCRD-USER             PIC X.
   779             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   780             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   781         16  PI-CC-MONTH-END-DT          PIC XX.
   782     12  PI-PROCESSOR-PRINTER            PIC X(4).
   783
   784     12  PI-OE-REFERENCE-2.
   785         16  PI-OE-REF-2-PRIME           PIC X(10).
   786         16  PI-OE-REF-2-SUFF            PIC X.
   787
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL636.cbl
   788     12  PI-REM-TRM-CALC-OPTION          PIC X.
   789
   790     12  PI-LANGUAGE-TYPE                PIC X.
   791             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   792             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   793             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   794
   795     12  PI-POLICY-LINKAGE-IND           PIC X.
   796         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   797         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   798                                                   LOW-VALUES.
   799
   800     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   801     12  PI-CLAIM-PW-SESSION             PIC X(1).
   802         88  PI-CLAIM-CREDIT                 VALUE '1'.
   803         88  PI-CLAIM-CONVEN                 VALUE '2'.
   804     12  FILLER                          PIC X(4).
   805
   806     12  PI-SYSTEM-LEVEL                 PIC X(145).
   807
   808     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   809         PI-SYSTEM-LEVEL.
   810
   811         16  PI-ENTRY-CODES.
   812             20  PI-ENTRY-CD-1           PIC X.
   813             20  PI-ENTRY-CD-2           PIC X.
   814
   815         16  PI-RETURN-CODES.
   816             20  PI-RETURN-CD-1          PIC X.
   817             20  PI-RETURN-CD-2          PIC X.
   818
   819         16  PI-UPDATE-STATUS-SAVE.
   820             20  PI-UPDATE-BY            PIC X(4).
   821             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   822
   823         16  PI-LOWER-CASE-LETTERS       PIC X.
   824             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   825
   826*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   827*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   828*            88  CARRIER-CLM-CNTL            VALUE '2'.
   829
   830         16  PI-CERT-ACCESS-CONTROL      PIC X.
   831             88  ST-ACCNT-CNTL               VALUE ' '.
   832             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   833             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   834             88  ACCNT-CNTL                  VALUE '3'.
   835             88  CARR-ACCNT-CNTL             VALUE '4'.
   836
   837         16  PI-PROCESSOR-CAP-LIST.
   838             20  PI-SYSTEM-CONTROLS.
   839                24 PI-SYSTEM-DISPLAY     PIC X.
   840                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   841                24 PI-SYSTEM-MODIFY      PIC X.
   842                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   843             20  FILLER                  PIC XX.
   844             20  PI-DISPLAY-CAP          PIC X.
   845                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL636.cbl
   846             20  PI-MODIFY-CAP           PIC X.
   847                 88  MODIFY-CAP              VALUE 'Y'.
   848             20  PI-MSG-AT-LOGON-CAP     PIC X.
   849                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   850             20  PI-FORCE-CAP            PIC X.
   851                 88  FORCE-CAP               VALUE 'Y'.
   852
   853         16  PI-PROGRAM-CONTROLS.
   854             20  PI-PGM-PRINT-OPT        PIC X.
   855             20  PI-PGM-FORMAT-OPT       PIC X.
   856             20  PI-PGM-PROCESS-OPT      PIC X.
   857             20  PI-PGM-TOTALS-OPT       PIC X.
   858
   859         16  PI-HELP-INTERFACE.
   860             20  PI-LAST-ERROR-NO        PIC X(4).
   861             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   862
   863         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   864             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   865
   866         16  PI-CR-CONTROL-IN-PROGRESS.
   867             20  PI-CR-CARRIER           PIC X.
   868             20  PI-CR-GROUPING          PIC X(6).
   869             20  PI-CR-STATE             PIC XX.
   870             20  PI-CR-ACCOUNT           PIC X(10).
   871             20  PI-CR-FIN-RESP          PIC X(10).
   872             20  PI-CR-TYPE              PIC X.
   873
   874         16  PI-CR-BATCH-NUMBER          PIC X(6).
   875
   876         16  PI-CR-MONTH-END-DT          PIC XX.
   877
   878         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   879             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   880             88  PI-ZERO-CARRIER             VALUE '1'.
   881             88  PI-ZERO-GROUPING            VALUE '2'.
   882             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   883
   884         16  PI-CARRIER-SECURITY         PIC X.
   885             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   886
   887         16  PI-ACCOUNT-SECURITY         PIC X(10).
   888             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   889             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   890
   891         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   892             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   893                                         INDEXED BY PI-ACCESS-NDX
   894                                         PIC X.
   895
   896         16  PI-GA-BILLING-CONTROL       PIC X.
   897             88  PI-GA-BILLING               VALUE '1'.
   898
   899         16  PI-MAIL-PROCESSING          PIC X.
   900             88  PI-MAIL-YES                 VALUE 'Y'.
   901
   902         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   903
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL636.cbl
   904         16  PI-AR-SYSTEM.
   905             20  PI-AR-PROCESSING-CNTL   PIC X.
   906                 88  PI-AR-PROCESSING        VALUE 'Y'.
   907             20  PI-AR-SUMMARY-CODE      PIC X(6).
   908             20  PI-AR-MONTH-END-DT      PIC XX.
   909
   910         16  PI-MP-SYSTEM.
   911             20  PI-MORTGAGE-USER            PIC X.
   912                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   913                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   914             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   915                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   916                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   917                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   918                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   919                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   920             20  PI-MP-MONTH-END-DT          PIC XX.
   921             20  PI-MP-REFERENCE-NO.
   922                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   923                 24  PI-MP-REFERENCE-SFX     PIC XX.
   924
   925         16  PI-LABEL-CONTROL            PIC X(01).
   926             88  PI-CREATE-LABELS                    VALUE 'Y'.
   927             88  PI-BYPASS-LABELS                    VALUE 'N'.
   928
   929         16  PI-BILL-GROUPING-CODE       PIC X(01).
   930             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   931
   932         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   933             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   934             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   935
   936         16  FILLER                      PIC X(14).
   937
   938     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   939******************************************************************
   940     12  FILLER  REDEFINES PI-PROGRAM-WORK-AREA.
   941         16  PI-MAINT-FUNCTION       PIC X.
   942             88  PI-ADD-FUNCTION         VALUE 'A'.
   943             88  PI-CHG-FUNCTION         VALUE 'C'.
   944             88  PI-DEL-FUNCTION         VALUE 'D'.
   945             88  PI-SHOW-FUNCTION        VALUE 'S'.
   946         16  PI-ERCKWK-KEY.
   947             20  PI-ERCKWK-COMP-CD   PIC X.
   948             20  PI-ERCKWK-CSR       PIC X(4).
   949             20  PI-ERCKWK-CARRIER   PIC X.
   950             20  PI-ERCKWK-GROUPING  PIC X(6).
   951             20  PI-ERCKWK-PAYEE     PIC X(10).
   952             20  PI-ERCKWK-PAYEE-SEQ PIC S9(4)   COMP.
   953             20  PI-ERCKWK-SEQ-NO    PIC S9(4)   COMP.
   954         16  PI-SAVE-ERCKWK-KEY.
   955             20  PI-SVCKWK-COMP-CD   PIC X.
   956             20  PI-SVCKWK-CSR       PIC X(4).
   957             20  PI-SVCKWK-CARRIER   PIC X.
   958             20  PI-SVCKWK-GROUPING  PIC X(6).
   959             20  PI-SVCKWK-PAYEE     PIC X(10).
   960             20  PI-SVCKWK-PAYEE-SEQ PIC S9(4)   COMP.
   961             20  PI-SVCKWK-SEQ-NO    PIC S9(4)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL636.cbl
   962         16  PI-STUB-KEY OCCURS 5    PIC X(26).
   963         16  PI-STUB-ACCT OCCURS 5   PIC X(10).
   964         16  PI-NO-ENTRIES-DISPLAYED PIC S9.
   965         16  PI-PREV-FUNCTION        PIC X.
   966         16  PI-LAST-STUB-KEY.
   967             20  PI-LAST.
   968                 22  FILLER          PIC X.
   969                 22  PI-LAST-STUB-CSR   PIC  X(4).
   970                 22  FILLER          PIC X(19).
   971             20  PI-LAST-STUB-SEQ-NO PIC S9(4)   COMP.
   972         16  FILLER                  PIC X(379).
   973
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL636.cbl
   975*                            COPY ELCJPFX.
   976******************************************************************
   977*                                                                *
   978*                                                                *
   979*                            ELCJPFX.                            *
   980*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   981*                            VMOD=2.002                          *
   982*                                                                *
   983*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   984*                                                                *
   985*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   986*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   987*        ELCNTL - CONTROL FILE                                   *
   988*        ELMSTR - CLAIM MASTERS                                  *
   989*        ELTRLR - ACTIVITY TRAILERS                              *
   990*        ELCHKQ - CHECK QUE                                      *
   991******************************************************************
   992 01  JOURNAL-RECORD.
   993     12  JP-USER-ID                  PIC X(4).
   994     12  JP-FILE-ID                  PIC X(8).
   995     12  JP-PROGRAM-ID               PIC X(8).
   996     12  JP-RECORD-TYPE              PIC X.
   997         88 JP-ADD              VALUE 'A'.
   998         88 JP-BEFORE-CHANGE    VALUE 'B'.
   999         88 JP-AFTER-CHANGE     VALUE 'C'.
  1000         88 JP-DELETE           VALUE 'D'.
  1001         88 JP-GENERIC-DELETE   VALUE 'G'.
  1002         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1003         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1004     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1005     12  JP-RECORD-AREA
  1006
  1007
  1008                             PIC X(1583).
  1009
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL636.cbl
  1011*                            COPY ELCAID.
  1012******************************************************************
  1013*                                                                *
  1014*                            ELCAID.                             *
  1015*                            VMOD=2.001                          *
  1016*                                                                *
  1017*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1018*                                                                *
  1019*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1020*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1021******************************************************************
  1022
  1023 01  DFHAID.
  1024   02  DFHNULL   PIC  X  VALUE  ' '.
  1025   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1026   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1027   02  DFHPEN    PIC  X  VALUE  '='.
  1028   02  DFHOPID   PIC  X  VALUE  'W'.
  1029   02  DFHPA1    PIC  X  VALUE  '%'.
  1030   02  DFHPA2    PIC  X  VALUE  '>'.
  1031   02  DFHPA3    PIC  X  VALUE  ','.
  1032   02  DFHPF1    PIC  X  VALUE  '1'.
  1033   02  DFHPF2    PIC  X  VALUE  '2'.
  1034   02  DFHPF3    PIC  X  VALUE  '3'.
  1035   02  DFHPF4    PIC  X  VALUE  '4'.
  1036   02  DFHPF5    PIC  X  VALUE  '5'.
  1037   02  DFHPF6    PIC  X  VALUE  '6'.
  1038   02  DFHPF7    PIC  X  VALUE  '7'.
  1039   02  DFHPF8    PIC  X  VALUE  '8'.
  1040   02  DFHPF9    PIC  X  VALUE  '9'.
  1041   02  DFHPF10   PIC  X  VALUE  ':'.
  1042   02  DFHPF11   PIC  X  VALUE  '#'.
  1043   02  DFHPF12   PIC  X  VALUE  '@'.
  1044   02  DFHPF13   PIC  X  VALUE  'A'.
  1045   02  DFHPF14   PIC  X  VALUE  'B'.
  1046   02  DFHPF15   PIC  X  VALUE  'C'.
  1047   02  DFHPF16   PIC  X  VALUE  'D'.
  1048   02  DFHPF17   PIC  X  VALUE  'E'.
  1049   02  DFHPF18   PIC  X  VALUE  'F'.
  1050   02  DFHPF19   PIC  X  VALUE  'G'.
  1051   02  DFHPF20   PIC  X  VALUE  'H'.
  1052   02  DFHPF21   PIC  X  VALUE  'I'.
  1053*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1054   02  DFHPF22   PIC  X  VALUE  '['.
  1055   02  DFHPF23   PIC  X  VALUE  '.'.
  1056   02  DFHPF24   PIC  X  VALUE  '<'.
  1057   02  DFHMSRE   PIC  X  VALUE  'X'.
  1058   02  DFHSTRF   PIC  X  VALUE  'h'.
  1059   02  DFHTRIG   PIC  X  VALUE  '"'.
  1060 01  FILLER    REDEFINES DFHAID.
  1061     12  FILLER              PIC X(8).
  1062     12  PF-VALUES           PIC X       OCCURS 24.
  1063
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL636.cbl
  1065*                            COPY EL636S.
  1066 01  EL636AI.
  1067     05  FILLER            PIC  X(0012).
  1068*    -------------------------------
  1069     05  DATEL PIC S9(0004) COMP.
  1070     05  DATEF PIC  X(0001).
  1071     05  FILLER REDEFINES DATEF.
  1072         10  DATEA PIC  X(0001).
  1073     05  DATEI PIC  X(0008).
  1074*    -------------------------------
  1075     05  TIMEL PIC S9(0004) COMP.
  1076     05  TIMEF PIC  X(0001).
  1077     05  FILLER REDEFINES TIMEF.
  1078         10  TIMEA PIC  X(0001).
  1079     05  TIMEI PIC  X(0005).
  1080*    -------------------------------
  1081     05  MAINTL PIC S9(0004) COMP.
  1082     05  MAINTF PIC  X(0001).
  1083     05  FILLER REDEFINES MAINTF.
  1084         10  MAINTA PIC  X(0001).
  1085     05  MAINTI PIC  X(0001).
  1086*    -------------------------------
  1087     05  SHOWL PIC S9(0004) COMP.
  1088     05  SHOWF PIC  X(0001).
  1089     05  FILLER REDEFINES SHOWF.
  1090         10  SHOWA PIC  X(0001).
  1091     05  SHOWI PIC  X(0021).
  1092*    -------------------------------
  1093     05  DELL PIC S9(0004) COMP.
  1094     05  DELF PIC  X(0001).
  1095     05  FILLER REDEFINES DELF.
  1096         10  DELA PIC  X(0001).
  1097     05  DELI PIC  X(0028).
  1098*    -------------------------------
  1099     05  CSRL PIC S9(0004) COMP.
  1100     05  CSRF PIC  X(0001).
  1101     05  FILLER REDEFINES CSRF.
  1102         10  CSRA PIC  X(0001).
  1103     05  CSRI PIC  X(0004).
  1104*    -------------------------------
  1105     05  CARL PIC S9(0004) COMP.
  1106     05  CARF PIC  X(0001).
  1107     05  FILLER REDEFINES CARF.
  1108         10  CARA PIC  X(0001).
  1109     05  CARI PIC  X(0001).
  1110*    -------------------------------
  1111     05  GROUPL PIC S9(0004) COMP.
  1112     05  GROUPF PIC  X(0001).
  1113     05  FILLER REDEFINES GROUPF.
  1114         10  GROUPA PIC  X(0001).
  1115     05  GROUPI PIC  X(0006).
  1116*    -------------------------------
  1117     05  PAYEEL PIC S9(0004) COMP.
  1118     05  PAYEEF PIC  X(0001).
  1119     05  FILLER REDEFINES PAYEEF.
  1120         10  PAYEEA PIC  X(0001).
  1121     05  PAYEEI PIC  X(0010).
  1122*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL636.cbl
  1123     05  PAYSEQL PIC S9(0004) COMP.
  1124     05  PAYSEQF PIC  X(0001).
  1125     05  FILLER REDEFINES PAYSEQF.
  1126         10  PAYSEQA PIC  X(0001).
  1127     05  PAYSEQI PIC  X(0004).
  1128*    -------------------------------
  1129     05  PAYTOL PIC S9(0004) COMP.
  1130     05  PAYTOF PIC  X(0001).
  1131     05  FILLER REDEFINES PAYTOF.
  1132         10  PAYTOA PIC  X(0001).
  1133     05  PAYTOI PIC  X(0030).
  1134*    -------------------------------
  1135     05  MAINTBYL PIC S9(0004) COMP.
  1136     05  MAINTBYF PIC  X(0001).
  1137     05  FILLER REDEFINES MAINTBYF.
  1138         10  MAINTBYA PIC  X(0001).
  1139     05  MAINTBYI PIC  X(0008).
  1140*    -------------------------------
  1141     05  ADDRS1L PIC S9(0004) COMP.
  1142     05  ADDRS1F PIC  X(0001).
  1143     05  FILLER REDEFINES ADDRS1F.
  1144         10  ADDRS1A PIC  X(0001).
  1145     05  ADDRS1I PIC  X(0030).
  1146*    -------------------------------
  1147     05  MAINTONL PIC S9(0004) COMP.
  1148     05  MAINTONF PIC  X(0001).
  1149     05  FILLER REDEFINES MAINTONF.
  1150         10  MAINTONA PIC  X(0001).
  1151     05  MAINTONI PIC  X(0008).
  1152*    -------------------------------
  1153     05  ADDRS2L PIC S9(0004) COMP.
  1154     05  ADDRS2F PIC  X(0001).
  1155     05  FILLER REDEFINES ADDRS2F.
  1156         10  ADDRS2A PIC  X(0001).
  1157     05  ADDRS2I PIC  X(0030).
  1158*    -------------------------------
  1159     05  MAINTATL PIC S9(0004) COMP.
  1160     05  MAINTATF PIC  X(0001).
  1161     05  FILLER REDEFINES MAINTATF.
  1162         10  MAINTATA PIC  X(0001).
  1163     05  MAINTATI PIC  X(0005).
  1164*    -------------------------------
  1165     05  CITYSTL PIC S9(0004) COMP.
  1166     05  CITYSTF PIC  X(0001).
  1167     05  FILLER REDEFINES CITYSTF.
  1168         10  CITYSTA PIC  X(0001).
  1169     05  CITYSTI PIC  X(0030).
  1170*    -------------------------------
  1171     05  ZIPL PIC S9(0004) COMP.
  1172     05  ZIPF PIC  X(0001).
  1173     05  FILLER REDEFINES ZIPF.
  1174         10  ZIPA PIC  X(0001).
  1175     05  ZIPI PIC  X(0005).
  1176*    -------------------------------
  1177     05  ZIPEXTL PIC S9(0004) COMP.
  1178     05  ZIPEXTF PIC  X(0001).
  1179     05  FILLER REDEFINES ZIPEXTF.
  1180         10  ZIPEXTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL636.cbl
  1181     05  ZIPEXTI PIC  X(0004).
  1182*    -------------------------------
  1183     05  RELDTL PIC S9(0004) COMP.
  1184     05  RELDTF PIC  X(0001).
  1185     05  FILLER REDEFINES RELDTF.
  1186         10  RELDTA PIC  X(0001).
  1187     05  RELDTI PIC  X(0008).
  1188*    -------------------------------
  1189     05  CHKAMTL PIC S9(0004) COMP.
  1190     05  CHKAMTF PIC  X(0001).
  1191     05  FILLER REDEFINES CHKAMTF.
  1192         10  CHKAMTA PIC  X(0001).
  1193     05  CHKAMTI PIC  X(0013).
  1194*    -------------------------------
  1195     05  NOFIRSTL PIC S9(0004) COMP.
  1196     05  NOFIRSTF PIC  X(0001).
  1197     05  FILLER REDEFINES NOFIRSTF.
  1198         10  NOFIRSTA PIC  X(0001).
  1199     05  NOFIRSTI PIC  X(0004).
  1200*    -------------------------------
  1201     05  NOLASTL PIC S9(0004) COMP.
  1202     05  NOLASTF PIC  X(0001).
  1203     05  FILLER REDEFINES NOLASTF.
  1204         10  NOLASTA PIC  X(0001).
  1205     05  NOLASTI PIC  X(0004).
  1206*    -------------------------------
  1207     05  NOENTRSL PIC S9(0004) COMP.
  1208     05  NOENTRSF PIC  X(0001).
  1209     05  FILLER REDEFINES NOENTRSF.
  1210         10  NOENTRSA PIC  X(0001).
  1211     05  NOENTRSI PIC  X(0004).
  1212*    -------------------------------
  1213     05  M1L PIC S9(0004) COMP.
  1214     05  M1F PIC  X(0001).
  1215     05  FILLER REDEFINES M1F.
  1216         10  M1A PIC  X(0001).
  1217     05  M1I PIC  X(0001).
  1218*    -------------------------------
  1219     05  COMNTS1L PIC S9(0004) COMP.
  1220     05  COMNTS1F PIC  X(0001).
  1221     05  FILLER REDEFINES COMNTS1F.
  1222         10  COMNTS1A PIC  X(0001).
  1223     05  COMNTS1I PIC  X(0021).
  1224*    -------------------------------
  1225     05  AGENT1L PIC S9(0004) COMP.
  1226     05  AGENT1F PIC  X(0001).
  1227     05  FILLER REDEFINES AGENT1F.
  1228         10  AGENT1A PIC  X(0001).
  1229     05  AGENT1I PIC  X(0010).
  1230*    -------------------------------
  1231     05  INVREF1L PIC S9(0004) COMP.
  1232     05  INVREF1F PIC  X(0001).
  1233     05  FILLER REDEFINES INVREF1F.
  1234         10  INVREF1A PIC  X(0001).
  1235     05  INVREF1I PIC  X(0012).
  1236*    -------------------------------
  1237     05  LEDGER1L PIC S9(0004) COMP.
  1238     05  LEDGER1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL636.cbl
  1239     05  FILLER REDEFINES LEDGER1F.
  1240         10  LEDGER1A PIC  X(0001).
  1241     05  LEDGER1I PIC  X(0014).
  1242*    -------------------------------
  1243     05  AGOCD1L PIC S9(0004) COMP.
  1244     05  AGOCD1F PIC  X(0001).
  1245     05  FILLER REDEFINES AGOCD1F.
  1246         10  AGOCD1A PIC  X(0001).
  1247     05  AGOCD1I PIC  X(0001).
  1248*    -------------------------------
  1249     05  DETAMT1L PIC S9(0004) COMP.
  1250     05  DETAMT1F PIC  X(0001).
  1251     05  FILLER REDEFINES DETAMT1F.
  1252         10  DETAMT1A PIC  X(0001).
  1253     05  DETAMT1I PIC  X(0012).
  1254*    -------------------------------
  1255     05  M2L PIC S9(0004) COMP.
  1256     05  M2F PIC  X(0001).
  1257     05  FILLER REDEFINES M2F.
  1258         10  M2A PIC  X(0001).
  1259     05  M2I PIC  X(0001).
  1260*    -------------------------------
  1261     05  COMNTS2L PIC S9(0004) COMP.
  1262     05  COMNTS2F PIC  X(0001).
  1263     05  FILLER REDEFINES COMNTS2F.
  1264         10  COMNTS2A PIC  X(0001).
  1265     05  COMNTS2I PIC  X(0021).
  1266*    -------------------------------
  1267     05  AGENT2L PIC S9(0004) COMP.
  1268     05  AGENT2F PIC  X(0001).
  1269     05  FILLER REDEFINES AGENT2F.
  1270         10  AGENT2A PIC  X(0001).
  1271     05  AGENT2I PIC  X(0010).
  1272*    -------------------------------
  1273     05  INVREF2L PIC S9(0004) COMP.
  1274     05  INVREF2F PIC  X(0001).
  1275     05  FILLER REDEFINES INVREF2F.
  1276         10  INVREF2A PIC  X(0001).
  1277     05  INVREF2I PIC  X(0012).
  1278*    -------------------------------
  1279     05  LEDGER2L PIC S9(0004) COMP.
  1280     05  LEDGER2F PIC  X(0001).
  1281     05  FILLER REDEFINES LEDGER2F.
  1282         10  LEDGER2A PIC  X(0001).
  1283     05  LEDGER2I PIC  X(0014).
  1284*    -------------------------------
  1285     05  AGOCD2L PIC S9(0004) COMP.
  1286     05  AGOCD2F PIC  X(0001).
  1287     05  FILLER REDEFINES AGOCD2F.
  1288         10  AGOCD2A PIC  X(0001).
  1289     05  AGOCD2I PIC  X(0001).
  1290*    -------------------------------
  1291     05  DETAMT2L PIC S9(0004) COMP.
  1292     05  DETAMT2F PIC  X(0001).
  1293     05  FILLER REDEFINES DETAMT2F.
  1294         10  DETAMT2A PIC  X(0001).
  1295     05  DETAMT2I PIC  X(0012).
  1296*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL636.cbl
  1297     05  M3L PIC S9(0004) COMP.
  1298     05  M3F PIC  X(0001).
  1299     05  FILLER REDEFINES M3F.
  1300         10  M3A PIC  X(0001).
  1301     05  M3I PIC  X(0001).
  1302*    -------------------------------
  1303     05  COMNTS3L PIC S9(0004) COMP.
  1304     05  COMNTS3F PIC  X(0001).
  1305     05  FILLER REDEFINES COMNTS3F.
  1306         10  COMNTS3A PIC  X(0001).
  1307     05  COMNTS3I PIC  X(0021).
  1308*    -------------------------------
  1309     05  AGENT3L PIC S9(0004) COMP.
  1310     05  AGENT3F PIC  X(0001).
  1311     05  FILLER REDEFINES AGENT3F.
  1312         10  AGENT3A PIC  X(0001).
  1313     05  AGENT3I PIC  X(0010).
  1314*    -------------------------------
  1315     05  INVREF3L PIC S9(0004) COMP.
  1316     05  INVREF3F PIC  X(0001).
  1317     05  FILLER REDEFINES INVREF3F.
  1318         10  INVREF3A PIC  X(0001).
  1319     05  INVREF3I PIC  X(0012).
  1320*    -------------------------------
  1321     05  LEDGER3L PIC S9(0004) COMP.
  1322     05  LEDGER3F PIC  X(0001).
  1323     05  FILLER REDEFINES LEDGER3F.
  1324         10  LEDGER3A PIC  X(0001).
  1325     05  LEDGER3I PIC  X(0014).
  1326*    -------------------------------
  1327     05  AGOCD3L PIC S9(0004) COMP.
  1328     05  AGOCD3F PIC  X(0001).
  1329     05  FILLER REDEFINES AGOCD3F.
  1330         10  AGOCD3A PIC  X(0001).
  1331     05  AGOCD3I PIC  X(0001).
  1332*    -------------------------------
  1333     05  DETAMT3L PIC S9(0004) COMP.
  1334     05  DETAMT3F PIC  X(0001).
  1335     05  FILLER REDEFINES DETAMT3F.
  1336         10  DETAMT3A PIC  X(0001).
  1337     05  DETAMT3I PIC  X(0012).
  1338*    -------------------------------
  1339     05  M4L PIC S9(0004) COMP.
  1340     05  M4F PIC  X(0001).
  1341     05  FILLER REDEFINES M4F.
  1342         10  M4A PIC  X(0001).
  1343     05  M4I PIC  X(0001).
  1344*    -------------------------------
  1345     05  COMNTS4L PIC S9(0004) COMP.
  1346     05  COMNTS4F PIC  X(0001).
  1347     05  FILLER REDEFINES COMNTS4F.
  1348         10  COMNTS4A PIC  X(0001).
  1349     05  COMNTS4I PIC  X(0021).
  1350*    -------------------------------
  1351     05  AGENT4L PIC S9(0004) COMP.
  1352     05  AGENT4F PIC  X(0001).
  1353     05  FILLER REDEFINES AGENT4F.
  1354         10  AGENT4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL636.cbl
  1355     05  AGENT4I PIC  X(0010).
  1356*    -------------------------------
  1357     05  INVREF4L PIC S9(0004) COMP.
  1358     05  INVREF4F PIC  X(0001).
  1359     05  FILLER REDEFINES INVREF4F.
  1360         10  INVREF4A PIC  X(0001).
  1361     05  INVREF4I PIC  X(0012).
  1362*    -------------------------------
  1363     05  LEDGER4L PIC S9(0004) COMP.
  1364     05  LEDGER4F PIC  X(0001).
  1365     05  FILLER REDEFINES LEDGER4F.
  1366         10  LEDGER4A PIC  X(0001).
  1367     05  LEDGER4I PIC  X(0014).
  1368*    -------------------------------
  1369     05  AGOCD4L PIC S9(0004) COMP.
  1370     05  AGOCD4F PIC  X(0001).
  1371     05  FILLER REDEFINES AGOCD4F.
  1372         10  AGOCD4A PIC  X(0001).
  1373     05  AGOCD4I PIC  X(0001).
  1374*    -------------------------------
  1375     05  DETAMT4L PIC S9(0004) COMP.
  1376     05  DETAMT4F PIC  X(0001).
  1377     05  FILLER REDEFINES DETAMT4F.
  1378         10  DETAMT4A PIC  X(0001).
  1379     05  DETAMT4I PIC  X(0012).
  1380*    -------------------------------
  1381     05  M5L PIC S9(0004) COMP.
  1382     05  M5F PIC  X(0001).
  1383     05  FILLER REDEFINES M5F.
  1384         10  M5A PIC  X(0001).
  1385     05  M5I PIC  X(0001).
  1386*    -------------------------------
  1387     05  COMNTS5L PIC S9(0004) COMP.
  1388     05  COMNTS5F PIC  X(0001).
  1389     05  FILLER REDEFINES COMNTS5F.
  1390         10  COMNTS5A PIC  X(0001).
  1391     05  COMNTS5I PIC  X(0021).
  1392*    -------------------------------
  1393     05  AGENT5L PIC S9(0004) COMP.
  1394     05  AGENT5F PIC  X(0001).
  1395     05  FILLER REDEFINES AGENT5F.
  1396         10  AGENT5A PIC  X(0001).
  1397     05  AGENT5I PIC  X(0010).
  1398*    -------------------------------
  1399     05  INVREF5L PIC S9(0004) COMP.
  1400     05  INVREF5F PIC  X(0001).
  1401     05  FILLER REDEFINES INVREF5F.
  1402         10  INVREF5A PIC  X(0001).
  1403     05  INVREF5I PIC  X(0012).
  1404*    -------------------------------
  1405     05  LEDGER5L PIC S9(0004) COMP.
  1406     05  LEDGER5F PIC  X(0001).
  1407     05  FILLER REDEFINES LEDGER5F.
  1408         10  LEDGER5A PIC  X(0001).
  1409     05  LEDGER5I PIC  X(0014).
  1410*    -------------------------------
  1411     05  AGOCD5L PIC S9(0004) COMP.
  1412     05  AGOCD5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL636.cbl
  1413     05  FILLER REDEFINES AGOCD5F.
  1414         10  AGOCD5A PIC  X(0001).
  1415     05  AGOCD5I PIC  X(0001).
  1416*    -------------------------------
  1417     05  DETAMT5L PIC S9(0004) COMP.
  1418     05  DETAMT5F PIC  X(0001).
  1419     05  FILLER REDEFINES DETAMT5F.
  1420         10  DETAMT5A PIC  X(0001).
  1421     05  DETAMT5I PIC  X(0012).
  1422*    -------------------------------
  1423     05  ERMESG1L PIC S9(0004) COMP.
  1424     05  ERMESG1F PIC  X(0001).
  1425     05  FILLER REDEFINES ERMESG1F.
  1426         10  ERMESG1A PIC  X(0001).
  1427     05  ERMESG1I PIC  X(0079).
  1428*    -------------------------------
  1429     05  ERMESG2L PIC S9(0004) COMP.
  1430     05  ERMESG2F PIC  X(0001).
  1431     05  FILLER REDEFINES ERMESG2F.
  1432         10  ERMESG2A PIC  X(0001).
  1433     05  ERMESG2I PIC  X(0079).
  1434*    -------------------------------
  1435     05  PFENTERL PIC S9(0004) COMP.
  1436     05  PFENTERF PIC  X(0001).
  1437     05  FILLER REDEFINES PFENTERF.
  1438         10  PFENTERA PIC  X(0001).
  1439     05  PFENTERI PIC  9(2).
  1440*    -------------------------------
  1441     05  PFKEY8L PIC S9(0004) COMP.
  1442     05  PFKEY8F PIC  X(0001).
  1443     05  FILLER REDEFINES PFKEY8F.
  1444         10  PFKEY8A PIC  X(0001).
  1445     05  PFKEY8I PIC  X(0014).
  1446 01  EL636AO REDEFINES EL636AI.
  1447     05  FILLER            PIC  X(0012).
  1448*    -------------------------------
  1449     05  FILLER            PIC  X(0003).
  1450     05  DATEO PIC  X(0008).
  1451*    -------------------------------
  1452     05  FILLER            PIC  X(0003).
  1453     05  TIMEO PIC  99.99.
  1454*    -------------------------------
  1455     05  FILLER            PIC  X(0003).
  1456     05  MAINTO PIC  X(0001).
  1457*    -------------------------------
  1458     05  FILLER            PIC  X(0003).
  1459     05  SHOWO PIC  X(0021).
  1460*    -------------------------------
  1461     05  FILLER            PIC  X(0003).
  1462     05  DELO PIC  X(0028).
  1463*    -------------------------------
  1464     05  FILLER            PIC  X(0003).
  1465     05  CSRO PIC  X(0004).
  1466*    -------------------------------
  1467     05  FILLER            PIC  X(0003).
  1468     05  CARO PIC  X(0001).
  1469*    -------------------------------
  1470     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL636.cbl
  1471     05  GROUPO PIC  X(0006).
  1472*    -------------------------------
  1473     05  FILLER            PIC  X(0003).
  1474     05  PAYEEO PIC  X(0010).
  1475*    -------------------------------
  1476     05  FILLER            PIC  X(0003).
  1477     05  PAYSEQO PIC  X(0004).
  1478*    -------------------------------
  1479     05  FILLER            PIC  X(0003).
  1480     05  PAYTOO PIC  X(0030).
  1481*    -------------------------------
  1482     05  FILLER            PIC  X(0003).
  1483     05  MAINTBYO PIC  X(0008).
  1484*    -------------------------------
  1485     05  FILLER            PIC  X(0003).
  1486     05  ADDRS1O PIC  X(0030).
  1487*    -------------------------------
  1488     05  FILLER            PIC  X(0003).
  1489     05  MAINTONO PIC  X(0008).
  1490*    -------------------------------
  1491     05  FILLER            PIC  X(0003).
  1492     05  ADDRS2O PIC  X(0030).
  1493*    -------------------------------
  1494     05  FILLER            PIC  X(0003).
  1495     05  MAINTATO PIC  99.99.
  1496*    -------------------------------
  1497     05  FILLER            PIC  X(0003).
  1498     05  CITYSTO PIC  X(0030).
  1499*    -------------------------------
  1500     05  FILLER            PIC  X(0003).
  1501     05  ZIPO PIC  X(0005).
  1502*    -------------------------------
  1503     05  FILLER            PIC  X(0003).
  1504     05  ZIPEXTO PIC  X(0004).
  1505*    -------------------------------
  1506     05  FILLER            PIC  X(0003).
  1507     05  RELDTO PIC  X(0008).
  1508*    -------------------------------
  1509     05  FILLER            PIC  X(0003).
  1510     05  CHKAMTO PIC  Z,ZZZ,ZZZ.99-.
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
  1513     05  NOFIRSTO PIC  ZZZ9.
  1514*    -------------------------------
  1515     05  FILLER            PIC  X(0003).
  1516     05  NOLASTO PIC  ZZZ9.
  1517*    -------------------------------
  1518     05  FILLER            PIC  X(0003).
  1519     05  NOENTRSO PIC  ZZZ9.
  1520*    -------------------------------
  1521     05  FILLER            PIC  X(0003).
  1522     05  M1O PIC  X(0001).
  1523*    -------------------------------
  1524     05  FILLER            PIC  X(0003).
  1525     05  COMNTS1O PIC  X(0021).
  1526*    -------------------------------
  1527     05  FILLER            PIC  X(0003).
  1528     05  AGENT1O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL636.cbl
  1529*    -------------------------------
  1530     05  FILLER            PIC  X(0003).
  1531     05  INVREF1O PIC  X(0012).
  1532*    -------------------------------
  1533     05  FILLER            PIC  X(0003).
  1534     05  LEDGER1O PIC  X(0014).
  1535*    -------------------------------
  1536     05  FILLER            PIC  X(0003).
  1537     05  AGOCD1O PIC  X(0001).
  1538*    -------------------------------
  1539     05  FILLER            PIC  X(0003).
  1540     05  DETAMT1O PIC  X(0012).
  1541*    -------------------------------
  1542     05  FILLER            PIC  X(0003).
  1543     05  M2O PIC  X(0001).
  1544*    -------------------------------
  1545     05  FILLER            PIC  X(0003).
  1546     05  COMNTS2O PIC  X(0021).
  1547*    -------------------------------
  1548     05  FILLER            PIC  X(0003).
  1549     05  AGENT2O PIC  X(0010).
  1550*    -------------------------------
  1551     05  FILLER            PIC  X(0003).
  1552     05  INVREF2O PIC  X(0012).
  1553*    -------------------------------
  1554     05  FILLER            PIC  X(0003).
  1555     05  LEDGER2O PIC  X(0014).
  1556*    -------------------------------
  1557     05  FILLER            PIC  X(0003).
  1558     05  AGOCD2O PIC  X(0001).
  1559*    -------------------------------
  1560     05  FILLER            PIC  X(0003).
  1561     05  DETAMT2O PIC  X(0012).
  1562*    -------------------------------
  1563     05  FILLER            PIC  X(0003).
  1564     05  M3O PIC  X(0001).
  1565*    -------------------------------
  1566     05  FILLER            PIC  X(0003).
  1567     05  COMNTS3O PIC  X(0021).
  1568*    -------------------------------
  1569     05  FILLER            PIC  X(0003).
  1570     05  AGENT3O PIC  X(0010).
  1571*    -------------------------------
  1572     05  FILLER            PIC  X(0003).
  1573     05  INVREF3O PIC  X(0012).
  1574*    -------------------------------
  1575     05  FILLER            PIC  X(0003).
  1576     05  LEDGER3O PIC  X(0014).
  1577*    -------------------------------
  1578     05  FILLER            PIC  X(0003).
  1579     05  AGOCD3O PIC  X(0001).
  1580*    -------------------------------
  1581     05  FILLER            PIC  X(0003).
  1582     05  DETAMT3O PIC  X(0012).
  1583*    -------------------------------
  1584     05  FILLER            PIC  X(0003).
  1585     05  M4O PIC  X(0001).
  1586*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL636.cbl
  1587     05  FILLER            PIC  X(0003).
  1588     05  COMNTS4O PIC  X(0021).
  1589*    -------------------------------
  1590     05  FILLER            PIC  X(0003).
  1591     05  AGENT4O PIC  X(0010).
  1592*    -------------------------------
  1593     05  FILLER            PIC  X(0003).
  1594     05  INVREF4O PIC  X(0012).
  1595*    -------------------------------
  1596     05  FILLER            PIC  X(0003).
  1597     05  LEDGER4O PIC  X(0014).
  1598*    -------------------------------
  1599     05  FILLER            PIC  X(0003).
  1600     05  AGOCD4O PIC  X(0001).
  1601*    -------------------------------
  1602     05  FILLER            PIC  X(0003).
  1603     05  DETAMT4O PIC  X(0012).
  1604*    -------------------------------
  1605     05  FILLER            PIC  X(0003).
  1606     05  M5O PIC  X(0001).
  1607*    -------------------------------
  1608     05  FILLER            PIC  X(0003).
  1609     05  COMNTS5O PIC  X(0021).
  1610*    -------------------------------
  1611     05  FILLER            PIC  X(0003).
  1612     05  AGENT5O PIC  X(0010).
  1613*    -------------------------------
  1614     05  FILLER            PIC  X(0003).
  1615     05  INVREF5O PIC  X(0012).
  1616*    -------------------------------
  1617     05  FILLER            PIC  X(0003).
  1618     05  LEDGER5O PIC  X(0014).
  1619*    -------------------------------
  1620     05  FILLER            PIC  X(0003).
  1621     05  AGOCD5O PIC  X(0001).
  1622*    -------------------------------
  1623     05  FILLER            PIC  X(0003).
  1624     05  DETAMT5O PIC  X(0012).
  1625*    -------------------------------
  1626     05  FILLER            PIC  X(0003).
  1627     05  ERMESG1O PIC  X(0079).
  1628*    -------------------------------
  1629     05  FILLER            PIC  X(0003).
  1630     05  ERMESG2O PIC  X(0079).
  1631*    -------------------------------
  1632     05  FILLER            PIC  X(0003).
  1633     05  PFENTERO PIC  X(0002).
  1634*    -------------------------------
  1635     05  FILLER            PIC  X(0003).
  1636     05  PFKEY8O PIC  X(0014).
  1637*    -------------------------------
  1638
  1639 01  DISPLAY-MAP REDEFINES EL636AI.
  1640     12  FILLER                  PIC X(355).
  1641     12  CK-STUB-INFO OCCURS 5 TIMES.
  1642         16  CK-MAINT-LEN        PIC S9(4)   COMP.
  1643         16  CK-MAINT-ATTRB      PIC X.
  1644         16  CK-MAINT            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL636.cbl
  1645         16  CK-COMNTS-LEN       PIC S9(4)   COMP.
  1646         16  CK-COMNTS-ATTRB     PIC X.
  1647         16  CK-COMNTS           PIC X(21).
  1648         16  CK-AGENT-LEN        PIC S9(4)   COMP.
  1649         16  CK-AGENT-ATTRB      PIC X.
  1650         16  CK-AGENT            PIC X(10).
  1651         16  CK-INVREF-LEN       PIC S9(4)   COMP.
  1652         16  CK-INVREF-ATTRB     PIC X.
  1653         16  CK-INVREF           PIC X(12).
  1654         16  CK-LEDGER-LEN       PIC S9(4)   COMP.
  1655         16  CK-LEDGER-ATTRB     PIC X.
  1656         16  CK-LEDGER           PIC X(14).
  1657         16  CK-AGOCD-LEN        PIC S9(4)   COMP.
  1658         16  CK-AGOCD-ATTRB      PIC X.
  1659         16  CK-AGOCD            PIC X(1).
  1660         16  CK-DETAMT-LEN       PIC S9(4)   COMP.
  1661         16  CK-DETAMT-ATTRB     PIC X.
  1662         16  CK-DETAMT-IN        PIC X(12).
  1663         16  CK-DETAMT-OUT REDEFINES CK-DETAMT-IN
  1664                                 PIC ZZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL636.cbl
  1666****************************************************************
  1667*
  1668* Copyright (c) 2007 by Clerity Solutions, Inc.
  1669* All rights reserved.
  1670*
  1671****************************************************************
  1672 01  DFHEIV.
  1673   02  DFHEIV0               PIC X(35).
  1674   02  DFHEIV1               PIC X(08).
  1675   02  DFHEIV2               PIC X(08).
  1676   02  DFHEIV3               PIC X(08).
  1677   02  DFHEIV4               PIC X(06).
  1678   02  DFHEIV5               PIC X(04).
  1679   02  DFHEIV6               PIC X(04).
  1680   02  DFHEIV7               PIC X(02).
  1681   02  DFHEIV8               PIC X(02).
  1682   02  DFHEIV9               PIC X(01).
  1683   02  DFHEIV10              PIC S9(7) COMP-3.
  1684   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1685   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1686   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1687   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1688   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1689   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1690   02  DFHEIV17              PIC X(04).
  1691   02  DFHEIV18              PIC X(04).
  1692   02  DFHEIV19              PIC X(04).
  1693   02  DFHEIV20              USAGE IS POINTER.
  1694   02  DFHEIV21              USAGE IS POINTER.
  1695   02  DFHEIV22              USAGE IS POINTER.
  1696   02  DFHEIV23              USAGE IS POINTER.
  1697   02  DFHEIV24              USAGE IS POINTER.
  1698   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1699   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1700   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1701   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1702   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1703   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1704   02  FILLER                PIC X(02).
  1705   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1706   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1707   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1708   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1709   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1710 LINKAGE  SECTION.
  1711*****************************************************************
  1712*                                                               *
  1713* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1714* All rights reserved.                                          *
  1715*                                                               *
  1716*****************************************************************
  1717 01  dfheiblk.
  1718     02  eibtime          pic s9(7) comp-3.
  1719     02  eibdate          pic s9(7) comp-3.
  1720     02  eibtrnid         pic x(4).
  1721     02  eibtaskn         pic s9(7) comp-3.
  1722     02  eibtrmid         pic x(4).
  1723     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL636.cbl
  1724     02  eibcposn         pic s9(4) comp.
  1725     02  eibcalen         pic s9(4) comp.
  1726     02  eibaid           pic x(1).
  1727     02  eibfiller1       pic x(1).
  1728     02  eibfn            pic x(2).
  1729     02  eibfiller2       pic x(2).
  1730     02  eibrcode         pic x(6).
  1731     02  eibfiller3       pic x(2).
  1732     02  eibds            pic x(8).
  1733     02  eibreqid         pic x(8).
  1734     02  eibrsrce         pic x(8).
  1735     02  eibsync          pic x(1).
  1736     02  eibfree          pic x(1).
  1737     02  eibrecv          pic x(1).
  1738     02  eibsend          pic x(1).
  1739     02  eibatt           pic x(1).
  1740     02  eibeoc           pic x(1).
  1741     02  eibfmh           pic x(1).
  1742     02  eibcompl         pic x(1).
  1743     02  eibsig           pic x(1).
  1744     02  eibconf          pic x(1).
  1745     02  eiberr           pic x(1).
  1746     02  eibrldbk         pic x(1).
  1747     02  eiberrcd         pic x(4).
  1748     02  eibsynrb         pic x(1).
  1749     02  eibnodat         pic x(1).
  1750     02  eibfiller5       pic x(2).
  1751     02  eibresp          pic 9(09) comp.
  1752     02  eibresp2         pic 9(09) comp.
  1753     02  dfheigdj         pic s9(4) comp.
  1754     02  dfheigdk         pic s9(4) comp.
  1755 01  DFHCOMMAREA             PIC X(1024).
  1756
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL636.cbl
  1758*01 PARMLIST .
  1759*    02  FILLER              PIC S9(8)   COMP.
  1760*    02  ERCKWK-POINTER      PIC S9(8)   COMP.
  1761*    02  ERCMCK-POINTER      PIC S9(8)   COMP.
  1762*    02  ERCOMP-POINTER      PIC S9(8)   COMP.
  1763*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  1764
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL636.cbl
  1766
  1767*                             COPY ERCCKWK.
  1768******************************************************************
  1769*                                                                *
  1770*                                                                *
  1771*                            ERCCKWK                             *
  1772*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1773*                            VMOD=2.011                          *
  1774*                                                                *
  1775*   FILE DESCRIPTION = CHECK WORK RECORDS                        *
  1776*                                                                *
  1777*   FILE TYPE = VSAM,KSDS                                        *
  1778*   RECORD SIZE = 200    RECFORM = FIXED                         *
  1779*                                                                *
  1780*   BASE CLUSTER NAME = ERCKWK             RKP=2,LEN=26          *
  1781*       ALTERNATE INDEX = NONE                                   *
  1782*                                                                *
  1783*   LOG = YES                                                    *
  1784*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1785******************************************************************
  1786 01  CHECK-WORK-RECORDS.
  1787     12  CW-RECORD-ID                      PIC XX.
  1788         88  VALID-CW-ID                      VALUE 'CW'.
  1789
  1790     12  CW-CONTROL-PRIMARY.
  1791         16  CW-COMPANY-CD                 PIC X.
  1792         16  CW-CSR                        PIC X(4).
  1793         16  CW-CARRIER                    PIC X.
  1794         16  CW-GROUPING                   PIC X(6).
  1795         16  CW-PAYEE                      PIC X(10).
  1796         16  CW-PAYEE-SEQ                  PIC S9(4)     COMP.
  1797         16  CW-SEQUENCE-NO                PIC S9(4)     COMP.
  1798
  1799     12  CW-RECORD-TYPE                    PIC X.
  1800         88 CW-HEADER                            VALUE '0'.
  1801         88 CW-DETAIL                            VALUE '1'.
  1802         88 CW-TEXT                              VALUE '2'.
  1803
  1804     12  CW-RECORDED-DT                    PIC XX.
  1805     12  CW-RECORDED-BY                    PIC X(4).
  1806     12  CW-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  1807
  1808     12  CW-RELEASE-DT                     PIC XX.
  1809
  1810     12  CW-HEADER-RECORD.
  1811         16  CW-PAYEE-NAME                 PIC X(30).
  1812         16  CW-ADDRESS-1                  PIC X(30).
  1813         16  CW-ADDRESS-2                  PIC X(30).
  1814         16  CW-PAYEE-CITY-ST              PIC X(30).
  1815         16  CW-PAYEE-ZIP-CODE.
  1816             20  CW-PAYEE-ZIP              PIC X(5).
  1817             20  CW-PAYEE-ZIP-EXT          PIC X(4).
  1818         16  CW-TOTAL-COMMISSION           PIC S9(7)V99   COMP-3.
  1819         16  CW-TOTAL-ENTRIES              PIC S9(3)      COMP-3.
  1820
  1821     12  CW-DETAIL-RECORD REDEFINES CW-HEADER-RECORD.
  1822         16  CW-COMMENT                    PIC X(23).
  1823         16  CW-ACCT-AGENT                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL636.cbl
  1824         16  CW-INVOICE                    PIC X(6).
  1825         16  CW-REFERENCE                  PIC X(12).
  1826         16  CW-LEDGER-NO.
  1827             20  CW-LEDGER-PREFIX          PIC X(7).
  1828             20  CW-LEDGER-SUFFIX          PIC X(7).
  1829         16  CW-DETAIL-AMOUNT              PIC S9(7)V99  COMP-3.
  1830         16  CW-PAYMENT-TYPE               PIC X.
  1831         16  CW-LAST-MAINT-APPLIED         PIC X.
  1832         16  CW-NON-AR-ITEM                PIC X.
  1833         16  FILLER                        PIC X(63).
  1834
  1835     12  CW-TEXT-RECORD REDEFINES CW-HEADER-RECORD.
  1836         16  CW-STUB-TEXT                  PIC X(70).
  1837         16  CW-FILLER                     PIC X(66).
  1838
  1839     12  CW-CREDIT-SELECT-DT               PIC XX.
  1840     12  CW-CREDIT-ACCEPT-DT               PIC XX.
  1841
  1842     12  CW-AR-STATEMENT-DT                PIC XX.
  1843     12  CW-PMT-APPLIED                    PIC X.
  1844
  1845     12  CW-PYAJ-MADE                      PIC X.
  1846
  1847     12  FILLER                            PIC X(15).
  1848
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL636.cbl
  1850
  1851*                             COPY ERCCMCK.
  1852******************************************************************
  1853*                                                                *
  1854*                                                                *
  1855*                            ERCCMCK                             *
  1856*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1857*                            VMOD=2.012                          *
  1858*                                                                *
  1859*   FILE DESCRIPTION = COMMISSION CHECK RECORDS                  *
  1860*                                                                *
  1861*   FILE TYPE = VSAM,KSDS                                        *
  1862*   RECORD SIZE = 2000   RECFORM = FIXED                         *
  1863*                                                                *
  1864*   BASE CLUSTER NAME = ERCMCK             RKP=2,LEN=26          *
  1865*       ALTERNATE INDEX = NONE                                   *
  1866*                                                                *
  1867*   LOG = NO                                                     *
  1868*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1869******************************************************************
  1870 01  COMM-CHECK-RECORDS.
  1871     12  CK-RECORD-ID                      PIC XX.
  1872         88  VALID-CK-ID                      VALUE 'CK'.
  1873
  1874     12  CK-CONTROL-PRIMARY.
  1875         16  CK-COMPANY-CD                 PIC X.
  1876         16  CK-CSR                        PIC X(4).
  1877         16  CK-CARRIER                    PIC X.
  1878         16  CK-GROUPING                   PIC X(6).
  1879         16  CK-PAYEE                      PIC X(10).
  1880         16  CK-PAYEE-SEQ                  PIC S9(4)     COMP.
  1881         16  CK-SEQUENCE-NO                PIC S9(4)     COMP.
  1882
  1883     12  CK-RECORDED-DT                    PIC XX.
  1884     12  CK-RECORDED-BY                    PIC X(4).
  1885     12  CK-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  1886
  1887     12  CK-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  1888     12  CK-RECORD-TYPE                    PIC X.
  1889         88  CK-DETAIL                        VALUE 'D'.
  1890         88  CK-TEXT                          VALUE 'T'.
  1891     12  CK-CHECK-NO                       PIC X(6).
  1892     12  CK-CHECK-WRITTEN-DT               PIC XX.
  1893     12  CK-PAYEE-INFO.
  1894         16  CK-PAYEE-NAME                 PIC X(30).
  1895         16  CK-PAYEE-ADDRESS-1            PIC X(30).
  1896         16  CK-PAYEE-ADDRESS-2            PIC X(30).
  1897         16  CK-PAYEE-CITY-ST              PIC X(30).
  1898         16  CK-PAYEE-ZIP-CODE.
  1899             20  CK-PAYEE-ZIP              PIC X(5).
  1900             20  CK-PAYEE-ZIP-EXT          PIC X(4).
  1901
  1902     12  CK-CHECK-STUB-DATA.
  1903         16  CK-CHECK-STUB-INFO  OCCURS  15  TIMES.
  1904             20  CK-STUB-LINE.
  1905                 24  CK-STUB-COMMENT       PIC X(23).
  1906                 24  CK-ACCT-AGENT         PIC X(10).
  1907                 24  CK-INVOICE            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL636.cbl
  1908                 24  CK-REFERENCE          PIC X(12).
  1909                 24  CK-LEDGER-NO          PIC X(14).
  1910                 24  CK-DETAIL-AMT         PIC S9(7)V99 COMP-3.
  1911                 24  CK-LAST-MAINT-APPLIED PIC X.
  1912                 24  CK-NON-AR-ITEM        PIC X.
  1913                 24  FILLER                PIC X(19).
  1914
  1915             20  CK-CHECK-WORK-CONTROL.
  1916                  24  CK-CKWK-CSR          PIC X(4).
  1917                  24  CK-CKWK-CARRIER      PIC X.
  1918                  24  CK-CKWK-GROUPING     PIC X(6).
  1919                  24  CK-CKWK-PAYEE        PIC X(10).
  1920                  24  CK-CKWK-PAYEE-SEQ    PIC S9(4) COMP.
  1921                  24  CK-CKWK-SEQ-NO       PIC S9(4) COMP.
  1922             20  CK-PAYMENT-TYPE           PIC X.
  1923             20  CK-PYAJ-PMT-APPLIED       PIC X.
  1924
  1925     12  CK-CHECK-STUB-TEXT  REDEFINES CK-CHECK-STUB-DATA.
  1926         16  CK-CHECK-TEXT-ITEMS OCCURS 3 TIMES.
  1927             20  CK-STUB-TEXT              PIC X(70).
  1928         16  CK-STUB-FILL-AREA             PIC X(1560).
  1929
  1930     12  CK-CHECK-QUE-CONTROL.
  1931         20  CK-QUE-CONTROL-NUMBER         PIC S9(8) COMP.
  1932         20  CK-QUE-SEQ-NO                 PIC S9(4) COMP.
  1933
  1934     12  CK-CREDIT-SELECT-DT               PIC XX.
  1935     12  CK-CREDIT-ACCEPT-DT               PIC XX.
  1936
  1937     12  CK-VOID-DATA.
  1938         20  CK-VOID-DT                    PIC XX.
  1939         20  CK-VOID-REASON                PIC X(25).
  1940
  1941     12  CK-AR-STATEMENT-DT                PIC XX.
  1942     12  CK-PMT-APPLIED                    PIC X.
  1943     12  CK-ACH-PAYMENT                    PIC X.
  1944          88 PAID-BY-ACH                   VALUE 'P'.
  1945          88 NOT-PAID-BY-ACH               VALUE 'N'.
  1946     12  FILLER                            PIC X(08).
  1947
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL636.cbl
  1949
  1950*                             COPY ERCCOMP.
  1951******************************************************************
  1952*                                                                *
  1953*                                                                *
  1954*                            ERCCOMP                             *
  1955*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1956*                            VMOD=2.019                          *
  1957*                                                                *
  1958*   ONLINE CREDIT SYSTEM                                         *
  1959*                                                                *
  1960*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1961*                                                                *
  1962*   FILE TYPE = VSAM,KSDS                                        *
  1963*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1964*                                                                *
  1965*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1966*       ALTERNATE PATH = NONE                                    *
  1967*                                                                *
  1968*   LOG = NO                                                     *
  1969*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1970*                                                                *
  1971******************************************************************
  1972*                   C H A N G E   L O G
  1973*
  1974* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1975*-----------------------------------------------------------------
  1976*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1977* EFFECTIVE    NUMBER
  1978*-----------------------------------------------------------------
  1979* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1980* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1981* 092205    2005050300006  PEMA  ADD LEASE FEE
  1982* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1983* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1984* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1985* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1986* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1987******************************************************************
  1988
  1989 01  COMPENSATION-MASTER.
  1990     12  CO-RECORD-ID                          PIC XX.
  1991         88  VALID-CO-ID                          VALUE 'CO'.
  1992
  1993     12  CO-CONTROL-PRIMARY.
  1994         16  CO-COMPANY-CD                     PIC X.
  1995         16  CO-CONTROL.
  1996             20  CO-CTL-1.
  1997                 24  CO-CARR-GROUP.
  1998                     28  CO-CARRIER            PIC X.
  1999                     28  CO-GROUPING.
  2000                         32  CO-GROUP-PREFIX   PIC XXX.
  2001                         32  CO-GROUP-PRIME    PIC XXX.
  2002                 24  CO-RESP-NO.
  2003                     28  CO-RESP-PREFIX        PIC X(4).
  2004                     28  CO-RESP-PRIME         PIC X(6).
  2005             20  CO-CTL-2.
  2006                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL636.cbl
  2007                     28  CO-ACCT-PREFIX        PIC X(4).
  2008                     28  CO-ACCT-PRIME         PIC X(6).
  2009         16  CO-TYPE                           PIC X.
  2010             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2011             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2012             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2013
  2014     12  CO-MAINT-INFORMATION.
  2015         16  CO-LAST-MAINT-DT                  PIC XX.
  2016         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2017         16  CO-LAST-MAINT-USER                PIC X(4).
  2018     12  FILLER                                PIC XX.
  2019     12  CO-STMT-TYPE                          PIC XXX.
  2020     12  CO-COMP-TYPE                          PIC X.
  2021         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2022     12  CO-STMT-OWNER                         PIC X(4).
  2023     12  CO-BALANCE-CONTROL                    PIC X.
  2024         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2025         88  CO-NO-BALANCE                        VALUE 'N'.
  2026
  2027     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2028         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2029         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2030         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2031
  2032     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2033         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2034         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2035
  2036     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2037     12  CO-GA-DIRECT-DEP                      PIC X.
  2038     12  CO-FUTURE-SPACE                       PIC X.
  2039         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2040
  2041     12  CO-ACCT-NAME                          PIC X(30).
  2042     12  CO-MAIL-NAME                          PIC X(30).
  2043     12  CO-ADDR-1                             PIC X(30).
  2044     12  CO-ADDR-2                             PIC X(30).
  2045     12  CO-ADDR-3.
  2046         16  CO-ADDR-CITY                      PIC X(27).
  2047         16  CO-ADDR-STATE                     PIC XX.
  2048     12  CO-CSO-1099                           PIC X.
  2049     12  CO-ZIP.
  2050         16  CO-ZIP-PRIME.
  2051             20  CO-ZIP-PRI-1ST                PIC X.
  2052                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2053             20  FILLER                        PIC X(4).
  2054         16  CO-ZIP-PLUS4                      PIC X(4).
  2055     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2056         16  CO-CAN-POSTAL-1                   PIC XXX.
  2057         16  CO-CAN-POSTAL-2                   PIC XXX.
  2058         16  FILLER                            PIC XXX.
  2059     12  CO-SOC-SEC                            PIC X(13).
  2060     12  CO-TELEPHONE.
  2061         16  CO-AREA-CODE                      PIC XXX.
  2062         16  CO-PREFIX                         PIC XXX.
  2063         16  CO-PHONE                          PIC X(4).
  2064
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL636.cbl
  2065     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2066
  2067     12  CO-AR-BAL-LEVEL                       PIC X.
  2068         88  CO-AR-REF-LVL                        VALUE '1'.
  2069         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2070         88  CO-AR-BILL-LVL                       VALUE '2'.
  2071         88  CO-AR-AGT-LVL                        VALUE '3'.
  2072         88  CO-AR-FR-LVL                         VALUE '4'.
  2073
  2074     12  CO-AR-NORMAL-PRINT                    PIC X.
  2075         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2076         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2077
  2078     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2079
  2080     12  CO-AR-REPORTING                       PIC X.
  2081         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2082         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2083
  2084     12  CO-AR-PULL-CHECK                      PIC X.
  2085         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2086         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2087
  2088     12  CO-AR-BALANCE-PRINT                   PIC X.
  2089         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2090
  2091     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2092         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2093         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2094         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2095
  2096     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2097
  2098     12  CO-USER-CODE                          PIC X.
  2099     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2100
  2101******************************************************************
  2102*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2103*    THE LAST MONTH END RUN.
  2104******************************************************************
  2105
  2106     12  CO-LAST-ACTIVITY-DATE.
  2107         16  CO-ACT-YEAR                       PIC 99.
  2108         16  CO-ACT-MONTH                      PIC 99.
  2109         16  CO-ACT-DAY                        PIC 99.
  2110
  2111     12  CO-LAST-STMT-DT.
  2112         16  CO-LAST-STMT-YEAR                 PIC 99.
  2113         16  CO-LAST-STMT-MONTH                PIC 99.
  2114         16  CO-LAST-STMT-DAY                  PIC 99.
  2115
  2116     12  CO-MO-END-TOTALS.
  2117         16  CO-MONTHLY-TOTALS.
  2118             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2119             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2120             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2121             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  2122             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL636.cbl
  2123
  2124         16  CO-AGING-TOTALS.
  2125             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2126             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2127             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2128             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2129
  2130         16  CO-YTD-TOTALS.
  2131             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2132             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2133
  2134         16  CO-OVER-UNDER-TOTALS.
  2135             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2136             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2137
  2138     12  CO-MISCELLANEOUS-TOTALS.
  2139         16  CO-FICA-TOTALS.
  2140             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2141             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2142
  2143         16  CO-CLAIM-TOTALS.
  2144             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2145             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2146
  2147******************************************************************
  2148*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2149*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2150******************************************************************
  2151
  2152     12  CO-CURRENT-TOTALS.
  2153         16  CO-CURRENT-LAST-STMT-DT.
  2154             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2155             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2156             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2157
  2158         16  CO-CURRENT-MONTHLY-TOTALS.
  2159             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2160             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2161             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2162             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2163             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2164
  2165         16  CO-CURRENT-AGING-TOTALS.
  2166             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2167             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2168             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2169             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2170
  2171         16  CO-CURRENT-YTD-TOTALS.
  2172             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2173             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2174
  2175     12  CO-PAID-COMM-TOTALS.
  2176         16  CO-YTD-PAID-COMMS.
  2177             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2178             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2179
  2180     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL636.cbl
  2181         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  2182         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2183
  2184     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2185         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2186         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2187         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2188         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2189         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2190         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2191         88  CO-FINAL-LETTER                  VALUE 'F'.
  2192         88  CO-RECONCILING                   VALUE 'R'.
  2193         88  CO-PHONE-CALL                    VALUE 'P'.
  2194         88  CO-LEGAL                         VALUE 'L'.
  2195         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2196         88  CO-WRITE-OFF                     VALUE 'W'.
  2197         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2198
  2199     12  CO-CSR-CODE                       PIC X(4).
  2200
  2201     12  CO-GA-STATUS-INFO.
  2202         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2203         16  CO-GA-TERMINATION-DT          PIC XX.
  2204         16  CO-GA-STATUS-CODE             PIC X.
  2205             88  CO-GA-ACTIVE                 VALUE 'A'.
  2206             88  CO-GA-INACTIVE               VALUE 'I'.
  2207             88  CO-GA-PENDING                VALUE 'P'.
  2208         16  CO-GA-COMMENTS.
  2209             20  CO-GA-COMMENT-1           PIC X(40).
  2210             20  CO-GA-COMMENT-2           PIC X(40).
  2211             20  CO-GA-COMMENT-3           PIC X(40).
  2212             20  CO-GA-COMMENT-4           PIC X(40).
  2213
  2214     12  CO-RPTCD2                         PIC X(10).
  2215
  2216     12  CO-TYPE-AGENT                     PIC X(01).
  2217         88  CO-CORPORATION                   VALUE 'C'.
  2218         88  CO-PARTNERSHIP                   VALUE 'P'.
  2219         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2220         88  CO-TRUST                         VALUE 'T'.
  2221         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2222
  2223     12  CO-FAXNO.
  2224         16  CO-FAX-AREA-CODE                  PIC XXX.
  2225         16  CO-FAX-PREFIX                     PIC XXX.
  2226         16  CO-FAX-PHONE                      PIC X(4).
  2227
  2228     12  CO-BANK-INFORMATION.
  2229         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2230         16  CO-BANK-TRANSIT-NON REDEFINES
  2231             CO-BANK-TRANSIT-NO                PIC 9(8).
  2232
  2233         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2234     12  CO-MISC-DEDUCT-INFO REDEFINES
  2235                  CO-BANK-INFORMATION.
  2236         16  CO-MD-GL-ACCT                     PIC X(10).
  2237         16  CO-MD-DIV                         PIC XX.
  2238         16  CO-MD-CENTER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL636.cbl
  2239         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  2240         16  CO-CREATE-AP-CHECK                PIC X.
  2241         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2242         16  FILLER                            PIC XXX.
  2243     12  CO-ACH-STATUS                         PIC X.
  2244         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2245         88  CO-ACH-PENDING                        VALUE 'P'.
  2246
  2247     12  CO-BILL-SW                            PIC X.
  2248     12  CO-CONTROL-NAME                       PIC X(30).
  2249     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2250     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2251     12  CO-CLP-STATE                          PIC XX.
  2252     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2253     12  CO-SPP-REFUND-EDIT                    PIC X.
  2254
  2255******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL636.cbl
  2257*                             COPY ELCCNTL.
  2258******************************************************************
  2259*                                                                *
  2260*                                                                *
  2261*                            ELCCNTL.                            *
  2262*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2263*                            VMOD=2.059                          *
  2264*                                                                *
  2265*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2266*                                                                *
  2267*   FILE TYPE = VSAM,KSDS                                        *
  2268*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2269*                                                                *
  2270*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2271*       ALTERNATE INDEX = NONE                                   *
  2272*                                                                *
  2273*   LOG = YES                                                    *
  2274*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2275******************************************************************
  2276*                   C H A N G E   L O G
  2277*
  2278* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2279*-----------------------------------------------------------------
  2280*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2281* EFFECTIVE    NUMBER
  2282*-----------------------------------------------------------------
  2283* 082503                   PEMA  ADD BENEFIT GROUP
  2284* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2285* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2286* 092705    2005050300006  PEMA  ADD SPP LEASES
  2287* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2288* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2289* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2290* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2291******************************************************************
  2292*
  2293 01  CONTROL-FILE.
  2294     12  CF-RECORD-ID                       PIC XX.
  2295         88  VALID-CF-ID                        VALUE 'CF'.
  2296
  2297     12  CF-CONTROL-PRIMARY.
  2298         16  CF-COMPANY-ID                  PIC XXX.
  2299         16  CF-RECORD-TYPE                 PIC X.
  2300             88  CF-COMPANY-MASTER              VALUE '1'.
  2301             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2302             88  CF-STATE-MASTER                VALUE '3'.
  2303             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2304             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2305             88  CF-CARRIER-MASTER              VALUE '6'.
  2306             88  CF-MORTALITY-MASTER            VALUE '7'.
  2307             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2308             88  CF-TERMINAL-MASTER             VALUE '9'.
  2309             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2310             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2311             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2312             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2313             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2314             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL636.cbl
  2315             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2316             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2317             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2318         16  CF-ACCESS-CD-GENL              PIC X(4).
  2319         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2320             20  CF-PROCESSOR               PIC X(4).
  2321         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2322             20  CF-STATE-CODE              PIC XX.
  2323             20  FILLER                     PIC XX.
  2324         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2325             20  FILLER                     PIC XX.
  2326             20  CF-HI-BEN-IN-REC           PIC XX.
  2327         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2328             20  FILLER                     PIC XXX.
  2329             20  CF-CARRIER-CNTL            PIC X.
  2330         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2331             20  FILLER                     PIC XX.
  2332             20  CF-HI-TYPE-IN-REC          PIC 99.
  2333         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2334             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2335                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2336             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2337             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2338         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2339             20  FILLER                     PIC X.
  2340             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2341         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2342             20  FILLER                     PIC XX.
  2343             20  CF-MORTGAGE-PLAN           PIC XX.
  2344         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2345
  2346     12  CF-LAST-MAINT-DT                   PIC XX.
  2347     12  CF-LAST-MAINT-BY                   PIC X(4).
  2348     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2349
  2350     12  CF-RECORD-BODY                     PIC X(728).
  2351
  2352
  2353****************************************************************
  2354*             COMPANY MASTER RECORD                            *
  2355****************************************************************
  2356
  2357     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2358         16  CF-COMPANY-ADDRESS.
  2359             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2360             20  CF-CL-IN-CARE-OF           PIC X(30).
  2361             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2362             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2363             20  CF-CL-CITY-STATE           PIC X(30).
  2364             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2365             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2366         16  CF-COMPANY-CD                  PIC X.
  2367         16  CF-COMPANY-PASSWORD            PIC X(8).
  2368         16  CF-SECURITY-OPTION             PIC X.
  2369             88  ALL-SECURITY                   VALUE '1'.
  2370             88  COMPANY-VERIFY                 VALUE '2'.
  2371             88  PROCESSOR-VERIFY               VALUE '3'.
  2372             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL636.cbl
  2373             88  ALL-BUT-TERM                   VALUE '5'.
  2374         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2375             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2376         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2377             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2378         16  CF-INFORCE-LOCATION            PIC X.
  2379             88  CERTS-ARE-ONLINE               VALUE '1'.
  2380             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2381             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2382         16  CF-LOWER-CASE-LETTERS          PIC X.
  2383         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2384             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2385             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2386             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2387             88  CF-ACCNT-CNTL                  VALUE '3'.
  2388             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2389
  2390         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2391         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2392
  2393         16  CF-LGX-CREDIT-USER             PIC X.
  2394             88  CO-IS-NOT-USER                 VALUE 'N'.
  2395             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2396
  2397         16 CF-CREDIT-CALC-CODES.
  2398             20  CF-CR-REM-TERM-CALC PIC X.
  2399               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2400               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2401               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2402               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2403               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2404               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2405               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2406             20  CF-CR-R78-METHOD           PIC X.
  2407               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2408               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2409
  2410         16  CF-CLAIM-CONTROL-COUNTS.
  2411             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2412                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2413
  2414             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2415                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2416
  2417             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2418                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2419
  2420             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2421                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2422
  2423         16  CF-CURRENT-MONTH-END           PIC XX.
  2424
  2425         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2426             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2427             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2428             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2429             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2430                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL636.cbl
  2431                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2432             20  CF-CO-PREM-REJECT-SW       PIC X.
  2433                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2434                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2435             20  CF-CO-REF-REJECT-SW        PIC X.
  2436                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2437                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2438
  2439         16  CF-CO-REPORTING-DT             PIC XX.
  2440         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2441         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2442           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2443           88  CF-CO-MONTH-END                  VALUE '1'.
  2444
  2445         16  CF-LGX-CLAIM-USER              PIC X.
  2446             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2447             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2448
  2449         16  CF-CREDIT-EDIT-CONTROLS.
  2450             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2451             20  CF-MIN-AGE                 PIC 99.
  2452             20  CF-DEFAULT-AGE             PIC 99.
  2453             20  CF-MIN-TERM                PIC S999      COMP-3.
  2454             20  CF-MAX-TERM                PIC S999      COMP-3.
  2455             20  CF-DEFAULT-SEX             PIC X.
  2456             20  CF-JOINT-AGE-INPUT         PIC X.
  2457                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2458             20  CF-BIRTH-DATE-INPUT        PIC X.
  2459                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2460             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2461                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2462                 88  CF-ZERO-CARRIER            VALUE '1'.
  2463                 88  CF-ZERO-GROUPING           VALUE '2'.
  2464                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2465             20  CF-EDIT-SW                 PIC X.
  2466                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2467             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2468             20  CF-CR-PR-METHOD            PIC X.
  2469               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2470               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2471             20  FILLER                     PIC X.
  2472
  2473         16  CF-CREDIT-MISC-CONTROLS.
  2474             20  CF-REIN-TABLE-SW           PIC X.
  2475                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2476             20  CF-COMP-TABLE-SW           PIC X.
  2477                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2478             20  CF-EXPERIENCE-RETENTION-AGE
  2479                                            PIC S9        COMP-3.
  2480             20  CF-CONVERSION-DT           PIC XX.
  2481             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2482             20  CF-RUN-FREQUENCY-SW        PIC X.
  2483                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2484                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2485
  2486             20  CF-CR-CHECK-NO-CONTROL.
  2487                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2488                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL636.cbl
  2489                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2490                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2491                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2492                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2493
  2494                 24  CF-CR-CHECK-COUNT       REDEFINES
  2495                     CF-CR-CHECK-COUNTER      PIC X(4).
  2496
  2497                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2498                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2499
  2500                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2501                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2502                 24  CF-MAIL-PROCESSING       PIC X.
  2503                     88  MAIL-PROCESSING          VALUE 'Y'.
  2504
  2505         16  CF-MISC-SYSTEM-CONTROL.
  2506             20  CF-SYSTEM-C                 PIC X.
  2507                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2508             20  CF-SYSTEM-D                 PIC X.
  2509                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2510             20  CF-SOC-SEC-NO-SW            PIC X.
  2511                 88  SOC-SEC-NO-USED             VALUE '1'.
  2512             20  CF-MEMBER-NO-SW             PIC X.
  2513                 88  MEMBER-NO-USED              VALUE '1'.
  2514             20  CF-TAX-ID-NUMBER            PIC X(11).
  2515             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2516             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2517                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2518                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2519                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2520                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2521             20  CF-SYSTEM-E                 PIC X.
  2522                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2523
  2524         16  CF-LGX-LIFE-USER               PIC X.
  2525             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2526             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2527
  2528         16  CF-CR-MONTH-END-DT             PIC XX.
  2529
  2530         16  CF-FILE-MAINT-DATES.
  2531             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2532                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2533             20  CF-LAST-BATCH       REDEFINES
  2534                 CF-LAST-BATCH-NO               PIC X(4).
  2535             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2536             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2537             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2538             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2539             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2540             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2541             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2542             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2543             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2544             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2545
  2546         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL636.cbl
  2547         16  FILLER                         PIC X.
  2548
  2549         16  CF-ALT-MORT-CODE               PIC X(4).
  2550         16  CF-MEMBER-CAPTION              PIC X(10).
  2551
  2552         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2553             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2554             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2555             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2556             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2557             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2558
  2559         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2560
  2561         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2562         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2563         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2564         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2565
  2566         16  CF-AH-OVERRIDE-L1              PIC X.
  2567         16  CF-AH-OVERRIDE-L2              PIC XX.
  2568         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2569         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2570
  2571         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2572         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2573
  2574         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2575         16  CF-AR-LAST-EL860-DT            PIC XX.
  2576         16  CF-MP-MONTH-END-DT             PIC XX.
  2577
  2578         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2579         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2580             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2581
  2582         16  CF-AR-MONTH-END-DT             PIC XX.
  2583
  2584         16  CF-CRDTCRD-USER                PIC X.
  2585             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2586             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2587
  2588         16  CF-CC-MONTH-END-DT             PIC XX.
  2589
  2590         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2591
  2592         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2593             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2594             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2595             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2596         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2597         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2598         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2599         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2600             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2601             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2602         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2603         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2604         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL636.cbl
  2605             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2606         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2607
  2608         16  CF-CL-ZIP-CODE.
  2609             20  CF-CL-ZIP-PRIME.
  2610                 24  CF-CL-ZIP-1ST          PIC X.
  2611                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2612                 24  FILLER                 PIC X(4).
  2613             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2614         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2615             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2616             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2617             20  FILLER                     PIC XXX.
  2618
  2619         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2620         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2621         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2622         16  CF-CO-OPTION-START-DATE        PIC XX.
  2623         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2624           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2625                                                      '3' '4'.
  2626           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2627           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2628           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2629           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2630           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2631           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2632
  2633         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2634
  2635         16  CF-PAYMENT-APPROVAL-LEVELS.
  2636             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2637             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2638             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2639             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2640             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2641             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2642
  2643         16  CF-END-USER-REPORTING-USER     PIC X.
  2644             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2645             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2646
  2647         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2648             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2649             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2650
  2651         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2652
  2653         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2654         16  FILLER                         PIC X.
  2655
  2656         16  CF-CREDIT-ARCHIVE-CNTL.
  2657             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2658             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2659             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2660
  2661         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2662
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL636.cbl
  2663         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2664             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2665             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2666
  2667         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2668             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2669             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2670
  2671         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2672
  2673         16  CF-CO-ACH-ID-CODE              PIC  X.
  2674             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2675             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2676             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2677         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2678         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2679         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2680         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2681         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2682         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2683         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2684         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2685         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2686                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2687         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2688                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2689
  2690         16  CF-CO-OVER-SHORT.
  2691             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2692             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2693
  2694*         16  FILLER                         PIC X(102).
  2695         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2696             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2697             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2698
  2699         16  CF-AH-APPROVAL-DAYS.
  2700             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2701             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2702             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2703             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2704
  2705         16  FILLER                         PIC X(82).
  2706****************************************************************
  2707*             PROCESSOR/USER RECORD                            *
  2708****************************************************************
  2709
  2710     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2711         16  CF-PROCESSOR-NAME              PIC X(30).
  2712         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2713         16  CF-PROCESSOR-TITLE             PIC X(26).
  2714         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2715                 88  MESSAGE-YES                VALUE 'Y'.
  2716                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2717
  2718*****************************************************
  2719****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2720****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL636.cbl
  2721****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2722****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2723*****************************************************
  2724
  2725         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2726             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2727             20  CF-APPLICATION-FORCE       PIC X.
  2728             20  CF-INDIVIDUAL-APP.
  2729                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2730                     28  CF-BROWSE-APP      PIC X.
  2731                     28  CF-UPDATE-APP      PIC X.
  2732
  2733         16  CF-CURRENT-TERM-ON             PIC X(4).
  2734         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2735             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2736             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2737             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2738             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2739             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2740             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2741             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2742         16  CF-PROCESSOR-CARRIER           PIC X.
  2743             88  NO-CARRIER-SECURITY            VALUE ' '.
  2744         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2745             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2746         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2747             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2748         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2749             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2750
  2751         16  CF-PROC-SYS-ACCESS-SW.
  2752             20  CF-PROC-CREDIT-CLAIMS-SW.
  2753                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2754                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2755                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2756                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2757             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2758                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2759                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2760             20  CF-PROC-LIFE-GNRLDGR-SW.
  2761                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2762                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2763                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2764                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2765             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2766                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2767                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2768         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2769             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2770             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2771         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2772
  2773         16  CF-APPROVAL-LEVEL                  PIC X.
  2774             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2775             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2776             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2777             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2778
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL636.cbl
  2779         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2780
  2781         16  CF-LANGUAGE-TYPE                   PIC X.
  2782             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2783             88  CF-LANG-IS-FR                      VALUE 'F'.
  2784         16  FILLER                             PIC  X(240).
  2785
  2786****************************************************************
  2787*             PROCESSOR/REMINDERS RECORD                       *
  2788****************************************************************
  2789
  2790     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2791         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2792             20  CF-START-REMIND-DT         PIC XX.
  2793             20  CF-END-REMIND-DT           PIC XX.
  2794             20  CF-REMINDER-TEXT           PIC X(50).
  2795         16  FILLER                         PIC X(296).
  2796
  2797
  2798****************************************************************
  2799*             STATE MASTER RECORD                              *
  2800****************************************************************
  2801
  2802     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2803         16  CF-STATE-ABBREVIATION          PIC XX.
  2804         16  CF-STATE-NAME                  PIC X(25).
  2805         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2806         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2807             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2808             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2809             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2810             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2811                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2812                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2813             20  CF-ST-PREM-REJECT-SW       PIC X.
  2814                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2815                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2816             20  CF-ST-REF-REJECT-SW        PIC X.
  2817                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2818                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2819         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2820         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2821         16  CF-ST-REFUND-RULES.
  2822             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2823             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2824             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2825         16  CF-ST-FST-PMT-EXTENSION.
  2826             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2827             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2828                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2829                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2830                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2831                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2832         16  CF-ST-STATE-CALL.
  2833             20  CF-ST-CALL-UNEARNED        PIC X.
  2834             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2835             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2836         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL636.cbl
  2837             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2838             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2839         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2840         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2841         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2842         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2843         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2844         16  FILLER                         PIC X.
  2845         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2846             20  CF-ST-BENEFIT-CD           PIC XX.
  2847             20  CF-ST-BENEFIT-KIND         PIC X.
  2848                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2849                 88  CF-ST-AH-KIND              VALUE 'A'.
  2850             20  CF-ST-REM-TERM-CALC        PIC X.
  2851                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2852                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2853                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2854                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2855                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2856                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2857                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2858                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2859
  2860             20  CF-ST-REFUND-CALC          PIC X.
  2861                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2862                 88  ST-REFD-BY-R78             VALUE '1'.
  2863                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2864                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2865                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2866                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2867                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2868                 88  ST-REFD-UTAH               VALUE '7'.
  2869                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2870                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2871                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2872
  2873             20  CF-ST-EARNING-CALC         PIC X.
  2874                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2875                 88  ST-EARN-BY-R78             VALUE '1'.
  2876                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2877                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2878                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2879                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2880                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2881                 88  ST-EARN-MEAN               VALUE '8'.
  2882                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2883
  2884             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2885                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2886                 88  ST-OVRD-BY-R78             VALUE '1'.
  2887                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2888                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2889                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2890                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2891                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2892                 88  ST-OVRD-MEAN               VALUE '8'.
  2893                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2894             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL636.cbl
  2895
  2896         16  CF-ST-COMMISSION-CAPS.
  2897             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2898             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2899             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2900             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2901         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2902                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2903
  2904         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2905
  2906         16  CF-ST-STATUTORY-INTEREST.
  2907             20  CF-ST-STAT-DATE-FROM       PIC X.
  2908                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2909                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2910             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2911             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2912             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2913             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2914             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2915
  2916         16  CF-ST-OVER-SHORT.
  2917             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2918             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2919
  2920         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2921
  2922         16  CF-ST-RT-CALC                  PIC X.
  2923
  2924         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2925         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2926         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2927         16  CF-ST-RF-LR-CALC               PIC X.
  2928         16  CF-ST-RF-LL-CALC               PIC X.
  2929         16  CF-ST-RF-LN-CALC               PIC X.
  2930         16  CF-ST-RF-AH-CALC               PIC X.
  2931         16  CF-ST-RF-CP-CALC               PIC X.
  2932*        16  FILLER                         PIC X(206).
  2933*CIDMOD         16  FILLER                         PIC X(192).
  2934         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2935             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2936         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2937         16  FILLER                         PIC X(187).
  2938
  2939****************************************************************
  2940*             BENEFIT MASTER RECORD                            *
  2941****************************************************************
  2942
  2943     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2944         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2945             20  CF-BENEFIT-CODE            PIC XX.
  2946             20  CF-BENEFIT-NUMERIC  REDEFINES
  2947                 CF-BENEFIT-CODE            PIC XX.
  2948             20  CF-BENEFIT-ALPHA           PIC XXX.
  2949             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2950             20  CF-BENEFIT-COMMENT         PIC X(10).
  2951
  2952             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL636.cbl
  2953                 88  CF-REDUCING                VALUE 'R'.
  2954                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2955
  2956             20  CF-SPECIAL-CALC-CD         PIC X.
  2957                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2958                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2959                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2960                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2961                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2962                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2963                 88  CF-FARM-PLAN               VALUE 'F'.
  2964                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2965                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2966                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2967                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2968                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2969                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2970                 88  CF-PRUDENTIAL              VALUE 'P'.
  2971                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2972                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2973                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2974                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2975                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2976                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2977
  2978             20  CF-JOINT-INDICATOR         PIC X.
  2979                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2980
  2981*            20  FILLER                     PIC X(12).
  2982             20  FILLER                     PIC X(11).
  2983             20  CF-BENEFIT-CATEGORY        PIC X.
  2984             20  CF-LOAN-TYPE               PIC X(8).
  2985
  2986             20  CF-CO-REM-TERM-CALC        PIC X.
  2987                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2988                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2989                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2990                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2991                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2992
  2993             20  CF-CO-EARNINGS-CALC        PIC X.
  2994                 88  CO-EARN-BY-R78             VALUE '1'.
  2995                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2996                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2997                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2998                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2999                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3000                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3001                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3002
  3003             20  CF-CO-REFUND-CALC          PIC X.
  3004                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3005                 88  CO-REFD-BY-R78             VALUE '1'.
  3006                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3007                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3008                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3009                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3010                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL636.cbl
  3011                 88  CO-REFD-MEAN               VALUE '8'.
  3012                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3013                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3014                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3015
  3016             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3017                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3018                 88  CO-OVRD-BY-R78             VALUE '1'.
  3019                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3020                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3021                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3022                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3023                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3024                 88  CO-OVRD-MEAN               VALUE '8'.
  3025                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3026
  3027             20  CF-CO-BEN-I-G-CD           PIC X.
  3028                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3029                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3030                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3031
  3032         16  FILLER                         PIC X(304).
  3033
  3034
  3035****************************************************************
  3036*             CARRIER MASTER RECORD                            *
  3037****************************************************************
  3038
  3039     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3040         16  CF-ADDRESS-DATA.
  3041             20  CF-MAIL-TO-NAME            PIC X(30).
  3042             20  CF-IN-CARE-OF              PIC X(30).
  3043             20  CF-ADDRESS-LINE-1          PIC X(30).
  3044             20  CF-ADDRESS-LINE-2          PIC X(30).
  3045             20  CF-CITY-STATE              PIC X(30).
  3046             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3047             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3048
  3049         16  CF-CLAIM-NO-CONTROL.
  3050             20  CF-CLAIM-NO-METHOD         PIC X.
  3051                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3052                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3053                 88  CLAIM-NO-SEQ               VALUE '3'.
  3054                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3055             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3056                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3057                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3058                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3059
  3060         16  CF-CHECK-NO-CONTROL.
  3061             20  CF-CHECK-NO-METHOD         PIC X.
  3062                 88  CHECK-NO-MANUAL            VALUE '1'.
  3063                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3064                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3065                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3066             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3067                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3068
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL636.cbl
  3069         16  CF-DOMICILE-STATE              PIC XX.
  3070
  3071         16  CF-EXPENSE-CONTROLS.
  3072             20  CF-EXPENSE-METHOD          PIC X.
  3073                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3074                 88  DOLLARS-PER-PMT            VALUE '2'.
  3075                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3076                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3077             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3078             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3079
  3080         16  CF-CORRESPONDENCE-CONTROL.
  3081             20  CF-LETTER-RESEND-OPT       PIC X.
  3082                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3083                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3084             20  FILLER                     PIC X(4).
  3085
  3086         16  CF-RESERVE-CONTROLS.
  3087             20  CF-MANUAL-SW               PIC X.
  3088                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3089             20  CF-FUTURE-SW               PIC X.
  3090                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3091             20  CF-PTC-SW                  PIC X.
  3092                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3093             20  CF-IBNR-SW                 PIC X.
  3094                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3095             20  CF-PTC-LF-SW               PIC X.
  3096                 88  CF-LF-PTC-USED             VALUE '1'.
  3097             20  CF-CDT-ACCESS-METHOD       PIC X.
  3098                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3099                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3100                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3101             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3102
  3103         16  CF-CLAIM-CALC-METHOD           PIC X.
  3104             88  360-PLUS-MONTHS                VALUE '1'.
  3105             88  365-PLUS-MONTHS                VALUE '2'.
  3106             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3107             88  360-DAILY                      VALUE '4'.
  3108             88  365-DAILY                      VALUE '5'.
  3109
  3110         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3111         16  FILLER                         PIC X(11).
  3112
  3113         16  CF-LIMIT-AMOUNTS.
  3114             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3115             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3116             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3117             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3118             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3119             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3120             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3121             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3122             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3123             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3124
  3125         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3126         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL636.cbl
  3127         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3128
  3129         16  CF-ZIP-CODE.
  3130             20  CF-ZIP-PRIME.
  3131                 24  CF-ZIP-1ST             PIC X.
  3132                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3133                 24  FILLER                 PIC X(4).
  3134             20  CF-ZIP-PLUS4               PIC X(4).
  3135         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3136             20  CF-CAN-POSTAL-1            PIC XXX.
  3137             20  CF-CAN-POSTAL-2            PIC XXX.
  3138             20  FILLER                     PIC XXX.
  3139
  3140         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3141         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3142         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3143
  3144         16  CF-RATING-SWITCH               PIC X.
  3145             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3146             88  CF-NO-RATING                   VALUE 'N'.
  3147
  3148         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3149
  3150         16  CF-CARRIER-OVER-SHORT.
  3151             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3152             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3153
  3154         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3155         16  CF-SECPAY-SWITCH               PIC X.
  3156             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3157             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3158         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3159         16  FILLER                         PIC X(448).
  3160*        16  FILLER                         PIC X(452).
  3161
  3162
  3163****************************************************************
  3164*             MORTALITY MASTER RECORD                          *
  3165****************************************************************
  3166
  3167     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3168         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3169                                INDEXED BY CF-MORT-NDX.
  3170             20  CF-MORT-TABLE              PIC X(5).
  3171             20  CF-MORT-TABLE-TYPE         PIC X.
  3172                 88  CF-MORT-JOINT              VALUE 'J'.
  3173                 88  CF-MORT-SINGLE             VALUE 'S'.
  3174                 88  CF-MORT-COMBINED           VALUE 'C'.
  3175                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3176                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3177             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3178             20  CF-MORT-AGE-METHOD         PIC XX.
  3179                 88  CF-AGE-LAST                VALUE 'AL'.
  3180                 88  CF-AGE-NEAR                VALUE 'AN'.
  3181             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3182             20  CF-MORT-ADJUSTMENT-DIRECTION
  3183                                            PIC X.
  3184                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL636.cbl
  3185                 88  CF-PLUS                    VALUE '+'.
  3186             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3187             20  CF-MORT-JOINT-CODE         PIC X.
  3188                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3189             20  CF-MORT-PC-Q               PIC X.
  3190                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3191             20  CF-MORT-TABLE-CODE         PIC X(4).
  3192             20  CF-MORT-COMMENTS           PIC X(15).
  3193             20  FILLER                     PIC X(14).
  3194
  3195         16  FILLER                         PIC X(251).
  3196
  3197
  3198****************************************************************
  3199*             BUSSINESS TYPE MASTER RECORD                     *
  3200****************************************************************
  3201
  3202     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3203* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3204* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3205* AND RECORD 05 IS TYPES 81-99
  3206         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3207             20  CF-BUSINESS-TITLE          PIC  X(19).
  3208             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3209                                            PIC S9V9(4) COMP-3.
  3210             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3211             20  FILLER                     PIC  X.
  3212         16  FILLER                         PIC  X(248).
  3213
  3214
  3215****************************************************************
  3216*             TERMINAL MASTER RECORD                           *
  3217****************************************************************
  3218
  3219     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3220
  3221         16  CF-COMPANY-TERMINALS.
  3222             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3223                                  PIC X(4).
  3224         16  FILLER               PIC X(248).
  3225
  3226
  3227****************************************************************
  3228*             LIFE EDIT MASTER RECORD                          *
  3229****************************************************************
  3230
  3231     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3232         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3233             20  CF-LIFE-CODE-IN            PIC XX.
  3234             20  CF-LIFE-CODE-OUT           PIC XX.
  3235         16  FILLER                         PIC X(248).
  3236
  3237
  3238****************************************************************
  3239*             AH EDIT MASTER RECORD                            *
  3240****************************************************************
  3241
  3242     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL636.cbl
  3243         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3244             20  CF-AH-CODE-IN              PIC XXX.
  3245             20  CF-AH-CODE-OUT             PIC XX.
  3246         16  FILLER                         PIC X(248).
  3247
  3248
  3249****************************************************************
  3250*             CREDIBILITY TABLES                               *
  3251****************************************************************
  3252
  3253     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3254         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3255                             INDEXED BY CF-CRDB-NDX.
  3256             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3257             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3258             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3259         16  FILLER                         PIC  X(332).
  3260
  3261
  3262****************************************************************
  3263*             REPORT CUSTOMIZATION RECORD                      *
  3264****************************************************************
  3265
  3266     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3267         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3268             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3269             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3270             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3271**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3272****       A T-TRANSFER.                                   ****
  3273             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3274
  3275         16  FILLER                         PIC XX.
  3276
  3277         16  CF-CARRIER-CNTL-OPT.
  3278             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3279                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3280                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3281             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3282                                            PIC X.
  3283         16  CF-GROUP-CNTL-OPT.
  3284             20  CF-GROUP-OPT-SEQ           PIC 9.
  3285                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3286                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3287             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3288                                            PIC X(6).
  3289         16  CF-STATE-CNTL-OPT.
  3290             20  CF-STATE-OPT-SEQ           PIC 9.
  3291                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3292                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3293             20  CF-STATE-SELECT OCCURS 3 TIMES
  3294                                            PIC XX.
  3295         16  CF-ACCOUNT-CNTL-OPT.
  3296             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3297                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3298                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3299             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3300                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL636.cbl
  3301         16  CF-BUS-TYP-CNTL-OPT.
  3302             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3303                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3304                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3305             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3306                                            PIC XX.
  3307         16  CF-LF-TYP-CNTL-OPT.
  3308             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3309                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3310                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3311             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3312                                            PIC XX.
  3313         16  CF-AH-TYP-CNTL-OPT.
  3314             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3315                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3316                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3317             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3318                                            PIC XX.
  3319         16  CF-REPTCD1-CNTL-OPT.
  3320             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3321                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3322                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3323             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3324                                            PIC X(10).
  3325         16  CF-REPTCD2-CNTL-OPT.
  3326             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3327                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3328                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3329             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3330                                            PIC X(10).
  3331         16  CF-USER1-CNTL-OPT.
  3332             20  CF-USER1-OPT-SEQ           PIC 9.
  3333                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3334                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3335             20  CF-USER1-SELECT OCCURS 3 TIMES
  3336                                            PIC X(10).
  3337         16  CF-USER2-CNTL-OPT.
  3338             20  CF-USER2-OPT-SEQ           PIC 9.
  3339                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3340                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3341             20  CF-USER2-SELECT OCCURS 3 TIMES
  3342                                            PIC X(10).
  3343         16  CF-USER3-CNTL-OPT.
  3344             20  CF-USER3-OPT-SEQ           PIC 9.
  3345                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3346                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3347             20  CF-USER3-SELECT OCCURS 3 TIMES
  3348                                            PIC X(10).
  3349         16  CF-USER4-CNTL-OPT.
  3350             20  CF-USER4-OPT-SEQ           PIC 9.
  3351                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3352                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3353             20  CF-USER4-SELECT OCCURS 3 TIMES
  3354                                            PIC X(10).
  3355         16  CF-USER5-CNTL-OPT.
  3356             20  CF-USER5-OPT-SEQ           PIC 9.
  3357                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3358                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL636.cbl
  3359             20  CF-USER5-SELECT OCCURS 3 TIMES
  3360                                            PIC X(10).
  3361         16  CF-REINS-CNTL-OPT.
  3362             20  CF-REINS-OPT-SEQ           PIC 9.
  3363                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3364                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3365             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3366                 24  CF-REINS-PRIME         PIC XXX.
  3367                 24  CF-REINS-SUB           PIC XXX.
  3368
  3369         16  CF-AGENT-CNTL-OPT.
  3370             20  CF-AGENT-OPT-SEQ           PIC 9.
  3371                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3372                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3373             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3374                                            PIC X(10).
  3375
  3376         16  FILLER                         PIC X(43).
  3377
  3378         16  CF-LOSS-RATIO-SELECT.
  3379             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3380             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3381         16  CF-ENTRY-DATE-SELECT.
  3382             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3383             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3384         16  CF-EFFECTIVE-DATE-SELECT.
  3385             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3386             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3387
  3388         16  CF-EXCEPTION-LIST-IND          PIC X.
  3389             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3390
  3391         16  FILLER                         PIC X(318).
  3392
  3393****************************************************************
  3394*                  EXCEPTION REPORTING RECORD                  *
  3395****************************************************************
  3396
  3397     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3398         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3399             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3400
  3401         16  CF-COMBINED-LIFE-AH-OPT.
  3402             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3403             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3404             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3405             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3406
  3407         16  CF-LIFE-OPT.
  3408             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3409             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3410             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3411             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3412             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3413             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3414             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3415             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3416             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL636.cbl
  3417             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3418
  3419         16  CF-AH-OPT.
  3420             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3421             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3422             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3423             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3424             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3425             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3426             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3427             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3428             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3429             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3430
  3431         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3432             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3433             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3434             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3435
  3436         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3437
  3438         16  FILLER                         PIC X(673).
  3439
  3440
  3441****************************************************************
  3442*             MORTGAGE SYSTEM PLAN RECORD                      *
  3443****************************************************************
  3444
  3445     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3446         16  CF-PLAN-TYPE                   PIC X.
  3447             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3448             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3449             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3450         16  CF-PLAN-ABBREV                 PIC XXX.
  3451         16  CF-PLAN-DESCRIPT               PIC X(10).
  3452         16  CF-PLAN-NOTES                  PIC X(20).
  3453         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3454         16  CF-PLAN-UNDERWRITING.
  3455             20  CF-PLAN-TERM-DATA.
  3456                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3457                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3458             20  CF-PLAN-AGE-DATA.
  3459                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3460                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3461                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3462             20  CF-PLAN-BENEFIT-DATA.
  3463                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3464                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3465                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3466                                            PIC S9(7)V99  COMP-3.
  3467         16  CF-PLAN-POLICY-FORMS.
  3468             20  CF-POLICY-FORM             PIC X(12).
  3469             20  CF-MASTER-APPLICATION      PIC X(12).
  3470             20  CF-MASTER-POLICY           PIC X(12).
  3471         16  CF-PLAN-RATING.
  3472             20  CF-RATE-CODE               PIC X(5).
  3473             20  CF-SEX-RATING              PIC X.
  3474                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL636.cbl
  3475                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3476             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3477             20  CF-SUB-STD-TYPE            PIC X.
  3478                 88  CF-PCT-OF-PREM            VALUE '1'.
  3479                 88  CF-PCT-OF-BENE            VALUE '2'.
  3480         16  CF-PLAN-PREM-TOLERANCES.
  3481             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3482             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3483         16  CF-PLAN-PYMT-TOLERANCES.
  3484             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3485             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3486         16  CF-PLAN-MISC-DATA.
  3487             20  FILLER                     PIC X.
  3488             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3489             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3490         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3491         16  CF-PLAN-IND-GRP                PIC X.
  3492             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3493                                                     '1'.
  3494             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3495                                                     '2'.
  3496         16  CF-MIB-SEARCH-SW               PIC X.
  3497             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3498             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3499             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3500             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3501         16  CF-ALPHA-SEARCH-SW             PIC X.
  3502             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3503             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3504             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3505             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3506             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3507             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3508             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3509             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3510             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3511             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3512                                                     'A' 'B' 'C'
  3513                                                     'X' 'Y' 'Z'.
  3514         16  CF-EFF-DT-RULE-SW              PIC X.
  3515             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3516             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3517             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3518             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3519             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3520         16  FILLER                         PIC X(4).
  3521         16  CF-HEALTH-QUESTIONS            PIC X.
  3522             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3523         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3524         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3525         16  CF-PLAN-SNGL-JNT               PIC X.
  3526             88  CF-COMBINED-PLAN              VALUE 'C'.
  3527             88  CF-JNT-PLAN                   VALUE 'J'.
  3528             88  CF-SNGL-PLAN                  VALUE 'S'.
  3529         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3530         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3531         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3532         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL636.cbl
  3533         16  CF-RERATE-CNTL                 PIC  X.
  3534             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3535             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3536             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3537             88  CF-AUTO-RECALC                 VALUE '4'.
  3538         16  CF-BENEFIT-TYPE                PIC  X.
  3539             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3540             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3541         16  CF-POLICY-FEE                  PIC S999V99
  3542                                                    COMP-3.
  3543         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3544         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3545         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3546         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3547         16  FILLER                         PIC  X(32).
  3548         16  CF-TERMINATION-FORM            PIC  X(04).
  3549         16  FILLER                         PIC  X(08).
  3550         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3551                                                       COMP-3.
  3552         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3553         16  CF-ISSUE-LETTER                PIC  X(4).
  3554         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3555         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3556             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3557             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3558         16  CF-MP-REFUND-CALC              PIC X.
  3559             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3560             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3561             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3562             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3563             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3564             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3565             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3566             88  CF-MP-REFD-MEAN                VALUE '8'.
  3567         16  CF-ALT-RATE-CODE               PIC  X(5).
  3568
  3569
  3570         16  FILLER                         PIC X(498).
  3571****************************************************************
  3572*             MORTGAGE COMPANY MASTER RECORD                   *
  3573****************************************************************
  3574
  3575     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3576         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3577         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3578             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3579             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3580             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3581             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3582             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3583
  3584         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3585         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3586         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3587         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3588         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3589
  3590         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL636.cbl
  3591             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3592         16  CF-MP-RECON-USE-IND            PIC X(1).
  3593             88  CF-MP-USE-RECON             VALUE 'Y'.
  3594         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3595             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3596         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3597             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3598             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3599         16  FILLER                         PIC X(1).
  3600         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3601             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3602         16  CF-MORTG-MIB-VERSION           PIC X.
  3603             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3604             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3605             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3606         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3607             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3608                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3609             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3610                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3611             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3612                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3613             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3614                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3615             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3616                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3617             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3618                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3619         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3620         16  FILLER                         PIC X(7).
  3621         16  CF-MORTG-DESTINATION-SYMBOL.
  3622             20  CF-MORTG-MIB-COMM          PIC X(5).
  3623             20  CF-MORTG-MIB-TERM          PIC X(5).
  3624         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3625             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3626         16  FILLER                         PIC X(03).
  3627         16  CF-MP-CHECK-NO-CONTROL.
  3628             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3629                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3630                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3631                                                ' ' LOW-VALUES.
  3632                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3633                                               VALUE '3'.
  3634         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3635         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3636         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3637             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3638                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3639             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3640                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3641             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3642                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3643             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3644                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3645             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3646                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3647             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3648                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL636.cbl
  3649         16  CF-MORTG-BILLING-AREA.
  3650             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3651                                            PIC X.
  3652         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3653         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3654         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3655         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3656             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3657             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3658         16  FILLER                         PIC X.
  3659         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3660             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3661             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3662         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3663         16  FILLER                         PIC X(8).
  3664         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3665         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3666         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3667         16  CF-ACH-COMPANY-ID.
  3668             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3669                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3670                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3671                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3672             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3673         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3674             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3675         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3676             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3677             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3678         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3679         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3680         16  FILLER                         PIC X(536).
  3681
  3682****************************************************************
  3683*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3684****************************************************************
  3685
  3686     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3687         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3688             20  CF-FEMALE-HEIGHT.
  3689                 24  CF-FEMALE-FT           PIC 99.
  3690                 24  CF-FEMALE-IN           PIC 99.
  3691             20  CF-FEMALE-MIN-WT           PIC 999.
  3692             20  CF-FEMALE-MAX-WT           PIC 999.
  3693         16  FILLER                         PIC X(428).
  3694
  3695     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3696         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3697             20  CF-MALE-HEIGHT.
  3698                 24  CF-MALE-FT             PIC 99.
  3699                 24  CF-MALE-IN             PIC 99.
  3700             20  CF-MALE-MIN-WT             PIC 999.
  3701             20  CF-MALE-MAX-WT             PIC 999.
  3702         16  FILLER                         PIC X(428).
  3703******************************************************************
  3704*             AUTOMATIC ACTIVITY RECORD                          *
  3705******************************************************************
  3706     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL636.cbl
  3707         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3708             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3709             20  CF-SYS-LETTER-ID           PIC X(04).
  3710             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3711             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3712             20  CF-SYS-RESET-SW            PIC X(01).
  3713             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3714             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3715
  3716         16  FILLER                         PIC X(50).
  3717
  3718         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3719             20  CF-USER-ACTIVE-SW          PIC X(01).
  3720             20  CF-USER-LETTER-ID          PIC X(04).
  3721             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3722             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3723             20  CF-USER-RESET-SW           PIC X(01).
  3724             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3725             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3726             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3727
  3728         16  FILLER                         PIC X(246).
  3729
  3730
  3731 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  3732                          CHECK-WORK-RECORDS COMM-CHECK-RECORDS
  3733                          COMPENSATION-MASTER CONTROL-FILE.
  3734 0000-DFHEXIT SECTION.
  3735     MOVE '9#                    $   ' TO DFHEIV0.
  3736     MOVE 'EL636' TO DFHEIV1.
  3737     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3738
  3739     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  3740     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  3741
  3742     IF EIBCALEN = 0
  3743         GO TO 8800-UNAUTHORIZED-ACCESS.
  3744
  3745     MOVE EIBTRMID               TO QID-TERM.
  3746     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  3747     MOVE '5'                    TO DC-OPTION-CODE.
  3748     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  3749     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  3750     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT.
  3751     MOVE ZEROS                  TO WS-NOFIRST.
  3752
  3753     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  3754         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  3755     ELSE
  3756         MOVE SPACES             TO RETURNED-FROM.
  3757
  3758     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3759         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3760             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3761             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3762             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3763             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3764             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL636.cbl
  3765             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3766             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3767             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  3768         ELSE
  3769             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  3770             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  3771             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  3772             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  3773             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  3774             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  3775             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  3776             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  3777
  3778     MOVE LOW-VALUES             TO EL636AI.
  3779
  3780     IF EIBTRNID NOT = TRANS-EXJA
  3781         IF RETURNED-FROM EQUAL XCTL-EL6361
  3782             GO TO 5000-DISPLAY-PAYEE
  3783         ELSE
  3784             MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  3785             MOVE PI-COMPANY-CD       TO PI-ERCKWK-COMP-CD
  3786             MOVE +0                  TO PI-ERCKWK-SEQ-NO
  3787             MOVE +0                  TO PI-NO-ENTRIES-DISPLAYED
  3788             GO TO 8100-SEND-INITIAL-MAP.
  3789
  3790
  3791* EXEC CICS HANDLE CONDITION
  3792*        PGMIDERR  (9600-PGMID-ERROR)
  3793*        ERROR     (9990-ABEND)
  3794*    END-EXEC.
  3795*    MOVE '"$L.                  ! " #00003786' TO DFHEIV0
  3796     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3797     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3798     MOVE X'2220233030303033373836' TO DFHEIV0(25:11)
  3799     CALL 'kxdfhei1' USING DFHEIV0
  3800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3801
  3802
  3803     IF EIBAID = DFHCLEAR
  3804         GO TO 9400-CLEAR.
  3805
  3806     IF PI-PROCESSOR-ID = 'LGXX'
  3807         GO TO 0200-RECEIVE.
  3808
  3809
  3810* EXEC CICS READQ TS
  3811*        QUEUE  (QID)
  3812*        INTO   (SECURITY-CONTROL)
  3813*        LENGTH (SC-COMM-LENGTH)
  3814*        ITEM   (SC-ITEM)
  3815*    END-EXEC.
  3816*    MOVE '*$II   L              ''   #00003797' TO DFHEIV0
  3817     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3818     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3819     MOVE X'2020233030303033373937' TO DFHEIV0(25:11)
  3820     CALL 'kxdfhei1' USING DFHEIV0,
  3821           QID,
  3822           SECURITY-CONTROL,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL636.cbl
  3823           SC-COMM-LENGTH,
  3824           SC-ITEM,
  3825           DFHEIV99,
  3826           DFHEIV99
  3827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3828
  3829
  3830     MOVE SC-CREDIT-DISPLAY (6)   TO PI-DISPLAY-CAP.
  3831     MOVE SC-CREDIT-UPDATE  (6)   TO PI-MODIFY-CAP.
  3832
  3833     IF NOT DISPLAY-CAP
  3834         MOVE 'READ'          TO SM-READ
  3835         PERFORM 9995-SECURITY-VIOLATION
  3836         MOVE ER-0070         TO  EMI-ERROR
  3837         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3838         GO TO 8100-SEND-INITIAL-MAP.
  3839
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL636.cbl
  3841
  3842******************************************************************
  3843*                                                                *
  3844*              R E C E I V E   M A P                             *
  3845*                                                                *
  3846******************************************************************
  3847
  3848 0200-RECEIVE.
  3849
  3850     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  3851         MOVE ER-0008            TO EMI-ERROR
  3852         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3853         MOVE -1                 TO MAINTL
  3854         GO TO 8200-SEND-DATAONLY.
  3855
  3856
  3857* EXEC CICS RECEIVE
  3858*        MAP      (EL636A)
  3859*        MAPSET   (MAPSET-EL636S)
  3860*        INTO     (EL636AI)
  3861*    END-EXEC.
  3862     MOVE LENGTH OF
  3863      EL636AI
  3864       TO DFHEIV11
  3865*    MOVE '8"T I  L              ''   #00003830' TO DFHEIV0
  3866     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3867     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3868     MOVE X'2020233030303033383330' TO DFHEIV0(25:11)
  3869     CALL 'kxdfhei1' USING DFHEIV0,
  3870           EL636A,
  3871           EL636AI,
  3872           DFHEIV11,
  3873           MAPSET-EL636S,
  3874           DFHEIV99,
  3875           DFHEIV99
  3876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3877
  3878
  3879
  3880     IF PFENTERL GREATER THAN ZERO
  3881        IF EIBAID NOT = DFHENTER
  3882           MOVE ER-0004          TO EMI-ERROR
  3883           MOVE AL-UNBOF         TO PFENTERA
  3884           MOVE -1               TO PFENTERL
  3885           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3886           GO TO 8200-SEND-DATAONLY
  3887        ELSE
  3888           IF PFENTERI NUMERIC AND
  3889              PFENTERI GREATER 0 AND LESS 25
  3890              MOVE PF-VALUES (PFENTERI) TO EIBAID
  3891           ELSE
  3892              MOVE ER-0029       TO EMI-ERROR
  3893              MOVE AL-UNBOF      TO PFENTERA
  3894              MOVE -1            TO PFENTERL
  3895              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3896              GO TO 8200-SEND-DATAONLY.
  3897
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL636.cbl
  3899
  3900******************************************************************
  3901*                                                                *
  3902*              C H E C K   P F K E Y S                           *
  3903*                                                                *
  3904******************************************************************
  3905
  3906 0300-CHECK-PFKEYS.
  3907
  3908     IF EIBAID = DFHPF23
  3909         GO TO 8810-PF23.
  3910
  3911     IF EIBAID = DFHPF24
  3912         GO TO 9200-RETURN-MAIN-MENU.
  3913
  3914     IF EIBAID = DFHPF12
  3915         GO TO 9500-PF12.
  3916
  3917     IF EIBAID = DFHPF1
  3918         GO TO 6000-DISPLAY-NEXT-PAYEE.
  3919
  3920     IF EIBAID = DFHPF2
  3921         GO TO 6100-DISPLAY-PREV-PAYEE.
  3922
  3923     IF EIBAID = DFHPF3
  3924         IF PI-LAST-STUB-KEY NOT EQUAL SPACES
  3925             GO TO 5000-DISPLAY-PAYEE.
  3926
  3927     IF EIBAID = DFHPF4
  3928         IF PI-STUB-KEY (1) NOT EQUAL SPACES
  3929             GO TO 6600-DISPLAY-PREV-ENTRIES.
  3930
  3931     IF EIBAID = DFHPF5
  3932         GO TO 7000-RELEASE-ENTRIES.
  3933
  3934     IF EIBAID = DFHPF6
  3935         MOVE LOW-VALUES         TO EL636AI
  3936         MOVE 'A'                TO MAINTI
  3937                                    PI-MAINT-FUNCTION
  3938         MOVE AL-UANON           TO MAINTA
  3939         GO TO 8100-SEND-INITIAL-MAP.
  3940
  3941     IF EIBAID = DFHPF7
  3942        IF MAINTI = 'D'
  3943           GO TO 1000-EDIT-MAP.
  3944
  3945     IF EIBAID = DFHPF8
  3946         GO TO 8820-PF08.
  3947
  3948     IF EIBAID = DFHENTER
  3949         GO TO 1000-EDIT-MAP.
  3950
  3951     MOVE ER-0008 TO EMI-ERROR.
  3952     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3953     MOVE -1                     TO PFENTERL.
  3954
  3955     GO TO 8200-SEND-DATAONLY.
  3956
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL636.cbl
  3958
  3959******************************************************************
  3960*                                                                *
  3961*                  E D I T    M A P                              *
  3962*                                                                *
  3963******************************************************************
  3964
  3965 1000-EDIT-MAP.
  3966
  3967     IF MAINTI = 'C' OR 'D' OR 'S' OR 'A' OR 'V'
  3968        MOVE MAINTI              TO PI-MAINT-FUNCTION
  3969        MOVE AL-UANON            TO MAINTA
  3970     ELSE
  3971        MOVE ER-0023             TO EMI-ERROR
  3972        MOVE -1                  TO MAINTL
  3973        MOVE AL-UABON            TO MAINTA
  3974        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3975        GO TO 8200-SEND-DATAONLY.
  3976
  3977     IF PAYSEQL GREATER THAN 0
  3978          MOVE PAYSEQI           TO WS-PAY-SEQ-NUM
  3979     ELSE
  3980          MOVE +1                TO WS-PAY-SEQ-NUM.
  3981
  3982     IF MAINTI = 'S' AND
  3983        NOFIRSTL GREATER THAN 0
  3984        IF NOFIRSTI NUMERIC
  3985            MOVE NOFIRSTI          TO WS-NOFIRST
  3986        ELSE
  3987            MOVE -1                  TO NOFIRSTL
  3988            MOVE ER-2223             TO EMI-ERROR
  3989            MOVE AL-UNBON            TO NOFIRSTA
  3990            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3991
  3992     IF MAINTI = 'C' OR 'D' OR 'V'
  3993        IF PI-COMPANY-CD   = PI-SVCKWK-COMP-CD  AND
  3994           CSRI            = PI-SVCKWK-CSR      AND
  3995           CARI            = PI-SVCKWK-CARRIER  AND
  3996           GROUPI          = PI-SVCKWK-GROUPING AND
  3997           PAYEEI          = PI-SVCKWK-PAYEE    AND
  3998           WS-PAY-SEQ-NUM  = PI-SVCKWK-PAYEE-SEQ
  3999           NEXT SENTENCE
  4000        ELSE
  4001           MOVE ER-2056             TO EMI-ERROR
  4002           MOVE -1                  TO MAINTL
  4003           MOVE AL-UABON            TO MAINTA
  4004           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4005           GO TO 8200-SEND-DATAONLY.
  4006
  4007     IF MAINTI = 'D'
  4008        IF EIBAID = DFHPF7
  4009           MOVE MAINTI              TO PI-MAINT-FUNCTION
  4010           MOVE AL-UANON            TO MAINTA
  4011        ELSE
  4012           MOVE ER-3147             TO EMI-ERROR
  4013           MOVE -1                  TO MAINTL
  4014           MOVE AL-UABON            TO MAINTA
  4015           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL636.cbl
  4016           GO TO 8200-SEND-DATAONLY.
  4017
  4018     IF NOT MODIFY-CAP
  4019        IF MAINTI = 'S'
  4020           MOVE MAINTI              TO PI-MAINT-FUNCTION
  4021        ELSE
  4022           MOVE 'UPDATE'            TO SM-READ
  4023           PERFORM 9995-SECURITY-VIOLATION
  4024           MOVE ER-0070             TO EMI-ERROR
  4025           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4026           GO TO 8100-SEND-INITIAL-MAP.
  4027
  4028     IF MAINTI = 'S' OR 'D' OR 'V'
  4029        GO TO 1050-EDIT-COMPLETE.
  4030
  4031     IF CARL GREATER THAN ZERO
  4032        MOVE AL-UANON            TO CARA
  4033     ELSE
  4034        MOVE -1                  TO CARL
  4035        MOVE ER-0194             TO EMI-ERROR
  4036        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4037
  4038     IF GROUPL GREATER THAN ZEROS
  4039        MOVE AL-UANON            TO GROUPA
  4040     ELSE
  4041        MOVE -1                  TO GROUPL
  4042        MOVE ER-0195             TO EMI-ERROR
  4043        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4044
  4045     IF PAYEEL GREATER THAN ZEROS
  4046        MOVE AL-UANON            TO PAYEEA
  4047     ELSE
  4048        MOVE -1                  TO PAYEEL
  4049        MOVE ER-3148             TO EMI-ERROR
  4050        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4051
  4052     IF CSRL GREATER THAN ZERO
  4053        MOVE AL-UANON            TO CSRA
  4054        PERFORM 1600-READ-CNTL-FILE  THRU 1690-EXIT.
  4055
  4056
  4057     IF PAYTOL  GREATER THAN ZEROS
  4058        MOVE AL-UANON            TO PAYTOA.
  4059
  4060     IF ADDRS1L GREATER THAN ZEROS
  4061        MOVE AL-UANON            TO ADDRS1A.
  4062
  4063     IF ADDRS2L GREATER THAN ZEROS
  4064        MOVE AL-UANON            TO ADDRS2A.
  4065
  4066     IF CITYSTL GREATER THAN ZEROS
  4067        MOVE AL-UANON            TO CITYSTA.
  4068
  4069     IF ZIPL    GREATER THAN ZEROS
  4070        MOVE AL-UANON            TO ZIPA.
  4071
  4072     IF ZIPEXTL GREATER THAN ZEROS
  4073        MOVE AL-UANON            TO ZIPEXTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL636.cbl
  4074
  4075     MOVE +0                     TO WS-SUB1.
  4076
  4077 1025-EDIT-STUB-INFO.
  4078
  4079     ADD +1                      TO WS-SUB1.
  4080
  4081     IF WS-SUB1 GREATER THAN +5
  4082        GO TO 1050-EDIT-COMPLETE.
  4083
  4084     IF CK-MAINT-LEN (WS-SUB1) NOT GREATER THAN ZEROS
  4085         IF CK-AGENT-LEN (WS-SUB1)   GREATER THAN ZERO  OR
  4086            CK-COMNTS-LEN (WS-SUB1)  GREATER THAN ZERO  OR
  4087            CK-INVREF-LEN (WS-SUB1)  GREATER THAN ZERO  OR
  4088            CK-LEDGER-LEN (WS-SUB1)  GREATER THAN ZERO  OR
  4089            CK-AGOCD-LEN  (WS-SUB1)  GREATER THAN ZERO  OR
  4090            CK-DETAMT-LEN (WS-SUB1)  GREATER THAN ZERO
  4091             NEXT SENTENCE
  4092         ELSE
  4093             GO TO 1025-EDIT-STUB-INFO.
  4094
  4095     IF PI-COMPANY-ID = 'NSL' AND
  4096         CK-MAINT (WS-SUB1) = 'H'
  4097             MOVE ER-0023        TO EMI-ERROR
  4098             MOVE -1             TO CK-MAINT-LEN    (WS-SUB1)
  4099             MOVE AL-UABON       TO CK-MAINT-ATTRB  (WS-SUB1)
  4100             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4101     ELSE
  4102         IF CK-MAINT (WS-SUB1) = 'A' OR 'C' OR 'D' OR 'I'
  4103                                     OR 'R' OR 'N' OR 'H'
  4104             MOVE AL-UANON       TO CK-MAINT-ATTRB  (WS-SUB1)
  4105         ELSE
  4106             MOVE ER-0023        TO EMI-ERROR
  4107             MOVE -1             TO CK-MAINT-LEN    (WS-SUB1)
  4108             MOVE AL-UABON       TO CK-MAINT-ATTRB  (WS-SUB1)
  4109             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4110
  4111     IF (CK-MAINT-LEN (WS-SUB1) GREATER THAN ZEROS) AND
  4112            (CK-MAINT (WS-SUB1) = 'H')
  4113         IF CK-AGENT-LEN (WS-SUB1)   GREATER THAN ZERO  OR
  4114            CK-COMNTS-LEN (WS-SUB1)  GREATER THAN ZERO  OR
  4115            CK-INVREF-LEN (WS-SUB1)  GREATER THAN ZERO  OR
  4116            CK-LEDGER-LEN (WS-SUB1)  GREATER THAN ZERO  OR
  4117            CK-AGOCD-LEN  (WS-SUB1)  GREATER THAN ZERO  OR
  4118            CK-DETAMT-LEN (WS-SUB1)  GREATER THAN ZERO
  4119              MOVE ER-7804          TO EMI-ERROR
  4120              MOVE -1               TO CK-MAINT-LEN    (WS-SUB1)
  4121              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4122         ELSE
  4123              GO TO 1025-EDIT-STUB-INFO.
  4124
  4125     IF CK-MAINT        (WS-SUB1) = 'D'
  4126         GO TO 1025-EDIT-STUB-INFO.
  4127
  4128******    TO DISTINGUISH BETWEEN AN R OR I USED AS A CHANGE OR
  4129******    AN ADDITION CHANGE I TO J AND R TO S FOR AN ADD
  4130     IF CK-MAINT (WS-SUB1) = 'I' AND
  4131        WS-SUB1 GREATER THAN PI-NO-ENTRIES-DISPLAYED
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL636.cbl
  4132         MOVE 'J' TO CK-MAINT (WS-SUB1).
  4133
  4134     IF CK-MAINT (WS-SUB1) = 'R' AND
  4135        WS-SUB1 GREATER THAN PI-NO-ENTRIES-DISPLAYED
  4136         MOVE 'S' TO CK-MAINT (WS-SUB1).
  4137
  4138**********************
  4139
  4140     IF CK-INVREF-LEN (WS-SUB1)  GREATER THAN ZEROS
  4141         IF CK-MAINT  (WS-SUB1) = 'R' OR 'I' OR 'J' OR 'S'
  4142             NEXT SENTENCE
  4143         ELSE
  4144           MOVE ER-3189          TO EMI-ERROR
  4145           MOVE -1               TO CK-INVREF-LEN   (WS-SUB1)
  4146           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4147
  4148     IF CK-MAINT  (WS-SUB1) = 'R' OR 'I' OR 'J' OR 'S'
  4149         IF CK-INVREF (WS-SUB1)  NOT EQUAL LOW-VALUES
  4150             NEXT SENTENCE
  4151         ELSE
  4152           MOVE ER-3256          TO EMI-ERROR
  4153           MOVE -1               TO CK-INVREF-LEN   (WS-SUB1)
  4154           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4155
  4156     IF CK-MAINT        (WS-SUB1) = 'N' AND
  4157        MAINTI                    = ('A' OR 'C')
  4158        IF CK-INVREF-LEN (WS-SUB1)  GREATER THAN ZEROS
  4159           MOVE ER-3173          TO EMI-ERROR
  4160           MOVE -1               TO CK-INVREF-LEN   (WS-SUB1)
  4161           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4162
  4163     IF CK-AGOCD-LEN (WS-SUB1) GREATER THAN ZERO
  4164         IF CK-AGOCD (WS-SUB1)  EQUAL 'A' OR 'G' OR 'O'
  4165             NEXT SENTENCE
  4166         ELSE
  4167             MOVE ER-3146          TO EMI-ERROR
  4168             MOVE -1               TO CK-AGOCD-LEN   (WS-SUB1)
  4169             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4170
  4171     IF CK-AGOCD (WS-SUB1) EQUAL 'A'
  4172         IF CK-AGENT (WS-SUB1) GREATER THAN SPACES
  4173             NEXT SENTENCE
  4174         ELSE
  4175             MOVE ER-3190          TO EMI-ERROR
  4176             MOVE -1               TO CK-AGENT-LEN   (WS-SUB1)
  4177             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4178
  4179     IF CK-MAINT    (WS-SUB1) = 'A' OR 'J' OR 'S'
  4180         IF CK-AGOCD-LEN  (WS-SUB1)  GREATER THAN ZERO
  4181             NEXT SENTENCE
  4182         ELSE
  4183             MOVE ER-3146          TO EMI-ERROR
  4184             MOVE -1               TO CK-AGOCD-LEN   (WS-SUB1)
  4185             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4186
  4187     IF CK-MAINT    (WS-SUB1) = 'R' OR 'I' OR 'J' OR 'S'
  4188         IF CK-AGOCD-LEN  (WS-SUB1)  GREATER THAN ZERO
  4189             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL636.cbl
  4190         ELSE
  4191             IF CK-AGOCD (WS-SUB1) = SPACE OR LOW-VALUE
  4192                 NEXT SENTENCE
  4193             ELSE
  4194                 MOVE ER-3146      TO EMI-ERROR
  4195                 MOVE -1           TO CK-AGOCD-LEN   (WS-SUB1)
  4196                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4197
  4198     IF CK-LEDGER-LEN (WS-SUB1) GREATER THAN ZEROS
  4199        MOVE AL-UANON            TO  CK-LEDGER-LEN  (WS-SUB1).
  4200
  4201     IF CK-MAINT (WS-SUB1)     = 'A' OR 'C' OR 'N'
  4202         IF PI-COMPANY-ID = 'CRI'
  4203             IF CK-LEDGER-LEN (WS-SUB1) GREATER THAN ZEROS
  4204                PERFORM 1500-VERIFY-LEDGER THRU 1590-EXIT
  4205             ELSE
  4206                 MOVE ER-3149    TO EMI-ERROR
  4207                 MOVE -1         TO CK-LEDGER-LEN    (WS-SUB1)
  4208                 MOVE AL-UABON   TO CK-LEDGER-ATTRB  (WS-SUB1)
  4209                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4210
  4211     IF CK-MAINT (WS-SUB1)     = 'R'  AND MAINTI = 'A'
  4212         IF PI-COMPANY-ID = 'CRI'
  4213             IF CK-LEDGER-LEN (WS-SUB1) GREATER THAN ZEROS
  4214                PERFORM 1500-VERIFY-LEDGER THRU 1590-EXIT
  4215             ELSE
  4216                MOVE ER-3149     TO EMI-ERROR
  4217                MOVE -1          TO CK-LEDGER-LEN    (WS-SUB1)
  4218                MOVE AL-UABON    TO CK-LEDGER-ATTRB  (WS-SUB1)
  4219                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4220
  4221     IF CK-DETAMT-LEN (WS-SUB1)  GREATER THAN ZEROS
  4222        MOVE CK-DETAMT-IN (WS-SUB1) TO DEEDIT-FIELD
  4223        PERFORM 8600-DEEDIT
  4224        IF DEEDIT-FIELD-V2 NUMERIC AND
  4225           DEEDIT-FIELD-V2 NOT EQUAL ZERO
  4226           MOVE DEEDIT-FIELD-V2  TO WS-DETAMT       (WS-SUB1)
  4227           MOVE AL-UNNON         TO CK-DETAMT-ATTRB (WS-SUB1)
  4228        ELSE
  4229           MOVE ER-2223          TO EMI-ERROR
  4230           MOVE -1               TO CK-DETAMT-LEN   (WS-SUB1)
  4231           MOVE AL-UNBON         TO CK-DETAMT-ATTRB (WS-SUB1)
  4232           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4233
  4234     IF CK-MAINT (WS-SUB1) = 'A' OR 'N' OR 'J' OR 'S'
  4235        IF CK-DETAMT-LEN (WS-SUB1) GREATER THAN ZEROS
  4236           NEXT SENTENCE
  4237        ELSE
  4238           MOVE ER-3158          TO EMI-ERROR
  4239           MOVE -1               TO CK-DETAMT-LEN   (WS-SUB1)
  4240           MOVE AL-UABON         TO CK-DETAMT-ATTRB (WS-SUB1)
  4241           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4242
  4243     IF CK-MAINT (WS-SUB1)     = 'N'
  4244         GO TO 1025-EDIT-STUB-INFO.
  4245
  4246     IF CK-MAINT (WS-SUB1) = 'A' OR 'J' OR 'S'
  4247         IF CK-AGENT-LEN (WS-SUB1) GREATER THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL636.cbl
  4248             IF CK-AGENT (WS-SUB1) = SPACES OR LOW-VALUES
  4249                 MOVE '*'        TO  WS-SPACE-AGENT-SW
  4250                 PERFORM 1480-VERIFY-GA-ONLY  THRU  1490-EXIT
  4251                 GO TO 1040-STUB-EDIT-COMPLETE
  4252             ELSE
  4253                 PERFORM 1400-VERIFY-AGENT  THRU  1470-EXIT
  4254                 GO TO 1040-STUB-EDIT-COMPLETE
  4255         ELSE
  4256                 PERFORM 1480-VERIFY-GA-ONLY  THRU   1490-EXIT
  4257                 GO TO 1040-STUB-EDIT-COMPLETE.
  4258
  4259     IF CK-MAINT (WS-SUB1) = 'C' OR 'I' OR 'R'
  4260         IF CK-AGENT-LEN (WS-SUB1) GREATER THAN ZERO
  4261             IF CK-AGENT (WS-SUB1) = SPACES OR LOW-VALUES
  4262                 MOVE '*'        TO  WS-SPACE-AGENT-SW
  4263                 PERFORM 1480-VERIFY-GA-ONLY  THRU  1490-EXIT
  4264                 GO TO 1040-STUB-EDIT-COMPLETE
  4265             ELSE
  4266                 PERFORM 1400-VERIFY-AGENT  THRU  1470-EXIT
  4267                 GO TO 1040-STUB-EDIT-COMPLETE
  4268         ELSE
  4269             IF CK-AGOCD-LEN (WS-SUB1) GREATER THAN ZERO
  4270                 MOVE PI-STUB-ACCT (WS-SUB1)
  4271                                 TO  CK-AGENT (WS-SUB1)
  4272                 IF PI-STUB-ACCT (WS-SUB1) = SPACES OR LOW-VALUES
  4273                     MOVE '*'    TO  WS-SPACE-AGENT-SW
  4274                     PERFORM 1480-VERIFY-GA-ONLY  THRU  1490-EXIT
  4275                     GO TO 1040-STUB-EDIT-COMPLETE
  4276                 ELSE
  4277                     PERFORM 1400-VERIFY-AGENT  THRU  1470-EXIT
  4278                     GO TO 1040-STUB-EDIT-COMPLETE
  4279     ELSE
  4280         GO TO 1040-STUB-EDIT-COMPLETE.
  4281
  4282 1040-STUB-EDIT-COMPLETE.
  4283
  4284     IF CK-MAINT (WS-SUB1) = 'J'
  4285         MOVE 'I'               TO CK-MAINT (WS-SUB1).
  4286
  4287     IF CK-MAINT (WS-SUB1) = 'S'
  4288         MOVE 'R'               TO CK-MAINT (WS-SUB1).
  4289
  4290     GO TO 1025-EDIT-STUB-INFO.
  4291
  4292 1050-EDIT-COMPLETE.
  4293
  4294     IF CSRL GREATER THAN ZERO
  4295         MOVE CSRI              TO PI-ERCKWK-CSR
  4296     ELSE
  4297         MOVE HOLD-CSR          TO PI-ERCKWK-CSR
  4298                                   CSRI.
  4299
  4300     IF EMI-FATAL-CTR NOT = ZEROS
  4301         GO TO 8200-SEND-DATAONLY.
  4302
  4303     MOVE PI-COMPANY-CD          TO PI-ERCKWK-COMP-CD.
  4304     MOVE CARI                   TO PI-ERCKWK-CARRIER.
  4305     MOVE GROUPI                 TO PI-ERCKWK-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL636.cbl
  4306     MOVE PAYEEI                 TO PI-ERCKWK-PAYEE.
  4307     MOVE WS-PAY-SEQ-NUM         TO PI-ERCKWK-PAYEE-SEQ.
  4308
  4309     IF MAINTI = 'A'
  4310        GO TO 2000-ADD-PAYEE.
  4311
  4312     IF MAINTI = 'C'
  4313        GO TO 3000-CHANGE-PAYEE.
  4314
  4315     IF MAINTI = 'D'
  4316        GO TO 4000-DELETE-PAYEE.
  4317
  4318     IF MAINTI = 'S'
  4319        MOVE +0                  TO PI-ERCKWK-SEQ-NO
  4320        GO TO 5000-DISPLAY-PAYEE.
  4321
  4322     IF MAINTI = 'V'
  4323        GO TO 7500-VOID-COMM-CHECK.
  4324
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL636.cbl
  4326
  4327******************************************************************
  4328*                                                                *
  4329*      V E R I F Y   A G E N T  IS ON   C O M P.   M A S T E R   *
  4330*                                                                *
  4331******************************************************************
  4332
  4333 1400-VERIFY-AGENT.
  4334
  4335     MOVE PI-COMPANY-CD          TO ERCOMP-COMP-CD.
  4336     MOVE CARI                   TO ERCOMP-CARRIER.
  4337     MOVE GROUPI                 TO ERCOMP-GROUPING.
  4338     MOVE PAYEEI                 TO ERCOMP-FIN-RESP.
  4339
  4340     IF CK-AGOCD (WS-SUB1) = 'O'
  4341         GO TO 1430-SECOND-READ.
  4342
  4343     MOVE CK-AGENT (WS-SUB1)     TO ERCOMP-ACCT.
  4344     MOVE 'A'                    TO ERCOMP-RECORD-TYPE.
  4345
  4346 1420-FIRST-READ.
  4347
  4348
  4349* EXEC CICS HANDLE CONDITION
  4350*        NOTFND   (1420-FIRST-NOTFND)
  4351*        END-EXEC.
  4352*    MOVE '"$I                   ! # #00004305' TO DFHEIV0
  4353     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4355     MOVE X'2320233030303034333035' TO DFHEIV0(25:11)
  4356     CALL 'kxdfhei1' USING DFHEIV0
  4357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4358
  4359
  4360
  4361* EXEC CICS READ
  4362*         DATASET   (FILE-ID-ERCOMP)
  4363*         SET       (ADDRESS OF COMPENSATION-MASTER)
  4364*         RIDFLD    (ERCOMP-KEY)
  4365*    END-EXEC.
  4366*    MOVE '&"S        E          (   #00004309' TO DFHEIV0
  4367     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4368     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4369     MOVE X'2020233030303034333039' TO DFHEIV0(25:11)
  4370     CALL 'kxdfhei1' USING DFHEIV0,
  4371           FILE-ID-ERCOMP,
  4372           DFHEIV20,
  4373           DFHEIV99,
  4374           ERCOMP-KEY,
  4375           DFHEIV99,
  4376           DFHEIV99,
  4377           DFHEIV99
  4378     SET ADDRESS OF COMPENSATION-MASTER TO
  4379         DFHEIV20
  4380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4381
  4382
  4383     IF   CO-CSR-CODE  =  SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL636.cbl
  4384         MOVE LOW-VALUES         TO CO-CSR-CODE.
  4385
  4386     MOVE CO-CSR-CODE            TO HOLD-CSR.
  4387
  4388     IF CK-AGOCD (WS-SUB1) = 'A'
  4389         GO TO 1470-EXIT
  4390     ELSE
  4391         GO TO 1430-SECOND-READ.
  4392
  4393 1420-FIRST-NOTFND.
  4394
  4395     MOVE -1                     TO PAYEEL
  4396     MOVE ER-2869                TO EMI-ERROR
  4397     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4398     GO TO 1470-EXIT.
  4399
  4400 1430-SECOND-READ.
  4401
  4402
  4403* EXEC CICS HANDLE CONDITION
  4404*        NOTFND   (1440-SECOND-NOTFND)
  4405*        END-EXEC.
  4406*    MOVE '"$I                   ! $ #00004334' TO DFHEIV0
  4407     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4408     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4409     MOVE X'2420233030303034333334' TO DFHEIV0(25:11)
  4410     CALL 'kxdfhei1' USING DFHEIV0
  4411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4412
  4413
  4414     MOVE LOW-VALUES             TO ERCOMP-ACCT.
  4415     MOVE 'G'                    TO ERCOMP-RECORD-TYPE.
  4416
  4417
  4418* EXEC CICS READ
  4419*         DATASET   (FILE-ID-ERCOMP)
  4420*         SET       (ADDRESS OF COMPENSATION-MASTER)
  4421*         RIDFLD    (ERCOMP-KEY)
  4422*    END-EXEC.
  4423*    MOVE '&"S        E          (   #00004341' TO DFHEIV0
  4424     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4425     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4426     MOVE X'2020233030303034333431' TO DFHEIV0(25:11)
  4427     CALL 'kxdfhei1' USING DFHEIV0,
  4428           FILE-ID-ERCOMP,
  4429           DFHEIV20,
  4430           DFHEIV99,
  4431           ERCOMP-KEY,
  4432           DFHEIV99,
  4433           DFHEIV99,
  4434           DFHEIV99
  4435     SET ADDRESS OF COMPENSATION-MASTER TO
  4436         DFHEIV20
  4437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4438
  4439     IF   CO-CSR-CODE  =  SPACES
  4440         MOVE LOW-VALUES         TO CO-CSR-CODE.
  4441
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL636.cbl
  4442     MOVE CO-CSR-CODE            TO HOLD-CSR.
  4443     GO TO 1470-EXIT.
  4444
  4445 1440-SECOND-NOTFND.
  4446
  4447     MOVE -1                     TO PAYEEL.
  4448     MOVE ER-7043                TO EMI-ERROR.
  4449     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4450     GO TO 1470-EXIT.
  4451******************************************************************
  4452*      V E R I F Y   C O M P.   M A S T E R    IS ACH            *
  4453******************************************************************
  4454*                                                                *
  4455 1450-ACH-READ.
  4456
  4457
  4458* EXEC CICS HANDLE CONDITION
  4459*        NOTFND   (1440-SECOND-NOTFND)
  4460*        END-EXEC.
  4461*    MOVE '"$I                   ! % #00004364' TO DFHEIV0
  4462     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4463     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4464     MOVE X'2520233030303034333634' TO DFHEIV0(25:11)
  4465     CALL 'kxdfhei1' USING DFHEIV0
  4466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4467
  4468
  4469
  4470* EXEC CICS READ
  4471*         DATASET   (FILE-ID-ERCOMP)
  4472*         SET       (ADDRESS OF COMPENSATION-MASTER)
  4473*         RIDFLD    (ERCOMP-KEY)
  4474*    END-EXEC.
  4475*    MOVE '&"S        E          (   #00004368' TO DFHEIV0
  4476     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4477     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4478     MOVE X'2020233030303034333638' TO DFHEIV0(25:11)
  4479     CALL 'kxdfhei1' USING DFHEIV0,
  4480           FILE-ID-ERCOMP,
  4481           DFHEIV20,
  4482           DFHEIV99,
  4483           ERCOMP-KEY,
  4484           DFHEIV99,
  4485           DFHEIV99,
  4486           DFHEIV99
  4487     SET ADDRESS OF COMPENSATION-MASTER TO
  4488         DFHEIV20
  4489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4490
  4491
  4492*COMPENSATION MASTER IS ACH PROCESSING WHEN CO-ACH-STATUS = 'A'
  4493     MOVE SPACE                  TO ERCOMP-SW.
  4494     IF   CO-ACH-STATUS    = 'A'
  4495         MOVE 'P'                TO ERCOMP-SW.
  4496
  4497     GO TO 1470-EXIT.
  4498 1470-EXIT.
  4499     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL636.cbl
  4501
  4502******************************************************************
  4503*                                                                *
  4504*      V E R I F Y   G A   ONLY IS ON   C O M P.   M A S T E R   *
  4505*                                                                *
  4506******************************************************************
  4507 1480-VERIFY-GA-ONLY.
  4508
  4509     IF WS-SPACE-AGENT-SW   =  '*'
  4510         NEXT SENTENCE
  4511     ELSE
  4512         IF CK-AGENT (WS-SUB1)  =  SPACES OR LOW-VALUES
  4513             NEXT SENTENCE
  4514         ELSE
  4515             GO TO 1489-CLEAR.
  4516
  4517     IF CK-MAINT (WS-SUB1)  =  'N'
  4518         GO TO 1489-CLEAR.
  4519
  4520     MOVE PI-COMPANY-CD          TO ERCOMP-COMP-CD.
  4521     MOVE CARI                   TO ERCOMP-CARRIER.
  4522     MOVE GROUPI                 TO ERCOMP-GROUPING.
  4523     MOVE PAYEEI                 TO ERCOMP-FIN-RESP.
  4524     MOVE LOW-VALUES             TO ERCOMP-ACCT.
  4525     MOVE 'G'                    TO ERCOMP-RECORD-TYPE.
  4526
  4527
  4528* EXEC CICS HANDLE CONDITION
  4529*        NOTFND   (1485-NO-COMP-MSTR)
  4530*        END-EXEC.
  4531*    MOVE '"$I                   ! & #00004409' TO DFHEIV0
  4532     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4533     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4534     MOVE X'2620233030303034343039' TO DFHEIV0(25:11)
  4535     CALL 'kxdfhei1' USING DFHEIV0
  4536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4537
  4538
  4539
  4540* EXEC CICS READ
  4541*         DATASET   (FILE-ID-ERCOMP)
  4542*         SET       (ADDRESS OF COMPENSATION-MASTER)
  4543*         RIDFLD    (ERCOMP-KEY)
  4544*    END-EXEC.
  4545*    MOVE '&"S        E          (   #00004413' TO DFHEIV0
  4546     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4547     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4548     MOVE X'2020233030303034343133' TO DFHEIV0(25:11)
  4549     CALL 'kxdfhei1' USING DFHEIV0,
  4550           FILE-ID-ERCOMP,
  4551           DFHEIV20,
  4552           DFHEIV99,
  4553           ERCOMP-KEY,
  4554           DFHEIV99,
  4555           DFHEIV99,
  4556           DFHEIV99
  4557     SET ADDRESS OF COMPENSATION-MASTER TO
  4558         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL636.cbl
  4559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4560
  4561
  4562     IF CO-AR-BAL-LEVEL  =  '4'
  4563        IF CK-INVREF-LEN (WS-SUB1)  GREATER THAN ZEROS
  4564            MOVE -1             TO CK-AGENT-LEN (WS-SUB1)
  4565            MOVE ER-3164        TO EMI-ERROR
  4566            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4567            GO TO 1489-CLEAR
  4568        ELSE
  4569            GO TO 1489-CLEAR
  4570     ELSE
  4571         IF CO-AR-BAL-LEVEL  =  '3'
  4572             MOVE -1             TO CK-AGENT-LEN (WS-SUB1)
  4573             MOVE ER-7082        TO EMI-ERROR
  4574             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4575             GO TO 1489-CLEAR
  4576            IF CK-INVREF-LEN (WS-SUB1)  GREATER THAN ZEROS
  4577                MOVE -1          TO CK-AGENT-LEN (WS-SUB1)
  4578                MOVE ER-3164     TO EMI-ERROR
  4579                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4580                GO TO 1489-CLEAR
  4581            ELSE
  4582                GO TO 1489-CLEAR
  4583         ELSE
  4584             IF CO-AR-BAL-LEVEL  =  '1'  OR '2'
  4585                 MOVE -1         TO CK-AGENT-LEN (WS-SUB1)
  4586                 MOVE ER-7082    TO EMI-ERROR
  4587                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4588                 GO TO 1489-CLEAR
  4589             ELSE
  4590                 GO TO 1489-CLEAR.
  4591
  4592 1485-NO-COMP-MSTR.
  4593
  4594     MOVE -1                     TO PAYEEL.
  4595     MOVE ER-3179                TO EMI-ERROR.
  4596     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4597
  4598 1489-CLEAR.
  4599     MOVE  SPACES                TO  WS-SPACE-AGENT-SW.
  4600
  4601 1490-EXIT.
  4602     EXIT.
  4603
  4604
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL636.cbl
  4606
  4607******************************************************************
  4608*                                                                *
  4609*          V E R I F Y   L E D G E R   N U M B E R               *
  4610*                                                                *
  4611******************************************************************
  4612
  4613 1500-VERIFY-LEDGER.
  4614 1590-EXIT.
  4615      EXIT.
  4616
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL636.cbl
  4618
  4619 1600-READ-CNTL-FILE.
  4620*****  NCL REQUIRES A CSR CODE WHICH IS VALIDATED TO THE  *****
  4621*****  USER IDENTIFICATION FILE. CSR CODES CAN BE WITHOUT *****
  4622*****  VALIDATION.                                        *****
  4623
  4624     IF   PI-COMPANY-ID  =  'NCL'
  4625         NEXT SENTENCE
  4626     ELSE
  4627         GO TO 1690-EXIT.
  4628
  4629     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  4630     MOVE '2'                    TO  CNTL-REC-TYPE.
  4631     MOVE CSRI                   TO  CNTL-ACCESS.
  4632     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  4633
  4634
  4635* EXEC CICS HANDLE CONDITION
  4636*        NOTFND  (1680-NOT-FOUND)
  4637*        ERROR   (9990-ABEND)
  4638*    END-EXEC.
  4639*    MOVE '"$I.                  ! '' #00004491' TO DFHEIV0
  4640     MOVE X'2224492E2020202020202020' TO DFHEIV0(1:12)
  4641     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4642     MOVE X'2720233030303034343931' TO DFHEIV0(25:11)
  4643     CALL 'kxdfhei1' USING DFHEIV0
  4644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4645
  4646
  4647
  4648* EXEC CICS READ
  4649*        DATASET  (CNTL-FILE-ID)
  4650*        SET      (ADDRESS OF CONTROL-FILE)
  4651*        RIDFLD   (ELCNTL-KEY)
  4652*    END-EXEC.
  4653*    MOVE '&"S        E          (   #00004496' TO DFHEIV0
  4654     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4655     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4656     MOVE X'2020233030303034343936' TO DFHEIV0(25:11)
  4657     CALL 'kxdfhei1' USING DFHEIV0,
  4658           CNTL-FILE-ID,
  4659           DFHEIV20,
  4660           DFHEIV99,
  4661           ELCNTL-KEY,
  4662           DFHEIV99,
  4663           DFHEIV99,
  4664           DFHEIV99
  4665     SET ADDRESS OF CONTROL-FILE TO
  4666         DFHEIV20
  4667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4668
  4669
  4670     GO TO 1690-EXIT.
  4671
  4672 1680-NOT-FOUND.
  4673     MOVE ER-1883                TO EMI-ERROR.
  4674     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4675     MOVE -1                     TO CSRL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL636.cbl
  4676     MOVE AL-UABON               TO CSRA.
  4677
  4678 1690-EXIT.
  4679      EXIT.
  4680
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL636.cbl
  4682******************************************************************
  4683*                                                                *
  4684*               A D D   P A Y E E                                *
  4685*                                                                *
  4686******************************************************************
  4687
  4688 2000-ADD-PAYEE.
  4689
  4690
  4691* EXEC CICS GETMAIN
  4692*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  4693*        LENGTH  (ERCKWK-RECORD-LENGTH)
  4694*        INITIMG (GETMAIN-SPACE)
  4695*    END-EXEC.
  4696*    MOVE ',"IL                  $   #00004522' TO DFHEIV0
  4697     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4698     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4699     MOVE X'2020233030303034353232' TO DFHEIV0(25:11)
  4700     CALL 'kxdfhei1' USING DFHEIV0,
  4701           DFHEIV20,
  4702           ERCKWK-RECORD-LENGTH,
  4703           GETMAIN-SPACE
  4704     SET ADDRESS OF CHECK-WORK-RECORDS TO
  4705         DFHEIV20
  4706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4707
  4708
  4709     IF PI-ERCKWK-PAYEE-SEQ = +1
  4710         ADD +1 TO PI-ERCKWK-PAYEE-SEQ
  4711     ELSE
  4712         MOVE +2 TO PI-ERCKWK-PAYEE-SEQ.
  4713
  4714 2010-READ-FOR-UPDATE.
  4715     MOVE PI-COMPANY-CD          TO ERCKWK-COMPANY-CD.
  4716     MOVE PI-ERCKWK-CSR          TO ERCKWK-CSR.
  4717     MOVE PI-ERCKWK-CARRIER      TO ERCKWK-CARRIER.
  4718     MOVE PI-ERCKWK-GROUPING     TO ERCKWK-GROUPING.
  4719     MOVE PI-ERCKWK-PAYEE        TO ERCKWK-PAYEE.
  4720     MOVE PI-ERCKWK-PAYEE-SEQ    TO ERCKWK-PAYEE-SEQ.
  4721     MOVE ZEROS                  TO ERCKWK-SEQUENCE-NO.
  4722
  4723 2025-ADD-HEADER.
  4724
  4725     MOVE 'CW'                   TO CW-RECORD-ID.
  4726     MOVE ERCKWK-KEY             TO CW-CONTROL-PRIMARY.
  4727     MOVE '0'                    TO CW-RECORD-TYPE.
  4728     MOVE WS-CURRENT-BIN-DT      TO CW-RECORDED-DT.
  4729     MOVE PI-PROCESSOR-ID        TO CW-RECORDED-BY.
  4730     MOVE EIBTIME                TO CW-LAST-MAINT-HHMMSS.
  4731
  4732     IF PAYTOL  GREATER THAN ZEROS
  4733        MOVE PAYTOI              TO CW-PAYEE-NAME.
  4734
  4735     IF ADDRS1L GREATER THAN ZEROS
  4736        MOVE ADDRS1I             TO CW-ADDRESS-1.
  4737
  4738     IF ADDRS2L GREATER THAN ZEROS
  4739        MOVE ADDRS2I             TO CW-ADDRESS-2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL636.cbl
  4740
  4741     IF CITYSTL GREATER THAN ZEROS
  4742        MOVE CITYSTI             TO CW-PAYEE-CITY-ST.
  4743
  4744     IF ZIPL    GREATER THAN ZEROS
  4745        MOVE ZIPI                TO CW-PAYEE-ZIP.
  4746
  4747     IF ZIPEXTL GREATER THAN ZEROS
  4748        MOVE ZIPEXTI             TO CW-PAYEE-ZIP-EXT.
  4749
  4750     MOVE +0                     TO CW-TOTAL-COMMISSION
  4751                                    CW-TOTAL-ENTRIES.
  4752
  4753     MOVE LOW-VALUES             TO CW-CREDIT-SELECT-DT
  4754                                    CW-CREDIT-ACCEPT-DT
  4755                                    CW-RELEASE-DT.
  4756
  4757 2030-WRITE-HEADER.
  4758
  4759* EXEC CICS HANDLE CONDITION
  4760*        DUPREC    (2060-DUPLICATE-CHECK)
  4761*    END-EXEC.
  4762*    MOVE '"$%                   ! ( #00004577' TO DFHEIV0
  4763     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  4764     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4765     MOVE X'2820233030303034353737' TO DFHEIV0(25:11)
  4766     CALL 'kxdfhei1' USING DFHEIV0
  4767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4768
  4769
  4770
  4771* EXEC CICS WRITE
  4772*         FROM    (CHECK-WORK-RECORDS)
  4773*         DATASET (FILE-ID-ERCKWK)
  4774*         RIDFLD  (ERCKWK-KEY)
  4775*    END-EXEC.
  4776     MOVE LENGTH OF
  4777      CHECK-WORK-RECORDS
  4778       TO DFHEIV11
  4779*    MOVE '&$ L                  ''   #00004581' TO DFHEIV0
  4780     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4781     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4782     MOVE X'2020233030303034353831' TO DFHEIV0(25:11)
  4783     CALL 'kxdfhei1' USING DFHEIV0,
  4784           FILE-ID-ERCKWK,
  4785           CHECK-WORK-RECORDS,
  4786           DFHEIV11,
  4787           ERCKWK-KEY,
  4788           DFHEIV99,
  4789           DFHEIV99
  4790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4791
  4792
  4793     MOVE +0                     TO WS-AMOUNT-PAID
  4794                                    WS-SEQUENCE-NO
  4795                                    WS-TOTAL-ENTRIES.
  4796
  4797     MOVE +0                     TO WS-SUB1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL636.cbl
  4798
  4799 2050-ADD-DETAIL-ENTRIES.
  4800
  4801     ADD +1                      TO WS-SUB1.
  4802
  4803     IF WS-SUB1 GREATER THAN +5
  4804        GO TO 2090-NEW-PAYEE-PROCESSED.
  4805
  4806     IF CK-MAINT-LEN (WS-SUB1) NOT GREATER THAN +0
  4807        GO TO 2050-ADD-DETAIL-ENTRIES.
  4808
  4809     MOVE SPACES                 TO CHECK-WORK-RECORDS.
  4810     MOVE 'CW'                   TO CW-RECORD-ID.
  4811     MOVE ERCKWK-KEY             TO CW-CONTROL-PRIMARY.
  4812     ADD  +1                     TO WS-SEQUENCE-NO.
  4813     MOVE WS-SEQUENCE-NO         TO CW-SEQUENCE-NO.
  4814     MOVE CW-SEQUENCE-NO         TO ERCKWK-SEQUENCE-NO.
  4815     MOVE '1'                    TO CW-RECORD-TYPE.
  4816     MOVE WS-CURRENT-BIN-DT      TO CW-RECORDED-DT.
  4817     MOVE PI-PROCESSOR-ID        TO CW-RECORDED-BY.
  4818     MOVE EIBTIME                TO CW-LAST-MAINT-HHMMSS.
  4819
  4820     MOVE LOW-VALUES             TO CW-CREDIT-SELECT-DT
  4821                                    CW-CREDIT-ACCEPT-DT
  4822                                    CW-RELEASE-DT.
  4823
  4824     MOVE CK-MAINT (WS-SUB1)     TO CW-LAST-MAINT-APPLIED.
  4825
  4826     IF CK-COMNTS-LEN  (WS-SUB1) GREATER THAN ZEROS
  4827        MOVE CK-COMNTS (WS-SUB1) TO CW-COMMENT.
  4828
  4829     IF CK-AGENT-LEN   (WS-SUB1) GREATER THAN ZEROS
  4830        MOVE CK-AGENT  (WS-SUB1) TO CW-ACCT-AGENT.
  4831
  4832     IF CK-INVREF-LEN  (WS-SUB1) GREATER THAN ZEROS
  4833        IF CK-MAINT    (WS-SUB1) = 'R'
  4834           MOVE CK-INVREF (WS-SUB1) TO CW-REFERENCE.
  4835
  4836     IF CK-INVREF-LEN  (WS-SUB1) GREATER THAN ZEROS
  4837        IF CK-MAINT    (WS-SUB1) = 'I'
  4838           MOVE CK-INVREF (WS-SUB1) TO CW-INVOICE.
  4839
  4840     IF CK-LEDGER-LEN  (WS-SUB1) GREATER THAN ZEROS
  4841        MOVE CK-LEDGER (WS-SUB1) TO CW-LEDGER-NO.
  4842
  4843     IF CK-AGOCD-LEN   (WS-SUB1) GREATER THAN ZEROS
  4844        MOVE CK-AGOCD  (WS-SUB1) TO CW-PMT-APPLIED.
  4845
  4846     MOVE 'C'                    TO CW-PAYMENT-TYPE.
  4847
  4848     IF CK-DETAMT-LEN  (WS-SUB1) GREATER THAN ZEROS
  4849        MOVE WS-DETAMT (WS-SUB1) TO CW-DETAIL-AMOUNT
  4850     ELSE
  4851        MOVE ZEROS               TO CW-DETAIL-AMOUNT.
  4852
  4853     ADD +1                      TO WS-TOTAL-ENTRIES.
  4854
  4855     IF CK-MAINT (WS-SUB1) NOT EQUAL 'H'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL636.cbl
  4856         ADD WS-DETAMT (WS-SUB1) TO WS-AMOUNT-PAID.
  4857
  4858     IF CW-NON-AR-ITEM EQUAL 'Y'
  4859         NEXT SENTENCE
  4860     ELSE
  4861        IF CK-MAINT (WS-SUB1) = 'N'
  4862            MOVE 'Y'             TO CW-NON-AR-ITEM
  4863            MOVE 'N'             TO CW-PMT-APPLIED
  4864        ELSE
  4865            MOVE 'N'             TO CW-NON-AR-ITEM.
  4866
  4867
  4868* EXEC CICS HANDLE CONDITION
  4869*         DUPREC  (2080-DUPLICATE-CHECK)
  4870*    END-EXEC.
  4871*    MOVE '"$%                   ! ) #00004661' TO DFHEIV0
  4872     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  4873     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4874     MOVE X'2920233030303034363631' TO DFHEIV0(25:11)
  4875     CALL 'kxdfhei1' USING DFHEIV0
  4876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4877
  4878
  4879
  4880* EXEC CICS WRITE
  4881*         FROM    (CHECK-WORK-RECORDS)
  4882*         DATASET (FILE-ID-ERCKWK)
  4883*         RIDFLD  (ERCKWK-KEY)
  4884*    END-EXEC.
  4885     MOVE LENGTH OF
  4886      CHECK-WORK-RECORDS
  4887       TO DFHEIV11
  4888*    MOVE '&$ L                  ''   #00004665' TO DFHEIV0
  4889     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4890     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4891     MOVE X'2020233030303034363635' TO DFHEIV0(25:11)
  4892     CALL 'kxdfhei1' USING DFHEIV0,
  4893           FILE-ID-ERCKWK,
  4894           CHECK-WORK-RECORDS,
  4895           DFHEIV11,
  4896           ERCKWK-KEY,
  4897           DFHEIV99,
  4898           DFHEIV99
  4899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4900
  4901
  4902     MOVE ERCKWK-KEY             TO  PI-STUB-KEY     (WS-SUB1).
  4903     MOVE 'A'                    TO  PI-PREV-FUNCTION.
  4904
  4905     GO TO 2050-ADD-DETAIL-ENTRIES.
  4906
  4907 2060-DUPLICATE-CHECK.
  4908     ADD +1 TO PI-ERCKWK-PAYEE-SEQ.
  4909     MOVE PI-ERCKWK-PAYEE-SEQ    TO ERCKWK-PAYEE-SEQ.
  4910     MOVE ERCKWK-KEY             TO CW-CONTROL-PRIMARY.
  4911     GO TO 2030-WRITE-HEADER.
  4912
  4913 2080-DUPLICATE-CHECK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL636.cbl
  4914
  4915
  4916* EXEC CICS SYNCPOINT ROLLBACK
  4917*    END-EXEC.
  4918*    MOVE '6"R                   !   #00004684' TO DFHEIV0
  4919     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  4920     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4921     MOVE X'2020233030303034363834' TO DFHEIV0(25:11)
  4922     CALL 'kxdfhei1' USING DFHEIV0
  4923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4924
  4925
  4926     MOVE SPACE                  TO PI-MAINT-FUNCTION.
  4927     MOVE ER-3159                TO EMI-ERROR.
  4928     MOVE -1                     TO CARL.
  4929     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4930     GO TO 8200-SEND-DATAONLY.
  4931
  4932 2090-NEW-PAYEE-PROCESSED.
  4933
  4934     MOVE ZEROS                  TO ERCKWK-SEQUENCE-NO
  4935                                    PI-ERCKWK-SEQ-NO.
  4936
  4937
  4938* EXEC CICS HANDLE CONDITION
  4939*        NOTFND    (2095-HEADER-ROLLBACK)
  4940*    END-EXEC.
  4941*    MOVE '"$I                   ! * #00004698' TO DFHEIV0
  4942     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4943     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4944     MOVE X'2A20233030303034363938' TO DFHEIV0(25:11)
  4945     CALL 'kxdfhei1' USING DFHEIV0
  4946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4947
  4948
  4949
  4950* EXEC CICS READ
  4951*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  4952*        DATASET (FILE-ID-ERCKWK)
  4953*        RIDFLD  (ERCKWK-KEY)
  4954*        UPDATE
  4955*    END-EXEC.
  4956*    MOVE '&"S        EU         (   #00004702' TO DFHEIV0
  4957     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4958     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4959     MOVE X'2020233030303034373032' TO DFHEIV0(25:11)
  4960     CALL 'kxdfhei1' USING DFHEIV0,
  4961           FILE-ID-ERCKWK,
  4962           DFHEIV20,
  4963           DFHEIV99,
  4964           ERCKWK-KEY,
  4965           DFHEIV99,
  4966           DFHEIV99,
  4967           DFHEIV99
  4968     SET ADDRESS OF CHECK-WORK-RECORDS TO
  4969         DFHEIV20
  4970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4971
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL636.cbl
  4972
  4973     MOVE WS-AMOUNT-PAID          TO   CW-TOTAL-COMMISSION.
  4974     MOVE WS-TOTAL-ENTRIES        TO   CW-TOTAL-ENTRIES.
  4975
  4976     IF CW-TOTAL-COMMISSION = ZERO
  4977         GO TO 2095-HEADER-ROLLBACK.
  4978
  4979
  4980* EXEC CICS REWRITE
  4981*         FROM    (CHECK-WORK-RECORDS)
  4982*         DATASET (FILE-ID-ERCKWK)
  4983*    END-EXEC.
  4984     MOVE LENGTH OF
  4985      CHECK-WORK-RECORDS
  4986       TO DFHEIV11
  4987*    MOVE '&& L                  %   #00004715' TO DFHEIV0
  4988     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4989     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4990     MOVE X'2020233030303034373135' TO DFHEIV0(25:11)
  4991     CALL 'kxdfhei1' USING DFHEIV0,
  4992           FILE-ID-ERCKWK,
  4993           CHECK-WORK-RECORDS,
  4994           DFHEIV11,
  4995           DFHEIV99
  4996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4997
  4998
  4999     IF EMI-WARNING-CTR = ZEROS
  5000         MOVE ER-0000                TO  EMI-ERROR
  5001         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5002
  5003     GO TO 5000-DISPLAY-PAYEE.
  5004
  5005 2095-HEADER-ROLLBACK.
  5006
  5007
  5008* EXEC CICS SYNCPOINT ROLLBACK
  5009*    END-EXEC.
  5010*    MOVE '6"R                   !   #00004728' TO DFHEIV0
  5011     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  5012     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5013     MOVE X'2020233030303034373238' TO DFHEIV0(25:11)
  5014     CALL 'kxdfhei1' USING DFHEIV0
  5015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5016
  5017
  5018     MOVE SPACE                  TO PI-MAINT-FUNCTION.
  5019     MOVE ER-3160                TO EMI-ERROR.
  5020     MOVE -1                     TO CARL.
  5021     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5022     GO TO 8200-SEND-DATAONLY.
  5023
  5024
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL636.cbl
  5026
  5027******************************************************************
  5028*                                                                *
  5029*              C H A N G E   P A Y E E                           *
  5030*                                                                *
  5031******************************************************************
  5032
  5033 3000-CHANGE-PAYEE.
  5034
  5035     MOVE 'C'                    TO PI-MAINT-FUNCTION.
  5036     MOVE +0                     TO WS-SUB1
  5037                                    WS-DELETE-COUNT
  5038                                    WS-DELETE-AMOUNT
  5039                                    WS-DELETE-SEQ-NO
  5040                                    WS-HOLD-COUNT
  5041                                    WS-HOLD-AMOUNT
  5042                                    WS-OFF-HOLD-COUNT
  5043                                    WS-OFF-HOLD-AMOUNT.
  5044     MOVE SPACE                  TO WS-UPDATE-SW.
  5045
  5046 3010-CHANGE-ENTRIES.
  5047
  5048     ADD +1                      TO WS-SUB1.
  5049
  5050     IF WS-SUB1 GREATER THAN +5
  5051        IF  WS-DELETE-COUNT GREATER THAN +0
  5052            PERFORM 3400-RESEQ-SLUG-LINES THRU 3499-EXIT
  5053            GO TO 3050-UPDATE-HEADER
  5054        ELSE
  5055            GO TO 3050-UPDATE-HEADER.
  5056
  5057     IF CK-MAINT-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  5058        CK-COMNTS-LEN   (WS-SUB1) GREATER THAN ZEROS OR
  5059        CK-AGENT-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  5060        CK-INVREF-LEN   (WS-SUB1) GREATER THAN ZEROS OR
  5061        CK-LEDGER-LEN   (WS-SUB1) GREATER THAN ZEROS OR
  5062        CK-AGOCD-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  5063        CK-DETAMT-LEN   (WS-SUB1) GREATER THAN ZEROS
  5064        NEXT SENTENCE
  5065     ELSE
  5066        GO TO 3010-CHANGE-ENTRIES.
  5067
  5068     IF CK-MAINT-LEN (WS-SUB1) NOT GREATER THAN ZEROS
  5069        GO TO 3010-CHANGE-ENTRIES.
  5070
  5071     IF CK-MAINT (WS-SUB1) = 'A' OR 'N'
  5072        PERFORM 3200-ADD-DETAIL-ENTRY THRU 3290-EXIT
  5073        GO TO 3010-CHANGE-ENTRIES.
  5074
  5075     IF CK-MAINT (WS-SUB1) = 'R' OR 'I'
  5076        IF WS-SUB1 GREATER THAN PI-NO-ENTRIES-DISPLAYED
  5077           PERFORM 3200-ADD-DETAIL-ENTRY THRU 3290-EXIT
  5078           GO TO 3010-CHANGE-ENTRIES.
  5079
  5080     IF WS-SUB1 GREATER THAN PI-NO-ENTRIES-DISPLAYED
  5081        GO TO 3010-CHANGE-ENTRIES.
  5082
  5083     MOVE PI-STUB-KEY (WS-SUB1)  TO ERCKWK-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL636.cbl
  5084
  5085
  5086* EXEC CICS HANDLE CONDITION
  5087*        NOTFND    (3010-CHANGE-ENTRIES)
  5088*    END-EXEC.
  5089*    MOVE '"$I                   ! + #00004798' TO DFHEIV0
  5090     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5091     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5092     MOVE X'2B20233030303034373938' TO DFHEIV0(25:11)
  5093     CALL 'kxdfhei1' USING DFHEIV0
  5094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5095
  5096
  5097
  5098* EXEC CICS READ
  5099*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  5100*        DATASET (FILE-ID-ERCKWK)
  5101*        RIDFLD  (ERCKWK-KEY)
  5102*        UPDATE
  5103*    END-EXEC.
  5104*    MOVE '&"S        EU         (   #00004802' TO DFHEIV0
  5105     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5106     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5107     MOVE X'2020233030303034383032' TO DFHEIV0(25:11)
  5108     CALL 'kxdfhei1' USING DFHEIV0,
  5109           FILE-ID-ERCKWK,
  5110           DFHEIV20,
  5111           DFHEIV99,
  5112           ERCKWK-KEY,
  5113           DFHEIV99,
  5114           DFHEIV99,
  5115           DFHEIV99
  5116     SET ADDRESS OF CHECK-WORK-RECORDS TO
  5117         DFHEIV20
  5118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5119
  5120
  5121     IF CW-RELEASE-DT GREATER THAN LOW-VALUES
  5122         GO TO 3085-RELEASE-ERROR.
  5123
  5124     IF CK-MAINT  (WS-SUB1) = 'D'
  5125        MOVE 'Y'                 TO WS-UPDATE-SW
  5126        PERFORM 3100-DELETE-ENTRY THRU 3190-EXIT
  5127        GO TO 3010-CHANGE-ENTRIES.
  5128
  5129     IF CK-MAINT (WS-SUB1) = 'H'
  5130        IF CW-LAST-MAINT-APPLIED EQUAL 'H'
  5131            NEXT SENTENCE
  5132        ELSE
  5133            MOVE 'Y'                 TO WS-UPDATE-SW
  5134            ADD CW-DETAIL-AMOUNT     TO WS-HOLD-AMOUNT
  5135            ADD +1                   TO WS-HOLD-COUNT
  5136     ELSE
  5137        IF CW-LAST-MAINT-APPLIED EQUAL 'H'
  5138            MOVE 'Y'                 TO WS-UPDATE-SW
  5139            ADD CW-DETAIL-AMOUNT     TO WS-OFF-HOLD-AMOUNT
  5140            ADD +1                   TO WS-OFF-HOLD-COUNT.
  5141
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL636.cbl
  5142     IF CK-MAINT (WS-SUB1) = 'C' AND
  5143        CW-LAST-MAINT-APPLIED = 'N'
  5144         MOVE -1              TO CK-MAINT-LEN (WS-SUB1)
  5145         MOVE ER-3198         TO EMI-ERROR
  5146         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5147         GO TO 8200-SEND-DATAONLY.
  5148
  5149     MOVE CK-MAINT (WS-SUB1)     TO CW-LAST-MAINT-APPLIED.
  5150
  5151     IF (CK-COMNTS-LEN  (WS-SUB1) GREATER THAN ZEROS)
  5152        MOVE 'Y'                 TO WS-UPDATE-SW
  5153        MOVE CK-COMNTS (WS-SUB1) TO CW-COMMENT.
  5154
  5155     IF CK-AGENT-LEN   (WS-SUB1) GREATER THAN ZEROS
  5156        MOVE 'Y'                 TO WS-UPDATE-SW
  5157        MOVE CK-AGENT  (WS-SUB1) TO CW-ACCT-AGENT.
  5158
  5159     IF CK-INVREF-LEN  (WS-SUB1) GREATER THAN ZEROS
  5160        IF CK-MAINT    (WS-SUB1) = 'R'
  5161           MOVE CK-INVREF (WS-SUB1) TO CW-REFERENCE.
  5162
  5163     IF CK-INVREF-LEN  (WS-SUB1) GREATER THAN ZEROS
  5164        IF CK-MAINT    (WS-SUB1) = 'I'
  5165           MOVE CK-INVREF (WS-SUB1) TO CW-INVOICE.
  5166
  5167     IF CK-LEDGER-LEN  (WS-SUB1) GREATER THAN ZEROS
  5168        MOVE CK-LEDGER (WS-SUB1) TO CW-LEDGER-NO.
  5169
  5170     IF CK-AGOCD-LEN   (WS-SUB1) GREATER THAN ZEROS
  5171        MOVE CK-AGOCD  (WS-SUB1) TO CW-PMT-APPLIED.
  5172
  5173     MOVE 'C'                    TO CW-PAYMENT-TYPE.
  5174
  5175     IF CK-DETAMT-LEN  (WS-SUB1) GREATER THAN ZEROS
  5176        MOVE CW-DETAIL-AMOUNT    TO WS-DETAIL-AMOUNT
  5177        MOVE WS-DETAMT (WS-SUB1) TO CW-DETAIL-AMOUNT.
  5178
  5179
  5180* EXEC CICS REWRITE
  5181*         FROM    (CHECK-WORK-RECORDS)
  5182*         DATASET (FILE-ID-ERCKWK)
  5183*    END-EXEC.
  5184     MOVE LENGTH OF
  5185      CHECK-WORK-RECORDS
  5186       TO DFHEIV11
  5187*    MOVE '&& L                  %   #00004867' TO DFHEIV0
  5188     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5189     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5190     MOVE X'2020233030303034383637' TO DFHEIV0(25:11)
  5191     CALL 'kxdfhei1' USING DFHEIV0,
  5192           FILE-ID-ERCKWK,
  5193           CHECK-WORK-RECORDS,
  5194           DFHEIV11,
  5195           DFHEIV99
  5196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5197
  5198
  5199     IF CK-DETAMT-LEN  (WS-SUB1) GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL636.cbl
  5200        PERFORM 3300-UPDATE-TOTAL-COMMISSION THRU 3390-EXIT.
  5201
  5202     GO TO 3010-CHANGE-ENTRIES.
  5203
  5204 3050-UPDATE-HEADER.
  5205
  5206     IF PAYTOL          GREATER THAN ZEROS OR
  5207        ADDRS1L         GREATER THAN ZEROS OR
  5208        ADDRS2L         GREATER THAN ZEROS OR
  5209        CITYSTL         GREATER THAN ZEROS OR
  5210        ZIPL            GREATER THAN ZEROS OR
  5211        ZIPEXTL         GREATER THAN ZEROS OR
  5212        WS-ENTRIES-UPDATED
  5213        NEXT SENTENCE
  5214     ELSE
  5215        GO TO 3080-CHANGES-PROCESSED.
  5216
  5217     MOVE PI-COMPANY-CD          TO ERCKWK-COMPANY-CD.
  5218     MOVE PI-ERCKWK-CSR          TO ERCKWK-CSR.
  5219     MOVE PI-ERCKWK-CARRIER      TO ERCKWK-CARRIER.
  5220     MOVE PI-ERCKWK-GROUPING     TO ERCKWK-GROUPING.
  5221     MOVE PI-ERCKWK-PAYEE        TO ERCKWK-PAYEE.
  5222     MOVE PI-ERCKWK-PAYEE-SEQ    TO ERCKWK-PAYEE-SEQ.
  5223     MOVE ZEROS                  TO ERCKWK-SEQUENCE-NO.
  5224
  5225
  5226* EXEC CICS HANDLE CONDITION
  5227*        NOTFND    (3090-CHECKS-NOTFND)
  5228*        ENDFILE   (3090-CHECKS-NOTFND)
  5229*    END-EXEC.
  5230*    MOVE '"$I''                  ! , #00004898' TO DFHEIV0
  5231     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5232     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5233     MOVE X'2C20233030303034383938' TO DFHEIV0(25:11)
  5234     CALL 'kxdfhei1' USING DFHEIV0
  5235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5236
  5237
  5238
  5239* EXEC CICS READ
  5240*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  5241*        DATASET (FILE-ID-ERCKWK)
  5242*        RIDFLD  (ERCKWK-KEY)
  5243*        UPDATE
  5244*    END-EXEC.
  5245*    MOVE '&"S        EU         (   #00004903' TO DFHEIV0
  5246     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5247     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5248     MOVE X'2020233030303034393033' TO DFHEIV0(25:11)
  5249     CALL 'kxdfhei1' USING DFHEIV0,
  5250           FILE-ID-ERCKWK,
  5251           DFHEIV20,
  5252           DFHEIV99,
  5253           ERCKWK-KEY,
  5254           DFHEIV99,
  5255           DFHEIV99,
  5256           DFHEIV99
  5257     SET ADDRESS OF CHECK-WORK-RECORDS TO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL636.cbl
  5258         DFHEIV20
  5259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5260
  5261
  5262     IF CW-RELEASE-DT GREATER THAN LOW-VALUES
  5263         GO TO 3085-RELEASE-ERROR.
  5264
  5265     IF PAYTOL  GREATER THAN ZEROS
  5266        MOVE PAYTOI              TO CW-PAYEE-NAME.
  5267
  5268     IF ADDRS1L GREATER THAN ZEROS
  5269        MOVE ADDRS1I             TO CW-ADDRESS-1.
  5270
  5271     IF ADDRS2L GREATER THAN ZEROS
  5272        MOVE ADDRS2I             TO CW-ADDRESS-2.
  5273
  5274     IF CITYSTL GREATER THAN ZEROS
  5275        MOVE CITYSTI             TO CW-PAYEE-CITY-ST.
  5276
  5277     IF ZIPL    GREATER THAN ZEROS
  5278        MOVE ZIPI                TO CW-PAYEE-ZIP.
  5279
  5280     IF ZIPEXTL GREATER THAN ZEROS
  5281        MOVE ZIPEXTI             TO CW-PAYEE-ZIP-EXT.
  5282
  5283     IF WS-DELETE-COUNT GREATER THAN +0
  5284         SUBTRACT WS-DELETE-AMOUNT    FROM CW-TOTAL-COMMISSION
  5285         SUBTRACT WS-DELETE-COUNT     FROM CW-TOTAL-ENTRIES.
  5286
  5287     IF WS-HOLD-COUNT GREATER THAN +0
  5288         SUBTRACT WS-HOLD-AMOUNT      FROM CW-TOTAL-COMMISSION.
  5289
  5290     IF WS-OFF-HOLD-COUNT GREATER THAN +0
  5291         ADD WS-OFF-HOLD-AMOUNT  TO  CW-TOTAL-COMMISSION.
  5292
  5293
  5294     MOVE WS-CURRENT-BIN-DT      TO  CW-RECORDED-DT.
  5295     MOVE PI-PROCESSOR-ID        TO  CW-RECORDED-BY.
  5296     MOVE EIBTIME                TO  CW-LAST-MAINT-HHMMSS.
  5297
  5298
  5299* EXEC CICS REWRITE
  5300*         FROM    (CHECK-WORK-RECORDS)
  5301*         DATASET (FILE-ID-ERCKWK)
  5302*    END-EXEC.
  5303     MOVE LENGTH OF
  5304      CHECK-WORK-RECORDS
  5305       TO DFHEIV11
  5306*    MOVE '&& L                  %   #00004946' TO DFHEIV0
  5307     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5308     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5309     MOVE X'2020233030303034393436' TO DFHEIV0(25:11)
  5310     CALL 'kxdfhei1' USING DFHEIV0,
  5311           FILE-ID-ERCKWK,
  5312           CHECK-WORK-RECORDS,
  5313           DFHEIV11,
  5314           DFHEIV99
  5315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL636.cbl
  5316
  5317
  5318 3080-CHANGES-PROCESSED.
  5319
  5320     IF PI-NO-ENTRIES-DISPLAYED GREATER THAN ZEROS
  5321         MOVE PI-STUB-KEY (1)        TO PI-ERCKWK-KEY
  5322         IF WS-DELETE-COUNT  GREATER THAN +0   AND
  5323            WS-DELETE-COUNT  EQUAL PI-NO-ENTRIES-DISPLAYED
  5324            IF  CW-TOTAL-ENTRIES GREATER THAN +5 AND
  5325                PI-ERCKWK-SEQ-NO GREATER THAN +5
  5326                SUBTRACT +5 FROM PI-ERCKWK-SEQ-NO
  5327            ELSE
  5328                MOVE ZEROS TO    PI-ERCKWK-SEQ-NO.
  5329
  5330     IF EMI-WARNING-CTR = ZEROS
  5331         MOVE ER-0000                TO EMI-ERROR
  5332         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5333
  5334     GO TO 5000-DISPLAY-PAYEE.
  5335
  5336 3085-RELEASE-ERROR.
  5337
  5338
  5339* EXEC CICS UNLOCK
  5340*         DATASET (FILE-ID-ERCKWK)
  5341*    END-EXEC.
  5342*    MOVE '&*                    #   #00004971' TO DFHEIV0
  5343     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5344     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5345     MOVE X'2020233030303034393731' TO DFHEIV0(25:11)
  5346     CALL 'kxdfhei1' USING DFHEIV0,
  5347           FILE-ID-ERCKWK,
  5348           DFHEIV99
  5349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5350
  5351
  5352     MOVE ER-3139                TO EMI-ERROR.
  5353     MOVE -1                     TO MAINTL.
  5354     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5355     GO TO 8200-SEND-DATAONLY.
  5356 3090-CHECKS-NOTFND.
  5357
  5358
  5359* EXEC CICS SYNCPOINT ROLLBACK
  5360*    END-EXEC.
  5361*    MOVE '6"R                   !   #00004981' TO DFHEIV0
  5362     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  5363     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5364     MOVE X'2020233030303034393831' TO DFHEIV0(25:11)
  5365     CALL 'kxdfhei1' USING DFHEIV0
  5366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5367
  5368
  5369     MOVE SPACE                  TO PI-MAINT-FUNCTION.
  5370     MOVE ER-3161                TO EMI-ERROR.
  5371     MOVE -1                     TO CARL.
  5372     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5373     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL636.cbl
  5374
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL636.cbl
  5376
  5377******************************************************************
  5378*                                                                *
  5379*              D E L E T E   E N T R Y                           *
  5380*                                                                *
  5381******************************************************************
  5382
  5383 3100-DELETE-ENTRY.
  5384
  5385     IF CW-LAST-MAINT-APPLIED NOT = 'H'
  5386         ADD  CW-DETAIL-AMOUNT   TO WS-DELETE-AMOUNT.
  5387
  5388     ADD  +1                     TO WS-DELETE-COUNT.
  5389
  5390     IF  WS-DELETE-COUNT EQUAL +1
  5391         MOVE ERCKWK-SEQUENCE-NO TO WS-DELETE-SEQ-NO.
  5392
  5393
  5394* EXEC CICS DELETE
  5395*         DATASET   (FILE-ID-ERCKWK)
  5396*    END-EXEC.
  5397*    MOVE '&(                    &   #00005008' TO DFHEIV0
  5398     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5399     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5400     MOVE X'2020233030303035303038' TO DFHEIV0(25:11)
  5401     CALL 'kxdfhei1' USING DFHEIV0,
  5402           FILE-ID-ERCKWK,
  5403           DFHEIV99,
  5404           DFHEIV99,
  5405           DFHEIV99,
  5406           DFHEIV99
  5407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5408
  5409
  5410 3190-EXIT.
  5411     EXIT.
  5412
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL636.cbl
  5414
  5415******************************************************************
  5416*                                                                *
  5417*           A D D   D E T A I L   E N T R Y                      *
  5418*                                                                *
  5419******************************************************************
  5420
  5421 3200-ADD-DETAIL-ENTRY.
  5422
  5423     MOVE PI-COMPANY-CD          TO ERCKWK-COMPANY-CD.
  5424     MOVE PI-ERCKWK-CSR          TO ERCKWK-CSR.
  5425     MOVE PI-ERCKWK-CARRIER      TO ERCKWK-CARRIER.
  5426     MOVE PI-ERCKWK-GROUPING     TO ERCKWK-GROUPING.
  5427     MOVE PI-ERCKWK-PAYEE        TO ERCKWK-PAYEE.
  5428     MOVE PI-ERCKWK-PAYEE-SEQ    TO ERCKWK-PAYEE-SEQ.
  5429     MOVE ZEROS                  TO ERCKWK-SEQUENCE-NO.
  5430
  5431
  5432* EXEC CICS HANDLE CONDITION
  5433*        NOTFND    (3280-HEADER-NOTFND)
  5434*    END-EXEC.
  5435*    MOVE '"$I                   ! - #00005033' TO DFHEIV0
  5436     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5437     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5438     MOVE X'2D20233030303035303333' TO DFHEIV0(25:11)
  5439     CALL 'kxdfhei1' USING DFHEIV0
  5440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5441
  5442
  5443
  5444* EXEC CICS READ
  5445*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  5446*        DATASET (FILE-ID-ERCKWK)
  5447*        RIDFLD  (ERCKWK-KEY)
  5448*        UPDATE
  5449*    END-EXEC.
  5450*    MOVE '&"S        EU         (   #00005037' TO DFHEIV0
  5451     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5452     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5453     MOVE X'2020233030303035303337' TO DFHEIV0(25:11)
  5454     CALL 'kxdfhei1' USING DFHEIV0,
  5455           FILE-ID-ERCKWK,
  5456           DFHEIV20,
  5457           DFHEIV99,
  5458           ERCKWK-KEY,
  5459           DFHEIV99,
  5460           DFHEIV99,
  5461           DFHEIV99
  5462     SET ADDRESS OF CHECK-WORK-RECORDS TO
  5463         DFHEIV20
  5464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5465
  5466
  5467     IF CW-RELEASE-DT GREATER THAN LOW-VALUES
  5468         GO TO 3285-RELEASE-ERROR.
  5469
  5470     ADD WS-DETAMT (WS-SUB1)     TO CW-TOTAL-COMMISSION.
  5471     ADD +1                      TO CW-TOTAL-ENTRIES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL636.cbl
  5472     MOVE CW-TOTAL-ENTRIES       TO WS-TOTAL-ENTRIES.
  5473
  5474     MOVE WS-CURRENT-BIN-DT      TO  CW-RECORDED-DT.
  5475     MOVE PI-PROCESSOR-ID        TO  CW-RECORDED-BY.
  5476     MOVE EIBTIME                TO  CW-LAST-MAINT-HHMMSS.
  5477
  5478
  5479* EXEC CICS REWRITE
  5480*         FROM    (CHECK-WORK-RECORDS)
  5481*         DATASET (FILE-ID-ERCKWK)
  5482*    END-EXEC.
  5483     MOVE LENGTH OF
  5484      CHECK-WORK-RECORDS
  5485       TO DFHEIV11
  5486*    MOVE '&& L                  %   #00005055' TO DFHEIV0
  5487     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5488     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5489     MOVE X'2020233030303035303535' TO DFHEIV0(25:11)
  5490     CALL 'kxdfhei1' USING DFHEIV0,
  5491           FILE-ID-ERCKWK,
  5492           CHECK-WORK-RECORDS,
  5493           DFHEIV11,
  5494           DFHEIV99
  5495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5496
  5497
  5498
  5499* EXEC CICS GETMAIN
  5500*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  5501*        LENGTH  (ERCKWK-RECORD-LENGTH)
  5502*        INITIMG (GETMAIN-SPACE)
  5503*    END-EXEC.
  5504*    MOVE ',"IL                  $   #00005060' TO DFHEIV0
  5505     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5506     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5507     MOVE X'2020233030303035303630' TO DFHEIV0(25:11)
  5508     CALL 'kxdfhei1' USING DFHEIV0,
  5509           DFHEIV20,
  5510           ERCKWK-RECORD-LENGTH,
  5511           GETMAIN-SPACE
  5512     SET ADDRESS OF CHECK-WORK-RECORDS TO
  5513         DFHEIV20
  5514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5515
  5516
  5517     MOVE 'CW'                   TO CW-RECORD-ID.
  5518     MOVE ERCKWK-KEY             TO CW-CONTROL-PRIMARY.
  5519
  5520     MOVE WS-TOTAL-ENTRIES       TO CW-SEQUENCE-NO
  5521                                    ERCKWK-SEQUENCE-NO.
  5522
  5523     MOVE '1'                    TO CW-RECORD-TYPE.
  5524     MOVE WS-CURRENT-BIN-DT      TO CW-RECORDED-DT.
  5525     MOVE PI-PROCESSOR-ID        TO CW-RECORDED-BY.
  5526     MOVE EIBTIME                TO CW-LAST-MAINT-HHMMSS.
  5527
  5528     MOVE CK-MAINT     (WS-SUB1) TO CW-LAST-MAINT-APPLIED.
  5529
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL636.cbl
  5530     IF CK-COMNTS-LEN  (WS-SUB1) GREATER THAN ZEROS
  5531        MOVE CK-COMNTS (WS-SUB1) TO CW-COMMENT.
  5532
  5533     IF CK-AGENT-LEN   (WS-SUB1) GREATER THAN ZEROS
  5534        MOVE CK-AGENT  (WS-SUB1) TO CW-ACCT-AGENT.
  5535
  5536     IF CK-INVREF-LEN  (WS-SUB1) GREATER THAN ZEROS
  5537        IF CK-MAINT    (WS-SUB1) = 'R'
  5538           MOVE CK-INVREF (WS-SUB1) TO CW-REFERENCE.
  5539
  5540     IF CK-INVREF-LEN  (WS-SUB1) GREATER THAN ZEROS
  5541        IF CK-MAINT    (WS-SUB1) = 'I'
  5542           MOVE CK-INVREF (WS-SUB1) TO CW-INVOICE.
  5543
  5544     IF CK-LEDGER-LEN  (WS-SUB1) GREATER THAN ZEROS
  5545        MOVE CK-LEDGER (WS-SUB1) TO CW-LEDGER-NO.
  5546
  5547     IF CK-AGOCD-LEN   (WS-SUB1) GREATER THAN ZEROS
  5548        MOVE CK-AGOCD  (WS-SUB1) TO CW-PMT-APPLIED.
  5549
  5550     MOVE 'C'                    TO CW-PAYMENT-TYPE.
  5551
  5552     IF CK-DETAMT-LEN  (WS-SUB1) GREATER THAN ZEROS
  5553        MOVE WS-DETAMT (WS-SUB1) TO CW-DETAIL-AMOUNT.
  5554
  5555     MOVE LOW-VALUES             TO CW-CREDIT-SELECT-DT
  5556                                    CW-CREDIT-ACCEPT-DT
  5557                                    CW-RELEASE-DT.
  5558
  5559     IF CW-NON-AR-ITEM EQUAL 'Y'
  5560         NEXT SENTENCE
  5561     ELSE
  5562        IF CK-MAINT (WS-SUB1) = 'N'
  5563            MOVE 'Y'                TO CW-NON-AR-ITEM
  5564            MOVE 'N'                TO CW-PMT-APPLIED
  5565        ELSE
  5566            MOVE 'N'                TO CW-NON-AR-ITEM.
  5567
  5568
  5569* EXEC CICS HANDLE CONDITION
  5570*         DUPREC  (3270-DUP-ENTRY)
  5571*    END-EXEC.
  5572*    MOVE '"$%                   ! . #00005117' TO DFHEIV0
  5573     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  5574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5575     MOVE X'2E20233030303035313137' TO DFHEIV0(25:11)
  5576     CALL 'kxdfhei1' USING DFHEIV0
  5577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5578
  5579
  5580 3250-WRITE-DETAIL-ENTRY.
  5581
  5582
  5583* EXEC CICS WRITE
  5584*         FROM    (CHECK-WORK-RECORDS)
  5585*         DATASET (FILE-ID-ERCKWK)
  5586*         RIDFLD  (ERCKWK-KEY)
  5587*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL636.cbl
  5588     MOVE LENGTH OF
  5589      CHECK-WORK-RECORDS
  5590       TO DFHEIV11
  5591*    MOVE '&$ L                  ''   #00005123' TO DFHEIV0
  5592     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5593     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5594     MOVE X'2020233030303035313233' TO DFHEIV0(25:11)
  5595     CALL 'kxdfhei1' USING DFHEIV0,
  5596           FILE-ID-ERCKWK,
  5597           CHECK-WORK-RECORDS,
  5598           DFHEIV11,
  5599           ERCKWK-KEY,
  5600           DFHEIV99,
  5601           DFHEIV99
  5602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5603
  5604
  5605     MOVE 'A'                   TO PI-PREV-FUNCTION.
  5606
  5607     GO TO 3290-EXIT.
  5608
  5609 3270-DUP-ENTRY.
  5610
  5611     ADD +1                      TO CW-SEQUENCE-NO.
  5612     MOVE CW-SEQUENCE-NO         TO ERCKWK-SEQUENCE-NO.
  5613     GO TO 3250-WRITE-DETAIL-ENTRY.
  5614
  5615 3280-HEADER-NOTFND.
  5616
  5617
  5618* EXEC CICS SYNCPOINT ROLLBACK
  5619*    END-EXEC.
  5620*    MOVE '6"R                   !   #00005141' TO DFHEIV0
  5621     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  5622     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5623     MOVE X'2020233030303035313431' TO DFHEIV0(25:11)
  5624     CALL 'kxdfhei1' USING DFHEIV0
  5625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5626
  5627
  5628     MOVE SPACE                  TO PI-MAINT-FUNCTION.
  5629     MOVE ER-3161                TO EMI-ERROR.
  5630     MOVE -1                     TO CARL.
  5631     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5632     GO TO 8200-SEND-DATAONLY.
  5633
  5634 3285-RELEASE-ERROR.
  5635
  5636
  5637* EXEC CICS UNLOCK
  5638*         DATASET (FILE-ID-ERCKWK)
  5639*    END-EXEC.
  5640*    MOVE '&*                    #   #00005152' TO DFHEIV0
  5641     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5642     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5643     MOVE X'2020233030303035313532' TO DFHEIV0(25:11)
  5644     CALL 'kxdfhei1' USING DFHEIV0,
  5645           FILE-ID-ERCKWK,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL636.cbl
  5646           DFHEIV99
  5647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5648
  5649
  5650     MOVE ER-3139                TO EMI-ERROR.
  5651     MOVE -1                     TO MAINTL.
  5652     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5653     GO TO 8200-SEND-DATAONLY.
  5654
  5655 3290-EXIT.
  5656     EXIT.
  5657
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL636.cbl
  5659
  5660******************************************************************
  5661*                                                                *
  5662*         U P D A T E   T O T A L   C O M M I S S I O N          *
  5663*                                                                *
  5664******************************************************************
  5665
  5666 3300-UPDATE-TOTAL-COMMISSION.
  5667
  5668     MOVE PI-COMPANY-CD          TO ERCKWK-COMPANY-CD.
  5669     MOVE PI-ERCKWK-CSR          TO ERCKWK-CSR.
  5670     MOVE PI-ERCKWK-CARRIER      TO ERCKWK-CARRIER.
  5671     MOVE PI-ERCKWK-GROUPING     TO ERCKWK-GROUPING.
  5672     MOVE PI-ERCKWK-PAYEE        TO ERCKWK-PAYEE.
  5673     MOVE PI-ERCKWK-PAYEE-SEQ    TO ERCKWK-PAYEE-SEQ.
  5674     MOVE ZEROS                  TO ERCKWK-SEQUENCE-NO.
  5675
  5676
  5677* EXEC CICS HANDLE CONDITION
  5678*        NOTFND    (3380-HEADER-NOTFND)
  5679*    END-EXEC.
  5680*    MOVE '"$I                   ! / #00005182' TO DFHEIV0
  5681     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5682     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5683     MOVE X'2F20233030303035313832' TO DFHEIV0(25:11)
  5684     CALL 'kxdfhei1' USING DFHEIV0
  5685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5686
  5687
  5688
  5689* EXEC CICS READ
  5690*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  5691*        DATASET (FILE-ID-ERCKWK)
  5692*        RIDFLD  (ERCKWK-KEY)
  5693*        UPDATE
  5694*    END-EXEC.
  5695*    MOVE '&"S        EU         (   #00005186' TO DFHEIV0
  5696     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5697     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5698     MOVE X'2020233030303035313836' TO DFHEIV0(25:11)
  5699     CALL 'kxdfhei1' USING DFHEIV0,
  5700           FILE-ID-ERCKWK,
  5701           DFHEIV20,
  5702           DFHEIV99,
  5703           ERCKWK-KEY,
  5704           DFHEIV99,
  5705           DFHEIV99,
  5706           DFHEIV99
  5707     SET ADDRESS OF CHECK-WORK-RECORDS TO
  5708         DFHEIV20
  5709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5710
  5711
  5712     SUBTRACT WS-DETAIL-AMOUNT    FROM CW-TOTAL-COMMISSION.
  5713     ADD      WS-DETAMT (WS-SUB1) TO   CW-TOTAL-COMMISSION.
  5714
  5715     MOVE WS-CURRENT-BIN-DT      TO  CW-RECORDED-DT.
  5716     MOVE PI-PROCESSOR-ID        TO  CW-RECORDED-BY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL636.cbl
  5717     MOVE EIBTIME                TO  CW-LAST-MAINT-HHMMSS.
  5718
  5719
  5720* EXEC CICS REWRITE
  5721*         FROM    (CHECK-WORK-RECORDS)
  5722*         DATASET (FILE-ID-ERCKWK)
  5723*    END-EXEC.
  5724     MOVE LENGTH OF
  5725      CHECK-WORK-RECORDS
  5726       TO DFHEIV11
  5727*    MOVE '&& L                  %   #00005200' TO DFHEIV0
  5728     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5729     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5730     MOVE X'2020233030303035323030' TO DFHEIV0(25:11)
  5731     CALL 'kxdfhei1' USING DFHEIV0,
  5732           FILE-ID-ERCKWK,
  5733           CHECK-WORK-RECORDS,
  5734           DFHEIV11,
  5735           DFHEIV99
  5736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5737
  5738
  5739     GO TO 3390-EXIT.
  5740
  5741 3380-HEADER-NOTFND.
  5742
  5743
  5744* EXEC CICS SYNCPOINT ROLLBACK
  5745*    END-EXEC.
  5746*    MOVE '6"R                   !   #00005209' TO DFHEIV0
  5747     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  5748     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5749     MOVE X'2020233030303035323039' TO DFHEIV0(25:11)
  5750     CALL 'kxdfhei1' USING DFHEIV0
  5751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5752
  5753
  5754     MOVE SPACE                  TO PI-MAINT-FUNCTION.
  5755     MOVE ER-3161                TO EMI-ERROR.
  5756     MOVE -1                     TO CARL.
  5757     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5758     GO TO 8200-SEND-DATAONLY.
  5759
  5760 3390-EXIT.
  5761     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL636.cbl
  5763******************************************************************
  5764*                                                                *
  5765*             R E S E Q U E N C E   S L U G   L I N E S          *
  5766*                                                                *
  5767******************************************************************
  5768
  5769 3400-RESEQ-SLUG-LINES.
  5770
  5771
  5772* EXEC CICS GETMAIN
  5773*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  5774*        LENGTH  (ERCKWK-RECORD-LENGTH)
  5775*        INITIMG (GETMAIN-SPACE)
  5776*    END-EXEC.
  5777*    MOVE ',"IL                  $   #00005229' TO DFHEIV0
  5778     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5779     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5780     MOVE X'2020233030303035323239' TO DFHEIV0(25:11)
  5781     CALL 'kxdfhei1' USING DFHEIV0,
  5782           DFHEIV20,
  5783           ERCKWK-RECORD-LENGTH,
  5784           GETMAIN-SPACE
  5785     SET ADDRESS OF CHECK-WORK-RECORDS TO
  5786         DFHEIV20
  5787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5788
  5789
  5790     MOVE ERCKWK-KEY             TO SAVE-ERCKWK-CONTROL.
  5791     MOVE WS-DELETE-SEQ-NO       TO ERCKWK-SEQUENCE-NO
  5792                                    WS-SEQUENCE-NO.
  5793
  5794
  5795* EXEC CICS HANDLE CONDITION
  5796*        NOTFND    (3490-FINISHED)
  5797*        ENDFILE   (3490-FINISHED)
  5798*    END-EXEC.
  5799*    MOVE '"$I''                  ! 0 #00005239' TO DFHEIV0
  5800     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5801     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5802     MOVE X'3020233030303035323339' TO DFHEIV0(25:11)
  5803     CALL 'kxdfhei1' USING DFHEIV0
  5804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5805
  5806
  5807 3410-BROWSE-CHECK-WORK-FILE.
  5808
  5809
  5810* EXEC CICS STARTBR
  5811*        DATASET (FILE-ID-ERCKWK)
  5812*        RIDFLD  (ERCKWK-KEY)
  5813*    END-EXEC.
  5814     MOVE 0
  5815       TO DFHEIV11
  5816*    MOVE '&,         G          &   #00005246' TO DFHEIV0
  5817     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5818     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5819     MOVE X'2020233030303035323436' TO DFHEIV0(25:11)
  5820     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL636.cbl
  5821           FILE-ID-ERCKWK,
  5822           ERCKWK-KEY,
  5823           DFHEIV99,
  5824           DFHEIV11,
  5825           DFHEIV99
  5826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5827
  5828
  5829 3420-READ-CHECK-WORK-FILE.
  5830
  5831
  5832* EXEC CICS READNEXT
  5833*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  5834*        DATASET (FILE-ID-ERCKWK)
  5835*        RIDFLD  (ERCKWK-KEY)
  5836*    END-EXEC.
  5837     MOVE 0
  5838       TO DFHEIV11
  5839*    MOVE '&.S                   )   #00005253' TO DFHEIV0
  5840     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5841     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5842     MOVE X'2020233030303035323533' TO DFHEIV0(25:11)
  5843     CALL 'kxdfhei1' USING DFHEIV0,
  5844           FILE-ID-ERCKWK,
  5845           DFHEIV20,
  5846           DFHEIV99,
  5847           ERCKWK-KEY,
  5848           DFHEIV99,
  5849           DFHEIV11,
  5850           DFHEIV99,
  5851           DFHEIV99
  5852     SET ADDRESS OF CHECK-WORK-RECORDS TO
  5853         DFHEIV20
  5854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5855
  5856
  5857     IF PI-COMPANY-CD  NOT =  CW-COMPANY-CD
  5858         GO TO      3490-FINISHED.
  5859
  5860     IF CW-COMPANY-CD = SVCKWK-COMPANY-CD AND
  5861        CW-CARRIER    = SVCKWK-CARRIER    AND
  5862        CW-CSR        = SVCKWK-CSR        AND
  5863        CW-GROUPING   = SVCKWK-GROUPING   AND
  5864        CW-PAYEE      = SVCKWK-PAYEE      AND
  5865        CW-PAYEE-SEQ  = SVCKWK-PAYEE-SEQ
  5866        NEXT SENTENCE
  5867     ELSE
  5868        GO TO 3490-FINISHED.
  5869
  5870     IF CW-HEADER OR CW-TEXT
  5871         GO TO 3420-READ-CHECK-WORK-FILE.
  5872
  5873
  5874* EXEC CICS ENDBR
  5875*         DATASET (FILE-ID-ERCKWK)
  5876*    END-EXEC.
  5877     MOVE 0
  5878       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL636.cbl
  5879*    MOVE '&2                    $   #00005275' TO DFHEIV0
  5880     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5881     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5882     MOVE X'2020233030303035323735' TO DFHEIV0(25:11)
  5883     CALL 'kxdfhei1' USING DFHEIV0,
  5884           FILE-ID-ERCKWK,
  5885           DFHEIV11,
  5886           DFHEIV99
  5887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5888
  5889
  5890
  5891* EXEC CICS READ
  5892*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  5893*        DATASET (FILE-ID-ERCKWK)
  5894*        RIDFLD  (ERCKWK-KEY)
  5895*        UPDATE
  5896*    END-EXEC.
  5897*    MOVE '&"S        EU         (   #00005279' TO DFHEIV0
  5898     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5899     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5900     MOVE X'2020233030303035323739' TO DFHEIV0(25:11)
  5901     CALL 'kxdfhei1' USING DFHEIV0,
  5902           FILE-ID-ERCKWK,
  5903           DFHEIV20,
  5904           DFHEIV99,
  5905           ERCKWK-KEY,
  5906           DFHEIV99,
  5907           DFHEIV99,
  5908           DFHEIV99
  5909     SET ADDRESS OF CHECK-WORK-RECORDS TO
  5910         DFHEIV20
  5911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5912
  5913
  5914     MOVE CHECK-WORK-RECORDS     TO SAVE-ERCKWK-RECORD.
  5915
  5916
  5917* EXEC CICS DELETE
  5918*         DATASET (FILE-ID-ERCKWK)
  5919*    END-EXEC.
  5920*    MOVE '&(                    &   #00005288' TO DFHEIV0
  5921     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5922     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5923     MOVE X'2020233030303035323838' TO DFHEIV0(25:11)
  5924     CALL 'kxdfhei1' USING DFHEIV0,
  5925           FILE-ID-ERCKWK,
  5926           DFHEIV99,
  5927           DFHEIV99,
  5928           DFHEIV99,
  5929           DFHEIV99
  5930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5931
  5932
  5933     MOVE SAVE-ERCKWK-RECORD     TO CHECK-WORK-RECORDS.
  5934
  5935     MOVE WS-SEQUENCE-NO         TO SAVE-CKWK-SEQ-NO
  5936                                    ERCKWK-SEQUENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL636.cbl
  5937
  5938
  5939* EXEC CICS HANDLE CONDITION
  5940*         DUPREC  (9990-ABEND)
  5941*    END-EXEC.
  5942*    MOVE '"$%                   ! 1 #00005297' TO DFHEIV0
  5943     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  5944     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5945     MOVE X'3120233030303035323937' TO DFHEIV0(25:11)
  5946     CALL 'kxdfhei1' USING DFHEIV0
  5947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5948
  5949
  5950
  5951* EXEC CICS WRITE
  5952*         FROM    (SAVE-ERCKWK-RECORD)
  5953*         DATASET (FILE-ID-ERCKWK)
  5954*         RIDFLD  (ERCKWK-KEY)
  5955*    END-EXEC.
  5956     MOVE LENGTH OF
  5957      SAVE-ERCKWK-RECORD
  5958       TO DFHEIV11
  5959*    MOVE '&$ L                  ''   #00005301' TO DFHEIV0
  5960     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5961     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5962     MOVE X'2020233030303035333031' TO DFHEIV0(25:11)
  5963     CALL 'kxdfhei1' USING DFHEIV0,
  5964           FILE-ID-ERCKWK,
  5965           SAVE-ERCKWK-RECORD,
  5966           DFHEIV11,
  5967           ERCKWK-KEY,
  5968           DFHEIV99,
  5969           DFHEIV99
  5970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5971
  5972
  5973     ADD +1                      TO WS-SEQUENCE-NO
  5974                                    ERCKWK-SEQUENCE-NO.
  5975     GO TO 3410-BROWSE-CHECK-WORK-FILE.
  5976
  5977 3490-FINISHED.
  5978
  5979     MOVE SAVE-ERCKWK-CONTROL  TO ERCKWK-KEY.
  5980
  5981
  5982* EXEC CICS ENDBR
  5983*         DATASET (FILE-ID-ERCKWK)
  5984*    END-EXEC.
  5985     MOVE 0
  5986       TO DFHEIV11
  5987*    MOVE '&2                    $   #00005315' TO DFHEIV0
  5988     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5989     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5990     MOVE X'2020233030303035333135' TO DFHEIV0(25:11)
  5991     CALL 'kxdfhei1' USING DFHEIV0,
  5992           FILE-ID-ERCKWK,
  5993           DFHEIV11,
  5994           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL636.cbl
  5995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5996
  5997
  5998 3499-EXIT.
  5999     EXIT.
  6000
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL636.cbl
  6002******************************************************************
  6003*                                                                *
  6004*             D E L E T E   P A Y E E                            *
  6005*                                                                *
  6006******************************************************************
  6007
  6008 4000-DELETE-PAYEE.
  6009
  6010     MOVE 'D'                    TO PI-MAINT-FUNCTION.
  6011
  6012     MOVE PI-COMPANY-CD          TO ERCKWK-COMPANY-CD.
  6013     MOVE CSRI                   TO ERCKWK-CSR.
  6014     MOVE CARI                   TO ERCKWK-CARRIER.
  6015     MOVE GROUPI                 TO ERCKWK-GROUPING.
  6016     MOVE PAYEEI                 TO ERCKWK-PAYEE.
  6017     MOVE PAYSEQI                TO ERCKWK-PAYEE-SEQ.
  6018     MOVE +0                     TO ERCKWK-SEQUENCE-NO.
  6019
  6020     MOVE ERCKWK-KEY             TO SAVE-ERCKWK-CONTROL.
  6021
  6022
  6023* EXEC CICS HANDLE CONDITION
  6024*        NOTFND    (4080-PAYEE-NOTFND)
  6025*        ENDFILE   (4070-PAYEE-DELETED)
  6026*    END-EXEC.
  6027*    MOVE '"$I''                  ! 2 #00005343' TO DFHEIV0
  6028     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6029     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6030     MOVE X'3220233030303035333433' TO DFHEIV0(25:11)
  6031     CALL 'kxdfhei1' USING DFHEIV0
  6032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6033
  6034
  6035 4010-READ-CHECK-WORK-FILE.
  6036
  6037
  6038* EXEC CICS STARTBR
  6039*        DATASET (FILE-ID-ERCKWK)
  6040*        RIDFLD  (ERCKWK-KEY)
  6041*    END-EXEC.
  6042     MOVE 0
  6043       TO DFHEIV11
  6044*    MOVE '&,         G          &   #00005350' TO DFHEIV0
  6045     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6046     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6047     MOVE X'2020233030303035333530' TO DFHEIV0(25:11)
  6048     CALL 'kxdfhei1' USING DFHEIV0,
  6049           FILE-ID-ERCKWK,
  6050           ERCKWK-KEY,
  6051           DFHEIV99,
  6052           DFHEIV11,
  6053           DFHEIV99
  6054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6055
  6056
  6057
  6058* EXEC CICS READNEXT
  6059*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL636.cbl
  6060*        DATASET (FILE-ID-ERCKWK)
  6061*        RIDFLD  (ERCKWK-KEY)
  6062*    END-EXEC.
  6063     MOVE 0
  6064       TO DFHEIV11
  6065*    MOVE '&.S                   )   #00005355' TO DFHEIV0
  6066     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6067     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6068     MOVE X'2020233030303035333535' TO DFHEIV0(25:11)
  6069     CALL 'kxdfhei1' USING DFHEIV0,
  6070           FILE-ID-ERCKWK,
  6071           DFHEIV20,
  6072           DFHEIV99,
  6073           ERCKWK-KEY,
  6074           DFHEIV99,
  6075           DFHEIV11,
  6076           DFHEIV99,
  6077           DFHEIV99
  6078     SET ADDRESS OF CHECK-WORK-RECORDS TO
  6079         DFHEIV20
  6080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6081
  6082
  6083     IF PI-COMPANY-CD  NOT =  CW-COMPANY-CD
  6084         GO TO      4070-PAYEE-DELETED.
  6085
  6086     IF CW-COMPANY-CD = SVCKWK-COMPANY-CD AND
  6087        CW-CSR        = SVCKWK-CSR        AND
  6088        CW-CARRIER    = SVCKWK-CARRIER    AND
  6089        CW-GROUPING   = SVCKWK-GROUPING   AND
  6090        CW-PAYEE      = SVCKWK-PAYEE      AND
  6091        CW-PAYEE-SEQ  = SVCKWK-PAYEE-SEQ
  6092        NEXT SENTENCE
  6093     ELSE
  6094        GO TO 4070-PAYEE-DELETED.
  6095
  6096     IF CW-RELEASE-DT GREATER THAN LOW-VALUES
  6097         GO TO 4090-PAYEE-RELEASED.
  6098
  6099
  6100* EXEC CICS ENDBR
  6101*         DATASET (FILE-ID-ERCKWK)
  6102*    END-EXEC.
  6103     MOVE 0
  6104       TO DFHEIV11
  6105*    MOVE '&2                    $   #00005377' TO DFHEIV0
  6106     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6107     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6108     MOVE X'2020233030303035333737' TO DFHEIV0(25:11)
  6109     CALL 'kxdfhei1' USING DFHEIV0,
  6110           FILE-ID-ERCKWK,
  6111           DFHEIV11,
  6112           DFHEIV99
  6113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6114
  6115
  6116
  6117* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL636.cbl
  6118*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  6119*        DATASET (FILE-ID-ERCKWK)
  6120*        RIDFLD  (ERCKWK-KEY)
  6121*        UPDATE
  6122*    END-EXEC.
  6123*    MOVE '&"S        EU         (   #00005381' TO DFHEIV0
  6124     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6125     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6126     MOVE X'2020233030303035333831' TO DFHEIV0(25:11)
  6127     CALL 'kxdfhei1' USING DFHEIV0,
  6128           FILE-ID-ERCKWK,
  6129           DFHEIV20,
  6130           DFHEIV99,
  6131           ERCKWK-KEY,
  6132           DFHEIV99,
  6133           DFHEIV99,
  6134           DFHEIV99
  6135     SET ADDRESS OF CHECK-WORK-RECORDS TO
  6136         DFHEIV20
  6137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6138
  6139
  6140
  6141* EXEC CICS DELETE
  6142*         DATASET (FILE-ID-ERCKWK)
  6143*    END-EXEC.
  6144*    MOVE '&(                    &   #00005388' TO DFHEIV0
  6145     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  6146     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6147     MOVE X'2020233030303035333838' TO DFHEIV0(25:11)
  6148     CALL 'kxdfhei1' USING DFHEIV0,
  6149           FILE-ID-ERCKWK,
  6150           DFHEIV99,
  6151           DFHEIV99,
  6152           DFHEIV99,
  6153           DFHEIV99
  6154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6155
  6156
  6157
  6158     GO TO 4010-READ-CHECK-WORK-FILE.
  6159
  6160 4070-PAYEE-DELETED.
  6161
  6162     MOVE LOW-VALUES             TO  EL636AI.
  6163     MOVE SVCKWK-CSR             TO  CSRO.
  6164     MOVE SVCKWK-CARRIER         TO  CARO.
  6165     MOVE SVCKWK-GROUPING        TO  GROUPO.
  6166     MOVE SVCKWK-PAYEE           TO  PAYEEO.
  6167     MOVE SVCKWK-PAYEE-SEQ       TO  PAYSEQO.
  6168
  6169     MOVE AL-UANON               TO  CSRA
  6170                                     CARA
  6171                                     GROUPA
  6172                                     PAYEEA
  6173                                     PAYSEQA.
  6174
  6175     MOVE ER-0000                TO  EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL636.cbl
  6176     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6177     MOVE -1                     TO  MAINTL.
  6178     GO TO 8100-SEND-INITIAL-MAP.
  6179
  6180 4080-PAYEE-NOTFND.
  6181
  6182     MOVE ER-3160                TO EMI-ERROR.
  6183     MOVE -1                     TO CARL.
  6184     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6185     GO TO 8200-SEND-DATAONLY.
  6186
  6187 4090-PAYEE-RELEASED.
  6188
  6189
  6190* EXEC CICS UNLOCK
  6191*         DATASET (FILE-ID-ERCKWK)
  6192*    END-EXEC.
  6193*    MOVE '&*                    #   #00005424' TO DFHEIV0
  6194     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  6195     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6196     MOVE X'2020233030303035343234' TO DFHEIV0(25:11)
  6197     CALL 'kxdfhei1' USING DFHEIV0,
  6198           FILE-ID-ERCKWK,
  6199           DFHEIV99
  6200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6201
  6202
  6203     MOVE ER-3139                TO EMI-ERROR.
  6204     MOVE -1                     TO MAINTL.
  6205     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6206     GO TO 8200-SEND-DATAONLY.
  6207
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL636.cbl
  6209
  6210******************************************************************
  6211*                                                                *
  6212*               D I S P L A Y   P A Y E E                        *
  6213*                                                                *
  6214******************************************************************
  6215
  6216 5000-DISPLAY-PAYEE.
  6217
  6218     MOVE 'Y' TO WS-FIRST-DETAIL-SW.
  6219
  6220     MOVE PI-ERCKWK-COMP-CD      TO ERCKWK-COMPANY-CD.
  6221     MOVE PI-ERCKWK-CSR          TO ERCKWK-CSR.
  6222     MOVE PI-ERCKWK-CARRIER      TO ERCKWK-CARRIER.
  6223     MOVE PI-ERCKWK-GROUPING     TO ERCKWK-GROUPING.
  6224     MOVE PI-ERCKWK-PAYEE        TO ERCKWK-PAYEE.
  6225     MOVE PI-ERCKWK-PAYEE-SEQ    TO ERCKWK-PAYEE-SEQ.
  6226     MOVE ZEROS                  TO ERCKWK-SEQUENCE-NO.
  6227
  6228     IF EIBAID = DFHPF3
  6229         MOVE PI-LAST-STUB-KEY    TO ERCKWK-KEY
  6230                                     PI-ERCKWK-KEY
  6231         MOVE ZEROS               TO ERCKWK-SEQUENCE-NO
  6232                                     PI-ERCKWK-SEQ-NO
  6233         MOVE PI-LAST-STUB-SEQ-NO TO WS-NOFIRST.
  6234
  6235
  6236* EXEC CICS HANDLE CONDITION
  6237*        NOTFND    (5090-CHECKS-NOTFND)
  6238*        ENDFILE   (5090-CHECKS-NOTFND)
  6239*    END-EXEC.
  6240*    MOVE '"$I''                  ! 3 #00005460' TO DFHEIV0
  6241     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6242     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6243     MOVE X'3320233030303035343630' TO DFHEIV0(25:11)
  6244     CALL 'kxdfhei1' USING DFHEIV0
  6245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6246
  6247
  6248
  6249* EXEC CICS READ
  6250*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  6251*        DATASET (FILE-ID-ERCKWK)
  6252*        RIDFLD  (ERCKWK-KEY)
  6253*    END-EXEC.
  6254*    MOVE '&"S        E          (   #00005465' TO DFHEIV0
  6255     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6256     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6257     MOVE X'2020233030303035343635' TO DFHEIV0(25:11)
  6258     CALL 'kxdfhei1' USING DFHEIV0,
  6259           FILE-ID-ERCKWK,
  6260           DFHEIV20,
  6261           DFHEIV99,
  6262           ERCKWK-KEY,
  6263           DFHEIV99,
  6264           DFHEIV99,
  6265           DFHEIV99
  6266     SET ADDRESS OF CHECK-WORK-RECORDS TO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL636.cbl
  6267         DFHEIV20
  6268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6269
  6270
  6271     IF PI-COMPANY-CD  NOT =  CW-COMPANY-CD
  6272         GO TO      5090-CHECKS-NOTFND.
  6273
  6274 5020-FOUND.
  6275     IF NOT CW-HEADER
  6276        GO TO 5090-CHECKS-NOTFND.
  6277
  6278     MOVE +1 TO WS-SUB1.
  6279 5000-SAVE-MAINT.
  6280
  6281     IF WS-SUB1 LESS THAN +6
  6282         MOVE CK-MAINT (WS-SUB1) TO WS-HOLD-MAINT (WS-SUB1)
  6283         ADD +1 TO WS-SUB1
  6284         GO TO 5000-SAVE-MAINT.
  6285
  6286     MOVE MAINTI TO WS-SAVE-ACTION-CODE.
  6287     MOVE LOW-VALUES             TO  EL636AI.
  6288     MOVE 'C'                    TO  MAINTI.
  6289     MOVE AL-UANON               TO  MAINTA.
  6290     MOVE CW-CSR                 TO  CSRO.
  6291     MOVE AL-UANON               TO  CSRA.
  6292     MOVE CW-CARRIER             TO  CARO.
  6293     MOVE AL-UANON               TO  CARA.
  6294     MOVE CW-GROUPING            TO  GROUPO.
  6295     MOVE AL-UANON               TO  GROUPA.
  6296     MOVE CW-PAYEE               TO  PAYEEO.
  6297     MOVE AL-UANON               TO  PAYEEA.
  6298     MOVE CW-PAYEE-SEQ           TO  PAYSEQO.
  6299     MOVE AL-UANON               TO  PAYSEQA.
  6300     MOVE CW-PAYEE-NAME          TO  PAYTOO.
  6301     MOVE AL-UANON               TO  PAYTOA.
  6302     MOVE CW-ADDRESS-1           TO  ADDRS1O.
  6303     MOVE AL-UANON               TO  ADDRS1A.
  6304     MOVE CW-ADDRESS-2           TO  ADDRS2O.
  6305     MOVE AL-UANON               TO  ADDRS2A.
  6306     MOVE CW-PAYEE-CITY-ST       TO  CITYSTO.
  6307     MOVE AL-UANON               TO  CITYSTA.
  6308     MOVE CW-PAYEE-ZIP           TO  ZIPO.
  6309     MOVE AL-UANON               TO  ZIPA.
  6310     MOVE CW-PAYEE-ZIP-EXT       TO  ZIPEXTO.
  6311     MOVE AL-UANON               TO  ZIPEXTA.
  6312
  6313
  6314     MOVE AL-SANON               TO  PFKEY8A.
  6315
  6316     IF CW-RECORDED-BY = 'OFFL'
  6317        MOVE 'OFF-LINE'          TO  MAINTBYO
  6318     ELSE
  6319        MOVE CW-RECORDED-BY      TO  MAINTBYO.
  6320
  6321     MOVE CW-LAST-MAINT-HHMMSS   TO  WS-TIME.
  6322     MOVE WS-HR-MINS             TO  MAINTATO.
  6323     MOVE CW-RECORDED-DT         TO  DC-BIN-DATE-1.
  6324     MOVE SPACE                  TO  DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL636.cbl
  6325     PERFORM 8500-DATE-CONVERT.
  6326
  6327     IF NO-CONVERSION-ERROR
  6328        MOVE DC-GREG-DATE-1-EDIT TO  MAINTONO.
  6329
  6330     MOVE CW-RELEASE-DT          TO  DC-BIN-DATE-1.
  6331     MOVE SPACE                  TO  DC-OPTION-CODE.
  6332     PERFORM 8500-DATE-CONVERT.
  6333
  6334     IF NO-CONVERSION-ERROR
  6335        MOVE DC-GREG-DATE-1-EDIT TO  RELDTO.
  6336
  6337     MOVE CW-TOTAL-COMMISSION    TO  CHKAMTO.
  6338     MOVE CW-TOTAL-ENTRIES       TO  NOENTRSO.
  6339     MOVE AL-UNNON               TO  NOFIRSTA.
  6340     MOVE ZEROS                  TO  NOFIRSTO
  6341                                     NOLASTO.
  6342
  6343     MOVE PI-ERCKWK-KEY          TO  PI-LAST-STUB-KEY.
  6344
  6345     IF SHOW-FUNCTION  AND
  6346         WS-NOFIRST GREATER +0
  6347         IF WS-NOFIRST GREATER THAN CW-TOTAL-ENTRIES
  6348             IF CW-TOTAL-ENTRIES GREATER THAN +5
  6349                 SUBTRACT +5 FROM CW-TOTAL-ENTRIES
  6350                                    GIVING  PI-ERCKWK-SEQ-NO
  6351             ELSE
  6352                 MOVE +1 TO  PI-ERCKWK-SEQ-NO
  6353         ELSE
  6354             MOVE WS-NOFIRST TO  PI-ERCKWK-SEQ-NO.
  6355
  6356     IF  EIBAID = DFHPF3
  6357         IF WS-NOFIRST LESS THAN CW-TOTAL-ENTRIES
  6358             ADD +1 WS-NOFIRST GIVING PI-ERCKWK-SEQ-NO
  6359         ELSE
  6360             MOVE WS-NOFIRST          TO PI-ERCKWK-SEQ-NO.
  6361
  6362     MOVE PI-ERCKWK-KEY          TO SAVE-ERCKWK-CONTROL
  6363                                    PI-SAVE-ERCKWK-KEY.
  6364
  6365* EXEC CICS HANDLE CONDITION
  6366*        NOTFND    (5070-CHECK-PROCESSED)
  6367*        ENDFILE   (5060-END-OF-FILE)
  6368*    END-EXEC.
  6369*    MOVE '"$I''                  ! 4 #00005564' TO DFHEIV0
  6370     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6371     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6372     MOVE X'3420233030303035353634' TO DFHEIV0(25:11)
  6373     CALL 'kxdfhei1' USING DFHEIV0
  6374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6375
  6376
  6377     IF WS-BROWSE-SW  =  'Y'
  6378         GO TO 5049-SET.
  6379     MOVE SPACE                  TO WS-BROWSE-SW.
  6380
  6381
  6382* EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL636.cbl
  6383*        DATASET (FILE-ID-ERCKWK)
  6384*        RIDFLD  (PI-ERCKWK-KEY)
  6385*    END-EXEC.
  6386     MOVE 0
  6387       TO DFHEIV11
  6388*    MOVE '&,         G          &   #00005573' TO DFHEIV0
  6389     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6390     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6391     MOVE X'2020233030303035353733' TO DFHEIV0(25:11)
  6392     CALL 'kxdfhei1' USING DFHEIV0,
  6393           FILE-ID-ERCKWK,
  6394           PI-ERCKWK-KEY,
  6395           DFHEIV99,
  6396           DFHEIV11,
  6397           DFHEIV99
  6398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6399
  6400
  6401 5049-SET.
  6402     MOVE +0                     TO WS-SUB1
  6403                                    PI-NO-ENTRIES-DISPLAYED.
  6404     MOVE 'Y'                    TO WS-BROWSE-SW.
  6405
  6406 5050-READ-CHECK-WORK-FILE.
  6407
  6408
  6409* EXEC CICS READNEXT
  6410*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  6411*        DATASET (FILE-ID-ERCKWK)
  6412*        RIDFLD  (PI-ERCKWK-KEY)
  6413*    END-EXEC.
  6414     MOVE 0
  6415       TO DFHEIV11
  6416*    MOVE '&.S                   )   #00005585' TO DFHEIV0
  6417     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6418     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6419     MOVE X'2020233030303035353835' TO DFHEIV0(25:11)
  6420     CALL 'kxdfhei1' USING DFHEIV0,
  6421           FILE-ID-ERCKWK,
  6422           DFHEIV20,
  6423           DFHEIV99,
  6424           PI-ERCKWK-KEY,
  6425           DFHEIV99,
  6426           DFHEIV11,
  6427           DFHEIV99,
  6428           DFHEIV99
  6429     SET ADDRESS OF CHECK-WORK-RECORDS TO
  6430         DFHEIV20
  6431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6432
  6433
  6434     IF CW-COMPANY-CD = SVCKWK-COMPANY-CD AND
  6435        CW-CSR        = SVCKWK-CSR        AND
  6436        CW-CARRIER    = SVCKWK-CARRIER    AND
  6437        CW-GROUPING   = SVCKWK-GROUPING   AND
  6438        CW-PAYEE      = SVCKWK-PAYEE      AND
  6439        CW-PAYEE-SEQ  = SVCKWK-PAYEE-SEQ
  6440        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL636.cbl
  6441     ELSE
  6442        GO TO 5070-CHECK-PROCESSED.
  6443
  6444     IF CW-HEADER OR CW-TEXT
  6445        GO TO 5050-READ-CHECK-WORK-FILE
  6446     ELSE
  6447         IF  FIRST-DETAIL-READ
  6448             MOVE SPACES TO WS-FIRST-DETAIL-SW
  6449             MOVE AL-UNNON       TO  NOFIRSTA
  6450             MOVE CW-SEQUENCE-NO TO  NOFIRSTO.
  6451
  6452     ADD +1                      TO  WS-SUB1.
  6453
  6454     IF  WS-SUB1 GREATER THAN +5
  6455         GO TO 5070-CHECK-PROCESSED.
  6456
  6457     MOVE CW-SEQUENCE-NO         TO  NOLASTO.
  6458
  6459     MOVE CW-COMMENT             TO  CK-COMNTS      (WS-SUB1).
  6460     MOVE CW-ACCT-AGENT          TO  CK-AGENT       (WS-SUB1).
  6461
  6462     IF WS-HOLD-MAINT (WS-SUB1) EQUAL 'I'
  6463        MOVE CW-INVOICE          TO  CK-INVREF      (WS-SUB1)
  6464     ELSE
  6465        IF WS-HOLD-MAINT (WS-SUB1) EQUAL 'R'
  6466            MOVE CW-REFERENCE    TO  CK-INVREF      (WS-SUB1)
  6467        ELSE
  6468            IF CW-INVOICE GREATER THAN SPACES
  6469                MOVE CW-INVOICE   TO  CK-INVREF     (WS-SUB1)
  6470            ELSE
  6471                MOVE CW-REFERENCE TO  CK-INVREF     (WS-SUB1).
  6472
  6473     MOVE CW-LEDGER-NO           TO  CK-LEDGER      (WS-SUB1).
  6474     MOVE CW-PMT-APPLIED         TO  CK-AGOCD       (WS-SUB1).
  6475     MOVE CW-DETAIL-AMOUNT       TO  CK-DETAMT-OUT  (WS-SUB1).
  6476
  6477     MOVE PI-ERCKWK-KEY          TO  PI-STUB-KEY     (WS-SUB1)
  6478                                     PI-LAST-STUB-KEY.
  6479     MOVE CW-ACCT-AGENT          TO  PI-STUB-ACCT   (WS-SUB1).
  6480
  6481     IF CW-LAST-MAINT-APPLIED EQUAL 'H'
  6482         MOVE CW-LAST-MAINT-APPLIED
  6483                                 TO  CK-MAINT (WS-SUB1)
  6484         MOVE 'THIS ITEM ON HOLD'
  6485                                 TO  CK-COMNTS       (WS-SUB1)
  6486         MOVE +0                 TO  CK-COMNTS-LEN   (WS-SUB1)
  6487         MOVE AL-UNBOF           TO  CK-DETAMT-ATTRB (WS-SUB1)
  6488         MOVE AL-UABOF           TO  CK-COMNTS-ATTRB (WS-SUB1)
  6489                                     CK-MAINT-ATTRB  (WS-SUB1)
  6490                                     CK-AGENT-ATTRB  (WS-SUB1)
  6491                                     CK-INVREF-ATTRB (WS-SUB1)
  6492                                     CK-LEDGER-ATTRB (WS-SUB1)
  6493                                     CK-AGOCD-ATTRB  (WS-SUB1).
  6494
  6495     MOVE WS-SUB1                TO  PI-NO-ENTRIES-DISPLAYED.
  6496
  6497     GO TO 5050-READ-CHECK-WORK-FILE.
  6498
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL636.cbl
  6499 5060-END-OF-FILE.
  6500
  6501     MOVE ER-2251                TO EMI-ERROR.
  6502     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6503
  6504 5070-CHECK-PROCESSED.
  6505
  6506     IF WS-BROWSE-STARTED
  6507
  6508* EXEC CICS ENDBR
  6509*            DATASET (FILE-ID-ERCKWK)
  6510*       END-EXEC.
  6511     MOVE 0
  6512       TO DFHEIV11
  6513*    MOVE '&2                    $   #00005664' TO DFHEIV0
  6514     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6515     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6516     MOVE X'2020233030303035363634' TO DFHEIV0(25:11)
  6517     CALL 'kxdfhei1' USING DFHEIV0,
  6518           FILE-ID-ERCKWK,
  6519           DFHEIV11,
  6520           DFHEIV99
  6521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6522
  6523
  6524     IF EIBAID = DFHPF3
  6525         MOVE ' '                TO  PI-PREV-FUNCTION.
  6526
  6527     MOVE 'S'                    TO  PI-MAINT-FUNCTION.
  6528     MOVE -1                     TO  MAINTL.
  6529     GO TO 8100-SEND-INITIAL-MAP.
  6530
  6531 5090-CHECKS-NOTFND.
  6532
  6533     IF WS-BROWSE-STARTED
  6534
  6535* EXEC CICS ENDBR
  6536*            DATASET (FILE-ID-ERCKWK)
  6537*       END-EXEC.
  6538     MOVE 0
  6539       TO DFHEIV11
  6540*    MOVE '&2                    $   #00005678' TO DFHEIV0
  6541     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6542     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6543     MOVE X'2020233030303035363738' TO DFHEIV0(25:11)
  6544     CALL 'kxdfhei1' USING DFHEIV0,
  6545           FILE-ID-ERCKWK,
  6546           DFHEIV11,
  6547           DFHEIV99
  6548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6549
  6550
  6551
  6552* EXEC CICS HANDLE CONDITION
  6553*        NOTFND    (5095-CHECKS-NOTFND)
  6554*        ENDFILE   (5095-CHECKS-NOTFND)
  6555*    END-EXEC.
  6556*    MOVE '"$I''                  ! 5 #00005682' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL636.cbl
  6557     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6558     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6559     MOVE X'3520233030303035363832' TO DFHEIV0(25:11)
  6560     CALL 'kxdfhei1' USING DFHEIV0
  6561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6562
  6563
  6564     MOVE SPACE                  TO WS-BROWSE-SW.
  6565
  6566
  6567* EXEC CICS STARTBR
  6568*        DATASET (FILE-ID-ERCKWK)
  6569*        RIDFLD  (PI-ERCKWK-KEY)
  6570*        GTEQ
  6571*    END-EXEC.
  6572     MOVE 0
  6573       TO DFHEIV11
  6574*    MOVE '&,         G          &   #00005689' TO DFHEIV0
  6575     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6576     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6577     MOVE X'2020233030303035363839' TO DFHEIV0(25:11)
  6578     CALL 'kxdfhei1' USING DFHEIV0,
  6579           FILE-ID-ERCKWK,
  6580           PI-ERCKWK-KEY,
  6581           DFHEIV99,
  6582           DFHEIV11,
  6583           DFHEIV99
  6584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6585
  6586
  6587     MOVE 'Y'                    TO WS-BROWSE-SW.
  6588
  6589
  6590* EXEC CICS READNEXT
  6591*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  6592*        DATASET (FILE-ID-ERCKWK)
  6593*        RIDFLD  (PI-ERCKWK-KEY)
  6594*    END-EXEC.
  6595     MOVE 0
  6596       TO DFHEIV11
  6597*    MOVE '&.S                   )   #00005697' TO DFHEIV0
  6598     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6599     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6600     MOVE X'2020233030303035363937' TO DFHEIV0(25:11)
  6601     CALL 'kxdfhei1' USING DFHEIV0,
  6602           FILE-ID-ERCKWK,
  6603           DFHEIV20,
  6604           DFHEIV99,
  6605           PI-ERCKWK-KEY,
  6606           DFHEIV99,
  6607           DFHEIV11,
  6608           DFHEIV99,
  6609           DFHEIV99
  6610     SET ADDRESS OF CHECK-WORK-RECORDS TO
  6611         DFHEIV20
  6612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6613
  6614
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL636.cbl
  6615     IF PI-COMPANY-CD  NOT =  CW-COMPANY-CD
  6616         GO TO      5095-CHECKS-NOTFND
  6617     ELSE
  6618         GO TO      5020-FOUND.
  6619
  6620
  6621 5095-CHECKS-NOTFND.
  6622     MOVE SPACE                  TO PI-MAINT-FUNCTION.
  6623     MOVE ER-3160                TO EMI-ERROR.
  6624     MOVE -1                     TO CARL.
  6625     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6626     GO TO 8200-SEND-DATAONLY.
  6627
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL636.cbl
  6629
  6630******************************************************************
  6631*                                                                *
  6632*            D I S P L A Y   N E X T   P A Y E E                 *
  6633*                                                                *
  6634******************************************************************
  6635
  6636 6000-DISPLAY-NEXT-PAYEE.
  6637
  6638     MOVE PI-LAST-STUB-KEY       TO PI-ERCKWK-KEY.
  6639     MOVE PI-COMPANY-CD          TO PI-ERCKWK-COMP-CD.
  6640
  6641     IF PI-LAST-STUB-CSR = SPACES
  6642         MOVE LOW-VALUES         TO PI-LAST-STUB-CSR.
  6643
  6644     MOVE  PI-LAST-STUB-CSR      TO PI-ERCKWK-CSR
  6645
  6646     MOVE +9999                  TO PI-ERCKWK-SEQ-NO.
  6647
  6648
  6649* EXEC CICS HANDLE CONDITION
  6650*        ENDFILE   (6060-END-OF-FILE)
  6651*    END-EXEC.
  6652*    MOVE '"$''                   ! 6 #00005736' TO DFHEIV0
  6653     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  6654     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6655     MOVE X'3620233030303035373336' TO DFHEIV0(25:11)
  6656     CALL 'kxdfhei1' USING DFHEIV0
  6657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6658
  6659
  6660 6010-READ-NEXT-PAYEE.
  6661
  6662
  6663* EXEC CICS READ
  6664*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  6665*        DATASET (FILE-ID-ERCKWK)
  6666*        RIDFLD  (PI-ERCKWK-KEY)
  6667*        GTEQ
  6668*    END-EXEC.
  6669*    MOVE '&"S        G          (   #00005742' TO DFHEIV0
  6670     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6671     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6672     MOVE X'2020233030303035373432' TO DFHEIV0(25:11)
  6673     CALL 'kxdfhei1' USING DFHEIV0,
  6674           FILE-ID-ERCKWK,
  6675           DFHEIV20,
  6676           DFHEIV99,
  6677           PI-ERCKWK-KEY,
  6678           DFHEIV99,
  6679           DFHEIV99,
  6680           DFHEIV99
  6681     SET ADDRESS OF CHECK-WORK-RECORDS TO
  6682         DFHEIV20
  6683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6684
  6685
  6686     IF CW-COMPANY-CD NOT = PI-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL636.cbl
  6687        GO TO 6060-END-OF-FILE.
  6688
  6689     MOVE  CW-CSR                TO  PI-ERCKWK-CSR.
  6690     MOVE  CW-CARRIER            TO  PI-ERCKWK-CARRIER.
  6691     MOVE  CW-GROUPING           TO  PI-ERCKWK-GROUPING.
  6692     MOVE  CW-PAYEE              TO  PI-ERCKWK-PAYEE.
  6693     MOVE  CW-PAYEE-SEQ          TO  PI-ERCKWK-PAYEE-SEQ.
  6694     MOVE  CW-SEQUENCE-NO        TO  PI-ERCKWK-SEQ-NO.
  6695
  6696     GO TO 5000-DISPLAY-PAYEE.
  6697
  6698 6060-END-OF-FILE.
  6699
  6700     MOVE SPACE                  TO PI-MAINT-FUNCTION.
  6701     MOVE ER-2251                TO EMI-ERROR.
  6702     MOVE -1                     TO CARL.
  6703     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6704     GO TO 8200-SEND-DATAONLY.
  6705
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL636.cbl
  6707
  6708******************************************************************
  6709*                                                                *
  6710*            D I S P L A Y   P R E V   P A Y E E                 *
  6711*                                                                *
  6712******************************************************************
  6713
  6714 6100-DISPLAY-PREV-PAYEE.
  6715
  6716     IF PI-LAST-STUB-KEY EQUAL SPACES
  6717         GO TO 6160-END-OF-FILE.
  6718
  6719     MOVE PI-LAST-STUB-KEY       TO PI-ERCKWK-KEY.
  6720
  6721     IF PI-ERCKWK-SEQ-NO GREATER THAN +5
  6722         MOVE +1 TO PI-ERCKWK-SEQ-NO
  6723         GO TO 5000-DISPLAY-PAYEE.
  6724
  6725     MOVE PI-COMPANY-CD          TO PI-ERCKWK-COMP-CD.
  6726     MOVE +0000                  TO PI-ERCKWK-SEQ-NO.
  6727
  6728
  6729* EXEC CICS HANDLE CONDITION
  6730*        ENDFILE   (6160-END-OF-FILE)
  6731*    END-EXEC.
  6732*    MOVE '"$''                   ! 7 #00005791' TO DFHEIV0
  6733     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  6734     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6735     MOVE X'3720233030303035373931' TO DFHEIV0(25:11)
  6736     CALL 'kxdfhei1' USING DFHEIV0
  6737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6738
  6739
  6740
  6741* EXEC CICS STARTBR
  6742*        DATASET (FILE-ID-ERCKWK)
  6743*        RIDFLD  (PI-ERCKWK-KEY)
  6744*    END-EXEC.
  6745     MOVE 0
  6746       TO DFHEIV11
  6747*    MOVE '&,         G          &   #00005795' TO DFHEIV0
  6748     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6749     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6750     MOVE X'2020233030303035373935' TO DFHEIV0(25:11)
  6751     CALL 'kxdfhei1' USING DFHEIV0,
  6752           FILE-ID-ERCKWK,
  6753           PI-ERCKWK-KEY,
  6754           DFHEIV99,
  6755           DFHEIV11,
  6756           DFHEIV99
  6757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6758
  6759
  6760     MOVE PI-ERCKWK-KEY          TO SVCKWK-COMPARE-KEY.
  6761
  6762
  6763* EXEC CICS READNEXT
  6764*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL636.cbl
  6765*        DATASET (FILE-ID-ERCKWK)
  6766*        RIDFLD  (PI-ERCKWK-KEY)
  6767*    END-EXEC.
  6768     MOVE 0
  6769       TO DFHEIV11
  6770*    MOVE '&.S                   )   #00005802' TO DFHEIV0
  6771     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6772     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6773     MOVE X'2020233030303035383032' TO DFHEIV0(25:11)
  6774     CALL 'kxdfhei1' USING DFHEIV0,
  6775           FILE-ID-ERCKWK,
  6776           DFHEIV20,
  6777           DFHEIV99,
  6778           PI-ERCKWK-KEY,
  6779           DFHEIV99,
  6780           DFHEIV11,
  6781           DFHEIV99,
  6782           DFHEIV99
  6783     SET ADDRESS OF CHECK-WORK-RECORDS TO
  6784         DFHEIV20
  6785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6786
  6787
  6788
  6789* EXEC CICS RESETBR
  6790*        DATASET (FILE-ID-ERCKWK)
  6791*        RIDFLD  (PI-ERCKWK-KEY)
  6792*    END-EXEC.
  6793     MOVE 0
  6794       TO DFHEIV11
  6795*    MOVE '&4         G          &   #00005808' TO DFHEIV0
  6796     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
  6797     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6798     MOVE X'2020233030303035383038' TO DFHEIV0(25:11)
  6799     CALL 'kxdfhei1' USING DFHEIV0,
  6800           FILE-ID-ERCKWK,
  6801           PI-ERCKWK-KEY,
  6802           DFHEIV99,
  6803           DFHEIV11,
  6804           DFHEIV99
  6805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6806
  6807
  6808 6110-READ-PREV-ENTRY.
  6809
  6810
  6811* EXEC CICS READPREV
  6812*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  6813*        DATASET (FILE-ID-ERCKWK)
  6814*        RIDFLD  (PI-ERCKWK-KEY)
  6815*    END-EXEC.
  6816     MOVE 0
  6817       TO DFHEIV11
  6818*    MOVE '&0S                   )   #00005815' TO DFHEIV0
  6819     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  6820     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6821     MOVE X'2020233030303035383135' TO DFHEIV0(25:11)
  6822     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL636.cbl
  6823           FILE-ID-ERCKWK,
  6824           DFHEIV20,
  6825           DFHEIV99,
  6826           PI-ERCKWK-KEY,
  6827           DFHEIV99,
  6828           DFHEIV11,
  6829           DFHEIV99,
  6830           DFHEIV99
  6831     SET ADDRESS OF CHECK-WORK-RECORDS TO
  6832         DFHEIV20
  6833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6834
  6835
  6836     IF PI-COMPANY-CD  NOT =  CW-COMPANY-CD
  6837         GO TO      6160-END-OF-FILE.
  6838
  6839     MOVE PI-ERCKWK-KEY          TO ERCKWK-COMPARE-KEY.
  6840
  6841     IF ERCKWK-COMPARE-KEY LESS THAN SVCKWK-COMPARE-KEY
  6842        NEXT SENTENCE
  6843     ELSE
  6844        GO TO 6110-READ-PREV-ENTRY.
  6845
  6846     MOVE +1                     TO PI-ERCKWK-SEQ-NO.
  6847
  6848
  6849* EXEC CICS ENDBR
  6850*         DATASET (FILE-ID-ERCKWK)
  6851*    END-EXEC.
  6852     MOVE 0
  6853       TO DFHEIV11
  6854*    MOVE '&2                    $   #00005833' TO DFHEIV0
  6855     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6856     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6857     MOVE X'2020233030303035383333' TO DFHEIV0(25:11)
  6858     CALL 'kxdfhei1' USING DFHEIV0,
  6859           FILE-ID-ERCKWK,
  6860           DFHEIV11,
  6861           DFHEIV99
  6862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6863
  6864
  6865     IF PI-ERCKWK-COMP-CD NOT = PI-COMPANY-CD
  6866        GO TO 6160-END-OF-FILE
  6867     ELSE
  6868        GO TO 5000-DISPLAY-PAYEE.
  6869
  6870 6160-END-OF-FILE.
  6871
  6872     MOVE SPACE                  TO PI-MAINT-FUNCTION.
  6873     MOVE ER-2252                TO EMI-ERROR.
  6874     MOVE -1                     TO CARL.
  6875     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6876     GO TO 8200-SEND-DATAONLY.
  6877
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL636.cbl
  6879
  6880******************************************************************
  6881*                                                                *
  6882*         D I S P L A Y   P R E V   E N T E R I E S              *
  6883*                                                                *
  6884******************************************************************
  6885
  6886 6600-DISPLAY-PREV-ENTRIES.
  6887
  6888     IF PI-NO-ENTRIES-DISPLAYED GREATER THAN ZEROS
  6889         MOVE PI-STUB-KEY (1)        TO PI-ERCKWK-KEY
  6890                                        SAVE-ERCKWK-CONTROL
  6891     ELSE
  6892         MOVE PI-LAST-STUB-KEY       TO PI-ERCKWK-KEY
  6893         GO TO 5000-DISPLAY-PAYEE.
  6894
  6895     MOVE +0                     TO WS-SUB1.
  6896
  6897
  6898* EXEC CICS STARTBR
  6899*        DATASET (FILE-ID-ERCKWK)
  6900*        RIDFLD  (PI-ERCKWK-KEY)
  6901*    END-EXEC.
  6902     MOVE 0
  6903       TO DFHEIV11
  6904*    MOVE '&,         G          &   #00005869' TO DFHEIV0
  6905     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6906     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6907     MOVE X'2020233030303035383639' TO DFHEIV0(25:11)
  6908     CALL 'kxdfhei1' USING DFHEIV0,
  6909           FILE-ID-ERCKWK,
  6910           PI-ERCKWK-KEY,
  6911           DFHEIV99,
  6912           DFHEIV11,
  6913           DFHEIV99
  6914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6915
  6916
  6917     MOVE PI-ERCKWK-KEY          TO SAVE-ERCKWK-CONTROL.
  6918
  6919
  6920* EXEC CICS READNEXT
  6921*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  6922*        DATASET (FILE-ID-ERCKWK)
  6923*        RIDFLD  (PI-ERCKWK-KEY)
  6924*    END-EXEC.
  6925     MOVE 0
  6926       TO DFHEIV11
  6927*    MOVE '&.S                   )   #00005876' TO DFHEIV0
  6928     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6929     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6930     MOVE X'2020233030303035383736' TO DFHEIV0(25:11)
  6931     CALL 'kxdfhei1' USING DFHEIV0,
  6932           FILE-ID-ERCKWK,
  6933           DFHEIV20,
  6934           DFHEIV99,
  6935           PI-ERCKWK-KEY,
  6936           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL636.cbl
  6937           DFHEIV11,
  6938           DFHEIV99,
  6939           DFHEIV99
  6940     SET ADDRESS OF CHECK-WORK-RECORDS TO
  6941         DFHEIV20
  6942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6943
  6944
  6945
  6946* EXEC CICS RESETBR
  6947*        DATASET (FILE-ID-ERCKWK)
  6948*        RIDFLD  (PI-ERCKWK-KEY)
  6949*    END-EXEC.
  6950     MOVE 0
  6951       TO DFHEIV11
  6952*    MOVE '&4         G          &   #00005882' TO DFHEIV0
  6953     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
  6954     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6955     MOVE X'2020233030303035383832' TO DFHEIV0(25:11)
  6956     CALL 'kxdfhei1' USING DFHEIV0,
  6957           FILE-ID-ERCKWK,
  6958           PI-ERCKWK-KEY,
  6959           DFHEIV99,
  6960           DFHEIV11,
  6961           DFHEIV99
  6962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6963
  6964
  6965 6610-READ-PREV-ENTRY.
  6966
  6967
  6968* EXEC CICS READPREV
  6969*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  6970*        DATASET (FILE-ID-ERCKWK)
  6971*        RIDFLD  (PI-ERCKWK-KEY)
  6972*    END-EXEC.
  6973     MOVE 0
  6974       TO DFHEIV11
  6975*    MOVE '&0S                   )   #00005889' TO DFHEIV0
  6976     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  6977     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6978     MOVE X'2020233030303035383839' TO DFHEIV0(25:11)
  6979     CALL 'kxdfhei1' USING DFHEIV0,
  6980           FILE-ID-ERCKWK,
  6981           DFHEIV20,
  6982           DFHEIV99,
  6983           PI-ERCKWK-KEY,
  6984           DFHEIV99,
  6985           DFHEIV11,
  6986           DFHEIV99,
  6987           DFHEIV99
  6988     SET ADDRESS OF CHECK-WORK-RECORDS TO
  6989         DFHEIV20
  6990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6991
  6992
  6993     IF PI-COMPANY-CD  NOT =  CW-COMPANY-CD
  6994         GO TO      5000-DISPLAY-PAYEE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL636.cbl
  6995
  6996     IF PI-ERCKWK-PAYEE GREATER THAN SVCKWK-PAYEE
  6997        GO TO 6610-READ-PREV-ENTRY.
  6998
  6999     IF PI-ERCKWK-SEQ-NO = ZEROS
  7000        GO TO 6660-PREV-ENTRIES-PRIMED.
  7001
  7002     ADD +1                      TO WS-SUB1.
  7003
  7004     IF WS-SUB1 GREATER +5
  7005        GO TO 6660-PREV-ENTRIES-PRIMED.
  7006
  7007     GO TO 6610-READ-PREV-ENTRY.
  7008
  7009 6660-PREV-ENTRIES-PRIMED.
  7010
  7011
  7012* EXEC CICS ENDBR
  7013*         DATASET (FILE-ID-ERCKWK)
  7014*    END-EXEC.
  7015     MOVE 0
  7016       TO DFHEIV11
  7017*    MOVE '&2                    $   #00005913' TO DFHEIV0
  7018     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7019     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7020     MOVE X'2020233030303035393133' TO DFHEIV0(25:11)
  7021     CALL 'kxdfhei1' USING DFHEIV0,
  7022           FILE-ID-ERCKWK,
  7023           DFHEIV11,
  7024           DFHEIV99
  7025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7026
  7027
  7028     GO TO 5000-DISPLAY-PAYEE.
  7029
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL636.cbl
  7031
  7032******************************************************************
  7033*                                                                *
  7034*    R E L E A S E   E N T E R I E S   T O   CHECK-FILE          *
  7035*                                                                *
  7036******************************************************************
  7037
  7038 7000-RELEASE-ENTRIES.
  7039     MOVE ' '                    TO ERCOMP-SW.
  7040
  7041
  7042* EXEC CICS GETMAIN
  7043*        SET     (ADDRESS OF COMM-CHECK-RECORDS)
  7044*        LENGTH  (ERCMCK-RECORD-LENGTH)
  7045*        INITIMG (GETMAIN-SPACE)
  7046*    END-EXEC.
  7047*    MOVE ',"IL                  $   #00005930' TO DFHEIV0
  7048     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7049     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7050     MOVE X'2020233030303035393330' TO DFHEIV0(25:11)
  7051     CALL 'kxdfhei1' USING DFHEIV0,
  7052           DFHEIV20,
  7053           ERCMCK-RECORD-LENGTH,
  7054           GETMAIN-SPACE
  7055     SET ADDRESS OF COMM-CHECK-RECORDS TO
  7056         DFHEIV20
  7057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7058
  7059
  7060
  7061* EXEC CICS HANDLE CONDITION
  7062*        NOTFND    (7090-CHECKS-NOTFND)
  7063*        ENDFILE   (7090-CHECKS-NOTFND)
  7064*    END-EXEC.
  7065*    MOVE '"$I''                  ! 8 #00005936' TO DFHEIV0
  7066     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7067     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7068     MOVE X'3820233030303035393336' TO DFHEIV0(25:11)
  7069     CALL 'kxdfhei1' USING DFHEIV0
  7070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7071
  7072
  7073     MOVE PI-COMPANY-CD          TO ERCKWK-COMPANY-CD.
  7074     MOVE CSRI                   TO ERCKWK-CSR.
  7075     MOVE CARI                   TO ERCKWK-CARRIER.
  7076     MOVE GROUPI                 TO ERCKWK-GROUPING.
  7077     MOVE PAYEEI                 TO ERCKWK-PAYEE.
  7078     MOVE PAYSEQI                TO ERCKWK-PAYEE-SEQ.
  7079     MOVE +0                     TO ERCKWK-SEQUENCE-NO.
  7080
  7081
  7082* EXEC CICS READ
  7083*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  7084*        DATASET (FILE-ID-ERCKWK)
  7085*        RIDFLD  (ERCKWK-KEY)
  7086*        UPDATE
  7087*    END-EXEC.
  7088*    MOVE '&"S        EU         (   #00005949' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL636.cbl
  7089     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7090     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7091     MOVE X'2020233030303035393439' TO DFHEIV0(25:11)
  7092     CALL 'kxdfhei1' USING DFHEIV0,
  7093           FILE-ID-ERCKWK,
  7094           DFHEIV20,
  7095           DFHEIV99,
  7096           ERCKWK-KEY,
  7097           DFHEIV99,
  7098           DFHEIV99,
  7099           DFHEIV99
  7100     SET ADDRESS OF CHECK-WORK-RECORDS TO
  7101         DFHEIV20
  7102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7103
  7104
  7105     IF CW-RELEASE-DT GREATER THAN LOW-VALUES
  7106        GO TO 7095-RELEASE-ERROR.
  7107
  7108     IF CW-TOTAL-COMMISSION NOT GREATER THAN ZEROS
  7109        GO TO 7085-COMMISSION-ERROR.
  7110
  7111     IF CW-PAYEE-NAME = SPACES OR
  7112        CW-PAYEE-NAME = 'NEED MAILING NAME'
  7113        GO TO 7075-PAYEE-NAME-ERROR.
  7114
  7115     MOVE WS-CURRENT-BIN-DT      TO  CW-RELEASE-DT.
  7116     MOVE WS-CURRENT-BIN-DT      TO  CW-RECORDED-DT.
  7117     MOVE PI-PROCESSOR-ID        TO  CW-RECORDED-BY.
  7118     MOVE EIBTIME                TO  CW-LAST-MAINT-HHMMSS.
  7119
  7120     MOVE +0 TO WS-SEQUENCE-NO.
  7121
  7122     MOVE CW-PAYEE-NAME          TO WS-PAYEE-NAME.
  7123     MOVE CW-ADDRESS-1           TO WS-PAYEE-ADDRESS-1.
  7124     MOVE CW-ADDRESS-2           TO WS-PAYEE-ADDRESS-2.
  7125     MOVE CW-PAYEE-CITY-ST       TO WS-PAYEE-CITY-ST.
  7126     MOVE CW-PAYEE-ZIP           TO WS-PAYEE-ZIP.
  7127     MOVE CW-PAYEE-ZIP-EXT       TO WS-PAYEE-ZIP-EXT.
  7128
  7129     MOVE CW-TOTAL-COMMISSION    TO WS-AMOUNT-PAID.
  7130     MOVE CW-TOTAL-ENTRIES       TO WS-TOTAL-ENTRIES.
  7131
  7132     MOVE ERCKWK-KEY             TO SAVE-ERCKWK-CONTROL.
  7133
  7134     MOVE +1                     TO WS-SUB2.
  7135
  7136
  7137* EXEC CICS REWRITE
  7138*         FROM    (CHECK-WORK-RECORDS)
  7139*         DATASET (FILE-ID-ERCKWK)
  7140*    END-EXEC.
  7141     MOVE LENGTH OF
  7142      CHECK-WORK-RECORDS
  7143       TO DFHEIV11
  7144*    MOVE '&& L                  %   #00005987' TO DFHEIV0
  7145     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7146     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL636.cbl
  7147     MOVE X'2020233030303035393837' TO DFHEIV0(25:11)
  7148     CALL 'kxdfhei1' USING DFHEIV0,
  7149           FILE-ID-ERCKWK,
  7150           CHECK-WORK-RECORDS,
  7151           DFHEIV11,
  7152           DFHEIV99
  7153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7154
  7155
  7156
  7157* EXEC CICS HANDLE CONDITION
  7158*        NOTFND    (7070-CHECK-PROCESSED)
  7159*        ENDFILE   (7070-CHECK-PROCESSED)
  7160*    END-EXEC.
  7161*    MOVE '"$I''                  ! 9 #00005992' TO DFHEIV0
  7162     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7163     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7164     MOVE X'3920233030303035393932' TO DFHEIV0(25:11)
  7165     CALL 'kxdfhei1' USING DFHEIV0
  7166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7167
  7168
  7169 7010-READ-CHECK-WORK-FILE.
  7170
  7171
  7172* EXEC CICS STARTBR
  7173*        DATASET (FILE-ID-ERCKWK)
  7174*        RIDFLD  (ERCKWK-KEY)
  7175*    END-EXEC.
  7176     MOVE 0
  7177       TO DFHEIV11
  7178*    MOVE '&,         G          &   #00005999' TO DFHEIV0
  7179     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7180     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7181     MOVE X'2020233030303035393939' TO DFHEIV0(25:11)
  7182     CALL 'kxdfhei1' USING DFHEIV0,
  7183           FILE-ID-ERCKWK,
  7184           ERCKWK-KEY,
  7185           DFHEIV99,
  7186           DFHEIV11,
  7187           DFHEIV99
  7188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7189
  7190
  7191 7020-READ-NEXT-DETAIL.
  7192
  7193
  7194* EXEC CICS READNEXT
  7195*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  7196*        DATASET (FILE-ID-ERCKWK)
  7197*        RIDFLD  (ERCKWK-KEY)
  7198*    END-EXEC.
  7199     MOVE 0
  7200       TO DFHEIV11
  7201*    MOVE '&.S                   )   #00006006' TO DFHEIV0
  7202     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7203     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7204     MOVE X'2020233030303036303036' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL636.cbl
  7205     CALL 'kxdfhei1' USING DFHEIV0,
  7206           FILE-ID-ERCKWK,
  7207           DFHEIV20,
  7208           DFHEIV99,
  7209           ERCKWK-KEY,
  7210           DFHEIV99,
  7211           DFHEIV11,
  7212           DFHEIV99,
  7213           DFHEIV99
  7214     SET ADDRESS OF CHECK-WORK-RECORDS TO
  7215         DFHEIV20
  7216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7217
  7218
  7219     IF ERCKWK-KEY = SAVE-ERCKWK-CONTROL
  7220        GO TO 7020-READ-NEXT-DETAIL.
  7221
  7222     IF CW-COMPANY-CD = SVCKWK-COMPANY-CD AND
  7223        CW-CSR        = SVCKWK-CSR        AND
  7224        CW-CARRIER    = SVCKWK-CARRIER    AND
  7225        CW-GROUPING   = SVCKWK-GROUPING   AND
  7226        CW-PAYEE      = SVCKWK-PAYEE      AND
  7227        CW-PAYEE-SEQ  = SVCKWK-PAYEE-SEQ
  7228        NEXT SENTENCE
  7229     ELSE
  7230        GO TO 7080-CHECK-ERROR.
  7231
  7232     IF CW-TEXT
  7233        GO TO 7020-READ-NEXT-DETAIL.
  7234
  7235     IF ERCOMP-SW  IS EQUAL      TO ' '
  7236        MOVE CW-COMPANY-CD       TO ERCOMP-COMP-CD
  7237        MOVE CW-CARRIER          TO ERCOMP-CARRIER
  7238        MOVE CW-GROUPING         TO ERCOMP-GROUPING
  7239        MOVE CW-PAYEE            TO ERCOMP-FIN-RESP
  7240        IF CW-PMT-APPLIED = 'O' OR 'G'
  7241           MOVE LOW-VALUES       TO ERCOMP-ACCT
  7242           MOVE 'G'              TO ERCOMP-RECORD-TYPE
  7243           PERFORM 1450-ACH-READ    THRU 1470-EXIT
  7244        ELSE
  7245           MOVE CW-ACCT-AGENT    TO ERCOMP-ACCT
  7246           MOVE 'A'              TO ERCOMP-RECORD-TYPE
  7247           PERFORM 1450-ACH-READ    THRU 1470-EXIT
  7248        END-IF
  7249     END-IF.
  7250
  7251
  7252     MOVE CW-COMMENT             TO  CK-STUB-COMMENT  (WS-SUB2).
  7253     MOVE CW-ACCT-AGENT          TO  CK-ACCT-AGENT    (WS-SUB2).
  7254     MOVE CW-INVOICE             TO  CK-INVOICE       (WS-SUB2).
  7255     MOVE CW-REFERENCE           TO  CK-REFERENCE     (WS-SUB2).
  7256     MOVE CW-LEDGER-NO           TO  CK-LEDGER-NO     (WS-SUB2).
  7257     MOVE CW-LAST-MAINT-APPLIED
  7258                             TO  CK-LAST-MAINT-APPLIED (WS-SUB2).
  7259
  7260     MOVE CW-NON-AR-ITEM         TO  CK-NON-AR-ITEM   (WS-SUB2).
  7261     MOVE CW-PMT-APPLIED         TO  CK-PYAJ-PMT-APPLIED (WS-SUB2)
  7262
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL636.cbl
  7263     MOVE 'C'                    TO  CK-PAYMENT-TYPE  (WS-SUB2).
  7264
  7265     MOVE CW-DETAIL-AMOUNT       TO  CK-DETAIL-AMT    (WS-SUB2).
  7266
  7267     MOVE CW-CSR                 TO  CK-CKWK-CSR      (WS-SUB2).
  7268     MOVE CW-CARRIER             TO  CK-CKWK-CARRIER  (WS-SUB2).
  7269     MOVE CW-GROUPING            TO  CK-CKWK-GROUPING (WS-SUB2).
  7270     MOVE CW-PAYEE               TO  CK-CKWK-PAYEE    (WS-SUB2).
  7271     MOVE CW-PAYEE-SEQ           TO  CK-CKWK-PAYEE-SEQ (WS-SUB2).
  7272     MOVE CW-SEQUENCE-NO         TO  CK-CKWK-SEQ-NO   (WS-SUB2).
  7273
  7274
  7275* EXEC CICS ENDBR
  7276*         DATASET (FILE-ID-ERCKWK)
  7277*    END-EXEC.
  7278     MOVE 0
  7279       TO DFHEIV11
  7280*    MOVE '&2                    $   #00006067' TO DFHEIV0
  7281     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7282     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7283     MOVE X'2020233030303036303637' TO DFHEIV0(25:11)
  7284     CALL 'kxdfhei1' USING DFHEIV0,
  7285           FILE-ID-ERCKWK,
  7286           DFHEIV11,
  7287           DFHEIV99
  7288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7289
  7290
  7291     MOVE ERCKWK-KEY             TO SAVE-ERCKWK-CONTROL.
  7292
  7293
  7294* EXEC CICS READ
  7295*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  7296*        DATASET (FILE-ID-ERCKWK)
  7297*        RIDFLD  (ERCKWK-KEY)
  7298*        UPDATE
  7299*    END-EXEC.
  7300*    MOVE '&"S        EU         (   #00006073' TO DFHEIV0
  7301     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7302     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7303     MOVE X'2020233030303036303733' TO DFHEIV0(25:11)
  7304     CALL 'kxdfhei1' USING DFHEIV0,
  7305           FILE-ID-ERCKWK,
  7306           DFHEIV20,
  7307           DFHEIV99,
  7308           ERCKWK-KEY,
  7309           DFHEIV99,
  7310           DFHEIV99,
  7311           DFHEIV99
  7312     SET ADDRESS OF CHECK-WORK-RECORDS TO
  7313         DFHEIV20
  7314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7315
  7316
  7317     MOVE WS-CURRENT-BIN-DT      TO  CW-RELEASE-DT.
  7318
  7319
  7320* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL636.cbl
  7321*         FROM    (CHECK-WORK-RECORDS)
  7322*         DATASET (FILE-ID-ERCKWK)
  7323*    END-EXEC.
  7324     MOVE LENGTH OF
  7325      CHECK-WORK-RECORDS
  7326       TO DFHEIV11
  7327*    MOVE '&& L                  %   #00006082' TO DFHEIV0
  7328     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7329     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7330     MOVE X'2020233030303036303832' TO DFHEIV0(25:11)
  7331     CALL 'kxdfhei1' USING DFHEIV0,
  7332           FILE-ID-ERCKWK,
  7333           CHECK-WORK-RECORDS,
  7334           DFHEIV11,
  7335           DFHEIV99
  7336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7337
  7338
  7339     SUBTRACT +1                 FROM WS-TOTAL-ENTRIES.
  7340
  7341     IF WS-TOTAL-ENTRIES = +0
  7342        GO TO 7070-CHECK-PROCESSED.
  7343
  7344     ADD +1                      TO   WS-SUB2.
  7345
  7346     IF WS-SUB2 NOT GREATER THAN +15
  7347        GO TO 7010-READ-CHECK-WORK-FILE.
  7348
  7349     MOVE ZEROS                  TO  CK-AMOUNT-PAID.
  7350     MOVE 'D'                    TO  CK-RECORD-TYPE.
  7351     PERFORM 7400-WRITE-COMM-CHECK-RECORD THRU 7490-EXIT.
  7352
  7353     MOVE SPACES                 TO COMM-CHECK-RECORDS.
  7354
  7355     MOVE +1                     TO WS-SUB2.
  7356
  7357     GO TO 7010-READ-CHECK-WORK-FILE.
  7358
  7359 7070-CHECK-PROCESSED.
  7360
  7361     MOVE WS-AMOUNT-PAID         TO  CK-AMOUNT-PAID.
  7362
  7363     MOVE 'D'                    TO  CK-RECORD-TYPE.
  7364     PERFORM 7400-WRITE-COMM-CHECK-RECORD THRU 7490-EXIT.
  7365
  7366     PERFORM 7100-WRITE-COMM-CHECK-TEXT THRU 7190-EXIT.
  7367
  7368     IF PI-NO-ENTRIES-DISPLAYED GREATER THAN ZEROS
  7369        MOVE PI-STUB-KEY (1)        TO PI-ERCKWK-KEY.
  7370
  7371     MOVE ER-0000                TO  EMI-ERROR.
  7372     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7373     GO TO 5000-DISPLAY-PAYEE.
  7374
  7375 7075-PAYEE-NAME-ERROR.
  7376
  7377
  7378* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL636.cbl
  7379*         DATASET (FILE-ID-ERCKWK)
  7380*    END-EXEC.
  7381*    MOVE '&*                    #   #00006125' TO DFHEIV0
  7382     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7383     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7384     MOVE X'2020233030303036313235' TO DFHEIV0(25:11)
  7385     CALL 'kxdfhei1' USING DFHEIV0,
  7386           FILE-ID-ERCKWK,
  7387           DFHEIV99
  7388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7389
  7390
  7391     MOVE ER-3163                TO EMI-ERROR.
  7392     MOVE -1                     TO PAYTOL.
  7393     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7394     GO TO 8200-SEND-DATAONLY.
  7395
  7396 7080-CHECK-ERROR.
  7397
  7398
  7399* EXEC CICS SYNCPOINT ROLLBACK
  7400*    END-EXEC.
  7401*    MOVE '6"R                   !   #00006136' TO DFHEIV0
  7402     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  7403     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7404     MOVE X'2020233030303036313336' TO DFHEIV0(25:11)
  7405     CALL 'kxdfhei1' USING DFHEIV0
  7406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7407
  7408
  7409     MOVE ER-3162                TO EMI-ERROR.
  7410     MOVE -1                     TO CARL.
  7411     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7412     GO TO 8200-SEND-DATAONLY.
  7413
  7414 7085-COMMISSION-ERROR.
  7415
  7416
  7417* EXEC CICS UNLOCK
  7418*         DATASET (FILE-ID-ERCKWK)
  7419*    END-EXEC.
  7420*    MOVE '&*                    #   #00006146' TO DFHEIV0
  7421     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7422     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7423     MOVE X'2020233030303036313436' TO DFHEIV0(25:11)
  7424     CALL 'kxdfhei1' USING DFHEIV0,
  7425           FILE-ID-ERCKWK,
  7426           DFHEIV99
  7427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7428
  7429
  7430     MOVE AL-SABOF               TO CHKAMTA.
  7431     MOVE ER-3165                TO EMI-ERROR.
  7432     MOVE -1                     TO CARL.
  7433     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7434     GO TO 8200-SEND-DATAONLY.
  7435
  7436 7090-CHECKS-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL636.cbl
  7437
  7438     MOVE ER-3160                TO EMI-ERROR.
  7439     MOVE -1                     TO CARL.
  7440     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7441     GO TO 8200-SEND-DATAONLY.
  7442
  7443 7095-RELEASE-ERROR.
  7444
  7445
  7446* EXEC CICS UNLOCK
  7447*         DATASET (FILE-ID-ERCKWK)
  7448*    END-EXEC.
  7449*    MOVE '&*                    #   #00006165' TO DFHEIV0
  7450     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7451     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7452     MOVE X'2020233030303036313635' TO DFHEIV0(25:11)
  7453     CALL 'kxdfhei1' USING DFHEIV0,
  7454           FILE-ID-ERCKWK,
  7455           DFHEIV99
  7456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7457
  7458
  7459     MOVE ER-3139                TO EMI-ERROR.
  7460     MOVE -1                     TO PAYTOL.
  7461     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7462     GO TO 8200-SEND-DATAONLY.
  7463
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL636.cbl
  7465
  7466******************************************************************
  7467*                                                                *
  7468*         W R I T E   C H E C K   S T U B   T E X T              *
  7469*                                                                *
  7470******************************************************************
  7471
  7472 7100-WRITE-COMM-CHECK-TEXT.
  7473
  7474
  7475* EXEC CICS HANDLE CONDITION
  7476*        NOTFND    (7190-EXIT)
  7477*        ENDFILE   (7190-EXIT)
  7478*    END-EXEC.
  7479*    MOVE '"$I''                  ! : #00006184' TO DFHEIV0
  7480     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7481     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7482     MOVE X'3A20233030303036313834' TO DFHEIV0(25:11)
  7483     CALL 'kxdfhei1' USING DFHEIV0
  7484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7485
  7486
  7487     MOVE +0                     TO WS-SUB2.
  7488     MOVE SAVE-ERCKWK-CONTROL    TO ERCKWK-KEY.
  7489     MOVE +8999                  TO ERCKWK-SEQUENCE-NO.
  7490
  7491 7110-READ-TEXT-LOOP.
  7492     ADD +1                      TO WS-SUB2.
  7493     ADD +1                      TO ERCKWK-SEQUENCE-NO.
  7494
  7495
  7496* EXEC CICS READ
  7497*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  7498*        DATASET (FILE-ID-ERCKWK)
  7499*        RIDFLD  (ERCKWK-KEY)
  7500*        UPDATE
  7501*    END-EXEC.
  7502*    MOVE '&"S        EU         (   #00006197' TO DFHEIV0
  7503     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7504     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7505     MOVE X'2020233030303036313937' TO DFHEIV0(25:11)
  7506     CALL 'kxdfhei1' USING DFHEIV0,
  7507           FILE-ID-ERCKWK,
  7508           DFHEIV20,
  7509           DFHEIV99,
  7510           ERCKWK-KEY,
  7511           DFHEIV99,
  7512           DFHEIV99,
  7513           DFHEIV99
  7514     SET ADDRESS OF CHECK-WORK-RECORDS TO
  7515         DFHEIV20
  7516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7517
  7518
  7519     MOVE WS-CURRENT-BIN-DT      TO  CW-RELEASE-DT.
  7520     MOVE CW-STUB-TEXT           TO  CK-STUB-TEXT (WS-SUB2).
  7521     MOVE SPACES                 TO  CK-STUB-FILL-AREA.
  7522
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL636.cbl
  7523     IF ERCOMP-SW IS EQUAL       TO  'P'
  7524        MOVE ERCOMP-SW           TO  CK-ACH-PAYMENT
  7525     ELSE
  7526        MOVE 'N'                 TO  CK-ACH-PAYMENT.
  7527
  7528
  7529
  7530* EXEC CICS REWRITE
  7531*         FROM    (CHECK-WORK-RECORDS)
  7532*         DATASET (FILE-ID-ERCKWK)
  7533*    END-EXEC.
  7534     MOVE LENGTH OF
  7535      CHECK-WORK-RECORDS
  7536       TO DFHEIV11
  7537*    MOVE '&& L                  %   #00006214' TO DFHEIV0
  7538     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7539     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7540     MOVE X'2020233030303036323134' TO DFHEIV0(25:11)
  7541     CALL 'kxdfhei1' USING DFHEIV0,
  7542           FILE-ID-ERCKWK,
  7543           CHECK-WORK-RECORDS,
  7544           DFHEIV11,
  7545           DFHEIV99
  7546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7547
  7548
  7549     IF WS-SUB2 LESS THAN +3
  7550        GO TO 7110-READ-TEXT-LOOP.
  7551
  7552     MOVE ZEROS                  TO  CK-AMOUNT-PAID.
  7553     MOVE 'T'                    TO  CK-RECORD-TYPE.
  7554     PERFORM 7400-WRITE-COMM-CHECK-RECORD THRU 7490-EXIT.
  7555
  7556     MOVE SPACES                 TO COMM-CHECK-RECORDS.
  7557
  7558 7180-TEXT-PROCESSED.
  7559
  7560 7190-EXIT.
  7561      EXIT.
  7562
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL636.cbl
  7564
  7565******************************************************************
  7566*                                                                *
  7567*         W R I T E   C O M M I S S I O N   C H E C K S          *
  7568*                                                                *
  7569******************************************************************
  7570
  7571 7400-WRITE-COMM-CHECK-RECORD.
  7572
  7573     ADD +1                      TO  WS-SEQUENCE-NO.
  7574     MOVE WS-SEQUENCE-NO         TO  CK-SEQUENCE-NO.
  7575
  7576     MOVE 'CK'                   TO  CK-RECORD-ID.
  7577     MOVE CW-COMPANY-CD          TO  CK-COMPANY-CD.
  7578     MOVE CW-CSR                 TO  CK-CSR.
  7579     MOVE CW-CARRIER             TO  CK-CARRIER.
  7580     MOVE CW-GROUPING            TO  CK-GROUPING.
  7581     MOVE CW-PAYEE               TO  CK-PAYEE.
  7582     MOVE CW-PAYEE-SEQ           TO  CK-PAYEE-SEQ.
  7583     MOVE WS-CURRENT-BIN-DT      TO  CK-RECORDED-DT.
  7584     MOVE CW-AR-STATEMENT-DT     TO  CK-AR-STATEMENT-DT.
  7585*    MOVE CW-PMT-APPLIED         TO  CK-PMT-APPLIED.
  7586     MOVE PI-PROCESSOR-ID        TO  CK-RECORDED-BY.
  7587     MOVE EIBTIME                TO  CK-LAST-MAINT-HHMMSS.
  7588     MOVE WS-PAYEE-NAME          TO  CK-PAYEE-NAME.
  7589     MOVE WS-PAYEE-ADDRESS-1     TO  CK-PAYEE-ADDRESS-1.
  7590     MOVE WS-PAYEE-ADDRESS-2     TO  CK-PAYEE-ADDRESS-2.
  7591     MOVE WS-PAYEE-CITY-ST       TO  CK-PAYEE-CITY-ST.
  7592     MOVE WS-PAYEE-ZIP-CODE      TO  CK-PAYEE-ZIP-CODE.
  7593
  7594     MOVE ZEROS                  TO  CK-QUE-CONTROL-NUMBER
  7595                                     CK-QUE-SEQ-NO.
  7596
  7597     MOVE LOW-VALUES             TO  CK-CHECK-WRITTEN-DT
  7598                                     CK-CREDIT-SELECT-DT
  7599                                     CK-CREDIT-ACCEPT-DT
  7600                                     CK-VOID-DT.
  7601
  7602     IF ERCOMP-SW IS EQUAL       TO  'P'
  7603        MOVE ERCOMP-SW           TO  CK-ACH-PAYMENT
  7604     ELSE
  7605        MOVE 'N'                 TO  CK-ACH-PAYMENT.
  7606
  7607
  7608* EXEC CICS HANDLE CONDITION
  7609*         DUPREC  (7480-DUPREC)
  7610*    END-EXEC.
  7611*    MOVE '"$%                   ! ; #00006277' TO DFHEIV0
  7612     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7613     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7614     MOVE X'3B20233030303036323737' TO DFHEIV0(25:11)
  7615     CALL 'kxdfhei1' USING DFHEIV0
  7616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7617
  7618
  7619 7425-WRITE-COMM-CHECK-RECORD.
  7620
  7621
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL636.cbl
  7622* EXEC CICS WRITE
  7623*         DATASET   (FILE-ID-ERCMCK)
  7624*         FROM      (COMM-CHECK-RECORDS)
  7625*         RIDFLD    (CK-CONTROL-PRIMARY)
  7626*    END-EXEC.
  7627     MOVE LENGTH OF
  7628      COMM-CHECK-RECORDS
  7629       TO DFHEIV11
  7630*    MOVE '&$ L                  ''   #00006283' TO DFHEIV0
  7631     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7632     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7633     MOVE X'2020233030303036323833' TO DFHEIV0(25:11)
  7634     CALL 'kxdfhei1' USING DFHEIV0,
  7635           FILE-ID-ERCMCK,
  7636           COMM-CHECK-RECORDS,
  7637           DFHEIV11,
  7638           CK-CONTROL-PRIMARY,
  7639           DFHEIV99,
  7640           DFHEIV99
  7641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7642
  7643
  7644     GO TO 7490-EXIT.
  7645
  7646 7480-DUPREC.
  7647
  7648     ADD +1                      TO CK-SEQUENCE-NO.
  7649     GO TO 7425-WRITE-COMM-CHECK-RECORD.
  7650
  7651 7490-EXIT.
  7652      EXIT.
  7653
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL636.cbl
  7655
  7656******************************************************************
  7657*                                                                *
  7658*           V O I D   C O M M I S I O N   C H E C K              *
  7659*                                                                *
  7660******************************************************************
  7661
  7662 7500-VOID-COMM-CHECK.
  7663
  7664     MOVE 'V'                    TO PI-MAINT-FUNCTION.
  7665
  7666     MOVE PI-COMPANY-CD          TO ERCMCK-COMPANY-CD.
  7667     MOVE CSRI                   TO ERCMCK-CSR.
  7668     MOVE CARI                   TO ERCMCK-CARRIER.
  7669     MOVE GROUPI                 TO ERCMCK-GROUPING.
  7670     MOVE PAYEEI                 TO ERCMCK-PAYEE.
  7671     MOVE PAYSEQI                TO ERCMCK-PAYEE-SEQ.
  7672     MOVE +0                     TO ERCMCK-SEQUENCE-NO.
  7673
  7674
  7675* EXEC CICS HANDLE CONDITION
  7676*        NOTFND    (7550-VOID-WORK-RECS)
  7677*        ENDFILE   (7550-VOID-WORK-RECS)
  7678*    END-EXEC.
  7679*    MOVE '"$I''                  ! < #00006319' TO DFHEIV0
  7680     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7681     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7682     MOVE X'3C20233030303036333139' TO DFHEIV0(25:11)
  7683     CALL 'kxdfhei1' USING DFHEIV0
  7684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7685
  7686
  7687 7510-READ-COMM-CHECK.
  7688
  7689
  7690* EXEC CICS STARTBR
  7691*        DATASET (FILE-ID-ERCMCK)
  7692*        RIDFLD  (ERCMCK-KEY)
  7693*    END-EXEC.
  7694     MOVE 0
  7695       TO DFHEIV11
  7696*    MOVE '&,         G          &   #00006326' TO DFHEIV0
  7697     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7698     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7699     MOVE X'2020233030303036333236' TO DFHEIV0(25:11)
  7700     CALL 'kxdfhei1' USING DFHEIV0,
  7701           FILE-ID-ERCMCK,
  7702           ERCMCK-KEY,
  7703           DFHEIV99,
  7704           DFHEIV11,
  7705           DFHEIV99
  7706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7707
  7708
  7709 7520-PROCESS-COMM-CHECK.
  7710
  7711
  7712* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL636.cbl
  7713*        SET     (ADDRESS OF COMM-CHECK-RECORDS)
  7714*        DATASET (FILE-ID-ERCMCK)
  7715*        RIDFLD  (ERCMCK-KEY)
  7716*    END-EXEC.
  7717     MOVE 0
  7718       TO DFHEIV11
  7719*    MOVE '&.S                   )   #00006333' TO DFHEIV0
  7720     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7721     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7722     MOVE X'2020233030303036333333' TO DFHEIV0(25:11)
  7723     CALL 'kxdfhei1' USING DFHEIV0,
  7724           FILE-ID-ERCMCK,
  7725           DFHEIV20,
  7726           DFHEIV99,
  7727           ERCMCK-KEY,
  7728           DFHEIV99,
  7729           DFHEIV11,
  7730           DFHEIV99,
  7731           DFHEIV99
  7732     SET ADDRESS OF COMM-CHECK-RECORDS TO
  7733         DFHEIV20
  7734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7735
  7736
  7737     IF PI-COMPANY-CD  NOT =  CK-COMPANY-CD
  7738         GO TO      7550-VOID-WORK-RECS.
  7739
  7740
  7741     MOVE ERCMCK-KEY             TO  SAVE-ERCMCK-CONTROL.
  7742
  7743     IF CK-COMPANY-CD = PI-SVCKWK-COMP-CD  AND
  7744        CK-CSR        = PI-SVCKWK-CSR      AND
  7745        CK-CARRIER    = PI-SVCKWK-CARRIER  AND
  7746        CK-GROUPING   = PI-SVCKWK-GROUPING AND
  7747        CK-PAYEE      = PI-SVCKWK-PAYEE    AND
  7748        CK-PAYEE-SEQ  = PI-SVCKWK-PAYEE-SEQ
  7749        NEXT SENTENCE
  7750     ELSE
  7751
  7752* EXEC CICS ENDBR
  7753*            DATASET (FILE-ID-ERCMCK)
  7754*       END-EXEC
  7755     MOVE 0
  7756       TO DFHEIV11
  7757*    MOVE '&2                    $   #00006353' TO DFHEIV0
  7758     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7759     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7760     MOVE X'2020233030303036333533' TO DFHEIV0(25:11)
  7761     CALL 'kxdfhei1' USING DFHEIV0,
  7762           FILE-ID-ERCMCK,
  7763           DFHEIV11,
  7764           DFHEIV99
  7765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7766        GO TO 7550-VOID-WORK-RECS.
  7767
  7768     IF CK-QUE-CONTROL-NUMBER = ZEROS
  7769        NEXT SENTENCE
  7770     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL636.cbl
  7771        GO TO 7580-VOID-ERROR.
  7772
  7773
  7774* EXEC CICS ENDBR
  7775*         DATASET (FILE-ID-ERCMCK)
  7776*    END-EXEC.
  7777     MOVE 0
  7778       TO DFHEIV11
  7779*    MOVE '&2                    $   #00006363' TO DFHEIV0
  7780     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7781     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7782     MOVE X'2020233030303036333633' TO DFHEIV0(25:11)
  7783     CALL 'kxdfhei1' USING DFHEIV0,
  7784           FILE-ID-ERCMCK,
  7785           DFHEIV11,
  7786           DFHEIV99
  7787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7788
  7789
  7790
  7791* EXEC CICS READ
  7792*        SET     (ADDRESS OF COMM-CHECK-RECORDS)
  7793*        DATASET (FILE-ID-ERCMCK)
  7794*        RIDFLD  (ERCMCK-KEY)
  7795*        UPDATE
  7796*    END-EXEC.
  7797*    MOVE '&"S        EU         (   #00006367' TO DFHEIV0
  7798     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7799     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7800     MOVE X'2020233030303036333637' TO DFHEIV0(25:11)
  7801     CALL 'kxdfhei1' USING DFHEIV0,
  7802           FILE-ID-ERCMCK,
  7803           DFHEIV20,
  7804           DFHEIV99,
  7805           ERCMCK-KEY,
  7806           DFHEIV99,
  7807           DFHEIV99,
  7808           DFHEIV99
  7809     SET ADDRESS OF COMM-CHECK-RECORDS TO
  7810         DFHEIV20
  7811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7812
  7813
  7814
  7815* EXEC CICS DELETE
  7816*         DATASET (FILE-ID-ERCMCK)
  7817*    END-EXEC.
  7818*    MOVE '&(                    &   #00006374' TO DFHEIV0
  7819     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7820     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7821     MOVE X'2020233030303036333734' TO DFHEIV0(25:11)
  7822     CALL 'kxdfhei1' USING DFHEIV0,
  7823           FILE-ID-ERCMCK,
  7824           DFHEIV99,
  7825           DFHEIV99,
  7826           DFHEIV99,
  7827           DFHEIV99
  7828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL636.cbl
  7829
  7830
  7831     GO TO 7510-READ-COMM-CHECK.
  7832
  7833 7550-VOID-WORK-RECS.
  7834
  7835
  7836* EXEC CICS HANDLE CONDITION
  7837*        NOTFND    (7570-COMM-CHECK-VOIDED)
  7838*        ENDFILE   (7570-COMM-CHECK-VOIDED)
  7839*    END-EXEC.
  7840*    MOVE '"$I''                  ! = #00006382' TO DFHEIV0
  7841     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7842     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7843     MOVE X'3D20233030303036333832' TO DFHEIV0(25:11)
  7844     CALL 'kxdfhei1' USING DFHEIV0
  7845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7846
  7847
  7848     MOVE PI-COMPANY-CD          TO ERCKWK-COMPANY-CD.
  7849     MOVE CSRI                   TO ERCKWK-CSR.
  7850     MOVE CARI                   TO ERCKWK-CARRIER.
  7851     MOVE GROUPI                 TO ERCKWK-GROUPING.
  7852     MOVE PAYEEI                 TO ERCKWK-PAYEE.
  7853     MOVE PAYSEQI                TO ERCKWK-PAYEE-SEQ.
  7854     MOVE +0                     TO ERCKWK-SEQUENCE-NO.
  7855
  7856 7560-READ-CHECK-WORK-FILE.
  7857
  7858
  7859* EXEC CICS STARTBR
  7860*        DATASET (FILE-ID-ERCKWK)
  7861*        RIDFLD  (ERCKWK-KEY)
  7862*    END-EXEC.
  7863     MOVE 0
  7864       TO DFHEIV11
  7865*    MOVE '&,         G          &   #00006397' TO DFHEIV0
  7866     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7867     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7868     MOVE X'2020233030303036333937' TO DFHEIV0(25:11)
  7869     CALL 'kxdfhei1' USING DFHEIV0,
  7870           FILE-ID-ERCKWK,
  7871           ERCKWK-KEY,
  7872           DFHEIV99,
  7873           DFHEIV11,
  7874           DFHEIV99
  7875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7876
  7877
  7878     MOVE 'Y'                    TO WS-BROWSE-SW.
  7879
  7880 7565-PROCESS-WORK-FILE.
  7881
  7882
  7883* EXEC CICS READNEXT
  7884*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  7885*        DATASET (FILE-ID-ERCKWK)
  7886*        RIDFLD  (ERCKWK-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL636.cbl
  7887*    END-EXEC.
  7888     MOVE 0
  7889       TO DFHEIV11
  7890*    MOVE '&.S                   )   #00006406' TO DFHEIV0
  7891     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7892     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7893     MOVE X'2020233030303036343036' TO DFHEIV0(25:11)
  7894     CALL 'kxdfhei1' USING DFHEIV0,
  7895           FILE-ID-ERCKWK,
  7896           DFHEIV20,
  7897           DFHEIV99,
  7898           ERCKWK-KEY,
  7899           DFHEIV99,
  7900           DFHEIV11,
  7901           DFHEIV99,
  7902           DFHEIV99
  7903     SET ADDRESS OF CHECK-WORK-RECORDS TO
  7904         DFHEIV20
  7905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7906
  7907
  7908     IF PI-COMPANY-CD  NOT =  CW-COMPANY-CD
  7909         GO TO      7570-COMM-CHECK-VOIDED.
  7910
  7911     IF ERCKWK-KEY = SAVE-ERCKWK-CONTROL
  7912        GO TO 7565-PROCESS-WORK-FILE.
  7913
  7914     MOVE ERCKWK-KEY             TO SAVE-ERCKWK-CONTROL.
  7915
  7916     IF CW-COMPANY-CD = PI-SVCKWK-COMP-CD  AND
  7917        CW-CSR        = PI-SVCKWK-CSR      AND
  7918        CW-CARRIER    = PI-SVCKWK-CARRIER  AND
  7919        CW-GROUPING   = PI-SVCKWK-GROUPING AND
  7920        CW-PAYEE      = PI-SVCKWK-PAYEE    AND
  7921        CW-PAYEE-SEQ  = PI-SVCKWK-PAYEE-SEQ
  7922        NEXT SENTENCE
  7923     ELSE
  7924
  7925* EXEC CICS ENDBR
  7926*            DATASET (FILE-ID-ERCKWK)
  7927*       END-EXEC
  7928     MOVE 0
  7929       TO DFHEIV11
  7930*    MOVE '&2                    $   #00006428' TO DFHEIV0
  7931     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7932     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7933     MOVE X'2020233030303036343238' TO DFHEIV0(25:11)
  7934     CALL 'kxdfhei1' USING DFHEIV0,
  7935           FILE-ID-ERCKWK,
  7936           DFHEIV11,
  7937           DFHEIV99
  7938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7939        MOVE 'N'                 TO WS-BROWSE-SW
  7940        GO TO 7570-COMM-CHECK-VOIDED.
  7941
  7942
  7943* EXEC CICS ENDBR
  7944*         DATASET (FILE-ID-ERCKWK)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL636.cbl
  7945*    END-EXEC.
  7946     MOVE 0
  7947       TO DFHEIV11
  7948*    MOVE '&2                    $   #00006434' TO DFHEIV0
  7949     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7950     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7951     MOVE X'2020233030303036343334' TO DFHEIV0(25:11)
  7952     CALL 'kxdfhei1' USING DFHEIV0,
  7953           FILE-ID-ERCKWK,
  7954           DFHEIV11,
  7955           DFHEIV99
  7956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7957
  7958
  7959
  7960* EXEC CICS READ
  7961*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  7962*        DATASET (FILE-ID-ERCKWK)
  7963*        RIDFLD  (ERCKWK-KEY)
  7964*        UPDATE
  7965*    END-EXEC.
  7966*    MOVE '&"S        EU         (   #00006438' TO DFHEIV0
  7967     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7968     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7969     MOVE X'2020233030303036343338' TO DFHEIV0(25:11)
  7970     CALL 'kxdfhei1' USING DFHEIV0,
  7971           FILE-ID-ERCKWK,
  7972           DFHEIV20,
  7973           DFHEIV99,
  7974           ERCKWK-KEY,
  7975           DFHEIV99,
  7976           DFHEIV99,
  7977           DFHEIV99
  7978     SET ADDRESS OF CHECK-WORK-RECORDS TO
  7979         DFHEIV20
  7980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7981
  7982
  7983     MOVE LOW-VALUES             TO  CW-RELEASE-DT.
  7984
  7985
  7986* EXEC CICS REWRITE
  7987*         FROM    (CHECK-WORK-RECORDS)
  7988*         DATASET (FILE-ID-ERCKWK)
  7989*    END-EXEC.
  7990     MOVE LENGTH OF
  7991      CHECK-WORK-RECORDS
  7992       TO DFHEIV11
  7993*    MOVE '&& L                  %   #00006447' TO DFHEIV0
  7994     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7995     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7996     MOVE X'2020233030303036343437' TO DFHEIV0(25:11)
  7997     CALL 'kxdfhei1' USING DFHEIV0,
  7998           FILE-ID-ERCKWK,
  7999           CHECK-WORK-RECORDS,
  8000           DFHEIV11,
  8001           DFHEIV99
  8002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL636.cbl
  8003
  8004
  8005     GO TO 7560-READ-CHECK-WORK-FILE.
  8006
  8007 7570-COMM-CHECK-VOIDED.
  8008
  8009     IF WS-BROWSE-SW = 'Y'
  8010         MOVE 'N'                TO  WS-BROWSE-SW
  8011
  8012* EXEC CICS ENDBR
  8013*             DATASET (FILE-ID-ERCKWK)
  8014*        END-EXEC.
  8015     MOVE 0
  8016       TO DFHEIV11
  8017*    MOVE '&2                    $   #00006458' TO DFHEIV0
  8018     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8019     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8020     MOVE X'2020233030303036343538' TO DFHEIV0(25:11)
  8021     CALL 'kxdfhei1' USING DFHEIV0,
  8022           FILE-ID-ERCKWK,
  8023           DFHEIV11,
  8024           DFHEIV99
  8025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8026
  8027
  8028     IF PI-NO-ENTRIES-DISPLAYED GREATER THAN ZEROS
  8029        MOVE PI-STUB-KEY (1)        TO PI-ERCKWK-KEY.
  8030
  8031     MOVE ER-0000                TO EMI-ERROR.
  8032     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8033     GO TO 5000-DISPLAY-PAYEE.
  8034
  8035 7580-VOID-ERROR.
  8036
  8037
  8038* EXEC CICS ENDBR
  8039*         DATASET (FILE-ID-ERCMCK)
  8040*    END-EXEC.
  8041     MOVE 0
  8042       TO DFHEIV11
  8043*    MOVE '&2                    $   #00006471' TO DFHEIV0
  8044     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8045     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8046     MOVE X'2020233030303036343731' TO DFHEIV0(25:11)
  8047     CALL 'kxdfhei1' USING DFHEIV0,
  8048           FILE-ID-ERCMCK,
  8049           DFHEIV11,
  8050           DFHEIV99
  8051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8052
  8053
  8054     MOVE ER-3169                TO EMI-ERROR.
  8055     MOVE -1                     TO CARL.
  8056     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8057     GO TO 8200-SEND-DATAONLY.
  8058
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL636.cbl
  8060
  8061******************************************************************
  8062*                                                                *
  8063*             S E N D    I N I T I A L   M A P                   *
  8064*                                                                *
  8065******************************************************************
  8066
  8067 8100-SEND-INITIAL-MAP.
  8068
  8069     MOVE WS-CURRENT-DT          TO DATEO.
  8070     MOVE EIBTIME                TO TIME-IN.
  8071     MOVE TIME-OUT               TO TIMEO.
  8072     MOVE -1                     TO MAINTL.
  8073
  8074     MOVE EMI-MESSAGE-AREA (1)   TO ERMESG1O.
  8075     MOVE EMI-MESSAGE-AREA (2)   TO ERMESG2O.
  8076
  8077
  8078     MOVE AL-SANON               TO  PFKEY8A.
  8079
  8080
  8081* EXEC CICS SEND
  8082*        MAP      (EL636A)
  8083*        MAPSET   (MAPSET-EL636S)
  8084*        FROM     (EL636AI)
  8085*        ERASE
  8086*        CURSOR
  8087*    END-EXEC.
  8088     MOVE LENGTH OF
  8089      EL636AI
  8090       TO DFHEIV12
  8091     MOVE -1
  8092       TO DFHEIV11
  8093*    MOVE '8$     CT  E    H L F ,   #00006501' TO DFHEIV0
  8094     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8095     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8096     MOVE X'2020233030303036353031' TO DFHEIV0(25:11)
  8097     CALL 'kxdfhei1' USING DFHEIV0,
  8098           EL636A,
  8099           EL636AI,
  8100           DFHEIV12,
  8101           MAPSET-EL636S,
  8102           DFHEIV99,
  8103           DFHEIV99,
  8104           DFHEIV99,
  8105           DFHEIV11,
  8106           DFHEIV99,
  8107           DFHEIV99,
  8108           DFHEIV99
  8109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8110
  8111
  8112     GO TO 9100-RETURN-TRAN.
  8113
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL636.cbl
  8115
  8116******************************************************************
  8117*                                                                *
  8118*              S E N D    D A T A O N L Y                        *
  8119*                                                                *
  8120******************************************************************
  8121
  8122 8200-SEND-DATAONLY.
  8123
  8124     MOVE WS-CURRENT-DT          TO DATEO.
  8125     MOVE EIBTIME                TO TIME-IN.
  8126     MOVE TIME-OUT               TO TIMEO.
  8127
  8128     MOVE EMI-MESSAGE-AREA (1)   TO ERMESG1O.
  8129     MOVE EMI-MESSAGE-AREA (2)   TO ERMESG2O.
  8130
  8131
  8132* EXEC CICS SEND
  8133*         MAP      (EL636A)
  8134*         MAPSET   (MAPSET-EL636S)
  8135*         FROM     (EL636AI)
  8136*         DATAONLY
  8137*         CURSOR
  8138*    END-EXEC.
  8139     MOVE LENGTH OF
  8140      EL636AI
  8141       TO DFHEIV12
  8142     MOVE -1
  8143       TO DFHEIV11
  8144*    MOVE '8$D    CT       H L F ,   #00006528' TO DFHEIV0
  8145     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  8146     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8147     MOVE X'2020233030303036353238' TO DFHEIV0(25:11)
  8148     CALL 'kxdfhei1' USING DFHEIV0,
  8149           EL636A,
  8150           EL636AI,
  8151           DFHEIV12,
  8152           MAPSET-EL636S,
  8153           DFHEIV99,
  8154           DFHEIV99,
  8155           DFHEIV99,
  8156           DFHEIV11,
  8157           DFHEIV99,
  8158           DFHEIV99,
  8159           DFHEIV99
  8160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8161
  8162
  8163     GO TO 9100-RETURN-TRAN.
  8164
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL636.cbl
  8166
  8167 8300-SEND-TEXT.
  8168
  8169* EXEC CICS SEND TEXT
  8170*        FROM     (LOGOFF-TEXT)
  8171*        LENGTH   (LOGOFF-LENGTH)
  8172*        ERASE
  8173*        FREEKB
  8174*    END-EXEC.
  8175*    MOVE '8&      T  E F  H   F -   #00006541' TO DFHEIV0
  8176     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8177     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8178     MOVE X'2020233030303036353431' TO DFHEIV0(25:11)
  8179     CALL 'kxdfhei1' USING DFHEIV0,
  8180           LOGOFF-TEXT,
  8181           LOGOFF-LENGTH,
  8182           DFHEIV99,
  8183           DFHEIV99,
  8184           DFHEIV99,
  8185           DFHEIV99,
  8186           DFHEIV99,
  8187           DFHEIV99,
  8188           DFHEIV99,
  8189           DFHEIV99,
  8190           DFHEIV99,
  8191           DFHEIV99
  8192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8193
  8194
  8195
  8196* EXEC CICS RETURN
  8197*    END-EXEC.
  8198*    MOVE '.(                    &   #00006548' TO DFHEIV0
  8199     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8200     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8201     MOVE X'2020233030303036353438' TO DFHEIV0(25:11)
  8202     CALL 'kxdfhei1' USING DFHEIV0,
  8203           DFHEIV99,
  8204           DFHEIV99,
  8205           DFHEIV99,
  8206           DFHEIV99,
  8207           DFHEIV99
  8208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8209
  8210
  8211
  8212 8400-LOG-JOURNAL-RECORD.
  8213     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
  8214     MOVE THIS-PGM                TO JP-PROGRAM-ID.
  8215
  8216*    EXEC CICS JOURNAL
  8217*        JFILEID     (PI-JOURNAL-FILE-ID)
  8218*        JTYPEID     ('EL')
  8219*        FROM        (JOURNAL-RECORD)
  8220*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
  8221*        END-EXEC.
  8222
  8223 8500-DATE-CONVERT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL636.cbl
  8224
  8225* EXEC CICS LINK
  8226*        PROGRAM  (LINK-ELDATCV)
  8227*        COMMAREA (DATE-CONVERSION-DATA)
  8228*        LENGTH   (DC-COMM-LENGTH)
  8229*    END-EXEC.
  8230*    MOVE '."C                   ''   #00006564' TO DFHEIV0
  8231     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8232     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8233     MOVE X'2020233030303036353634' TO DFHEIV0(25:11)
  8234     CALL 'kxdfhei1' USING DFHEIV0,
  8235           LINK-ELDATCV,
  8236           DATE-CONVERSION-DATA,
  8237           DC-COMM-LENGTH,
  8238           DFHEIV99,
  8239           DFHEIV99,
  8240           DFHEIV99
  8241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8242
  8243
  8244 8500-EXIT.
  8245     EXIT.
  8246
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL636.cbl
  8248
  8249 8600-DEEDIT.
  8250
  8251
  8252* EXEC CICS BIF DEEDIT
  8253*         FIELD   (DEEDIT-FIELD)
  8254*         LENGTH  (12)
  8255*    END-EXEC.
  8256     MOVE 12
  8257       TO DFHEIV11
  8258*    MOVE '@"L                   #   #00006577' TO DFHEIV0
  8259     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8260     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8261     MOVE X'2020233030303036353737' TO DFHEIV0(25:11)
  8262     CALL 'kxdfhei1' USING DFHEIV0,
  8263           DEEDIT-FIELD,
  8264           DFHEIV11
  8265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8266
  8267
  8268 8800-UNAUTHORIZED-ACCESS.
  8269     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8270     GO TO 8300-SEND-TEXT.
  8271
  8272 8810-PF23.
  8273     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8274     MOVE XCTL-EL005             TO PGM-NAME.
  8275     GO TO 9300-XCTL.
  8276
  8277 8820-PF08.
  8278     MOVE PI-LAST-STUB-KEY       TO PI-ERCKWK-KEY.
  8279     MOVE ZEROS                  TO PI-ERCKWK-SEQ-NO.
  8280     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8281     MOVE XCTL-EL6361            TO PGM-NAME.
  8282     GO TO 9300-XCTL.
  8283
  8284 9200-RETURN-MAIN-MENU.
  8285     MOVE XCTL-EL626             TO PGM-NAME.
  8286     GO TO 9300-XCTL.
  8287
  8288 9100-RETURN-TRAN.
  8289
  8290     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8291     MOVE '852A'                 TO PI-CURRENT-SCREEN-NO.
  8292
  8293
  8294* EXEC CICS RETURN
  8295*        TRANSID    (TRANS-EXJA)
  8296*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8297*        LENGTH     (PI-COMM-LENGTH)
  8298*    END-EXEC.
  8299*    MOVE '.(CT                  &   #00006607' TO DFHEIV0
  8300     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8301     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8302     MOVE X'2020233030303036363037' TO DFHEIV0(25:11)
  8303     CALL 'kxdfhei1' USING DFHEIV0,
  8304           TRANS-EXJA,
  8305           PROGRAM-INTERFACE-BLOCK,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL636.cbl
  8306           PI-COMM-LENGTH,
  8307           DFHEIV99,
  8308           DFHEIV99
  8309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8310
  8311
  8312 9300-XCTL.
  8313
  8314* EXEC CICS XCTL
  8315*        PROGRAM    (PGM-NAME)
  8316*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8317*        LENGTH     (PI-COMM-LENGTH)
  8318*    END-EXEC.
  8319*    MOVE '.$C                   $   #00006614' TO DFHEIV0
  8320     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8321     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8322     MOVE X'2020233030303036363134' TO DFHEIV0(25:11)
  8323     CALL 'kxdfhei1' USING DFHEIV0,
  8324           PGM-NAME,
  8325           PROGRAM-INTERFACE-BLOCK,
  8326           PI-COMM-LENGTH
  8327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8328
  8329
  8330 9400-CLEAR.
  8331     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME
  8332     GO TO 9300-XCTL.
  8333
  8334 9500-PF12.
  8335     MOVE XCTL-EL010             TO PGM-NAME.
  8336     GO TO 9300-XCTL.
  8337
  8338 9600-PGMID-ERROR.
  8339
  8340
  8341* EXEC CICS HANDLE CONDITION
  8342*        PGMIDERR    (8300-SEND-TEXT)
  8343*    END-EXEC.
  8344*    MOVE '"$L                   ! > #00006630' TO DFHEIV0
  8345     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8346     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8347     MOVE X'3E20233030303036363330' TO DFHEIV0(25:11)
  8348     CALL 'kxdfhei1' USING DFHEIV0
  8349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8350
  8351
  8352     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8353     MOVE ' '                    TO PI-ENTRY-CD-1.
  8354     MOVE XCTL-EL005             TO PGM-NAME.
  8355     MOVE PGM-NAME               TO LOGOFF-PGM.
  8356     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8357     GO TO 9300-XCTL.
  8358
  8359 9900-ERROR-FORMAT.
  8360
  8361     IF NOT EMI-ERRORS-COMPLETE
  8362         MOVE LINK-EL001         TO PGM-NAME
  8363
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL636.cbl
  8364* EXEC CICS LINK
  8365*            PROGRAM    (PGM-NAME)
  8366*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8367*            LENGTH     (EMI-COMM-LENGTH)
  8368*        END-EXEC.
  8369*    MOVE '."C                   ''   #00006645' TO DFHEIV0
  8370     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8371     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8372     MOVE X'2020233030303036363435' TO DFHEIV0(25:11)
  8373     CALL 'kxdfhei1' USING DFHEIV0,
  8374           PGM-NAME,
  8375           ERROR-MESSAGE-INTERFACE-BLOCK,
  8376           EMI-COMM-LENGTH,
  8377           DFHEIV99,
  8378           DFHEIV99,
  8379           DFHEIV99
  8380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8381
  8382
  8383 9900-EXIT.
  8384     EXIT.
  8385
  8386 9990-ABEND.
  8387     MOVE LINK-EL004             TO PGM-NAME.
  8388     MOVE DFHEIBLK               TO EMI-LINE1.
  8389
  8390* EXEC CICS LINK
  8391*        PROGRAM   (PGM-NAME)
  8392*        COMMAREA  (EMI-LINE1)
  8393*        LENGTH    (72)
  8394*    END-EXEC.
  8395     MOVE 72
  8396       TO DFHEIV11
  8397*    MOVE '."C                   ''   #00006657' TO DFHEIV0
  8398     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8399     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8400     MOVE X'2020233030303036363537' TO DFHEIV0(25:11)
  8401     CALL 'kxdfhei1' USING DFHEIV0,
  8402           PGM-NAME,
  8403           EMI-LINE1,
  8404           DFHEIV11,
  8405           DFHEIV99,
  8406           DFHEIV99,
  8407           DFHEIV99
  8408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8409
  8410
  8411     MOVE -1                     TO PFENTERL.
  8412
  8413     GO TO 8200-SEND-DATAONLY.
  8414
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL636.cbl
  8416
  8417 9995-SECURITY-VIOLATION.
  8418*                            COPY ELCSCTP.
  8419******************************************************************
  8420*                                                                *
  8421*                            ELCSCTP                             *
  8422*                            VMOD=2.001                          *
  8423*                                                                *
  8424*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8425******************************************************************
  8426
  8427
  8428     MOVE EIBDATE          TO SM-JUL-DATE.
  8429     MOVE EIBTRMID         TO SM-TERMID.
  8430     MOVE THIS-PGM         TO SM-PGM.
  8431     MOVE EIBTIME          TO TIME-IN.
  8432     MOVE TIME-OUT         TO SM-TIME.
  8433     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8434
  8435
  8436* EXEC CICS LINK
  8437*         PROGRAM  ('EL003')
  8438*         COMMAREA (SECURITY-MESSAGE)
  8439*         LENGTH   (80)
  8440*    END-EXEC.
  8441     MOVE 'EL003' TO DFHEIV1
  8442     MOVE 80
  8443       TO DFHEIV11
  8444*    MOVE '."C                   ''   #00006687' TO DFHEIV0
  8445     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8446     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8447     MOVE X'2020233030303036363837' TO DFHEIV0(25:11)
  8448     CALL 'kxdfhei1' USING DFHEIV0,
  8449           DFHEIV1,
  8450           SECURITY-MESSAGE,
  8451           DFHEIV11,
  8452           DFHEIV99,
  8453           DFHEIV99,
  8454           DFHEIV99
  8455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8456
  8457
  8458******************************************************************
  8459
  8460
  8461 9995-EXIT.
  8462     EXIT.
  8463
  8464
  8465 9999-DFHBACK SECTION.
  8466     MOVE '9%                    "   ' TO DFHEIV0
  8467     MOVE 'EL636' TO DFHEIV1
  8468     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8469     GOBACK.
  8470 9999-DFHEXIT.
  8471     IF DFHEIGDJ EQUAL 0001
  8472         NEXT SENTENCE
  8473     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL636.cbl
  8474         GO TO 9600-PGMID-ERROR,
  8475               9990-ABEND
  8476         DEPENDING ON DFHEIGDI
  8477     ELSE IF DFHEIGDJ EQUAL 3
  8478         GO TO 1420-FIRST-NOTFND
  8479         DEPENDING ON DFHEIGDI
  8480     ELSE IF DFHEIGDJ EQUAL 4
  8481         GO TO 1440-SECOND-NOTFND
  8482         DEPENDING ON DFHEIGDI
  8483     ELSE IF DFHEIGDJ EQUAL 5
  8484         GO TO 1440-SECOND-NOTFND
  8485         DEPENDING ON DFHEIGDI
  8486     ELSE IF DFHEIGDJ EQUAL 6
  8487         GO TO 1485-NO-COMP-MSTR
  8488         DEPENDING ON DFHEIGDI
  8489     ELSE IF DFHEIGDJ EQUAL 7
  8490         GO TO 1680-NOT-FOUND,
  8491               9990-ABEND
  8492         DEPENDING ON DFHEIGDI
  8493     ELSE IF DFHEIGDJ EQUAL 8
  8494         GO TO 2060-DUPLICATE-CHECK
  8495         DEPENDING ON DFHEIGDI
  8496     ELSE IF DFHEIGDJ EQUAL 9
  8497         GO TO 2080-DUPLICATE-CHECK
  8498         DEPENDING ON DFHEIGDI
  8499     ELSE IF DFHEIGDJ EQUAL 10
  8500         GO TO 2095-HEADER-ROLLBACK
  8501         DEPENDING ON DFHEIGDI
  8502     ELSE IF DFHEIGDJ EQUAL 11
  8503         GO TO 3010-CHANGE-ENTRIES
  8504         DEPENDING ON DFHEIGDI
  8505     ELSE IF DFHEIGDJ EQUAL 12
  8506         GO TO 3090-CHECKS-NOTFND,
  8507               3090-CHECKS-NOTFND
  8508         DEPENDING ON DFHEIGDI
  8509     ELSE IF DFHEIGDJ EQUAL 13
  8510         GO TO 3280-HEADER-NOTFND
  8511         DEPENDING ON DFHEIGDI
  8512     ELSE IF DFHEIGDJ EQUAL 14
  8513         GO TO 3270-DUP-ENTRY
  8514         DEPENDING ON DFHEIGDI
  8515     ELSE IF DFHEIGDJ EQUAL 15
  8516         GO TO 3380-HEADER-NOTFND
  8517         DEPENDING ON DFHEIGDI
  8518     ELSE IF DFHEIGDJ EQUAL 16
  8519         GO TO 3490-FINISHED,
  8520               3490-FINISHED
  8521         DEPENDING ON DFHEIGDI
  8522     ELSE IF DFHEIGDJ EQUAL 17
  8523         GO TO 9990-ABEND
  8524         DEPENDING ON DFHEIGDI
  8525     ELSE IF DFHEIGDJ EQUAL 18
  8526         GO TO 4080-PAYEE-NOTFND,
  8527               4070-PAYEE-DELETED
  8528         DEPENDING ON DFHEIGDI
  8529     ELSE IF DFHEIGDJ EQUAL 19
  8530         GO TO 5090-CHECKS-NOTFND,
  8531               5090-CHECKS-NOTFND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL636.cbl
  8532         DEPENDING ON DFHEIGDI
  8533     ELSE IF DFHEIGDJ EQUAL 20
  8534         GO TO 5070-CHECK-PROCESSED,
  8535               5060-END-OF-FILE
  8536         DEPENDING ON DFHEIGDI
  8537     ELSE IF DFHEIGDJ EQUAL 21
  8538         GO TO 5095-CHECKS-NOTFND,
  8539               5095-CHECKS-NOTFND
  8540         DEPENDING ON DFHEIGDI
  8541     ELSE IF DFHEIGDJ EQUAL 22
  8542         GO TO 6060-END-OF-FILE
  8543         DEPENDING ON DFHEIGDI
  8544     ELSE IF DFHEIGDJ EQUAL 23
  8545         GO TO 6160-END-OF-FILE
  8546         DEPENDING ON DFHEIGDI
  8547     ELSE IF DFHEIGDJ EQUAL 24
  8548         GO TO 7090-CHECKS-NOTFND,
  8549               7090-CHECKS-NOTFND
  8550         DEPENDING ON DFHEIGDI
  8551     ELSE IF DFHEIGDJ EQUAL 25
  8552         GO TO 7070-CHECK-PROCESSED,
  8553               7070-CHECK-PROCESSED
  8554         DEPENDING ON DFHEIGDI
  8555     ELSE IF DFHEIGDJ EQUAL 26
  8556         GO TO 7190-EXIT,
  8557               7190-EXIT
  8558         DEPENDING ON DFHEIGDI
  8559     ELSE IF DFHEIGDJ EQUAL 27
  8560         GO TO 7480-DUPREC
  8561         DEPENDING ON DFHEIGDI
  8562     ELSE IF DFHEIGDJ EQUAL 28
  8563         GO TO 7550-VOID-WORK-RECS,
  8564               7550-VOID-WORK-RECS
  8565         DEPENDING ON DFHEIGDI
  8566     ELSE IF DFHEIGDJ EQUAL 29
  8567         GO TO 7570-COMM-CHECK-VOIDED,
  8568               7570-COMM-CHECK-VOIDED
  8569         DEPENDING ON DFHEIGDI
  8570     ELSE IF DFHEIGDJ EQUAL 30
  8571         GO TO 8300-SEND-TEXT
  8572         DEPENDING ON DFHEIGDI.
  8573     MOVE '9%                    "   ' TO DFHEIV0
  8574     MOVE 'EL636' TO DFHEIV1
  8575     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8576     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6860     Code:       28013
