* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* ELRTRM.cbl
* Options: int("ELRTRM.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELRTRM.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRTRM.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRTRM.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRTRM.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:23:13.
     7*                            VMOD=2.009
     8*
     9*AUTHOR.       LOGIC, INC.
    10*              DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* ELRTRM.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *                                                   *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE REMAINING TERMS      *
    28*            *    FOR A CERTIFICATE.                             *
    29*            *                                                   *
    30*            *    START DATE = CP-CERT-EFF-DATE + EXTENTION DAYS *
    31*            *    END-DATE = VALUATION-DATE                      *
    32*            *    METHOD = CP-REM-TERM-METHOD                    *
    33*            *    IF COMPANY SPECIAL METHOD METHOD - PUT COMPANY *
    34*            *    I.D. IN CP-COMPANY-ID.                         *
    35*            *                                                   *
    36*            *****************************************************
    37 ENVIRONMENT DIVISION.
    38
    39 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* ELRTRM.cbl
    41 WORKING-STORAGE SECTION.
    42 01  DFH-START PIC X(04).
    43 77  FILLER   PIC X(32) VALUE '********************************'.
    44 77  FILLER   PIC X(32) VALUE '**  ELRTRM  WORKING STORAGE   **'.
    45 77  FILLER   PIC X(32) VALUE '********* VMOD 2.009 ***********'.
    46
    47*01  RT-BGN-DATE.
    48*    12  RT-BGN-YR          PIC 99.
    49*    12  RT-BGN-MO          PIC 99.
    50*    12  RT-BGN-DA          PIC 99.
    51
    52*01  RT-END-DATE.
    53*    12  RT-END-YR          PIC 99.
    54*    12  RT-END-MO          PIC 99.
    55*    12  RT-END-DA          PIC 99.
    56
    57*01  RT-SAVE-DATE           PIC XX.
    58
    59 01  MISC-CALCULATION-AREAS.
    60     03  SAVE-ODD-DAYS      PIC S99      VALUE ZERO.
    61     03  MONTHS-EARNED      PIC 9        VALUE ZERO.
    62     03  MONTHS-EARNED-1    PIC 9        VALUE ZERO.
    63     03  MONTHS-EARNED-2    PIC 9        VALUE ZERO.
    64     03  TERM-IN-MONTHS     PIC S9(3)    VALUE ZERO.
    65
    66     03  WS-TOP-NUMBER          PIC 9(8).
    67     03  WS-TOP-NUMBER-R  REDEFINES  WS-TOP-NUMBER.
    68         05  WS-TOP-CCYR        PIC 9(4).
    69         05  WS-TOP-MO          PIC 99.
    70         05  WS-TOP-DA          PIC 99.
    71
    72     03  WS-BOTTOM-NUMBER       PIC 9(8).
    73     03  WS-BOTTOM-NUMBER-R  REDEFINES  WS-BOTTOM-NUMBER.
    74         05  WS-BOTTOM-CCYR     PIC 9(4).
    75         05  WS-BOTTOM-MO       PIC 99.
    76         05  WS-BOTTOM-DA       PIC 99.
    77
    78     03  WS-RESULT-NUMBER.
    79         05  WS-RESULT-CCYR     PIC S9(4).
    80         05  WS-RESULT-MO       PIC S99.
    81         05  WS-RESULT-DA       PIC S99.
    82
    83     03  WS-SAVE-EFFECTIVE-DATE PIC 9(8).
    84     03  WS-SAVE-EFF-DATE-R  REDEFINES  WS-SAVE-EFFECTIVE-DATE.
    85         05  FILLER             PIC 9(6).
    86         05  SAVE-EFF-DAYS      PIC 99.
    87
    88     03  WS-SAVE-PAYMENT-DATE   PIC 9(8).
    89     03  WS-SAVE-PAYMENT-DATE-R  REDEFINES  WS-SAVE-PAYMENT-DATE.
    90         05  FILLER             PIC 9(4).
    91         05  SAVE-PAY-MO        PIC 99.
    92         05  SAVE-PAY-DAYS      PIC 99.
    93
    94     03  WS-SAVE-VALUATION-DATE PIC 9(8).
    95     03  WS-SAVE-VAL-DATE-R  REDEFINES  WS-SAVE-VALUATION-DATE.
    96         05  FILLER             PIC 9(6).
    97         05  SAVE-VAL-DAYS      PIC 99.
    98
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* ELRTRM.cbl
    99     03  WS-SAVE-EXPIRATION-DATE PIC 9(8).
   100     03  WS-SAVE-EXP-DATE-R  REDEFINES  WS-SAVE-EXPIRATION-DATE.
   101         05  FILLER             PIC 9(6).
   102         05  SAVE-EXP-DAYS      PIC 99.
   103
   104     03  WS-SAVE-BINARY-DATE    PIC XX.
   105
   106*    03  WS-SAVE-MONTH-END-DATE.
   107*        05  FILLER             PIC S99.
   108*        05  FILLER             PIC S99.
   109*        05  WS-DAYS-IN-THIS-MO PIC S99.
   110
   111 01  MISC-SWITCHES.
   112     03  PAYMENT-EOM        PIC X.
   113         88 PAYMENT-DATE-EOM    VALUE 'Y'.
   114     03  EFFECTIVE-EOM      PIC X.
   115         88 EFFECTIVE-DATE-EOM  VALUE 'Y'.
   116     03  VALUATION-EOM      PIC X.
   117         88 VALUATION-DATE-EOM  VALUE 'Y'.
   118     03  TOP-EOM            PIC X.
   119         88 TOP-NUMBER-EOM      VALUE 'Y'.
   120     03  BOTTOM-EOM         PIC X.
   121         88 BOTTOM-NUMBER-EOM   VALUE 'Y'.
   122     03  EXPIRATION-EOM     PIC X.
   123         88 EXPIRATION-DATE-EOM VALUE 'Y'.
   124
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* ELRTRM.cbl
   126*                           COPY ELCDATE.
   127******************************************************************
   128*                                                                *
   129*                                                                *
   130*                            ELCDATE.                            *
   131*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   132*                            VMOD=2.003
   133*                                                                *
   134*                                                                *
   135*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   136*                 LENGTH = 200                                   *
   137******************************************************************
   138
   139 01  DATE-CONVERSION-DATA.
   140     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   141     12  DC-OPTION-CODE                PIC X.
   142         88  BIN-TO-GREG                VALUE ' '.
   143         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   144         88  EDIT-GREG-TO-BIN           VALUE '2'.
   145         88  YMD-GREG-TO-BIN            VALUE '3'.
   146         88  MDY-GREG-TO-BIN            VALUE '4'.
   147         88  JULIAN-TO-BIN              VALUE '5'.
   148         88  BIN-PLUS-ELAPSED           VALUE '6'.
   149         88  FIND-CENTURY               VALUE '7'.
   150         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   151         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   152         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   153         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   154         88  JULIAN-TO-BIN-3            VALUE 'C'.
   155         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   156         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   157         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   158         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   159         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   160         88  CHECK-LEAP-YEAR            VALUE 'H'.
   161         88  BIN-3-TO-GREG              VALUE 'I'.
   162         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   163         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   164         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   165         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   166         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   167         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   168         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   169         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   170         88  THREE-CHARACTER-BIN
   171                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   172         88  GREGORIAN-TO-BIN
   173                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   174         88  BIN-TO-GREGORIAN
   175                  VALUES ' ' '1' 'I' '8' 'G'.
   176         88  JULIAN-TO-BINARY
   177                  VALUES '5' 'C' 'E' 'F'.
   178     12  DC-ERROR-CODE                 PIC X.
   179         88  NO-CONVERSION-ERROR        VALUE ' '.
   180         88  DATE-CONVERSION-ERROR
   181                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   182         88  DATE-IS-ZERO               VALUE '1'.
   183         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* ELRTRM.cbl
   184         88  DATE-IS-INVALID            VALUE '3'.
   185         88  DATE1-GREATER-DATE2        VALUE '4'.
   186         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   187         88  DATE-INVALID-OPTION        VALUE '9'.
   188         88  INVALID-CENTURY            VALUE 'A'.
   189         88  ONLY-CENTURY               VALUE 'B'.
   190         88  ONLY-LEAP-YEAR             VALUE 'C'.
   191         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   192     12  DC-END-OF-MONTH               PIC X.
   193         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   194     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   195         88  USE-NORMAL-PROCESS         VALUE ' '.
   196         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   197         88  ADJUST-UP-100-YRS          VALUE '2'.
   198     12  FILLER                        PIC X.
   199     12  DC-CONVERSION-DATES.
   200         16  DC-BIN-DATE-1             PIC XX.
   201         16  DC-BIN-DATE-2             PIC XX.
   202         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   203         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   204                       DC-GREG-DATE-1-EDIT.
   205             20  DC-EDIT1-MONTH        PIC 99.
   206             20  SLASH1-1              PIC X.
   207             20  DC-EDIT1-DAY          PIC 99.
   208             20  SLASH1-2              PIC X.
   209             20  DC-EDIT1-YEAR         PIC 99.
   210         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   211         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   212                     DC-GREG-DATE-2-EDIT.
   213             20  DC-EDIT2-MONTH        PIC 99.
   214             20  SLASH2-1              PIC X.
   215             20  DC-EDIT2-DAY          PIC 99.
   216             20  SLASH2-2              PIC X.
   217             20  DC-EDIT2-YEAR         PIC 99.
   218         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   219         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   220                     DC-GREG-DATE-1-YMD.
   221             20  DC-YMD-YEAR           PIC 99.
   222             20  DC-YMD-MONTH          PIC 99.
   223             20  DC-YMD-DAY            PIC 99.
   224         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   225         16  DC-GREG-DATE-1-MDY-R REDEFINES
   226                      DC-GREG-DATE-1-MDY.
   227             20  DC-MDY-MONTH          PIC 99.
   228             20  DC-MDY-DAY            PIC 99.
   229             20  DC-MDY-YEAR           PIC 99.
   230         16  DC-GREG-DATE-1-ALPHA.
   231             20  DC-ALPHA-MONTH        PIC X(10).
   232             20  DC-ALPHA-DAY          PIC 99.
   233             20  FILLER                PIC XX.
   234             20  DC-ALPHA-CENTURY.
   235                 24 DC-ALPHA-CEN-N     PIC 99.
   236             20  DC-ALPHA-YEAR         PIC 99.
   237         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   238         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   239         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   240         16  DC-JULIAN-DATE            PIC 9(05).
   241         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* ELRTRM.cbl
   242                                       PIC 9(05).
   243         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   244             20  DC-JULIAN-YEAR        PIC 99.
   245             20  DC-JULIAN-DAYS        PIC 999.
   246         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   247         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   248         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   249     12  DATE-CONVERSION-VARIBLES.
   250         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   251         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   252             20  FILLER                PIC 9(3).
   253             20  HOLD-CEN-1-CCYY.
   254                 24  HOLD-CEN-1-CC     PIC 99.
   255                 24  HOLD-CEN-1-YY     PIC 99.
   256             20  HOLD-CEN-1-MO         PIC 99.
   257             20  HOLD-CEN-1-DA         PIC 99.
   258         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   259             20  HOLD-CEN-1-R-MO       PIC 99.
   260             20  HOLD-CEN-1-R-DA       PIC 99.
   261             20  HOLD-CEN-1-R-CCYY.
   262                 24  HOLD-CEN-1-R-CC   PIC 99.
   263                 24  HOLD-CEN-1-R-YY   PIC 99.
   264             20  FILLER                PIC 9(3).
   265         16  HOLD-CENTURY-1-X.
   266             20  FILLER                PIC X(3)  VALUE SPACES.
   267             20  HOLD-CEN-1-X-CCYY.
   268                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   269                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   270             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   271             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   272         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   273             20  HOLD-CEN-1-R-X-MO     PIC XX.
   274             20  HOLD-CEN-1-R-X-DA     PIC XX.
   275             20  HOLD-CEN-1-R-X-CCYY.
   276                 24  HOLD-CEN-1-R-X-CC PIC XX.
   277                 24  HOLD-CEN-1-R-X-YY PIC XX.
   278             20  FILLER                PIC XXX.
   279         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   280         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   281         16  DC-JULIAN-DATE-1          PIC 9(07).
   282         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   283             20  DC-JULIAN-1-CCYY.
   284                 24  DC-JULIAN-1-CC    PIC 99.
   285                 24  DC-JULIAN-1-YR    PIC 99.
   286             20  DC-JULIAN-DA-1        PIC 999.
   287         16  DC-JULIAN-DATE-2          PIC 9(07).
   288         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   289             20  DC-JULIAN-2-CCYY.
   290                 24  DC-JULIAN-2-CC    PIC 99.
   291                 24  DC-JULIAN-2-YR    PIC 99.
   292             20  DC-JULIAN-DA-2        PIC 999.
   293         16  DC-GREG-DATE-A-EDIT.
   294             20  DC-EDITA-MONTH        PIC 99.
   295             20  SLASHA-1              PIC X VALUE '/'.
   296             20  DC-EDITA-DAY          PIC 99.
   297             20  SLASHA-2              PIC X VALUE '/'.
   298             20  DC-EDITA-CCYY.
   299                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* ELRTRM.cbl
   300                 24  DC-EDITA-YEAR     PIC 99.
   301         16  DC-GREG-DATE-B-EDIT.
   302             20  DC-EDITB-MONTH        PIC 99.
   303             20  SLASHB-1              PIC X VALUE '/'.
   304             20  DC-EDITB-DAY          PIC 99.
   305             20  SLASHB-2              PIC X VALUE '/'.
   306             20  DC-EDITB-CCYY.
   307                 24  DC-EDITB-CENT     PIC 99.
   308                 24  DC-EDITB-YEAR     PIC 99.
   309         16  DC-GREG-DATE-CYMD         PIC 9(08).
   310         16  DC-GREG-DATE-CYMD-R REDEFINES
   311                              DC-GREG-DATE-CYMD.
   312             20  DC-CYMD-CEN           PIC 99.
   313             20  DC-CYMD-YEAR          PIC 99.
   314             20  DC-CYMD-MONTH         PIC 99.
   315             20  DC-CYMD-DAY           PIC 99.
   316         16  DC-GREG-DATE-MDCY         PIC 9(08).
   317         16  DC-GREG-DATE-MDCY-R REDEFINES
   318                              DC-GREG-DATE-MDCY.
   319             20  DC-MDCY-MONTH         PIC 99.
   320             20  DC-MDCY-DAY           PIC 99.
   321             20  DC-MDCY-CEN           PIC 99.
   322             20  DC-MDCY-YEAR          PIC 99.
   323    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   324        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   325    12  DC-EL310-DATE                  PIC X(21).
   326    12  FILLER                         PIC X(28).
   327
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* ELRTRM.cbl
   329*                           COPY ELCCALC.
   330******************************************************************
   331*                                                                *
   332*                           ELCCALC.                            *
   333*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   334*                            VMOD=2.025                          *
   335*                                                                *
   336*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   337*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   338*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   339*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   340*                                                                *
   341*  PASSED TO ELRTRM                                              *
   342*  -----------------                                             *
   343*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   344*  ORIGINAL TERM                                                 *
   345*  BEGINNING DATE                                                *
   346*  ENDING DATE                                                   *
   347*  COMPANY I.D.                                                  *
   348*  ACCOUNT MASTER USER FIELD                                     *
   349*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   350*  FREE LOOK DAYS                                                *
   351*                                                                *
   352*  RETURNED FROM ELRTRM                                          *
   353*  ---------------------                                         *
   354*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   355*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   356*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   357*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   358*----------------------------------------------------------------*
   359*  PASSED TO ELRAMT                                              *
   360*  ----------------                                              *
   361*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   362*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   363*  ORIGINAL AMOUNT                                               *
   364*  ALTERNATE BENEFIT (BALLON)                                    *
   365*  A.P.R. - NET PAY ONLY                                         *
   366*  METHOD
   367*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   368*  COMPANY I.D.                                                  *
   369*  BENEFIT TYPE                                                  *
   370*                                                                *
   371*  RETURNED FROM ELRAMT                                          *
   372*  --------------------                                          *
   373*  REMAINING AMOUNT 1 - CURRENT                                  *
   374*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   375*  REMAINING AMOUNT FACTOR
   376*----------------------------------------------------------------*
   377*  PASSED TO ELRESV                                              *
   378*  -----------------                                             *
   379*  CERTIFICATE EFFECTIVE DATE                                    *
   380*  VALUATION DATE                                                *
   381*  PAID THRU DATE                                                *
   382*  BENEFIT                                                       *
   383*  INCURRED DATE                                                 *
   384*  REPORTED DATE                                                 *
   385*  ISSUE AGE                                                     *
   386*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* ELRTRM.cbl
   387*  CDT PERCENT                                                   *
   388*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   389* *CLAIM TYPE (LIFE, A/H)                                        *
   390* *REMAINING BENEFIT (FROM ELRAMT)                               *
   391* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   392*                                                                *
   393*  RETURNED FROM ELRESV                                          *
   394*  --------------------                                          *
   395*  CDT TABLE USED                                                *
   396*  CDT FACTOR USED                                               *
   397*  PAY TO CURRENT RESERVE                                        *
   398*  I.B.N.R. - A/H ONLY                                           *
   399*  FUTURE (ACCRUED) AH ONLY                                      *
   400*----------------------------------------------------------------*
   401*  PASSED TO ELRATE                                              *
   402*  ----------------                                              *
   403*  CERT ISSUE DATE                                               *
   404*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   405*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   406*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   407*  STATE CODE (CLIENT DEFINED)                                   *
   408*  STATE CODE (STANDARD P.O. ABBRV)                              *
   409*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   410*  DEVIATION CODE                                                *
   411*  ISSUE AGE                                                     *
   412*  ORIGINAL BENEFIT AMOUNT                                       *
   413*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   414*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   415*  BENEFIT KIND (LIFE OR A/H)                                    *
   416*  A.P.R.                                                        *
   417*  METHOD
   418*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   419*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   420*  COMPANY I.D. (3 CHARACTER)                                    *
   421*  BENEFIT CODE                                                  *
   422*  BENEFIT OVERRIDE CODE                                         *
   423*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   424*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   425*  JOINT INDICATOR (CSL ONLY)                                    *
   426*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   427*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   428*                                                                *
   429*  RETURNED FROM ELRATE                                          *
   430*  --------------------                                          *
   431*  CALCULATED PREMIUM                                            *
   432*  PREMIUM RATE                                                  *
   433*  MORTALITY CODE                                                *
   434*  MAX ATTAINED AGE                                              *
   435*  MAX AGE                                                       *
   436*  MAX TERM                                                      *
   437*  MAX MONTHLY BENEFIT                                           *
   438*  MAX TOTAL BENIFIT                                             *
   439*  COMPOSITE RATE (OPEN-END ONLY)                                *
   440*----------------------------------------------------------------*
   441*  PASSED TO ELRFND                                              *
   442*  ----------------                                              *
   443*  CERT ISSUE DATE                                               *
   444*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* ELRTRM.cbl
   445*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   446*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   447*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   448*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   449*  STATE CODE (CLIENT DEFINED)                                   *
   450*  STATE CODE (STANDARD P.O. ABBRV)                              *
   451*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   452*  DEVIATION CODE                                                *
   453*  ISSUE AGE                                                     *
   454*  ORIGINAL BENEFIT AMOUNT                                       *
   455*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   456*  PROCESS TYPE (CANCEL)                                         *
   457*  BENEFIT KIND (LIFE OR A/H)                                    *
   458*  A.P.R.                                                        *
   459*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   460*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   461*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   462*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   463*  COMPANY I.D. (3 CHARACTER)                                    *
   464*  BENEFIT CODE                                                  *
   465*  BENEFIT OVERRIDE CODE                                         *
   466*                                                                *
   467*  RETURNED FROM ELRFND                                          *
   468*  --------------------                                          *
   469*  CALCULATED REFUND                                             *
   470*----------------------------------------------------------------*
   471*  PASSED TO ELEARN                                              *
   472*  ----------------                                              *
   473*  CERT ISSUE DATE                                               *
   474*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   475*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   476*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   477*  STATE CODE (CLIENT DEFINED)                                   *
   478*  STATE CODE (STANDARD P.O. ABBRV)                              *
   479*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   480*  DEVIATION CODE                                                *
   481*  ISSUE AGE                                                     *
   482*  ORIGINAL BENEFIT AMOUNT                                       *
   483*  BENEFIT KIND (LIFE OR A/H)                                    *
   484*  A.P.R.                                                        *
   485*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   486*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   487*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   488*  COMPANY I.D. (3 CHARACTER)                                    *
   489*  BENEFIT CODE                                                  *
   490*  BENEFIT OVERRIDE CODE                                         *
   491*                                                                *
   492*  RETURNED FROM ELEARN                                          *
   493*  --------------------                                          *
   494*  INDICATED  EARNINGS                                           *
   495*----------------------------------------------------------------*
   496*                 LENGTH = 450                                   *
   497*                                                                *
   498******************************************************************
   499******************************************************************
   500*                   C H A N G E   L O G
   501*
   502* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* ELRTRM.cbl
   503*-----------------------------------------------------------------
   504*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   505* EFFECTIVE    NUMBER
   506*-----------------------------------------------------------------
   507* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   508* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   509* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   510* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   511* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   512* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   513* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   514******************************************************************
   515
   516 01  CALCULATION-PASS-AREA.
   517     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   518                                     COMP.
   519
   520     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   521       88  NO-CP-ERROR                             VALUE ZERO.
   522       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   523                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   524       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   525       88  CP-ERROR-IN-DATES                       VALUE '2'.
   526       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   527       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   528       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   529       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   530       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   531       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   532       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   533       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   534       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   535       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   536       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   537       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   538       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   539       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   540       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   541
   542     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   543       88  NO-CP-ERROR-2                           VALUE ZERO.
   544***********************  INPUT AREAS ****************************
   545
   546     12  CP-CALCULATION-AREA.
   547         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   548         16  CP-CERT-EFF-DT        PIC XX.
   549         16  CP-VALUATION-DT       PIC XX.
   550         16  CP-PAID-THRU-DT       PIC XX.
   551         16  CP-BENEFIT-TYPE       PIC X.
   552           88  CP-AH                               VALUE 'A' 'D'
   553                                                   'I' 'U'.
   554           88  CP-REDUCING-LIFE                    VALUE 'R'.
   555           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   556         16  CP-INCURRED-DT        PIC XX.
   557         16  CP-REPORTED-DT        PIC XX.
   558         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   559         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   560         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* ELRTRM.cbl
   561                                     COMP-3.
   562         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   563                                     COMP-3.
   564         16  CP-CDT-METHOD         PIC X.
   565           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   566           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   567           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   568         16  CP-CLAIM-TYPE         PIC X.
   569           88  CP-AH-CLAIM                         VALUE 'A'.
   570           88  CP-LIFE-CLAIM                       VALUE 'L'.
   571         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   572                                     COMP-3.
   573         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   574                                     COMP-3.
   575         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   576                                     COMP-3.
   577         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   578                                     COMP-3.
   579         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   580                                     COMP-3.
   581         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   582                                     COMP-3.
   583         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   584                                     COMP-3.
   585         16  CP-REM-TERM-METHOD    PIC X.
   586           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   587           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   588           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   589           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   590           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   591           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   592           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   593         16  CP-EARNING-METHOD     PIC X.
   594           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   595           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   596           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   597           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   598           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   599           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   600           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   601           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   602           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   603           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   604           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   605           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   606         16  CP-PROCESS-TYPE       PIC X.
   607           88  CP-CLAIM                            VALUE '1'.
   608           88  CP-CANCEL                           VALUE '2'.
   609           88  CP-ISSUE                            VALUE '3'.
   610         16  CP-SPECIAL-CALC-CD    PIC X.
   611           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   612           88  CP-1-MTH-INTEREST               VALUE ' '.
   613           88  CP-0-MTH-INTEREST               VALUE 'A'.
   614           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   615           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   616           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   617           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   618           88  CP-FARM-PLAN                    VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* ELRTRM.cbl
   619           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   620           88  CP-2-MTH-INTEREST               VALUE 'I'.
   621           88  CP-3-MTH-INTEREST               VALUE 'J'.
   622           88  CP-4-MTH-INTEREST               VALUE 'K'.
   623           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   624           88  CP-MORTGAGE-REC                 VALUE 'M'.
   625           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   626           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   627           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   628           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   629                                                     'W' 'X'.
   630           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   631           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   632           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   633           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   634           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   635           88  CP-SUMMARY-REC                  VALUE 'Z'.
   636           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   637           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   638           88  CP-AD-D-BENEFIT                 VALUE '4'.
   639           88  CP-CSL-METH-1                   VALUE '5'.
   640           88  CP-CSL-METH-2                   VALUE '6'.
   641           88  CP-CSL-METH-3                   VALUE '7'.
   642           88  CP-CSL-METH-4                   VALUE '8'.
   643
   644         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   645                                     COMP-3.
   646         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   647         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   648         16  CP-STATE              PIC XX          VALUE SPACE.
   649         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   650         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   651           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   652               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   653         16  CP-R78-OPTION         PIC X.
   654           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   655           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   656
   657         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   658         16  CP-IBNR-RESERVE-SW    PIC X.
   659         16  CP-CLAIM-STATUS       PIC X.
   660         16  CP-RATE-FILE          PIC X.
   661         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   662                                     COMP-3.
   663
   664         16  CP-LIFE-OVERRIDE-CODE PIC X.
   665         16  CP-AH-OVERRIDE-CODE   PIC X.
   666
   667         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   668                                     COMP-3.
   669         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   670                                     COMP-3.
   671         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   672                                     COMP-3.
   673         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   674                                     COMP-3.
   675
   676         16  CP-PAID-FROM-DATE     PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* ELRTRM.cbl
   677         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   678         16  CP-EXT-DAYS-CALC      PIC X.
   679           88  CP-EXT-NO-CHG                   VALUE ' '.
   680           88  CP-EXT-CHG-LF                   VALUE '1'.
   681           88  CP-EXT-CHG-AH                   VALUE '2'.
   682           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   683         16  CP-DOMICILE-STATE     PIC XX.
   684         16  CP-CARRIER            PIC X.
   685         16  CP-REIN-FLAG          PIC X.
   686         16  CP-REM-TRM-CALC-OPTION PIC X.
   687           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   688                      '2' '3' '4' '5'.
   689           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   690           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   691           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   692           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   693           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   694           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   695           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   696           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   697         16  CP-SIG-SWITCH         PIC X.
   698         16  CP-RATING-METHOD      PIC X.
   699           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   700           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   701           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   702           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   703           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   704           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   705           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   706           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   707           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   708         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   709                                     COMP-3.
   710         16  CP-BEN-CATEGORY       PIC X.
   711         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   712         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   713                                   PIC S99V9(5) COMP-3.
   714         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   715         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   716                                   PIC S99V9(5) COMP-3.
   717         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   718         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   719         16  CP-EXPIRE-DT          PIC XX.
   720         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   721         16  FILLER                PIC X(35).
   722*        16  FILLER                PIC X(50).
   723
   724***************    OUTPUT FROM ELRESV   ************************
   725
   726         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   727
   728         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   729                                     COMP-3.
   730         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   731                                     COMP-3.
   732         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   733                                     COMP-3.
   734         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* ELRTRM.cbl
   735                                     COMP-3.
   736         16  FILLER                PIC X(09).
   737***************    OUTPUT FROM ELRTRM   *************************
   738
   739         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   740                                     COMP-3.
   741         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   742                                     COMP-3.
   743         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   744                                     COMP-3.
   745         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   746                                     COMP-3.
   747         16  FILLER                PIC X(12).
   748
   749***************    OUTPUT FROM ELRAMT   *************************
   750
   751         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   752                                     COMP-3.
   753         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   754                                     COMP-3.
   755         16  FILLER                PIC X(12).
   756
   757***************    OUTPUT FROM ELRATE   *************************
   758
   759         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   760                                     COMP-3.
   761         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   762                                     COMP-3.
   763         16  CP-MORTALITY-CODE     PIC X(4).
   764         16  CP-RATE-EDIT-FLAG     PIC X.
   765             88  CP-RATES-NEED-APR                  VALUE '1'.
   766         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   767                                     COMP-3.
   768         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   769         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   770         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   771                                   PIC S9(7)V99 COMP-3.
   772         16  FILLER                PIC X(07).
   773
   774***************    OUTPUT FROM ELRFND   *************************
   775
   776         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   777                                     COMP-3.
   778         16  CP-REFUND-TYPE-USED   PIC X.
   779           88  CP-R-AS-R78                         VALUE '1'.
   780           88  CP-R-AS-PRORATA                     VALUE '2'.
   781           88  CP-R-AS-CALIF                       VALUE '3'.
   782           88  CP-R-AS-TEXAS                       VALUE '4'.
   783           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   784           88  CP-R-AS-NET-PAY                     VALUE '5'.
   785           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   786           88  CP-R-AS-MEAN                        VALUE '8'.
   787           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   788           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   789           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   790         16  FILLER                PIC X(12).
   791
   792***************    OUTPUT FROM ELEARN   *************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* ELRTRM.cbl
   793
   794         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   795                                     COMP-3.
   796         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
   797                                     COMP-3.
   798         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
   799                                     COMP-3.
   800         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
   801                                     COMP-3.
   802         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
   803                                     COMP-3.
   804         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
   805                                     COMP-3.
   806         16  CP-EARNING-TYPE-USED  PIC X.
   807           88  CP-E-AS-SPECIAL                     VALUE 'S'.
   808           88  CP-E-AS-R78                         VALUE '1'.
   809           88  CP-E-AS-PRORATA                     VALUE '2'.
   810           88  CP-E-AS-TEXAS                       VALUE '4'.
   811           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
   812           88  CP-E-AS-NET-PAY                     VALUE '5'.
   813           88  CP-E-AS-ANTICIPATION                VALUE '6'.
   814           88  CP-E-AS-MEAN                        VALUE '8'.
   815           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
   816         16  FILLER                PIC X(12).
   817
   818***************    OUTPUT FROM ELPMNT   *************************
   819
   820         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
   821                                     COMP-3.
   822         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
   823                                     COMP-3.
   824         16  FILLER                PIC X(12).
   825
   826***************   MISC WORK AREAS    *****************************
   827         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
   828                                     COMP-3.
   829         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
   830                                     COMP-3.
   831         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
   832                                     COMP-3.
   833         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
   834                                     COMP-3.
   835         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
   836                                     COMP-3.
   837         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
   838                                     COMP-3.
   839         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
   840             88  OPEN-RATE-FILE                   VALUE 'O'.
   841             88  CLOSE-RATE-FILE                  VALUE 'C'.
   842             88  IO-ERROR                         VALUE 'E'.
   843
   844         16  CP-FIRST-PAY-DATE     PIC XX.
   845
   846         16  CP-JOINT-INDICATOR    PIC X.
   847
   848         16  CP-RESERVE-REMAINING-TERM
   849                                   PIC S9(4)V9    VALUE ZERO
   850                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* ELRTRM.cbl
   851
   852         16  CP-INSURED-BIRTH-DT   PIC XX.
   853
   854         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
   855                                     COMP-3.
   856
   857         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
   858                                     COMP-3.
   859
   860         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
   861                                     COMP-3.
   862
   863         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
   864                                     COMP-3.
   865
   866         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
   867                                     COMP-3.
   868
   869         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
   870                                     COMP-3.
   871
   872         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
   873                                     COMP-3.
   874
   875         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
   876             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
   877
   878         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
   879                                     COMP-3.
   880         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
   881                                     COMP-3.
   882         16  FILLER                PIC X(17).
   883******************************************************************
   884
   885****************************************************************
   886*
   887* Copyright (c) 2007 by Clerity Solutions, Inc.
   888* All rights reserved.
   889*
   890****************************************************************
   891 01  DFHEIV.
   892   02  DFHEIV0               PIC X(35).
   893   02  DFHEIV1               PIC X(08).
   894   02  DFHEIV2               PIC X(08).
   895   02  DFHEIV3               PIC X(08).
   896   02  DFHEIV4               PIC X(06).
   897   02  DFHEIV5               PIC X(04).
   898   02  DFHEIV6               PIC X(04).
   899   02  DFHEIV7               PIC X(02).
   900   02  DFHEIV8               PIC X(02).
   901   02  DFHEIV9               PIC X(01).
   902   02  DFHEIV10              PIC S9(7) COMP-3.
   903   02  DFHEIV11              PIC S9(4) COMP SYNC.
   904   02  DFHEIV12              PIC S9(4) COMP SYNC.
   905   02  DFHEIV13              PIC S9(4) COMP SYNC.
   906   02  DFHEIV14              PIC S9(4) COMP SYNC.
   907   02  DFHEIV15              PIC S9(4) COMP SYNC.
   908   02  DFHEIV16              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* ELRTRM.cbl
   909   02  DFHEIV17              PIC X(04).
   910   02  DFHEIV18              PIC X(04).
   911   02  DFHEIV19              PIC X(04).
   912   02  DFHEIV20              USAGE IS POINTER.
   913   02  DFHEIV21              USAGE IS POINTER.
   914   02  DFHEIV22              USAGE IS POINTER.
   915   02  DFHEIV23              USAGE IS POINTER.
   916   02  DFHEIV24              USAGE IS POINTER.
   917   02  DFHEIV25              PIC S9(9) COMP SYNC.
   918   02  DFHEIV26              PIC S9(9) COMP SYNC.
   919   02  DFHEIV27              PIC S9(9) COMP SYNC.
   920   02  DFHEIV28              PIC S9(9) COMP SYNC.
   921   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   922   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   923   02  FILLER                PIC X(02).
   924   02  DFHEIV99              PIC X(08) VALUE SPACE.
   925   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   926   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   927   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   928   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   929 LINKAGE  SECTION.
   930*****************************************************************
   931*                                                               *
   932* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   933* All rights reserved.                                          *
   934*                                                               *
   935*****************************************************************
   936 01  dfheiblk.
   937     02  eibtime          pic s9(7) comp-3.
   938     02  eibdate          pic s9(7) comp-3.
   939     02  eibtrnid         pic x(4).
   940     02  eibtaskn         pic s9(7) comp-3.
   941     02  eibtrmid         pic x(4).
   942     02  dfheigdi         pic s9(4) comp.
   943     02  eibcposn         pic s9(4) comp.
   944     02  eibcalen         pic s9(4) comp.
   945     02  eibaid           pic x(1).
   946     02  eibfiller1       pic x(1).
   947     02  eibfn            pic x(2).
   948     02  eibfiller2       pic x(2).
   949     02  eibrcode         pic x(6).
   950     02  eibfiller3       pic x(2).
   951     02  eibds            pic x(8).
   952     02  eibreqid         pic x(8).
   953     02  eibrsrce         pic x(8).
   954     02  eibsync          pic x(1).
   955     02  eibfree          pic x(1).
   956     02  eibrecv          pic x(1).
   957     02  eibsend          pic x(1).
   958     02  eibatt           pic x(1).
   959     02  eibeoc           pic x(1).
   960     02  eibfmh           pic x(1).
   961     02  eibcompl         pic x(1).
   962     02  eibsig           pic x(1).
   963     02  eibconf          pic x(1).
   964     02  eiberr           pic x(1).
   965     02  eibrldbk         pic x(1).
   966     02  eiberrcd         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* ELRTRM.cbl
   967     02  eibsynrb         pic x(1).
   968     02  eibnodat         pic x(1).
   969     02  eibfiller5       pic x(2).
   970     02  eibresp          pic 9(09) comp.
   971     02  eibresp2         pic 9(09) comp.
   972     02  dfheigdj         pic s9(4) comp.
   973     02  dfheigdk         pic s9(4) comp.
   974 01  DFHCOMMAREA              PIC X(450).
   975
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* ELRTRM.cbl
   977 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
   978 0000-DFHEXIT SECTION.
   979     MOVE '9#                    $   ' TO DFHEIV0.
   980     MOVE 'ELRTRM' TO DFHEIV1.
   981     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   982     MOVE DFHCOMMAREA            TO  CALCULATION-PASS-AREA.
   983
   984 000-RT-REMAINING-TERM-RTN.
   985*                    COPY ELCRTMPD.
   986******************************************************************
   987*                                                                *
   988*                                                                *
   989*                            ELCRTMPD                            *
   990*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   991*                            VMOD=2.012.                         *
   992*                                                                *
   993******************************************************************
   994
   995     MOVE SPACE                  TO EFFECTIVE-EOM
   996                                    VALUATION-EOM
   997                                    PAYMENT-EOM
   998                                    EXPIRATION-EOM
   999                                    TOP-EOM
  1000                                    BOTTOM-EOM.
  1001
  1002     MOVE ZERO                   TO CP-RETURN-CODE
  1003                                    CP-RETURN-CODE-2
  1004                                    CP-REMAINING-TERM-1
  1005                                    CP-REMAINING-TERM-2
  1006                                    CP-REMAINING-TERM-3
  1007                                    CP-ODD-DAYS.
  1008
  1009******************************************************************
  1010*   IF THE ORIGINAL TERM IS NOT VALID, THEN EXIT FROM THE        *
  1011*  ROUTINE INDICATING THAT THERE WAS AN ERROR DETECTED WITH      *
  1012*  THE TERM.                                                     *
  1013******************************************************************
  1014
  1015     IF CP-ORIGINAL-TERM NOT NUMERIC
  1016         MOVE ZERO               TO CP-ORIGINAL-TERM.
  1017
  1018     IF CP-ORIGINAL-TERM = ZERO
  1019         MOVE '4'                TO CP-RETURN-CODE
  1020         GO TO 9999-RT-REMAINING-TERM-XIT.
  1021
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* ELRTRM.cbl
  1023
  1024     IF CP-FIRST-PAY-DATE = SPACES  OR  LOW-VALUES
  1025         NEXT SENTENCE
  1026     ELSE
  1027         IF CP-FIRST-PAY-DATE NOT GREATER THAN CP-CERT-EFF-DT
  1028             MOVE LOW-VALUES     TO CP-FIRST-PAY-DATE.
  1029
  1030******************************************************************
  1031*   IF THE FIRST PAYMENT DATE IS NOT A VALID DATE, THEN          *
  1032*  CALCULATE A DEFAULT PAYMENT DATE I.E. ONE MONTH AFTER         *
  1033*  THE EFFECTIVE, AND CONTINUE PROCESSING.                       *
  1034******************************************************************
  1035
  1036     IF CP-FIRST-PAY-DATE = SPACES  OR  LOW-VALUES
  1037         MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1
  1038         MOVE +1                 TO DC-ELAPSED-MONTHS
  1039         MOVE ZEROS              TO DC-ELAPSED-DAYS
  1040         MOVE '6'                TO DC-OPTION-CODE
  1041         PERFORM 8000-DATE-CONVERT THRU 8000-EXIT
  1042         IF NO-CONVERSION-ERROR
  1043             MOVE DC-BIN-DATE-2  TO CP-FIRST-PAY-DATE
  1044         ELSE
  1045             MOVE '2'            TO CP-RETURN-CODE
  1046             GO TO 9999-RT-REMAINING-TERM-XIT.
  1047
  1048     MOVE CP-ORIGINAL-TERM       TO CP-REMAINING-TERM-1
  1049                                    CP-REMAINING-TERM-2
  1050                                    CP-REMAINING-TERM-3.
  1051
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* ELRTRM.cbl
  1053******************************************************************
  1054*   IF THE CERT EFFECTIVE DATE EQUAL TO THE CANCEL DATE,         *
  1055*  EXIT FROM THE ROUTINE WITH THE ORIGINAL TERM EQUAL TO THE     *
  1056*  REMAINING TERM - NO PREMIUM EARNED.                           *
  1057******************************************************************
  1058
  1059     IF CP-CERT-EFF-DT NOT LESS THAN CP-VALUATION-DT
  1060         GO TO 9999-RT-REMAINING-TERM-XIT.
  1061
  1062     IF VALID-REM-TRM-CALC-OPTION
  1063         NEXT SENTENCE
  1064     ELSE
  1065         GO TO 1000-CONTROL-CALCULATION.
  1066
  1067******************************************************************
  1068*  IF THE POLICY IS CANCELED DURING A "FREE-LOOK" PERIOD,        *
  1069*  EXIT FROM THE ROUTINE WITH THE ORGINAL TERM EQUAL TO THE      *
  1070*  REMAINING TERM - NO PREMIUM EARNED.                           *
  1071*  (ELASPED DAYS FROM EFFECTIVE DATE TO CANCEL DATE IS COMPARED  *
  1072*  TO FREE LOOK DAYS)                                            *
  1073******************************************************************
  1074
  1075     IF CP-FREE-LOOK NOT NUMERIC
  1076          MOVE ZERO               TO CP-FREE-LOOK.
  1077
  1078     IF CP-FREE-LOOK NOT = ZERO
  1079          MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1
  1080          MOVE CP-VALUATION-DT    TO DC-BIN-DATE-2
  1081          MOVE '1'                TO DC-OPTION-CODE
  1082          PERFORM 8000-DATE-CONVERT THRU 8000-EXIT
  1083          IF DATE-CONVERSION-ERROR
  1084            MOVE '2'                TO CP-RETURN-CODE
  1085            GO TO 9999-RT-REMAINING-TERM-XIT
  1086          ELSE
  1087             IF DC-ELAPSED-DAYS NOT GREATER THAN CP-FREE-LOOK
  1088                GO TO 9999-RT-REMAINING-TERM-XIT.
  1089
  1090******************************************************************
  1091*   INITIALIZE DATE FIELDS USED LATER TO CALCULATE ELAPSED TIME  *
  1092******************************************************************
  1093
  1094     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1095     MOVE ' '                    TO DC-OPTION-CODE.
  1096     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT
  1097     IF DATE-CONVERSION-ERROR
  1098         MOVE '2'                TO CP-RETURN-CODE
  1099         GO TO 9999-RT-REMAINING-TERM-XIT.
  1100
  1101     MOVE DC-GREG-DATE-CYMD      TO WS-SAVE-EFFECTIVE-DATE.
  1102     IF SAVE-EFF-DAYS EQUAL DC-DAYS-IN-MONTH
  1103         MOVE 'Y'                TO EFFECTIVE-EOM.
  1104
  1105     MOVE CP-VALUATION-DT        TO DC-BIN-DATE-1.
  1106     MOVE ' '                    TO DC-OPTION-CODE.
  1107     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT
  1108     IF DATE-CONVERSION-ERROR
  1109         MOVE '2'                TO CP-RETURN-CODE
  1110         GO TO 9999-RT-REMAINING-TERM-XIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* ELRTRM.cbl
  1111
  1112     MOVE DC-GREG-DATE-CYMD      TO WS-SAVE-VALUATION-DATE.
  1113     IF SAVE-VAL-DAYS EQUAL DC-DAYS-IN-MONTH
  1114         MOVE 'Y'                TO VALUATION-EOM.
  1115
  1116
  1117     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-1.
  1118     MOVE ' '                    TO DC-OPTION-CODE.
  1119     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT
  1120     IF DATE-CONVERSION-ERROR
  1121         MOVE '2'                TO CP-RETURN-CODE
  1122         GO TO 9999-RT-REMAINING-TERM-XIT.
  1123
  1124     MOVE DC-GREG-DATE-CYMD      TO WS-SAVE-PAYMENT-DATE.
  1125     IF SAVE-PAY-DAYS EQUAL DC-DAYS-IN-MONTH
  1126         MOVE 'Y'                TO PAYMENT-EOM.
  1127
  1128
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* ELRTRM.cbl
  1130****************************************************************
  1131*   THREE OPTIONS:                                             *
  1132*     1) CALCULATE TIME ELAPSED FROM PAYMENT DATE              *
  1133*       TO CANCEL DATE CONSIDERING EXTENSION DAYS              *
  1134*                                                              *
  1135*     2) CALCULATE TIME ELAPSED FROM EFFECTIVE DATE            *
  1136*       TO CANCEL DATE NOT CONSIDERING EXTENSION DAYS          *
  1137*                                                              *
  1138*     3) IF COMPANY ID IS 'NCL' AND ELASPED TIME METHOD IS     *
  1139*       '3' OR '4', CALCULATE REMAINING TIME AS                *
  1140*      (EXPIRATION DATE - CANCEL DATE = REMAINING TIME)        *
  1141*                                                              *
  1142*   IF THE CANCEL DATE IS LESS THAN THE 1ST PAYMENT DATE,      *
  1143*   OPTION 2 WILL BE USED (DOES NOT APPLY IF OPTION 3 IS TRUE) *
  1144****************************************************************
  1145
  1146 001-CONTROL-OPTIONS.
  1147
  1148     IF (CP-CONSIDER-EXTENSION)
  1149                 AND
  1150        ((CP-COMPANY-ID = 'NCL')
  1151          OR (CP-USE-EXP-AND-1ST-PMT))
  1152        GO TO 600-PROCESS-FOR-NCL
  1153     END-IF
  1154*    IF CP-CONSIDER-EXTENSION AND
  1155*       CP-COMPANY-ID = 'NCL'
  1156*        GO TO 600-PROCESS-FOR-NCL.
  1157
  1158     IF CP-VALUATION-DT LESS THAN CP-FIRST-PAY-DATE
  1159         GO TO 100-CANCELLED-BEFORE-PAYMENT.
  1160
  1161     IF CP-CONSIDER-EXTENSION
  1162         GO TO 200-PROCESS-WITH-1ST-PMT-DATE
  1163     ELSE
  1164         GO TO 300-PROCESS-WITH-CERT-EFF-DATE.
  1165
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* ELRTRM.cbl
  1167
  1168****************************************************************
  1169*                                                              *
  1170*   PROCESSING WHEN VALUATION DATE LESS THAN 1ST PAYMENT DATE  *
  1171*   OR WHEN REMAINING TERM OPTION '1' OR '2' IS CHOSEN.        *
  1172*                                                              *
  1173****************************************************************
  1174
  1175****************************************************************
  1176*                                                              *
  1177*   CALCULATE THE TIME ELAPSED BETWEEN THE CANCEL DATE AND     *
  1178*   THE CERT EFFECTIVE DATE.                                   *
  1179*                                                              *
  1180****************************************************************
  1181 100-CANCELLED-BEFORE-PAYMENT.
  1182
  1183     MOVE WS-SAVE-EFFECTIVE-DATE TO WS-BOTTOM-NUMBER.
  1184
  1185     MOVE WS-SAVE-VALUATION-DATE TO WS-TOP-NUMBER.
  1186     MOVE CP-VALUATION-DT        TO WS-SAVE-BINARY-DATE.
  1187     IF VALUATION-DATE-EOM AND EFFECTIVE-DATE-EOM
  1188         MOVE ZEROS              TO WS-TOP-DA
  1189                                    WS-BOTTOM-DA.
  1190
  1191     PERFORM 500-SIMPLE-ARITHMETIC THRU 500-EXIT.
  1192
  1193     IF CP-EARN-AFTER-15TH
  1194        GO TO 110-METHOD-1.
  1195     IF CP-EARN-ON-HALF-MONTH
  1196        GO TO 120-METHOD-2.
  1197     IF CP-EARN-ON-1ST-DAY
  1198        GO TO 130-METHOD-3.
  1199     IF CP-EARN-ON-FULL-MONTH
  1200        GO TO 140-METHOD-4.
  1201     IF CP-EARN-WITH-NO-DAYS
  1202        GO TO 150-METHOD-5.
  1203     IF CP-EARN-AFTER-14TH
  1204        GO TO 160-METHOD-6.
  1205     IF CP-EARN-AFTER-16TH
  1206        GO TO 170-METHOD-7.
  1207
  1208****************************************************************
  1209*                                                              *
  1210*   IF NONE OF THE ABOVE OPTIONS HAVE BEEN SPECIFIED, THEN     *
  1211*   INDICATE THERE WAS AN ERROR IN THE OPTION SELECTION AND    *
  1212*   EXIT FROM THE ROUTINE.                                     *
  1213*                                                              *
  1214****************************************************************
  1215     MOVE '3' TO CP-RETURN-CODE
  1216     GO TO 9999-RT-REMAINING-TERM-XIT.
  1217
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* ELRTRM.cbl
  1219****************************************************************
  1220*                                                              *
  1221*                       NUMBER OF DAYS                         *
  1222*         POLICY MUST BE INFORCE FOR 15 DAYS TO EARN A MONTH   *
  1223*                                                              *
  1224****************************************************************
  1225
  1226 110-METHOD-1.
  1227
  1228
  1229     IF WS-RESULT-DA     GREATER THAN +15  OR
  1230        TERM-IN-MONTHS    GREATER THAN +0
  1231         COMPUTE CP-REMAINING-TERM-1 =
  1232                             CP-REMAINING-TERM-1 - (+1).
  1233
  1234     GO TO 199-END-CERT-DATE-PROCESSING.
  1235
  1236****************************************************************
  1237*                                                              *
  1238*                       HALF MONTH ADJUSTMENT                  *
  1239*            PREMIUM EARNS ON 1/2 MONTH MORE ASSUMPTION        *
  1240*                                                              *
  1241****************************************************************
  1242
  1243 120-METHOD-2.
  1244
  1245     IF TERM-IN-MONTHS    GREATER THAN +0
  1246         COMPUTE CP-REMAINING-TERM-1 =
  1247                       CP-REMAINING-TERM-1 - (+1.5)
  1248     ELSE
  1249         COMPUTE CP-REMAINING-TERM-1 =
  1250                       CP-REMAINING-TERM-1 - (+.5).
  1251
  1252     IF CP-REMAINING-TERM-1 NEGATIVE
  1253         MOVE ZEROS                 TO CP-REMAINING-TERM-1.
  1254
  1255
  1256     GO TO 199-END-CERT-DATE-PROCESSING.
  1257
  1258
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* ELRTRM.cbl
  1260****************************************************************
  1261*                                                              *
  1262*                       FIRST DAY METHOD                       *
  1263*                  PREMIUM EARNS ON FIRST DAY                  *
  1264*                                                              *
  1265****************************************************************
  1266
  1267 130-METHOD-3.
  1268
  1269     IF WS-RESULT-DA     GREATER THAN +0  OR
  1270        TERM-IN-MONTHS    GREATER THAN +0
  1271         COMPUTE CP-REMAINING-TERM-1 =
  1272                             CP-REMAINING-TERM-1 - (+1).
  1273
  1274     GO TO 199-END-CERT-DATE-PROCESSING.
  1275
  1276****************************************************************
  1277*                                                              *
  1278*                       FULL MONTH METHOD                      *
  1279*          PREMIUM EARNS ON FULL MONTH - SAME AS BENEFIT       *
  1280*                                                              *
  1281****************************************************************
  1282
  1283 140-METHOD-4.
  1284
  1285
  1286*    WILL NOT REDUCE REMAINING TERM ON 'FULL' MONTH UNTIL
  1287*        PAST THE FIRST PAYMENT DATE.
  1288
  1289     GO TO 199-END-CERT-DATE-PROCESSING.
  1290
  1291
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* ELRTRM.cbl
  1293****************************************************************
  1294*                                                              *
  1295*                       FULL MONTH - NO DAYS                   *
  1296*          PREMIUM EARNS A FULL MONTH STARTING THE FIRST MONTH *
  1297*       (THIS METHOD WILL EARN WITHOUT A FLUCTUATION IN SHORT  *
  1298*        MONTHS )                                              *
  1299****************************************************************
  1300
  1301 150-METHOD-5.
  1302
  1303
  1304     COMPUTE CP-REMAINING-TERM-1 =
  1305                             CP-REMAINING-TERM-1 - (+1).
  1306
  1307     GO TO 199-END-CERT-DATE-PROCESSING.
  1308
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* ELRTRM.cbl
  1310****************************************************************
  1311*                                                              *
  1312*                       NUMBER OF DAYS                         *
  1313*         POLICY MUST BE INFORCE FOR 14 DAYS TO EARN A MONTH   *
  1314*                                                              *
  1315****************************************************************
  1316
  1317 160-METHOD-6.
  1318
  1319
  1320     IF WS-RESULT-DA     GREATER THAN +14  OR
  1321        TERM-IN-MONTHS    GREATER THAN +0
  1322         COMPUTE CP-REMAINING-TERM-1 =
  1323                             CP-REMAINING-TERM-1 - (+1).
  1324
  1325     GO TO 199-END-CERT-DATE-PROCESSING.
  1326
  1327****************************************************************
  1328*                                                              *
  1329*                       NUMBER OF DAYS                         *
  1330*         POLICY MUST BE INFORCE FOR 16 DAYS TO EARN A MONTH   *
  1331*                                                              *
  1332****************************************************************
  1333
  1334 170-METHOD-7.
  1335
  1336
  1337     IF WS-RESULT-DA     GREATER THAN +16  OR
  1338        TERM-IN-MONTHS    GREATER THAN +0
  1339         COMPUTE CP-REMAINING-TERM-1 =
  1340                             CP-REMAINING-TERM-1 - (+1).
  1341
  1342     GO TO 199-END-CERT-DATE-PROCESSING.
  1343
  1344
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* ELRTRM.cbl
  1346 199-END-CERT-DATE-PROCESSING.
  1347
  1348     IF CP-REMAINING-TERM-1 NEGATIVE
  1349        MOVE ZERO                TO CP-REMAINING-TERM-1
  1350                                    CP-REMAINING-TERM-2
  1351                                    CP-REMAINING-TERM-3
  1352        GO TO 9999-RT-REMAINING-TERM-XIT.
  1353
  1354     MOVE WS-RESULT-DA           TO CP-ODD-DAYS.
  1355
  1356     IF CP-EARN-AS-REG-BALLOON
  1357        IF CP-BALLOON-LAST-PMT
  1358           ADD +1 TO CP-REMAINING-TERM-3.
  1359
  1360     GO TO 9999-RT-REMAINING-TERM-XIT.
  1361
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* ELRTRM.cbl
  1363
  1364****************************************************************
  1365*                                                              *
  1366*  PROCESSING FOR VALUATION DATE ON OR AFTER 1ST PAYMENT DATE  *
  1367*  AND CONSIDERING EXTENSION DAYS.                             *
  1368*                                                              *
  1369****************************************************************
  1370
  1371 200-PROCESS-WITH-1ST-PMT-DATE.
  1372
  1373****************************************************************
  1374*                                                              *
  1375*  COMPUTE AN EXPIRATION DATE USING THE 1ST PAYMENT DATE  AND  *
  1376*  THE (REMAINING TERM - 1). IF THE VALUATION DATE IS GREATER  *
  1377*  THAN THIS ESTIMATED DATE, THEN THE TERM IS CONSIDERED TO    *
  1378*  BE FULLY EXPIRED.                                           *
  1379*                                                              *
  1380****************************************************************
  1381
  1382     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-1.
  1383
  1384     COMPUTE DC-ELAPSED-MONTHS EQUAL
  1385         (CP-ORIGINAL-TERM - +1).
  1386
  1387     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  1388     MOVE '6'                    TO DC-OPTION-CODE.
  1389     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT.
  1390
  1391     IF DATE-CONVERSION-ERROR
  1392        MOVE '2' TO CP-RETURN-CODE
  1393        GO TO 9999-RT-REMAINING-TERM-XIT
  1394     ELSE
  1395        IF DC-BIN-DATE-2 NOT GREATER CP-VALUATION-DT
  1396            MOVE ZEROS TO CP-REMAINING-TERM-1
  1397                          CP-REMAINING-TERM-2
  1398                          CP-REMAINING-TERM-3
  1399            GO TO 9999-RT-REMAINING-TERM-XIT.
  1400
  1401
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* ELRTRM.cbl
  1403****************************************************************
  1404*  REMAINING-TERM-2 REFLECTS THE NUMBER OF PAYMENTS THAT A     *
  1405*  INSURED HAS LEFT TO PAY. REQUARDLESS OF THE AMOUNT OF TIME  *
  1406*  THAT HAS ELAPSED FROM THE EFFECTIVE DATE TO THE FIRST       *
  1407*  PAYMENT DATE, ONLY ONE MONTH IS EARNED.  THE NUMBER OF      *
  1408*  PAYMENTS IS THEN EVALUATED FROM THE FIRST PAYMENT DATE TO   *
  1409*  THE VALUATION DATE.                                         *
  1410*                                                              *
  1411*  IF THE VALUATION DATE IS GREATER THAN THE 1ST PAYMENT       *
  1412*  DATE, ONE MONTH HAS BEEN EARNED FOR REMAINING TERM-2.       *
  1413*                                                              *
  1414*   NOTE : THE MAXIMUM MONTHS EARNED FORM THE EFFECTIVE DATE   *
  1415*     TO THE PAYMENT DATE IS 1.                                *
  1416*                                                              *
  1417****************************************************************
  1418
  1419     IF CP-VALUATION-DT NOT LESS THAN CP-FIRST-PAY-DATE
  1420         MOVE 1                  TO MONTHS-EARNED-2
  1421     ELSE
  1422         MOVE 0                  TO MONTHS-EARNED-2.
  1423
  1424     MOVE WS-SAVE-VALUATION-DATE TO WS-TOP-NUMBER.
  1425     MOVE CP-VALUATION-DT        TO WS-SAVE-BINARY-DATE.
  1426
  1427     MOVE WS-SAVE-PAYMENT-DATE   TO WS-BOTTOM-NUMBER.
  1428
  1429     PERFORM 500-SIMPLE-ARITHMETIC THRU 500-EXIT.
  1430
  1431     COMPUTE CP-REMAINING-TERM-2 = CP-ORIGINAL-TERM -
  1432                          (TERM-IN-MONTHS  + MONTHS-EARNED-2).
  1433
  1434     IF CP-REMAINING-TERM-2 NEGATIVE
  1435        MOVE 0                   TO CP-REMAINING-TERM-1
  1436                                    CP-REMAINING-TERM-2
  1437                                    CP-REMAINING-TERM-3
  1438                                    CP-ODD-DAYS
  1439        GO TO 9999-RT-REMAINING-TERM-XIT.
  1440
  1441     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM-3.
  1442
  1443     IF CP-EARN-AS-REG-BALLOON
  1444        IF CP-BALLOON-LAST-PMT
  1445           ADD +1 TO CP-REMAINING-TERM-3.
  1446
  1447     IF CP-EARN-ON-FULL-MONTH
  1448        MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM-1
  1449        MOVE 0                      TO CP-ODD-DAYS
  1450        GO TO 9999-RT-REMAINING-TERM-XIT.
  1451
  1452
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* ELRTRM.cbl
  1454****************************************************************
  1455*  REMAINING-TERM-1 IS USED FOR REFUNDS ETC.  THE TERM IS      *
  1456*  CALCULATED FROM THE FIRST PAYMENT DATE TO THE VALUATION     *
  1457*  DATE EARNING NO MORE THAN ONE MONTH FROM EFFECTIVE DATE TO  *
  1458*  1ST PAYMENT DATE.                                           *
  1459*                                                              *
  1460*  THE TIME ELAPSED FROM THE EFFECTIVE DATE AND THE FIRST      *
  1461*  PAYMENT DATE MUST BE 1 MONTH BEFORE IT IS CONSIDERED        *
  1462*  EARNED.                                                     *
  1463*                                                              *
  1464*   NOTE : THE MAXIMUM MONTHS EARNED FORM THE EFFECTIVE DATE   *
  1465*     TO THE PAYMENT DATE IS 1.                                *
  1466*                                                              *
  1467****************************************************************
  1468
  1469     MOVE WS-SAVE-PAYMENT-DATE   TO WS-TOP-NUMBER.
  1470     MOVE CP-FIRST-PAY-DATE      TO WS-SAVE-BINARY-DATE.
  1471
  1472     MOVE WS-SAVE-EFFECTIVE-DATE TO WS-BOTTOM-NUMBER.
  1473
  1474     IF PAYMENT-DATE-EOM AND EFFECTIVE-DATE-EOM
  1475         MOVE ZEROS              TO WS-TOP-DA
  1476                                    WS-BOTTOM-DA.
  1477
  1478     PERFORM 500-SIMPLE-ARITHMETIC THRU 500-EXIT.
  1479
  1480     MOVE ZERO                   TO MONTHS-EARNED-1.
  1481
  1482     IF TERM-IN-MONTHS  GREATER THAN +0
  1483         MOVE 1                    TO MONTHS-EARNED-1
  1484         MOVE WS-SAVE-PAYMENT-DATE TO WS-BOTTOM-NUMBER
  1485         GO TO 205-1ST-PAY-TO-VALUATION-DATE
  1486     ELSE
  1487         MOVE WS-SAVE-EFFECTIVE-DATE TO WS-BOTTOM-NUMBER
  1488         GO TO 205-1ST-PAY-TO-VALUATION-DATE.
  1489
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* ELRTRM.cbl
  1491****************************************************************
  1492*                                                              *
  1493*  COMPUTE THE ELAPSED TIME BETWEEN THE 1ST PAYMENT DATE       *
  1494*  AND THE VALUATION/CANCEL DATE.                              *
  1495*   THE REMAINING TERM THEN BECOMES :                          *
  1496*                                                              *
  1497*  ORIGINAL TERM - (CALCULATED ELAPSED MONTHS + MONTHS EARNED) *
  1498*                                                              *
  1499****************************************************************
  1500
  1501 205-1ST-PAY-TO-VALUATION-DATE.
  1502
  1503     MOVE WS-SAVE-VALUATION-DATE TO WS-TOP-NUMBER.
  1504     MOVE CP-VALUATION-DT        TO WS-SAVE-BINARY-DATE.
  1505
  1506     PERFORM 500-SIMPLE-ARITHMETIC THRU 500-EXIT.
  1507
  1508     MOVE WS-RESULT-DA           TO CP-ODD-DAYS.
  1509
  1510     COMPUTE CP-REMAINING-TERM-1 = CP-ORIGINAL-TERM -
  1511                          (TERM-IN-MONTHS  + MONTHS-EARNED-1).
  1512
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* ELRTRM.cbl
  1514****************************************************************
  1515* IF THIS TERM IS NEGATIVE, THE TERM IS CONSIDERED TO BE       *
  1516*  EXPIRED AND ALL PREMIUM IS EARNED.                          *
  1517****************************************************************
  1518     IF CP-REMAINING-TERM-1 NEGATIVE
  1519        MOVE ZERO                TO CP-REMAINING-TERM-1
  1520                                    CP-ODD-DAYS
  1521        GO TO 9999-RT-REMAINING-TERM-XIT.
  1522
  1523     IF CP-EARN-AFTER-15TH
  1524        GO TO 410-METHOD-1.
  1525     IF CP-EARN-ON-HALF-MONTH
  1526        GO TO 420-METHOD-2.
  1527     IF CP-EARN-ON-1ST-DAY
  1528        GO TO 430-METHOD-3.
  1529     IF CP-EARN-ON-FULL-MONTH
  1530        GO TO 440-METHOD-4.
  1531     IF CP-EARN-WITH-NO-DAYS
  1532        GO TO 450-METHOD-5.
  1533     IF CP-EARN-AFTER-14TH
  1534        GO TO 460-METHOD-6.
  1535     IF CP-EARN-AFTER-16TH
  1536        GO TO 470-METHOD-7.
  1537
  1538
  1539****************************************************************
  1540*                                                              *
  1541*   IF NONE OF THE ABOVE OPTIONS HAVE BEEN SPECIFIED, THEN     *
  1542*   INDICATE THERE WAS AN ERROR IN THE OPTION SELECTION AND    *
  1543*   EXIT FROM THE ROUTINE.                                     *
  1544*                                                              *
  1545****************************************************************
  1546
  1547     MOVE '3' TO CP-RETURN-CODE
  1548     GO TO 9999-RT-REMAINING-TERM-XIT.
  1549
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* ELRTRM.cbl
  1551****************************************************************
  1552*                                                              *
  1553*  PROCESSING FOR VALUATION DATE AFTER THE CERT-EFFECTIVE DATE *
  1554*  NOT CONSIDERING EXTENSION DAYS.                             *
  1555*                                                              *
  1556****************************************************************
  1557
  1558 300-PROCESS-WITH-CERT-EFF-DATE.
  1559
  1560****************************************************************
  1561*                                                              *
  1562*  COMPUTE AN EXPIRATION DATE USING THE CERTIFICATE EFFECTIVE  *
  1563*  DATE AND ORIGINAL TERM. IF THE CANCEL DATE IS GREATER THAN  *
  1564*  THIS ESTIMATED DATE, THEN THE TERM IS CONSIDERED TO BE FULLY*
  1565*  EXHAUSTED.                                                  *
  1566*                                                              *
  1567****************************************************************
  1568
  1569     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1570     MOVE CP-ORIGINAL-TERM       TO DC-ELAPSED-MONTHS.
  1571     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  1572     MOVE '6'                    TO DC-OPTION-CODE.
  1573     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT.
  1574
  1575     IF DATE-CONVERSION-ERROR
  1576        MOVE '2' TO CP-RETURN-CODE
  1577        GO TO 9999-RT-REMAINING-TERM-XIT
  1578     ELSE
  1579        IF DC-BIN-DATE-2 LESS THAN CP-VALUATION-DT
  1580            MOVE ZEROS TO CP-REMAINING-TERM-1
  1581                          CP-REMAINING-TERM-2
  1582                          CP-REMAINING-TERM-3
  1583            GO TO 9999-RT-REMAINING-TERM-XIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* ELRTRM.cbl
  1585****************************************************************
  1586*                                                              *
  1587*  COMPUTE THE ELAPSED TIME BETWEEN THE EFFECTIVE DATE         *
  1588*  AND THE CANCEL DATE.                                        *
  1589*                                                              *
  1590****************************************************************
  1591
  1592 305-EFF-TO-VALUATION-DATE.
  1593
  1594     MOVE WS-SAVE-VALUATION-DATE TO WS-TOP-NUMBER.
  1595     MOVE CP-VALUATION-DT        TO WS-SAVE-BINARY-DATE.
  1596
  1597     MOVE WS-SAVE-EFFECTIVE-DATE TO WS-BOTTOM-NUMBER.
  1598
  1599     IF VALUATION-DATE-EOM AND EFFECTIVE-DATE-EOM
  1600         MOVE ZEROS              TO WS-TOP-DA
  1601                                    WS-BOTTOM-DA.
  1602
  1603     PERFORM 500-SIMPLE-ARITHMETIC THRU 500-EXIT.
  1604
  1605     COMPUTE CP-REMAINING-TERM-1 = CP-ORIGINAL-TERM -
  1606                            TERM-IN-MONTHS.
  1607
  1608     MOVE WS-RESULT-DA           TO CP-ODD-DAYS.
  1609
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* ELRTRM.cbl
  1611****************************************************************
  1612* IF THIS TERM IS NEGATIVE, THE TERM IS CONSIDERED TO BE       *
  1613*  EXPIRED AND ALL PREMIUM IS EARNED.                          *
  1614****************************************************************
  1615     IF CP-REMAINING-TERM-1 NEGATIVE
  1616        MOVE ZERO                TO CP-REMAINING-TERM-1
  1617                                    CP-REMAINING-TERM-2
  1618                                    CP-REMAINING-TERM-3
  1619                                    CP-ODD-DAYS
  1620        GO TO 9999-RT-REMAINING-TERM-XIT.
  1621
  1622     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
  1623                                    CP-REMAINING-TERM-3.
  1624
  1625     IF CP-EARN-AS-REG-BALLOON
  1626        IF CP-BALLOON-LAST-PMT
  1627           ADD +1 TO CP-REMAINING-TERM-3.
  1628
  1629     IF CP-EARN-AFTER-15TH
  1630        GO TO 410-METHOD-1.
  1631     IF CP-EARN-ON-HALF-MONTH
  1632        GO TO 420-METHOD-2.
  1633     IF CP-EARN-ON-1ST-DAY
  1634        GO TO 430-METHOD-3.
  1635     IF CP-EARN-ON-FULL-MONTH
  1636        GO TO 440-METHOD-4.
  1637     IF CP-EARN-WITH-NO-DAYS
  1638        GO TO 450-METHOD-5.
  1639     IF CP-EARN-AFTER-14TH
  1640        GO TO 460-METHOD-6.
  1641     IF CP-EARN-AFTER-16TH
  1642        GO TO 470-METHOD-7.
  1643
  1644
  1645****************************************************************
  1646*                                                              *
  1647*   IF NONE OF THE ABOVE OPTIONS HAVE BEEN SPECIFIED, THEN     *
  1648*   INDICATE THERE WAS AN ERROR IN THE OPTION SELECTION AND    *
  1649*   EXIT FROM THE ROUTINE.                                     *
  1650*                                                              *
  1651****************************************************************
  1652
  1653     MOVE '3' TO CP-RETURN-CODE
  1654     GO TO 9999-RT-REMAINING-TERM-XIT.
  1655
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* ELRTRM.cbl
  1657****************************************************************
  1658*                                                              *
  1659*                       NUMBER OF DAYS                         *
  1660*         POLICY MUST BE INFORCE FOR 15 DAYS TO EARN A MONTH   *
  1661*                                                              *
  1662****************************************************************
  1663
  1664 410-METHOD-1.
  1665
  1666
  1667     IF WS-RESULT-DA     GREATER THAN +15
  1668         COMPUTE CP-REMAINING-TERM-1 =
  1669                             CP-REMAINING-TERM-1 - (+1).
  1670
  1671     GO TO 9999-RT-REMAINING-TERM-XIT.
  1672
  1673
  1674****************************************************************
  1675*                                                              *
  1676*                       HALF MONTH ADJUSTMENT                  *
  1677*            PREMIUM EARNS ON 1/2 MONTH MORE ASSUMPTION        *
  1678*                                                              *
  1679****************************************************************
  1680
  1681 420-METHOD-2.
  1682
  1683     IF CP-REMAINING-TERM-1 NOT = ZERO
  1684         COMPUTE CP-REMAINING-TERM-1 =
  1685                             CP-REMAINING-TERM-1 - (+.5).
  1686
  1687     GO TO 9999-RT-REMAINING-TERM-XIT.
  1688
  1689*     NO ADJUSTMENT TO CP-REMAINING-TERM-3 FOR DAYS - TYPE 2.
  1690
  1691
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* ELRTRM.cbl
  1693****************************************************************
  1694*                                                              *
  1695*                       FIRST DAY METHOD                       *
  1696*                  PREMIUM EARNS ON FIRST DAY                  *
  1697*                                                              *
  1698****************************************************************
  1699
  1700 430-METHOD-3.
  1701
  1702     IF WS-RESULT-DA     GREATER THAN +0
  1703         COMPUTE CP-REMAINING-TERM-1 =
  1704                             CP-REMAINING-TERM-1 - (+1).
  1705
  1706     GO TO 9999-RT-REMAINING-TERM-XIT.
  1707
  1708
  1709****************************************************************
  1710*                                                              *
  1711*                       FULL MONTH METHOD                      *
  1712*          PREMIUM EARNS ON FULL MONTH - SAME AS BENEFIT       *
  1713*                                                              *
  1714****************************************************************
  1715
  1716 440-METHOD-4.
  1717
  1718*  NO ADJUSTMENT FOR CP-REMAINING-TERM-1 - TYPE 4.
  1719
  1720
  1721     GO TO 9999-RT-REMAINING-TERM-XIT.
  1722
  1723
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* ELRTRM.cbl
  1725****************************************************************
  1726*                                                              *
  1727*                       FULL MONTH - NO DAYS                   *
  1728*          PREMIUM EARNS A FULL MONTH STARTING THE FIRST MONTH *
  1729*       (THIS METHOD WILL EARN WITHOUT A FLUCTUATION IN SHORT  *
  1730*        MONTHS )                                              *
  1731****************************************************************
  1732
  1733 450-METHOD-5.
  1734
  1735
  1736     IF CP-REMAINING-TERM-1 NOT = ZERO
  1737         COMPUTE CP-REMAINING-TERM-1 =
  1738                             CP-REMAINING-TERM-1 - (+1).
  1739
  1740     GO TO 9999-RT-REMAINING-TERM-XIT.
  1741
  1742****************************************************************
  1743*                                                              *
  1744*                       NUMBER OF DAYS                         *
  1745*         POLICY MUST BE INFORCE FOR 14 DAYS TO EARN A MONTH   *
  1746*                                                              *
  1747****************************************************************
  1748
  1749 460-METHOD-6.
  1750
  1751
  1752     IF WS-RESULT-DA     GREATER THAN +14
  1753         COMPUTE CP-REMAINING-TERM-1 =
  1754                             CP-REMAINING-TERM-1 - (+1).
  1755
  1756     GO TO 9999-RT-REMAINING-TERM-XIT.
  1757
  1758****************************************************************
  1759*                                                              *
  1760*                       NUMBER OF DAYS                         *
  1761*     POLICY MUST BE INFORCE FOR 16 DAYS TO EARN A MONTH       *
  1762*                                                              *
  1763****************************************************************
  1764
  1765 470-METHOD-7.
  1766
  1767
  1768     IF WS-RESULT-DA     GREATER THAN +16
  1769         COMPUTE CP-REMAINING-TERM-1 =
  1770                             CP-REMAINING-TERM-1 - (+1).
  1771
  1772     GO TO 9999-RT-REMAINING-TERM-XIT.
  1773
  1774****************************************************************
  1775*                                                              *
  1776*                                                              *
  1777*                                                              *
  1778*                                                              *
  1779*                                                              *
  1780****************************************************************
  1781
  1782 500-SIMPLE-ARITHMETIC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* ELRTRM.cbl
  1783
  1784 500-BORROW-IF-LESS.
  1785     IF WS-TOP-DA NOT LESS THAN WS-BOTTOM-DA
  1786        GO TO 500-CHECK-MONTH.
  1787
  1788* BORROW BASED ON 30 DAY MONTH
  1789
  1790     IF CP-30-DAY-MONTH
  1791         COMPUTE WS-TOP-DA = WS-TOP-DA + 30
  1792     ELSE
  1793         MOVE WS-SAVE-BINARY-DATE    TO DC-BIN-DATE-1
  1794         MOVE -1                     TO DC-ELAPSED-MONTHS
  1795         MOVE '1'                    TO DC-END-OF-MONTH
  1796         MOVE ZERO                   TO DC-ELAPSED-DAYS
  1797         MOVE '6'                    TO DC-OPTION-CODE
  1798         PERFORM 8000-DATE-CONVERT THRU 8000-EXIT
  1799         IF DATE-CONVERSION-ERROR
  1800             MOVE '2'                TO CP-RETURN-CODE
  1801             GO TO 500-EXIT
  1802         ELSE
  1803             COMPUTE WS-TOP-DA = WS-TOP-DA + DC-DAYS-IN-MONTH.
  1804
  1805     COMPUTE WS-TOP-MO = WS-TOP-MO - 1.
  1806
  1807     IF WS-TOP-MO EQUAL 0
  1808        COMPUTE WS-TOP-CCYR = WS-TOP-CCYR - 1
  1809        MOVE 12             TO WS-TOP-MO.
  1810
  1811 500-CHECK-MONTH.
  1812     IF WS-TOP-MO NOT LESS THAN WS-BOTTOM-MO
  1813        GO TO 500-SUBTRACT.
  1814
  1815     COMPUTE WS-TOP-CCYR = WS-TOP-CCYR - 1.
  1816
  1817     COMPUTE WS-TOP-MO = WS-TOP-MO + 12.
  1818
  1819 500-SUBTRACT.
  1820
  1821     COMPUTE WS-RESULT-CCYR = WS-TOP-CCYR - WS-BOTTOM-CCYR.
  1822
  1823     COMPUTE WS-RESULT-MO = WS-TOP-MO - WS-BOTTOM-MO.
  1824     IF WS-RESULT-CCYR GREATER THAN ZERO
  1825        COMPUTE TERM-IN-MONTHS = WS-RESULT-MO +
  1826                      (WS-RESULT-CCYR * 12)
  1827     ELSE
  1828        MOVE WS-RESULT-MO          TO TERM-IN-MONTHS.
  1829
  1830     COMPUTE WS-RESULT-DA = WS-TOP-DA - WS-BOTTOM-DA.
  1831
  1832*    IF CP-30-DAY-MONTH
  1833*       AND WS-RESULT-DA EQUAL 30
  1834*         COMPUTE WS-RESULT-MO = WS-RESULT-MO + 1
  1835*         MOVE 0                   TO WS-RESULT-DA.
  1836
  1837
  1838 500-EXIT.
  1839     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* ELRTRM.cbl
  1841****************************************************************
  1842 600-PROCESS-FOR-NCL.
  1843****************************************************************
  1844*                                                              *
  1845*  COMPUTE AN EXPIRATION DATE USING THE 1ST PAYMENT DATE  AND  *
  1846*  THE (REMAINING TERM - 1). IF THE VALUATION DATE IS GREATER  *
  1847*  THAN THIS ESTIMATED DATE, THEN THE TERM IS CONSIDERED TO    *
  1848*  BE FULLY EXPIRED.                                           *
  1849*                                                              *
  1850****************************************************************
  1851
  1852     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-1.
  1853
  1854     COMPUTE DC-ELAPSED-MONTHS EQUAL
  1855         (CP-ORIGINAL-TERM - +1).
  1856
  1857     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  1858     MOVE '6'                    TO DC-OPTION-CODE.
  1859     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT.
  1860
  1861     IF DATE-CONVERSION-ERROR
  1862        MOVE '2' TO CP-RETURN-CODE
  1863        GO TO 9999-RT-REMAINING-TERM-XIT
  1864     ELSE
  1865        IF DC-BIN-DATE-2 NOT GREATER CP-VALUATION-DT
  1866            MOVE ZEROS TO CP-REMAINING-TERM-1
  1867                          CP-REMAINING-TERM-2
  1868                          CP-REMAINING-TERM-3
  1869            GO TO 9999-RT-REMAINING-TERM-XIT.
  1870
  1871     MOVE DC-BIN-DATE-2          TO WS-SAVE-BINARY-DATE.
  1872     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
  1873     MOVE ' '                    TO DC-OPTION-CODE.
  1874     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT
  1875     IF DATE-CONVERSION-ERROR
  1876         MOVE '2'                TO CP-RETURN-CODE
  1877         GO TO 9999-RT-REMAINING-TERM-XIT.
  1878
  1879     MOVE DC-GREG-DATE-CYMD      TO WS-SAVE-EXPIRATION-DATE.
  1880     IF SAVE-EXP-DAYS EQUAL DC-DAYS-IN-MONTH
  1881         MOVE 'Y'                TO EXPIRATION-EOM.
  1882****************************************************************
  1883*                                                              *
  1884*  COMPUTE THE ELAPSED TIME BETWEEN THE CANCEL DATE AND        *
  1885*  EXPIRATION (MATURITY DATE). THIS WILL BE THE REMAINING      *
  1886*  TERM.                                                       *
  1887****************************************************************
  1888
  1889     MOVE WS-SAVE-EXPIRATION-DATE TO WS-TOP-NUMBER.
  1890     MOVE DC-BIN-DATE-2          TO WS-SAVE-BINARY-DATE.
  1891
  1892     MOVE WS-SAVE-VALUATION-DATE TO WS-BOTTOM-NUMBER.
  1893
  1894     IF VALUATION-DATE-EOM AND EXPIRATION-DATE-EOM
  1895         MOVE ZEROS              TO WS-TOP-DA
  1896                                    WS-BOTTOM-DA.
  1897
  1898     PERFORM 500-SIMPLE-ARITHMETIC THRU 500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* ELRTRM.cbl
  1899
  1900     MOVE TERM-IN-MONTHS         TO CP-REMAINING-TERM-1
  1901
  1902     MOVE WS-RESULT-DA           TO CP-ODD-DAYS.
  1903
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* ELRTRM.cbl
  1905****************************************************************
  1906* IF THIS TERM IS NEGATIVE, THE TERM IS CONSIDERED TO BE       *
  1907*  EXPIRED AND ALL PREMIUM IS EARNED.                          *
  1908****************************************************************
  1909     IF CP-REMAINING-TERM-1 NEGATIVE
  1910        MOVE ZERO                TO CP-REMAINING-TERM-1
  1911                                    CP-REMAINING-TERM-2
  1912                                    CP-REMAINING-TERM-3
  1913                                    CP-ODD-DAYS
  1914        GO TO 9999-RT-REMAINING-TERM-XIT.
  1915
  1916     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
  1917                                    CP-REMAINING-TERM-3.
  1918
  1919     IF CP-ODD-DAYS GREATER THAN ZERO
  1920        ADD +1                   TO CP-REMAINING-TERM-2
  1921        ADD +1                   TO CP-REMAINING-TERM-3.
  1922
  1923     IF CP-EARN-AS-REG-BALLOON
  1924        IF CP-BALLOON-LAST-PMT
  1925           ADD +1 TO CP-REMAINING-TERM-3.
  1926
  1927     IF CP-EARN-AFTER-15TH
  1928        GO TO 610-METHOD-1.
  1929     IF CP-EARN-ON-HALF-MONTH
  1930        GO TO 620-METHOD-2.
  1931     IF CP-EARN-ON-1ST-DAY
  1932        GO TO 630-METHOD-3.
  1933     IF CP-EARN-ON-FULL-MONTH
  1934        GO TO 640-METHOD-4.
  1935     IF CP-EARN-WITH-NO-DAYS
  1936        GO TO 650-METHOD-5.
  1937     IF CP-EARN-AFTER-14TH
  1938        GO TO 660-METHOD-6.
  1939     IF CP-EARN-AFTER-16TH
  1940        GO TO 670-METHOD-7.
  1941****************************************************************
  1942*                                                              *
  1943*   IF NONE OF THE ABOVE OPTIONS HAVE BEEN SPECIFIED, THEN     *
  1944*   INDICATE THERE WAS AN ERROR IN THE OPTION SELECTION AND    *
  1945*   EXIT FROM THE ROUTINE.                                     *
  1946*                                                              *
  1947****************************************************************
  1948
  1949
  1950     MOVE '3' TO CP-RETURN-CODE
  1951     GO TO 9999-RT-REMAINING-TERM-XIT.
  1952
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* ELRTRM.cbl
  1954
  1955****************************************************************
  1956*                                                              *
  1957*                       NUMBER OF DAYS                         *
  1958*         POLICY MUST BE INFORCE FOR 15 DAYS TO EARN A MONTH   *
  1959*                                                              *
  1960****************************************************************
  1961
  1962 610-METHOD-1.
  1963
  1964     IF WS-RESULT-DA     GREATER THAN +14
  1965         COMPUTE CP-REMAINING-TERM-1 =
  1966                             CP-REMAINING-TERM-1 + (+1).
  1967
  1968     GO TO 680-END-NCL-PROCESSING.
  1969
  1970
  1971****************************************************************
  1972*                                                              *
  1973*                       HALF MONTH ADJUSTMENT                  *
  1974*            PREMIUM EARNS ON 1/2 MONTH MORE ASSUMPTION        *
  1975*                                                              *
  1976****************************************************************
  1977
  1978 620-METHOD-2.
  1979
  1980     COMPUTE CP-REMAINING-TERM-1 =
  1981                             CP-REMAINING-TERM-1 + (+.5).
  1982
  1983     GO TO 680-END-NCL-PROCESSING.
  1984
  1985
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* ELRTRM.cbl
  1987****************************************************************
  1988*                                                              *
  1989*                       FIRST DAY METHOD                       *
  1990*                  PREMIUM EARNS ON FIRST DAY                  *
  1991*                                                              *
  1992****************************************************************
  1993
  1994 630-METHOD-3.
  1995
  1996*  NO ADJUSTMENT FOR CP-REMAINING-TERM-1 - TYPE 3 FOR NCL.
  1997
  1998     GO TO 680-END-NCL-PROCESSING.
  1999
  2000
  2001****************************************************************
  2002*                                                              *
  2003*                       FULL MONTH METHOD                      *
  2004*          PREMIUM EARNS ON FULL MONTH - SAME AS BENEFIT       *
  2005*                                                              *
  2006****************************************************************
  2007
  2008 640-METHOD-4.
  2009
  2010     MOVE CP-REMAINING-TERM-2       TO CP-REMAINING-TERM-1.
  2011     MOVE 0                         TO CP-ODD-DAYS.
  2012
  2013     GO TO 680-END-NCL-PROCESSING.
  2014
  2015
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* ELRTRM.cbl
  2017****************************************************************
  2018*                                                              *
  2019*                       FULL MONTH - NO DAYS                   *
  2020*          PREMIUM EARNS A FULL MONTH STARTING THE FIRST MONTH *
  2021*       (THIS METHOD WILL EARN WITHOUT A FLUCTUATION IN SHORT  *
  2022*        MONTHS )                                              *
  2023****************************************************************
  2024
  2025 650-METHOD-5.
  2026
  2027
  2028*  NO ADJUSTMENT FOR CP-REMAINING-TERM-1 - TYPE 5 FOR NCL.
  2029
  2030     GO TO 680-END-NCL-PROCESSING.
  2031
  2032
  2033****************************************************************
  2034*                                                              *
  2035*                       NUMBER OF DAYS                         *
  2036*         POLICY MUST BE INFORCE FOR 14 DAYS TO EARN A MONTH   *
  2037*                                                              *
  2038****************************************************************
  2039
  2040 660-METHOD-6.
  2041
  2042
  2043     IF WS-RESULT-DA     GREATER THAN +13
  2044         COMPUTE CP-REMAINING-TERM-1 =
  2045                             CP-REMAINING-TERM-1 + (+1).
  2046
  2047     GO TO 680-END-NCL-PROCESSING.
  2048
  2049
  2050****************************************************************
  2051*                                                              *
  2052*                       NUMBER OF DAYS                         *
  2053*     POLICY MUST BE INFORCE FOR 16 DAYS TO EARN A MONTH       *
  2054*                                                              *
  2055****************************************************************
  2056
  2057 670-METHOD-7.
  2058
  2059     IF WS-RESULT-DA     GREATER THAN +15
  2060         COMPUTE CP-REMAINING-TERM-1 =
  2061                             CP-REMAINING-TERM-1 + (+1).
  2062
  2063     GO TO 680-END-NCL-PROCESSING.
  2064
  2065
  2066 680-END-NCL-PROCESSING.
  2067
  2068     IF CP-REMAINING-TERM-1 > CP-ORIGINAL-TERM
  2069        MOVE CP-ORIGINAL-TERM    TO CP-REMAINING-TERM-1
  2070                                    CP-REMAINING-TERM-2
  2071                                    CP-REMAINING-TERM-3
  2072        MOVE ZEROS               TO CP-ODD-DAYS.
  2073
  2074     GO TO 9999-RT-REMAINING-TERM-XIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* ELRTRM.cbl
  2075
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* ELRTRM.cbl
  2077
  2078 1000-CONTROL-CALCULATION.
  2079
  2080     IF CP-VALUATION-DT NOT LESS THAN CP-FIRST-PAY-DATE
  2081         GO TO 2000-PROCESS-WITH-1ST-PMT-DATE.
  2082
  2083
  2084****************************************************************
  2085*                                                              *
  2086*  ORIGINAL                                                    *
  2087*   PROCESSING WHEN VALUATION DATE LESS THAN 1ST PAYMENT DATE  *
  2088*                                                              *
  2089****************************************************************
  2090
  2091
  2092 1000-PROCESS-WITH-CERT-EFF-DT.
  2093
  2094     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  2095     MOVE CP-VALUATION-DT        TO DC-BIN-DATE-2.
  2096     MOVE '1'                    TO DC-OPTION-CODE.
  2097     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT
  2098     IF DATE-CONVERSION-ERROR
  2099         MOVE '2'                TO CP-RETURN-CODE
  2100         GO TO 9999-RT-REMAINING-TERM-XIT.
  2101
  2102     IF CP-EARN-AFTER-15TH
  2103        GO TO 1110-METHOD-1.
  2104     IF CP-EARN-ON-HALF-MONTH
  2105        GO TO 1200-METHOD-2.
  2106     IF CP-EARN-ON-1ST-DAY
  2107        GO TO 1300-METHOD-3.
  2108     IF CP-EARN-ON-FULL-MONTH
  2109        GO TO 1400-METHOD-4.
  2110     IF CP-EARN-WITH-NO-DAYS
  2111        GO TO 1500-METHOD-5.
  2112
  2113     IF CP-EARN-AFTER-14TH
  2114        GO TO 1600-METHOD-6.
  2115     IF CP-EARN-AFTER-16TH
  2116        GO TO 1700-METHOD-7.
  2117
  2118     MOVE '3' TO CP-RETURN-CODE
  2119     GO TO 9999-RT-REMAINING-TERM-XIT.
  2120
  2121 1110-METHOD-1.
  2122
  2123****************************************************************
  2124*                                                              *
  2125*  ORIGINAL                                                    *
  2126*                       NUMBER OF DAYS                         *
  2127*         POLICY MUST BE INFORCE FOR 15 DAYS TO EARN A MONTH   *
  2128*                                                              *
  2129****************************************************************
  2130
  2131
  2132     IF DC-ODD-DAYS-OVER GREATER THAN +15  OR
  2133        DC-ELAPSED-MONTHS GREATER THAN +0
  2134         COMPUTE CP-REMAINING-TERM-1 =
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* ELRTRM.cbl
  2135                             CP-REMAINING-TERM-1 - (+1).
  2136
  2137
  2138     GO TO 1999-END-CERT-DATE-PROCESSING.
  2139
  2140 1200-METHOD-2.
  2141
  2142****************************************************************
  2143*                                                              *
  2144*  ORIGINAL                                                    *
  2145*                       HALF MONTH ADJUSTMENT                  *
  2146*            PREMIUM EARNS ON 1/2 MONTH MORE ASSUMPTION        *
  2147*                                                              *
  2148****************************************************************
  2149
  2150     IF DC-ELAPSED-MONTHS GREATER THAN +0
  2151         COMPUTE CP-REMAINING-TERM-1 =
  2152                       CP-REMAINING-TERM-1 - (+1.5)
  2153     ELSE
  2154         COMPUTE CP-REMAINING-TERM-1 =
  2155                       CP-REMAINING-TERM-1 - (+.5).
  2156
  2157     IF CP-REMAINING-TERM-1 NEGATIVE
  2158         MOVE ZEROS                 TO CP-REMAINING-TERM-1.
  2159
  2160
  2161     GO TO 1999-END-CERT-DATE-PROCESSING.
  2162
  2163
  2164 1300-METHOD-3.
  2165
  2166****************************************************************
  2167*                                                              *
  2168*  ORIGINAL                                                    *
  2169*                       FIRST DAY METHOD                       *
  2170*                  PREMIUM EARNS ON FIRST DAY                  *
  2171*                                                              *
  2172****************************************************************
  2173
  2174     IF DC-ODD-DAYS-OVER GREATER THAN +0  OR
  2175        DC-ELAPSED-MONTHS GREATER THAN +0
  2176         COMPUTE CP-REMAINING-TERM-1 =
  2177                             CP-REMAINING-TERM-1 - (+1).
  2178
  2179     GO TO 1999-END-CERT-DATE-PROCESSING.
  2180
  2181 1400-METHOD-4.
  2182
  2183****************************************************************
  2184*                                                              *
  2185*  ORIGINAL                                                    *
  2186*                       FULL MONTH METHOD                      *
  2187*          PREMIUM EARNS ON FULL MONTH - SAME AS BENEFIT       *
  2188*                                                              *
  2189****************************************************************
  2190
  2191
  2192*    WILL NOT REDUCE REMAINING TERM ON 'FULL' MONTH UNTIL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* ELRTRM.cbl
  2193*        PAST THE FIRST PAYMENT DATE.
  2194
  2195     GO TO 1999-END-CERT-DATE-PROCESSING.
  2196
  2197
  2198 1500-METHOD-5.
  2199
  2200****************************************************************
  2201*                                                              *
  2202*  ORIGINAL                                                    *
  2203*                       FULL MONTH - NO DAYS                   *
  2204*          PREMIUM EARNS A FULL MONTH STARTING THE FIRST MONTH *
  2205*       (THIS METHOD WILL EARN WITHOUT A FLUCTUATION IN SHORT  *
  2206*        MONTHS )                                              *
  2207****************************************************************
  2208
  2209
  2210     COMPUTE CP-REMAINING-TERM-1 =
  2211                             CP-REMAINING-TERM-1 - (+1).
  2212
  2213     GO TO 1999-END-CERT-DATE-PROCESSING.
  2214
  2215 1600-METHOD-6.
  2216
  2217****************************************************************
  2218*                                                              *
  2219*  ORIGINAL                                                    *
  2220*                       NUMBER OF DAYS                         *
  2221*         POLICY MUST BE INFORCE FOR 14 DAYS TO EARN A MONTH   *
  2222*                                                              *
  2223****************************************************************
  2224
  2225
  2226     IF DC-ODD-DAYS-OVER GREATER THAN +14  OR
  2227        DC-ELAPSED-MONTHS GREATER THAN +0
  2228         COMPUTE CP-REMAINING-TERM-1 =
  2229                             CP-REMAINING-TERM-1 - (+1).
  2230
  2231
  2232     GO TO 1999-END-CERT-DATE-PROCESSING.
  2233
  2234 1700-METHOD-7.
  2235
  2236****************************************************************
  2237*                                                              *
  2238*  ORIGINAL                                                    *
  2239*                       NUMBER OF DAYS                         *
  2240*         POLICY MUST BE INFORCE FOR 16 DAYS TO EARN A MONTH   *
  2241*                                                              *
  2242****************************************************************
  2243
  2244
  2245     IF DC-ODD-DAYS-OVER GREATER THAN +16  OR
  2246        DC-ELAPSED-MONTHS GREATER THAN +0
  2247         COMPUTE CP-REMAINING-TERM-1 =
  2248                             CP-REMAINING-TERM-1 - (+1).
  2249
  2250
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* ELRTRM.cbl
  2251     GO TO 1999-END-CERT-DATE-PROCESSING.
  2252
  2253
  2254
  2255 1999-END-CERT-DATE-PROCESSING.
  2256
  2257     IF CP-REMAINING-TERM-1 NEGATIVE
  2258        MOVE ZERO                TO CP-REMAINING-TERM-1
  2259                                    CP-REMAINING-TERM-2
  2260                                    CP-REMAINING-TERM-3
  2261        GO TO 9999-RT-REMAINING-TERM-XIT.
  2262
  2263     MOVE DC-ODD-DAYS-OVER       TO CP-ODD-DAYS.
  2264
  2265     IF CP-EARN-AS-REG-BALLOON
  2266        IF CP-BALLOON-LAST-PMT
  2267           ADD +1 TO CP-REMAINING-TERM-3.
  2268
  2269     GO TO 9999-RT-REMAINING-TERM-XIT.
  2270
  2271
  2272****************************************************************
  2273*                                                              *
  2274*  ORIGINAL                                                    *
  2275*  PROCESSING FOR VALUATION DATE ON OR AFTER 1ST PAYMENT DATE  *
  2276*                                                              *
  2277****************************************************************
  2278
  2279
  2280 2000-PROCESS-WITH-1ST-PMT-DATE.
  2281
  2282     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-1
  2283     COMPUTE DC-ELAPSED-MONTHS EQUAL
  2284         (CP-ORIGINAL-TERM - +1)
  2285     MOVE ZEROS                  TO DC-ELAPSED-DAYS
  2286     MOVE '6'                    TO DC-OPTION-CODE
  2287     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT
  2288
  2289     IF DATE-CONVERSION-ERROR
  2290        MOVE '2' TO CP-RETURN-CODE
  2291        GO TO 9999-RT-REMAINING-TERM-XIT
  2292     ELSE
  2293     IF DC-BIN-DATE-2 LESS THAN CP-VALUATION-DT
  2294        MOVE ZEROS TO CP-REMAINING-TERM-1
  2295                      CP-REMAINING-TERM-2
  2296                      CP-REMAINING-TERM-3
  2297        GO TO 9999-RT-REMAINING-TERM-XIT.
  2298
  2299     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  2300     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.
  2301     MOVE '1'                    TO DC-OPTION-CODE.
  2302     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT.
  2303     IF DATE-CONVERSION-ERROR
  2304         MOVE '2' TO CP-RETURN-CODE
  2305         GO TO 9999-RT-REMAINING-TERM-XIT.
  2306
  2307     MOVE ZERO                   TO MONTHS-EARNED.
  2308
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* ELRTRM.cbl
  2309     IF DC-ELAPSED-MONTHS GREATER THAN +0  OR
  2310        CP-EARN-WITH-NO-DAYS OR
  2311        CP-EARN-ON-FULL-MONTH
  2312         MOVE 1                  TO MONTHS-EARNED
  2313         GO TO 2050-1ST-PAY-TO-VALUATION-DATE.
  2314
  2315     IF CP-EARN-ON-1ST-DAY
  2316         IF DC-ODD-DAYS-OVER GREATER THAN +0
  2317             MOVE 1              TO MONTHS-EARNED
  2318             GO TO 2050-1ST-PAY-TO-VALUATION-DATE.
  2319
  2320     IF CP-EARN-AFTER-15TH
  2321         IF DC-ODD-DAYS-OVER GREATER THAN +15
  2322             MOVE 1              TO MONTHS-EARNED
  2323             GO TO 2050-1ST-PAY-TO-VALUATION-DATE.
  2324
  2325     IF CP-EARN-AFTER-14TH
  2326         IF DC-ODD-DAYS-OVER GREATER THAN +14
  2327             MOVE 1              TO MONTHS-EARNED
  2328             GO TO 2050-1ST-PAY-TO-VALUATION-DATE.
  2329
  2330     IF CP-EARN-AFTER-16TH
  2331         IF DC-ODD-DAYS-OVER GREATER THAN +16
  2332             MOVE 1              TO MONTHS-EARNED.
  2333
  2334 2050-1ST-PAY-TO-VALUATION-DATE.
  2335
  2336     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-1.
  2337     MOVE CP-VALUATION-DT        TO DC-BIN-DATE-2.
  2338     MOVE '1'                    TO DC-OPTION-CODE.
  2339     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT.
  2340     IF DATE-CONVERSION-ERROR
  2341         MOVE '2' TO CP-RETURN-CODE
  2342         GO TO 9999-RT-REMAINING-TERM-XIT.
  2343
  2344     COMPUTE CP-REMAINING-TERM-1 = CP-ORIGINAL-TERM -
  2345                              (DC-ELAPSED-MONTHS + MONTHS-EARNED).
  2346
  2347     MOVE DC-ODD-DAYS-OVER       TO CP-ODD-DAYS.
  2348
  2349     IF CP-REMAINING-TERM-1 NEGATIVE
  2350        MOVE ZERO                TO CP-REMAINING-TERM-1
  2351                                    CP-REMAINING-TERM-2
  2352                                    CP-REMAINING-TERM-3
  2353                                    CP-ODD-DAYS
  2354        GO TO 9999-RT-REMAINING-TERM-XIT.
  2355
  2356     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
  2357                                    CP-REMAINING-TERM-3.
  2358
  2359     IF CP-EARN-AS-REG-BALLOON
  2360        IF CP-BALLOON-LAST-PMT
  2361           ADD +1 TO CP-REMAINING-TERM-3.
  2362
  2363     IF CP-EARN-AFTER-15TH
  2364        GO TO 2100-METHOD-1.
  2365     IF CP-EARN-ON-HALF-MONTH
  2366        GO TO 2200-METHOD-2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* ELRTRM.cbl
  2367     IF CP-EARN-ON-1ST-DAY
  2368        GO TO 2300-METHOD-3.
  2369     IF CP-EARN-ON-FULL-MONTH
  2370        GO TO 2400-METHOD-4.
  2371     IF CP-EARN-WITH-NO-DAYS
  2372        GO TO 2500-METHOD-5.
  2373
  2374     IF CP-EARN-AFTER-14TH
  2375        GO TO 2600-METHOD-6.
  2376     IF CP-EARN-AFTER-16TH
  2377        GO TO 2700-METHOD-7.
  2378
  2379     MOVE '3' TO CP-RETURN-CODE
  2380     GO TO 9999-RT-REMAINING-TERM-XIT.
  2381
  2382 2100-METHOD-1.
  2383
  2384****************************************************************
  2385*  ORIGINAL                                                    *
  2386*                                                              *
  2387*                       NUMBER OF DAYS                         *
  2388*         POLICY MUST BE INFORCE FOR 15 DAYS TO EARN A MONTH   *
  2389*                                                              *
  2390****************************************************************
  2391
  2392
  2393     IF DC-ODD-DAYS-OVER GREATER THAN +15
  2394         COMPUTE CP-REMAINING-TERM-1 =
  2395                             CP-REMAINING-TERM-1 - (+1).
  2396
  2397     GO TO 9999-RT-REMAINING-TERM-XIT.
  2398
  2399
  2400 2200-METHOD-2.
  2401
  2402****************************************************************
  2403*                                                              *
  2404*  ORIGINAL                                                    *
  2405*                       HALF MONTH ADJUSTMENT                  *
  2406*            PREMIUM EARNS ON 1/2 MONTH MORE ASSUMPTION        *
  2407*                                                              *
  2408****************************************************************
  2409
  2410     IF CP-REMAINING-TERM-1 NOT = ZERO
  2411         COMPUTE CP-REMAINING-TERM-1 =
  2412                             CP-REMAINING-TERM-1 - (+.5).
  2413
  2414     GO TO 9999-RT-REMAINING-TERM-XIT.
  2415
  2416*     NO ADJUSTMENT TO CP-REMAINING-TERM-3 FOR DAYS - TYPE 2.
  2417
  2418
  2419 2300-METHOD-3.
  2420
  2421****************************************************************
  2422*                                                              *
  2423*  ORIGINAL                                                    *
  2424*                       FIRST DAY METHOD                       *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* ELRTRM.cbl
  2425*                  PREMIUM EARNS ON FIRST DAY                  *
  2426*                                                              *
  2427****************************************************************
  2428
  2429     IF DC-ODD-DAYS-OVER GREATER THAN +0
  2430         COMPUTE CP-REMAINING-TERM-1 =
  2431                             CP-REMAINING-TERM-1 - (+1).
  2432
  2433     GO TO 9999-RT-REMAINING-TERM-XIT.
  2434
  2435
  2436 2400-METHOD-4.
  2437
  2438****************************************************************
  2439*                                                              *
  2440*  ORIGINAL                                                    *
  2441*                       FULL MONTH METHOD                      *
  2442*          PREMIUM EARNS ON FULL MONTH - SAME AS BENEFIT       *
  2443*                                                              *
  2444****************************************************************
  2445
  2446*  NO ADJUSTMENT FOR CP-REMAINING-TERM-1 - TYPE 4.
  2447
  2448
  2449     GO TO 9999-RT-REMAINING-TERM-XIT.
  2450
  2451
  2452 2500-METHOD-5.
  2453
  2454****************************************************************
  2455*                                                              *
  2456*  ORIGINAL                                                    *
  2457*                       FULL MONTH - NO DAYS                   *
  2458*          PREMIUM EARNS A FULL MONTH STARTING THE FIRST MONTH *
  2459*       (THIS METHOD WILL EARN WITHOUT A FLUCTUATION IN SHORT  *
  2460*        MONTHS )                                              *
  2461****************************************************************
  2462
  2463
  2464     IF CP-REMAINING-TERM-1 NOT = ZERO
  2465         COMPUTE CP-REMAINING-TERM-1 =
  2466                             CP-REMAINING-TERM-1 - (+1).
  2467
  2468     GO TO 9999-RT-REMAINING-TERM-XIT.
  2469
  2470 2600-METHOD-6.
  2471
  2472****************************************************************
  2473*  ORIGINAL                                                    *
  2474*                                                              *
  2475*                       NUMBER OF DAYS                         *
  2476*         POLICY MUST BE INFORCE FOR 14 DAYS TO EARN A MONTH   *
  2477*                                                              *
  2478****************************************************************
  2479
  2480
  2481     IF DC-ODD-DAYS-OVER GREATER THAN +14
  2482         COMPUTE CP-REMAINING-TERM-1 =
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* ELRTRM.cbl
  2483                             CP-REMAINING-TERM-1 - (+1).
  2484
  2485     GO TO 9999-RT-REMAINING-TERM-XIT.
  2486
  2487 2700-METHOD-7.
  2488
  2489****************************************************************
  2490*  ORIGINAL                                                    *
  2491*                                                              *
  2492*                       NUMBER OF DAYS                         *
  2493*         POLICY MUST BE INFORCE FOR 16 DAYS TO EARN A MONTH   *
  2494*                                                              *
  2495****************************************************************
  2496
  2497
  2498     IF DC-ODD-DAYS-OVER GREATER THAN +16
  2499         COMPUTE CP-REMAINING-TERM-1 =
  2500                             CP-REMAINING-TERM-1 - (+1).
  2501
  2502     GO TO 9999-RT-REMAINING-TERM-XIT.
  2503
  2504
  2505******************************************************************
  2506
  2507*    GO TO 9999-RT-REMAINING-TERM-XIT.
  2508
  2509 8000-DATE-CONVERT.
  2510
  2511* EXEC CICS LINK
  2512*         PROGRAM  ('ELDATCV')
  2513*         COMMAREA (DATE-CONVERSION-DATA)
  2514*         LENGTH   (DC-COMM-LENGTH)
  2515*    END-EXEC.
  2516     MOVE 'ELDATCV' TO DFHEIV1
  2517*    MOVE '."C                   ''   #00002506' TO DFHEIV0
  2518     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2519     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2520     MOVE X'2020233030303032353036' TO DFHEIV0(25:11)
  2521     CALL 'kxdfhei1' USING DFHEIV0,
  2522           DFHEIV1,
  2523           DATE-CONVERSION-DATA,
  2524           DC-COMM-LENGTH,
  2525           DFHEIV99,
  2526           DFHEIV99,
  2527           DFHEIV99
  2528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2529
  2530 8000-EXIT.
  2531     EXIT.
  2532
  2533 9999-RT-REMAINING-TERM-XIT.
  2534     MOVE CALCULATION-PASS-AREA  TO  DFHCOMMAREA.
  2535
  2536
  2537* EXEC CICS RETURN
  2538*    END-EXEC.
  2539*    MOVE '.(                    &   #00002517' TO DFHEIV0
  2540     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* ELRTRM.cbl
  2541     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2542     MOVE X'2020233030303032353137' TO DFHEIV0(25:11)
  2543     CALL 'kxdfhei1' USING DFHEIV0,
  2544           DFHEIV99,
  2545           DFHEIV99,
  2546           DFHEIV99,
  2547           DFHEIV99,
  2548           DFHEIV99
  2549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2550
  2551
  2552
  2553* GOBACK.
  2554     MOVE '9%                    "   ' TO DFHEIV0
  2555     MOVE 'ELRTRM' TO DFHEIV1
  2556     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2557     GOBACK.
  2558
  2559 9999-DFHBACK SECTION.
  2560     MOVE '9%                    "   ' TO DFHEIV0
  2561     MOVE 'ELRTRM' TO DFHEIV1
  2562     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2563     GOBACK.
  2564 9999-DFHEXIT.
  2565     IF DFHEIGDJ EQUAL 0001
  2566         NEXT SENTENCE.
  2567     MOVE '9%                    "   ' TO DFHEIV0
  2568     MOVE 'ELRTRM' TO DFHEIV1
  2569     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2570     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        1776     Code:        5672
