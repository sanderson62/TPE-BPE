* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page   1
* EL633.cbl
* Options: int("EL633.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL633.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL633.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL633.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL633.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/28/94 10:04:35.
     7*                            VMOD=2.021
     8*
     9*AUTHOR.        LOGIC,INC.
    10*               DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page   2
* EL633.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXB7 - COMPENSATION PAYMENTS/ADJUSTMENTS.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL633AI FILLER
    38* 010803                   PEMA  ADD 1825013200 FOR DCC
    39* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
    40* 022504                   PEMA ADD GL CODE FOR DCC
    41* 093004                   PEMA ADD NEW GL CODE FOR DCC
    42* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
    43* 061605    2005051300001  PEMA ADD GL NUM EDIT FOR DCC
    44* 122105    2005033100001  PEMA ADD GL NUM EDIT FOR CSI
    45* 032806                   PEMA ADD MORE GL NUMBERS FOR CSI
    46* 071806    2006012600002  PEMA CHANGE DCC GL NUMBERS
    47* 080206    2006012600002  PEMA ADD GL NUMBER FOR CID & DCC
    48* 092506                   PEMA ADD NEW GL CODE FOR DCC
    49* 031909    2009030300001  AJRA ADD NEW GL CODE FOR CID
    50* 040109    2008050500001  AJRA ADD GL NUMBERS FOR CCC
    51* 031710  CR2009100700001  PEMA CORRECT MATH ON TYPE 'U'
    52* 120711  CR2011120100004  PEMA ADD GL NUMBER FOR CCC
    53* 031912  CR2011120900003  AJRA AHL COMPANY CODE
    54* 100713  CR2013100700001  AJRA ADD 1825091000 FOR CID
    55* 081414    2014012300001  PEMA  ADD PROCESSING FOR CARRIER 7 DCC
    56* 110315  CR2015101400001  PEMA ADD NEW DCC G/L #'S FOR ACH
    57* 111715  IR2015111600001  PEMA  CHG G/L ACCTNO ON CID ACH
    58* 021716  CR2016021000003  PEMA  ADD NEW G/L FOR MACHENS ACCTS
    59* 111016  CR2016110900002  TANA  REPLACE GL NUMBERS FOR CCC
    60* 060817  CR2017060700005  PEMA  ADD NEW G/L FOR VPP
    61* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL
    62******************************************************************
    63
    64 ENVIRONMENT DIVISION.
    65 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page   3
* EL633.cbl
    67 WORKING-STORAGE SECTION.
    68 01  DFH-START PIC X(04).
    69 77  FILLER  PIC X(32)  VALUE '********************************'.
    70 77  FILLER  PIC X(32)  VALUE '*    EL633 WORKING STORAGE     *'.
    71 77  FILLER  PIC X(32)  VALUE '************ V/M 2.021 *********'.
    72
    73*77  FILLER  PIC X(32)  VALUE '/////// SAVE COFA MASTER /////'.
    74*77  SV-COFA PIC X(42)  VALUE SPACES.
    75*77  K-SPACE PIC X(11)  VALUE SPACES.
    76
    77 01  DATE-WORK-AREAS.
    78     05  WS-GREG-STORE.
    79         10  WS-GS-MM  PIC XX.
    80         10  FILLER    PIC X.
    81         10  WS-GS-DD  PIC XX.
    82         10  FILLER    PIC X.
    83         10  WS-GS-YY  PIC XX.
    84     05  WS-SDTE-STORE.
    85         10  WS-SS-MM  PIC XX.
    86         10  WS-SS-DD  PIC XX.
    87         10  WS-SS-YY  PIC XX.
    88*                            COPY ELCSCTM.
    89******************************************************************
    90*                                                                *
    91*                                                                *
    92*                            ELCSCTM                             *
    93*                            VMOD=2.001                          *
    94*                                                                *
    95*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    96*                                                                *
    97******************************************************************
    98 01  SECURITY-MESSAGE.
    99     12  FILLER                          PIC X(30)
   100            VALUE '** LOGIC SECURITY VIOLATION -'.
   101     12  SM-READ                         PIC X(6).
   102     12  FILLER                          PIC X(5)
   103            VALUE ' PGM='.
   104     12  SM-PGM                          PIC X(6).
   105     12  FILLER                          PIC X(5)
   106            VALUE ' OPR='.
   107     12  SM-PROCESSOR-ID                 PIC X(4).
   108     12  FILLER                          PIC X(6)
   109            VALUE ' TERM='.
   110     12  SM-TERMID                       PIC X(4).
   111     12  FILLER                          PIC XX   VALUE SPACE.
   112     12  SM-JUL-DATE                     PIC 9(5).
   113     12  FILLER                          PIC X    VALUE SPACE.
   114     12  SM-TIME                         PIC 99.99.
   115
   116*                            COPY ELCSCRTY.
   117******************************************************************
   118*                                                                *
   119*                                                                *
   120*                            ELCSCRTY                            *
   121*                            VMOD=2.001                          *
   122*                                                                *
   123*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   124*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page   4
* EL633.cbl
   125*        SAVED IN PI-SECURITY-ADDRESS.                           *
   126*                                                                *
   127******************************************************************
   128 01  SECURITY-CONTROL.
   129     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   130     12  FILLER                       PIC XX    VALUE 'SC'.
   131     12  SC-CREDIT-CODES.
   132         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   133             20  SC-CREDIT-DISPLAY    PIC X.
   134             20  SC-CREDIT-UPDATE     PIC X.
   135     12  SC-CLAIMS-CODES.
   136         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   137             20  SC-CLAIMS-DISPLAY    PIC X.
   138             20  SC-CLAIMS-UPDATE     PIC X.
   139
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page   5
* EL633.cbl
   141
   142 01  STANDARD-AREAS.
   143     12  SC-ITEM             PIC  S9(4) COMP VALUE +1.
   144     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
   145     12  MAP-NAME            PIC  X(8)       VALUE 'EL633A'.
   146     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL633S'.
   147     12  SCREEN-NUMBER       PIC  X(4)       VALUE '633A'.
   148     12  TRANS-ID            PIC  X(4)       VALUE 'EXB7'.
   149     12  EL6331-TRANS-ID     PIC  X(4)       VALUE 'EXB8'.
   150     12  EL640-TRANS-ID      PIC  X(4)       VALUE 'EXC1'.
   151     12  EL642-TRANS-ID      PIC  X(4)       VALUE 'EXH7'.
   152     12  EL652-TRANS-ID      PIC  X(4)       VALUE 'EXD4'.
   153     12  THIS-PGM            PIC  X(8)       VALUE 'EL633'.
   154     12  PGM-NAME            PIC  X(8).
   155     12  TIME-IN             PIC S9(7).
   156     12  TIME-OUT-R  REDEFINES  TIME-IN.
   157         16  FILLER          PIC  X.
   158         16  TIME-OUT        PIC  99V99.
   159         16  FILLER          PIC  X(2).
   160     12  EL640               PIC  X(8)       VALUE 'EL640'.
   161     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
   162     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
   163     12  XCTL-626            PIC  X(8)       VALUE 'EL626'.
   164     12  XCTL-6331           PIC  X(8)       VALUE 'EL6331'.
   165     12  XCTL-640            PIC  X(8)       VALUE 'EL640'.
   166     12  XCTL-642            PIC  X(8)       VALUE 'EL642'.
   167     12  XCTL-652            PIC  X(8)       VALUE 'EL652'.
   168     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   169     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   170     12  RETURNED-FROM       PIC  X(8)       VALUE SPACES.
   171     12  LINK-CLDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   172     12  PYAJ-FILE-ID        PIC  X(8)       VALUE 'ERPYAJ'.
   173     12  CHKQ-FILE-ID        PIC  X(8)       VALUE 'ERCHKQ'.
   174     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   175     12  WS-CURRENT-DT       PIC  X(8)       VALUE SPACES.
   176     12  WS-CURRENT-BIN-DT   PIC  X(2)       VALUE SPACES.
   177     12  PYAJ-READ-SW        PIC  X          VALUE 'Y'.
   178         88  PYAJ-1ST-READ                   VALUE 'Y'.
   179     12  FIRST-ADD-SW        PIC  X          VALUE 'Y'.
   180         88  FIRST-ADD                       VALUE 'Y'.
   181     12  ZERO-NDX            PIC  9          VALUE ZERO.
   182     12  WORK-SEQ-NO         PIC S9(8)       COMP-3 VALUE ZEROS.
   183     12  WORK-SEQ-TIME       PIC  9(6).
   184     12  WORK-SEQ-HHMMSS  REDEFINES  WORK-SEQ-TIME.
   185         16  WORK-SEQ-HHMMS  PIC  9(5).
   186         16  FILLER          PIC  9.
   187     12  WORK-DATE-JULIAN.
   188         16  WORK-JULIAN-YR  PIC  99         VALUE ZEROS.
   189         16  WORK-JULIAN-DD  PIC  999        VALUE ZEROS.
   190     12  JULIAN-YY-DD        PIC  9(4)       COMP-3 VALUE ZEROS.
   191     12  CHECK-REC-TYPE      PIC  X          VALUE SPACE.
   192         88  VALID-REC-TYPE                  VALUE  'R' 'D' 'C'
   193                                                    'S' 'T' 'U'
   194                                                    'X' 'Y' 'Z'
   195                                                    'F'.
   196     12  CHECK-CANC-TYPE     PIC  X          VALUE SPACE.
   197         88  VALID-CANC-TYPE                 VALUE 'N' 'Y' ' '.
   198     12  FORCE-SHOW-SW       PIC  X          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page   6
* EL633.cbl
   199         88  FORCE-SHOW                      VALUE  'Y'.
   200
   201     12  WS-EOM-DTS OCCURS 13  TIMES
   202                              INDEXED BY PINDEX.
   203         16  WS-EOM-DT               PIC XX.
   204*    12  COFA-FILE-ID        PIC  X(8)       VALUE 'COFAXXX '.
   205
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page   7
* EL633.cbl
   207     12  WS-ERROR-CODES.
   208         16  ER-0000         PIC  X(4)       VALUE '0000'.
   209         16  ER-0008         PIC  X(4)       VALUE '0008'.
   210         16  ER-0023         PIC  X(4)       VALUE '0023'.
   211         16  ER-0029         PIC  X(4)       VALUE '0029'.
   212         16  ER-0070         PIC  X(4)       VALUE '0070'.
   213         16  ER-0587         PIC  X(4)       VALUE '0587'.
   214         16  ER-2056         PIC  X(4)       VALUE '2056'.
   215         16  ER-2230         PIC  X(4)       VALUE '2230'.
   216         16  ER-2231         PIC  X(4)       VALUE '2231'.
   217         16  ER-2232         PIC  X(4)       VALUE '2232'.
   218         16  ER-2233         PIC  X(4)       VALUE '2233'.
   219         16  ER-2234         PIC  X(4)       VALUE '2234'.
   220         16  ER-2235         PIC  X(4)       VALUE '2235'.
   221         16  ER-2236         PIC  X(4)       VALUE '2236'.
   222         16  ER-2237         PIC  X(4)       VALUE '2237'.
   223         16  ER-2238         PIC  X(4)       VALUE '2238'.
   224         16  ER-2239         PIC  X(4)       VALUE '2239'.
   225         16  ER-2244         PIC  X(4)       VALUE '2244'.
   226         16  ER-2245         PIC  X(4)       VALUE '2245'.
   227         16  ER-2246         PIC  X(4)       VALUE '2246'.
   228         16  ER-2370         PIC  X(4)       VALUE '2370'.
   229         16  ER-2432         PIC  X(4)       VALUE '2432'.
   230         16  ER-2449         PIC  X(4)       VALUE '2449'.
   231         16  ER-2587         PIC  X(4)       VALUE '2587'.
   232         16  ER-2588         PIC  X(4)       VALUE '2588'.
   233         16  ER-2595         PIC  X(4)       VALUE '2595'.
   234         16  ER-2596         PIC  X(4)       VALUE '2596'.
   235         16  ER-2763         PIC  X(4)       VALUE '2763'.
   236         16  ER-2929         PIC  X(4)       VALUE '2929'.
   237         16  ER-2957         PIC  X(4)       VALUE '2957'.
   238         16  ER-2958         PIC  X(4)       VALUE '2958'.
   239*        16  ER-2959         PIC  X(4)       VALUE '2958'.
   240         16  ER-2960         PIC  X(4)       VALUE '2960'.
   241         16  ER-3020         PIC  X(4)       VALUE '3020'.
   242
   243*************************************************************
   244*                      TABLE OF STATE NAMES
   245*************************************************************
   246
   247 01  CHECK-STATE-CODE            PIC XX      VALUE SPACE.
   248     88  VALID-STATE-CODE    VALUE 'AK' 'AL' 'AR' 'AZ' 'CA'
   249                                   'CD' 'CO' 'CT' 'DC' 'DE'
   250                                   'FL' 'GA' 'GM' 'HI' 'IA'
   251                                   'ID' 'IL' 'IN' 'KS' 'KY'
   252                                   'LA' 'MA' 'MD' 'ME' 'MI'
   253                                   'MN' 'MO' 'MS' 'MT' 'MX'
   254                                   'NC' 'ND' 'NE' 'NH' 'NJ'
   255                                   'NM' 'NV' 'NY' 'OF' 'OH'
   256                                   'OK' 'OR' 'PA' 'PI' 'PR'
   257                                   'RI' 'SC' 'SD' 'TN' 'TX'
   258                                   'UT' 'VA' 'VI' 'VT' 'WA'
   259                                   'WI' 'WV' 'WY'.
   260
   261 01  CHECK-GL-ACCT         PIC X(10)  VALUE SPACE.
   262     88  VALID-GL-ACCOUNT  VALUE '1108121010'
   263                                 '1108124700'
   264                                 '1108125100'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page   8
* EL633.cbl
   265                                 '1721211400'
   266                                 '1825011200'
   267                                 '1825011300'
   268                                 '1825091000'
   269                                 '1825099050'
   270                                 '8505700033'
   271                                 '8506400030'
   272                                 '8507200020'
   273                                 '8507200010'
   274                                 '2725010160'.
   275     88  VALID-DCC-GL-ACCOUNT  VALUE '2725040300'
   276                                     '2725040320'
   277                                     '2725040330'
   278                                     '2725040310'
   279                                     '8506400030'
   280                                     '8507200010'
   281                                     '1108121250'.
   282*    88  VALID-CSI-GL-ACCOUNT  VALUE '2725040100'
   283*                                    '2725040110'
   284*                                    '2725040120'
   285*                                    '2725040130'
   286*                                    '2725020400'.
   287     88  VALID-CSI-GL-ACCOUNT  VALUE '1108121010'
   288                                     '1825013200'
   289                                     '1825013300'
   290                                     '1825013400'.
   291
   292     88  VALID-CCC-GL-ACCOUNT  VALUE '1825013100'
   293                                     '1825013200'
   294                                     '1825013300'
   295                                     '1825013400'
   296                                     '8506400030'
   297                                     '8507200010'
   298                                     '8507200020'
   299                                     '1108121010'.
   300     88  VALID-VPP-GL-ACCOUNT  VALUE '2725040510'
   301                                     '2725040520'
   302                                     '7206100400'
   303                                     '7206104100'.
   304     88  VALID-FNL-GL-ACCOUNT  VALUE '1108121010'
   305                                     '1721211400'
   306                                     '1825011100'
   307                                     '1825011200'
   308                                     '1825011300'
   309                                     '1825099050'
   310                                     '2718000110'
   311                                     '2718000120'
   312                                     '8506400030'
   313                                     '8507200010'.
   314
   315*01  WS-ACCT-BREAK.
   316*    05  WS-ACCT-1               PIC X.
   317*    05  FILLER                  PIC X(6).
   318*
   319 01  WORK-AREA.
   320     12  WS-SAVE-ERPYAJ      PIC X(200)      VALUE SPACES.
   321     12  QID.
   322         16  QID-TERM        PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page   9
* EL633.cbl
   323         16  FILLER          PIC X(04)       VALUE '633A'.
   324     12  DEEDIT-FIELD        PIC X(11).
   325     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD PIC S9(11).
   326     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD PIC S9(9)V99.
   327     12  DATE-TEST-AREA      PIC  9(6).
   328     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   329         16  DATE-TEST-MM    PIC  99.
   330         16  DATE-TEST-DD    PIC  99.
   331         16  DATE-TEST-YY    PIC  99.
   332     12  DIVIDE-RESULT       PIC  99.
   333     12  DIVIDE-REMAINDER    PIC  9.
   334     12  PREV-BIN-MAINT-DT   PIC  XX           VALUE SPACES.
   335     12  PREV-MAINT-DT       PIC  X(8)         VALUE SPACES.
   336     12  PREV-BIN-BL-DT      PIC  XX           VALUE SPACES.
   337     12  PREV-BL-DT          PIC  X(8)         VALUE SPACES.
   338     12  TOTAL-ACCT-AMT      PIC S9(7)V99      VALUE ZEROS.
   339     12  TOTAL-ACCT-NET      PIC S9(7)V99      VALUE ZEROS.
   340     12  WS-SAVE-INDEX-VALUE PIC S9(4) COMP    VALUE ZEROS.
   341     12  WS-SAVE-NDX-VALUE   PIC S9(4) COMP    VALUE ZEROS.
   342
   343 01  ACCESS-KEYS.
   344     12  ERPYAJ-KEY.
   345         16  PYAJ-COMP-CD            PIC  X      VALUE SPACE.
   346         16  PYAJ-CARRIER            PIC  X      VALUE SPACES.
   347         16  PYAJ-GROUPING           PIC  X(6)   VALUE SPACES.
   348         16  PYAJ-FIN-RESP           PIC  X(10)  VALUE SPACES.
   349         16  PYAJ-ACCOUNT            PIC  X(10)  VALUE SPACES.
   350         16  PYAJ-FILE-SEQ-NO        PIC S9(8)   VALUE +0  COMP.
   351         16  PYAJ-RECORD-TYPE        PIC  X      VALUE SPACES.
   352
   353     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   354     12  ERPYAJ-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   355
   356     12  ERCHKQ-KEY.
   357         16  CHKQ-COMPANY-CD         PIC  X      VALUE SPACE.
   358         16  CHKQ-CONTROL-NUMBER     PIC S9(8)   VALUE +0  COMP.
   359         16  CHKQ-SEQUENCE-NUMBER    PIC S9(4)   VALUE +0  COMP.
   360     12  ERCOMP-KEY.
   361         16  COMP-COMP-CD            PIC  X      VALUE SPACE.
   362         16  COMP-CARRIER            PIC  X      VALUE SPACES.
   363         16  COMP-GROUPING           PIC  X(6)   VALUE SPACES.
   364         16  COMP-FIN-RESP           PIC  X(10)  VALUE SPACES.
   365         16  COMP-ACCOUNT            PIC  X(10)  VALUE SPACES.
   366         16  COMP-RECORD-TYPE        PIC  X      VALUE SPACES.
   367*    12  COFA-KEY-X.
   368*        16  COFA-COMPANY-X          PIC  X(4)   VALUE SPACES.
   369*        16  COFA-ACCOUNT.
   370*            20  COFA-FILLER         PIC  X(11)  VALUE SPACES.
   371*            20  COFA-MSA-ACCT       PIC  X(07)  VALUE SPACES.
   372*
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  10
* EL633.cbl
   374*                                    COPY ELCDATE.
   375******************************************************************
   376*                                                                *
   377*                                                                *
   378*                            ELCDATE.                            *
   379*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   380*                            VMOD=2.003
   381*                                                                *
   382*                                                                *
   383*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   384*                 LENGTH = 200                                   *
   385******************************************************************
   386
   387 01  DATE-CONVERSION-DATA.
   388     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   389     12  DC-OPTION-CODE                PIC X.
   390         88  BIN-TO-GREG                VALUE ' '.
   391         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   392         88  EDIT-GREG-TO-BIN           VALUE '2'.
   393         88  YMD-GREG-TO-BIN            VALUE '3'.
   394         88  MDY-GREG-TO-BIN            VALUE '4'.
   395         88  JULIAN-TO-BIN              VALUE '5'.
   396         88  BIN-PLUS-ELAPSED           VALUE '6'.
   397         88  FIND-CENTURY               VALUE '7'.
   398         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   399         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   400         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   401         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   402         88  JULIAN-TO-BIN-3            VALUE 'C'.
   403         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   404         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   405         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   406         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   407         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   408         88  CHECK-LEAP-YEAR            VALUE 'H'.
   409         88  BIN-3-TO-GREG              VALUE 'I'.
   410         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   411         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   412         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   413         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   414         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   415         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   416         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   417         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   418         88  THREE-CHARACTER-BIN
   419                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   420         88  GREGORIAN-TO-BIN
   421                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   422         88  BIN-TO-GREGORIAN
   423                  VALUES ' ' '1' 'I' '8' 'G'.
   424         88  JULIAN-TO-BINARY
   425                  VALUES '5' 'C' 'E' 'F'.
   426     12  DC-ERROR-CODE                 PIC X.
   427         88  NO-CONVERSION-ERROR        VALUE ' '.
   428         88  DATE-CONVERSION-ERROR
   429                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   430         88  DATE-IS-ZERO               VALUE '1'.
   431         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  11
* EL633.cbl
   432         88  DATE-IS-INVALID            VALUE '3'.
   433         88  DATE1-GREATER-DATE2        VALUE '4'.
   434         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   435         88  DATE-INVALID-OPTION        VALUE '9'.
   436         88  INVALID-CENTURY            VALUE 'A'.
   437         88  ONLY-CENTURY               VALUE 'B'.
   438         88  ONLY-LEAP-YEAR             VALUE 'C'.
   439         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   440     12  DC-END-OF-MONTH               PIC X.
   441         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   442     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   443         88  USE-NORMAL-PROCESS         VALUE ' '.
   444         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   445         88  ADJUST-UP-100-YRS          VALUE '2'.
   446     12  FILLER                        PIC X.
   447     12  DC-CONVERSION-DATES.
   448         16  DC-BIN-DATE-1             PIC XX.
   449         16  DC-BIN-DATE-2             PIC XX.
   450         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   451         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   452                       DC-GREG-DATE-1-EDIT.
   453             20  DC-EDIT1-MONTH        PIC 99.
   454             20  SLASH1-1              PIC X.
   455             20  DC-EDIT1-DAY          PIC 99.
   456             20  SLASH1-2              PIC X.
   457             20  DC-EDIT1-YEAR         PIC 99.
   458         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   459         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   460                     DC-GREG-DATE-2-EDIT.
   461             20  DC-EDIT2-MONTH        PIC 99.
   462             20  SLASH2-1              PIC X.
   463             20  DC-EDIT2-DAY          PIC 99.
   464             20  SLASH2-2              PIC X.
   465             20  DC-EDIT2-YEAR         PIC 99.
   466         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   467         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   468                     DC-GREG-DATE-1-YMD.
   469             20  DC-YMD-YEAR           PIC 99.
   470             20  DC-YMD-MONTH          PIC 99.
   471             20  DC-YMD-DAY            PIC 99.
   472         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   473         16  DC-GREG-DATE-1-MDY-R REDEFINES
   474                      DC-GREG-DATE-1-MDY.
   475             20  DC-MDY-MONTH          PIC 99.
   476             20  DC-MDY-DAY            PIC 99.
   477             20  DC-MDY-YEAR           PIC 99.
   478         16  DC-GREG-DATE-1-ALPHA.
   479             20  DC-ALPHA-MONTH        PIC X(10).
   480             20  DC-ALPHA-DAY          PIC 99.
   481             20  FILLER                PIC XX.
   482             20  DC-ALPHA-CENTURY.
   483                 24 DC-ALPHA-CEN-N     PIC 99.
   484             20  DC-ALPHA-YEAR         PIC 99.
   485         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   486         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   487         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   488         16  DC-JULIAN-DATE            PIC 9(05).
   489         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  12
* EL633.cbl
   490                                       PIC 9(05).
   491         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   492             20  DC-JULIAN-YEAR        PIC 99.
   493             20  DC-JULIAN-DAYS        PIC 999.
   494         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   495         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   496         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   497     12  DATE-CONVERSION-VARIBLES.
   498         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   499         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   500             20  FILLER                PIC 9(3).
   501             20  HOLD-CEN-1-CCYY.
   502                 24  HOLD-CEN-1-CC     PIC 99.
   503                 24  HOLD-CEN-1-YY     PIC 99.
   504             20  HOLD-CEN-1-MO         PIC 99.
   505             20  HOLD-CEN-1-DA         PIC 99.
   506         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   507             20  HOLD-CEN-1-R-MO       PIC 99.
   508             20  HOLD-CEN-1-R-DA       PIC 99.
   509             20  HOLD-CEN-1-R-CCYY.
   510                 24  HOLD-CEN-1-R-CC   PIC 99.
   511                 24  HOLD-CEN-1-R-YY   PIC 99.
   512             20  FILLER                PIC 9(3).
   513         16  HOLD-CENTURY-1-X.
   514             20  FILLER                PIC X(3)  VALUE SPACES.
   515             20  HOLD-CEN-1-X-CCYY.
   516                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   517                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   518             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   519             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   520         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   521             20  HOLD-CEN-1-R-X-MO     PIC XX.
   522             20  HOLD-CEN-1-R-X-DA     PIC XX.
   523             20  HOLD-CEN-1-R-X-CCYY.
   524                 24  HOLD-CEN-1-R-X-CC PIC XX.
   525                 24  HOLD-CEN-1-R-X-YY PIC XX.
   526             20  FILLER                PIC XXX.
   527         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   528         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   529         16  DC-JULIAN-DATE-1          PIC 9(07).
   530         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   531             20  DC-JULIAN-1-CCYY.
   532                 24  DC-JULIAN-1-CC    PIC 99.
   533                 24  DC-JULIAN-1-YR    PIC 99.
   534             20  DC-JULIAN-DA-1        PIC 999.
   535         16  DC-JULIAN-DATE-2          PIC 9(07).
   536         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   537             20  DC-JULIAN-2-CCYY.
   538                 24  DC-JULIAN-2-CC    PIC 99.
   539                 24  DC-JULIAN-2-YR    PIC 99.
   540             20  DC-JULIAN-DA-2        PIC 999.
   541         16  DC-GREG-DATE-A-EDIT.
   542             20  DC-EDITA-MONTH        PIC 99.
   543             20  SLASHA-1              PIC X VALUE '/'.
   544             20  DC-EDITA-DAY          PIC 99.
   545             20  SLASHA-2              PIC X VALUE '/'.
   546             20  DC-EDITA-CCYY.
   547                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  13
* EL633.cbl
   548                 24  DC-EDITA-YEAR     PIC 99.
   549         16  DC-GREG-DATE-B-EDIT.
   550             20  DC-EDITB-MONTH        PIC 99.
   551             20  SLASHB-1              PIC X VALUE '/'.
   552             20  DC-EDITB-DAY          PIC 99.
   553             20  SLASHB-2              PIC X VALUE '/'.
   554             20  DC-EDITB-CCYY.
   555                 24  DC-EDITB-CENT     PIC 99.
   556                 24  DC-EDITB-YEAR     PIC 99.
   557         16  DC-GREG-DATE-CYMD         PIC 9(08).
   558         16  DC-GREG-DATE-CYMD-R REDEFINES
   559                              DC-GREG-DATE-CYMD.
   560             20  DC-CYMD-CEN           PIC 99.
   561             20  DC-CYMD-YEAR          PIC 99.
   562             20  DC-CYMD-MONTH         PIC 99.
   563             20  DC-CYMD-DAY           PIC 99.
   564         16  DC-GREG-DATE-MDCY         PIC 9(08).
   565         16  DC-GREG-DATE-MDCY-R REDEFINES
   566                              DC-GREG-DATE-MDCY.
   567             20  DC-MDCY-MONTH         PIC 99.
   568             20  DC-MDCY-DAY           PIC 99.
   569             20  DC-MDCY-CEN           PIC 99.
   570             20  DC-MDCY-YEAR          PIC 99.
   571    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   572        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   573    12  DC-EL310-DATE                  PIC X(21).
   574    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  14
* EL633.cbl
   576*                                    COPY ELCLOGOF.
   577******************************************************************
   578*                                                                *
   579*                                                                *
   580*                            ELCLOGOF.                           *
   581*                            VMOD=2.001                          *
   582*                                                                *
   583*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   584*                                                                *
   585******************************************************************
   586 01  CLASIC-LOGOFF.
   587     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   588     12  LOGOFF-TEXT.
   589         16  FILLER          PIC X(5)    VALUE SPACES.
   590         16  LOGOFF-MSG.
   591             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   592             20  FILLER      PIC X       VALUE SPACES.
   593             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   594         16  FILLER          PIC X(80)
   595           VALUE '* YOU ARE NOW LOGGED OFF'.
   596         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   597         16  FILLER          PIC X       VALUE QUOTE.
   598         16  LOGOFF-SYS-MSG  PIC X(17)
   599           VALUE 'S CLAS-IC SYSTEM '.
   600     12  TEXT-MESSAGES.
   601         16  UNACCESS-MSG    PIC X(29)
   602             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   603         16  PGMIDERR-MSG    PIC X(17)
   604             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  15
* EL633.cbl
   606*                                    COPY ELCATTR.
   607******************************************************************
   608*                                                                *
   609*                            ELCATTR.                            *
   610*                            VMOD=2.001                          *
   611*                                                                *
   612*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   613*                                                                *
   614*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   615*                                                                *
   616*                   POS 1   P=PROTECTED                          *
   617*                           U=UNPROTECTED                        *
   618*                           S=ASKIP                              *
   619*                   POS 2   A=ALPHA/NUMERIC                      *
   620*                           N=NUMERIC                            *
   621*                   POS 3   N=NORMAL                             *
   622*                           B=BRIGHT                             *
   623*                           D=DARK                               *
   624*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   625*                           OF=MODIFIED DATA TAG OFF             *
   626*                                                                *
   627*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   628******************************************************************
   629 01  ATTRIBUTE-LIST.
   630     12  AL-PABOF            PIC X       VALUE 'Y'.
   631     12  AL-PABON            PIC X       VALUE 'Z'.
   632     12  AL-PADOF            PIC X       VALUE '%'.
   633     12  AL-PADON            PIC X       VALUE '_'.
   634     12  AL-PANOF            PIC X       VALUE '-'.
   635     12  AL-PANON            PIC X       VALUE '/'.
   636     12  AL-SABOF            PIC X       VALUE '8'.
   637     12  AL-SABON            PIC X       VALUE '9'.
   638     12  AL-SADOF            PIC X       VALUE '@'.
   639     12  AL-SADON            PIC X       VALUE QUOTE.
   640     12  AL-SANOF            PIC X       VALUE '0'.
   641     12  AL-SANON            PIC X       VALUE '1'.
   642     12  AL-UABOF            PIC X       VALUE 'H'.
   643     12  AL-UABON            PIC X       VALUE 'I'.
   644     12  AL-UADOF            PIC X       VALUE '<'.
   645     12  AL-UADON            PIC X       VALUE '('.
   646     12  AL-UANOF            PIC X       VALUE ' '.
   647     12  AL-UANON            PIC X       VALUE 'A'.
   648     12  AL-UNBOF            PIC X       VALUE 'Q'.
   649     12  AL-UNBON            PIC X       VALUE 'R'.
   650     12  AL-UNDOF            PIC X       VALUE '*'.
   651     12  AL-UNDON            PIC X       VALUE ')'.
   652     12  AL-UNNOF            PIC X       VALUE '&'.
   653     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  16
* EL633.cbl
   655*                                    COPY ELCEMIB.
   656******************************************************************
   657*                                                                *
   658*                                                                *
   659*                            ELCEMIB.                            *
   660*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   661*                            VMOD=2.005                          *
   662*                                                                *
   663*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   664*                                                                *
   665******************************************************************
   666 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   667     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   668     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   669     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   670     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   671     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   672     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   673     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   674     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   675     12  EMI-SWITCH1             PIC X        VALUE '1'.
   676         88  EMI-NO-ERRORS                    VALUE '1'.
   677         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   678         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   679     12  EMI-SWITCH2             PIC X        VALUE '1'.
   680         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   681     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   682         88  EMI-AREA1-EMPTY                  VALUE '1'.
   683         88  EMI-AREA1-FULL                   VALUE '2'.
   684     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   685         88  EMI-AREA2-EMPTY                  VALUE '1'.
   686         88  EMI-AREA2-FULL                   VALUE '2'.
   687     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   688         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   689         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   690         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   691         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   692         88  EMI-BYPASS-FATALS                VALUE 'X'.
   693     12  EMI-ERROR-LINES.
   694         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   695         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   696         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   697         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   698             20  EMI-ERR-CODES OCCURS 10 TIMES.
   699                 24  EMI-ERR-NUM         PIC X(4).
   700                 24  EMI-FILLER          PIC X.
   701                 24  EMI-SEV             PIC X.
   702                 24  FILLER              PIC X.
   703             20  FILLER                  PIC X(02).
   704     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   705         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   706             20  EMI-ERROR-NUMBER    PIC X(4).
   707             20  EMI-FILL            PIC X.
   708             20  EMI-SEVERITY        PIC X.
   709             20  FILLER              PIC X.
   710             20  EMI-ERROR-TEXT.
   711                 24  EMI-TEXT-VARIABLE   PIC X(10).
   712                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  17
* EL633.cbl
   713     12  EMI-SEVERITY-SAVE           PIC X.
   714         88  EMI-NOTE                    VALUE 'N'.
   715         88  EMI-WARNING                 VALUE 'W'.
   716         88  EMI-FORCABLE                VALUE 'F'.
   717         88  EMI-FATAL                   VALUE 'X'.
   718     12  EMI-MESSAGE-FLAG            PIC X.
   719         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   720         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   721     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   722     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   723         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   724         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   725         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   726     12  emi-claim-no                pic x(7).
   727     12  emi-claim-type              pic x(6).
   728     12  FILLER                      PIC X(124)  VALUE SPACES.
   729     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   730     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   731     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   732     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  18
* EL633.cbl
   734*                                    COPY ELCINTF.
   735******************************************************************
   736*                                                                *
   737*                                                                *
   738*                            ELCINTF.                            *
   739*                            VMOD=2.017                          *
   740*                                                                *
   741*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   742*                                                                *
   743*       LENGTH = 1024                                            *
   744*                                                                *
   745******************************************************************
   746*                   C H A N G E   L O G
   747*
   748* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   749*-----------------------------------------------------------------
   750*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   751* EFFECTIVE    NUMBER
   752*-----------------------------------------------------------------
   753* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   754******************************************************************
   755 01  PROGRAM-INTERFACE-BLOCK.
   756     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   757     12  PI-CALLING-PROGRAM              PIC X(8).
   758     12  PI-SAVED-PROGRAM-1              PIC X(8).
   759     12  PI-SAVED-PROGRAM-2              PIC X(8).
   760     12  PI-SAVED-PROGRAM-3              PIC X(8).
   761     12  PI-SAVED-PROGRAM-4              PIC X(8).
   762     12  PI-SAVED-PROGRAM-5              PIC X(8).
   763     12  PI-SAVED-PROGRAM-6              PIC X(8).
   764     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   765     12  PI-COMPANY-ID                   PIC XXX.
   766     12  PI-COMPANY-CD                   PIC X.
   767
   768     12  PI-COMPANY-PASSWORD             PIC X(8).
   769
   770     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   771
   772     12  PI-CONTROL-IN-PROGRESS.
   773         16  PI-CARRIER                  PIC X.
   774         16  PI-GROUPING                 PIC X(6).
   775         16  PI-STATE                    PIC XX.
   776         16  PI-ACCOUNT                  PIC X(10).
   777         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   778                                         PIC X(10).
   779         16  PI-CLAIM-CERT-GRP.
   780             20  PI-CLAIM-NO             PIC X(7).
   781             20  PI-CERT-NO.
   782                 25  PI-CERT-PRIME       PIC X(10).
   783                 25  PI-CERT-SFX         PIC X.
   784             20  PI-CERT-EFF-DT          PIC XX.
   785         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   786             20  PI-PLAN-CODE            PIC X(2).
   787             20  PI-REVISION-NUMBER      PIC X(3).
   788             20  PI-PLAN-EFF-DT          PIC X(2).
   789             20  PI-PLAN-EXP-DT          PIC X(2).
   790             20  FILLER                  PIC X(11).
   791         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  19
* EL633.cbl
   792             20  PI-OE-REFERENCE-1.
   793                 25  PI-OE-REF-1-PRIME   PIC X(18).
   794                 25  PI-OE-REF-1-SUFF    PIC XX.
   795
   796     12  PI-SESSION-IN-PROGRESS          PIC X.
   797         88  CLAIM-SESSION                   VALUE '1'.
   798         88  CREDIT-SESSION                  VALUE '2'.
   799         88  WARRANTY-SESSION                VALUE '3'.
   800         88  MORTGAGE-SESSION                VALUE '4'.
   801         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   802
   803
   804*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   805
   806     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   807     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   808
   809     12  PI-CREDIT-USER                  PIC X.
   810         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   811         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   812
   813     12  PI-CLAIM-USER                   PIC X.
   814         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   815         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   816
   817     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   818         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   819         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   820         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   821         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   822         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   823
   824     12  PI-PROCESSOR-ID                 PIC X(4).
   825
   826     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   827
   828     12  PI-MEMBER-CAPTION               PIC X(10).
   829
   830     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   831         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   832
   833     12  PI-LIFE-OVERRIDE-L1             PIC X.
   834     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   835     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   836     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   837
   838     12  PI-AH-OVERRIDE-L1               PIC X.
   839     12  PI-AH-OVERRIDE-L2               PIC XX.
   840     12  PI-AH-OVERRIDE-L6               PIC X(6).
   841     12  PI-AH-OVERRIDE-L12              PIC X(12).
   842
   843     12  PI-NEW-SYSTEM                   PIC X(2).
   844
   845     12  PI-PRIMARY-CERT-NO              PIC X(11).
   846     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   847         88  PI-USES-PAID-TO                 VALUE '1'.
   848     12  PI-CRDTCRD-SYSTEM.
   849         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  20
* EL633.cbl
   850             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   851             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   852         16  PI-CC-MONTH-END-DT          PIC XX.
   853     12  PI-PROCESSOR-PRINTER            PIC X(4).
   854
   855     12  PI-OE-REFERENCE-2.
   856         16  PI-OE-REF-2-PRIME           PIC X(10).
   857         16  PI-OE-REF-2-SUFF            PIC X.
   858
   859     12  PI-REM-TRM-CALC-OPTION          PIC X.
   860
   861     12  PI-LANGUAGE-TYPE                PIC X.
   862             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   863             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   864             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   865
   866     12  PI-POLICY-LINKAGE-IND           PIC X.
   867         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   868         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   869                                                   LOW-VALUES.
   870
   871     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   872     12  PI-CLAIM-PW-SESSION             PIC X(1).
   873         88  PI-CLAIM-CREDIT                 VALUE '1'.
   874         88  PI-CLAIM-CONVEN                 VALUE '2'.
   875
   876     12  PI-PROCESSOR-CSR-IND            PIC X.
   877         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   878         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   879
   880     12  FILLER                          PIC X(3).
   881
   882     12  PI-SYSTEM-LEVEL                 PIC X(145).
   883
   884     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   885         PI-SYSTEM-LEVEL.
   886
   887         16  PI-ENTRY-CODES.
   888             20  PI-ENTRY-CD-1           PIC X.
   889             20  PI-ENTRY-CD-2           PIC X.
   890
   891         16  PI-RETURN-CODES.
   892             20  PI-RETURN-CD-1          PIC X.
   893             20  PI-RETURN-CD-2          PIC X.
   894
   895         16  PI-UPDATE-STATUS-SAVE.
   896             20  PI-UPDATE-BY            PIC X(4).
   897             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   898
   899         16  PI-LOWER-CASE-LETTERS       PIC X.
   900             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   901
   902*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   903*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   904*            88  CARRIER-CLM-CNTL            VALUE '2'.
   905
   906         16  PI-CERT-ACCESS-CONTROL      PIC X.
   907             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  21
* EL633.cbl
   908             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   909             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   910             88  ACCNT-CNTL                  VALUE '3'.
   911             88  CARR-ACCNT-CNTL             VALUE '4'.
   912
   913         16  PI-PROCESSOR-CAP-LIST.
   914             20  PI-SYSTEM-CONTROLS.
   915                24 PI-SYSTEM-DISPLAY     PIC X.
   916                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   917                24 PI-SYSTEM-MODIFY      PIC X.
   918                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   919             20  FILLER                  PIC XX.
   920             20  PI-DISPLAY-CAP          PIC X.
   921                 88  DISPLAY-CAP             VALUE 'Y'.
   922             20  PI-MODIFY-CAP           PIC X.
   923                 88  MODIFY-CAP              VALUE 'Y'.
   924             20  PI-MSG-AT-LOGON-CAP     PIC X.
   925                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   926             20  PI-FORCE-CAP            PIC X.
   927                 88  FORCE-CAP               VALUE 'Y'.
   928
   929         16  PI-PROGRAM-CONTROLS.
   930             20  PI-PGM-PRINT-OPT        PIC X.
   931             20  PI-PGM-FORMAT-OPT       PIC X.
   932             20  PI-PGM-PROCESS-OPT      PIC X.
   933             20  PI-PGM-TOTALS-OPT       PIC X.
   934
   935         16  PI-HELP-INTERFACE.
   936             20  PI-LAST-ERROR-NO        PIC X(4).
   937             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   938
   939         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   940             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   941
   942         16  PI-CR-CONTROL-IN-PROGRESS.
   943             20  PI-CR-CARRIER           PIC X.
   944             20  PI-CR-GROUPING          PIC X(6).
   945             20  PI-CR-STATE             PIC XX.
   946             20  PI-CR-ACCOUNT           PIC X(10).
   947             20  PI-CR-FIN-RESP          PIC X(10).
   948             20  PI-CR-TYPE              PIC X.
   949
   950         16  PI-CR-BATCH-NUMBER          PIC X(6).
   951
   952         16  PI-CR-MONTH-END-DT          PIC XX.
   953
   954         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   955             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   956             88  PI-ZERO-CARRIER             VALUE '1'.
   957             88  PI-ZERO-GROUPING            VALUE '2'.
   958             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   959
   960         16  PI-CARRIER-SECURITY         PIC X.
   961             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   962
   963         16  PI-ACCOUNT-SECURITY         PIC X(10).
   964             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   965             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  22
* EL633.cbl
   966
   967         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   968             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   969                                         INDEXED BY PI-ACCESS-NDX
   970                                         PIC X.
   971
   972         16  PI-GA-BILLING-CONTROL       PIC X.
   973             88  PI-GA-BILLING               VALUE '1'.
   974
   975         16  PI-MAIL-PROCESSING          PIC X.
   976             88  PI-MAIL-YES                 VALUE 'Y'.
   977
   978         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   979
   980         16  PI-AR-SYSTEM.
   981             20  PI-AR-PROCESSING-CNTL   PIC X.
   982                 88  PI-AR-PROCESSING        VALUE 'Y'.
   983             20  PI-AR-SUMMARY-CODE      PIC X(6).
   984             20  PI-AR-MONTH-END-DT      PIC XX.
   985
   986         16  PI-MP-SYSTEM.
   987             20  PI-MORTGAGE-USER            PIC X.
   988                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   989                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   990             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   991                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   992                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   993                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   994                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   995                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   996             20  PI-MP-MONTH-END-DT          PIC XX.
   997             20  PI-MP-REFERENCE-NO.
   998                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   999                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1000
  1001         16  PI-LABEL-CONTROL            PIC X(01).
  1002             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1003             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1004
  1005         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1006             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1007
  1008         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1009             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1010             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1011
  1012         16  FILLER                      PIC X(14).
  1013
  1014     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1015******************************************************************
  1016     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1017         16  PI-PYAJ-FILE-SW             PIC  X.
  1018             88  END-OF-ACCT                 VALUE 'A'.
  1019             88  END-OF-ACCT-FULL-PAGE       VALUE 'B'.
  1020             88  END-OF-FILE                 VALUE 'X'.
  1021             88  TOP-OF-FILE                 VALUE 'T'.
  1022             88  PAGE-FULL                   VALUE 'F'.
  1023             88  NO-RECORDS                  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  23
* EL633.cbl
  1024             88  NOT-OPEN                    VALUE 'Z'.
  1025         16  PI-PREV-FUNCTION            PIC  X.
  1026         16  PI-SAV-FUNCTION             PIC  X.
  1027         16  PI-PREV-PFKEY               PIC  X.
  1028         16  PI-SEQ-NOS.
  1029             20  FILLER  OCCURS 13 TIMES
  1030                             INDEXED BY NDX.
  1031                 24  PI-REC-TYPE         PIC  X.
  1032                 24  PI-FILE-SEQ-NO      PIC  S9(8)       COMP.
  1033         16  PI-SAV-ENDING-PYAJ-KEY.
  1034             20  PI-SAV-COMP-CD          PIC  X.
  1035             20  PI-SAV-COMP-CONTROL.
  1036                 24  PI-SAV-CARRIER      PIC  X.
  1037                 24  PI-SAV-GROUPING     PIC  X(6).
  1038                 24  PI-SAV-FIN-RESP     PIC  X(10).
  1039                 24  PI-SAV-ACCOUNT      PIC  X(10).
  1040                 24  PI-SAV-FILE-SEQ-NO  PIC  S9(8)          COMP.
  1041                 24  PI-SAV-RECORD-TYPE  PIC  X.
  1042         16  PI-START-PYAJ-KEY           PIC  X(33).
  1043         16  PI-SAV-ACCT-AMT             PIC  S9(7)V99.
  1044         16  PI-SAV-ACCT-NET             PIC  S9(7)V99.
  1045         16  PI-SAV-PREV-AMT             PIC  S9(7)V99.
  1046         16  PI-SAV-PREV-NET             PIC  S9(7)V99.
  1047         16  PI-TOTAL-DISPLAYED-SW       PIC  X.
  1048             88  PI-TOTAL-DISPLAYED               VALUE 'Y'.
  1049         16  PI-FULL-INDX                PIC  S9(4)      COMP.
  1050         16  PI-FRST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1051         16  PI-FRST-RECORD-TYPE         PIC  X.
  1052         16  PI-PREV-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1053         16  PI-PREV-RECORD-TYPE         PIC  X.
  1054         16  PI-LAST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1055         16  PI-LAST-RECORD-TYPE         PIC  X.
  1056         16  PI-PAGE-SW                  PIC  X.
  1057             88  FIRST-PAGE                          VALUE 'Y'.
  1058         16  FILLER                      PIC  X(450).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  24
* EL633.cbl
  1060*                            COPY ELCJPFX.
  1061******************************************************************
  1062*                                                                *
  1063*                                                                *
  1064*                            ELCJPFX.                            *
  1065*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1066*                            VMOD=2.002                          *
  1067*                                                                *
  1068*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1069*                                                                *
  1070*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1071*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1072*        ELCNTL - CONTROL FILE                                   *
  1073*        ELMSTR - CLAIM MASTERS                                  *
  1074*        ELTRLR - ACTIVITY TRAILERS                              *
  1075*        ELCHKQ - CHECK QUE                                      *
  1076******************************************************************
  1077 01  JOURNAL-RECORD.
  1078     12  jp-date                     pic s9(5) comp-3.
  1079     12  jp-time                     pic s9(7) comp-3.
  1080     12  JP-USER-ID                  PIC X(4).
  1081     12  JP-FILE-ID                  PIC X(8).
  1082     12  JP-PROGRAM-ID               PIC X(8).
  1083     12  JP-RECORD-TYPE              PIC X.
  1084         88 JP-ADD              VALUE 'A'.
  1085         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1086         88 JP-AFTER-CHANGE     VALUE 'C'.
  1087         88 JP-DELETE           VALUE 'D'.
  1088         88 JP-GENERIC-DELETE   VALUE 'G'.
  1089         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1090         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1091     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1092     12  JP-RECORD-AREA
  1093
  1094
  1095                             PIC  X(223).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  25
* EL633.cbl
  1097*                            COPY ELCAID.
  1098******************************************************************
  1099*                                                                *
  1100*                            ELCAID.                             *
  1101*                            VMOD=2.001                          *
  1102*                                                                *
  1103*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1104*                                                                *
  1105*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1106*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1107******************************************************************
  1108
  1109 01  DFHAID.
  1110   02  DFHNULL   PIC  X  VALUE  ' '.
  1111   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1112   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1113   02  DFHPEN    PIC  X  VALUE  '='.
  1114   02  DFHOPID   PIC  X  VALUE  'W'.
  1115   02  DFHPA1    PIC  X  VALUE  '%'.
  1116   02  DFHPA2    PIC  X  VALUE  '>'.
  1117   02  DFHPA3    PIC  X  VALUE  ','.
  1118   02  DFHPF1    PIC  X  VALUE  '1'.
  1119   02  DFHPF2    PIC  X  VALUE  '2'.
  1120   02  DFHPF3    PIC  X  VALUE  '3'.
  1121   02  DFHPF4    PIC  X  VALUE  '4'.
  1122   02  DFHPF5    PIC  X  VALUE  '5'.
  1123   02  DFHPF6    PIC  X  VALUE  '6'.
  1124   02  DFHPF7    PIC  X  VALUE  '7'.
  1125   02  DFHPF8    PIC  X  VALUE  '8'.
  1126   02  DFHPF9    PIC  X  VALUE  '9'.
  1127   02  DFHPF10   PIC  X  VALUE  ':'.
  1128   02  DFHPF11   PIC  X  VALUE  '#'.
  1129   02  DFHPF12   PIC  X  VALUE  '@'.
  1130   02  DFHPF13   PIC  X  VALUE  'A'.
  1131   02  DFHPF14   PIC  X  VALUE  'B'.
  1132   02  DFHPF15   PIC  X  VALUE  'C'.
  1133   02  DFHPF16   PIC  X  VALUE  'D'.
  1134   02  DFHPF17   PIC  X  VALUE  'E'.
  1135   02  DFHPF18   PIC  X  VALUE  'F'.
  1136   02  DFHPF19   PIC  X  VALUE  'G'.
  1137   02  DFHPF20   PIC  X  VALUE  'H'.
  1138   02  DFHPF21   PIC  X  VALUE  'I'.
  1139*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1140   02  DFHPF22   PIC  X  VALUE  '['.
  1141   02  DFHPF23   PIC  X  VALUE  '.'.
  1142   02  DFHPF24   PIC  X  VALUE  '<'.
  1143   02  DFHMSRE   PIC  X  VALUE  'X'.
  1144   02  DFHSTRF   PIC  X  VALUE  'h'.
  1145   02  DFHTRIG   PIC  X  VALUE  '"'.
  1146
  1147 01  FILLER  REDEFINES  DFHAID.
  1148     12  FILLER              PIC  X(8).
  1149     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  26
* EL633.cbl
  1151*                            COPY EL633S.
  1152 01  EL633AI.
  1153     05  FILLER            PIC  X(0012).
  1154*    -------------------------------
  1155     05  DATEL PIC S9(0004) COMP.
  1156     05  DATEF PIC  X(0001).
  1157     05  FILLER REDEFINES DATEF.
  1158         10  DATEA PIC  X(0001).
  1159     05  DATEI PIC  X(0008).
  1160*    -------------------------------
  1161     05  TIMEL PIC S9(0004) COMP.
  1162     05  TIMEF PIC  X(0001).
  1163     05  FILLER REDEFINES TIMEF.
  1164         10  TIMEA PIC  X(0001).
  1165     05  TIMEI PIC  X(0005).
  1166*    -------------------------------
  1167     05  CMPNYIDL PIC S9(0004) COMP.
  1168     05  CMPNYIDF PIC  X(0001).
  1169     05  FILLER REDEFINES CMPNYIDF.
  1170         10  CMPNYIDA PIC  X(0001).
  1171     05  CMPNYIDI PIC  X(0003).
  1172*    -------------------------------
  1173     05  USERIDL PIC S9(0004) COMP.
  1174     05  USERIDF PIC  X(0001).
  1175     05  FILLER REDEFINES USERIDF.
  1176         10  USERIDA PIC  X(0001).
  1177     05  USERIDI PIC  X(0004).
  1178*    -------------------------------
  1179     05  MAINTL PIC S9(0004) COMP.
  1180     05  MAINTF PIC  X(0001).
  1181     05  FILLER REDEFINES MAINTF.
  1182         10  MAINTA PIC  X(0001).
  1183     05  MAINTI PIC  X(0001).
  1184*    -------------------------------
  1185     05  CARRIERL PIC S9(0004) COMP.
  1186     05  CARRIERF PIC  X(0001).
  1187     05  FILLER REDEFINES CARRIERF.
  1188         10  CARRIERA PIC  X(0001).
  1189     05  CARRIERI PIC  X(0001).
  1190*    -------------------------------
  1191     05  GROUPL PIC S9(0004) COMP.
  1192     05  GROUPF PIC  X(0001).
  1193     05  FILLER REDEFINES GROUPF.
  1194         10  GROUPA PIC  X(0001).
  1195     05  GROUPI PIC  X(0006).
  1196*    -------------------------------
  1197     05  FINRESPL PIC S9(0004) COMP.
  1198     05  FINRESPF PIC  X(0001).
  1199     05  FILLER REDEFINES FINRESPF.
  1200         10  FINRESPA PIC  X(0001).
  1201     05  FINRESPI PIC  X(0010).
  1202*    -------------------------------
  1203     05  ACCTL PIC S9(0004) COMP.
  1204     05  ACCTF PIC  X(0001).
  1205     05  FILLER REDEFINES ACCTF.
  1206         10  ACCTA PIC  X(0001).
  1207     05  ACCTI PIC  X(0010).
  1208*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  27
* EL633.cbl
  1209     05  MSAAC1L PIC S9(0004) COMP.
  1210     05  MSAAC1F PIC  X(0001).
  1211     05  FILLER REDEFINES MSAAC1F.
  1212         10  MSAAC1A PIC  X(0001).
  1213     05  MSAAC1I PIC  X(0010).
  1214*    -------------------------------
  1215     05  MSAST1L PIC S9(0004) COMP.
  1216     05  MSAST1F PIC  X(0001).
  1217     05  FILLER REDEFINES MSAST1F.
  1218         10  MSAST1A PIC  X(0001).
  1219     05  MSAST1I PIC  X(0002).
  1220*    -------------------------------
  1221     05  MSACN1L PIC S9(0004) COMP.
  1222     05  MSACN1F PIC  X(0001).
  1223     05  FILLER REDEFINES MSACN1F.
  1224         10  MSACN1A PIC  X(0001).
  1225     05  MSACN1I PIC  X(0001).
  1226*    -------------------------------
  1227     05  MSACM1L PIC S9(0004) COMP.
  1228     05  MSACM1F PIC  X(0001).
  1229     05  FILLER REDEFINES MSACM1F.
  1230         10  MSACM1A PIC  X(0001).
  1231     05  MSACM1I PIC  X(0010).
  1232*    -------------------------------
  1233     05  TYPE1L PIC S9(0004) COMP.
  1234     05  TYPE1F PIC  X(0001).
  1235     05  FILLER REDEFINES TYPE1F.
  1236         10  TYPE1A PIC  X(0001).
  1237     05  TYPE1I PIC  X(0001).
  1238*    -------------------------------
  1239     05  AMT1L PIC S9(0004) COMP.
  1240     05  AMT1F PIC  X(0001).
  1241     05  FILLER REDEFINES AMT1F.
  1242         10  AMT1A PIC  X(0001).
  1243     05  AMT1I PIC  X(0011).
  1244*    -------------------------------
  1245     05  VOID1L PIC S9(0004) COMP.
  1246     05  VOID1F PIC  X(0001).
  1247     05  FILLER REDEFINES VOID1F.
  1248         10  VOID1A PIC  X(0001).
  1249     05  VOID1I PIC  X(0001).
  1250*    -------------------------------
  1251     05  MDT1L PIC S9(0004) COMP.
  1252     05  MDT1F PIC  X(0001).
  1253     05  FILLER REDEFINES MDT1F.
  1254         10  MDT1A PIC  X(0001).
  1255     05  MDT1I PIC  X(0006).
  1256*    -------------------------------
  1257     05  BDT1L PIC S9(0004) COMP.
  1258     05  BDT1F PIC  X(0001).
  1259     05  FILLER REDEFINES BDT1F.
  1260         10  BDT1A PIC  X(0001).
  1261     05  BDT1I PIC  X(0006).
  1262*    -------------------------------
  1263     05  SDT1L PIC S9(0004) COMP.
  1264     05  SDT1F PIC  X(0001).
  1265     05  FILLER REDEFINES SDT1F.
  1266         10  SDT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  28
* EL633.cbl
  1267     05  SDT1I PIC  X(0006).
  1268*    -------------------------------
  1269     05  MSAAC2L PIC S9(0004) COMP.
  1270     05  MSAAC2F PIC  X(0001).
  1271     05  FILLER REDEFINES MSAAC2F.
  1272         10  MSAAC2A PIC  X(0001).
  1273     05  MSAAC2I PIC  X(0010).
  1274*    -------------------------------
  1275     05  MSAST2L PIC S9(0004) COMP.
  1276     05  MSAST2F PIC  X(0001).
  1277     05  FILLER REDEFINES MSAST2F.
  1278         10  MSAST2A PIC  X(0001).
  1279     05  MSAST2I PIC  X(0002).
  1280*    -------------------------------
  1281     05  MSACN2L PIC S9(0004) COMP.
  1282     05  MSACN2F PIC  X(0001).
  1283     05  FILLER REDEFINES MSACN2F.
  1284         10  MSACN2A PIC  X(0001).
  1285     05  MSACN2I PIC  X(0001).
  1286*    -------------------------------
  1287     05  MSACM2L PIC S9(0004) COMP.
  1288     05  MSACM2F PIC  X(0001).
  1289     05  FILLER REDEFINES MSACM2F.
  1290         10  MSACM2A PIC  X(0001).
  1291     05  MSACM2I PIC  X(0010).
  1292*    -------------------------------
  1293     05  TYPE2L PIC S9(0004) COMP.
  1294     05  TYPE2F PIC  X(0001).
  1295     05  FILLER REDEFINES TYPE2F.
  1296         10  TYPE2A PIC  X(0001).
  1297     05  TYPE2I PIC  X(0001).
  1298*    -------------------------------
  1299     05  AMT2L PIC S9(0004) COMP.
  1300     05  AMT2F PIC  X(0001).
  1301     05  FILLER REDEFINES AMT2F.
  1302         10  AMT2A PIC  X(0001).
  1303     05  AMT2I PIC  X(0011).
  1304*    -------------------------------
  1305     05  VOID2L PIC S9(0004) COMP.
  1306     05  VOID2F PIC  X(0001).
  1307     05  FILLER REDEFINES VOID2F.
  1308         10  VOID2A PIC  X(0001).
  1309     05  VOID2I PIC  X(0001).
  1310*    -------------------------------
  1311     05  MDT2L PIC S9(0004) COMP.
  1312     05  MDT2F PIC  X(0001).
  1313     05  FILLER REDEFINES MDT2F.
  1314         10  MDT2A PIC  X(0001).
  1315     05  MDT2I PIC  X(0006).
  1316*    -------------------------------
  1317     05  BDT2L PIC S9(0004) COMP.
  1318     05  BDT2F PIC  X(0001).
  1319     05  FILLER REDEFINES BDT2F.
  1320         10  BDT2A PIC  X(0001).
  1321     05  BDT2I PIC  X(0006).
  1322*    -------------------------------
  1323     05  SDT2L PIC S9(0004) COMP.
  1324     05  SDT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  29
* EL633.cbl
  1325     05  FILLER REDEFINES SDT2F.
  1326         10  SDT2A PIC  X(0001).
  1327     05  SDT2I PIC  X(0006).
  1328*    -------------------------------
  1329     05  MSAAC3L PIC S9(0004) COMP.
  1330     05  MSAAC3F PIC  X(0001).
  1331     05  FILLER REDEFINES MSAAC3F.
  1332         10  MSAAC3A PIC  X(0001).
  1333     05  MSAAC3I PIC  X(0010).
  1334*    -------------------------------
  1335     05  MSAST3L PIC S9(0004) COMP.
  1336     05  MSAST3F PIC  X(0001).
  1337     05  FILLER REDEFINES MSAST3F.
  1338         10  MSAST3A PIC  X(0001).
  1339     05  MSAST3I PIC  X(0002).
  1340*    -------------------------------
  1341     05  MSACN3L PIC S9(0004) COMP.
  1342     05  MSACN3F PIC  X(0001).
  1343     05  FILLER REDEFINES MSACN3F.
  1344         10  MSACN3A PIC  X(0001).
  1345     05  MSACN3I PIC  X(0001).
  1346*    -------------------------------
  1347     05  MSACM3L PIC S9(0004) COMP.
  1348     05  MSACM3F PIC  X(0001).
  1349     05  FILLER REDEFINES MSACM3F.
  1350         10  MSACM3A PIC  X(0001).
  1351     05  MSACM3I PIC  X(0010).
  1352*    -------------------------------
  1353     05  TYPE3L PIC S9(0004) COMP.
  1354     05  TYPE3F PIC  X(0001).
  1355     05  FILLER REDEFINES TYPE3F.
  1356         10  TYPE3A PIC  X(0001).
  1357     05  TYPE3I PIC  X(0001).
  1358*    -------------------------------
  1359     05  AMT3L PIC S9(0004) COMP.
  1360     05  AMT3F PIC  X(0001).
  1361     05  FILLER REDEFINES AMT3F.
  1362         10  AMT3A PIC  X(0001).
  1363     05  AMT3I PIC  X(0011).
  1364*    -------------------------------
  1365     05  VOID3L PIC S9(0004) COMP.
  1366     05  VOID3F PIC  X(0001).
  1367     05  FILLER REDEFINES VOID3F.
  1368         10  VOID3A PIC  X(0001).
  1369     05  VOID3I PIC  X(0001).
  1370*    -------------------------------
  1371     05  MDT3L PIC S9(0004) COMP.
  1372     05  MDT3F PIC  X(0001).
  1373     05  FILLER REDEFINES MDT3F.
  1374         10  MDT3A PIC  X(0001).
  1375     05  MDT3I PIC  X(0006).
  1376*    -------------------------------
  1377     05  BDT3L PIC S9(0004) COMP.
  1378     05  BDT3F PIC  X(0001).
  1379     05  FILLER REDEFINES BDT3F.
  1380         10  BDT3A PIC  X(0001).
  1381     05  BDT3I PIC  X(0006).
  1382*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  30
* EL633.cbl
  1383     05  SDT3L PIC S9(0004) COMP.
  1384     05  SDT3F PIC  X(0001).
  1385     05  FILLER REDEFINES SDT3F.
  1386         10  SDT3A PIC  X(0001).
  1387     05  SDT3I PIC  X(0006).
  1388*    -------------------------------
  1389     05  MSAAC4L PIC S9(0004) COMP.
  1390     05  MSAAC4F PIC  X(0001).
  1391     05  FILLER REDEFINES MSAAC4F.
  1392         10  MSAAC4A PIC  X(0001).
  1393     05  MSAAC4I PIC  X(0010).
  1394*    -------------------------------
  1395     05  MSAST4L PIC S9(0004) COMP.
  1396     05  MSAST4F PIC  X(0001).
  1397     05  FILLER REDEFINES MSAST4F.
  1398         10  MSAST4A PIC  X(0001).
  1399     05  MSAST4I PIC  X(0002).
  1400*    -------------------------------
  1401     05  MSACN4L PIC S9(0004) COMP.
  1402     05  MSACN4F PIC  X(0001).
  1403     05  FILLER REDEFINES MSACN4F.
  1404         10  MSACN4A PIC  X(0001).
  1405     05  MSACN4I PIC  X(0001).
  1406*    -------------------------------
  1407     05  MSACM4L PIC S9(0004) COMP.
  1408     05  MSACM4F PIC  X(0001).
  1409     05  FILLER REDEFINES MSACM4F.
  1410         10  MSACM4A PIC  X(0001).
  1411     05  MSACM4I PIC  X(0010).
  1412*    -------------------------------
  1413     05  TYPE4L PIC S9(0004) COMP.
  1414     05  TYPE4F PIC  X(0001).
  1415     05  FILLER REDEFINES TYPE4F.
  1416         10  TYPE4A PIC  X(0001).
  1417     05  TYPE4I PIC  X(0001).
  1418*    -------------------------------
  1419     05  AMT4L PIC S9(0004) COMP.
  1420     05  AMT4F PIC  X(0001).
  1421     05  FILLER REDEFINES AMT4F.
  1422         10  AMT4A PIC  X(0001).
  1423     05  AMT4I PIC  X(0011).
  1424*    -------------------------------
  1425     05  VOID4L PIC S9(0004) COMP.
  1426     05  VOID4F PIC  X(0001).
  1427     05  FILLER REDEFINES VOID4F.
  1428         10  VOID4A PIC  X(0001).
  1429     05  VOID4I PIC  X(0001).
  1430*    -------------------------------
  1431     05  MDT4L PIC S9(0004) COMP.
  1432     05  MDT4F PIC  X(0001).
  1433     05  FILLER REDEFINES MDT4F.
  1434         10  MDT4A PIC  X(0001).
  1435     05  MDT4I PIC  X(0006).
  1436*    -------------------------------
  1437     05  BDT4L PIC S9(0004) COMP.
  1438     05  BDT4F PIC  X(0001).
  1439     05  FILLER REDEFINES BDT4F.
  1440         10  BDT4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  31
* EL633.cbl
  1441     05  BDT4I PIC  X(0006).
  1442*    -------------------------------
  1443     05  SDT4L PIC S9(0004) COMP.
  1444     05  SDT4F PIC  X(0001).
  1445     05  FILLER REDEFINES SDT4F.
  1446         10  SDT4A PIC  X(0001).
  1447     05  SDT4I PIC  X(0006).
  1448*    -------------------------------
  1449     05  MSAAC5L PIC S9(0004) COMP.
  1450     05  MSAAC5F PIC  X(0001).
  1451     05  FILLER REDEFINES MSAAC5F.
  1452         10  MSAAC5A PIC  X(0001).
  1453     05  MSAAC5I PIC  X(0010).
  1454*    -------------------------------
  1455     05  MSAST5L PIC S9(0004) COMP.
  1456     05  MSAST5F PIC  X(0001).
  1457     05  FILLER REDEFINES MSAST5F.
  1458         10  MSAST5A PIC  X(0001).
  1459     05  MSAST5I PIC  X(0002).
  1460*    -------------------------------
  1461     05  MSACN5L PIC S9(0004) COMP.
  1462     05  MSACN5F PIC  X(0001).
  1463     05  FILLER REDEFINES MSACN5F.
  1464         10  MSACN5A PIC  X(0001).
  1465     05  MSACN5I PIC  X(0001).
  1466*    -------------------------------
  1467     05  MSACM5L PIC S9(0004) COMP.
  1468     05  MSACM5F PIC  X(0001).
  1469     05  FILLER REDEFINES MSACM5F.
  1470         10  MSACM5A PIC  X(0001).
  1471     05  MSACM5I PIC  X(0010).
  1472*    -------------------------------
  1473     05  TYPE5L PIC S9(0004) COMP.
  1474     05  TYPE5F PIC  X(0001).
  1475     05  FILLER REDEFINES TYPE5F.
  1476         10  TYPE5A PIC  X(0001).
  1477     05  TYPE5I PIC  X(0001).
  1478*    -------------------------------
  1479     05  AMT5L PIC S9(0004) COMP.
  1480     05  AMT5F PIC  X(0001).
  1481     05  FILLER REDEFINES AMT5F.
  1482         10  AMT5A PIC  X(0001).
  1483     05  AMT5I PIC  X(0011).
  1484*    -------------------------------
  1485     05  VOID5L PIC S9(0004) COMP.
  1486     05  VOID5F PIC  X(0001).
  1487     05  FILLER REDEFINES VOID5F.
  1488         10  VOID5A PIC  X(0001).
  1489     05  VOID5I PIC  X(0001).
  1490*    -------------------------------
  1491     05  MDT5L PIC S9(0004) COMP.
  1492     05  MDT5F PIC  X(0001).
  1493     05  FILLER REDEFINES MDT5F.
  1494         10  MDT5A PIC  X(0001).
  1495     05  MDT5I PIC  X(0006).
  1496*    -------------------------------
  1497     05  BDT5L PIC S9(0004) COMP.
  1498     05  BDT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  32
* EL633.cbl
  1499     05  FILLER REDEFINES BDT5F.
  1500         10  BDT5A PIC  X(0001).
  1501     05  BDT5I PIC  X(0006).
  1502*    -------------------------------
  1503     05  SDT5L PIC S9(0004) COMP.
  1504     05  SDT5F PIC  X(0001).
  1505     05  FILLER REDEFINES SDT5F.
  1506         10  SDT5A PIC  X(0001).
  1507     05  SDT5I PIC  X(0006).
  1508*    -------------------------------
  1509     05  MSAAC6L PIC S9(0004) COMP.
  1510     05  MSAAC6F PIC  X(0001).
  1511     05  FILLER REDEFINES MSAAC6F.
  1512         10  MSAAC6A PIC  X(0001).
  1513     05  MSAAC6I PIC  X(0010).
  1514*    -------------------------------
  1515     05  MSAST6L PIC S9(0004) COMP.
  1516     05  MSAST6F PIC  X(0001).
  1517     05  FILLER REDEFINES MSAST6F.
  1518         10  MSAST6A PIC  X(0001).
  1519     05  MSAST6I PIC  X(0002).
  1520*    -------------------------------
  1521     05  MSACN6L PIC S9(0004) COMP.
  1522     05  MSACN6F PIC  X(0001).
  1523     05  FILLER REDEFINES MSACN6F.
  1524         10  MSACN6A PIC  X(0001).
  1525     05  MSACN6I PIC  X(0001).
  1526*    -------------------------------
  1527     05  MSACM6L PIC S9(0004) COMP.
  1528     05  MSACM6F PIC  X(0001).
  1529     05  FILLER REDEFINES MSACM6F.
  1530         10  MSACM6A PIC  X(0001).
  1531     05  MSACM6I PIC  X(0010).
  1532*    -------------------------------
  1533     05  TYPE6L PIC S9(0004) COMP.
  1534     05  TYPE6F PIC  X(0001).
  1535     05  FILLER REDEFINES TYPE6F.
  1536         10  TYPE6A PIC  X(0001).
  1537     05  TYPE6I PIC  X(0001).
  1538*    -------------------------------
  1539     05  AMT6L PIC S9(0004) COMP.
  1540     05  AMT6F PIC  X(0001).
  1541     05  FILLER REDEFINES AMT6F.
  1542         10  AMT6A PIC  X(0001).
  1543     05  AMT6I PIC  X(0011).
  1544*    -------------------------------
  1545     05  VOID6L PIC S9(0004) COMP.
  1546     05  VOID6F PIC  X(0001).
  1547     05  FILLER REDEFINES VOID6F.
  1548         10  VOID6A PIC  X(0001).
  1549     05  VOID6I PIC  X(0001).
  1550*    -------------------------------
  1551     05  MDT6L PIC S9(0004) COMP.
  1552     05  MDT6F PIC  X(0001).
  1553     05  FILLER REDEFINES MDT6F.
  1554         10  MDT6A PIC  X(0001).
  1555     05  MDT6I PIC  X(0006).
  1556*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  33
* EL633.cbl
  1557     05  BDT6L PIC S9(0004) COMP.
  1558     05  BDT6F PIC  X(0001).
  1559     05  FILLER REDEFINES BDT6F.
  1560         10  BDT6A PIC  X(0001).
  1561     05  BDT6I PIC  X(0006).
  1562*    -------------------------------
  1563     05  SDT6L PIC S9(0004) COMP.
  1564     05  SDT6F PIC  X(0001).
  1565     05  FILLER REDEFINES SDT6F.
  1566         10  SDT6A PIC  X(0001).
  1567     05  SDT6I PIC  X(0006).
  1568*    -------------------------------
  1569     05  MSAAC7L PIC S9(0004) COMP.
  1570     05  MSAAC7F PIC  X(0001).
  1571     05  FILLER REDEFINES MSAAC7F.
  1572         10  MSAAC7A PIC  X(0001).
  1573     05  MSAAC7I PIC  X(0010).
  1574*    -------------------------------
  1575     05  MSAST7L PIC S9(0004) COMP.
  1576     05  MSAST7F PIC  X(0001).
  1577     05  FILLER REDEFINES MSAST7F.
  1578         10  MSAST7A PIC  X(0001).
  1579     05  MSAST7I PIC  X(0002).
  1580*    -------------------------------
  1581     05  MSACN7L PIC S9(0004) COMP.
  1582     05  MSACN7F PIC  X(0001).
  1583     05  FILLER REDEFINES MSACN7F.
  1584         10  MSACN7A PIC  X(0001).
  1585     05  MSACN7I PIC  X(0001).
  1586*    -------------------------------
  1587     05  MSACM7L PIC S9(0004) COMP.
  1588     05  MSACM7F PIC  X(0001).
  1589     05  FILLER REDEFINES MSACM7F.
  1590         10  MSACM7A PIC  X(0001).
  1591     05  MSACM7I PIC  X(0010).
  1592*    -------------------------------
  1593     05  TYPE7L PIC S9(0004) COMP.
  1594     05  TYPE7F PIC  X(0001).
  1595     05  FILLER REDEFINES TYPE7F.
  1596         10  TYPE7A PIC  X(0001).
  1597     05  TYPE7I PIC  X(0001).
  1598*    -------------------------------
  1599     05  AMT7L PIC S9(0004) COMP.
  1600     05  AMT7F PIC  X(0001).
  1601     05  FILLER REDEFINES AMT7F.
  1602         10  AMT7A PIC  X(0001).
  1603     05  AMT7I PIC  X(0011).
  1604*    -------------------------------
  1605     05  VOID7L PIC S9(0004) COMP.
  1606     05  VOID7F PIC  X(0001).
  1607     05  FILLER REDEFINES VOID7F.
  1608         10  VOID7A PIC  X(0001).
  1609     05  VOID7I PIC  X(0001).
  1610*    -------------------------------
  1611     05  MDT7L PIC S9(0004) COMP.
  1612     05  MDT7F PIC  X(0001).
  1613     05  FILLER REDEFINES MDT7F.
  1614         10  MDT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  34
* EL633.cbl
  1615     05  MDT7I PIC  X(0006).
  1616*    -------------------------------
  1617     05  BDT7L PIC S9(0004) COMP.
  1618     05  BDT7F PIC  X(0001).
  1619     05  FILLER REDEFINES BDT7F.
  1620         10  BDT7A PIC  X(0001).
  1621     05  BDT7I PIC  X(0006).
  1622*    -------------------------------
  1623     05  SDT7L PIC S9(0004) COMP.
  1624     05  SDT7F PIC  X(0001).
  1625     05  FILLER REDEFINES SDT7F.
  1626         10  SDT7A PIC  X(0001).
  1627     05  SDT7I PIC  X(0006).
  1628*    -------------------------------
  1629     05  MSAAC8L PIC S9(0004) COMP.
  1630     05  MSAAC8F PIC  X(0001).
  1631     05  FILLER REDEFINES MSAAC8F.
  1632         10  MSAAC8A PIC  X(0001).
  1633     05  MSAAC8I PIC  X(0010).
  1634*    -------------------------------
  1635     05  MSAST8L PIC S9(0004) COMP.
  1636     05  MSAST8F PIC  X(0001).
  1637     05  FILLER REDEFINES MSAST8F.
  1638         10  MSAST8A PIC  X(0001).
  1639     05  MSAST8I PIC  X(0002).
  1640*    -------------------------------
  1641     05  MSACN8L PIC S9(0004) COMP.
  1642     05  MSACN8F PIC  X(0001).
  1643     05  FILLER REDEFINES MSACN8F.
  1644         10  MSACN8A PIC  X(0001).
  1645     05  MSACN8I PIC  X(0001).
  1646*    -------------------------------
  1647     05  MSACM8L PIC S9(0004) COMP.
  1648     05  MSACM8F PIC  X(0001).
  1649     05  FILLER REDEFINES MSACM8F.
  1650         10  MSACM8A PIC  X(0001).
  1651     05  MSACM8I PIC  X(0010).
  1652*    -------------------------------
  1653     05  TYPE8L PIC S9(0004) COMP.
  1654     05  TYPE8F PIC  X(0001).
  1655     05  FILLER REDEFINES TYPE8F.
  1656         10  TYPE8A PIC  X(0001).
  1657     05  TYPE8I PIC  X(0001).
  1658*    -------------------------------
  1659     05  AMT8L PIC S9(0004) COMP.
  1660     05  AMT8F PIC  X(0001).
  1661     05  FILLER REDEFINES AMT8F.
  1662         10  AMT8A PIC  X(0001).
  1663     05  AMT8I PIC  X(0011).
  1664*    -------------------------------
  1665     05  VOID8L PIC S9(0004) COMP.
  1666     05  VOID8F PIC  X(0001).
  1667     05  FILLER REDEFINES VOID8F.
  1668         10  VOID8A PIC  X(0001).
  1669     05  VOID8I PIC  X(0001).
  1670*    -------------------------------
  1671     05  MDT8L PIC S9(0004) COMP.
  1672     05  MDT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  35
* EL633.cbl
  1673     05  FILLER REDEFINES MDT8F.
  1674         10  MDT8A PIC  X(0001).
  1675     05  MDT8I PIC  X(0006).
  1676*    -------------------------------
  1677     05  BDT8L PIC S9(0004) COMP.
  1678     05  BDT8F PIC  X(0001).
  1679     05  FILLER REDEFINES BDT8F.
  1680         10  BDT8A PIC  X(0001).
  1681     05  BDT8I PIC  X(0006).
  1682*    -------------------------------
  1683     05  SDT8L PIC S9(0004) COMP.
  1684     05  SDT8F PIC  X(0001).
  1685     05  FILLER REDEFINES SDT8F.
  1686         10  SDT8A PIC  X(0001).
  1687     05  SDT8I PIC  X(0006).
  1688*    -------------------------------
  1689     05  MSAAC9L PIC S9(0004) COMP.
  1690     05  MSAAC9F PIC  X(0001).
  1691     05  FILLER REDEFINES MSAAC9F.
  1692         10  MSAAC9A PIC  X(0001).
  1693     05  MSAAC9I PIC  X(0010).
  1694*    -------------------------------
  1695     05  MSAST9L PIC S9(0004) COMP.
  1696     05  MSAST9F PIC  X(0001).
  1697     05  FILLER REDEFINES MSAST9F.
  1698         10  MSAST9A PIC  X(0001).
  1699     05  MSAST9I PIC  X(0002).
  1700*    -------------------------------
  1701     05  MSACN9L PIC S9(0004) COMP.
  1702     05  MSACN9F PIC  X(0001).
  1703     05  FILLER REDEFINES MSACN9F.
  1704         10  MSACN9A PIC  X(0001).
  1705     05  MSACN9I PIC  X(0001).
  1706*    -------------------------------
  1707     05  MSACM9L PIC S9(0004) COMP.
  1708     05  MSACM9F PIC  X(0001).
  1709     05  FILLER REDEFINES MSACM9F.
  1710         10  MSACM9A PIC  X(0001).
  1711     05  MSACM9I PIC  X(0010).
  1712*    -------------------------------
  1713     05  TYPE9L PIC S9(0004) COMP.
  1714     05  TYPE9F PIC  X(0001).
  1715     05  FILLER REDEFINES TYPE9F.
  1716         10  TYPE9A PIC  X(0001).
  1717     05  TYPE9I PIC  X(0001).
  1718*    -------------------------------
  1719     05  AMT9L PIC S9(0004) COMP.
  1720     05  AMT9F PIC  X(0001).
  1721     05  FILLER REDEFINES AMT9F.
  1722         10  AMT9A PIC  X(0001).
  1723     05  AMT9I PIC  X(0011).
  1724*    -------------------------------
  1725     05  VOID9L PIC S9(0004) COMP.
  1726     05  VOID9F PIC  X(0001).
  1727     05  FILLER REDEFINES VOID9F.
  1728         10  VOID9A PIC  X(0001).
  1729     05  VOID9I PIC  X(0001).
  1730*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  36
* EL633.cbl
  1731     05  MDT9L PIC S9(0004) COMP.
  1732     05  MDT9F PIC  X(0001).
  1733     05  FILLER REDEFINES MDT9F.
  1734         10  MDT9A PIC  X(0001).
  1735     05  MDT9I PIC  X(0006).
  1736*    -------------------------------
  1737     05  BDT9L PIC S9(0004) COMP.
  1738     05  BDT9F PIC  X(0001).
  1739     05  FILLER REDEFINES BDT9F.
  1740         10  BDT9A PIC  X(0001).
  1741     05  BDT9I PIC  X(0006).
  1742*    -------------------------------
  1743     05  SDT9L PIC S9(0004) COMP.
  1744     05  SDT9F PIC  X(0001).
  1745     05  FILLER REDEFINES SDT9F.
  1746         10  SDT9A PIC  X(0001).
  1747     05  SDT9I PIC  X(0006).
  1748*    -------------------------------
  1749     05  MSAAC10L PIC S9(0004) COMP.
  1750     05  MSAAC10F PIC  X(0001).
  1751     05  FILLER REDEFINES MSAAC10F.
  1752         10  MSAAC10A PIC  X(0001).
  1753     05  MSAAC10I PIC  X(0010).
  1754*    -------------------------------
  1755     05  MSAST10L PIC S9(0004) COMP.
  1756     05  MSAST10F PIC  X(0001).
  1757     05  FILLER REDEFINES MSAST10F.
  1758         10  MSAST10A PIC  X(0001).
  1759     05  MSAST10I PIC  X(0002).
  1760*    -------------------------------
  1761     05  MSACN10L PIC S9(0004) COMP.
  1762     05  MSACN10F PIC  X(0001).
  1763     05  FILLER REDEFINES MSACN10F.
  1764         10  MSACN10A PIC  X(0001).
  1765     05  MSACN10I PIC  X(0001).
  1766*    -------------------------------
  1767     05  MSACM10L PIC S9(0004) COMP.
  1768     05  MSACM10F PIC  X(0001).
  1769     05  FILLER REDEFINES MSACM10F.
  1770         10  MSACM10A PIC  X(0001).
  1771     05  MSACM10I PIC  X(0010).
  1772*    -------------------------------
  1773     05  TYPE10L PIC S9(0004) COMP.
  1774     05  TYPE10F PIC  X(0001).
  1775     05  FILLER REDEFINES TYPE10F.
  1776         10  TYPE10A PIC  X(0001).
  1777     05  TYPE10I PIC  X(0001).
  1778*    -------------------------------
  1779     05  AMT10L PIC S9(0004) COMP.
  1780     05  AMT10F PIC  X(0001).
  1781     05  FILLER REDEFINES AMT10F.
  1782         10  AMT10A PIC  X(0001).
  1783     05  AMT10I PIC  X(0011).
  1784*    -------------------------------
  1785     05  VOID10L PIC S9(0004) COMP.
  1786     05  VOID10F PIC  X(0001).
  1787     05  FILLER REDEFINES VOID10F.
  1788         10  VOID10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  37
* EL633.cbl
  1789     05  VOID10I PIC  X(0001).
  1790*    -------------------------------
  1791     05  MDT10L PIC S9(0004) COMP.
  1792     05  MDT10F PIC  X(0001).
  1793     05  FILLER REDEFINES MDT10F.
  1794         10  MDT10A PIC  X(0001).
  1795     05  MDT10I PIC  X(0006).
  1796*    -------------------------------
  1797     05  BDT10L PIC S9(0004) COMP.
  1798     05  BDT10F PIC  X(0001).
  1799     05  FILLER REDEFINES BDT10F.
  1800         10  BDT10A PIC  X(0001).
  1801     05  BDT10I PIC  X(0006).
  1802*    -------------------------------
  1803     05  SDT10L PIC S9(0004) COMP.
  1804     05  SDT10F PIC  X(0001).
  1805     05  FILLER REDEFINES SDT10F.
  1806         10  SDT10A PIC  X(0001).
  1807     05  SDT10I PIC  X(0006).
  1808*    -------------------------------
  1809     05  MSAAC11L PIC S9(0004) COMP.
  1810     05  MSAAC11F PIC  X(0001).
  1811     05  FILLER REDEFINES MSAAC11F.
  1812         10  MSAAC11A PIC  X(0001).
  1813     05  MSAAC11I PIC  X(0010).
  1814*    -------------------------------
  1815     05  MSAST11L PIC S9(0004) COMP.
  1816     05  MSAST11F PIC  X(0001).
  1817     05  FILLER REDEFINES MSAST11F.
  1818         10  MSAST11A PIC  X(0001).
  1819     05  MSAST11I PIC  X(0002).
  1820*    -------------------------------
  1821     05  MSACN11L PIC S9(0004) COMP.
  1822     05  MSACN11F PIC  X(0001).
  1823     05  FILLER REDEFINES MSACN11F.
  1824         10  MSACN11A PIC  X(0001).
  1825     05  MSACN11I PIC  X(0001).
  1826*    -------------------------------
  1827     05  MSACM11L PIC S9(0004) COMP.
  1828     05  MSACM11F PIC  X(0001).
  1829     05  FILLER REDEFINES MSACM11F.
  1830         10  MSACM11A PIC  X(0001).
  1831     05  MSACM11I PIC  X(0010).
  1832*    -------------------------------
  1833     05  TYPE11L PIC S9(0004) COMP.
  1834     05  TYPE11F PIC  X(0001).
  1835     05  FILLER REDEFINES TYPE11F.
  1836         10  TYPE11A PIC  X(0001).
  1837     05  TYPE11I PIC  X(0001).
  1838*    -------------------------------
  1839     05  AMT11L PIC S9(0004) COMP.
  1840     05  AMT11F PIC  X(0001).
  1841     05  FILLER REDEFINES AMT11F.
  1842         10  AMT11A PIC  X(0001).
  1843     05  AMT11I PIC  X(0011).
  1844*    -------------------------------
  1845     05  VOID11L PIC S9(0004) COMP.
  1846     05  VOID11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  38
* EL633.cbl
  1847     05  FILLER REDEFINES VOID11F.
  1848         10  VOID11A PIC  X(0001).
  1849     05  VOID11I PIC  X(0001).
  1850*    -------------------------------
  1851     05  MDT11L PIC S9(0004) COMP.
  1852     05  MDT11F PIC  X(0001).
  1853     05  FILLER REDEFINES MDT11F.
  1854         10  MDT11A PIC  X(0001).
  1855     05  MDT11I PIC  X(0006).
  1856*    -------------------------------
  1857     05  BDT11L PIC S9(0004) COMP.
  1858     05  BDT11F PIC  X(0001).
  1859     05  FILLER REDEFINES BDT11F.
  1860         10  BDT11A PIC  X(0001).
  1861     05  BDT11I PIC  X(0006).
  1862*    -------------------------------
  1863     05  SDT11L PIC S9(0004) COMP.
  1864     05  SDT11F PIC  X(0001).
  1865     05  FILLER REDEFINES SDT11F.
  1866         10  SDT11A PIC  X(0001).
  1867     05  SDT11I PIC  X(0006).
  1868*    -------------------------------
  1869     05  MSAAC12L PIC S9(0004) COMP.
  1870     05  MSAAC12F PIC  X(0001).
  1871     05  FILLER REDEFINES MSAAC12F.
  1872         10  MSAAC12A PIC  X(0001).
  1873     05  MSAAC12I PIC  X(0010).
  1874*    -------------------------------
  1875     05  MSAST12L PIC S9(0004) COMP.
  1876     05  MSAST12F PIC  X(0001).
  1877     05  FILLER REDEFINES MSAST12F.
  1878         10  MSAST12A PIC  X(0001).
  1879     05  MSAST12I PIC  X(0002).
  1880*    -------------------------------
  1881     05  MSACN12L PIC S9(0004) COMP.
  1882     05  MSACN12F PIC  X(0001).
  1883     05  FILLER REDEFINES MSACN12F.
  1884         10  MSACN12A PIC  X(0001).
  1885     05  MSACN12I PIC  X(0001).
  1886*    -------------------------------
  1887     05  MSACM12L PIC S9(0004) COMP.
  1888     05  MSACM12F PIC  X(0001).
  1889     05  FILLER REDEFINES MSACM12F.
  1890         10  MSACM12A PIC  X(0001).
  1891     05  MSACM12I PIC  X(0010).
  1892*    -------------------------------
  1893     05  TYPE12L PIC S9(0004) COMP.
  1894     05  TYPE12F PIC  X(0001).
  1895     05  FILLER REDEFINES TYPE12F.
  1896         10  TYPE12A PIC  X(0001).
  1897     05  TYPE12I PIC  X(0001).
  1898*    -------------------------------
  1899     05  AMT12L PIC S9(0004) COMP.
  1900     05  AMT12F PIC  X(0001).
  1901     05  FILLER REDEFINES AMT12F.
  1902         10  AMT12A PIC  X(0001).
  1903     05  AMT12I PIC  X(0011).
  1904*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  39
* EL633.cbl
  1905     05  VOID12L PIC S9(0004) COMP.
  1906     05  VOID12F PIC  X(0001).
  1907     05  FILLER REDEFINES VOID12F.
  1908         10  VOID12A PIC  X(0001).
  1909     05  VOID12I PIC  X(0001).
  1910*    -------------------------------
  1911     05  MDT12L PIC S9(0004) COMP.
  1912     05  MDT12F PIC  X(0001).
  1913     05  FILLER REDEFINES MDT12F.
  1914         10  MDT12A PIC  X(0001).
  1915     05  MDT12I PIC  X(0006).
  1916*    -------------------------------
  1917     05  BDT12L PIC S9(0004) COMP.
  1918     05  BDT12F PIC  X(0001).
  1919     05  FILLER REDEFINES BDT12F.
  1920         10  BDT12A PIC  X(0001).
  1921     05  BDT12I PIC  X(0006).
  1922*    -------------------------------
  1923     05  SDT12L PIC S9(0004) COMP.
  1924     05  SDT12F PIC  X(0001).
  1925     05  FILLER REDEFINES SDT12F.
  1926         10  SDT12A PIC  X(0001).
  1927     05  SDT12I PIC  X(0006).
  1928*    -------------------------------
  1929     05  MSAAC13L PIC S9(0004) COMP.
  1930     05  MSAAC13F PIC  X(0001).
  1931     05  FILLER REDEFINES MSAAC13F.
  1932         10  MSAAC13A PIC  X(0001).
  1933     05  MSAAC13I PIC  X(0010).
  1934*    -------------------------------
  1935     05  MSAST13L PIC S9(0004) COMP.
  1936     05  MSAST13F PIC  X(0001).
  1937     05  FILLER REDEFINES MSAST13F.
  1938         10  MSAST13A PIC  X(0001).
  1939     05  MSAST13I PIC  X(0002).
  1940*    -------------------------------
  1941     05  MSACN13L PIC S9(0004) COMP.
  1942     05  MSACN13F PIC  X(0001).
  1943     05  FILLER REDEFINES MSACN13F.
  1944         10  MSACN13A PIC  X(0001).
  1945     05  MSACN13I PIC  X(0001).
  1946*    -------------------------------
  1947     05  MSACM13L PIC S9(0004) COMP.
  1948     05  MSACM13F PIC  X(0001).
  1949     05  FILLER REDEFINES MSACM13F.
  1950         10  MSACM13A PIC  X(0001).
  1951     05  MSACM13I PIC  X(0010).
  1952*    -------------------------------
  1953     05  TYPE13L PIC S9(0004) COMP.
  1954     05  TYPE13F PIC  X(0001).
  1955     05  FILLER REDEFINES TYPE13F.
  1956         10  TYPE13A PIC  X(0001).
  1957     05  TYPE13I PIC  X(0001).
  1958*    -------------------------------
  1959     05  AMT13L PIC S9(0004) COMP.
  1960     05  AMT13F PIC  X(0001).
  1961     05  FILLER REDEFINES AMT13F.
  1962         10  AMT13A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  40
* EL633.cbl
  1963     05  AMT13I PIC  X(0011).
  1964*    -------------------------------
  1965     05  VOID13L PIC S9(0004) COMP.
  1966     05  VOID13F PIC  X(0001).
  1967     05  FILLER REDEFINES VOID13F.
  1968         10  VOID13A PIC  X(0001).
  1969     05  VOID13I PIC  X(0001).
  1970*    -------------------------------
  1971     05  MDT13L PIC S9(0004) COMP.
  1972     05  MDT13F PIC  X(0001).
  1973     05  FILLER REDEFINES MDT13F.
  1974         10  MDT13A PIC  X(0001).
  1975     05  MDT13I PIC  X(0006).
  1976*    -------------------------------
  1977     05  BDT13L PIC S9(0004) COMP.
  1978     05  BDT13F PIC  X(0001).
  1979     05  FILLER REDEFINES BDT13F.
  1980         10  BDT13A PIC  X(0001).
  1981     05  BDT13I PIC  X(0006).
  1982*    -------------------------------
  1983     05  SDT13L PIC S9(0004) COMP.
  1984     05  SDT13F PIC  X(0001).
  1985     05  FILLER REDEFINES SDT13F.
  1986         10  SDT13A PIC  X(0001).
  1987     05  SDT13I PIC  X(0006).
  1988*    -------------------------------
  1989     05  ERRMSG1L PIC S9(0004) COMP.
  1990     05  ERRMSG1F PIC  X(0001).
  1991     05  FILLER REDEFINES ERRMSG1F.
  1992         10  ERRMSG1A PIC  X(0001).
  1993     05  ERRMSG1I PIC  X(0079).
  1994*    -------------------------------
  1995     05  ERRMSG2L PIC S9(0004) COMP.
  1996     05  ERRMSG2F PIC  X(0001).
  1997     05  FILLER REDEFINES ERRMSG2F.
  1998         10  ERRMSG2A PIC  X(0001).
  1999     05  ERRMSG2I PIC  X(0079).
  2000*    -------------------------------
  2001     05  PFENTERL PIC S9(0004) COMP.
  2002     05  PFENTERF PIC  X(0001).
  2003     05  FILLER REDEFINES PFENTERF.
  2004         10  PFENTERA PIC  X(0001).
  2005     05  PFENTERI PIC  9(2).
  2006 01  EL633AO REDEFINES EL633AI.
  2007     05  FILLER            PIC  X(0012).
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  DATEO PIC  X(0008).
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  TIMEO PIC  99.99.
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  CMPNYIDO PIC  X(0003).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  USERIDO PIC  X(0004).
  2020*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  41
* EL633.cbl
  2021     05  FILLER            PIC  X(0003).
  2022     05  MAINTO PIC  X(0001).
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  CARRIERO PIC  X(0001).
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  GROUPO PIC  X(0006).
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  FINRESPO PIC  X(0010).
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  ACCTO PIC  X(0010).
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  MSAAC1O PIC  X(0010).
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  MSAST1O PIC  X(0002).
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  MSACN1O PIC  X(0001).
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  MSACM1O PIC  X(0010).
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  TYPE1O PIC  X(0001).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  AMT1O PIC  X(0011).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  VOID1O PIC  X(0001).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  MDT1O PIC  X(0006).
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  BDT1O PIC  X(0006).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  SDT1O PIC  X(0006).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  MSAAC2O PIC  X(0010).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  MSAST2O PIC  X(0002).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  MSACN2O PIC  X(0001).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  MSACM2O PIC  X(0010).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  42
* EL633.cbl
  2079     05  TYPE2O PIC  X(0001).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  AMT2O PIC  X(0011).
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  VOID2O PIC  X(0001).
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  MDT2O PIC  X(0006).
  2089*    -------------------------------
  2090     05  FILLER            PIC  X(0003).
  2091     05  BDT2O PIC  X(0006).
  2092*    -------------------------------
  2093     05  FILLER            PIC  X(0003).
  2094     05  SDT2O PIC  X(0006).
  2095*    -------------------------------
  2096     05  FILLER            PIC  X(0003).
  2097     05  MSAAC3O PIC  X(0010).
  2098*    -------------------------------
  2099     05  FILLER            PIC  X(0003).
  2100     05  MSAST3O PIC  X(0002).
  2101*    -------------------------------
  2102     05  FILLER            PIC  X(0003).
  2103     05  MSACN3O PIC  X(0001).
  2104*    -------------------------------
  2105     05  FILLER            PIC  X(0003).
  2106     05  MSACM3O PIC  X(0010).
  2107*    -------------------------------
  2108     05  FILLER            PIC  X(0003).
  2109     05  TYPE3O PIC  X(0001).
  2110*    -------------------------------
  2111     05  FILLER            PIC  X(0003).
  2112     05  AMT3O PIC  X(0011).
  2113*    -------------------------------
  2114     05  FILLER            PIC  X(0003).
  2115     05  VOID3O PIC  X(0001).
  2116*    -------------------------------
  2117     05  FILLER            PIC  X(0003).
  2118     05  MDT3O PIC  X(0006).
  2119*    -------------------------------
  2120     05  FILLER            PIC  X(0003).
  2121     05  BDT3O PIC  X(0006).
  2122*    -------------------------------
  2123     05  FILLER            PIC  X(0003).
  2124     05  SDT3O PIC  X(0006).
  2125*    -------------------------------
  2126     05  FILLER            PIC  X(0003).
  2127     05  MSAAC4O PIC  X(0010).
  2128*    -------------------------------
  2129     05  FILLER            PIC  X(0003).
  2130     05  MSAST4O PIC  X(0002).
  2131*    -------------------------------
  2132     05  FILLER            PIC  X(0003).
  2133     05  MSACN4O PIC  X(0001).
  2134*    -------------------------------
  2135     05  FILLER            PIC  X(0003).
  2136     05  MSACM4O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  43
* EL633.cbl
  2137*    -------------------------------
  2138     05  FILLER            PIC  X(0003).
  2139     05  TYPE4O PIC  X(0001).
  2140*    -------------------------------
  2141     05  FILLER            PIC  X(0003).
  2142     05  AMT4O PIC  X(0011).
  2143*    -------------------------------
  2144     05  FILLER            PIC  X(0003).
  2145     05  VOID4O PIC  X(0001).
  2146*    -------------------------------
  2147     05  FILLER            PIC  X(0003).
  2148     05  MDT4O PIC  X(0006).
  2149*    -------------------------------
  2150     05  FILLER            PIC  X(0003).
  2151     05  BDT4O PIC  X(0006).
  2152*    -------------------------------
  2153     05  FILLER            PIC  X(0003).
  2154     05  SDT4O PIC  X(0006).
  2155*    -------------------------------
  2156     05  FILLER            PIC  X(0003).
  2157     05  MSAAC5O PIC  X(0010).
  2158*    -------------------------------
  2159     05  FILLER            PIC  X(0003).
  2160     05  MSAST5O PIC  X(0002).
  2161*    -------------------------------
  2162     05  FILLER            PIC  X(0003).
  2163     05  MSACN5O PIC  X(0001).
  2164*    -------------------------------
  2165     05  FILLER            PIC  X(0003).
  2166     05  MSACM5O PIC  X(0010).
  2167*    -------------------------------
  2168     05  FILLER            PIC  X(0003).
  2169     05  TYPE5O PIC  X(0001).
  2170*    -------------------------------
  2171     05  FILLER            PIC  X(0003).
  2172     05  AMT5O PIC  X(0011).
  2173*    -------------------------------
  2174     05  FILLER            PIC  X(0003).
  2175     05  VOID5O PIC  X(0001).
  2176*    -------------------------------
  2177     05  FILLER            PIC  X(0003).
  2178     05  MDT5O PIC  X(0006).
  2179*    -------------------------------
  2180     05  FILLER            PIC  X(0003).
  2181     05  BDT5O PIC  X(0006).
  2182*    -------------------------------
  2183     05  FILLER            PIC  X(0003).
  2184     05  SDT5O PIC  X(0006).
  2185*    -------------------------------
  2186     05  FILLER            PIC  X(0003).
  2187     05  MSAAC6O PIC  X(0010).
  2188*    -------------------------------
  2189     05  FILLER            PIC  X(0003).
  2190     05  MSAST6O PIC  X(0002).
  2191*    -------------------------------
  2192     05  FILLER            PIC  X(0003).
  2193     05  MSACN6O PIC  X(0001).
  2194*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  44
* EL633.cbl
  2195     05  FILLER            PIC  X(0003).
  2196     05  MSACM6O PIC  X(0010).
  2197*    -------------------------------
  2198     05  FILLER            PIC  X(0003).
  2199     05  TYPE6O PIC  X(0001).
  2200*    -------------------------------
  2201     05  FILLER            PIC  X(0003).
  2202     05  AMT6O PIC  X(0011).
  2203*    -------------------------------
  2204     05  FILLER            PIC  X(0003).
  2205     05  VOID6O PIC  X(0001).
  2206*    -------------------------------
  2207     05  FILLER            PIC  X(0003).
  2208     05  MDT6O PIC  X(0006).
  2209*    -------------------------------
  2210     05  FILLER            PIC  X(0003).
  2211     05  BDT6O PIC  X(0006).
  2212*    -------------------------------
  2213     05  FILLER            PIC  X(0003).
  2214     05  SDT6O PIC  X(0006).
  2215*    -------------------------------
  2216     05  FILLER            PIC  X(0003).
  2217     05  MSAAC7O PIC  X(0010).
  2218*    -------------------------------
  2219     05  FILLER            PIC  X(0003).
  2220     05  MSAST7O PIC  X(0002).
  2221*    -------------------------------
  2222     05  FILLER            PIC  X(0003).
  2223     05  MSACN7O PIC  X(0001).
  2224*    -------------------------------
  2225     05  FILLER            PIC  X(0003).
  2226     05  MSACM7O PIC  X(0010).
  2227*    -------------------------------
  2228     05  FILLER            PIC  X(0003).
  2229     05  TYPE7O PIC  X(0001).
  2230*    -------------------------------
  2231     05  FILLER            PIC  X(0003).
  2232     05  AMT7O PIC  X(0011).
  2233*    -------------------------------
  2234     05  FILLER            PIC  X(0003).
  2235     05  VOID7O PIC  X(0001).
  2236*    -------------------------------
  2237     05  FILLER            PIC  X(0003).
  2238     05  MDT7O PIC  X(0006).
  2239*    -------------------------------
  2240     05  FILLER            PIC  X(0003).
  2241     05  BDT7O PIC  X(0006).
  2242*    -------------------------------
  2243     05  FILLER            PIC  X(0003).
  2244     05  SDT7O PIC  X(0006).
  2245*    -------------------------------
  2246     05  FILLER            PIC  X(0003).
  2247     05  MSAAC8O PIC  X(0010).
  2248*    -------------------------------
  2249     05  FILLER            PIC  X(0003).
  2250     05  MSAST8O PIC  X(0002).
  2251*    -------------------------------
  2252     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  45
* EL633.cbl
  2253     05  MSACN8O PIC  X(0001).
  2254*    -------------------------------
  2255     05  FILLER            PIC  X(0003).
  2256     05  MSACM8O PIC  X(0010).
  2257*    -------------------------------
  2258     05  FILLER            PIC  X(0003).
  2259     05  TYPE8O PIC  X(0001).
  2260*    -------------------------------
  2261     05  FILLER            PIC  X(0003).
  2262     05  AMT8O PIC  X(0011).
  2263*    -------------------------------
  2264     05  FILLER            PIC  X(0003).
  2265     05  VOID8O PIC  X(0001).
  2266*    -------------------------------
  2267     05  FILLER            PIC  X(0003).
  2268     05  MDT8O PIC  X(0006).
  2269*    -------------------------------
  2270     05  FILLER            PIC  X(0003).
  2271     05  BDT8O PIC  X(0006).
  2272*    -------------------------------
  2273     05  FILLER            PIC  X(0003).
  2274     05  SDT8O PIC  X(0006).
  2275*    -------------------------------
  2276     05  FILLER            PIC  X(0003).
  2277     05  MSAAC9O PIC  X(0010).
  2278*    -------------------------------
  2279     05  FILLER            PIC  X(0003).
  2280     05  MSAST9O PIC  X(0002).
  2281*    -------------------------------
  2282     05  FILLER            PIC  X(0003).
  2283     05  MSACN9O PIC  X(0001).
  2284*    -------------------------------
  2285     05  FILLER            PIC  X(0003).
  2286     05  MSACM9O PIC  X(0010).
  2287*    -------------------------------
  2288     05  FILLER            PIC  X(0003).
  2289     05  TYPE9O PIC  X(0001).
  2290*    -------------------------------
  2291     05  FILLER            PIC  X(0003).
  2292     05  AMT9O PIC  X(0011).
  2293*    -------------------------------
  2294     05  FILLER            PIC  X(0003).
  2295     05  VOID9O PIC  X(0001).
  2296*    -------------------------------
  2297     05  FILLER            PIC  X(0003).
  2298     05  MDT9O PIC  X(0006).
  2299*    -------------------------------
  2300     05  FILLER            PIC  X(0003).
  2301     05  BDT9O PIC  X(0006).
  2302*    -------------------------------
  2303     05  FILLER            PIC  X(0003).
  2304     05  SDT9O PIC  X(0006).
  2305*    -------------------------------
  2306     05  FILLER            PIC  X(0003).
  2307     05  MSAAC10O PIC  X(0010).
  2308*    -------------------------------
  2309     05  FILLER            PIC  X(0003).
  2310     05  MSAST10O PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  46
* EL633.cbl
  2311*    -------------------------------
  2312     05  FILLER            PIC  X(0003).
  2313     05  MSACN10O PIC  X(0001).
  2314*    -------------------------------
  2315     05  FILLER            PIC  X(0003).
  2316     05  MSACM10O PIC  X(0010).
  2317*    -------------------------------
  2318     05  FILLER            PIC  X(0003).
  2319     05  TYPE10O PIC  X(0001).
  2320*    -------------------------------
  2321     05  FILLER            PIC  X(0003).
  2322     05  AMT10O PIC  X(0011).
  2323*    -------------------------------
  2324     05  FILLER            PIC  X(0003).
  2325     05  VOID10O PIC  X(0001).
  2326*    -------------------------------
  2327     05  FILLER            PIC  X(0003).
  2328     05  MDT10O PIC  X(0006).
  2329*    -------------------------------
  2330     05  FILLER            PIC  X(0003).
  2331     05  BDT10O PIC  X(0006).
  2332*    -------------------------------
  2333     05  FILLER            PIC  X(0003).
  2334     05  SDT10O PIC  X(0006).
  2335*    -------------------------------
  2336     05  FILLER            PIC  X(0003).
  2337     05  MSAAC11O PIC  X(0010).
  2338*    -------------------------------
  2339     05  FILLER            PIC  X(0003).
  2340     05  MSAST11O PIC  X(0002).
  2341*    -------------------------------
  2342     05  FILLER            PIC  X(0003).
  2343     05  MSACN11O PIC  X(0001).
  2344*    -------------------------------
  2345     05  FILLER            PIC  X(0003).
  2346     05  MSACM11O PIC  X(0010).
  2347*    -------------------------------
  2348     05  FILLER            PIC  X(0003).
  2349     05  TYPE11O PIC  X(0001).
  2350*    -------------------------------
  2351     05  FILLER            PIC  X(0003).
  2352     05  AMT11O PIC  X(0011).
  2353*    -------------------------------
  2354     05  FILLER            PIC  X(0003).
  2355     05  VOID11O PIC  X(0001).
  2356*    -------------------------------
  2357     05  FILLER            PIC  X(0003).
  2358     05  MDT11O PIC  X(0006).
  2359*    -------------------------------
  2360     05  FILLER            PIC  X(0003).
  2361     05  BDT11O PIC  X(0006).
  2362*    -------------------------------
  2363     05  FILLER            PIC  X(0003).
  2364     05  SDT11O PIC  X(0006).
  2365*    -------------------------------
  2366     05  FILLER            PIC  X(0003).
  2367     05  MSAAC12O PIC  X(0010).
  2368*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  47
* EL633.cbl
  2369     05  FILLER            PIC  X(0003).
  2370     05  MSAST12O PIC  X(0002).
  2371*    -------------------------------
  2372     05  FILLER            PIC  X(0003).
  2373     05  MSACN12O PIC  X(0001).
  2374*    -------------------------------
  2375     05  FILLER            PIC  X(0003).
  2376     05  MSACM12O PIC  X(0010).
  2377*    -------------------------------
  2378     05  FILLER            PIC  X(0003).
  2379     05  TYPE12O PIC  X(0001).
  2380*    -------------------------------
  2381     05  FILLER            PIC  X(0003).
  2382     05  AMT12O PIC  X(0011).
  2383*    -------------------------------
  2384     05  FILLER            PIC  X(0003).
  2385     05  VOID12O PIC  X(0001).
  2386*    -------------------------------
  2387     05  FILLER            PIC  X(0003).
  2388     05  MDT12O PIC  X(0006).
  2389*    -------------------------------
  2390     05  FILLER            PIC  X(0003).
  2391     05  BDT12O PIC  X(0006).
  2392*    -------------------------------
  2393     05  FILLER            PIC  X(0003).
  2394     05  SDT12O PIC  X(0006).
  2395*    -------------------------------
  2396     05  FILLER            PIC  X(0003).
  2397     05  MSAAC13O PIC  X(0010).
  2398*    -------------------------------
  2399     05  FILLER            PIC  X(0003).
  2400     05  MSAST13O PIC  X(0002).
  2401*    -------------------------------
  2402     05  FILLER            PIC  X(0003).
  2403     05  MSACN13O PIC  X(0001).
  2404*    -------------------------------
  2405     05  FILLER            PIC  X(0003).
  2406     05  MSACM13O PIC  X(0010).
  2407*    -------------------------------
  2408     05  FILLER            PIC  X(0003).
  2409     05  TYPE13O PIC  X(0001).
  2410*    -------------------------------
  2411     05  FILLER            PIC  X(0003).
  2412     05  AMT13O PIC  X(0011).
  2413*    -------------------------------
  2414     05  FILLER            PIC  X(0003).
  2415     05  VOID13O PIC  X(0001).
  2416*    -------------------------------
  2417     05  FILLER            PIC  X(0003).
  2418     05  MDT13O PIC  X(0006).
  2419*    -------------------------------
  2420     05  FILLER            PIC  X(0003).
  2421     05  BDT13O PIC  X(0006).
  2422*    -------------------------------
  2423     05  FILLER            PIC  X(0003).
  2424     05  SDT13O PIC  X(0006).
  2425*    -------------------------------
  2426     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  48
* EL633.cbl
  2427     05  ERRMSG1O PIC  X(0079).
  2428*    -------------------------------
  2429     05  FILLER            PIC  X(0003).
  2430     05  ERRMSG2O PIC  X(0079).
  2431*    -------------------------------
  2432     05  FILLER            PIC  X(0003).
  2433     05  PFENTERO PIC  X(0002).
  2434*    -------------------------------
  2435
  2436 01  MAP-EL633A  REDEFINES  EL633AI.
  2437     12  FILLER                  PIC  X(87).
  2438     12  DATA-AREA       OCCURS 13 TIMES
  2439                             INDEXED BY PINDX.
  2440         16  GL-ACCT-LEN         PIC S9(4)              COMP.
  2441         16  GL-ACCT-ATTRB       PIC  X.
  2442         16  GL-ACCT             PIC  X(10).
  2443         16  WSL-COMM  REDEFINES GL-ACCT.
  2444             20  WSL-COMM-DTE.
  2445                 24  WSL-MO      PIC  X(2).
  2446                 24  WSL-DA      PIC  X(2).
  2447                 24  WSL-YR      PIC  X(2).
  2448             20  WSL-COMM-REST   PIC  X(4).
  2449         16  GL-STATE-LEN        PIC S9(4)              COMP.
  2450         16  GL-STATE-ATTRB      PIC  X.
  2451         16  GL-STATE            PIC  X(02).
  2452         16  GL-CANC-LEN         PIC S9(4)              COMP.
  2453         16  GL-CANC-ATTRB       PIC  X.
  2454         16  GL-CANC             PIC  X.
  2455         16  GL-COMM-LEN         PIC S9(4)              COMP.
  2456         16  GL-COMM-ATTRB       PIC  X.
  2457         16  GL-COMM             PIC  X(10).
  2458         16  RTYPE-LEN           PIC S9(4)              COMP.
  2459         16  RTYPE-ATTRB         PIC  X.
  2460         16  RTYPE               PIC  X.
  2461         16  AMT-LEN             PIC S9(4)              COMP.
  2462         16  AMT-ATTRB           PIC  X.
  2463         16  AMT                 PIC S9(9)V9(2).
  2464         16  AMTO  REDEFINES
  2465             AMT                 PIC Z(7).9(2)-.
  2466         16  VOID-SW-LEN         PIC S9(4)              COMP.
  2467         16  VOID-SW-ATTRB       PIC  X.
  2468         16  VOID-SW             PIC  X.
  2469         16  MDTE-LEN            PIC S9(4)              COMP.
  2470         16  MDTE-ATTRB          PIC  X.
  2471         16  MDTE                PIC  X(6).
  2472         16  BDTE-LEN            PIC S9(4)              COMP.
  2473         16  BDTE-ATTRB          PIC  X.
  2474         16  BDTE                PIC  X(6).
  2475         16  SDTE-LEN            PIC S9(4)              COMP.
  2476         16  SDTE-ATTRB          PIC  X.
  2477         16  SDTE                PIC  9(6).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  49
* EL633.cbl
  2479****************************************************************
  2480*
  2481* Copyright (c) 2007-2013 Dell Inc.
  2482* All rights reserved.
  2483*
  2484****************************************************************
  2485 01  DFHEIV.
  2486   02  DFHEIV0               PIC X(35).
  2487   02  DFHEIV1               PIC X(08).
  2488   02  DFHEIV2               PIC X(08).
  2489   02  DFHEIV3               PIC X(08).
  2490   02  DFHEIV4               PIC X(06).
  2491   02  DFHEIV5               PIC X(04).
  2492   02  DFHEIV6               PIC X(04).
  2493   02  DFHEIV7               PIC X(02).
  2494   02  DFHEIV8               PIC X(02).
  2495   02  DFHEIV9               PIC X(01).
  2496   02  DFHEIV10              PIC S9(7) COMP-3.
  2497   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2498   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2499   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2500   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2501   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2502   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2503   02  DFHEIV17              PIC X(04).
  2504   02  DFHEIV18              PIC X(04).
  2505   02  DFHEIV19              PIC X(04).
  2506   02  DFHEIV20              USAGE IS POINTER.
  2507   02  DFHEIV21              USAGE IS POINTER.
  2508   02  DFHEIV22              USAGE IS POINTER.
  2509   02  DFHEIV23              USAGE IS POINTER.
  2510   02  DFHEIV24              USAGE IS POINTER.
  2511   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2512   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2513   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2514   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2515   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2516   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2517   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2518   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2519   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2520   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2521   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2522   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2523   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2524   02  FILLER                PIC X(02).
  2525   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2526   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2527   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2528   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2529   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2530   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2531   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2532 LINKAGE  SECTION.
  2533*****************************************************************
  2534*                                                               *
  2535* Copyright (c) 2007-2013 Dell Inc.                             *
  2536* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  50
* EL633.cbl
  2537*                                                               *
  2538*****************************************************************
  2539 01  dfheiblk.
  2540     02  eibtime          pic s9(7) comp-3.
  2541     02  eibdate          pic s9(7) comp-3.
  2542     02  eibtrnid         pic x(4).
  2543     02  eibtaskn         pic s9(7) comp-3.
  2544     02  eibtrmid         pic x(4).
  2545     02  dfheigdi         pic s9(4) comp.
  2546     02  eibcposn         pic s9(4) comp.
  2547     02  eibcalen         pic s9(4) comp.
  2548     02  eibaid           pic x(1).
  2549     02  eibfiller1       pic x(1).
  2550     02  eibfn            pic x(2).
  2551     02  eibfiller2       pic x(2).
  2552     02  eibrcode         pic x(6).
  2553     02  eibfiller3       pic x(2).
  2554     02  eibds            pic x(8).
  2555     02  eibreqid         pic x(8).
  2556     02  eibrsrce         pic x(8).
  2557     02  eibsync          pic x(1).
  2558     02  eibfree          pic x(1).
  2559     02  eibrecv          pic x(1).
  2560     02  eibsend          pic x(1).
  2561     02  eibatt           pic x(1).
  2562     02  eibeoc           pic x(1).
  2563     02  eibfmh           pic x(1).
  2564     02  eibcompl         pic x(1).
  2565     02  eibsig           pic x(1).
  2566     02  eibconf          pic x(1).
  2567     02  eiberr           pic x(1).
  2568     02  eibrldbk         pic x(1).
  2569     02  eiberrcd         pic x(4).
  2570     02  eibsynrb         pic x(1).
  2571     02  eibnodat         pic x(1).
  2572     02  eibfiller5       pic x(2).
  2573     02  eibresp          pic s9(8) comp.
  2574     02  eibresp2         pic s9(8) comp.
  2575     02  dfheigdj         pic s9(4) comp.
  2576     02  dfheigdk         pic s9(4) comp.
  2577 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  51
* EL633.cbl
  2578/
  2579*                            COPY ERCCHKQ.
  2580******************************************************************
  2581*                                                                *
  2582*                                                                *
  2583*                            ERCCHKQ                             *
  2584*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2585*                            VMOD=2.005                          *
  2586*                                                                *
  2587*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
  2588*                                                                *
  2589*   FILE TYPE = VSAM,KSDS                                        *
  2590*   RECORD SIZE = 100  RECFORM = FIXED                           *
  2591*                                                                *
  2592*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
  2593*       ALTERNATE PATH  = NONE                                   *
  2594*                                                                *
  2595*   LOG = YES                                                    *
  2596*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2597******************************************************************
  2598 01  CHECK-QUE.
  2599     12  CQ-RECORD-ID                PIC XX.
  2600         88  VALID-CQ-ID                     VALUE 'CQ'.
  2601
  2602     12  CQ-CONTROL-PRIMARY.
  2603         16  CQ-COMPANY-CD           PIC X.
  2604         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  2605         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  2606
  2607     12  CQ-ENTRY-TYPE               PIC X.
  2608             88  CHECK-ON-QUE           VALUE 'Q'.
  2609             88  ALIGNMENT-CHECK        VALUE 'A'.
  2610             88  MANUAL-CHECK           VALUE 'M'.
  2611             88  SPOILED-CHECK          VALUE 'S'.
  2612             88  VOIDED-CHECK           VALUE 'V'.
  2613             88  PAYMENT-ABORTED        VALUE 'X'.
  2614
  2615     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
  2616
  2617     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
  2618         CQ-CREDIT-MASTER-CNTL.
  2619         16  CQ-PYAJ-CARRIER         PIC X.
  2620         16  CQ-PYAJ-GROUPING        PIC X(6).
  2621         16  CQ-PYAJ-FIN-RESP        PIC X(10).
  2622         16  CQ-PYAJ-ACCOUNT         PIC X(10).
  2623         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
  2624         16  CQ-PYAJ-REC-TYPE        PIC X.
  2625         16  FILLER                  PIC X(18).
  2626
  2627     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
  2628         CQ-CREDIT-MASTER-CNTL.
  2629         16  CQ-CHEK-CARRIER         PIC X.
  2630         16  CQ-CHEK-GROUPING        PIC X(6).
  2631         16  CQ-CHEK-STATE           PIC XX.
  2632         16  CQ-CHEK-ACCOUNT         PIC X(10).
  2633         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
  2634         16  CQ-CHEK-CERT-NO.
  2635             20  CQ-CHEK-CERT-PRIME  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  52
* EL633.cbl
  2636             20  CQ-CHEK-CERT-SFX    PIC X.
  2637         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  2638         16  CQ-CHEK-FIN-RESP        PIC X(10).
  2639         16  FILLER                  PIC X(06).
  2640
  2641     12  CQ-CHECK-NUMBER             PIC X(7).
  2642     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  2643     12  CQ-PAYMENT-TYPE             PIC X.
  2644             88  CQ-BILLING-CREDIT         VALUE '1'.
  2645             88  CQ-REFUND-PMT             VALUE '2'.
  2646             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
  2647     12  CQ-VOID-INDICATOR           PIC X.
  2648             88  CHECK-IS-VOID             VALUE 'V'.
  2649     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  2650     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  2651     12  CQ-CHECK-BY-USER            PIC X(4).
  2652     12  CQ-PRE-NUMBERING-SW         PIC X.
  2653       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  2654       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  2655
  2656     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  2657     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  2658     12  CQ-ACCOUNT-AGENT            PIC X(10).
  2659     12  CQ-CHECK-VOIDED-DT          PIC XX.
  2660
  2661     12  CQ-LETTERS-IND              PIC X.
  2662         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
  2663
  2664******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  53
* EL633.cbl
  2665/
  2666*                            COPY ERCPYAJ.
  2667******************************************************************
  2668*                                                                *
  2669*                            ERCPYAJ                             *
  2670*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2671*                            VMOD=2.015                          *
  2672*                                                                *
  2673*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  2674*                                                                *
  2675*                                                                *
  2676*   FILE TYPE = VSAM,KSDS                                        *
  2677*   RECORD SIZE = 200  RECFORM = FIXED                           *
  2678*                                                                *
  2679*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  2680*       ALTERNATE PATHS = NONE                                   *
  2681*                                                                *
  2682*   LOG = YES                                                    *
  2683*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2684******************************************************************
  2685******************************************************************
  2686*                   C H A N G E   L O G
  2687*
  2688* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2689*-----------------------------------------------------------------
  2690*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2691* EFFECTIVE    NUMBER
  2692*-----------------------------------------------------------------
  2693* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  2694* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  2695******************************************************************
  2696
  2697 01  PENDING-PAY-ADJ.
  2698     12  PY-RECORD-ID                     PIC XX.
  2699         88  VALID-PY-ID                        VALUE 'PY'.
  2700
  2701     12  PY-CONTROL-PRIMARY.
  2702         16  PY-COMPANY-CD                PIC X.
  2703         16  PY-CARRIER                   PIC X.
  2704         16  PY-GROUPING                  PIC X(6).
  2705         16  PY-FIN-RESP                  PIC X(10).
  2706         16  PY-ACCOUNT                   PIC X(10).
  2707         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  2708                                          PIC X(10).
  2709         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  2710         16  PY-RECORD-TYPE               PIC X.
  2711             88  PY-REMIT-RECEIVED            VALUE 'R'.
  2712             88  PY-DEPOSIT                   VALUE 'D'.
  2713             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  2714             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  2715             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  2716             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  2717             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  2718             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  2719             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  2720             88  PY-FICA-ENTRY                VALUE 'F'.
  2721             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  2722             88  PY-POLICY-FEE                VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  54
* EL633.cbl
  2723             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  2724
  2725     12  PY-PYMT-TYPE                     PIC X.
  2726             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  2727             88  PY-REINS-PYMT                VALUE 'R'.
  2728             88  PY-EXP-PYMT                  VALUE 'E'.
  2729
  2730     12  PY-BIL-INV                       PIC X(6).
  2731     12  PY-REF-NO                        PIC X(12).
  2732
  2733     12  PY-LAST-MAINT-DT                 PIC XX.
  2734     12  PY-LAST-MAINT-BY                 PIC X(4).
  2735     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2736
  2737     12  PY-PYADJ-RECORD.
  2738         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  2739         16  PY-ENTRY-COMMENT             PIC X(30).
  2740         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  2741             20  PY-GL-ACCOUNT            PIC X(10).
  2742             20  PY-GL-STATE              PIC X(02).
  2743             20  PY-GL-CANC-SW            PIC X(01).
  2744                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  2745                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  2746             20  PY-GL-COMMENT            PIC X(10).
  2747             20  FILLER      REDEFINES PY-GL-COMMENT.
  2748                 24  PY-GL-CHECK-NO       PIC 9(06).
  2749                 24  FILLER               PIC X(04).
  2750             20  FILLER                   PIC X(07).
  2751         16  PY-SAVE-ACCOUNT              PIC X(10).
  2752         16  PY-SAVE-TYPE                 PIC X(01).
  2753
  2754         16  PY-LETTERS.
  2755             20  PY-LETTER OCCURS 3 TIMES
  2756                           INDEXED BY PY-LET-NDX
  2757                                          PIC X(04).
  2758
  2759         16  PY-ERCOMP-TYPE               PIC X.
  2760             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  2761             88  PY-GA-TYPE                   VALUE 'G'.
  2762             88  PY-BANK-TYPE                 VALUE 'B'.
  2763         16  FILLER                       PIC X(05).
  2764
  2765     12  PY-RECORD-STATUS.
  2766         16  PY-CREDIT-SELECT-DT          PIC XX.
  2767         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  2768         16  PY-BILLED-DATE               PIC XX.
  2769         16  PY-REPORTED-DT               PIC XX.
  2770         16  PY-PMT-APPLIED               PIC X.
  2771             88  PY-ACCOUNT-PMT               VALUE 'A'.
  2772             88  PY-GA-PMT                    VALUE 'G'.
  2773             88  PY-OVWRITE-PMT               VALUE 'O'.
  2774             88  PY-NON-AR-PMT                VALUE 'N'.
  2775         16  FILLER                       PIC X(5).
  2776         16  PY-INPUT-DT                  PIC XX.
  2777         16  PY-CHECK-NUMBER              PIC X(6).
  2778         16  PY-VOID-SW                   PIC X.
  2779             88  PY-CHECK-VOIDED              VALUE 'V'.
  2780         16  PY-CHECK-ORIGIN-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  55
* EL633.cbl
  2781             88  PY-BILLING-CHECK             VALUE 'B'.
  2782             88  PY-REFUND-CHECK              VALUE 'R'.
  2783             88  PY-GA-CHECK                  VALUE 'G'.
  2784             88  PY-CHECK-WRITTEN             VALUE 'W'.
  2785             88  PY-CHECK-REVERSAL            VALUE 'V'.
  2786         16  PY-CHECK-WRITTEN-DT          PIC XX.
  2787         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  2788         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  2789         16  PY-BILL-FLAG                 PIC X.
  2790             88  PY-BILLED                    VALUE 'B'.
  2791         16  PY-AR-FLAG                   PIC X.
  2792             88  PY-AR-CYCLE                  VALUE 'C'.
  2793             88  PY-AR-MONTH-END              VALUE 'M'.
  2794         16  PY-AR-DATE                   PIC XX.
  2795
  2796     12  PY-GL-CODES.
  2797         16  PY-GL-DB                     PIC X(14).
  2798         16  PY-GL-CR                     PIC X(14).
  2799         16  PY-GL-FLAG                   PIC X.
  2800         16  PY-GL-DATE                   PIC XX.
  2801
  2802     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  2803     12  FILLER                           PIC X(3).
  2804******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  56
* EL633.cbl
  2805/
  2806*                            COPY ERCCOMP.
  2807******************************************************************
  2808*                                                                *
  2809*                                                                *
  2810*                            ERCCOMP                             *
  2811*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2812*                            VMOD=2.019                          *
  2813*                                                                *
  2814*   ONLINE CREDIT SYSTEM                                         *
  2815*                                                                *
  2816*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2817*                                                                *
  2818*   FILE TYPE = VSAM,KSDS                                        *
  2819*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2820*                                                                *
  2821*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2822*       ALTERNATE PATH = NONE                                    *
  2823*                                                                *
  2824*   LOG = NO                                                     *
  2825*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2826*                                                                *
  2827******************************************************************
  2828*                   C H A N G E   L O G
  2829*
  2830* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2831*-----------------------------------------------------------------
  2832*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2833* EFFECTIVE    NUMBER
  2834*-----------------------------------------------------------------
  2835* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2836* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2837* 092205    2005050300006  PEMA  ADD LEASE FEE
  2838* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2839* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2840* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2841* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2842* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2843* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  2844******************************************************************
  2845
  2846 01  COMPENSATION-MASTER.
  2847     12  CO-RECORD-ID                          PIC XX.
  2848         88  VALID-CO-ID                          VALUE 'CO'.
  2849
  2850     12  CO-CONTROL-PRIMARY.
  2851         16  CO-COMPANY-CD                     PIC X.
  2852         16  CO-CONTROL.
  2853             20  CO-CTL-1.
  2854                 24  CO-CARR-GROUP.
  2855                     28  CO-CARRIER            PIC X.
  2856                     28  CO-GROUPING.
  2857                         32  CO-GROUP-PREFIX   PIC XXX.
  2858                         32  CO-GROUP-PRIME    PIC XXX.
  2859                 24  CO-RESP-NO.
  2860                     28  CO-RESP-PREFIX        PIC X(4).
  2861                     28  CO-RESP-PRIME         PIC X(6).
  2862             20  CO-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  57
* EL633.cbl
  2863                 24  CO-ACCOUNT.
  2864                     28  CO-ACCT-PREFIX        PIC X(4).
  2865                     28  CO-ACCT-PRIME         PIC X(6).
  2866         16  CO-TYPE                           PIC X.
  2867             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2868             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2869             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2870
  2871     12  CO-MAINT-INFORMATION.
  2872         16  CO-LAST-MAINT-DT                  PIC XX.
  2873         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2874         16  CO-LAST-MAINT-USER                PIC X(4).
  2875     12  FILLER                                PIC XX.
  2876     12  CO-STMT-TYPE                          PIC XXX.
  2877     12  CO-COMP-TYPE                          PIC X.
  2878         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2879     12  CO-STMT-OWNER                         PIC X(4).
  2880     12  CO-BALANCE-CONTROL                    PIC X.
  2881         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2882         88  CO-NO-BALANCE                        VALUE 'N'.
  2883
  2884     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2885         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2886         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2887         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2888
  2889     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2890         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2891         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2892
  2893     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2894     12  CO-GA-DIRECT-DEP                      PIC X.
  2895     12  CO-FUTURE-SPACE                       PIC X.
  2896         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2897
  2898     12  CO-ACCT-NAME                          PIC X(30).
  2899     12  CO-MAIL-NAME                          PIC X(30).
  2900     12  CO-ADDR-1                             PIC X(30).
  2901     12  CO-ADDR-2                             PIC X(30).
  2902     12  CO-ADDR-3.
  2903         16  CO-ADDR-CITY                      PIC X(27).
  2904         16  CO-ADDR-STATE                     PIC XX.
  2905     12  CO-CSO-1099                           PIC X.
  2906     12  CO-ZIP.
  2907         16  CO-ZIP-PRIME.
  2908             20  CO-ZIP-PRI-1ST                PIC X.
  2909                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2910             20  FILLER                        PIC X(4).
  2911         16  CO-ZIP-PLUS4                      PIC X(4).
  2912     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2913         16  CO-CAN-POSTAL-1                   PIC XXX.
  2914         16  CO-CAN-POSTAL-2                   PIC XXX.
  2915         16  FILLER                            PIC XXX.
  2916     12  CO-SOC-SEC                            PIC X(13).
  2917     12  CO-TELEPHONE.
  2918         16  CO-AREA-CODE                      PIC XXX.
  2919         16  CO-PREFIX                         PIC XXX.
  2920         16  CO-PHONE                          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  58
* EL633.cbl
  2921
  2922     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2923
  2924     12  CO-AR-BAL-LEVEL                       PIC X.
  2925         88  CO-AR-REF-LVL                        VALUE '1'.
  2926         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2927         88  CO-AR-BILL-LVL                       VALUE '2'.
  2928         88  CO-AR-AGT-LVL                        VALUE '3'.
  2929         88  CO-AR-FR-LVL                         VALUE '4'.
  2930
  2931     12  CO-AR-NORMAL-PRINT                    PIC X.
  2932         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2933         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2934
  2935     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2936
  2937     12  CO-AR-REPORTING                       PIC X.
  2938         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2939         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2940
  2941     12  CO-AR-PULL-CHECK                      PIC X.
  2942         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2943         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2944
  2945     12  CO-AR-BALANCE-PRINT                   PIC X.
  2946         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2947
  2948     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2949         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2950         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2951         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2952
  2953     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2954
  2955     12  CO-USER-CODE                          PIC X.
  2956     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2957
  2958******************************************************************
  2959*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2960*    THE LAST MONTH END RUN.
  2961******************************************************************
  2962
  2963     12  CO-LAST-ACTIVITY-DATE.
  2964         16  CO-ACT-YEAR                       PIC 99.
  2965         16  CO-ACT-MONTH                      PIC 99.
  2966         16  CO-ACT-DAY                        PIC 99.
  2967
  2968     12  CO-LAST-STMT-DT.
  2969         16  CO-LAST-STMT-YEAR                 PIC 99.
  2970         16  CO-LAST-STMT-MONTH                PIC 99.
  2971         16  CO-LAST-STMT-DAY                  PIC 99.
  2972
  2973     12  CO-MO-END-TOTALS.
  2974         16  CO-MONTHLY-TOTALS.
  2975             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2976             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2977             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2978             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  59
* EL633.cbl
  2979             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  2980
  2981         16  CO-AGING-TOTALS.
  2982             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2983             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2984             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2985             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2986
  2987         16  CO-YTD-TOTALS.
  2988             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2989             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2990
  2991         16  CO-OVER-UNDER-TOTALS.
  2992             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2993             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2994
  2995     12  CO-MISCELLANEOUS-TOTALS.
  2996         16  CO-FICA-TOTALS.
  2997             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2998             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2999
  3000         16  CO-CLAIM-TOTALS.
  3001             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  3002             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  3003
  3004******************************************************************
  3005*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  3006*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  3007******************************************************************
  3008
  3009     12  CO-CURRENT-TOTALS.
  3010         16  CO-CURRENT-LAST-STMT-DT.
  3011             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  3012             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  3013             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  3014
  3015         16  CO-CURRENT-MONTHLY-TOTALS.
  3016             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  3017             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  3018             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  3019             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  3020             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  3021
  3022         16  CO-CURRENT-AGING-TOTALS.
  3023             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  3024             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  3025             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  3026             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  3027
  3028         16  CO-CURRENT-YTD-TOTALS.
  3029             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  3030             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  3031
  3032     12  CO-PAID-COMM-TOTALS.
  3033         16  CO-YTD-PAID-COMMS.
  3034             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  3035             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  3036
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  60
* EL633.cbl
  3037     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  3038         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  3039         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  3040
  3041     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  3042         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  3043         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  3044         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  3045         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  3046         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  3047         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  3048         88  CO-FINAL-LETTER                  VALUE 'F'.
  3049         88  CO-RECONCILING                   VALUE 'R'.
  3050         88  CO-PHONE-CALL                    VALUE 'P'.
  3051         88  CO-LEGAL                         VALUE 'L'.
  3052         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  3053         88  CO-WRITE-OFF                     VALUE 'W'.
  3054         88  CO-NO-ACTION                     VALUE 'N' ' '.
  3055
  3056     12  CO-CSR-CODE                       PIC X(4).
  3057
  3058     12  CO-GA-STATUS-INFO.
  3059         16  CO-GA-EFFECTIVE-DT            PIC XX.
  3060         16  CO-GA-TERMINATION-DT          PIC XX.
  3061         16  CO-GA-STATUS-CODE             PIC X.
  3062             88  CO-GA-ACTIVE                 VALUE 'A'.
  3063             88  CO-GA-INACTIVE               VALUE 'I'.
  3064             88  CO-GA-PENDING                VALUE 'P'.
  3065         16  CO-GA-COMMENTS.
  3066             20  CO-GA-COMMENT-1           PIC X(40).
  3067             20  CO-GA-COMMENT-2           PIC X(40).
  3068             20  CO-GA-COMMENT-3           PIC X(40).
  3069             20  CO-GA-COMMENT-4           PIC X(40).
  3070
  3071     12  CO-RPTCD2                         PIC X(10).
  3072     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  3073         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  3074         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  3075
  3076     12  CO-TYPE-AGENT                     PIC X(01).
  3077         88  CO-CORPORATION                   VALUE 'C'.
  3078         88  CO-PARTNERSHIP                   VALUE 'P'.
  3079         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  3080         88  CO-TRUST                         VALUE 'T'.
  3081         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  3082
  3083     12  CO-FAXNO.
  3084         16  CO-FAX-AREA-CODE                  PIC XXX.
  3085         16  CO-FAX-PREFIX                     PIC XXX.
  3086         16  CO-FAX-PHONE                      PIC X(4).
  3087
  3088     12  CO-BANK-INFORMATION.
  3089         16  CO-BANK-TRANSIT-NO                PIC X(8).
  3090         16  CO-BANK-TRANSIT-NON REDEFINES
  3091             CO-BANK-TRANSIT-NO                PIC 9(8).
  3092
  3093         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  3094     12  CO-MISC-DEDUCT-INFO REDEFINES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  61
* EL633.cbl
  3095                  CO-BANK-INFORMATION.
  3096         16  CO-MD-GL-ACCT                     PIC X(10).
  3097         16  CO-MD-DIV                         PIC XX.
  3098         16  CO-MD-CENTER                      PIC X(4).
  3099         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  3100         16  CO-CREATE-AP-CHECK                PIC X.
  3101         16  CO-DELIVER-CK-TO-MEL              PIC X.
  3102         16  FILLER                            PIC XXX.
  3103     12  CO-ACH-STATUS                         PIC X.
  3104         88  CO-ACH-ACTIVE                         VALUE 'A'.
  3105         88  CO-ACH-PENDING                        VALUE 'P'.
  3106
  3107     12  CO-BILL-SW                            PIC X.
  3108     12  CO-CONTROL-NAME                       PIC X(30).
  3109     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  3110     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  3111     12  CO-CLP-STATE                          PIC XX.
  3112     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  3113     12  CO-SPP-REFUND-EDIT                    PIC X.
  3114
  3115******************************************************************
  3116*
  3117*                            COPY AIRL0009.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  62
* EL633.cbl
  3118/
  3119 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-QUE
  3120                          PENDING-PAY-ADJ COMPENSATION-MASTER.
  3121 0000-DFHEXIT SECTION.
  3122     MOVE '9#                    $   ' TO DFHEIV0.
  3123     MOVE 'EL633' TO DFHEIV1.
  3124     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3125
  3126     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3127     MOVE EIBTRMID               TO  QID-TERM.
  3128     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  3129
  3130     IF EIBCALEN = ZERO
  3131         GO TO 8800-UNAUTHORIZED-ACCESS.
  3132
  3133     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  3134         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  3135
  3136     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3137     MOVE '5'                    TO  DC-OPTION-CODE.
  3138
  3139     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  3140
  3141     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT.
  3142     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT.
  3143
  3144     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3145         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3146             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  3147             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  3148             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  3149             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  3150             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  3151             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  3152             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  3153             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  3154         ELSE
  3155             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  3156             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  3157             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  3158             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  3159             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  3160             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  3161             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  3162             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  3163
  3164     MOVE LOW-VALUES             TO  EL633AI.
  3165
  3166     MOVE DC-JULIAN-YYDDD        TO  WORK-DATE-JULIAN.
  3167     COMPUTE WORK-SEQ-NO = WORK-JULIAN-DD * 100000.
  3168     MOVE EIBTIME                TO  WORK-SEQ-TIME.
  3169     ADD WORK-SEQ-HHMMS TO WORK-SEQ-NO.
  3170
  3171     MOVE ZEROS                  TO  TOTAL-ACCT-AMT
  3172                                     TOTAL-ACCT-NET.
  3173
  3174     IF RETURNED-FROM = XCTL-6331 OR
  3175                        XCTL-640  OR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  63
* EL633.cbl
  3176                        XCTL-642  OR
  3177                        XCTL-652
  3178         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT.
  3179
  3180     IF EIBTRNID NOT = TRANS-ID
  3181         MOVE 'T'                TO  PI-PYAJ-FILE-SW
  3182         MOVE 'Y'                TO  PI-PAGE-SW
  3183         MOVE ZEROS              TO  PI-SEQ-NOS
  3184         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3185                                     PI-SAV-ACCT-NET
  3186                                     PI-SAV-PREV-AMT
  3187                                     PI-SAV-PREV-NET
  3188         IF (EIBTRNID NOT = EL640-TRANS-ID  AND
  3189             EIBTRNID NOT = EL642-TRANS-ID  AND
  3190             EIBTRNID NOT = EL652-TRANS-ID) OR
  3191             PI-CR-FIN-RESP = SPACES
  3192             GO TO 8100-SEND-INITIAL-MAP
  3193         ELSE
  3194             IF EIBTRNID = (EL6331-TRANS-ID  OR
  3195                            EL640-TRANS-ID   OR
  3196                            EL642-TRANS-ID)  AND
  3197                PI-CR-CONTROL-IN-PROGRESS  = SPACES
  3198                GO TO 8100-SEND-INITIAL-MAP
  3199             ELSE
  3200                 MOVE DFHENTER   TO  EIBAID
  3201                 MOVE 'S'        TO  MAINTI
  3202                 MOVE PI-CR-CARRIER
  3203                                 TO  CARRIERI
  3204                 MOVE PI-CR-GROUPING
  3205                                 TO  GROUPI
  3206                 MOVE PI-CR-FIN-RESP
  3207                                 TO  FINRESPI
  3208                 MOVE PI-CR-ACCOUNT
  3209                                 TO  ACCTI
  3210                 MOVE 1          TO  CARRIERL  MAINTA
  3211                 MOVE 3          TO  GROUPL
  3212                 MOVE 6          TO  FINRESPL  ACCTL
  3213                 GO TO 0400-VALIDATE-KEY-DATA.
  3214
  3215
  3216* EXEC CICS HANDLE CONDITION
  3217*        PGMIDERR  (9600-PGMID-ERROR)
  3218*        ERROR     (9990-ABEND)
  3219*    END-EXEC.
  3220*    MOVE '"$L.                  ! " #00003211' TO DFHEIV0
  3221     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3222     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3223     MOVE X'2220233030303033323131' TO DFHEIV0(25:11)
  3224     CALL 'kxdfhei1' USING DFHEIV0
  3225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3226
  3227
  3228     IF EIBAID = DFHCLEAR
  3229         GO TO 9400-CLEAR.
  3230
  3231     IF PI-PROCESSOR-ID = 'LGXX'
  3232         GO TO 0200-RECEIVE.
  3233
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  64
* EL633.cbl
  3234
  3235* EXEC CICS READQ TS
  3236*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  3237*        INTO   (SECURITY-CONTROL)
  3238*        LENGTH (SC-COMM-LENGTH)
  3239*        ITEM   (SC-ITEM)
  3240*    END-EXEC.
  3241*    MOVE '*$II   L              ''   #00003222' TO DFHEIV0
  3242     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3243     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3244     MOVE X'2020233030303033323232' TO DFHEIV0(25:11)
  3245     CALL 'kxdfhei1' USING DFHEIV0,
  3246           PI-SECURITY-TEMP-STORE-ID,
  3247           SECURITY-CONTROL,
  3248           SC-COMM-LENGTH,
  3249           SC-ITEM,
  3250           DFHEIV99,
  3251           DFHEIV99
  3252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3253
  3254
  3255     MOVE SC-CREDIT-DISPLAY (15)  TO PI-DISPLAY-CAP.
  3256     MOVE SC-CREDIT-UPDATE  (15)  TO PI-MODIFY-CAP.
  3257
  3258     IF NOT DISPLAY-CAP
  3259         MOVE 'READ'          TO SM-READ
  3260         PERFORM 9995-SECURITY-VIOLATION
  3261         MOVE ER-0070         TO  EMI-ERROR
  3262         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3263         GO TO 8100-SEND-INITIAL-MAP.
  3264
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  65
* EL633.cbl
  3266 0200-RECEIVE.
  3267
  3268     IF EIBAID = DFHPA1  OR  DFHPA2  OR  DFHPA3
  3269         MOVE ER-0008            TO  EMI-ERROR
  3270         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3271         MOVE -1                 TO  MAINTL
  3272         GO TO 8200-SEND-DATAONLY.
  3273
  3274
  3275* EXEC CICS RECEIVE
  3276*        MAP     (MAP-NAME)
  3277*        MAPSET  (MAPSET-NAME)
  3278*        INTO    (EL633AI)
  3279*    END-EXEC.
  3280     MOVE LENGTH OF
  3281      EL633AI
  3282       TO DFHEIV11
  3283*    MOVE '8"T I  L              ''   #00003248' TO DFHEIV0
  3284     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3285     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3286     MOVE X'2020233030303033323438' TO DFHEIV0(25:11)
  3287     CALL 'kxdfhei1' USING DFHEIV0,
  3288           MAP-NAME,
  3289           EL633AI,
  3290           DFHEIV11,
  3291           MAPSET-NAME,
  3292           DFHEIV99,
  3293           DFHEIV99
  3294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3295
  3296
  3297     IF MAINTI = 'S' AND
  3298        EIBAID = DFHENTER
  3299         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3300                                     PI-SAV-ACCT-NET
  3301                                     PI-SAV-PREV-AMT
  3302                                     PI-SAV-PREV-NET
  3303                                     PI-FRST-FILE-SEQ-NO
  3304         MOVE SPACES             TO  PI-FRST-RECORD-TYPE.
  3305
  3306     IF PFENTERL = ZERO
  3307         GO TO 0300-CHECK-PFKEYS.
  3308
  3309     IF (PFENTERI  IS NUMERIC)
  3310       AND (PFENTERI GREATER 0 AND LESS 25)
  3311         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  3312     ELSE
  3313         MOVE ER-0029               TO  EMI-ERROR
  3314         GO TO 0320-INPUT-ERROR.
  3315
  3316 0300-CHECK-PFKEYS.
  3317     IF EIBAID = DFHPF23
  3318         GO TO 8810-PF23.
  3319
  3320     IF EIBAID = DFHPF24
  3321         GO TO 9200-RETURN-MAIN-MENU.
  3322
  3323     IF EIBAID = DFHPF12
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  66
* EL633.cbl
  3324         GO TO 9500-PF12.
  3325
  3326     IF EIBAID = DFHPF3
  3327         IF PI-CR-CONTROL-IN-PROGRESS NOT =      SPACES
  3328             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3329             MOVE XCTL-652       TO  PGM-NAME
  3330             IF ERCOMP-KEY  NOT =      SPACES
  3331                 MOVE COMP-CARRIER   TO  PI-CR-CARRIER
  3332                 MOVE COMP-GROUPING  TO  PI-CR-GROUPING
  3333                 MOVE COMP-FIN-RESP  TO  PI-CR-FIN-RESP
  3334                 MOVE COMP-ACCOUNT   TO  PI-CR-ACCOUNT
  3335             END-IF
  3336
  3337             IF PI-CR-ACCOUNT = LOW-VALUES
  3338                 MOVE 'G'        TO  PI-CR-TYPE
  3339                 GO TO 9300-XCTL
  3340             ELSE
  3341                 MOVE 'A'        TO  PI-CR-TYPE
  3342                 GO TO 9300-XCTL
  3343         ELSE
  3344            MOVE ER-3020         TO  EMI-ERROR
  3345            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3346            GO TO 8100-SEND-INITIAL-MAP.
  3347
  3348     IF EIBAID = DFHPF4
  3349         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3350         MOVE XCTL-6331          TO  PGM-NAME
  3351         GO TO 9300-XCTL.
  3352
  3353     IF EIBAID = DFHPF5
  3354         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3355         MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3356         MOVE XCTL-640           TO  PGM-NAME
  3357         IF PI-CR-ACCOUNT = LOW-VALUES
  3358             MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3359             IF ACCTI = LOW-VALUES
  3360                MOVE 'G'         TO  PI-CR-TYPE
  3361             END-IF
  3362             GO TO 9300-XCTL
  3363         ELSE
  3364             MOVE 'A'        TO  PI-CR-TYPE
  3365             GO TO 9300-XCTL.
  3366
  3367     IF EIBAID = DFHPF6
  3368        IF PI-GA-BILLING
  3369            PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3370            MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3371            MOVE XCTL-642        TO  PGM-NAME
  3372            IF PI-CR-ACCOUNT = LOW-VALUES
  3373                 MOVE 'G'        TO  PI-CR-TYPE
  3374                 GO TO 9300-XCTL
  3375             ELSE
  3376                 MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3377                 GO TO 9300-XCTL
  3378        ELSE
  3379            MOVE ER-2929         TO  EMI-ERROR
  3380            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3381            MOVE AL-UNBON        TO  PFENTERA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  67
* EL633.cbl
  3382            IF PFENTERL = ZERO
  3383                MOVE -1          TO  MAINTL
  3384                GO TO 8200-SEND-DATAONLY
  3385            ELSE
  3386                MOVE -1          TO  PFENTERL
  3387                GO TO 8200-SEND-DATAONLY.
  3388
  3389     IF EIBAID = DFHENTER  OR  DFHPF1  OR  DFHPF2
  3390         GO TO 0400-VALIDATE-KEY-DATA.
  3391
  3392 0320-INPUT-ERROR.
  3393     MOVE ER-0029                TO  EMI-ERROR.
  3394
  3395     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3396
  3397     MOVE AL-UNBON               TO  PFENTERA.
  3398
  3399     IF PFENTERL = ZERO
  3400         MOVE -1                 TO  MAINTL
  3401     ELSE
  3402         MOVE -1                 TO  PFENTERL.
  3403
  3404     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  68
* EL633.cbl
  3406 0400-VALIDATE-KEY-DATA.
  3407     IF MODIFY-CAP  OR (EIBAID = DFHPF1 OR DFHPF2)
  3408         NEXT SENTENCE
  3409       ELSE
  3410        IF MAINTI NOT = 'S'
  3411         MOVE 'UPDATE'       TO SM-READ
  3412         PERFORM 9995-SECURITY-VIOLATION
  3413         MOVE ER-0070        TO EMI-ERROR
  3414         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3415         GO TO 8100-SEND-INITIAL-MAP.
  3416
  3417     MOVE PI-COMPANY-CD          TO  PI-SAV-COMP-CD.
  3418
  3419     IF EIBAID = DFHPF1
  3420         GO TO 4000-BROWSE-FRWD.
  3421
  3422     IF EIBAID   = DFHPF1   AND
  3423        CARRIERL = ZEROS    AND
  3424        GROUPL   = ZEROS    AND
  3425        FINRESPL = ZEROS    AND
  3426        ACCTL    = ZEROS
  3427         GO TO 4000-BROWSE-FRWD.
  3428
  3429     IF PI-PROCESSOR-ID = 'LGXX'
  3430         IF MAINTI = 'C'
  3431             MOVE AL-UANON       TO MAINTA
  3432             MOVE MAINTI         TO PI-SAV-FUNCTION
  3433             GO TO CSO-BRANCH
  3434         END-IF
  3435     END-IF.
  3436
  3437     IF MAINTI = 'C' OR  'S'
  3438         MOVE AL-UANON           TO  MAINTA
  3439         MOVE MAINTI             TO  PI-SAV-FUNCTION
  3440     ELSE
  3441         MOVE -1                 TO  MAINTL
  3442         MOVE ER-0023            TO  EMI-ERROR
  3443         MOVE AL-UABON           TO  MAINTA
  3444         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3445
  3446 CSO-BRANCH.
  3447
  3448     IF MAINTI = 'C'
  3449       AND PI-PREV-FUNCTION NOT = 'S' AND 'C'
  3450         MOVE -1                 TO  MAINTL
  3451         MOVE ER-2056            TO  EMI-ERROR
  3452         MOVE AL-UABON           TO  MAINTA
  3453         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3454
  3455     IF CARRIERL = ZEROS  AND
  3456        GROUPL   = ZEROS  AND
  3457        FINRESPL = ZEROS  AND
  3458        ACCTL    = ZEROS
  3459         MOVE -1                 TO  CARRIERL
  3460         MOVE ER-2231            TO  EMI-ERROR
  3461         MOVE AL-UABON           TO  CARRIERA
  3462                                     GROUPA
  3463                                     FINRESPA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  69
* EL633.cbl
  3464                                     ACCTA
  3465         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3466         GO TO 8200-SEND-DATAONLY.
  3467
  3468     IF CARRIERL NOT = ZEROS
  3469         MOVE AL-UANON           TO  CARRIERA
  3470         MOVE CARRIERI           TO  COMP-CARRIER
  3471                                     PI-SAV-CARRIER
  3472                                     PI-CR-CARRIER
  3473         IF CARRIERI NOT = ZEROS
  3474           AND (PI-ZERO-CARRIER  OR  PI-ZERO-CAR-GROUP)
  3475             MOVE ER-2587        TO  EMI-ERROR
  3476             MOVE -1             TO  CARRIERL
  3477             MOVE AL-UABON       TO  CARRIERA
  3478             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3479         ELSE
  3480             NEXT SENTENCE
  3481     ELSE
  3482         MOVE LOW-VALUES          TO  COMP-CARRIER
  3483                                      PI-SAV-CARRIER.
  3484
  3485     IF CARRIERL NOT = ZEROS
  3486         IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  3487             IF PI-CARRIER-SECURITY = CARRIERI
  3488                 NEXT SENTENCE
  3489             ELSE
  3490                 MOVE -1         TO  CARRIERL
  3491                 MOVE ER-2370    TO  EMI-ERROR
  3492                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3493
  3494     IF GROUPL NOT = ZEROS
  3495         MOVE AL-UANON           TO  GROUPA
  3496         MOVE GROUPI             TO  COMP-GROUPING
  3497                                     PI-SAV-GROUPING
  3498                                     PI-CR-GROUPING
  3499         IF GROUPI NOT = ZEROS
  3500           AND (PI-ZERO-GROUPING  OR  PI-ZERO-CAR-GROUP)
  3501             MOVE ER-2588        TO  EMI-ERROR
  3502             MOVE -1             TO  GROUPL
  3503             MOVE AL-UABON       TO  GROUPA
  3504             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3505         ELSE
  3506             NEXT SENTENCE
  3507     ELSE
  3508         MOVE LOW-VALUES         TO  COMP-GROUPING
  3509                                     PI-SAV-GROUPING.
  3510
  3511     IF FINRESPL NOT = ZEROS
  3512         MOVE AL-UANON           TO  FINRESPA
  3513         MOVE FINRESPI           TO  COMP-FIN-RESP
  3514                                     PI-SAV-FIN-RESP
  3515                                     PI-CR-FIN-RESP
  3516     ELSE
  3517         MOVE LOW-VALUES         TO  COMP-FIN-RESP
  3518                                     PI-SAV-FIN-RESP.
  3519
  3520     IF ACCTL NOT = ZEROS
  3521         MOVE AL-UANON           TO  ACCTA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  70
* EL633.cbl
  3522         MOVE ACCTI              TO  COMP-ACCOUNT
  3523                                     PI-SAV-ACCOUNT
  3524                                     PI-CR-ACCOUNT
  3525     ELSE
  3526         MOVE LOW-VALUES         TO  COMP-ACCOUNT
  3527                                     PI-SAV-ACCOUNT
  3528                                     PI-CR-ACCOUNT.
  3529
  3530     IF EMI-ERROR = ZEROS
  3531         NEXT SENTENCE
  3532     ELSE
  3533         IF EIBTRNID = EL640-TRANS-ID OR
  3534            EIBTRNID = EL642-TRANS-ID OR
  3535            EIBTRNID = EL6331-TRANS-ID
  3536             GO TO 8100-SEND-INITIAL-MAP
  3537         ELSE
  3538             GO TO 8200-SEND-DATAONLY.
  3539
  3540     MOVE MAINTI                 TO  PI-PREV-FUNCTION.
  3541
  3542     IF MAINTI = 'S'
  3543         IF EIBAID = DFHPF1              OR  DFHENTER
  3544             GO TO 4000-BROWSE-FRWD
  3545         ELSE
  3546             GO TO 4100-BROWSE-BKWD.
  3547
  3548     MOVE SPACES                 TO  COMP-RECORD-TYPE.
  3549     MOVE PI-COMPANY-CD          TO  COMP-COMP-CD.
  3550
  3551
  3552* EXEC CICS HANDLE CONDITION
  3553*        NOTFND   (0410-NO-COMP-MSTR)
  3554*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3555*        END-EXEC.
  3556*    MOVE '"$IJ                  ! # #00003508' TO DFHEIV0
  3557     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3558     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3559     MOVE X'2320233030303033353038' TO DFHEIV0(25:11)
  3560     CALL 'kxdfhei1' USING DFHEIV0
  3561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3562
  3563
  3564
  3565* EXEC CICS READ
  3566*        DATASET  (COMP-FILE-ID)
  3567*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3568*        RIDFLD   (ERCOMP-KEY)
  3569*        GTEQ
  3570*        END-EXEC.
  3571*    MOVE '&"S        G          (   #00003513' TO DFHEIV0
  3572     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3573     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3574     MOVE X'2020233030303033353133' TO DFHEIV0(25:11)
  3575     CALL 'kxdfhei1' USING DFHEIV0,
  3576           COMP-FILE-ID,
  3577           DFHEIV20,
  3578           DFHEIV99,
  3579           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  71
* EL633.cbl
  3580           DFHEIV99,
  3581           DFHEIV99,
  3582           DFHEIV99
  3583     SET ADDRESS OF COMPENSATION-MASTER TO
  3584         DFHEIV20
  3585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3586
  3587
  3588     IF PI-COMPANY-CD = CO-COMPANY-CD  AND
  3589        COMP-CARRIER  = CO-CARRIER     AND
  3590        COMP-GROUPING = CO-GROUPING    AND
  3591        COMP-FIN-RESP = CO-RESP-NO    AND
  3592        COMP-ACCOUNT  = CO-ACCOUNT
  3593         NEXT SENTENCE
  3594     ELSE
  3595         GO TO 0410-NO-COMP-MSTR.
  3596
  3597     IF PI-COMPANY-ID = 'NCL'
  3598         IF CO-GA-INACTIVE
  3599             GO TO 0420-INACTIVE-COMP.
  3600
  3601     IF MAINTI = 'C'
  3602         GO TO 1000-EDIT-DATA.
  3603
  3604     IF EIBAID = DFHPF1
  3605       OR DFHENTER
  3606         GO TO 4000-BROWSE-FRWD.
  3607
  3608     IF EIBAID = DFHPF2
  3609         GO TO 4100-BROWSE-BKWD.
  3610
  3611 0410-NO-COMP-MSTR.
  3612     MOVE ER-2230                TO  EMI-ERROR.
  3613     MOVE -1                     TO  CARRIERL.
  3614     MOVE AL-UABON               TO  CARRIERA
  3615                                     GROUPA
  3616                                     FINRESPA
  3617                                     ACCTA.
  3618
  3619     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3620
  3621     GO TO 8200-SEND-DATAONLY.
  3622
  3623 0420-INACTIVE-COMP.
  3624     MOVE ER-2763                TO  EMI-ERROR.
  3625     MOVE -1                     TO  CARRIERL.
  3626     MOVE AL-UABON               TO  CARRIERA
  3627                                     GROUPA
  3628                                     FINRESPA
  3629                                     ACCTA.
  3630
  3631     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3632
  3633     GO TO 8200-SEND-DATAONLY.
  3634
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  72
* EL633.cbl
  3636 0500-CREATE-TEMP-STORAGE.
  3637
  3638     PERFORM 0800-DELETE-TS  THRU  0890-EXIT.
  3639
  3640
  3641* EXEC CICS WRITEQ TS
  3642*        QUEUE  (QID)
  3643*        FROM   (PROGRAM-INTERFACE-BLOCK)
  3644*        LENGTH (PI-COMM-LENGTH)
  3645*    END-EXEC.
  3646*    MOVE '*"     L              ''   #00003572' TO DFHEIV0
  3647     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  3648     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3649     MOVE X'2020233030303033353732' TO DFHEIV0(25:11)
  3650     CALL 'kxdfhei1' USING DFHEIV0,
  3651           QID,
  3652           PROGRAM-INTERFACE-BLOCK,
  3653           PI-COMM-LENGTH,
  3654           DFHEIV99,
  3655           DFHEIV99,
  3656           DFHEIV99
  3657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3658
  3659
  3660 0590-EXIT.
  3661      EXIT.
  3662
  3663 0600-RECOVER-TEMP-STORAGE.
  3664
  3665* EXEC CICS READQ TS
  3666*        QUEUE  (QID)
  3667*        INTO   (PROGRAM-INTERFACE-BLOCK)
  3668*        LENGTH (PI-COMM-LENGTH)
  3669*    END-EXEC.
  3670*    MOVE '*$I    L              ''   #00003582' TO DFHEIV0
  3671     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  3672     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3673     MOVE X'2020233030303033353832' TO DFHEIV0(25:11)
  3674     CALL 'kxdfhei1' USING DFHEIV0,
  3675           QID,
  3676           PROGRAM-INTERFACE-BLOCK,
  3677           PI-COMM-LENGTH,
  3678           DFHEIV99,
  3679           DFHEIV99,
  3680           DFHEIV99
  3681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3682
  3683
  3684     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  3685
  3686 0690-EXIT.
  3687      EXIT.
  3688
  3689 0800-DELETE-TS.
  3690
  3691* EXEC CICS HANDLE CONDITION
  3692*        QIDERR (0890-EXIT)
  3693*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  73
* EL633.cbl
  3694*    MOVE '"$N                   ! $ #00003594' TO DFHEIV0
  3695     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3696     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3697     MOVE X'2420233030303033353934' TO DFHEIV0(25:11)
  3698     CALL 'kxdfhei1' USING DFHEIV0
  3699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3700
  3701
  3702
  3703* EXEC CICS DELETEQ TS
  3704*        QUEUE  (QID)
  3705*    END-EXEC.
  3706*    MOVE '*&                    #   #00003598' TO DFHEIV0
  3707     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3708     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3709     MOVE X'2020233030303033353938' TO DFHEIV0(25:11)
  3710     CALL 'kxdfhei1' USING DFHEIV0,
  3711           QID,
  3712           DFHEIV99
  3713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3714
  3715
  3716
  3717* EXEC CICS SYNCPOINT
  3718*    END-EXEC.
  3719*    MOVE '6"                    !   #00003602' TO DFHEIV0
  3720     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  3721     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3722     MOVE X'2020233030303033363032' TO DFHEIV0(25:11)
  3723     CALL 'kxdfhei1' USING DFHEIV0
  3724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3725
  3726
  3727 0890-EXIT.
  3728      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  74
* EL633.cbl
  3730
  3731 1000-EDIT-DATA.
  3732     SET PINDX                   TO  1.
  3733
  3734     .
  3735 1010-EDIT-LOOP.
  3736     SET NDX                     TO  PINDX.
  3737     IF GL-ACCT-LEN (PINDX)   = ZEROS  AND
  3738        GL-STATE-LEN (PINDX) = ZEROS   AND
  3739        GL-CANC-LEN (PINDX)   = ZEROS  AND
  3740        GL-COMM-LEN (PINDX)   = ZEROS  AND
  3741        RTYPE-LEN (PINDX)     = ZEROS  AND
  3742        AMT-LEN (PINDX)       = ZEROS  AND
  3743        VOID-SW-LEN (PINDX)   = ZEROS  AND
  3744        SDTE-LEN (PINDX)      = ZEROS
  3745         GO TO 1020-INCREMENT-PINDX.
  3746
  3747     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3748         MOVE AL-UANON           TO  GL-ACCT-ATTRB (PINDX)
  3749         IF PI-COMPANY-ID NOT = 'WSL'
  3750             NEXT SENTENCE
  3751         ELSE
  3752             MOVE WSL-COMM-DTE (PINDX)  TO  DC-GREG-DATE-1-MDY
  3753             MOVE '4'                   TO  DC-OPTION-CODE
  3754             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  3755             IF NO-CONVERSION-ERROR
  3756                 NEXT SENTENCE
  3757             ELSE
  3758                 MOVE ER-2595    TO  EMI-ERROR
  3759                 MOVE -1         TO  GL-ACCT-LEN (PINDX)
  3760                 MOVE AL-UABON   TO  GL-ACCT-ATTRB (PINDX)
  3761                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3762     ELSE
  3763         IF PI-COMPANY-ID = 'WSL'
  3764           AND PI-FILE-SEQ-NO (NDX) = ZEROS
  3765             MOVE ER-2596        TO  EMI-ERROR
  3766             MOVE -1             TO  GL-ACCT-LEN (PINDX)
  3767             MOVE AL-UABON       TO  GL-ACCT-ATTRB (PINDX)
  3768             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3769
  3770
  3771     IF GL-ACCT-LEN (PINDX) NOT = ZEROES
  3772*        MOVE K-SPACE            TO COFA-FILLER
  3773*        MOVE '0001'             TO COFA-COMPANY-X
  3774*        MOVE MSA-ACCT (PINDX)   TO COFA-MSA-ACCT
  3775         MOVE AL-UANON           TO GL-ACCT-ATTRB (PINDX)
  3776     ELSE
  3777         IF PI-FILE-SEQ-NO (NDX) = ZEROES
  3778             MOVE -1             TO GL-ACCT-LEN (PINDX)
  3779             MOVE ER-2957        TO EMI-ERROR
  3780             MOVE AL-UABON       TO GL-ACCT-ATTRB (PINDX)
  3781             PERFORM 9900-ERROR-FORMAT THRU
  3782                     9900-EXIT
  3783             GO TO 1040-CONTINUE-EDIT
  3784         ELSE
  3785             GO TO 1040-CONTINUE-EDIT
  3786         END-IF
  3787     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  75
* EL633.cbl
  3788
  3789     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
  3790        AND (RTYPE (PINDX) = 'P')
  3791        GO TO 1040-CONTINUE-EDIT
  3792     END-IF
  3793     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3794        MOVE GL-ACCT (PINDX)     TO CHECK-GL-ACCT
  3795     ELSE
  3796        MOVE SPACES              TO CHECK-GL-ACCT
  3797     END-IF
  3798
  3799     EVALUATE TRUE
  3800        WHEN (PI-COMPANY-ID = 'DCC')
  3801           AND (CO-CARRIER = '1' OR '2' or '9')
  3802           AND (VALID-DCC-GL-ACCOUNT)
  3803           GO TO 1040-CONTINUE-EDIT
  3804        WHEN (PI-COMPANY-ID = 'DCC')
  3805           AND (CO-CARRIER = '3' OR '4')
  3806           AND VALID-CSI-GL-ACCOUNT
  3807           GO TO 1040-CONTINUE-EDIT
  3808        WHEN (PI-COMPANY-ID = 'DCC')
  3809           AND (CO-CARRIER = '5' OR '6' or '7')
  3810           AND (VALID-CCC-GL-ACCOUNT)
  3811           GO TO 1040-CONTINUE-EDIT
  3812        WHEN (PI-COMPANY-ID = 'CID' OR 'AHL')
  3813           AND (VALID-GL-ACCOUNT)
  3814           GO TO 1040-CONTINUE-EDIT
  3815        WHEN (PI-COMPANY-ID = 'VPP')
  3816           AND (VALID-VPP-GL-ACCOUNT)
  3817           GO TO 1040-CONTINUE-EDIT
  3818        WHEN (PI-COMPANY-ID = 'FNL')
  3819           AND (VALID-FNL-GL-ACCOUNT)
  3820           GO TO 1040-CONTINUE-EDIT
  3821     END-EVALUATE
  3822*    EXEC CICS HANDLE CONDITION
  3823*         NOTFND (1040-NO-COFA-MSTR)
  3824*         NOTOPEN (7100-COFA-FILE-NOTOPEN)
  3825*    END-EXEC.
  3826*
  3827*    EXEC CICS READ
  3828*         DATASET (COFA-FILE-ID)
  3829*         SET     (ADDRESS OF CHART-OF-ACCOUNTS)
  3830*         RIDFLD  (COFA-KEY-X)
  3831*    END-EXEC.
  3832*
  3833*    MOVE CHART-OF-ACCOUNTS      TO SV-COFA.
  3834*    GO TO 1040-CONTINUE-EDIT.
  3835*
  3836*1040-NO-COFA-MSTR.
  3837
  3838     MOVE ER-2960                TO EMI-ERROR.
  3839     MOVE -1                     TO GL-ACCT-LEN (PINDX).
  3840     MOVE AL-UABON               TO GL-ACCT-ATTRB (PINDX).
  3841     PERFORM 9900-ERROR-FORMAT THRU
  3842             9900-EXIT.
  3843
  3844 1040-CONTINUE-EDIT.
  3845
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  76
* EL633.cbl
  3846*    MOVE MSA-ACCT (PINDX)       TO WS-ACCT-BREAK.
  3847     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  3848         MOVE GL-STATE (PINDX)   TO CHECK-STATE-CODE
  3849         IF NOT VALID-STATE-CODE
  3850             MOVE -1             TO GL-STATE-LEN (PINDX)
  3851             MOVE ER-2957        TO EMI-ERROR
  3852             MOVE AL-UABON       TO GL-STATE-ATTRB (PINDX)
  3853             PERFORM 9900-ERROR-FORMAT THRU
  3854                     9900-EXIT
  3855         ELSE
  3856             MOVE AL-UANON       TO GL-STATE-ATTRB (PINDX)
  3857         END-IF
  3858     END-IF.
  3859
  3860 1040-CSO-SKIP.
  3861
  3862     IF GL-CANC (PINDX) = LOW-VALUES
  3863         MOVE SPACES             TO GL-CANC (PINDX)
  3864     END-IF.
  3865
  3866     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  3867         MOVE GL-CANC (PINDX)    TO CHECK-CANC-TYPE
  3868         IF NOT VALID-CANC-TYPE
  3869             MOVE -1             TO GL-CANC-LEN (PINDX)
  3870             MOVE ER-2958        TO EMI-ERROR
  3871             MOVE AL-UABON       TO GL-CANC-ATTRB (PINDX)
  3872             PERFORM 9900-ERROR-FORMAT THRU
  3873                     9900-EXIT
  3874         ELSE
  3875             MOVE AL-UANON       TO GL-CANC-ATTRB (PINDX)
  3876         END-IF
  3877     END-IF.
  3878
  3879     IF RTYPE-LEN (PINDX) NOT = ZEROS
  3880        MOVE RTYPE (PINDX)       TO  CHECK-REC-TYPE
  3881        IF (PI-COMPANY-ID = 'DCC' or 'VPP')
  3882           AND (RTYPE (PINDX) = 'P')
  3883           SET VALID-REC-TYPE   TO TRUE
  3884        END-IF
  3885         IF NOT VALID-REC-TYPE
  3886             MOVE -1             TO  RTYPE-LEN (PINDX)
  3887             MOVE ER-2234        TO  EMI-ERROR
  3888             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3889             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3890         ELSE
  3891             MOVE AL-UANON       TO  RTYPE-ATTRB (PINDX)
  3892     ELSE
  3893         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3894             MOVE -1             TO  RTYPE-LEN (PINDX)
  3895             MOVE ER-2235        TO  EMI-ERROR
  3896             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3897             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3898
  3899     IF AMT-LEN (PINDX) NOT = ZEROS
  3900
  3901* EXEC CICS BIF DEEDIT
  3902*           FIELD (AMT (PINDX))
  3903*           LENGTH (11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  77
* EL633.cbl
  3904*       END-EXEC
  3905     MOVE 11
  3906       TO DFHEIV11
  3907*    MOVE '@"L                   #   #00003778' TO DFHEIV0
  3908     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3909     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3910     MOVE X'2020233030303033373738' TO DFHEIV0(25:11)
  3911     CALL 'kxdfhei1' USING DFHEIV0,
  3912           AMT(PINDX),
  3913           DFHEIV11
  3914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3915         IF AMT (PINDX) = ZEROS
  3916             IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3917                 NEXT SENTENCE
  3918             ELSE
  3919                 MOVE ER-2245    TO  EMI-ERROR
  3920                 MOVE -1         TO  AMT-LEN(PINDX)
  3921                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3922                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3923         ELSE
  3924             IF AMT (PINDX) NUMERIC
  3925                 MOVE AMT (PINDX) TO  AMTO (PINDX)
  3926             ELSE
  3927                 MOVE ER-2245    TO  EMI-ERROR
  3928                 MOVE -1         TO  AMT-LEN(PINDX)
  3929                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3930                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3931     ELSE
  3932         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3933             MOVE -1             TO  AMT-LEN (PINDX)
  3934             MOVE ER-2236        TO  EMI-ERROR
  3935             MOVE AL-UNBON       TO  AMT-ATTRB (PINDX)
  3936             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3937
  3938     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  3939         IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3940           AND (PI-REC-TYPE (NDX) = 'C')
  3941             IF VOID-SW (PINDX) = 'V'
  3942                 MOVE AL-UANON   TO  VOID-SW-ATTRB (PINDX)
  3943             ELSE
  3944                 MOVE ER-2246    TO  EMI-ERROR
  3945                 MOVE -1         TO  VOID-SW-LEN (PINDX)
  3946                 MOVE AL-UABON   TO  VOID-SW-ATTRB (PINDX)
  3947                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3948         ELSE
  3949             MOVE ER-2449        TO  EMI-ERROR
  3950             MOVE -1             TO  VOID-SW-LEN (PINDX)
  3951             MOVE AL-UABON       TO  VOID-SW-ATTRB (PINDX)
  3952             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3953
  3954     IF SDTE-LEN (PINDX) = ZEROS
  3955        GO TO 1020-INCREMENT-PINDX.
  3956
  3957     MOVE AL-UNNON               TO  SDTE-ATTRB (PINDX).
  3958
  3959     MOVE SDTE (PINDX)           TO DEEDIT-FIELD.
  3960     PERFORM 8600-DEEDIT.
  3961
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  78
* EL633.cbl
  3962     IF DEEDIT-FIELD-V0 NOT NUMERIC
  3963        GO TO 1015-DAY-ERROR.
  3964
  3965     MOVE DEEDIT-FIELD-V0        TO  DC-GREG-DATE-1-MDY.
  3966     MOVE '4'                    TO  DC-OPTION-CODE.
  3967     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  3968
  3969     IF NO-CONVERSION-ERROR
  3970        SET PINDEX               TO  PINDX
  3971        MOVE DC-BIN-DATE-1       TO  WS-EOM-DT (PINDEX)
  3972     ELSE
  3973        GO TO 1015-DAY-ERROR.
  3974
  3975     MOVE DEEDIT-FIELD-V0        TO DATE-TEST-AREA.
  3976
  3977     IF DATE-TEST-MM = 4 OR  6  OR  9  OR  11
  3978         IF DATE-TEST-DD  NOT = 30
  3979             GO TO 1015-DAY-ERROR
  3980         ELSE
  3981             GO TO 1020-INCREMENT-PINDX.
  3982
  3983     IF DATE-TEST-MM = 1 OR  3  OR  5  OR  7  OR
  3984                             8  OR  10  OR  12
  3985         IF DATE-TEST-DD  NOT = 31
  3986             GO TO 1015-DAY-ERROR
  3987         ELSE
  3988             GO TO 1020-INCREMENT-PINDX.
  3989
  3990     DIVIDE DATE-TEST-YY  BY  4  GIVING  DIVIDE-RESULT
  3991         REMAINDER  DIVIDE-REMAINDER.
  3992
  3993     IF (DATE-TEST-YY = ZERO)
  3994       OR (DIVIDE-REMAINDER NOT = ZERO)
  3995         IF DATE-TEST-DD  NOT = 28
  3996             GO TO 1015-DAY-ERROR
  3997         ELSE
  3998             GO TO 1020-INCREMENT-PINDX
  3999     ELSE
  4000         IF DATE-TEST-DD = 29
  4001             GO TO 1020-INCREMENT-PINDX.
  4002
  4003 1015-DAY-ERROR.
  4004     MOVE -1                     TO  SDTE-LEN (PINDX).
  4005     MOVE AL-UNBON               TO  SDTE-ATTRB (PINDX).
  4006     MOVE ER-0587                TO  EMI-ERROR.
  4007
  4008     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4009
  4010 1020-INCREMENT-PINDX.
  4011     SET PINDX  UP  BY  1.
  4012
  4013     IF PINDX  IS NOT GREATER THAN  13
  4014         GO TO 1010-EDIT-LOOP.
  4015
  4016     IF EMI-ERROR = ZEROS
  4017         NEXT SENTENCE
  4018     ELSE
  4019         MOVE 'S'                TO  PI-PREV-FUNCTION
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  79
* EL633.cbl
  4020         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  80
* EL633.cbl
  4022 2000-UPDATE-THE-FILE.
  4023     SET PINDX                   TO  ZERO-NDX.
  4024*    SET NDX                     TO  ZERO-NDX.
  4025*    SET NDX  UP  BY  1.
  4026
  4027     IF PI-PYAJ-FILE-SW = 'B'
  4028         MOVE WORK-SEQ-NO        TO  PI-FRST-FILE-SEQ-NO
  4029         MOVE RTYPE (PINDX)      TO  PI-FRST-RECORD-TYPE
  4030     ELSE
  4031         MOVE PI-LAST-FILE-SEQ-NO
  4032                                 TO  PI-SAV-FILE-SEQ-NO
  4033         MOVE PI-LAST-RECORD-TYPE
  4034                                 TO  PI-SAV-RECORD-TYPE.
  4035
  4036 2100-UPDATE-LOOP.
  4037     SET PINDX  UP  BY  1.
  4038     SET NDX                     TO  PINDX.
  4039
  4040     IF PINDX  IS GREATER THAN  13
  4041         GO TO 2200-UPDATE-COMPLETE.
  4042
  4043     IF GL-ACCT-LEN (PINDX)   = ZEROS AND
  4044        GL-STATE-LEN (PINDX) = ZEROS AND
  4045        GL-CANC-LEN (PINDX)   = ZEROS AND
  4046        GL-COMM-LEN (PINDX)   = ZEROS AND
  4047        RTYPE-LEN (PINDX)   = ZEROS  AND
  4048        AMT-LEN (PINDX)     = ZEROS  AND
  4049        VOID-SW-LEN (PINDX) = ZEROS  AND
  4050        SDTE-LEN (PINDX)    = ZEROS
  4051         GO TO 2100-UPDATE-LOOP.
  4052
  4053
  4054* EXEC CICS BIF DEEDIT
  4055*         FIELD (AMT (PINDX))
  4056*         LENGTH (11)
  4057*    END-EXEC.
  4058     MOVE 11
  4059       TO DFHEIV11
  4060*    MOVE '@"L                   #   #00003920' TO DFHEIV0
  4061     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4062     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4063     MOVE X'2020233030303033393230' TO DFHEIV0(25:11)
  4064     CALL 'kxdfhei1' USING DFHEIV0,
  4065           AMT(PINDX),
  4066           DFHEIV11
  4067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4068
  4069
  4070     IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  4071         NEXT SENTENCE
  4072     ELSE
  4073         GO TO 2110-ADD-RECORD.
  4074
  4075
  4076* EXEC CICS HANDLE CONDITION
  4077*        NOTFND  (2110-ADD-RECORD)
  4078*    END-EXEC.
  4079*    MOVE '"$I                   ! % #00003930' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  81
* EL633.cbl
  4080     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4081     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4082     MOVE X'2520233030303033393330' TO DFHEIV0(25:11)
  4083     CALL 'kxdfhei1' USING DFHEIV0
  4084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4085
  4086
  4087     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4088     MOVE PI-FILE-SEQ-NO (NDX)    TO  PYAJ-FILE-SEQ-NO.
  4089     MOVE PI-REC-TYPE (NDX)       TO  PYAJ-RECORD-TYPE.
  4090
  4091
  4092* EXEC CICS READ
  4093*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4094*        DATASET  (PYAJ-FILE-ID)
  4095*        RIDFLD   (ERPYAJ-KEY)
  4096*        UPDATE
  4097*    END-EXEC.
  4098*    MOVE '&"S        EU         (   #00003938' TO DFHEIV0
  4099     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4100     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4101     MOVE X'2020233030303033393338' TO DFHEIV0(25:11)
  4102     CALL 'kxdfhei1' USING DFHEIV0,
  4103           PYAJ-FILE-ID,
  4104           DFHEIV20,
  4105           DFHEIV99,
  4106           ERPYAJ-KEY,
  4107           DFHEIV99,
  4108           DFHEIV99,
  4109           DFHEIV99
  4110     SET ADDRESS OF PENDING-PAY-ADJ TO
  4111         DFHEIV20
  4112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4113
  4114
  4115
  4116     IF RTYPE-LEN (PINDX)  GREATER THAN +0
  4117        IF RTYPE (PINDX) NOT = PY-RECORD-TYPE
  4118            MOVE PENDING-PAY-ADJ TO WS-SAVE-ERPYAJ
  4119            PERFORM 2190-CHANGE-RECORD-TYPE THRU 2190-EXIT
  4120            MOVE RTYPE (PINDX)     TO  PI-FRST-RECORD-TYPE.
  4121
  4122     IF AMT-LEN (PINDX) NOT = ZEROS
  4123         IF AMT (PINDX) = ZEROS
  4124             IF PY-CHECK-WRITTEN-DT = LOW-VALUES
  4125                 GO TO 2120-DELETE-RECORD
  4126             ELSE
  4127                 MOVE ER-2244       TO  EMI-ERROR
  4128                 MOVE -1            TO  AMT-LEN (PINDX)
  4129                 MOVE AL-UNBON      TO  AMT-ATTRB (PINDX)
  4130                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4131                 MOVE PY-ENTRY-AMT  TO  AMTO (PINDX)
  4132
  4133* EXEC CICS UNLOCK
  4134*                    DATASET  (PYAJ-FILE-ID)
  4135*                END-EXEC
  4136*    MOVE '&*                    #   #00003962' TO DFHEIV0
  4137     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  82
* EL633.cbl
  4138     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4139     MOVE X'2020233030303033393632' TO DFHEIV0(25:11)
  4140     CALL 'kxdfhei1' USING DFHEIV0,
  4141           PYAJ-FILE-ID,
  4142           DFHEIV99
  4143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4144                 GO TO 8200-SEND-DATAONLY.
  4145
  4146     MOVE 'B'                    TO  JP-RECORD-TYPE.
  4147     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4148     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4149
  4150     PERFORM 8400-LOG-JOURNAL-RECORD.
  4151
  4152     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4153     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4154     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT.
  4155
  4156     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  4157         MOVE GL-ACCT (PINDX)    TO  PY-GL-ACCOUNT.
  4158     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  4159         MOVE GL-STATE (PINDX)   TO  PY-GL-STATE.
  4160     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  4161         MOVE GL-CANC (PINDX)    TO  PY-GL-CANC-SW.
  4162     IF GL-COMM-LEN (PINDX) NOT = ZEROS
  4163         MOVE GL-COMM (PINDX)    TO  PY-GL-COMMENT.
  4164     IF AMT-LEN (PINDX) NOT = ZEROS
  4165         MOVE AMT (PINDX)        TO  PY-ENTRY-AMT.
  4166
  4167     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  4168         MOVE VOID-SW (PINDX)    TO  PY-VOID-SW.
  4169
  4170     IF SDTE-LEN (PINDX) NOT = ZEROS
  4171        SET PINDEX               TO  PINDX
  4172        MOVE WS-EOM-DT (PINDEX)  TO  PY-CREDIT-SELECT-DT.
  4173
  4174     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4175     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4176     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4177
  4178
  4179* EXEC CICS REWRITE
  4180*        DATASET  (PYAJ-FILE-ID)
  4181*        FROM     (PENDING-PAY-ADJ)
  4182*    END-EXEC.
  4183     MOVE LENGTH OF
  4184      PENDING-PAY-ADJ
  4185       TO DFHEIV11
  4186*    MOVE '&& L                  %   #00003999' TO DFHEIV0
  4187     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4188     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4189     MOVE X'2020233030303033393939' TO DFHEIV0(25:11)
  4190     CALL 'kxdfhei1' USING DFHEIV0,
  4191           PYAJ-FILE-ID,
  4192           PENDING-PAY-ADJ,
  4193           DFHEIV11,
  4194           DFHEIV99
  4195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  83
* EL633.cbl
  4196
  4197
  4198     PERFORM 8400-LOG-JOURNAL-RECORD.
  4199
  4200     GO TO 2100-UPDATE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  84
* EL633.cbl
  4202 2110-ADD-RECORD.
  4203
  4204* EXEC CICS GETMAIN
  4205*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4206*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4207*        INITIMG  (GETMAIN-SPACE)
  4208*    END-EXEC.
  4209*    MOVE ',"IL                  $   #00004009' TO DFHEIV0
  4210     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4211     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4212     MOVE X'2020233030303034303039' TO DFHEIV0(25:11)
  4213     CALL 'kxdfhei1' USING DFHEIV0,
  4214           DFHEIV20,
  4215           ERPYAJ-RECORD-LENGTH,
  4216           GETMAIN-SPACE
  4217     SET ADDRESS OF PENDING-PAY-ADJ TO
  4218         DFHEIV20
  4219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4220
  4221
  4222     MOVE 'PY'                   TO  PY-RECORD-ID.
  4223     MOVE PI-COMPANY-CD          TO  PY-COMPANY-CD.
  4224     MOVE PI-SAV-CARRIER         TO  PY-CARRIER.
  4225     MOVE PI-SAV-GROUPING        TO  PY-GROUPING.
  4226     MOVE PI-SAV-FIN-RESP        TO  PY-FIN-RESP.
  4227     MOVE PI-SAV-ACCOUNT         TO  PY-ACCOUNT.
  4228
  4229     ADD +1                      TO  WORK-SEQ-NO.
  4230     MOVE WORK-SEQ-NO            TO  PY-FILE-SEQ-NO.
  4231
  4232     MOVE GL-ACCT (PINDX)        TO  PY-GL-ACCOUNT.
  4233     if gl-state-len (pindx) <> zeros
  4234        MOVE GL-STATE (PINDX)    TO  PY-GL-STATE
  4235     end-if
  4236     if gl-canc-len (pindx) <> zeros
  4237        MOVE GL-CANC (PINDX)     TO  PY-GL-CANC-SW
  4238     end-if
  4239     MOVE GL-COMM (PINDX)        TO  PY-GL-COMMENT.
  4240
  4241     MOVE RTYPE (PINDX)          TO  PY-RECORD-TYPE.
  4242     MOVE AMT (PINDX)            TO  PY-ENTRY-AMT.
  4243     IF CO-TYPE = 'B' OR 'A' OR 'G'
  4244        MOVE CO-TYPE             TO  PY-ERCOMP-TYPE
  4245     END-IF
  4246     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4247     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4248     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT
  4249                                     PY-INPUT-DT.
  4250     MOVE ZEROS                  TO  PY-CHECK-QUE-CONTROL
  4251                                     PY-CHECK-QUE-SEQUENCE.
  4252     MOVE LOW-VALUES             TO  PY-CREDIT-ACCEPT-DT
  4253                                     PY-BILLED-DATE
  4254                                     PY-AR-DATE
  4255                                     PY-REPORTED-DT
  4256                                     PY-CHECK-WRITTEN-DT.
  4257     IF SDTE-LEN (PINDX) = ZEROS
  4258         MOVE PI-CR-MONTH-END-DT TO  PY-CREDIT-SELECT-DT
  4259         GO TO 2115-WRITE-REC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  85
* EL633.cbl
  4260     END-IF.
  4261
  4262     IF SDTE (PINDX) IS NUMERIC
  4263         MOVE SDTE (PINDX)   TO  DC-GREG-DATE-1-MDY
  4264         MOVE '4'            TO  DC-OPTION-CODE
  4265         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  4266         IF DATE-CONVERSION-ERROR
  4267             MOVE PI-CR-MONTH-END-DT
  4268                             TO  PY-CREDIT-SELECT-DT
  4269         ELSE
  4270             MOVE DC-BIN-DATE-1
  4271                             TO  PY-CREDIT-SELECT-DT
  4272         END-IF
  4273     ELSE
  4274         MOVE PI-CR-MONTH-END-DT
  4275                             TO  PY-CREDIT-SELECT-DT
  4276     END-IF
  4277
  4278     IF PI-SAV-FILE-SEQ-NO NOT GREATER THAN ZEROS
  4279         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4280         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4281
  4282     IF FIRST-ADD AND END-OF-ACCT-FULL-PAGE
  4283         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4284         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4285
  4286     MOVE 'N'                    TO  FIRST-ADD-SW.
  4287
  4288     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4289     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4290     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4291 2115-WRITE-REC.
  4292
  4293* EXEC CICS WRITE
  4294*        DATASET  (PYAJ-FILE-ID)
  4295*        FROM     (PENDING-PAY-ADJ)
  4296*        RIDFLD   (PY-CONTROL-PRIMARY)
  4297*    END-EXEC.
  4298     MOVE LENGTH OF
  4299      PENDING-PAY-ADJ
  4300       TO DFHEIV11
  4301*    MOVE '&$ L                  ''   #00004085' TO DFHEIV0
  4302     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4303     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4304     MOVE X'2020233030303034303835' TO DFHEIV0(25:11)
  4305     CALL 'kxdfhei1' USING DFHEIV0,
  4306           PYAJ-FILE-ID,
  4307           PENDING-PAY-ADJ,
  4308           DFHEIV11,
  4309           PY-CONTROL-PRIMARY,
  4310           DFHEIV99,
  4311           DFHEIV99
  4312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4313
  4314
  4315     PERFORM 8400-LOG-JOURNAL-RECORD.
  4316
  4317     GO TO 2100-UPDATE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  86
* EL633.cbl
  4318
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  87
* EL633.cbl
  4320 2120-DELETE-RECORD.
  4321     IF PY-RECORD-TYPE NOT = 'C'
  4322         GO TO 2120-DELETE-CONT.
  4323
  4324     IF PY-CHECK-QUE-CONTROL = ZEROS
  4325       AND PY-CHECK-QUE-SEQUENCE = ZEROS
  4326         GO TO 2120-DELETE-CONT.
  4327
  4328
  4329* EXEC CICS HANDLE CONDITION
  4330*        NOTFND  (2120-DELETE-CONT)
  4331*    END-EXEC.
  4332*    MOVE '"$I                   ! & #00004104' TO DFHEIV0
  4333     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4334     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4335     MOVE X'2620233030303034313034' TO DFHEIV0(25:11)
  4336     CALL 'kxdfhei1' USING DFHEIV0
  4337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4338
  4339
  4340     MOVE PY-COMPANY-CD          TO  CHKQ-COMPANY-CD.
  4341     MOVE PY-CHECK-QUE-CONTROL   TO  CHKQ-CONTROL-NUMBER.
  4342     MOVE PY-CHECK-QUE-SEQUENCE  TO  CHKQ-SEQUENCE-NUMBER.
  4343
  4344
  4345* EXEC CICS READ
  4346*        SET      (ADDRESS OF CHECK-QUE)
  4347*        DATASET  (CHKQ-FILE-ID)
  4348*        RIDFLD   (ERCHKQ-KEY)
  4349*        UPDATE
  4350*    END-EXEC.
  4351*    MOVE '&"S        EU         (   #00004112' TO DFHEIV0
  4352     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4353     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4354     MOVE X'2020233030303034313132' TO DFHEIV0(25:11)
  4355     CALL 'kxdfhei1' USING DFHEIV0,
  4356           CHKQ-FILE-ID,
  4357           DFHEIV20,
  4358           DFHEIV99,
  4359           ERCHKQ-KEY,
  4360           DFHEIV99,
  4361           DFHEIV99,
  4362           DFHEIV99
  4363     SET ADDRESS OF CHECK-QUE TO
  4364         DFHEIV20
  4365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4366
  4367
  4368*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4369*    MOVE CHKQ-FILE-ID           TO  JP-FILE-ID.
  4370*    MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  4371*
  4372*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4373
  4374
  4375* EXEC CICS DELETE
  4376*        DATASET  (CHKQ-FILE-ID)
  4377*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  88
* EL633.cbl
  4378*    MOVE '&(                    &   #00004125' TO DFHEIV0
  4379     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4380     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4381     MOVE X'2020233030303034313235' TO DFHEIV0(25:11)
  4382     CALL 'kxdfhei1' USING DFHEIV0,
  4383           CHKQ-FILE-ID,
  4384           DFHEIV99,
  4385           DFHEIV99,
  4386           DFHEIV99,
  4387           DFHEIV99
  4388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4389
  4390
  4391 2120-DELETE-CONT.
  4392*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4393*    MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4394*    MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4395*
  4396*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4397
  4398     IF PI-SAV-ENDING-PYAJ-KEY = ERPYAJ-KEY
  4399         MOVE ZEROS              TO  PI-FRST-FILE-SEQ-NO
  4400         MOVE SPACE              TO  PI-FRST-RECORD-TYPE
  4401         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4402                                     PI-SAV-ACCT-NET
  4403                                     PI-SAV-PREV-AMT
  4404                                     PI-SAV-PREV-NET.
  4405
  4406
  4407* EXEC CICS DELETE
  4408*        DATASET(PYAJ-FILE-ID)
  4409*    END-EXEC.
  4410*    MOVE '&(                    &   #00004144' TO DFHEIV0
  4411     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4412     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4413     MOVE X'2020233030303034313434' TO DFHEIV0(25:11)
  4414     CALL 'kxdfhei1' USING DFHEIV0,
  4415           PYAJ-FILE-ID,
  4416           DFHEIV99,
  4417           DFHEIV99,
  4418           DFHEIV99,
  4419           DFHEIV99
  4420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4421
  4422
  4423     GO TO 2100-UPDATE-LOOP.
  4424
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  89
* EL633.cbl
  4426
  4427 2190-CHANGE-RECORD-TYPE.
  4428
  4429*    MOVE 'D'                   TO  JP-RECORD-TYPE.
  4430*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4431*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4432*
  4433*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4434
  4435
  4436* EXEC CICS DELETE
  4437*        DATASET(PYAJ-FILE-ID)
  4438*    END-EXEC.
  4439*    MOVE '&(                    &   #00004160' TO DFHEIV0
  4440     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4441     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4442     MOVE X'2020233030303034313630' TO DFHEIV0(25:11)
  4443     CALL 'kxdfhei1' USING DFHEIV0,
  4444           PYAJ-FILE-ID,
  4445           DFHEIV99,
  4446           DFHEIV99,
  4447           DFHEIV99,
  4448           DFHEIV99
  4449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4450
  4451
  4452
  4453* EXEC CICS GETMAIN
  4454*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4455*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4456*        INITIMG  (GETMAIN-SPACE)
  4457*    END-EXEC.
  4458*    MOVE ',"IL                  $   #00004164' TO DFHEIV0
  4459     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4460     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4461     MOVE X'2020233030303034313634' TO DFHEIV0(25:11)
  4462     CALL 'kxdfhei1' USING DFHEIV0,
  4463           DFHEIV20,
  4464           ERPYAJ-RECORD-LENGTH,
  4465           GETMAIN-SPACE
  4466     SET ADDRESS OF PENDING-PAY-ADJ TO
  4467         DFHEIV20
  4468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4469
  4470
  4471*    MOVE JP-RECORD-AREA        TO  PENDING-PAY-ADJ.
  4472*    MOVE ERPYAJ-KEY            TO  PY-CONTROL-PRIMARY.
  4473
  4474     MOVE WS-SAVE-ERPYAJ        TO  PENDING-PAY-ADJ
  4475     MOVE RTYPE (PINDX)         TO  PY-RECORD-TYPE
  4476                                    PYAJ-RECORD-TYPE.
  4477
  4478
  4479* EXEC CICS HANDLE CONDITION
  4480*        DUPREC (2190-DUP-RECORD)
  4481*    END-EXEC.
  4482*    MOVE '"$%                   ! '' #00004177' TO DFHEIV0
  4483     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  90
* EL633.cbl
  4484     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4485     MOVE X'2720233030303034313737' TO DFHEIV0(25:11)
  4486     CALL 'kxdfhei1' USING DFHEIV0
  4487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4488
  4489
  4490*    MOVE 'A'                   TO  JP-RECORD-TYPE.
  4491*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4492*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4493
  4494 2190-RETRY-WRITE.
  4495
  4496
  4497* EXEC CICS WRITE
  4498*        DATASET  (PYAJ-FILE-ID)
  4499*        FROM     (PENDING-PAY-ADJ)
  4500*        RIDFLD   (PY-CONTROL-PRIMARY)
  4501*    END-EXEC.
  4502     MOVE LENGTH OF
  4503      PENDING-PAY-ADJ
  4504       TO DFHEIV11
  4505*    MOVE '&$ L                  ''   #00004187' TO DFHEIV0
  4506     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4507     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4508     MOVE X'2020233030303034313837' TO DFHEIV0(25:11)
  4509     CALL 'kxdfhei1' USING DFHEIV0,
  4510           PYAJ-FILE-ID,
  4511           PENDING-PAY-ADJ,
  4512           DFHEIV11,
  4513           PY-CONTROL-PRIMARY,
  4514           DFHEIV99,
  4515           DFHEIV99
  4516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4517
  4518
  4519*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4520
  4521
  4522* EXEC CICS READ
  4523*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4524*        DATASET  (PYAJ-FILE-ID)
  4525*        RIDFLD   (ERPYAJ-KEY)
  4526*        UPDATE
  4527*    END-EXEC.
  4528*    MOVE '&"S        EU         (   #00004195' TO DFHEIV0
  4529     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4530     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4531     MOVE X'2020233030303034313935' TO DFHEIV0(25:11)
  4532     CALL 'kxdfhei1' USING DFHEIV0,
  4533           PYAJ-FILE-ID,
  4534           DFHEIV20,
  4535           DFHEIV99,
  4536           ERPYAJ-KEY,
  4537           DFHEIV99,
  4538           DFHEIV99,
  4539           DFHEIV99
  4540     SET ADDRESS OF PENDING-PAY-ADJ TO
  4541         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  91
* EL633.cbl
  4542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4543
  4544
  4545     GO TO 2190-EXIT.
  4546
  4547 2190-DUP-RECORD.
  4548
  4549     COMPUTE PY-FILE-SEQ-NO = PY-FILE-SEQ-NO + 1.
  4550
  4551     GO TO 2190-RETRY-WRITE.
  4552
  4553 2190-EXIT.
  4554     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  92
* EL633.cbl
  4556
  4557 2200-UPDATE-COMPLETE.
  4558     IF EIBAID = DFHPF1
  4559         GO TO 4000-BROWSE-FRWD.
  4560
  4561     IF EIBAID = DFHPF2
  4562         GO TO 4100-BROWSE-BKWD.
  4563
  4564     MOVE LOW-VALUES             TO  EL633AI.
  4565
  4566     MOVE ER-0000                TO  EMI-ERROR.
  4567     MOVE -1                     TO  MAINTL.
  4568
  4569     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4570
  4571     MOVE PI-FRST-FILE-SEQ-NO    TO  PI-SAV-FILE-SEQ-NO.
  4572     MOVE PI-FRST-RECORD-TYPE    TO  PI-SAV-RECORD-TYPE.
  4573
  4574*    GO TO 4000-BROWSE-FRWD.
  4575
  4576*    GO TO 8100-SEND-INITIAL-MAP.
  4577
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  93
* EL633.cbl
  4579 4000-BROWSE-FRWD.
  4580     MOVE '1'                     TO  PI-PREV-PFKEY.
  4581     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4582
  4583     IF EIBAID = DFHPF1
  4584         IF PAGE-FULL
  4585             MOVE PI-FILE-SEQ-NO (PI-FULL-INDX)
  4586                                      TO  PYAJ-FILE-SEQ-NO
  4587             MOVE HIGH-VALUES         TO  PYAJ-RECORD-TYPE
  4588             MOVE 'N'                 TO  PYAJ-READ-SW
  4589             MOVE PI-SAV-ACCT-AMT     TO  TOTAL-ACCT-AMT
  4590             MOVE PI-SAV-ACCT-NET     TO  TOTAL-ACCT-NET
  4591             MOVE PI-SAV-ACCT-AMT     TO  PI-SAV-PREV-AMT
  4592             MOVE PI-SAV-ACCT-NET     TO  PI-SAV-PREV-NET
  4593         ELSE
  4594             MOVE ZEROS               TO  PI-SAV-ACCT-AMT
  4595                                          PI-SAV-ACCT-NET
  4596                                          PI-SAV-PREV-AMT
  4597                                          PI-SAV-PREV-NET
  4598             MOVE 'Y'                 TO  PI-PAGE-SW
  4599             IF NOT END-OF-FILE
  4600                 MOVE 99999999        TO  PYAJ-FILE-SEQ-NO
  4601                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4602             END-IF
  4603             IF TOP-OF-FILE
  4604                 MOVE SPACES          TO  PI-PYAJ-FILE-SW
  4605                 MOVE ZEROS           TO  PYAJ-FILE-SEQ-NO
  4606                 MOVE SPACES          TO  PYAJ-RECORD-TYPE
  4607             ELSE
  4608                 MOVE -1              TO  PYAJ-FILE-SEQ-NO
  4609                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4610     ELSE
  4611         MOVE PI-SAV-PREV-AMT         TO  TOTAL-ACCT-AMT
  4612         MOVE PI-SAV-PREV-NET         TO  TOTAL-ACCT-NET
  4613         IF MAINTI = 'S'
  4614             MOVE ZEROS               TO  PYAJ-FILE-SEQ-NO
  4615             MOVE SPACES              TO  PYAJ-RECORD-TYPE.
  4616
  4617
  4618     MOVE SPACE                  TO  PI-PYAJ-FILE-SW.
  4619
  4620     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4621         MOVE PI-CARRIER-SECURITY  TO  PYAJ-CARRIER.
  4622
  4623 4000-BROWSE-FRWD-FOR-PREV.
  4624*    IF END-OF-FILE
  4625*        IF EIBAID = DFHPF1
  4626*           IF PI-TOTAL-DISPLAYED
  4627*              NEXT SENTENCE
  4628*           ELSE
  4629*              MOVE -1                 TO  MAINTL
  4630*              MOVE ER-2237            TO  EMI-ERROR
  4631*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4632*              MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4633*              SET PINDX               TO  +2
  4634*              MOVE 'TOTAL'            TO  COMM (PINDX)
  4635*              MOVE PI-SAV-ACCT-AMT    TO  AMTO (PINDX)
  4636*              SET PINDEX UP BY 1
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  94
* EL633.cbl
  4637*              MOVE 'NET TOTAL'        TO  COMM (PINDX)
  4638*              MOVE PI-SAV-ACCT-NET    TO  AMTO (PINDX)
  4639*              MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4640*                                          PI-SAV-ACCT-NET
  4641*              GO TO 8100-SEND-INITIAL-MAP.
  4642*
  4643*     IF END-OF-FILE
  4644*        IF EIBAID = DFHPF1
  4645*           MOVE -1             TO  MAINTL
  4646*           MOVE ER-2237        TO  EMI-ERROR
  4647*           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4648*           GO TO 8200-SEND-DATAONLY.
  4649*
  4650     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4651
  4652     IF NO-RECORDS
  4653        MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4654        MOVE LOW-VALUES         TO  EL633AO
  4655        MOVE ER-2239            TO  EMI-ERROR
  4656        MOVE -1                 TO  MAINTL
  4657        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4658        GO TO 8100-SEND-INITIAL-MAP.
  4659
  4660     IF NOT-OPEN
  4661         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4662
  4663     MOVE LOW-VALUES             TO  EL633AO.
  4664     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4665
  4666     PERFORM 6000-READ-AND-FORMAT-SCREEN  THRU  6200-EXIT
  4667          VARYING  PINDX  FROM  1  BY  1
  4668             UNTIL  END-OF-ACCT
  4669                 OR  END-OF-FILE
  4670                     OR  PAGE-FULL
  4671                         OR  NO-RECORDS.
  4672
  4673     IF NO-RECORDS
  4674         MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4675         MOVE LOW-VALUES         TO  EL633AO
  4676         MOVE ER-2239            TO  EMI-ERROR
  4677         MOVE -1                 TO  MAINTL
  4678         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4679         GO TO 8100-SEND-INITIAL-MAP.
  4680
  4681     IF END-OF-FILE
  4682         IF EIBAID = DFHPF2
  4683             MOVE ER-2238        TO  EMI-ERROR
  4684             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4685             MOVE 'T'            TO  PI-PYAJ-FILE-SW
  4686         ELSE
  4687             MOVE ER-2237        TO  EMI-ERROR
  4688             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4689
  4690     MOVE 'S'                    TO  PI-PREV-FUNCTION
  4691                                     PI-SAV-FUNCTION.
  4692
  4693     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  95
* EL633.cbl
  4695 4100-BROWSE-BKWD.
  4696     MOVE SPACE                   TO  PI-PYAJ-FILE-SW
  4697                                      PI-TOTAL-DISPLAYED-SW.
  4698     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4699     MOVE ZEROS                   TO  PYAJ-FILE-SEQ-NO.
  4700     MOVE ZEROS                   TO  PYAJ-RECORD-TYPE.
  4701     MOVE ZEROS                   TO  PI-SAV-ACCT-AMT
  4702                                      PI-SAV-ACCT-NET
  4703                                      PI-SAV-PREV-AMT
  4704                                      PI-SAV-PREV-NET.
  4705
  4706     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4707
  4708     IF NO-RECORDS
  4709         MOVE SPACES             TO  PI-PYAJ-FILE-SW
  4710         MOVE LOW-VALUES         TO  EL633AO
  4711         MOVE ER-2239            TO  EMI-ERROR
  4712         MOVE -1                 TO  MAINTL
  4713         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4714         GO TO 8100-SEND-INITIAL-MAP.
  4715
  4716     IF NOT-OPEN
  4717         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4718
  4719
  4720* EXEC CICS READNEXT
  4721*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4722*        DATASET  (PYAJ-FILE-ID)
  4723*        RIDFLD   (ERPYAJ-KEY)
  4724*    END-EXEC.
  4725     MOVE 0
  4726       TO DFHEIV11
  4727*    MOVE '&.S                   )   #00004376' TO DFHEIV0
  4728     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4729     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4730     MOVE X'2020233030303034333736' TO DFHEIV0(25:11)
  4731     CALL 'kxdfhei1' USING DFHEIV0,
  4732           PYAJ-FILE-ID,
  4733           DFHEIV20,
  4734           DFHEIV99,
  4735           ERPYAJ-KEY,
  4736           DFHEIV99,
  4737           DFHEIV11,
  4738           DFHEIV99,
  4739           DFHEIV99
  4740     SET ADDRESS OF PENDING-PAY-ADJ TO
  4741         DFHEIV20
  4742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4743
  4744
  4745     IF FIRST-PAGE OR
  4746        PI-PREV-PFKEY = '2'
  4747         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT
  4748         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT.
  4749
  4750     PERFORM 5200-END-BROWSE  THRU  5200-EXIT.
  4751
  4752     MOVE ZEROS                  TO  PYAJ-FILE-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  96
* EL633.cbl
  4753     MOVE SPACES                 TO  PYAJ-RECORD-TYPE.
  4754     MOVE '2'                     TO  PI-PREV-PFKEY.
  4755
  4756     GO TO 4000-BROWSE-FRWD-FOR-PREV.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  97
* EL633.cbl
  4758 5000-START-BROWSE.
  4759
  4760* EXEC CICS HANDLE CONDITION
  4761*        NOTOPEN  (5010-NOT-OPEN)
  4762*        NOTFND   (5020-NO-RECORDS)
  4763*        ENDFILE  (5020-NO-RECORDS)
  4764*    END-EXEC.
  4765*    MOVE '"$JI''                 ! ( #00004396' TO DFHEIV0
  4766     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  4767     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4768     MOVE X'2820233030303034333936' TO DFHEIV0(25:11)
  4769     CALL 'kxdfhei1' USING DFHEIV0
  4770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4771
  4772
  4773
  4774* EXEC CICS STARTBR
  4775*        DATASET  (PYAJ-FILE-ID)
  4776*        RIDFLD   (ERPYAJ-KEY)
  4777*    END-EXEC.
  4778     MOVE 0
  4779       TO DFHEIV11
  4780*    MOVE '&,         G          &   #00004402' TO DFHEIV0
  4781     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4782     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4783     MOVE X'2020233030303034343032' TO DFHEIV0(25:11)
  4784     CALL 'kxdfhei1' USING DFHEIV0,
  4785           PYAJ-FILE-ID,
  4786           ERPYAJ-KEY,
  4787           DFHEIV99,
  4788           DFHEIV11,
  4789           DFHEIV99
  4790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4791
  4792
  4793     GO TO 5030-EXIT.
  4794
  4795 5010-NOT-OPEN.
  4796     MOVE 'Z'                    TO  PI-PYAJ-FILE-SW.
  4797
  4798     GO TO 5030-EXIT.
  4799
  4800 5020-NO-RECORDS.
  4801     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4802     MOVE 'Y'                    TO  PI-PYAJ-FILE-SW.
  4803
  4804 5030-EXIT.
  4805     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  98
* EL633.cbl
  4807 5100-READ-PREVIOUS.
  4808
  4809* EXEC CICS HANDLE CONDITION
  4810*        ENDFILE  (5110-END-OF-FILE)
  4811*        NOTFND   (5110-END-OF-FILE)
  4812*    END-EXEC.
  4813*    MOVE '"$''I                  ! ) #00004422' TO DFHEIV0
  4814     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4816     MOVE X'2920233030303034343232' TO DFHEIV0(25:11)
  4817     CALL 'kxdfhei1' USING DFHEIV0
  4818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4819
  4820
  4821
  4822* EXEC CICS READPREV
  4823*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4824*        DATASET  (PYAJ-FILE-ID)
  4825*        RIDFLD   (ERPYAJ-KEY)
  4826*    END-EXEC.
  4827     MOVE 0
  4828       TO DFHEIV11
  4829*    MOVE '&0S                   )   #00004427' TO DFHEIV0
  4830     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4831     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4832     MOVE X'2020233030303034343237' TO DFHEIV0(25:11)
  4833     CALL 'kxdfhei1' USING DFHEIV0,
  4834           PYAJ-FILE-ID,
  4835           DFHEIV20,
  4836           DFHEIV99,
  4837           ERPYAJ-KEY,
  4838           DFHEIV99,
  4839           DFHEIV11,
  4840           DFHEIV99,
  4841           DFHEIV99
  4842     SET ADDRESS OF PENDING-PAY-ADJ TO
  4843         DFHEIV20
  4844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4845
  4846
  4847     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4848         IF PI-CARRIER-SECURITY = PY-CARRIER
  4849             NEXT SENTENCE
  4850         ELSE
  4851             GO TO 5110-END-OF-FILE.
  4852
  4853     GO TO 5120-EXIT.
  4854
  4855 5110-END-OF-FILE.
  4856     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  4857     MOVE ER-2238                TO  EMI-ERROR.
  4858     MOVE -1                     TO  PFENTERL.
  4859
  4860     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4861
  4862     GO TO 8200-SEND-DATAONLY.
  4863
  4864 5120-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page  99
* EL633.cbl
  4865     EXIT.
  4866
  4867 5200-END-BROWSE.
  4868
  4869* EXEC CICS ENDBR
  4870*        DATASET  (PYAJ-FILE-ID)
  4871*    END-EXEC.
  4872     MOVE 0
  4873       TO DFHEIV11
  4874*    MOVE '&2                    $   #00004454' TO DFHEIV0
  4875     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4876     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4877     MOVE X'2020233030303034343534' TO DFHEIV0(25:11)
  4878     CALL 'kxdfhei1' USING DFHEIV0,
  4879           PYAJ-FILE-ID,
  4880           DFHEIV11,
  4881           DFHEIV99
  4882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4883
  4884
  4885 5200-EXIT.
  4886     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page 100
* EL633.cbl
  4888 6000-READ-AND-FORMAT-SCREEN.
  4889
  4890* EXEC CICS HANDLE CONDITION
  4891*        ENDFILE  (6100-END-OF-FILE)
  4892*        NOTFND   (6100-END-OF-FILE)
  4893*    END-EXEC.
  4894*    MOVE '"$''I                  ! * #00004462' TO DFHEIV0
  4895     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4896     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4897     MOVE X'2A20233030303034343632' TO DFHEIV0(25:11)
  4898     CALL 'kxdfhei1' USING DFHEIV0
  4899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4900
  4901
  4902*    MOVE SPACES                 TO  PI-TOTAL-DISPLAYED-SW.
  4903*    INITIALIZE  PI-SEQ-NOS.
  4904
  4905 6010-READ-NEXT.
  4906
  4907
  4908* EXEC CICS READNEXT
  4909*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4910*        DATASET  (PYAJ-FILE-ID)
  4911*        RIDFLD   (ERPYAJ-KEY)
  4912*    END-EXEC.
  4913     MOVE 0
  4914       TO DFHEIV11
  4915*    MOVE '&.S                   )   #00004472' TO DFHEIV0
  4916     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4917     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4918     MOVE X'2020233030303034343732' TO DFHEIV0(25:11)
  4919     CALL 'kxdfhei1' USING DFHEIV0,
  4920           PYAJ-FILE-ID,
  4921           DFHEIV20,
  4922           DFHEIV99,
  4923           ERPYAJ-KEY,
  4924           DFHEIV99,
  4925           DFHEIV11,
  4926           DFHEIV99,
  4927           DFHEIV99
  4928     SET ADDRESS OF PENDING-PAY-ADJ TO
  4929         DFHEIV20
  4930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4931
  4932
  4933     IF PI-COMPANY-CD NOT = PY-COMPANY-CD
  4934       AND PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4935         GO TO 6100-END-OF-FILE.
  4936
  4937     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4938         IF PY-CARRIER NOT = PI-CARRIER-SECURITY
  4939             IF PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4940                 GO TO 6100-END-OF-FILE.
  4941
  4942     IF PYAJ-1ST-READ
  4943       AND EIBAID NOT = DFHENTER
  4944       AND NOT PAGE-FULL
  4945         MOVE PY-CONTROL-PRIMARY TO  PI-SAV-ENDING-PYAJ-KEY
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page 101
* EL633.cbl
  4946         MOVE PY-CARRIER         TO  PI-CR-CARRIER
  4947         MOVE PY-GROUPING        TO  PI-CR-GROUPING
  4948         MOVE PY-FIN-RESP        TO  PI-CR-FIN-RESP
  4949         MOVE PY-ACCOUNT         TO  PI-CR-ACCOUNT.
  4950
  4951     IF PYAJ-1ST-READ
  4952         MOVE PI-SAV-ENDING-PYAJ-KEY
  4953                                 TO  PI-START-PYAJ-KEY.
  4954
  4955     IF PI-COMPANY-CD   = PY-COMPANY-CD  AND
  4956        PI-SAV-CARRIER  = PY-CARRIER     AND
  4957        PI-SAV-GROUPING = PY-GROUPING    AND
  4958        PI-SAV-FIN-RESP = PY-FIN-RESP    AND
  4959        PI-SAV-ACCOUNT  = PY-ACCOUNT
  4960         NEXT SENTENCE
  4961     ELSE
  4962         IF PYAJ-1ST-READ
  4963             MOVE 'Y'            TO  PI-PYAJ-FILE-SW
  4964             MOVE SPACE          TO  PYAJ-READ-SW
  4965             GO TO 6200-EXIT
  4966         ELSE
  4967             MOVE 'A'            TO  PI-PYAJ-FILE-SW
  4968             IF PINDX  IS LESS THAN  12
  4969                 SET PINDX  UP  BY  1
  4970                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4971                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4972                 SET PINDX  UP  BY  1
  4973                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4974                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4975                     GO TO 6200-EXIT
  4976             ELSE
  4977                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4978                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4979                 SET PINDX  UP  BY  1
  4980                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4981                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4982                 GO TO 6200-EXIT.
  4983
  4984*    MOVE ' '                    TO  PI-PYAJ-FILE-SW.
  4985
  4986     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  4987         GO TO 6000-READ-AND-FORMAT-SCREEN.
  4988
  4989*    SET PINDX  UP  BY +1.
  4990
  4991     SET WS-SAVE-INDEX-VALUE  TO  PINDX.
  4992
  4993     IF PINDX  IS GREATER THAN  13
  4994         MOVE 'F'                TO  PI-PYAJ-FILE-SW
  4995         MOVE +13                TO  PI-FULL-INDX
  4996         MOVE PI-FRST-FILE-SEQ-NO
  4997                                 TO  PI-LAST-FILE-SEQ-NO
  4998         MOVE PI-FRST-RECORD-TYPE
  4999                                 TO  PI-LAST-RECORD-TYPE
  5000         MOVE TOTAL-ACCT-AMT     TO  PI-SAV-ACCT-AMT
  5001         MOVE TOTAL-ACCT-NET     TO  PI-SAV-ACCT-NET
  5002         GO TO 6200-EXIT.
  5003
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page 102
* EL633.cbl
  5004     MOVE PY-FILE-SEQ-NO         TO  PI-PREV-FILE-SEQ-NO.
  5005     MOVE PY-RECORD-TYPE         TO  PI-PREV-RECORD-TYPE.
  5006
  5007     IF PYAJ-1ST-READ
  5008         MOVE SPACE              TO  PYAJ-READ-SW.
  5009
  5010     IF PINDX = 1
  5011         MOVE PI-PREV-FILE-SEQ-NO
  5012                                 TO  PI-FRST-FILE-SEQ-NO
  5013         MOVE PI-PREV-RECORD-TYPE
  5014                                 TO  PI-FRST-RECORD-TYPE
  5015         MOVE PI-PREV-FILE-SEQ-NO
  5016                                 TO  PI-LAST-FILE-SEQ-NO
  5017         MOVE PI-PREV-RECORD-TYPE
  5018                                 TO  PI-LAST-RECORD-TYPE.
  5019
  5020     SET NDX                     TO  PINDX.
  5021     SET WS-SAVE-NDX-VALUE       TO  NDX.
  5022
  5023     MOVE PY-FILE-SEQ-NO         TO  PI-FILE-SEQ-NO (NDX).
  5024
  5025     MOVE PY-GL-ACCOUNT          TO  GL-ACCT (PINDX).
  5026     MOVE PY-GL-STATE            TO  GL-STATE (PINDX).
  5027     MOVE PY-GL-CANC-SW          TO  GL-CANC (PINDX).
  5028     MOVE PY-GL-COMMENT          TO  GL-COMM (PINDX).
  5029     MOVE PY-ENTRY-AMT           TO  AMTO (PINDX).
  5030
  5031     ADD PY-ENTRY-AMT            TO  TOTAL-ACCT-AMT.
  5032
  5033     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'S' OR 'Z'
  5034         ADD PY-ENTRY-AMT        TO  TOTAL-ACCT-NET
  5035     ELSE
  5036         SUBTRACT PY-ENTRY-AMT  FROM  TOTAL-ACCT-NET.
  5037
  5038     MOVE PY-RECORD-TYPE         TO  RTYPE (PINDX)
  5039                                     PI-REC-TYPE (NDX).
  5040
  5041     IF PY-VOID-SW NOT = SPACE
  5042         MOVE PY-VOID-SW         TO  VOID-SW (PINDX).
  5043
  5044     IF PY-LAST-MAINT-DT = PREV-BIN-MAINT-DT
  5045         MOVE PREV-MAINT-DT      TO  MDTE (PINDX)
  5046     ELSE
  5047         MOVE PY-LAST-MAINT-DT   TO  DC-BIN-DATE-1
  5048                                     PREV-BIN-MAINT-DT
  5049         MOVE SPACE              TO  DC-OPTION-CODE
  5050         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5051* DAN    MOVE DC-GREG-DATE-1-EDIT
  5052         MOVE DC-GREG-DATE-1-MDY
  5053                                 TO  MDTE (PINDX)
  5054                                     PREV-MAINT-DT.
  5055
  5056*    IF PY-GL-COMMENT NOT = (LOW-VALUES OR SPACES OR ZEROS)
  5057     IF PY-GL-COMMENT NOT = (LOW-VALUES AND SPACES AND ZEROS)
  5058         INSPECT PY-GL-COMMENT CONVERTING LOW-VALUES TO SPACES
  5059         MOVE PY-GL-COMMENT      TO  GL-COMM (PINDX)
  5060*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
  5061*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page 103
* EL633.cbl
  5062     END-IF.
  5063
  5064     IF PY-BILLED-DATE NOT = LOW-VALUES
  5065         MOVE AL-SANOF           TO  GL-ACCT-ATTRB (PINDX)
  5066                                     AMT-ATTRB (PINDX)
  5067                                     VOID-SW-ATTRB (PINDX)
  5068         IF PY-BILLED-DATE = PREV-BIN-BL-DT
  5069             MOVE PREV-BL-DT     TO  BDTE (PINDX)
  5070         ELSE
  5071             MOVE PY-BILLED-DATE TO  DC-BIN-DATE-1
  5072                                     PREV-BIN-BL-DT
  5073             MOVE SPACE          TO  DC-OPTION-CODE
  5074             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5075* DAN        MOVE DC-GREG-DATE-1-EDIT
  5076             MOVE DC-GREG-DATE-1-MDY
  5077                                 TO  BDTE (PINDX)
  5078                                     PREV-BL-DT.
  5079
  5080     IF (PY-CHECK-ORIGIN-SW = LOW-VALUES OR SPACES OR 'G')
  5081         NEXT SENTENCE
  5082     ELSE
  5083         MOVE AL-SANOF           TO  RTYPE-ATTRB   (PINDX)
  5084                                     AMT-ATTRB     (PINDX).
  5085
  5086     IF PY-CREDIT-SELECT-DT NOT = LOW-VALUES
  5087         MOVE PY-CREDIT-SELECT-DT
  5088                                 TO  DC-BIN-DATE-1
  5089         MOVE SPACE              TO  DC-OPTION-CODE
  5090         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5091
  5092         MOVE DC-GREG-DATE-1-EDIT  TO  WS-GREG-STORE
  5093         MOVE WS-GS-MM             TO  WS-SS-MM
  5094         MOVE WS-GS-DD             TO  WS-SS-DD
  5095         MOVE WS-GS-YY             TO  WS-SS-YY
  5096         MOVE WS-SDTE-STORE        TO  SDTE (PINDX).
  5097     IF (PY-INPUT-DT NOT = WS-CURRENT-BIN-DT)
  5098        AND (PI-PROCESSOR-ID NOT = 'PEMA')
  5099         MOVE AL-SANOF           TO RTYPE-ATTRB    (PINDX)
  5100                                    AMT-ATTRB      (PINDX)
  5101                                    GL-ACCT-ATTRB  (PINDX)
  5102                                    GL-COMM-ATTRB  (PINDX)
  5103                                    VOID-SW-ATTRB  (PINDX)
  5104                                    GL-STATE-ATTRB (PINDX)
  5105                                    GL-CANC-ATTRB  (PINDX)
  5106                                    SDTE-ATTRB     (PINDX)
  5107
  5108     END-IF
  5109
  5110*    GO TO 6010-READ-NEXT.
  5111     GO TO 6200-EXIT.
  5112
  5113 6100-END-OF-FILE.
  5114     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  5115
  5116     IF PINDX  IS LESS THAN  12
  5117         SET PINDX  UP  BY  1
  5118         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5119         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page 104
* EL633.cbl
  5120         SET PINDX  UP  BY  1
  5121         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5122         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX)
  5123         MOVE 'Y'                TO  PI-TOTAL-DISPLAYED-SW
  5124     ELSE
  5125         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5126         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
  5127         SET PINDX  UP  BY  1
  5128         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5129         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX).
  5130
  5131 6200-EXIT.
  5132     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page 105
* EL633.cbl
  5134 7000-PYAJ-FILE-NOTOPEN.
  5135     MOVE -1                     TO  MAINTL.
  5136     MOVE ER-2232                TO  EMI-ERROR.
  5137
  5138     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5139
  5140     GO TO 8200-SEND-DATAONLY.
  5141
  5142 7100-COMP-FILE-NOTOPEN.
  5143     MOVE -1                     TO  MAINTL.
  5144     MOVE ER-2233                TO  EMI-ERROR.
  5145
  5146     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5147
  5148     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page 106
* EL633.cbl
  5150*
  5151*7100-COFA-FILE-NOTOPEN.
  5152*    MOVE -1                     TO PFENTERL.
  5153*    MOVE ER-2959                TO EMI-ERROR.
  5154*    PERFORM 9900-ERROR-FORMAT THRU
  5155*            9900-EXIT.
  5156*    GO TO 8200-SEND-DATAONLY.
  5157*
  5158 8100-SEND-INITIAL-MAP.
  5159     MOVE WS-CURRENT-DT          TO  DATEO.
  5160     MOVE EIBTIME                TO  TIME-IN.
  5161     MOVE TIME-OUT               TO  TIMEO.
  5162     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5163     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5164     MOVE -1                     TO  MAINTL.
  5165     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5166     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5167
  5168     IF EIBTRNID = TRANS-ID
  5169       OR EL640-TRANS-ID
  5170       OR EL642-TRANS-ID
  5171       OR EL652-TRANS-ID
  5172       OR EL6331-TRANS-ID
  5173         IF PI-SAV-ENDING-PYAJ-KEY NOT =  SPACES
  5174             MOVE PI-SAV-FUNCTION  TO  MAINTI
  5175             MOVE PI-SAV-CARRIER   TO  CARRIERO
  5176             MOVE PI-SAV-GROUPING  TO  GROUPO
  5177             MOVE PI-SAV-FIN-RESP  TO  FINRESPO
  5178             MOVE PI-SAV-ACCOUNT   TO  ACCTO
  5179             MOVE AL-UANON         TO  MAINTA
  5180                                       CARRIERA
  5181                                       GROUPA
  5182                                       FINRESPA
  5183                                       ACCTA
  5184         ELSE
  5185             NEXT SENTENCE.
  5186
  5187
  5188* EXEC CICS SEND
  5189*        MAP     (MAP-NAME)
  5190*        MAPSET  (MAPSET-NAME)
  5191*        FROM    (EL633AO)
  5192*        ERASE
  5193*        CURSOR
  5194*        END-EXEC.
  5195     MOVE LENGTH OF
  5196      EL633AO
  5197       TO DFHEIV12
  5198     MOVE -1
  5199       TO DFHEIV11
  5200*    MOVE '8$     CT  E    H L F ,   #00004732' TO DFHEIV0
  5201     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5202     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5203     MOVE X'2020233030303034373332' TO DFHEIV0(25:11)
  5204     CALL 'kxdfhei1' USING DFHEIV0,
  5205           MAP-NAME,
  5206           EL633AO,
  5207           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page 107
* EL633.cbl
  5208           MAPSET-NAME,
  5209           DFHEIV99,
  5210           DFHEIV99,
  5211           DFHEIV99,
  5212           DFHEIV11,
  5213           DFHEIV99,
  5214           DFHEIV99,
  5215           DFHEIV99
  5216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5217
  5218
  5219     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page 108
* EL633.cbl
  5221 8200-SEND-DATAONLY.
  5222     MOVE WS-CURRENT-DT          TO  DATEO.
  5223     MOVE EIBTIME                TO  TIME-IN.
  5224     MOVE TIME-OUT               TO  TIMEO.
  5225     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5226     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5227     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5228     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5229
  5230
  5231* EXEC CICS SEND
  5232*        MAP     (MAP-NAME)
  5233*        MAPSET  (MAPSET-NAME)
  5234*        FROM    (EL633AO)
  5235*        DATAONLY
  5236*        CURSOR
  5237*    END-EXEC.
  5238     MOVE LENGTH OF
  5239      EL633AO
  5240       TO DFHEIV12
  5241     MOVE -1
  5242       TO DFHEIV11
  5243*    MOVE '8$D    CT       H L F ,   #00004751' TO DFHEIV0
  5244     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5245     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5246     MOVE X'2020233030303034373531' TO DFHEIV0(25:11)
  5247     CALL 'kxdfhei1' USING DFHEIV0,
  5248           MAP-NAME,
  5249           EL633AO,
  5250           DFHEIV12,
  5251           MAPSET-NAME,
  5252           DFHEIV99,
  5253           DFHEIV99,
  5254           DFHEIV99,
  5255           DFHEIV11,
  5256           DFHEIV99,
  5257           DFHEIV99,
  5258           DFHEIV99
  5259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5260
  5261
  5262     GO TO 9100-RETURN-TRAN.
  5263
  5264 8300-SEND-TEXT.
  5265
  5266* EXEC CICS SEND TEXT
  5267*        FROM    (LOGOFF-TEXT)
  5268*        LENGTH  (LOGOFF-LENGTH)
  5269*        ERASE
  5270*        FREEKB
  5271*    END-EXEC.
  5272*    MOVE '8&      T  E F  H   F -   #00004762' TO DFHEIV0
  5273     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5274     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5275     MOVE X'2020233030303034373632' TO DFHEIV0(25:11)
  5276     CALL 'kxdfhei1' USING DFHEIV0,
  5277           LOGOFF-TEXT,
  5278           LOGOFF-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page 109
* EL633.cbl
  5279           DFHEIV99,
  5280           DFHEIV99,
  5281           DFHEIV99,
  5282           DFHEIV99,
  5283           DFHEIV99,
  5284           DFHEIV99,
  5285           DFHEIV99,
  5286           DFHEIV99,
  5287           DFHEIV99,
  5288           DFHEIV99
  5289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5290
  5291
  5292
  5293* EXEC CICS RETURN
  5294*    END-EXEC.
  5295*    MOVE '.(                    ''   #00004769' TO DFHEIV0
  5296     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5297     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5298     MOVE X'2020233030303034373639' TO DFHEIV0(25:11)
  5299     CALL 'kxdfhei1' USING DFHEIV0,
  5300           DFHEIV99,
  5301           DFHEIV99,
  5302           DFHEIV99,
  5303           DFHEIV99,
  5304           DFHEIV99,
  5305           DFHEIV99
  5306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5307
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page 110
* EL633.cbl
  5309 8400-LOG-JOURNAL-RECORD.
  5310*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  5311*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  5312
  5313*    EXEC CICS JOURNAL
  5314*        JFILEID  (PI-JOURNAL-FILE-ID)
  5315*        JTYPEID  ('EL')
  5316*        FROM     (JOURNAL-RECORD)
  5317*        LENGTH   (223)
  5318*        END-EXEC.
  5319
  5320 8500-DATE-CONVERT.
  5321
  5322* EXEC CICS LINK
  5323*        PROGRAM   (LINK-CLDATCV)
  5324*        COMMAREA  (DATE-CONVERSION-DATA)
  5325*        LENGTH    (DC-COMM-LENGTH)
  5326*    END-EXEC.
  5327*    MOVE '."C                   (   #00004784' TO DFHEIV0
  5328     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5329     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5330     MOVE X'2020233030303034373834' TO DFHEIV0(25:11)
  5331     CALL 'kxdfhei1' USING DFHEIV0,
  5332           LINK-CLDATCV,
  5333           DATE-CONVERSION-DATA,
  5334           DC-COMM-LENGTH,
  5335           DFHEIV99,
  5336           DFHEIV99,
  5337           DFHEIV99,
  5338           DFHEIV99
  5339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5340
  5341
  5342 8500-EXIT.
  5343     EXIT.
  5344
  5345 8600-DEEDIT.
  5346
  5347* EXEC CICS BIF DEEDIT
  5348*        FIELD   (DEEDIT-FIELD)
  5349*        LENGTH  (11)
  5350*    END-EXEC.
  5351     MOVE 11
  5352       TO DFHEIV11
  5353*    MOVE '@"L                   #   #00004794' TO DFHEIV0
  5354     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5355     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5356     MOVE X'2020233030303034373934' TO DFHEIV0(25:11)
  5357     CALL 'kxdfhei1' USING DFHEIV0,
  5358           DEEDIT-FIELD,
  5359           DFHEIV11
  5360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5361
  5362
  5363 8600-EXIT.
  5364     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page 111
* EL633.cbl
  5366 8800-UNAUTHORIZED-ACCESS.
  5367     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  5368
  5369     GO TO 8300-SEND-TEXT.
  5370
  5371 8810-PF23.
  5372     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  5373     MOVE XCTL-005               TO  PGM-NAME.
  5374
  5375     GO TO 9300-XCTL.
  5376
  5377 9100-RETURN-TRAN.
  5378     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  5379     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  5380
  5381
  5382* EXEC CICS RETURN
  5383*        TRANSID   (TRANS-ID)
  5384*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5385*        LENGTH    (PI-COMM-LENGTH)
  5386*    END-EXEC.
  5387*    MOVE '.(CT                  ''   #00004817' TO DFHEIV0
  5388     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5389     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5390     MOVE X'2020233030303034383137' TO DFHEIV0(25:11)
  5391     CALL 'kxdfhei1' USING DFHEIV0,
  5392           TRANS-ID,
  5393           PROGRAM-INTERFACE-BLOCK,
  5394           PI-COMM-LENGTH,
  5395           DFHEIV99,
  5396           DFHEIV99,
  5397           DFHEIV99
  5398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5399
  5400
  5401 9200-RETURN-MAIN-MENU.
  5402     MOVE XCTL-626               TO  PGM-NAME.
  5403
  5404     GO TO 9300-XCTL.
  5405
  5406 9300-XCTL.
  5407
  5408* EXEC CICS XCTL
  5409*        PROGRAM   (PGM-NAME)
  5410*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5411*        LENGTH    (PI-COMM-LENGTH)
  5412*    END-EXEC.
  5413*    MOVE '.$C                   %   #00004829' TO DFHEIV0
  5414     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5415     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5416     MOVE X'2020233030303034383239' TO DFHEIV0(25:11)
  5417     CALL 'kxdfhei1' USING DFHEIV0,
  5418           PGM-NAME,
  5419           PROGRAM-INTERFACE-BLOCK,
  5420           PI-COMM-LENGTH,
  5421           DFHEIV99
  5422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5423
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page 112
* EL633.cbl
  5424
  5425 9400-CLEAR.
  5426     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  5427
  5428     IF PI-RETURN-TO-PROGRAM = 'EL626'
  5429     MOVE SPACES                 TO  PI-CR-CONTROL-IN-PROGRESS
  5430                                     PI-SAV-COMP-CONTROL.
  5431
  5432     GO TO 9300-XCTL.
  5433
  5434 9500-PF12.
  5435     MOVE XCTL-010               TO  PGM-NAME.
  5436
  5437     GO TO 9300-XCTL.
  5438
  5439 9600-PGMID-ERROR.
  5440
  5441* EXEC CICS HANDLE CONDITION
  5442*        PGMIDERR  (8300-SEND-TEXT)
  5443*    END-EXEC.
  5444*    MOVE '"$L                   ! + #00004850' TO DFHEIV0
  5445     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5446     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5447     MOVE X'2B20233030303034383530' TO DFHEIV0(25:11)
  5448     CALL 'kxdfhei1' USING DFHEIV0
  5449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5450
  5451
  5452     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  5453     MOVE ' '                    TO  PI-ENTRY-CD-1.
  5454     MOVE XCTL-005               TO  PGM-NAME.
  5455     MOVE PGM-NAME               TO  LOGOFF-PGM.
  5456     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  5457
  5458     GO TO 9300-XCTL.
  5459
  5460 9900-ERROR-FORMAT.
  5461     IF NOT EMI-ERRORS-COMPLETE
  5462         MOVE LINK-001           TO  PGM-NAME
  5463
  5464* EXEC CICS LINK
  5465*            PROGRAM   (PGM-NAME)
  5466*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  5467*            LENGTH    (EMI-COMM-LENGTH)
  5468*        END-EXEC.
  5469*    MOVE '."C                   (   #00004865' TO DFHEIV0
  5470     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5471     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5472     MOVE X'2020233030303034383635' TO DFHEIV0(25:11)
  5473     CALL 'kxdfhei1' USING DFHEIV0,
  5474           PGM-NAME,
  5475           ERROR-MESSAGE-INTERFACE-BLOCK,
  5476           EMI-COMM-LENGTH,
  5477           DFHEIV99,
  5478           DFHEIV99,
  5479           DFHEIV99,
  5480           DFHEIV99
  5481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page 113
* EL633.cbl
  5482
  5483
  5484 9900-EXIT.
  5485     EXIT.
  5486
  5487 9990-ABEND.
  5488     MOVE LINK-004               TO  PGM-NAME.
  5489     MOVE DFHEIBLK               TO  EMI-LINE1.
  5490
  5491
  5492* EXEC CICS LINK
  5493*        PROGRAM   (PGM-NAME)
  5494*        COMMAREA  (EMI-LINE1)
  5495*        LENGTH    (72)
  5496*    END-EXEC.
  5497     MOVE 72
  5498       TO DFHEIV11
  5499*    MOVE '."C                   (   #00004878' TO DFHEIV0
  5500     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5501     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5502     MOVE X'2020233030303034383738' TO DFHEIV0(25:11)
  5503     CALL 'kxdfhei1' USING DFHEIV0,
  5504           PGM-NAME,
  5505           EMI-LINE1,
  5506           DFHEIV11,
  5507           DFHEIV99,
  5508           DFHEIV99,
  5509           DFHEIV99,
  5510           DFHEIV99
  5511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5512
  5513
  5514     MOVE -1                     TO  PFENTERL.
  5515
  5516     GO TO 8200-SEND-DATAONLY.
  5517
  5518 9995-SECURITY-VIOLATION.
  5519*                            COPY ELCSCTP.
  5520******************************************************************
  5521*                                                                *
  5522*                            ELCSCTP                             *
  5523*                            VMOD=2.001                          *
  5524*                                                                *
  5525*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5526******************************************************************
  5527
  5528
  5529     MOVE EIBDATE          TO SM-JUL-DATE.
  5530     MOVE EIBTRMID         TO SM-TERMID.
  5531     MOVE THIS-PGM         TO SM-PGM.
  5532     MOVE EIBTIME          TO TIME-IN.
  5533     MOVE TIME-OUT         TO SM-TIME.
  5534     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5535
  5536
  5537* EXEC CICS LINK
  5538*         PROGRAM  ('EL003')
  5539*         COMMAREA (SECURITY-MESSAGE)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page 114
* EL633.cbl
  5540*         LENGTH   (80)
  5541*    END-EXEC.
  5542     MOVE 'EL003' TO DFHEIV1
  5543     MOVE 80
  5544       TO DFHEIV11
  5545*    MOVE '."C                   (   #00004906' TO DFHEIV0
  5546     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5547     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5548     MOVE X'2020233030303034393036' TO DFHEIV0(25:11)
  5549     CALL 'kxdfhei1' USING DFHEIV0,
  5550           DFHEIV1,
  5551           SECURITY-MESSAGE,
  5552           DFHEIV11,
  5553           DFHEIV99,
  5554           DFHEIV99,
  5555           DFHEIV99,
  5556           DFHEIV99
  5557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5558
  5559
  5560******************************************************************
  5561
  5562
  5563 9995-EXIT.
  5564     EXIT.
  5565
  5566
  5567 9999-DFHBACK SECTION.
  5568     MOVE '9%                    "   ' TO DFHEIV0
  5569     MOVE 'EL633' TO DFHEIV1
  5570     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5571     GOBACK.
  5572 9999-DFHEXIT.
  5573     IF DFHEIGDJ EQUAL 0001
  5574         NEXT SENTENCE
  5575     ELSE IF DFHEIGDJ EQUAL 2
  5576         GO TO 9600-PGMID-ERROR,
  5577               9990-ABEND
  5578         DEPENDING ON DFHEIGDI
  5579     ELSE IF DFHEIGDJ EQUAL 3
  5580         GO TO 0410-NO-COMP-MSTR,
  5581               7100-COMP-FILE-NOTOPEN
  5582         DEPENDING ON DFHEIGDI
  5583     ELSE IF DFHEIGDJ EQUAL 4
  5584         GO TO 0890-EXIT
  5585         DEPENDING ON DFHEIGDI
  5586     ELSE IF DFHEIGDJ EQUAL 5
  5587         GO TO 2110-ADD-RECORD
  5588         DEPENDING ON DFHEIGDI
  5589     ELSE IF DFHEIGDJ EQUAL 6
  5590         GO TO 2120-DELETE-CONT
  5591         DEPENDING ON DFHEIGDI
  5592     ELSE IF DFHEIGDJ EQUAL 7
  5593         GO TO 2190-DUP-RECORD
  5594         DEPENDING ON DFHEIGDI
  5595     ELSE IF DFHEIGDJ EQUAL 8
  5596         GO TO 5010-NOT-OPEN,
  5597               5020-NO-RECORDS,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:37 Page 115
* EL633.cbl
  5598               5020-NO-RECORDS
  5599         DEPENDING ON DFHEIGDI
  5600     ELSE IF DFHEIGDJ EQUAL 9
  5601         GO TO 5110-END-OF-FILE,
  5602               5110-END-OF-FILE
  5603         DEPENDING ON DFHEIGDI
  5604     ELSE IF DFHEIGDJ EQUAL 10
  5605         GO TO 6100-END-OF-FILE,
  5606               6100-END-OF-FILE
  5607         DEPENDING ON DFHEIGDI
  5608     ELSE IF DFHEIGDJ EQUAL 11
  5609         GO TO 8300-SEND-TEXT
  5610         DEPENDING ON DFHEIGDI.
  5611     MOVE '9%                    "   ' TO DFHEIV0
  5612     MOVE 'EL633' TO DFHEIV1
  5613     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5614     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6176     Code:       17108
