* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL104.cbl
* Options: int("EL104.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL104.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL104.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL104.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL104 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 10:18:15.
     7*                            VMOD=2.010
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS,TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL104.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        TRANSACTION EX06 - TEXT FILE MAINTENANCE
    27*        THIS PROGRAM IS USED TO PERFORM MAINTENANCE TO THE HELP,
    28*        LETTER, AND FORM FILES.
    29*
    30*        IT WILL RENUMBER, COPY OR DELETE RECORDS FROM THE FILES
    31*        OR IT WILL BROWSE THE FILE AND BUILD TEMP STORAGE ITEMS
    32*        FOR EACH RECORD THAT MATCHES THE KEY AND PASS CONTROL TO
    33*        PROGRAM EL1042 FOR MAINTENANCE.
    34******************************************************************
    35*                   C H A N G E   L O G
    36*
    37* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    38*-----------------------------------------------------------------
    39*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    40* EFFECTIVE    NUMBER
    41*-----------------------------------------------------------------
    42* 020410  CR2009061500002  AJRA  FIX HELP FILE SELECTION
    43******************************************************************
    44
    45 ENVIRONMENT DIVISION.
    46 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL104.cbl
    48 WORKING-STORAGE SECTION.
    49 01  DFH-START PIC X(04).
    50 77  FILLER  PIC X(32)  VALUE '********************************'.
    51 77  FILLER  PIC X(32)  VALUE '*    EL104 WORKING STORAGE     *'.
    52 77  FILLER  PIC X(32)  VALUE '******** V/M 2.010 *************'.
    53
    54*    COPY ELCSCTM.
    55******************************************************************
    56*                                                                *
    57*                                                                *
    58*                            ELCSCTM                             *
    59*                            VMOD=2.001                          *
    60*                                                                *
    61*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    62*                                                                *
    63******************************************************************
    64 01  SECURITY-MESSAGE.
    65     12  FILLER                          PIC X(30)
    66            VALUE '** LOGIC SECURITY VIOLATION -'.
    67     12  SM-READ                         PIC X(6).
    68     12  FILLER                          PIC X(5)
    69            VALUE ' PGM='.
    70     12  SM-PGM                          PIC X(6).
    71     12  FILLER                          PIC X(5)
    72            VALUE ' OPR='.
    73     12  SM-PROCESSOR-ID                 PIC X(4).
    74     12  FILLER                          PIC X(6)
    75            VALUE ' TERM='.
    76     12  SM-TERMID                       PIC X(4).
    77     12  FILLER                          PIC XX   VALUE SPACE.
    78     12  SM-JUL-DATE                     PIC 9(5).
    79     12  FILLER                          PIC X    VALUE SPACE.
    80     12  SM-TIME                         PIC 99.99.
    81
    82*    COPY ELCSCRTY.
    83******************************************************************
    84*                                                                *
    85*                                                                *
    86*                            ELCSCRTY                            *
    87*                            VMOD=2.001                          *
    88*                                                                *
    89*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    90*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    91*        SAVED IN PI-SECURITY-ADDRESS.                           *
    92*                                                                *
    93******************************************************************
    94 01  SECURITY-CONTROL.
    95     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    96     12  FILLER                       PIC XX    VALUE 'SC'.
    97     12  SC-CREDIT-CODES.
    98         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    99             20  SC-CREDIT-DISPLAY    PIC X.
   100             20  SC-CREDIT-UPDATE     PIC X.
   101     12  SC-CLAIMS-CODES.
   102         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   103             20  SC-CLAIMS-DISPLAY    PIC X.
   104             20  SC-CLAIMS-UPDATE     PIC X.
   105*    COPY MPCSCRT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL104.cbl
   106******************************************************************
   107*                                                                *
   108*                            MPCSCRT                             *
   109*                            VMOD=1.001                          *
   110*                                                                *
   111*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   112*        ACQUIRED BY SIGN-ON PROGRAM EL125.                      *
   113*                                      (MP MORTGAGE PROTECTION)  *
   114*                                                                *
   115******************************************************************
   116*
   117 01  SECURITY-CONTROL-E.
   118     12  SC-COMM-LENGTH-E             PIC S9(04) VALUE +144 COMP.
   119     12  FILLER                       PIC  X(02) VALUE 'SC'.
   120     12  SC-QUID-KEY.
   121         16  SC-QUID-TERMINAL         PIC  X(04).
   122         16  SC-QUID-SYSTEM           PIC  X(04).
   123     12  SC-ITEM                      PIC S9(04) VALUE +1   COMP.
   124     12  SC-SECURITY-ACCESS-CODE      PIC  X(01).
   125     12  SC-PRODUCER-AUTHORIZED-SW    PIC  X(01).
   126         88 SC-PRODUCER-AUTHORIZED               VALUE ' '.
   127         88 SC-PRODUCER-NOT-AUTHORIZED           VALUE 'N'.
   128     12  SC-MP-CODES.
   129         16  SC-MP-AUTHORIZATION OCCURS 44 TIMES.
   130             20  SC-MP-DISPLAY        PIC  X(01).
   131             20  SC-MP-UPDATE         PIC  X(01).
   132     12  FILLER                       PIC  X(40).
   133
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL104.cbl
   135
   136 01  WS-DATE-AREA.
   137     12  SAVE-DATE               PIC X(8)    VALUE SPACES.
   138     12  SAVE-BIN-DATE           PIC X(2)    VALUE SPACES.
   139
   140 01  WS-CONSTANTS.
   141     12  W-APPL-SCRTY-NDX        PIC S9(4) COMP VALUE +7.
   142     12  W-SC-ITEM               PIC S9(4) COMP VALUE +1.
   143     12  MAP-NAME.
   144         16  MAP-NAME-PRE        PIC X(2)    VALUE 'EL'.
   145         16  MAP-NUMBER          PIC X(4)    VALUE '104A'.
   146         16  MAP-NAME-FILL       PIC X(2)    VALUE SPACES.
   147     12  MAPSET-NAME             PIC X(8)    VALUE 'EL104S'.
   148     12  TRANS-ID                PIC X(4)    VALUE 'EX06'.
   149     12  PGM-NAME                PIC X(8).
   150     12  PGM-EL1042              PIC X(8)    VALUE 'EL1042'.
   151     12  THIS-PGM                PIC X(8)    VALUE 'EL104'.
   152     12  W-MAINT                 PIC X(1).
   153         88  W-ADD                           VALUE 'A'.
   154         88  W-CHANGE                        VALUE 'C'.
   155         88  W-COPY                          VALUE 'K'.
   156         88  W-DELETE                        VALUE 'D' 'E'.
   157         88  W-RENAME                        VALUE 'R'.
   158         88  W-SHOW                          VALUE 'S' 'M'.
   159         88  W-TRANSFORM                     VALUE 'T'.
   160         88  W-VALID-MAINT-CR                VALUE 'A' 'C' 'D' 'K'
   161                                                   'R' 'S' 'M' 'E'
   162                                                   'T'.
   163         88  W-VALID-MAINT-REST              VALUE 'A' 'C' 'D' 'K'
   164                                                   'R' 'S' 'M'
   165                                                   'E'.
   166     12  W-FILE-TYPE             PIC X(1).
   167         88  W-FORM                          VALUE 'F'.
   168         88  W-HELP                          VALUE 'H' 'A'.
   169         88  W-LETTER                        VALUE 'L'.
   170     12  XCTL-CLAIM              PIC X(8)    VALUE 'EL126'.
   171     12  XCTL-CREDIT             PIC X(8)    VALUE 'EL626'.
   172     12  XCTL-GEN-LEDGER         PIC X(8)    VALUE 'GL800'.
   173     12  XCTL-LIFE               PIC X(8)    VALUE 'LF400'.
   174     12  XCTL-MORTGAGE           PIC X(8)    VALUE 'EM626'.
   175     12  XCTL-WARRANTY           PIC X(8)    VALUE 'WA126'.
   176     12  FILE-ID                 PIC X(8).
   177     12  FILE-KEY.
   178         16  FILE-PARTIAL-KEY.
   179           18  CO-CD             PIC X.
   180           18  CNTL-AREA         PIC X(12).
   181         16  SEQ                 PIC S9(4)   COMP.
   182     12  BROWSE-STARTED-SW       PIC X       VALUE SPACE.
   183         88  BROWSE-STARTED      VALUE 'Y'.
   184     12  LETTER-ID               PIC X(8)    VALUE 'ELLETR'.
   185     12  FORM-ID                 PIC X(8)    VALUE 'ELFORM'.
   186     12  HELP-ID                 PIC X(8)    VALUE 'ELHELP'.
   187     12  REQUEST-TYPE            PIC X       VALUE SPACES.
   188         88  RENUMBER-REQUEST    VALUE '1'.
   189         88  COPY-REQUEST        VALUE '2'.
   190         88  DELETE-REQUEST      VALUE '3'.
   191     12  CNTL-KEY                PIC X(12).
   192     12  CNTL-K1  REDEFINES CNTL-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL104.cbl
   193         16  K1                  PIC X.
   194         16  K2                  PIC X.
   195         16  K3                  PIC X.
   196         16  K4                  PIC X.
   197         16  K5                  PIC X.
   198         16  FILLER              PIC X.
   199         16  K7                  PIC X.
   200         16  K8                  PIC X.
   201         16  K9                  PIC X.
   202         16  FILLER              PIC X(2).
   203         16  K12                 PIC X.
   204     12  TS-NAME.
   205         16  FILLER              PIC X(4)    VALUE '104A'.
   206         16  TS-TERM             PIC X(4).
   207     12  TS-ITEM                 PIC S9(4)   COMP VALUE +0.
   208
   209     12  FILE-LENGTH             PIC S9(4)   COMP VALUE +100.
   210     12  UPDATE-SW               PIC 9       VALUE 0.
   211         88  FILE-UPDATED        VALUE 1.
   212
   213     12  OLD-KEY.
   214         16  OLD-CO-CD           PIC X.
   215         16  OLD-COMM-AREA       PIC X(12).
   216         16  OLD-SEQ             PIC S9(4)   COMP.
   217     12  OLD-KEY-SAVE            PIC X(15).
   218
   219     12  TIME-IN                 PIC S9(7).
   220     12  FILLER REDEFINES TIME-IN.
   221         16  FILLER              PIC X.
   222         16  TIME-OUT            PIC 99V99.
   223         16  FILLER              PIC 9(2).
   224     12  WS-HEX-01               PIC S9(4) COMP  VALUE +1.
   225     12  FILLER REDEFINES WS-HEX-01.
   226         16  FILLER              PIC X.
   227         16  WS-LGX-COMPANY-CD   PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL104.cbl
   229*    COPY ELCLOGOF.
   230******************************************************************
   231*                                                                *
   232*                                                                *
   233*                            ELCLOGOF.                           *
   234*                            VMOD=2.001                          *
   235*                                                                *
   236*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   237*                                                                *
   238******************************************************************
   239 01  CLASIC-LOGOFF.
   240     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   241     12  LOGOFF-TEXT.
   242         16  FILLER          PIC X(5)    VALUE SPACES.
   243         16  LOGOFF-MSG.
   244             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   245             20  FILLER      PIC X       VALUE SPACES.
   246             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   247         16  FILLER          PIC X(80)
   248           VALUE '* YOU ARE NOW LOGGED OFF'.
   249         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   250         16  FILLER          PIC X       VALUE QUOTE.
   251         16  LOGOFF-SYS-MSG  PIC X(17)
   252           VALUE 'S CLAS-IC SYSTEM '.
   253     12  TEXT-MESSAGES.
   254         16  UNACCESS-MSG    PIC X(29)
   255             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   256         16  PGMIDERR-MSG    PIC X(17)
   257             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL104.cbl
   259*    COPY ELCAID.
   260******************************************************************
   261*                                                                *
   262*                            ELCAID.                             *
   263*                            VMOD=2.001                          *
   264*                                                                *
   265*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   266*                                                                *
   267*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   268*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   269******************************************************************
   270
   271 01  DFHAID.
   272   02  DFHNULL   PIC  X  VALUE  ' '.
   273   02  DFHENTER  PIC  X  VALUE  QUOTE.
   274   02  DFHCLEAR  PIC  X  VALUE  '_'.
   275   02  DFHPEN    PIC  X  VALUE  '='.
   276   02  DFHOPID   PIC  X  VALUE  'W'.
   277   02  DFHPA1    PIC  X  VALUE  '%'.
   278   02  DFHPA2    PIC  X  VALUE  '>'.
   279   02  DFHPA3    PIC  X  VALUE  ','.
   280   02  DFHPF1    PIC  X  VALUE  '1'.
   281   02  DFHPF2    PIC  X  VALUE  '2'.
   282   02  DFHPF3    PIC  X  VALUE  '3'.
   283   02  DFHPF4    PIC  X  VALUE  '4'.
   284   02  DFHPF5    PIC  X  VALUE  '5'.
   285   02  DFHPF6    PIC  X  VALUE  '6'.
   286   02  DFHPF7    PIC  X  VALUE  '7'.
   287   02  DFHPF8    PIC  X  VALUE  '8'.
   288   02  DFHPF9    PIC  X  VALUE  '9'.
   289   02  DFHPF10   PIC  X  VALUE  ':'.
   290   02  DFHPF11   PIC  X  VALUE  '#'.
   291   02  DFHPF12   PIC  X  VALUE  '@'.
   292   02  DFHPF13   PIC  X  VALUE  'A'.
   293   02  DFHPF14   PIC  X  VALUE  'B'.
   294   02  DFHPF15   PIC  X  VALUE  'C'.
   295   02  DFHPF16   PIC  X  VALUE  'D'.
   296   02  DFHPF17   PIC  X  VALUE  'E'.
   297   02  DFHPF18   PIC  X  VALUE  'F'.
   298   02  DFHPF19   PIC  X  VALUE  'G'.
   299   02  DFHPF20   PIC  X  VALUE  'H'.
   300   02  DFHPF21   PIC  X  VALUE  'I'.
   301*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   302   02  DFHPF22   PIC  X  VALUE  '['.
   303   02  DFHPF23   PIC  X  VALUE  '.'.
   304   02  DFHPF24   PIC  X  VALUE  '<'.
   305   02  DFHMSRE   PIC  X  VALUE  'X'.
   306   02  DFHSTRF   PIC  X  VALUE  'h'.
   307   02  DFHTRIG   PIC  X  VALUE  '"'.
   308 01  FILLER  REDEFINES DFHAID.
   309     12  FILLER                  PIC X(8).
   310     12  PF-VALUES OCCURS 24 TIMES       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL104.cbl
   312*    COPY ELCEMIB.
   313******************************************************************
   314*                                                                *
   315*                                                                *
   316*                            ELCEMIB.                            *
   317*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   318*                            VMOD=2.005                          *
   319*                                                                *
   320*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   321*                                                                *
   322******************************************************************
   323 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   324     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   325     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   326     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   327     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   328     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   329     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   330     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   331     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   332     12  EMI-SWITCH1             PIC X        VALUE '1'.
   333         88  EMI-NO-ERRORS                    VALUE '1'.
   334         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   335         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   336     12  EMI-SWITCH2             PIC X        VALUE '1'.
   337         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   338     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   339         88  EMI-AREA1-EMPTY                  VALUE '1'.
   340         88  EMI-AREA1-FULL                   VALUE '2'.
   341     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   342         88  EMI-AREA2-EMPTY                  VALUE '1'.
   343         88  EMI-AREA2-FULL                   VALUE '2'.
   344     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   345         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   346         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   347         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   348         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   349         88  EMI-BYPASS-FATALS                VALUE 'X'.
   350     12  EMI-ERROR-LINES.
   351         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   352         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   353         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   354         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   355             20  EMI-ERR-CODES OCCURS 10 TIMES.
   356                 24  EMI-ERR-NUM         PIC X(4).
   357                 24  EMI-FILLER          PIC X.
   358                 24  EMI-SEV             PIC X.
   359                 24  FILLER              PIC X.
   360             20  FILLER                  PIC X(02).
   361     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   362         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   363             20  EMI-ERROR-NUMBER    PIC X(4).
   364             20  EMI-FILL            PIC X.
   365             20  EMI-SEVERITY        PIC X.
   366             20  FILLER              PIC X.
   367             20  EMI-ERROR-TEXT.
   368                 24  EMI-TEXT-VARIABLE   PIC X(10).
   369                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL104.cbl
   370     12  EMI-SEVERITY-SAVE           PIC X.
   371         88  EMI-NOTE                    VALUE 'N'.
   372         88  EMI-WARNING                 VALUE 'W'.
   373         88  EMI-FORCABLE                VALUE 'F'.
   374         88  EMI-FATAL                   VALUE 'X'.
   375     12  EMI-MESSAGE-FLAG            PIC X.
   376         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   377         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   378     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   379     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   380         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   381         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   382         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   383     12  FILLER                      PIC X(137)  VALUE SPACES.
   384     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   385     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   386     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   387     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   388     05  WS-ERROR-MESSAGE-AREA.
   389         10  ER-0000                 PIC 9(4)   VALUE 0000.
   390         10  ER-0004                 PIC 9(4)   VALUE 0004.
   391         10  ER-0005                 PIC 9(4)   VALUE 0005.
   392         10  ER-0006                 PIC 9(4)   VALUE 0006.
   393         10  ER-0008                 PIC 9(4)   VALUE 0008.
   394         10  ER-0009                 PIC 9(4)   VALUE 0009.
   395         10  ER-0012                 PIC 9(4)   VALUE 0012.
   396         10  ER-0013                 PIC 9(4)   VALUE 0013.
   397         10  ER-0014                 PIC 9(4)   VALUE 0014.
   398         10  ER-0015                 PIC 9(4)   VALUE 0015.
   399         10  ER-0023                 PIC 9(4)   VALUE 0023.
   400         10  ER-0029                 PIC 9(4)   VALUE 0029.
   401         10  ER-0070                 PIC 9(4)   VALUE 0070.
   402         10  ER-0076                 PIC 9(4)   VALUE 0076.
   403         10  ER-1162                 PIC 9(4)   VALUE 1162.
   404         10  ER-2237                 PIC 9(4)   VALUE 2237.
   405         10  ER-2238                 PIC 9(4)   VALUE 2238.
   406         10  ER-7270                 PIC 9(4)   VALUE 7270.
   407         10  ER-7271                 PIC 9(4)   VALUE 7271.
   408         10  ER-7392                 PIC 9(4)   VALUE 7392.
   409         10  ER-9097                 PIC 9(4)   VALUE 9097.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL104.cbl
   411*    COPY ELCINTF.
   412******************************************************************
   413*                                                                *
   414*                                                                *
   415*                            ELCINTF.                            *
   416*                            VMOD=2.017                          *
   417*                                                                *
   418*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   419*                                                                *
   420*       LENGTH = 1024                                            *
   421*                                                                *
   422******************************************************************
   423 01  PROGRAM-INTERFACE-BLOCK.
   424     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   425     12  PI-CALLING-PROGRAM              PIC X(8).
   426     12  PI-SAVED-PROGRAM-1              PIC X(8).
   427     12  PI-SAVED-PROGRAM-2              PIC X(8).
   428     12  PI-SAVED-PROGRAM-3              PIC X(8).
   429     12  PI-SAVED-PROGRAM-4              PIC X(8).
   430     12  PI-SAVED-PROGRAM-5              PIC X(8).
   431     12  PI-SAVED-PROGRAM-6              PIC X(8).
   432     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   433     12  PI-COMPANY-ID                   PIC XXX.
   434     12  PI-COMPANY-CD                   PIC X.
   435
   436     12  PI-COMPANY-PASSWORD             PIC X(8).
   437
   438     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   439
   440     12  PI-CONTROL-IN-PROGRESS.
   441         16  PI-CARRIER                  PIC X.
   442         16  PI-GROUPING                 PIC X(6).
   443         16  PI-STATE                    PIC XX.
   444         16  PI-ACCOUNT                  PIC X(10).
   445         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   446                                         PIC X(10).
   447         16  PI-CLAIM-CERT-GRP.
   448             20  PI-CLAIM-NO             PIC X(7).
   449             20  PI-CERT-NO.
   450                 25  PI-CERT-PRIME       PIC X(10).
   451                 25  PI-CERT-SFX         PIC X.
   452             20  PI-CERT-EFF-DT          PIC XX.
   453         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   454             20  PI-PLAN-CODE            PIC X(2).
   455             20  PI-REVISION-NUMBER      PIC X(3).
   456             20  PI-PLAN-EFF-DT          PIC X(2).
   457             20  PI-PLAN-EXP-DT          PIC X(2).
   458             20  FILLER                  PIC X(11).
   459         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   460             20  PI-OE-REFERENCE-1.
   461                 25  PI-OE-REF-1-PRIME   PIC X(18).
   462                 25  PI-OE-REF-1-SUFF    PIC XX.
   463
   464     12  PI-SESSION-IN-PROGRESS          PIC X.
   465         88  CLAIM-SESSION                   VALUE '1'.
   466         88  CREDIT-SESSION                  VALUE '2'.
   467         88  WARRANTY-SESSION                VALUE '3'.
   468         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL104.cbl
   469         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   470
   471
   472*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   473
   474     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   475     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   476
   477     12  PI-CREDIT-USER                  PIC X.
   478         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   479         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   480
   481     12  PI-CLAIM-USER                   PIC X.
   482         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   483         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   484
   485     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   486         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   487         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   488         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   489         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   490         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   491
   492     12  PI-PROCESSOR-ID                 PIC X(4).
   493
   494     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   495
   496     12  PI-MEMBER-CAPTION               PIC X(10).
   497
   498     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   499         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   500
   501     12  PI-LIFE-OVERRIDE-L1             PIC X.
   502     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   503     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   504     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   505
   506     12  PI-AH-OVERRIDE-L1               PIC X.
   507     12  PI-AH-OVERRIDE-L2               PIC XX.
   508     12  PI-AH-OVERRIDE-L6               PIC X(6).
   509     12  PI-AH-OVERRIDE-L12              PIC X(12).
   510
   511     12  PI-NEW-SYSTEM                   PIC X(2).
   512
   513     12  PI-PRIMARY-CERT-NO              PIC X(11).
   514     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   515         88  PI-USES-PAID-TO                 VALUE '1'.
   516     12  PI-CRDTCRD-SYSTEM.
   517         16  PI-CRDTCRD-USER             PIC X.
   518             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   519             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   520         16  PI-CC-MONTH-END-DT          PIC XX.
   521     12  PI-PROCESSOR-PRINTER            PIC X(4).
   522
   523     12  PI-OE-REFERENCE-2.
   524         16  PI-OE-REF-2-PRIME           PIC X(10).
   525         16  PI-OE-REF-2-SUFF            PIC X.
   526
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL104.cbl
   527     12  PI-REM-TRM-CALC-OPTION          PIC X.
   528
   529     12  PI-LANGUAGE-TYPE                PIC X.
   530             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   531             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   532             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   533
   534     12  PI-POLICY-LINKAGE-IND           PIC X.
   535         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   536         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   537                                                   LOW-VALUES.
   538
   539     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   540     12  PI-CLAIM-PW-SESSION             PIC X(1).
   541         88  PI-CLAIM-CREDIT                 VALUE '1'.
   542         88  PI-CLAIM-CONVEN                 VALUE '2'.
   543     12  FILLER                          PIC X(4).
   544
   545     12  PI-SYSTEM-LEVEL                 PIC X(145).
   546
   547     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   548         PI-SYSTEM-LEVEL.
   549
   550         16  PI-ENTRY-CODES.
   551             20  PI-ENTRY-CD-1           PIC X.
   552             20  PI-ENTRY-CD-2           PIC X.
   553
   554         16  PI-RETURN-CODES.
   555             20  PI-RETURN-CD-1          PIC X.
   556             20  PI-RETURN-CD-2          PIC X.
   557
   558         16  PI-UPDATE-STATUS-SAVE.
   559             20  PI-UPDATE-BY            PIC X(4).
   560             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   561
   562         16  PI-LOWER-CASE-LETTERS       PIC X.
   563             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   564
   565*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   566*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   567*            88  CARRIER-CLM-CNTL            VALUE '2'.
   568
   569         16  PI-CERT-ACCESS-CONTROL      PIC X.
   570             88  ST-ACCNT-CNTL               VALUE ' '.
   571             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   572             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   573             88  ACCNT-CNTL                  VALUE '3'.
   574             88  CARR-ACCNT-CNTL             VALUE '4'.
   575
   576         16  PI-PROCESSOR-CAP-LIST.
   577             20  PI-SYSTEM-CONTROLS.
   578                24 PI-SYSTEM-DISPLAY     PIC X.
   579                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   580                24 PI-SYSTEM-MODIFY      PIC X.
   581                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   582             20  FILLER                  PIC XX.
   583             20  PI-DISPLAY-CAP          PIC X.
   584                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL104.cbl
   585             20  PI-MODIFY-CAP           PIC X.
   586                 88  MODIFY-CAP              VALUE 'Y'.
   587             20  PI-MSG-AT-LOGON-CAP     PIC X.
   588                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   589             20  PI-FORCE-CAP            PIC X.
   590                 88  FORCE-CAP               VALUE 'Y'.
   591
   592         16  PI-PROGRAM-CONTROLS.
   593             20  PI-PGM-PRINT-OPT        PIC X.
   594             20  PI-PGM-FORMAT-OPT       PIC X.
   595             20  PI-PGM-PROCESS-OPT      PIC X.
   596             20  PI-PGM-TOTALS-OPT       PIC X.
   597
   598         16  PI-HELP-INTERFACE.
   599             20  PI-LAST-ERROR-NO        PIC X(4).
   600             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   601
   602         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   603             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   604
   605         16  PI-CR-CONTROL-IN-PROGRESS.
   606             20  PI-CR-CARRIER           PIC X.
   607             20  PI-CR-GROUPING          PIC X(6).
   608             20  PI-CR-STATE             PIC XX.
   609             20  PI-CR-ACCOUNT           PIC X(10).
   610             20  PI-CR-FIN-RESP          PIC X(10).
   611             20  PI-CR-TYPE              PIC X.
   612
   613         16  PI-CR-BATCH-NUMBER          PIC X(6).
   614
   615         16  PI-CR-MONTH-END-DT          PIC XX.
   616
   617         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   618             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   619             88  PI-ZERO-CARRIER             VALUE '1'.
   620             88  PI-ZERO-GROUPING            VALUE '2'.
   621             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   622
   623         16  PI-CARRIER-SECURITY         PIC X.
   624             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   625
   626         16  PI-ACCOUNT-SECURITY         PIC X(10).
   627             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   628             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   629
   630         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   631             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   632                                         INDEXED BY PI-ACCESS-NDX
   633                                         PIC X.
   634
   635         16  PI-GA-BILLING-CONTROL       PIC X.
   636             88  PI-GA-BILLING               VALUE '1'.
   637
   638         16  PI-MAIL-PROCESSING          PIC X.
   639             88  PI-MAIL-YES                 VALUE 'Y'.
   640
   641         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   642
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL104.cbl
   643         16  PI-AR-SYSTEM.
   644             20  PI-AR-PROCESSING-CNTL   PIC X.
   645                 88  PI-AR-PROCESSING        VALUE 'Y'.
   646             20  PI-AR-SUMMARY-CODE      PIC X(6).
   647             20  PI-AR-MONTH-END-DT      PIC XX.
   648
   649         16  PI-MP-SYSTEM.
   650             20  PI-MORTGAGE-USER            PIC X.
   651                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   652                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   653             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   654                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   655                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   656                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   657                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   658                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   659             20  PI-MP-MONTH-END-DT          PIC XX.
   660             20  PI-MP-REFERENCE-NO.
   661                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   662                 24  PI-MP-REFERENCE-SFX     PIC XX.
   663
   664         16  PI-LABEL-CONTROL            PIC X(01).
   665             88  PI-CREATE-LABELS                    VALUE 'Y'.
   666             88  PI-BYPASS-LABELS                    VALUE 'N'.
   667
   668         16  PI-BILL-GROUPING-CODE       PIC X(01).
   669             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   670
   671         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   672             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   673             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   674
   675         16  FILLER                      PIC X(14).
   676
   677     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   678******************************************************************
   679     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   680*    COPY ELC1042.
   681******************************************************************
   682*                                                                *
   683*                                                                *
   684*                           ELC1042                              *
   685*                            VMOD=2.002                          *
   686*                                                                *
   687*    NOTE                                                        *
   688*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   689*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   690*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   691*        TO THESE PROGRAMS.                                      *
   692*                                                                *
   693*    NOTE                                                        *
   694*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   695*        USE ONLY!                                               *
   696*                                                                *
   697******************************************************************
   698
   699         16  PI-1042-WA.
   700             20  PI-ACTION       PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL104.cbl
   701                 88 PI-SHOW-MODE           VALUE '1'.
   702                 88 PI-CLEAR-MODE          VALUE '2'.
   703                 88 PI-CREATE-MODE         VALUE '3'.
   704             20  PI-COMM-CONTROL PIC  X(12).
   705             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   706             20  PI-EOF-SW       PIC  X(01).
   707                 88  PI-FILE-EOF           VALUE 'Y'.
   708             20  PI-FILETYP      PIC  X(01).
   709             20  PI-FORM-SQUEEZE-CONTROL
   710                                 PIC  X(01).
   711                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   712                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   713             20  PI-LAST-CONTROL PIC  X(12).
   714             20  PI-TEMP-STOR-ITEMS
   715                                 PIC S9(04) COMP.
   716             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   717             20  PI-UPDATE-SW    PIC  9(01).
   718                 88 ANY-UPDATES            VALUE 1.
   719             20  PI-104-SCREEN-SENT-IND
   720                                 PIC  X(01).
   721                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   722                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   723             20  PI-1042-SCREEN-SENT-IND
   724                                 PIC  X(01).
   725                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   726                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   727             20  PI-1042-ARCHIVE-IND
   728                                 PIC  X(01).
   729                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   730             20  FILLER          PIC  X(29).
   731         16  FILLER              PIC X(431).
   732         16  PI-104-SCREEN-BYPASS.
   733             20  PI-104-TYPE     PIC  X(01).
   734             20  PI-104-NAME     PIC  X(12).
   735         16  PI-OLD-NAME         PIC  X(04).
   736         16  PI-NEW-NAME         PIC  X(04).
   737         16  PI-1043-ERROR       PIC  9(04).
   738         16  FILLER              PIC X(117).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL104.cbl
   740*    COPY ELCATTR.
   741******************************************************************
   742*                                                                *
   743*                            ELCATTR.                            *
   744*                            VMOD=2.001                          *
   745*                                                                *
   746*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   747*                                                                *
   748*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   749*                                                                *
   750*                   POS 1   P=PROTECTED                          *
   751*                           U=UNPROTECTED                        *
   752*                           S=ASKIP                              *
   753*                   POS 2   A=ALPHA/NUMERIC                      *
   754*                           N=NUMERIC                            *
   755*                   POS 3   N=NORMAL                             *
   756*                           B=BRIGHT                             *
   757*                           D=DARK                               *
   758*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   759*                           OF=MODIFIED DATA TAG OFF             *
   760*                                                                *
   761*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   762******************************************************************
   763 01  ATTRIBUTE-LIST.
   764     12  AL-PABOF            PIC X       VALUE 'Y'.
   765     12  AL-PABON            PIC X       VALUE 'Z'.
   766     12  AL-PADOF            PIC X       VALUE '%'.
   767     12  AL-PADON            PIC X       VALUE '_'.
   768     12  AL-PANOF            PIC X       VALUE '-'.
   769     12  AL-PANON            PIC X       VALUE '/'.
   770     12  AL-SABOF            PIC X       VALUE '8'.
   771     12  AL-SABON            PIC X       VALUE '9'.
   772     12  AL-SADOF            PIC X       VALUE '@'.
   773     12  AL-SADON            PIC X       VALUE QUOTE.
   774     12  AL-SANOF            PIC X       VALUE '0'.
   775     12  AL-SANON            PIC X       VALUE '1'.
   776     12  AL-UABOF            PIC X       VALUE 'H'.
   777     12  AL-UABON            PIC X       VALUE 'I'.
   778     12  AL-UADOF            PIC X       VALUE '<'.
   779     12  AL-UADON            PIC X       VALUE '('.
   780     12  AL-UANOF            PIC X       VALUE ' '.
   781     12  AL-UANON            PIC X       VALUE 'A'.
   782     12  AL-UNBOF            PIC X       VALUE 'Q'.
   783     12  AL-UNBON            PIC X       VALUE 'R'.
   784     12  AL-UNDOF            PIC X       VALUE '*'.
   785     12  AL-UNDON            PIC X       VALUE ')'.
   786     12  AL-UNNOF            PIC X       VALUE '&'.
   787     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL104.cbl
   789*    COPY ELCDATE.
   790******************************************************************
   791*                                                                *
   792*                                                                *
   793*                            ELCDATE.                            *
   794*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   795*                            VMOD=2.003
   796*                                                                *
   797*                                                                *
   798*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   799*                 LENGTH = 200                                   *
   800******************************************************************
   801
   802 01  DATE-CONVERSION-DATA.
   803     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   804     12  DC-OPTION-CODE                PIC X.
   805         88  BIN-TO-GREG                VALUE ' '.
   806         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   807         88  EDIT-GREG-TO-BIN           VALUE '2'.
   808         88  YMD-GREG-TO-BIN            VALUE '3'.
   809         88  MDY-GREG-TO-BIN            VALUE '4'.
   810         88  JULIAN-TO-BIN              VALUE '5'.
   811         88  BIN-PLUS-ELAPSED           VALUE '6'.
   812         88  FIND-CENTURY               VALUE '7'.
   813         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   814         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   815         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   816         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   817         88  JULIAN-TO-BIN-3            VALUE 'C'.
   818         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   819         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   820         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   821         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   822         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   823         88  CHECK-LEAP-YEAR            VALUE 'H'.
   824         88  BIN-3-TO-GREG              VALUE 'I'.
   825         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   826         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   827         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   828         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   829         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   830         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   831         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   832         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   833         88  THREE-CHARACTER-BIN
   834                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   835         88  GREGORIAN-TO-BIN
   836                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   837         88  BIN-TO-GREGORIAN
   838                  VALUES ' ' '1' 'I' '8' 'G'.
   839         88  JULIAN-TO-BINARY
   840                  VALUES '5' 'C' 'E' 'F'.
   841     12  DC-ERROR-CODE                 PIC X.
   842         88  NO-CONVERSION-ERROR        VALUE ' '.
   843         88  DATE-CONVERSION-ERROR
   844                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   845         88  DATE-IS-ZERO               VALUE '1'.
   846         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL104.cbl
   847         88  DATE-IS-INVALID            VALUE '3'.
   848         88  DATE1-GREATER-DATE2        VALUE '4'.
   849         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   850         88  DATE-INVALID-OPTION        VALUE '9'.
   851         88  INVALID-CENTURY            VALUE 'A'.
   852         88  ONLY-CENTURY               VALUE 'B'.
   853         88  ONLY-LEAP-YEAR             VALUE 'C'.
   854         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   855     12  DC-END-OF-MONTH               PIC X.
   856         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   857     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   858         88  USE-NORMAL-PROCESS         VALUE ' '.
   859         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   860         88  ADJUST-UP-100-YRS          VALUE '2'.
   861     12  FILLER                        PIC X.
   862     12  DC-CONVERSION-DATES.
   863         16  DC-BIN-DATE-1             PIC XX.
   864         16  DC-BIN-DATE-2             PIC XX.
   865         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   866         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   867                       DC-GREG-DATE-1-EDIT.
   868             20  DC-EDIT1-MONTH        PIC 99.
   869             20  SLASH1-1              PIC X.
   870             20  DC-EDIT1-DAY          PIC 99.
   871             20  SLASH1-2              PIC X.
   872             20  DC-EDIT1-YEAR         PIC 99.
   873         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   874         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   875                     DC-GREG-DATE-2-EDIT.
   876             20  DC-EDIT2-MONTH        PIC 99.
   877             20  SLASH2-1              PIC X.
   878             20  DC-EDIT2-DAY          PIC 99.
   879             20  SLASH2-2              PIC X.
   880             20  DC-EDIT2-YEAR         PIC 99.
   881         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   882         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   883                     DC-GREG-DATE-1-YMD.
   884             20  DC-YMD-YEAR           PIC 99.
   885             20  DC-YMD-MONTH          PIC 99.
   886             20  DC-YMD-DAY            PIC 99.
   887         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   888         16  DC-GREG-DATE-1-MDY-R REDEFINES
   889                      DC-GREG-DATE-1-MDY.
   890             20  DC-MDY-MONTH          PIC 99.
   891             20  DC-MDY-DAY            PIC 99.
   892             20  DC-MDY-YEAR           PIC 99.
   893         16  DC-GREG-DATE-1-ALPHA.
   894             20  DC-ALPHA-MONTH        PIC X(10).
   895             20  DC-ALPHA-DAY          PIC 99.
   896             20  FILLER                PIC XX.
   897             20  DC-ALPHA-CENTURY.
   898                 24 DC-ALPHA-CEN-N     PIC 99.
   899             20  DC-ALPHA-YEAR         PIC 99.
   900         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   901         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   902         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   903         16  DC-JULIAN-DATE            PIC 9(05).
   904         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL104.cbl
   905                                       PIC 9(05).
   906         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   907             20  DC-JULIAN-YEAR        PIC 99.
   908             20  DC-JULIAN-DAYS        PIC 999.
   909         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   910         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   911         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   912     12  DATE-CONVERSION-VARIBLES.
   913         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   914         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   915             20  FILLER                PIC 9(3).
   916             20  HOLD-CEN-1-CCYY.
   917                 24  HOLD-CEN-1-CC     PIC 99.
   918                 24  HOLD-CEN-1-YY     PIC 99.
   919             20  HOLD-CEN-1-MO         PIC 99.
   920             20  HOLD-CEN-1-DA         PIC 99.
   921         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   922             20  HOLD-CEN-1-R-MO       PIC 99.
   923             20  HOLD-CEN-1-R-DA       PIC 99.
   924             20  HOLD-CEN-1-R-CCYY.
   925                 24  HOLD-CEN-1-R-CC   PIC 99.
   926                 24  HOLD-CEN-1-R-YY   PIC 99.
   927             20  FILLER                PIC 9(3).
   928         16  HOLD-CENTURY-1-X.
   929             20  FILLER                PIC X(3)  VALUE SPACES.
   930             20  HOLD-CEN-1-X-CCYY.
   931                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   932                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   933             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   934             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   935         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   936             20  HOLD-CEN-1-R-X-MO     PIC XX.
   937             20  HOLD-CEN-1-R-X-DA     PIC XX.
   938             20  HOLD-CEN-1-R-X-CCYY.
   939                 24  HOLD-CEN-1-R-X-CC PIC XX.
   940                 24  HOLD-CEN-1-R-X-YY PIC XX.
   941             20  FILLER                PIC XXX.
   942         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   943         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   944         16  DC-JULIAN-DATE-1          PIC 9(07).
   945         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   946             20  DC-JULIAN-1-CCYY.
   947                 24  DC-JULIAN-1-CC    PIC 99.
   948                 24  DC-JULIAN-1-YR    PIC 99.
   949             20  DC-JULIAN-DA-1        PIC 999.
   950         16  DC-JULIAN-DATE-2          PIC 9(07).
   951         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   952             20  DC-JULIAN-2-CCYY.
   953                 24  DC-JULIAN-2-CC    PIC 99.
   954                 24  DC-JULIAN-2-YR    PIC 99.
   955             20  DC-JULIAN-DA-2        PIC 999.
   956         16  DC-GREG-DATE-A-EDIT.
   957             20  DC-EDITA-MONTH        PIC 99.
   958             20  SLASHA-1              PIC X VALUE '/'.
   959             20  DC-EDITA-DAY          PIC 99.
   960             20  SLASHA-2              PIC X VALUE '/'.
   961             20  DC-EDITA-CCYY.
   962                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL104.cbl
   963                 24  DC-EDITA-YEAR     PIC 99.
   964         16  DC-GREG-DATE-B-EDIT.
   965             20  DC-EDITB-MONTH        PIC 99.
   966             20  SLASHB-1              PIC X VALUE '/'.
   967             20  DC-EDITB-DAY          PIC 99.
   968             20  SLASHB-2              PIC X VALUE '/'.
   969             20  DC-EDITB-CCYY.
   970                 24  DC-EDITB-CENT     PIC 99.
   971                 24  DC-EDITB-YEAR     PIC 99.
   972         16  DC-GREG-DATE-CYMD         PIC 9(08).
   973         16  DC-GREG-DATE-CYMD-R REDEFINES
   974                              DC-GREG-DATE-CYMD.
   975             20  DC-CYMD-CEN           PIC 99.
   976             20  DC-CYMD-YEAR          PIC 99.
   977             20  DC-CYMD-MONTH         PIC 99.
   978             20  DC-CYMD-DAY           PIC 99.
   979         16  DC-GREG-DATE-MDCY         PIC 9(08).
   980         16  DC-GREG-DATE-MDCY-R REDEFINES
   981                              DC-GREG-DATE-MDCY.
   982             20  DC-MDCY-MONTH         PIC 99.
   983             20  DC-MDCY-DAY           PIC 99.
   984             20  DC-MDCY-CEN           PIC 99.
   985             20  DC-MDCY-YEAR          PIC 99.
   986    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   987        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   988    12  DC-EL310-DATE                  PIC X(21).
   989    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL104.cbl
   991*    COPY EL104S.
   992 01  EL104BFI.
   993     05  FILLER            PIC  X(0012).
   994*    -------------------------------
   995     05  DATEBFL PIC S9(0004) COMP.
   996     05  DATEBFF PIC  X(0001).
   997     05  FILLER REDEFINES DATEBFF.
   998         10  DATEBFA PIC  X(0001).
   999     05  DATEBFI PIC  X(0008).
  1000*    -------------------------------
  1001     05  TIMEBFL PIC S9(0004) COMP.
  1002     05  TIMEBFF PIC  X(0001).
  1003     05  FILLER REDEFINES TIMEBFF.
  1004         10  TIMEBFA PIC  X(0001).
  1005     05  TIMEBFI PIC  X(0005).
  1006*    -------------------------------
  1007     05  COMPFL PIC S9(0004) COMP.
  1008     05  COMPFF PIC  X(0001).
  1009     05  FILLER REDEFINES COMPFF.
  1010         10  COMPFA PIC  X(0001).
  1011     05  COMPFI PIC  X(0003).
  1012*    -------------------------------
  1013     05  TXTTPBFL PIC S9(0004) COMP.
  1014     05  TXTTPBFF PIC  X(0001).
  1015     05  FILLER REDEFINES TXTTPBFF.
  1016         10  TXTTPBFA PIC  X(0001).
  1017     05  TXTTPBFI PIC  X(0008).
  1018*    -------------------------------
  1019     05  CNTRLBFL PIC S9(0004) COMP.
  1020     05  CNTRLBFF PIC  X(0001).
  1021     05  FILLER REDEFINES CNTRLBFF.
  1022         10  CNTRLBFA PIC  X(0001).
  1023     05  CNTRLBFI PIC  X(0012).
  1024*    -------------------------------
  1025     05  ARCHTBFL PIC S9(0004) COMP.
  1026     05  ARCHTBFF PIC  X(0001).
  1027     05  FILLER REDEFINES ARCHTBFF.
  1028         10  ARCHTBFA PIC  X(0001).
  1029     05  ARCHTBFI PIC  X(0009).
  1030*    -------------------------------
  1031     05  ARCHBFL PIC S9(0004) COMP.
  1032     05  ARCHBFF PIC  X(0001).
  1033     05  FILLER REDEFINES ARCHBFF.
  1034         10  ARCHBFA PIC  X(0001).
  1035     05  ARCHBFI PIC  X(0001).
  1036*    -------------------------------
  1037     05  FRMSTBFL PIC S9(0004) COMP.
  1038     05  FRMSTBFF PIC  X(0001).
  1039     05  FILLER REDEFINES FRMSTBFF.
  1040         10  FRMSTBFA PIC  X(0001).
  1041     05  FRMSTBFI PIC  X(0012).
  1042*    -------------------------------
  1043     05  FRMSQBFL PIC S9(0004) COMP.
  1044     05  FRMSQBFF PIC  X(0001).
  1045     05  FILLER REDEFINES FRMSQBFF.
  1046         10  FRMSQBFA PIC  X(0001).
  1047     05  FRMSQBFI PIC  X(0001).
  1048*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL104.cbl
  1049     05  TOTFL PIC S9(0004) COMP.
  1050     05  TOTFF PIC  X(0001).
  1051     05  FILLER REDEFINES TOTFF.
  1052         10  TOTFA PIC  X(0001).
  1053     05  TOTFI PIC  999.
  1054*    -------------------------------
  1055     05  LNESQTFL PIC S9(0004) COMP.
  1056     05  LNESQTFF PIC  X(0001).
  1057     05  FILLER REDEFINES LNESQTFF.
  1058         10  LNESQTFA PIC  X(0001).
  1059     05  LNESQTFI PIC  X(0001).
  1060*    -------------------------------
  1061     05  L1FL PIC S9(0004) COMP.
  1062     05  L1FF PIC  X(0001).
  1063     05  FILLER REDEFINES L1FF.
  1064         10  L1FA PIC  X(0001).
  1065     05  L1FI PIC  X(0003).
  1066*    -------------------------------
  1067     05  TEXT1FL PIC S9(0004) COMP.
  1068     05  TEXT1FF PIC  X(0001).
  1069     05  FILLER REDEFINES TEXT1FF.
  1070         10  TEXT1FA PIC  X(0001).
  1071     05  TEXT1FI PIC  X(0070).
  1072*    -------------------------------
  1073     05  CF1FL PIC S9(0004) COMP.
  1074     05  CF1FF PIC  X(0001).
  1075     05  FILLER REDEFINES CF1FF.
  1076         10  CF1FA PIC  X(0001).
  1077     05  CF1FI PIC  X(0002).
  1078*    -------------------------------
  1079     05  SQ1FL PIC S9(0004) COMP.
  1080     05  SQ1FF PIC  X(0001).
  1081     05  FILLER REDEFINES SQ1FF.
  1082         10  SQ1FA PIC  X(0001).
  1083     05  SQ1FI PIC  X(0001).
  1084*    -------------------------------
  1085     05  L2FL PIC S9(0004) COMP.
  1086     05  L2FF PIC  X(0001).
  1087     05  FILLER REDEFINES L2FF.
  1088         10  L2FA PIC  X(0001).
  1089     05  L2FI PIC  X(0003).
  1090*    -------------------------------
  1091     05  TEXT2FL PIC S9(0004) COMP.
  1092     05  TEXT2FF PIC  X(0001).
  1093     05  FILLER REDEFINES TEXT2FF.
  1094         10  TEXT2FA PIC  X(0001).
  1095     05  TEXT2FI PIC  X(0070).
  1096*    -------------------------------
  1097     05  CF2FL PIC S9(0004) COMP.
  1098     05  CF2FF PIC  X(0001).
  1099     05  FILLER REDEFINES CF2FF.
  1100         10  CF2FA PIC  X(0001).
  1101     05  CF2FI PIC  X(0002).
  1102*    -------------------------------
  1103     05  SQ2FL PIC S9(0004) COMP.
  1104     05  SQ2FF PIC  X(0001).
  1105     05  FILLER REDEFINES SQ2FF.
  1106         10  SQ2FA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL104.cbl
  1107     05  SQ2FI PIC  X(0001).
  1108*    -------------------------------
  1109     05  L3FL PIC S9(0004) COMP.
  1110     05  L3FF PIC  X(0001).
  1111     05  FILLER REDEFINES L3FF.
  1112         10  L3FA PIC  X(0001).
  1113     05  L3FI PIC  X(0003).
  1114*    -------------------------------
  1115     05  TEXT3FL PIC S9(0004) COMP.
  1116     05  TEXT3FF PIC  X(0001).
  1117     05  FILLER REDEFINES TEXT3FF.
  1118         10  TEXT3FA PIC  X(0001).
  1119     05  TEXT3FI PIC  X(0070).
  1120*    -------------------------------
  1121     05  CF3FL PIC S9(0004) COMP.
  1122     05  CF3FF PIC  X(0001).
  1123     05  FILLER REDEFINES CF3FF.
  1124         10  CF3FA PIC  X(0001).
  1125     05  CF3FI PIC  X(0002).
  1126*    -------------------------------
  1127     05  SQ3FL PIC S9(0004) COMP.
  1128     05  SQ3FF PIC  X(0001).
  1129     05  FILLER REDEFINES SQ3FF.
  1130         10  SQ3FA PIC  X(0001).
  1131     05  SQ3FI PIC  X(0001).
  1132*    -------------------------------
  1133     05  L4FL PIC S9(0004) COMP.
  1134     05  L4FF PIC  X(0001).
  1135     05  FILLER REDEFINES L4FF.
  1136         10  L4FA PIC  X(0001).
  1137     05  L4FI PIC  X(0003).
  1138*    -------------------------------
  1139     05  TEXT4FL PIC S9(0004) COMP.
  1140     05  TEXT4FF PIC  X(0001).
  1141     05  FILLER REDEFINES TEXT4FF.
  1142         10  TEXT4FA PIC  X(0001).
  1143     05  TEXT4FI PIC  X(0070).
  1144*    -------------------------------
  1145     05  CF4FL PIC S9(0004) COMP.
  1146     05  CF4FF PIC  X(0001).
  1147     05  FILLER REDEFINES CF4FF.
  1148         10  CF4FA PIC  X(0001).
  1149     05  CF4FI PIC  X(0002).
  1150*    -------------------------------
  1151     05  SQ4FL PIC S9(0004) COMP.
  1152     05  SQ4FF PIC  X(0001).
  1153     05  FILLER REDEFINES SQ4FF.
  1154         10  SQ4FA PIC  X(0001).
  1155     05  SQ4FI PIC  X(0001).
  1156*    -------------------------------
  1157     05  L5FL PIC S9(0004) COMP.
  1158     05  L5FF PIC  X(0001).
  1159     05  FILLER REDEFINES L5FF.
  1160         10  L5FA PIC  X(0001).
  1161     05  L5FI PIC  X(0003).
  1162*    -------------------------------
  1163     05  TEXT5FL PIC S9(0004) COMP.
  1164     05  TEXT5FF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL104.cbl
  1165     05  FILLER REDEFINES TEXT5FF.
  1166         10  TEXT5FA PIC  X(0001).
  1167     05  TEXT5FI PIC  X(0070).
  1168*    -------------------------------
  1169     05  CF5FL PIC S9(0004) COMP.
  1170     05  CF5FF PIC  X(0001).
  1171     05  FILLER REDEFINES CF5FF.
  1172         10  CF5FA PIC  X(0001).
  1173     05  CF5FI PIC  X(0002).
  1174*    -------------------------------
  1175     05  SQ5FL PIC S9(0004) COMP.
  1176     05  SQ5FF PIC  X(0001).
  1177     05  FILLER REDEFINES SQ5FF.
  1178         10  SQ5FA PIC  X(0001).
  1179     05  SQ5FI PIC  X(0001).
  1180*    -------------------------------
  1181     05  L6FL PIC S9(0004) COMP.
  1182     05  L6FF PIC  X(0001).
  1183     05  FILLER REDEFINES L6FF.
  1184         10  L6FA PIC  X(0001).
  1185     05  L6FI PIC  X(0003).
  1186*    -------------------------------
  1187     05  TEXT6FL PIC S9(0004) COMP.
  1188     05  TEXT6FF PIC  X(0001).
  1189     05  FILLER REDEFINES TEXT6FF.
  1190         10  TEXT6FA PIC  X(0001).
  1191     05  TEXT6FI PIC  X(0070).
  1192*    -------------------------------
  1193     05  CF6FL PIC S9(0004) COMP.
  1194     05  CF6FF PIC  X(0001).
  1195     05  FILLER REDEFINES CF6FF.
  1196         10  CF6FA PIC  X(0001).
  1197     05  CF6FI PIC  X(0002).
  1198*    -------------------------------
  1199     05  SQ6FL PIC S9(0004) COMP.
  1200     05  SQ6FF PIC  X(0001).
  1201     05  FILLER REDEFINES SQ6FF.
  1202         10  SQ6FA PIC  X(0001).
  1203     05  SQ6FI PIC  X(0001).
  1204*    -------------------------------
  1205     05  L7FL PIC S9(0004) COMP.
  1206     05  L7FF PIC  X(0001).
  1207     05  FILLER REDEFINES L7FF.
  1208         10  L7FA PIC  X(0001).
  1209     05  L7FI PIC  X(0003).
  1210*    -------------------------------
  1211     05  TEXT7FL PIC S9(0004) COMP.
  1212     05  TEXT7FF PIC  X(0001).
  1213     05  FILLER REDEFINES TEXT7FF.
  1214         10  TEXT7FA PIC  X(0001).
  1215     05  TEXT7FI PIC  X(0070).
  1216*    -------------------------------
  1217     05  CF7FL PIC S9(0004) COMP.
  1218     05  CF7FF PIC  X(0001).
  1219     05  FILLER REDEFINES CF7FF.
  1220         10  CF7FA PIC  X(0001).
  1221     05  CF7FI PIC  X(0002).
  1222*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL104.cbl
  1223     05  SQ7FL PIC S9(0004) COMP.
  1224     05  SQ7FF PIC  X(0001).
  1225     05  FILLER REDEFINES SQ7FF.
  1226         10  SQ7FA PIC  X(0001).
  1227     05  SQ7FI PIC  X(0001).
  1228*    -------------------------------
  1229     05  L8FL PIC S9(0004) COMP.
  1230     05  L8FF PIC  X(0001).
  1231     05  FILLER REDEFINES L8FF.
  1232         10  L8FA PIC  X(0001).
  1233     05  L8FI PIC  X(0003).
  1234*    -------------------------------
  1235     05  TEXT8FL PIC S9(0004) COMP.
  1236     05  TEXT8FF PIC  X(0001).
  1237     05  FILLER REDEFINES TEXT8FF.
  1238         10  TEXT8FA PIC  X(0001).
  1239     05  TEXT8FI PIC  X(0070).
  1240*    -------------------------------
  1241     05  CF8FL PIC S9(0004) COMP.
  1242     05  CF8FF PIC  X(0001).
  1243     05  FILLER REDEFINES CF8FF.
  1244         10  CF8FA PIC  X(0001).
  1245     05  CF8FI PIC  X(0002).
  1246*    -------------------------------
  1247     05  SQ8FL PIC S9(0004) COMP.
  1248     05  SQ8FF PIC  X(0001).
  1249     05  FILLER REDEFINES SQ8FF.
  1250         10  SQ8FA PIC  X(0001).
  1251     05  SQ8FI PIC  X(0001).
  1252*    -------------------------------
  1253     05  L9FL PIC S9(0004) COMP.
  1254     05  L9FF PIC  X(0001).
  1255     05  FILLER REDEFINES L9FF.
  1256         10  L9FA PIC  X(0001).
  1257     05  L9FI PIC  X(0003).
  1258*    -------------------------------
  1259     05  TEXT9FL PIC S9(0004) COMP.
  1260     05  TEXT9FF PIC  X(0001).
  1261     05  FILLER REDEFINES TEXT9FF.
  1262         10  TEXT9FA PIC  X(0001).
  1263     05  TEXT9FI PIC  X(0070).
  1264*    -------------------------------
  1265     05  CF9FL PIC S9(0004) COMP.
  1266     05  CF9FF PIC  X(0001).
  1267     05  FILLER REDEFINES CF9FF.
  1268         10  CF9FA PIC  X(0001).
  1269     05  CF9FI PIC  X(0002).
  1270*    -------------------------------
  1271     05  SQ9FL PIC S9(0004) COMP.
  1272     05  SQ9FF PIC  X(0001).
  1273     05  FILLER REDEFINES SQ9FF.
  1274         10  SQ9FA PIC  X(0001).
  1275     05  SQ9FI PIC  X(0001).
  1276*    -------------------------------
  1277     05  L10FL PIC S9(0004) COMP.
  1278     05  L10FF PIC  X(0001).
  1279     05  FILLER REDEFINES L10FF.
  1280         10  L10FA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL104.cbl
  1281     05  L10FI PIC  X(0003).
  1282*    -------------------------------
  1283     05  TEXT10FL PIC S9(0004) COMP.
  1284     05  TEXT10FF PIC  X(0001).
  1285     05  FILLER REDEFINES TEXT10FF.
  1286         10  TEXT10FA PIC  X(0001).
  1287     05  TEXT10FI PIC  X(0070).
  1288*    -------------------------------
  1289     05  CF10FL PIC S9(0004) COMP.
  1290     05  CF10FF PIC  X(0001).
  1291     05  FILLER REDEFINES CF10FF.
  1292         10  CF10FA PIC  X(0001).
  1293     05  CF10FI PIC  X(0002).
  1294*    -------------------------------
  1295     05  SQ10FL PIC S9(0004) COMP.
  1296     05  SQ10FF PIC  X(0001).
  1297     05  FILLER REDEFINES SQ10FF.
  1298         10  SQ10FA PIC  X(0001).
  1299     05  SQ10FI PIC  X(0001).
  1300*    -------------------------------
  1301     05  L11FL PIC S9(0004) COMP.
  1302     05  L11FF PIC  X(0001).
  1303     05  FILLER REDEFINES L11FF.
  1304         10  L11FA PIC  X(0001).
  1305     05  L11FI PIC  X(0003).
  1306*    -------------------------------
  1307     05  TEXT11FL PIC S9(0004) COMP.
  1308     05  TEXT11FF PIC  X(0001).
  1309     05  FILLER REDEFINES TEXT11FF.
  1310         10  TEXT11FA PIC  X(0001).
  1311     05  TEXT11FI PIC  X(0070).
  1312*    -------------------------------
  1313     05  CF11FL PIC S9(0004) COMP.
  1314     05  CF11FF PIC  X(0001).
  1315     05  FILLER REDEFINES CF11FF.
  1316         10  CF11FA PIC  X(0001).
  1317     05  CF11FI PIC  X(0002).
  1318*    -------------------------------
  1319     05  SQ11FL PIC S9(0004) COMP.
  1320     05  SQ11FF PIC  X(0001).
  1321     05  FILLER REDEFINES SQ11FF.
  1322         10  SQ11FA PIC  X(0001).
  1323     05  SQ11FI PIC  X(0001).
  1324*    -------------------------------
  1325     05  L12FL PIC S9(0004) COMP.
  1326     05  L12FF PIC  X(0001).
  1327     05  FILLER REDEFINES L12FF.
  1328         10  L12FA PIC  X(0001).
  1329     05  L12FI PIC  X(0003).
  1330*    -------------------------------
  1331     05  TEXT12FL PIC S9(0004) COMP.
  1332     05  TEXT12FF PIC  X(0001).
  1333     05  FILLER REDEFINES TEXT12FF.
  1334         10  TEXT12FA PIC  X(0001).
  1335     05  TEXT12FI PIC  X(0070).
  1336*    -------------------------------
  1337     05  CF12FL PIC S9(0004) COMP.
  1338     05  CF12FF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL104.cbl
  1339     05  FILLER REDEFINES CF12FF.
  1340         10  CF12FA PIC  X(0001).
  1341     05  CF12FI PIC  X(0002).
  1342*    -------------------------------
  1343     05  SQ12FL PIC S9(0004) COMP.
  1344     05  SQ12FF PIC  X(0001).
  1345     05  FILLER REDEFINES SQ12FF.
  1346         10  SQ12FA PIC  X(0001).
  1347     05  SQ12FI PIC  X(0001).
  1348*    -------------------------------
  1349     05  L13FL PIC S9(0004) COMP.
  1350     05  L13FF PIC  X(0001).
  1351     05  FILLER REDEFINES L13FF.
  1352         10  L13FA PIC  X(0001).
  1353     05  L13FI PIC  X(0003).
  1354*    -------------------------------
  1355     05  TEXT13FL PIC S9(0004) COMP.
  1356     05  TEXT13FF PIC  X(0001).
  1357     05  FILLER REDEFINES TEXT13FF.
  1358         10  TEXT13FA PIC  X(0001).
  1359     05  TEXT13FI PIC  X(0070).
  1360*    -------------------------------
  1361     05  CF13FL PIC S9(0004) COMP.
  1362     05  CF13FF PIC  X(0001).
  1363     05  FILLER REDEFINES CF13FF.
  1364         10  CF13FA PIC  X(0001).
  1365     05  CF13FI PIC  X(0002).
  1366*    -------------------------------
  1367     05  SQ13FL PIC S9(0004) COMP.
  1368     05  SQ13FF PIC  X(0001).
  1369     05  FILLER REDEFINES SQ13FF.
  1370         10  SQ13FA PIC  X(0001).
  1371     05  SQ13FI PIC  X(0001).
  1372*    -------------------------------
  1373     05  L14FL PIC S9(0004) COMP.
  1374     05  L14FF PIC  X(0001).
  1375     05  FILLER REDEFINES L14FF.
  1376         10  L14FA PIC  X(0001).
  1377     05  L14FI PIC  X(0003).
  1378*    -------------------------------
  1379     05  TEXT14FL PIC S9(0004) COMP.
  1380     05  TEXT14FF PIC  X(0001).
  1381     05  FILLER REDEFINES TEXT14FF.
  1382         10  TEXT14FA PIC  X(0001).
  1383     05  TEXT14FI PIC  X(0070).
  1384*    -------------------------------
  1385     05  CF14FL PIC S9(0004) COMP.
  1386     05  CF14FF PIC  X(0001).
  1387     05  FILLER REDEFINES CF14FF.
  1388         10  CF14FA PIC  X(0001).
  1389     05  CF14FI PIC  X(0002).
  1390*    -------------------------------
  1391     05  SQ14FL PIC S9(0004) COMP.
  1392     05  SQ14FF PIC  X(0001).
  1393     05  FILLER REDEFINES SQ14FF.
  1394         10  SQ14FA PIC  X(0001).
  1395     05  SQ14FI PIC  X(0001).
  1396*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL104.cbl
  1397     05  L15FL PIC S9(0004) COMP.
  1398     05  L15FF PIC  X(0001).
  1399     05  FILLER REDEFINES L15FF.
  1400         10  L15FA PIC  X(0001).
  1401     05  L15FI PIC  X(0003).
  1402*    -------------------------------
  1403     05  TEXT15FL PIC S9(0004) COMP.
  1404     05  TEXT15FF PIC  X(0001).
  1405     05  FILLER REDEFINES TEXT15FF.
  1406         10  TEXT15FA PIC  X(0001).
  1407     05  TEXT15FI PIC  X(0070).
  1408*    -------------------------------
  1409     05  CF15FL PIC S9(0004) COMP.
  1410     05  CF15FF PIC  X(0001).
  1411     05  FILLER REDEFINES CF15FF.
  1412         10  CF15FA PIC  X(0001).
  1413     05  CF15FI PIC  X(0002).
  1414*    -------------------------------
  1415     05  SQ15FL PIC S9(0004) COMP.
  1416     05  SQ15FF PIC  X(0001).
  1417     05  FILLER REDEFINES SQ15FF.
  1418         10  SQ15FA PIC  X(0001).
  1419     05  SQ15FI PIC  X(0001).
  1420*    -------------------------------
  1421     05  ERMSGBFL PIC S9(0004) COMP.
  1422     05  ERMSGBFF PIC  X(0001).
  1423     05  FILLER REDEFINES ERMSGBFF.
  1424         10  ERMSGBFA PIC  X(0001).
  1425     05  ERMSGBFI PIC  X(0072).
  1426*    -------------------------------
  1427     05  FUNCTFL PIC S9(0004) COMP.
  1428     05  FUNCTFF PIC  X(0001).
  1429     05  FILLER REDEFINES FUNCTFF.
  1430         10  FUNCTFA PIC  X(0001).
  1431     05  FUNCTFI PIC  X(0001).
  1432*    -------------------------------
  1433     05  LINE1FL PIC S9(0004) COMP.
  1434     05  LINE1FF PIC  X(0001).
  1435     05  FILLER REDEFINES LINE1FF.
  1436         10  LINE1FA PIC  X(0001).
  1437     05  LINE1FI PIC  999.
  1438*    -------------------------------
  1439     05  LINE2FL PIC S9(0004) COMP.
  1440     05  LINE2FF PIC  X(0001).
  1441     05  FILLER REDEFINES LINE2FF.
  1442         10  LINE2FA PIC  X(0001).
  1443     05  LINE2FI PIC  999.
  1444*    -------------------------------
  1445     05  PFBFL PIC S9(0004) COMP.
  1446     05  PFBFF PIC  X(0001).
  1447     05  FILLER REDEFINES PFBFF.
  1448         10  PFBFA PIC  X(0001).
  1449     05  PFBFI PIC  99.
  1450*    -------------------------------
  1451     05  MNTBYFL PIC S9(0004) COMP.
  1452     05  MNTBYFF PIC  X(0001).
  1453     05  FILLER REDEFINES MNTBYFF.
  1454         10  MNTBYFA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL104.cbl
  1455     05  MNTBYFI PIC  X(0005).
  1456*    -------------------------------
  1457     05  MNTONFL PIC S9(0004) COMP.
  1458     05  MNTONFF PIC  X(0001).
  1459     05  FILLER REDEFINES MNTONFF.
  1460         10  MNTONFA PIC  X(0001).
  1461     05  MNTONFI PIC  X(0008).
  1462 01  EL104BFO REDEFINES EL104BFI.
  1463     05  FILLER            PIC  X(0012).
  1464*    -------------------------------
  1465     05  FILLER            PIC  X(0003).
  1466     05  DATEBFO PIC  X(0008).
  1467*    -------------------------------
  1468     05  FILLER            PIC  X(0003).
  1469     05  TIMEBFO PIC  99.99.
  1470*    -------------------------------
  1471     05  FILLER            PIC  X(0003).
  1472     05  COMPFO PIC  X(0003).
  1473*    -------------------------------
  1474     05  FILLER            PIC  X(0003).
  1475     05  TXTTPBFO PIC  X(0008).
  1476*    -------------------------------
  1477     05  FILLER            PIC  X(0003).
  1478     05  CNTRLBFO PIC  X(0012).
  1479*    -------------------------------
  1480     05  FILLER            PIC  X(0003).
  1481     05  ARCHTBFO PIC  X(0009).
  1482*    -------------------------------
  1483     05  FILLER            PIC  X(0003).
  1484     05  ARCHBFO PIC  X(0001).
  1485*    -------------------------------
  1486     05  FILLER            PIC  X(0003).
  1487     05  FRMSTBFO PIC  X(0012).
  1488*    -------------------------------
  1489     05  FILLER            PIC  X(0003).
  1490     05  FRMSQBFO PIC  X(0001).
  1491*    -------------------------------
  1492     05  FILLER            PIC  X(0003).
  1493     05  TOTFO PIC  X(0003).
  1494*    -------------------------------
  1495     05  FILLER            PIC  X(0003).
  1496     05  LNESQTFO PIC  X(0001).
  1497*    -------------------------------
  1498     05  FILLER            PIC  X(0003).
  1499     05  L1FO PIC  X(0003).
  1500*    -------------------------------
  1501     05  FILLER            PIC  X(0003).
  1502     05  TEXT1FO PIC  X(0070).
  1503*    -------------------------------
  1504     05  FILLER            PIC  X(0003).
  1505     05  CF1FO PIC  X(0002).
  1506*    -------------------------------
  1507     05  FILLER            PIC  X(0003).
  1508     05  SQ1FO PIC  X(0001).
  1509*    -------------------------------
  1510     05  FILLER            PIC  X(0003).
  1511     05  L2FO PIC  X(0003).
  1512*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL104.cbl
  1513     05  FILLER            PIC  X(0003).
  1514     05  TEXT2FO PIC  X(0070).
  1515*    -------------------------------
  1516     05  FILLER            PIC  X(0003).
  1517     05  CF2FO PIC  X(0002).
  1518*    -------------------------------
  1519     05  FILLER            PIC  X(0003).
  1520     05  SQ2FO PIC  X(0001).
  1521*    -------------------------------
  1522     05  FILLER            PIC  X(0003).
  1523     05  L3FO PIC  X(0003).
  1524*    -------------------------------
  1525     05  FILLER            PIC  X(0003).
  1526     05  TEXT3FO PIC  X(0070).
  1527*    -------------------------------
  1528     05  FILLER            PIC  X(0003).
  1529     05  CF3FO PIC  X(0002).
  1530*    -------------------------------
  1531     05  FILLER            PIC  X(0003).
  1532     05  SQ3FO PIC  X(0001).
  1533*    -------------------------------
  1534     05  FILLER            PIC  X(0003).
  1535     05  L4FO PIC  X(0003).
  1536*    -------------------------------
  1537     05  FILLER            PIC  X(0003).
  1538     05  TEXT4FO PIC  X(0070).
  1539*    -------------------------------
  1540     05  FILLER            PIC  X(0003).
  1541     05  CF4FO PIC  X(0002).
  1542*    -------------------------------
  1543     05  FILLER            PIC  X(0003).
  1544     05  SQ4FO PIC  X(0001).
  1545*    -------------------------------
  1546     05  FILLER            PIC  X(0003).
  1547     05  L5FO PIC  X(0003).
  1548*    -------------------------------
  1549     05  FILLER            PIC  X(0003).
  1550     05  TEXT5FO PIC  X(0070).
  1551*    -------------------------------
  1552     05  FILLER            PIC  X(0003).
  1553     05  CF5FO PIC  X(0002).
  1554*    -------------------------------
  1555     05  FILLER            PIC  X(0003).
  1556     05  SQ5FO PIC  X(0001).
  1557*    -------------------------------
  1558     05  FILLER            PIC  X(0003).
  1559     05  L6FO PIC  X(0003).
  1560*    -------------------------------
  1561     05  FILLER            PIC  X(0003).
  1562     05  TEXT6FO PIC  X(0070).
  1563*    -------------------------------
  1564     05  FILLER            PIC  X(0003).
  1565     05  CF6FO PIC  X(0002).
  1566*    -------------------------------
  1567     05  FILLER            PIC  X(0003).
  1568     05  SQ6FO PIC  X(0001).
  1569*    -------------------------------
  1570     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL104.cbl
  1571     05  L7FO PIC  X(0003).
  1572*    -------------------------------
  1573     05  FILLER            PIC  X(0003).
  1574     05  TEXT7FO PIC  X(0070).
  1575*    -------------------------------
  1576     05  FILLER            PIC  X(0003).
  1577     05  CF7FO PIC  X(0002).
  1578*    -------------------------------
  1579     05  FILLER            PIC  X(0003).
  1580     05  SQ7FO PIC  X(0001).
  1581*    -------------------------------
  1582     05  FILLER            PIC  X(0003).
  1583     05  L8FO PIC  X(0003).
  1584*    -------------------------------
  1585     05  FILLER            PIC  X(0003).
  1586     05  TEXT8FO PIC  X(0070).
  1587*    -------------------------------
  1588     05  FILLER            PIC  X(0003).
  1589     05  CF8FO PIC  X(0002).
  1590*    -------------------------------
  1591     05  FILLER            PIC  X(0003).
  1592     05  SQ8FO PIC  X(0001).
  1593*    -------------------------------
  1594     05  FILLER            PIC  X(0003).
  1595     05  L9FO PIC  X(0003).
  1596*    -------------------------------
  1597     05  FILLER            PIC  X(0003).
  1598     05  TEXT9FO PIC  X(0070).
  1599*    -------------------------------
  1600     05  FILLER            PIC  X(0003).
  1601     05  CF9FO PIC  X(0002).
  1602*    -------------------------------
  1603     05  FILLER            PIC  X(0003).
  1604     05  SQ9FO PIC  X(0001).
  1605*    -------------------------------
  1606     05  FILLER            PIC  X(0003).
  1607     05  L10FO PIC  X(0003).
  1608*    -------------------------------
  1609     05  FILLER            PIC  X(0003).
  1610     05  TEXT10FO PIC  X(0070).
  1611*    -------------------------------
  1612     05  FILLER            PIC  X(0003).
  1613     05  CF10FO PIC  X(0002).
  1614*    -------------------------------
  1615     05  FILLER            PIC  X(0003).
  1616     05  SQ10FO PIC  X(0001).
  1617*    -------------------------------
  1618     05  FILLER            PIC  X(0003).
  1619     05  L11FO PIC  X(0003).
  1620*    -------------------------------
  1621     05  FILLER            PIC  X(0003).
  1622     05  TEXT11FO PIC  X(0070).
  1623*    -------------------------------
  1624     05  FILLER            PIC  X(0003).
  1625     05  CF11FO PIC  X(0002).
  1626*    -------------------------------
  1627     05  FILLER            PIC  X(0003).
  1628     05  SQ11FO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL104.cbl
  1629*    -------------------------------
  1630     05  FILLER            PIC  X(0003).
  1631     05  L12FO PIC  X(0003).
  1632*    -------------------------------
  1633     05  FILLER            PIC  X(0003).
  1634     05  TEXT12FO PIC  X(0070).
  1635*    -------------------------------
  1636     05  FILLER            PIC  X(0003).
  1637     05  CF12FO PIC  X(0002).
  1638*    -------------------------------
  1639     05  FILLER            PIC  X(0003).
  1640     05  SQ12FO PIC  X(0001).
  1641*    -------------------------------
  1642     05  FILLER            PIC  X(0003).
  1643     05  L13FO PIC  X(0003).
  1644*    -------------------------------
  1645     05  FILLER            PIC  X(0003).
  1646     05  TEXT13FO PIC  X(0070).
  1647*    -------------------------------
  1648     05  FILLER            PIC  X(0003).
  1649     05  CF13FO PIC  X(0002).
  1650*    -------------------------------
  1651     05  FILLER            PIC  X(0003).
  1652     05  SQ13FO PIC  X(0001).
  1653*    -------------------------------
  1654     05  FILLER            PIC  X(0003).
  1655     05  L14FO PIC  X(0003).
  1656*    -------------------------------
  1657     05  FILLER            PIC  X(0003).
  1658     05  TEXT14FO PIC  X(0070).
  1659*    -------------------------------
  1660     05  FILLER            PIC  X(0003).
  1661     05  CF14FO PIC  X(0002).
  1662*    -------------------------------
  1663     05  FILLER            PIC  X(0003).
  1664     05  SQ14FO PIC  X(0001).
  1665*    -------------------------------
  1666     05  FILLER            PIC  X(0003).
  1667     05  L15FO PIC  X(0003).
  1668*    -------------------------------
  1669     05  FILLER            PIC  X(0003).
  1670     05  TEXT15FO PIC  X(0070).
  1671*    -------------------------------
  1672     05  FILLER            PIC  X(0003).
  1673     05  CF15FO PIC  X(0002).
  1674*    -------------------------------
  1675     05  FILLER            PIC  X(0003).
  1676     05  SQ15FO PIC  X(0001).
  1677*    -------------------------------
  1678     05  FILLER            PIC  X(0003).
  1679     05  ERMSGBFO PIC  X(0072).
  1680*    -------------------------------
  1681     05  FILLER            PIC  X(0003).
  1682     05  FUNCTFO PIC  X(0001).
  1683*    -------------------------------
  1684     05  FILLER            PIC  X(0003).
  1685     05  LINE1FO PIC  X(0003).
  1686*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL104.cbl
  1687     05  FILLER            PIC  X(0003).
  1688     05  LINE2FO PIC  X(0003).
  1689*    -------------------------------
  1690     05  FILLER            PIC  X(0003).
  1691     05  PFBFO PIC  X(0002).
  1692*    -------------------------------
  1693     05  FILLER            PIC  X(0003).
  1694     05  MNTBYFO PIC  X(0005).
  1695*    -------------------------------
  1696     05  FILLER            PIC  X(0003).
  1697     05  MNTONFO PIC  X(0008).
  1698*    -------------------------------
  1699 01  EL104BI REDEFINES EL104BFI.
  1700     05  FILLER            PIC  X(0012).
  1701*    -------------------------------
  1702     05  DATEBL PIC S9(0004) COMP.
  1703     05  DATEBF PIC  X(0001).
  1704     05  FILLER REDEFINES DATEBF.
  1705         10  DATEBA PIC  X(0001).
  1706     05  DATEBI PIC  X(0008).
  1707*    -------------------------------
  1708     05  TIMEBL PIC S9(0004) COMP.
  1709     05  TIMEBF PIC  X(0001).
  1710     05  FILLER REDEFINES TIMEBF.
  1711         10  TIMEBA PIC  X(0001).
  1712     05  TIMEBI PIC  X(0005).
  1713*    -------------------------------
  1714     05  COMPANYL PIC S9(0004) COMP.
  1715     05  COMPANYF PIC  X(0001).
  1716     05  FILLER REDEFINES COMPANYF.
  1717         10  COMPANYA PIC  X(0001).
  1718     05  COMPANYI PIC  X(0003).
  1719*    -------------------------------
  1720     05  TEXTTPBL PIC S9(0004) COMP.
  1721     05  TEXTTPBF PIC  X(0001).
  1722     05  FILLER REDEFINES TEXTTPBF.
  1723         10  TEXTTPBA PIC  X(0001).
  1724     05  TEXTTPBI PIC  X(0008).
  1725*    -------------------------------
  1726     05  CONTRLBL PIC S9(0004) COMP.
  1727     05  CONTRLBF PIC  X(0001).
  1728     05  FILLER REDEFINES CONTRLBF.
  1729         10  CONTRLBA PIC  X(0001).
  1730     05  CONTRLBI PIC  X(0012).
  1731*    -------------------------------
  1732     05  ARCHTBL PIC S9(0004) COMP.
  1733     05  ARCHTBF PIC  X(0001).
  1734     05  FILLER REDEFINES ARCHTBF.
  1735         10  ARCHTBA PIC  X(0001).
  1736     05  ARCHTBI PIC  X(0009).
  1737*    -------------------------------
  1738     05  ARCHBL PIC S9(0004) COMP.
  1739     05  ARCHBF PIC  X(0001).
  1740     05  FILLER REDEFINES ARCHBF.
  1741         10  ARCHBA PIC  X(0001).
  1742     05  ARCHBI PIC  X(0001).
  1743*    -------------------------------
  1744     05  FORMSTBL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL104.cbl
  1745     05  FORMSTBF PIC  X(0001).
  1746     05  FILLER REDEFINES FORMSTBF.
  1747         10  FORMSTBA PIC  X(0001).
  1748     05  FORMSTBI PIC  X(0012).
  1749*    -------------------------------
  1750     05  FORMSQBL PIC S9(0004) COMP.
  1751     05  FORMSQBF PIC  X(0001).
  1752     05  FILLER REDEFINES FORMSQBF.
  1753         10  FORMSQBA PIC  X(0001).
  1754     05  FORMSQBI PIC  X(0001).
  1755*    -------------------------------
  1756     05  TOTL PIC S9(0004) COMP.
  1757     05  TOTF PIC  X(0001).
  1758     05  FILLER REDEFINES TOTF.
  1759         10  TOTA PIC  X(0001).
  1760     05  TOTI PIC  999.
  1761*    -------------------------------
  1762     05  LINESQTL PIC S9(0004) COMP.
  1763     05  LINESQTF PIC  X(0001).
  1764     05  FILLER REDEFINES LINESQTF.
  1765         10  LINESQTA PIC  X(0001).
  1766     05  LINESQTI PIC  X(0001).
  1767*    -------------------------------
  1768     05  L1L PIC S9(0004) COMP.
  1769     05  L1F PIC  X(0001).
  1770     05  FILLER REDEFINES L1F.
  1771         10  L1A PIC  X(0001).
  1772     05  L1I PIC  X(0003).
  1773*    -------------------------------
  1774     05  TEXT1L PIC S9(0004) COMP.
  1775     05  TEXT1F PIC  X(0001).
  1776     05  FILLER REDEFINES TEXT1F.
  1777         10  TEXT1A PIC  X(0001).
  1778     05  TEXT1I PIC  X(0070).
  1779*    -------------------------------
  1780     05  CF1L PIC S9(0004) COMP.
  1781     05  CF1F PIC  X(0001).
  1782     05  FILLER REDEFINES CF1F.
  1783         10  CF1A PIC  X(0001).
  1784     05  CF1I PIC  X(0002).
  1785*    -------------------------------
  1786     05  SQ1L PIC S9(0004) COMP.
  1787     05  SQ1F PIC  X(0001).
  1788     05  FILLER REDEFINES SQ1F.
  1789         10  SQ1A PIC  X(0001).
  1790     05  SQ1I PIC  X(0001).
  1791*    -------------------------------
  1792     05  L2L PIC S9(0004) COMP.
  1793     05  L2F PIC  X(0001).
  1794     05  FILLER REDEFINES L2F.
  1795         10  L2A PIC  X(0001).
  1796     05  L2I PIC  X(0003).
  1797*    -------------------------------
  1798     05  TEXT2L PIC S9(0004) COMP.
  1799     05  TEXT2F PIC  X(0001).
  1800     05  FILLER REDEFINES TEXT2F.
  1801         10  TEXT2A PIC  X(0001).
  1802     05  TEXT2I PIC  X(0070).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL104.cbl
  1803*    -------------------------------
  1804     05  CF2L PIC S9(0004) COMP.
  1805     05  CF2F PIC  X(0001).
  1806     05  FILLER REDEFINES CF2F.
  1807         10  CF2A PIC  X(0001).
  1808     05  CF2I PIC  X(0002).
  1809*    -------------------------------
  1810     05  SQ2L PIC S9(0004) COMP.
  1811     05  SQ2F PIC  X(0001).
  1812     05  FILLER REDEFINES SQ2F.
  1813         10  SQ2A PIC  X(0001).
  1814     05  SQ2I PIC  X(0001).
  1815*    -------------------------------
  1816     05  L3L PIC S9(0004) COMP.
  1817     05  L3F PIC  X(0001).
  1818     05  FILLER REDEFINES L3F.
  1819         10  L3A PIC  X(0001).
  1820     05  L3I PIC  X(0003).
  1821*    -------------------------------
  1822     05  TEXT3L PIC S9(0004) COMP.
  1823     05  TEXT3F PIC  X(0001).
  1824     05  FILLER REDEFINES TEXT3F.
  1825         10  TEXT3A PIC  X(0001).
  1826     05  TEXT3I PIC  X(0070).
  1827*    -------------------------------
  1828     05  CF3L PIC S9(0004) COMP.
  1829     05  CF3F PIC  X(0001).
  1830     05  FILLER REDEFINES CF3F.
  1831         10  CF3A PIC  X(0001).
  1832     05  CF3I PIC  X(0002).
  1833*    -------------------------------
  1834     05  SQ3L PIC S9(0004) COMP.
  1835     05  SQ3F PIC  X(0001).
  1836     05  FILLER REDEFINES SQ3F.
  1837         10  SQ3A PIC  X(0001).
  1838     05  SQ3I PIC  X(0001).
  1839*    -------------------------------
  1840     05  L4L PIC S9(0004) COMP.
  1841     05  L4F PIC  X(0001).
  1842     05  FILLER REDEFINES L4F.
  1843         10  L4A PIC  X(0001).
  1844     05  L4I PIC  X(0003).
  1845*    -------------------------------
  1846     05  TEXT4L PIC S9(0004) COMP.
  1847     05  TEXT4F PIC  X(0001).
  1848     05  FILLER REDEFINES TEXT4F.
  1849         10  TEXT4A PIC  X(0001).
  1850     05  TEXT4I PIC  X(0070).
  1851*    -------------------------------
  1852     05  CF4L PIC S9(0004) COMP.
  1853     05  CF4F PIC  X(0001).
  1854     05  FILLER REDEFINES CF4F.
  1855         10  CF4A PIC  X(0001).
  1856     05  CF4I PIC  X(0002).
  1857*    -------------------------------
  1858     05  SQ4L PIC S9(0004) COMP.
  1859     05  SQ4F PIC  X(0001).
  1860     05  FILLER REDEFINES SQ4F.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL104.cbl
  1861         10  SQ4A PIC  X(0001).
  1862     05  SQ4I PIC  X(0001).
  1863*    -------------------------------
  1864     05  L5L PIC S9(0004) COMP.
  1865     05  L5F PIC  X(0001).
  1866     05  FILLER REDEFINES L5F.
  1867         10  L5A PIC  X(0001).
  1868     05  L5I PIC  X(0003).
  1869*    -------------------------------
  1870     05  TEXT5L PIC S9(0004) COMP.
  1871     05  TEXT5F PIC  X(0001).
  1872     05  FILLER REDEFINES TEXT5F.
  1873         10  TEXT5A PIC  X(0001).
  1874     05  TEXT5I PIC  X(0070).
  1875*    -------------------------------
  1876     05  CF5L PIC S9(0004) COMP.
  1877     05  CF5F PIC  X(0001).
  1878     05  FILLER REDEFINES CF5F.
  1879         10  CF5A PIC  X(0001).
  1880     05  CF5I PIC  X(0002).
  1881*    -------------------------------
  1882     05  SQ5L PIC S9(0004) COMP.
  1883     05  SQ5F PIC  X(0001).
  1884     05  FILLER REDEFINES SQ5F.
  1885         10  SQ5A PIC  X(0001).
  1886     05  SQ5I PIC  X(0001).
  1887*    -------------------------------
  1888     05  L6L PIC S9(0004) COMP.
  1889     05  L6F PIC  X(0001).
  1890     05  FILLER REDEFINES L6F.
  1891         10  L6A PIC  X(0001).
  1892     05  L6I PIC  X(0003).
  1893*    -------------------------------
  1894     05  TEXT6L PIC S9(0004) COMP.
  1895     05  TEXT6F PIC  X(0001).
  1896     05  FILLER REDEFINES TEXT6F.
  1897         10  TEXT6A PIC  X(0001).
  1898     05  TEXT6I PIC  X(0070).
  1899*    -------------------------------
  1900     05  CF6L PIC S9(0004) COMP.
  1901     05  CF6F PIC  X(0001).
  1902     05  FILLER REDEFINES CF6F.
  1903         10  CF6A PIC  X(0001).
  1904     05  CF6I PIC  X(0002).
  1905*    -------------------------------
  1906     05  SQ6L PIC S9(0004) COMP.
  1907     05  SQ6F PIC  X(0001).
  1908     05  FILLER REDEFINES SQ6F.
  1909         10  SQ6A PIC  X(0001).
  1910     05  SQ6I PIC  X(0001).
  1911*    -------------------------------
  1912     05  L7L PIC S9(0004) COMP.
  1913     05  L7F PIC  X(0001).
  1914     05  FILLER REDEFINES L7F.
  1915         10  L7A PIC  X(0001).
  1916     05  L7I PIC  X(0003).
  1917*    -------------------------------
  1918     05  TEXT7L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL104.cbl
  1919     05  TEXT7F PIC  X(0001).
  1920     05  FILLER REDEFINES TEXT7F.
  1921         10  TEXT7A PIC  X(0001).
  1922     05  TEXT7I PIC  X(0070).
  1923*    -------------------------------
  1924     05  CF7L PIC S9(0004) COMP.
  1925     05  CF7F PIC  X(0001).
  1926     05  FILLER REDEFINES CF7F.
  1927         10  CF7A PIC  X(0001).
  1928     05  CF7I PIC  X(0002).
  1929*    -------------------------------
  1930     05  SQ7L PIC S9(0004) COMP.
  1931     05  SQ7F PIC  X(0001).
  1932     05  FILLER REDEFINES SQ7F.
  1933         10  SQ7A PIC  X(0001).
  1934     05  SQ7I PIC  X(0001).
  1935*    -------------------------------
  1936     05  L8L PIC S9(0004) COMP.
  1937     05  L8F PIC  X(0001).
  1938     05  FILLER REDEFINES L8F.
  1939         10  L8A PIC  X(0001).
  1940     05  L8I PIC  X(0003).
  1941*    -------------------------------
  1942     05  TEXT8L PIC S9(0004) COMP.
  1943     05  TEXT8F PIC  X(0001).
  1944     05  FILLER REDEFINES TEXT8F.
  1945         10  TEXT8A PIC  X(0001).
  1946     05  TEXT8I PIC  X(0070).
  1947*    -------------------------------
  1948     05  CF8L PIC S9(0004) COMP.
  1949     05  CF8F PIC  X(0001).
  1950     05  FILLER REDEFINES CF8F.
  1951         10  CF8A PIC  X(0001).
  1952     05  CF8I PIC  X(0002).
  1953*    -------------------------------
  1954     05  SQ8L PIC S9(0004) COMP.
  1955     05  SQ8F PIC  X(0001).
  1956     05  FILLER REDEFINES SQ8F.
  1957         10  SQ8A PIC  X(0001).
  1958     05  SQ8I PIC  X(0001).
  1959*    -------------------------------
  1960     05  L9L PIC S9(0004) COMP.
  1961     05  L9F PIC  X(0001).
  1962     05  FILLER REDEFINES L9F.
  1963         10  L9A PIC  X(0001).
  1964     05  L9I PIC  X(0003).
  1965*    -------------------------------
  1966     05  TEXT9L PIC S9(0004) COMP.
  1967     05  TEXT9F PIC  X(0001).
  1968     05  FILLER REDEFINES TEXT9F.
  1969         10  TEXT9A PIC  X(0001).
  1970     05  TEXT9I PIC  X(0070).
  1971*    -------------------------------
  1972     05  CF9L PIC S9(0004) COMP.
  1973     05  CF9F PIC  X(0001).
  1974     05  FILLER REDEFINES CF9F.
  1975         10  CF9A PIC  X(0001).
  1976     05  CF9I PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL104.cbl
  1977*    -------------------------------
  1978     05  SQ9L PIC S9(0004) COMP.
  1979     05  SQ9F PIC  X(0001).
  1980     05  FILLER REDEFINES SQ9F.
  1981         10  SQ9A PIC  X(0001).
  1982     05  SQ9I PIC  X(0001).
  1983*    -------------------------------
  1984     05  L10L PIC S9(0004) COMP.
  1985     05  L10F PIC  X(0001).
  1986     05  FILLER REDEFINES L10F.
  1987         10  L10A PIC  X(0001).
  1988     05  L10I PIC  X(0003).
  1989*    -------------------------------
  1990     05  TEXT10L PIC S9(0004) COMP.
  1991     05  TEXT10F PIC  X(0001).
  1992     05  FILLER REDEFINES TEXT10F.
  1993         10  TEXT10A PIC  X(0001).
  1994     05  TEXT10I PIC  X(0070).
  1995*    -------------------------------
  1996     05  CF10L PIC S9(0004) COMP.
  1997     05  CF10F PIC  X(0001).
  1998     05  FILLER REDEFINES CF10F.
  1999         10  CF10A PIC  X(0001).
  2000     05  CF10I PIC  X(0002).
  2001*    -------------------------------
  2002     05  SQ10L PIC S9(0004) COMP.
  2003     05  SQ10F PIC  X(0001).
  2004     05  FILLER REDEFINES SQ10F.
  2005         10  SQ10A PIC  X(0001).
  2006     05  SQ10I PIC  X(0001).
  2007*    -------------------------------
  2008     05  L11L PIC S9(0004) COMP.
  2009     05  L11F PIC  X(0001).
  2010     05  FILLER REDEFINES L11F.
  2011         10  L11A PIC  X(0001).
  2012     05  L11I PIC  X(0003).
  2013*    -------------------------------
  2014     05  TEXT11L PIC S9(0004) COMP.
  2015     05  TEXT11F PIC  X(0001).
  2016     05  FILLER REDEFINES TEXT11F.
  2017         10  TEXT11A PIC  X(0001).
  2018     05  TEXT11I PIC  X(0070).
  2019*    -------------------------------
  2020     05  CF11L PIC S9(0004) COMP.
  2021     05  CF11F PIC  X(0001).
  2022     05  FILLER REDEFINES CF11F.
  2023         10  CF11A PIC  X(0001).
  2024     05  CF11I PIC  X(0002).
  2025*    -------------------------------
  2026     05  SQ11L PIC S9(0004) COMP.
  2027     05  SQ11F PIC  X(0001).
  2028     05  FILLER REDEFINES SQ11F.
  2029         10  SQ11A PIC  X(0001).
  2030     05  SQ11I PIC  X(0001).
  2031*    -------------------------------
  2032     05  L12L PIC S9(0004) COMP.
  2033     05  L12F PIC  X(0001).
  2034     05  FILLER REDEFINES L12F.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL104.cbl
  2035         10  L12A PIC  X(0001).
  2036     05  L12I PIC  X(0003).
  2037*    -------------------------------
  2038     05  TEXT12L PIC S9(0004) COMP.
  2039     05  TEXT12F PIC  X(0001).
  2040     05  FILLER REDEFINES TEXT12F.
  2041         10  TEXT12A PIC  X(0001).
  2042     05  TEXT12I PIC  X(0070).
  2043*    -------------------------------
  2044     05  CF12L PIC S9(0004) COMP.
  2045     05  CF12F PIC  X(0001).
  2046     05  FILLER REDEFINES CF12F.
  2047         10  CF12A PIC  X(0001).
  2048     05  CF12I PIC  X(0002).
  2049*    -------------------------------
  2050     05  SQ12L PIC S9(0004) COMP.
  2051     05  SQ12F PIC  X(0001).
  2052     05  FILLER REDEFINES SQ12F.
  2053         10  SQ12A PIC  X(0001).
  2054     05  SQ12I PIC  X(0001).
  2055*    -------------------------------
  2056     05  L13L PIC S9(0004) COMP.
  2057     05  L13F PIC  X(0001).
  2058     05  FILLER REDEFINES L13F.
  2059         10  L13A PIC  X(0001).
  2060     05  L13I PIC  X(0003).
  2061*    -------------------------------
  2062     05  TEXT13L PIC S9(0004) COMP.
  2063     05  TEXT13F PIC  X(0001).
  2064     05  FILLER REDEFINES TEXT13F.
  2065         10  TEXT13A PIC  X(0001).
  2066     05  TEXT13I PIC  X(0070).
  2067*    -------------------------------
  2068     05  CF13L PIC S9(0004) COMP.
  2069     05  CF13F PIC  X(0001).
  2070     05  FILLER REDEFINES CF13F.
  2071         10  CF13A PIC  X(0001).
  2072     05  CF13I PIC  X(0002).
  2073*    -------------------------------
  2074     05  SQ13L PIC S9(0004) COMP.
  2075     05  SQ13F PIC  X(0001).
  2076     05  FILLER REDEFINES SQ13F.
  2077         10  SQ13A PIC  X(0001).
  2078     05  SQ13I PIC  X(0001).
  2079*    -------------------------------
  2080     05  L14L PIC S9(0004) COMP.
  2081     05  L14F PIC  X(0001).
  2082     05  FILLER REDEFINES L14F.
  2083         10  L14A PIC  X(0001).
  2084     05  L14I PIC  X(0003).
  2085*    -------------------------------
  2086     05  TEXT14L PIC S9(0004) COMP.
  2087     05  TEXT14F PIC  X(0001).
  2088     05  FILLER REDEFINES TEXT14F.
  2089         10  TEXT14A PIC  X(0001).
  2090     05  TEXT14I PIC  X(0070).
  2091*    -------------------------------
  2092     05  CF14L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL104.cbl
  2093     05  CF14F PIC  X(0001).
  2094     05  FILLER REDEFINES CF14F.
  2095         10  CF14A PIC  X(0001).
  2096     05  CF14I PIC  X(0002).
  2097*    -------------------------------
  2098     05  SQ14L PIC S9(0004) COMP.
  2099     05  SQ14F PIC  X(0001).
  2100     05  FILLER REDEFINES SQ14F.
  2101         10  SQ14A PIC  X(0001).
  2102     05  SQ14I PIC  X(0001).
  2103*    -------------------------------
  2104     05  L15L PIC S9(0004) COMP.
  2105     05  L15F PIC  X(0001).
  2106     05  FILLER REDEFINES L15F.
  2107         10  L15A PIC  X(0001).
  2108     05  L15I PIC  X(0003).
  2109*    -------------------------------
  2110     05  TEXT15L PIC S9(0004) COMP.
  2111     05  TEXT15F PIC  X(0001).
  2112     05  FILLER REDEFINES TEXT15F.
  2113         10  TEXT15A PIC  X(0001).
  2114     05  TEXT15I PIC  X(0070).
  2115*    -------------------------------
  2116     05  CF15L PIC S9(0004) COMP.
  2117     05  CF15F PIC  X(0001).
  2118     05  FILLER REDEFINES CF15F.
  2119         10  CF15A PIC  X(0001).
  2120     05  CF15I PIC  X(0002).
  2121*    -------------------------------
  2122     05  SQ15L PIC S9(0004) COMP.
  2123     05  SQ15F PIC  X(0001).
  2124     05  FILLER REDEFINES SQ15F.
  2125         10  SQ15A PIC  X(0001).
  2126     05  SQ15I PIC  X(0001).
  2127*    -------------------------------
  2128     05  ERRMSGBL PIC S9(0004) COMP.
  2129     05  ERRMSGBF PIC  X(0001).
  2130     05  FILLER REDEFINES ERRMSGBF.
  2131         10  ERRMSGBA PIC  X(0001).
  2132     05  ERRMSGBI PIC  X(0072).
  2133*    -------------------------------
  2134     05  FUNCTL PIC S9(0004) COMP.
  2135     05  FUNCTF PIC  X(0001).
  2136     05  FILLER REDEFINES FUNCTF.
  2137         10  FUNCTA PIC  X(0001).
  2138     05  FUNCTI PIC  X(0001).
  2139*    -------------------------------
  2140     05  LINE1L PIC S9(0004) COMP.
  2141     05  LINE1F PIC  X(0001).
  2142     05  FILLER REDEFINES LINE1F.
  2143         10  LINE1A PIC  X(0001).
  2144     05  LINE1I PIC  999.
  2145*    -------------------------------
  2146     05  LINE2L PIC S9(0004) COMP.
  2147     05  LINE2F PIC  X(0001).
  2148     05  FILLER REDEFINES LINE2F.
  2149         10  LINE2A PIC  X(0001).
  2150     05  LINE2I PIC  999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL104.cbl
  2151*    -------------------------------
  2152     05  PFENTRBL PIC S9(0004) COMP.
  2153     05  PFENTRBF PIC  X(0001).
  2154     05  FILLER REDEFINES PFENTRBF.
  2155         10  PFENTRBA PIC  X(0001).
  2156     05  PFENTRBI PIC  99.
  2157*    -------------------------------
  2158     05  MNTBYL PIC S9(0004) COMP.
  2159     05  MNTBYF PIC  X(0001).
  2160     05  FILLER REDEFINES MNTBYF.
  2161         10  MNTBYA PIC  X(0001).
  2162     05  MNTBYI PIC  X(0004).
  2163*    -------------------------------
  2164     05  MNTONL PIC S9(0004) COMP.
  2165     05  MNTONF PIC  X(0001).
  2166     05  FILLER REDEFINES MNTONF.
  2167         10  MNTONA PIC  X(0001).
  2168     05  MNTONI PIC  X(0008).
  2169 01  EL104BO REDEFINES EL104BFI.
  2170     05  FILLER            PIC  X(0012).
  2171*    -------------------------------
  2172     05  FILLER            PIC  X(0003).
  2173     05  DATEBO PIC  X(0008).
  2174*    -------------------------------
  2175     05  FILLER            PIC  X(0003).
  2176     05  TIMEBO PIC  99.99.
  2177*    -------------------------------
  2178     05  FILLER            PIC  X(0003).
  2179     05  COMPANYO PIC  X(0003).
  2180*    -------------------------------
  2181     05  FILLER            PIC  X(0003).
  2182     05  TEXTTPBO PIC  X(0008).
  2183*    -------------------------------
  2184     05  FILLER            PIC  X(0003).
  2185     05  CONTRLBO PIC  X(0012).
  2186*    -------------------------------
  2187     05  FILLER            PIC  X(0003).
  2188     05  ARCHTBO PIC  X(0009).
  2189*    -------------------------------
  2190     05  FILLER            PIC  X(0003).
  2191     05  ARCHBO PIC  X(0001).
  2192*    -------------------------------
  2193     05  FILLER            PIC  X(0003).
  2194     05  FORMSTBO PIC  X(0012).
  2195*    -------------------------------
  2196     05  FILLER            PIC  X(0003).
  2197     05  FORMSQBO PIC  X(0001).
  2198*    -------------------------------
  2199     05  FILLER            PIC  X(0003).
  2200     05  TOTO PIC  X(0003).
  2201*    -------------------------------
  2202     05  FILLER            PIC  X(0003).
  2203     05  LINESQTO PIC  X(0001).
  2204*    -------------------------------
  2205     05  FILLER            PIC  X(0003).
  2206     05  L1O PIC  X(0003).
  2207*    -------------------------------
  2208     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL104.cbl
  2209     05  TEXT1O PIC  X(0070).
  2210*    -------------------------------
  2211     05  FILLER            PIC  X(0003).
  2212     05  CF1O PIC  X(0002).
  2213*    -------------------------------
  2214     05  FILLER            PIC  X(0003).
  2215     05  SQ1O PIC  X(0001).
  2216*    -------------------------------
  2217     05  FILLER            PIC  X(0003).
  2218     05  L2O PIC  X(0003).
  2219*    -------------------------------
  2220     05  FILLER            PIC  X(0003).
  2221     05  TEXT2O PIC  X(0070).
  2222*    -------------------------------
  2223     05  FILLER            PIC  X(0003).
  2224     05  CF2O PIC  X(0002).
  2225*    -------------------------------
  2226     05  FILLER            PIC  X(0003).
  2227     05  SQ2O PIC  X(0001).
  2228*    -------------------------------
  2229     05  FILLER            PIC  X(0003).
  2230     05  L3O PIC  X(0003).
  2231*    -------------------------------
  2232     05  FILLER            PIC  X(0003).
  2233     05  TEXT3O PIC  X(0070).
  2234*    -------------------------------
  2235     05  FILLER            PIC  X(0003).
  2236     05  CF3O PIC  X(0002).
  2237*    -------------------------------
  2238     05  FILLER            PIC  X(0003).
  2239     05  SQ3O PIC  X(0001).
  2240*    -------------------------------
  2241     05  FILLER            PIC  X(0003).
  2242     05  L4O PIC  X(0003).
  2243*    -------------------------------
  2244     05  FILLER            PIC  X(0003).
  2245     05  TEXT4O PIC  X(0070).
  2246*    -------------------------------
  2247     05  FILLER            PIC  X(0003).
  2248     05  CF4O PIC  X(0002).
  2249*    -------------------------------
  2250     05  FILLER            PIC  X(0003).
  2251     05  SQ4O PIC  X(0001).
  2252*    -------------------------------
  2253     05  FILLER            PIC  X(0003).
  2254     05  L5O PIC  X(0003).
  2255*    -------------------------------
  2256     05  FILLER            PIC  X(0003).
  2257     05  TEXT5O PIC  X(0070).
  2258*    -------------------------------
  2259     05  FILLER            PIC  X(0003).
  2260     05  CF5O PIC  X(0002).
  2261*    -------------------------------
  2262     05  FILLER            PIC  X(0003).
  2263     05  SQ5O PIC  X(0001).
  2264*    -------------------------------
  2265     05  FILLER            PIC  X(0003).
  2266     05  L6O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL104.cbl
  2267*    -------------------------------
  2268     05  FILLER            PIC  X(0003).
  2269     05  TEXT6O PIC  X(0070).
  2270*    -------------------------------
  2271     05  FILLER            PIC  X(0003).
  2272     05  CF6O PIC  X(0002).
  2273*    -------------------------------
  2274     05  FILLER            PIC  X(0003).
  2275     05  SQ6O PIC  X(0001).
  2276*    -------------------------------
  2277     05  FILLER            PIC  X(0003).
  2278     05  L7O PIC  X(0003).
  2279*    -------------------------------
  2280     05  FILLER            PIC  X(0003).
  2281     05  TEXT7O PIC  X(0070).
  2282*    -------------------------------
  2283     05  FILLER            PIC  X(0003).
  2284     05  CF7O PIC  X(0002).
  2285*    -------------------------------
  2286     05  FILLER            PIC  X(0003).
  2287     05  SQ7O PIC  X(0001).
  2288*    -------------------------------
  2289     05  FILLER            PIC  X(0003).
  2290     05  L8O PIC  X(0003).
  2291*    -------------------------------
  2292     05  FILLER            PIC  X(0003).
  2293     05  TEXT8O PIC  X(0070).
  2294*    -------------------------------
  2295     05  FILLER            PIC  X(0003).
  2296     05  CF8O PIC  X(0002).
  2297*    -------------------------------
  2298     05  FILLER            PIC  X(0003).
  2299     05  SQ8O PIC  X(0001).
  2300*    -------------------------------
  2301     05  FILLER            PIC  X(0003).
  2302     05  L9O PIC  X(0003).
  2303*    -------------------------------
  2304     05  FILLER            PIC  X(0003).
  2305     05  TEXT9O PIC  X(0070).
  2306*    -------------------------------
  2307     05  FILLER            PIC  X(0003).
  2308     05  CF9O PIC  X(0002).
  2309*    -------------------------------
  2310     05  FILLER            PIC  X(0003).
  2311     05  SQ9O PIC  X(0001).
  2312*    -------------------------------
  2313     05  FILLER            PIC  X(0003).
  2314     05  L10O PIC  X(0003).
  2315*    -------------------------------
  2316     05  FILLER            PIC  X(0003).
  2317     05  TEXT10O PIC  X(0070).
  2318*    -------------------------------
  2319     05  FILLER            PIC  X(0003).
  2320     05  CF10O PIC  X(0002).
  2321*    -------------------------------
  2322     05  FILLER            PIC  X(0003).
  2323     05  SQ10O PIC  X(0001).
  2324*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL104.cbl
  2325     05  FILLER            PIC  X(0003).
  2326     05  L11O PIC  X(0003).
  2327*    -------------------------------
  2328     05  FILLER            PIC  X(0003).
  2329     05  TEXT11O PIC  X(0070).
  2330*    -------------------------------
  2331     05  FILLER            PIC  X(0003).
  2332     05  CF11O PIC  X(0002).
  2333*    -------------------------------
  2334     05  FILLER            PIC  X(0003).
  2335     05  SQ11O PIC  X(0001).
  2336*    -------------------------------
  2337     05  FILLER            PIC  X(0003).
  2338     05  L12O PIC  X(0003).
  2339*    -------------------------------
  2340     05  FILLER            PIC  X(0003).
  2341     05  TEXT12O PIC  X(0070).
  2342*    -------------------------------
  2343     05  FILLER            PIC  X(0003).
  2344     05  CF12O PIC  X(0002).
  2345*    -------------------------------
  2346     05  FILLER            PIC  X(0003).
  2347     05  SQ12O PIC  X(0001).
  2348*    -------------------------------
  2349     05  FILLER            PIC  X(0003).
  2350     05  L13O PIC  X(0003).
  2351*    -------------------------------
  2352     05  FILLER            PIC  X(0003).
  2353     05  TEXT13O PIC  X(0070).
  2354*    -------------------------------
  2355     05  FILLER            PIC  X(0003).
  2356     05  CF13O PIC  X(0002).
  2357*    -------------------------------
  2358     05  FILLER            PIC  X(0003).
  2359     05  SQ13O PIC  X(0001).
  2360*    -------------------------------
  2361     05  FILLER            PIC  X(0003).
  2362     05  L14O PIC  X(0003).
  2363*    -------------------------------
  2364     05  FILLER            PIC  X(0003).
  2365     05  TEXT14O PIC  X(0070).
  2366*    -------------------------------
  2367     05  FILLER            PIC  X(0003).
  2368     05  CF14O PIC  X(0002).
  2369*    -------------------------------
  2370     05  FILLER            PIC  X(0003).
  2371     05  SQ14O PIC  X(0001).
  2372*    -------------------------------
  2373     05  FILLER            PIC  X(0003).
  2374     05  L15O PIC  X(0003).
  2375*    -------------------------------
  2376     05  FILLER            PIC  X(0003).
  2377     05  TEXT15O PIC  X(0070).
  2378*    -------------------------------
  2379     05  FILLER            PIC  X(0003).
  2380     05  CF15O PIC  X(0002).
  2381*    -------------------------------
  2382     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL104.cbl
  2383     05  SQ15O PIC  X(0001).
  2384*    -------------------------------
  2385     05  FILLER            PIC  X(0003).
  2386     05  ERRMSGBO PIC  X(0072).
  2387*    -------------------------------
  2388     05  FILLER            PIC  X(0003).
  2389     05  FUNCTO PIC  X(0001).
  2390*    -------------------------------
  2391     05  FILLER            PIC  X(0003).
  2392     05  LINE1O PIC  X(0003).
  2393*    -------------------------------
  2394     05  FILLER            PIC  X(0003).
  2395     05  LINE2O PIC  X(0003).
  2396*    -------------------------------
  2397     05  FILLER            PIC  X(0003).
  2398     05  PFENTRBO PIC  X(0002).
  2399*    -------------------------------
  2400     05  FILLER            PIC  X(0003).
  2401     05  MNTBYO PIC  X(0004).
  2402*    -------------------------------
  2403     05  FILLER            PIC  X(0003).
  2404     05  MNTONO PIC  X(0008).
  2405*    -------------------------------
  2406 01  EL104AI REDEFINES EL104BFI.
  2407     05  FILLER            PIC  X(0012).
  2408*    -------------------------------
  2409     05  DATEL PIC S9(0004) COMP.
  2410     05  DATEF PIC  X(0001).
  2411     05  FILLER REDEFINES DATEF.
  2412         10  DATEA PIC  X(0001).
  2413     05  DATEI PIC  X(0008).
  2414*    -------------------------------
  2415     05  TIMEL PIC S9(0004) COMP.
  2416     05  TIMEF PIC  X(0001).
  2417     05  FILLER REDEFINES TIMEF.
  2418         10  TIMEA PIC  X(0001).
  2419     05  TIMEI PIC  X(0005).
  2420*    -------------------------------
  2421     05  COMPAL PIC S9(0004) COMP.
  2422     05  COMPAF PIC  X(0001).
  2423     05  FILLER REDEFINES COMPAF.
  2424         10  COMPAA PIC  X(0001).
  2425     05  COMPAI PIC  X(0003).
  2426*    -------------------------------
  2427     05  MAINTL PIC S9(0004) COMP.
  2428     05  MAINTF PIC  X(0001).
  2429     05  FILLER REDEFINES MAINTF.
  2430         10  MAINTA PIC  X(0001).
  2431     05  MAINTI PIC  X(0001).
  2432*    -------------------------------
  2433     05  TRANSFML PIC S9(0004) COMP.
  2434     05  TRANSFMF PIC  X(0001).
  2435     05  FILLER REDEFINES TRANSFMF.
  2436         10  TRANSFMA PIC  X(0001).
  2437     05  TRANSFMI PIC  X(0014).
  2438*    -------------------------------
  2439     05  FILETYPL PIC S9(0004) COMP.
  2440     05  FILETYPF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL104.cbl
  2441     05  FILLER REDEFINES FILETYPF.
  2442         10  FILETYPA PIC  X(0001).
  2443     05  FILETYPI PIC  X(0001).
  2444*    -------------------------------
  2445     05  CONTROLL PIC S9(0004) COMP.
  2446     05  CONTROLF PIC  X(0001).
  2447     05  FILLER REDEFINES CONTROLF.
  2448         10  CONTROLA PIC  X(0001).
  2449     05  CONTROLI PIC  X(0012).
  2450*    -------------------------------
  2451     05  NEWCONTL PIC S9(0004) COMP.
  2452     05  NEWCONTF PIC  X(0001).
  2453     05  FILLER REDEFINES NEWCONTF.
  2454         10  NEWCONTA PIC  X(0001).
  2455     05  NEWCONTI PIC  X(0012).
  2456*    -------------------------------
  2457     05  ERRMSG1L PIC S9(0004) COMP.
  2458     05  ERRMSG1F PIC  X(0001).
  2459     05  FILLER REDEFINES ERRMSG1F.
  2460         10  ERRMSG1A PIC  X(0001).
  2461     05  ERRMSG1I PIC  X(0079).
  2462*    -------------------------------
  2463     05  ERRMSG2L PIC S9(0004) COMP.
  2464     05  ERRMSG2F PIC  X(0001).
  2465     05  FILLER REDEFINES ERRMSG2F.
  2466         10  ERRMSG2A PIC  X(0001).
  2467     05  ERRMSG2I PIC  X(0079).
  2468*    -------------------------------
  2469     05  PFENTERL PIC S9(0004) COMP.
  2470     05  PFENTERF PIC  X(0001).
  2471     05  FILLER REDEFINES PFENTERF.
  2472         10  PFENTERA PIC  X(0001).
  2473     05  PFENTERI PIC  99.
  2474*    -------------------------------
  2475     05  HDNPFAL PIC S9(0004) COMP.
  2476     05  HDNPFAF PIC  X(0001).
  2477     05  FILLER REDEFINES HDNPFAF.
  2478         10  HDNPFAA PIC  X(0001).
  2479     05  HDNPFAI PIC  X(0019).
  2480 01  EL104AO REDEFINES EL104BFI.
  2481     05  FILLER            PIC  X(0012).
  2482*    -------------------------------
  2483     05  FILLER            PIC  X(0003).
  2484     05  DATEO PIC  X(0008).
  2485*    -------------------------------
  2486     05  FILLER            PIC  X(0003).
  2487     05  TIMEO PIC  99.99.
  2488*    -------------------------------
  2489     05  FILLER            PIC  X(0003).
  2490     05  COMPAO PIC  X(0003).
  2491*    -------------------------------
  2492     05  FILLER            PIC  X(0003).
  2493     05  MAINTO PIC  X(0001).
  2494*    -------------------------------
  2495     05  FILLER            PIC  X(0003).
  2496     05  TRANSFMO PIC  X(0014).
  2497*    -------------------------------
  2498     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL104.cbl
  2499     05  FILETYPO PIC  X(0001).
  2500*    -------------------------------
  2501     05  FILLER            PIC  X(0003).
  2502     05  CONTROLO PIC  X(0012).
  2503*    -------------------------------
  2504     05  FILLER            PIC  X(0003).
  2505     05  NEWCONTO PIC  X(0012).
  2506*    -------------------------------
  2507     05  FILLER            PIC  X(0003).
  2508     05  ERRMSG1O PIC  X(0079).
  2509*    -------------------------------
  2510     05  FILLER            PIC  X(0003).
  2511     05  ERRMSG2O PIC  X(0079).
  2512*    -------------------------------
  2513     05  FILLER            PIC  X(0003).
  2514     05  PFENTERO PIC  X(0002).
  2515*    -------------------------------
  2516     05  FILLER            PIC  X(0003).
  2517     05  HDNPFAO PIC  X(0019).
  2518*    -------------------------------
  2519 01  EL104AFI REDEFINES EL104BFI.
  2520     05  FILLER            PIC  X(0012).
  2521*    -------------------------------
  2522     05  DATEAFL PIC S9(0004) COMP.
  2523     05  DATEAFF PIC  X(0001).
  2524     05  FILLER REDEFINES DATEAFF.
  2525         10  DATEAFA PIC  X(0001).
  2526     05  DATEAFI PIC  X(0008).
  2527*    -------------------------------
  2528     05  TIMEAFL PIC S9(0004) COMP.
  2529     05  TIMEAFF PIC  X(0001).
  2530     05  FILLER REDEFINES TIMEAFF.
  2531         10  TIMEAFA PIC  X(0001).
  2532     05  TIMEAFI PIC  X(0005).
  2533*    -------------------------------
  2534     05  COMPAFL PIC S9(0004) COMP.
  2535     05  COMPAFF PIC  X(0001).
  2536     05  FILLER REDEFINES COMPAFF.
  2537         10  COMPAFA PIC  X(0001).
  2538     05  COMPAFI PIC  X(0003).
  2539*    -------------------------------
  2540     05  MAINTFL PIC S9(0004) COMP.
  2541     05  MAINTFF PIC  X(0001).
  2542     05  FILLER REDEFINES MAINTFF.
  2543         10  MAINTFA PIC  X(0001).
  2544     05  MAINTFI PIC  X(0001).
  2545*    -------------------------------
  2546     05  TRNSFMFL PIC S9(0004) COMP.
  2547     05  TRNSFMFF PIC  X(0001).
  2548     05  FILLER REDEFINES TRNSFMFF.
  2549         10  TRNSFMFA PIC  X(0001).
  2550     05  TRNSFMFI PIC  X(0014).
  2551*    -------------------------------
  2552     05  FILETPFL PIC S9(0004) COMP.
  2553     05  FILETPFF PIC  X(0001).
  2554     05  FILLER REDEFINES FILETPFF.
  2555         10  FILETPFA PIC  X(0001).
  2556     05  FILETPFI PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL104.cbl
  2557*    -------------------------------
  2558     05  CONTRLFL PIC S9(0004) COMP.
  2559     05  CONTRLFF PIC  X(0001).
  2560     05  FILLER REDEFINES CONTRLFF.
  2561         10  CONTRLFA PIC  X(0001).
  2562     05  CONTRLFI PIC  X(0012).
  2563*    -------------------------------
  2564     05  NEWCNTFL PIC S9(0004) COMP.
  2565     05  NEWCNTFF PIC  X(0001).
  2566     05  FILLER REDEFINES NEWCNTFF.
  2567         10  NEWCNTFA PIC  X(0001).
  2568     05  NEWCNTFI PIC  X(0012).
  2569*    -------------------------------
  2570     05  ERMSG1FL PIC S9(0004) COMP.
  2571     05  ERMSG1FF PIC  X(0001).
  2572     05  FILLER REDEFINES ERMSG1FF.
  2573         10  ERMSG1FA PIC  X(0001).
  2574     05  ERMSG1FI PIC  X(0079).
  2575*    -------------------------------
  2576     05  ERMSG2FL PIC S9(0004) COMP.
  2577     05  ERMSG2FF PIC  X(0001).
  2578     05  FILLER REDEFINES ERMSG2FF.
  2579         10  ERMSG2FA PIC  X(0001).
  2580     05  ERMSG2FI PIC  X(0079).
  2581*    -------------------------------
  2582     05  PFENTFL PIC S9(0004) COMP.
  2583     05  PFENTFF PIC  X(0001).
  2584     05  FILLER REDEFINES PFENTFF.
  2585         10  PFENTFA PIC  X(0001).
  2586     05  PFENTFI PIC  99.
  2587*    -------------------------------
  2588     05  HDNPFAFL PIC S9(0004) COMP.
  2589     05  HDNPFAFF PIC  X(0001).
  2590     05  FILLER REDEFINES HDNPFAFF.
  2591         10  HDNPFAFA PIC  X(0001).
  2592     05  HDNPFAFI PIC  X(0022).
  2593 01  EL104AFO REDEFINES EL104BFI.
  2594     05  FILLER            PIC  X(0012).
  2595*    -------------------------------
  2596     05  FILLER            PIC  X(0003).
  2597     05  DATEAFO PIC  X(0008).
  2598*    -------------------------------
  2599     05  FILLER            PIC  X(0003).
  2600     05  TIMEAFO PIC  99.99.
  2601*    -------------------------------
  2602     05  FILLER            PIC  X(0003).
  2603     05  COMPAFO PIC  X(0003).
  2604*    -------------------------------
  2605     05  FILLER            PIC  X(0003).
  2606     05  MAINTFO PIC  X(0001).
  2607*    -------------------------------
  2608     05  FILLER            PIC  X(0003).
  2609     05  TRNSFMFO PIC  X(0014).
  2610*    -------------------------------
  2611     05  FILLER            PIC  X(0003).
  2612     05  FILETPFO PIC  X(0001).
  2613*    -------------------------------
  2614     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL104.cbl
  2615     05  CONTRLFO PIC  X(0012).
  2616*    -------------------------------
  2617     05  FILLER            PIC  X(0003).
  2618     05  NEWCNTFO PIC  X(0012).
  2619*    -------------------------------
  2620     05  FILLER            PIC  X(0003).
  2621     05  ERMSG1FO PIC  X(0079).
  2622*    -------------------------------
  2623     05  FILLER            PIC  X(0003).
  2624     05  ERMSG2FO PIC  X(0079).
  2625*    -------------------------------
  2626     05  FILLER            PIC  X(0003).
  2627     05  PFENTFO PIC  X(0002).
  2628*    -------------------------------
  2629     05  FILLER            PIC  X(0003).
  2630     05  HDNPFAFO PIC  X(0022).
  2631*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL104.cbl
  2633****************************************************************
  2634*
  2635* Copyright (c) 2007 by Clerity Solutions, Inc.
  2636* All rights reserved.
  2637*
  2638****************************************************************
  2639 01  DFHEIV.
  2640   02  DFHEIV0               PIC X(35).
  2641   02  DFHEIV1               PIC X(08).
  2642   02  DFHEIV2               PIC X(08).
  2643   02  DFHEIV3               PIC X(08).
  2644   02  DFHEIV4               PIC X(06).
  2645   02  DFHEIV5               PIC X(04).
  2646   02  DFHEIV6               PIC X(04).
  2647   02  DFHEIV7               PIC X(02).
  2648   02  DFHEIV8               PIC X(02).
  2649   02  DFHEIV9               PIC X(01).
  2650   02  DFHEIV10              PIC S9(7) COMP-3.
  2651   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2652   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2653   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2654   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2655   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2656   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2657   02  DFHEIV17              PIC X(04).
  2658   02  DFHEIV18              PIC X(04).
  2659   02  DFHEIV19              PIC X(04).
  2660   02  DFHEIV20              USAGE IS POINTER.
  2661   02  DFHEIV21              USAGE IS POINTER.
  2662   02  DFHEIV22              USAGE IS POINTER.
  2663   02  DFHEIV23              USAGE IS POINTER.
  2664   02  DFHEIV24              USAGE IS POINTER.
  2665   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2666   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2667   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2668   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2669   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2670   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2671   02  FILLER                PIC X(02).
  2672   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2673   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2674   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2675   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2676   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2677 LINKAGE  SECTION.
  2678*****************************************************************
  2679*                                                               *
  2680* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2681* All rights reserved.                                          *
  2682*                                                               *
  2683*****************************************************************
  2684 01  dfheiblk.
  2685     02  eibtime          pic s9(7) comp-3.
  2686     02  eibdate          pic s9(7) comp-3.
  2687     02  eibtrnid         pic x(4).
  2688     02  eibtaskn         pic s9(7) comp-3.
  2689     02  eibtrmid         pic x(4).
  2690     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL104.cbl
  2691     02  eibcposn         pic s9(4) comp.
  2692     02  eibcalen         pic s9(4) comp.
  2693     02  eibaid           pic x(1).
  2694     02  eibfiller1       pic x(1).
  2695     02  eibfn            pic x(2).
  2696     02  eibfiller2       pic x(2).
  2697     02  eibrcode         pic x(6).
  2698     02  eibfiller3       pic x(2).
  2699     02  eibds            pic x(8).
  2700     02  eibreqid         pic x(8).
  2701     02  eibrsrce         pic x(8).
  2702     02  eibsync          pic x(1).
  2703     02  eibfree          pic x(1).
  2704     02  eibrecv          pic x(1).
  2705     02  eibsend          pic x(1).
  2706     02  eibatt           pic x(1).
  2707     02  eibeoc           pic x(1).
  2708     02  eibfmh           pic x(1).
  2709     02  eibcompl         pic x(1).
  2710     02  eibsig           pic x(1).
  2711     02  eibconf          pic x(1).
  2712     02  eiberr           pic x(1).
  2713     02  eibrldbk         pic x(1).
  2714     02  eiberrcd         pic x(4).
  2715     02  eibsynrb         pic x(1).
  2716     02  eibnodat         pic x(1).
  2717     02  eibfiller5       pic x(2).
  2718     02  eibresp          pic 9(09) comp.
  2719     02  eibresp2         pic 9(09) comp.
  2720     02  dfheigdj         pic s9(4) comp.
  2721     02  dfheigdk         pic s9(4) comp.
  2722 01  DFHCOMMAREA                 PIC X(1024).
  2723*01 PARMLIST .
  2724*    12  FILLER                  PIC S9(8)  COMP.
  2725*    12  TXT-ADDR                PIC S9(8)  COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL104.cbl
  2727*    COPY ELCTEXT.
  2728******************************************************************
  2729*                                                                *
  2730*                                                                *
  2731*                            ELCTEXT.                            *
  2732*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2733*                            VMOD=2.008                          *
  2734*                                                                *
  2735*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  2736*                                     FORM LETTERS,              *
  2737*                                     CERT FORM DISPLAY.
  2738*                                                                *
  2739*   FILE TYPE = VSAM,KSDS                                        *
  2740*   RECORD SIZE = 100   RECFORM = FIXED                          *
  2741*                                                                *
  2742*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  2743*       ALTERNATE INDEX = NONE                                   *
  2744*                                                                *
  2745*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  2746*       ALTERNATE INDEX = NONE                                   *
  2747*                                                                *
  2748*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  2749*       ALTERNATE INDEX = NONE                                   *
  2750*                                                                *
  2751*   LOG = NO                                                     *
  2752*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2753******************************************************************
  2754 01  TEXT-FILES.
  2755     12  TEXT-FILE-ID                PIC XX.
  2756         88  FORMS-FILE-TEXT            VALUE 'TF'.
  2757         88  LETTER-FILE-TEXT           VALUE 'TL'.
  2758         88  HELP-FILE-TEXT             VALUE 'TH'.
  2759
  2760     12  TX-CONTROL-PRIMARY.
  2761         16  TX-COMPANY-CD           PIC X.
  2762             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  2763         16  TX-ACCESS-CD-GENL       PIC X(12).
  2764
  2765         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2766             20  TX-LETTER-NO        PIC X(4).
  2767             20  FILLER              PIC X(8).
  2768
  2769         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2770             20  TX-FORM-NO          PIC X(12).
  2771
  2772         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2773             20  TX-HELP-TYPE        PIC X.
  2774                 88  HELP-FOR-GENERAL   VALUE ' '.
  2775                 88  HELP-BY-SCREEN     VALUE 'S'.
  2776                 88  HELP-BY-ERROR      VALUE 'E'.
  2777             20  TX-SCREEN-OR-ERROR  PIC X(4).
  2778                 88  GENERAL-INFO-HELP  VALUE '0000'.
  2779             20  TX-HELP-FOR-COMPANY  PIC XXX.
  2780                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  2781             20  FILLER              PIC X(4).
  2782
  2783         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  2784
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL104.cbl
  2785     12  TX-PROCESS-CONTROL          PIC XX.
  2786         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  2787
  2788     12  TX-TEXT-LINE                PIC X(70).
  2789
  2790     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  2791         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  2792         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  2793         88  TX-VALID-FORM-SQUEEZE-VALUE
  2794                                        VALUE 'Y' ' '.
  2795
  2796     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  2797         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  2798         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  2799         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  2800         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  2801         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  2802         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  2803         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  2804                                              'K' 'N' ' '
  2805                                              'Z'.
  2806
  2807     12  TX-ARCHIVE-SW               PIC X.
  2808         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  2809         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  2810         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  2811
  2812     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  2813     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  2814
  2815     12  TX-BSR-CODE                 PIC X.
  2816         88  TX-BSR-LETTER              VALUE 'B'.
  2817         88  TX-NON-BSR-LETTER          VALUE ' '.
  2818
  2819     12  FILLER                      PIC X.
  2820*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL104.cbl
  2822 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA TEXT-FILES.
  2823 0000-DFHEXIT SECTION.
  2824     MOVE '9#                    $   ' TO DFHEIV0.
  2825     MOVE 'EL104' TO DFHEIV1.
  2826     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2827
  2828     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  2829
  2830     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  2831     MOVE '5'                   TO DC-OPTION-CODE.
  2832     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2833     MOVE DC-GREG-DATE-1-EDIT   TO SAVE-DATE.
  2834     MOVE DC-BIN-DATE-1         TO SAVE-BIN-DATE.
  2835
  2836     MOVE 2 TO EMI-NUMBER-OF-LINES.
  2837
  2838     IF  PI-LANGUAGE-IS-FR
  2839         MOVE 'EL104AF'         TO MAP-NAME.
  2840
  2841     IF EIBCALEN = ZEROS
  2842         GO TO 8800-UNAUTHORIZED-ACCESS.
  2843
  2844     IF  PI-CALLING-PROGRAM NOT = THIS-PGM
  2845         IF  PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2846             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  2847             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2848             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2849             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2850             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2851             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2852             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2853             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  2854             MOVE LOW-VALUES           TO EL104AI
  2855             MOVE 'N'                  TO PI-104-SCREEN-SENT-IND
  2856
  2857             IF  PI-104-SCREEN-BYPASS
  2858                     NOT EQUAL LOW-VALUES
  2859                     AND
  2860                 PI-104-SCREEN-BYPASS
  2861                     NOT EQUAL SPACES
  2862                 MOVE PI-104-TYPE      TO FILETYPI
  2863                 MOVE +1               TO FILETYPL
  2864                 MOVE PI-104-NAME      TO CONTROLI
  2865                 MOVE +12              TO CONTROLL
  2866                 MOVE +1               TO MAINTL
  2867                 MOVE QUOTE            TO EIBAID
  2868
  2869                 IF  PI-LANGUAGE-IS-FR
  2870                     MOVE 'M'          TO MAINTI
  2871                     GO TO 2001-CHECK-PFKEYS
  2872
  2873                 ELSE
  2874                     MOVE 'S'          TO MAINTI
  2875                     GO TO 2001-CHECK-PFKEYS
  2876
  2877             ELSE
  2878                 GO TO 8100-SEND-INITIAL-MAP
  2879
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL104.cbl
  2880       ELSE
  2881           MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  2882           MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  2883           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  2884           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  2885           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  2886           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  2887           MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  2888           MOVE SPACES               TO PI-SAVED-PROGRAM-6
  2889           MOVE LOW-VALUES TO EL104AI
  2890           MOVE PI-LAST-CONTROL TO CONTROLO
  2891           MOVE PI-FILETYP      TO FILETYPO
  2892           MOVE +1              TO MAINTL
  2893                                   FILETYPL
  2894           MOVE +12             TO CONTROLL
  2895           MOVE AL-UANON        TO CONTROLA
  2896                                   MAINTA
  2897                                   FILETYPA
  2898           IF  PI-LANGUAGE-IS-FR
  2899               MOVE 'M'         TO MAINTO
  2900               GO TO 8100-SEND-INITIAL-MAP
  2901
  2902           ELSE
  2903               MOVE 'S'         TO MAINTO
  2904               GO TO 8100-SEND-INITIAL-MAP.
  2905
  2906
  2907* EXEC CICS HANDLE CONDITION
  2908*         PGMIDERR(9600-PGMID-ERROR)
  2909*         ERROR   (9990-ABEND)
  2910*     END-EXEC.
  2911*    MOVE '"$L.                  ! " #00002902' TO DFHEIV0
  2912     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  2913     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2914     MOVE X'2220233030303032393032' TO DFHEIV0(25:11)
  2915     CALL 'kxdfhei1' USING DFHEIV0
  2916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2917
  2918
  2919     IF EIBAID = DFHCLEAR
  2920        GO TO 9400-CLEAR.
  2921
  2922     IF PI-PROCESSOR-ID = 'LGXX'
  2923         GO TO 0200-RECEIVE.
  2924
  2925     IF  MORTGAGE-SESSION
  2926         PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  2927         GO TO 0200-RECEIVE.
  2928
  2929
  2930* EXEC CICS READQ TS
  2931*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  2932*        INTO   (SECURITY-CONTROL)
  2933*        LENGTH (SC-COMM-LENGTH)
  2934*        ITEM   (W-SC-ITEM)
  2935*    END-EXEC.
  2936*    MOVE '*$II   L              ''   #00002917' TO DFHEIV0
  2937     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL104.cbl
  2938     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2939     MOVE X'2020233030303032393137' TO DFHEIV0(25:11)
  2940     CALL 'kxdfhei1' USING DFHEIV0,
  2941           PI-SECURITY-TEMP-STORE-ID,
  2942           SECURITY-CONTROL,
  2943           SC-COMM-LENGTH,
  2944           W-SC-ITEM,
  2945           DFHEIV99,
  2946           DFHEIV99
  2947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2948
  2949
  2950     MOVE SC-CREDIT-DISPLAY (03)  TO PI-DISPLAY-CAP.
  2951     MOVE SC-CREDIT-UPDATE  (03)  TO PI-MODIFY-CAP.
  2952
  2953     IF NOT DISPLAY-CAP
  2954         MOVE 'READ'          TO SM-READ
  2955         PERFORM 9995-SECURITY-VIOLATION
  2956         MOVE ER-0070         TO  EMI-ERROR
  2957         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2958         GO TO 8100-SEND-INITIAL-MAP.
  2959
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL104.cbl
  2961 0200-RECEIVE.
  2962     MOVE LOW-VALUES TO EL104AI.
  2963
  2964     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  2965           MOVE -1 TO MAINTL
  2966           MOVE ER-0008 TO EMI-ERROR
  2967           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2968           GO TO 8200-SEND-DATAONLY.
  2969
  2970
  2971* EXEC CICS RECEIVE
  2972*         MAP   (MAP-NAME)
  2973*         MAPSET(MAPSET-NAME)
  2974*         INTO  (EL104AI)
  2975*     END-EXEC.
  2976     MOVE LENGTH OF
  2977      EL104AI
  2978       TO DFHEIV11
  2979*    MOVE '8"T I  L              ''   #00002944' TO DFHEIV0
  2980     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2981     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2982     MOVE X'2020233030303032393434' TO DFHEIV0(25:11)
  2983     CALL 'kxdfhei1' USING DFHEIV0,
  2984           MAP-NAME,
  2985           EL104AI,
  2986           DFHEIV11,
  2987           MAPSET-NAME,
  2988           DFHEIV99,
  2989           DFHEIV99
  2990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2991
  2992
  2993     IF PFENTERL = ZEROS
  2994        GO TO 2001-CHECK-PFKEYS.
  2995
  2996     IF EIBAID NOT = DFHENTER
  2997        MOVE ER-0004 TO EMI-ERROR
  2998        GO TO 2002-INPUT-ERROR.
  2999
  3000     IF (PFENTERI NUMERIC) AND (PFENTERI GREATER 0 AND LESS 25)
  3001         MOVE PF-VALUES (PFENTERI) TO EIBAID
  3002     ELSE
  3003         MOVE ER-0029 TO EMI-ERROR
  3004         GO TO 2002-INPUT-ERROR.
  3005
  3006 2001-CHECK-PFKEYS.
  3007     IF EIBAID = DFHPF23
  3008         GO TO 9000-RETURN-CICS.
  3009
  3010     IF EIBAID = DFHPF24
  3011         GO TO 9200-RETURN-MAIN-MENU.
  3012
  3013     IF EIBAID = DFHPF12
  3014         GO TO 9500-PF12.
  3015
  3016     IF  FILETYPL = ZERO
  3017         MOVE ER-7270            TO EMI-ERROR
  3018         MOVE -1                 TO FILETYPL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL104.cbl
  3019         MOVE AL-UABON           TO FILETYPA
  3020         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3021         GO TO 8200-SEND-DATAONLY
  3022
  3023     ELSE
  3024         MOVE FILETYPI           TO W-FILE-TYPE
  3025
  3026         IF  W-LETTER
  3027             MOVE '1'            TO PI-ENTRY-CD-1
  3028
  3029         ELSE
  3030             IF  W-FORM
  3031                 MOVE '2'        TO PI-ENTRY-CD-1
  3032
  3033             ELSE
  3034                 IF  W-HELP
  3035                     MOVE '3'    TO PI-ENTRY-CD-1
  3036
  3037                 ELSE
  3038                     MOVE '0'    TO PI-ENTRY-CD-1
  3039                     MOVE ER-7270
  3040                                 TO EMI-ERROR
  3041                     MOVE -1     TO FILETYPL
  3042                     MOVE AL-UABON
  3043                                 TO FILETYPA
  3044                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3045                     GO TO 8200-SEND-DATAONLY.
  3046
  3047     MOVE FILETYPI               TO PI-FILETYP.
  3048
  3049     IF EIBAID = DFHPF1 OR DFHPF2
  3050        GO TO 4000-BROWSE-FILE.
  3051
  3052     IF EIBAID = DFHENTER
  3053        GO TO 2003-EDIT-DATA.
  3054
  3055     IF EIBAID = DFHPF5  AND
  3056        PI-PROCESSOR-ID = 'LGXX'
  3057         GO TO 2300-COPY-SAMP.
  3058
  3059     MOVE ER-0029 TO EMI-ERROR.
  3060
  3061 2002-INPUT-ERROR.
  3062     MOVE -1       TO PFENTERL.
  3063     MOVE AL-UNBON TO PFENTERA.
  3064     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3065     GO TO 8200-SEND-DATAONLY.
  3066
  3067 2003-EDIT-DATA.
  3068
  3069     IF MAINTL = ZERO
  3070         MOVE ER-0023            TO EMI-ERROR
  3071         MOVE -1                 TO MAINTL
  3072         MOVE AL-UABON           TO MAINTA
  3073         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3074         GO TO 8200-SEND-DATAONLY.
  3075
  3076     MOVE MAINTI                 TO W-MAINT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL104.cbl
  3077
  3078     IF  CREDIT-SESSION
  3079
  3080         IF  W-VALID-MAINT-CR
  3081             MOVE MAINTI         TO PI-ACTION
  3082
  3083         ELSE
  3084             MOVE ER-0023        TO EMI-ERROR
  3085             MOVE -1             TO MAINTL
  3086             MOVE AL-UABON       TO MAINTA
  3087             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3088             GO TO 8200-SEND-DATAONLY
  3089
  3090     ELSE
  3091         IF  W-VALID-MAINT-REST
  3092             MOVE MAINTI         TO PI-ACTION
  3093
  3094         ELSE
  3095             MOVE ER-0023        TO EMI-ERROR
  3096             MOVE -1             TO MAINTL
  3097             MOVE AL-UABON       TO MAINTA
  3098             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3099             GO TO 8200-SEND-DATAONLY.
  3100
  3101     IF  W-SHOW
  3102         NEXT SENTENCE
  3103
  3104     ELSE
  3105         IF NOT MODIFY-CAP
  3106             MOVE 'UPDATE'       TO SM-READ
  3107             PERFORM 9995-SECURITY-VIOLATION
  3108             MOVE ER-0070        TO EMI-ERROR
  3109             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3110             GO TO 8200-SEND-DATAONLY.
  3111
  3112     MOVE CONTROLI TO OLD-COMM-AREA  CNTL-KEY PI-COMM-CONTROL.
  3113     MOVE PI-COMPANY-CD TO OLD-CO-CD.
  3114     MOVE ZEROS         TO OLD-SEQ.
  3115
  3116     IF PI-ENTRY-CD-1 = '1'
  3117         MOVE LETTER-ID TO FILE-ID
  3118     ELSE
  3119         IF PI-ENTRY-CD-1 = '2'
  3120             MOVE FORM-ID TO FILE-ID
  3121         ELSE
  3122             MOVE HELP-ID TO FILE-ID.
  3123
  3124     IF FILE-ID = HELP-ID
  3125         MOVE LOW-VALUES TO OLD-CO-CD
  3126     END-IF.
  3127
  3128     MOVE OLD-KEY TO OLD-KEY-SAVE.
  3129
  3130     IF CONTROLL = ZEROS
  3131         MOVE -1                  TO CONTROLL
  3132         MOVE ER-0005             TO EMI-ERROR
  3133         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3134     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL104.cbl
  3135         MOVE AL-UANON            TO CONTROLA.
  3136
  3137     IF  W-TRANSFORM
  3138
  3139         IF  NEWCONTL = ZEROS
  3140             MOVE CONTROLI       TO NEWCONTO
  3141             MOVE AL-UANON       TO NEWCONTA
  3142
  3143         ELSE
  3144             MOVE NEWCONTI       TO NEWCONTO
  3145             MOVE AL-UANON       TO NEWCONTA
  3146
  3147     ELSE
  3148         IF  W-RENAME
  3149                 OR
  3150             W-COPY
  3151
  3152             IF  NEWCONTL = ZEROS
  3153                 MOVE -1         TO NEWCONTL
  3154                 MOVE ER-7271    TO EMI-ERROR
  3155                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3156
  3157             ELSE
  3158                 MOVE NEWCONTI   TO NEWCONTO
  3159                 MOVE AL-UANON   TO NEWCONTA.
  3160
  3161     IF NOT EMI-NO-ERRORS
  3162        GO TO 8200-SEND-DATAONLY.
  3163
  3164     IF  W-ADD
  3165             OR
  3166         W-CHANGE
  3167             OR
  3168         W-SHOW
  3169         GO TO 2100-BUILD-TS-RECORDS.
  3170
  3171     IF  W-TRANSFORM
  3172         GO TO 2700-CONVERT-LETTERS.
  3173
  3174     IF  W-RENAME
  3175         MOVE NEWCONTI           TO CNTL-KEY
  3176         MOVE '1'                TO REQUEST-TYPE
  3177         MOVE AL-UANON           TO NEWCONTA.
  3178
  3179     IF  W-COPY
  3180         MOVE NEWCONTI           TO CNTL-KEY
  3181         MOVE '2'                TO REQUEST-TYPE
  3182         MOVE AL-UANON           TO NEWCONTA.
  3183
  3184     IF  W-DELETE
  3185         MOVE CONTROLI           TO CNTL-KEY
  3186         MOVE '3'                TO REQUEST-TYPE
  3187         MOVE AL-UANON           TO CONTROLA
  3188         GO TO 5000-DELETE-FILE.
  3189
  3190     PERFORM 2500-EDIT-CONTROL THRU 2599-EXIT.
  3191     GO TO 3000-RENUMBER-FILE.
  3192
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL104.cbl
  3193 2100-BUILD-TS-RECORDS.
  3194     MOVE CONTROLI TO CNTL-KEY
  3195                      PI-LAST-CONTROL.
  3196     PERFORM 2500-EDIT-CONTROL THRU 2599-EXIT.
  3197     MOVE PGM-EL1042 TO PGM-NAME.
  3198     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL104.cbl
  3200 2300-COPY-SAMP.
  3201
  3202* EXEC CICS GETMAIN
  3203*       SET     (ADDRESS OF TEXT-FILES)
  3204*       LENGTH  (100)
  3205*   END-EXEC.
  3206     MOVE 100
  3207       TO DFHEIV11
  3208*    MOVE '," L                  $   #00003158' TO DFHEIV0
  3209     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  3210     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3211     MOVE X'2020233030303033313538' TO DFHEIV0(25:11)
  3212     CALL 'kxdfhei1' USING DFHEIV0,
  3213           DFHEIV20,
  3214           DFHEIV11,
  3215           DFHEIV99
  3216     SET ADDRESS OF TEXT-FILES TO
  3217         DFHEIV20
  3218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3219
  3220
  3221     MOVE CONTROLI   TO  CNTL-KEY  OLD-COMM-AREA.
  3222     MOVE ZEROS      TO  OLD-SEQ.
  3223     MOVE LETTER-ID  TO  FILE-ID.
  3224
  3225
  3226* EXEC CICS HANDLE CONDITION
  3227*        NOTFND   (2330-NOT-FOUND)
  3228*        NOTOPEN  (6000-NOT-OPEN)
  3229*        DUPREC   (2350-DUP-REC)
  3230*        ENDFILE  (2340-END-FILE)
  3231*    END-EXEC.
  3232*    MOVE '"$IJ%''                ! # #00003167' TO DFHEIV0
  3233     MOVE X'2224494A2527202020202020' TO DFHEIV0(1:12)
  3234     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3235     MOVE X'2320233030303033313637' TO DFHEIV0(25:11)
  3236     CALL 'kxdfhei1' USING DFHEIV0
  3237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3238
  3239
  3240 2310-LOOP.
  3241     MOVE WS-LGX-COMPANY-CD  TO  OLD-CO-CD.
  3242
  3243     IF FILE-ID = HELP-ID
  3244         MOVE LOW-VALUES TO OLD-CO-CD
  3245     END-IF.
  3246
  3247
  3248* EXEC CICS STARTBR
  3249*        DATASET    (FILE-ID)
  3250*        RIDFLD     (OLD-KEY)
  3251*        KEYLENGTH  (15)
  3252*        GTEQ
  3253*    END-EXEC.
  3254     MOVE 15
  3255       TO DFHEIV11
  3256     MOVE 0
  3257       TO DFHEIV12
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL104.cbl
  3258*    MOVE '&,   K     G          &   #00003181' TO DFHEIV0
  3259     MOVE X'262C2020204B202020202047' TO DFHEIV0(1:12)
  3260     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3261     MOVE X'2020233030303033313831' TO DFHEIV0(25:11)
  3262     CALL 'kxdfhei1' USING DFHEIV0,
  3263           FILE-ID,
  3264           OLD-KEY,
  3265           DFHEIV11,
  3266           DFHEIV12,
  3267           DFHEIV99
  3268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3269
  3270
  3271 2320-READNEXT.
  3272
  3273* EXEC CICS READNEXT
  3274*        INTO     (TEXT-FILES)
  3275*        DATASET  (FILE-ID)
  3276*        RIDFLD   (OLD-KEY)
  3277*    END-EXEC.
  3278     MOVE LENGTH OF
  3279      TEXT-FILES
  3280       TO DFHEIV12
  3281     MOVE 0
  3282       TO DFHEIV11
  3283*    MOVE '&.IL                  )   #00003189' TO DFHEIV0
  3284     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3285     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3286     MOVE X'2020233030303033313839' TO DFHEIV0(25:11)
  3287     CALL 'kxdfhei1' USING DFHEIV0,
  3288           FILE-ID,
  3289           TEXT-FILES,
  3290           DFHEIV12,
  3291           OLD-KEY,
  3292           DFHEIV99,
  3293           DFHEIV11,
  3294           DFHEIV99,
  3295           DFHEIV99
  3296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3297
  3298
  3299
  3300* EXEC CICS ENDBR
  3301*        DATASET  (FILE-ID)
  3302*    END-EXEC.
  3303     MOVE 0
  3304       TO DFHEIV11
  3305*    MOVE '&2                    $   #00003195' TO DFHEIV0
  3306     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3307     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3308     MOVE X'2020233030303033313935' TO DFHEIV0(25:11)
  3309     CALL 'kxdfhei1' USING DFHEIV0,
  3310           FILE-ID,
  3311           DFHEIV11,
  3312           DFHEIV99
  3313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3314
  3315
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL104.cbl
  3316     IF TX-ACCESS-CD-GENL NOT = CNTL-KEY
  3317         GO TO 2340-END-FILE.
  3318
  3319     IF FILE-ID = HELP-ID
  3320         MOVE LOW-VALUES TO  TX-COMPANY-CD
  3321     ELSE
  3322     MOVE PI-COMPANY-CD  TO  TX-COMPANY-CD.
  3323
  3324
  3325* EXEC CICS WRITE
  3326*        FROM     (TEXT-FILES)
  3327*        DATASET  (FILE-ID)
  3328*        RIDFLD   (TX-CONTROL-PRIMARY)
  3329*    END-EXEC.
  3330     MOVE LENGTH OF
  3331      TEXT-FILES
  3332       TO DFHEIV11
  3333*    MOVE '&$ L                  ''   #00003207' TO DFHEIV0
  3334     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3335     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3336     MOVE X'2020233030303033323037' TO DFHEIV0(25:11)
  3337     CALL 'kxdfhei1' USING DFHEIV0,
  3338           FILE-ID,
  3339           TEXT-FILES,
  3340           DFHEIV11,
  3341           TX-CONTROL-PRIMARY,
  3342           DFHEIV99,
  3343           DFHEIV99
  3344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3345
  3346
  3347     ADD +1  TO  TX-LINE-SEQUENCE.
  3348
  3349     MOVE TX-LINE-SEQUENCE  TO  OLD-SEQ.
  3350     MOVE 1                 TO  UPDATE-SW.
  3351
  3352     GO TO 2310-LOOP.
  3353
  3354 2330-NOT-FOUND.
  3355     MOVE -1    TO  CONTROLL.
  3356     MOVE ER-0006  TO  EMI-ERROR.
  3357
  3358     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3359
  3360     GO TO 8200-SEND-DATAONLY.
  3361
  3362 2340-END-FILE.
  3363     IF NOT FILE-UPDATED
  3364         GO TO 2330-NOT-FOUND.
  3365
  3366     MOVE LOW-VALUES  TO  EL104AO.
  3367     MOVE -1          TO  MAINTL.
  3368
  3369     GO TO 8100-SEND-INITIAL-MAP.
  3370
  3371 2350-DUP-REC.
  3372     MOVE -1    TO  NEWCONTL.
  3373     MOVE ER-0076  TO  EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL104.cbl
  3374
  3375     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3376
  3377     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL104.cbl
  3379 2500-EDIT-CONTROL.
  3380     IF PI-ENTRY-CD-1 = '1'
  3381        IF K5 NOT = SPACES
  3382           MOVE ER-0009 TO EMI-ERROR
  3383           GO TO 2600-SET-ERROR-FLAG.
  3384
  3385     IF PI-ENTRY-CD-1 = '3'
  3386         IF (K1 = ' ' OR 'S' OR 'E')  AND
  3387            K9 = SPACE
  3388             NEXT SENTENCE
  3389         ELSE
  3390              MOVE ER-0012 TO EMI-ERROR
  3391              GO TO 2600-SET-ERROR-FLAG.
  3392
  3393     IF PI-ENTRY-CD-1 = '3'
  3394         IF K1 = 'E'
  3395            IF K2 NOT NUMERIC  OR
  3396               K3 NOT NUMERIC  OR
  3397               K4 NOT NUMERIC  OR
  3398               K5 NOT NUMERIC
  3399                MOVE ER-0012 TO EMI-ERROR
  3400                GO TO 2600-SET-ERROR-FLAG.
  3401
  3402     IF PI-ENTRY-CD-1 = '3'
  3403         IF K1 = 'S'
  3404            IF K2 NOT NUMERIC  OR
  3405               K3 NOT NUMERIC  OR
  3406               K4 NOT NUMERIC
  3407                MOVE ER-0012 TO EMI-ERROR
  3408                GO TO 2600-SET-ERROR-FLAG.
  3409
  3410 2599-EXIT.
  3411      EXIT.
  3412
  3413 2600-SET-ERROR-FLAG.
  3414     IF RENUMBER-REQUEST OR COPY-REQUEST
  3415         MOVE -1       TO NEWCONTL
  3416         MOVE AL-UABON TO NEWCONTA
  3417     ELSE
  3418         MOVE -1       TO CONTROLL
  3419         MOVE AL-UABON TO CONTROLA.
  3420
  3421     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3422     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL104.cbl
  3424 2700-CONVERT-LETTERS.
  3425
  3426     MOVE NEWCONTI               TO PI-NEW-NAME.
  3427     MOVE CONTROLI               TO PI-OLD-NAME.
  3428     MOVE 0000                   TO PI-1043-ERROR.
  3429
  3430
  3431* EXEC CICS LINK
  3432*         PROGRAM   ('EL1043')
  3433*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  3434*         LENGTH    (PI-COMM-LENGTH)
  3435*    END-EXEC.
  3436     MOVE 'EL1043' TO DFHEIV1
  3437*    MOVE '."C                   ''   #00003296' TO DFHEIV0
  3438     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3439     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3440     MOVE X'2020233030303033323936' TO DFHEIV0(25:11)
  3441     CALL 'kxdfhei1' USING DFHEIV0,
  3442           DFHEIV1,
  3443           PROGRAM-INTERFACE-BLOCK,
  3444           PI-COMM-LENGTH,
  3445           DFHEIV99,
  3446           DFHEIV99,
  3447           DFHEIV99
  3448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3449
  3450
  3451     IF  PI-1043-ERROR NOT EQUAL 0000
  3452         MOVE PI-1043-ERROR      TO EMI-ERROR
  3453         MOVE -1                 TO CONTROLL
  3454
  3455     ELSE
  3456         MOVE NEWCONTI           TO CONTROLO
  3457         MOVE SPACES             TO NEWCONTO
  3458         MOVE -1                 TO MAINTL
  3459         MOVE ER-7392            TO EMI-ERROR.
  3460
  3461         IF  PI-LANGUAGE-IS-FR
  3462             MOVE 'M'            TO MAINTO
  3463
  3464         ELSE
  3465             MOVE 'S'            TO MAINTO.
  3466
  3467     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3468     GO TO 8100-SEND-INITIAL-MAP.
  3469
  3470 2700-EXIT.
  3471     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL104.cbl
  3473 3000-RENUMBER-FILE.
  3474     MOVE 0                      TO UPDATE-SW.
  3475
  3476
  3477* EXEC CICS GETMAIN
  3478*         SET    (ADDRESS OF TEXT-FILES)
  3479*         LENGTH (100)
  3480*     END-EXEC.
  3481     MOVE 100
  3482       TO DFHEIV11
  3483*    MOVE '," L                  $   #00003327' TO DFHEIV0
  3484     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  3485     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3486     MOVE X'2020233030303033333237' TO DFHEIV0(25:11)
  3487     CALL 'kxdfhei1' USING DFHEIV0,
  3488           DFHEIV20,
  3489           DFHEIV11,
  3490           DFHEIV99
  3491     SET ADDRESS OF TEXT-FILES TO
  3492         DFHEIV20
  3493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3494
  3495
  3496     MOVE CONTROLI TO CNTL-KEY.
  3497
  3498
  3499* EXEC CICS HANDLE CONDITION
  3500*         NOTFND (3900-NOT-FOUND)
  3501*         NOTOPEN(6000-NOT-OPEN)
  3502*         DUPREC (3920-DUP-REC)
  3503*         ENDFILE(3910-END-FILE)
  3504*     END-EXEC.
  3505*    MOVE '"$IJ%''                ! $ #00003334' TO DFHEIV0
  3506     MOVE X'2224494A2527202020202020' TO DFHEIV0(1:12)
  3507     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3508     MOVE X'2420233030303033333334' TO DFHEIV0(25:11)
  3509     CALL 'kxdfhei1' USING DFHEIV0
  3510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3511
  3512
  3513 3001-LOOP.
  3514
  3515* EXEC CICS STARTBR
  3516*         DATASET  (FILE-ID)
  3517*         RIDFLD   (OLD-KEY)
  3518*         KEYLENGTH(15)
  3519*         GTEQ
  3520*     END-EXEC.
  3521     MOVE 15
  3522       TO DFHEIV11
  3523     MOVE 0
  3524       TO DFHEIV12
  3525*    MOVE '&,   K     G          &   #00003342' TO DFHEIV0
  3526     MOVE X'262C2020204B202020202047' TO DFHEIV0(1:12)
  3527     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3528     MOVE X'2020233030303033333432' TO DFHEIV0(25:11)
  3529     CALL 'kxdfhei1' USING DFHEIV0,
  3530           FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL104.cbl
  3531           OLD-KEY,
  3532           DFHEIV11,
  3533           DFHEIV12,
  3534           DFHEIV99
  3535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3536
  3537
  3538 3100-READNEXT.
  3539
  3540* EXEC CICS READNEXT
  3541*         INTO   (TEXT-FILES)
  3542*         DATASET(FILE-ID)
  3543*         RIDFLD (OLD-KEY)
  3544*     END-EXEC.
  3545     MOVE LENGTH OF
  3546      TEXT-FILES
  3547       TO DFHEIV12
  3548     MOVE 0
  3549       TO DFHEIV11
  3550*    MOVE '&.IL                  )   #00003350' TO DFHEIV0
  3551     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3552     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3553     MOVE X'2020233030303033333530' TO DFHEIV0(25:11)
  3554     CALL 'kxdfhei1' USING DFHEIV0,
  3555           FILE-ID,
  3556           TEXT-FILES,
  3557           DFHEIV12,
  3558           OLD-KEY,
  3559           DFHEIV99,
  3560           DFHEIV11,
  3561           DFHEIV99,
  3562           DFHEIV99
  3563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3564
  3565
  3566
  3567* EXEC CICS ENDBR
  3568*         DATASET (FILE-ID)
  3569*     END-EXEC.
  3570     MOVE 0
  3571       TO DFHEIV11
  3572*    MOVE '&2                    $   #00003356' TO DFHEIV0
  3573     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3574     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3575     MOVE X'2020233030303033333536' TO DFHEIV0(25:11)
  3576     CALL 'kxdfhei1' USING DFHEIV0,
  3577           FILE-ID,
  3578           DFHEIV11,
  3579           DFHEIV99
  3580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3581
  3582
  3583     IF TX-ACCESS-CD-GENL NOT = CNTL-KEY
  3584        GO TO 3910-END-FILE.
  3585
  3586     MOVE NEWCONTI TO TX-ACCESS-CD-GENL.
  3587
  3588
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL104.cbl
  3589* EXEC CICS WRITE
  3590*         FROM   (TEXT-FILES)
  3591*         DATASET(FILE-ID)
  3592*         RIDFLD (TX-CONTROL-PRIMARY)
  3593*     END-EXEC.
  3594     MOVE LENGTH OF
  3595      TEXT-FILES
  3596       TO DFHEIV11
  3597*    MOVE '&$ L                  ''   #00003365' TO DFHEIV0
  3598     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3599     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3600     MOVE X'2020233030303033333635' TO DFHEIV0(25:11)
  3601     CALL 'kxdfhei1' USING DFHEIV0,
  3602           FILE-ID,
  3603           TEXT-FILES,
  3604           DFHEIV11,
  3605           TX-CONTROL-PRIMARY,
  3606           DFHEIV99,
  3607           DFHEIV99
  3608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3609
  3610
  3611     ADD +1 TO TX-LINE-SEQUENCE.
  3612     MOVE TX-LINE-SEQUENCE TO OLD-SEQ.
  3613     MOVE 1 TO UPDATE-SW
  3614     GO TO 3001-LOOP.
  3615
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL104.cbl
  3617 3900-NOT-FOUND.
  3618     MOVE -1      TO CONTROLL.
  3619     MOVE ER-0006 TO EMI-ERROR.
  3620     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3621     GO TO 8200-SEND-DATAONLY.
  3622
  3623 3910-END-FILE.
  3624     IF NOT FILE-UPDATED
  3625        GO TO 3900-NOT-FOUND.
  3626
  3627     IF RENUMBER-REQUEST
  3628
  3629* EXEC CICS DELETE
  3630*            DATASET  (FILE-ID)
  3631*            RIDFLD   (OLD-KEY-SAVE)
  3632*            KEYLENGTH(13)
  3633*            GENERIC
  3634*        END-EXEC.
  3635     MOVE 13
  3636       TO DFHEIV11
  3637*    MOVE '&(  RKG               &   #00003388' TO DFHEIV0
  3638     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  3639     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3640     MOVE X'2020233030303033333838' TO DFHEIV0(25:11)
  3641     CALL 'kxdfhei1' USING DFHEIV0,
  3642           FILE-ID,
  3643           OLD-KEY-SAVE,
  3644           DFHEIV11,
  3645           DFHEIV99,
  3646           DFHEIV99
  3647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3648
  3649
  3650     MOVE LOW-VALUES TO EL104AO.
  3651     MOVE -1         TO CONTROLL.
  3652     GO TO 8100-SEND-INITIAL-MAP.
  3653
  3654 3920-DUP-REC.
  3655     MOVE -1      TO NEWCONTL.
  3656     MOVE ER-0076 TO EMI-ERROR.
  3657     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3658     GO TO 8200-SEND-DATAONLY.
  3659
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL104.cbl
  3661 4000-BROWSE-FILE.
  3662     IF PI-ENTRY-CD-1 = '1'
  3663         MOVE LETTER-ID TO FILE-ID
  3664     ELSE
  3665         IF PI-ENTRY-CD-1 = '2'
  3666             MOVE FORM-ID TO FILE-ID
  3667         ELSE
  3668             MOVE HELP-ID TO FILE-ID.
  3669
  3670     MOVE SPACE TO BROWSE-STARTED-SW.
  3671
  3672
  3673* EXEC CICS HANDLE CONDITION
  3674*         NOTOPEN (6000-NOT-OPEN)
  3675*         NOTFND  (4800-NO-RECORD)
  3676*         ENDFILE (4900-END-FILE)
  3677*     END-EXEC.
  3678*    MOVE '"$JI''                 ! % #00003417' TO DFHEIV0
  3679     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  3680     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3681     MOVE X'2520233030303033343137' TO DFHEIV0(25:11)
  3682     CALL 'kxdfhei1' USING DFHEIV0
  3683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3684
  3685
  3686     IF  CONTROLI = SPACES OR LOW-VALUES
  3687
  3688         IF  PI-LAST-CONTROL GREATER THAN LOW-VALUES
  3689             MOVE PI-LAST-CONTROL
  3690                                 TO CONTROLI
  3691
  3692         ELSE
  3693             MOVE LOW-VALUES     TO CONTROLI.
  3694
  3695     MOVE PI-COMPANY-CD TO CO-CD.
  3696     IF FILE-ID = HELP-ID
  3697         MOVE LOW-VALUES TO CO-CD
  3698     END-IF.
  3699
  3700     MOVE ZEROS         TO SEQ.
  3701     MOVE CONTROLI      TO CNTL-AREA  CNTL-KEY  PI-COMM-CONTROL.
  3702
  3703
  3704* EXEC CICS STARTBR
  3705*         DATASET(FILE-ID)
  3706*         RIDFLD (FILE-KEY)
  3707*     END-EXEC.
  3708     MOVE 0
  3709       TO DFHEIV11
  3710*    MOVE '&,         G          &   #00003440' TO DFHEIV0
  3711     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3712     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3713     MOVE X'2020233030303033343430' TO DFHEIV0(25:11)
  3714     CALL 'kxdfhei1' USING DFHEIV0,
  3715           FILE-ID,
  3716           FILE-KEY,
  3717           DFHEIV99,
  3718           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL104.cbl
  3719           DFHEIV99
  3720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3721
  3722
  3723     MOVE 'Y' TO BROWSE-STARTED-SW.
  3724
  3725     IF EIBAID = DFHPF2
  3726        MOVE 1 TO SEQ
  3727        GO TO 4600-BROWSE-BKWD
  3728       ELSE
  3729        MOVE 9999 TO SEQ.
  3730
  3731 4500-READNEXT.
  3732
  3733* EXEC CICS READNEXT
  3734*         SET    (ADDRESS OF TEXT-FILES)
  3735*         DATASET(FILE-ID)
  3736*         RIDFLD (FILE-KEY)
  3737*     END-EXEC.
  3738     MOVE 0
  3739       TO DFHEIV11
  3740*    MOVE '&.S                   )   #00003454' TO DFHEIV0
  3741     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3742     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3743     MOVE X'2020233030303033343534' TO DFHEIV0(25:11)
  3744     CALL 'kxdfhei1' USING DFHEIV0,
  3745           FILE-ID,
  3746           DFHEIV20,
  3747           DFHEIV99,
  3748           FILE-KEY,
  3749           DFHEIV99,
  3750           DFHEIV11,
  3751           DFHEIV99,
  3752           DFHEIV99
  3753     SET ADDRESS OF TEXT-FILES TO
  3754         DFHEIV20
  3755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3756
  3757
  3758     IF FILE-ID = HELP-ID
  3759         NEXT SENTENCE
  3760     ELSE
  3761     IF TX-COMPANY-CD NOT = PI-COMPANY-CD
  3762        GO TO 4900-END-FILE.
  3763
  3764     IF EIBAID = DFHPF1
  3765        IF CONTROLO = TX-ACCESS-CD-GENL
  3766          GO TO 4500-READNEXT.
  3767
  3768 4550-DISPLAY-SCREEN.
  3769     MOVE TX-ACCESS-CD-GENL TO CONTROLO
  3770                               CNTL-KEY   PI-COMM-CONTROL.
  3771
  3772     MOVE TX-CONTROL-PRIMARY    TO OLD-KEY.
  3773     MOVE -1       TO MAINTL.
  3774     MOVE AL-UANON TO CONTROLA.
  3775     GO TO 8100-SEND-INITIAL-MAP.
  3776
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL104.cbl
  3777 4600-BROWSE-BKWD.
  3778
  3779* EXEC CICS HANDLE CONDITION
  3780*         NOTFND(4900-END-FILE)
  3781*     END-EXEC.
  3782*    MOVE '"$I                   ! & #00003480' TO DFHEIV0
  3783     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3784     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3785     MOVE X'2620233030303033343830' TO DFHEIV0(25:11)
  3786     CALL 'kxdfhei1' USING DFHEIV0
  3787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3788
  3789
  3790
  3791* EXEC CICS READPREV
  3792*       DATASET (FILE-ID)
  3793*       SET     (ADDRESS OF TEXT-FILES)
  3794*       RIDFLD  (FILE-KEY)
  3795*   END-EXEC.
  3796     MOVE 0
  3797       TO DFHEIV11
  3798*    MOVE '&0S                   )   #00003484' TO DFHEIV0
  3799     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  3800     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3801     MOVE X'2020233030303033343834' TO DFHEIV0(25:11)
  3802     CALL 'kxdfhei1' USING DFHEIV0,
  3803           FILE-ID,
  3804           DFHEIV20,
  3805           DFHEIV99,
  3806           FILE-KEY,
  3807           DFHEIV99,
  3808           DFHEIV11,
  3809           DFHEIV99,
  3810           DFHEIV99
  3811     SET ADDRESS OF TEXT-FILES TO
  3812         DFHEIV20
  3813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3814
  3815
  3816 4650-BROWSE-LOOP.
  3817     IF PI-FILE-EOF
  3818        MOVE SPACE TO PI-EOF-SW
  3819      ELSE
  3820
  3821* EXEC CICS READPREV
  3822*       DATASET (FILE-ID)
  3823*       SET     (ADDRESS OF TEXT-FILES)
  3824*       RIDFLD  (FILE-KEY)
  3825*   END-EXEC.
  3826     MOVE 0
  3827       TO DFHEIV11
  3828*    MOVE '&0S                   )   #00003494' TO DFHEIV0
  3829     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  3830     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3831     MOVE X'2020233030303033343934' TO DFHEIV0(25:11)
  3832     CALL 'kxdfhei1' USING DFHEIV0,
  3833           FILE-ID,
  3834           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL104.cbl
  3835           DFHEIV99,
  3836           FILE-KEY,
  3837           DFHEIV99,
  3838           DFHEIV11,
  3839           DFHEIV99,
  3840           DFHEIV99
  3841     SET ADDRESS OF TEXT-FILES TO
  3842         DFHEIV20
  3843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3844
  3845
  3846     IF FILE-ID = HELP-ID
  3847         NEXT SENTENCE
  3848     ELSE
  3849     IF TX-COMPANY-CD NOT = PI-COMPANY-CD
  3850        GO TO 4900-END-FILE.
  3851
  3852     GO TO 4550-DISPLAY-SCREEN.
  3853
  3854 4800-NO-RECORD.
  3855     MOVE -1                     TO CONTROLL.
  3856     MOVE AL-UANON               TO CONTROLA.
  3857     MOVE ER-1162                TO EMI-ERROR.
  3858     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3859
  3860     IF BROWSE-STARTED
  3861
  3862* EXEC CICS ENDBR
  3863*           DATASET  (FILE-ID)
  3864*       END-EXEC.
  3865     MOVE 0
  3866       TO DFHEIV11
  3867*    MOVE '&2                    $   #00003515' TO DFHEIV0
  3868     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3869     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3870     MOVE X'2020233030303033353135' TO DFHEIV0(25:11)
  3871     CALL 'kxdfhei1' USING DFHEIV0,
  3872           FILE-ID,
  3873           DFHEIV11,
  3874           DFHEIV99
  3875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3876
  3877
  3878     GO TO 8200-SEND-DATAONLY.
  3879
  3880 4900-END-FILE.
  3881     IF EIBAID = DFHPF1
  3882         MOVE 'Y'                TO PI-EOF-SW
  3883         MOVE ER-2237            TO EMI-ERROR
  3884     ELSE
  3885         MOVE ER-2238            TO EMI-ERROR.
  3886
  3887     MOVE -1                     TO MAINTL.
  3888
  3889     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3890
  3891     IF BROWSE-STARTED
  3892
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL104.cbl
  3893* EXEC CICS ENDBR
  3894*           DATASET  (FILE-ID)
  3895*       END-EXEC.
  3896     MOVE 0
  3897       TO DFHEIV11
  3898*    MOVE '&2                    $   #00003533' TO DFHEIV0
  3899     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3900     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3901     MOVE X'2020233030303033353333' TO DFHEIV0(25:11)
  3902     CALL 'kxdfhei1' USING DFHEIV0,
  3903           FILE-ID,
  3904           DFHEIV11,
  3905           DFHEIV99
  3906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3907
  3908
  3909     MOVE SPACE TO BROWSE-STARTED-SW.
  3910     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL104.cbl
  3912 5000-DELETE-FILE.
  3913
  3914* EXEC CICS HANDLE CONDITION
  3915*         NOTFND (3900-NOT-FOUND)
  3916*         NOTOPEN(6000-NOT-OPEN)
  3917*     END-EXEC.
  3918*    MOVE '"$IJ                  ! '' #00003541' TO DFHEIV0
  3919     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3920     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3921     MOVE X'2720233030303033353431' TO DFHEIV0(25:11)
  3922     CALL 'kxdfhei1' USING DFHEIV0
  3923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3924
  3925
  3926
  3927* EXEC CICS DELETE
  3928*         DATASET  (FILE-ID)
  3929*         RIDFLD   (OLD-KEY-SAVE)
  3930*         KEYLENGTH(13)
  3931*         GENERIC
  3932*     END-EXEC.
  3933     MOVE 13
  3934       TO DFHEIV11
  3935*    MOVE '&(  RKG               &   #00003546' TO DFHEIV0
  3936     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  3937     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3938     MOVE X'2020233030303033353436' TO DFHEIV0(25:11)
  3939     CALL 'kxdfhei1' USING DFHEIV0,
  3940           FILE-ID,
  3941           OLD-KEY-SAVE,
  3942           DFHEIV11,
  3943           DFHEIV99,
  3944           DFHEIV99
  3945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3946
  3947
  3948     MOVE 1          TO UPDATE-SW.
  3949     MOVE LOW-VALUES TO EL104AI.
  3950     GO TO 8100-SEND-INITIAL-MAP.
  3951
  3952 6000-NOT-OPEN.
  3953     MOVE -1 TO MAINTL.
  3954
  3955     IF PI-ENTRY-CD-1 = '1'
  3956         MOVE ER-0013 TO EMI-ERROR
  3957     ELSE
  3958         IF PI-ENTRY-CD-1 = '2'
  3959             MOVE ER-0014 TO EMI-ERROR
  3960         ELSE
  3961             MOVE ER-0015 TO EMI-ERROR.
  3962
  3963     MOVE -1           TO MAINTL.
  3964     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3965     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL104.cbl
  3967 8100-SEND-INITIAL-MAP.
  3968
  3969     MOVE 'Y'          TO PI-104-SCREEN-SENT-IND.
  3970     MOVE SAVE-DATE    TO DATEO.
  3971     MOVE EIBTIME      TO TIME-IN.
  3972     MOVE TIME-OUT     TO TIMEO.
  3973     MOVE PI-COMPANY-ID          TO COMPAO.
  3974
  3975     IF  NOT CREDIT-SESSION
  3976         MOVE SPACES             TO TRANSFMO
  3977         MOVE AL-PANOF           TO TRANSFMA.
  3978
  3979     IF PI-PROCESSOR-ID = 'LGXX'
  3980         MOVE AL-PANOF  TO  HDNPFAA.
  3981
  3982     IF FILE-UPDATED
  3983         MOVE ER-0000   TO EMI-ERROR
  3984         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3985
  3986     MOVE PI-FILETYP    TO FILETYPO.
  3987     MOVE AL-UANON      TO FILETYPA.
  3988
  3989     MOVE EMI-MESSAGE-AREA (1) TO ERRMSG1O.
  3990     MOVE AL-SABON             TO ERRMSG1A.
  3991     MOVE EMI-MESSAGE-AREA (2) TO ERRMSG2O.
  3992     MOVE AL-SABON             TO ERRMSG2A.
  3993
  3994
  3995* EXEC CICS SEND
  3996*         MAPSET(MAPSET-NAME)
  3997*         MAP   (MAP-NAME)
  3998*         FROM  (EL104AO)
  3999*         ERASE
  4000*     END-EXEC.
  4001     MOVE LENGTH OF
  4002      EL104AO
  4003       TO DFHEIV11
  4004*    MOVE '8$      T  E    H L F ,   #00003599' TO DFHEIV0
  4005     MOVE X'382420202020202054202045' TO DFHEIV0(1:12)
  4006     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4007     MOVE X'2020233030303033353939' TO DFHEIV0(25:11)
  4008     CALL 'kxdfhei1' USING DFHEIV0,
  4009           MAP-NAME,
  4010           EL104AO,
  4011           DFHEIV11,
  4012           MAPSET-NAME,
  4013           DFHEIV99,
  4014           DFHEIV99,
  4015           DFHEIV99,
  4016           DFHEIV99,
  4017           DFHEIV99,
  4018           DFHEIV99,
  4019           DFHEIV99
  4020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4021
  4022
  4023     GO TO 9100-RETURN-TRAN.
  4024
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL104.cbl
  4025 8200-SEND-DATAONLY.
  4026
  4027     IF  PI-104-SCREEN-NOT-SENT
  4028         GO TO 8100-SEND-INITIAL-MAP.
  4029
  4030     MOVE EIBTIME  TO TIME-IN.
  4031     MOVE TIME-OUT TO TIMEO.
  4032     MOVE PI-COMPANY-ID          TO COMPAO.
  4033
  4034     MOVE EMI-MESSAGE-AREA (1) TO ERRMSG1O.
  4035     MOVE AL-SABON             TO ERRMSG1A.
  4036     MOVE EMI-MESSAGE-AREA (2) TO ERRMSG2O.
  4037     MOVE AL-SABON             TO ERRMSG2A.
  4038
  4039     IF  NOT CREDIT-SESSION
  4040         MOVE SPACES             TO TRANSFMO
  4041         MOVE AL-PANOF           TO TRANSFMA.
  4042
  4043     IF PI-ENTRY-CD-1 NOT = '0'
  4044         MOVE PI-FILETYP    TO FILETYPO
  4045         MOVE AL-UANON      TO FILETYPA.
  4046
  4047
  4048* EXEC CICS SEND
  4049*         MAPSET(MAPSET-NAME)
  4050*         MAP   (MAP-NAME)
  4051*         DATAONLY
  4052*         CURSOR
  4053*         FROM  (EL104AO)
  4054*     END-EXEC.
  4055     MOVE LENGTH OF
  4056      EL104AO
  4057       TO DFHEIV12
  4058     MOVE -1
  4059       TO DFHEIV11
  4060*    MOVE '8$D    CT       H L F ,   #00003630' TO DFHEIV0
  4061     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  4062     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4063     MOVE X'2020233030303033363330' TO DFHEIV0(25:11)
  4064     CALL 'kxdfhei1' USING DFHEIV0,
  4065           MAP-NAME,
  4066           EL104AO,
  4067           DFHEIV12,
  4068           MAPSET-NAME,
  4069           DFHEIV99,
  4070           DFHEIV99,
  4071           DFHEIV99,
  4072           DFHEIV11,
  4073           DFHEIV99,
  4074           DFHEIV99,
  4075           DFHEIV99
  4076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4077
  4078
  4079     GO TO 9100-RETURN-TRAN.
  4080
  4081 8300-SEND-TEXT.
  4082
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL104.cbl
  4083* EXEC CICS SEND TEXT
  4084*         FROM  (LOGOFF-TEXT)
  4085*         ERASE
  4086*         FREEKB
  4087*         LENGTH(LOGOFF-LENGTH)
  4088*     END-EXEC.
  4089*    MOVE '8&      T  E F  H   F -   #00003641' TO DFHEIV0
  4090     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  4091     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  4092     MOVE X'2020233030303033363431' TO DFHEIV0(25:11)
  4093     CALL 'kxdfhei1' USING DFHEIV0,
  4094           LOGOFF-TEXT,
  4095           LOGOFF-LENGTH,
  4096           DFHEIV99,
  4097           DFHEIV99,
  4098           DFHEIV99,
  4099           DFHEIV99,
  4100           DFHEIV99,
  4101           DFHEIV99,
  4102           DFHEIV99,
  4103           DFHEIV99,
  4104           DFHEIV99,
  4105           DFHEIV99
  4106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4107
  4108
  4109
  4110* EXEC CICS RETURN
  4111*     END-EXEC.
  4112*    MOVE '.(                    &   #00003648' TO DFHEIV0
  4113     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4114     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4115     MOVE X'2020233030303033363438' TO DFHEIV0(25:11)
  4116     CALL 'kxdfhei1' USING DFHEIV0,
  4117           DFHEIV99,
  4118           DFHEIV99,
  4119           DFHEIV99,
  4120           DFHEIV99,
  4121           DFHEIV99
  4122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4123
  4124
  4125 8800-UNAUTHORIZED-ACCESS.
  4126     MOVE UNACCESS-MSG TO LOGOFF-MSG.
  4127     GO TO 8300-SEND-TEXT.
  4128
  4129 9000-RETURN-CICS.
  4130     MOVE EIBAID  TO PI-ENTRY-CD-1.
  4131     MOVE 'EL005' TO PGM-NAME.
  4132     GO TO 9300-XCTL.
  4133
  4134 9100-RETURN-TRAN.
  4135     MOVE MAP-NUMBER           TO PI-CURRENT-SCREEN-NO.
  4136     MOVE EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  4137
  4138     MOVE PI-COMM-CONTROL      TO PI-LAST-CONTROL.
  4139
  4140
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL104.cbl
  4141* EXEC CICS RETURN
  4142*         TRANSID (TRANS-ID)
  4143*         COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4144*         LENGTH  (PI-COMM-LENGTH)
  4145*     END-EXEC.
  4146*    MOVE '.(CT                  &   #00003666' TO DFHEIV0
  4147     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  4148     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4149     MOVE X'2020233030303033363636' TO DFHEIV0(25:11)
  4150     CALL 'kxdfhei1' USING DFHEIV0,
  4151           TRANS-ID,
  4152           PROGRAM-INTERFACE-BLOCK,
  4153           PI-COMM-LENGTH,
  4154           DFHEIV99,
  4155           DFHEIV99
  4156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4157
  4158
  4159 9200-RETURN-MAIN-MENU.
  4160     IF CLAIM-SESSION
  4161         MOVE XCTL-CLAIM         TO PGM-NAME
  4162     ELSE
  4163         IF CREDIT-SESSION
  4164             MOVE XCTL-CREDIT    TO PGM-NAME
  4165         ELSE
  4166             IF WARRANTY-SESSION
  4167                 MOVE XCTL-WARRANTY  TO PGM-NAME
  4168             ELSE
  4169                 IF MORTGAGE-SESSION
  4170                     MOVE XCTL-MORTGAGE      TO PGM-NAME
  4171                 ELSE
  4172                     MOVE XCTL-GEN-LEDGER    TO PGM-NAME.
  4173
  4174 9300-XCTL.
  4175
  4176* EXEC CICS XCTL
  4177*         PROGRAM (PGM-NAME)
  4178*         COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4179*         LENGTH  (PI-COMM-LENGTH)
  4180*     END-EXEC.
  4181*    MOVE '.$C                   $   #00003688' TO DFHEIV0
  4182     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4183     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4184     MOVE X'2020233030303033363838' TO DFHEIV0(25:11)
  4185     CALL 'kxdfhei1' USING DFHEIV0,
  4186           PGM-NAME,
  4187           PROGRAM-INTERFACE-BLOCK,
  4188           PI-COMM-LENGTH
  4189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4190
  4191
  4192 9400-CLEAR.
  4193     MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME.
  4194     GO TO 9300-XCTL.
  4195
  4196 9500-PF12.
  4197     MOVE 'EL010' TO PGM-NAME.
  4198     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL104.cbl
  4199
  4200 9600-PGMID-ERROR.
  4201
  4202* EXEC CICS HANDLE CONDITION
  4203*         PGMIDERR(8300-SEND-TEXT)
  4204*     END-EXEC.
  4205*    MOVE '"$L                   ! ( #00003703' TO DFHEIV0
  4206     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4207     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4208     MOVE X'2820233030303033373033' TO DFHEIV0(25:11)
  4209     CALL 'kxdfhei1' USING DFHEIV0
  4210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4211
  4212
  4213     MOVE PGM-NAME     TO PI-CALLING-PROGRAM.
  4214     MOVE SPACES       TO PI-ENTRY-CD-1.
  4215     MOVE 'EL005'      TO PGM-NAME.
  4216     MOVE PGM-NAME     TO LOGOFF-PGM.
  4217     MOVE PGMIDERR-MSG TO LOGOFF-FILL.
  4218     GO TO 9300-XCTL.
  4219
  4220
  4221 9700-LINK-DATE-CONVERT.
  4222
  4223* EXEC CICS LINK
  4224*        PROGRAM    ('ELDATCV')
  4225*        COMMAREA   (DATE-CONVERSION-DATA)
  4226*        LENGTH     (DC-COMM-LENGTH)
  4227*    END-EXEC.
  4228     MOVE 'ELDATCV' TO DFHEIV1
  4229*    MOVE '."C                   ''   #00003716' TO DFHEIV0
  4230     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4231     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4232     MOVE X'2020233030303033373136' TO DFHEIV0(25:11)
  4233     CALL 'kxdfhei1' USING DFHEIV0,
  4234           DFHEIV1,
  4235           DATE-CONVERSION-DATA,
  4236           DC-COMM-LENGTH,
  4237           DFHEIV99,
  4238           DFHEIV99,
  4239           DFHEIV99
  4240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4241
  4242
  4243 9700-EXIT.
  4244     EXIT.
  4245
  4246 9900-ERROR-FORMAT.
  4247
  4248     MOVE PI-LANGUAGE-TYPE       TO EMI-LANGUAGE-IND.
  4249
  4250     IF NOT EMI-ERRORS-COMPLETE
  4251
  4252* EXEC CICS LINK
  4253*            PROGRAM ('EL001')
  4254*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  4255*            LENGTH  (EMI-COMM-LENGTH)
  4256*        END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL104.cbl
  4257     MOVE 'EL001' TO DFHEIV1
  4258*    MOVE '."C                   ''   #00003730' TO DFHEIV0
  4259     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4260     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4261     MOVE X'2020233030303033373330' TO DFHEIV0(25:11)
  4262     CALL 'kxdfhei1' USING DFHEIV0,
  4263           DFHEIV1,
  4264           ERROR-MESSAGE-INTERFACE-BLOCK,
  4265           EMI-COMM-LENGTH,
  4266           DFHEIV99,
  4267           DFHEIV99,
  4268           DFHEIV99
  4269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4270
  4271
  4272 9900-EXIT.
  4273      EXIT.
  4274
  4275 9910-INITIALIZE-SECURITY.
  4276******************************************************************
  4277*                                                                *
  4278*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  4279*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
  4280*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
  4281*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
  4282*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  4283*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  4284*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  4285*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  4286*                                                                *
  4287*       NOTE:  THE CARRIER/GRP/STATE/PRODUCER SECURITY DATA      *
  4288*       IS ALSO PROVIDED BY THIS LOGIC.                          *
  4289*                                                                *
  4290******************************************************************
  4291
  4292     IF  PI-PROCESSOR-ID NOT EQUAL 'LGXX'
  4293         MOVE '125E'             TO SC-QUID-SYSTEM
  4294         MOVE EIBTRMID           TO SC-QUID-TERMINAL
  4295
  4296
  4297* EXEC CICS READQ TS
  4298*            QUEUE  (SC-QUID-KEY)
  4299*            INTO   (SECURITY-CONTROL-E)
  4300*            LENGTH (SC-COMM-LENGTH-E)
  4301*            ITEM   (SC-ITEM)
  4302*        END-EXEC
  4303*    MOVE '*$II   L              ''   #00003760' TO DFHEIV0
  4304     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4305     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4306     MOVE X'2020233030303033373630' TO DFHEIV0(25:11)
  4307     CALL 'kxdfhei1' USING DFHEIV0,
  4308           SC-QUID-KEY,
  4309           SECURITY-CONTROL-E,
  4310           SC-COMM-LENGTH-E,
  4311           SC-ITEM,
  4312           DFHEIV99,
  4313           DFHEIV99
  4314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL104.cbl
  4315
  4316         MOVE SC-MP-DISPLAY (W-APPL-SCRTY-NDX)
  4317                                 TO PI-DISPLAY-CAP
  4318         MOVE SC-MP-UPDATE (W-APPL-SCRTY-NDX)
  4319                                 TO PI-MODIFY-CAP
  4320
  4321         IF  NOT DISPLAY-CAP
  4322             MOVE 'READ'         TO SM-READ
  4323             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  4324             MOVE ER-9097        TO EMI-ERROR
  4325             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4326             PERFORM 8100-SEND-INITIAL-MAP.
  4327
  4328 9910-EXIT.
  4329     EXIT.
  4330
  4331 9990-ABEND.
  4332     MOVE 'EL004'                TO PGM-NAME.
  4333     MOVE DFHEIBLK               TO EMI-LINE1.
  4334
  4335
  4336* EXEC CICS LINK
  4337*        PROGRAM   (PGM-NAME)
  4338*        COMMAREA  (EMI-LINE1)
  4339*        LENGTH    (72)
  4340*    END-EXEC.
  4341     MOVE 72
  4342       TO DFHEIV11
  4343*    MOVE '."C                   ''   #00003786' TO DFHEIV0
  4344     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4345     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4346     MOVE X'2020233030303033373836' TO DFHEIV0(25:11)
  4347     CALL 'kxdfhei1' USING DFHEIV0,
  4348           PGM-NAME,
  4349           EMI-LINE1,
  4350           DFHEIV11,
  4351           DFHEIV99,
  4352           DFHEIV99,
  4353           DFHEIV99
  4354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4355
  4356
  4357     GO TO 8200-SEND-DATAONLY.
  4358
  4359
  4360* GOBACK.
  4361     MOVE '9%                    "   ' TO DFHEIV0
  4362     MOVE 'EL104' TO DFHEIV1
  4363     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4364     GOBACK.
  4365
  4366 9995-SECURITY-VIOLATION.
  4367*                            COPY ELCSCTP.
  4368******************************************************************
  4369*                                                                *
  4370*                            ELCSCTP                             *
  4371*                            VMOD=2.001                          *
  4372*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL104.cbl
  4373*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  4374******************************************************************
  4375
  4376
  4377     MOVE EIBDATE          TO SM-JUL-DATE.
  4378     MOVE EIBTRMID         TO SM-TERMID.
  4379     MOVE THIS-PGM         TO SM-PGM.
  4380     MOVE EIBTIME          TO TIME-IN.
  4381     MOVE TIME-OUT         TO SM-TIME.
  4382     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  4383
  4384
  4385* EXEC CICS LINK
  4386*         PROGRAM  ('EL003')
  4387*         COMMAREA (SECURITY-MESSAGE)
  4388*         LENGTH   (80)
  4389*    END-EXEC.
  4390     MOVE 'EL003' TO DFHEIV1
  4391     MOVE 80
  4392       TO DFHEIV11
  4393*    MOVE '."C                   ''   #00003814' TO DFHEIV0
  4394     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4395     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4396     MOVE X'2020233030303033383134' TO DFHEIV0(25:11)
  4397     CALL 'kxdfhei1' USING DFHEIV0,
  4398           DFHEIV1,
  4399           SECURITY-MESSAGE,
  4400           DFHEIV11,
  4401           DFHEIV99,
  4402           DFHEIV99,
  4403           DFHEIV99
  4404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4405
  4406
  4407******************************************************************
  4408
  4409
  4410 9995-EXIT.
  4411     EXIT.
  4412
  4413
  4414 9999-DFHBACK SECTION.
  4415     MOVE '9%                    "   ' TO DFHEIV0
  4416     MOVE 'EL104' TO DFHEIV1
  4417     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4418     GOBACK.
  4419 9999-DFHEXIT.
  4420     IF DFHEIGDJ EQUAL 0001
  4421         NEXT SENTENCE
  4422     ELSE IF DFHEIGDJ EQUAL 2
  4423         GO TO 9600-PGMID-ERROR,
  4424               9990-ABEND
  4425         DEPENDING ON DFHEIGDI
  4426     ELSE IF DFHEIGDJ EQUAL 3
  4427         GO TO 2330-NOT-FOUND,
  4428               6000-NOT-OPEN,
  4429               2350-DUP-REC,
  4430               2340-END-FILE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL104.cbl
  4431         DEPENDING ON DFHEIGDI
  4432     ELSE IF DFHEIGDJ EQUAL 4
  4433         GO TO 3900-NOT-FOUND,
  4434               6000-NOT-OPEN,
  4435               3920-DUP-REC,
  4436               3910-END-FILE
  4437         DEPENDING ON DFHEIGDI
  4438     ELSE IF DFHEIGDJ EQUAL 5
  4439         GO TO 6000-NOT-OPEN,
  4440               4800-NO-RECORD,
  4441               4900-END-FILE
  4442         DEPENDING ON DFHEIGDI
  4443     ELSE IF DFHEIGDJ EQUAL 6
  4444         GO TO 4900-END-FILE
  4445         DEPENDING ON DFHEIGDI
  4446     ELSE IF DFHEIGDJ EQUAL 7
  4447         GO TO 3900-NOT-FOUND,
  4448               6000-NOT-OPEN
  4449         DEPENDING ON DFHEIGDI
  4450     ELSE IF DFHEIGDJ EQUAL 8
  4451         GO TO 8300-SEND-TEXT
  4452         DEPENDING ON DFHEIGDI.
  4453     MOVE '9%                    "   ' TO DFHEIV0
  4454     MOVE 'EL104' TO DFHEIV1
  4455     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4456     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5216     Code:        8660
