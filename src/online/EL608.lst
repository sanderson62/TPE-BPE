* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL608.cbl
* Options: int("EL608.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL608.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL608.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL608.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL608 .
     3*                            VMOD=2.001.
     4*
     5*
     6*AUTHOR.    CSO.
     7*           OMAHA, NEBRASKA.
     8*DATE-COMPILED.
     9*SECURITY.   *****************************************************
    10*            *                                                   *
    11*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
    12*            *                                                   *
    13*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL608.cbl
    14*            *   OF    CSO      IS EXPRESSLY PROHIBITED WITHOUT  *
    15*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    16*            *                                                   *
    17*            *****************************************************
    18*REMARKS.
    19*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    20*    FOR THE LIFE CLAIM INTEREST SELECTION CRITERIA.
    21*
    22*    SCREENS     - EL608A - INTEREST RATE SCHEDULE
    23*
    24*    ENTERED BY  - EL605 - LIFE CLAIM INTEREST MENU
    25*
    26*    EXIT TO     - EL605 - LIFE CLAIM INTEREST MENU
    27*
    28*    COMMAREA    - PASSED
    29*
    30*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL605.  ON
    31*                  FIRST ENTRY, A SKELETON SCREEN IS SENT AND THE
    32*                  PROGRAM EXITS TO WAIT FOR INPUT.  ON SUCCESSIVE
    33*                  ENTRIES (XCTL FROM CICS VIA EX  ) THE SCREEN
    34*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    35*                  MAINTENANCE TYPE INDICATED.
    36******************************************************************
    37*                   C H A N G E   L O G
    38*
    39* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    40*-----------------------------------------------------------------
    41*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    42* EFFECTIVE    NUMBER
    43*-----------------------------------------------------------------
    44* 052605    2004040700004  PEMA  NEW PROGRAM
    45******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL608.cbl
    47 ENVIRONMENT DIVISION.
    48 DATA DIVISION.
    49 WORKING-STORAGE SECTION.
    50 01  DFH-START PIC X(04).
    51 77  FILLER  PIC X(32)  VALUE '********************************'.
    52 77  FILLER  PIC X(32)  VALUE '*   EL608  WORKING STORAGE     *'.
    53 77  FILLER  PIC X(32)  VALUE '***********VMOD=2.001 **********'.
    54 77  CI1                PIC S999  COMP-3 VALUE +0.
    55 77  B1                 PIC S999  COMP-3 VALUE +0.
    56*    COPY ELCSCTM.
    57******************************************************************
    58*                                                                *
    59*                                                                *
    60*                            ELCSCTM                             *
    61*                            VMOD=2.001                          *
    62*                                                                *
    63*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    64*                                                                *
    65******************************************************************
    66 01  SECURITY-MESSAGE.
    67     12  FILLER                          PIC X(30)
    68            VALUE '** LOGIC SECURITY VIOLATION -'.
    69     12  SM-READ                         PIC X(6).
    70     12  FILLER                          PIC X(5)
    71            VALUE ' PGM='.
    72     12  SM-PGM                          PIC X(6).
    73     12  FILLER                          PIC X(5)
    74            VALUE ' OPR='.
    75     12  SM-PROCESSOR-ID                 PIC X(4).
    76     12  FILLER                          PIC X(6)
    77            VALUE ' TERM='.
    78     12  SM-TERMID                       PIC X(4).
    79     12  FILLER                          PIC XX   VALUE SPACE.
    80     12  SM-JUL-DATE                     PIC 9(5).
    81     12  FILLER                          PIC X    VALUE SPACE.
    82     12  SM-TIME                         PIC 99.99.
    83
    84*    COPY ELCSCRTY.
    85******************************************************************
    86*                                                                *
    87*                                                                *
    88*                            ELCSCRTY                            *
    89*                            VMOD=2.001                          *
    90*                                                                *
    91*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    92*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    93*        SAVED IN PI-SECURITY-ADDRESS.                           *
    94*                                                                *
    95******************************************************************
    96 01  SECURITY-CONTROL.
    97     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    98     12  FILLER                       PIC XX    VALUE 'SC'.
    99     12  SC-CREDIT-CODES.
   100         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   101             20  SC-CREDIT-DISPLAY    PIC X.
   102             20  SC-CREDIT-UPDATE     PIC X.
   103     12  SC-CLAIMS-CODES.
   104         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL608.cbl
   105             20  SC-CLAIMS-DISPLAY    PIC X.
   106             20  SC-CLAIMS-UPDATE     PIC X.
   107 01  WS-DATE-AREA.
   108     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   109    05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   110 01  FILLER                          COMP-3.
   111     05  WS-RECORD-COUNT             PIC S9(3)   VALUE ZERO.
   112     05  WS-READNEXT-SW              PIC S9      VALUE ZERO.
   113     05  WS-LAST-ERROR-COUNT         PIC S9(3)   VALUE ZERO.
   114     05  WS-UPDATE-SW                PIC S9      VALUE ZERO.
   115     05  WS-COMPLETED-SUCCESSFUL     PIC S9      VALUE ZERO.
   116       88  TRANSACTION-SUCCESSFUL                    VALUE +1.
   117       88  INITIAL-TRANSACTION                       VALUE +2.
   118       88  CHANGE-SUCCESSFUL                         VALUE +3.
   119     05  TIME-IN                     PIC S9(7)   VALUE ZERO.
   120     05  TIME-OUT                    REDEFINES
   121         TIME-IN                     PIC S9(3)V9(4).
   122 01  FILLER                          COMP SYNC.
   123     05  WS-INDEX                    PIC S9(4)   VALUE ZERO.
   124     05  WS-JOURNAL-FILE-ID          PIC S9(4)   VALUE +1.
   125     05  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +773.
   126     05  ELCIST-LENGTH               PIC S9(4)   VALUE +100.
   127     05  GETMAIN-SPACE               PIC  X      VALUE SPACE.
   128 01  WS-ELCIIR-RECORD            PIC X(100).
   129 01  FILLER.
   130     05  DEEDIT-FIELD        PIC  X(10).
   131     05  DEEDIT-FIELD-V0  REDEFINES
   132         DEEDIT-FIELD        PIC S9(10).
   133     05  WS-BIN-DATES OCCURS 10.
   134         10  WS-BIN-START-DATE   PIC XX.
   135         10  WS-BIN-END-DATE     PIC XX.
   136     05  WS-RESPONSE             PIC S9(8)   COMP.
   137         88  RESP-NORMAL              VALUE +00.
   138         88  RESP-ERROR               VALUE +01.
   139         88  RESP-NOTFND              VALUE +13.
   140         88  RESP-NOTOPEN             VALUE +19.
   141         88  RESP-ENDFILE             VALUE +20.
   142     05  WS-IR-CONTROL-PRIMARY.
   143         10  WS-IR-COMPANY-CD        PIC X.
   144         10  WS-IR-INT-RATE-CODE     PIC XXX.
   145     05  WS-CONTROL-PRIMARY.
   146         10  WS-COMPANY-CD           PIC X      VALUE SPACES.
   147         10  WS-SCHED-CODE           PIC XXX    VALUE SPACES.
   148         10  WS-END-DT               PIC XX     VALUE SPACES.
   149     05  WS-MAPSET-NAME              PIC X(8)  VALUE 'EL608S'.
   150     05  WS-MAP-NAME                 PIC X(8)  VALUE 'EL608A'.
   151     05  FILLER                      REDEFINES
   152         WS-MAP-NAME.
   153         10  FILLER                  PIC XX.
   154         10  WS-MAP-NUMBER           PIC X(4).
   155         10  FILLER                  PIC XX.
   156     05  THIS-PGM                    PIC X(8)  VALUE 'EL608'.
   157     05  WS-JOURNAL-TYPE-ID          PIC XX      VALUE 'EL'.
   158     05  WS-LOW-VALUES               PIC X VALUE LOW-VALUES.
   159     05  WS-SPACE                    PIC X       VALUE SPACE.
   160     05  WS-TRANS-ID                 PIC X(4)    VALUE 'EXAD'.
   161     05  WS-TEMP-STORAGE-KEY.
   162         10  WS-TS-TERM-ID           PIC X(4)    VALUE 'XXXX'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL608.cbl
   163         10  FILLER                  PIC X(4)    VALUE '608'.
   164     05  WS-ERROR-MESSAGE-AREA.
   165         10  ER-0000                 PIC 9(4)   VALUE 0000.
   166         10  ER-0004                 PIC 9(4)   VALUE 0004.
   167         10  ER-0006                 PIC 9(4)   VALUE 0006.
   168         10  ER-0008                 PIC 9(4)   VALUE 0008.
   169         10  ER-0023                 PIC 9(4)   VALUE 0023.
   170         10  ER-0029                 PIC 9(4)   VALUE 0029.
   171         10  ER-0070                 PIC 9(4)   VALUE 0070.
   172         10  ER-0150                 PIC 9(4)   VALUE 0150.
   173         10  ER-0491                 PIC 9(4)   VALUE 0491.
   174         10  ER-1079                 PIC 9(4)   VALUE 1079.
   175         10  ER-1257                 PIC 9(4)   VALUE 1257.
   176         10  ER-1258                 PIC 9(4)   VALUE 1258.
   177         10  ER-2261                 PIC 9(4)   VALUE 2261.
   178         10  ER-3800                 PIC 9(4)   VALUE 3800.
   179         10  ER-3801                 PIC 9(4)   VALUE 3801.
   180         10  ER-3802                 PIC 9(4)   VALUE 3802.
   181         10  ER-3803                 PIC 9(4)   VALUE 3803.
   182         10  ER-3804                 PIC 9(4)   VALUE 3804.
   183         10  ER-3805                 PIC 9(4)   VALUE 3805.
   184         10  ER-3806                 PIC 9(4)   VALUE 3806.
   185         10  ER-3807                 PIC 9(4)   VALUE 3807.
   186         10  ER-3808                 PIC 9(4)   VALUE 3808.
   187         10  ER-3809                 PIC 9(4)   VALUE 3809.
   188         10  ER-7220                 PIC 9(4)   VALUE 7220.
   189         10  ER-9999                 PIC 9(4)   VALUE 9999.
   190*    COPY ELCINTF.
   191******************************************************************
   192*                                                                *
   193*                                                                *
   194*                            ELCINTF.                            *
   195*                            VMOD=2.017                          *
   196*                                                                *
   197*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   198*                                                                *
   199*       LENGTH = 1024                                            *
   200*                                                                *
   201******************************************************************
   202 01  PROGRAM-INTERFACE-BLOCK.
   203     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   204     12  PI-CALLING-PROGRAM              PIC X(8).
   205     12  PI-SAVED-PROGRAM-1              PIC X(8).
   206     12  PI-SAVED-PROGRAM-2              PIC X(8).
   207     12  PI-SAVED-PROGRAM-3              PIC X(8).
   208     12  PI-SAVED-PROGRAM-4              PIC X(8).
   209     12  PI-SAVED-PROGRAM-5              PIC X(8).
   210     12  PI-SAVED-PROGRAM-6              PIC X(8).
   211     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   212     12  PI-COMPANY-ID                   PIC XXX.
   213     12  PI-COMPANY-CD                   PIC X.
   214
   215     12  PI-COMPANY-PASSWORD             PIC X(8).
   216
   217     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   218
   219     12  PI-CONTROL-IN-PROGRESS.
   220         16  PI-CARRIER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL608.cbl
   221         16  PI-GROUPING                 PIC X(6).
   222         16  PI-STATE                    PIC XX.
   223         16  PI-ACCOUNT                  PIC X(10).
   224         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   225                                         PIC X(10).
   226         16  PI-CLAIM-CERT-GRP.
   227             20  PI-CLAIM-NO             PIC X(7).
   228             20  PI-CERT-NO.
   229                 25  PI-CERT-PRIME       PIC X(10).
   230                 25  PI-CERT-SFX         PIC X.
   231             20  PI-CERT-EFF-DT          PIC XX.
   232         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   233             20  PI-PLAN-CODE            PIC X(2).
   234             20  PI-REVISION-NUMBER      PIC X(3).
   235             20  PI-PLAN-EFF-DT          PIC X(2).
   236             20  PI-PLAN-EXP-DT          PIC X(2).
   237             20  FILLER                  PIC X(11).
   238         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   239             20  PI-OE-REFERENCE-1.
   240                 25  PI-OE-REF-1-PRIME   PIC X(18).
   241                 25  PI-OE-REF-1-SUFF    PIC XX.
   242
   243     12  PI-SESSION-IN-PROGRESS          PIC X.
   244         88  CLAIM-SESSION                   VALUE '1'.
   245         88  CREDIT-SESSION                  VALUE '2'.
   246         88  WARRANTY-SESSION                VALUE '3'.
   247         88  MORTGAGE-SESSION                VALUE '4'.
   248         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   249
   250
   251*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   252
   253     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   254     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   255
   256     12  PI-CREDIT-USER                  PIC X.
   257         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   258         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   259
   260     12  PI-CLAIM-USER                   PIC X.
   261         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   262         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   263
   264     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   265         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   266         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   267         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   268         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   269         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   270
   271     12  PI-PROCESSOR-ID                 PIC X(4).
   272
   273     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   274
   275     12  PI-MEMBER-CAPTION               PIC X(10).
   276
   277     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   278         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL608.cbl
   279
   280     12  PI-LIFE-OVERRIDE-L1             PIC X.
   281     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   282     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   283     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   284
   285     12  PI-AH-OVERRIDE-L1               PIC X.
   286     12  PI-AH-OVERRIDE-L2               PIC XX.
   287     12  PI-AH-OVERRIDE-L6               PIC X(6).
   288     12  PI-AH-OVERRIDE-L12              PIC X(12).
   289
   290     12  PI-NEW-SYSTEM                   PIC X(2).
   291
   292     12  PI-PRIMARY-CERT-NO              PIC X(11).
   293     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   294         88  PI-USES-PAID-TO                 VALUE '1'.
   295     12  PI-CRDTCRD-SYSTEM.
   296         16  PI-CRDTCRD-USER             PIC X.
   297             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   298             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   299         16  PI-CC-MONTH-END-DT          PIC XX.
   300     12  PI-PROCESSOR-PRINTER            PIC X(4).
   301
   302     12  PI-OE-REFERENCE-2.
   303         16  PI-OE-REF-2-PRIME           PIC X(10).
   304         16  PI-OE-REF-2-SUFF            PIC X.
   305
   306     12  PI-REM-TRM-CALC-OPTION          PIC X.
   307
   308     12  PI-LANGUAGE-TYPE                PIC X.
   309             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   310             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   311             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   312
   313     12  PI-POLICY-LINKAGE-IND           PIC X.
   314         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   315         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   316                                                   LOW-VALUES.
   317
   318     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   319     12  PI-CLAIM-PW-SESSION             PIC X(1).
   320         88  PI-CLAIM-CREDIT                 VALUE '1'.
   321         88  PI-CLAIM-CONVEN                 VALUE '2'.
   322     12  FILLER                          PIC X(4).
   323
   324     12  PI-SYSTEM-LEVEL                 PIC X(145).
   325
   326     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   327         PI-SYSTEM-LEVEL.
   328
   329         16  PI-ENTRY-CODES.
   330             20  PI-ENTRY-CD-1           PIC X.
   331             20  PI-ENTRY-CD-2           PIC X.
   332
   333         16  PI-RETURN-CODES.
   334             20  PI-RETURN-CD-1          PIC X.
   335             20  PI-RETURN-CD-2          PIC X.
   336
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL608.cbl
   337         16  PI-UPDATE-STATUS-SAVE.
   338             20  PI-UPDATE-BY            PIC X(4).
   339             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   340
   341         16  PI-LOWER-CASE-LETTERS       PIC X.
   342             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   343
   344*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   345*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   346*            88  CARRIER-CLM-CNTL            VALUE '2'.
   347
   348         16  PI-CERT-ACCESS-CONTROL      PIC X.
   349             88  ST-ACCNT-CNTL               VALUE ' '.
   350             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   351             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   352             88  ACCNT-CNTL                  VALUE '3'.
   353             88  CARR-ACCNT-CNTL             VALUE '4'.
   354
   355         16  PI-PROCESSOR-CAP-LIST.
   356             20  PI-SYSTEM-CONTROLS.
   357                24 PI-SYSTEM-DISPLAY     PIC X.
   358                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   359                24 PI-SYSTEM-MODIFY      PIC X.
   360                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   361             20  FILLER                  PIC XX.
   362             20  PI-DISPLAY-CAP          PIC X.
   363                 88  DISPLAY-CAP             VALUE 'Y'.
   364             20  PI-MODIFY-CAP           PIC X.
   365                 88  MODIFY-CAP              VALUE 'Y'.
   366             20  PI-MSG-AT-LOGON-CAP     PIC X.
   367                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   368             20  PI-FORCE-CAP            PIC X.
   369                 88  FORCE-CAP               VALUE 'Y'.
   370
   371         16  PI-PROGRAM-CONTROLS.
   372             20  PI-PGM-PRINT-OPT        PIC X.
   373             20  PI-PGM-FORMAT-OPT       PIC X.
   374             20  PI-PGM-PROCESS-OPT      PIC X.
   375             20  PI-PGM-TOTALS-OPT       PIC X.
   376
   377         16  PI-HELP-INTERFACE.
   378             20  PI-LAST-ERROR-NO        PIC X(4).
   379             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   380
   381         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   382             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   383
   384         16  PI-CR-CONTROL-IN-PROGRESS.
   385             20  PI-CR-CARRIER           PIC X.
   386             20  PI-CR-GROUPING          PIC X(6).
   387             20  PI-CR-STATE             PIC XX.
   388             20  PI-CR-ACCOUNT           PIC X(10).
   389             20  PI-CR-FIN-RESP          PIC X(10).
   390             20  PI-CR-TYPE              PIC X.
   391
   392         16  PI-CR-BATCH-NUMBER          PIC X(6).
   393
   394         16  PI-CR-MONTH-END-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL608.cbl
   395
   396         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   397             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   398             88  PI-ZERO-CARRIER             VALUE '1'.
   399             88  PI-ZERO-GROUPING            VALUE '2'.
   400             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   401
   402         16  PI-CARRIER-SECURITY         PIC X.
   403             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   404
   405         16  PI-ACCOUNT-SECURITY         PIC X(10).
   406             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   407             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   408
   409         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   410             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   411                                         INDEXED BY PI-ACCESS-NDX
   412                                         PIC X.
   413
   414         16  PI-GA-BILLING-CONTROL       PIC X.
   415             88  PI-GA-BILLING               VALUE '1'.
   416
   417         16  PI-MAIL-PROCESSING          PIC X.
   418             88  PI-MAIL-YES                 VALUE 'Y'.
   419
   420         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   421
   422         16  PI-AR-SYSTEM.
   423             20  PI-AR-PROCESSING-CNTL   PIC X.
   424                 88  PI-AR-PROCESSING        VALUE 'Y'.
   425             20  PI-AR-SUMMARY-CODE      PIC X(6).
   426             20  PI-AR-MONTH-END-DT      PIC XX.
   427
   428         16  PI-MP-SYSTEM.
   429             20  PI-MORTGAGE-USER            PIC X.
   430                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   431                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   432             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   433                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   434                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   435                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   436                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   437                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   438             20  PI-MP-MONTH-END-DT          PIC XX.
   439             20  PI-MP-REFERENCE-NO.
   440                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   441                 24  PI-MP-REFERENCE-SFX     PIC XX.
   442
   443         16  PI-LABEL-CONTROL            PIC X(01).
   444             88  PI-CREATE-LABELS                    VALUE 'Y'.
   445             88  PI-BYPASS-LABELS                    VALUE 'N'.
   446
   447         16  PI-BILL-GROUPING-CODE       PIC X(01).
   448             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   449
   450         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   451             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   452             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL608.cbl
   453
   454         16  FILLER                      PIC X(14).
   455
   456     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   457******************************************************************
   458     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
   459         16  PI-1ST-TIME-SW          PIC S9     COMP-3.
   460         16  PI-MODE                 PIC X.
   461             88  ADD-FUNCTION         VALUE 'A'.
   462         16  PI-CI-SCHED-CODE        PIC XXX.
   463         16  PI-CI-END-DATE          PIC XX.
   464         16  PI-CI-TOP-KEY           PIC X(6).
   465         16  PI-CI-BOT-KEY           PIC X(6).
   466         16  PI-CI-KEYS OCCURS 10.
   467             20  PI-CI-KEY           PIC X(6).
   468         16  PI-LAST-BENEFIT-NUMBER  PIC XX.
   469         16  PI-NEXT-BENEFIT-NUMBER  PIC XX.
   470         16  PI-LINE-COUNT           PIC S9(3)  COMP-3.
   471         16  PI-BROWSE-SW            PIC S9     COMP-3.
   472         16  PI-SHOW-SW              PIC S9     COMP-3.
   473         16  PI-CHANGE-SW            PIC S9     COMP-3.
   474         16  FILLER                  PIC X(553).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL608.cbl
   476*    COPY EL608S.
   477 01  EL608AI.
   478     05  FILLER            PIC  X(0012).
   479*    -------------------------------
   480     05  ADATEL PIC S9(0004) COMP.
   481     05  ADATEF PIC  X(0001).
   482     05  FILLER REDEFINES ADATEF.
   483         10  ADATEA PIC  X(0001).
   484     05  ADATEI PIC  X(0008).
   485*    -------------------------------
   486     05  ATIMEL PIC S9(0004) COMP.
   487     05  ATIMEF PIC  X(0001).
   488     05  FILLER REDEFINES ATIMEF.
   489         10  ATIMEA PIC  X(0001).
   490     05  ATIMEI PIC  X(0005).
   491*    -------------------------------
   492     05  AMAINTL PIC S9(0004) COMP.
   493     05  AMAINTF PIC  X(0001).
   494     05  FILLER REDEFINES AMAINTF.
   495         10  AMAINTA PIC  X(0001).
   496     05  AMAINTI PIC  X(0001).
   497*    -------------------------------
   498     05  SCODE01L PIC S9(0004) COMP.
   499     05  SCODE01F PIC  X(0001).
   500     05  FILLER REDEFINES SCODE01F.
   501         10  SCODE01A PIC  X(0001).
   502     05  SCODE01I PIC  X(0003).
   503*    -------------------------------
   504     05  START01L PIC S9(0004) COMP.
   505     05  START01F PIC  X(0001).
   506     05  FILLER REDEFINES START01F.
   507         10  START01A PIC  X(0001).
   508     05  START01I PIC  X(0010).
   509*    -------------------------------
   510     05  END01L PIC S9(0004) COMP.
   511     05  END01F PIC  X(0001).
   512     05  FILLER REDEFINES END01F.
   513         10  END01A PIC  X(0001).
   514     05  END01I PIC  X(0010).
   515*    -------------------------------
   516     05  RCODE01L PIC S9(0004) COMP.
   517     05  RCODE01F PIC  X(0001).
   518     05  FILLER REDEFINES RCODE01F.
   519         10  RCODE01A PIC  X(0001).
   520     05  RCODE01I PIC  X(0003).
   521*    -------------------------------
   522     05  SCODE02L PIC S9(0004) COMP.
   523     05  SCODE02F PIC  X(0001).
   524     05  FILLER REDEFINES SCODE02F.
   525         10  SCODE02A PIC  X(0001).
   526     05  SCODE02I PIC  X(0003).
   527*    -------------------------------
   528     05  START02L PIC S9(0004) COMP.
   529     05  START02F PIC  X(0001).
   530     05  FILLER REDEFINES START02F.
   531         10  START02A PIC  X(0001).
   532     05  START02I PIC  X(0010).
   533*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL608.cbl
   534     05  END02L PIC S9(0004) COMP.
   535     05  END02F PIC  X(0001).
   536     05  FILLER REDEFINES END02F.
   537         10  END02A PIC  X(0001).
   538     05  END02I PIC  X(0010).
   539*    -------------------------------
   540     05  RCODE02L PIC S9(0004) COMP.
   541     05  RCODE02F PIC  X(0001).
   542     05  FILLER REDEFINES RCODE02F.
   543         10  RCODE02A PIC  X(0001).
   544     05  RCODE02I PIC  X(0003).
   545*    -------------------------------
   546     05  SCODE03L PIC S9(0004) COMP.
   547     05  SCODE03F PIC  X(0001).
   548     05  FILLER REDEFINES SCODE03F.
   549         10  SCODE03A PIC  X(0001).
   550     05  SCODE03I PIC  X(0003).
   551*    -------------------------------
   552     05  START03L PIC S9(0004) COMP.
   553     05  START03F PIC  X(0001).
   554     05  FILLER REDEFINES START03F.
   555         10  START03A PIC  X(0001).
   556     05  START03I PIC  X(0010).
   557*    -------------------------------
   558     05  END03L PIC S9(0004) COMP.
   559     05  END03F PIC  X(0001).
   560     05  FILLER REDEFINES END03F.
   561         10  END03A PIC  X(0001).
   562     05  END03I PIC  X(0010).
   563*    -------------------------------
   564     05  RCODE03L PIC S9(0004) COMP.
   565     05  RCODE03F PIC  X(0001).
   566     05  FILLER REDEFINES RCODE03F.
   567         10  RCODE03A PIC  X(0001).
   568     05  RCODE03I PIC  X(0003).
   569*    -------------------------------
   570     05  SCODE04L PIC S9(0004) COMP.
   571     05  SCODE04F PIC  X(0001).
   572     05  FILLER REDEFINES SCODE04F.
   573         10  SCODE04A PIC  X(0001).
   574     05  SCODE04I PIC  X(0003).
   575*    -------------------------------
   576     05  START04L PIC S9(0004) COMP.
   577     05  START04F PIC  X(0001).
   578     05  FILLER REDEFINES START04F.
   579         10  START04A PIC  X(0001).
   580     05  START04I PIC  X(0010).
   581*    -------------------------------
   582     05  END04L PIC S9(0004) COMP.
   583     05  END04F PIC  X(0001).
   584     05  FILLER REDEFINES END04F.
   585         10  END04A PIC  X(0001).
   586     05  END04I PIC  X(0010).
   587*    -------------------------------
   588     05  RCODE04L PIC S9(0004) COMP.
   589     05  RCODE04F PIC  X(0001).
   590     05  FILLER REDEFINES RCODE04F.
   591         10  RCODE04A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL608.cbl
   592     05  RCODE04I PIC  X(0003).
   593*    -------------------------------
   594     05  SCODE05L PIC S9(0004) COMP.
   595     05  SCODE05F PIC  X(0001).
   596     05  FILLER REDEFINES SCODE05F.
   597         10  SCODE05A PIC  X(0001).
   598     05  SCODE05I PIC  X(0003).
   599*    -------------------------------
   600     05  START05L PIC S9(0004) COMP.
   601     05  START05F PIC  X(0001).
   602     05  FILLER REDEFINES START05F.
   603         10  START05A PIC  X(0001).
   604     05  START05I PIC  X(0010).
   605*    -------------------------------
   606     05  END05L PIC S9(0004) COMP.
   607     05  END05F PIC  X(0001).
   608     05  FILLER REDEFINES END05F.
   609         10  END05A PIC  X(0001).
   610     05  END05I PIC  X(0010).
   611*    -------------------------------
   612     05  RCODE05L PIC S9(0004) COMP.
   613     05  RCODE05F PIC  X(0001).
   614     05  FILLER REDEFINES RCODE05F.
   615         10  RCODE05A PIC  X(0001).
   616     05  RCODE05I PIC  X(0003).
   617*    -------------------------------
   618     05  SCODE06L PIC S9(0004) COMP.
   619     05  SCODE06F PIC  X(0001).
   620     05  FILLER REDEFINES SCODE06F.
   621         10  SCODE06A PIC  X(0001).
   622     05  SCODE06I PIC  X(0003).
   623*    -------------------------------
   624     05  START06L PIC S9(0004) COMP.
   625     05  START06F PIC  X(0001).
   626     05  FILLER REDEFINES START06F.
   627         10  START06A PIC  X(0001).
   628     05  START06I PIC  X(0010).
   629*    -------------------------------
   630     05  END06L PIC S9(0004) COMP.
   631     05  END06F PIC  X(0001).
   632     05  FILLER REDEFINES END06F.
   633         10  END06A PIC  X(0001).
   634     05  END06I PIC  X(0010).
   635*    -------------------------------
   636     05  RCODE06L PIC S9(0004) COMP.
   637     05  RCODE06F PIC  X(0001).
   638     05  FILLER REDEFINES RCODE06F.
   639         10  RCODE06A PIC  X(0001).
   640     05  RCODE06I PIC  X(0003).
   641*    -------------------------------
   642     05  SCODE07L PIC S9(0004) COMP.
   643     05  SCODE07F PIC  X(0001).
   644     05  FILLER REDEFINES SCODE07F.
   645         10  SCODE07A PIC  X(0001).
   646     05  SCODE07I PIC  X(0003).
   647*    -------------------------------
   648     05  START07L PIC S9(0004) COMP.
   649     05  START07F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL608.cbl
   650     05  FILLER REDEFINES START07F.
   651         10  START07A PIC  X(0001).
   652     05  START07I PIC  X(0010).
   653*    -------------------------------
   654     05  END07L PIC S9(0004) COMP.
   655     05  END07F PIC  X(0001).
   656     05  FILLER REDEFINES END07F.
   657         10  END07A PIC  X(0001).
   658     05  END07I PIC  X(0010).
   659*    -------------------------------
   660     05  RCODE07L PIC S9(0004) COMP.
   661     05  RCODE07F PIC  X(0001).
   662     05  FILLER REDEFINES RCODE07F.
   663         10  RCODE07A PIC  X(0001).
   664     05  RCODE07I PIC  X(0003).
   665*    -------------------------------
   666     05  SCODE08L PIC S9(0004) COMP.
   667     05  SCODE08F PIC  X(0001).
   668     05  FILLER REDEFINES SCODE08F.
   669         10  SCODE08A PIC  X(0001).
   670     05  SCODE08I PIC  X(0003).
   671*    -------------------------------
   672     05  START08L PIC S9(0004) COMP.
   673     05  START08F PIC  X(0001).
   674     05  FILLER REDEFINES START08F.
   675         10  START08A PIC  X(0001).
   676     05  START08I PIC  X(0010).
   677*    -------------------------------
   678     05  END08L PIC S9(0004) COMP.
   679     05  END08F PIC  X(0001).
   680     05  FILLER REDEFINES END08F.
   681         10  END08A PIC  X(0001).
   682     05  END08I PIC  X(0010).
   683*    -------------------------------
   684     05  RCODE08L PIC S9(0004) COMP.
   685     05  RCODE08F PIC  X(0001).
   686     05  FILLER REDEFINES RCODE08F.
   687         10  RCODE08A PIC  X(0001).
   688     05  RCODE08I PIC  X(0003).
   689*    -------------------------------
   690     05  SCODE09L PIC S9(0004) COMP.
   691     05  SCODE09F PIC  X(0001).
   692     05  FILLER REDEFINES SCODE09F.
   693         10  SCODE09A PIC  X(0001).
   694     05  SCODE09I PIC  X(0003).
   695*    -------------------------------
   696     05  START09L PIC S9(0004) COMP.
   697     05  START09F PIC  X(0001).
   698     05  FILLER REDEFINES START09F.
   699         10  START09A PIC  X(0001).
   700     05  START09I PIC  X(0010).
   701*    -------------------------------
   702     05  END09L PIC S9(0004) COMP.
   703     05  END09F PIC  X(0001).
   704     05  FILLER REDEFINES END09F.
   705         10  END09A PIC  X(0001).
   706     05  END09I PIC  X(0010).
   707*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL608.cbl
   708     05  RCODE09L PIC S9(0004) COMP.
   709     05  RCODE09F PIC  X(0001).
   710     05  FILLER REDEFINES RCODE09F.
   711         10  RCODE09A PIC  X(0001).
   712     05  RCODE09I PIC  X(0003).
   713*    -------------------------------
   714     05  SCODE10L PIC S9(0004) COMP.
   715     05  SCODE10F PIC  X(0001).
   716     05  FILLER REDEFINES SCODE10F.
   717         10  SCODE10A PIC  X(0001).
   718     05  SCODE10I PIC  X(0003).
   719*    -------------------------------
   720     05  START10L PIC S9(0004) COMP.
   721     05  START10F PIC  X(0001).
   722     05  FILLER REDEFINES START10F.
   723         10  START10A PIC  X(0001).
   724     05  START10I PIC  X(0010).
   725*    -------------------------------
   726     05  END10L PIC S9(0004) COMP.
   727     05  END10F PIC  X(0001).
   728     05  FILLER REDEFINES END10F.
   729         10  END10A PIC  X(0001).
   730     05  END10I PIC  X(0010).
   731*    -------------------------------
   732     05  RCODE10L PIC S9(0004) COMP.
   733     05  RCODE10F PIC  X(0001).
   734     05  FILLER REDEFINES RCODE10F.
   735         10  RCODE10A PIC  X(0001).
   736     05  RCODE10I PIC  X(0003).
   737*    -------------------------------
   738     05  AEMSG1L PIC S9(0004) COMP.
   739     05  AEMSG1F PIC  X(0001).
   740     05  FILLER REDEFINES AEMSG1F.
   741         10  AEMSG1A PIC  X(0001).
   742     05  AEMSG1I PIC  X(0079).
   743*    -------------------------------
   744     05  AEMSG2L PIC S9(0004) COMP.
   745     05  AEMSG2F PIC  X(0001).
   746     05  FILLER REDEFINES AEMSG2F.
   747         10  AEMSG2A PIC  X(0001).
   748     05  AEMSG2I PIC  X(0079).
   749*    -------------------------------
   750     05  APFKL PIC S9(0004) COMP.
   751     05  APFKF PIC  X(0001).
   752     05  FILLER REDEFINES APFKF.
   753         10  APFKA PIC  X(0001).
   754     05  APFKI PIC  S99.
   755 01  EL608AO REDEFINES EL608AI.
   756     05  FILLER            PIC  X(0012).
   757*    -------------------------------
   758     05  FILLER            PIC  X(0003).
   759     05  ADATEO PIC  X(0008).
   760*    -------------------------------
   761     05  FILLER            PIC  X(0003).
   762     05  ATIMEO PIC  99.99.
   763*    -------------------------------
   764     05  FILLER            PIC  X(0003).
   765     05  AMAINTO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL608.cbl
   766*    -------------------------------
   767     05  FILLER            PIC  X(0003).
   768     05  SCODE01O PIC  X(0003).
   769*    -------------------------------
   770     05  FILLER            PIC  X(0003).
   771     05  START01O PIC  X(0010).
   772*    -------------------------------
   773     05  FILLER            PIC  X(0003).
   774     05  END01O PIC  X(0010).
   775*    -------------------------------
   776     05  FILLER            PIC  X(0003).
   777     05  RCODE01O PIC  X(0003).
   778*    -------------------------------
   779     05  FILLER            PIC  X(0003).
   780     05  SCODE02O PIC  X(0003).
   781*    -------------------------------
   782     05  FILLER            PIC  X(0003).
   783     05  START02O PIC  X(0010).
   784*    -------------------------------
   785     05  FILLER            PIC  X(0003).
   786     05  END02O PIC  X(0010).
   787*    -------------------------------
   788     05  FILLER            PIC  X(0003).
   789     05  RCODE02O PIC  X(0003).
   790*    -------------------------------
   791     05  FILLER            PIC  X(0003).
   792     05  SCODE03O PIC  X(0003).
   793*    -------------------------------
   794     05  FILLER            PIC  X(0003).
   795     05  START03O PIC  X(0010).
   796*    -------------------------------
   797     05  FILLER            PIC  X(0003).
   798     05  END03O PIC  X(0010).
   799*    -------------------------------
   800     05  FILLER            PIC  X(0003).
   801     05  RCODE03O PIC  X(0003).
   802*    -------------------------------
   803     05  FILLER            PIC  X(0003).
   804     05  SCODE04O PIC  X(0003).
   805*    -------------------------------
   806     05  FILLER            PIC  X(0003).
   807     05  START04O PIC  X(0010).
   808*    -------------------------------
   809     05  FILLER            PIC  X(0003).
   810     05  END04O PIC  X(0010).
   811*    -------------------------------
   812     05  FILLER            PIC  X(0003).
   813     05  RCODE04O PIC  X(0003).
   814*    -------------------------------
   815     05  FILLER            PIC  X(0003).
   816     05  SCODE05O PIC  X(0003).
   817*    -------------------------------
   818     05  FILLER            PIC  X(0003).
   819     05  START05O PIC  X(0010).
   820*    -------------------------------
   821     05  FILLER            PIC  X(0003).
   822     05  END05O PIC  X(0010).
   823*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL608.cbl
   824     05  FILLER            PIC  X(0003).
   825     05  RCODE05O PIC  X(0003).
   826*    -------------------------------
   827     05  FILLER            PIC  X(0003).
   828     05  SCODE06O PIC  X(0003).
   829*    -------------------------------
   830     05  FILLER            PIC  X(0003).
   831     05  START06O PIC  X(0010).
   832*    -------------------------------
   833     05  FILLER            PIC  X(0003).
   834     05  END06O PIC  X(0010).
   835*    -------------------------------
   836     05  FILLER            PIC  X(0003).
   837     05  RCODE06O PIC  X(0003).
   838*    -------------------------------
   839     05  FILLER            PIC  X(0003).
   840     05  SCODE07O PIC  X(0003).
   841*    -------------------------------
   842     05  FILLER            PIC  X(0003).
   843     05  START07O PIC  X(0010).
   844*    -------------------------------
   845     05  FILLER            PIC  X(0003).
   846     05  END07O PIC  X(0010).
   847*    -------------------------------
   848     05  FILLER            PIC  X(0003).
   849     05  RCODE07O PIC  X(0003).
   850*    -------------------------------
   851     05  FILLER            PIC  X(0003).
   852     05  SCODE08O PIC  X(0003).
   853*    -------------------------------
   854     05  FILLER            PIC  X(0003).
   855     05  START08O PIC  X(0010).
   856*    -------------------------------
   857     05  FILLER            PIC  X(0003).
   858     05  END08O PIC  X(0010).
   859*    -------------------------------
   860     05  FILLER            PIC  X(0003).
   861     05  RCODE08O PIC  X(0003).
   862*    -------------------------------
   863     05  FILLER            PIC  X(0003).
   864     05  SCODE09O PIC  X(0003).
   865*    -------------------------------
   866     05  FILLER            PIC  X(0003).
   867     05  START09O PIC  X(0010).
   868*    -------------------------------
   869     05  FILLER            PIC  X(0003).
   870     05  END09O PIC  X(0010).
   871*    -------------------------------
   872     05  FILLER            PIC  X(0003).
   873     05  RCODE09O PIC  X(0003).
   874*    -------------------------------
   875     05  FILLER            PIC  X(0003).
   876     05  SCODE10O PIC  X(0003).
   877*    -------------------------------
   878     05  FILLER            PIC  X(0003).
   879     05  START10O PIC  X(0010).
   880*    -------------------------------
   881     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL608.cbl
   882     05  END10O PIC  X(0010).
   883*    -------------------------------
   884     05  FILLER            PIC  X(0003).
   885     05  RCODE10O PIC  X(0003).
   886*    -------------------------------
   887     05  FILLER            PIC  X(0003).
   888     05  AEMSG1O PIC  X(0079).
   889*    -------------------------------
   890     05  FILLER            PIC  X(0003).
   891     05  AEMSG2O PIC  X(0079).
   892*    -------------------------------
   893     05  FILLER            PIC  X(0003).
   894     05  APFKO PIC  X(0002).
   895*    -------------------------------
   896 01  EL608AO-R REDEFINES EL608AI.
   897     05  FILLER                      PIC X(35).
   898     05  WS-MAP-LINE                 OCCURS 10
   899                                     INDEXED BY M1.
   900         10  SCODEL                  PIC S9(4)  COMP.
   901         10  SCODEA                  PIC X.
   902         10  SCODEO                  PIC XXX.
   903         10  SCODEI                  REDEFINES
   904             SCODEO                  PIC XXX.
   905         10  STARTL                  PIC S9(4)   COMP.
   906         10  STARTA                  PIC X.
   907         10  STARTO                  PIC X(10).
   908         10  STARTI                  REDEFINES
   909             STARTO                  PIC X(10).
   910         10  ENDL                    PIC S9(4)   COMP.
   911         10  ENDA                    PIC X.
   912         10  ENDO                    PIC X(10).
   913         10  ENDI                    REDEFINES
   914             ENDO                    PIC X(10).
   915         10  RCODEL                  PIC S9(4)   COMP.
   916         10  RCODEA                  PIC X.
   917         10  RCODEO                  PIC XXX.
   918         10  RCODEI                  REDEFINES
   919             RCODEO                  PIC XXX.
   920*    COPY ELCJPFX.
   921******************************************************************
   922*                                                                *
   923*                                                                *
   924*                            ELCJPFX.                            *
   925*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   926*                            VMOD=2.002                          *
   927*                                                                *
   928*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   929*                                                                *
   930*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   931*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   932*        ELCNTL - CONTROL FILE                                   *
   933*        ELMSTR - CLAIM MASTERS                                  *
   934*        ELTRLR - ACTIVITY TRAILERS                              *
   935*        ELCHKQ - CHECK QUE                                      *
   936******************************************************************
   937 01  JOURNAL-RECORD.
   938     12  JP-USER-ID                  PIC X(4).
   939     12  JP-FILE-ID                  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL608.cbl
   940     12  JP-PROGRAM-ID               PIC X(8).
   941     12  JP-RECORD-TYPE              PIC X.
   942         88 JP-ADD              VALUE 'A'.
   943         88 JP-BEFORE-CHANGE    VALUE 'B'.
   944         88 JP-AFTER-CHANGE     VALUE 'C'.
   945         88 JP-DELETE           VALUE 'D'.
   946         88 JP-GENERIC-DELETE   VALUE 'G'.
   947         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   948         88 JP-KEY-CHG-ADD      VALUE 'N'.
   949     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   950     12  JP-RECORD-AREA
   951
   952
   953                                     PIC X(750).
   954*    COPY ELCEMIB.
   955******************************************************************
   956*                                                                *
   957*                                                                *
   958*                            ELCEMIB.                            *
   959*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   960*                            VMOD=2.005                          *
   961*                                                                *
   962*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   963*                                                                *
   964******************************************************************
   965 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   966     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   967     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   968     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   969     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   970     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   971     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   972     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   973     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   974     12  EMI-SWITCH1             PIC X        VALUE '1'.
   975         88  EMI-NO-ERRORS                    VALUE '1'.
   976         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   977         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   978     12  EMI-SWITCH2             PIC X        VALUE '1'.
   979         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   980     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   981         88  EMI-AREA1-EMPTY                  VALUE '1'.
   982         88  EMI-AREA1-FULL                   VALUE '2'.
   983     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   984         88  EMI-AREA2-EMPTY                  VALUE '1'.
   985         88  EMI-AREA2-FULL                   VALUE '2'.
   986     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   987         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   988         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   989         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   990         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   991         88  EMI-BYPASS-FATALS                VALUE 'X'.
   992     12  EMI-ERROR-LINES.
   993         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   994         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   995         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   996         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   997             20  EMI-ERR-CODES OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL608.cbl
   998                 24  EMI-ERR-NUM         PIC X(4).
   999                 24  EMI-FILLER          PIC X.
  1000                 24  EMI-SEV             PIC X.
  1001                 24  FILLER              PIC X.
  1002             20  FILLER                  PIC X(02).
  1003     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1004         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1005             20  EMI-ERROR-NUMBER    PIC X(4).
  1006             20  EMI-FILL            PIC X.
  1007             20  EMI-SEVERITY        PIC X.
  1008             20  FILLER              PIC X.
  1009             20  EMI-ERROR-TEXT.
  1010                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1011                 24  FILLER          PIC X(55).
  1012     12  EMI-SEVERITY-SAVE           PIC X.
  1013         88  EMI-NOTE                    VALUE 'N'.
  1014         88  EMI-WARNING                 VALUE 'W'.
  1015         88  EMI-FORCABLE                VALUE 'F'.
  1016         88  EMI-FATAL                   VALUE 'X'.
  1017     12  EMI-MESSAGE-FLAG            PIC X.
  1018         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1019         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1020     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1021     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1022         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1023         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1024         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1025     12  FILLER                      PIC X(137)  VALUE SPACES.
  1026     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1027     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1028     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1029     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1030*    COPY ELCDATE.
  1031******************************************************************
  1032*                                                                *
  1033*                                                                *
  1034*                            ELCDATE.                            *
  1035*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1036*                            VMOD=2.003
  1037*                                                                *
  1038*                                                                *
  1039*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1040*                 LENGTH = 200                                   *
  1041******************************************************************
  1042
  1043 01  DATE-CONVERSION-DATA.
  1044     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1045     12  DC-OPTION-CODE                PIC X.
  1046         88  BIN-TO-GREG                VALUE ' '.
  1047         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1048         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1049         88  YMD-GREG-TO-BIN            VALUE '3'.
  1050         88  MDY-GREG-TO-BIN            VALUE '4'.
  1051         88  JULIAN-TO-BIN              VALUE '5'.
  1052         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1053         88  FIND-CENTURY               VALUE '7'.
  1054         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1055         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL608.cbl
  1056         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1057         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1058         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1059         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1060         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1061         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1062         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1063         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1064         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1065         88  BIN-3-TO-GREG              VALUE 'I'.
  1066         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1067         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1068         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1069         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1070         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1071         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1072         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1073         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1074         88  THREE-CHARACTER-BIN
  1075                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1076         88  GREGORIAN-TO-BIN
  1077                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1078         88  BIN-TO-GREGORIAN
  1079                  VALUES ' ' '1' 'I' '8' 'G'.
  1080         88  JULIAN-TO-BINARY
  1081                  VALUES '5' 'C' 'E' 'F'.
  1082     12  DC-ERROR-CODE                 PIC X.
  1083         88  NO-CONVERSION-ERROR        VALUE ' '.
  1084         88  DATE-CONVERSION-ERROR
  1085                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1086         88  DATE-IS-ZERO               VALUE '1'.
  1087         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  1088         88  DATE-IS-INVALID            VALUE '3'.
  1089         88  DATE1-GREATER-DATE2        VALUE '4'.
  1090         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1091         88  DATE-INVALID-OPTION        VALUE '9'.
  1092         88  INVALID-CENTURY            VALUE 'A'.
  1093         88  ONLY-CENTURY               VALUE 'B'.
  1094         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1095         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1096     12  DC-END-OF-MONTH               PIC X.
  1097         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1098     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1099         88  USE-NORMAL-PROCESS         VALUE ' '.
  1100         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1101         88  ADJUST-UP-100-YRS          VALUE '2'.
  1102     12  FILLER                        PIC X.
  1103     12  DC-CONVERSION-DATES.
  1104         16  DC-BIN-DATE-1             PIC XX.
  1105         16  DC-BIN-DATE-2             PIC XX.
  1106         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1107         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1108                       DC-GREG-DATE-1-EDIT.
  1109             20  DC-EDIT1-MONTH        PIC 99.
  1110             20  SLASH1-1              PIC X.
  1111             20  DC-EDIT1-DAY          PIC 99.
  1112             20  SLASH1-2              PIC X.
  1113             20  DC-EDIT1-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL608.cbl
  1114         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1115         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1116                     DC-GREG-DATE-2-EDIT.
  1117             20  DC-EDIT2-MONTH        PIC 99.
  1118             20  SLASH2-1              PIC X.
  1119             20  DC-EDIT2-DAY          PIC 99.
  1120             20  SLASH2-2              PIC X.
  1121             20  DC-EDIT2-YEAR         PIC 99.
  1122         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1123         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1124                     DC-GREG-DATE-1-YMD.
  1125             20  DC-YMD-YEAR           PIC 99.
  1126             20  DC-YMD-MONTH          PIC 99.
  1127             20  DC-YMD-DAY            PIC 99.
  1128         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1129         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1130                      DC-GREG-DATE-1-MDY.
  1131             20  DC-MDY-MONTH          PIC 99.
  1132             20  DC-MDY-DAY            PIC 99.
  1133             20  DC-MDY-YEAR           PIC 99.
  1134         16  DC-GREG-DATE-1-ALPHA.
  1135             20  DC-ALPHA-MONTH        PIC X(10).
  1136             20  DC-ALPHA-DAY          PIC 99.
  1137             20  FILLER                PIC XX.
  1138             20  DC-ALPHA-CENTURY.
  1139                 24 DC-ALPHA-CEN-N     PIC 99.
  1140             20  DC-ALPHA-YEAR         PIC 99.
  1141         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1142         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1143         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1144         16  DC-JULIAN-DATE            PIC 9(05).
  1145         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1146                                       PIC 9(05).
  1147         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1148             20  DC-JULIAN-YEAR        PIC 99.
  1149             20  DC-JULIAN-DAYS        PIC 999.
  1150         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1151         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1152         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1153     12  DATE-CONVERSION-VARIBLES.
  1154         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1155         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1156             20  FILLER                PIC 9(3).
  1157             20  HOLD-CEN-1-CCYY.
  1158                 24  HOLD-CEN-1-CC     PIC 99.
  1159                 24  HOLD-CEN-1-YY     PIC 99.
  1160             20  HOLD-CEN-1-MO         PIC 99.
  1161             20  HOLD-CEN-1-DA         PIC 99.
  1162         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1163             20  HOLD-CEN-1-R-MO       PIC 99.
  1164             20  HOLD-CEN-1-R-DA       PIC 99.
  1165             20  HOLD-CEN-1-R-CCYY.
  1166                 24  HOLD-CEN-1-R-CC   PIC 99.
  1167                 24  HOLD-CEN-1-R-YY   PIC 99.
  1168             20  FILLER                PIC 9(3).
  1169         16  HOLD-CENTURY-1-X.
  1170             20  FILLER                PIC X(3)  VALUE SPACES.
  1171             20  HOLD-CEN-1-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL608.cbl
  1172                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1173                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1174             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1175             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1176         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1177             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1178             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1179             20  HOLD-CEN-1-R-X-CCYY.
  1180                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1181                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1182             20  FILLER                PIC XXX.
  1183         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1184         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1185         16  DC-JULIAN-DATE-1          PIC 9(07).
  1186         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1187             20  DC-JULIAN-1-CCYY.
  1188                 24  DC-JULIAN-1-CC    PIC 99.
  1189                 24  DC-JULIAN-1-YR    PIC 99.
  1190             20  DC-JULIAN-DA-1        PIC 999.
  1191         16  DC-JULIAN-DATE-2          PIC 9(07).
  1192         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1193             20  DC-JULIAN-2-CCYY.
  1194                 24  DC-JULIAN-2-CC    PIC 99.
  1195                 24  DC-JULIAN-2-YR    PIC 99.
  1196             20  DC-JULIAN-DA-2        PIC 999.
  1197         16  DC-GREG-DATE-A-EDIT.
  1198             20  DC-EDITA-MONTH        PIC 99.
  1199             20  SLASHA-1              PIC X VALUE '/'.
  1200             20  DC-EDITA-DAY          PIC 99.
  1201             20  SLASHA-2              PIC X VALUE '/'.
  1202             20  DC-EDITA-CCYY.
  1203                 24  DC-EDITA-CENT     PIC 99.
  1204                 24  DC-EDITA-YEAR     PIC 99.
  1205         16  DC-GREG-DATE-B-EDIT.
  1206             20  DC-EDITB-MONTH        PIC 99.
  1207             20  SLASHB-1              PIC X VALUE '/'.
  1208             20  DC-EDITB-DAY          PIC 99.
  1209             20  SLASHB-2              PIC X VALUE '/'.
  1210             20  DC-EDITB-CCYY.
  1211                 24  DC-EDITB-CENT     PIC 99.
  1212                 24  DC-EDITB-YEAR     PIC 99.
  1213         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1214         16  DC-GREG-DATE-CYMD-R REDEFINES
  1215                              DC-GREG-DATE-CYMD.
  1216             20  DC-CYMD-CEN           PIC 99.
  1217             20  DC-CYMD-YEAR          PIC 99.
  1218             20  DC-CYMD-MONTH         PIC 99.
  1219             20  DC-CYMD-DAY           PIC 99.
  1220         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1221         16  DC-GREG-DATE-MDCY-R REDEFINES
  1222                              DC-GREG-DATE-MDCY.
  1223             20  DC-MDCY-MONTH         PIC 99.
  1224             20  DC-MDCY-DAY           PIC 99.
  1225             20  DC-MDCY-CEN           PIC 99.
  1226             20  DC-MDCY-YEAR          PIC 99.
  1227    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1228        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1229    12  DC-EL310-DATE                  PIC X(21).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL608.cbl
  1230    12  FILLER                         PIC X(28).
  1231*    COPY ELCLOGOF.
  1232******************************************************************
  1233*                                                                *
  1234*                                                                *
  1235*                            ELCLOGOF.                           *
  1236*                            VMOD=2.001                          *
  1237*                                                                *
  1238*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1239*                                                                *
  1240******************************************************************
  1241 01  CLASIC-LOGOFF.
  1242     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1243     12  LOGOFF-TEXT.
  1244         16  FILLER          PIC X(5)    VALUE SPACES.
  1245         16  LOGOFF-MSG.
  1246             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1247             20  FILLER      PIC X       VALUE SPACES.
  1248             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1249         16  FILLER          PIC X(80)
  1250           VALUE '* YOU ARE NOW LOGGED OFF'.
  1251         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1252         16  FILLER          PIC X       VALUE QUOTE.
  1253         16  LOGOFF-SYS-MSG  PIC X(17)
  1254           VALUE 'S CLAS-IC SYSTEM '.
  1255     12  TEXT-MESSAGES.
  1256         16  UNACCESS-MSG    PIC X(29)
  1257             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1258         16  PGMIDERR-MSG    PIC X(17)
  1259             VALUE 'PROGRAM NOT FOUND'.
  1260*    COPY ELCATTR.
  1261******************************************************************
  1262*                                                                *
  1263*                            ELCATTR.                            *
  1264*                            VMOD=2.001                          *
  1265*                                                                *
  1266*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1267*                                                                *
  1268*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1269*                                                                *
  1270*                   POS 1   P=PROTECTED                          *
  1271*                           U=UNPROTECTED                        *
  1272*                           S=ASKIP                              *
  1273*                   POS 2   A=ALPHA/NUMERIC                      *
  1274*                           N=NUMERIC                            *
  1275*                   POS 3   N=NORMAL                             *
  1276*                           B=BRIGHT                             *
  1277*                           D=DARK                               *
  1278*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1279*                           OF=MODIFIED DATA TAG OFF             *
  1280*                                                                *
  1281*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1282******************************************************************
  1283 01  ATTRIBUTE-LIST.
  1284     12  AL-PABOF            PIC X       VALUE 'Y'.
  1285     12  AL-PABON            PIC X       VALUE 'Z'.
  1286     12  AL-PADOF            PIC X       VALUE '%'.
  1287     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL608.cbl
  1288     12  AL-PANOF            PIC X       VALUE '-'.
  1289     12  AL-PANON            PIC X       VALUE '/'.
  1290     12  AL-SABOF            PIC X       VALUE '8'.
  1291     12  AL-SABON            PIC X       VALUE '9'.
  1292     12  AL-SADOF            PIC X       VALUE '@'.
  1293     12  AL-SADON            PIC X       VALUE QUOTE.
  1294     12  AL-SANOF            PIC X       VALUE '0'.
  1295     12  AL-SANON            PIC X       VALUE '1'.
  1296     12  AL-UABOF            PIC X       VALUE 'H'.
  1297     12  AL-UABON            PIC X       VALUE 'I'.
  1298     12  AL-UADOF            PIC X       VALUE '<'.
  1299     12  AL-UADON            PIC X       VALUE '('.
  1300     12  AL-UANOF            PIC X       VALUE ' '.
  1301     12  AL-UANON            PIC X       VALUE 'A'.
  1302     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1303     12  AL-UNBON            PIC X       VALUE 'R'.
  1304     12  AL-UNDOF            PIC X       VALUE '*'.
  1305     12  AL-UNDON            PIC X       VALUE ')'.
  1306     12  AL-UNNOF            PIC X       VALUE '&'.
  1307     12  AL-UNNON            PIC X       VALUE 'J'.
  1308*    COPY ELCAID.
  1309******************************************************************
  1310*                                                                *
  1311*                            ELCAID.                             *
  1312*                            VMOD=2.001                          *
  1313*                                                                *
  1314*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1315*                                                                *
  1316*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1317*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1318******************************************************************
  1319
  1320 01  DFHAID.
  1321   02  DFHNULL   PIC  X  VALUE  ' '.
  1322   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1323   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1324   02  DFHPEN    PIC  X  VALUE  '='.
  1325   02  DFHOPID   PIC  X  VALUE  'W'.
  1326   02  DFHPA1    PIC  X  VALUE  '%'.
  1327   02  DFHPA2    PIC  X  VALUE  '>'.
  1328   02  DFHPA3    PIC  X  VALUE  ','.
  1329   02  DFHPF1    PIC  X  VALUE  '1'.
  1330   02  DFHPF2    PIC  X  VALUE  '2'.
  1331   02  DFHPF3    PIC  X  VALUE  '3'.
  1332   02  DFHPF4    PIC  X  VALUE  '4'.
  1333   02  DFHPF5    PIC  X  VALUE  '5'.
  1334   02  DFHPF6    PIC  X  VALUE  '6'.
  1335   02  DFHPF7    PIC  X  VALUE  '7'.
  1336   02  DFHPF8    PIC  X  VALUE  '8'.
  1337   02  DFHPF9    PIC  X  VALUE  '9'.
  1338   02  DFHPF10   PIC  X  VALUE  ':'.
  1339   02  DFHPF11   PIC  X  VALUE  '#'.
  1340   02  DFHPF12   PIC  X  VALUE  '@'.
  1341   02  DFHPF13   PIC  X  VALUE  'A'.
  1342   02  DFHPF14   PIC  X  VALUE  'B'.
  1343   02  DFHPF15   PIC  X  VALUE  'C'.
  1344   02  DFHPF16   PIC  X  VALUE  'D'.
  1345   02  DFHPF17   PIC  X  VALUE  'E'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL608.cbl
  1346   02  DFHPF18   PIC  X  VALUE  'F'.
  1347   02  DFHPF19   PIC  X  VALUE  'G'.
  1348   02  DFHPF20   PIC  X  VALUE  'H'.
  1349   02  DFHPF21   PIC  X  VALUE  'I'.
  1350*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1351   02  DFHPF22   PIC  X  VALUE  '['.
  1352   02  DFHPF23   PIC  X  VALUE  '.'.
  1353   02  DFHPF24   PIC  X  VALUE  '<'.
  1354   02  DFHMSRE   PIC  X  VALUE  'X'.
  1355   02  DFHSTRF   PIC  X  VALUE  'h'.
  1356   02  DFHTRIG   PIC  X  VALUE  '"'.
  1357 01  FILLER    REDEFINES DFHAID.
  1358     05  FILLER                      PIC X(8).
  1359     05  PF-VALUES                   PIC X
  1360         OCCURS 24 TIMES.
  1361*                                COPY ELCCIIR.
  1362******************************************************************
  1363*                                                                *
  1364*                                                                *
  1365*                            ELCCIIR.                            *
  1366*                            VMOD=2.001                          *
  1367*                                                                *
  1368*   FILE DESCRIPTION = LIFE CLAIM INTEREST RATES                 *
  1369*                                                                *
  1370*   FILE TYPE = VSAM,KSDS                                        *
  1371*   RECORD SIZE = 100  RECFORM = FIXED                           *
  1372*                                                                *
  1373*   BASE CLUSTER = ELCIIR                        RKP=2,LEN=04    *
  1374*       ALTERNATE INDEX = NONE                                   *
  1375*                                                                *
  1376*   LOG = YES                                                    *
  1377*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1378******************************************************************
  1379*                   C H A N G E   L O G
  1380*
  1381* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1382*-----------------------------------------------------------------
  1383*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1384* EFFECTIVE    NUMBER
  1385*-----------------------------------------------------------------
  1386* 053105                   PEMA  NEW FILE AND COPYBOOK
  1387******************************************************************
  1388*
  1389 01  CLAIM-INTEREST-IR.
  1390     12  IR-RECORD-ID                       PIC XX.
  1391         88  VALID-IR-ID                        VALUE 'IR'.
  1392     12  IR-CONTROL-PRIMARY.
  1393         16  IR-COMPANY-CD                  PIC X.
  1394         16  IR-INT-RATE-CODE               PIC XXX.
  1395     12  IR-LAST-MAINT-BY                   PIC X(4).
  1396     12  IR-LAST-MAINT-DT                   PIC XX.
  1397     12  IR-LAST-MAINT-HHMMSS               PIC S9(6) COMP-3.
  1398     12  IR-DESCRIPTION                     PIC X(25).
  1399     12  IR-INT-RATE                        PIC S99V9(5).
  1400     12  FILLER                             PIC X(52).
  1401****************************************************************
  1402*
  1403* Copyright (c) 2007 by Clerity Solutions, Inc.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL608.cbl
  1404* All rights reserved.
  1405*
  1406****************************************************************
  1407 01  DFHEIV.
  1408   02  DFHEIV0               PIC X(35).
  1409   02  DFHEIV1               PIC X(08).
  1410   02  DFHEIV2               PIC X(08).
  1411   02  DFHEIV3               PIC X(08).
  1412   02  DFHEIV4               PIC X(06).
  1413   02  DFHEIV5               PIC X(04).
  1414   02  DFHEIV6               PIC X(04).
  1415   02  DFHEIV7               PIC X(02).
  1416   02  DFHEIV8               PIC X(02).
  1417   02  DFHEIV9               PIC X(01).
  1418   02  DFHEIV10              PIC S9(7) COMP-3.
  1419   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1420   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1421   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1422   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1423   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1424   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1425   02  DFHEIV17              PIC X(04).
  1426   02  DFHEIV18              PIC X(04).
  1427   02  DFHEIV19              PIC X(04).
  1428   02  DFHEIV20              USAGE IS POINTER.
  1429   02  DFHEIV21              USAGE IS POINTER.
  1430   02  DFHEIV22              USAGE IS POINTER.
  1431   02  DFHEIV23              USAGE IS POINTER.
  1432   02  DFHEIV24              USAGE IS POINTER.
  1433   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1434   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1435   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1436   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1437   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1438   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1439   02  FILLER                PIC X(02).
  1440   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1441   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1442   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1443   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1444   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1445 LINKAGE  SECTION.
  1446*****************************************************************
  1447*                                                               *
  1448* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1449* All rights reserved.                                          *
  1450*                                                               *
  1451*****************************************************************
  1452 01  dfheiblk.
  1453     02  eibtime          pic s9(7) comp-3.
  1454     02  eibdate          pic s9(7) comp-3.
  1455     02  eibtrnid         pic x(4).
  1456     02  eibtaskn         pic s9(7) comp-3.
  1457     02  eibtrmid         pic x(4).
  1458     02  dfheigdi         pic s9(4) comp.
  1459     02  eibcposn         pic s9(4) comp.
  1460     02  eibcalen         pic s9(4) comp.
  1461     02  eibaid           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL608.cbl
  1462     02  eibfiller1       pic x(1).
  1463     02  eibfn            pic x(2).
  1464     02  eibfiller2       pic x(2).
  1465     02  eibrcode         pic x(6).
  1466     02  eibfiller3       pic x(2).
  1467     02  eibds            pic x(8).
  1468     02  eibreqid         pic x(8).
  1469     02  eibrsrce         pic x(8).
  1470     02  eibsync          pic x(1).
  1471     02  eibfree          pic x(1).
  1472     02  eibrecv          pic x(1).
  1473     02  eibsend          pic x(1).
  1474     02  eibatt           pic x(1).
  1475     02  eibeoc           pic x(1).
  1476     02  eibfmh           pic x(1).
  1477     02  eibcompl         pic x(1).
  1478     02  eibsig           pic x(1).
  1479     02  eibconf          pic x(1).
  1480     02  eiberr           pic x(1).
  1481     02  eibrldbk         pic x(1).
  1482     02  eiberrcd         pic x(4).
  1483     02  eibsynrb         pic x(1).
  1484     02  eibnodat         pic x(1).
  1485     02  eibfiller5       pic x(2).
  1486     02  eibresp          pic 9(09) comp.
  1487     02  eibresp2         pic 9(09) comp.
  1488     02  dfheigdj         pic s9(4) comp.
  1489     02  dfheigdk         pic s9(4) comp.
  1490 01  DFHCOMMAREA                     PIC X(1024).
  1491*    COPY ELCCIST.
  1492******************************************************************
  1493*                                                                *
  1494*                                                                *
  1495*                            ELCCIST.                            *
  1496*                            VMOD=2.001                          *
  1497*                                                                *
  1498*   FILE DESCRIPTION = LIFE CLAIM INTEREST SCHEDULE TABLE        *
  1499*                                                                *
  1500*   FILE TYPE = VSAM,KSDS                                        *
  1501*   RECORD SIZE = 100  RECFORM = FIXED                           *
  1502*                                                                *
  1503*   BASE CLUSTER = ELCIST                        RKP=2,LEN=06    *
  1504*       ALTERNATE INDEX = NONE                                   *
  1505*                                                                *
  1506*   LOG = YES                                                    *
  1507*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1508******************************************************************
  1509*                   C H A N G E   L O G
  1510*
  1511* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1512*-----------------------------------------------------------------
  1513*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1514* EFFECTIVE    NUMBER
  1515*-----------------------------------------------------------------
  1516* 053105                   PEMA  NEW FILE AND COPYBOOK
  1517******************************************************************
  1518*
  1519 01  CLAIM-INTEREST-ST.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL608.cbl
  1520     12  ST-RECORD-ID                       PIC XX.
  1521         88  VALID-ST-ID                        VALUE 'ST'.
  1522     12  ST-CONTROL-PRIMARY.
  1523         16  ST-COMPANY-CD                  PIC X.
  1524         16  ST-SCHED-CODE                  PIC XXX.
  1525         16  ST-END-DATE                    PIC XX.
  1526     12  ST-LAST-MAINT-BY                   PIC X(4).
  1527     12  ST-LAST-MAINT-DT                   PIC XX.
  1528     12  ST-LAST-MAINT-HHMMSS               PIC S9(6) COMP-3.
  1529     12  ST-START-DATE                      PIC XX.
  1530     12  ST-INT-RATE-CODE                   PIC XXX.
  1531     12  FILLER                             PIC X(77).
  1532 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-INTEREST-ST.
  1533 0000-DFHEXIT SECTION.
  1534     MOVE '9#                    $   ' TO DFHEIV0.
  1535     MOVE 'EL608' TO DFHEIV1.
  1536     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1537     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  1538     MOVE '5'                   TO DC-OPTION-CODE.
  1539     PERFORM 8500-DATE-CONVERSION
  1540                                THRU 8500-EXIT
  1541     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  1542     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  1543     MOVE DFHCOMMAREA           TO  PROGRAM-INTERFACE-BLOCK.
  1544     MOVE +2                    TO  EMI-NUMBER-OF-LINES
  1545                                    EMI-SWITCH2.
  1546     IF EIBCALEN NOT > ZERO
  1547        MOVE UNACCESS-MSG        TO LOGOFF-MSG
  1548        GO TO 8300-SEND-TEXT
  1549     END-IF
  1550
  1551* EXEC CICS HANDLE CONDITION
  1552*        PGMIDERR (9600-PGMIDERR)
  1553*        ERROR    (9990-ERROR)
  1554*    END-EXEC
  1555*    MOVE '"$L.                  ! " #00001546' TO DFHEIV0
  1556     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1557     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1558     MOVE X'2220233030303031353436' TO DFHEIV0(25:11)
  1559     CALL 'kxdfhei1' USING DFHEIV0
  1560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1561     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1562        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1563           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  1564           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  1565           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  1566           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  1567           MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  1568           MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  1569           MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  1570           MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  1571        ELSE
  1572           MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  1573           MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  1574           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  1575           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  1576           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  1577           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL608.cbl
  1578           MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  1579           MOVE SPACES               TO  PI-SAVED-PROGRAM-6
  1580        END-IF
  1581     END-IF
  1582     IF EIBTRNID NOT = WS-TRANS-ID
  1583        GO TO 1000-INITIAL-SCREEN
  1584     END-IF
  1585     IF EIBAID = DFHCLEAR
  1586        GO TO 9400-CLEAR
  1587     END-IF
  1588     IF NOT SYSTEM-DISPLAY-CAP
  1589        MOVE 'READ'              TO SM-READ
  1590        PERFORM 9995-SECURITY-VIOLATION
  1591        MOVE ER-0070             TO EMI-ERROR
  1592        PERFORM 9900-ERROR-FORMAT
  1593                                 THRU 9900-EXIT
  1594        GO TO 8100-SEND-INITIAL-MAP
  1595     END-IF
  1596     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1597        MOVE LOW-VALUES          TO EL608AO
  1598        MOVE -1                  TO APFKL
  1599        MOVE ER-0008             TO EMI-ERROR
  1600        GO TO 8200-SEND-DATAONLY
  1601     END-IF
  1602
  1603* EXEC CICS RECEIVE
  1604*        INTO   (EL608AO)
  1605*        MAPSET (WS-MAPSET-NAME)
  1606*        MAP    (WS-MAP-NAME)
  1607*    END-EXEC
  1608     MOVE LENGTH OF
  1609      EL608AO
  1610       TO DFHEIV11
  1611*    MOVE '8"T I  L              ''   #00001591' TO DFHEIV0
  1612     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1613     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1614     MOVE X'2020233030303031353931' TO DFHEIV0(25:11)
  1615     CALL 'kxdfhei1' USING DFHEIV0,
  1616           WS-MAP-NAME,
  1617           EL608AO,
  1618           DFHEIV11,
  1619           WS-MAPSET-NAME,
  1620           DFHEIV99,
  1621           DFHEIV99
  1622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1623     IF APFKL > ZERO
  1624        IF EIBAID NOT = DFHENTER
  1625           MOVE ER-0004          TO EMI-ERROR
  1626           MOVE AL-UNBOF         TO APFKA
  1627           MOVE -1               TO APFKL
  1628           GO TO 8200-SEND-DATAONLY
  1629        ELSE
  1630           IF APFKO NUMERIC AND
  1631              (APFKO > ZERO AND LESS '25')
  1632              MOVE PF-VALUES (APFKI)
  1633                                 TO  EIBAID
  1634           ELSE
  1635              MOVE ER-0029       TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL608.cbl
  1636              MOVE AL-UNBOF      TO  APFKA
  1637              MOVE -1            TO  APFKL
  1638              GO TO 8200-SEND-DATAONLY
  1639           END-IF
  1640        END-IF
  1641     END-IF
  1642     IF EIBAID = DFHPF12
  1643        MOVE 'EL010'             TO THIS-PGM
  1644        GO TO 9300-XCTL
  1645     END-IF
  1646     IF EIBAID = DFHPF23
  1647        GO TO 9000-RETURN-CICS
  1648     END-IF
  1649     IF EIBAID = DFHPF24
  1650        IF CREDIT-SESSION
  1651           MOVE 'EL626'          TO THIS-PGM
  1652           GO TO 9300-XCTL
  1653        ELSE
  1654           MOVE 'EL126'          TO THIS-PGM
  1655           GO TO 9300-XCTL
  1656        END-IF
  1657     END-IF
  1658     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2
  1659        CONTINUE
  1660     ELSE
  1661        MOVE ER-0008             TO EMI-ERROR
  1662        MOVE -1                  TO APFKL
  1663        GO TO 8200-SEND-DATAONLY
  1664     END-IF
  1665     IF AMAINTL > ZERO
  1666        IF AMAINTI = 'A' OR 'C' OR 'D' OR 'S'
  1667           MOVE AL-UANON         TO AMAINTA
  1668           MOVE AMAINTI          TO PI-MODE
  1669        ELSE
  1670           MOVE AL-UABOF         TO AMAINTA
  1671           MOVE -1               TO AMAINTL
  1672           MOVE ER-0023          TO EMI-ERROR
  1673           PERFORM 9900-ERROR-FORMAT
  1674        END-IF
  1675     ELSE
  1676        IF EIBAID = DFHPF1 OR DFHPF2
  1677           MOVE 'S'              TO PI-MODE
  1678        ELSE
  1679           MOVE AL-UABOF         TO AMAINTA
  1680           MOVE -1               TO AMAINTL
  1681           MOVE ER-0023          TO EMI-ERROR
  1682           PERFORM 9900-ERROR-FORMAT
  1683        END-IF
  1684     END-IF
  1685     IF SYSTEM-MODIFY-CAP
  1686        CONTINUE
  1687     ELSE
  1688        IF AMAINTI = 'A' OR 'C' OR 'D'
  1689           MOVE 'UPDATE'         TO SM-READ
  1690           PERFORM 9995-SECURITY-VIOLATION
  1691           MOVE ER-0070          TO EMI-ERROR
  1692           MOVE -1               TO  AMAINTL
  1693           MOVE AL-UABON         TO  AMAINTA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL608.cbl
  1694           GO TO 8200-SEND-DATAONLY
  1695        END-IF
  1696     END-IF
  1697     IF EMI-FATAL-CTR > ZERO
  1698        GO TO 8200-SEND-DATAONLY
  1699     END-IF
  1700     IF PI-MODE EQUAL 'S'
  1701        GO TO 2000-PROCESS-SHOW
  1702     END-IF
  1703     IF PI-MODE EQUAL 'C'
  1704        GO TO 3000-PROCESS-CHANGE
  1705     END-IF
  1706     IF PI-MODE EQUAL 'A'
  1707        GO TO 5000-PROCESS-ADD
  1708     END-IF
  1709     IF PI-MODE EQUAL 'D'
  1710        GO TO 6000-PROCESS-DELETE
  1711     END-IF
  1712     MOVE 'LOGIC ERROR HAS OCCURRED - PROGRAM EL608'
  1713                                 TO  LOGOFF-MSG.
  1714     GO TO 8300-SEND-TEXT.
  1715     .
  1716 1000-INITIAL-SCREEN.
  1717     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA
  1718     MOVE PI-COMPANY-CD          TO PI-CI-TOP-KEY (1:1)
  1719                                    PI-CI-BOT-KEY (1:1)
  1720     MOVE ZERO                   TO PI-1ST-TIME-SW
  1721                                    PI-LINE-COUNT
  1722                                    PI-BROWSE-SW
  1723                                    PI-SHOW-SW
  1724                                    PI-CHANGE-SW
  1725     MOVE LOW-VALUES             TO EL608AO
  1726     MOVE -1                     TO AMAINTL
  1727     MOVE +2                     TO WS-COMPLETED-SUCCESSFUL
  1728     GO TO 8100-SEND-INITIAL-MAP
  1729     .
  1730 2000-PROCESS-SHOW.
  1731*IF THE USER PRIMED THE FIRST SCHED CODE THEN USE IT TO BROWSE
  1732     IF SCODEL (1) > +0
  1733        MOVE SCODEI (1)          TO PI-CI-BOT-KEY (2:3)
  1734                                    PI-CI-TOP-KEY (2:3)
  1735     END-IF
  1736     EVALUATE EIBAID
  1737        WHEN DFHPF2
  1738           MOVE PI-CI-TOP-KEY    TO WS-CONTROL-PRIMARY
  1739           GO TO 8000-BROWSE-BWD
  1740        WHEN DFHPF1
  1741           MOVE PI-CI-BOT-KEY    TO WS-CONTROL-PRIMARY
  1742           GO TO 7000-BROWSE-FWD
  1743        WHEN OTHER
  1744           MOVE PI-COMPANY-CD    TO WS-CONTROL-PRIMARY
  1745           GO TO 7000-BROWSE-FWD
  1746     END-EVALUATE
  1747*    IF EIBAID = DFHPF2
  1748*       MOVE PI-CI-TOP-KEY       TO WS-CONTROL-PRIMARY
  1749*       GO TO 8000-BROWSE-BWD
  1750*    ELSE
  1751*       MOVE PI-CI-BOT-KEY       TO WS-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL608.cbl
  1752*       GO TO 7000-BROWSE-FWD
  1753*    END-IF
  1754     MOVE +1                     TO  PI-SHOW-SW
  1755     GO TO 7000-BROWSE-FWD
  1756     .
  1757*****************************************************************
  1758 3000-PROCESS-CHANGE.
  1759*****************************************************************
  1760     SET M1                      TO +1
  1761     MOVE +1                     TO CI1
  1762     PERFORM UNTIL
  1763        M1 > +10
  1764        IF (STARTL (M1) > +0)
  1765           OR (RCODEL (M1) > +0)
  1766           PERFORM 6010-EDIT-DATA
  1767                                 THRU 6010-EXIT
  1768        END-IF
  1769        SET M1                   UP BY +1
  1770        ADD +1                   TO CI1
  1771     END-PERFORM
  1772     IF NOT EMI-NO-ERRORS
  1773        GO TO 8200-SEND-DATAONLY
  1774     END-IF
  1775     SET M1                      TO +1
  1776     MOVE +1                     TO CI1
  1777     PERFORM UNTIL
  1778        M1 > +10
  1779        IF (STARTL (M1) > +0)
  1780           OR (RCODEL (M1) > +0)
  1781           PERFORM 6030-UPDATE-RECORD
  1782                                 THRU 6030-EXIT
  1783        END-IF
  1784        SET M1                   UP BY +1
  1785        ADD +1                   TO CI1
  1786     END-PERFORM
  1787     MOVE PI-CI-TOP-KEY          TO WS-CONTROL-PRIMARY
  1788     GO TO 7000-BROWSE-FWD
  1789     .
  1790*****************************************************************
  1791 5000-PROCESS-ADD.
  1792*****************************************************************
  1793     SET M1                      TO +1
  1794     MOVE +1                     TO CI1
  1795     PERFORM UNTIL
  1796        M1 > +10
  1797        IF (SCODEL    (M1) > +0)
  1798           OR (ENDL   (M1) > +0)
  1799           PERFORM 6020-EDIT-KEY-DATA
  1800                                 THRU 6020-EXIT
  1801           PERFORM 6010-EDIT-DATA
  1802                                 THRU 6010-EXIT
  1803        END-IF
  1804        SET M1                   UP BY +1
  1805        ADD +1                   TO CI1
  1806     END-PERFORM
  1807     IF NOT EMI-NO-ERRORS
  1808        GO TO 8200-SEND-DATAONLY
  1809     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL608.cbl
  1810     SET M1                      TO +1
  1811     MOVE +1                     TO CI1
  1812     PERFORM UNTIL
  1813        M1 > +10
  1814        IF SCODEL (M1) > +0
  1815           PERFORM 6060-ADD-RECORD
  1816                                 THRU 6060-EXIT
  1817        END-IF
  1818        SET M1                   UP BY +1
  1819        ADD +1                   TO CI1
  1820     END-PERFORM
  1821     SET M1                      TO +1
  1822     MOVE +1                     TO CI1
  1823     MOVE PI-CI-TOP-KEY          TO WS-CONTROL-PRIMARY
  1824     GO TO 7000-BROWSE-FWD
  1825     .
  1826*****************************************************************
  1827 6000-PROCESS-DELETE.
  1828*****************************************************************
  1829     SET M1                      TO +1
  1830** THE WAY THIS WORKS IS YOU HAVE TO SPACE OUT THE SCHED CODE
  1831** FOR THE DELETE TO WORK
  1832     PERFORM UNTIL
  1833        M1 > +10
  1834        IF ((SCODEL   (M1) > +0)
  1835           AND(SCODEI (M1) = SPACES))
  1836           PERFORM 6050-DELETE-RECORD
  1837                                 THRU 6050-EXIT
  1838        END-IF
  1839        SET M1                   UP BY +1
  1840     END-PERFORM
  1841     MOVE PI-CI-TOP-KEY          TO WS-CONTROL-PRIMARY
  1842     GO TO 7000-BROWSE-FWD
  1843     .
  1844 6010-EDIT-DATA.
  1845     IF STARTL (M1) > +0
  1846        MOVE STARTI (M1)         TO DEEDIT-FIELD
  1847
  1848* EXEC CICS BIF DEEDIT
  1849*           FIELD   (DEEDIT-FIELD)
  1850*           LENGTH  (10)
  1851*       END-EXEC
  1852     MOVE 10
  1853       TO DFHEIV11
  1854*    MOVE '@"L                   #   #00001820' TO DFHEIV0
  1855     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  1856     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1857     MOVE X'2020233030303031383230' TO DFHEIV0(25:11)
  1858     CALL 'kxdfhei1' USING DFHEIV0,
  1859           DEEDIT-FIELD,
  1860           DFHEIV11
  1861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1862        IF DEEDIT-FIELD-V0 NUMERIC
  1863           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-MDCY
  1864           MOVE 'M'              TO DC-OPTION-CODE
  1865           PERFORM 8500-DATE-CONVERSION
  1866                                 THRU 8500-EXIT
  1867           IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL608.cbl
  1868              SET CI1            TO M1
  1869              MOVE DC-BIN-DATE-1 TO WS-BIN-START-DATE (CI1)
  1870           ELSE
  1871              MOVE ER-3801       TO EMI-ERROR
  1872              PERFORM 9900-ERROR-FORMAT
  1873              MOVE DEEDIT-FIELD  TO STARTO (M1)
  1874              MOVE AL-UABON      TO STARTA (M1)
  1875              MOVE -1            TO STARTL (M1)
  1876           END-IF
  1877        ELSE
  1878           MOVE ER-3801          TO EMI-ERROR
  1879           PERFORM 9900-ERROR-FORMAT
  1880           MOVE DEEDIT-FIELD     TO STARTO (M1)
  1881           MOVE AL-UABON         TO STARTA (M1)
  1882           MOVE -1               TO STARTL (M1)
  1883        END-IF
  1884     ELSE
  1885        IF ADD-FUNCTION
  1886           MOVE ER-3801          TO EMI-ERROR
  1887           PERFORM 9900-ERROR-FORMAT
  1888           MOVE AL-UABON         TO STARTA (M1)
  1889           MOVE -1               TO STARTL (M1)
  1890        END-IF
  1891     END-IF
  1892     IF RCODEL (M1) > +0
  1893        IF RCODEI (M1) NOT = SPACES
  1894           PERFORM 6015-EDIT-RCODE
  1895                                 THRU 6015-EXIT
  1896        ELSE
  1897           MOVE ER-3809          TO EMI-ERROR
  1898           PERFORM 9900-ERROR-FORMAT
  1899           MOVE AL-UABON         TO RCODEA (M1)
  1900           MOVE -1               TO RCODEL (M1)
  1901        END-IF
  1902     ELSE
  1903        IF ADD-FUNCTION
  1904           MOVE ER-3809          TO EMI-ERROR
  1905           PERFORM 9900-ERROR-FORMAT
  1906           MOVE AL-UABON         TO RCODEA (M1)
  1907           MOVE -1               TO RCODEL (M1)
  1908        END-IF
  1909     END-IF
  1910     .
  1911 6010-EXIT.
  1912     EXIT.
  1913 6015-EDIT-RCODE.
  1914     MOVE PI-COMPANY-CD          TO WS-IR-COMPANY-CD
  1915     MOVE RCODEI (M1)            TO WS-IR-INT-RATE-CODE
  1916
  1917* EXEC CICS READ
  1918*       DATASET ('ELCIIR')
  1919*       INTO    (CLAIM-INTEREST-IR)
  1920*       RIDFLD  (WS-IR-CONTROL-PRIMARY)
  1921*       RESP    (WS-RESPONSE)
  1922*    END-EXEC
  1923     MOVE LENGTH OF
  1924      CLAIM-INTEREST-IR
  1925       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL608.cbl
  1926     MOVE 'ELCIIR' TO DFHEIV1
  1927*    MOVE '&"IL       E          (  N#00001878' TO DFHEIV0
  1928     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1929     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1930     MOVE X'204E233030303031383738' TO DFHEIV0(25:11)
  1931     CALL 'kxdfhei1' USING DFHEIV0,
  1932           DFHEIV1,
  1933           CLAIM-INTEREST-IR,
  1934           DFHEIV11,
  1935           WS-IR-CONTROL-PRIMARY,
  1936           DFHEIV99,
  1937           DFHEIV99,
  1938           DFHEIV99
  1939     MOVE EIBRESP  TO WS-RESPONSE
  1940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1941     IF NOT RESP-NORMAL
  1942        MOVE ER-3809             TO EMI-ERROR
  1943        PERFORM 9900-ERROR-FORMAT
  1944        MOVE AL-UABON            TO RCODEA (M1)
  1945        MOVE -1                  TO RCODEL (M1)
  1946     END-IF
  1947     .
  1948 6015-EXIT.
  1949     EXIT.
  1950 6020-EDIT-KEY-DATA.
  1951     IF (SCODEL    (M1) > +0)
  1952        AND (ENDL  (M1) > +0)
  1953        CONTINUE
  1954     ELSE
  1955        MOVE ER-3804             TO EMI-ERROR
  1956        PERFORM 9900-ERROR-FORMAT
  1957        MOVE AL-UABON            TO SCODEA (M1)
  1958        MOVE AL-UABON            TO ENDA   (M1)
  1959        MOVE -1                  TO SCODEL (M1)
  1960        GO TO 6020-EXIT
  1961     END-IF
  1962     IF ENDL (M1) > +0
  1963        MOVE ENDI (M1)          TO DEEDIT-FIELD
  1964
  1965* EXEC CICS BIF DEEDIT
  1966*           FIELD   (DEEDIT-FIELD)
  1967*           LENGTH  (10)
  1968*       END-EXEC
  1969     MOVE 10
  1970       TO DFHEIV11
  1971*    MOVE '@"L                   #   #00001907' TO DFHEIV0
  1972     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  1973     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1974     MOVE X'2020233030303031393037' TO DFHEIV0(25:11)
  1975     CALL 'kxdfhei1' USING DFHEIV0,
  1976           DEEDIT-FIELD,
  1977           DFHEIV11
  1978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1979        IF DEEDIT-FIELD-V0 NUMERIC
  1980           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-MDCY
  1981           MOVE 'M'              TO DC-OPTION-CODE
  1982           PERFORM 8500-DATE-CONVERSION
  1983                                 THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL608.cbl
  1984           IF NO-CONVERSION-ERROR
  1985              SET CI1            TO M1
  1986              MOVE DC-BIN-DATE-1 TO WS-BIN-END-DATE (CI1)
  1987           ELSE
  1988              MOVE ER-3801       TO EMI-ERROR
  1989              PERFORM 9900-ERROR-FORMAT
  1990              MOVE DEEDIT-FIELD  TO ENDO (M1)
  1991              MOVE AL-UABON      TO ENDA (M1)
  1992              MOVE -1            TO ENDL (M1)
  1993           END-IF
  1994        ELSE
  1995           MOVE ER-3801          TO EMI-ERROR
  1996           PERFORM 9900-ERROR-FORMAT
  1997           MOVE DEEDIT-FIELD     TO ENDO (M1)
  1998           MOVE AL-UABON         TO ENDA (M1)
  1999           MOVE -1               TO ENDL (M1)
  2000        END-IF
  2001     ELSE
  2002        MOVE ER-3801             TO EMI-ERROR
  2003        PERFORM 9900-ERROR-FORMAT
  2004        MOVE AL-UABON            TO ENDA (M1)
  2005        MOVE -1                  TO ENDL (M1)
  2006     END-IF
  2007     .
  2008 6020-EXIT.
  2009     EXIT.
  2010 6030-UPDATE-RECORD.
  2011     SET CI1            TO M1
  2012     MOVE PI-CI-KEY (CI1)        TO WS-CONTROL-PRIMARY
  2013
  2014* EXEC CICS READ
  2015*       UPDATE
  2016*       DATASET ('ELCIST')
  2017*       SET     (ADDRESS OF CLAIM-INTEREST-ST)
  2018*       RIDFLD  (WS-CONTROL-PRIMARY)
  2019*       RESP    (WS-RESPONSE)
  2020*    END-EXEC
  2021     MOVE 'ELCIST' TO DFHEIV1
  2022*    MOVE '&"S        EU         (  N#00001945' TO DFHEIV0
  2023     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2024     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2025     MOVE X'204E233030303031393435' TO DFHEIV0(25:11)
  2026     CALL 'kxdfhei1' USING DFHEIV0,
  2027           DFHEIV1,
  2028           DFHEIV20,
  2029           DFHEIV99,
  2030           WS-CONTROL-PRIMARY,
  2031           DFHEIV99,
  2032           DFHEIV99,
  2033           DFHEIV99
  2034     SET ADDRESS OF CLAIM-INTEREST-ST TO
  2035         DFHEIV20
  2036     MOVE EIBRESP  TO WS-RESPONSE
  2037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2038     IF NOT RESP-NORMAL
  2039        GO TO 6030-UPDATE-ERROR
  2040     END-IF
  2041     IF RCODEL (M1) > +0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL608.cbl
  2042        MOVE RCODEI (M1)         TO ST-INT-RATE-CODE
  2043     END-IF
  2044     IF STARTL (M1) > +0
  2045        MOVE WS-BIN-START-DATE (CI1)
  2046                                 TO ST-START-DATE
  2047     END-IF
  2048     MOVE PI-PROCESSOR-ID        TO ST-LAST-MAINT-BY
  2049     MOVE EIBTIME                TO ST-LAST-MAINT-HHMMSS
  2050     MOVE SAVE-BIN-DATE          TO ST-LAST-MAINT-DT
  2051
  2052* EXEC CICS REWRITE
  2053*       DATASET    ('ELCIST')
  2054*       FROM       (CLAIM-INTEREST-ST)
  2055*       RESP       (WS-RESPONSE)
  2056*    END-EXEC
  2057     MOVE LENGTH OF
  2058      CLAIM-INTEREST-ST
  2059       TO DFHEIV11
  2060     MOVE 'ELCIST' TO DFHEIV1
  2061*    MOVE '&& L                  %  N#00001965' TO DFHEIV0
  2062     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2063     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2064     MOVE X'204E233030303031393635' TO DFHEIV0(25:11)
  2065     CALL 'kxdfhei1' USING DFHEIV0,
  2066           DFHEIV1,
  2067           CLAIM-INTEREST-ST,
  2068           DFHEIV11,
  2069           DFHEIV99
  2070     MOVE EIBRESP  TO WS-RESPONSE
  2071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2072     IF RESP-NORMAL
  2073        GO TO 6030-EXIT
  2074     END-IF
  2075     .
  2076 6030-UPDATE-ERROR.
  2077     MOVE ER-3807                TO EMI-ERROR
  2078     PERFORM 9900-ERROR-FORMAT
  2079     MOVE AL-UABON               TO SCODEA (M1)
  2080     MOVE -1                     TO SCODEL (M1)
  2081     GO TO 8200-SEND-DATAONLY
  2082     .
  2083 6030-EXIT.
  2084     EXIT.
  2085 6050-DELETE-RECORD.
  2086     SET CI1                     TO M1
  2087     MOVE PI-CI-KEY (CI1)        TO WS-CONTROL-PRIMARY
  2088
  2089* EXEC CICS READ
  2090*       UPDATE
  2091*       DATASET ('ELCIST')
  2092*       SET     (ADDRESS OF CLAIM-INTEREST-ST)
  2093*       RIDFLD  (WS-CONTROL-PRIMARY)
  2094*       RESP    (WS-RESPONSE)
  2095*    END-EXEC
  2096     MOVE 'ELCIST' TO DFHEIV1
  2097*    MOVE '&"S        EU         (  N#00001986' TO DFHEIV0
  2098     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2099     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL608.cbl
  2100     MOVE X'204E233030303031393836' TO DFHEIV0(25:11)
  2101     CALL 'kxdfhei1' USING DFHEIV0,
  2102           DFHEIV1,
  2103           DFHEIV20,
  2104           DFHEIV99,
  2105           WS-CONTROL-PRIMARY,
  2106           DFHEIV99,
  2107           DFHEIV99,
  2108           DFHEIV99
  2109     SET ADDRESS OF CLAIM-INTEREST-ST TO
  2110         DFHEIV20
  2111     MOVE EIBRESP  TO WS-RESPONSE
  2112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2113     IF NOT RESP-NORMAL
  2114        GO TO 6050-DELETE-ERROR
  2115     END-IF
  2116
  2117* EXEC CICS DELETE
  2118*       DATASET ('ELCIST')
  2119*       RESP    (WS-RESPONSE)
  2120*    END-EXEC
  2121     MOVE 'ELCIST' TO DFHEIV1
  2122*    MOVE '&(                    &  N#00001996' TO DFHEIV0
  2123     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2124     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2125     MOVE X'204E233030303031393936' TO DFHEIV0(25:11)
  2126     CALL 'kxdfhei1' USING DFHEIV0,
  2127           DFHEIV1,
  2128           DFHEIV99,
  2129           DFHEIV99,
  2130           DFHEIV99,
  2131           DFHEIV99
  2132     MOVE EIBRESP  TO WS-RESPONSE
  2133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2134     IF RESP-NORMAL
  2135        GO TO 6050-EXIT
  2136     END-IF
  2137     .
  2138 6050-DELETE-ERROR.
  2139     MOVE ER-1079                TO EMI-ERROR
  2140     PERFORM 9900-ERROR-FORMAT
  2141     MOVE AL-UABON               TO SCODEA (M1)
  2142     MOVE -1                     TO SCODEL (M1)
  2143     .
  2144 6050-EXIT.
  2145     EXIT.
  2146 6060-ADD-RECORD.
  2147     SET CI1            TO M1
  2148     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
  2149     MOVE SCODEI (M1)            TO WS-SCHED-CODE
  2150     MOVE WS-BIN-END-DATE (CI1)  TO WS-END-DT
  2151
  2152* EXEC CICS READ
  2153*       DATASET ('ELCIST')
  2154*       SET     (ADDRESS OF CLAIM-INTEREST-ST)
  2155*       RIDFLD  (WS-CONTROL-PRIMARY)
  2156*       RESP    (WS-RESPONSE)
  2157*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL608.cbl
  2158     MOVE 'ELCIST' TO DFHEIV1
  2159*    MOVE '&"S        E          (  N#00002017' TO DFHEIV0
  2160     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2162     MOVE X'204E233030303032303137' TO DFHEIV0(25:11)
  2163     CALL 'kxdfhei1' USING DFHEIV0,
  2164           DFHEIV1,
  2165           DFHEIV20,
  2166           DFHEIV99,
  2167           WS-CONTROL-PRIMARY,
  2168           DFHEIV99,
  2169           DFHEIV99,
  2170           DFHEIV99
  2171     SET ADDRESS OF CLAIM-INTEREST-ST TO
  2172         DFHEIV20
  2173     MOVE EIBRESP  TO WS-RESPONSE
  2174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2175     IF RESP-NORMAL
  2176        GO TO 6060-ADD-ERROR
  2177     END-IF
  2178
  2179* EXEC CICS GETMAIN
  2180*       LENGTH   (ELCIST-LENGTH)
  2181*       SET      (ADDRESS OF CLAIM-INTEREST-ST)
  2182*       INITIMG  (GETMAIN-SPACE)
  2183*    END-EXEC
  2184*    MOVE ',"IL                  $   #00002026' TO DFHEIV0
  2185     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  2186     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2187     MOVE X'2020233030303032303236' TO DFHEIV0(25:11)
  2188     CALL 'kxdfhei1' USING DFHEIV0,
  2189           DFHEIV20,
  2190           ELCIST-LENGTH,
  2191           GETMAIN-SPACE
  2192     SET ADDRESS OF CLAIM-INTEREST-ST TO
  2193         DFHEIV20
  2194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2195     MOVE PI-COMPANY-CD          TO ST-COMPANY-CD
  2196     MOVE SCODEI (M1)            TO ST-SCHED-CODE
  2197     MOVE WS-BIN-END-DATE (CI1)  TO ST-END-DATE
  2198     MOVE WS-BIN-START-DATE (CI1)
  2199                                 TO ST-START-DATE
  2200     MOVE RCODEI (M1)            TO ST-INT-RATE-CODE
  2201     MOVE PI-PROCESSOR-ID        TO ST-LAST-MAINT-BY
  2202     MOVE EIBTIME                TO ST-LAST-MAINT-HHMMSS
  2203     MOVE SAVE-BIN-DATE          TO ST-LAST-MAINT-DT
  2204
  2205* EXEC CICS WRITE
  2206*       DATASET    ('ELCIST')
  2207*       FROM       (CLAIM-INTEREST-ST)
  2208*       RIDFLD     (ST-CONTROL-PRIMARY)
  2209*       RESP       (WS-RESPONSE)
  2210*    END-EXEC
  2211     MOVE LENGTH OF
  2212      CLAIM-INTEREST-ST
  2213       TO DFHEIV11
  2214     MOVE 'ELCIST' TO DFHEIV1
  2215*    MOVE '&$ L                  ''  N#00002040' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL608.cbl
  2216     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2217     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2218     MOVE X'204E233030303032303430' TO DFHEIV0(25:11)
  2219     CALL 'kxdfhei1' USING DFHEIV0,
  2220           DFHEIV1,
  2221           CLAIM-INTEREST-ST,
  2222           DFHEIV11,
  2223           ST-CONTROL-PRIMARY,
  2224           DFHEIV99,
  2225           DFHEIV99
  2226     MOVE EIBRESP  TO WS-RESPONSE
  2227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2228     IF RESP-NORMAL
  2229        GO TO 6060-EXIT
  2230     END-IF
  2231     .
  2232 6060-ADD-ERROR.
  2233     MOVE ER-3806                TO EMI-ERROR
  2234     PERFORM 9900-ERROR-FORMAT
  2235     MOVE AL-UABON               TO SCODEA (M1)
  2236     MOVE -1                     TO SCODEL (M1)
  2237     .
  2238 6060-EXIT.
  2239     EXIT.
  2240 7000-BROWSE-FWD.
  2241     SET M1  TO +1
  2242
  2243* EXEC CICS STARTBR
  2244*        DATASET   ('ELCIST')
  2245*        RIDFLD    (WS-CONTROL-PRIMARY)
  2246*        GTEQ
  2247*        RESP      (WS-RESPONSE)
  2248*    END-EXEC
  2249     MOVE 'ELCIST' TO DFHEIV1
  2250     MOVE 0
  2251       TO DFHEIV11
  2252*    MOVE '&,         G          &  N#00002060' TO DFHEIV0
  2253     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2254     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2255     MOVE X'204E233030303032303630' TO DFHEIV0(25:11)
  2256     CALL 'kxdfhei1' USING DFHEIV0,
  2257           DFHEIV1,
  2258           WS-CONTROL-PRIMARY,
  2259           DFHEIV99,
  2260           DFHEIV11,
  2261           DFHEIV99
  2262     MOVE EIBRESP  TO WS-RESPONSE
  2263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2264     EVALUATE TRUE
  2265        WHEN RESP-ENDFILE
  2266           GO TO 7030-END-FILE
  2267        WHEN RESP-NORMAL
  2268           CONTINUE
  2269        WHEN RESP-NOTFND
  2270           GO TO 7040-NOT-FOUND
  2271     END-EVALUATE
  2272     MOVE LOW-VALUES             TO EL608AO
  2273     MOVE ZERO                   TO PI-LINE-COUNT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL608.cbl
  2274     MOVE +1                     TO PI-BROWSE-SW
  2275     MOVE +0                     TO CI1
  2276     .
  2277 7010-READ-NEXT.
  2278
  2279* EXEC CICS READNEXT
  2280*        SET     (ADDRESS OF CLAIM-INTEREST-ST)
  2281*        DATASET ('ELCIST')
  2282*        RIDFLD  (WS-CONTROL-PRIMARY)
  2283*        RESP    (WS-RESPONSE)
  2284*    END-EXEC
  2285     MOVE 'ELCIST' TO DFHEIV1
  2286     MOVE 0
  2287       TO DFHEIV11
  2288*    MOVE '&.S                   )  N#00002080' TO DFHEIV0
  2289     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2290     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2291     MOVE X'204E233030303032303830' TO DFHEIV0(25:11)
  2292     CALL 'kxdfhei1' USING DFHEIV0,
  2293           DFHEIV1,
  2294           DFHEIV20,
  2295           DFHEIV99,
  2296           WS-CONTROL-PRIMARY,
  2297           DFHEIV99,
  2298           DFHEIV11,
  2299           DFHEIV99,
  2300           DFHEIV99
  2301     SET ADDRESS OF CLAIM-INTEREST-ST TO
  2302         DFHEIV20
  2303     MOVE EIBRESP  TO WS-RESPONSE
  2304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2305     EVALUATE TRUE
  2306        WHEN RESP-ENDFILE
  2307           GO TO 7030-END-FILE
  2308        WHEN RESP-NORMAL
  2309           CONTINUE
  2310        WHEN RESP-NOTFND
  2311           GO TO 7040-NOT-FOUND
  2312     END-EVALUATE
  2313     IF ST-COMPANY-CD NOT = PI-COMPANY-CD
  2314        GO TO 7030-END-FILE
  2315     END-IF
  2316     ADD +1                      TO WS-RECORD-COUNT
  2317                                    CI1
  2318     MOVE ST-CONTROL-PRIMARY     TO PI-CI-BOT-KEY
  2319                                    PI-CI-KEY (CI1)
  2320     MOVE ST-SCHED-CODE          TO SCODEO (M1)
  2321     MOVE ST-END-DATE            TO DC-BIN-DATE-1
  2322     MOVE ' '                    TO DC-OPTION-CODE
  2323     PERFORM 8500-DATE-CONVERSION THRU 8500-EXIT
  2324     IF NO-CONVERSION-ERROR
  2325        MOVE DC-GREG-DATE-A-EDIT TO ENDO   (M1)
  2326     END-IF
  2327     MOVE ST-START-DATE          TO DC-BIN-DATE-1
  2328     MOVE ' '                    TO DC-OPTION-CODE
  2329     PERFORM 8500-DATE-CONVERSION THRU 8500-EXIT
  2330     IF NO-CONVERSION-ERROR
  2331        MOVE DC-GREG-DATE-A-EDIT TO STARTO (M1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL608.cbl
  2332     END-IF
  2333     MOVE ST-INT-RATE-CODE       TO RCODEO (M1)
  2334     IF M1 = +1
  2335        MOVE ST-CONTROL-PRIMARY  TO PI-CI-TOP-KEY
  2336     END-IF
  2337     IF M1 < +10
  2338        SET M1 UP BY +1
  2339        GO TO 7010-READ-NEXT
  2340     END-IF
  2341     IF PI-BROWSE-SW = +1
  2342
  2343* EXEC CICS ENDBR
  2344*            DATASET ('ELCIST')
  2345*       END-EXEC
  2346     MOVE 'ELCIST' TO DFHEIV1
  2347     MOVE 0
  2348       TO DFHEIV11
  2349*    MOVE '&2                    $   #00002123' TO DFHEIV0
  2350     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2351     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2352     MOVE X'2020233030303032313233' TO DFHEIV0(25:11)
  2353     CALL 'kxdfhei1' USING DFHEIV0,
  2354           DFHEIV1,
  2355           DFHEIV11,
  2356           DFHEIV99
  2357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2358        MOVE +0                  TO PI-BROWSE-SW
  2359     END-IF
  2360     MOVE ER-0000                TO EMI-ERROR
  2361     GO TO 8100-SEND-INITIAL-MAP
  2362     .
  2363 7030-END-FILE.
  2364     IF EMI-ERROR = ER-1257
  2365        MOVE ER-7220             TO  EMI-ERROR
  2366     ELSE
  2367        MOVE ER-1258             TO  EMI-ERROR
  2368     END-IF
  2369     MOVE -1                     TO  AMAINTL
  2370     MOVE AL-UABOF               TO  AMAINTA
  2371     GO TO 8100-SEND-INITIAL-MAP
  2372     .
  2373 7040-NOT-FOUND.
  2374     MOVE ER-0006                TO  EMI-ERROR
  2375     MOVE -1                     TO  AMAINTL
  2376     MOVE AL-UABOF               TO  AMAINTA
  2377     GO TO 8200-SEND-DATAONLY
  2378     .
  2379*****************************************************************
  2380 8000-BROWSE-BWD.
  2381*****************************************************************
  2382     SET M1                      TO +10
  2383     MOVE +11                    TO CI1
  2384
  2385* EXEC CICS STARTBR
  2386*        DATASET ('ELCIST')
  2387*        RIDFLD  (WS-CONTROL-PRIMARY)
  2388*        GTEQ
  2389*        RESP    (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL608.cbl
  2390*    END-EXEC
  2391     MOVE 'ELCIST' TO DFHEIV1
  2392     MOVE 0
  2393       TO DFHEIV11
  2394*    MOVE '&,         G          &  N#00002152' TO DFHEIV0
  2395     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2396     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2397     MOVE X'204E233030303032313532' TO DFHEIV0(25:11)
  2398     CALL 'kxdfhei1' USING DFHEIV0,
  2399           DFHEIV1,
  2400           WS-CONTROL-PRIMARY,
  2401           DFHEIV99,
  2402           DFHEIV11,
  2403           DFHEIV99
  2404     MOVE EIBRESP  TO WS-RESPONSE
  2405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2406     EVALUATE TRUE
  2407        WHEN RESP-ENDFILE
  2408           GO TO 8020-END-FILE
  2409        WHEN RESP-NORMAL
  2410           CONTINUE
  2411        WHEN RESP-NOTFND
  2412           GO TO 8030-NOT-FOUND
  2413     END-EVALUATE
  2414     MOVE LOW-VALUES             TO EL608AO
  2415     MOVE ZERO                   TO PI-LINE-COUNT
  2416     MOVE +1                     TO PI-BROWSE-SW
  2417     .
  2418 8010-READ-PREV.
  2419
  2420* EXEC CICS READPREV
  2421*        SET     (ADDRESS OF CLAIM-INTEREST-ST)
  2422*        DATASET ('ELCIST')
  2423*        RIDFLD  (WS-CONTROL-PRIMARY)
  2424*        RESP    (WS-RESPONSE)
  2425*    END-EXEC
  2426     MOVE 'ELCIST' TO DFHEIV1
  2427     MOVE 0
  2428       TO DFHEIV11
  2429*    MOVE '&0S                   )  N#00002171' TO DFHEIV0
  2430     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  2431     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2432     MOVE X'204E233030303032313731' TO DFHEIV0(25:11)
  2433     CALL 'kxdfhei1' USING DFHEIV0,
  2434           DFHEIV1,
  2435           DFHEIV20,
  2436           DFHEIV99,
  2437           WS-CONTROL-PRIMARY,
  2438           DFHEIV99,
  2439           DFHEIV11,
  2440           DFHEIV99,
  2441           DFHEIV99
  2442     SET ADDRESS OF CLAIM-INTEREST-ST TO
  2443         DFHEIV20
  2444     MOVE EIBRESP  TO WS-RESPONSE
  2445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2446     EVALUATE TRUE
  2447        WHEN RESP-ENDFILE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL608.cbl
  2448           GO TO 8020-END-FILE
  2449        WHEN RESP-NORMAL
  2450           CONTINUE
  2451        WHEN RESP-NOTFND
  2452           GO TO 8030-NOT-FOUND
  2453     END-EVALUATE
  2454     IF ST-COMPANY-CD NOT = PI-COMPANY-CD
  2455        GO TO 8020-END-FILE
  2456     END-IF
  2457     ADD +1                      TO WS-RECORD-COUNT
  2458     SUBTRACT +1                 FROM CI1
  2459     MOVE ST-CONTROL-PRIMARY     TO PI-CI-TOP-KEY
  2460                                    PI-CI-KEY (CI1)
  2461     MOVE ST-SCHED-CODE          TO SCODEO (M1)
  2462     MOVE ST-END-DATE            TO DC-BIN-DATE-1
  2463     MOVE ' '                    TO DC-OPTION-CODE
  2464     PERFORM 8500-DATE-CONVERSION THRU 8500-EXIT
  2465     IF NO-CONVERSION-ERROR
  2466        MOVE DC-GREG-DATE-A-EDIT TO ENDO   (M1)
  2467     END-IF
  2468     MOVE ST-START-DATE          TO DC-BIN-DATE-1
  2469     MOVE ' '                    TO DC-OPTION-CODE
  2470     PERFORM 8500-DATE-CONVERSION THRU 8500-EXIT
  2471     IF NO-CONVERSION-ERROR
  2472        MOVE DC-GREG-DATE-A-EDIT TO STARTO (M1)
  2473     END-IF
  2474     MOVE ST-INT-RATE-CODE       TO RCODEO (M1)
  2475     IF M1 = +10
  2476        MOVE ST-CONTROL-PRIMARY  TO PI-CI-BOT-KEY
  2477     END-IF
  2478     IF M1 > +1
  2479        SET M1                   DOWN BY +1
  2480        GO TO 8010-READ-PREV
  2481     END-IF
  2482     IF PI-BROWSE-SW = +1
  2483
  2484* EXEC CICS ENDBR
  2485*            DATASET ('ELCIST')
  2486*       END-EXEC
  2487     MOVE 'ELCIST' TO DFHEIV1
  2488     MOVE 0
  2489       TO DFHEIV11
  2490*    MOVE '&2                    $   #00002214' TO DFHEIV0
  2491     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2492     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2493     MOVE X'2020233030303032323134' TO DFHEIV0(25:11)
  2494     CALL 'kxdfhei1' USING DFHEIV0,
  2495           DFHEIV1,
  2496           DFHEIV11,
  2497           DFHEIV99
  2498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2499        MOVE +0                  TO PI-BROWSE-SW
  2500     END-IF
  2501     MOVE ER-0000                TO EMI-ERROR
  2502     GO TO 8100-SEND-INITIAL-MAP
  2503     .
  2504 8020-END-FILE.
  2505     IF M1 > +1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL608.cbl
  2506        MOVE PI-CI-TOP-KEY       TO WS-CONTROL-PRIMARY
  2507        MOVE ER-1257             TO EMI-ERROR
  2508        GO TO 7000-BROWSE-FWD
  2509     END-IF
  2510     MOVE ER-1257                TO EMI-ERROR
  2511     MOVE -1                     TO  AMAINTL
  2512     MOVE AL-UABOF               TO  AMAINTA
  2513     GO TO 8100-SEND-INITIAL-MAP
  2514     .
  2515 8030-NOT-FOUND.
  2516     MOVE ER-0006                TO  EMI-ERROR
  2517     MOVE -1                     TO  AMAINTL
  2518     MOVE AL-UABOF               TO  AMAINTA
  2519     GO TO 8200-SEND-DATAONLY
  2520     .
  2521*****************************************************************
  2522 8100-SEND-INITIAL-MAP.
  2523*****************************************************************
  2524     MOVE -1                     TO  AMAINTL.
  2525     MOVE ZERO                   TO  PI-BROWSE-SW.
  2526     MOVE SAVE-DATE              TO  ADATEO.
  2527     MOVE EIBTIME                TO  TIME-IN.
  2528     MOVE TIME-OUT               TO  ATIMEO.
  2529     IF EMI-ERROR NOT = ZERO
  2530         PERFORM 9900-ERROR-FORMAT
  2531     END-IF
  2532     MOVE EMI-MESSAGE-AREA (1)    TO  AEMSG1O.
  2533     MOVE EMI-MESSAGE-AREA (2)    TO  AEMSG2O.
  2534
  2535* EXEC CICS SEND
  2536*        FROM   (EL608AO)
  2537*        MAPSET (WS-MAPSET-NAME)
  2538*        MAP    (WS-MAP-NAME)
  2539*        CURSOR ERASE
  2540*    END-EXEC.
  2541     MOVE LENGTH OF
  2542      EL608AO
  2543       TO DFHEIV12
  2544     MOVE -1
  2545       TO DFHEIV11
  2546*    MOVE '8$     CT  E    H L F ,   #00002252' TO DFHEIV0
  2547     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2548     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2549     MOVE X'2020233030303032323532' TO DFHEIV0(25:11)
  2550     CALL 'kxdfhei1' USING DFHEIV0,
  2551           WS-MAP-NAME,
  2552           EL608AO,
  2553           DFHEIV12,
  2554           WS-MAPSET-NAME,
  2555           DFHEIV99,
  2556           DFHEIV99,
  2557           DFHEIV99,
  2558           DFHEIV11,
  2559           DFHEIV99,
  2560           DFHEIV99,
  2561           DFHEIV99
  2562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2563
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL608.cbl
  2564     GO TO 9100-RETURN-TRAN
  2565     .
  2566 8100-EXIT.
  2567      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL608.cbl
  2569*****************************************************************
  2570 8200-SEND-DATAONLY.
  2571*****************************************************************
  2572     MOVE SAVE-DATE              TO  ADATEO.
  2573     MOVE EIBTIME                TO  TIME-IN.
  2574     MOVE TIME-OUT               TO  ATIMEO.
  2575     IF EMI-ERROR NOT = ZERO
  2576         PERFORM 9900-ERROR-FORMAT.
  2577     MOVE EMI-MESSAGE-AREA (1)    TO  AEMSG1O.
  2578     MOVE EMI-MESSAGE-AREA (2)    TO  AEMSG2O.
  2579
  2580* EXEC CICS SEND DATAONLY
  2581*        FROM   (EL608AO)
  2582*        MAPSET (WS-MAPSET-NAME)
  2583*        MAP    (WS-MAP-NAME)
  2584*        CURSOR
  2585*    END-EXEC.
  2586     MOVE LENGTH OF
  2587      EL608AO
  2588       TO DFHEIV12
  2589     MOVE -1
  2590       TO DFHEIV11
  2591*    MOVE '8$D    CT       H L F ,   #00002273' TO DFHEIV0
  2592     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2593     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2594     MOVE X'2020233030303032323733' TO DFHEIV0(25:11)
  2595     CALL 'kxdfhei1' USING DFHEIV0,
  2596           WS-MAP-NAME,
  2597           EL608AO,
  2598           DFHEIV12,
  2599           WS-MAPSET-NAME,
  2600           DFHEIV99,
  2601           DFHEIV99,
  2602           DFHEIV99,
  2603           DFHEIV11,
  2604           DFHEIV99,
  2605           DFHEIV99,
  2606           DFHEIV99
  2607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2608
  2609     GO TO 9100-RETURN-TRAN
  2610     .
  2611 8200-EXIT.
  2612      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL608.cbl
  2614*****************************************************************
  2615 8300-SEND-TEXT.
  2616*****************************************************************
  2617
  2618* EXEC CICS SEND TEXT
  2619*        FROM   (LOGOFF-TEXT)
  2620*        LENGTH (LOGOFF-LENGTH)
  2621*        ERASE  FREEKB
  2622*    END-EXEC.
  2623*    MOVE '8&      T  E F  H   F -   #00002287' TO DFHEIV0
  2624     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2625     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2626     MOVE X'2020233030303032323837' TO DFHEIV0(25:11)
  2627     CALL 'kxdfhei1' USING DFHEIV0,
  2628           LOGOFF-TEXT,
  2629           LOGOFF-LENGTH,
  2630           DFHEIV99,
  2631           DFHEIV99,
  2632           DFHEIV99,
  2633           DFHEIV99,
  2634           DFHEIV99,
  2635           DFHEIV99,
  2636           DFHEIV99,
  2637           DFHEIV99,
  2638           DFHEIV99,
  2639           DFHEIV99
  2640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2641
  2642
  2643* EXEC CICS RETURN
  2644*    END-EXEC.
  2645*    MOVE '.(                    &   #00002292' TO DFHEIV0
  2646     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2647     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2648     MOVE X'2020233030303032323932' TO DFHEIV0(25:11)
  2649     CALL 'kxdfhei1' USING DFHEIV0,
  2650           DFHEIV99,
  2651           DFHEIV99,
  2652           DFHEIV99,
  2653           DFHEIV99,
  2654           DFHEIV99
  2655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2656
  2657 8300-EXIT.
  2658      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL608.cbl
  2660*****************************************************************
  2661 8400-LOG-JOURNAL-RECORD.
  2662*****************************************************************
  2663     IF PI-JOURNAL-FILE-ID = 0
  2664         GO TO 8400-EXIT.
  2665     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  2666     MOVE 'ELCNTL'               TO  JP-FILE-ID.
  2667     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  2668*    EXEC CICS JOURNAL
  2669*        JFILEID (PI-JOURNAL-FILE-ID)
  2670*        JTYPEID (WS-JOURNAL-TYPE-ID)
  2671*        FROM    (JOURNAL-RECORD)
  2672*        LENGTH  (WS-JOURNAL-RECORD-LENGTH)
  2673*    END-EXEC.
  2674 8400-EXIT.
  2675      EXIT.
  2676*****************************************************************
  2677 8500-DATE-CONVERSION.
  2678*****************************************************************
  2679
  2680* EXEC CICS LINK
  2681*        PROGRAM  ('ELDATCV')
  2682*        COMMAREA (DATE-CONVERSION-DATA)
  2683*        LENGTH   (DC-COMM-LENGTH)
  2684*    END-EXEC.
  2685     MOVE 'ELDATCV' TO DFHEIV1
  2686*    MOVE '."C                   ''   #00002316' TO DFHEIV0
  2687     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2688     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2689     MOVE X'2020233030303032333136' TO DFHEIV0(25:11)
  2690     CALL 'kxdfhei1' USING DFHEIV0,
  2691           DFHEIV1,
  2692           DATE-CONVERSION-DATA,
  2693           DC-COMM-LENGTH,
  2694           DFHEIV99,
  2695           DFHEIV99,
  2696           DFHEIV99
  2697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2698
  2699 8500-EXIT.
  2700      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL608.cbl
  2702*****************************************************************
  2703 9000-RETURN-CICS.
  2704*****************************************************************
  2705     MOVE 'EL005'                TO  THIS-PGM.
  2706     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  2707     PERFORM 9300-XCTL.
  2708 9000-EXIT.
  2709      EXIT.
  2710*****************************************************************
  2711 9100-RETURN-TRAN.
  2712*****************************************************************
  2713     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  2714     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  2715
  2716* EXEC CICS RETURN
  2717*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2718*        LENGTH   (PI-COMM-LENGTH)
  2719*        TRANSID  (WS-TRANS-ID)
  2720*    END-EXEC.
  2721*    MOVE '.(CT                  &   #00002337' TO DFHEIV0
  2722     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2723     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2724     MOVE X'2020233030303032333337' TO DFHEIV0(25:11)
  2725     CALL 'kxdfhei1' USING DFHEIV0,
  2726           WS-TRANS-ID,
  2727           PROGRAM-INTERFACE-BLOCK,
  2728           PI-COMM-LENGTH,
  2729           DFHEIV99,
  2730           DFHEIV99
  2731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2732
  2733 9100-EXIT.
  2734      EXIT.
  2735*****************************************************************
  2736 9300-XCTL.
  2737*****************************************************************
  2738     MOVE DFHENTER               TO  EIBAID.
  2739
  2740* EXEC CICS XCTL
  2741*        PROGRAM  (THIS-PGM)
  2742*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2743*        LENGTH   (PI-COMM-LENGTH)
  2744*    END-EXEC.
  2745*    MOVE '.$C                   $   #00002348' TO DFHEIV0
  2746     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2747     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2748     MOVE X'2020233030303032333438' TO DFHEIV0(25:11)
  2749     CALL 'kxdfhei1' USING DFHEIV0,
  2750           THIS-PGM,
  2751           PROGRAM-INTERFACE-BLOCK,
  2752           PI-COMM-LENGTH
  2753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2754
  2755 9300-EXIT.
  2756      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL608.cbl
  2758*****************************************************************
  2759 9400-CLEAR.
  2760*****************************************************************
  2761     MOVE PI-RETURN-TO-PROGRAM  TO  THIS-PGM.
  2762     PERFORM 9300-XCTL.
  2763 9400-EXIT.
  2764      EXIT.
  2765*****************************************************************
  2766 9600-PGMIDERR.
  2767*****************************************************************
  2768
  2769* EXEC CICS HANDLE CONDITION
  2770*        PGMIDERR (8300-SEND-TEXT)
  2771*    END-EXEC.
  2772*    MOVE '"$L                   ! # #00002366' TO DFHEIV0
  2773     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2774     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2775     MOVE X'2320233030303032333636' TO DFHEIV0(25:11)
  2776     CALL 'kxdfhei1' USING DFHEIV0
  2777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2778
  2779     MOVE THIS-PGM               TO  PI-CALLING-PROGRAM
  2780                                     LOGOFF-PGM.
  2781     MOVE 'EL005'                TO  THIS-PGM.
  2782     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  2783     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  2784     PERFORM 9300-XCTL.
  2785 9600-EXIT.
  2786      EXIT.
  2787*****************************************************************
  2788 9900-ERROR-FORMAT.
  2789*****************************************************************
  2790     IF EMI-ERRORS-COMPLETE
  2791         ADD +1             TO  EMI-FATAL-CTR
  2792         MOVE ZERO          TO  EMI-ERROR
  2793         GO TO 9900-EXIT.
  2794
  2795* EXEC CICS LINK
  2796*        PROGRAM  ('EL001')
  2797*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  2798*        LENGTH   (EMI-COMM-LENGTH)
  2799*    END-EXEC.
  2800     MOVE 'EL001' TO DFHEIV1
  2801*    MOVE '."C                   ''   #00002384' TO DFHEIV0
  2802     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2803     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2804     MOVE X'2020233030303032333834' TO DFHEIV0(25:11)
  2805     CALL 'kxdfhei1' USING DFHEIV0,
  2806           DFHEIV1,
  2807           ERROR-MESSAGE-INTERFACE-BLOCK,
  2808           EMI-COMM-LENGTH,
  2809           DFHEIV99,
  2810           DFHEIV99,
  2811           DFHEIV99
  2812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2813
  2814     MOVE ZERO              TO  EMI-ERROR.
  2815 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL608.cbl
  2816      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL608.cbl
  2818*****************************************************************
  2819 9990-ERROR.
  2820*****************************************************************
  2821     MOVE DFHEIBLK               TO EMI-LINE1.
  2822
  2823* EXEC CICS LINK
  2824*        PROGRAM   ('EL004')
  2825*        COMMAREA  (EMI-LINE1)
  2826*        LENGTH    (72)
  2827*    END-EXEC.
  2828     MOVE 'EL004' TO DFHEIV1
  2829     MOVE 72
  2830       TO DFHEIV11
  2831*    MOVE '."C                   ''   #00002397' TO DFHEIV0
  2832     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2833     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2834     MOVE X'2020233030303032333937' TO DFHEIV0(25:11)
  2835     CALL 'kxdfhei1' USING DFHEIV0,
  2836           DFHEIV1,
  2837           EMI-LINE1,
  2838           DFHEIV11,
  2839           DFHEIV99,
  2840           DFHEIV99,
  2841           DFHEIV99
  2842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2843
  2844     PERFORM 8200-SEND-DATAONLY.
  2845     GO TO 9100-RETURN-TRAN.
  2846 9990-EXIT.
  2847      EXIT.
  2848*****************************************************************
  2849 9995-SECURITY-VIOLATION.
  2850*****************************************************************
  2851*           COPY ELCSCTP.
  2852******************************************************************
  2853*                                                                *
  2854*                            ELCSCTP                             *
  2855*                            VMOD=2.001                          *
  2856*                                                                *
  2857*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2858******************************************************************
  2859
  2860
  2861     MOVE EIBDATE          TO SM-JUL-DATE.
  2862     MOVE EIBTRMID         TO SM-TERMID.
  2863     MOVE THIS-PGM         TO SM-PGM.
  2864     MOVE EIBTIME          TO TIME-IN.
  2865     MOVE TIME-OUT         TO SM-TIME.
  2866     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2867
  2868
  2869* EXEC CICS LINK
  2870*         PROGRAM  ('EL003')
  2871*         COMMAREA (SECURITY-MESSAGE)
  2872*         LENGTH   (80)
  2873*    END-EXEC.
  2874     MOVE 'EL003' TO DFHEIV1
  2875     MOVE 80
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL608.cbl
  2876       TO DFHEIV11
  2877*    MOVE '."C                   ''   #00002426' TO DFHEIV0
  2878     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2879     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2880     MOVE X'2020233030303032343236' TO DFHEIV0(25:11)
  2881     CALL 'kxdfhei1' USING DFHEIV0,
  2882           DFHEIV1,
  2883           SECURITY-MESSAGE,
  2884           DFHEIV11,
  2885           DFHEIV99,
  2886           DFHEIV99,
  2887           DFHEIV99
  2888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2889
  2890
  2891******************************************************************
  2892
  2893 9995-EXIT.
  2894      EXIT.
  2895 9999-LAST-PARAGRAPH SECTION.
  2896
  2897* GOBACK.
  2898     MOVE '9%                    "   ' TO DFHEIV0
  2899     MOVE 'EL608' TO DFHEIV1
  2900     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2901     GOBACK.
  2902
  2903 9999-DFHBACK SECTION.
  2904     MOVE '9%                    "   ' TO DFHEIV0
  2905     MOVE 'EL608' TO DFHEIV1
  2906     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2907     GOBACK.
  2908 9999-DFHEXIT.
  2909     IF DFHEIGDJ EQUAL 0001
  2910         NEXT SENTENCE
  2911     ELSE IF DFHEIGDJ EQUAL 2
  2912         GO TO 9600-PGMIDERR,
  2913               9990-ERROR
  2914         DEPENDING ON DFHEIGDI
  2915     ELSE IF DFHEIGDJ EQUAL 3
  2916         GO TO 8300-SEND-TEXT
  2917         DEPENDING ON DFHEIGDI.
  2918     MOVE '9%                    "   ' TO DFHEIV0
  2919     MOVE 'EL608' TO DFHEIV1
  2920     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2921     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5072     Code:        8748
