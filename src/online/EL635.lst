* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL635.cbl
* Options: int("EL635.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL635.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL635.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL635.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL635 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/29/94 10:27:57.
     7*                            VMOD=2.042
     8*
     9******************************************************************
    10******************************************************************
    11*                                                                *
    12*         THIS IS PROGRAM IS USED BY BOTH THE CREDIT AND         *
    13*         MORTGAGE SYSTEMS.  ANY CHANGES MADE, SHOULD ONLY       *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL635.cbl
    14*         BE MADE AFTER CONSIDERING WHAT IMPACT THEY MAY         *
    15*         HAVE ON EITHER SYSTEM.                                 *
    16*                                                                *
    17******************************************************************
    18******************************************************************
    19
    20*AUTHOR.        LOGIC,INC.
    21*               DALLAS, TEXAS.
    22
    23*DATE-COMPILED.
    24
    25*SECURITY.   *****************************************************
    26*            *                                                   *
    27*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    28*            *                                                   *
    29*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    30*                                                                *
    31*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    32*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    33*            *                                                   *
    34*            *****************************************************
    35
    36*REMARKS.
    37*        TRANSACTION - EXJ4 - COMPENSATION PAYMENTS/ADJUSTMENTS.
    38
    39 ENVIRONMENT DIVISION.
    40 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL635.cbl
    42 WORKING-STORAGE SECTION.
    43 01  DFH-START PIC X(04).
    44 77  FILLER  PIC X(32)  VALUE '********************************'.
    45 77  FILLER  PIC X(32)  VALUE '*    EL635 WORKING STORAGE     *'.
    46 77  FILLER  PIC X(32)  VALUE '**********  VMOD=2.042 *********'.
    47
    48*    COPY ELCSCTM.
    49******************************************************************
    50*                                                                *
    51*                                                                *
    52*                            ELCSCTM                             *
    53*                            VMOD=2.001                          *
    54*                                                                *
    55*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    56*                                                                *
    57******************************************************************
    58 01  SECURITY-MESSAGE.
    59     12  FILLER                          PIC X(30)
    60            VALUE '** LOGIC SECURITY VIOLATION -'.
    61     12  SM-READ                         PIC X(6).
    62     12  FILLER                          PIC X(5)
    63            VALUE ' PGM='.
    64     12  SM-PGM                          PIC X(6).
    65     12  FILLER                          PIC X(5)
    66            VALUE ' OPR='.
    67     12  SM-PROCESSOR-ID                 PIC X(4).
    68     12  FILLER                          PIC X(6)
    69            VALUE ' TERM='.
    70     12  SM-TERMID                       PIC X(4).
    71     12  FILLER                          PIC XX   VALUE SPACE.
    72     12  SM-JUL-DATE                     PIC 9(5).
    73     12  FILLER                          PIC X    VALUE SPACE.
    74     12  SM-TIME                         PIC 99.99.
    75
    76*    COPY ELCSCRTY.
    77******************************************************************
    78*                                                                *
    79*                                                                *
    80*                            ELCSCRTY                            *
    81*                            VMOD=2.001                          *
    82*                                                                *
    83*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    84*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    85*        SAVED IN PI-SECURITY-ADDRESS.                           *
    86*                                                                *
    87******************************************************************
    88 01  SECURITY-CONTROL.
    89     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    90     12  FILLER                       PIC XX    VALUE 'SC'.
    91     12  SC-CREDIT-CODES.
    92         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    93             20  SC-CREDIT-DISPLAY    PIC X.
    94             20  SC-CREDIT-UPDATE     PIC X.
    95     12  SC-CLAIMS-CODES.
    96         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    97             20  SC-CLAIMS-DISPLAY    PIC X.
    98             20  SC-CLAIMS-UPDATE     PIC X.
    99*    COPY MPCSCRT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL635.cbl
   100******************************************************************
   101*                                                                *
   102*                            MPCSCRT                             *
   103*                            VMOD=1.001                          *
   104*                                                                *
   105*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   106*        ACQUIRED BY SIGN-ON PROGRAM EL125.                      *
   107*                                      (MP MORTGAGE PROTECTION)  *
   108*                                                                *
   109******************************************************************
   110*
   111 01  SECURITY-CONTROL-E.
   112     12  SC-COMM-LENGTH-E             PIC S9(04) VALUE +144 COMP.
   113     12  FILLER                       PIC  X(02) VALUE 'SC'.
   114     12  SC-QUID-KEY.
   115         16  SC-QUID-TERMINAL         PIC  X(04).
   116         16  SC-QUID-SYSTEM           PIC  X(04).
   117     12  SC-ITEM                      PIC S9(04) VALUE +1   COMP.
   118     12  SC-SECURITY-ACCESS-CODE      PIC  X(01).
   119     12  SC-PRODUCER-AUTHORIZED-SW    PIC  X(01).
   120         88 SC-PRODUCER-AUTHORIZED               VALUE ' '.
   121         88 SC-PRODUCER-NOT-AUTHORIZED           VALUE 'N'.
   122     12  SC-MP-CODES.
   123         16  SC-MP-AUTHORIZATION OCCURS 44 TIMES.
   124             20  SC-MP-DISPLAY        PIC  X(01).
   125             20  SC-MP-UPDATE         PIC  X(01).
   126     12  FILLER                       PIC  X(40).
   127
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL635.cbl
   129
   130 01  STANDARD-AREAS.
   131     12  W-APPL-SCRTY-NDX    PIC S9(4) COMP  VALUE +38.
   132     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
   133     12  MAP-NAME            PIC  X(8)       VALUE 'EL635A'.
   134     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL635S'.
   135     12  SCREEN-NUMBER       PIC  X(4)       VALUE '633A'.
   136     12  TRANS-ID            PIC  X(4)       VALUE 'EXJ4'.
   137     12  EL630-TRANS-ID      PIC  X(4)       VALUE 'EXA5'.
   138     12  EL640-TRANS-ID      PIC  X(4)       VALUE 'EXC1'.
   139     12  EL642-TRANS-ID      PIC  X(4)       VALUE 'EXH7'.
   140     12  EL652-TRANS-ID      PIC  X(4)       VALUE 'EXD4'.
   141     12  EL6351-TRANS-ID     PIC  X(4)       VALUE 'EXJ5'.
   142     12  THIS-PGM            PIC  X(8)       VALUE 'EL635'.
   143     12  PGM-NAME            PIC  X(8).
   144     12  TIME-IN             PIC S9(7).
   145     12  TIME-OUT-R  REDEFINES  TIME-IN.
   146         16  FILLER          PIC  X.
   147         16  TIME-OUT        PIC  99V99.
   148         16  FILLER          PIC  XX.
   149     12  EL640               PIC  X(8)       VALUE 'EL640'.
   150     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
   151     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
   152     12  XCTL-626            PIC  X(8)       VALUE 'EL626'.
   153     12  XCTL-EM626          PIC  X(8)       VALUE 'EM626'.
   154     12  XCTL-652            PIC  X(8)       VALUE 'EL652'.
   155     12  XCTL-6351           PIC  X(8)       VALUE 'EL6351'.
   156     12  XCTL-640            PIC  X(8)       VALUE 'EL640'.
   157     12  XCTL-642            PIC  X(8)       VALUE 'EL642'.
   158     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   159     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   160     12  LINK-CLDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   161     12  PYAJ-FILE-ID        PIC  X(8)       VALUE 'ERPYAJ'.
   162     12  MPPYAJ-FILE-ID      PIC  X(8)       VALUE 'MPPYAJ'.
   163     12  MPPRCN-FILE-ID      PIC  X(8)       VALUE 'MPPRCN'.
   164     12  CHKQ-FILE-ID        PIC  X(8)       VALUE 'ERCHKQ'.
   165     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   166     12  RECV-FILE-ID        PIC  X(8)       VALUE 'ERRECV'.
   167     12  RETURNED-FROM       PIC  X(8)       VALUE SPACES.
   168     12  WS-CURRENT-DT       PIC  X(8)       VALUE SPACES.
   169     12  WS-CURRENT-MDY      PIC  X(6)       VALUE SPACES.
   170     12  WS-CURRENT-BIN-DT   PIC  XX         VALUE SPACES.
   171     12  WS-COMMENT-FULL.
   172         16  WS-COMMENT-24-POS  PIC  X(24)   VALUE SPACES.
   173         16  FILLER             PIC  X(6)    VALUE SPACES.
   174     12  EL630-SENT-SW       PIC  X          VALUE SPACE.
   175         88  SENT-FROM-PENDING               VALUE 'Y'.
   176     12  PYAJ-READ-SW        PIC  X          VALUE 'Y'.
   177         88  PYAJ-1ST-READ                   VALUE 'Y'.
   178     12  WARNING-SW          PIC  X          VALUE 'N'.
   179     12  WS-SECOND-READ      PIC  X          VALUE '1'.
   180     12  ZERO-NDX            PIC  9          VALUE ZERO.
   181     12  WORK-SEQ-NO         PIC S9(9)  COMP-3  VALUE ZERO.
   182     12  WS-CURSOR-POS-1     PIC S9(4)  COMP VALUE +721.
   183     12  WS-CURSOR-POS-2     PIC S9(4)  COMP VALUE +1041.
   184     12  WS-CURSOR-POS-3     PIC S9(4)  COMP VALUE +1361.
   185     12  WS-EDIT-PATTERN     PIC 9(7)V99     VALUE ZERO.
   186     12  WS-EDIT  REDEFINES  WS-EDIT-PATTERN PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL635.cbl
   187     12  WS-EDITED-AMOUNT.
   188         16  WS-EDIT-AMOUNT  PIC X(9)        VALUE ZERO.
   189         16  WS-EDIT-SIGN    PIC X           VALUE ' '.
   190     12  WS-EMHD1            PIC  X(6)       VALUE 'EOM DT'.
   191     12  WS-EMHD2.
   192         16  FILLER          PIC  X(20)      VALUE
   193                 '       CREDIT - DEBI'.
   194         16  FILLER          PIC  X(20)      VALUE
   195                 'T         TYPE    AM'.
   196         16  FILLER          PIC  X(20)      VALUE
   197                 'OUNT    G/A VOID MAI'.
   198         16  FILLER          PIC  X(19)      VALUE
   199                 'NT DT BILLED INP DT'.
   200     12  CHECK-REC-TYPE      PIC  X          VALUE SPACE.
   201         88  VALID-MTG-REC-TYPE              VALUE  'R' 'D' 'C'
   202                                                    'S' 'T' 'U'
   203                                                    'X' 'Y' 'Z'
   204                                                    'F'
   205                                                    'G'.
   206         88  VALID-REC-TYPE                  VALUE  'R' 'D' 'C'
   207                                                    'S' 'T' 'U'
   208                                                    'X' 'Y' 'Z'
   209                                                    'F'.
   210
   211         88  MON-VALID-REC-TYPE              VALUE  'R' 'D' 'C'
   212                                                    'Z'.
   213         88  ANL-VALID-REC-TYPE              VALUE  'R' 'D' 'C'
   214                                                    'S' 'T' 'U'
   215                                                    'X' 'Y' 'Z'.
   216         88  NCL-VALID-REC-TYPE              VALUE  'R' 'D' 'C'
   217                                                    'X' 'Y' 'Z'.
   218
   219     12  FORCE-SHOW-SW       PIC  X          VALUE SPACE.
   220         88  FORCE-SHOW                      VALUE  'Y'.
   221     12  OVERWRITE-AGENT-SW  PIC  X          VALUE SPACE.
   222         88  OVERWRITE-AGENT                 VALUE  'Y'.
   223
   224     12  WS-RECON-SW         PIC  X          VALUE SPACE.
   225         88  WS-RECON-ADD                    VALUE 'A'.
   226         88  WS-RECON-UPDATE                 VALUE 'U'.
   227         88  WS-RECON-DELETE                 VALUE 'D'.
   228
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL635.cbl
   230     12  WS-ERROR-CODES.
   231         16  ER-0000         PIC  X(4)       VALUE '0000'.
   232         16  ER-0008         PIC  X(4)       VALUE '0008'.
   233         16  ER-0023         PIC  X(4)       VALUE '0023'.
   234         16  ER-0029         PIC  X(4)       VALUE '0029'.
   235         16  ER-0070         PIC  X(4)       VALUE '0070'.
   236         16  ER-0587         PIC  X(4)       VALUE '0587'.
   237         16  ER-0714         PIC  X(4)       VALUE '0714'.
   238         16  ER-0761         PIC  X(4)       VALUE '0761'.
   239         16  ER-2056         PIC  X(4)       VALUE '2056'.
   240         16  ER-2231         PIC  X(4)       VALUE '2231'.
   241         16  ER-2232         PIC  X(4)       VALUE '2232'.
   242         16  ER-2233         PIC  X(4)       VALUE '2233'.
   243         16  ER-2234         PIC  X(4)       VALUE '2234'.
   244         16  ER-2235         PIC  X(4)       VALUE '2235'.
   245         16  ER-2236         PIC  X(4)       VALUE '2236'.
   246         16  ER-2237         PIC  X(4)       VALUE '2237'.
   247         16  ER-2238         PIC  X(4)       VALUE '2238'.
   248         16  ER-2239         PIC  X(4)       VALUE '2239'.
   249         16  ER-2244         PIC  X(4)       VALUE '2244'.
   250         16  ER-2245         PIC  X(4)       VALUE '2245'.
   251         16  ER-2246         PIC  X(4)       VALUE '2246'.
   252         16  ER-2370         PIC  X(4)       VALUE '2370'.
   253         16  ER-2432         PIC  X(4)       VALUE '2432'.
   254         16  ER-2449         PIC  X(4)       VALUE '2449'.
   255         16  ER-2587         PIC  X(4)       VALUE '2587'.
   256         16  ER-2588         PIC  X(4)       VALUE '2588'.
   257         16  ER-2595         PIC  X(4)       VALUE '2595'.
   258         16  ER-2596         PIC  X(4)       VALUE '2596'.
   259         16  ER-2929         PIC  X(4)       VALUE '2929'.
   260         16  ER-3020         PIC  X(4)       VALUE '3020'.
   261         16  ER-3146         PIC  X(4)       VALUE '3146'.
   262         16  ER-3172         PIC  X(4)       VALUE '3172'.
   263         16  ER-3175         PIC  X(4)       VALUE '3175'.
   264         16  ER-3177         PIC  X(4)       VALUE '3177'.
   265         16  ER-3178         PIC  X(4)       VALUE '3178'.
   266         16  ER-3179         PIC  X(4)       VALUE '3179'.
   267         16  ER-3180         PIC  X(4)       VALUE '3180'.
   268         16  ER-3183         PIC  X(4)       VALUE '3183'.
   269         16  ER-3190         PIC  X(4)       VALUE '3190'.
   270         16  ER-3193         PIC  X(4)       VALUE '3193'.
   271         16  ER-3195         PIC  X(4)       VALUE '3195'.
   272         16  ER-3196         PIC  X(4)       VALUE '3196'.
   273         16  ER-3260         PIC  X(4)       VALUE '3260'.
   274         16  ER-3262         PIC  X(4)       VALUE '3262'.
   275         16  ER-3263         PIC  X(4)       VALUE '3263'.
   276         16  ER-3264         PIC  X(4)       VALUE '3264'.
   277         16  ER-3265         PIC  X(4)       VALUE '3265'.
   278         16  ER-3266         PIC  X(4)       VALUE '3266'.
   279         16  ER-7806         PIC  X(4)       VALUE '7806'.
   280         16  ER-9094         PIC  X(4)       VALUE '9094'.
   281         16  ER-9095         PIC  X(4)       VALUE '9095'.
   282         16  ER-9096         PIC  X(4)       VALUE '9096'.
   283         16  ER-9097         PIC  X(4)       VALUE '9097'.
   284         16  ER-9179         PIC  X(4)       VALUE '9179'.
   285         16  ER-9280         PIC  X(4)       VALUE '9280'.
   286         16  ER-9296         PIC  X(4)       VALUE '9296'.
   287         16  ER-9374         PIC  X(4)       VALUE '9374'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL635.cbl
   288
   289 01  WORK-AREA.
   290     12  QID.
   291         16  QID-TERM            PIC X(4)      VALUE SPACES.
   292         16  FILLER              PIC X(4)      VALUE '635A'.
   293     12  WS-SAVE-WS-INDX         PIC S9(4) COMP VALUE ZERO.
   294     12  WS-EDITED-AMTS OCCURS 6 TIMES
   295                                INDEXED BY WS-INDX.
   296         16  WS-EDITED-AMT       PIC S9(9)V99 COMP-3.
   297
   298     12  DATE-TEST-AREA      PIC  9(6).
   299     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   300         16  DATE-TEST-MM    PIC  99.
   301         16  DATE-TEST-DD    PIC  99.
   302         16  DATE-TEST-YY    PIC  99.
   303     12  DIVIDE-RESULT       PIC  99           VALUE ZERO.
   304     12  DIVIDE-REMAINDER    PIC  9            VALUE ZERO.
   305     12  PREV-BIN-MAINT-DT   PIC  XX           VALUE SPACES.
   306     12  PREV-MAINT-DT       PIC  9(6)         VALUE ZEROS.
   307     12  PREV-BIN-BL-DT      PIC  XX           VALUE SPACES.
   308     12  PREV-BL-DT          PIC  9(6)         VALUE ZEROS.
   309     12  TOTAL-ACCT-AMT      PIC S9(7)V99      VALUE ZEROS.
   310     12  TOTAL-ACCT-NET      PIC S9(7)V99      VALUE ZEROS.
   311     12  WS-OLD-ENTRY-AMT    PIC S9(7)V99      VALUE ZEROS.
   312     12  WS-ENTRY-AMT        PIC S9(7)V99      VALUE ZEROS.
   313     12  WS-WORK-BALANCE     PIC S9(7)V99      VALUE ZEROS.
   314     12  WS-BAL-AMOUNT       PIC S9(7)V99      VALUE ZEROS.
   315     12  WS-AR-BALANCE       PIC S9(7)V99      VALUE ZEROS.
   316     12  WS-SAVE-INDEX-VALUE PIC S9(4) COMP    VALUE ZEROS.
   317     12  WS-SAVE-NDX-VALUE   PIC S9(4) COMP    VALUE ZEROS.
   318     12  WS-EOM-DTS OCCURS 3  TIMES
   319                              INDEXED BY PINDEX.
   320         16  WS-EOM-DT               PIC XX.
   321     12  WS-INP-DTS OCCURS 3  TIMES
   322                              INDEXED BY DINDEX.
   323         16  WS-INP-DT               PIC XX.
   324     12  WS-PREV-PF5                 PIC X.
   325     12  WS-ACCEPT-TABLE.
   326         16  WS-ACCEPT-1 OCCURS 3 TIMES
   327                         INDEXED BY W-INDX
   328                                     PIC X.
   329
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL635.cbl
   331 01  ACCESS-KEYS.
   332     12  ERPYAJ-KEY.
   333         16  PYAJ-COMP-CD            PIC  X      VALUE SPACE.
   334         16  PYAJ-CARRIER            PIC  X      VALUE SPACES.
   335         16  PYAJ-GROUPING           PIC  X(6)   VALUE SPACES.
   336         16  PYAJ-FIN-RESP           PIC  X(10)  VALUE SPACES.
   337         16  PYAJ-ACCOUNT            PIC  X(10)  VALUE SPACES.
   338         16  PYAJ-FILE-SEQ-NO        PIC S9(8)   VALUE +0  COMP.
   339         16  PYAJ-RECORD-TYPE        PIC  X      VALUE SPACES.
   340
   341     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   342     12  ERPYAJ-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   343
   344     12  ERCHKQ-KEY.
   345         16  CHKQ-COMPANY-CD         PIC  X      VALUE SPACE.
   346         16  CHKQ-CONTROL-NUMBER     PIC S9(8)   VALUE +0  COMP.
   347         16  CHKQ-SEQUENCE-NUMBER    PIC S9(4)   VALUE +0  COMP.
   348     12  ERCOMP-KEY.
   349         16  COMP-COMP-CD            PIC  X      VALUE SPACE.
   350         16  COMP-CARRIER            PIC  X      VALUE SPACES.
   351         16  COMP-GROUPING           PIC  X(6)   VALUE SPACES.
   352         16  COMP-FIN-RESP           PIC  X(10)  VALUE SPACES.
   353         16  COMP-ACCOUNT            PIC  X(10)  VALUE SPACES.
   354         16  COMP-RECORD-TYPE        PIC  X      VALUE SPACES.
   355     12  ERRECV-KEY.
   356         16  RECV-COMP-CD            PIC  X      VALUE SPACE.
   357         16  RECV-TYPE               PIC  X      VALUE SPACES.
   358         16  RECV-CARRIER            PIC  X      VALUE SPACES.
   359         16  RECV-GROUPING           PIC  X(6)   VALUE SPACES.
   360         16  RECV-BAL-LVL            PIC  X      VALUE SPACES.
   361         16  RECV-ENTRY-TYPE         PIC  X      VALUE SPACES.
   362         16  RECV-FIN-RESP           PIC  X(10)  VALUE SPACES.
   363         16  RECV-ACCOUNT            PIC  X(10)  VALUE SPACES.
   364         16  RECV-INVOICE            PIC  X(6)   VALUE SPACES.
   365         16  RECV-REFERENCE          PIC  X(12)  VALUE SPACES.
   366         16  RECV-RESPONSIBLE        PIC  X      VALUE SPACES.
   367         16  RECV-RECORD-TYPE        PIC  X      VALUE SPACES.
   368         16  RECV-RECORD-SEQ         PIC  S9(4)  VALUE +0  COMP.
   369     12  ERRECV-KEY-LEN              PIC  S9(4)  COMP VALUE +51.
   370
   371     12  MPPRCN-KEY.
   372         16  MPPRCN-COMPANY-CD       PIC X       VALUE SPACES.
   373         16  MPPRCN-INVOICE          PIC X(6)    VALUE SPACES.
   374         16  MPPRCN-RECORD-SEQU      PIC S9(7)   VALUE +0  COMP-3.
   375
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL635.cbl
   377*    COPY ELCDATE.
   378******************************************************************
   379*                                                                *
   380*                                                                *
   381*                            ELCDATE.                            *
   382*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   383*                            VMOD=2.003
   384*                                                                *
   385*                                                                *
   386*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   387*                 LENGTH = 200                                   *
   388******************************************************************
   389
   390 01  DATE-CONVERSION-DATA.
   391     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   392     12  DC-OPTION-CODE                PIC X.
   393         88  BIN-TO-GREG                VALUE ' '.
   394         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   395         88  EDIT-GREG-TO-BIN           VALUE '2'.
   396         88  YMD-GREG-TO-BIN            VALUE '3'.
   397         88  MDY-GREG-TO-BIN            VALUE '4'.
   398         88  JULIAN-TO-BIN              VALUE '5'.
   399         88  BIN-PLUS-ELAPSED           VALUE '6'.
   400         88  FIND-CENTURY               VALUE '7'.
   401         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   402         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   403         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   404         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   405         88  JULIAN-TO-BIN-3            VALUE 'C'.
   406         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   407         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   408         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   409         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   410         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   411         88  CHECK-LEAP-YEAR            VALUE 'H'.
   412         88  BIN-3-TO-GREG              VALUE 'I'.
   413         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   414         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   415         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   416         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   417         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   418         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   419         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   420         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   421         88  THREE-CHARACTER-BIN
   422                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   423         88  GREGORIAN-TO-BIN
   424                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   425         88  BIN-TO-GREGORIAN
   426                  VALUES ' ' '1' 'I' '8' 'G'.
   427         88  JULIAN-TO-BINARY
   428                  VALUES '5' 'C' 'E' 'F'.
   429     12  DC-ERROR-CODE                 PIC X.
   430         88  NO-CONVERSION-ERROR        VALUE ' '.
   431         88  DATE-CONVERSION-ERROR
   432                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   433         88  DATE-IS-ZERO               VALUE '1'.
   434         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL635.cbl
   435         88  DATE-IS-INVALID            VALUE '3'.
   436         88  DATE1-GREATER-DATE2        VALUE '4'.
   437         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   438         88  DATE-INVALID-OPTION        VALUE '9'.
   439         88  INVALID-CENTURY            VALUE 'A'.
   440         88  ONLY-CENTURY               VALUE 'B'.
   441         88  ONLY-LEAP-YEAR             VALUE 'C'.
   442         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   443     12  DC-END-OF-MONTH               PIC X.
   444         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   445     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   446         88  USE-NORMAL-PROCESS         VALUE ' '.
   447         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   448         88  ADJUST-UP-100-YRS          VALUE '2'.
   449     12  FILLER                        PIC X.
   450     12  DC-CONVERSION-DATES.
   451         16  DC-BIN-DATE-1             PIC XX.
   452         16  DC-BIN-DATE-2             PIC XX.
   453         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   454         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   455                       DC-GREG-DATE-1-EDIT.
   456             20  DC-EDIT1-MONTH        PIC 99.
   457             20  SLASH1-1              PIC X.
   458             20  DC-EDIT1-DAY          PIC 99.
   459             20  SLASH1-2              PIC X.
   460             20  DC-EDIT1-YEAR         PIC 99.
   461         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   462         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   463                     DC-GREG-DATE-2-EDIT.
   464             20  DC-EDIT2-MONTH        PIC 99.
   465             20  SLASH2-1              PIC X.
   466             20  DC-EDIT2-DAY          PIC 99.
   467             20  SLASH2-2              PIC X.
   468             20  DC-EDIT2-YEAR         PIC 99.
   469         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   470         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   471                     DC-GREG-DATE-1-YMD.
   472             20  DC-YMD-YEAR           PIC 99.
   473             20  DC-YMD-MONTH          PIC 99.
   474             20  DC-YMD-DAY            PIC 99.
   475         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   476         16  DC-GREG-DATE-1-MDY-R REDEFINES
   477                      DC-GREG-DATE-1-MDY.
   478             20  DC-MDY-MONTH          PIC 99.
   479             20  DC-MDY-DAY            PIC 99.
   480             20  DC-MDY-YEAR           PIC 99.
   481         16  DC-GREG-DATE-1-ALPHA.
   482             20  DC-ALPHA-MONTH        PIC X(10).
   483             20  DC-ALPHA-DAY          PIC 99.
   484             20  FILLER                PIC XX.
   485             20  DC-ALPHA-CENTURY.
   486                 24 DC-ALPHA-CEN-N     PIC 99.
   487             20  DC-ALPHA-YEAR         PIC 99.
   488         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   489         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   490         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   491         16  DC-JULIAN-DATE            PIC 9(05).
   492         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL635.cbl
   493                                       PIC 9(05).
   494         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   495             20  DC-JULIAN-YEAR        PIC 99.
   496             20  DC-JULIAN-DAYS        PIC 999.
   497         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   498         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   499         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   500     12  DATE-CONVERSION-VARIBLES.
   501         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   502         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   503             20  FILLER                PIC 9(3).
   504             20  HOLD-CEN-1-CCYY.
   505                 24  HOLD-CEN-1-CC     PIC 99.
   506                 24  HOLD-CEN-1-YY     PIC 99.
   507             20  HOLD-CEN-1-MO         PIC 99.
   508             20  HOLD-CEN-1-DA         PIC 99.
   509         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   510             20  HOLD-CEN-1-R-MO       PIC 99.
   511             20  HOLD-CEN-1-R-DA       PIC 99.
   512             20  HOLD-CEN-1-R-CCYY.
   513                 24  HOLD-CEN-1-R-CC   PIC 99.
   514                 24  HOLD-CEN-1-R-YY   PIC 99.
   515             20  FILLER                PIC 9(3).
   516         16  HOLD-CENTURY-1-X.
   517             20  FILLER                PIC X(3)  VALUE SPACES.
   518             20  HOLD-CEN-1-X-CCYY.
   519                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   520                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   521             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   522             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   523         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   524             20  HOLD-CEN-1-R-X-MO     PIC XX.
   525             20  HOLD-CEN-1-R-X-DA     PIC XX.
   526             20  HOLD-CEN-1-R-X-CCYY.
   527                 24  HOLD-CEN-1-R-X-CC PIC XX.
   528                 24  HOLD-CEN-1-R-X-YY PIC XX.
   529             20  FILLER                PIC XXX.
   530         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   531         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   532         16  DC-JULIAN-DATE-1          PIC 9(07).
   533         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   534             20  DC-JULIAN-1-CCYY.
   535                 24  DC-JULIAN-1-CC    PIC 99.
   536                 24  DC-JULIAN-1-YR    PIC 99.
   537             20  DC-JULIAN-DA-1        PIC 999.
   538         16  DC-JULIAN-DATE-2          PIC 9(07).
   539         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   540             20  DC-JULIAN-2-CCYY.
   541                 24  DC-JULIAN-2-CC    PIC 99.
   542                 24  DC-JULIAN-2-YR    PIC 99.
   543             20  DC-JULIAN-DA-2        PIC 999.
   544         16  DC-GREG-DATE-A-EDIT.
   545             20  DC-EDITA-MONTH        PIC 99.
   546             20  SLASHA-1              PIC X VALUE '/'.
   547             20  DC-EDITA-DAY          PIC 99.
   548             20  SLASHA-2              PIC X VALUE '/'.
   549             20  DC-EDITA-CCYY.
   550                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL635.cbl
   551                 24  DC-EDITA-YEAR     PIC 99.
   552         16  DC-GREG-DATE-B-EDIT.
   553             20  DC-EDITB-MONTH        PIC 99.
   554             20  SLASHB-1              PIC X VALUE '/'.
   555             20  DC-EDITB-DAY          PIC 99.
   556             20  SLASHB-2              PIC X VALUE '/'.
   557             20  DC-EDITB-CCYY.
   558                 24  DC-EDITB-CENT     PIC 99.
   559                 24  DC-EDITB-YEAR     PIC 99.
   560         16  DC-GREG-DATE-CYMD         PIC 9(08).
   561         16  DC-GREG-DATE-CYMD-R REDEFINES
   562                              DC-GREG-DATE-CYMD.
   563             20  DC-CYMD-CEN           PIC 99.
   564             20  DC-CYMD-YEAR          PIC 99.
   565             20  DC-CYMD-MONTH         PIC 99.
   566             20  DC-CYMD-DAY           PIC 99.
   567         16  DC-GREG-DATE-MDCY         PIC 9(08).
   568         16  DC-GREG-DATE-MDCY-R REDEFINES
   569                              DC-GREG-DATE-MDCY.
   570             20  DC-MDCY-MONTH         PIC 99.
   571             20  DC-MDCY-DAY           PIC 99.
   572             20  DC-MDCY-CEN           PIC 99.
   573             20  DC-MDCY-YEAR          PIC 99.
   574    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   575        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   576    12  DC-EL310-DATE                  PIC X(21).
   577    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL635.cbl
   579*    COPY ELCLOGOF.
   580******************************************************************
   581*                                                                *
   582*                                                                *
   583*                            ELCLOGOF.                           *
   584*                            VMOD=2.001                          *
   585*                                                                *
   586*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   587*                                                                *
   588******************************************************************
   589 01  CLASIC-LOGOFF.
   590     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   591     12  LOGOFF-TEXT.
   592         16  FILLER          PIC X(5)    VALUE SPACES.
   593         16  LOGOFF-MSG.
   594             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   595             20  FILLER      PIC X       VALUE SPACES.
   596             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   597         16  FILLER          PIC X(80)
   598           VALUE '* YOU ARE NOW LOGGED OFF'.
   599         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   600         16  FILLER          PIC X       VALUE QUOTE.
   601         16  LOGOFF-SYS-MSG  PIC X(17)
   602           VALUE 'S CLAS-IC SYSTEM '.
   603     12  TEXT-MESSAGES.
   604         16  UNACCESS-MSG    PIC X(29)
   605             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   606         16  PGMIDERR-MSG    PIC X(17)
   607             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL635.cbl
   609*    COPY ELCATTR.
   610******************************************************************
   611*                                                                *
   612*                            ELCATTR.                            *
   613*                            VMOD=2.001                          *
   614*                                                                *
   615*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   616*                                                                *
   617*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   618*                                                                *
   619*                   POS 1   P=PROTECTED                          *
   620*                           U=UNPROTECTED                        *
   621*                           S=ASKIP                              *
   622*                   POS 2   A=ALPHA/NUMERIC                      *
   623*                           N=NUMERIC                            *
   624*                   POS 3   N=NORMAL                             *
   625*                           B=BRIGHT                             *
   626*                           D=DARK                               *
   627*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   628*                           OF=MODIFIED DATA TAG OFF             *
   629*                                                                *
   630*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   631******************************************************************
   632 01  ATTRIBUTE-LIST.
   633     12  AL-PABOF            PIC X       VALUE 'Y'.
   634     12  AL-PABON            PIC X       VALUE 'Z'.
   635     12  AL-PADOF            PIC X       VALUE '%'.
   636     12  AL-PADON            PIC X       VALUE '_'.
   637     12  AL-PANOF            PIC X       VALUE '-'.
   638     12  AL-PANON            PIC X       VALUE '/'.
   639     12  AL-SABOF            PIC X       VALUE '8'.
   640     12  AL-SABON            PIC X       VALUE '9'.
   641     12  AL-SADOF            PIC X       VALUE '@'.
   642     12  AL-SADON            PIC X       VALUE QUOTE.
   643     12  AL-SANOF            PIC X       VALUE '0'.
   644     12  AL-SANON            PIC X       VALUE '1'.
   645     12  AL-UABOF            PIC X       VALUE 'H'.
   646     12  AL-UABON            PIC X       VALUE 'I'.
   647     12  AL-UADOF            PIC X       VALUE '<'.
   648     12  AL-UADON            PIC X       VALUE '('.
   649     12  AL-UANOF            PIC X       VALUE ' '.
   650     12  AL-UANON            PIC X       VALUE 'A'.
   651     12  AL-UNBOF            PIC X       VALUE 'Q'.
   652     12  AL-UNBON            PIC X       VALUE 'R'.
   653     12  AL-UNDOF            PIC X       VALUE '*'.
   654     12  AL-UNDON            PIC X       VALUE ')'.
   655     12  AL-UNNOF            PIC X       VALUE '&'.
   656     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL635.cbl
   658*    COPY ELCEMIB.
   659******************************************************************
   660*                                                                *
   661*                                                                *
   662*                            ELCEMIB.                            *
   663*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   664*                            VMOD=2.005                          *
   665*                                                                *
   666*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   667*                                                                *
   668******************************************************************
   669 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   670     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   671     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   672     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   673     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   674     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   675     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   676     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   677     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   678     12  EMI-SWITCH1             PIC X        VALUE '1'.
   679         88  EMI-NO-ERRORS                    VALUE '1'.
   680         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   681         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   682     12  EMI-SWITCH2             PIC X        VALUE '1'.
   683         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   684     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   685         88  EMI-AREA1-EMPTY                  VALUE '1'.
   686         88  EMI-AREA1-FULL                   VALUE '2'.
   687     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   688         88  EMI-AREA2-EMPTY                  VALUE '1'.
   689         88  EMI-AREA2-FULL                   VALUE '2'.
   690     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   691         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   692         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   693         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   694         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   695         88  EMI-BYPASS-FATALS                VALUE 'X'.
   696     12  EMI-ERROR-LINES.
   697         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   698         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   699         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   700         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   701             20  EMI-ERR-CODES OCCURS 10 TIMES.
   702                 24  EMI-ERR-NUM         PIC X(4).
   703                 24  EMI-FILLER          PIC X.
   704                 24  EMI-SEV             PIC X.
   705                 24  FILLER              PIC X.
   706             20  FILLER                  PIC X(02).
   707     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   708         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   709             20  EMI-ERROR-NUMBER    PIC X(4).
   710             20  EMI-FILL            PIC X.
   711             20  EMI-SEVERITY        PIC X.
   712             20  FILLER              PIC X.
   713             20  EMI-ERROR-TEXT.
   714                 24  EMI-TEXT-VARIABLE   PIC X(10).
   715                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL635.cbl
   716     12  EMI-SEVERITY-SAVE           PIC X.
   717         88  EMI-NOTE                    VALUE 'N'.
   718         88  EMI-WARNING                 VALUE 'W'.
   719         88  EMI-FORCABLE                VALUE 'F'.
   720         88  EMI-FATAL                   VALUE 'X'.
   721     12  EMI-MESSAGE-FLAG            PIC X.
   722         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   723         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   724     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   725     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   726         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   727         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   728         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   729     12  FILLER                      PIC X(137)  VALUE SPACES.
   730     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   731     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   732     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   733     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL635.cbl
   735*    COPY ELCINTF.
   736******************************************************************
   737*                                                                *
   738*                                                                *
   739*                            ELCINTF.                            *
   740*                            VMOD=2.017                          *
   741*                                                                *
   742*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   743*                                                                *
   744*       LENGTH = 1024                                            *
   745*                                                                *
   746******************************************************************
   747 01  PROGRAM-INTERFACE-BLOCK.
   748     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   749     12  PI-CALLING-PROGRAM              PIC X(8).
   750     12  PI-SAVED-PROGRAM-1              PIC X(8).
   751     12  PI-SAVED-PROGRAM-2              PIC X(8).
   752     12  PI-SAVED-PROGRAM-3              PIC X(8).
   753     12  PI-SAVED-PROGRAM-4              PIC X(8).
   754     12  PI-SAVED-PROGRAM-5              PIC X(8).
   755     12  PI-SAVED-PROGRAM-6              PIC X(8).
   756     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   757     12  PI-COMPANY-ID                   PIC XXX.
   758     12  PI-COMPANY-CD                   PIC X.
   759
   760     12  PI-COMPANY-PASSWORD             PIC X(8).
   761
   762     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   763
   764     12  PI-CONTROL-IN-PROGRESS.
   765         16  PI-CARRIER                  PIC X.
   766         16  PI-GROUPING                 PIC X(6).
   767         16  PI-STATE                    PIC XX.
   768         16  PI-ACCOUNT                  PIC X(10).
   769         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   770                                         PIC X(10).
   771         16  PI-CLAIM-CERT-GRP.
   772             20  PI-CLAIM-NO             PIC X(7).
   773             20  PI-CERT-NO.
   774                 25  PI-CERT-PRIME       PIC X(10).
   775                 25  PI-CERT-SFX         PIC X.
   776             20  PI-CERT-EFF-DT          PIC XX.
   777         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   778             20  PI-PLAN-CODE            PIC X(2).
   779             20  PI-REVISION-NUMBER      PIC X(3).
   780             20  PI-PLAN-EFF-DT          PIC X(2).
   781             20  PI-PLAN-EXP-DT          PIC X(2).
   782             20  FILLER                  PIC X(11).
   783         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   784             20  PI-OE-REFERENCE-1.
   785                 25  PI-OE-REF-1-PRIME   PIC X(18).
   786                 25  PI-OE-REF-1-SUFF    PIC XX.
   787
   788     12  PI-SESSION-IN-PROGRESS          PIC X.
   789         88  CLAIM-SESSION                   VALUE '1'.
   790         88  CREDIT-SESSION                  VALUE '2'.
   791         88  WARRANTY-SESSION                VALUE '3'.
   792         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL635.cbl
   793         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   794
   795
   796*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   797
   798     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   799     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   800
   801     12  PI-CREDIT-USER                  PIC X.
   802         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   803         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   804
   805     12  PI-CLAIM-USER                   PIC X.
   806         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   807         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   808
   809     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   810         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   811         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   812         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   813         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   814         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   815
   816     12  PI-PROCESSOR-ID                 PIC X(4).
   817
   818     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   819
   820     12  PI-MEMBER-CAPTION               PIC X(10).
   821
   822     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   823         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   824
   825     12  PI-LIFE-OVERRIDE-L1             PIC X.
   826     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   827     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   828     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   829
   830     12  PI-AH-OVERRIDE-L1               PIC X.
   831     12  PI-AH-OVERRIDE-L2               PIC XX.
   832     12  PI-AH-OVERRIDE-L6               PIC X(6).
   833     12  PI-AH-OVERRIDE-L12              PIC X(12).
   834
   835     12  PI-NEW-SYSTEM                   PIC X(2).
   836
   837     12  PI-PRIMARY-CERT-NO              PIC X(11).
   838     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   839         88  PI-USES-PAID-TO                 VALUE '1'.
   840     12  PI-CRDTCRD-SYSTEM.
   841         16  PI-CRDTCRD-USER             PIC X.
   842             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   843             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   844         16  PI-CC-MONTH-END-DT          PIC XX.
   845     12  PI-PROCESSOR-PRINTER            PIC X(4).
   846
   847     12  PI-OE-REFERENCE-2.
   848         16  PI-OE-REF-2-PRIME           PIC X(10).
   849         16  PI-OE-REF-2-SUFF            PIC X.
   850
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL635.cbl
   851     12  PI-REM-TRM-CALC-OPTION          PIC X.
   852
   853     12  PI-LANGUAGE-TYPE                PIC X.
   854             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   855             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   856             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   857
   858     12  PI-POLICY-LINKAGE-IND           PIC X.
   859         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   860         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   861                                                   LOW-VALUES.
   862
   863     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   864     12  PI-CLAIM-PW-SESSION             PIC X(1).
   865         88  PI-CLAIM-CREDIT                 VALUE '1'.
   866         88  PI-CLAIM-CONVEN                 VALUE '2'.
   867     12  FILLER                          PIC X(4).
   868
   869     12  PI-SYSTEM-LEVEL                 PIC X(145).
   870
   871     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   872         PI-SYSTEM-LEVEL.
   873
   874         16  PI-ENTRY-CODES.
   875             20  PI-ENTRY-CD-1           PIC X.
   876             20  PI-ENTRY-CD-2           PIC X.
   877
   878         16  PI-RETURN-CODES.
   879             20  PI-RETURN-CD-1          PIC X.
   880             20  PI-RETURN-CD-2          PIC X.
   881
   882         16  PI-UPDATE-STATUS-SAVE.
   883             20  PI-UPDATE-BY            PIC X(4).
   884             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   885
   886         16  PI-LOWER-CASE-LETTERS       PIC X.
   887             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   888
   889*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   890*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   891*            88  CARRIER-CLM-CNTL            VALUE '2'.
   892
   893         16  PI-CERT-ACCESS-CONTROL      PIC X.
   894             88  ST-ACCNT-CNTL               VALUE ' '.
   895             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   896             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   897             88  ACCNT-CNTL                  VALUE '3'.
   898             88  CARR-ACCNT-CNTL             VALUE '4'.
   899
   900         16  PI-PROCESSOR-CAP-LIST.
   901             20  PI-SYSTEM-CONTROLS.
   902                24 PI-SYSTEM-DISPLAY     PIC X.
   903                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   904                24 PI-SYSTEM-MODIFY      PIC X.
   905                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   906             20  FILLER                  PIC XX.
   907             20  PI-DISPLAY-CAP          PIC X.
   908                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL635.cbl
   909             20  PI-MODIFY-CAP           PIC X.
   910                 88  MODIFY-CAP              VALUE 'Y'.
   911             20  PI-MSG-AT-LOGON-CAP     PIC X.
   912                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   913             20  PI-FORCE-CAP            PIC X.
   914                 88  FORCE-CAP               VALUE 'Y'.
   915
   916         16  PI-PROGRAM-CONTROLS.
   917             20  PI-PGM-PRINT-OPT        PIC X.
   918             20  PI-PGM-FORMAT-OPT       PIC X.
   919             20  PI-PGM-PROCESS-OPT      PIC X.
   920             20  PI-PGM-TOTALS-OPT       PIC X.
   921
   922         16  PI-HELP-INTERFACE.
   923             20  PI-LAST-ERROR-NO        PIC X(4).
   924             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   925
   926         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   927             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   928
   929         16  PI-CR-CONTROL-IN-PROGRESS.
   930             20  PI-CR-CARRIER           PIC X.
   931             20  PI-CR-GROUPING          PIC X(6).
   932             20  PI-CR-STATE             PIC XX.
   933             20  PI-CR-ACCOUNT           PIC X(10).
   934             20  PI-CR-FIN-RESP          PIC X(10).
   935             20  PI-CR-TYPE              PIC X.
   936
   937         16  PI-CR-BATCH-NUMBER          PIC X(6).
   938
   939         16  PI-CR-MONTH-END-DT          PIC XX.
   940
   941         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   942             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   943             88  PI-ZERO-CARRIER             VALUE '1'.
   944             88  PI-ZERO-GROUPING            VALUE '2'.
   945             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   946
   947         16  PI-CARRIER-SECURITY         PIC X.
   948             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   949
   950         16  PI-ACCOUNT-SECURITY         PIC X(10).
   951             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   952             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   953
   954         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   955             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   956                                         INDEXED BY PI-ACCESS-NDX
   957                                         PIC X.
   958
   959         16  PI-GA-BILLING-CONTROL       PIC X.
   960             88  PI-GA-BILLING               VALUE '1'.
   961
   962         16  PI-MAIL-PROCESSING          PIC X.
   963             88  PI-MAIL-YES                 VALUE 'Y'.
   964
   965         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   966
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL635.cbl
   967         16  PI-AR-SYSTEM.
   968             20  PI-AR-PROCESSING-CNTL   PIC X.
   969                 88  PI-AR-PROCESSING        VALUE 'Y'.
   970             20  PI-AR-SUMMARY-CODE      PIC X(6).
   971             20  PI-AR-MONTH-END-DT      PIC XX.
   972
   973         16  PI-MP-SYSTEM.
   974             20  PI-MORTGAGE-USER            PIC X.
   975                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   976                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   977             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   978                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   979                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   980                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   981                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   982                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   983             20  PI-MP-MONTH-END-DT          PIC XX.
   984             20  PI-MP-REFERENCE-NO.
   985                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   986                 24  PI-MP-REFERENCE-SFX     PIC XX.
   987
   988         16  PI-LABEL-CONTROL            PIC X(01).
   989             88  PI-CREATE-LABELS                    VALUE 'Y'.
   990             88  PI-BYPASS-LABELS                    VALUE 'N'.
   991
   992         16  PI-BILL-GROUPING-CODE       PIC X(01).
   993             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   994
   995         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   996             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   997             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   998
   999         16  FILLER                      PIC X(14).
  1000
  1001     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1002******************************************************************
  1003     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1004         16  PI-PYAJ-FILE-SW         PIC  X.
  1005             88  END-OF-ACCT                 VALUE 'A'.
  1006             88  END-OF-FILE                 VALUE 'X'.
  1007             88  TOP-OF-FILE                 VALUE 'T'.
  1008             88  PAGE-FULL                   VALUE 'F'.
  1009             88  NO-RECORDS                  VALUE 'Y'.
  1010             88  NOT-OPEN                    VALUE 'Z'.
  1011         16  PI-PREV-FUNCTION        PIC  X.
  1012         16  PI-SAV-FUNCTION         PIC  X.
  1013         16  PI-SEQ-NOS.
  1014             20  FILLER  OCCURS 3 TIMES
  1015                             INDEXED BY NDX.
  1016                 24  PI-REC-TYPE     PIC  X.
  1017                 24  PI-FILE-SEQ-NO  PIC S9(8)          COMP.
  1018                 24  PI-APPLIED      PIC  X.
  1019                 24  PI-REFERENCE    PIC  X(12).
  1020                 24  PI-INVOICE      PIC  X(6).
  1021                 24  PI-AMOUNT       PIC  S9(7)V99 COMP-3.
  1022         16  PI-SAV-ENDING-PYAJ-KEY.
  1023             20  PI-SAV-COMP-CD      PIC  X.
  1024             20  PI-SAV-COMP-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL635.cbl
  1025                 24  PI-SAV-CARRIER      PIC  X.
  1026                 24  PI-SAV-GROUPING     PIC  X(6).
  1027                 24  PI-SAV-FIN-RESP     PIC  X(10).
  1028                 24  PI-SAV-ACCOUNT      PIC  X(10).
  1029                 24  PI-SAV-FILE-SEQ-NO  PIC S9(8)          COMP.
  1030                 24  PI-SAV-RECORD-TYPE  PIC  X.
  1031         16  PI-SAV-ACCT-AMT         PIC  S9(7)V99.
  1032         16  PI-SAV-ACCT-NET         PIC  S9(7)V99.
  1033         16  PI-TOTAL-DISPLAYED-SW   PIC  X.
  1034             88  PI-TOTAL-DISPLAYED          VALUE 'Y'.
  1035         16  PI-SPECIAL-GROUPING-SW  PIC X.
  1036             88  PI-SPECIAL-GROUPING         VALUE 'G'.
  1037         16  FILLER                  PIC X(60).
  1038         16  PI-PYAJ-FILLED-SW       PIC X.
  1039            88  REFERENCE-DISPLAYED  VALUE 'Y'.
  1040         16  PI-PYAJ-REFERENCE       PIC X(12).
  1041         16  PI-ACCEPT               PIC XXX.
  1042         16  FILLER                  PIC X(421).
  1043
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL635.cbl
  1045*    COPY ELCJPFX.
  1046******************************************************************
  1047*                                                                *
  1048*                                                                *
  1049*                            ELCJPFX.                            *
  1050*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1051*                            VMOD=2.002                          *
  1052*                                                                *
  1053*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1054*                                                                *
  1055*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1056*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1057*        ELCNTL - CONTROL FILE                                   *
  1058*        ELMSTR - CLAIM MASTERS                                  *
  1059*        ELTRLR - ACTIVITY TRAILERS                              *
  1060*        ELCHKQ - CHECK QUE                                      *
  1061******************************************************************
  1062 01  JOURNAL-RECORD.
  1063     12  JP-USER-ID                  PIC X(4).
  1064     12  JP-FILE-ID                  PIC X(8).
  1065     12  JP-PROGRAM-ID               PIC X(8).
  1066     12  JP-RECORD-TYPE              PIC X.
  1067         88 JP-ADD              VALUE 'A'.
  1068         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1069         88 JP-AFTER-CHANGE     VALUE 'C'.
  1070         88 JP-DELETE           VALUE 'D'.
  1071         88 JP-GENERIC-DELETE   VALUE 'G'.
  1072         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1073         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1074     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1075     12  JP-RECORD-AREA
  1076
  1077
  1078                             PIC  X(223).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL635.cbl
  1080*    COPY ELCAID.
  1081******************************************************************
  1082*                                                                *
  1083*                            ELCAID.                             *
  1084*                            VMOD=2.001                          *
  1085*                                                                *
  1086*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1087*                                                                *
  1088*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1089*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1090******************************************************************
  1091
  1092 01  DFHAID.
  1093   02  DFHNULL   PIC  X  VALUE  ' '.
  1094   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1095   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1096   02  DFHPEN    PIC  X  VALUE  '='.
  1097   02  DFHOPID   PIC  X  VALUE  'W'.
  1098   02  DFHPA1    PIC  X  VALUE  '%'.
  1099   02  DFHPA2    PIC  X  VALUE  '>'.
  1100   02  DFHPA3    PIC  X  VALUE  ','.
  1101   02  DFHPF1    PIC  X  VALUE  '1'.
  1102   02  DFHPF2    PIC  X  VALUE  '2'.
  1103   02  DFHPF3    PIC  X  VALUE  '3'.
  1104   02  DFHPF4    PIC  X  VALUE  '4'.
  1105   02  DFHPF5    PIC  X  VALUE  '5'.
  1106   02  DFHPF6    PIC  X  VALUE  '6'.
  1107   02  DFHPF7    PIC  X  VALUE  '7'.
  1108   02  DFHPF8    PIC  X  VALUE  '8'.
  1109   02  DFHPF9    PIC  X  VALUE  '9'.
  1110   02  DFHPF10   PIC  X  VALUE  ':'.
  1111   02  DFHPF11   PIC  X  VALUE  '#'.
  1112   02  DFHPF12   PIC  X  VALUE  '@'.
  1113   02  DFHPF13   PIC  X  VALUE  'A'.
  1114   02  DFHPF14   PIC  X  VALUE  'B'.
  1115   02  DFHPF15   PIC  X  VALUE  'C'.
  1116   02  DFHPF16   PIC  X  VALUE  'D'.
  1117   02  DFHPF17   PIC  X  VALUE  'E'.
  1118   02  DFHPF18   PIC  X  VALUE  'F'.
  1119   02  DFHPF19   PIC  X  VALUE  'G'.
  1120   02  DFHPF20   PIC  X  VALUE  'H'.
  1121   02  DFHPF21   PIC  X  VALUE  'I'.
  1122*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1123   02  DFHPF22   PIC  X  VALUE  '['.
  1124   02  DFHPF23   PIC  X  VALUE  '.'.
  1125   02  DFHPF24   PIC  X  VALUE  '<'.
  1126   02  DFHMSRE   PIC  X  VALUE  'X'.
  1127   02  DFHSTRF   PIC  X  VALUE  'h'.
  1128   02  DFHTRIG   PIC  X  VALUE  '"'.
  1129
  1130 01  FILLER  REDEFINES  DFHAID.
  1131     12  FILLER              PIC  X(8).
  1132     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL635.cbl
  1134*    COPY EL635S.
  1135 01  EL635AI.
  1136     05  FILLER            PIC  X(0012).
  1137*    -------------------------------
  1138     05  DATEL PIC S9(0004) COMP.
  1139     05  DATEF PIC  X(0001).
  1140     05  FILLER REDEFINES DATEF.
  1141         10  DATEA PIC  X(0001).
  1142     05  DATEI PIC  X(0008).
  1143*    -------------------------------
  1144     05  TIMEL PIC S9(0004) COMP.
  1145     05  TIMEF PIC  X(0001).
  1146     05  FILLER REDEFINES TIMEF.
  1147         10  TIMEA PIC  X(0001).
  1148     05  TIMEI PIC  X(0005).
  1149*    -------------------------------
  1150     05  MAINTL PIC S9(0004) COMP.
  1151     05  MAINTF PIC  X(0001).
  1152     05  FILLER REDEFINES MAINTF.
  1153         10  MAINTA PIC  X(0001).
  1154     05  MAINTI PIC  X(0001).
  1155*    -------------------------------
  1156     05  CARRIERL PIC S9(0004) COMP.
  1157     05  CARRIERF PIC  X(0001).
  1158     05  FILLER REDEFINES CARRIERF.
  1159         10  CARRIERA PIC  X(0001).
  1160     05  CARRIERI PIC  X(0001).
  1161*    -------------------------------
  1162     05  GROUPL PIC S9(0004) COMP.
  1163     05  GROUPF PIC  X(0001).
  1164     05  FILLER REDEFINES GROUPF.
  1165         10  GROUPA PIC  X(0001).
  1166     05  GROUPI PIC  X(0006).
  1167*    -------------------------------
  1168     05  FINRESPL PIC S9(0004) COMP.
  1169     05  FINRESPF PIC  X(0001).
  1170     05  FILLER REDEFINES FINRESPF.
  1171         10  FINRESPA PIC  X(0001).
  1172     05  FINRESPI PIC  X(0010).
  1173*    -------------------------------
  1174     05  ACCTHDGL PIC S9(0004) COMP.
  1175     05  ACCTHDGF PIC  X(0001).
  1176     05  FILLER REDEFINES ACCTHDGF.
  1177         10  ACCTHDGA PIC  X(0001).
  1178     05  ACCTHDGI PIC  X(0010).
  1179*    -------------------------------
  1180     05  ACCTL PIC S9(0004) COMP.
  1181     05  ACCTF PIC  X(0001).
  1182     05  FILLER REDEFINES ACCTF.
  1183         10  ACCTA PIC  X(0001).
  1184     05  ACCTI PIC  X(0010).
  1185*    -------------------------------
  1186     05  EMHD1L PIC S9(0004) COMP.
  1187     05  EMHD1F PIC  X(0001).
  1188     05  FILLER REDEFINES EMHD1F.
  1189         10  EMHD1A PIC  X(0001).
  1190     05  EMHD1I PIC  X(0006).
  1191*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL635.cbl
  1192     05  EMHD2L PIC S9(0004) COMP.
  1193     05  EMHD2F PIC  X(0001).
  1194     05  FILLER REDEFINES EMHD2F.
  1195         10  EMHD2A PIC  X(0001).
  1196     05  EMHD2I PIC  X(0079).
  1197*    -------------------------------
  1198     05  COMM1L PIC S9(0004) COMP.
  1199     05  COMM1F PIC  X(0001).
  1200     05  FILLER REDEFINES COMM1F.
  1201         10  COMM1A PIC  X(0001).
  1202     05  COMM1I PIC  X(0030).
  1203*    -------------------------------
  1204     05  TYPE1L PIC S9(0004) COMP.
  1205     05  TYPE1F PIC  X(0001).
  1206     05  FILLER REDEFINES TYPE1F.
  1207         10  TYPE1A PIC  X(0001).
  1208     05  TYPE1I PIC  X(0001).
  1209*    -------------------------------
  1210     05  AMT1L PIC S9(0004) COMP.
  1211     05  AMT1F PIC  X(0001).
  1212     05  FILLER REDEFINES AMT1F.
  1213         10  AMT1A PIC  X(0001).
  1214     05  AMT1I PIC  X(0011).
  1215*    -------------------------------
  1216     05  APLID1L PIC S9(0004) COMP.
  1217     05  APLID1F PIC  X(0001).
  1218     05  FILLER REDEFINES APLID1F.
  1219         10  APLID1A PIC  X(0001).
  1220     05  APLID1I PIC  X(0001).
  1221*    -------------------------------
  1222     05  VOID1L PIC S9(0004) COMP.
  1223     05  VOID1F PIC  X(0001).
  1224     05  FILLER REDEFINES VOID1F.
  1225         10  VOID1A PIC  X(0001).
  1226     05  VOID1I PIC  X(0001).
  1227*    -------------------------------
  1228     05  MDT1L PIC S9(0004) COMP.
  1229     05  MDT1F PIC  X(0001).
  1230     05  FILLER REDEFINES MDT1F.
  1231         10  MDT1A PIC  X(0001).
  1232     05  MDT1I PIC  X(0006).
  1233*    -------------------------------
  1234     05  BDT1L PIC S9(0004) COMP.
  1235     05  BDT1F PIC  X(0001).
  1236     05  FILLER REDEFINES BDT1F.
  1237         10  BDT1A PIC  X(0001).
  1238     05  BDT1I PIC  X(0006).
  1239*    -------------------------------
  1240     05  SDT1L PIC S9(0004) COMP.
  1241     05  SDT1F PIC  X(0001).
  1242     05  FILLER REDEFINES SDT1F.
  1243         10  SDT1A PIC  X(0001).
  1244     05  SDT1I PIC  X(0006).
  1245*    -------------------------------
  1246     05  REF1L PIC S9(0004) COMP.
  1247     05  REF1F PIC  X(0001).
  1248     05  FILLER REDEFINES REF1F.
  1249         10  REF1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL635.cbl
  1250     05  REF1I PIC  X(0012).
  1251*    -------------------------------
  1252     05  SUM1L PIC S9(0004) COMP.
  1253     05  SUM1F PIC  X(0001).
  1254     05  FILLER REDEFINES SUM1F.
  1255         10  SUM1A PIC  X(0001).
  1256     05  SUM1I PIC  X(0006).
  1257*    -------------------------------
  1258     05  NETOT1L PIC S9(0004) COMP.
  1259     05  NETOT1F PIC  X(0001).
  1260     05  FILLER REDEFINES NETOT1F.
  1261         10  NETOT1A PIC  X(0001).
  1262     05  NETOT1I PIC  X(0011).
  1263*    -------------------------------
  1264     05  INPDT1L PIC S9(0004) COMP.
  1265     05  INPDT1F PIC  X(0001).
  1266     05  FILLER REDEFINES INPDT1F.
  1267         10  INPDT1A PIC  X(0001).
  1268     05  INPDT1I PIC  X(0006).
  1269*    -------------------------------
  1270     05  CREDIT1L PIC S9(0004) COMP.
  1271     05  CREDIT1F PIC  X(0001).
  1272     05  FILLER REDEFINES CREDIT1F.
  1273         10  CREDIT1A PIC  X(0001).
  1274     05  CREDIT1I PIC  X(0014).
  1275*    -------------------------------
  1276     05  DEBIT1L PIC S9(0004) COMP.
  1277     05  DEBIT1F PIC  X(0001).
  1278     05  FILLER REDEFINES DEBIT1F.
  1279         10  DEBIT1A PIC  X(0001).
  1280     05  DEBIT1I PIC  X(0014).
  1281*    -------------------------------
  1282     05  COMM2L PIC S9(0004) COMP.
  1283     05  COMM2F PIC  X(0001).
  1284     05  FILLER REDEFINES COMM2F.
  1285         10  COMM2A PIC  X(0001).
  1286     05  COMM2I PIC  X(0030).
  1287*    -------------------------------
  1288     05  TYPE2L PIC S9(0004) COMP.
  1289     05  TYPE2F PIC  X(0001).
  1290     05  FILLER REDEFINES TYPE2F.
  1291         10  TYPE2A PIC  X(0001).
  1292     05  TYPE2I PIC  X(0001).
  1293*    -------------------------------
  1294     05  AMT2L PIC S9(0004) COMP.
  1295     05  AMT2F PIC  X(0001).
  1296     05  FILLER REDEFINES AMT2F.
  1297         10  AMT2A PIC  X(0001).
  1298     05  AMT2I PIC  X(0011).
  1299*    -------------------------------
  1300     05  APLID2L PIC S9(0004) COMP.
  1301     05  APLID2F PIC  X(0001).
  1302     05  FILLER REDEFINES APLID2F.
  1303         10  APLID2A PIC  X(0001).
  1304     05  APLID2I PIC  X(0001).
  1305*    -------------------------------
  1306     05  VOID2L PIC S9(0004) COMP.
  1307     05  VOID2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL635.cbl
  1308     05  FILLER REDEFINES VOID2F.
  1309         10  VOID2A PIC  X(0001).
  1310     05  VOID2I PIC  X(0001).
  1311*    -------------------------------
  1312     05  MDT2L PIC S9(0004) COMP.
  1313     05  MDT2F PIC  X(0001).
  1314     05  FILLER REDEFINES MDT2F.
  1315         10  MDT2A PIC  X(0001).
  1316     05  MDT2I PIC  X(0006).
  1317*    -------------------------------
  1318     05  BDT2L PIC S9(0004) COMP.
  1319     05  BDT2F PIC  X(0001).
  1320     05  FILLER REDEFINES BDT2F.
  1321         10  BDT2A PIC  X(0001).
  1322     05  BDT2I PIC  X(0006).
  1323*    -------------------------------
  1324     05  SDT2L PIC S9(0004) COMP.
  1325     05  SDT2F PIC  X(0001).
  1326     05  FILLER REDEFINES SDT2F.
  1327         10  SDT2A PIC  X(0001).
  1328     05  SDT2I PIC  X(0006).
  1329*    -------------------------------
  1330     05  REF2L PIC S9(0004) COMP.
  1331     05  REF2F PIC  X(0001).
  1332     05  FILLER REDEFINES REF2F.
  1333         10  REF2A PIC  X(0001).
  1334     05  REF2I PIC  X(0012).
  1335*    -------------------------------
  1336     05  SUM2L PIC S9(0004) COMP.
  1337     05  SUM2F PIC  X(0001).
  1338     05  FILLER REDEFINES SUM2F.
  1339         10  SUM2A PIC  X(0001).
  1340     05  SUM2I PIC  X(0006).
  1341*    -------------------------------
  1342     05  NETOT2L PIC S9(0004) COMP.
  1343     05  NETOT2F PIC  X(0001).
  1344     05  FILLER REDEFINES NETOT2F.
  1345         10  NETOT2A PIC  X(0001).
  1346     05  NETOT2I PIC  X(0011).
  1347*    -------------------------------
  1348     05  INPDT2L PIC S9(0004) COMP.
  1349     05  INPDT2F PIC  X(0001).
  1350     05  FILLER REDEFINES INPDT2F.
  1351         10  INPDT2A PIC  X(0001).
  1352     05  INPDT2I PIC  X(0006).
  1353*    -------------------------------
  1354     05  CREDIT2L PIC S9(0004) COMP.
  1355     05  CREDIT2F PIC  X(0001).
  1356     05  FILLER REDEFINES CREDIT2F.
  1357         10  CREDIT2A PIC  X(0001).
  1358     05  CREDIT2I PIC  X(0014).
  1359*    -------------------------------
  1360     05  DEBIT2L PIC S9(0004) COMP.
  1361     05  DEBIT2F PIC  X(0001).
  1362     05  FILLER REDEFINES DEBIT2F.
  1363         10  DEBIT2A PIC  X(0001).
  1364     05  DEBIT2I PIC  X(0014).
  1365*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL635.cbl
  1366     05  COMM3L PIC S9(0004) COMP.
  1367     05  COMM3F PIC  X(0001).
  1368     05  FILLER REDEFINES COMM3F.
  1369         10  COMM3A PIC  X(0001).
  1370     05  COMM3I PIC  X(0030).
  1371*    -------------------------------
  1372     05  TYPE3L PIC S9(0004) COMP.
  1373     05  TYPE3F PIC  X(0001).
  1374     05  FILLER REDEFINES TYPE3F.
  1375         10  TYPE3A PIC  X(0001).
  1376     05  TYPE3I PIC  X(0001).
  1377*    -------------------------------
  1378     05  AMT3L PIC S9(0004) COMP.
  1379     05  AMT3F PIC  X(0001).
  1380     05  FILLER REDEFINES AMT3F.
  1381         10  AMT3A PIC  X(0001).
  1382     05  AMT3I PIC  X(0011).
  1383*    -------------------------------
  1384     05  APLID3L PIC S9(0004) COMP.
  1385     05  APLID3F PIC  X(0001).
  1386     05  FILLER REDEFINES APLID3F.
  1387         10  APLID3A PIC  X(0001).
  1388     05  APLID3I PIC  X(0001).
  1389*    -------------------------------
  1390     05  VOID3L PIC S9(0004) COMP.
  1391     05  VOID3F PIC  X(0001).
  1392     05  FILLER REDEFINES VOID3F.
  1393         10  VOID3A PIC  X(0001).
  1394     05  VOID3I PIC  X(0001).
  1395*    -------------------------------
  1396     05  MDT3L PIC S9(0004) COMP.
  1397     05  MDT3F PIC  X(0001).
  1398     05  FILLER REDEFINES MDT3F.
  1399         10  MDT3A PIC  X(0001).
  1400     05  MDT3I PIC  X(0006).
  1401*    -------------------------------
  1402     05  BDT3L PIC S9(0004) COMP.
  1403     05  BDT3F PIC  X(0001).
  1404     05  FILLER REDEFINES BDT3F.
  1405         10  BDT3A PIC  X(0001).
  1406     05  BDT3I PIC  X(0006).
  1407*    -------------------------------
  1408     05  SDT3L PIC S9(0004) COMP.
  1409     05  SDT3F PIC  X(0001).
  1410     05  FILLER REDEFINES SDT3F.
  1411         10  SDT3A PIC  X(0001).
  1412     05  SDT3I PIC  X(0006).
  1413*    -------------------------------
  1414     05  REF3L PIC S9(0004) COMP.
  1415     05  REF3F PIC  X(0001).
  1416     05  FILLER REDEFINES REF3F.
  1417         10  REF3A PIC  X(0001).
  1418     05  REF3I PIC  X(0012).
  1419*    -------------------------------
  1420     05  SUM3L PIC S9(0004) COMP.
  1421     05  SUM3F PIC  X(0001).
  1422     05  FILLER REDEFINES SUM3F.
  1423         10  SUM3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL635.cbl
  1424     05  SUM3I PIC  X(0006).
  1425*    -------------------------------
  1426     05  NETOT3L PIC S9(0004) COMP.
  1427     05  NETOT3F PIC  X(0001).
  1428     05  FILLER REDEFINES NETOT3F.
  1429         10  NETOT3A PIC  X(0001).
  1430     05  NETOT3I PIC  X(0011).
  1431*    -------------------------------
  1432     05  INPDT3L PIC S9(0004) COMP.
  1433     05  INPDT3F PIC  X(0001).
  1434     05  FILLER REDEFINES INPDT3F.
  1435         10  INPDT3A PIC  X(0001).
  1436     05  INPDT3I PIC  X(0006).
  1437*    -------------------------------
  1438     05  CREDIT3L PIC S9(0004) COMP.
  1439     05  CREDIT3F PIC  X(0001).
  1440     05  FILLER REDEFINES CREDIT3F.
  1441         10  CREDIT3A PIC  X(0001).
  1442     05  CREDIT3I PIC  X(0014).
  1443*    -------------------------------
  1444     05  DEBIT3L PIC S9(0004) COMP.
  1445     05  DEBIT3F PIC  X(0001).
  1446     05  FILLER REDEFINES DEBIT3F.
  1447         10  DEBIT3A PIC  X(0001).
  1448     05  DEBIT3I PIC  X(0014).
  1449*    -------------------------------
  1450     05  ERRMSG1L PIC S9(0004) COMP.
  1451     05  ERRMSG1F PIC  X(0001).
  1452     05  FILLER REDEFINES ERRMSG1F.
  1453         10  ERRMSG1A PIC  X(0001).
  1454     05  ERRMSG1I PIC  X(0079).
  1455*    -------------------------------
  1456     05  ERRMSG2L PIC S9(0004) COMP.
  1457     05  ERRMSG2F PIC  X(0001).
  1458     05  FILLER REDEFINES ERRMSG2F.
  1459         10  ERRMSG2A PIC  X(0001).
  1460     05  ERRMSG2I PIC  X(0079).
  1461*    -------------------------------
  1462     05  PFENTERL PIC S9(0004) COMP.
  1463     05  PFENTERF PIC  X(0001).
  1464     05  FILLER REDEFINES PFENTERF.
  1465         10  PFENTERA PIC  X(0001).
  1466     05  PFENTERI PIC  9(2).
  1467*    -------------------------------
  1468     05  PFGABILL PIC S9(0004) COMP.
  1469     05  PFGABILF PIC  X(0001).
  1470     05  FILLER REDEFINES PFGABILF.
  1471         10  PFGABILA PIC  X(0001).
  1472     05  PFGABILI PIC  X(0014).
  1473*    -------------------------------
  1474     05  PFACBILL PIC S9(0004) COMP.
  1475     05  PFACBILF PIC  X(0001).
  1476     05  FILLER REDEFINES PFACBILF.
  1477         10  PFACBILA PIC  X(0001).
  1478     05  PFACBILI PIC  X(0016).
  1479 01  EL635AO REDEFINES EL635AI.
  1480     05  FILLER            PIC  X(0012).
  1481*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL635.cbl
  1482     05  FILLER            PIC  X(0003).
  1483     05  DATEO PIC  X(0008).
  1484*    -------------------------------
  1485     05  FILLER            PIC  X(0003).
  1486     05  TIMEO PIC  99.99.
  1487*    -------------------------------
  1488     05  FILLER            PIC  X(0003).
  1489     05  MAINTO PIC  X(0001).
  1490*    -------------------------------
  1491     05  FILLER            PIC  X(0003).
  1492     05  CARRIERO PIC  X(0001).
  1493*    -------------------------------
  1494     05  FILLER            PIC  X(0003).
  1495     05  GROUPO PIC  X(0006).
  1496*    -------------------------------
  1497     05  FILLER            PIC  X(0003).
  1498     05  FINRESPO PIC  X(0010).
  1499*    -------------------------------
  1500     05  FILLER            PIC  X(0003).
  1501     05  ACCTHDGO PIC  X(0010).
  1502*    -------------------------------
  1503     05  FILLER            PIC  X(0003).
  1504     05  ACCTO PIC  X(0010).
  1505*    -------------------------------
  1506     05  FILLER            PIC  X(0003).
  1507     05  EMHD1O PIC  X(0006).
  1508*    -------------------------------
  1509     05  FILLER            PIC  X(0003).
  1510     05  EMHD2O PIC  X(0079).
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
  1513     05  COMM1O PIC  X(0030).
  1514*    -------------------------------
  1515     05  FILLER            PIC  X(0003).
  1516     05  TYPE1O PIC  X(0001).
  1517*    -------------------------------
  1518     05  FILLER            PIC  X(0003).
  1519     05  AMT1O PIC  X(0011).
  1520*    -------------------------------
  1521     05  FILLER            PIC  X(0003).
  1522     05  APLID1O PIC  X(0001).
  1523*    -------------------------------
  1524     05  FILLER            PIC  X(0003).
  1525     05  VOID1O PIC  X(0001).
  1526*    -------------------------------
  1527     05  FILLER            PIC  X(0003).
  1528     05  MDT1O PIC  X(0006).
  1529*    -------------------------------
  1530     05  FILLER            PIC  X(0003).
  1531     05  BDT1O PIC  X(0006).
  1532*    -------------------------------
  1533     05  FILLER            PIC  X(0003).
  1534     05  SDT1O PIC  X(0006).
  1535*    -------------------------------
  1536     05  FILLER            PIC  X(0003).
  1537     05  REF1O PIC  X(0012).
  1538*    -------------------------------
  1539     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL635.cbl
  1540     05  SUM1O PIC  X(0006).
  1541*    -------------------------------
  1542     05  FILLER            PIC  X(0003).
  1543     05  NETOT1O PIC  X(0011).
  1544*    -------------------------------
  1545     05  FILLER            PIC  X(0003).
  1546     05  INPDT1O PIC  X(0006).
  1547*    -------------------------------
  1548     05  FILLER            PIC  X(0003).
  1549     05  CREDIT1O PIC  X(0014).
  1550*    -------------------------------
  1551     05  FILLER            PIC  X(0003).
  1552     05  DEBIT1O PIC  X(0014).
  1553*    -------------------------------
  1554     05  FILLER            PIC  X(0003).
  1555     05  COMM2O PIC  X(0030).
  1556*    -------------------------------
  1557     05  FILLER            PIC  X(0003).
  1558     05  TYPE2O PIC  X(0001).
  1559*    -------------------------------
  1560     05  FILLER            PIC  X(0003).
  1561     05  AMT2O PIC  X(0011).
  1562*    -------------------------------
  1563     05  FILLER            PIC  X(0003).
  1564     05  APLID2O PIC  X(0001).
  1565*    -------------------------------
  1566     05  FILLER            PIC  X(0003).
  1567     05  VOID2O PIC  X(0001).
  1568*    -------------------------------
  1569     05  FILLER            PIC  X(0003).
  1570     05  MDT2O PIC  X(0006).
  1571*    -------------------------------
  1572     05  FILLER            PIC  X(0003).
  1573     05  BDT2O PIC  X(0006).
  1574*    -------------------------------
  1575     05  FILLER            PIC  X(0003).
  1576     05  SDT2O PIC  X(0006).
  1577*    -------------------------------
  1578     05  FILLER            PIC  X(0003).
  1579     05  REF2O PIC  X(0012).
  1580*    -------------------------------
  1581     05  FILLER            PIC  X(0003).
  1582     05  SUM2O PIC  X(0006).
  1583*    -------------------------------
  1584     05  FILLER            PIC  X(0003).
  1585     05  NETOT2O PIC  X(0011).
  1586*    -------------------------------
  1587     05  FILLER            PIC  X(0003).
  1588     05  INPDT2O PIC  X(0006).
  1589*    -------------------------------
  1590     05  FILLER            PIC  X(0003).
  1591     05  CREDIT2O PIC  X(0014).
  1592*    -------------------------------
  1593     05  FILLER            PIC  X(0003).
  1594     05  DEBIT2O PIC  X(0014).
  1595*    -------------------------------
  1596     05  FILLER            PIC  X(0003).
  1597     05  COMM3O PIC  X(0030).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL635.cbl
  1598*    -------------------------------
  1599     05  FILLER            PIC  X(0003).
  1600     05  TYPE3O PIC  X(0001).
  1601*    -------------------------------
  1602     05  FILLER            PIC  X(0003).
  1603     05  AMT3O PIC  X(0011).
  1604*    -------------------------------
  1605     05  FILLER            PIC  X(0003).
  1606     05  APLID3O PIC  X(0001).
  1607*    -------------------------------
  1608     05  FILLER            PIC  X(0003).
  1609     05  VOID3O PIC  X(0001).
  1610*    -------------------------------
  1611     05  FILLER            PIC  X(0003).
  1612     05  MDT3O PIC  X(0006).
  1613*    -------------------------------
  1614     05  FILLER            PIC  X(0003).
  1615     05  BDT3O PIC  X(0006).
  1616*    -------------------------------
  1617     05  FILLER            PIC  X(0003).
  1618     05  SDT3O PIC  X(0006).
  1619*    -------------------------------
  1620     05  FILLER            PIC  X(0003).
  1621     05  REF3O PIC  X(0012).
  1622*    -------------------------------
  1623     05  FILLER            PIC  X(0003).
  1624     05  SUM3O PIC  X(0006).
  1625*    -------------------------------
  1626     05  FILLER            PIC  X(0003).
  1627     05  NETOT3O PIC  X(0011).
  1628*    -------------------------------
  1629     05  FILLER            PIC  X(0003).
  1630     05  INPDT3O PIC  X(0006).
  1631*    -------------------------------
  1632     05  FILLER            PIC  X(0003).
  1633     05  CREDIT3O PIC  X(0014).
  1634*    -------------------------------
  1635     05  FILLER            PIC  X(0003).
  1636     05  DEBIT3O PIC  X(0014).
  1637*    -------------------------------
  1638     05  FILLER            PIC  X(0003).
  1639     05  ERRMSG1O PIC  X(0079).
  1640*    -------------------------------
  1641     05  FILLER            PIC  X(0003).
  1642     05  ERRMSG2O PIC  X(0079).
  1643*    -------------------------------
  1644     05  FILLER            PIC  X(0003).
  1645     05  PFENTERO PIC  X(0002).
  1646*    -------------------------------
  1647     05  FILLER            PIC  X(0003).
  1648     05  PFGABILO PIC  X(0014).
  1649*    -------------------------------
  1650     05  FILLER            PIC  X(0003).
  1651     05  PFACBILO PIC  X(0016).
  1652*    -------------------------------
  1653
  1654 01  MAP-EL635A  REDEFINES  EL635AI.
  1655     12  FILLER                  PIC  X(178).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL635.cbl
  1656     12  DATA-AREA       OCCURS  3 TIMES
  1657                             INDEXED BY PINDX.
  1658         16  COMM-LEN            PIC S9(4)              COMP.
  1659         16  COMM-ATTRB          PIC  X.
  1660         16  COMM                PIC  X(30).
  1661         16  NCL-COMM  REDEFINES  COMM.
  1662             20  NCL-COMM-DTE.
  1663                 24  NCL-MO      PIC  XX.
  1664                 24  NCL-DA      PIC  XX.
  1665                 24  NCL-YR      PIC  XX.
  1666             20  NCL-COMM-REST   PIC  X(24).
  1667         16  RTYPE-LEN           PIC S9(4)              COMP.
  1668         16  RTYPE-ATTRB         PIC  X.
  1669         16  RTYPE               PIC  X.
  1670         16  AMT-LEN             PIC S9(4)              COMP.
  1671         16  AMT-ATTRB           PIC  X.
  1672         16  AMT                 PIC S9(9)V99.
  1673         16  AMTO  REDEFINES
  1674             AMT                 PIC Z(7).99-.
  1675         16  APPLIED-LEN         PIC S9(4)              COMP.
  1676         16  APPLIED-ATTRB       PIC  X.
  1677         16  APPLIED             PIC  X.
  1678         16  VOID-SW-LEN         PIC S9(4)              COMP.
  1679         16  VOID-SW-ATTRB       PIC  X.
  1680         16  VOID-SW             PIC  X.
  1681         16  MDTE-LEN            PIC S9(4)              COMP.
  1682         16  MDTE-ATTRB          PIC  X.
  1683         16  MDTE                PIC  9(6).
  1684         16  BDTE-LEN            PIC S9(4)              COMP.
  1685         16  BDTE-ATTRB          PIC  X.
  1686         16  BDTE                PIC  9(6).
  1687         16  SDTE-LEN            PIC S9(4)              COMP.
  1688         16  SDTE-ATTRB          PIC  X.
  1689         16  SDTE                PIC  9(6).
  1690         16  REF-LEN             PIC S9(4)              COMP.
  1691         16  REF-ATTRB           PIC  X.
  1692         16  REF                 PIC  X(12).
  1693         16  INVOICE-LEN         PIC S9(4)              COMP.
  1694         16  INVOICE-ATTRB       PIC  X.
  1695         16  INVOICE             PIC  X(6).
  1696         16  NET-LEN             PIC S9(4)              COMP.
  1697         16  NET-ATTRB           PIC  X.
  1698         16  NET                 PIC S9(9)V99.
  1699         16  NETO  REDEFINES
  1700             NET                 PIC Z(7).99-.
  1701         16  IDTE-LEN            PIC S9(4)              COMP.
  1702         16  IDTE-ATTRB          PIC  X.
  1703         16  IDTE                PIC  9(6).
  1704         16  CREDIT-LEN          PIC S9(4)              COMP.
  1705         16  CREDIT-ATTRB        PIC  X.
  1706         16  CREDIT              PIC  X(14).
  1707         16  DEBIT-LEN           PIC S9(4)              COMP.
  1708         16  DEBIT-ATTRB         PIC  X.
  1709         16  DEBIT               PIC  X(14).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL635.cbl
  1711****************************************************************
  1712*
  1713* Copyright (c) 2007 by Clerity Solutions, Inc.
  1714* All rights reserved.
  1715*
  1716****************************************************************
  1717 01  DFHEIV.
  1718   02  DFHEIV0               PIC X(35).
  1719   02  DFHEIV1               PIC X(08).
  1720   02  DFHEIV2               PIC X(08).
  1721   02  DFHEIV3               PIC X(08).
  1722   02  DFHEIV4               PIC X(06).
  1723   02  DFHEIV5               PIC X(04).
  1724   02  DFHEIV6               PIC X(04).
  1725   02  DFHEIV7               PIC X(02).
  1726   02  DFHEIV8               PIC X(02).
  1727   02  DFHEIV9               PIC X(01).
  1728   02  DFHEIV10              PIC S9(7) COMP-3.
  1729   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1730   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1731   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1732   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1733   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1734   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1735   02  DFHEIV17              PIC X(04).
  1736   02  DFHEIV18              PIC X(04).
  1737   02  DFHEIV19              PIC X(04).
  1738   02  DFHEIV20              USAGE IS POINTER.
  1739   02  DFHEIV21              USAGE IS POINTER.
  1740   02  DFHEIV22              USAGE IS POINTER.
  1741   02  DFHEIV23              USAGE IS POINTER.
  1742   02  DFHEIV24              USAGE IS POINTER.
  1743   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1744   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1745   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1746   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1747   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1748   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1749   02  FILLER                PIC X(02).
  1750   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1751   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1752   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1753   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1754   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1755 LINKAGE  SECTION.
  1756*****************************************************************
  1757*                                                               *
  1758* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1759* All rights reserved.                                          *
  1760*                                                               *
  1761*****************************************************************
  1762 01  dfheiblk.
  1763     02  eibtime          pic s9(7) comp-3.
  1764     02  eibdate          pic s9(7) comp-3.
  1765     02  eibtrnid         pic x(4).
  1766     02  eibtaskn         pic s9(7) comp-3.
  1767     02  eibtrmid         pic x(4).
  1768     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL635.cbl
  1769     02  eibcposn         pic s9(4) comp.
  1770     02  eibcalen         pic s9(4) comp.
  1771     02  eibaid           pic x(1).
  1772     02  eibfiller1       pic x(1).
  1773     02  eibfn            pic x(2).
  1774     02  eibfiller2       pic x(2).
  1775     02  eibrcode         pic x(6).
  1776     02  eibfiller3       pic x(2).
  1777     02  eibds            pic x(8).
  1778     02  eibreqid         pic x(8).
  1779     02  eibrsrce         pic x(8).
  1780     02  eibsync          pic x(1).
  1781     02  eibfree          pic x(1).
  1782     02  eibrecv          pic x(1).
  1783     02  eibsend          pic x(1).
  1784     02  eibatt           pic x(1).
  1785     02  eibeoc           pic x(1).
  1786     02  eibfmh           pic x(1).
  1787     02  eibcompl         pic x(1).
  1788     02  eibsig           pic x(1).
  1789     02  eibconf          pic x(1).
  1790     02  eiberr           pic x(1).
  1791     02  eibrldbk         pic x(1).
  1792     02  eiberrcd         pic x(4).
  1793     02  eibsynrb         pic x(1).
  1794     02  eibnodat         pic x(1).
  1795     02  eibfiller5       pic x(2).
  1796     02  eibresp          pic 9(09) comp.
  1797     02  eibresp2         pic 9(09) comp.
  1798     02  dfheigdj         pic s9(4) comp.
  1799     02  dfheigdk         pic s9(4) comp.
  1800 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL635.cbl
  1802*01 PARMLIST       COMP.
  1803*    12  FILLER              PIC S9(8).
  1804*    12  ERPYAJ-POINTER      PIC S9(8).
  1805*    12  ERCHKQ-POINTER      PIC S9(8).
  1806*    12  ERCOMP-POINTER      PIC S9(8).
  1807*    12  ERRECV-POINTER      PIC S9(8).
  1808*    12  MPPRCN-POINTER      PIC S9(8).
  1809
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL635.cbl
  1811*    COPY ERCPYAJ.
  1812******************************************************************
  1813*                                                                *
  1814*                            ERCPYAJ                             *
  1815*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1816*                            VMOD=2.015                          *
  1817*                                                                *
  1818*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  1819*                                                                *
  1820*                                                                *
  1821*   FILE TYPE = VSAM,KSDS                                        *
  1822*   RECORD SIZE = 200  RECFORM = FIXED                           *
  1823*                                                                *
  1824*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  1825*       ALTERNATE PATHS = NONE                                   *
  1826*                                                                *
  1827*   LOG = YES                                                    *
  1828*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1829******************************************************************
  1830******************************************************************
  1831*                   C H A N G E   L O G
  1832*
  1833* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1834*-----------------------------------------------------------------
  1835*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1836* EFFECTIVE    NUMBER
  1837*-----------------------------------------------------------------
  1838* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  1839* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  1840******************************************************************
  1841
  1842 01  PENDING-PAY-ADJ.
  1843     12  PY-RECORD-ID                     PIC XX.
  1844         88  VALID-PY-ID                        VALUE 'PY'.
  1845
  1846     12  PY-CONTROL-PRIMARY.
  1847         16  PY-COMPANY-CD                PIC X.
  1848         16  PY-CARRIER                   PIC X.
  1849         16  PY-GROUPING                  PIC X(6).
  1850         16  PY-FIN-RESP                  PIC X(10).
  1851         16  PY-ACCOUNT                   PIC X(10).
  1852         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  1853                                          PIC X(10).
  1854         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  1855         16  PY-RECORD-TYPE               PIC X.
  1856             88  PY-REMIT-RECEIVED            VALUE 'R'.
  1857             88  PY-DEPOSIT                   VALUE 'D'.
  1858             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  1859             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  1860             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  1861             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  1862             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  1863             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  1864             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  1865             88  PY-FICA-ENTRY                VALUE 'F'.
  1866             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  1867             88  PY-POLICY-FEE                VALUE 'W'.
  1868             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL635.cbl
  1869
  1870     12  PY-PYMT-TYPE                     PIC X.
  1871             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  1872             88  PY-REINS-PYMT                VALUE 'R'.
  1873             88  PY-EXP-PYMT                  VALUE 'E'.
  1874
  1875     12  PY-BIL-INV                       PIC X(6).
  1876     12  PY-REF-NO                        PIC X(12).
  1877
  1878     12  PY-LAST-MAINT-DT                 PIC XX.
  1879     12  PY-LAST-MAINT-BY                 PIC X(4).
  1880     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  1881
  1882     12  PY-PYADJ-RECORD.
  1883         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  1884         16  PY-ENTRY-COMMENT             PIC X(30).
  1885         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  1886             20  PY-GL-ACCOUNT            PIC X(10).
  1887             20  PY-GL-STATE              PIC X(02).
  1888             20  PY-GL-CANC-SW            PIC X(01).
  1889                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  1890                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  1891             20  PY-GL-COMMENT            PIC X(10).
  1892             20  FILLER      REDEFINES PY-GL-COMMENT.
  1893                 24  PY-GL-CHECK-NO       PIC 9(06).
  1894                 24  FILLER               PIC X(04).
  1895             20  FILLER                   PIC X(07).
  1896         16  PY-SAVE-ACCOUNT              PIC X(10).
  1897         16  PY-SAVE-TYPE                 PIC X(01).
  1898
  1899         16  PY-LETTERS.
  1900             20  PY-LETTER OCCURS 3 TIMES
  1901                           INDEXED BY PY-LET-NDX
  1902                                          PIC X(04).
  1903
  1904         16  PY-ERCOMP-TYPE               PIC X.
  1905             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  1906             88  PY-GA-TYPE                   VALUE 'G'.
  1907             88  PY-BANK-TYPE                 VALUE 'B'.
  1908         16  FILLER                       PIC X(05).
  1909
  1910     12  PY-RECORD-STATUS.
  1911         16  PY-CREDIT-SELECT-DT          PIC XX.
  1912         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  1913         16  PY-BILLED-DATE               PIC XX.
  1914         16  PY-REPORTED-DT               PIC XX.
  1915         16  PY-PMT-APPLIED               PIC X.
  1916             88  PY-ACCOUNT-PMT               VALUE 'A'.
  1917             88  PY-GA-PMT                    VALUE 'G'.
  1918             88  PY-OVWRITE-PMT               VALUE 'O'.
  1919             88  PY-NON-AR-PMT                VALUE 'N'.
  1920         16  FILLER                       PIC X(5).
  1921         16  PY-INPUT-DT                  PIC XX.
  1922         16  PY-CHECK-NUMBER              PIC X(6).
  1923         16  PY-VOID-SW                   PIC X.
  1924             88  PY-CHECK-VOIDED              VALUE 'V'.
  1925         16  PY-CHECK-ORIGIN-SW           PIC X.
  1926             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL635.cbl
  1927             88  PY-REFUND-CHECK              VALUE 'R'.
  1928             88  PY-GA-CHECK                  VALUE 'G'.
  1929             88  PY-CHECK-WRITTEN             VALUE 'W'.
  1930             88  PY-CHECK-REVERSAL            VALUE 'V'.
  1931         16  PY-CHECK-WRITTEN-DT          PIC XX.
  1932         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  1933         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  1934         16  PY-BILL-FLAG                 PIC X.
  1935             88  PY-BILLED                    VALUE 'B'.
  1936         16  PY-AR-FLAG                   PIC X.
  1937             88  PY-AR-CYCLE                  VALUE 'C'.
  1938             88  PY-AR-MONTH-END              VALUE 'M'.
  1939         16  PY-AR-DATE                   PIC XX.
  1940
  1941     12  PY-GL-CODES.
  1942         16  PY-GL-DB                     PIC X(14).
  1943         16  PY-GL-CR                     PIC X(14).
  1944         16  PY-GL-FLAG                   PIC X.
  1945         16  PY-GL-DATE                   PIC XX.
  1946
  1947     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  1948     12  FILLER                           PIC X(3).
  1949******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL635.cbl
  1951*    COPY ERCCHKQ.
  1952******************************************************************
  1953*                                                                *
  1954*                                                                *
  1955*                            ERCCHKQ                             *
  1956*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1957*                            VMOD=2.005                          *
  1958*                                                                *
  1959*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
  1960*                                                                *
  1961*   FILE TYPE = VSAM,KSDS                                        *
  1962*   RECORD SIZE = 100  RECFORM = FIXED                           *
  1963*                                                                *
  1964*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
  1965*       ALTERNATE PATH  = NONE                                   *
  1966*                                                                *
  1967*   LOG = YES                                                    *
  1968*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1969******************************************************************
  1970 01  CHECK-QUE.
  1971     12  CQ-RECORD-ID                PIC XX.
  1972         88  VALID-CQ-ID                     VALUE 'CQ'.
  1973
  1974     12  CQ-CONTROL-PRIMARY.
  1975         16  CQ-COMPANY-CD           PIC X.
  1976         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  1977         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  1978
  1979     12  CQ-ENTRY-TYPE               PIC X.
  1980             88  CHECK-ON-QUE           VALUE 'Q'.
  1981             88  ALIGNMENT-CHECK        VALUE 'A'.
  1982             88  MANUAL-CHECK           VALUE 'M'.
  1983             88  SPOILED-CHECK          VALUE 'S'.
  1984             88  VOIDED-CHECK           VALUE 'V'.
  1985             88  PAYMENT-ABORTED        VALUE 'X'.
  1986
  1987     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
  1988
  1989     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
  1990         CQ-CREDIT-MASTER-CNTL.
  1991         16  CQ-PYAJ-CARRIER         PIC X.
  1992         16  CQ-PYAJ-GROUPING        PIC X(6).
  1993         16  CQ-PYAJ-FIN-RESP        PIC X(10).
  1994         16  CQ-PYAJ-ACCOUNT         PIC X(10).
  1995         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
  1996         16  CQ-PYAJ-REC-TYPE        PIC X.
  1997         16  FILLER                  PIC X(18).
  1998
  1999     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
  2000         CQ-CREDIT-MASTER-CNTL.
  2001         16  CQ-CHEK-CARRIER         PIC X.
  2002         16  CQ-CHEK-GROUPING        PIC X(6).
  2003         16  CQ-CHEK-STATE           PIC XX.
  2004         16  CQ-CHEK-ACCOUNT         PIC X(10).
  2005         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
  2006         16  CQ-CHEK-CERT-NO.
  2007             20  CQ-CHEK-CERT-PRIME  PIC X(10).
  2008             20  CQ-CHEK-CERT-SFX    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL635.cbl
  2009         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  2010         16  CQ-CHEK-FIN-RESP        PIC X(10).
  2011         16  FILLER                  PIC X(06).
  2012
  2013     12  CQ-CHECK-NUMBER             PIC X(7).
  2014     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  2015     12  CQ-PAYMENT-TYPE             PIC X.
  2016             88  CQ-BILLING-CREDIT         VALUE '1'.
  2017             88  CQ-REFUND-PMT             VALUE '2'.
  2018             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
  2019     12  CQ-VOID-INDICATOR           PIC X.
  2020             88  CHECK-IS-VOID             VALUE 'V'.
  2021     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  2022     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  2023     12  CQ-CHECK-BY-USER            PIC X(4).
  2024     12  CQ-PRE-NUMBERING-SW         PIC X.
  2025       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  2026       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  2027
  2028     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  2029     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  2030     12  CQ-ACCOUNT-AGENT            PIC X(10).
  2031     12  CQ-CHECK-VOIDED-DT          PIC XX.
  2032
  2033     12  CQ-LETTERS-IND              PIC X.
  2034         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
  2035
  2036******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL635.cbl
  2038*    COPY ERCCOMP.
  2039******************************************************************
  2040*                                                                *
  2041*                                                                *
  2042*                            ERCCOMP                             *
  2043*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2044*                            VMOD=2.019                          *
  2045*                                                                *
  2046*   ONLINE CREDIT SYSTEM                                         *
  2047*                                                                *
  2048*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2049*                                                                *
  2050*   FILE TYPE = VSAM,KSDS                                        *
  2051*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2052*                                                                *
  2053*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2054*       ALTERNATE PATH = NONE                                    *
  2055*                                                                *
  2056*   LOG = NO                                                     *
  2057*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2058*                                                                *
  2059******************************************************************
  2060*                   C H A N G E   L O G
  2061*
  2062* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2063*-----------------------------------------------------------------
  2064*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2065* EFFECTIVE    NUMBER
  2066*-----------------------------------------------------------------
  2067* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2068* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2069* 092205    2005050300006  PEMA  ADD LEASE FEE
  2070* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2071* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2072* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2073* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2074* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2075******************************************************************
  2076
  2077 01  COMPENSATION-MASTER.
  2078     12  CO-RECORD-ID                          PIC XX.
  2079         88  VALID-CO-ID                          VALUE 'CO'.
  2080
  2081     12  CO-CONTROL-PRIMARY.
  2082         16  CO-COMPANY-CD                     PIC X.
  2083         16  CO-CONTROL.
  2084             20  CO-CTL-1.
  2085                 24  CO-CARR-GROUP.
  2086                     28  CO-CARRIER            PIC X.
  2087                     28  CO-GROUPING.
  2088                         32  CO-GROUP-PREFIX   PIC XXX.
  2089                         32  CO-GROUP-PRIME    PIC XXX.
  2090                 24  CO-RESP-NO.
  2091                     28  CO-RESP-PREFIX        PIC X(4).
  2092                     28  CO-RESP-PRIME         PIC X(6).
  2093             20  CO-CTL-2.
  2094                 24  CO-ACCOUNT.
  2095                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL635.cbl
  2096                     28  CO-ACCT-PRIME         PIC X(6).
  2097         16  CO-TYPE                           PIC X.
  2098             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2099             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2100             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2101
  2102     12  CO-MAINT-INFORMATION.
  2103         16  CO-LAST-MAINT-DT                  PIC XX.
  2104         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2105         16  CO-LAST-MAINT-USER                PIC X(4).
  2106     12  FILLER                                PIC XX.
  2107     12  CO-STMT-TYPE                          PIC XXX.
  2108     12  CO-COMP-TYPE                          PIC X.
  2109         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2110     12  CO-STMT-OWNER                         PIC X(4).
  2111     12  CO-BALANCE-CONTROL                    PIC X.
  2112         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2113         88  CO-NO-BALANCE                        VALUE 'N'.
  2114
  2115     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2116         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2117         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2118         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2119
  2120     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2121         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2122         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2123
  2124     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2125     12  CO-GA-DIRECT-DEP                      PIC X.
  2126     12  CO-FUTURE-SPACE                       PIC X.
  2127         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2128
  2129     12  CO-ACCT-NAME                          PIC X(30).
  2130     12  CO-MAIL-NAME                          PIC X(30).
  2131     12  CO-ADDR-1                             PIC X(30).
  2132     12  CO-ADDR-2                             PIC X(30).
  2133     12  CO-ADDR-3.
  2134         16  CO-ADDR-CITY                      PIC X(27).
  2135         16  CO-ADDR-STATE                     PIC XX.
  2136     12  CO-CSO-1099                           PIC X.
  2137     12  CO-ZIP.
  2138         16  CO-ZIP-PRIME.
  2139             20  CO-ZIP-PRI-1ST                PIC X.
  2140                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2141             20  FILLER                        PIC X(4).
  2142         16  CO-ZIP-PLUS4                      PIC X(4).
  2143     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2144         16  CO-CAN-POSTAL-1                   PIC XXX.
  2145         16  CO-CAN-POSTAL-2                   PIC XXX.
  2146         16  FILLER                            PIC XXX.
  2147     12  CO-SOC-SEC                            PIC X(13).
  2148     12  CO-TELEPHONE.
  2149         16  CO-AREA-CODE                      PIC XXX.
  2150         16  CO-PREFIX                         PIC XXX.
  2151         16  CO-PHONE                          PIC X(4).
  2152
  2153     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL635.cbl
  2154
  2155     12  CO-AR-BAL-LEVEL                       PIC X.
  2156         88  CO-AR-REF-LVL                        VALUE '1'.
  2157         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2158         88  CO-AR-BILL-LVL                       VALUE '2'.
  2159         88  CO-AR-AGT-LVL                        VALUE '3'.
  2160         88  CO-AR-FR-LVL                         VALUE '4'.
  2161
  2162     12  CO-AR-NORMAL-PRINT                    PIC X.
  2163         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2164         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2165
  2166     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2167
  2168     12  CO-AR-REPORTING                       PIC X.
  2169         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2170         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2171
  2172     12  CO-AR-PULL-CHECK                      PIC X.
  2173         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2174         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2175
  2176     12  CO-AR-BALANCE-PRINT                   PIC X.
  2177         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2178
  2179     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2180         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2181         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2182         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2183
  2184     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2185
  2186     12  CO-USER-CODE                          PIC X.
  2187     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2188
  2189******************************************************************
  2190*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2191*    THE LAST MONTH END RUN.
  2192******************************************************************
  2193
  2194     12  CO-LAST-ACTIVITY-DATE.
  2195         16  CO-ACT-YEAR                       PIC 99.
  2196         16  CO-ACT-MONTH                      PIC 99.
  2197         16  CO-ACT-DAY                        PIC 99.
  2198
  2199     12  CO-LAST-STMT-DT.
  2200         16  CO-LAST-STMT-YEAR                 PIC 99.
  2201         16  CO-LAST-STMT-MONTH                PIC 99.
  2202         16  CO-LAST-STMT-DAY                  PIC 99.
  2203
  2204     12  CO-MO-END-TOTALS.
  2205         16  CO-MONTHLY-TOTALS.
  2206             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2207             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2208             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2209             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  2210             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  2211
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL635.cbl
  2212         16  CO-AGING-TOTALS.
  2213             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2214             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2215             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2216             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2217
  2218         16  CO-YTD-TOTALS.
  2219             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2220             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2221
  2222         16  CO-OVER-UNDER-TOTALS.
  2223             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2224             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2225
  2226     12  CO-MISCELLANEOUS-TOTALS.
  2227         16  CO-FICA-TOTALS.
  2228             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2229             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2230
  2231         16  CO-CLAIM-TOTALS.
  2232             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2233             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2234
  2235******************************************************************
  2236*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2237*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2238******************************************************************
  2239
  2240     12  CO-CURRENT-TOTALS.
  2241         16  CO-CURRENT-LAST-STMT-DT.
  2242             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2243             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2244             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2245
  2246         16  CO-CURRENT-MONTHLY-TOTALS.
  2247             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2248             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2249             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2250             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2251             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2252
  2253         16  CO-CURRENT-AGING-TOTALS.
  2254             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2255             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2256             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2257             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2258
  2259         16  CO-CURRENT-YTD-TOTALS.
  2260             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2261             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2262
  2263     12  CO-PAID-COMM-TOTALS.
  2264         16  CO-YTD-PAID-COMMS.
  2265             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2266             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2267
  2268     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  2269         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL635.cbl
  2270         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2271
  2272     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2273         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2274         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2275         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2276         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2277         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2278         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2279         88  CO-FINAL-LETTER                  VALUE 'F'.
  2280         88  CO-RECONCILING                   VALUE 'R'.
  2281         88  CO-PHONE-CALL                    VALUE 'P'.
  2282         88  CO-LEGAL                         VALUE 'L'.
  2283         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2284         88  CO-WRITE-OFF                     VALUE 'W'.
  2285         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2286
  2287     12  CO-CSR-CODE                       PIC X(4).
  2288
  2289     12  CO-GA-STATUS-INFO.
  2290         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2291         16  CO-GA-TERMINATION-DT          PIC XX.
  2292         16  CO-GA-STATUS-CODE             PIC X.
  2293             88  CO-GA-ACTIVE                 VALUE 'A'.
  2294             88  CO-GA-INACTIVE               VALUE 'I'.
  2295             88  CO-GA-PENDING                VALUE 'P'.
  2296         16  CO-GA-COMMENTS.
  2297             20  CO-GA-COMMENT-1           PIC X(40).
  2298             20  CO-GA-COMMENT-2           PIC X(40).
  2299             20  CO-GA-COMMENT-3           PIC X(40).
  2300             20  CO-GA-COMMENT-4           PIC X(40).
  2301
  2302     12  CO-RPTCD2                         PIC X(10).
  2303
  2304     12  CO-TYPE-AGENT                     PIC X(01).
  2305         88  CO-CORPORATION                   VALUE 'C'.
  2306         88  CO-PARTNERSHIP                   VALUE 'P'.
  2307         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2308         88  CO-TRUST                         VALUE 'T'.
  2309         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2310
  2311     12  CO-FAXNO.
  2312         16  CO-FAX-AREA-CODE                  PIC XXX.
  2313         16  CO-FAX-PREFIX                     PIC XXX.
  2314         16  CO-FAX-PHONE                      PIC X(4).
  2315
  2316     12  CO-BANK-INFORMATION.
  2317         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2318         16  CO-BANK-TRANSIT-NON REDEFINES
  2319             CO-BANK-TRANSIT-NO                PIC 9(8).
  2320
  2321         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2322     12  CO-MISC-DEDUCT-INFO REDEFINES
  2323                  CO-BANK-INFORMATION.
  2324         16  CO-MD-GL-ACCT                     PIC X(10).
  2325         16  CO-MD-DIV                         PIC XX.
  2326         16  CO-MD-CENTER                      PIC X(4).
  2327         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL635.cbl
  2328         16  CO-CREATE-AP-CHECK                PIC X.
  2329         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2330         16  FILLER                            PIC XXX.
  2331     12  CO-ACH-STATUS                         PIC X.
  2332         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2333         88  CO-ACH-PENDING                        VALUE 'P'.
  2334
  2335     12  CO-BILL-SW                            PIC X.
  2336     12  CO-CONTROL-NAME                       PIC X(30).
  2337     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2338     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2339     12  CO-CLP-STATE                          PIC XX.
  2340     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2341     12  CO-SPP-REFUND-EDIT                    PIC X.
  2342
  2343******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL635.cbl
  2345*    COPY ERCRECV.
  2346******************************************************************
  2347*                                                                *
  2348*                                                                *
  2349*                            ERCRECV.                            *
  2350*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2351*                            VMOD=2.007                          *
  2352*                                                                *
  2353*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE                       *
  2354*                                                                *
  2355*   FILE TYPE = VSAM,KSDS                                        *
  2356*   RECORD SIZE =  300 RECFORM = FIXED                           *
  2357*                                                                *
  2358*   BASE CLUSTER = ERRECV                         RKP=2,LEN=53   *
  2359*       ALTERNATE PATH1 = ERRECV2  (BY CO, CARR, GROUP, AGENT,   *
  2360*                                      EMO-DT, BAL, ENTRY-TYPE,  *
  2361*                                      F.R, INVOICE, REFERENCE,  *
  2362*                                      RESPONSIBILITY, REC TYPE, *
  2363*                                      SEQ. NO.)                 *
  2364*                                                RKP=64 ,LEN=54  *
  2365*   LOG = NO                                                     *
  2366*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2367******************************************************************
  2368
  2369
  2370 01  ACCOUNTS-RECEIVABLE.
  2371     12  AR-RECORD-ID                      PIC XX.
  2372         88  VALID-AR-ID                      VALUE 'AR'.
  2373
  2374     12  AR-CONTROL-PRIMARY.
  2375         16  AR-COMPANY-CD                 PIC X.
  2376         16  AR-TYPE                       PIC X.
  2377             88 AR-NEW-BUSINESS VALUE '1'.
  2378         16  AR-CARRIER                    PIC X.
  2379         16  AR-GROUPING.
  2380             20 AR-GROUPING-PREFIX         PIC XXX.
  2381             20 AR-GROUPING-PRIME          PIC XXX.
  2382         16  AR-BAL-LEVEL                  PIC X.
  2383             88  AR-BAL-LVL-REF               VALUE '1'.
  2384             88  AR-BAL-LVL-BILL-REF          VALUE '1'.
  2385             88  AR-BAL-LVL-BILL              VALUE '2'.
  2386             88  AR-BAL-LVL-AGT-FR            VALUE '3'.
  2387             88  AR-BAL-LVL-FIN-RES           VALUE '4'.
  2388         16  AR-ENTRY-TYPE                 PIC X.
  2389             88  AR-AGENT-ENTRY               VALUE '1'.
  2390             88  AR-GA-ENTRY                  VALUE '2'.
  2391             88  AR-OVWRT-ENTRY               VALUE '3'.
  2392         16  AR-FIN-RES                    PIC X(10).
  2393         16  AR-AGENT-NO                   PIC X(10).
  2394         16  AR-INVOICE-NO                 PIC X(6).
  2395         16  AR-REFERENCE                  PIC X(12).
  2396         16  AR-RESPONSIBILITY             PIC X.
  2397             88  AR-AGENT-RESPONSIBLE         VALUE 'A'.
  2398             88  AR-GA-RESPONSIBLE            VALUE 'G'.
  2399         16  AR-RECORD-TYPE                PIC X.
  2400             88  AR-BALANCE                   VALUE '0'.
  2401             88  AR-PREMIUM                   VALUE '1'.
  2402             88  AR-COMMISSION                VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL635.cbl
  2403             88  AR-PAY-ADJ                   VALUE '3'.
  2404             88  AR-TRANSFER                  VALUE '4'.
  2405             88  AR-WRITE-OFF                 VALUE '5'.
  2406             88  AR-NOTE                      VALUE '6'.
  2407         16  AR-RECORD-SEQ                 PIC S9(4)    COMP.
  2408
  2409     12  FILLER                            PIC X(9).
  2410
  2411     12  AR-ACCOUNT-AGENT-CONTROL.
  2412         16  AR-ACCOUNT-AGENT.
  2413             20  AR-COMPANY-CD-A1          PIC X.
  2414             20  AR-CARRIER-A1             PIC X.
  2415             20  AR-GROUPING-A1            PIC X(6).
  2416             20  AR-AGENT-NO-A1            PIC X(10).
  2417         16  AR-EOM-DT-A1                  PIC XX.
  2418         16  AR-BAL-LEVEL-A1               PIC X.
  2419         16  AR-ENTRY-TYPE-A1              PIC X.
  2420             88  AR-ACCT-AGENT               VALUE '1'.
  2421             88  AR-GEN-AGENT                VALUE '2'.
  2422             88  AR-OVERWRITE-AGENT          VALUE '3'.
  2423         16  AR-FIN-RES-A1                 PIC X(10).
  2424         16  AR-INVOICE-A1                 PIC X(6).
  2425         16  AR-REFERENCE-A1               PIC X(12).
  2426         16  AR-RESPONSIBILITY-A1          PIC X.
  2427             88  AR-AGENT-RESPONSIBLE-A1      VALUE 'A'.
  2428             88  AR-GA-RESPONSIBLE-A1         VALUE 'G'.
  2429         16  AR-RECORD-TYPE-A1             PIC X.
  2430         16  AR-RECORD-SEQ-A1              PIC S9(4)    COMP.
  2431
  2432     12  AR-CONTROL-GA                     PIC X(10).
  2433
  2434     12  AR-LAST-MAINT-DT                  PIC XX.
  2435     12  AR-LAST-MAINT-BY                  PIC X(4).
  2436     12  AR-LST-MAINT-HHMMSS               PIC S9(6)    COMP-3.
  2437     12  AR-MONTH-END-DT                   PIC XX.
  2438     12  FILLER                            PIC X.
  2439     12  AR-REVERSAL-INFO.
  2440         16  AR-REVERSAL-ID                PIC X(4).
  2441         16  AR-REVERSAL-DT                PIC XX.
  2442     12  AR-UPDATE-CODE                    PIC X.
  2443         88  AR-NEW-RECORD                      VALUE 'N'.
  2444         88  AR-UPDATED-RECORD                  VALUE 'U'.
  2445     12  AR-SYSTEM                         PIC X.
  2446         88  AR-MORTGAGE-SYSTEM                 VALUE 'M'.
  2447     12  AR-CSR-TEMP                       PIC X(04).
  2448     12  AR-CARRIER-TEMP                   PIC X(01).
  2449     12  AR-GROUPING-TEMP                  PIC X(06).
  2450     12  FILLER                            PIC X(20).
  2451
  2452     12  AR-RECORD-BODY                    PIC X(120).
  2453
  2454     12  AR-PREM-COMM-RECORD   REDEFINES AR-RECORD-BODY.
  2455         16  AR-P-C-TRAN-DATE              PIC XX.
  2456         16  AR-P-C-STMT-DATE              PIC XX.
  2457         16  AR-P-C-BATCH                  PIC X(6).
  2458         16  AR-P-C-AMOUNT                 PIC S9(7)V99  COMP-3.
  2459         16  AR-P-C-DB-CR                  PIC XX.
  2460             88 AR-P-C-DEBIT                   VALUE 'DB'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL635.cbl
  2461             88 AR-P-C-CREDIT                  VALUE 'CR'.
  2462         16  AR-P-C-DESCRIPTION            PIC X(30).
  2463         16  AR-P-C-REMITTER-CODE          PIC X.
  2464             88 AR-P-C-REMITTER-PAYS           VALUE 'Y'.
  2465             88 AR-P-C-ACCT-AGT-PAYS           VALUE 'Y'.
  2466         16  FILLER                        PIC X(33).
  2467         16  AR-P-C-REMITTER               PIC X(10).
  2468         16  AR-P-C-AMOUNT-LF              PIC S9(7)V99  COMP-3.
  2469         16  AR-P-C-AMOUNT-AH              PIC S9(7)V99  COMP-3.
  2470         16  FILLER                        PIC X(19).
  2471
  2472     12  AR-PAY-ADJ-RECORD  REDEFINES AR-RECORD-BODY.
  2473         16  AR-PA-TRAN-DATE               PIC XX.
  2474         16  AR-PA-STMT-DATE               PIC XX.
  2475         16  FILLER                        PIC X(6).
  2476         16  AR-PA-AMOUNT                  PIC S9(7)V99  COMP-3.
  2477         16  AR-PA-DB-CR                   PIC XX.
  2478             88  AR-PA-DEBIT                   VALUE 'DB'.
  2479             88  AR-PA-CREDIT                  VALUE 'CR'.
  2480         16  AR-PA-SEQ-NO                  PIC S9(8)     COMP.
  2481         16  AR-PA-TYPE                    PIC X.
  2482         16  AR-PA-DEBIT-LEDGER            PIC X(14).
  2483         16  AR-PA-CREDIT-LEDGER           PIC X(14).
  2484         16  AR-PA-COMMENT                 PIC X(30).
  2485         16  AR-PA-REMITTER-CODE           PIC X.
  2486             88 AR-PA-REMITTER-PAYS            VALUE 'Y'.
  2487             88 AR-PA-ACCT-AGT-PAYS            VALUE 'Y'.
  2488         16  AR-PA-REMITTER                PIC X(10).
  2489         16  AR-NOTE-COUNT                 PIC S9(5).
  2490         16  FILLER                        PIC X(24).
  2491
  2492     12  AR-TRANSFER-RECORD REDEFINES AR-RECORD-BODY.
  2493         16  AR-XRF-TRAN-DATE              PIC XX.
  2494         16  AR-XRF-STMT-DATE              PIC XX.
  2495         16  AR-XRF-BATCH                  PIC X(6).
  2496         16  AR-XRF-AMOUNT                 PIC S9(7)V99  COMP-3.
  2497         16  AR-XRF-DB-CR                  PIC XX.
  2498             88  AR-XRF-DEBIT                  VALUE 'DB'.
  2499             88  AR-XRF-CREDIT                 VALUE 'CR'.
  2500         16  AR-BAL-DESCRIPTION            PIC X(30).
  2501         16  AR-XRF-REMITTER-CODE          PIC X.
  2502             88 AR-XRF-REMITTER-PAYS           VALUE 'Y'.
  2503             88 AR-XRF-ACCT-AGT-PAYS           VALUE 'Y'.
  2504         16  FILLER                        PIC X(33).
  2505         16  AR-XRF-REMITTER               PIC X(10).
  2506         16  FILLER                        PIC X(29).
  2507
  2508     12  AR-BALANCE-RECORD REDEFINES AR-RECORD-BODY.
  2509         16  AR-FST-TRAN-DATE              PIC XX.
  2510         16  AR-LST-TRAN-DATE              PIC XX.
  2511         16  FILLER                        PIC X(6).
  2512         16  AR-BAL-AMOUNT                 PIC S9(7)V99  COMP-3.
  2513         16  AR-BAL-DB-CR                  PIC XX.
  2514             88  AR-BAL-DEBIT                  VALUE 'DB'.
  2515             88  AR-BAL-CREDIT                 VALUE 'CR'.
  2516         16  AR-BAL-DESCRIPTION            PIC X(30).
  2517         16  FILLER                        PIC X(73).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL635.cbl
  2519*    COPY MPCPRCN.
  2520******************************************************************
  2521*                                                                *
  2522*                            MPCPRCN                             *
  2523*                            VMOD=1.014                          *
  2524*                                                                *
  2525*   FILE DESCRIPTION = PAYMENT RECONCILIATION                    *
  2526*   (ANY CHANGES MADE TO THIS COPYBOOK MUST ALSO BE MADE         *
  2527*   TO MPCPEXT)                                                  *
  2528*                                                                *
  2529*   FILE TYPE = VSAM,KSDS                                        *
  2530*   RECORD SIZE = 835  RECFORM = FIXED                           *
  2531*                                                                *
  2532*   BASE CLUSTER = MPPRCN (SEE NOTE ABOVE)          RKP=2,LEN=11 *
  2533*   ALTERNATE PATH2= MPPRCN2(PRODUCER BILLING SEQU)RKP=33,LEN=44 *
  2534*   ALTERNATE PATH3= MPPRCN3(POLICY PRIMARY CNTL  )RKP=97,LEN=46 *
  2535*   ALTERNATE PATH4= MPPRCN4(BY RECORD TYPE CNTL  )RKP=163,LEN=46*
  2536*                                                                *
  2537*   LOG = YES                                                    *
  2538*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2539******************************************************************
  2540
  2541 01  PAYMENT-RECONCILIATION.
  2542     12  PR-RECORD-ID                      PIC XX.
  2543         88  VALID-PR-ID                      VALUE 'PR'.
  2544
  2545******************************************************************
  2546*   BASE CLUSTER = MPPRCN         (BASE KEY)      RKP=2,LEN=11   *
  2547******************************************************************
  2548
  2549     12  PR-CONTROL-PRIMARY.
  2550         16  PR-COMPANY-CD                 PIC X.
  2551         16  PR-INVOICE-NUMBER.
  2552             20  PR-INVOICE-YMD.
  2553                 24  PR-INVOICE-YR         PIC X.
  2554                 24  PR-INVOICE-MO         PIC X.
  2555                 24  PR-INVOICE-DAY        PIC X.
  2556             20  PR-INVOICE-SEQU           PIC X(3).
  2557                 88  PR-INDIVIDUAL-BILL       VALUE 'AAA'.
  2558         16  PR-RECORD-SEQU                PIC S9(7)     COMP-3.
  2559             88  PR-INVOICE-HEADER            VALUE +9999999.
  2560     12  FILLER                            PIC X(20).
  2561
  2562******************************************************************
  2563* ALTERNATE PATH2 = MPPRCN2(PRODUCER BILLING SEQU)RKP=33,LEN=44  *
  2564******************************************************************
  2565
  2566     12  PR-CONTROL-BY-PRODUCER.
  2567         16  PR-COMPANY-CD-A2              PIC X.
  2568         16  PR-CARRIER-A2                 PIC X.
  2569         16  PR-GROUPING-A2.
  2570             20  PR-GROUPING-PREFIX-A2     PIC X(3).
  2571             20  PR-GROUPING-PRIME-A2      PIC X(3).
  2572         16  PR-STATE-A2                   PIC XX.
  2573         16  PR-PRODUCER-A2.
  2574             20  PR-PRODUCER-PREFIX-A2     PIC X(4).
  2575             20  PR-PRODUCER-PRIME-A2      PIC X(6).
  2576         16  PR-PRODUCER-BILLING-SEQU-A2   PIC X(20).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL635.cbl
  2577         16  PR-CURRENT-DATE-BIN-A2        PIC X(02).
  2578         16  PR-UNIQUE-KEY-A2              PIC S9(04) COMP.
  2579     12  FILLER                            PIC X(20).
  2580
  2581******************************************************************
  2582*  ALTERNATE PATH3 = MPPRCN3(POLICY CONTROL SEQU)RKP=97,LEN=46   *
  2583******************************************************************
  2584
  2585     12  PR-CONTROL-BY-POLICY.
  2586         16  PR-COMPANY-CD-A3              PIC X.
  2587         16  PR-POLICY-NO-A3.
  2588             20  PR-POLICY-PRIME-A3        PIC X(18).
  2589             20  PR-POLICY-SFX-A3          PIC XX.
  2590         16  PR-POLICY-CNTL-PARTIAL.
  2591             20  PR-CARRIER-A3             PIC X.
  2592             20  PR-GROUPING-A3.
  2593                 24  PR-GROUPING-PREFIX-A3 PIC X(3).
  2594                 24  PR-GROUPING-PRIME-A3  PIC X(3).
  2595             20  PR-STATE-A3               PIC XX.
  2596             20  PR-PRODUCER-A3.
  2597                 24  PR-PRODUCER-PREFIX-A3 PIC X(4).
  2598                 24  PR-PRODUCER-PRIME-A3  PIC X(6).
  2599             20  PR-POLICY-EFF-DT-A3       PIC XX.
  2600         16  PR-CURRENT-DATE-BIN-A3        PIC X(02).
  2601         16  PR-UNIQUE-KEY-A3              PIC S9(04) COMP.
  2602     12  FILLER                            PIC X(20).
  2603
  2604******************************************************************
  2605*  ALTERNATE PATH4 = MPPRCN4(RECON RECORD TYPE  )RKP=163 LEN=25  *
  2606******************************************************************
  2607
  2608     12  PR-CONTROL-BY-RECORD-TYPE.
  2609         16  PR-COMPANY-CD-A4              PIC X.
  2610         16  PR-RECORD-TYPE-A4             PIC X.
  2611             88  PR-HEADER-RECORD              VALUE '1'.
  2612             88  PR-DETAIL-RECORD              VALUE '2'.
  2613         16  PR-CARRIER-A4                 PIC X.
  2614         16  PR-GROUPING-A4.
  2615             20  PR-GROUPING-PREFIX-A4     PIC X(3).
  2616             20  PR-GROUPING-PRIME-A4      PIC X(3).
  2617         16  PR-STATE-A4                   PIC XX.
  2618         16  PR-PRODUCER-A4.
  2619             20  PR-PRODUCER-PREFIX-A4     PIC X(4).
  2620             20  PR-PRODUCER-PRIME-A4      PIC X(6).
  2621         16  PR-CURRENT-DATE-BIN-A4        PIC X(02).
  2622         16  PR-UNIQUE-KEY-A4              PIC S9(04) COMP.
  2623     12  FILLER                            PIC X(20).
  2624
  2625******************************************************************
  2626*                 FILE SYNCHRONIZATION DATA                      *
  2627******************************************************************
  2628
  2629     12  PR-FILE-SYNCH-DATA.
  2630         16  PR-LAST-CHANGE-DT             PIC XX.
  2631         16  PR-LAST-CHANGE-TIME           PIC S9(7)     COMP-3.
  2632         16  PR-LAST-CHANGE-PROCESSOR      PIC X(4).
  2633         16  PR-SECURITY-ACCESS-CODE       PIC X.
  2634     12  FILLER                            PIC X(16).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL635.cbl
  2635
  2636******************************************************************
  2637*              PREMIUM RECONCILIATION RECORD BODY                *
  2638******************************************************************
  2639
  2640     12  PR-RECORD-BODY                    PIC X(600).
  2641
  2642******************************************************************
  2643*             PREMIUM RECONCILIATION BATCH HEADER                *
  2644******************************************************************
  2645
  2646     12  PR-BATCH-HEADER  REDEFINES  PR-RECORD-BODY.
  2647         16  PR-POSTING-DATA.
  2648             20  PR-POSTING-DT             PIC XX.
  2649             20  PR-POSTING-TIME           PIC S9(7)      COMP-3.
  2650             20  PR-POSTING-PROCESSOR      PIC X(4).
  2651         16  PR-SUMMARY-DATA.
  2652             20  PR-DOCU-COUNTS.
  2653                 24  PR-ACTUAL-DOCU-CNT    PIC S9(5)      COMP-3.
  2654                 24  PR-EXPECTED-DOCU-CNT  PIC S9(5)      COMP-3.
  2655             20  PR-PREMIUM-AMTS.
  2656                 24  PR-RECEIVED-PREMIUM   PIC S9(7)V99   COMP-3.
  2657                 24  PR-ACTUAL-PREMIUM     PIC S9(7)V99   COMP-3.
  2658                 24  PR-EXPECTED-PREMIUM   PIC S9(7)V99   COMP-3.
  2659             20  PR-COMPENSATION-AMTS.
  2660                 24  PR-PROD-EXPECTED-COM  PIC S9(7)V99   COMP-3.
  2661                 24  PR-PROD-ACTUAL-COM    PIC S9(7)V99   COMP-3.
  2662                 24  PR-OVRWT-EXPECTED-COM PIC S9(7)V99   COMP-3.
  2663                 24  PR-OVRWT-ACTUAL-COM   PIC S9(7)V99   COMP-3.
  2664                 24  PR-REMIT-EXPECTED-COM PIC S9(7)V99   COMP-3.
  2665                 24  PR-REMIT-ACTUAL-COM   PIC S9(7)V99   COMP-3.
  2666         16  PR-HDR-BILLING-SEQUENCE       PIC X(01).
  2667             88  PR-HDR-BILL-NAME-SEQU        VALUE '1'.
  2668             88  PR-HDR-BILL-LOAN-SEQU        VALUE '2'.
  2669             88  PR-HDR-BILL-PLCY-SEQU        VALUE '3'.
  2670         16  PR-HDR-BILLING-DT             PIC XX.
  2671         16  PR-HDR-BILL-TO-DT             PIC XX.
  2672         16  PR-HDR-POSTING-STATUS         PIC X.
  2673             88  PR-HDR-NEEDS-EDITING         VALUE '0'.
  2674             88  PR-HDR-EDITED                VALUE '1'.
  2675             88  PR-HDR-OK-TO-POST            VALUE '2'.
  2676             88  PR-HDR-POSTED                VALUE '3'.
  2677             88  PR-HDR-REVERSED              VALUE '4'.
  2678             88  PR-HDR-POSTING               VALUE '5'.
  2679         16  PR-RECEIVED-DT                PIC XX.
  2680         16  PR-RESPONSIBLE-AGENT          PIC X(10).
  2681         16  PR-PAC-INFORMATION.
  2682             20  PR-HDR-BANK-TRANSIT-NUMBER.
  2683                 24  PR-HDR-FEDERAL-NUMBER PIC X(4).
  2684                 24  PR-HDR-BANK-NUMBER    PIC X(4).
  2685             20  PR-HDR-BANK-ACCOUNT-NUMBER
  2686                                           PIC X(20).
  2687             20  PR-SIGNATURE-NAME         PIC X(25).
  2688
  2689******************************************************************
  2690*         HEADER  AGENT AND COMMISSION DATA                      *
  2691******************************************************************
  2692
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL635.cbl
  2693         16  PR-HDR-1STYR-RENEW-SW           PIC X.
  2694             88  PR-HDR-1STYR-COMMISSIONS            VALUE '1'.
  2695             88  PR-HDR-RENEW-COMMISSIONS            VALUE '2'.
  2696             88  PR-HDR-CROSS-BOUNDRIES              VALUE '3'.
  2697         16  PR-HDR-COMMISSION-DATA.
  2698             20  PR-HDR-REMIT-TO             PIC S9(3) COMP-3.
  2699             20  PR-HDR-COMM-CHANGE-SW       PIC X.
  2700                 88  PR-HDR-COMMISSION-CHANGE         VALUE 'Y'.
  2701             20  PR-HDR-AGENT-INFORMATION   OCCURS   5 TIMES.
  2702                 24  PR-HDR-AGENT-NUMBER     PIC X(10).
  2703                 24  PR-HDR-AGENT-TYPE       PIC X.
  2704                     88  PR-HDR-AGENT-GROSS           VALUE 'C'.
  2705                     88  PR-HDR-AGENT-REINS           VALUE 'R'.
  2706                     88  PR-HDR-AGENT-GROSS-REINS     VALUE 'D'.
  2707                     88  PR-HDR-OVERWRITE-GROSS       VALUE 'O'.
  2708                     88  PR-HDR-OVERWRITE-GROSS-REINS
  2709                                                      VALUE 'P'.
  2710                     88  PR-HDR-OVERWRITE-REINS       VALUE 'T'.
  2711                     88  PR-HDR-REINS-ONLY            VALUE 'W'.
  2712                 24  PR-HDR-COMMISSION-BILL-PAID PIC X(1).
  2713                     88  PR-HDR-GENERATE-BILL         VALUE 'B'.
  2714                     88  PR-HDR-GENERATE-PAID         VALUE 'P'.
  2715                 24  PR-HDR-AGENT-COMP-1ST-YEAR  PIC S99V999.
  2716                 24  PR-HDR-COMP-1ST-YEAR-TYPE   PIC X(1).
  2717                     88  PR-HDR-COMP-1ST-YEAR-PERCENT
  2718                                                  VALUE '1'.
  2719                     88  PR-HDR-COMP-1ST-YEAR-DOLLARS
  2720                                                  VALUE '2'.
  2721                     88  PR-HDR-COMP-1ST-YEAR-NOT-USED
  2722                                                  VALUE '3'.
  2723                 24  PR-HDR-RENEW-DATA  OCCURS 6 TIMES.
  2724                     28  PR-HDR-RENEW-MONTHS PIC S999    COMP-3.
  2725                     28  PR-HDR-RENEW-COMM   PIC S99V999 COMP-3.
  2726                     28  PR-HDR-RENEW-TYPE   PIC X(1).
  2727                         88  PR-HDR-COMP-RENEW-PERCENT
  2728                                                        VALUE '1'.
  2729                         88  PR-HDR-COMP-RENEW-DOLLARS
  2730                                                        VALUE '2'.
  2731                         88  PR-HDR-COMP-RENEW-NOT-USED
  2732                                                        VALUE '3'.
  2733                 24  PR-HDR-COMP-RECALC-FLAG     PIC X(1).
  2734                     88  PR-HDR-BYPASS-RECALC          VALUE 'N'.
  2735         16  FILLER                        PIC X(189).
  2736
  2737******************************************************************
  2738*                PREMIUM RECONCILIATION DETAIL                   *
  2739******************************************************************
  2740
  2741     12  PR-RECON-DETAIL  REDEFINES  PR-RECORD-BODY.
  2742         16  PR-TRANSACTION-TYPE           PIC X.
  2743             88  PR-BILL                      VALUE '1'.
  2744             88  PR-CANCEL                    VALUE '2'.
  2745             88  PR-PYMT-REVERSAL             VALUE '3'.
  2746             88  PR-BILL-REVERSAL             VALUE '4'.
  2747             88  PR-PAID-IN-ADVANCE           VALUE '5'.
  2748             88  PR-AR-BILL-REVERSAL          VALUE '6'.
  2749         16  PR-POSTING-STATUS             PIC X.
  2750             88  PR-NEEDS-EDITING             VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL635.cbl
  2751             88  PR-EDITED                    VALUE 'E'.
  2752             88  PR-POSTED                    VALUE 'P'.
  2753             88  PR-FORCE-TO-POST             VALUE 'F'.
  2754             88  PR-DELETED                   VALUE 'D'.
  2755             88  PR-REVERSED                  VALUE 'R'.
  2756         16  PR-POLICY-STATUS              PIC X.
  2757             88  PR-P-ACTIVE                  VALUE  '1'.
  2758             88  PR-P-LAPSE                   VALUE  '0'.
  2759             88  PR-P-CLAIM-APPLIED           VALUE  '6'.
  2760             88  PR-P-CANCEL                  VALUE  '7'.
  2761             88  PR-BILLABLE                  VALUES '0' '1' '6'.
  2762         16  PR-PYMT-REVERSAL-DT           PIC XX.
  2763         16  PR-INSURED-NAME.
  2764             20  PR-INSURED-FIRST-NAME.
  2765                 24  PR-INSURED-1ST-INIT   PIC X.
  2766                 24  FILLER                PIC X(9).
  2767             20  PR-INSURED-MIDDLE-INITIAL PIC X.
  2768             20  PR-INSURED-LAST-NAME      PIC X(15).
  2769         16  PR-LOAN-NUMBER                PIC X(20).
  2770         16  PR-PLAN-CODE                  PIC X(02).
  2771         16  PR-PLAN-REVISION              PIC X(03).
  2772         16  PR-INS-MONTH-PREMIUM          PIC S9(5)V9(6) COMP-3.
  2773         16  PR-BILLING-INFORMATION.
  2774             20  PR-BILLING-TYPE           PIC X.
  2775                 88  PR-LIST-BILL             VALUE '1'.
  2776                 88  PR-TAPE-BILL             VALUE '2'.
  2777                 88  PR-TAPE-LIST-BILL        VALUE '3'.
  2778                 88  PR-GROUP-BILL         VALUES ARE '1' '2' '3'.
  2779                 88  PR-DIRECT-BILL           VALUE '4'.
  2780                 88  PR-PAC-BILL         VALUES ARE '5' 'C' 'S'.
  2781                 88  PR-CHARGE-CARD-BILL      VALUE '6'.
  2782                 88  PR-PAC-REFUND            VALUE 'D'.
  2783                 88  PR-CHARGE-CARD-REFUND    VALUE 'E'.
  2784                 88  PR-INDIV-BILL
  2785                     VALUES ARE '4' '5' '6' 'C' 'S'.
  2786                 88  PR-EFT-CHECKING          VALUE 'C'.
  2787                 88  PR-EFT-SAVINGS           VALUE 'S'.
  2788             20  PR-BILLING-SEQUENCE       PIC X(01).
  2789                 88  PR-BILL-NAME-SEQU        VALUE '1'.
  2790                 88  PR-BILL-LOAN-SEQU        VALUE '2'.
  2791                 88  PR-BILL-PLCY-SEQU        VALUE '3'.
  2792             20  PR-BILLING-MODE           PIC X(01).
  2793                 88  PR-ANNUAL                VALUE '1'.
  2794                 88  PR-SEMI-ANNUAL           VALUE '2'.
  2795                 88  PR-QUARTERLY             VALUE '3'.
  2796                 88  PR-MONTHLY               VALUE '4'.
  2797                 88  PR-BI-MONTHLY            VALUE '5'.
  2798                 88  PR-SINGLE-PREM           VALUE '6'.
  2799             20  PR-MONTHS-BILLED          PIC S9(03)     COMP-3.
  2800             20  PR-BILLED-AMT             PIC S9(5)V99   COMP-3.
  2801             20  PR-BILLED-TO-DT           PIC XX.
  2802             20  PR-BILLING-DT             PIC XX.
  2803             20  PR-BILLING-SW             PIC X.
  2804                 88  PR-FIRST-BILLING         VALUE 'Y'.
  2805                 88  PR-PLCY-PAID-IN-ADVANCE  VALUE 'A'.
  2806             20  PR-BANK-TRANSIT-NUMBER.
  2807                 24  PR-FEDERAL-NUMBER     PIC X(4).
  2808                 24  PR-BANK-NUMBER        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL635.cbl
  2809             20  PR-BANK-ACCOUNT-NUMBER    PIC X(20).
  2810             20  PR-CHARGE-CARD-TYPE       PIC X(2).
  2811                 88  PR-VISA                  VALUE 'VI'.
  2812                 88  PR-MSTR-CARD             VALUE 'MC'.
  2813                 88  PR-DINERS-CLUB           VALUE 'DN'.
  2814                 88  PR-DISCOVER              VALUE 'DS'.
  2815                 88  PR-CARTE-BLANCHE         VALUE 'CB'.
  2816                 88  PR-AMERICAN-EXPRESS      VALUE 'AE'.
  2817             20  PR-CHARGE-CARD-EXP-DT     PIC X(2).
  2818             20  PR-LOAN-OFFICER           PIC X(5).
  2819             20  PR-BILLING-GROUPING-CODE  PIC X(6).
  2820         16  PR-BILLING-RECONCILE-DATA.
  2821             20  PR-EXPECTED-DATA.
  2822                 24  PR-EXPECTED-PAYMENT   PIC S9(5)V99   COMP-3.
  2823                 24  PR-EXPECTED-TO-DT     PIC XX.
  2824             20  PR-EXP-COMPENSATION-DATA.
  2825                 24  PR-EXP-PROD-LVL-COMP  PIC S9(5)V99   COMP-3.
  2826                 24  PR-EXP-OVWR-LVL-COMP  PIC S9(5)V99   COMP-3.
  2827                 24  PR-EXP-REMT-LVL-COMP  PIC S9(5)V99   COMP-3.
  2828             20  PR-ENTERED-DATA.
  2829                 24  PR-ENTERED-PAYMENT    PIC S9(5)V99   COMP-3.
  2830                 24  PR-ENTERED-OVSH       PIC S9(5)V99   COMP-3.
  2831                 24  PR-ENTERED-TO-DT      PIC XX.
  2832                 24  PR-ENTERED-SOURCE     PIC X.
  2833                     88  PR-BILLING-PGM       VALUE 'B'.
  2834                     88  PR-OPERATOR          VALUE 'O'.
  2835                     88  PR-PAYMENT-PGM       VALUE 'P'.
  2836             20  PR-ENT-COMPENSATION-DATA.
  2837                 24  PR-ENT-PROD-LVL-COMP  PIC S9(5)V99   COMP-3.
  2838                 24  PR-ENT-OVWR-LVL-COMP  PIC S9(5)V99   COMP-3.
  2839                 24  PR-ENT-REMT-LVL-COMP  PIC S9(5)V99   COMP-3.
  2840         16  PR-PAYMENT-TYPE               PIC X.
  2841             88  PR-CHECK                     VALUE 'C'.
  2842             88  PR-MONEY-ORDER               VALUE 'M'.
  2843         16  PR-CHECK-NUMBER               PIC X(5).
  2844         16  PR-PREVIOUS-PAYMENT-DATA.
  2845             20  PR-PREV-INVOICE-NUMBER    PIC X(6).
  2846             20  PR-PREV-LAST-PYMT-DT      PIC XX.
  2847             20  PR-PREV-PAID-TO-DT        PIC XX.
  2848             20  PR-PREV-PAYMENT-AMT       PIC S9(5)V99  COMP-3.
  2849             20  PR-PREV-OVER-SHORT-AMT    PIC S9(5)V99  COMP-3.
  2850             20  PR-PREV-TOTAL-PREM-RECVD  PIC S9(7)V99  COMP-3.
  2851             20  PR-PREV-MONTHS-PAID       PIC S9(3)     COMP-3.
  2852         16  PR-PREVIOUS-BILLING-DATA.
  2853             20  PR-PREV-LAST-BILL-DT      PIC XX.
  2854             20  PR-PREV-BILL-TO-DT        PIC XX.
  2855             20  PR-PREV-LAST-BILL-AMT     PIC S9(5)V99  COMP-3.
  2856             20  PR-PREV-BILLING-SW        PIC X.
  2857             20  PR-PREV-EXIT-DT           PIC XX.
  2858             20  PR-PREV-LAST-LAPSE-DT     PIC XX.
  2859         16  PR-MONTH-END-DT               PIC XX.
  2860         16  PR-PLAN-TYPE                  PIC X.
  2861             88  PR-AH-MORT-PLAN              VALUE 'A'.
  2862             88  PR-AD-D-MORT-PLAN            VALUE 'E'.
  2863             88  PR-DISMEM-MORT-PLAN          VALUE 'D'.
  2864             88  PR-LIFE-MORT-PLAN            VALUE 'L'.
  2865         16  PR-EXPECTED-TAX               PIC S9(5)V99   COMP-3.
  2866         16  PR-BILL-DAY                   PIC S99        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL635.cbl
  2867         16  FILLER                        PIC X(14).
  2868
  2869******************************************************************
  2870*                 AGENT AND COMMISSION DATA                      *
  2871******************************************************************
  2872
  2873         16  PR-1STYR-RENEW-SW               PIC X.
  2874             88  PR-1STYR-COMMISSIONS         VALUE '1'.
  2875             88  PR-RENEW-COMMISSIONS         VALUE '2'.
  2876             88  PR-CROSS-BOUNDRIES           VALUE '3'.
  2877         16  PR-COMMISSION-DATA.
  2878             20  PR-REMIT-TO                 PIC S9(3) COMP-3.
  2879             20  PR-COMM-CHANGE-SW           PIC X.
  2880                 88  PR-COMMISSION-CHANGE         VALUE 'Y'.
  2881             20  PR-AGENT-INFORMATION   OCCURS   5 TIMES.
  2882                 24  PR-AGENT-NUMBER         PIC X(10).
  2883                 24  PR-AGENT-TYPE           PIC X.
  2884                     88  PR-AGENT-GROSS           VALUE 'C'.
  2885                     88  PR-AGENT-REINS           VALUE 'R'.
  2886                     88  PR-AGENT-GROSS-REINS     VALUE 'D'.
  2887                     88  PR-OVERWRITE-GROSS       VALUE 'O'.
  2888                     88  PR-OVERWRITE-GROSS-REINS VALUE 'P'.
  2889                     88  PR-OVERWRITE-REINS       VALUE 'T'.
  2890                     88  PR-REINS-ONLY            VALUE 'W'.
  2891                 24  PR-COMMISSION-BILL-PAID PIC X(1).
  2892                     88  PR-GENERATE-BILL         VALUE 'B'.
  2893                     88  PR-GENERATE-PAID         VALUE 'P'.
  2894                 24  PR-AGENT-COMP-1ST-YEAR  PIC S99V999.
  2895                 24  PR-COMP-1ST-YEAR-TYPE   PIC X(1).
  2896                     88  PR-COMP-1ST-YEAR-PERCENT   VALUE '1'.
  2897                     88  PR-COMP-1ST-YEAR-DOLLARS   VALUE '2'.
  2898                     88  PR-COMP-1ST-YEAR-NOT-USED  VALUE '3'.
  2899                 24  PR-RENEW-DATA OCCURS 6 TIMES.
  2900                     28  PR-RENEW-MONTHS      PIC S999    COMP-3.
  2901                     28  PR-RESNEW-COMMISSION
  2902                                              PIC S99V999 COMP-3.
  2903                     28  PR-COMP-RENEW-TYPE   PIC X(1).
  2904                         88  PR-COMP-RENEW-PERCENT      VALUE '1'.
  2905                         88  PR-COMP-RENEW-DOLLARS      VALUE '2'.
  2906                         88  PR-COMP-RENEW-NOT-USED     VALUE '3'.
  2907                 24  PR-COMP-RECALC-FLAG     PIC X(1).
  2908                     88  PR-BYPASS-RECALC         VALUE 'N'.
  2909         16  FILLER                        PIC X(94).
  2910
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL635.cbl
  2912 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-PAY-ADJ
  2913                          CHECK-QUE COMPENSATION-MASTER
  2914                          ACCOUNTS-RECEIVABLE
  2915                          PAYMENT-RECONCILIATION.
  2916 0000-DFHEXIT SECTION.
  2917     MOVE '9#                    $   ' TO DFHEIV0.
  2918     MOVE 'EL635' TO DFHEIV1.
  2919     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2920
  2921     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  2922     MOVE EIBTRMID               TO  QID-TERM.
  2923     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  2924
  2925     IF EIBCALEN = ZERO
  2926         GO TO 8800-UNAUTHORIZED-ACCESS.
  2927
  2928     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  2929         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  2930
  2931     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  2932     MOVE '5'                    TO  DC-OPTION-CODE.
  2933
  2934     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  2935
  2936     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT.
  2937     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT.
  2938     MOVE DC-GREG-DATE-1-MDY     TO  WS-CURRENT-MDY.
  2939
  2940     IF MORTGAGE-SESSION
  2941        MOVE XCTL-EM626           TO XCTL-626
  2942        MOVE MPPYAJ-FILE-ID       TO PYAJ-FILE-ID.
  2943
  2944     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2945         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2946             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  2947             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  2948             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  2949             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  2950             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  2951             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  2952             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  2953             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  2954             PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  2955         ELSE
  2956             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  2957             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  2958             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  2959             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  2960             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  2961             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  2962             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  2963             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  2964
  2965     MOVE LOW-VALUES             TO  EL635AI.
  2966
  2967     COMPUTE WORK-SEQ-NO  =  EIBTIME  *  10.
  2968
  2969     IF RETURNED-FROM EQUAL XCTL-6351 OR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL635.cbl
  2970                            XCTL-640  OR
  2971                            XCTL-642  OR
  2972                            XCTL-652
  2973         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT.
  2974
  2975     IF EIBTRNID EQUAL EL630-TRANS-ID
  2976         MOVE 'T'                TO  PI-PYAJ-FILE-SW
  2977         MOVE 'Y'                TO  EL630-SENT-SW
  2978         MOVE ZEROS              TO  PI-SEQ-NOS
  2979         IF ((PI-CR-CONTROL-IN-PROGRESS = SPACES) OR
  2980             (PI-CR-FIN-RESP EQUAL 'UNKNOWN  '))
  2981             MOVE SPACES         TO PI-CR-CONTROL-IN-PROGRESS
  2982             MOVE SPACES         TO PI-SAV-CARRIER
  2983                                    PI-SAV-GROUPING
  2984                                    PI-SAV-FIN-RESP
  2985                                    PI-SAV-ACCOUNT
  2986                                    PI-PYAJ-REFERENCE
  2987                                    PI-PYAJ-FILLED-SW
  2988             GO TO 8100-SEND-INITIAL-MAP
  2989         ELSE
  2990             MOVE DFHENTER   TO  EIBAID
  2991             MOVE 'S'        TO  MAINTI
  2992             MOVE PI-CR-CARRIER
  2993                             TO  CARRIERI
  2994             MOVE PI-CR-GROUPING
  2995                             TO  GROUPI
  2996             MOVE PI-CR-FIN-RESP
  2997                             TO  FINRESPI
  2998             MOVE PI-CR-ACCOUNT
  2999                             TO  ACCTI
  3000             MOVE 1          TO  CARRIERL  MAINTA
  3001             MOVE 3          TO  GROUPL
  3002             MOVE 6          TO  FINRESPL  ACCTL
  3003             GO TO 0400-VALIDATE-KEY-DATA.
  3004
  3005     IF EIBTRNID NOT = TRANS-ID
  3006         MOVE 'T'                TO  PI-PYAJ-FILE-SW
  3007         MOVE ZEROS              TO  PI-SEQ-NOS
  3008         IF (EIBTRNID NOT = EL640-TRANS-ID  AND
  3009             EIBTRNID NOT = EL642-TRANS-ID  AND
  3010             EIBTRNID NOT = EL652-TRANS-ID  AND
  3011             EIBTRNID NOT = EL6351-TRANS-ID)
  3012             GO TO 8100-SEND-INITIAL-MAP
  3013         ELSE
  3014             IF (EIBTRNID = EL6351-TRANS-ID  OR
  3015                           EL640-TRANS-ID   OR
  3016                           EL642-TRANS-ID)  AND
  3017                PI-CR-CONTROL-IN-PROGRESS = SPACES
  3018                GO TO 8100-SEND-INITIAL-MAP
  3019             ELSE
  3020                 MOVE DFHENTER   TO  EIBAID
  3021                 MOVE 'S'        TO  MAINTI
  3022                 MOVE PI-CR-CARRIER
  3023                                 TO  CARRIERI
  3024                 MOVE PI-CR-GROUPING
  3025                                 TO  GROUPI
  3026                 MOVE PI-CR-FIN-RESP
  3027                                 TO  FINRESPI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL635.cbl
  3028                 MOVE PI-CR-ACCOUNT
  3029                                 TO  ACCTI
  3030                 MOVE 1          TO  CARRIERL  MAINTA
  3031                 MOVE 3              TO  GROUPL
  3032                 MOVE 6              TO  FINRESPL  ACCTL
  3033                 GO TO 0400-VALIDATE-KEY-DATA.
  3034
  3035
  3036* EXEC CICS HANDLE CONDITION
  3037*        PGMIDERR  (9600-PGMID-ERROR)
  3038*        ERROR     (9990-ABEND)
  3039*    END-EXEC.
  3040*    MOVE '"$L.                  ! " #00003031' TO DFHEIV0
  3041     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3042     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3043     MOVE X'2220233030303033303331' TO DFHEIV0(25:11)
  3044     CALL 'kxdfhei1' USING DFHEIV0
  3045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3046
  3047
  3048     IF  EIBAID = DFHCLEAR
  3049             OR
  3050         NOT DISPLAY-CAP
  3051         GO TO 9400-CLEAR.
  3052
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL635.cbl
  3054 0200-RECEIVE.
  3055     IF EIBAID = DFHPA1  OR  DFHPA2  OR  DFHPA3
  3056         MOVE ER-0008            TO  EMI-ERROR
  3057         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3058         MOVE -1                 TO  MAINTL
  3059         GO TO 8200-SEND-DATAONLY.
  3060
  3061
  3062* EXEC CICS RECEIVE
  3063*        MAP     (MAP-NAME)
  3064*        MAPSET  (MAPSET-NAME)
  3065*        INTO    (EL635AI)
  3066*    END-EXEC.
  3067     MOVE LENGTH OF
  3068      EL635AI
  3069       TO DFHEIV11
  3070*    MOVE '8"T I  L              ''   #00003049' TO DFHEIV0
  3071     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3072     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3073     MOVE X'2020233030303033303439' TO DFHEIV0(25:11)
  3074     CALL 'kxdfhei1' USING DFHEIV0,
  3075           MAP-NAME,
  3076           EL635AI,
  3077           DFHEIV11,
  3078           MAPSET-NAME,
  3079           DFHEIV99,
  3080           DFHEIV99
  3081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3082
  3083
  3084     IF PFENTERL = ZERO
  3085         GO TO 0300-CHECK-PFKEYS.
  3086
  3087     IF (PFENTERI  IS NUMERIC)
  3088       AND (PFENTERI GREATER 0 AND LESS 25)
  3089         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  3090     ELSE
  3091         MOVE ER-0029               TO  EMI-ERROR
  3092         GO TO 0320-INPUT-ERROR.
  3093
  3094 0300-CHECK-PFKEYS.
  3095     IF EIBAID = DFHPF23
  3096         GO TO 8810-PF23.
  3097
  3098     IF EIBAID = DFHPF24
  3099         GO TO 9200-RETURN-MAIN-MENU.
  3100
  3101     IF EIBAID = DFHPF12
  3102         GO TO 9500-PF12.
  3103
  3104     IF EIBAID = DFHPF3
  3105         IF PI-CR-CONTROL-IN-PROGRESS NOT = SPACES
  3106             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3107             MOVE XCTL-652       TO  PGM-NAME
  3108            IF PI-CR-ACCOUNT = LOW-VALUES
  3109               MOVE 'G'          TO  PI-CR-TYPE
  3110               GO TO 9300-XCTL
  3111            ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL635.cbl
  3112               MOVE 'A'          TO  PI-CR-TYPE
  3113               GO TO 9300-XCTL
  3114         ELSE
  3115            MOVE ER-3020         TO  EMI-ERROR
  3116            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3117            GO TO 8100-SEND-INITIAL-MAP.
  3118
  3119     IF EIBAID = DFHPF4
  3120         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3121         MOVE XCTL-6351          TO  PGM-NAME
  3122         GO TO 9300-XCTL.
  3123
  3124     IF CREDIT-SESSION  AND EIBAID = DFHPF6
  3125         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3126         MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3127         MOVE XCTL-640           TO  PGM-NAME
  3128         IF PI-CR-ACCOUNT = LOW-VALUES
  3129             MOVE SPACES       TO  PI-CR-CONTROL-IN-PROGRESS
  3130             GO TO 9300-XCTL
  3131         ELSE
  3132             MOVE 'A'          TO  PI-CR-TYPE
  3133             GO TO 9300-XCTL.
  3134
  3135     IF CREDIT-SESSION  AND EIBAID = DFHPF7
  3136        IF PI-GA-BILLING
  3137            PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3138            MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3139            MOVE XCTL-642        TO  PGM-NAME
  3140            IF PI-CR-ACCOUNT = LOW-VALUES
  3141                MOVE 'G'          TO  PI-CR-TYPE
  3142                GO TO 9300-XCTL
  3143            ELSE
  3144                MOVE SPACES      TO  PI-CR-CONTROL-IN-PROGRESS
  3145                GO TO 9300-XCTL
  3146        ELSE
  3147            MOVE ER-2929         TO  EMI-ERROR
  3148            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3149            MOVE AL-UNBON        TO  PFENTERA
  3150            IF PFENTERL = ZERO
  3151                MOVE -1          TO  MAINTL
  3152                GO TO 8200-SEND-DATAONLY
  3153            ELSE
  3154                MOVE -1          TO  PFENTERL
  3155                GO TO 8200-SEND-DATAONLY.
  3156
  3157     IF EIBAID = DFHPF1  OR  DFHPF2
  3158         GO TO 0400-VALIDATE-KEY-DATA.
  3159
  3160     IF EIBAID = DFHENTER
  3161         MOVE SPACES             TO WS-ACCEPT-1 (W-INDX)
  3162         MOVE SPACES             TO WS-PREV-PF5
  3163         GO TO 0400-VALIDATE-KEY-DATA.
  3164
  3165     IF EIBAID = DFHPF5
  3166         MOVE PI-ACCEPT          TO WS-ACCEPT-TABLE
  3167         GO TO 0400-VALIDATE-KEY-DATA.
  3168
  3169     IF EIBAID = DFHPF8
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL635.cbl
  3170         GO TO 0400-VALIDATE-KEY-DATA.
  3171
  3172 0320-INPUT-ERROR.
  3173     MOVE ER-0029                TO  EMI-ERROR.
  3174
  3175     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3176
  3177     MOVE AL-UNBON               TO  PFENTERA.
  3178
  3179     IF PFENTERL = ZERO
  3180         MOVE -1                 TO  MAINTL
  3181     ELSE
  3182         MOVE -1                 TO  PFENTERL.
  3183
  3184     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL635.cbl
  3186 0400-VALIDATE-KEY-DATA.
  3187     IF MODIFY-CAP  OR (EIBAID = DFHPF1 OR DFHPF2)
  3188         NEXT SENTENCE
  3189       ELSE
  3190        IF MAINTI NOT = 'S'
  3191         MOVE 'UPDATE'           TO SM-READ
  3192         PERFORM 9995-SECURITY-VIOLATION
  3193         IF  MORTGAGE-SESSION
  3194             MOVE ER-9096        TO EMI-ERROR
  3195             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3196             GO TO 8100-SEND-INITIAL-MAP
  3197         ELSE
  3198             MOVE ER-0070        TO EMI-ERROR
  3199             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3200             GO TO 8100-SEND-INITIAL-MAP.
  3201
  3202     MOVE PI-COMPANY-CD          TO  PI-SAV-COMP-CD.
  3203
  3204     IF EIBAID   = DFHPF1
  3205        GO TO 4000-BROWSE-FRWD.
  3206
  3207     IF EIBAID   = DFHPF1   AND
  3208        CARRIERL = ZEROS    AND
  3209        GROUPL   = ZEROS    AND
  3210        FINRESPL = ZEROS    AND
  3211        ACCTL    = ZEROS
  3212         GO TO 4000-BROWSE-FRWD.
  3213
  3214     IF EIBAID   = DFHPF8
  3215        GO TO 1010-COMP-CHECK.
  3216
  3217     IF MAINTI = 'C' OR  'S'
  3218         MOVE AL-UANON           TO  MAINTA
  3219         MOVE MAINTI             TO  PI-SAV-FUNCTION
  3220     ELSE
  3221         MOVE -1                 TO  MAINTL
  3222         MOVE ER-0023            TO  EMI-ERROR
  3223         MOVE AL-UABON           TO  MAINTA
  3224         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3225
  3226     IF MAINTI = 'C'
  3227       AND PI-PREV-FUNCTION NOT = 'S'
  3228         MOVE -1                 TO  MAINTL
  3229         MOVE ER-2056            TO  EMI-ERROR
  3230         MOVE AL-UABON           TO  MAINTA
  3231         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3232
  3233     IF MORTGAGE-SESSION
  3234        IF PI-SPECIAL-GROUPING
  3235           IF CARRIERL       GREATER THAN ZEROS
  3236              OR GROUPL      GREATER THAN ZEROS
  3237              OR FINRESPL    GREATER THAN ZEROS
  3238              OR ACCTL       GREATER THAN ZEROS
  3239                 MOVE ER-9179    TO EMI-ERROR
  3240                 MOVE -1         TO CARRIERL
  3241                 MOVE AL-UABON   TO CARRIERA
  3242                                    GROUPA
  3243                                    FINRESPA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL635.cbl
  3244                                    ACCTA
  3245                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3246                 GO TO 0410-CONT-EDIT
  3247           ELSE
  3248              GO TO 0410-CONT-EDIT
  3249        ELSE
  3250           NEXT SENTENCE.
  3251
  3252     IF CARRIERL = ZEROS  AND
  3253        GROUPL   = ZEROS  AND
  3254        FINRESPL = ZEROS  AND
  3255        ACCTL    = ZEROS
  3256         MOVE -1                 TO  CARRIERL
  3257         MOVE ER-2231            TO  EMI-ERROR
  3258         MOVE AL-UABOF           TO  CARRIERA
  3259                                     GROUPA
  3260                                     FINRESPA
  3261                                     ACCTA
  3262         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3263         GO TO 8200-SEND-DATAONLY.
  3264
  3265     IF CARRIERL NOT = ZEROS
  3266         MOVE AL-UANON           TO  CARRIERA
  3267         MOVE CARRIERI           TO  COMP-CARRIER
  3268                                     PI-SAV-CARRIER
  3269                                     PI-CR-CARRIER
  3270         IF CARRIERI NOT = ZEROS
  3271           AND (PI-ZERO-CARRIER  OR  PI-ZERO-CAR-GROUP)
  3272             MOVE ER-2587        TO  EMI-ERROR
  3273             MOVE -1             TO  CARRIERL
  3274             MOVE AL-UABON       TO  CARRIERA
  3275             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3276         ELSE
  3277             NEXT SENTENCE
  3278     ELSE
  3279         MOVE LOW-VALUES          TO  COMP-CARRIER
  3280                                      PI-SAV-CARRIER.
  3281
  3282     IF CARRIERL NOT = ZEROS
  3283            AND
  3284        CARRIERI NOT = SPACES
  3285         IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  3286             IF PI-CARRIER-SECURITY = CARRIERI
  3287                 NEXT SENTENCE
  3288             ELSE
  3289                 MOVE -1         TO  CARRIERL
  3290                 MOVE ER-2370    TO  EMI-ERROR
  3291                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3292
  3293     IF GROUPL NOT = ZEROS
  3294         MOVE AL-UANON           TO  GROUPA
  3295         MOVE GROUPI             TO  COMP-GROUPING
  3296                                     PI-SAV-GROUPING
  3297                                     PI-CR-GROUPING
  3298     ELSE
  3299         MOVE LOW-VALUES         TO  COMP-GROUPING
  3300                                     PI-SAV-GROUPING.
  3301
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL635.cbl
  3302     IF FINRESPL NOT = ZEROS
  3303         MOVE AL-UANON           TO  FINRESPA
  3304         MOVE FINRESPI           TO  COMP-FIN-RESP
  3305                                     PI-SAV-FIN-RESP
  3306                                     PI-CR-FIN-RESP
  3307     ELSE
  3308         MOVE LOW-VALUES         TO  COMP-FIN-RESP
  3309                                     PI-SAV-FIN-RESP.
  3310
  3311     IF ACCTL NOT = ZEROS
  3312         MOVE AL-UANON           TO  ACCTA
  3313         MOVE ACCTI              TO  COMP-ACCOUNT
  3314                                     PI-SAV-ACCOUNT
  3315                                     PI-CR-ACCOUNT
  3316     ELSE
  3317         MOVE LOW-VALUES         TO  COMP-ACCOUNT
  3318                                     PI-SAV-ACCOUNT
  3319                                     PI-CR-ACCOUNT.
  3320
  3321 0410-CONT-EDIT.
  3322
  3323     IF EMI-ERROR NOT = ZEROS
  3324         GO TO 8200-SEND-DATAONLY.
  3325
  3326     MOVE MAINTI                 TO  PI-PREV-FUNCTION.
  3327
  3328     IF MAINTI = 'S'
  3329         IF EIBAID = DFHPF1  OR  DFHENTER
  3330             GO TO 4000-BROWSE-FRWD
  3331         ELSE
  3332             GO TO 4100-BROWSE-BKWD.
  3333
  3334     IF PI-SPECIAL-GROUPING
  3335        GO TO 0410-SKIP-COMP-EDIT.
  3336
  3337     IF PI-APPLIED (1) = 'N' OR
  3338        PI-APPLIED (2) = 'N' OR
  3339        PI-APPLIED (3) = 'N'
  3340         GO TO 0410-SKIP-COMP-EDIT.
  3341
  3342     MOVE SPACE                  TO  OVERWRITE-AGENT-SW.
  3343     MOVE PI-COMPANY-CD          TO  COMP-COMP-CD.
  3344     MOVE '1'                    TO  WS-SECOND-READ.
  3345
  3346     IF ACCTI = LOW-VALUES
  3347         GO TO 0405-VERIFY-G-ONLY.
  3348
  3349     IF ACCTI NOT = FINRESPI
  3350         GO TO 0410-SKIP-COMP-EDIT.
  3351
  3352 0405-VERIFY-A-COMP.
  3353
  3354     MOVE 'A'                TO  COMP-RECORD-TYPE.
  3355
  3356
  3357* EXEC CICS HANDLE CONDITION
  3358*        NOTFND   (0410-NO-A-COMP)
  3359*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL635.cbl
  3360*        END-EXEC.
  3361*    MOVE '"$IJ                  ! # #00003327' TO DFHEIV0
  3362     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3363     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3364     MOVE X'2320233030303033333237' TO DFHEIV0(25:11)
  3365     CALL 'kxdfhei1' USING DFHEIV0
  3366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3367
  3368
  3369
  3370* EXEC CICS READ
  3371*        DATASET  (COMP-FILE-ID)
  3372*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3373*        RIDFLD   (ERCOMP-KEY)
  3374*        EQUAL
  3375*        END-EXEC.
  3376*    MOVE '&"S        E          (   #00003332' TO DFHEIV0
  3377     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3378     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3379     MOVE X'2020233030303033333332' TO DFHEIV0(25:11)
  3380     CALL 'kxdfhei1' USING DFHEIV0,
  3381           COMP-FILE-ID,
  3382           DFHEIV20,
  3383           DFHEIV99,
  3384           ERCOMP-KEY,
  3385           DFHEIV99,
  3386           DFHEIV99,
  3387           DFHEIV99
  3388     SET ADDRESS OF COMPENSATION-MASTER TO
  3389         DFHEIV20
  3390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3391
  3392
  3393     IF COMP-FIN-RESP NOT = COMP-ACCOUNT
  3394         NEXT SENTENCE
  3395     ELSE
  3396         GO TO 0410-SKIP-COMP-EDIT.
  3397
  3398     MOVE LOW-VALUES         TO  COMP-ACCOUNT.
  3399     MOVE 'G'                TO  COMP-RECORD-TYPE.
  3400
  3401
  3402* EXEC CICS HANDLE CONDITION
  3403*        NOTFND   (0410-NO-G-FOR-A)
  3404*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3405*        END-EXEC.
  3406*    MOVE '"$IJ                  ! $ #00003347' TO DFHEIV0
  3407     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3408     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3409     MOVE X'2420233030303033333437' TO DFHEIV0(25:11)
  3410     CALL 'kxdfhei1' USING DFHEIV0
  3411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3412
  3413
  3414
  3415* EXEC CICS READ
  3416*        DATASET  (COMP-FILE-ID)
  3417*        SET      (ADDRESS OF COMPENSATION-MASTER)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL635.cbl
  3418*        RIDFLD   (ERCOMP-KEY)
  3419*        EQUAL
  3420*        END-EXEC.
  3421*    MOVE '&"S        E          (   #00003352' TO DFHEIV0
  3422     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3423     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3424     MOVE X'2020233030303033333532' TO DFHEIV0(25:11)
  3425     CALL 'kxdfhei1' USING DFHEIV0,
  3426           COMP-FILE-ID,
  3427           DFHEIV20,
  3428           DFHEIV99,
  3429           ERCOMP-KEY,
  3430           DFHEIV99,
  3431           DFHEIV99,
  3432           DFHEIV99
  3433     SET ADDRESS OF COMPENSATION-MASTER TO
  3434         DFHEIV20
  3435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3436
  3437
  3438     GO TO 0410-SKIP-COMP-EDIT.
  3439
  3440 0410-NO-A-COMP.
  3441
  3442     MOVE -1                     TO  CARRIERL.
  3443     MOVE AL-UABON               TO  CARRIERA
  3444                                     GROUPA
  3445                                     FINRESPA
  3446                                     ACCTA.
  3447
  3448     MOVE ER-3178                TO  EMI-ERROR
  3449
  3450     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3451
  3452     GO TO 8200-SEND-DATAONLY.
  3453
  3454 0410-NO-G-FOR-A.
  3455
  3456     MOVE -1                     TO  CARRIERL.
  3457     MOVE AL-UABON               TO  CARRIERA
  3458                                     GROUPA
  3459                                     FINRESPA
  3460                                     ACCTA.
  3461
  3462     MOVE ER-3193                TO  EMI-ERROR
  3463
  3464     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3465
  3466     GO TO 8200-SEND-DATAONLY.
  3467
  3468 0405-VERIFY-G-ONLY.
  3469
  3470     MOVE 'G'                TO  COMP-RECORD-TYPE.
  3471
  3472
  3473* EXEC CICS HANDLE CONDITION
  3474*        NOTFND   (0410-NO-G-COMP)
  3475*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL635.cbl
  3476*        END-EXEC.
  3477*    MOVE '"$IJ                  ! % #00003393' TO DFHEIV0
  3478     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3479     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3480     MOVE X'2520233030303033333933' TO DFHEIV0(25:11)
  3481     CALL 'kxdfhei1' USING DFHEIV0
  3482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3483
  3484
  3485
  3486* EXEC CICS READ
  3487*        DATASET  (COMP-FILE-ID)
  3488*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3489*        RIDFLD   (ERCOMP-KEY)
  3490*        EQUAL
  3491*        END-EXEC.
  3492*    MOVE '&"S        E          (   #00003398' TO DFHEIV0
  3493     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3494     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3495     MOVE X'2020233030303033333938' TO DFHEIV0(25:11)
  3496     CALL 'kxdfhei1' USING DFHEIV0,
  3497           COMP-FILE-ID,
  3498           DFHEIV20,
  3499           DFHEIV99,
  3500           ERCOMP-KEY,
  3501           DFHEIV99,
  3502           DFHEIV99,
  3503           DFHEIV99
  3504     SET ADDRESS OF COMPENSATION-MASTER TO
  3505         DFHEIV20
  3506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3507
  3508
  3509     GO TO 0410-SKIP-COMP-EDIT.
  3510
  3511 0410-NO-G-COMP.
  3512
  3513     MOVE -1                     TO  CARRIERL.
  3514     MOVE AL-UABON               TO  CARRIERA
  3515                                     GROUPA
  3516                                     FINRESPA
  3517                                     ACCTA.
  3518
  3519     MOVE ER-3179                TO  EMI-ERROR.
  3520
  3521     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3522
  3523     GO TO 8200-SEND-DATAONLY.
  3524
  3525 0410-SKIP-COMP-EDIT.
  3526
  3527     IF MAINTI = 'C'
  3528         GO TO 1000-EDIT-DATA.
  3529
  3530     IF EIBAID = DFHPF1
  3531       OR DFHENTER
  3532         GO TO 4000-BROWSE-FRWD.
  3533
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL635.cbl
  3534     IF EIBAID = DFHPF2
  3535         GO TO 4100-BROWSE-BKWD.
  3536
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL635.cbl
  3538 0500-CREATE-TEMP-STORAGE.
  3539
  3540     PERFORM 0800-DELETE-TS  THRU  0890-EXIT.
  3541
  3542
  3543* EXEC CICS WRITEQ TS
  3544*        QUEUE  (QID)
  3545*        FROM   (PROGRAM-INTERFACE-BLOCK)
  3546*        LENGTH (PI-COMM-LENGTH)
  3547*    END-EXEC.
  3548*    MOVE '*"                    ''   #00003438' TO DFHEIV0
  3549     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  3550     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3551     MOVE X'2020233030303033343338' TO DFHEIV0(25:11)
  3552     CALL 'kxdfhei1' USING DFHEIV0,
  3553           QID,
  3554           PROGRAM-INTERFACE-BLOCK,
  3555           PI-COMM-LENGTH,
  3556           DFHEIV99,
  3557           DFHEIV99,
  3558           DFHEIV99
  3559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3560
  3561
  3562 0590-EXIT.
  3563      EXIT.
  3564
  3565 0600-RECOVER-TEMP-STORAGE.
  3566
  3567* EXEC CICS READQ TS
  3568*        QUEUE  (QID)
  3569*        INTO   (PROGRAM-INTERFACE-BLOCK)
  3570*        LENGTH (PI-COMM-LENGTH)
  3571*    END-EXEC.
  3572*    MOVE '*$I    L              ''   #00003448' TO DFHEIV0
  3573     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  3574     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3575     MOVE X'2020233030303033343438' TO DFHEIV0(25:11)
  3576     CALL 'kxdfhei1' USING DFHEIV0,
  3577           QID,
  3578           PROGRAM-INTERFACE-BLOCK,
  3579           PI-COMM-LENGTH,
  3580           DFHEIV99,
  3581           DFHEIV99,
  3582           DFHEIV99
  3583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3584
  3585
  3586     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  3587
  3588 0690-EXIT.
  3589      EXIT.
  3590
  3591 0800-DELETE-TS.
  3592
  3593* EXEC CICS HANDLE CONDITION
  3594*        QIDERR (0890-EXIT)
  3595*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL635.cbl
  3596*    MOVE '"$N                   ! & #00003460' TO DFHEIV0
  3597     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3598     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3599     MOVE X'2620233030303033343630' TO DFHEIV0(25:11)
  3600     CALL 'kxdfhei1' USING DFHEIV0
  3601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3602
  3603
  3604
  3605* EXEC CICS DELETEQ TS
  3606*        QUEUE  (QID)
  3607*    END-EXEC.
  3608*    MOVE '*&                    #   #00003464' TO DFHEIV0
  3609     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3610     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3611     MOVE X'2020233030303033343634' TO DFHEIV0(25:11)
  3612     CALL 'kxdfhei1' USING DFHEIV0,
  3613           QID,
  3614           DFHEIV99
  3615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3616
  3617
  3618
  3619* EXEC CICS SYNCPOINT
  3620*    END-EXEC.
  3621*    MOVE '6"                    !   #00003468' TO DFHEIV0
  3622     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  3623     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3624     MOVE X'2020233030303033343638' TO DFHEIV0(25:11)
  3625     CALL 'kxdfhei1' USING DFHEIV0
  3626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3627
  3628
  3629 0890-EXIT.
  3630      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL635.cbl
  3632
  3633 1000-EDIT-DATA.
  3634
  3635     IF NOT MODIFY-CAP
  3636         MOVE 'UPDATE'       TO SM-READ
  3637         PERFORM 9995-SECURITY-VIOLATION
  3638         MOVE ER-0070        TO EMI-ERROR
  3639         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3640         GO TO 8100-SEND-INITIAL-MAP.
  3641
  3642     SET PINDX                   TO  1.
  3643     SET W-INDX                  TO  1.
  3644
  3645****** IF THE REFERENCE NUMBER HAS BEEN FILLED IN AUTOMATICALLY
  3646****** FROM THE PI-AREA OF EL630,  THE ATTRIBUTE WAS ERASED
  3647****** WHEN THE SCREEN WAS DISPLAYED IN 8100-SEND-INITIAL-MAP.
  3648****** UNLESS THE CLIENT TYPES OVER THE REFERENCE NUMBER,
  3649****** THE PROGRAM IS NOT AWARE THAT THE NUMBER IS DISPLAYED.
  3650
  3651     IF ((REF-LEN (PINDX) EQUAL ZEROS)
  3652         AND (REFERENCE-DISPLAYED)
  3653         AND (PI-PYAJ-REFERENCE NOT EQUAL SPACES))
  3654           MOVE PI-PYAJ-REFERENCE TO REF (PINDX)
  3655           MOVE 12               TO REF-LEN (PINDX)
  3656           MOVE AL-UANON         TO REF-ATTRB (PINDX)
  3657           MOVE SPACE            TO PI-PYAJ-FILLED-SW
  3658           MOVE SPACE            TO PI-PYAJ-REFERENCE.
  3659
  3660 1010-EDIT-LOOP.
  3661
  3662     SET NDX                     TO  PINDX.
  3663
  3664     SET WS-SAVE-INDEX-VALUE     TO  PINDX.
  3665
  3666     IF COMM-LEN (PINDX)    = ZEROS
  3667       AND RTYPE-LEN (PINDX)   = ZEROS
  3668       AND AMT-LEN (PINDX)     = ZEROS
  3669       AND APPLIED-LEN (PINDX) = ZEROS
  3670       AND VOID-SW-LEN (PINDX) = ZEROS
  3671       AND SDTE-LEN (PINDX)    = ZEROS
  3672       AND IDTE-LEN (PINDX)    = ZEROS
  3673         GO TO 1020-CHECK-INVOICE.
  3674
  3675     IF EIBAID = DFHPF5
  3676         GO TO 1010-EDIT-PROCESS.
  3677
  3678     IF WS-PREV-PF5 = 'Y' AND
  3679         COMM-LEN (PINDX)    = ZEROS AND
  3680         RTYPE-LEN (PINDX)   = ZEROS AND
  3681         AMT-LEN (PINDX)     = ZEROS AND
  3682         APPLIED-LEN (PINDX) = ZEROS AND
  3683         VOID-SW-LEN (PINDX) = ZEROS AND
  3684         SDTE-LEN (PINDX)    = ZEROS AND
  3685         IDTE-LEN (PINDX)    = ZEROS
  3686         GO TO 1020-CHECK-INVOICE.
  3687
  3688 1010-EDIT-PROCESS.
  3689
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL635.cbl
  3690     IF COMM-LEN (PINDX) NOT = ZEROS
  3691         MOVE AL-UANON           TO  COMM-ATTRB (PINDX)
  3692         IF PI-COMPANY-ID NOT = 'NCL'
  3693             NEXT SENTENCE
  3694         ELSE
  3695             IF NCL-COMM-DTE (PINDX) IS NUMERIC
  3696                 MOVE NCL-COMM-DTE (PINDX)
  3697                                 TO  DC-GREG-DATE-1-MDY
  3698                 MOVE '4'        TO  DC-OPTION-CODE
  3699                 PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  3700                 IF NO-CONVERSION-ERROR
  3701                     NEXT SENTENCE
  3702                 ELSE
  3703                     MOVE ER-2595
  3704                                 TO  EMI-ERROR
  3705                     MOVE -1     TO  COMM-LEN (PINDX)
  3706                     MOVE AL-UABON
  3707                                 TO  COMM-ATTRB (PINDX)
  3708                     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3709             ELSE
  3710                 IF NCL-COMM-DTE (PINDX) = SPACES OR LOW-VALUES
  3711                     MOVE WS-CURRENT-MDY
  3712                                 TO  NCL-COMM-DTE (PINDX)
  3713                 ELSE
  3714                     MOVE COMM (PINDX)
  3715                                 TO  WS-COMMENT-FULL
  3716                     MOVE WS-COMMENT-24-POS
  3717                                 TO  NCL-COMM-REST (PINDX)
  3718                     MOVE WS-CURRENT-MDY
  3719                                 TO  NCL-COMM-DTE (PINDX)
  3720     ELSE
  3721         IF PI-COMPANY-ID = 'NCL'
  3722           AND PI-FILE-SEQ-NO (NDX) = ZEROS
  3723             MOVE +6             TO  COMM-LEN (PINDX)
  3724             MOVE WS-CURRENT-MDY TO  NCL-COMM-DTE (PINDX).
  3725
  3726     IF RTYPE-LEN (PINDX) NOT = ZEROS
  3727         MOVE RTYPE (PINDX)      TO  CHECK-REC-TYPE
  3728         IF MORTGAGE-SESSION
  3729            IF NOT VALID-MTG-REC-TYPE
  3730               MOVE -1           TO  RTYPE-LEN (PINDX)
  3731               MOVE ER-2234      TO  EMI-ERROR
  3732               MOVE AL-UABON     TO  RTYPE-ATTRB (PINDX)
  3733               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3734            ELSE
  3735               MOVE AL-UANON     TO  RTYPE-ATTRB (PINDX)
  3736         ELSE
  3737            IF PI-COMPANY-ID = 'MON'
  3738                IF NOT MON-VALID-REC-TYPE
  3739                   MOVE -1       TO  RTYPE-LEN (PINDX)
  3740                   MOVE ER-7806  TO  EMI-ERROR
  3741                   MOVE AL-UABON TO  RTYPE-ATTRB (PINDX)
  3742                   PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3743                ELSE
  3744                   MOVE AL-UANON TO  RTYPE-ATTRB (PINDX)
  3745            ELSE
  3746                IF PI-COMPANY-ID = 'NCL'
  3747                    IF NOT NCL-VALID-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL635.cbl
  3748                       MOVE -1   TO  RTYPE-LEN (PINDX)
  3749                       MOVE ER-7806
  3750                                 TO  EMI-ERROR
  3751                       MOVE AL-UABON
  3752                                 TO  RTYPE-ATTRB (PINDX)
  3753                       PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3754                    ELSE
  3755                       MOVE AL-UANON
  3756                                 TO  RTYPE-ATTRB (PINDX)
  3757            ELSE
  3758                IF PI-COMPANY-ID = 'ANL'
  3759                    IF NOT ANL-VALID-REC-TYPE
  3760                       MOVE -1   TO  RTYPE-LEN (PINDX)
  3761                       MOVE ER-7806
  3762                                 TO  EMI-ERROR
  3763                       MOVE AL-UABON
  3764                                 TO  RTYPE-ATTRB (PINDX)
  3765                       PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3766                    ELSE
  3767                       MOVE AL-UANON
  3768                                 TO  RTYPE-ATTRB (PINDX)
  3769                ELSE
  3770                    IF NOT VALID-REC-TYPE
  3771                        MOVE -1  TO  RTYPE-LEN (PINDX)
  3772                        MOVE ER-2234
  3773                                 TO  EMI-ERROR
  3774                        MOVE AL-UABON
  3775                                 TO  RTYPE-ATTRB (PINDX)
  3776                        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3777                    ELSE
  3778                        MOVE AL-UANON
  3779                                 TO  RTYPE-ATTRB (PINDX)
  3780     ELSE
  3781         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3782             MOVE -1             TO  RTYPE-LEN (PINDX)
  3783             MOVE ER-2235        TO  EMI-ERROR
  3784             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3785             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3786
  3787     IF AMT-LEN (PINDX) NOT = ZEROS
  3788
  3789* EXEC CICS BIF DEEDIT
  3790*            FIELD (AMT (PINDX))
  3791*            LENGTH (11)
  3792*        END-EXEC
  3793     MOVE 11
  3794       TO DFHEIV11
  3795*    MOVE '@"L                   #   #00003630' TO DFHEIV0
  3796     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3797     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3798     MOVE X'2020233030303033363330' TO DFHEIV0(25:11)
  3799     CALL 'kxdfhei1' USING DFHEIV0,
  3800           AMT(PINDX),
  3801           DFHEIV11
  3802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3803         IF AMT(PINDX) = ZEROS
  3804             IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3805                 SET WS-INDX  TO PINDX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL635.cbl
  3806                 MOVE AMT(PINDX) TO  WS-EDITED-AMT (WS-INDX)
  3807                 GO TO 1050-INCREMENT-PINDX
  3808             ELSE
  3809                 MOVE ER-2245    TO  EMI-ERROR
  3810                 MOVE -1         TO  AMT-LEN(PINDX)
  3811                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3812                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3813         ELSE
  3814             IF AMT (PINDX) NUMERIC
  3815                 SET WS-INDX  TO PINDX
  3816                 MOVE AMT (PINDX)
  3817                                 TO  WS-EDITED-AMT (WS-INDX)
  3818             ELSE
  3819                 MOVE ER-2245    TO  EMI-ERROR
  3820                 MOVE -1         TO  AMT-LEN(PINDX)
  3821                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3822                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3823     ELSE
  3824         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3825             MOVE -1             TO  AMT-LEN (PINDX)
  3826             MOVE ER-2236        TO  EMI-ERROR
  3827             MOVE AL-UNBON       TO  AMT-ATTRB (PINDX)
  3828             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3829
  3830     IF APPLIED-LEN (PINDX) NOT = ZERO
  3831         IF APPLIED  (PINDX) = 'A' OR 'G' OR 'O'
  3832             NEXT SENTENCE
  3833         ELSE
  3834             MOVE -1             TO APPLIED-LEN   (PINDX)
  3835             MOVE ER-3146        TO EMI-ERROR
  3836             MOVE AL-UABON       TO APPLIED-ATTRB (PINDX)
  3837             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3838     ELSE
  3839         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3840             MOVE -1             TO  APPLIED-LEN (PINDX)
  3841             MOVE ER-3146        TO  EMI-ERROR
  3842             MOVE AL-UABON       TO  APPLIED-ATTRB (PINDX)
  3843             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3844
  3845     IF APPLIED-LEN (PINDX) NOT = ZEROS
  3846         IF APPLIED (PINDX) = 'A'
  3847            IF ACCTI = LOW-VALUES
  3848               MOVE -1           TO APPLIED-LEN   (PINDX)
  3849               MOVE ER-3195      TO EMI-ERROR
  3850               MOVE AL-UABON     TO APPLIED-ATTRB (PINDX)
  3851               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3852
  3853 1010-COMP-CHECK.
  3854
  3855     IF EIBAID   = DFHPF8
  3856         IF EIBCPOSN = WS-CURSOR-POS-1
  3857             SET PINDX TO 1
  3858         ELSE
  3859             IF EIBCPOSN = WS-CURSOR-POS-2
  3860                 SET PINDX TO 2
  3861             ELSE
  3862                 IF EIBCPOSN = WS-CURSOR-POS-3
  3863                     SET PINDX TO 3
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL635.cbl
  3864                 ELSE
  3865                     MOVE ER-3262
  3866                                 TO EMI-ERROR
  3867                     MOVE -1     TO COMM-LEN (PINDX)
  3868                     MOVE AL-UABON
  3869                                 TO COMM-ATTRB (PINDX)
  3870                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3871                     SET PINDX UP  BY 3
  3872                     GO TO 1050-INCREMENT-PINDX.
  3873
  3874     MOVE PI-COMPANY-CD          TO COMP-COMP-CD.
  3875     MOVE CARRIERI               TO COMP-CARRIER.
  3876     MOVE GROUPI                 TO COMP-GROUPING.
  3877     MOVE FINRESPI               TO COMP-FIN-RESP.
  3878
  3879     IF EIBAID NOT = DFHPF8
  3880         IF APPLIED-LEN (PINDX) NOT = ZEROS
  3881             IF (APPLIED (PINDX) = 'O') OR
  3882                (ACCTI = SPACES OR LOW-VALUES)
  3883                 GO TO 1011-VERIFY-COMP-G
  3884             ELSE
  3885                 NEXT SENTENCE
  3886         ELSE
  3887             IF (PI-APPLIED (NDX) = 'O') OR
  3888                (ACCTI = SPACES OR LOW-VALUES)
  3889                 GO TO 1011-VERIFY-COMP-G
  3890             ELSE
  3891                 NEXT SENTENCE
  3892     ELSE
  3893         SET NDX TO PINDX
  3894         IF (PI-APPLIED (NDX) = 'O') OR
  3895            (ACCTI = SPACES OR LOW-VALUES)
  3896             GO TO 1011-VERIFY-COMP-G.
  3897
  3898     MOVE ACCTI                  TO COMP-ACCOUNT.
  3899     MOVE 'A'                    TO COMP-RECORD-TYPE.
  3900
  3901
  3902* EXEC CICS HANDLE CONDITION
  3903*        NOTFND   (1011-NO-COMP-A)
  3904*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3905*        END-EXEC.
  3906*    MOVE '"$IJ                  ! '' #00003732' TO DFHEIV0
  3907     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3908     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3909     MOVE X'2720233030303033373332' TO DFHEIV0(25:11)
  3910     CALL 'kxdfhei1' USING DFHEIV0
  3911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3912
  3913
  3914
  3915* EXEC CICS READ
  3916*        DATASET  (COMP-FILE-ID)
  3917*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3918*        RIDFLD   (ERCOMP-KEY)
  3919*        EQUAL
  3920*        END-EXEC.
  3921*    MOVE '&"S        E          (   #00003737' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL635.cbl
  3922     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3923     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3924     MOVE X'2020233030303033373337' TO DFHEIV0(25:11)
  3925     CALL 'kxdfhei1' USING DFHEIV0,
  3926           COMP-FILE-ID,
  3927           DFHEIV20,
  3928           DFHEIV99,
  3929           ERCOMP-KEY,
  3930           DFHEIV99,
  3931           DFHEIV99,
  3932           DFHEIV99
  3933     SET ADDRESS OF COMPENSATION-MASTER TO
  3934         DFHEIV20
  3935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3936
  3937
  3938 1011-CHECK-FOR-A.
  3939
  3940     IF EIBAID NOT = DFHPF8
  3941         IF APPLIED (PINDX) = 'A'
  3942              GO TO 1012-CHK-VOID
  3943         ELSE
  3944             NEXT SENTENCE
  3945     ELSE
  3946         IF PI-APPLIED (NDX) = 'A'
  3947              GO TO 1025-CHECK-INVOICE.
  3948
  3949     IF EIBAID NOT = DFHPF8
  3950         IF APPLIED (PINDX) = 'G'
  3951              GO TO 1011-VERIFY-COMP-G
  3952         ELSE
  3953             NEXT SENTENCE
  3954     ELSE
  3955         IF PI-APPLIED (NDX) = 'G'
  3956              GO TO 1011-VERIFY-COMP-G.
  3957
  3958     IF EIBAID = DFHPF8
  3959         GO TO 1025-CHECK-INVOICE
  3960     ELSE
  3961         IF APPLIED (PINDX) = 'O'
  3962             MOVE -1             TO APPLIED-LEN   (PINDX)
  3963             MOVE ER-3196        TO EMI-ERROR
  3964             MOVE AL-UABON       TO APPLIED-ATTRB (PINDX)
  3965             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3966             GO TO 1012-CHK-VOID.
  3967
  3968     GO TO 1012-CHK-VOID.
  3969
  3970 1011-NO-COMP-A.
  3971
  3972      MOVE ER-3178               TO  EMI-ERROR.
  3973      MOVE -1                    TO  CARRIERL.
  3974      MOVE AL-UABON              TO  CARRIERA
  3975                                     GROUPA
  3976                                     FINRESPA.
  3977
  3978      PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3979
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL635.cbl
  3980      GO TO 1011-CHECK-FOR-A.
  3981
  3982 1011-VERIFY-COMP-G.
  3983
  3984     MOVE LOW-VALUES             TO  COMP-ACCOUNT.
  3985     MOVE 'G'                    TO  COMP-RECORD-TYPE.
  3986
  3987
  3988* EXEC CICS HANDLE CONDITION
  3989*        NOTFND   (1011-NO-COMP-G)
  3990*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3991*        END-EXEC.
  3992*    MOVE '"$IJ                  ! ( #00003793' TO DFHEIV0
  3993     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3994     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3995     MOVE X'2820233030303033373933' TO DFHEIV0(25:11)
  3996     CALL 'kxdfhei1' USING DFHEIV0
  3997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3998
  3999
  4000
  4001* EXEC CICS READ
  4002*        DATASET  (COMP-FILE-ID)
  4003*        SET      (ADDRESS OF COMPENSATION-MASTER)
  4004*        RIDFLD   (ERCOMP-KEY)
  4005*        EQUAL
  4006*        END-EXEC.
  4007*    MOVE '&"S        E          (   #00003798' TO DFHEIV0
  4008     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4009     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4010     MOVE X'2020233030303033373938' TO DFHEIV0(25:11)
  4011     CALL 'kxdfhei1' USING DFHEIV0,
  4012           COMP-FILE-ID,
  4013           DFHEIV20,
  4014           DFHEIV99,
  4015           ERCOMP-KEY,
  4016           DFHEIV99,
  4017           DFHEIV99,
  4018           DFHEIV99
  4019     SET ADDRESS OF COMPENSATION-MASTER TO
  4020         DFHEIV20
  4021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4022
  4023
  4024      GO TO 1012-CHK-VOID.
  4025
  4026 1011-NO-COMP-G.
  4027
  4028      MOVE ER-3260               TO  EMI-ERROR.
  4029      MOVE -1                    TO  CARRIERL.
  4030      MOVE AL-UABON              TO  CARRIERA
  4031                                     GROUPA
  4032                                     FINRESPA.
  4033
  4034      PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4035
  4036 1012-CHK-VOID.
  4037
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL635.cbl
  4038     IF EIBAID = DFHPF8
  4039         GO TO 1025-CHECK-INVOICE.
  4040
  4041     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  4042         IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  4043           AND (PI-REC-TYPE (NDX) = 'C')
  4044             IF VOID-SW (PINDX) = 'V'
  4045                 MOVE AL-UANON   TO  VOID-SW-ATTRB (PINDX)
  4046             ELSE
  4047                 MOVE ER-2246    TO  EMI-ERROR
  4048                 MOVE -1         TO  VOID-SW-LEN (PINDX)
  4049                 MOVE AL-UABON   TO  VOID-SW-ATTRB (PINDX)
  4050                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4051         ELSE
  4052             MOVE ER-2449        TO  EMI-ERROR
  4053             MOVE -1             TO  VOID-SW-LEN (PINDX)
  4054             MOVE AL-UABON       TO  VOID-SW-ATTRB (PINDX)
  4055             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4056
  4057     IF SDTE-LEN (PINDX) = ZEROS
  4058         GO TO 1016-CHECK-INPUT-DATE.
  4059
  4060     MOVE AL-UNNON               TO  SDTE-ATTRB (PINDX).
  4061
  4062     IF SDTE (PINDX) NOT NUMERIC OR
  4063        SDTE (PINDX) EQUAL ZEROS
  4064        GO TO 1015-DAY-ERROR.
  4065
  4066     MOVE SDTE (PINDX)           TO  DC-GREG-DATE-1-MDY.
  4067     MOVE '4'                    TO  DC-OPTION-CODE.
  4068     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  4069
  4070     IF NO-CONVERSION-ERROR
  4071        SET PINDEX               TO  PINDX
  4072        MOVE DC-BIN-DATE-1       TO  WS-EOM-DT (PINDEX)
  4073     ELSE
  4074        GO TO 1015-DAY-ERROR.
  4075
  4076     MOVE SDTE (PINDX)           TO DATE-TEST-AREA.
  4077
  4078     IF DATE-TEST-MM = 4 OR  6  OR  9  OR  11
  4079         IF DATE-TEST-DD  NOT = 30
  4080             GO TO 1015-DAY-ERROR
  4081         ELSE
  4082             GO TO 1012-CHECK-FUTURE-MO.
  4083
  4084     IF DATE-TEST-MM = 1 OR  3  OR  5  OR  7  OR
  4085                             8  OR  10  OR  12
  4086         IF DATE-TEST-DD  NOT = 31
  4087             GO TO 1015-DAY-ERROR
  4088         ELSE
  4089             GO TO 1012-CHECK-FUTURE-MO.
  4090
  4091     DIVIDE DATE-TEST-YY  BY  4  GIVING  DIVIDE-RESULT
  4092         REMAINDER  DIVIDE-REMAINDER.
  4093
  4094     IF DATE-TEST-YY = ZERO
  4095         IF DATE-TEST-DD = 29
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL635.cbl
  4096             GO TO 1012-CHECK-FUTURE-MO
  4097         ELSE
  4098             GO TO 1015-DAY-ERROR.
  4099
  4100     IF DIVIDE-REMAINDER NOT = ZERO
  4101         IF DATE-TEST-DD  NOT = 28
  4102             GO TO 1015-DAY-ERROR
  4103         ELSE
  4104             GO TO 1012-CHECK-FUTURE-MO
  4105     ELSE
  4106         IF DATE-TEST-DD = 29
  4107             GO TO 1012-CHECK-FUTURE-MO
  4108         ELSE
  4109             GO TO 1015-DAY-ERROR.
  4110
  4111 1012-CHECK-FUTURE-MO.
  4112
  4113     IF WS-EOM-DT (PINDEX) NOT GREATER THAN PI-CR-MONTH-END-DT
  4114         GO TO 1016-CHECK-INPUT-DATE.
  4115
  4116     MOVE PI-CR-MONTH-END-DT     TO  DC-BIN-DATE-1.
  4117     MOVE WS-EOM-DT (PINDEX)     TO  DC-BIN-DATE-2.
  4118     MOVE '1'                    TO  DC-OPTION-CODE.
  4119     PERFORM 8500-DATE-CONVERT  THRU 8500-EXIT.
  4120
  4121     IF DATE-CONVERSION-ERROR
  4122        GO TO 1015-DAY-ERROR.
  4123
  4124     IF DC-ELAPSED-MONTHS  GREATER THAN  +2
  4125        MOVE -1                  TO  SDTE-LEN (PINDX)
  4126        MOVE AL-UNBON            TO  SDTE-ATTRB (PINDX)
  4127        MOVE ER-0761             TO  EMI-ERROR
  4128        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4129
  4130     GO TO 1016-CHECK-INPUT-DATE.
  4131
  4132 1015-DAY-ERROR.
  4133     MOVE -1                     TO  SDTE-LEN (PINDX).
  4134     MOVE AL-UNBON               TO  SDTE-ATTRB (PINDX).
  4135     MOVE ER-0587                TO  EMI-ERROR.
  4136
  4137     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4138
  4139 1016-CHECK-INPUT-DATE.
  4140
  4141     IF IDTE-LEN (PINDX)  =  ZEROS
  4142         GO TO 1020-CHECK-INVOICE.
  4143
  4144     MOVE AL-UNNON               TO  IDTE-ATTRB (PINDX).
  4145
  4146     IF IDTE (PINDX) NOT NUMERIC OR
  4147        IDTE (PINDX) EQUAL ZEROS
  4148         GO TO 1017-DAY-ERROR.
  4149
  4150     MOVE IDTE (PINDX)           TO  DC-GREG-DATE-1-MDY.
  4151     MOVE '4'                    TO  DC-OPTION-CODE.
  4152
  4153     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL635.cbl
  4154
  4155     IF NO-CONVERSION-ERROR
  4156         SET DINDEX              TO  PINDX
  4157         MOVE DC-BIN-DATE-1      TO  WS-INP-DT (DINDEX)
  4158         GO TO 1020-CHECK-INVOICE.
  4159
  4160 1017-DAY-ERROR.
  4161     MOVE -1                     TO  IDTE-LEN (PINDX).
  4162     MOVE AL-UNBON               TO  IDTE-ATTRB (PINDX).
  4163     MOVE ER-0714                TO  EMI-ERROR.
  4164
  4165     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4166
  4167 1020-CHECK-INVOICE.
  4168
  4169     IF MORTGAGE-SESSION
  4170        IF AMT-LEN (PINDX) NOT = ZEROS
  4171           IF PI-FILE-SEQ-NO (NDX) = ZEROS
  4172              IF RTYPE (PINDX) = 'R'
  4173                 IF INVOICE-LEN (PINDX) = ZEROS
  4174                    MOVE -1            TO INVOICE-LEN (PINDX)
  4175                    MOVE ER-3175       TO EMI-ERROR
  4176                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4177                    GO TO 1050-INCREMENT-PINDX
  4178                 ELSE
  4179                    PERFORM 6500-VERIFY-RECON-HEADER THRU
  4180                                                     6590-EXIT.
  4181     IF (INVOICE (PINDX) = SPACES OR LOW-VALUES)
  4182         GO TO 1050-INCREMENT-PINDX.
  4183
  4184     IF WS-ACCEPT-1 (W-INDX) = 'A'
  4185         GO TO 1050-INCREMENT-PINDX.
  4186
  4187     IF EIBAID = DFHPF5
  4188         MOVE 'A'                TO WS-ACCEPT-1 (W-INDX)
  4189         MOVE 'Y'                TO WS-PREV-PF5
  4190         MOVE DFHENTER           TO EIBAID
  4191         GO TO 1050-INCREMENT-PINDX.
  4192
  4193 1025-CHECK-INVOICE.
  4194
  4195     MOVE PI-COMPANY-CD          TO RECV-COMP-CD.
  4196     MOVE '1'                    TO RECV-TYPE.
  4197     MOVE CARRIERI               TO RECV-CARRIER.
  4198     MOVE GROUPI                 TO RECV-GROUPING.
  4199     MOVE CO-AR-BAL-LEVEL        TO RECV-BAL-LVL.
  4200     MOVE FINRESPI               TO RECV-FIN-RESP.
  4201     MOVE ACCTI                  TO RECV-ACCOUNT.
  4202
  4203     IF EIBAID = DFHPF8
  4204         MOVE PI-INVOICE (NDX)   TO RECV-INVOICE
  4205         MOVE PI-REFERENCE (NDX) TO RECV-REFERENCE
  4206         IF PI-APPLIED (NDX) = 'A'
  4207             MOVE '1'            TO RECV-ENTRY-TYPE
  4208             MOVE 'A'            TO RECV-RESPONSIBLE
  4209         ELSE
  4210             MOVE LOW-VALUES     TO RECV-RESPONSIBLE
  4211             IF PI-APPLIED (NDX) = 'G'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL635.cbl
  4212                 MOVE '2'        TO RECV-ENTRY-TYPE
  4213             ELSE
  4214                 MOVE '3'        TO RECV-ENTRY-TYPE
  4215     ELSE
  4216         MOVE INVOICE (PINDX)    TO RECV-INVOICE
  4217         MOVE REF (PINDX)        TO RECV-REFERENCE
  4218         IF APPLIED (PINDX) = 'A'
  4219             MOVE '1'            TO RECV-ENTRY-TYPE
  4220             MOVE 'A'            TO RECV-RESPONSIBLE
  4221         ELSE
  4222             MOVE LOW-VALUES     TO RECV-RESPONSIBLE
  4223             IF APPLIED (PINDX) = 'G'
  4224                 MOVE '2'        TO RECV-ENTRY-TYPE
  4225             ELSE
  4226                 MOVE '3'        TO RECV-ENTRY-TYPE.
  4227
  4228
  4229     MOVE ZERO                   TO RECV-RECORD-TYPE.
  4230     MOVE +0                     TO RECV-RECORD-SEQ.
  4231
  4232     INSPECT ERRECV-KEY REPLACING ALL SPACES BY LOW-VALUES.
  4233
  4234
  4235* EXEC CICS HANDLE CONDITION
  4236*        NOTFND   (1040-RECV-NOTFND)
  4237*        NOTOPEN  (7200-RECV-FILE-NOTOPEN)
  4238*        END-EXEC.
  4239*    MOVE '"$IJ                  ! ) #00004015' TO DFHEIV0
  4240     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  4241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4242     MOVE X'2920233030303034303135' TO DFHEIV0(25:11)
  4243     CALL 'kxdfhei1' USING DFHEIV0
  4244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4245
  4246
  4247
  4248* EXEC CICS READ
  4249*        DATASET  (RECV-FILE-ID)
  4250*        SET      (ADDRESS OF ACCOUNTS-RECEIVABLE)
  4251*        RIDFLD   (ERRECV-KEY)
  4252*        EQUAL
  4253*    END-EXEC.
  4254*    MOVE '&"S        E          (   #00004020' TO DFHEIV0
  4255     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4256     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4257     MOVE X'2020233030303034303230' TO DFHEIV0(25:11)
  4258     CALL 'kxdfhei1' USING DFHEIV0,
  4259           RECV-FILE-ID,
  4260           DFHEIV20,
  4261           DFHEIV99,
  4262           ERRECV-KEY,
  4263           DFHEIV99,
  4264           DFHEIV99,
  4265           DFHEIV99
  4266     SET ADDRESS OF ACCOUNTS-RECEIVABLE TO
  4267         DFHEIV20
  4268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4269
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL635.cbl
  4270
  4271     IF AR-BAL-DEBIT
  4272         MOVE AR-BAL-AMOUNT      TO WS-AR-BALANCE
  4273     ELSE
  4274         COMPUTE WS-AR-BALANCE = AR-BAL-AMOUNT * -1.
  4275
  4276     IF EIBAID = DFHPF8
  4277         MOVE PI-AMOUNT (NDX)    TO WS-WORK-BALANCE
  4278         IF PI-REC-TYPE (NDX) = 'C' OR 'U'
  4279             COMPUTE WS-WORK-BALANCE = WS-WORK-BALANCE * -1
  4280         ELSE
  4281             NEXT SENTENCE
  4282     ELSE
  4283         IF AMT (PINDX) NUMERIC
  4284             MOVE AMT (PINDX)    TO WS-WORK-BALANCE
  4285             IF RTYPE (PINDX) = 'C' OR 'U'
  4286                 COMPUTE WS-WORK-BALANCE = WS-WORK-BALANCE * -1
  4287             ELSE
  4288                 NEXT SENTENCE
  4289         ELSE
  4290             GO TO 1050-INCREMENT-PINDX.
  4291
  4292     COMPUTE WS-BAL-AMOUNT = WS-AR-BALANCE - WS-WORK-BALANCE.
  4293
  4294     IF EIBAID = DFHPF8
  4295         IF WS-BAL-AMOUNT NOT = ZERO
  4296             MOVE AR-BAL-AMOUNT  TO WS-EDIT-PATTERN
  4297             MOVE WS-EDIT        TO WS-EDIT-AMOUNT
  4298             MOVE ER-3263        TO EMI-ERROR
  4299             MOVE -1             TO COMM-LEN (PINDX)
  4300             MOVE AL-UABON       TO COMM-ATTRB (PINDX)
  4301             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4302             SET PINDX UP  BY 3
  4303             IF AR-BAL-CREDIT
  4304                 MOVE '-'        TO  WS-EDIT-SIGN
  4305                 MOVE WS-EDITED-AMOUNT
  4306                                 TO EMI-TEXT-VARIABLE (1)
  4307                 GO TO 1050-INCREMENT-PINDX
  4308             ELSE
  4309                 MOVE ' '        TO  WS-EDIT-SIGN
  4310                 MOVE WS-EDITED-AMOUNT
  4311                                 TO EMI-TEXT-VARIABLE (1)
  4312                 GO TO 1050-INCREMENT-PINDX
  4313         ELSE
  4314             MOVE ER-3265        TO EMI-ERROR
  4315             MOVE -1             TO COMM-LEN (PINDX)
  4316             MOVE AL-UABON       TO COMM-ATTRB (PINDX)
  4317             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4318             SET PINDX UP  BY 3
  4319             GO TO 1050-INCREMENT-PINDX.
  4320
  4321     IF WS-BAL-AMOUNT NOT = ZERO
  4322         MOVE AR-BAL-AMOUNT      TO WS-EDIT-PATTERN
  4323         MOVE WS-EDIT            TO WS-EDIT-AMOUNT
  4324         MOVE ER-3266            TO EMI-ERROR
  4325         MOVE -1                 TO INVOICE-LEN (PINDX)
  4326         MOVE AL-UABON           TO INVOICE-ATTRB (PINDX)
  4327         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL635.cbl
  4328         IF AR-BAL-CREDIT
  4329             MOVE '-'            TO  WS-EDIT-SIGN
  4330             IF EMI-ERROR-NUMBER (1) = '3266'
  4331                 MOVE WS-EDITED-AMOUNT
  4332                                 TO EMI-TEXT-VARIABLE (1)
  4333                 GO TO 1050-INCREMENT-PINDX
  4334             ELSE
  4335                 MOVE WS-EDITED-AMOUNT
  4336                                 TO EMI-TEXT-VARIABLE (2)
  4337                 GO TO 1050-INCREMENT-PINDX
  4338         ELSE
  4339             IF EMI-ERROR-NUMBER (1) = '3266'
  4340                 MOVE WS-EDITED-AMOUNT
  4341                                 TO EMI-TEXT-VARIABLE (1)
  4342                 GO TO 1050-INCREMENT-PINDX
  4343             ELSE
  4344                 MOVE ' '            TO  WS-EDIT-SIGN
  4345                 MOVE WS-EDITED-AMOUNT
  4346                                 TO EMI-TEXT-VARIABLE (2)
  4347                 GO TO 1050-INCREMENT-PINDX
  4348     ELSE
  4349         GO TO 1050-INCREMENT-PINDX.
  4350
  4351 1040-RECV-NOTFND.
  4352
  4353     IF EIBAID = DFHPF8
  4354         MOVE ER-3264            TO EMI-ERROR
  4355         MOVE -1                 TO COMM-LEN (PINDX)
  4356         MOVE AL-UABON           TO COMM-ATTRB (PINDX)
  4357         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4358         SET PINDX  UP  BY  3
  4359         GO TO 1050-INCREMENT-PINDX.
  4360
  4361     MOVE ER-3180                TO EMI-ERROR.
  4362     MOVE -1                     TO INVOICE-LEN (PINDX).
  4363     MOVE AL-UABON               TO INVOICE-ATTRB (PINDX).
  4364
  4365     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4366
  4367 1050-INCREMENT-PINDX.
  4368     SET PINDX  UP  BY  1.
  4369     SET W-INDX                  TO  PINDX.
  4370     MOVE WS-ACCEPT-TABLE        TO  PI-ACCEPT.
  4371
  4372     IF PINDX  IS NOT GREATER THAN  +3
  4373         GO TO 1010-EDIT-LOOP.
  4374
  4375     IF EMI-ERROR = ZEROS
  4376         NEXT SENTENCE
  4377     ELSE
  4378         MOVE 'S'                TO  PI-PREV-FUNCTION
  4379         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL635.cbl
  4381 2000-UPDATE-THE-FILE.
  4382
  4383     SET PINDX                   TO  ZERO-NDX.
  4384
  4385 2100-UPDATE-LOOP.
  4386
  4387     SET PINDX  UP  BY  1.
  4388     SET NDX                     TO  PINDX.
  4389
  4390     IF PINDX  IS GREATER THAN  +3
  4391         GO TO 2200-UPDATE-COMPLETE.
  4392
  4393     IF COMM-LEN    (PINDX) = ZEROS
  4394       AND RTYPE-LEN   (PINDX) = ZEROS
  4395       AND AMT-LEN     (PINDX) = ZEROS
  4396       AND APPLIED-LEN (PINDX) = ZEROS
  4397       AND VOID-SW-LEN (PINDX) = ZEROS
  4398       AND SDTE-LEN    (PINDX) = ZEROS
  4399       AND REF-LEN     (PINDX) = ZEROS
  4400       AND INVOICE-LEN (PINDX) = ZEROS
  4401       AND IDTE-LEN    (PINDX) = ZEROS
  4402       AND CREDIT-LEN  (PINDX) = ZEROS
  4403       AND DEBIT-LEN   (PINDX) = ZEROS
  4404         GO TO 2100-UPDATE-LOOP.
  4405
  4406     IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  4407         NEXT SENTENCE
  4408     ELSE
  4409         GO TO 2110-ADD-RECORD.
  4410
  4411
  4412* EXEC CICS HANDLE CONDITION
  4413*        NOTFND  (2110-ADD-RECORD)
  4414*    END-EXEC.
  4415*    MOVE '"$I                   ! * #00004167' TO DFHEIV0
  4416     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4417     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4418     MOVE X'2A20233030303034313637' TO DFHEIV0(25:11)
  4419     CALL 'kxdfhei1' USING DFHEIV0
  4420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4421
  4422
  4423     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4424     MOVE PI-FILE-SEQ-NO (NDX)    TO  PYAJ-FILE-SEQ-NO.
  4425     MOVE PI-REC-TYPE (NDX)       TO  PYAJ-RECORD-TYPE.
  4426
  4427     IF MORTGAGE-SESSION
  4428        MOVE MPPYAJ-FILE-ID       TO PYAJ-FILE-ID.
  4429
  4430
  4431* EXEC CICS READ
  4432*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4433*        DATASET  (PYAJ-FILE-ID)
  4434*        RIDFLD   (ERPYAJ-KEY)
  4435*        UPDATE
  4436*    END-EXEC.
  4437*    MOVE '&"S        EU         (   #00004178' TO DFHEIV0
  4438     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL635.cbl
  4439     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4440     MOVE X'2020233030303034313738' TO DFHEIV0(25:11)
  4441     CALL 'kxdfhei1' USING DFHEIV0,
  4442           PYAJ-FILE-ID,
  4443           DFHEIV20,
  4444           DFHEIV99,
  4445           ERPYAJ-KEY,
  4446           DFHEIV99,
  4447           DFHEIV99,
  4448           DFHEIV99
  4449     SET ADDRESS OF PENDING-PAY-ADJ TO
  4450         DFHEIV20
  4451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4452
  4453
  4454     IF RTYPE-LEN (PINDX) GREATER THAN +0
  4455        IF RTYPE (PINDX) NOT = PY-RECORD-TYPE
  4456           PERFORM 2190-CHANGE-RECORD-TYPE THRU 2190-EXIT.
  4457
  4458     IF AMT-LEN (PINDX) NOT = ZEROS
  4459        SET WS-INDX                 TO PINDX
  4460         IF WS-EDITED-AMT (WS-INDX)  = ZEROS
  4461             IF  (PY-CHECK-WRITTEN-DT = LOW-VALUES) AND
  4462                 (PY-CHECK-ORIGIN-SW NOT = 'V')
  4463                 GO TO 2120-DELETE-RECORD
  4464             ELSE
  4465                 IF PI-PROCESSOR-ID = 'LGXX'
  4466                     GO TO 2120-DELETE-RECORD
  4467             ELSE
  4468                     MOVE ER-2244   TO  EMI-ERROR
  4469                     MOVE -1        TO  AMT-LEN (PINDX)
  4470                     MOVE AL-UNBON  TO  AMT-ATTRB (PINDX)
  4471                     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4472                     MOVE PY-ENTRY-AMT
  4473                                    TO  AMTO (PINDX)
  4474
  4475* EXEC CICS UNLOCK
  4476*                    DATASET  (PYAJ-FILE-ID)
  4477*                    END-EXEC
  4478*    MOVE '&*                    #   #00004205' TO DFHEIV0
  4479     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4480     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4481     MOVE X'2020233030303034323035' TO DFHEIV0(25:11)
  4482     CALL 'kxdfhei1' USING DFHEIV0,
  4483           PYAJ-FILE-ID,
  4484           DFHEIV99
  4485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4486                     GO TO 8200-SEND-DATAONLY.
  4487
  4488     MOVE 'B'                    TO  JP-RECORD-TYPE.
  4489     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4490     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4491
  4492     PERFORM 8400-LOG-JOURNAL-RECORD.
  4493
  4494     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4495     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4496     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL635.cbl
  4497
  4498     IF COMM-LEN (PINDX) NOT = ZEROS
  4499         MOVE COMM (PINDX)       TO  PY-ENTRY-COMMENT.
  4500
  4501     IF AMT-LEN (PINDX) NOT = ZEROS
  4502         SET WS-INDX             TO  PINDX
  4503         MOVE PY-ENTRY-AMT       TO  WS-OLD-ENTRY-AMT
  4504         MOVE WS-EDITED-AMT (WS-INDX)  TO  PY-ENTRY-AMT
  4505                                           WS-ENTRY-AMT.
  4506
  4507     IF APPLIED-LEN (PINDX) NOT = ZERO
  4508         MOVE APPLIED (PINDX)    TO  PY-PMT-APPLIED.
  4509
  4510     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  4511         MOVE VOID-SW (PINDX)    TO  PY-VOID-SW.
  4512
  4513     IF SDTE-LEN (PINDX) NOT = ZEROS
  4514        SET PINDEX               TO  PINDX
  4515        MOVE WS-EOM-DT (PINDEX)  TO  PY-CREDIT-SELECT-DT.
  4516
  4517     IF REF-LEN  (PINDX) NOT = ZEROS
  4518        MOVE REF (PINDX)         TO  PY-REF-NO.
  4519
  4520     IF INVOICE-LEN   (PINDX) NOT = ZEROS
  4521        MOVE INVOICE  (PINDX)    TO  PY-BIL-INV.
  4522
  4523     IF IDTE-LEN (PINDX)  NOT =  ZEROS
  4524         SET DINDEX              TO  PINDX
  4525         MOVE WS-INP-DT (DINDEX)
  4526                                 TO  PY-INPUT-DT.
  4527
  4528     IF CREDIT-LEN    (PINDX) NOT = ZEROS
  4529        MOVE CREDIT   (PINDX)    TO  PY-GL-CR.
  4530
  4531     IF DEBIT-LEN     (PINDX) NOT = ZEROS
  4532        MOVE DEBIT    (PINDX)    TO  PY-GL-DB.
  4533
  4534     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4535     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4536     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4537
  4538     IF MORTGAGE-SESSION
  4539        MOVE 'U'                 TO  WS-RECON-SW
  4540        PERFORM 6600-UPDATE-RECON-HEADER THRU 6690-EXIT.
  4541
  4542
  4543* EXEC CICS REWRITE
  4544*        DATASET  (PYAJ-FILE-ID)
  4545*        FROM     (PENDING-PAY-ADJ)
  4546*    END-EXEC.
  4547     MOVE LENGTH OF
  4548      PENDING-PAY-ADJ
  4549       TO DFHEIV11
  4550*    MOVE '&& L                  %   #00004264' TO DFHEIV0
  4551     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4552     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4553     MOVE X'2020233030303034323634' TO DFHEIV0(25:11)
  4554     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL635.cbl
  4555           PYAJ-FILE-ID,
  4556           PENDING-PAY-ADJ,
  4557           DFHEIV11,
  4558           DFHEIV99
  4559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4560
  4561
  4562     PERFORM 8400-LOG-JOURNAL-RECORD.
  4563
  4564     GO TO 2100-UPDATE-LOOP.
  4565
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL635.cbl
  4567
  4568 2110-ADD-RECORD.
  4569
  4570* EXEC CICS GETMAIN
  4571*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4572*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4573*        INITIMG  (GETMAIN-SPACE)
  4574*    END-EXEC.
  4575*    MOVE ',"IL                  $   #00004276' TO DFHEIV0
  4576     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4577     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4578     MOVE X'2020233030303034323736' TO DFHEIV0(25:11)
  4579     CALL 'kxdfhei1' USING DFHEIV0,
  4580           DFHEIV20,
  4581           ERPYAJ-RECORD-LENGTH,
  4582           GETMAIN-SPACE
  4583     SET ADDRESS OF PENDING-PAY-ADJ TO
  4584         DFHEIV20
  4585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4586
  4587
  4588     MOVE 'PY'                   TO  PY-RECORD-ID.
  4589     MOVE PI-COMPANY-CD          TO  PY-COMPANY-CD.
  4590     MOVE PI-SAV-CARRIER         TO  PY-CARRIER.
  4591     MOVE PI-SAV-GROUPING        TO  PY-GROUPING.
  4592     MOVE PI-SAV-FIN-RESP        TO  PY-FIN-RESP.
  4593     MOVE PI-SAV-ACCOUNT         TO  PY-ACCOUNT.
  4594     MOVE RTYPE (PINDX)          TO  PY-RECORD-TYPE.
  4595     MOVE WORK-SEQ-NO            TO  PY-FILE-SEQ-NO.
  4596
  4597     ADD +1                      TO  WORK-SEQ-NO.
  4598
  4599     IF COMM-LEN (PINDX) NOT = ZEROS
  4600         MOVE COMM (PINDX)       TO  PY-ENTRY-COMMENT.
  4601
  4602
  4603* EXEC CICS BIF DEEDIT
  4604*        FIELD (AMT (PINDX))
  4605*        LENGTH (11)
  4606*    END-EXEC.
  4607     MOVE 11
  4608       TO DFHEIV11
  4609*    MOVE '@"L                   #   #00004296' TO DFHEIV0
  4610     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4611     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4612     MOVE X'2020233030303034323936' TO DFHEIV0(25:11)
  4613     CALL 'kxdfhei1' USING DFHEIV0,
  4614           AMT(PINDX),
  4615           DFHEIV11
  4616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4617
  4618
  4619     MOVE AMT (PINDX)            TO  PY-ENTRY-AMT
  4620                                     WS-ENTRY-AMT.
  4621
  4622     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4623     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4624     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL635.cbl
  4625     MOVE ZEROS                  TO  PY-CHECK-QUE-CONTROL
  4626                                     PY-CHECK-QUE-SEQUENCE.
  4627     MOVE LOW-VALUES             TO  PY-CREDIT-ACCEPT-DT
  4628                                     PY-BILLED-DATE
  4629                                     PY-AR-DATE
  4630                                     PY-GL-DATE
  4631                                     PY-REPORTED-DT
  4632                                     PY-CHECK-WRITTEN-DT.
  4633
  4634     IF SDTE (PINDX)  IS NUMERIC
  4635         MOVE SDTE (PINDX)       TO  DC-GREG-DATE-1-MDY
  4636         MOVE '4'                TO  DC-OPTION-CODE
  4637         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  4638         IF DATE-CONVERSION-ERROR
  4639             IF MORTGAGE-SESSION
  4640                 MOVE PI-MP-MONTH-END-DT
  4641                                 TO  PY-CREDIT-SELECT-DT
  4642             ELSE
  4643                 MOVE PI-CR-MONTH-END-DT
  4644                                 TO  PY-CREDIT-SELECT-DT
  4645         ELSE
  4646             MOVE DC-BIN-DATE-1  TO  PY-CREDIT-SELECT-DT
  4647     ELSE
  4648         IF MORTGAGE-SESSION
  4649             MOVE PI-MP-MONTH-END-DT
  4650                                 TO  PY-CREDIT-SELECT-DT
  4651         ELSE
  4652             MOVE PI-CR-MONTH-END-DT
  4653                                 TO  PY-CREDIT-SELECT-DT.
  4654
  4655     IF REF-LEN  (PINDX) NOT = ZEROS
  4656        MOVE REF (PINDX)         TO  PY-REF-NO.
  4657
  4658     IF INVOICE-LEN   (PINDX) NOT = ZEROS
  4659        MOVE INVOICE  (PINDX)    TO  PY-BIL-INV.
  4660
  4661     IF IDTE (PINDX)  IS NUMERIC
  4662         MOVE IDTE (PINDX)       TO  DC-GREG-DATE-1-MDY
  4663         MOVE '4'                TO  DC-OPTION-CODE
  4664         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  4665         IF DATE-CONVERSION-ERROR
  4666             MOVE -1             TO  IDTE-LEN (PINDX)
  4667             MOVE AL-UNBON       TO  IDTE-ATTRB (PINDX)
  4668             MOVE ER-0714        TO  EMI-ERROR
  4669             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4670         ELSE
  4671             MOVE DC-BIN-DATE-1  TO  PY-INPUT-DT
  4672     ELSE
  4673         MOVE WS-CURRENT-BIN-DT  TO  PY-INPUT-DT.
  4674
  4675     IF CREDIT-LEN    (PINDX) NOT = ZEROS
  4676        MOVE CREDIT   (PINDX)    TO  PY-GL-CR.
  4677
  4678     IF DEBIT-LEN     (PINDX) NOT = ZEROS
  4679        MOVE DEBIT    (PINDX)    TO  PY-GL-DB.
  4680
  4681     MOVE APPLIED (PINDX)        TO  PY-PMT-APPLIED.
  4682
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL635.cbl
  4683 2115-WRITE-REC.
  4684
  4685
  4686* EXEC CICS HANDLE CONDITION
  4687*        DUPREC  (2115-DUP-RECORD)
  4688*    END-EXEC.
  4689*    MOVE '"$%                   ! + #00004367' TO DFHEIV0
  4690     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  4691     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4692     MOVE X'2B20233030303034333637' TO DFHEIV0(25:11)
  4693     CALL 'kxdfhei1' USING DFHEIV0
  4694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4695
  4696
  4697     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4698     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4699     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4700
  4701     IF MORTGAGE-SESSION
  4702        MOVE 'A'                 TO WS-RECON-SW
  4703        PERFORM 6600-UPDATE-RECON-HEADER THRU 6690-EXIT.
  4704
  4705 2115-RETRY-WRITE.
  4706
  4707
  4708* EXEC CICS WRITE
  4709*        DATASET  (PYAJ-FILE-ID)
  4710*        FROM     (PENDING-PAY-ADJ)
  4711*        RIDFLD   (PY-CONTROL-PRIMARY)
  4712*    END-EXEC.
  4713     MOVE LENGTH OF
  4714      PENDING-PAY-ADJ
  4715       TO DFHEIV11
  4716*    MOVE '&$ L                  ''   #00004381' TO DFHEIV0
  4717     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4718     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4719     MOVE X'2020233030303034333831' TO DFHEIV0(25:11)
  4720     CALL 'kxdfhei1' USING DFHEIV0,
  4721           PYAJ-FILE-ID,
  4722           PENDING-PAY-ADJ,
  4723           DFHEIV11,
  4724           PY-CONTROL-PRIMARY,
  4725           DFHEIV99,
  4726           DFHEIV99
  4727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4728
  4729
  4730     PERFORM 8400-LOG-JOURNAL-RECORD.
  4731
  4732     GO TO 2100-UPDATE-LOOP.
  4733
  4734 2115-DUP-RECORD.
  4735
  4736     COMPUTE PY-FILE-SEQ-NO = PY-FILE-SEQ-NO + 1.
  4737
  4738     GO TO 2115-RETRY-WRITE.
  4739
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL635.cbl
  4741
  4742 2120-DELETE-RECORD.
  4743     IF PY-RECORD-TYPE NOT = 'C' AND 'U'
  4744         GO TO 2120-DELETE-CONT.
  4745
  4746     IF PY-CHECK-QUE-CONTROL = ZEROS
  4747       AND PY-CHECK-QUE-SEQUENCE = ZEROS
  4748         GO TO 2120-DELETE-CONT.
  4749
  4750
  4751* EXEC CICS HANDLE CONDITION
  4752*        NOTFND  (2120-DELETE-CONT)
  4753*    END-EXEC.
  4754*    MOVE '"$I                   ! , #00004407' TO DFHEIV0
  4755     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4756     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4757     MOVE X'2C20233030303034343037' TO DFHEIV0(25:11)
  4758     CALL 'kxdfhei1' USING DFHEIV0
  4759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4760
  4761
  4762     MOVE PY-COMPANY-CD          TO  CHKQ-COMPANY-CD.
  4763     MOVE PY-CHECK-QUE-CONTROL   TO  CHKQ-CONTROL-NUMBER.
  4764     MOVE PY-CHECK-QUE-SEQUENCE  TO  CHKQ-SEQUENCE-NUMBER.
  4765
  4766
  4767* EXEC CICS READ
  4768*        SET      (ADDRESS OF CHECK-QUE)
  4769*        DATASET  (CHKQ-FILE-ID)
  4770*        RIDFLD   (ERCHKQ-KEY)
  4771*        UPDATE
  4772*    END-EXEC.
  4773*    MOVE '&"S        EU         (   #00004415' TO DFHEIV0
  4774     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4775     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4776     MOVE X'2020233030303034343135' TO DFHEIV0(25:11)
  4777     CALL 'kxdfhei1' USING DFHEIV0,
  4778           CHKQ-FILE-ID,
  4779           DFHEIV20,
  4780           DFHEIV99,
  4781           ERCHKQ-KEY,
  4782           DFHEIV99,
  4783           DFHEIV99,
  4784           DFHEIV99
  4785     SET ADDRESS OF CHECK-QUE TO
  4786         DFHEIV20
  4787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4788
  4789
  4790     MOVE 'D'                    TO  JP-RECORD-TYPE.
  4791     MOVE CHKQ-FILE-ID           TO  JP-FILE-ID.
  4792     MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  4793
  4794     PERFORM 8400-LOG-JOURNAL-RECORD.
  4795
  4796
  4797* EXEC CICS DELETE
  4798*        DATASET  (CHKQ-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL635.cbl
  4799*    END-EXEC.
  4800*    MOVE '&(                    &   #00004428' TO DFHEIV0
  4801     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4802     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4803     MOVE X'2020233030303034343238' TO DFHEIV0(25:11)
  4804     CALL 'kxdfhei1' USING DFHEIV0,
  4805           CHKQ-FILE-ID,
  4806           DFHEIV99,
  4807           DFHEIV99,
  4808           DFHEIV99,
  4809           DFHEIV99
  4810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4811
  4812
  4813 2120-DELETE-CONT.
  4814     MOVE 'D'                    TO  JP-RECORD-TYPE.
  4815     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4816     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4817
  4818     PERFORM 8400-LOG-JOURNAL-RECORD.
  4819
  4820     MOVE PY-ENTRY-AMT           TO WS-ENTRY-AMT.
  4821
  4822     IF MORTGAGE-SESSION
  4823        MOVE 'D'                 TO WS-RECON-SW
  4824        PERFORM 6600-UPDATE-RECON-HEADER THRU 6690-EXIT.
  4825
  4826
  4827* EXEC CICS DELETE
  4828*        DATASET(PYAJ-FILE-ID)
  4829*    END-EXEC.
  4830*    MOVE '&(                    &   #00004445' TO DFHEIV0
  4831     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4832     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4833     MOVE X'2020233030303034343435' TO DFHEIV0(25:11)
  4834     CALL 'kxdfhei1' USING DFHEIV0,
  4835           PYAJ-FILE-ID,
  4836           DFHEIV99,
  4837           DFHEIV99,
  4838           DFHEIV99,
  4839           DFHEIV99
  4840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4841
  4842
  4843     GO TO 2100-UPDATE-LOOP.
  4844
  4845
  4846 2190-CHANGE-RECORD-TYPE.
  4847
  4848     MOVE 'D'                    TO  JP-RECORD-TYPE.
  4849     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4850     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4851
  4852     PERFORM 8400-LOG-JOURNAL-RECORD.
  4853
  4854
  4855* EXEC CICS DELETE
  4856*        DATASET(PYAJ-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL635.cbl
  4857*    END-EXEC.
  4858*    MOVE '&(                    &   #00004460' TO DFHEIV0
  4859     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4860     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4861     MOVE X'2020233030303034343630' TO DFHEIV0(25:11)
  4862     CALL 'kxdfhei1' USING DFHEIV0,
  4863           PYAJ-FILE-ID,
  4864           DFHEIV99,
  4865           DFHEIV99,
  4866           DFHEIV99,
  4867           DFHEIV99
  4868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4869
  4870
  4871
  4872* EXEC CICS GETMAIN
  4873*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4874*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4875*        INITIMG  (GETMAIN-SPACE)
  4876*    END-EXEC.
  4877*    MOVE ',"IL                  $   #00004464' TO DFHEIV0
  4878     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4879     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4880     MOVE X'2020233030303034343634' TO DFHEIV0(25:11)
  4881     CALL 'kxdfhei1' USING DFHEIV0,
  4882           DFHEIV20,
  4883           ERPYAJ-RECORD-LENGTH,
  4884           GETMAIN-SPACE
  4885     SET ADDRESS OF PENDING-PAY-ADJ TO
  4886         DFHEIV20
  4887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4888
  4889
  4890     MOVE JP-RECORD-AREA         TO PENDING-PAY-ADJ.
  4891     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY.
  4892
  4893     MOVE RTYPE (PINDX)          TO PY-RECORD-TYPE
  4894                                    PYAJ-RECORD-TYPE.
  4895
  4896* EXEC CICS HANDLE CONDITION
  4897*        DUPREC  (2190-DUP-RECORD)
  4898*    END-EXEC.
  4899*    MOVE '"$%                   ! - #00004475' TO DFHEIV0
  4900     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  4901     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4902     MOVE X'2D20233030303034343735' TO DFHEIV0(25:11)
  4903     CALL 'kxdfhei1' USING DFHEIV0
  4904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4905
  4906
  4907     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4908     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4909     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4910
  4911
  4912 2190-RETRY-WRITE.
  4913
  4914
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL635.cbl
  4915* EXEC CICS WRITE
  4916*        DATASET  (PYAJ-FILE-ID)
  4917*        FROM     (PENDING-PAY-ADJ)
  4918*        RIDFLD   (PY-CONTROL-PRIMARY)
  4919*    END-EXEC.
  4920     MOVE LENGTH OF
  4921      PENDING-PAY-ADJ
  4922       TO DFHEIV11
  4923*    MOVE '&$ L                  ''   #00004486' TO DFHEIV0
  4924     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4925     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4926     MOVE X'2020233030303034343836' TO DFHEIV0(25:11)
  4927     CALL 'kxdfhei1' USING DFHEIV0,
  4928           PYAJ-FILE-ID,
  4929           PENDING-PAY-ADJ,
  4930           DFHEIV11,
  4931           PY-CONTROL-PRIMARY,
  4932           DFHEIV99,
  4933           DFHEIV99
  4934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4935
  4936
  4937     PERFORM 8400-LOG-JOURNAL-RECORD.
  4938
  4939
  4940* EXEC CICS READ
  4941*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4942*        DATASET  (PYAJ-FILE-ID)
  4943*        RIDFLD   (ERPYAJ-KEY)
  4944*        UPDATE
  4945*    END-EXEC.
  4946*    MOVE '&"S        EU         (   #00004494' TO DFHEIV0
  4947     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4948     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4949     MOVE X'2020233030303034343934' TO DFHEIV0(25:11)
  4950     CALL 'kxdfhei1' USING DFHEIV0,
  4951           PYAJ-FILE-ID,
  4952           DFHEIV20,
  4953           DFHEIV99,
  4954           ERPYAJ-KEY,
  4955           DFHEIV99,
  4956           DFHEIV99,
  4957           DFHEIV99
  4958     SET ADDRESS OF PENDING-PAY-ADJ TO
  4959         DFHEIV20
  4960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4961
  4962
  4963     GO TO 2190-EXIT.
  4964
  4965
  4966 2190-DUP-RECORD.
  4967
  4968     COMPUTE PY-FILE-SEQ-NO = PY-FILE-SEQ-NO + 1.
  4969
  4970     GO TO 2190-RETRY-WRITE.
  4971
  4972 2190-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL635.cbl
  4973     EXIT.
  4974
  4975 2200-UPDATE-COMPLETE.
  4976     IF EIBAID = DFHPF1
  4977         GO TO 4000-BROWSE-FRWD.
  4978
  4979     IF EIBAID = DFHPF2
  4980         GO TO 4100-BROWSE-BKWD.
  4981
  4982     MOVE LOW-VALUES             TO  EL635AI.
  4983
  4984     IF WARNING-SW = 'N'
  4985         MOVE ER-0000            TO  EMI-ERROR
  4986     ELSE
  4987         MOVE ER-3172            TO  EMI-ERROR.
  4988
  4989     MOVE -1                     TO  MAINTL.
  4990
  4991     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4992
  4993     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL635.cbl
  4995 4000-BROWSE-FRWD.
  4996
  4997     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4998
  4999     IF EIBAID = DFHPF1
  5000         IF PAGE-FULL
  5001             MOVE PI-FILE-SEQ-NO (3)
  5002                                      TO  PYAJ-FILE-SEQ-NO
  5003             MOVE HIGH-VALUES         TO  PYAJ-RECORD-TYPE
  5004             MOVE 'N'                 TO  PYAJ-READ-SW
  5005             MOVE PI-SAV-ACCT-AMT     TO  TOTAL-ACCT-AMT
  5006             MOVE PI-SAV-ACCT-NET     TO  TOTAL-ACCT-NET
  5007         ELSE
  5008             IF TOP-OF-FILE
  5009                MOVE SPACE            TO  PI-PYAJ-FILE-SW
  5010                MOVE ZEROS            TO  PYAJ-FILE-SEQ-NO
  5011                MOVE SPACES           TO  PYAJ-RECORD-TYPE
  5012             ELSE
  5013                MOVE 99999999         TO  PYAJ-FILE-SEQ-NO
  5014                MOVE HIGH-VALUES      TO  PYAJ-RECORD-TYPE
  5015     ELSE
  5016         MOVE ZEROS                   TO  PYAJ-FILE-SEQ-NO
  5017         MOVE SPACES                  TO  PYAJ-RECORD-TYPE.
  5018
  5019
  5020     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  5021         MOVE PI-CARRIER-SECURITY  TO  PYAJ-CARRIER.
  5022
  5023 4000-BROWSE-FRWD-FOR-PREV.
  5024
  5025
  5026     MOVE SPACE                  TO PI-REC-TYPE (1)
  5027                                    PI-REC-TYPE (2)
  5028                                    PI-REC-TYPE (3).
  5029
  5030     MOVE ZEROS                  TO PI-FILE-SEQ-NO (1)
  5031                                    PI-FILE-SEQ-NO (2)
  5032                                    PI-FILE-SEQ-NO (3)
  5033                                    PI-AMOUNT (1)
  5034                                    PI-AMOUNT (2)
  5035                                    PI-AMOUNT (3).
  5036
  5037     MOVE SPACE                  TO PI-APPLIED (1)
  5038                                    PI-REFERENCE (1)
  5039                                    PI-INVOICE (1)
  5040                                    PI-APPLIED (2)
  5041                                    PI-REFERENCE (2)
  5042                                    PI-INVOICE (2)
  5043                                    PI-APPLIED (3)
  5044                                    PI-REFERENCE (3)
  5045                                    PI-INVOICE (3).
  5046
  5047     IF END-OF-FILE
  5048         IF EIBAID = DFHPF1
  5049            IF PI-TOTAL-DISPLAYED
  5050               NEXT SENTENCE
  5051            ELSE
  5052               MOVE -1                 TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL635.cbl
  5053               MOVE ER-2237            TO  EMI-ERROR
  5054               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5055               MOVE SPACE              TO  PI-PYAJ-FILE-SW
  5056               SET PINDX               TO  +1
  5057               MOVE 'TOTAL'            TO  COMM (PINDX)
  5058               MOVE PI-SAV-ACCT-AMT    TO  AMTO (PINDX)
  5059               MOVE 'NET TOTAL'        TO  REF  (PINDX)
  5060               MOVE PI-SAV-ACCT-NET    TO  NETO (PINDX)
  5061               MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  5062                                        PI-SAV-ACCT-NET
  5063               GO TO 8100-SEND-INITIAL-MAP.
  5064
  5065      IF END-OF-FILE
  5066         IF EIBAID = DFHPF1
  5067            MOVE -1             TO  MAINTL
  5068            MOVE ER-2237        TO  EMI-ERROR
  5069            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5070            GO TO 8200-SEND-DATAONLY.
  5071
  5072     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  5073
  5074     IF NO-RECORDS
  5075        MOVE SPACE              TO  PI-PYAJ-FILE-SW
  5076        MOVE LOW-VALUES         TO  EL635AO
  5077        MOVE ER-2239            TO  EMI-ERROR
  5078        MOVE -1                 TO  MAINTL
  5079        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5080        IF (SENT-FROM-PENDING
  5081            AND PI-PYAJ-REFERENCE GREATER THAN SPACES)
  5082            MOVE PI-PYAJ-REFERENCE TO  REF1O
  5083            MOVE 12                TO  REF1L
  5084            MOVE AL-UANON          TO  REF1A
  5085            MOVE SPACE             TO  EL630-SENT-SW
  5086            MOVE 'Y'               TO  PI-PYAJ-FILLED-SW
  5087            GO TO 8100-SEND-INITIAL-MAP
  5088        ELSE
  5089            GO TO 8100-SEND-INITIAL-MAP.
  5090
  5091     IF NOT-OPEN
  5092         GO TO 7000-PYAJ-FILE-NOTOPEN.
  5093
  5094     MOVE LOW-VALUES             TO  EL635AO.
  5095     MOVE ZEROS                  TO  PI-SEQ-NOS.
  5096
  5097     PERFORM 6000-READ-AND-FORMAT-SCREEN  THRU  6200-EXIT.
  5098
  5099     IF NO-RECORDS
  5100         MOVE SPACE              TO  PI-PYAJ-FILE-SW
  5101         MOVE ER-2239            TO  EMI-ERROR
  5102         MOVE -1                 TO  MAINTL
  5103         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5104         IF (SENT-FROM-PENDING
  5105            AND PI-PYAJ-REFERENCE GREATER THAN SPACES)
  5106            MOVE PI-PYAJ-REFERENCE TO  REF1O
  5107            MOVE 12                TO  REF1L
  5108            MOVE AL-UANON          TO  REF1A
  5109            MOVE SPACE             TO  EL630-SENT-SW
  5110            MOVE 'Y'               TO  PI-PYAJ-FILLED-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL635.cbl
  5111            GO TO 8100-SEND-INITIAL-MAP
  5112         ELSE
  5113             GO TO 8100-SEND-INITIAL-MAP.
  5114
  5115     IF END-OF-FILE
  5116         IF EIBAID = DFHPF2
  5117             MOVE ER-2238        TO  EMI-ERROR
  5118             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5119             MOVE 'T'            TO  PI-PYAJ-FILE-SW
  5120         ELSE
  5121             MOVE ER-2237        TO  EMI-ERROR
  5122             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5123
  5124     MOVE 'S'                    TO  PI-PREV-FUNCTION
  5125                                     PI-SAV-FUNCTION.
  5126
  5127     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL635.cbl
  5129 4100-BROWSE-BKWD.
  5130     MOVE SPACE                   TO  PI-PYAJ-FILE-SW
  5131                                      PI-TOTAL-DISPLAYED-SW.
  5132     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  5133     MOVE ZEROS                   TO  PYAJ-FILE-SEQ-NO.
  5134     MOVE ZEROS                   TO  PYAJ-RECORD-TYPE.
  5135
  5136     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  5137
  5138     IF NO-RECORDS
  5139         MOVE SPACE              TO  PI-PYAJ-FILE-SW
  5140         MOVE LOW-VALUES         TO  EL635AO
  5141         MOVE ER-2239            TO  EMI-ERROR
  5142         MOVE -1                 TO  MAINTL
  5143         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5144         GO TO 8100-SEND-INITIAL-MAP.
  5145
  5146     IF NOT-OPEN
  5147         GO TO 7000-PYAJ-FILE-NOTOPEN.
  5148
  5149
  5150* EXEC CICS READNEXT
  5151*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  5152*        DATASET  (PYAJ-FILE-ID)
  5153*        RIDFLD   (ERPYAJ-KEY)
  5154*    END-EXEC.
  5155     MOVE 0
  5156       TO DFHEIV11
  5157*    MOVE '&.S                   )   #00004687' TO DFHEIV0
  5158     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5159     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5160     MOVE X'2020233030303034363837' TO DFHEIV0(25:11)
  5161     CALL 'kxdfhei1' USING DFHEIV0,
  5162           PYAJ-FILE-ID,
  5163           DFHEIV20,
  5164           DFHEIV99,
  5165           ERPYAJ-KEY,
  5166           DFHEIV99,
  5167           DFHEIV11,
  5168           DFHEIV99,
  5169           DFHEIV99
  5170     SET ADDRESS OF PENDING-PAY-ADJ TO
  5171         DFHEIV20
  5172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5173
  5174
  5175     PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT.
  5176
  5177     PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT.
  5178
  5179     PERFORM 5200-END-BROWSE  THRU  5200-EXIT.
  5180
  5181     MOVE ZEROS                  TO  PYAJ-FILE-SEQ-NO.
  5182     MOVE SPACES                 TO  PYAJ-RECORD-TYPE.
  5183
  5184     GO TO 4000-BROWSE-FRWD-FOR-PREV.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL635.cbl
  5186 5000-START-BROWSE.
  5187
  5188* EXEC CICS HANDLE CONDITION
  5189*        NOTOPEN  (5010-NOT-OPEN)
  5190*        NOTFND   (5020-NO-RECORDS)
  5191*        ENDFILE  (5020-NO-RECORDS)
  5192*    END-EXEC.
  5193*    MOVE '"$JI''                 ! . #00004705' TO DFHEIV0
  5194     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  5195     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5196     MOVE X'2E20233030303034373035' TO DFHEIV0(25:11)
  5197     CALL 'kxdfhei1' USING DFHEIV0
  5198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5199
  5200
  5201
  5202* EXEC CICS STARTBR
  5203*        DATASET  (PYAJ-FILE-ID)
  5204*        RIDFLD   (ERPYAJ-KEY)
  5205*    END-EXEC.
  5206     MOVE 0
  5207       TO DFHEIV11
  5208*    MOVE '&,         G          &   #00004711' TO DFHEIV0
  5209     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5210     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5211     MOVE X'2020233030303034373131' TO DFHEIV0(25:11)
  5212     CALL 'kxdfhei1' USING DFHEIV0,
  5213           PYAJ-FILE-ID,
  5214           ERPYAJ-KEY,
  5215           DFHEIV99,
  5216           DFHEIV11,
  5217           DFHEIV99
  5218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5219
  5220
  5221     GO TO 5030-EXIT.
  5222
  5223 5010-NOT-OPEN.
  5224     MOVE 'Z'                    TO  PI-PYAJ-FILE-SW.
  5225
  5226     GO TO 5030-EXIT.
  5227
  5228 5020-NO-RECORDS.
  5229     MOVE ZEROS                  TO  PI-SEQ-NOS.
  5230     MOVE 'Y'                    TO  PI-PYAJ-FILE-SW.
  5231
  5232 5030-EXIT.
  5233     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL635.cbl
  5235 5100-READ-PREVIOUS.
  5236
  5237* EXEC CICS HANDLE CONDITION
  5238*        ENDFILE  (5110-END-OF-FILE)
  5239*        NOTFND   (5110-END-OF-FILE)
  5240*    END-EXEC.
  5241*    MOVE '"$''I                  ! / #00004731' TO DFHEIV0
  5242     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5243     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5244     MOVE X'2F20233030303034373331' TO DFHEIV0(25:11)
  5245     CALL 'kxdfhei1' USING DFHEIV0
  5246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5247
  5248
  5249
  5250* EXEC CICS READPREV
  5251*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  5252*        DATASET  (PYAJ-FILE-ID)
  5253*        RIDFLD   (ERPYAJ-KEY)
  5254*    END-EXEC.
  5255     MOVE 0
  5256       TO DFHEIV11
  5257*    MOVE '&0S                   )   #00004736' TO DFHEIV0
  5258     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  5259     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5260     MOVE X'2020233030303034373336' TO DFHEIV0(25:11)
  5261     CALL 'kxdfhei1' USING DFHEIV0,
  5262           PYAJ-FILE-ID,
  5263           DFHEIV20,
  5264           DFHEIV99,
  5265           ERPYAJ-KEY,
  5266           DFHEIV99,
  5267           DFHEIV11,
  5268           DFHEIV99,
  5269           DFHEIV99
  5270     SET ADDRESS OF PENDING-PAY-ADJ TO
  5271         DFHEIV20
  5272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5273
  5274
  5275     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  5276         IF PI-CARRIER-SECURITY = PY-CARRIER
  5277             NEXT SENTENCE
  5278         ELSE
  5279             GO TO 5110-END-OF-FILE.
  5280
  5281     GO TO 5120-EXIT.
  5282
  5283 5110-END-OF-FILE.
  5284
  5285     MOVE ER-2238                TO  EMI-ERROR.
  5286     MOVE -1                     TO  PFENTERL.
  5287
  5288     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5289
  5290     GO TO 8200-SEND-DATAONLY.
  5291
  5292 5120-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL635.cbl
  5293     EXIT.
  5294
  5295 5200-END-BROWSE.
  5296
  5297* EXEC CICS ENDBR
  5298*        DATASET  (PYAJ-FILE-ID)
  5299*    END-EXEC.
  5300     MOVE 0
  5301       TO DFHEIV11
  5302*    MOVE '&2                    $   #00004763' TO DFHEIV0
  5303     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5304     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5305     MOVE X'2020233030303034373633' TO DFHEIV0(25:11)
  5306     CALL 'kxdfhei1' USING DFHEIV0,
  5307           PYAJ-FILE-ID,
  5308           DFHEIV11,
  5309           DFHEIV99
  5310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5311
  5312
  5313 5200-EXIT.
  5314     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL635.cbl
  5316 6000-READ-AND-FORMAT-SCREEN.
  5317
  5318* EXEC CICS HANDLE CONDITION
  5319*        ENDFILE  (6100-END-OF-FILE)
  5320*        NOTFND   (6100-END-OF-FILE)
  5321*    END-EXEC.
  5322*    MOVE '"$''I                  ! 0 #00004771' TO DFHEIV0
  5323     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5324     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5325     MOVE X'3020233030303034373731' TO DFHEIV0(25:11)
  5326     CALL 'kxdfhei1' USING DFHEIV0
  5327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5328
  5329
  5330     MOVE SPACE                  TO PI-REC-TYPE (1)
  5331                                    PI-REC-TYPE (2)
  5332                                    PI-REC-TYPE (3).
  5333
  5334     MOVE ZEROS                  TO PI-FILE-SEQ-NO (1)
  5335                                    PI-FILE-SEQ-NO (2)
  5336                                    PI-FILE-SEQ-NO (3)
  5337                                    PI-AMOUNT (1)
  5338                                    PI-AMOUNT (2)
  5339                                    PI-AMOUNT (3).
  5340
  5341     MOVE SPACE                  TO PI-APPLIED (1)
  5342                                    PI-REFERENCE (1)
  5343                                    PI-INVOICE (1)
  5344                                    PI-APPLIED (2)
  5345                                    PI-REFERENCE (2)
  5346                                    PI-INVOICE (2)
  5347                                    PI-APPLIED (3)
  5348                                    PI-REFERENCE (3)
  5349                                    PI-INVOICE (3).
  5350
  5351     MOVE SPACE                  TO PI-TOTAL-DISPLAYED-SW.
  5352     SET PINDX                   TO ZERO-NDX.
  5353
  5354     IF (SENT-FROM-PENDING
  5355            AND PI-PYAJ-REFERENCE GREATER THAN SPACES)
  5356        SET PINDX  UP  BY  1
  5357        MOVE 12                  TO  REF-LEN (PINDX)
  5358        MOVE PI-PYAJ-REFERENCE   TO  REF (PINDX)
  5359        MOVE 'Y'                 TO  PI-PYAJ-FILLED-SW
  5360        MOVE SPACE               TO  EL630-SENT-SW.
  5361
  5362 6010-READ-NEXT.
  5363
  5364
  5365* EXEC CICS READNEXT
  5366*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  5367*        DATASET  (PYAJ-FILE-ID)
  5368*        RIDFLD   (ERPYAJ-KEY)
  5369*    END-EXEC.
  5370     MOVE 0
  5371       TO DFHEIV11
  5372*    MOVE '&.S                   )   #00004810' TO DFHEIV0
  5373     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL635.cbl
  5374     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5375     MOVE X'2020233030303034383130' TO DFHEIV0(25:11)
  5376     CALL 'kxdfhei1' USING DFHEIV0,
  5377           PYAJ-FILE-ID,
  5378           DFHEIV20,
  5379           DFHEIV99,
  5380           ERPYAJ-KEY,
  5381           DFHEIV99,
  5382           DFHEIV11,
  5383           DFHEIV99,
  5384           DFHEIV99
  5385     SET ADDRESS OF PENDING-PAY-ADJ TO
  5386         DFHEIV20
  5387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5388
  5389
  5390     IF PI-COMPANY-CD NOT = PY-COMPANY-CD
  5391       AND PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  5392         GO TO 6100-END-OF-FILE.
  5393
  5394     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  5395         IF PY-CARRIER NOT = PI-CARRIER-SECURITY
  5396             IF PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  5397                 GO TO 6100-END-OF-FILE.
  5398
  5399     IF PYAJ-1ST-READ
  5400       AND EIBAID NOT = DFHENTER
  5401       AND NOT PAGE-FULL
  5402         MOVE PY-CONTROL-PRIMARY  TO  PI-SAV-ENDING-PYAJ-KEY
  5403         MOVE PY-CARRIER          TO  PI-CR-CARRIER
  5404         MOVE PY-GROUPING         TO  PI-CR-GROUPING
  5405         MOVE PY-FIN-RESP         TO  PI-CR-FIN-RESP
  5406         MOVE PY-ACCOUNT          TO  PI-CR-ACCOUNT.
  5407
  5408     MOVE SPACE                  TO  PI-PYAJ-FILE-SW.
  5409
  5410     IF PI-COMPANY-CD   = PY-COMPANY-CD  AND
  5411        PI-SAV-CARRIER  = PY-CARRIER     AND
  5412        PI-SAV-GROUPING = PY-GROUPING    AND
  5413        PI-SAV-FIN-RESP = PY-FIN-RESP    AND
  5414        PI-SAV-ACCOUNT  = PY-ACCOUNT
  5415         NEXT SENTENCE
  5416     ELSE
  5417         IF PYAJ-1ST-READ
  5418            AND NOT PAGE-FULL
  5419             MOVE 'Y'            TO  PI-PYAJ-FILE-SW
  5420             MOVE SPACE          TO  PYAJ-READ-SW
  5421             GO TO 6200-EXIT
  5422         ELSE
  5423             MOVE 'A'            TO  PI-PYAJ-FILE-SW
  5424             IF PINDX  IS LESS THAN  +3
  5425                 SET PINDX  UP  BY  1
  5426                 MOVE 'TOTAL'         TO  COMM (PINDX)
  5427                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  5428                 MOVE 'NET TOTAL'     TO  REF  (PINDX)
  5429                 MOVE TOTAL-ACCT-NET  TO  NETO (PINDX)
  5430                 GO TO 6200-EXIT
  5431             ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL635.cbl
  5432                 MOVE TOTAL-ACCT-AMT  TO  PI-SAV-ACCT-AMT
  5433                 MOVE TOTAL-ACCT-NET  TO  PI-SAV-ACCT-NET
  5434                 MOVE 'F'             TO  PI-PYAJ-FILE-SW
  5435                 GO TO 6200-EXIT.
  5436
  5437     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  5438         GO TO 6000-READ-AND-FORMAT-SCREEN.
  5439
  5440     SET PINDX  UP  BY +1.
  5441
  5442     SET WS-SAVE-INDEX-VALUE     TO  PINDX.
  5443
  5444     MOVE TOTAL-ACCT-AMT      TO PI-SAV-ACCT-AMT.
  5445     MOVE TOTAL-ACCT-NET      TO PI-SAV-ACCT-NET.
  5446
  5447     IF PINDX  IS GREATER THAN  +3
  5448        MOVE 'F'                 TO  PI-PYAJ-FILE-SW
  5449        GO TO 6200-EXIT.
  5450
  5451     IF PYAJ-1ST-READ
  5452         MOVE SPACE              TO  PYAJ-READ-SW.
  5453
  5454     SET NDX                     TO  PINDX.
  5455     SET WS-SAVE-NDX-VALUE       TO  NDX.
  5456
  5457     MOVE PY-FILE-SEQ-NO         TO  PI-FILE-SEQ-NO (NDX).
  5458     MOVE PY-ENTRY-COMMENT       TO  COMM (PINDX).
  5459     MOVE PY-ENTRY-AMT           TO  AMTO (PINDX).
  5460
  5461     ADD PY-ENTRY-AMT            TO  TOTAL-ACCT-AMT.
  5462
  5463     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'S' OR 'T' OR 'Z'
  5464         ADD PY-ENTRY-AMT        TO  TOTAL-ACCT-NET
  5465     ELSE
  5466         SUBTRACT PY-ENTRY-AMT  FROM  TOTAL-ACCT-NET.
  5467
  5468     MOVE PY-RECORD-TYPE         TO  RTYPE (PINDX)
  5469                                     PI-REC-TYPE (NDX).
  5470
  5471     MOVE PY-PMT-APPLIED         TO  PI-APPLIED (NDX).
  5472     MOVE PY-REF-NO              TO  PI-REFERENCE (NDX).
  5473     MOVE PY-BIL-INV             TO  PI-INVOICE (NDX).
  5474     MOVE PY-ENTRY-AMT           TO  PI-AMOUNT (NDX).
  5475
  5476     IF PY-RECORD-TYPE = 'G'
  5477        MOVE 'G'                 TO  PI-SPECIAL-GROUPING-SW
  5478     ELSE
  5479        MOVE SPACE               TO  PI-SPECIAL-GROUPING-SW.
  5480
  5481     IF PY-PMT-APPLIED NOT = SPACE
  5482         MOVE PY-PMT-APPLIED     TO  APPLIED (PINDX).
  5483
  5484     IF PY-VOID-SW NOT = SPACE
  5485         MOVE PY-VOID-SW         TO  VOID-SW (PINDX).
  5486
  5487     IF PY-LAST-MAINT-DT = PREV-BIN-MAINT-DT
  5488         MOVE PREV-MAINT-DT        TO  MDTE (PINDX)
  5489     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL635.cbl
  5490         MOVE PY-LAST-MAINT-DT     TO  DC-BIN-DATE-1
  5491                                       PREV-BIN-MAINT-DT
  5492         MOVE SPACE                TO  DC-OPTION-CODE
  5493         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5494         MOVE DC-GREG-DATE-1-MDY   TO  MDTE (PINDX)
  5495                                       PREV-MAINT-DT.
  5496
  5497     IF PY-AR-DATE NOT = LOW-VALUES
  5498         MOVE AL-SANOF           TO  COMM-ATTRB    (PINDX)
  5499                                     RTYPE-ATTRB   (PINDX)
  5500                                     AMT-ATTRB     (PINDX)
  5501                                     VOID-SW-ATTRB (PINDX)
  5502                                     APPLIED-ATTRB (PINDX)
  5503                                     REF-ATTRB     (PINDX)
  5504                                     INVOICE-ATTRB (PINDX)
  5505                                     IDTE-ATTRB    (PINDX)
  5506                                     CREDIT-ATTRB  (PINDX)
  5507                                     DEBIT-ATTRB   (PINDX)
  5508         IF PY-AR-DATE = PREV-BIN-BL-DT
  5509             MOVE PREV-BL-DT           TO  BDTE (PINDX)
  5510         ELSE
  5511             MOVE PY-AR-DATE           TO  DC-BIN-DATE-1
  5512                                           PREV-BIN-BL-DT
  5513             MOVE SPACE                TO  DC-OPTION-CODE
  5514             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5515             MOVE DC-GREG-DATE-1-MDY   TO  BDTE (PINDX)
  5516                                           PREV-BL-DT.
  5517
  5518     IF PY-AR-DATE NOT = LOW-VALUES
  5519        IF MORTGAGE-SESSION
  5520            MOVE AL-SANON        TO  INVOICE-ATTRB (PINDX).
  5521
  5522     IF (PY-CHECK-ORIGIN-SW = SPACES OR LOW-VALUES) AND
  5523        (PY-GL-DATE = SPACES OR LOW-VALUES)
  5524         NEXT SENTENCE
  5525     ELSE
  5526         MOVE AL-SANOF           TO  RTYPE-ATTRB   (PINDX)
  5527                                     AMT-ATTRB     (PINDX)
  5528                                     VOID-SW-ATTRB (PINDX)
  5529                                     APPLIED-ATTRB (PINDX)
  5530                                     SDTE-ATTRB    (PINDX)
  5531                                     IDTE-ATTRB    (PINDX)
  5532                                     REF-ATTRB     (PINDX)
  5533                                     INVOICE-ATTRB (PINDX)
  5534                                     CREDIT-ATTRB  (PINDX)
  5535                                     DEBIT-ATTRB   (PINDX).
  5536
  5537     IF PI-PROCESSOR-ID = 'LGXX'
  5538         MOVE AL-UANOF           TO  COMM-ATTRB    (PINDX)
  5539                                     RTYPE-ATTRB   (PINDX)
  5540                                     AMT-ATTRB     (PINDX)
  5541                                     VOID-SW-ATTRB (PINDX)
  5542                                     APPLIED-ATTRB (PINDX)
  5543                                     SDTE-ATTRB    (PINDX)
  5544                                     REF-ATTRB     (PINDX)
  5545                                     INVOICE-ATTRB (PINDX)
  5546                                     IDTE-ATTRB    (PINDX)
  5547                                     CREDIT-ATTRB  (PINDX)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL635.cbl
  5548                                     DEBIT-ATTRB   (PINDX).
  5549
  5550     IF PY-CREDIT-SELECT-DT NOT = LOW-VALUES
  5551        MOVE PY-CREDIT-SELECT-DT  TO  DC-BIN-DATE-1
  5552        MOVE SPACE                TO  DC-OPTION-CODE
  5553        PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5554        MOVE DC-GREG-DATE-1-MDY   TO  SDTE (PINDX).
  5555
  5556     IF PY-INPUT-DT  NOT =  LOW-VALUES
  5557         MOVE PY-INPUT-DT        TO  DC-BIN-DATE-1
  5558         MOVE SPACE              TO  DC-OPTION-CODE
  5559         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5560         MOVE DC-GREG-DATE-1-MDY
  5561                                 TO  IDTE (PINDX).
  5562
  5563     MOVE PY-REF-NO              TO  REF     (PINDX).
  5564     MOVE PY-BIL-INV             TO  INVOICE (PINDX).
  5565     MOVE PY-GL-CR               TO  CREDIT  (PINDX).
  5566     MOVE PY-GL-DB               TO  DEBIT   (PINDX).
  5567
  5568     GO TO 6010-READ-NEXT.
  5569
  5570 6100-END-OF-FILE.
  5571     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  5572
  5573     IF PINDX  IS LESS THAN  +3
  5574         SET PINDX  UP  BY  1
  5575         MOVE 'TOTAL'            TO  COMM (PINDX)
  5576         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
  5577         MOVE 'NET TOTAL'        TO  REF  (PINDX)
  5578         MOVE TOTAL-ACCT-NET     TO  NETO (PINDX)
  5579         MOVE 'Y'                TO  PI-TOTAL-DISPLAYED-SW
  5580     ELSE
  5581         MOVE TOTAL-ACCT-AMT     TO  PI-SAV-ACCT-AMT
  5582         MOVE TOTAL-ACCT-NET     TO  PI-SAV-ACCT-NET.
  5583
  5584 6200-EXIT.
  5585     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL635.cbl
  5587
  5588
  5589 6500-VERIFY-RECON-HEADER.
  5590
  5591     IF PY-REMIT-RECEIVED
  5592        GO TO 6590-EXIT.
  5593
  5594     MOVE PI-COMPANY-CD           TO MPPRCN-COMPANY-CD.
  5595     MOVE INVOICE (PINDX)         TO MPPRCN-INVOICE.
  5596     MOVE +999999999              TO MPPRCN-RECORD-SEQU.
  5597
  5598
  5599* EXEC CICS HANDLE CONDITION
  5600*        NOTFND   (6580-HEADER-NOTFND)
  5601*        END-EXEC.
  5602*    MOVE '"$I                   ! 1 #00005024' TO DFHEIV0
  5603     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5604     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5605     MOVE X'3120233030303035303234' TO DFHEIV0(25:11)
  5606     CALL 'kxdfhei1' USING DFHEIV0
  5607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5608
  5609
  5610
  5611* EXEC CICS READ
  5612*        DATASET   (MPPRCN-FILE-ID)
  5613*        SET       (ADDRESS OF PAYMENT-RECONCILIATION)
  5614*        RIDFLD    (MPPRCN-KEY)
  5615*        END-EXEC.
  5616*    MOVE '&"S        E          (   #00005028' TO DFHEIV0
  5617     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5618     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5619     MOVE X'2020233030303035303238' TO DFHEIV0(25:11)
  5620     CALL 'kxdfhei1' USING DFHEIV0,
  5621           MPPRCN-FILE-ID,
  5622           DFHEIV20,
  5623           DFHEIV99,
  5624           MPPRCN-KEY,
  5625           DFHEIV99,
  5626           DFHEIV99,
  5627           DFHEIV99
  5628     SET ADDRESS OF PAYMENT-RECONCILIATION TO
  5629         DFHEIV20
  5630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5631
  5632
  5633     IF  NOT PI-NO-CARRIER-SECURITY
  5634             AND
  5635         PI-CARRIER-SECURITY NOT EQUAL PR-CARRIER-A2
  5636         MOVE -1                 TO CARRIERL
  5637         MOVE AL-UANON           TO CARRIERA
  5638         MOVE ER-9095            TO EMI-ERROR
  5639         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5640         GO TO 8200-SEND-DATAONLY.
  5641
  5642     MOVE PR-SECURITY-ACCESS-CODE
  5643                                 TO SC-SECURITY-ACCESS-CODE.
  5644     PERFORM 9920-PRODUCER-EVALUATION THRU 9920-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL635.cbl
  5645
  5646     IF  SC-PRODUCER-NOT-AUTHORIZED
  5647         MOVE -1                 TO ACCTL
  5648         MOVE AL-UANON           TO ACCTA
  5649         MOVE ER-9094            TO EMI-ERROR
  5650         GO TO 8200-SEND-DATAONLY.
  5651
  5652     IF PR-HDR-POSTED
  5653        GO TO 6560-POST-ERROR.
  5654
  5655     GO TO 6590-EXIT.
  5656
  5657 6560-POST-ERROR.
  5658
  5659     MOVE -1                     TO INVOICE-LEN (PINDX)
  5660     MOVE ER-9296                TO EMI-ERROR.
  5661     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  5662
  5663     GO TO 6590-EXIT.
  5664
  5665 6580-HEADER-NOTFND.
  5666
  5667     MOVE -1                     TO INVOICE-LEN (PINDX)
  5668     MOVE ER-9280                TO EMI-ERROR.
  5669     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  5670
  5671 6590-EXIT.
  5672     EXIT.
  5673
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL635.cbl
  5675
  5676 6600-UPDATE-RECON-HEADER.
  5677
  5678     IF (PY-REMIT-RECEIVED OR PY-REMIT-IND-GROUPING)
  5679        NEXT SENTENCE
  5680     ELSE
  5681        GO TO 6690-EXIT.
  5682
  5683     MOVE PI-COMPANY-CD           TO MPPRCN-COMPANY-CD.
  5684     MOVE PY-BIL-INV              TO MPPRCN-INVOICE.
  5685     MOVE +999999999              TO MPPRCN-RECORD-SEQU.
  5686
  5687
  5688* EXEC CICS HANDLE CONDITION
  5689*        NOTFND   (6680-HEADER-NOTFND)
  5690*        END-EXEC.
  5691*    MOVE '"$I                   ! 2 #00005088' TO DFHEIV0
  5692     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5693     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5694     MOVE X'3220233030303035303838' TO DFHEIV0(25:11)
  5695     CALL 'kxdfhei1' USING DFHEIV0
  5696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5697
  5698
  5699
  5700* EXEC CICS READ
  5701*        DATASET   (MPPRCN-FILE-ID)
  5702*        SET       (ADDRESS OF PAYMENT-RECONCILIATION)
  5703*        RIDFLD    (MPPRCN-KEY)
  5704*        UPDATE
  5705*        END-EXEC.
  5706*    MOVE '&"S        EU         (   #00005092' TO DFHEIV0
  5707     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5708     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5709     MOVE X'2020233030303035303932' TO DFHEIV0(25:11)
  5710     CALL 'kxdfhei1' USING DFHEIV0,
  5711           MPPRCN-FILE-ID,
  5712           DFHEIV20,
  5713           DFHEIV99,
  5714           MPPRCN-KEY,
  5715           DFHEIV99,
  5716           DFHEIV99,
  5717           DFHEIV99
  5718     SET ADDRESS OF PAYMENT-RECONCILIATION TO
  5719         DFHEIV20
  5720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5721
  5722
  5723     IF  NOT PI-NO-CARRIER-SECURITY
  5724             AND
  5725         PI-CARRIER-SECURITY NOT EQUAL PR-CARRIER-A2
  5726         MOVE -1                 TO CARRIERL
  5727         MOVE AL-UANON           TO CARRIERA
  5728         MOVE ER-9095            TO EMI-ERROR
  5729         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5730         GO TO 8200-SEND-DATAONLY.
  5731
  5732     MOVE PR-SECURITY-ACCESS-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL635.cbl
  5733                                 TO SC-SECURITY-ACCESS-CODE.
  5734     PERFORM 9920-PRODUCER-EVALUATION THRU 9920-EXIT.
  5735
  5736     IF  SC-PRODUCER-NOT-AUTHORIZED
  5737         MOVE -1                 TO ACCTL
  5738         MOVE AL-UANON           TO ACCTA
  5739         MOVE ER-9094            TO EMI-ERROR
  5740         GO TO 8200-SEND-DATAONLY.
  5741
  5742     IF PR-HDR-POSTED
  5743        GO TO 6660-POST-ERROR.
  5744
  5745     IF WS-RECON-DELETE
  5746        SUBTRACT WS-ENTRY-AMT  FROM PR-RECEIVED-PREMIUM.
  5747
  5748     IF WS-RECON-UPDATE
  5749        SUBTRACT WS-OLD-ENTRY-AMT FROM PR-RECEIVED-PREMIUM
  5750        ADD      WS-ENTRY-AMT     TO   PR-RECEIVED-PREMIUM.
  5751
  5752     IF WS-RECON-ADD
  5753        ADD  WS-ENTRY-AMT        TO PR-RECEIVED-PREMIUM.
  5754
  5755     MOVE WS-CURRENT-BIN-DT      TO PR-RECEIVED-DT.
  5756
  5757     MOVE PI-PROCESSOR-ID       TO PR-LAST-CHANGE-PROCESSOR.
  5758     MOVE EIBTIME               TO PR-LAST-CHANGE-TIME.
  5759     MOVE WS-CURRENT-BIN-DT     TO PR-LAST-CHANGE-DT.
  5760
  5761
  5762* EXEC CICS REWRITE
  5763*        DATASET   (MPPRCN-FILE-ID)
  5764*        FROM      (PAYMENT-RECONCILIATION)
  5765*        END-EXEC.
  5766     MOVE LENGTH OF
  5767      PAYMENT-RECONCILIATION
  5768       TO DFHEIV11
  5769*    MOVE '&& L                  %   #00005137' TO DFHEIV0
  5770     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5771     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5772     MOVE X'2020233030303035313337' TO DFHEIV0(25:11)
  5773     CALL 'kxdfhei1' USING DFHEIV0,
  5774           MPPRCN-FILE-ID,
  5775           PAYMENT-RECONCILIATION,
  5776           DFHEIV11,
  5777           DFHEIV99
  5778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5779
  5780
  5781     GO TO 6690-EXIT.
  5782
  5783 6660-POST-ERROR.
  5784
  5785
  5786* EXEC CICS SYNCPOINT ROLLBACK
  5787*    END-EXEC.
  5788*    MOVE '6"R                   !   #00005146' TO DFHEIV0
  5789     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  5790     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL635.cbl
  5791     MOVE X'2020233030303035313436' TO DFHEIV0(25:11)
  5792     CALL 'kxdfhei1' USING DFHEIV0
  5793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5794
  5795
  5796     MOVE -1                     TO INVOICE-LEN (PINDX)
  5797     MOVE ER-9296                TO EMI-ERROR.
  5798     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  5799
  5800     GO TO 8200-SEND-DATAONLY.
  5801
  5802 6680-HEADER-NOTFND.
  5803
  5804
  5805* EXEC CICS SYNCPOINT ROLLBACK
  5806*    END-EXEC.
  5807*    MOVE '6"R                   !   #00005157' TO DFHEIV0
  5808     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  5809     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5810     MOVE X'2020233030303035313537' TO DFHEIV0(25:11)
  5811     CALL 'kxdfhei1' USING DFHEIV0
  5812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5813
  5814
  5815     MOVE -1                     TO INVOICE-LEN (PINDX).
  5816     MOVE ER-9280                TO EMI-ERROR.
  5817     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  5818
  5819     GO TO 8200-SEND-DATAONLY.
  5820
  5821 6690-EXIT.
  5822     EXIT.
  5823
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL635.cbl
  5825
  5826 7000-PYAJ-FILE-NOTOPEN.
  5827     MOVE -1                     TO  MAINTL.
  5828
  5829     IF  MORTGAGE-SESSION
  5830         MOVE ER-9374            TO  EMI-ERROR
  5831
  5832     ELSE
  5833         MOVE ER-2232            TO  EMI-ERROR.
  5834
  5835     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5836
  5837     GO TO 8200-SEND-DATAONLY.
  5838
  5839 7100-COMP-FILE-NOTOPEN.
  5840     MOVE -1                     TO  MAINTL.
  5841     MOVE ER-2233                TO  EMI-ERROR.
  5842
  5843     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5844
  5845     GO TO 8200-SEND-DATAONLY.
  5846
  5847 7200-RECV-FILE-NOTOPEN.
  5848     MOVE -1                     TO  MAINTL.
  5849     MOVE ER-3177                TO  EMI-ERROR.
  5850
  5851     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5852
  5853     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL635.cbl
  5855 8100-SEND-INITIAL-MAP.
  5856     MOVE WS-CURRENT-DT          TO  DATEO.
  5857     MOVE EIBTIME                TO  TIME-IN.
  5858     MOVE TIME-OUT               TO  TIMEO.
  5859     MOVE -1                     TO  MAINTL.
  5860     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5861     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5862
  5863     IF MORTGAGE-SESSION
  5864        MOVE ' PRODUCER:'        TO ACCTHDGO
  5865        MOVE AL-SABOF            TO ACCTHDGA.
  5866
  5867     IF NOT CREDIT-SESSION
  5868        MOVE AL-SADOF            TO PFGABILA, PFACBILA.
  5869
  5870     IF EIBTRNID = TRANS-ID
  5871       OR EL640-TRANS-ID
  5872       OR EL642-TRANS-ID
  5873       OR EL652-TRANS-ID
  5874       OR EL6351-TRANS-ID
  5875       OR EL630-TRANS-ID
  5876         IF PI-SAV-COMP-CONTROL GREATER THAN SPACES
  5877             MOVE PI-SAV-FUNCTION  TO  MAINTI
  5878             MOVE PI-SAV-CARRIER   TO  CARRIERO
  5879             MOVE PI-SAV-GROUPING  TO  GROUPO
  5880             MOVE PI-SAV-FIN-RESP  TO  FINRESPO
  5881             MOVE PI-SAV-ACCOUNT   TO  ACCTO
  5882             MOVE AL-UANON         TO  MAINTA
  5883                                       CARRIERA
  5884                                       GROUPA
  5885                                       FINRESPA
  5886                                       ACCTA
  5887         ELSE
  5888             NEXT SENTENCE.
  5889
  5890     MOVE WS-EMHD1               TO  EMHD1O
  5891     MOVE AL-SABOF               TO  EMHD1A
  5892     MOVE WS-EMHD2               TO  EMHD2O
  5893     MOVE AL-SABOF               TO  EMHD2A.
  5894
  5895
  5896* EXEC CICS SEND
  5897*        MAP     (MAP-NAME)
  5898*        MAPSET  (MAPSET-NAME)
  5899*        FROM    (EL635AO)
  5900*        ERASE
  5901*        CURSOR
  5902*        END-EXEC.
  5903     MOVE LENGTH OF
  5904      EL635AO
  5905       TO DFHEIV12
  5906     MOVE -1
  5907       TO DFHEIV11
  5908*    MOVE '8$     CT  E    H L F ,   #00005240' TO DFHEIV0
  5909     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5910     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5911     MOVE X'2020233030303035323430' TO DFHEIV0(25:11)
  5912     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL635.cbl
  5913           MAP-NAME,
  5914           EL635AO,
  5915           DFHEIV12,
  5916           MAPSET-NAME,
  5917           DFHEIV99,
  5918           DFHEIV99,
  5919           DFHEIV99,
  5920           DFHEIV11,
  5921           DFHEIV99,
  5922           DFHEIV99,
  5923           DFHEIV99
  5924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5925
  5926
  5927     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL635.cbl
  5929 8200-SEND-DATAONLY.
  5930     MOVE WS-CURRENT-DT          TO  DATEO.
  5931     MOVE EIBTIME                TO  TIME-IN.
  5932     MOVE TIME-OUT               TO  TIMEO.
  5933     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5934     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5935
  5936     IF NOT CREDIT-SESSION
  5937        MOVE AL-SADOF            TO PFGABILA, PFACBILA.
  5938
  5939
  5940* EXEC CICS SEND
  5941*        MAP     (MAP-NAME)
  5942*        MAPSET  (MAPSET-NAME)
  5943*        FROM    (EL635AO)
  5944*        DATAONLY
  5945*        CURSOR
  5946*    END-EXEC.
  5947     MOVE LENGTH OF
  5948      EL635AO
  5949       TO DFHEIV12
  5950     MOVE -1
  5951       TO DFHEIV11
  5952*    MOVE '8$D    CT       H L F ,   #00005260' TO DFHEIV0
  5953     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5954     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5955     MOVE X'2020233030303035323630' TO DFHEIV0(25:11)
  5956     CALL 'kxdfhei1' USING DFHEIV0,
  5957           MAP-NAME,
  5958           EL635AO,
  5959           DFHEIV12,
  5960           MAPSET-NAME,
  5961           DFHEIV99,
  5962           DFHEIV99,
  5963           DFHEIV99,
  5964           DFHEIV11,
  5965           DFHEIV99,
  5966           DFHEIV99,
  5967           DFHEIV99
  5968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5969
  5970
  5971     GO TO 9100-RETURN-TRAN.
  5972
  5973 8300-SEND-TEXT.
  5974
  5975* EXEC CICS SEND TEXT
  5976*        FROM    (LOGOFF-TEXT)
  5977*        LENGTH  (LOGOFF-LENGTH)
  5978*        ERASE
  5979*        FREEKB
  5980*    END-EXEC.
  5981*    MOVE '8&      T  E F  H   F -   #00005271' TO DFHEIV0
  5982     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5983     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5984     MOVE X'2020233030303035323731' TO DFHEIV0(25:11)
  5985     CALL 'kxdfhei1' USING DFHEIV0,
  5986           LOGOFF-TEXT,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL635.cbl
  5987           LOGOFF-LENGTH,
  5988           DFHEIV99,
  5989           DFHEIV99,
  5990           DFHEIV99,
  5991           DFHEIV99,
  5992           DFHEIV99,
  5993           DFHEIV99,
  5994           DFHEIV99,
  5995           DFHEIV99,
  5996           DFHEIV99,
  5997           DFHEIV99
  5998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5999
  6000
  6001
  6002* EXEC CICS RETURN
  6003*    END-EXEC.
  6004*    MOVE '.(                    &   #00005278' TO DFHEIV0
  6005     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6006     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6007     MOVE X'2020233030303035323738' TO DFHEIV0(25:11)
  6008     CALL 'kxdfhei1' USING DFHEIV0,
  6009           DFHEIV99,
  6010           DFHEIV99,
  6011           DFHEIV99,
  6012           DFHEIV99,
  6013           DFHEIV99
  6014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6015
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL635.cbl
  6017 8400-LOG-JOURNAL-RECORD.
  6018*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  6019*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  6020
  6021*    EXEC CICS JOURNAL
  6022*        JFILEID  (PI-JOURNAL-FILE-ID)
  6023*        JTYPEID  ('EL')
  6024*        FROM     (JOURNAL-RECORD)
  6025*        LENGTH   (223)
  6026*        END-EXEC.
  6027
  6028 8400-EXIT.
  6029     EXIT.
  6030
  6031 8500-DATE-CONVERT.
  6032
  6033* EXEC CICS LINK
  6034*        PROGRAM   (LINK-CLDATCV)
  6035*        COMMAREA  (DATE-CONVERSION-DATA)
  6036*        LENGTH    (DC-COMM-LENGTH)
  6037*    END-EXEC.
  6038*    MOVE '."C                   ''   #00005296' TO DFHEIV0
  6039     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6040     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6041     MOVE X'2020233030303035323936' TO DFHEIV0(25:11)
  6042     CALL 'kxdfhei1' USING DFHEIV0,
  6043           LINK-CLDATCV,
  6044           DATE-CONVERSION-DATA,
  6045           DC-COMM-LENGTH,
  6046           DFHEIV99,
  6047           DFHEIV99,
  6048           DFHEIV99
  6049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6050
  6051
  6052 8500-EXIT.
  6053     EXIT.
  6054
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL635.cbl
  6056 8800-UNAUTHORIZED-ACCESS.
  6057     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  6058
  6059     GO TO 8300-SEND-TEXT.
  6060
  6061 8810-PF23.
  6062     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  6063     MOVE XCTL-005               TO  PGM-NAME.
  6064
  6065     GO TO 9300-XCTL.
  6066
  6067 9000-RETURN-CICS.
  6068
  6069* EXEC CICS RETURN
  6070*        END-EXEC.
  6071*    MOVE '.(                    &   #00005318' TO DFHEIV0
  6072     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6073     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6074     MOVE X'2020233030303035333138' TO DFHEIV0(25:11)
  6075     CALL 'kxdfhei1' USING DFHEIV0,
  6076           DFHEIV99,
  6077           DFHEIV99,
  6078           DFHEIV99,
  6079           DFHEIV99,
  6080           DFHEIV99
  6081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6082
  6083
  6084 9100-RETURN-TRAN.
  6085     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  6086     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  6087
  6088
  6089* EXEC CICS RETURN
  6090*        TRANSID   (TRANS-ID)
  6091*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  6092*        LENGTH    (PI-COMM-LENGTH)
  6093*    END-EXEC.
  6094*    MOVE '.(CT                  &   #00005325' TO DFHEIV0
  6095     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  6096     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6097     MOVE X'2020233030303035333235' TO DFHEIV0(25:11)
  6098     CALL 'kxdfhei1' USING DFHEIV0,
  6099           TRANS-ID,
  6100           PROGRAM-INTERFACE-BLOCK,
  6101           PI-COMM-LENGTH,
  6102           DFHEIV99,
  6103           DFHEIV99
  6104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6105
  6106
  6107 9200-RETURN-MAIN-MENU.
  6108     MOVE XCTL-626               TO  PGM-NAME.
  6109
  6110     GO TO 9300-XCTL.
  6111
  6112 9300-XCTL.
  6113
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL635.cbl
  6114* EXEC CICS XCTL
  6115*        PROGRAM   (PGM-NAME)
  6116*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  6117*        LENGTH    (PI-COMM-LENGTH)
  6118*    END-EXEC.
  6119*    MOVE '.$C                   $   #00005337' TO DFHEIV0
  6120     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6121     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6122     MOVE X'2020233030303035333337' TO DFHEIV0(25:11)
  6123     CALL 'kxdfhei1' USING DFHEIV0,
  6124           PGM-NAME,
  6125           PROGRAM-INTERFACE-BLOCK,
  6126           PI-COMM-LENGTH
  6127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6128
  6129
  6130 9400-CLEAR.
  6131     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  6132
  6133     IF PI-RETURN-TO-PROGRAM = 'EL626'
  6134         MOVE SPACES             TO  PI-CR-CONTROL-IN-PROGRESS
  6135                                     PI-SAV-COMP-CONTROL.
  6136
  6137     GO TO 9300-XCTL.
  6138
  6139 9500-PF12.
  6140     MOVE XCTL-010               TO  PGM-NAME.
  6141
  6142     GO TO 9300-XCTL.
  6143
  6144 9600-PGMID-ERROR.
  6145
  6146* EXEC CICS HANDLE CONDITION
  6147*        PGMIDERR  (8300-SEND-TEXT)
  6148*    END-EXEC.
  6149*    MOVE '"$L                   ! 3 #00005358' TO DFHEIV0
  6150     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  6151     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6152     MOVE X'3320233030303035333538' TO DFHEIV0(25:11)
  6153     CALL 'kxdfhei1' USING DFHEIV0
  6154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6155
  6156
  6157     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  6158     MOVE ' '                    TO  PI-ENTRY-CD-1.
  6159     MOVE XCTL-005               TO  PGM-NAME.
  6160     MOVE PGM-NAME               TO  LOGOFF-PGM.
  6161     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  6162
  6163     GO TO 9300-XCTL.
  6164
  6165 9900-ERROR-FORMAT.
  6166     IF NOT EMI-ERRORS-COMPLETE
  6167         MOVE LINK-001           TO  PGM-NAME
  6168
  6169* EXEC CICS LINK
  6170*            PROGRAM   (PGM-NAME)
  6171*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL635.cbl
  6172*            LENGTH    (EMI-COMM-LENGTH)
  6173*        END-EXEC.
  6174*    MOVE '."C                   ''   #00005373' TO DFHEIV0
  6175     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6176     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6177     MOVE X'2020233030303035333733' TO DFHEIV0(25:11)
  6178     CALL 'kxdfhei1' USING DFHEIV0,
  6179           PGM-NAME,
  6180           ERROR-MESSAGE-INTERFACE-BLOCK,
  6181           EMI-COMM-LENGTH,
  6182           DFHEIV99,
  6183           DFHEIV99,
  6184           DFHEIV99
  6185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6186
  6187
  6188 9900-EXIT.
  6189     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL635.cbl
  6191 9910-INITIALIZE-SECURITY.
  6192******************************************************************
  6193*                                                                *
  6194*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  6195*       USER SECURITY RECORD SET UP BY EL125.  THIS PROGRAM      *
  6196*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  6197*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  6198*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  6199*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  6200*                                                                *
  6201******************************************************************
  6202
  6203     IF  PI-PROCESSOR-ID NOT EQUAL 'LGXX'
  6204         IF  MORTGAGE-SESSION
  6205             MOVE '125E'             TO SC-QUID-SYSTEM
  6206             MOVE EIBTRMID           TO SC-QUID-TERMINAL
  6207
  6208
  6209* EXEC CICS READQ TS
  6210*                QUEUE  (SC-QUID-KEY)
  6211*                INTO   (SECURITY-CONTROL-E)
  6212*                LENGTH (SC-COMM-LENGTH-E)
  6213*                ITEM   (SC-ITEM)
  6214*            END-EXEC
  6215*    MOVE '*$II   L              ''   #00005399' TO DFHEIV0
  6216     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6217     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6218     MOVE X'2020233030303035333939' TO DFHEIV0(25:11)
  6219     CALL 'kxdfhei1' USING DFHEIV0,
  6220           SC-QUID-KEY,
  6221           SECURITY-CONTROL-E,
  6222           SC-COMM-LENGTH-E,
  6223           SC-ITEM,
  6224           DFHEIV99,
  6225           DFHEIV99
  6226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6227
  6228             MOVE SC-MP-DISPLAY (W-APPL-SCRTY-NDX)
  6229                                     TO PI-DISPLAY-CAP
  6230             MOVE SC-MP-UPDATE (W-APPL-SCRTY-NDX)
  6231                                     TO PI-MODIFY-CAP
  6232             IF  NOT DISPLAY-CAP
  6233                 MOVE 'READ'         TO SM-READ
  6234                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6235                 MOVE ER-9097        TO EMI-ERROR
  6236                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6237                 GO TO 8100-SEND-INITIAL-MAP
  6238             ELSE
  6239                 GO TO 9910-EXIT
  6240         ELSE
  6241
  6242* EXEC CICS  READQ TS
  6243*                QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6244*                INTO    (SECURITY-CONTROL)
  6245*                LENGTH  (SC-COMM-LENGTH)
  6246*                ITEM    (SC-ITEM)
  6247*                END-EXEC
  6248*    MOVE '*$II   L              ''   #00005419' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL635.cbl
  6249     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6250     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6251     MOVE X'2020233030303035343139' TO DFHEIV0(25:11)
  6252     CALL 'kxdfhei1' USING DFHEIV0,
  6253           PI-SECURITY-TEMP-STORE-ID,
  6254           SECURITY-CONTROL,
  6255           SC-COMM-LENGTH,
  6256           SC-ITEM,
  6257           DFHEIV99,
  6258           DFHEIV99
  6259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6260
  6261             MOVE SC-CREDIT-DISPLAY (15)
  6262                                 TO PI-DISPLAY-CAP
  6263             MOVE SC-CREDIT-UPDATE  (15)
  6264                                 TO PI-MODIFY-CAP
  6265
  6266             IF  NOT DISPLAY-CAP
  6267                 MOVE 'READ'     TO SM-READ
  6268                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6269                 MOVE ER-0070    TO  EMI-ERROR
  6270                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6271                 GO TO 8100-SEND-INITIAL-MAP.
  6272
  6273 9910-EXIT.
  6274     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL635.cbl
  6276 9920-PRODUCER-EVALUATION.
  6277******************************************************************
  6278*                                                                *
  6279*       THIS AREA CONTAINS THE LOGIC NECESSARY TO CHECK THE      *
  6280*       AUTHORIZATION OF THE USER TO 'ACCESS' A PRODUCER.        *
  6281*       IF THE USER IS NOT AUTHORIZED AN APPROPRIATE MESSAGE     *
  6282*       IS GENERATED.                                            *
  6283*                                                                *
  6284******************************************************************
  6285
  6286     MOVE SPACES                 TO SC-PRODUCER-AUTHORIZED-SW.
  6287
  6288     IF  PI-NO-PRODUCER-SECURITY
  6289             OR
  6290         PI-PROCESSOR-ID EQUAL 'LGXX'
  6291         GO TO 9920-EXIT.
  6292
  6293     SET PI-ACCESS-NDX           TO +1
  6294
  6295     SEARCH PI-ACCESS-CODE
  6296         VARYING PI-ACCESS-NDX
  6297
  6298         AT END
  6299             MOVE 'N'            TO SC-PRODUCER-AUTHORIZED-SW
  6300
  6301         WHEN
  6302             PI-ACCESS-CODE (PI-ACCESS-NDX)
  6303                 EQUAL SC-SECURITY-ACCESS-CODE
  6304             GO TO 9920-EXIT.
  6305
  6306 9920-EXIT.
  6307     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL635.cbl
  6309
  6310 9990-ABEND.
  6311     MOVE LINK-004               TO  PGM-NAME.
  6312     MOVE DFHEIBLK               TO  EMI-LINE1.
  6313
  6314
  6315* EXEC CICS LINK
  6316*        PROGRAM   (PGM-NAME)
  6317*        COMMAREA  (EMI-LINE1)
  6318*        LENGTH    (72)
  6319*    END-EXEC.
  6320     MOVE 72
  6321       TO DFHEIV11
  6322*    MOVE '."C                   ''   #00005479' TO DFHEIV0
  6323     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6324     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6325     MOVE X'2020233030303035343739' TO DFHEIV0(25:11)
  6326     CALL 'kxdfhei1' USING DFHEIV0,
  6327           PGM-NAME,
  6328           EMI-LINE1,
  6329           DFHEIV11,
  6330           DFHEIV99,
  6331           DFHEIV99,
  6332           DFHEIV99
  6333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6334
  6335
  6336     MOVE -1                     TO  PFENTERL.
  6337
  6338     GO TO 8200-SEND-DATAONLY.
  6339
  6340     MOVE ZEROS  TO RETURN-CODE.
  6341
  6342* GOBACK.
  6343     MOVE '9%                    "   ' TO DFHEIV0
  6344     MOVE 'EL635' TO DFHEIV1
  6345     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6346     GOBACK.
  6347
  6348 9995-SECURITY-VIOLATION.
  6349*                            COPY ELCSCTP.
  6350******************************************************************
  6351*                                                                *
  6352*                            ELCSCTP                             *
  6353*                            VMOD=2.001                          *
  6354*                                                                *
  6355*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  6356******************************************************************
  6357
  6358
  6359     MOVE EIBDATE          TO SM-JUL-DATE.
  6360     MOVE EIBTRMID         TO SM-TERMID.
  6361     MOVE THIS-PGM         TO SM-PGM.
  6362     MOVE EIBTIME          TO TIME-IN.
  6363     MOVE TIME-OUT         TO SM-TIME.
  6364     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  6365
  6366
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL635.cbl
  6367* EXEC CICS LINK
  6368*         PROGRAM  ('EL003')
  6369*         COMMAREA (SECURITY-MESSAGE)
  6370*         LENGTH   (80)
  6371*    END-EXEC.
  6372     MOVE 'EL003' TO DFHEIV1
  6373     MOVE 80
  6374       TO DFHEIV11
  6375*    MOVE '."C                   ''   #00005510' TO DFHEIV0
  6376     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6377     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6378     MOVE X'2020233030303035353130' TO DFHEIV0(25:11)
  6379     CALL 'kxdfhei1' USING DFHEIV0,
  6380           DFHEIV1,
  6381           SECURITY-MESSAGE,
  6382           DFHEIV11,
  6383           DFHEIV99,
  6384           DFHEIV99,
  6385           DFHEIV99
  6386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6387
  6388
  6389******************************************************************
  6390
  6391
  6392 9995-EXIT.
  6393     EXIT.
  6394
  6395 9999-DFHBACK SECTION.
  6396     MOVE '9%                    "   ' TO DFHEIV0
  6397     MOVE 'EL635' TO DFHEIV1
  6398     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6399     GOBACK.
  6400 9999-DFHEXIT.
  6401     IF DFHEIGDJ EQUAL 0001
  6402         NEXT SENTENCE
  6403     ELSE IF DFHEIGDJ EQUAL 2
  6404         GO TO 9600-PGMID-ERROR,
  6405               9990-ABEND
  6406         DEPENDING ON DFHEIGDI
  6407     ELSE IF DFHEIGDJ EQUAL 3
  6408         GO TO 0410-NO-A-COMP,
  6409               7100-COMP-FILE-NOTOPEN
  6410         DEPENDING ON DFHEIGDI
  6411     ELSE IF DFHEIGDJ EQUAL 4
  6412         GO TO 0410-NO-G-FOR-A,
  6413               7100-COMP-FILE-NOTOPEN
  6414         DEPENDING ON DFHEIGDI
  6415     ELSE IF DFHEIGDJ EQUAL 5
  6416         GO TO 0410-NO-G-COMP,
  6417               7100-COMP-FILE-NOTOPEN
  6418         DEPENDING ON DFHEIGDI
  6419     ELSE IF DFHEIGDJ EQUAL 6
  6420         GO TO 0890-EXIT
  6421         DEPENDING ON DFHEIGDI
  6422     ELSE IF DFHEIGDJ EQUAL 7
  6423         GO TO 1011-NO-COMP-A,
  6424               7100-COMP-FILE-NOTOPEN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL635.cbl
  6425         DEPENDING ON DFHEIGDI
  6426     ELSE IF DFHEIGDJ EQUAL 8
  6427         GO TO 1011-NO-COMP-G,
  6428               7100-COMP-FILE-NOTOPEN
  6429         DEPENDING ON DFHEIGDI
  6430     ELSE IF DFHEIGDJ EQUAL 9
  6431         GO TO 1040-RECV-NOTFND,
  6432               7200-RECV-FILE-NOTOPEN
  6433         DEPENDING ON DFHEIGDI
  6434     ELSE IF DFHEIGDJ EQUAL 10
  6435         GO TO 2110-ADD-RECORD
  6436         DEPENDING ON DFHEIGDI
  6437     ELSE IF DFHEIGDJ EQUAL 11
  6438         GO TO 2115-DUP-RECORD
  6439         DEPENDING ON DFHEIGDI
  6440     ELSE IF DFHEIGDJ EQUAL 12
  6441         GO TO 2120-DELETE-CONT
  6442         DEPENDING ON DFHEIGDI
  6443     ELSE IF DFHEIGDJ EQUAL 13
  6444         GO TO 2190-DUP-RECORD
  6445         DEPENDING ON DFHEIGDI
  6446     ELSE IF DFHEIGDJ EQUAL 14
  6447         GO TO 5010-NOT-OPEN,
  6448               5020-NO-RECORDS,
  6449               5020-NO-RECORDS
  6450         DEPENDING ON DFHEIGDI
  6451     ELSE IF DFHEIGDJ EQUAL 15
  6452         GO TO 5110-END-OF-FILE,
  6453               5110-END-OF-FILE
  6454         DEPENDING ON DFHEIGDI
  6455     ELSE IF DFHEIGDJ EQUAL 16
  6456         GO TO 6100-END-OF-FILE,
  6457               6100-END-OF-FILE
  6458         DEPENDING ON DFHEIGDI
  6459     ELSE IF DFHEIGDJ EQUAL 17
  6460         GO TO 6580-HEADER-NOTFND
  6461         DEPENDING ON DFHEIGDI
  6462     ELSE IF DFHEIGDJ EQUAL 18
  6463         GO TO 6680-HEADER-NOTFND
  6464         DEPENDING ON DFHEIGDI
  6465     ELSE IF DFHEIGDJ EQUAL 19
  6466         GO TO 8300-SEND-TEXT
  6467         DEPENDING ON DFHEIGDI.
  6468     MOVE '9%                    "   ' TO DFHEIV0
  6469     MOVE 'EL635' TO DFHEIV1
  6470     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6471     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5496     Code:       23658
