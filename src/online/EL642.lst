* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   1
* EL642.cbl
* Options: int("EL642.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL642.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL642.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL642.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL642 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 01/06/95 10:16:47.
     7*                            VMOD=2.031
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   2
* EL642.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXH7 - GENERAL AGENT BILLING
    27*                           (PREPARE AN AGENT STATEMENT).
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    38* 050206    2005072800002  PEMA  ADD PROCESSING FOR DCC COMM.
    39* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    40* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    41* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    42******************************************************************
    43
    44 ENVIRONMENT DIVISION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   3
* EL642.cbl
    46 DATA DIVISION.
    47 WORKING-STORAGE SECTION.
    48 01  DFH-START PIC X(04).
    49
    50 77  FILLER  PIC X(32)  VALUE '********************************'.
    51 77  FILLER  PIC X(32)  VALUE '*    EL642 WORKING STORAGE     *'.
    52 77  FILLER  PIC X(32)  VALUE '***********VMOD 2.031 **********'.
    53 77  CNC-FACT                    PIC S999V9(7) COMP-3 VALUE +0.
    54 77  S1                          PIC S999 COMP-3 VALUE +0.
    55 77  CLAS-LOOK                   PIC XX      VALUE '  '.
    56
    57*    COPY ELCSCTM.
    58******************************************************************
    59*                                                                *
    60*                                                                *
    61*                            ELCSCTM                             *
    62*                            VMOD=2.001                          *
    63*                                                                *
    64*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    65*                                                                *
    66******************************************************************
    67 01  SECURITY-MESSAGE.
    68     12  FILLER                          PIC X(30)
    69            VALUE '** LOGIC SECURITY VIOLATION -'.
    70     12  SM-READ                         PIC X(6).
    71     12  FILLER                          PIC X(5)
    72            VALUE ' PGM='.
    73     12  SM-PGM                          PIC X(6).
    74     12  FILLER                          PIC X(5)
    75            VALUE ' OPR='.
    76     12  SM-PROCESSOR-ID                 PIC X(4).
    77     12  FILLER                          PIC X(6)
    78            VALUE ' TERM='.
    79     12  SM-TERMID                       PIC X(4).
    80     12  FILLER                          PIC XX   VALUE SPACE.
    81     12  SM-JUL-DATE                     PIC 9(5).
    82     12  FILLER                          PIC X    VALUE SPACE.
    83     12  SM-TIME                         PIC 99.99.
    84
    85*    COPY ELCSCRTY.
    86******************************************************************
    87*                                                                *
    88*                                                                *
    89*                            ELCSCRTY                            *
    90*                            VMOD=2.001                          *
    91*                                                                *
    92*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    93*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    94*        SAVED IN PI-SECURITY-ADDRESS.                           *
    95*                                                                *
    96******************************************************************
    97 01  SECURITY-CONTROL.
    98     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    99     12  FILLER                       PIC XX    VALUE 'SC'.
   100     12  SC-CREDIT-CODES.
   101         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   102             20  SC-CREDIT-DISPLAY    PIC X.
   103             20  SC-CREDIT-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   4
* EL642.cbl
   104     12  SC-CLAIMS-CODES.
   105         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   106             20  SC-CLAIMS-DISPLAY    PIC X.
   107             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   5
* EL642.cbl
   109 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   110     88  RESP-NORMAL               VALUE +0.
   111     88  RESP-NOTFND               VALUE +13.
   112     88  RESP-NOTOPEN              VALUE +19.
   113     88  RESP-ENDFILE              VALUE +20.
   114 01  WS-AH-CATEGORY              PIC X   VALUE SPACES.
   115 01  STANDARD-AREAS.
   116     12  SC-ITEM             PIC S9(4)   COMP    VALUE +1.
   117
   118     12  W-TRANSFER-CONTROL.
   119         16  WT-CR-CARRIER           PIC X.
   120         16  WT-CR-GROUPING          PIC X(6).
   121         16  WT-CR-STATE             PIC XX.
   122         16  WT-CR-ACCOUNT           PIC X(10).
   123         16  WT-CR-FIN-RESP          PIC X(10).
   124         16  WT-CR-TYPE              PIC X.
   125
   126     12  GETMAIN-SPACE       PIC  X              VALUE SPACE.
   127     12  MAP-NAME            PIC  X(8)           VALUE 'EL642A'.
   128     12  MAPSET-NAME         PIC  X(8)           VALUE 'EL642S'.
   129     12  SCREEN-NUMBER       PIC  X(4)           VALUE '642A'.
   130     12  TRANS-ID            PIC  X(4)           VALUE 'EXH7'.
   131     12  EL633-TRANS-ID      PIC  X(4)           VALUE 'EXB7'.
   132     12  EL633DMD-TRANS-ID   PIC  X(4)           VALUE 'EX1F'.
   133     12  EL635-TRANS-ID      PIC  X(4)           VALUE 'EXJ4'.
   134     12  EL650-TRANS-ID      PIC  X(4)           VALUE 'EXC4'.
   135     12  EL652-TRANS-ID      PIC  X(4)           VALUE 'EXD4'.
   136     12  EL658-TRANS-ID      PIC  X(4)           VALUE 'EXJ3'.
   137     12  THIS-PGM            PIC  X(8)           VALUE 'EL642'.
   138     12  EL642A              PIC  X(8)           VALUE 'EL642A'.
   139     12  EL642B              PIC  X(8)           VALUE 'EL642B'.
   140     12  PGM-NAME            PIC  X(8).
   141     12  TIME-IN             PIC S9(7).
   142     12  TIME-OUT-R  REDEFINES  TIME-IN.
   143         16  FILLER          PIC  X.
   144         16  TIME-OUT        PIC  99V99.
   145         16  FILLER          PIC  XX.
   146     12  XCTL-005            PIC  X(8)           VALUE 'EL005'.
   147     12  XCTL-010            PIC  X(8)           VALUE 'EL010'.
   148     12  XCTL-626            PIC  X(8)           VALUE 'EL626'.
   149     12  XCTL-633            PIC  X(8)           VALUE 'EL633'.
   150     12  XCTL-633DMD         PIC  X(8)           VALUE 'EL633DMD'.
   151     12  XCTL-635            PIC  X(8)           VALUE 'EL635'.
   152     12  XCTL-PYAJ           PIC  X(8)           VALUE 'EL633'.
   153     12  XCTL-650            PIC  X(8)           VALUE 'EL650'.
   154     12  XCTL-652            PIC  X(8)           VALUE 'EL652'.
   155     12  XCTL-6401           PIC  X(8)           VALUE 'EL6401'.
   156     12  XCTL-658            PIC  X(8)           VALUE 'EL658'.
   157     12  LINK-001            PIC  X(8)           VALUE 'EL001'.
   158     12  LINK-004            PIC  X(8)           VALUE 'EL004'.
   159     12  LINK-ELDATCV        PIC  X(8)           VALUE 'ELDATCV'.
   160     12  ERPNDB-ALT-FILE-ID  PIC  X(8)           VALUE 'ERPNDB2'.
   161     12  ERPNDB-FILE-ID      PIC  X(8)           VALUE 'ERPNDB'.
   162     12  ELCNTL-FILE-ID      PIC  X(8)           VALUE 'ELCNTL'.
   163     12  ERCOMP-FILE-ID      PIC  X(8)           VALUE 'ERCOMP'.
   164     12  ERPYAJ-FILE-ID      PIC  X(8)           VALUE 'ERPYAJ'.
   165     12  ERACCT-ALT-FILE-ID  PIC  X(8)           VALUE 'ERACCT2'.
   166     12  ERACCT-FILE-ID      PIC  X(8)           VALUE 'ERACCT'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   6
* EL642.cbl
   167     12  ERBILL-FILE-ID      PIC  X(8)           VALUE 'ERBILL'.
   168     12  ERGXRF-FILE-ID      PIC  X(8)           VALUE 'ERGXRF'.
   169     12  ERCOMM-FILE-ID      PIC  X(8)           VALUE 'ERCOMM'.
   170     12  ERCTBL-FILE-ID      PIC  X(8)           VALUE 'ERCTBL'.
   171     12  ERRESC-FILE-ID      PIC  X(8)           VALUE 'ERRESC'.
   172     12  RETURNED-FROM       PIC  X(8)           VALUE SPACES.
   173     12  QID.
   174         16  QID-TERM        PIC  X(4).
   175         16  FILLER          PIC  X(4)           VALUE '642A'.
   176
   177 01  WORK-AREA.
   178     12  FIRST-TIME-SW               PIC  X      VALUE 'Y'.
   179         88  FIRST-TIME                          VALUE 'Y'.
   180     12  COMPENSATION-SW             PIC  X      VALUE ' '.
   181         88  GENERAL-AGENT                       VALUE 'G'.
   182     12  LIFE-INDICATOR              PIC  X      VALUE ' '.
   183         88  JOINT-LIFE                          VALUE 'J'.
   184     12  BENEFIT-MASTER-FOUND-SW     PIC  X      VALUE ' '.
   185         88  BENEFIT-MASTER-FOUND                VALUE 'Y'.
   186     12  COMMISSION-TBL-SW           PIC  X      VALUE ' '.
   187         88  COMMISSION-TBL-PRESENT              VALUE 'Y'.
   188     12  INVALID-ACCOUNT-SW          PIC  X      VALUE ' '.
   189         88  INVALID-ACCOUNT                     VALUE 'Y'.
   190     12  NEW-ACCOUNT-SW              PIC  X      VALUE ' '.
   191         88  NEW-ACCOUNT                         VALUE 'Y'.
   192     12  VALID-BILL-TYPE-VALUES      PIC  X      VALUE SPACE.
   193         88  VALID-BILL-TYPE                     VALUE  '1' '2'
   194                                                    '3' '4' '5'.
   195     12  BILL-BATCH-TRAILER-SW       PIC  X      VALUE SPACE.
   196         88  BILL-BATCH-TRAILER                  VALUE 'Y'.
   197     12  ERCOMM-FOUND-SW             PIC  X      VALUE SPACE.
   198         88  ERCOMM-FOUND                        VALUE 'Y'.
   199         88  ERCOMM-NOT-FOUND                    VALUE 'N'.
   200     12  ERCTBL-FOUND-SW             PIC  X      VALUE SPACE.
   201         88  ERCTBL-FOUND                        VALUE 'Y'.
   202         88  ERCTBL-NOT-FOUND                    VALUE 'N'.
   203     12  GXRF-EOF-SW                 PIC  X      VALUE SPACE.
   204         88  GXRF-EOF                            VALUE 'Y'.
   205     12  PNDB-EOF-SW                 PIC  X      VALUE SPACE.
   206         88  PNDB-EOF                            VALUE 'Y'.
   207     12  PYAJ-EOF-SW                 PIC  X      VALUE SPACE.
   208         88  PYAJ-EOF                            VALUE 'Y'.
   209     12  COMP-UPDATE-SW              PIC  X      VALUE SPACE.
   210         88  UPDATE-COMP-TOTALS                  VALUE 'Y'.
   211     12  LIMIT-BILLING-SW            PIC  X      VALUE SPACE.
   212         88  LIMIT-BILLING                       VALUE 'Y'.
   213     12  WS-PROCESS-SW               PIC  X      VALUE SPACE.
   214         88  DO-NOT-BILL-THIS-ACCT               VALUE 'Y'.
   215     12  NO-BILL-REC-SW              PIC  X      VALUE SPACE.
   216         88  NO-BILL-RECS                        VALUE 'Y'.
   217     12  DATA-VOIDED-SW              PIC  X      VALUE SPACE.
   218         88  DATA-VOIDED                         VALUE 'Y'.
   219     12  BATCHES-PROCESSED-SW        PIC  X      VALUE SPACE.
   220         88  MORE-THAN-6-BATCHES                 VALUE 'Y'.
   221     12  ACCOUNT-CARRY-BAL-SW        PIC  X      VALUE SPACE.
   222         88  ACCOUNT-CARRY-BAL                   VALUE 'Y'.
   223     12  BILLING-DETAIL-TYPE         PIC  XX VALUE SPACES.
   224         88  TOTAL-STATEMENT                     VALUE 'TS'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   7
* EL642.cbl
   225         88  TOTAL-ACCOUNT                       VALUE 'TA'.
   226         88  TOTAL-BOTH                          VALUE 'TB'.
   227         88  GEN-AGT-ADDRESS                     VALUE 'GA'.
   228     12  ELCNTL-UPDATE-SW            PIC  X      VALUE SPACE.
   229         88  ELCNTL-UPDATE                       VALUE 'Y'.
   230     12  WS-BILL-TYPE                PIC  X      VALUE SPACE.
   231         88  WS-UPDATE-FILES                     VALUE '3' '4'
   232                                                       '5'.
   233     12  SUB                     PIC S999 COMP-3 VALUE ZEROS.
   234     12  ACCOM-SUB               PIC  99 COMP VALUE ZEROS.
   235     12  GX-SUB                  PIC S9(4) COMP VALUE ZEROS.
   236     12  COMP-SUB                PIC S9(4) COMP VALUE ZEROS.
   237     12  CE-SUB                  PIC S9(4) COMP VALUE ZEROS.
   238     12  BEN-SUB                 PIC S9(4) COMP VALUE ZEROS.
   239     12  WORK-SEQ-NO             PIC S9(9) COMP-3.
   240     12  WS-ERROR-MSG.
   241         16  WS-ERROR-TEXT       PIC  X(35)      VALUE SPACES.
   242         16  WS-ERROR-BATCH      PIC  X(6)       VALUE SPACES.
   243         16  FILLER              PIC  X(24)      VALUE SPACES.
   244     12  WS-WORK-DATE.
   245         16  WS-MONTH            PIC  99         VALUE ZEROS.
   246         16  WS-DAY              PIC  99         VALUE ZEROS.
   247         16  WS-YEAR             PIC  99         VALUE ZEROS.
   248     12  WS-MONTH-END-DATE.
   249         16  WS-ME-YEAR          PIC  99         VALUE ZEROS.
   250         16  WS-ME-MONTH         PIC  99         VALUE ZEROS.
   251         16  WS-ME-DAY           PIC  99         VALUE ZEROS.
   252     12  WS-CURRENT-DATE         PIC  XX         VALUE SPACES.
   253     12  WS-CURRENT-DATE-MDY     PIC  X(6)       VALUE SPACES.
   254     12  WS-CURRENT-DATE-EDIT    PIC  X(8)       VALUE SPACES.
   255     12  WS-PREV-BILL-DATE       PIC  XX     VALUE LOW-VALUES.
   256     12  MONTHS-DIFF-LF          PIC S9(05).
   257     12  MONTHS-DIFF-AH          PIC S9(05).
   258     12  WS-LF-CANCEL-DATE.
   259         16  WS-LF-CANCEL-YR     PIC 99.
   260         16  WS-LF-CANCEL-MO     PIC 99.
   261         16  WS-LF-CANCEL-DA     PIC 99.
   262     12  WS-AH-CANCEL-DATE.
   263         16  WS-AH-CANCEL-YR     PIC 99.
   264         16  WS-AH-CANCEL-MO     PIC 99.
   265         16  WS-AH-CANCEL-DA     PIC 99.
   266     12  WS-EFFECT-DATE.
   267         16  WS-EFFECT-YR        PIC 99.
   268         16  WS-EFFECT-MO        PIC 99.
   269         16  WS-EFFECT-DA        PIC 99.
   270     12  WS-BEGIN-DATE.
   271         16  FILLER              PIC  X(3)       VALUE SPACES.
   272         16  WS-BEGIN-DAY        PIC  XX         VALUE SPACES.
   273         16  FILLER              PIC  X(3)       VALUE SPACES.
   274     12  PRINT-CONTROL.
   275         16  SINGLE-SPACE        PIC  X          VALUE SPACE.
   276         16  DOUBLE-SPACE        PIC  X          VALUE ZERO.
   277         16  TRIPLE-SPACE        PIC  X          VALUE '-'.
   278         16  SUPPRESS-SPACE      PIC  X          VALUE '+'.
   279         16  TOP-OF-PAGE         PIC  X          VALUE '1'.
   280     12  WS-EXP-DATE.
   281         16  WS-SAV-EXP-DT   OCCURS  10  TIMES
   282                 INDEXED BY  DTNDX   PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   8
* EL642.cbl
   283     12  WS-REMIT-TO.
   284         16  WS-SAV-REMIT-TO     OCCURS  10  TIMES
   285                 INDEXED BY  RTNDX   PIC  X(6).
   286     12  WORK-REMIT-TO           PIC  X(6)       VALUE SPACES.
   287     12  WS-REMITTED             PIC S9(6)V99    VALUE ZEROS.
   288     12  WS-LINECTR              PIC  99         VALUE ZEROS.
   289     12  WS-PGECTR               PIC  9(3)       VALUE 1.
   290     12  WS-LINE-SEQ-NO          PIC S9(4) COMP VALUE +1.
   291     12  WS-CARR-COMP.
   292         16  WS-CARRIER          PIC  X          VALUE SPACE.
   293         16  WS-COMP             PIC  X(3)       VALUE SPACES.
   294     12  WORK-AMT                PIC S9(7)V99    VALUE ZEROS.
   295     12  JOURNAL-LENGTH          PIC S9(4) COMP VALUE ZERO.
   296     12  LF-COMM-TBL-NO          PIC  X(3)       VALUE SPACES.
   297     12  JT-COMM-TBL-NO          PIC  X(3)       VALUE SPACES.
   298     12  AH-COMM-TBL-NO          PIC  X(3)       VALUE SPACES.
   299     12  AGENT-OWES              PIC  X(18)      VALUE
   300             'AGENT OWES       ='.
   301     12  OWED-TO-AGENT           PIC  X(18)      VALUE
   302             'OWED TO AGENT    ='.
   303     12  WS-PY-ENTRY-COMMENT.
   304         16  WS-PY-CURRENT-DATE  PIC  X(6).
   305         16  FILLER              PIC  X(14)      VALUE
   306                 ' CHK TO AGENT'.
   307     12  WS-ACCT-NOT-BILLED      PIC  X(18)      VALUE
   308             'ACCOUNT NOT BILLED'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   9
* EL642.cbl
   310     12  WS-AGENT-ADDR-AREA.
   311         16  WS-AGENT-LINES  OCCURS  6  TIMES
   312                 INDEXED BY  A-INDX.
   313             20  WS-AGENT-ZIP.
   314                 24  WS-AGENT-1ST-ZIP    PIC  X(4).
   315                 24  WS-AGENT-2ND-ZIP    PIC  X(5).
   316             20  FILLER                  PIC  X(12).
   317             20  WS-A-LAST-ZIP.
   318                 24  WS-A-LAST-1ST-ZIP   PIC  X(4).
   319                 24  WS-A-LAST-2ND-ZIP   PIC  X(5).
   320     12  WS-COMPENSATION-WORK-AREA.
   321         16  WS-COMM-CK-AMT      PIC S9(5)V99 COMP-3 VALUE +0.
   322         16  WS-COMM-AGE         PIC  99.
   323         16  WS-COMM-TERM        PIC  9(3).
   324         16  WS-LF-ISS-COMP      PIC S9(5)V99 COMP-3 VALUE +0.
   325         16  WS-AH-ISS-COMP      PIC S9(5)V99 COMP-3 VALUE +0.
   326         16  WS-I-LF-PREMIUM-AMT PIC S9(7)V99 COMP-3 VALUE +0.
   327         16  WS-I-AH-PREMIUM-AMT PIC S9(7)V99 COMP-3 VALUE +0.
   328         16  WS-I-LF-BENEFIT-AMT PIC S9(9)V99 COMP-3 VALUE +0.
   329         16  WS-I-AH-BENEFIT-AMT PIC S9(9)V99 COMP-3 VALUE +0.
   330         16  WS-C-LF-CANCEL-AMT  PIC S9(7)V99 COMP-3 VALUE +0.
   331         16  WS-C-AH-CANCEL-AMT  PIC S9(7)V99 COMP-3 VALUE +0.
   332         16  WS-WK-RATE          PIC SV9(5)    COMP-3 VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  10
* EL642.cbl
   334     12  WS-ACCOUNT-TOTALS       COMP-3.
   335         16  WS-ACCT-BEG-BAL         PIC S9(7)V99 VALUE ZEROS.
   336         16  WS-ACCT-NET-PREM        PIC S9(7)V99 VALUE ZEROS.
   337         16  WS-AH-ACCT-COMP         PIC S9(7)V99 VALUE ZEROS.
   338         16  WS-ACCT-COMP            PIC S9(7)V99 VALUE ZEROS.
   339         16  WS-ACCT-PAY-ADJS        PIC S9(7)V99 VALUE ZEROS.
   340         16  WS-ACCT-UNPAID-NET-PREM PIC S9(7)V99 VALUE ZEROS.
   341         16  WS-ACCT-LF-OVERWRITE    PIC S9(7)V99 VALUE ZEROS.
   342         16  WS-ACCT-AH-OVERWRITE    PIC S9(7)V99 VALUE ZEROS.
   343     12  WS-GENERAL-AGENT-TOTALS COMP-3.
   344         16  WS-GA-BEG-BAL           PIC S9(7)V99 VALUE ZEROS.
   345         16  WS-GA-NET-PREM          PIC S9(7)V99 VALUE ZEROS.
   346         16  WS-GA-COMP              PIC S9(7)V99 VALUE ZEROS.
   347         16  WS-GA-PAY-ADJS          PIC S9(7)V99 VALUE ZEROS.
   348         16  WS-GA-UNPAID-NET-PREM   PIC S9(7)V99 VALUE ZEROS.
   349         16  WS-GA-LF-OVERWRITE      PIC S9(7)V99 VALUE ZEROS.
   350         16  WS-GA-AH-OVERWRITE      PIC S9(7)V99 VALUE ZEROS.
   351         16  WS-GA-END-BAL           PIC S9(7)V99 VALUE ZEROS.
   352         16  WS-GA-AMT-DUE           PIC S9(7)V99 VALUE ZEROS.
   353     12  WS-GENERAL-AGENT-COMMISSIONS.
   354         16  WS-GA-LEVEL         PIC S99     COMP   VALUE +0.
   355         16  WS-GA-LF-COM        PIC SV9(5) COMP-3 VALUE +.0.
   356         16  WS-GA-AH-COM        PIC SV9(5) COMP-3 VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  11
* EL642.cbl
   358 01  ACCESS-KEYS.
   359     12  ERPNDB-PRIME-KEY.
   360         16  ERPNDB-CO-CD        PIC  X          VALUE SPACES.
   361         16  ERPNDB-BATCH        PIC  X(6)       VALUE SPACES.
   362         16  ERPNDB-SEQ-NO       PIC S9(4) COMP.
   363         16  ERPNDB-CHG-SEQ-NO   PIC S9(4) COMP.
   364     12  ERPNDB-LENGTH           PIC S9(4) COMP VALUE +585.
   365     12  ERPNDB-ALT-KEY.
   366         16  ERPNDB-CO-CD-A1     PIC  X          VALUE SPACES.
   367         16  ERPNDB-CARR         PIC  X          VALUE SPACES.
   368         16  ERPNDB-GROUP        PIC  X(6)       VALUE SPACES.
   369         16  ERPNDB-STATE        PIC  XX         VALUE SPACES.
   370         16  ERPNDB-ACCT         PIC  X(10)      VALUE SPACES.
   371         16  ERPNDB-EFF-DT       PIC  XX         VALUE SPACES.
   372         16  ERPNDB-CERT.
   373             20  ERPNDB-CERT-PRM PIC  X(10)      VALUE SPACES.
   374             20  ERPNDB-CERTSFX  PIC  X          VALUE SPACES.
   375         16  ERPNDB-ACHG-SEQ-NO  PIC S9(4) COMP.
   376         16  ERPNDB-REC-TYPE     PIC  X          VALUE SPACES.
   377     12  ELCNTL-KEY.
   378         16  ELCNTL-COMPANY-ID   PIC  X(3)       VALUE SPACES.
   379         16  ELCNTL-REC-TYPE     PIC  X          VALUE SPACES.
   380         16  ELCNTL-ACCESS.
   381             20  ELCNTL-FILLER   PIC  X(3)       VALUE SPACES.
   382             20  ELCNTL-CARRIER  PIC  X          VALUE SPACES.
   383         16  ELCNTL-SEQ-NO       PIC S9(4) COMP VALUE ZEROS.
   384     12  ELCNTL-BENEFIT-KEY.
   385         16  CLBENF-COMPANY-ID   PIC  X(3)       VALUE SPACES.
   386         16  CLBENF-REC-TYPE     PIC  X          VALUE SPACES.
   387         16  CLBENF-ACCESS.
   388             20  FILLER          PIC  XX         VALUE SPACES.
   389             20  CLBENF-CD       PIC  XX         VALUE SPACES.
   390         16  CLBENF-SEQ-NO       PIC S9(4) COMP VALUE ZEROS.
   391     12  ELCNTL-LENGTH           PIC S9(4) COMP VALUE +504.
   392     12  ERCOMP-KEY.
   393         16  ERCOMP-COMP-CD      PIC  X          VALUE SPACE.
   394         16  ERCOMP-CARRIER      PIC  X          VALUE SPACES.
   395         16  ERCOMP-GROUPING     PIC  X(6)       VALUE SPACES.
   396         16  ERCOMP-FIN-RESP     PIC  X(10)      VALUE SPACES.
   397         16  ERCOMP-ACCT         PIC  X(10)      VALUE SPACES.
   398         16  ERCOMP-RECORD-TYPE  PIC  X          VALUE SPACES.
   399     12  ERPYAJ-BROWSE-COMP-KEY.
   400         16  ERPYAJ-BR-COMP-CD   PIC  X          VALUE SPACE.
   401         16  ERPYAJ-BR-CARRIER   PIC  X          VALUE SPACES.
   402         16  ERPYAJ-BR-GROUPING  PIC  X(6)       VALUE SPACES.
   403         16  ERPYAJ-BR-FIN-RESP  PIC  X(10)      VALUE SPACES.
   404         16  ERPYAJ-BR-ACCOUNT   PIC  X(10)      VALUE SPACES.
   405     12  ERCOMP-PREV-KEY         PIC  X(29)      VALUE SPACES.
   406     12  ERCOMP-LENGTH           PIC S9(4) COMP VALUE +700.
   407     12  ERPYAJ-KEY.
   408         16  ERPYAJ-COMP-CD      PIC  X          VALUE SPACE.
   409         16  ERPYAJ-CARRIER      PIC  X          VALUE SPACES.
   410         16  ERPYAJ-GROUPING     PIC  X(6)       VALUE SPACES.
   411         16  ERPYAJ-FIN-RESP     PIC  X(10)      VALUE SPACES.
   412         16  ERPYAJ-ACCOUNT      PIC  X(10)      VALUE SPACES.
   413         16  ERPYAJ-FILE-SEQ-NO  PIC S9(8) COMP VALUE +0.
   414         16  ERPYAJ-RECORD-TYPE  PIC  X          VALUE SPACES.
   415     12  ERPYAJ-LENGTH           PIC S9(4) COMP VALUE +200.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  12
* EL642.cbl
   416     12  ERACCT-PRIME-KEY.
   417         16  ERACCT-P-CO-CD      PIC  X          VALUE SPACES.
   418         16  ERACCT-P-CARRIER    PIC  X          VALUE SPACES.
   419         16  ERACCT-P-GROUPING   PIC  X(6)       VALUE SPACES.
   420         16  ERACCT-P-STATE      PIC  XX         VALUE SPACES.
   421         16  ERACCT-P-ACCOUNT    PIC  X(10)      VALUE SPACES.
   422         16  ERACCT-P-EXP-DATE   PIC  XX         VALUE SPACES.
   423         16  FILLER              PIC  X(4)   VALUE LOW-VALUES.
   424     12  ERACCT-LENGTH           PIC S9(4) COMP VALUE +2000.
   425     12  ERACCT-ALT-KEY.
   426         16  ERACCT-A-CO-CD      PIC  X          VALUE SPACES.
   427         16  ERACCT-A-CARRIER    PIC  X          VALUE SPACES.
   428         16  ERACCT-A-GROUPING   PIC  X(6)       VALUE SPACES.
   429         16  ERACCT-A-STATE      PIC  XX         VALUE SPACES.
   430         16  ERACCT-A-ACCOUNT    PIC  X(10)      VALUE SPACES.
   431         16  ERACCT-A-EXP-DATE   PIC  XX         VALUE SPACES.
   432         16  FILLER              PIC  X(4)   VALUE LOW-VALUES.
   433     12  ERBILL-KEY.
   434         16  ERBILL-CO-CD        PIC  X.
   435         16  ERBILL-CARRIER      PIC  X.
   436         16  ERBILL-GROUP        PIC  X(6).
   437         16  ERBILL-ACCT         PIC  X(10).
   438         16  ERBILL-FIN-RESP     PIC  X(10).
   439         16  ERBILL-REC-TYPE     PIC  X.
   440         16  ERBILL-LINE-SEQ-NO  PIC S9(4) COMP.
   441     12  ERBILL-LENGTH           PIC S9(4) COMP VALUE +210.
   442     12  ERGXRF-KEY.
   443         16  ERGXRF-COMPANY-CD   PIC  X.
   444         16  ERGXRF-CARRIER      PIC  X.
   445         16  ERGXRF-GROUPING     PIC  X(6).
   446         16  ERGXRF-AGENT-NO     PIC  X(10).
   447     12  ERGXRF-FIXED-LENGTH     PIC S9(4) COMP VALUE +64.
   448     12  ERGXRF-VAR-LENGTH       PIC S9(4) COMP VALUE +24.
   449     12  ERGXRF-LENGTH           PIC S9(4) COMP VALUE ZEROS.
   450     12  ERCOMM-KEY.
   451         16  ERCOMM-COMPANY-CD   PIC  X.
   452         16  ERCOMM-CARRIER      PIC  X.
   453         16  ERCOMM-GROUPING     PIC  X(6).
   454         16  ERCOMM-STATE        PIC  XX.
   455         16  ERCOMM-ACCOUNT      PIC  X(10).
   456         16  ERCOMM-CERT-EFF-DT  PIC  XX.
   457         16  ERCOMM-CERT-NO.
   458             20  CE-CERT-PRIME   PIC  X(10).
   459             20  CE-CERT-SFX     PIC  X.
   460     12  ERCOMM-LENGTH           PIC S9(4) COMP VALUE +250.
   461     12  ERCTBL-KEY.
   462         16  ERCTBL-COMPANY-CD       PIC  X.
   463         16  ERCTBL-TABLE            PIC  X(3).
   464         16  ERCTBL-CNTRL-2.
   465             20  ERCTBL-BEN-TYPE     PIC  X.
   466             20  ERCTBL-BEN-CODE     PIC  XX.
   467     12  ERCTBL-LENGTH               PIC S9(4) COMP VALUE +200.
   468     12  SAVE-ERACCT-PRIME-KEY.
   469         16  SV-ERACCT-P-CO-CD       PIC  X      VALUE SPACES.
   470         16  SV-ERACCT-P-CARRIER     PIC  X      VALUE SPACES.
   471         16  SV-ERACCT-P-GROUPING    PIC  X(6)   VALUE SPACES.
   472         16  SV-ERACCT-P-STATE       PIC  XX     VALUE SPACES.
   473         16  SV-ERACCT-P-ACCOUNT     PIC  X(10)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  13
* EL642.cbl
   474         16  SV-ERACCT-P-EXP-DATE    PIC  XX     VALUE SPACES.
   475*****************************************************************
   476*      START OF WORKING STORAGE FOR CLIENT-DMD                  *
   477*****************************************************************
   478*RESIDENT STATE TAXES MASTER(ERRESC)
   479*
   480     12  WS-SV-ERRESC-KEY             PIC X(32).
   481
   482     12  WS-ERRESC-KEY.
   483         16 WS-ERRESC-SEARCH-KEY.
   484             20  WS-ERRESC-COMPANY-CD PIC  X.
   485             20  WS-ERRESC-CARRIER    PIC  X.
   486             20  WS-ERRESC-GROUP      PIC X(6).
   487             20  WS-ERRESC-STATE      PIC XX.
   488             20  WS-ERRESC-ACCOUNT    PIC X(10).
   489         16 WS-ERRESC-RESIDUAL-KEY.
   490             20  WS-ERRESC-AGENT      PIC X(10).
   491             20  WS-ERRESC-RES-STATE  PIC XX.
   492             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   493*                                          YYYYMMDD
   494     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   495     12  WS-SUB1                      PIC    S99 COMP-3.
   496     12  WS-SUB                       PIC    S99 COMP-3.
   497     12  WS-CONTRACT-DATE             PIC 9(8).
   498     12  WS-COMM-SW                   PIC XX VALUE SPACES.
   499         88  AH-COMM                             VALUE 'AH'.
   500         88  LF-COMM                             VALUE 'LF'.
   501*****************************************************************
   502*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   503*****************************************************************
   504
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  14
* EL642.cbl
   506 01  ERROR-NUMBERS.
   507     12  ER-0004             PIC  X(4)           VALUE '0004'.
   508     12  ER-0008             PIC  X(4)           VALUE '0008'.
   509     12  ER-0022             PIC  X(4)           VALUE '0022'.
   510     12  ER-0028             PIC  X(4)           VALUE '0028'.
   511     12  ER-0029             PIC  X(4)           VALUE '0029'.
   512     12  ER-0070             PIC  X(4)           VALUE '0070'.
   513     12  ER-0194             PIC  X(4)           VALUE '0194'.
   514     12  ER-0195             PIC  X(4)           VALUE '0195'.
   515     12  ER-0196             PIC  X(4)           VALUE '0196'.
   516     12  ER-0197             PIC  X(4)           VALUE '0197'.
   517     12  ER-2208             PIC  X(4)           VALUE '2208'.
   518     12  ER-2210             PIC  X(4)           VALUE '2210'.
   519     12  ER-2215             PIC  X(4)           VALUE '2215'.
   520     12  ER-2230             PIC  X(4)           VALUE '2230'.
   521     12  ER-2233             PIC  X(4)           VALUE '2233'.
   522     12  ER-2370             PIC  X(4)           VALUE '2370'.
   523     12  ER-2371             PIC  X(4)           VALUE '2371'.
   524     12  ER-2249             PIC  X(4)           VALUE '2249'.
   525     12  ER-2250             PIC  X(4)           VALUE '2250'.
   526     12  ER-2383             PIC  X(4)           VALUE '2383'.
   527     12  ER-2385             PIC  X(4)           VALUE '2385'.
   528     12  ER-2399             PIC  X(4)           VALUE '2399'.
   529     12  ER-2400             PIC  X(4)           VALUE '2400'.
   530     12  ER-2401             PIC  X(4)           VALUE '2401'.
   531     12  ER-2403             PIC  X(4)           VALUE '2403'.
   532     12  ER-2404             PIC  X(4)           VALUE '2404'.
   533     12  ER-2405             PIC  X(4)           VALUE '2405'.
   534     12  ER-2406             PIC  X(4)           VALUE '2406'.
   535     12  ER-2407             PIC  X(4)           VALUE '2407'.
   536     12  ER-2408             PIC  X(4)           VALUE '2408'.
   537     12  ER-2409             PIC  X(4)           VALUE '2409'.
   538     12  ER-2411             PIC  X(4)           VALUE '2411'.
   539     12  ER-2421             PIC  X(4)           VALUE '2421'.
   540     12  ER-2434             PIC  X(4)           VALUE '2434'.
   541     12  ER-2435             PIC  X(4)           VALUE '2435'.
   542     12  ER-2436             PIC  X(4)           VALUE '2436'.
   543     12  ER-2438             PIC  X(4)           VALUE '2438'.
   544     12  ER-2439             PIC  X(4)           VALUE '2439'.
   545     12  ER-2443             PIC  X(4)           VALUE '2443'.
   546     12  ER-2472             PIC  X(4)           VALUE '2472'.
   547     12  ER-2564             PIC  X(4)           VALUE '2564'.
   548     12  ER-2570             PIC  X(4)           VALUE '2570'.
   549     12  ER-2571             PIC  X(4)           VALUE '2571'.
   550     12  ER-2590             PIC  X(4)           VALUE '2571'.
   551     12  ER-2597             PIC  X(4)           VALUE '2597'.
   552     12  ER-2910             PIC  X(4)           VALUE '2910'.
   553     12  ER-2911             PIC  X(4)           VALUE '2911'.
   554     12  ER-2912             PIC  X(4)           VALUE '2912'.
   555     12  ER-2913             PIC  X(4)           VALUE '2913'.
   556     12  ER-2914             PIC  X(4)           VALUE '2914'.
   557     12  ER-2915             PIC  X(4)           VALUE '2915'.
   558     12  ER-2916             PIC  X(4)           VALUE '2916'.
   559     12  ER-2917             PIC  X(4)           VALUE '2917'.
   560     12  ER-2918             PIC  X(4)           VALUE '2918'.
   561     12  ER-3145             PIC  X(4)           VALUE '3145'.
   562     12  ER-3165             PIC  X(4)           VALUE '3165'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  15
* EL642.cbl
   564 01  CENTER-DATA-WORK-AREA.
   565     12  X1                  PIC S9(4)   COMP    VALUE +0.
   566     12  X2                  PIC S9(4)   COMP    VALUE +0.
   567     12  X3                  PIC S9(4)   COMP    VALUE +0.
   568     12  X-LEN               PIC S9(4)   COMP    VALUE +0.
   569     12  CENTER-WORK-1.
   570         16  CW1-PIC         PIC  X      OCCURS  44  TIMES.
   571     12  CENTER-WORK-2.
   572         16  CW2-PIC         PIC  X      OCCURS  44  TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  16
* EL642.cbl
   574 01  GA-REPORT-HEADINGS.
   575     12  GA-PREVIEW-HD.
   576         16  FILLER          PIC  X(44)          VALUE
   577                 '                                          **'.
   578         16  FILLER          PIC  X(45)          VALUE
   579                 '** STATEMENT IS FOR REVIEW PURPOSES ONLY ***'.
   580         16  FILLER          PIC  X(44)          VALUE
   581                 '*                                           '.
   582     12  GA-HD1.
   583         16  FILLER          PIC  X(44)          VALUE SPACES.
   584         16  FILLER          PIC  X(44)          VALUE
   585                 '            AGENT    STATEMENT              '.
   586         16  FILLER          PIC  X(37)          VALUE SPACES.
   587         16  FILLER          PIC  X(7)           VALUE ' EL642 '.
   588     12  GA-HD2.
   589         16  FILLER          PIC  X(43)          VALUE SPACES.
   590         16  HD-CO           PIC  X(44)          VALUE SPACES.
   591         16  FILLER          PIC  X(37)          VALUE SPACES.
   592         16  HD-RUN-DT       PIC  X(8)           VALUE SPACES.
   593     12  GA-HD3.
   594         16  FILLER          PIC  X(57)          VALUE SPACES.
   595         16  HD-DT           PIC  X(18)          VALUE SPACES.
   596         16  FILLER          PIC  X(37)          VALUE SPACES.
   597         16  FILLER          PIC  X(5)           VALUE 'PAGE '.
   598         16  HD-PG           PIC ZZ,ZZ9.
   599     12  GA-HD4.
   600         16  FILLER          PIC  X(44)          VALUE
   601                 ' ------------- A C C O U N T -------------  '.
   602         16  FILLER          PIC  X(44)          VALUE
   603                 'BEGINNING      NET       ACCOUNT    PAYMENTS'.
   604         16  FILLER          PIC  X(44)          VALUE
   605                 '     UNPAID                          AMT.   '.
   606     12  GA-HD5.
   607         16  FILLER          PIC  X(44)          VALUE
   608                 '   NUMBER                 NAME              '.
   609         16  FILLER          PIC  X(44)          VALUE
   610                 ' BALANCE     PREMIUM     COMPENS.   ADJUSTS.'.
   611         16  FILLER          PIC  X(44)          VALUE
   612                 '  NET PREMIUM  BENEFIT  OVERWRITE    DUE    '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  17
* EL642.cbl
   614*                            COPY ELCDATE.
   615******************************************************************
   616*                                                                *
   617*                                                                *
   618*                            ELCDATE.                            *
   619*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   620*                            VMOD=2.003
   621*                                                                *
   622*                                                                *
   623*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   624*                 LENGTH = 200                                   *
   625******************************************************************
   626
   627 01  DATE-CONVERSION-DATA.
   628     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   629     12  DC-OPTION-CODE                PIC X.
   630         88  BIN-TO-GREG                VALUE ' '.
   631         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   632         88  EDIT-GREG-TO-BIN           VALUE '2'.
   633         88  YMD-GREG-TO-BIN            VALUE '3'.
   634         88  MDY-GREG-TO-BIN            VALUE '4'.
   635         88  JULIAN-TO-BIN              VALUE '5'.
   636         88  BIN-PLUS-ELAPSED           VALUE '6'.
   637         88  FIND-CENTURY               VALUE '7'.
   638         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   639         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   640         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   641         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   642         88  JULIAN-TO-BIN-3            VALUE 'C'.
   643         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   644         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   645         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   646         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   647         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   648         88  CHECK-LEAP-YEAR            VALUE 'H'.
   649         88  BIN-3-TO-GREG              VALUE 'I'.
   650         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   651         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   652         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   653         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   654         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   655         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   656         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   657         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   658         88  THREE-CHARACTER-BIN
   659                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   660         88  GREGORIAN-TO-BIN
   661                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   662         88  BIN-TO-GREGORIAN
   663                  VALUES ' ' '1' 'I' '8' 'G'.
   664         88  JULIAN-TO-BINARY
   665                  VALUES '5' 'C' 'E' 'F'.
   666     12  DC-ERROR-CODE                 PIC X.
   667         88  NO-CONVERSION-ERROR        VALUE ' '.
   668         88  DATE-CONVERSION-ERROR
   669                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   670         88  DATE-IS-ZERO               VALUE '1'.
   671         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  18
* EL642.cbl
   672         88  DATE-IS-INVALID            VALUE '3'.
   673         88  DATE1-GREATER-DATE2        VALUE '4'.
   674         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   675         88  DATE-INVALID-OPTION        VALUE '9'.
   676         88  INVALID-CENTURY            VALUE 'A'.
   677         88  ONLY-CENTURY               VALUE 'B'.
   678         88  ONLY-LEAP-YEAR             VALUE 'C'.
   679         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   680     12  DC-END-OF-MONTH               PIC X.
   681         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   682     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   683         88  USE-NORMAL-PROCESS         VALUE ' '.
   684         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   685         88  ADJUST-UP-100-YRS          VALUE '2'.
   686     12  FILLER                        PIC X.
   687     12  DC-CONVERSION-DATES.
   688         16  DC-BIN-DATE-1             PIC XX.
   689         16  DC-BIN-DATE-2             PIC XX.
   690         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   691         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   692                       DC-GREG-DATE-1-EDIT.
   693             20  DC-EDIT1-MONTH        PIC 99.
   694             20  SLASH1-1              PIC X.
   695             20  DC-EDIT1-DAY          PIC 99.
   696             20  SLASH1-2              PIC X.
   697             20  DC-EDIT1-YEAR         PIC 99.
   698         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   699         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   700                     DC-GREG-DATE-2-EDIT.
   701             20  DC-EDIT2-MONTH        PIC 99.
   702             20  SLASH2-1              PIC X.
   703             20  DC-EDIT2-DAY          PIC 99.
   704             20  SLASH2-2              PIC X.
   705             20  DC-EDIT2-YEAR         PIC 99.
   706         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   707         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   708                     DC-GREG-DATE-1-YMD.
   709             20  DC-YMD-YEAR           PIC 99.
   710             20  DC-YMD-MONTH          PIC 99.
   711             20  DC-YMD-DAY            PIC 99.
   712         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   713         16  DC-GREG-DATE-1-MDY-R REDEFINES
   714                      DC-GREG-DATE-1-MDY.
   715             20  DC-MDY-MONTH          PIC 99.
   716             20  DC-MDY-DAY            PIC 99.
   717             20  DC-MDY-YEAR           PIC 99.
   718         16  DC-GREG-DATE-1-ALPHA.
   719             20  DC-ALPHA-MONTH        PIC X(10).
   720             20  DC-ALPHA-DAY          PIC 99.
   721             20  FILLER                PIC XX.
   722             20  DC-ALPHA-CENTURY.
   723                 24 DC-ALPHA-CEN-N     PIC 99.
   724             20  DC-ALPHA-YEAR         PIC 99.
   725         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   726         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   727         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   728         16  DC-JULIAN-DATE            PIC 9(05).
   729         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  19
* EL642.cbl
   730                                       PIC 9(05).
   731         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   732             20  DC-JULIAN-YEAR        PIC 99.
   733             20  DC-JULIAN-DAYS        PIC 999.
   734         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   735         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   736         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   737     12  DATE-CONVERSION-VARIBLES.
   738         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   739         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   740             20  FILLER                PIC 9(3).
   741             20  HOLD-CEN-1-CCYY.
   742                 24  HOLD-CEN-1-CC     PIC 99.
   743                 24  HOLD-CEN-1-YY     PIC 99.
   744             20  HOLD-CEN-1-MO         PIC 99.
   745             20  HOLD-CEN-1-DA         PIC 99.
   746         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   747             20  HOLD-CEN-1-R-MO       PIC 99.
   748             20  HOLD-CEN-1-R-DA       PIC 99.
   749             20  HOLD-CEN-1-R-CCYY.
   750                 24  HOLD-CEN-1-R-CC   PIC 99.
   751                 24  HOLD-CEN-1-R-YY   PIC 99.
   752             20  FILLER                PIC 9(3).
   753         16  HOLD-CENTURY-1-X.
   754             20  FILLER                PIC X(3)  VALUE SPACES.
   755             20  HOLD-CEN-1-X-CCYY.
   756                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   757                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   758             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   759             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   760         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   761             20  HOLD-CEN-1-R-X-MO     PIC XX.
   762             20  HOLD-CEN-1-R-X-DA     PIC XX.
   763             20  HOLD-CEN-1-R-X-CCYY.
   764                 24  HOLD-CEN-1-R-X-CC PIC XX.
   765                 24  HOLD-CEN-1-R-X-YY PIC XX.
   766             20  FILLER                PIC XXX.
   767         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   768         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   769         16  DC-JULIAN-DATE-1          PIC 9(07).
   770         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   771             20  DC-JULIAN-1-CCYY.
   772                 24  DC-JULIAN-1-CC    PIC 99.
   773                 24  DC-JULIAN-1-YR    PIC 99.
   774             20  DC-JULIAN-DA-1        PIC 999.
   775         16  DC-JULIAN-DATE-2          PIC 9(07).
   776         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   777             20  DC-JULIAN-2-CCYY.
   778                 24  DC-JULIAN-2-CC    PIC 99.
   779                 24  DC-JULIAN-2-YR    PIC 99.
   780             20  DC-JULIAN-DA-2        PIC 999.
   781         16  DC-GREG-DATE-A-EDIT.
   782             20  DC-EDITA-MONTH        PIC 99.
   783             20  SLASHA-1              PIC X VALUE '/'.
   784             20  DC-EDITA-DAY          PIC 99.
   785             20  SLASHA-2              PIC X VALUE '/'.
   786             20  DC-EDITA-CCYY.
   787                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  20
* EL642.cbl
   788                 24  DC-EDITA-YEAR     PIC 99.
   789         16  DC-GREG-DATE-B-EDIT.
   790             20  DC-EDITB-MONTH        PIC 99.
   791             20  SLASHB-1              PIC X VALUE '/'.
   792             20  DC-EDITB-DAY          PIC 99.
   793             20  SLASHB-2              PIC X VALUE '/'.
   794             20  DC-EDITB-CCYY.
   795                 24  DC-EDITB-CENT     PIC 99.
   796                 24  DC-EDITB-YEAR     PIC 99.
   797         16  DC-GREG-DATE-CYMD         PIC 9(08).
   798         16  DC-GREG-DATE-CYMD-R REDEFINES
   799                              DC-GREG-DATE-CYMD.
   800             20  DC-CYMD-CEN           PIC 99.
   801             20  DC-CYMD-YEAR          PIC 99.
   802             20  DC-CYMD-MONTH         PIC 99.
   803             20  DC-CYMD-DAY           PIC 99.
   804         16  DC-GREG-DATE-MDCY         PIC 9(08).
   805         16  DC-GREG-DATE-MDCY-R REDEFINES
   806                              DC-GREG-DATE-MDCY.
   807             20  DC-MDCY-MONTH         PIC 99.
   808             20  DC-MDCY-DAY           PIC 99.
   809             20  DC-MDCY-CEN           PIC 99.
   810             20  DC-MDCY-YEAR          PIC 99.
   811    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   812        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   813    12  DC-EL310-DATE                  PIC X(21).
   814    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  21
* EL642.cbl
   816*                            COPY ELCLOGOF.
   817******************************************************************
   818*                                                                *
   819*                                                                *
   820*                            ELCLOGOF.                           *
   821*                            VMOD=2.001                          *
   822*                                                                *
   823*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   824*                                                                *
   825******************************************************************
   826 01  CLASIC-LOGOFF.
   827     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   828     12  LOGOFF-TEXT.
   829         16  FILLER          PIC X(5)    VALUE SPACES.
   830         16  LOGOFF-MSG.
   831             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   832             20  FILLER      PIC X       VALUE SPACES.
   833             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   834         16  FILLER          PIC X(80)
   835           VALUE '* YOU ARE NOW LOGGED OFF'.
   836         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   837         16  FILLER          PIC X       VALUE QUOTE.
   838         16  LOGOFF-SYS-MSG  PIC X(17)
   839           VALUE 'S CLAS-IC SYSTEM '.
   840     12  TEXT-MESSAGES.
   841         16  UNACCESS-MSG    PIC X(29)
   842             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   843         16  PGMIDERR-MSG    PIC X(17)
   844             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  22
* EL642.cbl
   846*                            COPY ELCATTR.
   847******************************************************************
   848*                                                                *
   849*                            ELCATTR.                            *
   850*                            VMOD=2.001                          *
   851*                                                                *
   852*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   853*                                                                *
   854*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   855*                                                                *
   856*                   POS 1   P=PROTECTED                          *
   857*                           U=UNPROTECTED                        *
   858*                           S=ASKIP                              *
   859*                   POS 2   A=ALPHA/NUMERIC                      *
   860*                           N=NUMERIC                            *
   861*                   POS 3   N=NORMAL                             *
   862*                           B=BRIGHT                             *
   863*                           D=DARK                               *
   864*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   865*                           OF=MODIFIED DATA TAG OFF             *
   866*                                                                *
   867*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   868******************************************************************
   869 01  ATTRIBUTE-LIST.
   870     12  AL-PABOF            PIC X       VALUE 'Y'.
   871     12  AL-PABON            PIC X       VALUE 'Z'.
   872     12  AL-PADOF            PIC X       VALUE '%'.
   873     12  AL-PADON            PIC X       VALUE '_'.
   874     12  AL-PANOF            PIC X       VALUE '-'.
   875     12  AL-PANON            PIC X       VALUE '/'.
   876     12  AL-SABOF            PIC X       VALUE '8'.
   877     12  AL-SABON            PIC X       VALUE '9'.
   878     12  AL-SADOF            PIC X       VALUE '@'.
   879     12  AL-SADON            PIC X       VALUE QUOTE.
   880     12  AL-SANOF            PIC X       VALUE '0'.
   881     12  AL-SANON            PIC X       VALUE '1'.
   882     12  AL-UABOF            PIC X       VALUE 'H'.
   883     12  AL-UABON            PIC X       VALUE 'I'.
   884     12  AL-UADOF            PIC X       VALUE '<'.
   885     12  AL-UADON            PIC X       VALUE '('.
   886     12  AL-UANOF            PIC X       VALUE ' '.
   887     12  AL-UANON            PIC X       VALUE 'A'.
   888     12  AL-UNBOF            PIC X       VALUE 'Q'.
   889     12  AL-UNBON            PIC X       VALUE 'R'.
   890     12  AL-UNDOF            PIC X       VALUE '*'.
   891     12  AL-UNDON            PIC X       VALUE ')'.
   892     12  AL-UNNOF            PIC X       VALUE '&'.
   893     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  23
* EL642.cbl
   895*                            COPY ELCEMIB.
   896******************************************************************
   897*                                                                *
   898*                                                                *
   899*                            ELCEMIB.                            *
   900*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   901*                            VMOD=2.005                          *
   902*                                                                *
   903*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   904*                                                                *
   905******************************************************************
   906 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   907     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   908     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   909     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   910     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   911     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   912     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   913     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   914     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   915     12  EMI-SWITCH1             PIC X        VALUE '1'.
   916         88  EMI-NO-ERRORS                    VALUE '1'.
   917         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   918         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   919     12  EMI-SWITCH2             PIC X        VALUE '1'.
   920         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   921     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   922         88  EMI-AREA1-EMPTY                  VALUE '1'.
   923         88  EMI-AREA1-FULL                   VALUE '2'.
   924     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   925         88  EMI-AREA2-EMPTY                  VALUE '1'.
   926         88  EMI-AREA2-FULL                   VALUE '2'.
   927     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   928         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   929         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   930         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   931         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   932         88  EMI-BYPASS-FATALS                VALUE 'X'.
   933     12  EMI-ERROR-LINES.
   934         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   935         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   936         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   937         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   938             20  EMI-ERR-CODES OCCURS 10 TIMES.
   939                 24  EMI-ERR-NUM         PIC X(4).
   940                 24  EMI-FILLER          PIC X.
   941                 24  EMI-SEV             PIC X.
   942                 24  FILLER              PIC X.
   943             20  FILLER                  PIC X(02).
   944     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   945         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   946             20  EMI-ERROR-NUMBER    PIC X(4).
   947             20  EMI-FILL            PIC X.
   948             20  EMI-SEVERITY        PIC X.
   949             20  FILLER              PIC X.
   950             20  EMI-ERROR-TEXT.
   951                 24  EMI-TEXT-VARIABLE   PIC X(10).
   952                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  24
* EL642.cbl
   953     12  EMI-SEVERITY-SAVE           PIC X.
   954         88  EMI-NOTE                    VALUE 'N'.
   955         88  EMI-WARNING                 VALUE 'W'.
   956         88  EMI-FORCABLE                VALUE 'F'.
   957         88  EMI-FATAL                   VALUE 'X'.
   958     12  EMI-MESSAGE-FLAG            PIC X.
   959         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   960         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   961     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   962     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   963         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   964         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   965         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   966     12  emi-claim-no                pic x(7).
   967     12  emi-claim-type              pic x(6).
   968     12  FILLER                      PIC X(124)  VALUE SPACES.
   969     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   970     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   971     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   972     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  25
* EL642.cbl
   974*                            COPY ELCINTF.
   975******************************************************************
   976*                                                                *
   977*                                                                *
   978*                            ELCINTF.                            *
   979*                            VMOD=2.017                          *
   980*                                                                *
   981*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   982*                                                                *
   983*       LENGTH = 1024                                            *
   984*                                                                *
   985******************************************************************
   986*                   C H A N G E   L O G
   987*
   988* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   989*-----------------------------------------------------------------
   990*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   991* EFFECTIVE    NUMBER
   992*-----------------------------------------------------------------
   993* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   994******************************************************************
   995 01  PROGRAM-INTERFACE-BLOCK.
   996     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   997     12  PI-CALLING-PROGRAM              PIC X(8).
   998     12  PI-SAVED-PROGRAM-1              PIC X(8).
   999     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1000     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1001     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1002     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1003     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1004     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1005     12  PI-COMPANY-ID                   PIC XXX.
  1006     12  PI-COMPANY-CD                   PIC X.
  1007
  1008     12  PI-COMPANY-PASSWORD             PIC X(8).
  1009
  1010     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1011
  1012     12  PI-CONTROL-IN-PROGRESS.
  1013         16  PI-CARRIER                  PIC X.
  1014         16  PI-GROUPING                 PIC X(6).
  1015         16  PI-STATE                    PIC XX.
  1016         16  PI-ACCOUNT                  PIC X(10).
  1017         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1018                                         PIC X(10).
  1019         16  PI-CLAIM-CERT-GRP.
  1020             20  PI-CLAIM-NO             PIC X(7).
  1021             20  PI-CERT-NO.
  1022                 25  PI-CERT-PRIME       PIC X(10).
  1023                 25  PI-CERT-SFX         PIC X.
  1024             20  PI-CERT-EFF-DT          PIC XX.
  1025         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1026             20  PI-PLAN-CODE            PIC X(2).
  1027             20  PI-REVISION-NUMBER      PIC X(3).
  1028             20  PI-PLAN-EFF-DT          PIC X(2).
  1029             20  PI-PLAN-EXP-DT          PIC X(2).
  1030             20  FILLER                  PIC X(11).
  1031         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  26
* EL642.cbl
  1032             20  PI-OE-REFERENCE-1.
  1033                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1034                 25  PI-OE-REF-1-SUFF    PIC XX.
  1035
  1036     12  PI-SESSION-IN-PROGRESS          PIC X.
  1037         88  CLAIM-SESSION                   VALUE '1'.
  1038         88  CREDIT-SESSION                  VALUE '2'.
  1039         88  WARRANTY-SESSION                VALUE '3'.
  1040         88  MORTGAGE-SESSION                VALUE '4'.
  1041         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1042
  1043
  1044*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1045
  1046     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1047     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1048
  1049     12  PI-CREDIT-USER                  PIC X.
  1050         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1051         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1052
  1053     12  PI-CLAIM-USER                   PIC X.
  1054         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1055         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1056
  1057     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1058         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1059         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1060         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1061         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1062         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1063
  1064     12  PI-PROCESSOR-ID                 PIC X(4).
  1065
  1066     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1067
  1068     12  PI-MEMBER-CAPTION               PIC X(10).
  1069
  1070     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1071         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1072
  1073     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1074     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1075     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1076     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1077
  1078     12  PI-AH-OVERRIDE-L1               PIC X.
  1079     12  PI-AH-OVERRIDE-L2               PIC XX.
  1080     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1081     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1082
  1083     12  PI-NEW-SYSTEM                   PIC X(2).
  1084
  1085     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1086     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1087         88  PI-USES-PAID-TO                 VALUE '1'.
  1088     12  PI-CRDTCRD-SYSTEM.
  1089         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  27
* EL642.cbl
  1090             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1091             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1092         16  PI-CC-MONTH-END-DT          PIC XX.
  1093     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1094
  1095     12  PI-OE-REFERENCE-2.
  1096         16  PI-OE-REF-2-PRIME           PIC X(10).
  1097         16  PI-OE-REF-2-SUFF            PIC X.
  1098
  1099     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1100
  1101     12  PI-LANGUAGE-TYPE                PIC X.
  1102             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1103             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1104             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1105
  1106     12  PI-POLICY-LINKAGE-IND           PIC X.
  1107         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1108         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1109                                                   LOW-VALUES.
  1110
  1111     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1112     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1113         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1114         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1115
  1116     12  PI-PROCESSOR-CSR-IND            PIC X.
  1117         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1118         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1119
  1120     12  FILLER                          PIC X(3).
  1121
  1122     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1123
  1124     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1125         PI-SYSTEM-LEVEL.
  1126
  1127         16  PI-ENTRY-CODES.
  1128             20  PI-ENTRY-CD-1           PIC X.
  1129             20  PI-ENTRY-CD-2           PIC X.
  1130
  1131         16  PI-RETURN-CODES.
  1132             20  PI-RETURN-CD-1          PIC X.
  1133             20  PI-RETURN-CD-2          PIC X.
  1134
  1135         16  PI-UPDATE-STATUS-SAVE.
  1136             20  PI-UPDATE-BY            PIC X(4).
  1137             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1138
  1139         16  PI-LOWER-CASE-LETTERS       PIC X.
  1140             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1141
  1142*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1143*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1144*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1145
  1146         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1147             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  28
* EL642.cbl
  1148             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1149             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1150             88  ACCNT-CNTL                  VALUE '3'.
  1151             88  CARR-ACCNT-CNTL             VALUE '4'.
  1152
  1153         16  PI-PROCESSOR-CAP-LIST.
  1154             20  PI-SYSTEM-CONTROLS.
  1155                24 PI-SYSTEM-DISPLAY     PIC X.
  1156                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1157                24 PI-SYSTEM-MODIFY      PIC X.
  1158                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1159             20  FILLER                  PIC XX.
  1160             20  PI-DISPLAY-CAP          PIC X.
  1161                 88  DISPLAY-CAP             VALUE 'Y'.
  1162             20  PI-MODIFY-CAP           PIC X.
  1163                 88  MODIFY-CAP              VALUE 'Y'.
  1164             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1165                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1166             20  PI-FORCE-CAP            PIC X.
  1167                 88  FORCE-CAP               VALUE 'Y'.
  1168
  1169         16  PI-PROGRAM-CONTROLS.
  1170             20  PI-PGM-PRINT-OPT        PIC X.
  1171             20  PI-PGM-FORMAT-OPT       PIC X.
  1172             20  PI-PGM-PROCESS-OPT      PIC X.
  1173             20  PI-PGM-TOTALS-OPT       PIC X.
  1174
  1175         16  PI-HELP-INTERFACE.
  1176             20  PI-LAST-ERROR-NO        PIC X(4).
  1177             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1178
  1179         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1180             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1181
  1182         16  PI-CR-CONTROL-IN-PROGRESS.
  1183             20  PI-CR-CARRIER           PIC X.
  1184             20  PI-CR-GROUPING          PIC X(6).
  1185             20  PI-CR-STATE             PIC XX.
  1186             20  PI-CR-ACCOUNT           PIC X(10).
  1187             20  PI-CR-FIN-RESP          PIC X(10).
  1188             20  PI-CR-TYPE              PIC X.
  1189
  1190         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1191
  1192         16  PI-CR-MONTH-END-DT          PIC XX.
  1193
  1194         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1195             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1196             88  PI-ZERO-CARRIER             VALUE '1'.
  1197             88  PI-ZERO-GROUPING            VALUE '2'.
  1198             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1199
  1200         16  PI-CARRIER-SECURITY         PIC X.
  1201             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1202
  1203         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1204             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1205             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  29
* EL642.cbl
  1206
  1207         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1208             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1209                                         INDEXED BY PI-ACCESS-NDX
  1210                                         PIC X.
  1211
  1212         16  PI-GA-BILLING-CONTROL       PIC X.
  1213             88  PI-GA-BILLING               VALUE '1'.
  1214
  1215         16  PI-MAIL-PROCESSING          PIC X.
  1216             88  PI-MAIL-YES                 VALUE 'Y'.
  1217
  1218         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1219
  1220         16  PI-AR-SYSTEM.
  1221             20  PI-AR-PROCESSING-CNTL   PIC X.
  1222                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1223             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1224             20  PI-AR-MONTH-END-DT      PIC XX.
  1225
  1226         16  PI-MP-SYSTEM.
  1227             20  PI-MORTGAGE-USER            PIC X.
  1228                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1229                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1230             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1231                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1232                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1233                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1234                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1235                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1236             20  PI-MP-MONTH-END-DT          PIC XX.
  1237             20  PI-MP-REFERENCE-NO.
  1238                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1239                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1240
  1241         16  PI-LABEL-CONTROL            PIC X(01).
  1242             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1243             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1244
  1245         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1246             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1247
  1248         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1249             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1250             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1251
  1252         16  FILLER                      PIC X(14).
  1253
  1254     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1255******************************************************************
  1256     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1257         16  PI-MAP-NAME         PIC  X(8).
  1258         16  PI-AGENT-NAME       PIC  X(20).
  1259         16  PI-SAV-REMIT-TO     PIC  X(10).
  1260         16  PI-SAV-FIN-RESP     PIC  X(10).
  1261         16  PI-SAV-ACCT         PIC  X(10).
  1262         16  PI-SAV-ACCT-AGT     PIC  X(10).
  1263         16  PI-SAV-ACCT-NAME    PIC  X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  30
* EL642.cbl
  1264         16  PI-SAV-AGENT        PIC  X(10).
  1265         16  PI-SAV-CARR         PIC  X.
  1266         16  PI-SAV-GROUP        PIC  X(6).
  1267         16  PI-SAV-STATE        PIC  XX.
  1268         16  PI-SAV-EXP-DT       PIC  XX.
  1269         16  PI-UNPAID-NET-PREM  PIC S9(7)V99    COMP-3.
  1270         16  PI-COMP-UNPAID-PREM PIC S9(7)V99    COMP-3.
  1271         16  PI-BAL-FRWD         PIC S9(7)V99    COMP-3.
  1272         16  PI-PREMIUM          PIC S9(7)V99    COMP-3.
  1273         16  PI-REMITTED         PIC S9(7)V99    COMP-3.
  1274         16  PI-TOT-ISS-COMP     PIC S9(7)V99    COMP-3.
  1275         16  PI-TOT-CAN-COMP     PIC S9(7)V99    COMP-3.
  1276         16  PI-ADJUSTMNTS       PIC S9(7)V99    COMP-3.
  1277         16  PI-DISBURSED        PIC S9(7)V99    COMP-3.
  1278         16  PI-END-BAL          PIC S9(7)V99    COMP-3.
  1279         16  PI-LF-ISS-COMP      PIC S9(7)V99    COMP-3.
  1280         16  PI-AH-ISS-COMP      PIC S9(7)V99    COMP-3.
  1281         16  PI-LF-CAN-COMP      PIC S9(7)V99    COMP-3.
  1282         16  PI-AH-CAN-COMP      PIC S9(7)V99    COMP-3.
  1283         16  PI-DUE-FOR-ACCT     PIC S9(7)V99    COMP-3.
  1284         16  PI-ACCT-BEG-BAL     PIC S9(7)V99    COMP-3.
  1285         16  PI-ACCT-NET-PREM    PIC S9(7)V99    COMP-3.
  1286         16  PI-ACCT-COMP        PIC S9(7)V99    COMP-3.
  1287         16  PI-ACCT-PAY-ADJS    PIC S9(7)V99    COMP-3.
  1288         16  PI-BILL-TYPE        PIC  X.
  1289             88  PI-PREV-BILL                    VALUE '1'.
  1290             88  PI-PREV-REBILL                  VALUE '2'.
  1291             88  PI-PREVIEW                      VALUE '1' '2'.
  1292             88  PI-BILL                         VALUE '3'.
  1293             88  PI-REBILLING                    VALUE '4'.
  1294             88  PI-VOID-BILL                    VALUE '5'.
  1295             88  PI-TOT-REBILL                   VALUE '2' '4'.
  1296             88  PI-UPDATE-FILES                 VALUE '3' '4'
  1297                                                       '5'.
  1298             88  PI-BILLING-FUNCTION             VALUE '1' '2'
  1299                                                       '3' '4'.
  1300         16  PI-BILL-ERRS        PIC  X.
  1301         16  PI-CHECK-SW         PIC  X.
  1302             88  PI-CHECK-PRODUCED               VALUE 'Y'.
  1303         16  PI-DATA-BILLED-SW   PIC  X.
  1304             88  PI-DATA-BILLED                  VALUE 'Y'.
  1305         16  PI-ACCT-BILLED-SW   PIC  X.
  1306             88  PI-ACCT-BILLED                  VALUE 'Y'.
  1307         16  PI-MONTH-END-DATE.
  1308             20  PI-ME-MONTH     PIC  99.
  1309             20  FILLER          PIC  X.
  1310             20  PI-ME-DAY       PIC  99.
  1311             20  FILLER          PIC  X.
  1312             20  PI-ME-YEAR      PIC  99.
  1313         16  PI-LIMIT-BILLING-ACCOUNTS.
  1314             20  PI-BILLING-ACCOUNTS     OCCURS  3  TIMES
  1315                                     PIC  X(10).
  1316         16  PI-ISSUE-INFO.
  1317             20  PI-ISSUES-BILLED    PIC S9(6) COMP-3.
  1318             20  PI-ISSUES-INER      PIC S9(6) COMP-3.
  1319             20  PI-ISSUES-PREV      PIC S9(6) COMP-3.
  1320         16  PI-CANCEL-INFO.
  1321             20  PI-CANCELS-BILLED   PIC S9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  31
* EL642.cbl
  1322             20  PI-CANCELS-INER     PIC S9(6) COMP-3.
  1323             20  PI-CANCELS-PREV     PIC S9(6) COMP-3.
  1324         16  PI-UNKNOWN              PIC S9(6) COMP-3.
  1325         16  PI-COMP-CONTROL.
  1326             20  PI-COMP-CARRIER     PIC  X.
  1327             20  PI-COMP-GROUPING    PIC  X(6).
  1328             20  PI-COMP-FIN-RESP    PIC  X(10).
  1329         16  PI-SCRN-CONTROL.
  1330             20  PI-SCR-CARRIER      PIC  X.
  1331             20  PI-SCR-GROUPING     PIC  X(6).
  1332             20  PI-SCR-STATE        PIC  XX.
  1333             20  PI-SCR-ACCOUNT      PIC  X(10).
  1334             20  PI-SCR-FIN-RESP     PIC  X(10).
  1335             20  PI-SCR-TYPE         PIC  X.
  1336         16  PI-TRANSFER-SW          PIC  X.
  1337             88  PI-TRANSFER-BEFORE-ACT  VALUE 'Y'.
  1338         16  FILLER                  PIC  X(307).
  1339
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  32
* EL642.cbl
  1341*                            COPY ELCJPFX.
  1342******************************************************************
  1343*                                                                *
  1344*                                                                *
  1345*                            ELCJPFX.                            *
  1346*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1347*                            VMOD=2.002                          *
  1348*                                                                *
  1349*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1350*                                                                *
  1351*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1352*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1353*        ELCNTL - CONTROL FILE                                   *
  1354*        ELMSTR - CLAIM MASTERS                                  *
  1355*        ELTRLR - ACTIVITY TRAILERS                              *
  1356*        ELCHKQ - CHECK QUE                                      *
  1357******************************************************************
  1358 01  JOURNAL-RECORD.
  1359     12  jp-date                     pic s9(5) comp-3.
  1360     12  jp-time                     pic s9(7) comp-3.
  1361     12  JP-USER-ID                  PIC X(4).
  1362     12  JP-FILE-ID                  PIC X(8).
  1363     12  JP-PROGRAM-ID               PIC X(8).
  1364     12  JP-RECORD-TYPE              PIC X.
  1365         88 JP-ADD              VALUE 'A'.
  1366         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1367         88 JP-AFTER-CHANGE     VALUE 'C'.
  1368         88 JP-DELETE           VALUE 'D'.
  1369         88 JP-GENERIC-DELETE   VALUE 'G'.
  1370         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1371         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1372     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1373     12  JP-RECORD-AREA
  1374
  1375
  1376                             PIC  X(1464).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  33
* EL642.cbl
  1378*                            COPY ELCAID.
  1379******************************************************************
  1380*                                                                *
  1381*                            ELCAID.                             *
  1382*                            VMOD=2.001                          *
  1383*                                                                *
  1384*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1385*                                                                *
  1386*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1387*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1388******************************************************************
  1389
  1390 01  DFHAID.
  1391   02  DFHNULL   PIC  X  VALUE  ' '.
  1392   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1393   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1394   02  DFHPEN    PIC  X  VALUE  '='.
  1395   02  DFHOPID   PIC  X  VALUE  'W'.
  1396   02  DFHPA1    PIC  X  VALUE  '%'.
  1397   02  DFHPA2    PIC  X  VALUE  '>'.
  1398   02  DFHPA3    PIC  X  VALUE  ','.
  1399   02  DFHPF1    PIC  X  VALUE  '1'.
  1400   02  DFHPF2    PIC  X  VALUE  '2'.
  1401   02  DFHPF3    PIC  X  VALUE  '3'.
  1402   02  DFHPF4    PIC  X  VALUE  '4'.
  1403   02  DFHPF5    PIC  X  VALUE  '5'.
  1404   02  DFHPF6    PIC  X  VALUE  '6'.
  1405   02  DFHPF7    PIC  X  VALUE  '7'.
  1406   02  DFHPF8    PIC  X  VALUE  '8'.
  1407   02  DFHPF9    PIC  X  VALUE  '9'.
  1408   02  DFHPF10   PIC  X  VALUE  ':'.
  1409   02  DFHPF11   PIC  X  VALUE  '#'.
  1410   02  DFHPF12   PIC  X  VALUE  '@'.
  1411   02  DFHPF13   PIC  X  VALUE  'A'.
  1412   02  DFHPF14   PIC  X  VALUE  'B'.
  1413   02  DFHPF15   PIC  X  VALUE  'C'.
  1414   02  DFHPF16   PIC  X  VALUE  'D'.
  1415   02  DFHPF17   PIC  X  VALUE  'E'.
  1416   02  DFHPF18   PIC  X  VALUE  'F'.
  1417   02  DFHPF19   PIC  X  VALUE  'G'.
  1418   02  DFHPF20   PIC  X  VALUE  'H'.
  1419   02  DFHPF21   PIC  X  VALUE  'I'.
  1420*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1421   02  DFHPF22   PIC  X  VALUE  '['.
  1422   02  DFHPF23   PIC  X  VALUE  '.'.
  1423   02  DFHPF24   PIC  X  VALUE  '<'.
  1424   02  DFHMSRE   PIC  X  VALUE  'X'.
  1425   02  DFHSTRF   PIC  X  VALUE  'h'.
  1426   02  DFHTRIG   PIC  X  VALUE  '"'.
  1427
  1428 01  FILLER  REDEFINES  DFHAID.
  1429     12  FILLER              PIC  X(8).
  1430     12  PF-VALUES           PIC  X      OCCURS  2  TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  34
* EL642.cbl
  1432*                            COPY EL642S.
  1433 01  EL642AI.
  1434     05  FILLER            PIC  X(0012).
  1435*    -------------------------------
  1436     05  ADATEL PIC S9(0004) COMP.
  1437     05  ADATEF PIC  X(0001).
  1438     05  FILLER REDEFINES ADATEF.
  1439         10  ADATEA PIC  X(0001).
  1440     05  ADATEI PIC  X(0008).
  1441*    -------------------------------
  1442     05  ATIMEL PIC S9(0004) COMP.
  1443     05  ATIMEF PIC  X(0001).
  1444     05  FILLER REDEFINES ATIMEF.
  1445         10  ATIMEA PIC  X(0001).
  1446     05  ATIMEI PIC  X(0005).
  1447*    -------------------------------
  1448     05  CMPNYIDL PIC S9(0004) COMP.
  1449     05  CMPNYIDF PIC  X(0001).
  1450     05  FILLER REDEFINES CMPNYIDF.
  1451         10  CMPNYIDA PIC  X(0001).
  1452     05  CMPNYIDI PIC  X(0003).
  1453*    -------------------------------
  1454     05  USERIDL PIC S9(0004) COMP.
  1455     05  USERIDF PIC  X(0001).
  1456     05  FILLER REDEFINES USERIDF.
  1457         10  USERIDA PIC  X(0001).
  1458     05  USERIDI PIC  X(0004).
  1459*    -------------------------------
  1460     05  ABEGBALL PIC S9(0004) COMP.
  1461     05  ABEGBALF PIC  X(0001).
  1462     05  FILLER REDEFINES ABEGBALF.
  1463         10  ABEGBALA PIC  X(0001).
  1464     05  ABEGBALI PIC  X(0010).
  1465*    -------------------------------
  1466     05  ACARHDGL PIC S9(0004) COMP.
  1467     05  ACARHDGF PIC  X(0001).
  1468     05  FILLER REDEFINES ACARHDGF.
  1469         10  ACARHDGA PIC  X(0001).
  1470     05  ACARHDGI PIC  X(0007).
  1471*    -------------------------------
  1472     05  AGRPHDGL PIC S9(0004) COMP.
  1473     05  AGRPHDGF PIC  X(0001).
  1474     05  FILLER REDEFINES AGRPHDGF.
  1475         10  AGRPHDGA PIC  X(0001).
  1476     05  AGRPHDGI PIC  X(0005).
  1477*    -------------------------------
  1478     05  AUPDPRML PIC S9(0004) COMP.
  1479     05  AUPDPRMF PIC  X(0001).
  1480     05  FILLER REDEFINES AUPDPRMF.
  1481         10  AUPDPRMA PIC  X(0001).
  1482     05  AUPDPRMI PIC  X(0010).
  1483*    -------------------------------
  1484     05  AAGENTL PIC S9(0004) COMP.
  1485     05  AAGENTF PIC  X(0001).
  1486     05  FILLER REDEFINES AAGENTF.
  1487         10  AAGENTA PIC  X(0001).
  1488     05  AAGENTI PIC  X(0010).
  1489*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  35
* EL642.cbl
  1490     05  ACARIERL PIC S9(0004) COMP.
  1491     05  ACARIERF PIC  X(0001).
  1492     05  FILLER REDEFINES ACARIERF.
  1493         10  ACARIERA PIC  X(0001).
  1494     05  ACARIERI PIC  X(0001).
  1495*    -------------------------------
  1496     05  AGROUPL PIC S9(0004) COMP.
  1497     05  AGROUPF PIC  X(0001).
  1498     05  FILLER REDEFINES AGROUPF.
  1499         10  AGROUPA PIC  X(0001).
  1500     05  AGROUPI PIC  X(0006).
  1501*    -------------------------------
  1502     05  AUPDCOML PIC S9(0004) COMP.
  1503     05  AUPDCOMF PIC  X(0001).
  1504     05  FILLER REDEFINES AUPDCOMF.
  1505         10  AUPDCOMA PIC  X(0001).
  1506     05  AUPDCOMI PIC  X(0010).
  1507*    -------------------------------
  1508     05  APREMUML PIC S9(0004) COMP.
  1509     05  APREMUMF PIC  X(0001).
  1510     05  FILLER REDEFINES APREMUMF.
  1511         10  APREMUMA PIC  X(0001).
  1512     05  APREMUMI PIC  X(0010).
  1513*    -------------------------------
  1514     05  ACOMPISL PIC S9(0004) COMP.
  1515     05  ACOMPISF PIC  X(0001).
  1516     05  FILLER REDEFINES ACOMPISF.
  1517         10  ACOMPISA PIC  X(0001).
  1518     05  ACOMPISI PIC  X(0010).
  1519*    -------------------------------
  1520     05  ACOMCANL PIC S9(0004) COMP.
  1521     05  ACOMCANF PIC  X(0001).
  1522     05  FILLER REDEFINES ACOMCANF.
  1523         10  ACOMCANA PIC  X(0001).
  1524     05  ACOMCANI PIC  X(0010).
  1525*    -------------------------------
  1526     05  ABILL1L PIC S9(0004) COMP.
  1527     05  ABILL1F PIC  X(0001).
  1528     05  FILLER REDEFINES ABILL1F.
  1529         10  ABILL1A PIC  X(0001).
  1530     05  ABILL1I PIC  X(0005).
  1531*    -------------------------------
  1532     05  AINER1L PIC S9(0004) COMP.
  1533     05  AINER1F PIC  X(0001).
  1534     05  FILLER REDEFINES AINER1F.
  1535         10  AINER1A PIC  X(0001).
  1536     05  AINER1I PIC  X(0005).
  1537*    -------------------------------
  1538     05  APRVBL1L PIC S9(0004) COMP.
  1539     05  APRVBL1F PIC  X(0001).
  1540     05  FILLER REDEFINES APRVBL1F.
  1541         10  APRVBL1A PIC  X(0001).
  1542     05  APRVBL1I PIC  X(0005).
  1543*    -------------------------------
  1544     05  AADJUSTL PIC S9(0004) COMP.
  1545     05  AADJUSTF PIC  X(0001).
  1546     05  FILLER REDEFINES AADJUSTF.
  1547         10  AADJUSTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  36
* EL642.cbl
  1548     05  AADJUSTI PIC  X(0010).
  1549*    -------------------------------
  1550     05  ABILL2L PIC S9(0004) COMP.
  1551     05  ABILL2F PIC  X(0001).
  1552     05  FILLER REDEFINES ABILL2F.
  1553         10  ABILL2A PIC  X(0001).
  1554     05  ABILL2I PIC  X(0005).
  1555*    -------------------------------
  1556     05  AINER2L PIC S9(0004) COMP.
  1557     05  AINER2F PIC  X(0001).
  1558     05  FILLER REDEFINES AINER2F.
  1559         10  AINER2A PIC  X(0001).
  1560     05  AINER2I PIC  X(0005).
  1561*    -------------------------------
  1562     05  APRVBL2L PIC S9(0004) COMP.
  1563     05  APRVBL2F PIC  X(0001).
  1564     05  FILLER REDEFINES APRVBL2F.
  1565         10  APRVBL2A PIC  X(0001).
  1566     05  APRVBL2I PIC  X(0005).
  1567*    -------------------------------
  1568     05  AREMITL PIC S9(0004) COMP.
  1569     05  AREMITF PIC  X(0001).
  1570     05  FILLER REDEFINES AREMITF.
  1571         10  AREMITA PIC  X(0001).
  1572     05  AREMITI PIC  X(0010).
  1573*    -------------------------------
  1574     05  ADISBURL PIC S9(0004) COMP.
  1575     05  ADISBURF PIC  X(0001).
  1576     05  FILLER REDEFINES ADISBURF.
  1577         10  ADISBURA PIC  X(0001).
  1578     05  ADISBURI PIC  X(0010).
  1579*    -------------------------------
  1580     05  AACTHDGL PIC S9(0004) COMP.
  1581     05  AACTHDGF PIC  X(0001).
  1582     05  FILLER REDEFINES AACTHDGF.
  1583         10  AACTHDGA PIC  X(0001).
  1584     05  AACTHDGI PIC  X(0029).
  1585*    -------------------------------
  1586     05  AACTDUEL PIC S9(0004) COMP.
  1587     05  AACTDUEF PIC  X(0001).
  1588     05  FILLER REDEFINES AACTDUEF.
  1589         10  AACTDUEA PIC  X(0001).
  1590     05  AACTDUEI PIC  X(0010).
  1591*    -------------------------------
  1592     05  AENDHDGL PIC S9(0004) COMP.
  1593     05  AENDHDGF PIC  X(0001).
  1594     05  FILLER REDEFINES AENDHDGF.
  1595         10  AENDHDGA PIC  X(0001).
  1596     05  AENDHDGI PIC  X(0018).
  1597*    -------------------------------
  1598     05  ANETDUEL PIC S9(0004) COMP.
  1599     05  ANETDUEF PIC  X(0001).
  1600     05  FILLER REDEFINES ANETDUEF.
  1601         10  ANETDUEA PIC  X(0001).
  1602     05  ANETDUEI PIC  X(0010).
  1603*    -------------------------------
  1604     05  ABILTYPL PIC S9(0004) COMP.
  1605     05  ABILTYPF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  37
* EL642.cbl
  1606     05  FILLER REDEFINES ABILTYPF.
  1607         10  ABILTYPA PIC  X(0001).
  1608     05  ABILTYPI PIC  X(0001).
  1609*    -------------------------------
  1610     05  APRODSWL PIC S9(0004) COMP.
  1611     05  APRODSWF PIC  X(0001).
  1612     05  FILLER REDEFINES APRODSWF.
  1613         10  APRODSWA PIC  X(0001).
  1614     05  APRODSWI PIC  X(0001).
  1615*    -------------------------------
  1616     05  AACCT1L PIC S9(0004) COMP.
  1617     05  AACCT1F PIC  X(0001).
  1618     05  FILLER REDEFINES AACCT1F.
  1619         10  AACCT1A PIC  X(0001).
  1620     05  AACCT1I PIC  X(0010).
  1621*    -------------------------------
  1622     05  AACCT2L PIC S9(0004) COMP.
  1623     05  AACCT2F PIC  X(0001).
  1624     05  FILLER REDEFINES AACCT2F.
  1625         10  AACCT2A PIC  X(0001).
  1626     05  AACCT2I PIC  X(0010).
  1627*    -------------------------------
  1628     05  AACCT3L PIC S9(0004) COMP.
  1629     05  AACCT3F PIC  X(0001).
  1630     05  FILLER REDEFINES AACCT3F.
  1631         10  AACCT3A PIC  X(0001).
  1632     05  AACCT3I PIC  X(0010).
  1633*    -------------------------------
  1634     05  AUNKNERL PIC S9(0004) COMP.
  1635     05  AUNKNERF PIC  X(0001).
  1636     05  FILLER REDEFINES AUNKNERF.
  1637         10  AUNKNERA PIC  X(0001).
  1638     05  AUNKNERI PIC  X(0008).
  1639*    -------------------------------
  1640     05  AERMSG1L PIC S9(0004) COMP.
  1641     05  AERMSG1F PIC  X(0001).
  1642     05  FILLER REDEFINES AERMSG1F.
  1643         10  AERMSG1A PIC  X(0001).
  1644     05  AERMSG1I PIC  X(0076).
  1645*    -------------------------------
  1646     05  AERMSG2L PIC S9(0004) COMP.
  1647     05  AERMSG2F PIC  X(0001).
  1648     05  FILLER REDEFINES AERMSG2F.
  1649         10  AERMSG2A PIC  X(0001).
  1650     05  AERMSG2I PIC  X(0076).
  1651*    -------------------------------
  1652     05  APFNTERL PIC S9(0004) COMP.
  1653     05  APFNTERF PIC  X(0001).
  1654     05  FILLER REDEFINES APFNTERF.
  1655         10  APFNTERA PIC  X(0001).
  1656     05  APFNTERI PIC  9(2).
  1657 01  EL642AO REDEFINES EL642AI.
  1658     05  FILLER            PIC  X(0012).
  1659*    -------------------------------
  1660     05  FILLER            PIC  X(0003).
  1661     05  ADATEO PIC  X(0008).
  1662*    -------------------------------
  1663     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  38
* EL642.cbl
  1664     05  ATIMEO PIC  99.99.
  1665*    -------------------------------
  1666     05  FILLER            PIC  X(0003).
  1667     05  CMPNYIDO PIC  X(0003).
  1668*    -------------------------------
  1669     05  FILLER            PIC  X(0003).
  1670     05  USERIDO PIC  X(0004).
  1671*    -------------------------------
  1672     05  FILLER            PIC  X(0003).
  1673     05  ABEGBALO PIC  ZZZZZ9.99-.
  1674*    -------------------------------
  1675     05  FILLER            PIC  X(0003).
  1676     05  ACARHDGO PIC  X(0007).
  1677*    -------------------------------
  1678     05  FILLER            PIC  X(0003).
  1679     05  AGRPHDGO PIC  X(0005).
  1680*    -------------------------------
  1681     05  FILLER            PIC  X(0003).
  1682     05  AUPDPRMO PIC  ZZZZZ9.99-.
  1683*    -------------------------------
  1684     05  FILLER            PIC  X(0003).
  1685     05  AAGENTO PIC  X(0010).
  1686*    -------------------------------
  1687     05  FILLER            PIC  X(0003).
  1688     05  ACARIERO PIC  X(0001).
  1689*    -------------------------------
  1690     05  FILLER            PIC  X(0003).
  1691     05  AGROUPO PIC  X(0006).
  1692*    -------------------------------
  1693     05  FILLER            PIC  X(0003).
  1694     05  AUPDCOMO PIC  ZZZZZ9.99-.
  1695*    -------------------------------
  1696     05  FILLER            PIC  X(0003).
  1697     05  APREMUMO PIC  ZZZZZ9.99-.
  1698*    -------------------------------
  1699     05  FILLER            PIC  X(0003).
  1700     05  ACOMPISO PIC  ZZZZZ9.99-.
  1701*    -------------------------------
  1702     05  FILLER            PIC  X(0003).
  1703     05  ACOMCANO PIC  ZZZZZ9.99-.
  1704*    -------------------------------
  1705     05  FILLER            PIC  X(0003).
  1706     05  ABILL1O PIC  Z,ZZZ.
  1707*    -------------------------------
  1708     05  FILLER            PIC  X(0003).
  1709     05  AINER1O PIC  Z,ZZZ.
  1710*    -------------------------------
  1711     05  FILLER            PIC  X(0003).
  1712     05  APRVBL1O PIC  Z,ZZZ.
  1713*    -------------------------------
  1714     05  FILLER            PIC  X(0003).
  1715     05  AADJUSTO PIC  ZZZZZ9.99-.
  1716*    -------------------------------
  1717     05  FILLER            PIC  X(0003).
  1718     05  ABILL2O PIC  Z,ZZZ.
  1719*    -------------------------------
  1720     05  FILLER            PIC  X(0003).
  1721     05  AINER2O PIC  Z,ZZZ.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  39
* EL642.cbl
  1722*    -------------------------------
  1723     05  FILLER            PIC  X(0003).
  1724     05  APRVBL2O PIC  Z,ZZZ.
  1725*    -------------------------------
  1726     05  FILLER            PIC  X(0003).
  1727     05  AREMITO PIC  ZZZZZ9.99-.
  1728*    -------------------------------
  1729     05  FILLER            PIC  X(0003).
  1730     05  ADISBURO PIC  ZZZZZ9.99-.
  1731*    -------------------------------
  1732     05  FILLER            PIC  X(0003).
  1733     05  AACTHDGO PIC  X(0029).
  1734*    -------------------------------
  1735     05  FILLER            PIC  X(0003).
  1736     05  AACTDUEO PIC  ZZZZZ9.99-.
  1737*    -------------------------------
  1738     05  FILLER            PIC  X(0003).
  1739     05  AENDHDGO PIC  X(0018).
  1740*    -------------------------------
  1741     05  FILLER            PIC  X(0003).
  1742     05  ANETDUEO PIC  ZZZZZ9.99-.
  1743*    -------------------------------
  1744     05  FILLER            PIC  X(0003).
  1745     05  ABILTYPO PIC  X(0001).
  1746*    -------------------------------
  1747     05  FILLER            PIC  X(0003).
  1748     05  APRODSWO PIC  X(0001).
  1749*    -------------------------------
  1750     05  FILLER            PIC  X(0003).
  1751     05  AACCT1O PIC  X(0010).
  1752*    -------------------------------
  1753     05  FILLER            PIC  X(0003).
  1754     05  AACCT2O PIC  X(0010).
  1755*    -------------------------------
  1756     05  FILLER            PIC  X(0003).
  1757     05  AACCT3O PIC  X(0010).
  1758*    -------------------------------
  1759     05  FILLER            PIC  X(0003).
  1760     05  AUNKNERO PIC  ZZZ,ZZZ-.
  1761*    -------------------------------
  1762     05  FILLER            PIC  X(0003).
  1763     05  AERMSG1O PIC  X(0076).
  1764*    -------------------------------
  1765     05  FILLER            PIC  X(0003).
  1766     05  AERMSG2O PIC  X(0076).
  1767*    -------------------------------
  1768     05  FILLER            PIC  X(0003).
  1769     05  APFNTERO PIC  99.
  1770*    -------------------------------
  1771 01  EL642BI REDEFINES EL642AI.
  1772     05  FILLER            PIC  X(0012).
  1773*    -------------------------------
  1774     05  BDATEL PIC S9(0004) COMP.
  1775     05  BDATEF PIC  X(0001).
  1776     05  FILLER REDEFINES BDATEF.
  1777         10  BDATEA PIC  X(0001).
  1778     05  BDATEI PIC  X(0008).
  1779*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  40
* EL642.cbl
  1780     05  BTIMEL PIC S9(0004) COMP.
  1781     05  BTIMEF PIC  X(0001).
  1782     05  FILLER REDEFINES BTIMEF.
  1783         10  BTIMEA PIC  X(0001).
  1784     05  BTIMEI PIC  X(0005).
  1785*    -------------------------------
  1786     05  BCMPNYL PIC S9(0004) COMP.
  1787     05  BCMPNYF PIC  X(0001).
  1788     05  FILLER REDEFINES BCMPNYF.
  1789         10  BCMPNYA PIC  X(0001).
  1790     05  BCMPNYI PIC  X(0003).
  1791*    -------------------------------
  1792     05  BUSERIDL PIC S9(0004) COMP.
  1793     05  BUSERIDF PIC  X(0001).
  1794     05  FILLER REDEFINES BUSERIDF.
  1795         10  BUSERIDA PIC  X(0001).
  1796     05  BUSERIDI PIC  X(0004).
  1797*    -------------------------------
  1798     05  BCHKNOL PIC S9(0004) COMP.
  1799     05  BCHKNOF PIC  X(0001).
  1800     05  FILLER REDEFINES BCHKNOF.
  1801         10  BCHKNOA PIC  X(0001).
  1802     05  BCHKNOI PIC  9(6).
  1803*    -------------------------------
  1804     05  BNAMEL PIC S9(0004) COMP.
  1805     05  BNAMEF PIC  X(0001).
  1806     05  FILLER REDEFINES BNAMEF.
  1807         10  BNAMEA PIC  X(0001).
  1808     05  BNAMEI PIC  X(0029).
  1809*    -------------------------------
  1810     05  BCHKAMTL PIC S9(0004) COMP.
  1811     05  BCHKAMTF PIC  X(0001).
  1812     05  FILLER REDEFINES BCHKAMTF.
  1813         10  BCHKAMTA PIC  X(0001).
  1814     05  BCHKAMTI PIC  9(7)V99.
  1815*    -------------------------------
  1816     05  BADDR1L PIC S9(0004) COMP.
  1817     05  BADDR1F PIC  X(0001).
  1818     05  FILLER REDEFINES BADDR1F.
  1819         10  BADDR1A PIC  X(0001).
  1820     05  BADDR1I PIC  X(0029).
  1821*    -------------------------------
  1822     05  BADDR2L PIC S9(0004) COMP.
  1823     05  BADDR2F PIC  X(0001).
  1824     05  FILLER REDEFINES BADDR2F.
  1825         10  BADDR2A PIC  X(0001).
  1826     05  BADDR2I PIC  X(0029).
  1827*    -------------------------------
  1828     05  BPAYDT1L PIC S9(0004) COMP.
  1829     05  BPAYDT1F PIC  X(0001).
  1830     05  FILLER REDEFINES BPAYDT1F.
  1831         10  BPAYDT1A PIC  X(0001).
  1832     05  BPAYDT1I PIC  X(0008).
  1833*    -------------------------------
  1834     05  BCITYSTL PIC S9(0004) COMP.
  1835     05  BCITYSTF PIC  X(0001).
  1836     05  FILLER REDEFINES BCITYSTF.
  1837         10  BCITYSTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  41
* EL642.cbl
  1838     05  BCITYSTI PIC  X(0029).
  1839*    -------------------------------
  1840     05  BPAYDT2L PIC S9(0004) COMP.
  1841     05  BPAYDT2F PIC  X(0001).
  1842     05  FILLER REDEFINES BPAYDT2F.
  1843         10  BPAYDT2A PIC  X(0001).
  1844     05  BPAYDT2I PIC  X(0008).
  1845*    -------------------------------
  1846     05  BZIPL PIC S9(0004) COMP.
  1847     05  BZIPF PIC  X(0001).
  1848     05  FILLER REDEFINES BZIPF.
  1849         10  BZIPA PIC  X(0001).
  1850     05  BZIPI PIC  X(0009).
  1851*    -------------------------------
  1852     05  BALAMTL PIC S9(0004) COMP.
  1853     05  BALAMTF PIC  X(0001).
  1854     05  FILLER REDEFINES BALAMTF.
  1855         10  BALAMTA PIC  X(0001).
  1856     05  BALAMTI PIC  X(0010).
  1857*    -------------------------------
  1858     05  BERMSGL PIC S9(0004) COMP.
  1859     05  BERMSGF PIC  X(0001).
  1860     05  FILLER REDEFINES BERMSGF.
  1861         10  BERMSGA PIC  X(0001).
  1862     05  BERMSGI PIC  X(0078).
  1863*    -------------------------------
  1864     05  BPFNTERL PIC S9(0004) COMP.
  1865     05  BPFNTERF PIC  X(0001).
  1866     05  FILLER REDEFINES BPFNTERF.
  1867         10  BPFNTERA PIC  X(0001).
  1868     05  BPFNTERI PIC  9(2).
  1869 01  EL642BO REDEFINES EL642AI.
  1870     05  FILLER            PIC  X(0012).
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  BDATEO PIC  X(0008).
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  BTIMEO PIC  99.99.
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  BCMPNYO PIC  X(0003).
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  BUSERIDO PIC  X(0004).
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  BCHKNOO PIC  X(0006).
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
  1888     05  BNAMEO PIC  X(0029).
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  BCHKAMTO PIC  Z(6).99.
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  BADDR1O PIC  X(0029).
  1895*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  42
* EL642.cbl
  1896     05  FILLER            PIC  X(0003).
  1897     05  BADDR2O PIC  X(0029).
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  BPAYDT1O PIC  X(0008).
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  BCITYSTO PIC  X(0029).
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  BPAYDT2O PIC  X(0008).
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  BZIPO PIC  X(0009).
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  BALAMTO PIC  Z(6).99-.
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  BERMSGO PIC  X(0078).
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  BPFNTERO PIC  9(2).
  1919*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  43
* EL642.cbl
  1921****************************************************************
  1922*
  1923* Copyright (c) 2007 by Clerity Solutions, Inc.
  1924* All rights reserved.
  1925*
  1926****************************************************************
  1927 01  DFHEIV.
  1928   02  DFHEIV0               PIC X(35).
  1929   02  DFHEIV1               PIC X(08).
  1930   02  DFHEIV2               PIC X(08).
  1931   02  DFHEIV3               PIC X(08).
  1932   02  DFHEIV4               PIC X(06).
  1933   02  DFHEIV5               PIC X(04).
  1934   02  DFHEIV6               PIC X(04).
  1935   02  DFHEIV7               PIC X(02).
  1936   02  DFHEIV8               PIC X(02).
  1937   02  DFHEIV9               PIC X(01).
  1938   02  DFHEIV10              PIC S9(7) COMP-3.
  1939   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1940   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1941   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1942   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1943   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1944   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1945   02  DFHEIV17              PIC X(04).
  1946   02  DFHEIV18              PIC X(04).
  1947   02  DFHEIV19              PIC X(04).
  1948   02  DFHEIV20              USAGE IS POINTER.
  1949   02  DFHEIV21              USAGE IS POINTER.
  1950   02  DFHEIV22              USAGE IS POINTER.
  1951   02  DFHEIV23              USAGE IS POINTER.
  1952   02  DFHEIV24              USAGE IS POINTER.
  1953   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1954   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1955   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1956   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1957   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1958   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1959   02  FILLER                PIC X(02).
  1960   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1961   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1962   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1963   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1964   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1965 LINKAGE  SECTION.
  1966*****************************************************************
  1967*                                                               *
  1968* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1969* All rights reserved.                                          *
  1970*                                                               *
  1971*****************************************************************
  1972 01  dfheiblk.
  1973     02  eibtime          pic s9(7) comp-3.
  1974     02  eibdate          pic s9(7) comp-3.
  1975     02  eibtrnid         pic x(4).
  1976     02  eibtaskn         pic s9(7) comp-3.
  1977     02  eibtrmid         pic x(4).
  1978     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  44
* EL642.cbl
  1979     02  eibcposn         pic s9(4) comp.
  1980     02  eibcalen         pic s9(4) comp.
  1981     02  eibaid           pic x(1).
  1982     02  eibfiller1       pic x(1).
  1983     02  eibfn            pic x(2).
  1984     02  eibfiller2       pic x(2).
  1985     02  eibrcode         pic x(6).
  1986     02  eibfiller3       pic x(2).
  1987     02  eibds            pic x(8).
  1988     02  eibreqid         pic x(8).
  1989     02  eibrsrce         pic x(8).
  1990     02  eibsync          pic x(1).
  1991     02  eibfree          pic x(1).
  1992     02  eibrecv          pic x(1).
  1993     02  eibsend          pic x(1).
  1994     02  eibatt           pic x(1).
  1995     02  eibeoc           pic x(1).
  1996     02  eibfmh           pic x(1).
  1997     02  eibcompl         pic x(1).
  1998     02  eibsig           pic x(1).
  1999     02  eibconf          pic x(1).
  2000     02  eiberr           pic x(1).
  2001     02  eibrldbk         pic x(1).
  2002     02  eiberrcd         pic x(4).
  2003     02  eibsynrb         pic x(1).
  2004     02  eibnodat         pic x(1).
  2005     02  eibfiller5       pic x(2).
  2006     02  eibresp          pic 9(09) comp.
  2007     02  eibresp2         pic 9(09) comp.
  2008     02  dfheigdj         pic s9(4) comp.
  2009     02  dfheigdk         pic s9(4) comp.
  2010
  2011 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  45
* EL642.cbl
  2013*01 PARMLIST             COMP.
  2014*    12  FILLER              PIC S9(8).
  2015*    12  ERPNDB-POINTER      PIC S9(8).
  2016*    12  ELCNTL-POINTER      PIC S9(8).
  2017*    12  ERCOMP-POINTER      PIC S9(8).
  2018*    12  ERPYAJ-POINTER      PIC S9(8).
  2019*    12  ERACCT-POINTER      PIC S9(8).
  2020*    12  ERBILL-POINTER      PIC S9(8).
  2021*    12  ERCOMM-POINTER      PIC S9(8).
  2022*    12  ERCTBL-POINTER      PIC S9(8).
  2023*    12  ERGXRF-POINTER      PIC S9(8).
  2024*    12  ERGXRF2-POINTER     PIC S9(8).
  2025*    12  ERGXRF3-POINTER     PIC S9(8).
  2026*    12  ERGXRF4-POINTER     PIC S9(8).
  2027*    12  ERGXRF5-POINTER     PIC S9(8).
  2028*    12  ERGXRF6-POINTER     PIC S9(8).
  2029*    12  ERGXRF7-POINTER     PIC S9(8).
  2030*    12  ERGXRF8-POINTER     PIC S9(8).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  46
* EL642.cbl
  2032*                            COPY ERCPNDB.
  2033******************************************************************
  2034*                                                                *
  2035*                                                                *
  2036*                            ERCPNDB.                            *
  2037*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2038*                            VMOD=2.025                          *
  2039*                                                                *
  2040*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  2041*                                                                *
  2042******************************************************************
  2043*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  2044*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  2045******************************************************************
  2046*                                                                *
  2047*                                                                *
  2048*   FILE TYPE = VSAM,KSDS                                        *
  2049*   RECORD SIZE = 585  RECFORM = FIXED                           *
  2050*                                                                *
  2051*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  2052*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  2053*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  2054*                                                 RKP=13,LEN=36  *
  2055*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  2056*                                      AND CHG-SEQ.)             *
  2057*                                                RKP=49,LEN=11   *
  2058*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  2059*                                      AND CHG-SEQ.)             *
  2060*                                                RKP=60,LEN=15   *
  2061*                                                                *
  2062*   LOG = NO                                                     *
  2063*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2064******************************************************************
  2065******************************************************************
  2066*                   C H A N G E   L O G
  2067*
  2068* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2069*-----------------------------------------------------------------
  2070*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2071* EFFECTIVE    NUMBER
  2072*-----------------------------------------------------------------
  2073* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2074* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2075* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2076* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2077* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  2078* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2079* 032306                   PEMA  ADD BOW LOAN NUMBER
  2080* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  2081* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  2082* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2083* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2084* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  2085* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  2086* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2087* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2088* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  2089* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  47
* EL642.cbl
  2090******************************************************************
  2091
  2092 01  PENDING-BUSINESS.
  2093     12  PB-RECORD-ID                     PIC XX.
  2094         88  VALID-PB-ID                        VALUE 'PB'.
  2095
  2096     12  PB-CONTROL-PRIMARY.
  2097         16  PB-COMPANY-CD                PIC X.
  2098         16  PB-ENTRY-BATCH               PIC X(6).
  2099         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  2100         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  2101
  2102     12  PB-CONTROL-BY-ACCOUNT.
  2103         16  PB-COMPANY-CD-A1             PIC X.
  2104         16  PB-CARRIER                   PIC X.
  2105         16  PB-GROUPING.
  2106             20  PB-GROUPING-PREFIX       PIC XXX.
  2107             20  PB-GROUPING-PRIME        PIC XXX.
  2108         16  PB-STATE                     PIC XX.
  2109         16  PB-ACCOUNT.
  2110             20  PB-ACCOUNT-PREFIX        PIC X(4).
  2111             20  PB-ACCOUNT-PRIME         PIC X(6).
  2112         16  PB-CERT-EFF-DT               PIC XX.
  2113         16  PB-CERT-NO.
  2114             20  PB-CERT-PRIME            PIC X(10).
  2115             20  PB-CERT-SFX              PIC X.
  2116         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  2117
  2118         16  PB-RECORD-TYPE               PIC X.
  2119             88  PB-MAILING-DATA                VALUE '0'.
  2120             88  PB-ISSUE                       VALUE '1'.
  2121             88  PB-CANCELLATION                VALUE '2'.
  2122             88  PB-BATCH-TRAILER               VALUE '9'.
  2123
  2124     12  PB-CONTROL-BY-ORIG-BATCH.
  2125         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  2126         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  2127         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  2128         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  2129
  2130     12  PB-CONTROL-BY-CSR.
  2131         16  PB-CSR-COMPANY-CD            PIC X.
  2132         16  PB-CSR-ID                    PIC X(4).
  2133         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  2134         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  2135         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  2136******************************************************************
  2137*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  2138******************************************************************
  2139
  2140     12  PB-LAST-MAINT-DT                 PIC XX.
  2141     12  PB-LAST-MAINT-BY                 PIC X(4).
  2142     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2143
  2144     12  PB-RECORD-BODY                   PIC X(375).
  2145
  2146     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  2147         16  PB-CERT-ORIGIN               PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  48
* EL642.cbl
  2148             88  CLASIC-CREATED-CERT         VALUE '1'.
  2149         16  PB-I-NAME.
  2150             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  2151             20  PB-I-INSURED-FIRST-NAME.
  2152                 24  PB-I-INSURED-1ST-INIT PIC X.
  2153                 24  FILLER                PIC X(9).
  2154             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  2155         16  PB-I-AGE                     PIC S99   COMP-3.
  2156         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  2157         16  PB-I-BIRTHDAY                PIC XX.
  2158         16  PB-I-INSURED-SEX             PIC X.
  2159             88  PB-SEX-MALE     VALUE 'M'.
  2160             88  PB-SEX-FEMALE   VALUE 'F'.
  2161
  2162         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  2163         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  2164         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  2165         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  2166         16  PB-I-SKIP-CODE               PIC X.
  2167             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  2168             88  PB-SKIP-JULY              VALUE '1'.
  2169             88  PB-SKIP-AUGUST            VALUE '2'.
  2170             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  2171             88  PB-SKIP-JULY-AUG          VALUE '4'.
  2172             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  2173             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  2174             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  2175             88  PB-SKIP-JUNE              VALUE '8'.
  2176             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  2177             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  2178             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  2179         16  PB-I-TERM-TYPE               PIC X.
  2180             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  2181             88  PB-PAID-WEEKLY            VALUE 'W'.
  2182             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  2183             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  2184             88  PB-PAID-13-YEARLY         VALUE 'T'.
  2185         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  2186         16  PB-I-POLICY-FORM-NO          PIC X(12).
  2187         16  PB-I-DATA-ENTRY-SW           PIC X.
  2188             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  2189             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  2190             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  2191             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  2192         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  2193         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  2194*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  2195         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  2196         16  FILLER                       PIC X.
  2197
  2198         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  2199             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  2200             88  PB-INVALID-LIFE             VALUE '  ' '00'
  2201                                                   '90' THRU '99'.
  2202         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  2203                                          PIC XX.
  2204         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2205         16  PB-I-AMOUNT-FINANCED REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  49
* EL642.cbl
  2206                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  2207         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  2208         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  2209                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  2210         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2211         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  2212         16  PB-I-CLP-AMOUNT REDEFINES
  2213                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  2214         16  PB-I-LF-CALC-FLAG            PIC X.
  2215             88 PB-COMP-LF-PREM               VALUE '?'.
  2216         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2217         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2218         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2219         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2220         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2221         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2222         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2223         16  PB-I-LF-ABBR                 PIC XXX.
  2224         16  PB-I-LF-INPUT-CD             PIC XX.
  2225
  2226         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2227             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2228             88  PB-INVALID-AH               VALUE '  ' '00'
  2229                                                   '90' THRU '99'.
  2230         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2231         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2232         16  PB-I-AH-CALC-FLAG            PIC X.
  2233             88 PB-COMP-AH-PREM                  VALUE '?'.
  2234         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2235         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2236         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  2237         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2238         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2239         16  PB-I-AH-ABBR                 PIC XXX.
  2240         16  PB-I-AH-INPUT-CD             PIC XXX.
  2241
  2242         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2243         16  PB-I-REIN-TABLE              PIC XXX.
  2244         16  PB-I-BUSINESS-TYPE           PIC 99.
  2245         16  PB-I-INDV-GRP-CD             PIC X.
  2246         16  PB-I-MORT-CODE.
  2247             20  PB-I-TABLE               PIC X.
  2248             20  PB-I-INTEREST            PIC XX.
  2249             20  PB-I-MORT-TYP            PIC X.
  2250         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2251         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2252         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2253         16  PB-I-INDV-GRP-OVRD           PIC X.
  2254         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2255         16  PB-I-SIG-SW                  PIC X.
  2256             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2257         16  PB-I-RATE-CLASS              PIC XX.
  2258         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2259         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2260         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2261         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2262         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2263         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  50
* EL642.cbl
  2264         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  2265         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2266         16  PB-I-OB-FLAG                 PIC X.
  2267             88  PB-I-OB                      VALUE 'B'.
  2268             88  PB-I-SUMMARY                 VALUE 'Z'.
  2269         16  PB-I-ENTRY-STATUS            PIC X.
  2270             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2271                                              'M' '5' '9' '2'.
  2272             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2273             88  PB-I-POLICY-PENDING          VALUE '2'.
  2274             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2275             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2276             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  2277             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2278             88  PB-I-REIN-ONLY               VALUE '9'.
  2279             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2280             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2281             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2282             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2283         16  PB-I-INT-CODE                PIC X.
  2284             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2285             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2286         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2287         16  PB-I-SOC-SEC-NO              PIC X(11).
  2288         16  PB-I-MEMBER-NO               PIC X(12).
  2289         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2290*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2291         16  PB-I-OLD-LOF                 PIC XXX.
  2292         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2293         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2294         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2295         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2296         16  PB-I-LIFE-INDICATOR          PIC X.
  2297             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2298         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2299         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2300                                          PIC S9(5)V99    COMP-3.
  2301         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2302             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2303             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2304         16  PB-I-1ST-PMT-DT              PIC XX.
  2305         16  PB-I-JOINT-INSURED.
  2306             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2307             20 PB-I-JOINT-FIRST-NAME.
  2308                24  PB-I-JOINT-FIRST-INIT PIC X.
  2309                24  FILLER                PIC X(9).
  2310             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2311*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2312         16  PB-I-BENEFICIARY-NAME.
  2313             20  PB-I-BANK-NUMBER         PIC X(10).
  2314             20  FILLER                   PIC X(15).
  2315         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2316         16  PB-I-REFERENCE               PIC X(12).
  2317         16  FILLER REDEFINES PB-I-REFERENCE.
  2318             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2319             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2320             20  PB-I-CLP-STATE           PIC XX.
  2321         16  PB-I-UNDERWRITING-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  51
* EL642.cbl
  2322             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2323             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  2324             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2325         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2326         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2327         16  PB-I-RESIDENT-STATE          PIC XX.
  2328         16  PB-I-RATE-CODE               PIC X(4).
  2329         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2330         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2331         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2332         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2333         16  PB-I-BANK-NOCHRGB            PIC 99.
  2334         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2335         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2336
  2337     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2338         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2339             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2340         16  PB-C-CANCEL-ORIGIN           PIC X.
  2341             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2342         16  PB-C-LF-CANCEL-DT            PIC XX.
  2343         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2344         16  PB-C-LF-CALC-REQ             PIC X.
  2345             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2346         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2347         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2348         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2349             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2350         16  PB-C-AH-CANCEL-DT            PIC XX.
  2351         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2352         16  PB-C-AH-CALC-REQ             PIC X.
  2353             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2354         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2355         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2356         16  PB-C-LAST-NAME               PIC X(15).
  2357         16  PB-C-REFUND-SW               PIC X.
  2358             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2359             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2360         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2361         16  PB-C-PAYEE-CODE              PIC X(6).
  2362         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2363         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2364         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2365         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2366         16  PB-C-REFERENCE               PIC X(12).
  2367         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2368         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2369         16  PB-C-POST-CARD-IND           PIC X.
  2370         16  PB-C-CANCEL-REASON           PIC X.
  2371         16  PB-C-REF-INTERFACE-SW        PIC X.
  2372         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2373         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2374         16  FILLER                       PIC X(01).
  2375*        16  FILLER                       PIC X(18).
  2376         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2377*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2378         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2379         16  PB-CANCELED-CERT-DATA.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  52
* EL642.cbl
  2380             20  PB-CI-INSURED-NAME.
  2381                 24  PB-CI-LAST-NAME      PIC X(15).
  2382                 24  PB-CI-INITIALS       PIC XX.
  2383             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2384             20  PB-CI-INSURED-SEX        PIC X.
  2385             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2386             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2387             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2388             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2389             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2390             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2391             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2392             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2393             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2394             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2395             20  PB-CI-RATE-CLASS         PIC XX.
  2396             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2397             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2398             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2399             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2400             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2401             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2402             20  PB-CI-LF-ABBR            PIC X(3).
  2403             20  PB-CI-AH-ABBR            PIC X(3).
  2404             20  PB-CI-OB-FLAG            PIC X.
  2405                 88  PB-CI-OB                VALUE 'B'.
  2406             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2407                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2408                                           'M' '4' '5' '9' '2'.
  2409                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2410                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2411                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2412                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2413                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2414                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  2415                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2416                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2417                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2418                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2419                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2420                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2421                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2422             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2423                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2424                                           'M' '4' '5' '9' '2'.
  2425                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2426                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2427                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2428                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2429                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2430                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  2431                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2432                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2433                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2434                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2435                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2436                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2437                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  53
* EL642.cbl
  2438             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2439             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2440             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2441             20  PB-CI-MEMBER-NO          PIC X(12).
  2442             20  PB-CI-INT-CODE           PIC X.
  2443                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2444                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2445             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2446             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2447             20  PB-CI-COMP-EXCP-SW       PIC X.
  2448                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2449                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2450             20  PB-CI-ENTRY-STATUS       PIC X.
  2451             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2452             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2453             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2454             20  PB-CI-DEATH-DT           PIC XX.
  2455             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2456             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2457             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2458             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2459             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2460             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2461             20  PB-CI-ENTRY-DT              PIC XX.
  2462             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2463             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2464             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2465             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2466             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2467             20  PB-CI-OLD-LOF               PIC XXX.
  2468*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2469             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2470             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2471             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2472             20  PB-CI-INDV-GRP-CD           PIC X.
  2473             20  PB-CI-BENEFICIARY-NAME.
  2474                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2475                 24  FILLER                  PIC X(15).
  2476             20  PB-CI-NOTE-SW               PIC X.
  2477             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2478             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2479             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2480             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2481             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2482             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2483             20  PB-CI-FIRST-NAME            PIC X(10).
  2484             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2485
  2486         16  FILLER                       PIC X(13).
  2487*032306  16  FILLER                       PIC X(27).
  2488*        16  FILLER                       PIC X(46).
  2489
  2490     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2491         16  FILLER                       PIC X(10).
  2492         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2493         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2494         16  PB-M-INSURED-MID-INIT        PIC X.
  2495         16  PB-M-INSURED-AGE             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  54
* EL642.cbl
  2496         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2497         16  PB-M-INSURED-SEX             PIC X.
  2498         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2499         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  2500         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2501         16  PB-M-INSURED-CITY-STATE.
  2502             20  PB-M-INSURED-CITY        PIC X(28).
  2503             20  PB-M-INSURED-STATE       PIC XX.
  2504         16  PB-M-INSURED-ZIP-CODE.
  2505             20  PB-M-INSURED-ZIP-PRIME.
  2506                 24  PB-M-INSURED-ZIP-1   PIC X.
  2507                     88  PB-M-CANADIAN-POST-CODE
  2508                                             VALUE 'A' THRU 'Z'.
  2509                 24  FILLER               PIC X(4).
  2510             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2511         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2512                                        PB-M-INSURED-ZIP-CODE.
  2513             20  PM-M-INS-CAN-POST1       PIC XXX.
  2514             20  PM-M-INS-CAN-POST2       PIC XXX.
  2515             20  FILLER                   PIC XXX.
  2516         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2517         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2518         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2519         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2520         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2521         16  PB-M-CRED-BENE-CITYST.
  2522             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2523             20  PB-M-CRED-BENE-STATE     PIC XX.
  2524         16  FILLER                       PIC X(92).
  2525
  2526     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2527         16  FILLER                       PIC X(10).
  2528         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2529         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2530         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2531         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2532         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2533         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2534         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2535         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2536         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2537         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2538         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2539         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2540         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2541         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2542         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2543         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2544         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2545         16  PB-ACCOUNT-NAME              PIC X(30).
  2546         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2547         16  PB-REFERENCE                 PIC X(12).
  2548         16  PB-B-RECEIVED-DT             PIC XX.
  2549         16  FILLER                       PIC X(234).
  2550
  2551     12  PB-RECORD-STATUS.
  2552         16  PB-CREDIT-SELECT-DT          PIC XX.
  2553         16  PB-CREDIT-ACCEPT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  55
* EL642.cbl
  2554         16  PB-BILLED-DT                 PIC XX.
  2555         16  PB-BILLING-STATUS            PIC X.
  2556             88  PB-ENTRY-REVERSED            VALUE 'R'.
  2557             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2558             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2559         16  PB-RECORD-BILL               PIC X.
  2560             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2561             88  PB-RECORD-RETURNED           VALUE 'R'.
  2562             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2563             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2564             88  PB-OVERRIDE-AH               VALUE 'A'.
  2565             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2566         16  PB-BATCH-ENTRY               PIC X.
  2567             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2568             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2569             88  PB-REISSUED-CERT             VALUE 'E'.
  2570             88  PB-CASH-CERT                 VALUE 'C'.
  2571             88  PB-MONTHLY-CERT              VALUE 'M'.
  2572             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2573             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2574             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2575         16  PB-FORCE-CODE                PIC X.
  2576             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2577             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2578             88  PB-CANCEL-FORCE              VALUE '8'.
  2579             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2580             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2581             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2582             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2583             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2584             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2585             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2586         16  PB-FATAL-FLAG                PIC X.
  2587             88  PB-FATAL-ERRORS              VALUE 'X'.
  2588         16  PB-FORCE-ER-CD               PIC X.
  2589             88  PB-FORCE-ERRORS              VALUE 'F'.
  2590             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2591         16  PB-WARN-ER-CD                PIC X.
  2592             88  PB-WARNING-ERRORS            VALUE 'W'.
  2593         16  FILLER                       PIC X.
  2594         16  PB-OUT-BAL-CD                PIC X.
  2595             88  PB-OUT-OF-BAL                VALUE 'O'.
  2596         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2597         16  PB-AH-OVERRIDE-L1            PIC X.
  2598         16  PB-INPUT-DT                  PIC XX.
  2599         16  PB-INPUT-BY                  PIC X(4).
  2600         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2601         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2602         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2603         16  PB-LF-EARNING-METHOD         PIC X.
  2604         16  PB-AH-EARNING-METHOD         PIC X.
  2605         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2606         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2607         16  PB-REIN-CD                   PIC XXX.
  2608         16  PB-LF-REFUND-TYPE            PIC X.
  2609         16  PB-AH-REFUND-TYPE            PIC X.
  2610         16  PB-ACCT-EFF-DT               PIC XX.
  2611         16  PB-ACCT-EXP-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  56
* EL642.cbl
  2612         16  PB-COMPANY-ID                PIC X(3).
  2613         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2614         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2615         16  PB-SV-CARRIER                PIC X.
  2616         16  PB-SV-GROUPING               PIC X(6).
  2617         16  PB-SV-STATE                  PIC XX.
  2618         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2619         16  PB-GA-BILLING-INFO.
  2620             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2621                                          PIC XX.
  2622         16  PB-SV-REMIT-TO  REDEFINES
  2623             PB-GA-BILLING-INFO           PIC X(10).
  2624         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2625         16  PB-I-LOAN-OFFICER            PIC X(5).
  2626         16  PB-I-VIN                     PIC X(17).
  2627
  2628         16  FILLER                       PIC X(04).
  2629         16  IMNET-BYPASS-SW              PIC X.
  2630
  2631******************************************************************
  2632*                COMMON EDIT ERRORS                              *
  2633******************************************************************
  2634
  2635     12  PB-COMMON-ERRORS.
  2636         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2637                                           PIC S9(4)     COMP.
  2638
  2639******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  57
* EL642.cbl
  2641*                            COPY ELCCNTL.
  2642******************************************************************
  2643*                                                                *
  2644*                                                                *
  2645*                            ELCCNTL.                            *
  2646*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2647*                            VMOD=2.059                          *
  2648*                                                                *
  2649*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2650*                                                                *
  2651*   FILE TYPE = VSAM,KSDS                                        *
  2652*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2653*                                                                *
  2654*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2655*       ALTERNATE INDEX = NONE                                   *
  2656*                                                                *
  2657*   LOG = YES                                                    *
  2658*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2659******************************************************************
  2660*                   C H A N G E   L O G
  2661*
  2662* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2663*-----------------------------------------------------------------
  2664*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2665* EFFECTIVE    NUMBER
  2666*-----------------------------------------------------------------
  2667* 082503                   PEMA  ADD BENEFIT GROUP
  2668* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2669* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2670* 092705    2005050300006  PEMA  ADD SPP LEASES
  2671* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2672* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2673* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2674* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2675* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2676* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2677* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2678* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2679* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2680* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2681******************************************************************
  2682*
  2683 01  CONTROL-FILE.
  2684     12  CF-RECORD-ID                       PIC XX.
  2685         88  VALID-CF-ID                        VALUE 'CF'.
  2686
  2687     12  CF-CONTROL-PRIMARY.
  2688         16  CF-COMPANY-ID                  PIC XXX.
  2689         16  CF-RECORD-TYPE                 PIC X.
  2690             88  CF-COMPANY-MASTER              VALUE '1'.
  2691             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2692             88  CF-STATE-MASTER                VALUE '3'.
  2693             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2694             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2695             88  CF-CARRIER-MASTER              VALUE '6'.
  2696             88  CF-MORTALITY-MASTER            VALUE '7'.
  2697             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2698             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  58
* EL642.cbl
  2699             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2700             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2701             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2702             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2703             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2704             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2705             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2706             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2707             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2708         16  CF-ACCESS-CD-GENL              PIC X(4).
  2709         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2710             20  CF-PROCESSOR               PIC X(4).
  2711         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2712             20  CF-STATE-CODE              PIC XX.
  2713             20  FILLER                     PIC XX.
  2714         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2715             20  FILLER                     PIC XX.
  2716             20  CF-HI-BEN-IN-REC           PIC XX.
  2717         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2718             20  FILLER                     PIC XXX.
  2719             20  CF-CARRIER-CNTL            PIC X.
  2720         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2721             20  FILLER                     PIC XX.
  2722             20  CF-HI-TYPE-IN-REC          PIC 99.
  2723         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2724             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2725                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2726             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2727             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2728         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2729             20  FILLER                     PIC X.
  2730             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2731         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2732             20  FILLER                     PIC XX.
  2733             20  CF-MORTGAGE-PLAN           PIC XX.
  2734         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2735
  2736     12  CF-LAST-MAINT-DT                   PIC XX.
  2737     12  CF-LAST-MAINT-BY                   PIC X(4).
  2738     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2739
  2740     12  CF-RECORD-BODY                     PIC X(728).
  2741
  2742
  2743****************************************************************
  2744*             COMPANY MASTER RECORD                            *
  2745****************************************************************
  2746
  2747     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2748         16  CF-COMPANY-ADDRESS.
  2749             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2750             20  CF-CL-IN-CARE-OF           PIC X(30).
  2751             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2752             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2753             20  CF-CL-CITY-STATE           PIC X(30).
  2754             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2755             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2756         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  59
* EL642.cbl
  2757         16  CF-COMPANY-PASSWORD            PIC X(8).
  2758         16  CF-SECURITY-OPTION             PIC X.
  2759             88  ALL-SECURITY                   VALUE '1'.
  2760             88  COMPANY-VERIFY                 VALUE '2'.
  2761             88  PROCESSOR-VERIFY               VALUE '3'.
  2762             88  NO-SECURITY                    VALUE '4'.
  2763             88  ALL-BUT-TERM                   VALUE '5'.
  2764         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2765             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2766         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2767             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2768         16  CF-INFORCE-LOCATION            PIC X.
  2769             88  CERTS-ARE-ONLINE               VALUE '1'.
  2770             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2771             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2772         16  CF-LOWER-CASE-LETTERS          PIC X.
  2773         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2774             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2775             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2776             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2777             88  CF-ACCNT-CNTL                  VALUE '3'.
  2778             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2779
  2780         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2781         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2782
  2783         16  CF-LGX-CREDIT-USER             PIC X.
  2784             88  CO-IS-NOT-USER                 VALUE 'N'.
  2785             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2786
  2787         16 CF-CREDIT-CALC-CODES.
  2788             20  CF-CR-REM-TERM-CALC PIC X.
  2789               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2790               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2791               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2792               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2793               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2794               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2795               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2796             20  CF-CR-R78-METHOD           PIC X.
  2797               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2798               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2799
  2800         16  CF-CLAIM-CONTROL-COUNTS.
  2801             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2802                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2803
  2804             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2805                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2806
  2807             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2808                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2809
  2810             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2811                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2812
  2813         16  CF-CURRENT-MONTH-END           PIC XX.
  2814
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  60
* EL642.cbl
  2815         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2816             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2817             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2818             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2819             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2820                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2821                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2822             20  CF-CO-PREM-REJECT-SW       PIC X.
  2823                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2824                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2825             20  CF-CO-REF-REJECT-SW        PIC X.
  2826                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2827                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2828
  2829         16  CF-CO-REPORTING-DT             PIC XX.
  2830         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2831         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2832           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2833           88  CF-CO-MONTH-END                  VALUE '1'.
  2834
  2835         16  CF-LGX-CLAIM-USER              PIC X.
  2836             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2837             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2838
  2839         16  CF-CREDIT-EDIT-CONTROLS.
  2840             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2841             20  CF-MIN-AGE                 PIC 99.
  2842             20  CF-DEFAULT-AGE             PIC 99.
  2843             20  CF-MIN-TERM                PIC S999      COMP-3.
  2844             20  CF-MAX-TERM                PIC S999      COMP-3.
  2845             20  CF-DEFAULT-SEX             PIC X.
  2846             20  CF-JOINT-AGE-INPUT         PIC X.
  2847                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2848             20  CF-BIRTH-DATE-INPUT        PIC X.
  2849                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2850             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2851                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2852                 88  CF-ZERO-CARRIER            VALUE '1'.
  2853                 88  CF-ZERO-GROUPING           VALUE '2'.
  2854                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2855             20  CF-EDIT-SW                 PIC X.
  2856                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2857             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2858             20  CF-CR-PR-METHOD            PIC X.
  2859               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2860               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2861             20  FILLER                     PIC X.
  2862
  2863         16  CF-CREDIT-MISC-CONTROLS.
  2864             20  CF-REIN-TABLE-SW           PIC X.
  2865                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2866             20  CF-COMP-TABLE-SW           PIC X.
  2867                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2868             20  CF-EXPERIENCE-RETENTION-AGE
  2869                                            PIC S9        COMP-3.
  2870             20  CF-CONVERSION-DT           PIC XX.
  2871             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2872             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  61
* EL642.cbl
  2873                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2874                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2875
  2876             20  CF-CR-CHECK-NO-CONTROL.
  2877                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2878                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2879                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2880                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2881                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2882                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2883
  2884                 24  CF-CR-CHECK-COUNT       REDEFINES
  2885                     CF-CR-CHECK-COUNTER      PIC X(4).
  2886
  2887                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2888                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2889
  2890                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2891                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2892                 24  CF-MAIL-PROCESSING       PIC X.
  2893                     88  MAIL-PROCESSING          VALUE 'Y'.
  2894
  2895         16  CF-MISC-SYSTEM-CONTROL.
  2896             20  CF-SYSTEM-C                 PIC X.
  2897                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2898             20  CF-SYSTEM-D                 PIC X.
  2899                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2900             20  CF-SOC-SEC-NO-SW            PIC X.
  2901                 88  SOC-SEC-NO-USED             VALUE '1'.
  2902             20  CF-MEMBER-NO-SW             PIC X.
  2903                 88  MEMBER-NO-USED              VALUE '1'.
  2904             20  CF-TAX-ID-NUMBER            PIC X(11).
  2905             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2906             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2907                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2908                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2909                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2910                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2911             20  CF-SYSTEM-E                 PIC X.
  2912                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2913
  2914         16  CF-LGX-LIFE-USER               PIC X.
  2915             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2916             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2917
  2918         16  CF-CR-MONTH-END-DT             PIC XX.
  2919
  2920         16  CF-FILE-MAINT-DATES.
  2921             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2922                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2923             20  CF-LAST-BATCH       REDEFINES
  2924                 CF-LAST-BATCH-NO               PIC X(4).
  2925             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2926             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2927             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2928             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2929             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2930             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  62
* EL642.cbl
  2931             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2932             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2933             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2934             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2935
  2936         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2937         16  FILLER                         PIC X.
  2938
  2939         16  CF-ALT-MORT-CODE               PIC X(4).
  2940         16  CF-MEMBER-CAPTION              PIC X(10).
  2941
  2942         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2943             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2944             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2945             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2946             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2947             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2948
  2949         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2950
  2951         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2952         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2953         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2954         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2955
  2956         16  CF-AH-OVERRIDE-L1              PIC X.
  2957         16  CF-AH-OVERRIDE-L2              PIC XX.
  2958         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2959         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2960
  2961         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2962         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2963
  2964         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2965         16  CF-AR-LAST-EL860-DT            PIC XX.
  2966         16  CF-MP-MONTH-END-DT             PIC XX.
  2967
  2968         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2969         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2970             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2971
  2972         16  CF-AR-MONTH-END-DT             PIC XX.
  2973
  2974         16  CF-CRDTCRD-USER                PIC X.
  2975             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2976             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2977
  2978         16  CF-CC-MONTH-END-DT             PIC XX.
  2979
  2980         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2981
  2982         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2983             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2984             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2985             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2986         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2987         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2988         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  63
* EL642.cbl
  2989         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2990             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2991             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2992         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2993         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2994         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2995             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2996         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2997
  2998         16  CF-CL-ZIP-CODE.
  2999             20  CF-CL-ZIP-PRIME.
  3000                 24  CF-CL-ZIP-1ST          PIC X.
  3001                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3002                 24  FILLER                 PIC X(4).
  3003             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3004         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3005             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3006             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3007             20  FILLER                     PIC XXX.
  3008
  3009         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3010         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3011         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3012         16  CF-CO-OPTION-START-DATE        PIC XX.
  3013         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3014           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3015                                                      '3' '4'.
  3016           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3017           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3018           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3019           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3020           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3021           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3022
  3023         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3024
  3025         16  CF-PAYMENT-APPROVAL-LEVELS.
  3026             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3027             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3028             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3029             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3030             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3031             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3032
  3033         16  CF-END-USER-REPORTING-USER     PIC X.
  3034             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3035             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3036
  3037         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3038             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3039             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3040
  3041         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3042
  3043         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3044         16  FILLER                         PIC X.
  3045
  3046         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  64
* EL642.cbl
  3047             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3048             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3049             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3050
  3051         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3052
  3053         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3054             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3055             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3056
  3057         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3058             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3059             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3060
  3061         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3062
  3063         16  CF-CO-ACH-ID-CODE              PIC  X.
  3064             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3065             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3066             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3067         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3068         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3069         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3070         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3071         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3072         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3073         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3074         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3075         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3076                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3077         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3078                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3079
  3080         16  CF-CO-OVER-SHORT.
  3081             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3082             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3083
  3084*         16  FILLER                         PIC X(102).
  3085         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3086             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3087             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3088
  3089         16  CF-AH-APPROVAL-DAYS.
  3090             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3091             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3092             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3093             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3094
  3095         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3096
  3097         16  CF-APPROV-LEV-5.
  3098             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3099             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3100             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3101
  3102         16  FILLER                         PIC X(68).
  3103****************************************************************
  3104*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  65
* EL642.cbl
  3105****************************************************************
  3106
  3107     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3108         16  CF-PROCESSOR-NAME              PIC X(30).
  3109         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3110         16  CF-PROCESSOR-TITLE             PIC X(26).
  3111         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3112                 88  MESSAGE-YES                VALUE 'Y'.
  3113                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3114
  3115*****************************************************
  3116****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3117****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3118****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3119****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3120*****************************************************
  3121
  3122         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3123             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3124             20  CF-APPLICATION-FORCE       PIC X.
  3125             20  CF-INDIVIDUAL-APP.
  3126                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3127                     28  CF-BROWSE-APP      PIC X.
  3128                     28  CF-UPDATE-APP      PIC X.
  3129
  3130         16  CF-CURRENT-TERM-ON             PIC X(4).
  3131         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3132             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3133             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3134             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3135             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3136             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3137             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3138             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3139         16  CF-PROCESSOR-CARRIER           PIC X.
  3140             88  NO-CARRIER-SECURITY            VALUE ' '.
  3141         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3142             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3143         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3144             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3145         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3146             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3147
  3148         16  CF-PROC-SYS-ACCESS-SW.
  3149             20  CF-PROC-CREDIT-CLAIMS-SW.
  3150                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3151                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3152                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3153                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3154             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3155                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3156                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3157             20  CF-PROC-LIFE-GNRLDGR-SW.
  3158                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3159                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3160                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3161                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3162             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  66
* EL642.cbl
  3163                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3164                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3165         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3166             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3167             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3168         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3169
  3170         16  CF-APPROVAL-LEVEL                  PIC X.
  3171             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3172             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3173             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3174             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3175             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3176
  3177         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3178
  3179         16  CF-LANGUAGE-TYPE                   PIC X.
  3180             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3181             88  CF-LANG-IS-FR                      VALUE 'F'.
  3182
  3183         16  CF-CSR-IND                         PIC X.
  3184         16  FILLER                             PIC X(239).
  3185
  3186****************************************************************
  3187*             PROCESSOR/REMINDERS RECORD                       *
  3188****************************************************************
  3189
  3190     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3191         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3192             20  CF-START-REMIND-DT         PIC XX.
  3193             20  CF-END-REMIND-DT           PIC XX.
  3194             20  CF-REMINDER-TEXT           PIC X(50).
  3195         16  FILLER                         PIC X(296).
  3196
  3197
  3198****************************************************************
  3199*             STATE MASTER RECORD                              *
  3200****************************************************************
  3201
  3202     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3203         16  CF-STATE-ABBREVIATION          PIC XX.
  3204         16  CF-STATE-NAME                  PIC X(25).
  3205         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3206         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3207             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3208             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3209             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3210             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3211                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3212                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3213             20  CF-ST-PREM-REJECT-SW       PIC X.
  3214                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3215                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3216             20  CF-ST-REF-REJECT-SW        PIC X.
  3217                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3218                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3219         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3220         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  67
* EL642.cbl
  3221         16  CF-ST-REFUND-RULES.
  3222             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3223             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3224             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3225         16  CF-ST-FST-PMT-EXTENSION.
  3226             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3227             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3228                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3229                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3230                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3231                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3232         16  CF-ST-STATE-CALL.
  3233             20  CF-ST-CALL-UNEARNED        PIC X.
  3234             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3235             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3236         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3237             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3238             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3239         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3240         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3241         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3242         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3243         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3244         16  FILLER                         PIC X.
  3245         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3246             20  CF-ST-BENEFIT-CD           PIC XX.
  3247             20  CF-ST-BENEFIT-KIND         PIC X.
  3248                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3249                 88  CF-ST-AH-KIND              VALUE 'A'.
  3250             20  CF-ST-REM-TERM-CALC        PIC X.
  3251                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3252                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3253                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3254                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3255                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3256                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3257                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3258                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3259
  3260             20  CF-ST-REFUND-CALC          PIC X.
  3261                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3262                 88  ST-REFD-BY-R78             VALUE '1'.
  3263                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3264                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3265                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3266                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3267                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3268                 88  ST-REFD-UTAH               VALUE '7'.
  3269                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3270                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3271                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3272
  3273             20  CF-ST-EARNING-CALC         PIC X.
  3274                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3275                 88  ST-EARN-BY-R78             VALUE '1'.
  3276                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3277                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3278                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  68
* EL642.cbl
  3279                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3280                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3281                 88  ST-EARN-MEAN               VALUE '8'.
  3282                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3283
  3284             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3285                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3286                 88  ST-OVRD-BY-R78             VALUE '1'.
  3287                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3288                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3289                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3290                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3291                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3292                 88  ST-OVRD-MEAN               VALUE '8'.
  3293                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3294             20  cf-st-extra-periods        pic 9.
  3295*            20  FILLER                     PIC X.
  3296
  3297         16  CF-ST-COMMISSION-CAPS.
  3298             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3299             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3300             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3301             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3302         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3303                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3304
  3305         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3306
  3307         16  CF-ST-STATUTORY-INTEREST.
  3308             20  CF-ST-STAT-DATE-FROM       PIC X.
  3309                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3310                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3311             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3312             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3313             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3314             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3315             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3316
  3317         16  CF-ST-OVER-SHORT.
  3318             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3319             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3320
  3321         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3322
  3323         16  CF-ST-RT-CALC                  PIC X.
  3324
  3325         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3326         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3327         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3328         16  CF-ST-RF-LR-CALC               PIC X.
  3329         16  CF-ST-RF-LL-CALC               PIC X.
  3330         16  CF-ST-RF-LN-CALC               PIC X.
  3331         16  CF-ST-RF-AH-CALC               PIC X.
  3332         16  CF-ST-RF-CP-CALC               PIC X.
  3333*        16  FILLER                         PIC X(206).
  3334*CIDMOD         16  FILLER                         PIC X(192).
  3335         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3336             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  69
* EL642.cbl
  3337         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3338         16  CF-ST-VFY-2ND-BENE             PIC X.
  3339         16  CF-ST-CAUSAL-STATE             PIC X.
  3340         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3341         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3342         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3343             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3344         16  CF-ST-NET-ONLY-STATE           PIC X.
  3345             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3346         16  FILLER                         PIC X(181).
  3347
  3348****************************************************************
  3349*             BENEFIT MASTER RECORD                            *
  3350****************************************************************
  3351
  3352     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3353         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3354             20  CF-BENEFIT-CODE            PIC XX.
  3355             20  CF-BENEFIT-NUMERIC  REDEFINES
  3356                 CF-BENEFIT-CODE            PIC XX.
  3357             20  CF-BENEFIT-ALPHA           PIC XXX.
  3358             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3359             20  CF-BENEFIT-COMMENT         PIC X(10).
  3360
  3361             20  CF-LF-COVERAGE-TYPE        PIC X.
  3362                 88  CF-REDUCING                VALUE 'R'.
  3363                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3364
  3365             20  CF-SPECIAL-CALC-CD         PIC X.
  3366                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3367                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3368                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3369                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3370                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3371                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3372                 88  CF-FARM-PLAN               VALUE 'F'.
  3373                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3374                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3375                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3376                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3377                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3378                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3379                 88  CF-PRUDENTIAL              VALUE 'P'.
  3380                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3381                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3382                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3383                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3384                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3385                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3386
  3387             20  CF-JOINT-INDICATOR         PIC X.
  3388                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3389
  3390*            20  FILLER                     PIC X(12).
  3391             20  cf-maximum-benefits        pic s999 comp-3.
  3392             20  FILLER                     PIC X(09).
  3393             20  CF-BENEFIT-CATEGORY        PIC X.
  3394             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  70
* EL642.cbl
  3395
  3396             20  CF-CO-REM-TERM-CALC        PIC X.
  3397                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3398                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3399                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3400                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3401                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3402
  3403             20  CF-CO-EARNINGS-CALC        PIC X.
  3404                 88  CO-EARN-BY-R78             VALUE '1'.
  3405                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3406                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3407                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3408                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3409                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3410                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3411                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3412
  3413             20  CF-CO-REFUND-CALC          PIC X.
  3414                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3415                 88  CO-REFD-BY-R78             VALUE '1'.
  3416                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3417                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3418                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3419                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3420                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3421                 88  CO-REFD-MEAN               VALUE '8'.
  3422                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3423                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3424                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3425
  3426             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3427                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3428                 88  CO-OVRD-BY-R78             VALUE '1'.
  3429                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3430                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3431                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3432                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3433                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3434                 88  CO-OVRD-MEAN               VALUE '8'.
  3435                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3436
  3437             20  CF-CO-BEN-I-G-CD           PIC X.
  3438                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3439                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3440                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3441
  3442         16  FILLER                         PIC X(304).
  3443
  3444
  3445****************************************************************
  3446*             CARRIER MASTER RECORD                            *
  3447****************************************************************
  3448
  3449     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3450         16  CF-ADDRESS-DATA.
  3451             20  CF-MAIL-TO-NAME            PIC X(30).
  3452             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  71
* EL642.cbl
  3453             20  CF-ADDRESS-LINE-1          PIC X(30).
  3454             20  CF-ADDRESS-LINE-2          PIC X(30).
  3455             20  CF-CITY-STATE              PIC X(30).
  3456             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3457             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3458
  3459         16  CF-CLAIM-NO-CONTROL.
  3460             20  CF-CLAIM-NO-METHOD         PIC X.
  3461                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3462                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3463                 88  CLAIM-NO-SEQ               VALUE '3'.
  3464                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3465             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3466                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3467                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3468                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3469
  3470         16  CF-CHECK-NO-CONTROL.
  3471             20  CF-CHECK-NO-METHOD         PIC X.
  3472                 88  CHECK-NO-MANUAL            VALUE '1'.
  3473                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3474                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3475                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3476             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3477                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3478
  3479         16  CF-DOMICILE-STATE              PIC XX.
  3480
  3481         16  CF-EXPENSE-CONTROLS.
  3482             20  CF-EXPENSE-METHOD          PIC X.
  3483                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3484                 88  DOLLARS-PER-PMT            VALUE '2'.
  3485                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3486                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3487             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3488             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3489
  3490         16  CF-CORRESPONDENCE-CONTROL.
  3491             20  CF-LETTER-RESEND-OPT       PIC X.
  3492                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3493                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3494             20  FILLER                     PIC X(4).
  3495
  3496         16  CF-RESERVE-CONTROLS.
  3497             20  CF-MANUAL-SW               PIC X.
  3498                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3499             20  CF-FUTURE-SW               PIC X.
  3500                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3501             20  CF-PTC-SW                  PIC X.
  3502                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3503             20  CF-IBNR-SW                 PIC X.
  3504                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3505             20  CF-PTC-LF-SW               PIC X.
  3506                 88  CF-LF-PTC-USED             VALUE '1'.
  3507             20  CF-CDT-ACCESS-METHOD       PIC X.
  3508                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3509                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3510                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  72
* EL642.cbl
  3511             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3512
  3513         16  CF-CLAIM-CALC-METHOD           PIC X.
  3514             88  360-PLUS-MONTHS                VALUE '1'.
  3515             88  365-PLUS-MONTHS                VALUE '2'.
  3516             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3517             88  360-DAILY                      VALUE '4'.
  3518             88  365-DAILY                      VALUE '5'.
  3519
  3520         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3521         16  FILLER                         PIC X(11).
  3522
  3523         16  CF-LIMIT-AMOUNTS.
  3524             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3525             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3526             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3527             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3528             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3529             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3530             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3531             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3532             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3533             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3534
  3535         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3536         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3537         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3538
  3539         16  CF-ZIP-CODE.
  3540             20  CF-ZIP-PRIME.
  3541                 24  CF-ZIP-1ST             PIC X.
  3542                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3543                 24  FILLER                 PIC X(4).
  3544             20  CF-ZIP-PLUS4               PIC X(4).
  3545         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3546             20  CF-CAN-POSTAL-1            PIC XXX.
  3547             20  CF-CAN-POSTAL-2            PIC XXX.
  3548             20  FILLER                     PIC XXX.
  3549
  3550         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3551         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3552         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3553
  3554         16  CF-RATING-SWITCH               PIC X.
  3555             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3556             88  CF-NO-RATING                   VALUE 'N'.
  3557
  3558         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3559
  3560         16  CF-CARRIER-OVER-SHORT.
  3561             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3562             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3563
  3564         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3565         16  CF-SECPAY-SWITCH               PIC X.
  3566             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3567             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3568         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  73
* EL642.cbl
  3569         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3570         16  FILLER                         PIC X(444).
  3571*        16  FILLER                         PIC X(452).
  3572
  3573
  3574****************************************************************
  3575*             MORTALITY MASTER RECORD                          *
  3576****************************************************************
  3577
  3578     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3579         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3580                                INDEXED BY CF-MORT-NDX.
  3581             20  CF-MORT-TABLE              PIC X(5).
  3582             20  CF-MORT-TABLE-TYPE         PIC X.
  3583                 88  CF-MORT-JOINT              VALUE 'J'.
  3584                 88  CF-MORT-SINGLE             VALUE 'S'.
  3585                 88  CF-MORT-COMBINED           VALUE 'C'.
  3586                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3587                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3588             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3589             20  CF-MORT-AGE-METHOD         PIC XX.
  3590                 88  CF-AGE-LAST                VALUE 'AL'.
  3591                 88  CF-AGE-NEAR                VALUE 'AN'.
  3592             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3593             20  CF-MORT-ADJUSTMENT-DIRECTION
  3594                                            PIC X.
  3595                 88  CF-MINUS                   VALUE '-'.
  3596                 88  CF-PLUS                    VALUE '+'.
  3597             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3598             20  CF-MORT-JOINT-CODE         PIC X.
  3599                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3600             20  CF-MORT-PC-Q               PIC X.
  3601                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3602             20  CF-MORT-TABLE-CODE         PIC X(4).
  3603             20  CF-MORT-COMMENTS           PIC X(15).
  3604             20  FILLER                     PIC X(14).
  3605
  3606         16  FILLER                         PIC X(251).
  3607
  3608
  3609****************************************************************
  3610*             BUSSINESS TYPE MASTER RECORD                     *
  3611****************************************************************
  3612
  3613     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3614* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3615* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3616* AND RECORD 05 IS TYPES 81-99
  3617         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3618             20  CF-BUSINESS-TITLE          PIC  X(19).
  3619             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3620                                            PIC S9V9(4) COMP-3.
  3621             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3622             20  FILLER                     PIC  X.
  3623         16  FILLER                         PIC  X(248).
  3624
  3625
  3626****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  74
* EL642.cbl
  3627*             TERMINAL MASTER RECORD                           *
  3628****************************************************************
  3629
  3630     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3631
  3632         16  CF-COMPANY-TERMINALS.
  3633             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3634                                  PIC X(4).
  3635         16  FILLER               PIC X(248).
  3636
  3637
  3638****************************************************************
  3639*             LIFE EDIT MASTER RECORD                          *
  3640****************************************************************
  3641
  3642     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3643         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3644             20  CF-LIFE-CODE-IN            PIC XX.
  3645             20  CF-LIFE-CODE-OUT           PIC XX.
  3646         16  FILLER                         PIC X(248).
  3647
  3648
  3649****************************************************************
  3650*             AH EDIT MASTER RECORD                            *
  3651****************************************************************
  3652
  3653     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3654         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3655             20  CF-AH-CODE-IN              PIC XXX.
  3656             20  CF-AH-CODE-OUT             PIC XX.
  3657         16  FILLER                         PIC X(248).
  3658
  3659
  3660****************************************************************
  3661*             CREDIBILITY TABLES                               *
  3662****************************************************************
  3663
  3664     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3665         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3666                             INDEXED BY CF-CRDB-NDX.
  3667             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3668             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3669             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3670         16  FILLER                         PIC  X(332).
  3671
  3672
  3673****************************************************************
  3674*             REPORT CUSTOMIZATION RECORD                      *
  3675****************************************************************
  3676
  3677     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3678         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3679             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3680             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3681             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3682**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3683****       A T-TRANSFER.                                   ****
  3684             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  75
* EL642.cbl
  3685
  3686         16  FILLER                         PIC XX.
  3687
  3688         16  CF-CARRIER-CNTL-OPT.
  3689             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3690                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3691                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3692             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3693                                            PIC X.
  3694         16  CF-GROUP-CNTL-OPT.
  3695             20  CF-GROUP-OPT-SEQ           PIC 9.
  3696                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3697                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3698             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3699                                            PIC X(6).
  3700         16  CF-STATE-CNTL-OPT.
  3701             20  CF-STATE-OPT-SEQ           PIC 9.
  3702                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3703                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3704             20  CF-STATE-SELECT OCCURS 3 TIMES
  3705                                            PIC XX.
  3706         16  CF-ACCOUNT-CNTL-OPT.
  3707             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3708                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3709                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3710             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3711                                            PIC X(10).
  3712         16  CF-BUS-TYP-CNTL-OPT.
  3713             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3714                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3715                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3716             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3717                                            PIC XX.
  3718         16  CF-LF-TYP-CNTL-OPT.
  3719             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3720                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3721                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3722             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3723                                            PIC XX.
  3724         16  CF-AH-TYP-CNTL-OPT.
  3725             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3726                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3727                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3728             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3729                                            PIC XX.
  3730         16  CF-REPTCD1-CNTL-OPT.
  3731             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3732                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3733                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3734             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3735                                            PIC X(10).
  3736         16  CF-REPTCD2-CNTL-OPT.
  3737             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3738                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3739                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3740             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3741                                            PIC X(10).
  3742         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  76
* EL642.cbl
  3743             20  CF-USER1-OPT-SEQ           PIC 9.
  3744                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3745                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3746             20  CF-USER1-SELECT OCCURS 3 TIMES
  3747                                            PIC X(10).
  3748         16  CF-USER2-CNTL-OPT.
  3749             20  CF-USER2-OPT-SEQ           PIC 9.
  3750                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3751                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3752             20  CF-USER2-SELECT OCCURS 3 TIMES
  3753                                            PIC X(10).
  3754         16  CF-USER3-CNTL-OPT.
  3755             20  CF-USER3-OPT-SEQ           PIC 9.
  3756                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3757                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3758             20  CF-USER3-SELECT OCCURS 3 TIMES
  3759                                            PIC X(10).
  3760         16  CF-USER4-CNTL-OPT.
  3761             20  CF-USER4-OPT-SEQ           PIC 9.
  3762                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3763                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3764             20  CF-USER4-SELECT OCCURS 3 TIMES
  3765                                            PIC X(10).
  3766         16  CF-USER5-CNTL-OPT.
  3767             20  CF-USER5-OPT-SEQ           PIC 9.
  3768                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3769                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3770             20  CF-USER5-SELECT OCCURS 3 TIMES
  3771                                            PIC X(10).
  3772         16  CF-REINS-CNTL-OPT.
  3773             20  CF-REINS-OPT-SEQ           PIC 9.
  3774                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3775                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3776             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3777                 24  CF-REINS-PRIME         PIC XXX.
  3778                 24  CF-REINS-SUB           PIC XXX.
  3779
  3780         16  CF-AGENT-CNTL-OPT.
  3781             20  CF-AGENT-OPT-SEQ           PIC 9.
  3782                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3783                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3784             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3785                                            PIC X(10).
  3786
  3787         16  FILLER                         PIC X(43).
  3788
  3789         16  CF-LOSS-RATIO-SELECT.
  3790             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3791             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3792         16  CF-ENTRY-DATE-SELECT.
  3793             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3794             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3795         16  CF-EFFECTIVE-DATE-SELECT.
  3796             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3797             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3798
  3799         16  CF-EXCEPTION-LIST-IND          PIC X.
  3800             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  77
* EL642.cbl
  3801
  3802         16  FILLER                         PIC X(318).
  3803
  3804****************************************************************
  3805*                  EXCEPTION REPORTING RECORD                  *
  3806****************************************************************
  3807
  3808     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3809         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3810             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3811
  3812         16  CF-COMBINED-LIFE-AH-OPT.
  3813             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3814             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3815             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3816             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3817
  3818         16  CF-LIFE-OPT.
  3819             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3820             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3821             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3822             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3823             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3824             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3825             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3826             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3827             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3828             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3829
  3830         16  CF-AH-OPT.
  3831             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3832             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3833             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3834             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3835             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3836             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3837             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3838             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3839             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3840             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3841
  3842         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3843             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3844             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3845             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3846
  3847         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3848
  3849         16  FILLER                         PIC X(673).
  3850
  3851
  3852****************************************************************
  3853*             MORTGAGE SYSTEM PLAN RECORD                      *
  3854****************************************************************
  3855
  3856     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3857         16  CF-PLAN-TYPE                   PIC X.
  3858             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  78
* EL642.cbl
  3859             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3860             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3861         16  CF-PLAN-ABBREV                 PIC XXX.
  3862         16  CF-PLAN-DESCRIPT               PIC X(10).
  3863         16  CF-PLAN-NOTES                  PIC X(20).
  3864         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3865         16  CF-PLAN-UNDERWRITING.
  3866             20  CF-PLAN-TERM-DATA.
  3867                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3868                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3869             20  CF-PLAN-AGE-DATA.
  3870                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3871                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3872                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3873             20  CF-PLAN-BENEFIT-DATA.
  3874                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3875                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3876                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3877                                            PIC S9(7)V99  COMP-3.
  3878         16  CF-PLAN-POLICY-FORMS.
  3879             20  CF-POLICY-FORM             PIC X(12).
  3880             20  CF-MASTER-APPLICATION      PIC X(12).
  3881             20  CF-MASTER-POLICY           PIC X(12).
  3882         16  CF-PLAN-RATING.
  3883             20  CF-RATE-CODE               PIC X(5).
  3884             20  CF-SEX-RATING              PIC X.
  3885                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3886                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3887             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3888             20  CF-SUB-STD-TYPE            PIC X.
  3889                 88  CF-PCT-OF-PREM            VALUE '1'.
  3890                 88  CF-PCT-OF-BENE            VALUE '2'.
  3891         16  CF-PLAN-PREM-TOLERANCES.
  3892             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3893             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3894         16  CF-PLAN-PYMT-TOLERANCES.
  3895             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3896             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3897         16  CF-PLAN-MISC-DATA.
  3898             20  FILLER                     PIC X.
  3899             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3900             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3901         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3902         16  CF-PLAN-IND-GRP                PIC X.
  3903             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3904                                                     '1'.
  3905             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3906                                                     '2'.
  3907         16  CF-MIB-SEARCH-SW               PIC X.
  3908             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3909             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3910             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3911             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3912         16  CF-ALPHA-SEARCH-SW             PIC X.
  3913             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3914             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3915             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3916             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  79
* EL642.cbl
  3917             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3918             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3919             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3920             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3921             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3922             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3923                                                     'A' 'B' 'C'
  3924                                                     'X' 'Y' 'Z'.
  3925         16  CF-EFF-DT-RULE-SW              PIC X.
  3926             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3927             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3928             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3929             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3930             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3931         16  FILLER                         PIC X(4).
  3932         16  CF-HEALTH-QUESTIONS            PIC X.
  3933             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3934         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3935         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3936         16  CF-PLAN-SNGL-JNT               PIC X.
  3937             88  CF-COMBINED-PLAN              VALUE 'C'.
  3938             88  CF-JNT-PLAN                   VALUE 'J'.
  3939             88  CF-SNGL-PLAN                  VALUE 'S'.
  3940         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3941         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3942         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3943         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3944         16  CF-RERATE-CNTL                 PIC  X.
  3945             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3946             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3947             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3948             88  CF-AUTO-RECALC                 VALUE '4'.
  3949         16  CF-BENEFIT-TYPE                PIC  X.
  3950             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3951             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3952         16  CF-POLICY-FEE                  PIC S999V99
  3953                                                    COMP-3.
  3954         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3955         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3956         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3957         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3958         16  FILLER                         PIC  X(32).
  3959         16  CF-TERMINATION-FORM            PIC  X(04).
  3960         16  FILLER                         PIC  X(08).
  3961         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3962                                                       COMP-3.
  3963         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3964         16  CF-ISSUE-LETTER                PIC  X(4).
  3965         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3966         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3967             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3968             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3969         16  CF-MP-REFUND-CALC              PIC X.
  3970             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3971             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3972             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3973             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3974             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  80
* EL642.cbl
  3975             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3976             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3977             88  CF-MP-REFD-MEAN                VALUE '8'.
  3978         16  CF-ALT-RATE-CODE               PIC  X(5).
  3979
  3980
  3981         16  FILLER                         PIC X(498).
  3982****************************************************************
  3983*             MORTGAGE COMPANY MASTER RECORD                   *
  3984****************************************************************
  3985
  3986     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3987         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3988         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3989             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3990             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3991             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3992             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3993             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3994
  3995         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3996         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3997         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3998         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3999         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4000
  4001         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4002             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4003         16  CF-MP-RECON-USE-IND            PIC X(1).
  4004             88  CF-MP-USE-RECON             VALUE 'Y'.
  4005         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4006             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4007         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4008             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4009             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4010         16  FILLER                         PIC X(1).
  4011         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4012             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4013         16  CF-MORTG-MIB-VERSION           PIC X.
  4014             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4015             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4016             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4017         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4018             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4019                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4020             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4021                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4022             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4023                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4024             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4025                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4026             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4027                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4028             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4029                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4030         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4031         16  FILLER                         PIC X(7).
  4032         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  81
* EL642.cbl
  4033             20  CF-MORTG-MIB-COMM          PIC X(5).
  4034             20  CF-MORTG-MIB-TERM          PIC X(5).
  4035         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4036             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4037         16  FILLER                         PIC X(03).
  4038         16  CF-MP-CHECK-NO-CONTROL.
  4039             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4040                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4041                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4042                                                ' ' LOW-VALUES.
  4043                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4044                                               VALUE '3'.
  4045         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4046         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4047         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4048             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4049                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4050             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4051                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4052             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4053                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4054             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4055                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4056             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4057                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4058             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4059                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4060         16  CF-MORTG-BILLING-AREA.
  4061             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4062                                            PIC X.
  4063         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4064         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4065         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4066         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4067             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4068             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4069         16  FILLER                         PIC X.
  4070         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4071             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4072             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4073         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4074         16  FILLER                         PIC X(8).
  4075         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4076         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4077         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4078         16  CF-ACH-COMPANY-ID.
  4079             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4080                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4081                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4082                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4083             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4084         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4085             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4086         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4087             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4088             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4089         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4090         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  82
* EL642.cbl
  4091         16  FILLER                         PIC X(536).
  4092
  4093****************************************************************
  4094*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4095****************************************************************
  4096
  4097     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4098         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4099             20  CF-FEMALE-HEIGHT.
  4100                 24  CF-FEMALE-FT           PIC 99.
  4101                 24  CF-FEMALE-IN           PIC 99.
  4102             20  CF-FEMALE-MIN-WT           PIC 999.
  4103             20  CF-FEMALE-MAX-WT           PIC 999.
  4104         16  FILLER                         PIC X(428).
  4105
  4106     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4107         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4108             20  CF-MALE-HEIGHT.
  4109                 24  CF-MALE-FT             PIC 99.
  4110                 24  CF-MALE-IN             PIC 99.
  4111             20  CF-MALE-MIN-WT             PIC 999.
  4112             20  CF-MALE-MAX-WT             PIC 999.
  4113         16  FILLER                         PIC X(428).
  4114******************************************************************
  4115*             AUTOMATIC ACTIVITY RECORD                          *
  4116******************************************************************
  4117     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4118         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4119             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4120             20  CF-SYS-LETTER-ID           PIC X(04).
  4121             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4122             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4123             20  CF-SYS-RESET-SW            PIC X(01).
  4124             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4125             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4126
  4127         16  FILLER                         PIC X(50).
  4128
  4129         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4130             20  CF-USER-ACTIVE-SW          PIC X(01).
  4131             20  CF-USER-LETTER-ID          PIC X(04).
  4132             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4133             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4134             20  CF-USER-RESET-SW           PIC X(01).
  4135             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4136             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4137             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4138
  4139         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  83
* EL642.cbl
  4141*                            COPY ERCCOMP.
  4142******************************************************************
  4143*                                                                *
  4144*                                                                *
  4145*                            ERCCOMP                             *
  4146*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4147*                            VMOD=2.019                          *
  4148*                                                                *
  4149*   ONLINE CREDIT SYSTEM                                         *
  4150*                                                                *
  4151*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4152*                                                                *
  4153*   FILE TYPE = VSAM,KSDS                                        *
  4154*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4155*                                                                *
  4156*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4157*       ALTERNATE PATH = NONE                                    *
  4158*                                                                *
  4159*   LOG = NO                                                     *
  4160*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4161*                                                                *
  4162******************************************************************
  4163*                   C H A N G E   L O G
  4164*
  4165* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4166*-----------------------------------------------------------------
  4167*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4168* EFFECTIVE    NUMBER
  4169*-----------------------------------------------------------------
  4170* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4171* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4172* 092205    2005050300006  PEMA  ADD LEASE FEE
  4173* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4174* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4175* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4176* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4177* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4178* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4179******************************************************************
  4180
  4181 01  COMPENSATION-MASTER.
  4182     12  CO-RECORD-ID                          PIC XX.
  4183         88  VALID-CO-ID                          VALUE 'CO'.
  4184
  4185     12  CO-CONTROL-PRIMARY.
  4186         16  CO-COMPANY-CD                     PIC X.
  4187         16  CO-CONTROL.
  4188             20  CO-CTL-1.
  4189                 24  CO-CARR-GROUP.
  4190                     28  CO-CARRIER            PIC X.
  4191                     28  CO-GROUPING.
  4192                         32  CO-GROUP-PREFIX   PIC XXX.
  4193                         32  CO-GROUP-PRIME    PIC XXX.
  4194                 24  CO-RESP-NO.
  4195                     28  CO-RESP-PREFIX        PIC X(4).
  4196                     28  CO-RESP-PRIME         PIC X(6).
  4197             20  CO-CTL-2.
  4198                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  84
* EL642.cbl
  4199                     28  CO-ACCT-PREFIX        PIC X(4).
  4200                     28  CO-ACCT-PRIME         PIC X(6).
  4201         16  CO-TYPE                           PIC X.
  4202             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4203             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4204             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4205
  4206     12  CO-MAINT-INFORMATION.
  4207         16  CO-LAST-MAINT-DT                  PIC XX.
  4208         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4209         16  CO-LAST-MAINT-USER                PIC X(4).
  4210     12  FILLER                                PIC XX.
  4211     12  CO-STMT-TYPE                          PIC XXX.
  4212     12  CO-COMP-TYPE                          PIC X.
  4213         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4214     12  CO-STMT-OWNER                         PIC X(4).
  4215     12  CO-BALANCE-CONTROL                    PIC X.
  4216         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4217         88  CO-NO-BALANCE                        VALUE 'N'.
  4218
  4219     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4220         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4221         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4222         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4223
  4224     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4225         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4226         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4227
  4228     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4229     12  CO-GA-DIRECT-DEP                      PIC X.
  4230     12  CO-FUTURE-SPACE                       PIC X.
  4231         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4232
  4233     12  CO-ACCT-NAME                          PIC X(30).
  4234     12  CO-MAIL-NAME                          PIC X(30).
  4235     12  CO-ADDR-1                             PIC X(30).
  4236     12  CO-ADDR-2                             PIC X(30).
  4237     12  CO-ADDR-3.
  4238         16  CO-ADDR-CITY                      PIC X(27).
  4239         16  CO-ADDR-STATE                     PIC XX.
  4240     12  CO-CSO-1099                           PIC X.
  4241     12  CO-ZIP.
  4242         16  CO-ZIP-PRIME.
  4243             20  CO-ZIP-PRI-1ST                PIC X.
  4244                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4245             20  FILLER                        PIC X(4).
  4246         16  CO-ZIP-PLUS4                      PIC X(4).
  4247     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4248         16  CO-CAN-POSTAL-1                   PIC XXX.
  4249         16  CO-CAN-POSTAL-2                   PIC XXX.
  4250         16  FILLER                            PIC XXX.
  4251     12  CO-SOC-SEC                            PIC X(13).
  4252     12  CO-TELEPHONE.
  4253         16  CO-AREA-CODE                      PIC XXX.
  4254         16  CO-PREFIX                         PIC XXX.
  4255         16  CO-PHONE                          PIC X(4).
  4256
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  85
* EL642.cbl
  4257     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4258
  4259     12  CO-AR-BAL-LEVEL                       PIC X.
  4260         88  CO-AR-REF-LVL                        VALUE '1'.
  4261         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4262         88  CO-AR-BILL-LVL                       VALUE '2'.
  4263         88  CO-AR-AGT-LVL                        VALUE '3'.
  4264         88  CO-AR-FR-LVL                         VALUE '4'.
  4265
  4266     12  CO-AR-NORMAL-PRINT                    PIC X.
  4267         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4268         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4269
  4270     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4271
  4272     12  CO-AR-REPORTING                       PIC X.
  4273         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4274         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4275
  4276     12  CO-AR-PULL-CHECK                      PIC X.
  4277         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4278         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4279
  4280     12  CO-AR-BALANCE-PRINT                   PIC X.
  4281         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4282
  4283     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4284         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4285         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4286         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4287
  4288     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4289
  4290     12  CO-USER-CODE                          PIC X.
  4291     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4292
  4293******************************************************************
  4294*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4295*    THE LAST MONTH END RUN.
  4296******************************************************************
  4297
  4298     12  CO-LAST-ACTIVITY-DATE.
  4299         16  CO-ACT-YEAR                       PIC 99.
  4300         16  CO-ACT-MONTH                      PIC 99.
  4301         16  CO-ACT-DAY                        PIC 99.
  4302
  4303     12  CO-LAST-STMT-DT.
  4304         16  CO-LAST-STMT-YEAR                 PIC 99.
  4305         16  CO-LAST-STMT-MONTH                PIC 99.
  4306         16  CO-LAST-STMT-DAY                  PIC 99.
  4307
  4308     12  CO-MO-END-TOTALS.
  4309         16  CO-MONTHLY-TOTALS.
  4310             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4311             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4312             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4313             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4314             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  86
* EL642.cbl
  4315
  4316         16  CO-AGING-TOTALS.
  4317             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4318             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4319             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4320             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4321
  4322         16  CO-YTD-TOTALS.
  4323             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4324             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4325
  4326         16  CO-OVER-UNDER-TOTALS.
  4327             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4328             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4329
  4330     12  CO-MISCELLANEOUS-TOTALS.
  4331         16  CO-FICA-TOTALS.
  4332             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4333             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4334
  4335         16  CO-CLAIM-TOTALS.
  4336             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4337             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4338
  4339******************************************************************
  4340*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4341*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4342******************************************************************
  4343
  4344     12  CO-CURRENT-TOTALS.
  4345         16  CO-CURRENT-LAST-STMT-DT.
  4346             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4347             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4348             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4349
  4350         16  CO-CURRENT-MONTHLY-TOTALS.
  4351             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4352             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4353             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4354             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4355             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4356
  4357         16  CO-CURRENT-AGING-TOTALS.
  4358             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4359             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4360             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4361             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4362
  4363         16  CO-CURRENT-YTD-TOTALS.
  4364             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4365             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4366
  4367     12  CO-PAID-COMM-TOTALS.
  4368         16  CO-YTD-PAID-COMMS.
  4369             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4370             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4371
  4372     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  87
* EL642.cbl
  4373         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4374         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4375
  4376     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4377         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4378         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4379         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4380         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4381         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4382         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4383         88  CO-FINAL-LETTER                  VALUE 'F'.
  4384         88  CO-RECONCILING                   VALUE 'R'.
  4385         88  CO-PHONE-CALL                    VALUE 'P'.
  4386         88  CO-LEGAL                         VALUE 'L'.
  4387         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4388         88  CO-WRITE-OFF                     VALUE 'W'.
  4389         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4390
  4391     12  CO-CSR-CODE                       PIC X(4).
  4392
  4393     12  CO-GA-STATUS-INFO.
  4394         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4395         16  CO-GA-TERMINATION-DT          PIC XX.
  4396         16  CO-GA-STATUS-CODE             PIC X.
  4397             88  CO-GA-ACTIVE                 VALUE 'A'.
  4398             88  CO-GA-INACTIVE               VALUE 'I'.
  4399             88  CO-GA-PENDING                VALUE 'P'.
  4400         16  CO-GA-COMMENTS.
  4401             20  CO-GA-COMMENT-1           PIC X(40).
  4402             20  CO-GA-COMMENT-2           PIC X(40).
  4403             20  CO-GA-COMMENT-3           PIC X(40).
  4404             20  CO-GA-COMMENT-4           PIC X(40).
  4405
  4406     12  CO-RPTCD2                         PIC X(10).
  4407     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4408         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4409         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4410
  4411     12  CO-TYPE-AGENT                     PIC X(01).
  4412         88  CO-CORPORATION                   VALUE 'C'.
  4413         88  CO-PARTNERSHIP                   VALUE 'P'.
  4414         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4415         88  CO-TRUST                         VALUE 'T'.
  4416         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4417
  4418     12  CO-FAXNO.
  4419         16  CO-FAX-AREA-CODE                  PIC XXX.
  4420         16  CO-FAX-PREFIX                     PIC XXX.
  4421         16  CO-FAX-PHONE                      PIC X(4).
  4422
  4423     12  CO-BANK-INFORMATION.
  4424         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4425         16  CO-BANK-TRANSIT-NON REDEFINES
  4426             CO-BANK-TRANSIT-NO                PIC 9(8).
  4427
  4428         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4429     12  CO-MISC-DEDUCT-INFO REDEFINES
  4430                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  88
* EL642.cbl
  4431         16  CO-MD-GL-ACCT                     PIC X(10).
  4432         16  CO-MD-DIV                         PIC XX.
  4433         16  CO-MD-CENTER                      PIC X(4).
  4434         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4435         16  CO-CREATE-AP-CHECK                PIC X.
  4436         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4437         16  FILLER                            PIC XXX.
  4438     12  CO-ACH-STATUS                         PIC X.
  4439         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4440         88  CO-ACH-PENDING                        VALUE 'P'.
  4441
  4442     12  CO-BILL-SW                            PIC X.
  4443     12  CO-CONTROL-NAME                       PIC X(30).
  4444     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4445     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4446     12  CO-CLP-STATE                          PIC XX.
  4447     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4448     12  CO-SPP-REFUND-EDIT                    PIC X.
  4449
  4450******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  89
* EL642.cbl
  4452*                            COPY ERCPYAJ.
  4453******************************************************************
  4454*                                                                *
  4455*                            ERCPYAJ                             *
  4456*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4457*                            VMOD=2.015                          *
  4458*                                                                *
  4459*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  4460*                                                                *
  4461*                                                                *
  4462*   FILE TYPE = VSAM,KSDS                                        *
  4463*   RECORD SIZE = 200  RECFORM = FIXED                           *
  4464*                                                                *
  4465*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  4466*       ALTERNATE PATHS = NONE                                   *
  4467*                                                                *
  4468*   LOG = YES                                                    *
  4469*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4470******************************************************************
  4471******************************************************************
  4472*                   C H A N G E   L O G
  4473*
  4474* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4475*-----------------------------------------------------------------
  4476*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4477* EFFECTIVE    NUMBER
  4478*-----------------------------------------------------------------
  4479* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  4480* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  4481******************************************************************
  4482
  4483 01  PENDING-PAY-ADJ.
  4484     12  PY-RECORD-ID                     PIC XX.
  4485         88  VALID-PY-ID                        VALUE 'PY'.
  4486
  4487     12  PY-CONTROL-PRIMARY.
  4488         16  PY-COMPANY-CD                PIC X.
  4489         16  PY-CARRIER                   PIC X.
  4490         16  PY-GROUPING                  PIC X(6).
  4491         16  PY-FIN-RESP                  PIC X(10).
  4492         16  PY-ACCOUNT                   PIC X(10).
  4493         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  4494                                          PIC X(10).
  4495         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  4496         16  PY-RECORD-TYPE               PIC X.
  4497             88  PY-REMIT-RECEIVED            VALUE 'R'.
  4498             88  PY-DEPOSIT                   VALUE 'D'.
  4499             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  4500             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  4501             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  4502             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  4503             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  4504             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  4505             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  4506             88  PY-FICA-ENTRY                VALUE 'F'.
  4507             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  4508             88  PY-POLICY-FEE                VALUE 'W'.
  4509             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  90
* EL642.cbl
  4510
  4511     12  PY-PYMT-TYPE                     PIC X.
  4512             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  4513             88  PY-REINS-PYMT                VALUE 'R'.
  4514             88  PY-EXP-PYMT                  VALUE 'E'.
  4515
  4516     12  PY-BIL-INV                       PIC X(6).
  4517     12  PY-REF-NO                        PIC X(12).
  4518
  4519     12  PY-LAST-MAINT-DT                 PIC XX.
  4520     12  PY-LAST-MAINT-BY                 PIC X(4).
  4521     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4522
  4523     12  PY-PYADJ-RECORD.
  4524         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  4525         16  PY-ENTRY-COMMENT             PIC X(30).
  4526         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  4527             20  PY-GL-ACCOUNT            PIC X(10).
  4528             20  PY-GL-STATE              PIC X(02).
  4529             20  PY-GL-CANC-SW            PIC X(01).
  4530                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  4531                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  4532             20  PY-GL-COMMENT            PIC X(10).
  4533             20  FILLER      REDEFINES PY-GL-COMMENT.
  4534                 24  PY-GL-CHECK-NO       PIC 9(06).
  4535                 24  FILLER               PIC X(04).
  4536             20  FILLER                   PIC X(07).
  4537         16  PY-SAVE-ACCOUNT              PIC X(10).
  4538         16  PY-SAVE-TYPE                 PIC X(01).
  4539
  4540         16  PY-LETTERS.
  4541             20  PY-LETTER OCCURS 3 TIMES
  4542                           INDEXED BY PY-LET-NDX
  4543                                          PIC X(04).
  4544
  4545         16  PY-ERCOMP-TYPE               PIC X.
  4546             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  4547             88  PY-GA-TYPE                   VALUE 'G'.
  4548             88  PY-BANK-TYPE                 VALUE 'B'.
  4549         16  FILLER                       PIC X(05).
  4550
  4551     12  PY-RECORD-STATUS.
  4552         16  PY-CREDIT-SELECT-DT          PIC XX.
  4553         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  4554         16  PY-BILLED-DATE               PIC XX.
  4555         16  PY-REPORTED-DT               PIC XX.
  4556         16  PY-PMT-APPLIED               PIC X.
  4557             88  PY-ACCOUNT-PMT               VALUE 'A'.
  4558             88  PY-GA-PMT                    VALUE 'G'.
  4559             88  PY-OVWRITE-PMT               VALUE 'O'.
  4560             88  PY-NON-AR-PMT                VALUE 'N'.
  4561         16  FILLER                       PIC X(5).
  4562         16  PY-INPUT-DT                  PIC XX.
  4563         16  PY-CHECK-NUMBER              PIC X(6).
  4564         16  PY-VOID-SW                   PIC X.
  4565             88  PY-CHECK-VOIDED              VALUE 'V'.
  4566         16  PY-CHECK-ORIGIN-SW           PIC X.
  4567             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  91
* EL642.cbl
  4568             88  PY-REFUND-CHECK              VALUE 'R'.
  4569             88  PY-GA-CHECK                  VALUE 'G'.
  4570             88  PY-CHECK-WRITTEN             VALUE 'W'.
  4571             88  PY-CHECK-REVERSAL            VALUE 'V'.
  4572         16  PY-CHECK-WRITTEN-DT          PIC XX.
  4573         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  4574         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  4575         16  PY-BILL-FLAG                 PIC X.
  4576             88  PY-BILLED                    VALUE 'B'.
  4577         16  PY-AR-FLAG                   PIC X.
  4578             88  PY-AR-CYCLE                  VALUE 'C'.
  4579             88  PY-AR-MONTH-END              VALUE 'M'.
  4580         16  PY-AR-DATE                   PIC XX.
  4581
  4582     12  PY-GL-CODES.
  4583         16  PY-GL-DB                     PIC X(14).
  4584         16  PY-GL-CR                     PIC X(14).
  4585         16  PY-GL-FLAG                   PIC X.
  4586         16  PY-GL-DATE                   PIC XX.
  4587
  4588     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  4589     12  FILLER                           PIC X(3).
  4590******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  92
* EL642.cbl
  4592*                            COPY ERCACCT.
  4593******************************************************************
  4594*                                                                *
  4595*                                                                *
  4596*                            ERCACCT                             *
  4597*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4598*                            VMOD=2.031                          *
  4599*                                                                *
  4600*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4601*                                                                *
  4602*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4603*   VSAM ACCOUNT MASTER FILES.                                   *
  4604*                                                                *
  4605*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4606*                                                                *
  4607*   FILE TYPE = VSAM,KSDS                                        *
  4608*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4609*                                                                *
  4610*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4611*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4612*                                                                *
  4613*   LOG = NO                                                     *
  4614*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4615*                                                                *
  4616*                                                                *
  4617******************************************************************
  4618*                   C H A N G E   L O G
  4619*
  4620* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4621*-----------------------------------------------------------------
  4622*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4623* EFFECTIVE    NUMBER
  4624*-----------------------------------------------------------------
  4625* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4626* 092705    2005050300006  PEMA  ADD SPP LEASES
  4627* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4628* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4629* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4630* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4631* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4632******************************************************************
  4633
  4634 01  ACCOUNT-MASTER.
  4635     12  AM-RECORD-ID                      PIC XX.
  4636         88  VALID-AM-ID                      VALUE 'AM'.
  4637
  4638     12  AM-CONTROL-PRIMARY.
  4639         16  AM-COMPANY-CD                 PIC X.
  4640         16  AM-MSTR-CNTRL.
  4641             20  AM-CONTROL-A.
  4642                 24  AM-CARRIER            PIC X.
  4643                 24  AM-GROUPING.
  4644                     28 AM-GROUPING-PREFIX PIC XXX.
  4645                     28 AM-GROUPING-PRIME  PIC XXX.
  4646                 24  AM-STATE              PIC XX.
  4647                 24  AM-ACCOUNT.
  4648                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4649                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  93
* EL642.cbl
  4650             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4651                                           PIC X(19).
  4652             20  AM-CNTRL-B.
  4653                 24  AM-EXPIRATION-DT      PIC XX.
  4654                 24  FILLER                PIC X(4).
  4655             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4656                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4657
  4658     12  AM-CONTROL-BY-VAR-GRP.
  4659         16  AM-COMPANY-CD-A1              PIC X.
  4660         16  AM-VG-CARRIER                 PIC X.
  4661         16  AM-VG-GROUPING                PIC X(6).
  4662         16  AM-VG-STATE                   PIC XX.
  4663         16  AM-VG-ACCOUNT                 PIC X(10).
  4664         16  AM-VG-DATE.
  4665             20  AM-VG-EXPIRATION-DT       PIC XX.
  4666             20  FILLER                    PIC X(4).
  4667         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4668                                           PIC 9(11)      COMP-3.
  4669     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4670         16  FILLER                        PIC X(10).
  4671         16  AM-VG-KEY3.
  4672             20  AM-VG3-ACCOUNT            PIC X(10).
  4673             20  AM-VG3-EXP-DT             PIC XX.
  4674         16  FILLER                        PIC X(4).
  4675     12  AM-MAINT-INFORMATION.
  4676         16  AM-LAST-MAINT-DT              PIC XX.
  4677         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4678         16  AM-LAST-MAINT-USER            PIC X(4).
  4679         16  FILLER                        PIC XX.
  4680
  4681     12  AM-EFFECTIVE-DT                   PIC XX.
  4682     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4683
  4684     12  AM-PREV-DATES  COMP-3.
  4685         16  AM-PREV-EXP-DT                PIC 9(11).
  4686         16  AM-PREV-EFF-DT                PIC 9(11).
  4687
  4688     12  AM-REPORT-CODE-1                  PIC X(10).
  4689     12  AM-REPORT-CODE-2                  PIC X(10).
  4690
  4691     12  AM-CITY-CODE                      PIC X(4).
  4692     12  AM-COUNTY-PARISH                  PIC X(6).
  4693
  4694     12  AM-NAME                           PIC X(30).
  4695     12  AM-PERSON                         PIC X(30).
  4696     12  AM-ADDRS                          PIC X(30).
  4697     12  AM-CITY.
  4698         16  AM-ADDR-CITY                  PIC X(28).
  4699         16  AM-ADDR-STATE                 PIC XX.
  4700     12  AM-ZIP.
  4701         16  AM-ZIP-PRIME.
  4702             20  AM-ZIP-PRI-1ST            PIC X.
  4703                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4704             20  FILLER                    PIC X(4).
  4705         16  AM-ZIP-PLUS4                  PIC X(4).
  4706     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4707         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  94
* EL642.cbl
  4708         16  AM-CAN-POSTAL-2               PIC XXX.
  4709         16  FILLER                        PIC XXX.
  4710     12  AM-TEL-NO.
  4711         16  AM-AREA-CODE                  PIC 999.
  4712         16  AM-TEL-PRE                    PIC 999.
  4713         16  AM-TEL-NBR                    PIC 9(4).
  4714     12  AM-TEL-LOC                        PIC X.
  4715         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4716         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4717
  4718     12  AM-COMM-STRUCTURE.
  4719         16  AM-DEFN-1.
  4720             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4721                 24  AM-AGT.
  4722                     28  AM-AGT-PREFIX     PIC X(4).
  4723                     28  AM-AGT-PRIME      PIC X(6).
  4724                 24  AM-COM-TYP            PIC X.
  4725                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4726                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4727                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4728                 24  AM-RECALC-LV-INDIC    PIC X.
  4729                 24  AM-RETRO-LV-INDIC     PIC X.
  4730                 24  AM-GL-CODES           PIC X.
  4731                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4732                 24  FILLER                PIC X(01).
  4733         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4734             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4735                 24  FILLER                PIC X(11).
  4736                 24  AM-L-COMA             PIC XXX.
  4737                 24  AM-J-COMA             PIC XXX.
  4738                 24  AM-A-COMA             PIC XXX.
  4739                 24  FILLER                PIC X(6).
  4740
  4741     12  AM-COMM-CHANGE-STATUS             PIC X.
  4742         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4743
  4744     12  AM-CSR-CODE                       PIC X(4).
  4745
  4746     12  AM-BILLING-STATUS                 PIC X.
  4747         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4748         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4749     12  AM-AUTO-REFUND-SW                 PIC X.
  4750         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4751         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4752     12  AM-GPCD                           PIC 99.
  4753     12  AM-IG                             PIC X.
  4754         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4755         88  AM-HAS-GROUP                     VALUE '2'.
  4756     12  AM-STATUS                         PIC X.
  4757         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4758         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4759         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4760         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4761         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4762         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4763     12  AM-REMIT-TO                       PIC 99.
  4764     12  AM-ID-NO                          PIC X(11).
  4765
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  95
* EL642.cbl
  4766     12  AM-CAL-TABLE                      PIC XX.
  4767     12  AM-LF-DEVIATION                   PIC XXX.
  4768     12  AM-AH-DEVIATION                   PIC XXX.
  4769     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4770     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4771     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4772     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4773     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4774     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4775
  4776     12  AM-USER-FIELDS.
  4777         16  AM-FLD-1                      PIC XX.
  4778         16  AM-FLD-2                      PIC XX.
  4779         16  AM-FLD-3                      PIC XX.
  4780         16  AM-FLD-4                      PIC XX.
  4781         16  AM-FLD-5                      PIC XX.
  4782
  4783     12  AM-1ST-PROD-DATE.
  4784         16  AM-1ST-PROD-YR                PIC XX.
  4785         16  AM-1ST-PROD-MO                PIC XX.
  4786         16  AM-1ST-PROD-DA                PIC XX.
  4787     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4788     12  AM-CERTS-PURGED-DATE.
  4789         16  AM-PUR-YR                     PIC XX.
  4790         16  AM-PUR-MO                     PIC XX.
  4791         16  AM-PUR-DA                     PIC XX.
  4792     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4793     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4794     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4795     12  AM-INACTIVE-DATE.
  4796         16  AM-INA-MO                     PIC 99.
  4797         16  AM-INA-DA                     PIC 99.
  4798         16  AM-INA-YR                     PIC 99.
  4799     12  AM-AR-HI-CERT-DATE                PIC XX.
  4800
  4801     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4802     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4803
  4804     12  AM-OB-PAYMENT-MODE                PIC X.
  4805         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4806         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4807         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4808         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4809
  4810     12  AM-AH-ONLY-INDICATOR              PIC X.
  4811         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4812         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4813
  4814     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4815
  4816     12  AM-OVER-SHORT.
  4817         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4818         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4819
  4820     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4821     12  AM-DCC-CLP-STATE                  PIC XX.
  4822
  4823     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  96
* EL642.cbl
  4824     12  AM-RECALC-REIN                    PIC X.
  4825
  4826     12  AM-REI-TABLE                      PIC XXX.
  4827     12  AM-REI-ET-LF                      PIC X.
  4828     12  AM-REI-ET-AH                      PIC X.
  4829     12  AM-REI-PE-LF                      PIC X.
  4830     12  AM-REI-PE-AH                      PIC X.
  4831     12  AM-REI-PRT-ST                     PIC X.
  4832     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4833     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4834     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4835     12  AM-REI-GROUP-A                    PIC X(6).
  4836     12  AM-REI-MORT                       PIC X(4).
  4837     12  AM-REI-PRT-OW                     PIC X.
  4838     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4839     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4840     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4841     12  AM-REI-GROUP-B                    PIC X(6).
  4842
  4843     12  AM-TRUST-TYPE                     PIC X(2).
  4844
  4845     12  AM-EMPLOYER-STMT-USED             PIC X.
  4846     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4847
  4848     12  AM-STD-AH-TYPE                    PIC XX.
  4849     12  AM-EARN-METHODS.
  4850         16  AM-EARN-METHOD-R              PIC X.
  4851             88 AM-REF-RL-R78                 VALUE 'R'.
  4852             88 AM-REF-RL-PR                  VALUE 'P'.
  4853             88 AM-REF-RL-MEAN                VALUE 'M'.
  4854             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4855         16  AM-EARN-METHOD-L              PIC X.
  4856             88 AM-REF-LL-R78                 VALUE 'R'.
  4857             88 AM-REF-LL-PR                  VALUE 'P'.
  4858             88 AM-REF-LL-MEAN                VALUE 'M'.
  4859             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4860         16  AM-EARN-METHOD-A              PIC X.
  4861             88 AM-REF-AH-R78                 VALUE 'R'.
  4862             88 AM-REF-AH-PR                  VALUE 'P'.
  4863             88 AM-REF-AH-MEAN                VALUE 'M'.
  4864             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4865             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4866             88 AM-REF-AH-NET                 VALUE 'N'.
  4867
  4868     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4869     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4870     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4871
  4872     12  AM-RET-Y-N                        PIC X.
  4873     12  AM-RET-P-E                        PIC X.
  4874     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4875     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4876     12  AM-RET-GRP                        PIC X(6).
  4877     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4878         16  AM-POOL-PRIME                 PIC XXX.
  4879         16  AM-POOL-SUB                   PIC XXX.
  4880     12  AM-RETRO-EARNINGS.
  4881         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  97
* EL642.cbl
  4882         16  AM-RET-EARN-L                 PIC X.
  4883         16  AM-RET-EARN-A                 PIC X.
  4884     12  AM-RET-ST-TAX-USE                 PIC X.
  4885         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4886         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4887     12  AM-RETRO-BEG-EARNINGS.
  4888         16  AM-RET-BEG-EARN-R             PIC X.
  4889         16  AM-RET-BEG-EARN-L             PIC X.
  4890         16  AM-RET-BEG-EARN-A             PIC X.
  4891     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4892     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4893
  4894     12  AM-USER-SELECT-OPTIONS.
  4895         16  AM-USER-SELECT-1              PIC X(10).
  4896         16  AM-USER-SELECT-2              PIC X(10).
  4897         16  AM-USER-SELECT-3              PIC X(10).
  4898         16  AM-USER-SELECT-4              PIC X(10).
  4899         16  AM-USER-SELECT-5              PIC X(10).
  4900
  4901     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4902
  4903     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4904
  4905     12  AM-RPT045A-SWITCH                 PIC X.
  4906         88  RPT045A-OFF                   VALUE 'N'.
  4907
  4908     12  AM-INSURANCE-LIMITS.
  4909         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4910         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4911
  4912     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4913         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4914
  4915     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4916         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4917         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4918
  4919     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4920
  4921     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4922     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4923     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4924     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4925     12  AM-DCC-UEF-STATE                  PIC XX.
  4926     12  FILLER                            PIC XXX.
  4927     12  AM-REPORT-CODE-3                  PIC X(10).
  4928*    12  FILLER                            PIC X(22).
  4929
  4930     12  AM-RESERVE-DATE.
  4931         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4932         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4933         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4934
  4935     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4936     12  AM-NOTIFICATION-TYPES.
  4937         16  AM-NOTIF-OF-LETTERS           PIC X.
  4938         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4939         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  98
* EL642.cbl
  4940         16  AM-NOTIF-OF-STATUS            PIC X.
  4941
  4942     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4943         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4944         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4945         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4946         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4947
  4948     12  AM-BENEFIT-CONTROLS.
  4949         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4950             20  AM-BENEFIT-CODE           PIC XX.
  4951             20  AM-BENEFIT-TYPE           PIC X.
  4952             20  AM-BENEFIT-REVISION       PIC XXX.
  4953             20  AM-BENEFIT-REM-TERM       PIC X.
  4954             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4955             20  FILLER                    PIC XX.
  4956         16  FILLER                        PIC X(80).
  4957
  4958     12  AM-TRANSFER-DATA.
  4959         16  AM-TRANSFERRED-FROM.
  4960             20  AM-TRNFROM-CARRIER        PIC X.
  4961             20  AM-TRNFROM-GROUPING.
  4962                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4963                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4964             20  AM-TRNFROM-STATE          PIC XX.
  4965             20  AM-TRNFROM-ACCOUNT.
  4966                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4967                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4968             20  AM-TRNFROM-DTE            PIC XX.
  4969         16  AM-TRANSFERRED-TO.
  4970             20  AM-TRNTO-CARRIER          PIC X.
  4971             20  AM-TRNTO-GROUPING.
  4972                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4973                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4974             20  AM-TRNTO-STATE            PIC XX.
  4975             20  AM-TRNTO-ACCOUNT.
  4976                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4977                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4978             20  AM-TRNTO-DTE              PIC XX.
  4979         16  FILLER                        PIC X(10).
  4980
  4981     12  AM-SAVED-REMIT-TO                 PIC 99.
  4982
  4983     12  AM-COMM-STRUCTURE-SAVED.
  4984         16  AM-DEFN-1-SAVED.
  4985             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4986                 24  AM-AGT-SV             PIC X(10).
  4987                 24  AM-COM-TYP-SV         PIC X.
  4988                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4989                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4990                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4991                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4992                 24  FILLER                PIC X.
  4993                 24  AM-GL-CODES-SV        PIC X.
  4994                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4995                 24  FILLER                PIC X.
  4996         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4997             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  99
* EL642.cbl
  4998                 24  FILLER                PIC X(11).
  4999                 24  AM-L-COMA-SV          PIC XXX.
  5000                 24  AM-J-COMA-SV          PIC XXX.
  5001                 24  AM-A-COMA-SV          PIC XXX.
  5002                 24  FILLER                PIC X(6).
  5003
  5004     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5005         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5006            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5007            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5008            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5009
  5010     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5011     12  FILLER                            PIC X(120).
  5012
  5013     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5014         16  AM-CONTROL-NAME               PIC X(30).
  5015         16  AM-EXECUTIVE-ONE.
  5016             20  AM-EXEC1-NAME             PIC X(15).
  5017             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5018                                                          COMP-3.
  5019             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5020                                                          COMP-3.
  5021         16  AM-EXECUTIVE-TWO.
  5022             20  AM-EXEC2-NAME             PIC X(15).
  5023             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5024                                                          COMP-3.
  5025             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5026                                                          COMP-3.
  5027
  5028     12  AM-RETRO-ADDITIONAL-DATA.
  5029         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5030         16  AM-RETRO-PREM-P-E             PIC X.
  5031         16  AM-RETRO-CLMS-P-I             PIC X.
  5032         16  AM-RETRO-RET-BRACKET-LF.
  5033             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5034                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5035                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5036             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5037                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5038                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5039             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5040                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5041                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5042         16  AM-RETRO-RET-BRACKET-AH.
  5043             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5044                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5045                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5046                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5047             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5048                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5049                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5050             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5051                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5052                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5053
  5054     12  AM-COMMENTS.
  5055         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 100
* EL642.cbl
  5056
  5057     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5058         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5059         16  AM-FLI-BILLING-CODE           PIC X.
  5060         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5061         16  AM-FLI-UNITED-IDENT           PIC X.
  5062         16  AM-FLI-INTEREST-LOST-DATA.
  5063             20  AM-FLI-BANK-NO            PIC X(5).
  5064             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5065             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5066             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5067         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5068             20  AM-FLI-AGT                PIC X(9).
  5069             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5070             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5071         16  FILLER                        PIC X(102).
  5072
  5073     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5074         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5075             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5076             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5077             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5078             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5079             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5080         16  FILLER                          PIC X(10).
  5081******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 101
* EL642.cbl
  5083*                            COPY ERCBILL.
  5084******************************************************************
  5085*                                                                *
  5086*                                                                *
  5087*                            ERCBILL                             *
  5088*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5089*                            VMOD=2.007                          *
  5090*                                                                *
  5091*   FILE DESCRIPTION = BILLING STATEMENTS FOR PRINTING           *
  5092*                                                                *
  5093*   FILE TYPE = VSAM,KSDS                                        *
  5094*   RECORD SIZE = 210  RECFORM = FIXED                           *
  5095*                                                                *
  5096*   BASE CLUSTER = ERBILL                        RKP=2,LEN=31    *
  5097*                                                                *
  5098*   LOG = NO                                                     *
  5099*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5100******************************************************************
  5101 01  BILLING-STATEMENT.
  5102     02 BILLING-STATEMENT-FILE.
  5103     12  BI-RECORD-ID                PIC XX.
  5104         88  VALID-BI-ID                VALUE 'BI'.
  5105
  5106     12  BI-CONTROL-PRIMARY.
  5107         16  BI-COMPANY-CD           PIC X.
  5108         16  BI-CARRIER              PIC X.
  5109         16  BI-GROUPING             PIC X(6).
  5110         16  BI-ACCOUNT              PIC X(10).
  5111         16  BI-FIN-RESP             PIC X(10).
  5112         16  BI-RECORD-TYPE          PIC X.
  5113             88  BI-HEADER-DATA         VALUE '1'.
  5114             88  BI-ADDRESS-DATA        VALUE '2'.
  5115             88  BI-TEXT-DATA           VALUE '3'.
  5116         16  BI-LINE-SEQ-NO          PIC S9(4)     COMP.
  5117
  5118     12  BI-TEXT-RECORD.
  5119         16  BI-SKIP-CONTROL         PIC X.
  5120         16  BI-TEXT-LINE            PIC X(157).
  5121         16  BI-TEXT-LINE-1 REDEFINES BI-TEXT-LINE.
  5122             20  BI-ADDR-LIT         PIC X(14).
  5123             20  BI-CO               PIC X(7).
  5124             20  BI-DASH             PIC X.
  5125             20  BI-ACCT             PIC X(10).
  5126             20  FILLER              PIC XX.
  5127             20  BI-ACCT-ADDR        PIC X(30).
  5128             20  FILLER              PIC X.
  5129             20  BI-REMIT-LIT        PIC X(11).
  5130             20  FILLER              PIC XX.
  5131             20  BI-REMIT-ADDR       PIC X(30).
  5132             20  FILLER              PIC X(49).
  5133         16  BI-TEXT-LINE-2 REDEFINES BI-TEXT-LINE.
  5134             20  BI-INS-LAST-NAME    PIC X(15).
  5135             20  FILLER              PIC X.
  5136             20  BI-INS-1ST-NAME     PIC X(10).
  5137             20  FILLER REDEFINES BI-INS-1ST-NAME.
  5138                 24  BI-INS-INITS    PIC XX.
  5139                 24  FILLER          PIC X(8).
  5140             20  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 102
* EL642.cbl
  5141             20  BI-UNDRWRTR.
  5142                 24  BI-INS-INIT     PIC X.
  5143                 24  FILLER          PIC XXX.
  5144             20  BI-CERT             PIC X(11).
  5145             20  FILLER              PIC XX.
  5146             20  BI-EFF-DT           PIC X(8).
  5147             20  FILLER              PIC XX.
  5148             20  BI-CAN-DT           PIC X(8).
  5149             20  FILLER              PIC XX.
  5150             20  BI-ED-TERM          PIC ZZZ.
  5151             20  FILLER              PIC XX.
  5152             20  BI-TYPE             PIC XXXX.
  5153             20  FILLER              PIC X.
  5154             20  BI-PREM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  5155             20  FILLER              PIC X(3).
  5156             20  BI-ED-RATE          PIC ZZZ.ZZZ.
  5157             20  FILLER              PIC XX.
  5158             20  BI-COMM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  5159             20  FILLER              PIC XX.
  5160             20  BI-FACE-AMT         PIC ZZZ,ZZZ,ZZZ.ZZ-.
  5161             20  FILLER              PIC X(26).
  5162         16  BI-TEXT-LINE-3 REDEFINES BI-TEXT-LINE.
  5163             20  FILLER              PIC X(42).
  5164             20  BI-TOT-DESC         PIC X(20).
  5165             20  FILLER REDEFINES BI-TOT-DESC.
  5166                 24  BI-TOT-LIT      PIC X(6).
  5167                 24  BI-OVERRIDE-L6  PIC X(14).
  5168             20  FILLER              PIC X(11).
  5169             20  BI-TOT-PREM         PIC ZZZ,ZZZ,ZZZ.99-.
  5170             20  BI-TOT-DASH REDEFINES
  5171                 BI-TOT-PREM         PIC X(15).
  5172             20  FILLER              PIC X(11).
  5173             20  BI-COM-TOT          PIC ZZZ,ZZZ,ZZZ.99-.
  5174             20  FILLER              PIC XX.
  5175             20  BI-FACE-TOT         PIC ZZZ,ZZZ,ZZZ.99-.
  5176             20  FILLER              PIC X(26).
  5177         16  BI-TEXT-LINE-4 REDEFINES BI-TEXT-LINE.
  5178             20  BI-ENTRY-DESC       PIC X(30).
  5179             20  FILLER              PIC X(11).
  5180             20  BI-ENTRY-AMT        PIC ZZZZ,ZZZ,ZZZ.99-.
  5181             20  FILLER              PIC X(31).
  5182             20  BI-ACCTG-COMMENT    PIC X(30).
  5183             20  FILLER              PIC X(39).
  5184         16  BI-TEXT-LINE-5 REDEFINES BI-TEXT-LINE.
  5185             20  FILLER              PIC X(42).
  5186             20  BI-TOT-DESC5        PIC X(20).
  5187             20  FILLER              PIC X(11).
  5188             20  BI-TOT-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5189             20  BI-COM-TOT5         PIC ZZZ,ZZZ,ZZZ.99-.
  5190             20  BI-NON-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5191             20  BI-NON-COMM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5192             20  FILLER              PIC X(24).
  5193         16  BI-TEXT-FIRST REDEFINES BI-TEXT-LINE.
  5194             20  BI-TEXT-2-81        PIC X(80).
  5195             20  FILLER              PIC X(77).
  5196         16  BI-TEXT-LAST REDEFINES BI-TEXT-LINE.
  5197             20  FILLER              PIC X(53).
  5198             20  BI-TEXT-55-133      PIC X(79).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 103
* EL642.cbl
  5199             20  FILLER              PIC X(25).
  5200         16  BI-TEXT-TYPE            PIC X.
  5201             88 DETAIL-LINE              VALUE 'D'.
  5202         16  BI-TERM                 PIC S999.
  5203         16  BI-BENEFIT-AMT          PIC S9(9)V99 COMP-3.
  5204         16  BI-PREMIUM-AMT          PIC S9(7)V99 COMP-3.
  5205         16  BI-RATE                 PIC S99V9(5) COMP-3.
  5206
  5207     12  BI-ADDRESS-RECORD  REDEFINES  BI-TEXT-RECORD.
  5208         16  FILLER                  PIC X.
  5209         16  BI-ACCT-ADDRESS-LINE    PIC X(30).
  5210         16  FILLER                  PIC X(10).
  5211         16  BI-REMIT-ADDRESS-LINE   PIC X(30).
  5212         16  FILLER                  PIC X(106).
  5213
  5214     12  BI-HEADER-RECORD  REDEFINES  BI-TEXT-RECORD.
  5215         16  BI-PROCESSOR-CD         PIC X(4).
  5216         16  BI-STATEMENT-TYPE       PIC X.
  5217             88  BI-PREVIEW-ONLY         VALUE 'P'.
  5218         16  BI-NO-OF-COPIES         PIC S9.
  5219         16  BI-CREATION-DT          PIC XX.
  5220         16  BI-INITIAL-PRINT-DATE   PIC XX.
  5221         16  BI-ACCOUNT-TOTALS.
  5222             20  BI-BAL-FRWD         PIC S9(9)V99     COMP-3.
  5223             20  BI-PREMIUM          PIC S9(9)V99     COMP-3.
  5224             20  BI-REMITTED         PIC S9(9)V99     COMP-3.
  5225             20  BI-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5226             20  BI-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5227             20  BI-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5228             20  BI-DISBURSED        PIC S9(9)V99     COMP-3.
  5229             20  BI-END-BAL          PIC S9(9)V99     COMP-3.
  5230         16  BI-FIN-RESP-ACCT        PIC X(10).
  5231         16  BI-FIN-RESP-NAME        PIC X(30).
  5232         16  FILLER                  PIC X(79).
  5233
  5234
  5235     02 GA-BILLING-STATEMENT REDEFINES BILLING-STATEMENT-FILE.
  5236     12  FILLER                      PIC XX.
  5237
  5238     12  GA-CONTROL-PRIMARY.
  5239         16  FILLER                  PIC X(31).
  5240
  5241     12  GA-TEXT-RECORD.
  5242         16  GA-SKIP-CONTROL         PIC X.
  5243         16  GA-TEXT-LINE            PIC X(132).
  5244         16  GA-TEXT-LINE-1 REDEFINES GA-TEXT-LINE.
  5245             20  FILLER              PIC X.
  5246             20  GA-CARRIER          PIC X.
  5247             20  GA-GROUPING         PIC X(6).
  5248             20  GA-DASH             PIC X.
  5249             20  GA-AGENT            PIC X(10).
  5250             20  FILLER              PIC X.
  5251             20  GA-AGENT-ADDR       PIC X(30).
  5252             20  FILLER              PIC X(82).
  5253         16  GA-TEXT-LINE-2 REDEFINES GA-TEXT-LINE.
  5254             20  GA-ACCT             PIC X(10).
  5255             20  FILLER              PIC X.
  5256             20  GA-ACCT-NAME        PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 104
* EL642.cbl
  5257             20  GA-BEG-BAL          PIC ZZZZ,ZZZ.99-.
  5258             20  GA-NET-PREM         PIC ZZZZ,ZZZ.ZZ-.
  5259             20  GA-ACCT-COMP        PIC ZZZZ,ZZZ.ZZ-.
  5260             20  GA-PMTS-ADJS        PIC ZZZZ,ZZZ.ZZ-.
  5261             20  GA-UNPAID-NET-PREM  PIC ZZZZ,ZZZ.ZZ-.
  5262             20  GA-BEN-OVERRIDE-L6  PIC X(6).
  5263             20  FILLER              PIC X.
  5264             20  GA-OVERWRITE        PIC ZZZZ,ZZZ.ZZ-.
  5265             20  GA-AMT-DUE          PIC ZZZ,ZZZ.99-.
  5266             20  FILLER              PIC X.
  5267         16  GA-TEXT-LINE-3 REDEFINES GA-TEXT-LINE.
  5268             20  FILLER              PIC X(11).
  5269             20  GA-ENTRY-DESC       PIC X(30).
  5270             20  FILLER              PIC X(60).
  5271             20  GA-ENTRY-COMMENT    PIC X(30).
  5272             20  FILLER              PIC X.
  5273         16  FILLER.
  5274             20  GA-BENEFIT-CD       PIC XX.
  5275             20  GA-BEG-BAL-AMT      PIC S9(7)V99 COMP-3.
  5276             20  GA-END-BAL-AMT      PIC S9(7)V99 COMP-3.
  5277             20  GA-NET-PREM-AMT     PIC S9(7)V99 COMP-3.
  5278             20  GA-ACCT-COMP-AMT    PIC S9(7)V99 COMP-3.
  5279             20  GA-PMTS-ADJS-AMT    PIC S9(7)V99 COMP-3.
  5280             20  GA-UNPAID-NET-AMT   PIC S9(7)V99 COMP-3.
  5281             20  GA-OVERWRITE-AMT    PIC S9(7)V99 COMP-3.
  5282             20  GA-AMT-DUE-AMT      PIC S9(7)V99 COMP-3.
  5283
  5284     12  GA-ADDRESS-RECORD  REDEFINES  GA-TEXT-RECORD.
  5285         16  FILLER                  PIC X.
  5286         16  GA-ACCT-ADDRESS-LINE    PIC X(30).
  5287         16  FILLER                  PIC X(144).
  5288
  5289     12  GA-HEADER-RECORD  REDEFINES  GA-TEXT-RECORD.
  5290         16  GA-PROCESSOR-CD         PIC X(4).
  5291         16  GA-STATEMENT-TYPE       PIC X.
  5292             88  GA-PREVIEW-ONLY         VALUE 'P'.
  5293         16  GA-NO-OF-COPIES         PIC S9.
  5294         16  GA-CREATION-DT          PIC XX.
  5295         16  GA-INITIAL-PRINT-DATE   PIC XX.
  5296         16  GA-AGENT-TOTALS.
  5297             20  GA-NET-UNPD         PIC S9(9)V99     COMP-3.
  5298             20  GA-COMP-UNPD-PREM   PIC S9(9)V99     COMP-3.
  5299             20  GA-PREMIUM          PIC S9(9)V99     COMP-3.
  5300             20  GA-REMITTED         PIC S9(9)V99     COMP-3.
  5301             20  GA-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5302             20  GA-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5303             20  GA-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5304             20  GA-DISBURSED        PIC S9(9)V99     COMP-3.
  5305             20  GA-END-BALANCE      PIC S9(9)V99     COMP-3.
  5306         16  GA-AGENTS-NAME          PIC X(30).
  5307         16  FILLER                  PIC X(81).
  5308     12  FILLER                      PIC XX.
  5309
  5310
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 105
* EL642.cbl
  5312*                            COPY ERCCOMM.
  5313******************************************************************
  5314*                                                                *
  5315*                                                                *
  5316*                            ERCCOMM                             *
  5317*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5318*                            VMOD=2.003                          *
  5319*                                                                *
  5320*        FILE DESCRIPTION = COMPENSATION RATES WHEN DIFFERENT    *
  5321*                             FROM THOSE IN ACCOUNT MASTER       *
  5322*                                                                *
  5323*        FILE TYPE= VSAM,KSDS                                    *
  5324*        RECORD SIZE = 250    RECFORM = FIXED                    *
  5325*                                                                *
  5326*        BASE CLUSTER = CRCOMM        RKP=2,LEN=33               *
  5327*                                                                *
  5328*        LOG = YES                                               *
  5329*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5330*                                                                *
  5331******************************************************************
  5332
  5333 01  COMMISSION-EXCEPTIONS.
  5334     12  CE-RECORD-ID                PIC  XX.
  5335         88  VALID-CE-ID         VALUE 'CE'.
  5336
  5337     12  CE-CONTROL-PRIMARY.
  5338         16  CE-COMPANY-CD           PIC  X.
  5339         16  CE-CARRIER              PIC  X.
  5340         16  CE-GROUPING             PIC  X(6).
  5341         16  CE-STATE                PIC  XX.
  5342         16  CE-ACCOUNT              PIC  X(10).
  5343         16  CE-CERT-EFF-DT          PIC  XX.
  5344         16  CE-CERT-NO.
  5345             20  CE-CERT-PRIME       PIC  X(10).
  5346             20  CE-CERT-SFX         PIC  X.
  5347
  5348     12  CE-CERT-EXPIRATION-DT       PIC  XX.
  5349
  5350     12  CE-COMP-STRUCTURE.
  5351         16  CE-DEFN-1.
  5352             20  CE-AGT-COMMS       OCCURS 10 TIMES.
  5353                 24  CE-AGENT-NO    PIC  X(10).
  5354                 24  CE-COMP-TYPE   PIC  X.
  5355                 24  CE-LF-COMP     PIC SV9(5)      COMP-3.
  5356                 24  CE-AH-COMP     PIC SV9(5)      COMP-3.
  5357         16  CE-DEFN-2              REDEFINES CE-DEFN-1.
  5358             20  CE-COMP-TABLES     OCCURS 10 TIMES.
  5359                 24  FILLER         PIC  X(11).
  5360                 24  CE-LF-COMPT    PIC  X(3).
  5361                 24  CE-AH-COMPT    PIC  X(3).
  5362
  5363     12  FILLER                     PIC  X(43).
  5364******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 106
* EL642.cbl
  5366*                            COPY ERCCTBL.
  5367******************************************************************
  5368*                                                                *
  5369*                                                                *
  5370*                            ERCCTBL                             *
  5371*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5372*                            VMOD=2.003
  5373*                                                                *
  5374*   ONLINE CREDIT SYSTEM                                         *
  5375*                                                                *
  5376*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  5377*                                                                *
  5378*   FILE TYPE = VSAM,KSDS                                        *
  5379*   RECORD SIZE = 200   RECFORM = FIXED                          *
  5380*                                                                *
  5381*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  5382*       ALTERNATE PATH = NONE                                    *
  5383*                                                                *
  5384*   LOG = NO                                                     *
  5385*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5386*                                                                *
  5387*                                                                *
  5388******************************************************************
  5389
  5390 01  COMM-TABLE-RECORD.
  5391     12  CT-RECORD-ID                      PIC XX.
  5392         88  VALID-CT-ID                      VALUE 'CT'.
  5393
  5394     12  CT-CONTROL-PRIMARY.
  5395         16  CT-COMPANY-CD                 PIC X.
  5396         16  CT-TABLE                      PIC XXX.
  5397         16  CT-CNTRL-2.
  5398             20  CT-BEN-TYPE               PIC X.
  5399             20  CT-BEN-CODE               PIC XX.
  5400
  5401     12  CT-MAINT-INFORMATION.
  5402         16  CT-LAST-MAINT-DT              PIC XX.
  5403         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5404         16  CT-LAST-MAINT-USER            PIC X(4).
  5405         16  FILLER                        PIC X(31).
  5406
  5407     12  CT-LIMITS.
  5408         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  5409
  5410         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  5411
  5412         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  5413
  5414     12  CT-RATES.
  5415         16  CT-RTX          OCCURS 27 TIMES.
  5416             20  CT-RT                     PIC SV9(5)     COMP-3.
  5417             20  CT-RT-R   REDEFINES
  5418                 CT-RT                     PIC XXX.
  5419
  5420     12  FILLER                            PIC  X(42).
  5421
  5422******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 107
* EL642.cbl
  5424*                            COPY ERCGXRF.
  5425******************************************************************
  5426*                                                                *
  5427*                                                                *
  5428*                            ERCGXRF                             *
  5429*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5430*                            VMOD=2.002                          *
  5431*                                                                *
  5432*   ONLINE CREDIT SYSTEM                                         *
  5433*                                                                *
  5434*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
  5435*                                                                *
  5436*   FILE TYPE = VSAM,KSDS                                        *
  5437*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  5438*                                                                *
  5439*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
  5440*       ALTERNATE PATH = NONE                                    *
  5441*                                                                *
  5442*   LOG = NO                                                     *
  5443*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5444*                                                                *
  5445******************************************************************
  5446
  5447 01  AGENT-CROSS-REFERENCE.
  5448     12  GX-RECORD-ID                PIC XX.
  5449         88  VALID-GX-ID             VALUE 'GX'.
  5450
  5451     12  GX-CONTROL-PRIMARY.
  5452         16  GX-COMPANY-CD           PIC X.
  5453         16  GX-CARRIER              PIC X.
  5454         16  GX-GROUPING             PIC X(6).
  5455         16  GX-AGENT-NO             PIC X(10).
  5456
  5457     12  GX-MAINT-INFORMATION.
  5458         16  GX-LAST-MAINT-DT        PIC XX.
  5459         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  5460         16  GX-LAST-MAINT-USER      PIC X(4).
  5461         16  FILLER                  PIC X(9).
  5462
  5463     12  FILLER                      PIC X(37).
  5464
  5465     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
  5466
  5467     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
  5468                            DEPENDING ON GX-AGENT-POINTER-CNT.
  5469         16  GX-AM-CARRIER           PIC X.
  5470         16  GX-AM-GROUPING          PIC X(6).
  5471         16  GX-AM-STATE             PIC XX.
  5472         16  GX-AM-ACCOUNT           PIC X(10).
  5473         16  GX-AM-EXPIRATION-DT     PIC XX.
  5474         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
  5475         16  GX-LAST-BILL-DT         PIC XX.
  5476         16  GX-AM-EFF-DT            PIC XX.
  5477         16  FILLER                  PIC X(4).
  5478
  5479******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 108
* EL642.cbl
  5481*                            COPY ERCRESC.
  5482******************************************************************
  5483*                                                                *
  5484*                            ERCRESC                             *
  5485*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5486*                            VMOD=2.003                          *
  5487*                                                                *
  5488*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  5489*                                                                *
  5490*   FILE TYPE = VSAM,KSDS                                        *
  5491*   RECORD SIZE = 103 RECFORM = FIXED                            *
  5492*                                                                *
  5493*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  5494*       ALTERNATE PATH1 = NONE                                   *
  5495*                                                                *
  5496*   LOG = NO                                                     *
  5497*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5498*                                                                *
  5499******************************************************************
  5500
  5501 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  5502
  5503     10  ERRESC-RECORD-KEY.
  5504         15  RESC-COMPANY-CD           PIC   X.
  5505         15  RESC-CARRIER              PIC   X.
  5506         15  RESC-GROUP                PIC   X(6).
  5507         15  RESC-STATE                PIC   XX.
  5508         15  RESC-ACCOUNT              PIC   X(10).
  5509         15  RESC-AGENT                PIC   X(10).
  5510         15  RESC-RESIDENT-STATE       PIC   XX.
  5511         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  5512*                                           YYYYMMDD
  5513     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  5514
  5515     10  RESC-COMM-RECORD-DATA.
  5516         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  5517             20 RESC-COVERAGE-CAT      PIC    X.
  5518             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  5519             20 RESC-COMMISSION-TAB REDEFINES
  5520                RESC-COMMISSION-PER    PIC  XXX.
  5521
  5522     10  RESC-MAINT-BY                 PIC X(4).
  5523     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  5524     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  5525*                                          YYYYMMDD
  5526
  5527 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  5528                          CONTROL-FILE COMPENSATION-MASTER
  5529                          PENDING-PAY-ADJ ACCOUNT-MASTER
  5530                          BILLING-STATEMENT
  5531                          COMMISSION-EXCEPTIONS
  5532                          COMM-TABLE-RECORD
  5533                          AGENT-CROSS-REFERENCE
  5534                          ACCOUNT-RESIDENT-ST-COMMISSION.
  5535 0000-DFHEXIT SECTION.
  5536     MOVE '9#                    $   ' TO DFHEIV0.
  5537     MOVE 'EL642' TO DFHEIV1.
  5538     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 109
* EL642.cbl
  5539
  5540     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5541     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5542     MOVE EIBTRMID               TO  QID-TERM.
  5543     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5544     MOVE '5'                    TO  DC-OPTION-CODE.
  5545
  5546     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  5547
  5548     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-DATE.
  5549     MOVE DC-GREG-DATE-1-MDY     TO  WS-CURRENT-DATE-MDY.
  5550     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DATE-EDIT.
  5551
  5552     IF EIBCALEN  =  ZERO
  5553         GO TO 8800-UNAUTHORIZED-ACCESS.
  5554
  5555     IF PI-RETURN-TO-PROGRAM  =  THIS-PGM
  5556         MOVE PI-CALLING-PROGRAM  TO  RETURNED-FROM.
  5557
  5558     IF PI-CALLING-PROGRAM NOT  =  THIS-PGM
  5559         IF PI-RETURN-TO-PROGRAM NOT  =  THIS-PGM
  5560             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  5561             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  5562             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  5563             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  5564             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  5565             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  5566             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  5567             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  5568             MOVE PI-CR-CONTROL-IN-PROGRESS
  5569                                        TO  W-TRANSFER-CONTROL
  5570             MOVE SPACES
  5571                                   TO  PI-CR-CONTROL-IN-PROGRESS
  5572         ELSE
  5573             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  5574             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  5575             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  5576             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  5577             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  5578             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  5579             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  5580             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  5581
  5582     MOVE LOW-VALUES             TO  EL642AI.
  5583
  5584     IF PI-AR-PROCESSING
  5585        MOVE XCTL-635            TO XCTL-PYAJ.
  5586
  5587     IF PI-COMPANY-ID = 'DMD'
  5588        MOVE XCTL-633DMD         TO XCTL-PYAJ.
  5589
  5590     IF RETURNED-FROM  NOT =  SPACES
  5591         PERFORM 0600-RECOVER-TEMP-STORAGE  THRU  0690-EXIT
  5592         IF RETURNED-FROM  =  XCTL-PYAJ
  5593           AND  NOT  PI-VOID-BILL
  5594             MOVE ZEROS          TO  PI-ADJUSTMNTS
  5595                                     PI-DISBURSED
  5596                                     PI-REMITTED
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 110
* EL642.cbl
  5597             GO TO 1200-PYAJ-BILLING-COMPLETE
  5598         ELSE
  5599             MOVE -1             TO  APFNTERL
  5600             IF PI-TRANSFER-BEFORE-ACT
  5601                 GO TO 8100-SEND-INITIAL-MAP
  5602             ELSE
  5603                 PERFORM 5000-FORMAT-SCREEN  THRU  5090-EXIT
  5604                 GO TO 8100-SEND-INITIAL-MAP.
  5605
  5606     IF EIBTRNID  NOT =  TRANS-ID
  5607         MOVE EL642A             TO  PI-MAP-NAME
  5608         MOVE -1                 TO  APFNTERL
  5609         GO TO 8100-SEND-INITIAL-MAP.
  5610
  5611
  5612* EXEC CICS HANDLE CONDITION
  5613*        PGMIDERR  (9600-PGMID-ERROR)
  5614*        ERROR     (9990-ABEND)
  5615*    END-EXEC.
  5616*    MOVE '"$L.                  ! " #00005607' TO DFHEIV0
  5617     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5618     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5619     MOVE X'2220233030303035363037' TO DFHEIV0(25:11)
  5620     CALL 'kxdfhei1' USING DFHEIV0
  5621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5622
  5623
  5624     IF EIBAID  =  DFHCLEAR
  5625         IF PI-MAP-NAME  =  EL642B
  5626             PERFORM 5000-FORMAT-SCREEN  THRU  5090-EXIT
  5627             MOVE EL642A         TO  PI-MAP-NAME
  5628             MOVE -1             TO  APFNTERL
  5629             GO TO 8100-SEND-INITIAL-MAP
  5630         ELSE
  5631             GO TO 9400-CLEAR.
  5632
  5633     IF PI-PROCESSOR-ID  =  'LGXX'
  5634         GO TO 0200-RECEIVE.
  5635
  5636
  5637* EXEC CICS READQ TS
  5638*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  5639*        INTO    (SECURITY-CONTROL)
  5640*        LENGTH  (SC-COMM-LENGTH)
  5641*        ITEM    (SC-ITEM)
  5642*    END-EXEC.
  5643*    MOVE '*$II   L              ''   #00005624' TO DFHEIV0
  5644     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5645     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5646     MOVE X'2020233030303035363234' TO DFHEIV0(25:11)
  5647     CALL 'kxdfhei1' USING DFHEIV0,
  5648           PI-SECURITY-TEMP-STORE-ID,
  5649           SECURITY-CONTROL,
  5650           SC-COMM-LENGTH,
  5651           SC-ITEM,
  5652           DFHEIV99,
  5653           DFHEIV99
  5654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 111
* EL642.cbl
  5655
  5656
  5657     MOVE SC-CREDIT-DISPLAY (19)  TO  PI-DISPLAY-CAP.
  5658     MOVE SC-CREDIT-UPDATE  (19)  TO  PI-MODIFY-CAP.
  5659
  5660     IF NOT  DISPLAY-CAP
  5661         MOVE 'READ'              TO  SM-READ
  5662         PERFORM 9995-SECURITY-VIOLATION
  5663         MOVE ER-0070             TO  EMI-ERROR
  5664         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5665         GO TO 8100-SEND-INITIAL-MAP.
  5666
  5667 0200-RECEIVE.
  5668     IF EIBAID  =  DFHPA1  OR  DFHPA2  OR  DFHPA3
  5669         MOVE ER-0008            TO  EMI-ERROR
  5670         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5671         IF PI-MAP-NAME  =  EL642A
  5672             MOVE -1             TO  APFNTERL
  5673             GO TO 8200-SEND-DATAONLY
  5674         ELSE
  5675             MOVE -1             TO  BPFNTERL
  5676             GO TO 8200-SEND-DATAONLY.
  5677
  5678
  5679* EXEC CICS RECEIVE
  5680*        MAP     (PI-MAP-NAME)
  5681*        MAPSET  (MAPSET-NAME)
  5682*        INTO    (EL642AI)
  5683*    END-EXEC.
  5684     MOVE LENGTH OF
  5685      EL642AI
  5686       TO DFHEIV11
  5687*    MOVE '8"T I  L              ''   #00005652' TO DFHEIV0
  5688     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5689     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5690     MOVE X'2020233030303035363532' TO DFHEIV0(25:11)
  5691     CALL 'kxdfhei1' USING DFHEIV0,
  5692           PI-MAP-NAME,
  5693           EL642AI,
  5694           DFHEIV11,
  5695           MAPSET-NAME,
  5696           DFHEIV99,
  5697           DFHEIV99
  5698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5699
  5700
  5701     IF PI-MAP-NAME  =  EL642A
  5702         IF APFNTERL  GREATER THAN  ZERO
  5703             IF EIBAID  NOT =  DFHENTER
  5704                 MOVE ER-0004    TO  EMI-ERROR
  5705                 MOVE AL-UNBOF   TO  APFNTERA
  5706                 MOVE -1         TO  APFNTERL
  5707                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5708                 GO TO 8200-SEND-DATAONLY
  5709             ELSE
  5710                 IF APFNTERI  NUMERIC
  5711                   AND  APFNTERI  GREATER THAN  ZERO
  5712                   AND  APFNTERI  LESS THAN  25
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 112
* EL642.cbl
  5713                     MOVE PF-VALUES (APFNTERI)  TO  EIBAID
  5714                 ELSE
  5715                     MOVE ER-0029   TO  EMI-ERROR
  5716                     MOVE AL-UNBOF  TO  APFNTERA
  5717                     MOVE -1        TO  APFNTERL
  5718                     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5719                     GO TO 8200-SEND-DATAONLY
  5720         ELSE
  5721             NEXT SENTENCE
  5722     ELSE
  5723         IF PI-MAP-NAME  =  EL642B
  5724             IF BPFNTERL  GREATER THAN  ZERO
  5725                 IF EIBAID  NOT =  DFHENTER
  5726                     MOVE ER-0004   TO  EMI-ERROR
  5727                     MOVE AL-UNBOF  TO  BPFNTERA
  5728                     MOVE -1        TO  BPFNTERL
  5729                     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5730                     GO TO 8200-SEND-DATAONLY
  5731                 ELSE
  5732                     IF BPFNTERI  NUMERIC
  5733                       AND  BPFNTERI  GREATER THAN  ZERO
  5734                       AND  BPFNTERI  LESS THAN  25
  5735                         MOVE PF-VALUES (BPFNTERI)  TO  EIBAID
  5736                     ELSE
  5737                         MOVE ER-0029   TO  EMI-ERROR
  5738                         MOVE AL-UNBOF  TO  BPFNTERA
  5739                         MOVE -1        TO  BPFNTERL
  5740                         PERFORM 9900-ERROR-FORMAT
  5741                             THRU  9900-EXIT
  5742                         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 113
* EL642.cbl
  5744 0300-CHECK-PFKEYS.
  5745     IF EIBAID  =  DFHPF23
  5746         GO TO 8810-PF23.
  5747
  5748     IF EIBAID  =  DFHPF24
  5749         GO TO 9200-RETURN-MAIN-MENU.
  5750
  5751     IF EIBAID  =  DFHPF12
  5752         GO TO 9500-PF12.
  5753
  5754 0310-CHECK-PFKEYS.
  5755     IF EIBAID  =  DFHPF3
  5756       AND  PI-MAP-NAME  =  EL642A
  5757         PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5758         MOVE SPACES             TO  PI-CR-CONTROL-IN-PROGRESS
  5759         MOVE XCTL-650           TO  PGM-NAME
  5760         GO TO 9300-XCTL.
  5761
  5762     IF EIBAID  =  DFHPF4
  5763       AND  PI-MAP-NAME  =  EL642A
  5764        NEXT SENTENCE
  5765     ELSE
  5766        GO TO 0320-CONT-PFKEYS.
  5767
  5768     IF PI-CR-FIN-RESP  NOT =  SPACES
  5769         MOVE PI-COMP-CARRIER   TO  PI-CR-CARRIER
  5770         MOVE PI-COMP-GROUPING  TO  PI-CR-GROUPING
  5771         MOVE SPACE             TO  PI-CR-STATE
  5772         MOVE LOW-VALUES        TO  PI-CR-ACCOUNT
  5773         MOVE PI-SAV-AGENT      TO  PI-CR-FIN-RESP
  5774         MOVE 'G'               TO  PI-CR-TYPE
  5775         PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5776         MOVE XCTL-652       TO  PGM-NAME
  5777         GO TO 9300-XCTL.
  5778
  5779     IF PI-SCR-FIN-RESP EQUAL SPACES OR LOW-VALUES
  5780         GO TO 0315-PF4-ERROR.
  5781
  5782     PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT.
  5783
  5784     MOVE PI-SCR-CARRIER        TO  PI-CR-CARRIER.
  5785     MOVE PI-SCR-GROUPING       TO  PI-CR-GROUPING.
  5786     MOVE SPACE                 TO  PI-CR-STATE.
  5787     MOVE LOW-VALUES            TO  PI-CR-ACCOUNT.
  5788     MOVE PI-SCR-FIN-RESP       TO  PI-CR-FIN-RESP.
  5789     MOVE 'G'                   TO  PI-CR-TYPE.
  5790     MOVE 'Y'                   TO  PI-TRANSFER-SW.
  5791
  5792     IF PI-ZERO-CARRIER
  5793       OR  PI-ZERO-CAR-GROUP
  5794         MOVE ZEROS              TO  PI-CR-CARRIER.
  5795
  5796     IF PI-ZERO-GROUPING
  5797        OR  PI-ZERO-CAR-GROUP
  5798         MOVE ZEROS              TO  PI-CR-GROUPING.
  5799
  5800     MOVE XCTL-652       TO  PGM-NAME
  5801
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 114
* EL642.cbl
  5802     GO TO 9300-XCTL.
  5803
  5804 0315-PF4-ERROR.
  5805
  5806     MOVE ER-2407        TO  EMI-ERROR.
  5807     MOVE -1             TO  APFNTERL.
  5808     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5809     GO TO 8200-SEND-DATAONLY.
  5810
  5811 0320-CONT-PFKEYS.
  5812
  5813     IF EIBAID  =  DFHPF6
  5814       AND  PI-MAP-NAME  =  EL642A
  5815         MOVE LOW-VALUES         TO  EL642AO
  5816         MOVE PI-SAV-CARR        TO  PI-CR-CARRIER
  5817         MOVE PI-SAV-GROUP       TO  PI-CR-GROUPING
  5818         MOVE SPACE              TO  PI-CR-STATE
  5819         MOVE LOW-VALUES         TO  PI-CR-ACCOUNT
  5820         MOVE PI-SAV-AGENT       TO  PI-CR-FIN-RESP
  5821         MOVE 'G'                TO  PI-CR-TYPE
  5822         PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5823         MOVE XCTL-6401          TO  PGM-NAME
  5824         GO TO 9300-XCTL.
  5825
  5826     IF EIBAID  =  DFHPF7
  5827       AND  PI-MAP-NAME  =  EL642A
  5828         IF PI-CR-FIN-RESP  NOT =  SPACES
  5829             MOVE PI-COMP-CARRIER   TO  PI-CR-CARRIER
  5830             MOVE PI-COMP-GROUPING  TO  PI-CR-GROUPING
  5831             MOVE SPACE             TO  PI-CR-STATE
  5832             MOVE LOW-VALUES        TO  PI-CR-ACCOUNT
  5833             MOVE PI-SAV-AGENT      TO  PI-CR-FIN-RESP
  5834             MOVE 'G'               TO  PI-CR-TYPE
  5835             PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5836             MOVE XCTL-PYAJ      TO  PGM-NAME
  5837             GO TO 9300-XCTL
  5838         ELSE
  5839             IF PI-RETURN-TO-PROGRAM = XCTL-633 OR XCTL-635 OR
  5840                                       XCTL-633DMD
  5841                 GO TO 9400-CLEAR
  5842            ELSE
  5843                 MOVE ER-2411        TO  EMI-ERROR
  5844                 MOVE -1             TO  APFNTERL
  5845                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5846                 GO TO 8200-SEND-DATAONLY.
  5847
  5848     IF EIBAID  =  DFHPF8
  5849       AND  PI-MAP-NAME  =  EL642A
  5850         IF PI-CR-FIN-RESP  NOT =  SPACES
  5851             MOVE PI-SAV-CARR    TO  PI-CR-CARRIER
  5852             MOVE PI-SAV-GROUP   TO  PI-CR-GROUPING
  5853             MOVE SPACE          TO  PI-CR-STATE
  5854             MOVE LOW-VALUES     TO  PI-CR-ACCOUNT
  5855             MOVE PI-SAV-AGENT   TO  PI-CR-FIN-RESP
  5856             MOVE 'G'            TO  PI-CR-TYPE
  5857             PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5858             MOVE XCTL-658       TO  PGM-NAME
  5859             GO TO 9300-XCTL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 115
* EL642.cbl
  5860         ELSE
  5861         IF PI-SCR-FIN-RESP  NOT =  SPACES
  5862             PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5863             MOVE PI-SCR-CARRIER  TO  PI-CR-CARRIER
  5864             MOVE PI-SCR-GROUPING TO  PI-CR-GROUPING
  5865             MOVE SPACE           TO  PI-CR-STATE
  5866             MOVE LOW-VALUES      TO  PI-CR-ACCOUNT
  5867             MOVE PI-SCR-FIN-RESP TO  PI-CR-FIN-RESP
  5868             MOVE 'G'             TO  PI-CR-TYPE
  5869             MOVE XCTL-658       TO  PGM-NAME
  5870             GO TO 9300-XCTL
  5871         ELSE
  5872             MOVE ER-2399        TO  EMI-ERROR
  5873             MOVE -1             TO  APFNTERL
  5874             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5875             GO TO 8200-SEND-DATAONLY.
  5876
  5877     IF EIBAID  =  DFHPF1
  5878       AND  PI-MAP-NAME  =  EL642B
  5879         GO TO 7500-PRODUCE-CHECK.
  5880
  5881     IF EIBAID  =  DFHPF5
  5882       AND  PI-MAP-NAME  =  EL642A
  5883         IF PI-CR-FIN-RESP NOT  =  SPACES
  5884             MOVE PI-SAV-CARR    TO  PI-CR-CARRIER
  5885             MOVE PI-SAV-GROUP   TO  PI-CR-GROUPING
  5886             MOVE SPACE          TO  PI-CR-STATE
  5887             MOVE LOW-VALUES     TO  PI-CR-ACCOUNT
  5888             MOVE PI-SAV-AGENT   TO  PI-CR-FIN-RESP
  5889             MOVE 'G'            TO  PI-CR-TYPE
  5890             MOVE EL642B         TO  PI-MAP-NAME
  5891             GO TO 7000-PROCESS-CHECK
  5892         ELSE
  5893             MOVE ER-2400        TO  EMI-ERROR
  5894             MOVE -1             TO  APFNTERL
  5895             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5896             GO TO 8200-SEND-DATAONLY.
  5897
  5898     IF PI-MAP-NAME  =  EL642A
  5899         IF EIBAID  =  DFHENTER
  5900           OR  DFHPF3
  5901             GO TO 0330-EDIT-DATA.
  5902
  5903 0320-INPUT-ERROR.
  5904     MOVE ER-0029                TO  EMI-ERROR.
  5905
  5906     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5907
  5908     IF PI-MAP-NAME  =  EL642A
  5909         MOVE AL-UNBON           TO  APFNTERA
  5910         MOVE -1                 TO  APFNTERL
  5911     ELSE
  5912         MOVE AL-UNBON           TO  BPFNTERA
  5913         MOVE -1                 TO  BPFNTERL.
  5914
  5915     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 116
* EL642.cbl
  5917 0330-EDIT-DATA.
  5918     MOVE ABILTYPI               TO  VALID-BILL-TYPE-VALUES.
  5919
  5920     IF VALID-BILL-TYPE
  5921         IF NOT MODIFY-CAP
  5922             IF ABILTYPI  =  '1' OR '2'
  5923                 NEXT SENTENCE
  5924             ELSE
  5925                 MOVE 'UPDATE'   TO  SM-READ
  5926                 PERFORM 9995-SECURITY-VIOLATION
  5927                 MOVE ER-0070    TO  EMI-ERROR
  5928                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5929                 GO TO 8100-SEND-INITIAL-MAP.
  5930
  5931     MOVE SPACES                 TO  PI-LIMIT-BILLING-ACCOUNTS.
  5932
  5933 0350-ERROR-CHECK.
  5934     IF EMI-ERROR  =  ZEROS
  5935         NEXT SENTENCE
  5936     ELSE
  5937         GO TO 8200-SEND-DATAONLY.
  5938
  5939     IF AAGENTL  GREATER THAN  ZEROS
  5940         MOVE AL-UANON           TO  AAGENTA
  5941         MOVE AAGENTI            TO  PI-SAV-AGENT
  5942     ELSE
  5943         MOVE -1                 TO  AAGENTL
  5944         MOVE AL-UABON           TO  AAGENTA
  5945         MOVE ER-2910            TO  EMI-ERROR
  5946         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5947
  5948     IF ACARIERL  GREATER THAN  ZEROS
  5949         MOVE AL-UANON           TO  ACARIERA
  5950         MOVE ACARIERI           TO  PI-SAV-CARR
  5951                                     PI-CR-CARRIER
  5952                                     PI-COMP-CARRIER
  5953     ELSE
  5954         IF NOT  PI-ZERO-CARRIER
  5955           AND  NOT  PI-ZERO-CAR-GROUP
  5956             MOVE -1             TO  ACARIERL
  5957             MOVE AL-UABON       TO  ACARIERA
  5958             MOVE ER-0194        TO  EMI-ERROR
  5959             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5960         ELSE
  5961             MOVE ZERO           TO  PI-SAV-CARR
  5962                                     PI-COMP-CARRIER.
  5963
  5964     IF AGROUPL  GREATER THAN  ZEROS
  5965         MOVE AL-UANON           TO  AGROUPA
  5966         MOVE AGROUPI            TO  PI-SAV-GROUP
  5967                                     PI-CR-GROUPING
  5968                                     PI-COMP-GROUPING
  5969     ELSE
  5970         IF NOT  PI-ZERO-GROUPING
  5971           AND  NOT  PI-ZERO-CAR-GROUP
  5972             MOVE -1             TO  AGROUPL
  5973             MOVE AL-UABON       TO  AGROUPA
  5974             MOVE ER-0195        TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 117
* EL642.cbl
  5975             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5976         ELSE
  5977             MOVE ZERO           TO  PI-SAV-GROUP
  5978                                     PI-COMP-GROUPING.
  5979
  5980     MOVE ABILTYPI               TO  VALID-BILL-TYPE-VALUES.
  5981
  5982     IF VALID-BILL-TYPE
  5983         MOVE AL-UANON           TO  ABILTYPA
  5984         MOVE ABILTYPI           TO  PI-BILL-TYPE
  5985                                     WS-BILL-TYPE
  5986     ELSE
  5987         MOVE -1                 TO  ABILTYPL
  5988         MOVE ER-2249            TO  EMI-ERROR
  5989         MOVE AL-UABON           TO  ABILTYPA
  5990         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5991
  5992     IF PI-AR-PROCESSING
  5993        IF PI-PREVIEW
  5994           NEXT SENTENCE
  5995        ELSE
  5996           MOVE -1               TO ABILTYPL
  5997           MOVE ER-3145          TO EMI-ERROR
  5998           MOVE AL-UABON         TO ABILTYPA
  5999           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6000
  6001     IF APRODSWL  NOT =  ZEROS
  6002         IF PI-PREVIEW
  6003             IF APRODSWI  =  'Y'  OR  'N'
  6004                 MOVE AL-UANON   TO  APRODSWA
  6005             ELSE
  6006                 MOVE -1         TO  APRODSWL
  6007                 MOVE ER-2436    TO  EMI-ERROR
  6008                 MOVE AL-UABON   TO  APRODSWA
  6009                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6010         ELSE
  6011             MOVE -1             TO  APRODSWL
  6012             MOVE ER-2434        TO  EMI-ERROR
  6013             MOVE AL-UABON       TO  APRODSWA
  6014             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6015     ELSE
  6016         IF PI-PREVIEW
  6017             MOVE -1             TO  APRODSWL
  6018             MOVE ER-2435        TO  EMI-ERROR
  6019             MOVE AL-UABON       TO  APRODSWA
  6020             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6021
  6022     IF AACCT1L  NOT =  ZEROS
  6023         MOVE AL-UANON           TO  AACCT1A
  6024         MOVE 'Y'                TO  LIMIT-BILLING-SW
  6025         MOVE AACCT1I            TO  PI-BILLING-ACCOUNTS (1).
  6026
  6027     IF AACCT2L  NOT =  ZEROS
  6028         MOVE AL-UANON           TO  AACCT2A
  6029         MOVE 'Y'                TO  LIMIT-BILLING-SW
  6030         MOVE AACCT2I            TO  PI-BILLING-ACCOUNTS (2).
  6031
  6032     IF AACCT3L  NOT =  ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 118
* EL642.cbl
  6033         MOVE AL-UANON           TO  AACCT3A
  6034         MOVE 'Y'                TO  LIMIT-BILLING-SW
  6035         MOVE AACCT3I            TO  PI-BILLING-ACCOUNTS (3).
  6036
  6037     IF EMI-ERROR  =  ZEROS
  6038         GO TO 1000-BILLING-PROCESS.
  6039
  6040     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 119
* EL642.cbl
  6042 0500-CREATE-TEMP-STORAGE.
  6043     IF PI-BAL-FRWD  NOT  NUMERIC
  6044         MOVE ZEROS              TO  PI-BAL-FRWD
  6045                                     PI-PREMIUM
  6046                                     PI-REMITTED
  6047                                     PI-TOT-ISS-COMP
  6048                                     PI-TOT-CAN-COMP
  6049                                     PI-ADJUSTMNTS
  6050                                     PI-DISBURSED
  6051                                     PI-END-BAL
  6052                                     PI-UNPAID-NET-PREM
  6053                                     PI-COMP-UNPAID-PREM
  6054                                     PI-LF-ISS-COMP
  6055                                     PI-AH-ISS-COMP
  6056                                     PI-LF-CAN-COMP
  6057                                     PI-AH-CAN-COMP
  6058                                     PI-DUE-FOR-ACCT
  6059                                     PI-ACCT-BEG-BAL
  6060                                     PI-ACCT-NET-PREM
  6061                                     PI-ACCT-COMP
  6062                                     PI-ACCT-PAY-ADJS.
  6063
  6064
  6065* EXEC CICS WRITEQ TS
  6066*        QUEUE   (QID)
  6067*        FROM    (PROGRAM-INTERFACE-BLOCK)
  6068*        LENGTH  (PI-COMM-LENGTH)
  6069*    END-EXEC.
  6070*    MOVE '*"                    ''   #00006021' TO DFHEIV0
  6071     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  6072     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6073     MOVE X'2020233030303036303231' TO DFHEIV0(25:11)
  6074     CALL 'kxdfhei1' USING DFHEIV0,
  6075           QID,
  6076           PROGRAM-INTERFACE-BLOCK,
  6077           PI-COMM-LENGTH,
  6078           DFHEIV99,
  6079           DFHEIV99,
  6080           DFHEIV99
  6081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6082
  6083
  6084 0590-EXIT.
  6085      EXIT.
  6086
  6087 0600-RECOVER-TEMP-STORAGE.
  6088
  6089* EXEC CICS READQ TS
  6090*        QUEUE   (QID)
  6091*        INTO    (PROGRAM-INTERFACE-BLOCK)
  6092*        LENGTH  (PI-COMM-LENGTH)
  6093*    END-EXEC.
  6094*    MOVE '*$I    L              ''   #00006031' TO DFHEIV0
  6095     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  6096     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6097     MOVE X'2020233030303036303331' TO DFHEIV0(25:11)
  6098     CALL 'kxdfhei1' USING DFHEIV0,
  6099           QID,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 120
* EL642.cbl
  6100           PROGRAM-INTERFACE-BLOCK,
  6101           PI-COMM-LENGTH,
  6102           DFHEIV99,
  6103           DFHEIV99,
  6104           DFHEIV99
  6105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6106
  6107
  6108     PERFORM 0800-DELETE-TS  THRU  0890-EXIT.
  6109
  6110     MOVE PI-SCRN-CONTROL TO W-TRANSFER-CONTROL.
  6111
  6112 0690-EXIT.
  6113      EXIT.
  6114
  6115 0800-DELETE-TS.
  6116
  6117* EXEC CICS HANDLE CONDITION
  6118*        QIDERR  (0890-EXIT)
  6119*    END-EXEC.
  6120*    MOVE '"$N                   ! # #00006045' TO DFHEIV0
  6121     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  6122     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6123     MOVE X'2320233030303036303435' TO DFHEIV0(25:11)
  6124     CALL 'kxdfhei1' USING DFHEIV0
  6125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6126
  6127
  6128
  6129* EXEC CICS DELETEQ TS
  6130*        QUEUE  (QID)
  6131*    END-EXEC.
  6132*    MOVE '*&                    #   #00006049' TO DFHEIV0
  6133     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  6134     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6135     MOVE X'2020233030303036303439' TO DFHEIV0(25:11)
  6136     CALL 'kxdfhei1' USING DFHEIV0,
  6137           QID,
  6138           DFHEIV99
  6139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6140
  6141
  6142 0890-EXIT.
  6143      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 121
* EL642.cbl
  6145******************************************************************
  6146*    THIS SECTION PROCESSES THE PENDING BUSINESS FILE BASED ON   *
  6147*    ACCOUNT DATE RANGES FOR EACH ACCOUNT THAT A GENERAL AGENT   *
  6148*    RECEIVES COMMISION FROM.  THE PROFILE OF A GENERAL AGENT    *
  6149*    IS MAINTAINED IN THE AGENT-CROSS-REFERENCE FILE.            *
  6150*                                                                *
  6151*    1.  IF VOID BILLING                                         *
  6152*            GO TO VOID-BILLING.                                 *
  6153*                                                                *
  6154*    2.  READ COMPENSATIONG MASTER FOR GENERAL AGENT TO GET      *
  6155*        THE AGENT'S ENDING BALANCE AND ADDRESS.                 *
  6156*                                                                *
  6157*    3.  READ THE AGENT-CROSS-REFERENCE-FILE.                    *
  6158*                                                                *
  6159*    4.  PROCESS EACH ACCOUNT ASSOCIATED WITH A GENERAL AGENT.   *
  6160*                                                                *
  6161*        A.  PROCESSS EACH DATE RANGE PER ACCOUNT AND ACCUMULATE *
  6162*            STATISTICS FOR THAT ACCOUNT.                        *
  6163*                                                                *
  6164*            1. PROCESS THE ACTIVE RECORDS ON PENDING BUSINESS.  *
  6165*               OMIT ANY RECORDS THAT HAVE ANY FATAL OR UNFORCED *
  6166*               ERRORS.  DO NOT PROCESS ANY REINSURANCE OR BILL- *
  6167*               ING ADJUSTMENT RECORDS.  IF BILLING UPDATE, FLAG
  6168*               EACH PENDING BUSINESS RECORD THAT IS PRCESSED.   *
  6169*                                                                *
  6170*            2.  ACCUMULATE STATISTICS FOR SCREEN DISPLAY.       *
  6171*                                                                *
  6172*            3.  COMPUTE ACCOUNT AND AGENT COMMISSION.           *
  6173*                                                                *
  6174*         B.  ACCUMULATE THE PAYMENT AND ADJUSTMENTS FOR         *
  6175*             EACH ACCOUNT THE GENERAL AGENT IS RESPONSIBLE FOR. *
  6176*                                                                *
  6177*         C.  PRINT ACCUMULATED STATISTICS FOR EACH ACCOUNT.     *
  6178*             OMITT ANY ACCOUNTS THAT DIDN'T HAVE ANY NEW BUS.   *
  6179*                                                                *
  6180*    5.  PRINT AN AGENT TOTAL OF ALL THE ACCOUNTS AND THE        *
  6181*        GENERAL AGENTS PAYMENTS AND ADJUSTMENTS.                *
  6182******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 122
* EL642.cbl
  6184 1000-BILLING-PROCESS.
  6185     MOVE PI-COMPANY-CD          TO  ERPNDB-CO-CD
  6186                                     ERPNDB-CO-CD-A1
  6187                                     ERCOMP-COMP-CD
  6188                                     ERPYAJ-COMP-CD
  6189                                     ERACCT-P-CO-CD
  6190                                     ERACCT-A-CO-CD
  6191                                     ERCOMM-COMPANY-CD
  6192                                     ERCTBL-COMPANY-CD.
  6193
  6194     MOVE ZEROS                  TO  PI-BAL-FRWD
  6195                                     PI-UNKNOWN
  6196                                     PI-UNPAID-NET-PREM
  6197                                     PI-COMP-UNPAID-PREM
  6198                                     PI-PREMIUM
  6199                                     PI-REMITTED
  6200                                     PI-TOT-ISS-COMP
  6201                                     PI-TOT-CAN-COMP
  6202                                     PI-ADJUSTMNTS
  6203                                     PI-DISBURSED
  6204                                     PI-END-BAL
  6205                                     PI-LF-ISS-COMP
  6206                                     PI-AH-ISS-COMP
  6207                                     PI-LF-CAN-COMP
  6208                                     PI-AH-CAN-COMP
  6209                                     PI-DUE-FOR-ACCT
  6210                                     PI-ACCT-BEG-BAL
  6211                                     PI-ACCT-NET-PREM
  6212                                     PI-ACCT-COMP
  6213                                     PI-ACCT-PAY-ADJS
  6214                                     PI-ISSUES-BILLED
  6215                                     PI-ISSUES-INER
  6216                                     PI-ISSUES-PREV
  6217                                     PI-CANCELS-BILLED
  6218                                     PI-CANCELS-INER
  6219                                     PI-CANCELS-PREV.
  6220
  6221     IF PI-VOID-BILL
  6222         GO TO 2000-VOID-BILLING.
  6223
  6224     MOVE SPACES                 TO  ELCNTL-KEY.
  6225     MOVE '1'                    TO  ELCNTL-REC-TYPE.
  6226
  6227     PERFORM 6100-READ-CONTROL-FILE  THRU  6120-EXIT.
  6228
  6229     IF EMI-ERROR  NOT =  ZEROS
  6230         GO TO 8200-SEND-DATAONLY.
  6231
  6232     IF CF-ACCOUNT-MSTR-MAINT-DT  =  LOW-VALUES
  6233       OR  CF-COMPENSATION-MSTR-MAINT-DT  =  LOW-VALUES
  6234         MOVE ER-2571            TO  EMI-ERROR
  6235         MOVE -1                 TO  APFNTERL
  6236         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6237         GO TO 8200-SEND-DATAONLY.
  6238
  6239     IF CF-FORMS-PRINTER-ID  =  SPACES
  6240       AND  (ABILTYPI = '3'  OR  '4')
  6241         MOVE ER-2590            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 123
* EL642.cbl
  6242         MOVE -1                 TO  ABILTYPL
  6243         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6244         GO TO 8200-SEND-DATAONLY.
  6245
  6246     MOVE CF-CURRENT-MONTH-END   TO  DC-BIN-DATE-1.
  6247     MOVE SPACE                  TO  DC-OPTION-CODE.
  6248
  6249     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  6250
  6251     MOVE DC-GREG-DATE-1-EDIT    TO  PI-MONTH-END-DATE.
  6252     MOVE WS-CURRENT-DATE-EDIT   TO  HD-RUN-DT.
  6253     MOVE CF-CL-MAIL-TO-NAME     TO  CENTER-WORK-1.
  6254     MOVE +44                    TO  X-LEN.
  6255
  6256     PERFORM 8600-CENTER-DATA  THRU  8690-C-D-X.
  6257
  6258     MOVE CENTER-WORK-2          TO  HD-CO.
  6259     MOVE SPACE                  TO  PI-DATA-BILLED-SW.
  6260     MOVE 'G'                    TO  COMPENSATION-SW
  6261                                     PI-CR-TYPE.
  6262
  6263     PERFORM 6000-READ-COMP-MASTER  THRU  6090-EXIT.
  6264
  6265     PERFORM 6400-READ-CROSS-REFERENCE  THRU  6490-EXIT.
  6266
  6267     MOVE +0                     TO  GX-SUB.
  6268
  6269 1005-GXRF-BILLING-PROCESS-LOOP.
  6270     ADD +1                      TO  GX-SUB.
  6271
  6272     IF GX-SUB  GREATER THAN  GX-AGENT-POINTER-CNT
  6273         IF PI-ACCT-BILLED
  6274             PERFORM 1100-PYAJ-BILLING-PROCESS  THRU  1190-EXIT
  6275             GO TO 1200-PYAJ-BILLING-COMPLETE
  6276         ELSE
  6277             GO TO 1200-PYAJ-BILLING-COMPLETE.
  6278     IF LIMIT-BILLING
  6279         IF GX-AM-ACCOUNT (GX-SUB)  =  PI-BILLING-ACCOUNTS (1)
  6280                                   OR  PI-BILLING-ACCOUNTS (2)
  6281                                   OR  PI-BILLING-ACCOUNTS (3)
  6282             NEXT SENTENCE
  6283         ELSE
  6284             GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6285
  6286     IF FIRST-TIME
  6287         MOVE 'N'                      TO  FIRST-TIME-SW
  6288         MOVE GX-AM-CARRIER (GX-SUB)   TO  PI-CR-CARRIER
  6289         MOVE GX-AM-GROUPING (GX-SUB)  TO  PI-CR-GROUPING
  6290         MOVE GX-AM-STATE (GX-SUB)     TO  PI-CR-STATE
  6291         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  PI-CR-ACCOUNT.
  6292
  6293     IF GX-AM-CARRIER (GX-SUB)  =  PI-CR-CARRIER
  6294       AND  GX-AM-GROUPING (GX-SUB)  =  PI-CR-GROUPING
  6295       AND  GX-AM-STATE (GX-SUB)  =  PI-CR-STATE
  6296       AND  GX-AM-ACCOUNT (GX-SUB)  =  PI-CR-ACCOUNT
  6297         NEXT SENTENCE
  6298     ELSE
  6299         IF PI-ACCT-BILLED
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 124
* EL642.cbl
  6300             PERFORM 1100-PYAJ-BILLING-PROCESS  THRU  1190-EXIT
  6301             MOVE 'TA'           TO  BILLING-DETAIL-TYPE
  6302             IF APRODSWI  =  'N'
  6303                 NEXT SENTENCE
  6304             ELSE
  6305                 PERFORM 3000-WRITE-BILLING-DETAIL
  6306                     THRU  3990-EXIT.
  6307
  6308     MOVE GX-AM-CARRIER (GX-SUB)   TO  PI-CR-CARRIER.
  6309     MOVE GX-AM-GROUPING (GX-SUB)  TO  PI-CR-GROUPING.
  6310     MOVE GX-AM-STATE (GX-SUB)     TO  PI-CR-STATE.
  6311     MOVE GX-AM-ACCOUNT (GX-SUB)   TO  PI-SAV-ACCT
  6312                                       PI-CR-ACCOUNT.
  6313     MOVE GX-AM-EXPIRATION-DT (GX-SUB)
  6314                                   TO  PI-SAV-EXP-DT.
  6315
  6316     PERFORM 4300-READ-ACCOUNT-MASTER  THRU  4390-EXIT.
  6317
  6318     IF INVALID-ACCOUNT
  6319         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6320
  6321     IF PI-UPDATE-FILES
  6322         MOVE WS-GA-LEVEL        TO  GX-AM-LEVEL-NO (GX-SUB)
  6323         MOVE WS-CURRENT-DATE    TO  GX-LAST-BILL-DT (GX-SUB).
  6324
  6325     IF NEW-ACCOUNT
  6326         IF PI-ACCT-BILLED
  6327             PERFORM 1100-PYAJ-BILLING-PROCESS  THRU  1190-EXIT
  6328             MOVE 'TA'           TO  BILLING-DETAIL-TYPE
  6329             IF APRODSWI  =  'N'
  6330                 NEXT SENTENCE
  6331             ELSE
  6332                 PERFORM 3000-WRITE-BILLING-DETAIL
  6333                     THRU  3990-EXIT.
  6334
  6335     MOVE 'A'                    TO  COMPENSATION-SW
  6336                                      PI-CR-TYPE.
  6337
  6338     PERFORM 6000-READ-COMP-MASTER     THRU 6090-EXIT.
  6339     PERFORM 1100-PYAJ-BILLING-PROCESS THRU 1190-EXIT.
  6340     PERFORM 4000-PNDB-START-BROWSE    THRU 4090-EXIT.
  6341
  6342     IF PNDB-EOF
  6343         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6344
  6345 1010-PNDB-BILLING-PROCESS-LOOP.
  6346     PERFORM 4100-PNDB-READ-NEXT  THRU  4150-EXIT.
  6347
  6348     IF PNDB-EOF
  6349         PERFORM 4160-PNDB-END-BROWSE
  6350         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6351
  6352     IF PB-COMPANY-CD-A1  =  PI-COMPANY-CD  AND
  6353        PB-SV-CARRIER     =  PI-CR-CARRIER  AND
  6354        PB-SV-GROUPING    =  PI-CR-GROUPING AND
  6355        PB-SV-STATE       =  PI-CR-STATE    AND
  6356        PB-ACCOUNT        =  PI-CR-ACCOUNT
  6357         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 125
* EL642.cbl
  6358     ELSE
  6359         PERFORM 4160-PNDB-END-BROWSE
  6360         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6361
  6362     IF PB-BATCH-TRAILER
  6363         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6364
  6365     IF PB-ALT-CHG-SEQ-NO  NOT =  ZEROS
  6366         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6367
  6368     IF PB-CERT-EFF-DT LESS GX-AM-EXPIRATION-DT (GX-SUB)
  6369         NEXT SENTENCE
  6370      ELSE
  6371         PERFORM 4160-PNDB-END-BROWSE
  6372         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6373
  6374     IF PB-CERT-EFF-DT  LESS THAN  GX-AM-EFF-DT (GX-SUB)
  6375         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6376
  6377     IF PB-CERT-EFF-DT  GREATER THAN  ERACCT-P-EXP-DATE
  6378         PERFORM 4160-PNDB-END-BROWSE
  6379         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6380
  6381     IF (PB-ISSUE)
  6382       AND
  6383        (PB-I-POLICY-IS-REISSUE OR PB-I-REIN-ONLY OR
  6384         PB-I-POLICY-IS-MONTHLY OR
  6385         PB-I-POLICY-IS-DECLINED OR PB-I-POLICY-IS-VOIDED OR
  6386         PB-I-UNDERWRITE-POLICY)
  6387           GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6388     ELSE
  6389         IF (PB-CANCELLATION)
  6390           AND  (PB-CI-LF-POLICY-IS-REISSUE
  6391             OR  PB-CI-AH-POLICY-IS-REISSUE
  6392             OR  PB-CI-LF-POLICY-IS-MONTHLY
  6393             OR  PB-CI-AH-POLICY-IS-MONTHLY
  6394             OR  PB-CI-LF-POLICY-IS-DECLINED
  6395             OR  PB-CI-AH-POLICY-IS-VOID
  6396             OR  PB-CI-LF-REIN-ONLY
  6397             OR  PB-CI-AH-REIN-ONLY)
  6398               GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6399
  6400     IF PB-CREDIT-ACCEPT-DT  NOT =  LOW-VALUES
  6401         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6402
  6403     IF PB-RECORD-ON-HOLD
  6404         PERFORM 1040-UPDATE-BILLING-STATISTICS  THRU  1049-EXIT
  6405         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6406
  6407     IF PB-FATAL-ERRORS
  6408       OR  PB-UNFORCED-ERRORS
  6409         PERFORM 1040-UPDATE-BILLING-STATISTICS  THRU  1049-EXIT
  6410         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6411
  6412     MOVE 'Y'                    TO  PI-ACCT-BILLED-SW
  6413                                     PI-DATA-BILLED-SW.
  6414
  6415     PERFORM 1040-UPDATE-BILLING-STATISTICS  THRU  1049-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 126
* EL642.cbl
  6416
  6417     PERFORM 1030-COMPUTE-COMMISSION-TOTALS  THRU  1039-EXIT.
  6418
  6419     IF PI-BILL
  6420       OR  PI-REBILLING
  6421         PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT.
  6422
  6423     GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 127
* EL642.cbl
  6425 1030-COMPUTE-COMMISSION-TOTALS.
  6426     IF PB-CANCELLATION
  6427         GO TO 1035-COMPUTE-CANCEL-COMM.
  6428
  6429     MOVE SPACES                 TO WS-AH-CATEGORY
  6430     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
  6431        AND (NOT PB-INVALID-AH)
  6432        MOVE SPACES              TO ELCNTL-KEY
  6433        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6434        MOVE '5'                 TO ELCNTL-REC-TYPE
  6435        MOVE PB-I-AH-BENEFIT-CD  TO ELCNTL-ACCESS (3:2)
  6436                                    CLAS-LOOK
  6437        MOVE +0                  TO ELCNTL-SEQ-NO
  6438        PERFORM 6130-FIND-BENEFIT-CD
  6439                                 THRU 6140-EXIT
  6440     END-IF
  6441     PERFORM 4400-FIND-COMMISSION  THRU  4490-EXIT.
  6442
  6443     IF (PB-OVERRIDE-LIFE
  6444        OR PB-OVERRIDE-BOTH)
  6445        IF NOT PB-INVALID-LIFE
  6446           COMPUTE WS-I-LF-PREMIUM-AMT = PB-I-LF-PREM-CALC +
  6447                                       PB-I-LF-ALT-PREM-CALC
  6448        END-IF
  6449     ELSE
  6450        IF NOT PB-INVALID-LIFE
  6451           COMPUTE WS-I-LF-PREMIUM-AMT = PB-I-LF-PREMIUM-AMT +
  6452                                       PB-I-LF-ALT-PREMIUM-AMT
  6453        END-IF
  6454     END-IF
  6455
  6456     IF (PB-OVERRIDE-AH
  6457        OR PB-OVERRIDE-BOTH)
  6458        MOVE PB-I-AH-PREM-CALC   TO WS-I-AH-PREMIUM-AMT
  6459     ELSE
  6460        MOVE PB-I-AH-PREMIUM-AMT TO  WS-I-AH-PREMIUM-AMT
  6461     END-IF
  6462
  6463     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  (LOW-VALUES OR SPACES)
  6464       OR  PI-TOT-REBILL
  6465         COMPUTE PI-UNPAID-NET-PREM = PI-UNPAID-NET-PREM +
  6466             WS-I-LF-PREMIUM-AMT + WS-I-AH-PREMIUM-AMT
  6467         COMPUTE WS-ACCT-UNPAID-NET-PREM =
  6468             (WS-I-LF-PREMIUM-AMT + WS-I-AH-PREMIUM-AMT) +
  6469              WS-ACCT-UNPAID-NET-PREM.
  6470
  6471     COMPUTE PI-PREMIUM = PI-PREMIUM +
  6472         (WS-I-LF-PREMIUM-AMT + WS-I-AH-PREMIUM-AMT).
  6473
  6474     COMPUTE PI-LF-ISS-COMP ROUNDED =
  6475         (WS-I-LF-PREMIUM-AMT * WS-GA-LF-COM).
  6476
  6477     IF AM-COM-TYP (WS-GA-LEVEL) = 'K' OR 'I' OR 'L'
  6478        COMPUTE PI-AH-ISS-COMP = WS-GA-AH-COM * +1000
  6479     ELSE
  6480        COMPUTE PI-AH-ISS-COMP ROUNDED =
  6481         (WS-I-AH-PREMIUM-AMT  * WS-GA-AH-COM)
  6482     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 128
* EL642.cbl
  6483
  6484     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  (LOW-VALUES OR SPACES)
  6485       OR  PI-TOT-REBILL
  6486         COMPUTE WS-ACCT-LF-OVERWRITE =
  6487             (PI-LF-ISS-COMP + WS-ACCT-LF-OVERWRITE)
  6488         COMPUTE WS-ACCT-AH-OVERWRITE =
  6489             (PI-AH-ISS-COMP + WS-ACCT-AH-OVERWRITE)
  6490         COMPUTE PI-COMP-UNPAID-PREM = PI-COMP-UNPAID-PREM +
  6491             PI-LF-ISS-COMP + PI-AH-ISS-COMP.
  6492
  6493     COMPUTE PI-TOT-ISS-COMP = PI-TOT-ISS-COMP +
  6494         (PI-LF-ISS-COMP + PI-AH-ISS-COMP).
  6495
  6496 1033-COMPUTE-ACCOUNT-COMM.
  6497
  6498     COMPUTE WS-ACCT-NET-PREM ROUNDED = WS-ACCT-NET-PREM +
  6499         (WS-I-LF-PREMIUM-AMT + WS-I-AH-PREMIUM-AMT).
  6500
  6501     IF PI-SAV-AGENT  NOT =  PI-SAV-REMIT-TO
  6502         GO TO 1039-EXIT.
  6503
  6504     COMPUTE WS-ACCT-COMP ROUNDED =
  6505        (WS-I-LF-PREMIUM-AMT * PB-I-LIFE-COMMISSION)
  6506        + WS-ACCT-COMP
  6507
  6508     IF WS-AH-CATEGORY = 'G' OR 'L'
  6509        COMPUTE WS-ACCT-COMP ROUNDED =
  6510           (WS-I-AH-PREMIUM-AMT - PB-I-LF-ALT-PREMIUM-AMT
  6511           - PB-I-ADDL-CLP) + WS-ACCT-COMP
  6512     ELSE
  6513        COMPUTE WS-ACCT-COMP ROUNDED =
  6514           (WS-I-AH-PREMIUM-AMT * PB-I-AH-COMMISSION)   +
  6515            WS-ACCT-COMP
  6516     END-IF
  6517
  6518     GO TO 1039-EXIT.
  6519
  6520 1035-COMPUTE-CANCEL-COMM.
  6521     IF PB-CI-CERT-HAS-ERCOMM-ENTRY
  6522         PERFORM 4700-PROCESS-COMM-EXCEPTION  THRU  4790-EXIT
  6523     ELSE
  6524         PERFORM 4400-FIND-COMMISSION  THRU  4490-EXIT.
  6525     MOVE SPACES                 TO WS-AH-CATEGORY
  6526     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
  6527        AND (PB-CI-AH-BENEFIT-CD NOT = SPACES AND ZEROS)
  6528        MOVE SPACES              TO ELCNTL-KEY
  6529        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6530        MOVE '5'                 TO ELCNTL-REC-TYPE
  6531        MOVE PB-CI-AH-BENEFIT-CD TO ELCNTL-ACCESS (3:2)
  6532                                    CLAS-LOOK
  6533        MOVE +0                  TO ELCNTL-SEQ-NO
  6534        PERFORM 6130-FIND-BENEFIT-CD
  6535                                 THRU 6140-EXIT
  6536     END-IF
  6537
  6538     IF PB-OVERRIDE-LIFE
  6539       OR  PB-OVERRIDE-BOTH
  6540         MOVE PB-C-LF-REF-CALC   TO  WS-C-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 129
* EL642.cbl
  6541     ELSE
  6542         MOVE PB-C-LF-CANCEL-AMT
  6543                                 TO  WS-C-LF-CANCEL-AMT.
  6544
  6545     IF PB-OVERRIDE-AH
  6546       OR  PB-OVERRIDE-BOTH
  6547         MOVE PB-C-AH-REF-CALC   TO  WS-C-AH-CANCEL-AMT
  6548     ELSE
  6549         MOVE PB-C-AH-CANCEL-AMT
  6550                                 TO  WS-C-AH-CANCEL-AMT.
  6551
  6552     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  LOW-VALUES  OR  SPACES
  6553       OR  PI-TOT-REBILL
  6554         COMPUTE PI-UNPAID-NET-PREM = PI-UNPAID-NET-PREM -
  6555             (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT)
  6556         COMPUTE WS-ACCT-UNPAID-NET-PREM =
  6557             WS-ACCT-UNPAID-NET-PREM -
  6558             (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT).
  6559
  6560     COMPUTE PI-PREMIUM = PI-PREMIUM -
  6561         (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT).
  6562
  6563     MOVE  PB-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6564     MOVE  PB-C-LF-CANCEL-DT      TO  DC-BIN-DATE-2.
  6565     MOVE  '1'                    TO  DC-OPTION-CODE.
  6566     PERFORM  8500-DATE-CONVERT  THRU  8500-EXIT.
  6567     MOVE  DC-ELAPSED-MONTHS      TO  MONTHS-DIFF-LF.
  6568
  6569     IF DC-ODD-DAYS-OVER  GREATER THAN   ZEROS
  6570         ADD  +1                  TO  MONTHS-DIFF-LF.
  6571
  6572     MOVE  PB-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6573     MOVE  PB-C-AH-CANCEL-DT      TO  DC-BIN-DATE-2.
  6574     MOVE  '1'                    TO  DC-OPTION-CODE.
  6575     PERFORM  8500-DATE-CONVERT  THRU  8500-EXIT.
  6576     MOVE  DC-ELAPSED-MONTHS      TO  MONTHS-DIFF-AH.
  6577
  6578     IF DC-ODD-DAYS-OVER  GREATER THAN   ZEROS
  6579         ADD  +1                  TO  MONTHS-DIFF-AH.
  6580
  6581     MOVE ZEROS                   TO  SUB.
  6582     MOVE ZEROS                   TO  PI-LF-CAN-COMP
  6583                                      PI-AH-CAN-COMP.
  6584
  6585 1036-COMPUTE-GA-LOOP.
  6586
  6587     ADD  +1                      TO  SUB.
  6588
  6589     IF SUB > +10
  6590         MOVE  ZEROS              TO  SUB
  6591         GO TO  1037-CONTINUE.
  6592
  6593     IF AM-AGT (SUB)   NOT  EQUAL  PI-SAV-AGENT
  6594         GO TO  1036-COMPUTE-GA-LOOP.
  6595
  6596     IF AM-COM-TYP (SUB) = 'O' OR 'P' OR 'G' OR 'B' OR 'K' OR 'S'
  6597         NEXT SENTENCE
  6598     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 130
* EL642.cbl
  6599         GO TO  1036-COMPUTE-GA-LOOP.
  6600
  6601     IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  6602         MOVE  ZEROS               TO  AM-COMM-CHARGEBACK (SUB).
  6603
  6604     IF AM-COMM-CHARGEBACK (SUB) = '99'
  6605         MOVE  ZEROS           TO  PI-LF-CAN-COMP
  6606         GO TO 1037-CHECK-AH-COMM.
  6607
  6608     IF (MONTHS-DIFF-LF  GREATER THAN  AM-COMM-CHARGEBACK (SUB))
  6609                              AND
  6610        (AM-COMM-CHARGEBACK (SUB)  NOT  EQUAL   ZEROS)
  6611         MOVE  ZEROS               TO  PI-LF-CAN-COMP
  6612     ELSE
  6613         COMPUTE PI-LF-CAN-COMP ROUNDED = PI-LF-CAN-COMP +
  6614             (WS-C-LF-CANCEL-AMT * WS-GA-LF-COM).
  6615
  6616 1037-CHECK-AH-COMM.
  6617
  6618     IF AM-COMM-CHARGEBACK (SUB)    EQUAL   '99'
  6619         MOVE  ZEROS           TO  PI-AH-CAN-COMP
  6620         GO TO 1036-COMPUTE-GA-LOOP.
  6621
  6622     IF (MONTHS-DIFF-AH GREATER THAN  AM-COMM-CHARGEBACK (SUB))
  6623                              AND
  6624        (AM-COMM-CHARGEBACK (SUB)  NOT  EQUAL   ZEROS)
  6625         MOVE  ZEROS               TO  PI-AH-CAN-COMP
  6626     ELSE
  6627        IF (AM-COM-TYP (SUB) = 'K')
  6628           AND (WS-C-AH-CANCEL-AMT > ZEROS)
  6629           COMPUTE PI-AH-CAN-COMP ROUNDED =
  6630              PI-AH-CAN-COMP + (WS-GA-AH-COM * +1000)
  6631        ELSE
  6632           COMPUTE PI-AH-CAN-COMP ROUNDED =  PI-AH-CAN-COMP +
  6633             (WS-C-AH-CANCEL-AMT  * WS-GA-AH-COM)
  6634        END-IF
  6635     END-IF
  6636
  6637     GO TO 1036-COMPUTE-GA-LOOP.
  6638
  6639 1037-CONTINUE.
  6640
  6641     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  (LOW-VALUES  OR  SPACES)
  6642       OR  PI-TOT-REBILL
  6643         COMPUTE WS-ACCT-LF-OVERWRITE =
  6644             (WS-ACCT-LF-OVERWRITE - PI-LF-CAN-COMP)
  6645         COMPUTE WS-ACCT-AH-OVERWRITE =
  6646             (WS-ACCT-AH-OVERWRITE - PI-AH-CAN-COMP)
  6647         COMPUTE PI-COMP-UNPAID-PREM = PI-COMP-UNPAID-PREM -
  6648             PI-LF-CAN-COMP - PI-AH-CAN-COMP.
  6649
  6650     COMPUTE PI-TOT-CAN-COMP = PI-TOT-CAN-COMP +
  6651         (PI-LF-CAN-COMP + PI-AH-CAN-COMP).
  6652
  6653 1038-COMPUTE-ACCOUNT-COMM.
  6654
  6655     COMPUTE WS-ACCT-NET-PREM = WS-ACCT-NET-PREM -
  6656         (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 131
* EL642.cbl
  6657
  6658     IF PI-SAV-AGENT  NOT =  PI-SAV-REMIT-TO
  6659         GO TO 1039-EXIT.
  6660
  6661     MOVE ZEROS                   TO  SUB.
  6662
  6663 103X-ACCOUNT-LOOP.
  6664
  6665     ADD  +1                      TO  SUB.
  6666
  6667     IF SUB > +10
  6668         MOVE  ZEROS              TO  SUB
  6669         GO TO  1039-EXIT.
  6670
  6671     IF AM-COM-TYP (SUB) = 'C' OR 'D' OR 'F'
  6672         NEXT SENTENCE
  6673     ELSE
  6674         GO TO  103X-ACCOUNT-LOOP.
  6675
  6676     IF AM-COMM-CHARGEBACK (SUB)    NOT NUMERIC
  6677         MOVE  ZEROS               TO  AM-COMM-CHARGEBACK (SUB).
  6678
  6679     IF AM-COMM-CHARGEBACK (SUB)   EQUAL   '99'
  6680         MOVE  ZEROS          TO  WS-C-LF-CANCEL-AMT
  6681         GO TO 103X-CHECK-AH-COMM.
  6682
  6683     IF (MONTHS-DIFF-LF  GREATER THAN  AM-COMM-CHARGEBACK (SUB))
  6684                              AND
  6685        (AM-COMM-CHARGEBACK (SUB)  NOT  EQUAL   ZEROS)
  6686         MOVE  ZEROS              TO  WS-C-LF-CANCEL-AMT.
  6687
  6688 103X-CHECK-AH-COMM.
  6689
  6690     IF AM-COMM-CHARGEBACK (SUB)   EQUAL   '99'
  6691         MOVE  ZEROS          TO  WS-C-AH-CANCEL-AMT
  6692         GO TO 103X-COMPUTE-ACCT-TOT.
  6693
  6694     IF (MONTHS-DIFF-AH  GREATER THAN  AM-COMM-CHARGEBACK (SUB))
  6695                              AND
  6696        (AM-COMM-CHARGEBACK (SUB)  NOT  EQUAL   ZEROS)
  6697         MOVE  ZEROS              TO  WS-C-AH-CANCEL-AMT.
  6698
  6699 103X-COMPUTE-ACCT-TOT.
  6700     COMPUTE WS-ACCT-COMP   ROUNDED  =  WS-ACCT-COMP  -
  6701         (WS-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION)
  6702*        + (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION)
  6703     IF WS-AH-CATEGORY = 'G' OR 'L'
  6704        COMPUTE CNC-FACT = PB-C-AH-CANCEL-AMT /
  6705           PB-CI-AH-PREMIUM-AMT
  6706           COMPUTE WS-AH-ACCT-COMP ROUNDED =
  6707           (CNC-FACT * (PB-CI-AH-PREMIUM-AMT -
  6708           PB-CI-LF-ALT-PREMIUM-AMT
  6709           - PB-CI-ADDL-CLP))
  6710     ELSE
  6711        COMPUTE WS-AH-ACCT-COMP  ROUNDED =
  6712           (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION)
  6713     END-IF
  6714     COMPUTE WS-ACCT-COMP =  WS-ACCT-COMP  - WS-AH-ACCT-COMP
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 132
* EL642.cbl
  6715
  6716     GO TO 103X-ACCOUNT-LOOP.
  6717
  6718 1039-EXIT.
  6719     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 133
* EL642.cbl
  6721 1040-UPDATE-BILLING-STATISTICS.
  6722     IF PB-ISSUE
  6723         IF PB-FATAL-ERRORS
  6724           OR  PB-UNFORCED-ERRORS
  6725           OR  PB-RECORD-ON-HOLD
  6726             ADD +1              TO  PI-ISSUES-INER
  6727             GO TO 1049-EXIT.
  6728
  6729     IF PB-CANCELLATION
  6730         IF PB-FATAL-ERRORS
  6731           OR  PB-UNFORCED-ERRORS
  6732           OR  PB-RECORD-ON-HOLD
  6733             ADD +1              TO  PI-CANCELS-INER
  6734             GO TO 1049-EXIT.
  6735
  6736     IF PB-ISSUE
  6737         IF PB-GA-BILL-DT (WS-GA-LEVEL)  =
  6738                (LOW-VALUES OR SPACES)
  6739           OR  PI-TOT-REBILL
  6740             ADD +1              TO  PI-ISSUES-BILLED
  6741             GO TO 1049-EXIT.
  6742
  6743     IF PB-CANCELLATION
  6744         IF PB-GA-BILL-DT (WS-GA-LEVEL)  =
  6745                (LOW-VALUES OR SPACES)
  6746           OR  PI-TOT-REBILL
  6747             ADD +1              TO  PI-CANCELS-BILLED
  6748             GO TO 1049-EXIT.
  6749
  6750     IF PB-ISSUE
  6751         IF PB-GA-BILL-DT (WS-GA-LEVEL)  NOT =  LOW-VALUES
  6752           AND  SPACES
  6753             ADD +1              TO  PI-ISSUES-PREV
  6754             GO TO 1049-EXIT.
  6755
  6756     IF PB-CANCELLATION
  6757         IF PB-GA-BILL-DT (WS-GA-LEVEL)  NOT =  LOW-VALUES
  6758           AND  SPACES
  6759             ADD +1              TO  PI-CANCELS-PREV
  6760             GO TO 1049-EXIT.
  6761
  6762     ADD +1                      TO  PI-UNKNOWN.
  6763
  6764 1049-EXIT.
  6765     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 134
* EL642.cbl
  6767 1100-PYAJ-BILLING-PROCESS.
  6768******************************************************************
  6769*   PROCESS THE ACCOUNTS PAYMENTS AND ADUSTMENTS. IF THE GENERAL *
  6770*   AGENT IS NOT FINANCIALLY RESPONSIBLE FOR THE ACCOUNT DO NOT  *
  6771*   PROCESS THE ACCOUNT'S PAYMENTS AND ADJUSTMENTS.              *
  6772*                                                                *
  6773*   1.  PROCESS THE ACCOUNT'S PAYMENTS AND ADUSTMENTS.           *
  6774*                                                                *
  6775*   2.  IF THE GENERAL AGENT IS NOT FINANCIALLY RESPONSIBLE FOR  *
  6776*       THE ACCOUNT, DO NOT PROCESS THE ACCOUNT'S PAYMENTS AND   *
  6777*       ADJUSTMENTS.                                             *
  6778*                                                                *
  6779*   3.  IF PRINTED BILL IS NOT PRODUCED, DO NOT PROCESS THE      *
  6780*       ACCOUNT'S PAYMENTS AND ADJUSTMENTS.                      *
  6781******************************************************************
  6782
  6783     IF PI-SAV-AGENT  =  PI-SAV-REMIT-TO
  6784         NEXT SENTENCE
  6785     ELSE
  6786         GO TO 1190-EXIT.
  6787
  6788     IF PI-UPDATE-FILES
  6789       OR  (PI-PREVIEW  AND  APRODSWI = 'Y')
  6790         NEXT SENTENCE
  6791     ELSE
  6792         GO TO 1190-EXIT.
  6793
  6794 1105-PYAJ-BILLING-STARTBR-LOOP.
  6795     MOVE 'A'                    TO  COMPENSATION-SW.
  6796
  6797     PERFORM 4500-PYAJ-START-BROWSE  THRU  4590-EXIT.
  6798
  6799     IF PYAJ-EOF
  6800         GO TO 1190-EXIT.
  6801
  6802 1110-PYAJ-BILLING-READ-LOOP.
  6803     PERFORM 4600-PYAJ-READ-NEXT  THRU  4690-EXIT.
  6804
  6805     IF PYAJ-EOF
  6806         PERFORM 4800-PYAJ-END-BROWSE
  6807         GO TO 1190-EXIT.
  6808
  6809     IF PY-COMPANY-CD  =  ERPYAJ-BR-COMP-CD
  6810       AND  PY-CARRIER  =  ERPYAJ-BR-CARRIER
  6811       AND  PY-GROUPING  =  ERPYAJ-BR-GROUPING
  6812       AND  PY-FIN-RESP  =  ERPYAJ-BR-FIN-RESP
  6813       AND  PY-ACCOUNT  =  ERPYAJ-BR-ACCOUNT
  6814         NEXT SENTENCE
  6815     ELSE
  6816         PERFORM 4800-PYAJ-END-BROWSE
  6817         GO TO 1190-EXIT.
  6818
  6819     IF PY-CREDIT-ACCEPT-DT  NOT =  LOW-VALUES
  6820         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6821
  6822     IF PY-RECORD-TYPE  = 'R' OR 'D' OR 'C' OR 'S' OR 'T' OR 'U'
  6823                              OR 'Z'
  6824         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 135
* EL642.cbl
  6825     ELSE
  6826         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6827
  6828     IF PY-VOID-SW  NOT =  SPACES
  6829         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6830
  6831     IF PI-AR-PROCESSING
  6832        IF PY-AR-DATE  =  LOW-VALUES
  6833           NEXT SENTENCE
  6834        ELSE
  6835           GO TO 1110-PYAJ-BILLING-READ-LOOP
  6836     ELSE
  6837        IF (PY-BILLED-DATE  =  LOW-VALUES AND
  6838            PY-AR-DATE = LOW-VALUES)
  6839           NEXT SENTENCE
  6840        ELSE
  6841           GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6842
  6843     IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  6844        PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  6845        PY-ADD-TO-BALANCE
  6846         ADD PY-ENTRY-AMT        TO  WS-ACCT-PAY-ADJS
  6847     ELSE
  6848         SUBTRACT PY-ENTRY-AMT   FROM  WS-ACCT-PAY-ADJS.
  6849
  6850     GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6851
  6852 1190-EXIT.
  6853     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 136
* EL642.cbl
  6855 1200-PYAJ-BILLING-COMPLETE.
  6856******************************************************************
  6857*      1. IF PRINTED BILL IS PRODUCED PRINT THE GENERAL AGENT'S  *
  6858*         TOTALS.                                                *
  6859*                                                                *
  6860*      2. PROCESS THE GENERAL AGENT'S PAYMENTS AND ADJUSTMENTS.  *
  6861******************************************************************
  6862
  6863     IF PI-DATA-BILLED
  6864         NEXT SENTENCE
  6865     ELSE
  6866         MOVE ER-2913            TO  EMI-ERROR
  6867         MOVE -1                 TO  AACCT1L
  6868         MOVE AL-UABON           TO  AACCT1A
  6869         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6870
  6871     IF RETURNED-FROM  =  SPACES
  6872         IF PI-UPDATE-FILES
  6873           OR  (PI-PREVIEW  AND  APRODSWI = 'Y')
  6874             IF PI-ACCT-BILLED
  6875                 MOVE 'TB'       TO  BILLING-DETAIL-TYPE
  6876                 PERFORM 3000-WRITE-BILLING-DETAIL
  6877                         THRU  3990-EXIT
  6878             ELSE
  6879                 MOVE 'TS'       TO  BILLING-DETAIL-TYPE
  6880                 PERFORM 3000-WRITE-BILLING-DETAIL
  6881                         THRU  3990-EXIT.
  6882
  6883 1205-PYAJ-BILLING-STARTBR-LOOP.
  6884     MOVE PI-SAV-AGENT           TO  PI-SAV-FIN-RESP.
  6885     MOVE 'G'                    TO  COMPENSATION-SW.
  6886
  6887     PERFORM 4500-PYAJ-START-BROWSE  THRU  4590-EXIT.
  6888
  6889     IF PYAJ-EOF
  6890         GO TO 1260-BILLING-COMPLETE.
  6891
  6892 1210-PYAJ-BILLING-READ-LOOP.
  6893     PERFORM 4600-PYAJ-READ-NEXT  THRU  4690-EXIT.
  6894
  6895     IF PYAJ-EOF
  6896         GO TO 1250-END-AGENTS-PAY-ADJS.
  6897
  6898     IF NOT PI-AR-PROCESSING
  6899         IF PY-COMPANY-CD  =  ERPYAJ-BR-COMP-CD
  6900           AND  PY-CARRIER  =  ERPYAJ-BR-CARRIER
  6901           AND  PY-GROUPING  =  ERPYAJ-BR-GROUPING
  6902           AND  PY-FIN-RESP  =  ERPYAJ-BR-FIN-RESP
  6903           AND  PY-ACCOUNT  =  ERPYAJ-BR-ACCOUNT
  6904             GO TO 1230-CHECK-PYAJ-ENTRY
  6905         ELSE
  6906             GO TO 1250-END-AGENTS-PAY-ADJS
  6907     ELSE
  6908         IF PY-COMPANY-CD  =  ERPYAJ-BR-COMP-CD
  6909           AND  PY-CARRIER  =  ERPYAJ-BR-CARRIER
  6910           AND  PY-GROUPING  =  ERPYAJ-BR-GROUPING
  6911           AND  PY-FIN-RESP  =  ERPYAJ-BR-FIN-RESP
  6912             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 137
* EL642.cbl
  6913         ELSE
  6914             GO TO 1250-END-AGENTS-PAY-ADJS.
  6915
  6916      IF PY-PMT-APPLIED = 'O' OR
  6917         PY-ACCOUNT = LOW-VALUES
  6918          NEXT SENTENCE
  6919      ELSE
  6920          GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6921
  6922 1230-CHECK-PYAJ-ENTRY.
  6923
  6924     IF PY-CREDIT-ACCEPT-DT  NOT =  LOW-VALUES
  6925         GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6926
  6927     IF PY-RECORD-TYPE  = 'R' OR 'D' OR 'C' OR 'S' OR 'T' OR 'U'
  6928                              OR 'Z'
  6929         NEXT SENTENCE
  6930     ELSE
  6931         GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6932
  6933     IF PY-VOID-SW  NOT =  SPACES
  6934         GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6935
  6936     IF PI-AR-PROCESSING
  6937        IF PY-AR-DATE  =  LOW-VALUES
  6938           OR  PI-TOT-REBILL
  6939           OR  RETURNED-FROM  =  XCTL-PYAJ
  6940               NEXT SENTENCE
  6941        ELSE
  6942           GO TO 1210-PYAJ-BILLING-READ-LOOP
  6943     ELSE
  6944        IF (PY-BILLED-DATE  =  LOW-VALUES AND
  6945            PY-AR-DATE = LOW-VALUES)
  6946           OR  PI-TOT-REBILL
  6947           OR  RETURNED-FROM  =  XCTL-PYAJ
  6948           NEXT SENTENCE
  6949        ELSE
  6950           GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6951
  6952     IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  6953        PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  6954        PY-ADD-TO-BALANCE
  6955         ADD PY-ENTRY-AMT        TO  PI-REMITTED
  6956     ELSE
  6957         IF PY-CHARGE-TO-AGENT
  6958           OR  PY-ADJ-CHG-TO-AGT
  6959             IF PY-GA-CHECK
  6960                 ADD PY-ENTRY-AMT  TO  PI-DISBURSED
  6961             ELSE
  6962                 ADD PY-ENTRY-AMT  TO  PI-ADJUSTMNTS.
  6963
  6964     IF RETURNED-FROM  =  SPACES
  6965         IF PI-UPDATE-FILES
  6966           OR  (PI-PREVIEW  AND  APRODSWI = 'Y')
  6967             MOVE 'BP'           TO  BILLING-DETAIL-TYPE
  6968             PERFORM 3000-WRITE-BILLING-DETAIL  THRU  3990-EXIT.
  6969
  6970     GO TO 1210-PYAJ-BILLING-READ-LOOP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 138
* EL642.cbl
  6971
  6972 1250-END-AGENTS-PAY-ADJS.
  6973     PERFORM 4800-PYAJ-END-BROWSE.
  6974
  6975     IF PI-DATA-BILLED
  6976         NEXT SENTENCE
  6977     ELSE
  6978         MOVE ER-2913            TO  EMI-ERROR
  6979         MOVE -1                 TO  AACCT1L
  6980         MOVE AL-UABON           TO  AACCT1A
  6981         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6982
  6983 1260-BILLING-COMPLETE.
  6984     IF WS-UPDATE-FILES
  6985         PERFORM 6500-REWRITE-CROSS-REFERENCE.
  6986
  6987     IF EMI-NO-ERRORS
  6988         MOVE 0000               TO  EMI-ERROR
  6989         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6990
  6991     MOVE -1                     TO  AAGENTL.
  6992
  6993     PERFORM 5000-FORMAT-SCREEN  THRU  5090-EXIT.
  6994
  6995     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 139
* EL642.cbl
  6997 2000-VOID-BILLING.
  6998******************************************************************
  6999*     THIS SECTION WILL RESET THE GA-BILLING-FLAGS IN THE        *
  7000*     PENDING BUSINESS RECORDS AND RESET THE LAST BILLED         *
  7001*     DATE IN THE GENERAL AGENT'S CROSS-REFERENCE-FILE TO        *
  7002*     LOW-VALUES.                                                *
  7003******************************************************************
  7004
  7005     MOVE SPACES                 TO  ELCNTL-KEY.
  7006     MOVE '1'                    TO  ELCNTL-REC-TYPE.
  7007
  7008     PERFORM 6100-READ-CONTROL-FILE  THRU  6120-EXIT.
  7009
  7010     IF EMI-ERROR  NOT =  ZEROS
  7011         GO TO 8200-SEND-DATAONLY.
  7012
  7013     MOVE CF-CURRENT-MONTH-END   TO  DC-BIN-DATE-1.
  7014     MOVE SPACE                  TO  DC-OPTION-CODE.
  7015
  7016     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  7017
  7018     MOVE DC-GREG-DATE-1-EDIT    TO  PI-MONTH-END-DATE.
  7019
  7020     PERFORM 6400-READ-CROSS-REFERENCE  THRU  6490-EXIT.
  7021
  7022     MOVE +0                     TO  GX-SUB.
  7023
  7024 2005-GXRF-BILLING-PROCESS-LOOP.
  7025     ADD +1                      TO  GX-SUB.
  7026
  7027     IF GX-SUB  GREATER THAN  GX-AGENT-POINTER-CNT
  7028         GO TO 2100-VOID-PNDB-COMPLETE.
  7029
  7030     MOVE GX-AM-CARRIER (GX-SUB)   TO  PI-CR-CARRIER.
  7031     MOVE GX-AM-GROUPING (GX-SUB)  TO  PI-CR-GROUPING.
  7032     MOVE GX-AM-STATE (GX-SUB)     TO  PI-CR-STATE.
  7033     MOVE GX-AM-ACCOUNT (GX-SUB)   TO  PI-CR-ACCOUNT.
  7034     MOVE GX-AGENT-NO              TO  PI-SAV-AGENT.
  7035     MOVE GX-AM-EXPIRATION-DT (GX-SUB)
  7036                                   TO  PI-SAV-EXP-DT.
  7037     MOVE GX-AM-LEVEL-NO (GX-SUB)  TO  WS-GA-LEVEL.
  7038     MOVE LOW-VALUES               TO  GX-LAST-BILL-DT (GX-SUB).
  7039
  7040     PERFORM 4000-PNDB-START-BROWSE  THRU  4090-EXIT.
  7041
  7042     IF PNDB-EOF
  7043         PERFORM 4160-PNDB-END-BROWSE
  7044         GO TO 2005-GXRF-BILLING-PROCESS-LOOP.
  7045
  7046 2010-VOID-PNDB-LOOP.
  7047     PERFORM 4100-PNDB-READ-NEXT  THRU  4150-EXIT.
  7048
  7049     IF PNDB-EOF
  7050         PERFORM 4160-PNDB-END-BROWSE
  7051         GO TO 2005-GXRF-BILLING-PROCESS-LOOP.
  7052
  7053     IF PB-COMPANY-CD-A1  =  PI-COMPANY-CD
  7054       AND  PB-SV-CARRIER  =  PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 140
* EL642.cbl
  7055       AND  PB-SV-GROUPING  =  PI-CR-GROUPING
  7056       AND  PB-SV-STATE  =  PI-CR-STATE
  7057       AND  PB-ACCOUNT  =  PI-CR-ACCOUNT
  7058         NEXT SENTENCE
  7059     ELSE
  7060         PERFORM 4160-PNDB-END-BROWSE
  7061         GO TO 2005-GXRF-BILLING-PROCESS-LOOP.
  7062
  7063     IF PB-CREDIT-ACCEPT-DT  NOT =  LOW-VALUES
  7064         GO TO 2010-VOID-PNDB-LOOP.
  7065
  7066     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  (LOW-VALUES  OR  SPACES)
  7067         GO TO 2010-VOID-PNDB-LOOP.
  7068
  7069     IF PB-CERT-EFF-DT  =  GX-AM-EXPIRATION-DT (GX-SUB)
  7070       OR  PB-CERT-EFF-DT  GREATER THAN
  7071               GX-AM-EXPIRATION-DT (GX-SUB)
  7072         PERFORM 4160-PNDB-END-BROWSE
  7073         GO TO 2005-GXRF-BILLING-PROCESS-LOOP.
  7074
  7075     IF PB-CERT-EFF-DT  LESS THAN  GX-AM-EFF-DT (GX-SUB)
  7076         GO TO 2010-VOID-PNDB-LOOP.
  7077
  7078     IF PB-BATCH-TRAILER
  7079         GO TO 2010-VOID-PNDB-LOOP.
  7080
  7081     PERFORM 4200-PNDB-REWRITE  THRU  4290-EXIT.
  7082
  7083     MOVE 'Y'                    TO  DATA-VOIDED-SW.
  7084
  7085     GO TO 2010-VOID-PNDB-LOOP.
  7086
  7087 2100-VOID-PNDB-COMPLETE.
  7088     IF DATA-VOIDED
  7089         NEXT SENTENCE
  7090     ELSE
  7091         MOVE -1                 TO  APFNTERL
  7092         MOVE ER-2401            TO  EMI-ERROR
  7093         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7094         GO TO 8100-SEND-INITIAL-MAP.
  7095
  7096     PERFORM 3940-BILL-GENERIC-DELETE  THRU  3940-EXIT.
  7097
  7098     PERFORM 6500-REWRITE-CROSS-REFERENCE  THRU  6590-EXIT.
  7099
  7100 2105-VOID-COMPLETE.
  7101     MOVE 0000                   TO  EMI-ERROR
  7102
  7103     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7104
  7105     MOVE -1                     TO  AAGENTL.
  7106
  7107     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 141
* EL642.cbl
  7109 3000-WRITE-BILLING-DETAIL.
  7110******************************************************************
  7111*     THIS SECTION FORMATS THE BILLING PRINT RECORDS.  THESE     *
  7112*     RECORDS ARE CREATED IN THE SAME FORMAT THAT THEY APPEAR    *
  7113*     WHEN PRINTED.                                              *
  7114*                                                                *
  7115*     THIS SECTION PRINTS THE BILLING STATEMENT AND PRINT LABELS.*
  7116*     BILLING-DETAIL-TYPES                                       *
  7117*            TOTAL-STATEMENT   TS                                *
  7118*            TOTAL-ACCOUNT     TA                                *
  7119*            TOTAL-BOTH        TB                                *
  7120*            GAN-AGT-ADDRESS   GA                                *
  7121*                              BP                                *
  7122******************************************************************
  7123
  7124     IF GEN-AGT-ADDRESS
  7125         PERFORM 3930-BILL-READ  THRU  3930-EXIT
  7126         IF NO-BILL-RECS
  7127             GO TO 3200-FORMAT-HDR-ADDR-RECS
  7128         ELSE
  7129             IF BI-PREVIEW-ONLY
  7130               OR  BI-INITIAL-PRINT-DATE  NOT =  LOW-VALUES
  7131               OR  PI-TOT-REBILL
  7132                 PERFORM 3940-BILL-GENERIC-DELETE
  7133                     THRU  3940-EXIT
  7134                 GO TO 3200-FORMAT-HDR-ADDR-RECS
  7135             ELSE
  7136                 MOVE ER-2403    TO  EMI-ERROR
  7137                 MOVE -1         TO  ABILTYPL
  7138                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7139                 GO TO 8200-SEND-DATAONLY.
  7140
  7141 3100-FORMAT-DETAIL-LINES.
  7142     IF WS-LINECTR  GREATER THAN  23
  7143         MOVE ZEROS              TO  WS-LINECTR
  7144         MOVE '3'                TO  BI-RECORD-TYPE
  7145         MOVE TRIPLE-SPACE       TO  BI-SKIP-CONTROL
  7146         MOVE '          CONTINUED ON NEXT PAGE'
  7147                                 TO  BI-TEXT-LINE
  7148         PERFORM 3920-BILL-WRITE
  7149         PERFORM 3300-FORMAT-HEADINGS  THRU  3380-EXIT.
  7150
  7151     IF WS-LINECTR  =  ZEROS
  7152         MOVE DOUBLE-SPACE       TO  BI-SKIP-CONTROL
  7153     ELSE
  7154         MOVE SINGLE-SPACE       TO  BI-SKIP-CONTROL.
  7155
  7156     MOVE '3'                    TO  BI-RECORD-TYPE.
  7157     MOVE SPACES                 TO  GA-TEXT-LINE.
  7158
  7159     IF TOTAL-STATEMENT
  7160         GO TO 3175-CHECK-AGENT-TOTAL.
  7161
  7162     IF BILLING-DETAIL-TYPE  =  'BP'
  7163        IF PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT
  7164            MOVE PY-ENTRY-COMMENT
  7165                                 TO  GA-ENTRY-DESC
  7166            MULTIPLY PY-ENTRY-AMT  BY  -1
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 142
* EL642.cbl
  7167                GIVING  GA-PMTS-ADJS
  7168            MOVE PY-ENTRY-COMMENT
  7169                                 TO  GA-ENTRY-DESC
  7170            MOVE '* ACCOUNTING ENTRY *'
  7171                                 TO  GA-ENTRY-COMMENT
  7172            ADD +1               TO  WS-LINECTR
  7173            IF PY-ACCOUNT = LOW-VALUES
  7174                MOVE SPACES      TO  GA-ACCT
  7175                PERFORM 3920-BILL-WRITE
  7176                GO TO 3990-EXIT
  7177            ELSE
  7178                MOVE PY-ACCOUNT  TO  GA-ACCT
  7179                PERFORM 3920-BILL-WRITE
  7180                GO TO 3990-EXIT.
  7181
  7182     IF BILLING-DETAIL-TYPE  =  'BP'
  7183         MOVE PY-ENTRY-COMMENT   TO  GA-ENTRY-DESC
  7184         MOVE PY-ENTRY-AMT       TO  GA-PMTS-ADJS
  7185         MOVE '* ACCOUNTING ENTRY *'
  7186                                 TO  GA-ENTRY-COMMENT
  7187         MOVE PY-ACCOUNT         TO  GA-ACCT
  7188         ADD +1                  TO  WS-LINECTR
  7189            IF PY-ACCOUNT = LOW-VALUES
  7190                MOVE SPACES      TO  GA-ACCT
  7191                PERFORM 3920-BILL-WRITE
  7192                GO TO 3990-EXIT
  7193            ELSE
  7194                MOVE PY-ACCOUNT  TO  GA-ACCT
  7195                PERFORM 3920-BILL-WRITE
  7196                GO TO 3990-EXIT.
  7197
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 143
* EL642.cbl
  7199 3150-FORMAT-ACCOUNT-LINE.
  7200     MOVE SPACES                 TO  GA-TEXT-LINE.
  7201     MOVE PI-SAV-ACCT-AGT        TO  GA-ACCT.
  7202     MOVE PI-SAV-ACCT-NAME       TO  GA-ACCT-NAME.
  7203     MOVE WS-ACCT-BEG-BAL        TO  GA-BEG-BAL
  7204                                     GA-BEG-BAL-AMT.
  7205     MOVE WS-ACCT-NET-PREM       TO  GA-NET-PREM
  7206                                     GA-NET-PREM-AMT.
  7207     MOVE WS-ACCT-COMP           TO  GA-ACCT-COMP
  7208                                     GA-ACCT-COMP-AMT.
  7209     MOVE WS-ACCT-PAY-ADJS       TO  GA-PMTS-ADJS
  7210                                     GA-PMTS-ADJS-AMT.
  7211
  7212     IF PI-SAV-AGENT  NOT =  PI-SAV-REMIT-TO
  7213         MOVE ZEROS              TO  GA-END-BAL-AMT
  7214     ELSE
  7215         COMPUTE GA-END-BAL-AMT =
  7216             (WS-ACCT-BEG-BAL + WS-ACCT-NET-PREM) -
  7217              (WS-ACCT-COMP + WS-ACCT-PAY-ADJS).
  7218
  7219     MOVE WS-ACCT-UNPAID-NET-PREM
  7220                                 TO  GA-UNPAID-NET-PREM
  7221                                     GA-UNPAID-NET-AMT.
  7222     MOVE ZEROS                  TO  GA-OVERWRITE-AMT.
  7223
  7224     IF WS-ACCT-LF-OVERWRITE  NOT =  ZEROS
  7225         MOVE PI-LIFE-OVERRIDE-L6
  7226                                 TO  GA-BEN-OVERRIDE-L6
  7227         MOVE PI-LIFE-OVERRIDE-L2
  7228                                 TO  GA-BENEFIT-CD
  7229         MOVE WS-ACCT-LF-OVERWRITE
  7230                                 TO  GA-OVERWRITE
  7231                                     GA-OVERWRITE-AMT
  7232     ELSE
  7233         IF WS-ACCT-AH-OVERWRITE  NOT =  ZEROS
  7234             MOVE PI-AH-OVERRIDE-L6
  7235                                 TO  GA-BEN-OVERRIDE-L6
  7236             MOVE PI-AH-OVERRIDE-L2
  7237                                 TO  GA-BENEFIT-CD
  7238             MOVE WS-ACCT-AH-OVERWRITE
  7239                                 TO  GA-OVERWRITE
  7240                                     GA-OVERWRITE-AMT.
  7241
  7242     COMPUTE GA-AMT-DUE-AMT = GA-END-BAL-AMT -
  7243         (WS-ACCT-LF-OVERWRITE + WS-ACCT-AH-OVERWRITE).
  7244
  7245     ADD  GA-AMT-DUE-AMT         TO  WS-GA-AMT-DUE.
  7246
  7247     MOVE GA-AMT-DUE-AMT         TO  GA-AMT-DUE.
  7248
  7249     ADD +1                      TO  WS-LINECTR.
  7250
  7251     PERFORM 3920-BILL-WRITE.
  7252
  7253     MOVE SPACES                 TO  GA-TEXT-LINE.
  7254     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7255
  7256     IF WS-ACCT-LF-OVERWRITE  NOT =  ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 144
* EL642.cbl
  7257         IF WS-ACCT-AH-OVERWRITE  NOT =  ZEROS
  7258             MOVE PI-AH-OVERRIDE-L6
  7259                                 TO  GA-BEN-OVERRIDE-L6
  7260             MOVE PI-AH-OVERRIDE-L2
  7261                                 TO  GA-BENEFIT-CD
  7262             MOVE WS-ACCT-AH-OVERWRITE
  7263                                 TO  GA-OVERWRITE
  7264                                     GA-OVERWRITE-AMT
  7265             MOVE ZEROS          TO  GA-BEG-BAL-AMT
  7266                                     GA-END-BAL-AMT
  7267                                     GA-NET-PREM-AMT
  7268                                     GA-ACCT-COMP-AMT
  7269                                     GA-PMTS-ADJS-AMT
  7270                                     GA-UNPAID-NET-AMT
  7271                                     GA-AMT-DUE-AMT
  7272             ADD +1              TO  WS-LINECTR
  7273             PERFORM 3920-BILL-WRITE.
  7274
  7275     ADD WS-ACCT-BEG-BAL         TO  WS-GA-BEG-BAL
  7276                                     PI-ACCT-BEG-BAL.
  7277     ADD WS-ACCT-NET-PREM        TO  WS-GA-NET-PREM
  7278                                     PI-ACCT-NET-PREM.
  7279     ADD WS-ACCT-COMP            TO  WS-GA-COMP
  7280                                     PI-ACCT-COMP.
  7281     ADD WS-ACCT-PAY-ADJS        TO  WS-GA-PAY-ADJS
  7282                                     PI-ACCT-PAY-ADJS.
  7283     ADD WS-ACCT-UNPAID-NET-PREM
  7284                                 TO  WS-GA-UNPAID-NET-PREM.
  7285     ADD WS-ACCT-LF-OVERWRITE    TO  WS-GA-LF-OVERWRITE.
  7286     ADD WS-ACCT-AH-OVERWRITE    TO  WS-GA-AH-OVERWRITE.
  7287     ADD GA-END-BAL-AMT          TO  WS-GA-END-BAL.
  7288
  7289     MOVE ZEROS                  TO  WS-ACCT-BEG-BAL
  7290                                     WS-ACCT-NET-PREM
  7291                                     WS-ACCT-COMP
  7292                                     WS-ACCT-PAY-ADJS
  7293                                     WS-ACCT-UNPAID-NET-PREM
  7294                                     WS-ACCT-LF-OVERWRITE
  7295                                     WS-ACCT-AH-OVERWRITE.
  7296     MOVE SPACE                  TO  PI-ACCT-BILLED-SW.
  7297     MOVE SPACE                  TO  ACCOUNT-CARRY-BAL-SW.
  7298
  7299     IF TOTAL-STATEMENT
  7300         GO TO 3400-FORMAT-TOTAL-LINE.
  7301
  7302 3175-CHECK-AGENT-TOTAL.
  7303
  7304     IF TOTAL-STATEMENT OR
  7305        TOTAL-BOTH
  7306         GO TO 3400-FORMAT-TOTAL-LINE.
  7307
  7308     GO TO 3990-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 145
* EL642.cbl
  7310 3200-FORMAT-HDR-ADDR-RECS.
  7311     PERFORM 3910-BILL-GETMAIN.
  7312
  7313     MOVE ZEROS                  TO  WS-LINE-SEQ-NO.
  7314
  7315     SET A-INDX                  TO  1.
  7316
  7317     PERFORM 3210-FORMAT-ADDR-RECS  THRU  3210-EXIT  6  TIMES.
  7318
  7319     MOVE ZEROS                  TO  WS-LINE-SEQ-NO.
  7320
  7321     PERFORM 3300-FORMAT-HEADINGS  THRU  3380-EXIT.
  7322
  7323     PERFORM 3220-WRITE-AGENTS-BAL  THRU  3220-EXIT.
  7324
  7325     GO TO 3990-EXIT.
  7326
  7327 3210-FORMAT-ADDR-RECS.
  7328     MOVE '2'                    TO  BI-RECORD-TYPE.
  7329     MOVE SPACES                 TO  GA-TEXT-LINE.
  7330     MOVE WS-AGENT-LINES (A-INDX)
  7331                                 TO  GA-ACCT-ADDRESS-LINE.
  7332
  7333     PERFORM 3920-BILL-WRITE.
  7334
  7335     SET A-INDX                  UP  BY  1.
  7336
  7337 3210-EXIT.
  7338     EXIT.
  7339
  7340 3220-WRITE-AGENTS-BAL.
  7341     MOVE SPACES                 TO GA-TEXT-LINE.
  7342     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7343
  7344     PERFORM 3920-BILL-WRITE.
  7345
  7346     MOVE 'BEGINNING BALANCE'    TO  GA-ACCT-NAME
  7347     MOVE PI-BAL-FRWD            TO  GA-BEG-BAL.
  7348     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7349
  7350     PERFORM 3920-BILL-WRITE.
  7351
  7352     MOVE SPACES                 TO  GA-TEXT-LINE.
  7353     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7354
  7355     PERFORM 3920-BILL-WRITE.
  7356
  7357 3220-EXIT.
  7358     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 146
* EL642.cbl
  7360 3300-FORMAT-HEADINGS.
  7361     MOVE WS-PGECTR              TO  HD-PG.
  7362
  7363     ADD +1                      TO  WS-PGECTR.
  7364
  7365     MOVE '3'                    TO  BI-RECORD-TYPE.
  7366     MOVE TOP-OF-PAGE            TO  BI-SKIP-CONTROL.
  7367
  7368     IF NOT PI-PREVIEW
  7369         MOVE GA-HD1             TO  GA-TEXT-LINE
  7370     ELSE
  7371         MOVE GA-PREVIEW-HD      TO  GA-TEXT-LINE
  7372         PERFORM 3920-BILL-WRITE
  7373         MOVE '3'                TO  BI-RECORD-TYPE
  7374         MOVE DOUBLE-SPACE       TO  BI-SKIP-CONTROL
  7375         MOVE GA-HD1             TO  GA-TEXT-LINE.
  7376
  7377     PERFORM 3920-BILL-WRITE.
  7378
  7379     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7380     MOVE GA-HD2                 TO  GA-TEXT-LINE.
  7381
  7382     PERFORM 3920-BILL-WRITE.
  7383
  7384     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7385     MOVE GA-HD3                 TO  GA-TEXT-LINE.
  7386
  7387     PERFORM 3920-BILL-WRITE.
  7388
  7389     SET A-INDX                  TO  1.
  7390
  7391     PERFORM 3390-FORMAT-ADDR-TEXT-LINES  THRU  3390-EXIT
  7392         6  TIMES.
  7393
  7394     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7395     MOVE GA-HD4                 TO  GA-TEXT-LINE.
  7396
  7397     PERFORM 3920-BILL-WRITE.
  7398
  7399     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7400     MOVE GA-HD5                 TO  GA-TEXT-LINE.
  7401
  7402     PERFORM 3920-BILL-WRITE.
  7403
  7404 3380-EXIT.
  7405     EXIT.
  7406
  7407 3390-FORMAT-ADDR-TEXT-LINES.
  7408     MOVE '3'                    TO  BI-RECORD-TYPE.
  7409     MOVE SPACES                 TO  GA-TEXT-LINE.
  7410
  7411     IF A-INDX  =  1
  7412         MOVE DOUBLE-SPACE       TO  BI-SKIP-CONTROL
  7413         MOVE PI-SAV-CARR        TO  GA-CARRIER
  7414         MOVE PI-SAV-GROUP       TO  GA-GROUPING
  7415         MOVE PI-SAV-AGENT       TO  GA-AGENT
  7416         MOVE '-'                TO  GA-DASH
  7417     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 147
* EL642.cbl
  7418         MOVE SINGLE-SPACE       TO  BI-SKIP-CONTROL.
  7419
  7420     MOVE WS-AGENT-LINES (A-INDX)  TO  GA-AGENT-ADDR.
  7421
  7422     PERFORM 3920-BILL-WRITE.
  7423
  7424     SET A-INDX                  UP  BY  1.
  7425
  7426 3390-EXIT.
  7427     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 148
* EL642.cbl
  7429 3400-FORMAT-TOTAL-LINE.
  7430     MOVE SPACES                 TO  GA-TEXT-LINE.
  7431     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7432     MOVE '3'                    TO  BI-RECORD-TYPE.
  7433     MOVE SPACES                 TO  GA-TEXT-LINE.
  7434
  7435     PERFORM 3920-BILL-WRITE.
  7436
  7437     MOVE SPACES                 TO  GA-TEXT-LINE.
  7438     MOVE 'AGENT TOTAL'          TO  GA-ACCT-NAME.
  7439     MOVE WS-GA-BEG-BAL          TO  GA-BEG-BAL
  7440                                     GA-BEG-BAL-AMT.
  7441     MOVE WS-GA-NET-PREM         TO  GA-NET-PREM
  7442                                     GA-NET-PREM-AMT.
  7443     MOVE WS-GA-COMP             TO  GA-ACCT-COMP
  7444                                     GA-ACCT-COMP-AMT.
  7445     MOVE WS-GA-PAY-ADJS         TO  GA-PMTS-ADJS
  7446                                     GA-PMTS-ADJS-AMT.
  7447     MOVE WS-GA-END-BAL          TO  GA-END-BAL-AMT.
  7448     MOVE WS-GA-UNPAID-NET-PREM  TO  GA-UNPAID-NET-PREM
  7449                                     GA-UNPAID-NET-AMT.
  7450     MOVE PI-LIFE-OVERRIDE-L6    TO  GA-BEN-OVERRIDE-L6.
  7451     MOVE PI-LIFE-OVERRIDE-L2    TO  GA-BENEFIT-CD.
  7452     MOVE WS-GA-LF-OVERWRITE     TO  GA-OVERWRITE
  7453                                     GA-OVERWRITE-AMT.
  7454     MOVE WS-GA-AMT-DUE          TO  GA-AMT-DUE-AMT
  7455                                     GA-AMT-DUE.
  7456
  7457     PERFORM 3920-BILL-WRITE.
  7458
  7459     MOVE SPACES                 TO  GA-TEXT-LINE.
  7460     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7461     MOVE PI-AH-OVERRIDE-L6      TO  GA-BEN-OVERRIDE-L6
  7462     MOVE PI-AH-OVERRIDE-L2      TO  GA-BENEFIT-CD
  7463     MOVE WS-GA-AH-OVERWRITE     TO  GA-OVERWRITE
  7464                                     GA-OVERWRITE-AMT.
  7465
  7466     PERFORM 3920-BILL-WRITE.
  7467
  7468     MOVE SPACES                 TO  GA-TEXT-LINE.
  7469     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7470
  7471     PERFORM 3920-BILL-WRITE.
  7472
  7473     MOVE SPACES                 TO  GA-TEXT-LINE.
  7474     MOVE '1'                    TO  BI-RECORD-TYPE.
  7475     MOVE PI-PROCESSOR-ID        TO  GA-PROCESSOR-CD.
  7476
  7477     IF PI-PREV-BILL
  7478       OR  PI-PREV-REBILL
  7479         MOVE 'P'                TO  GA-STATEMENT-TYPE.
  7480
  7481     MOVE +1                     TO  GA-NO-OF-COPIES.
  7482     MOVE WS-CURRENT-DATE        TO  GA-CREATION-DT.
  7483     MOVE LOW-VALUES             TO  GA-INITIAL-PRINT-DATE.
  7484     MOVE PI-UNPAID-NET-PREM     TO  GA-NET-UNPD.
  7485     MOVE PI-COMP-UNPAID-PREM    TO  GA-COMP-UNPD-PREM.
  7486     MOVE PI-PREMIUM             TO  GA-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 149
* EL642.cbl
  7487     MOVE PI-REMITTED            TO  GA-REMITTED.
  7488     MOVE PI-TOT-ISS-COMP        TO  GA-TOT-ISS-COMP.
  7489     MOVE PI-TOT-CAN-COMP        TO  GA-TOT-CAN-COMP.
  7490     MOVE PI-ADJUSTMNTS          TO  GA-ADJUSTMNTS.
  7491     MOVE PI-DISBURSED           TO  GA-DISBURSED.
  7492     MOVE PI-AGENT-NAME          TO  GA-AGENTS-NAME.
  7493
  7494     PERFORM 3920-BILL-WRITE.
  7495
  7496     GO TO 3990-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 150
* EL642.cbl
  7498 3910-BILL-GETMAIN.
  7499
  7500* EXEC CICS GETMAIN
  7501*        SET      (ADDRESS OF BILLING-STATEMENT)
  7502*        LENGTH   (210)
  7503*        INITIMG  (GETMAIN-SPACE)
  7504*    END-EXEC.
  7505     MOVE 210
  7506       TO DFHEIV11
  7507*    MOVE ',"IL                  $   #00007410' TO DFHEIV0
  7508     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7509     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7510     MOVE X'2020233030303037343130' TO DFHEIV0(25:11)
  7511     CALL 'kxdfhei1' USING DFHEIV0,
  7512           DFHEIV20,
  7513           DFHEIV11,
  7514           GETMAIN-SPACE
  7515     SET ADDRESS OF BILLING-STATEMENT TO
  7516         DFHEIV20
  7517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7518
  7519
  7520 3920-BILL-WRITE.
  7521     MOVE PI-COMPANY-CD          TO  BI-COMPANY-CD.
  7522     MOVE PI-SAV-CARR            TO  BI-CARRIER.
  7523     MOVE PI-SAV-GROUP           TO  BI-GROUPING.
  7524     MOVE LOW-VALUES             TO  BI-ACCOUNT.
  7525     MOVE PI-SAV-AGENT           TO  BI-FIN-RESP.
  7526     MOVE 'BI'                   TO  BI-RECORD-ID.
  7527
  7528     ADD +1                      TO  WS-LINE-SEQ-NO.
  7529
  7530     IF BI-RECORD-TYPE = '1'
  7531         MOVE ZEROS              TO  BI-LINE-SEQ-NO
  7532     ELSE
  7533         MOVE WS-LINE-SEQ-NO     TO  BI-LINE-SEQ-NO.
  7534
  7535
  7536* EXEC CICS WRITE
  7537*        DATASET  (ERBILL-FILE-ID)
  7538*        FROM     (BILLING-STATEMENT)
  7539*        RIDFLD   (BI-CONTROL-PRIMARY)
  7540*    END-EXEC.
  7541     MOVE LENGTH OF
  7542      BILLING-STATEMENT
  7543       TO DFHEIV11
  7544*    MOVE '&$ L                  ''   #00007431' TO DFHEIV0
  7545     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7546     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7547     MOVE X'2020233030303037343331' TO DFHEIV0(25:11)
  7548     CALL 'kxdfhei1' USING DFHEIV0,
  7549           ERBILL-FILE-ID,
  7550           BILLING-STATEMENT,
  7551           DFHEIV11,
  7552           BI-CONTROL-PRIMARY,
  7553           DFHEIV99,
  7554           DFHEIV99
  7555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 151
* EL642.cbl
  7556
  7557
  7558 3930-BILL-READ.
  7559     MOVE PI-COMPANY-CD          TO  ERBILL-CO-CD.
  7560     MOVE PI-SAV-CARR            TO  ERBILL-CARRIER.
  7561     MOVE PI-SAV-GROUP           TO  ERBILL-GROUP.
  7562     MOVE LOW-VALUES             TO  ERBILL-ACCT.
  7563     MOVE PI-SAV-AGENT           TO  ERBILL-FIN-RESP.
  7564     MOVE '1'                    TO  ERBILL-REC-TYPE.
  7565     MOVE ZEROS                  TO  ERBILL-LINE-SEQ-NO.
  7566
  7567
  7568* EXEC CICS HANDLE CONDITION
  7569*        NOTFND  (3930-BILL-NOTFND)
  7570*    END-EXEC.
  7571*    MOVE '"$I                   ! $ #00007446' TO DFHEIV0
  7572     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7573     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7574     MOVE X'2420233030303037343436' TO DFHEIV0(25:11)
  7575     CALL 'kxdfhei1' USING DFHEIV0
  7576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7577
  7578
  7579
  7580* EXEC CICS READ
  7581*        SET      (ADDRESS OF BILLING-STATEMENT)
  7582*        DATASET  (ERBILL-FILE-ID)
  7583*        RIDFLD   (ERBILL-KEY)
  7584*        GTEQ
  7585*    END-EXEC.
  7586*    MOVE '&"S        G          (   #00007450' TO DFHEIV0
  7587     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7588     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7589     MOVE X'2020233030303037343530' TO DFHEIV0(25:11)
  7590     CALL 'kxdfhei1' USING DFHEIV0,
  7591           ERBILL-FILE-ID,
  7592           DFHEIV20,
  7593           DFHEIV99,
  7594           ERBILL-KEY,
  7595           DFHEIV99,
  7596           DFHEIV99,
  7597           DFHEIV99
  7598     SET ADDRESS OF BILLING-STATEMENT TO
  7599         DFHEIV20
  7600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7601
  7602
  7603     IF BI-COMPANY-CD  =  PI-COMPANY-CD
  7604       AND  BI-CARRIER  =  ERBILL-CARRIER
  7605       AND  BI-GROUPING  =  ERBILL-GROUP
  7606       AND  BI-ACCOUNT  =  ERBILL-ACCT
  7607       AND  BI-FIN-RESP  =  ERBILL-FIN-RESP
  7608         MOVE SPACE              TO  NO-BILL-REC-SW
  7609         GO TO 3930-EXIT
  7610     ELSE
  7611         GO TO 3930-BILL-NOTFND.
  7612
  7613 3930-BILL-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 152
* EL642.cbl
  7614     MOVE 'Y'                    TO  NO-BILL-REC-SW.
  7615
  7616 3930-EXIT.
  7617     EXIT.
  7618
  7619 3940-BILL-GENERIC-DELETE.
  7620
  7621* EXEC CICS HANDLE CONDITION
  7622*        NOTFND  (3940-EXIT)
  7623*    END-EXEC.
  7624*    MOVE '"$I                   ! % #00007474' TO DFHEIV0
  7625     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7626     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7627     MOVE X'2520233030303037343734' TO DFHEIV0(25:11)
  7628     CALL 'kxdfhei1' USING DFHEIV0
  7629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7630
  7631
  7632     MOVE PI-COMPANY-CD          TO  ERBILL-CO-CD.
  7633     MOVE PI-SAV-CARR            TO  ERBILL-CARRIER.
  7634     MOVE PI-SAV-GROUP           TO  ERBILL-GROUP.
  7635     MOVE LOW-VALUES             TO  ERBILL-ACCT.
  7636     MOVE PI-SAV-AGENT           TO  ERBILL-FIN-RESP.
  7637
  7638
  7639* EXEC CICS DELETE
  7640*        DATASET    (ERBILL-FILE-ID)
  7641*        RIDFLD     (ERBILL-KEY)
  7642*        KEYLENGTH  (28)
  7643*        GENERIC
  7644*    END-EXEC.
  7645     MOVE 28
  7646       TO DFHEIV11
  7647*    MOVE '&(  RKG               &   #00007484' TO DFHEIV0
  7648     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  7649     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7650     MOVE X'2020233030303037343834' TO DFHEIV0(25:11)
  7651     CALL 'kxdfhei1' USING DFHEIV0,
  7652           ERBILL-FILE-ID,
  7653           ERBILL-KEY,
  7654           DFHEIV11,
  7655           DFHEIV99,
  7656           DFHEIV99
  7657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7658
  7659
  7660 3940-EXIT.
  7661     EXIT.
  7662
  7663 3990-EXIT.
  7664     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 153
* EL642.cbl
  7666 4000-PNDB-START-BROWSE.
  7667     MOVE SPACES                 TO  ERPNDB-ALT-KEY.
  7668     MOVE PI-COMPANY-CD          TO  ERPNDB-CO-CD-A1.
  7669
  7670     IF CARR-GROUP-ST-ACCNT-CNTL
  7671         MOVE GX-AM-CARRIER  (GX-SUB)  TO  ERPNDB-CARR
  7672         MOVE GX-AM-GROUPING (GX-SUB)  TO  ERPNDB-GROUP
  7673         MOVE GX-AM-STATE    (GX-SUB)  TO  ERPNDB-STATE
  7674         MOVE GX-AM-ACCOUNT  (GX-SUB)  TO  ERPNDB-ACCT
  7675     ELSE
  7676     IF CARR-ST-ACCNT-CNTL
  7677         MOVE GX-AM-CARRIER (GX-SUB)   TO  ERPNDB-CARR
  7678         MOVE GX-AM-STATE   (GX-SUB)   TO  ERPNDB-STATE
  7679         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  ERPNDB-ACCT
  7680     ELSE
  7681     IF CARR-ACCNT-CNTL
  7682         MOVE GX-AM-CARRIER (GX-SUB)   TO  ERPNDB-CARR
  7683         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  ERPNDB-ACCT
  7684     ELSE
  7685     IF ACCNT-CNTL
  7686         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  ERPNDB-ACCT
  7687     ELSE
  7688         MOVE GX-AM-STATE   (GX-SUB)   TO  ERPNDB-STATE
  7689         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  ERPNDB-ACCT.
  7690
  7691     MOVE GX-AM-EFF-DT (GX-SUB)  TO  ERPNDB-EFF-DT.
  7692
  7693
  7694* EXEC CICS HANDLE CONDITION
  7695*        NOTFND  (4010-REC-NOT-FND)
  7696*    END-EXEC.
  7697*    MOVE '"$I                   ! & #00007524' TO DFHEIV0
  7698     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7700     MOVE X'2620233030303037353234' TO DFHEIV0(25:11)
  7701     CALL 'kxdfhei1' USING DFHEIV0
  7702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7703
  7704
  7705
  7706* EXEC CICS STARTBR
  7707*        DATASET  (ERPNDB-ALT-FILE-ID)
  7708*        RIDFLD   (ERPNDB-ALT-KEY)
  7709*        GTEQ
  7710*    END-EXEC.
  7711     MOVE 0
  7712       TO DFHEIV11
  7713*    MOVE '&,         G          &   #00007528' TO DFHEIV0
  7714     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7715     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7716     MOVE X'2020233030303037353238' TO DFHEIV0(25:11)
  7717     CALL 'kxdfhei1' USING DFHEIV0,
  7718           ERPNDB-ALT-FILE-ID,
  7719           ERPNDB-ALT-KEY,
  7720           DFHEIV99,
  7721           DFHEIV11,
  7722           DFHEIV99
  7723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 154
* EL642.cbl
  7724
  7725
  7726     GO TO 4090-EXIT.
  7727
  7728 4010-REC-NOT-FND.
  7729     MOVE 'Y'                    TO  PNDB-EOF-SW.
  7730
  7731 4090-EXIT.
  7732     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 155
* EL642.cbl
  7734 4100-PNDB-READ-NEXT.
  7735
  7736* EXEC CICS HANDLE CONDITION
  7737*        ENDFILE  (4110-END-OF-FILE)
  7738*    END-EXEC.
  7739*    MOVE '"$''                   ! '' #00007543' TO DFHEIV0
  7740     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7741     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7742     MOVE X'2720233030303037353433' TO DFHEIV0(25:11)
  7743     CALL 'kxdfhei1' USING DFHEIV0
  7744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7745
  7746
  7747
  7748* EXEC CICS READNEXT
  7749*        SET      (ADDRESS OF PENDING-BUSINESS)
  7750*        DATASET  (ERPNDB-ALT-FILE-ID)
  7751*        RIDFLD   (ERPNDB-ALT-KEY)
  7752*    END-EXEC.
  7753     MOVE 0
  7754       TO DFHEIV11
  7755*    MOVE '&.S                   )   #00007547' TO DFHEIV0
  7756     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7757     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7758     MOVE X'2020233030303037353437' TO DFHEIV0(25:11)
  7759     CALL 'kxdfhei1' USING DFHEIV0,
  7760           ERPNDB-ALT-FILE-ID,
  7761           DFHEIV20,
  7762           DFHEIV99,
  7763           ERPNDB-ALT-KEY,
  7764           DFHEIV99,
  7765           DFHEIV11,
  7766           DFHEIV99,
  7767           DFHEIV99
  7768     SET ADDRESS OF PENDING-BUSINESS TO
  7769         DFHEIV20
  7770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7771
  7772
  7773     GO TO 4150-EXIT.
  7774
  7775 4110-END-OF-FILE.
  7776     MOVE 'Y'                    TO  PNDB-EOF-SW.
  7777
  7778 4150-EXIT.
  7779     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 156
* EL642.cbl
  7781 4160-PNDB-END-BROWSE.
  7782
  7783* EXEC CICS ENDBR
  7784*        DATASET  (ERPNDB-ALT-FILE-ID)
  7785*    END-EXEC.
  7786     MOVE 0
  7787       TO DFHEIV11
  7788*    MOVE '&2                    $   #00007562' TO DFHEIV0
  7789     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7790     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7791     MOVE X'2020233030303037353632' TO DFHEIV0(25:11)
  7792     CALL 'kxdfhei1' USING DFHEIV0,
  7793           ERPNDB-ALT-FILE-ID,
  7794           DFHEIV11,
  7795           DFHEIV99
  7796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7797
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 157
* EL642.cbl
  7799 4200-PNDB-REWRITE.
  7800     MOVE PB-COMPANY-CD          TO  ERPNDB-CO-CD.
  7801     MOVE PB-ENTRY-BATCH         TO  ERPNDB-BATCH.
  7802     MOVE PB-BATCH-SEQ-NO        TO  ERPNDB-SEQ-NO.
  7803     MOVE PB-BATCH-CHG-SEQ-NO    TO  ERPNDB-CHG-SEQ-NO.
  7804
  7805     PERFORM 4160-PNDB-END-BROWSE
  7806
  7807
  7808* EXEC CICS READ
  7809*        SET      (ADDRESS OF PENDING-BUSINESS)
  7810*        DATASET  (ERPNDB-FILE-ID)
  7811*        RIDFLD   (ERPNDB-PRIME-KEY)
  7812*        UPDATE
  7813*    END-EXEC.
  7814*    MOVE '&"S        EU         (   #00007574' TO DFHEIV0
  7815     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7816     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7817     MOVE X'2020233030303037353734' TO DFHEIV0(25:11)
  7818     CALL 'kxdfhei1' USING DFHEIV0,
  7819           ERPNDB-FILE-ID,
  7820           DFHEIV20,
  7821           DFHEIV99,
  7822           ERPNDB-PRIME-KEY,
  7823           DFHEIV99,
  7824           DFHEIV99,
  7825           DFHEIV99
  7826     SET ADDRESS OF PENDING-BUSINESS TO
  7827         DFHEIV20
  7828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7829
  7830
  7831     MOVE 'B'                    TO  JP-RECORD-TYPE.
  7832     MOVE PENDING-BUSINESS       TO  JP-RECORD-AREA.
  7833     MOVE ERPNDB-FILE-ID         TO  JP-FILE-ID.
  7834
  7835     COMPUTE JOURNAL-LENGTH = ERPNDB-LENGTH + 23.
  7836
  7837     PERFORM 8400-LOG-JOURNAL-RECORD.
  7838
  7839     IF PI-VOID-BILL
  7840         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (WS-GA-LEVEL)
  7841     ELSE
  7842         MOVE WS-CURRENT-DATE    TO  PB-GA-BILL-DT (WS-GA-LEVEL).
  7843
  7844     MOVE PI-PROCESSOR-ID        TO  PB-LAST-MAINT-BY.
  7845     MOVE EIBTIME                TO  PB-LAST-MAINT-HHMMSS.
  7846     MOVE WS-CURRENT-DATE        TO  PB-LAST-MAINT-DT.
  7847     MOVE 'C'                    TO  JP-RECORD-TYPE.
  7848     MOVE PENDING-BUSINESS       TO  JP-RECORD-AREA.
  7849     MOVE ERPNDB-FILE-ID         TO  JP-FILE-ID.
  7850
  7851     COMPUTE JOURNAL-LENGTH = ERPNDB-LENGTH + 23.
  7852
  7853
  7854* EXEC CICS REWRITE
  7855*        DATASET  (ERPNDB-FILE-ID)
  7856*        FROM     (PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 158
* EL642.cbl
  7857*    END-EXEC.
  7858     MOVE LENGTH OF
  7859      PENDING-BUSINESS
  7860       TO DFHEIV11
  7861*    MOVE '&& L                  %   #00007603' TO DFHEIV0
  7862     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7863     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7864     MOVE X'2020233030303037363033' TO DFHEIV0(25:11)
  7865     CALL 'kxdfhei1' USING DFHEIV0,
  7866           ERPNDB-FILE-ID,
  7867           PENDING-BUSINESS,
  7868           DFHEIV11,
  7869           DFHEIV99
  7870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7871
  7872
  7873     PERFORM 8400-LOG-JOURNAL-RECORD.
  7874
  7875
  7876* EXEC CICS HANDLE CONDITION
  7877*        NOTFND  (4290-REC-NOT-FND)
  7878*    END-EXEC.
  7879*    MOVE '"$I                   ! ( #00007610' TO DFHEIV0
  7880     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7881     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7882     MOVE X'2820233030303037363130' TO DFHEIV0(25:11)
  7883     CALL 'kxdfhei1' USING DFHEIV0
  7884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7885
  7886
  7887
  7888* EXEC CICS STARTBR
  7889*        DATASET  (ERPNDB-ALT-FILE-ID)
  7890*        RIDFLD   (ERPNDB-ALT-KEY)
  7891*        GTEQ
  7892*    END-EXEC.
  7893     MOVE 0
  7894       TO DFHEIV11
  7895*    MOVE '&,         G          &   #00007614' TO DFHEIV0
  7896     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7897     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7898     MOVE X'2020233030303037363134' TO DFHEIV0(25:11)
  7899     CALL 'kxdfhei1' USING DFHEIV0,
  7900           ERPNDB-ALT-FILE-ID,
  7901           ERPNDB-ALT-KEY,
  7902           DFHEIV99,
  7903           DFHEIV11,
  7904           DFHEIV99
  7905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7906
  7907
  7908     PERFORM 4100-PNDB-READ-NEXT  THRU  4150-EXIT.
  7909
  7910     GO TO 4290-EXIT.
  7911
  7912 4290-REC-NOT-FND.
  7913     MOVE 'Y'                    TO  PYAJ-EOF-SW.
  7914
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 159
* EL642.cbl
  7915 4290-EXIT.
  7916     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 160
* EL642.cbl
  7918 4300-READ-ACCOUNT-MASTER.
  7919
  7920     MOVE SPACE                  TO  INVALID-ACCOUNT-SW.
  7921     MOVE PI-COMPANY-CD          TO  ERACCT-P-CO-CD.
  7922     MOVE PI-CR-CARRIER          TO  ERACCT-P-CARRIER.
  7923     MOVE PI-CR-GROUPING         TO  ERACCT-P-GROUPING.
  7924     MOVE PI-CR-STATE            TO  ERACCT-P-STATE.
  7925     MOVE PI-CR-ACCOUNT          TO  ERACCT-P-ACCOUNT.
  7926     MOVE PI-SAV-EXP-DT          TO  ERACCT-P-EXP-DATE.
  7927
  7928
  7929* EXEC CICS HANDLE CONDITION
  7930*        NOTFND  (4370-ACCOUNT-INVALID)
  7931*    END-EXEC.
  7932*    MOVE '"$I                   ! ) #00007640' TO DFHEIV0
  7933     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7935     MOVE X'2920233030303037363430' TO DFHEIV0(25:11)
  7936     CALL 'kxdfhei1' USING DFHEIV0
  7937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7938
  7939
  7940
  7941* EXEC CICS READ
  7942*        DATASET  (ERACCT-FILE-ID)
  7943*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7944*        RIDFLD   (ERACCT-PRIME-KEY)
  7945*        EQUAL
  7946*    END-EXEC.
  7947*    MOVE '&"S        E          (   #00007644' TO DFHEIV0
  7948     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7949     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7950     MOVE X'2020233030303037363434' TO DFHEIV0(25:11)
  7951     CALL 'kxdfhei1' USING DFHEIV0,
  7952           ERACCT-FILE-ID,
  7953           DFHEIV20,
  7954           DFHEIV99,
  7955           ERACCT-PRIME-KEY,
  7956           DFHEIV99,
  7957           DFHEIV99,
  7958           DFHEIV99
  7959     SET ADDRESS OF ACCOUNT-MASTER TO
  7960         DFHEIV20
  7961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7962
  7963
  7964     IF AM-REMIT-TO  NOT GREATER THAN  '00'
  7965         GO TO 4370-ACCOUNT-INVALID.
  7966
  7967     IF AM-AGT (AM-REMIT-TO)  =  SPACES
  7968         MOVE PI-CR-ACCOUNT      TO  PI-SAV-REMIT-TO
  7969     ELSE
  7970         MOVE AM-AGT (AM-REMIT-TO)
  7971                                 TO  PI-SAV-REMIT-TO.
  7972
  7973     MOVE AM-EXPIRATION-DT       TO  ERACCT-P-EXP-DATE.
  7974     MOVE AM-CARRIER             TO  PI-CR-CARRIER.
  7975     MOVE AM-GROUPING            TO  PI-CR-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 161
* EL642.cbl
  7976     MOVE AM-STATE               TO  PI-CR-STATE.
  7977     MOVE AM-AGT (AM-REMIT-TO)   TO  PI-SAV-FIN-RESP
  7978                                     PI-COMP-FIN-RESP.
  7979
  7980     IF PI-ZERO-CARRIER
  7981       OR  PI-ZERO-CAR-GROUP
  7982         MOVE ZEROS              TO  PI-COMP-CARRIER
  7983     ELSE
  7984         MOVE AM-CARRIER         TO  PI-COMP-CARRIER.
  7985
  7986     IF PI-ZERO-GROUPING
  7987        OR  PI-ZERO-CAR-GROUP
  7988         MOVE ZEROS              TO  PI-COMP-GROUPING
  7989     ELSE
  7990         MOVE AM-GROUPING        TO  PI-COMP-GROUPING.
  7991
  7992     IF CARR-GROUP-ST-ACCNT-CNTL
  7993         MOVE SPACE              TO  NEW-ACCOUNT-SW.
  7994
  7995     MOVE +0                     TO  ACCOM-SUB.
  7996
  7997 4320-FIND-ACCT-RESPONSIBILITY.
  7998     ADD +1                      TO  ACCOM-SUB.
  7999
  8000     IF ACCOM-SUB  GREATER THAN  +10
  8001         MOVE  AM-ACCOUNT        TO  GA-ACCT
  8002         GO TO 4330-FIND-GA-COMMISSION.
  8003
  8004     IF AM-COM-TYP (ACCOM-SUB) = 'C' OR 'D' OR 'F'
  8005         NEXT SENTENCE
  8006     ELSE
  8007         GO TO 4320-FIND-ACCT-RESPONSIBILITY.
  8008
  8009     IF AM-AGT (ACCOM-SUB)  NOT =  PI-SAV-ACCT-AGT
  8010         MOVE 'Y'                TO  NEW-ACCOUNT-SW.
  8011
  8012     MOVE AM-AGT (ACCOM-SUB)     TO  PI-SAV-ACCT-AGT.
  8013     MOVE AM-NAME                TO  PI-SAV-ACCT-NAME.
  8014
  8015 4330-FIND-GA-COMMISSION.
  8016     MOVE ZEROS                  TO  WS-GA-LEVEL
  8017                                     WS-GA-LF-COM
  8018                                     WS-GA-AH-COM.
  8019     MOVE +0                     TO  ACCOM-SUB.
  8020
  8021 4340-SEARCH-FOR-GA-COMMISSION.
  8022     ADD +1                      TO  ACCOM-SUB.
  8023
  8024     IF ACCOM-SUB  GREATER THAN  +10
  8025         GO TO 4370-ACCOUNT-INVALID.
  8026
  8027     IF AM-COM-TYP (ACCOM-SUB) = 'O' OR 'P' OR 'G' OR 'B' OR 'K'
  8028                              OR 'S'
  8029        CONTINUE
  8030     ELSE
  8031        GO TO 4340-SEARCH-FOR-GA-COMMISSION
  8032     END-IF
  8033
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 162
* EL642.cbl
  8034     IF AM-AGT (ACCOM-SUB)  NOT =  PI-SAV-AGENT
  8035         GO TO 4340-SEARCH-FOR-GA-COMMISSION.
  8036
  8037     MOVE ACCOM-SUB              TO  WS-GA-LEVEL.
  8038
  8039     GO TO 4390-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 163
* EL642.cbl
  8041 4370-ACCOUNT-INVALID.
  8042     MOVE 'Y'                    TO  INVALID-ACCOUNT-SW.
  8043     MOVE ER-2210                TO  EMI-ERROR.
  8044
  8045     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8046
  8047     GO TO 4390-EXIT.
  8048
  8049 4390-EXIT.
  8050     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 164
* EL642.cbl
  8052 4400-FIND-COMMISSION.
  8053******************************************************************
  8054*    IF THE AGENT'S COMMISSION IS NUMERIC FOR A&H AND LIFE       *
  8055*    IN THE ACCOUNT MASTER THAT IS THE COMMISSION.  IF THE       *
  8056*    COMMISSION IN THE A&H AND LIFE CONTAINS A TABLE CODE        *
  8057*    READ THE COMMISSION-TABLE TO GET THE COMMISSION RATE.       *
  8058*    FOR CLIENT "DMD" THE ABOVE COMMISSION MAY BE OVERWRITTEN    *
  8059*    IF AN ACCOUNT RESIDENT STATE COMMISSION RECORD EXISTS.      *
  8060******************************************************************
  8061
  8062     MOVE PI-COMPANY-CD          TO  ERCTBL-COMPANY-CD.
  8063
  8064 4405-FIND-AH-COMMISSION.
  8065* SET UP COMMISSION TABLE KEY BEFORE DETERMINING COMMISSION
  8066     IF PB-ISSUE
  8067         MOVE PB-I-AH-BENEFIT-CD  TO  ERCTBL-BEN-CODE
  8068     ELSE
  8069         MOVE PB-CI-AH-BENEFIT-CD TO  ERCTBL-BEN-CODE.
  8070
  8071     MOVE 'A'                     TO  ERCTBL-BEN-TYPE.
  8072
  8073     MOVE 'AH'                   TO WS-COMM-SW.
  8074
  8075     IF AM-A-COM (WS-GA-LEVEL)  NUMERIC
  8076         MOVE AM-A-COM (WS-GA-LEVEL)
  8077                                 TO  WS-COMMISSION
  8078         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
  8079         MOVE WS-COMMISSION      TO  WS-GA-AH-COM
  8080         GO TO 4410-FIND-LIFE-COMMISSION.
  8081
  8082     IF ERCTBL-BEN-CODE  =  ZEROS
  8083         MOVE ZEROS              TO  WS-GA-LF-COM
  8084         GO TO 4410-FIND-LIFE-COMMISSION.
  8085
  8086     MOVE ZEROS                  TO WS-SUB1.
  8087     PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT.
  8088     IF WS-SUB1 IS GREATER THAN ZEROS
  8089         GO TO 4410-FIND-LIFE-COMMISSION.
  8090
  8091     MOVE 'A'                     TO  ERCTBL-BEN-TYPE.
  8092
  8093     MOVE AM-A-COMA (WS-GA-LEVEL) TO ERCTBL-TABLE.
  8094     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8095
  8096     IF ERCTBL-NOT-FOUND
  8097         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8098         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8099         IF ERCTBL-NOT-FOUND
  8100             MOVE -1             TO  AAGENTL
  8101             MOVE ER-2916        TO  EMI-ERROR
  8102             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8103             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8104             GO TO 8200-SEND-DATAONLY.
  8105
  8106     PERFORM 6680-AH-GET-COMP-RATE.
  8107
  8108 4410-FIND-LIFE-COMMISSION.
  8109     IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 165
* EL642.cbl
  8110         MOVE PB-CI-LF-BENEFIT-CD  TO CLBENF-CD
  8111     ELSE
  8112         MOVE PB-I-LF-BENEFIT-CD   TO CLBENF-CD.
  8113
  8114     MOVE 'LF'                   TO WS-COMM-SW.
  8115
  8116     IF CLBENF-CD  =  ZEROS  OR  SPACES
  8117         MOVE ZEROS              TO  WS-GA-LF-COM
  8118         GO TO 4490-EXIT.
  8119
  8120     IF PB-ISSUE
  8121         MOVE PB-I-LIFE-INDICATOR TO LIFE-INDICATOR
  8122         GO TO 4420-CONT-FIND-LIFE-COMMISSION.
  8123
  8124     PERFORM 6800-READ-BENEFIT-MASTER  THRU  6890-EXIT.
  8125
  8126     IF BENEFIT-MASTER-FOUND
  8127         NEXT SENTENCE
  8128     ELSE
  8129         MOVE -1                 TO  AAGENTL
  8130         MOVE ER-2917            TO  EMI-ERROR
  8131         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8132         PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8133         GO TO 8200-SEND-DATAONLY.
  8134
  8135 4420-CONT-FIND-LIFE-COMMISSION.
  8136* SET UP COMMISSION TABLE KEY BEFORE DETERMINING COMMISSION
  8137
  8138     IF PB-ISSUE
  8139         MOVE PB-I-LF-BENEFIT-CD  TO  ERCTBL-BEN-CODE
  8140     ELSE
  8141         MOVE PB-CI-LF-BENEFIT-CD TO  ERCTBL-BEN-CODE.
  8142
  8143     MOVE 'L'                     TO  ERCTBL-BEN-TYPE.
  8144
  8145     IF JOINT-LIFE
  8146         NEXT SENTENCE
  8147     ELSE
  8148         GO TO 4430-SINGLE-LIFE-COMMISSION.
  8149
  8150     IF AM-J-COM (WS-GA-LEVEL)  NUMERIC
  8151         MOVE AM-J-COM (WS-GA-LEVEL)
  8152                                 TO  WS-COMMISSION
  8153         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
  8154         MOVE WS-COMMISSION      TO  WS-GA-LF-COM
  8155         GO TO 4490-EXIT.
  8156
  8157     MOVE ZEROS                  TO WS-SUB1.
  8158     PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT.
  8159     IF WS-SUB1 IS GREATER THAN ZEROS
  8160         GO TO 4490-EXIT.
  8161
  8162     MOVE AM-J-COMA (WS-GA-LEVEL) TO ERCTBL-TABLE.
  8163
  8164     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8165
  8166     IF ERCTBL-NOT-FOUND
  8167         MOVE 'AA'               TO  ERCTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 166
* EL642.cbl
  8168         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8169         IF ERCTBL-NOT-FOUND
  8170             MOVE -1             TO  AAGENTL
  8171             MOVE ER-2916        TO  EMI-ERROR
  8172             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8173             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8174             GO TO 8200-SEND-DATAONLY.
  8175
  8176     PERFORM 6680-LF-GET-COMP-RATE.
  8177     GO TO 4490-EXIT.
  8178
  8179 4430-SINGLE-LIFE-COMMISSION.
  8180* SET UP COMMISSION TABLE KEY BEFORE DETERMINING COMMISSION
  8181
  8182     IF PB-ISSUE
  8183         MOVE PB-I-LF-BENEFIT-CD  TO  ERCTBL-BEN-CODE
  8184     ELSE
  8185         MOVE PB-CI-LF-BENEFIT-CD TO  ERCTBL-BEN-CODE.
  8186
  8187     MOVE 'L'                     TO  ERCTBL-BEN-TYPE.
  8188*
  8189     IF AM-L-COM (WS-GA-LEVEL)  NUMERIC
  8190         MOVE AM-L-COM (WS-GA-LEVEL)
  8191                                 TO  WS-COMMISSION
  8192         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
  8193         MOVE WS-COMMISSION      TO  WS-GA-LF-COM
  8194         GO TO 4490-EXIT.
  8195
  8196     MOVE ZEROS                  TO WS-SUB1.
  8197     PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT.
  8198     IF WS-SUB1 IS GREATER THAN ZEROS
  8199         GO TO 4490-EXIT.
  8200
  8201     MOVE ZEROS                  TO WS-SUB1.
  8202     MOVE AM-L-COMA (WS-GA-LEVEL) TO ERCTBL-TABLE
  8203
  8204     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8205
  8206     IF ERCTBL-NOT-FOUND
  8207         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8208         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8209         IF ERCTBL-NOT-FOUND
  8210             MOVE -1             TO  AAGENTL
  8211             MOVE ER-2916        TO  EMI-ERROR
  8212             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8213             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8214             GO TO 8200-SEND-DATAONLY.
  8215
  8216     PERFORM 6680-LF-GET-COMP-RATE.
  8217     GO TO 4490-EXIT.
  8218
  8219 4490-EXIT.
  8220     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 167
* EL642.cbl
  8222 4500-PYAJ-START-BROWSE.
  8223     MOVE LOW-VALUES             TO  ERPYAJ-KEY.
  8224     MOVE PI-COMPANY-CD          TO  ERPYAJ-COMP-CD.
  8225
  8226     IF GENERAL-AGENT
  8227         MOVE PI-SAV-CARR        TO  ERPYAJ-CARRIER
  8228         MOVE PI-SAV-GROUP       TO  ERPYAJ-GROUPING
  8229         MOVE PI-SAV-AGENT       TO  ERPYAJ-FIN-RESP
  8230         MOVE LOW-VALUES         TO  ERPYAJ-ACCOUNT
  8231     ELSE
  8232         MOVE PI-COMP-CARRIER    TO  ERPYAJ-CARRIER
  8233         MOVE PI-COMP-GROUPING   TO  ERPYAJ-GROUPING
  8234         MOVE PI-COMP-FIN-RESP   TO  ERPYAJ-FIN-RESP
  8235         MOVE PI-CR-ACCOUNT      TO  ERPYAJ-ACCOUNT.
  8236
  8237     MOVE ERPYAJ-KEY             TO  ERPYAJ-BROWSE-COMP-KEY.
  8238
  8239
  8240* EXEC CICS HANDLE CONDITION
  8241*        NOTFND  (4510-REC-NOT-FND)
  8242*    END-EXEC.
  8243*    MOVE '"$I                   ! * #00007926' TO DFHEIV0
  8244     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8245     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8246     MOVE X'2A20233030303037393236' TO DFHEIV0(25:11)
  8247     CALL 'kxdfhei1' USING DFHEIV0
  8248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8249
  8250
  8251
  8252* EXEC CICS STARTBR
  8253*        DATASET  (ERPYAJ-FILE-ID)
  8254*        RIDFLD   (ERPYAJ-KEY)
  8255*        GTEQ
  8256*    END-EXEC.
  8257     MOVE 0
  8258       TO DFHEIV11
  8259*    MOVE '&,         G          &   #00007930' TO DFHEIV0
  8260     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8261     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8262     MOVE X'2020233030303037393330' TO DFHEIV0(25:11)
  8263     CALL 'kxdfhei1' USING DFHEIV0,
  8264           ERPYAJ-FILE-ID,
  8265           ERPYAJ-KEY,
  8266           DFHEIV99,
  8267           DFHEIV11,
  8268           DFHEIV99
  8269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8270
  8271
  8272     GO TO 4590-EXIT.
  8273
  8274 4510-REC-NOT-FND.
  8275     MOVE 'Y'                    TO  PYAJ-EOF-SW.
  8276
  8277 4590-EXIT.
  8278     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 168
* EL642.cbl
  8280 4600-PYAJ-READ-NEXT.
  8281
  8282* EXEC CICS HANDLE CONDITION
  8283*        ENDFILE  (4610-END-OF-FILE)
  8284*    END-EXEC.
  8285*    MOVE '"$''                   ! + #00007945' TO DFHEIV0
  8286     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8287     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8288     MOVE X'2B20233030303037393435' TO DFHEIV0(25:11)
  8289     CALL 'kxdfhei1' USING DFHEIV0
  8290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8291
  8292
  8293
  8294* EXEC CICS READNEXT
  8295*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  8296*        DATASET  (ERPYAJ-FILE-ID)
  8297*        RIDFLD   (ERPYAJ-KEY)
  8298*    END-EXEC.
  8299     MOVE 0
  8300       TO DFHEIV11
  8301*    MOVE '&.S                   )   #00007949' TO DFHEIV0
  8302     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8303     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8304     MOVE X'2020233030303037393439' TO DFHEIV0(25:11)
  8305     CALL 'kxdfhei1' USING DFHEIV0,
  8306           ERPYAJ-FILE-ID,
  8307           DFHEIV20,
  8308           DFHEIV99,
  8309           ERPYAJ-KEY,
  8310           DFHEIV99,
  8311           DFHEIV11,
  8312           DFHEIV99,
  8313           DFHEIV99
  8314     SET ADDRESS OF PENDING-PAY-ADJ TO
  8315         DFHEIV20
  8316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8317
  8318
  8319     GO TO 4690-EXIT.
  8320
  8321 4610-END-OF-FILE.
  8322     MOVE 'Y'                    TO  PYAJ-EOF-SW.
  8323
  8324 4690-EXIT.
  8325     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 169
* EL642.cbl
  8327 4700-PROCESS-COMM-EXCEPTION.
  8328     PERFORM 6600-READ-COMMISSION-EXCEPTION  THRU  6620-EXIT.
  8329
  8330     IF ERCOMM-NOT-FOUND
  8331         MOVE -1                 TO  AAGENTL
  8332         MOVE ER-2915            TO  EMI-ERROR
  8333         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8334         PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8335         GO TO 8200-SEND-DATAONLY.
  8336
  8337     MOVE WS-GA-LEVEL            TO  CE-SUB.
  8338     MOVE PI-COMPANY-CD          TO  ERCTBL-COMPANY-CD.
  8339
  8340     IF CE-LF-COMP (CE-SUB)  NUMERIC
  8341         IF CE-AH-COMP (CE-SUB)  NUMERIC
  8342             MOVE CE-LF-COMP (CE-SUB)  TO  WS-GA-LF-COM
  8343             MOVE CE-AH-COMP (CE-SUB)  TO  WS-GA-AH-COM
  8344             GO TO 4790-EXIT.
  8345
  8346 4715-FIND-AH-COMMISSION.
  8347     IF CE-AH-COMP (CE-SUB)  NUMERIC
  8348         MOVE CE-AH-COMP (CE-SUB)  TO  WS-GA-AH-COM
  8349         GO TO 4750-FIND-LIFE-COMMISSION.
  8350
  8351     MOVE CE-AH-COMPT (CE-SUB)   TO  ERCTBL-TABLE.
  8352
  8353     IF PB-ISSUE
  8354         MOVE PB-I-AH-BENEFIT-CD   TO  ERCTBL-BEN-CODE
  8355     ELSE
  8356         MOVE PB-CI-AH-BENEFIT-CD  TO  ERCTBL-BEN-CODE.
  8357
  8358     IF ERCTBL-BEN-CODE  =  ZEROS
  8359         MOVE ZEROS              TO  WS-GA-AH-COM
  8360         GO TO 4750-FIND-LIFE-COMMISSION.
  8361
  8362     MOVE 'A'                    TO  ERCTBL-BEN-TYPE.
  8363
  8364     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8365
  8366     IF ERCTBL-NOT-FOUND
  8367         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8368         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8369         IF ERCTBL-NOT-FOUND
  8370             MOVE -1             TO  AAGENTL
  8371             MOVE ER-2916        TO  EMI-ERROR
  8372             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8373             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8374             GO TO 8200-SEND-DATAONLY.
  8375
  8376     IF PB-ISSUE
  8377         COMPUTE WS-COMM-CK-AMT =
  8378             PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8379         MOVE PB-I-AGE           TO  WS-COMM-AGE
  8380         MOVE PB-I-AH-TERM       TO  WS-COMM-TERM
  8381     ELSE
  8382         COMPUTE WS-COMM-CK-AMT =
  8383             PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8384         MOVE PB-CI-INSURED-AGE  TO  WS-COMM-AGE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 170
* EL642.cbl
  8385         MOVE PB-CI-AH-TERM      TO  WS-COMM-TERM.
  8386
  8387     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  8388
  8389     MOVE WS-WK-RATE             TO  WS-GA-AH-COM.
  8390
  8391 4750-FIND-LIFE-COMMISSION.
  8392     IF PB-ISSUE
  8393         MOVE PB-I-LF-BENEFIT-CD   TO  CLBENF-CD
  8394     ELSE
  8395         MOVE PB-CI-LF-BENEFIT-CD  TO  CLBENF-CD.
  8396
  8397     IF CLBENF-CD  =  ZEROS  OR  SPACES
  8398         MOVE ZEROS              TO  WS-GA-LF-COM
  8399         GO TO 4790-EXIT.
  8400
  8401     IF PB-ISSUE
  8402         MOVE PB-I-LIFE-INDICATOR  TO  LIFE-INDICATOR
  8403         GO TO 4760-CONT-FIND-LIFE-COMMISSION.
  8404
  8405     PERFORM 6800-READ-BENEFIT-MASTER  THRU  6890-EXIT.
  8406
  8407     IF BENEFIT-MASTER-FOUND
  8408         NEXT SENTENCE
  8409     ELSE
  8410         MOVE -1                 TO  AAGENTL
  8411         MOVE ER-2917            TO  EMI-ERROR
  8412         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8413         PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8414         GO TO 8200-SEND-DATAONLY.
  8415
  8416 4760-CONT-FIND-LIFE-COMMISSION.
  8417     IF JOINT-LIFE NEXT SENTENCE
  8418     ELSE
  8419         GO TO 4770-SINGLE-LIFE-COMMISSION.
  8420
  8421     IF CE-LF-COMP (CE-SUB)  NUMERIC
  8422         MOVE CE-LF-COMP (CE-SUB)  TO  WS-GA-LF-COM
  8423         GO TO 4790-EXIT.
  8424
  8425     MOVE CE-LF-COMPT (CE-SUB)   TO  ERCTBL-TABLE.
  8426
  8427     IF PB-ISSUE
  8428         MOVE PB-I-LF-BENEFIT-CD   TO  ERCTBL-BEN-CODE
  8429     ELSE
  8430         MOVE PB-CI-LF-BENEFIT-CD  TO  ERCTBL-BEN-CODE.
  8431
  8432     MOVE 'J'                    TO  ERCTBL-BEN-TYPE.
  8433
  8434     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8435
  8436     IF ERCTBL-NOT-FOUND
  8437         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8438         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8439         IF ERCTBL-NOT-FOUND
  8440             MOVE -1             TO  AAGENTL
  8441             MOVE ER-2916        TO  EMI-ERROR
  8442             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 171
* EL642.cbl
  8443             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8444             GO TO 8200-SEND-DATAONLY.
  8445
  8446     IF PB-ISSUE
  8447         MOVE PB-I-LF-BENEFIT-AMT   TO  WS-COMM-CK-AMT
  8448         MOVE PB-I-AGE              TO  WS-COMM-AGE
  8449         MOVE PB-I-LF-TERM          TO  WS-COMM-TERM
  8450     ELSE
  8451         MOVE PB-CI-INSURED-AGE     TO  WS-COMM-AGE
  8452         MOVE PB-CI-LF-TERM         TO  WS-COMM-TERM
  8453         MOVE PB-CI-LF-BENEFIT-AMT  TO  WS-COMM-CK-AMT.
  8454
  8455     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  8456
  8457     MOVE WS-WK-RATE             TO  WS-GA-LF-COM.
  8458
  8459     GO TO 4790-EXIT.
  8460
  8461 4770-SINGLE-LIFE-COMMISSION.
  8462     IF CE-LF-COMP (CE-SUB)  NUMERIC
  8463         MOVE CE-LF-COMP (CE-SUB)  TO  WS-GA-LF-COM
  8464         GO TO 4790-EXIT.
  8465
  8466     MOVE CE-LF-COMPT (CE-SUB)   TO  ERCTBL-TABLE.
  8467
  8468     IF PB-ISSUE
  8469         MOVE PB-I-LF-BENEFIT-CD   TO  ERCTBL-BEN-CODE
  8470     ELSE
  8471         MOVE PB-CI-LF-BENEFIT-CD  TO  ERCTBL-BEN-CODE.
  8472
  8473     MOVE 'L'                    TO  ERCTBL-BEN-TYPE.
  8474
  8475     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8476
  8477     IF ERCTBL-NOT-FOUND
  8478         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8479         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8480         IF ERCTBL-NOT-FOUND
  8481             MOVE -1             TO  AAGENTL
  8482             MOVE ER-2916        TO  EMI-ERROR
  8483             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8484             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8485             GO TO 8200-SEND-DATAONLY.
  8486
  8487     IF PB-ISSUE
  8488         MOVE PB-I-LF-BENEFIT-AMT   TO  WS-COMM-CK-AMT
  8489         MOVE PB-I-AGE              TO  WS-COMM-AGE
  8490         MOVE PB-I-LF-TERM          TO  WS-COMM-TERM
  8491     ELSE
  8492         MOVE PB-CI-INSURED-AGE     TO  WS-COMM-AGE
  8493         MOVE PB-CI-LF-TERM         TO  WS-COMM-TERM
  8494         MOVE PB-CI-LF-BENEFIT-AMT  TO  WS-COMM-CK-AMT.
  8495
  8496     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  8497
  8498     MOVE WS-WK-RATE             TO  WS-GA-LF-COM.
  8499
  8500 4790-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 172
* EL642.cbl
  8501     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 173
* EL642.cbl
  8503 4800-PYAJ-END-BROWSE.
  8504
  8505* EXEC CICS ENDBR
  8506*        DATASET  (ERPYAJ-FILE-ID)
  8507*    END-EXEC.
  8508     MOVE 0
  8509       TO DFHEIV11
  8510*    MOVE '&2                    $   #00008140' TO DFHEIV0
  8511     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8512     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8513     MOVE X'2020233030303038313430' TO DFHEIV0(25:11)
  8514     CALL 'kxdfhei1' USING DFHEIV0,
  8515           ERPYAJ-FILE-ID,
  8516           DFHEIV11,
  8517           DFHEIV99
  8518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8519
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 174
* EL642.cbl
  8521 4900-GET-COMP-RATE.
  8522     MOVE +1                     TO  COMP-SUB.
  8523
  8524     IF WS-COMM-CK-AMT  GREATER THAN  CT-TBF (1)
  8525         ADD +9                  TO  COMP-SUB
  8526         IF WS-COMM-CK-AMT  GREATER THAN  CT-TBF (2)
  8527             ADD +9              TO  COMP-SUB
  8528             IF WS-COMM-CK-AMT  GREATER THAN  CT-TBF (3)
  8529                 MOVE -1         TO  AAGENTL
  8530                 MOVE ER-2918    TO  EMI-ERROR
  8531                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8532                 PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8533                 GO TO 8200-SEND-DATAONLY.
  8534
  8535     IF WS-COMM-AGE  GREATER THAN  CT-AGE (1)
  8536         ADD +3                  TO  COMP-SUB
  8537         IF WS-COMM-AGE  GREATER THAN  CT-AGE (2)
  8538             ADD +1              TO  COMP-SUB
  8539             IF WS-COMM-AGE  GREATER THAN  CT-AGE (3)
  8540                 MOVE -1         TO  AAGENTL
  8541                 MOVE ER-2918    TO  EMI-ERROR
  8542                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8543                 PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8544                 GO TO 8200-SEND-DATAONLY.
  8545
  8546     IF WS-COMM-TERM  GREATER  CT-TRM (1)
  8547         ADD +1                  TO  COMP-SUB
  8548         IF WS-COMM-TERM  GREATER THAN  CT-TRM (2)
  8549             ADD +1              TO  COMP-SUB
  8550             IF WS-COMM-TERM  GREATER THAN  CT-TRM (3)
  8551                 MOVE -1         TO  AAGENTL
  8552                 MOVE ER-2918    TO  EMI-ERROR
  8553                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8554                 PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8555                 GO TO 8200-SEND-DATAONLY.
  8556
  8557     IF CT-RT (COMP-SUB)  NOT  NUMERIC
  8558         MOVE CT-RT-R (COMP-SUB)  TO  ERCTBL-TABLE
  8559         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8560         GO TO 4900-GET-COMP-RATE.
  8561
  8562     MOVE CT-RT (COMP-SUB)       TO  WS-WK-RATE.
  8563
  8564 4990-EXIT.
  8565     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 175
* EL642.cbl
  8567 5000-FORMAT-SCREEN.
  8568     MOVE LOW-VALUES             TO  EL642AO.
  8569
  8570     IF PI-SAV-AGENT  GREATER THAN  SPACES
  8571         MOVE PI-SAV-AGENT       TO  AAGENTO
  8572         MOVE PI-SAV-CARR        TO  ACARIERO
  8573         MOVE PI-SAV-GROUP       TO  AGROUPO.
  8574
  8575     MOVE PI-BILL-TYPE           TO  ABILTYPI.
  8576     MOVE AL-UANON               TO  AAGENTA
  8577                                     ACARIERA
  8578                                     AGROUPA
  8579                                     ABILTYPA.
  8580
  8581     IF PI-BILLING-ACCOUNTS (1)  NOT =  SPACES
  8582         MOVE PI-BILLING-ACCOUNTS (1)
  8583                                 TO  AACCT1I
  8584         MOVE AL-UANON           TO  AACCT1A.
  8585
  8586     IF PI-BILLING-ACCOUNTS (2)  NOT =  SPACES
  8587         MOVE PI-BILLING-ACCOUNTS (2)
  8588                                 TO  AACCT2I
  8589         MOVE AL-UANON           TO  AACCT2A.
  8590
  8591     IF PI-BILLING-ACCOUNTS (3)  NOT =  SPACES
  8592         MOVE PI-BILLING-ACCOUNTS (3)
  8593                                 TO  AACCT3I
  8594         MOVE AL-UANON           TO  AACCT3A.
  8595
  8596 5005-FORMAT-STATS.
  8597
  8598     IF PI-CR-FIN-RESP = SPACES
  8599         GO TO 5090-EXIT.
  8600
  8601     MOVE PI-BAL-FRWD            TO  ABEGBALO.
  8602     MOVE PI-UNPAID-NET-PREM     TO  AUPDPRMO.
  8603     MOVE PI-COMP-UNPAID-PREM    TO  AUPDCOMO.
  8604     MOVE PI-ISSUES-BILLED       TO  ABILL1O.
  8605     MOVE PI-ISSUES-INER         TO  AINER1O.
  8606     MOVE PI-ISSUES-PREV         TO  APRVBL1O.
  8607     MOVE PI-CANCELS-BILLED      TO  ABILL2O.
  8608     MOVE PI-CANCELS-INER        TO  AINER2O.
  8609     MOVE PI-CANCELS-PREV        TO  APRVBL2O.
  8610
  8611
  8612     IF PI-UNKNOWN  GREATER THAN  ZEROS
  8613         MOVE ER-2912            TO  EMI-ERROR
  8614         MOVE PI-UNKNOWN         TO  AUNKNERO
  8615         MOVE AL-SABOF           TO  AUNKNERA
  8616         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8617
  8618     MOVE PI-PREMIUM             TO  APREMUMO.
  8619     MOVE PI-REMITTED            TO  AREMITO.
  8620     MOVE PI-TOT-ISS-COMP        TO  ACOMPISO.
  8621     MOVE PI-TOT-CAN-COMP        TO  ACOMCANO.
  8622     MOVE PI-ADJUSTMNTS          TO  AADJUSTO.
  8623     MOVE PI-DISBURSED           TO  ADISBURO.
  8624     MOVE ZERO                   TO  PI-END-BAL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 176
* EL642.cbl
  8625
  8626     IF PI-SAV-AGENT = PI-SAV-REMIT-TO
  8627         COMPUTE PI-DUE-FOR-ACCT =
  8628             (PI-ACCT-BEG-BAL + PI-ACCT-NET-PREM) -
  8629              (PI-ACCT-COMP + PI-ACCT-PAY-ADJS).
  8630
  8631     COMPUTE PI-END-BAL = PI-BAL-FRWD - PI-TOT-ISS-COMP
  8632                        + PI-TOT-CAN-COMP + PI-ADJUSTMNTS
  8633                        - PI-REMITTED + PI-DISBURSED.
  8634
  8635     MOVE PI-END-BAL             TO  ANETDUEO.
  8636
  8637     IF PI-END-BAL  NEGATIVE
  8638         MOVE OWED-TO-AGENT      TO  AENDHDGO
  8639     ELSE
  8640         IF PI-END-BAL  GREATER THAN  ZERO
  8641             MOVE AGENT-OWES     TO  AENDHDGO
  8642         ELSE
  8643             MOVE 'BALANCE='     TO  AENDHDGO.
  8644
  8645     IF PI-SAV-AGENT = PI-SAV-REMIT-TO
  8646         IF PI-DUE-FOR-ACCT  NOT =  ZERO
  8647             MOVE PI-DUE-FOR-ACCT
  8648                                 TO  AACTDUEO
  8649             IF PI-DUE-FOR-ACCT  NEGATIVE
  8650                 MOVE 'DUE GA ON BEHALF OF ACCOUNTS'
  8651                                 TO  AACTHDGO
  8652             ELSE
  8653                 MOVE 'GA OWES ON BEHALF OF ACCOUNTS'
  8654                                 TO  AACTHDGO.
  8655
  8656 5080-CONT.
  8657     IF RETURNED-FROM  NOT =  SPACES
  8658         IF RETURNED-FROM  NOT =  XCTL-6401
  8659             MOVE ER-2421        TO  EMI-ERROR
  8660             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8661             MOVE ZEROS          TO  EMI-ERROR.
  8662
  8663 5090-EXIT.
  8664     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 177
* EL642.cbl
  8666 6000-READ-COMP-MASTER.
  8667
  8668* EXEC CICS HANDLE CONDITION
  8669*        NOTFND  (6070-NO-COMP-MSTR)
  8670*    END-EXEC.
  8671*    MOVE '"$I                   ! , #00008290' TO DFHEIV0
  8672     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8673     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8674     MOVE X'2C20233030303038323930' TO DFHEIV0(25:11)
  8675     CALL 'kxdfhei1' USING DFHEIV0
  8676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8677
  8678
  8679     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
  8680
  8681     IF GENERAL-AGENT
  8682         MOVE PI-SAV-CARR        TO  ERCOMP-CARRIER
  8683         MOVE PI-SAV-GROUP       TO  ERCOMP-GROUPING
  8684         MOVE PI-SAV-AGENT       TO  ERCOMP-FIN-RESP
  8685     ELSE
  8686         MOVE PI-COMP-CARRIER    TO  ERCOMP-CARRIER
  8687         MOVE PI-COMP-GROUPING   TO  ERCOMP-GROUPING
  8688         MOVE PI-COMP-FIN-RESP   TO  ERCOMP-FIN-RESP.
  8689
  8690     MOVE ERCOMP-FIN-RESP        TO  PI-CR-FIN-RESP.
  8691
  8692     IF EIBAID  =  DFHPF5  OR  GENERAL-AGENT
  8693         MOVE LOW-VALUES         TO  ERCOMP-ACCT
  8694         MOVE 'G'                TO  ERCOMP-RECORD-TYPE
  8695     ELSE
  8696         MOVE PI-SAV-ACCT-AGT    TO  ERCOMP-ACCT
  8697         MOVE 'A'                TO  ERCOMP-RECORD-TYPE.
  8698
  8699     IF ERCOMP-KEY  =  ERCOMP-PREV-KEY
  8700         GO TO 6090-EXIT.
  8701
  8702     MOVE ERCOMP-KEY             TO  ERCOMP-PREV-KEY.
  8703
  8704
  8705* EXEC CICS READ
  8706*        DATASET  (ERCOMP-FILE-ID)
  8707*        SET      (ADDRESS OF COMPENSATION-MASTER)
  8708*        RIDFLD   (ERCOMP-KEY)
  8709*        RESP     (WS-RESPONSE)
  8710*    END-EXEC.
  8711*    MOVE '&"S        E          (  N#00008319' TO DFHEIV0
  8712     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8713     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8714     MOVE X'204E233030303038333139' TO DFHEIV0(25:11)
  8715     CALL 'kxdfhei1' USING DFHEIV0,
  8716           ERCOMP-FILE-ID,
  8717           DFHEIV20,
  8718           DFHEIV99,
  8719           ERCOMP-KEY,
  8720           DFHEIV99,
  8721           DFHEIV99,
  8722           DFHEIV99
  8723     SET ADDRESS OF COMPENSATION-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 178
* EL642.cbl
  8724         DFHEIV20
  8725     MOVE EIBRESP  TO WS-RESPONSE
  8726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8727
  8728
  8729     IF NOT RESP-NORMAL
  8730        IF ERCOMP-RECORD-TYPE = 'G'
  8731           MOVE 'B'              TO ERCOMP-RECORD-TYPE
  8732
  8733* EXEC CICS READ
  8734*             DATASET (ERCOMP-FILE-ID)
  8735*             SET     (ADDRESS OF COMPENSATION-MASTER)
  8736*             RIDFLD  (ERCOMP-KEY)
  8737*          END-EXEC
  8738*    MOVE '&"S        E          (   #00008329' TO DFHEIV0
  8739     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8740     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8741     MOVE X'2020233030303038333239' TO DFHEIV0(25:11)
  8742     CALL 'kxdfhei1' USING DFHEIV0,
  8743           ERCOMP-FILE-ID,
  8744           DFHEIV20,
  8745           DFHEIV99,
  8746           ERCOMP-KEY,
  8747           DFHEIV99,
  8748           DFHEIV99,
  8749           DFHEIV99
  8750     SET ADDRESS OF COMPENSATION-MASTER TO
  8751         DFHEIV20
  8752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8753        END-IF
  8754     END-IF
  8755
  8756     IF PI-MAP-NAME  =  EL642B
  8757         GO TO 6090-EXIT.
  8758
  8759     IF GENERAL-AGENT
  8760         MOVE CO-CURRENT-END-BAL TO  PI-BAL-FRWD
  8761     ELSE
  8762         IF PI-SAV-AGENT  =  PI-SAV-REMIT-TO
  8763             MOVE CO-CURRENT-END-BAL
  8764                                 TO  WS-ACCT-BEG-BAL
  8765             GO TO 6090-EXIT
  8766         ELSE
  8767             MOVE ZEROS          TO  WS-ACCT-BEG-BAL
  8768             GO TO 6090-EXIT.
  8769
  8770     IF PI-UPDATE-FILES
  8771       OR  (PI-PREVIEW  AND  APRODSWI  =  'Y')
  8772         NEXT SENTENCE
  8773     ELSE
  8774         GO TO 6090-EXIT.
  8775
  8776 6002-FORMAT-ADDRESS-LOOP.
  8777     MOVE CO-ACCT-NAME           TO  PI-AGENT-NAME.
  8778     MOVE CO-MAIL-NAME           TO  WS-AGENT-LINES (1).
  8779     MOVE CO-ACCT-NAME           TO  WS-AGENT-LINES (2).
  8780     MOVE CO-ADDR-1              TO  WS-AGENT-LINES (3).
  8781     MOVE CO-ADDR-2              TO  WS-AGENT-LINES (4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 179
* EL642.cbl
  8782     MOVE CO-ADDR-3              TO  WS-AGENT-LINES (5).
  8783     MOVE CO-ZIP                 TO  WS-AGENT-LINES (6).
  8784
  8785 6060-FORMAT-ADDRESS-LOOP.
  8786     IF WS-AGENT-ADDR-AREA  =  SPACES
  8787         GO TO 6090-EXIT.
  8788
  8789     IF WS-AGENT-LINES (1)  =  SPACES
  8790         MOVE WS-AGENT-LINES (2)  TO  WS-AGENT-LINES (1)
  8791         MOVE WS-AGENT-LINES (3)  TO  WS-AGENT-LINES (2)
  8792         MOVE WS-AGENT-LINES (4)  TO  WS-AGENT-LINES (3)
  8793         MOVE WS-AGENT-LINES (5)  TO  WS-AGENT-LINES (4)
  8794         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8795         MOVE SPACES              TO  WS-AGENT-LINES (6)
  8796         GO TO 6060-FORMAT-ADDRESS-LOOP.
  8797
  8798     IF WS-AGENT-LINES (2)  =  SPACES
  8799       AND  WS-AGENT-LINES (3)  =  SPACES
  8800       AND  WS-AGENT-LINES (4)  =  SPACES
  8801       AND  WS-AGENT-LINES (5)  =  SPACES
  8802       AND  WS-AGENT-LINES (6)  =  SPACES
  8803         GO TO 6065-MOVE-ZIP.
  8804
  8805     IF WS-AGENT-LINES (2)  =  SPACES
  8806         MOVE WS-AGENT-LINES (3)  TO  WS-AGENT-LINES (2)
  8807         MOVE WS-AGENT-LINES (4)  TO  WS-AGENT-LINES (3)
  8808         MOVE WS-AGENT-LINES (5)  TO  WS-AGENT-LINES (4)
  8809         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8810         MOVE SPACES              TO  WS-AGENT-LINES (6)
  8811         GO TO 6060-FORMAT-ADDRESS-LOOP.
  8812
  8813     IF WS-AGENT-LINES (3)  =  SPACES
  8814       AND  WS-AGENT-LINES (4)  =  SPACES
  8815       AND  WS-AGENT-LINES (5)  =  SPACES
  8816       AND  WS-AGENT-LINES (6)  =  SPACES
  8817         GO TO 6065-MOVE-ZIP.
  8818
  8819     IF WS-AGENT-LINES (3)  =  SPACES
  8820         MOVE WS-AGENT-LINES (4)  TO  WS-AGENT-LINES (3)
  8821         MOVE WS-AGENT-LINES (5)  TO  WS-AGENT-LINES (4)
  8822         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8823         MOVE SPACES              TO  WS-AGENT-LINES (6)
  8824         GO TO 6060-FORMAT-ADDRESS-LOOP.
  8825
  8826     IF WS-AGENT-LINES (4)  =  SPACES
  8827       AND  WS-AGENT-LINES (5)  =  SPACES
  8828       AND  WS-AGENT-LINES (6)  =  SPACES
  8829         GO TO 6065-MOVE-ZIP.
  8830
  8831     IF WS-AGENT-LINES (4)  =  SPACES
  8832         MOVE WS-AGENT-LINES (5)  TO  WS-AGENT-LINES (4)
  8833         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8834         MOVE SPACES              TO  WS-AGENT-LINES (6)
  8835         GO TO 6060-FORMAT-ADDRESS-LOOP.
  8836
  8837     IF WS-AGENT-LINES (5)  =  SPACES
  8838         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8839         MOVE SPACES              TO  WS-AGENT-LINES (6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 180
* EL642.cbl
  8840
  8841 6065-MOVE-ZIP.
  8842
  8843     IF WS-AGENT-LINES (6) NOT =  SPACES
  8844         IF CO-CANADIAN-POST-CODE
  8845                 OR
  8846            WS-AGENT-1ST-ZIP (6)  NOT =  ZEROS
  8847             MOVE WS-AGENT-ZIP (6)
  8848                                 TO  WS-A-LAST-ZIP (5)
  8849             MOVE SPACES         TO  WS-AGENT-LINES (6)
  8850         ELSE
  8851             MOVE WS-AGENT-2ND-ZIP (5)
  8852                                 TO  WS-A-LAST-2ND-ZIP (4)
  8853             MOVE SPACES         TO  WS-AGENT-LINES (5)
  8854     ELSE
  8855         IF WS-AGENT-LINES (5) NOT =  SPACES
  8856             IF CO-CANADIAN-POST-CODE
  8857                     OR
  8858                WS-AGENT-1ST-ZIP (5)  NOT =  ZEROS
  8859                 MOVE WS-AGENT-ZIP (5)
  8860                                 TO  WS-A-LAST-ZIP (5)
  8861                 MOVE SPACES     TO  WS-AGENT-ZIP (5)
  8862             ELSE
  8863                 MOVE WS-AGENT-2ND-ZIP (5)
  8864                                 TO  WS-A-LAST-2ND-ZIP (5)
  8865                 MOVE SPACES     TO  WS-AGENT-ZIP (5)
  8866         ELSE
  8867             IF WS-AGENT-LINES (4) NOT =  SPACES
  8868                 IF CO-CANADIAN-POST-CODE
  8869                         OR
  8870                    WS-AGENT-1ST-ZIP (4)  NOT =  ZEROS
  8871                     MOVE WS-AGENT-ZIP (4)
  8872                                 TO  WS-A-LAST-ZIP (4)
  8873                     MOVE SPACES TO  WS-AGENT-ZIP (4)
  8874                 ELSE
  8875                     MOVE WS-AGENT-2ND-ZIP (4)
  8876                                 TO  WS-A-LAST-2ND-ZIP (4)
  8877                     MOVE SPACES TO  WS-AGENT-ZIP (4).
  8878
  8879     MOVE 'GA'                   TO  BILLING-DETAIL-TYPE.
  8880
  8881     PERFORM 3000-WRITE-BILLING-DETAIL  THRU  3990-EXIT.
  8882
  8883     GO TO 6090-EXIT.
  8884
  8885 6070-NO-COMP-MSTR.
  8886     IF GENERAL-AGENT
  8887         MOVE -1                 TO  AAGENTL
  8888         MOVE ER-2230            TO  EMI-ERROR
  8889         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8890         GO TO 8200-SEND-DATAONLY.
  8891
  8892     MOVE ZEROS                  TO  WS-ACCT-BEG-BAL.
  8893
  8894     GO TO 6090-EXIT.
  8895
  8896 6090-EXIT.
  8897     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 181
* EL642.cbl
  8899 6100-READ-CONTROL-FILE.
  8900     MOVE PI-COMPANY-ID          TO  ELCNTL-COMPANY-ID.
  8901     MOVE +0                     TO  ELCNTL-SEQ-NO.
  8902
  8903
  8904* EXEC CICS HANDLE CONDITION
  8905*        NOTFND  (6110-NO-RECORD)
  8906*    END-EXEC.
  8907*    MOVE '"$I                   ! - #00008484' TO DFHEIV0
  8908     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8909     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8910     MOVE X'2D20233030303038343834' TO DFHEIV0(25:11)
  8911     CALL 'kxdfhei1' USING DFHEIV0
  8912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8913
  8914
  8915     IF NOT  ELCNTL-UPDATE
  8916
  8917* EXEC CICS READ
  8918*            DATASET  (ELCNTL-FILE-ID)
  8919*            SET      (ADDRESS OF CONTROL-FILE)
  8920*            RIDFLD   (ELCNTL-KEY)
  8921*        END-EXEC
  8922*    MOVE '&"S        E          (   #00008489' TO DFHEIV0
  8923     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8924     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8925     MOVE X'2020233030303038343839' TO DFHEIV0(25:11)
  8926     CALL 'kxdfhei1' USING DFHEIV0,
  8927           ELCNTL-FILE-ID,
  8928           DFHEIV20,
  8929           DFHEIV99,
  8930           ELCNTL-KEY,
  8931           DFHEIV99,
  8932           DFHEIV99,
  8933           DFHEIV99
  8934     SET ADDRESS OF CONTROL-FILE TO
  8935         DFHEIV20
  8936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8937     ELSE
  8938         MOVE SPACE              TO  ELCNTL-UPDATE-SW
  8939
  8940* EXEC CICS READ
  8941*            DATASET  (ELCNTL-FILE-ID)
  8942*            SET      (ADDRESS OF CONTROL-FILE)
  8943*            RIDFLD   (ELCNTL-KEY)
  8944*            UPDATE
  8945*        END-EXEC.
  8946*    MOVE '&"S        EU         (   #00008496' TO DFHEIV0
  8947     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8948     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8949     MOVE X'2020233030303038343936' TO DFHEIV0(25:11)
  8950     CALL 'kxdfhei1' USING DFHEIV0,
  8951           ELCNTL-FILE-ID,
  8952           DFHEIV20,
  8953           DFHEIV99,
  8954           ELCNTL-KEY,
  8955           DFHEIV99,
  8956           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 182
* EL642.cbl
  8957           DFHEIV99
  8958     SET ADDRESS OF CONTROL-FILE TO
  8959         DFHEIV20
  8960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8961
  8962
  8963     GO TO 6120-EXIT.
  8964
  8965 6110-NO-RECORD.
  8966     IF ELCNTL-REC-TYPE  =  1
  8967         MOVE ER-0022            TO  EMI-ERROR
  8968     ELSE
  8969         MOVE ER-2208            TO  EMI-ERROR
  8970         MOVE -1                 TO  ACARIERL
  8971         MOVE AL-UABON           TO  ACARIERA
  8972
  8973     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8974
  8975 6120-EXIT.
  8976     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 183
* EL642.cbl
  8978 6130-FIND-BENEFIT-CD.
  8979
  8980* EXEC CICS READ
  8981*       DATASET (ELCNTL-FILE-ID)
  8982*       SET     (ADDRESS OF CONTROL-FILE)
  8983*       RIDFLD  (ELCNTL-KEY)
  8984*       GTEQ
  8985*       RESP    (WS-RESPONSE)
  8986*    END-EXEC
  8987*    MOVE '&"S        G          (  N#00008519' TO DFHEIV0
  8988     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8989     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8990     MOVE X'204E233030303038353139' TO DFHEIV0(25:11)
  8991     CALL 'kxdfhei1' USING DFHEIV0,
  8992           ELCNTL-FILE-ID,
  8993           DFHEIV20,
  8994           DFHEIV99,
  8995           ELCNTL-KEY,
  8996           DFHEIV99,
  8997           DFHEIV99,
  8998           DFHEIV99
  8999     SET ADDRESS OF CONTROL-FILE TO
  9000         DFHEIV20
  9001     MOVE EIBRESP  TO WS-RESPONSE
  9002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9003     IF RESP-NORMAL
  9004        IF (CF-COMPANY-ID = PI-COMPANY-ID)
  9005           AND (CF-RECORD-TYPE = '5')
  9006           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  9007              (S1 > +8)
  9008              OR (CF-BENEFIT-CODE (S1) = CLAS-LOOK)
  9009           END-PERFORM
  9010           IF S1 NOT > +8
  9011              MOVE CF-BENEFIT-CATEGORY (S1)
  9012                                 TO WS-AH-CATEGORY
  9013              GO TO 6140-EXIT
  9014           END-IF
  9015        END-IF
  9016     END-IF
  9017     .
  9018 6140-NO-RECORD.
  9019     MOVE ER-0028                TO EMI-ERROR
  9020     MOVE -1                     TO ACARIERL
  9021     MOVE AL-UABON               TO ACARIERA
  9022     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  9023     .
  9024 6140-EXIT.
  9025     EXIT.
  9026 6200-REWRITE-CONTROL-FILE.
  9027     MOVE 'C'                    TO  JP-RECORD-TYPE.
  9028     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  9029     MOVE ELCNTL-FILE-ID         TO  JP-FILE-ID.
  9030
  9031     COMPUTE JOURNAL-LENGTH = ELCNTL-LENGTH + 23.
  9032
  9033
  9034* EXEC CICS REWRITE
  9035*        DATASET  (ELCNTL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 184
* EL642.cbl
  9036*        FROM     (CONTROL-FILE)
  9037*    END-EXEC.
  9038     MOVE LENGTH OF
  9039      CONTROL-FILE
  9040       TO DFHEIV11
  9041*    MOVE '&& L                  %   #00008556' TO DFHEIV0
  9042     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9043     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9044     MOVE X'2020233030303038353536' TO DFHEIV0(25:11)
  9045     CALL 'kxdfhei1' USING DFHEIV0,
  9046           ELCNTL-FILE-ID,
  9047           CONTROL-FILE,
  9048           DFHEIV11,
  9049           DFHEIV99
  9050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9051
  9052
  9053     PERFORM 8400-LOG-JOURNAL-RECORD.
  9054
  9055 6290-EXIT.
  9056     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 185
* EL642.cbl
  9058 6400-READ-CROSS-REFERENCE.
  9059     MOVE PI-COMPANY-CD          TO  ERGXRF-COMPANY-CD.
  9060     MOVE PI-SAV-AGENT           TO  ERGXRF-AGENT-NO.
  9061
  9062     IF NOT  PI-ZERO-CARRIER
  9063       AND  NOT  PI-ZERO-CAR-GROUP
  9064         MOVE PI-CR-CARRIER      TO  ERGXRF-CARRIER
  9065     ELSE
  9066         MOVE ZEROS              TO  ERGXRF-CARRIER.
  9067
  9068     IF NOT  PI-ZERO-GROUPING
  9069       AND  NOT  PI-ZERO-CAR-GROUP
  9070         MOVE PI-CR-GROUPING     TO  ERGXRF-GROUPING
  9071     ELSE
  9072         MOVE ZEROS              TO  ERGXRF-GROUPING.
  9073
  9074
  9075* EXEC CICS HANDLE CONDITION
  9076*        NOTFND  (6410-NOT-FOUND)
  9077*    END-EXEC.
  9078*    MOVE '"$I                   ! . #00008582' TO DFHEIV0
  9079     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9080     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9081     MOVE X'2E20233030303038353832' TO DFHEIV0(25:11)
  9082     CALL 'kxdfhei1' USING DFHEIV0
  9083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9084
  9085
  9086
  9087* EXEC CICS READ
  9088*        SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  9089*        DATASET  (ERGXRF-FILE-ID)
  9090*        RIDFLD   (ERGXRF-KEY)
  9091*        LENGTH   (ERGXRF-LENGTH)
  9092*        UPDATE
  9093*    END-EXEC.
  9094*    MOVE '&"SL       EU         (   #00008586' TO DFHEIV0
  9095     MOVE X'2622534C2020202020202045' TO DFHEIV0(1:12)
  9096     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9097     MOVE X'2020233030303038353836' TO DFHEIV0(25:11)
  9098     CALL 'kxdfhei1' USING DFHEIV0,
  9099           ERGXRF-FILE-ID,
  9100           DFHEIV20,
  9101           ERGXRF-LENGTH,
  9102           ERGXRF-KEY,
  9103           DFHEIV99,
  9104           DFHEIV99,
  9105           DFHEIV99
  9106     SET ADDRESS OF AGENT-CROSS-REFERENCE TO
  9107         DFHEIV20
  9108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9109
  9110
  9111     MOVE GX-AGENT-POINTER-CNT   TO  GX-AGENT-POINTER-CNT.
  9112
  9113     IF PI-UPDATE-FILES
  9114         MOVE 'B'                TO  JP-RECORD-TYPE
  9115         MOVE AGENT-CROSS-REFERENCE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 186
* EL642.cbl
  9116                                 TO  JP-RECORD-AREA
  9117         MOVE ERGXRF-FILE-ID     TO  JP-FILE-ID
  9118         COMPUTE JOURNAL-LENGTH = ERGXRF-LENGTH + 23
  9119         PERFORM 8400-LOG-JOURNAL-RECORD.
  9120
  9121     GO TO 6490-EXIT.
  9122
  9123 6410-NOT-FOUND.
  9124     MOVE -1                     TO  AAGENTL.
  9125     MOVE ER-2911                TO  EMI-ERROR.
  9126
  9127     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9128
  9129     GO TO 8200-SEND-DATAONLY.
  9130
  9131 6490-EXIT.
  9132     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 187
* EL642.cbl
  9134 6500-REWRITE-CROSS-REFERENCE.
  9135     MOVE 'C'                    TO  JP-RECORD-TYPE.
  9136     MOVE AGENT-CROSS-REFERENCE  TO  JP-RECORD-AREA.
  9137     MOVE ERGXRF-FILE-ID         TO  JP-FILE-ID.
  9138
  9139
  9140* EXEC CICS REWRITE
  9141*        DATASET  (ERGXRF-FILE-ID)
  9142*        FROM     (AGENT-CROSS-REFERENCE)
  9143*        LENGTH   (ERGXRF-LENGTH)
  9144*    END-EXEC.
  9145*    MOVE '&& L                  %   #00008622' TO DFHEIV0
  9146     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9147     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9148     MOVE X'2020233030303038363232' TO DFHEIV0(25:11)
  9149     CALL 'kxdfhei1' USING DFHEIV0,
  9150           ERGXRF-FILE-ID,
  9151           AGENT-CROSS-REFERENCE,
  9152           ERGXRF-LENGTH,
  9153           DFHEIV99
  9154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9155
  9156
  9157     PERFORM 8400-LOG-JOURNAL-RECORD.
  9158
  9159 6590-EXIT.
  9160     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 188
* EL642.cbl
  9162 6600-READ-COMMISSION-EXCEPTION.
  9163
  9164* EXEC CICS HANDLE CONDITION
  9165*        NOTFND  (6610-NOT-FOUND)
  9166*    END-EXEC.
  9167*    MOVE '"$I                   ! / #00008634' TO DFHEIV0
  9168     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9169     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9170     MOVE X'2F20233030303038363334' TO DFHEIV0(25:11)
  9171     CALL 'kxdfhei1' USING DFHEIV0
  9172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9173
  9174
  9175     MOVE 'Y'                    TO ERCOMM-FOUND-SW.
  9176     MOVE PB-CONTROL-BY-ACCOUNT  TO  ERCOMM-KEY.
  9177     MOVE PB-SV-CARRIER          TO  ERCOMM-CARRIER.
  9178     MOVE PB-SV-GROUPING         TO  ERCOMM-GROUPING.
  9179     MOVE PB-SV-STATE            TO  ERCOMM-STATE.
  9180
  9181
  9182* EXEC CICS READ
  9183*        SET      (ADDRESS OF COMMISSION-EXCEPTIONS)
  9184*        DATASET  (ERCOMM-FILE-ID)
  9185*        RIDFLD   (ERCOMM-KEY)
  9186*    END-EXEC.
  9187*    MOVE '&"S        E          (   #00008644' TO DFHEIV0
  9188     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9189     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9190     MOVE X'2020233030303038363434' TO DFHEIV0(25:11)
  9191     CALL 'kxdfhei1' USING DFHEIV0,
  9192           ERCOMM-FILE-ID,
  9193           DFHEIV20,
  9194           DFHEIV99,
  9195           ERCOMM-KEY,
  9196           DFHEIV99,
  9197           DFHEIV99,
  9198           DFHEIV99
  9199     SET ADDRESS OF COMMISSION-EXCEPTIONS TO
  9200         DFHEIV20
  9201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9202
  9203
  9204     GO TO 6620-EXIT.
  9205
  9206 6610-NOT-FOUND.
  9207     MOVE 'N'                    TO  ERCOMM-FOUND-SW.
  9208
  9209 6620-EXIT.
  9210     EXIT.
  9211
  9212**START***********************************************************
  9213*      CUSTOM CODING FOR CLIENT "DMD"
  9214******************************************************************
  9215*
  9216 6650-GET-RES-STATE-COMM.
  9217*6650-BROWSE-FORWARD.
  9218
  9219     IF PB-COMPANY-ID NOT = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 189
* EL642.cbl
  9220         GO TO 6700-COMM-EXIT.
  9221
  9222     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
  9223     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
  9224     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
  9225     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
  9226     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
  9227     MOVE AM-AGT (WS-GA-LEVEL) TO WS-ERRESC-AGENT.
  9228     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
  9229
  9230*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
  9231*
  9232     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
  9233     SET BIN-TO-GREG          TO TRUE.
  9234     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9235
  9236     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
  9237
  9238     IF DC-GREG-DATE-1-YMD (1:2) IS LESS THAN '10'
  9239         MOVE '20'            TO WS-CONTRACT-DATE (1:2)
  9240     ELSE
  9241         MOVE '19'            TO WS-CONTRACT-DATE (1:2).
  9242
  9243     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
  9244
  9245
  9246* EXEC CICS HANDLE CONDITION
  9247*        INVREQ    (6660-START-BROWSE)
  9248*        NOTFND    (6700-COMM-EXIT)
  9249*    END-EXEC.
  9250*    MOVE '"$8I                  ! 0 #00008691' TO DFHEIV0
  9251     MOVE X'222438492020202020202020' TO DFHEIV0(1:12)
  9252     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9253     MOVE X'3020233030303038363931' TO DFHEIV0(25:11)
  9254     CALL 'kxdfhei1' USING DFHEIV0
  9255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9256
  9257
  9258
  9259* EXEC CICS RESETBR
  9260*        DATASET (ERRESC-FILE-ID)
  9261*        RIDFLD  (WS-ERRESC-KEY)
  9262*    END-EXEC.
  9263     MOVE 0
  9264       TO DFHEIV11
  9265*    MOVE '&4         G          &   #00008696' TO DFHEIV0
  9266     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
  9267     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9268     MOVE X'2020233030303038363936' TO DFHEIV0(25:11)
  9269     CALL 'kxdfhei1' USING DFHEIV0,
  9270           ERRESC-FILE-ID,
  9271           WS-ERRESC-KEY,
  9272           DFHEIV99,
  9273           DFHEIV11,
  9274           DFHEIV99
  9275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9276
  9277
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 190
* EL642.cbl
  9278 6660-START-BROWSE.
  9279
  9280
  9281* EXEC CICS HANDLE CONDITION
  9282*        NOTFND    (6700-COMM-EXIT)
  9283*        ENDFILE   (6700-COMM-EXIT)
  9284*    END-EXEC.
  9285*    MOVE '"$I''                  ! 1 #00008703' TO DFHEIV0
  9286     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9287     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9288     MOVE X'3120233030303038373033' TO DFHEIV0(25:11)
  9289     CALL 'kxdfhei1' USING DFHEIV0
  9290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9291
  9292
  9293
  9294* EXEC CICS STARTBR
  9295*        DATASET (ERRESC-FILE-ID)
  9296*        RIDFLD  (WS-ERRESC-KEY)
  9297*        GTEQ
  9298*    END-EXEC.
  9299     MOVE 0
  9300       TO DFHEIV11
  9301*    MOVE '&,         G          &   #00008708' TO DFHEIV0
  9302     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9303     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9304     MOVE X'2020233030303038373038' TO DFHEIV0(25:11)
  9305     CALL 'kxdfhei1' USING DFHEIV0,
  9306           ERRESC-FILE-ID,
  9307           WS-ERRESC-KEY,
  9308           DFHEIV99,
  9309           DFHEIV11,
  9310           DFHEIV99
  9311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9312
  9313
  9314     MOVE WS-ERRESC-KEY           TO WS-SV-ERRESC-KEY.
  9315
  9316 6670-READ-NEXT-ERRESC-MASTER.
  9317
  9318
  9319* EXEC CICS HANDLE CONDITION
  9320*        NOTFND    (6700-COMM-EXIT)
  9321*        ENDFILE   (6700-COMM-EXIT)
  9322*    END-EXEC.
  9323*    MOVE '"$I''                  ! 2 #00008718' TO DFHEIV0
  9324     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9325     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9326     MOVE X'3220233030303038373138' TO DFHEIV0(25:11)
  9327     CALL 'kxdfhei1' USING DFHEIV0
  9328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9329
  9330
  9331
  9332* EXEC CICS READNEXT
  9333*        SET      (ADDRESS OF ACCOUNT-RESIDENT-ST-COMMISSION)
  9334*        DATASET (ERRESC-FILE-ID)
  9335*        RIDFLD  (WS-ERRESC-KEY)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 191
* EL642.cbl
  9336*    END-EXEC.
  9337     MOVE 0
  9338       TO DFHEIV11
  9339*    MOVE '&.S                   )   #00008723' TO DFHEIV0
  9340     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9341     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9342     MOVE X'2020233030303038373233' TO DFHEIV0(25:11)
  9343     CALL 'kxdfhei1' USING DFHEIV0,
  9344           ERRESC-FILE-ID,
  9345           DFHEIV20,
  9346           DFHEIV99,
  9347           WS-ERRESC-KEY,
  9348           DFHEIV99,
  9349           DFHEIV11,
  9350           DFHEIV99,
  9351           DFHEIV99
  9352     SET ADDRESS OF ACCOUNT-RESIDENT-ST-COMMISSION TO
  9353         DFHEIV20
  9354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9355
  9356
  9357     IF ERRESC-RECORD-KEY (1:32) = WS-SV-ERRESC-KEY
  9358        NEXT SENTENCE
  9359     ELSE
  9360
  9361* EXEC CICS ENDBR
  9362*            DATASET (ERRESC-FILE-ID)
  9363*       END-EXEC
  9364     MOVE 0
  9365       TO DFHEIV11
  9366*    MOVE '&2                    $   #00008732' TO DFHEIV0
  9367     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9368     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9369     MOVE X'2020233030303038373332' TO DFHEIV0(25:11)
  9370     CALL 'kxdfhei1' USING DFHEIV0,
  9371           ERRESC-FILE-ID,
  9372           DFHEIV11,
  9373           DFHEIV99
  9374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9375        GO TO 6700-COMM-EXIT.
  9376
  9377* CHECK IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT RESIDENT
  9378* STATE COMMISSIONS RECORD'S EFFECT TIME PERIOD????
  9379     IF WS-CONTRACT-DATE IS LESS THAN RESC-EFFECTIVE-DATE
  9380
  9381* EXEC CICS ENDBR
  9382*            DATASET (ERRESC-FILE-ID)
  9383*       END-EXEC
  9384     MOVE 0
  9385       TO DFHEIV11
  9386*    MOVE '&2                    $   #00008740' TO DFHEIV0
  9387     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9388     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9389     MOVE X'2020233030303038373430' TO DFHEIV0(25:11)
  9390     CALL 'kxdfhei1' USING DFHEIV0,
  9391           ERRESC-FILE-ID,
  9392           DFHEIV11,
  9393           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 192
* EL642.cbl
  9394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9395        GO TO 6700-COMM-EXIT.
  9396
  9397* SEARCH FOR MATCHING CATEGORY CODE ENTRY
  9398*
  9399*    IF RESC-COMMISSION IS NUMERIC THAT IS THE COMMISSION TO OVER-
  9400*    RIDE AH OR LIFE COMMISSION IN IN THE ACCOUNT MASTER.
  9401*    IF RESC-COMMISSION NOT NUMERIC, USE VALUE TO GET COMMISSION
  9402*    FROM COMMISSION TABLE IF RECORD EXISTS.
  9403*
  9404     MOVE ZEROS               TO WS-SUB WS-SUB1.
  9405
  9406     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
  9407
  9408     IF WS-SUB1 IS GREATER THAN ZERO
  9409         IF RESC-COMMISSION-TAB (WS-SUB) NUMERIC
  9410             PERFORM 6680-SET-COMMISSION
  9411         ELSE
  9412             PERFORM 6680-SET-TABLE-CODE.
  9413
  9414
  9415* EXEC CICS ENDBR
  9416*         DATASET (ERRESC-FILE-ID)
  9417*    END-EXEC.
  9418     MOVE 0
  9419       TO DFHEIV11
  9420*    MOVE '&2                    $   #00008762' TO DFHEIV0
  9421     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9422     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9423     MOVE X'2020233030303038373632' TO DFHEIV0(25:11)
  9424     CALL 'kxdfhei1' USING DFHEIV0,
  9425           ERRESC-FILE-ID,
  9426           DFHEIV11,
  9427           DFHEIV99
  9428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9429
  9430
  9431     GO TO 6700-COMM-EXIT.
  9432
  9433 6680-SET-TABLE-CODE.
  9434     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
  9435        MOVE ZEROS             TO WS-SUB1
  9436     ELSE
  9437
  9438* READ COMMISSION TABLE(CTBL)  KEY VALUES PRESET IN CALLING
  9439* PARAGRAPHS(4405-FIND-AH, 4420-CONT-FIND-LIFE, 4430-SINGLE-LIFE)
  9440
  9441     MOVE RESC-COMMISSION-TAB (WS-SUB) TO ERCTBL-TABLE
  9442     PERFORM 6680-READ-CTBL-TABLE.
  9443
  9444 6680-READ-CTBL-TABLE.
  9445*
  9446* READ COMMISSION TABLE TO VERIFY IF ACCOUNT RESIDENT STATE
  9447* COMMISSION RECORD CONTAINS A VALID COMPENSATION TABLE CODE.
  9448* IF CODE IS NOT VALID USE CODE IN ACCOUNT MASTER
  9449
  9450     PERFORM 6700-READ-COMMISSION-TABLE THRU 6790-EXIT.
  9451
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 193
* EL642.cbl
  9452     IF ERCTBL-NOT-FOUND
  9453         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  9454         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  9455         IF ERCTBL-NOT-FOUND
  9456             MOVE ZEROS          TO  WS-SUB1.
  9457
  9458     IF ERCTBL-FOUND
  9459        IF AH-COMM
  9460            PERFORM 6680-AH-GET-COMP-RATE
  9461        ELSE
  9462            PERFORM 6680-LF-GET-COMP-RATE.
  9463
  9464 6680-AH-GET-COMP-RATE.
  9465     IF PB-ISSUE
  9466         COMPUTE WS-COMM-CK-AMT =
  9467             PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  9468         MOVE PB-I-AGE           TO  WS-COMM-AGE
  9469         MOVE PB-I-AH-TERM       TO  WS-COMM-TERM
  9470     ELSE
  9471         COMPUTE WS-COMM-CK-AMT =
  9472             PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  9473         MOVE PB-CI-INSURED-AGE  TO  WS-COMM-AGE
  9474         MOVE PB-CI-AH-TERM      TO  WS-COMM-TERM.
  9475
  9476     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  9477
  9478     MOVE WS-WK-RATE             TO  WS-GA-AH-COM.
  9479
  9480 6680-LF-GET-COMP-RATE.
  9481     IF PB-ISSUE
  9482         MOVE PB-I-LF-BENEFIT-AMT
  9483                                 TO  WS-COMM-CK-AMT
  9484         MOVE PB-I-AGE           TO  WS-COMM-AGE
  9485         MOVE PB-I-LF-TERM       TO  WS-COMM-TERM
  9486     ELSE
  9487         MOVE PB-CI-INSURED-AGE  TO  WS-COMM-AGE
  9488         MOVE PB-CI-LF-TERM      TO  WS-COMM-TERM
  9489         MOVE PB-CI-LF-BENEFIT-AMT
  9490                                 TO  WS-COMM-CK-AMT.
  9491
  9492     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  9493
  9494     MOVE WS-WK-RATE             TO  WS-GA-LF-COM.
  9495
  9496 6680-SET-COMMISSION.
  9497     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
  9498           MOVE ZEROS          TO WS-SUB1
  9499       ELSE
  9500           MOVE RESC-COMMISSION-PER (WS-SUB)
  9501                              TO WS-COMMISSION
  9502           IF AH-COMM
  9503              MOVE WS-COMMISSION TO WS-GA-AH-COM
  9504           ELSE
  9505              MOVE WS-COMMISSION TO WS-GA-LF-COM.
  9506
  9507 6680-SEARCH-CATEGORY.
  9508     ADD +1 TO WS-SUB.
  9509     IF WS-SUB IS GREATER THAN +12
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 194
* EL642.cbl
  9510         GO TO 6680-EXIT.
  9511
  9512     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
  9513          MOVE WS-SUB         TO WS-SUB1
  9514          GO TO 6680-EXIT.
  9515
  9516     GO TO 6680-SEARCH-CATEGORY.
  9517
  9518 6680-EXIT.
  9519     EXIT.
  9520
  9521 6700-COMM-EXIT.
  9522     EXIT.
  9523**END*************************************************************
  9524*      CUSTOM CODING FOR CLIENT "DMD"
  9525******************************************************************
  9526*
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 195
* EL642.cbl
  9528 6700-READ-COMMISSION-TABLE.
  9529
  9530* EXEC CICS HANDLE CONDITION
  9531*        NOTFND  (6710-NOT-FOUND)
  9532*    END-EXEC.
  9533*    MOVE '"$I                   ! 3 #00008864' TO DFHEIV0
  9534     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9535     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9536     MOVE X'3320233030303038383634' TO DFHEIV0(25:11)
  9537     CALL 'kxdfhei1' USING DFHEIV0
  9538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9539
  9540
  9541     MOVE 'Y'                    TO  ERCTBL-FOUND-SW.
  9542
  9543
  9544* EXEC CICS READ
  9545*        SET      (ADDRESS OF COMM-TABLE-RECORD)
  9546*        DATASET  (ERCTBL-FILE-ID)
  9547*        RIDFLD   (ERCTBL-KEY)
  9548*    END-EXEC.
  9549*    MOVE '&"S        E          (   #00008870' TO DFHEIV0
  9550     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9551     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9552     MOVE X'2020233030303038383730' TO DFHEIV0(25:11)
  9553     CALL 'kxdfhei1' USING DFHEIV0,
  9554           ERCTBL-FILE-ID,
  9555           DFHEIV20,
  9556           DFHEIV99,
  9557           ERCTBL-KEY,
  9558           DFHEIV99,
  9559           DFHEIV99,
  9560           DFHEIV99
  9561     SET ADDRESS OF COMM-TABLE-RECORD TO
  9562         DFHEIV20
  9563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9564
  9565
  9566     GO TO 6790-EXIT.
  9567
  9568 6710-NOT-FOUND.
  9569     MOVE 'N'                    TO  ERCTBL-FOUND-SW.
  9570
  9571 6790-EXIT.
  9572     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 196
* EL642.cbl
  9574 6800-READ-BENEFIT-MASTER.
  9575
  9576* EXEC CICS HANDLE CONDITION
  9577*        NOTFND  (6880-NOT-FOUND)
  9578*    END-EXEC.
  9579*    MOVE '"$I                   ! 4 #00008885' TO DFHEIV0
  9580     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9581     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9582     MOVE X'3420233030303038383835' TO DFHEIV0(25:11)
  9583     CALL 'kxdfhei1' USING DFHEIV0
  9584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9585
  9586
  9587     MOVE 'Y'                    TO  BENEFIT-MASTER-FOUND-SW.
  9588     MOVE PB-COMPANY-ID          TO  CLBENF-COMPANY-ID.
  9589     MOVE '4'                    TO  CLBENF-REC-TYPE.
  9590     MOVE +0                     TO  CLBENF-SEQ-NO.
  9591
  9592
  9593* EXEC CICS READ
  9594*        SET      (ADDRESS OF CONTROL-FILE)
  9595*        DATASET  (ELCNTL-FILE-ID)
  9596*        RIDFLD   (ELCNTL-BENEFIT-KEY)
  9597*        GTEQ
  9598*    END-EXEC.
  9599*    MOVE '&"S        G          (   #00008894' TO DFHEIV0
  9600     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9601     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9602     MOVE X'2020233030303038383934' TO DFHEIV0(25:11)
  9603     CALL 'kxdfhei1' USING DFHEIV0,
  9604           ELCNTL-FILE-ID,
  9605           DFHEIV20,
  9606           DFHEIV99,
  9607           ELCNTL-BENEFIT-KEY,
  9608           DFHEIV99,
  9609           DFHEIV99,
  9610           DFHEIV99
  9611     SET ADDRESS OF CONTROL-FILE TO
  9612         DFHEIV20
  9613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9614
  9615
  9616     IF CLBENF-COMPANY-ID  NOT =  CF-COMPANY-ID
  9617         GO TO 6880-NOT-FOUND.
  9618
  9619     IF CLBENF-REC-TYPE  NOT =  CF-RECORD-TYPE
  9620         GO TO 6880-NOT-FOUND.
  9621
  9622     MOVE +0                     TO  BEN-SUB.
  9623
  9624 6810-FIND-BENEFIT.
  9625     ADD +1                      TO  BEN-SUB.
  9626
  9627     IF BEN-SUB  GREATER THAN  +8
  9628         GO TO 6880-NOT-FOUND.
  9629
  9630     IF CF-BENEFIT-CODE (BEN-SUB)  =  CLBENF-CD
  9631         MOVE CF-JOINT-INDICATOR (BEN-SUB)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 197
* EL642.cbl
  9632                                 TO  LIFE-INDICATOR
  9633         GO TO 6890-EXIT.
  9634
  9635     GO TO 6810-FIND-BENEFIT.
  9636
  9637 6880-NOT-FOUND.
  9638     MOVE 'N'                    TO  BENEFIT-MASTER-FOUND-SW.
  9639
  9640 6890-EXIT.
  9641     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 198
* EL642.cbl
  9643 7000-PROCESS-CHECK.
  9644     MOVE LOW-VALUES             TO  EL642BO.
  9645
  9646     MOVE 'G'                    TO  COMPENSATION-SW
  9647                                     PI-CR-TYPE.
  9648
  9649     PERFORM 6000-READ-COMP-MASTER  THRU  6090-EXIT.
  9650
  9651     IF EMI-ERROR = ZEROS
  9652         MOVE CO-MAIL-NAME       TO  BNAMEO
  9653         MOVE CO-ADDR-1          TO  BADDR1O
  9654         MOVE CO-ADDR-2          TO  BADDR2O
  9655*        MOVE CO-ADDR-3          TO  BCITYSTO
  9656         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  9657            DELIMITED BY '  ' INTO BCITYSTO
  9658         END-STRING
  9659         MOVE CO-ZIP             TO  BZIPO
  9660     ELSE
  9661         MOVE EL642A             TO  PI-MAP-NAME
  9662         MOVE -1                 TO  BPFNTERL
  9663         GO TO 8200-SEND-DATAONLY.
  9664
  9665     IF PI-COMP-UNPAID-PREM  GREATER THAN  ZERO
  9666         MOVE PI-COMP-UNPAID-PREM
  9667                                 TO BCHKAMTO
  9668     ELSE
  9669         MOVE ZEROS              TO  BCHKAMTO.
  9670
  9671     MOVE AL-UNNON               TO  BCHKAMTA.
  9672     MOVE WS-CURRENT-DATE-EDIT   TO  BPAYDT1O.
  9673     MOVE -1                     TO  BCHKNOL.
  9674
  9675     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 199
* EL642.cbl
  9677 7500-PRODUCE-CHECK.
  9678     MOVE SPACES                 TO  ELCNTL-KEY.
  9679     MOVE '1'                    TO  ELCNTL-REC-TYPE.
  9680     MOVE 'Y'                    TO  ELCNTL-UPDATE-SW.
  9681
  9682     PERFORM 6100-READ-CONTROL-FILE  THRU  6120-EXIT.
  9683
  9684     IF EMI-ERROR  NOT =  ZEROS
  9685         GO TO 8200-SEND-DATAONLY.
  9686
  9687     IF CR-CHECK-NO-AUTO-SEQ
  9688         MOVE 'B'                TO  JP-RECORD-TYPE
  9689         MOVE CONTROL-FILE       TO  JP-RECORD-AREA
  9690         MOVE ELCNTL-FILE-ID     TO  JP-FILE-ID
  9691         COMPUTE JOURNAL-LENGTH = ELCNTL-LENGTH + 23
  9692         PERFORM 8400-LOG-JOURNAL-RECORD
  9693         IF CR-CHECK-CNT-RESET-VALUE
  9694             MOVE CF-CR-CHECK-COUNTER
  9695                                 TO  BCHKNOI
  9696             MOVE +1             TO  CF-CR-CHECK-COUNTER
  9697             MOVE 6              TO  BCHKNOL
  9698         ELSE
  9699             MOVE CF-CR-CHECK-COUNTER
  9700                                 TO  BCHKNOI
  9701             MOVE 6              TO  BCHKNOL
  9702             ADD +1              TO  CF-CR-CHECK-COUNTER.
  9703
  9704     IF CR-CHECK-NO-MANUAL
  9705         IF BCHKNOL = ZEROS
  9706             MOVE ER-2438        TO  EMI-ERROR
  9707             MOVE -1             TO  BCHKNOL
  9708             MOVE AL-UNBON       TO  BCHKNOA
  9709             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9710             GO TO 8200-SEND-DATAONLY
  9711         ELSE
  9712             IF BCHKNOI NOT NUMERIC
  9713                 MOVE ER-2439    TO  EMI-ERROR
  9714                 MOVE -1         TO  BCHKNOL
  9715                 MOVE AL-UNBON   TO  BCHKNOA
  9716                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9717                 GO TO 8200-SEND-DATAONLY.
  9718
  9719
  9720* EXEC CICS GETMAIN
  9721*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  9722*        LENGTH   (ERPYAJ-LENGTH)
  9723*        INITIMG  (GETMAIN-SPACE)
  9724*    END-EXEC.
  9725*    MOVE ',"IL                  $   #00009004' TO DFHEIV0
  9726     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9727     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9728     MOVE X'2020233030303039303034' TO DFHEIV0(25:11)
  9729     CALL 'kxdfhei1' USING DFHEIV0,
  9730           DFHEIV20,
  9731           ERPYAJ-LENGTH,
  9732           GETMAIN-SPACE
  9733     SET ADDRESS OF PENDING-PAY-ADJ TO
  9734         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 200
* EL642.cbl
  9735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9736
  9737
  9738
  9739* EXEC CICS BIF DEEDIT
  9740*        FIELD   (BCHKAMTI)
  9741*        LENGTH  (09)
  9742*    END-EXEC.
  9743     MOVE 09
  9744       TO DFHEIV11
  9745*    MOVE '@"L                   #   #00009010' TO DFHEIV0
  9746     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9747     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9748     MOVE X'2020233030303039303130' TO DFHEIV0(25:11)
  9749     CALL 'kxdfhei1' USING DFHEIV0,
  9750           BCHKAMTI,
  9751           DFHEIV11
  9752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9753
  9754
  9755     IF BCHKAMTI NOT GREATER THAN ZEROS
  9756         MOVE ER-3165    TO  EMI-ERROR
  9757         MOVE -1         TO  BCHKAMTL
  9758         MOVE AL-UNBON   TO  BCHKAMTA
  9759         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9760         GO TO 8200-SEND-DATAONLY.
  9761
  9762     MOVE 'Y'                    TO  PI-CHECK-SW.
  9763     MOVE 'PY'                   TO  PY-RECORD-ID.
  9764     MOVE PI-COMPANY-CD          TO  PY-COMPANY-CD.
  9765     MOVE PI-SAV-CARR            TO  PY-CARRIER.
  9766     MOVE PI-SAV-GROUP           TO  PY-GROUPING.
  9767     MOVE PI-SAV-AGENT           TO  PY-FIN-RESP.
  9768     MOVE LOW-VALUES             TO  PY-ACCOUNT.
  9769     MOVE 'C'                    TO  PY-RECORD-TYPE.
  9770     MOVE EIBTIME                TO  PY-FILE-SEQ-NO.
  9771     MOVE WS-CURRENT-DATE-MDY    TO  WS-PY-CURRENT-DATE.
  9772     MOVE WS-PY-ENTRY-COMMENT    TO  PY-ENTRY-COMMENT.
  9773     MOVE BCHKAMTI               TO  PY-ENTRY-AMT.
  9774
  9775     ADD BCHKAMTI                TO  PI-DISBURSED.
  9776
  9777     IF NOT  CR-CHECK-NO-AT-PRINT
  9778         MOVE BCHKNOI            TO  PY-CHECK-NUMBER.
  9779
  9780     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  9781     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  9782     MOVE WS-CURRENT-DATE        TO  PY-LAST-MAINT-DT
  9783                                     PY-INPUT-DT.
  9784     MOVE LOW-VALUES             TO  PY-BILLED-DATE
  9785                                     PY-AR-DATE.
  9786     MOVE ZEROS                  TO  PY-CHECK-QUE-CONTROL
  9787                                     PY-CHECK-QUE-SEQUENCE.
  9788     MOVE LOW-VALUES             TO  PY-CREDIT-ACCEPT-DT
  9789                                     PY-REPORTED-DT
  9790                                     PY-CHECK-WRITTEN-DT.
  9791     MOVE PI-CR-MONTH-END-DT     TO  PY-CREDIT-SELECT-DT.
  9792     MOVE 'G'                    TO  PY-CHECK-ORIGIN-SW.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 201
* EL642.cbl
  9793     MOVE 'A'                    TO  JP-RECORD-TYPE.
  9794     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  9795     MOVE ERPYAJ-FILE-ID         TO  JP-FILE-ID.
  9796
  9797     COMPUTE JOURNAL-LENGTH = ERPYAJ-LENGTH + 23.
  9798
  9799
  9800* EXEC CICS WRITE
  9801*        DATASET  (ERPYAJ-FILE-ID)
  9802*        FROM     (PENDING-PAY-ADJ)
  9803*        RIDFLD   (PY-CONTROL-PRIMARY)
  9804*    END-EXEC.
  9805     MOVE LENGTH OF
  9806      PENDING-PAY-ADJ
  9807       TO DFHEIV11
  9808*    MOVE '&$ L                  ''   #00009059' TO DFHEIV0
  9809     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9810     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9811     MOVE X'2020233030303039303539' TO DFHEIV0(25:11)
  9812     CALL 'kxdfhei1' USING DFHEIV0,
  9813           ERPYAJ-FILE-ID,
  9814           PENDING-PAY-ADJ,
  9815           DFHEIV11,
  9816           PY-CONTROL-PRIMARY,
  9817           DFHEIV99,
  9818           DFHEIV99
  9819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9820
  9821
  9822     PERFORM 8400-LOG-JOURNAL-RECORD.
  9823
  9824     IF CR-CHECK-NO-AUTO-SEQ
  9825         PERFORM 6200-REWRITE-CONTROL-FILE  THRU  6290-EXIT
  9826     ELSE
  9827
  9828* EXEC CICS UNLOCK
  9829*            DATASET  (ELCNTL-FILE-ID)
  9830*        END-EXEC.
  9831*    MOVE '&*                    #   #00009070' TO DFHEIV0
  9832     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9833     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9834     MOVE X'2020233030303039303730' TO DFHEIV0(25:11)
  9835     CALL 'kxdfhei1' USING DFHEIV0,
  9836           ELCNTL-FILE-ID,
  9837           DFHEIV99
  9838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9839
  9840
  9841     MOVE EL642A                 TO  PI-MAP-NAME.
  9842
  9843     PERFORM 5000-FORMAT-SCREEN  THRU  5090-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 202
* EL642.cbl
  9845 8100-SEND-INITIAL-MAP.
  9846
  9847     MOVE SPACES TO PI-TRANSFER-SW.
  9848
  9849     IF PI-MAP-NAME  =  EL642A
  9850         NEXT SENTENCE
  9851     ELSE
  9852         GO TO 8110-SEND-INITIAL-CHECK-MAP.
  9853
  9854     MOVE WS-CURRENT-DATE-EDIT   TO  ADATEO.
  9855     MOVE EIBTIME                TO  TIME-IN.
  9856     MOVE TIME-OUT               TO  ATIMEO.
  9857     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9858     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9859     MOVE -1                     TO  AAGENTL.
  9860     MOVE EMI-MESSAGE-AREA (1)   TO  AERMSG1O.
  9861     MOVE EMI-MESSAGE-AREA (2)   TO  AERMSG2O.
  9862
  9863     IF PI-ZERO-CARRIER
  9864         MOVE AL-SADOF           TO  ACARHDGA
  9865                                     ACARIERA.
  9866
  9867     IF PI-ZERO-GROUPING
  9868         MOVE AL-SADOF           TO  AGRPHDGA
  9869                                     AGROUPA.
  9870
  9871     IF PI-ZERO-CAR-GROUP
  9872         MOVE AL-SADOF           TO  ACARHDGA
  9873                                     ACARIERA
  9874         MOVE AL-SADOF           TO  AGRPHDGA
  9875                                     AGROUPA.
  9876
  9877     IF (EIBTRNID = EL633-TRANS-ID OR EL635-TRANS-ID OR
  9878                    EL633DMD-TRANS-ID OR
  9879                    EL650-TRANS-ID OR EL652-TRANS-ID OR
  9880                    EL658-TRANS-ID)    AND
  9881        (WT-CR-FIN-RESP NOT EQUAL SPACES AND LOW-VALUES)
  9882         MOVE -1                    TO  ABILTYPL
  9883         MOVE WT-CR-STATE           TO  PI-SCR-STATE
  9884         MOVE WT-CR-ACCOUNT         TO  PI-SCR-ACCOUNT
  9885         MOVE WT-CR-TYPE            TO  PI-SCR-TYPE
  9886         IF PI-ZERO-CARRIER
  9887             MOVE WT-CR-FIN-RESP    TO  AAGENTI
  9888                                        PI-SCR-FIN-RESP
  9889             MOVE WT-CR-GROUPING    TO  AGROUPI
  9890                                        PI-SCR-GROUPING
  9891             MOVE AL-UANON          TO  AAGENTA
  9892                                        AGROUPA
  9893             MOVE 10                TO  AAGENTL
  9894             MOVE 6                 TO  AGROUPL
  9895         ELSE
  9896            IF PI-ZERO-GROUPING
  9897                MOVE WT-CR-CARRIER    TO  ACARIERI
  9898                                          PI-SCR-CARRIER
  9899                MOVE WT-CR-FIN-RESP   TO  AAGENTI
  9900                                          PI-SCR-FIN-RESP
  9901                MOVE AL-UANON         TO  ACARIERA
  9902                                          AAGENTA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 203
* EL642.cbl
  9903                MOVE 10               TO  AAGENTL
  9904                MOVE 1                TO  ACARIERL
  9905            ELSE
  9906               IF PI-ZERO-CAR-GROUP
  9907                   MOVE WT-CR-FIN-RESP TO  AAGENTI
  9908                                           PI-SCR-FIN-RESP
  9909                   MOVE AL-UANON       TO  AAGENTA
  9910                   MOVE 10             TO  AAGENTL
  9911               ELSE
  9912                   MOVE WT-CR-CARRIER     TO  ACARIERI
  9913                                              PI-SCR-CARRIER
  9914                   MOVE WT-CR-FIN-RESP    TO  AAGENTI
  9915                                              PI-SCR-FIN-RESP
  9916                   MOVE WT-CR-GROUPING    TO  AGROUPI
  9917                                              PI-SCR-GROUPING
  9918                   MOVE AL-UANON          TO  AAGENTA
  9919                                              AGROUPA
  9920                                              ACARIERA
  9921                   MOVE 10                TO  AAGENTL
  9922                   MOVE 6                 TO  AGROUPL
  9923                   MOVE 1                 TO  ACARIERL.
  9924
  9925
  9926* EXEC CICS SEND
  9927*        MAP     (PI-MAP-NAME)
  9928*        MAPSET  (MAPSET-NAME)
  9929*        FROM    (EL642AO)
  9930*        ERASE
  9931*        CURSOR
  9932*    END-EXEC.
  9933     MOVE LENGTH OF
  9934      EL642AO
  9935       TO DFHEIV12
  9936     MOVE -1
  9937       TO DFHEIV11
  9938*    MOVE '8$     CT  E    H L F ,   #00009158' TO DFHEIV0
  9939     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9940     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9941     MOVE X'2020233030303039313538' TO DFHEIV0(25:11)
  9942     CALL 'kxdfhei1' USING DFHEIV0,
  9943           PI-MAP-NAME,
  9944           EL642AO,
  9945           DFHEIV12,
  9946           MAPSET-NAME,
  9947           DFHEIV99,
  9948           DFHEIV99,
  9949           DFHEIV99,
  9950           DFHEIV11,
  9951           DFHEIV99,
  9952           DFHEIV99,
  9953           DFHEIV99
  9954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9955
  9956
  9957     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 204
* EL642.cbl
  9959 8110-SEND-INITIAL-CHECK-MAP.
  9960     MOVE WS-CURRENT-DATE-EDIT   TO  BDATEO.
  9961     MOVE EIBTIME                TO  TIME-IN.
  9962     MOVE TIME-OUT               TO  BTIMEO.
  9963     MOVE PI-COMPANY-ID          TO  BCMPNYO.
  9964     MOVE PI-PROCESSOR-ID        TO  BUSERIDO.
  9965     MOVE -1                     TO  BPFNTERL.
  9966     MOVE EMI-MESSAGE-AREA (1)   TO  BERMSGO.
  9967
  9968
  9969* EXEC CICS SEND
  9970*        MAP     (PI-MAP-NAME)
  9971*        MAPSET  (MAPSET-NAME)
  9972*        FROM    (EL642BO)
  9973*        ERASE
  9974*        CURSOR
  9975*    END-EXEC.
  9976     MOVE LENGTH OF
  9977      EL642BO
  9978       TO DFHEIV12
  9979     MOVE -1
  9980       TO DFHEIV11
  9981*    MOVE '8$     CT  E    H L F ,   #00009177' TO DFHEIV0
  9982     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9983     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9984     MOVE X'2020233030303039313737' TO DFHEIV0(25:11)
  9985     CALL 'kxdfhei1' USING DFHEIV0,
  9986           PI-MAP-NAME,
  9987           EL642BO,
  9988           DFHEIV12,
  9989           MAPSET-NAME,
  9990           DFHEIV99,
  9991           DFHEIV99,
  9992           DFHEIV99,
  9993           DFHEIV11,
  9994           DFHEIV99,
  9995           DFHEIV99,
  9996           DFHEIV99
  9997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9998
  9999
 10000     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 205
* EL642.cbl
 10002 8200-SEND-DATAONLY.
 10003     IF PI-MAP-NAME  =  EL642A
 10004         MOVE WS-CURRENT-DATE-EDIT  TO  ADATEO
 10005         MOVE EIBTIME               TO  TIME-IN
 10006         MOVE TIME-OUT              TO  ATIMEO
 10007         MOVE PI-COMPANY-ID         TO  CMPNYIDO
 10008         MOVE PI-PROCESSOR-ID       TO  USERIDO
 10009         MOVE EMI-MESSAGE-AREA (1)  TO  AERMSG1O
 10010         MOVE EMI-MESSAGE-AREA (2)  TO  AERMSG2O
 10011
 10012* EXEC CICS SEND
 10013*            MAP     (PI-MAP-NAME)
 10014*            MAPSET  (MAPSET-NAME)
 10015*            FROM    (EL642AO)
 10016*            DATAONLY
 10017*            ERASEAUP
 10018*            CURSOR
 10019*        END-EXEC
 10020     MOVE LENGTH OF
 10021      EL642AO
 10022       TO DFHEIV12
 10023     MOVE -1
 10024       TO DFHEIV11
 10025*    MOVE '8$D    CT  A    H L F ,   #00009196' TO DFHEIV0
 10026     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 10027     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10028     MOVE X'2020233030303039313936' TO DFHEIV0(25:11)
 10029     CALL 'kxdfhei1' USING DFHEIV0,
 10030           PI-MAP-NAME,
 10031           EL642AO,
 10032           DFHEIV12,
 10033           MAPSET-NAME,
 10034           DFHEIV99,
 10035           DFHEIV99,
 10036           DFHEIV99,
 10037           DFHEIV11,
 10038           DFHEIV99,
 10039           DFHEIV99,
 10040           DFHEIV99
 10041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10042     ELSE
 10043         MOVE WS-CURRENT-DATE-EDIT  TO  BDATEO
 10044         MOVE EIBTIME               TO  TIME-IN
 10045         MOVE TIME-OUT              TO  BTIMEO
 10046         MOVE PI-COMPANY-ID         TO  BCMPNYO
 10047         MOVE PI-PROCESSOR-ID       TO  BUSERIDO
 10048         MOVE EMI-MESSAGE-AREA (1)  TO  BERMSGO
 10049
 10050* EXEC CICS SEND
 10051*            MAP     (PI-MAP-NAME)
 10052*            MAPSET  (MAPSET-NAME)
 10053*            FROM    (EL642BO)
 10054*            DATAONLY
 10055*            ERASEAUP
 10056*            CURSOR
 10057*        END-EXEC.
 10058     MOVE LENGTH OF
 10059      EL642BO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 206
* EL642.cbl
 10060       TO DFHEIV12
 10061     MOVE -1
 10062       TO DFHEIV11
 10063*    MOVE '8$D    CT  A    H L F ,   #00009211' TO DFHEIV0
 10064     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 10065     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10066     MOVE X'2020233030303039323131' TO DFHEIV0(25:11)
 10067     CALL 'kxdfhei1' USING DFHEIV0,
 10068           PI-MAP-NAME,
 10069           EL642BO,
 10070           DFHEIV12,
 10071           MAPSET-NAME,
 10072           DFHEIV99,
 10073           DFHEIV99,
 10074           DFHEIV99,
 10075           DFHEIV11,
 10076           DFHEIV99,
 10077           DFHEIV99,
 10078           DFHEIV99
 10079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10080
 10081
 10082     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 207
* EL642.cbl
 10084 8300-SEND-TEXT.
 10085
 10086* EXEC CICS SEND TEXT
 10087*        FROM    (LOGOFF-TEXT)
 10088*        LENGTH  (LOGOFF-LENGTH)
 10089*        ERASE
 10090*        FREEKB
 10091*    END-EXEC.
 10092*    MOVE '8&      T  E F  H   F -   #00009223' TO DFHEIV0
 10093     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10094     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10095     MOVE X'2020233030303039323233' TO DFHEIV0(25:11)
 10096     CALL 'kxdfhei1' USING DFHEIV0,
 10097           LOGOFF-TEXT,
 10098           LOGOFF-LENGTH,
 10099           DFHEIV99,
 10100           DFHEIV99,
 10101           DFHEIV99,
 10102           DFHEIV99,
 10103           DFHEIV99,
 10104           DFHEIV99,
 10105           DFHEIV99,
 10106           DFHEIV99,
 10107           DFHEIV99,
 10108           DFHEIV99
 10109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10110
 10111
 10112
 10113* EXEC CICS RETURN
 10114*    END-EXEC.
 10115*    MOVE '.(                    ''   #00009230' TO DFHEIV0
 10116     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10117     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10118     MOVE X'2020233030303039323330' TO DFHEIV0(25:11)
 10119     CALL 'kxdfhei1' USING DFHEIV0,
 10120           DFHEIV99,
 10121           DFHEIV99,
 10122           DFHEIV99,
 10123           DFHEIV99,
 10124           DFHEIV99,
 10125           DFHEIV99
 10126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10127
 10128
 10129 8400-LOG-JOURNAL-RECORD.
 10130     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
 10131     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
 10132
 10133*    EXEC CICS JOURNAL
 10134*        JFILEID  (PI-JOURNAL-FILE-ID)
 10135*        JTYPEID  ('EL')
 10136*        FROM     (JOURNAL-RECORD)
 10137*        LENGTH   (JOURNAL-LENGTH)
 10138*    END-EXEC.
 10139
 10140 8500-DATE-CONVERT.
 10141
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 208
* EL642.cbl
 10142* EXEC CICS LINK
 10143*        PROGRAM   (LINK-ELDATCV)
 10144*        COMMAREA  (DATE-CONVERSION-DATA)
 10145*        LENGTH    (DC-COMM-LENGTH) END-EXEC.
 10146*    MOVE '."C                   (   #00009245' TO DFHEIV0
 10147     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10148     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10149     MOVE X'2020233030303039323435' TO DFHEIV0(25:11)
 10150     CALL 'kxdfhei1' USING DFHEIV0,
 10151           LINK-ELDATCV,
 10152           DATE-CONVERSION-DATA,
 10153           DC-COMM-LENGTH,
 10154           DFHEIV99,
 10155           DFHEIV99,
 10156           DFHEIV99,
 10157           DFHEIV99
 10158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10159
 10160
 10161 8500-EXIT.
 10162     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 209
* EL642.cbl
 10164 8600-CENTER-DATA.
 10165     MOVE SPACE                  TO  CENTER-WORK-2.
 10166
 10167     IF CW1-PIC (1)  NOT =  SPACE
 10168       AND  CW1-PIC (X-LEN)  NOT =  SPACE
 10169         MOVE CENTER-WORK-1      TO  CENTER-WORK-2
 10170         GO TO 8690-C-D-X.
 10171
 10172     MOVE +0                     TO  X1.
 10173     MOVE X-LEN                  TO  X2.
 10174
 10175 8660-C-D-LOOP-1.
 10176     IF CW1-PIC (X2)  =  SPACE
 10177         ADD +1                  TO  X1
 10178         SUBTRACT +1             FROM  X2
 10179         GO TO 8660-C-D-LOOP-1.
 10180
 10181     MOVE +1                     TO  X2.
 10182
 10183 8670-C-D-LOOP-2.
 10184     IF CW1-PIC (X2)  =  SPACE
 10185         ADD +1                  TO  X1  X2
 10186         GO TO 8670-C-D-LOOP-2.
 10187
 10188     COMPUTE X3 = (X1 / +2) + +1.
 10189     COMPUTE X1 = X-LEN - X1.
 10190
 10191 8680-C-D-LOOP-3.
 10192     IF X1  NOT =  +0
 10193         MOVE CW1-PIC (X2)       TO  CW2-PIC (X3)
 10194         ADD +1                  TO  X2  X3
 10195         SUBTRACT +1             FROM  X1
 10196         GO TO 8680-C-D-LOOP-3.
 10197
 10198 8690-C-D-X.
 10199     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 210
* EL642.cbl
 10201 8800-UNAUTHORIZED-ACCESS.
 10202     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
 10203
 10204     GO TO 8300-SEND-TEXT.
 10205
 10206 8810-PF23.
 10207     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10208     MOVE XCTL-005               TO  PGM-NAME.
 10209
 10210     GO TO 9300-XCTL.
 10211
 10212 8900-SYNCPOINT-ROLLBACK.
 10213
 10214* EXEC CICS SYNCPOINT
 10215*        ROLLBACK
 10216*    END-EXEC.
 10217*    MOVE '6"R                   !   #00009302' TO DFHEIV0
 10218     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10219     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10220     MOVE X'2020233030303039333032' TO DFHEIV0(25:11)
 10221     CALL 'kxdfhei1' USING DFHEIV0
 10222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10223
 10224
 10225
 10226* EXEC CICS DUMP
 10227*        DUMPCODE  ('LGXX')
 10228*        TASK
 10229*    END-EXEC.
 10230     MOVE 'LGXX' TO DFHEIV5
 10231*    MOVE '<"   T                $   #00009306' TO DFHEIV0
 10232     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 10233     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10234     MOVE X'2020233030303039333036' TO DFHEIV0(25:11)
 10235     CALL 'kxdfhei1' USING DFHEIV0,
 10236           DFHEIV5,
 10237           DFHEIV99,
 10238           DFHEIV99
 10239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10240
 10241
 10242 8900-EXIT.
 10243     EXIT.
 10244
 10245 9100-RETURN-TRAN.
 10246     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10247     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10248
 10249
 10250* EXEC CICS RETURN
 10251*        TRANSID   (TRANS-ID)
 10252*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10253*        LENGTH    (PI-COMM-LENGTH)
 10254*    END-EXEC.
 10255*    MOVE '.(CT                  ''   #00009318' TO DFHEIV0
 10256     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10257     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10258     MOVE X'2020233030303039333138' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 211
* EL642.cbl
 10259     CALL 'kxdfhei1' USING DFHEIV0,
 10260           TRANS-ID,
 10261           PROGRAM-INTERFACE-BLOCK,
 10262           PI-COMM-LENGTH,
 10263           DFHEIV99,
 10264           DFHEIV99,
 10265           DFHEIV99
 10266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10267
 10268
 10269 9200-RETURN-MAIN-MENU.
 10270     MOVE XCTL-626               TO  PGM-NAME.
 10271
 10272     GO TO 9300-XCTL.
 10273
 10274 9300-XCTL.
 10275
 10276* EXEC CICS XCTL
 10277*        PROGRAM   (PGM-NAME)
 10278*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10279*        LENGTH    (PI-COMM-LENGTH)
 10280*    END-EXEC.
 10281*    MOVE '.$C                   %   #00009330' TO DFHEIV0
 10282     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10283     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10284     MOVE X'2020233030303039333330' TO DFHEIV0(25:11)
 10285     CALL 'kxdfhei1' USING DFHEIV0,
 10286           PGM-NAME,
 10287           PROGRAM-INTERFACE-BLOCK,
 10288           PI-COMM-LENGTH,
 10289           DFHEIV99
 10290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10291
 10292
 10293 9400-CLEAR.
 10294     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME
 10295
 10296     GO TO 9300-XCTL.
 10297
 10298 9500-PF12.
 10299     MOVE XCTL-010               TO  PGM-NAME.
 10300
 10301     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 212
* EL642.cbl
 10303 9600-PGMID-ERROR.
 10304
 10305* EXEC CICS HANDLE CONDITION
 10306*        PGMIDERR  (8300-SEND-TEXT)
 10307*    END-EXEC.
 10308*    MOVE '"$L                   ! 5 #00009347' TO DFHEIV0
 10309     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10310     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10311     MOVE X'3520233030303039333437' TO DFHEIV0(25:11)
 10312     CALL 'kxdfhei1' USING DFHEIV0
 10313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10314
 10315
 10316     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10317     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10318     MOVE XCTL-005               TO  PGM-NAME.
 10319     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10320     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10321
 10322     GO TO 9300-XCTL.
 10323
 10324 9900-ERROR-FORMAT.
 10325     IF NOT  EMI-ERRORS-COMPLETE
 10326         MOVE LINK-001           TO  PGM-NAME
 10327
 10328* EXEC CICS LINK
 10329*            PROGRAM   (PGM-NAME)
 10330*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 10331*            LENGTH    (EMI-COMM-LENGTH)
 10332*        END-EXEC.
 10333*    MOVE '."C                   (   #00009362' TO DFHEIV0
 10334     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10335     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10336     MOVE X'2020233030303039333632' TO DFHEIV0(25:11)
 10337     CALL 'kxdfhei1' USING DFHEIV0,
 10338           PGM-NAME,
 10339           ERROR-MESSAGE-INTERFACE-BLOCK,
 10340           EMI-COMM-LENGTH,
 10341           DFHEIV99,
 10342           DFHEIV99,
 10343           DFHEIV99,
 10344           DFHEIV99
 10345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10346
 10347
 10348 9900-EXIT.
 10349     EXIT.
 10350
 10351 9990-ABEND.
 10352     MOVE LINK-004               TO  PGM-NAME.
 10353     MOVE DFHEIBLK               TO  EMI-LINE1
 10354
 10355
 10356* EXEC CICS LINK
 10357*        PROGRAM   (PGM-NAME)
 10358*        COMMAREA  (EMI-LINE1)
 10359*        LENGTH    (72)
 10360*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 213
* EL642.cbl
 10361     MOVE 72
 10362       TO DFHEIV11
 10363*    MOVE '."C                   (   #00009375' TO DFHEIV0
 10364     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10365     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10366     MOVE X'2020233030303039333735' TO DFHEIV0(25:11)
 10367     CALL 'kxdfhei1' USING DFHEIV0,
 10368           PGM-NAME,
 10369           EMI-LINE1,
 10370           DFHEIV11,
 10371           DFHEIV99,
 10372           DFHEIV99,
 10373           DFHEIV99,
 10374           DFHEIV99
 10375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10376
 10377
 10378     IF PI-MAP-NAME  =  EL642A
 10379         MOVE -1                 TO  APFNTERL
 10380     ELSE
 10381         MOVE -1                 TO  BPFNTERL.
 10382
 10383     GO TO 8200-SEND-DATAONLY.
 10384
 10385 9995-SECURITY-VIOLATION.
 10386*                            COPY ELCSCTP.
 10387******************************************************************
 10388*                                                                *
 10389*                            ELCSCTP                             *
 10390*                            VMOD=2.001                          *
 10391*                                                                *
 10392*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10393******************************************************************
 10394
 10395
 10396     MOVE EIBDATE          TO SM-JUL-DATE.
 10397     MOVE EIBTRMID         TO SM-TERMID.
 10398     MOVE THIS-PGM         TO SM-PGM.
 10399     MOVE EIBTIME          TO TIME-IN.
 10400     MOVE TIME-OUT         TO SM-TIME.
 10401     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10402
 10403
 10404* EXEC CICS LINK
 10405*         PROGRAM  ('EL003')
 10406*         COMMAREA (SECURITY-MESSAGE)
 10407*         LENGTH   (80)
 10408*    END-EXEC.
 10409     MOVE 'EL003' TO DFHEIV1
 10410     MOVE 80
 10411       TO DFHEIV11
 10412*    MOVE '."C                   (   #00009406' TO DFHEIV0
 10413     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10414     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10415     MOVE X'2020233030303039343036' TO DFHEIV0(25:11)
 10416     CALL 'kxdfhei1' USING DFHEIV0,
 10417           DFHEIV1,
 10418           SECURITY-MESSAGE,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 214
* EL642.cbl
 10419           DFHEIV11,
 10420           DFHEIV99,
 10421           DFHEIV99,
 10422           DFHEIV99,
 10423           DFHEIV99
 10424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10425
 10426
 10427******************************************************************
 10428
 10429
 10430 9999-DFHBACK SECTION.
 10431     MOVE '9%                    "   ' TO DFHEIV0
 10432     MOVE 'EL642' TO DFHEIV1
 10433     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10434     GOBACK.
 10435 9999-DFHEXIT.
 10436     IF DFHEIGDJ EQUAL 0001
 10437         NEXT SENTENCE
 10438     ELSE IF DFHEIGDJ EQUAL 2
 10439         GO TO 9600-PGMID-ERROR,
 10440               9990-ABEND
 10441         DEPENDING ON DFHEIGDI
 10442     ELSE IF DFHEIGDJ EQUAL 3
 10443         GO TO 0890-EXIT
 10444         DEPENDING ON DFHEIGDI
 10445     ELSE IF DFHEIGDJ EQUAL 4
 10446         GO TO 3930-BILL-NOTFND
 10447         DEPENDING ON DFHEIGDI
 10448     ELSE IF DFHEIGDJ EQUAL 5
 10449         GO TO 3940-EXIT
 10450         DEPENDING ON DFHEIGDI
 10451     ELSE IF DFHEIGDJ EQUAL 6
 10452         GO TO 4010-REC-NOT-FND
 10453         DEPENDING ON DFHEIGDI
 10454     ELSE IF DFHEIGDJ EQUAL 7
 10455         GO TO 4110-END-OF-FILE
 10456         DEPENDING ON DFHEIGDI
 10457     ELSE IF DFHEIGDJ EQUAL 8
 10458         GO TO 4290-REC-NOT-FND
 10459         DEPENDING ON DFHEIGDI
 10460     ELSE IF DFHEIGDJ EQUAL 9
 10461         GO TO 4370-ACCOUNT-INVALID
 10462         DEPENDING ON DFHEIGDI
 10463     ELSE IF DFHEIGDJ EQUAL 10
 10464         GO TO 4510-REC-NOT-FND
 10465         DEPENDING ON DFHEIGDI
 10466     ELSE IF DFHEIGDJ EQUAL 11
 10467         GO TO 4610-END-OF-FILE
 10468         DEPENDING ON DFHEIGDI
 10469     ELSE IF DFHEIGDJ EQUAL 12
 10470         GO TO 6070-NO-COMP-MSTR
 10471         DEPENDING ON DFHEIGDI
 10472     ELSE IF DFHEIGDJ EQUAL 13
 10473         GO TO 6110-NO-RECORD
 10474         DEPENDING ON DFHEIGDI
 10475     ELSE IF DFHEIGDJ EQUAL 14
 10476         GO TO 6410-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 215
* EL642.cbl
 10477         DEPENDING ON DFHEIGDI
 10478     ELSE IF DFHEIGDJ EQUAL 15
 10479         GO TO 6610-NOT-FOUND
 10480         DEPENDING ON DFHEIGDI
 10481     ELSE IF DFHEIGDJ EQUAL 16
 10482         GO TO 6660-START-BROWSE,
 10483               6700-COMM-EXIT
 10484         DEPENDING ON DFHEIGDI
 10485     ELSE IF DFHEIGDJ EQUAL 17
 10486         GO TO 6700-COMM-EXIT,
 10487               6700-COMM-EXIT
 10488         DEPENDING ON DFHEIGDI
 10489     ELSE IF DFHEIGDJ EQUAL 18
 10490         GO TO 6700-COMM-EXIT,
 10491               6700-COMM-EXIT
 10492         DEPENDING ON DFHEIGDI
 10493     ELSE IF DFHEIGDJ EQUAL 19
 10494         GO TO 6710-NOT-FOUND
 10495         DEPENDING ON DFHEIGDI
 10496     ELSE IF DFHEIGDJ EQUAL 20
 10497         GO TO 6880-NOT-FOUND
 10498         DEPENDING ON DFHEIGDI
 10499     ELSE IF DFHEIGDJ EQUAL 21
 10500         GO TO 8300-SEND-TEXT
 10501         DEPENDING ON DFHEIGDI.
 10502     MOVE '9%                    "   ' TO DFHEIV0
 10503     MOVE 'EL642' TO DFHEIV1
 10504     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10505     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8024     Code:       29773
