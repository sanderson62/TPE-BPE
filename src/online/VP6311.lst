* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page   1
* VP6311.cbl
* Options: int("VP6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("VP6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"VP6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"VP6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 VP6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page   2
* VP6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - VPB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page   3
* VP6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    79* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    80* 031620  CR2019092700001  PEMA  Remove post card indicator
    81******************************************************************
    82
    83 ENVIRONMENT DIVISION.
    84
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page   4
* VP6311.cbl
    86 DATA DIVISION.
    87 WORKING-STORAGE SECTION.
    88 01  DFH-START PIC X(04).
    89 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    90 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    91 77  FILLER  PIC X(32)  VALUE '********************************'.
    92 77  FILLER  PIC X(32)  VALUE '*    VP6311 WORKING STORAGE    *'.
    93 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    94 77  A1                          PIC S999 COMP-3 VALUE +0.
    95 77  N1                          PIC S999 COMP-3 VALUE +0.
    96 77  N2                          PIC S999 COMP-3 VALUE +0.
    97 77  N3                          PIC S999 COMP-3 VALUE +0.
    98 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    99 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
   100 77  WS-REVERSE-SW               PIC X VALUE 'N'.
   101     88  REVERSAL                    VALUE 'Y'.
   102 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   103 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   104 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   105 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   106 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   107     88  ERMAIL-FOUND                 VALUE 'Y'.
   108 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   109 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   110 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   111 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   112     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   113 77  ws-stop-sw                  pic x value ' '.
   114     88  i-say-stop                 value 'Y'.
   115 77  ws-check-sw                 pic x value ' '.
   116     88  i-have-checks              value 'Y'.
   117 77  ws-proc-check-sw            pic x value ' '.
   118     88  i-have-processed-checks    value 'Y'.
   119 77  ws-chek-browse-sw           pic x value ' '.
   120 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   121 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   122 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   123 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   124 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   125 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   126 01  P pointer.
   127 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   128 01  var-ptr pointer.
   129 01  env-var-len                 pic 9(4)  binary.
   130 01  rc                          pic 9(9)  binary.
   131 01  WS-KIXSYS.
   132     05  WS-KIX-FIL1             PIC X(10).
   133     05  WS-KIX-APPS             PIC X(10).
   134     05  WS-KIX-ENV              PIC X(10).
   135     05  WS-KIX-MYENV            PIC X(10).
   136     05  WS-KIX-SYS              PIC X(10).
   137*    COPY ELCSCTM.
   138******************************************************************
   139*                                                                *
   140*                                                                *
   141*                            ELCSCTM                             *
   142*                            VMOD=2.001                          *
   143*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page   5
* VP6311.cbl
   144*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   145*                                                                *
   146******************************************************************
   147 01  SECURITY-MESSAGE.
   148     12  FILLER                          PIC X(30)
   149            VALUE '** LOGIC SECURITY VIOLATION -'.
   150     12  SM-READ                         PIC X(6).
   151     12  FILLER                          PIC X(5)
   152            VALUE ' PGM='.
   153     12  SM-PGM                          PIC X(6).
   154     12  FILLER                          PIC X(5)
   155            VALUE ' OPR='.
   156     12  SM-PROCESSOR-ID                 PIC X(4).
   157     12  FILLER                          PIC X(6)
   158            VALUE ' TERM='.
   159     12  SM-TERMID                       PIC X(4).
   160     12  FILLER                          PIC XX   VALUE SPACE.
   161     12  SM-JUL-DATE                     PIC 9(5).
   162     12  FILLER                          PIC X    VALUE SPACE.
   163     12  SM-TIME                         PIC 99.99.
   164
   165
   166*    COPY ELCSCRTY.
   167******************************************************************
   168*                                                                *
   169*                                                                *
   170*                            ELCSCRTY                            *
   171*                            VMOD=2.001                          *
   172*                                                                *
   173*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   174*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   175*        SAVED IN PI-SECURITY-ADDRESS.                           *
   176*                                                                *
   177******************************************************************
   178 01  SECURITY-CONTROL.
   179     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   180     12  FILLER                       PIC XX    VALUE 'SC'.
   181     12  SC-CREDIT-CODES.
   182         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   183             20  SC-CREDIT-DISPLAY    PIC X.
   184             20  SC-CREDIT-UPDATE     PIC X.
   185     12  SC-CLAIMS-CODES.
   186         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   187             20  SC-CLAIMS-DISPLAY    PIC X.
   188             20  SC-CLAIMS-UPDATE     PIC X.
   189
   190 01  WS-VA-NO-COMM-MESS.
   191     12  FILLER                  PIC X(41) VALUE
   192        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   193 01  WS-OC-MESSAGE.
   194     12  FILLER                  PIC X(43) VALUE
   195        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   196     12  WS-OC-DIS-AMT           PIC -----9.99.
   197     12  FILLER                  PIC X(4) VALUE ' ON '.
   198     12  WS-OC-DATE              PIC X(10).
   199 01  WS-DATE-AREA.
   200     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   201     12  WS-CURRENT-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page   6
* VP6311.cbl
   202         16  FILLER              PIC X(6)    VALUE SPACES.
   203         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   204     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   205     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   206     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   207
   208 01  STANDARD-AREAS.
   209     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   210     12  VP631B                  PIC X(8)    VALUE 'VP631B'.
   211     12  VP631C                  PIC X(8)    VALUE 'VP631C'.
   212     12  VP631D                  PIC X(8)    VALUE 'VP631D'.
   213     12  MAPSET-VP6311S          PIC X(8)    VALUE 'VP6311S'.
   214     12  SCREEN-NUMBER           PIC X(6)    VALUE 'VP631B'.
   215     12  TRANS-EXB1              PIC X(4)    VALUE 'VPB1'.
   216     12  THIS-PGM                PIC X(8)    VALUE 'VP6311'.
   217     12  PGM-NAME                PIC X(8).
   218     12  TIME-IN                 PIC S9(7).
   219     12  TIME-OUT-R  REDEFINES TIME-IN.
   220         16  FILLER              PIC X.
   221         16  TIME-OUT            PIC 99V99.
   222         16  FILLER              PIC XX.
   223     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   224     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   225     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   226     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   227     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   228     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   229     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   230     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   231     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   232     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   233     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   234     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   235     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   236     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   237     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   238     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   239     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   240     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   241     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   242     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   243     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   244     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   245     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   246     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   247     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   248     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   249     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   250     12  FILE-ID                 PIC X(8).
   251     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   252     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   253     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   254     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   255     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   256     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   257     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   258     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   259     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page   7
* VP6311.cbl
   260     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   261     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   262     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   263     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   264     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   265     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   266
   267 01  WS-PASS-AREA.
   268     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   269     05  WS-PASS-VADS-REC    PIC X(350).
   270*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   271*                                COPY ELCZREC.
   272******************************************************************
   273*                                                                *
   274*                                                                *
   275*                            ELCZREC.                            *
   276*                                                                *
   277*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   278*                                                                *
   279******************************************************************
   280*-----------------------------------------------------------------
   281*                   C H A N G E   L O G
   282*
   283* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   284*-----------------------------------------------------------------
   285*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   286* EFFECTIVE    NUMBER
   287*-----------------------------------------------------------------
   288* 122011    2011022800001  AJRA  NEW FILE
   289* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   290* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   291* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   292* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   293*-----------------------------------------------------------------
   294 01  W-Z-CONTROL-DATA.
   295     05  W-NUMBER-OF-COPIES      PIC  9.
   296     05  FILLER                  PIC  X.
   297     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   298     05  FILLER                  PIC  X.
   299     05  W-DAYS-TO-RESEND        PIC  999.
   300     05  FILLER                  PIC  X.
   301     05  W-FORM-TO-RESEND        PIC  X(4).
   302     05  W-ADD-BAR-CODE          PIC  X.
   303     05  W-PROMPT-LETTER         PIC  X.
   304     05  W-HAS-RETURN-ENV        PIC  X.
   305     05  W-ENCLOSURE-CD          PIC  XXX.
   306     05  W-SIG-FLAG-DEFAULT      PIC  X.
   307     05  W-AUTO-CLOSE-IND        PIC  X.
   308     05  FILLER                  PIC  X.
   309     05  W-LETTER-TO-BENE        PIC  X.
   310     05  FILLER                  PIC  X.
   311     05  W-LETTER-TO-ACCT        PIC  X.
   312     05  FILLER                  PIC  X.
   313     05  W-LETTER-TYPE           PIC  X.
   314     05  FILLER                  PIC  X.
   315     05  W-PRINT-CERTIFICATE     PIC  X.
   316     05  FILLER                  PIC  X.
   317     05  W-REFUND-REQUIRED       PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page   8
* VP6311.cbl
   318     05  FILLER                  PIC  X.
   319     05  W-ONBASE-CODE           PIC  XX.
   320     05  FILLER                  PIC  X.
   321     05  W-ACCT-SUMM             PIC  X.
   322     05  FILLER                  PIC  X.
   323     05  W-CSO-SUMM              PIC  X.
   324     05  FILLER                  PIC  X.
   325     05  W-REASONS-REQUIRED      PIC  X.
   326     05  FILLER                  PIC  X(29).
   327******************************************************************
   328*                                                                *
   329*              A C C E S S   K E Y S                             *
   330*                                                                *
   331******************************************************************
   332
   333 01  ACCESS-KEYS.
   334     12  ERPYAJ-KEY.
   335         16  ERPYAJ-COMPANY-CD       PIC X.
   336         16  ERPYAJ-CARRIER          PIC X.
   337         16  ERPYAJ-GROUPING         PIC X(6).
   338         16  ERPYAJ-FIN-RESP         PIC X(10).
   339         16  ERPYAJ-ACCOUNT          PIC X(10).
   340         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   341         16  ERPYAJ-TYPE             PIC X.
   342     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   343     12  ELCERT-KEY.
   344         16  ELCERT-COMPANY-CD       PIC X.
   345         16  ELCERT-CARRIER          PIC X.
   346         16  ELCERT-GROUPING         PIC X(6).
   347         16  ELCERT-STATE            PIC XX.
   348         16  ELCERT-ACCOUNT          PIC X(10).
   349         16  ELCERT-CERT-EFF-DT      PIC XX.
   350         16  ELCERT-CERT-NO.
   351             20  ELCERT-CERT-PRIME   PIC X(10).
   352             20  ELCERT-CERT-SFX     PIC X.
   353
   354     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   355     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   356     12  ELCRTO-KEY.
   357         16  ELCRTO-COMPANY-CD       PIC X.
   358         16  ELCRTO-CARRIER          PIC X.
   359         16  ELCRTO-GROUPING         PIC X(6).
   360         16  ELCRTO-STATE            PIC XX.
   361         16  ELCRTO-ACCOUNT          PIC X(10).
   362         16  ELCRTO-CERT-EFF-DT      PIC XX.
   363         16  ELCRTO-CERT-NO.
   364             20  ELCRTO-CERT-PRIME   PIC X(10).
   365             20  ELCRTO-CERT-SFX     PIC X.
   366         16  ELCRTO-RECORD-TYPE      PIC X.
   367         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   368
   369     12  ELCRTT-KEY.
   370         16  ELCRTT-PRIMARY          PIC X(33).
   371         16  ELCRTT-REC-TYPE         PIC X(1).
   372     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   373     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   374
   375     12  ERPNDB-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page   9
* VP6311.cbl
   376         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   377         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   378         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   379         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   380             ERPNDB-BATCH-SEQ-NO     PIC XX.
   381         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   382
   383     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   384     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   385     12  ERCHEK-KEY.
   386         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   387         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   388         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   389         16  CHEK-STATE              PIC XX      VALUE SPACES.
   390         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   391         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   392         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   393         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   394         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   395     12  ELLETR-KEY.
   396         16  LETR-COMPANY-CD     PIC X.
   397         16  LETR-LETTER-ID      PIC X(4).
   398         16  LETR-FILLER         PIC X(8).
   399         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   400     12  ERPNDM-KEY.
   401         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   402         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   403         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   404         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   405
   406*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   407     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   408*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   409     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   410
   411     12  ERPNDB-ALT-KEY.
   412         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   413         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   414         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   415         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   416         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   417         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   418         16  ERPNDB-CERT-NO.
   419             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   420             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   421         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   422         16  ERPNDB-RECORD-TYPE      PIC X.
   423
   424      12  ERPNDB-CSR-KEY.
   425          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   426          20  ERPNDB-CSR-ID                PIC X(4).
   427          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   428          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   429          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   430
   431     12  ERNOTE-KEY.
   432         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   433         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  10
* VP6311.cbl
   434         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   435         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   436         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   437         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   438         16  ERNOTE-CERT-NO.
   439             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   440             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   441
   442     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   443     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   444
   445     12  ERCNOT-KEY.
   446         16  ERCNOT-PART-KEY.
   447             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   448             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   449             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   450             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   451             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   452             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   453             20  ERCNOT-CERT-NO.
   454                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   455                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   456         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   457         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   458
   459     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   460     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   461
   462     12  ERMAIL-KEY.
   463         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   464         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   465         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   466         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   467         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   468         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   469         16  ERMAIL-CERT-NO.
   470             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   471             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   472
   473     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   474     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   475
   476     12  ERRQST-KEY.
   477         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   478         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   479
   480     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   481     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   482
   483     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   484
   485     12  ERLOFC-KEY.
   486         16  ERLOFC-COMPANY-CD          PIC  X.
   487         16  ERLOFC-CARRIER             PIC  X.
   488         16  ERLOFC-GROUPING            PIC  X(6).
   489         16  ERLOFC-STATE               PIC  XX.
   490         16  ERLOFC-ACCOUNT             PIC  X(10).
   491         16  ERLOFC-OFFICER-CODE        PIC  X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  11
* VP6311.cbl
   492*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   493
   494     12  ERACCT-KEY.
   495         16  ERACCT-COMPANY-CD          PIC  X.
   496         16  ERACCT-CARRIER             PIC  X.
   497         16  ERACCT-GROUPING            PIC  X(6).
   498         16  ERACCT-STATE               PIC  XX.
   499         16  ERACCT-ACCOUNT             PIC  X(10).
   500         16  ERACCT-EXP-DT.
   501             20  ERACCT-DT              PIC  XX.
   502             20  ERACCT-FILL            PIC  X(4).
   503
   504     12  ERENDT-KEY.
   505         16  ENDT-COMPANY-CD       PIC X.
   506         16  ENDT-CARRIER          PIC X.
   507         16  ENDT-GROUPING         PIC X(6).
   508         16  ENDT-STATE            PIC XX.
   509         16  ENDT-ACCOUNT          PIC X(10).
   510         16  ENDT-CERT-EFF-DT      PIC XX.
   511         16  ENDT-CERT-PRIME       PIC X(10).
   512         16  ENDT-CERT-SFX         PIC X.
   513         16  ENDT-RECORD-TYPE      PIC X.
   514         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   515
   516 01  WS-ELMSTR-WORK.
   517     12  ELMSTR-KEY.
   518         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   519         16  MSTR-CERT-NO.
   520             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   521             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   522     12  W-CLAIM-KEY.
   523         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   524         16  W-CL-CERT-NO.
   525             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   526             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   527      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   528 01  CANCEL-GEN-PASS-AREA.
   529     05  CG-OPTION-CODE          PIC X.
   530         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   531         88  CG-FLAT-CANCEL        VALUE '1'.
   532         88  CG-CANCEL             VALUE '2'.
   533         88  CG-CANCEL-REISSUE     VALUE '3'.
   534     05  CG-ERROR-CODE           PIC 99.
   535         88  CG-SUCCESS            VALUE 00.
   536         88  CG-DATE-ERROR         VALUE 01.
   537         88  CG-CERT-NOT-FOUND     VALUE 02.
   538         88  CG-AMOUNT-ERROR       VALUE 04.
   539         88  CG-OPTION-ERROR       VALUE 05.
   540         88  CG-PREV-CAN           VALUE 06.
   541         88  CG-INVALID-DATA       VALUE 07.
   542         88  CG-NO-ACCT-MSTR       VALUE 08.
   543         88  CG-SFX-A-EXIST        VALUE 09.
   544         88  CG-MISC-ERROR         VALUE 99.
   545     05  CG-COMPANY-ID           PIC XXX.
   546     05  CG-PROC-ID              PIC XXXX.
   547     05  CG-CURRENT-DT           PIC XX.
   548     05  CG-MONTH-END-DT         PIC XX.
   549     05  CG-CERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  12
* VP6311.cbl
   550         10  CG-CERT-COMPANY-CD  PIC X.
   551         10  CG-CERT-CARRIER     PIC X.
   552         10  CG-CERT-GROUP       PIC X(6).
   553         10  CG-CERT-STATE       PIC XX.
   554         10  CG-CERT-ACCOUNT     PIC X(10).
   555         10  CG-CERT-EFF-DT      PIC XX.
   556         10  CG-CERT-CERT-NO     PIC X(11).
   557     05  CG-LF-CAN-DATA.
   558         10  CG-LF-CAN-DT        PIC XX.
   559         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   560     05  CG-AH-CAN-DATA.
   561         10  CG-AH-CAN-DT        PIC XX.
   562         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   563     05  CG-CERT-PROFILE-DATA.
   564         10  CG-INS-LNAME        PIC X(15).
   565         10  CG-INS-FNAME        PIC X(10).
   566         10  CG-INS-MID-INIT     PIC X.
   567         10  CG-INS-AGE          PIC 99.
   568         10  CG-JNT-LNAME        PIC X(15).
   569         10  CG-JNT-FNAME        PIC X(10).
   570         10  CG-JNT-MID-INIT     PIC X.
   571         10  CG-JNT-AGE          PIC 99.
   572     05  CG-LF-ISS-DATA.
   573         10  CG-LF-BENCD         PIC XX.
   574         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   575         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   576     05  CG-AH-ISS-DATA.
   577         10  CG-AH-BENCD         PIC XX.
   578         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   579     05  CG-BATCH-NO             PIC X(6).
   580     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   581     05  FILLER                  PIC X(306).
   582******************************************************************
   583*                                                                *
   584*            G E N E R A L   W O R K   A R E A                   *
   585*                                                                *
   586******************************************************************
   587
   588 01  WORK-AREA.
   589     12  WS-RESPONSE             PIC S9(8)   COMP.
   590         88  RESP-NORMAL           VALUE +0.
   591         88  resp-file-notfnd      value +12.
   592         88  RESP-NOTFND           VALUE +13.
   593         88  resp-duprec           value +14.
   594         88  resp-dupkey           value +15.
   595         88  resp-invreq           value +16.
   596         88  RESP-NOTOPEN          VALUE +19.
   597         88  RESP-ENDFILE          VALUE +20.
   598         88  resp-lengtherr        value +22.
   599     12  DEEDIT-FIELD            PIC X(15).
   600     12  FILLER          REDEFINES DEEDIT-FIELD.
   601         16  FILLER              PIC X(4).
   602         16  DEEDIT-FIELD-X11    PIC X(11).
   603     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   604                                 PIC S9(15).
   605     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   606                                 PIC S9(13)V99.
   607     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  13
* VP6311.cbl
   608                                 PIC S9(11)V9999.
   609     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   610     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   611     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   612         16  WS-CALC-TERM-WHOLE  PIC S999.
   613         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   614
   615     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   616     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   617         16  WS-HR-MINS          PIC 99V99.
   618         16  FILLER              PIC XX.
   619
   620     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   621     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   622
   623     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   624     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   625
   626     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   627     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   628     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   629     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   630     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   631     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   632     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   633
   634     12  QID.
   635         16  QID-TERM            PIC X(4).
   636         16  FILLER              PIC X(4)    VALUE '607B'.
   637
   638     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   639         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   640
   641     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   642         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   643
   644     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   645         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   646                                         'A'.
   647
   648     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   649
   650     12  WS-NUMERIC-SW           PIC X.
   651        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   652
   653     12  WS-EDIT-CSO-FIELD.
   654         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   655                                 PIC X.
   656
   657     12  WS-SAVE-INPUT-FIELDS.
   658         16  WS-BAGE             PIC 99       VALUE ZERO.
   659*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   660         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   661         16  FILLER REDEFINES WS-BAPR.
   662             20  WS-APR-WHOLE-NUM    PIC 99.
   663             20  WS-APR-DEC          PIC 9999.
   664         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   665         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  14
* VP6311.cbl
   666
   667         16  WS-B-COVERAGE OCCURS 2 TIMES.
   668             20  WS-TERM-IN-DAYS-SW  PIC X.
   669                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   670             20  WS-BTERM        PIC 999       COMP-3.
   671             20  WS-BALT-TERM    PIC 999       COMP-3.
   672             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   673             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   674             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   675             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   676             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   677             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   678
   679         16  WS-C-FIELDS COMP-3.
   680             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   681             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   682             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   683
   684         16  WS-D-FIELDS COMP-3.
   685             20  WS-DRISS        PIC S9(5)    VALUE +0.
   686             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   687             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   688             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   689             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   690             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   691
   692     12  WS-SAVE-BIRTH-DATE.
   693         16  FILLER              PIC X(4)   VALUE SPACES.
   694         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   695
   696     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   697     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   698     12  FILLER REDEFINES WS-WORK-BIN-RED.
   699         16  FILLER              PIC X(02).
   700         16  WS-WORK-BIN-DT      PIC X(02).
   701     12  WS-SW-1                 PIC X     VALUE SPACE.
   702     12  WS-SW-2                 PIC X     VALUE SPACE.
   703     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   704         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   705     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   706         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   707
   708     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   709     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   710     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   711     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   712     12  WS-CONVERTED-CANCEL-DATES.
   713         16  WS-CONVERTED-CANDT1                  PIC XX.
   714         16  WS-CONVERTED-CANDT2                  PIC XX.
   715
   716     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   717
   718     12  WS-REC-FOUND-SW         PIC X.
   719         88  RECORD-NOT-FOUND    VALUE 'N'.
   720
   721     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   722         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   723         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  15
* VP6311.cbl
   724
   725     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   726         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   727         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   728
   729     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   730         88  BROWSE-STARTED      VALUE 'Y'.
   731
   732     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   733         88  FIRST-TIME          VALUE 'Y'.
   734
   735     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   736         88  FIRST-ENTRY         VALUE 'Y'.
   737
   738     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   739         88  REC-BILLED          VALUE 'Y'.
   740
   741     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   742         88  NO-CURSOR-SET       VALUE +0.
   743         88  CURSOR-SET          VALUE +1.
   744
   745     12  WS-ERR-SW               PIC X.
   746         88  STD-ERRORS          VALUE 'S'.
   747         88  TRN-ERRORS          VALUE 'T'.
   748
   749     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   750         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   751
   752     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   753         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   754
   755     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   756         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   757
   758     12  WS-ERR-CODE.
   759         16  FILLER              PIC 99.
   760         16  WS-ERROR-SUB        PIC 99.
   761
   762     12  WS-DATE-WORK.
   763         16  WS-WORK-MM          PIC XX.
   764         16  WS-WORK-DD          PIC XX.
   765         16  WS-WORK-YY          PIC XX.
   766
   767     12  WS-MM-YY.
   768         16  WS-MM               PIC XX.
   769         16  FILLER              PIC X     VALUE '/'.
   770         16  WS-YY               PIC XX.
   771
   772     12  WS-CERT-EFF-DT          PIC XX.
   773
   774     12  WS-MEMBER-NO            PIC X(12).
   775     12  FILLER  REDEFINES  WS-MEMBER-NO.
   776         16  WS-MEMBER-NO-1-8    PIC 9(8).
   777         16  FILLER              PIC X(4).
   778
   779     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   780
   781     12  WS-ERPNDB-ALT-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  16
* VP6311.cbl
   782         16  WS-PB-COMPANY-CD-A1         PIC X.
   783         16  WS-PB-CARRIER               PIC X.
   784         16  WS-PB-GROUPING              PIC X(6).
   785         16  WS-PB-STATE                 PIC XX.
   786         16  WS-PB-ACCOUNT               PIC X(10).
   787         16  WS-PB-CERT-EFF-DT           PIC XX.
   788         16  WS-PB-CERT-NO.
   789             20  WS-PB-CERT-PRIME        PIC X(10).
   790             20  WS-PB-CERT-SFX          PIC X.
   791         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   792         16  WS-PB-RECORD-TYPE           PIC X.
   793
   794     12  WS-SHOW-SAVE-AREAS.
   795         16  WS-NEW-CERT-NO.
   796             20  WS-NEW-PRIME    PIC X(10).
   797             20  WS-NEW-SUFFIX   PIC X.
   798         16  WS-NEW-CERT-EFF-DT  PIC XX.
   799         16  WS-NEW-RECORD-TYPE  PIC X.
   800         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   801             88   SHOW-RECORD            VALUE 'Y'.
   802
   803     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   804
   805     12  WS-BATCH-NO.
   806         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   807         16  FILLER              PIC X(5) VALUE SPACES.
   808
   809     12  WS-FIRST-NAME.
   810         16  WS-1ST-INIT         PIC X.
   811         16  FILLER              PIC X(9).
   812
   813     12  WS-INITIALS.
   814         16  WS-INITIAL-1        PIC X.
   815         16  WS-INITIAL-2        PIC X.
   816
   817     12  WS-C-HDG.
   818         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   819         16  FILLER              PIC X(4) VALUE '-REF'.
   820
   821     12  WS-D-PREM-HDG.
   822         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   823         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   824
   825     12  WS-D-REFUND-HDG.
   826         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   827         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   828
   829     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   830
   831     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   832     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   833     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   834     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   835     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   836     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   837     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   838
   839     12  WS-01-CANCEL-ERR        PIC X(25)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  17
* VP6311.cbl
   840         VALUE 'CANCEL DATE ERROR'.
   841     12  WS-02-CANCEL-ERR        PIC X(25)
   842         VALUE 'CERT NOT FOUND'.
   843     12  WS-04-CANCEL-ERR        PIC X(25)
   844         VALUE 'CANCEL AMOUNT ERROR'.
   845     12  WS-05-CANCEL-ERR        PIC X(25)
   846         VALUE 'CANCEL OPTION ERROR'.
   847     12  WS-06-CANCEL-ERR        PIC X(25)
   848         VALUE 'PREVIOUSLY CANCELLED'.
   849     12  WS-07-CANCEL-ERR        PIC X(25)
   850         VALUE 'INVALID DATA'.
   851     12  WS-08-CANCEL-ERR        PIC X(25)
   852         VALUE 'NO ACCOUNT MASTER'.
   853     12  WS-09-CANCEL-ERR        PIC X(25)
   854         VALUE 'SUFFIX ALREADY EXISTS'.
   855     12  WS-99-CANCEL-ERR        PIC X(25)
   856         VALUE 'MISC CANCEL ERROR'.
   857
   858     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   859     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   860
   861     12  WS-AGE-FIELDS.
   862         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   863         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   864         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   865         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   866
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  18
* VP6311.cbl
   868
   869******************************************************************
   870*                                                                *
   871*                 B A T C H   T O T A L S                        *
   872*                                                                *
   873******************************************************************
   874
   875     12  WS-BATCH-RECORD.
   876         16  FILLER                       PIC X(10).
   877         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   878         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   879         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   880         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   881         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   882         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   883         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   884         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   885         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   886         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   887         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   888         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   889         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   890         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   891         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   892         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   893         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   894         16  WS-ACCOUNT-NAME              PIC X(30).
   895         16  FILLER                       PIC X.
   896         16  WS-REFERENCE                 PIC X(12).
   897         16  FILLER                       PIC X(197).
   898
   899     12  WS-BATCH-TOTALS.
   900         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   901         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   902         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   903         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   904         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   905         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   906         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   907         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   908         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   909         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   910         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   911         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   912         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   913         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   914         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   915         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   916         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   917         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   918         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   919
   920     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   921
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  19
* VP6311.cbl
   923
   924******************************************************************
   925*                                                                *
   926*                E R R O R   M E S S A G E S                     *
   927*                                                                *
   928******************************************************************
   929
   930 01  ERROR-MESSAGES.
   931     12  ER-0004                 PIC  9(4) VALUE 0004.
   932     12  ER-0008                 PIC  9(4) VALUE 0008.
   933     12  ER-0023                 PIC  9(4) VALUE 0023.
   934     12  ER-0029                 PIC  9(4) VALUE 0029.
   935     12  ER-0033                 PIC  9(4) VALUE 0033.
   936     12  ER-0070                 PIC  9(4) VALUE 0070.
   937     12  ER-0220                 PIC  9(4) VALUE 0220.
   938     12  ER-0248                 PIC  9(4) VALUE 0248.
   939     12  ER-0280                 PIC  9(4) VALUE 0280.
   940     12  ER-0348                 PIC  9(4) VALUE 0348.
   941     12  ER-0582                 PIC  9(4) VALUE 0582.
   942     12  ER-0877                 PIC  9(4) VALUE 0877.
   943     12  ER-1236                 PIC  9(4) VALUE 1236.
   944     12  ER-1570                 PIC  9(4) VALUE 1570.
   945     12  ER-1575                 PIC  9(4) VALUE 1575.
   946     12  ER-1609                 PIC  9(4) VALUE 1609.
   947     12  ER-1819                 PIC  9(4) VALUE 1819.
   948     12  ER-2077                 PIC  9(4) VALUE 2077.
   949     12  ER-2129                 PIC  9(4) VALUE 2129.
   950     12  ER-2188                 PIC  9(4) VALUE 2188.
   951     12  ER-2192                 PIC  9(4) VALUE 2192.
   952     12  ER-2196                 PIC  9(4) VALUE 2196.
   953     12  ER-2197                 PIC  9(4) VALUE 2197.
   954     12  ER-2198                 PIC  9(4) VALUE 2198.
   955     12  ER-2200                 PIC  9(4) VALUE 2200.
   956     12  ER-2212                 PIC  9(4) VALUE 2212.
   957     12  ER-2218                 PIC  9(4) VALUE 2218.
   958     12  ER-2220                 PIC  9(4) VALUE 2220.
   959     12  ER-2222                 PIC  9(4) VALUE 2222.
   960     12  ER-2223                 PIC  9(4) VALUE 2223.
   961     12  ER-2224                 PIC  9(4) VALUE 2224.
   962     12  ER-2225                 PIC  9(4) VALUE 2225.
   963     12  ER-2226                 PIC  9(4) VALUE 2226.
   964     12  ER-2227                 PIC  9(4) VALUE 2227.
   965     12  ER-2228                 PIC  9(4) VALUE 2228.
   966     12  ER-2240                 PIC  9(4) VALUE 2240.
   967     12  ER-2241                 PIC  9(4) VALUE 2241.
   968     12  ER-2242                 PIC  9(4) VALUE 2242.
   969     12  ER-2243                 PIC  9(4) VALUE 2243.
   970     12  ER-2244                 PIC  9(4) VALUE 2244.
   971     12  ER-2245                 PIC  9(4) VALUE 2245.
   972     12  ER-2246                 PIC  9(4) VALUE 2246.
   973     12  ER-2247                 PIC  9(4) VALUE 2247.
   974     12  ER-2251                 PIC  9(4) VALUE 2251.
   975     12  ER-2252                 PIC  9(4) VALUE 2252.
   976     12  ER-2253                 PIC  9(4) VALUE 2253.
   977     12  ER-2254                 PIC  9(4) VALUE 2254.
   978     12  ER-2255                 PIC  9(4) VALUE 2255.
   979     12  ER-2256                 PIC  9(4) VALUE 2256.
   980     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  20
* VP6311.cbl
   981     12  ER-2258                 PIC  9(4) VALUE 2258.
   982     12  ER-2259                 PIC  9(4) VALUE 2259.
   983     12  ER-2260                 PIC  9(4) VALUE 2260.
   984     12  ER-2261                 PIC  9(4) VALUE 2261.
   985     12  ER-2287                 PIC  9(4) VALUE 2287.
   986     12  ER-2336                 PIC  9(4) VALUE 2336.
   987     12  ER-2337                 PIC  9(4) VALUE 2337.
   988     12  ER-2437                 PIC  9(4) VALUE 2437.
   989     12  ER-2471                 PIC  9(4) VALUE 2471.
   990     12  ER-2530                 PIC  9(4) VALUE 2530.
   991     12  ER-2531                 PIC  9(4) VALUE 2531.
   992     12  ER-2532                 PIC  9(4) VALUE 2532.
   993     12  ER-2533                 PIC  9(4) VALUE 2533.
   994     12  ER-2547                 PIC  9(4) VALUE 2547.
   995     12  ER-2591                 PIC  9(4) VALUE 2591.
   996     12  ER-2592                 PIC  9(4) VALUE 2592.
   997     12  ER-2593                 PIC  9(4) VALUE 2593.
   998     12  ER-2600                 PIC  9(4) VALUE 2600.
   999     12  ER-2601                 PIC  9(4) VALUE 2601.
  1000     12  ER-2604                 PIC  9(4) VALUE 2604.
  1001     12  ER-2605                 PIC  9(4) VALUE 2605.
  1002     12  ER-2606                 PIC  9(4) VALUE 2606.
  1003     12  ER-2607                 PIC  9(4) VALUE 2607.
  1004     12  ER-2622                 PIC  9(4) VALUE 2622.
  1005     12  ER-2625                 PIC  9(4) VALUE 2625.
  1006     12  ER-2626                 PIC  9(4) VALUE 2626.
  1007     12  ER-2627                 PIC  9(4) VALUE 2627.
  1008     12  ER-2628                 PIC  9(4) VALUE 2628.
  1009     12  ER-2629                 PIC  9(4) VALUE 2629.
  1010     12  ER-2630                 PIC  9(4) VALUE 2630.
  1011     12  ER-2631                 PIC  9(4) VALUE 2631.
  1012     12  ER-2632                 PIC  9(4) VALUE 2632.
  1013     12  ER-2633                 PIC  9(4) VALUE 2633.
  1014     12  ER-2634                 PIC  9(4) VALUE 2634.
  1015     12  ER-2635                 PIC  9(4) VALUE 2635.
  1016     12  ER-2636                 PIC  9(4) VALUE 2636.
  1017     12  ER-2639                 PIC  9(4) VALUE 2639.
  1018     12  ER-2640                 PIC  9(4) VALUE 2640.
  1019     12  ER-2647                 PIC  9(4) VALUE 2647.
  1020     12  ER-2648                 PIC  9(4) VALUE 2648.
  1021     12  ER-2649                 PIC  9(4) VALUE 2649.
  1022     12  ER-2650                 PIC  9(4) VALUE 2650.
  1023     12  ER-2653                 PIC  9(4) VALUE 2653.
  1024     12  ER-2654                 PIC  9(4) VALUE 2654.
  1025     12  ER-2655                 PIC  9(4) VALUE 2655.
  1026     12  ER-2656                 PIC  9(4) VALUE 2656.
  1027     12  ER-2657                 PIC  9(4) VALUE 2657.
  1028     12  ER-2660                 PIC  9(4) VALUE 2660.
  1029     12  ER-2661                 PIC  9(4) VALUE 2661.
  1030     12  ER-2662                 PIC  9(4) VALUE 2662.
  1031     12  ER-2663                 PIC  9(4) VALUE 2663.
  1032     12  ER-2664                 PIC  9(4) VALUE 2664.
  1033     12  ER-2667                 PIC  9(4) VALUE 2667.
  1034     12  ER-2668                 PIC  9(4) VALUE 2668.
  1035     12  ER-2669                 PIC  9(4) VALUE 2669.
  1036     12  ER-2670                 PIC  9(4) VALUE 2670.
  1037     12  ER-2671                 PIC  9(4) VALUE 2671.
  1038     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  21
* VP6311.cbl
  1039     12  ER-2673                 PIC  9(4) VALUE 2673.
  1040     12  ER-2677                 PIC  9(4) VALUE 2677.
  1041     12  ER-2678                 PIC  9(4) VALUE 2678.
  1042     12  ER-2679                 PIC  9(4) VALUE 2679.
  1043     12  ER-2680                 PIC  9(4) VALUE 2680.
  1044     12  ER-2681                 PIC  9(4) VALUE 2681.
  1045     12  ER-2682                 PIC  9(4) VALUE 2682.
  1046     12  ER-2683                 PIC  9(4) VALUE 2683.
  1047     12  ER-2684                 PIC  9(4) VALUE 2684.
  1048     12  ER-2686                 PIC  9(4) VALUE 2686.
  1049     12  ER-2689                 PIC  9(4) VALUE 2689.
  1050     12  ER-2690                 PIC  9(4) VALUE 2690.
  1051     12  ER-2693                 PIC  9(4) VALUE 2693.
  1052     12  ER-2695                 PIC  9(4) VALUE 2695.
  1053     12  ER-2701                 PIC  9(4) VALUE 2701.
  1054     12  ER-2720                 PIC  9(4) VALUE 2720.
  1055     12  ER-2709                 PIC  9(4) VALUE 2709.
  1056     12  ER-2704                 PIC  9(4) VALUE 2704.
  1057     12  ER-2725                 PIC  9(4) VALUE 2725.
  1058     12  ER-2726                 PIC  9(4) VALUE 2726.
  1059     12  ER-2728                 PIC  9(4) VALUE 2728.
  1060     12  ER-2729                 PIC  9(4) VALUE 2729.
  1061     12  ER-2731                 PIC  9(4) VALUE 2731.
  1062     12  ER-2732                 PIC  9(4) VALUE 2732.
  1063     12  ER-2733                 PIC  9(4) VALUE 2733.
  1064     12  ER-2735                 PIC  9(4) VALUE 2735.
  1065     12  ER-2738                 PIC  9(4) VALUE 2738.
  1066     12  ER-2742                 PIC  9(4) VALUE 2742.
  1067     12  ER-2743                 PIC  9(4) VALUE 2743.
  1068     12  ER-2744                 PIC  9(4) VALUE 2744.
  1069     12  ER-2747                 PIC  9(4) VALUE 2747.
  1070     12  ER-2749                 PIC  9(4) VALUE 2749.
  1071     12  ER-2753                 PIC  9(4) VALUE 2753.
  1072     12  ER-2755                 PIC  9(4) VALUE 2755.
  1073     12  ER-2757                 PIC  9(4) VALUE 2757.
  1074     12  ER-2771                 PIC  9(4) VALUE 2771.
  1075     12  ER-2774                 PIC  9(4) VALUE 2774.
  1076     12  ER-2775                 PIC  9(4) VALUE 2775.
  1077     12  ER-2776                 PIC  9(4) VALUE 2776.
  1078     12  ER-2777                 PIC  9(4) VALUE 2777.
  1079     12  ER-2794                 PIC  9(4) VALUE 2794.
  1080     12  ER-2799                 PIC  9(4) VALUE 2799.
  1081     12  ER-2900                 PIC  9(4) VALUE 2900.
  1082     12  ER-2902                 PIC  9(4) VALUE 2902.
  1083     12  ER-2945                 PIC  9(4) VALUE 2945.
  1084     12  ER-3000                 PIC  9(4) VALUE 3000.
  1085     12  ER-3006                 PIC  9(4) VALUE 3006.
  1086     12  ER-3054                 PIC  9(4) VALUE 3054.
  1087     12  ER-3224                 PIC  9(4) VALUE 3224.
  1088     12  ER-3269                 PIC  9(4) VALUE 3269.
  1089     12  er-3444                 pic  9(4) value 3444.
  1090     12  er-3446                 pic  9(4) value 3446.
  1091     12  er-3447                 pic  9(4) value 3447.
  1092     12  er-3448                 pic  9(4) value 3448.
  1093     12  er-3449                 pic  9(4) value 3449.
  1094     12  ER-3456                 PIC  9(4) VALUE 3456.
  1095     12  ER-3457                 PIC  9(4) VALUE 3457.
  1096     12  ER-3458                 PIC  9(4) VALUE 3458.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  22
* VP6311.cbl
  1097     12  ER-3504                 PIC  9(4) VALUE 3504.
  1098     12  ER-3513                 PIC  9(4) VALUE 3513.
  1099     12  ER-3831                 PIC  9(4) VALUE 3831.
  1100     12  ER-3834                 PIC  9(4) VALUE 3834.
  1101     12  ER-3835                 PIC  9(4) VALUE 3835.
  1102     12  ER-4005                 PIC  9(4) VALUE 4005.
  1103     12  ER-7144                 PIC  9(4) VALUE 7144.
  1104     12  ER-7401                 PIC  9(4) VALUE 7401.
  1105     12  ER-7402                 PIC  9(4) VALUE 7402.
  1106     12  ER-7403                 PIC  9(4) VALUE 7403.
  1107     12  ER-7404                 PIC  9(4) VALUE 7404.
  1108     12  ER-7423                 PIC  9(4) VALUE 7423.
  1109     12  ER-7424                 PIC  9(4) VALUE 7424.
  1110     12  ER-7433                 PIC  9(4) VALUE 7433.
  1111     12  ER-7450                 PIC  9(4) VALUE 7450.
  1112     12  ER-7451                 PIC  9(4) VALUE 7451.
  1113     12  ER-7530                 PIC  9(4) VALUE 7530.
  1114     12  ER-7573                 PIC  9(4) VALUE 7573.
  1115     12  ER-7631                 PIC  9(4) VALUE 7631.
  1116     12  ER-7632                 PIC  9(4) VALUE 7632.
  1117     12  ER-7633                 PIC  9(4) VALUE 7633.
  1118     12  ER-7537                 PIC  9(4) VALUE 7537.
  1119     12  ER-7538                 PIC  9(4) VALUE 7538.
  1120     12  ER-7574                 PIC  9(4) VALUE 7574.
  1121     12  ER-7997                 PIC  9(4) VALUE 7997.
  1122     12  ER-7998                 PIC  9(4) VALUE 7998.
  1123     12  ER-8148                 PIC  9(4) VALUE 8148.
  1124     12  ER-9063                 PIC  9(4) VALUE 9063.
  1125     12  ER-9076                 PIC  9(4) VALUE 9076.
  1126     12  ER-9618                 PIC  9(4) VALUE 9618.
  1127     12  ER-9841                 PIC  9(4) VALUE 9841.
  1128
  1129*                                COPY ELCTEXT.
  1130******************************************************************
  1131*                                                                *
  1132*                                                                *
  1133*                            ELCTEXT.                            *
  1134*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1135*                            VMOD=2.008                          *
  1136*                                                                *
  1137*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1138*                                     FORM LETTERS,              *
  1139*                                     CERT FORM DISPLAY.
  1140*                                                                *
  1141*   FILE TYPE = VSAM,KSDS                                        *
  1142*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1143*                                                                *
  1144*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1145*       ALTERNATE INDEX = NONE                                   *
  1146*                                                                *
  1147*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1148*       ALTERNATE INDEX = NONE                                   *
  1149*                                                                *
  1150*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1151*       ALTERNATE INDEX = NONE                                   *
  1152*                                                                *
  1153*   LOG = NO                                                     *
  1154*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  23
* VP6311.cbl
  1155******************************************************************
  1156 01  TEXT-FILES.
  1157     12  TEXT-FILE-ID                PIC XX.
  1158         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1159         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1160         88  HELP-FILE-TEXT             VALUE 'TH'.
  1161
  1162     12  TX-CONTROL-PRIMARY.
  1163         16  TX-COMPANY-CD           PIC X.
  1164             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1165         16  TX-ACCESS-CD-GENL       PIC X(12).
  1166
  1167         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1168             20  TX-LETTER-NO        PIC X(4).
  1169             20  FILLER              PIC X(8).
  1170
  1171         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1172             20  TX-FORM-NO          PIC X(12).
  1173
  1174         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1175             20  TX-HELP-TYPE        PIC X.
  1176                 88  HELP-FOR-GENERAL   VALUE ' '.
  1177                 88  HELP-BY-SCREEN     VALUE 'S'.
  1178                 88  HELP-BY-ERROR      VALUE 'E'.
  1179             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1180                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1181             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1182                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1183             20  FILLER              PIC X(4).
  1184
  1185         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1186
  1187     12  TX-PROCESS-CONTROL          PIC XX.
  1188         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1189
  1190     12  TX-TEXT-LINE                PIC X(70).
  1191
  1192     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1193         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1194         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1195         88  TX-VALID-FORM-SQUEEZE-VALUE
  1196                                        VALUE 'Y' ' '.
  1197
  1198     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1199         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1200         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1201         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1202         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1203         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1204         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1205         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1206                                              'K' 'N' ' '
  1207                                              'Z'.
  1208
  1209     12  TX-ARCHIVE-SW               PIC X.
  1210         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1211         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1212         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  24
* VP6311.cbl
  1213
  1214     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1215     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1216
  1217     12  TX-BSR-CODE                 PIC X.
  1218         88  TX-BSR-LETTER              VALUE 'B'.
  1219         88  TX-NON-BSR-LETTER          VALUE ' '.
  1220
  1221     12  FILLER                      PIC X.
  1222*****************************************************************
  1223*                                COPY ELCCRTO.
  1224******************************************************************
  1225*                                                                *
  1226*                            ELCCRTO.                            *
  1227*                                                                *
  1228*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1229*                                                                *
  1230*   FILE TYPE = VSAM,KSDS                                        *
  1231*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1232*                                                                *
  1233*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1234*                                                                *
  1235*   LOG = YES                                                    *
  1236*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1237******************************************************************
  1238*                   C H A N G E   L O G
  1239*
  1240* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1241*-----------------------------------------------------------------
  1242*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1243* EFFECTIVE    NUMBER
  1244*-----------------------------------------------------------------
  1245* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1246* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1247* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1248* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1249* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1250******************************************************************
  1251 01  ORIGINAL-CERTIFICATE.
  1252     12  OC-RECORD-ID                      PIC XX.
  1253         88  VALID-OC-ID                      VALUE 'OC'.
  1254     12  OC-CONTROL-PRIMARY.
  1255         16  OC-COMPANY-CD                 PIC X.
  1256         16  OC-CARRIER                    PIC X.
  1257         16  OC-GROUPING                   PIC X(6).
  1258         16  OC-STATE                      PIC XX.
  1259         16  OC-ACCOUNT                    PIC X(10).
  1260         16  OC-CERT-EFF-DT                PIC XX.
  1261         16  OC-CERT-NO.
  1262             20  OC-CERT-PRIME             PIC X(10).
  1263             20  OC-CERT-SFX               PIC X.
  1264         16  OC-RECORD-TYPE                PIC X.
  1265         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1266     12  OC-LAST-MAINT-DT                  PIC XX.
  1267     12  OC-LAST-MAINT-BY                  PIC X(4).
  1268     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1269     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1270     12  FILLER                            PIC X(49).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  25
* VP6311.cbl
  1271     12  OC-ORIG-REC.
  1272         16  OC-INS-LAST-NAME              PIC X(15).
  1273         16  OC-INS-FIRST-NAME             PIC X(10).
  1274         16  OC-INS-MIDDLE-INIT            PIC X.
  1275         16  OC-INS-AGE                    PIC S999     COMP-3.
  1276         16  OC-JNT-LAST-NAME              PIC X(15).
  1277         16  OC-JNT-FIRST-NAME             PIC X(10).
  1278         16  OC-JNT-MIDDLE-INIT            PIC X.
  1279         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1280         16  OC-LF-BENCD                   PIC XX.
  1281         16  OC-LF-TERM                    PIC S999      COMP-3.
  1282         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1283         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1284         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1285         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1286         16  OC-LF-EXP-DT                  PIC XX.
  1287         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1288         16  OC-LF-CANCEL-DT               PIC XX.
  1289         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1290         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1291         16  OC-AH-BENCD                   PIC XX.
  1292         16  OC-AH-TERM                    PIC S999      COMP-3.
  1293         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1294         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1295         16  OC-AH-EXP-DT                  PIC XX.
  1296         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1297         16  OC-AH-CP                      PIC 99.
  1298         16  OC-AH-CANCEL-DT               PIC XX.
  1299         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1300         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1301         16  OC-CRED-BENE-NAME             PIC X(25).
  1302         16  OC-1ST-PMT-DT                 PIC XX.
  1303         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1304         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1305         16  OC-ISSUE-TRAN-IND             PIC X.
  1306         16  OC-CANCEL-TRAN-IND            PIC X.
  1307         16  FILLER                        PIC X(211).
  1308
  1309     12  FILLER                            PIC X(50).
  1310******************************************************************
  1311*                                COPY ERCACCT.
  1312******************************************************************
  1313*                                                                *
  1314*                                                                *
  1315*                            ERCACCT                             *
  1316*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1317*                            VMOD=2.031                          *
  1318*                                                                *
  1319*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1320*                                                                *
  1321*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1322*   VSAM ACCOUNT MASTER FILES.                                   *
  1323*                                                                *
  1324*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1325*                                                                *
  1326*   FILE TYPE = VSAM,KSDS                                        *
  1327*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1328*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  26
* VP6311.cbl
  1329*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1330*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1331*                                                                *
  1332*   LOG = NO                                                     *
  1333*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1334*                                                                *
  1335*                                                                *
  1336******************************************************************
  1337*                   C H A N G E   L O G
  1338*
  1339* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1340*-----------------------------------------------------------------
  1341*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1342* EFFECTIVE    NUMBER
  1343*-----------------------------------------------------------------
  1344* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1345* 092705    2005050300006  PEMA  ADD SPP LEASES
  1346* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1347* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1348* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1349* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1350* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1351* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1352******************************************************************
  1353
  1354 01  ACCOUNT-MASTER.
  1355     12  AM-RECORD-ID                      PIC XX.
  1356         88  VALID-AM-ID                      VALUE 'AM'.
  1357
  1358     12  AM-CONTROL-PRIMARY.
  1359         16  AM-COMPANY-CD                 PIC X.
  1360         16  AM-MSTR-CNTRL.
  1361             20  AM-CONTROL-A.
  1362                 24  AM-CARRIER            PIC X.
  1363                 24  AM-GROUPING.
  1364                     28 AM-GROUPING-PREFIX PIC XXX.
  1365                     28 AM-GROUPING-PRIME  PIC XXX.
  1366                 24  AM-STATE              PIC XX.
  1367                 24  AM-ACCOUNT.
  1368                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1369                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1370             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1371                                           PIC X(19).
  1372             20  AM-CNTRL-B.
  1373                 24  AM-EXPIRATION-DT      PIC XX.
  1374                 24  FILLER                PIC X(4).
  1375             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1376                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1377
  1378     12  AM-CONTROL-BY-VAR-GRP.
  1379         16  AM-COMPANY-CD-A1              PIC X.
  1380         16  AM-VG-CARRIER                 PIC X.
  1381         16  AM-VG-GROUPING                PIC X(6).
  1382         16  AM-VG-STATE                   PIC XX.
  1383         16  AM-VG-ACCOUNT                 PIC X(10).
  1384         16  AM-VG-DATE.
  1385             20  AM-VG-EXPIRATION-DT       PIC XX.
  1386             20  FILLER                    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  27
* VP6311.cbl
  1387         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1388                                           PIC 9(11)      COMP-3.
  1389     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1390         16  FILLER                        PIC X(10).
  1391         16  AM-VG-KEY3.
  1392             20  AM-VG3-ACCOUNT            PIC X(10).
  1393             20  AM-VG3-EXP-DT             PIC XX.
  1394         16  FILLER                        PIC X(4).
  1395     12  AM-MAINT-INFORMATION.
  1396         16  AM-LAST-MAINT-DT              PIC XX.
  1397         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1398         16  AM-LAST-MAINT-USER            PIC X(4).
  1399         16  FILLER                        PIC XX.
  1400
  1401     12  AM-EFFECTIVE-DT                   PIC XX.
  1402     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1403
  1404     12  AM-PREV-DATES  COMP-3.
  1405         16  AM-PREV-EXP-DT                PIC 9(11).
  1406         16  AM-PREV-EFF-DT                PIC 9(11).
  1407
  1408     12  AM-REPORT-CODE-1                  PIC X(10).
  1409     12  AM-REPORT-CODE-2                  PIC X(10).
  1410
  1411     12  AM-CITY-CODE                      PIC X(4).
  1412     12  AM-COUNTY-PARISH                  PIC X(6).
  1413
  1414     12  AM-NAME                           PIC X(30).
  1415     12  AM-PERSON                         PIC X(30).
  1416     12  AM-ADDRS                          PIC X(30).
  1417     12  AM-CITY.
  1418         16  AM-ADDR-CITY                  PIC X(28).
  1419         16  AM-ADDR-STATE                 PIC XX.
  1420     12  AM-ZIP.
  1421         16  AM-ZIP-PRIME.
  1422             20  AM-ZIP-PRI-1ST            PIC X.
  1423                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1424             20  FILLER                    PIC X(4).
  1425         16  AM-ZIP-PLUS4                  PIC X(4).
  1426     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1427         16  AM-CAN-POSTAL-1               PIC XXX.
  1428         16  AM-CAN-POSTAL-2               PIC XXX.
  1429         16  FILLER                        PIC XXX.
  1430     12  AM-TEL-NO.
  1431         16  AM-AREA-CODE                  PIC 999.
  1432         16  AM-TEL-PRE                    PIC 999.
  1433         16  AM-TEL-NBR                    PIC 9(4).
  1434     12  AM-TEL-LOC                        PIC X.
  1435         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1436         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1437
  1438     12  AM-COMM-STRUCTURE.
  1439         16  AM-DEFN-1.
  1440             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1441                 24  AM-AGT.
  1442                     28  AM-AGT-PREFIX     PIC X(4).
  1443                     28  AM-AGT-PRIME      PIC X(6).
  1444                 24  AM-COM-TYP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  28
* VP6311.cbl
  1445                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1446                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1447                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1448                 24  AM-RECALC-LV-INDIC    PIC X.
  1449                 24  AM-RETRO-LV-INDIC     PIC X.
  1450                 24  AM-GL-CODES           PIC X.
  1451                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1452                 24  FILLER                PIC X(01).
  1453         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1454             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1455                 24  FILLER                PIC X(11).
  1456                 24  AM-L-COMA             PIC XXX.
  1457                 24  AM-J-COMA             PIC XXX.
  1458                 24  AM-A-COMA             PIC XXX.
  1459                 24  FILLER                PIC X(6).
  1460
  1461     12  AM-COMM-CHANGE-STATUS             PIC X.
  1462         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1463
  1464     12  AM-CSR-CODE                       PIC X(4).
  1465
  1466     12  AM-BILLING-STATUS                 PIC X.
  1467         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1468         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1469     12  AM-AUTO-REFUND-SW                 PIC X.
  1470         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1471         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1472     12  AM-GPCD                           PIC 99.
  1473     12  AM-IG                             PIC X.
  1474         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1475         88  AM-HAS-GROUP                     VALUE '2'.
  1476     12  AM-STATUS                         PIC X.
  1477         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1478         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1479         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1480         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1481         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1482         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1483         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1484         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1485         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1486         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1487     12  AM-REMIT-TO                       PIC 99.
  1488     12  AM-ID-NO                          PIC X(11).
  1489
  1490     12  AM-CAL-TABLE                      PIC XX.
  1491     12  AM-LF-DEVIATION                   PIC XXX.
  1492     12  AM-AH-DEVIATION                   PIC XXX.
  1493     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1494     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1495     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1496     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1497     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1498     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1499
  1500     12  AM-USER-FIELDS.
  1501         16  AM-FLD-1                      PIC XX.
  1502         16  AM-FLD-2                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  29
* VP6311.cbl
  1503         16  AM-FLD-3                      PIC XX.
  1504         16  AM-FLD-4                      PIC XX.
  1505         16  AM-FLD-5                      PIC XX.
  1506
  1507     12  AM-1ST-PROD-DATE.
  1508         16  AM-1ST-PROD-YR                PIC XX.
  1509         16  AM-1ST-PROD-MO                PIC XX.
  1510         16  AM-1ST-PROD-DA                PIC XX.
  1511     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1512     12  AM-CERTS-PURGED-DATE.
  1513         16  AM-PUR-YR                     PIC XX.
  1514         16  AM-PUR-MO                     PIC XX.
  1515         16  AM-PUR-DA                     PIC XX.
  1516     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1517     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1518     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1519     12  AM-INACTIVE-DATE.
  1520         16  AM-INA-MO                     PIC 99.
  1521         16  AM-INA-DA                     PIC 99.
  1522         16  AM-INA-YR                     PIC 99.
  1523     12  AM-AR-HI-CERT-DATE                PIC XX.
  1524
  1525     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1526     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1527
  1528     12  AM-OB-PAYMENT-MODE                PIC X.
  1529         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1530         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1531         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1532         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1533
  1534     12  AM-AH-ONLY-INDICATOR              PIC X.
  1535         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1536         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1537
  1538     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1539
  1540     12  AM-OVER-SHORT.
  1541         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1542         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1543
  1544     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1545     12  AM-DCC-CLP-STATE                  PIC XX.
  1546
  1547     12  AM-RECALC-COMM                    PIC X.
  1548     12  AM-RECALC-REIN                    PIC X.
  1549
  1550     12  AM-REI-TABLE                      PIC XXX.
  1551     12  AM-REI-ET-LF                      PIC X.
  1552     12  AM-REI-ET-AH                      PIC X.
  1553     12  AM-REI-PE-LF                      PIC X.
  1554     12  AM-REI-PE-AH                      PIC X.
  1555     12  AM-REI-PRT-ST                     PIC X.
  1556     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1557     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1558     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1559     12  AM-REI-GROUP-A                    PIC X(6).
  1560     12  AM-REI-MORT                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  30
* VP6311.cbl
  1561     12  AM-REI-PRT-OW                     PIC X.
  1562     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1563     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1564     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1565     12  AM-REI-GROUP-B                    PIC X(6).
  1566
  1567     12  AM-TRUST-TYPE                     PIC X(2).
  1568
  1569     12  AM-EMPLOYER-STMT-USED             PIC X.
  1570     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1571
  1572     12  AM-STD-AH-TYPE                    PIC XX.
  1573     12  AM-EARN-METHODS.
  1574         16  AM-EARN-METHOD-R              PIC X.
  1575             88 AM-REF-RL-R78                 VALUE 'R'.
  1576             88 AM-REF-RL-PR                  VALUE 'P'.
  1577             88 AM-REF-RL-MEAN                VALUE 'M'.
  1578             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1579         16  AM-EARN-METHOD-L              PIC X.
  1580             88 AM-REF-LL-R78                 VALUE 'R'.
  1581             88 AM-REF-LL-PR                  VALUE 'P'.
  1582             88 AM-REF-LL-MEAN                VALUE 'M'.
  1583             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1584         16  AM-EARN-METHOD-A              PIC X.
  1585             88 AM-REF-AH-R78                 VALUE 'R'.
  1586             88 AM-REF-AH-PR                  VALUE 'P'.
  1587             88 AM-REF-AH-MEAN                VALUE 'M'.
  1588             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1589             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1590             88 AM-REF-AH-NET                 VALUE 'N'.
  1591
  1592     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1593     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1594     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1595
  1596     12  AM-RET-Y-N                        PIC X.
  1597     12  AM-RET-P-E                        PIC X.
  1598     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1599     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1600     12  AM-RET-GRP                        PIC X(6).
  1601     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1602         16  AM-POOL-PRIME                 PIC XXX.
  1603         16  AM-POOL-SUB                   PIC XXX.
  1604     12  AM-RETRO-EARNINGS.
  1605         16  AM-RET-EARN-R                 PIC X.
  1606         16  AM-RET-EARN-L                 PIC X.
  1607         16  AM-RET-EARN-A                 PIC X.
  1608     12  AM-RET-ST-TAX-USE                 PIC X.
  1609         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1610         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1611     12  AM-RETRO-BEG-EARNINGS.
  1612         16  AM-RET-BEG-EARN-R             PIC X.
  1613         16  AM-RET-BEG-EARN-L             PIC X.
  1614         16  AM-RET-BEG-EARN-A             PIC X.
  1615     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1616     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1617
  1618     12  AM-USER-SELECT-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  31
* VP6311.cbl
  1619         16  AM-USER-SELECT-1              PIC X(10).
  1620         16  AM-USER-SELECT-2              PIC X(10).
  1621         16  AM-USER-SELECT-3              PIC X(10).
  1622         16  AM-USER-SELECT-4              PIC X(10).
  1623         16  AM-USER-SELECT-5              PIC X(10).
  1624
  1625     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1626
  1627     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1628
  1629     12  AM-RPT045A-SWITCH                 PIC X.
  1630         88  RPT045A-OFF                   VALUE 'N'.
  1631
  1632     12  AM-INSURANCE-LIMITS.
  1633         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1634         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1635
  1636     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1637         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1638
  1639     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1640         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1641         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1642
  1643     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1644
  1645     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1646     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1647     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1648     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1649     12  AM-DCC-UEF-STATE                  PIC XX.
  1650     12  FILLER                            PIC XXX.
  1651     12  AM-REPORT-CODE-3                  PIC X(10).
  1652*    12  FILLER                            PIC X(22).
  1653
  1654     12  AM-RESERVE-DATE.
  1655         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1656         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1657         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1658
  1659     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1660     12  AM-NOTIFICATION-TYPES.
  1661         16  AM-NOTIF-OF-LETTERS           PIC X.
  1662         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1663         16  AM-NOTIF-OF-REPORTS           PIC X.
  1664         16  AM-NOTIF-OF-STATUS            PIC X.
  1665
  1666     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1667         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1668         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1669         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1670         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1671
  1672     12  AM-BENEFIT-CONTROLS.
  1673         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1674             20  AM-BENEFIT-CODE           PIC XX.
  1675             20  AM-BENEFIT-TYPE           PIC X.
  1676             20  AM-BENEFIT-REVISION       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  32
* VP6311.cbl
  1677             20  AM-BENEFIT-REM-TERM       PIC X.
  1678             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1679             20  FILLER                    PIC XX.
  1680         16  FILLER                        PIC X(80).
  1681
  1682     12  AM-TRANSFER-DATA.
  1683         16  AM-TRANSFERRED-FROM.
  1684             20  AM-TRNFROM-CARRIER        PIC X.
  1685             20  AM-TRNFROM-GROUPING.
  1686                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1687                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1688             20  AM-TRNFROM-STATE          PIC XX.
  1689             20  AM-TRNFROM-ACCOUNT.
  1690                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1691                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1692             20  AM-TRNFROM-DTE            PIC XX.
  1693         16  AM-TRANSFERRED-TO.
  1694             20  AM-TRNTO-CARRIER          PIC X.
  1695             20  AM-TRNTO-GROUPING.
  1696                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1697                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1698             20  AM-TRNTO-STATE            PIC XX.
  1699             20  AM-TRNTO-ACCOUNT.
  1700                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1701                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1702             20  AM-TRNTO-DTE              PIC XX.
  1703         16  FILLER                        PIC X(10).
  1704
  1705     12  AM-SAVED-REMIT-TO                 PIC 99.
  1706
  1707     12  AM-COMM-STRUCTURE-SAVED.
  1708         16  AM-DEFN-1-SAVED.
  1709             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1710                 24  AM-AGT-SV             PIC X(10).
  1711                 24  AM-COM-TYP-SV         PIC X.
  1712                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1713                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1714                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1715                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1716                 24  FILLER                PIC X.
  1717                 24  AM-GL-CODES-SV        PIC X.
  1718                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1719                 24  FILLER                PIC X.
  1720         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1721             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1722                 24  FILLER                PIC X(11).
  1723                 24  AM-L-COMA-SV          PIC XXX.
  1724                 24  AM-J-COMA-SV          PIC XXX.
  1725                 24  AM-A-COMA-SV          PIC XXX.
  1726                 24  FILLER                PIC X(6).
  1727
  1728     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1729         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1730            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1731            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1732            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1733
  1734     12  AM-ORIG-DEALER-NO                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  33
* VP6311.cbl
  1735     12  FILLER                            PIC X(120).
  1736
  1737     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1738         16  AM-CONTROL-NAME               PIC X(30).
  1739         16  AM-EXECUTIVE-ONE.
  1740             20  AM-EXEC1-NAME             PIC X(15).
  1741             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1742                                                          COMP-3.
  1743             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1744                                                          COMP-3.
  1745         16  AM-EXECUTIVE-TWO.
  1746             20  AM-EXEC2-NAME             PIC X(15).
  1747             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1748                                                          COMP-3.
  1749             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1750                                                          COMP-3.
  1751
  1752     12  AM-RETRO-ADDITIONAL-DATA.
  1753         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1754         16  AM-RETRO-PREM-P-E             PIC X.
  1755         16  AM-RETRO-CLMS-P-I             PIC X.
  1756         16  AM-RETRO-RET-BRACKET-LF.
  1757             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1758                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1759                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1760             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1761                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1762                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1763             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1764                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1765                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1766         16  AM-RETRO-RET-BRACKET-AH.
  1767             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1768                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1769                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1770                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1771             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1772                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1773                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1774             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1775                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1776                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1777
  1778     12  AM-COMMENTS.
  1779         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1780
  1781     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1782         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1783         16  AM-FLI-BILLING-CODE           PIC X.
  1784         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1785         16  AM-FLI-UNITED-IDENT           PIC X.
  1786         16  AM-FLI-INTEREST-LOST-DATA.
  1787             20  AM-FLI-BANK-NO            PIC X(5).
  1788             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1789             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1790             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1791         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1792             20  AM-FLI-AGT                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  34
* VP6311.cbl
  1793             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1794             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1795         16  FILLER                        PIC X(102).
  1796
  1797     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1798         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1799             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1800             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1801             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1802             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1803             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1804         16  FILLER                          PIC X(10).
  1805******************************************************************
  1806*                                COPY ELCVADS.
  1807******************************************************************
  1808*                                                                *
  1809*                                                                *
  1810*                            ELCVADS.                            *
  1811*                                                                *
  1812*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1813*   ELVADS                  LENGTH = 350                         *
  1814******************************************************************
  1815******************************************************************
  1816*                   C H A N G E   L O G
  1817*
  1818* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1819*-----------------------------------------------------------------
  1820*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1821* EFFECTIVE    NUMBER
  1822*-----------------------------------------------------------------
  1823* 100111    2011022800001  AJRA  NAPERSOFT
  1824******************************************************************
  1825
  1826 01  VIRGINIA-DISCLOSURE.
  1827     12  VD-COMPANY-CD              PIC X.
  1828     12  VD-CARRIER                 PIC X.
  1829     12  VD-GROUPING.
  1830         20  VD-GROUPING-PREFIX     PIC XXX.
  1831         20  VD-GROUPING-PRIME      PIC XXX.
  1832     12  VD-STATE                   PIC XX.
  1833     12  VD-ACCOUNT.
  1834         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1835         20  VD-ACCOUNT-PRIME       PIC X(6).
  1836     12  VD-CERT-EFF-DT             PIC XX.
  1837     12  VD-CERT-NO.
  1838         20  VD-CERT-PRIME          PIC X(10).
  1839         20  VD-CERT-SFX            PIC X.
  1840     12  VD-ENTRY-BATCH             PIC X(6).
  1841     12  VD-CSR-ID                  PIC X(4).
  1842     12  VD-NAME.
  1843         20  VD-INSURED-LAST-NAME   PIC X(15).
  1844         20  VD-INSURED-FIRST-NAME.
  1845             24  VD-INSURED-1ST-INIT PIC X.
  1846             24  FILLER             PIC X(9).
  1847         20  VD-INSURED-MIDDLE-INIT PIC X.
  1848     12  VD-JOINT-INSURED.
  1849         20 VD-JOINT-LAST-NAME      PIC X(15).
  1850         20 VD-JOINT-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  35
* VP6311.cbl
  1851            24  VD-JOINT-FIRST-INIT PIC X.
  1852            24  FILLER              PIC X(9).
  1853         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1854     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1855     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1856     12  VD-INSURED-CITY-STATE.
  1857         20  VD-INSURED-CITY        PIC X(28).
  1858         20  VD-INSURED-STATE       PIC XX.
  1859     12  VD-INSURED-ZIP-CODE.
  1860         20  VD-INSURED-ZIP-PRIME.
  1861             24  VD-INSURED-ZIP-1   PIC X.
  1862                 88  VD-CANADIAN-POST-CODE
  1863                                       VALUE 'A' THRU 'Z'.
  1864             24  FILLER             PIC X(4).
  1865         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1866     12  VD-BENEFICIARY-NAME        PIC X(30).
  1867     12  VD-ACCOUNT-NAME            PIC X(30).
  1868     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1869     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1870     12  VD-1ST-PMT-DT              PIC XX.
  1871     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1872         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1873         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1874                                             '90' THRU '99'.
  1875     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1876                                    PIC XX.
  1877     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1878     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1879     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1880     12  VD-LF-TERM                 PIC S999   COMP-3.
  1881     12  VD-AH-BENEFIT-CD           PIC XX.
  1882         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1883         88  VD-INVALID-AH             VALUE '  ' '00'
  1884                                             '90' THRU '99'.
  1885     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1886     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1887     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1888     12  VD-AH-TERM                 PIC S999   COMP-3.
  1889     12  VD-LETTER-ID               PIC X(4).
  1890     12  VD-PROC-ID                 PIC X(4).
  1891     12  VD-COMP-ID                 PIC X(3).
  1892     12  VD-CURRENT-DATE            PIC XX.
  1893     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1894     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1895     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  36
* VP6311.cbl
  1897*    COPY ELCDATE.
  1898******************************************************************
  1899*                                                                *
  1900*                                                                *
  1901*                            ELCDATE.                            *
  1902*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1903*                            VMOD=2.003
  1904*                                                                *
  1905*                                                                *
  1906*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1907*                 LENGTH = 200                                   *
  1908******************************************************************
  1909
  1910 01  DATE-CONVERSION-DATA.
  1911     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1912     12  DC-OPTION-CODE                PIC X.
  1913         88  BIN-TO-GREG                VALUE ' '.
  1914         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1915         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1916         88  YMD-GREG-TO-BIN            VALUE '3'.
  1917         88  MDY-GREG-TO-BIN            VALUE '4'.
  1918         88  JULIAN-TO-BIN              VALUE '5'.
  1919         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1920         88  FIND-CENTURY               VALUE '7'.
  1921         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1922         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1923         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1924         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1925         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1926         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1927         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1928         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1929         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1930         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1931         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1932         88  BIN-3-TO-GREG              VALUE 'I'.
  1933         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1934         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1935         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1936         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1937         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1938         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1939         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1940         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1941         88  THREE-CHARACTER-BIN
  1942                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1943         88  GREGORIAN-TO-BIN
  1944                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1945         88  BIN-TO-GREGORIAN
  1946                  VALUES ' ' '1' 'I' '8' 'G'.
  1947         88  JULIAN-TO-BINARY
  1948                  VALUES '5' 'C' 'E' 'F'.
  1949     12  DC-ERROR-CODE                 PIC X.
  1950         88  NO-CONVERSION-ERROR        VALUE ' '.
  1951         88  DATE-CONVERSION-ERROR
  1952                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1953         88  DATE-IS-ZERO               VALUE '1'.
  1954         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  37
* VP6311.cbl
  1955         88  DATE-IS-INVALID            VALUE '3'.
  1956         88  DATE1-GREATER-DATE2        VALUE '4'.
  1957         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1958         88  DATE-INVALID-OPTION        VALUE '9'.
  1959         88  INVALID-CENTURY            VALUE 'A'.
  1960         88  ONLY-CENTURY               VALUE 'B'.
  1961         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1962         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1963     12  DC-END-OF-MONTH               PIC X.
  1964         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1965     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1966         88  USE-NORMAL-PROCESS         VALUE ' '.
  1967         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1968         88  ADJUST-UP-100-YRS          VALUE '2'.
  1969     12  FILLER                        PIC X.
  1970     12  DC-CONVERSION-DATES.
  1971         16  DC-BIN-DATE-1             PIC XX.
  1972         16  DC-BIN-DATE-2             PIC XX.
  1973         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1974         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1975                       DC-GREG-DATE-1-EDIT.
  1976             20  DC-EDIT1-MONTH        PIC 99.
  1977             20  SLASH1-1              PIC X.
  1978             20  DC-EDIT1-DAY          PIC 99.
  1979             20  SLASH1-2              PIC X.
  1980             20  DC-EDIT1-YEAR         PIC 99.
  1981         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1982         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1983                     DC-GREG-DATE-2-EDIT.
  1984             20  DC-EDIT2-MONTH        PIC 99.
  1985             20  SLASH2-1              PIC X.
  1986             20  DC-EDIT2-DAY          PIC 99.
  1987             20  SLASH2-2              PIC X.
  1988             20  DC-EDIT2-YEAR         PIC 99.
  1989         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1990         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1991                     DC-GREG-DATE-1-YMD.
  1992             20  DC-YMD-YEAR           PIC 99.
  1993             20  DC-YMD-MONTH          PIC 99.
  1994             20  DC-YMD-DAY            PIC 99.
  1995         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1996         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1997                      DC-GREG-DATE-1-MDY.
  1998             20  DC-MDY-MONTH          PIC 99.
  1999             20  DC-MDY-DAY            PIC 99.
  2000             20  DC-MDY-YEAR           PIC 99.
  2001         16  DC-GREG-DATE-1-ALPHA.
  2002             20  DC-ALPHA-MONTH        PIC X(10).
  2003             20  DC-ALPHA-DAY          PIC 99.
  2004             20  FILLER                PIC XX.
  2005             20  DC-ALPHA-CENTURY.
  2006                 24 DC-ALPHA-CEN-N     PIC 99.
  2007             20  DC-ALPHA-YEAR         PIC 99.
  2008         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2009         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2010         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2011         16  DC-JULIAN-DATE            PIC 9(05).
  2012         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  38
* VP6311.cbl
  2013                                       PIC 9(05).
  2014         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2015             20  DC-JULIAN-YEAR        PIC 99.
  2016             20  DC-JULIAN-DAYS        PIC 999.
  2017         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2018         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2019         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2020     12  DATE-CONVERSION-VARIBLES.
  2021         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2022         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2023             20  FILLER                PIC 9(3).
  2024             20  HOLD-CEN-1-CCYY.
  2025                 24  HOLD-CEN-1-CC     PIC 99.
  2026                 24  HOLD-CEN-1-YY     PIC 99.
  2027             20  HOLD-CEN-1-MO         PIC 99.
  2028             20  HOLD-CEN-1-DA         PIC 99.
  2029         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2030             20  HOLD-CEN-1-R-MO       PIC 99.
  2031             20  HOLD-CEN-1-R-DA       PIC 99.
  2032             20  HOLD-CEN-1-R-CCYY.
  2033                 24  HOLD-CEN-1-R-CC   PIC 99.
  2034                 24  HOLD-CEN-1-R-YY   PIC 99.
  2035             20  FILLER                PIC 9(3).
  2036         16  HOLD-CENTURY-1-X.
  2037             20  FILLER                PIC X(3)  VALUE SPACES.
  2038             20  HOLD-CEN-1-X-CCYY.
  2039                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2040                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2041             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2042             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2043         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2044             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2045             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2046             20  HOLD-CEN-1-R-X-CCYY.
  2047                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2048                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2049             20  FILLER                PIC XXX.
  2050         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2051         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2052         16  DC-JULIAN-DATE-1          PIC 9(07).
  2053         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2054             20  DC-JULIAN-1-CCYY.
  2055                 24  DC-JULIAN-1-CC    PIC 99.
  2056                 24  DC-JULIAN-1-YR    PIC 99.
  2057             20  DC-JULIAN-DA-1        PIC 999.
  2058         16  DC-JULIAN-DATE-2          PIC 9(07).
  2059         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2060             20  DC-JULIAN-2-CCYY.
  2061                 24  DC-JULIAN-2-CC    PIC 99.
  2062                 24  DC-JULIAN-2-YR    PIC 99.
  2063             20  DC-JULIAN-DA-2        PIC 999.
  2064         16  DC-GREG-DATE-A-EDIT.
  2065             20  DC-EDITA-MONTH        PIC 99.
  2066             20  SLASHA-1              PIC X VALUE '/'.
  2067             20  DC-EDITA-DAY          PIC 99.
  2068             20  SLASHA-2              PIC X VALUE '/'.
  2069             20  DC-EDITA-CCYY.
  2070                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  39
* VP6311.cbl
  2071                 24  DC-EDITA-YEAR     PIC 99.
  2072         16  DC-GREG-DATE-B-EDIT.
  2073             20  DC-EDITB-MONTH        PIC 99.
  2074             20  SLASHB-1              PIC X VALUE '/'.
  2075             20  DC-EDITB-DAY          PIC 99.
  2076             20  SLASHB-2              PIC X VALUE '/'.
  2077             20  DC-EDITB-CCYY.
  2078                 24  DC-EDITB-CENT     PIC 99.
  2079                 24  DC-EDITB-YEAR     PIC 99.
  2080         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2081         16  DC-GREG-DATE-CYMD-R REDEFINES
  2082                              DC-GREG-DATE-CYMD.
  2083             20  DC-CYMD-CEN           PIC 99.
  2084             20  DC-CYMD-YEAR          PIC 99.
  2085             20  DC-CYMD-MONTH         PIC 99.
  2086             20  DC-CYMD-DAY           PIC 99.
  2087         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2088         16  DC-GREG-DATE-MDCY-R REDEFINES
  2089                              DC-GREG-DATE-MDCY.
  2090             20  DC-MDCY-MONTH         PIC 99.
  2091             20  DC-MDCY-DAY           PIC 99.
  2092             20  DC-MDCY-CEN           PIC 99.
  2093             20  DC-MDCY-YEAR          PIC 99.
  2094    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2095        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2096    12  DC-EL310-DATE                  PIC X(21).
  2097    12  FILLER                         PIC X(28).
  2098
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  40
* VP6311.cbl
  2100*    COPY ELCLOGOF.
  2101******************************************************************
  2102*                                                                *
  2103*                                                                *
  2104*                            ELCLOGOF.                           *
  2105*                            VMOD=2.001                          *
  2106*                                                                *
  2107*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2108*                                                                *
  2109******************************************************************
  2110 01  CLASIC-LOGOFF.
  2111     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2112     12  LOGOFF-TEXT.
  2113         16  FILLER          PIC X(5)    VALUE SPACES.
  2114         16  LOGOFF-MSG.
  2115             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2116             20  FILLER      PIC X       VALUE SPACES.
  2117             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2118         16  FILLER          PIC X(80)
  2119           VALUE '* YOU ARE NOW LOGGED OFF'.
  2120         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2121         16  FILLER          PIC X       VALUE QUOTE.
  2122         16  LOGOFF-SYS-MSG  PIC X(17)
  2123           VALUE 'S CLAS-IC SYSTEM '.
  2124     12  TEXT-MESSAGES.
  2125         16  UNACCESS-MSG    PIC X(29)
  2126             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2127         16  PGMIDERR-MSG    PIC X(17)
  2128             VALUE 'PROGRAM NOT FOUND'.
  2129
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  41
* VP6311.cbl
  2131*    COPY ELCATTR.
  2132******************************************************************
  2133*                                                                *
  2134*                            ELCATTR.                            *
  2135*                            VMOD=2.001                          *
  2136*                                                                *
  2137*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2138*                                                                *
  2139*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2140*                                                                *
  2141*                   POS 1   P=PROTECTED                          *
  2142*                           U=UNPROTECTED                        *
  2143*                           S=ASKIP                              *
  2144*                   POS 2   A=ALPHA/NUMERIC                      *
  2145*                           N=NUMERIC                            *
  2146*                   POS 3   N=NORMAL                             *
  2147*                           B=BRIGHT                             *
  2148*                           D=DARK                               *
  2149*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2150*                           OF=MODIFIED DATA TAG OFF             *
  2151*                                                                *
  2152*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2153******************************************************************
  2154 01  ATTRIBUTE-LIST.
  2155     12  AL-PABOF            PIC X       VALUE 'Y'.
  2156     12  AL-PABON            PIC X       VALUE 'Z'.
  2157     12  AL-PADOF            PIC X       VALUE '%'.
  2158     12  AL-PADON            PIC X       VALUE '_'.
  2159     12  AL-PANOF            PIC X       VALUE '-'.
  2160     12  AL-PANON            PIC X       VALUE '/'.
  2161     12  AL-SABOF            PIC X       VALUE '8'.
  2162     12  AL-SABON            PIC X       VALUE '9'.
  2163     12  AL-SADOF            PIC X       VALUE '@'.
  2164     12  AL-SADON            PIC X       VALUE QUOTE.
  2165     12  AL-SANOF            PIC X       VALUE '0'.
  2166     12  AL-SANON            PIC X       VALUE '1'.
  2167     12  AL-UABOF            PIC X       VALUE 'H'.
  2168     12  AL-UABON            PIC X       VALUE 'I'.
  2169     12  AL-UADOF            PIC X       VALUE '<'.
  2170     12  AL-UADON            PIC X       VALUE '('.
  2171     12  AL-UANOF            PIC X       VALUE ' '.
  2172     12  AL-UANON            PIC X       VALUE 'A'.
  2173     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2174     12  AL-UNBON            PIC X       VALUE 'R'.
  2175     12  AL-UNDOF            PIC X       VALUE '*'.
  2176     12  AL-UNDON            PIC X       VALUE ')'.
  2177     12  AL-UNNOF            PIC X       VALUE '&'.
  2178     12  AL-UNNON            PIC X       VALUE 'J'.
  2179
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  42
* VP6311.cbl
  2181*    COPY ELCEMIB.
  2182******************************************************************
  2183*                                                                *
  2184*                                                                *
  2185*                            ELCEMIB.                            *
  2186*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2187*                            VMOD=2.005                          *
  2188*                                                                *
  2189*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2190*                                                                *
  2191******************************************************************
  2192 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2193     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2194     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2195     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2196     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2197     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2198     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2199     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2200     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2201     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2202         88  EMI-NO-ERRORS                    VALUE '1'.
  2203         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2204         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2205     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2206         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2207     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2208         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2209         88  EMI-AREA1-FULL                   VALUE '2'.
  2210     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2211         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2212         88  EMI-AREA2-FULL                   VALUE '2'.
  2213     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2214         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2215         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2216         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2217         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2218         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2219     12  EMI-ERROR-LINES.
  2220         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2221         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2222         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2223         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2224             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2225                 24  EMI-ERR-NUM         PIC X(4).
  2226                 24  EMI-FILLER          PIC X.
  2227                 24  EMI-SEV             PIC X.
  2228                 24  FILLER              PIC X.
  2229             20  FILLER                  PIC X(02).
  2230     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2231         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2232             20  EMI-ERROR-NUMBER    PIC X(4).
  2233             20  EMI-FILL            PIC X.
  2234             20  EMI-SEVERITY        PIC X.
  2235             20  FILLER              PIC X.
  2236             20  EMI-ERROR-TEXT.
  2237                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2238                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  43
* VP6311.cbl
  2239     12  EMI-SEVERITY-SAVE           PIC X.
  2240         88  EMI-NOTE                    VALUE 'N'.
  2241         88  EMI-WARNING                 VALUE 'W'.
  2242         88  EMI-FORCABLE                VALUE 'F'.
  2243         88  EMI-FATAL                   VALUE 'X'.
  2244     12  EMI-MESSAGE-FLAG            PIC X.
  2245         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2246         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2247     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2248     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2249         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2250         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2251         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2252     12  emi-claim-no                pic x(7).
  2253     12  emi-claim-type              pic x(6).
  2254     12  FILLER                      PIC X(124)  VALUE SPACES.
  2255     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2256     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2257     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2258     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2259
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  44
* VP6311.cbl
  2261*    COPY ELCINTF.
  2262******************************************************************
  2263*                                                                *
  2264*                                                                *
  2265*                            ELCINTF.                            *
  2266*                            VMOD=2.017                          *
  2267*                                                                *
  2268*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2269*                                                                *
  2270*       LENGTH = 1024                                            *
  2271*                                                                *
  2272******************************************************************
  2273*                   C H A N G E   L O G
  2274*
  2275* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2276*-----------------------------------------------------------------
  2277*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2278* EFFECTIVE    NUMBER
  2279*-----------------------------------------------------------------
  2280* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2281******************************************************************
  2282 01  PROGRAM-INTERFACE-BLOCK.
  2283     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2284     12  PI-CALLING-PROGRAM              PIC X(8).
  2285     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2286     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2287     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2288     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2289     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2290     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2291     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2292     12  PI-COMPANY-ID                   PIC XXX.
  2293     12  PI-COMPANY-CD                   PIC X.
  2294
  2295     12  PI-COMPANY-PASSWORD             PIC X(8).
  2296
  2297     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2298
  2299     12  PI-CONTROL-IN-PROGRESS.
  2300         16  PI-CARRIER                  PIC X.
  2301         16  PI-GROUPING                 PIC X(6).
  2302         16  PI-STATE                    PIC XX.
  2303         16  PI-ACCOUNT                  PIC X(10).
  2304         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2305                                         PIC X(10).
  2306         16  PI-CLAIM-CERT-GRP.
  2307             20  PI-CLAIM-NO             PIC X(7).
  2308             20  PI-CERT-NO.
  2309                 25  PI-CERT-PRIME       PIC X(10).
  2310                 25  PI-CERT-SFX         PIC X.
  2311             20  PI-CERT-EFF-DT          PIC XX.
  2312         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2313             20  PI-PLAN-CODE            PIC X(2).
  2314             20  PI-REVISION-NUMBER      PIC X(3).
  2315             20  PI-PLAN-EFF-DT          PIC X(2).
  2316             20  PI-PLAN-EXP-DT          PIC X(2).
  2317             20  FILLER                  PIC X(11).
  2318         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  45
* VP6311.cbl
  2319             20  PI-OE-REFERENCE-1.
  2320                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2321                 25  PI-OE-REF-1-SUFF    PIC XX.
  2322
  2323     12  PI-SESSION-IN-PROGRESS          PIC X.
  2324         88  CLAIM-SESSION                   VALUE '1'.
  2325         88  CREDIT-SESSION                  VALUE '2'.
  2326         88  WARRANTY-SESSION                VALUE '3'.
  2327         88  MORTGAGE-SESSION                VALUE '4'.
  2328         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2329
  2330
  2331*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2332
  2333     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2334     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2335
  2336     12  PI-CREDIT-USER                  PIC X.
  2337         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2338         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2339
  2340     12  PI-CLAIM-USER                   PIC X.
  2341         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2342         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2343
  2344     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2345         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2346         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2347         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2348         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2349         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2350
  2351     12  PI-PROCESSOR-ID                 PIC X(4).
  2352
  2353     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2354
  2355     12  PI-MEMBER-CAPTION               PIC X(10).
  2356
  2357     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2358         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2359
  2360     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2361     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2362     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2363     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2364
  2365     12  PI-AH-OVERRIDE-L1               PIC X.
  2366     12  PI-AH-OVERRIDE-L2               PIC XX.
  2367     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2368     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2369
  2370     12  PI-NEW-SYSTEM                   PIC X(2).
  2371
  2372     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2373     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2374         88  PI-USES-PAID-TO                 VALUE '1'.
  2375     12  PI-CRDTCRD-SYSTEM.
  2376         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  46
* VP6311.cbl
  2377             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2378             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2379         16  PI-CC-MONTH-END-DT          PIC XX.
  2380     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2381
  2382     12  PI-OE-REFERENCE-2.
  2383         16  PI-OE-REF-2-PRIME           PIC X(10).
  2384         16  PI-OE-REF-2-SUFF            PIC X.
  2385
  2386     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2387
  2388     12  PI-LANGUAGE-TYPE                PIC X.
  2389             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2390             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2391             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2392
  2393     12  PI-POLICY-LINKAGE-IND           PIC X.
  2394         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2395         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2396                                                   LOW-VALUES.
  2397
  2398     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2399     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2400         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2401         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2402
  2403     12  PI-PROCESSOR-CSR-IND            PIC X.
  2404         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2405         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2406
  2407     12  FILLER                          PIC X(3).
  2408
  2409     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2410
  2411     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2412         PI-SYSTEM-LEVEL.
  2413
  2414         16  PI-ENTRY-CODES.
  2415             20  PI-ENTRY-CD-1           PIC X.
  2416             20  PI-ENTRY-CD-2           PIC X.
  2417
  2418         16  PI-RETURN-CODES.
  2419             20  PI-RETURN-CD-1          PIC X.
  2420             20  PI-RETURN-CD-2          PIC X.
  2421
  2422         16  PI-UPDATE-STATUS-SAVE.
  2423             20  PI-UPDATE-BY            PIC X(4).
  2424             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2425
  2426         16  PI-LOWER-CASE-LETTERS       PIC X.
  2427             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2428
  2429*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2430*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2431*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2432
  2433         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2434             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  47
* VP6311.cbl
  2435             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2436             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2437             88  ACCNT-CNTL                  VALUE '3'.
  2438             88  CARR-ACCNT-CNTL             VALUE '4'.
  2439
  2440         16  PI-PROCESSOR-CAP-LIST.
  2441             20  PI-SYSTEM-CONTROLS.
  2442                24 PI-SYSTEM-DISPLAY     PIC X.
  2443                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2444                24 PI-SYSTEM-MODIFY      PIC X.
  2445                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2446             20  FILLER                  PIC XX.
  2447             20  PI-DISPLAY-CAP          PIC X.
  2448                 88  DISPLAY-CAP             VALUE 'Y'.
  2449             20  PI-MODIFY-CAP           PIC X.
  2450                 88  MODIFY-CAP              VALUE 'Y'.
  2451             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2452                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2453             20  PI-FORCE-CAP            PIC X.
  2454                 88  FORCE-CAP               VALUE 'Y'.
  2455
  2456         16  PI-PROGRAM-CONTROLS.
  2457             20  PI-PGM-PRINT-OPT        PIC X.
  2458             20  PI-PGM-FORMAT-OPT       PIC X.
  2459             20  PI-PGM-PROCESS-OPT      PIC X.
  2460             20  PI-PGM-TOTALS-OPT       PIC X.
  2461
  2462         16  PI-HELP-INTERFACE.
  2463             20  PI-LAST-ERROR-NO        PIC X(4).
  2464             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2465
  2466         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2467             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2468
  2469         16  PI-CR-CONTROL-IN-PROGRESS.
  2470             20  PI-CR-CARRIER           PIC X.
  2471             20  PI-CR-GROUPING          PIC X(6).
  2472             20  PI-CR-STATE             PIC XX.
  2473             20  PI-CR-ACCOUNT           PIC X(10).
  2474             20  PI-CR-FIN-RESP          PIC X(10).
  2475             20  PI-CR-TYPE              PIC X.
  2476
  2477         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2478
  2479         16  PI-CR-MONTH-END-DT          PIC XX.
  2480
  2481         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2482             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2483             88  PI-ZERO-CARRIER             VALUE '1'.
  2484             88  PI-ZERO-GROUPING            VALUE '2'.
  2485             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2486
  2487         16  PI-CARRIER-SECURITY         PIC X.
  2488             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2489
  2490         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2491             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2492             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  48
* VP6311.cbl
  2493
  2494         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2495             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2496                                         INDEXED BY PI-ACCESS-NDX
  2497                                         PIC X.
  2498
  2499         16  PI-GA-BILLING-CONTROL       PIC X.
  2500             88  PI-GA-BILLING               VALUE '1'.
  2501
  2502         16  PI-MAIL-PROCESSING          PIC X.
  2503             88  PI-MAIL-YES                 VALUE 'Y'.
  2504
  2505         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2506
  2507         16  PI-AR-SYSTEM.
  2508             20  PI-AR-PROCESSING-CNTL   PIC X.
  2509                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2510             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2511             20  PI-AR-MONTH-END-DT      PIC XX.
  2512
  2513         16  PI-MP-SYSTEM.
  2514             20  PI-MORTGAGE-USER            PIC X.
  2515                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2516                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2517             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2518                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2519                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2520                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2521                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2522                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2523             20  PI-MP-MONTH-END-DT          PIC XX.
  2524             20  PI-MP-REFERENCE-NO.
  2525                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2526                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2527
  2528         16  PI-LABEL-CONTROL            PIC X(01).
  2529             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2530             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2531
  2532         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2533             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2534
  2535         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2536             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2537             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2538
  2539         16  FILLER                      PIC X(14).
  2540
  2541     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2542******************************************************************
  2543
  2544     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2545*    COPY ELC631PI.
  2546******************************************************************
  2547*                                                                *
  2548*                                                                *
  2549*                            ELC631PI                            *
  2550*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  49
* VP6311.cbl
  2551*                                                                *
  2552*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2553*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2554*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2555*                                                                *
  2556*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2557*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2558*    BETWEEN PROGRAMS.                                           *
  2559*                                                                *
  2560*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2561*                                                                *
  2562*               EL631 - EL6311 - EL6312 - EL6313                 *
  2563*                                                                *
  2564******************************************************************
  2565*                   C H A N G E   L O G
  2566*
  2567* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2568*-----------------------------------------------------------------
  2569*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2570* EFFECTIVE    NUMBER
  2571*-----------------------------------------------------------------
  2572* 021414    2003053000001  PEMA  changes for auto chk request
  2573******************************************************************
  2574
  2575         16  PI-631-DATA.
  2576             20  PI-ERPNDB-KEY.
  2577                 24  PI-PB-COMPANY-CD     PIC X.
  2578                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2579                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2580                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2581
  2582             20  PI-ERPNDB-ALT-KEY.
  2583                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2584                 24  PI-PB-CARRIER        PIC X.
  2585                 24  PI-PB-GROUPING       PIC X(6).
  2586                 24  PI-PB-STATE          PIC XX.
  2587                 24  PI-PB-ACCOUNT        PIC X(10).
  2588                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2589                 24  PI-PB-CERT-NO.
  2590                     28  PI-PB-CERT-PRIME PIC X(10).
  2591                     28  PI-PB-CERT-SFX   PIC X.
  2592                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2593                 24  PI-PB-RECORD-TYPE    PIC X.
  2594
  2595             20  PI-ERPNDB-CSR-KEY.
  2596                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2597                 24  PI-PB-CSR-ID             PIC X(4).
  2598                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2599                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2600                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2601
  2602             20  PI-BROWSE-TYPE               PIC X.
  2603                 88  PI-FILE-BROWSE             VALUE ' '.
  2604                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2605                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2606                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2607                 88  PI-CSR-BROWSE              VALUE '4'.
  2608
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  50
* VP6311.cbl
  2609             20  PI-MAINT-FUNCTION            PIC X.
  2610                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2611                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2612                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2613                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2614                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2615                 88  PI-PF5-FUNCTION            VALUE '5'.
  2616                 88  PI-PF6-FUNCTION            VALUE '6'.
  2617
  2618             20  PI-FILE-SWITCHES.
  2619                 24  PI-ALL-ISSUES-SW         PIC X.
  2620                     88  ALL-ISSUES             VALUE 'Y'.
  2621                 24  PI-ALL-CANCELS-SW        PIC X.
  2622                     88  ALL-CANCELS            VALUE 'Y'.
  2623                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2624                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2625                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2626                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2627                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2628                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2629                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2630                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2631                 24  PI-HOLD-REC-SW           PIC X.
  2632                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2633                 24  PI-CHANGE-REC-SW         PIC X.
  2634                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2635                 24  PI-CHK-REQ-REC-SW        PIC X.
  2636                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2637                 24  PI-ISSUE-WARNING-SW      PIC X.
  2638                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2639                 24  PI-CANCEL-WARNING-SW     PIC X.
  2640                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2641             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2642                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2643             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2644                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2645
  2646             20  PI-MAP-NAME                  PIC X(8).
  2647
  2648             20  PI-CURSOR                    PIC S9(4) COMP.
  2649
  2650             20  PI-PREV-ALT-KEY              PIC X(36).
  2651             20  PI-PREV-CSR-KEY              PIC X(15).
  2652             20  PI-PREV-KEY.
  2653                 24  PI-PREV-COMPANY-CD       PIC X.
  2654                 24  PI-PREV-BATCH            PIC X(6).
  2655                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2656                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2657             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2658             20  PI-BROWSE-SW                 PIC X.
  2659                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2660                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2661             20  PI-SV-CARRIER                PIC X.
  2662             20  PI-SV-GROUPING               PIC X(6).
  2663             20  PI-SV-STATE                  PIC XX.
  2664             20  PI-EDIT-SW                   PIC X.
  2665             20  PI-DISPLAY-SW                PIC XX.
  2666                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  51
* VP6311.cbl
  2667                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2668             20  PI-CRITERIA-DATA             PIC X(350).
  2669             20  PI-BMODE                     PIC X.
  2670             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2671             20  PI-BPMTS                     PIC S999     COMP-3.
  2672             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2673             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2674             20  PI-CSR-SESSION-SW            PIC X.
  2675                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2676             20  PI-ERRORS-SW                 PIC X.
  2677                 88  FATAL-ERRORS               VALUE 'X'.
  2678*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2679             20  pi-unforced-sw               pic x.
  2680                 88  unforced-errors            value 'X'.
  2681             20  FILLER                       PIC X(4).
  2682
  2683        16  FILLER             PIC X(94).
  2684
  2685 01  W-LETTER-COMMUNICATION-AREAS.
  2686*    COPY ELC1042.
  2687******************************************************************
  2688*                                                                *
  2689*                                                                *
  2690*                           ELC1042                              *
  2691*                            VMOD=2.002                          *
  2692*                                                                *
  2693*    NOTE                                                        *
  2694*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2695*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2696*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2697*        TO THESE PROGRAMS.                                      *
  2698*                                                                *
  2699*    NOTE                                                        *
  2700*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2701*        USE ONLY!                                               *
  2702*                                                                *
  2703******************************************************************
  2704
  2705         16  PI-1042-WA.
  2706             20  PI-ACTION       PIC  X(01).
  2707                 88 PI-SHOW-MODE           VALUE '1'.
  2708                 88 PI-CLEAR-MODE          VALUE '2'.
  2709                 88 PI-CREATE-MODE         VALUE '3'.
  2710             20  PI-COMM-CONTROL PIC  X(12).
  2711             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2712             20  PI-EOF-SW       PIC  X(01).
  2713                 88  PI-FILE-EOF           VALUE 'Y'.
  2714             20  PI-FILETYP      PIC  X(01).
  2715             20  PI-FORM-SQUEEZE-CONTROL
  2716                                 PIC  X(01).
  2717                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2718                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2719             20  PI-LAST-CONTROL PIC  X(12).
  2720             20  PI-TEMP-STOR-ITEMS
  2721                                 PIC S9(04) COMP.
  2722             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2723             20  PI-UPDATE-SW    PIC  9(01).
  2724                 88 ANY-UPDATES            VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  52
* VP6311.cbl
  2725             20  PI-104-SCREEN-SENT-IND
  2726                                 PIC  X(01).
  2727                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2728                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2729             20  PI-1042-SCREEN-SENT-IND
  2730                                 PIC  X(01).
  2731                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2732                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2733             20  PI-1042-ARCHIVE-IND
  2734                                 PIC  X(01).
  2735                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2736             20  FILLER          PIC  X(29).
  2737*    COPY ELC689PI.
  2738******************************************************************
  2739*                                                                *
  2740*                            ELC689PI                            *
  2741*                            VMOD=2.003                          *
  2742*                                                                *
  2743*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2744*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2745*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2746*                                                                *
  2747*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2748*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2749*    BETWEEN PROGRAMS.                                           *
  2750*                                                                *
  2751*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2752*                                                                *
  2753*               EL631 - EL689  - EL6891 - EL6892                 *
  2754*                                                                *
  2755******************************************************************
  2756*                   C H A N G E   L O G
  2757*
  2758* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2759*-----------------------------------------------------------------
  2760*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2761* EFFECTIVE    NUMBER
  2762*-----------------------------------------------------------------
  2763* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2764* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2765* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2766******************************************************************
  2767
  2768
  2769         16  PI-689-WORK-AREA.
  2770             20  PI-689-ALT-PRINTER-ID
  2771                                 PIC  X(04).
  2772             20  PI-689-ARCHIVE-NUMBER
  2773                                 PIC  9(08).
  2774             20  PI-689-ARCHIVE-SW
  2775                                 PIC  X(01).
  2776                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2777             20  PI-689-DATA-SOURCE
  2778                                 PIC  X(01).
  2779                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2780                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2781                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2782                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  53
* VP6311.cbl
  2783                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2784             20  PI-689-ERROR-IND
  2785                                 PIC  X(01).
  2786                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2787             20  PI-689-ERROR    PIC  9(04).
  2788                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2789                 88  PI-689-FATAL-ERROR
  2790                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2791                            0042 0047 0051 0066 0067 0070
  2792                            0168 0169 0174 0175 0176 0177 0179
  2793                            0180 0181 0182 0184 0185 0189 0190
  2794                            0191
  2795                            0215 0279 0280
  2796                            0412 0413 0454
  2797                            0533 0537
  2798                            2055 2114 2208 2209 2216 2232 2369
  2799                            2398 2433 2908 2999
  2800                            3000 3770 3771 3775
  2801                            7250 7365 7367 7368 7369 7370 7371
  2802                            7272 7373 7374 7376 7377 7378 7379
  2803                            7381 7388 7390 7393 7395 7396 7398
  2804                            9095 9096 9281 9298 9299 9320 9327
  2805                            9426 9427.
  2806                 88  PI-689-STOP-ERROR
  2807                     VALUES 0004 0008 0013 0023 0029 0033
  2808                            0042 0047 0066 0067 0070
  2809                            0168 0169 0174 0175 0176 0177
  2810                            0181 0182 0184 0185 0189 0190
  2811                            0279 0280
  2812                            0412 0413 0454
  2813                            2055 2208 2209 2216 2232
  2814                            2398 2999
  2815                            3000 3770 3771 3775
  2816                            7250 7365 7369 7370 7371
  2817                            7272 7373 7374 7376 7377 7378 7379
  2818                            7381 7388 7390 7393 7396 7398
  2819                            9095 9096 9299 9320 9426.
  2820             20  PI-689-FOLLOW-UP-DATE
  2821                                 PIC  X(02).
  2822             20  PI-689-FORM-NUMBER
  2823                                 PIC  X(04).
  2824             20  PI-689-LABEL-SOURCE
  2825                                 PIC X(01).
  2826                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2827                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2828                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2829                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2830                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2831                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2832                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2833             20  PI-689-NUMBER-COPIES
  2834                                 PIC  9(01).
  2835             20  PI-689-NUMBER-LABEL-LINES
  2836                                 PIC  9(01).
  2837             20  PI-689-NUMBER-TEXT-RECORDS
  2838                                 PIC  9(03).
  2839             20  PI-689-PRINT-ORDER-SW
  2840                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  54
* VP6311.cbl
  2841                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2842                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2843                 88  PI-689-PRINT-LATER     VALUE '3'.
  2844                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2845             20  PI-689-PRINT-RESTRICTION
  2846                                 PIC  X(01).
  2847                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2848                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2849                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2850             20  PI-689-PRINT-SW PIC  X(01).
  2851                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2852             20  PI-689-RESEND-DATE-1
  2853                                 PIC  X(02).
  2854             20  PI-689-RESEND-LETR-1
  2855                                 PIC X(4).
  2856             20  PI-689-TEMP-STOR-ID
  2857                                 PIC  X(08).
  2858             20  PI-689-USE-SCREEN-IND
  2859                                 PIC  X(01).
  2860                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2861             20  PI-689-ARCH-POINTER
  2862                                 PIC S9(08) COMP.
  2863                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2864             20  PI-689-ARCT-POINTER
  2865                                 PIC S9(08) COMP.
  2866                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2867             20  PI-689-VARIABLE-DATA-GRP.
  2868                 24  PI-689-VARIABLE-DATA-1
  2869                                 PIC  X(30).
  2870                 24  PI-689-VARIABLE-DATA-2
  2871                                 PIC  X(30).
  2872                 24  PI-689-VARIABLE-DATA-3
  2873                                 PIC  X(30).
  2874                 24  PI-689-VARIABLE-DATA-4
  2875                                 PIC  X(30).
  2876
  2877         16  PI-689-KEY-DATA-FIELDS.
  2878             20  PI-689-ACCOUNT  PIC  X(10).
  2879             20  PI-689-CARRIER  PIC  X(01).
  2880             20  PI-689-CERT-NO.
  2881                 24  PI-689-CERT-PRIME
  2882                                 PIC  X(10).
  2883                 24  PI-689-CERT-SFX
  2884                                 PIC  X(01).
  2885             20  PI-689-CHG-SEQ-NO
  2886                                 PIC S9(04)    COMP.
  2887             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2888                                 PIC  X(02).
  2889             20  PI-689-ENTRY-BATCH
  2890                                 PIC  X(06).
  2891             20  PI-689-EFF-DATE PIC  X(02).
  2892             20  PI-689-EXP-DATE PIC  X(02).
  2893             20  PI-689-GROUPING PIC  X(06).
  2894             20  PI-689-RESP-PERSON
  2895                                 PIC  X(10).
  2896             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2897             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2898                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  55
* VP6311.cbl
  2899             20  PI-689-STATE    PIC  X(02).
  2900             20  PI-689-TYPE     PIC  X(01).
  2901             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2902             20  PI-689-ALT-SEQ-NO
  2903                                 PIC S9(04)    COMP.
  2904         16  PI-689-DATE-EDIT    PIC  X(08).
  2905         16  PI-689-FOLLOW-UP-EDIT
  2906                                 PIC  X(08).
  2907         16  PI-689-RESEND1-EDIT PIC  X(08).
  2908         16  PI-689-SEQ-EDIT     PIC  X(08).
  2909         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2910         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2911             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2912         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2913         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  56
* VP6311.cbl
  2915
  2916 01  WS-EL6315-PASS-AREA.
  2917        16  PI-6315-ISS-CAN-SW      PIC X.
  2918        16  FILLER                  PIC X(120).
  2919        16  PI-RES-REF-CLM-TYPE     PIC X.
  2920        16  FILLER                  PIC X.
  2921        16  PI-6315-PASS-AREA.
  2922            20 FILLER               PIC X(236).
  2923            20 PI-6315-FINALIZED    PIC X.
  2924            20 FILLER               PIC X(280).
  2925
  2926 01  WS-EL6316-PASS-AREA.
  2927        16  PI-ISS-CAN-SW           PIC X.
  2928        16  FILLER                  PIC X(121).
  2929        16  PI-CLM-RESC-IND         PIC X.
  2930        16  PI-6316-PASS-AREA.
  2931            20 FILLER               PIC X(236).
  2932            20 PI-6316-FINALIZED    PIC X.
  2933            20 FILLER               PIC X(280).
  2934
  2935******************************************************************
  2936*                                                                *
  2937*         P A S S   A R E A   F O R   E D I T                    *
  2938*                                                                *
  2939******************************************************************
  2940
  2941 01  PASSED-RECORD.
  2942     12  RECORD-SAVE                  PIC X(585).
  2943* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2944*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2945*                    BY  WK-CURRENT-DATE.
  2946******************************************************************
  2947*                                                                *
  2948*                                                                *
  2949*                             ELC50W1                            *
  2950*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2951*                            VMOD=2.004                          *
  2952*                                                                *
  2953*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2954*                                                                *
  2955*                                                                *
  2956******************************************************************
  2957
  2958     12  WK-WORK-AREA.
  2959         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2960         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2961         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2962         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2963         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2964         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2965         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2966         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2967         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2968         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2969         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2970         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2971         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2972         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  57
* VP6311.cbl
  2973         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2974         16  WK-CREDIT-EDIT-CONTROLS.
  2975             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2976             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2977             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2978             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2979             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2980             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2981         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2982         16  WK-SAVE-REIN-DATA.
  2983             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2984             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2985             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2986         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2987             88  ENTRY-FROM-EL6311       VALUE '6'.
  2988         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2989         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2990     12  WK-RECORD-ADDRESSES.
  2991         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2992         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2993         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2994         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2995         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2996         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2997         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2998         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2999     12  WK-OVER-SHORT-AREA.
  3000         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  3001         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3002         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3003             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3004         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  58
* VP6311.cbl
  3006
  3007*    COPY ELCEDITC.
  3008******************************************************************
  3009*                                                                *
  3010*                                                                *
  3011*                            ELCEDITC                            *
  3012*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3013*                            VMOD=2.012                          *
  3014*                                                                *
  3015*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3016*                     EL6313, EL050 AND EL517.                   *
  3017*                                                                *
  3018******************************************************************
  3019******************************************************************
  3020*                   C H A N G E   L O G
  3021*
  3022* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3023*-----------------------------------------------------------------
  3024*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3025* EFFECTIVE    NUMBER
  3026*-----------------------------------------------------------------
  3027* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3028******************************************************************
  3029
  3030     12  EDIT-CRITERIA-DATA.
  3031         16  EC-CO-MONTH-END-DT       PIC XX.
  3032         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3033         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3034         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3035         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3036         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3037         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3038         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3039         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3040         16  EC-CO-REM-TERM-CALC      PIC X.
  3041               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3042               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3043               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3044               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3045
  3046         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3047               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3048               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3049               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3050               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3051               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3052               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3053               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3054               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3055               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3056               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3057
  3058         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3059               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3060               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3061               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3062               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3063               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  59
* VP6311.cbl
  3064               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3065               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3066               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3067
  3068         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3069                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3070                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3071
  3072         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3073                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3074                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3075                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3076                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3077                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3078                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3079                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3080                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3081
  3082         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3083               88  EC-BR-REDUCING                   VALUE 'R'.
  3084               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3085
  3086         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3087         16  EC-BR-LF-DESC             PIC X(10).
  3088         16  EC-BR-AH-DESC             PIC X(10).
  3089         16  EC-BR-LF-COMMENT          PIC X(10).
  3090         16  EC-BR-AH-COMMENT          PIC X(10).
  3091
  3092         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3093               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3094               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3095               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3096               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3097
  3098         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3099               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3100               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3101               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3102               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3103
  3104         16  EC-BR-LF-REFUND-CALC      PIC X.
  3105                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3106                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3107                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3108                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3109                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3110                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3111                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3112
  3113         16  EC-BR-AH-REFUND-CALC      PIC X.
  3114                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3115                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3116                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3117                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3118                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3119                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3120                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3121                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  60
* VP6311.cbl
  3122
  3123         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3124                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3125                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3126                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3127
  3128         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3129                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3130                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3131                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3132
  3133         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3134         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3135         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3136         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3137
  3138         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3139         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3140                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3141                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3142                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3143                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3144
  3145         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3146               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3147               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3148               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3149               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3150               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3151
  3152         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3153               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3154               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3155               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3156               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3157               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3158
  3159         16  EC-ST-LF-REFUND-CALC      PIC X.
  3160                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3161                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3162                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3163                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3164                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3165                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3166                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3167                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3168
  3169         16  EC-ST-AH-REFUND-CALC      PIC X.
  3170                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3171                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3172                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3173                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3174                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3175                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3176                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3177                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3178
  3179         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  61
* VP6311.cbl
  3180         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3181         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3182         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3183         16  EC-AM-EXPIRATION-DT       PIC XX.
  3184         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3185         16  EC-AM-CLASS-CD            PIC XX.
  3186         16  EC-AM-LF-DEVIATION        PIC XXX.
  3187         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3188         16  EC-AM-AH-DEVIATION        PIC XXX.
  3189         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3190         16  EC-AM-PHONE-NO            PIC X(10).
  3191
  3192         16  EC-AM-LF-REFUND-CALC      PIC X.
  3193                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3194                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3195                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3196                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3197                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3198                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3199                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3200
  3201         16  EC-AM-AH-REFUND-CALC      PIC X.
  3202                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3203                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3204                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3205                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3206                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3207                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3208                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3209
  3210         16  EC-AM-BEN-I-G-CD          PIC X.
  3211                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3212                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3213                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3214
  3215         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3216         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3217         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3218         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3219         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3220         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3221         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3222         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3223         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3224
  3225         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3226         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3227         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3228         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3229         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3230         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3231         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3232         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3233         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3234         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3235         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3236         16  EC-RT-LF-NSP-ST           PIC XX.
  3237         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  62
* VP6311.cbl
  3238         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3239         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3240
  3241         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3242             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3243                                             'M' '5' '9' '2'.
  3244             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3245             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3246             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3247             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3248             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3249             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3250             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3251             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3252             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3253             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3254
  3255         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3256             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3257                                             'M' '5' '9' '2'.
  3258             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3259             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3260             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3261             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3262             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3263             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3264             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3265             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3266             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3267             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3268
  3269         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3270         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3271         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3272         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3273         16  EC-CM-DEATH-DT            PIC XX.
  3274
  3275*DMD CUSTOM CODING FIELDS BELOW
  3276*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3277         16  EC-BR-DMD-RATING-SW       PIC X.
  3278                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3279                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3280                 88  NO-DMD-RATING               VALUE 'N'.
  3281
  3282         16  EC-NEW-CERT               PIC X(11).
  3283         16  EC-NEW-STATE              PIC XX.
  3284         16  FILLER                    PIC X.
  3285*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3286         16  OVER-SHORT-EDIT-FIELDS.
  3287             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3288             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3289             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3290             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3291             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3292             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3293             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3294             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3295             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  63
* VP6311.cbl
  3296         16  FILLER                    PIC X(71).
  3297
  3298******************************************************************
  3299
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  64
* VP6311.cbl
  3301
  3302*    COPY ELCJPFX.
  3303******************************************************************
  3304*                                                                *
  3305*                                                                *
  3306*                            ELCJPFX.                            *
  3307*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3308*                            VMOD=2.002                          *
  3309*                                                                *
  3310*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3311*                                                                *
  3312*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3313*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3314*        ELCNTL - CONTROL FILE                                   *
  3315*        ELMSTR - CLAIM MASTERS                                  *
  3316*        ELTRLR - ACTIVITY TRAILERS                              *
  3317*        ELCHKQ - CHECK QUE                                      *
  3318******************************************************************
  3319 01  JOURNAL-RECORD.
  3320     12  jp-date                     pic s9(5) comp-3.
  3321     12  jp-time                     pic s9(7) comp-3.
  3322     12  JP-USER-ID                  PIC X(4).
  3323     12  JP-FILE-ID                  PIC X(8).
  3324     12  JP-PROGRAM-ID               PIC X(8).
  3325     12  JP-RECORD-TYPE              PIC X.
  3326         88 JP-ADD              VALUE 'A'.
  3327         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3328         88 JP-AFTER-CHANGE     VALUE 'C'.
  3329         88 JP-DELETE           VALUE 'D'.
  3330         88 JP-GENERIC-DELETE   VALUE 'G'.
  3331         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3332         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3333     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3334     12  JP-RECORD-AREA
  3335
  3336
  3337                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  65
* VP6311.cbl
  3339*    COPY ELCAID.
  3340******************************************************************
  3341*                                                                *
  3342*                            ELCAID.                             *
  3343*                            VMOD=2.001                          *
  3344*                                                                *
  3345*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3346*                                                                *
  3347*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3348*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3349******************************************************************
  3350
  3351 01  DFHAID.
  3352   02  DFHNULL   PIC  X  VALUE  ' '.
  3353   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3354   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3355   02  DFHPEN    PIC  X  VALUE  '='.
  3356   02  DFHOPID   PIC  X  VALUE  'W'.
  3357   02  DFHPA1    PIC  X  VALUE  '%'.
  3358   02  DFHPA2    PIC  X  VALUE  '>'.
  3359   02  DFHPA3    PIC  X  VALUE  ','.
  3360   02  DFHPF1    PIC  X  VALUE  '1'.
  3361   02  DFHPF2    PIC  X  VALUE  '2'.
  3362   02  DFHPF3    PIC  X  VALUE  '3'.
  3363   02  DFHPF4    PIC  X  VALUE  '4'.
  3364   02  DFHPF5    PIC  X  VALUE  '5'.
  3365   02  DFHPF6    PIC  X  VALUE  '6'.
  3366   02  DFHPF7    PIC  X  VALUE  '7'.
  3367   02  DFHPF8    PIC  X  VALUE  '8'.
  3368   02  DFHPF9    PIC  X  VALUE  '9'.
  3369   02  DFHPF10   PIC  X  VALUE  ':'.
  3370   02  DFHPF11   PIC  X  VALUE  '#'.
  3371   02  DFHPF12   PIC  X  VALUE  '@'.
  3372   02  DFHPF13   PIC  X  VALUE  'A'.
  3373   02  DFHPF14   PIC  X  VALUE  'B'.
  3374   02  DFHPF15   PIC  X  VALUE  'C'.
  3375   02  DFHPF16   PIC  X  VALUE  'D'.
  3376   02  DFHPF17   PIC  X  VALUE  'E'.
  3377   02  DFHPF18   PIC  X  VALUE  'F'.
  3378   02  DFHPF19   PIC  X  VALUE  'G'.
  3379   02  DFHPF20   PIC  X  VALUE  'H'.
  3380   02  DFHPF21   PIC  X  VALUE  'I'.
  3381*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3382   02  DFHPF22   PIC  X  VALUE  '['.
  3383   02  DFHPF23   PIC  X  VALUE  '.'.
  3384   02  DFHPF24   PIC  X  VALUE  '<'.
  3385   02  DFHMSRE   PIC  X  VALUE  'X'.
  3386   02  DFHSTRF   PIC  X  VALUE  'h'.
  3387   02  DFHTRIG   PIC  X  VALUE  '"'.
  3388
  3389 01  FILLER    REDEFINES DFHAID.
  3390     12  FILLER              PIC X(8).
  3391     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3392
  3393*                                COPY VP6311S.
  3394 01  VP631BI.
  3395     05  FILLER            PIC  X(0012).
  3396*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  66
* VP6311.cbl
  3397     05  BDATEL PIC S9(0004) COMP.
  3398     05  BDATEF PIC  X(0001).
  3399     05  FILLER REDEFINES BDATEF.
  3400         10  BDATEA PIC  X(0001).
  3401     05  BDATEI PIC  X(0008).
  3402*    -------------------------------
  3403     05  BTIMEL PIC S9(0004) COMP.
  3404     05  BTIMEF PIC  X(0001).
  3405     05  FILLER REDEFINES BTIMEF.
  3406         10  BTIMEA PIC  X(0001).
  3407     05  BTIMEI PIC  X(0005).
  3408*    -------------------------------
  3409     05  BHEADL PIC S9(0004) COMP.
  3410     05  BHEADF PIC  X(0001).
  3411     05  FILLER REDEFINES BHEADF.
  3412         10  BHEADA PIC  X(0001).
  3413     05  BHEADI PIC  X(0038).
  3414*    -------------------------------
  3415     05  BNCERTLL PIC S9(0004) COMP.
  3416     05  BNCERTLF PIC  X(0001).
  3417     05  FILLER REDEFINES BNCERTLF.
  3418         10  BNCERTLA PIC  X(0001).
  3419     05  BNCERTLI PIC  X(0008).
  3420*    -------------------------------
  3421     05  BNCERTL PIC S9(0004) COMP.
  3422     05  BNCERTF PIC  X(0001).
  3423     05  FILLER REDEFINES BNCERTF.
  3424         10  BNCERTA PIC  X(0001).
  3425     05  BNCERTI PIC  X(0011).
  3426*    -------------------------------
  3427     05  BNSTATLL PIC S9(0004) COMP.
  3428     05  BNSTATLF PIC  X(0001).
  3429     05  FILLER REDEFINES BNSTATLF.
  3430         10  BNSTATLA PIC  X(0001).
  3431     05  BNSTATLI PIC  X(0009).
  3432*    -------------------------------
  3433     05  BNSTATL PIC S9(0004) COMP.
  3434     05  BNSTATF PIC  X(0001).
  3435     05  FILLER REDEFINES BNSTATF.
  3436         10  BNSTATA PIC  X(0001).
  3437     05  BNSTATI PIC  X(0002).
  3438*    -------------------------------
  3439     05  BCHGTL PIC S9(0004) COMP.
  3440     05  BCHGTF PIC  X(0001).
  3441     05  FILLER REDEFINES BCHGTF.
  3442         10  BCHGTA PIC  X(0001).
  3443     05  BCHGTI PIC  X(0004).
  3444*    -------------------------------
  3445     05  BCHGL PIC S9(0004) COMP.
  3446     05  BCHGF PIC  X(0001).
  3447     05  FILLER REDEFINES BCHGF.
  3448         10  BCHGA PIC  X(0001).
  3449     05  BCHGI PIC  X(0004).
  3450*    -------------------------------
  3451     05  BCOMPIDL PIC S9(0004) COMP.
  3452     05  BCOMPIDF PIC  X(0001).
  3453     05  FILLER REDEFINES BCOMPIDF.
  3454         10  BCOMPIDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  67
* VP6311.cbl
  3455     05  BCOMPIDI PIC  X(0003).
  3456*    -------------------------------
  3457     05  BREGIONL PIC S9(0004) COMP.
  3458     05  BREGIONF PIC  X(0001).
  3459     05  FILLER REDEFINES BREGIONF.
  3460         10  BREGIONA PIC  X(0001).
  3461     05  BREGIONI PIC  X(0006).
  3462*    -------------------------------
  3463     05  BUSERL PIC S9(0004) COMP.
  3464     05  BUSERF PIC  X(0001).
  3465     05  FILLER REDEFINES BUSERF.
  3466         10  BUSERA PIC  X(0001).
  3467     05  BUSERI PIC  X(0004).
  3468*    -------------------------------
  3469     05  BMAINTL PIC S9(0004) COMP.
  3470     05  BMAINTF PIC  X(0001).
  3471     05  FILLER REDEFINES BMAINTF.
  3472         10  BMAINTA PIC  X(0001).
  3473     05  BMAINTI PIC  X(0001).
  3474*    -------------------------------
  3475     05  BMANTBYL PIC S9(0004) COMP.
  3476     05  BMANTBYF PIC  X(0001).
  3477     05  FILLER REDEFINES BMANTBYF.
  3478         10  BMANTBYA PIC  X(0001).
  3479     05  BMANTBYI PIC  X(0004).
  3480*    -------------------------------
  3481     05  BCHGHDGL PIC S9(0004) COMP.
  3482     05  BCHGHDGF PIC  X(0001).
  3483     05  FILLER REDEFINES BCHGHDGF.
  3484         10  BCHGHDGA PIC  X(0001).
  3485     05  BCHGHDGI PIC  X(0003).
  3486*    -------------------------------
  3487     05  BMANTDTL PIC S9(0004) COMP.
  3488     05  BMANTDTF PIC  X(0001).
  3489     05  FILLER REDEFINES BMANTDTF.
  3490         10  BMANTDTA PIC  X(0001).
  3491     05  BMANTDTI PIC  X(0008).
  3492*    -------------------------------
  3493     05  BMANTATL PIC S9(0004) COMP.
  3494     05  BMANTATF PIC  X(0001).
  3495     05  FILLER REDEFINES BMANTATF.
  3496         10  BMANTATA PIC  X(0001).
  3497     05  BMANTATI PIC  X(0005).
  3498*    -------------------------------
  3499     05  BCSRL PIC S9(0004) COMP.
  3500     05  BCSRF PIC  X(0001).
  3501     05  FILLER REDEFINES BCSRF.
  3502         10  BCSRA PIC  X(0001).
  3503     05  BCSRI PIC  X(0004).
  3504*    -------------------------------
  3505     05  BBATCHL PIC S9(0004) COMP.
  3506     05  BBATCHF PIC  X(0001).
  3507     05  FILLER REDEFINES BBATCHF.
  3508         10  BBATCHA PIC  X(0001).
  3509     05  BBATCHI PIC  X(0006).
  3510*    -------------------------------
  3511     05  BSEQL PIC S9(0004) COMP.
  3512     05  BSEQF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  68
* VP6311.cbl
  3513     05  FILLER REDEFINES BSEQF.
  3514         10  BSEQA PIC  X(0001).
  3515     05  BSEQI PIC  X(0004).
  3516*    -------------------------------
  3517     05  BMOENDTL PIC S9(0004) COMP.
  3518     05  BMOENDTF PIC  X(0001).
  3519     05  FILLER REDEFINES BMOENDTF.
  3520         10  BMOENDTA PIC  X(0001).
  3521     05  BMOENDTI PIC  X(0008).
  3522*    -------------------------------
  3523     05  BCARRL PIC S9(0004) COMP.
  3524     05  BCARRF PIC  X(0001).
  3525     05  FILLER REDEFINES BCARRF.
  3526         10  BCARRA PIC  X(0001).
  3527     05  BCARRI PIC  X(0001).
  3528*    -------------------------------
  3529     05  BGROUPL PIC S9(0004) COMP.
  3530     05  BGROUPF PIC  X(0001).
  3531     05  FILLER REDEFINES BGROUPF.
  3532         10  BGROUPA PIC  X(0001).
  3533     05  BGROUPI PIC  X(0006).
  3534*    -------------------------------
  3535     05  BSTATEL PIC S9(0004) COMP.
  3536     05  BSTATEF PIC  X(0001).
  3537     05  FILLER REDEFINES BSTATEF.
  3538         10  BSTATEA PIC  X(0001).
  3539     05  BSTATEI PIC  X(0002).
  3540*    -------------------------------
  3541     05  BACCTL PIC S9(0004) COMP.
  3542     05  BACCTF PIC  X(0001).
  3543     05  FILLER REDEFINES BACCTF.
  3544         10  BACCTA PIC  X(0001).
  3545     05  BACCTI PIC  X(0010).
  3546*    -------------------------------
  3547     05  BVINHL PIC S9(0004) COMP.
  3548     05  BVINHF PIC  X(0001).
  3549     05  FILLER REDEFINES BVINHF.
  3550         10  BVINHA PIC  X(0001).
  3551     05  BVINHI PIC  X(0004).
  3552*    -------------------------------
  3553     05  BVINL PIC S9(0004) COMP.
  3554     05  BVINF PIC  X(0001).
  3555     05  FILLER REDEFINES BVINF.
  3556         10  BVINA PIC  X(0001).
  3557     05  BVINI PIC  X(0017).
  3558*    -------------------------------
  3559     05  BREFHDGL PIC S9(0004) COMP.
  3560     05  BREFHDGF PIC  X(0001).
  3561     05  FILLER REDEFINES BREFHDGF.
  3562         10  BREFHDGA PIC  X(0001).
  3563     05  BREFHDGI PIC  X(0004).
  3564*    -------------------------------
  3565     05  BREFL PIC S9(0004) COMP.
  3566     05  BREFF PIC  X(0001).
  3567     05  FILLER REDEFINES BREFF.
  3568         10  BREFA PIC  X(0001).
  3569     05  BREFI PIC  X(0012).
  3570*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  69
* VP6311.cbl
  3571     05  BAGEDEFL PIC S9(0004) COMP.
  3572     05  BAGEDEFF PIC  X(0001).
  3573     05  FILLER REDEFINES BAGEDEFF.
  3574         10  BAGEDEFA PIC  X(0001).
  3575     05  BAGEDEFI PIC  X(0004).
  3576*    -------------------------------
  3577     05  BCERTNOL PIC S9(0004) COMP.
  3578     05  BCERTNOF PIC  X(0001).
  3579     05  FILLER REDEFINES BCERTNOF.
  3580         10  BCERTNOA PIC  X(0001).
  3581     05  BCERTNOI PIC  X(0010).
  3582*    -------------------------------
  3583     05  BSUFIXL PIC S9(0004) COMP.
  3584     05  BSUFIXF PIC  X(0001).
  3585     05  FILLER REDEFINES BSUFIXF.
  3586         10  BSUFIXA PIC  X(0001).
  3587     05  BSUFIXI PIC  X(0001).
  3588*    -------------------------------
  3589     05  BEFFDTL PIC S9(0004) COMP.
  3590     05  BEFFDTF PIC  X(0001).
  3591     05  FILLER REDEFINES BEFFDTF.
  3592         10  BEFFDTA PIC  X(0001).
  3593     05  BEFFDTI PIC  X(0008).
  3594*    -------------------------------
  3595     05  BLSTNML PIC S9(0004) COMP.
  3596     05  BLSTNMF PIC  X(0001).
  3597     05  FILLER REDEFINES BLSTNMF.
  3598         10  BLSTNMA PIC  X(0001).
  3599     05  BLSTNMI PIC  X(0015).
  3600*    -------------------------------
  3601     05  B1STNML PIC S9(0004) COMP.
  3602     05  B1STNMF PIC  X(0001).
  3603     05  FILLER REDEFINES B1STNMF.
  3604         10  B1STNMA PIC  X(0001).
  3605     05  B1STNMI PIC  X(0010).
  3606*    -------------------------------
  3607     05  BINITL PIC S9(0004) COMP.
  3608     05  BINITF PIC  X(0001).
  3609     05  FILLER REDEFINES BINITF.
  3610         10  BINITA PIC  X(0001).
  3611     05  BINITI PIC  X(0001).
  3612*    -------------------------------
  3613     05  BSEXL PIC S9(0004) COMP.
  3614     05  BSEXF PIC  X(0001).
  3615     05  FILLER REDEFINES BSEXF.
  3616         10  BSEXA PIC  X(0001).
  3617     05  BSEXI PIC  X(0001).
  3618*    -------------------------------
  3619     05  BAGEL PIC S9(0004) COMP.
  3620     05  BAGEF PIC  X(0001).
  3621     05  FILLER REDEFINES BAGEF.
  3622         10  BAGEA PIC  X(0001).
  3623     05  BAGEI PIC  X(0002).
  3624*    -------------------------------
  3625     05  BBIRTHL PIC S9(0004) COMP.
  3626     05  BBIRTHF PIC  X(0001).
  3627     05  FILLER REDEFINES BBIRTHF.
  3628         10  BBIRTHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  70
* VP6311.cbl
  3629     05  BBIRTHI PIC  X(0008).
  3630*    -------------------------------
  3631     05  BYEARL PIC S9(0004) COMP.
  3632     05  BYEARF PIC  X(0001).
  3633     05  FILLER REDEFINES BYEARF.
  3634         10  BYEARA PIC  X(0001).
  3635     05  BYEARI PIC  X(0004).
  3636*    -------------------------------
  3637     05  BMAKEL PIC S9(0004) COMP.
  3638     05  BMAKEF PIC  X(0001).
  3639     05  FILLER REDEFINES BMAKEF.
  3640         10  BMAKEA PIC  X(0001).
  3641     05  BMAKEI PIC  X(0020).
  3642*    -------------------------------
  3643     05  BMODELL PIC S9(0004) COMP.
  3644     05  BMODELF PIC  X(0001).
  3645     05  FILLER REDEFINES BMODELF.
  3646         10  BMODELA PIC  X(0001).
  3647     05  BMODELI PIC  X(0020).
  3648*    -------------------------------
  3649     05  BFUTUREL PIC S9(0004) COMP.
  3650     05  BFUTUREF PIC  X(0001).
  3651     05  FILLER REDEFINES BFUTUREF.
  3652         10  BFUTUREA PIC  X(0001).
  3653     05  BFUTUREI PIC  X(0020).
  3654*    -------------------------------
  3655     05  BOMETERL PIC S9(0004) COMP.
  3656     05  BOMETERF PIC  X(0001).
  3657     05  FILLER REDEFINES BOMETERF.
  3658         10  BOMETERA PIC  X(0001).
  3659     05  BOMETERI PIC  X(0007).
  3660*    -------------------------------
  3661     05  BMEMCAPL PIC S9(0004) COMP.
  3662     05  BMEMCAPF PIC  X(0001).
  3663     05  FILLER REDEFINES BMEMCAPF.
  3664         10  BMEMCAPA PIC  X(0001).
  3665     05  BMEMCAPI PIC  X(0011).
  3666*    -------------------------------
  3667     05  BORIGHDL PIC S9(0004) COMP.
  3668     05  BORIGHDF PIC  X(0001).
  3669     05  FILLER REDEFINES BORIGHDF.
  3670         10  BORIGHDA PIC  X(0001).
  3671     05  BORIGHDI PIC  X(0010).
  3672*    -------------------------------
  3673     05  BFORCEL PIC S9(0004) COMP.
  3674     05  BFORCEF PIC  X(0001).
  3675     05  FILLER REDEFINES BFORCEF.
  3676         10  BFORCEA PIC  X(0001).
  3677     05  BFORCEI PIC  X(0001).
  3678*    -------------------------------
  3679     05  BENTRYL PIC S9(0004) COMP.
  3680     05  BENTRYF PIC  X(0001).
  3681     05  FILLER REDEFINES BENTRYF.
  3682         10  BENTRYA PIC  X(0001).
  3683     05  BENTRYI PIC  X(0001).
  3684*    -------------------------------
  3685     05  BREINL PIC S9(0004) COMP.
  3686     05  BREINF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  71
* VP6311.cbl
  3687     05  FILLER REDEFINES BREINF.
  3688         10  BREINA PIC  X(0001).
  3689     05  BREINI PIC  X(0001).
  3690*    -------------------------------
  3691     05  BBILCDL PIC S9(0004) COMP.
  3692     05  BBILCDF PIC  X(0001).
  3693     05  FILLER REDEFINES BBILCDF.
  3694         10  BBILCDA PIC  X(0001).
  3695     05  BBILCDI PIC  X(0001).
  3696*    -------------------------------
  3697     05  BUNWRITL PIC S9(0004) COMP.
  3698     05  BUNWRITF PIC  X(0001).
  3699     05  FILLER REDEFINES BUNWRITF.
  3700         10  BUNWRITA PIC  X(0001).
  3701     05  BUNWRITI PIC  X(0001).
  3702*    -------------------------------
  3703     05  BSKPCDL PIC S9(0004) COMP.
  3704     05  BSKPCDF PIC  X(0001).
  3705     05  FILLER REDEFINES BSKPCDF.
  3706         10  BSKPCDA PIC  X(0001).
  3707     05  BSKPCDI PIC  X(0001).
  3708*    -------------------------------
  3709     05  BINDGRPL PIC S9(0004) COMP.
  3710     05  BINDGRPF PIC  X(0001).
  3711     05  FILLER REDEFINES BINDGRPF.
  3712         10  BINDGRPA PIC  X(0001).
  3713     05  BINDGRPI PIC  X(0001).
  3714*    -------------------------------
  3715     05  BSIGL PIC S9(0004) COMP.
  3716     05  BSIGF PIC  X(0001).
  3717     05  FILLER REDEFINES BSIGF.
  3718         10  BSIGA PIC  X(0001).
  3719     05  BSIGI PIC  X(0001).
  3720*    -------------------------------
  3721     05  BRTCLSL PIC S9(0004) COMP.
  3722     05  BRTCLSF PIC  X(0001).
  3723     05  FILLER REDEFINES BRTCLSF.
  3724         10  BRTCLSA PIC  X(0001).
  3725     05  BRTCLSI PIC  X(0002).
  3726*    -------------------------------
  3727     05  BCHGCNTL PIC S9(0004) COMP.
  3728     05  BCHGCNTF PIC  X(0001).
  3729     05  FILLER REDEFINES BCHGCNTF.
  3730         10  BCHGCNTA PIC  X(0001).
  3731     05  BCHGCNTI PIC  X(0003).
  3732*    -------------------------------
  3733     05  BMEMBERL PIC S9(0004) COMP.
  3734     05  BMEMBERF PIC  X(0001).
  3735     05  FILLER REDEFINES BMEMBERF.
  3736         10  BMEMBERA PIC  X(0001).
  3737     05  BMEMBERI PIC  X(0012).
  3738*    -------------------------------
  3739     05  BLNOFCRL PIC S9(0004) COMP.
  3740     05  BLNOFCRF PIC  X(0001).
  3741     05  FILLER REDEFINES BLNOFCRF.
  3742         10  BLNOFCRA PIC  X(0001).
  3743     05  BLNOFCRI PIC  X(0005).
  3744*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  72
* VP6311.cbl
  3745     05  BKIND1L PIC S9(0004) COMP.
  3746     05  BKIND1F PIC  X(0001).
  3747     05  FILLER REDEFINES BKIND1F.
  3748         10  BKIND1A PIC  X(0001).
  3749     05  BKIND1I PIC  X(0002).
  3750*    -------------------------------
  3751     05  BTYPE1L PIC S9(0004) COMP.
  3752     05  BTYPE1F PIC  X(0001).
  3753     05  FILLER REDEFINES BTYPE1F.
  3754         10  BTYPE1A PIC  X(0001).
  3755     05  BTYPE1I PIC  X(0003).
  3756*    -------------------------------
  3757     05  BTERM1L PIC S9(0004) COMP.
  3758     05  BTERM1F PIC  X(0001).
  3759     05  FILLER REDEFINES BTERM1F.
  3760         10  BTERM1A PIC  X(0001).
  3761     05  BTERM1I PIC  X(0003).
  3762*    -------------------------------
  3763     05  BBEN1L PIC S9(0004) COMP.
  3764     05  BBEN1F PIC  X(0001).
  3765     05  FILLER REDEFINES BBEN1F.
  3766         10  BBEN1A PIC  X(0001).
  3767     05  BBEN1I PIC  X(0012).
  3768*    -------------------------------
  3769     05  BPREM1L PIC S9(0004) COMP.
  3770     05  BPREM1F PIC  X(0001).
  3771     05  FILLER REDEFINES BPREM1F.
  3772         10  BPREM1A PIC  X(0001).
  3773     05  BPREM1I PIC  X(0011).
  3774*    -------------------------------
  3775     05  BEXPIR1L PIC S9(0004) COMP.
  3776     05  BEXPIR1F PIC  X(0001).
  3777     05  FILLER REDEFINES BEXPIR1F.
  3778         10  BEXPIR1A PIC  X(0001).
  3779     05  BEXPIR1I PIC  X(0008).
  3780*    -------------------------------
  3781     05  BCP1L PIC S9(0004) COMP.
  3782     05  BCP1F PIC  X(0001).
  3783     05  FILLER REDEFINES BCP1F.
  3784         10  BCP1A PIC  X(0001).
  3785     05  BCP1I PIC  X(0002).
  3786*    -------------------------------
  3787     05  BALTBN1L PIC S9(0004) COMP.
  3788     05  BALTBN1F PIC  X(0001).
  3789     05  FILLER REDEFINES BALTBN1F.
  3790         10  BALTBN1A PIC  X(0001).
  3791     05  BALTBN1I PIC  X(0012).
  3792*    -------------------------------
  3793     05  BALTPR1L PIC S9(0004) COMP.
  3794     05  BALTPR1F PIC  X(0001).
  3795     05  FILLER REDEFINES BALTPR1F.
  3796         10  BALTPR1A PIC  X(0001).
  3797     05  BALTPR1I PIC  X(0011).
  3798*    -------------------------------
  3799     05  BBNCD1L PIC S9(0004) COMP.
  3800     05  BBNCD1F PIC  X(0001).
  3801     05  FILLER REDEFINES BBNCD1F.
  3802         10  BBNCD1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  73
* VP6311.cbl
  3803     05  BBNCD1I PIC  X(0003).
  3804*    -------------------------------
  3805     05  BCPRM1L PIC S9(0004) COMP.
  3806     05  BCPRM1F PIC  X(0001).
  3807     05  FILLER REDEFINES BCPRM1F.
  3808         10  BCPRM1A PIC  X(0001).
  3809     05  BCPRM1I PIC  X(0011).
  3810*    -------------------------------
  3811     05  BCAPRM1L PIC S9(0004) COMP.
  3812     05  BCAPRM1F PIC  X(0001).
  3813     05  FILLER REDEFINES BCAPRM1F.
  3814         10  BCAPRM1A PIC  X(0001).
  3815     05  BCAPRM1I PIC  X(0011).
  3816*    -------------------------------
  3817     05  BENABR1L PIC S9(0004) COMP.
  3818     05  BENABR1F PIC  X(0001).
  3819     05  FILLER REDEFINES BENABR1F.
  3820         10  BENABR1A PIC  X(0001).
  3821     05  BENABR1I PIC  X(0005).
  3822*    -------------------------------
  3823     05  BDIFF1L PIC S9(0004) COMP.
  3824     05  BDIFF1F PIC  X(0001).
  3825     05  FILLER REDEFINES BDIFF1F.
  3826         10  BDIFF1A PIC  X(0001).
  3827     05  BDIFF1I PIC  X(0011).
  3828*    -------------------------------
  3829     05  BBILIT1L PIC S9(0004) COMP.
  3830     05  BBILIT1F PIC  X(0001).
  3831     05  FILLER REDEFINES BBILIT1F.
  3832         10  BBILIT1A PIC  X(0001).
  3833     05  BBILIT1I PIC  X(0008).
  3834*    -------------------------------
  3835     05  BADIFF1L PIC S9(0004) COMP.
  3836     05  BADIFF1F PIC  X(0001).
  3837     05  FILLER REDEFINES BADIFF1F.
  3838         10  BADIFF1A PIC  X(0001).
  3839     05  BADIFF1I PIC  X(0011).
  3840*    -------------------------------
  3841     05  BKIND2L PIC S9(0004) COMP.
  3842     05  BKIND2F PIC  X(0001).
  3843     05  FILLER REDEFINES BKIND2F.
  3844         10  BKIND2A PIC  X(0001).
  3845     05  BKIND2I PIC  X(0002).
  3846*    -------------------------------
  3847     05  BTYPE2L PIC S9(0004) COMP.
  3848     05  BTYPE2F PIC  X(0001).
  3849     05  FILLER REDEFINES BTYPE2F.
  3850         10  BTYPE2A PIC  X(0001).
  3851     05  BTYPE2I PIC  X(0003).
  3852*    -------------------------------
  3853     05  BTERM2L PIC S9(0004) COMP.
  3854     05  BTERM2F PIC  X(0001).
  3855     05  FILLER REDEFINES BTERM2F.
  3856         10  BTERM2A PIC  X(0001).
  3857     05  BTERM2I PIC  X(0003).
  3858*    -------------------------------
  3859     05  BBEN2L PIC S9(0004) COMP.
  3860     05  BBEN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  74
* VP6311.cbl
  3861     05  FILLER REDEFINES BBEN2F.
  3862         10  BBEN2A PIC  X(0001).
  3863     05  BBEN2I PIC  X(0012).
  3864*    -------------------------------
  3865     05  BPREM2L PIC S9(0004) COMP.
  3866     05  BPREM2F PIC  X(0001).
  3867     05  FILLER REDEFINES BPREM2F.
  3868         10  BPREM2A PIC  X(0001).
  3869     05  BPREM2I PIC  X(0011).
  3870*    -------------------------------
  3871     05  BEXPIR2L PIC S9(0004) COMP.
  3872     05  BEXPIR2F PIC  X(0001).
  3873     05  FILLER REDEFINES BEXPIR2F.
  3874         10  BEXPIR2A PIC  X(0001).
  3875     05  BEXPIR2I PIC  X(0008).
  3876*    -------------------------------
  3877     05  BCP2L PIC S9(0004) COMP.
  3878     05  BCP2F PIC  X(0001).
  3879     05  FILLER REDEFINES BCP2F.
  3880         10  BCP2A PIC  X(0001).
  3881     05  BCP2I PIC  X(0002).
  3882*    -------------------------------
  3883     05  BALTBN2L PIC S9(0004) COMP.
  3884     05  BALTBN2F PIC  X(0001).
  3885     05  FILLER REDEFINES BALTBN2F.
  3886         10  BALTBN2A PIC  X(0001).
  3887     05  BALTBN2I PIC  X(0012).
  3888*    -------------------------------
  3889     05  BALTPR2L PIC S9(0004) COMP.
  3890     05  BALTPR2F PIC  X(0001).
  3891     05  FILLER REDEFINES BALTPR2F.
  3892         10  BALTPR2A PIC  X(0001).
  3893     05  BALTPR2I PIC  X(0011).
  3894*    -------------------------------
  3895     05  BBNCD2L PIC S9(0004) COMP.
  3896     05  BBNCD2F PIC  X(0001).
  3897     05  FILLER REDEFINES BBNCD2F.
  3898         10  BBNCD2A PIC  X(0001).
  3899     05  BBNCD2I PIC  X(0003).
  3900*    -------------------------------
  3901     05  BCPRM2L PIC S9(0004) COMP.
  3902     05  BCPRM2F PIC  X(0001).
  3903     05  FILLER REDEFINES BCPRM2F.
  3904         10  BCPRM2A PIC  X(0001).
  3905     05  BCPRM2I PIC  X(0011).
  3906*    -------------------------------
  3907     05  BCAPRM2L PIC S9(0004) COMP.
  3908     05  BCAPRM2F PIC  X(0001).
  3909     05  FILLER REDEFINES BCAPRM2F.
  3910         10  BCAPRM2A PIC  X(0001).
  3911     05  BCAPRM2I PIC  X(0011).
  3912*    -------------------------------
  3913     05  BENABR2L PIC S9(0004) COMP.
  3914     05  BENABR2F PIC  X(0001).
  3915     05  FILLER REDEFINES BENABR2F.
  3916         10  BENABR2A PIC  X(0001).
  3917     05  BENABR2I PIC  X(0005).
  3918*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  75
* VP6311.cbl
  3919     05  BDIFF2L PIC S9(0004) COMP.
  3920     05  BDIFF2F PIC  X(0001).
  3921     05  FILLER REDEFINES BDIFF2F.
  3922         10  BDIFF2A PIC  X(0001).
  3923     05  BDIFF2I PIC  X(0011).
  3924*    -------------------------------
  3925     05  BBILIT2L PIC S9(0004) COMP.
  3926     05  BBILIT2F PIC  X(0001).
  3927     05  FILLER REDEFINES BBILIT2F.
  3928         10  BBILIT2A PIC  X(0001).
  3929     05  BBILIT2I PIC  X(0008).
  3930*    -------------------------------
  3931     05  BADIFF2L PIC S9(0004) COMP.
  3932     05  BADIFF2F PIC  X(0001).
  3933     05  FILLER REDEFINES BADIFF2F.
  3934         10  BADIFF2A PIC  X(0001).
  3935     05  BADIFF2I PIC  X(0011).
  3936*    -------------------------------
  3937     05  BERMSG1L PIC S9(0004) COMP.
  3938     05  BERMSG1F PIC  X(0001).
  3939     05  FILLER REDEFINES BERMSG1F.
  3940         10  BERMSG1A PIC  X(0001).
  3941     05  BERMSG1I PIC  X(0078).
  3942*    -------------------------------
  3943     05  BERMSG2L PIC S9(0004) COMP.
  3944     05  BERMSG2F PIC  X(0001).
  3945     05  FILLER REDEFINES BERMSG2F.
  3946         10  BERMSG2A PIC  X(0001).
  3947     05  BERMSG2I PIC  X(0078).
  3948*    -------------------------------
  3949     05  BERMSG3L PIC S9(0004) COMP.
  3950     05  BERMSG3F PIC  X(0001).
  3951     05  FILLER REDEFINES BERMSG3F.
  3952         10  BERMSG3A PIC  X(0001).
  3953     05  BERMSG3I PIC  X(0078).
  3954*    -------------------------------
  3955     05  BPFENTRL PIC S9(0004) COMP.
  3956     05  BPFENTRF PIC  X(0001).
  3957     05  FILLER REDEFINES BPFENTRF.
  3958         10  BPFENTRA PIC  X(0001).
  3959     05  BPFENTRI PIC  9(2).
  3960*    -------------------------------
  3961     05  BPF5HDRL PIC S9(0004) COMP.
  3962     05  BPF5HDRF PIC  X(0001).
  3963     05  FILLER REDEFINES BPF5HDRF.
  3964         10  BPF5HDRA PIC  X(0001).
  3965     05  BPF5HDRI PIC  X(0005).
  3966*    -------------------------------
  3967     05  BPF4HDRL PIC S9(0004) COMP.
  3968     05  BPF4HDRF PIC  X(0001).
  3969     05  FILLER REDEFINES BPF4HDRF.
  3970         10  BPF4HDRA PIC  X(0001).
  3971     05  BPF4HDRI PIC  X(0013).
  3972*    -------------------------------
  3973     05  BF15HDRL PIC S9(0004) COMP.
  3974     05  BF15HDRF PIC  X(0001).
  3975     05  FILLER REDEFINES BF15HDRF.
  3976         10  BF15HDRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  76
* VP6311.cbl
  3977     05  BF15HDRI PIC  X(0010).
  3978 01  VP631BO REDEFINES VP631BI.
  3979     05  FILLER            PIC  X(0012).
  3980*    -------------------------------
  3981     05  FILLER            PIC  X(0003).
  3982     05  BDATEO PIC  X(0008).
  3983*    -------------------------------
  3984     05  FILLER            PIC  X(0003).
  3985     05  BTIMEO PIC  99.99.
  3986*    -------------------------------
  3987     05  FILLER            PIC  X(0003).
  3988     05  BHEADO PIC  X(0038).
  3989*    -------------------------------
  3990     05  FILLER            PIC  X(0003).
  3991     05  BNCERTLO PIC  X(0008).
  3992*    -------------------------------
  3993     05  FILLER            PIC  X(0003).
  3994     05  BNCERTO PIC  X(0011).
  3995*    -------------------------------
  3996     05  FILLER            PIC  X(0003).
  3997     05  BNSTATLO PIC  X(0009).
  3998*    -------------------------------
  3999     05  FILLER            PIC  X(0003).
  4000     05  BNSTATO PIC  X(0002).
  4001*    -------------------------------
  4002     05  FILLER            PIC  X(0003).
  4003     05  BCHGTO PIC  X(0004).
  4004*    -------------------------------
  4005     05  FILLER            PIC  X(0003).
  4006     05  BCHGO PIC  ZZZ9.
  4007*    -------------------------------
  4008     05  FILLER            PIC  X(0003).
  4009     05  BCOMPIDO PIC  X(0003).
  4010*    -------------------------------
  4011     05  FILLER            PIC  X(0003).
  4012     05  BREGIONO PIC  X(0006).
  4013*    -------------------------------
  4014     05  FILLER            PIC  X(0003).
  4015     05  BUSERO PIC  X(0004).
  4016*    -------------------------------
  4017     05  FILLER            PIC  X(0003).
  4018     05  BMAINTO PIC  X(0001).
  4019*    -------------------------------
  4020     05  FILLER            PIC  X(0003).
  4021     05  BMANTBYO PIC  X(0004).
  4022*    -------------------------------
  4023     05  FILLER            PIC  X(0003).
  4024     05  BCHGHDGO PIC  X(0003).
  4025*    -------------------------------
  4026     05  FILLER            PIC  X(0003).
  4027     05  BMANTDTO PIC  X(0008).
  4028*    -------------------------------
  4029     05  FILLER            PIC  X(0003).
  4030     05  BMANTATO PIC  99.99.
  4031*    -------------------------------
  4032     05  FILLER            PIC  X(0003).
  4033     05  BCSRO PIC  X(0004).
  4034*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  77
* VP6311.cbl
  4035     05  FILLER            PIC  X(0003).
  4036     05  BBATCHO PIC  X(0006).
  4037*    -------------------------------
  4038     05  FILLER            PIC  X(0003).
  4039     05  BSEQO PIC  X(0004).
  4040*    -------------------------------
  4041     05  FILLER            PIC  X(0003).
  4042     05  BMOENDTO PIC  X(0008).
  4043*    -------------------------------
  4044     05  FILLER            PIC  X(0003).
  4045     05  BCARRO PIC  X(0001).
  4046*    -------------------------------
  4047     05  FILLER            PIC  X(0003).
  4048     05  BGROUPO PIC  X(0006).
  4049*    -------------------------------
  4050     05  FILLER            PIC  X(0003).
  4051     05  BSTATEO PIC  X(0002).
  4052*    -------------------------------
  4053     05  FILLER            PIC  X(0003).
  4054     05  BACCTO PIC  X(0010).
  4055*    -------------------------------
  4056     05  FILLER            PIC  X(0003).
  4057     05  BVINHO PIC  X(0004).
  4058*    -------------------------------
  4059     05  FILLER            PIC  X(0003).
  4060     05  BVINO PIC  X(0017).
  4061*    -------------------------------
  4062     05  FILLER            PIC  X(0003).
  4063     05  BREFHDGO PIC  X(0004).
  4064*    -------------------------------
  4065     05  FILLER            PIC  X(0003).
  4066     05  BREFO PIC  X(0012).
  4067*    -------------------------------
  4068     05  FILLER            PIC  X(0003).
  4069     05  BAGEDEFO PIC  X(0004).
  4070*    -------------------------------
  4071     05  FILLER            PIC  X(0003).
  4072     05  BCERTNOO PIC  X(0010).
  4073*    -------------------------------
  4074     05  FILLER            PIC  X(0003).
  4075     05  BSUFIXO PIC  X(0001).
  4076*    -------------------------------
  4077     05  FILLER            PIC  X(0003).
  4078     05  BEFFDTO PIC  X(0008).
  4079*    -------------------------------
  4080     05  FILLER            PIC  X(0003).
  4081     05  BLSTNMO PIC  X(0015).
  4082*    -------------------------------
  4083     05  FILLER            PIC  X(0003).
  4084     05  B1STNMO PIC  X(0010).
  4085*    -------------------------------
  4086     05  FILLER            PIC  X(0003).
  4087     05  BINITO PIC  X(0001).
  4088*    -------------------------------
  4089     05  FILLER            PIC  X(0003).
  4090     05  BSEXO PIC  X(0001).
  4091*    -------------------------------
  4092     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  78
* VP6311.cbl
  4093     05  BAGEO PIC  X(0002).
  4094*    -------------------------------
  4095     05  FILLER            PIC  X(0003).
  4096     05  BBIRTHO PIC  X(0008).
  4097*    -------------------------------
  4098     05  FILLER            PIC  X(0003).
  4099     05  BYEARO PIC  X(0004).
  4100*    -------------------------------
  4101     05  FILLER            PIC  X(0003).
  4102     05  BMAKEO PIC  X(0020).
  4103*    -------------------------------
  4104     05  FILLER            PIC  X(0003).
  4105     05  BMODELO PIC  X(0020).
  4106*    -------------------------------
  4107     05  FILLER            PIC  X(0003).
  4108     05  BFUTUREO PIC  X(0020).
  4109*    -------------------------------
  4110     05  FILLER            PIC  X(0003).
  4111     05  BOMETERO PIC  ZZZ,Z99.
  4112*    -------------------------------
  4113     05  FILLER            PIC  X(0003).
  4114     05  BMEMCAPO PIC  X(0011).
  4115*    -------------------------------
  4116     05  FILLER            PIC  X(0003).
  4117     05  BORIGHDO PIC  X(0010).
  4118*    -------------------------------
  4119     05  FILLER            PIC  X(0003).
  4120     05  BFORCEO PIC  X(0001).
  4121*    -------------------------------
  4122     05  FILLER            PIC  X(0003).
  4123     05  BENTRYO PIC  X(0001).
  4124*    -------------------------------
  4125     05  FILLER            PIC  X(0003).
  4126     05  BREINO PIC  X(0001).
  4127*    -------------------------------
  4128     05  FILLER            PIC  X(0003).
  4129     05  BBILCDO PIC  X(0001).
  4130*    -------------------------------
  4131     05  FILLER            PIC  X(0003).
  4132     05  BUNWRITO PIC  X(0001).
  4133*    -------------------------------
  4134     05  FILLER            PIC  X(0003).
  4135     05  BSKPCDO PIC  X(0001).
  4136*    -------------------------------
  4137     05  FILLER            PIC  X(0003).
  4138     05  BINDGRPO PIC  X(0001).
  4139*    -------------------------------
  4140     05  FILLER            PIC  X(0003).
  4141     05  BSIGO PIC  X(0001).
  4142*    -------------------------------
  4143     05  FILLER            PIC  X(0003).
  4144     05  BRTCLSO PIC  X(0002).
  4145*    -------------------------------
  4146     05  FILLER            PIC  X(0003).
  4147     05  BCHGCNTO PIC  X(0003).
  4148*    -------------------------------
  4149     05  FILLER            PIC  X(0003).
  4150     05  BMEMBERO PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  79
* VP6311.cbl
  4151*    -------------------------------
  4152     05  FILLER            PIC  X(0003).
  4153     05  BLNOFCRO PIC  X(0005).
  4154*    -------------------------------
  4155     05  FILLER            PIC  X(0003).
  4156     05  BKIND1O PIC  X(0002).
  4157*    -------------------------------
  4158     05  FILLER            PIC  X(0003).
  4159     05  BTYPE1O PIC  X(0003).
  4160*    -------------------------------
  4161     05  FILLER            PIC  X(0003).
  4162     05  BTERM1O PIC  X(0003).
  4163*    -------------------------------
  4164     05  FILLER            PIC  X(0003).
  4165     05  BBEN1O PIC  X(0012).
  4166*    -------------------------------
  4167     05  FILLER            PIC  X(0003).
  4168     05  BPREM1O PIC  X(0011).
  4169*    -------------------------------
  4170     05  FILLER            PIC  X(0003).
  4171     05  BEXPIR1O PIC  X(0008).
  4172*    -------------------------------
  4173     05  FILLER            PIC  X(0003).
  4174     05  BCP1O PIC  X(0002).
  4175*    -------------------------------
  4176     05  FILLER            PIC  X(0003).
  4177     05  BALTBN1O PIC  X(0012).
  4178*    -------------------------------
  4179     05  FILLER            PIC  X(0003).
  4180     05  BALTPR1O PIC  X(0011).
  4181*    -------------------------------
  4182     05  FILLER            PIC  X(0003).
  4183     05  BBNCD1O PIC  X(0003).
  4184*    -------------------------------
  4185     05  FILLER            PIC  X(0003).
  4186     05  BCPRM1O PIC  X(0011).
  4187*    -------------------------------
  4188     05  FILLER            PIC  X(0003).
  4189     05  BCAPRM1O PIC  X(0011).
  4190*    -------------------------------
  4191     05  FILLER            PIC  X(0003).
  4192     05  BENABR1O PIC  X(0005).
  4193*    -------------------------------
  4194     05  FILLER            PIC  X(0003).
  4195     05  BDIFF1O PIC  X(0011).
  4196*    -------------------------------
  4197     05  FILLER            PIC  X(0003).
  4198     05  BBILIT1O PIC  X(0008).
  4199*    -------------------------------
  4200     05  FILLER            PIC  X(0003).
  4201     05  BADIFF1O PIC  X(0011).
  4202*    -------------------------------
  4203     05  FILLER            PIC  X(0003).
  4204     05  BKIND2O PIC  X(0002).
  4205*    -------------------------------
  4206     05  FILLER            PIC  X(0003).
  4207     05  BTYPE2O PIC  X(0003).
  4208*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  80
* VP6311.cbl
  4209     05  FILLER            PIC  X(0003).
  4210     05  BTERM2O PIC  X(0003).
  4211*    -------------------------------
  4212     05  FILLER            PIC  X(0003).
  4213     05  BBEN2O PIC  X(0012).
  4214*    -------------------------------
  4215     05  FILLER            PIC  X(0003).
  4216     05  BPREM2O PIC  X(0011).
  4217*    -------------------------------
  4218     05  FILLER            PIC  X(0003).
  4219     05  BEXPIR2O PIC  X(0008).
  4220*    -------------------------------
  4221     05  FILLER            PIC  X(0003).
  4222     05  BCP2O PIC  X(0002).
  4223*    -------------------------------
  4224     05  FILLER            PIC  X(0003).
  4225     05  BALTBN2O PIC  X(0012).
  4226*    -------------------------------
  4227     05  FILLER            PIC  X(0003).
  4228     05  BALTPR2O PIC  X(0011).
  4229*    -------------------------------
  4230     05  FILLER            PIC  X(0003).
  4231     05  BBNCD2O PIC  X(0003).
  4232*    -------------------------------
  4233     05  FILLER            PIC  X(0003).
  4234     05  BCPRM2O PIC  X(0011).
  4235*    -------------------------------
  4236     05  FILLER            PIC  X(0003).
  4237     05  BCAPRM2O PIC  X(0011).
  4238*    -------------------------------
  4239     05  FILLER            PIC  X(0003).
  4240     05  BENABR2O PIC  X(0005).
  4241*    -------------------------------
  4242     05  FILLER            PIC  X(0003).
  4243     05  BDIFF2O PIC  X(0011).
  4244*    -------------------------------
  4245     05  FILLER            PIC  X(0003).
  4246     05  BBILIT2O PIC  X(0008).
  4247*    -------------------------------
  4248     05  FILLER            PIC  X(0003).
  4249     05  BADIFF2O PIC  X(0011).
  4250*    -------------------------------
  4251     05  FILLER            PIC  X(0003).
  4252     05  BERMSG1O PIC  X(0078).
  4253*    -------------------------------
  4254     05  FILLER            PIC  X(0003).
  4255     05  BERMSG2O PIC  X(0078).
  4256*    -------------------------------
  4257     05  FILLER            PIC  X(0003).
  4258     05  BERMSG3O PIC  X(0078).
  4259*    -------------------------------
  4260     05  FILLER            PIC  X(0003).
  4261     05  BPFENTRO PIC  X(0002).
  4262*    -------------------------------
  4263     05  FILLER            PIC  X(0003).
  4264     05  BPF5HDRO PIC  X(0005).
  4265*    -------------------------------
  4266     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  81
* VP6311.cbl
  4267     05  BPF4HDRO PIC  X(0013).
  4268*    -------------------------------
  4269     05  FILLER            PIC  X(0003).
  4270     05  BF15HDRO PIC  X(0010).
  4271*    -------------------------------
  4272 01  VP631CI REDEFINES VP631BI.
  4273     05  FILLER            PIC  X(0012).
  4274*    -------------------------------
  4275     05  CDATEL PIC S9(0004) COMP.
  4276     05  CDATEF PIC  X(0001).
  4277     05  FILLER REDEFINES CDATEF.
  4278         10  CDATEA PIC  X(0001).
  4279     05  CDATEI PIC  X(0008).
  4280*    -------------------------------
  4281     05  CTIMEL PIC S9(0004) COMP.
  4282     05  CTIMEF PIC  X(0001).
  4283     05  FILLER REDEFINES CTIMEF.
  4284         10  CTIMEA PIC  X(0001).
  4285     05  CTIMEI PIC  X(0005).
  4286*    -------------------------------
  4287     05  CHEADL PIC S9(0004) COMP.
  4288     05  CHEADF PIC  X(0001).
  4289     05  FILLER REDEFINES CHEADF.
  4290         10  CHEADA PIC  X(0001).
  4291     05  CHEADI PIC  X(0038).
  4292*    -------------------------------
  4293     05  CCHGTL PIC S9(0004) COMP.
  4294     05  CCHGTF PIC  X(0001).
  4295     05  FILLER REDEFINES CCHGTF.
  4296         10  CCHGTA PIC  X(0001).
  4297     05  CCHGTI PIC  X(0004).
  4298*    -------------------------------
  4299     05  CCHGL PIC S9(0004) COMP.
  4300     05  CCHGF PIC  X(0001).
  4301     05  FILLER REDEFINES CCHGF.
  4302         10  CCHGA PIC  X(0001).
  4303     05  CCHGI PIC  X(0004).
  4304*    -------------------------------
  4305     05  CMAINTL PIC S9(0004) COMP.
  4306     05  CMAINTF PIC  X(0001).
  4307     05  FILLER REDEFINES CMAINTF.
  4308         10  CMAINTA PIC  X(0001).
  4309     05  CMAINTI PIC  X(0001).
  4310*    -------------------------------
  4311     05  CMANTBYL PIC S9(0004) COMP.
  4312     05  CMANTBYF PIC  X(0001).
  4313     05  FILLER REDEFINES CMANTBYF.
  4314         10  CMANTBYA PIC  X(0001).
  4315     05  CMANTBYI PIC  X(0004).
  4316*    -------------------------------
  4317     05  CCHGHDGL PIC S9(0004) COMP.
  4318     05  CCHGHDGF PIC  X(0001).
  4319     05  FILLER REDEFINES CCHGHDGF.
  4320         10  CCHGHDGA PIC  X(0001).
  4321     05  CCHGHDGI PIC  X(0003).
  4322*    -------------------------------
  4323     05  CMANTDTL PIC S9(0004) COMP.
  4324     05  CMANTDTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  82
* VP6311.cbl
  4325     05  FILLER REDEFINES CMANTDTF.
  4326         10  CMANTDTA PIC  X(0001).
  4327     05  CMANTDTI PIC  X(0008).
  4328*    -------------------------------
  4329     05  CMANTATL PIC S9(0004) COMP.
  4330     05  CMANTATF PIC  X(0001).
  4331     05  FILLER REDEFINES CMANTATF.
  4332         10  CMANTATA PIC  X(0001).
  4333     05  CMANTATI PIC  X(0005).
  4334*    -------------------------------
  4335     05  CCSRL PIC S9(0004) COMP.
  4336     05  CCSRF PIC  X(0001).
  4337     05  FILLER REDEFINES CCSRF.
  4338         10  CCSRA PIC  X(0001).
  4339     05  CCSRI PIC  X(0004).
  4340*    -------------------------------
  4341     05  CBATCHL PIC S9(0004) COMP.
  4342     05  CBATCHF PIC  X(0001).
  4343     05  FILLER REDEFINES CBATCHF.
  4344         10  CBATCHA PIC  X(0001).
  4345     05  CBATCHI PIC  X(0006).
  4346*    -------------------------------
  4347     05  CSEQL PIC S9(0004) COMP.
  4348     05  CSEQF PIC  X(0001).
  4349     05  FILLER REDEFINES CSEQF.
  4350         10  CSEQA PIC  X(0001).
  4351     05  CSEQI PIC  X(0004).
  4352*    -------------------------------
  4353     05  CMOENDTL PIC S9(0004) COMP.
  4354     05  CMOENDTF PIC  X(0001).
  4355     05  FILLER REDEFINES CMOENDTF.
  4356         10  CMOENDTA PIC  X(0001).
  4357     05  CMOENDTI PIC  X(0008).
  4358*    -------------------------------
  4359     05  CCARRL PIC S9(0004) COMP.
  4360     05  CCARRF PIC  X(0001).
  4361     05  FILLER REDEFINES CCARRF.
  4362         10  CCARRA PIC  X(0001).
  4363     05  CCARRI PIC  X(0001).
  4364*    -------------------------------
  4365     05  CGROUPL PIC S9(0004) COMP.
  4366     05  CGROUPF PIC  X(0001).
  4367     05  FILLER REDEFINES CGROUPF.
  4368         10  CGROUPA PIC  X(0001).
  4369     05  CGROUPI PIC  X(0006).
  4370*    -------------------------------
  4371     05  CSTATEL PIC S9(0004) COMP.
  4372     05  CSTATEF PIC  X(0001).
  4373     05  FILLER REDEFINES CSTATEF.
  4374         10  CSTATEA PIC  X(0001).
  4375     05  CSTATEI PIC  X(0002).
  4376*    -------------------------------
  4377     05  CACCTL PIC S9(0004) COMP.
  4378     05  CACCTF PIC  X(0001).
  4379     05  FILLER REDEFINES CACCTF.
  4380         10  CACCTA PIC  X(0001).
  4381     05  CACCTI PIC  X(0010).
  4382*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  83
* VP6311.cbl
  4383     05  CORIGHDL PIC S9(0004) COMP.
  4384     05  CORIGHDF PIC  X(0001).
  4385     05  FILLER REDEFINES CORIGHDF.
  4386         10  CORIGHDA PIC  X(0001).
  4387     05  CORIGHDI PIC  X(0011).
  4388*    -------------------------------
  4389     05  CORGNOL PIC S9(0004) COMP.
  4390     05  CORGNOF PIC  X(0001).
  4391     05  FILLER REDEFINES CORGNOF.
  4392         10  CORGNOA PIC  X(0001).
  4393     05  CORGNOI PIC  X(0006).
  4394*    -------------------------------
  4395     05  CORGSEQL PIC S9(0004) COMP.
  4396     05  CORGSEQF PIC  X(0001).
  4397     05  FILLER REDEFINES CORGSEQF.
  4398         10  CORGSEQA PIC  X(0001).
  4399     05  CORGSEQI PIC  X(0004).
  4400*    -------------------------------
  4401     05  CREFHDGL PIC S9(0004) COMP.
  4402     05  CREFHDGF PIC  X(0001).
  4403     05  FILLER REDEFINES CREFHDGF.
  4404         10  CREFHDGA PIC  X(0001).
  4405     05  CREFHDGI PIC  X(0010).
  4406*    -------------------------------
  4407     05  CREFL PIC S9(0004) COMP.
  4408     05  CREFF PIC  X(0001).
  4409     05  FILLER REDEFINES CREFF.
  4410         10  CREFA PIC  X(0001).
  4411     05  CREFI PIC  X(0012).
  4412*    -------------------------------
  4413     05  CNHINTL PIC S9(0004) COMP.
  4414     05  CNHINTF PIC  X(0001).
  4415     05  FILLER REDEFINES CNHINTF.
  4416         10  CNHINTA PIC  X(0001).
  4417     05  CNHINTI PIC  9(7)V99.
  4418*    -------------------------------
  4419     05  CCERTNOL PIC S9(0004) COMP.
  4420     05  CCERTNOF PIC  X(0001).
  4421     05  FILLER REDEFINES CCERTNOF.
  4422         10  CCERTNOA PIC  X(0001).
  4423     05  CCERTNOI PIC  X(0010).
  4424*    -------------------------------
  4425     05  CSUFIXL PIC S9(0004) COMP.
  4426     05  CSUFIXF PIC  X(0001).
  4427     05  FILLER REDEFINES CSUFIXF.
  4428         10  CSUFIXA PIC  X(0001).
  4429     05  CSUFIXI PIC  X(0001).
  4430*    -------------------------------
  4431     05  CEFFDTL PIC S9(0004) COMP.
  4432     05  CEFFDTF PIC  X(0001).
  4433     05  FILLER REDEFINES CEFFDTF.
  4434         10  CEFFDTA PIC  X(0001).
  4435     05  CEFFDTI PIC  X(0008).
  4436*    -------------------------------
  4437     05  CLSTNML PIC S9(0004) COMP.
  4438     05  CLSTNMF PIC  X(0001).
  4439     05  FILLER REDEFINES CLSTNMF.
  4440         10  CLSTNMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  84
* VP6311.cbl
  4441     05  CLSTNMI PIC  X(0015).
  4442*    -------------------------------
  4443     05  CINAMEL PIC S9(0004) COMP.
  4444     05  CINAMEF PIC  X(0001).
  4445     05  FILLER REDEFINES CINAMEF.
  4446         10  CINAMEA PIC  X(0001).
  4447     05  CINAMEI PIC  X(0015).
  4448*    -------------------------------
  4449     05  CINITSL PIC S9(0004) COMP.
  4450     05  CINITSF PIC  X(0001).
  4451     05  FILLER REDEFINES CINITSF.
  4452         10  CINITSA PIC  X(0001).
  4453     05  CINITSI PIC  X(0010).
  4454*    -------------------------------
  4455     05  CCANREAL PIC S9(0004) COMP.
  4456     05  CCANREAF PIC  X(0001).
  4457     05  FILLER REDEFINES CCANREAF.
  4458         10  CCANREAA PIC  X(0001).
  4459     05  CCANREAI PIC  X(0001).
  4460*    -------------------------------
  4461     05  CKIND1L PIC S9(0004) COMP.
  4462     05  CKIND1F PIC  X(0001).
  4463     05  FILLER REDEFINES CKIND1F.
  4464         10  CKIND1A PIC  X(0001).
  4465     05  CKIND1I PIC  X(0002).
  4466*    -------------------------------
  4467     05  CCANDT1L PIC S9(0004) COMP.
  4468     05  CCANDT1F PIC  X(0001).
  4469     05  FILLER REDEFINES CCANDT1F.
  4470         10  CCANDT1A PIC  X(0001).
  4471     05  CCANDT1I PIC  X(0008).
  4472*    -------------------------------
  4473     05  CREFND1L PIC S9(0004) COMP.
  4474     05  CREFND1F PIC  X(0001).
  4475     05  FILLER REDEFINES CREFND1F.
  4476         10  CREFND1A PIC  X(0001).
  4477     05  CREFND1I PIC  S9(9)V99.
  4478*    -------------------------------
  4479     05  CMTHD1L PIC S9(0004) COMP.
  4480     05  CMTHD1F PIC  X(0001).
  4481     05  FILLER REDEFINES CMTHD1F.
  4482         10  CMTHD1A PIC  X(0001).
  4483     05  CMTHD1I PIC  X(0001).
  4484*    -------------------------------
  4485     05  CKIND2L PIC S9(0004) COMP.
  4486     05  CKIND2F PIC  X(0001).
  4487     05  FILLER REDEFINES CKIND2F.
  4488         10  CKIND2A PIC  X(0001).
  4489     05  CKIND2I PIC  X(0002).
  4490*    -------------------------------
  4491     05  CCANDT2L PIC S9(0004) COMP.
  4492     05  CCANDT2F PIC  X(0001).
  4493     05  FILLER REDEFINES CCANDT2F.
  4494         10  CCANDT2A PIC  X(0001).
  4495     05  CCANDT2I PIC  X(0008).
  4496*    -------------------------------
  4497     05  CREFND2L PIC S9(0004) COMP.
  4498     05  CREFND2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  85
* VP6311.cbl
  4499     05  FILLER REDEFINES CREFND2F.
  4500         10  CREFND2A PIC  X(0001).
  4501     05  CREFND2I PIC  S9(9)V99.
  4502*    -------------------------------
  4503     05  CMTHD2L PIC S9(0004) COMP.
  4504     05  CMTHD2F PIC  X(0001).
  4505     05  FILLER REDEFINES CMTHD2F.
  4506         10  CMTHD2A PIC  X(0001).
  4507     05  CMTHD2I PIC  X(0001).
  4508*    -------------------------------
  4509     05  CLIVESL PIC S9(0004) COMP.
  4510     05  CLIVESF PIC  X(0001).
  4511     05  FILLER REDEFINES CLIVESF.
  4512         10  CLIVESA PIC  X(0001).
  4513     05  CLIVESI PIC  X(0003).
  4514*    -------------------------------
  4515     05  CFORCEL PIC S9(0004) COMP.
  4516     05  CFORCEF PIC  X(0001).
  4517     05  FILLER REDEFINES CFORCEF.
  4518         10  CFORCEA PIC  X(0001).
  4519     05  CFORCEI PIC  X(0001).
  4520*    -------------------------------
  4521     05  CBILCDL PIC S9(0004) COMP.
  4522     05  CBILCDF PIC  X(0001).
  4523     05  FILLER REDEFINES CBILCDF.
  4524         10  CBILCDA PIC  X(0001).
  4525     05  CBILCDI PIC  X(0001).
  4526*    -------------------------------
  4527     05  CCRFND1L PIC S9(0004) COMP.
  4528     05  CCRFND1F PIC  X(0001).
  4529     05  FILLER REDEFINES CCRFND1F.
  4530         10  CCRFND1A PIC  X(0001).
  4531     05  CCRFND1I PIC  X(0011).
  4532*    -------------------------------
  4533     05  CCRFND2L PIC S9(0004) COMP.
  4534     05  CCRFND2F PIC  X(0001).
  4535     05  FILLER REDEFINES CCRFND2F.
  4536         10  CCRFND2A PIC  X(0001).
  4537     05  CCRFND2I PIC  X(0011).
  4538*    -------------------------------
  4539     05  CBILIT1L PIC S9(0004) COMP.
  4540     05  CBILIT1F PIC  X(0001).
  4541     05  FILLER REDEFINES CBILIT1F.
  4542         10  CBILIT1A PIC  X(0001).
  4543     05  CBILIT1I PIC  X(0008).
  4544*    -------------------------------
  4545     05  CDRFND1L PIC S9(0004) COMP.
  4546     05  CDRFND1F PIC  X(0001).
  4547     05  FILLER REDEFINES CDRFND1F.
  4548         10  CDRFND1A PIC  X(0001).
  4549     05  CDRFND1I PIC  X(0011).
  4550*    -------------------------------
  4551     05  CBILIT2L PIC S9(0004) COMP.
  4552     05  CBILIT2F PIC  X(0001).
  4553     05  FILLER REDEFINES CBILIT2F.
  4554         10  CBILIT2A PIC  X(0001).
  4555     05  CBILIT2I PIC  X(0008).
  4556*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  86
* VP6311.cbl
  4557     05  CDRFND2L PIC S9(0004) COMP.
  4558     05  CDRFND2F PIC  X(0001).
  4559     05  FILLER REDEFINES CDRFND2F.
  4560         10  CDRFND2A PIC  X(0001).
  4561     05  CDRFND2I PIC  X(0011).
  4562*    -------------------------------
  4563     05  CCANTXTL PIC S9(0004) COMP.
  4564     05  CCANTXTF PIC  X(0001).
  4565     05  FILLER REDEFINES CCANTXTF.
  4566         10  CCANTXTA PIC  X(0001).
  4567     05  CCANTXTI PIC  X(0005).
  4568*    -------------------------------
  4569     05  CCANFEEL PIC S9(0004) COMP.
  4570     05  CCANFEEF PIC  X(0001).
  4571     05  FILLER REDEFINES CCANFEEF.
  4572         10  CCANFEEA PIC  X(0001).
  4573     05  CCANFEEI PIC  X(0002).
  4574*    -------------------------------
  4575     05  CTERM1L PIC S9(0004) COMP.
  4576     05  CTERM1F PIC  X(0001).
  4577     05  FILLER REDEFINES CTERM1F.
  4578         10  CTERM1A PIC  X(0001).
  4579     05  CTERM1I PIC  X(0003).
  4580*    -------------------------------
  4581     05  CRTERM1L PIC S9(0004) COMP.
  4582     05  CRTERM1F PIC  X(0001).
  4583     05  FILLER REDEFINES CRTERM1F.
  4584         10  CRTERM1A PIC  X(0001).
  4585     05  CRTERM1I PIC  X(0003).
  4586*    -------------------------------
  4587     05  CPREM1L PIC S9(0004) COMP.
  4588     05  CPREM1F PIC  X(0001).
  4589     05  FILLER REDEFINES CPREM1F.
  4590         10  CPREM1A PIC  X(0001).
  4591     05  CPREM1I PIC  X(0011).
  4592*    -------------------------------
  4593     05  CTERM2L PIC S9(0004) COMP.
  4594     05  CTERM2F PIC  X(0001).
  4595     05  FILLER REDEFINES CTERM2F.
  4596         10  CTERM2A PIC  X(0001).
  4597     05  CTERM2I PIC  X(0003).
  4598*    -------------------------------
  4599     05  CRTERM2L PIC S9(0004) COMP.
  4600     05  CRTERM2F PIC  X(0001).
  4601     05  FILLER REDEFINES CRTERM2F.
  4602         10  CRTERM2A PIC  X(0001).
  4603     05  CRTERM2I PIC  X(0003).
  4604*    -------------------------------
  4605     05  CPREM2L PIC S9(0004) COMP.
  4606     05  CPREM2F PIC  X(0001).
  4607     05  FILLER REDEFINES CPREM2F.
  4608         10  CPREM2A PIC  X(0001).
  4609     05  CPREM2I PIC  X(0011).
  4610*    -------------------------------
  4611     05  CENTRDTL PIC S9(0004) COMP.
  4612     05  CENTRDTF PIC  X(0001).
  4613     05  FILLER REDEFINES CENTRDTF.
  4614         10  CENTRDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  87
* VP6311.cbl
  4615     05  CENTRDTI PIC  X(0008).
  4616*    -------------------------------
  4617     05  CPAYEEL PIC S9(0004) COMP.
  4618     05  CPAYEEF PIC  X(0001).
  4619     05  FILLER REDEFINES CPAYEEF.
  4620         10  CPAYEEA PIC  X(0001).
  4621     05  CPAYEEI PIC  X(0006).
  4622*    -------------------------------
  4623     05  CRFNDSWL PIC S9(0004) COMP.
  4624     05  CRFNDSWF PIC  X(0001).
  4625     05  FILLER REDEFINES CRFNDSWF.
  4626         10  CRFNDSWA PIC  X(0001).
  4627     05  CRFNDSWI PIC  X(0003).
  4628*    -------------------------------
  4629     05  CLFHDGL PIC S9(0004) COMP.
  4630     05  CLFHDGF PIC  X(0001).
  4631     05  FILLER REDEFINES CLFHDGF.
  4632         10  CLFHDGA PIC  X(0001).
  4633     05  CLFHDGI PIC  X(0006).
  4634*    -------------------------------
  4635     05  CAHHDGL PIC S9(0004) COMP.
  4636     05  CAHHDGF PIC  X(0001).
  4637     05  FILLER REDEFINES CAHHDGF.
  4638         10  CAHHDGA PIC  X(0001).
  4639     05  CAHHDGI PIC  X(0006).
  4640*    -------------------------------
  4641     05  CENTDTL PIC S9(0004) COMP.
  4642     05  CENTDTF PIC  X(0001).
  4643     05  FILLER REDEFINES CENTDTF.
  4644         10  CENTDTA PIC  X(0001).
  4645     05  CENTDTI PIC  X(0008).
  4646*    -------------------------------
  4647     05  CENTBYL PIC S9(0004) COMP.
  4648     05  CENTBYF PIC  X(0001).
  4649     05  FILLER REDEFINES CENTBYF.
  4650         10  CENTBYA PIC  X(0001).
  4651     05  CENTBYI PIC  X(0004).
  4652*    -------------------------------
  4653     05  CCHGCNTL PIC S9(0004) COMP.
  4654     05  CCHGCNTF PIC  X(0001).
  4655     05  FILLER REDEFINES CCHGCNTF.
  4656         10  CCHGCNTA PIC  X(0001).
  4657     05  CCHGCNTI PIC  X(0003).
  4658*    -------------------------------
  4659     05  CLFREFNL PIC S9(0004) COMP.
  4660     05  CLFREFNF PIC  X(0001).
  4661     05  FILLER REDEFINES CLFREFNF.
  4662         10  CLFREFNA PIC  X(0001).
  4663     05  CLFREFNI PIC  X(0006).
  4664*    -------------------------------
  4665     05  CAHREFNL PIC S9(0004) COMP.
  4666     05  CAHREFNF PIC  X(0001).
  4667     05  FILLER REDEFINES CAHREFNF.
  4668         10  CAHREFNA PIC  X(0001).
  4669     05  CAHREFNI PIC  X(0006).
  4670*    -------------------------------
  4671     05  CREINCDL PIC S9(0004) COMP.
  4672     05  CREINCDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  88
* VP6311.cbl
  4673     05  FILLER REDEFINES CREINCDF.
  4674         10  CREINCDA PIC  X(0001).
  4675     05  CREINCDI PIC  X(0003).
  4676*    -------------------------------
  4677     05  CAEFFDTL PIC S9(0004) COMP.
  4678     05  CAEFFDTF PIC  X(0001).
  4679     05  FILLER REDEFINES CAEFFDTF.
  4680         10  CAEFFDTA PIC  X(0001).
  4681     05  CAEFFDTI PIC  X(0008).
  4682*    -------------------------------
  4683     05  CAEXPDTL PIC S9(0004) COMP.
  4684     05  CAEXPDTF PIC  X(0001).
  4685     05  FILLER REDEFINES CAEXPDTF.
  4686         10  CAEXPDTA PIC  X(0001).
  4687     05  CAEXPDTI PIC  X(0008).
  4688*    -------------------------------
  4689     05  COMMLFL PIC S9(0004) COMP.
  4690     05  COMMLFF PIC  X(0001).
  4691     05  FILLER REDEFINES COMMLFF.
  4692         10  COMMLFA PIC  X(0001).
  4693     05  COMMLFI PIC  X(0006).
  4694*    -------------------------------
  4695     05  COMMAHL PIC S9(0004) COMP.
  4696     05  COMMAHF PIC  X(0001).
  4697     05  FILLER REDEFINES COMMAHF.
  4698         10  COMMAHA PIC  X(0001).
  4699     05  COMMAHI PIC  X(0006).
  4700*    -------------------------------
  4701     05  CERMSG1L PIC S9(0004) COMP.
  4702     05  CERMSG1F PIC  X(0001).
  4703     05  FILLER REDEFINES CERMSG1F.
  4704         10  CERMSG1A PIC  X(0001).
  4705     05  CERMSG1I PIC  X(0078).
  4706*    -------------------------------
  4707     05  CERMSG2L PIC S9(0004) COMP.
  4708     05  CERMSG2F PIC  X(0001).
  4709     05  FILLER REDEFINES CERMSG2F.
  4710         10  CERMSG2A PIC  X(0001).
  4711     05  CERMSG2I PIC  X(0078).
  4712*    -------------------------------
  4713     05  CERMSG3L PIC S9(0004) COMP.
  4714     05  CERMSG3F PIC  X(0001).
  4715     05  FILLER REDEFINES CERMSG3F.
  4716         10  CERMSG3A PIC  X(0001).
  4717     05  CERMSG3I PIC  X(0078).
  4718*    -------------------------------
  4719     05  CPFENTRL PIC S9(0004) COMP.
  4720     05  CPFENTRF PIC  X(0001).
  4721     05  FILLER REDEFINES CPFENTRF.
  4722         10  CPFENTRA PIC  X(0001).
  4723     05  CPFENTRI PIC  9(2).
  4724*    -------------------------------
  4725     05  CPF5HDRL PIC S9(0004) COMP.
  4726     05  CPF5HDRF PIC  X(0001).
  4727     05  FILLER REDEFINES CPF5HDRF.
  4728         10  CPF5HDRA PIC  X(0001).
  4729     05  CPF5HDRI PIC  X(0005).
  4730*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  89
* VP6311.cbl
  4731     05  CPF4HDRL PIC S9(0004) COMP.
  4732     05  CPF4HDRF PIC  X(0001).
  4733     05  FILLER REDEFINES CPF4HDRF.
  4734         10  CPF4HDRA PIC  X(0001).
  4735     05  CPF4HDRI PIC  X(0013).
  4736*    -------------------------------
  4737     05  CF15HDRL PIC S9(0004) COMP.
  4738     05  CF15HDRF PIC  X(0001).
  4739     05  FILLER REDEFINES CF15HDRF.
  4740         10  CF15HDRA PIC  X(0001).
  4741     05  CF15HDRI PIC  X(0022).
  4742 01  VP631CO REDEFINES VP631BI.
  4743     05  FILLER            PIC  X(0012).
  4744*    -------------------------------
  4745     05  FILLER            PIC  X(0003).
  4746     05  CDATEO PIC  X(0008).
  4747*    -------------------------------
  4748     05  FILLER            PIC  X(0003).
  4749     05  CTIMEO PIC  99.99.
  4750*    -------------------------------
  4751     05  FILLER            PIC  X(0003).
  4752     05  CHEADO PIC  X(0038).
  4753*    -------------------------------
  4754     05  FILLER            PIC  X(0003).
  4755     05  CCHGTO PIC  X(0004).
  4756*    -------------------------------
  4757     05  FILLER            PIC  X(0003).
  4758     05  CCHGO PIC  ZZZ9.
  4759*    -------------------------------
  4760     05  FILLER            PIC  X(0003).
  4761     05  CMAINTO PIC  X(0001).
  4762*    -------------------------------
  4763     05  FILLER            PIC  X(0003).
  4764     05  CMANTBYO PIC  X(0004).
  4765*    -------------------------------
  4766     05  FILLER            PIC  X(0003).
  4767     05  CCHGHDGO PIC  X(0003).
  4768*    -------------------------------
  4769     05  FILLER            PIC  X(0003).
  4770     05  CMANTDTO PIC  X(0008).
  4771*    -------------------------------
  4772     05  FILLER            PIC  X(0003).
  4773     05  CMANTATO PIC  99.99.
  4774*    -------------------------------
  4775     05  FILLER            PIC  X(0003).
  4776     05  CCSRO PIC  X(0004).
  4777*    -------------------------------
  4778     05  FILLER            PIC  X(0003).
  4779     05  CBATCHO PIC  X(0006).
  4780*    -------------------------------
  4781     05  FILLER            PIC  X(0003).
  4782     05  CSEQO PIC  X(0004).
  4783*    -------------------------------
  4784     05  FILLER            PIC  X(0003).
  4785     05  CMOENDTO PIC  X(0008).
  4786*    -------------------------------
  4787     05  FILLER            PIC  X(0003).
  4788     05  CCARRO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  90
* VP6311.cbl
  4789*    -------------------------------
  4790     05  FILLER            PIC  X(0003).
  4791     05  CGROUPO PIC  X(0006).
  4792*    -------------------------------
  4793     05  FILLER            PIC  X(0003).
  4794     05  CSTATEO PIC  X(0002).
  4795*    -------------------------------
  4796     05  FILLER            PIC  X(0003).
  4797     05  CACCTO PIC  X(0010).
  4798*    -------------------------------
  4799     05  FILLER            PIC  X(0003).
  4800     05  CORIGHDO PIC  X(0011).
  4801*    -------------------------------
  4802     05  FILLER            PIC  X(0003).
  4803     05  CORGNOO PIC  X(0006).
  4804*    -------------------------------
  4805     05  FILLER            PIC  X(0003).
  4806     05  CORGSEQO PIC  X(0004).
  4807*    -------------------------------
  4808     05  FILLER            PIC  X(0003).
  4809     05  CREFHDGO PIC  X(0010).
  4810*    -------------------------------
  4811     05  FILLER            PIC  X(0003).
  4812     05  CREFO PIC  X(0012).
  4813*    -------------------------------
  4814     05  FILLER            PIC  X(0003).
  4815     05  CNHINTO PIC  999999.99.
  4816*    -------------------------------
  4817     05  FILLER            PIC  X(0003).
  4818     05  CCERTNOO PIC  X(0010).
  4819*    -------------------------------
  4820     05  FILLER            PIC  X(0003).
  4821     05  CSUFIXO PIC  X(0001).
  4822*    -------------------------------
  4823     05  FILLER            PIC  X(0003).
  4824     05  CEFFDTO PIC  X(0008).
  4825*    -------------------------------
  4826     05  FILLER            PIC  X(0003).
  4827     05  CLSTNMO PIC  X(0015).
  4828*    -------------------------------
  4829     05  FILLER            PIC  X(0003).
  4830     05  CINAMEO PIC  X(0015).
  4831*    -------------------------------
  4832     05  FILLER            PIC  X(0003).
  4833     05  CINITSO PIC  X(0010).
  4834*    -------------------------------
  4835     05  FILLER            PIC  X(0003).
  4836     05  CCANREAO PIC  X(0001).
  4837*    -------------------------------
  4838     05  FILLER            PIC  X(0003).
  4839     05  CKIND1O PIC  X(0002).
  4840*    -------------------------------
  4841     05  FILLER            PIC  X(0003).
  4842     05  CCANDT1O PIC  X(0008).
  4843*    -------------------------------
  4844     05  FILLER            PIC  X(0003).
  4845     05  CREFND1O PIC  Z(7).99-.
  4846*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  91
* VP6311.cbl
  4847     05  FILLER            PIC  X(0003).
  4848     05  CMTHD1O PIC  X(0001).
  4849*    -------------------------------
  4850     05  FILLER            PIC  X(0003).
  4851     05  CKIND2O PIC  X(0002).
  4852*    -------------------------------
  4853     05  FILLER            PIC  X(0003).
  4854     05  CCANDT2O PIC  X(0008).
  4855*    -------------------------------
  4856     05  FILLER            PIC  X(0003).
  4857     05  CREFND2O PIC  Z(7).99-.
  4858*    -------------------------------
  4859     05  FILLER            PIC  X(0003).
  4860     05  CMTHD2O PIC  X(0001).
  4861*    -------------------------------
  4862     05  FILLER            PIC  X(0003).
  4863     05  CLIVESO PIC  X(0003).
  4864*    -------------------------------
  4865     05  FILLER            PIC  X(0003).
  4866     05  CFORCEO PIC  X(0001).
  4867*    -------------------------------
  4868     05  FILLER            PIC  X(0003).
  4869     05  CBILCDO PIC  X(0001).
  4870*    -------------------------------
  4871     05  FILLER            PIC  X(0003).
  4872     05  CCRFND1O PIC  Z(7).99-.
  4873*    -------------------------------
  4874     05  FILLER            PIC  X(0003).
  4875     05  CCRFND2O PIC  Z(7).99-.
  4876*    -------------------------------
  4877     05  FILLER            PIC  X(0003).
  4878     05  CBILIT1O PIC  X(0008).
  4879*    -------------------------------
  4880     05  FILLER            PIC  X(0003).
  4881     05  CDRFND1O PIC  Z(7).99-.
  4882*    -------------------------------
  4883     05  FILLER            PIC  X(0003).
  4884     05  CBILIT2O PIC  X(0008).
  4885*    -------------------------------
  4886     05  FILLER            PIC  X(0003).
  4887     05  CDRFND2O PIC  Z(7).99-.
  4888*    -------------------------------
  4889     05  FILLER            PIC  X(0003).
  4890     05  CCANTXTO PIC  X(0005).
  4891*    -------------------------------
  4892     05  FILLER            PIC  X(0003).
  4893     05  CCANFEEO PIC  Z9.
  4894*    -------------------------------
  4895     05  FILLER            PIC  X(0003).
  4896     05  CTERM1O PIC  ZZ9.
  4897*    -------------------------------
  4898     05  FILLER            PIC  X(0003).
  4899     05  CRTERM1O PIC  ZZ9.
  4900*    -------------------------------
  4901     05  FILLER            PIC  X(0003).
  4902     05  CPREM1O PIC  ZZZZZZ9.99-.
  4903*    -------------------------------
  4904     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  92
* VP6311.cbl
  4905     05  CTERM2O PIC  ZZ9.
  4906*    -------------------------------
  4907     05  FILLER            PIC  X(0003).
  4908     05  CRTERM2O PIC  ZZ9.
  4909*    -------------------------------
  4910     05  FILLER            PIC  X(0003).
  4911     05  CPREM2O PIC  ZZZZZZ9.99-.
  4912*    -------------------------------
  4913     05  FILLER            PIC  X(0003).
  4914     05  CENTRDTO PIC  X(0008).
  4915*    -------------------------------
  4916     05  FILLER            PIC  X(0003).
  4917     05  CPAYEEO PIC  X(0006).
  4918*    -------------------------------
  4919     05  FILLER            PIC  X(0003).
  4920     05  CRFNDSWO PIC  X(0003).
  4921*    -------------------------------
  4922     05  FILLER            PIC  X(0003).
  4923     05  CLFHDGO PIC  X(0006).
  4924*    -------------------------------
  4925     05  FILLER            PIC  X(0003).
  4926     05  CAHHDGO PIC  X(0006).
  4927*    -------------------------------
  4928     05  FILLER            PIC  X(0003).
  4929     05  CENTDTO PIC  X(0008).
  4930*    -------------------------------
  4931     05  FILLER            PIC  X(0003).
  4932     05  CENTBYO PIC  X(0004).
  4933*    -------------------------------
  4934     05  FILLER            PIC  X(0003).
  4935     05  CCHGCNTO PIC  X(0003).
  4936*    -------------------------------
  4937     05  FILLER            PIC  X(0003).
  4938     05  CLFREFNO PIC  X(0006).
  4939*    -------------------------------
  4940     05  FILLER            PIC  X(0003).
  4941     05  CAHREFNO PIC  X(0006).
  4942*    -------------------------------
  4943     05  FILLER            PIC  X(0003).
  4944     05  CREINCDO PIC  X(0003).
  4945*    -------------------------------
  4946     05  FILLER            PIC  X(0003).
  4947     05  CAEFFDTO PIC  X(0008).
  4948*    -------------------------------
  4949     05  FILLER            PIC  X(0003).
  4950     05  CAEXPDTO PIC  X(0008).
  4951*    -------------------------------
  4952     05  FILLER            PIC  X(0003).
  4953     05  COMMLFO PIC  .99999.
  4954*    -------------------------------
  4955     05  FILLER            PIC  X(0003).
  4956     05  COMMAHO PIC  .99999.
  4957*    -------------------------------
  4958     05  FILLER            PIC  X(0003).
  4959     05  CERMSG1O PIC  X(0078).
  4960*    -------------------------------
  4961     05  FILLER            PIC  X(0003).
  4962     05  CERMSG2O PIC  X(0078).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  93
* VP6311.cbl
  4963*    -------------------------------
  4964     05  FILLER            PIC  X(0003).
  4965     05  CERMSG3O PIC  X(0078).
  4966*    -------------------------------
  4967     05  FILLER            PIC  X(0003).
  4968     05  CPFENTRO PIC  X(0002).
  4969*    -------------------------------
  4970     05  FILLER            PIC  X(0003).
  4971     05  CPF5HDRO PIC  X(0005).
  4972*    -------------------------------
  4973     05  FILLER            PIC  X(0003).
  4974     05  CPF4HDRO PIC  X(0013).
  4975*    -------------------------------
  4976     05  FILLER            PIC  X(0003).
  4977     05  CF15HDRO PIC  X(0022).
  4978*    -------------------------------
  4979 01  VP631DI REDEFINES VP631BI.
  4980     05  FILLER            PIC  X(0012).
  4981*    -------------------------------
  4982     05  DDATEL PIC S9(0004) COMP.
  4983     05  DDATEF PIC  X(0001).
  4984     05  FILLER REDEFINES DDATEF.
  4985         10  DDATEA PIC  X(0001).
  4986     05  DDATEI PIC  X(0008).
  4987*    -------------------------------
  4988     05  DTIMEL PIC S9(0004) COMP.
  4989     05  DTIMEF PIC  X(0001).
  4990     05  FILLER REDEFINES DTIMEF.
  4991         10  DTIMEA PIC  X(0001).
  4992     05  DTIMEI PIC  X(0005).
  4993*    -------------------------------
  4994     05  DHEADL PIC S9(0004) COMP.
  4995     05  DHEADF PIC  X(0001).
  4996     05  FILLER REDEFINES DHEADF.
  4997         10  DHEADA PIC  X(0001).
  4998     05  DHEADI PIC  X(0038).
  4999*    -------------------------------
  5000     05  DLDATEL PIC S9(0004) COMP.
  5001     05  DLDATEF PIC  X(0001).
  5002     05  FILLER REDEFINES DLDATEF.
  5003         10  DLDATEA PIC  X(0001).
  5004     05  DLDATEI PIC  X(0010).
  5005*    -------------------------------
  5006     05  DBATCHL PIC S9(0004) COMP.
  5007     05  DBATCHF PIC  X(0001).
  5008     05  FILLER REDEFINES DBATCHF.
  5009         10  DBATCHA PIC  X(0001).
  5010     05  DBATCHI PIC  X(0011).
  5011*    -------------------------------
  5012     05  DACCTNML PIC S9(0004) COMP.
  5013     05  DACCTNMF PIC  X(0001).
  5014     05  FILLER REDEFINES DACCTNMF.
  5015         10  DACCTNMA PIC  X(0001).
  5016     05  DACCTNMI PIC  X(0030).
  5017*    -------------------------------
  5018     05  DPROCDTL PIC S9(0004) COMP.
  5019     05  DPROCDTF PIC  X(0001).
  5020     05  FILLER REDEFINES DPROCDTF.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  94
* VP6311.cbl
  5021         10  DPROCDTA PIC  X(0001).
  5022     05  DPROCDTI PIC  X(0008).
  5023*    -------------------------------
  5024     05  DINPUTL PIC S9(0004) COMP.
  5025     05  DINPUTF PIC  X(0001).
  5026     05  FILLER REDEFINES DINPUTF.
  5027         10  DINPUTA PIC  X(0001).
  5028     05  DINPUTI PIC  X(0008).
  5029*    -------------------------------
  5030     05  DMAINDTL PIC S9(0004) COMP.
  5031     05  DMAINDTF PIC  X(0001).
  5032     05  FILLER REDEFINES DMAINDTF.
  5033         10  DMAINDTA PIC  X(0001).
  5034     05  DMAINDTI PIC  X(0008).
  5035*    -------------------------------
  5036     05  DCARRL PIC S9(0004) COMP.
  5037     05  DCARRF PIC  X(0001).
  5038     05  FILLER REDEFINES DCARRF.
  5039         10  DCARRA PIC  X(0001).
  5040     05  DCARRI PIC  X(0001).
  5041*    -------------------------------
  5042     05  DGROUPL PIC S9(0004) COMP.
  5043     05  DGROUPF PIC  X(0001).
  5044     05  FILLER REDEFINES DGROUPF.
  5045         10  DGROUPA PIC  X(0001).
  5046     05  DGROUPI PIC  X(0006).
  5047*    -------------------------------
  5048     05  DSTATEL PIC S9(0004) COMP.
  5049     05  DSTATEF PIC  X(0001).
  5050     05  FILLER REDEFINES DSTATEF.
  5051         10  DSTATEA PIC  X(0001).
  5052     05  DSTATEI PIC  X(0002).
  5053*    -------------------------------
  5054     05  DACCTL PIC S9(0004) COMP.
  5055     05  DACCTF PIC  X(0001).
  5056     05  FILLER REDEFINES DACCTF.
  5057         10  DACCTA PIC  X(0001).
  5058     05  DACCTI PIC  X(0010).
  5059*    -------------------------------
  5060     05  DRECVDTL PIC S9(0004) COMP.
  5061     05  DRECVDTF PIC  X(0001).
  5062     05  FILLER REDEFINES DRECVDTF.
  5063         10  DRECVDTA PIC  X(0001).
  5064     05  DRECVDTI PIC  X(0008).
  5065*    -------------------------------
  5066     05  DCSRL PIC S9(0004) COMP.
  5067     05  DCSRF PIC  X(0001).
  5068     05  FILLER REDEFINES DCSRF.
  5069         10  DCSRA PIC  X(0001).
  5070     05  DCSRI PIC  X(0004).
  5071*    -------------------------------
  5072     05  DREFHDGL PIC S9(0004) COMP.
  5073     05  DREFHDGF PIC  X(0001).
  5074     05  FILLER REDEFINES DREFHDGF.
  5075         10  DREFHDGA PIC  X(0001).
  5076     05  DREFHDGI PIC  X(0010).
  5077*    -------------------------------
  5078     05  DREFL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  95
* VP6311.cbl
  5079     05  DREFF PIC  X(0001).
  5080     05  FILLER REDEFINES DREFF.
  5081         10  DREFA PIC  X(0001).
  5082     05  DREFI PIC  X(0012).
  5083*    -------------------------------
  5084     05  DLFPHDGL PIC S9(0004) COMP.
  5085     05  DLFPHDGF PIC  X(0001).
  5086     05  FILLER REDEFINES DLFPHDGF.
  5087         10  DLFPHDGA PIC  X(0001).
  5088     05  DLFPHDGI PIC  X(0010).
  5089*    -------------------------------
  5090     05  DAHPHDGL PIC S9(0004) COMP.
  5091     05  DAHPHDGF PIC  X(0001).
  5092     05  FILLER REDEFINES DAHPHDGF.
  5093         10  DAHPHDGA PIC  X(0001).
  5094     05  DAHPHDGI PIC  X(0010).
  5095*    -------------------------------
  5096     05  DLFRHDGL PIC S9(0004) COMP.
  5097     05  DLFRHDGF PIC  X(0001).
  5098     05  FILLER REDEFINES DLFRHDGF.
  5099         10  DLFRHDGA PIC  X(0001).
  5100     05  DLFRHDGI PIC  X(0009).
  5101*    -------------------------------
  5102     05  DAHRHDGL PIC S9(0004) COMP.
  5103     05  DAHRHDGF PIC  X(0001).
  5104     05  FILLER REDEFINES DAHRHDGF.
  5105         10  DAHRHDGA PIC  X(0001).
  5106     05  DAHRHDGI PIC  X(0009).
  5107*    -------------------------------
  5108     05  DRISSL PIC S9(0004) COMP.
  5109     05  DRISSF PIC  X(0001).
  5110     05  FILLER REDEFINES DRISSF.
  5111         10  DRISSA PIC  X(0001).
  5112     05  DRISSI PIC  X(0005).
  5113*    -------------------------------
  5114     05  DRLFPRML PIC S9(0004) COMP.
  5115     05  DRLFPRMF PIC  X(0001).
  5116     05  FILLER REDEFINES DRLFPRMF.
  5117         10  DRLFPRMA PIC  X(0001).
  5118     05  DRLFPRMI PIC  S9(9)V99.
  5119*    -------------------------------
  5120     05  DRAHPRML PIC S9(0004) COMP.
  5121     05  DRAHPRMF PIC  X(0001).
  5122     05  FILLER REDEFINES DRAHPRMF.
  5123         10  DRAHPRMA PIC  X(0001).
  5124     05  DRAHPRMI PIC  S9(9)V99.
  5125*    -------------------------------
  5126     05  DRCANCL PIC S9(0004) COMP.
  5127     05  DRCANCF PIC  X(0001).
  5128     05  FILLER REDEFINES DRCANCF.
  5129         10  DRCANCA PIC  X(0001).
  5130     05  DRCANCI PIC  X(0005).
  5131*    -------------------------------
  5132     05  DRLFRFDL PIC S9(0004) COMP.
  5133     05  DRLFRFDF PIC  X(0001).
  5134     05  FILLER REDEFINES DRLFRFDF.
  5135         10  DRLFRFDA PIC  X(0001).
  5136     05  DRLFRFDI PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  96
* VP6311.cbl
  5137*    -------------------------------
  5138     05  DRAHRFDL PIC S9(0004) COMP.
  5139     05  DRAHRFDF PIC  X(0001).
  5140     05  FILLER REDEFINES DRAHRFDF.
  5141         10  DRAHRFDA PIC  X(0001).
  5142     05  DRAHRFDI PIC  S9(9)V99.
  5143*    -------------------------------
  5144     05  DEISSL PIC S9(0004) COMP.
  5145     05  DEISSF PIC  X(0001).
  5146     05  FILLER REDEFINES DEISSF.
  5147         10  DEISSA PIC  X(0001).
  5148     05  DEISSI PIC  X(0005).
  5149*    -------------------------------
  5150     05  DELFPRML PIC S9(0004) COMP.
  5151     05  DELFPRMF PIC  X(0001).
  5152     05  FILLER REDEFINES DELFPRMF.
  5153         10  DELFPRMA PIC  X(0001).
  5154     05  DELFPRMI PIC  X(0011).
  5155*    -------------------------------
  5156     05  DEAHPRML PIC S9(0004) COMP.
  5157     05  DEAHPRMF PIC  X(0001).
  5158     05  FILLER REDEFINES DEAHPRMF.
  5159         10  DEAHPRMA PIC  X(0001).
  5160     05  DEAHPRMI PIC  X(0011).
  5161*    -------------------------------
  5162     05  DECANCL PIC S9(0004) COMP.
  5163     05  DECANCF PIC  X(0001).
  5164     05  FILLER REDEFINES DECANCF.
  5165         10  DECANCA PIC  X(0001).
  5166     05  DECANCI PIC  X(0005).
  5167*    -------------------------------
  5168     05  DELFRFDL PIC S9(0004) COMP.
  5169     05  DELFRFDF PIC  X(0001).
  5170     05  FILLER REDEFINES DELFRFDF.
  5171         10  DELFRFDA PIC  X(0001).
  5172     05  DELFRFDI PIC  X(0011).
  5173*    -------------------------------
  5174     05  DEAHRFDL PIC S9(0004) COMP.
  5175     05  DEAHRFDF PIC  X(0001).
  5176     05  FILLER REDEFINES DEAHRFDF.
  5177         10  DEAHRFDA PIC  X(0001).
  5178     05  DEAHRFDI PIC  X(0011).
  5179*    -------------------------------
  5180     05  DCISSL PIC S9(0004) COMP.
  5181     05  DCISSF PIC  X(0001).
  5182     05  FILLER REDEFINES DCISSF.
  5183         10  DCISSA PIC  X(0001).
  5184     05  DCISSI PIC  X(0005).
  5185*    -------------------------------
  5186     05  DCLFPRML PIC S9(0004) COMP.
  5187     05  DCLFPRMF PIC  X(0001).
  5188     05  FILLER REDEFINES DCLFPRMF.
  5189         10  DCLFPRMA PIC  X(0001).
  5190     05  DCLFPRMI PIC  X(0011).
  5191*    -------------------------------
  5192     05  DCAHPRML PIC S9(0004) COMP.
  5193     05  DCAHPRMF PIC  X(0001).
  5194     05  FILLER REDEFINES DCAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  97
* VP6311.cbl
  5195         10  DCAHPRMA PIC  X(0001).
  5196     05  DCAHPRMI PIC  X(0011).
  5197*    -------------------------------
  5198     05  DCCANCL PIC S9(0004) COMP.
  5199     05  DCCANCF PIC  X(0001).
  5200     05  FILLER REDEFINES DCCANCF.
  5201         10  DCCANCA PIC  X(0001).
  5202     05  DCCANCI PIC  X(0005).
  5203*    -------------------------------
  5204     05  DCLFRFDL PIC S9(0004) COMP.
  5205     05  DCLFRFDF PIC  X(0001).
  5206     05  FILLER REDEFINES DCLFRFDF.
  5207         10  DCLFRFDA PIC  X(0001).
  5208     05  DCLFRFDI PIC  X(0011).
  5209*    -------------------------------
  5210     05  DCAHRFDL PIC S9(0004) COMP.
  5211     05  DCAHRFDF PIC  X(0001).
  5212     05  FILLER REDEFINES DCAHRFDF.
  5213         10  DCAHRFDA PIC  X(0001).
  5214     05  DCAHRFDI PIC  X(0011).
  5215*    -------------------------------
  5216     05  DOISSL PIC S9(0004) COMP.
  5217     05  DOISSF PIC  X(0001).
  5218     05  FILLER REDEFINES DOISSF.
  5219         10  DOISSA PIC  X(0001).
  5220     05  DOISSI PIC  X(0005).
  5221*    -------------------------------
  5222     05  DOLFPRML PIC S9(0004) COMP.
  5223     05  DOLFPRMF PIC  X(0001).
  5224     05  FILLER REDEFINES DOLFPRMF.
  5225         10  DOLFPRMA PIC  X(0001).
  5226     05  DOLFPRMI PIC  X(0011).
  5227*    -------------------------------
  5228     05  DOAHPRML PIC S9(0004) COMP.
  5229     05  DOAHPRMF PIC  X(0001).
  5230     05  FILLER REDEFINES DOAHPRMF.
  5231         10  DOAHPRMA PIC  X(0001).
  5232     05  DOAHPRMI PIC  X(0011).
  5233*    -------------------------------
  5234     05  DOCANCL PIC S9(0004) COMP.
  5235     05  DOCANCF PIC  X(0001).
  5236     05  FILLER REDEFINES DOCANCF.
  5237         10  DOCANCA PIC  X(0001).
  5238     05  DOCANCI PIC  X(0005).
  5239*    -------------------------------
  5240     05  DOLFRFDL PIC S9(0004) COMP.
  5241     05  DOLFRFDF PIC  X(0001).
  5242     05  FILLER REDEFINES DOLFRFDF.
  5243         10  DOLFRFDA PIC  X(0001).
  5244     05  DOLFRFDI PIC  X(0011).
  5245*    -------------------------------
  5246     05  DOAHRFDL PIC S9(0004) COMP.
  5247     05  DOAHRFDF PIC  X(0001).
  5248     05  FILLER REDEFINES DOAHRFDF.
  5249         10  DOAHRFDA PIC  X(0001).
  5250     05  DOAHRFDI PIC  X(0011).
  5251*    -------------------------------
  5252     05  DITOTALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  98
* VP6311.cbl
  5253     05  DITOTALF PIC  X(0001).
  5254     05  FILLER REDEFINES DITOTALF.
  5255         10  DITOTALA PIC  X(0001).
  5256     05  DITOTALI PIC  X(0005).
  5257*    -------------------------------
  5258     05  DIFATALL PIC S9(0004) COMP.
  5259     05  DIFATALF PIC  X(0001).
  5260     05  FILLER REDEFINES DIFATALF.
  5261         10  DIFATALA PIC  X(0001).
  5262     05  DIFATALI PIC  X(0005).
  5263*    -------------------------------
  5264     05  DIFORCEL PIC S9(0004) COMP.
  5265     05  DIFORCEF PIC  X(0001).
  5266     05  FILLER REDEFINES DIFORCEF.
  5267         10  DIFORCEA PIC  X(0001).
  5268     05  DIFORCEI PIC  X(0005).
  5269*    -------------------------------
  5270     05  DIHOLDL PIC S9(0004) COMP.
  5271     05  DIHOLDF PIC  X(0001).
  5272     05  FILLER REDEFINES DIHOLDF.
  5273         10  DIHOLDA PIC  X(0001).
  5274     05  DIHOLDI PIC  X(0005).
  5275*    -------------------------------
  5276     05  DIAVAILL PIC S9(0004) COMP.
  5277     05  DIAVAILF PIC  X(0001).
  5278     05  FILLER REDEFINES DIAVAILF.
  5279         10  DIAVAILA PIC  X(0001).
  5280     05  DIAVAILI PIC  X(0005).
  5281*    -------------------------------
  5282     05  DIGPREML PIC S9(0004) COMP.
  5283     05  DIGPREMF PIC  X(0001).
  5284     05  FILLER REDEFINES DIGPREMF.
  5285         10  DIGPREMA PIC  X(0001).
  5286     05  DIGPREMI PIC  X(0011).
  5287*    -------------------------------
  5288     05  DIBPREML PIC S9(0004) COMP.
  5289     05  DIBPREMF PIC  X(0001).
  5290     05  FILLER REDEFINES DIBPREMF.
  5291         10  DIBPREMA PIC  X(0001).
  5292     05  DIBPREMI PIC  X(0011).
  5293*    -------------------------------
  5294     05  DCTOTALL PIC S9(0004) COMP.
  5295     05  DCTOTALF PIC  X(0001).
  5296     05  FILLER REDEFINES DCTOTALF.
  5297         10  DCTOTALA PIC  X(0001).
  5298     05  DCTOTALI PIC  X(0005).
  5299*    -------------------------------
  5300     05  DCFATALL PIC S9(0004) COMP.
  5301     05  DCFATALF PIC  X(0001).
  5302     05  FILLER REDEFINES DCFATALF.
  5303         10  DCFATALA PIC  X(0001).
  5304     05  DCFATALI PIC  X(0005).
  5305*    -------------------------------
  5306     05  DCFORCEL PIC S9(0004) COMP.
  5307     05  DCFORCEF PIC  X(0001).
  5308     05  FILLER REDEFINES DCFORCEF.
  5309         10  DCFORCEA PIC  X(0001).
  5310     05  DCFORCEI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page  99
* VP6311.cbl
  5311*    -------------------------------
  5312     05  DCHOLDL PIC S9(0004) COMP.
  5313     05  DCHOLDF PIC  X(0001).
  5314     05  FILLER REDEFINES DCHOLDF.
  5315         10  DCHOLDA PIC  X(0001).
  5316     05  DCHOLDI PIC  X(0005).
  5317*    -------------------------------
  5318     05  DCAVAILL PIC S9(0004) COMP.
  5319     05  DCAVAILF PIC  X(0001).
  5320     05  FILLER REDEFINES DCAVAILF.
  5321         10  DCAVAILA PIC  X(0001).
  5322     05  DCAVAILI PIC  X(0005).
  5323*    -------------------------------
  5324     05  DCGPREML PIC S9(0004) COMP.
  5325     05  DCGPREMF PIC  X(0001).
  5326     05  FILLER REDEFINES DCGPREMF.
  5327         10  DCGPREMA PIC  X(0001).
  5328     05  DCGPREMI PIC  X(0011).
  5329*    -------------------------------
  5330     05  DCBPREML PIC S9(0004) COMP.
  5331     05  DCBPREMF PIC  X(0001).
  5332     05  FILLER REDEFINES DCBPREMF.
  5333         10  DCBPREMA PIC  X(0001).
  5334     05  DCBPREMI PIC  X(0011).
  5335*    -------------------------------
  5336     05  DNTOTALL PIC S9(0004) COMP.
  5337     05  DNTOTALF PIC  X(0001).
  5338     05  FILLER REDEFINES DNTOTALF.
  5339         10  DNTOTALA PIC  X(0001).
  5340     05  DNTOTALI PIC  X(0005).
  5341*    -------------------------------
  5342     05  DNFATALL PIC S9(0004) COMP.
  5343     05  DNFATALF PIC  X(0001).
  5344     05  FILLER REDEFINES DNFATALF.
  5345         10  DNFATALA PIC  X(0001).
  5346     05  DNFATALI PIC  X(0005).
  5347*    -------------------------------
  5348     05  DNFORCEL PIC S9(0004) COMP.
  5349     05  DNFORCEF PIC  X(0001).
  5350     05  FILLER REDEFINES DNFORCEF.
  5351         10  DNFORCEA PIC  X(0001).
  5352     05  DNFORCEI PIC  X(0005).
  5353*    -------------------------------
  5354     05  DNHOLDL PIC S9(0004) COMP.
  5355     05  DNHOLDF PIC  X(0001).
  5356     05  FILLER REDEFINES DNHOLDF.
  5357         10  DNHOLDA PIC  X(0001).
  5358     05  DNHOLDI PIC  X(0005).
  5359*    -------------------------------
  5360     05  DNAVAILL PIC S9(0004) COMP.
  5361     05  DNAVAILF PIC  X(0001).
  5362     05  FILLER REDEFINES DNAVAILF.
  5363         10  DNAVAILA PIC  X(0001).
  5364     05  DNAVAILI PIC  X(0005).
  5365*    -------------------------------
  5366     05  DNGPREML PIC S9(0004) COMP.
  5367     05  DNGPREMF PIC  X(0001).
  5368     05  FILLER REDEFINES DNGPREMF.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 100
* VP6311.cbl
  5369         10  DNGPREMA PIC  X(0001).
  5370     05  DNGPREMI PIC  X(0011).
  5371*    -------------------------------
  5372     05  DNBPREML PIC S9(0004) COMP.
  5373     05  DNBPREMF PIC  X(0001).
  5374     05  FILLER REDEFINES DNBPREMF.
  5375         10  DNBPREMA PIC  X(0001).
  5376     05  DNBPREMI PIC  X(0011).
  5377*    -------------------------------
  5378     05  DERMSGL PIC S9(0004) COMP.
  5379     05  DERMSGF PIC  X(0001).
  5380     05  FILLER REDEFINES DERMSGF.
  5381         10  DERMSGA PIC  X(0001).
  5382     05  DERMSGI PIC  X(0075).
  5383*    -------------------------------
  5384     05  DPFENTRL PIC S9(0004) COMP.
  5385     05  DPFENTRF PIC  X(0001).
  5386     05  FILLER REDEFINES DPFENTRF.
  5387         10  DPFENTRA PIC  X(0001).
  5388     05  DPFENTRI PIC  9(2).
  5389 01  VP631DO REDEFINES VP631BI.
  5390     05  FILLER            PIC  X(0012).
  5391*    -------------------------------
  5392     05  FILLER            PIC  X(0003).
  5393     05  DDATEO PIC  X(0008).
  5394*    -------------------------------
  5395     05  FILLER            PIC  X(0003).
  5396     05  DTIMEO PIC  99.99.
  5397*    -------------------------------
  5398     05  FILLER            PIC  X(0003).
  5399     05  DHEADO PIC  X(0038).
  5400*    -------------------------------
  5401     05  FILLER            PIC  X(0003).
  5402     05  DLDATEO PIC  X(0010).
  5403*    -------------------------------
  5404     05  FILLER            PIC  X(0003).
  5405     05  DBATCHO PIC  X(0011).
  5406*    -------------------------------
  5407     05  FILLER            PIC  X(0003).
  5408     05  DACCTNMO PIC  X(0030).
  5409*    -------------------------------
  5410     05  FILLER            PIC  X(0003).
  5411     05  DPROCDTO PIC  X(0008).
  5412*    -------------------------------
  5413     05  FILLER            PIC  X(0003).
  5414     05  DINPUTO PIC  X(0008).
  5415*    -------------------------------
  5416     05  FILLER            PIC  X(0003).
  5417     05  DMAINDTO PIC  X(0008).
  5418*    -------------------------------
  5419     05  FILLER            PIC  X(0003).
  5420     05  DCARRO PIC  X(0001).
  5421*    -------------------------------
  5422     05  FILLER            PIC  X(0003).
  5423     05  DGROUPO PIC  X(0006).
  5424*    -------------------------------
  5425     05  FILLER            PIC  X(0003).
  5426     05  DSTATEO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 101
* VP6311.cbl
  5427*    -------------------------------
  5428     05  FILLER            PIC  X(0003).
  5429     05  DACCTO PIC  X(0010).
  5430*    -------------------------------
  5431     05  FILLER            PIC  X(0003).
  5432     05  DRECVDTO PIC  X(0008).
  5433*    -------------------------------
  5434     05  FILLER            PIC  X(0003).
  5435     05  DCSRO PIC  X(0004).
  5436*    -------------------------------
  5437     05  FILLER            PIC  X(0003).
  5438     05  DREFHDGO PIC  X(0010).
  5439*    -------------------------------
  5440     05  FILLER            PIC  X(0003).
  5441     05  DREFO PIC  X(0012).
  5442*    -------------------------------
  5443     05  FILLER            PIC  X(0003).
  5444     05  DLFPHDGO PIC  X(0010).
  5445*    -------------------------------
  5446     05  FILLER            PIC  X(0003).
  5447     05  DAHPHDGO PIC  X(0010).
  5448*    -------------------------------
  5449     05  FILLER            PIC  X(0003).
  5450     05  DLFRHDGO PIC  X(0009).
  5451*    -------------------------------
  5452     05  FILLER            PIC  X(0003).
  5453     05  DAHRHDGO PIC  X(0009).
  5454*    -------------------------------
  5455     05  FILLER            PIC  X(0003).
  5456     05  DRISSO PIC  ZZ99-.
  5457*    -------------------------------
  5458     05  FILLER            PIC  X(0003).
  5459     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5460*    -------------------------------
  5461     05  FILLER            PIC  X(0003).
  5462     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5463*    -------------------------------
  5464     05  FILLER            PIC  X(0003).
  5465     05  DRCANCO PIC  ZZ99-.
  5466*    -------------------------------
  5467     05  FILLER            PIC  X(0003).
  5468     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5469*    -------------------------------
  5470     05  FILLER            PIC  X(0003).
  5471     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5472*    -------------------------------
  5473     05  FILLER            PIC  X(0003).
  5474     05  DEISSO PIC  ZZ99-.
  5475*    -------------------------------
  5476     05  FILLER            PIC  X(0003).
  5477     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5478*    -------------------------------
  5479     05  FILLER            PIC  X(0003).
  5480     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5481*    -------------------------------
  5482     05  FILLER            PIC  X(0003).
  5483     05  DECANCO PIC  ZZ99-.
  5484*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 102
* VP6311.cbl
  5485     05  FILLER            PIC  X(0003).
  5486     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5487*    -------------------------------
  5488     05  FILLER            PIC  X(0003).
  5489     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5490*    -------------------------------
  5491     05  FILLER            PIC  X(0003).
  5492     05  DCISSO PIC  ZZ99-.
  5493*    -------------------------------
  5494     05  FILLER            PIC  X(0003).
  5495     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5496*    -------------------------------
  5497     05  FILLER            PIC  X(0003).
  5498     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5499*    -------------------------------
  5500     05  FILLER            PIC  X(0003).
  5501     05  DCCANCO PIC  ZZ99-.
  5502*    -------------------------------
  5503     05  FILLER            PIC  X(0003).
  5504     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5505*    -------------------------------
  5506     05  FILLER            PIC  X(0003).
  5507     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5508*    -------------------------------
  5509     05  FILLER            PIC  X(0003).
  5510     05  DOISSO PIC  ZZ99-.
  5511*    -------------------------------
  5512     05  FILLER            PIC  X(0003).
  5513     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5514*    -------------------------------
  5515     05  FILLER            PIC  X(0003).
  5516     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5517*    -------------------------------
  5518     05  FILLER            PIC  X(0003).
  5519     05  DOCANCO PIC  ZZ99-.
  5520*    -------------------------------
  5521     05  FILLER            PIC  X(0003).
  5522     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5523*    -------------------------------
  5524     05  FILLER            PIC  X(0003).
  5525     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5526*    -------------------------------
  5527     05  FILLER            PIC  X(0003).
  5528     05  DITOTALO PIC  ZZZ99.
  5529*    -------------------------------
  5530     05  FILLER            PIC  X(0003).
  5531     05  DIFATALO PIC  ZZZ99.
  5532*    -------------------------------
  5533     05  FILLER            PIC  X(0003).
  5534     05  DIFORCEO PIC  ZZZ99.
  5535*    -------------------------------
  5536     05  FILLER            PIC  X(0003).
  5537     05  DIHOLDO PIC  ZZZ99.
  5538*    -------------------------------
  5539     05  FILLER            PIC  X(0003).
  5540     05  DIAVAILO PIC  ZZZ99.
  5541*    -------------------------------
  5542     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 103
* VP6311.cbl
  5543     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5544*    -------------------------------
  5545     05  FILLER            PIC  X(0003).
  5546     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5547*    -------------------------------
  5548     05  FILLER            PIC  X(0003).
  5549     05  DCTOTALO PIC  ZZZ99.
  5550*    -------------------------------
  5551     05  FILLER            PIC  X(0003).
  5552     05  DCFATALO PIC  ZZZ99.
  5553*    -------------------------------
  5554     05  FILLER            PIC  X(0003).
  5555     05  DCFORCEO PIC  ZZZ99.
  5556*    -------------------------------
  5557     05  FILLER            PIC  X(0003).
  5558     05  DCHOLDO PIC  ZZZ99.
  5559*    -------------------------------
  5560     05  FILLER            PIC  X(0003).
  5561     05  DCAVAILO PIC  ZZZ99.
  5562*    -------------------------------
  5563     05  FILLER            PIC  X(0003).
  5564     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5565*    -------------------------------
  5566     05  FILLER            PIC  X(0003).
  5567     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5568*    -------------------------------
  5569     05  FILLER            PIC  X(0003).
  5570     05  DNTOTALO PIC  ---99.
  5571*    -------------------------------
  5572     05  FILLER            PIC  X(0003).
  5573     05  DNFATALO PIC  ---99.
  5574*    -------------------------------
  5575     05  FILLER            PIC  X(0003).
  5576     05  DNFORCEO PIC  ---99.
  5577*    -------------------------------
  5578     05  FILLER            PIC  X(0003).
  5579     05  DNHOLDO PIC  ---99.
  5580*    -------------------------------
  5581     05  FILLER            PIC  X(0003).
  5582     05  DNAVAILO PIC  ---99.
  5583*    -------------------------------
  5584     05  FILLER            PIC  X(0003).
  5585     05  DNGPREMO PIC  -------9.99.
  5586*    -------------------------------
  5587     05  FILLER            PIC  X(0003).
  5588     05  DNBPREMO PIC  -------9.99.
  5589*    -------------------------------
  5590     05  FILLER            PIC  X(0003).
  5591     05  DERMSGO PIC  X(0075).
  5592*    -------------------------------
  5593     05  FILLER            PIC  X(0003).
  5594     05  DPFENTRO PIC  X(0002).
  5595*    -------------------------------
  5596 01  MAP-B REDEFINES VP631BI.
  5597     12  FILLER                  PIC X(569).
  5598*    12  FILLER                  PIC X(512).
  5599*    12  FILLER                  PIC X(510).
  5600     12  MAP-B-COVERAGE OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 104
* VP6311.cbl
  5601         16  BKIND-LEN               PIC S9(4)  COMP.
  5602         16  BKIND-ATTRB             PIC X.
  5603         16  BKIND                   PIC XX.
  5604         16  BTYPE-LEN               PIC S9(4)  COMP.
  5605         16  BTYPE-ATTRB             PIC X.
  5606         16  BTYPE                   PIC X(3).
  5607         16  BTERM-LEN               PIC S9(4)  COMP.
  5608         16  BTERM-ATTRB             PIC X.
  5609         16  BTERMI                  PIC 999.
  5610         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5611         16  BBEN-LEN                PIC S9(4)  COMP.
  5612         16  BBEN-ATTRB              PIC X.
  5613         16  BBENI                   PIC 9(10)V99.
  5614*        16  BBENI                   PIC 9(12).
  5615         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5616         16  BPREM-LEN               PIC S9(4)  COMP.
  5617         16  BPREM-ATTRB             PIC X.
  5618         16  BPREMI                  PIC S9(9)V99.
  5619*        16  BPREMI                  PIC 9(11).
  5620         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5621         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5622         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5623         16  BEXPIRE-ATTRB           PIC X.
  5624         16  BEXPIRE                 PIC X(8).
  5625         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5626         16  BCRIT-PERD-ATTRB        PIC X.
  5627         16  BCRIT-PERDI             PIC 99.
  5628         16  BCRIT-PERDO REDEFINES
  5629                         BCRIT-PERDI PIC ZZ.
  5630         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5631         16  BALT-BEN-ATTRB          PIC X.
  5632         16  BALT-BENI               PIC 9(10)V99.
  5633*        16  BALT-BENI               PIC 9(12).
  5634         16  BALT-BENO REDEFINES
  5635                           BALT-BENI PIC Z(9).ZZ.
  5636         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5637         16  BALT-PREM-ATTRB         PIC X.
  5638         16  BALT-PREMI              PIC 9(9)V99.
  5639*        16  BALT-PREMI              PIC 9(11).
  5640         16  BALT-PREMO REDEFINES
  5641                          BALT-PREMI PIC Z(7).ZZ-.
  5642         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5643         16  BBEN-CD-ATTRB           PIC X.
  5644         16  BBEN-CD                 PIC XXX.
  5645         16  BCPREM-LEN              PIC S9(4)  COMP.
  5646         16  BCPREM-ATTRB            PIC X.
  5647         16  BCPREMI                 PIC S9(9)V99.
  5648*        16  BCPREMI                 PIC X(11).
  5649         16  BCPREMO REDEFINES BCPREMI
  5650                                     PIC Z(7).99-.
  5651         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5652         16  BCALT-PREM-ATTRB        PIC X.
  5653         16  BCALT-PREM              PIC Z(7).99-.
  5654         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5655         16  BBEN-ABBR-ATTRB         PIC X.
  5656         16  BBEN-ABBR               PIC X(5).
  5657         16  BDIFF-LEN               PIC S9(4)  COMP.
  5658         16  BDIFF-ATTRB             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 105
* VP6311.cbl
  5659         16  BDIFFO                  PIC Z(7).99-.
  5660         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5661         16  BBILL-LIT-ATTRB         PIC X.
  5662         16  BBILL-LIT               PIC X(8).
  5663         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5664         16  BDALT-PREM-ATTRB        PIC X.
  5665         16  BDALT-PREM              PIC Z(7).99-.
  5666
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 106
* VP6311.cbl
  5668
  5669****************************************************************
  5670*
  5671* Copyright (c) 2007-2013 Dell Inc.
  5672* All rights reserved.
  5673*
  5674****************************************************************
  5675 01  DFHEIV.
  5676   02  DFHEIV0               PIC X(35).
  5677   02  DFHEIV1               PIC X(08).
  5678   02  DFHEIV2               PIC X(08).
  5679   02  DFHEIV3               PIC X(08).
  5680   02  DFHEIV4               PIC X(06).
  5681   02  DFHEIV5               PIC X(04).
  5682   02  DFHEIV6               PIC X(04).
  5683   02  DFHEIV7               PIC X(02).
  5684   02  DFHEIV8               PIC X(02).
  5685   02  DFHEIV9               PIC X(01).
  5686   02  DFHEIV10              PIC S9(7) COMP-3.
  5687   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5688   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5689   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5690   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5691   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5692   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5693   02  DFHEIV17              PIC X(04).
  5694   02  DFHEIV18              PIC X(04).
  5695   02  DFHEIV19              PIC X(04).
  5696   02  DFHEIV20              USAGE IS POINTER.
  5697   02  DFHEIV21              USAGE IS POINTER.
  5698   02  DFHEIV22              USAGE IS POINTER.
  5699   02  DFHEIV23              USAGE IS POINTER.
  5700   02  DFHEIV24              USAGE IS POINTER.
  5701   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5702   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5703   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5704   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5705   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5706   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5707   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5708   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5709   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5710   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5711   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5712   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5713   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5714   02  FILLER                PIC X(02).
  5715   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5716   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5717   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5718   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5719   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5720   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5721   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5722 LINKAGE  SECTION.
  5723*****************************************************************
  5724*                                                               *
  5725* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 107
* VP6311.cbl
  5726* All rights reserved.                                          *
  5727*                                                               *
  5728*****************************************************************
  5729 01  dfheiblk.
  5730     02  eibtime          pic s9(7) comp-3.
  5731     02  eibdate          pic s9(7) comp-3.
  5732     02  eibtrnid         pic x(4).
  5733     02  eibtaskn         pic s9(7) comp-3.
  5734     02  eibtrmid         pic x(4).
  5735     02  dfheigdi         pic s9(4) comp.
  5736     02  eibcposn         pic s9(4) comp.
  5737     02  eibcalen         pic s9(4) comp.
  5738     02  eibaid           pic x(1).
  5739     02  eibfiller1       pic x(1).
  5740     02  eibfn            pic x(2).
  5741     02  eibfiller2       pic x(2).
  5742     02  eibrcode         pic x(6).
  5743     02  eibfiller3       pic x(2).
  5744     02  eibds            pic x(8).
  5745     02  eibreqid         pic x(8).
  5746     02  eibrsrce         pic x(8).
  5747     02  eibsync          pic x(1).
  5748     02  eibfree          pic x(1).
  5749     02  eibrecv          pic x(1).
  5750     02  eibsend          pic x(1).
  5751     02  eibatt           pic x(1).
  5752     02  eibeoc           pic x(1).
  5753     02  eibfmh           pic x(1).
  5754     02  eibcompl         pic x(1).
  5755     02  eibsig           pic x(1).
  5756     02  eibconf          pic x(1).
  5757     02  eiberr           pic x(1).
  5758     02  eibrldbk         pic x(1).
  5759     02  eiberrcd         pic x(4).
  5760     02  eibsynrb         pic x(1).
  5761     02  eibnodat         pic x(1).
  5762     02  eibfiller5       pic x(2).
  5763     02  eibresp          pic s9(8) comp.
  5764     02  eibresp2         pic s9(8) comp.
  5765     02  dfheigdj         pic s9(4) comp.
  5766     02  dfheigdk         pic s9(4) comp.
  5767 01  DFHCOMMAREA                 PIC X(1300).
  5768*                                COPY ERCPNDB.
  5769******************************************************************
  5770*                                                                *
  5771*                                                                *
  5772*                            ERCPNDB.                            *
  5773*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5774*                            VMOD=2.025                          *
  5775*                                                                *
  5776*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5777*                                                                *
  5778******************************************************************
  5779*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5780*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5781******************************************************************
  5782*                                                                *
  5783*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 108
* VP6311.cbl
  5784*   FILE TYPE = VSAM,KSDS                                        *
  5785*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5786*                                                                *
  5787*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5788*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5789*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5790*                                                 RKP=13,LEN=36  *
  5791*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5792*                                      AND CHG-SEQ.)             *
  5793*                                                RKP=49,LEN=11   *
  5794*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5795*                                      AND CHG-SEQ.)             *
  5796*                                                RKP=60,LEN=15   *
  5797*                                                                *
  5798*   LOG = NO                                                     *
  5799*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5800******************************************************************
  5801******************************************************************
  5802*                   C H A N G E   L O G
  5803*
  5804* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5805*-----------------------------------------------------------------
  5806*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5807* EFFECTIVE    NUMBER
  5808*-----------------------------------------------------------------
  5809* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5810* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5811* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5812* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5813* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5814* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5815* 032306                   PEMA  ADD BOW LOAN NUMBER
  5816* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5817* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5818* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5819* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5820* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5821* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5822* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5823* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5824* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  5825* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5826* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  5827* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  5828* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  5829******************************************************************
  5830
  5831 01  PENDING-BUSINESS.
  5832     12  PB-RECORD-ID                     PIC XX.
  5833         88  VALID-PB-ID                        VALUE 'PB'.
  5834
  5835     12  PB-CONTROL-PRIMARY.
  5836         16  PB-COMPANY-CD                PIC X.
  5837         16  PB-ENTRY-BATCH               PIC X(6).
  5838         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5839         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5840
  5841     12  PB-CONTROL-BY-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 109
* VP6311.cbl
  5842         16  PB-COMPANY-CD-A1             PIC X.
  5843         16  PB-CARRIER                   PIC X.
  5844         16  PB-GROUPING.
  5845             20  PB-GROUPING-PREFIX       PIC XXX.
  5846             20  PB-GROUPING-PRIME        PIC XXX.
  5847         16  PB-STATE                     PIC XX.
  5848         16  PB-ACCOUNT.
  5849             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5850             20  PB-ACCOUNT-PRIME         PIC X(6).
  5851         16  PB-CERT-EFF-DT               PIC XX.
  5852         16  PB-CERT-NO.
  5853             20  PB-CERT-PRIME            PIC X(10).
  5854             20  PB-CERT-SFX              PIC X.
  5855         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5856
  5857         16  PB-RECORD-TYPE               PIC X.
  5858             88  PB-MAILING-DATA                VALUE '0'.
  5859             88  PB-ISSUE                       VALUE '1'.
  5860             88  PB-CANCELLATION                VALUE '2'.
  5861             88  PB-BATCH-TRAILER               VALUE '9'.
  5862
  5863     12  PB-CONTROL-BY-ORIG-BATCH.
  5864         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5865         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5866         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5867         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5868
  5869     12  PB-CONTROL-BY-CSR.
  5870         16  PB-CSR-COMPANY-CD            PIC X.
  5871         16  PB-CSR-ID                    PIC X(4).
  5872         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5873         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5874         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5875******************************************************************
  5876*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5877******************************************************************
  5878
  5879     12  PB-LAST-MAINT-DT                 PIC XX.
  5880     12  PB-LAST-MAINT-BY                 PIC X(4).
  5881     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5882
  5883     12  PB-RECORD-BODY                   PIC X(375).
  5884
  5885     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5886         16  PB-CERT-ORIGIN               PIC X.
  5887             88  CLASIC-CREATED-CERT         VALUE '1'.
  5888         16  PB-I-NAME.
  5889             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5890             20  PB-I-INSURED-FIRST-NAME.
  5891                 24  PB-I-INSURED-1ST-INIT PIC X.
  5892                 24  FILLER                PIC X(9).
  5893             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5894         16  PB-I-AGE                     PIC S99   COMP-3.
  5895         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5896         16  PB-I-BIRTHDAY                PIC XX.
  5897         16  PB-I-INSURED-SEX             PIC X.
  5898             88  PB-SEX-MALE     VALUE 'M'.
  5899             88  PB-SEX-FEMALE   VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 110
* VP6311.cbl
  5900
  5901         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5902         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5903         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5904         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5905         16  PB-I-SKIP-CODE               PIC X.
  5906             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5907             88  PB-SKIP-JULY              VALUE '1'.
  5908             88  PB-SKIP-AUGUST            VALUE '2'.
  5909             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5910             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5911             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5912             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5913             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5914             88  PB-SKIP-JUNE              VALUE '8'.
  5915             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5916             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5917             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5918         16  PB-I-TERM-TYPE               PIC X.
  5919             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5920             88  PB-PAID-WEEKLY            VALUE 'W'.
  5921             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5922             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5923             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5924         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5925         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5926         16  PB-I-DATA-ENTRY-SW           PIC X.
  5927             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5928             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5929             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5930             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5931         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5932         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5933*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5934         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5935         16  PB-I-LETTER-REQD             PIC X.
  5936
  5937         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5938             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5939             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5940                                                   '90' THRU '99'.
  5941         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5942                                          PIC XX.
  5943         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5944         16  PB-I-AMOUNT-FINANCED REDEFINES
  5945                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5946         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  5947         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5948                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5949         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5950         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5951         16  PB-I-CLP-AMOUNT REDEFINES
  5952                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5953         16  PB-I-LF-CALC-FLAG            PIC X.
  5954             88 PB-COMP-LF-PREM               VALUE '?'.
  5955         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5956         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5957         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 111
* VP6311.cbl
  5958         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5959         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5960         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5961         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5962         16  PB-I-LF-ABBR                 PIC XXX.
  5963         16  PB-I-LF-INPUT-CD             PIC XX.
  5964
  5965         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5966             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5967             88  PB-INVALID-AH               VALUE '  ' '00'
  5968                                                   '90' THRU '99'.
  5969         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5970         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5971         16  PB-I-AH-CALC-FLAG            PIC X.
  5972             88 PB-COMP-AH-PREM                  VALUE '?'.
  5973         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5974         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5975         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  5976         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5977         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5978         16  PB-I-AH-ABBR                 PIC XXX.
  5979         16  PB-I-AH-INPUT-CD             PIC XXX.
  5980
  5981         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5982         16  PB-I-REIN-TABLE              PIC XXX.
  5983         16  PB-I-BUSINESS-TYPE           PIC 99.
  5984         16  PB-I-INDV-GRP-CD             PIC X.
  5985         16  PB-I-MORT-CODE.
  5986             20  PB-I-TABLE               PIC X.
  5987             20  PB-I-INTEREST            PIC XX.
  5988             20  PB-I-MORT-TYP            PIC X.
  5989         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5990         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5991         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5992         16  PB-I-INDV-GRP-OVRD           PIC X.
  5993         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5994         16  PB-I-SIG-SW                  PIC X.
  5995             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5996         16  PB-I-RATE-CLASS              PIC XX.
  5997         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5998         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5999         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6000         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6001         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6002         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6003         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6004         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6005         16  PB-I-OB-FLAG                 PIC X.
  6006             88  PB-I-OB                      VALUE 'B'.
  6007             88  PB-I-SUMMARY                 VALUE 'Z'.
  6008         16  PB-I-ENTRY-STATUS            PIC X.
  6009             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6010                                              'M' '5' '9' '2'.
  6011             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6012             88  PB-I-POLICY-PENDING          VALUE '2'.
  6013             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6014             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6015             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 112
* VP6311.cbl
  6016             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6017             88  PB-I-REIN-ONLY               VALUE '9'.
  6018             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6019             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6020             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6021             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6022         16  PB-I-INT-CODE                PIC X.
  6023             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6024             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6025         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6026         16  PB-I-SOC-SEC-NO              PIC X(11).
  6027         16  PB-I-MEMBER-NO               PIC X(12).
  6028         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6029*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6030         16  PB-I-OLD-LOF                 PIC XXX.
  6031         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6032         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6033         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6034         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6035         16  PB-I-LIFE-INDICATOR          PIC X.
  6036             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6037         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6038         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6039                                          PIC S9(5)V99    COMP-3.
  6040         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6041             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6042             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6043         16  PB-I-1ST-PMT-DT              PIC XX.
  6044         16  PB-I-JOINT-INSURED.
  6045             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6046             20 PB-I-JOINT-FIRST-NAME.
  6047                24  PB-I-JOINT-FIRST-INIT PIC X.
  6048                24  FILLER                PIC X(9).
  6049             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6050*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6051         16  PB-I-BENEFICIARY-NAME.
  6052             20  PB-I-BANK-NUMBER         PIC X(10).
  6053             20  FILLER                   PIC X(15).
  6054         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6055         16  PB-I-REFERENCE               PIC X(12).
  6056         16  FILLER REDEFINES PB-I-REFERENCE.
  6057             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6058             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6059             20  PB-I-CLP-STATE           PIC XX.
  6060         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6061             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6062             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6063             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6064         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6065         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6066         16  PB-I-RESIDENT-STATE          PIC XX.
  6067         16  PB-I-RATE-CODE               PIC X(4).
  6068         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6069         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6070         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6071         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6072         16  PB-I-BANK-NOCHRGB            PIC 99.
  6073         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 113
* VP6311.cbl
  6074         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6075
  6076     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6077         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6078             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6079         16  PB-C-CANCEL-ORIGIN           PIC X.
  6080             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6081         16  PB-C-LF-CANCEL-DT            PIC XX.
  6082         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6083         16  PB-C-LF-CALC-REQ             PIC X.
  6084             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6085         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6086         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6087         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6088             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6089         16  PB-C-AH-CANCEL-DT            PIC XX.
  6090         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6091         16  PB-C-AH-CALC-REQ             PIC X.
  6092             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6093         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6094         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6095         16  PB-C-LAST-NAME               PIC X(15).
  6096         16  PB-C-REFUND-SW               PIC X.
  6097             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6098             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6099         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6100         16  PB-C-PAYEE-CODE              PIC X(6).
  6101         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6102         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6103         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6104         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6105         16  PB-C-REFERENCE               PIC X(12).
  6106         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6107         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6108         16  PB-C-POST-CARD-IND           PIC X.
  6109         16  PB-C-CANCEL-REASON           PIC X.
  6110         16  PB-C-REF-INTERFACE-SW        PIC X.
  6111         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6112         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6113         16  FILLER                       PIC X(01).
  6114*        16  FILLER                       PIC X(18).
  6115         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6116*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6117         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  6118         16  PB-CANCELED-CERT-DATA.
  6119             20  PB-CI-INSURED-NAME.
  6120                 24  PB-CI-LAST-NAME      PIC X(15).
  6121                 24  PB-CI-INITIALS       PIC XX.
  6122             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6123             20  PB-CI-INSURED-SEX        PIC X.
  6124             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6125             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6126             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6127             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6128             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6129             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6130             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6131             20  PB-CI-AH-BENEFIT-CD      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 114
* VP6311.cbl
  6132             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6133             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6134             20  PB-CI-RATE-CLASS         PIC XX.
  6135             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6136             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6137             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6138             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6139             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6140             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6141             20  PB-CI-LF-ABBR            PIC X(3).
  6142             20  PB-CI-AH-ABBR            PIC X(3).
  6143             20  PB-CI-OB-FLAG            PIC X.
  6144                 88  PB-CI-OB                VALUE 'B'.
  6145             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6146                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6147                                           'M' '4' '5' '9' '2'.
  6148                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6149                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6150                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6151                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6152                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6153                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6154                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6155                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6156                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6157                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6158                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6159                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6160                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6161             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6162                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6163                                           'M' '4' '5' '9' '2'.
  6164                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6165                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6166                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6167                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6168                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6169                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6170                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6171                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6172                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6173                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6174                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6175                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6176                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6177             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6178             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6179             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6180             20  PB-CI-MEMBER-NO          PIC X(12).
  6181             20  PB-CI-INT-CODE           PIC X.
  6182                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6183                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6184             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6185             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6186             20  PB-CI-COMP-EXCP-SW       PIC X.
  6187                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6188                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6189             20  PB-CI-ENTRY-STATUS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 115
* VP6311.cbl
  6190             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6191             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6192             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6193             20  PB-CI-DEATH-DT           PIC XX.
  6194             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6195             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6196             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6197             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6198             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6199             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6200             20  PB-CI-ENTRY-DT              PIC XX.
  6201             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6202             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6203             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6204             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6205             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6206             20  PB-CI-OLD-LOF               PIC XXX.
  6207*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6208             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6209             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6210             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6211             20  PB-CI-INDV-GRP-CD           PIC X.
  6212             20  PB-CI-BENEFICIARY-NAME.
  6213                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6214                 24  FILLER                  PIC X(15).
  6215             20  PB-CI-NOTE-SW               PIC X.
  6216             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6217             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6218             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6219             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6220             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6221             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6222             20  PB-CI-FIRST-NAME            PIC X(10).
  6223             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6224
  6225         16  FILLER                       PIC X(13).
  6226*032306  16  FILLER                       PIC X(27).
  6227*        16  FILLER                       PIC X(46).
  6228
  6229     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6230         16  FILLER                       PIC X(10).
  6231         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6232         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6233         16  PB-M-INSURED-MID-INIT        PIC X.
  6234         16  PB-M-INSURED-AGE             PIC 99.
  6235         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6236         16  PB-M-INSURED-SEX             PIC X.
  6237         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6238         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6239         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6240         16  PB-M-INSURED-CITY-STATE.
  6241             20  PB-M-INSURED-CITY        PIC X(28).
  6242             20  PB-M-INSURED-STATE       PIC XX.
  6243         16  PB-M-INSURED-ZIP-CODE.
  6244             20  PB-M-INSURED-ZIP-PRIME.
  6245                 24  PB-M-INSURED-ZIP-1   PIC X.
  6246                     88  PB-M-CANADIAN-POST-CODE
  6247                                             VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 116
* VP6311.cbl
  6248                 24  FILLER               PIC X(4).
  6249             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6250         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6251                                        PB-M-INSURED-ZIP-CODE.
  6252             20  PM-M-INS-CAN-POST1       PIC XXX.
  6253             20  PM-M-INS-CAN-POST2       PIC XXX.
  6254             20  FILLER                   PIC XXX.
  6255         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6256         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6257         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6258         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6259         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6260         16  PB-M-CRED-BENE-CITYST.
  6261             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6262             20  PB-M-CRED-BENE-STATE     PIC XX.
  6263         16  FILLER                       PIC X(92).
  6264
  6265     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6266         16  FILLER                       PIC X(10).
  6267         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6268         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6269         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6270         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6271         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6272         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6273         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6274         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6275         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6276         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6277         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6278         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6279         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6280         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6281         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6282         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6283         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6284         16  PB-ACCOUNT-NAME              PIC X(30).
  6285         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6286         16  PB-REFERENCE                 PIC X(12).
  6287         16  PB-B-RECEIVED-DT             PIC XX.
  6288         16  FILLER                       PIC X(234).
  6289
  6290     12  PB-RECORD-STATUS.
  6291         16  PB-CREDIT-SELECT-DT          PIC XX.
  6292         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6293         16  PB-BILLED-DT                 PIC XX.
  6294         16  PB-BILLING-STATUS            PIC X.
  6295             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6296             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6297             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6298         16  PB-RECORD-BILL               PIC X.
  6299             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6300             88  PB-RECORD-RETURNED           VALUE 'R'.
  6301             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6302             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6303             88  PB-OVERRIDE-AH               VALUE 'A'.
  6304             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6305         16  PB-BATCH-ENTRY               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 117
* VP6311.cbl
  6306             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6307             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6308             88  PB-REISSUED-CERT             VALUE 'E'.
  6309             88  PB-CASH-CERT                 VALUE 'C'.
  6310             88  PB-MONTHLY-CERT              VALUE 'M'.
  6311             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6312             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6313             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6314         16  PB-FORCE-CODE                PIC X.
  6315             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6316             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6317             88  PB-CANCEL-FORCE              VALUE '8'.
  6318             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6319             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6320             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6321             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6322             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6323             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6324             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6325             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6326         16  PB-FATAL-FLAG                PIC X.
  6327             88  PB-FATAL-ERRORS              VALUE 'X'.
  6328         16  PB-FORCE-ER-CD               PIC X.
  6329             88  PB-FORCE-ERRORS              VALUE 'F'.
  6330             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6331         16  PB-WARN-ER-CD                PIC X.
  6332             88  PB-WARNING-ERRORS            VALUE 'W'.
  6333         16  FILLER                       PIC X.
  6334         16  PB-OUT-BAL-CD                PIC X.
  6335             88  PB-OUT-OF-BAL                VALUE 'O'.
  6336         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6337         16  PB-AH-OVERRIDE-L1            PIC X.
  6338         16  PB-INPUT-DT                  PIC XX.
  6339         16  PB-INPUT-BY                  PIC X(4).
  6340         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6341         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6342         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6343         16  PB-LF-EARNING-METHOD         PIC X.
  6344         16  PB-AH-EARNING-METHOD         PIC X.
  6345         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6346         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6347         16  PB-REIN-CD                   PIC XXX.
  6348         16  PB-LF-REFUND-TYPE            PIC X.
  6349         16  PB-AH-REFUND-TYPE            PIC X.
  6350         16  PB-ACCT-EFF-DT               PIC XX.
  6351         16  PB-ACCT-EXP-DT               PIC XX.
  6352         16  PB-COMPANY-ID                PIC X(3).
  6353         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6354         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6355         16  PB-SV-CARRIER                PIC X.
  6356         16  PB-SV-GROUPING               PIC X(6).
  6357         16  PB-SV-STATE                  PIC XX.
  6358         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6359         16  PB-GA-BILLING-INFO.
  6360             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6361                                          PIC XX.
  6362         16  PB-SV-REMIT-TO  REDEFINES
  6363             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 118
* VP6311.cbl
  6364         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6365         16  PB-I-LOAN-OFFICER            PIC X(5).
  6366         16  PB-I-VIN                     PIC X(17).
  6367
  6368         16  FILLER                       PIC X(04).
  6369         16  IMNET-BYPASS-SW              PIC X.
  6370
  6371******************************************************************
  6372*                COMMON EDIT ERRORS                              *
  6373******************************************************************
  6374
  6375     12  PB-COMMON-ERRORS.
  6376         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6377                                           PIC S9(4)     COMP.
  6378
  6379******************************************************************
  6380*                                COPY ELCCERT.
  6381******************************************************************
  6382*                                                                *
  6383*                            ELCCERT.                            *
  6384*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6385*                            VMOD=2.013                          *
  6386*                                                                *
  6387*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6388*                                                                *
  6389*   FILE TYPE = VSAM,KSDS                                        *
  6390*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6391*                                                                *
  6392*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6393*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6394*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6395*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6396*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6397*                                                                *
  6398*   LOG = YES                                                    *
  6399*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6400******************************************************************
  6401*                   C H A N G E   L O G
  6402*
  6403* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6404*-----------------------------------------------------------------
  6405*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6406* EFFECTIVE    NUMBER
  6407*-----------------------------------------------------------------
  6408* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6409* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6410* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6411* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6412* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6413* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6414* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6415* 032612  CR2011110200001  PEMA  AHL CHANGES
  6416* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6417* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6418* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6419******************************************************************
  6420
  6421 01  CERTIFICATE-MASTER.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 119
* VP6311.cbl
  6422     12  CM-RECORD-ID                      PIC XX.
  6423         88  VALID-CM-ID                      VALUE 'CM'.
  6424
  6425     12  CM-CONTROL-PRIMARY.
  6426         16  CM-COMPANY-CD                 PIC X.
  6427         16  CM-CARRIER                    PIC X.
  6428         16  CM-GROUPING.
  6429             20  CM-GROUPING-PREFIX        PIC X(3).
  6430             20  CM-GROUPING-PRIME         PIC X(3).
  6431         16  CM-STATE                      PIC XX.
  6432         16  CM-ACCOUNT.
  6433             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6434             20  CM-ACCOUNT-PRIME          PIC X(6).
  6435         16  CM-CERT-EFF-DT                PIC XX.
  6436         16  CM-CERT-NO.
  6437             20  CM-CERT-PRIME             PIC X(10).
  6438             20  CM-CERT-SFX               PIC X.
  6439
  6440     12  CM-CONTROL-BY-NAME.
  6441         16  CM-COMPANY-CD-A1              PIC X.
  6442         16  CM-INSURED-LAST-NAME          PIC X(15).
  6443         16  CM-INSURED-INITIALS.
  6444             20  CM-INSURED-INITIAL1       PIC X.
  6445             20  CM-INSURED-INITIAL2       PIC X.
  6446
  6447     12  CM-CONTROL-BY-SSN.
  6448         16  CM-COMPANY-CD-A2              PIC X.
  6449         16  CM-SOC-SEC-NO.
  6450             20  CM-SSN-STATE              PIC XX.
  6451             20  CM-SSN-ACCOUNT            PIC X(6).
  6452             20  CM-SSN-LN3.
  6453                 25  CM-INSURED-INITIALS-A2.
  6454                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6455                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6456                 25 CM-PART-LAST-NAME-A2         PIC X.
  6457
  6458     12  CM-CONTROL-BY-CERT-NO.
  6459         16  CM-COMPANY-CD-A4              PIC X.
  6460         16  CM-CERT-NO-A4                 PIC X(11).
  6461
  6462     12  CM-CONTROL-BY-MEMB.
  6463         16  CM-COMPANY-CD-A5              PIC X.
  6464         16  CM-MEMBER-NO.
  6465             20  CM-MEMB-STATE             PIC XX.
  6466             20  CM-MEMB-ACCOUNT           PIC X(6).
  6467             20  CM-MEMB-LN4.
  6468                 25  CM-INSURED-INITIALS-A5.
  6469                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6470                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6471                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6472
  6473     12  CM-INSURED-PROFILE-DATA.
  6474         16  CM-INSURED-FIRST-NAME.
  6475             20  CM-INSURED-1ST-INIT       PIC X.
  6476             20  FILLER                    PIC X(9).
  6477         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6478         16  CM-INSURED-SEX                PIC X.
  6479             88  CM-SEX-MALE                  VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 120
* VP6311.cbl
  6480             88  CM-SEX-FEMAL                 VALUE 'F'.
  6481         16  CM-INSURED-JOINT-AGE          PIC 99.
  6482         16  CM-JOINT-INSURED-NAME.
  6483             20  CM-JT-LAST-NAME           PIC X(15).
  6484             20  CM-JT-FIRST-NAME.
  6485                 24  CM-JT-1ST-INIT        PIC X.
  6486                 24  FILLER                PIC X(9).
  6487             20  CM-JT-INITIAL             PIC X.
  6488
  6489     12  CM-LIFE-DATA.
  6490         16  CM-LF-BENEFIT-CD              PIC XX.
  6491         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6492         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6493         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6494         16  CM-LF-DEV-CODE                PIC XXX.
  6495         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6496         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6497         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6498         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6499         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6500         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6501         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6502         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6503         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6504         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6505         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6506         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6507         16  cm-temp-epiq                  pic xx.
  6508             88  EPIQ-CLASS                  value 'EQ'.
  6509*        16  FILLER                        PIC XX.
  6510
  6511     12  CM-AH-DATA.
  6512         16  CM-AH-BENEFIT-CD              PIC XX.
  6513         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6514         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6515         16  CM-AH-DEV-CODE                PIC XXX.
  6516         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6517         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6518         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6519         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6520         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6521         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6522         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6523         16  CM-AH-PAID-THRU-DT            PIC XX.
  6524             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6525         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6526         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6527         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6528         16  FILLER                        PIC X.
  6529
  6530     12  CM-LOAN-INFORMATION.
  6531         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6532         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6533                                           PIC S9(5)V99  COMP-3.
  6534         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6535         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6536         16  CM-PAY-FREQUENCY              PIC S99.
  6537         16  CM-LOAN-TERM                  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 121
* VP6311.cbl
  6538         16  CM-RATE-CLASS                 PIC XX.
  6539         16  CM-BENEFICIARY                PIC X(25).
  6540         16  CM-POLICY-FORM-NO             PIC X(12).
  6541         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6542         16  CM-LAST-ADD-ON-DT             PIC XX.
  6543         16  CM-DEDUCTIBLE-AMOUNTS.
  6544             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6545             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6546         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6547             20  CM-RESIDENT-STATE         PIC XX.
  6548             20  CM-RATE-CODE              PIC X(4).
  6549             20  FILLER                    PIC XX.
  6550         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6551             20  CM-LOAN-OFFICER           PIC X(5).
  6552             20  FILLER                    PIC XXX.
  6553         16  CM-CSR-CODE                   PIC XXX.
  6554         16  CM-UNDERWRITING-CODE          PIC X.
  6555             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6556         16  CM-POST-CARD-IND              PIC X.
  6557         16  CM-REF-INTERFACE-SW           PIC X.
  6558         16  CM-PREMIUM-TYPE               PIC X.
  6559             88  CM-SING-PRM                  VALUE '1'.
  6560             88  CM-O-B-COVERAGE              VALUE '2'.
  6561             88  CM-OPEN-END                  VALUE '3'.
  6562         16  CM-IND-GRP-TYPE               PIC X.
  6563             88  CM-INDIVIDUAL                VALUE 'I'.
  6564             88  CM-GROUP                     VALUE 'G'.
  6565         16  CM-SKIP-CODE                  PIC X.
  6566             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6567             88  SKIP-JULY                    VALUE '1'.
  6568             88  SKIP-AUGUST                  VALUE '2'.
  6569             88  SKIP-SEPTEMBER               VALUE '3'.
  6570             88  SKIP-JULY-AUG                VALUE '4'.
  6571             88  SKIP-AUG-SEPT                VALUE '5'.
  6572             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6573             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6574             88  SKIP-JUNE                    VALUE '8'.
  6575             88  SKIP-JUNE-JULY               VALUE '9'.
  6576             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6577             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6578         16  CM-PAYMENT-MODE               PIC X.
  6579             88  PAY-MONTHLY                  VALUE SPACE.
  6580             88  PAY-WEEKLY                   VALUE '1'.
  6581             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6582             88  PAY-BI-WEEKLY                VALUE '3'.
  6583             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6584         16  CM-LOAN-NUMBER                PIC X(8).
  6585         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6586         16  CM-OLD-LOF                    PIC XXX.
  6587*        16  CM-LOAN-OFFICER               PIC XXX.
  6588         16  CM-REIN-TABLE                 PIC XXX.
  6589         16  CM-SPECIAL-REIN-CODE          PIC X.
  6590         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6591         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6592         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6593
  6594     12  CM-STATUS-DATA.
  6595         16  CM-ENTRY-STATUS               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 122
* VP6311.cbl
  6596         16  CM-ENTRY-DT                   PIC XX.
  6597
  6598         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6599         16  CM-LF-CANCEL-DT               PIC XX.
  6600         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6601
  6602         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6603         16  CM-LF-DEATH-DT                PIC XX.
  6604         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6605
  6606         16  CM-LF-CURRENT-STATUS          PIC X.
  6607             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6608                                                'M' '4' '5' '9'.
  6609             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6610             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6611             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6612             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6613             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6614             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6615             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6616             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6617             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6618             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6619             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6620             88  CM-LF-DECLINED               VALUE 'D'.
  6621             88  CM-LF-VOIDED                 VALUE 'V'.
  6622
  6623         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6624         16  CM-AH-CANCEL-DT               PIC XX.
  6625         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6626
  6627         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6628         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6629         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6630
  6631         16  CM-AH-CURRENT-STATUS          PIC X.
  6632             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6633                                                'M' '4' '5' '9'.
  6634             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6635             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6636             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6637             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6638             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6639             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6640             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6641             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6642             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6643             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6644             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6645             88  CM-AH-DECLINED               VALUE 'D'.
  6646             88  CM-AH-VOIDED                 VALUE 'V'.
  6647
  6648         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6649             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6650             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6651             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6652         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6653
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 123
* VP6311.cbl
  6654         16  CM-ENTRY-BATCH                PIC X(6).
  6655         16  CM-LF-EXIT-BATCH              PIC X(6).
  6656         16  CM-AH-EXIT-BATCH              PIC X(6).
  6657         16  CM-LAST-MONTH-END             PIC XX.
  6658
  6659     12  CM-NOTE-SW                        PIC X.
  6660         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6661         88  CERT-NOTES-PRESENT               VALUE '1'.
  6662         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6663         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6664         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6665         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6666         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6667         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6668     12  CM-COMP-EXCP-SW                   PIC X.
  6669         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6670         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6671     12  CM-INSURED-ADDRESS-SW             PIC X.
  6672         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6673         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6674
  6675*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6676     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6677     12  FILLER                            PIC X.
  6678
  6679*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6680     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6681     12  FILLER                            PIC X.
  6682*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6683     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  6684
  6685     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6686         88  CERT-ADDED-BATCH                 VALUE ' '.
  6687         88  CERT-ADDED-ONLINE                VALUE '1'.
  6688         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6689         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6690         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6691     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6692         88  CERT-AS-LOADED                   VALUE ' '.
  6693         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6694         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6695         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6696         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6697         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6698         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6699         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6700
  6701     12  CM-ACCOUNT-COMM-PCTS.
  6702         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6703         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6704
  6705     12  CM-USER-FIELD                     PIC X.
  6706     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6707     12  CM-CLP-STATE                      PIC XX.
  6708     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6709     12  CM-USER-RESERVED                  PIC XXX.
  6710     12  FILLER REDEFINES CM-USER-RESERVED.
  6711         16  CM-AH-CLASS-CD                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 124
* VP6311.cbl
  6712         16  F                             PIC X.
  6713******************************************************************
  6714*                                COPY ERCNOTE.
  6715******************************************************************
  6716*                                                                *
  6717*                                                                *
  6718*                            ERCNOTE                             *
  6719*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6720*                            VMOD=2.003                          *
  6721*                                                                *
  6722*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6723*                                                                *
  6724*        FILE TYPE= VSAM,KSDS                                    *
  6725*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6726*                                                                *
  6727*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6728*                                                                *
  6729*        LOG = YES                                               *
  6730*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6731*                                                                *
  6732******************************************************************
  6733*                   C H A N G E   L O G
  6734*
  6735* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6736*-----------------------------------------------------------------
  6737*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6738* EFFECTIVE    NUMBER
  6739*-----------------------------------------------------------------
  6740* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6741*                                FILE WILL CONTAIN BILLING NOTES O
  6742******************************************************************
  6743
  6744 01  CERTIFICATE-NOTE.
  6745     12  CN-RECORD-ID                PIC  XX.
  6746         88  VALID-CN-ID                  VALUE 'CN'.
  6747
  6748     12  CN-CONTROL-PRIMARY.
  6749         16  CN-COMPANY-CD           PIC X.
  6750         16  CN-CARRIER              PIC X.
  6751         16  CN-GROUPING.
  6752             20 CN-GROUPING-PREFIX   PIC XXX.
  6753             20 CN-GROUPING-PRIME    PIC XXX.
  6754         16  CN-STATE                PIC XX.
  6755         16  CN-ACCOUNT.
  6756             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6757             20 CN-ACCOUNT-PRIME     PIC X(6).
  6758         16  CN-CERT-EFF-DT          PIC XX.
  6759         16  CN-CERT-NO.
  6760             20  CN-CERT-PRIME       PIC X(10).
  6761             20  CN-CERT-SFX         PIC X.
  6762
  6763     12  CN-BILLING-START-LINE-NO    PIC 99.
  6764     12  CN-BILLING-END-LINE-NO      PIC 99.
  6765
  6766     12  CN-LINES.
  6767         16  CN-LINE OCCURS 10       PIC X(77).
  6768
  6769     12  CN-LAST-MAINT-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 125
* VP6311.cbl
  6770     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6771     12  CN-LAST-MAINT-USER          PIC X(4).
  6772     12  FILLER                      PIC X(6).
  6773******************************************************************
  6774*                                COPY ERCPNDM.
  6775******************************************************************
  6776*                                                                *
  6777*                                                                *
  6778*                            ERCPNDM                             *
  6779*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6780*                            VMOD=2.003                          *
  6781*                                                                *
  6782*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6783*                                                                *
  6784*   FILE TYPE = VSAM,KSDS                                        *
  6785*   RECORD SIZE = 374   RECFORM = FIX                            *
  6786*                                                                *
  6787*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6788*   ALTERNATE PATH    = NOT USED                                 *
  6789*                                                                *
  6790*   LOG = YES                                                    *
  6791*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6792******************************************************************
  6793*                   C H A N G E   L O G
  6794*
  6795* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6796*-----------------------------------------------------------------
  6797*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6798* EFFECTIVE    NUMBER
  6799*-----------------------------------------------------------------
  6800* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6801* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6802* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6803* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  6804******************************************************************
  6805
  6806 01  PENDING-MAILING-DATA.
  6807     12  PM-RECORD-ID                      PIC XX.
  6808         88  VALID-MA-ID                       VALUE 'PM'.
  6809
  6810     12  PM-CONTROL-PRIMARY.
  6811         16  PM-COMPANY-CD                 PIC X.
  6812         16  PM-ENTRY-BATCH                PIC X(6).
  6813         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6814         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6815
  6816     12  FILLER                            PIC X(14).
  6817
  6818     12  PM-ACCESS-CONTROL.
  6819         16  PM-SOURCE-SYSTEM              PIC XX.
  6820             88  PM-FROM-CREDIT                VALUE 'CR'.
  6821             88  PM-FROM-VSI                   VALUE 'VS'.
  6822             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6823             88  PM-FROM-OTHER                 VALUE 'OT'.
  6824         16  PM-RECORD-ADD-DT              PIC XX.
  6825         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6826         16  PM-LAST-MAINT-DT              PIC XX.
  6827         16  PM-LAST-MAINT-BY              PIC XXXX.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 126
* VP6311.cbl
  6828         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6829
  6830     12  PM-PROFILE-INFO.
  6831         16  PM-QUALIFY-CODE-1             PIC XX.
  6832         16  PM-QUALIFY-CODE-2             PIC XX.
  6833         16  PM-QUALIFY-CODE-3             PIC XX.
  6834         16  PM-QUALIFY-CODE-4             PIC XX.
  6835         16  PM-QUALIFY-CODE-5             PIC XX.
  6836
  6837         16  PM-INSURED-LAST-NAME          PIC X(15).
  6838         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6839         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6840         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6841         16  PM-INSURED-BIRTH-DT           PIC XX.
  6842         16  PM-INSURED-SEX                PIC X.
  6843             88  PM-SEX-MALE                   VALUE 'M'.
  6844             88  PM-SEX-FEMALE                 VALUE 'F'.
  6845         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6846
  6847         16  PM-ADDRESS-CORRECTED          PIC X.
  6848         16  PM-JOINT-BIRTH-DT             PIC XX.
  6849*        16  FILLER                        PIC X(12).
  6850
  6851         16  PM-ADDRESS-LINE-1             PIC X(30).
  6852         16  PM-ADDRESS-LINE-2             PIC X(30).
  6853         16  PM-CITY-STATE.
  6854             20  PM-CITY                   PIC X(28).
  6855             20  PM-STATE                  PIC XX.
  6856         16  PM-ZIP.
  6857             20  PM-ZIP-CODE.
  6858                 24  PM-ZIP-1              PIC X.
  6859                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6860                 24  FILLER                PIC X(4).
  6861             20  PM-ZIP-PLUS4              PIC X(4).
  6862         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6863             20  PM-CAN-POST1              PIC XXX.
  6864             20  PM-CAN-POST2              PIC XXX.
  6865             20  FILLER                    PIC XXX.
  6866
  6867         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6868         16  pm-city-st-zip-verified       pic x.
  6869         16  FILLER                        PIC XX.
  6870
  6871     12  PM-CRED-BENE-INFO.
  6872         16  PM-CRED-BENE-NAME             PIC X(25).
  6873         16  PM-CRED-BENE-ADDR             PIC X(30).
  6874         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6875         16  PM-CRED-BENE-CTYST.
  6876             20  PM-CRED-BENE-CITY         PIC X(28).
  6877             20  PM-CRED-BENE-STATE        PIC XX.
  6878         16  PM-CRED-BENE-ZIP.
  6879             20  PM-CB-ZIP-CODE.
  6880                 24  PM-CB-ZIP-1           PIC X.
  6881                     88  PM-CB-CANADIAN-POST-CODE
  6882                                  VALUE 'A' THRU 'Z'.
  6883                 24  FILLER                PIC X(4).
  6884             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6885         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 127
* VP6311.cbl
  6886             20  PM-CB-CAN-POST1           PIC XXX.
  6887             20  PM-CB-CAN-POST2           PIC XXX.
  6888             20  FILLER                    PIC XXX.
  6889     12  PM-POST-CARD-MAIL-DATA.
  6890         16  PM-MAIL-DATA OCCURS 7.
  6891             20  PM-MAIL-TYPE              PIC X.
  6892                 88  PM-12MO-MAILING           VALUE '1'.
  6893                 88  PM-EXP-MAILING            VALUE '2'.
  6894             20  PM-MAIL-STATUS            PIC X.
  6895                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6896                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6897                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6898             20  PM-MAIL-DATE              PIC XX.
  6899     12  FILLER                            PIC XX.
  6900     12  FILLER                            PIC X(12).
  6901*    12  FILLER                            PIC X(30).
  6902
  6903******************************************************************
  6904*                                COPY ERCMAIL.
  6905******************************************************************
  6906*                                                                *
  6907*                                                                *
  6908*                            ERCMAIL                             *
  6909*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6910*                            VMOD=2.003                          *
  6911*                                                                *
  6912*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6913*                                                                *
  6914*   FILE TYPE = VSAM,KSDS                                        *
  6915*   RECORD SIZE = 374   RECFORM = FIX                            *
  6916*                                                                *
  6917*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6918*   ALTERNATE PATH    = NOT USED                                 *
  6919*                                                                *
  6920*   LOG = YES                                                    *
  6921*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6922******************************************************************
  6923*                   C H A N G E   L O G
  6924*
  6925* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6926*-----------------------------------------------------------------
  6927*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6928* EFFECTIVE    NUMBER
  6929*-----------------------------------------------------------------
  6930* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6931* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6932* 111108                   PEMA  ADD CRED BENE ADDR2
  6933******************************************************************
  6934
  6935 01  MAILING-DATA.
  6936     12  MA-RECORD-ID                      PIC XX.
  6937         88  VALID-MA-ID                       VALUE 'MA'.
  6938
  6939     12  MA-CONTROL-PRIMARY.
  6940         16  MA-COMPANY-CD                 PIC X.
  6941         16  MA-CARRIER                    PIC X.
  6942         16  MA-GROUPING.
  6943             20  MA-GROUPING-PREFIX        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 128
* VP6311.cbl
  6944             20  MA-GROUPING-PRIME         PIC XXX.
  6945         16  MA-STATE                      PIC XX.
  6946         16  MA-ACCOUNT.
  6947             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6948             20  MA-ACCOUNT-PRIME          PIC X(6).
  6949         16  MA-CERT-EFF-DT                PIC XX.
  6950         16  MA-CERT-NO.
  6951             20  MA-CERT-PRIME             PIC X(10).
  6952             20  MA-CERT-SFX               PIC X.
  6953
  6954     12  FILLER                            PIC XX.
  6955
  6956     12  MA-ACCESS-CONTROL.
  6957         16  MA-SOURCE-SYSTEM              PIC XX.
  6958             88  MA-FROM-CREDIT                VALUE 'CR'.
  6959             88  MA-FROM-VSI                   VALUE 'VS'.
  6960             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6961             88  MA-FROM-OTHER                 VALUE 'OT'.
  6962         16  MA-RECORD-ADD-DT              PIC XX.
  6963         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6964         16  MA-LAST-MAINT-DT              PIC XX.
  6965         16  MA-LAST-MAINT-BY              PIC XXXX.
  6966         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6967
  6968     12  MA-PROFILE-INFO.
  6969         16  MA-QUALIFY-CODE-1             PIC XX.
  6970         16  MA-QUALIFY-CODE-2             PIC XX.
  6971         16  MA-QUALIFY-CODE-3             PIC XX.
  6972         16  MA-QUALIFY-CODE-4             PIC XX.
  6973         16  MA-QUALIFY-CODE-5             PIC XX.
  6974
  6975         16  MA-INSURED-LAST-NAME          PIC X(15).
  6976         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6977         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6978         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6979         16  MA-INSURED-BIRTH-DT           PIC XX.
  6980         16  MA-INSURED-SEX                PIC X.
  6981             88  MA-SEX-MALE                   VALUE 'M'.
  6982             88  MA-SEX-FEMALE                 VALUE 'F'.
  6983         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6984
  6985         16  MA-ADDRESS-CORRECTED          PIC X.
  6986         16  MA-JOINT-BIRTH-DT             PIC XX.
  6987*        16  FILLER                        PIC X(12).
  6988
  6989         16  MA-ADDRESS-LINE-1             PIC X(30).
  6990         16  MA-ADDRESS-LINE-2             PIC X(30).
  6991         16  MA-CITY-STATE.
  6992             20  MA-CITY                   PIC X(28).
  6993             20  MA-ADDR-STATE             PIC XX.
  6994         16  MA-ZIP.
  6995             20  MA-ZIP-CODE.
  6996                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6997                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6998                 24  FILLER                PIC X(4).
  6999             20  MA-ZIP-PLUS4              PIC X(4).
  7000         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7001             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 129
* VP6311.cbl
  7002             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7003             20  FILLER                    PIC X(3).
  7004
  7005         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7006
  7007         16  FILLER                        PIC XXX.
  7008*        16  FILLER                        PIC X(10).
  7009
  7010     12  MA-CRED-BENE-INFO.
  7011         16  MA-CRED-BENE-NAME                 PIC X(25).
  7012         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7013         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7014         16  MA-CRED-BENE-CTYST.
  7015             20  MA-CRED-BENE-CITY             PIC X(28).
  7016             20  MA-CRED-BENE-STATE            PIC XX.
  7017         16  MA-CRED-BENE-ZIP.
  7018             20  MA-CB-ZIP-CODE.
  7019                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7020                     88  MA-CB-CANADIAN-POST-CODE
  7021                                           VALUE 'A' THRU 'Z'.
  7022                 24  FILLER                    PIC X(4).
  7023             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7024         16  MA-CB-CANADIAN-POSTAL-CODE
  7025                            REDEFINES MA-CRED-BENE-ZIP.
  7026             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7027             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7028             20  FILLER                        PIC X(3).
  7029     12  MA-POST-CARD-MAIL-DATA.
  7030         16  MA-MAIL-DATA OCCURS 7.
  7031             20  MA-MAIL-TYPE              PIC X.
  7032                 88  MA-12MO-MAILING           VALUE '1'.
  7033                 88  MA-EXP-MAILING            VALUE '2'.
  7034             20  MA-MAIL-STATUS            PIC X.
  7035                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7036                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7037                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7038             20  MA-MAIL-DATE              PIC XX.
  7039     12  FILLER                            PIC XX.
  7040     12  FILLER                            PIC XX.
  7041*    12  FILLER                            PIC X(30).
  7042******************************************************************
  7043*                                COPY ERCRQST.
  7044******************************************************************
  7045*                                                                *
  7046*                                                                *
  7047*                            ERCRQST.                            *
  7048*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7049*                            VMOD=2.002                          *
  7050*                                                                *
  7051*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7052*                                                                *
  7053*   FILE TYPE = VSAM,KSDS                                        *
  7054*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7055*                                                                *
  7056*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7057*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7058*                                   ACCOUNT, REF, BATCH)         *
  7059*                                                RKP=9, LEN=38   *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 130
* VP6311.cbl
  7060*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7061*                                   ACCOUNT, REF, BATCH)         *
  7062*                                                RKP=47, LEN=46  *
  7063*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7064*                                   BATCH)                       *
  7065*                                                RKP=93, LEN=24  *
  7066*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7067*                                   REF, BATCH)                  *
  7068*                                                RKP=117, LEN=35 *
  7069*   LOG = NO                                                     *
  7070*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7071******************************************************************
  7072
  7073 01  AR-REQUEST-RECORD.
  7074     12  RQ-RECORD-ID                     PIC XX.
  7075         88  VALID-RQ-ID                        VALUE 'RQ'.
  7076
  7077     12  RQ-CONTROL-PRIMARY.
  7078         16  RQ-COMPANY-CD                PIC X.
  7079         16  RQ-ENTRY-BATCH               PIC X(6).
  7080
  7081     12  RQ-CONTROL-BY-ACCT-REF.
  7082         16  RQ-COMPANY-CD-A1             PIC X.
  7083         16  RQ-CARRIER-A1                PIC X.
  7084         16  RQ-GROUPING-A1               PIC X(6).
  7085         16  RQ-STATE-A1                  PIC XX.
  7086         16  RQ-ACCOUNT-A1                PIC X(10).
  7087         16  RQ-REFERENCE-A1              PIC X(12).
  7088         16  RQ-BATCH-A1                  PIC X(6).
  7089
  7090     12  RQ-CONTROL-BY-FIN-RESP.
  7091         16  RQ-COMPANY-CD-A2             PIC X.
  7092         16  RQ-CARRIER-A2                PIC X.
  7093         16  RQ-GROUPING-A2               PIC X(6).
  7094         16  RQ-FIN-RESP-A2               PIC X(10).
  7095         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7096         16  RQ-REFERENCE-A2              PIC X(12).
  7097         16  RQ-BATCH-A2                  PIC X(6).
  7098
  7099     12  RQ-CONTROL-BY-ACCT-AGENT.
  7100         16  RQ-COMPANY-CD-A3             PIC X.
  7101         16  RQ-CARRIER-A3                PIC X.
  7102         16  RQ-GROUPING-A3               PIC X(6).
  7103         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7104         16  RQ-BATCH-A3                  PIC X(6).
  7105
  7106     12  RQ-CONTROL-BY-SUMMARY.
  7107         16  RQ-COMPANY-CD-A4             PIC X.
  7108         16  RQ-SUMMARY-CODE              PIC X(6).
  7109         16  RQ-ACCOUNT-A4                PIC X(10).
  7110         16  RQ-REFERENCE-A4              PIC X(12).
  7111         16  RQ-BATCH-A4                  PIC X(6).
  7112
  7113     12  RQ-REQUEST-METHOD                PIC X.
  7114         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7115         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7116         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7117         88 RQ-BATCH-REQUEST                  VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 131
* VP6311.cbl
  7118     12  FILLER                           PIC X.
  7119     12  RQ-STATUS                        PIC X.
  7120         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7121         88  RQ-RESUBMIT                      VALUE 'R'.
  7122     12  RQ-PROCESSOR-ID                  PIC X(4).
  7123     12  RQ-ENTRY-DT                      PIC XX.
  7124     12  RQ-MO-END-DT                     PIC XX.
  7125     12  RQ-REQUEST-DT                    PIC XX.
  7126     12  RQ-STMT-DT                       PIC XX.
  7127     12  RQ-REVERSAL-DT                   PIC XX.
  7128     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7129     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7130
  7131     12  FILLER                           PIC X(27).
  7132
  7133******************************************************************
  7134
  7135*                                COPY ERCLOFC.
  7136******************************************************************
  7137*                                                                *
  7138*                                                                *
  7139*                            ERCLOFC                             *
  7140*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7141*                            VMOD=2.003                          *
  7142*                                                                *
  7143*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7144*                                                                *
  7145*   FILE TYPE = VSAM,KSDS                                        *
  7146*   RECORD SIZE = 670   RECFORM = FIX                            *
  7147*                                                                *
  7148*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7149*                                                                *
  7150*   LOG = YES                                                    *
  7151*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7152*                                                                *
  7153******************************************************************
  7154
  7155 01  LOAN-OFFICER-MASTER.
  7156     12  LO-RECORD-ID                PIC XX.
  7157         88  VALID-LO-ID                VALUE 'LO'.
  7158
  7159     12  LO-CONTROL-PRIMARY.
  7160         16  LO-COMPANY-CD           PIC X.
  7161         16  LO-CARRIER              PIC X.
  7162         16  LO-GROUPING.
  7163             20  LO-GROUPING-PREFIX  PIC XXX.
  7164             20  LO-GROUPING-PRIME   PIC XXX.
  7165         16  LO-STATE                PIC XX.
  7166         16  LO-ACCOUNT.
  7167             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7168             20  LO-ACCOUNT-PRIME    PIC X(6).
  7169         16  LO-OFFICER-CODE         PIC X(5).
  7170
  7171     12  LO-OFFICER-NAME             PIC X(30).
  7172
  7173     12  LO-LAST-MAINT-DT            PIC XX.
  7174     12  LO-LAST-USER                PIC X(4).
  7175     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 132
* VP6311.cbl
  7176
  7177     12  LO-COMP-CONTROL             PIC X.
  7178             88  LO-SHOW-COMP           VALUE 'Y'.
  7179             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7180     12  LO-DETAIL-CONTROL           PIC X.
  7181             88  LO-PRINT-DETAIL        VALUE 'D'.
  7182             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7183
  7184     12  LO-SV-CARRIER               PIC X.
  7185     12  LO-SV-GROUPING              PIC X(6).
  7186     12  LO-SV-STATE                 PIC XX.
  7187
  7188     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7189     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7190
  7191     12  LO-OFFICER-INFO.
  7192         16  FILLER OCCURS 12 TIMES.
  7193             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7194             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7195             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7196             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7197             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7198             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7199             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7200             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7201     12  FILLER                      PIC X(198).
  7202******************************************************************
  7203*                                COPY ERCPYAJ.
  7204******************************************************************
  7205*                                                                *
  7206*                            ERCPYAJ                             *
  7207*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7208*                            VMOD=2.015                          *
  7209*                                                                *
  7210*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7211*                                                                *
  7212*                                                                *
  7213*   FILE TYPE = VSAM,KSDS                                        *
  7214*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7215*                                                                *
  7216*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7217*       ALTERNATE PATHS = NONE                                   *
  7218*                                                                *
  7219*   LOG = YES                                                    *
  7220*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7221******************************************************************
  7222******************************************************************
  7223*                   C H A N G E   L O G
  7224*
  7225* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7226*-----------------------------------------------------------------
  7227*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7228* EFFECTIVE    NUMBER
  7229*-----------------------------------------------------------------
  7230* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7231* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7232******************************************************************
  7233
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 133
* VP6311.cbl
  7234 01  PENDING-PAY-ADJ.
  7235     12  PY-RECORD-ID                     PIC XX.
  7236         88  VALID-PY-ID                        VALUE 'PY'.
  7237
  7238     12  PY-CONTROL-PRIMARY.
  7239         16  PY-COMPANY-CD                PIC X.
  7240         16  PY-CARRIER                   PIC X.
  7241         16  PY-GROUPING                  PIC X(6).
  7242         16  PY-FIN-RESP                  PIC X(10).
  7243         16  PY-ACCOUNT                   PIC X(10).
  7244         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7245                                          PIC X(10).
  7246         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7247         16  PY-RECORD-TYPE               PIC X.
  7248             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7249             88  PY-DEPOSIT                   VALUE 'D'.
  7250             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7251             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7252             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7253             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7254             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7255             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7256             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7257             88  PY-FICA-ENTRY                VALUE 'F'.
  7258             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7259             88  PY-POLICY-FEE                VALUE 'W'.
  7260             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7261
  7262     12  PY-PYMT-TYPE                     PIC X.
  7263             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7264             88  PY-REINS-PYMT                VALUE 'R'.
  7265             88  PY-EXP-PYMT                  VALUE 'E'.
  7266
  7267     12  PY-BIL-INV                       PIC X(6).
  7268     12  PY-REF-NO                        PIC X(12).
  7269
  7270     12  PY-LAST-MAINT-DT                 PIC XX.
  7271     12  PY-LAST-MAINT-BY                 PIC X(4).
  7272     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7273
  7274     12  PY-PYADJ-RECORD.
  7275         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7276         16  PY-ENTRY-COMMENT             PIC X(30).
  7277         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7278             20  PY-GL-ACCOUNT            PIC X(10).
  7279             20  PY-GL-STATE              PIC X(02).
  7280             20  PY-GL-CANC-SW            PIC X(01).
  7281                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7282                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7283             20  PY-GL-COMMENT            PIC X(10).
  7284             20  FILLER      REDEFINES PY-GL-COMMENT.
  7285                 24  PY-GL-CHECK-NO       PIC 9(06).
  7286                 24  FILLER               PIC X(04).
  7287             20  FILLER                   PIC X(07).
  7288         16  PY-SAVE-ACCOUNT              PIC X(10).
  7289         16  PY-SAVE-TYPE                 PIC X(01).
  7290
  7291         16  PY-LETTERS.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 134
* VP6311.cbl
  7292             20  PY-LETTER OCCURS 3 TIMES
  7293                           INDEXED BY PY-LET-NDX
  7294                                          PIC X(04).
  7295
  7296         16  PY-ERCOMP-TYPE               PIC X.
  7297             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7298             88  PY-GA-TYPE                   VALUE 'G'.
  7299             88  PY-BANK-TYPE                 VALUE 'B'.
  7300         16  FILLER                       PIC X(05).
  7301
  7302     12  PY-RECORD-STATUS.
  7303         16  PY-CREDIT-SELECT-DT          PIC XX.
  7304         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7305         16  PY-BILLED-DATE               PIC XX.
  7306         16  PY-REPORTED-DT               PIC XX.
  7307         16  PY-PMT-APPLIED               PIC X.
  7308             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7309             88  PY-GA-PMT                    VALUE 'G'.
  7310             88  PY-OVWRITE-PMT               VALUE 'O'.
  7311             88  PY-NON-AR-PMT                VALUE 'N'.
  7312         16  FILLER                       PIC X(5).
  7313         16  PY-INPUT-DT                  PIC XX.
  7314         16  PY-CHECK-NUMBER              PIC X(6).
  7315         16  PY-VOID-SW                   PIC X.
  7316             88  PY-CHECK-VOIDED              VALUE 'V'.
  7317         16  PY-CHECK-ORIGIN-SW           PIC X.
  7318             88  PY-BILLING-CHECK             VALUE 'B'.
  7319             88  PY-REFUND-CHECK              VALUE 'R'.
  7320             88  PY-GA-CHECK                  VALUE 'G'.
  7321             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7322             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7323         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7324         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7325         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7326         16  PY-BILL-FLAG                 PIC X.
  7327             88  PY-BILLED                    VALUE 'B'.
  7328         16  PY-AR-FLAG                   PIC X.
  7329             88  PY-AR-CYCLE                  VALUE 'C'.
  7330             88  PY-AR-MONTH-END              VALUE 'M'.
  7331         16  PY-AR-DATE                   PIC XX.
  7332
  7333     12  PY-GL-CODES.
  7334         16  PY-GL-DB                     PIC X(14).
  7335         16  PY-GL-CR                     PIC X(14).
  7336         16  PY-GL-FLAG                   PIC X.
  7337         16  PY-GL-DATE                   PIC XX.
  7338
  7339     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7340     12  FILLER                           PIC X(3).
  7341******************************************************************
  7342*                                COPY ERCCNOT.
  7343******************************************************************
  7344*                                                                *
  7345*                            ERCCNOT                             *
  7346*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7347*                            VMOD=2.003                          *
  7348*                                                                *
  7349*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 135
* VP6311.cbl
  7350*                                                                *
  7351*        FILE TYPE= VSAM,KSDS                                    *
  7352*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7353*                                                                *
  7354*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7355*                                                                *
  7356*        LOG = YES                                               *
  7357*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7358*                                                                *
  7359******************************************************************
  7360*                   C H A N G E   L O G
  7361*
  7362* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7363*-----------------------------------------------------------------
  7364*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7365* EFFECTIVE    NUMBER
  7366*-----------------------------------------------------------------
  7367* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7368******************************************************************
  7369
  7370 01  CERT-NOTE-FILE.
  7371     12  CZ-RECORD-ID                PIC  XX.
  7372         88  VALID-CZ-ID                  VALUE 'CZ'.
  7373
  7374     12  CZ-CONTROL-PRIMARY.
  7375         16  CZ-COMPANY-CD           PIC X.
  7376         16  CZ-CARRIER              PIC X.
  7377         16  CZ-GROUPING.
  7378             20 CZ-GROUPING-PREFIX   PIC XXX.
  7379             20 CZ-GROUPING-PRIME    PIC XXX.
  7380         16  CZ-STATE                PIC XX.
  7381         16  CZ-ACCOUNT.
  7382             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7383             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7384         16  CZ-CERT-EFF-DT          PIC XX.
  7385         16  CZ-CERT-NO.
  7386             20  CZ-CERT-PRIME       PIC X(10).
  7387             20  CZ-CERT-SFX         PIC X.
  7388         16  CZ-RECORD-TYPE          PIC X.
  7389             88  CERT-NOTE           VALUE '1'.
  7390             88  CLAIM-CERT-NOTE     VALUE '2'.
  7391         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7392
  7393     12  CZ-LAST-MAINT-DT            PIC XX.
  7394     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7395     12  CZ-LAST-MAINT-USER          PIC X(4).
  7396
  7397     12  CZ-NOTE-INFORMATION.
  7398         16  CZ-NOTE                 PIC X(63).
  7399         16  FILLER                  PIC X(39).
  7400******************************************************************
  7401*                                COPY ELCMSTR.
  7402******************************************************************
  7403*                                                                *
  7404*                            ELCMSTR.                            *
  7405*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7406*                            VMOD=2.012                          *
  7407*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 136
* VP6311.cbl
  7408*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7409*                                                                *
  7410*   FILE TYPE = VSAM,KSDS                                        *
  7411*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7412*                                                                *
  7413*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7414*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7415*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7416*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7417*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7418*                                                 RKP=75,LEN=21  *
  7419*                                                                *
  7420*   **** NOTE ****                                               *
  7421*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7422*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7423*                                                                *
  7424*   LOG = YES                                                    *
  7425*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7426******************************************************************
  7427*                   C H A N G E   L O G
  7428*
  7429* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7430*-----------------------------------------------------------------
  7431*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7432* EFFECTIVE    NUMBER
  7433*-----------------------------------------------------------------
  7434* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7435* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7436* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7437* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7438* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7439* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7440* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7441******************************************************************
  7442 01  CLAIM-MASTER.
  7443     12  CL-RECORD-ID                PIC XX.
  7444         88  VALID-CL-ID         VALUE 'CL'.
  7445
  7446     12  CL-CONTROL-PRIMARY.
  7447         16  CL-COMPANY-CD           PIC X.
  7448         16  CL-CARRIER              PIC X.
  7449         16  CL-CLAIM-NO             PIC X(7).
  7450         16  CL-CERT-NO.
  7451             20  CL-CERT-PRIME       PIC X(10).
  7452             20  CL-CERT-SFX         PIC X.
  7453
  7454     12  CL-CONTROL-BY-NAME.
  7455         16  CL-COMPANY-CD-A1        PIC X.
  7456         16  CL-INSURED-LAST-NAME    PIC X(15).
  7457         16  CL-INSURED-NAME.
  7458             20  CL-INSURED-1ST-NAME PIC X(12).
  7459             20  CL-INSURED-MID-INIT PIC X.
  7460
  7461     12  CL-CONTROL-BY-SSN.
  7462         16  CL-COMPANY-CD-A2        PIC X.
  7463         16  CL-SOC-SEC-NO.
  7464             20  CL-SSN-STATE        PIC XX.
  7465             20  CL-SSN-ACCOUNT      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 137
* VP6311.cbl
  7466             20  CL-SSN-LN3          PIC X(3).
  7467
  7468     12  CL-CONTROL-BY-CERT-NO.
  7469         16  CL-COMPANY-CD-A4        PIC X.
  7470         16  CL-CERT-NO-A4.
  7471             20  CL-CERT-A4-PRIME    PIC X(10).
  7472             20  CL-CERT-A4-SFX      PIC X.
  7473
  7474     12  CL-CONTROL-BY-CCN.
  7475         16  CL-COMPANY-CD-A5        PIC X.
  7476         16  CL-CCN-A5.
  7477             20  CL-CCN.
  7478                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7479                 24  CL-CCN-PRIME-A5 PIC X(12).
  7480             20  CL-CCN-FILLER-A5    PIC X(4).
  7481
  7482     12  CL-INSURED-PROFILE-DATA.
  7483         16  CL-INSURED-BIRTH-DT     PIC XX.
  7484         16  CL-INSURED-SEX-CD       PIC X.
  7485             88  INSURED-IS-MALE        VALUE 'M'.
  7486             88  INSURED-IS-FEMALE      VALUE 'F'.
  7487             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7488         16  CL-INSURED-OCC-CD       PIC X(6).
  7489         16  FILLER                  PIC X(5).
  7490
  7491     12  CL-PROCESSING-INFO.
  7492         16  CL-PROCESSOR-ID         PIC X(4).
  7493         16  CL-CLAIM-STATUS         PIC X.
  7494             88  CLAIM-IS-OPEN          VALUE 'O'.
  7495             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7496         16  CL-CLAIM-TYPE           PIC X.
  7497*            88  AH-CLAIM               VALUE 'A'.
  7498*            88  LIFE-CLAIM             VALUE 'L'.
  7499*            88  PROPERTY-CLAIM         VALUE 'P'.
  7500*            88  IUI-CLAIM              VALUE 'I'.
  7501*            88  GAP-CLAIM              VALUE 'G'.
  7502*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7503*            88  OTHER-CLAIM            VALUE 'O'.
  7504         16  CL-CLAIM-PREM-TYPE      PIC X.
  7505             88  SINGLE-PREMIUM         VALUE '1'.
  7506             88  O-B-COVERAGE           VALUE '2'.
  7507             88  OPEN-END-COVERAGE      VALUE '3'.
  7508         16  CL-INCURRED-DT          PIC XX.
  7509         16  CL-REPORTED-DT          PIC XX.
  7510         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7511         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7512         16  CL-LAST-PMT-DT          PIC XX.
  7513         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7514         16  CL-PAID-THRU-DT         PIC XX.
  7515         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7516         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7517         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7518         16  CL-PMT-CALC-METHOD      PIC X.
  7519             88  CL-360-DAY-YR          VALUE '1'.
  7520             88  CL-365-DAY-YR          VALUE '2'.
  7521             88  CL-FULL-MONTHS         VALUE '3'.
  7522         16  CL-CAUSE-CD             PIC X(6).
  7523
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 138
* VP6311.cbl
  7524         16  CL-PRIME-CERT-NO.
  7525             20  CL-PRIME-CERT-PRIME PIC X(10).
  7526             20  CL-PRIME-CERT-SFX   PIC X.
  7527
  7528         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7529             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7530             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7531
  7532         16  CL-MICROFILM-NO         PIC X(10).
  7533         16  FILLER REDEFINES CL-MICROFILM-NO.
  7534             20  CL-BENEFIT-PERIOD   PIC 99.
  7535             20  FILLER              PIC X(8).
  7536         16  CL-PROG-FORM-TYPE       PIC X.
  7537         16  CL-LAST-ADD-ON-DT       PIC XX.
  7538
  7539         16  CL-LAST-REOPEN-DT       PIC XX.
  7540         16  CL-LAST-CLOSE-DT        PIC XX.
  7541         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7542             88  FINAL-PAID             VALUE '1'.
  7543             88  CLAIM-DENIED           VALUE '2'.
  7544             88  AUTO-CLOSE             VALUE '3'.
  7545             88  MANUAL-CLOSE           VALUE '4'.
  7546             88  BENEFITS-CHANGED       VALUE 'C'.
  7547             88  SETUP-ERRORS           VALUE 'E'.
  7548         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7549         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7550         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7551             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7552         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7553         16  FILLER                  PIC X.
  7554
  7555     12  CL-CERTIFICATE-DATA.
  7556         16  CL-CERT-ORIGIN          PIC X.
  7557             88  CERT-WAS-ONLINE        VALUE '1'.
  7558             88  CERT-WAS-CREATED       VALUE '2'.
  7559             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7560         16  CL-CERT-KEY-DATA.
  7561             20  CL-CERT-CARRIER     PIC X.
  7562             20  CL-CERT-GROUPING    PIC X(6).
  7563             20  CL-CERT-STATE       PIC XX.
  7564             20  CL-CERT-ACCOUNT.
  7565                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7566                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7567             20  CL-CERT-EFF-DT      PIC XX.
  7568
  7569     12  CL-STATUS-CONTROLS.
  7570         16  CL-PRIORITY-CD          PIC X.
  7571             88  CONFIDENTIAL-DATA      VALUE '8'.
  7572             88  HIGHEST-PRIORITY       VALUE '9'.
  7573         16  CL-SUPV-ATTN-CD         PIC X.
  7574             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7575             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7576         16  CL-PURGED-DT            PIC XX.
  7577         16  CL-RESTORED-DT          PIC XX.
  7578         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7579         16  CL-NEXT-RESEND-DT       PIC XX.
  7580         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7581         16  CL-CRITICAL-PERIOD      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 139
* VP6311.cbl
  7582*        16  FILLER                  PIC XX.
  7583         16  CL-LAST-MAINT-DT        PIC XX.
  7584         16  CL-LAST-MAINT-USER      PIC X(4).
  7585         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7586         16  CL-LAST-MAINT-TYPE      PIC X.
  7587             88  CLAIM-SET-UP           VALUE ' '.
  7588             88  PAYMENT-MADE           VALUE '1'.
  7589             88  LETTER-SENT            VALUE '2'.
  7590             88  MASTER-WAS-ALTERED     VALUE '3'.
  7591             88  MASTER-WAS-RESTORED    VALUE '4'.
  7592             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7593             88  FILE-CONVERTED         VALUE '6'.
  7594             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7595             88  ERROR-CORRECTION       VALUE 'E'.
  7596         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7597         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7598         16  CL-BENEFICIARY          PIC X(10).
  7599         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7600         16  CL-DENIAL-TYPE          PIC X.
  7601             88  CL-TYPE-DENIAL          VALUE '1'.
  7602             88  CL-TYPE-RESCISSION      VALUE '2'.
  7603             88  CL-TYPE-REFORMATION     VALUE '3'.
  7604             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7605             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7606         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7607         16  filler                  pic x(3).
  7608*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7609*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7610*        16  CL-RTW-DT               PIC XX.
  7611
  7612     12  CL-TRAILER-CONTROLS.
  7613         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7614             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7615             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7616             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7617         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7618         16  FILLER                  PIC XX.
  7619         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7620         16  CL-ADDRESS-TRAILER-CNT.
  7621             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7622                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7623             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7624                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7625             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7626                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7627             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7628                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7629             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7630                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7631             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7632                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7633             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7634                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7635
  7636     12  CL-CV-REFERENCE-NO.
  7637         16  CL-CV-REFNO-PRIME       PIC X(18).
  7638         16  CL-CV-REFNO-SFX         PIC XX.
  7639
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 140
* VP6311.cbl
  7640     12  CL-FILE-LOCATION            PIC X(4).
  7641
  7642     12  CL-PROCESS-ERRORS.
  7643         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7644             88  NO-FATAL-ERRORS        VALUE ZERO.
  7645         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7646             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7647
  7648     12  CL-PRODUCT-CD               PIC X.
  7649
  7650     12  CL-CURRENT-KEY-DATA.
  7651         16  CL-CURRENT-CARRIER      PIC X.
  7652         16  CL-CURRENT-GROUPING     PIC X(6).
  7653         16  CL-CURRENT-STATE        PIC XX.
  7654         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7655
  7656     12  CL-ASSOCIATES               PIC X.
  7657         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7658         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7659         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7660         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7661
  7662     12  CL-ACTIVITY-CODE            PIC 99.
  7663     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7664     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7665
  7666     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7667     12  CL-LAG-REPORT-CODE          PIC 9.
  7668     12  CL-LOAN-TYPE                PIC XX.
  7669     12  CL-LEGAL-STATE              PIC XX.
  7670
  7671     12  CL-YESNOSW                  PIC X.
  7672     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7673         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7674         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7675         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7676     12  cl-insured-type             pic x.
  7677         88  cl-claim-on-primary         value 'P'.
  7678         88  cl-claim-on-co-borrower     value 'C'.
  7679     12  cl-benefit-expiration-dt    PIC XX.
  7680*                                COPY ERCENDT.
  7681******************************************************************
  7682*                                                                *
  7683*                                                                *
  7684*                            ERCENDT.                            *
  7685*                            VMOD=2.001                          *
  7686*                                                                *
  7687*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7688*                                                                *
  7689*   FILE TYPE = VSAM,KSDS                                        *
  7690*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7691*                                                                *
  7692*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7693*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7694*                                                                *
  7695*   LOG = NO                                                     *
  7696*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7697******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 141
* VP6311.cbl
  7698*-----------------------------------------------------------------
  7699*                   C H A N G E   L O G
  7700*
  7701* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7702*-----------------------------------------------------------------
  7703*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7704* EFFECTIVE    NUMBER
  7705*-----------------------------------------------------------------
  7706* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7707*                                WITH OPEN CLAIMS
  7708* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7709* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7710* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7711* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7712*-----------------------------------------------------------------
  7713 01  ENDORSEMENT-RECORD.
  7714     12  EN-RECORD-ID                PIC XX.
  7715         88  VALID-EN-ID                VALUE 'EN'.
  7716     12  EN-CONTROL-PRIMARY.
  7717         16  EN-COMPANY-CD           PIC X.
  7718         16  EN-CARRIER              PIC X.
  7719         16  EN-GROUPING             PIC X(6).
  7720         16  EN-STATE                PIC XX.
  7721         16  EN-ACCOUNT              PIC X(10).
  7722         16  EN-CERT-EFF-DT          PIC XX.
  7723         16  EN-CERT-NO.
  7724             20  EN-CERT-PRIME       PIC X(10).
  7725             20  EN-CERT-SFX         PIC X.
  7726         16  EN-REC-TYPE             PIC X.
  7727             88  EN-ISSUE               VALUE 'I'.
  7728             88  EN-CANCELLATION        VALUE 'C'.
  7729         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7730     12  EN-CONTROL-BY-ARCH-NO.
  7731         16  EN-COMPANY-CD-A1              PIC X.
  7732         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7733     12  EN-LAST-MAINT-DT            PIC XX.
  7734     12  EN-LAST-MAINT-BY            PIC X(4).
  7735     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7736     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7737     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7738         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7739         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7740         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7741         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7742         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7743         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7744         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7745         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7746         16  EN-LF-ORIG-BENCD        PIC XX.
  7747         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7748         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7749         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7750         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7751         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7752         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7753*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7754         16  EN-ORIG-CRED-BENE       PIC X(25).
  7755         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 142
* VP6311.cbl
  7756         16  FILLER                  PIC X.
  7757         16  EN-AH-ORIG-BENCD        PIC XX.
  7758         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7759         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7760         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7761         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7762*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7763*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7764         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7765         16  F                       PIC X(09).
  7766         16  EN-AH-ORIG-CP           PIC 99.
  7767         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7768         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7769         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7770         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7771         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7772         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7773         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7774         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7775         16  EN-LF-NEW-BENCD         PIC XX.
  7776         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7777         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7778         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7779         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7780         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7781         16  EN-LF-NEW-EXP-DT        PIC XX.
  7782         16  EN-NEW-CRED-BENE        PIC X(25).
  7783         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7784         16  FILLER                  PIC X.
  7785         16  EN-AH-NEW-BENCD         PIC XX.
  7786         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7787         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7788         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7789         16  EN-AH-NEW-EXP-DT        PIC XX.
  7790*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7791*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7792*        16  F                       PIC X(12).
  7793         16  EN-AH-NEW-CP            PIC 99.
  7794         16  EN-SIG-SW               PIC X.
  7795         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7796         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7797         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7798         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7799         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7800         16  FILLER                  PIC X(33).
  7801     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7802         16  EN-LF-ORIG-REF-DT       PIC XX.
  7803         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7804         16  EN-AH-ORIG-REF-DT       PIC XX.
  7805         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7806         16  EN-LF-NEW-REF-DT        PIC XX.
  7807         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7808         16  EN-AH-NEW-REF-DT        PIC XX.
  7809         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7810         16  EN-FLAG-CERT            PIC X.
  7811         16  EN-INS-LAST-NAME        PIC X(15).
  7812         16  EN-INS-FIRST-NAME       PIC X(10).
  7813         16  EN-INS-MIDDLE-INIT      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 143
* VP6311.cbl
  7814         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7815         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7816         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7817         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7818         16  FILLER                  PIC X(262).
  7819     12  EN-MONEY-SW             PIC X.
  7820     12  EN-HEALTH-APP           PIC X.
  7821     12  EN-VOUCHER-SW           PIC X.
  7822     12  EN-PAYEE                PIC X(14).
  7823     12  EN-INPUT-DT             PIC XX.
  7824     12  EN-PROCESS-DT           PIC XX.
  7825     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7826     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7827     12  EN-REASON-CODES.
  7828         16  F OCCURS 12.
  7829             20  EN-REASON-CODE  PIC X(4).
  7830     12  EN-TEMPLATE-USED        PIC X(8).
  7831     12  EN-DOCU-TYPE            PIC X.
  7832         88  EN-VERI-DOCU          VALUE 'V'.
  7833         88  EN-GCE-DOCU           VALUE 'G'.
  7834         88  EN-CANC-DOCU          VALUE 'C'.
  7835     12  EN-COMMENTS1            PIC X(13).
  7836     12  EN-COMMENTS2            PIC X(70).
  7837     12  EN-COMM-CHGBK           PIC X.
  7838         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7839         88  EN-CHG-ACCT           VALUE 'Y'.
  7840     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7841     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7842     12  EN-BATCH-NUMBER         PIC X(6).
  7843     12  EN-ACCT-SUMM            PIC X.
  7844     12  EN-CSO-SUMM             PIC X.
  7845     12  en-check-type           pic x.
  7846     12  FILLER                  PIC X(12).
  7847******************************************************************
  7848*                                COPY ELCCRTT.
  7849******************************************************************
  7850*                                                                *
  7851*                            ELCCRTT.                            *
  7852*                                                                *
  7853*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7854*                                                                *
  7855*   FILE TYPE = VSAM,KSDS                                        *
  7856*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7857*                                                                *
  7858*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7859*                                                                *
  7860*   LOG = YES                                                    *
  7861*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7862******************************************************************
  7863*                   C H A N G E   L O G
  7864*
  7865* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7866*-----------------------------------------------------------------
  7867*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7868* EFFECTIVE    NUMBER
  7869*-----------------------------------------------------------------
  7870* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7871* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 144
* VP6311.cbl
  7872* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7873* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7874* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7875* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7876* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7877* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7878* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  7879* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  7880* 091318  CR2018073000001  PEMA  ADD Refund methods
  7881* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7882******************************************************************
  7883
  7884 01  CERTIFICATE-TRAILERS.
  7885     12  CS-RECORD-ID                      PIC XX.
  7886         88  VALID-CS-ID                      VALUE 'CS'.
  7887
  7888     12  CS-CONTROL-PRIMARY.
  7889         16  CS-COMPANY-CD                 PIC X.
  7890         16  CS-CARRIER                    PIC X.
  7891         16  CS-GROUPING                   PIC X(6).
  7892         16  CS-STATE                      PIC XX.
  7893         16  CS-ACCOUNT                    PIC X(10).
  7894         16  CS-CERT-EFF-DT                PIC XX.
  7895         16  CS-CERT-NO.
  7896             20  CS-CERT-PRIME             PIC X(10).
  7897             20  CS-CERT-SFX               PIC X.
  7898         16  CS-TRAILER-TYPE               PIC X.
  7899             88  COMM-TRLR           VALUE 'A'.
  7900             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7901             88  CERT-DATA-TRLR      VALUE 'C'.
  7902
  7903     12  CS-DATA-AREA                      PIC X(516).
  7904
  7905     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7906         16  CS-BANK-COMMISSION-AREA.
  7907             20  CS-BANK-COMMS       OCCURS 10.
  7908                 24  CS-AGT                PIC X(10).
  7909                 24  CS-COM-TYP            PIC X.
  7910                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7911                 24  CS-RECALC-LV-INDIC    PIC X.
  7912                 24  FILLER                PIC X(10).
  7913         16  FILLER                        PIC X(256).
  7914
  7915     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7916****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7917         16  CS-MB-CLAIM-DATA OCCURS 24.
  7918             20  CS-CLAIM-NO               PIC X(7).
  7919             20  CS-CLAIM-TYPE             PIC X.
  7920                 88  CS-AH-CLM               VALUE 'A'.
  7921                 88  CS-IU-CLM               VALUE 'I'.
  7922                 88  CS-GP-CLM               VALUE 'G'.
  7923                 88  CS-LF-CLM               VALUE 'L'.
  7924                 88  CS-PR-CLM               VALUE 'P'.
  7925                 88  CS-FL-CLM               VALUE 'F'.
  7926                 88  CS-OT-CLM               VALUE 'O'.
  7927             20  CS-INSURED-TYPE           PIC X.
  7928                 88  CS-PRIM-INSURED          VALUE 'P'.
  7929                 88  CS-CO-BORROWER           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 145
* VP6311.cbl
  7930             20  CS-BENEFIT-PERIOD         PIC 99.
  7931             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7932             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7933             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7934         16  FILLER                        PIC X(12).
  7935     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7936         16  CS-VIN-NUMBER                 PIC X(17).
  7937         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7938         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7939         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7940         16  cs-agent-name.
  7941             20  cs-agent-fname            pic x(20).
  7942             20  cs-agent-mi               pic x.
  7943             20  cs-agent-lname            pic x(25).
  7944         16  cs-license-no                 pic x(15).
  7945         16  cs-npn-number                 pic x(10).
  7946         16  cs-agent-edit-status          pic x.
  7947             88  cs-ae-refer-to-manager      value 'M'.
  7948             88  cs-ae-cover-sheet           value 'C'.
  7949             88  cs-ae-sig-form              value 'S'.
  7950             88  cs-ae-verified              value 'V'.
  7951             88  cs-unidentified-signature   value 'U'.
  7952             88  cs-cert-returned            value 'R'.
  7953             88  cs-accept-no-commission     value 'N'.
  7954         16  cs-year                       pic 9999.
  7955         16  cs-make                       pic x(20).
  7956         16  cs-model                      pic x(20).
  7957         16  cs-future                     pic x(20).
  7958         16  cs-vehicle-odometer           pic s9(7) comp-3.
  7959         16  cs-claim-verification-status  pic x.
  7960             88  cs-clm-ver-eligible         value 'A'.
  7961             88  cs-clm-ver-partial-elig     value 'B'.
  7962             88  cs-clm-ver-not-eligible     value 'C'.
  7963             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  7964             88  cs-clm-ver-not-part-elig-rw value 'E'.
  7965             88  cs-clm-ver-ND-CERT          value 'F'.
  7966             88  cs-clm-ver-spec-other       value 'G'.
  7967             88  cs-clam-ver-pratial-corrected
  7968                                             value 'H'.
  7969             88  cs-clm-ver-no-matches       value 'I'.
  7970             88  cs-clm-ver-not-elig-corrected
  7971                                             value 'J'.
  7972             88  cs-clm-ver-needs-review     value 'R'.
  7973             88  cs-clm-ver-sent-to-claims   value 'W'.
  7974         16  CS-LF-REFUND-METHOD           PIC X.
  7975         16  CS-AH-REFUND-METHOD           PIC X.
  7976         16  FILLER                        PIC X(353). *> was 420
  7977*        16  FILLER                        PIC X(496).
  7978*                                COPY ERCCHEK.
  7979******************************************************************
  7980*                                                                *
  7981*                                                                *
  7982*                            ERCCHEK                             *
  7983*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7984*                            VMOD=2.008                          *
  7985*                                                                *
  7986*   FILE DESCRIPTION = CHECK RECORDS                             *
  7987*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 146
* VP6311.cbl
  7988*   FILE TYPE = VSAM,KSDS                                        *
  7989*   RECORD SIZE = 600    RECFORM = FIXED                         *
  7990*                                                                *
  7991*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  7992*       ALTERNATE INDEX = NONE                                   *
  7993*                                                                *
  7994*   LOG = YES                                                    *
  7995*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7996******************************************************************
  7997*                   C H A N G E   L O G
  7998*
  7999* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8000*-----------------------------------------------------------------
  8001*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8002* EFFECTIVE    NUMBER
  8003*-----------------------------------------------------------------
  8004* 021414    2003053000001  PEMA  changes for auto chk request
  8005******************************************************************
  8006 01  CHECK-RECORDS.
  8007     12  CH-RECORD-ID                      PIC XX.
  8008         88  VALID-CH-ID                      VALUE 'CH'.
  8009
  8010     12  CH-CONTROL-PRIMARY.
  8011         16  CH-COMPANY-CD                 PIC X.
  8012         16  CH-CARRIER                    PIC X.
  8013         16  CH-GROUPING                   PIC X(6).
  8014         16  CH-STATE                      PIC XX.
  8015         16  CH-ACCOUNT                    PIC X(10).
  8016         16  CH-CERT-EFF-DT                PIC XX.
  8017         16  CH-CERT-NO.
  8018             20  CH-CERT-PRIME             PIC X(10).
  8019             20  CH-CERT-SFX               PIC X.
  8020         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8021
  8022     12  CH-RECORDED-DT                    PIC XX.
  8023     12  CH-RECORDED-BY                    PIC X(4).
  8024     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8025
  8026     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8027     12  CH-CHECK-NO                       PIC X(7).
  8028     12  CH-REASON-FOR-CHECK               PIC X(25).
  8029     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8030     12  FILLER                            PIC X.
  8031
  8032     12  CH-PAYEE-INFO.
  8033         16  CH-PAYEE-NAME-1               PIC X(30).
  8034         16  CH-PAYEE-NAME-2               PIC X(30).
  8035         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8036         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8037         16  CH-PAYEE-CITY-ST.
  8038             20  CH-PAYEE-CITY             PIC X(28).
  8039             20  CH-PAYEE-STATE            PIC XX.
  8040         16  CH-PAYEE-ZIP-CODE.
  8041             20  CH-PAYEE-ZIP.
  8042                 24  CH-ZIP-PRI-1ST        PIC X.
  8043                     88  CH-CANADIAN-POST-CODE
  8044                                           VALUES 'A' THRU 'Z'.
  8045                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 147
* VP6311.cbl
  8046             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8047         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8048             20  CH-CAN-POSTAL-1           PIC XXX.
  8049             20  CH-CAN-POSTAL-2           PIC XXX.
  8050             20  FILLER                    PIC XXX.
  8051
  8052     12  CH-CHECK-STUB-TEXT.
  8053         16  CH-STUB-LINE-1                PIC X(30).
  8054         16  CH-TEXT-LINE-1                PIC X(50).
  8055         16  CH-TEXT-LINE-2                PIC X(50).
  8056         16  CH-TEXT-LINE-3                PIC X(40).
  8057     12  CH-RETURN-TO                      PIC X(30).
  8058
  8059     12  CH-COMPENSATION-CONTROL.
  8060         16  CH-COMP-CARRIER               PIC X.
  8061         16  CH-COMP-GROUPING              PIC X(6).
  8062         16  CH-COMP-FIN-RESP              PIC X(10).
  8063         16  CH-COMP-ACCOUNT               PIC X(10).
  8064
  8065     12  CH-CREDIT-SELECT-DT               PIC XX.
  8066     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8067     12  CH-PAYEE-CODE                     PIC X(6).
  8068
  8069     12  CH-VOID-DATA.
  8070         20  CH-VOID-DT                    PIC XX.
  8071         20  CH-VOID-BY                    PIC X(4).
  8072         20  CH-VOID-REASON                PIC X(25).
  8073
  8074     12  CH-APPROVAL-DATA.
  8075         20  CH-APPROVAL-DT                PIC XX.
  8076         20  CH-APPROVAL-STATUS            PIC X.
  8077             88  CH-IN-LIMBO                  VALUE ' '.
  8078             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8079             88  CH-APPROVED                  VALUE 'A'.
  8080             88  CH-DENIED                    VALUE 'D'.
  8081         20  CH-APPROVED-BY                PIC XXXX.
  8082     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8083             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8084     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8085
  8086     12  ch-released-dt                    pic xx.
  8087     12  ch-check-cashed-dt                pic xx.
  8088     12  FILLER                            PIC X.
  8089*    12  CH-CHECK-REFERENCE                PIC X(12).
  8090     12  CH-CHECK-ORIGIN-SW                PIC X.
  8091             88  CH-REFUND-CHECK              VALUE 'R'.
  8092             88  CH-MAINT-CHECK               VALUE 'M'.
  8093
  8094     12  CH-CANC-DT                        PIC XX.
  8095     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8096     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8097
  8098     12  CH-INSURED-NAME                   PIC X(28).
  8099
  8100     12  ch-released-by                    pic x(4).
  8101     12  ch-csr                            pic x(4).
  8102     12  ch-deduct-commission              pic x.
  8103         88  ch-deduct-comm                  value 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 148
* VP6311.cbl
  8104         88  ch-do-not-deduct-comm           value 'N'.
  8105
  8106     12  FILLER                            PIC X(11).
  8107*    12  CH-LETTER-TABLE.
  8108*        16  CH-LETTERS OCCURS 3 TIMES
  8109*                       INDEXED BY CH-LT-NDX
  8110*                                          PIC X(04).
  8111
  8112     12  FILLER                            PIC X(07).
  8113
  8114 01  var                         pic x(30).
  8115 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8116                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8117                          PENDING-MAILING-DATA MAILING-DATA
  8118                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8119                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8120                          CLAIM-MASTER ENDORSEMENT-RECORD
  8121                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8122                          VAR.
  8123 0000-DFHEXIT SECTION.
  8124     MOVE '9#                    $   ' TO DFHEIV0.
  8125     MOVE 'VP6311' TO DFHEIV1.
  8126     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8127
  8128     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8129     MOVE EIBTRMID               TO QID-TERM.
  8130     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8131     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8132     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8133     MOVE 2                      TO EMI-SWITCH2.
  8134
  8135     move spaces to ws-kix-myenv
  8136     set P to address of KIXSYS
  8137     CALL "getenv" using by value P returning var-ptr
  8138     if var-ptr = null then
  8139        display ' kixsys not set '
  8140     else
  8141        set address of var to var-ptr
  8142        move 0 to env-var-len
  8143        inspect var tallying env-var-len
  8144          for characters before X'00'
  8145        unstring var (1:env-var-len) delimited by '/'
  8146           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8147              WS-KIX-SYS
  8148        end-unstring
  8149     end-if
  8150     perform varying a1 from +1 by +1 until a1 > +10
  8151        if ws-kix-myenv (a1:1) = low-values or high-values
  8152           display ' found low or hi val '
  8153           move spaces to ws-kix-myenv (a1:1)
  8154        end-if
  8155     end-perform
  8156*    display ' env *' ws-kix-myenv '*'
  8157     IF EIBCALEN = 0
  8158         GO TO 8800-UNAUTHORIZED-ACCESS.
  8159
  8160     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8161     MOVE '5'                   TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 149
* VP6311.cbl
  8162     PERFORM 9700-DATE-LINK.
  8163     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8164     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8165
  8166     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8167     MOVE SPACE                  TO DC-OPTION-CODE.
  8168     PERFORM 9700-DATE-LINK.
  8169     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8170     MOVE LOW-VALUES             TO VP631BI.
  8171
  8172
  8173* EXEC CICS HANDLE CONDITION
  8174*        PGMIDERR  (9600-PGMID-ERROR)
  8175*        ERROR     (9990-ABEND)
  8176*        INVREQ    (9990-ABEND)
  8177*        QIDERR    (0010-MAIN-LOGIC)
  8178*    END-EXEC.
  8179*    MOVE '"$L.8N                ! " #00008168' TO DFHEIV0
  8180     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8181     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8182     MOVE X'2220233030303038313638' TO DFHEIV0(25:11)
  8183     CALL 'kxdfhei1' USING DFHEIV0
  8184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8185
  8186
  8187     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8188         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8189             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8190             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8191             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8192             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8193             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8194             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8195             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8196             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8197
  8198             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8199                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8200
  8201             ELSE
  8202                 NEXT SENTENCE
  8203
  8204         ELSE
  8205             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8206             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8207             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8208             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8209             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8210             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8211             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8212             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8213             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8214             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8215             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8216             GO TO 3900-RE-DISPLAY-RECORD
  8217     ELSE
  8218         GO TO 0020-MAIN-LOGIC.
  8219
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 150
* VP6311.cbl
  8220 0010-MAIN-LOGIC.
  8221     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8222                                    WS-FIRST-ENTRY-SW.
  8223
  8224     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8225
  8226     MOVE LOW-VALUES             TO EC-NEW-CERT
  8227                                    EC-NEW-STATE.
  8228
  8229     IF PI-DISPLAY-ORIGINAL-BATCH
  8230         NEXT SENTENCE
  8231     ELSE
  8232         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8233             GO TO 5000-BROWSE-BATCH-HEADERS.
  8234
  8235     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8236         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8237
  8238     IF PI-CSR-BROWSE
  8239        GO TO 4200-BROWSE-CSR-FORWARD.
  8240
  8241     IF PI-FILE-BROWSE
  8242         GO TO 4300-BROWSE-FILE-FORWARD.
  8243
  8244     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8245
  8246 0020-MAIN-LOGIC.
  8247     IF EIBAID = DFHCLEAR
  8248         GO TO 9400-CLEAR.
  8249
  8250     MOVE LOW-VALUES             TO EC-NEW-CERT
  8251                                    EC-NEW-STATE.
  8252
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 151
* VP6311.cbl
  8254
  8255******************************************************************
  8256*                                                                *
  8257*              R E C E I V E   M A P                             *
  8258*                                                                *
  8259******************************************************************
  8260
  8261 0200-RECEIVE.
  8262     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8263         MOVE ER-0008            TO EMI-ERROR
  8264         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8265         IF PI-MAP-NAME = VP631B
  8266             MOVE -1                 TO BMAINTL
  8267             GO TO 8200-SEND-DATAONLY
  8268         ELSE
  8269             IF PI-MAP-NAME = VP631C
  8270                 MOVE -1                 TO CMAINTL
  8271                 GO TO 8200-SEND-DATAONLY
  8272             ELSE
  8273                 IF PI-MAP-NAME = VP631D
  8274                     MOVE -1                 TO DPFENTRL
  8275                     GO TO 8200-SEND-DATAONLY.
  8276
  8277
  8278* EXEC CICS RECEIVE
  8279*        MAP      (PI-MAP-NAME)
  8280*        MAPSET   (MAPSET-VP6311S)
  8281*        INTO     (VP631BI)
  8282*    END-EXEC.
  8283     MOVE LENGTH OF
  8284      VP631BI
  8285       TO DFHEIV11
  8286*    MOVE '8"T I  L              ''   #00008265' TO DFHEIV0
  8287     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8288     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8289     MOVE X'2020233030303038323635' TO DFHEIV0(25:11)
  8290     CALL 'kxdfhei1' USING DFHEIV0,
  8291           PI-MAP-NAME,
  8292           VP631BI,
  8293           DFHEIV11,
  8294           MAPSET-VP6311S,
  8295           DFHEIV99,
  8296           DFHEIV99
  8297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8298
  8299
  8300******************************************************************
  8301*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8302******************************************************************
  8303
  8304     IF BTYPE-LEN (1) EQUAL +3
  8305        IF BTYPE (1) EQUAL ALL ' '
  8306            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8307
  8308     IF BTYPE-LEN (2) EQUAL +3
  8309        IF BTYPE (2) EQUAL ALL ' '
  8310            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8311
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 152
* VP6311.cbl
  8312     INSPECT VP631BI CONVERTING '_' TO ' '.
  8313
  8314     IF PI-MAP-NAME = VP631B
  8315         IF BPFENTRL GREATER THAN ZEROS
  8316             IF EIBAID NOT = DFHENTER
  8317                 MOVE ER-0004       TO EMI-ERROR
  8318                 MOVE -1            TO BPFENTRL
  8319                 MOVE AL-UNBOF      TO BPFENTRA
  8320                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8321                 GO TO 8200-SEND-DATAONLY
  8322             ELSE
  8323                 IF BPFENTRI NUMERIC AND
  8324                   (BPFENTRI GREATER 0 AND LESS 25)
  8325                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8326                 ELSE
  8327                     MOVE ER-0029  TO EMI-ERROR
  8328                     MOVE AL-UNBON TO BPFENTRA
  8329                     MOVE -1       TO BPFENTRL
  8330                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8331                     GO TO 8200-SEND-DATAONLY
  8332         ELSE
  8333             NEXT SENTENCE
  8334     ELSE
  8335         IF PI-MAP-NAME = VP631C
  8336            IF CPFENTRL GREATER THAN ZEROS
  8337                IF EIBAID NOT = DFHENTER
  8338                 MOVE ER-0004         TO EMI-ERROR
  8339                 MOVE -1              TO CPFENTRL
  8340                 MOVE AL-UNBOF        TO CPFENTRA
  8341                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8342                 GO TO 8200-SEND-DATAONLY
  8343             ELSE
  8344                 IF CPFENTRI NUMERIC AND
  8345                   (CPFENTRI GREATER 0 AND LESS 25)
  8346                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8347                 ELSE
  8348                     MOVE ER-0029      TO EMI-ERROR
  8349                     MOVE AL-UNBON     TO CPFENTRA
  8350                     MOVE -1           TO CPFENTRL
  8351                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8352                     GO TO 8200-SEND-DATAONLY
  8353         ELSE
  8354             NEXT SENTENCE
  8355     ELSE
  8356     IF PI-MAP-NAME = VP631D
  8357         IF DPFENTRL GREATER THAN ZEROS
  8358             IF EIBAID NOT = DFHENTER
  8359                 MOVE ER-0004         TO EMI-ERROR
  8360                 MOVE -1              TO DPFENTRL
  8361                 MOVE AL-UNBOF        TO DPFENTRA
  8362                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8363                 GO TO 8200-SEND-DATAONLY
  8364             ELSE
  8365                 IF DPFENTRI NUMERIC AND
  8366                   (DPFENTRI GREATER 0 AND LESS 25)
  8367                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8368                 ELSE
  8369                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 153
* VP6311.cbl
  8370                     MOVE AL-UNBON     TO DPFENTRA
  8371                     MOVE -1           TO DPFENTRL
  8372                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8373                     GO TO 8200-SEND-DATAONLY.
  8374
  8375     IF EIBAID = DFHPF23
  8376         GO TO 8810-PF23.
  8377
  8378     IF EIBAID = DFHPF24
  8379         GO TO 9200-RETURN-MAIN-MENU.
  8380
  8381     IF EIBAID = DFHPF12
  8382         GO TO 9500-PF12.
  8383
  8384     IF PI-MAP-NAME = VP631B
  8385        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8386
  8387     IF PI-MAP-NAME = VP631C
  8388        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8389
  8390     IF PI-MAP-NAME = VP631D
  8391        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8392
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 154
* VP6311.cbl
  8394
  8395******************************************************************
  8396*                                                                *
  8397*      ISSUE SCREEN PF KEY CHECKING                              *
  8398*                                                                *
  8399******************************************************************
  8400
  8401******************************************************************
  8402*                                                                *
  8403*      PF KEY FUNCTIONS:                                         *
  8404*                                                                *
  8405*      PF1  = BROWSE FORWARD                                     *
  8406*      PF2  = BROWSE BACKWARD                                    *
  8407*      PF3  = CERTIFICATE LOOKUP                                 *
  8408*      PF4  = DISPLAY BATCH HEADER                               *
  8409*      PF5  = ADD ISSUE  SCREEN                                  *
  8410*      PF6  = ADD CANCEL SCREEN                                  *
  8411*      PF7  = CERTIFICATE DISPLAY                                *
  8412*      PF8  = CERTIFICATE NOTES                                  *
  8413*      PF9  = EDIT CONTROL                                       *
  8414*      PF10 = DISPLAY LETTER SCREEN                              *
  8415*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8416*      PF12 = HELP SCREEN                                        *
  8417*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8418*      PF14 = ACCOUNT MASTER                                     *
  8419*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8420*      PF16 = DISPLAY LETTER REVIEW                              *
  8421*                                                                *
  8422******************************************************************
  8423
  8424 0300-CHECK-ISSUE-PF-KEYS.
  8425     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8426        MOVE ER-2337            TO EMI-ERROR
  8427        MOVE -1                  TO BMAINTL
  8428        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8429        GO TO 8200-SEND-DATAONLY.
  8430
  8431     IF EIBAID = DFHPF1
  8432        MOVE '0'                TO PI-EDIT-SW
  8433        IF PI-PRIMARY-BROWSE
  8434           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8435        ELSE
  8436           IF PI-PRIMARY-WITH-SELECT
  8437              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8438           ELSE
  8439              IF PI-FILE-BROWSE
  8440                 GO TO 4300-BROWSE-FILE-FORWARD
  8441              ELSE
  8442                 IF PI-CSR-BROWSE
  8443                    GO TO 4200-BROWSE-CSR-FORWARD
  8444                 ELSE
  8445                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8446
  8447     IF EIBAID = DFHPF2
  8448        MOVE '0'                TO PI-EDIT-SW
  8449        IF PI-PRIMARY-BROWSE
  8450           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8451        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 155
* VP6311.cbl
  8452           IF PI-PRIMARY-WITH-SELECT
  8453              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8454           ELSE
  8455              IF PI-FILE-BROWSE
  8456                 GO TO 4800-BROWSE-FILE-BACKWARD
  8457              ELSE
  8458                 IF PI-CSR-BROWSE
  8459                    GO TO 4900-BROWSE-CSR-BACKWARD
  8460                 ELSE
  8461                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8462
  8463     IF EIBAID = DFHPF3
  8464        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8465        MOVE XCTL-EL127         TO PGM-NAME
  8466        GO TO 9300-XCTL.
  8467
  8468     IF (EIBAID = DFHPF15 OR DFHPF6)
  8469        AND (CSR-EDIT-SESSION)
  8470*       AND (FATAL-OR-UNFORCED)
  8471        AND (FATAL-ERRORS)
  8472        MOVE ER-1819             TO EMI-ERROR
  8473        MOVE -1                  TO BMAINTL
  8474        MOVE AL-UANON            TO BMAINTA
  8475        PERFORM 9900-ERROR-FORMAT
  8476                                 THRU 9900-EXIT
  8477        GO TO 8200-SEND-DATAONLY
  8478     END-IF
  8479     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8480      OR (EIBAID = DFHPF10)
  8481        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8482        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8483        IF (RESP-NORMAL)
  8484           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8485              AM-CONTROL-PRIMARY (1:20))
  8486            IF AM-NAME NOT GREATER THAN SPACES OR
  8487               AM-ADDRS NOT GREATER THAN SPACES  OR
  8488               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8489               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8490               AM-ZIP NOT GREATER THAN SPACES
  8491               MOVE ER-3834             TO EMI-ERROR
  8492               MOVE -1                  TO BMAINTL
  8493               MOVE AL-UANON            TO BMAINTA
  8494               PERFORM 9900-ERROR-FORMAT
  8495                                 THRU 9900-EXIT
  8496               GO TO 8200-SEND-DATAONLY
  8497            END-IF
  8498        ELSE
  8499           MOVE ER-1609             TO EMI-ERROR
  8500           MOVE -1                  TO BMAINTL
  8501           MOVE AL-UANON            TO BMAINTA
  8502           PERFORM 9900-ERROR-FORMAT
  8503                                THRU 9900-EXIT
  8504           GO TO 8200-SEND-DATAONLY
  8505        END-IF
  8506
  8507        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8508        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8509        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 156
* VP6311.cbl
  8510            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8511               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8512               MA-CITY NOT GREATER THAN SPACES OR
  8513               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8514               MA-ZIP-CODE NOT GREATER THAN SPACES
  8515               MOVE ER-3835             TO EMI-ERROR
  8516               MOVE -1                  TO BMAINTL
  8517               MOVE AL-UANON            TO BMAINTA
  8518               PERFORM 9900-ERROR-FORMAT
  8519                                 THRU 9900-EXIT
  8520               GO TO 8200-SEND-DATAONLY
  8521            END-IF
  8522        ELSE
  8523           MOVE ER-3000             TO EMI-ERROR
  8524           MOVE -1                  TO BMAINTL
  8525           MOVE AL-UANON            TO BMAINTA
  8526           PERFORM 9900-ERROR-FORMAT
  8527                                THRU 9900-EXIT
  8528           GO TO 8200-SEND-DATAONLY
  8529        END-IF
  8530
  8531     END-IF
  8532     IF (EIBAID = DFHPF15)
  8533        AND (CSR-EDIT-SESSION)
  8534        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8535        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8536        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8537        MOVE PI-SV-STATE         TO PI-STATE
  8538        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8539        MOVE BCERTNOI            TO PI-CERT-PRIME
  8540        MOVE BSUFIXI             TO PI-CERT-SFX
  8541        MOVE BEFFDTI             TO DEEDIT-FIELD
  8542        PERFORM 8600-DEEDIT
  8543        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8544        MOVE '4'                 TO DC-OPTION-CODE
  8545        PERFORM 9700-DATE-LINK
  8546        IF DATE-CONVERSION-ERROR
  8547           MOVE ER-0348          TO EMI-ERROR
  8548           MOVE -1               TO BEFFDTL
  8549           MOVE AL-UABON         TO BEFFDTA
  8550           PERFORM 9900-ERROR-FORMAT
  8551                                 THRU 9900-EXIT
  8552           GO TO 8200-SEND-DATAONLY
  8553        ELSE
  8554           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8555           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8556           MOVE XCTL-EL6315      TO PGM-NAME
  8557           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8558           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8559           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8560           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8561           GO TO 9300-XCTL
  8562        END-IF
  8563     END-IF
  8564
  8565     IF EIBAID = DFHPF4
  8566        MOVE '0'                TO PI-EDIT-SW
  8567        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 157
* VP6311.cbl
  8568           NEXT SENTENCE
  8569        ELSE
  8570           GO TO 7200-DISPLAY-BATCHES.
  8571
  8572     IF EIBAID = DFHPF5
  8573        MOVE ER-0029                TO EMI-ERROR
  8574        MOVE -1                     TO BPFENTRL
  8575        MOVE AL-UNBON               TO BPFENTRA
  8576        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8577        GO TO 8200-SEND-DATAONLY.
  8578*        MOVE '0'                TO PI-EDIT-SW
  8579*        IF PI-DISPLAY-ORIGINAL-BATCH
  8580*           NEXT SENTENCE
  8581*        ELSE
  8582*           MOVE VP631B              TO PI-MAP-NAME
  8583*           MOVE LOW-VALUES          TO VP631BI
  8584*           MOVE 'A'                 TO BMAINTO
  8585*           MOVE AL-UANON            TO BMAINTA
  8586*           MOVE -1                  TO BMAINTL
  8587*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8588*           GO TO 8100-SEND-INITIAL-MAP.
  8589
  8590     IF EIBAID = DFHPF6
  8591        IF NOT CSR-EDIT-SESSION
  8592           MOVE ER-0029                TO EMI-ERROR
  8593           MOVE -1                     TO BPFENTRL
  8594           MOVE AL-UNBON               TO BPFENTRA
  8595           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8596           GO TO 8200-SEND-DATAONLY
  8597*           MOVE '0'              TO PI-EDIT-SW
  8598*           IF PI-DISPLAY-ORIGINAL-BATCH
  8599*              NEXT SENTENCE
  8600*           ELSE
  8601*              MOVE VP631C        TO PI-MAP-NAME
  8602*              MOVE LOW-VALUES    TO VP631CI
  8603*              MOVE 'A'           TO CMAINTO
  8604*              MOVE AL-UANON      TO CMAINTA
  8605*              MOVE -1            TO CMAINTL
  8606*              MOVE '6'           TO PI-MAINT-FUNCTION
  8607*              GO TO 8100-SEND-INITIAL-MAP
  8608*           END-IF
  8609        ELSE
  8610           PERFORM 5100-PROCESS-POL-RESC
  8611                                 THRU 5100-EXIT
  8612           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8613           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8614                                    PI-PREV-SEQ-NO
  8615           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8616*                                    WS-CANCEL-LETTER-SW
  8617                                    PI-ALL-ISSUES-SW
  8618                                    PI-ALL-CANCELS-SW
  8619           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8620        END-IF
  8621     END-IF
  8622     IF EIBAID = DFHPF7
  8623        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8624        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8625        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 158
* VP6311.cbl
  8626        MOVE PI-SV-STATE            TO PI-STATE
  8627        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8628        MOVE BCERTNOI               TO PI-CERT-PRIME
  8629        MOVE BSUFIXI                TO PI-CERT-SFX
  8630        MOVE BEFFDTI                TO DEEDIT-FIELD
  8631        PERFORM 8600-DEEDIT
  8632        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8633        MOVE '4'                    TO DC-OPTION-CODE
  8634        PERFORM 9700-DATE-LINK
  8635        IF DATE-CONVERSION-ERROR
  8636           MOVE ER-0348            TO EMI-ERROR
  8637           MOVE -1                  TO BEFFDTL
  8638           MOVE AL-UABON            TO BEFFDTA
  8639           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8640           GO TO 8200-SEND-DATAONLY
  8641        ELSE
  8642           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8643           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8644           MOVE XCTL-EL1273        TO PGM-NAME
  8645           GO TO 9300-XCTL.
  8646
  8647     IF EIBAID = DFHPF8
  8648        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8649        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8650        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8651        MOVE PI-SV-STATE            TO PI-STATE
  8652        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8653        MOVE BCERTNOI               TO PI-CERT-PRIME
  8654        MOVE BSUFIXI                TO PI-CERT-SFX
  8655        MOVE BEFFDTI                TO DEEDIT-FIELD
  8656        PERFORM 8600-DEEDIT
  8657        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8658        MOVE '4'                    TO DC-OPTION-CODE
  8659        PERFORM 9700-DATE-LINK
  8660        IF DATE-CONVERSION-ERROR
  8661           MOVE ER-0348            TO EMI-ERROR
  8662           MOVE -1                  TO BEFFDTL
  8663           MOVE AL-UABON            TO BEFFDTA
  8664           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8665           GO TO 8200-SEND-DATAONLY
  8666        ELSE
  8667           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8668           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8669           IF PI-COMPANY-ID = 'DMD'
  8670               MOVE XCTL-EL401DMD      TO PGM-NAME
  8671             ELSE
  8672               MOVE XCTL-EL1279        TO PGM-NAME
  8673           END-IF
  8674           GO TO 9300-XCTL.
  8675
  8676     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8677        MOVE XCTL-EL6312         TO PGM-NAME
  8678
  8679* EXEC CICS XCTL
  8680*           PROGRAM   (PGM-NAME)
  8681*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8682*           LENGTH    (WS-COMM-LENGTH)
  8683*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 159
* VP6311.cbl
  8684*    MOVE '.$C                   %   #00008649' TO DFHEIV0
  8685     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8686     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8687     MOVE X'2020233030303038363439' TO DFHEIV0(25:11)
  8688     CALL 'kxdfhei1' USING DFHEIV0,
  8689           PGM-NAME,
  8690           PROGRAM-INTERFACE-BLOCK,
  8691           WS-COMM-LENGTH,
  8692           DFHEIV99
  8693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8694     ELSE
  8695        MOVE '0'                 TO  PI-EDIT-SW.
  8696
  8697     IF  EIBAID = DFHPF10
  8698         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8699         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8700         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8701                                    PI-1042-WA
  8702         MOVE 4                  TO PI-689-DATA-SOURCE
  8703         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8704         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8705         MOVE PI-SV-STATE        TO PI-689-STATE
  8706         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8707         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8708         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8709         MOVE PI-PB-ALT-CHG-SEQ-NO
  8710                                 TO PI-689-ALT-SEQ-NO
  8711         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8712         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8713         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8714         MOVE +0                 TO PI-689-CONTROL
  8715         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8716                                    PI-689-EXP-DATE
  8717                                    PI-689-RESP-PERSON
  8718                                    PI-689-TYPE
  8719                                    PI-689-FOLLOW-UP-EDIT
  8720                                    PI-689-RESEND1-EDIT
  8721                                    PI-689-SEQ-EDIT
  8722                                    PI-689-BCSEQ-EDIT
  8723                                    PI-689-LBL-OVERRIDE
  8724         MOVE W-LETTER-COMMUNICATION-AREAS
  8725                                 TO PI-PROGRAM-WORK-AREA
  8726         MOVE XCTL-EL689         TO PGM-NAME
  8727         GO TO 9300-XCTL.
  8728
  8729     IF  EIBAID = DFHPF16
  8730         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8731         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8732         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8733                                    PI-1042-WA
  8734         MOVE 4                  TO PI-689-DATA-SOURCE
  8735         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8736         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8737         MOVE PI-SV-STATE        TO PI-689-STATE
  8738         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8739         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8740         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8741         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 160
* VP6311.cbl
  8742                                 TO PI-689-ALT-SEQ-NO
  8743         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8744         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8745         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8746         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8747         MOVE W-LETTER-COMMUNICATION-AREAS
  8748                                 TO PI-PROGRAM-WORK-AREA
  8749         MOVE XCTL-EL690         TO PGM-NAME
  8750         GO TO 9300-XCTL.
  8751
  8752     IF EIBAID = DFHPF13
  8753         MOVE XCTL-EL6313        TO PGM-NAME
  8754         GO TO 9300-XCTL.
  8755
  8756     IF EIBAID = DFHPF17
  8757        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8758        IF (PB-I-LOAN-APR numeric)
  8759           and (pb-i-loan-apr < 99.9999)
  8760           AND (PB-I-BENEFICIARY-NAME NOT
  8761              = SPACES AND LOW-VALUES)
  8762
  8763           MOVE LINK-ELVADS          TO PGM-NAME
  8764
  8765* EXEC CICS LINK
  8766*              PROGRAM    (PGM-NAME)
  8767*              COMMAREA   (WS-PASS-AREA)
  8768*              LENGTH     (WS-PASS-AREA-LENGTH)
  8769*          END-EXEC
  8770*    MOVE '."C                   (   #00008724' TO DFHEIV0
  8771     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8772     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8773     MOVE X'2020233030303038373234' TO DFHEIV0(25:11)
  8774     CALL 'kxdfhei1' USING DFHEIV0,
  8775           PGM-NAME,
  8776           WS-PASS-AREA,
  8777           WS-PASS-AREA-LENGTH,
  8778           DFHEIV99,
  8779           DFHEIV99,
  8780           DFHEIV99,
  8781           DFHEIV99
  8782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8783
  8784           MOVE 0000             TO EMI-ERROR
  8785           MOVE -1               TO BMAINTL
  8786           PERFORM 9900-ERROR-FORMAT
  8787                                 THRU 9900-EXIT
  8788           GO TO 8200-SEND-DATAONLY
  8789        ELSE
  8790           MOVE ER-0877            TO EMI-ERROR
  8791           MOVE -1                  TO BEFFDTL
  8792           MOVE AL-UABON            TO BEFFDTA
  8793           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8794           GO TO 8200-SEND-DATAONLY
  8795        END-IF
  8796     END-IF
  8797     IF EIBAID = DFHPF14
  8798        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8799        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 161
* VP6311.cbl
  8800        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8801        MOVE PI-SV-STATE            TO PI-CR-STATE
  8802        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8803        MOVE SPACE                  TO PI-EDIT-SW
  8804        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8805        MOVE XCTL-EL650             TO PGM-NAME
  8806        GO TO 9300-XCTL.
  8807
  8808     IF EIBAID = DFHPF15
  8809        IF PI-COMPANY-ID  =  'HER'
  8810            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8811            MOVE XCTL-EL680         TO PGM-NAME
  8812            GO TO 9300-XCTL.
  8813
  8814     IF EIBAID = DFHENTER OR DFHPF11
  8815        GO TO 1000-ISSUE-MAINLINE.
  8816
  8817     MOVE ER-0029                TO EMI-ERROR
  8818     MOVE -1                     TO BPFENTRL
  8819     MOVE AL-UNBON               TO BPFENTRA
  8820     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8821     GO TO 8200-SEND-DATAONLY.
  8822
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 162
* VP6311.cbl
  8824
  8825******************************************************************
  8826*                                                                *
  8827*      CANCEL SCREEN PF KEY CHECKING                             *
  8828*                                                                *
  8829******************************************************************
  8830
  8831******************************************************************
  8832*                                                                *
  8833*      PF KEY FUNCTIONS:                                         *
  8834*                                                                *
  8835*      PF1  = BROWSE FORWARD                                     *
  8836*      PF2  = BROWSE BACKWARD                                    *
  8837*      PF3  = CERTIFICATE LOOKUP                                 *
  8838*      PF4  = DISPLAY BATCH HEADER                               *
  8839*      PF5  = ADD ISSUE SCREEN                                   *
  8840*      PF6  = ADD CANCEL SCREEN                                  *
  8841*      PF7  = CERTIFICATE DISPLAY                                *
  8842*      PF8  = CERTIFICATE NOTES                                  *
  8843*      PF9  = EDIT CONTROL                                       *
  8844*      PF10 = DISPLAY LETTER SCREEN                              *
  8845*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8846*      PF12 = DISPLAY HELP SCREEN                                *
  8847*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8848*      PF14 = ACCOUNT MASTER                                     *
  8849*      PF16 = LETTER REVIEW                                      *
  8850*                                                                *
  8851******************************************************************
  8852
  8853 0400-CHECK-CANCEL-PF-KEYS.
  8854     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8855        MOVE ER-2337             TO EMI-ERROR
  8856        MOVE -1                  TO CMAINTL
  8857        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8858        GO TO 8200-SEND-DATAONLY.
  8859
  8860     IF EIBAID = DFHPF1
  8861        MOVE '0'                TO PI-EDIT-SW
  8862        IF PI-PRIMARY-BROWSE
  8863           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8864        ELSE
  8865           IF PI-PRIMARY-WITH-SELECT
  8866              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8867           ELSE
  8868              IF PI-FILE-BROWSE
  8869                 GO TO 4300-BROWSE-FILE-FORWARD
  8870              ELSE
  8871                 IF PI-CSR-BROWSE
  8872                    GO TO 4200-BROWSE-CSR-FORWARD
  8873                 ELSE
  8874                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8875
  8876     IF EIBAID = DFHPF2
  8877        MOVE '0'                TO PI-EDIT-SW
  8878        IF PI-PRIMARY-BROWSE
  8879           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8880        ELSE
  8881           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 163
* VP6311.cbl
  8882              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8883           ELSE
  8884              IF PI-FILE-BROWSE
  8885                 GO TO 4800-BROWSE-FILE-BACKWARD
  8886              ELSE
  8887                 IF PI-CSR-BROWSE
  8888                    GO TO 4900-BROWSE-CSR-BACKWARD
  8889                 ELSE
  8890                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8891
  8892     IF EIBAID = DFHPF3
  8893        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8894        MOVE XCTL-EL127         TO PGM-NAME
  8895        GO TO 9300-XCTL.
  8896
  8897     IF (EIBAID = DFHPF15 OR DFHPF17)
  8898        AND (CSR-EDIT-SESSION)
  8899*       AND (FATAL-OR-UNFORCED)
  8900        AND (FATAL-ERRORS)
  8901        MOVE ER-1819             TO EMI-ERROR
  8902        MOVE -1                  TO CMAINTL
  8903        MOVE AL-UANON            TO CMAINTA
  8904        PERFORM 9900-ERROR-FORMAT
  8905                                 THRU 9900-EXIT
  8906        GO TO 8200-SEND-DATAONLY
  8907     END-IF
  8908     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8909       AND (CSR-EDIT-SESSION)
  8910        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8911        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8912        IF (RESP-NORMAL)
  8913           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8914              AM-CONTROL-PRIMARY (1:20))
  8915            IF AM-NAME NOT GREATER THAN SPACES OR
  8916               AM-ADDRS NOT GREATER THAN SPACES  OR
  8917               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8918               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8919               AM-ZIP NOT GREATER THAN SPACES
  8920               MOVE ER-3834             TO EMI-ERROR
  8921               MOVE -1                  TO BMAINTL
  8922               MOVE AL-UANON            TO BMAINTA
  8923               PERFORM 9900-ERROR-FORMAT
  8924                                 THRU 9900-EXIT
  8925               GO TO 8200-SEND-DATAONLY
  8926            END-IF
  8927        ELSE
  8928           MOVE ER-1609             TO EMI-ERROR
  8929           MOVE -1                  TO BMAINTL
  8930           MOVE AL-UANON            TO BMAINTA
  8931           PERFORM 9900-ERROR-FORMAT
  8932                                THRU 9900-EXIT
  8933           GO TO 8200-SEND-DATAONLY
  8934        END-IF
  8935
  8936        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8937        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8938        IF (ERMAIL-FOUND)
  8939            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 164
* VP6311.cbl
  8940               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8941               MA-CITY NOT GREATER THAN SPACES OR
  8942               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8943               MA-ZIP-CODE NOT GREATER THAN SPACES
  8944               MOVE ER-3835             TO EMI-ERROR
  8945               MOVE -1                  TO BMAINTL
  8946               MOVE AL-UANON            TO BMAINTA
  8947               PERFORM 9900-ERROR-FORMAT
  8948                                 THRU 9900-EXIT
  8949               GO TO 8200-SEND-DATAONLY
  8950            END-IF
  8951        ELSE
  8952           MOVE ER-3000             TO EMI-ERROR
  8953           MOVE -1                  TO BMAINTL
  8954           MOVE AL-UANON            TO BMAINTA
  8955           PERFORM 9900-ERROR-FORMAT
  8956                                THRU 9900-EXIT
  8957           GO TO 8200-SEND-DATAONLY
  8958        END-IF
  8959
  8960     END-IF
  8961     IF (EIBAID = DFHPF15 OR DFHPF17)
  8962        AND (CSR-EDIT-SESSION)
  8963        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8964        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8965        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8966        MOVE PI-SV-STATE         TO PI-STATE
  8967        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8968        MOVE CCERTNOI            TO PI-CERT-PRIME
  8969        MOVE CSUFIXI             TO PI-CERT-SFX
  8970        MOVE CEFFDTI             TO DEEDIT-FIELD
  8971        PERFORM 8600-DEEDIT
  8972        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8973        MOVE '4'                 TO DC-OPTION-CODE
  8974        PERFORM 9700-DATE-LINK
  8975        IF DATE-CONVERSION-ERROR
  8976           MOVE ER-0348          TO EMI-ERROR
  8977           MOVE -1               TO CEFFDTL
  8978           MOVE AL-UABON         TO CEFFDTA
  8979           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8980           GO TO 8200-SEND-DATAONLY
  8981        ELSE
  8982           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8983           PERFORM 6000-CREATE-TEMP-STORAGE
  8984                                 THRU 6000-EXIT
  8985           IF EIBAID = DFHPF17
  8986               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8987                                  THRU 6400-EXIT
  8988               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8989                                 '2' AND '3' AND '4'
  8990                  MOVE ER-3831     TO  EMI-ERROR
  8991                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8992                  GO TO 8200-SEND-DATAONLY
  8993               END-IF
  8994               MOVE 'Y'          TO PI-CLM-RESC-IND
  8995           ELSE
  8996               MOVE 'N'          TO PI-CLM-RESC-IND
  8997           END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 165
* VP6311.cbl
  8998           MOVE XCTL-EL6316      TO PGM-NAME
  8999           MOVE '2'              TO PI-ISS-CAN-SW
  9000           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9001           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9002           GO TO 9300-XCTL
  9003        END-IF
  9004     END-IF
  9005
  9006     IF EIBAID = DFHPF4
  9007        MOVE '0'                TO PI-EDIT-SW
  9008        IF PI-DISPLAY-ORIGINAL-BATCH
  9009           NEXT SENTENCE
  9010        ELSE
  9011           GO TO 7200-DISPLAY-BATCHES.
  9012
  9013     IF EIBAID = DFHPF5
  9014        MOVE ER-0029                TO EMI-ERROR
  9015        MOVE -1                     TO BPFENTRL
  9016        MOVE AL-UNBON               TO BPFENTRA
  9017        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9018        GO TO 8200-SEND-DATAONLY.
  9019*        MOVE '0'                TO PI-EDIT-SW
  9020*        IF PI-DISPLAY-ORIGINAL-BATCH
  9021*           NEXT SENTENCE
  9022*        ELSE
  9023*           MOVE VP631B              TO PI-MAP-NAME
  9024*           MOVE LOW-VALUES          TO VP631BI
  9025*           MOVE 'A'                 TO BMAINTO
  9026*           MOVE AL-UANON            TO BMAINTA
  9027*           MOVE -1                  TO BMAINTL
  9028*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9029*           GO TO 8100-SEND-INITIAL-MAP.
  9030
  9031     IF EIBAID = DFHPF6
  9032        MOVE ER-0029                TO EMI-ERROR
  9033        MOVE -1                     TO BPFENTRL
  9034        MOVE AL-UNBON               TO BPFENTRA
  9035        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9036        GO TO 8200-SEND-DATAONLY.
  9037*        MOVE '0'                TO PI-EDIT-SW
  9038*        IF PI-DISPLAY-ORIGINAL-BATCH
  9039*           NEXT SENTENCE
  9040*        ELSE
  9041*           MOVE VP631C              TO PI-MAP-NAME
  9042*           MOVE LOW-VALUES          TO VP631CI
  9043*           MOVE 'A'                 TO CMAINTO
  9044*           MOVE AL-UANON            TO CMAINTA
  9045*           MOVE -1                  TO CMAINTL
  9046*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9047*           GO TO 8100-SEND-INITIAL-MAP.
  9048
  9049     IF EIBAID = DFHPF7
  9050        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9051        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9052        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9053        MOVE PI-SV-STATE            TO PI-STATE
  9054        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9055        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 166
* VP6311.cbl
  9056        MOVE CSUFIXI                TO PI-CERT-SFX
  9057        MOVE CEFFDTI                TO DEEDIT-FIELD
  9058        PERFORM 8600-DEEDIT
  9059        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9060        MOVE '4'                    TO DC-OPTION-CODE
  9061        PERFORM 9700-DATE-LINK
  9062        IF DATE-CONVERSION-ERROR
  9063           MOVE ER-0348            TO EMI-ERROR
  9064           MOVE -1                  TO BEFFDTL
  9065           MOVE AL-UABON            TO BEFFDTA
  9066           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9067           GO TO 8200-SEND-DATAONLY
  9068        ELSE
  9069           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9070           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9071           MOVE XCTL-EL1273        TO PGM-NAME
  9072           GO TO 9300-XCTL.
  9073
  9074     IF EIBAID = DFHPF8
  9075        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9076        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9077        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9078        MOVE PI-SV-STATE            TO PI-STATE
  9079        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9080        MOVE CCERTNOI               TO PI-CERT-PRIME
  9081        MOVE CSUFIXI                TO PI-CERT-SFX
  9082        MOVE CEFFDTI                TO DEEDIT-FIELD
  9083        PERFORM 8600-DEEDIT
  9084        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9085        MOVE '4'                    TO DC-OPTION-CODE
  9086        PERFORM 9700-DATE-LINK
  9087        IF DATE-CONVERSION-ERROR
  9088           MOVE ER-0348             TO EMI-ERROR
  9089           MOVE -1                  TO BEFFDTL
  9090           MOVE AL-UABON            TO BEFFDTA
  9091           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9092           GO TO 8200-SEND-DATAONLY
  9093        ELSE
  9094           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9095           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9096           IF PI-COMPANY-ID = 'DMD'
  9097               MOVE XCTL-EL401DMD      TO PGM-NAME
  9098             ELSE
  9099               MOVE XCTL-EL1279        TO PGM-NAME
  9100           END-IF
  9101           GO TO 9300-XCTL.
  9102
  9103     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9104        MOVE XCTL-EL6312     TO PGM-NAME
  9105
  9106* EXEC CICS XCTL
  9107*           PROGRAM  (PGM-NAME)
  9108*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9109*           LENGTH   (WS-COMM-LENGTH)
  9110*       END-EXEC
  9111*    MOVE '.$C                   %   #00009051' TO DFHEIV0
  9112     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9113     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 167
* VP6311.cbl
  9114     MOVE X'2020233030303039303531' TO DFHEIV0(25:11)
  9115     CALL 'kxdfhei1' USING DFHEIV0,
  9116           PGM-NAME,
  9117           PROGRAM-INTERFACE-BLOCK,
  9118           WS-COMM-LENGTH,
  9119           DFHEIV99
  9120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9121     ELSE
  9122        MOVE '0'                 TO  PI-EDIT-SW.
  9123
  9124     IF EIBAID = DFHPF10
  9125         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9126         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9127         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9128         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9129                                    PI-1042-WA
  9130         MOVE 4                  TO PI-689-DATA-SOURCE
  9131         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9132         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9133         MOVE PI-SV-STATE        TO PI-689-STATE
  9134         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9135         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9136         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9137         MOVE PI-PB-ALT-CHG-SEQ-NO
  9138                                 TO PI-689-ALT-SEQ-NO
  9139         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9140         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9141         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9142         MOVE +0                 TO PI-689-CONTROL
  9143         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9144                                    PI-689-EXP-DATE
  9145                                    PI-689-RESP-PERSON
  9146                                    PI-689-TYPE
  9147                                    PI-689-FOLLOW-UP-EDIT
  9148                                    PI-689-RESEND1-EDIT
  9149                                    PI-689-SEQ-EDIT
  9150                                    PI-689-BCSEQ-EDIT
  9151                                    PI-689-LBL-OVERRIDE
  9152         MOVE W-LETTER-COMMUNICATION-AREAS
  9153                                 TO PI-PROGRAM-WORK-AREA
  9154         MOVE XCTL-EL689         TO PGM-NAME
  9155         GO TO 9300-XCTL.
  9156
  9157     IF  EIBAID = DFHPF16
  9158         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9159         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9160         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9161                                    PI-1042-WA
  9162         MOVE 4                  TO PI-689-DATA-SOURCE
  9163         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9164         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9165         MOVE PI-SV-STATE        TO PI-689-STATE
  9166         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9167         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9168         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9169         MOVE PI-PB-ALT-CHG-SEQ-NO
  9170                                 TO PI-689-ALT-SEQ-NO
  9171         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 168
* VP6311.cbl
  9172         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9173         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9174         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9175         MOVE W-LETTER-COMMUNICATION-AREAS
  9176                                 TO PI-PROGRAM-WORK-AREA
  9177         MOVE XCTL-EL690         TO PGM-NAME
  9178         GO TO 9300-XCTL.
  9179     IF (EIBAID = DFHPF13)
  9180        if (not fatal-errors)
  9181           and (not unforced-errors)
  9182           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9183           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9184           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9185           MOVE PI-SV-STATE      TO PI-STATE
  9186           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9187           MOVE CCERTNOI         TO PI-CERT-PRIME
  9188           MOVE CSUFIXI          TO PI-CERT-SFX
  9189           MOVE CEFFDTI          TO DEEDIT-FIELD
  9190           PERFORM 8600-DEEDIT
  9191           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9192           MOVE '4'              TO DC-OPTION-CODE
  9193           PERFORM 9700-DATE-LINK
  9194           IF DATE-CONVERSION-ERROR
  9195              MOVE ER-0348       TO EMI-ERROR
  9196              MOVE -1            TO CEFFDTL
  9197              MOVE AL-UABON      TO CEFFDTA
  9198              PERFORM 9900-ERROR-FORMAT
  9199                                 THRU 9900-EXIT
  9200              GO TO 8200-SEND-DATAONLY
  9201           ELSE
  9202              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9203              MOVE AL-UANON      TO CEFFDTA
  9204              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9205              PERFORM 6000-CREATE-TEMP-STORAGE
  9206                                 THRU 6000-EXIT
  9207              MOVE XCTL-EL677    TO PGM-NAME
  9208              GO TO 9300-XCTL
  9209           end-if
  9210        else
  9211           MOVE ER-3444          TO EMI-ERROR
  9212           MOVE -1               TO CPFENTRL
  9213           MOVE AL-UNBON         TO CPFENTRA
  9214           PERFORM 9900-ERROR-FORMAT
  9215                                 THRU 9900-EXIT
  9216           GO TO 8200-SEND-DATAONLY
  9217        end-if
  9218     end-if
  9219
  9220     IF EIBAID = DFHPF14
  9221        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9222        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9223        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9224        MOVE PI-SV-STATE            TO PI-CR-STATE
  9225        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9226        MOVE SPACE                  TO PI-EDIT-SW
  9227        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9228        MOVE XCTL-EL650             TO PGM-NAME
  9229        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 169
* VP6311.cbl
  9230
  9231     IF EIBAID = DFHENTER OR DFHPF11
  9232        GO TO 2000-CANCEL-MAINLINE.
  9233
  9234     MOVE ER-0029                TO EMI-ERROR.
  9235     MOVE -1                     TO CPFENTRL.
  9236     MOVE AL-UNBON               TO CPFENTRA.
  9237     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9238     GO TO 8200-SEND-DATAONLY.
  9239
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 170
* VP6311.cbl
  9241
  9242******************************************************************
  9243*                                                                *
  9244*      BATCH SCREEN PF KEY CHECKING                              *
  9245*                                                                *
  9246******************************************************************
  9247
  9248******************************************************************
  9249*                                                                *
  9250*      PF KEY FUNCTIONS:                                         *
  9251*                                                                *
  9252*      PF1 = BROWSE FORWARD                                      *
  9253*      PF2 = BROWSE BACKWARD                                     *
  9254*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9255*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9256*                                                                *
  9257*                                                                *
  9258******************************************************************
  9259
  9260 0500-CHECK-BATCH-PF-KEYS.
  9261     IF EIBAID = DFHPF1
  9262        MOVE '0'                TO PI-EDIT-SW
  9263        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9264           GO TO 5000-BROWSE-BATCH-HEADERS
  9265        ELSE
  9266           IF PI-GOOD-BROWSE
  9267              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9268                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9269              ELSE
  9270                 IF PI-FILE-BROWSE
  9271                    GO TO 4300-BROWSE-FILE-FORWARD
  9272                 ELSE
  9273                    IF PI-CSR-BROWSE
  9274                       GO TO 4200-BROWSE-CSR-FORWARD
  9275                    ELSE
  9276                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9277           ELSE
  9278              GO TO 0800-BROWSE-ERROR.
  9279
  9280     IF EIBAID = DFHPF2
  9281        MOVE '0'                TO PI-EDIT-SW
  9282        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9283           GO TO 5500-BROWSE-BATCH-BACKWARD
  9284        ELSE
  9285           IF PI-GOOD-BROWSE
  9286              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9287                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9288              ELSE
  9289                 IF PI-FILE-BROWSE
  9290                    GO TO 4800-BROWSE-FILE-BACKWARD
  9291                 ELSE
  9292                    IF PI-CSR-BROWSE
  9293                       GO TO 4900-BROWSE-CSR-BACKWARD
  9294                    ELSE
  9295                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9296           ELSE
  9297              GO TO 0800-BROWSE-ERROR.
  9298
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 171
* VP6311.cbl
  9299     IF EIBAID = DFHPF3
  9300        GO TO 3000-BATCH-MAINLINE.
  9301
  9302     IF  EIBAID = DFHPF4
  9303        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9304        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9305        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9306        MOVE PI-SV-STATE            TO PI-CR-STATE
  9307        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9308                                       PI-CR-FIN-RESP
  9309        MOVE 'A'                    TO PI-CR-TYPE
  9310        MOVE SPACE                  TO PI-EDIT-SW
  9311        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9312        MOVE XCTL-EL640             TO PGM-NAME
  9313        GO TO 9300-XCTL.
  9314
  9315     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9316       AND
  9317        (EIBAID = DFHENTER)
  9318           GO TO 3500-EDIT-BATCH-DATA.
  9319
  9320     IF EIBAID = DFHENTER
  9321        GO TO 3500-EDIT-BATCH-DATA.
  9322
  9323     MOVE ER-0029             TO EMI-ERROR.
  9324     MOVE -1                  TO DPFENTRL.
  9325     MOVE AL-UNBON            TO DPFENTRA.
  9326     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9327     GO TO 8200-SEND-DATAONLY.
  9328
  9329 0800-BROWSE-ERROR.
  9330     MOVE ER-2258                TO EMI-ERROR.
  9331     MOVE -1                     TO DPFENTRL.
  9332     MOVE AL-UNBON               TO DPFENTRA.
  9333     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9334     GO TO 8200-SEND-DATAONLY.
  9335
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 172
* VP6311.cbl
  9337
  9338******************************************************************
  9339*                                                                *
  9340*                I S S U E   M A I N L I N E                     *
  9341*                                                                *
  9342******************************************************************
  9343
  9344 1000-ISSUE-MAINLINE.
  9345     IF PI-DISPLAY-ORIGINAL-BATCH
  9346        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9347           MOVE ER-0023             TO EMI-ERROR
  9348           MOVE -1                  TO BMAINTL
  9349           MOVE AL-UABON            TO BMAINTA
  9350           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9351           GO TO 8200-SEND-DATAONLY
  9352        ELSE
  9353           NEXT SENTENCE
  9354     ELSE
  9355        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9356           MOVE ER-0023             TO EMI-ERROR
  9357           MOVE -1                  TO BMAINTL
  9358           MOVE AL-UABON            TO BMAINTA
  9359           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9360           GO TO 8200-SEND-DATAONLY.
  9361
  9362     IF BMAINTI = 'S'
  9363        GO TO 1100-SHOW-REQUEST.
  9364
  9365     IF NOT MODIFY-CAP
  9366         MOVE 'UPDATE'       TO SM-READ
  9367         PERFORM 9995-SECURITY-VIOLATION
  9368         MOVE ER-0070        TO EMI-ERROR
  9369         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9370         GO TO 8100-SEND-INITIAL-MAP.
  9371
  9372     IF BMAINTL GREATER THAN ZEROS
  9373        IF PI-PF5-FUNCTION
  9374           IF BMAINTI NOT = 'A'
  9375              MOVE AL-UABON  TO BMAINTA
  9376              MOVE -1        TO BMAINTL
  9377              MOVE ER-2260   TO EMI-ERROR
  9378              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9379              GO TO 8200-SEND-DATAONLY.
  9380
  9381     IF BCERTNOL = ZEROS
  9382       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9383         NEXT SENTENCE
  9384     ELSE
  9385         IF BCERTNOL NOT = ZEROS
  9386             MOVE AL-UANON       TO BCERTNOA
  9387         ELSE
  9388             MOVE -1             TO BCERTNOL
  9389             MOVE  1             TO SET-CURSOR-SW
  9390             MOVE ER-2218        TO EMI-ERROR
  9391             MOVE AL-UABON       TO BCERTNOA
  9392             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9393
  9394     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 173
* VP6311.cbl
  9395         MOVE AL-UANON       TO BSUFIXA
  9396     ELSE
  9397         MOVE AL-SANOF       TO BSUFIXA.
  9398
  9399     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9400        NEXT SENTENCE
  9401     ELSE
  9402        IF BEFFDTL NOT = ZEROS
  9403           MOVE AL-UNNON             TO BEFFDTA
  9404           MOVE BEFFDTI              TO DEEDIT-FIELD
  9405           PERFORM 8600-DEEDIT
  9406           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9407           MOVE 4                    TO DC-OPTION-CODE
  9408           PERFORM 9700-DATE-LINK
  9409           IF NO-CONVERSION-ERROR
  9410              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9411              ELSE
  9412              MOVE -1                TO BEFFDTL
  9413              MOVE  1                TO SET-CURSOR-SW
  9414              MOVE ER-2226           TO EMI-ERROR
  9415              MOVE AL-UNBON          TO BEFFDTA
  9416              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9417           ELSE
  9418              MOVE -1                TO BEFFDTL
  9419              MOVE  1                TO SET-CURSOR-SW
  9420              MOVE ER-2220           TO EMI-ERROR
  9421              MOVE AL-UNBON          TO BEFFDTA
  9422              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9423
  9424     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9425
  9426     IF BCERTNOL NOT = ZEROS
  9427        MOVE BCERTNOI                TO WS-NEW-PRIME
  9428     ELSE
  9429        MOVE SPACES                  TO WS-NEW-PRIME.
  9430
  9431     IF BSUFIXL NOT = ZEROS
  9432        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9433     ELSE
  9434        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9435
  9436     IF BEFFDTL NOT = ZEROS
  9437        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9438     ELSE
  9439        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9440
  9441     IF BMAINTI = 'A' OR 'K' OR 'S'
  9442        NEXT SENTENCE
  9443     ELSE
  9444        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9445        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9446           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9447           WS-PB-RECORD-TYPE NOT = '1'
  9448           IF BMAINTI = 'C'
  9449               MOVE ER-2287          TO EMI-ERROR
  9450               MOVE -1               TO BCERTNOL
  9451               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9452               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 174
* VP6311.cbl
  9453               GO TO 8200-SEND-DATAONLY
  9454             ELSE
  9455               MOVE ER-2260          TO EMI-ERROR
  9456               MOVE -1               TO BCERTNOL
  9457               MOVE AL-UABON         TO BCERTNOA
  9458               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9459               GO TO 8200-SEND-DATAONLY.
  9460
  9461     IF BMAINTI = 'D'
  9462         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9463
  9464*    IF BMICRNOL  NOT =  ZEROS
  9465*        IF BMICRNOI  NUMERIC
  9466*            MOVE AL-UNNON       TO  BMICRNOA
  9467*        ELSE
  9468*            MOVE -1             TO  BMICRNOL
  9469*            MOVE 1              TO  SET-CURSOR-SW
  9470*            MOVE AL-UNBON       TO  BMICRNOA
  9471*            MOVE ER-2701        TO  EMI-ERROR
  9472*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9473     IF BVINL NOT = ZEROS
  9474        MOVE AL-UANON            TO BVINA
  9475     END-IF
  9476     IF B1STNML NOT = ZEROS
  9477         MOVE AL-UANON                TO B1STNMA.
  9478
  9479     IF BINITL  NOT = ZEROS
  9480        MOVE AL-UANON                TO BINITA.
  9481
  9482     IF BSEXL NOT = ZEROS
  9483        IF BSEXI = 'M' OR 'F'
  9484           MOVE AL-UANON             TO BSEXA
  9485        ELSE
  9486           MOVE -1               TO BSEXL
  9487           MOVE ER-2629          TO EMI-ERROR
  9488           MOVE AL-UABON         TO BSEXA
  9489           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9490
  9491     IF BAGEL NOT = ZEROS
  9492         IF BAGEI NUMERIC
  9493             MOVE BAGEI              TO WS-BAGE
  9494             MOVE AL-UNNON           TO BAGEA
  9495         ELSE
  9496             MOVE -1                 TO BAGEL
  9497             MOVE  1                 TO SET-CURSOR-SW
  9498             MOVE ER-2223            TO EMI-ERROR
  9499             MOVE AL-UNBON           TO BAGEA
  9500             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9501
  9502     IF BLSTNML NOT = ZERO  OR
  9503        B1STNML NOT = ZERO  OR
  9504        BINITL NOT = ZERO
  9505         IF BAGEL = ZEROS
  9506             MOVE -1                 TO BAGEL
  9507             MOVE  1                 TO SET-CURSOR-SW
  9508             MOVE ER-3269            TO EMI-ERROR
  9509             MOVE AL-UNBON           TO BAGEA
  9510             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 175
* VP6311.cbl
  9511         END-IF
  9512     END-IF.
  9513
  9514     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9515
  9516     IF (BBIRTHL GREATER THAN +0) AND
  9517        (BBIRTHI NOT EQUAL SPACES)
  9518        NEXT SENTENCE
  9519     ELSE
  9520        GO TO 1010-CHECK-AGE.
  9521
  9522     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9523     PERFORM 8600-DEEDIT.
  9524     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9525     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9526     MOVE AL-UNNON               TO BBIRTHA.
  9527     MOVE '4'                    TO DC-OPTION-CODE.
  9528     PERFORM 9700-DATE-LINK.
  9529     IF DATE-CONVERSION-ERROR
  9530        MOVE -1                  TO BBIRTHL
  9531        MOVE  1                  TO SET-CURSOR-SW
  9532        MOVE ER-2228             TO EMI-ERROR
  9533        MOVE AL-UNBON            TO BBIRTHA
  9534        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9535        GO TO 1010-CHECK-AGE.
  9536
  9537     IF (NO-CONVERSION-ERROR) AND
  9538        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9539        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9540        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9541        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9542                                    WS-CONVERTED-BIRTH
  9543        MOVE AL-UANON            TO BBIRTHA
  9544     ELSE
  9545        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9546        MOVE AL-UANON            TO BBIRTHA.
  9547
  9548 1010-CHECK-AGE.
  9549
  9550*    IF BAGEL = ZERO
  9551*       IF BBIRTHL GREATER THAN ZERO
  9552*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9553
  9554
  9555
  9556
  9557**   IF PI-COMPANY-ID = 'DMD'
  9558     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9559        NEXT SENTENCE
  9560     ELSE
  9561         IF BLNOFCRL NOT = ZEROS
  9562            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9563            IF LOAN-OFFICER-FOUND
  9564                MOVE AL-UANON        TO BLNOFCRA
  9565             ELSE
  9566                 MOVE SPACE          TO WS-LOAN-OFFICER
  9567                 MOVE -1             TO BLNOFCRL
  9568                 MOVE  1             TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 176
* VP6311.cbl
  9569                 MOVE ER-3006        TO EMI-ERROR
  9570                 MOVE AL-UNBON       TO BLNOFCRA
  9571                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9572
  9573 1010-EDIT-CONT.
  9574
  9575     IF BFORCEL  NOT = ZEROS
  9576         IF FORCE-CAP
  9577            MOVE AL-UANON            TO BFORCEA
  9578         ELSE
  9579            MOVE ER-2945             TO EMI-ERROR
  9580            MOVE AL-UABON            TO BFORCEA
  9581            MOVE -1                  TO BFORCEL
  9582            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9583
  9584     IF BENTRYL NOT = ZEROS
  9585        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9586                 'C' and 'D' AND 'V' AND 'U' AND 'M'
  9587           MOVE ER-2224              TO EMI-ERROR
  9588           MOVE AL-UABON             TO BENTRYA
  9589           MOVE -1                   TO BENTRYL
  9590           MOVE  1                   TO SET-CURSOR-SW
  9591           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9592        ELSE
  9593           MOVE AL-UANON             TO BENTRYA.
  9594
  9595     IF BUNWRITL NOT = ZEROS
  9596        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9597           MOVE ER-7574              TO EMI-ERROR
  9598           MOVE AL-UABON             TO BUNWRITA
  9599           MOVE -1                   TO BUNWRITL
  9600           MOVE  1                   TO SET-CURSOR-SW
  9601           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9602        ELSE
  9603           MOVE AL-UANON             TO BUNWRITA.
  9604
  9605     IF BREINL  NOT = ZEROS
  9606         MOVE AL-UANON               TO BREINA.
  9607
  9608     IF BBILCDL NOT = ZEROS
  9609        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9610                             AND 'A' AND 'B' AND 'E'
  9611           MOVE ER-2225              TO EMI-ERROR
  9612           MOVE AL-UABON             TO BBILCDA
  9613           MOVE -1                   TO BBILCDL
  9614           MOVE  1                   TO SET-CURSOR-SW
  9615           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9616        ELSE
  9617           MOVE AL-UANON             TO BBILCDA.
  9618
  9619     IF BSKPCDL NOT = ZEROS
  9620         MOVE AL-UANON               TO BSKPCDA.
  9621
  9622     IF BINDGRPL NOT = ZEROS
  9623         MOVE AL-UANON               TO BINDGRPA.
  9624
  9625     IF BSIGL   NOT = ZEROS
  9626         MOVE AL-UANON               TO BSIGA.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 177
* VP6311.cbl
  9627
  9628     IF BRTCLSL NOT = ZEROS
  9629         MOVE AL-UANON               TO BRTCLSA.
  9630
  9631     IF BMEMBERL NOT = ZEROS
  9632         MOVE AL-UANON               TO BMEMBERA.
  9633
  9634     MOVE +0                         TO WS-SUB1.
  9635
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 178
* VP6311.cbl
  9637
  9638******************************************************************
  9639*                                                                *
  9640*           E D I T   I S S U E   C O V E R A G E S              *
  9641*                                                                *
  9642******************************************************************
  9643
  9644 1020-EDIT-COVERAGES.
  9645     ADD +1                      TO WS-SUB1.
  9646
  9647     IF WS-SUB1 GREATER +2
  9648        GO TO 1025-EDIT-CONTINUE
  9649     END-IF
  9650
  9651
  9652     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9653        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9654        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9655        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9656        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9657        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9658        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9659        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9660        NEXT SENTENCE
  9661         ELSE
  9662            GO TO 1020-EDIT-COVERAGES.
  9663
  9664 1021-CONT-EDIT.
  9665
  9666     IF BMAINTI = 'A'
  9667        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9668           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9669        ELSE
  9670           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9671           MOVE ER-7404          TO EMI-ERROR
  9672           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9673           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9674     ELSE
  9675        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9676           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9677
  9678     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9679        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9680        PERFORM 8600-DEEDIT
  9681        IF DEEDIT-FIELD-V0 NUMERIC
  9682           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9683        ELSE
  9684           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9685
  9686
  9687     IF BMAINTI = ('C' OR 'K')
  9688        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9689           NEXT SENTENCE
  9690        ELSE
  9691           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9692           PERFORM 8600-DEEDIT
  9693           IF DEEDIT-FIELD-V0 NUMERIC
  9694              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 179
* VP6311.cbl
  9695              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9696                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9697              ELSE
  9698                    MOVE ER-2241      TO EMI-ERROR
  9699                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9700                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9701                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9702           ELSE
  9703              MOVE ER-2223          TO EMI-ERROR
  9704              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9705              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9706              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9707     ELSE
  9708        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9709            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9710            PERFORM 8600-DEEDIT
  9711            IF DEEDIT-FIELD-V0      NUMERIC
  9712               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9713                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9714                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9715               ELSE
  9716                  MOVE ER-2241         TO EMI-ERROR
  9717                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9718                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9719                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9720            ELSE
  9721              MOVE ER-2223             TO EMI-ERROR
  9722              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9723              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9724              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9725        ELSE
  9726            MOVE ER-2240               TO EMI-ERROR
  9727            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9728            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9729
  9730     IF BBEN-LEN (WS-SUB1) = ZEROS
  9731        AND BMAINTI = ('C' OR 'K')
  9732           NEXT SENTENCE
  9733     ELSE
  9734        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9735           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9736
  9737* EXEC CICS BIF DEEDIT
  9738*              FIELD  (BBENI (WS-SUB1))
  9739*              LENGTH (12)
  9740*          END-EXEC
  9741     MOVE 12
  9742       TO DFHEIV11
  9743*    MOVE '@"L                   #   #00009671' TO DFHEIV0
  9744     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9745     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9746     MOVE X'2020233030303039363731' TO DFHEIV0(25:11)
  9747     CALL 'kxdfhei1' USING DFHEIV0,
  9748           BBENI(WS-SUB1),
  9749           DFHEIV11
  9750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9751           IF BBENI (WS-SUB1)  NUMERIC
  9752              IF BBENI (WS-SUB1) GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 180
* VP6311.cbl
  9753                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9754*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9755*          PERFORM 8600-DEEDIT
  9756*          IF DEEDIT-FIELD-V2  NUMERIC
  9757*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9758*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9759              ELSE
  9760                 MOVE ER-7632    TO EMI-ERROR
  9761                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9762                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9763                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9764           ELSE
  9765              MOVE ER-2223         TO EMI-ERROR
  9766              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9767              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9768              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9769        ELSE
  9770           MOVE ER-7632    TO EMI-ERROR
  9771           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9772           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9773           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9774
  9775     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9776        AND (BMAINTI = ('C' OR 'K'))
  9777        CONTINUE
  9778     ELSE
  9779        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9780           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9781           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9782              FOR ALL '.'
  9783           IF WS-TALLY > 1
  9784              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9785                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9786              END-PERFORM
  9787              IF A1 < 9
  9788                 ADD 3 TO A1
  9789                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9790              END-IF
  9791           ELSE
  9792              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9793                (A1 > 11)
  9794                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9795                  LOW-VALUES OR SPACES)
  9796              END-PERFORM
  9797              IF A1 > 1 AND < 12
  9798                 MOVE SPACES
  9799                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9800              END-IF
  9801           END-IF
  9802
  9803* EXEC CICS BIF DEEDIT
  9804*              FIELD  (BPREMI (WS-SUB1))
  9805*              LENGTH (11)
  9806*          END-EXEC
  9807     MOVE 11
  9808       TO DFHEIV11
  9809*    MOVE '@"L                   #   #00009726' TO DFHEIV0
  9810     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 181
* VP6311.cbl
  9811     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9812     MOVE X'2020233030303039373236' TO DFHEIV0(25:11)
  9813     CALL 'kxdfhei1' USING DFHEIV0,
  9814           BPREMI(WS-SUB1),
  9815           DFHEIV11
  9816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9817           IF BPREMI (WS-SUB1) NUMERIC
  9818              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9819                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9820*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9821*          PERFORM 8600-DEEDIT
  9822*          IF DEEDIT-FIELD-V2  NUMERIC
  9823*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9824*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9825              ELSE
  9826                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
  9827                    MOVE ER-7633    TO EMI-ERROR
  9828                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9829                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9830                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9831                 END-IF
  9832              END-IF
  9833           ELSE
  9834              MOVE ER-2223         TO EMI-ERROR
  9835              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9836              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9837              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9838           END-IF
  9839        ELSE
  9840           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
  9841              MOVE ER-7633         TO EMI-ERROR
  9842              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9843              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9844              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9845           END-IF
  9846        END-IF
  9847     END-IF
  9848
  9849     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  9850        NEXT SENTENCE
  9851     ELSE
  9852        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  9853
  9854* EXEC CICS BIF DEEDIT
  9855*           FIELD  (BCPREMI (WS-SUB1))
  9856*           LENGTH (11)
  9857*       END-EXEC
  9858     MOVE 11
  9859       TO DFHEIV11
  9860*    MOVE '@"L                   #   #00009766' TO DFHEIV0
  9861     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9862     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9863     MOVE X'2020233030303039373636' TO DFHEIV0(25:11)
  9864     CALL 'kxdfhei1' USING DFHEIV0,
  9865           BCPREMI(WS-SUB1),
  9866           DFHEIV11
  9867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9868        IF BCPREMI (WS-SUB1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 182
* VP6311.cbl
  9869           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
  9870*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
  9871*       PERFORM 8600-DEEDIT
  9872*       IF DEEDIT-FIELD-V2  NUMERIC
  9873*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
  9874        ELSE
  9875           MOVE ER-2223         TO EMI-ERROR
  9876           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
  9877           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
  9878           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9879
  9880     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9881        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
  9882        PERFORM 8600-DEEDIT
  9883        IF DEEDIT-FIELD-V0 NUMERIC
  9884           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
  9885           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9886         ELSE
  9887           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
  9888           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9889           MOVE ER-2223              TO EMI-ERROR
  9890           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9891
  9892     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9893        IF BEXPIRE   (WS-SUB1) = SPACES
  9894           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
  9895        ELSE
  9896           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
  9897           PERFORM 8600-DEEDIT
  9898           IF DEEDIT-FIELD-V0        NUMERIC
  9899              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
  9900              MOVE 4                TO DC-OPTION-CODE
  9901              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9902              PERFORM 9700-DATE-LINK
  9903              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
  9904                                                        (WS-SUB1)
  9905              IF NO-CONVERSION-ERROR
  9906                 NEXT SENTENCE
  9907              ELSE
  9908                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
  9909                 MOVE ER-2531    TO EMI-ERROR
  9910                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
  9911                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9912           ELSE
  9913             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
  9914             MOVE ER-2532        TO EMI-ERROR
  9915             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
  9916             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9917
  9918     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
  9919        NEXT SENTENCE
  9920     ELSE
  9921
  9922* EXEC CICS BIF DEEDIT
  9923*           FIELD  (BALT-BENI (WS-SUB1))
  9924*           LENGTH (12)
  9925*       END-EXEC
  9926     MOVE 12
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 183
* VP6311.cbl
  9927       TO DFHEIV11
  9928*    MOVE '@"L                   #   #00009823' TO DFHEIV0
  9929     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9930     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9931     MOVE X'2020233030303039383233' TO DFHEIV0(25:11)
  9932     CALL 'kxdfhei1' USING DFHEIV0,
  9933           BALT-BENI(WS-SUB1),
  9934           DFHEIV11
  9935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9936        IF BALT-BENI (WS-SUB1) NUMERIC
  9937           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
  9938*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
  9939*       PERFORM 8600-DEEDIT
  9940*       IF DEEDIT-FIELD-V0 NUMERIC
  9941*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
  9942        ELSE
  9943           MOVE ER-2223         TO EMI-ERROR
  9944           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
  9945           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
  9946           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9947
  9948     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
  9949        NEXT SENTENCE
  9950     ELSE
  9951
  9952* EXEC CICS BIF DEEDIT
  9953*           FIELD  (BALT-PREMI (WS-SUB1))
  9954*           LENGTH (11)
  9955*       END-EXEC
  9956     MOVE 11
  9957       TO DFHEIV11
  9958*    MOVE '@"L                   #   #00009842' TO DFHEIV0
  9959     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9960     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9961     MOVE X'2020233030303039383432' TO DFHEIV0(25:11)
  9962     CALL 'kxdfhei1' USING DFHEIV0,
  9963           BALT-PREMI(WS-SUB1),
  9964           DFHEIV11
  9965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9966        IF BALT-PREMI (WS-SUB1) NUMERIC
  9967           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
  9968*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
  9969*       PERFORM 8600-DEEDIT
  9970*       IF DEEDIT-FIELD-V0 NUMERIC
  9971*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
  9972        ELSE
  9973           MOVE ER-2223         TO EMI-ERROR
  9974           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
  9975           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
  9976           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9977
  9978      GO TO 1020-EDIT-COVERAGES.
  9979     .
  9980 1025-edit-continue.
  9981     IF PI-COMPANY-ID  =  'DMD'
  9982        MOVE LOW-VALUES             TO BNCERTI
  9983                                       BNSTATI.
  9984
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 184
* VP6311.cbl
  9985     IF EMI-ERROR = ZEROS
  9986         NEXT SENTENCE
  9987     ELSE
  9988         GO TO 8200-SEND-DATAONLY.
  9989
  9990     IF BMAINTI = 'A'
  9991         GO TO 1200-ADD-ISSUE-ROUTINE.
  9992
  9993     IF BMAINTI = 'C'
  9994         GO TO 1300-CHANGE-ISSUE-ROUTINE.
  9995
  9996     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
  9997
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 185
* VP6311.cbl
  9999
 10000 1030-EDIT-FOR-NUMERICS.
 10001     IF WS-CSO-SUB EQUAL 10
 10002        GO TO 1030-EDIT-EXIT.
 10003
 10004     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10005        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10006        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10007           ADD +1               TO WS-CSO-SUB
 10008           GO TO 1030-EDIT-FOR-NUMERICS.
 10009
 10010     MOVE 'N'                   TO WS-NUMERIC-SW.
 10011
 10012 1030-EDIT-EXIT.
 10013******************************************************************
 10014*                                                                *
 10015*                 C A L C U L A T E   A G E                      *
 10016*                                                                *
 10017******************************************************************
 10018
 10019
 10020 1095-CALC-AGE.
 10021
 10022     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10023     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10024     MOVE 1                  TO DC-OPTION-CODE.
 10025     PERFORM 9700-DATE-LINK
 10026     IF NO-CONVERSION-ERROR
 10027         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10028         MOVE WS-BAGE            TO BAGEI
 10029         MOVE +2                 TO BAGEL
 10030         MOVE AL-UNNON TO BAGEA.
 10031
 10032 1099-EXIT.
 10033     EXIT.
 10034
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 186
* VP6311.cbl
 10036
 10037******************************************************************
 10038*                                                                *
 10039*                   S H O W   I S S U E                          *
 10040*                                                                *
 10041******************************************************************
 10042
 10043 1100-SHOW-REQUEST.
 10044     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10045
 10046     IF BCERTNOL = ZEROS AND
 10047        BEFFDTL  = ZEROS
 10048        MOVE -1                  TO BMAINTL
 10049        GO TO 8200-SEND-DATAONLY.
 10050
 10051     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10052
 10053     IF BSUFIXL NOT = ZEROS
 10054        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10055     ELSE
 10056        MOVE SPACE               TO WS-NEW-SUFFIX.
 10057
 10058     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10059     PERFORM 8600-DEEDIT.
 10060     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10061     MOVE '4'                    TO DC-OPTION-CODE.
 10062     PERFORM 9700-DATE-LINK.
 10063     IF DATE-CONVERSION-ERROR
 10064        MOVE ER-0348             TO EMI-ERROR
 10065        MOVE -1                  TO BEFFDTL
 10066        MOVE AL-UABON            TO BEFFDTA
 10067        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10068        GO TO 8200-SEND-DATAONLY
 10069     ELSE
 10070        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10071        MOVE AL-UANON            TO BEFFDTA
 10072        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10073
 10074     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10075
 10076     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10077        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10078          MOVE 'Y'                    TO WS-SHOW-SW
 10079          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10080             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10081           ELSE
 10082             IF PI-FILE-BROWSE
 10083                GO TO 4300-BROWSE-FILE-FORWARD
 10084              ELSE
 10085                IF PI-CSR-BROWSE
 10086                   GO TO 4200-BROWSE-CSR-FORWARD
 10087                ELSE
 10088                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10089        ELSE
 10090           GO TO 3900-RE-DISPLAY-RECORD.
 10091
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 187
* VP6311.cbl
 10093
 10094******************************************************************
 10095*                                                                *
 10096*            A D D   I S S U E   R O U T I N E                   *
 10097*                                                                *
 10098******************************************************************
 10099
 10100***************************************************************
 10101*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10102*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10103*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10104*     4. LINK TO THE EDIT ROUTINE.                            *
 10105*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10106*     6. WRITE THE NEW ISSUE RECORD.                          *
 10107*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10108*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10109*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10110*        ELSE                                                 *
 10111*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10112***************************************************************
 10113
 10114 1200-ADD-ISSUE-ROUTINE.
 10115     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10116
 10117
 10118* EXEC CICS GETMAIN
 10119*        SET     (ADDRESS OF PENDING-BUSINESS)
 10120*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10121*    END-EXEC.
 10122*    MOVE '," L                  $   #00009997' TO DFHEIV0
 10123     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10124     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10125     MOVE X'2020233030303039393937' TO DFHEIV0(25:11)
 10126     CALL 'kxdfhei1' USING DFHEIV0,
 10127           DFHEIV20,
 10128           ERPNDB-RECORD-LENGTH,
 10129           DFHEIV99
 10130     SET ADDRESS OF PENDING-BUSINESS TO
 10131         DFHEIV20
 10132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10133
 10134
 10135
 10136* EXEC CICS HANDLE CONDITION
 10137*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10138*    END-EXEC.
 10139*    MOVE '"$I                   ! # #00010002' TO DFHEIV0
 10140     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10141     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10142     MOVE X'2320233030303130303032' TO DFHEIV0(25:11)
 10143     CALL 'kxdfhei1' USING DFHEIV0
 10144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10145
 10146
 10147     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10148     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10149     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10150
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 188
* VP6311.cbl
 10151
 10152* EXEC CICS READ
 10153*        INTO    (PENDING-BUSINESS)
 10154*        DATASET (FILE-ID-ERPNDB)
 10155*        RIDFLD  (ERPNDB-KEY)
 10156*    END-EXEC.
 10157     MOVE LENGTH OF
 10158      PENDING-BUSINESS
 10159       TO DFHEIV11
 10160*    MOVE '&"IL       E          (   #00010010' TO DFHEIV0
 10161     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10162     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10163     MOVE X'2020233030303130303130' TO DFHEIV0(25:11)
 10164     CALL 'kxdfhei1' USING DFHEIV0,
 10165           FILE-ID-ERPNDB,
 10166           PENDING-BUSINESS,
 10167           DFHEIV11,
 10168           ERPNDB-KEY,
 10169           DFHEIV99,
 10170           DFHEIV99,
 10171           DFHEIV99
 10172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10173
 10174
 10175     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10176
 10177     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10178     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10179     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10180     MOVE SPACES                 TO PENDING-BUSINESS.
 10181     MOVE 'PB'                   TO PB-RECORD-ID.
 10182     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10183     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10184     MOVE SPACES                 TO PB-CERT-SFX.
 10185     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10186     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10187                                    PB-ALT-CHG-SEQ-NO.
 10188
 10189     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10190     MOVE '1'                    TO PB-RECORD-TYPE.
 10191
 10192     IF BSUFIXL NOT = ZEROS
 10193        MOVE BSUFIXI             TO PB-CERT-SFX.
 10194
 10195     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10196
 10197     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10198     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10199
 10200     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10201                                    PB-I-LF-PREM-CALC
 10202                                    PB-I-LF-ALT-PREM-CALC
 10203                                    PB-I-LF-RATE
 10204                                    PB-I-LF-ALT-RATE
 10205                                    PB-I-LF-REI-RATE
 10206                                    PB-I-LF-ALT-REI-RATE
 10207                                    PB-I-RATE-DEV-PCT-LF
 10208                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 189
* VP6311.cbl
 10209                                    PB-I-AH-RATE
 10210                                    PB-I-AH-REI-RATE
 10211                                    PB-I-AH-RATE-TRM
 10212                                    PB-I-RATE-DEV-PCT-AH
 10213                                    PB-I-BUSINESS-TYPE
 10214                                    PB-I-LIFE-COMMISSION
 10215                                    PB-I-JOINT-COMMISSION
 10216                                    PB-I-JOINT-AGE
 10217                                    PB-I-AH-COMMISSION
 10218                                    PB-I-CURR-SEQ
 10219                                    PB-CHG-COUNT
 10220                                    PB-LF-BILLED-AMTS
 10221                                    PB-AH-BILLED-AMTS
 10222                                    PB-CALC-TOLERANCE
 10223                                    PB-I-EXTENTION-DAYS
 10224*                                   PB-I-MICROFILM-NO
 10225                                    PB-I-TERM-IN-DAYS.
 10226
 10227     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10228                                    PB-I-LF-EXPIRE-DT
 10229                                    PB-I-AH-EXPIRE-DT
 10230                                    PB-BILLED-DT
 10231                                    PB-ACCT-EFF-DT
 10232                                    PB-ACCT-EXP-DT
 10233                                    PB-I-1ST-PMT-DT.
 10234
 10235     MOVE 'X'                    TO PB-FATAL-FLAG.
 10236
 10237     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10238
 10239     IF BLSTNML GREATER THAN ZEROS
 10240         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10241
 10242*    IF BMICRNOL  GREATER  ZEROS
 10243*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10244*    ELSE
 10245*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10246     IF BVINL > ZEROS
 10247        MOVE BVINI               TO PB-I-VIN
 10248     END-IF
 10249     IF B1STNML GREATER THAN ZEROS
 10250         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10251
 10252     IF BINITL  GREATER THAN ZEROS
 10253         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10254
 10255     IF BBIRTHL GREATER THAN ZERO
 10256         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10257     ELSE
 10258         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10259
 10260
 10261     IF BAGEL    GREATER THAN ZEROS
 10262         MOVE BAGEI              TO PB-I-AGE
 10263        ELSE
 10264         MOVE ZEROS              TO PB-I-AGE.
 10265
 10266     IF BSEXL    GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 190
* VP6311.cbl
 10267         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10268
 10269     IF BTERM-LEN (1) GREATER THAN ZEROS
 10270        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10271     ELSE
 10272        MOVE ZEROS               TO PB-I-LF-TERM.
 10273
 10274     IF BTERM-LEN (2) GREATER THAN ZEROS
 10275        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10276     ELSE
 10277        MOVE ZEROS               TO PB-I-AH-TERM.
 10278
 10279
 10280
 10281     IF BSKPCDL       GREATER THAN ZEROS
 10282         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10283
 10284
 10285         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10286                                    PI-BPMTS.
 10287
 10288         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10289
 10290     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10291        IF BTYPE  (1)   NOT = ZEROS
 10292           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10293                                    PI-BTYPE (1)
 10294           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10295           MOVE SPACES           TO PB-I-LF-ABBR
 10296        ELSE
 10297           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10298                                    PB-I-LF-ABBR
 10299           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10300     ELSE
 10301        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10302                                    PB-I-LF-ABBR
 10303        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10304
 10305     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10306         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10307     ELSE
 10308         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10309
 10310     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10311         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10312     ELSE
 10313         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10314
 10315     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10316         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10317            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10318            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10319         ELSE
 10320            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10321*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10322*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10323         END-IF
 10324     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 191
* VP6311.cbl
 10325         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10326
 10327     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10328         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10329
 10330     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10331         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10332         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10333     ELSE
 10334         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10335
 10336     IF  BALT-PREM-LEN     (2) > ZEROS
 10337         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10338     ELSE
 10339         MOVE ZEROS            TO PB-I-TOT-FEES.
 10340
 10341     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10342        IF BTYPE      (2)   NOT = ZEROS
 10343           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10344                                  PI-BTYPE (2)
 10345           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10346           MOVE SPACES         TO PB-I-AH-ABBR
 10347        ELSE
 10348           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10349                                  PB-I-AH-ABBR
 10350           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10351     ELSE
 10352        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10353                                  PB-I-AH-ABBR
 10354        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10355
 10356     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10357         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10358     ELSE
 10359         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10360
 10361     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10362         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10363            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10364            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10365         ELSE
 10366            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10367*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10368*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10369         END-IF
 10370     ELSE
 10371         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10372
 10373     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10374         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10375
 10376     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10377        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10378     ELSE
 10379        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10380
 10381     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10382        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 192
* VP6311.cbl
 10383     ELSE
 10384        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10385
 10386     IF BINDGRPL  GREATER THAN ZEROS
 10387         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10388
 10389     IF BRTCLSL   GREATER THAN ZEROS
 10390         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10391
 10392     IF BSIGL     GREATER THAN ZEROS
 10393         MOVE BSIGI              TO PB-I-SIG-SW.
 10394     IF BMEMBERL  GREATER THAN ZEROS
 10395         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10396
 10397     IF BLNOFCRL  GREATER THAN ZEROS
 10398         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10399
 10400     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10401        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10402     ELSE
 10403        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10404
 10405     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10406        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10407     ELSE
 10408        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10409
 10410
 10411     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10412        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10413           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10414
 10415     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10416        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10417           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10418
 10419
 10420     IF PB-EXT-DAYS-PROCESSING
 10421        IF PB-I-EXTENTION-DAYS = ZEROS
 10422           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10423
 10424     IF PB-EXPIRE-DT-PROCESSING
 10425        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10426           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10427             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10428
 10429     IF PB-1ST-PMT-DT-PROCESSING
 10430        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10431           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10432
 10433     IF BREINL GREATER THAN ZEROS
 10434        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10435
 10436     IF BENTRYL NOT = ZEROS
 10437        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10438        IF PI-COMPANY-ID = 'CID'
 10439           AND (PB-BATCH-ENTRY = 'P')
 10440           AND (PB-STATE = 'VA')
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 193
* VP6311.cbl
 10441           PERFORM 1500-UPDATE-ERNOTE
 10442                                 THRU 1500-EXIT
 10443        END-IF
 10444     END-IF
 10445     IF BUNWRITL NOT = ZEROS
 10446        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10447
 10448     IF BFORCEL NOT = ZEROS
 10449        MOVE BFORCEI             TO PB-FORCE-CODE.
 10450
 10451     IF BBILCDL NOT = ZEROS
 10452        MOVE BBILCDI             TO PB-RECORD-BILL.
 10453
 10454
 10455
 10456 1260-WRITE-PB-RECORD.
 10457     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10458                                    PB-INPUT-BY.
 10459     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10460     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10461                                    PB-INPUT-DT.
 10462
 10463     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10464     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10465                                    PB-CONTROL-BY-ORIG-BATCH.
 10466
 10467
 10468     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10469     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10470     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10471     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10472     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10473
 10474     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10475
 10476     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10477
 10478     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10479     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10480     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10481
 10482     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10483     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10484
 10485 1275-WRITE-PENDING-BUSINESS.
 10486     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10487     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10488     MOVE 'A'                    TO JP-RECORD-TYPE.
 10489     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10490
 10491
 10492* EXEC CICS HANDLE CONDITION
 10493*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10494*    END-EXEC.
 10495*    MOVE '"$%                   ! $ #00010332' TO DFHEIV0
 10496     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10497     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10498     MOVE X'2420233030303130333332' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 194
* VP6311.cbl
 10499     CALL 'kxdfhei1' USING DFHEIV0
 10500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10501
 10502
 10503
 10504* EXEC CICS WRITE
 10505*        DATASET (FILE-ID-ERPNDB)
 10506*        FROM    (PENDING-BUSINESS)
 10507*        RIDFLD  (PB-CONTROL-PRIMARY)
 10508*    END-EXEC.
 10509     MOVE LENGTH OF
 10510      PENDING-BUSINESS
 10511       TO DFHEIV11
 10512*    MOVE '&$ L                  ''   #00010336' TO DFHEIV0
 10513     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10514     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10515     MOVE X'2020233030303130333336' TO DFHEIV0(25:11)
 10516     CALL 'kxdfhei1' USING DFHEIV0,
 10517           FILE-ID-ERPNDB,
 10518           PENDING-BUSINESS,
 10519           DFHEIV11,
 10520           PB-CONTROL-PRIMARY,
 10521           DFHEIV99,
 10522           DFHEIV99
 10523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10524
 10525
 10526     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10527
 10528     PERFORM 8400-LOG-JOURNAL-RECORD.
 10529
 10530******************************************************************
 10531*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10532******************************************************************
 10533     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10534     MOVE ' '                    TO WS-ERMAIL-SW
 10535
 10536* EXEC CICS READ
 10537*       DATASET   (FILE-ID-ERMAIL)
 10538*       SET       (ADDRESS OF MAILING-DATA)
 10539*       RIDFLD    (ERMAIL-KEY)
 10540*       RESP      (WS-RESPONSE)
 10541*    END-EXEC
 10542*    MOVE '&"S        E          (  N#00010352' TO DFHEIV0
 10543     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10544     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10545     MOVE X'204E233030303130333532' TO DFHEIV0(25:11)
 10546     CALL 'kxdfhei1' USING DFHEIV0,
 10547           FILE-ID-ERMAIL,
 10548           DFHEIV20,
 10549           DFHEIV99,
 10550           ERMAIL-KEY,
 10551           DFHEIV99,
 10552           DFHEIV99,
 10553           DFHEIV99
 10554     SET ADDRESS OF MAILING-DATA TO
 10555         DFHEIV20
 10556     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 195
* VP6311.cbl
 10557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10558     IF RESP-NORMAL
 10559        SET ERMAIL-FOUND TO TRUE
 10560     END-IF
 10561
 10562     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10563     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10564     MOVE 'OC'                   TO OC-RECORD-ID
 10565     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10566                                 TO OC-CONTROL-PRIMARY (1:33)
 10567     MOVE 'I'                    TO OC-RECORD-TYPE
 10568     MOVE +4096                  TO OC-KEY-SEQ-NO
 10569     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10570     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10571     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10572     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10573     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10574     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10575     MOVE PB-I-AGE               TO OC-INS-AGE
 10576     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10577     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10578     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10579     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10580     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10581     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10582     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10583     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10584     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10585     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10586     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10587     IF PB-I-JOINT-COMMISSION > +0
 10588         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10589     ELSE
 10590         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10591     END-IF
 10592     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10593     MOVE +0                     TO OC-LF-CANCEL-AMT
 10594                                    OC-LF-ITD-CANCEL-AMT
 10595     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10596     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10597     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10598     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10599     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10600     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10601     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10602     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10603     MOVE +0                     TO OC-AH-CANCEL-AMT
 10604                                    OC-AH-ITD-CANCEL-AMT
 10605     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10606     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10607     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10608     IF ERMAIL-FOUND
 10609        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10610     END-IF
 10611     IF NOT CERT-TRL-REC-NOT-FOUND
 10612        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10613                           OC-INS-AGE-DEFAULT-FLAG
 10614        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 196
* VP6311.cbl
 10615                           OC-JNT-AGE-DEFAULT-FLAG
 10616     END-IF
 10617     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10618     .
 10619 1275-WRITE-ELCRTO.
 10620
 10621* EXEC CICS WRITE
 10622*       DATASET   ('ELCRTO')
 10623*       FROM      (ORIGINAL-CERTIFICATE)
 10624*       RIDFLD    (OC-CONTROL-PRIMARY)
 10625*       RESP      (WS-RESPONSE)
 10626*    END-EXEC
 10627     MOVE LENGTH OF
 10628      ORIGINAL-CERTIFICATE
 10629       TO DFHEIV11
 10630     MOVE 'ELCRTO' TO DFHEIV1
 10631*    MOVE '&$ L                  ''  N#00010420' TO DFHEIV0
 10632     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10633     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10634     MOVE X'204E233030303130343230' TO DFHEIV0(25:11)
 10635     CALL 'kxdfhei1' USING DFHEIV0,
 10636           DFHEIV1,
 10637           ORIGINAL-CERTIFICATE,
 10638           DFHEIV11,
 10639           OC-CONTROL-PRIMARY,
 10640           DFHEIV99,
 10641           DFHEIV99
 10642     MOVE EIBRESP  TO WS-RESPONSE
 10643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10644*    display ' just wrote 1275 ' ws-response
 10645     IF RESP-DUPKEY
 10646        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10647        GO TO 1275-WRITE-ELCRTO
 10648     ELSE
 10649        IF NOT RESP-NORMAL
 10650           MOVE -1               TO BMAINTL
 10651           MOVE ER-7450          TO EMI-ERROR
 10652           PERFORM 9900-ERROR-FORMAT
 10653                                 THRU 9900-EXIT
 10654           GO TO 8200-SEND-DATAONLY
 10655        END-IF
 10656     END-IF
 10657******************************************************************
 10658*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10659******************************************************************
 10660
 10661
 10662* EXEC CICS READ
 10663*        INTO    (PENDING-BUSINESS)
 10664*        DATASET (FILE-ID-ERPNDB)
 10665*        RIDFLD  (ERPNDB-KEY)
 10666*        UPDATE
 10667*    END-EXEC.
 10668     MOVE LENGTH OF
 10669      PENDING-BUSINESS
 10670       TO DFHEIV11
 10671*    MOVE '&"IL       EU         (   #00010443' TO DFHEIV0
 10672     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 197
* VP6311.cbl
 10673     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10674     MOVE X'2020233030303130343433' TO DFHEIV0(25:11)
 10675     CALL 'kxdfhei1' USING DFHEIV0,
 10676           FILE-ID-ERPNDB,
 10677           PENDING-BUSINESS,
 10678           DFHEIV11,
 10679           ERPNDB-KEY,
 10680           DFHEIV99,
 10681           DFHEIV99,
 10682           DFHEIV99
 10683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10684
 10685
 10686     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10687     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10688     MOVE 'B'                    TO JP-RECORD-TYPE.
 10689     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10690
 10691     PERFORM 8400-LOG-JOURNAL-RECORD.
 10692
 10693     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10694
 10695
 10696* EXEC CICS REWRITE
 10697*        DATASET (FILE-ID-ERPNDB)
 10698*        FROM    (PENDING-BUSINESS)
 10699*    END-EXEC.
 10700     MOVE LENGTH OF
 10701      PENDING-BUSINESS
 10702       TO DFHEIV11
 10703*    MOVE '&& L                  %   #00010459' TO DFHEIV0
 10704     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10705     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10706     MOVE X'2020233030303130343539' TO DFHEIV0(25:11)
 10707     CALL 'kxdfhei1' USING DFHEIV0,
 10708           FILE-ID-ERPNDB,
 10709           PENDING-BUSINESS,
 10710           DFHEIV11,
 10711           DFHEIV99
 10712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10713
 10714
 10715     MOVE 'C'                    TO JP-RECORD-TYPE.
 10716     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10717
 10718     PERFORM 8400-LOG-JOURNAL-RECORD.
 10719
 10720     IF WS-ERRORS-PRESENT
 10721         GO TO 3900-RE-DISPLAY-RECORD.
 10722
 10723     MOVE ZEROS                  TO EMI-ERROR.
 10724     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10725     MOVE LOW-VALUES             TO VP631BI.
 10726     MOVE  -1                    TO BMAINTL.
 10727     GO TO 8100-SEND-INITIAL-MAP.
 10728
 10729 1280-BATCH-HDR-NOT-FOUND.
 10730     MOVE -1                     TO BMAINTL.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 198
* VP6311.cbl
 10731     MOVE ER-7450                TO EMI-ERROR.
 10732     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10733     GO TO 8200-SEND-DATAONLY.
 10734
 10735 1290-DUPLICATE-ALT-INDEX.
 10736
 10737******************************************************************
 10738*                                                                *
 10739*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 10740*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10741*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10742*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 10743*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10744*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 10745*                                                                *
 10746******************************************************************
 10747
 10748     IF LCP-ONCTR-01 =  0
 10749         ADD 1 TO LCP-ONCTR-01
 10750        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10751
 10752     ADD +1                      TO WS-SEQ-NO-COUNTER.
 10753
 10754     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10755         NEXT SENTENCE
 10756     ELSE
 10757         ADD +1 TO PB-BATCH-SEQ-NO
 10758                   PB-CSR-BATCH-SEQ-NO
 10759         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10760         GO TO 1275-WRITE-PENDING-BUSINESS.
 10761
 10762     MOVE -1                     TO BCERTNOL.
 10763     MOVE AL-UABON               TO BCERTNOA.
 10764     MOVE AL-UNBON               TO BEFFDTA.
 10765
 10766     MOVE 1                      TO EMI-SUB
 10767                                    EMI-SWITCH1
 10768                                    EMI-SWITCH-AREA-1
 10769                                    EMI-SWITCH-AREA-2.
 10770
 10771     MOVE SPACES                 TO EMI-ERROR-LINES.
 10772
 10773
 10774* EXEC CICS SYNCPOINT ROLLBACK
 10775*    END-EXEC.
 10776*    MOVE '6"R                   !   #00010522' TO DFHEIV0
 10777     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10778     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10779     MOVE X'2020233030303130353232' TO DFHEIV0(25:11)
 10780     CALL 'kxdfhei1' USING DFHEIV0
 10781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10782
 10783
 10784     MOVE ER-2247                TO EMI-ERROR.
 10785     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10786     GO TO 8200-SEND-DATAONLY.
 10787
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 199
* VP6311.cbl
 10789
 10790
 10791 1295-READ-CERT-TRAILER.
 10792
 10793
 10794* EXEC CICS GETMAIN
 10795*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 10796*        LENGTH  (ELCRTT-RECORD-LENGTH)
 10797*        INITIMG (GETMAIN-SPACE)
 10798*    END-EXEC
 10799*    MOVE ',"IL                  $   #00010534' TO DFHEIV0
 10800     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10801     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10802     MOVE X'2020233030303130353334' TO DFHEIV0(25:11)
 10803     CALL 'kxdfhei1' USING DFHEIV0,
 10804           DFHEIV20,
 10805           ELCRTT-RECORD-LENGTH,
 10806           GETMAIN-SPACE
 10807     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 10808         DFHEIV20
 10809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10810
 10811     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 10812     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 10813     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 10814
 10815
 10816* EXEC CICS HANDLE CONDITION
 10817*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 10818*    END-EXEC.
 10819*    MOVE '"$I                   ! % #00010544' TO DFHEIV0
 10820     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10821     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10822     MOVE X'2520233030303130353434' TO DFHEIV0(25:11)
 10823     CALL 'kxdfhei1' USING DFHEIV0
 10824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10825
 10826
 10827
 10828* EXEC CICS READ
 10829*        DATASET  (CRTT-ID)
 10830*        RIDFLD   (ELCRTT-KEY)
 10831*        INTO     (CERTIFICATE-TRAILERS)
 10832*    END-EXEC.
 10833     MOVE LENGTH OF
 10834      CERTIFICATE-TRAILERS
 10835       TO DFHEIV11
 10836*    MOVE '&"IL       E          (   #00010548' TO DFHEIV0
 10837     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10838     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10839     MOVE X'2020233030303130353438' TO DFHEIV0(25:11)
 10840     CALL 'kxdfhei1' USING DFHEIV0,
 10841           CRTT-ID,
 10842           CERTIFICATE-TRAILERS,
 10843           DFHEIV11,
 10844           ELCRTT-KEY,
 10845           DFHEIV99,
 10846           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 200
* VP6311.cbl
 10847           DFHEIV99
 10848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10849
 10850
 10851     GO TO 1295-EXIT.
 10852
 10853 1295-CERT-TRL-REC-NOTFND.
 10854     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 10855
 10856 1295-EXIT.
 10857     EXIT.
 10858
 10859******************************************************************
 10860*                                                                *
 10861*          C H A N G E   I S S U E   R O U T I N E               *
 10862*                                                                *
 10863******************************************************************
 10864
 10865***************************************************************
 10866*                                                             *
 10867*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 10868*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10869*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 10870*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 10871*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 10872*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 10873*     5. LINK TO THE EDIT ROUTINE.                            *
 10874*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10875*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 10876*              THE EDIT ROUTINE.                              *
 10877*     7. REWRITE THE NEW ISSUE                                *
 10878*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10879*                                                             *
 10880***************************************************************
 10881
 10882 1300-CHANGE-ISSUE-ROUTINE.
 10883     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 10884
 10885     IF BCHGL NOT = ZEROS
 10886        MOVE ER-2196             TO EMI-ERROR
 10887        MOVE AL-UABON            TO BMAINTA
 10888        MOVE -1                  TO BMAINTL
 10889        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10890        GO TO 8200-SEND-DATAONLY.
 10891
 10892     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10893
 10894     IF BSUFIXL NOT = ZEROS
 10895        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10896     ELSE
 10897        MOVE SPACE               TO WS-NEW-SUFFIX.
 10898
 10899     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10900     PERFORM 8600-DEEDIT.
 10901     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10902     MOVE '4'                    TO DC-OPTION-CODE.
 10903     PERFORM 9700-DATE-LINK.
 10904     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 201
* VP6311.cbl
 10905        MOVE ER-0348             TO EMI-ERROR
 10906        MOVE -1                  TO BEFFDTL
 10907        MOVE AL-UABON            TO BEFFDTA
 10908        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10909        GO TO 8200-SEND-DATAONLY
 10910     ELSE
 10911        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10912        MOVE AL-UANON            TO BEFFDTA
 10913        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10914
 10915 1325-PROCESS-ISSUE-CHANGES.
 10916
 10917* EXEC CICS HANDLE CONDITION
 10918*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 10919*    END-EXEC.
 10920*    MOVE '"$I                   ! & #00010619' TO DFHEIV0
 10921     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10922     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10923     MOVE X'2620233030303130363139' TO DFHEIV0(25:11)
 10924     CALL 'kxdfhei1' USING DFHEIV0
 10925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10926
 10927
 10928     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 10929     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 10930     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 10931
 10932
 10933* EXEC CICS GETMAIN
 10934*        SET      (ADDRESS OF PENDING-BUSINESS)
 10935*        LENGTH   (ERPNDB-RECORD-LENGTH)
 10936*        INITIMG  (GETMAIN-SPACE)
 10937*     END-EXEC.
 10938*    MOVE ',"IL                  $   #00010627' TO DFHEIV0
 10939     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10940     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10941     MOVE X'2020233030303130363237' TO DFHEIV0(25:11)
 10942     CALL 'kxdfhei1' USING DFHEIV0,
 10943           DFHEIV20,
 10944           ERPNDB-RECORD-LENGTH,
 10945           GETMAIN-SPACE
 10946     SET ADDRESS OF PENDING-BUSINESS TO
 10947         DFHEIV20
 10948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10949
 10950
 10951
 10952* EXEC CICS READ
 10953*        INTO    (PENDING-BUSINESS)
 10954*        DATASET (FILE-ID-ERPNDB)
 10955*        RIDFLD  (ERPNDB-KEY)
 10956*    END-EXEC.
 10957     MOVE LENGTH OF
 10958      PENDING-BUSINESS
 10959       TO DFHEIV11
 10960*    MOVE '&"IL       E          (   #00010633' TO DFHEIV0
 10961     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10962     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 202
* VP6311.cbl
 10963     MOVE X'2020233030303130363333' TO DFHEIV0(25:11)
 10964     CALL 'kxdfhei1' USING DFHEIV0,
 10965           FILE-ID-ERPNDB,
 10966           PENDING-BUSINESS,
 10967           DFHEIV11,
 10968           ERPNDB-KEY,
 10969           DFHEIV99,
 10970           DFHEIV99,
 10971           DFHEIV99
 10972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10973
 10974
 10975     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10976
 10977
 10978* EXEC CICS HANDLE CONDITION
 10979*         NOTFND     (1385-REC-NOT-FOUND)
 10980*    END-EXEC.
 10981*    MOVE '"$I                   ! '' #00010641' TO DFHEIV0
 10982     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10983     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10984     MOVE X'2720233030303130363431' TO DFHEIV0(25:11)
 10985     CALL 'kxdfhei1' USING DFHEIV0
 10986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10987
 10988
 10989**********************************************************
 10990*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 10991*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 10992**********************************************************
 10993
 10994
 10995* EXEC CICS READ
 10996*        DATASET (FILE-ID-ERPNDB)
 10997*        INTO    (PENDING-BUSINESS)
 10998*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 10999*    END-EXEC.
 11000     MOVE LENGTH OF
 11001      PENDING-BUSINESS
 11002       TO DFHEIV11
 11003*    MOVE '&"IL       E          (   #00010650' TO DFHEIV0
 11004     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11005     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11006     MOVE X'2020233030303130363530' TO DFHEIV0(25:11)
 11007     CALL 'kxdfhei1' USING DFHEIV0,
 11008           FILE-ID-ERPNDB,
 11009           PENDING-BUSINESS,
 11010           DFHEIV11,
 11011           PI-PREV-CONTROL-PRIMARY,
 11012           DFHEIV99,
 11013           DFHEIV99,
 11014           DFHEIV99
 11015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11016
 11017
 11018********** DO NOT ALLOW CHANGES IF THRU A/R
 11019     IF BMAINTI = 'C'
 11020         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 203
* VP6311.cbl
 11021             MOVE ER-4005          TO EMI-ERROR
 11022             MOVE -1               TO BMAINTL
 11023             MOVE AL-UABON         TO BMAINTA
 11024             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11025             GO TO 8200-SEND-DATAONLY.
 11026**********
 11027
 11028     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11029        MOVE -1                 TO BMAINTL
 11030        MOVE ER-2197            TO EMI-ERROR
 11031        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11032        GO TO 8200-SEND-DATAONLY.
 11033
 11034     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11035        MOVE ER-2196             TO EMI-ERROR
 11036        MOVE AL-UABON            TO BMAINTA
 11037        MOVE -1                  TO BMAINTL
 11038        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11039        GO TO 8200-SEND-DATAONLY.
 11040
 11041     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11042
 11043     IF PB-BILLED-DT = LOW-VALUES AND
 11044        PB-CHG-COUNT = ZEROS
 11045        NEXT SENTENCE
 11046     ELSE
 11047        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11048            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11049           OR
 11050           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11051            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11052           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11053     move zeros                  to ws-check-amts
 11054     move ' '                    to ws-stop-sw
 11055                                    ws-check-sw
 11056                                    ws-proc-check-sw
 11057                                    ws-chek-browse-sw
 11058
 11059     perform 2500-browse-checks  thru 2500-exit
 11060
 11061     if i-have-processed-checks
 11062        or i-have-checks
 11063        continue
 11064     else
 11065        go to 1330-continue
 11066     end-if
 11067
 11068     compute ws-tot-orig-prem =
 11069        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11070        pb-i-lf-alt-premium-amt
 11071
 11072     if bprem1l <> zeros
 11073        MOVE AL-UNNON            TO bprem1a
 11074        move ws-bprem (1)        to ws-new-iss-total
 11075     else
 11076        move pb-i-lf-premium-amt to ws-new-iss-total
 11077     end-if
 11078     display ' new iss totala ' ws-new-iss-total
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 204
* VP6311.cbl
 11079
 11080     if baltpr1l <> zeros
 11081        MOVE AL-UNNON            TO baltpr1a
 11082        compute ws-new-iss-total =
 11083           ws-new-iss-total + ws-balt-prem(1)
 11084     else
 11085        compute ws-new-iss-total =
 11086           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11087     end-if
 11088
 11089     if bprem2l <> zeros
 11090        MOVE AL-UNNON            TO bprem2a
 11091        compute ws-new-iss-total = ws-new-iss-total +
 11092           ws-bprem (2)
 11093     else
 11094        compute ws-new-iss-total = ws-new-iss-total +
 11095           pb-i-ah-premium-amt
 11096     end-if
 11097
 11098     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11099        if ((bprem1l <> zeros)
 11100           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11101                      or
 11102           ((bprem2l <> zeros)
 11103           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11104           move er-3456          to emi-error
 11105           perform 9900-error-format
 11106                                 thru 9900-exit
 11107           go to 1330-continue
 11108        end-if
 11109     end-if
 11110
 11111     if ws-new-iss-total > ws-tot-orig-prem
 11112        move er-3458             to emi-error
 11113        perform 9900-error-format thru 9900-exit
 11114        move al-uabon            to bmainta
 11115        move -1                  to bmaintl
 11116        go to 8200-send-dataonly
 11117     end-if
 11118
 11119     if ws-new-iss-total < ws-tot-orig-prem
 11120        move er-3457             to emi-error
 11121        move al-uabon            to bprem1a
 11122                                    bprem2a
 11123        move +0 to bprem1l bprem2l
 11124        perform 9900-error-format thru 9900-exit
 11125        move -1                  to bmaintl
 11126        go to 1330-continue
 11127     end-if
 11128
 11129     .
 11130 1330-continue.
 11131
 11132
 11133* EXEC CICS READ
 11134*        DATASET (FILE-ID-ERPNDB)
 11135*        INTO    (PENDING-BUSINESS)
 11136*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 205
* VP6311.cbl
 11137*        UPDATE
 11138*    END-EXEC.
 11139     MOVE LENGTH OF
 11140      PENDING-BUSINESS
 11141       TO DFHEIV11
 11142*    MOVE '&"IL       EU         (   #00010770' TO DFHEIV0
 11143     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11144     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11145     MOVE X'2020233030303130373730' TO DFHEIV0(25:11)
 11146     CALL 'kxdfhei1' USING DFHEIV0,
 11147           FILE-ID-ERPNDB,
 11148           PENDING-BUSINESS,
 11149           DFHEIV11,
 11150           PI-PREV-CONTROL-PRIMARY,
 11151           DFHEIV99,
 11152           DFHEIV99,
 11153           DFHEIV99
 11154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11155
 11156
 11157     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11158     MOVE 'B'                    TO JP-RECORD-TYPE
 11159     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11160     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11161
 11162     PERFORM 8400-LOG-JOURNAL-RECORD.
 11163
 11164     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11165        PB-CHG-COUNT NOT = ZEROS
 11166        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11167            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11168           OR
 11169           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11170            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11171            MOVE LOW-VALUES             TO PB-BILLED-DT
 11172            ADD +1                      TO PB-CHG-COUNT.
 11173
 11174     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11175     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11176     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11177     MOVE '5'                    TO DC-OPTION-CODE.
 11178     PERFORM 9700-DATE-LINK
 11179     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11180
 11181*    IF BMICRNOL  GREATER  ZEROS
 11182*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11183
 11184     IF BVINL > ZEROS
 11185        MOVE BVINI               TO PB-I-VIN
 11186     END-IF
 11187     IF (BFORCEL NOT = ZEROS)
 11188        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11189        AND (BFORCEI = ' ')
 11190        AND (PB-FORCE-CODE = 'O')
 11191        COMPUTE PB-I-AH-PREMIUM-AMT =
 11192           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11193        PERFORM 1800-REMOVE-CERT-NOTES
 11194                                 THRU 1800-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 206
* VP6311.cbl
 11195        PERFORM 1900-DELETE-ERPYAJ
 11196                                 THRU 1900-EXIT
 11197        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11198     END-IF
 11199     IF (BFORCEL NOT = ZEROS)
 11200        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11201        AND (BFORCEI = 'O')
 11202        AND (PB-FORCE-CODE NOT = 'O')
 11203        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11204           PB-I-AH-PREM-CALC
 11205        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11206        MOVE SPACE               TO DC-OPTION-CODE
 11207        PERFORM 9700-DATE-LINK
 11208        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11209        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11210        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11211        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11212        PERFORM 1500-UPDATE-ERNOTE
 11213                                 THRU 1500-EXIT
 11214        PERFORM 1600-UPDATE-ERPYAJ
 11215                                 THRU 1600-EXIT
 11216     END-IF
 11217     IF BLSTNML  GREATER THAN ZEROS
 11218         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11219
 11220     IF B1STNML  GREATER THAN ZEROS
 11221         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11222
 11223     IF BINITL   GREATER THAN ZEROS
 11224         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11225
 11226     IF BBIRTHL  GREATER THAN ZERO
 11227         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11228
 11229
 11230     IF BAGEL    GREATER THAN ZEROS
 11231         MOVE BAGEI              TO PB-I-AGE.
 11232
 11233     MOVE 'N'                    TO WS-INS-AGE-SET
 11234                                    WS-JNT-AGE-SET.
 11235     IF BAGEL    GREATER THAN ZEROS
 11236        MOVE 'Y'                TO WS-INS-AGE-SET
 11237        IF BAGEI = ZERO AND
 11238             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11239           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11240           MOVE 'AGE*'          TO BAGEDEFO
 11241        ELSE
 11242           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11243           MOVE 'AGE '          TO BAGEDEFO
 11244        END-IF
 11245        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11246     END-IF.
 11247     if (byearl      <> zeros)
 11248        or (bmakel   <> zeros)
 11249        or (bmodell  <> zeros)
 11250        or (bometerl <> zeros)
 11251        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11252                                 TO ELCRTT-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 207
* VP6311.cbl
 11253        MOVE 'C'                 TO ELCRTT-REC-TYPE
 11254        perform 1390-read-elcrtt-update
 11255                                 thru 1390-exit
 11256        if resp-normal
 11257           perform 1391-rewrite-elcrtt
 11258                                 thru 1391-exit
 11259        else
 11260           if resp-notfnd
 11261              perform 1392-write-elcrtt
 11262                                 thru 1392-exit
 11263           end-if
 11264        end-if
 11265     end-if
 11266     IF BSEXL    GREATER THAN ZEROS
 11267         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11268
 11269     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11270        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11271
 11272     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11273        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11274
 11275
 11276
 11277     IF BSKPCDL  GREATER THAN ZEROS
 11278         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11279
 11280
 11281
 11282
 11283     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11284         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11285
 11286     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11287         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11288
 11289     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11290
 11291     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11292         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11293            SUBTRACT PB-I-LF-PREMIUM-AMT
 11294                     FROM WS-B-LF-ISS-PRM-ENTERED
 11295            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11296            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11297            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11298         ELSE
 11299            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11300*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11301*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11302         END-IF
 11303     END-IF.
 11304
 11305     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11306            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11307                     FROM WS-B-LF-ISS-PRM-ENTERED
 11308         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11309         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11310
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 208
* VP6311.cbl
 11311     IF  BALT-PREM-LEN     (2)  > ZEROS
 11312         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11313
 11314     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11315         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11316
 11317     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11318         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11319            SUBTRACT PB-I-AH-PREMIUM-AMT
 11320                     FROM WS-B-AH-ISS-PRM-ENTERED
 11321            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11322            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11323            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11324         ELSE
 11325            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11326*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11327*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11328         END-IF
 11329     END-IF
 11330
 11331     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11332        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11333
 11334     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11335        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11336
 11337     IF BINDGRPL            GREATER THAN ZEROS
 11338         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11339
 11340     IF BRTCLSL             GREATER THAN ZEROS
 11341         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11342
 11343     IF BSIGL               GREATER THAN ZEROS
 11344         MOVE BSIGI              TO PB-I-SIG-SW.
 11345
 11346
 11347     IF BMEMBERL            GREATER THAN ZEROS
 11348         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11349
 11350     IF BLNOFCRL            GREATER THAN ZEROS
 11351         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11352
 11353     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11354        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11355
 11356     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11357        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11358
 11359
 11360     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11361        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11362           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11363
 11364     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11365        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11366           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11367
 11368
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 209
* VP6311.cbl
 11369     IF PB-EXT-DAYS-PROCESSING
 11370        IF PB-I-EXTENTION-DAYS = ZEROS
 11371           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11372
 11373     IF PB-EXPIRE-DT-PROCESSING
 11374        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11375           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11376             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11377
 11378     IF PB-1ST-PMT-DT-PROCESSING
 11379        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11380           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11381
 11382     IF BREINL GREATER THAN ZEROS
 11383        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11384
 11385     IF BFORCEL NOT = ZEROS
 11386        MOVE BFORCEI             TO PB-FORCE-CODE.
 11387     IF (BENTRYL NOT = ZEROS)
 11388        AND (PB-COMPANY-ID = 'CID')
 11389        AND (PB-STATE = 'VA')
 11390        AND (BENTRYI NOT = 'P')
 11391        AND (PB-BATCH-ENTRY = 'P')
 11392        PERFORM 1800-REMOVE-CERT-NOTES
 11393                                 THRU 1800-EXIT
 11394     END-IF
 11395     IF BENTRYL NOT = ZEROS
 11396        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11397        IF PI-COMPANY-ID = 'CID'
 11398           AND (PB-BATCH-ENTRY = 'P')
 11399           AND (PB-STATE = 'VA')
 11400           PERFORM 1500-UPDATE-ERNOTE
 11401                                 THRU 1500-EXIT
 11402        END-IF
 11403     END-IF
 11404
 11405     IF BUNWRITL NOT = ZEROS
 11406        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11407
 11408     IF BBILCDL NOT = ZEROS
 11409        MOVE BBILCDI             TO PB-RECORD-BILL.
 11410
 11411
 11412
 11413
 11414
 11415*****************************************************************
 11416*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11417*****************************************************************
 11418
 11419     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11420        IF BTYPE  (1)   = ZEROS OR SPACES
 11421           IF REMOVE-LF-COVERAGE
 11422               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11423                                        PI-BTYPE (1)
 11424               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11425                                        WS-B-LF-ISS-PRM-ENTERED
 11426               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 210
* VP6311.cbl
 11427                                        WS-B-LF-ISS-PRM-ENTERED
 11428               SUBTRACT PB-I-LF-PREM-CALC FROM
 11429                                        WS-B-LF-ISS-PRM-COMPUTED
 11430               MOVE ZEROS            TO PB-I-LF-TERM
 11431                                        PB-I-LF-BENEFIT-AMT
 11432                                        PB-I-LF-PREMIUM-AMT
 11433                                        PB-I-LF-BENEFIT-CD
 11434                                        PB-I-LF-PREM-CALC
 11435                                        PB-I-LF-CRIT-PER
 11436                                        PB-I-LF-ALT-BENEFIT-AMT
 11437                                        PB-I-LF-ALT-PREMIUM-AMT
 11438               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11439           ELSE
 11440               NEXT SENTENCE
 11441        ELSE
 11442           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11443                                    PI-BTYPE (1).
 11444     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11445        IF BTYPE  (2)   = ZEROS OR SPACES
 11446           IF  REMOVE-AH-COVERAGE
 11447               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11448                                        PI-BTYPE (2)
 11449               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11450                                        WS-B-AH-ISS-PRM-ENTERED
 11451               SUBTRACT PB-I-AH-PREM-CALC FROM
 11452                                        WS-B-AH-ISS-PRM-COMPUTED
 11453               MOVE ZEROS            TO PB-I-AH-TERM
 11454                                        PB-I-AH-BENEFIT-AMT
 11455                                        PB-I-AH-PREMIUM-AMT
 11456                                        PB-I-AH-BENEFIT-CD
 11457                                        PB-I-AH-PREM-CALC
 11458                                        PB-I-AH-CRIT-PER
 11459               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11460           ELSE
 11461               NEXT SENTENCE
 11462        ELSE
 11463           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11464                                    PI-BTYPE (2).
 11465 1360-REWRITE-PB-RECORD.
 11466     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11467
 11468     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11469     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11470
 11471     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11472
 11473     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11474     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11475
 11476     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11477         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11478
 11479     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11480         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11481
 11482     PERFORM 1398-UPDATE-ERPNDM THRU 1398-EXIT.
 11483
 11484     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 211
* VP6311.cbl
 11485
 11486     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11487
 11488     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11489     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11490     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11491
 11492     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11493     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11494
 11495 1375-REWRITE-PB-RECORD.
 11496     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11497     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11498     MOVE 'C'                    TO JP-RECORD-TYPE.
 11499     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11500
 11501
 11502* EXEC CICS REWRITE
 11503*        DATASET (FILE-ID-ERPNDB)
 11504*        FROM    (PENDING-BUSINESS)
 11505*    END-EXEC.
 11506     MOVE LENGTH OF
 11507      PENDING-BUSINESS
 11508       TO DFHEIV11
 11509*    MOVE '&& L                  %   #00011121' TO DFHEIV0
 11510     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11511     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11512     MOVE X'2020233030303131313231' TO DFHEIV0(25:11)
 11513     CALL 'kxdfhei1' USING DFHEIV0,
 11514           FILE-ID-ERPNDB,
 11515           PENDING-BUSINESS,
 11516           DFHEIV11,
 11517           DFHEIV99
 11518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11519
 11520
 11521     PERFORM 8400-LOG-JOURNAL-RECORD.
 11522******************************************************************
 11523*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11524******************************************************************
 11525     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11526     MOVE ' '                    TO WS-ERMAIL-SW
 11527
 11528* EXEC CICS READ
 11529*       DATASET   (FILE-ID-ERMAIL)
 11530*       SET       (ADDRESS OF MAILING-DATA)
 11531*       RIDFLD    (ERMAIL-KEY)
 11532*       RESP      (WS-RESPONSE)
 11533*    END-EXEC
 11534*    MOVE '&"S        E          (  N#00011132' TO DFHEIV0
 11535     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11536     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11537     MOVE X'204E233030303131313332' TO DFHEIV0(25:11)
 11538     CALL 'kxdfhei1' USING DFHEIV0,
 11539           FILE-ID-ERMAIL,
 11540           DFHEIV20,
 11541           DFHEIV99,
 11542           ERMAIL-KEY,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 212
* VP6311.cbl
 11543           DFHEIV99,
 11544           DFHEIV99,
 11545           DFHEIV99
 11546     SET ADDRESS OF MAILING-DATA TO
 11547         DFHEIV20
 11548     MOVE EIBRESP  TO WS-RESPONSE
 11549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11550     IF RESP-NORMAL
 11551        SET ERMAIL-FOUND TO TRUE
 11552     END-IF
 11553
 11554     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11555     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11556                                 TO ELCRTO-KEY
 11557     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11558     MOVE +0                     TO ELCRTO-SEQ-NO
 11559
 11560* EXEC CICS READ
 11561*       DATASET   ('ELCRTO')
 11562*       INTO      (ORIGINAL-CERTIFICATE)
 11563*       RIDFLD    (ELCRTO-KEY)
 11564*       GTEQ
 11565*       RESP      (WS-RESPONSE)
 11566*    END-EXEC
 11567     MOVE LENGTH OF
 11568      ORIGINAL-CERTIFICATE
 11569       TO DFHEIV11
 11570     MOVE 'ELCRTO' TO DFHEIV1
 11571*    MOVE '&"IL       G          (  N#00011147' TO DFHEIV0
 11572     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11573     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11574     MOVE X'204E233030303131313437' TO DFHEIV0(25:11)
 11575     CALL 'kxdfhei1' USING DFHEIV0,
 11576           DFHEIV1,
 11577           ORIGINAL-CERTIFICATE,
 11578           DFHEIV11,
 11579           ELCRTO-KEY,
 11580           DFHEIV99,
 11581           DFHEIV99,
 11582           DFHEIV99
 11583     MOVE EIBRESP  TO WS-RESPONSE
 11584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11585*    display ' just read gteq ' ws-response
 11586     IF RESP-NORMAL
 11587        AND (OC-CONTROL-PRIMARY (1:33) =
 11588                 PB-CONTROL-BY-ACCOUNT (1:33))
 11589        AND (OC-RECORD-TYPE = 'I')
 11590        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11591           display ' csr edit session ' PI-CSR-SESSION-SW
 11592           IF NOT CSR-EDIT-SESSION
 11593
 11594* EXEC CICS READ
 11595*                DATASET   ('ELCRTO')
 11596*                INTO      (ORIGINAL-CERTIFICATE)
 11597*                RIDFLD    (OC-CONTROL-PRIMARY)
 11598*                UPDATE
 11599*                RESP      (WS-RESPONSE)
 11600*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 213
* VP6311.cbl
 11601     MOVE LENGTH OF
 11602      ORIGINAL-CERTIFICATE
 11603       TO DFHEIV11
 11604     MOVE 'ELCRTO' TO DFHEIV1
 11605*    MOVE '&"IL       EU         (  N#00011164' TO DFHEIV0
 11606     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11607     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11608     MOVE X'204E233030303131313634' TO DFHEIV0(25:11)
 11609     CALL 'kxdfhei1' USING DFHEIV0,
 11610           DFHEIV1,
 11611           ORIGINAL-CERTIFICATE,
 11612           DFHEIV11,
 11613           OC-CONTROL-PRIMARY,
 11614           DFHEIV99,
 11615           DFHEIV99,
 11616           DFHEIV99
 11617     MOVE EIBRESP  TO WS-RESPONSE
 11618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11619              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11620              IF RESP-NORMAL
 11621                 display ' good read upd '
 11622                 MOVE PB-I-INSURED-LAST-NAME TO
 11623                         OC-INS-LAST-NAME
 11624                 MOVE PB-I-INSURED-FIRST-NAME TO
 11625                         OC-INS-FIRST-NAME
 11626                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11627                         OC-INS-MIDDLE-INIT
 11628                 MOVE PB-I-AGE         TO OC-INS-AGE
 11629                 MOVE PB-I-JOINT-LAST-NAME   TO
 11630                         OC-JNT-LAST-NAME
 11631                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11632                         OC-JNT-FIRST-NAME
 11633                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11634                         OC-JNT-MIDDLE-INIT
 11635                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11636                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11637                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11638                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11639                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11640                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11641                         OC-LF-ALT-BEN-AMT
 11642                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11643                         OC-LF-ALT-PRM-AMT
 11644                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11645                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11646                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11647                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11648                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11649                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11650                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11651                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11652                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11653                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11654                 IF OC-CANCEL-TRAN-IND = 'N'
 11655                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11656                    MOVE +0            TO OC-LF-CANCEL-AMT
 11657                                          OC-LF-ITD-CANCEL-AMT
 11658                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 214
* VP6311.cbl
 11659                    MOVE +0            TO OC-AH-CANCEL-AMT
 11660                                          OC-AH-ITD-CANCEL-AMT
 11661                 END-IF
 11662                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11663                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11664                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11665                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11666                 IF ERMAIL-FOUND
 11667                    MOVE MA-CRED-BENE-NAME
 11668                                 TO OC-CRED-BENE-NAME
 11669                 END-IF
 11670                 IF NOT CERT-TRL-REC-NOT-FOUND
 11671                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11672                           OC-INS-AGE-DEFAULT-FLAG
 11673                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11674                           OC-JNT-AGE-DEFAULT-FLAG
 11675                 END-IF
 11676
 11677* EXEC CICS REWRITE
 11678*                   DATASET   ('ELCRTO')
 11679*                   FROM      (ORIGINAL-CERTIFICATE)
 11680*                   RESP      (WS-RESPONSE)
 11681*                END-EXEC
 11682     MOVE LENGTH OF
 11683      ORIGINAL-CERTIFICATE
 11684       TO DFHEIV11
 11685     MOVE 'ELCRTO' TO DFHEIV1
 11686*    MOVE '&& L                  %  N#00011228' TO DFHEIV0
 11687     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11688     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11689     MOVE X'204E233030303131323238' TO DFHEIV0(25:11)
 11690     CALL 'kxdfhei1' USING DFHEIV0,
 11691           DFHEIV1,
 11692           ORIGINAL-CERTIFICATE,
 11693           DFHEIV11,
 11694           DFHEIV99
 11695     MOVE EIBRESP  TO WS-RESPONSE
 11696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11697                 display ' just rewrote ' ws-response
 11698              END-IF
 11699           END-IF
 11700        ELSE
 11701           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11702           MOVE 'OC'             TO OC-RECORD-ID
 11703           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11704           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11705           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11706           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11707           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11708           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11709           MOVE PB-I-AGE         TO OC-INS-AGE
 11710           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11711           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11712           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11713           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11714           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11715           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11716           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 215
* VP6311.cbl
 11717           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11718           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11719           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11720           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11721           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11722           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11723           MOVE +0               TO OC-LF-CANCEL-AMT
 11724                                    OC-LF-ITD-CANCEL-AMT
 11725           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11726           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11727           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11728           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11729           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11730           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11731           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11732           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11733           MOVE +0               TO OC-AH-CANCEL-AMT
 11734                                    OC-AH-ITD-CANCEL-AMT
 11735           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11736           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11737           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 11738           IF ERMAIL-FOUND
 11739              MOVE MA-CRED-BENE-NAME
 11740                                 TO OC-CRED-BENE-NAME
 11741           END-IF
 11742           IF NOT CERT-TRL-REC-NOT-FOUND
 11743              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11744                           OC-INS-AGE-DEFAULT-FLAG
 11745              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11746                           OC-JNT-AGE-DEFAULT-FLAG
 11747           END-IF
 11748           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11749
 11750* EXEC CICS WRITE
 11751*             DATASET   ('ELCRTO')
 11752*             FROM      (ORIGINAL-CERTIFICATE)
 11753*             RIDFLD    (OC-CONTROL-PRIMARY)
 11754*             RESP      (WS-RESPONSE)
 11755*          END-EXEC
 11756     MOVE LENGTH OF
 11757      ORIGINAL-CERTIFICATE
 11758       TO DFHEIV11
 11759     MOVE 'ELCRTO' TO DFHEIV1
 11760*    MOVE '&$ L                  ''  N#00011285' TO DFHEIV0
 11761     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11762     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11763     MOVE X'204E233030303131323835' TO DFHEIV0(25:11)
 11764     CALL 'kxdfhei1' USING DFHEIV0,
 11765           DFHEIV1,
 11766           ORIGINAL-CERTIFICATE,
 11767           DFHEIV11,
 11768           OC-CONTROL-PRIMARY,
 11769           DFHEIV99,
 11770           DFHEIV99
 11771     MOVE EIBRESP  TO WS-RESPONSE
 11772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11773        END-IF
 11774     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 216
* VP6311.cbl
 11775        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11776        MOVE 'OC'                TO OC-RECORD-ID
 11777        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11778                                 TO OC-CONTROL-PRIMARY (1:33)
 11779        MOVE 'I'                 TO OC-RECORD-TYPE
 11780        MOVE +4096               TO OC-KEY-SEQ-NO
 11781        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11782        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 11783        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11784        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11785        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11786        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11787        MOVE PB-I-AGE            TO OC-INS-AGE
 11788        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11789        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11790        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11791        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11792        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11793        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11794        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11795        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11796        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11797        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11798        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11799        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11800        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11801        MOVE +0                  TO OC-LF-CANCEL-AMT
 11802                                    OC-LF-ITD-CANCEL-AMT
 11803        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11804        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11805        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11806        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11807        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11808        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11809        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11810        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11811        MOVE +0                  TO OC-AH-CANCEL-AMT
 11812                                    OC-AH-ITD-CANCEL-AMT
 11813        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11814        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 11815        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 11816        IF ERMAIL-FOUND
 11817           MOVE MA-CRED-BENE-NAME
 11818                                 TO OC-CRED-BENE-NAME
 11819        END-IF
 11820        IF NOT CERT-TRL-REC-NOT-FOUND
 11821           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11822                           OC-INS-AGE-DEFAULT-FLAG
 11823           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11824                           OC-JNT-AGE-DEFAULT-FLAG
 11825        END-IF
 11826        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11827
 11828* EXEC CICS WRITE
 11829*          DATASET   ('ELCRTO')
 11830*          FROM      (ORIGINAL-CERTIFICATE)
 11831*          RIDFLD    (OC-CONTROL-PRIMARY)
 11832*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 217
* VP6311.cbl
 11833*       END-EXEC
 11834     MOVE LENGTH OF
 11835      ORIGINAL-CERTIFICATE
 11836       TO DFHEIV11
 11837     MOVE 'ELCRTO' TO DFHEIV1
 11838*    MOVE '&$ L                  ''  N#00011345' TO DFHEIV0
 11839     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11840     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11841     MOVE X'204E233030303131333435' TO DFHEIV0(25:11)
 11842     CALL 'kxdfhei1' USING DFHEIV0,
 11843           DFHEIV1,
 11844           ORIGINAL-CERTIFICATE,
 11845           DFHEIV11,
 11846           OC-CONTROL-PRIMARY,
 11847           DFHEIV99,
 11848           DFHEIV99
 11849     MOVE EIBRESP  TO WS-RESPONSE
 11850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11851     END-IF
 11852******************************************************************
 11853*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11854******************************************************************
 11855
 11856     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 11857     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11858
 11859
 11860* EXEC CICS READ
 11861*        INTO    (PENDING-BUSINESS)
 11862*        DATASET (FILE-ID-ERPNDB)
 11863*        RIDFLD  (ERPNDB-KEY)
 11864*        UPDATE
 11865*    END-EXEC.
 11866     MOVE LENGTH OF
 11867      PENDING-BUSINESS
 11868       TO DFHEIV11
 11869*    MOVE '&"IL       EU         (   #00011359' TO DFHEIV0
 11870     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11871     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11872     MOVE X'2020233030303131333539' TO DFHEIV0(25:11)
 11873     CALL 'kxdfhei1' USING DFHEIV0,
 11874           FILE-ID-ERPNDB,
 11875           PENDING-BUSINESS,
 11876           DFHEIV11,
 11877           ERPNDB-KEY,
 11878           DFHEIV99,
 11879           DFHEIV99,
 11880           DFHEIV99
 11881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11882
 11883
 11884     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 11885     MOVE 'B'                    TO JP-RECORD-TYPE.
 11886     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11887
 11888     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11889
 11890     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 218
* VP6311.cbl
 11891
 11892     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 11893
 11894     MOVE 'C'                    TO JP-RECORD-TYPE.
 11895     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11896
 11897
 11898* EXEC CICS REWRITE
 11899*        DATASET    (FILE-ID-ERPNDB)
 11900*        FROM       (PENDING-BUSINESS)
 11901*    END-EXEC.
 11902     MOVE LENGTH OF
 11903      PENDING-BUSINESS
 11904       TO DFHEIV11
 11905*    MOVE '&& L                  %   #00011379' TO DFHEIV0
 11906     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11907     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11908     MOVE X'2020233030303131333739' TO DFHEIV0(25:11)
 11909     CALL 'kxdfhei1' USING DFHEIV0,
 11910           FILE-ID-ERPNDB,
 11911           PENDING-BUSINESS,
 11912           DFHEIV11,
 11913           DFHEIV99
 11914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11915
 11916
 11917     PERFORM 8400-LOG-JOURNAL-RECORD.
 11918
 11919     IF WS-ERRORS-PRESENT
 11920        GO TO 3900-RE-DISPLAY-RECORD.
 11921
 11922     MOVE ZEROS                  TO EMI-ERROR.
 11923     MOVE -1                     TO BMAINTL.
 11924     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11925     GO TO 3900-RE-DISPLAY-RECORD.
 11926
 11927 1380-BATCH-HDR-NOT-FOUND.
 11928     MOVE -1                     TO BMAINTL.
 11929     MOVE ER-7450                TO EMI-ERROR.
 11930     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11931     GO TO 8200-SEND-DATAONLY.
 11932
 11933 1385-REC-NOT-FOUND.
 11934     MOVE -1                     TO BMAINTL.
 11935     MOVE ER-7451                TO EMI-ERROR.
 11936     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11937     GO TO 8200-SEND-DATAONLY.
 11938
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 219
* VP6311.cbl
 11940
 11941
 11942 1386-UPDATE-AGE-FLAGS.
 11943
 11944
 11945* EXEC CICS GETMAIN
 11946*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11947*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11948*        INITIMG (GETMAIN-SPACE)
 11949*    END-EXEC
 11950*    MOVE ',"IL                  $   #00011411' TO DFHEIV0
 11951     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11952     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11953     MOVE X'2020233030303131343131' TO DFHEIV0(25:11)
 11954     CALL 'kxdfhei1' USING DFHEIV0,
 11955           DFHEIV20,
 11956           ELCRTT-RECORD-LENGTH,
 11957           GETMAIN-SPACE
 11958     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11959         DFHEIV20
 11960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11961
 11962
 11963* EXEC CICS HANDLE CONDITION
 11964*        NOTFND   (1386-NOTFND)
 11965*    END-EXEC.
 11966*    MOVE '"$I                   ! ( #00011417' TO DFHEIV0
 11967     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11968     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11969     MOVE X'2820233030303131343137' TO DFHEIV0(25:11)
 11970     CALL 'kxdfhei1' USING DFHEIV0
 11971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11972
 11973
 11974     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 11975     MOVE 'C'                TO ELCRTT-REC-TYPE
 11976
 11977
 11978* EXEC CICS READ
 11979*        UPDATE
 11980*        DATASET  (CRTT-ID)
 11981*        RIDFLD   (ELCRTT-KEY)
 11982*        INTO     (CERTIFICATE-TRAILERS)
 11983*    END-EXEC.
 11984     MOVE LENGTH OF
 11985      CERTIFICATE-TRAILERS
 11986       TO DFHEIV11
 11987*    MOVE '&"IL       EU         (   #00011424' TO DFHEIV0
 11988     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11989     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11990     MOVE X'2020233030303131343234' TO DFHEIV0(25:11)
 11991     CALL 'kxdfhei1' USING DFHEIV0,
 11992           CRTT-ID,
 11993           CERTIFICATE-TRAILERS,
 11994           DFHEIV11,
 11995           ELCRTT-KEY,
 11996           DFHEIV99,
 11997           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 220
* VP6311.cbl
 11998           DFHEIV99
 11999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12000
 12001
 12002     IF WS-INS-AGE-SET = 'Y'
 12003        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12004     END-IF
 12005     IF WS-JNT-AGE-SET = 'Y'
 12006        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12007     END-IF
 12008
 12009
 12010* EXEC CICS REWRITE
 12011*       DATASET  (CRTT-ID)
 12012*       FROM     (CERTIFICATE-TRAILERS)
 12013*    END-EXEC.
 12014     MOVE LENGTH OF
 12015      CERTIFICATE-TRAILERS
 12016       TO DFHEIV11
 12017*    MOVE '&& L                  %   #00011438' TO DFHEIV0
 12018     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12019     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12020     MOVE X'2020233030303131343338' TO DFHEIV0(25:11)
 12021     CALL 'kxdfhei1' USING DFHEIV0,
 12022           CRTT-ID,
 12023           CERTIFICATE-TRAILERS,
 12024           DFHEIV11,
 12025           DFHEIV99
 12026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12027
 12028
 12029     GO TO 1386-EXIT.
 12030
 12031 1386-NOTFND.
 12032
 12033     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12034     MOVE 'CS'         TO CS-RECORD-ID.
 12035     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12036     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12037     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12038     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12039     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12040
 12041* EXEC CICS WRITE
 12042*       DATASET  (CRTT-ID)
 12043*       RIDFLD   (ELCRTT-KEY)
 12044*       FROM     (CERTIFICATE-TRAILERS)
 12045*    END-EXEC.
 12046     MOVE LENGTH OF
 12047      CERTIFICATE-TRAILERS
 12048       TO DFHEIV11
 12049*    MOVE '&$ L                  ''   #00011454' TO DFHEIV0
 12050     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12051     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12052     MOVE X'2020233030303131343534' TO DFHEIV0(25:11)
 12053     CALL 'kxdfhei1' USING DFHEIV0,
 12054           CRTT-ID,
 12055           CERTIFICATE-TRAILERS,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 221
* VP6311.cbl
 12056           DFHEIV11,
 12057           ELCRTT-KEY,
 12058           DFHEIV99,
 12059           DFHEIV99
 12060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12061
 12062
 12063 1386-EXIT.
 12064     EXIT.
 12065 1390-read-elcrtt-update.
 12066
 12067* EXEC CICS GETMAIN
 12068*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12069*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12070*        INITIMG (GETMAIN-SPACE)
 12071*    END-EXEC
 12072*    MOVE ',"IL                  $   #00011463' TO DFHEIV0
 12073     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12074     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12075     MOVE X'2020233030303131343633' TO DFHEIV0(25:11)
 12076     CALL 'kxdfhei1' USING DFHEIV0,
 12077           DFHEIV20,
 12078           ELCRTT-RECORD-LENGTH,
 12079           GETMAIN-SPACE
 12080     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12081         DFHEIV20
 12082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12083
 12084* EXEC CICS READ
 12085*        UPDATE
 12086*        DATASET  (CRTT-ID)
 12087*        RIDFLD   (ELCRTT-KEY)
 12088*        INTO     (CERTIFICATE-TRAILERS)
 12089*        resp     (ws-response)
 12090*    END-EXEC
 12091     MOVE LENGTH OF
 12092      CERTIFICATE-TRAILERS
 12093       TO DFHEIV11
 12094*    MOVE '&"IL       EU         (  N#00011468' TO DFHEIV0
 12095     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12096     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12097     MOVE X'204E233030303131343638' TO DFHEIV0(25:11)
 12098     CALL 'kxdfhei1' USING DFHEIV0,
 12099           CRTT-ID,
 12100           CERTIFICATE-TRAILERS,
 12101           DFHEIV11,
 12102           ELCRTT-KEY,
 12103           DFHEIV99,
 12104           DFHEIV99,
 12105           DFHEIV99
 12106     MOVE EIBRESP  TO ws-response
 12107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12108     .
 12109 1390-exit.
 12110     exit.
 12111 1391-rewrite-elcrtt.
 12112     perform 1393-update-elcrtt  thru 1393-exit
 12113
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 222
* VP6311.cbl
 12114* EXEC CICS REWRITE
 12115*       DATASET  (CRTT-ID)
 12116*       FROM     (CERTIFICATE-TRAILERS)
 12117*       resp     (ws-response)
 12118*    END-EXEC
 12119     MOVE LENGTH OF
 12120      CERTIFICATE-TRAILERS
 12121       TO DFHEIV11
 12122*    MOVE '&& L                  %  N#00011480' TO DFHEIV0
 12123     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12124     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12125     MOVE X'204E233030303131343830' TO DFHEIV0(25:11)
 12126     CALL 'kxdfhei1' USING DFHEIV0,
 12127           CRTT-ID,
 12128           CERTIFICATE-TRAILERS,
 12129           DFHEIV11,
 12130           DFHEIV99
 12131     MOVE EIBRESP  TO ws-response
 12132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12133     .
 12134 1391-exit.
 12135     exit.
 12136 1392-write-elcrtt.
 12137     move 'CS'                   to certificate-trailers
 12138     move elcrtt-key             to cs-control-primary
 12139     move 'C'                    to cs-trailer-type
 12140     perform 1393-update-elcrtt  thru 1393-exit
 12141
 12142* EXEC CICS WRITE
 12143*       DATASET  (CRTT-ID)
 12144*       ridfld   (elcrtt-key)
 12145*       FROM     (CERTIFICATE-TRAILERS)
 12146*       resp     (ws-response)
 12147*    END-EXEC
 12148     MOVE LENGTH OF
 12149      CERTIFICATE-TRAILERS
 12150       TO DFHEIV11
 12151*    MOVE '&$ L                  ''  N#00011493' TO DFHEIV0
 12152     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12153     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12154     MOVE X'204E233030303131343933' TO DFHEIV0(25:11)
 12155     CALL 'kxdfhei1' USING DFHEIV0,
 12156           CRTT-ID,
 12157           CERTIFICATE-TRAILERS,
 12158           DFHEIV11,
 12159           elcrtt-key,
 12160           DFHEIV99,
 12161           DFHEIV99
 12162     MOVE EIBRESP  TO ws-response
 12163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12164     .
 12165 1392-exit.
 12166     exit.
 12167 1393-update-elcrtt.
 12168     if byearl <> zeros
 12169        move byeari              to cs-year
 12170     end-if
 12171     if bmakel <> zeros
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 223
* VP6311.cbl
 12172        move bmakei              to cs-make
 12173     end-if
 12174     if bmodell <> zeros
 12175        move bmodeli             to cs-model
 12176     end-if
 12177     if bometerl <> zeros
 12178        MOVE Bometeri            TO DEEDIT-FIELD
 12179        PERFORM 8600-DEEDIT
 12180        IF DEEDIT-FIELD-V0 NUMERIC
 12181           MOVE DEEDIT-FIELD-V0  TO cs-vehicle-odometer
 12182        end-if
 12183     end-if
 12184     .
 12185 1393-exit.
 12186     exit.
 12187 1398-UPDATE-ERPNDM.
 12188
 12189
 12190* EXEC CICS HANDLE CONDITION
 12191*        NOTFND (1398-EXIT)
 12192*    END-EXEC.
 12193*    MOVE '"$I                   ! ) #00011524' TO DFHEIV0
 12194     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12195     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12196     MOVE X'2920233030303131353234' TO DFHEIV0(25:11)
 12197     CALL 'kxdfhei1' USING DFHEIV0
 12198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12199
 12200
 12201     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12202
 12203
 12204* EXEC CICS READ
 12205*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12206*        DATASET (FILE-ID-ERPNDM)
 12207*        RIDFLD  (ERPNDM-KEY)
 12208*        UPDATE
 12209*    END-EXEC.
 12210*    MOVE '&"S        EU         (   #00011530' TO DFHEIV0
 12211     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12212     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12213     MOVE X'2020233030303131353330' TO DFHEIV0(25:11)
 12214     CALL 'kxdfhei1' USING DFHEIV0,
 12215           FILE-ID-ERPNDM,
 12216           DFHEIV20,
 12217           DFHEIV99,
 12218           ERPNDM-KEY,
 12219           DFHEIV99,
 12220           DFHEIV99,
 12221           DFHEIV99
 12222     SET ADDRESS OF PENDING-MAILING-DATA TO
 12223         DFHEIV20
 12224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12225
 12226
 12227     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12228     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12229     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 224
* VP6311.cbl
 12230
 12231     IF BLSTNML GREATER THAN ZEROS
 12232         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12233
 12234     IF B1STNML GREATER  THAN ZEROS
 12235         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
 12236
 12237     IF BINITL GREATER THAN ZEROS
 12238         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12239
 12240     IF BAGEL GREATER THAN ZEROS
 12241         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12242
 12243     IF BBIRTHL GREATER THAN ZEROS
 12244         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12245
 12246     IF BSEXL GREATER THAN ZEROS
 12247         MOVE  BSEXI             TO PM-INSURED-SEX.
 12248
 12249
 12250* EXEC CICS REWRITE
 12251*        DATASET (FILE-ID-ERPNDM)
 12252*        FROM    (PENDING-MAILING-DATA)
 12253*    END-EXEC.
 12254     MOVE LENGTH OF
 12255      PENDING-MAILING-DATA
 12256       TO DFHEIV11
 12257*    MOVE '&& L                  %   #00011559' TO DFHEIV0
 12258     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12259     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12260     MOVE X'2020233030303131353539' TO DFHEIV0(25:11)
 12261     CALL 'kxdfhei1' USING DFHEIV0,
 12262           FILE-ID-ERPNDM,
 12263           PENDING-MAILING-DATA,
 12264           DFHEIV11,
 12265           DFHEIV99
 12266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12267
 12268
 12269 1398-EXIT.
 12270     EXIT.
 12271
 12272******************************************************************
 12273*                                                                *
 12274*          D E L E T E   I S S U E   R O U T I N E               *
 12275*                                                                *
 12276******************************************************************
 12277
 12278 1400-DELETE-ISSUE-ROUTINE.
 12279     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12280
 12281     IF BCHGL NOT = ZEROS
 12282        MOVE ER-2196             TO EMI-ERROR
 12283        MOVE AL-UABON            TO BMAINTA
 12284        MOVE -1                  TO BMAINTL
 12285        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12286        GO TO 8200-SEND-DATAONLY.
 12287
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 225
* VP6311.cbl
 12288
 12289* EXEC CICS HANDLE CONDITION
 12290*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12291*    END-EXEC.
 12292*    MOVE '"$I                   ! * #00011583' TO DFHEIV0
 12293     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12294     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12295     MOVE X'2A20233030303131353833' TO DFHEIV0(25:11)
 12296     CALL 'kxdfhei1' USING DFHEIV0
 12297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12298
 12299
 12300     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12301     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12302     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12303
 12304
 12305* EXEC CICS READ
 12306*        SET     (ADDRESS OF PENDING-BUSINESS)
 12307*        DATASET (FILE-ID-ERPNDB)
 12308*        RIDFLD  (ERPNDB-KEY)
 12309*    END-EXEC.
 12310*    MOVE '&"S        E          (   #00011591' TO DFHEIV0
 12311     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12312     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12313     MOVE X'2020233030303131353931' TO DFHEIV0(25:11)
 12314     CALL 'kxdfhei1' USING DFHEIV0,
 12315           FILE-ID-ERPNDB,
 12316           DFHEIV20,
 12317           DFHEIV99,
 12318           ERPNDB-KEY,
 12319           DFHEIV99,
 12320           DFHEIV99,
 12321           DFHEIV99
 12322     SET ADDRESS OF PENDING-BUSINESS TO
 12323         DFHEIV20
 12324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12325
 12326
 12327     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12328
 12329     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12330
 12331     IF BSUFIXL NOT = ZEROS
 12332        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12333     ELSE
 12334        MOVE SPACE               TO WS-NEW-SUFFIX.
 12335
 12336     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12337     PERFORM 8600-DEEDIT.
 12338     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12339     MOVE '4'                    TO DC-OPTION-CODE.
 12340     PERFORM 9700-DATE-LINK.
 12341     IF DATE-CONVERSION-ERROR
 12342        MOVE ER-0348             TO EMI-ERROR
 12343        MOVE -1                  TO BEFFDTL
 12344        MOVE AL-UABON            TO BEFFDTA
 12345        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 226
* VP6311.cbl
 12346        GO TO 8200-SEND-DATAONLY
 12347     ELSE
 12348        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12349        MOVE AL-UANON            TO BEFFDTA
 12350        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12351
 12352
 12353* EXEC CICS HANDLE CONDITION
 12354*         NOTFND    (1490-RECORD-NOT-FOUND)
 12355*    END-EXEC.
 12356*    MOVE '"$I                   ! + #00011622' TO DFHEIV0
 12357     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12359     MOVE X'2B20233030303131363232' TO DFHEIV0(25:11)
 12360     CALL 'kxdfhei1' USING DFHEIV0
 12361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12362
 12363
 12364
 12365* EXEC CICS READ
 12366*        SET     (ADDRESS OF PENDING-BUSINESS)
 12367*        DATASET (FILE-ID-ERPNDB)
 12368*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12369*        UPDATE
 12370*    END-EXEC.
 12371*    MOVE '&"S        EU         (   #00011626' TO DFHEIV0
 12372     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12373     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12374     MOVE X'2020233030303131363236' TO DFHEIV0(25:11)
 12375     CALL 'kxdfhei1' USING DFHEIV0,
 12376           FILE-ID-ERPNDB,
 12377           DFHEIV20,
 12378           DFHEIV99,
 12379           PI-PREV-CONTROL-PRIMARY,
 12380           DFHEIV99,
 12381           DFHEIV99,
 12382           DFHEIV99
 12383     SET ADDRESS OF PENDING-BUSINESS TO
 12384         DFHEIV20
 12385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12386
 12387
 12388     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12389        MOVE -1                 TO BMAINTL
 12390        MOVE ER-2197            TO EMI-ERROR
 12391        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12392        GO TO 8200-SEND-DATAONLY.
 12393
 12394     IF PB-BILLED-DT NOT = LOW-VALUES
 12395        MOVE -1                 TO BMAINTL
 12396        MOVE ER-2129            TO EMI-ERROR
 12397        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12398        GO TO 8200-SEND-DATAONLY.
 12399
 12400     IF PB-CHG-COUNT NOT = ZEROS
 12401        MOVE ER-2336            TO EMI-ERROR
 12402        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12403        MOVE AL-UABON            TO BMAINTA
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 227
* VP6311.cbl
 12404        MOVE -1                  TO BMAINTL
 12405        GO TO 8200-SEND-DATAONLY.
 12406
 12407     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12408        PB-CHG-COUNT NOT = ZEROS
 12409        MOVE ER-2196             TO EMI-ERROR
 12410        MOVE AL-UABON            TO BMAINTA
 12411        MOVE -1                  TO BMAINTL
 12412        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12413        GO TO 8200-SEND-DATAONLY.
 12414******************************************************************
 12415*                                                                *
 12416*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12417*                                                                *
 12418******************************************************************
 12419     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12420     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12421     MOVE +0                     TO ELCRTO-SEQ-NO
 12422
 12423* EXEC CICS READ
 12424*       DATASET   ('ELCRTO')
 12425*       INTO      (ORIGINAL-CERTIFICATE)
 12426*       RIDFLD    (ELCRTO-KEY)
 12427*       GTEQ
 12428*       RESP      (WS-RESPONSE)
 12429*    END-EXEC
 12430     MOVE LENGTH OF
 12431      ORIGINAL-CERTIFICATE
 12432       TO DFHEIV11
 12433     MOVE 'ELCRTO' TO DFHEIV1
 12434*    MOVE '&"IL       G          (  N#00011667' TO DFHEIV0
 12435     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12436     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12437     MOVE X'204E233030303131363637' TO DFHEIV0(25:11)
 12438     CALL 'kxdfhei1' USING DFHEIV0,
 12439           DFHEIV1,
 12440           ORIGINAL-CERTIFICATE,
 12441           DFHEIV11,
 12442           ELCRTO-KEY,
 12443           DFHEIV99,
 12444           DFHEIV99,
 12445           DFHEIV99
 12446     MOVE EIBRESP  TO WS-RESPONSE
 12447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12448     IF RESP-NORMAL
 12449        AND (OC-CONTROL-PRIMARY (1:33) =
 12450                 PB-CONTROL-BY-ACCOUNT (1:33))
 12451        AND (OC-RECORD-TYPE = 'I')
 12452
 12453* EXEC CICS READ
 12454*          DATASET   ('ELCRTO')
 12455*          INTO      (ORIGINAL-CERTIFICATE)
 12456*          RIDFLD    (ELCRTO-KEY)
 12457*          UPDATE
 12458*          RESP      (WS-RESPONSE)
 12459*       END-EXEC
 12460     MOVE LENGTH OF
 12461      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 228
* VP6311.cbl
 12462       TO DFHEIV11
 12463     MOVE 'ELCRTO' TO DFHEIV1
 12464*    MOVE '&"IL       EU         (  N#00011678' TO DFHEIV0
 12465     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12466     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12467     MOVE X'204E233030303131363738' TO DFHEIV0(25:11)
 12468     CALL 'kxdfhei1' USING DFHEIV0,
 12469           DFHEIV1,
 12470           ORIGINAL-CERTIFICATE,
 12471           DFHEIV11,
 12472           ELCRTO-KEY,
 12473           DFHEIV99,
 12474           DFHEIV99,
 12475           DFHEIV99
 12476     MOVE EIBRESP  TO WS-RESPONSE
 12477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12478        IF RESP-NORMAL
 12479
 12480* EXEC CICS DELETE
 12481*             DATASET   ('ELCRTO')
 12482*          END-EXEC
 12483     MOVE 'ELCRTO' TO DFHEIV1
 12484*    MOVE '&(                    &   #00011686' TO DFHEIV0
 12485     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12486     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12487     MOVE X'2020233030303131363836' TO DFHEIV0(25:11)
 12488     CALL 'kxdfhei1' USING DFHEIV0,
 12489           DFHEIV1,
 12490           DFHEIV99,
 12491           DFHEIV99,
 12492           DFHEIV99,
 12493           DFHEIV99
 12494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12495        END-IF
 12496     END-IF
 12497******************************************************************
 12498*                                                                *
 12499*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12500*                                                                *
 12501******************************************************************
 12502
 12503* EXEC CICS HANDLE CONDITION
 12504*        NOTFND    (1405-DELETE-CERTIFICATE)
 12505*    END-EXEC.
 12506*    MOVE '"$I                   ! , #00011696' TO DFHEIV0
 12507     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12508     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12509     MOVE X'2C20233030303131363936' TO DFHEIV0(25:11)
 12510     CALL 'kxdfhei1' USING DFHEIV0
 12511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12512
 12513
 12514
 12515* EXEC CICS READ
 12516*        EQUAL
 12517*        DATASET   (FILE-ID-ERPNDM)
 12518*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12519*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 229
* VP6311.cbl
 12520*        UPDATE
 12521*    END-EXEC.
 12522*    MOVE '&"S        EU         (   #00011700' TO DFHEIV0
 12523     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12524     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12525     MOVE X'2020233030303131373030' TO DFHEIV0(25:11)
 12526     CALL 'kxdfhei1' USING DFHEIV0,
 12527           FILE-ID-ERPNDM,
 12528           DFHEIV20,
 12529           DFHEIV99,
 12530           PI-PREV-CONTROL-PRIMARY,
 12531           DFHEIV99,
 12532           DFHEIV99,
 12533           DFHEIV99
 12534     SET ADDRESS OF PENDING-MAILING-DATA TO
 12535         DFHEIV20
 12536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12537
 12538
 12539     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12540     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12541     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12542
 12543     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12544
 12545
 12546* EXEC CICS DELETE
 12547*        DATASET   (FILE-ID-ERPNDM)
 12548*    END-EXEC.
 12549*    MOVE '&(                    &   #00011714' TO DFHEIV0
 12550     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12551     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12552     MOVE X'2020233030303131373134' TO DFHEIV0(25:11)
 12553     CALL 'kxdfhei1' USING DFHEIV0,
 12554           FILE-ID-ERPNDM,
 12555           DFHEIV99,
 12556           DFHEIV99,
 12557           DFHEIV99,
 12558           DFHEIV99
 12559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12560
 12561
 12562******************************************************************
 12563*                PROCESS   CERTIFICATE                           *
 12564******************************************************************
 12565
 12566 1405-DELETE-CERTIFICATE.
 12567
 12568* EXEC CICS HANDLE CONDITION
 12569*         NOTFND  (1420-CONTINUE-DELETE)
 12570*    END-EXEC.
 12571*    MOVE '"$I                   ! - #00011723' TO DFHEIV0
 12572     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12573     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12574     MOVE X'2D20233030303131373233' TO DFHEIV0(25:11)
 12575     CALL 'kxdfhei1' USING DFHEIV0
 12576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12577
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 230
* VP6311.cbl
 12578
 12579     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12580     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12581     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12582     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12583
 12584
 12585* EXEC CICS READ
 12586*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12587*        DATASET (FILE-ID-ELCERT)
 12588*        RIDFLD  (ELCERT-KEY)
 12589*        UPDATE
 12590*    END-EXEC.
 12591*    MOVE '&"S        EU         (   #00011732' TO DFHEIV0
 12592     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12593     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12594     MOVE X'2020233030303131373332' TO DFHEIV0(25:11)
 12595     CALL 'kxdfhei1' USING DFHEIV0,
 12596           FILE-ID-ELCERT,
 12597           DFHEIV20,
 12598           DFHEIV99,
 12599           ELCERT-KEY,
 12600           DFHEIV99,
 12601           DFHEIV99,
 12602           DFHEIV99
 12603     SET ADDRESS OF CERTIFICATE-MASTER TO
 12604         DFHEIV20
 12605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12606
 12607
 12608     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12609
 12610     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12611     MOVE 'B'                    TO JP-RECORD-TYPE
 12612     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12613
 12614     PERFORM 8400-LOG-JOURNAL-RECORD.
 12615
 12616     IF CERT-NOTES-ARE-NOT-PRESENT
 12617        MOVE ' '                 TO WS-CERT-NOTE-SW
 12618     ELSE
 12619        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12620
 12621     IF INSURED-ADDR-PRESENT
 12622        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12623
 12624******************************************************************
 12625******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12626******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12627******************************************************************
 12628******************************************************************
 12629
 12630     IF CERT-ADDED-BATCH AND
 12631        (NOT NO-CLAIM-ATTACHED
 12632         OR
 12633         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12634        GO TO 1410-REWRITE-CERT.
 12635
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 231
* VP6311.cbl
 12636******************************************************************
 12637******************************************************************
 12638
 12639     IF CERT-ADDED-BATCH  AND
 12640        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12641        GO TO 1410-REWRITE-CERT.
 12642
 12643     IF NO-CLAIM-ATTACHED
 12644        NEXT SENTENCE
 12645     ELSE
 12646        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12647        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12648        GO TO 1410-REWRITE-CERT.
 12649
 12650     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12651     MOVE 'D'                      TO JP-RECORD-TYPE.
 12652     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12653
 12654
 12655* EXEC CICS DELETE
 12656*         DATASET    (FILE-ID-ELCERT)
 12657*    END-EXEC.
 12658*    MOVE '&(                    &   #00011785' TO DFHEIV0
 12659     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12660     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12661     MOVE X'2020233030303131373835' TO DFHEIV0(25:11)
 12662     CALL 'kxdfhei1' USING DFHEIV0,
 12663           FILE-ID-ELCERT,
 12664           DFHEIV99,
 12665           DFHEIV99,
 12666           DFHEIV99,
 12667           DFHEIV99
 12668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12669
 12670
 12671     PERFORM 8400-LOG-JOURNAL-RECORD.
 12672
 12673******************************************************************
 12674*                                                                *
 12675*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12676*                                                                *
 12677******************************************************************
 12678
 12679     IF  CERT-NOTES-ARE-PRESENT
 12680         NEXT SENTENCE
 12681     ELSE
 12682         GO TO 1407-DELETE-MAILING.
 12683
 12684
 12685* EXEC CICS HANDLE CONDITION
 12686*         NOTFND  (1406-DELETE-ERNOTE)
 12687*    END-EXEC.
 12688*    MOVE '"$I                   ! . #00011802' TO DFHEIV0
 12689     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12690     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12691     MOVE X'2E20233030303131383032' TO DFHEIV0(25:11)
 12692     CALL 'kxdfhei1' USING DFHEIV0
 12693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 232
* VP6311.cbl
 12694
 12695
 12696     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12697     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12698     MOVE 0                     TO ERCNOT-SEQUENCE.
 12699
 12700 1406-DELETE-ERCNOT-LOOP.
 12701
 12702
 12703* EXEC CICS READ
 12704*        GTEQ
 12705*        DATASET   (FILE-ID-ERCNOT)
 12706*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12707*        RIDFLD    (ERCNOT-KEY)
 12708*    END-EXEC.
 12709*    MOVE '&"S        G          (   #00011812' TO DFHEIV0
 12710     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12711     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12712     MOVE X'2020233030303131383132' TO DFHEIV0(25:11)
 12713     CALL 'kxdfhei1' USING DFHEIV0,
 12714           FILE-ID-ERCNOT,
 12715           DFHEIV20,
 12716           DFHEIV99,
 12717           ERCNOT-KEY,
 12718           DFHEIV99,
 12719           DFHEIV99,
 12720           DFHEIV99
 12721     SET ADDRESS OF CERT-NOTE-FILE TO
 12722         DFHEIV20
 12723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12724
 12725
 12726     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12727     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12728         GO TO 1406-DELETE-ERNOTE
 12729     END-IF.
 12730
 12731     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12732     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12733     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12734
 12735     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12736
 12737
 12738* EXEC CICS DELETE
 12739*        DATASET   (FILE-ID-ERCNOT)
 12740*        RIDFLD    (ERCNOT-KEY)
 12741*        END-EXEC.
 12742*    MOVE '&(  R                 &   #00011830' TO DFHEIV0
 12743     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12744     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12745     MOVE X'2020233030303131383330' TO DFHEIV0(25:11)
 12746     CALL 'kxdfhei1' USING DFHEIV0,
 12747           FILE-ID-ERCNOT,
 12748           ERCNOT-KEY,
 12749           DFHEIV99,
 12750           DFHEIV99,
 12751           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 233
* VP6311.cbl
 12752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12753
 12754
 12755     PERFORM 8400-LOG-JOURNAL-RECORD.
 12756
 12757     GO TO 1406-DELETE-ERCNOT-LOOP.
 12758
 12759 1406-DELETE-ERNOTE.
 12760
 12761
 12762* EXEC CICS HANDLE CONDITION
 12763*         NOTFND  (1407-DELETE-MAILING)
 12764*    END-EXEC.
 12765*    MOVE '"$I                   ! / #00011841' TO DFHEIV0
 12766     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12767     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12768     MOVE X'2F20233030303131383431' TO DFHEIV0(25:11)
 12769     CALL 'kxdfhei1' USING DFHEIV0
 12770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12771
 12772
 12773
 12774* EXEC CICS READ
 12775*        EQUAL
 12776*        DATASET   (FILE-ID-ERNOTE)
 12777*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12778*        RIDFLD    (ELCERT-KEY)
 12779*        UPDATE
 12780*    END-EXEC.
 12781*    MOVE '&"S        EU         (   #00011845' TO DFHEIV0
 12782     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12783     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12784     MOVE X'2020233030303131383435' TO DFHEIV0(25:11)
 12785     CALL 'kxdfhei1' USING DFHEIV0,
 12786           FILE-ID-ERNOTE,
 12787           DFHEIV20,
 12788           DFHEIV99,
 12789           ELCERT-KEY,
 12790           DFHEIV99,
 12791           DFHEIV99,
 12792           DFHEIV99
 12793     SET ADDRESS OF CERTIFICATE-NOTE TO
 12794         DFHEIV20
 12795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12796
 12797
 12798     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12799     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12800     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12801
 12802     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12803
 12804
 12805* EXEC CICS DELETE
 12806*        DATASET   (FILE-ID-ERNOTE)
 12807*        END-EXEC.
 12808*    MOVE '&(                    &   #00011859' TO DFHEIV0
 12809     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 234
* VP6311.cbl
 12810     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12811     MOVE X'2020233030303131383539' TO DFHEIV0(25:11)
 12812     CALL 'kxdfhei1' USING DFHEIV0,
 12813           FILE-ID-ERNOTE,
 12814           DFHEIV99,
 12815           DFHEIV99,
 12816           DFHEIV99,
 12817           DFHEIV99
 12818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12819
 12820
 12821     PERFORM 8400-LOG-JOURNAL-RECORD.
 12822
 12823******************************************************************
 12824*                                                                *
 12825*                DELETE MAILING ADDRESS RECORDS                  *
 12826*                                                                *
 12827******************************************************************
 12828
 12829 1407-DELETE-MAILING.
 12830     IF CERT-ADDRESS-PRESENT
 12831        NEXT SENTENCE
 12832     ELSE
 12833        GO TO 1420-CONTINUE-DELETE.
 12834
 12835
 12836* EXEC CICS HANDLE CONDITION
 12837*         NOTFND  (1420-CONTINUE-DELETE)
 12838*    END-EXEC.
 12839*    MOVE '"$I                   ! 0 #00011877' TO DFHEIV0
 12840     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12841     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12842     MOVE X'3020233030303131383737' TO DFHEIV0(25:11)
 12843     CALL 'kxdfhei1' USING DFHEIV0
 12844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12845
 12846
 12847
 12848* EXEC CICS READ
 12849*        EQUAL
 12850*        DATASET   (FILE-ID-ERMAIL)
 12851*        SET       (ADDRESS OF MAILING-DATA)
 12852*        RIDFLD    (ELCERT-KEY)
 12853*        UPDATE
 12854*    END-EXEC.
 12855*    MOVE '&"S        EU         (   #00011881' TO DFHEIV0
 12856     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12857     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12858     MOVE X'2020233030303131383831' TO DFHEIV0(25:11)
 12859     CALL 'kxdfhei1' USING DFHEIV0,
 12860           FILE-ID-ERMAIL,
 12861           DFHEIV20,
 12862           DFHEIV99,
 12863           ELCERT-KEY,
 12864           DFHEIV99,
 12865           DFHEIV99,
 12866           DFHEIV99
 12867     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 235
* VP6311.cbl
 12868         DFHEIV20
 12869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12870
 12871
 12872     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12873     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12874     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12875
 12876     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12877
 12878
 12879* EXEC CICS DELETE
 12880*        DATASET   (FILE-ID-ERMAIL)
 12881*    END-EXEC.
 12882*    MOVE '&(                    &   #00011895' TO DFHEIV0
 12883     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12884     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12885     MOVE X'2020233030303131383935' TO DFHEIV0(25:11)
 12886     CALL 'kxdfhei1' USING DFHEIV0,
 12887           FILE-ID-ERMAIL,
 12888           DFHEIV99,
 12889           DFHEIV99,
 12890           DFHEIV99,
 12891           DFHEIV99
 12892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12893
 12894
 12895     GO TO 1420-CONTINUE-DELETE.
 12896
 12897 1410-REWRITE-CERT.
 12898     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12899     MOVE 'C'                      TO JP-RECORD-TYPE.
 12900     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12901     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12902
 12903
 12904* EXEC CICS REWRITE
 12905*         DATASET    (FILE-ID-ELCERT)
 12906*         FROM       (CERTIFICATE-MASTER)
 12907*         END-EXEC.
 12908     MOVE LENGTH OF
 12909      CERTIFICATE-MASTER
 12910       TO DFHEIV11
 12911*    MOVE '&& L                  %   #00011907' TO DFHEIV0
 12912     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12913     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12914     MOVE X'2020233030303131393037' TO DFHEIV0(25:11)
 12915     CALL 'kxdfhei1' USING DFHEIV0,
 12916           FILE-ID-ELCERT,
 12917           CERTIFICATE-MASTER,
 12918           DFHEIV11,
 12919           DFHEIV99
 12920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12921
 12922
 12923     PERFORM 8400-LOG-JOURNAL-RECORD.
 12924
 12925 1420-CONTINUE-DELETE.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 236
* VP6311.cbl
 12926     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12927     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12928
 12929     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12930     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12931
 12932     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12933
 12934 1450-DELETE-PB-RECORD.
 12935     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12936     MOVE 'D'                      TO JP-RECORD-TYPE
 12937     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12938
 12939
 12940* EXEC CICS DELETE
 12941*        DATASET    (FILE-ID-ERPNDB)
 12942*    END-EXEC.
 12943*    MOVE '&(                    &   #00011928' TO DFHEIV0
 12944     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12945     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12946     MOVE X'2020233030303131393238' TO DFHEIV0(25:11)
 12947     CALL 'kxdfhei1' USING DFHEIV0,
 12948           FILE-ID-ERPNDB,
 12949           DFHEIV99,
 12950           DFHEIV99,
 12951           DFHEIV99,
 12952           DFHEIV99
 12953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12954
 12955
 12956     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12957
 12958     PERFORM 8400-LOG-JOURNAL-RECORD.
 12959
 12960     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12961     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12962     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12963
 12964
 12965* EXEC CICS HANDLE CONDITION
 12966*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12967*    END-EXEC.
 12968*    MOVE '"$I                   ! 1 #00011940' TO DFHEIV0
 12969     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12970     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12971     MOVE X'3120233030303131393430' TO DFHEIV0(25:11)
 12972     CALL 'kxdfhei1' USING DFHEIV0
 12973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12974
 12975
 12976
 12977* EXEC CICS READ
 12978*        SET     (ADDRESS OF PENDING-BUSINESS)
 12979*        DATASET (FILE-ID-ERPNDB)
 12980*        RIDFLD  (ERPNDB-KEY)
 12981*        UPDATE
 12982*    END-EXEC.
 12983*    MOVE '&"S        EU         (   #00011944' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 237
* VP6311.cbl
 12984     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12985     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12986     MOVE X'2020233030303131393434' TO DFHEIV0(25:11)
 12987     CALL 'kxdfhei1' USING DFHEIV0,
 12988           FILE-ID-ERPNDB,
 12989           DFHEIV20,
 12990           DFHEIV99,
 12991           ERPNDB-KEY,
 12992           DFHEIV99,
 12993           DFHEIV99,
 12994           DFHEIV99
 12995     SET ADDRESS OF PENDING-BUSINESS TO
 12996         DFHEIV20
 12997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12998
 12999
 13000     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13001
 13002     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13003
 13004     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13005        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13006        MOVE 'D'                   TO JP-RECORD-TYPE
 13007        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13008
 13009* EXEC CICS DELETE
 13010*            DATASET    (FILE-ID-ERPNDB)
 13011*       END-EXEC
 13012*    MOVE '&(                    &   #00011959' TO DFHEIV0
 13013     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13014     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13015     MOVE X'2020233030303131393539' TO DFHEIV0(25:11)
 13016     CALL 'kxdfhei1' USING DFHEIV0,
 13017           FILE-ID-ERPNDB,
 13018           DFHEIV99,
 13019           DFHEIV99,
 13020           DFHEIV99,
 13021           DFHEIV99
 13022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13023        PERFORM 8400-LOG-JOURNAL-RECORD
 13024     ELSE
 13025        MOVE 'B'                 TO JP-RECORD-TYPE
 13026        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13027        PERFORM 8400-LOG-JOURNAL-RECORD
 13028        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13029        MOVE 'C'                 TO JP-RECORD-TYPE
 13030        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13031
 13032* EXEC CICS REWRITE
 13033*            DATASET    (FILE-ID-ERPNDB)
 13034*            FROM       (PENDING-BUSINESS)
 13035*       END-EXEC
 13036     MOVE LENGTH OF
 13037      PENDING-BUSINESS
 13038       TO DFHEIV11
 13039*    MOVE '&& L                  %   #00011970' TO DFHEIV0
 13040     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13041     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 238
* VP6311.cbl
 13042     MOVE X'2020233030303131393730' TO DFHEIV0(25:11)
 13043     CALL 'kxdfhei1' USING DFHEIV0,
 13044           FILE-ID-ERPNDB,
 13045           PENDING-BUSINESS,
 13046           DFHEIV11,
 13047           DFHEIV99
 13048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13049        PERFORM 8400-LOG-JOURNAL-RECORD.
 13050
 13051******************************************************************
 13052*                                                                *
 13053*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13054*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13055*                                                                *
 13056******************************************************************
 13057
 13058     IF NOT PI-AR-PROCESSING
 13059        GO TO 1475-DELETE-FINISHED.
 13060
 13061     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13062        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13063        NEXT SENTENCE
 13064     ELSE
 13065        GO TO 1475-DELETE-FINISHED.
 13066
 13067
 13068* EXEC CICS HANDLE CONDITION
 13069*         NOTFND    (1475-DELETE-FINISHED)
 13070*         END-EXEC.
 13071*    MOVE '"$I                   ! 2 #00011992' TO DFHEIV0
 13072     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13074     MOVE X'3220233030303131393932' TO DFHEIV0(25:11)
 13075     CALL 'kxdfhei1' USING DFHEIV0
 13076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13077
 13078
 13079     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13080     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13081
 13082
 13083* EXEC CICS READ
 13084*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13085*        DATASET (FILE-ID-ERRQST)
 13086*        RIDFLD  (ERRQST-KEY)
 13087*        UPDATE
 13088*    END-EXEC.
 13089*    MOVE '&"S        EU         (   #00011999' TO DFHEIV0
 13090     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13091     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13092     MOVE X'2020233030303131393939' TO DFHEIV0(25:11)
 13093     CALL 'kxdfhei1' USING DFHEIV0,
 13094           FILE-ID-ERRQST,
 13095           DFHEIV20,
 13096           DFHEIV99,
 13097           ERRQST-KEY,
 13098           DFHEIV99,
 13099           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 239
* VP6311.cbl
 13100           DFHEIV99
 13101     SET ADDRESS OF AR-REQUEST-RECORD TO
 13102         DFHEIV20
 13103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13104
 13105
 13106     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13107
 13108     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13109
 13110     MOVE 'D'                      TO JP-RECORD-TYPE.
 13111     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13112
 13113
 13114* EXEC CICS DELETE
 13115*         DATASET    (FILE-ID-ERRQST)
 13116*    END-EXEC.
 13117*    MOVE '&(                    &   #00012013' TO DFHEIV0
 13118     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13119     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13120     MOVE X'2020233030303132303133' TO DFHEIV0(25:11)
 13121     CALL 'kxdfhei1' USING DFHEIV0,
 13122           FILE-ID-ERRQST,
 13123           DFHEIV99,
 13124           DFHEIV99,
 13125           DFHEIV99,
 13126           DFHEIV99
 13127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13128
 13129
 13130     PERFORM 8400-LOG-JOURNAL-RECORD.
 13131
 13132 1475-DELETE-FINISHED.
 13133     MOVE ZEROS                  TO EMI-ERROR.
 13134     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13135     MOVE LOW-VALUES             TO VP631BI.
 13136     MOVE -1                     TO BMAINTL.
 13137     GO TO 8100-SEND-INITIAL-MAP.
 13138
 13139 1480-BATCH-HDR-NOT-FOUND.
 13140     MOVE -1                     TO BMAINTL.
 13141     MOVE ER-7450                TO EMI-ERROR.
 13142     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13143     GO TO 8200-SEND-DATAONLY.
 13144
 13145 1490-RECORD-NOT-FOUND.
 13146     MOVE -1                     TO BMAINTL.
 13147     MOVE ER-7451                TO EMI-ERROR.
 13148     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13149     GO TO 8200-SEND-DATAONLY.
 13150
 13151******************************************************************
 13152*            O V E R   C H A R G E   P R O C E S S I N G         *
 13153******************************************************************
 13154 1500-UPDATE-ERNOTE.
 13155     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13156     MOVE 'A'                    TO WS-NOTE-SW
 13157     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 240
* VP6311.cbl
 13158     .
 13159 1500-EXIT.
 13160     EXIT.
 13161 1510-ADD-ERNOTE-REC.
 13162
 13163* EXEC CICS GETMAIN
 13164*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13165*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13166*        INITIMG (GETMAIN-SPACE)
 13167*    END-EXEC
 13168*    MOVE ',"IL                  $   #00012049' TO DFHEIV0
 13169     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13170     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13171     MOVE X'2020233030303132303439' TO DFHEIV0(25:11)
 13172     CALL 'kxdfhei1' USING DFHEIV0,
 13173           DFHEIV20,
 13174           ERNOTE-RECORD-LENGTH,
 13175           GETMAIN-SPACE
 13176     SET ADDRESS OF CERTIFICATE-NOTE TO
 13177         DFHEIV20
 13178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13179     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13180                                 TO ERNOTE-KEY
 13181
 13182* EXEC CICS READ
 13183*       DATASET    (FILE-ID-ERNOTE)
 13184*       RIDFLD     (ERNOTE-KEY)
 13185*       INTO       (CERTIFICATE-NOTE)
 13186*       RESP       (WS-RESPONSE)
 13187*       UPDATE
 13188*    END-EXEC
 13189     MOVE LENGTH OF
 13190      CERTIFICATE-NOTE
 13191       TO DFHEIV11
 13192*    MOVE '&"IL       EU         (  N#00012056' TO DFHEIV0
 13193     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13194     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13195     MOVE X'204E233030303132303536' TO DFHEIV0(25:11)
 13196     CALL 'kxdfhei1' USING DFHEIV0,
 13197           FILE-ID-ERNOTE,
 13198           CERTIFICATE-NOTE,
 13199           DFHEIV11,
 13200           ERNOTE-KEY,
 13201           DFHEIV99,
 13202           DFHEIV99,
 13203           DFHEIV99
 13204     MOVE EIBRESP  TO WS-RESPONSE
 13205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13206     IF RESP-NORMAL
 13207        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13208           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13209        END-IF
 13210        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13211           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13212        END-IF
 13213        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13214           (N1 > +10)
 13215           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 241
* VP6311.cbl
 13216           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13217        END-PERFORM
 13218        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13219          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13220
 13221* EXEC CICS UNLOCK
 13222*            DATASET    (FILE-ID-ERNOTE)
 13223*          END-EXEC
 13224*    MOVE '&*                    #   #00012077' TO DFHEIV0
 13225     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13226     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13227     MOVE X'2020233030303132303737' TO DFHEIV0(25:11)
 13228     CALL 'kxdfhei1' USING DFHEIV0,
 13229           FILE-ID-ERNOTE,
 13230           DFHEIV99
 13231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13232        ELSE
 13233          PERFORM VARYING N1 FROM +1 BY +1
 13234           UNTIL (N1 > +10)
 13235           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13236          END-PERFORM
 13237          IF (N1 < +11)
 13238            IF N1 >= CN-BILLING-START-LINE-NO AND
 13239              N1 <= CN-BILLING-END-LINE-NO
 13240              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13241                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13242              ELSE
 13243                 MOVE WS-VA-NO-COMM-MESS
 13244                                    TO CN-LINE (N1)
 13245              END-IF
 13246            ELSE
 13247              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13248               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13249                IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13250                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13251                ELSE
 13252                  MOVE WS-VA-NO-COMM-MESS
 13253                                    TO CN-LINE (N1)
 13254                END-IF
 13255                MOVE N1             TO CN-BILLING-END-LINE-NO
 13256              ELSE
 13257                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13258                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13259                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13260                  ELSE
 13261                     MOVE WS-VA-NO-COMM-MESS
 13262                                    TO CN-LINE (N1)
 13263                  END-IF
 13264                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13265                                      CN-BILLING-START-LINE-NO
 13266                ELSE
 13267                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13268                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13269                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13270                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13271                     ELSE
 13272                       MOVE WS-VA-NO-COMM-MESS
 13273                                    TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 242
* VP6311.cbl
 13274                     END-IF
 13275                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13276                  ELSE
 13277                     PERFORM 1700-SQUEEZE-IT-IN
 13278                                 THRU 1700-EXIT
 13279                  END-IF
 13280                END-IF
 13281              END-IF
 13282            END-IF
 13283            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13284            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13285            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13286
 13287* EXEC CICS REWRITE
 13288*              DATASET    (FILE-ID-ERNOTE)
 13289*              FROM       (CERTIFICATE-NOTE)
 13290*              RESP       (WS-RESPONSE)
 13291*           END-EXEC
 13292     MOVE LENGTH OF
 13293      CERTIFICATE-NOTE
 13294       TO DFHEIV11
 13295*    MOVE '&& L                  %  N#00012134' TO DFHEIV0
 13296     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13297     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13298     MOVE X'204E233030303132313334' TO DFHEIV0(25:11)
 13299     CALL 'kxdfhei1' USING DFHEIV0,
 13300           FILE-ID-ERNOTE,
 13301           CERTIFICATE-NOTE,
 13302           DFHEIV11,
 13303           DFHEIV99
 13304     MOVE EIBRESP  TO WS-RESPONSE
 13305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13306          END-IF
 13307        END-IF
 13308     ELSE
 13309        MOVE SPACES              TO CERTIFICATE-NOTE
 13310        MOVE 'CN'                TO CN-RECORD-ID
 13311        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13312                                 TO CN-CONTROL-PRIMARY
 13313                                    ERNOTE-KEY
 13314        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13315                                    CN-BILLING-END-LINE-NO
 13316        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13317           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13318        ELSE
 13319           MOVE WS-VA-NO-COMM-MESS
 13320                                 TO CN-LINE (1)
 13321        END-IF
 13322        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13323        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13324        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13325
 13326* EXEC CICS WRITE
 13327*          DATASET    (FILE-ID-ERNOTE)
 13328*          FROM       (CERTIFICATE-NOTE)
 13329*          RIDFLD     (ERNOTE-KEY)
 13330*          RESP       (WS-RESPONSE)
 13331*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 243
* VP6311.cbl
 13332     MOVE LENGTH OF
 13333      CERTIFICATE-NOTE
 13334       TO DFHEIV11
 13335*    MOVE '&$ L                  ''  N#00012158' TO DFHEIV0
 13336     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13337     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13338     MOVE X'204E233030303132313538' TO DFHEIV0(25:11)
 13339     CALL 'kxdfhei1' USING DFHEIV0,
 13340           FILE-ID-ERNOTE,
 13341           CERTIFICATE-NOTE,
 13342           DFHEIV11,
 13343           ERNOTE-KEY,
 13344           DFHEIV99,
 13345           DFHEIV99
 13346     MOVE EIBRESP  TO WS-RESPONSE
 13347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13348     END-IF
 13349     .
 13350 1510-EXIT.
 13351     EXIT.
 13352 1520-UPDATE-ELCERT.
 13353     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13354                                 TO ELCERT-KEY
 13355
 13356* EXEC CICS READ
 13357*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13358*        DATASET (FILE-ID-ELCERT)
 13359*        RIDFLD  (ELCERT-KEY)
 13360*        UPDATE
 13361*        RESP    (WS-RESPONSE)
 13362*    END-EXEC
 13363*    MOVE '&"S        EU         (  N#00012171' TO DFHEIV0
 13364     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13365     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13366     MOVE X'204E233030303132313731' TO DFHEIV0(25:11)
 13367     CALL 'kxdfhei1' USING DFHEIV0,
 13368           FILE-ID-ELCERT,
 13369           DFHEIV20,
 13370           DFHEIV99,
 13371           ELCERT-KEY,
 13372           DFHEIV99,
 13373           DFHEIV99,
 13374           DFHEIV99
 13375     SET ADDRESS OF CERTIFICATE-MASTER TO
 13376         DFHEIV20
 13377     MOVE EIBRESP  TO WS-RESPONSE
 13378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13379     IF RESP-NORMAL
 13380        IF WS-NOTE-SW = 'A'
 13381           IF CM-NOTE-SW = ' '
 13382              MOVE '2'             TO CM-NOTE-SW
 13383           ELSE
 13384             IF CM-NOTE-SW = '1'
 13385                MOVE '3'           TO CM-NOTE-SW
 13386             ELSE
 13387               IF CM-NOTE-SW = '4'
 13388                  MOVE '6'         TO CM-NOTE-SW
 13389               ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 244
* VP6311.cbl
 13390                 IF CM-NOTE-SW = '5'
 13391                    MOVE '7'       TO CM-NOTE-SW
 13392                 END-IF
 13393               END-IF
 13394             END-IF
 13395           END-IF
 13396        ELSE
 13397           IF CM-NOTE-SW = '2'
 13398              MOVE ' '             TO CM-NOTE-SW
 13399           ELSE
 13400             IF CM-NOTE-SW = '3'
 13401                MOVE '1'           TO CM-NOTE-SW
 13402             ELSE
 13403               IF CM-NOTE-SW = '6'
 13404                  MOVE '4'         TO CM-NOTE-SW
 13405               ELSE
 13406                 IF CM-NOTE-SW = '7'
 13407                    MOVE '5'       TO CM-NOTE-SW
 13408                 END-IF
 13409               END-IF
 13410             END-IF
 13411           END-IF
 13412        END-IF
 13413
 13414* EXEC CICS REWRITE
 13415*          DATASET    (FILE-ID-ELCERT)
 13416*          FROM       (CERTIFICATE-MASTER)
 13417*          RESP       (WS-RESPONSE)
 13418*       END-EXEC
 13419     MOVE LENGTH OF
 13420      CERTIFICATE-MASTER
 13421       TO DFHEIV11
 13422*    MOVE '&& L                  %  N#00012212' TO DFHEIV0
 13423     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13424     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13425     MOVE X'204E233030303132323132' TO DFHEIV0(25:11)
 13426     CALL 'kxdfhei1' USING DFHEIV0,
 13427           FILE-ID-ELCERT,
 13428           CERTIFICATE-MASTER,
 13429           DFHEIV11,
 13430           DFHEIV99
 13431     MOVE EIBRESP  TO WS-RESPONSE
 13432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13433        IF RESP-NORMAL
 13434           CONTINUE
 13435        ELSE
 13436           MOVE WS-RESPONSE TO EMI-ERROR
 13437           PERFORM 9900-ERROR-FORMAT
 13438                                 THRU 9900-EXIT
 13439           GO TO 8200-SEND-DATAONLY
 13440        END-IF
 13441     ELSE
 13442        MOVE -1                  TO BMAINTL
 13443        MOVE 0249                TO EMI-ERROR
 13444        PERFORM 9900-ERROR-FORMAT
 13445                                 THRU 9900-EXIT
 13446        GO TO 8200-SEND-DATAONLY
 13447     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 245
* VP6311.cbl
 13448     .
 13449 1520-EXIT.
 13450     EXIT.
 13451 1600-UPDATE-ERPYAJ.
 13452     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13453                                 THRU 1610-EXIT
 13454     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13455                                 THRU 1620-EXIT
 13456     .
 13457 1600-EXIT.
 13458     EXIT.
 13459 1610-ADD-ERPYAJ-BANK-REC.
 13460
 13461* EXEC CICS GETMAIN
 13462*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13463*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13464*        INITIMG (GETMAIN-SPACE)
 13465*    END-EXEC
 13466*    MOVE ',"IL                  $   #00012244' TO DFHEIV0
 13467     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13468     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13469     MOVE X'2020233030303132323434' TO DFHEIV0(25:11)
 13470     CALL 'kxdfhei1' USING DFHEIV0,
 13471           DFHEIV20,
 13472           ERPYAJ-RECORD-LENGTH,
 13473           GETMAIN-SPACE
 13474     SET ADDRESS OF PENDING-PAY-ADJ TO
 13475         DFHEIV20
 13476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13477     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13478     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13479     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13480     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13481     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13482     MOVE +10                    TO ERPYAJ-SEQ-NO
 13483     MOVE 'R'                    TO ERPYAJ-TYPE
 13484     IF REVERSAL
 13485        MOVE 'C'                 TO ERPYAJ-TYPE
 13486     END-IF
 13487     MOVE SPACES                 TO PENDING-PAY-ADJ
 13488     MOVE 'PY'                   TO PY-RECORD-ID
 13489     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13490     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13491     IF REVERSAL
 13492        MOVE PB-I-DCC-OVER-CHG-AMT
 13493                                 TO PY-ENTRY-AMT
 13494     END-IF
 13495     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13496                                    PY-INPUT-DT
 13497*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13498*                                   PY-INPUT-DT
 13499     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13500     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13501     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13502     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13503     IF PB-CARRIER = '2'
 13504        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13505     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 246
* VP6311.cbl
 13506        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13507     END-IF
 13508     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13509                                    PY-BILLED-DATE
 13510                                    PY-AR-DATE
 13511                                    PY-REPORTED-DT
 13512                                    PY-CHECK-WRITTEN-DT
 13513     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13514                                    PY-CHECK-QUE-SEQUENCE
 13515     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13516     PERFORM WITH TEST AFTER
 13517        UNTIL (NOT RESP-DUPKEY)
 13518           AND (NOT RESP-DUPREC)
 13519
 13520* EXEC CICS WRITE
 13521*          DATASET    (FILE-ID-ERPYAJ)
 13522*          FROM       (PENDING-PAY-ADJ)
 13523*          RIDFLD     (ERPYAJ-KEY)
 13524*          RESP       (WS-RESPONSE)
 13525*       END-EXEC
 13526     MOVE LENGTH OF
 13527      PENDING-PAY-ADJ
 13528       TO DFHEIV11
 13529*    MOVE '&$ L                  ''  N#00012291' TO DFHEIV0
 13530     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13531     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13532     MOVE X'204E233030303132323931' TO DFHEIV0(25:11)
 13533     CALL 'kxdfhei1' USING DFHEIV0,
 13534           FILE-ID-ERPYAJ,
 13535           PENDING-PAY-ADJ,
 13536           DFHEIV11,
 13537           ERPYAJ-KEY,
 13538           DFHEIV99,
 13539           DFHEIV99
 13540     MOVE EIBRESP  TO WS-RESPONSE
 13541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13542        IF RESP-DUPKEY OR RESP-DUPREC
 13543           ADD +1                TO ERPYAJ-SEQ-NO
 13544           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13545        END-IF
 13546     END-PERFORM
 13547     .
 13548 1610-EXIT.
 13549     EXIT.
 13550 1620-ADD-ERPYAJ-DLR-REC.
 13551     MOVE 'C'                    TO ERPYAJ-TYPE
 13552     IF REVERSAL
 13553        MOVE 'R'                 TO ERPYAJ-TYPE
 13554     END-IF
 13555     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13556                                    ERPYAJ-ACCOUNT
 13557     ADD +1                      TO ERPYAJ-SEQ-NO
 13558     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13559     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13560     IF PB-CARRIER = '2'
 13561        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13562     ELSE
 13563        MOVE '2725040130'        TO PY-GL-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 247
* VP6311.cbl
 13564     END-IF
 13565     PERFORM WITH TEST AFTER
 13566        UNTIL (NOT RESP-DUPKEY)
 13567           AND (NOT RESP-DUPREC)
 13568
 13569* EXEC CICS WRITE
 13570*          DATASET    (FILE-ID-ERPYAJ)
 13571*          FROM       (PENDING-PAY-ADJ)
 13572*          RIDFLD     (ERPYAJ-KEY)
 13573*          RESP       (WS-RESPONSE)
 13574*       END-EXEC
 13575     MOVE LENGTH OF
 13576      PENDING-PAY-ADJ
 13577       TO DFHEIV11
 13578*    MOVE '&$ L                  ''  N#00012323' TO DFHEIV0
 13579     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13580     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13581     MOVE X'204E233030303132333233' TO DFHEIV0(25:11)
 13582     CALL 'kxdfhei1' USING DFHEIV0,
 13583           FILE-ID-ERPYAJ,
 13584           PENDING-PAY-ADJ,
 13585           DFHEIV11,
 13586           ERPYAJ-KEY,
 13587           DFHEIV99,
 13588           DFHEIV99
 13589     MOVE EIBRESP  TO WS-RESPONSE
 13590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13591        IF RESP-DUPKEY OR RESP-DUPREC
 13592           ADD +1                TO ERPYAJ-SEQ-NO
 13593           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13594        END-IF
 13595     END-PERFORM
 13596     .
 13597 1620-EXIT.
 13598     EXIT.
 13599 1700-SQUEEZE-IT-IN.
 13600     IF (N1 > CN-BILLING-END-LINE-NO)
 13601        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13602           N1 = +1
 13603           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13604           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13605              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13606                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13607              ELSE
 13608                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13609              END-IF
 13610              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13611              MOVE +2 TO N1
 13612           END-IF
 13613        END-PERFORM
 13614     ELSE
 13615        IF (N1 < CN-BILLING-START-LINE-NO)
 13616           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13617              N1 = +10
 13618              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13619              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13620                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13621                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 248
* VP6311.cbl
 13622                 ELSE
 13623                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13624                 END-IF
 13625                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13626                 MOVE +9 TO N1
 13627              END-IF
 13628           END-PERFORM
 13629        END-IF
 13630     END-IF
 13631     .
 13632 1700-EXIT.
 13633     EXIT.
 13634 1800-REMOVE-CERT-NOTES.
 13635     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13636                                 TO ERNOTE-KEY
 13637
 13638* EXEC CICS READ
 13639*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13640*       DATASET    (FILE-ID-ERNOTE)
 13641*       RIDFLD     (ERNOTE-KEY)
 13642*       RESP       (WS-RESPONSE)
 13643*       UPDATE
 13644*    END-EXEC
 13645*    MOVE '&"S        EU         (  N#00012375' TO DFHEIV0
 13646     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13647     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13648     MOVE X'204E233030303132333735' TO DFHEIV0(25:11)
 13649     CALL 'kxdfhei1' USING DFHEIV0,
 13650           FILE-ID-ERNOTE,
 13651           DFHEIV20,
 13652           DFHEIV99,
 13653           ERNOTE-KEY,
 13654           DFHEIV99,
 13655           DFHEIV99,
 13656           DFHEIV99
 13657     SET ADDRESS OF CERTIFICATE-NOTE TO
 13658         DFHEIV20
 13659     MOVE EIBRESP  TO WS-RESPONSE
 13660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13661     IF RESP-NORMAL
 13662        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13663           (N1 > +10)
 13664           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13665           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13666        END-PERFORM
 13667        IF N1 < +11
 13668           MOVE SPACES              TO CN-LINE (N1)
 13669           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13670              N1 <= CN-BILLING-END-LINE-NO
 13671              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13672              IF CN-BILLING-END-LINE-NO <
 13673                               CN-BILLING-START-LINE-NO
 13674                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13675                                     CN-BILLING-START-LINE-NO
 13676              END-IF
 13677              PERFORM 1820-SQUEEZE-ERNOTE
 13678                                  THRU 1820-EXIT
 13679           END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 249
* VP6311.cbl
 13680           IF CN-LINES = SPACES
 13681
 13682* EXEC CICS DELETE
 13683*                DATASET    (FILE-ID-ERNOTE)
 13684*                RESP       (WS-RESPONSE)
 13685*             END-EXEC
 13686*    MOVE '&(                    &  N#00012402' TO DFHEIV0
 13687     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13688     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13689     MOVE X'204E233030303132343032' TO DFHEIV0(25:11)
 13690     CALL 'kxdfhei1' USING DFHEIV0,
 13691           FILE-ID-ERNOTE,
 13692           DFHEIV99,
 13693           DFHEIV99,
 13694           DFHEIV99,
 13695           DFHEIV99
 13696     MOVE EIBRESP  TO WS-RESPONSE
 13697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13698              IF RESP-NORMAL
 13699                 MOVE 'D'        TO WS-NOTE-SW
 13700                 PERFORM 1520-UPDATE-ELCERT
 13701                                 THRU 1520-EXIT
 13702              END-IF
 13703           ELSE
 13704
 13705* EXEC CICS REWRITE
 13706*                DATASET    (FILE-ID-ERNOTE)
 13707*                FROM       (CERTIFICATE-NOTE)
 13708*                RESP       (WS-RESPONSE)
 13709*             END-EXEC
 13710     MOVE LENGTH OF
 13711      CERTIFICATE-NOTE
 13712       TO DFHEIV11
 13713*    MOVE '&& L                  %  N#00012412' TO DFHEIV0
 13714     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13715     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13716     MOVE X'204E233030303132343132' TO DFHEIV0(25:11)
 13717     CALL 'kxdfhei1' USING DFHEIV0,
 13718           FILE-ID-ERNOTE,
 13719           CERTIFICATE-NOTE,
 13720           DFHEIV11,
 13721           DFHEIV99
 13722     MOVE EIBRESP  TO WS-RESPONSE
 13723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13724           END-IF
 13725        END-IF
 13726     END-IF
 13727     .
 13728 1800-EXIT.
 13729     EXIT.
 13730 1820-SQUEEZE-ERNOTE.
 13731     MOVE CN-BILLING-START-LINE-NO TO N2
 13732     IF N2 = 0
 13733         MOVE +1                 TO N2
 13734     END-IF
 13735     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13736        (N1 > +9)
 13737        IF CN-LINE (N1) = SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 250
* VP6311.cbl
 13738           MOVE CN-LINE (N1 + +1)
 13739                                 TO CN-LINE (N1)
 13740           MOVE SPACES           TO CN-LINE (N1 + +1)
 13741        END-IF
 13742     END-PERFORM
 13743     .
 13744 1820-EXIT.
 13745     EXIT.
 13746 1900-DELETE-ERPYAJ.
 13747     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13748     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13749     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13750     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13751     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13752     MOVE +10                    TO ERPYAJ-SEQ-NO
 13753     MOVE 'R'                    TO ERPYAJ-TYPE
 13754     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13755
 13756* EXEC CICS STARTBR
 13757*       DATASET    (FILE-ID-ERPYAJ)
 13758*       RIDFLD     (ERPYAJ-KEY)
 13759*       RESP       (WS-RESPONSE)
 13760*    END-EXEC
 13761     MOVE 0
 13762       TO DFHEIV11
 13763*    MOVE '&,         G          &  N#00012448' TO DFHEIV0
 13764     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13765     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13766     MOVE X'204E233030303132343438' TO DFHEIV0(25:11)
 13767     CALL 'kxdfhei1' USING DFHEIV0,
 13768           FILE-ID-ERPYAJ,
 13769           ERPYAJ-KEY,
 13770           DFHEIV99,
 13771           DFHEIV11,
 13772           DFHEIV99
 13773     MOVE EIBRESP  TO WS-RESPONSE
 13774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13775     IF RESP-NORMAL
 13776        CONTINUE
 13777     ELSE
 13778        GO TO 1900-GET-DEALER
 13779     END-IF
 13780     .
 13781 1900-READNEXT-ERPYAJ-B.
 13782*  GET THE BANK ERPYAJ RECORD
 13783
 13784* EXEC CICS READNEXT
 13785*       DATASET    (FILE-ID-ERPYAJ)
 13786*       RIDFLD     (ERPYAJ-KEY)
 13787*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13788*       RESP       (WS-RESPONSE)
 13789*    END-EXEC
 13790     MOVE 0
 13791       TO DFHEIV11
 13792*    MOVE '&.S                   )  N#00012461' TO DFHEIV0
 13793     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13794     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13795     MOVE X'204E233030303132343631' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 251
* VP6311.cbl
 13796     CALL 'kxdfhei1' USING DFHEIV0,
 13797           FILE-ID-ERPYAJ,
 13798           DFHEIV20,
 13799           DFHEIV99,
 13800           ERPYAJ-KEY,
 13801           DFHEIV99,
 13802           DFHEIV11,
 13803           DFHEIV99,
 13804           DFHEIV99
 13805     SET ADDRESS OF PENDING-PAY-ADJ TO
 13806         DFHEIV20
 13807     MOVE EIBRESP  TO WS-RESPONSE
 13808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13809     IF RESP-NORMAL
 13810        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13811           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13812              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13813                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13814
 13815* EXEC CICS READ
 13816*                   DATASET    (FILE-ID-ERPYAJ)
 13817*                   RIDFLD     (ERPYAJ-KEY)
 13818*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13819*                   RESP       (WS-RESPONSE)
 13820*                   UPDATE
 13821*                END-EXEC
 13822*    MOVE '&"S        EU         (  N#00012472' TO DFHEIV0
 13823     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13824     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13825     MOVE X'204E233030303132343732' TO DFHEIV0(25:11)
 13826     CALL 'kxdfhei1' USING DFHEIV0,
 13827           FILE-ID-ERPYAJ,
 13828           DFHEIV20,
 13829           DFHEIV99,
 13830           ERPYAJ-KEY,
 13831           DFHEIV99,
 13832           DFHEIV99,
 13833           DFHEIV99
 13834     SET ADDRESS OF PENDING-PAY-ADJ TO
 13835         DFHEIV20
 13836     MOVE EIBRESP  TO WS-RESPONSE
 13837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13838                 IF RESP-NORMAL
 13839
 13840* EXEC CICS DELETE
 13841*                      DATASET   (FILE-ID-ERPYAJ)
 13842*                      RESP      (WS-RESPONSE)
 13843*                   END-EXEC
 13844*    MOVE '&(                    &  N#00012480' TO DFHEIV0
 13845     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13846     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13847     MOVE X'204E233030303132343830' TO DFHEIV0(25:11)
 13848     CALL 'kxdfhei1' USING DFHEIV0,
 13849           FILE-ID-ERPYAJ,
 13850           DFHEIV99,
 13851           DFHEIV99,
 13852           DFHEIV99,
 13853           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 252
* VP6311.cbl
 13854     MOVE EIBRESP  TO WS-RESPONSE
 13855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13856                 END-IF
 13857              ELSE
 13858                 SET REVERSAL    TO TRUE
 13859                 PERFORM 1600-UPDATE-ERPYAJ
 13860                                 THRU 1600-EXIT
 13861                 GO TO 1900-EXIT
 13862              END-IF
 13863           ELSE
 13864              GO TO 1900-READNEXT-ERPYAJ-B
 13865           END-IF
 13866        END-IF
 13867
 13868* EXEC CICS ENDBR
 13869*          DATASET   (FILE-ID-ERPYAJ)
 13870*       END-EXEC
 13871     MOVE 0
 13872       TO DFHEIV11
 13873*    MOVE '&2                    $   #00012495' TO DFHEIV0
 13874     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13875     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13876     MOVE X'2020233030303132343935' TO DFHEIV0(25:11)
 13877     CALL 'kxdfhei1' USING DFHEIV0,
 13878           FILE-ID-ERPYAJ,
 13879           DFHEIV11,
 13880           DFHEIV99
 13881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13882     END-IF
 13883     .
 13884 1900-GET-DEALER.
 13885     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13886     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13887     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13888     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13889     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13890     MOVE +10                    TO ERPYAJ-SEQ-NO
 13891     MOVE 'C'                    TO ERPYAJ-TYPE
 13892     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13893
 13894* EXEC CICS STARTBR
 13895*       DATASET    (FILE-ID-ERPYAJ)
 13896*       RIDFLD     (ERPYAJ-KEY)
 13897*       RESP       (WS-RESPONSE)
 13898*    END-EXEC
 13899     MOVE 0
 13900       TO DFHEIV11
 13901*    MOVE '&,         G          &  N#00012509' TO DFHEIV0
 13902     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13903     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13904     MOVE X'204E233030303132353039' TO DFHEIV0(25:11)
 13905     CALL 'kxdfhei1' USING DFHEIV0,
 13906           FILE-ID-ERPYAJ,
 13907           ERPYAJ-KEY,
 13908           DFHEIV99,
 13909           DFHEIV11,
 13910           DFHEIV99
 13911     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 253
* VP6311.cbl
 13912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13913     IF RESP-NORMAL
 13914        CONTINUE
 13915     ELSE
 13916        GO TO 1900-EXIT
 13917     END-IF
 13918     .
 13919 1900-READNEXT-ERPYAJ-D.
 13920*  GET THE DEALER ERPYAJ RECORD
 13921
 13922* EXEC CICS READNEXT
 13923*       DATASET    (FILE-ID-ERPYAJ)
 13924*       RIDFLD     (ERPYAJ-KEY)
 13925*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13926*       RESP       (WS-RESPONSE)
 13927*    END-EXEC
 13928     MOVE 0
 13929       TO DFHEIV11
 13930*    MOVE '&.S                   )  N#00012522' TO DFHEIV0
 13931     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13932     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13933     MOVE X'204E233030303132353232' TO DFHEIV0(25:11)
 13934     CALL 'kxdfhei1' USING DFHEIV0,
 13935           FILE-ID-ERPYAJ,
 13936           DFHEIV20,
 13937           DFHEIV99,
 13938           ERPYAJ-KEY,
 13939           DFHEIV99,
 13940           DFHEIV11,
 13941           DFHEIV99,
 13942           DFHEIV99
 13943     SET ADDRESS OF PENDING-PAY-ADJ TO
 13944         DFHEIV20
 13945     MOVE EIBRESP  TO WS-RESPONSE
 13946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13947     IF RESP-NORMAL
 13948        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13949           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13950              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13951                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13952
 13953* EXEC CICS READ
 13954*                   DATASET    (FILE-ID-ERPYAJ)
 13955*                   RIDFLD     (ERPYAJ-KEY)
 13956*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13957*                   RESP       (WS-RESPONSE)
 13958*                   UPDATE
 13959*                END-EXEC
 13960*    MOVE '&"S        EU         (  N#00012533' TO DFHEIV0
 13961     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13962     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13963     MOVE X'204E233030303132353333' TO DFHEIV0(25:11)
 13964     CALL 'kxdfhei1' USING DFHEIV0,
 13965           FILE-ID-ERPYAJ,
 13966           DFHEIV20,
 13967           DFHEIV99,
 13968           ERPYAJ-KEY,
 13969           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 254
* VP6311.cbl
 13970           DFHEIV99,
 13971           DFHEIV99
 13972     SET ADDRESS OF PENDING-PAY-ADJ TO
 13973         DFHEIV20
 13974     MOVE EIBRESP  TO WS-RESPONSE
 13975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13976                 IF RESP-NORMAL
 13977
 13978* EXEC CICS DELETE
 13979*                      DATASET   (FILE-ID-ERPYAJ)
 13980*                      RESP      (WS-RESPONSE)
 13981*                   END-EXEC
 13982*    MOVE '&(                    &  N#00012541' TO DFHEIV0
 13983     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13984     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13985     MOVE X'204E233030303132353431' TO DFHEIV0(25:11)
 13986     CALL 'kxdfhei1' USING DFHEIV0,
 13987           FILE-ID-ERPYAJ,
 13988           DFHEIV99,
 13989           DFHEIV99,
 13990           DFHEIV99,
 13991           DFHEIV99
 13992     MOVE EIBRESP  TO WS-RESPONSE
 13993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13994                 END-IF
 13995              ELSE
 13996                 SET REVERSAL    TO TRUE
 13997              END-IF
 13998           ELSE
 13999              GO TO 1900-READNEXT-ERPYAJ-D
 14000           END-IF
 14001        END-IF
 14002
 14003* EXEC CICS ENDBR
 14004*          DATASET   (FILE-ID-ERPYAJ)
 14005*       END-EXEC
 14006     MOVE 0
 14007       TO DFHEIV11
 14008*    MOVE '&2                    $   #00012553' TO DFHEIV0
 14009     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14010     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14011     MOVE X'2020233030303132353533' TO DFHEIV0(25:11)
 14012     CALL 'kxdfhei1' USING DFHEIV0,
 14013           FILE-ID-ERPYAJ,
 14014           DFHEIV11,
 14015           DFHEIV99
 14016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14017     END-IF
 14018     .
 14019 1900-EXIT.
 14020     EXIT.
 14021******************************************************************
 14022*            C A N C E L   M A I N L I N E                       *
 14023******************************************************************
 14024
 14025 2000-CANCEL-MAINLINE.
 14026     IF PI-DISPLAY-ORIGINAL-BATCH
 14027        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 255
* VP6311.cbl
 14028           MOVE ER-0023             TO EMI-ERROR
 14029           MOVE -1                  TO CMAINTL
 14030           MOVE AL-UABON            TO CMAINTA
 14031           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14032           GO TO 8200-SEND-DATAONLY
 14033        ELSE
 14034           NEXT SENTENCE
 14035     ELSE
 14036        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14037           MOVE ER-0023             TO EMI-ERROR
 14038           MOVE -1                  TO CMAINTL
 14039           MOVE AL-UABON            TO CMAINTA
 14040           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14041           GO TO 8200-SEND-DATAONLY.
 14042
 14043     IF CMAINTI = 'S'
 14044        GO TO 2100-SHOW-REQUEST.
 14045
 14046     IF NOT MODIFY-CAP
 14047         MOVE 'UPDATE'       TO SM-READ
 14048         PERFORM 9995-SECURITY-VIOLATION
 14049         MOVE ER-0070        TO EMI-ERROR
 14050         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14051         GO TO 8100-SEND-INITIAL-MAP.
 14052
 14053     IF CMAINTL GREATER THAN ZEROS
 14054        IF PI-PF6-FUNCTION
 14055           IF CMAINTI NOT = 'A'
 14056              MOVE AL-UABON  TO CMAINTA
 14057              MOVE -1        TO CMAINTL
 14058              MOVE ER-2260   TO EMI-ERROR
 14059              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14060              GO TO 8200-SEND-DATAONLY.
 14061
 14062     IF CCERTNOL = ZEROS
 14063       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14064         NEXT SENTENCE
 14065     ELSE
 14066         IF CCERTNOL NOT = ZEROS
 14067             MOVE AL-UANON       TO CCERTNOA
 14068         ELSE
 14069             MOVE -1             TO CCERTNOL
 14070             MOVE  1             TO SET-CURSOR-SW
 14071             MOVE ER-2218       TO EMI-ERROR
 14072             MOVE AL-UABON       TO CCERTNOA
 14073             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14074
 14075     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14076        NEXT SENTENCE
 14077     ELSE
 14078        IF CEFFDTL NOT = ZEROS
 14079           MOVE AL-UNNON         TO CEFFDTA
 14080           MOVE CEFFDTI TO DEEDIT-FIELD
 14081           PERFORM 8600-DEEDIT
 14082           MOVE 4                TO DC-OPTION-CODE
 14083           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14084           PERFORM 9700-DATE-LINK
 14085           IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 256
* VP6311.cbl
 14086              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14087              ELSE
 14088              MOVE -1            TO CEFFDTL
 14089              MOVE  1            TO SET-CURSOR-SW
 14090              MOVE ER-2226      TO EMI-ERROR
 14091              MOVE AL-UNBON      TO CEFFDTA
 14092              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14093          ELSE
 14094          MOVE -1                 TO CEFFDTL
 14095          MOVE  1                 TO SET-CURSOR-SW
 14096          MOVE ER-2220            TO EMI-ERROR
 14097          MOVE AL-UNBON           TO CEFFDTA
 14098          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14099
 14100     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14101
 14102     IF CCERTNOL NOT = ZEROS
 14103        MOVE CCERTNOI                TO WS-NEW-PRIME
 14104     ELSE
 14105        MOVE SPACES                  TO WS-NEW-PRIME.
 14106
 14107     IF CSUFIXL NOT = ZEROS
 14108        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14109     ELSE
 14110        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14111
 14112     IF CEFFDTL NOT = ZEROS
 14113        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14114     ELSE
 14115        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14116
 14117     IF CMAINTI = 'A' OR 'K' OR 'S'
 14118        NEXT SENTENCE
 14119     ELSE
 14120        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14121        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14122           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14123           WS-PB-RECORD-TYPE NOT = '2'
 14124           IF CMAINTI = 'C'
 14125              MOVE ER-2287          TO EMI-ERROR
 14126              MOVE -1               TO CCERTNOL
 14127              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14128              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14129              GO TO 8200-SEND-DATAONLY
 14130             ELSE
 14131              MOVE ER-2260          TO EMI-ERROR
 14132              MOVE -1               TO CCERTNOL
 14133              MOVE AL-UABON         TO CCERTNOA
 14134              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14135              GO TO 8200-SEND-DATAONLY.
 14136
 14137     IF CMAINTI = 'D'
 14138        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14139
 14140     IF CLSTNML GREATER THAN ZEROS
 14141         MOVE AL-UANON           TO CLSTNMA.
 14142
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 257
* VP6311.cbl
 14144
 14145******************************************************************
 14146*                                                                *
 14147*           E D I T   C A N C E L   C O V E R A G E S            *
 14148*                                                                *
 14149******************************************************************
 14150
 14151 2015-EDIT-COVERAGES.
 14152     IF CCANDT1L      GREATER THAN ZEROS OR
 14153        CREFND1L      GREATER THAN ZEROS OR
 14154        CCANDT2L      GREATER THAN ZEROS OR
 14155        CREFND2L      GREATER THAN ZEROS OR
 14156        CMTHD1L       GREATER THAN ZEROS OR
 14157        CMTHD2L       GREATER THAN ZEROS OR
 14158        CLIVESL       GREATER THAN ZEROS OR
 14159        CPAYEEL       GREATER THAN ZEROS OR
 14160        CFORCEL       GREATER THAN ZEROS OR
 14161        CBILCDL       GREATER THAN ZEROS OR
 14162        CCANREAL      GREATER THAN ZEROS
 14163            NEXT SENTENCE
 14164         ELSE
 14165            GO TO 2030-EDIT-COMPLETE.
 14166
 14167     IF CCANDT1L = ZEROS
 14168        AND (CMAINTI = 'C' OR 'K')
 14169        NEXT SENTENCE
 14170     ELSE
 14171        IF CCANDT1L      GREATER THAN ZEROS
 14172            MOVE AL-UNNON            TO CCANDT1A
 14173            IF CCANDT1I = SPACES
 14174               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14175            ELSE
 14176               MOVE CCANDT1I            TO DEEDIT-FIELD
 14177               PERFORM 8600-DEEDIT
 14178               IF DEEDIT-FIELD-V0   NUMERIC
 14179                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14180                  MOVE 4                TO DC-OPTION-CODE
 14181                  PERFORM 9700-DATE-LINK
 14182                  IF NO-CONVERSION-ERROR
 14183                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14184                  ELSE
 14185                      MOVE -1        TO CCANDT1L
 14186                      MOVE ER-2227   TO EMI-ERROR
 14187                      MOVE AL-UNBON  TO CCANDT1A
 14188                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14189               ELSE
 14190                  MOVE -1         TO CCANDT1L
 14191                  MOVE ER-2223    TO EMI-ERROR
 14192                  MOVE AL-UNBON   TO CCANDT1A
 14193                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14194        ELSE
 14195            IF CREFND1L GREATER THAN ZEROS
 14196               MOVE -1             TO CCANDT1L
 14197               MOVE ER-2222        TO EMI-ERROR
 14198               MOVE AL-UNBOF       TO CCANDT1A
 14199               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14200
 14201     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 258
* VP6311.cbl
 14202        AND (CMAINTI = 'C' OR 'K')
 14203         NEXT SENTENCE
 14204     ELSE
 14205         IF CREFND1L NOT = ZEROS
 14206            MOVE AL-UNNON        TO CREFND1A
 14207
 14208* EXEC CICS BIF DEEDIT
 14209*               FIELD  (CREFND1I)
 14210*               LENGTH (11)
 14211*           END-EXEC
 14212     MOVE 11
 14213       TO DFHEIV11
 14214*    MOVE '@"L                   #   #00012746' TO DFHEIV0
 14215     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14216     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14217     MOVE X'2020233030303132373436' TO DFHEIV0(25:11)
 14218     CALL 'kxdfhei1' USING DFHEIV0,
 14219           CREFND1I,
 14220           DFHEIV11
 14221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14222            MOVE CREFND1I        TO WS-CREFND1
 14223*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14224*           PERFORM 8600-DEEDIT
 14225*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14226            IF WS-CREFND1  = ZEROS
 14227               AND CMAINTI = 'A'
 14228             MOVE ER-2437        TO EMI-ERROR
 14229             MOVE -1             TO CREFND1L
 14230             MOVE AL-UNBON       TO CREFND1A
 14231             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14232
 14233     IF CCANREAL > +0
 14234        MOVE AL-UANON            TO CCANREAA
 14235        IF CCANREAI = 'R' OR ' '
 14236           CONTINUE
 14237        ELSE
 14238           MOVE ER-9841        TO EMI-ERROR
 14239           MOVE -1             TO CCANREAL
 14240           MOVE AL-UABON       TO CCANREAA
 14241           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14242        END-IF
 14243     END-IF
 14244     IF CMTHD1L EQUAL +0
 14245        NEXT SENTENCE
 14246     ELSE
 14247        IF CMTHD1L NOT = +0
 14248           MOVE AL-UNNON        TO CMTHD1A
 14249           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14250                         OR '5' OR '6' OR '8' OR '9'
 14251                         OR 'R' OR ' '
 14252              NEXT SENTENCE
 14253           ELSE
 14254              MOVE ER-0582        TO EMI-ERROR
 14255              MOVE -1             TO CMTHD1L
 14256              MOVE AL-UNBON       TO CMTHD1A
 14257              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14258
 14259     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 259
* VP6311.cbl
 14260        AND (CMAINTI = 'C' OR 'K')
 14261         NEXT SENTENCE
 14262     ELSE
 14263         IF CCANDT2L  GREATER THAN ZEROS
 14264             MOVE AL-UNNON       TO CCANDT2A
 14265             IF CCANDT2I = SPACES
 14266                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14267             ELSE
 14268                MOVE CCANDT2I       TO DEEDIT-FIELD
 14269                PERFORM 8600-DEEDIT
 14270                IF DEEDIT-FIELD-V0   NUMERIC
 14271                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14272                   MOVE 4                TO DC-OPTION-CODE
 14273                   PERFORM 9700-DATE-LINK
 14274                   IF NO-CONVERSION-ERROR
 14275                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14276                   ELSE
 14277                      MOVE -1       TO CCANDT2L
 14278                      MOVE ER-2227  TO EMI-ERROR
 14279                      MOVE AL-UNBON TO CCANDT2A
 14280                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14281                ELSE
 14282                   MOVE -1         TO CCANDT2L
 14283                   MOVE ER-2223    TO EMI-ERROR
 14284                   MOVE AL-UNBON   TO CCANDT2A
 14285                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14286         ELSE
 14287            IF CREFND2L GREATER THAN ZEROS
 14288               MOVE -1             TO CCANDT2L
 14289               MOVE ER-2222        TO EMI-ERROR
 14290               MOVE AL-UNBOF       TO CCANDT2A
 14291               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14292
 14293     IF CREFND2L = ZEROS
 14294        AND (CMAINTI = 'C' OR 'K')
 14295         NEXT SENTENCE
 14296     ELSE
 14297         IF CREFND2L NOT = ZEROS
 14298            MOVE AL-UNNON        TO CREFND2A
 14299
 14300* EXEC CICS BIF DEEDIT
 14301*               FIELD  (CREFND2I)
 14302*               LENGTH (11)
 14303*           END-EXEC
 14304     MOVE 11
 14305       TO DFHEIV11
 14306*    MOVE '@"L                   #   #00012827' TO DFHEIV0
 14307     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14308     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14309     MOVE X'2020233030303132383237' TO DFHEIV0(25:11)
 14310     CALL 'kxdfhei1' USING DFHEIV0,
 14311           CREFND2I,
 14312           DFHEIV11
 14313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14314            MOVE CREFND2I        TO WS-CREFND2
 14315*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14316*           PERFORM 8600-DEEDIT
 14317*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 260
* VP6311.cbl
 14318            IF WS-CREFND2  = ZEROS
 14319               AND CMAINTI = 'A'
 14320             MOVE ER-2437        TO EMI-ERROR
 14321             MOVE -1             TO CREFND2L
 14322             MOVE AL-UNBON       TO CREFND2A
 14323             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14324
 14325     IF CMTHD2L EQUAL +0
 14326        NEXT SENTENCE
 14327     ELSE
 14328        IF CMTHD2L NOT = +0
 14329           MOVE AL-UNNON        TO CMTHD2A
 14330           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14331                         OR '5' OR '6' OR '8' OR '9'
 14332                         OR ' ' OR 'R'
 14333              NEXT SENTENCE
 14334           ELSE
 14335              MOVE ER-0582        TO EMI-ERROR
 14336              MOVE -1             TO CMTHD2L
 14337              MOVE AL-UNBON       TO CMTHD2A
 14338              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14339
 14340     IF CLIVESL GREATER THAN ZEROS
 14341         MOVE CLIVESI            TO DEEDIT-FIELD
 14342         PERFORM 8600-DEEDIT
 14343         IF DEEDIT-FIELD-V0 NUMERIC
 14344             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14345             MOVE AL-UNNON       TO CLIVESA
 14346         ELSE
 14347             MOVE -1             TO CLIVESL
 14348             MOVE AL-UNBON       TO CLIVESA
 14349             MOVE ER-2223        TO EMI-ERROR
 14350             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14351
 14352     IF CFORCEL  NOT = ZEROS
 14353         IF FORCE-CAP
 14354            MOVE AL-UANON            TO CFORCEA
 14355         ELSE
 14356            MOVE ER-2945             TO EMI-ERROR
 14357            MOVE AL-UABON            TO CFORCEA
 14358            MOVE -1                  TO CFORCEL
 14359            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14360
 14361     IF CPAYEEL GREATER THAN ZEROS
 14362        MOVE AL-UANON            TO CPAYEEA.
 14363
 14364     IF CBILCDL NOT = ZEROS
 14365        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14366                             AND 'A' AND 'B' AND 'E'
 14367           MOVE ER-2225              TO EMI-ERROR
 14368           MOVE AL-UABON             TO CBILCDA
 14369           MOVE -1                   TO CBILCDL
 14370           MOVE  1                   TO SET-CURSOR-SW
 14371           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14372        ELSE
 14373           MOVE AL-UANON             TO CBILCDA.
 14374
 14375 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 261
* VP6311.cbl
 14376     IF EMI-ERROR = ZEROS
 14377         NEXT SENTENCE
 14378     ELSE
 14379         GO TO 8200-SEND-DATAONLY.
 14380
 14381     IF CMAINTI = 'A'
 14382        GO TO 2200-ADD-CANCEL-ROUTINE.
 14383
 14384     IF CMAINTI = 'C'
 14385        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14386
 14387     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14388
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 262
* VP6311.cbl
 14390
 14391******************************************************************
 14392*                                                                *
 14393*                   S H O W   C A N C E L                        *
 14394*                                                                *
 14395******************************************************************
 14396
 14397 2100-SHOW-REQUEST.
 14398     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14399
 14400     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14401        MOVE -1                  TO CMAINTL
 14402        GO TO 8200-SEND-DATAONLY.
 14403
 14404     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14405
 14406     IF CSUFIXL NOT = ZEROS
 14407        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14408       ELSE
 14409        MOVE SPACE            TO WS-NEW-SUFFIX.
 14410
 14411     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14412     PERFORM 8600-DEEDIT.
 14413     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14414     MOVE '4'                    TO DC-OPTION-CODE.
 14415     PERFORM 9700-DATE-LINK.
 14416     IF DATE-CONVERSION-ERROR
 14417        MOVE ER-0348             TO EMI-ERROR
 14418        MOVE -1                  TO CEFFDTL
 14419        MOVE AL-UABON            TO CEFFDTA
 14420        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14421        GO TO 8200-SEND-DATAONLY
 14422     ELSE
 14423        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14424        MOVE AL-UANON            TO CEFFDTA
 14425        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14426
 14427     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14428
 14429     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14430        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14431        MOVE 'Y'                    TO WS-SHOW-SW
 14432        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14433           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14434        ELSE
 14435           IF PI-FILE-BROWSE
 14436              GO TO 4300-BROWSE-FILE-FORWARD
 14437           ELSE
 14438              IF PI-CSR-BROWSE
 14439                 GO TO 4200-BROWSE-CSR-FORWARD
 14440              ELSE
 14441                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14442     ELSE
 14443        GO TO 3900-RE-DISPLAY-RECORD.
 14444
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 263
* VP6311.cbl
 14446
 14447
 14448******************************************************************
 14449*                                                                *
 14450*            A D D   C A N C E L   R O U T I N E                 *
 14451*                                                                *
 14452******************************************************************
 14453
 14454 2200-ADD-CANCEL-ROUTINE.
 14455     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14456
 14457
 14458* EXEC CICS GETMAIN
 14459*        SET     (ADDRESS OF PENDING-BUSINESS)
 14460*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14461*    END-EXEC.
 14462*    MOVE '," L                  $   #00012974' TO DFHEIV0
 14463     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14464     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14465     MOVE X'2020233030303132393734' TO DFHEIV0(25:11)
 14466     CALL 'kxdfhei1' USING DFHEIV0,
 14467           DFHEIV20,
 14468           ERPNDB-RECORD-LENGTH,
 14469           DFHEIV99
 14470     SET ADDRESS OF PENDING-BUSINESS TO
 14471         DFHEIV20
 14472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14473
 14474
 14475
 14476* EXEC CICS HANDLE CONDITION
 14477*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14478*    END-EXEC.
 14479*    MOVE '"$I                   ! 3 #00012979' TO DFHEIV0
 14480     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14481     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14482     MOVE X'3320233030303132393739' TO DFHEIV0(25:11)
 14483     CALL 'kxdfhei1' USING DFHEIV0
 14484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14485
 14486
 14487     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14488     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14489     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14490
 14491
 14492* EXEC CICS READ
 14493*        INTO    (PENDING-BUSINESS)
 14494*        DATASET (FILE-ID-ERPNDB)
 14495*        RIDFLD  (ERPNDB-KEY)
 14496*    END-EXEC.
 14497     MOVE LENGTH OF
 14498      PENDING-BUSINESS
 14499       TO DFHEIV11
 14500*    MOVE '&"IL       E          (   #00012987' TO DFHEIV0
 14501     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14502     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14503     MOVE X'2020233030303132393837' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 264
* VP6311.cbl
 14504     CALL 'kxdfhei1' USING DFHEIV0,
 14505           FILE-ID-ERPNDB,
 14506           PENDING-BUSINESS,
 14507           DFHEIV11,
 14508           ERPNDB-KEY,
 14509           DFHEIV99,
 14510           DFHEIV99,
 14511           DFHEIV99
 14512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14513
 14514
 14515     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14516
 14517     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14518     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14519     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14520     MOVE SPACES                 TO PENDING-BUSINESS.
 14521     MOVE 'PB'                   TO PB-RECORD-ID.
 14522     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14523     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14524     MOVE SPACES                 TO PB-CERT-SFX.
 14525     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14526     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14527                                    PB-ALT-CHG-SEQ-NO.
 14528
 14529     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14530     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14531     MOVE '2'                    TO PB-RECORD-TYPE.
 14532
 14533     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14534     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14535
 14536
 14537     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14538                                    PB-ALT-CHG-SEQ-NO
 14539                                    PB-C-LF-REF-CALC
 14540                                    PB-C-AH-REF-CALC
 14541                                    PB-C-LF-RFND-CLP
 14542                                    PB-C-AH-RFND-CLP
 14543                                    PB-CI-INSURED-AGE
 14544                                    PB-CI-LF-TERM
 14545                                    PB-CI-AH-TERM
 14546                                    PB-CI-LF-BENEFIT-CD
 14547                                    PB-CI-LF-BENEFIT-AMT
 14548                                    PB-CI-LF-ALT-BENEFIT-AMT
 14549                                    PB-CI-LF-PREMIUM-AMT
 14550                                    PB-CI-LF-ALT-PREMIUM-AMT
 14551                                    PB-CI-AH-BENEFIT-CD
 14552                                    PB-CI-AH-BENEFIT-AMT
 14553                                    PB-CI-AH-PREMIUM-AMT
 14554                                    PB-CI-PAY-FREQUENCY
 14555                                    PB-CI-LOAN-APR
 14556                                    PB-CI-LOAN-TERM
 14557                                    PB-CI-LIFE-COMMISSION
 14558                                    PB-CI-AH-COMMISSION
 14559                                    PB-CI-CURR-SEQ
 14560                                    PB-CI-AH-CANCEL-AMT
 14561                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 265
* VP6311.cbl
 14562                                    PB-CI-RATE-DEV-PCT-LF
 14563                                    PB-CI-RATE-DEV-PCT-AH
 14564                                    PB-CI-EXTENTION-DAYS
 14565                                    PB-CI-TERM-IN-DAYS
 14566                                    PB-CI-LIVES
 14567                                    PB-CI-LF-CRIT-PER
 14568                                    PB-CI-AH-CRIT-PER
 14569                                    PB-C-LF-REM-TERM
 14570                                    PB-C-AH-REM-TERM
 14571                                    PB-CHG-COUNT
 14572                                    PB-LF-BILLED-AMTS
 14573                                    PB-AH-BILLED-AMTS
 14574                                    PB-C-INT-ON-REFS
 14575*                                   PB-C-MICROFILM-NO
 14576                                    PB-CALC-TOLERANCE.
 14577
 14578     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14579                                    PB-CI-AH-SETTLEMENT-DT
 14580                                    PB-CI-DEATH-DT
 14581                                    PB-CI-LF-PRIOR-CANCEL-DT
 14582                                    PB-CI-AH-PRIOR-CANCEL-DT
 14583                                    PB-CI-ENTRY-DT
 14584                                    PB-CI-LF-EXPIRE-DT
 14585                                    PB-CI-AH-EXPIRE-DT
 14586                                    PB-CI-LOAN-1ST-PMT-DT
 14587                                    PB-C-LF-CANCEL-DT
 14588                                    PB-C-AH-CANCEL-DT
 14589                                    PB-CREDIT-ACCEPT-DT
 14590                                    PB-BILLED-DT
 14591                                    PB-ACCT-EFF-DT
 14592                                    PB-ACCT-EXP-DT.
 14593
 14594     MOVE 'X'                    TO PB-FATAL-FLAG.
 14595
 14596     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14597
 14598     IF CSUFIXL     GREATER THAN ZEROS
 14599        MOVE CSUFIXI             TO PB-CERT-SFX.
 14600
 14601*    IF CMICRNOL  GREATER  ZEROS
 14602*        IF CMICRNOI  NUMERIC
 14603*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14604*            MOVE AL-UNNON       TO  CMICRNOA
 14605*        ELSE
 14606*            MOVE -1             TO  CMICRNOL
 14607*            MOVE AL-UNBON       TO  CMICRNOA
 14608*            MOVE ER-2701        TO  EMI-ERROR
 14609*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14610
 14611     IF CLSTNML     GREATER THAN ZEROS
 14612        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14613
 14614     IF CCANREAL > ZEROS
 14615        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14616     END-IF
 14617     IF CCANDT1L    GREATER THAN ZEROS
 14618        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14619
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 266
* VP6311.cbl
 14620     IF CCANDT2L    GREATER THAN ZEROS
 14621        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14622
 14623     IF CMTHD1L    GREATER THAN +0
 14624        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14625
 14626     IF CMTHD2L    GREATER THAN +0
 14627        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14628
 14629     IF CREFND1L    GREATER THAN ZEROS
 14630        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14631        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14632     ELSE
 14633        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14634
 14635     IF CREFND2L    GREATER THAN ZEROS
 14636        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14637        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14638     ELSE
 14639        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14640
 14641     IF CLIVESL     GREATER THAN ZEROS
 14642        MOVE WS-CLIVES           TO PB-C-LIVES
 14643     ELSE
 14644        MOVE ZEROS               TO PB-C-LIVES.
 14645
 14646     IF CPAYEEL     GREATER THAN ZEROS
 14647        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14648
 14649     IF CFORCEL     GREATER THAN ZEROS
 14650        MOVE CFORCEI             TO PB-FORCE-CODE.
 14651
 14652     IF CBILCDL     GREATER THAN ZEROS
 14653        MOVE CBILCDI             TO PB-RECORD-BILL.
 14654
 14655*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14656
 14657 2260-WRITE-PB-RECORD.
 14658     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14659                                    PB-INPUT-BY.
 14660     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14661     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14662                                    PB-INPUT-DT.
 14663
 14664     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14665     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14666                                    PB-CONTROL-BY-ORIG-BATCH.
 14667
 14668     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14669     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14670     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14671     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14672     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14673
 14674     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 14675
 14676     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14677
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 267
* VP6311.cbl
 14678     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14679     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14680     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14681
 14682     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14683     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14684
 14685 2275-WRITE-PENDING-BUSINESS.
 14686     MOVE 'A'                    TO JP-RECORD-TYPE.
 14687     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14688     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14689     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14690
 14691
 14692* EXEC CICS HANDLE CONDITION
 14693*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14694*    END-EXEC.
 14695*    MOVE '"$%                   ! 4 #00013169' TO DFHEIV0
 14696     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14697     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14698     MOVE X'3420233030303133313639' TO DFHEIV0(25:11)
 14699     CALL 'kxdfhei1' USING DFHEIV0
 14700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14701
 14702
 14703
 14704* EXEC CICS WRITE
 14705*        DATASET (FILE-ID-ERPNDB)
 14706*        FROM    (PENDING-BUSINESS)
 14707*        RIDFLD  (PB-CONTROL-PRIMARY)
 14708*    END-EXEC.
 14709     MOVE LENGTH OF
 14710      PENDING-BUSINESS
 14711       TO DFHEIV11
 14712*    MOVE '&$ L                  ''   #00013173' TO DFHEIV0
 14713     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14714     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14715     MOVE X'2020233030303133313733' TO DFHEIV0(25:11)
 14716     CALL 'kxdfhei1' USING DFHEIV0,
 14717           FILE-ID-ERPNDB,
 14718           PENDING-BUSINESS,
 14719           DFHEIV11,
 14720           PB-CONTROL-PRIMARY,
 14721           DFHEIV99,
 14722           DFHEIV99
 14723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14724
 14725
 14726     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14727
 14728     PERFORM 8400-LOG-JOURNAL-RECORD.
 14729
 14730******************************************************************
 14731*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14732******************************************************************
 14733
 14734     display ' made it to add orig CANCEL cert '
 14735     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 268
* VP6311.cbl
 14736     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14737     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14738     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14739
 14740
 14741* EXEC CICS READ
 14742*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14743*        DATASET (FILE-ID-ELCERT)
 14744*        RIDFLD  (ELCERT-KEY)
 14745*        RESP    (WS-RESPONSE)
 14746*    END-EXEC.
 14747*    MOVE '&"S        E          (  N#00013193' TO DFHEIV0
 14748     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14749     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14750     MOVE X'204E233030303133313933' TO DFHEIV0(25:11)
 14751     CALL 'kxdfhei1' USING DFHEIV0,
 14752           FILE-ID-ELCERT,
 14753           DFHEIV20,
 14754           DFHEIV99,
 14755           ELCERT-KEY,
 14756           DFHEIV99,
 14757           DFHEIV99,
 14758           DFHEIV99
 14759     SET ADDRESS OF CERTIFICATE-MASTER TO
 14760         DFHEIV20
 14761     MOVE EIBRESP  TO WS-RESPONSE
 14762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14763
 14764
 14765     IF NOT RESP-NORMAL
 14766        GO TO 2276-BYPASS-CRTO
 14767     END-IF
 14768
 14769     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14770     MOVE ' '                    TO WS-ERMAIL-SW
 14771
 14772
 14773* EXEC CICS READ
 14774*       DATASET   (FILE-ID-ERMAIL)
 14775*       SET       (ADDRESS OF MAILING-DATA)
 14776*       RIDFLD    (ERMAIL-KEY)
 14777*       RESP      (WS-RESPONSE)
 14778*    END-EXEC
 14779*    MOVE '&"S        E          (  N#00013207' TO DFHEIV0
 14780     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14781     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14782     MOVE X'204E233030303133323037' TO DFHEIV0(25:11)
 14783     CALL 'kxdfhei1' USING DFHEIV0,
 14784           FILE-ID-ERMAIL,
 14785           DFHEIV20,
 14786           DFHEIV99,
 14787           ERMAIL-KEY,
 14788           DFHEIV99,
 14789           DFHEIV99,
 14790           DFHEIV99
 14791     SET ADDRESS OF MAILING-DATA TO
 14792         DFHEIV20
 14793     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 269
* VP6311.cbl
 14794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14795
 14796     IF RESP-NORMAL
 14797        SET ERMAIL-FOUND TO TRUE
 14798     END-IF
 14799
 14800     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14801
 14802     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14803     MOVE 'OC'                   TO OC-RECORD-ID
 14804     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14805                                 TO OC-CONTROL-PRIMARY (1:33)
 14806     MOVE 'I'                    TO OC-RECORD-TYPE
 14807     MOVE +4096                  TO OC-KEY-SEQ-NO
 14808     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14809     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14810     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14811
 14812     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14813     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14814     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14815     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14816     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14817     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14818     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14819     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14820     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14821     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14822     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14823     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14824     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14825     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14826     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14827     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14828     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14829     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14830     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14831     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14832     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14833     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14834     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14835     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14836     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14837     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14838     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14839     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14840     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14841     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14842     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 14843     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 14844
 14845     IF ERMAIL-FOUND
 14846        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14847     END-IF
 14848     IF NOT CERT-TRL-REC-NOT-FOUND
 14849        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14850                           OC-INS-AGE-DEFAULT-FLAG
 14851        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 270
* VP6311.cbl
 14852                           OC-JNT-AGE-DEFAULT-FLAG
 14853     END-IF
 14854     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14855     .
 14856 2275-WRITE-ELCRTO.
 14857
 14858
 14859* EXEC CICS WRITE
 14860*       DATASET   ('ELCRTO')
 14861*       FROM      (ORIGINAL-CERTIFICATE)
 14862*       RIDFLD    (OC-CONTROL-PRIMARY)
 14863*       RESP      (WS-RESPONSE)
 14864*    END-EXEC
 14865     MOVE LENGTH OF
 14866      ORIGINAL-CERTIFICATE
 14867       TO DFHEIV11
 14868     MOVE 'ELCRTO' TO DFHEIV1
 14869*    MOVE '&$ L                  ''  N#00013276' TO DFHEIV0
 14870     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14871     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14872     MOVE X'204E233030303133323736' TO DFHEIV0(25:11)
 14873     CALL 'kxdfhei1' USING DFHEIV0,
 14874           DFHEIV1,
 14875           ORIGINAL-CERTIFICATE,
 14876           DFHEIV11,
 14877           OC-CONTROL-PRIMARY,
 14878           DFHEIV99,
 14879           DFHEIV99
 14880     MOVE EIBRESP  TO WS-RESPONSE
 14881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14882
 14883     display ' just wrote 2275 ' ws-response
 14884     IF RESP-DUPKEY
 14885        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14886        GO TO 2275-WRITE-ELCRTO
 14887     ELSE
 14888        IF NOT RESP-NORMAL
 14889           MOVE -1               TO BMAINTL
 14890           MOVE ER-7450          TO EMI-ERROR
 14891           PERFORM 9900-ERROR-FORMAT
 14892                                 THRU 9900-EXIT
 14893           GO TO 8200-SEND-DATAONLY
 14894        END-IF
 14895     END-IF.
 14896
 14897 2276-BYPASS-CRTO.
 14898******************************************************************
 14899*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14900******************************************************************
 14901
 14902
 14903* EXEC CICS READ
 14904*        INTO    (PENDING-BUSINESS)
 14905*        DATASET (FILE-ID-ERPNDB)
 14906*        RIDFLD  (ERPNDB-KEY)
 14907*        UPDATE
 14908*    END-EXEC.
 14909     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 271
* VP6311.cbl
 14910      PENDING-BUSINESS
 14911       TO DFHEIV11
 14912*    MOVE '&"IL       EU         (   #00013302' TO DFHEIV0
 14913     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14914     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14915     MOVE X'2020233030303133333032' TO DFHEIV0(25:11)
 14916     CALL 'kxdfhei1' USING DFHEIV0,
 14917           FILE-ID-ERPNDB,
 14918           PENDING-BUSINESS,
 14919           DFHEIV11,
 14920           ERPNDB-KEY,
 14921           DFHEIV99,
 14922           DFHEIV99,
 14923           DFHEIV99
 14924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14925
 14926
 14927     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14928     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14929     MOVE 'B'                    TO JP-RECORD-TYPE.
 14930     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14931
 14932     PERFORM 8400-LOG-JOURNAL-RECORD.
 14933
 14934     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14935
 14936
 14937* EXEC CICS REWRITE
 14938*        DATASET (FILE-ID-ERPNDB)
 14939*        FROM    (PENDING-BUSINESS)
 14940*    END-EXEC.
 14941     MOVE LENGTH OF
 14942      PENDING-BUSINESS
 14943       TO DFHEIV11
 14944*    MOVE '&& L                  %   #00013318' TO DFHEIV0
 14945     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14946     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14947     MOVE X'2020233030303133333138' TO DFHEIV0(25:11)
 14948     CALL 'kxdfhei1' USING DFHEIV0,
 14949           FILE-ID-ERPNDB,
 14950           PENDING-BUSINESS,
 14951           DFHEIV11,
 14952           DFHEIV99
 14953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14954
 14955
 14956     MOVE 'C'                    TO JP-RECORD-TYPE.
 14957     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14958
 14959     PERFORM 8400-LOG-JOURNAL-RECORD.
 14960
 14961     IF WS-ERRORS-PRESENT
 14962        GO TO 3900-RE-DISPLAY-RECORD.
 14963
 14964     MOVE ZEROS                  TO EMI-ERROR.
 14965     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14966     MOVE LOW-VALUES             TO VP631CI.
 14967     MOVE  -1                    TO CMAINTL.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 272
* VP6311.cbl
 14968     GO TO 8100-SEND-INITIAL-MAP.
 14969
 14970 2280-BATCH-HDR-NOT-FOUND.
 14971     MOVE -1                     TO BMAINTL.
 14972     MOVE ER-7450                TO EMI-ERROR.
 14973     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14974     GO TO 8200-SEND-DATAONLY.
 14975
 14976 2290-DUPLICATE-ALT-INDEX.
 14977
 14978******************************************************************
 14979*                                                                *
 14980*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 14981*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 14982*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 14983*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 14984*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 14985*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 14986*                                                                *
 14987******************************************************************
 14988
 14989     IF LCP-ONCTR-02 =  0
 14990         ADD 1 TO LCP-ONCTR-02
 14991        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 14992
 14993     ADD +1                      TO WS-SEQ-NO-COUNTER.
 14994
 14995     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 14996         NEXT SENTENCE
 14997     ELSE
 14998         ADD +1 TO PB-BATCH-SEQ-NO
 14999                   PB-CSR-BATCH-SEQ-NO
 15000         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15001         GO TO 2275-WRITE-PENDING-BUSINESS.
 15002
 15003     MOVE -1                     TO CCERTNOL.
 15004     MOVE AL-UABON               TO CCERTNOA.
 15005     MOVE AL-UNBON               TO CEFFDTA.
 15006
 15007     MOVE 1                      TO EMI-SUB
 15008                                    EMI-SWITCH1
 15009                                    EMI-SWITCH-AREA-1
 15010                                    EMI-SWITCH-AREA-2.
 15011
 15012     MOVE SPACES                 TO EMI-ERROR-LINES.
 15013
 15014
 15015* EXEC CICS SYNCPOINT ROLLBACK
 15016*    END-EXEC.
 15017*    MOVE '6"R                   !   #00013381' TO DFHEIV0
 15018     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15019     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15020     MOVE X'2020233030303133333831' TO DFHEIV0(25:11)
 15021     CALL 'kxdfhei1' USING DFHEIV0
 15022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15023
 15024
 15025     MOVE ER-2247                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 273
* VP6311.cbl
 15026     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15027     GO TO 8200-SEND-DATAONLY.
 15028
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 274
* VP6311.cbl
 15030
 15031******************************************************************
 15032*                                                                *
 15033*          C H A N G E   C A N C E L   R O U T I N E             *
 15034*                                                                *
 15035******************************************************************
 15036
 15037***************************************************************
 15038*                                                             *
 15039*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15040*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15041*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15042*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15043*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15044*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15045*     5. LINK TO THE EDIT ROUTINE.                            *
 15046*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15047*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15048*              THE EDIT ROUTINE.                              *
 15049*     7. REWRITE THE NEW ISSUE                                *
 15050*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15051*                                                             *
 15052***************************************************************
 15053 2300-CHANGE-CANCEL-ROUTINE.
 15054     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15055
 15056     IF CCHGL NOT = ZEROS
 15057        MOVE ER-2196             TO EMI-ERROR
 15058        MOVE AL-UABON            TO CMAINTA
 15059        MOVE -1                  TO CMAINTL
 15060        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15061        GO TO 8200-SEND-DATAONLY.
 15062
 15063     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15064
 15065     IF CSUFIXL NOT = ZEROS
 15066        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15067     ELSE
 15068        MOVE SPACE               TO WS-NEW-SUFFIX.
 15069
 15070     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15071     PERFORM 8600-DEEDIT.
 15072     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15073     MOVE '4'                    TO DC-OPTION-CODE.
 15074
 15075     PERFORM 9700-DATE-LINK.
 15076
 15077     IF DATE-CONVERSION-ERROR
 15078        MOVE ER-0348             TO EMI-ERROR
 15079        MOVE -1                  TO CEFFDTL
 15080        MOVE AL-UABON            TO CEFFDTA
 15081        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15082        GO TO 8200-SEND-DATAONLY
 15083     ELSE
 15084        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15085        MOVE AL-UANON            TO CEFFDTA
 15086        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15087
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 275
* VP6311.cbl
 15088 2325-PROCESS-CANCEL-CHANGES.
 15089
 15090* EXEC CICS HANDLE CONDITION
 15091*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15092*    END-EXEC.
 15093*    MOVE '"$I                   ! 5 #00013448' TO DFHEIV0
 15094     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15095     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15096     MOVE X'3520233030303133343438' TO DFHEIV0(25:11)
 15097     CALL 'kxdfhei1' USING DFHEIV0
 15098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15099
 15100
 15101     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15102     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15103     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15104
 15105
 15106* EXEC CICS GETMAIN
 15107*        SET      (ADDRESS OF PENDING-BUSINESS)
 15108*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15109*        INITIMG  (GETMAIN-SPACE)
 15110*     END-EXEC.
 15111*    MOVE ',"IL                  $   #00013456' TO DFHEIV0
 15112     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15113     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15114     MOVE X'2020233030303133343536' TO DFHEIV0(25:11)
 15115     CALL 'kxdfhei1' USING DFHEIV0,
 15116           DFHEIV20,
 15117           ERPNDB-RECORD-LENGTH,
 15118           GETMAIN-SPACE
 15119     SET ADDRESS OF PENDING-BUSINESS TO
 15120         DFHEIV20
 15121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15122
 15123
 15124
 15125* EXEC CICS READ
 15126*        INTO    (PENDING-BUSINESS)
 15127*        DATASET (FILE-ID-ERPNDB)
 15128*        RIDFLD  (ERPNDB-KEY)
 15129*    END-EXEC.
 15130     MOVE LENGTH OF
 15131      PENDING-BUSINESS
 15132       TO DFHEIV11
 15133*    MOVE '&"IL       E          (   #00013462' TO DFHEIV0
 15134     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15135     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15136     MOVE X'2020233030303133343632' TO DFHEIV0(25:11)
 15137     CALL 'kxdfhei1' USING DFHEIV0,
 15138           FILE-ID-ERPNDB,
 15139           PENDING-BUSINESS,
 15140           DFHEIV11,
 15141           ERPNDB-KEY,
 15142           DFHEIV99,
 15143           DFHEIV99,
 15144           DFHEIV99
 15145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 276
* VP6311.cbl
 15146
 15147
 15148     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15149
 15150
 15151* EXEC CICS HANDLE CONDITION
 15152*         NOTFND     (2385-REC-NOT-FOUND)
 15153*    END-EXEC.
 15154*    MOVE '"$I                   ! 6 #00013470' TO DFHEIV0
 15155     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15156     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15157     MOVE X'3620233030303133343730' TO DFHEIV0(25:11)
 15158     CALL 'kxdfhei1' USING DFHEIV0
 15159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15160
 15161
 15162**********************************************************
 15163*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15164*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15165**********************************************************
 15166
 15167
 15168* EXEC CICS READ
 15169*        DATASET (FILE-ID-ERPNDB)
 15170*        INTO    (PENDING-BUSINESS)
 15171*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15172*    END-EXEC.
 15173     MOVE LENGTH OF
 15174      PENDING-BUSINESS
 15175       TO DFHEIV11
 15176*    MOVE '&"IL       E          (   #00013479' TO DFHEIV0
 15177     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15178     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15179     MOVE X'2020233030303133343739' TO DFHEIV0(25:11)
 15180     CALL 'kxdfhei1' USING DFHEIV0,
 15181           FILE-ID-ERPNDB,
 15182           PENDING-BUSINESS,
 15183           DFHEIV11,
 15184           PI-PREV-CONTROL-PRIMARY,
 15185           DFHEIV99,
 15186           DFHEIV99,
 15187           DFHEIV99
 15188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15189
 15190
 15191********** DO NOT ALLOW CHANGES IF THRU A/R
 15192     IF BMAINTI = 'C'
 15193         IF PB-EL860-INTERNAL-PROCESS
 15194             MOVE ER-4005          TO EMI-ERROR
 15195             MOVE -1               TO BMAINTL
 15196             MOVE AL-UABON         TO BMAINTA
 15197             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15198             GO TO 8200-SEND-DATAONLY.
 15199**********
 15200
 15201     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15202        MOVE -1                 TO CMAINTL
 15203        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 277
* VP6311.cbl
 15204        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15205        GO TO 8200-SEND-DATAONLY.
 15206
 15207     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15208        MOVE ER-2196             TO EMI-ERROR
 15209        MOVE AL-UABON            TO CMAINTA
 15210        MOVE -1                  TO CMAINTL
 15211        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15212        GO TO 8200-SEND-DATAONLY.
 15213     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15214
 15215     IF PB-BILLED-DT = LOW-VALUES AND
 15216        PB-CHG-COUNT = ZEROS
 15217        NEXT SENTENCE
 15218     ELSE
 15219        IF (CREFND1L GREATER THAN ZEROS AND
 15220            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15221           OR
 15222           (CREFND2L GREATER THAN ZEROS AND
 15223            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15224           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15225     if ((crefnd1l <> zeros)
 15226        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15227                      or
 15228        ((crefnd2l <> zeros)
 15229        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15230        continue
 15231     else
 15232        go to 2330-continue-change
 15233     end-if
 15234
 15235     move zeros                  to ws-check-amts
 15236     move ' '                    to ws-stop-sw
 15237                                    ws-check-sw
 15238                                    ws-proc-check-sw
 15239                                    ws-chek-browse-sw
 15240
 15241     perform 2500-browse-checks  thru 2500-exit
 15242
 15243     if i-have-processed-checks
 15244        or i-have-checks
 15245        continue
 15246     else
 15247        go to 2330-continue-change
 15248     end-if
 15249
 15250     if crefnd1l <> zeros
 15251        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15252        move ws-crefnd1 to ws-new-ref-total
 15253     else
 15254        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15255     end-if
 15256     if crefnd2l <> zeros
 15257        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15258        compute ws-new-ref-total = ws-new-ref-total +
 15259           ws-crefnd2
 15260     else
 15261        compute ws-new-ref-total = ws-new-ref-total +
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 278
* VP6311.cbl
 15262           pb-c-ah-cancel-amt
 15263     end-if
 15264
 15265     if zeros = (ws-lf-diff + ws-ah-diff)
 15266        move er-3449             to emi-error
 15267        perform 9900-error-format thru 9900-exit
 15268        go to 2330-continue-change
 15269     end-if
 15270
 15271     if (ws-new-ref-total < ws-check-amts)
 15272        and (pb-c-refund-sw = 'Y')
 15273        move er-3447             to emi-error
 15274        perform 9900-error-format thru 9900-exit
 15275        move al-uabon            to cmainta
 15276        move -1                  to cmaintl
 15277        go to 8200-send-dataonly
 15278     end-if
 15279
 15280     if (ws-new-ref-total > ws-check-amts)
 15281        and (ws-check-amts not = zeros)
 15282        move er-3448             to emi-error
 15283        move al-uabon            to crefnd1a
 15284                                    crefnd2a
 15285        perform 9900-error-format thru 9900-exit
 15286     end-if
 15287
 15288*     if (ws-lf-diff + ws-ah-diff) < zeros
 15289*        move er-3447             to emi-error
 15290*        perform 9900-error-format thru 9900-exit
 15291*        move al-uabon            to cmainta
 15292*        move -1                  to cmaintl
 15293*        go to 8200-send-dataonly
 15294*     end-if
 15295     .
 15296 2330-continue-change.
 15297
 15298
 15299* EXEC CICS READ
 15300*        DATASET (FILE-ID-ERPNDB)
 15301*        INTO    (PENDING-BUSINESS)
 15302*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15303*        UPDATE
 15304*    END-EXEC.
 15305     MOVE LENGTH OF
 15306      PENDING-BUSINESS
 15307       TO DFHEIV11
 15308*    MOVE '&"IL       EU         (   #00013592' TO DFHEIV0
 15309     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15310     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15311     MOVE X'2020233030303133353932' TO DFHEIV0(25:11)
 15312     CALL 'kxdfhei1' USING DFHEIV0,
 15313           FILE-ID-ERPNDB,
 15314           PENDING-BUSINESS,
 15315           DFHEIV11,
 15316           PI-PREV-CONTROL-PRIMARY,
 15317           DFHEIV99,
 15318           DFHEIV99,
 15319           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 279
* VP6311.cbl
 15320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15321
 15322
 15323     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15324     MOVE 'B'                    TO JP-RECORD-TYPE
 15325     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15326     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15327
 15328     PERFORM 8400-LOG-JOURNAL-RECORD.
 15329
 15330     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15331          PB-CHG-COUNT NOT = ZEROS
 15332        IF (CREFND1L GREATER THAN ZEROS AND
 15333            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15334           OR
 15335           (CREFND2L GREATER THAN ZEROS AND
 15336            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15337            ADD +1                      TO PB-CHG-COUNT
 15338            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15339
 15340*    IF CMICRNOL  GREATER  ZEROS
 15341*        IF CMICRNOI  NUMERIC
 15342*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15343*            MOVE AL-UNNON       TO  CMICRNOA
 15344*        ELSE
 15345*            MOVE -1             TO  CMICRNOL
 15346*            MOVE AL-UNBON       TO  CMICRNOA
 15347*            MOVE ER-2701        TO  EMI-ERROR
 15348*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15349
 15350     IF CSUFIXL GREATER THAN ZEROS
 15351        MOVE CSUFIXI             TO PB-CERT-SFX.
 15352
 15353     IF CLSTNML GREATER THAN ZEROS
 15354         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15355
 15356     IF CCANREAL > ZEROS
 15357        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15358     END-IF
 15359     IF CCANDT1L    GREATER THAN ZEROS
 15360        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15361
 15362     IF CCANDT2L    GREATER THAN ZEROS
 15363        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15364
 15365     IF CMTHD1L    GREATER THAN +0
 15366        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15367
 15368     IF CMTHD2L    GREATER THAN +0
 15369        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15370
 15371     IF CREFND1L    GREATER THAN ZEROS
 15372        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15373        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15374        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15375        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15376
 15377     IF CREFND2L    GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 280
* VP6311.cbl
 15378        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15379        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15380        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15381        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15382
 15383     IF CLIVESL     GREATER THAN ZEROS
 15384        MOVE WS-CLIVES           TO PB-C-LIVES.
 15385
 15386     IF CPAYEEL     GREATER THAN ZEROS
 15387        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15388
 15389     IF CFORCEL     GREATER THAN ZEROS
 15390        MOVE CFORCEI             TO PB-FORCE-CODE.
 15391
 15392     IF CBILCDL     GREATER THAN ZEROS
 15393        MOVE CBILCDI             TO PB-RECORD-BILL.
 15394
 15395 2360-REWRITE-PB-RECORD.
 15396     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15397     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15398     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15399     MOVE 'C'                    TO JP-RECORD-TYPE.
 15400     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15401     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15402     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15403
 15404     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15405
 15406     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15407     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15408
 15409     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15410
 15411     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15412
 15413     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15414     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15415     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15416
 15417     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15418     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15419
 15420 2375-REWRITE-PENDING-BUSINESS.
 15421     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15422     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15423     MOVE 'C'                    TO JP-RECORD-TYPE.
 15424     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15425
 15426
 15427* EXEC CICS REWRITE
 15428*        DATASET (FILE-ID-ERPNDB)
 15429*        FROM    (PENDING-BUSINESS)
 15430*    END-EXEC.
 15431     MOVE LENGTH OF
 15432      PENDING-BUSINESS
 15433       TO DFHEIV11
 15434*    MOVE '&& L                  %   #00013702' TO DFHEIV0
 15435     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 281
* VP6311.cbl
 15436     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15437     MOVE X'2020233030303133373032' TO DFHEIV0(25:11)
 15438     CALL 'kxdfhei1' USING DFHEIV0,
 15439           FILE-ID-ERPNDB,
 15440           PENDING-BUSINESS,
 15441           DFHEIV11,
 15442           DFHEIV99
 15443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15444
 15445
 15446     PERFORM 8400-LOG-JOURNAL-RECORD.
 15447
 15448******************************************************************
 15449*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15450******************************************************************
 15451
 15452     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15453     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15454     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15455     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15456
 15457
 15458* EXEC CICS READ
 15459*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15460*        DATASET (FILE-ID-ELCERT)
 15461*        RIDFLD  (ELCERT-KEY)
 15462*        RESP    (WS-RESPONSE)
 15463*    END-EXEC.
 15464*    MOVE '&"S        E          (  N#00013718' TO DFHEIV0
 15465     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15466     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15467     MOVE X'204E233030303133373138' TO DFHEIV0(25:11)
 15468     CALL 'kxdfhei1' USING DFHEIV0,
 15469           FILE-ID-ELCERT,
 15470           DFHEIV20,
 15471           DFHEIV99,
 15472           ELCERT-KEY,
 15473           DFHEIV99,
 15474           DFHEIV99,
 15475           DFHEIV99
 15476     SET ADDRESS OF CERTIFICATE-MASTER TO
 15477         DFHEIV20
 15478     MOVE EIBRESP  TO WS-RESPONSE
 15479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15480
 15481
 15482     IF NOT RESP-NORMAL
 15483        GO TO 2376-BYPASS-CRTO
 15484     END-IF
 15485
 15486
 15487     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15488     MOVE ' '                    TO WS-ERMAIL-SW
 15489
 15490
 15491* EXEC CICS READ
 15492*       DATASET   (FILE-ID-ERMAIL)
 15493*       SET       (ADDRESS OF MAILING-DATA)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 282
* VP6311.cbl
 15494*       RIDFLD    (ERMAIL-KEY)
 15495*       RESP      (WS-RESPONSE)
 15496*    END-EXEC
 15497*    MOVE '&"S        E          (  N#00013733' TO DFHEIV0
 15498     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15499     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15500     MOVE X'204E233030303133373333' TO DFHEIV0(25:11)
 15501     CALL 'kxdfhei1' USING DFHEIV0,
 15502           FILE-ID-ERMAIL,
 15503           DFHEIV20,
 15504           DFHEIV99,
 15505           ERMAIL-KEY,
 15506           DFHEIV99,
 15507           DFHEIV99,
 15508           DFHEIV99
 15509     SET ADDRESS OF MAILING-DATA TO
 15510         DFHEIV20
 15511     MOVE EIBRESP  TO WS-RESPONSE
 15512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15513
 15514     IF RESP-NORMAL
 15515        SET ERMAIL-FOUND TO TRUE
 15516     END-IF
 15517
 15518     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15519
 15520     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15521                                 TO ELCRTO-KEY
 15522     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15523     MOVE +0                     TO ELCRTO-SEQ-NO
 15524
 15525
 15526* EXEC CICS READ
 15527*       DATASET   ('ELCRTO')
 15528*       INTO      (ORIGINAL-CERTIFICATE)
 15529*       RIDFLD    (ELCRTO-KEY)
 15530*       GTEQ
 15531*       RESP      (WS-RESPONSE)
 15532*    END-EXEC
 15533     MOVE LENGTH OF
 15534      ORIGINAL-CERTIFICATE
 15535       TO DFHEIV11
 15536     MOVE 'ELCRTO' TO DFHEIV1
 15537*    MOVE '&"IL       G          (  N#00013751' TO DFHEIV0
 15538     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15539     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15540     MOVE X'204E233030303133373531' TO DFHEIV0(25:11)
 15541     CALL 'kxdfhei1' USING DFHEIV0,
 15542           DFHEIV1,
 15543           ORIGINAL-CERTIFICATE,
 15544           DFHEIV11,
 15545           ELCRTO-KEY,
 15546           DFHEIV99,
 15547           DFHEIV99,
 15548           DFHEIV99
 15549     MOVE EIBRESP  TO WS-RESPONSE
 15550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15551
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 283
* VP6311.cbl
 15552     IF RESP-NORMAL
 15553        AND (OC-CONTROL-PRIMARY (1:33) =
 15554                 PB-CONTROL-BY-ACCOUNT (1:33))
 15555        AND (OC-RECORD-TYPE = 'I')
 15556        display ' resp norm, key =, type i '
 15557        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15558           display ' end proc blank '
 15559           display ' csr edit session ' PI-CSR-SESSION-SW
 15560           IF NOT CSR-EDIT-SESSION
 15561
 15562* EXEC CICS READ
 15563*                DATASET   ('ELCRTO')
 15564*                INTO      (ORIGINAL-CERTIFICATE)
 15565*                RIDFLD    (OC-CONTROL-PRIMARY)
 15566*                UPDATE
 15567*                RESP      (WS-RESPONSE)
 15568*             END-EXEC
 15569     MOVE LENGTH OF
 15570      ORIGINAL-CERTIFICATE
 15571       TO DFHEIV11
 15572     MOVE 'ELCRTO' TO DFHEIV1
 15573*    MOVE '&"IL       EU         (  N#00013768' TO DFHEIV0
 15574     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15575     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15576     MOVE X'204E233030303133373638' TO DFHEIV0(25:11)
 15577     CALL 'kxdfhei1' USING DFHEIV0,
 15578           DFHEIV1,
 15579           ORIGINAL-CERTIFICATE,
 15580           DFHEIV11,
 15581           OC-CONTROL-PRIMARY,
 15582           DFHEIV99,
 15583           DFHEIV99,
 15584           DFHEIV99
 15585     MOVE EIBRESP  TO WS-RESPONSE
 15586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15587              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15588              IF RESP-NORMAL
 15589                 display ' good read upd '
 15590                 IF OC-ISSUE-TRAN-IND = 'N'
 15591                    MOVE CM-INSURED-LAST-NAME   TO
 15592                         OC-INS-LAST-NAME
 15593                    MOVE CM-INSURED-FIRST-NAME  TO
 15594                         OC-INS-FIRST-NAME
 15595                    MOVE CM-INSURED-INITIAL2    TO
 15596                         OC-INS-MIDDLE-INIT
 15597                    MOVE CM-INSURED-ISSUE-AGE   TO
 15598                         OC-INS-AGE
 15599                    MOVE CM-JT-LAST-NAME        TO
 15600                         OC-JNT-LAST-NAME
 15601                    MOVE CM-JT-FIRST-NAME       TO
 15602                         OC-JNT-FIRST-NAME
 15603                    MOVE CM-JT-INITIAL          TO
 15604                         OC-JNT-MIDDLE-INIT
 15605                    MOVE CM-INSURED-JOINT-AGE   TO
 15606                         OC-JNT-AGE
 15607                    MOVE CM-LF-BENEFIT-CD       TO
 15608                         OC-LF-BENCD
 15609                    MOVE CM-LF-ORIG-TERM        TO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 284
* VP6311.cbl
 15610                         OC-LF-TERM
 15611                    MOVE CM-LF-BENEFIT-AMT      TO
 15612                         OC-LF-BEN-AMT
 15613                    MOVE CM-LF-PREMIUM-AMT      TO
 15614                         OC-LF-PRM-AMT
 15615                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15616                         OC-LF-ALT-BEN-AMT
 15617                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15618                         OC-LF-ALT-PRM-AMT
 15619                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15620                         OC-LF-EXP-DT
 15621                    MOVE CM-LIFE-COMM-PCT       TO
 15622                         OC-LF-COMM-PCT
 15623                    MOVE CM-AH-BENEFIT-CD       TO
 15624                         OC-AH-BENCD
 15625                    MOVE CM-AH-ORIG-TERM        TO
 15626                         OC-AH-TERM
 15627                    MOVE CM-AH-BENEFIT-AMT      TO
 15628                         OC-AH-BEN-AMT
 15629                    MOVE CM-AH-PREMIUM-AMT      TO
 15630                         OC-AH-PRM-AMT
 15631                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15632                         OC-AH-EXP-DT
 15633                    MOVE CM-AH-COMM-PCT         TO
 15634                         OC-AH-COMM-PCT
 15635                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15636                         OC-AH-CP
 15637                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15638                         OC-1ST-PMT-DT
 15639                 END-IF
 15640                 MOVE PB-C-LF-CANCEL-DT      TO
 15641                         OC-LF-CANCEL-DT
 15642                 MOVE PB-C-LF-CANCEL-AMT     TO
 15643                         OC-LF-CANCEL-AMT
 15644                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15645                         OC-LF-ITD-CANCEL-AMT
 15646                 MOVE PB-C-AH-CANCEL-DT      TO
 15647                         OC-AH-CANCEL-DT
 15648                 MOVE PB-C-AH-CANCEL-AMT     TO
 15649                         OC-AH-CANCEL-AMT
 15650                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15651                         OC-AH-ITD-CANCEL-AMT
 15652                 MOVE 'Y'                    TO
 15653                         OC-CANCEL-TRAN-IND
 15654                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15655                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15656                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15657                 IF ERMAIL-FOUND
 15658                    MOVE MA-CRED-BENE-NAME
 15659                                 TO OC-CRED-BENE-NAME
 15660                 END-IF
 15661                 IF NOT CERT-TRL-REC-NOT-FOUND
 15662                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15663                           OC-INS-AGE-DEFAULT-FLAG
 15664                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15665                           OC-JNT-AGE-DEFAULT-FLAG
 15666                 END-IF
 15667
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 285
* VP6311.cbl
 15668* EXEC CICS REWRITE
 15669*                   DATASET   ('ELCRTO')
 15670*                   FROM      (ORIGINAL-CERTIFICATE)
 15671*                   RESP      (WS-RESPONSE)
 15672*                END-EXEC
 15673     MOVE LENGTH OF
 15674      ORIGINAL-CERTIFICATE
 15675       TO DFHEIV11
 15676     MOVE 'ELCRTO' TO DFHEIV1
 15677*    MOVE '&& L                  %  N#00013855' TO DFHEIV0
 15678     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15679     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15680     MOVE X'204E233030303133383535' TO DFHEIV0(25:11)
 15681     CALL 'kxdfhei1' USING DFHEIV0,
 15682           DFHEIV1,
 15683           ORIGINAL-CERTIFICATE,
 15684           DFHEIV11,
 15685           DFHEIV99
 15686     MOVE EIBRESP  TO WS-RESPONSE
 15687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15688                 display ' just rewrote ' ws-response
 15689              END-IF
 15690           END-IF
 15691        ELSE
 15692           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15693           MOVE 'OC'             TO OC-RECORD-ID
 15694           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15695           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15696           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15697           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15698           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15699           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15700           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15701           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15702           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15703           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15704           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15705           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15706           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15707           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15708           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15709           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15710           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15711           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15712           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15713           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15714           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15715           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15716           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15717           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15718           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15719           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15720           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15721           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15722           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15723           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15724           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15725           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 286
* VP6311.cbl
 15726           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15727           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15728           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15729           IF ERMAIL-FOUND
 15730              MOVE MA-CRED-BENE-NAME
 15731                                 TO OC-CRED-BENE-NAME
 15732           END-IF
 15733           IF NOT CERT-TRL-REC-NOT-FOUND
 15734              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15735                           OC-INS-AGE-DEFAULT-FLAG
 15736              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15737                           OC-JNT-AGE-DEFAULT-FLAG
 15738           END-IF
 15739           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15740
 15741* EXEC CICS WRITE
 15742*             DATASET   ('ELCRTO')
 15743*             FROM      (ORIGINAL-CERTIFICATE)
 15744*             RIDFLD    (OC-CONTROL-PRIMARY)
 15745*             RESP      (WS-RESPONSE)
 15746*          END-EXEC
 15747     MOVE LENGTH OF
 15748      ORIGINAL-CERTIFICATE
 15749       TO DFHEIV11
 15750     MOVE 'ELCRTO' TO DFHEIV1
 15751*    MOVE '&$ L                  ''  N#00013912' TO DFHEIV0
 15752     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15753     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15754     MOVE X'204E233030303133393132' TO DFHEIV0(25:11)
 15755     CALL 'kxdfhei1' USING DFHEIV0,
 15756           DFHEIV1,
 15757           ORIGINAL-CERTIFICATE,
 15758           DFHEIV11,
 15759           OC-CONTROL-PRIMARY,
 15760           DFHEIV99,
 15761           DFHEIV99
 15762     MOVE EIBRESP  TO WS-RESPONSE
 15763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15764        END-IF
 15765     ELSE
 15766        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15767        MOVE 'OC'                TO OC-RECORD-ID
 15768        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15769                                 TO OC-CONTROL-PRIMARY (1:33)
 15770        MOVE 'I'                 TO OC-RECORD-TYPE
 15771        MOVE +4096               TO OC-KEY-SEQ-NO
 15772        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15773        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15774        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15775        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15776        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15777        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15778        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15779        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15780        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15781        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15782        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15783        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 287
* VP6311.cbl
 15784        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15785        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15786        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15787        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15788        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15789        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15790        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15791        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15792        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15793        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15794        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15795        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15796        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15797        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15798        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15799        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15800        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15801        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15802        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15803        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15804        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15805        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15806        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15807        IF ERMAIL-FOUND
 15808           MOVE MA-CRED-BENE-NAME
 15809                                 TO OC-CRED-BENE-NAME
 15810        END-IF
 15811        IF NOT CERT-TRL-REC-NOT-FOUND
 15812           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15813                           OC-INS-AGE-DEFAULT-FLAG
 15814           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15815                           OC-JNT-AGE-DEFAULT-FLAG
 15816        END-IF
 15817        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15818
 15819
 15820* EXEC CICS WRITE
 15821*          DATASET   ('ELCRTO')
 15822*          FROM      (ORIGINAL-CERTIFICATE)
 15823*          RIDFLD    (OC-CONTROL-PRIMARY)
 15824*          RESP      (WS-RESPONSE)
 15825*       END-EXEC
 15826     MOVE LENGTH OF
 15827      ORIGINAL-CERTIFICATE
 15828       TO DFHEIV11
 15829     MOVE 'ELCRTO' TO DFHEIV1
 15830*    MOVE '&$ L                  ''  N#00013973' TO DFHEIV0
 15831     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15832     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15833     MOVE X'204E233030303133393733' TO DFHEIV0(25:11)
 15834     CALL 'kxdfhei1' USING DFHEIV0,
 15835           DFHEIV1,
 15836           ORIGINAL-CERTIFICATE,
 15837           DFHEIV11,
 15838           OC-CONTROL-PRIMARY,
 15839           DFHEIV99,
 15840           DFHEIV99
 15841     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 288
* VP6311.cbl
 15842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15843     END-IF.
 15844
 15845 2376-BYPASS-CRTO.
 15846******************************************************************
 15847*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15848******************************************************************
 15849
 15850
 15851* EXEC CICS HANDLE CONDITION
 15852*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15853*    END-EXEC.
 15854*    MOVE '"$I                   ! 7 #00013986' TO DFHEIV0
 15855     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15856     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15857     MOVE X'3720233030303133393836' TO DFHEIV0(25:11)
 15858     CALL 'kxdfhei1' USING DFHEIV0
 15859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15860
 15861
 15862
 15863* EXEC CICS READ
 15864*        INTO    (PENDING-BUSINESS)
 15865*        DATASET (FILE-ID-ERPNDB)
 15866*        RIDFLD  (ERPNDB-KEY)
 15867*        UPDATE
 15868*    END-EXEC.
 15869     MOVE LENGTH OF
 15870      PENDING-BUSINESS
 15871       TO DFHEIV11
 15872*    MOVE '&"IL       EU         (   #00013990' TO DFHEIV0
 15873     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15874     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15875     MOVE X'2020233030303133393930' TO DFHEIV0(25:11)
 15876     CALL 'kxdfhei1' USING DFHEIV0,
 15877           FILE-ID-ERPNDB,
 15878           PENDING-BUSINESS,
 15879           DFHEIV11,
 15880           ERPNDB-KEY,
 15881           DFHEIV99,
 15882           DFHEIV99,
 15883           DFHEIV99
 15884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15885
 15886
 15887     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15888     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15889     MOVE 'B'                    TO JP-RECORD-TYPE.
 15890     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15891
 15892     PERFORM 8400-LOG-JOURNAL-RECORD.
 15893
 15894     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15895
 15896
 15897* EXEC CICS REWRITE
 15898*        DATASET (FILE-ID-ERPNDB)
 15899*        FROM    (PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 289
* VP6311.cbl
 15900*    END-EXEC.
 15901     MOVE LENGTH OF
 15902      PENDING-BUSINESS
 15903       TO DFHEIV11
 15904*    MOVE '&& L                  %   #00014006' TO DFHEIV0
 15905     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15906     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15907     MOVE X'2020233030303134303036' TO DFHEIV0(25:11)
 15908     CALL 'kxdfhei1' USING DFHEIV0,
 15909           FILE-ID-ERPNDB,
 15910           PENDING-BUSINESS,
 15911           DFHEIV11,
 15912           DFHEIV99
 15913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15914
 15915
 15916     MOVE 'C'                    TO JP-RECORD-TYPE.
 15917     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15918
 15919     PERFORM 8400-LOG-JOURNAL-RECORD.
 15920
 15921     IF WS-ERRORS-PRESENT
 15922         GO TO 3900-RE-DISPLAY-RECORD.
 15923
 15924     MOVE ZEROS                  TO EMI-ERROR
 15925     MOVE -1                     TO CMAINTL
 15926     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15927     GO TO 3900-RE-DISPLAY-RECORD.
 15928
 15929 2380-BATCH-HDR-NOT-FOUND.
 15930     MOVE -1                     TO BMAINTL.
 15931     MOVE ER-7450                TO EMI-ERROR.
 15932     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15933     GO TO 8200-SEND-DATAONLY.
 15934
 15935 2385-REC-NOT-FOUND.
 15936     MOVE -1                     TO BMAINTL.
 15937     MOVE ER-7451                TO EMI-ERROR.
 15938     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15939     GO TO 8200-SEND-DATAONLY.
 15940
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 290
* VP6311.cbl
 15942
 15943******************************************************************
 15944*                                                                *
 15945*          D E L E T E   C A N C E L   R O U T I N E             *
 15946*                                                                *
 15947******************************************************************
 15948
 15949 2400-DELETE-CANCEL-ROUTINE.
 15950     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15951
 15952     IF CCHGL NOT = ZEROS
 15953        MOVE ER-2196             TO EMI-ERROR
 15954        MOVE AL-UABON            TO CMAINTA
 15955        MOVE -1                  TO CMAINTL
 15956        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15957        GO TO 8200-SEND-DATAONLY.
 15958
 15959
 15960* EXEC CICS HANDLE CONDITION
 15961*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15962*    END-EXEC.
 15963*    MOVE '"$I                   ! 8 #00014054' TO DFHEIV0
 15964     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15965     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15966     MOVE X'3820233030303134303534' TO DFHEIV0(25:11)
 15967     CALL 'kxdfhei1' USING DFHEIV0
 15968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15969
 15970
 15971     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15972     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15973     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15974
 15975
 15976* EXEC CICS READ
 15977*        SET     (ADDRESS OF PENDING-BUSINESS)
 15978*        DATASET (FILE-ID-ERPNDB)
 15979*        RIDFLD  (ERPNDB-KEY)
 15980*    END-EXEC.
 15981*    MOVE '&"S        E          (   #00014062' TO DFHEIV0
 15982     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15983     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15984     MOVE X'2020233030303134303632' TO DFHEIV0(25:11)
 15985     CALL 'kxdfhei1' USING DFHEIV0,
 15986           FILE-ID-ERPNDB,
 15987           DFHEIV20,
 15988           DFHEIV99,
 15989           ERPNDB-KEY,
 15990           DFHEIV99,
 15991           DFHEIV99,
 15992           DFHEIV99
 15993     SET ADDRESS OF PENDING-BUSINESS TO
 15994         DFHEIV20
 15995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15996
 15997
 15998     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15999
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 291
* VP6311.cbl
 16000     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16001
 16002     IF CSUFIXL NOT = ZEROS
 16003        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16004     ELSE
 16005        MOVE SPACE               TO WS-NEW-SUFFIX.
 16006
 16007     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16008
 16009     PERFORM 8600-DEEDIT.
 16010     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16011     MOVE '4'                    TO DC-OPTION-CODE.
 16012     PERFORM 9700-DATE-LINK.
 16013
 16014     IF DATE-CONVERSION-ERROR
 16015        MOVE ER-0348             TO EMI-ERROR
 16016        MOVE -1                  TO CEFFDTL
 16017        MOVE AL-UABON            TO CEFFDTA
 16018        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16019        GO TO 8200-SEND-DATAONLY
 16020     ELSE
 16021        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16022        MOVE AL-UANON            TO CEFFDTA
 16023        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16024
 16025
 16026* EXEC CICS HANDLE CONDITION
 16027*         NOTFND    (2490-RECORD-NOT-FOUND)
 16028*    END-EXEC.
 16029*    MOVE '"$I                   ! 9 #00014095' TO DFHEIV0
 16030     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16031     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16032     MOVE X'3920233030303134303935' TO DFHEIV0(25:11)
 16033     CALL 'kxdfhei1' USING DFHEIV0
 16034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16035
 16036
 16037
 16038* EXEC CICS READ
 16039*        SET     (ADDRESS OF PENDING-BUSINESS)
 16040*        DATASET (FILE-ID-ERPNDB)
 16041*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16042*        UPDATE
 16043*    END-EXEC.
 16044*    MOVE '&"S        EU         (   #00014099' TO DFHEIV0
 16045     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16046     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16047     MOVE X'2020233030303134303939' TO DFHEIV0(25:11)
 16048     CALL 'kxdfhei1' USING DFHEIV0,
 16049           FILE-ID-ERPNDB,
 16050           DFHEIV20,
 16051           DFHEIV99,
 16052           PI-PREV-CONTROL-PRIMARY,
 16053           DFHEIV99,
 16054           DFHEIV99,
 16055           DFHEIV99
 16056     SET ADDRESS OF PENDING-BUSINESS TO
 16057         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 292
* VP6311.cbl
 16058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16059
 16060
 16061     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16062        MOVE -1                 TO CMAINTL
 16063        MOVE ER-2197            TO EMI-ERROR
 16064        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16065        GO TO 8200-SEND-DATAONLY.
 16066
 16067     IF PB-BILLED-DT NOT = LOW-VALUES
 16068        MOVE -1                 TO CMAINTL
 16069        MOVE ER-2129            TO EMI-ERROR
 16070        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16071        GO TO 8200-SEND-DATAONLY.
 16072
 16073     IF PB-CHG-COUNT NOT = ZEROS
 16074        MOVE ER-2336            TO EMI-ERROR
 16075        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16076        MOVE AL-UABON            TO CMAINTA
 16077        MOVE -1                  TO CMAINTL
 16078        GO TO 8200-SEND-DATAONLY.
 16079
 16080     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16081        PB-CHG-COUNT NOT = ZEROS
 16082        MOVE ER-2196             TO EMI-ERROR
 16083        MOVE AL-UABON            TO CMAINTA
 16084        MOVE -1                  TO CMAINTL
 16085        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16086        GO TO 8200-SEND-DATAONLY.
 16087
 16088     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16089        MOVE ER-2900 TO EMI-ERROR
 16090        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16091        MOVE AL-UABON         TO CMAINTA
 16092        MOVE -1               TO CMAINTL
 16093        GO TO 8200-SEND-DATAONLY.
 16094     move ' '                    to ws-stop-sw
 16095                                    ws-check-sw
 16096                                    ws-proc-check-sw
 16097                                    ws-chek-browse-sw
 16098
 16099     perform 2500-browse-checks  thru 2500-exit
 16100     if (i-have-processed-checks)
 16101        and (pb-c-refund-sw = 'Y')
 16102        move er-3446             to emi-error
 16103        perform 9900-error-format thru 9900-exit
 16104        move al-uabon            to cmainta
 16105        move -1                  to cmaintl
 16106        go to 8200-send-dataonly
 16107     end-if
 16108
 16109* EXEC CICS HANDLE CONDITION
 16110*         NOTFND  (2475-CONTINUE-DELETE)
 16111*    END-EXEC
 16112*    MOVE '"$I                   ! : #00014153' TO DFHEIV0
 16113     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16114     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16115     MOVE X'3A20233030303134313533' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 293
* VP6311.cbl
 16116     CALL 'kxdfhei1' USING DFHEIV0
 16117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16118
 16119     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16120     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16121     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16122     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16123
 16124
 16125* EXEC CICS READ
 16126*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16127*        DATASET (FILE-ID-ELCERT)
 16128*        RIDFLD  (ELCERT-KEY)
 16129*        UPDATE
 16130*    END-EXEC.
 16131*    MOVE '&"S        EU         (   #00014162' TO DFHEIV0
 16132     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16133     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16134     MOVE X'2020233030303134313632' TO DFHEIV0(25:11)
 16135     CALL 'kxdfhei1' USING DFHEIV0,
 16136           FILE-ID-ELCERT,
 16137           DFHEIV20,
 16138           DFHEIV99,
 16139           ELCERT-KEY,
 16140           DFHEIV99,
 16141           DFHEIV99,
 16142           DFHEIV99
 16143     SET ADDRESS OF CERTIFICATE-MASTER TO
 16144         DFHEIV20
 16145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16146
 16147
 16148     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16149
 16150     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16151     MOVE 'B'                    TO JP-RECORD-TYPE.
 16152     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16153     PERFORM 8400-LOG-JOURNAL-RECORD.
 16154
 16155     IF PB-CI-LIVES NOT NUMERIC
 16156         MOVE ZERO                    TO PB-CI-LIVES.
 16157
 16158     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16159        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16160           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16161           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16162           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16163                                            CM-LF-CANCEL-DT
 16164           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16165        ELSE
 16166           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16167           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16168           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16169           MOVE PB-CI-LIVES              TO CM-LIVES.
 16170
 16171     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16172        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16173           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 294
* VP6311.cbl
 16174               MOVE CM-LF-STATUS-AT-CANCEL
 16175                                        TO CM-LF-CURRENT-STATUS
 16176               MOVE SPACE
 16177                                        TO CM-LF-STATUS-AT-CANCEL
 16178           ELSE
 16179               MOVE PB-CI-LF-POLICY-STATUS
 16180                                        TO CM-LF-CURRENT-STATUS
 16181        ELSE
 16182           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16183
 16184
 16185     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16186        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16187           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16188           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16189           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16190                                            CM-AH-CANCEL-DT
 16191           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16192        ELSE
 16193           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16194           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16195           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16196           MOVE PB-CI-LIVES              TO CM-LIVES.
 16197
 16198     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16199        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16200           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16201               MOVE CM-AH-STATUS-AT-CANCEL
 16202                                        TO CM-AH-CURRENT-STATUS
 16203               MOVE SPACE
 16204                                        TO CM-AH-STATUS-AT-CANCEL
 16205           ELSE
 16206               MOVE PB-CI-AH-POLICY-STATUS
 16207                                        TO CM-AH-CURRENT-STATUS
 16208        ELSE
 16209           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16210
 16211 2450-REWRITE-CERT.
 16212     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16213     MOVE 'C'                      TO JP-RECORD-TYPE.
 16214     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16215
 16216
 16217* EXEC CICS REWRITE
 16218*        DATASET  (FILE-ID-ELCERT)
 16219*        FROM     (CERTIFICATE-MASTER)
 16220*    END-EXEC.
 16221     MOVE LENGTH OF
 16222      CERTIFICATE-MASTER
 16223       TO DFHEIV11
 16224*    MOVE '&& L                  %   #00014237' TO DFHEIV0
 16225     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16226     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16227     MOVE X'2020233030303134323337' TO DFHEIV0(25:11)
 16228     CALL 'kxdfhei1' USING DFHEIV0,
 16229           FILE-ID-ELCERT,
 16230           CERTIFICATE-MASTER,
 16231           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 295
* VP6311.cbl
 16232           DFHEIV99
 16233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16234
 16235
 16236     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16237
 16238     PERFORM 8400-LOG-JOURNAL-RECORD.
 16239
 16240     move ' '                    to ws-stop-sw
 16241                                    ws-proc-check-sw
 16242                                    ws-chek-browse-sw
 16243
 16244     if i-have-checks
 16245        perform until i-say-stop
 16246           perform 2510-startbr-erchek
 16247                                 thru 2510-exit
 16248           if resp-normal
 16249              perform 2520-readnext-erchek
 16250                                 thru 2520-exit
 16251           end-if
 16252           if (not resp-normal)
 16253              or (pb-control-by-account (1:33) not =
 16254                 ch-control-primary (1:33))
 16255                 set i-say-stop to true
 16256           else
 16257              perform 2530-readupd-erchek
 16258                                 thru 2530-exit
 16259              if resp-normal
 16260                 perform 2540-delete-erchek
 16261                                 thru 2540-exit
 16262              end-if
 16263              if ws-chek-browse-sw = 'Y'
 16264                 perform 2525-endbr-erchek
 16265                                 thru 2525-exit
 16266                 move ' '        to ws-chek-browse-sw
 16267              end-if
 16268           end-if
 16269        end-perform
 16270     end-if
 16271
 16272     if ws-chek-browse-sw = 'Y'
 16273        perform 2525-endbr-erchek thru 2525-exit
 16274     end-if
 16275     .
 16276 2475-CONTINUE-DELETE.
 16277     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16278     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16279
 16280     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16281     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16282
 16283     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16284
 16285     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16286     MOVE 'D'                    TO JP-RECORD-TYPE
 16287     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16288
 16289
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 296
* VP6311.cbl
 16290* EXEC CICS DELETE
 16291*        DATASET    (FILE-ID-ERPNDB)
 16292*    END-EXEC.
 16293*    MOVE '&(                    &   #00014295' TO DFHEIV0
 16294     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16295     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16296     MOVE X'2020233030303134323935' TO DFHEIV0(25:11)
 16297     CALL 'kxdfhei1' USING DFHEIV0,
 16298           FILE-ID-ERPNDB,
 16299           DFHEIV99,
 16300           DFHEIV99,
 16301           DFHEIV99,
 16302           DFHEIV99
 16303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16304
 16305
 16306     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16307
 16308     PERFORM 8400-LOG-JOURNAL-RECORD.
 16309
 16310     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16311     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16312
 16313
 16314* EXEC CICS HANDLE CONDITION
 16315*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16316*    END-EXEC.
 16317*    MOVE '"$I                   ! ; #00014306' TO DFHEIV0
 16318     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16319     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16320     MOVE X'3B20233030303134333036' TO DFHEIV0(25:11)
 16321     CALL 'kxdfhei1' USING DFHEIV0
 16322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16323
 16324
 16325
 16326* EXEC CICS READ
 16327*        SET     (ADDRESS OF PENDING-BUSINESS)
 16328*        DATASET (FILE-ID-ERPNDB)
 16329*        RIDFLD  (ERPNDB-KEY)
 16330*        UPDATE
 16331*    END-EXEC.
 16332*    MOVE '&"S        EU         (   #00014310' TO DFHEIV0
 16333     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16334     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16335     MOVE X'2020233030303134333130' TO DFHEIV0(25:11)
 16336     CALL 'kxdfhei1' USING DFHEIV0,
 16337           FILE-ID-ERPNDB,
 16338           DFHEIV20,
 16339           DFHEIV99,
 16340           ERPNDB-KEY,
 16341           DFHEIV99,
 16342           DFHEIV99,
 16343           DFHEIV99
 16344     SET ADDRESS OF PENDING-BUSINESS TO
 16345         DFHEIV20
 16346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16347
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 297
* VP6311.cbl
 16348
 16349     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16350     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16351
 16352     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16353        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16354        MOVE 'D'                 TO JP-RECORD-TYPE
 16355        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16356
 16357* EXEC CICS DELETE
 16358*            DATASET    (FILE-ID-ERPNDB)
 16359*       END-EXEC
 16360*    MOVE '&(                    &   #00014324' TO DFHEIV0
 16361     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16362     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16363     MOVE X'2020233030303134333234' TO DFHEIV0(25:11)
 16364     CALL 'kxdfhei1' USING DFHEIV0,
 16365           FILE-ID-ERPNDB,
 16366           DFHEIV99,
 16367           DFHEIV99,
 16368           DFHEIV99,
 16369           DFHEIV99
 16370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16371        PERFORM 8400-LOG-JOURNAL-RECORD
 16372     ELSE
 16373        MOVE 'B'                 TO JP-RECORD-TYPE
 16374        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16375        PERFORM 8400-LOG-JOURNAL-RECORD
 16376        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16377        MOVE 'C'                 TO JP-RECORD-TYPE
 16378        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16379
 16380* EXEC CICS REWRITE
 16381*            DATASET    (FILE-ID-ERPNDB)
 16382*            FROM       (PENDING-BUSINESS)
 16383*       END-EXEC
 16384     MOVE LENGTH OF
 16385      PENDING-BUSINESS
 16386       TO DFHEIV11
 16387*    MOVE '&& L                  %   #00014335' TO DFHEIV0
 16388     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16389     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16390     MOVE X'2020233030303134333335' TO DFHEIV0(25:11)
 16391     CALL 'kxdfhei1' USING DFHEIV0,
 16392           FILE-ID-ERPNDB,
 16393           PENDING-BUSINESS,
 16394           DFHEIV11,
 16395           DFHEIV99
 16396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16397        PERFORM 8400-LOG-JOURNAL-RECORD.
 16398
 16399******************************************************************
 16400*                                                                *
 16401*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16402*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16403*                                                                *
 16404******************************************************************
 16405
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 298
* VP6311.cbl
 16406     IF NOT PI-AR-PROCESSING
 16407        GO TO 2480-DELETE-FINISHED.
 16408
 16409     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16410        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16411        NEXT SENTENCE
 16412     ELSE
 16413        GO TO 2480-DELETE-FINISHED.
 16414
 16415
 16416* EXEC CICS HANDLE CONDITION
 16417*         NOTFND    (2480-DELETE-FINISHED)
 16418*    END-EXEC.
 16419*    MOVE '"$I                   ! < #00014357' TO DFHEIV0
 16420     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16421     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16422     MOVE X'3C20233030303134333537' TO DFHEIV0(25:11)
 16423     CALL 'kxdfhei1' USING DFHEIV0
 16424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16425
 16426
 16427     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16428     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16429
 16430
 16431* EXEC CICS READ
 16432*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16433*        DATASET (FILE-ID-ERRQST)
 16434*        RIDFLD  (ERRQST-KEY)
 16435*        UPDATE
 16436*    END-EXEC.
 16437*    MOVE '&"S        EU         (   #00014364' TO DFHEIV0
 16438     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16439     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16440     MOVE X'2020233030303134333634' TO DFHEIV0(25:11)
 16441     CALL 'kxdfhei1' USING DFHEIV0,
 16442           FILE-ID-ERRQST,
 16443           DFHEIV20,
 16444           DFHEIV99,
 16445           ERRQST-KEY,
 16446           DFHEIV99,
 16447           DFHEIV99,
 16448           DFHEIV99
 16449     SET ADDRESS OF AR-REQUEST-RECORD TO
 16450         DFHEIV20
 16451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16452
 16453
 16454     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16455
 16456     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16457
 16458     MOVE 'D'                      TO JP-RECORD-TYPE.
 16459     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16460
 16461
 16462* EXEC CICS DELETE
 16463*         DATASET    (FILE-ID-ERRQST)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 299
* VP6311.cbl
 16464*    END-EXEC.
 16465*    MOVE '&(                    &   #00014378' TO DFHEIV0
 16466     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16467     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16468     MOVE X'2020233030303134333738' TO DFHEIV0(25:11)
 16469     CALL 'kxdfhei1' USING DFHEIV0,
 16470           FILE-ID-ERRQST,
 16471           DFHEIV99,
 16472           DFHEIV99,
 16473           DFHEIV99,
 16474           DFHEIV99
 16475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16476
 16477
 16478     PERFORM 8400-LOG-JOURNAL-RECORD.
 16479
 16480 2480-DELETE-FINISHED.
 16481     MOVE ZEROS                  TO EMI-ERROR.
 16482     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16483     MOVE LOW-VALUES             TO VP631CI.
 16484     MOVE -1                     TO CMAINTL.
 16485     GO TO 8100-SEND-INITIAL-MAP.
 16486
 16487 2485-BATCH-HDR-NOT-FOUND.
 16488     MOVE -1                     TO CMAINTL
 16489     MOVE AL-UABON               TO CMAINTA.
 16490     MOVE ER-7450                TO EMI-ERROR.
 16491     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16492     GO TO 8200-SEND-DATAONLY.
 16493
 16494 2490-RECORD-NOT-FOUND.
 16495     MOVE -1                     TO CMAINTL
 16496     MOVE AL-UABON               TO CMAINTA.
 16497     MOVE ER-7451                TO EMI-ERROR.
 16498     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16499     GO TO 8200-SEND-DATAONLY.
 16500***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16501***                                                            ***
 16502***     2500  B R O W S E   C H E C K S                        ***
 16503***  We perform this routine from 2 different places.          ***
 16504***  1. If the user changes the refund amount on a cancel, we  ***
 16505***    want to.........                                        ***
 16506***    a. determine if prior checks have been processed        ***
 16507***    b. If the amt is larger, display message instructing    ***
 16508***     them to create another check to make up the difference.***
 16509***    c. If the amt is less, do not allow the change and      ***
 16510***     display a FATAL error suggesting they deal with check  ***
 16511***     records befor continuing.                              ***
 16512***  2. If the user wants to delete a cancel record we......   ***
 16513***    a. browse through all the checks and if there is a      ***
 16514***     processed check, send FATAL message.                   ***
 16515***    b. If there is a non-released check, then delete that   ***
 16516***     check after you delete the pending cancel record.      ***
 16517***                                                            ***
 16518***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16519
 16520 2500-browse-checks.
 16521
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 300
* VP6311.cbl
 16522     perform 2510-startbr-erchek thru 2510-exit
 16523
 16524     if not resp-normal
 16525        go to 2500-exit
 16526     end-if
 16527
 16528     perform until i-say-stop
 16529        perform 2520-readnext-erchek
 16530                                 thru 2520-exit
 16531        if (not resp-normal)
 16532           or (pb-control-by-account (1:33) not =
 16533              ch-control-primary (1:33))
 16534              set i-say-stop to true
 16535        else
 16536           if (ch-approval-status) = ' '
 16537              and (ch-void-dt = low-values)
 16538              and (ch-released-dt = low-values)
 16539              set i-have-checks to true
 16540           else
 16541              if ch-void-dt = low-values
 16542                 set i-have-processed-checks to true
 16543              end-if
 16544           end-if
 16545           if (ch-credit-accept-dt = low-values)
 16546              and (ch-void-dt = low-values)
 16547              and (ch-approval-status = ' ' OR 'P' OR 'A')
 16548              if (ch-check-origin-sw not = 'R')
 16549                 and (pb-record-type = '2')
 16550                 continue
 16551              else
 16552                 compute ws-check-amts =
 16553                    ws-check-amts + ch-amount-paid
 16554              end-if
 16555           end-if
 16556        end-if
 16557     end-perform
 16558
 16559     if ws-chek-browse-sw = 'Y'
 16560        perform 2525-endbr-erchek thru 2525-exit
 16561     end-if
 16562
 16563    .
 16564 2500-exit.
 16565     exit.
 16566
 16567 2510-startbr-erchek.
 16568
 16569     move pb-control-by-account  to erchek-key
 16570     move +0                     to chek-record-seq
 16571
 16572
 16573* exec cics startbr
 16574*       dataset   ('ERCHEK')
 16575*       ridfld    (erchek-key)
 16576*       gteq
 16577*       resp      (ws-response)
 16578*    end-exec
 16579     MOVE 'ERCHEK' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 301
* VP6311.cbl
 16580     MOVE 0
 16581       TO DFHEIV11
 16582*    MOVE '&,         G          &  N#00014476' TO DFHEIV0
 16583     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16584     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16585     MOVE X'204E233030303134343736' TO DFHEIV0(25:11)
 16586     CALL 'kxdfhei1' USING DFHEIV0,
 16587           DFHEIV1,
 16588           erchek-key,
 16589           DFHEIV99,
 16590           DFHEIV11,
 16591           DFHEIV99
 16592     MOVE EIBRESP  TO ws-response
 16593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16594
 16595     IF RESP-NORMAL
 16596        move 'Y'                 to ws-chek-browse-sw
 16597     end-if
 16598
 16599     .
 16600 2510-exit.
 16601     exit.
 16602
 16603 2520-readnext-erchek.
 16604
 16605
 16606* EXEC CICS READNEXT
 16607*       SET     (ADDRESS OF CHECK-RECORDS)
 16608*       DATASET ('ERCHEK')
 16609*       RIDFLD  (ERCHEK-KEY)
 16610*       RESP    (WS-RESPONSE)
 16611*    END-EXEC
 16612     MOVE 'ERCHEK' TO DFHEIV1
 16613     MOVE 0
 16614       TO DFHEIV11
 16615*    MOVE '&.S                   )  N#00014493' TO DFHEIV0
 16616     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16617     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16618     MOVE X'204E233030303134343933' TO DFHEIV0(25:11)
 16619     CALL 'kxdfhei1' USING DFHEIV0,
 16620           DFHEIV1,
 16621           DFHEIV20,
 16622           DFHEIV99,
 16623           ERCHEK-KEY,
 16624           DFHEIV99,
 16625           DFHEIV11,
 16626           DFHEIV99,
 16627           DFHEIV99
 16628     SET ADDRESS OF CHECK-RECORDS TO
 16629         DFHEIV20
 16630     MOVE EIBRESP  TO WS-RESPONSE
 16631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16632
 16633     .
 16634 2520-exit.
 16635     exit.
 16636
 16637 2525-endbr-erchek.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 302
* VP6311.cbl
 16638
 16639
 16640* exec cics endbr
 16641*       dataset  ('ERCHEK')
 16642*    end-exec
 16643     MOVE 'ERCHEK' TO DFHEIV1
 16644     MOVE 0
 16645       TO DFHEIV11
 16646*    MOVE '&2                    $   #00014506' TO DFHEIV0
 16647     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16648     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16649     MOVE X'2020233030303134353036' TO DFHEIV0(25:11)
 16650     CALL 'kxdfhei1' USING DFHEIV0,
 16651           DFHEIV1,
 16652           DFHEIV11,
 16653           DFHEIV99
 16654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16655
 16656     .
 16657 2525-exit.
 16658     exit.
 16659
 16660 2530-readupd-erchek.
 16661
 16662
 16663* EXEC CICS READ
 16664*       UPDATE
 16665*       SET     (ADDRESS OF CHECK-RECORDS)
 16666*       DATASET ('ERCHEK')
 16667*       RIDFLD  (ERCHEK-KEY)
 16668*       RESP    (WS-RESPONSE)
 16669*    END-EXEC
 16670     MOVE 'ERCHEK' TO DFHEIV1
 16671*    MOVE '&"S        EU         (  N#00014516' TO DFHEIV0
 16672     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16673     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16674     MOVE X'204E233030303134353136' TO DFHEIV0(25:11)
 16675     CALL 'kxdfhei1' USING DFHEIV0,
 16676           DFHEIV1,
 16677           DFHEIV20,
 16678           DFHEIV99,
 16679           ERCHEK-KEY,
 16680           DFHEIV99,
 16681           DFHEIV99,
 16682           DFHEIV99
 16683     SET ADDRESS OF CHECK-RECORDS TO
 16684         DFHEIV20
 16685     MOVE EIBRESP  TO WS-RESPONSE
 16686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16687
 16688     .
 16689 2530-exit.
 16690     exit.
 16691
 16692 2540-delete-erchek.
 16693
 16694
 16695* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 303
* VP6311.cbl
 16696*       DATASET ('ERCHEK')
 16697*       RESP    (WS-RESPONSE)
 16698*    END-EXEC
 16699     MOVE 'ERCHEK' TO DFHEIV1
 16700*    MOVE '&(                    &  N#00014530' TO DFHEIV0
 16701     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16702     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16703     MOVE X'204E233030303134353330' TO DFHEIV0(25:11)
 16704     CALL 'kxdfhei1' USING DFHEIV0,
 16705           DFHEIV1,
 16706           DFHEIV99,
 16707           DFHEIV99,
 16708           DFHEIV99,
 16709           DFHEIV99
 16710     MOVE EIBRESP  TO WS-RESPONSE
 16711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16712
 16713     .
 16714 2540-exit.
 16715     exit.
 16716***************************************************************
 16717*                                                             *
 16718*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16719*                                                             *
 16720***************************************************************
 16721
 16722***************************************************************
 16723*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16724*     AN ALREADY BILLED RECORD.                               *
 16725***************************************************************
 16726
 16727 2700-BUILD-CORRECTION-RECORD.
 16728     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16729     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16730     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16731     MOVE '5'                    TO DC-OPTION-CODE.
 16732     PERFORM 9700-DATE-LINK.
 16733     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16734
 16735     IF PB-CHG-COUNT = ZEROS
 16736        MOVE +1                  TO WS-SEQ-SAVE
 16737     ELSE
 16738        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16739
 16740     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16741     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16742
 16743     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16744
 16745     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16746     MOVE 'A'                    TO JP-RECORD-TYPE.
 16747     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16748
 16749
 16750* EXEC CICS WRITE
 16751*        DATASET    (FILE-ID-ERPNDB)
 16752*        FROM       (PENDING-BUSINESS)
 16753*        RIDFLD     (PB-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 304
* VP6311.cbl
 16754*    END-EXEC.
 16755     MOVE LENGTH OF
 16756      PENDING-BUSINESS
 16757       TO DFHEIV11
 16758*    MOVE '&$ L                  ''   #00014571' TO DFHEIV0
 16759     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16760     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16761     MOVE X'2020233030303134353731' TO DFHEIV0(25:11)
 16762     CALL 'kxdfhei1' USING DFHEIV0,
 16763           FILE-ID-ERPNDB,
 16764           PENDING-BUSINESS,
 16765           DFHEIV11,
 16766           PB-CONTROL-PRIMARY,
 16767           DFHEIV99,
 16768           DFHEIV99
 16769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16770
 16771
 16772     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16773
 16774     PERFORM 8400-LOG-JOURNAL-RECORD.
 16775
 16776 2799-EXIT.
 16777      EXIT.
 16778
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 305
* VP6311.cbl
 16780
 16781******************************************************************
 16782*                                                                *
 16783*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16784*                                                                *
 16785******************************************************************
 16786
 16787 2800-REWRITE-ISSUE-CERT-KEY.
 16788     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16789
 16790     IF  BCERTNOL GREATER THAN ZEROS
 16791         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16792
 16793     IF  BSUFIXL  GREATER THAN ZEROS
 16794         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16795
 16796     IF  BEFFDTL  GREATER THAN ZEROS
 16797         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16798
 16799 2810-READ-BY-ACCOUNT.
 16800
 16801* EXEC CICS HANDLE CONDITION
 16802*         NOTFND    (2820-PROCESS-REWRITE)
 16803*    END-EXEC.
 16804*    MOVE '"$I                   ! = #00014605' TO DFHEIV0
 16805     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16806     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16807     MOVE X'3D20233030303134363035' TO DFHEIV0(25:11)
 16808     CALL 'kxdfhei1' USING DFHEIV0
 16809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16810
 16811
 16812***  read pndb using new key
 16813
 16814* EXEC CICS READ
 16815*        SET     (ADDRESS OF PENDING-BUSINESS)
 16816*        DATASET (FILE-ID-ERPNDB2)
 16817*        RIDFLD  (ERPNDB-ALT-KEY)
 16818*    END-EXEC.
 16819*    MOVE '&"S        E          (   #00014610' TO DFHEIV0
 16820     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16821     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16822     MOVE X'2020233030303134363130' TO DFHEIV0(25:11)
 16823     CALL 'kxdfhei1' USING DFHEIV0,
 16824           FILE-ID-ERPNDB2,
 16825           DFHEIV20,
 16826           DFHEIV99,
 16827           ERPNDB-ALT-KEY,
 16828           DFHEIV99,
 16829           DFHEIV99,
 16830           DFHEIV99
 16831     SET ADDRESS OF PENDING-BUSINESS TO
 16832         DFHEIV20
 16833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16834
 16835
 16836     GO TO 2890-DUPLICATE-RECORD.
 16837
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 306
* VP6311.cbl
 16838  2820-PROCESS-REWRITE.
 16839
 16840* EXEC CICS HANDLE CONDITION
 16841*         NOTFND    (2885-RECORD-MISSING)
 16842*    END-EXEC.
 16843*    MOVE '"$I                   ! > #00014619' TO DFHEIV0
 16844     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16845     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16846     MOVE X'3E20233030303134363139' TO DFHEIV0(25:11)
 16847     CALL 'kxdfhei1' USING DFHEIV0
 16848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16849
 16850
 16851     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16852
 16853***  read pndb using original key
 16854
 16855* EXEC CICS READ
 16856*        SET     (ADDRESS OF PENDING-BUSINESS)
 16857*        DATASET (FILE-ID-ERPNDB)
 16858*        RIDFLD  (ERPNDB-KEY)
 16859*        UPDATE
 16860*    END-EXEC.
 16861*    MOVE '&"S        EU         (   #00014626' TO DFHEIV0
 16862     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16863     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16864     MOVE X'2020233030303134363236' TO DFHEIV0(25:11)
 16865     CALL 'kxdfhei1' USING DFHEIV0,
 16866           FILE-ID-ERPNDB,
 16867           DFHEIV20,
 16868           DFHEIV99,
 16869           ERPNDB-KEY,
 16870           DFHEIV99,
 16871           DFHEIV99,
 16872           DFHEIV99
 16873     SET ADDRESS OF PENDING-BUSINESS TO
 16874         DFHEIV20
 16875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16876
 16877
 16878     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16879     MOVE 'D'                    TO JP-RECORD-TYPE.
 16880     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16881     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16882
 16883     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16884
 16885     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16886     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16887     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16888
 16889***  delete pndb using original key
 16890
 16891* EXEC CICS DELETE
 16892*        DATASET    (FILE-ID-ERPNDB)
 16893*    END-EXEC.
 16894*    MOVE '&(                    &   #00014645' TO DFHEIV0
 16895     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 307
* VP6311.cbl
 16896     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16897     MOVE X'2020233030303134363435' TO DFHEIV0(25:11)
 16898     CALL 'kxdfhei1' USING DFHEIV0,
 16899           FILE-ID-ERPNDB,
 16900           DFHEIV99,
 16901           DFHEIV99,
 16902           DFHEIV99,
 16903           DFHEIV99
 16904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16905
 16906
 16907     PERFORM 8400-LOG-JOURNAL-RECORD.
 16908
 16909
 16910* EXEC CICS GETMAIN
 16911*        SET      (ADDRESS OF PENDING-BUSINESS)
 16912*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16913*        INITIMG  (GETMAIN-SPACE)
 16914*    END-EXEC.
 16915*    MOVE ',"IL                  $   #00014651' TO DFHEIV0
 16916     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16917     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16918     MOVE X'2020233030303134363531' TO DFHEIV0(25:11)
 16919     CALL 'kxdfhei1' USING DFHEIV0,
 16920           DFHEIV20,
 16921           ERPNDB-RECORD-LENGTH,
 16922           GETMAIN-SPACE
 16923     SET ADDRESS OF PENDING-BUSINESS TO
 16924         DFHEIV20
 16925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16926
 16927
 16928***  pending-business now has original record
 16929     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16930
 16931
 16932* EXEC CICS HANDLE CONDITION
 16933*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 16934*    END-EXEC.
 16935*    MOVE '"$I                   ! ? #00014660' TO DFHEIV0
 16936     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16937     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16938     MOVE X'3F20233030303134363630' TO DFHEIV0(25:11)
 16939     CALL 'kxdfhei1' USING DFHEIV0
 16940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16941
 16942
 16943***  read elcert using original key
 16944
 16945* EXEC CICS READ
 16946*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16947*        DATASET (FILE-ID-ELCERT)
 16948*        RIDFLD  (ELCERT-KEY)
 16949*        UPDATE
 16950*    END-EXEC.
 16951*    MOVE '&"S        EU         (   #00014665' TO DFHEIV0
 16952     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16953     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 308
* VP6311.cbl
 16954     MOVE X'2020233030303134363635' TO DFHEIV0(25:11)
 16955     CALL 'kxdfhei1' USING DFHEIV0,
 16956           FILE-ID-ELCERT,
 16957           DFHEIV20,
 16958           DFHEIV99,
 16959           ELCERT-KEY,
 16960           DFHEIV99,
 16961           DFHEIV99,
 16962           DFHEIV99
 16963     SET ADDRESS OF CERTIFICATE-MASTER TO
 16964         DFHEIV20
 16965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16966
 16967
 16968     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16969     MOVE 'B'                    TO JP-RECORD-TYPE
 16970     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16971     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16972
 16973     IF INSURED-ADDR-PRESENT
 16974        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 16975
 16976     IF CERT-NOTES-ARE-NOT-PRESENT
 16977        MOVE SPACE               TO WS-CERT-NOTE-SW
 16978     ELSE
 16979        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 16980
 16981     IF CERT-ADDED-BATCH      OR
 16982        CERT-AND-CLAIM-ONLINE OR
 16983        CERT-WAS-CREATED-FOR-CLAIM
 16984        NEXT SENTENCE
 16985     ELSE
 16986        GO TO 2825-DELETE-CERTIFICATE.
 16987
 16988     PERFORM 8400-LOG-JOURNAL-RECORD.
 16989
 16990*********************************************************
 16991** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 16992     IF CERT-ADDED-BATCH
 16993         GO TO 2822-REWRITE-ELCERT.
 16994*********************************************************
 16995
 16996     IF NO-CLAIM-ATTACHED
 16997        NEXT SENTENCE
 16998     ELSE
 16999        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17000        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17001
 17002 2822-REWRITE-ELCERT.
 17003     MOVE 'C'                    TO JP-RECORD-TYPE
 17004     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17005
 17006     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17007
 17008
 17009* EXEC CICS REWRITE
 17010*         DATASET    (FILE-ID-ELCERT)
 17011*         FROM       (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 309
* VP6311.cbl
 17012*    END-EXEC.
 17013     MOVE LENGTH OF
 17014      CERTIFICATE-MASTER
 17015       TO DFHEIV11
 17016*    MOVE '&& L                  %   #00014712' TO DFHEIV0
 17017     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17018     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17019     MOVE X'2020233030303134373132' TO DFHEIV0(25:11)
 17020     CALL 'kxdfhei1' USING DFHEIV0,
 17021           FILE-ID-ELCERT,
 17022           CERTIFICATE-MASTER,
 17023           DFHEIV11,
 17024           DFHEIV99
 17025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17026
 17027
 17028     PERFORM 8400-LOG-JOURNAL-RECORD.
 17029
 17030     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17031
 17032 2825-DELETE-CERTIFICATE.
 17033     MOVE 'D'                      TO JP-RECORD-TYPE.
 17034     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17035
 17036     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17037
 17038
 17039* EXEC CICS DELETE
 17040*         DATASET    (FILE-ID-ELCERT)
 17041*    END-EXEC.
 17042*    MOVE '&(                    &   #00014727' TO DFHEIV0
 17043     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17044     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17045     MOVE X'2020233030303134373237' TO DFHEIV0(25:11)
 17046     CALL 'kxdfhei1' USING DFHEIV0,
 17047           FILE-ID-ELCERT,
 17048           DFHEIV99,
 17049           DFHEIV99,
 17050           DFHEIV99,
 17051           DFHEIV99
 17052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17053
 17054
 17055     PERFORM 8400-LOG-JOURNAL-RECORD.
 17056
 17057******************************************************************
 17058*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17059******************************************************************
 17060
 17061     IF CERT-NOTES-ARE-PRESENT
 17062        NEXT SENTENCE
 17063     ELSE
 17064        GO TO 2827-DELETE-MAILING.
 17065
 17066
 17067* EXEC CICS HANDLE CONDITION
 17068*         NOTFND  (2827-DELETE-MAILING)
 17069*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 310
* VP6311.cbl
 17070*    MOVE '"$I                   ! @ #00014742' TO DFHEIV0
 17071     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17072     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17073     MOVE X'4020233030303134373432' TO DFHEIV0(25:11)
 17074     CALL 'kxdfhei1' USING DFHEIV0
 17075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17076
 17077
 17078
 17079* EXEC CICS READ
 17080*        EQUAL
 17081*        DATASET   (FILE-ID-ERNOTE)
 17082*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17083*        RIDFLD    (ELCERT-KEY)
 17084*        UPDATE
 17085*    END-EXEC.
 17086*    MOVE '&"S        EU         (   #00014746' TO DFHEIV0
 17087     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17088     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17089     MOVE X'2020233030303134373436' TO DFHEIV0(25:11)
 17090     CALL 'kxdfhei1' USING DFHEIV0,
 17091           FILE-ID-ERNOTE,
 17092           DFHEIV20,
 17093           DFHEIV99,
 17094           ELCERT-KEY,
 17095           DFHEIV99,
 17096           DFHEIV99,
 17097           DFHEIV99
 17098     SET ADDRESS OF CERTIFICATE-NOTE TO
 17099         DFHEIV20
 17100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17101
 17102
 17103     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17104     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17105     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17106
 17107     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17108
 17109
 17110* EXEC CICS DELETE
 17111*        DATASET   (FILE-ID-ERNOTE)
 17112*    END-EXEC.
 17113*    MOVE '&(                    &   #00014760' TO DFHEIV0
 17114     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17115     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17116     MOVE X'2020233030303134373630' TO DFHEIV0(25:11)
 17117     CALL 'kxdfhei1' USING DFHEIV0,
 17118           FILE-ID-ERNOTE,
 17119           DFHEIV99,
 17120           DFHEIV99,
 17121           DFHEIV99,
 17122           DFHEIV99
 17123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17124
 17125
 17126     PERFORM 8400-LOG-JOURNAL-RECORD.
 17127
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 311
* VP6311.cbl
 17128******************************************************************
 17129*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17130******************************************************************
 17131
 17132 2827-DELETE-MAILING.
 17133     IF CERT-ADDRESS-PRESENT
 17134        NEXT SENTENCE
 17135     ELSE
 17136        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17137
 17138
 17139* EXEC CICS HANDLE CONDITION
 17140*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17141*    END-EXEC.
 17142*    MOVE '"$I                   ! A #00014776' TO DFHEIV0
 17143     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17144     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17145     MOVE X'4120233030303134373736' TO DFHEIV0(25:11)
 17146     CALL 'kxdfhei1' USING DFHEIV0
 17147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17148
 17149
 17150     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17151
 17152
 17153* EXEC CICS READ
 17154*        EQUAL
 17155*        DATASET   (FILE-ID-ERMAIL)
 17156*        SET       (ADDRESS OF MAILING-DATA)
 17157*        RIDFLD    (ERMAIL-KEY)
 17158*        UPDATE
 17159*    END-EXEC.
 17160*    MOVE '&"S        EU         (   #00014782' TO DFHEIV0
 17161     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17162     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17163     MOVE X'2020233030303134373832' TO DFHEIV0(25:11)
 17164     CALL 'kxdfhei1' USING DFHEIV0,
 17165           FILE-ID-ERMAIL,
 17166           DFHEIV20,
 17167           DFHEIV99,
 17168           ERMAIL-KEY,
 17169           DFHEIV99,
 17170           DFHEIV99,
 17171           DFHEIV99
 17172     SET ADDRESS OF MAILING-DATA TO
 17173         DFHEIV20
 17174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17175
 17176
 17177     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17178     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17179     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17180
 17181     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17182
 17183
 17184* EXEC CICS DELETE
 17185*        DATASET   (FILE-ID-ERMAIL)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 312
* VP6311.cbl
 17186*    END-EXEC.
 17187*    MOVE '&(                    &   #00014796' TO DFHEIV0
 17188     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17189     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17190     MOVE X'2020233030303134373936' TO DFHEIV0(25:11)
 17191     CALL 'kxdfhei1' USING DFHEIV0,
 17192           FILE-ID-ERMAIL,
 17193           DFHEIV99,
 17194           DFHEIV99,
 17195           DFHEIV99,
 17196           DFHEIV99
 17197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17198
 17199
 17200     PERFORM 8400-LOG-JOURNAL-RECORD.
 17201
 17202 2830-BUILD-NEW-ISSUE-RECORD.
 17203     MOVE SPACES                 TO ELCERT-KEY.
 17204
 17205     IF  BCERTNOL GREATER THAN ZEROS
 17206         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17207
 17208     IF  BSUFIXL  GREATER THAN ZEROS
 17209         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17210
 17211     IF BEFFDTL GREATER THAN ZEROS
 17212        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17213
 17214 2870-WRITE-PENDING-BUSINESS.
 17215     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17216     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17217     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17218     MOVE '5'                    TO DC-OPTION-CODE.
 17219     PERFORM 9700-DATE-LINK.
 17220     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17221
 17222     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17223
 17224     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17225     MOVE 'A'                    TO JP-RECORD-TYPE.
 17226     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17227
 17228
 17229* EXEC CICS WRITE
 17230*        DATASET  (FILE-ID-ERPNDB)
 17231*        FROM     (PENDING-BUSINESS)
 17232*        RIDFLD   (PB-CONTROL-PRIMARY)
 17233*    END-EXEC.
 17234     MOVE LENGTH OF
 17235      PENDING-BUSINESS
 17236       TO DFHEIV11
 17237*    MOVE '&$ L                  ''   #00014828' TO DFHEIV0
 17238     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17239     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17240     MOVE X'2020233030303134383238' TO DFHEIV0(25:11)
 17241     CALL 'kxdfhei1' USING DFHEIV0,
 17242           FILE-ID-ERPNDB,
 17243           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 313
* VP6311.cbl
 17244           DFHEIV11,
 17245           PB-CONTROL-PRIMARY,
 17246           DFHEIV99,
 17247           DFHEIV99
 17248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17249
 17250
 17251     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17252
 17253     PERFORM 8400-LOG-JOURNAL-RECORD.
 17254
 17255     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17256
 17257 2885-RECORD-MISSING.
 17258     MOVE -1                     TO BMAINTL
 17259     MOVE AL-UABON               TO BMAINTA
 17260     MOVE ER-2902                TO EMI-ERROR.
 17261     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17262     GO TO 8200-SEND-DATAONLY.
 17263
 17264 2890-DUPLICATE-RECORD.
 17265     MOVE -1                     TO BMAINTL.
 17266     MOVE AL-UABON               TO BCERTNOA.
 17267     MOVE AL-UNBON               TO BEFFDTA.
 17268     MOVE SPACE                  TO BMAINTI.
 17269
 17270     MOVE 1                      TO EMI-SUB
 17271                                    EMI-SWITCH1
 17272                                    EMI-SWITCH-AREA-1
 17273                                    EMI-SWITCH-AREA-2.
 17274
 17275     MOVE SPACES                 TO EMI-ERROR-LINES.
 17276
 17277
 17278* EXEC CICS SYNCPOINT ROLLBACK
 17279*    END-EXEC.
 17280*    MOVE '6"R                   !   #00014860' TO DFHEIV0
 17281     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17282     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17283     MOVE X'2020233030303134383630' TO DFHEIV0(25:11)
 17284     CALL 'kxdfhei1' USING DFHEIV0
 17285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17286
 17287
 17288     MOVE ER-2247                TO EMI-ERROR.
 17289     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17290     GO TO 8200-SEND-DATAONLY.
 17291
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 314
* VP6311.cbl
 17293
 17294******************************************************************
 17295*                                                                *
 17296*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17297*                                                                *
 17298******************************************************************
 17299
 17300 2900-REWRITE-CAN-CERT-KEY.
 17301     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17302
 17303     IF  CCERTNOL GREATER THAN ZEROS
 17304         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17305
 17306     IF  CSUFIXL  GREATER THAN ZEROS
 17307         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17308
 17309     IF  CEFFDTL  GREATER THAN ZEROS
 17310         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17311
 17312 2910-READ-BY-ACCOUNT.
 17313
 17314* EXEC CICS HANDLE CONDITION
 17315*         NOTFND    (2920-PROCESS-REWRITE)
 17316*    END-EXEC.
 17317*    MOVE '"$I                   ! B #00014888' TO DFHEIV0
 17318     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17319     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17320     MOVE X'4220233030303134383838' TO DFHEIV0(25:11)
 17321     CALL 'kxdfhei1' USING DFHEIV0
 17322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17323
 17324
 17325
 17326* EXEC CICS READ
 17327*        SET     (ADDRESS OF PENDING-BUSINESS)
 17328*        DATASET (FILE-ID-ERPNDB2)
 17329*        RIDFLD  (ERPNDB-ALT-KEY)
 17330*    END-EXEC.
 17331*    MOVE '&"S        E          (   #00014892' TO DFHEIV0
 17332     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17333     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17334     MOVE X'2020233030303134383932' TO DFHEIV0(25:11)
 17335     CALL 'kxdfhei1' USING DFHEIV0,
 17336           FILE-ID-ERPNDB2,
 17337           DFHEIV20,
 17338           DFHEIV99,
 17339           ERPNDB-ALT-KEY,
 17340           DFHEIV99,
 17341           DFHEIV99,
 17342           DFHEIV99
 17343     SET ADDRESS OF PENDING-BUSINESS TO
 17344         DFHEIV20
 17345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17346
 17347
 17348     GO TO 2990-DUPLICATE-RECORD.
 17349
 17350  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 315
* VP6311.cbl
 17351
 17352* EXEC CICS HANDLE CONDITION
 17353*         NOTFND    (2985-RECORD-MISSING)
 17354*    END-EXEC.
 17355*    MOVE '"$I                   ! C #00014901' TO DFHEIV0
 17356     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17357     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17358     MOVE X'4320233030303134393031' TO DFHEIV0(25:11)
 17359     CALL 'kxdfhei1' USING DFHEIV0
 17360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17361
 17362
 17363     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17364
 17365
 17366* EXEC CICS READ
 17367*        SET     (ADDRESS OF PENDING-BUSINESS)
 17368*        DATASET (FILE-ID-ERPNDB)
 17369*        RIDFLD  (ERPNDB-KEY)
 17370*        UPDATE
 17371*    END-EXEC.
 17372*    MOVE '&"S        EU         (   #00014907' TO DFHEIV0
 17373     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17374     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17375     MOVE X'2020233030303134393037' TO DFHEIV0(25:11)
 17376     CALL 'kxdfhei1' USING DFHEIV0,
 17377           FILE-ID-ERPNDB,
 17378           DFHEIV20,
 17379           DFHEIV99,
 17380           ERPNDB-KEY,
 17381           DFHEIV99,
 17382           DFHEIV99,
 17383           DFHEIV99
 17384     SET ADDRESS OF PENDING-BUSINESS TO
 17385         DFHEIV20
 17386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17387
 17388
 17389     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17390     MOVE 'D'                    TO JP-RECORD-TYPE.
 17391     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17392     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17393
 17394     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17395
 17396     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17397     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17398     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17399
 17400
 17401* EXEC CICS DELETE
 17402*        DATASET    (FILE-ID-ERPNDB)
 17403*    END-EXEC.
 17404*    MOVE '&(                    &   #00014925' TO DFHEIV0
 17405     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17406     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17407     MOVE X'2020233030303134393235' TO DFHEIV0(25:11)
 17408     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 316
* VP6311.cbl
 17409           FILE-ID-ERPNDB,
 17410           DFHEIV99,
 17411           DFHEIV99,
 17412           DFHEIV99,
 17413           DFHEIV99
 17414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17415
 17416
 17417     PERFORM 8400-LOG-JOURNAL-RECORD.
 17418
 17419
 17420* EXEC CICS GETMAIN
 17421*        SET      (ADDRESS OF PENDING-BUSINESS)
 17422*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17423*        INITIMG  (GETMAIN-SPACE)
 17424*    END-EXEC.
 17425*    MOVE ',"IL                  $   #00014931' TO DFHEIV0
 17426     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17427     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17428     MOVE X'2020233030303134393331' TO DFHEIV0(25:11)
 17429     CALL 'kxdfhei1' USING DFHEIV0,
 17430           DFHEIV20,
 17431           ERPNDB-RECORD-LENGTH,
 17432           GETMAIN-SPACE
 17433     SET ADDRESS OF PENDING-BUSINESS TO
 17434         DFHEIV20
 17435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17436
 17437
 17438     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17439
 17440 2950-PROCESS-CANCELS.
 17441
 17442
 17443* EXEC CICS HANDLE CONDITION
 17444*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17445*    END-EXEC.
 17446*    MOVE '"$I                   ! D #00014941' TO DFHEIV0
 17447     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17449     MOVE X'4420233030303134393431' TO DFHEIV0(25:11)
 17450     CALL 'kxdfhei1' USING DFHEIV0
 17451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17452
 17453
 17454
 17455* EXEC CICS READ
 17456*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17457*        DATASET (FILE-ID-ELCERT)
 17458*        RIDFLD  (ELCERT-KEY)
 17459*        UPDATE
 17460*    END-EXEC.
 17461*    MOVE '&"S        EU         (   #00014945' TO DFHEIV0
 17462     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17463     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17464     MOVE X'2020233030303134393435' TO DFHEIV0(25:11)
 17465     CALL 'kxdfhei1' USING DFHEIV0,
 17466           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 317
* VP6311.cbl
 17467           DFHEIV20,
 17468           DFHEIV99,
 17469           ELCERT-KEY,
 17470           DFHEIV99,
 17471           DFHEIV99,
 17472           DFHEIV99
 17473     SET ADDRESS OF CERTIFICATE-MASTER TO
 17474         DFHEIV20
 17475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17476
 17477
 17478     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17479
 17480     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17481     MOVE 'B'                      TO JP-RECORD-TYPE.
 17482     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17483     PERFORM 8400-LOG-JOURNAL-RECORD.
 17484
 17485     IF PB-CI-LIVES NOT NUMERIC
 17486         MOVE ZERO                    TO PB-CI-LIVES.
 17487
 17488     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17489        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17490        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17491        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17492                                         CM-LF-CANCEL-DT
 17493     ELSE
 17494        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17495        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17496        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17497        MOVE PB-CI-LIVES              TO CM-LIVES.
 17498
 17499     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17500        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17501            MOVE CM-LF-STATUS-AT-CANCEL
 17502                                     TO CM-LF-CURRENT-STATUS
 17503            MOVE SPACE
 17504                                     TO CM-LF-STATUS-AT-CANCEL
 17505        ELSE
 17506            MOVE PB-CI-LF-POLICY-STATUS
 17507                                     TO CM-LF-CURRENT-STATUS
 17508     ELSE
 17509        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17510
 17511     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17512        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17513        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17514        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17515                                         CM-AH-CANCEL-DT
 17516     ELSE
 17517        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17518        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17519        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17520        MOVE PB-CI-LIVES              TO CM-LIVES.
 17521
 17522     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17523        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17524            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 318
* VP6311.cbl
 17525                                     TO CM-AH-CURRENT-STATUS
 17526            MOVE SPACE
 17527                                     TO CM-AH-STATUS-AT-CANCEL
 17528        ELSE
 17529            MOVE PB-CI-AH-POLICY-STATUS
 17530                                     TO CM-AH-CURRENT-STATUS
 17531     ELSE
 17532        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17533
 17534 2975-REWRITE-CERT.
 17535     MOVE 'C'                      TO JP-RECORD-TYPE.
 17536     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17537
 17538
 17539* EXEC CICS REWRITE
 17540*        DATASET    (FILE-ID-ELCERT)
 17541*        FROM       (CERTIFICATE-MASTER)
 17542*    END-EXEC.
 17543     MOVE LENGTH OF
 17544      CERTIFICATE-MASTER
 17545       TO DFHEIV11
 17546*    MOVE '&& L                  %   #00015012' TO DFHEIV0
 17547     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17548     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17549     MOVE X'2020233030303135303132' TO DFHEIV0(25:11)
 17550     CALL 'kxdfhei1' USING DFHEIV0,
 17551           FILE-ID-ELCERT,
 17552           CERTIFICATE-MASTER,
 17553           DFHEIV11,
 17554           DFHEIV99
 17555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17556
 17557
 17558     PERFORM 8400-LOG-JOURNAL-RECORD.
 17559
 17560 2960-BUILD-NEW-CANCEL-RECORD.
 17561     IF  CCERTNOL GREATER THAN ZEROS
 17562         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17563
 17564     IF  CSUFIXL  GREATER THAN ZEROS
 17565         MOVE CSUFIXI             TO PB-CERT-SFX.
 17566
 17567     IF  CEFFDTL  GREATER  THAN ZEROS
 17568         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17569
 17570 2970-WRITE-PENDING-BUSINESS.
 17571     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17572     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17573     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17574     MOVE '5'                    TO DC-OPTION-CODE.
 17575     PERFORM 9700-DATE-LINK.
 17576     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17577
 17578     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17579
 17580     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17581                                    PB-CI-INSURED-SEX
 17582                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 319
* VP6311.cbl
 17583                                    PB-CI-AH-BENEFIT-CD
 17584                                    PB-CI-RATE-CLASS
 17585                                    PB-CI-RATE-DEV-LF
 17586                                    PB-CI-RATE-DEV-AH
 17587                                    PB-CI-LF-ABBR
 17588                                    PB-CI-AH-ABBR
 17589                                    PB-CI-OB-FLAG
 17590                                    PB-CI-LF-POLICY-STATUS
 17591                                    PB-CI-AH-POLICY-STATUS
 17592                                    PB-CI-INDV-GRP-CD
 17593                                    PB-CI-BENEFICIARY-NAME
 17594                                    PB-CI-NOTE-SW
 17595                                    PB-CI-SOC-SEC-NO
 17596                                    PB-CI-MEMBER-NO
 17597                                    PB-CI-INT-CODE
 17598                                    PB-CI-COMP-EXCP-SW
 17599                                    PB-CI-ENTRY-STATUS
 17600                                    PB-CI-CREDIT-INTERFACE-SW-1
 17601                                    PB-CI-CREDIT-INTERFACE-SW-2
 17602                                    PB-CI-ENTRY-BATCH.
 17603
 17604     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17605                                    PB-CI-AH-SETTLEMENT-DT
 17606                                    PB-CI-DEATH-DT
 17607                                    PB-CI-LF-PRIOR-CANCEL-DT
 17608                                    PB-CI-AH-PRIOR-CANCEL-DT
 17609                                    PB-CI-LOAN-1ST-PMT-DT
 17610                                    PB-CI-ENTRY-DT
 17611                                    PB-CI-LF-EXPIRE-DT
 17612                                    PB-CI-AH-EXPIRE-DT.
 17613
 17614     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17615                                    PB-CI-LF-TERM
 17616                                    PB-CI-LF-BENEFIT-AMT
 17617                                    PB-CI-LF-ALT-BENEFIT-AMT
 17618                                    PB-CI-LF-PREMIUM-AMT
 17619                                    PB-CI-LF-ALT-PREMIUM-AMT
 17620                                    PB-CI-AH-TERM
 17621                                    PB-CI-AH-BENEFIT-AMT
 17622                                    PB-CI-AH-PREMIUM-AMT
 17623                                    PB-CI-RATE-DEV-PCT-LF
 17624                                    PB-CI-RATE-DEV-PCT-AH
 17625                                    PB-CI-LIFE-COMMISSION
 17626                                    PB-CI-AH-COMMISSION
 17627                                    PB-CI-PAY-FREQUENCY
 17628                                    PB-CI-LOAN-APR
 17629                                    PB-CI-LOAN-TERM
 17630                                    PB-CI-CURR-SEQ
 17631                                    PB-CI-AH-CANCEL-AMT
 17632                                    PB-CI-LF-CANCEL-AMT
 17633                                    PB-CI-EXTENTION-DAYS
 17634                                    PB-CI-TERM-IN-DAYS
 17635                                    PB-CI-LOAN-OFFICER
 17636                                    PB-CI-LIVES
 17637                                    PB-CI-LF-CRIT-PER
 17638                                    PB-CI-AH-CRIT-PER
 17639                                    PB-C-LF-REM-TERM
 17640                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 320
* VP6311.cbl
 17641
 17642     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17643     MOVE 'A'                    TO JP-RECORD-TYPE.
 17644     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17645
 17646
 17647* EXEC CICS HANDLE CONDITION
 17648*        DUPREC   (2990-DUPLICATE-RECORD)
 17649*    END-EXEC.
 17650*    MOVE '"$%                   ! E #00015105' TO DFHEIV0
 17651     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17652     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17653     MOVE X'4520233030303135313035' TO DFHEIV0(25:11)
 17654     CALL 'kxdfhei1' USING DFHEIV0
 17655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17656
 17657
 17658
 17659* EXEC CICS WRITE
 17660*        DATASET  (FILE-ID-ERPNDB)
 17661*        FROM     (PENDING-BUSINESS)
 17662*        RIDFLD   (PB-CONTROL-PRIMARY)
 17663*    END-EXEC.
 17664     MOVE LENGTH OF
 17665      PENDING-BUSINESS
 17666       TO DFHEIV11
 17667*    MOVE '&$ L                  ''   #00015109' TO DFHEIV0
 17668     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17669     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17670     MOVE X'2020233030303135313039' TO DFHEIV0(25:11)
 17671     CALL 'kxdfhei1' USING DFHEIV0,
 17672           FILE-ID-ERPNDB,
 17673           PENDING-BUSINESS,
 17674           DFHEIV11,
 17675           PB-CONTROL-PRIMARY,
 17676           DFHEIV99,
 17677           DFHEIV99
 17678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17679
 17680
 17681     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17682
 17683     PERFORM 8400-LOG-JOURNAL-RECORD.
 17684
 17685     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17686
 17687 2985-RECORD-MISSING.
 17688     MOVE -1                     TO CMAINTL
 17689     MOVE AL-UABON               TO CMAINTA.
 17690
 17691     MOVE ER-2902                TO EMI-ERROR.
 17692     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17693     GO TO 8200-SEND-DATAONLY.
 17694
 17695 2990-DUPLICATE-RECORD.
 17696     MOVE SPACE                  TO CMAINTI.
 17697     MOVE -1                     TO CMAINTL.
 17698     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 321
* VP6311.cbl
 17699     MOVE AL-UNBON               TO CEFFDTA.
 17700
 17701     MOVE 1                      TO EMI-SUB
 17702                                    EMI-SWITCH1
 17703                                    EMI-SWITCH-AREA-1
 17704                                    EMI-SWITCH-AREA-2.
 17705     MOVE SPACES                 TO EMI-ERROR-LINES.
 17706
 17707
 17708* EXEC CICS SYNCPOINT ROLLBACK
 17709*    END-EXEC.
 17710*    MOVE '6"R                   !   #00015141' TO DFHEIV0
 17711     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17712     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17713     MOVE X'2020233030303135313431' TO DFHEIV0(25:11)
 17714     CALL 'kxdfhei1' USING DFHEIV0
 17715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17716
 17717
 17718     MOVE ER-2247                TO EMI-ERROR.
 17719     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17720     GO TO 8200-SEND-DATAONLY.
 17721
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 322
* VP6311.cbl
 17723
 17724***************************************************************
 17725*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17726*     PREMIUM FOR A SINGLE BATCH.                             *
 17727*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17728***************************************************************
 17729
 17730 3000-BATCH-MAINLINE.
 17731     IF PI-PREV-KEY NOT = SPACES
 17732         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17733     ELSE
 17734         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17735
 17736     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17737
 17738 3010-READNEXT.
 17739
 17740* EXEC CICS READ
 17741*         DATASET    (FILE-ID-ERPNDB)
 17742*         SET        (ADDRESS OF PENDING-BUSINESS)
 17743*         RIDFLD     (ERPNDB-KEY)
 17744*         GTEQ
 17745*    END-EXEC.
 17746*    MOVE '&"S        G          (   #00015165' TO DFHEIV0
 17747     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17748     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17749     MOVE X'2020233030303135313635' TO DFHEIV0(25:11)
 17750     CALL 'kxdfhei1' USING DFHEIV0,
 17751           FILE-ID-ERPNDB,
 17752           DFHEIV20,
 17753           DFHEIV99,
 17754           ERPNDB-KEY,
 17755           DFHEIV99,
 17756           DFHEIV99,
 17757           DFHEIV99
 17758     SET ADDRESS OF PENDING-BUSINESS TO
 17759         DFHEIV20
 17760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17761
 17762
 17763     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17764        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17765          GO TO 3030-END-BATCH.
 17766
 17767     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17768
 17769     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17770        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17771          GO TO 3020-BUMP-SEQ.
 17772
 17773     IF PB-ISSUE
 17774        ADD +1                   TO WS-ISS-TOTAL-CNT
 17775        IF PB-FATAL-ERRORS
 17776           ADD +1                      TO WS-ISS-FATAL-CNT
 17777           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17778           GO TO 3020-BUMP-SEQ
 17779        ELSE
 17780           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 323
* VP6311.cbl
 17781              ADD +1                      TO WS-ISS-FORCE-CNT
 17782              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17783              GO TO 3020-BUMP-SEQ
 17784           ELSE
 17785              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17786                 ADD +1                      TO WS-ISS-HOLD-CNT
 17787                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17788                 GO TO 3020-BUMP-SEQ
 17789              ELSE
 17790                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17791                     THRU  3299-EXIT
 17792                 GO TO 3020-BUMP-SEQ.
 17793
 17794     IF PB-CANCELLATION
 17795        ADD +1                   TO WS-CAN-TOTAL-CNT
 17796        IF PB-FATAL-ERRORS
 17797           ADD +1                 TO WS-CAN-FATAL-CNT
 17798           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17799           GO TO 3020-BUMP-SEQ
 17800        ELSE
 17801           IF PB-UNFORCED-ERRORS
 17802              ADD +1                 TO WS-CAN-FORCE-CNT
 17803              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17804              GO TO 3020-BUMP-SEQ
 17805           ELSE
 17806              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17807                 ADD +1                 TO WS-CAN-HOLD-CNT
 17808                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17809                 GO TO 3020-BUMP-SEQ
 17810              ELSE
 17811                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17812                     THRU  3499-EXIT
 17813                 GO TO 3020-BUMP-SEQ.
 17814
 17815     IF PB-BATCH-TRAILER
 17816         GO TO 3030-END-BATCH.
 17817
 17818 3020-BUMP-SEQ.
 17819     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17820     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17821     GO TO 3010-READNEXT.
 17822
 17823 3030-END-BATCH.
 17824     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17825     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17826     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17827     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17828
 17829     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17830                                          - WS-ISS-FORCE-CNT
 17831                                          - WS-ISS-HOLD-CNT).
 17832
 17833     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17834     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17835
 17836     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17837     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17838     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 324
* VP6311.cbl
 17839     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17840     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17841                                          - WS-CAN-FORCE-CNT
 17842                                          - WS-CAN-HOLD-CNT).
 17843     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17844     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17845
 17846     COMPUTE WS-NET-TOTAL-CNT
 17847         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17848     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17849     COMPUTE WS-NET-FATAL-CNT
 17850         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17851     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17852     COMPUTE WS-NET-FORCE-CNT
 17853         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17854     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17855     COMPUTE WS-NET-HOLD-CNT
 17856         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17857     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17858
 17859     COMPUTE WS-NET-AVAIL-CNT
 17860          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17861                              - WS-ISS-FORCE-CNT
 17862                              - WS-ISS-HOLD-CNT)
 17863          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17864                              - WS-CAN-FORCE-CNT
 17865                              - WS-CAN-HOLD-CNT).
 17866     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17867
 17868     COMPUTE WS-NET-GOOD-PREM
 17869         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17870     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17871     COMPUTE WS-NET-BAD-PREM
 17872         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17873     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17874
 17875     MOVE 0000                   TO EMI-ERROR.
 17876     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17877     MOVE -1                     TO DPFENTRL.
 17878     GO TO 8200-SEND-DATAONLY.
 17879
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 325
* VP6311.cbl
 17881
 17882******************************************************************
 17883*                                                                *
 17884*           A D D    B A D   I S S U E   P R E M I U M           *
 17885*                                                                *
 17886******************************************************************
 17887
 17888 3100-ADD-BAD-ISSUE-PREM.
 17889     IF PB-OVERRIDE-LIFE
 17890       OR PB-OVERRIDE-BOTH
 17891           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 17892           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 17893       ELSE
 17894           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 17895           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 17896
 17897     IF PB-OVERRIDE-AH
 17898       OR PB-OVERRIDE-BOTH
 17899           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 17900       ELSE
 17901           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 17902
 17903 3199-EXIT.
 17904     EXIT.
 17905
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 326
* VP6311.cbl
 17907
 17908******************************************************************
 17909*                                                                *
 17910*       A D D   G O O D   I S S U E   P R E M I U M              *
 17911*                                                                *
 17912******************************************************************
 17913
 17914 3200-ADD-GOOD-ISSUE-PREM.
 17915     IF PB-OVERRIDE-LIFE
 17916       OR PB-OVERRIDE-BOTH
 17917           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 17918           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 17919       ELSE
 17920           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17921           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 17922
 17923     IF PB-OVERRIDE-AH
 17924       OR PB-OVERRIDE-BOTH
 17925           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17926       ELSE
 17927           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 17928
 17929 3299-EXIT.
 17930     EXIT.
 17931
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 327
* VP6311.cbl
 17933
 17934
 17935******************************************************************
 17936*                                                                *
 17937*        A D D   B A D   C A N C E L   P R E M I U M             *
 17938*                                                                *
 17939******************************************************************
 17940
 17941 3300-ADD-BAD-CANCEL-PREM.
 17942     IF PB-OVERRIDE-LIFE
 17943       OR PB-OVERRIDE-BOTH
 17944           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 17945       ELSE
 17946           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17947
 17948     IF PB-OVERRIDE-AH
 17949       OR PB-OVERRIDE-BOTH
 17950           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 17951       ELSE
 17952           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17953
 17954 3399-EXIT.
 17955     EXIT.
 17956
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 328
* VP6311.cbl
 17958
 17959******************************************************************
 17960*                                                                *
 17961*       A D D   G O O D   C A N C E L   P R E M I U M            *
 17962*                                                                *
 17963******************************************************************
 17964
 17965 3400-ADD-GOOD-CANCEL-PREM.
 17966     IF PB-OVERRIDE-LIFE
 17967       OR PB-OVERRIDE-BOTH
 17968           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17969       ELSE
 17970           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17971
 17972     IF PB-OVERRIDE-AH
 17973       OR PB-OVERRIDE-BOTH
 17974           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 17975       ELSE
 17976           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17977
 17978 3499-EXIT.
 17979     EXIT.
 17980
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 329
* VP6311.cbl
 17982
 17983******************************************************************
 17984*                                                                *
 17985*           E D I T   B A T C H   D A T A                        *
 17986*                                                                *
 17987******************************************************************
 17988
 17989 3500-EDIT-BATCH-DATA.
 17990     IF PI-PREV-KEY NOT = SPACES
 17991        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 17992     ELSE
 17993        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 17994
 17995     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 17996     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17997
 17998
 17999* EXEC CICS HANDLE CONDITION
 18000*         NOTFND      (3590-NOT-FOUND)
 18001*    END-EXEC.
 18002*    MOVE '"$I                   ! F #00015407' TO DFHEIV0
 18003     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18004     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18005     MOVE X'4620233030303135343037' TO DFHEIV0(25:11)
 18006     CALL 'kxdfhei1' USING DFHEIV0
 18007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18008
 18009
 18010     IF DRISSL   GREATER THAN ZEROS OR
 18011        DRISSL   GREATER THAN ZEROS OR
 18012        DRLFPRML GREATER THAN ZEROS OR
 18013        DRAHPRML GREATER THAN ZEROS OR
 18014        DRCANCL  GREATER THAN ZEROS OR
 18015        DRLFRFDL GREATER THAN ZEROS OR
 18016        DRAHRFDL GREATER THAN ZEROS
 18017              NEXT SENTENCE
 18018          ELSE
 18019              MOVE ER-3224    TO EMI-ERROR
 18020              MOVE -1         TO DPFENTRL
 18021              MOVE AL-UNBON   TO DPFENTRA
 18022              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18023              GO TO 8200-SEND-DATAONLY.
 18024
 18025     IF NOT MODIFY-CAP
 18026         MOVE 'UPDATE'       TO SM-READ
 18027         PERFORM 9995-SECURITY-VIOLATION
 18028         MOVE ER-0070        TO EMI-ERROR
 18029         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18030         GO TO 8100-SEND-INITIAL-MAP.
 18031
 18032        IF DRISSL GREATER THAN ZEROS
 18033           MOVE AL-UNNON         TO DRISSA
 18034           MOVE DRISSI           TO DEEDIT-FIELD
 18035           PERFORM 8600-DEEDIT
 18036           IF DEEDIT-FIELD-V0  NUMERIC
 18037              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18038           ELSE
 18039              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 330
* VP6311.cbl
 18040              MOVE -1         TO DRISSL
 18041              MOVE AL-UNBON   TO DRISSA
 18042              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18043
 18044        IF DRLFPRML GREATER THAN ZEROS
 18045           MOVE AL-UNNON         TO DRLFPRMA
 18046
 18047* EXEC CICS BIF DEEDIT
 18048*              FIELD  (DRLFPRMI)
 18049*              LENGTH (11)
 18050*          END-EXEC
 18051     MOVE 11
 18052       TO DFHEIV11
 18053*    MOVE '@"L                   #   #00015447' TO DFHEIV0
 18054     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18055     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18056     MOVE X'2020233030303135343437' TO DFHEIV0(25:11)
 18057     CALL 'kxdfhei1' USING DFHEIV0,
 18058           DRLFPRMI,
 18059           DFHEIV11
 18060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18061           IF DRLFPRMI NUMERIC
 18062              MOVE DRLFPRMI   TO WS-DRLFPRM
 18063*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18064*          PERFORM 8600-DEEDIT
 18065*          IF DEEDIT-FIELD-V2  NUMERIC
 18066*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18067           ELSE
 18068              MOVE ER-2223    TO EMI-ERROR
 18069              MOVE -1         TO DRLFPRML
 18070              MOVE AL-UNBON   TO DRLFPRMA
 18071              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18072
 18073        IF DRAHPRML GREATER THAN ZEROS
 18074           MOVE AL-UNNON         TO DRAHPRMA
 18075
 18076* EXEC CICS BIF DEEDIT
 18077*              FIELD  (DRAHPRMI)
 18078*              LENGTH (11)
 18079*          END-EXEC
 18080     MOVE 11
 18081       TO DFHEIV11
 18082*    MOVE '@"L                   #   #00015465' TO DFHEIV0
 18083     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18084     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18085     MOVE X'2020233030303135343635' TO DFHEIV0(25:11)
 18086     CALL 'kxdfhei1' USING DFHEIV0,
 18087           DRAHPRMI,
 18088           DFHEIV11
 18089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18090           IF DRAHPRMI NUMERIC
 18091              MOVE DRAHPRMI   TO WS-DRAHPRM
 18092*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18093*          PERFORM 8600-DEEDIT
 18094*          IF DEEDIT-FIELD-V2  NUMERIC
 18095*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18096           ELSE
 18097              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 331
* VP6311.cbl
 18098              MOVE -1         TO DRAHPRML
 18099              MOVE AL-UNBON   TO DRAHPRMA
 18100              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18101
 18102        IF DRCANCL GREATER THAN ZEROS
 18103           MOVE AL-UNNON         TO DRCANCA
 18104           MOVE DRCANCI          TO DEEDIT-FIELD
 18105           PERFORM 8600-DEEDIT
 18106           IF DEEDIT-FIELD-V0  NUMERIC
 18107              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18108           ELSE
 18109              MOVE ER-2223    TO EMI-ERROR
 18110              MOVE -1         TO DRCANCL
 18111              MOVE AL-UNBON   TO DRCANCL
 18112              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18113
 18114        IF DRLFRFDL GREATER THAN ZEROS
 18115           MOVE AL-UNNON         TO DRLFRFDA
 18116
 18117* EXEC CICS BIF DEEDIT
 18118*              FIELD  (DRLFRFDI)
 18119*              LENGTH (11)
 18120*          END-EXEC
 18121     MOVE 11
 18122       TO DFHEIV11
 18123*    MOVE '@"L                   #   #00015495' TO DFHEIV0
 18124     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18125     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18126     MOVE X'2020233030303135343935' TO DFHEIV0(25:11)
 18127     CALL 'kxdfhei1' USING DFHEIV0,
 18128           DRLFRFDI,
 18129           DFHEIV11
 18130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18131           IF DRLFRFDI NUMERIC
 18132              MOVE DRLFRFDI   TO WS-DRLFRFD
 18133*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18134*          PERFORM 8600-DEEDIT
 18135*          IF DEEDIT-FIELD-V2  NUMERIC
 18136*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18137           ELSE
 18138              MOVE ER-2223    TO EMI-ERROR
 18139              MOVE -1         TO DRLFRFDL
 18140              MOVE AL-UNBON   TO DRLFRFDA
 18141              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18142
 18143        IF DRAHRFDL GREATER THAN ZEROS
 18144           MOVE AL-UNNON         TO DRAHRFDA
 18145
 18146* EXEC CICS BIF DEEDIT
 18147*              FIELD  (DRAHRFDI)
 18148*              LENGTH (11)
 18149*          END-EXEC
 18150     MOVE 11
 18151       TO DFHEIV11
 18152*    MOVE '@"L                   #   #00015513' TO DFHEIV0
 18153     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18154     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18155     MOVE X'2020233030303135353133' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 332
* VP6311.cbl
 18156     CALL 'kxdfhei1' USING DFHEIV0,
 18157           DRAHRFDI,
 18158           DFHEIV11
 18159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18160           IF DRAHRFDI NUMERIC
 18161              MOVE DRAHRFDI   TO WS-DRAHRFD
 18162*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18163*          PERFORM 8600-DEEDIT
 18164*          IF DEEDIT-FIELD-V2  NUMERIC
 18165*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18166           ELSE
 18167              MOVE ER-2223    TO EMI-ERROR
 18168              MOVE -1         TO DRAHRFDL
 18169              MOVE AL-UNBON   TO DRAHRFDA
 18170              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18171
 18172     IF EMI-ERROR = ZEROS
 18173        GO 3600-UPDATE-BATCH-HEADER.
 18174
 18175     GO TO 8200-SEND-DATAONLY.
 18176
 18177 3590-NOT-FOUND.
 18178     MOVE ER-2192                TO EMI-ERROR.
 18179     MOVE -1                     TO DPFENTRL.
 18180     MOVE AL-UNBON               TO DPFENTRA.
 18181     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18182     GO TO 8200-SEND-DATAONLY.
 18183
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 333
* VP6311.cbl
 18185
 18186******************************************************************
 18187*                                                                *
 18188*           U P D A T E   B A T C H   H E A D E R                *
 18189*                                                                *
 18190******************************************************************
 18191
 18192 3600-UPDATE-BATCH-HEADER.
 18193
 18194* EXEC CICS HANDLE CONDITION
 18195*         NOTFND      (3690-NOT-FOUND)
 18196*    END-EXEC.
 18197*    MOVE '"$I                   ! G #00015550' TO DFHEIV0
 18198     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18199     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18200     MOVE X'4720233030303135353530' TO DFHEIV0(25:11)
 18201     CALL 'kxdfhei1' USING DFHEIV0
 18202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18203
 18204
 18205
 18206* EXEC CICS READ
 18207*        DATASET (FILE-ID-ERPNDB)
 18208*        RIDFLD  (ERPNDB-KEY)
 18209*        SET     (ADDRESS OF PENDING-BUSINESS)
 18210*        UPDATE
 18211*    END-EXEC.
 18212*    MOVE '&"S        EU         (   #00015554' TO DFHEIV0
 18213     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18214     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18215     MOVE X'2020233030303135353534' TO DFHEIV0(25:11)
 18216     CALL 'kxdfhei1' USING DFHEIV0,
 18217           FILE-ID-ERPNDB,
 18218           DFHEIV20,
 18219           DFHEIV99,
 18220           ERPNDB-KEY,
 18221           DFHEIV99,
 18222           DFHEIV99,
 18223           DFHEIV99
 18224     SET ADDRESS OF PENDING-BUSINESS TO
 18225         DFHEIV20
 18226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18227
 18228
 18229     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18230     MOVE 'B'                    TO JP-RECORD-TYPE.
 18231     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18232
 18233     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18234
 18235     PERFORM 8400-LOG-JOURNAL-RECORD.
 18236
 18237     IF DRISSL GREATER THAN ZEROS
 18238        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18239
 18240     IF DRCANCL GREATER THAN ZEROS
 18241        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18242
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 334
* VP6311.cbl
 18243
 18244     IF DRLFPRML GREATER THAN ZEROS
 18245        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18246
 18247     IF DRAHPRML GREATER THAN ZEROS
 18248        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18249
 18250     IF DRLFRFDL GREATER THAN ZEROS
 18251        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18252
 18253     IF DRAHRFDL GREATER THAN ZEROS
 18254        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18255
 18256 3670-REWRITE-BATCH-HEADER.
 18257     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18258        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18259        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18260        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18261        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18262        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18263        MOVE SPACE               TO PB-OUT-BAL-CD
 18264     ELSE
 18265        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18266
 18267     MOVE 'C'                    TO JP-RECORD-TYPE.
 18268     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18269
 18270
 18271* EXEC CICS REWRITE
 18272*         DATASET      (FILE-ID-ERPNDB)
 18273*         FROM         (PENDING-BUSINESS)
 18274*    END-EXEC.
 18275     MOVE LENGTH OF
 18276      PENDING-BUSINESS
 18277       TO DFHEIV11
 18278*    MOVE '&& L                  %   #00015602' TO DFHEIV0
 18279     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18280     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18281     MOVE X'2020233030303135363032' TO DFHEIV0(25:11)
 18282     CALL 'kxdfhei1' USING DFHEIV0,
 18283           FILE-ID-ERPNDB,
 18284           PENDING-BUSINESS,
 18285           DFHEIV11,
 18286           DFHEIV99
 18287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18288
 18289
 18290     PERFORM 8400-LOG-JOURNAL-RECORD.
 18291
 18292     GO TO 7200-DISPLAY-BATCHES.
 18293
 18294 3690-NOT-FOUND.
 18295     MOVE ER-2192                TO EMI-ERROR.
 18296     MOVE -1                     TO DPFENTRL.
 18297     MOVE AL-UNBON               TO DPFENTRA.
 18298     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18299     GO TO 8200-SEND-DATAONLY.
 18300
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 335
* VP6311.cbl
 18302
 18303******************************************************************
 18304*                                                                *
 18305*           R E - D I S P L A Y   R E C O R D                    *
 18306*                                                                *
 18307******************************************************************
 18308
 18309 3900-RE-DISPLAY-RECORD.
 18310
 18311* EXEC CICS HANDLE CONDITION
 18312*         NOTFND   (3990-NOT-FOUND)
 18313*    END-EXEC.
 18314*    MOVE '"$I                   ! H #00015627' TO DFHEIV0
 18315     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18316     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18317     MOVE X'4820233030303135363237' TO DFHEIV0(25:11)
 18318     CALL 'kxdfhei1' USING DFHEIV0
 18319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18320
 18321
 18322     IF PI-DISPLAY-ORIGINAL-BATCH
 18323         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18324     ELSE
 18325         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18326
 18327
 18328* EXEC CICS READ
 18329*         DATASET   (FILE-ID)
 18330*         RIDFLD    (PI-PREV-KEY)
 18331*         SET       (ADDRESS OF PENDING-BUSINESS)
 18332*    END-EXEC.
 18333*    MOVE '&"S        E          (   #00015636' TO DFHEIV0
 18334     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18335     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18336     MOVE X'2020233030303135363336' TO DFHEIV0(25:11)
 18337     CALL 'kxdfhei1' USING DFHEIV0,
 18338           FILE-ID,
 18339           DFHEIV20,
 18340           DFHEIV99,
 18341           PI-PREV-KEY,
 18342           DFHEIV99,
 18343           DFHEIV99,
 18344           DFHEIV99
 18345     SET ADDRESS OF PENDING-BUSINESS TO
 18346         DFHEIV20
 18347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18348
 18349
 18350     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18351
 18352     IF PB-ISSUE
 18353         GO TO 7000-DISPLAY-ISSUES.
 18354
 18355     IF PB-CANCELLATION
 18356         GO TO 7100-DISPLAY-CANCELS.
 18357
 18358     IF PB-BATCH-TRAILER
 18359         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 336
* VP6311.cbl
 18360
 18361 3990-NOT-FOUND.
 18362     MOVE LOW-VALUES             TO VP631BI.
 18363
 18364     IF PI-MAP-NAME = VP631B
 18365         MOVE -1                  TO BMAINTL
 18366     ELSE
 18367         MOVE -1                  TO CMAINTL.
 18368
 18369     GO TO 8100-SEND-INITIAL-MAP.
 18370
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 337
* VP6311.cbl
 18372
 18373***************************************************************
 18374*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18375*                                                             *
 18376*      1. START BROWSE WITH                                   *
 18377*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18378*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18379*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18380*                                                             *
 18381*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18382*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18383*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18384*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18385*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18386*               AND IS IT TO BE DISPLAYED.                    *
 18387*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18388*               DISPLAYED.                                    *
 18389*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18390*               DISPLAYED.                                    *
 18391*                                                             *
 18392*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18393*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18394***************************************************************
 18395
 18396 4000-BROWSE-DETAIL-FORWARD.
 18397     IF FIRST-TIME
 18398        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18399     ELSE
 18400        IF SHOW-RECORD
 18401           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18402           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18403           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18404           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18405           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18406        ELSE
 18407           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18408
 18409
 18410* EXEC CICS HANDLE CONDITION
 18411*         NOTFND   (4050-END-RECORDS)
 18412*         ENDFILE  (4050-END-RECORDS)
 18413*    END-EXEC.
 18414*    MOVE '"$I''                  ! I #00015701' TO DFHEIV0
 18415     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18417     MOVE X'4920233030303135373031' TO DFHEIV0(25:11)
 18418     CALL 'kxdfhei1' USING DFHEIV0
 18419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18420
 18421
 18422
 18423* EXEC CICS STARTBR
 18424*         DATASET   (FILE-ID-ERPNDB2)
 18425*         RIDFLD    (ERPNDB-ALT-KEY)
 18426*    END-EXEC.
 18427     MOVE 0
 18428       TO DFHEIV11
 18429*    MOVE '&,         G          &   #00015706' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 338
* VP6311.cbl
 18430     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18431     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18432     MOVE X'2020233030303135373036' TO DFHEIV0(25:11)
 18433     CALL 'kxdfhei1' USING DFHEIV0,
 18434           FILE-ID-ERPNDB2,
 18435           ERPNDB-ALT-KEY,
 18436           DFHEIV99,
 18437           DFHEIV11,
 18438           DFHEIV99
 18439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18440
 18441
 18442     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18443
 18444     IF FIRST-TIME OR SHOW-RECORD
 18445        MOVE SPACE               TO WS-FIRST-TIME-SW
 18446        GO TO 4005-READ-NEXT-RECORD.
 18447
 18448
 18449* EXEC CICS READNEXT
 18450*         DATASET    (FILE-ID-ERPNDB2)
 18451*         SET        (ADDRESS OF PENDING-BUSINESS)
 18452*         RIDFLD     (ERPNDB-ALT-KEY)
 18453*    END-EXEC.
 18454     MOVE 0
 18455       TO DFHEIV11
 18456*    MOVE '&.S                   )   #00015717' TO DFHEIV0
 18457     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18458     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18459     MOVE X'2020233030303135373137' TO DFHEIV0(25:11)
 18460     CALL 'kxdfhei1' USING DFHEIV0,
 18461           FILE-ID-ERPNDB2,
 18462           DFHEIV20,
 18463           DFHEIV99,
 18464           ERPNDB-ALT-KEY,
 18465           DFHEIV99,
 18466           DFHEIV11,
 18467           DFHEIV99,
 18468           DFHEIV99
 18469     SET ADDRESS OF PENDING-BUSINESS TO
 18470         DFHEIV20
 18471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18472
 18473
 18474 4005-READ-NEXT-RECORD.
 18475
 18476* EXEC CICS READNEXT
 18477*         DATASET    (FILE-ID-ERPNDB2)
 18478*         SET        (ADDRESS OF PENDING-BUSINESS)
 18479*         RIDFLD     (ERPNDB-ALT-KEY)
 18480*    END-EXEC.
 18481     MOVE 0
 18482       TO DFHEIV11
 18483*    MOVE '&.S                   )   #00015724' TO DFHEIV0
 18484     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18485     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18486     MOVE X'2020233030303135373234' TO DFHEIV0(25:11)
 18487     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 339
* VP6311.cbl
 18488           FILE-ID-ERPNDB2,
 18489           DFHEIV20,
 18490           DFHEIV99,
 18491           ERPNDB-ALT-KEY,
 18492           DFHEIV99,
 18493           DFHEIV11,
 18494           DFHEIV99,
 18495           DFHEIV99
 18496     SET ADDRESS OF PENDING-BUSINESS TO
 18497         DFHEIV20
 18498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18499
 18500
 18501     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18502
 18503     IF WS-BATCH-PREFIX = '#CL'
 18504        GO TO 4005-READ-NEXT-RECORD.
 18505
 18506     IF SHOW-RECORD
 18507        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18508           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18509           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18510           PB-STATE         NOT = PI-PB-STATE          OR
 18511           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18512           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18513           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18514           GO TO 4050-END-RECORDS
 18515        ELSE
 18516           GO TO 4010-CHECK-REC-TYPE.
 18517
 18518     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18519        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18520        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18521        PB-STATE            NOT = PI-PB-STATE          OR
 18522        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18523        GO TO 4050-END-RECORDS.
 18524
 18525     IF PB-BATCH-TRAILER
 18526        GO TO 4005-READ-NEXT-RECORD.
 18527
 18528     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18529        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18530           GO TO 4005-READ-NEXT-RECORD
 18531        ELSE
 18532           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18533              GO TO 4010-CHECK-REC-TYPE
 18534           ELSE
 18535              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18536                 GO TO 4010-CHECK-REC-TYPE
 18537              ELSE
 18538                 GO TO 4005-READ-NEXT-RECORD.
 18539
 18540     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18541        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18542           GO TO 4005-READ-NEXT-RECORD.
 18543
 18544 4010-CHECK-REC-TYPE.
 18545     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 340
* VP6311.cbl
 18546         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18547             NEXT SENTENCE
 18548         ELSE
 18549             GO TO 4005-READ-NEXT-RECORD.
 18550
 18551     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18552         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18553             NEXT SENTENCE
 18554        ELSE
 18555             GO TO 4005-READ-NEXT-RECORD.
 18556
 18557     IF NOT DISPLAY-CHANGE-RECORDS AND
 18558            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18559        GO TO 4005-READ-NEXT-RECORD.
 18560
 18561     IF DISPLAY-HOLD-RECORDS AND
 18562        NOT PB-RECORD-ON-HOLD
 18563          GO TO 4005-READ-NEXT-RECORD.
 18564
 18565     IF PB-ISSUE
 18566        IF DISPLAY-CHK-REQ-RECORDS
 18567            GO TO 4005-READ-NEXT-RECORD.
 18568
 18569     IF PB-ISSUE
 18570        IF ISSUE-WITH-WARNING
 18571           IF PB-WARNING-ERRORS
 18572              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18573                  GO TO 4005-READ-NEXT-RECORD
 18574              ELSE
 18575                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18576                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18577                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18578                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18579                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18580                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18581                 GO TO 7000-DISPLAY-ISSUES
 18582           ELSE
 18583              GO TO 4005-READ-NEXT-RECORD.
 18584
 18585     IF PB-ISSUE
 18586        IF (ISSUES-IN-ERROR AND
 18587            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18588            ALL-ISSUES
 18589            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18590            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18591            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18592            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18593            MOVE PB-SV-STATE            TO PI-SV-STATE
 18594            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18595            GO TO 7000-DISPLAY-ISSUES
 18596        ELSE
 18597            GO TO 4005-READ-NEXT-RECORD.
 18598
 18599     IF PB-CANCELLATION
 18600        IF DISPLAY-CHK-REQ-RECORDS
 18601           IF PB-C-REFUND-REQUESTED
 18602              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18603              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 341
* VP6311.cbl
 18604              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18605              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18606              MOVE PB-SV-STATE            TO PI-SV-STATE
 18607              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18608              GO TO 7100-DISPLAY-CANCELS
 18609           ELSE
 18610               GO TO 4005-READ-NEXT-RECORD.
 18611
 18612     IF PB-CANCELLATION
 18613        IF CANCEL-WITH-WARNING
 18614           IF PB-WARNING-ERRORS
 18615              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18616                  GO TO 4005-READ-NEXT-RECORD
 18617              ELSE
 18618                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18619                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18620                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18621                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18622                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18623                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18624                 GO TO 7100-DISPLAY-CANCELS
 18625           ELSE
 18626              GO TO 4005-READ-NEXT-RECORD.
 18627
 18628     IF PB-CANCELLATION
 18629        IF (CANCEL-IN-ERROR  AND
 18630            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18631            ALL-CANCELS
 18632            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18633            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18634            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18635            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18636            MOVE PB-SV-STATE            TO PI-SV-STATE
 18637            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18638            GO TO 7100-DISPLAY-CANCELS.
 18639
 18640     GO TO 4005-READ-NEXT-RECORD.
 18641
 18642 4050-END-RECORDS.
 18643******************************************************************
 18644*                                                                *
 18645*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18646*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING
 18647*         PROGRAM.                                               *
 18648*                                                                *
 18649******************************************************************
 18650
 18651     IF BROWSE-STARTED
 18652        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18653
 18654* EXEC CICS ENDBR
 18655*            DATASET  (FILE-ID-ERPNDB2)
 18656*       END-EXEC.
 18657     MOVE 0
 18658       TO DFHEIV11
 18659*    MOVE '&2                    $   #00015882' TO DFHEIV0
 18660     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18661     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 342
* VP6311.cbl
 18662     MOVE X'2020233030303135383832' TO DFHEIV0(25:11)
 18663     CALL 'kxdfhei1' USING DFHEIV0,
 18664           FILE-ID-ERPNDB2,
 18665           DFHEIV11,
 18666           DFHEIV99
 18667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18668
 18669
 18670     IF  EIBTRNID NOT = TRANS-EXB1
 18671         IF PENDING-BUS-RECS-FOUND
 18672             NEXT SENTENCE
 18673           ELSE
 18674             MOVE '9'            TO PI-BROWSE-SW
 18675             GO TO 9400-CLEAR.
 18676
 18677     IF SHOW-RECORD
 18678        MOVE ER-2253            TO EMI-ERROR
 18679       ELSE
 18680        MOVE ER-2254            TO EMI-ERROR.
 18681
 18682     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18683
 18684     IF PI-MAP-NAME = SPACES
 18685        MOVE -1                  TO DPFENTRL
 18686        MOVE VP631D               TO PI-MAP-NAME
 18687        GO TO 8100-SEND-INITIAL-MAP.
 18688
 18689     IF PI-MAP-NAME = VP631B
 18690        MOVE -1                  TO BMAINTL
 18691     ELSE
 18692        IF PI-MAP-NAME = VP631C
 18693           MOVE -1               TO CMAINTL
 18694        ELSE
 18695           MOVE -1               TO DPFENTRL.
 18696
 18697     GO TO 8200-SEND-DATAONLY.
 18698
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 343
* VP6311.cbl
 18700
 18701***************************************************************
 18702*                                                             *
 18703*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18704*                                                             *
 18705*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18706*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18707*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18708*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18709*                                                             *
 18710*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18711*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18712*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18713*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18714*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18715*                AND IS IT TO BE DISPLAYED.                   *
 18716*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18717*                DISPLAYED.                                   *
 18718*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18719*                DISPLAYED.                                   *
 18720*                                                             *
 18721*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18722*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18723*                                                             *
 18724*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18725*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18726*                THEY ARE NOT TO BE DISPLAYED.                *
 18727*                                                             *
 18728***************************************************************
 18729
 18730 4100-BROWSE-PRIMARY-FORWARD.
 18731     IF FIRST-TIME  OR SHOW-RECORD
 18732        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18733        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18734        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18735     ELSE
 18736        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18737        IF ERPNDB-BATCH-SEQ-NO = +9999
 18738           GO TO 4150-END-BATCH
 18739        ELSE
 18740           IF DISPLAY-CHANGE-RECORDS
 18741              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18742           ELSE
 18743              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18744              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18745
 18746     IF FIRST-TIME
 18747         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18748            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18749              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18750
 18751
 18752* EXEC CICS HANDLE CONDITION
 18753*         ENDFILE  (4150-END-BATCH)
 18754*    END-EXEC.
 18755*    MOVE '"$''                   ! J #00015967' TO DFHEIV0
 18756     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18757     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 344
* VP6311.cbl
 18758     MOVE X'4A20233030303135393637' TO DFHEIV0(25:11)
 18759     CALL 'kxdfhei1' USING DFHEIV0
 18760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18761
 18762
 18763 4105-READ-NEXT.
 18764
 18765* EXEC CICS HANDLE CONDITION
 18766*         NOTFND    (4150-END-BATCH)
 18767*    END-EXEC.
 18768*    MOVE '"$I                   ! K #00015972' TO DFHEIV0
 18769     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18770     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18771     MOVE X'4B20233030303135393732' TO DFHEIV0(25:11)
 18772     CALL 'kxdfhei1' USING DFHEIV0
 18773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18774
 18775
 18776     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18777
 18778     IF PI-DISPLAY-ORIGINAL-BATCH
 18779        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18780     ELSE
 18781        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18782
 18783
 18784* EXEC CICS READ
 18785*         DATASET   (FILE-ID)
 18786*         SET       (ADDRESS OF PENDING-BUSINESS)
 18787*         RIDFLD    (ERPNDB-KEY)
 18788*         GTEQ
 18789*    END-EXEC.
 18790*    MOVE '&"S        G          (   #00015983' TO DFHEIV0
 18791     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18792     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18793     MOVE X'2020233030303135393833' TO DFHEIV0(25:11)
 18794     CALL 'kxdfhei1' USING DFHEIV0,
 18795           FILE-ID,
 18796           DFHEIV20,
 18797           DFHEIV99,
 18798           ERPNDB-KEY,
 18799           DFHEIV99,
 18800           DFHEIV99,
 18801           DFHEIV99
 18802     SET ADDRESS OF PENDING-BUSINESS TO
 18803         DFHEIV20
 18804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18805
 18806
 18807     IF PI-DISPLAY-ORIGINAL-BATCH
 18808        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18809           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18810           GO TO 4150-END-BATCH
 18811        ELSE
 18812           IF PB-BATCH-TRAILER
 18813              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18814              GO TO 4105-READ-NEXT
 18815           ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 345
* VP6311.cbl
 18816              NEXT SENTENCE
 18817     ELSE
 18818        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18819           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18820           GO TO 4150-END-BATCH.
 18821
 18822     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18823
 18824     IF WS-BATCH-PREFIX = '#CL'
 18825         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18826         GO TO 4105-READ-NEXT.
 18827
 18828     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18829     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18830     MOVE PB-STATE               TO PI-PB-STATE.
 18831     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18832
 18833     IF PB-BATCH-TRAILER
 18834        IF SHOW-RECORD
 18835           GO TO 4150-END-BATCH
 18836        ELSE
 18837           MOVE ER-2251         TO EMI-ERROR
 18838           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18839           MOVE 1               TO PI-BROWSE-TYPE
 18840           GO TO 7200-DISPLAY-BATCHES.
 18841
 18842     IF SHOW-RECORD
 18843           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18844              GO TO 4110-BUMP-SEQ
 18845           ELSE
 18846              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18847                 GO TO 4110-BUMP-SEQ
 18848              ELSE
 18849                 GO TO 4107-CHECK-REC-TYPE.
 18850
 18851     IF NOT  PI-PRIMARY-WITH-SELECT
 18852        GO TO 4107-CHECK-REC-TYPE.
 18853
 18854     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18855        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18856           GO TO 4110-BUMP-SEQ
 18857        ELSE
 18858           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18859              GO TO 4107-CHECK-REC-TYPE
 18860           ELSE
 18861              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18862                 GO TO 4107-CHECK-REC-TYPE
 18863              ELSE
 18864                 GO TO 4110-BUMP-SEQ.
 18865
 18866     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18867        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18868           GO TO 4110-BUMP-SEQ.
 18869
 18870 4107-CHECK-REC-TYPE.
 18871     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18872         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18873             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 346
* VP6311.cbl
 18874           ELSE
 18875             GO TO 4110-BUMP-SEQ.
 18876
 18877     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18878         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18879             NEXT SENTENCE
 18880           ELSE
 18881             GO TO 4110-BUMP-SEQ.
 18882
 18883     IF NOT DISPLAY-CHANGE-RECORDS AND
 18884        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18885           GO TO 4110-BUMP-SEQ.
 18886
 18887     IF DISPLAY-HOLD-RECORDS AND
 18888        NOT PB-RECORD-ON-HOLD
 18889          GO TO 4110-BUMP-SEQ.
 18890
 18891     IF PB-ISSUE
 18892        IF DISPLAY-CHK-REQ-RECORDS
 18893            GO TO 4110-BUMP-SEQ.
 18894
 18895     IF PB-ISSUE
 18896        IF ISSUE-WITH-WARNING
 18897           IF PB-WARNING-ERRORS
 18898              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18899                  GO TO 4110-BUMP-SEQ
 18900              ELSE
 18901                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18902                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18903                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18904                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18905                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18906                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18907                 GO TO 7000-DISPLAY-ISSUES
 18908        ELSE
 18909            GO TO 4110-BUMP-SEQ.
 18910
 18911     IF PB-ISSUE
 18912        IF (ISSUES-IN-ERROR AND
 18913            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18914            ALL-ISSUES
 18915            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18916            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18917            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18918            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18919            MOVE PB-SV-STATE            TO PI-SV-STATE
 18920            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18921            GO TO 7000-DISPLAY-ISSUES
 18922        ELSE
 18923            GO TO 4110-BUMP-SEQ.
 18924
 18925     IF PB-CANCELLATION
 18926        IF DISPLAY-CHK-REQ-RECORDS
 18927           IF PB-C-REFUND-REQUESTED
 18928              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18929              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18930              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18931              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 347
* VP6311.cbl
 18932              MOVE PB-SV-STATE            TO PI-SV-STATE
 18933              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18934              GO TO 7100-DISPLAY-CANCELS
 18935           ELSE
 18936              GO TO 4110-BUMP-SEQ.
 18937
 18938     IF PB-CANCELLATION
 18939        IF CANCEL-WITH-WARNING
 18940           IF PB-WARNING-ERRORS
 18941              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18942                  GO TO 4110-BUMP-SEQ
 18943              ELSE
 18944                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18945                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18946                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18947                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18948                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18949                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18950                 GO TO 7100-DISPLAY-CANCELS
 18951           ELSE
 18952              GO TO 4110-BUMP-SEQ.
 18953
 18954     IF PB-CANCELLATION
 18955        IF (CANCEL-IN-ERROR  AND
 18956            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18957            ALL-CANCELS
 18958            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18959            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18960            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18961            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18962            MOVE PB-SV-STATE            TO PI-SV-STATE
 18963            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 18964            GO TO 7100-DISPLAY-CANCELS.
 18965
 18966 4110-BUMP-SEQ.
 18967     IF NOT DISPLAY-CHANGE-RECORDS
 18968        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18969        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18970     ELSE
 18971        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18972           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18973           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18974        ELSE
 18975           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18976           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 18977
 18978     GO TO 4105-READ-NEXT.
 18979
 18980 4150-END-BATCH.
 18981******************************************************************
 18982*                                                                *
 18983*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18984*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING     *
 18985*         PROGRAM.                                               *
 18986*                                                                *
 18987******************************************************************
 18988
 18989     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 348
* VP6311.cbl
 18990         IF PENDING-BUS-RECS-FOUND
 18991             NEXT SENTENCE
 18992           ELSE
 18993             MOVE '9'            TO PI-BROWSE-SW
 18994             GO TO 9400-CLEAR.
 18995
 18996     IF SHOW-RECORD
 18997        MOVE ER-2253             TO EMI-ERROR
 18998     ELSE
 18999        MOVE ER-2251             TO EMI-ERROR.
 19000
 19001     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19002
 19003     IF PI-MAP-NAME = SPACES
 19004        MOVE -1                  TO BMAINTL
 19005        MOVE VP631B              TO PI-MAP-NAME
 19006        GO TO 8100-SEND-INITIAL-MAP.
 19007
 19008     IF PI-MAP-NAME = VP631B
 19009        MOVE -1                  TO BMAINTL
 19010     ELSE
 19011        IF PI-MAP-NAME = VP631C
 19012           MOVE -1               TO CMAINTL
 19013        ELSE
 19014           MOVE -1               TO DPFENTRL.
 19015
 19016     GO TO 8200-SEND-DATAONLY.
 19017
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 349
* VP6311.cbl
 19019
 19020***************************************************************
 19021*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19022*                                                             *
 19023*      1. START BROWSE WITH                                   *
 19024*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19025*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19026*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19027*                                                             *
 19028*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19029*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19030*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19031*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19032*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19033*               AND IS IT TO BE DISPLAYED.                    *
 19034*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19035*               DISPLAYED.                                    *
 19036*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19037*               DISPLAYED.                                    *
 19038*                                                             *
 19039*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19040*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19041***************************************************************
 19042
 19043 4200-BROWSE-CSR-FORWARD.
 19044
 19045     IF FIRST-TIME
 19046        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19047     ELSE
 19048        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19049
 19050
 19051* EXEC CICS HANDLE CONDITION
 19052*         NOTFND   (4250-END-RECORDS)
 19053*         ENDFILE  (4250-END-RECORDS)
 19054*    END-EXEC.
 19055*    MOVE '"$I''                  ! L #00016233' TO DFHEIV0
 19056     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19057     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19058     MOVE X'4C20233030303136323333' TO DFHEIV0(25:11)
 19059     CALL 'kxdfhei1' USING DFHEIV0
 19060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19061
 19062
 19063
 19064* EXEC CICS STARTBR
 19065*         DATASET   (FILE-ID-ERPNDB4)
 19066*         RIDFLD    (ERPNDB-CSR-KEY)
 19067*    END-EXEC.
 19068     MOVE 0
 19069       TO DFHEIV11
 19070*    MOVE '&,         G          &   #00016238' TO DFHEIV0
 19071     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19072     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19073     MOVE X'2020233030303136323338' TO DFHEIV0(25:11)
 19074     CALL 'kxdfhei1' USING DFHEIV0,
 19075           FILE-ID-ERPNDB4,
 19076           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 350
* VP6311.cbl
 19077           DFHEIV99,
 19078           DFHEIV11,
 19079           DFHEIV99
 19080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19081
 19082
 19083     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19084
 19085     IF FIRST-TIME
 19086        MOVE SPACE               TO WS-FIRST-TIME-SW
 19087        GO TO 4205-READ-NEXT-RECORD.
 19088
 19089
 19090* EXEC CICS READNEXT
 19091*         DATASET    (FILE-ID-ERPNDB4)
 19092*         SET        (ADDRESS OF PENDING-BUSINESS)
 19093*         RIDFLD     (ERPNDB-CSR-KEY)
 19094*    END-EXEC.
 19095     MOVE 0
 19096       TO DFHEIV11
 19097*    MOVE '&.S                   )   #00016249' TO DFHEIV0
 19098     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19099     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19100     MOVE X'2020233030303136323439' TO DFHEIV0(25:11)
 19101     CALL 'kxdfhei1' USING DFHEIV0,
 19102           FILE-ID-ERPNDB4,
 19103           DFHEIV20,
 19104           DFHEIV99,
 19105           ERPNDB-CSR-KEY,
 19106           DFHEIV99,
 19107           DFHEIV11,
 19108           DFHEIV99,
 19109           DFHEIV99
 19110     SET ADDRESS OF PENDING-BUSINESS TO
 19111         DFHEIV20
 19112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19113
 19114
 19115 4205-READ-NEXT-RECORD.
 19116
 19117
 19118* EXEC CICS READNEXT
 19119*         DATASET    (FILE-ID-ERPNDB4)
 19120*         SET        (ADDRESS OF PENDING-BUSINESS)
 19121*         RIDFLD     (ERPNDB-CSR-KEY)
 19122*    END-EXEC.
 19123     MOVE 0
 19124       TO DFHEIV11
 19125*    MOVE '&.S                   )   #00016257' TO DFHEIV0
 19126     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19127     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19128     MOVE X'2020233030303136323537' TO DFHEIV0(25:11)
 19129     CALL 'kxdfhei1' USING DFHEIV0,
 19130           FILE-ID-ERPNDB4,
 19131           DFHEIV20,
 19132           DFHEIV99,
 19133           ERPNDB-CSR-KEY,
 19134           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 351
* VP6311.cbl
 19135           DFHEIV11,
 19136           DFHEIV99,
 19137           DFHEIV99
 19138     SET ADDRESS OF PENDING-BUSINESS TO
 19139         DFHEIV20
 19140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19141
 19142
 19143     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19144
 19145     IF WS-BATCH-PREFIX = '#CL'
 19146        GO TO 4205-READ-NEXT-RECORD.
 19147
 19148     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19149        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19150        GO TO 4250-END-RECORDS.
 19151
 19152     IF PB-BATCH-TRAILER
 19153        GO TO 4205-READ-NEXT-RECORD.
 19154
 19155     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19156        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19157           GO TO 4205-READ-NEXT-RECORD
 19158        ELSE
 19159           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19160              GO TO 4210-CHECK-REC-TYPE
 19161           ELSE
 19162              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19163                 GO TO 4210-CHECK-REC-TYPE
 19164              ELSE
 19165                 GO TO 4205-READ-NEXT-RECORD.
 19166
 19167     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19168        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19169           GO TO 4205-READ-NEXT-RECORD.
 19170
 19171 4210-CHECK-REC-TYPE.
 19172     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19173         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19174             NEXT SENTENCE
 19175         ELSE
 19176             GO TO 4205-READ-NEXT-RECORD.
 19177
 19178     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19179         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19180             NEXT SENTENCE
 19181        ELSE
 19182             GO TO 4205-READ-NEXT-RECORD.
 19183
 19184     IF NOT DISPLAY-CHANGE-RECORDS AND
 19185            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19186        GO TO 4205-READ-NEXT-RECORD.
 19187
 19188     IF DISPLAY-HOLD-RECORDS AND
 19189        NOT PB-RECORD-ON-HOLD
 19190          GO TO 4205-READ-NEXT-RECORD.
 19191
 19192     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 352
* VP6311.cbl
 19193        IF DISPLAY-CHK-REQ-RECORDS
 19194            GO TO 4205-READ-NEXT-RECORD.
 19195
 19196     IF PB-ISSUE
 19197        IF ISSUE-WITH-WARNING
 19198           IF PB-WARNING-ERRORS
 19199              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19200                  GO TO 4205-READ-NEXT-RECORD
 19201              ELSE
 19202                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19203                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19204                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19205                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19206                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19207                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19208                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19209                 GO TO 7000-DISPLAY-ISSUES
 19210           ELSE
 19211              GO TO 4205-READ-NEXT-RECORD.
 19212
 19213     IF PB-ISSUE
 19214        IF (ISSUES-IN-ERROR AND
 19215            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19216            ALL-ISSUES
 19217            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19218            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19219            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19220            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19221            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19222            MOVE PB-SV-STATE            TO PI-SV-STATE
 19223            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19224            GO TO 7000-DISPLAY-ISSUES
 19225        ELSE
 19226            GO TO 4205-READ-NEXT-RECORD.
 19227
 19228     IF PB-CANCELLATION
 19229        IF DISPLAY-CHK-REQ-RECORDS
 19230           IF PB-C-REFUND-REQUESTED
 19231              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19232              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19233              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19234              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19235              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19236              MOVE PB-SV-STATE            TO PI-SV-STATE
 19237              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19238              GO TO 7100-DISPLAY-CANCELS
 19239           ELSE
 19240               GO TO 4205-READ-NEXT-RECORD.
 19241
 19242     IF PB-CANCELLATION
 19243        IF CANCEL-WITH-WARNING
 19244           IF PB-WARNING-ERRORS
 19245              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19246                  GO TO 4205-READ-NEXT-RECORD
 19247              ELSE
 19248                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19249                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19250                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 353
* VP6311.cbl
 19251                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19252                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19253                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19254                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19255                 GO TO 7100-DISPLAY-CANCELS
 19256           ELSE
 19257              GO TO 4205-READ-NEXT-RECORD.
 19258
 19259     IF PB-CANCELLATION
 19260        IF (CANCEL-IN-ERROR  AND
 19261            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19262            ALL-CANCELS
 19263            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19264            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19265            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19266            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19267            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19268            MOVE PB-SV-STATE            TO PI-SV-STATE
 19269            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19270            GO TO 7100-DISPLAY-CANCELS.
 19271
 19272     GO TO 4205-READ-NEXT-RECORD.
 19273
 19274 4250-END-RECORDS.
 19275******************************************************************
 19276*                                                                *
 19277*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19278*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING
 19279*         PROGRAM.                                               *
 19280*                                                                *
 19281******************************************************************
 19282
 19283     IF BROWSE-STARTED
 19284        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19285
 19286* EXEC CICS ENDBR
 19287*            DATASET  (FILE-ID-ERPNDB4)
 19288*       END-EXEC.
 19289     MOVE 0
 19290       TO DFHEIV11
 19291*    MOVE '&2                    $   #00016405' TO DFHEIV0
 19292     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19293     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19294     MOVE X'2020233030303136343035' TO DFHEIV0(25:11)
 19295     CALL 'kxdfhei1' USING DFHEIV0,
 19296           FILE-ID-ERPNDB4,
 19297           DFHEIV11,
 19298           DFHEIV99
 19299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19300
 19301
 19302     IF  EIBTRNID NOT = TRANS-EXB1
 19303         IF PENDING-BUS-RECS-FOUND
 19304             NEXT SENTENCE
 19305           ELSE
 19306             MOVE '9'            TO PI-BROWSE-SW
 19307             GO TO 9400-CLEAR.
 19308
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 354
* VP6311.cbl
 19309     IF SHOW-RECORD
 19310        MOVE ER-2253            TO EMI-ERROR
 19311       ELSE
 19312        MOVE ER-2254            TO EMI-ERROR.
 19313
 19314     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19315
 19316     IF PI-MAP-NAME = SPACES
 19317        MOVE -1                  TO DPFENTRL
 19318        MOVE VP631D               TO PI-MAP-NAME
 19319        GO TO 8100-SEND-INITIAL-MAP.
 19320
 19321     IF PI-MAP-NAME = VP631B
 19322        MOVE -1                  TO BMAINTL
 19323     ELSE
 19324        IF PI-MAP-NAME = VP631C
 19325           MOVE -1               TO CMAINTL
 19326        ELSE
 19327           MOVE -1               TO DPFENTRL.
 19328
 19329     GO TO 8200-SEND-DATAONLY.
 19330
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 355
* VP6311.cbl
 19332
 19333***************************************************************
 19334*                                                             *
 19335*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19336*                                                             *
 19337*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19338*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19339*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19340*                                                             *
 19341*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19342*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19343*          A. IS IT WITHIN THE SAME COMPANY                   *
 19344*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19345*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19346*                AND IS IT TO BE DISPLAYED.                   *
 19347*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19348*                DISPLAYED.                                   *
 19349*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19350*                DISPLAYED.                                   *
 19351*                                                             *
 19352*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19353*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19354*                                                             *
 19355*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19356*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19357*                THEY ARE NOT TO BE DISPLAYED.                *
 19358*                                                             *
 19359***************************************************************
 19360
 19361 4300-BROWSE-FILE-FORWARD.
 19362     IF FIRST-TIME OR SHOW-RECORD
 19363        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19364        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19365        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19366     ELSE
 19367        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19368        IF ERPNDB-BATCH-SEQ-NO = +9999
 19369           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19370        ELSE
 19371           IF DISPLAY-CHANGE-RECORDS
 19372              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19373           ELSE
 19374              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19375              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19376
 19377
 19378* EXEC CICS HANDLE CONDITION
 19379*         ENDFILE  (4350-END-BATCH)
 19380*         NOTFND   (4350-END-BATCH)
 19381*    END-EXEC.
 19382*    MOVE '"$''I                  ! M #00016484' TO DFHEIV0
 19383     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19384     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19385     MOVE X'4D20233030303136343834' TO DFHEIV0(25:11)
 19386     CALL 'kxdfhei1' USING DFHEIV0
 19387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19388
 19389
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 356
* VP6311.cbl
 19390 4305-READ-NEXT.
 19391     IF PI-DISPLAY-ORIGINAL-BATCH
 19392        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19393     ELSE
 19394        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19395
 19396
 19397* EXEC CICS READ
 19398*         DATASET   (FILE-ID)
 19399*         SET       (ADDRESS OF PENDING-BUSINESS)
 19400*         RIDFLD    (ERPNDB-KEY)
 19401*         GTEQ
 19402*    END-EXEC.
 19403*    MOVE '&"S        G          (   #00016495' TO DFHEIV0
 19404     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19405     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19406     MOVE X'2020233030303136343935' TO DFHEIV0(25:11)
 19407     CALL 'kxdfhei1' USING DFHEIV0,
 19408           FILE-ID,
 19409           DFHEIV20,
 19410           DFHEIV99,
 19411           ERPNDB-KEY,
 19412           DFHEIV99,
 19413           DFHEIV99,
 19414           DFHEIV99
 19415     SET ADDRESS OF PENDING-BUSINESS TO
 19416         DFHEIV20
 19417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19418
 19419
 19420     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19421        GO TO 4350-END-BATCH.
 19422
 19423     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19424                                    WS-BATCH-NO.
 19425
 19426     IF  WS-BATCH-PREFIX = '#CL'
 19427         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19428         GO TO 4305-READ-NEXT.
 19429
 19430     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19431     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19432     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19433     MOVE PB-STATE               TO PI-PB-STATE.
 19434     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19435
 19436     IF PB-BATCH-TRAILER
 19437        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19438        GO TO 4305-READ-NEXT.
 19439
 19440     IF SHOW-RECORD
 19441           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19442              GO TO 4310-BUMP-SEQ
 19443           ELSE
 19444              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19445                 GO TO 4310-BUMP-SEQ
 19446              ELSE
 19447                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 357
* VP6311.cbl
 19448
 19449     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19450        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19451           GO TO 4310-BUMP-SEQ
 19452        ELSE
 19453           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19454              GO TO 4307-CHECK-REC-TYPE
 19455           ELSE
 19456              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19457                 GO TO 4307-CHECK-REC-TYPE
 19458              ELSE
 19459                 GO TO 4310-BUMP-SEQ.
 19460
 19461     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19462        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19463           GO TO 4310-BUMP-SEQ.
 19464
 19465 4307-CHECK-REC-TYPE.
 19466     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19467         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19468             NEXT SENTENCE
 19469         ELSE
 19470             GO TO 4310-BUMP-SEQ.
 19471
 19472     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19473         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19474             NEXT SENTENCE
 19475        ELSE
 19476             GO TO 4310-BUMP-SEQ.
 19477
 19478     IF NOT DISPLAY-CHANGE-RECORDS AND
 19479            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19480        GO TO 4310-BUMP-SEQ.
 19481
 19482     IF DISPLAY-HOLD-RECORDS AND
 19483        NOT PB-RECORD-ON-HOLD
 19484          GO TO 4310-BUMP-SEQ.
 19485
 19486     IF PB-ISSUE
 19487        IF DISPLAY-CHK-REQ-RECORDS
 19488           GO TO 4310-BUMP-SEQ.
 19489
 19490     IF PB-ISSUE
 19491        IF ISSUE-WITH-WARNING
 19492           IF PB-WARNING-ERRORS
 19493              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19494                  GO TO 4310-BUMP-SEQ
 19495              ELSE
 19496                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19497                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19498                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19499                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19500                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19501                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19502                 GO TO 7000-DISPLAY-ISSUES
 19503           ELSE
 19504              GO TO 4310-BUMP-SEQ.
 19505
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 358
* VP6311.cbl
 19506     IF PB-ISSUE
 19507        IF (ISSUES-IN-ERROR AND
 19508            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19509            ALL-ISSUES
 19510            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19511            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19512            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19513            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19514            MOVE PB-SV-STATE            TO PI-SV-STATE
 19515            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19516            GO TO 7000-DISPLAY-ISSUES
 19517        ELSE
 19518            GO TO 4310-BUMP-SEQ.
 19519
 19520     IF PB-CANCELLATION
 19521        IF DISPLAY-CHK-REQ-RECORDS
 19522           IF PB-C-REFUND-REQUESTED
 19523              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19524              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19525              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19526              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19527              MOVE PB-SV-STATE            TO PI-SV-STATE
 19528              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19529              GO TO 7100-DISPLAY-CANCELS
 19530           ELSE
 19531              GO TO 4310-BUMP-SEQ.
 19532
 19533     IF PB-CANCELLATION
 19534        IF CANCEL-WITH-WARNING
 19535           IF PB-WARNING-ERRORS
 19536              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19537                  GO TO 4310-BUMP-SEQ
 19538              ELSE
 19539                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19540                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19541                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19542                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19543                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19544                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19545                 GO TO 7100-DISPLAY-CANCELS
 19546           ELSE
 19547              GO TO 4310-BUMP-SEQ.
 19548
 19549     IF PB-CANCELLATION
 19550        IF (CANCEL-IN-ERROR  AND
 19551            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19552            ALL-CANCELS
 19553            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19554            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19555            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19556            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19557            MOVE PB-SV-STATE            TO PI-SV-STATE
 19558            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19559            GO TO 7100-DISPLAY-CANCELS.
 19560
 19561 4310-BUMP-SEQ.
 19562     IF NOT DISPLAY-CHANGE-RECORDS
 19563        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 359
* VP6311.cbl
 19564        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19565     ELSE
 19566        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19567           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19568           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19569        ELSE
 19570           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19571           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19572
 19573     GO TO 4305-READ-NEXT.
 19574
 19575 4350-END-BATCH.
 19576
 19577******************************************************************
 19578*                                                                *
 19579*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19580*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING    *
 19581*         PROGRAM.                                               *
 19582*                                                                *
 19583******************************************************************
 19584
 19585     IF  EIBTRNID NOT = TRANS-EXB1
 19586         IF PENDING-BUS-RECS-FOUND
 19587             NEXT SENTENCE
 19588           ELSE
 19589             MOVE '9'            TO PI-BROWSE-SW
 19590             GO TO 9400-CLEAR.
 19591
 19592     IF SHOW-RECORD
 19593        MOVE ER-2253            TO EMI-ERROR
 19594     ELSE
 19595        MOVE ER-2251            TO EMI-ERROR.
 19596
 19597     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19598
 19599     IF PI-MAP-NAME = SPACES
 19600        MOVE -1                  TO BMAINTL
 19601        MOVE VP631B               TO PI-MAP-NAME
 19602        GO TO 8100-SEND-INITIAL-MAP.
 19603
 19604     IF PI-MAP-NAME = VP631B
 19605        MOVE -1                  TO BMAINTL
 19606     ELSE
 19607        IF PI-MAP-NAME = VP631C
 19608           MOVE -1               TO CMAINTL
 19609        ELSE
 19610           MOVE -1               TO DPFENTRL.
 19611
 19612     GO TO 8200-SEND-DATAONLY.
 19613
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 360
* VP6311.cbl
 19615
 19616******************************************************************
 19617*                                                                *
 19618*        B R O W S E   D E T A I L   B A C K W A R D             *
 19619*                                                                *
 19620******************************************************************
 19621
 19622 4500-BROWSE-DETAIL-BACKWARD.
 19623
 19624     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19625
 19626
 19627* EXEC CICS HANDLE CONDITION
 19628*         NOTFND   (4570-NOT-FOUND)
 19629*         ENDFILE  (4550-END-RECORDS)
 19630*    END-EXEC
 19631*    MOVE '"$I''                  ! N #00016708' TO DFHEIV0
 19632     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19633     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19634     MOVE X'4E20233030303136373038' TO DFHEIV0(25:11)
 19635     CALL 'kxdfhei1' USING DFHEIV0
 19636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19637
 19638
 19639* EXEC CICS STARTBR
 19640*         DATASET   (FILE-ID-ERPNDB2)
 19641*         RIDFLD    (ERPNDB-ALT-KEY)
 19642*    END-EXEC.
 19643     MOVE 0
 19644       TO DFHEIV11
 19645*    MOVE '&,         G          &   #00016713' TO DFHEIV0
 19646     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19647     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19648     MOVE X'2020233030303136373133' TO DFHEIV0(25:11)
 19649     CALL 'kxdfhei1' USING DFHEIV0,
 19650           FILE-ID-ERPNDB2,
 19651           ERPNDB-ALT-KEY,
 19652           DFHEIV99,
 19653           DFHEIV11,
 19654           DFHEIV99
 19655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19656
 19657
 19658     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19659                                    WS-FIRST-TIME-SW.
 19660
 19661 4505-READ-PREV-RECORD.
 19662
 19663* EXEC CICS READPREV
 19664*         DATASET    (FILE-ID-ERPNDB2)
 19665*         SET        (ADDRESS OF PENDING-BUSINESS)
 19666*         RIDFLD     (ERPNDB-ALT-KEY)
 19667*    END-EXEC.
 19668     MOVE 0
 19669       TO DFHEIV11
 19670*    MOVE '&0S                   )   #00016722' TO DFHEIV0
 19671     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19672     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 361
* VP6311.cbl
 19673     MOVE X'2020233030303136373232' TO DFHEIV0(25:11)
 19674     CALL 'kxdfhei1' USING DFHEIV0,
 19675           FILE-ID-ERPNDB2,
 19676           DFHEIV20,
 19677           DFHEIV99,
 19678           ERPNDB-ALT-KEY,
 19679           DFHEIV99,
 19680           DFHEIV11,
 19681           DFHEIV99,
 19682           DFHEIV99
 19683     SET ADDRESS OF PENDING-BUSINESS TO
 19684         DFHEIV20
 19685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19686
 19687
 19688     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19689
 19690     IF WS-BATCH-PREFIX = '#CL'
 19691         GO TO 4505-READ-PREV-RECORD.
 19692
 19693     IF FIRST-TIME
 19694         MOVE SPACE               TO WS-FIRST-TIME-SW
 19695         GO TO 4505-READ-PREV-RECORD.
 19696
 19697     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19698        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19699        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19700        PB-STATE         NOT = PI-PB-STATE    OR
 19701        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19702          GO TO 4550-END-RECORDS.
 19703
 19704
 19705     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19706
 19707     IF PB-BATCH-TRAILER
 19708        GO TO 4505-READ-PREV-RECORD.
 19709
 19710     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19711
 19712     IF  WS-BATCH-PREFIX = '#CL'
 19713         GO TO 4505-READ-PREV-RECORD.
 19714
 19715     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19716        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19717           GO TO 4505-READ-PREV-RECORD
 19718        ELSE
 19719           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19720              GO TO 4510-CHECK-REC-TYPE
 19721           ELSE
 19722              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19723                 GO TO 4510-CHECK-REC-TYPE
 19724              ELSE
 19725                 GO TO 4505-READ-PREV-RECORD.
 19726
 19727     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19728        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19729           GO TO 4505-READ-PREV-RECORD.
 19730
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 362
* VP6311.cbl
 19731 4510-CHECK-REC-TYPE.
 19732     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19733         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19734             NEXT SENTENCE
 19735         ELSE
 19736             GO TO 4505-READ-PREV-RECORD.
 19737
 19738     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19739         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19740             NEXT SENTENCE
 19741        ELSE
 19742             GO TO 4505-READ-PREV-RECORD.
 19743
 19744     IF NOT DISPLAY-CHANGE-RECORDS AND
 19745            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19746        GO TO 4505-READ-PREV-RECORD.
 19747
 19748     IF DISPLAY-HOLD-RECORDS AND
 19749        NOT PB-RECORD-ON-HOLD
 19750          GO TO 4505-READ-PREV-RECORD.
 19751
 19752     IF PB-ISSUE
 19753        IF DISPLAY-CHK-REQ-RECORDS
 19754           GO TO 4505-READ-PREV-RECORD.
 19755
 19756     IF PB-ISSUE
 19757        IF ISSUE-WITH-WARNING
 19758           IF PB-WARNING-ERRORS
 19759              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19760                  GO TO 4505-READ-PREV-RECORD
 19761              ELSE
 19762                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19763                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19764                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19765                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19766                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19767                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19768                 GO TO 7000-DISPLAY-ISSUES
 19769           ELSE
 19770              GO TO 4505-READ-PREV-RECORD.
 19771
 19772     IF PB-ISSUE
 19773        IF (ISSUES-IN-ERROR AND
 19774            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19775            ALL-ISSUES
 19776            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19777            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19778            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19779            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19780            MOVE PB-SV-STATE            TO PI-SV-STATE
 19781            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19782            GO TO 7000-DISPLAY-ISSUES
 19783        ELSE
 19784            GO TO 4505-READ-PREV-RECORD.
 19785
 19786     IF PB-CANCELLATION
 19787        IF DISPLAY-CHK-REQ-RECORDS
 19788           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 363
* VP6311.cbl
 19789              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19790              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19791              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19792              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19793              MOVE PB-SV-STATE            TO PI-SV-STATE
 19794              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19795              GO TO 7100-DISPLAY-CANCELS
 19796           ELSE
 19797              GO TO 4505-READ-PREV-RECORD.
 19798
 19799     IF PB-CANCELLATION
 19800        IF CANCEL-WITH-WARNING
 19801           IF PB-WARNING-ERRORS
 19802              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19803                  GO TO 4505-READ-PREV-RECORD
 19804              ELSE
 19805                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19806                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19807                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19808                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19809                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19810                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19811                 GO TO 7100-DISPLAY-CANCELS
 19812           ELSE
 19813              GO TO 4505-READ-PREV-RECORD.
 19814
 19815     IF PB-CANCELLATION
 19816        IF (CANCEL-IN-ERROR  AND
 19817            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19818            ALL-CANCELS
 19819            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19820            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19821            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19822            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19823            MOVE PB-SV-STATE            TO PI-SV-STATE
 19824            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19825            GO TO 7100-DISPLAY-CANCELS.
 19826
 19827     GO TO 4505-READ-PREV-RECORD.
 19828
 19829 4550-END-RECORDS.
 19830     IF PI-MAP-NAME = VP631B
 19831        MOVE -1                  TO BMAINTL
 19832     ELSE
 19833        IF PI-MAP-NAME = VP631C
 19834           MOVE -1               TO CMAINTL
 19835        ELSE
 19836           MOVE -1               TO DPFENTRL.
 19837
 19838     MOVE ER-2255               TO EMI-ERROR.
 19839     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19840     GO TO 8200-SEND-DATAONLY.
 19841
 19842 4570-NOT-FOUND.
 19843
 19844******************************************************************
 19845*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19846******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 364
* VP6311.cbl
 19847
 19848
 19849* EXEC CICS RESETBR
 19850*         DATASET    (FILE-ID-ERPNDB2)
 19851*         RIDFLD     (ERPNDB-ALT-KEY)
 19852*    END-EXEC.
 19853     MOVE 0
 19854       TO DFHEIV11
 19855*    MOVE '&4         G          &   #00016888' TO DFHEIV0
 19856     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19857     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19858     MOVE X'2020233030303136383838' TO DFHEIV0(25:11)
 19859     CALL 'kxdfhei1' USING DFHEIV0,
 19860           FILE-ID-ERPNDB2,
 19861           ERPNDB-ALT-KEY,
 19862           DFHEIV99,
 19863           DFHEIV11,
 19864           DFHEIV99
 19865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19866
 19867
 19868
 19869* EXEC CICS READNEXT
 19870*         DATASET    (FILE-ID-ERPNDB2)
 19871*         SET        (ADDRESS OF PENDING-BUSINESS)
 19872*         RIDFLD     (ERPNDB-ALT-KEY)
 19873*    END-EXEC.
 19874     MOVE 0
 19875       TO DFHEIV11
 19876*    MOVE '&.S                   )   #00016893' TO DFHEIV0
 19877     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19878     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19879     MOVE X'2020233030303136383933' TO DFHEIV0(25:11)
 19880     CALL 'kxdfhei1' USING DFHEIV0,
 19881           FILE-ID-ERPNDB2,
 19882           DFHEIV20,
 19883           DFHEIV99,
 19884           ERPNDB-ALT-KEY,
 19885           DFHEIV99,
 19886           DFHEIV11,
 19887           DFHEIV99,
 19888           DFHEIV99
 19889     SET ADDRESS OF PENDING-BUSINESS TO
 19890         DFHEIV20
 19891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19892
 19893
 19894
 19895* EXEC CICS READPREV
 19896*         DATASET    (FILE-ID-ERPNDB2)
 19897*         SET        (ADDRESS OF PENDING-BUSINESS)
 19898*         RIDFLD     (ERPNDB-ALT-KEY)
 19899*    END-EXEC.
 19900     MOVE 0
 19901       TO DFHEIV11
 19902*    MOVE '&0S                   )   #00016899' TO DFHEIV0
 19903     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19904     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 365
* VP6311.cbl
 19905     MOVE X'2020233030303136383939' TO DFHEIV0(25:11)
 19906     CALL 'kxdfhei1' USING DFHEIV0,
 19907           FILE-ID-ERPNDB2,
 19908           DFHEIV20,
 19909           DFHEIV99,
 19910           ERPNDB-ALT-KEY,
 19911           DFHEIV99,
 19912           DFHEIV11,
 19913           DFHEIV99,
 19914           DFHEIV99
 19915     SET ADDRESS OF PENDING-BUSINESS TO
 19916         DFHEIV20
 19917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19918
 19919
 19920 4580-READ-PREV-RECORD.
 19921
 19922* EXEC CICS READPREV
 19923*         DATASET    (FILE-ID-ERPNDB2)
 19924*         SET        (ADDRESS OF PENDING-BUSINESS)
 19925*         RIDFLD     (ERPNDB-ALT-KEY)
 19926*    END-EXEC.
 19927     MOVE 0
 19928       TO DFHEIV11
 19929*    MOVE '&0S                   )   #00016906' TO DFHEIV0
 19930     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19931     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19932     MOVE X'2020233030303136393036' TO DFHEIV0(25:11)
 19933     CALL 'kxdfhei1' USING DFHEIV0,
 19934           FILE-ID-ERPNDB2,
 19935           DFHEIV20,
 19936           DFHEIV99,
 19937           ERPNDB-ALT-KEY,
 19938           DFHEIV99,
 19939           DFHEIV11,
 19940           DFHEIV99,
 19941           DFHEIV99
 19942     SET ADDRESS OF PENDING-BUSINESS TO
 19943         DFHEIV20
 19944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19945
 19946
 19947     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19948
 19949     IF WS-BATCH-PREFIX = '#CL'
 19950        GO TO 4580-READ-PREV-RECORD.
 19951
 19952     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19953     GO TO 4505-READ-PREV-RECORD.
 19954
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 366
* VP6311.cbl
 19956
 19957******************************************************************
 19958*                                                                *
 19959*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 19960*                                                                *
 19961******************************************************************
 19962
 19963 4600-BROWSE-PRIMARY-BACKWARD.
 19964        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 19965
 19966     IF ERPNDB-BATCH-SEQ-NO = +9999
 19967        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19968
 19969        IF ERPNDB-BATCH-SEQ-NO = +0000
 19970           GO TO 4650-END-BATCH
 19971        ELSE
 19972           IF PI-MAP-NAME NOT = VP631D
 19973              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19974                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 19975              ELSE
 19976                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 19977                 IF DISPLAY-CHANGE-RECORDS
 19978                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 19979                 ELSE
 19980                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19981
 19982
 19983* EXEC CICS HANDLE CONDITION
 19984*         NOTFND    (4680-NOT-FOUND)
 19985*         ENDFILE   (4680-NOT-FOUND)
 19986*    END-EXEC.
 19987*    MOVE '"$I''                  ! O #00016947' TO DFHEIV0
 19988     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19989     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19990     MOVE X'4F20233030303136393437' TO DFHEIV0(25:11)
 19991     CALL 'kxdfhei1' USING DFHEIV0
 19992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19993
 19994
 19995 4605-READ-NEXT.
 19996     IF ERPNDB-BATCH-SEQ-NO = +0000
 19997        GO TO 4650-END-BATCH.
 19998
 19999     IF PI-DISPLAY-ORIGINAL-BATCH
 20000        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20001     ELSE
 20002        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20003
 20004
 20005* EXEC CICS READ
 20006*         DATASET   (FILE-ID)
 20007*         SET       (ADDRESS OF PENDING-BUSINESS)
 20008*         RIDFLD    (ERPNDB-KEY)
 20009*    END-EXEC.
 20010*    MOVE '&"S        E          (   #00016961' TO DFHEIV0
 20011     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20012     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20013     MOVE X'2020233030303136393631' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 367
* VP6311.cbl
 20014     CALL 'kxdfhei1' USING DFHEIV0,
 20015           FILE-ID,
 20016           DFHEIV20,
 20017           DFHEIV99,
 20018           ERPNDB-KEY,
 20019           DFHEIV99,
 20020           DFHEIV99,
 20021           DFHEIV99
 20022     SET ADDRESS OF PENDING-BUSINESS TO
 20023         DFHEIV20
 20024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20025
 20026
 20027     IF NOT  PI-PRIMARY-WITH-SELECT
 20028        GO TO 4607-CHECK-REC-TYPE.
 20029
 20030     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20031
 20032     IF  WS-BATCH-PREFIX = '#CL'
 20033         GO TO 4610-BUMP-SEQ.
 20034
 20035     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20036        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20037           GO TO 4610-BUMP-SEQ
 20038        ELSE
 20039           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20040              GO TO 4607-CHECK-REC-TYPE
 20041           ELSE
 20042              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20043                 GO TO 4607-CHECK-REC-TYPE
 20044              ELSE
 20045                 GO TO 4610-BUMP-SEQ.
 20046
 20047     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20048        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20049           GO TO 4610-BUMP-SEQ.
 20050
 20051 4607-CHECK-REC-TYPE.
 20052     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20053         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20054             NEXT SENTENCE
 20055         ELSE
 20056             GO TO 4610-BUMP-SEQ.
 20057
 20058     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20059         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20060             NEXT SENTENCE
 20061        ELSE
 20062             GO TO 4610-BUMP-SEQ.
 20063
 20064     IF NOT DISPLAY-CHANGE-RECORDS AND
 20065            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20066        GO TO 4610-BUMP-SEQ.
 20067
 20068     IF DISPLAY-HOLD-RECORDS AND
 20069        NOT PB-RECORD-ON-HOLD
 20070          GO TO 4610-BUMP-SEQ.
 20071
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 368
* VP6311.cbl
 20072     IF PB-ISSUE
 20073        IF DISPLAY-CHK-REQ-RECORDS
 20074           GO TO 4610-BUMP-SEQ.
 20075
 20076     IF PB-ISSUE
 20077        IF ISSUE-WITH-WARNING
 20078           IF PB-WARNING-ERRORS
 20079              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20080                  GO TO 4610-BUMP-SEQ
 20081              ELSE
 20082                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20083                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20084                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20085                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20086                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20087                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20088                 GO TO 7000-DISPLAY-ISSUES
 20089           ELSE
 20090              GO TO 4610-BUMP-SEQ.
 20091
 20092     IF PB-ISSUE
 20093        IF (ISSUES-IN-ERROR AND
 20094            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20095            ALL-ISSUES
 20096            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20097            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20098            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20099            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20100            MOVE PB-SV-STATE            TO PI-SV-STATE
 20101            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20102            GO TO 7000-DISPLAY-ISSUES
 20103        ELSE
 20104            GO TO 4610-BUMP-SEQ.
 20105
 20106     IF PB-CANCELLATION
 20107        IF DISPLAY-CHK-REQ-RECORDS
 20108           IF PB-C-REFUND-REQUESTED
 20109              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20110              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20111              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20112              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20113              MOVE PB-SV-STATE            TO PI-SV-STATE
 20114              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20115              GO TO 7100-DISPLAY-CANCELS
 20116           ELSE
 20117              GO TO 4610-BUMP-SEQ.
 20118
 20119     IF PB-CANCELLATION
 20120        IF CANCEL-WITH-WARNING
 20121           IF PB-WARNING-ERRORS
 20122              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20123                  GO TO 4610-BUMP-SEQ
 20124              ELSE
 20125                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20126                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20127                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20128                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20129                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 369
* VP6311.cbl
 20130                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20131                 GO TO 7100-DISPLAY-CANCELS
 20132           ELSE
 20133              GO TO 4610-BUMP-SEQ.
 20134
 20135     IF PB-CANCELLATION
 20136        IF (CANCEL-IN-ERROR  AND
 20137            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20138            ALL-CANCELS
 20139            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20140            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20141            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20142            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20143            MOVE PB-SV-STATE            TO PI-SV-STATE
 20144            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20145            GO TO 7100-DISPLAY-CANCELS.
 20146
 20147 4610-BUMP-SEQ.
 20148     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20149        GO TO 4650-END-BATCH.
 20150
 20151     IF DISPLAY-CHANGE-RECORDS
 20152        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20153           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20154        ELSE
 20155           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20156           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20157        ELSE
 20158           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20159           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20160
 20161        GO TO 4605-READ-NEXT.
 20162
 20163 4650-END-BATCH.
 20164     IF PI-MAP-NAME = VP631B
 20165        MOVE -1                  TO BMAINTL
 20166     ELSE
 20167        IF PI-MAP-NAME = VP631C
 20168           MOVE -1               TO CMAINTL
 20169        ELSE
 20170           MOVE -1               TO DPFENTRL.
 20171
 20172     MOVE ER-2252               TO EMI-ERROR.
 20173     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20174     GO TO 8200-SEND-DATAONLY.
 20175
 20176 4680-NOT-FOUND.
 20177     IF DISPLAY-CHANGE-RECORDS
 20178        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20179           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20180        ELSE
 20181           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20182           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20183     ELSE
 20184        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20185
 20186     GO TO 4605-READ-NEXT.
 20187
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 370
* VP6311.cbl
 20189
 20190******************************************************************
 20191*                                                                *
 20192*        B R O W S E   F I L E   B A C K W A R D S               *
 20193*                                                                *
 20194******************************************************************
 20195
 20196 4800-BROWSE-FILE-BACKWARD.
 20197
 20198* EXEC CICS HANDLE CONDITION
 20199*         NOTFND   (4860-NOT-FOUND)
 20200*         ENDFILE  (4850-END-RECORDS)
 20201*    END-EXEC.
 20202*    MOVE '"$I''                  ! P #00017137' TO DFHEIV0
 20203     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20204     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20205     MOVE X'5020233030303137313337' TO DFHEIV0(25:11)
 20206     CALL 'kxdfhei1' USING DFHEIV0
 20207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20208
 20209
 20210     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20211
 20212     IF PI-DISPLAY-ORIGINAL-BATCH
 20213        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20214     ELSE
 20215        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20216
 20217
 20218* EXEC CICS STARTBR
 20219*         DATASET   (FILE-ID)
 20220*         RIDFLD    (ERPNDB-KEY)
 20221*    END-EXEC.
 20222     MOVE 0
 20223       TO DFHEIV11
 20224*    MOVE '&,         G          &   #00017149' TO DFHEIV0
 20225     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20226     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20227     MOVE X'2020233030303137313439' TO DFHEIV0(25:11)
 20228     CALL 'kxdfhei1' USING DFHEIV0,
 20229           FILE-ID,
 20230           ERPNDB-KEY,
 20231           DFHEIV99,
 20232           DFHEIV11,
 20233           DFHEIV99
 20234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20235
 20236
 20237     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20238
 20239
 20240* EXEC CICS READPREV
 20241*         DATASET    (FILE-ID-ERPNDB)
 20242*         SET        (ADDRESS OF PENDING-BUSINESS)
 20243*         RIDFLD     (ERPNDB-KEY)
 20244*    END-EXEC.
 20245     MOVE 0
 20246       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 371
* VP6311.cbl
 20247*    MOVE '&0S                   )   #00017156' TO DFHEIV0
 20248     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20249     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20250     MOVE X'2020233030303137313536' TO DFHEIV0(25:11)
 20251     CALL 'kxdfhei1' USING DFHEIV0,
 20252           FILE-ID-ERPNDB,
 20253           DFHEIV20,
 20254           DFHEIV99,
 20255           ERPNDB-KEY,
 20256           DFHEIV99,
 20257           DFHEIV11,
 20258           DFHEIV99,
 20259           DFHEIV99
 20260     SET ADDRESS OF PENDING-BUSINESS TO
 20261         DFHEIV20
 20262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20263
 20264
 20265 4810-READ-PREV-RECORD.
 20266
 20267* EXEC CICS READPREV
 20268*         DATASET    (FILE-ID-ERPNDB)
 20269*         SET        (ADDRESS OF PENDING-BUSINESS)
 20270*         RIDFLD     (ERPNDB-KEY)
 20271*    END-EXEC.
 20272     MOVE 0
 20273       TO DFHEIV11
 20274*    MOVE '&0S                   )   #00017163' TO DFHEIV0
 20275     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20276     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20277     MOVE X'2020233030303137313633' TO DFHEIV0(25:11)
 20278     CALL 'kxdfhei1' USING DFHEIV0,
 20279           FILE-ID-ERPNDB,
 20280           DFHEIV20,
 20281           DFHEIV99,
 20282           ERPNDB-KEY,
 20283           DFHEIV99,
 20284           DFHEIV11,
 20285           DFHEIV99,
 20286           DFHEIV99
 20287     SET ADDRESS OF PENDING-BUSINESS TO
 20288         DFHEIV20
 20289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20290
 20291
 20292     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20293        GO TO 4850-END-RECORDS.
 20294
 20295     IF PB-BATCH-TRAILER
 20296        GO TO 4810-READ-PREV-RECORD.
 20297
 20298     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20299
 20300     IF  WS-BATCH-PREFIX = '#CL'
 20301         GO TO 4810-READ-PREV-RECORD.
 20302
 20303     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20304        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 372
* VP6311.cbl
 20305           GO TO 4810-READ-PREV-RECORD
 20306        ELSE
 20307           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20308              GO TO 4820-CHECK-REC-TYPE
 20309           ELSE
 20310              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20311                 GO TO 4820-CHECK-REC-TYPE
 20312              ELSE
 20313                 GO TO 4810-READ-PREV-RECORD.
 20314
 20315     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20316        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20317           GO TO 4810-READ-PREV-RECORD.
 20318
 20319 4820-CHECK-REC-TYPE.
 20320     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20321         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20322             NEXT SENTENCE
 20323         ELSE
 20324             GO TO 4810-READ-PREV-RECORD.
 20325
 20326     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20327         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20328             NEXT SENTENCE
 20329        ELSE
 20330             GO TO 4810-READ-PREV-RECORD.
 20331
 20332     IF NOT DISPLAY-CHANGE-RECORDS AND
 20333            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20334        GO TO 4810-READ-PREV-RECORD.
 20335
 20336     IF DISPLAY-HOLD-RECORDS AND
 20337        NOT PB-RECORD-ON-HOLD
 20338          GO TO 4810-READ-PREV-RECORD.
 20339
 20340     IF PB-ISSUE
 20341        IF DISPLAY-CHK-REQ-RECORDS
 20342           GO TO 4810-READ-PREV-RECORD.
 20343
 20344     IF PB-ISSUE
 20345        IF ISSUE-WITH-WARNING
 20346           IF PB-WARNING-ERRORS
 20347              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20348                  GO TO 4810-READ-PREV-RECORD
 20349              ELSE
 20350                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20351                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20352                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20353                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20354                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20355                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20356                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20357                 GO TO 7000-DISPLAY-ISSUES
 20358           ELSE
 20359              GO TO 4810-READ-PREV-RECORD.
 20360
 20361     IF PB-ISSUE
 20362        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 373
* VP6311.cbl
 20363            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20364            ALL-ISSUES
 20365            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20366            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20367            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20368            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20369            MOVE PB-SV-STATE            TO PI-SV-STATE
 20370            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20371            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20372            GO TO 7000-DISPLAY-ISSUES
 20373        ELSE
 20374            GO TO 4810-READ-PREV-RECORD.
 20375
 20376     IF PB-CANCELLATION
 20377        IF DISPLAY-CHK-REQ-RECORDS
 20378           IF PB-C-REFUND-REQUESTED
 20379              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20380              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20381              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20382              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20383              MOVE PB-SV-STATE            TO PI-SV-STATE
 20384              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20385              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20386              GO TO 7100-DISPLAY-CANCELS
 20387           ELSE
 20388              GO TO 4810-READ-PREV-RECORD.
 20389
 20390     IF PB-CANCELLATION
 20391        IF CANCEL-WITH-WARNING
 20392           IF PB-WARNING-ERRORS
 20393              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20394                  GO TO 4810-READ-PREV-RECORD
 20395              ELSE
 20396                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20397                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20398                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20399                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20400                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20401                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20402                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20403                 GO TO 7100-DISPLAY-CANCELS
 20404           ELSE
 20405              GO TO 4810-READ-PREV-RECORD.
 20406
 20407     IF PB-CANCELLATION
 20408        IF (CANCEL-IN-ERROR  AND
 20409            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20410            ALL-CANCELS
 20411            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20412            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20413            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20414            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20415            MOVE PB-SV-STATE            TO PI-SV-STATE
 20416            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20417            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20418            GO TO 7100-DISPLAY-CANCELS.
 20419
 20420     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 374
* VP6311.cbl
 20421
 20422 4850-END-RECORDS.
 20423     MOVE ER-2252                TO EMI-ERROR.
 20424     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20425
 20426     IF PI-MAP-NAME = VP631B
 20427        MOVE -1                  TO BPFENTRL
 20428     ELSE
 20429        MOVE -1                  TO CPFENTRL.
 20430
 20431     GO TO 8200-SEND-DATAONLY.
 20432
 20433 4860-NOT-FOUND.
 20434
 20435******************************************************************
 20436*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20437******************************************************************
 20438
 20439
 20440* EXEC CICS RESETBR
 20441*         DATASET    (FILE-ID-ERPNDB)
 20442*         RIDFLD     (ERPNDB-KEY)
 20443*     END-EXEC.
 20444     MOVE 0
 20445       TO DFHEIV11
 20446*    MOVE '&4         G          &   #00017316' TO DFHEIV0
 20447     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20448     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20449     MOVE X'2020233030303137333136' TO DFHEIV0(25:11)
 20450     CALL 'kxdfhei1' USING DFHEIV0,
 20451           FILE-ID-ERPNDB,
 20452           ERPNDB-KEY,
 20453           DFHEIV99,
 20454           DFHEIV11,
 20455           DFHEIV99
 20456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20457
 20458
 20459
 20460* EXEC CICS READNEXT
 20461*         DATASET    (FILE-ID-ERPNDB)
 20462*         SET        (ADDRESS OF PENDING-BUSINESS)
 20463*         RIDFLD     (ERPNDB-KEY)
 20464*    END-EXEC.
 20465     MOVE 0
 20466       TO DFHEIV11
 20467*    MOVE '&.S                   )   #00017321' TO DFHEIV0
 20468     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20469     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20470     MOVE X'2020233030303137333231' TO DFHEIV0(25:11)
 20471     CALL 'kxdfhei1' USING DFHEIV0,
 20472           FILE-ID-ERPNDB,
 20473           DFHEIV20,
 20474           DFHEIV99,
 20475           ERPNDB-KEY,
 20476           DFHEIV99,
 20477           DFHEIV11,
 20478           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 375
* VP6311.cbl
 20479           DFHEIV99
 20480     SET ADDRESS OF PENDING-BUSINESS TO
 20481         DFHEIV20
 20482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20483
 20484
 20485
 20486* EXEC CICS READPREV
 20487*         DATASET    (FILE-ID-ERPNDB)
 20488*         SET        (ADDRESS OF PENDING-BUSINESS)
 20489*         RIDFLD     (ERPNDB-KEY)
 20490*    END-EXEC.
 20491     MOVE 0
 20492       TO DFHEIV11
 20493*    MOVE '&0S                   )   #00017327' TO DFHEIV0
 20494     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20495     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20496     MOVE X'2020233030303137333237' TO DFHEIV0(25:11)
 20497     CALL 'kxdfhei1' USING DFHEIV0,
 20498           FILE-ID-ERPNDB,
 20499           DFHEIV20,
 20500           DFHEIV99,
 20501           ERPNDB-KEY,
 20502           DFHEIV99,
 20503           DFHEIV11,
 20504           DFHEIV99,
 20505           DFHEIV99
 20506     SET ADDRESS OF PENDING-BUSINESS TO
 20507         DFHEIV20
 20508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20509
 20510
 20511     GO TO 4810-READ-PREV-RECORD.
 20512
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 376
* VP6311.cbl
 20514
 20515******************************************************************
 20516*                                                                *
 20517*           B R O W S E   C S R   B A C K W A R D                *
 20518*                                                                *
 20519******************************************************************
 20520
 20521 4900-BROWSE-CSR-BACKWARD.
 20522
 20523     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20524
 20525
 20526* EXEC CICS HANDLE CONDITION
 20527*         NOTFND   (4970-NOT-FOUND)
 20528*         ENDFILE  (4950-END-RECORDS)
 20529*    END-EXEC
 20530*    MOVE '"$I''                  ! Q #00017347' TO DFHEIV0
 20531     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20532     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20533     MOVE X'5120233030303137333437' TO DFHEIV0(25:11)
 20534     CALL 'kxdfhei1' USING DFHEIV0
 20535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20536
 20537
 20538* EXEC CICS STARTBR
 20539*         DATASET   (FILE-ID-ERPNDB4)
 20540*         RIDFLD    (ERPNDB-CSR-KEY)
 20541*    END-EXEC.
 20542     MOVE 0
 20543       TO DFHEIV11
 20544*    MOVE '&,         G          &   #00017352' TO DFHEIV0
 20545     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20546     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20547     MOVE X'2020233030303137333532' TO DFHEIV0(25:11)
 20548     CALL 'kxdfhei1' USING DFHEIV0,
 20549           FILE-ID-ERPNDB4,
 20550           ERPNDB-CSR-KEY,
 20551           DFHEIV99,
 20552           DFHEIV11,
 20553           DFHEIV99
 20554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20555
 20556
 20557     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20558                                    WS-FIRST-TIME-SW.
 20559
 20560 4905-READ-PREV-RECORD.
 20561
 20562* EXEC CICS READPREV
 20563*         DATASET    (FILE-ID-ERPNDB4)
 20564*         SET        (ADDRESS OF PENDING-BUSINESS)
 20565*         RIDFLD     (ERPNDB-CSR-KEY)
 20566*    END-EXEC.
 20567     MOVE 0
 20568       TO DFHEIV11
 20569*    MOVE '&0S                   )   #00017361' TO DFHEIV0
 20570     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20571     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 377
* VP6311.cbl
 20572     MOVE X'2020233030303137333631' TO DFHEIV0(25:11)
 20573     CALL 'kxdfhei1' USING DFHEIV0,
 20574           FILE-ID-ERPNDB4,
 20575           DFHEIV20,
 20576           DFHEIV99,
 20577           ERPNDB-CSR-KEY,
 20578           DFHEIV99,
 20579           DFHEIV11,
 20580           DFHEIV99,
 20581           DFHEIV99
 20582     SET ADDRESS OF PENDING-BUSINESS TO
 20583         DFHEIV20
 20584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20585
 20586
 20587     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20588
 20589     IF WS-BATCH-PREFIX = '#CL'
 20590         GO TO 4905-READ-PREV-RECORD.
 20591
 20592     IF FIRST-TIME
 20593         MOVE SPACE               TO WS-FIRST-TIME-SW
 20594         GO TO 4905-READ-PREV-RECORD.
 20595
 20596     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20597        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20598        GO TO 4950-END-RECORDS.
 20599
 20600     IF PB-BATCH-TRAILER
 20601        GO TO 4905-READ-PREV-RECORD.
 20602
 20603     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20604
 20605     IF  WS-BATCH-PREFIX = '#CL'
 20606         GO TO 4905-READ-PREV-RECORD.
 20607
 20608     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20609        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20610           GO TO 4905-READ-PREV-RECORD
 20611        ELSE
 20612           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20613              GO TO 4910-CHECK-REC-TYPE
 20614           ELSE
 20615              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20616                 GO TO 4910-CHECK-REC-TYPE
 20617              ELSE
 20618                 GO TO 4905-READ-PREV-RECORD.
 20619
 20620     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20621        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20622           GO TO 4905-READ-PREV-RECORD.
 20623
 20624 4910-CHECK-REC-TYPE.
 20625     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20626         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20627             NEXT SENTENCE
 20628         ELSE
 20629             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 378
* VP6311.cbl
 20630
 20631     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20632         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20633             NEXT SENTENCE
 20634        ELSE
 20635             GO TO 4905-READ-PREV-RECORD.
 20636
 20637     IF NOT DISPLAY-CHANGE-RECORDS AND
 20638            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20639        GO TO 4905-READ-PREV-RECORD.
 20640
 20641     IF DISPLAY-HOLD-RECORDS AND
 20642        NOT PB-RECORD-ON-HOLD
 20643          GO TO 4905-READ-PREV-RECORD.
 20644
 20645     IF PB-ISSUE
 20646        IF DISPLAY-CHK-REQ-RECORDS
 20647           GO TO 4905-READ-PREV-RECORD.
 20648
 20649     IF PB-ISSUE
 20650        IF ISSUE-WITH-WARNING
 20651           IF PB-WARNING-ERRORS
 20652              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20653                  GO TO 4505-READ-PREV-RECORD
 20654              ELSE
 20655                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20656                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20657                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20658                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20659                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20660                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20661                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20662                 GO TO 7000-DISPLAY-ISSUES
 20663           ELSE
 20664              GO TO 4905-READ-PREV-RECORD.
 20665
 20666     IF PB-ISSUE
 20667        IF (ISSUES-IN-ERROR AND
 20668            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20669            ALL-ISSUES
 20670            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20671            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20672            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20673            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20674            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20675            MOVE PB-SV-STATE            TO PI-SV-STATE
 20676            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20677            GO TO 7000-DISPLAY-ISSUES
 20678        ELSE
 20679            GO TO 4905-READ-PREV-RECORD.
 20680
 20681     IF PB-CANCELLATION
 20682        IF DISPLAY-CHK-REQ-RECORDS
 20683           IF PB-C-REFUND-REQUESTED
 20684              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20685              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20686              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20687              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 379
* VP6311.cbl
 20688              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20689              MOVE PB-SV-STATE            TO PI-SV-STATE
 20690              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20691              GO TO 7100-DISPLAY-CANCELS
 20692           ELSE
 20693              GO TO 4905-READ-PREV-RECORD.
 20694
 20695     IF PB-CANCELLATION
 20696        IF CANCEL-WITH-WARNING
 20697           IF PB-WARNING-ERRORS
 20698              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20699                  GO TO 4505-READ-PREV-RECORD
 20700              ELSE
 20701                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20702                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20703                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20704                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20705                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20706                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20707                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20708                 GO TO 7100-DISPLAY-CANCELS
 20709           ELSE
 20710              GO TO 4905-READ-PREV-RECORD.
 20711
 20712     IF PB-CANCELLATION
 20713        IF (CANCEL-IN-ERROR  AND
 20714            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20715            ALL-CANCELS
 20716            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20717            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20718            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20719            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20720            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20721            MOVE PB-SV-STATE            TO PI-SV-STATE
 20722            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20723            GO TO 7100-DISPLAY-CANCELS.
 20724
 20725     GO TO 4905-READ-PREV-RECORD.
 20726
 20727 4950-END-RECORDS.
 20728     IF PI-MAP-NAME = VP631B
 20729        MOVE -1                  TO BMAINTL
 20730     ELSE
 20731        IF PI-MAP-NAME = VP631C
 20732           MOVE -1               TO CMAINTL
 20733        ELSE
 20734           MOVE -1               TO DPFENTRL.
 20735
 20736     MOVE ER-2255               TO EMI-ERROR.
 20737     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20738     GO TO 8200-SEND-DATAONLY.
 20739
 20740 4970-NOT-FOUND.
 20741
 20742******************************************************************
 20743*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20744******************************************************************
 20745
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 380
* VP6311.cbl
 20746
 20747* EXEC CICS RESETBR
 20748*         DATASET    (FILE-ID-ERPNDB4)
 20749*         RIDFLD     (ERPNDB-CSR-KEY)
 20750*    END-EXEC.
 20751     MOVE 0
 20752       TO DFHEIV11
 20753*    MOVE '&4         G          &   #00017526' TO DFHEIV0
 20754     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20755     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20756     MOVE X'2020233030303137353236' TO DFHEIV0(25:11)
 20757     CALL 'kxdfhei1' USING DFHEIV0,
 20758           FILE-ID-ERPNDB4,
 20759           ERPNDB-CSR-KEY,
 20760           DFHEIV99,
 20761           DFHEIV11,
 20762           DFHEIV99
 20763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20764
 20765
 20766
 20767* EXEC CICS READNEXT
 20768*         DATASET    (FILE-ID-ERPNDB4)
 20769*         SET        (ADDRESS OF PENDING-BUSINESS)
 20770*         RIDFLD     (ERPNDB-CSR-KEY)
 20771*    END-EXEC.
 20772     MOVE 0
 20773       TO DFHEIV11
 20774*    MOVE '&.S                   )   #00017531' TO DFHEIV0
 20775     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20776     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20777     MOVE X'2020233030303137353331' TO DFHEIV0(25:11)
 20778     CALL 'kxdfhei1' USING DFHEIV0,
 20779           FILE-ID-ERPNDB4,
 20780           DFHEIV20,
 20781           DFHEIV99,
 20782           ERPNDB-CSR-KEY,
 20783           DFHEIV99,
 20784           DFHEIV11,
 20785           DFHEIV99,
 20786           DFHEIV99
 20787     SET ADDRESS OF PENDING-BUSINESS TO
 20788         DFHEIV20
 20789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20790
 20791
 20792
 20793* EXEC CICS READPREV
 20794*         DATASET    (FILE-ID-ERPNDB4)
 20795*         SET        (ADDRESS OF PENDING-BUSINESS)
 20796*         RIDFLD     (ERPNDB-CSR-KEY)
 20797*    END-EXEC.
 20798     MOVE 0
 20799       TO DFHEIV11
 20800*    MOVE '&0S                   )   #00017537' TO DFHEIV0
 20801     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20802     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20803     MOVE X'2020233030303137353337' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 381
* VP6311.cbl
 20804     CALL 'kxdfhei1' USING DFHEIV0,
 20805           FILE-ID-ERPNDB4,
 20806           DFHEIV20,
 20807           DFHEIV99,
 20808           ERPNDB-CSR-KEY,
 20809           DFHEIV99,
 20810           DFHEIV11,
 20811           DFHEIV99,
 20812           DFHEIV99
 20813     SET ADDRESS OF PENDING-BUSINESS TO
 20814         DFHEIV20
 20815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20816
 20817
 20818 4980-READ-PREV-RECORD.
 20819
 20820* EXEC CICS READPREV
 20821*         DATASET    (FILE-ID-ERPNDB4)
 20822*         SET        (ADDRESS OF PENDING-BUSINESS)
 20823*         RIDFLD     (ERPNDB-CSR-KEY)
 20824*    END-EXEC.
 20825     MOVE 0
 20826       TO DFHEIV11
 20827*    MOVE '&0S                   )   #00017544' TO DFHEIV0
 20828     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20829     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20830     MOVE X'2020233030303137353434' TO DFHEIV0(25:11)
 20831     CALL 'kxdfhei1' USING DFHEIV0,
 20832           FILE-ID-ERPNDB4,
 20833           DFHEIV20,
 20834           DFHEIV99,
 20835           ERPNDB-CSR-KEY,
 20836           DFHEIV99,
 20837           DFHEIV11,
 20838           DFHEIV99,
 20839           DFHEIV99
 20840     SET ADDRESS OF PENDING-BUSINESS TO
 20841         DFHEIV20
 20842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20843
 20844
 20845     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20846
 20847     IF WS-BATCH-PREFIX = '#CL'
 20848        GO TO 4980-READ-PREV-RECORD.
 20849
 20850     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20851     GO TO 4905-READ-PREV-RECORD.
 20852
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 382
* VP6311.cbl
 20854
 20855
 20856******************************************************************
 20857*                                                                *
 20858*        B R O W S E   B A T C H   H E A D E R S                 *
 20859*                                                                *
 20860******************************************************************
 20861
 20862 5000-BROWSE-BATCH-HEADERS.
 20863
 20864     IF EIBTRNID NOT = TRANS-EXB1
 20865        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20866        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20867        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20868        GO TO 5010-READ-NEXT-RECORD.
 20869
 20870     IF EIBAID = DFHPF4
 20871        MOVE '0'                TO PI-EDIT-SW
 20872        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20873        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20874        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20875        GO TO 5010-READ-NEXT-RECORD.
 20876
 20877     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20878     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20879     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20880
 20881
 20882* EXEC CICS HANDLE CONDITION
 20883*         ENDFILE  (5050-NOT-FOUND)
 20884*    END-EXEC.
 20885*    MOVE '"$''                   ! R #00017586' TO DFHEIV0
 20886     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20887     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20888     MOVE X'5220233030303137353836' TO DFHEIV0(25:11)
 20889     CALL 'kxdfhei1' USING DFHEIV0
 20890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20891
 20892
 20893 5010-READ-NEXT-RECORD.
 20894
 20895* EXEC CICS HANDLE CONDITION
 20896*         NOTFND    (5050-NOT-FOUND)
 20897*    END-EXEC.
 20898*    MOVE '"$I                   ! S #00017591' TO DFHEIV0
 20899     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20900     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20901     MOVE X'5320233030303137353931' TO DFHEIV0(25:11)
 20902     CALL 'kxdfhei1' USING DFHEIV0
 20903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20904
 20905
 20906
 20907* EXEC CICS READ
 20908*         DATASET   (FILE-ID-ERPNDB)
 20909*         SET       (ADDRESS OF PENDING-BUSINESS)
 20910*         RIDFLD    (ERPNDB-KEY)
 20911*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 383
* VP6311.cbl
 20912*    END-EXEC.
 20913*    MOVE '&"S        G          (   #00017595' TO DFHEIV0
 20914     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20915     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20916     MOVE X'2020233030303137353935' TO DFHEIV0(25:11)
 20917     CALL 'kxdfhei1' USING DFHEIV0,
 20918           FILE-ID-ERPNDB,
 20919           DFHEIV20,
 20920           DFHEIV99,
 20921           ERPNDB-KEY,
 20922           DFHEIV99,
 20923           DFHEIV99,
 20924           DFHEIV99
 20925     SET ADDRESS OF PENDING-BUSINESS TO
 20926         DFHEIV20
 20927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20928
 20929
 20930     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 20931         GO TO 5050-NOT-FOUND.
 20932
 20933     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20934
 20935     IF WS-BATCH-PREFIX = '#CL'
 20936         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20937         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 20938         GO TO 5010-READ-NEXT-RECORD.
 20939
 20940     IF NOT PB-BATCH-TRAILER
 20941         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20942         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 20943         GO TO 5010-READ-NEXT-RECORD.
 20944
 20945     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20946         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20947             NEXT SENTENCE
 20948         ELSE
 20949             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 20950             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20951             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20952             GO TO 5010-READ-NEXT-RECORD.
 20953
 20954     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20955         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20956             NEXT SENTENCE
 20957        ELSE
 20958             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20959             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20960             GO TO 5010-READ-NEXT-RECORD.
 20961
 20962     IF EIBAID = DFHPF4
 20963        MOVE '0'                TO PI-EDIT-SW
 20964        GO TO 7200-DISPLAY-BATCHES.
 20965
 20966     IF PI-CSR-BROWSE
 20967        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20968           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20969           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 384
* VP6311.cbl
 20970           GO TO 5010-READ-NEXT-RECORD.
 20971
 20972     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20973       IF PI-PB-CARRIER    = SPACES AND
 20974          PI-PB-GROUPING   = SPACES AND
 20975          PI-PB-STATE      = SPACES AND
 20976          PI-PB-ACCOUNT    = SPACES
 20977            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20978            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20979            GO TO 7200-DISPLAY-BATCHES
 20980         ELSE
 20981           IF PI-PB-CARRIER    = PB-CARRIER  AND
 20982              PI-PB-GROUPING   = PB-GROUPING AND
 20983              PI-PB-STATE      = PB-STATE    AND
 20984              PI-PB-ACCOUNT    = PB-ACCOUNT
 20985              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 20986              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20987              GO TO 7200-DISPLAY-BATCHES.
 20988
 20989     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 20990     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 20991
 20992
 20993* EXEC CICS HANDLE CONDITION
 20994*         NOTFND    (5050-NOT-FOUND)
 20995*    END-EXEC.
 20996*    MOVE '"$I                   ! T #00017664' TO DFHEIV0
 20997     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20998     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20999     MOVE X'5420233030303137363634' TO DFHEIV0(25:11)
 21000     CALL 'kxdfhei1' USING DFHEIV0
 21001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21002
 21003
 21004
 21005* EXEC CICS READ
 21006*         DATASET   (FILE-ID-ERPNDB)
 21007*         SET       (ADDRESS OF PENDING-BUSINESS)
 21008*         RIDFLD    (ERPNDB-KEY)
 21009*         GTEQ
 21010*    END-EXEC.
 21011*    MOVE '&"S        G          (   #00017668' TO DFHEIV0
 21012     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21013     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21014     MOVE X'2020233030303137363638' TO DFHEIV0(25:11)
 21015     CALL 'kxdfhei1' USING DFHEIV0,
 21016           FILE-ID-ERPNDB,
 21017           DFHEIV20,
 21018           DFHEIV99,
 21019           ERPNDB-KEY,
 21020           DFHEIV99,
 21021           DFHEIV99,
 21022           DFHEIV99
 21023     SET ADDRESS OF PENDING-BUSINESS TO
 21024         DFHEIV20
 21025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21026
 21027
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 385
* VP6311.cbl
 21028     GO TO 5010-READ-NEXT-RECORD.
 21029
 21030 5050-NOT-FOUND.
 21031
 21032******************************************************************
 21033*                                                                *
 21034*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21035*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING     *
 21036*         PROGRAM.                                               *
 21037*                                                                *
 21038******************************************************************
 21039
 21040     IF EIBTRNID NOT = TRANS-EXB1
 21041        IF PENDING-BUS-RECS-FOUND
 21042            NEXT SENTENCE
 21043          ELSE
 21044            MOVE '9'            TO PI-BROWSE-SW
 21045            GO TO 9400-CLEAR.
 21046
 21047     MOVE ER-2256                TO EMI-ERROR.
 21048     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21049
 21050     IF PI-MAP-NAME = SPACES
 21051        MOVE VP631D              TO PI-MAP-NAME
 21052        MOVE -1                  TO DPFENTRL
 21053        GO TO 8100-SEND-INITIAL-MAP.
 21054
 21055     IF PI-MAP-NAME = VP631B
 21056        MOVE -1                  TO BMAINTL
 21057     ELSE
 21058        IF PI-MAP-NAME = VP631C
 21059           MOVE -1               TO CMAINTL
 21060        ELSE
 21061           MOVE -1               TO DPFENTRL
 21062           GO TO 8200-SEND-DATAONLY.
 21063
 21064     GO TO 8100-SEND-INITIAL-MAP.
 21065
 21066     .
 21067 5100-PROCESS-POL-RESC.
 21068     MOVE ZEROS                  TO CG-LF-BENCD
 21069                                    CG-AH-BENCD
 21070                                    CG-LF-CAN-AMT
 21071                                    CG-AH-CAN-AMT
 21072     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21073                                    CG-AH-CAN-DT
 21074     MOVE SPACES                 TO CG-BATCH-NO
 21075     MOVE '4'                    TO CG-OPTION-CODE
 21076     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21077     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21078     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21079     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21080     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21081     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21082     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21083     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21084     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21085     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 386
* VP6311.cbl
 21086     MOVE PI-PREV-ALT-KEY (1:33)
 21087                                 TO CG-CERT-KEY
 21088     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21089     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21090                                    CG-AH-CAN-AMT
 21091     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21092                                    CG-AH-CAN-DT
 21093     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21094     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21095      display 'about to cancel ' cg-cert-key
 21096
 21097* EXEC CICS LINK
 21098*        PROGRAM  ('ELCANC')
 21099*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21100*    END-EXEC
 21101     MOVE LENGTH OF
 21102      CANCEL-GEN-PASS-AREA
 21103       TO DFHEIV11
 21104     MOVE 'ELCANC' TO DFHEIV1
 21105*    MOVE '."C                   (   #00017743' TO DFHEIV0
 21106     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21107     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21108     MOVE X'2020233030303137373433' TO DFHEIV0(25:11)
 21109     CALL 'kxdfhei1' USING DFHEIV0,
 21110           DFHEIV1,
 21111           CANCEL-GEN-PASS-AREA,
 21112           DFHEIV11,
 21113           DFHEIV99,
 21114           DFHEIV99,
 21115           DFHEIV99,
 21116           DFHEIV99
 21117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21118     IF CG-SUCCESS
 21119        CONTINUE
 21120     ELSE
 21121        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21122        MOVE '3'                 TO EMI-SWITCH1
 21123        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21124        EVALUATE TRUE
 21125           WHEN CG-DATE-ERROR
 21126             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21127           WHEN CG-CERT-NOT-FOUND
 21128             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21129           WHEN CG-AMOUNT-ERROR
 21130             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21131           WHEN CG-OPTION-ERROR
 21132             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21133           WHEN CG-PREV-CAN
 21134             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21135           WHEN CG-INVALID-DATA
 21136             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21137           WHEN CG-NO-ACCT-MSTR
 21138             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21139           WHEN CG-SFX-A-EXIST
 21140             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21141           WHEN CG-MISC-ERROR
 21142             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21143           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 387
* VP6311.cbl
 21144             MOVE ' ERROR - ELCANC - RETURN '
 21145                                 TO EMI-ERROR-TEXT (1) (12:25)
 21146        END-EVALUATE
 21147        GO TO 8200-SEND-DATAONLY
 21148     END-IF
 21149     .
 21150 5100-EXIT.
 21151     EXIT.
 21152
 21153******************************************************************
 21154*                                                                *
 21155*        B R O W S E   B A T C H   B A C K W A R D S             *
 21156*                                                                *
 21157******************************************************************
 21158
 21159 5500-BROWSE-BATCH-BACKWARD.
 21160
 21161* EXEC CICS HANDLE CONDITION
 21162*         NOTFND   (5550-END-RECORDS)
 21163*         ENDFILE  (5550-END-RECORDS)
 21164*    END-EXEC.
 21165*    MOVE '"$I''                  ! U #00017789' TO DFHEIV0
 21166     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21167     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21168     MOVE X'5520233030303137373839' TO DFHEIV0(25:11)
 21169     CALL 'kxdfhei1' USING DFHEIV0
 21170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21171
 21172
 21173 5505-START-BROWSE.
 21174     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21175     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21176     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21177
 21178
 21179* EXEC CICS STARTBR
 21180*         DATASET   (FILE-ID-ERPNDB)
 21181*         RIDFLD    (ERPNDB-ALT-KEY)
 21182*    END-EXEC.
 21183     MOVE 0
 21184       TO DFHEIV11
 21185*    MOVE '&,         G          &   #00017799' TO DFHEIV0
 21186     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21187     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21188     MOVE X'2020233030303137373939' TO DFHEIV0(25:11)
 21189     CALL 'kxdfhei1' USING DFHEIV0,
 21190           FILE-ID-ERPNDB,
 21191           ERPNDB-ALT-KEY,
 21192           DFHEIV99,
 21193           DFHEIV11,
 21194           DFHEIV99
 21195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21196
 21197
 21198     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21199
 21200
 21201* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 388
* VP6311.cbl
 21202*         DATASET    (FILE-ID-ERPNDB)
 21203*         SET        (ADDRESS OF PENDING-BUSINESS)
 21204*         RIDFLD     (ERPNDB-KEY)
 21205*    END-EXEC.
 21206     MOVE 0
 21207       TO DFHEIV11
 21208*    MOVE '&.S                   )   #00017806' TO DFHEIV0
 21209     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21210     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21211     MOVE X'2020233030303137383036' TO DFHEIV0(25:11)
 21212     CALL 'kxdfhei1' USING DFHEIV0,
 21213           FILE-ID-ERPNDB,
 21214           DFHEIV20,
 21215           DFHEIV99,
 21216           ERPNDB-KEY,
 21217           DFHEIV99,
 21218           DFHEIV11,
 21219           DFHEIV99,
 21220           DFHEIV99
 21221     SET ADDRESS OF PENDING-BUSINESS TO
 21222         DFHEIV20
 21223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21224
 21225
 21226
 21227* EXEC CICS READPREV
 21228*         DATASET    (FILE-ID-ERPNDB)
 21229*         SET        (ADDRESS OF PENDING-BUSINESS)
 21230*         RIDFLD     (ERPNDB-KEY)
 21231*    END-EXEC.
 21232     MOVE 0
 21233       TO DFHEIV11
 21234*    MOVE '&0S                   )   #00017812' TO DFHEIV0
 21235     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21236     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21237     MOVE X'2020233030303137383132' TO DFHEIV0(25:11)
 21238     CALL 'kxdfhei1' USING DFHEIV0,
 21239           FILE-ID-ERPNDB,
 21240           DFHEIV20,
 21241           DFHEIV99,
 21242           ERPNDB-KEY,
 21243           DFHEIV99,
 21244           DFHEIV11,
 21245           DFHEIV99,
 21246           DFHEIV99
 21247     SET ADDRESS OF PENDING-BUSINESS TO
 21248         DFHEIV20
 21249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21250
 21251
 21252
 21253* EXEC CICS READPREV
 21254*         DATASET    (FILE-ID-ERPNDB)
 21255*         SET        (ADDRESS OF PENDING-BUSINESS)
 21256*         RIDFLD     (ERPNDB-KEY)
 21257*    END-EXEC.
 21258     MOVE 0
 21259       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 389
* VP6311.cbl
 21260*    MOVE '&0S                   )   #00017818' TO DFHEIV0
 21261     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21262     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21263     MOVE X'2020233030303137383138' TO DFHEIV0(25:11)
 21264     CALL 'kxdfhei1' USING DFHEIV0,
 21265           FILE-ID-ERPNDB,
 21266           DFHEIV20,
 21267           DFHEIV99,
 21268           ERPNDB-KEY,
 21269           DFHEIV99,
 21270           DFHEIV11,
 21271           DFHEIV99,
 21272           DFHEIV99
 21273     SET ADDRESS OF PENDING-BUSINESS TO
 21274         DFHEIV20
 21275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21276
 21277
 21278     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21279        GO TO 5550-END-RECORDS.
 21280
 21281     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21282
 21283     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21284
 21285     IF  WS-BATCH-PREFIX = '#CL'
 21286             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21287
 21288* EXEC CICS ENDBR
 21289*                 DATASET  (FILE-ID-ERPNDB)
 21290*            END-EXEC
 21291     MOVE 0
 21292       TO DFHEIV11
 21293*    MOVE '&2                    $   #00017833' TO DFHEIV0
 21294     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21295     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21296     MOVE X'2020233030303137383333' TO DFHEIV0(25:11)
 21297     CALL 'kxdfhei1' USING DFHEIV0,
 21298           FILE-ID-ERPNDB,
 21299           DFHEIV11,
 21300           DFHEIV99
 21301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21302         GO TO 5505-START-BROWSE.
 21303
 21304     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21305         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21306             NEXT SENTENCE
 21307         ELSE
 21308             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21309
 21310* EXEC CICS ENDBR
 21311*                 DATASET  (FILE-ID-ERPNDB)
 21312*            END-EXEC
 21313     MOVE 0
 21314       TO DFHEIV11
 21315*    MOVE '&2                    $   #00017843' TO DFHEIV0
 21316     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21317     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 390
* VP6311.cbl
 21318     MOVE X'2020233030303137383433' TO DFHEIV0(25:11)
 21319     CALL 'kxdfhei1' USING DFHEIV0,
 21320           FILE-ID-ERPNDB,
 21321           DFHEIV11,
 21322           DFHEIV99
 21323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21324             GO TO 5505-START-BROWSE.
 21325
 21326
 21327     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21328         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21329             NEXT SENTENCE
 21330        ELSE
 21331             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21332
 21333* EXEC CICS ENDBR
 21334*                 DATASET  (FILE-ID-ERPNDB)
 21335*            END-EXEC
 21336     MOVE 0
 21337       TO DFHEIV11
 21338*    MOVE '&2                    $   #00017854' TO DFHEIV0
 21339     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21340     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21341     MOVE X'2020233030303137383534' TO DFHEIV0(25:11)
 21342     CALL 'kxdfhei1' USING DFHEIV0,
 21343           FILE-ID-ERPNDB,
 21344           DFHEIV11,
 21345           DFHEIV99
 21346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21347             GO TO 5505-START-BROWSE.
 21348
 21349     IF NOT PB-BATCH-TRAILER
 21350        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21351
 21352* EXEC CICS ENDBR
 21353*            DATASET  (FILE-ID-ERPNDB)
 21354*       END-EXEC
 21355     MOVE 0
 21356       TO DFHEIV11
 21357*    MOVE '&2                    $   #00017861' TO DFHEIV0
 21358     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21359     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21360     MOVE X'2020233030303137383631' TO DFHEIV0(25:11)
 21361     CALL 'kxdfhei1' USING DFHEIV0,
 21362           FILE-ID-ERPNDB,
 21363           DFHEIV11,
 21364           DFHEIV99
 21365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21366        GO TO 5505-START-BROWSE.
 21367
 21368     IF PI-CSR-BROWSE
 21369        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21370           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21371
 21372* EXEC CICS ENDBR
 21373*               DATASET  (FILE-ID-ERPNDB)
 21374*          END-EXEC
 21375     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 391
* VP6311.cbl
 21376       TO DFHEIV11
 21377*    MOVE '&2                    $   #00017869' TO DFHEIV0
 21378     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21379     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21380     MOVE X'2020233030303137383639' TO DFHEIV0(25:11)
 21381     CALL 'kxdfhei1' USING DFHEIV0,
 21382           FILE-ID-ERPNDB,
 21383           DFHEIV11,
 21384           DFHEIV99
 21385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21386           GO TO 5505-START-BROWSE.
 21387
 21388     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21389        IF PI-PB-CARRIER    = SPACES AND
 21390           PI-PB-GROUPING   = SPACES AND
 21391           PI-PB-STATE      = SPACES AND
 21392           PI-PB-ACCOUNT    = SPACES
 21393             GO TO 7200-DISPLAY-BATCHES
 21394          ELSE
 21395            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21396               PI-PB-GROUPING   = PB-GROUPING AND
 21397               PI-PB-STATE      = PB-STATE    AND
 21398               PI-PB-ACCOUNT    = PB-ACCOUNT
 21399                 GO TO 7200-DISPLAY-BATCHES.
 21400
 21401     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21402
 21403
 21404* EXEC CICS ENDBR
 21405*         DATASET  (FILE-ID-ERPNDB)
 21406*    END-EXEC.
 21407     MOVE 0
 21408       TO DFHEIV11
 21409*    MOVE '&2                    $   #00017889' TO DFHEIV0
 21410     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21411     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21412     MOVE X'2020233030303137383839' TO DFHEIV0(25:11)
 21413     CALL 'kxdfhei1' USING DFHEIV0,
 21414           FILE-ID-ERPNDB,
 21415           DFHEIV11,
 21416           DFHEIV99
 21417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21418
 21419
 21420     GO TO 5505-START-BROWSE.
 21421
 21422 5550-END-RECORDS.
 21423     MOVE ER-2257                TO EMI-ERROR.
 21424     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21425     MOVE -1                     TO DPFENTRL.
 21426
 21427     GO TO 8200-SEND-DATAONLY.
 21428
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 392
* VP6311.cbl
 21430
 21431******************************************************************
 21432*                                                                *
 21433*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21434*                                                                *
 21435******************************************************************
 21436
 21437 6000-CREATE-TEMP-STORAGE.
 21438
 21439
 21440* EXEC CICS HANDLE CONDITION
 21441*        QIDERR  (6050-QID-ERROR)
 21442*    END-EXEC.
 21443*    MOVE '"$N                   ! V #00017912' TO DFHEIV0
 21444     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21445     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21446     MOVE X'5620233030303137393132' TO DFHEIV0(25:11)
 21447     CALL 'kxdfhei1' USING DFHEIV0
 21448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21449
 21450
 21451
 21452* EXEC CICS WRITEQ TS
 21453*        QUEUE    (QID)
 21454*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21455*        LENGTH   (WS-COMM-LENGTH)
 21456*        ITEM     (W-ONE)
 21457*    END-EXEC.
 21458*    MOVE '*" I   L              ''   #00017916' TO DFHEIV0
 21459     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 21460     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21461     MOVE X'2020233030303137393136' TO DFHEIV0(25:11)
 21462     CALL 'kxdfhei1' USING DFHEIV0,
 21463           QID,
 21464           PROGRAM-INTERFACE-BLOCK,
 21465           WS-COMM-LENGTH,
 21466           W-ONE,
 21467           DFHEIV99,
 21468           DFHEIV99
 21469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21470
 21471
 21472 6000-EXIT.
 21473      EXIT.
 21474
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 393
* VP6311.cbl
 21476
 21477******************************************************************
 21478*                                                                *
 21479*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21480*                                                                *
 21481******************************************************************
 21482
 21483 6050-RECOVER-TEMP-STORAGE.
 21484     IF PGM-NAME = XCTL-EL6312
 21485        GO TO 6050-EXIT.
 21486
 21487     IF PGM-NAME = XCTL-EL6313
 21488        GO TO 6050-EXIT.
 21489
 21490     IF PGM-NAME = XCTL-EL6315
 21491         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21492     END-IF
 21493
 21494     IF PGM-NAME = XCTL-EL6316
 21495         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21496     END-IF
 21497
 21498
 21499* EXEC CICS HANDLE CONDITION
 21500*        QIDERR  (6050-QID-ERROR)
 21501*    END-EXEC.
 21502*    MOVE '"$N                   ! W #00017949' TO DFHEIV0
 21503     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21504     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21505     MOVE X'5720233030303137393439' TO DFHEIV0(25:11)
 21506     CALL 'kxdfhei1' USING DFHEIV0
 21507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21508
 21509
 21510
 21511* EXEC CICS READQ TS
 21512*         QUEUE   (QID)
 21513*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21514*         LENGTH  (WS-COMM-LENGTH)
 21515*         ITEM    (W-ONE)
 21516*     END-EXEC.
 21517*    MOVE '*$II   L              ''   #00017953' TO DFHEIV0
 21518     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21519     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21520     MOVE X'2020233030303137393533' TO DFHEIV0(25:11)
 21521     CALL 'kxdfhei1' USING DFHEIV0,
 21522           QID,
 21523           PROGRAM-INTERFACE-BLOCK,
 21524           WS-COMM-LENGTH,
 21525           W-ONE,
 21526           DFHEIV99,
 21527           DFHEIV99
 21528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21529
 21530
 21531 6050-DELETE-TEMP-STORAGE.
 21532
 21533
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 394
* VP6311.cbl
 21534* EXEC CICS DELETEQ TS
 21535*        QUEUE   (QID)
 21536*    END-EXEC.
 21537*    MOVE '*&                    #   #00017962' TO DFHEIV0
 21538     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21539     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21540     MOVE X'2020233030303137393632' TO DFHEIV0(25:11)
 21541     CALL 'kxdfhei1' USING DFHEIV0,
 21542           QID,
 21543           DFHEIV99
 21544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21545
 21546
 21547     GO TO 6050-EXIT.
 21548
 21549 6050-QID-ERROR.
 21550     MOVE ER-0033                TO EMI-ERROR
 21551     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21552
 21553 6050-EXIT.
 21554      EXIT.
 21555
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 395
* VP6311.cbl
 21557
 21558******************************************************************
 21559*                                                                *
 21560*            T E R M   C O N V E R S I O N                       *
 21561*                                                                *
 21562******************************************************************
 21563
 21564 6100-TERM-CONVERSION.
 21565
 21566     IF PI-BPMTS = ZERO
 21567         GO TO 6199-EXIT.
 21568
 21569
 21570 6105-ROUND-TERM.
 21571
 21572     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21573         ADD +1                  TO WS-CALC-TERM-WHOLE
 21574         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21575
 21576     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21577         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21578
 21579     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21580         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21581                                      WS-BTERM    (WS-SUB1)
 21582         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21583
 21584
 21585 6124-CHECK-BENEFIT.
 21586
 21587     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21588        GO TO 6126-COMPUTE-BENEFIT.
 21589
 21590     GO TO 6199-EXIT.
 21591
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 396
* VP6311.cbl
 21593******************************************************************
 21594**         COMPUTE TERM AND BENEFIT
 21595******************************************************************
 21596 6125-COMPUTE-TERM-BENEFIT.
 21597
 21598     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21599        PI-BPMTAMT = ZERO
 21600         GO TO 6199-EXIT.
 21601
 21602     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21603                                     WS-BTERM  (WS-SUB1).
 21604     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21605
 21606 6126-COMPUTE-BENEFIT.
 21607
 21608
 21609     IF WS-SUB1 = +1
 21610        COMPUTE WS-BBEN (WS-SUB1) =
 21611                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21612
 21613     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21614     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21615     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21616
 21617 6199-EXIT.
 21618     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 397
* VP6311.cbl
 21620
 21621******************************************************************
 21622*                                                                *
 21623*             D I S P L A Y   I S S U E S                        *
 21624*                                                                *
 21625******************************************************************
 21626
 21627 6200-CREATE-VADS.
 21628     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21629     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21630     MOVE SPACES                 TO WS-PASS-VADS-REC
 21631
 21632* EXEC CICS GETMAIN
 21633*       SET      (ADDRESS OF PENDING-BUSINESS)
 21634*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21635*       INITIMG  (GETMAIN-SPACE)
 21636*       RESP     (WS-RESPONSE)
 21637*    END-EXEC
 21638*    MOVE ',"IL                  $  N#00018050' TO DFHEIV0
 21639     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21640     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21641     MOVE X'204E233030303138303530' TO DFHEIV0(25:11)
 21642     CALL 'kxdfhei1' USING DFHEIV0,
 21643           DFHEIV20,
 21644           ERPNDB-RECORD-LENGTH,
 21645           GETMAIN-SPACE
 21646     SET ADDRESS OF PENDING-BUSINESS TO
 21647         DFHEIV20
 21648     MOVE EIBRESP  TO WS-RESPONSE
 21649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21650
 21651* EXEC CICS READ
 21652*       INTO    (PENDING-BUSINESS)
 21653*       DATASET (FILE-ID-ERPNDB)
 21654*       RIDFLD  (ERPNDB-KEY)
 21655*       RESP    (WS-RESPONSE)
 21656*    END-EXEC
 21657     MOVE LENGTH OF
 21658      PENDING-BUSINESS
 21659       TO DFHEIV11
 21660*    MOVE '&"IL       E          (  N#00018056' TO DFHEIV0
 21661     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21662     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21663     MOVE X'204E233030303138303536' TO DFHEIV0(25:11)
 21664     CALL 'kxdfhei1' USING DFHEIV0,
 21665           FILE-ID-ERPNDB,
 21666           PENDING-BUSINESS,
 21667           DFHEIV11,
 21668           ERPNDB-KEY,
 21669           DFHEIV99,
 21670           DFHEIV99,
 21671           DFHEIV99
 21672     MOVE EIBRESP  TO WS-RESPONSE
 21673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21674     IF RESP-NORMAL
 21675        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21676        IF (RESP-NORMAL)
 21677           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 398
* VP6311.cbl
 21678              AM-CONTROL-PRIMARY (1:20))
 21679           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21680        ELSE
 21681           MOVE 'ACCOUNT NOT FOUND'
 21682                                 TO VD-ACCOUNT-NAME
 21683        END-IF
 21684        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21685                                    TO M1
 21686        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21687        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21688           (A2 > M1)
 21689           OR (WS-WORK-FIELD (A2:1) = '*')
 21690           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21691           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21692        END-PERFORM
 21693        IF A2 > M1
 21694           CONTINUE
 21695        ELSE
 21696           MOVE WS-WORK-FIELD (1:A2 - 1)
 21697                                    TO VD-ACCOUNT-NAME
 21698        END-IF
 21699        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21700        MOVE PB-CARRIER          TO VD-CARRIER
 21701        MOVE PB-GROUPING         TO VD-GROUPING
 21702        MOVE PB-STATE            TO VD-STATE
 21703        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21704        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21705        MOVE PB-CERT-NO          TO VD-CERT-NO
 21706        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21707        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21708        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21709        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21710        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21711        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21712        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21713        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21714        MOVE PB-CSR-ID           TO VD-CSR-ID
 21715        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21716        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21717        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21718        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21719        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21720        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21721        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21722        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21723        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21724        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21725        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21726        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21727        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21728     END-IF
 21729     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21730
 21731
 21732* EXEC CICS GETMAIN
 21733*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21734*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21735*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 399
* VP6311.cbl
 21736*       RESP     (WS-RESPONSE)
 21737*    END-EXEC
 21738*    MOVE ',"IL                  $  N#00018119' TO DFHEIV0
 21739     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21740     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21741     MOVE X'204E233030303138313139' TO DFHEIV0(25:11)
 21742     CALL 'kxdfhei1' USING DFHEIV0,
 21743           DFHEIV20,
 21744           ERPNDM-RECORD-LENGTH,
 21745           GETMAIN-SPACE
 21746     SET ADDRESS OF PENDING-MAILING-DATA TO
 21747         DFHEIV20
 21748     MOVE EIBRESP  TO WS-RESPONSE
 21749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21750
 21751
 21752* EXEC CICS READ
 21753*       INTO    (PENDING-MAILING-DATA)
 21754*       DATASET (FILE-ID-ERPNDM)
 21755*       RIDFLD  (ERPNDM-KEY)
 21756*       RESP    (WS-RESPONSE)
 21757*    END-EXEC
 21758     MOVE LENGTH OF
 21759      PENDING-MAILING-DATA
 21760       TO DFHEIV11
 21761*    MOVE '&"IL       E          (  N#00018126' TO DFHEIV0
 21762     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21763     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21764     MOVE X'204E233030303138313236' TO DFHEIV0(25:11)
 21765     CALL 'kxdfhei1' USING DFHEIV0,
 21766           FILE-ID-ERPNDM,
 21767           PENDING-MAILING-DATA,
 21768           DFHEIV11,
 21769           ERPNDM-KEY,
 21770           DFHEIV99,
 21771           DFHEIV99,
 21772           DFHEIV99
 21773     MOVE EIBRESP  TO WS-RESPONSE
 21774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21775
 21776     IF RESP-NORMAL
 21777        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21778        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21779        MOVE PM-CITY              TO VD-INSURED-CITY
 21780        MOVE PM-STATE             TO VD-INSURED-STATE
 21781        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21782     END-IF
 21783
 21784     MOVE 'VAC1'                  TO VD-LETTER-ID
 21785     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21786     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21787     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21788     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21789     MOVE +0                      TO VD-ARCHIVE-NO
 21790     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21791     .
 21792 6200-EXIT.
 21793     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 400
* VP6311.cbl
 21794 6210-READ-ERACCT.
 21795     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21796     MOVE LOW-VALUES             TO ERACCT-FILL
 21797
 21798* EXEC CICS READ
 21799*         DATASET   ('ERACCT')
 21800*         INTO      (ACCOUNT-MASTER)
 21801*         RIDFLD    (ERACCT-KEY)
 21802*         GTEQ
 21803*         RESP      (WS-RESPONSE)
 21804*    END-EXEC
 21805     MOVE LENGTH OF
 21806      ACCOUNT-MASTER
 21807       TO DFHEIV11
 21808     MOVE 'ERACCT' TO DFHEIV1
 21809*    MOVE '&"IL       G          (  N#00018154' TO DFHEIV0
 21810     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21811     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21812     MOVE X'204E233030303138313534' TO DFHEIV0(25:11)
 21813     CALL 'kxdfhei1' USING DFHEIV0,
 21814           DFHEIV1,
 21815           ACCOUNT-MASTER,
 21816           DFHEIV11,
 21817           ERACCT-KEY,
 21818           DFHEIV99,
 21819           DFHEIV99,
 21820           DFHEIV99
 21821     MOVE EIBRESP  TO WS-RESPONSE
 21822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21823     .
 21824 6210-EXIT.
 21825     EXIT.
 21826
 21827 6220-READ-ERMAIL.
 21828
 21829     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21830     MOVE ' '                    TO WS-ERMAIL-SW
 21831
 21832
 21833* EXEC CICS READ
 21834*       DATASET   (FILE-ID-ERMAIL)
 21835*       SET       (ADDRESS OF MAILING-DATA)
 21836*       RIDFLD    (ERMAIL-KEY)
 21837*       RESP      (WS-RESPONSE)
 21838*    END-EXEC
 21839*    MOVE '&"S        E          (  N#00018170' TO DFHEIV0
 21840     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21841     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21842     MOVE X'204E233030303138313730' TO DFHEIV0(25:11)
 21843     CALL 'kxdfhei1' USING DFHEIV0,
 21844           FILE-ID-ERMAIL,
 21845           DFHEIV20,
 21846           DFHEIV99,
 21847           ERMAIL-KEY,
 21848           DFHEIV99,
 21849           DFHEIV99,
 21850           DFHEIV99
 21851     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 401
* VP6311.cbl
 21852         DFHEIV20
 21853     MOVE EIBRESP  TO WS-RESPONSE
 21854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21855
 21856     IF RESP-NORMAL
 21857        SET ERMAIL-FOUND TO TRUE
 21858     END-IF
 21859     .
 21860 6220-EXIT.
 21861     EXIT.
 21862
 21863 6400-CHECK-FOR-RES-REF-CLAIM.
 21864     display 'made it to 6400- for ' pi-cert-no
 21865     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 21866
 21867     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 21868                                    W-CL-COMP-CD.
 21869     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 21870                                    W-CL-CERT-NO.
 21871     MOVE SPACES                 TO MSTR-CERT-SFX.
 21872
 21873
 21874* EXEC CICS HANDLE CONDITION
 21875*        NOTFND  (6400-CONTINUE)
 21876*        ENDFILE (6400-CONTINUE)
 21877*    END-EXEC.
 21878*    MOVE '"$I''                  ! X #00018194' TO DFHEIV0
 21879     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21880     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21881     MOVE X'5820233030303138313934' TO DFHEIV0(25:11)
 21882     CALL 'kxdfhei1' USING DFHEIV0
 21883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21884
 21885
 21886
 21887* EXEC CICS IGNORE CONDITION
 21888*        DUPKEY
 21889*    END-EXEC.
 21890*    MOVE '"*$                   !   #00018199' TO DFHEIV0
 21891     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 21892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21893     MOVE X'2020233030303138313939' TO DFHEIV0(25:11)
 21894     CALL 'kxdfhei1' USING DFHEIV0
 21895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21896
 21897
 21898
 21899* EXEC CICS STARTBR
 21900*        DATASET   (CLMS-ID)
 21901*        RIDFLD    (ELMSTR-KEY)
 21902*        GENERIC   EQUAL
 21903*        KEYLENGTH (ELMSTR-LENGTH)
 21904*    END-EXEC.
 21905     MOVE 0
 21906       TO DFHEIV11
 21907*    MOVE '&,   KG    E          &   #00018203' TO DFHEIV0
 21908     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 21909     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 402
* VP6311.cbl
 21910     MOVE X'2020233030303138323033' TO DFHEIV0(25:11)
 21911     CALL 'kxdfhei1' USING DFHEIV0,
 21912           CLMS-ID,
 21913           ELMSTR-KEY,
 21914           ELMSTR-LENGTH,
 21915           DFHEIV11,
 21916           DFHEIV99
 21917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21918
 21919
 21920     display 'browse started'
 21921     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21922
 21923 6400-NEXT-CLAIM.
 21924
 21925
 21926* EXEC CICS READNEXT
 21927*        DATASET   (CLMS-ID)
 21928*        RIDFLD    (ELMSTR-KEY)
 21929*        SET       (ADDRESS OF CLAIM-MASTER)
 21930*    END-EXEC.
 21931     MOVE 0
 21932       TO DFHEIV11
 21933*    MOVE '&.S                   )   #00018215' TO DFHEIV0
 21934     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21935     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21936     MOVE X'2020233030303138323135' TO DFHEIV0(25:11)
 21937     CALL 'kxdfhei1' USING DFHEIV0,
 21938           CLMS-ID,
 21939           DFHEIV20,
 21940           DFHEIV99,
 21941           ELMSTR-KEY,
 21942           DFHEIV99,
 21943           DFHEIV11,
 21944           DFHEIV99,
 21945           DFHEIV99
 21946     SET ADDRESS OF CLAIM-MASTER TO
 21947         DFHEIV20
 21948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21949
 21950
 21951     display 'read claim for ' mstr-cert-no
 21952     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 21953        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 21954         GO TO 6400-CONTINUE
 21955     END-IF.
 21956
 21957     IF PI-CARRIER     NOT = CL-CARRIER        OR
 21958        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 21959        PI-STATE       NOT = CL-CERT-STATE     OR
 21960        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 21961        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 21962         GO TO 6400-NEXT-CLAIM
 21963     END-IF.
 21964
 21965     display 'found claim ' cl-claim-no
 21966        ' with denial type ' cl-denial-type
 21967     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 403
* VP6311.cbl
 21968         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 21969         GO TO 6400-CONTINUE
 21970     END-IF.
 21971
 21972     GO TO 6400-NEXT-CLAIM.
 21973
 21974 6400-CONTINUE.
 21975
 21976     IF WS-BROWSE-STARTED-SW = 'Y'
 21977
 21978* EXEC CICS ENDBR
 21979*            DATASET   (CLMS-ID)
 21980*        END-EXEC
 21981     MOVE 0
 21982       TO DFHEIV11
 21983*    MOVE '&2                    $   #00018247' TO DFHEIV0
 21984     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21985     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21986     MOVE X'2020233030303138323437' TO DFHEIV0(25:11)
 21987     CALL 'kxdfhei1' USING DFHEIV0,
 21988           CLMS-ID,
 21989           DFHEIV11,
 21990           DFHEIV99
 21991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21992         MOVE 'N' TO WS-BROWSE-STARTED-SW
 21993     END-IF.
 21994
 21995 6400-EXIT.
 21996     EXIT.
 21997
 21998 7000-DISPLAY-ISSUES.
 21999
 22000     IF PI-DISPLAY-ORIGINAL-BATCH
 22001        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22002        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22003     ELSE
 22004        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22005
 22006     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22007
 22008     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22009     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22010
 22011     MOVE LOW-VALUES                 TO VP631BI.
 22012     MOVE ZEROS                      TO PI-BPMTAMT
 22013                                        PI-BPMTS.
 22014     MOVE SPACE                      TO PI-BMODE
 22015                                        PI-BTYPE (1)
 22016                                        PI-BTYPE (2).
 22017     MOVE VP631B                     TO PI-MAP-NAME.
 22018     MOVE 'Y'                        TO PI-BROWSE-SW.
 22019     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22020                                        PI-HIGH-SEQ-NO.
 22021
 22022     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22023        MOVE AL-SABOF                TO BCHGTA
 22024        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22025        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 404
* VP6311.cbl
 22026     ELSE
 22027        MOVE AL-SADOF                TO BCHGTA
 22028                                        BCHGA
 22029        MOVE PB-CHG-COUNT            TO BCHGO.
 22030
 22031     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22032     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22033     MOVE WS-HR-MINS                 TO BMANTATO.
 22034
 22035     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22036        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22037        MOVE SPACE                   TO DC-OPTION-CODE
 22038        PERFORM 9700-DATE-LINK
 22039        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22040        MOVE 'INACTIVE'              TO BMOENDTO
 22041     ELSE
 22042        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22043        MOVE SPACE                   TO DC-OPTION-CODE
 22044        PERFORM 9700-DATE-LINK
 22045        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22046        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22047        MOVE SPACE                   TO DC-OPTION-CODE
 22048        PERFORM 9700-DATE-LINK
 22049        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22050
 22051*    MOVE PB-I-REFERENCE             TO BREFO.
 22052
 22053*    IF PI-COMPANY-ID EQUAL 'HER'
 22054*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22055*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22056*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22057*                MOVE WS-MEMBER-NO-1-8
 22058*                                TO  BMICRNOO.
 22059
 22060*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22061*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22062*            MOVE PB-I-MICROFILM-NO
 22063*                                TO  BMICRNOO.
 22064     IF PB-I-VIN NOT = SPACES
 22065        MOVE PB-I-VIN            TO BVINO
 22066     END-IF
 22067
 22068     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22069     MOVE PB-CERT-SFX                TO BSUFIXO.
 22070     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22071     MOVE SPACE                      TO DC-OPTION-CODE.
 22072     PERFORM 9700-DATE-LINK.
 22073     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22074
 22075     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22076     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22077     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22078     MOVE PB-I-INSURED-SEX           TO BSEXO
 22079
 22080     IF PB-I-AGE NOT = ZEROS
 22081         MOVE PB-I-AGE               TO BAGEO.
 22082
 22083     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 405
* VP6311.cbl
 22084                                 TO ELCERT-KEY
 22085     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22086     IF NOT CERT-TRL-REC-NOT-FOUND
 22087         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22088             MOVE 'AGE*'             TO BAGEDEFO
 22089         ELSE
 22090             MOVE 'AGE '             TO BAGEDEFO
 22091         END-IF
 22092         if cs-year numeric
 22093            move cs-year         to byearo
 22094         end-if
 22095         move cs-make            to bmakeo
 22096         move cs-model           to bmodelo
 22097         move cs-future          to bfutureo
 22098         if cs-vehicle-odometer numeric
 22099            move cs-vehicle-odometer
 22100                                 to bometero
 22101         end-if
 22102     ELSE
 22103         MOVE 'AGE '             TO BAGEDEFO
 22104     END-IF
 22105
 22106     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22107         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22108         MOVE SPACE                  TO DC-OPTION-CODE
 22109         PERFORM 9700-DATE-LINK
 22110         IF NO-CONVERSION-ERROR
 22111            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22112
 22113
 22114
 22115
 22116     MOVE PB-FORCE-CODE              TO BFORCEO.
 22117
 22118
 22119
 22120
 22121     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22122     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22123     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22124     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22125     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
 22126     MOVE PB-I-SIG-SW                TO BSIGO.
 22127     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22128     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22129     MOVE PB-RECORD-BILL             TO BBILCDO.
 22130     MOVE PB-FORCE-CODE              TO BFORCEO.
 22131
 22132
 22133
 22134     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22135
 22136
 22137     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22138        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22139
 22140
 22141     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 406
* VP6311.cbl
 22142
 22143     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22144        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22145
 22146     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22147        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22148                                        PI-BTYPE (1).
 22149
 22150     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22151        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22152
 22153     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22154        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22155
 22156     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22157        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22158
 22159     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22160        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22161
 22162     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22163        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22164
 22165     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22166         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22167         MOVE SPACE                  TO DC-OPTION-CODE
 22168         PERFORM 9700-DATE-LINK
 22169         IF NO-CONVERSION-ERROR
 22170            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22171
 22172     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22173        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22174        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22175        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22176        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22177                 GIVING BDIFFO (1)
 22178     ELSE
 22179        MOVE SPACES                  TO BBEN-CD     (1)
 22180                                        BBEN-ABBR   (1).
 22181
 22182     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22183        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22184        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22185                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22186
 22187     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22188       IF PB-RECORD-ON-HOLD
 22189          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22190
 22191     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22192       IF PB-RECORD-RETURNED
 22193          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22194
 22195     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22196        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22197             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22198
 22199     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 407
* VP6311.cbl
 22200
 22201     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22202        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22203
 22204     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22205        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22206                                        PI-BTYPE (2).
 22207
 22208     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22209        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22210
 22211     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22212        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22213
 22214     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22215        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22216
 22217     IF PB-I-TOT-FEES NOT NUMERIC
 22218        MOVE ZEROS               TO PB-I-TOT-FEES
 22219     END-IF
 22220     IF PB-I-TOT-FEES > ZEROS
 22221        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22222
 22223     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22224         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22225         MOVE SPACE                  TO DC-OPTION-CODE
 22226         PERFORM 9700-DATE-LINK
 22227         IF NO-CONVERSION-ERROR
 22228            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22229
 22230     IF PB-I-TOT-FEES > ZEROS
 22231        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22232        SUBTRACT PB-I-TOT-FEES FROM
 22233                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22234
 22235     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22236        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22237        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22238        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22239        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22240                 GIVING BDIFFO (2)
 22241     ELSE
 22242        MOVE SPACES                  TO BBEN-CD     (2)
 22243                                        BBEN-ABBR   (2).
 22244
 22245     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22246       IF PB-RECORD-ON-HOLD
 22247          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22248
 22249     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22250       IF PB-RECORD-RETURNED
 22251          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22252
 22253     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22254        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22255             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22256
 22257     MOVE PB-CSR-ID                  TO BCSRO.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 408
* VP6311.cbl
 22258
 22259     IF PI-COMPANY-ID  =  'DMD'
 22260        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22261            NEXT SENTENCE
 22262        ELSE
 22263            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22264               MOVE 'NEW CERT'       TO BNCERTLI
 22265               MOVE EC-NEW-CERT      TO BNCERTO.
 22266
 22267     IF PI-COMPANY-ID  =  'DMD'
 22268        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22269            NEXT SENTENCE
 22270        ELSE
 22271           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22272               MOVE 'NEW STATE'      TO BNSTATLI
 22273               MOVE EC-NEW-STATE     TO BNSTATO.
 22274
 22275 7000-CONTINUE.
 22276     MOVE 'C'                        TO BMAINTI.
 22277     MOVE AL-UANON                   TO BMAINTA.
 22278
 22279     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22280        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22281
 22282     IF PI-6315-FINALIZED = 'Y'   AND
 22283        PB-UNFORCED-ERRORS
 22284          MOVE -1                TO BFORCEL
 22285          MOVE  1                TO SET-CURSOR-SW
 22286     END-IF
 22287
 22288     IF NO-CURSOR-SET
 22289        MOVE -1                      TO BMAINTL.
 22290
 22291     GO TO 8100-SEND-INITIAL-MAP.
 22292
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 409
* VP6311.cbl
 22294
 22295******************************************************************
 22296*                                                                *
 22297*             D I S P L A Y   C A N C E L S                      *
 22298*                                                                *
 22299******************************************************************
 22300
 22301 7100-DISPLAY-CANCELS.
 22302     IF PI-DISPLAY-ORIGINAL-BATCH
 22303        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22304        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22305     ELSE
 22306        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22307
 22308     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22309
 22310     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22311     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22312
 22313     MOVE LOW-VALUES                 TO VP631CI.
 22314     MOVE VP631C                     TO PI-MAP-NAME.
 22315     MOVE 'Y'                        TO PI-BROWSE-SW.
 22316     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22317                                        PI-HIGH-SEQ-NO.
 22318
 22319     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22320        MOVE AL-SABOF                TO CCHGTA
 22321        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22322        MOVE AL-SANON                TO CCHGA
 22323      ELSE
 22324        MOVE AL-SADOF                TO CCHGTA
 22325                                        CCHGA
 22326        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22327
 22328*    MOVE PB-C-REFERENCE             TO CREFO.
 22329
 22330*    IF PB-C-MICROFILM-NO IS NUMERIC
 22331*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22332*          MOVE PB-C-MICROFILM-NO
 22333*                                TO CMICRNOO
 22334*          MOVE AL-UNNON         TO CMICRNOA
 22335*       END-IF
 22336*    END-IF
 22337     IF PB-C-INT-ON-REFS NUMERIC
 22338        IF PB-C-INT-ON-REFS NOT = ZEROS
 22339           MOVE PB-C-INT-ON-REFS
 22340                                 TO CNHINTO
 22341           MOVE AL-SANOF         TO CNHINTA
 22342        END-IF
 22343     END-IF
 22344     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22345     MOVE PB-CERT-SFX                TO CSUFIXO.
 22346     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22347     MOVE SPACE                      TO DC-OPTION-CODE.
 22348     PERFORM 9700-DATE-LINK.
 22349     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22350
 22351     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 410
* VP6311.cbl
 22352        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22353        MOVE SPACE                   TO DC-OPTION-CODE
 22354        PERFORM 9700-DATE-LINK
 22355        IF NO-CONVERSION-ERROR
 22356           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22357
 22358     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22359        NEXT SENTENCE
 22360     ELSE
 22361        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22362
 22363     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22364        NEXT SENTENCE
 22365     ELSE
 22366        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22367
 22368     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22369        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22370        MOVE SPACE                   TO DC-OPTION-CODE
 22371        PERFORM 9700-DATE-LINK
 22372        IF NO-CONVERSION-ERROR
 22373           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22374
 22375     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22376         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22377
 22378     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22379         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22380
 22381     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22382        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22383        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22384                 GIVING CDRFND1O.
 22385
 22386     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22387        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22388        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22389                 GIVING CDRFND2O.
 22390
 22391     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22392       IF PB-RECORD-ON-HOLD
 22393          MOVE 'ON HOLD'             TO CBILIT1O.
 22394
 22395     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22396       IF PB-RECORD-RETURNED
 22397          MOVE 'RETURNED'            TO CBILIT1O.
 22398
 22399     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22400        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22401             MOVE 'OVERRIDE'         TO CBILIT1O.
 22402
 22403     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22404       IF PB-RECORD-ON-HOLD
 22405          MOVE 'ON HOLD'             TO CBILIT2O.
 22406
 22407     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22408       IF PB-RECORD-RETURNED
 22409          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 411
* VP6311.cbl
 22410
 22411     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22412        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22413             MOVE 'OVERRIDE'         TO CBILIT2O.
 22414
 22415     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22416     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22417     MOVE PB-FORCE-CODE              TO CFORCEO.
 22418     MOVE PB-RECORD-BILL             TO CBILCDO.
 22419     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22420     MOVE SPACES                     TO CINITSO.
 22421     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22422         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22423     ELSE
 22424         MOVE PB-CI-INITIALS         TO CINITSO
 22425     END-IF.
 22426
 22427     IF PB-CI-CANCEL-FEE NUMERIC
 22428        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22429        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22430     ELSE
 22431        MOVE ZEROES                  TO W-CANCEL-FEE.
 22432
 22433     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22434
 22435     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22436        ADD PB-CI-LF-PREMIUM-AMT
 22437             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22438
 22439     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22440        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22441
 22442     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22443     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22444     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22445     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22446
 22447     IF PB-C-LIVES NUMERIC
 22448        MOVE PB-C-LIVES              TO CLIVESO.
 22449
 22450     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22451        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22452
 22453     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22454        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22455        MOVE SPACE                   TO DC-OPTION-CODE
 22456        PERFORM 9700-DATE-LINK
 22457        IF NO-CONVERSION-ERROR
 22458           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22459
 22460     IF  PB-C-REFUND-CREATED
 22461         MOVE 'YES'                  TO CRFNDSWO
 22462     ELSE
 22463         IF PB-C-REFUND-REQUESTED
 22464            MOVE 'REQ'               TO CRFNDSWO
 22465         ELSE
 22466            MOVE 'NO'                TO CRFNDSWO.
 22467
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 412
* VP6311.cbl
 22468     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22469     MOVE SPACE                      TO DC-OPTION-CODE.
 22470     PERFORM 9700-DATE-LINK.
 22471     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22472     MOVE PB-INPUT-BY                TO CENTBYO.
 22473
 22474     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22475        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22476        MOVE SPACE                   TO DC-OPTION-CODE
 22477        PERFORM 9700-DATE-LINK
 22478        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22479        MOVE 'INACTIVE'              TO CMOENDTO
 22480     ELSE
 22481        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22482        MOVE SPACE                   TO DC-OPTION-CODE
 22483        PERFORM 9700-DATE-LINK
 22484        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22485        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22486        MOVE SPACE                   TO DC-OPTION-CODE
 22487        PERFORM 9700-DATE-LINK
 22488        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22489
 22490     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22491
 22492     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22493     MOVE WS-HR-MINS                 TO CMANTATO.
 22494
 22495     EVALUATE PB-LF-REFUND-TYPE
 22496        WHEN '1'
 22497           MOVE 'RULE78'            TO CLFREFNO
 22498        WHEN '2'
 22499           MOVE 'PRORAT'            TO CLFREFNO
 22500        WHEN '3'
 22501           MOVE 'CALIF'             TO CLFREFNO
 22502        WHEN '4'
 22503           MOVE 'IRREG'             TO CLFREFNO
 22504        WHEN '5'
 22505           MOVE 'NETPAY'            TO CLFREFNO
 22506        WHEN '6'
 22507           MOVE 'ATCP'              TO CLFREFNO
 22508        WHEN '7'
 22509           MOVE 'UTAH'              TO CLFREFNO
 22510        WHEN '8'
 22511           MOVE 'MEAN'              TO CLFREFNO
 22512        WHEN '9'
 22513           MOVE 'SUM '              TO CLFREFNO
 22514        WHEN 'B'
 22515           MOVE 'BALN'              TO CLFREFNO
 22516     END-EVALUATE.
 22517
 22518     EVALUATE TRUE
 22519        WHEN PB-AH-REFUND-TYPE =  '1'
 22520           MOVE 'RULE78'            TO CAHREFNO
 22521        WHEN PB-AH-REFUND-TYPE =  '2'
 22522           MOVE 'PRORAT'            TO CAHREFNO
 22523        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22524           MOVE 'CALIF'             TO CAHREFNO
 22525        WHEN PB-AH-REFUND-TYPE =  '4'
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 413
* VP6311.cbl
 22526           MOVE 'IRREG'             TO CAHREFNO
 22527        WHEN PB-AH-REFUND-TYPE =  '5'
 22528           MOVE 'NETPAY'            TO CAHREFNO
 22529        WHEN PB-AH-REFUND-TYPE =  '6'
 22530           MOVE 'ATCP'              TO CAHREFNO
 22531        WHEN PB-AH-REFUND-TYPE =  '7'
 22532           MOVE 'UTAH'              TO CAHREFNO
 22533        WHEN PB-AH-REFUND-TYPE =  '8'
 22534           MOVE 'MEAN'              TO CAHREFNO
 22535        WHEN PB-AH-REFUND-TYPE =  '9'
 22536           MOVE 'SUM '              TO CAHREFNO
 22537        WHEN PB-AH-REFUND-TYPE =  'B'
 22538           MOVE 'BALN'              TO CAHREFNO
 22539     END-EVALUATE.
 22540
 22541     MOVE PB-REIN-CD                 TO CREINCDO.
 22542
 22543     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22544        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22545        MOVE SPACE                   TO DC-OPTION-CODE
 22546        PERFORM 9700-DATE-LINK
 22547        IF NO-CONVERSION-ERROR
 22548           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22549
 22550     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22551        MOVE 999999                  TO WS-EXP-DT-EDIT
 22552        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22553        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22554     ELSE
 22555        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22556           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22557           MOVE SPACE                   TO DC-OPTION-CODE
 22558           PERFORM 9700-DATE-LINK
 22559           IF NO-CONVERSION-ERROR
 22560              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22561
 22562     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22563        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22564           MOVE AL-SANOF                TO CORIGHDA
 22565           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22566           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22567
 22568     MOVE PB-CSR-ID              TO CCSRO.
 22569
 22570     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22571     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22572
 22573     MOVE 'C'                    TO CMAINTI.
 22574     MOVE AL-UANON               TO CMAINTA.
 22575
 22576     IF PI-6316-FINALIZED = 'Y'  AND
 22577        PB-UNFORCED-ERRORS
 22578          MOVE -1                TO CFORCEL
 22579          MOVE  1                TO SET-CURSOR-SW
 22580     END-IF
 22581
 22582     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22583        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 414
* VP6311.cbl
 22584
 22585     IF NO-CURSOR-SET
 22586        MOVE -1                  TO CMAINTL.
 22587
 22588     GO TO 8100-SEND-INITIAL-MAP.
 22589
 22590
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 415
* VP6311.cbl
 22592***************************************************************
 22593*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22594*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22595***************************************************************
 22596
 22597 7200-DISPLAY-BATCHES.
 22598     MOVE VP631D                 TO PI-MAP-NAME.
 22599     MOVE LOW-VALUES             TO VP631DI.
 22600
 22601     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22602
 22603
 22604* EXEC CICS HANDLE CONDITION
 22605*         NOTFND   (3690-NOT-FOUND)
 22606*    END-EXEC.
 22607*    MOVE '"$I                   ! Y #00018861' TO DFHEIV0
 22608     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22609     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22610     MOVE X'5920233030303138383631' TO DFHEIV0(25:11)
 22611     CALL 'kxdfhei1' USING DFHEIV0
 22612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22613
 22614
 22615     IF PI-DISPLAY-SCREEN
 22616        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22617     ELSE
 22618        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22619
 22620     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22621     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22622
 22623
 22624* EXEC CICS READ
 22625*         DATASET   (FILE-ID-ERPNDB)
 22626*         RIDFLD    (ERPNDB-KEY)
 22627*         SET       (ADDRESS OF PENDING-BUSINESS)
 22628*    END-EXEC.
 22629*    MOVE '&"S        E          (   #00018873' TO DFHEIV0
 22630     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22631     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22632     MOVE X'2020233030303138383733' TO DFHEIV0(25:11)
 22633     CALL 'kxdfhei1' USING DFHEIV0,
 22634           FILE-ID-ERPNDB,
 22635           DFHEIV20,
 22636           DFHEIV99,
 22637           ERPNDB-KEY,
 22638           DFHEIV99,
 22639           DFHEIV99,
 22640           DFHEIV99
 22641     SET ADDRESS OF PENDING-BUSINESS TO
 22642         DFHEIV20
 22643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22644
 22645
 22646     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22647     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22648     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22649     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 416
* VP6311.cbl
 22650     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22651
 22652     MOVE VP631D                 TO PI-MAP-NAME.
 22653     MOVE LOW-VALUES             TO VP631DI.
 22654     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22655
 22656*    IF PI-AR-PROCESSING
 22657*       MOVE PB-REFERENCE        TO DREFO.
 22658
 22659     MOVE PB-CSR-ID              TO DCSRO.
 22660
 22661     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22662        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22663        MOVE SPACE               TO DC-OPTION-CODE
 22664        PERFORM 9700-DATE-LINK
 22665        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22666        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22667        MOVE 'INACTIVE'          TO DLDATEO
 22668     ELSE
 22669        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22670        MOVE SPACE               TO DC-OPTION-CODE
 22671        PERFORM 9700-DATE-LINK
 22672        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22673
 22674     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22675     MOVE SPACE                  TO DC-OPTION-CODE.
 22676     PERFORM 9700-DATE-LINK.
 22677     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22678
 22679     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22680        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22681     ELSE
 22682        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22683        MOVE SPACE               TO DC-OPTION-CODE
 22684        PERFORM 9700-DATE-LINK
 22685        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22686
 22687     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22688     MOVE SPACE                  TO DC-OPTION-CODE.
 22689     PERFORM 9700-DATE-LINK.
 22690     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22691
 22692     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22693     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22694
 22695     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22696        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22697                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22698
 22699     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22700     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22701     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22702
 22703     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22704        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22705                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22706
 22707     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 417
* VP6311.cbl
 22708     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22709     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22710
 22711     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22712        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22713                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22714
 22715     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22716     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22717
 22718     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22719        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22720                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22721
 22722     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22723     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22724     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22725
 22726     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22727        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22728                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22729
 22730     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22731     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22732     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22733
 22734     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22735        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22736                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22737
 22738     MOVE -1                     TO DPFENTRL.
 22739     GO TO 8100-SEND-INITIAL-MAP.
 22740
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 418
* VP6311.cbl
 22742
 22743***************************************************************
 22744*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22745*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22746*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22747*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22748*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22749*     ARE THEN SET ACCORDINGLY.                               *
 22750*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22751*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22752*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22753***************************************************************
 22754
 22755******************************************************************
 22756*                                                                *
 22757*            E R R O R   A N A L Y S I S                         *
 22758*                                                                *
 22759******************************************************************
 22760
 22761******************************************************************
 22762*                                                                *
 22763*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22764*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22765*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22766*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22767*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22768*                                                                *
 22769*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22770*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22771*                                                                *
 22772******************************************************************
 22773
 22774 7300-FORMAT-ERRORS.
 22775     MOVE ' '                    TO PI-ERRORS-SW
 22776     IF PB-COMMON-ERRORS = LOW-VALUES
 22777        IF PB-FATAL-ERRORS
 22778           MOVE ER-2695          TO EMI-ERROR
 22779           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22780           GO TO 7399-EXIT.
 22781
 22782     MOVE +0                     TO WS-SUB4.
 22783
 22784 7310-ERROR-LOOP.
 22785
 22786     ADD +1                      TO WS-SUB4.
 22787
 22788     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22789        GO TO 7350-SET-ERROR-FLAGS.
 22790
 22791     IF PI-COMPANY-ID = 'UCL'
 22792         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22793             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22794             MOVE ' '                   TO DC-OPTION-CODE
 22795             PERFORM 9700-DATE-LINK
 22796             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22797
 22798     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22799     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 419
* VP6311.cbl
 22800     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22801
 22802     GO TO 7310-ERROR-LOOP.
 22803
 22804
 22805 7350-SET-ERROR-FLAGS.
 22806
 22807     IF EMI-FATAL-CTR NOT = ZEROS
 22808        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22809        MOVE 'X'                 TO PB-FATAL-FLAG
 22810                                    PI-ERRORS-SW
 22811        GO TO 7355-SET-ERROR-FLAGS.
 22812
 22813     move ' ' to pi-unforced-sw
 22814     IF EMI-FORCABLE-CTR NOT = ZEROS
 22815        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22816        IF PB-ISSUE
 22817           IF PB-ISSUE-FORCE
 22818              MOVE 'F'           TO PB-FORCE-ER-CD
 22819              MOVE ER-2600       TO EMI-ERROR
 22820              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22821             ELSE
 22822              MOVE 'X'           TO PB-FORCE-ER-CD
 22823*                                   PI-ERRORS-SW
 22824          ELSE
 22825           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 22826              MOVE 'F'           TO PB-FORCE-ER-CD
 22827                                    pi-unforced-sw
 22828              MOVE ER-2600       TO EMI-ERROR
 22829              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22830             ELSE
 22831              MOVE 'X'           TO PB-FORCE-ER-CD
 22832                                    pi-unforced-sw.
 22833*                                   PI-ERRORS-SW.
 22834
 22835     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 22836     IF PB-ISSUE
 22837         MOVE 'I'                TO ENDT-RECORD-TYPE
 22838     ELSE
 22839         MOVE 'C'                TO ENDT-RECORD-TYPE
 22840     END-IF
 22841     MOVE +0                     TO ENDT-SEQ-NO
 22842
 22843
 22844* EXEC CICS READ
 22845*        DATASET   (FILE-ID-ERENDT)
 22846*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 22847*        RIDFLD    (ERENDT-KEY)
 22848*        RESP      (WS-RESPONSE)
 22849*        GTEQ
 22850*    END-EXEC
 22851*    MOVE '&"S        G          (  N#00019076' TO DFHEIV0
 22852     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22853     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22854     MOVE X'204E233030303139303736' TO DFHEIV0(25:11)
 22855     CALL 'kxdfhei1' USING DFHEIV0,
 22856           FILE-ID-ERENDT,
 22857           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 420
* VP6311.cbl
 22858           DFHEIV99,
 22859           ERENDT-KEY,
 22860           DFHEIV99,
 22861           DFHEIV99,
 22862           DFHEIV99
 22863     SET ADDRESS OF ENDORSEMENT-RECORD TO
 22864         DFHEIV20
 22865     MOVE EIBRESP  TO WS-RESPONSE
 22866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22867
 22868     IF RESP-NORMAL
 22869        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 22870        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 22871            MOVE ER-0280          TO EMI-ERROR
 22872            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22873            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 22874            EVALUATE TRUE
 22875              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 22876                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 22877              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 22878                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 22879              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 22880                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 22881            END-EVALUATE
 22882        END-IF
 22883     END-IF
 22884
 22885
 22886
 22887     IF FIRST-ENTRY OR
 22888        EIBAID = DFHPF1 OR DFHPF2
 22889        MOVE '0'                TO PI-EDIT-SW
 22890        GO TO 7399-EXIT.
 22891
 22892 7355-SET-ERROR-FLAGS.
 22893
 22894     IF EMI-WARNING-CTR NOT = ZEROS
 22895        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22896        MOVE 'W'                 TO PB-WARN-ER-CD.
 22897
 22898     IF PB-UNFORCED-ERRORS OR
 22899        PB-FATAL-ERRORS    OR
 22900        PB-RECORD-ON-HOLD  OR
 22901        PB-RECORD-RETURNED OR
 22902        PB-CANCELLATION
 22903          NEXT SENTENCE
 22904        ELSE
 22905          GO TO 7399-EXIT.
 22906
 22907
 22908* EXEC CICS  HANDLE CONDITION
 22909*           NOTFND   (7399-EXIT)
 22910*    END-EXEC.
 22911*    MOVE '"$I                   ! Z #00019123' TO DFHEIV0
 22912     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22913     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22914     MOVE X'5A20233030303139313233' TO DFHEIV0(25:11)
 22915     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 421
* VP6311.cbl
 22916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22917
 22918
 22919     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 22920     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 22921     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 22922     MOVE PB-SV-STATE            TO ELCERT-STATE.
 22923
 22924
 22925* EXEC CICS READ
 22926*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 22927*        DATASET (FILE-ID-ELCERT)
 22928*        RIDFLD  (ELCERT-KEY)
 22929*        UPDATE
 22930*    END-EXEC.
 22931*    MOVE '&"S        EU         (   #00019132' TO DFHEIV0
 22932     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22933     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22934     MOVE X'2020233030303139313332' TO DFHEIV0(25:11)
 22935     CALL 'kxdfhei1' USING DFHEIV0,
 22936           FILE-ID-ELCERT,
 22937           DFHEIV20,
 22938           DFHEIV99,
 22939           ELCERT-KEY,
 22940           DFHEIV99,
 22941           DFHEIV99,
 22942           DFHEIV99
 22943     SET ADDRESS OF CERTIFICATE-MASTER TO
 22944         DFHEIV20
 22945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22946
 22947
 22948
 22949     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 22950     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 22951
 22952     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 22953        GO TO 7360-REWRITE-CERT-MASTER.
 22954
 22955     IF PB-ISSUE
 22956        IF PB-RECORD-RETURNED
 22957            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 22958            GO TO 7360-REWRITE-CERT-MASTER
 22959        ELSE
 22960            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 22961            GO TO 7360-REWRITE-CERT-MASTER.
 22962
 22963     IF PB-RECORD-RETURNED
 22964         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 22965         GO TO 7360-REWRITE-CERT-MASTER.
 22966
 22967     IF (PB-C-LF-CANCEL-VOIDED)
 22968        or (pb-c-ah-cancel-voided)
 22969        IF (PB-UNFORCED-ERRORS OR
 22970            PB-FATAL-ERRORS    OR
 22971            PB-RECORD-ON-HOLD)
 22972            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 22973            GO TO 7360-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 422
* VP6311.cbl
 22974        ELSE
 22975            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 22976            GO TO 7360-REWRITE-CERT-MASTER.
 22977
 22978     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 22979                            OR PB-RECORD-ON-HOLD)
 22980        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 22981     ELSE
 22982        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 22983
 22984 7360-REWRITE-CERT-MASTER.
 22985
 22986     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 22987        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 22988
 22989* EXEC CICS UNLOCK
 22990*            DATASET    (FILE-ID-ELCERT)
 22991*       END-EXEC
 22992*    MOVE '&*                    #   #00019179' TO DFHEIV0
 22993     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22994     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22995     MOVE X'2020233030303139313739' TO DFHEIV0(25:11)
 22996     CALL 'kxdfhei1' USING DFHEIV0,
 22997           FILE-ID-ELCERT,
 22998           DFHEIV99
 22999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23000        GO TO 7399-EXIT.
 23001
 23002
 23003* EXEC CICS REWRITE
 23004*         DATASET    (FILE-ID-ELCERT)
 23005*         FROM       (CERTIFICATE-MASTER)
 23006*    END-EXEC.
 23007     MOVE LENGTH OF
 23008      CERTIFICATE-MASTER
 23009       TO DFHEIV11
 23010*    MOVE '&& L                  %   #00019184' TO DFHEIV0
 23011     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23012     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23013     MOVE X'2020233030303139313834' TO DFHEIV0(25:11)
 23014     CALL 'kxdfhei1' USING DFHEIV0,
 23015           FILE-ID-ELCERT,
 23016           CERTIFICATE-MASTER,
 23017           DFHEIV11,
 23018           DFHEIV99
 23019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23020
 23021
 23022 7399-EXIT.
 23023      EXIT.
 23024
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 423
* VP6311.cbl
 23026
 23027*************************************************************
 23028*                                                           *
 23029*              S E T   A T T R I B U T E S                  *
 23030*                                                           *
 23031*************************************************************
 23032
 23033 7400-SET-ATTRIBUTES.
 23034
 23035     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23036        GO TO 7499-EXIT.
 23037
 23038**2601**
 23039
 23040     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23041        IF PB-ISSUE
 23042           MOVE AL-UABON         TO BEFFDTA
 23043           GO TO 7499-EXIT
 23044         ELSE
 23045           MOVE AL-UABON         TO CEFFDTA
 23046           GO TO 7499-EXIT.
 23047
 23048**2604**
 23049
 23050     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23051        IF PB-ISSUE
 23052           MOVE AL-UABON         TO BTYPE1A
 23053           MOVE -1               TO BTYPE1L
 23054           MOVE  1               TO SET-CURSOR-SW
 23055           GO TO 7499-EXIT.
 23056
 23057**2605**
 23058
 23059     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23060        IF PB-ISSUE
 23061           MOVE AL-UABON         TO BTYPE2A
 23062           MOVE -1               TO BTYPE2L
 23063           MOVE  1               TO SET-CURSOR-SW
 23064           GO TO 7499-EXIT.
 23065
 23066**2606**
 23067
 23068     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23069        IF PB-ISSUE
 23070           MOVE AL-UABON         TO BSIGA
 23071           MOVE -1               TO BSIGL
 23072           MOVE  1               TO SET-CURSOR-SW
 23073           GO TO 7499-EXIT.
 23074
 23075**2607**
 23076
 23077     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23078        IF PB-ISSUE
 23079           MOVE AL-UABON         TO BSIGA
 23080           MOVE -1               TO BSIGL
 23081           MOVE  1               TO SET-CURSOR-SW
 23082           GO TO 7499-EXIT.
 23083
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 424
* VP6311.cbl
 23084**2615**
 23085
 23086     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23087        IF PB-ISSUE
 23088           MOVE AL-UABOF         TO BREINA
 23089           MOVE -1               TO BREINL
 23090           GO TO 7499-EXIT.
 23091
 23092**2622**
 23093
 23094     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23095        IF PB-ISSUE
 23096           MOVE AL-UABON         TO BEFFDTA
 23097           GO TO 7499-EXIT
 23098        ELSE
 23099           MOVE AL-UABON         TO CEFFDTA
 23100           GO TO 7499-EXIT.
 23101
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 425
* VP6311.cbl
 23103
 23104*************************************************************
 23105*                                                           *
 23106*              I S S U E   E R R O R S                      *
 23107*                                                           *
 23108*************************************************************
 23109
 23110 7420-ISSUE-ERRORS.
 23111
 23112**2626**
 23113
 23114     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23115        MOVE AL-UABON            TO BCERTNOA
 23116        GO TO 7499-EXIT.
 23117
 23118**2627**
 23119
 23120     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23121        MOVE AL-UNBON            TO BAGEA
 23122        MOVE -1                  TO BAGEL
 23123        MOVE  1                  TO SET-CURSOR-SW
 23124        GO TO 7499-EXIT.
 23125
 23126**2628**
 23127
 23128     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23129        MOVE AL-UNBON            TO BAGEA
 23130        MOVE -1                  TO BAGEL
 23131        MOVE  1                  TO SET-CURSOR-SW
 23132        GO TO 7499-EXIT.
 23133
 23134**2629**
 23135
 23136     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23137        MOVE AL-UABON            TO BSEXA
 23138        MOVE -1                  TO BSEXL
 23139        MOVE  1                  TO SET-CURSOR-SW
 23140        GO TO 7499-EXIT.
 23141
 23142**2630**
 23143
 23144     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23145        MOVE -1                  TO BTYPE1L
 23146        MOVE  1                  TO SET-CURSOR-SW
 23147        GO TO 7499-EXIT.
 23148
 23149**2631**
 23150
 23151     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23152        MOVE -1                  TO BTYPE1L
 23153        MOVE  1                  TO SET-CURSOR-SW
 23154        GO TO 7499-EXIT.
 23155
 23156**2632**
 23157
 23158     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23159        MOVE AL-UNBON            TO BBEN1A
 23160        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 426
* VP6311.cbl
 23161        MOVE  1                  TO SET-CURSOR-SW
 23162        GO TO 7499-EXIT.
 23163
 23164**2633**
 23165
 23166     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23167        MOVE AL-UNBON            TO BPREM1A
 23168        MOVE -1                  TO BPREM1L
 23169        MOVE  1                  TO SET-CURSOR-SW
 23170        GO TO 7499-EXIT.
 23171
 23172**2634**
 23173
 23174     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23175        MOVE -1                  TO BTYPE2L
 23176        MOVE  1                  TO SET-CURSOR-SW
 23177        GO TO 7499-EXIT.
 23178
 23179**2635**
 23180
 23181     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23182        MOVE AL-UNBON            TO BBEN2A
 23183        MOVE -1                  TO BBEN2L
 23184        MOVE  1                  TO SET-CURSOR-SW
 23185        GO TO 7499-EXIT.
 23186
 23187**2636**
 23188
 23189     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23190        MOVE AL-UNBON            TO BPREM2A
 23191        MOVE -1                  TO BPREM2L
 23192        MOVE  1                  TO SET-CURSOR-SW
 23193        GO TO 7499-EXIT.
 23194
 23195**2639**
 23196
 23197     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23198        MOVE AL-UNBON            TO BBEN1A
 23199        MOVE -1                  TO BBEN1L
 23200        MOVE  1                  TO SET-CURSOR-SW
 23201        GO TO 7499-EXIT.
 23202
 23203**2640**
 23204
 23205     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23206        MOVE AL-UNBON            TO BBEN2A
 23207        MOVE -1                  TO BBEN2L
 23208        MOVE  1                  TO SET-CURSOR-SW
 23209        GO TO 7499-EXIT.
 23210
 23211**2647**
 23212
 23213     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23214        MOVE AL-UNBON            TO BTERM1A
 23215        MOVE -1                  TO BTERM1L
 23216        MOVE  1                  TO SET-CURSOR-SW
 23217        GO TO 7499-EXIT.
 23218
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 427
* VP6311.cbl
 23219
 23220**2649**
 23221
 23222     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23223        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23224            MOVE AL-UNBON            TO BPREM1A
 23225            MOVE -1                  TO BPREM1L
 23226            MOVE  1                  TO SET-CURSOR-SW
 23227            GO TO 7499-EXIT
 23228     ELSE
 23229        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23230           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23231            MOVE AL-UNBON            TO BPREM2A
 23232            MOVE -1                  TO BPREM2L
 23233            MOVE  1                  TO SET-CURSOR-SW
 23234            GO TO 7499-EXIT.
 23235
 23236**2650**
 23237
 23238     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23239        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23240            MOVE AL-UNBON        TO BPREM1A
 23241            MOVE -1              TO BPREM1L
 23242            MOVE  1              TO SET-CURSOR-SW
 23243            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23244                MOVE AL-UNBON        TO BPREM2A
 23245                MOVE -1              TO BPREM2L
 23246                MOVE  1              TO SET-CURSOR-SW
 23247                GO TO 7499-EXIT
 23248            ELSE
 23249                GO TO 7499-EXIT
 23250        ELSE
 23251            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23252                MOVE AL-UNBON        TO BPREM2A
 23253                MOVE -1              TO BPREM2L
 23254                MOVE  1              TO SET-CURSOR-SW
 23255                GO TO 7499-EXIT
 23256            ELSE
 23257                GO TO 7499-EXIT.
 23258
 23259**2651**
 23260
 23261     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23262        MOVE AL-UABON            TO BSIGA
 23263        MOVE -1                  TO BSIGL
 23264        MOVE  1                  TO SET-CURSOR-SW
 23265        GO TO 7499-EXIT.
 23266
 23267
 23268
 23269
 23270**2658**
 23271
 23272     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23273        MOVE AL-UNBON            TO BTERM2A
 23274        MOVE -1                  TO BTERM2L
 23275        MOVE  1                  TO SET-CURSOR-SW
 23276        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 428
* VP6311.cbl
 23277
 23278**2660**
 23279
 23280     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23281        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23282        MOVE -1                  TO BLSTNML
 23283        MOVE  1                  TO SET-CURSOR-SW
 23284        GO TO 7499-EXIT.
 23285
 23286
 23287**2662**
 23288
 23289     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23290        MOVE AL-UNBON            TO BAGEA
 23291        MOVE -1                  TO BAGEL
 23292        MOVE  1                  TO SET-CURSOR-SW
 23293        GO TO 7499-EXIT.
 23294
 23295**2663**
 23296
 23297     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23298        MOVE AL-UNBON            TO BAGEA
 23299        MOVE -1                  TO BAGEL
 23300        MOVE  1                  TO SET-CURSOR-SW
 23301        GO TO 7499-EXIT.
 23302
 23303**2664**
 23304
 23305     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23306        MOVE AL-UABON            TO BREINA
 23307        MOVE -1                  TO BREINL
 23308        MOVE  1                  TO SET-CURSOR-SW
 23309        GO TO 7499-EXIT.
 23310
 23311**2667**
 23312
 23313     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23314        MOVE AL-UNBON            TO BBEN2A
 23315        MOVE -1                  TO BBEN2L
 23316        MOVE  1                  TO SET-CURSOR-SW
 23317        GO TO 7499-EXIT.
 23318
 23319**2668**
 23320
 23321     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23322        MOVE AL-UABON            TO BEFFDTA
 23323        GO TO 7499-EXIT.
 23324
 23325**2669**
 23326
 23327     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23328       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23329       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23330        MOVE AL-UNBON            TO BAGEA
 23331        MOVE -1                  TO BAGEL
 23332        MOVE  1                  TO SET-CURSOR-SW
 23333        GO TO 7499-EXIT.
 23334
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 429
* VP6311.cbl
 23335**2670**
 23336
 23337     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23338        MOVE AL-UABON            TO BFORCEA
 23339        MOVE -1                  TO BFORCEL
 23340        MOVE  1                  TO SET-CURSOR-SW
 23341        GO TO 7499-EXIT.
 23342
 23343**2671**
 23344
 23345     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23346        MOVE AL-UABON            TO BEFFDTA
 23347        GO TO 7499-EXIT.
 23348
 23349**2672**
 23350
 23351     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23352        MOVE AL-UABON            TO BEFFDTA
 23353        GO TO 7499-EXIT.
 23354
 23355**2673**
 23356
 23357     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23358        MOVE AL-UABON            TO BEFFDTA
 23359        GO TO 7499-EXIT.
 23360
 23361**2674**
 23362
 23363     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23364        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23365        MOVE -1                  TO BTYPE1L
 23366        MOVE  1                  TO SET-CURSOR-SW
 23367        GO TO 7499-EXIT.
 23368
 23369**2677**
 23370
 23371     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23372        MOVE AL-UNBON            TO BTERM1A
 23373        MOVE -1                  TO BTERM1L
 23374        MOVE  1                  TO SET-CURSOR-SW
 23375        GO TO 7499-EXIT.
 23376
 23377**2678**
 23378
 23379     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23380        MOVE AL-UNBON            TO BTERM2A
 23381        MOVE -1                  TO BTERM2L
 23382        MOVE  1                  TO SET-CURSOR-SW
 23383        GO TO 7499-EXIT.
 23384
 23385**2679**
 23386
 23387     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23388        MOVE AL-UABON            TO BTYPE1A
 23389        MOVE -1                  TO BTYPE1L
 23390        MOVE  1                  TO SET-CURSOR-SW
 23391        GO TO 7499-EXIT.
 23392
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 430
* VP6311.cbl
 23393
 23394
 23395**2682**
 23396
 23397     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23398        MOVE AL-UABON            TO BTERM1A
 23399        MOVE -1                  TO BTERM1L
 23400        MOVE  1                  TO SET-CURSOR-SW
 23401        GO TO 7499-EXIT.
 23402
 23403**2683**
 23404
 23405     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23406        MOVE AL-UABON            TO BSKPCDA
 23407        MOVE -1                  TO BSKPCDL
 23408        MOVE  1                  TO SET-CURSOR-SW
 23409        GO TO 7499-EXIT.
 23410
 23411**2684**
 23412
 23413     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23414        MOVE AL-UABON            TO BTYPE2A
 23415        MOVE -1                  TO BTYPE2L
 23416        MOVE  1                  TO SET-CURSOR-SW
 23417        GO TO 7499-EXIT.
 23418
 23419**2686**
 23420
 23421     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23422        MOVE AL-UABON            TO BTYPE2A
 23423        MOVE -1                  TO BTYPE2L
 23424        MOVE  1                  TO SET-CURSOR-SW
 23425        GO TO 7499-EXIT.
 23426
 23427**2689**
 23428
 23429     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23430        MOVE AL-UABON            TO BSIGA
 23431        MOVE -1                  TO BSIGL
 23432        MOVE  1                  TO SET-CURSOR-SW
 23433        GO TO 7499-EXIT.
 23434
 23435**2690**
 23436
 23437     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23438        MOVE AL-UABOF            TO BLNOFCRA
 23439        MOVE -1                  TO BLNOFCRL
 23440        MOVE  1                  TO SET-CURSOR-SW
 23441        GO TO 7499-EXIT.
 23442
 23443**2693**
 23444
 23445     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23446        MOVE AL-UABOF            TO BLNOFCRA
 23447        MOVE AL-UNBON            TO BBEN1A
 23448        MOVE -1                  TO BBEN1L
 23449        MOVE  1                  TO SET-CURSOR-SW
 23450        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 431
* VP6311.cbl
 23451
 23452**2720**
 23453
 23454     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23455        MOVE AL-UNBON            TO BBEN1A
 23456        MOVE -1                  TO BBEN1L
 23457        MOVE  1                  TO SET-CURSOR-SW
 23458        GO TO 7499-EXIT.
 23459
 23460**2709**
 23461
 23462*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23463*       MOVE AL-UNBON            TO BBEN1A
 23464*       MOVE -1                  TO BBEN1L
 23465*       MOVE  1                  TO SET-CURSOR-SW
 23466*       GO TO 7499-EXIT.
 23467
 23468*************************************************************
 23469*                                                           *
 23470*            C A N C E L   E R R O R S                      *
 23471*                                                           *
 23472*************************************************************
 23473
 23474**2726**
 23475
 23476     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23477        MOVE AL-UABON            TO CCERTNOA
 23478        GO TO 7499-EXIT.
 23479
 23480**2728**
 23481
 23482     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23483        MOVE AL-UABON            TO CCERTNOA
 23484        GO TO 7499-EXIT.
 23485
 23486**2729**
 23487
 23488     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23489        MOVE AL-UABON            TO CCERTNOA
 23490        GO TO 7499-EXIT.
 23491
 23492**2730**
 23493
 23494     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23495        MOVE AL-UABON            TO CCERTNOA
 23496        GO TO 7499-EXIT.
 23497
 23498**2731**
 23499
 23500     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23501        MOVE AL-UABON            TO CCANDT1A
 23502        MOVE -1                  TO CCANDT1L
 23503        MOVE  1                  TO SET-CURSOR-SW
 23504        GO TO 7499-EXIT.
 23505
 23506**2732**
 23507
 23508     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 432
* VP6311.cbl
 23509        MOVE AL-UABON            TO CCANDT1A
 23510        MOVE -1                  TO CCANDT1L
 23511        MOVE  1                  TO SET-CURSOR-SW
 23512        GO TO 7499-EXIT.
 23513
 23514**2733**
 23515
 23516     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23517        MOVE AL-UABON            TO CCANDT1A
 23518        MOVE -1                  TO CCANDT1L
 23519        MOVE  1                  TO SET-CURSOR-SW
 23520        GO TO 7499-EXIT.
 23521
 23522**2734**
 23523
 23524     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23525        MOVE AL-UNBON            TO CREFND1A
 23526        MOVE -1                  TO CREFND1L
 23527        MOVE  1                  TO SET-CURSOR-SW
 23528        GO TO 7499-EXIT.
 23529
 23530**2735**
 23531
 23532     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23533        MOVE AL-UABON            TO CCANDT2A
 23534        MOVE -1                  TO CCANDT2L
 23535        MOVE  1                  TO SET-CURSOR-SW
 23536        GO TO 7499-EXIT.
 23537
 23538**2736**
 23539
 23540     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23541        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23542            MOVE AL-UNBON        TO CREFND1A
 23543            MOVE -1              TO CREFND1L
 23544            MOVE  1              TO SET-CURSOR-SW
 23545            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23546                MOVE AL-UNBON        TO CREFND2A
 23547                MOVE -1              TO CREFND2L
 23548                MOVE  1              TO SET-CURSOR-SW
 23549                GO TO 7499-EXIT
 23550            ELSE
 23551                GO TO 7499-EXIT
 23552        ELSE
 23553            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23554                MOVE AL-UNBON        TO CREFND2A
 23555                MOVE -1              TO CREFND2L
 23556                MOVE  1              TO SET-CURSOR-SW
 23557                GO TO 7499-EXIT
 23558            ELSE
 23559                GO TO 7499-EXIT.
 23560
 23561**2738**
 23562
 23563     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23564        MOVE -1                  TO CREFND2L
 23565        MOVE  1                  TO SET-CURSOR-SW
 23566        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 433
* VP6311.cbl
 23567
 23568**2739**
 23569
 23570     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23571        MOVE -1                  TO CREFND1L
 23572        MOVE  1                  TO SET-CURSOR-SW
 23573        GO TO 7499-EXIT.
 23574
 23575**2741**
 23576
 23577     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23578        MOVE -1                  TO CREFND1L
 23579        MOVE  1                  TO SET-CURSOR-SW
 23580        GO TO 7499-EXIT.
 23581
 23582**2743**
 23583
 23584     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23585        MOVE AL-UNBON            TO CCANDT1A
 23586        MOVE -1                  TO CCANDT1L
 23587        MOVE  1                  TO SET-CURSOR-SW
 23588        GO TO 7499-EXIT.
 23589
 23590**2744**
 23591
 23592     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23593        MOVE AL-UNBON            TO CCANDT2A
 23594        MOVE -1                  TO CCANDT2L
 23595        MOVE  1                  TO SET-CURSOR-SW
 23596        GO TO 7499-EXIT.
 23597
 23598**2747**
 23599
 23600     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23601        MOVE AL-UABON            TO CLSTNMA
 23602        MOVE -1                  TO CLSTNML
 23603        MOVE  1                  TO SET-CURSOR-SW
 23604        GO TO 7499-EXIT.
 23605
 23606**2749**
 23607
 23608     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23609        MOVE AL-UABON            TO CFORCEA
 23610        MOVE -1                  TO CFORCEL
 23611        MOVE  1                  TO SET-CURSOR-SW
 23612        GO TO 7499-EXIT.
 23613
 23614**2753**
 23615
 23616     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23617        MOVE AL-UNBON            TO CCANDT1A
 23618        MOVE -1                  TO CCANDT1L
 23619        MOVE  1                  TO SET-CURSOR-SW
 23620        GO TO 7499-EXIT.
 23621
 23622**2755**
 23623
 23624     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 434
* VP6311.cbl
 23625        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23626            MOVE AL-UNBON        TO CREFND1A
 23627            MOVE -1              TO CREFND1L
 23628            MOVE  1              TO SET-CURSOR-SW
 23629            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23630                MOVE AL-UNBON        TO CREFND2A
 23631                MOVE -1              TO CREFND2L
 23632                MOVE  1              TO SET-CURSOR-SW
 23633                GO TO 7499-EXIT
 23634            ELSE
 23635                GO TO 7499-EXIT
 23636        ELSE
 23637            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23638                MOVE AL-UNBON        TO CREFND2A
 23639                MOVE -1              TO CREFND2L
 23640                MOVE  1              TO SET-CURSOR-SW
 23641            ELSE
 23642                GO TO 7499-EXIT.
 23643
 23644**2757**
 23645
 23646     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23647        MOVE AL-UNBON            TO CLIVESA
 23648        MOVE -1                  TO CLIVESL
 23649        MOVE  1                  TO SET-CURSOR-SW
 23650        GO TO 7499-EXIT.
 23651
 23652**2771**
 23653
 23654     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23655        MOVE AL-UABON            TO CCANDT2A
 23656        MOVE -1                  TO CCANDT2L
 23657        MOVE  1                  TO SET-CURSOR-SW
 23658        GO TO 7499-EXIT.
 23659
 23660**2774**
 23661
 23662     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23663        MOVE AL-UABON            TO CCANDT1A
 23664        MOVE -1                  TO CCANDT1L
 23665        MOVE  1                  TO SET-CURSOR-SW
 23666        GO TO 7499-EXIT.
 23667
 23668**2775**
 23669
 23670     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23671        MOVE AL-UABON            TO CCANDT2A
 23672        MOVE -1                  TO CCANDT2L
 23673        MOVE  1                  TO SET-CURSOR-SW
 23674        GO TO 7499-EXIT.
 23675
 23676**2776**
 23677
 23678     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23679        MOVE AL-UABON            TO CCANDT1A
 23680        MOVE -1                  TO CCANDT1L
 23681        MOVE  1                  TO SET-CURSOR-SW
 23682        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 435
* VP6311.cbl
 23683
 23684
 23685**2777**
 23686
 23687     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23688        MOVE AL-UABON            TO CCANDT2A
 23689        MOVE -1                  TO CCANDT2L
 23690        MOVE  1                  TO SET-CURSOR-SW
 23691        GO TO 7499-EXIT.
 23692
 23693**2794**
 23694
 23695     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23696        MOVE AL-UABON            TO CFORCEA
 23697        MOVE -1                  TO CFORCEL
 23698        MOVE  1                  TO SET-CURSOR-SW
 23699        GO TO 7499-EXIT.
 23700
 23701**2799**
 23702
 23703     IF PI-COMPANY-ID = 'UCL'
 23704         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23705             MOVE AL-UNBON            TO BEFFDTA
 23706             MOVE -1                  TO BEFFDTL
 23707             MOVE  1                  TO SET-CURSOR-SW
 23708             GO TO 7499-EXIT.
 23709
 23710 7499-EXIT.
 23711      EXIT.
 23712
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 436
* VP6311.cbl
 23714
 23715 7500-READ-ERLOFC.
 23716     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23717                                     ERLOFC-KEY.
 23718
 23719     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23720
 23721     IF ST-ACCNT-CNTL
 23722         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23723
 23724     IF CARR-GROUP-ST-ACCNT-CNTL
 23725         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23726         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23727         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23728
 23729     IF CARR-ST-ACCNT-CNTL
 23730         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23731         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23732
 23733     IF CARR-ACCNT-CNTL
 23734         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23735
 23736     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23737
 23738     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23739
 23740
 23741* EXEC CICS HANDLE CONDITION
 23742*        NOTFND   (7550-OFFICER-NOTFND)
 23743*    END-EXEC.
 23744*    MOVE '"$I                   ! [ #00019907' TO DFHEIV0
 23745     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23746     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23747     MOVE X'5B20233030303139393037' TO DFHEIV0(25:11)
 23748     CALL 'kxdfhei1' USING DFHEIV0
 23749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23750
 23751
 23752
 23753* EXEC CICS READ
 23754*        DATASET   (FILE-ID-ERLOFC)
 23755*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 23756*        RIDFLD    (ERLOFC-KEY)
 23757*        EQUAL
 23758*    END-EXEC.
 23759*    MOVE '&"S        E          (   #00019911' TO DFHEIV0
 23760     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23761     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23762     MOVE X'2020233030303139393131' TO DFHEIV0(25:11)
 23763     CALL 'kxdfhei1' USING DFHEIV0,
 23764           FILE-ID-ERLOFC,
 23765           DFHEIV20,
 23766           DFHEIV99,
 23767           ERLOFC-KEY,
 23768           DFHEIV99,
 23769           DFHEIV99,
 23770           DFHEIV99
 23771     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 437
* VP6311.cbl
 23772         DFHEIV20
 23773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23774
 23775
 23776     GO TO 7599-EXIT.
 23777
 23778 7550-OFFICER-NOTFND.
 23779     MOVE 'X'                    TO WS-LOAN-OFFICER.
 23780
 23781 7599-EXIT.
 23782      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 438
* VP6311.cbl
 23784******************************************************************
 23785*                                                                *
 23786*            S  E N D    I N I T I A L   M A P                   *
 23787*                                                                *
 23788******************************************************************
 23789
 23790 8100-SEND-INITIAL-MAP.
 23791     MOVE EIBTIME                TO TIME-IN.
 23792
 23793     IF EIBAID = DFHPF11
 23794        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 23795        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23796
 23797
 23798     IF PI-COMPANY-ID = CLIENT-GIC
 23799        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23800                                       BCPREM-ATTRB (2).
 23801
 23802     IF PI-COMPANY-ID = (CLIENT-MIC OR
 23803                         CLIENT-PEM OR
 23804                         CLIENT-CSO)
 23805        AND PI-DISPLAY-ORIGINAL-BATCH
 23806          IF PI-MAP-NAME = VP631B
 23807             MOVE AL-SADOF               TO BPF5HDRA
 23808                                            BPF4HDRA
 23809          ELSE
 23810             IF PI-MAP-NAME = VP631C
 23811                MOVE AL-SADOF            TO CPF5HDRA
 23812                                            CPF4HDRA.
 23813
 23814     IF PI-MAP-NAME = VP631B
 23815        MOVE AL-SADOF               TO BPF5HDRA
 23816     ELSE
 23817        MOVE AL-SADOF               TO CPF5HDRA
 23818     END-IF
 23819
 23820
 23821     IF PI-PROCESSOR-ID = 'LGXX'
 23822        IF PI-MAP-NAME = VP631B
 23823           MOVE AL-SABOF                    TO BREFHDGA
 23824           MOVE AL-SANOF                    TO BREFA
 23825        ELSE
 23826           IF PI-MAP-NAME = VP631C
 23827              MOVE AL-SABOF                 TO CREFHDGA
 23828              MOVE AL-SANOF                 TO CREFA.
 23829
 23830     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
 23831        continue
 23832     ELSE
 23833        IF PI-MAP-NAME = VP631C
 23834           MOVE AL-SADOF         TO CCANTXTA
 23835                                    CCANFEEA
 23836        end-if
 23837     end-if
 23838     IF PI-MAP-NAME = VP631D
 23839        IF PI-AR-PROCESSING
 23840           MOVE AL-SANOF            TO DREFHDGA
 23841        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 439
* VP6311.cbl
 23842           MOVE AL-SADOF            TO DREFHDGA.
 23843
 23844     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
 23845        AND (PI-MAP-NAME = VP631B)
 23846        MOVE AL-SADOF            TO BVINHA
 23847                                    BVINA
 23848     END-IF
 23849     IF PI-MAP-NAME = VP631B
 23850        MOVE PI-COMPANY-ID          TO BCOMPIDO
 23851        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 23852                                 TO BREGIONO
 23853        MOVE PI-PROCESSOR-ID     TO BUSERO
 23854        IF CSR-EDIT-SESSION
 23855           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23856                                 TO BHEADO
 23857           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 23858        ELSE
 23859           MOVE AL-SADOF         TO BF15HDRA
 23860           MOVE '4=B-HDR      '  TO BPF4HDRO
 23861        END-IF
 23862        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23863        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 23864        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 23865        MOVE WS-CURRENT-DT          TO BDATEO
 23866        MOVE TIME-OUT               TO BTIMEO
 23867        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23868        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23869        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23870        IF   WS-DISPLAY-SCREEN
 23871             MOVE PB-ENTRY-BATCH    TO BBATCHO
 23872             MOVE PB-SV-CARRIER     TO BCARRO
 23873             MOVE PB-SV-GROUPING    TO BGROUPO
 23874             MOVE PB-SV-STATE       TO BSTATEO
 23875             MOVE PB-ACCOUNT        TO BACCTO
 23876        ELSE
 23877             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 23878     ELSE
 23879        IF PI-MAP-NAME = VP631C
 23880           MOVE '4=B-HDR      '     TO CPF4HDRO
 23881           IF CSR-EDIT-SESSION
 23882              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23883                                 TO CHEADO
 23884           ELSE
 23885              MOVE AL-SADOF      TO CF15HDRA
 23886           END-IF
 23887           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 23888           MOVE WS-CURRENT-DT          TO CDATEO
 23889           MOVE TIME-OUT               TO CTIMEO
 23890           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 23891           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 23892           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 23893           MOVE WS-C-HDG               TO CLFHDGO
 23894           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 23895           MOVE WS-C-HDG               TO CAHHDGO
 23896           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23897           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 23898           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23899           IF   WS-DISPLAY-SCREEN
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 440
* VP6311.cbl
 23900                MOVE PB-ENTRY-BATCH    TO CBATCHO
 23901                MOVE PB-SV-CARRIER     TO CCARRO
 23902                MOVE PB-SV-GROUPING    TO CGROUPO
 23903                MOVE PB-SV-STATE       TO CSTATEO
 23904                MOVE PB-ACCOUNT        TO CACCTO
 23905           ELSE
 23906                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 23907        ELSE
 23908           MOVE WS-CURRENT-DT          TO DDATEO
 23909           MOVE TIME-OUT               TO DTIMEO
 23910           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 23911                                          WS-REFUND-HDG-OVERRIDE
 23912           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 23913           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 23914           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 23915                                          WS-REFUND-HDG-OVERRIDE
 23916           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 23917           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 23918           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 23919           IF CSR-EDIT-SESSION
 23920              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23921                                 TO DHEADO
 23922           END-IF
 23923           IF  WS-DISPLAY-SCREEN
 23924               MOVE PB-ENTRY-BATCH     TO DBATCHO
 23925               MOVE PB-CARRIER         TO DCARRO
 23926               MOVE PB-GROUPING        TO DGROUPO
 23927               MOVE PB-STATE           TO DSTATEO
 23928               MOVE PB-ACCOUNT         TO DACCTO
 23929               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 23930           ELSE
 23931               MOVE VP631D             TO PI-MAP-NAME
 23932               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 23933               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 23934
 23935     MOVE SPACE                        TO WS-DISPLAY-SW.
 23936
 23937
 23938* EXEC CICS SEND
 23939*        MAP      (PI-MAP-NAME)
 23940*        MAPSET   (MAPSET-VP6311S)
 23941*        FROM     (VP631BI)
 23942*        ERASE
 23943*        CURSOR
 23944*    END-EXEC.
 23945     MOVE LENGTH OF
 23946      VP631BI
 23947       TO DFHEIV12
 23948     MOVE -1
 23949       TO DFHEIV11
 23950*    MOVE '8$     CT  E    H L F ,   #00020079' TO DFHEIV0
 23951     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 23952     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23953     MOVE X'2020233030303230303739' TO DFHEIV0(25:11)
 23954     CALL 'kxdfhei1' USING DFHEIV0,
 23955           PI-MAP-NAME,
 23956           VP631BI,
 23957           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 441
* VP6311.cbl
 23958           MAPSET-VP6311S,
 23959           DFHEIV99,
 23960           DFHEIV99,
 23961           DFHEIV99,
 23962           DFHEIV11,
 23963           DFHEIV99,
 23964           DFHEIV99,
 23965           DFHEIV99
 23966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23967
 23968
 23969     GO TO 9100-RETURN-TRAN.
 23970
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 442
* VP6311.cbl
 23972
 23973******************************************************************
 23974*                                                                *
 23975*              S E N D    D A T A O N L Y                        *
 23976*                                                                *
 23977******************************************************************
 23978
 23979 8200-SEND-DATAONLY.
 23980     MOVE EIBTIME                TO TIME-IN.
 23981
 23982     IF PI-COMPANY-ID = CLIENT-GIC
 23983        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23984                                       BCPREM-ATTRB (2).
 23985
 23986     IF PI-MAP-NAME = VP631B
 23987        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23988        MOVE WS-CURRENT-DT          TO BDATEO
 23989        MOVE TIME-OUT               TO BTIMEO
 23990        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23991        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23992        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23993        MOVE SPACES                 TO BPFENTRO
 23994        MOVE AL-UANOF               TO BPFENTRA
 23995
 23996     ELSE
 23997        IF PI-MAP-NAME = VP631C
 23998           MOVE WS-CURRENT-DT          TO CDATEO
 23999           MOVE TIME-OUT               TO CTIMEO
 24000           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24001           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24002           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24003           MOVE SPACES                 TO CPFENTRO
 24004           MOVE AL-UANOF               TO CPFENTRA
 24005        ELSE
 24006           MOVE WS-CURRENT-DT          TO DDATEO
 24007           MOVE TIME-OUT               TO DTIMEO
 24008           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24009
 24010
 24011* EXEC CICS SEND
 24012*        MAP      (PI-MAP-NAME)
 24013*        MAPSET   (MAPSET-VP6311S)
 24014*        FROM     (VP631BI)
 24015*        DATAONLY
 24016*        CURSOR
 24017*    END-EXEC.
 24018     MOVE LENGTH OF
 24019      VP631BI
 24020       TO DFHEIV12
 24021     MOVE -1
 24022       TO DFHEIV11
 24023*    MOVE '8$D    CT       H L F ,   #00020128' TO DFHEIV0
 24024     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24025     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24026     MOVE X'2020233030303230313238' TO DFHEIV0(25:11)
 24027     CALL 'kxdfhei1' USING DFHEIV0,
 24028           PI-MAP-NAME,
 24029           VP631BI,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 443
* VP6311.cbl
 24030           DFHEIV12,
 24031           MAPSET-VP6311S,
 24032           DFHEIV99,
 24033           DFHEIV99,
 24034           DFHEIV99,
 24035           DFHEIV11,
 24036           DFHEIV99,
 24037           DFHEIV99,
 24038           DFHEIV99
 24039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24040
 24041
 24042     GO TO 9100-RETURN-TRAN.
 24043
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 444
* VP6311.cbl
 24045
 24046******************************************************************
 24047*                                                                *
 24048*           U T I L I T Y   R O U T I N E S                      *
 24049*                                                                *
 24050******************************************************************
 24051
 24052 8300-SEND-TEXT.
 24053
 24054* EXEC CICS SEND TEXT
 24055*        FROM     (LOGOFF-TEXT)
 24056*        LENGTH   (LOGOFF-LENGTH)
 24057*        ERASE
 24058*        FREEKB
 24059*    END-EXEC.
 24060*    MOVE '8&      T  E F  H   F -   #00020147' TO DFHEIV0
 24061     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24062     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24063     MOVE X'2020233030303230313437' TO DFHEIV0(25:11)
 24064     CALL 'kxdfhei1' USING DFHEIV0,
 24065           LOGOFF-TEXT,
 24066           LOGOFF-LENGTH,
 24067           DFHEIV99,
 24068           DFHEIV99,
 24069           DFHEIV99,
 24070           DFHEIV99,
 24071           DFHEIV99,
 24072           DFHEIV99,
 24073           DFHEIV99,
 24074           DFHEIV99,
 24075           DFHEIV99,
 24076           DFHEIV99
 24077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24078
 24079
 24080
 24081* EXEC CICS RETURN
 24082*    END-EXEC.
 24083*    MOVE '.(                    ''   #00020154' TO DFHEIV0
 24084     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24085     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24086     MOVE X'2020233030303230313534' TO DFHEIV0(25:11)
 24087     CALL 'kxdfhei1' USING DFHEIV0,
 24088           DFHEIV99,
 24089           DFHEIV99,
 24090           DFHEIV99,
 24091           DFHEIV99,
 24092           DFHEIV99,
 24093           DFHEIV99
 24094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24095
 24096
 24097 8400-LOG-JOURNAL-RECORD.
 24098     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24099     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24100
 24101*    EXEC CICS JOURNAL
 24102*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 445
* VP6311.cbl
 24103*        JTYPEID     ('EL')
 24104*        FROM        (JOURNAL-RECORD)
 24105*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24106*    END-EXEC.
 24107
 24108 8600-DEEDIT.
 24109
 24110* EXEC CICS BIF DEEDIT
 24111*         FIELD   (DEEDIT-FIELD)
 24112*         LENGTH  (15)
 24113*    END-EXEC.
 24114     MOVE 15
 24115       TO DFHEIV11
 24116*    MOVE '@"L                   #   #00020169' TO DFHEIV0
 24117     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24118     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24119     MOVE X'2020233030303230313639' TO DFHEIV0(25:11)
 24120     CALL 'kxdfhei1' USING DFHEIV0,
 24121           DEEDIT-FIELD,
 24122           DFHEIV11
 24123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24124
 24125
 24126 8800-UNAUTHORIZED-ACCESS.
 24127     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24128     GO TO 8300-SEND-TEXT.
 24129
 24130 8810-PF23.
 24131     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24132     MOVE XCTL-EL005             TO PGM-NAME.
 24133     GO TO 9300-XCTL.
 24134
 24135 9100-RETURN-TRAN.
 24136     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24137
 24138     IF  PI-MAP-NAME =  VP631B
 24139         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24140
 24141     IF  PI-MAP-NAME =  VP631C
 24142         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24143
 24144     IF  PI-MAP-NAME =  VP631D
 24145         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24146
 24147
 24148* EXEC CICS RETURN
 24149*        TRANSID    (TRANS-EXB1)
 24150*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24151*        LENGTH     (1300)
 24152*    END-EXEC.
 24153     MOVE 1300
 24154       TO DFHEIV11
 24155*    MOVE '.(CT                  ''   #00020195' TO DFHEIV0
 24156     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24157     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24158     MOVE X'2020233030303230313935' TO DFHEIV0(25:11)
 24159     CALL 'kxdfhei1' USING DFHEIV0,
 24160           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 446
* VP6311.cbl
 24161           PROGRAM-INTERFACE-BLOCK,
 24162           DFHEIV11,
 24163           DFHEIV99,
 24164           DFHEIV99,
 24165           DFHEIV99
 24166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24167
 24168
 24169 9200-RETURN-MAIN-MENU.
 24170     MOVE XCTL-EL626             TO PGM-NAME.
 24171     GO TO 9300-XCTL.
 24172
 24173 9300-XCTL.
 24174
 24175* EXEC CICS XCTL
 24176*        PROGRAM    (PGM-NAME)
 24177*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24178*        LENGTH     (PI-COMM-LENGTH)
 24179*    END-EXEC.
 24180*    MOVE '.$C                   %   #00020206' TO DFHEIV0
 24181     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24182     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24183     MOVE X'2020233030303230323036' TO DFHEIV0(25:11)
 24184     CALL 'kxdfhei1' USING DFHEIV0,
 24185           PGM-NAME,
 24186           PROGRAM-INTERFACE-BLOCK,
 24187           PI-COMM-LENGTH,
 24188           DFHEIV99
 24189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24190
 24191
 24192 9400-CLEAR.
 24193     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24194     GO TO 9300-XCTL.
 24195
 24196 9500-PF12.
 24197     MOVE XCTL-EL010             TO PGM-NAME.
 24198     GO TO 9300-XCTL.
 24199
 24200 9600-PGMID-ERROR.
 24201
 24202* EXEC CICS HANDLE CONDITION
 24203*        PGMIDERR    (8300-SEND-TEXT)
 24204*    END-EXEC.
 24205*    MOVE '"$L                   ! \ #00020221' TO DFHEIV0
 24206     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24207     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24208     MOVE X'5C20233030303230323231' TO DFHEIV0(25:11)
 24209     CALL 'kxdfhei1' USING DFHEIV0
 24210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24211
 24212
 24213     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24214     MOVE ' '                    TO PI-ENTRY-CD-1.
 24215     MOVE XCTL-EL005             TO PGM-NAME.
 24216     MOVE PGM-NAME               TO LOGOFF-PGM.
 24217     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24218     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 447
* VP6311.cbl
 24219
 24220 9700-DATE-LINK.
 24221     MOVE LINK-ELDATCV           TO PGM-NAME.
 24222
 24223* EXEC CICS LINK
 24224*        PROGRAM    (PGM-NAME)
 24225*        COMMAREA   (DATE-CONVERSION-DATA)
 24226*        LENGTH     (DC-COMM-LENGTH)
 24227*    END-EXEC.
 24228*    MOVE '."C                   (   #00020234' TO DFHEIV0
 24229     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24230     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24231     MOVE X'2020233030303230323334' TO DFHEIV0(25:11)
 24232     CALL 'kxdfhei1' USING DFHEIV0,
 24233           PGM-NAME,
 24234           DATE-CONVERSION-DATA,
 24235           DC-COMM-LENGTH,
 24236           DFHEIV99,
 24237           DFHEIV99,
 24238           DFHEIV99,
 24239           DFHEIV99
 24240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24241
 24242
 24243 9800-LINK-PENDING-EDIT.
 24244     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24245     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24246
 24247     MOVE LINK-EL050             TO PGM-NAME
 24248     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24249     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24250                                    WK-CO-TOL-CLAIM
 24251                                    WK-CO-TOL-PREM
 24252                                    WK-CO-TOL-REFUND
 24253                                    WK-CO-TOL-PREM-PCT
 24254                                    WK-CO-TOL-REFUND-PCT
 24255                                    WK-REFUND-OVS-AMT
 24256                                    WK-REFUND-OVS-PCT
 24257                                    WK-ACCT-ADDR
 24258                                    WK-LIFE-EDIT-ADDR
 24259                                    WK-AH-EDIT-ADDR
 24260                                    WK-LIFE-BEN-ADDR
 24261                                    WK-AH-BEN-ADDR
 24262                                    WK-STATE-ADDR
 24263                                    WK-PLAN-ADDR
 24264                                    WK-FORM-ADDR
 24265     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24266
 24267     MOVE '6'                    TO WK-ENTRY-SW.
 24268
 24269     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24270
 24271     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24272                                    EC-AM-EXPIRATION-DT
 24273                                    EC-AM-EFFECTIVE-DT
 24274                                    EC-CM-LF-CANCEL-DT
 24275                                    EC-CM-AH-CANCEL-DT
 24276                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 448
* VP6311.cbl
 24277
 24278     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24279                                    EC-CO-TOL-REFUND
 24280                                    EC-CO-MIN-AGE
 24281                                    EC-CO-MIN-PREMIUM
 24282                                    EC-CO-MIN-TERM
 24283                                    EC-CO-MAX-TERM
 24284                                    EC-ST-TOL-PREM
 24285                                    EC-ST-TOL-REFUND
 24286                                    EC-AM-LF-TOL-PREM
 24287                                    EC-AM-AH-TOL-PREM
 24288                                    EC-AM-LF-MAX-ATT-AGE
 24289                                    EC-AM-LF-MAX-AGE
 24290                                    EC-AM-LF-MAX-TERM
 24291                                    EC-AM-LF-MAX-TOT-BEN
 24292                                    EC-AM-AH-MAX-ATT-AGE
 24293                                    EC-AM-AH-MAX-AGE
 24294                                    EC-AM-AH-MAX-TERM
 24295                                    EC-AM-AH-MAX-TOT-BEN
 24296                                    EC-AM-AH-MAX-MON-BEN
 24297                                    EC-RT-LF-MAX-ATT-AGE
 24298                                    EC-RT-LF-MAX-AGE
 24299                                    EC-RT-LF-MAX-TERM
 24300                                    EC-RT-LF-MAX-TOT-BEN
 24301                                    EC-RT-AH-MAX-ATT-AGE
 24302                                    EC-RT-AH-MAX-AGE
 24303                                    EC-RT-AH-MAX-TERM
 24304                                    EC-RT-AH-MAX-TOT-BEN
 24305                                    EC-RT-AH-MAX-MON-BEN
 24306                                    EC-RT-AH-RATE
 24307                                    EC-RT-LF-RATE
 24308                                    EC-RT-LF-NSP-RATE
 24309                                    EC-RT-AH-NSP-RATE
 24310                                    EC-CM-LF-PRIOR-REFUND
 24311                                    EC-CM-AH-PRIOR-REFUND.
 24312
 24313     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24314                                    EC-ST-TOL-PREM-PCT
 24315                                    EC-AM-LF-TOL-REFUND
 24316                                    EC-AM-LF-DEV-PERCENT
 24317                                    EC-CO-TOL-REFUND-PCT
 24318                                    EC-ST-TOL-REFUND-PCT
 24319                                    EC-AM-AH-TOL-REFUND
 24320                                    EC-AM-AH-DEV-PERCENT.
 24321
 24322
 24323* EXEC CICS LINK
 24324*         PROGRAM   (PGM-NAME)
 24325*         COMMAREA  (PASSED-RECORD)
 24326*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24327*    END-EXEC.
 24328*    MOVE '."C                   (   #00020319' TO DFHEIV0
 24329     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24330     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24331     MOVE X'2020233030303230333139' TO DFHEIV0(25:11)
 24332     CALL 'kxdfhei1' USING DFHEIV0,
 24333           PGM-NAME,
 24334           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 449
* VP6311.cbl
 24335           WS-EDIT-PASS-LENGTH,
 24336           DFHEIV99,
 24337           DFHEIV99,
 24338           DFHEIV99,
 24339           DFHEIV99
 24340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24341
 24342
 24343     MOVE '1'                    TO PI-EDIT-SW.
 24344     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24345
 24346     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24347
 24348     IF PI-COMPANY-ID = 'UCL'
 24349         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24350
 24351     IF VALID-PB-ID
 24352        GO TO 9800-EXIT.
 24353
 24354     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24355
 24356     IF PI-MAP-NAME = VP631B
 24357        MOVE -1                  TO BMAINTL
 24358       ELSE
 24359        MOVE -1                  TO CMAINTL.
 24360
 24361     GO TO 8200-SEND-DATAONLY.
 24362
 24363 9800-EXIT.
 24364      EXIT.
 24365
 24366 9900-ERROR-FORMAT.
 24367
 24368     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24369
 24370     IF NOT EMI-ERRORS-COMPLETE
 24371         MOVE LINK-EL001         TO PGM-NAME
 24372
 24373* EXEC CICS LINK
 24374*            PROGRAM    (PGM-NAME)
 24375*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24376*            LENGTH     (EMI-COMM-LENGTH)
 24377*        END-EXEC.
 24378*    MOVE '."C                   (   #00020354' TO DFHEIV0
 24379     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24380     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24381     MOVE X'2020233030303230333534' TO DFHEIV0(25:11)
 24382     CALL 'kxdfhei1' USING DFHEIV0,
 24383           PGM-NAME,
 24384           ERROR-MESSAGE-INTERFACE-BLOCK,
 24385           EMI-COMM-LENGTH,
 24386           DFHEIV99,
 24387           DFHEIV99,
 24388           DFHEIV99,
 24389           DFHEIV99
 24390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24391
 24392
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 450
* VP6311.cbl
 24393 9900-EXIT.
 24394     EXIT.
 24395
 24396 9990-ABEND.
 24397     MOVE LINK-EL004             TO PGM-NAME.
 24398     MOVE DFHEIBLK               TO EMI-LINE1.
 24399
 24400* EXEC CICS LINK
 24401*        PROGRAM   (PGM-NAME)
 24402*        COMMAREA  (EMI-LINE1)
 24403*        LENGTH    (72)
 24404*    END-EXEC.
 24405     MOVE 72
 24406       TO DFHEIV11
 24407*    MOVE '."C                   (   #00020366' TO DFHEIV0
 24408     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24409     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24410     MOVE X'2020233030303230333636' TO DFHEIV0(25:11)
 24411     CALL 'kxdfhei1' USING DFHEIV0,
 24412           PGM-NAME,
 24413           EMI-LINE1,
 24414           DFHEIV11,
 24415           DFHEIV99,
 24416           DFHEIV99,
 24417           DFHEIV99,
 24418           DFHEIV99
 24419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24420
 24421
 24422     IF PI-MAP-NAME = VP631B
 24423        MOVE -1                  TO BMAINTL
 24424       ELSE
 24425        MOVE -1                  TO CMAINTL.
 24426
 24427     IF EIBTRNID NOT = TRANS-EXB1
 24428        GO TO 8100-SEND-INITIAL-MAP
 24429       ELSE
 24430        GO TO 8200-SEND-DATAONLY.
 24431
 24432 9995-SECURITY-VIOLATION.
 24433*                            COPY ELCSCTP.
 24434******************************************************************
 24435*                                                                *
 24436*                            ELCSCTP                             *
 24437*                            VMOD=2.001                          *
 24438*                                                                *
 24439*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24440******************************************************************
 24441
 24442
 24443     MOVE EIBDATE          TO SM-JUL-DATE.
 24444     MOVE EIBTRMID         TO SM-TERMID.
 24445     MOVE THIS-PGM         TO SM-PGM.
 24446     MOVE EIBTIME          TO TIME-IN.
 24447     MOVE TIME-OUT         TO SM-TIME.
 24448     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24449
 24450
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 451
* VP6311.cbl
 24451* EXEC CICS LINK
 24452*         PROGRAM  ('EL003')
 24453*         COMMAREA (SECURITY-MESSAGE)
 24454*         LENGTH   (80)
 24455*    END-EXEC.
 24456     MOVE 'EL003' TO DFHEIV1
 24457     MOVE 80
 24458       TO DFHEIV11
 24459*    MOVE '."C                   (   #00020400' TO DFHEIV0
 24460     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24461     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24462     MOVE X'2020233030303230343030' TO DFHEIV0(25:11)
 24463     CALL 'kxdfhei1' USING DFHEIV0,
 24464           DFHEIV1,
 24465           SECURITY-MESSAGE,
 24466           DFHEIV11,
 24467           DFHEIV99,
 24468           DFHEIV99,
 24469           DFHEIV99,
 24470           DFHEIV99
 24471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24472
 24473
 24474******************************************************************
 24475
 24476
 24477 9999-DFHBACK SECTION.
 24478     MOVE '9%                    "   ' TO DFHEIV0
 24479     MOVE 'VP6311' TO DFHEIV1
 24480     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24481     GOBACK.
 24482 9999-DFHEXIT.
 24483     IF DFHEIGDJ EQUAL 0001
 24484         NEXT SENTENCE
 24485     ELSE IF DFHEIGDJ EQUAL 2
 24486         GO TO 9600-PGMID-ERROR,
 24487               9990-ABEND,
 24488               9990-ABEND,
 24489               0010-MAIN-LOGIC
 24490         DEPENDING ON DFHEIGDI
 24491     ELSE IF DFHEIGDJ EQUAL 3
 24492         GO TO 1280-BATCH-HDR-NOT-FOUND
 24493         DEPENDING ON DFHEIGDI
 24494     ELSE IF DFHEIGDJ EQUAL 4
 24495         GO TO 1290-DUPLICATE-ALT-INDEX
 24496         DEPENDING ON DFHEIGDI
 24497     ELSE IF DFHEIGDJ EQUAL 5
 24498         GO TO 1295-CERT-TRL-REC-NOTFND
 24499         DEPENDING ON DFHEIGDI
 24500     ELSE IF DFHEIGDJ EQUAL 6
 24501         GO TO 1380-BATCH-HDR-NOT-FOUND
 24502         DEPENDING ON DFHEIGDI
 24503     ELSE IF DFHEIGDJ EQUAL 7
 24504         GO TO 1385-REC-NOT-FOUND
 24505         DEPENDING ON DFHEIGDI
 24506     ELSE IF DFHEIGDJ EQUAL 8
 24507         GO TO 1386-NOTFND
 24508         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 452
* VP6311.cbl
 24509     ELSE IF DFHEIGDJ EQUAL 9
 24510         GO TO 1398-EXIT
 24511         DEPENDING ON DFHEIGDI
 24512     ELSE IF DFHEIGDJ EQUAL 10
 24513         GO TO 1480-BATCH-HDR-NOT-FOUND
 24514         DEPENDING ON DFHEIGDI
 24515     ELSE IF DFHEIGDJ EQUAL 11
 24516         GO TO 1490-RECORD-NOT-FOUND
 24517         DEPENDING ON DFHEIGDI
 24518     ELSE IF DFHEIGDJ EQUAL 12
 24519         GO TO 1405-DELETE-CERTIFICATE
 24520         DEPENDING ON DFHEIGDI
 24521     ELSE IF DFHEIGDJ EQUAL 13
 24522         GO TO 1420-CONTINUE-DELETE
 24523         DEPENDING ON DFHEIGDI
 24524     ELSE IF DFHEIGDJ EQUAL 14
 24525         GO TO 1406-DELETE-ERNOTE
 24526         DEPENDING ON DFHEIGDI
 24527     ELSE IF DFHEIGDJ EQUAL 15
 24528         GO TO 1407-DELETE-MAILING
 24529         DEPENDING ON DFHEIGDI
 24530     ELSE IF DFHEIGDJ EQUAL 16
 24531         GO TO 1420-CONTINUE-DELETE
 24532         DEPENDING ON DFHEIGDI
 24533     ELSE IF DFHEIGDJ EQUAL 17
 24534         GO TO 1480-BATCH-HDR-NOT-FOUND
 24535         DEPENDING ON DFHEIGDI
 24536     ELSE IF DFHEIGDJ EQUAL 18
 24537         GO TO 1475-DELETE-FINISHED
 24538         DEPENDING ON DFHEIGDI
 24539     ELSE IF DFHEIGDJ EQUAL 19
 24540         GO TO 2280-BATCH-HDR-NOT-FOUND
 24541         DEPENDING ON DFHEIGDI
 24542     ELSE IF DFHEIGDJ EQUAL 20
 24543         GO TO 2290-DUPLICATE-ALT-INDEX
 24544         DEPENDING ON DFHEIGDI
 24545     ELSE IF DFHEIGDJ EQUAL 21
 24546         GO TO 2380-BATCH-HDR-NOT-FOUND
 24547         DEPENDING ON DFHEIGDI
 24548     ELSE IF DFHEIGDJ EQUAL 22
 24549         GO TO 2385-REC-NOT-FOUND
 24550         DEPENDING ON DFHEIGDI
 24551     ELSE IF DFHEIGDJ EQUAL 23
 24552         GO TO 2380-BATCH-HDR-NOT-FOUND
 24553         DEPENDING ON DFHEIGDI
 24554     ELSE IF DFHEIGDJ EQUAL 24
 24555         GO TO 2485-BATCH-HDR-NOT-FOUND
 24556         DEPENDING ON DFHEIGDI
 24557     ELSE IF DFHEIGDJ EQUAL 25
 24558         GO TO 2490-RECORD-NOT-FOUND
 24559         DEPENDING ON DFHEIGDI
 24560     ELSE IF DFHEIGDJ EQUAL 26
 24561         GO TO 2475-CONTINUE-DELETE
 24562         DEPENDING ON DFHEIGDI
 24563     ELSE IF DFHEIGDJ EQUAL 27
 24564         GO TO 2485-BATCH-HDR-NOT-FOUND
 24565         DEPENDING ON DFHEIGDI
 24566     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 453
* VP6311.cbl
 24567         GO TO 2480-DELETE-FINISHED
 24568         DEPENDING ON DFHEIGDI
 24569     ELSE IF DFHEIGDJ EQUAL 29
 24570         GO TO 2820-PROCESS-REWRITE
 24571         DEPENDING ON DFHEIGDI
 24572     ELSE IF DFHEIGDJ EQUAL 30
 24573         GO TO 2885-RECORD-MISSING
 24574         DEPENDING ON DFHEIGDI
 24575     ELSE IF DFHEIGDJ EQUAL 31
 24576         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24577         DEPENDING ON DFHEIGDI
 24578     ELSE IF DFHEIGDJ EQUAL 32
 24579         GO TO 2827-DELETE-MAILING
 24580         DEPENDING ON DFHEIGDI
 24581     ELSE IF DFHEIGDJ EQUAL 33
 24582         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24583         DEPENDING ON DFHEIGDI
 24584     ELSE IF DFHEIGDJ EQUAL 34
 24585         GO TO 2920-PROCESS-REWRITE
 24586         DEPENDING ON DFHEIGDI
 24587     ELSE IF DFHEIGDJ EQUAL 35
 24588         GO TO 2985-RECORD-MISSING
 24589         DEPENDING ON DFHEIGDI
 24590     ELSE IF DFHEIGDJ EQUAL 36
 24591         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24592         DEPENDING ON DFHEIGDI
 24593     ELSE IF DFHEIGDJ EQUAL 37
 24594         GO TO 2990-DUPLICATE-RECORD
 24595         DEPENDING ON DFHEIGDI
 24596     ELSE IF DFHEIGDJ EQUAL 38
 24597         GO TO 3590-NOT-FOUND
 24598         DEPENDING ON DFHEIGDI
 24599     ELSE IF DFHEIGDJ EQUAL 39
 24600         GO TO 3690-NOT-FOUND
 24601         DEPENDING ON DFHEIGDI
 24602     ELSE IF DFHEIGDJ EQUAL 40
 24603         GO TO 3990-NOT-FOUND
 24604         DEPENDING ON DFHEIGDI
 24605     ELSE IF DFHEIGDJ EQUAL 41
 24606         GO TO 4050-END-RECORDS,
 24607               4050-END-RECORDS
 24608         DEPENDING ON DFHEIGDI
 24609     ELSE IF DFHEIGDJ EQUAL 42
 24610         GO TO 4150-END-BATCH
 24611         DEPENDING ON DFHEIGDI
 24612     ELSE IF DFHEIGDJ EQUAL 43
 24613         GO TO 4150-END-BATCH
 24614         DEPENDING ON DFHEIGDI
 24615     ELSE IF DFHEIGDJ EQUAL 44
 24616         GO TO 4250-END-RECORDS,
 24617               4250-END-RECORDS
 24618         DEPENDING ON DFHEIGDI
 24619     ELSE IF DFHEIGDJ EQUAL 45
 24620         GO TO 4350-END-BATCH,
 24621               4350-END-BATCH
 24622         DEPENDING ON DFHEIGDI
 24623     ELSE IF DFHEIGDJ EQUAL 46
 24624         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:39 Page 454
* VP6311.cbl
 24625               4550-END-RECORDS
 24626         DEPENDING ON DFHEIGDI
 24627     ELSE IF DFHEIGDJ EQUAL 47
 24628         GO TO 4680-NOT-FOUND,
 24629               4680-NOT-FOUND
 24630         DEPENDING ON DFHEIGDI
 24631     ELSE IF DFHEIGDJ EQUAL 48
 24632         GO TO 4860-NOT-FOUND,
 24633               4850-END-RECORDS
 24634         DEPENDING ON DFHEIGDI
 24635     ELSE IF DFHEIGDJ EQUAL 49
 24636         GO TO 4970-NOT-FOUND,
 24637               4950-END-RECORDS
 24638         DEPENDING ON DFHEIGDI
 24639     ELSE IF DFHEIGDJ EQUAL 50
 24640         GO TO 5050-NOT-FOUND
 24641         DEPENDING ON DFHEIGDI
 24642     ELSE IF DFHEIGDJ EQUAL 51
 24643         GO TO 5050-NOT-FOUND
 24644         DEPENDING ON DFHEIGDI
 24645     ELSE IF DFHEIGDJ EQUAL 52
 24646         GO TO 5050-NOT-FOUND
 24647         DEPENDING ON DFHEIGDI
 24648     ELSE IF DFHEIGDJ EQUAL 53
 24649         GO TO 5550-END-RECORDS,
 24650               5550-END-RECORDS
 24651         DEPENDING ON DFHEIGDI
 24652     ELSE IF DFHEIGDJ EQUAL 54
 24653         GO TO 6050-QID-ERROR
 24654         DEPENDING ON DFHEIGDI
 24655     ELSE IF DFHEIGDJ EQUAL 55
 24656         GO TO 6050-QID-ERROR
 24657         DEPENDING ON DFHEIGDI
 24658     ELSE IF DFHEIGDJ EQUAL 56
 24659         GO TO 6400-CONTINUE,
 24660               6400-CONTINUE
 24661         DEPENDING ON DFHEIGDI
 24662     ELSE IF DFHEIGDJ EQUAL 57
 24663         GO TO 3690-NOT-FOUND
 24664         DEPENDING ON DFHEIGDI
 24665     ELSE IF DFHEIGDJ EQUAL 58
 24666         GO TO 7399-EXIT
 24667         DEPENDING ON DFHEIGDI
 24668     ELSE IF DFHEIGDJ EQUAL 59
 24669         GO TO 7550-OFFICER-NOTFND
 24670         DEPENDING ON DFHEIGDI
 24671     ELSE IF DFHEIGDJ EQUAL 60
 24672         GO TO 8300-SEND-TEXT
 24673         DEPENDING ON DFHEIGDI.
 24674     MOVE '9%                    "   ' TO DFHEIV0
 24675     MOVE 'VP6311' TO DFHEIV1
 24676     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24677     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       15788     Code:       96353
