* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page   1
* NSRLTRBL.cbl
* Options: int("NSRLTRBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRLTRBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRLTRBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "NSRLTRBL.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSRLTRBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM NSREQLTR
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page   2
* NSRLTRBL.cbl
    14* 121802    2009122800001  PEMA  NEW PROGRAM
    15* 022212    2011120900003  AJRA  ADD AHL
    16* 031912    2011120900003  AJRA  ADD AHL CLAIM NO TO EXTRACT
    17* 020513    2011090100001  PEMA  CORRECT ISS WITH MULT &
    18* 020613    2012110800002  AJRA  ADD BUS TYPE (GPCD) TO NAPERSOFT
    19* 031116    2015110400001  TANA  ADD EL150D FIELDS
    20* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    21* 031319  IR2019031100002  TANA  Correct iss w/ letters with ???
    22* 071719    2019011600010  TANA  ADD VERIFICATION CODE
    23* 061421  CR2017031500001  PEMA  Update to CCM8
    24******************************************************************
    25 ENVIRONMENT DIVISION.
    26 DATA DIVISION.
    27 working-storage section.
    28 01  DFH-START PIC X(04).
    29 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    30 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    31 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    32 77  S1                          PIC S999 COMP-3 VALUE +0.
    33 77  S2                          PIC S999 COMP-3 VALUE +0.
    34 77  S3                          PIC S999 COMP-3 VALUE +0.
    35 77  E1                          PIC S999 COMP-3 VALUE +0.
    36 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    37 77  M1                          PIC S999 COMP-3 VALUE +0.
    38 77  P1                          PIC S999 COMP-3 VALUE +0.
    39 77  WS-HOLD-KEY                 PIC X(20).
    40 77  WS-HOLD-S1                  PIC S999 COMP-3 VALUE +0.
    41 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    42 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    43 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    44 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    45 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    46 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    47 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    48 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    49 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    50 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    51     88  FOUND-BENE                  VALUE 'Y'.
    52 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    53 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    54 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    55 77  WS-CNTR                     pic s999 comp-3 value +0.
    56 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    57 77  WS-ACCUM-DAYS               PIC S9(5) COMP-3 VALUE +0.
    58 77  WS-ACCUM-AMT                PIC S9(9)V99 COMP-3 VALUE +0.
    59 77  WS-ACCUM-PD-BENS            PIC S999 COMP-3 VALUE +0.
    60 77  WS-PREV-CLM-TYPE            PIC X   VALUE ' '.
    61 77  WS-PREV-INS-TYPE            PIC X   VALUE ' '.
    62 77  WS-PREV-BEN-PER             PIC 99 VALUE ZEROS.
    63 77  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
    64     88  PDEF-FOUND                   VALUE 'Y'.
    65 77  wk1                         pic 999 value zeros.
    66 77  wk2                         pic 999 value zeros.
    67 77  WS-WORK-BEN-PCT             PIC S9V999 COMP-3 VALUE +0.
    68 77  WS-MAX-SUB                  PIC 9(4)    VALUE ZEROS.
    69 01  OUTPUT-SCREEN-WORK-AREA.
    70     05  OS-PREV-KEY.
    71         10  OS-PREV-CLM-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page   3
* NSRLTRBL.cbl
    72         10  OS-PREV-INS-TYPE        PIC X.
    73     05  WS-PD-BENS                  PIC 999 VALUE ZEROS.
    74     05  WS-COV-REM-BENS             PIC S999 VALUE ZEROS.
    75 01  WS-XML-WORK                 PIC X(2500)  VALUE SPACES.
    76 01 response-code         pic s9(8) comp.
    77 01 display-response      pic 9(8).
    78 01 bl-index              pic 9(8) comp.
    79 01 max-last-name         pic x(18).
    80 01 first-initial         pic x.
    81 01 name-in-range-flag    pic 9.
    82 01 max-entries           pic s9(8) comp value 100.
    83 01 lower-case    pic x(26) value
    84            "abcdefghijklmnopqrstuvwxyz".
    85 01 upper-case    pic x(26) value
    86            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
    87 01  W-Z-CONTROL-DATA.
    88     05  W-NUMBER-OF-COPIES  PIC  9(01).
    89     05  FILLER              PIC  X(01).
    90     05  W-DAYS-TO-FOLLOW-UP PIC  9(03).
    91     05  FILLER              PIC  X(01).
    92     05  W-DAYS-TO-RESEND-1  PIC  9(03).
    93     05  FILLER              PIC  X(01).
    94     05  W-FORM-TO-RESEND    PIC  X(04).
    95     05  FILLER              PIC  X(01).
    96     05  W-PROMPT-LETTER     PIC  X(01).
    97     05  FILLER              PIC  X(01).
    98     05  W-ENCLOSURE-CD      PIC  X(03).
    99     05  FILLER              PIC  X(1).
   100     05  W-AUTO-CLOSE-IND    PIC  X(1).
   101     05  FILLER              PIC  X(1).
   102     05  W-LETTER-TO-BENE    PIC  X(1).
   103 01  MISC.
   104     12  WS-RESPONSE             PIC S9(8)   COMP.
   105         88  RESP-NORMAL                  VALUE +00.
   106         88  RESP-NOTFND                  VALUE +13.
   107         88  RESP-DUPREC                  VALUE +14.
   108         88  RESP-DUPKEY                  VALUE +15.
   109         88  RESP-NOTOPEN                 VALUE +19.
   110         88  RESP-ENDFILE                 VALUE +20.
   111 01  WS-ELENCC-KEY.
   112     05  WS-ELENCC-COMPANY-CD    PIC X.
   113     05  WS-ELENCC-REC-TYPE      PIC X.
   114     05  WS-ELENCC-ENC-CODE      PIC X(5).
   115     05  F                       PIC X(09).
   116 01  WS-ELMSTR-KEY.
   117     05  WS-ELMSTR-COMPANY-CD    PIC X.
   118     05  WS-ELMSTR-CARRIER       PIC X.
   119     05  WS-ELMSTR-CLAIM-NO      PIC X(7).
   120     05  WS-ELMSTR-CERT-NO       PIC X(11).
   121 01  WS-ELTRLR-KEY.
   122     05  WS-ELTRLR-COMPANY-CD    PIC X.
   123     05  WS-ELTRLR-CARRIER       PIC X.
   124     05  WS-ELTRLR-CLAIM-NO      PIC X(7).
   125     05  WS-ELTRLR-CERT-NO       PIC X(11).
   126     05  WS-ELTRLR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   127 01  WS-ELCERT-KEY.
   128     05  WS-ELCERT-COMPANY-CD    PIC X.
   129     05  WS-ELCERT-CARRIER       PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page   4
* NSRLTRBL.cbl
   130     05  WS-ELCERT-GROUP         PIC X(6).
   131     05  WS-ELCERT-STATE         PIC XX.
   132     05  WS-ELCERT-ACCOUNT       PIC X(10).
   133     05  WS-ELCERT-EFF-DT        PIC XX.
   134     05  WS-ELCERT-CERT-NO       PIC X(11).
   135 01  WS-ERACCT-KEY.
   136     05  WS-ERACCT-COMPANY-CD    PIC X.
   137     05  WS-ERACCT-CARRIER       PIC X.
   138     05  WS-ERACCT-GROUP         PIC X(6).
   139     05  WS-ERACCT-STATE         PIC XX.
   140     05  WS-ERACCT-ACCOUNT       PIC X(10).
   141     05  WS-ERACCT-EXP-DT        PIC XX.
   142     05  FILLER                  PIC XXXX.
   143 01  WS-ELBENE-KEY.
   144     05  WS-ELBENE-COMPANY-CD    PIC X.
   145     05  WS-ELBENE-REC-TYPE      PIC X.
   146     05  WS-ELBENE-BENE          PIC X(10).
   147 01  WS-ELLETR-KEY.
   148     05  WS-ELLETR-COMPANY-CD    PIC X.
   149     05  WS-ELLETR-LETTER-ID     PIC X(12).
   150     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   151 01  WS-ELCNTL-KEY.
   152     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   153     05  WS-ELCNTL-REC-TYPE      PIC X.
   154     05  WS-ELCNTL-GENL.
   155         10  FILLER              PIC XX  VALUE SPACES.
   156         10  WS-ELCNTL-BEN-CD    PIC XX.
   157     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   158 01  ACCESS-KEYS.
   159     12  ELCRTT-KEY.
   160         16  CRTT-COMP-CD            PIC X.
   161         16  CRTT-CARRIER            PIC X.
   162         16  CRTT-GROUPING           PIC X(6).
   163         16  CRTT-STATE              PIC XX.
   164         16  CRTT-ACCOUNT            PIC X(10).
   165         16  CRTT-EFF-DT             PIC XX.
   166         16  CRTT-CERT-NO            PIC X(11).
   167         16  CRTT-REC-TYPE           PIC X.
   168
   169 01  ERPDEF-KEY-SAVE             PIC X(18).
   170 01  ERPDEF-KEY.
   171     12  ERPDEF-COMPANY-CD       PIC X.
   172     12  ERPDEF-STATE            PIC XX.
   173     12  ERPDEF-PROD-CD          PIC XXX.
   174     12  F                       PIC X(7).
   175     12  ERPDEF-BEN-TYPE         PIC X.
   176     12  ERPDEF-BEN-CODE         PIC XX.
   177     12  ERPDEF-EXP-DT           PIC XX.
   178 01  TEXT-WORK-AREAS.
   179     05  WS-COV-TYPE             PIC X(4) VALUE SPACES.
   180 01  WS-UNSORTED-TABLE.
   181     12  WS-UNSRTD-TABLE   OCCURS 25 TIMES.
   182         16  WS-KEY.
   183             20  WS-CLM-TYPE     PIC X.
   184             20  WS-INS-TYPE     PIC X.
   185             20  WS-BEN-PER      PIC 99.
   186             20  WS-INC-DT       PIC XX.
   187         16  WS-EXCL-PER         PIC 999.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page   5
* NSRLTRBL.cbl
   188         16  WS-COV-ENDS         PIC 999.
   189         16  WS-ACC-PER          PIC 999.
   190         16  WS-MAX-BENS         PIC 999.
   191         16  WS-REC-MOS          PIC 99.
   192         16  WS-MAX-EXTEN        PIC 99.
   193         16  WS-STATUS           PIC X.
   194         16  WS-PD-THRU-DT       PIC XX.
   195         16  WS-CLAIM-NO         PIC X(7).
   196         16  WS-MAX-MOBEN        PIC S9(7)V99 COMP-3.
   197         16  WS-TOTAL-PAID       PIC S9(7)V99 COMP-3.
   198         16  WS-REM-BENS         PIC 999.
   199         16  WS-SORTED-SW        PIC X.
   200 01  WS-SORTED-TABLE.
   201     12  WS-SRTD-TABLE OCCURS 25 TIMES.
   202         16  WS-SRTD-KEY.
   203             20  WS-SRTD-CLM-TYPE PIC X.
   204             20  WS-SRTD-INS-TYPE PIC X.
   205             20  WS-SRTD-BEN-PER PIC 99.
   206             20  WS-SRTD-INC-DT  PIC XX.
   207         16  WS-SRTD-EXCL-PER    PIC 999.
   208         16  WS-SRTD-COV-ENDS    PIC 999.
   209         16  WS-SRTD-ACC-PER     PIC 999.
   210         16  WS-SRTD-MAX-BENS    PIC 999.
   211         16  WS-SRTD-REC-MOS     PIC 99.
   212         16  WS-SRTD-MAX-EXTEN   PIC 99.
   213         16  WS-SRTD-STATUS      PIC X.
   214         16  WS-SRTD-PD-THRU-DT  PIC XX.
   215         16  WS-SRTD-CLAIM-NO    PIC X(7).
   216         16  WS-SRTD-MAX-MOBEN   PIC S9(7)V99 COMP-3.
   217         16  WS-SRTD-TOTAL-PAID  PIC S9(7)V99 COMP-3.
   218         16  WS-SRTD-REM-BENS    PIC 999.
   219         16  WS-SRTD-SW          PIC X.
   220 01  SAVE-ACCOUNT-MASTER         PIC X(2000) VALUE SPACES.
   221*                                COPY ELCDATE.
   222******************************************************************
   223*                                                                *
   224*                                                                *
   225*                            ELCDATE.                            *
   226*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   227*                            VMOD=2.003
   228*                                                                *
   229*                                                                *
   230*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   231*                 LENGTH = 200                                   *
   232******************************************************************
   233
   234 01  DATE-CONVERSION-DATA.
   235     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   236     12  DC-OPTION-CODE                PIC X.
   237         88  BIN-TO-GREG                VALUE ' '.
   238         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   239         88  EDIT-GREG-TO-BIN           VALUE '2'.
   240         88  YMD-GREG-TO-BIN            VALUE '3'.
   241         88  MDY-GREG-TO-BIN            VALUE '4'.
   242         88  JULIAN-TO-BIN              VALUE '5'.
   243         88  BIN-PLUS-ELAPSED           VALUE '6'.
   244         88  FIND-CENTURY               VALUE '7'.
   245         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page   6
* NSRLTRBL.cbl
   246         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   247         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   248         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   249         88  JULIAN-TO-BIN-3            VALUE 'C'.
   250         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   251         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   252         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   253         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   254         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   255         88  CHECK-LEAP-YEAR            VALUE 'H'.
   256         88  BIN-3-TO-GREG              VALUE 'I'.
   257         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   258         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   259         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   260         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   261         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   262         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   263         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   264         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   265         88  THREE-CHARACTER-BIN
   266                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   267         88  GREGORIAN-TO-BIN
   268                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   269         88  BIN-TO-GREGORIAN
   270                  VALUES ' ' '1' 'I' '8' 'G'.
   271         88  JULIAN-TO-BINARY
   272                  VALUES '5' 'C' 'E' 'F'.
   273     12  DC-ERROR-CODE                 PIC X.
   274         88  NO-CONVERSION-ERROR        VALUE ' '.
   275         88  DATE-CONVERSION-ERROR
   276                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   277         88  DATE-IS-ZERO               VALUE '1'.
   278         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   279         88  DATE-IS-INVALID            VALUE '3'.
   280         88  DATE1-GREATER-DATE2        VALUE '4'.
   281         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   282         88  DATE-INVALID-OPTION        VALUE '9'.
   283         88  INVALID-CENTURY            VALUE 'A'.
   284         88  ONLY-CENTURY               VALUE 'B'.
   285         88  ONLY-LEAP-YEAR             VALUE 'C'.
   286         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   287     12  DC-END-OF-MONTH               PIC X.
   288         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   289     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   290         88  USE-NORMAL-PROCESS         VALUE ' '.
   291         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   292         88  ADJUST-UP-100-YRS          VALUE '2'.
   293     12  FILLER                        PIC X.
   294     12  DC-CONVERSION-DATES.
   295         16  DC-BIN-DATE-1             PIC XX.
   296         16  DC-BIN-DATE-2             PIC XX.
   297         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   298         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   299                       DC-GREG-DATE-1-EDIT.
   300             20  DC-EDIT1-MONTH        PIC 99.
   301             20  SLASH1-1              PIC X.
   302             20  DC-EDIT1-DAY          PIC 99.
   303             20  SLASH1-2              PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page   7
* NSRLTRBL.cbl
   304             20  DC-EDIT1-YEAR         PIC 99.
   305         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   306         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   307                     DC-GREG-DATE-2-EDIT.
   308             20  DC-EDIT2-MONTH        PIC 99.
   309             20  SLASH2-1              PIC X.
   310             20  DC-EDIT2-DAY          PIC 99.
   311             20  SLASH2-2              PIC X.
   312             20  DC-EDIT2-YEAR         PIC 99.
   313         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   314         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   315                     DC-GREG-DATE-1-YMD.
   316             20  DC-YMD-YEAR           PIC 99.
   317             20  DC-YMD-MONTH          PIC 99.
   318             20  DC-YMD-DAY            PIC 99.
   319         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   320         16  DC-GREG-DATE-1-MDY-R REDEFINES
   321                      DC-GREG-DATE-1-MDY.
   322             20  DC-MDY-MONTH          PIC 99.
   323             20  DC-MDY-DAY            PIC 99.
   324             20  DC-MDY-YEAR           PIC 99.
   325         16  DC-GREG-DATE-1-ALPHA.
   326             20  DC-ALPHA-MONTH        PIC X(10).
   327             20  DC-ALPHA-DAY          PIC 99.
   328             20  FILLER                PIC XX.
   329             20  DC-ALPHA-CENTURY.
   330                 24 DC-ALPHA-CEN-N     PIC 99.
   331             20  DC-ALPHA-YEAR         PIC 99.
   332         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   333         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   334         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   335         16  DC-JULIAN-DATE            PIC 9(05).
   336         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   337                                       PIC 9(05).
   338         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   339             20  DC-JULIAN-YEAR        PIC 99.
   340             20  DC-JULIAN-DAYS        PIC 999.
   341         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   342         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   343         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   344     12  DATE-CONVERSION-VARIBLES.
   345         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   346         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   347             20  FILLER                PIC 9(3).
   348             20  HOLD-CEN-1-CCYY.
   349                 24  HOLD-CEN-1-CC     PIC 99.
   350                 24  HOLD-CEN-1-YY     PIC 99.
   351             20  HOLD-CEN-1-MO         PIC 99.
   352             20  HOLD-CEN-1-DA         PIC 99.
   353         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   354             20  HOLD-CEN-1-R-MO       PIC 99.
   355             20  HOLD-CEN-1-R-DA       PIC 99.
   356             20  HOLD-CEN-1-R-CCYY.
   357                 24  HOLD-CEN-1-R-CC   PIC 99.
   358                 24  HOLD-CEN-1-R-YY   PIC 99.
   359             20  FILLER                PIC 9(3).
   360         16  HOLD-CENTURY-1-X.
   361             20  FILLER                PIC X(3)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page   8
* NSRLTRBL.cbl
   362             20  HOLD-CEN-1-X-CCYY.
   363                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   364                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   365             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   366             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   367         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   368             20  HOLD-CEN-1-R-X-MO     PIC XX.
   369             20  HOLD-CEN-1-R-X-DA     PIC XX.
   370             20  HOLD-CEN-1-R-X-CCYY.
   371                 24  HOLD-CEN-1-R-X-CC PIC XX.
   372                 24  HOLD-CEN-1-R-X-YY PIC XX.
   373             20  FILLER                PIC XXX.
   374         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   375         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   376         16  DC-JULIAN-DATE-1          PIC 9(07).
   377         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   378             20  DC-JULIAN-1-CCYY.
   379                 24  DC-JULIAN-1-CC    PIC 99.
   380                 24  DC-JULIAN-1-YR    PIC 99.
   381             20  DC-JULIAN-DA-1        PIC 999.
   382         16  DC-JULIAN-DATE-2          PIC 9(07).
   383         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   384             20  DC-JULIAN-2-CCYY.
   385                 24  DC-JULIAN-2-CC    PIC 99.
   386                 24  DC-JULIAN-2-YR    PIC 99.
   387             20  DC-JULIAN-DA-2        PIC 999.
   388         16  DC-GREG-DATE-A-EDIT.
   389             20  DC-EDITA-MONTH        PIC 99.
   390             20  SLASHA-1              PIC X VALUE '/'.
   391             20  DC-EDITA-DAY          PIC 99.
   392             20  SLASHA-2              PIC X VALUE '/'.
   393             20  DC-EDITA-CCYY.
   394                 24  DC-EDITA-CENT     PIC 99.
   395                 24  DC-EDITA-YEAR     PIC 99.
   396         16  DC-GREG-DATE-B-EDIT.
   397             20  DC-EDITB-MONTH        PIC 99.
   398             20  SLASHB-1              PIC X VALUE '/'.
   399             20  DC-EDITB-DAY          PIC 99.
   400             20  SLASHB-2              PIC X VALUE '/'.
   401             20  DC-EDITB-CCYY.
   402                 24  DC-EDITB-CENT     PIC 99.
   403                 24  DC-EDITB-YEAR     PIC 99.
   404         16  DC-GREG-DATE-CYMD         PIC 9(08).
   405         16  DC-GREG-DATE-CYMD-R REDEFINES
   406                              DC-GREG-DATE-CYMD.
   407             20  DC-CYMD-CEN           PIC 99.
   408             20  DC-CYMD-YEAR          PIC 99.
   409             20  DC-CYMD-MONTH         PIC 99.
   410             20  DC-CYMD-DAY           PIC 99.
   411         16  DC-GREG-DATE-MDCY         PIC 9(08).
   412         16  DC-GREG-DATE-MDCY-R REDEFINES
   413                              DC-GREG-DATE-MDCY.
   414             20  DC-MDCY-MONTH         PIC 99.
   415             20  DC-MDCY-DAY           PIC 99.
   416             20  DC-MDCY-CEN           PIC 99.
   417             20  DC-MDCY-YEAR          PIC 99.
   418    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   419        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page   9
* NSRLTRBL.cbl
   420    12  DC-EL310-DATE                  PIC X(21).
   421    12  FILLER                         PIC X(28).
   422*                                COPY ELCMSTR.
   423******************************************************************
   424*                                                                *
   425*                            ELCMSTR.                            *
   426*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   427*                            VMOD=2.012                          *
   428*                                                                *
   429*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   430*                                                                *
   431*   FILE TYPE = VSAM,KSDS                                        *
   432*   RECORD SIZE = 350  RECFORM = FIXED                           *
   433*                                                                *
   434*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   435*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   436*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   437*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   438*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   439*                                                 RKP=75,LEN=21  *
   440*                                                                *
   441*   **** NOTE ****                                               *
   442*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   443*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   444*                                                                *
   445*   LOG = YES                                                    *
   446*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   447******************************************************************
   448*                   C H A N G E   L O G
   449*
   450* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   451*-----------------------------------------------------------------
   452*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   453* EFFECTIVE    NUMBER
   454*-----------------------------------------------------------------
   455* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   456* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   457* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   458* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   459* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   460* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
   461* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   462******************************************************************
   463 01  CLAIM-MASTER.
   464     12  CL-RECORD-ID                PIC XX.
   465         88  VALID-CL-ID         VALUE 'CL'.
   466
   467     12  CL-CONTROL-PRIMARY.
   468         16  CL-COMPANY-CD           PIC X.
   469         16  CL-CARRIER              PIC X.
   470         16  CL-CLAIM-NO             PIC X(7).
   471         16  CL-CERT-NO.
   472             20  CL-CERT-PRIME       PIC X(10).
   473             20  CL-CERT-SFX         PIC X.
   474
   475     12  CL-CONTROL-BY-NAME.
   476         16  CL-COMPANY-CD-A1        PIC X.
   477         16  CL-INSURED-LAST-NAME    PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  10
* NSRLTRBL.cbl
   478         16  CL-INSURED-NAME.
   479             20  CL-INSURED-1ST-NAME PIC X(12).
   480             20  CL-INSURED-MID-INIT PIC X.
   481
   482     12  CL-CONTROL-BY-SSN.
   483         16  CL-COMPANY-CD-A2        PIC X.
   484         16  CL-SOC-SEC-NO.
   485             20  CL-SSN-STATE        PIC XX.
   486             20  CL-SSN-ACCOUNT      PIC X(6).
   487             20  CL-SSN-LN3          PIC X(3).
   488
   489     12  CL-CONTROL-BY-CERT-NO.
   490         16  CL-COMPANY-CD-A4        PIC X.
   491         16  CL-CERT-NO-A4.
   492             20  CL-CERT-A4-PRIME    PIC X(10).
   493             20  CL-CERT-A4-SFX      PIC X.
   494
   495     12  CL-CONTROL-BY-CCN.
   496         16  CL-COMPANY-CD-A5        PIC X.
   497         16  CL-CCN-A5.
   498             20  CL-CCN.
   499                 24  CL-CCN-PREFIX-A5 PIC X(4).
   500                 24  CL-CCN-PRIME-A5 PIC X(12).
   501             20  CL-CCN-FILLER-A5    PIC X(4).
   502
   503     12  CL-INSURED-PROFILE-DATA.
   504         16  CL-INSURED-BIRTH-DT     PIC XX.
   505         16  CL-INSURED-SEX-CD       PIC X.
   506             88  INSURED-IS-MALE        VALUE 'M'.
   507             88  INSURED-IS-FEMALE      VALUE 'F'.
   508             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   509         16  CL-INSURED-OCC-CD       PIC X(6).
   510         16  FILLER                  PIC X(5).
   511
   512     12  CL-PROCESSING-INFO.
   513         16  CL-PROCESSOR-ID         PIC X(4).
   514         16  CL-CLAIM-STATUS         PIC X.
   515             88  CLAIM-IS-OPEN          VALUE 'O'.
   516             88  CLAIM-IS-CLOSED        VALUE 'C'.
   517         16  CL-CLAIM-TYPE           PIC X.
   518*            88  AH-CLAIM               VALUE 'A'.
   519*            88  LIFE-CLAIM             VALUE 'L'.
   520*            88  PROPERTY-CLAIM         VALUE 'P'.
   521*            88  IUI-CLAIM              VALUE 'I'.
   522*            88  GAP-CLAIM              VALUE 'G'.
   523*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   524*            88  OTHER-CLAIM            VALUE 'O'.
   525         16  CL-CLAIM-PREM-TYPE      PIC X.
   526             88  SINGLE-PREMIUM         VALUE '1'.
   527             88  O-B-COVERAGE           VALUE '2'.
   528             88  OPEN-END-COVERAGE      VALUE '3'.
   529         16  CL-INCURRED-DT          PIC XX.
   530         16  CL-REPORTED-DT          PIC XX.
   531         16  CL-FILE-ESTABLISH-DT    PIC XX.
   532         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   533         16  CL-LAST-PMT-DT          PIC XX.
   534         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   535         16  CL-PAID-THRU-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  11
* NSRLTRBL.cbl
   536         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   537         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   538         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   539         16  CL-PMT-CALC-METHOD      PIC X.
   540             88  CL-360-DAY-YR          VALUE '1'.
   541             88  CL-365-DAY-YR          VALUE '2'.
   542             88  CL-FULL-MONTHS         VALUE '3'.
   543         16  CL-CAUSE-CD             PIC X(6).
   544
   545         16  CL-PRIME-CERT-NO.
   546             20  CL-PRIME-CERT-PRIME PIC X(10).
   547             20  CL-PRIME-CERT-SFX   PIC X.
   548
   549         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   550             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   551             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   552
   553         16  CL-MICROFILM-NO         PIC X(10).
   554         16  FILLER REDEFINES CL-MICROFILM-NO.
   555             20  CL-BENEFIT-PERIOD   PIC 99.
   556             20  FILLER              PIC X(8).
   557         16  CL-PROG-FORM-TYPE       PIC X.
   558         16  CL-LAST-ADD-ON-DT       PIC XX.
   559
   560         16  CL-LAST-REOPEN-DT       PIC XX.
   561         16  CL-LAST-CLOSE-DT        PIC XX.
   562         16  CL-LAST-CLOSE-REASON    PIC X(01).
   563             88  FINAL-PAID             VALUE '1'.
   564             88  CLAIM-DENIED           VALUE '2'.
   565             88  AUTO-CLOSE             VALUE '3'.
   566             88  MANUAL-CLOSE           VALUE '4'.
   567             88  BENEFITS-CHANGED       VALUE 'C'.
   568             88  SETUP-ERRORS           VALUE 'E'.
   569         16  CL-ASSOC-CERT-SEQU      PIC S99.
   570         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   571         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   572             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   573         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   574         16  FILLER                  PIC X.
   575
   576     12  CL-CERTIFICATE-DATA.
   577         16  CL-CERT-ORIGIN          PIC X.
   578             88  CERT-WAS-ONLINE        VALUE '1'.
   579             88  CERT-WAS-CREATED       VALUE '2'.
   580             88  COVERAGE-WAS-ADDED     VALUE '3'.
   581         16  CL-CERT-KEY-DATA.
   582             20  CL-CERT-CARRIER     PIC X.
   583             20  CL-CERT-GROUPING    PIC X(6).
   584             20  CL-CERT-STATE       PIC XX.
   585             20  CL-CERT-ACCOUNT.
   586                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   587                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   588             20  CL-CERT-EFF-DT      PIC XX.
   589
   590     12  CL-STATUS-CONTROLS.
   591         16  CL-PRIORITY-CD          PIC X.
   592             88  CONFIDENTIAL-DATA      VALUE '8'.
   593             88  HIGHEST-PRIORITY       VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  12
* NSRLTRBL.cbl
   594         16  CL-SUPV-ATTN-CD         PIC X.
   595             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   596             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   597         16  CL-PURGED-DT            PIC XX.
   598         16  CL-RESTORED-DT          PIC XX.
   599         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   600         16  CL-NEXT-RESEND-DT       PIC XX.
   601         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   602         16  CL-CRITICAL-PERIOD      PIC 99.
   603*        16  FILLER                  PIC XX.
   604         16  CL-LAST-MAINT-DT        PIC XX.
   605         16  CL-LAST-MAINT-USER      PIC X(4).
   606         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   607         16  CL-LAST-MAINT-TYPE      PIC X.
   608             88  CLAIM-SET-UP           VALUE ' '.
   609             88  PAYMENT-MADE           VALUE '1'.
   610             88  LETTER-SENT            VALUE '2'.
   611             88  MASTER-WAS-ALTERED     VALUE '3'.
   612             88  MASTER-WAS-RESTORED    VALUE '4'.
   613             88  INCURRED-DATE-CHANGED  VALUE '5'.
   614             88  FILE-CONVERTED         VALUE '6'.
   615             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   616             88  ERROR-CORRECTION       VALUE 'E'.
   617         16  CL-RELATED-CLAIM-NO     PIC X(7).
   618         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   619         16  CL-BENEFICIARY          PIC X(10).
   620         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   621         16  CL-DENIAL-TYPE          PIC X.
   622             88  CL-TYPE-DENIAL          VALUE '1'.
   623             88  CL-TYPE-RESCISSION      VALUE '2'.
   624             88  CL-TYPE-REFORMATION     VALUE '3'.
   625             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   626             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   627         16  CL-NO-OF-EXTENSIONS     PIC 99.
   628         16  filler                  pic x(3).
   629*        16  CL-CRIT-PER-RECURRENT   PIC X.
   630*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   631*        16  CL-RTW-DT               PIC XX.
   632
   633     12  CL-TRAILER-CONTROLS.
   634         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   635             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   636             88  CL-LAST-TRL-AVAIL      VALUE +100.
   637             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   638         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   639         16  FILLER                  PIC XX.
   640         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   641         16  CL-ADDRESS-TRAILER-CNT.
   642             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   643                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   644             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   645                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   646             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   647                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   648             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   649                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   650             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   651                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  13
* NSRLTRBL.cbl
   652             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   653                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   654             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   655                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   656
   657     12  CL-CV-REFERENCE-NO.
   658         16  CL-CV-REFNO-PRIME       PIC X(18).
   659         16  CL-CV-REFNO-SFX         PIC XX.
   660
   661     12  CL-FILE-LOCATION            PIC X(4).
   662
   663     12  CL-PROCESS-ERRORS.
   664         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   665             88  NO-FATAL-ERRORS        VALUE ZERO.
   666         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   667             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   668
   669     12  CL-PRODUCT-CD               PIC X.
   670
   671     12  CL-CURRENT-KEY-DATA.
   672         16  CL-CURRENT-CARRIER      PIC X.
   673         16  CL-CURRENT-GROUPING     PIC X(6).
   674         16  CL-CURRENT-STATE        PIC XX.
   675         16  CL-CURRENT-ACCOUNT      PIC X(10).
   676
   677     12  CL-ASSOCIATES               PIC X.
   678         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   679         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   680         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   681         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   682
   683     12  CL-ACTIVITY-CODE            PIC 99.
   684     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   685     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   686
   687     12  CL-LAPSE-REPORT-CODE        PIC 9.
   688     12  CL-LAG-REPORT-CODE          PIC 9.
   689     12  CL-LOAN-TYPE                PIC XX.
   690     12  CL-LEGAL-STATE              PIC XX.
   691
   692     12  CL-YESNOSW                  PIC X.
   693     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   694         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   695         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   696         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   697     12  cl-insured-type             pic x.
   698         88  cl-claim-on-primary         value 'P'.
   699         88  cl-claim-on-co-borrower     value 'C'.
   700     12  cl-benefit-expiration-dt    PIC XX.
   701*                                COPY ELCTRLR.
   702******************************************************************
   703*                                                                *
   704*                            ELCTRLR.                            *
   705*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   706*                            VMOD=2.014                          *
   707*                                                                *
   708*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
   709*                                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  14
* NSRLTRBL.cbl
   710*   FILE TYPE = VSAM,KSDS                                        *
   711*   RECORD SIZE = 200    RECFORM = FIXED                         *
   712*                                                                *
   713*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
   714*       ALTERNATE INDEX = NONE                                   *
   715*                                                                *
   716*   LOG = YES                                                    *
   717*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   718******************************************************************
   719*                   C H A N G E   L O G
   720*
   721* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   722*-----------------------------------------------------------------
   723*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   724* EFFECTIVE    NUMBER
   725*-----------------------------------------------------------------
   726* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   727* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
   728* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
   729* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
   730* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
   731* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
   732* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
   733* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
   734* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
   735* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
   736* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
   737* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
   738* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
   739* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
   740* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
   741* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
   742* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
   743* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
   744* 040814    2014030500002  AJRA  ADD ICD CODES
   745* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   746* 013017  CR2016053100001  PEMA  ACH PROCESSING
   747* 062217  CR2017050300002  TANA  ADD AUTH RCVD
   748* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   749* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE
   750******************************************************************
   751 01  ACTIVITY-TRAILERS.
   752     12  AT-RECORD-ID                    PIC XX.
   753         88  VALID-AT-ID                       VALUE 'AT'.
   754
   755     12  AT-CONTROL-PRIMARY.
   756         16  AT-COMPANY-CD               PIC X.
   757         16  AT-CARRIER                  PIC X.
   758         16  AT-CLAIM-NO                 PIC X(7).
   759         16  AT-CERT-NO.
   760             20  AT-CERT-PRIME           PIC X(10).
   761             20  AT-CERT-SFX             PIC X.
   762         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
   763             88  AT-1ST-TRL-AVAIL             VALUE +4095.
   764             88  AT-LAST-TRL-AVAIL            VALUE +100.
   765             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
   766             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
   767             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  15
* NSRLTRBL.cbl
   768             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
   769             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
   770             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
   771             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
   772             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
   773             88  AT-DIAGNOSIS-TRL             VALUE +90.
   774             88  AT-BENEFICIARY-TRL           VALUE +91.
   775             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
   776             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
   777             88  AT-VFY-CAUSAL-STATE          VALUE +94.
   778             88  AT-ERROR-MSGS-TRL            VALUE +95.
   779
   780     12  AT-TRAILER-TYPE                 PIC X.
   781         88  RESERVE-EXPENSE-TR               VALUE '1'.
   782         88  PAYMENT-TR                       VALUE '2'.
   783         88  AUTO-PAY-TR                      VALUE '3'.
   784         88  CORRESPONDENCE-TR                VALUE '4'.
   785         88  ADDRESS-TR                       VALUE '5'.
   786         88  GENERAL-INFO-TR                  VALUE '6'.
   787         88  AUTO-PROMPT-TR                   VALUE '7'.
   788         88  DENIAL-TR                        VALUE '8'.
   789         88  INCURRED-CHG-TR                  VALUE '9'.
   790         88  FORM-CONTROL-TR                  VALUE 'A'.
   791
   792     12  AT-RECORDED-DT                  PIC XX.
   793     12  AT-RECORDED-BY                  PIC X(4).
   794     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
   795
   796     12  AT-TRAILER-BODY                 PIC X(165).
   797
   798     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
   799         16  AT-RESERVE-CONTROLS.
   800             20  AT-MANUAL-SW            PIC X.
   801                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
   802             20  AT-FUTURE-SW            PIC X.
   803                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
   804             20  AT-PTC-SW               PIC X.
   805                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
   806             20  AT-IBNR-SW              PIC X.
   807                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
   808             20  AT-PTC-LF-SW            PIC X.
   809                 88  AT-LF-PTC-USED          VALUE '1'.
   810             20  AT-CDT-ACCESS-METHOD    PIC X.
   811                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
   812                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
   813                 88  AT-CDT-INTERPOLATED     VALUE '3'.
   814             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
   815         16  AT-LAST-COMPUTED-DT         PIC XX.
   816         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
   817         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
   818         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
   819         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
   820         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
   821         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
   822         16  AT-EXPENSE-CONTROLS.
   823             20  AT-EXPENSE-METHOD       PIC X.
   824                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
   825                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  16
* NSRLTRBL.cbl
   826                 88  PERCENT-OF-PMT           VALUE '3'.
   827                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
   828             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
   829             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
   830         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
   831         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
   832
   833         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
   834         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
   835
   836*        16  FILLER                      PIC X(53).
   837         16  FILLER                      PIC X(47).
   838
   839         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
   840         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
   841
   842         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
   843             20  AT-OPEN-CLOSE-DATE      PIC XX.
   844             20  AT-OPEN-CLOSE-TYPE      PIC X.
   845*                    C = CLOSED
   846*                    O = OPEN
   847             20  AT-OPEN-CLOSE-REASON    PIC X(5).
   848*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
   849
   850     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
   851         16  AT-PAYMENT-TYPE             PIC X.
   852             88  PARTIAL-PAYMENT                VALUE '1'.
   853             88  FINAL-PAYMENT                  VALUE '2'.
   854             88  LUMP-SUM-PAYMENT               VALUE '3'.
   855             88  ADDITIONAL-PAYMENT             VALUE '4'.
   856             88  CHARGEABLE-EXPENSE             VALUE '5'.
   857             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
   858             88  VOIDED-PAYMENT                 VALUE '9'.
   859             88  TRANSFER                       VALUE 'T'.
   860             88  LIFE-INTEREST                  VALUE 'I'.
   861
   862         16  AT-CLAIM-TYPE               PIC X.
   863             88  PAID-FOR-AH                    VALUE 'A'.
   864             88  PAID-FOR-LIFE                  VALUE 'L'.
   865             88  PAID-FOR-IUI                   VALUE 'I'.
   866             88  PAID-FOR-GAP                   VALUE 'G'.
   867             88  PAID-FOR-FAM                   VALUE 'F'.
   868             88  PAID-FOR-OTH                   VALUE 'O'.
   869         16  AT-CLAIM-PREM-TYPE          PIC X.
   870             88  AT-SINGLE-PREMIUM              VALUE '1'.
   871             88  AT-O-B-COVERAGE                VALUE '2'.
   872             88  AT-OPEN-END-COVERAGE           VALUE '3'.
   873         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
   874         16  AT-CHECK-NO                 PIC X(7).
   875         16  AT-PAID-FROM-DT             PIC XX.
   876         16  AT-PAID-THRU-DT             PIC XX.
   877         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
   878         16  AT-ACH-PAYMENT              PIC X.
   879*        16  FILLER                      PIC X.
   880         16  AT-PAYEES-NAME              PIC X(30).
   881         16  AT-PAYMENT-ORIGIN           PIC X.
   882             88  ONLINE-MANUAL-PMT              VALUE '1'.
   883             88  ONLINE-AUTO-PMT                VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  17
* NSRLTRBL.cbl
   884             88  OFFLINE-PMT                    VALUE '3'.
   885         16  AT-CHECK-WRITTEN-DT         PIC XX.
   886         16  AT-TO-BE-WRITTEN-DT         PIC XX.
   887         16  AT-VOID-DATA.
   888             20  AT-VOID-DT              PIC XX.
   889*00144       20  AT-VOID-REASON          PIC X(30).
   890             20  AT-VOID-REASON          PIC X(26).
   891         16  AT-PMT-APPROVED-BY          PIC X(04).
   892         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
   893         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
   894         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
   895                                         PIC S99V9(5)  COMP-3.
   896         16  AT-CREDIT-INTERFACE.
   897             20  AT-PMT-SELECT-DT        PIC XX.
   898                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
   899             20  AT-PMT-ACCEPT-DT        PIC XX.
   900                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
   901             20  AT-VOID-SELECT-DT       PIC XX.
   902                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
   903             20  AT-VOID-ACCEPT-DT       PIC XX.
   904                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
   905
   906         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
   907                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
   908                 88  CONVERSION-PAYMENT           VALUE +99999999.
   909         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
   910
   911         16  AT-FORCE-CONTROL            PIC X.
   912             88  PAYMENT-WAS-FORCED           VALUE '1'.
   913         16  AT-PREV-LAST-PMT-DT         PIC XX.
   914         16  AT-PREV-PAID-THRU-DT        PIC XX.
   915         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
   916         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
   917         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
   918         16  AT-BENEFIT-TYPE             PIC X.
   919
   920         16  AT-EXPENSE-TYPE             PIC X.
   921         16  AT-PAYMENT-APPROVAL-SW      PIC X.
   922
   923         16  AT-PAYEE-TYPE-CD.
   924             20  AT-PAYEE-TYPE           PIC X.
   925                 88  INSURED-PAID           VALUE 'I'.
   926                 88  BENEFICIARY-PAID       VALUE 'B'.
   927                 88  ACCOUNT-PAID           VALUE 'A'.
   928                 88  OTHER-1-PAID           VALUE 'O'.
   929                 88  OTHER-2-PAID           VALUE 'Q'.
   930                 88  DOCTOR-PAID            VALUE 'P'.
   931                 88  EMPLOYER-PAID          VALUE 'E'.
   932             20  AT-PAYEE-SEQ            PIC X.
   933
   934         16  AT-CASH-PAYMENT             PIC X.
   935         16  AT-GROUPED-PAYMENT          PIC X.
   936         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
   937         16  AT-APPROVAL-LEVEL-REQD      PIC X.
   938         16  AT-APPROVED-LEVEL           PIC X.
   939         16  AT-VOID-TYPE                PIC X.
   940             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
   941             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  18
* NSRLTRBL.cbl
   942         16  AT-AIG-UNEMP-IND            PIC X.
   943             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
   944         16  AT-ASSOCIATES               PIC X.
   945             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
   946             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
   947
   948         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
   949         16  AT-CV-PMT-CODE              PIC X.
   950             88  FULL-DEATH-PAYMENT         VALUE '1'.
   951             88  HALF-DEATH-PAYMENT         VALUE '2'.
   952             88  FULL-ADD-PAYMENT           VALUE '3'.
   953             88  HALF-ADD-PAYMENT           VALUE '4'.
   954             88  FULL-RIDER-PAYMENT         VALUE '5'.
   955             88  HALF-RIDER-PAYMENT         VALUE '6'.
   956             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
   957             88  ADDL-PAYMENT               VALUE '8'.
   958
   959         16  AT-EOB-CODE1                PIC XXX.
   960         16  AT-EOB-CODE2                PIC XXX.
   961         16  AT-EOB-CODE3                PIC XXX.
   962         16  FILLER REDEFINES AT-EOB-CODE3.
   963             20  AT-PRINT-CLM-FORM       PIC X.
   964             20  AT-PRINT-SURVEY         PIC X.
   965             20  AT-SPECIAL-RELEASE      PIC X.
   966         16  AT-EOB-CODE4                PIC XXX.
   967         16  FILLER REDEFINES AT-EOB-CODE4.
   968             20  AT-INT-PMT-SELECT-DT    PIC XX.
   969             20  FILLER                  PIC X.
   970         16  AT-EOB-CODE5                PIC XXX.
   971         16  FILLER REDEFINES AT-EOB-CODE5.
   972             20  AT-PMT-PROOF-DT         PIC XX.
   973             20  FILLER                  PIC X.
   974
   975         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
   976             88  AT-PRINT-EOB            VALUE 'Y'.
   977
   978         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
   979         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
   980
   981     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
   982         16  AT-SCHEDULE-START-DT        PIC XX.
   983         16  AT-SCHEDULE-END-DT          PIC XX.
   984         16  AT-TERMINATED-DT            PIC XX.
   985         16  AT-LAST-PMT-TYPE            PIC X.
   986             88  LAST-PMT-IS-FINAL              VALUE 'F'.
   987             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
   988         16  AT-FIRST-PMT-DATA.
   989             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
   990             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
   991             20  AT-1ST-PAY-THRU-DT      PIC XX.
   992         16  AT-REGULAR-PMT-DATA.
   993             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
   994             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
   995             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
   996         16  AT-AUTO-PAYEE-CD.
   997             20  AT-AUTO-PAYEE-TYPE      PIC X.
   998                 88  INSURED-PAID-AUTO      VALUE 'I'.
   999                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  19
* NSRLTRBL.cbl
  1000                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  1001                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  1002                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  1003             20  AT-AUTO-PAYEE-SEQ       PIC X.
  1004         16  AT-AUTO-PAY-DAY             PIC 99.
  1005         16  AT-AUTO-CASH                PIC X.
  1006             88  AT-CASH                      VALUE 'Y'.
  1007             88  AT-NON-CASH                  VALUE 'N'.
  1008*        16  FILLER                      PIC X(129).
  1009         16  AT-AUTO-END-LETTER          PIC X(4).
  1010         16  FILLER                      PIC X(125).
  1011
  1012         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  1013         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  1014
  1015     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  1016         16  AT-LETTER-SENT-DT           PIC XX.
  1017         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  1018         16  AT-AUTO-RE-SEND-DT          PIC XX.
  1019         16  AT-LETTER-ANSWERED-DT       PIC XX.
  1020         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  1021         16  AT-LETTER-ORIGIN            PIC X.
  1022             88  ONLINE-CREATION              VALUE '1' '3'.
  1023             88  OFFLINE-CREATION             VALUE '2' '4'.
  1024             88  NAPER-ONLINE-CREATION        VALUE '3'.
  1025             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  1026         16  AT-STD-LETTER-FORM          PIC X(4).
  1027         16  AT-REASON-TEXT              PIC X(70).
  1028         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  1029         16  AT-ADDRESEE-TYPE            PIC X.
  1030              88  INSURED-ADDRESEE            VALUE 'I'.
  1031              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  1032              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  1033              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  1034              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  1035              88  OTHER-ADDRESEE-1            VALUE 'O'.
  1036              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  1037         16  AT-ADDRESSEE-NAME           PIC X(30).
  1038         16  AT-INITIAL-PRINT-DATE       PIC XX.
  1039         16  AT-RESEND-PRINT-DATE        PIC XX.
  1040         16  AT-CORR-SOL-UNSOL           PIC X.
  1041         16  AT-LETTER-PURGED-DT         PIC XX.
  1042*
  1043*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  1044*
  1045         16  AT-CSO-REDEFINITION.
  1046             20  AT-RESEND-LETTER-FORM   PIC X(4).
  1047             20  AT-AUTO-CLOSE-IND       PIC X(1).
  1048             20  AT-LETTER-TO-BENE       PIC X(1).
  1049             20  AT-STOP-LETTER-DT       PIC X(2).
  1050             20  AT-AUTH-RCVD            PIC X(1).
  1051             20  FILLER                  PIC X(18).
  1052*             20  FILLER                  PIC X(27).
  1053             20  AT-CSO-LETTER-STATUS    PIC X.
  1054                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  1055                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  1056                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  1057             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  20
* NSRLTRBL.cbl
  1058             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  1059*
  1060*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  1061*
  1062*        16  FILLER                      PIC X(26).
  1063*
  1064*        16  AT-DMD-BSR-CODE             PIC X.
  1065*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  1066*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  1067*
  1068*        16  AT-DMD-LETTER-STATUS        PIC X.
  1069*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  1070*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  1071*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  1072*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  1073*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  1074
  1075         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  1076         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  1077
  1078     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  1079         16  AT-ADDRESS-TYPE             PIC X.
  1080             88  INSURED-ADDRESS               VALUE 'I'.
  1081             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  1082             88  ACCOUNT-ADDRESS               VALUE 'A'.
  1083             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  1084             88  EMPLOYER-ADDRESS              VALUE 'E'.
  1085             88  OTHER-ADDRESS-1               VALUE 'O'.
  1086             88  OTHER-ADDRESS-2               VALUE 'Q'.
  1087         16  AT-MAIL-TO-NAME             PIC X(30).
  1088         16  AT-ADDRESS-LINE-1           PIC X(30).
  1089         16  AT-ADDRESS-LINE-2           PIC X(30).
  1090         16  AT-CITY-STATE.
  1091             20  AT-CITY                 PIC X(28).
  1092             20  AT-STATE                PIC XX.
  1093         16  AT-ZIP.
  1094             20  AT-ZIP-CODE.
  1095                 24  AT-ZIP-1ST          PIC X.
  1096                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1097                 24  FILLER              PIC X(4).
  1098             20  AT-ZIP-PLUS4            PIC X(4).
  1099         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  1100             20  AT-CAN-POSTAL-1         PIC XXX.
  1101             20  AT-CAN-POSTAL-2         PIC XXX.
  1102             20  FILLER                  PIC XXX.
  1103         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  1104*         16  FILLER                      PIC X(23).
  1105         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  1106         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  1107         16  FILLER                      PIC X(13).
  1108         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  1109         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  1110
  1111     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1112         16  AT-INFO-LINE-1              PIC X(60).
  1113         16  FILLER REDEFINES AT-INFO-LINE-1.
  1114             20  AT-NOTE-ERROR-NO OCCURS 15
  1115                                         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  21
* NSRLTRBL.cbl
  1116         16  AT-INFO-LINE-2              PIC X(60).
  1117         16  FILLER REDEFINES AT-INFO-LINE-2.
  1118             20  AT-ICD-CODE-1           PIC X(8).
  1119             20  AT-ICD-CODE-2           PIC X(8).
  1120             20  FILLER                  PIC X(44).
  1121         16  AT-INFO-TRAILER-TYPE        PIC X.
  1122             88  AT-ERRORS-NOTE          VALUE 'E'.
  1123             88  AT-PAYMENT-NOTE         VALUE 'P'.
  1124             88  AT-CALL-NOTE            VALUE 'C'.
  1125             88  AT-MAINT-NOTE           VALUE 'M'.
  1126             88  AT-CERT-CHANGE          VALUE 'X'.
  1127             88  AT-APPROVAL-NOTE        VALUE 'R'.
  1128             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  1129             88  AT-CERT-CANCELLED       VALUE 'T'.
  1130         16  AT-CALL-TYPE                PIC X.
  1131             88  AT-PHONE-CALL-IN        VALUE 'I'.
  1132             88  AT-PHONE-CALL-NEW       VALUE 'N'.
  1133             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  1134         16  AT-NOTE-CONTINUATION        PIC X.
  1135             88  AT-CONTINUED-NOTE       VALUE 'X'.
  1136         16  AT-EOB-CODES-EXIST          PIC X.
  1137             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  1138         16  FILLER                      PIC X(35).
  1139         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  1140         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  1141
  1142     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  1143         16  AT-PROMPT-LINE-1            PIC X(60).
  1144         16  AT-PROMPT-LINE-2            PIC X(60).
  1145         16  AT-PROMPT-START-DT          PIC XX.
  1146         16  AT-PROMPT-END-DT            PIC XX.
  1147         16  FILLER                      PIC X(35).
  1148         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  1149         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  1150
  1151     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1152         16  AT-DENIAL-INFO-1            PIC X(60).
  1153         16  AT-DENIAL-INFO-2            PIC X(60).
  1154         16  AT-DENIAL-DT                PIC XX.
  1155         16  AT-RETRACTION-DT            PIC XX.
  1156         16  AT-DENIAL-REASON-CODE       PIC X(4).
  1157*         16  FILLER                      PIC X(31).
  1158         16  AT-DENIAL-PROOF-DT          PIC XX.
  1159         16  FILLER                      PIC X(29).
  1160         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  1161         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  1162
  1163     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  1164         16  AT-OLD-INCURRED-DT          PIC XX.
  1165         16  AT-OLD-REPORTED-DT          PIC XX.
  1166         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  1167         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  1168         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  1169         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  1170         16  AT-OLD-PAID-THRU-DT         PIC XX.
  1171         16  AT-LAST-PMT-MADE-DT         PIC XX.
  1172         16  FILLER                      PIC X(26).
  1173         16  AT-OLD-DIAG-CODE            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  22
* NSRLTRBL.cbl
  1174         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  1175         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  1176         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  1177         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  1178         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  1179         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  1180         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  1181         16  AT-OLD-ICD-CODE-1           PIC X(8).
  1182         16  AT-OLD-ICD-CODE-2           PIC X(8).
  1183         16  FILLER                      PIC X(9).
  1184         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  1185
  1186     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  1187         16  AT-FORM-SEND-ON-DT          PIC XX.
  1188         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  1189         16  AT-FORM-RE-SEND-DT          PIC XX.
  1190         16  AT-FORM-ANSWERED-DT         PIC XX.
  1191         16  AT-FORM-PRINTED-DT          PIC XX.
  1192         16  AT-FORM-REPRINT-DT          PIC XX.
  1193         16  AT-FORM-TYPE                PIC X.
  1194             88  INITIAL-FORM                  VALUE '1'.
  1195             88  PROGRESS-FORM                 VALUE '2'.
  1196         16  AT-INSTRUCT-LN-1            PIC X(28).
  1197         16  AT-INSTRUCT-LN-2            PIC X(28).
  1198         16  AT-INSTRUCT-LN-3            PIC X(28).
  1199         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  1200         16  AT-FORM-ADDRESS             PIC X.
  1201             88  FORM-TO-INSURED              VALUE 'I'.
  1202             88  FORM-TO-ACCOUNT              VALUE 'A'.
  1203             88  FORM-TO-OTHER-1              VALUE 'O'.
  1204             88  FORM-TO-OTHER-2              VALUE 'Q'.
  1205         16  AT-RELATED-1.
  1206             20 AT-REL-CARR-1            PIC X.
  1207             20 AT-REL-CLAIM-1           PIC X(7).
  1208             20 AT-REL-CERT-1            PIC X(11).
  1209         16  AT-RELATED-2.
  1210             20 AT-REL-CARR-2            PIC X.
  1211             20 AT-REL-CLAIM-2           PIC X(7).
  1212             20 AT-REL-CERT-2            PIC X(11).
  1213         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  1214         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  1215         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  1216         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  1217         16  AT-FORM-REM-PRINT-DT        PIC XX.
  1218         16  AT-STOP-FORM-DT             PIC X(2).
  1219
  1220         16  FILLER                      PIC X(09).
  1221         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  1222         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  1223******************************************************************
  1224*                                COPY ELCCERT.
  1225******************************************************************
  1226*                                                                *
  1227*                            ELCCERT.                            *
  1228*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1229*                            VMOD=2.013                          *
  1230*                                                                *
  1231*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  23
* NSRLTRBL.cbl
  1232*                                                                *
  1233*   FILE TYPE = VSAM,KSDS                                        *
  1234*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1235*                                                                *
  1236*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1237*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1238*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1239*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1240*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1241*                                                                *
  1242*   LOG = YES                                                    *
  1243*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1244******************************************************************
  1245*                   C H A N G E   L O G
  1246*
  1247* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1248*-----------------------------------------------------------------
  1249*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1250* EFFECTIVE    NUMBER
  1251*-----------------------------------------------------------------
  1252* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1253* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1254* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1255* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1256* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1257* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1258* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1259* 032612  CR2011110200001  PEMA  AHL CHANGES
  1260* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1261* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1262* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  1263******************************************************************
  1264
  1265 01  CERTIFICATE-MASTER.
  1266     12  CM-RECORD-ID                      PIC XX.
  1267         88  VALID-CM-ID                      VALUE 'CM'.
  1268
  1269     12  CM-CONTROL-PRIMARY.
  1270         16  CM-COMPANY-CD                 PIC X.
  1271         16  CM-CARRIER                    PIC X.
  1272         16  CM-GROUPING.
  1273             20  CM-GROUPING-PREFIX        PIC X(3).
  1274             20  CM-GROUPING-PRIME         PIC X(3).
  1275         16  CM-STATE                      PIC XX.
  1276         16  CM-ACCOUNT.
  1277             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1278             20  CM-ACCOUNT-PRIME          PIC X(6).
  1279         16  CM-CERT-EFF-DT                PIC XX.
  1280         16  CM-CERT-NO.
  1281             20  CM-CERT-PRIME             PIC X(10).
  1282             20  CM-CERT-SFX               PIC X.
  1283
  1284     12  CM-CONTROL-BY-NAME.
  1285         16  CM-COMPANY-CD-A1              PIC X.
  1286         16  CM-INSURED-LAST-NAME          PIC X(15).
  1287         16  CM-INSURED-INITIALS.
  1288             20  CM-INSURED-INITIAL1       PIC X.
  1289             20  CM-INSURED-INITIAL2       PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  24
* NSRLTRBL.cbl
  1290
  1291     12  CM-CONTROL-BY-SSN.
  1292         16  CM-COMPANY-CD-A2              PIC X.
  1293         16  CM-SOC-SEC-NO.
  1294             20  CM-SSN-STATE              PIC XX.
  1295             20  CM-SSN-ACCOUNT            PIC X(6).
  1296             20  CM-SSN-LN3.
  1297                 25  CM-INSURED-INITIALS-A2.
  1298                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1299                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1300                 25 CM-PART-LAST-NAME-A2         PIC X.
  1301
  1302     12  CM-CONTROL-BY-CERT-NO.
  1303         16  CM-COMPANY-CD-A4              PIC X.
  1304         16  CM-CERT-NO-A4                 PIC X(11).
  1305
  1306     12  CM-CONTROL-BY-MEMB.
  1307         16  CM-COMPANY-CD-A5              PIC X.
  1308         16  CM-MEMBER-NO.
  1309             20  CM-MEMB-STATE             PIC XX.
  1310             20  CM-MEMB-ACCOUNT           PIC X(6).
  1311             20  CM-MEMB-LN4.
  1312                 25  CM-INSURED-INITIALS-A5.
  1313                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1314                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1315                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1316
  1317     12  CM-INSURED-PROFILE-DATA.
  1318         16  CM-INSURED-FIRST-NAME.
  1319             20  CM-INSURED-1ST-INIT       PIC X.
  1320             20  FILLER                    PIC X(9).
  1321         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1322         16  CM-INSURED-SEX                PIC X.
  1323             88  CM-SEX-MALE                  VALUE 'M'.
  1324             88  CM-SEX-FEMAL                 VALUE 'F'.
  1325         16  CM-INSURED-JOINT-AGE          PIC 99.
  1326         16  CM-JOINT-INSURED-NAME.
  1327             20  CM-JT-LAST-NAME           PIC X(15).
  1328             20  CM-JT-FIRST-NAME.
  1329                 24  CM-JT-1ST-INIT        PIC X.
  1330                 24  FILLER                PIC X(9).
  1331             20  CM-JT-INITIAL             PIC X.
  1332
  1333     12  CM-LIFE-DATA.
  1334         16  CM-LF-BENEFIT-CD              PIC XX.
  1335         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1336         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1337         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1338         16  CM-LF-DEV-CODE                PIC XXX.
  1339         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1340         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1341         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1342         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1343         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1344         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1345         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1346         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1347         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  25
* NSRLTRBL.cbl
  1348         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1349         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1350         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1351         16  cm-temp-epiq                  pic xx.
  1352             88  EPIQ-CLASS                  value 'EQ'.
  1353*        16  FILLER                        PIC XX.
  1354
  1355     12  CM-AH-DATA.
  1356         16  CM-AH-BENEFIT-CD              PIC XX.
  1357         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1358         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1359         16  CM-AH-DEV-CODE                PIC XXX.
  1360         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1361         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1362         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1363         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1364         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1365         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1366         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1367         16  CM-AH-PAID-THRU-DT            PIC XX.
  1368             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1369         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1370         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  1371         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1372         16  FILLER                        PIC X.
  1373
  1374     12  CM-LOAN-INFORMATION.
  1375         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1376         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1377                                           PIC S9(5)V99  COMP-3.
  1378         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1379         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1380         16  CM-PAY-FREQUENCY              PIC S99.
  1381         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1382         16  CM-RATE-CLASS                 PIC XX.
  1383         16  CM-BENEFICIARY                PIC X(25).
  1384         16  CM-POLICY-FORM-NO             PIC X(12).
  1385         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1386         16  CM-LAST-ADD-ON-DT             PIC XX.
  1387         16  CM-DEDUCTIBLE-AMOUNTS.
  1388             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1389             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1390         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1391             20  CM-RESIDENT-STATE         PIC XX.
  1392             20  CM-RATE-CODE              PIC X(4).
  1393             20  FILLER                    PIC XX.
  1394         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1395             20  CM-LOAN-OFFICER           PIC X(5).
  1396             20  FILLER                    PIC XXX.
  1397         16  CM-CSR-CODE                   PIC XXX.
  1398         16  CM-UNDERWRITING-CODE          PIC X.
  1399             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1400         16  CM-POST-CARD-IND              PIC X.
  1401         16  CM-REF-INTERFACE-SW           PIC X.
  1402         16  CM-PREMIUM-TYPE               PIC X.
  1403             88  CM-SING-PRM                  VALUE '1'.
  1404             88  CM-O-B-COVERAGE              VALUE '2'.
  1405             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  26
* NSRLTRBL.cbl
  1406         16  CM-IND-GRP-TYPE               PIC X.
  1407             88  CM-INDIVIDUAL                VALUE 'I'.
  1408             88  CM-GROUP                     VALUE 'G'.
  1409         16  CM-SKIP-CODE                  PIC X.
  1410             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1411             88  SKIP-JULY                    VALUE '1'.
  1412             88  SKIP-AUGUST                  VALUE '2'.
  1413             88  SKIP-SEPTEMBER               VALUE '3'.
  1414             88  SKIP-JULY-AUG                VALUE '4'.
  1415             88  SKIP-AUG-SEPT                VALUE '5'.
  1416             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1417             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1418             88  SKIP-JUNE                    VALUE '8'.
  1419             88  SKIP-JUNE-JULY               VALUE '9'.
  1420             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1421             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1422         16  CM-PAYMENT-MODE               PIC X.
  1423             88  PAY-MONTHLY                  VALUE SPACE.
  1424             88  PAY-WEEKLY                   VALUE '1'.
  1425             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1426             88  PAY-BI-WEEKLY                VALUE '3'.
  1427             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1428         16  CM-LOAN-NUMBER                PIC X(8).
  1429         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1430         16  CM-OLD-LOF                    PIC XXX.
  1431*        16  CM-LOAN-OFFICER               PIC XXX.
  1432         16  CM-REIN-TABLE                 PIC XXX.
  1433         16  CM-SPECIAL-REIN-CODE          PIC X.
  1434         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1435         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1436         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1437
  1438     12  CM-STATUS-DATA.
  1439         16  CM-ENTRY-STATUS               PIC X.
  1440         16  CM-ENTRY-DT                   PIC XX.
  1441
  1442         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1443         16  CM-LF-CANCEL-DT               PIC XX.
  1444         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1445
  1446         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1447         16  CM-LF-DEATH-DT                PIC XX.
  1448         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1449
  1450         16  CM-LF-CURRENT-STATUS          PIC X.
  1451             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1452                                                'M' '4' '5' '9'.
  1453             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1454             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1455             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1456             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1457             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1458             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1459             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1460             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1461             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1462             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1463             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  27
* NSRLTRBL.cbl
  1464             88  CM-LF-DECLINED               VALUE 'D'.
  1465             88  CM-LF-VOIDED                 VALUE 'V'.
  1466
  1467         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1468         16  CM-AH-CANCEL-DT               PIC XX.
  1469         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1470
  1471         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1472         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1473         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1474
  1475         16  CM-AH-CURRENT-STATUS          PIC X.
  1476             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1477                                                'M' '4' '5' '9'.
  1478             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1479             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1480             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1481             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1482             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1483             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1484             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1485             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1486             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1487             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1488             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1489             88  CM-AH-DECLINED               VALUE 'D'.
  1490             88  CM-AH-VOIDED                 VALUE 'V'.
  1491
  1492         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1493             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1494             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1495             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1496         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1497
  1498         16  CM-ENTRY-BATCH                PIC X(6).
  1499         16  CM-LF-EXIT-BATCH              PIC X(6).
  1500         16  CM-AH-EXIT-BATCH              PIC X(6).
  1501         16  CM-LAST-MONTH-END             PIC XX.
  1502
  1503     12  CM-NOTE-SW                        PIC X.
  1504         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1505         88  CERT-NOTES-PRESENT               VALUE '1'.
  1506         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1507         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1508         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1509         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1510         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1511         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1512     12  CM-COMP-EXCP-SW                   PIC X.
  1513         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1514         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1515     12  CM-INSURED-ADDRESS-SW             PIC X.
  1516         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1517         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1518
  1519*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1520     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1521     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  28
* NSRLTRBL.cbl
  1522
  1523*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1524     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1525     12  FILLER                            PIC X.
  1526*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1527     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  1528
  1529     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1530         88  CERT-ADDED-BATCH                 VALUE ' '.
  1531         88  CERT-ADDED-ONLINE                VALUE '1'.
  1532         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1533         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1534         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1535     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1536         88  CERT-AS-LOADED                   VALUE ' '.
  1537         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1538         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1539         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1540         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1541         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1542         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1543         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1544
  1545     12  CM-ACCOUNT-COMM-PCTS.
  1546         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1547         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1548
  1549     12  CM-USER-FIELD                     PIC X.
  1550     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1551     12  CM-CLP-STATE                      PIC XX.
  1552     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  1553     12  CM-USER-RESERVED                  PIC XXX.
  1554     12  FILLER REDEFINES CM-USER-RESERVED.
  1555         16  CM-AH-CLASS-CD                PIC XX.
  1556         16  F                             PIC X.
  1557******************************************************************
  1558*                                COPY ERCACCT.
  1559******************************************************************
  1560*                                                                *
  1561*                                                                *
  1562*                            ERCACCT                             *
  1563*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1564*                            VMOD=2.031                          *
  1565*                                                                *
  1566*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1567*                                                                *
  1568*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1569*   VSAM ACCOUNT MASTER FILES.                                   *
  1570*                                                                *
  1571*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1572*                                                                *
  1573*   FILE TYPE = VSAM,KSDS                                        *
  1574*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1575*                                                                *
  1576*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1577*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1578*                                                                *
  1579*   LOG = NO                                                     *
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  29
* NSRLTRBL.cbl
  1580*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1581*                                                                *
  1582*                                                                *
  1583******************************************************************
  1584*                   C H A N G E   L O G
  1585*
  1586* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1587*-----------------------------------------------------------------
  1588*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1589* EFFECTIVE    NUMBER
  1590*-----------------------------------------------------------------
  1591* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1592* 092705    2005050300006  PEMA  ADD SPP LEASES
  1593* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1594* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1595* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1596* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1597* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1598* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1599******************************************************************
  1600
  1601 01  ACCOUNT-MASTER.
  1602     12  AM-RECORD-ID                      PIC XX.
  1603         88  VALID-AM-ID                      VALUE 'AM'.
  1604
  1605     12  AM-CONTROL-PRIMARY.
  1606         16  AM-COMPANY-CD                 PIC X.
  1607         16  AM-MSTR-CNTRL.
  1608             20  AM-CONTROL-A.
  1609                 24  AM-CARRIER            PIC X.
  1610                 24  AM-GROUPING.
  1611                     28 AM-GROUPING-PREFIX PIC XXX.
  1612                     28 AM-GROUPING-PRIME  PIC XXX.
  1613                 24  AM-STATE              PIC XX.
  1614                 24  AM-ACCOUNT.
  1615                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1616                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1617             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1618                                           PIC X(19).
  1619             20  AM-CNTRL-B.
  1620                 24  AM-EXPIRATION-DT      PIC XX.
  1621                 24  FILLER                PIC X(4).
  1622             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1623                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1624
  1625     12  AM-CONTROL-BY-VAR-GRP.
  1626         16  AM-COMPANY-CD-A1              PIC X.
  1627         16  AM-VG-CARRIER                 PIC X.
  1628         16  AM-VG-GROUPING                PIC X(6).
  1629         16  AM-VG-STATE                   PIC XX.
  1630         16  AM-VG-ACCOUNT                 PIC X(10).
  1631         16  AM-VG-DATE.
  1632             20  AM-VG-EXPIRATION-DT       PIC XX.
  1633             20  FILLER                    PIC X(4).
  1634         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1635                                           PIC 9(11)      COMP-3.
  1636     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1637         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  30
* NSRLTRBL.cbl
  1638         16  AM-VG-KEY3.
  1639             20  AM-VG3-ACCOUNT            PIC X(10).
  1640             20  AM-VG3-EXP-DT             PIC XX.
  1641         16  FILLER                        PIC X(4).
  1642     12  AM-MAINT-INFORMATION.
  1643         16  AM-LAST-MAINT-DT              PIC XX.
  1644         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1645         16  AM-LAST-MAINT-USER            PIC X(4).
  1646         16  FILLER                        PIC XX.
  1647
  1648     12  AM-EFFECTIVE-DT                   PIC XX.
  1649     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1650
  1651     12  AM-PREV-DATES  COMP-3.
  1652         16  AM-PREV-EXP-DT                PIC 9(11).
  1653         16  AM-PREV-EFF-DT                PIC 9(11).
  1654
  1655     12  AM-REPORT-CODE-1                  PIC X(10).
  1656     12  AM-REPORT-CODE-2                  PIC X(10).
  1657
  1658     12  AM-CITY-CODE                      PIC X(4).
  1659     12  AM-COUNTY-PARISH                  PIC X(6).
  1660
  1661     12  AM-NAME                           PIC X(30).
  1662     12  AM-PERSON                         PIC X(30).
  1663     12  AM-ADDRS                          PIC X(30).
  1664     12  AM-CITY.
  1665         16  AM-ADDR-CITY                  PIC X(28).
  1666         16  AM-ADDR-STATE                 PIC XX.
  1667     12  AM-ZIP.
  1668         16  AM-ZIP-PRIME.
  1669             20  AM-ZIP-PRI-1ST            PIC X.
  1670                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1671             20  FILLER                    PIC X(4).
  1672         16  AM-ZIP-PLUS4                  PIC X(4).
  1673     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1674         16  AM-CAN-POSTAL-1               PIC XXX.
  1675         16  AM-CAN-POSTAL-2               PIC XXX.
  1676         16  FILLER                        PIC XXX.
  1677     12  AM-TEL-NO.
  1678         16  AM-AREA-CODE                  PIC 999.
  1679         16  AM-TEL-PRE                    PIC 999.
  1680         16  AM-TEL-NBR                    PIC 9(4).
  1681     12  AM-TEL-LOC                        PIC X.
  1682         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1683         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1684
  1685     12  AM-COMM-STRUCTURE.
  1686         16  AM-DEFN-1.
  1687             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1688                 24  AM-AGT.
  1689                     28  AM-AGT-PREFIX     PIC X(4).
  1690                     28  AM-AGT-PRIME      PIC X(6).
  1691                 24  AM-COM-TYP            PIC X.
  1692                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1693                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1694                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1695                 24  AM-RECALC-LV-INDIC    PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  31
* NSRLTRBL.cbl
  1696                 24  AM-RETRO-LV-INDIC     PIC X.
  1697                 24  AM-GL-CODES           PIC X.
  1698                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1699                 24  FILLER                PIC X(01).
  1700         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1701             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1702                 24  FILLER                PIC X(11).
  1703                 24  AM-L-COMA             PIC XXX.
  1704                 24  AM-J-COMA             PIC XXX.
  1705                 24  AM-A-COMA             PIC XXX.
  1706                 24  FILLER                PIC X(6).
  1707
  1708     12  AM-COMM-CHANGE-STATUS             PIC X.
  1709         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1710
  1711     12  AM-CSR-CODE                       PIC X(4).
  1712
  1713     12  AM-BILLING-STATUS                 PIC X.
  1714         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1715         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1716     12  AM-AUTO-REFUND-SW                 PIC X.
  1717         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1718         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1719     12  AM-GPCD                           PIC 99.
  1720     12  AM-IG                             PIC X.
  1721         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1722         88  AM-HAS-GROUP                     VALUE '2'.
  1723     12  AM-STATUS                         PIC X.
  1724         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1725         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1726         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1727         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1728         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1729         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1730         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1731         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1732         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1733         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1734     12  AM-REMIT-TO                       PIC 99.
  1735     12  AM-ID-NO                          PIC X(11).
  1736
  1737     12  AM-CAL-TABLE                      PIC XX.
  1738     12  AM-LF-DEVIATION                   PIC XXX.
  1739     12  AM-AH-DEVIATION                   PIC XXX.
  1740     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1741     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1742     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1743     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1744     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1745     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1746
  1747     12  AM-USER-FIELDS.
  1748         16  AM-FLD-1                      PIC XX.
  1749         16  AM-FLD-2                      PIC XX.
  1750         16  AM-FLD-3                      PIC XX.
  1751         16  AM-FLD-4                      PIC XX.
  1752         16  AM-FLD-5                      PIC XX.
  1753
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  32
* NSRLTRBL.cbl
  1754     12  AM-1ST-PROD-DATE.
  1755         16  AM-1ST-PROD-YR                PIC XX.
  1756         16  AM-1ST-PROD-MO                PIC XX.
  1757         16  AM-1ST-PROD-DA                PIC XX.
  1758     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1759     12  AM-CERTS-PURGED-DATE.
  1760         16  AM-PUR-YR                     PIC XX.
  1761         16  AM-PUR-MO                     PIC XX.
  1762         16  AM-PUR-DA                     PIC XX.
  1763     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1764     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1765     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1766     12  AM-INACTIVE-DATE.
  1767         16  AM-INA-MO                     PIC 99.
  1768         16  AM-INA-DA                     PIC 99.
  1769         16  AM-INA-YR                     PIC 99.
  1770     12  AM-AR-HI-CERT-DATE                PIC XX.
  1771
  1772     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1773     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1774
  1775     12  AM-OB-PAYMENT-MODE                PIC X.
  1776         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1777         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1778         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1779         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1780
  1781     12  AM-AH-ONLY-INDICATOR              PIC X.
  1782         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1783         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1784
  1785     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1786
  1787     12  AM-OVER-SHORT.
  1788         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1789         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1790
  1791     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1792     12  AM-DCC-CLP-STATE                  PIC XX.
  1793
  1794     12  AM-RECALC-COMM                    PIC X.
  1795     12  AM-RECALC-REIN                    PIC X.
  1796
  1797     12  AM-REI-TABLE                      PIC XXX.
  1798     12  AM-REI-ET-LF                      PIC X.
  1799     12  AM-REI-ET-AH                      PIC X.
  1800     12  AM-REI-PE-LF                      PIC X.
  1801     12  AM-REI-PE-AH                      PIC X.
  1802     12  AM-REI-PRT-ST                     PIC X.
  1803     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1804     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1805     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1806     12  AM-REI-GROUP-A                    PIC X(6).
  1807     12  AM-REI-MORT                       PIC X(4).
  1808     12  AM-REI-PRT-OW                     PIC X.
  1809     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1810     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1811     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  33
* NSRLTRBL.cbl
  1812     12  AM-REI-GROUP-B                    PIC X(6).
  1813
  1814     12  AM-TRUST-TYPE                     PIC X(2).
  1815
  1816     12  AM-EMPLOYER-STMT-USED             PIC X.
  1817     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1818
  1819     12  AM-STD-AH-TYPE                    PIC XX.
  1820     12  AM-EARN-METHODS.
  1821         16  AM-EARN-METHOD-R              PIC X.
  1822             88 AM-REF-RL-R78                 VALUE 'R'.
  1823             88 AM-REF-RL-PR                  VALUE 'P'.
  1824             88 AM-REF-RL-MEAN                VALUE 'M'.
  1825             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1826         16  AM-EARN-METHOD-L              PIC X.
  1827             88 AM-REF-LL-R78                 VALUE 'R'.
  1828             88 AM-REF-LL-PR                  VALUE 'P'.
  1829             88 AM-REF-LL-MEAN                VALUE 'M'.
  1830             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1831         16  AM-EARN-METHOD-A              PIC X.
  1832             88 AM-REF-AH-R78                 VALUE 'R'.
  1833             88 AM-REF-AH-PR                  VALUE 'P'.
  1834             88 AM-REF-AH-MEAN                VALUE 'M'.
  1835             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1836             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1837             88 AM-REF-AH-NET                 VALUE 'N'.
  1838
  1839     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1840     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1841     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1842
  1843     12  AM-RET-Y-N                        PIC X.
  1844     12  AM-RET-P-E                        PIC X.
  1845     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1846     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1847     12  AM-RET-GRP                        PIC X(6).
  1848     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1849         16  AM-POOL-PRIME                 PIC XXX.
  1850         16  AM-POOL-SUB                   PIC XXX.
  1851     12  AM-RETRO-EARNINGS.
  1852         16  AM-RET-EARN-R                 PIC X.
  1853         16  AM-RET-EARN-L                 PIC X.
  1854         16  AM-RET-EARN-A                 PIC X.
  1855     12  AM-RET-ST-TAX-USE                 PIC X.
  1856         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1857         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1858     12  AM-RETRO-BEG-EARNINGS.
  1859         16  AM-RET-BEG-EARN-R             PIC X.
  1860         16  AM-RET-BEG-EARN-L             PIC X.
  1861         16  AM-RET-BEG-EARN-A             PIC X.
  1862     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1863     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1864
  1865     12  AM-USER-SELECT-OPTIONS.
  1866         16  AM-USER-SELECT-1              PIC X(10).
  1867         16  AM-USER-SELECT-2              PIC X(10).
  1868         16  AM-USER-SELECT-3              PIC X(10).
  1869         16  AM-USER-SELECT-4              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  34
* NSRLTRBL.cbl
  1870         16  AM-USER-SELECT-5              PIC X(10).
  1871
  1872     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1873
  1874     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1875
  1876     12  AM-RPT045A-SWITCH                 PIC X.
  1877         88  RPT045A-OFF                   VALUE 'N'.
  1878
  1879     12  AM-INSURANCE-LIMITS.
  1880         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1881         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1882
  1883     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1884         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1885
  1886     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1887         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1888         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1889
  1890     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1891
  1892     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1893     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1894     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1895     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1896     12  AM-DCC-UEF-STATE                  PIC XX.
  1897     12  FILLER                            PIC XXX.
  1898     12  AM-REPORT-CODE-3                  PIC X(10).
  1899*    12  FILLER                            PIC X(22).
  1900
  1901     12  AM-RESERVE-DATE.
  1902         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1903         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1904         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1905
  1906     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1907     12  AM-NOTIFICATION-TYPES.
  1908         16  AM-NOTIF-OF-LETTERS           PIC X.
  1909         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1910         16  AM-NOTIF-OF-REPORTS           PIC X.
  1911         16  AM-NOTIF-OF-STATUS            PIC X.
  1912
  1913     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1914         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1915         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1916         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1917         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1918
  1919     12  AM-BENEFIT-CONTROLS.
  1920         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1921             20  AM-BENEFIT-CODE           PIC XX.
  1922             20  AM-BENEFIT-TYPE           PIC X.
  1923             20  AM-BENEFIT-REVISION       PIC XXX.
  1924             20  AM-BENEFIT-REM-TERM       PIC X.
  1925             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1926             20  FILLER                    PIC XX.
  1927         16  FILLER                        PIC X(80).
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  35
* NSRLTRBL.cbl
  1928
  1929     12  AM-TRANSFER-DATA.
  1930         16  AM-TRANSFERRED-FROM.
  1931             20  AM-TRNFROM-CARRIER        PIC X.
  1932             20  AM-TRNFROM-GROUPING.
  1933                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1934                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1935             20  AM-TRNFROM-STATE          PIC XX.
  1936             20  AM-TRNFROM-ACCOUNT.
  1937                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1938                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1939             20  AM-TRNFROM-DTE            PIC XX.
  1940         16  AM-TRANSFERRED-TO.
  1941             20  AM-TRNTO-CARRIER          PIC X.
  1942             20  AM-TRNTO-GROUPING.
  1943                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1944                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1945             20  AM-TRNTO-STATE            PIC XX.
  1946             20  AM-TRNTO-ACCOUNT.
  1947                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1948                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1949             20  AM-TRNTO-DTE              PIC XX.
  1950         16  FILLER                        PIC X(10).
  1951
  1952     12  AM-SAVED-REMIT-TO                 PIC 99.
  1953
  1954     12  AM-COMM-STRUCTURE-SAVED.
  1955         16  AM-DEFN-1-SAVED.
  1956             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1957                 24  AM-AGT-SV             PIC X(10).
  1958                 24  AM-COM-TYP-SV         PIC X.
  1959                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1960                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1961                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1962                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1963                 24  FILLER                PIC X.
  1964                 24  AM-GL-CODES-SV        PIC X.
  1965                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1966                 24  FILLER                PIC X.
  1967         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1968             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1969                 24  FILLER                PIC X(11).
  1970                 24  AM-L-COMA-SV          PIC XXX.
  1971                 24  AM-J-COMA-SV          PIC XXX.
  1972                 24  AM-A-COMA-SV          PIC XXX.
  1973                 24  FILLER                PIC X(6).
  1974
  1975     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1976         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1977            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1978            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1979            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1980
  1981     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1982     12  FILLER                            PIC X(120).
  1983
  1984     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1985         16  AM-CONTROL-NAME               PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  36
* NSRLTRBL.cbl
  1986         16  AM-EXECUTIVE-ONE.
  1987             20  AM-EXEC1-NAME             PIC X(15).
  1988             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1989                                                          COMP-3.
  1990             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1991                                                          COMP-3.
  1992         16  AM-EXECUTIVE-TWO.
  1993             20  AM-EXEC2-NAME             PIC X(15).
  1994             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1995                                                          COMP-3.
  1996             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1997                                                          COMP-3.
  1998
  1999     12  AM-RETRO-ADDITIONAL-DATA.
  2000         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2001         16  AM-RETRO-PREM-P-E             PIC X.
  2002         16  AM-RETRO-CLMS-P-I             PIC X.
  2003         16  AM-RETRO-RET-BRACKET-LF.
  2004             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2005                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2006                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2007             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2008                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2009                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2010             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2011                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2012                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2013         16  AM-RETRO-RET-BRACKET-AH.
  2014             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2015                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2016                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2017                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2018             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2019                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2020                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2021             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2022                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2023                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2024
  2025     12  AM-COMMENTS.
  2026         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2027
  2028     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2029         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2030         16  AM-FLI-BILLING-CODE           PIC X.
  2031         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2032         16  AM-FLI-UNITED-IDENT           PIC X.
  2033         16  AM-FLI-INTEREST-LOST-DATA.
  2034             20  AM-FLI-BANK-NO            PIC X(5).
  2035             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2036             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2037             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2038         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2039             20  AM-FLI-AGT                PIC X(9).
  2040             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2041             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2042         16  FILLER                        PIC X(102).
  2043
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  37
* NSRLTRBL.cbl
  2044     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2045         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2046             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2047             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2048             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2049             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2050             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2051         16  FILLER                          PIC X(10).
  2052******************************************************************
  2053*                                COPY ELCBENE.
  2054******************************************************************
  2055*                                                                *
  2056*                            ELCBENE.                            *
  2057*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2058*                            VMOD=2.006                          *
  2059*                                                                *
  2060*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  2061*                                                                *
  2062*   FILE TYPE = VSAM,KSDS                                        *
  2063*   RECORD SIZE = 500   RECFORM = FIX                            *
  2064*                                                                *
  2065*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  2066*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  2067*                                                                *
  2068*   LOG = YES                                                    *
  2069*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2070*                                                                *
  2071*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  2072******************************************************************
  2073*                   C H A N G E   L O G
  2074*
  2075* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2076*-----------------------------------------------------------------
  2077*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2078* EFFECTIVE    NUMBER
  2079*-----------------------------------------------------------------
  2080* 013017  CR2016053100001  PEMA  ACH PROCESSING
  2081* 082317  CR2017082100003  PEMA  Add sub type
  2082* 032019  CR2019011400002  PEMA  Add email address for ach report
  2083******************************************************************
  2084
  2085 01  BENEFICIARY-MASTER.
  2086     12  BE-RECORD-ID                PIC XX.
  2087         88  VALID-BE-ID                VALUE 'BE'.
  2088
  2089     12  BE-CONTROL-PRIMARY.
  2090         16  BE-COMPANY-CD           PIC X.
  2091         16  BE-RECORD-TYPE          PIC X.
  2092             88  BENEFICIARY-RECORD  VALUE 'B'.
  2093             88  ADJUSTOR-RECORD     VALUE 'A'.
  2094         16  BE-BENEFICIARY          PIC X(10).
  2095     12  BE-CONTROL-BY-NAME.
  2096         16  BE-COMPANY-CD-A1        PIC X.
  2097         16  BE-RECORD-TYPE-A1       PIC X.
  2098         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  2099         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  2100
  2101     12  BE-LAST-MAINT-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  38
* NSRLTRBL.cbl
  2102     12  BE-LAST-MAINT-BY            PIC X(4).
  2103     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  2104
  2105     12  BE-ADDRESS-DATA.
  2106         16  BE-MAIL-TO-NAME         PIC X(30).
  2107         16  BE-ADDRESS-LINE-1       PIC X(30).
  2108         16  BE-ADDRESS-LINE-2       PIC X(30).
  2109         16  BE-ADDRESS-LINE-3       PIC X(30).
  2110         16  BE-CITY-STATE.
  2111             20  BE-CITY             PIC X(28).
  2112             20  BE-STATE            PIC XX.
  2113         16  BE-ZIP-CODE.
  2114             20  BE-ZIP-PRIME.
  2115                 24  BE-ZIP-1ST      PIC X.
  2116                     88  BE-CANADIAN-POST-CODE
  2117                                         VALUE 'A' THRU 'Z'.
  2118                 24  FILLER          PIC X(4).
  2119             20  BE-ZIP-PLUS4        PIC X(4).
  2120         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  2121             20  BE-CAN-POSTAL-1     PIC XXX.
  2122             20  BE-CAN-POSTAL-2     PIC XXX.
  2123             20  FILLER              PIC XXX.
  2124         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  2125         16  BE-GROUP-CHECKS-Y-N     PIC X.
  2126
  2127******************************************************************
  2128*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  2129*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  2130******************************************************************
  2131     12  BE-CARRIER                  PIC X.
  2132
  2133     12  BE-ADDRESS-DATA2.
  2134         16  BE-MAIL-TO-NAME2        PIC X(30).
  2135         16  BE-ADDRESS-LINE-12      PIC X(30).
  2136         16  BE-ADDRESS-LINE-22      PIC X(30).
  2137         16  BE-ADDRESS-LINE-32      PIC X(30).
  2138         16  BE-CITY-STATE2.
  2139             20  BE-CITY2            PIC X(28).
  2140             20  BE-STATE2           PIC XX.
  2141         16  BE-ZIP-CODE2.
  2142             20  BE-ZIP-PRIME2.
  2143                 24  BE-ZIP-1ST2     PIC X.
  2144                     88  BE-CANADIAN-POST-CODE2
  2145                                         VALUE 'A' THRU 'Z'.
  2146                 24  FILLER          PIC X(4).
  2147             20  BE-ZIP-PLUS42       PIC X(4).
  2148         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  2149             20  BE-CAN-POSTAL-12    PIC XXX.
  2150             20  BE-CAN-POSTAL-22    PIC XXX.
  2151             20  FILLER              PIC XXX.
  2152         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  2153         16  BE-ACH-DATA.
  2154             20  BE-ACH-YES-OR-NO    PIC X.
  2155                 88  BE-ON-ACH       VALUE 'Y'.
  2156                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  2157             20  BE-ACH-ABA-ROUTING-NUMBER
  2158                                     PIC X(15).
  2159             20  BE-ACH-BANK-ACCOUNT-NUMBER
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  39
* NSRLTRBL.cbl
  2160                                     PIC X(20).
  2161             20  BE-ACH-SUB-TYPE     PIC XX.
  2162             20  BE-ACH-EMAIL-YN     PIC X.
  2163                 88  BE-EMAIL-ACH-RPT  VALUE 'Y'.
  2164             20  be-ach-email-addr   PIC X(40).
  2165         16  BE-BILLING-STMT-DATA.
  2166*            20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  2167             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  2168             20  BE-OUTPUT-TYPE      PIC X.
  2169                 88  BE-FAX-OUTPUT         VALUE 'F'.
  2170                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  2171
  2172     12  filler                      PIC X(16).
  2173******************************************************************
  2174*                                COPY ELCTEXT.
  2175******************************************************************
  2176*                                                                *
  2177*                                                                *
  2178*                            ELCTEXT.                            *
  2179*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2180*                            VMOD=2.008                          *
  2181*                                                                *
  2182*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  2183*                                     FORM LETTERS,              *
  2184*                                     CERT FORM DISPLAY.
  2185*                                                                *
  2186*   FILE TYPE = VSAM,KSDS                                        *
  2187*   RECORD SIZE = 100   RECFORM = FIXED                          *
  2188*                                                                *
  2189*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  2190*       ALTERNATE INDEX = NONE                                   *
  2191*                                                                *
  2192*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  2193*       ALTERNATE INDEX = NONE                                   *
  2194*                                                                *
  2195*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  2196*       ALTERNATE INDEX = NONE                                   *
  2197*                                                                *
  2198*   LOG = NO                                                     *
  2199*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2200******************************************************************
  2201 01  TEXT-FILES.
  2202     12  TEXT-FILE-ID                PIC XX.
  2203         88  FORMS-FILE-TEXT            VALUE 'TF'.
  2204         88  LETTER-FILE-TEXT           VALUE 'TL'.
  2205         88  HELP-FILE-TEXT             VALUE 'TH'.
  2206
  2207     12  TX-CONTROL-PRIMARY.
  2208         16  TX-COMPANY-CD           PIC X.
  2209             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  2210         16  TX-ACCESS-CD-GENL       PIC X(12).
  2211
  2212         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2213             20  TX-LETTER-NO        PIC X(4).
  2214             20  FILLER              PIC X(8).
  2215
  2216         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2217             20  TX-FORM-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  40
* NSRLTRBL.cbl
  2218
  2219         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2220             20  TX-HELP-TYPE        PIC X.
  2221                 88  HELP-FOR-GENERAL   VALUE ' '.
  2222                 88  HELP-BY-SCREEN     VALUE 'S'.
  2223                 88  HELP-BY-ERROR      VALUE 'E'.
  2224             20  TX-SCREEN-OR-ERROR  PIC X(4).
  2225                 88  GENERAL-INFO-HELP  VALUE '0000'.
  2226             20  TX-HELP-FOR-COMPANY  PIC XXX.
  2227                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  2228             20  FILLER              PIC X(4).
  2229
  2230         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  2231
  2232     12  TX-PROCESS-CONTROL          PIC XX.
  2233         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  2234
  2235     12  TX-TEXT-LINE                PIC X(70).
  2236
  2237     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  2238         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  2239         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  2240         88  TX-VALID-FORM-SQUEEZE-VALUE
  2241                                        VALUE 'Y' ' '.
  2242
  2243     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  2244         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  2245         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  2246         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  2247         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  2248         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  2249         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  2250         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  2251                                              'K' 'N' ' '
  2252                                              'Z'.
  2253
  2254     12  TX-ARCHIVE-SW               PIC X.
  2255         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  2256         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  2257         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  2258
  2259     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  2260     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  2261
  2262     12  TX-BSR-CODE                 PIC X.
  2263         88  TX-BSR-LETTER              VALUE 'B'.
  2264         88  TX-NON-BSR-LETTER          VALUE ' '.
  2265
  2266     12  FILLER                      PIC X.
  2267*****************************************************************
  2268*                                COPY ELCCNTL.
  2269******************************************************************
  2270*                                                                *
  2271*                                                                *
  2272*                            ELCCNTL.                            *
  2273*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2274*                            VMOD=2.059                          *
  2275*                                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  41
* NSRLTRBL.cbl
  2276*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2277*                                                                *
  2278*   FILE TYPE = VSAM,KSDS                                        *
  2279*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2280*                                                                *
  2281*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2282*       ALTERNATE INDEX = NONE                                   *
  2283*                                                                *
  2284*   LOG = YES                                                    *
  2285*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2286******************************************************************
  2287*                   C H A N G E   L O G
  2288*
  2289* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2290*-----------------------------------------------------------------
  2291*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2292* EFFECTIVE    NUMBER
  2293*-----------------------------------------------------------------
  2294* 082503                   PEMA  ADD BENEFIT GROUP
  2295* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2296* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2297* 092705    2005050300006  PEMA  ADD SPP LEASES
  2298* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2299* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2300* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2301* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2302* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2303* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2304* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2305* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2306* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2307* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2308* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2309******************************************************************
  2310*
  2311 01  CONTROL-FILE.
  2312     12  CF-RECORD-ID                       PIC XX.
  2313         88  VALID-CF-ID                        VALUE 'CF'.
  2314
  2315     12  CF-CONTROL-PRIMARY.
  2316         16  CF-COMPANY-ID                  PIC XXX.
  2317         16  CF-RECORD-TYPE                 PIC X.
  2318             88  CF-COMPANY-MASTER              VALUE '1'.
  2319             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2320             88  CF-STATE-MASTER                VALUE '3'.
  2321             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2322             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2323             88  CF-CARRIER-MASTER              VALUE '6'.
  2324             88  CF-MORTALITY-MASTER            VALUE '7'.
  2325             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2326             88  CF-TERMINAL-MASTER             VALUE '9'.
  2327             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2328             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2329             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2330             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2331             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2332             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2333             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  42
* NSRLTRBL.cbl
  2334             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2335             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2336         16  CF-ACCESS-CD-GENL              PIC X(4).
  2337         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2338             20  CF-PROCESSOR               PIC X(4).
  2339         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2340             20  CF-STATE-CODE              PIC XX.
  2341             20  FILLER                     PIC XX.
  2342         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2343             20  FILLER                     PIC XX.
  2344             20  CF-HI-BEN-IN-REC           PIC XX.
  2345         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2346             20  FILLER                     PIC XXX.
  2347             20  CF-CARRIER-CNTL            PIC X.
  2348         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2349             20  FILLER                     PIC XX.
  2350             20  CF-HI-TYPE-IN-REC          PIC 99.
  2351         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2352             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2353                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2354             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2355             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2356         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2357             20  FILLER                     PIC X.
  2358             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2359         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2360             20  FILLER                     PIC XX.
  2361             20  CF-MORTGAGE-PLAN           PIC XX.
  2362         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2363
  2364     12  CF-LAST-MAINT-DT                   PIC XX.
  2365     12  CF-LAST-MAINT-BY                   PIC X(4).
  2366     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2367
  2368     12  CF-RECORD-BODY                     PIC X(728).
  2369
  2370
  2371****************************************************************
  2372*             COMPANY MASTER RECORD                            *
  2373****************************************************************
  2374
  2375     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2376         16  CF-COMPANY-ADDRESS.
  2377             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2378             20  CF-CL-IN-CARE-OF           PIC X(30).
  2379             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2380             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2381             20  CF-CL-CITY-STATE           PIC X(30).
  2382             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2383             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2384         16  CF-COMPANY-CD                  PIC X.
  2385         16  CF-COMPANY-PASSWORD            PIC X(8).
  2386         16  CF-SECURITY-OPTION             PIC X.
  2387             88  ALL-SECURITY                   VALUE '1'.
  2388             88  COMPANY-VERIFY                 VALUE '2'.
  2389             88  PROCESSOR-VERIFY               VALUE '3'.
  2390             88  NO-SECURITY                    VALUE '4'.
  2391             88  ALL-BUT-TERM                   VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  43
* NSRLTRBL.cbl
  2392         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2393             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2394         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2395             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2396         16  CF-INFORCE-LOCATION            PIC X.
  2397             88  CERTS-ARE-ONLINE               VALUE '1'.
  2398             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2399             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2400         16  CF-LOWER-CASE-LETTERS          PIC X.
  2401         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2402             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2403             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2404             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2405             88  CF-ACCNT-CNTL                  VALUE '3'.
  2406             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2407
  2408         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2409         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2410
  2411         16  CF-LGX-CREDIT-USER             PIC X.
  2412             88  CO-IS-NOT-USER                 VALUE 'N'.
  2413             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2414
  2415         16 CF-CREDIT-CALC-CODES.
  2416             20  CF-CR-REM-TERM-CALC PIC X.
  2417               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2418               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2419               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2420               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2421               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2422               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2423               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2424             20  CF-CR-R78-METHOD           PIC X.
  2425               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2426               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2427
  2428         16  CF-CLAIM-CONTROL-COUNTS.
  2429             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2430                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2431
  2432             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2433                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2434
  2435             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2436                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2437
  2438             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2439                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2440
  2441         16  CF-CURRENT-MONTH-END           PIC XX.
  2442
  2443         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2444             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2445             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2446             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2447             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2448                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2449                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  44
* NSRLTRBL.cbl
  2450             20  CF-CO-PREM-REJECT-SW       PIC X.
  2451                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2452                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2453             20  CF-CO-REF-REJECT-SW        PIC X.
  2454                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2455                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2456
  2457         16  CF-CO-REPORTING-DT             PIC XX.
  2458         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2459         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2460           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2461           88  CF-CO-MONTH-END                  VALUE '1'.
  2462
  2463         16  CF-LGX-CLAIM-USER              PIC X.
  2464             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2465             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2466
  2467         16  CF-CREDIT-EDIT-CONTROLS.
  2468             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2469             20  CF-MIN-AGE                 PIC 99.
  2470             20  CF-DEFAULT-AGE             PIC 99.
  2471             20  CF-MIN-TERM                PIC S999      COMP-3.
  2472             20  CF-MAX-TERM                PIC S999      COMP-3.
  2473             20  CF-DEFAULT-SEX             PIC X.
  2474             20  CF-JOINT-AGE-INPUT         PIC X.
  2475                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2476             20  CF-BIRTH-DATE-INPUT        PIC X.
  2477                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2478             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2479                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2480                 88  CF-ZERO-CARRIER            VALUE '1'.
  2481                 88  CF-ZERO-GROUPING           VALUE '2'.
  2482                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2483             20  CF-EDIT-SW                 PIC X.
  2484                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2485             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2486             20  CF-CR-PR-METHOD            PIC X.
  2487               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2488               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2489             20  FILLER                     PIC X.
  2490
  2491         16  CF-CREDIT-MISC-CONTROLS.
  2492             20  CF-REIN-TABLE-SW           PIC X.
  2493                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2494             20  CF-COMP-TABLE-SW           PIC X.
  2495                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2496             20  CF-EXPERIENCE-RETENTION-AGE
  2497                                            PIC S9        COMP-3.
  2498             20  CF-CONVERSION-DT           PIC XX.
  2499             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2500             20  CF-RUN-FREQUENCY-SW        PIC X.
  2501                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2502                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2503
  2504             20  CF-CR-CHECK-NO-CONTROL.
  2505                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2506                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2507                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  45
* NSRLTRBL.cbl
  2508                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2509                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2510                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2511
  2512                 24  CF-CR-CHECK-COUNT       REDEFINES
  2513                     CF-CR-CHECK-COUNTER      PIC X(4).
  2514
  2515                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2516                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2517
  2518                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2519                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2520                 24  CF-MAIL-PROCESSING       PIC X.
  2521                     88  MAIL-PROCESSING          VALUE 'Y'.
  2522
  2523         16  CF-MISC-SYSTEM-CONTROL.
  2524             20  CF-SYSTEM-C                 PIC X.
  2525                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2526             20  CF-SYSTEM-D                 PIC X.
  2527                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2528             20  CF-SOC-SEC-NO-SW            PIC X.
  2529                 88  SOC-SEC-NO-USED             VALUE '1'.
  2530             20  CF-MEMBER-NO-SW             PIC X.
  2531                 88  MEMBER-NO-USED              VALUE '1'.
  2532             20  CF-TAX-ID-NUMBER            PIC X(11).
  2533             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2534             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2535                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2536                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2537                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2538                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2539             20  CF-SYSTEM-E                 PIC X.
  2540                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2541
  2542         16  CF-LGX-LIFE-USER               PIC X.
  2543             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2544             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2545
  2546         16  CF-CR-MONTH-END-DT             PIC XX.
  2547
  2548         16  CF-FILE-MAINT-DATES.
  2549             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2550                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2551             20  CF-LAST-BATCH       REDEFINES
  2552                 CF-LAST-BATCH-NO               PIC X(4).
  2553             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2554             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2555             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2556             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2557             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2558             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2559             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2560             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2561             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2562             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2563
  2564         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2565         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  46
* NSRLTRBL.cbl
  2566
  2567         16  CF-ALT-MORT-CODE               PIC X(4).
  2568         16  CF-MEMBER-CAPTION              PIC X(10).
  2569
  2570         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2571             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2572             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2573             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2574             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2575             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2576
  2577         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2578
  2579         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2580         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2581         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2582         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2583
  2584         16  CF-AH-OVERRIDE-L1              PIC X.
  2585         16  CF-AH-OVERRIDE-L2              PIC XX.
  2586         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2587         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2588
  2589         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2590         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2591
  2592         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2593         16  CF-AR-LAST-EL860-DT            PIC XX.
  2594         16  CF-MP-MONTH-END-DT             PIC XX.
  2595
  2596         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2597         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2598             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2599
  2600         16  CF-AR-MONTH-END-DT             PIC XX.
  2601
  2602         16  CF-CRDTCRD-USER                PIC X.
  2603             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2604             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2605
  2606         16  CF-CC-MONTH-END-DT             PIC XX.
  2607
  2608         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2609
  2610         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2611             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2612             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2613             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2614         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2615         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2616         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2617         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2618             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2619             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2620         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2621         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2622         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2623             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  47
* NSRLTRBL.cbl
  2624         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2625
  2626         16  CF-CL-ZIP-CODE.
  2627             20  CF-CL-ZIP-PRIME.
  2628                 24  CF-CL-ZIP-1ST          PIC X.
  2629                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2630                 24  FILLER                 PIC X(4).
  2631             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2632         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2633             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2634             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2635             20  FILLER                     PIC XXX.
  2636
  2637         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2638         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2639         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2640         16  CF-CO-OPTION-START-DATE        PIC XX.
  2641         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2642           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2643                                                      '3' '4'.
  2644           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2645           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2646           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2647           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2648           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2649           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2650
  2651         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2652
  2653         16  CF-PAYMENT-APPROVAL-LEVELS.
  2654             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2655             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2656             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2657             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2658             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2659             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2660
  2661         16  CF-END-USER-REPORTING-USER     PIC X.
  2662             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2663             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2664
  2665         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2666             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2667             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2668
  2669         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2670
  2671         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2672         16  FILLER                         PIC X.
  2673
  2674         16  CF-CREDIT-ARCHIVE-CNTL.
  2675             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2676             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2677             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2678
  2679         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2680
  2681         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  48
* NSRLTRBL.cbl
  2682             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2683             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2684
  2685         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2686             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2687             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2688
  2689         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2690
  2691         16  CF-CO-ACH-ID-CODE              PIC  X.
  2692             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2693             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2694             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2695         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2696         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2697         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2698         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2699         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2700         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2701         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2702         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2703         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2704                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2705         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2706                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2707
  2708         16  CF-CO-OVER-SHORT.
  2709             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2710             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2711
  2712*         16  FILLER                         PIC X(102).
  2713         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2714             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2715             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2716
  2717         16  CF-AH-APPROVAL-DAYS.
  2718             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2719             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2720             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2721             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2722
  2723         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2724
  2725         16  CF-APPROV-LEV-5.
  2726             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2727             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2728             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2729
  2730         16  FILLER                         PIC X(68).
  2731****************************************************************
  2732*             PROCESSOR/USER RECORD                            *
  2733****************************************************************
  2734
  2735     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2736         16  CF-PROCESSOR-NAME              PIC X(30).
  2737         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2738         16  CF-PROCESSOR-TITLE             PIC X(26).
  2739         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  49
* NSRLTRBL.cbl
  2740                 88  MESSAGE-YES                VALUE 'Y'.
  2741                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2742
  2743*****************************************************
  2744****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2745****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2746****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2747****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2748*****************************************************
  2749
  2750         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2751             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2752             20  CF-APPLICATION-FORCE       PIC X.
  2753             20  CF-INDIVIDUAL-APP.
  2754                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2755                     28  CF-BROWSE-APP      PIC X.
  2756                     28  CF-UPDATE-APP      PIC X.
  2757
  2758         16  CF-CURRENT-TERM-ON             PIC X(4).
  2759         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2760             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2761             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2762             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2763             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2764             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2765             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2766             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2767         16  CF-PROCESSOR-CARRIER           PIC X.
  2768             88  NO-CARRIER-SECURITY            VALUE ' '.
  2769         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2770             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2771         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2772             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2773         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2774             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2775
  2776         16  CF-PROC-SYS-ACCESS-SW.
  2777             20  CF-PROC-CREDIT-CLAIMS-SW.
  2778                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2779                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2780                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2781                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2782             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2783                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2784                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2785             20  CF-PROC-LIFE-GNRLDGR-SW.
  2786                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2787                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2788                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2789                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2790             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2791                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2792                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2793         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2794             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2795             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2796         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2797
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  50
* NSRLTRBL.cbl
  2798         16  CF-APPROVAL-LEVEL                  PIC X.
  2799             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2800             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2801             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2802             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2803             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2804
  2805         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2806
  2807         16  CF-LANGUAGE-TYPE                   PIC X.
  2808             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2809             88  CF-LANG-IS-FR                      VALUE 'F'.
  2810
  2811         16  CF-CSR-IND                         PIC X.
  2812         16  FILLER                             PIC X(239).
  2813
  2814****************************************************************
  2815*             PROCESSOR/REMINDERS RECORD                       *
  2816****************************************************************
  2817
  2818     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2819         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2820             20  CF-START-REMIND-DT         PIC XX.
  2821             20  CF-END-REMIND-DT           PIC XX.
  2822             20  CF-REMINDER-TEXT           PIC X(50).
  2823         16  FILLER                         PIC X(296).
  2824
  2825
  2826****************************************************************
  2827*             STATE MASTER RECORD                              *
  2828****************************************************************
  2829
  2830     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2831         16  CF-STATE-ABBREVIATION          PIC XX.
  2832         16  CF-STATE-NAME                  PIC X(25).
  2833         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2834         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2835             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2836             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2837             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2838             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2839                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2840                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2841             20  CF-ST-PREM-REJECT-SW       PIC X.
  2842                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2843                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2844             20  CF-ST-REF-REJECT-SW        PIC X.
  2845                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2846                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2847         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2848         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2849         16  CF-ST-REFUND-RULES.
  2850             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2851             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2852             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2853         16  CF-ST-FST-PMT-EXTENSION.
  2854             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2855             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  51
* NSRLTRBL.cbl
  2856                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2857                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2858                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2859                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2860         16  CF-ST-STATE-CALL.
  2861             20  CF-ST-CALL-UNEARNED        PIC X.
  2862             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2863             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2864         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2865             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2866             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2867         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2868         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2869         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2870         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2871         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2872         16  FILLER                         PIC X.
  2873         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2874             20  CF-ST-BENEFIT-CD           PIC XX.
  2875             20  CF-ST-BENEFIT-KIND         PIC X.
  2876                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2877                 88  CF-ST-AH-KIND              VALUE 'A'.
  2878             20  CF-ST-REM-TERM-CALC        PIC X.
  2879                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2880                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2881                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2882                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2883                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2884                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2885                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2886                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2887
  2888             20  CF-ST-REFUND-CALC          PIC X.
  2889                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2890                 88  ST-REFD-BY-R78             VALUE '1'.
  2891                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2892                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2893                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2894                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2895                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2896                 88  ST-REFD-UTAH               VALUE '7'.
  2897                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2898                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2899                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2900
  2901             20  CF-ST-EARNING-CALC         PIC X.
  2902                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2903                 88  ST-EARN-BY-R78             VALUE '1'.
  2904                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2905                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2906                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2907                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2908                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2909                 88  ST-EARN-MEAN               VALUE '8'.
  2910                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2911
  2912             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2913                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  52
* NSRLTRBL.cbl
  2914                 88  ST-OVRD-BY-R78             VALUE '1'.
  2915                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2916                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2917                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2918                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2919                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2920                 88  ST-OVRD-MEAN               VALUE '8'.
  2921                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2922             20  cf-st-extra-periods        pic 9.
  2923*            20  FILLER                     PIC X.
  2924
  2925         16  CF-ST-COMMISSION-CAPS.
  2926             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2927             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2928             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2929             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2930         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2931                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2932                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  2933                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  2934
  2935         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2936
  2937         16  CF-ST-STATUTORY-INTEREST.
  2938             20  CF-ST-STAT-DATE-FROM       PIC X.
  2939                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2940                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2941             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2942             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2943             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2944             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2945             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2946
  2947         16  CF-ST-OVER-SHORT.
  2948             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2949             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2950
  2951         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2952
  2953         16  CF-ST-RT-CALC                  PIC X.
  2954
  2955         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2956         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2957         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2958         16  CF-ST-RF-LR-CALC               PIC X.
  2959         16  CF-ST-RF-LL-CALC               PIC X.
  2960         16  CF-ST-RF-LN-CALC               PIC X.
  2961         16  CF-ST-RF-AH-CALC               PIC X.
  2962         16  CF-ST-RF-CP-CALC               PIC X.
  2963*        16  FILLER                         PIC X(206).
  2964*CIDMOD         16  FILLER                         PIC X(192).
  2965         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2966             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2967         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2968         16  CF-ST-VFY-2ND-BENE             PIC X.
  2969         16  CF-ST-CAUSAL-STATE             PIC X.
  2970         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2971         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  53
* NSRLTRBL.cbl
  2972         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2973             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2974         16  CF-ST-NET-ONLY-STATE           PIC X.
  2975             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2976         16  cf-commission-cap-required     pic x.
  2977         16  CF-ST-GA-COMMISSION-CAPS.
  2978             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  2979             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  2980             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  2981             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  2982         16  CF-ST-TOT-COMMISSION-CAPS.
  2983             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  2984             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  2985             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  2986             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  2987         16  FILLER                         PIC X(156).
  2988
  2989****************************************************************
  2990*             BENEFIT MASTER RECORD                            *
  2991****************************************************************
  2992
  2993     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2994         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2995             20  CF-BENEFIT-CODE            PIC XX.
  2996             20  CF-BENEFIT-NUMERIC  REDEFINES
  2997                 CF-BENEFIT-CODE            PIC XX.
  2998             20  CF-BENEFIT-ALPHA           PIC XXX.
  2999             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3000             20  CF-BENEFIT-COMMENT         PIC X(10).
  3001
  3002             20  CF-LF-COVERAGE-TYPE        PIC X.
  3003                 88  CF-REDUCING                VALUE 'R'.
  3004                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3005
  3006             20  CF-SPECIAL-CALC-CD         PIC X.
  3007                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3008                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3009                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3010                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3011                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3012                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3013                 88  CF-FARM-PLAN               VALUE 'F'.
  3014                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3015                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3016                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3017                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3018                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3019                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3020                 88  CF-PRUDENTIAL              VALUE 'P'.
  3021                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3022                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3023                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3024                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3025                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3026                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3027
  3028             20  CF-JOINT-INDICATOR         PIC X.
  3029                 88  CF-JOINT-COVERAGE          VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  54
* NSRLTRBL.cbl
  3030
  3031*            20  FILLER                     PIC X(12).
  3032             20  cf-maximum-benefits        pic s999 comp-3.
  3033             20  FILLER                     PIC X(09).
  3034             20  CF-BENEFIT-CATEGORY        PIC X.
  3035             20  CF-LOAN-TYPE               PIC X(8).
  3036
  3037             20  CF-CO-REM-TERM-CALC        PIC X.
  3038                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3039                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3040                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3041                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3042                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3043
  3044             20  CF-CO-EARNINGS-CALC        PIC X.
  3045                 88  CO-EARN-BY-R78             VALUE '1'.
  3046                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3047                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3048                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3049                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3050                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3051                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3052                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3053
  3054             20  CF-CO-REFUND-CALC          PIC X.
  3055                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3056                 88  CO-REFD-BY-R78             VALUE '1'.
  3057                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3058                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3059                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3060                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3061                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3062                 88  CO-REFD-MEAN               VALUE '8'.
  3063                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3064                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3065                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3066
  3067             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3068                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3069                 88  CO-OVRD-BY-R78             VALUE '1'.
  3070                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3071                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3072                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3073                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3074                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3075                 88  CO-OVRD-MEAN               VALUE '8'.
  3076                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3077
  3078             20  CF-CO-BEN-I-G-CD           PIC X.
  3079                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3080                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3081                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3082
  3083         16  FILLER                         PIC X(304).
  3084
  3085
  3086****************************************************************
  3087*             CARRIER MASTER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  55
* NSRLTRBL.cbl
  3088****************************************************************
  3089
  3090     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3091         16  CF-ADDRESS-DATA.
  3092             20  CF-MAIL-TO-NAME            PIC X(30).
  3093             20  CF-IN-CARE-OF              PIC X(30).
  3094             20  CF-ADDRESS-LINE-1          PIC X(30).
  3095             20  CF-ADDRESS-LINE-2          PIC X(30).
  3096             20  CF-CITY-STATE              PIC X(30).
  3097             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3098             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3099
  3100         16  CF-CLAIM-NO-CONTROL.
  3101             20  CF-CLAIM-NO-METHOD         PIC X.
  3102                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3103                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3104                 88  CLAIM-NO-SEQ               VALUE '3'.
  3105                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3106             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3107                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3108                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3109                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3110
  3111         16  CF-CHECK-NO-CONTROL.
  3112             20  CF-CHECK-NO-METHOD         PIC X.
  3113                 88  CHECK-NO-MANUAL            VALUE '1'.
  3114                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3115                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3116                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3117             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3118                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3119
  3120         16  CF-DOMICILE-STATE              PIC XX.
  3121
  3122         16  CF-EXPENSE-CONTROLS.
  3123             20  CF-EXPENSE-METHOD          PIC X.
  3124                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3125                 88  DOLLARS-PER-PMT            VALUE '2'.
  3126                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3127                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3128             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3129             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3130
  3131         16  CF-CORRESPONDENCE-CONTROL.
  3132             20  CF-LETTER-RESEND-OPT       PIC X.
  3133                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3134                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3135             20  FILLER                     PIC X(4).
  3136
  3137         16  CF-RESERVE-CONTROLS.
  3138             20  CF-MANUAL-SW               PIC X.
  3139                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3140             20  CF-FUTURE-SW               PIC X.
  3141                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3142             20  CF-PTC-SW                  PIC X.
  3143                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3144             20  CF-IBNR-SW                 PIC X.
  3145                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  56
* NSRLTRBL.cbl
  3146             20  CF-PTC-LF-SW               PIC X.
  3147                 88  CF-LF-PTC-USED             VALUE '1'.
  3148             20  CF-CDT-ACCESS-METHOD       PIC X.
  3149                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3150                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3151                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3152             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3153
  3154         16  CF-CLAIM-CALC-METHOD           PIC X.
  3155             88  360-PLUS-MONTHS                VALUE '1'.
  3156             88  365-PLUS-MONTHS                VALUE '2'.
  3157             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3158             88  360-DAILY                      VALUE '4'.
  3159             88  365-DAILY                      VALUE '5'.
  3160
  3161         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3162         16  FILLER                         PIC X(11).
  3163
  3164         16  CF-LIMIT-AMOUNTS.
  3165             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3166             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3167             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3168             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3169             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3170             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3171             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3172             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3173             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3174             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3175
  3176         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3177         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3178         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3179
  3180         16  CF-ZIP-CODE.
  3181             20  CF-ZIP-PRIME.
  3182                 24  CF-ZIP-1ST             PIC X.
  3183                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3184                 24  FILLER                 PIC X(4).
  3185             20  CF-ZIP-PLUS4               PIC X(4).
  3186         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3187             20  CF-CAN-POSTAL-1            PIC XXX.
  3188             20  CF-CAN-POSTAL-2            PIC XXX.
  3189             20  FILLER                     PIC XXX.
  3190
  3191         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3192         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3193         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3194
  3195         16  CF-RATING-SWITCH               PIC X.
  3196             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3197             88  CF-NO-RATING                   VALUE 'N'.
  3198
  3199         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3200
  3201         16  CF-CARRIER-OVER-SHORT.
  3202             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3203             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  57
* NSRLTRBL.cbl
  3204
  3205         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3206         16  CF-SECPAY-SWITCH               PIC X.
  3207             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3208             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3209         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3210         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3211         16  FILLER                         PIC X(444).
  3212*        16  FILLER                         PIC X(452).
  3213
  3214
  3215****************************************************************
  3216*             MORTALITY MASTER RECORD                          *
  3217****************************************************************
  3218
  3219     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3220         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3221                                INDEXED BY CF-MORT-NDX.
  3222             20  CF-MORT-TABLE              PIC X(5).
  3223             20  CF-MORT-TABLE-TYPE         PIC X.
  3224                 88  CF-MORT-JOINT              VALUE 'J'.
  3225                 88  CF-MORT-SINGLE             VALUE 'S'.
  3226                 88  CF-MORT-COMBINED           VALUE 'C'.
  3227                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3228                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3229             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3230             20  CF-MORT-AGE-METHOD         PIC XX.
  3231                 88  CF-AGE-LAST                VALUE 'AL'.
  3232                 88  CF-AGE-NEAR                VALUE 'AN'.
  3233             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3234             20  CF-MORT-ADJUSTMENT-DIRECTION
  3235                                            PIC X.
  3236                 88  CF-MINUS                   VALUE '-'.
  3237                 88  CF-PLUS                    VALUE '+'.
  3238             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3239             20  CF-MORT-JOINT-CODE         PIC X.
  3240                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3241             20  CF-MORT-PC-Q               PIC X.
  3242                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3243             20  CF-MORT-TABLE-CODE         PIC X(4).
  3244             20  CF-MORT-COMMENTS           PIC X(15).
  3245             20  FILLER                     PIC X(14).
  3246
  3247         16  FILLER                         PIC X(251).
  3248
  3249
  3250****************************************************************
  3251*             BUSSINESS TYPE MASTER RECORD                     *
  3252****************************************************************
  3253
  3254     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3255* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3256* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3257* AND RECORD 05 IS TYPES 81-99
  3258         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3259             20  CF-BUSINESS-TITLE          PIC  X(19).
  3260             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3261                                            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  58
* NSRLTRBL.cbl
  3262             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3263             20  FILLER                     PIC  X.
  3264         16  FILLER                         PIC  X(248).
  3265
  3266
  3267****************************************************************
  3268*             TERMINAL MASTER RECORD                           *
  3269****************************************************************
  3270
  3271     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3272
  3273         16  CF-COMPANY-TERMINALS.
  3274             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3275                                  PIC X(4).
  3276         16  FILLER               PIC X(248).
  3277
  3278
  3279****************************************************************
  3280*             LIFE EDIT MASTER RECORD                          *
  3281****************************************************************
  3282
  3283     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3284         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3285             20  CF-LIFE-CODE-IN            PIC XX.
  3286             20  CF-LIFE-CODE-OUT           PIC XX.
  3287         16  FILLER                         PIC X(248).
  3288
  3289
  3290****************************************************************
  3291*             AH EDIT MASTER RECORD                            *
  3292****************************************************************
  3293
  3294     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3295         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3296             20  CF-AH-CODE-IN              PIC XXX.
  3297             20  CF-AH-CODE-OUT             PIC XX.
  3298         16  FILLER                         PIC X(248).
  3299
  3300
  3301****************************************************************
  3302*             CREDIBILITY TABLES                               *
  3303****************************************************************
  3304
  3305     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3306         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3307                             INDEXED BY CF-CRDB-NDX.
  3308             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3309             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3310             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3311         16  FILLER                         PIC  X(332).
  3312
  3313
  3314****************************************************************
  3315*             REPORT CUSTOMIZATION RECORD                      *
  3316****************************************************************
  3317
  3318     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3319         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  59
* NSRLTRBL.cbl
  3320             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3321             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3322             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3323**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3324****       A T-TRANSFER.                                   ****
  3325             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3326
  3327         16  FILLER                         PIC XX.
  3328
  3329         16  CF-CARRIER-CNTL-OPT.
  3330             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3331                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3332                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3333             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3334                                            PIC X.
  3335         16  CF-GROUP-CNTL-OPT.
  3336             20  CF-GROUP-OPT-SEQ           PIC 9.
  3337                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3338                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3339             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3340                                            PIC X(6).
  3341         16  CF-STATE-CNTL-OPT.
  3342             20  CF-STATE-OPT-SEQ           PIC 9.
  3343                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3344                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3345             20  CF-STATE-SELECT OCCURS 3 TIMES
  3346                                            PIC XX.
  3347         16  CF-ACCOUNT-CNTL-OPT.
  3348             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3349                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3350                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3351             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3352                                            PIC X(10).
  3353         16  CF-BUS-TYP-CNTL-OPT.
  3354             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3355                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3356                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3357             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3358                                            PIC XX.
  3359         16  CF-LF-TYP-CNTL-OPT.
  3360             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3361                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3362                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3363             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3364                                            PIC XX.
  3365         16  CF-AH-TYP-CNTL-OPT.
  3366             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3367                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3368                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3369             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3370                                            PIC XX.
  3371         16  CF-REPTCD1-CNTL-OPT.
  3372             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3373                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3374                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3375             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3376                                            PIC X(10).
  3377         16  CF-REPTCD2-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  60
* NSRLTRBL.cbl
  3378             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3379                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3380                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3381             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3382                                            PIC X(10).
  3383         16  CF-USER1-CNTL-OPT.
  3384             20  CF-USER1-OPT-SEQ           PIC 9.
  3385                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3386                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3387             20  CF-USER1-SELECT OCCURS 3 TIMES
  3388                                            PIC X(10).
  3389         16  CF-USER2-CNTL-OPT.
  3390             20  CF-USER2-OPT-SEQ           PIC 9.
  3391                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3392                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3393             20  CF-USER2-SELECT OCCURS 3 TIMES
  3394                                            PIC X(10).
  3395         16  CF-USER3-CNTL-OPT.
  3396             20  CF-USER3-OPT-SEQ           PIC 9.
  3397                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3398                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3399             20  CF-USER3-SELECT OCCURS 3 TIMES
  3400                                            PIC X(10).
  3401         16  CF-USER4-CNTL-OPT.
  3402             20  CF-USER4-OPT-SEQ           PIC 9.
  3403                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3404                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3405             20  CF-USER4-SELECT OCCURS 3 TIMES
  3406                                            PIC X(10).
  3407         16  CF-USER5-CNTL-OPT.
  3408             20  CF-USER5-OPT-SEQ           PIC 9.
  3409                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3410                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3411             20  CF-USER5-SELECT OCCURS 3 TIMES
  3412                                            PIC X(10).
  3413         16  CF-REINS-CNTL-OPT.
  3414             20  CF-REINS-OPT-SEQ           PIC 9.
  3415                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3416                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3417             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3418                 24  CF-REINS-PRIME         PIC XXX.
  3419                 24  CF-REINS-SUB           PIC XXX.
  3420
  3421         16  CF-AGENT-CNTL-OPT.
  3422             20  CF-AGENT-OPT-SEQ           PIC 9.
  3423                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3424                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3425             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3426                                            PIC X(10).
  3427
  3428         16  FILLER                         PIC X(43).
  3429
  3430         16  CF-LOSS-RATIO-SELECT.
  3431             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3432             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3433         16  CF-ENTRY-DATE-SELECT.
  3434             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3435             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  61
* NSRLTRBL.cbl
  3436         16  CF-EFFECTIVE-DATE-SELECT.
  3437             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3438             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3439
  3440         16  CF-EXCEPTION-LIST-IND          PIC X.
  3441             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3442
  3443         16  FILLER                         PIC X(318).
  3444
  3445****************************************************************
  3446*                  EXCEPTION REPORTING RECORD                  *
  3447****************************************************************
  3448
  3449     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3450         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3451             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3452
  3453         16  CF-COMBINED-LIFE-AH-OPT.
  3454             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3455             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3456             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3457             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3458
  3459         16  CF-LIFE-OPT.
  3460             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3461             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3462             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3463             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3464             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3465             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3466             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3467             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3468             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3469             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3470
  3471         16  CF-AH-OPT.
  3472             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3473             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3474             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3475             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3476             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3477             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3478             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3479             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3480             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3481             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3482
  3483         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3484             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3485             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3486             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3487
  3488         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3489
  3490         16  FILLER                         PIC X(673).
  3491
  3492
  3493****************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  62
* NSRLTRBL.cbl
  3494*             MORTGAGE SYSTEM PLAN RECORD                      *
  3495****************************************************************
  3496
  3497     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3498         16  CF-PLAN-TYPE                   PIC X.
  3499             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3500             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3501             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3502         16  CF-PLAN-ABBREV                 PIC XXX.
  3503         16  CF-PLAN-DESCRIPT               PIC X(10).
  3504         16  CF-PLAN-NOTES                  PIC X(20).
  3505         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3506         16  CF-PLAN-UNDERWRITING.
  3507             20  CF-PLAN-TERM-DATA.
  3508                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3509                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3510             20  CF-PLAN-AGE-DATA.
  3511                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3512                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3513                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3514             20  CF-PLAN-BENEFIT-DATA.
  3515                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3516                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3517                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3518                                            PIC S9(7)V99  COMP-3.
  3519         16  CF-PLAN-POLICY-FORMS.
  3520             20  CF-POLICY-FORM             PIC X(12).
  3521             20  CF-MASTER-APPLICATION      PIC X(12).
  3522             20  CF-MASTER-POLICY           PIC X(12).
  3523         16  CF-PLAN-RATING.
  3524             20  CF-RATE-CODE               PIC X(5).
  3525             20  CF-SEX-RATING              PIC X.
  3526                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3527                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3528             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3529             20  CF-SUB-STD-TYPE            PIC X.
  3530                 88  CF-PCT-OF-PREM            VALUE '1'.
  3531                 88  CF-PCT-OF-BENE            VALUE '2'.
  3532         16  CF-PLAN-PREM-TOLERANCES.
  3533             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3534             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3535         16  CF-PLAN-PYMT-TOLERANCES.
  3536             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3537             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3538         16  CF-PLAN-MISC-DATA.
  3539             20  FILLER                     PIC X.
  3540             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3541             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3542         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3543         16  CF-PLAN-IND-GRP                PIC X.
  3544             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3545                                                     '1'.
  3546             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3547                                                     '2'.
  3548         16  CF-MIB-SEARCH-SW               PIC X.
  3549             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3550             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3551             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  63
* NSRLTRBL.cbl
  3552             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3553         16  CF-ALPHA-SEARCH-SW             PIC X.
  3554             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3555             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3556             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3557             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3558             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3559             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3560             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3561             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3562             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3563             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3564                                                     'A' 'B' 'C'
  3565                                                     'X' 'Y' 'Z'.
  3566         16  CF-EFF-DT-RULE-SW              PIC X.
  3567             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3568             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3569             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3570             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3571             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3572         16  FILLER                         PIC X(4).
  3573         16  CF-HEALTH-QUESTIONS            PIC X.
  3574             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3575         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3576         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3577         16  CF-PLAN-SNGL-JNT               PIC X.
  3578             88  CF-COMBINED-PLAN              VALUE 'C'.
  3579             88  CF-JNT-PLAN                   VALUE 'J'.
  3580             88  CF-SNGL-PLAN                  VALUE 'S'.
  3581         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3582         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3583         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3584         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3585         16  CF-RERATE-CNTL                 PIC  X.
  3586             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3587             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3588             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3589             88  CF-AUTO-RECALC                 VALUE '4'.
  3590         16  CF-BENEFIT-TYPE                PIC  X.
  3591             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3592             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3593         16  CF-POLICY-FEE                  PIC S999V99
  3594                                                    COMP-3.
  3595         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3596         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3597         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3598         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3599         16  FILLER                         PIC  X(32).
  3600         16  CF-TERMINATION-FORM            PIC  X(04).
  3601         16  FILLER                         PIC  X(08).
  3602         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3603                                                       COMP-3.
  3604         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3605         16  CF-ISSUE-LETTER                PIC  X(4).
  3606         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3607         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3608             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3609             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  64
* NSRLTRBL.cbl
  3610         16  CF-MP-REFUND-CALC              PIC X.
  3611             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3612             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3613             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3614             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3615             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3616             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3617             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3618             88  CF-MP-REFD-MEAN                VALUE '8'.
  3619         16  CF-ALT-RATE-CODE               PIC  X(5).
  3620
  3621
  3622         16  FILLER                         PIC X(498).
  3623****************************************************************
  3624*             MORTGAGE COMPANY MASTER RECORD                   *
  3625****************************************************************
  3626
  3627     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3628         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3629         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3630             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3631             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3632             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3633             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3634             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3635
  3636         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3637         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3638         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3639         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3640         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3641
  3642         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3643             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3644         16  CF-MP-RECON-USE-IND            PIC X(1).
  3645             88  CF-MP-USE-RECON             VALUE 'Y'.
  3646         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3647             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3648         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3649             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3650             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3651         16  FILLER                         PIC X(1).
  3652         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3653             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3654         16  CF-MORTG-MIB-VERSION           PIC X.
  3655             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3656             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3657             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3658         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3659             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3660                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3661             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3662                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3663             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3664                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3665             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3666                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3667             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  65
* NSRLTRBL.cbl
  3668                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3669             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3670                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3671         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3672         16  FILLER                         PIC X(7).
  3673         16  CF-MORTG-DESTINATION-SYMBOL.
  3674             20  CF-MORTG-MIB-COMM          PIC X(5).
  3675             20  CF-MORTG-MIB-TERM          PIC X(5).
  3676         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3677             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3678         16  FILLER                         PIC X(03).
  3679         16  CF-MP-CHECK-NO-CONTROL.
  3680             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3681                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3682                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3683                                                ' ' LOW-VALUES.
  3684                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3685                                               VALUE '3'.
  3686         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3687         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3688         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3689             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3690                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3691             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3692                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3693             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3694                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3695             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3696                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3697             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3698                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3699             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3700                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3701         16  CF-MORTG-BILLING-AREA.
  3702             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3703                                            PIC X.
  3704         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3705         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3706         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3707         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3708             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3709             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3710         16  FILLER                         PIC X.
  3711         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3712             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3713             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3714         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3715         16  FILLER                         PIC X(8).
  3716         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3717         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3718         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3719         16  CF-ACH-COMPANY-ID.
  3720             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3721                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3722                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3723                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3724             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3725         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  66
* NSRLTRBL.cbl
  3726             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3727         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3728             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3729             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3730         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3731         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3732         16  FILLER                         PIC X(536).
  3733
  3734****************************************************************
  3735*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3736****************************************************************
  3737
  3738     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3739         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3740             20  CF-FEMALE-HEIGHT.
  3741                 24  CF-FEMALE-FT           PIC 99.
  3742                 24  CF-FEMALE-IN           PIC 99.
  3743             20  CF-FEMALE-MIN-WT           PIC 999.
  3744             20  CF-FEMALE-MAX-WT           PIC 999.
  3745         16  FILLER                         PIC X(428).
  3746
  3747     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3748         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3749             20  CF-MALE-HEIGHT.
  3750                 24  CF-MALE-FT             PIC 99.
  3751                 24  CF-MALE-IN             PIC 99.
  3752             20  CF-MALE-MIN-WT             PIC 999.
  3753             20  CF-MALE-MAX-WT             PIC 999.
  3754         16  FILLER                         PIC X(428).
  3755******************************************************************
  3756*             AUTOMATIC ACTIVITY RECORD                          *
  3757******************************************************************
  3758     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3759         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3760             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3761             20  CF-SYS-LETTER-ID           PIC X(04).
  3762             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3763             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3764             20  CF-SYS-RESET-SW            PIC X(01).
  3765             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3766             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3767
  3768         16  FILLER                         PIC X(50).
  3769
  3770         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3771             20  CF-USER-ACTIVE-SW          PIC X(01).
  3772             20  CF-USER-LETTER-ID          PIC X(04).
  3773             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3774             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3775             20  CF-USER-RESET-SW           PIC X(01).
  3776             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3777             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3778             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3779
  3780         16  FILLER                         PIC X(246).
  3781*                                COPY NSCVARS.
  3782******************************************************************
  3783*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  67
* NSRLTRBL.cbl
  3784*
  3785* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3786*-----------------------------------------------------------------
  3787*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3788* EFFECTIVE    NUMBER
  3789*-----------------------------------------------------------------
  3790* 031912    2011110200002  AJRA  AHL CLAIM NUM
  3791* 013013    2012110080002  AJRA  ADD ACCOUNT GPCD
  3792* 031116    2015110400001  TANA  ADD EL150D FIELDS
  3793* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  3794* 071719    2019011600010  TANA  ADD VERIF CODE
  3795******************************************************************
  3796 01 NAPER-OUTPUT-DATA.
  3797    05 FILLER              PIC X(6) VALUE "TEMPL=".
  3798    05 OUT-TEMP            PIC X(4).
  3799    05 FILLER              PIC X(8) VALUE "&LETTER=".
  3800    05 OUT-LETTER          PIC X(4).
  3801    05 FILLER              PIC X(6) VALUE "&CARR=".
  3802    05 OUT-CARR            PIC X.
  3803    05 FILLER              PIC X(7) VALUE "&CLMNO=".
  3804    05 OUT-CLMNO           PIC X(7).
  3805    05 FILLER              PIC X(7) VALUE "&CRTNO=".
  3806    05 OUT-CRTNO           PIC X(11).
  3807    05 FILLER              PIC X(7) VALUE "&ACTNO=".
  3808    05 OUT-ACTNO           PIC X(10).
  3809    05 FILLER              PIC X(8) VALUE "&ILNAME=".
  3810    05 OUT-ILNAME          PIC X(15).
  3811    05 FILLER              PIC X(8) VALUE "&IFNAME=".
  3812    05 OUT-IFNAME          PIC X(10).
  3813    05 FILLER              PIC X(7) VALUE "&SEXCD=".
  3814    05 OUT-SEX-CD          PIC X.
  3815    05 FILLER              PIC X(5) VALUE "&SSN=".
  3816    05 OUT-SSN             PIC X(11).
  3817    05 FILLER              PIC X(9) VALUE "&CLMSTAT=".
  3818    05 OUT-CLMSTAT         PIC X.
  3819    05 FILLER              PIC X(8) VALUE "&CLMTYP=".
  3820    05 OUT-CLMTYPE         PIC X.
  3821    05 FILLER              PIC X(7) VALUE "&ESTDT=".
  3822    05 OUT-EST-DT          PIC X(21).
  3823    05 FILLER              PIC X(7) VALUE "&INCDT=".
  3824    05 OUT-INC-DT          PIC X(21).
  3825    05 FILLER              PIC X(7) VALUE "&RPTDT=".
  3826    05 OUT-RPT-DT          PIC X(21).
  3827    05 FILLER              PIC X(10) VALUE "&PDTHRUDT=".
  3828    05 OUT-PD-THRU-DT      PIC X(21).
  3829    05 FILLER              PIC X(11) VALUE "&FORMDUEDT=".
  3830    05 OUT-FORM-DUE-DT     PIC X(21).
  3831    05 FILLER              PIC X(8) VALUE "&LPMTDT=".
  3832    05 OUT-LST-PMT-DT      PIC X(21).
  3833    05 FILLER              PIC X(8) VALUE "&NOPMTS=".
  3834    05 OUT-NO-OF-PMTS      PIC X(10).
  3835    05 FILLER              PIC X(9) VALUE "&TOTPAID=".
  3836    05 OUT-TOT-PAID        PIC 9999999.99.
  3837    05 FILLER              PIC X(8) VALUE "&LPDAMT=".
  3838    05 OUT-LST-PD-AMT      PIC 9999999.99.
  3839    05 FILLER              PIC X(9) VALUE "&ADDRCNT=".
  3840    05 OUT-ADDR-CNT        PIC 9.
  3841    05 FILLER              PIC X(7) VALUE "&CRTST=".
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  68
* NSRLTRBL.cbl
  3842    05 OUT-CRT-ST          PIC XX.
  3843    05 FILLER              PIC X(10) VALUE "&CERTACCT=".
  3844    05 OUT-CERTACCT        PIC X(10).
  3845    05 FILLER              PIC X(7) VALUE "&EFFDT=".
  3846    05 OUT-EFF-DT          PIC X(21).
  3847    05 FILLER              PIC X(8) VALUE "&LMNTDT=".
  3848    05 OUT-LST-MAINT-DT    PIC X(21).
  3849    05 FILLER              PIC X(10) VALUE "&LMNTUSER=".
  3850    05 OUT-LST-MAINT-USER  PIC X(10).
  3851    05 FILLER              PIC X(10) VALUE "&LMNTTYPE=".
  3852    05 OUT-LST-MAINT-TYPE  PIC X(10).
  3853    05 FILLER              PIC X(6) VALUE "&DIAG=".
  3854    05 OUT-DIAG            PIC X(66).
  3855    05 FILLER              PIC X(7) VALUE "&EXPDT=".
  3856    05 OUT-EXP-DT          PIC X(21).
  3857    05 FILLER              PIC X(12) VALUE "&LCLSREASON=".
  3858    05 OUT-LST-CLS-REA     PIC X(10).
  3859    05 FILLER              PIC X(8) VALUE "&BRTHDT=".
  3860    05 OUT-BIRTH-DT        PIC X(21).
  3861    05 FILLER              PIC X(6) VALUE "&TERM=".
  3862    05 OUT-TERM            PIC 999.
  3863    05 FILLER              PIC X(7) VALUE "&BENCD=".
  3864    05 OUT-BEN-CD          PIC XX.
  3865    05 FILLER              PIC X(8) VALUE "&BENAMT=".
  3866    05 OUT-BENAMT          PIC 9999999.99.
  3867    05 FILLER              PIC X(9) VALUE "&CRITPER=".
  3868    05 OUT-CRIT-PER        PIC 999.
  3869    05 FILLER              PIC X(9) VALUE "&WAITPER=".
  3870    05 OUT-WAIT-PER        PIC XX.
  3871    05 FILLER              PIC X(11)  VALUE "&LFINTRATE=".
  3872    05 OUT-LF-INT-RATE     PIC 99.99999.
  3873    05 FILLER              PIC X(10) VALUE "&AUTOPYDT=".
  3874    05 OUT-AUTO-PY-DT      PIC X(21).
  3875    05 FILLER              PIC X(12) VALUE "&AUTOSCHEND=".
  3876    05 OUT-AUTO-SCHD-END   PIC X(21).
  3877    05 FILLER              PIC X(8) VALUE "&LOANNO=".
  3878    05 OUT-LOAN-NO         PIC X(25).
  3879    05 FILLER              PIC X(5) VALUE "&APR=".
  3880    05 OUT-APR             PIC 99.99999.
  3881    05 FILLER              PIC X(8) VALUE "&LACTDT=".
  3882    05 OUT-LST-ACT-DT      PIC X(21).
  3883    05 FILLER              PIC X(7) VALUE "&ACTDT=".
  3884    05 OUT-ACT-DT          PIC X(21).
  3885    05 FILLER              PIC X(10) VALUE "&LACTTYPE=".
  3886    05 OUT-LST-ACT-TYPE    PIC X(15).
  3887    05 FILLER              PIC X(9) VALUE "&ACTTYPE=".
  3888    05 OUT-ACT-TYPE        PIC X(15).
  3889    05 FILLER              PIC X(6) VALUE "&FORM=".
  3890    05 OUT-FORM            PIC X(4).
  3891    05 FILLER              PIC X(9) VALUE "&INSNAME=".
  3892    05 OUT-INS-NAME        PIC X(36).
  3893    05 FILLER              PIC X(10) VALUE "&INSADDR1=".
  3894    05 OUT-INS-ADDR1       PIC X(36).
  3895    05 FILLER              PIC X(10) VALUE "&INSADDR2=".
  3896    05 OUT-INS-ADDR2       PIC X(36).
  3897    05 FILLER              PIC X(9) VALUE "&INSCITY=".
  3898    05 OUT-INS-CITY        PIC X(28).
  3899    05 FILLER              PIC X(10) VALUE "&INSSTATE=".
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  69
* NSRLTRBL.cbl
  3900    05 OUT-INS-STATE       PIC XX.
  3901    05 FILLER              PIC X(8) VALUE "&INSZIP=".
  3902    05 OUT-INS-ZIP         PIC X(10).
  3903    05 FILLER              PIC X(10) VALUE "&INSPHONE=".
  3904    05 OUT-INS-PHONE       PIC X(13).
  3905    05 FILLER              PIC X(10) VALUE "&BENENAME=".
  3906    05 OUT-BEN-NAME        PIC X(32).
  3907    05 FILLER              PIC X(11) VALUE "&BENEADDR1=".
  3908    05 OUT-BEN-ADDR1       PIC X(36).
  3909    05 FILLER              PIC X(11) VALUE "&BENEADDR2=".
  3910    05 OUT-BEN-ADDR2       PIC X(32).
  3911    05 FILLER              PIC X(10) VALUE "&BENECITY=".
  3912    05 OUT-BEN-CITY        PIC X(28).
  3913    05 FILLER              PIC X(11) VALUE "&BENESTATE=".
  3914    05 OUT-BEN-STATE       PIC XX.
  3915    05 FILLER              PIC X(9) VALUE "&BENEZIP=".
  3916    05 OUT-BEN-ZIP         PIC X(10).
  3917    05 FILLER              PIC X(11) VALUE "&BENEPHONE=".
  3918    05 OUT-BEN-PHONE       PIC X(13).
  3919    05 FILLER              PIC X(8) VALUE "&OANAME=".
  3920    05 OUT-ORIG-NAME       PIC X(32).
  3921    05 FILLER              PIC X(10) VALUE "&ACCTNAME=".
  3922    05 OUT-ACCT-NAME       PIC X(32).
  3923    05 FILLER              PIC X(11) VALUE "&ACCTADDR1=".
  3924    05 OUT-ACCT-ADDR1      PIC X(36).
  3925    05 FILLER              PIC X(11) VALUE "&ACCTADDR2=".
  3926    05 OUT-ACCT-ADDR2      PIC X(32).
  3927    05 FILLER              PIC X(10) VALUE "&ACCTCITY=".
  3928    05 OUT-ACCT-CITY       PIC X(30).
  3929    05 FILLER              PIC X(11) VALUE "&ACCTSTATE=".
  3930    05 OUT-ACCT-STATE      PIC XX.
  3931    05 FILLER              PIC X(9)  VALUE "&ACCTZIP=".
  3932    05 OUT-ACCT-ZIP        PIC X(10).
  3933    05 FILLER              PIC X(11) VALUE "&ACCTPHONE=".
  3934    05 OUT-ACCT-PHONE      PIC X(13).
  3935    05 FILLER              PIC X(7) VALUE "&ENCCD=".
  3936    05 OUT-ENC-CODE        PIC XXX.
  3937    05 FILLER              PIC X(7) VALUE "&ENCST=".
  3938    05 OUT-ENC-ST          PIC XX.
  3939    05 FILLER              PIC X(8) VALUE "&ARCHNO=".
  3940    05 OUT-ARCHNO          PIC 999999999.
  3941    05 FILLER              PIC X(11) VALUE "&FLTRPRTDT=".
  3942    05 OUT-1ST-LTR-PRT-DT  PIC X(21).
  3943    05 FILLER              PIC X(11) VALUE "&NEXTDUEDT=".
  3944    05 OUT-NEXT-DUE-DT     PIC X(21).
  3945    05 FILLER              PIC X(8) VALUE "&JLNAME=".
  3946    05 OUT-JLNAME          PIC X(15).
  3947    05 FILLER              PIC X(8) VALUE "&JFNAME=".
  3948    05 OUT-JFNAME          PIC X(10).
  3949    05 FILLER              PIC X(9)  VALUE "&ENCLINE=".
  3950    05 OUT-ENCLINE         PIC X(100).
  3951    05 FILLER              PIC X(9) VALUE "&ENCATTS=".
  3952    05 OUT-ENCATTS         PIC X(255).
  3953    05 FILLER              PIC X(10) VALUE "&OUTSTACK=".
  3954    05 OUT-OUTSTACK        PIC X.
  3955    05 FILLER              PIC X(8) VALUE "&PROCID=".
  3956    05 OUT-PROCID          PIC XXXX.
  3957    05 FILLER              PIC X(8) VALUE "&COMPID=".
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  70
* NSRLTRBL.cbl
  3958    05 OUT-COMPID          PIC XXX.
  3959    05 FILLER              PIC X(8) VALUE "&PRTNOW=".
  3960    05 OUT-PRINT-NOW-SW    PIC X.
  3961    05 FILLER              PIC X(11) VALUE "&CYCLEDATE=".
  3962    05 OUT-CYCLE-DATE      PIC X(8).
  3963    05 FILLER              PIC X(11) VALUE "&ENCSTNAME=".
  3964    05 OUT-ENC-ST-NAME     PIC XX.
  3965    05 FILLER              PIC X(10) VALUE "&CARRIDLU=".
  3966    05 OUT-CARR-LU         PIC X.
  3967    05 FILLER              PIC X(5)  VALUE "&CCN=".
  3968    05 OUT-AHL-CLAIM-NO    PIC X(9).
  3969    05 FILLER              PIC X(4) VALUE "&GP=".
  3970    05 OUT-ACCT-GPCD       PIC 99.
  3971    05 FILLER              PIC X(9) VALUE "&MAXBENS=".
  3972    05 OUT-MAX-BENS        PIC 9(3).
  3973    05 FILLER              PIC X(10) VALUE "&PAIDBENS=".
  3974    05 OUT-PAID-BENS       PIC 9(3).
  3975    05 FILLER              PIC X(9) VALUE "&REMBENS=".
  3976    05 OUT-REM-BENS        PIC 9(3).
  3977    05 FILLER              PIC X(9) VALUE "&EXCLPER=".
  3978    05 OUT-EXCL-PER        PIC 9(3).
  3979    05 FILLER              PIC X(8) VALUE "&RECMOS=".
  3980    05 OUT-REC-MOS         PIC 9(2).
  3981    05 FILLER              PIC X(8) VALUE "&INSTYP=".
  3982    05 OUT-INS-TYP         PIC X(4).
  3983    05 FILLER              PIC X(8) VALUE "&BENPER=".
  3984    05 OUT-BEN-PER         PIC 9(2).
  3985    05 FILLER              PIC X(7) VALUE "&ACCSW=".
  3986    05 OUT-ACC-SW          PIC X.
  3987    05 FILLER              PIC X(7) VALUE "&VERCD=".
  3988    05 OUT-VER-CD          PIC X(5).
  3989 01  FILLER                      PIC X(500)  VALUE SPACES.
  3990*                                COPY ELCNAPS.
  3991******************************************************************
  3992*                                                                *
  3993*                            ELCNAPS                             *
  3994*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3995*                            VMOD=2.003                          *
  3996*                                                                *
  3997*        FILE DESCRIPTION = NAPERSOFT LETTER FILE                *
  3998*                                                                *
  3999*        FILE TYPE= VSAM,KSDS                                    *
  4000*        RECORD SIZE = 150    RECFORM = FIXED                    *
  4001*                                                                *
  4002*        BASE CLUSTER = ELNAPS        RKP=2,LEN=28               *
  4003*                                                                *
  4004*        LOG = YES                                               *
  4005*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  4006*                                                                *
  4007******************************************************************
  4008*                   C H A N G E   L O G
  4009*
  4010* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4011*-----------------------------------------------------------------
  4012*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4013* EFFECTIVE    NUMBER
  4014*-----------------------------------------------------------------
  4015* 033110  CR2009122800001  AJRA  NEW FILE FOR NAPERSOFT.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  71
* NSRLTRBL.cbl
  4016******************************************************************
  4017
  4018 01  NAPERSOFT-FILE.
  4019     12  NA-RECORD-ID                PIC  XX.
  4020         88  VALID-NA-ID                  VALUE 'NA'.
  4021
  4022     12  NA-CONTROL-PRIMARY.
  4023         16  NA-COMPANY-CD           PIC X.
  4024         16  NA-CARRIER              PIC X.
  4025         16  NA-CLAIM-NO             PIC X(7).
  4026         16  NA-CERT-NO.
  4027             20  NA-CERT-PRIME       PIC X(10).
  4028             20  NA-CERT-SFX         PIC X.
  4029         16  NA-ARCHIVE-NO           PIC 9(8).
  4030
  4031     12  NA-LETTER-INFORMATION.
  4032         16  NA-LETTER-ID            PIC X(4).
  4033         16  NA-PROCESSOR-ID         PIC X(4).
  4034         16  NA-CREATION-DT          PIC X(2).
  4035         16  NA-INITIAL-PRINT-DT     PIC X(2).
  4036         16  NA-FOLLOW-UP-DT         PIC X(2).
  4037         16  NA-RESEND-DT            PIC X(2).
  4038         16  NA-RESEND-LETTER-ID     PIC X(4).
  4039         16  NA-NO-OF-COPIES         PIC 9(2).
  4040         16  NA-ADDRESS-TYPE         PIC X(2).
  4041         16  NA-CORR-TRLR-SEQ        PIC 9(4).
  4042         16  NA-RESEND-PRINT-DT      PIC X(2).
  4043         16  NA-1ST-LTR-PRINT-DT     PIC X(2).
  4044         16  NA-NEXT-DUE-DT          PIC X(2).
  4045         16  NA-AUTOPYDT             PIC X(2).
  4046         16  NA-ENCLOSURE-CD         PIC X(3).
  4047         16  NA-CREATED-IN-NAPERSOFT PIC X(1).
  4048         16  NA-ORIG-ARCHIVE-NO      PIC 9(9).
  4049         16  NA-RESEND-PROMPT-IND    PIC X(1).
  4050         16  NA-ORIG-ENCLOSURE-CD    PIC X(3).
  4051         16  FILLER                  PIC X(67).
  4052******************************************************************
  4053*                                COPY ELCENCC.
  4054******************************************************************
  4055*                                                                *
  4056*                                                                *
  4057*                            ELCENCC                             *
  4058*                            VMOD=2.001                          *
  4059*                                                                *
  4060*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  4061*                                                                *
  4062*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  4063*   A NAPERSOFT DOCUMENT                                         *
  4064*                                                                *
  4065*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  4066*                                                                *
  4067*   FILE TYPE = VSAM,KSDS                                        *
  4068*   RECORD SIZE = 400   RECFORM = FIX                            *
  4069*                                                                *
  4070*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  4071*                                                                *
  4072*   LOG = NO                                                     *
  4073*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  72
* NSRLTRBL.cbl
  4074*                                                                *
  4075*                                                                *
  4076******************************************************************
  4077*                   C H A N G E   L O G
  4078*
  4079* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4080*-----------------------------------------------------------------
  4081*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4082* EFFECTIVE    NUMBER
  4083*-----------------------------------------------------------------
  4084* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  4085* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  4086******************************************************************
  4087 01  ENCLOSURE-CODES.
  4088     12  NC-RECORD-ID                      PIC XX.
  4089         88  VALID-NC-ID                      VALUE 'NC'.
  4090     12  NC-CONTROL-PRIMARY.
  4091         16  NC-COMPANY-CD                 PIC X.
  4092         16  NC-REC-TYPE                   PIC X.
  4093             88  NC-CLAIMS                   VALUE '1'.
  4094             88  NC-ADMIN                    VALUE '2'.
  4095         16  NC-ENC-CODE                   PIC X(5).
  4096         16  FILLER                        PIC X(09).
  4097     12  NC-MAINT-INFORMATION.
  4098         16  NC-LAST-MAINT-DT              PIC XX.
  4099         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4100         16  NC-LAST-MAINT-USER            PIC X(4).
  4101         16  FILLER                        PIC XX.
  4102     12  NC-OUTPUT-STACK                   PIC XXX.
  4103     12  NC-ENCLOSURE-LINE                 PIC X(100).
  4104     12  NC-ATTACHMENTS                    PIC X(255).
  4105     12  NC-FUTURE                         PIC X(12).
  4106******************************************************************
  4107*                                COPY ELCCRTT.
  4108******************************************************************
  4109*                                                                *
  4110*                            ELCCRTT.                            *
  4111*                                                                *
  4112*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  4113*                                                                *
  4114*   FILE TYPE = VSAM,KSDS                                        *
  4115*   RECORD SIZE = 552  RECFORM = FIXED                           *
  4116*                                                                *
  4117*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  4118*                                                                *
  4119*   LOG = YES                                                    *
  4120*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4121******************************************************************
  4122*                   C H A N G E   L O G
  4123*
  4124* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4125*-----------------------------------------------------------------
  4126*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4127* EFFECTIVE    NUMBER
  4128*-----------------------------------------------------------------
  4129* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  4130* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  4131* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  73
* NSRLTRBL.cbl
  4132* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4133* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4134* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4135* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4136* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  4137* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  4138* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  4139* 091318  CR2018073000001  PEMA  ADD Refund methods
  4140* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  4141******************************************************************
  4142
  4143 01  CERTIFICATE-TRAILERS.
  4144     12  CS-RECORD-ID                      PIC XX.
  4145         88  VALID-CS-ID                      VALUE 'CS'.
  4146
  4147     12  CS-CONTROL-PRIMARY.
  4148         16  CS-COMPANY-CD                 PIC X.
  4149         16  CS-CARRIER                    PIC X.
  4150         16  CS-GROUPING                   PIC X(6).
  4151         16  CS-STATE                      PIC XX.
  4152         16  CS-ACCOUNT                    PIC X(10).
  4153         16  CS-CERT-EFF-DT                PIC XX.
  4154         16  CS-CERT-NO.
  4155             20  CS-CERT-PRIME             PIC X(10).
  4156             20  CS-CERT-SFX               PIC X.
  4157         16  CS-TRAILER-TYPE               PIC X.
  4158             88  COMM-TRLR           VALUE 'A'.
  4159             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  4160             88  CERT-DATA-TRLR      VALUE 'C'.
  4161
  4162     12  CS-DATA-AREA                      PIC X(516).
  4163
  4164     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  4165         16  CS-BANK-COMMISSION-AREA.
  4166             20  CS-BANK-COMMS       OCCURS 10.
  4167                 24  CS-AGT                PIC X(10).
  4168                 24  CS-COM-TYP            PIC X.
  4169                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  4170                 24  CS-RECALC-LV-INDIC    PIC X.
  4171                 24  FILLER                PIC X(10).
  4172         16  FILLER                        PIC X(256).
  4173
  4174     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  4175****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  4176         16  CS-MB-CLAIM-DATA OCCURS 24.
  4177             20  CS-CLAIM-NO               PIC X(7).
  4178             20  CS-CLAIM-TYPE             PIC X.
  4179                 88  CS-AH-CLM               VALUE 'A'.
  4180                 88  CS-IU-CLM               VALUE 'I'.
  4181                 88  CS-GP-CLM               VALUE 'G'.
  4182                 88  CS-LF-CLM               VALUE 'L'.
  4183                 88  CS-PR-CLM               VALUE 'P'.
  4184                 88  CS-FL-CLM               VALUE 'F'.
  4185                 88  CS-OT-CLM               VALUE 'O'.
  4186             20  CS-INSURED-TYPE           PIC X.
  4187                 88  CS-PRIM-INSURED          VALUE 'P'.
  4188                 88  CS-CO-BORROWER           VALUE 'C'.
  4189             20  CS-BENEFIT-PERIOD         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  74
* NSRLTRBL.cbl
  4190             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  4191             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  4192             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  4193         16  FILLER                        PIC X(12).
  4194     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  4195         16  CS-VIN-NUMBER                 PIC X(17).
  4196         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  4197         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  4198         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  4199         16  cs-agent-name.
  4200             20  cs-agent-fname            pic x(20).
  4201             20  cs-agent-mi               pic x.
  4202             20  cs-agent-lname            pic x(25).
  4203         16  cs-license-no                 pic x(15).
  4204         16  cs-npn-number                 pic x(10).
  4205         16  cs-agent-edit-status          pic x.
  4206             88  cs-ae-refer-to-manager      value 'M'.
  4207             88  cs-ae-cover-sheet           value 'C'.
  4208             88  cs-ae-sig-form              value 'S'.
  4209             88  cs-ae-verified              value 'V'.
  4210             88  cs-unidentified-signature   value 'U'.
  4211             88  cs-cert-returned            value 'R'.
  4212             88  cs-accept-no-commission     value 'N'.
  4213         16  cs-year                       pic 9999.
  4214         16  cs-make                       pic x(20).
  4215         16  cs-model                      pic x(20).
  4216         16  cs-future                     pic x(20).
  4217         16  cs-vehicle-odometer           pic s9(7) comp-3.
  4218         16  cs-claim-verification-status  pic x.
  4219             88  cs-clm-ver-eligible         value 'A'.
  4220             88  cs-clm-ver-partial-elig     value 'B'.
  4221             88  cs-clm-ver-not-eligible     value 'C'.
  4222             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  4223             88  cs-clm-ver-not-part-elig-rw value 'E'.
  4224             88  cs-clm-ver-ND-CERT          value 'F'.
  4225             88  cs-clm-ver-spec-other       value 'G'.
  4226             88  cs-clam-ver-pratial-corrected
  4227                                             value 'H'.
  4228             88  cs-clm-ver-no-matches       value 'I'.
  4229             88  cs-clm-ver-not-elig-corrected
  4230                                             value 'J'.
  4231             88  cs-clm-ver-needs-review     value 'R'.
  4232             88  cs-clm-ver-sent-to-claims   value 'W'.
  4233         16  CS-LF-REFUND-METHOD           PIC X.
  4234         16  CS-AH-REFUND-METHOD           PIC X.
  4235         16  FILLER                        PIC X(353). *> was 420
  4236*        16  FILLER                        PIC X(496).
  4237*                                COPY ERCPDEF.
  4238******************************************************************
  4239*                                                                *
  4240*                                                                *
  4241*                            ERCPDEF.                            *
  4242*                                                                *
  4243*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  4244*                                                                *
  4245*    FILE TYPE = VSAM,KSDS                                       *
  4246*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  4247*                                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  75
* NSRLTRBL.cbl
  4248*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  4249*                                                                *
  4250*    LOG = YES                                                   *
  4251*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4252******************************************************************
  4253*                   C H A N G E   L O G
  4254*
  4255* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4256*-----------------------------------------------------------------
  4257*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4258* EFFECTIVE    NUMBER
  4259*-----------------------------------------------------------------
  4260* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4261* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4262* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  4263* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  4264******************************************************************
  4265 01  PRODUCT-MASTER.
  4266    12  PD-RECORD-ID                 PIC X(02).
  4267        88  VALID-PD-ID                  VALUE 'PD'.
  4268    12  PD-CONTROL-PRIMARY.
  4269        16  PD-COMPANY-CD            PIC X.
  4270        16  PD-STATE                 PIC XX.
  4271        16  PD-PRODUCT-CD            PIC XXX.
  4272        16  PD-FILLER                PIC X(7).
  4273        16  PD-BEN-TYPE              PIC X.
  4274        16  PD-BEN-CODE              PIC XX.
  4275        16  PD-PROD-EXP-DT           PIC XX.
  4276    12  FILLER                       PIC X(50).
  4277    12  PD-PRODUCT-DATA OCCURS 8.
  4278        16  PD-PROD-CODE             PIC X.
  4279            88  PD-PROD-LIFE           VALUE 'L'.
  4280            88  PD-PROD-PROP           VALUE 'P'.
  4281            88  PD-PROD-AH             VALUE 'A'.
  4282            88  PD-PROD-IU             VALUE 'I'.
  4283            88  PD-PROD-GAP            VALUE 'G'.
  4284            88  PD-PROD-FAML           VALUE 'F'.
  4285            88  PD-PROD-OTH            VALUE 'O'.
  4286        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  4287        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  4288        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  4289        16  PD-MAX-TERM              PIC S999        COMP-3.
  4290        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  4291        16  FILLER                   PIC X.
  4292        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  4293        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  4294        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  4295        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  4296        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  4297        16  PD-REC-CRIT-PERIOD       PIC 99.
  4298        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  4299            20  PD-RECURRING-YN      PIC X.
  4300            20  FILLER               PIC X.
  4301        16  PD-RTW-MOS               PIC 99.
  4302        16  PD-MAX-EXTENSION         PIC 99.
  4303        16  pd-ben-pct               pic sv999 comp-3.
  4304*       16  FILLER                   PIC XX.
  4305    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  76
* NSRLTRBL.cbl
  4306    12  PD-TERM-LIMITS OCCURS 15.
  4307        16  PD-LOW-TERM              PIC S999        COMP-3.
  4308        16  PD-HI-TERM               PIC S999        COMP-3.
  4309*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  4310    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  4311        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  4312        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  4313    12  PD-EARN-FACTORS.
  4314        16  FILLER OCCURS 15.
  4315            20  FILLER OCCURS 15.
  4316                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  4317    12  PD-PRODUCT-DESC              PIC X(80).
  4318    12  PD-TRUNCATED                 PIC X.
  4319    12  FILLER                       PIC X(59).
  4320    12  PD-MAINT-INFORMATION.
  4321        16  PD-LAST-MAINT-DT         PIC X(02).
  4322        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  4323        16  PD-LAST-MAINT-BY         PIC X(04).
  4324****************************************************************
  4325*
  4326* Copyright (c) 2007-2013 Dell Inc.
  4327* All rights reserved.
  4328*
  4329****************************************************************
  4330 01  DFHEIV.
  4331   02  DFHEIV0               PIC X(35).
  4332   02  DFHEIV1               PIC X(08).
  4333   02  DFHEIV2               PIC X(08).
  4334   02  DFHEIV3               PIC X(08).
  4335   02  DFHEIV4               PIC X(06).
  4336   02  DFHEIV5               PIC X(04).
  4337   02  DFHEIV6               PIC X(04).
  4338   02  DFHEIV7               PIC X(02).
  4339   02  DFHEIV8               PIC X(02).
  4340   02  DFHEIV9               PIC X(01).
  4341   02  DFHEIV10              PIC S9(7) COMP-3.
  4342   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4343   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4344   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4345   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4346   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4347   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4348   02  DFHEIV17              PIC X(04).
  4349   02  DFHEIV18              PIC X(04).
  4350   02  DFHEIV19              PIC X(04).
  4351   02  DFHEIV20              USAGE IS POINTER.
  4352   02  DFHEIV21              USAGE IS POINTER.
  4353   02  DFHEIV22              USAGE IS POINTER.
  4354   02  DFHEIV23              USAGE IS POINTER.
  4355   02  DFHEIV24              USAGE IS POINTER.
  4356   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4357   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4358   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4359   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4360   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4361   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4362   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4363   02  DFHEIV32              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  77
* NSRLTRBL.cbl
  4364   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4365   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4366   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4367   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4368   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4369   02  FILLER                PIC X(02).
  4370   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4371   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4372   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4373   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4374   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4375   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4376   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4377 LINKAGE  SECTION.
  4378*****************************************************************
  4379*                                                               *
  4380* Copyright (c) 2007-2013 Dell Inc.                             *
  4381* All rights reserved.                                          *
  4382*                                                               *
  4383*****************************************************************
  4384 01  dfheiblk.
  4385     02  eibtime          pic s9(7) comp-3.
  4386     02  eibdate          pic s9(7) comp-3.
  4387     02  eibtrnid         pic x(4).
  4388     02  eibtaskn         pic s9(7) comp-3.
  4389     02  eibtrmid         pic x(4).
  4390     02  dfheigdi         pic s9(4) comp.
  4391     02  eibcposn         pic s9(4) comp.
  4392     02  eibcalen         pic s9(4) comp.
  4393     02  eibaid           pic x(1).
  4394     02  eibfiller1       pic x(1).
  4395     02  eibfn            pic x(2).
  4396     02  eibfiller2       pic x(2).
  4397     02  eibrcode         pic x(6).
  4398     02  eibfiller3       pic x(2).
  4399     02  eibds            pic x(8).
  4400     02  eibreqid         pic x(8).
  4401     02  eibrsrce         pic x(8).
  4402     02  eibsync          pic x(1).
  4403     02  eibfree          pic x(1).
  4404     02  eibrecv          pic x(1).
  4405     02  eibsend          pic x(1).
  4406     02  eibatt           pic x(1).
  4407     02  eibeoc           pic x(1).
  4408     02  eibfmh           pic x(1).
  4409     02  eibcompl         pic x(1).
  4410     02  eibsig           pic x(1).
  4411     02  eibconf          pic x(1).
  4412     02  eiberr           pic x(1).
  4413     02  eibrldbk         pic x(1).
  4414     02  eiberrcd         pic x(4).
  4415     02  eibsynrb         pic x(1).
  4416     02  eibnodat         pic x(1).
  4417     02  eibfiller5       pic x(2).
  4418     02  eibresp          pic s9(8) comp.
  4419     02  eibresp2         pic s9(8) comp.
  4420     02  dfheigdj         pic s9(4) comp.
  4421     02  dfheigdk         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  78
* NSRLTRBL.cbl
  4422 01 dfhcommarea.
  4423*                                copy ELCLTRSPI.
  4424******************************************************************
  4425*                   C H A N G E   L O G
  4426*
  4427* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4428*-----------------------------------------------------------------
  4429*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4430* EFFECTIVE    NUMBER
  4431*-----------------------------------------------------------------
  4432* 121802    2009122800001  PEMA  NEW COPYBOOK
  4433******************************************************************
  4434****************************************
  4435*  commarea for NaperSoft On Demand Claim letters
  4436*  (business logic input & output)
  4437****************************************
  4438     03  BL-INPUT.
  4439         05  BL-CARRIER          PIC X.
  4440         05  BL-CLAIM-NO         PIC X(7).
  4441         05  BL-CERT-NO          PIC X(11).
  4442         05  BL-LETTER-ID        PIC XXXX.
  4443         05  BL-FOLLOW-UP-DT     PIC X(10).
  4444         05  BL-RESEND-DT        PIC X(10).
  4445         05  BL-NO-OF-COPIES     PIC 99.
  4446         05  BL-PROC-ID          PIC XXXX.
  4447         05  BL-COMP-ID          PIC XXX.
  4448         05  BL-PRINT-NOW-SW     PIC X.
  4449         05  BL-ENC-CD           PIC XXX.
  4450         05  BL-ARCHIVE-NO       PIC 9(8).
  4451         05  BL-REGARDING        PIC X(70).
  4452     03  BL-OUTPUT.
  4453         05  BL-STATUS                   PIC X.
  4454             88  BL-OK                      VALUE "P".
  4455             88  BL-FAIL                  VALUE "F".
  4456         05  BL-MESSAGE          PIC X(50).
  4457     03  BL-RECORD-PASSED-DATA   PIC X(2500).
  4458 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  4459 0000-DFHEXIT SECTION.
  4460     MOVE '9#                    $   ' TO DFHEIV0.
  4461     MOVE 'NSRLTRBL' TO DFHEIV1.
  4462     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4463     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  4464     MOVE '5'                    TO DC-OPTION-CODE
  4465     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4466     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE
  4467     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  4468     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE
  4469*****************************************************
  4470* The full claim key has been established and passed
  4471* to this program via NSREQLTR
  4472*****************************************************
  4473     INITIALIZE NAPER-OUTPUT-DATA
  4474     evaluate bl-comp-id
  4475        when 'DCC'
  4476           MOVE X'05'            TO WS-ELMSTR-COMPANY-CD
  4477        when 'AHL'
  4478           MOVE X'06'            TO WS-ELMSTR-COMPANY-CD
  4479        when 'VPP'
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  79
* NSRLTRBL.cbl
  4480           MOVE X'07'            TO WS-ELMSTR-COMPANY-CD
  4481        when 'FNL'
  4482           MOVE X'08'            TO WS-ELMSTR-COMPANY-CD
  4483        when other
  4484           MOVE X'04'            TO WS-ELMSTR-COMPANY-CD
  4485     end-evaluate
  4486     MOVE BL-CARRIER             TO WS-ELMSTR-CARRIER
  4487     MOVE BL-CLAIM-NO            TO WS-ELMSTR-CLAIM-NO
  4488     MOVE BL-CERT-NO             TO WS-ELMSTR-CERT-NO
  4489     SET BL-FAIL TO TRUE
  4490
  4491* EXEC CICS READ
  4492*         DATASET    ('ELMSTR')
  4493*         INTO       (CLAIM-MASTER)
  4494*         RIDFLD     (WS-ELMSTR-KEY)
  4495*         RESP       (WS-RESPONSE)
  4496*    END-EXEC.
  4497     MOVE LENGTH OF
  4498      CLAIM-MASTER
  4499       TO DFHEIV11
  4500     MOVE 'ELMSTR' TO DFHEIV1
  4501*    MOVE '&"IL       E          (  N#00004486' TO DFHEIV0
  4502     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4503     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4504     MOVE X'204E233030303034343836' TO DFHEIV0(25:11)
  4505     CALL 'kxdfhei1' USING DFHEIV0,
  4506           DFHEIV1,
  4507           CLAIM-MASTER,
  4508           DFHEIV11,
  4509           WS-ELMSTR-KEY,
  4510           DFHEIV99,
  4511           DFHEIV99,
  4512           DFHEIV99
  4513     MOVE EIBRESP  TO WS-RESPONSE
  4514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4515
  4516     IF RESP-NORMAL
  4517        MOVE BL-LETTER-ID        TO OUT-TEMP
  4518                                    OUT-LETTER
  4519        MOVE BL-PROC-ID          TO OUT-PROCID
  4520        MOVE BL-COMP-ID          TO OUT-COMPID
  4521        MOVE BL-PRINT-NOW-SW     TO OUT-PRINT-NOW-SW
  4522        MOVE CL-CARRIER          TO OUT-CARR
  4523                                    OUT-CARR-LU
  4524        MOVE CL-INSURED-LAST-NAME
  4525                                 TO OUT-ILNAME
  4526        MOVE CL-INSURED-1ST-NAME TO OUT-IFNAME
  4527        MOVE CL-CLAIM-NO         TO OUT-CLMNO
  4528        MOVE CL-CERT-NO          TO OUT-CRTNO
  4529        MOVE CL-CERT-ACCOUNT     TO OUT-ACTNO
  4530        MOVE CL-SOC-SEC-NO       TO OUT-SSN
  4531        MOVE CL-CLAIM-STATUS     TO OUT-CLMSTAT
  4532        MOVE CL-CCN (1:9)        TO OUT-AHL-CLAIM-NO
  4533        MOVE WS-SAVE-EDIT-A-DATE TO DC-GREG-DATE-A-EDIT
  4534        STRING DC-EDITA-CCYY  DC-EDITA-MONTH DC-EDITA-DAY
  4535          DELIMITED BY SIZE INTO OUT-CYCLE-DATE
  4536        END-STRING
  4537*       IF CLAIM-IS-CLOSED
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  80
* NSRLTRBL.cbl
  4538*          MOVE 'CLOSED'         TO OUT-CLMSTAT
  4539*       ELSE
  4540*          MOVE 'OPEN'           TO OUT-CLMSTAT
  4541*       END-IF
  4542        MOVE CL-CLAIM-TYPE       TO OUT-CLMTYPE
  4543        MOVE CL-FILE-ESTABLISH-DT
  4544                                 TO DC-BIN-DATE-1
  4545        MOVE ' '                 TO DC-OPTION-CODE
  4546        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4547        IF NO-CONVERSION-ERROR
  4548           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4549              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4550              INTO OUT-EST-DT
  4551           END-STRING
  4552        ELSE
  4553           MOVE SPACES           TO OUT-EST-DT
  4554        END-IF
  4555        MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
  4556        MOVE ' '                 TO DC-OPTION-CODE
  4557        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4558        IF NO-CONVERSION-ERROR
  4559           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4560              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4561              INTO OUT-PD-THRU-DT
  4562           END-STRING
  4563        ELSE
  4564           MOVE SPACES           TO OUT-PD-THRU-DT
  4565        END-IF
  4566        MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
  4567        MOVE +0                  TO DC-ELAPSED-MONTHS
  4568        MOVE +30                 TO DC-ELAPSED-DAYS
  4569        MOVE '6'                 TO DC-OPTION-CODE
  4570        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4571        IF NO-CONVERSION-ERROR
  4572           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4573              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4574              INTO OUT-FORM-DUE-DT
  4575           END-STRING
  4576        ELSE
  4577           MOVE SPACES           TO OUT-FORM-DUE-DT
  4578        END-IF
  4579        MOVE CL-TOTAL-PAID-AMT   TO OUT-TOT-PAID
  4580        MOVE CL-INSURED-SEX-CD   TO OUT-SEX-CD
  4581        MOVE CL-CERT-STATE       TO OUT-CRT-ST
  4582                                    OUT-ENC-ST
  4583                                    OUT-ENC-ST-NAME
  4584        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
  4585        MOVE ' '                 TO DC-OPTION-CODE
  4586        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4587        IF NO-CONVERSION-ERROR
  4588           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4589              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4590              INTO OUT-EFF-DT
  4591           END-STRING
  4592        ELSE
  4593           MOVE SPACES           TO OUT-EFF-DT
  4594        END-IF
  4595        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  81
* NSRLTRBL.cbl
  4596        MOVE ' '                 TO DC-OPTION-CODE
  4597        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4598        IF NO-CONVERSION-ERROR
  4599           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4600              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4601              INTO OUT-INC-DT
  4602           END-STRING
  4603        ELSE
  4604           MOVE SPACES           TO OUT-INC-DT
  4605        END-IF
  4606        MOVE CL-REPORTED-DT      TO DC-BIN-DATE-1
  4607        MOVE ' '                 TO DC-OPTION-CODE
  4608        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4609        IF NO-CONVERSION-ERROR
  4610           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4611              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4612              INTO OUT-RPT-DT
  4613           END-STRING
  4614        ELSE
  4615           MOVE SPACES           TO OUT-RPT-DT
  4616        END-IF
  4617        MOVE CL-LAST-PMT-DT      TO DC-BIN-DATE-1
  4618        MOVE ' '                 TO DC-OPTION-CODE
  4619        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4620        IF NO-CONVERSION-ERROR
  4621           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4622              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4623              INTO OUT-LST-PMT-DT
  4624           END-STRING
  4625        ELSE
  4626           MOVE SPACES           TO OUT-LST-PMT-DT
  4627        END-IF
  4628        MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
  4629        MOVE ' '                 TO DC-OPTION-CODE
  4630        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4631        IF NO-CONVERSION-ERROR
  4632           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4633              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4634              INTO OUT-BIRTH-DT
  4635           END-STRING
  4636        ELSE
  4637           MOVE SPACES           TO OUT-BIRTH-DT
  4638        END-IF
  4639        MOVE CL-LAST-MAINT-DT    TO DC-BIN-DATE-1
  4640        MOVE ' '                 TO DC-OPTION-CODE
  4641        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4642        IF NO-CONVERSION-ERROR
  4643           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4644              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4645              INTO OUT-LST-MAINT-DT
  4646           END-STRING
  4647        ELSE
  4648           MOVE SPACES           TO OUT-LST-MAINT-DT
  4649        END-IF
  4650        MOVE CL-LAST-MAINT-USER  TO OUT-LST-MAINT-USER
  4651        MOVE CL-LAST-MAINT-TYPE  TO OUT-LST-MAINT-TYPE
  4652        MOVE CL-NO-OF-PMTS-MADE  TO OUT-NO-OF-PMTS
  4653        MOVE CL-LAST-PMT-AMT     TO OUT-LST-PD-AMT
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  82
* NSRLTRBL.cbl
  4654        MOVE CL-ACCOUNT-ADDR-CNT TO OUT-ADDR-CNT
  4655        MOVE CL-LAST-CLOSE-REASON TO OUT-LST-CLS-REA
  4656        MOVE BL-ENC-CD           TO OUT-ENC-CODE
  4657        PERFORM 1000-GET-FILES   THRU 1000-EXIT
  4658        PERFORM 1800-SET-EL150D-FIELDS THRU 1800-EXIT
  4659        MOVE FUNCTION REVERSE(CL-CLAIM-NO(3:5)) TO OUT-VER-CD
  4660        SET BL-OK TO TRUE
  4661     END-IF
  4662     IF BL-OK
  4663        PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  4664        MOVE WS-ARCHIVE-NO       TO OUT-ARCHNO
  4665        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
  4666        MOVE NAPER-OUTPUT-DATA   TO BL-RECORD-PASSED-DATA
  4667*       PERFORM 1600-ADD-CORR-TRLR
  4668*                                THRU 1600-EXIT
  4669     END-IF
  4670
  4671* exec cics return end-exec.
  4672*    MOVE '.(                    ''   #00004646' TO DFHEIV0
  4673     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4674     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4675     MOVE X'2020233030303034363436' TO DFHEIV0(25:11)
  4676     CALL 'kxdfhei1' USING DFHEIV0,
  4677           DFHEIV99,
  4678           DFHEIV99,
  4679           DFHEIV99,
  4680           DFHEIV99,
  4681           DFHEIV99,
  4682           DFHEIV99
  4683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4684
  4685 0500-SCRUB-DATA.
  4686*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  4687*   A DIFFERENT DELIMITER IN PROGRAM NSREQLTR BUT
  4688*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  4689*   TO A HEX 26 TO GET BY THE DECODER
  4690     MOVE FUNCTION LENGTH(OUT-ILNAME)
  4691                                 TO M1
  4692     MOVE SPACES                 TO WS-WORK-FIELD
  4693     perform varying a1 from +1 by +1 until a1 > m1
  4694        if out-ilname (a1:1) = '&'
  4695           MOVE OUT-ILNAME (1:A1 - 1)
  4696                                 TO WS-WORK-FIELD (1:A1 - 1)
  4697           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4698           MOVE OUT-ILNAME (A1 + 1:M1 - A1)
  4699                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4700           MOVE WS-WORK-FIELD    TO OUT-ILNAME
  4701           add +2 to a1
  4702        end-if
  4703     end-perform
  4704     MOVE FUNCTION LENGTH(OUT-ACCT-ADDR1)
  4705                                 TO M1
  4706     MOVE SPACES                 TO WS-WORK-FIELD
  4707     perform varying a1 from +1 by +1 until a1 > m1
  4708        if out-acct-addr1 (a1:1) = '&'
  4709           MOVE out-acct-addr1 (1:A1 - 1)
  4710                                 TO WS-WORK-FIELD (1:A1 - 1)
  4711           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  83
* NSRLTRBL.cbl
  4712           MOVE out-acct-addr1 (A1 + 1:M1 - A1)
  4713                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4714           MOVE WS-WORK-FIELD    TO out-acct-addr1
  4715           add +2 to a1
  4716        end-if
  4717     end-perform
  4718     MOVE FUNCTION LENGTH(OUT-ACCT-ADDR2)
  4719                                 TO M1
  4720     MOVE SPACES                 TO WS-WORK-FIELD
  4721     perform varying a1 from +1 by +1 until a1 > m1
  4722        if out-acct-addr2 (a1:1) = '&'
  4723           MOVE out-acct-addr2 (1:A1 - 1)
  4724                                 TO WS-WORK-FIELD (1:A1 - 1)
  4725           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4726           MOVE out-acct-addr2 (A1 + 1:M1 - A1)
  4727                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4728           MOVE WS-WORK-FIELD    TO out-acct-addr2
  4729           add +2 to a1
  4730        end-if
  4731     end-perform
  4732     MOVE FUNCTION LENGTH(OUT-ACCT-CITY)
  4733                                 TO M1
  4734     MOVE SPACES                 TO WS-WORK-FIELD
  4735     perform varying a1 from +1 by +1 until a1 > m1
  4736        if out-acct-city (a1:1) = '&'
  4737           MOVE out-acct-city (1:A1 - 1)
  4738                                 TO WS-WORK-FIELD (1:A1 - 1)
  4739           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4740           MOVE out-acct-city (A1 + 1:M1 - A1)
  4741                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4742           MOVE WS-WORK-FIELD    TO out-acct-city
  4743           add +2 to a1
  4744        end-if
  4745     end-perform
  4746     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  4747                                 TO M1
  4748     MOVE SPACES                 TO WS-WORK-FIELD
  4749     perform varying a1 from +1 by +1 until a1 > m1
  4750        if out-acct-name (a1:1) = '&'
  4751           MOVE out-acct-name (1:A1 - 1)
  4752                                 TO WS-WORK-FIELD (1:A1 - 1)
  4753           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4754           MOVE out-acct-name (A1 + 1:M1 - A1)
  4755                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4756           MOVE WS-WORK-FIELD    TO out-acct-name
  4757           add +2 to a1
  4758        end-if
  4759     end-perform
  4760     MOVE FUNCTION LENGTH(OUT-ORIG-NAME)
  4761                                 TO M1
  4762     MOVE SPACES                 TO WS-WORK-FIELD
  4763     perform varying a1 from +1 by +1 until a1 > m1
  4764        if out-orig-name (a1:1) = '&'
  4765           MOVE out-orig-name (1:A1 - 1)
  4766                                 TO WS-WORK-FIELD (1:A1 - 1)
  4767           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4768           MOVE out-orig-name (A1 + 1:M1 - A1)
  4769                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  84
* NSRLTRBL.cbl
  4770           MOVE WS-WORK-FIELD    TO out-orig-name
  4771           add +2 to a1
  4772        end-if
  4773     end-perform
  4774     MOVE FUNCTION LENGTH(OUT-INS-NAME)
  4775                                 TO M1
  4776     MOVE SPACES                 TO WS-WORK-FIELD
  4777     perform varying a1 from +1 by +1 until a1 > m1
  4778        if out-ins-name (a1:1) = '&'
  4779           MOVE out-ins-name (1:A1 - 1)
  4780                                 TO WS-WORK-FIELD (1:A1 - 1)
  4781           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4782           MOVE out-ins-name (A1 + 1:M1 - A1)
  4783                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4784           MOVE WS-WORK-FIELD    TO out-ins-name
  4785           add +2 to a1
  4786        end-if
  4787     end-perform
  4788     MOVE FUNCTION LENGTH(OUT-INS-ADDR1)
  4789                                 TO M1
  4790     MOVE SPACES                 TO WS-WORK-FIELD
  4791     perform varying a1 from +1 by +1 until a1 > m1
  4792        if out-ins-addr1 (a1:1) = '&'
  4793           MOVE out-ins-addr1 (1:A1 - 1)
  4794                                 TO WS-WORK-FIELD (1:A1 - 1)
  4795           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4796           MOVE out-ins-addr1 (A1 + 1:M1 - A1)
  4797                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4798           MOVE WS-WORK-FIELD    TO out-ins-addr1
  4799           add +2 to a1
  4800        end-if
  4801     end-perform
  4802     MOVE FUNCTION LENGTH(OUT-INS-ADDR2)
  4803                                 TO M1
  4804     MOVE SPACES                 TO WS-WORK-FIELD
  4805     perform varying a1 from +1 by +1 until a1 > m1
  4806        if out-ins-addr2 (a1:1) = '&'
  4807           MOVE out-ins-addr2 (1:A1 - 1)
  4808                                 TO WS-WORK-FIELD (1:A1 - 1)
  4809           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4810           MOVE out-ins-addr2 (A1 + 1:M1 - A1)
  4811                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4812           MOVE WS-WORK-FIELD    TO out-ins-addr2
  4813           add +2 to a1
  4814        end-if
  4815     end-perform
  4816     MOVE FUNCTION LENGTH(OUT-BEN-NAME)   TO M1
  4817     MOVE SPACES                 TO WS-WORK-FIELD
  4818     perform varying a1 from +1 by +1 until a1 > m1
  4819        if out-ben-name (a1:1) = '&'
  4820           MOVE out-ben-name (1:A1 - 1)
  4821                                 TO WS-WORK-FIELD (1:A1 - 1)
  4822           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4823           MOVE out-ben-name (A1 + 1:M1 - A1)
  4824                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4825           MOVE WS-WORK-FIELD    TO out-ben-name
  4826           add +2 to a1
  4827        end-if
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  85
* NSRLTRBL.cbl
  4828     end-perform
  4829     MOVE FUNCTION LENGTH(OUT-BEN-ADDR1)
  4830                                 TO M1
  4831     MOVE SPACES                 TO WS-WORK-FIELD
  4832     perform varying a1 from +1 by +1 until a1 > m1
  4833        if out-ben-addr1 (a1:1) = '&'
  4834           MOVE out-ben-addr1 (1:A1 - 1)
  4835                                 TO WS-WORK-FIELD (1:A1 - 1)
  4836           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4837           MOVE out-ben-addr1 (A1 + 1:M1 - A1)
  4838                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4839           MOVE WS-WORK-FIELD    TO out-ben-addr1
  4840           add +2 to a1
  4841        end-if
  4842     end-perform
  4843     MOVE FUNCTION LENGTH(OUT-BEN-ADDR2)
  4844                                 TO M1
  4845     MOVE SPACES                 TO WS-WORK-FIELD
  4846     perform varying a1 from +1 by +1 until a1 > m1
  4847        if out-ben-addr2 (a1:1) = '&'
  4848           MOVE out-ben-addr2 (1:A1 - 1)
  4849                                 TO WS-WORK-FIELD (1:A1 - 1)
  4850           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4851           MOVE out-ben-addr2 (A1 + 1:M1 - A1)
  4852                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4853           MOVE WS-WORK-FIELD    TO out-ben-addr2
  4854           add +2 to a1
  4855        end-if
  4856     end-perform
  4857     MOVE FUNCTION LENGTH(OUT-DIAG)       TO M1
  4858     MOVE SPACES                 TO WS-WORK-FIELD
  4859     perform varying a1 from +1 by +1 until a1 > m1
  4860        if out-diag (a1:1) = '&'
  4861           MOVE out-diag (1:A1 - 1)
  4862                                 TO WS-WORK-FIELD (1:A1 - 1)
  4863           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4864           MOVE out-diag (A1 + 1:M1 - A1)
  4865                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4866           MOVE WS-WORK-FIELD    TO out-diag
  4867           add +2 to a1
  4868        end-if
  4869     end-perform
  4870     MOVE ZEROS TO WS-TALLY WS-TALLY1
  4871     INSPECT NAPER-OUTPUT-DATA TALLYING WS-TALLY
  4872        FOR ALL '%'
  4873     INSPECT NAPER-OUTPUT-DATA TALLYING WS-TALLY1
  4874        FOR ALL '%26'
  4875     IF (WS-TALLY > 0)
  4876        AND (WS-TALLY NOT = WS-TALLY1)
  4877        MOVE +1                  TO A1
  4878        MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  4879                                 TO NS-LEN
  4880        PERFORM WS-TALLY TIMES
  4881           PERFORM VARYING A1 FROM A1 BY +1 UNTIL
  4882              (A1 > NS-LEN)
  4883              OR (NAPER-OUTPUT-DATA (A1:1) = '%')
  4884           END-PERFORM
  4885           IF A1 > NS-LEN
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  86
* NSRLTRBL.cbl
  4886              CONTINUE
  4887           ELSE
  4888              IF NAPER-OUTPUT-DATA (A1:3) = '%26'
  4889                 ADD +1 TO A1
  4890              ELSE
  4891                 MOVE NAPER-OUTPUT-DATA (1:A1 - 1)
  4892                                 TO WS-XML-WORK
  4893                 MOVE '%25'      TO WS-XML-WORK (A1:3)
  4894                 MOVE NAPER-OUTPUT-DATA (A1 + 1:NS-LEN - A1)
  4895                              TO WS-XML-WORK (A1 + 3:NS-LEN - A1)
  4896                 MOVE WS-XML-WORK TO NAPER-OUTPUT-DATA
  4897                 ADD +3 TO A1
  4898              END-IF
  4899           END-IF
  4900        END-PERFORM
  4901     END-IF
  4902     .
  4903 0500-EXIT.
  4904     EXIT.
  4905 1000-GET-FILES.
  4906     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  4907     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  4908     MOVE ' '                    TO WS-FOUND-BENE-SW
  4909     PERFORM 1250-GET-ELLETR     THRU 1250-EXIT
  4910     PERFORM 1300-GET-ELTRLRS    THRU 1300-EXIT
  4911     PERFORM 1700-GET-ELENCC     THRU 1700-EXIT
  4912     IF CL-CLAIM-TYPE NOT = 'L' AND 'P' AND 'O'
  4913        PERFORM 1400-GET-WAIT-PER THRU 1400-EXIT
  4914     END-IF
  4915     IF NOT FOUND-BENE
  4916        MOVE CL-COMPANY-CD       TO WS-ELBENE-COMPANY-CD
  4917        MOVE 'B'                 TO WS-ELBENE-REC-TYPE
  4918        MOVE CL-BENEFICIARY      TO WS-ELBENE-BENE
  4919
  4920* EXEC CICS READ
  4921*            DATASET    ('ELBENE')
  4922*            INTO       (BENEFICIARY-MASTER)
  4923*            RIDFLD     (WS-ELBENE-KEY)
  4924*            RESP       (WS-RESPONSE)
  4925*       END-EXEC
  4926     MOVE LENGTH OF
  4927      BENEFICIARY-MASTER
  4928       TO DFHEIV11
  4929     MOVE 'ELBENE' TO DFHEIV1
  4930*    MOVE '&"IL       E          (  N#00004881' TO DFHEIV0
  4931     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4932     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4933     MOVE X'204E233030303034383831' TO DFHEIV0(25:11)
  4934     CALL 'kxdfhei1' USING DFHEIV0,
  4935           DFHEIV1,
  4936           BENEFICIARY-MASTER,
  4937           DFHEIV11,
  4938           WS-ELBENE-KEY,
  4939           DFHEIV99,
  4940           DFHEIV99,
  4941           DFHEIV99
  4942     MOVE EIBRESP  TO WS-RESPONSE
  4943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  87
* NSRLTRBL.cbl
  4944        IF RESP-NORMAL
  4945           MOVE BE-MAIL-TO-NAME   TO OUT-BEN-NAME
  4946           MOVE BE-ADDRESS-LINE-1 TO OUT-BEN-ADDR1
  4947           MOVE BE-ADDRESS-LINE-2 TO OUT-BEN-ADDR2
  4948           MOVE BE-CITY           TO OUT-BEN-CITY
  4949           MOVE BE-STATE          TO OUT-BEN-STATE
  4950           MOVE BE-ZIP-PRIME      TO OUT-BEN-ZIP
  4951           IF BE-ZIP-PLUS4 NOT = SPACES AND ZEROS
  4952              STRING '-' BE-ZIP-PLUS4 DELIMITED BY SIZE
  4953                 INTO OUT-BEN-ZIP (6:5)
  4954              END-STRING
  4955           END-IF
  4956           MOVE BE-PHONE-NO       TO OUT-BEN-PHONE
  4957        END-IF
  4958     END-IF
  4959     .
  4960 1000-EXIT.
  4961     EXIT.
  4962 1100-GET-ELCERT.
  4963     MOVE CL-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  4964     MOVE CL-CERT-KEY-DATA       TO WS-ELCERT-KEY (2:21)
  4965     MOVE CL-CERT-NO             TO WS-ELCERT-CERT-NO
  4966
  4967* EXEC CICS READ
  4968*         DATASET    ('ELCERT')
  4969*         INTO       (CERTIFICATE-MASTER)
  4970*         RIDFLD     (WS-ELCERT-KEY)
  4971*         RESP       (WS-RESPONSE)
  4972*    END-EXEC.
  4973     MOVE LENGTH OF
  4974      CERTIFICATE-MASTER
  4975       TO DFHEIV11
  4976     MOVE 'ELCERT' TO DFHEIV1
  4977*    MOVE '&"IL       E          (  N#00004909' TO DFHEIV0
  4978     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4979     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4980     MOVE X'204E233030303034393039' TO DFHEIV0(25:11)
  4981     CALL 'kxdfhei1' USING DFHEIV0,
  4982           DFHEIV1,
  4983           CERTIFICATE-MASTER,
  4984           DFHEIV11,
  4985           WS-ELCERT-KEY,
  4986           DFHEIV99,
  4987           DFHEIV99,
  4988           DFHEIV99
  4989     MOVE EIBRESP  TO WS-RESPONSE
  4990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4991
  4992     IF RESP-NORMAL
  4993        IF CL-CLAIM-TYPE = 'L' OR 'P' OR 'O'
  4994           MOVE CM-LF-BENEFIT-AMT TO OUT-BENAMT
  4995           MOVE CM-LF-ORIG-TERM  TO OUT-TERM
  4996           MOVE CM-LF-BENEFIT-CD TO OUT-BEN-CD
  4997           MOVE CM-LF-CRITICAL-PERIOD
  4998                                 TO OUT-CRIT-PER
  4999           MOVE CM-LF-LOAN-EXPIRE-DT
  5000                                 TO DC-BIN-DATE-1
  5001           MOVE ' '              TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  88
* NSRLTRBL.cbl
  5002           PERFORM 9700-DATE-LINK
  5003                                 THRU 9700-EXIT
  5004           IF NO-CONVERSION-ERROR
  5005              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5006                 DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5007                 INTO OUT-EXP-DT
  5008              END-STRING
  5009           ELSE
  5010              MOVE SPACES        TO OUT-EXP-DT
  5011           END-IF
  5012        ELSE
  5013           MOVE CM-AH-BENEFIT-AMT TO OUT-BENAMT
  5014           MOVE CM-AH-ORIG-TERM  TO OUT-TERM
  5015           MOVE CM-AH-BENEFIT-CD TO OUT-BEN-CD
  5016           MOVE CM-AH-CRITICAL-PERIOD
  5017                                 TO OUT-CRIT-PER
  5018           MOVE CM-AH-LOAN-EXPIRE-DT
  5019                                 TO DC-BIN-DATE-1
  5020           MOVE ' '              TO DC-OPTION-CODE
  5021           PERFORM 9700-DATE-LINK
  5022                                 THRU 9700-EXIT
  5023           IF NO-CONVERSION-ERROR
  5024              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5025                 DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5026                 INTO OUT-EXP-DT
  5027              END-STRING
  5028           ELSE
  5029              MOVE SPACES        TO OUT-EXP-DT
  5030           END-IF
  5031        END-IF
  5032        MOVE CM-ACCOUNT          TO OUT-CERTACCT
  5033        IF CL-INSURED-1ST-NAME = CM-INSURED-FIRST-NAME
  5034            MOVE CM-JT-FIRST-NAME TO OUT-JFNAME
  5035            MOVE CM-JT-LAST-NAME  TO OUT-JLNAME
  5036        ELSE
  5037            MOVE CM-INSURED-FIRST-NAME TO OUT-JFNAME
  5038            MOVE CM-INSURED-LAST-NAME TO OUT-JLNAME
  5039        END-IF
  5040        MOVE CM-LOAN-APR         TO OUT-APR
  5041     END-IF
  5042     .
  5043 1100-EXIT.
  5044     EXIT.
  5045 1200-GET-ERACCT.
  5046    MOVE LOW-VALUES              TO WS-ERACCT-KEY
  5047    MOVE WS-ELCERT-KEY (1:22)    TO WS-ERACCT-KEY (1:22)
  5048
  5049* EXEC CICS STARTBR
  5050*        DATASET   ('ERACCT')
  5051*        RIDFLD    (WS-ERACCT-KEY)
  5052*        GTEQ
  5053*        RESP      (WS-RESPONSE)
  5054*    END-EXEC
  5055     MOVE 'ERACCT' TO DFHEIV1
  5056     MOVE 0
  5057       TO DFHEIV11
  5058*    MOVE '&,         G          &  N#00004971' TO DFHEIV0
  5059     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  89
* NSRLTRBL.cbl
  5060     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5061     MOVE X'204E233030303034393731' TO DFHEIV0(25:11)
  5062     CALL 'kxdfhei1' USING DFHEIV0,
  5063           DFHEIV1,
  5064           WS-ERACCT-KEY,
  5065           DFHEIV99,
  5066           DFHEIV11,
  5067           DFHEIV99
  5068     MOVE EIBRESP  TO WS-RESPONSE
  5069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5070     IF RESP-NORMAL
  5071
  5072* EXEC CICS READNEXT
  5073*          INTO    (ACCOUNT-MASTER)
  5074*          DATASET ('ERACCT')
  5075*          RIDFLD  (WS-ERACCT-KEY)
  5076*          RESP    (WS-RESPONSE)
  5077*       END-EXEC
  5078     MOVE LENGTH OF
  5079      ACCOUNT-MASTER
  5080       TO DFHEIV12
  5081     MOVE 'ERACCT' TO DFHEIV1
  5082     MOVE 0
  5083       TO DFHEIV11
  5084*    MOVE '&.IL                  )  N#00004978' TO DFHEIV0
  5085     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5086     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5087     MOVE X'204E233030303034393738' TO DFHEIV0(25:11)
  5088     CALL 'kxdfhei1' USING DFHEIV0,
  5089           DFHEIV1,
  5090           ACCOUNT-MASTER,
  5091           DFHEIV12,
  5092           WS-ERACCT-KEY,
  5093           DFHEIV99,
  5094           DFHEIV11,
  5095           DFHEIV99,
  5096           DFHEIV99
  5097     MOVE EIBRESP  TO WS-RESPONSE
  5098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5099     END-IF
  5100     IF RESP-NORMAL
  5101        PERFORM WITH TEST AFTER UNTIL
  5102           NOT (RESP-NORMAL)
  5103           OR (CM-CONTROL-PRIMARY (1:20) NOT =
  5104                        AM-CONTROL-PRIMARY (1:20))
  5105           IF (CM-CONTROL-PRIMARY (1:20)
  5106              = AM-CONTROL-PRIMARY (1:20))
  5107              IF (CL-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5108                 AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5109                 MOVE AM-NAME    TO OUT-ORIG-NAME
  5110                 MOVE ACCOUNT-MASTER TO SAVE-ACCOUNT-MASTER
  5111              END-IF
  5112              MOVE AM-NAME       TO OUT-ACCT-NAME
  5113              MOVE AM-ADDRS      TO OUT-ACCT-ADDR1
  5114              MOVE SPACES        TO OUT-ACCT-ADDR2
  5115              MOVE AM-ADDR-CITY  TO OUT-ACCT-CITY
  5116              MOVE AM-ADDR-STATE TO OUT-ACCT-STATE
  5117              MOVE AM-ZIP-PRIME  TO OUT-ACCT-ZIP
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  90
* NSRLTRBL.cbl
  5118              IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5119                 STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
  5120                    INTO OUT-ACCT-ZIP (6:5)
  5121                 END-STRING
  5122              END-IF
  5123              MOVE AM-TEL-NO     TO OUT-ACCT-PHONE
  5124              MOVE AM-GPCD       TO OUT-ACCT-GPCD
  5125
  5126* EXEC CICS READNEXT
  5127*                INTO    (ACCOUNT-MASTER)
  5128*                DATASET ('ERACCT')
  5129*                RIDFLD  (WS-ERACCT-KEY)
  5130*                RESP    (WS-RESPONSE)
  5131*             END-EXEC
  5132     MOVE LENGTH OF
  5133      ACCOUNT-MASTER
  5134       TO DFHEIV12
  5135     MOVE 'ERACCT' TO DFHEIV1
  5136     MOVE 0
  5137       TO DFHEIV11
  5138*    MOVE '&.IL                  )  N#00005010' TO DFHEIV0
  5139     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5140     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5141     MOVE X'204E233030303035303130' TO DFHEIV0(25:11)
  5142     CALL 'kxdfhei1' USING DFHEIV0,
  5143           DFHEIV1,
  5144           ACCOUNT-MASTER,
  5145           DFHEIV12,
  5146           WS-ERACCT-KEY,
  5147           DFHEIV99,
  5148           DFHEIV11,
  5149           DFHEIV99,
  5150           DFHEIV99
  5151     MOVE EIBRESP  TO WS-RESPONSE
  5152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5153           END-IF
  5154        END-PERFORM
  5155     END-IF
  5156     MOVE SAVE-ACCOUNT-MASTER  TO ACCOUNT-MASTER
  5157    .
  5158 1200-EXIT.
  5159     EXIT.
  5160 1250-GET-ELLETR.
  5161     MOVE CL-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  5162     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  5163     MOVE +0                     TO WS-ELLETR-SEQ-NO
  5164
  5165* EXEC CICS READ
  5166*         DATASET    ('ELLETR')
  5167*         INTO       (TEXT-FILES)
  5168*         RIDFLD     (WS-ELLETR-KEY)
  5169*         RESP       (WS-RESPONSE)
  5170*         GTEQ
  5171*    END-EXEC
  5172     MOVE LENGTH OF
  5173      TEXT-FILES
  5174       TO DFHEIV11
  5175     MOVE 'ELLETR' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  91
* NSRLTRBL.cbl
  5176*    MOVE '&"IL       G          (  N#00005027' TO DFHEIV0
  5177     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5178     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5179     MOVE X'204E233030303035303237' TO DFHEIV0(25:11)
  5180     CALL 'kxdfhei1' USING DFHEIV0,
  5181           DFHEIV1,
  5182           TEXT-FILES,
  5183           DFHEIV11,
  5184           WS-ELLETR-KEY,
  5185           DFHEIV99,
  5186           DFHEIV99,
  5187           DFHEIV99
  5188     MOVE EIBRESP  TO WS-RESPONSE
  5189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5190     IF RESP-NORMAL
  5191        IF (LETTER-FILE-TEXT)
  5192           AND (BL-LETTER-ID = TX-LETTER-NO)
  5193           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  5194           PERFORM 1280-PROCESS-Z-CONTROLS
  5195                                 THRU 1280-EXIT
  5196        END-IF
  5197     END-IF
  5198     .
  5199 1250-EXIT.
  5200     EXIT.
  5201 1280-PROCESS-Z-CONTROLS.
  5202     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  5203     IF W-FORM-TO-RESEND > SPACES
  5204        MOVE W-FORM-TO-RESEND    TO OUT-FORM
  5205     ELSE
  5206        MOVE SPACES              TO OUT-FORM
  5207     END-IF.
  5208*    MOVE W-ENCLOSURE-CD         TO OUT-ENC-CODE
  5209     .
  5210 1280-EXIT.
  5211     EXIT.
  5212 1300-GET-ELTRLRS.
  5213     MOVE CL-CONTROL-PRIMARY     TO WS-ELTRLR-KEY
  5214     MOVE +0                     TO WS-ELTRLR-SEQ-NO
  5215
  5216* EXEC CICS STARTBR
  5217*        DATASET   ('ELTRLR')
  5218*        RIDFLD    (WS-ELTRLR-KEY)
  5219*        GTEQ
  5220*        RESP      (WS-RESPONSE)
  5221*    END-EXEC
  5222     MOVE 'ELTRLR' TO DFHEIV1
  5223     MOVE 0
  5224       TO DFHEIV11
  5225*    MOVE '&,         G          &  N#00005059' TO DFHEIV0
  5226     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5227     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5228     MOVE X'204E233030303035303539' TO DFHEIV0(25:11)
  5229     CALL 'kxdfhei1' USING DFHEIV0,
  5230           DFHEIV1,
  5231           WS-ELTRLR-KEY,
  5232           DFHEIV99,
  5233           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  92
* NSRLTRBL.cbl
  5234           DFHEIV99
  5235     MOVE EIBRESP  TO WS-RESPONSE
  5236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5237    IF RESP-NORMAL
  5238
  5239* EXEC CICS READNEXT
  5240*         INTO    (ACTIVITY-TRAILERS)
  5241*         DATASET ('ELTRLR')
  5242*         RIDFLD  (WS-ELTRLR-KEY)
  5243*         RESP    (WS-RESPONSE)
  5244*      END-EXEC
  5245     MOVE LENGTH OF
  5246      ACTIVITY-TRAILERS
  5247       TO DFHEIV12
  5248     MOVE 'ELTRLR' TO DFHEIV1
  5249     MOVE 0
  5250       TO DFHEIV11
  5251*    MOVE '&.IL                  )  N#00005066' TO DFHEIV0
  5252     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5253     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5254     MOVE X'204E233030303035303636' TO DFHEIV0(25:11)
  5255     CALL 'kxdfhei1' USING DFHEIV0,
  5256           DFHEIV1,
  5257           ACTIVITY-TRAILERS,
  5258           DFHEIV12,
  5259           WS-ELTRLR-KEY,
  5260           DFHEIV99,
  5261           DFHEIV11,
  5262           DFHEIV99,
  5263           DFHEIV99
  5264     MOVE EIBRESP  TO WS-RESPONSE
  5265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5266       PERFORM 1310-GET-ELTRLRS THRU 1310-EXIT
  5267    END-IF
  5268     .
  5269 1300-EXIT.
  5270     EXIT.
  5271 1310-GET-ELTRLRS.
  5272     IF RESP-NORMAL
  5273     IF CL-CONTROL-PRIMARY = AT-CONTROL-PRIMARY (1:20)
  5274        EVALUATE TRUE
  5275           WHEN AT-INSURED-ADDR-TRL
  5276              MOVE AT-MAIL-TO-NAME   TO OUT-INS-NAME
  5277              MOVE AT-ADDRESS-LINE-1 TO OUT-INS-ADDR1
  5278              MOVE AT-ADDRESS-LINE-2 TO OUT-INS-ADDR2
  5279              MOVE AT-CITY           TO OUT-INS-CITY
  5280              MOVE AT-STATE          TO OUT-INS-STATE
  5281              MOVE AT-ZIP-CODE       TO OUT-INS-ZIP
  5282              IF AT-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5283                 STRING '-' AT-ZIP-PLUS4 DELIMITED BY SIZE
  5284                    INTO OUT-INS-ZIP (6:5)
  5285                 END-STRING
  5286              END-IF
  5287              MOVE AT-PHONE-NO       TO OUT-INS-PHONE
  5288           WHEN AT-BENEFICIARY-ADDR-TRL
  5289              SET FOUND-BENE TO TRUE
  5290              MOVE AT-MAIL-TO-NAME   TO OUT-BEN-NAME
  5291              MOVE AT-ADDRESS-LINE-1 TO OUT-BEN-ADDR1
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  93
* NSRLTRBL.cbl
  5292              MOVE AT-ADDRESS-LINE-2 TO OUT-BEN-ADDR2
  5293              MOVE AT-CITY           TO OUT-BEN-CITY
  5294              MOVE AT-STATE          TO OUT-BEN-STATE
  5295              MOVE AT-ZIP-CODE       TO OUT-BEN-ZIP
  5296              IF AT-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5297                 STRING '-' AT-ZIP-PLUS4 DELIMITED BY SIZE
  5298                    INTO OUT-BEN-ZIP (6:5)
  5299                 END-STRING
  5300              END-IF
  5301              MOVE AT-PHONE-NO       TO OUT-BEN-PHONE
  5302           WHEN AT-ACCOUNT-ADDR-TRL
  5303              MOVE AT-MAIL-TO-NAME   TO OUT-ACCT-NAME
  5304              MOVE AT-ADDRESS-LINE-1 TO OUT-ACCT-ADDR1
  5305              MOVE AT-ADDRESS-LINE-2 TO OUT-ACCT-ADDR2
  5306              MOVE AT-CITY           TO OUT-ACCT-CITY
  5307              MOVE AT-STATE          TO OUT-ACCT-STATE
  5308              MOVE AT-ZIP-CODE       TO OUT-ACCT-ZIP
  5309              IF AT-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5310                 STRING '-' AT-ZIP-PLUS4 DELIMITED BY SIZE
  5311                    INTO OUT-ACCT-ZIP (6:5)
  5312                 END-STRING
  5313              END-IF
  5314              MOVE AT-PHONE-NO       TO OUT-ACCT-PHONE
  5315           WHEN AT-SEQUENCE-NO = +90
  5316              MOVE AT-INFO-LINE-1   TO OUT-DIAG
  5317           WHEN AT-SEQUENCE-NO = +91
  5318              MOVE AT-INFO-LINE-1 TO OUT-LOAN-NO
  5319           WHEN AT-TRAILER-TYPE = '2' AND AT-PAYMENT-TYPE = 'I'
  5320              IF AT-INT-RATE NUMERIC AND
  5321                 AT-INT-RATE NOT EQUAL ZEROS
  5322                    COMPUTE OUT-LF-INT-RATE = AT-INT-RATE * 100
  5323              END-IF
  5324           WHEN AT-TRAILER-TYPE = '3'
  5325              IF (SAVE-BIN-DATE >= AT-SCHEDULE-START-DT)
  5326                 AND (SAVE-BIN-DATE <= AT-SCHEDULE-END-DT)
  5327                 AND (AT-TERMINATED-DT = LOW-VALUES OR SPACES)
  5328                 MOVE AT-SCHEDULE-END-DT TO WS-AUTO-LAST-SCHED-DT
  5329              END-IF
  5330           WHEN AT-TRAILER-TYPE = '8'
  5331              IF AT-RECORDED-DT > WS-LAST-ACT-DT
  5332                 MOVE AT-RECORDED-DT
  5333                              TO WS-LAST-ACT-DT
  5334                 MOVE 'DENIAL'
  5335                              TO WS-LAST-ACT-TYPE
  5336              END-IF
  5337           WHEN AT-TRAILER-TYPE = 'A'
  5338              IF AT-RECORDED-DT > WS-LAST-ACT-DT
  5339                 MOVE AT-RECORDED-DT
  5340                              TO WS-LAST-ACT-DT
  5341                 MOVE 'FORMS' TO WS-LAST-ACT-TYPE
  5342                 IF INITIAL-FORM
  5343                    MOVE 'INIT'
  5344                              TO WS-FORM
  5345                 END-IF
  5346                 IF PROGRESS-FORM
  5347                    MOVE 'PROG'
  5348                              TO WS-FORM
  5349                 END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  94
* NSRLTRBL.cbl
  5350              END-IF
  5351              IF AT-FORM-SEND-ON-DT > WS-ACTIVITY-DT
  5352                 MOVE AT-FORM-SEND-ON-DT
  5353                              TO WS-ACTIVITY-DT
  5354              END-IF
  5355              IF AT-FORM-REPRINT-DT > WS-ACTIVITY-DT
  5356                 MOVE AT-FORM-REPRINT-DT
  5357                              TO WS-ACTIVITY-DT
  5358              END-IF
  5359              IF AT-FORM-ANSWERED-DT > WS-ACTIVITY-DT
  5360                 MOVE AT-FORM-ANSWERED-DT
  5361                              TO WS-ACTIVITY-DT
  5362              END-IF
  5363        END-EVALUATE
  5364
  5365* EXEC CICS READNEXT
  5366*         INTO    (ACTIVITY-TRAILERS)
  5367*         DATASET ('ELTRLR')
  5368*         RIDFLD  (WS-ELTRLR-KEY)
  5369*         RESP    (WS-RESPONSE)
  5370*       END-EXEC
  5371     MOVE LENGTH OF
  5372      ACTIVITY-TRAILERS
  5373       TO DFHEIV12
  5374     MOVE 'ELTRLR' TO DFHEIV1
  5375     MOVE 0
  5376       TO DFHEIV11
  5377*    MOVE '&.IL                  )  N#00005170' TO DFHEIV0
  5378     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5379     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5380     MOVE X'204E233030303035313730' TO DFHEIV0(25:11)
  5381     CALL 'kxdfhei1' USING DFHEIV0,
  5382           DFHEIV1,
  5383           ACTIVITY-TRAILERS,
  5384           DFHEIV12,
  5385           WS-ELTRLR-KEY,
  5386           DFHEIV99,
  5387           DFHEIV11,
  5388           DFHEIV99,
  5389           DFHEIV99
  5390     MOVE EIBRESP  TO WS-RESPONSE
  5391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5392        GO TO 1310-GET-ELTRLRS
  5393     END-IF
  5394     END-IF
  5395     .
  5396 1310-EXIT.
  5397     EXIT.
  5398 1400-GET-WAIT-PER.
  5399     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  5400     MOVE CM-AH-BENEFIT-CD       TO WS-ELCNTL-BEN-CD
  5401     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  5402     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  5403
  5404* EXEC CICS READ
  5405*       INTO    (CONTROL-FILE)
  5406*       DATASET ('ELCNTL')
  5407*       RIDFLD  (WS-ELCNTL-KEY)
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  95
* NSRLTRBL.cbl
  5408*       GTEQ
  5409*       RESP    (WS-RESPONSE)
  5410*    END-EXEC
  5411     MOVE LENGTH OF
  5412      CONTROL-FILE
  5413       TO DFHEIV11
  5414     MOVE 'ELCNTL' TO DFHEIV1
  5415*    MOVE '&"IL       G          (  N#00005187' TO DFHEIV0
  5416     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5417     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5418     MOVE X'204E233030303035313837' TO DFHEIV0(25:11)
  5419     CALL 'kxdfhei1' USING DFHEIV0,
  5420           DFHEIV1,
  5421           CONTROL-FILE,
  5422           DFHEIV11,
  5423           WS-ELCNTL-KEY,
  5424           DFHEIV99,
  5425           DFHEIV99,
  5426           DFHEIV99
  5427     MOVE EIBRESP  TO WS-RESPONSE
  5428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5429     IF RESP-NORMAL
  5430        AND (CF-COMPANY-ID  = BL-COMP-ID)
  5431        AND (CF-RECORD-TYPE = '5')
  5432        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5433           (S1 > +8)
  5434           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5435        END-PERFORM
  5436        IF S1 > +8
  5437           MOVE '**'             TO OUT-WAIT-PER
  5438        ELSE
  5439           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
  5440                                 TO OUT-WAIT-PER
  5441        END-IF
  5442     ELSE
  5443        MOVE '**'                TO OUT-WAIT-PER
  5444     END-IF
  5445    .
  5446 1400-EXIT.
  5447     EXIT.
  5448 1500-GET-ARCH-NO.
  5449     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  5450     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  5451     MOVE SPACES                 TO WS-ELCNTL-GENL
  5452     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  5453
  5454* EXEC CICS READ
  5455*       INTO    (CONTROL-FILE)
  5456*       DATASET ('ELCNTL')
  5457*       RIDFLD  (WS-ELCNTL-KEY)
  5458*       UPDATE
  5459*       RESP    (WS-RESPONSE)
  5460*    END-EXEC
  5461     MOVE LENGTH OF
  5462      CONTROL-FILE
  5463       TO DFHEIV11
  5464     MOVE 'ELCNTL' TO DFHEIV1
  5465*    MOVE '&"IL       EU         (  N#00005219' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  96
* NSRLTRBL.cbl
  5466     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5467     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5468     MOVE X'204E233030303035323139' TO DFHEIV0(25:11)
  5469     CALL 'kxdfhei1' USING DFHEIV0,
  5470           DFHEIV1,
  5471           CONTROL-FILE,
  5472           DFHEIV11,
  5473           WS-ELCNTL-KEY,
  5474           DFHEIV99,
  5475           DFHEIV99,
  5476           DFHEIV99
  5477     MOVE EIBRESP  TO WS-RESPONSE
  5478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5479     IF RESP-NORMAL
  5480        AND (CF-COMPANY-ID  = BL-COMP-ID)
  5481        AND (CF-RECORD-TYPE = '1')
  5482        ADD +1                   TO CF-CO-ARCHIVE-COUNTER
  5483        MOVE CF-CO-ARCHIVE-COUNTER TO WS-ARCHIVE-NO
  5484        MOVE WS-ARCHIVE-NO       TO BL-ARCHIVE-NO
  5485
  5486* EXEC CICS REWRITE
  5487*          FROM    (CONTROL-FILE)
  5488*          DATASET ('ELCNTL')
  5489*       END-EXEC
  5490     MOVE LENGTH OF
  5491      CONTROL-FILE
  5492       TO DFHEIV11
  5493     MOVE 'ELCNTL' TO DFHEIV1
  5494*    MOVE '&& L                  %   #00005232' TO DFHEIV0
  5495     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5496     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5497     MOVE X'2020233030303035323332' TO DFHEIV0(25:11)
  5498     CALL 'kxdfhei1' USING DFHEIV0,
  5499           DFHEIV1,
  5500           CONTROL-FILE,
  5501           DFHEIV11,
  5502           DFHEIV99
  5503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5504     ELSE
  5505        MOVE +0                  TO WS-ARCHIVE-NO
  5506     END-IF
  5507    .
  5508 1500-EXIT.
  5509     EXIT.
  5510 1600-ADD-CORR-TRLR.
  5511
  5512* EXEC CICS READ
  5513*         DATASET    ('ELMSTR')
  5514*         INTO       (CLAIM-MASTER)
  5515*         RIDFLD     (WS-ELMSTR-KEY)
  5516*         UPDATE
  5517*         RESP       (WS-RESPONSE)
  5518*    END-EXEC
  5519     MOVE LENGTH OF
  5520      CLAIM-MASTER
  5521       TO DFHEIV11
  5522     MOVE 'ELMSTR' TO DFHEIV1
  5523*    MOVE '&"IL       EU         (  N#00005243' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  97
* NSRLTRBL.cbl
  5524     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5525     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5526     MOVE X'204E233030303035323433' TO DFHEIV0(25:11)
  5527     CALL 'kxdfhei1' USING DFHEIV0,
  5528           DFHEIV1,
  5529           CLAIM-MASTER,
  5530           DFHEIV11,
  5531           WS-ELMSTR-KEY,
  5532           DFHEIV99,
  5533           DFHEIV99,
  5534           DFHEIV99
  5535     MOVE EIBRESP  TO WS-RESPONSE
  5536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5537     IF NOT RESP-NORMAL
  5538        DISPLAY ' 1600 READ UPD MSTR ' WS-RESPONSE
  5539        GO TO 1600-EXIT
  5540     END-IF
  5541     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
  5542     PERFORM 2000-BUILD-ELNAPS   THRU 2000-EXIT
  5543     IF WS-FOLLOW-UP-DT > CL-NEXT-FOLLOWUP-DT
  5544        MOVE WS-FOLLOW-UP-DT     TO CL-NEXT-FOLLOWUP-DT
  5545     END-IF
  5546     IF WS-RESEND-DT > CL-NEXT-FOLLOWUP-DT
  5547        MOVE WS-RESEND-DT        TO CL-NEXT-FOLLOWUP-DT
  5548     END-IF
  5549     MOVE '2'                    TO CL-LAST-MAINT-TYPE
  5550     MOVE 'AT'                   TO ACTIVITY-TRAILERS
  5551     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY
  5552     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
  5553     MOVE  4                     TO AT-TRAILER-TYPE
  5554     MOVE SAVE-BIN-DATE          TO AT-RECORDED-DT
  5555                                    CL-LAST-MAINT-DT
  5556                                    AT-CORR-LAST-MAINT-DT
  5557     MOVE BL-PROC-ID             TO AT-RECORDED-BY
  5558                                    CL-LAST-MAINT-USER
  5559                                    AT-CORR-LAST-UPDATED-BY
  5560     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  5561                                    CL-LAST-MAINT-HHMMSS.
  5562     MOVE SAVE-BIN-DATE          TO AT-LETTER-SENT-DT.
  5563     MOVE WS-FOLLOW-UP-DT        TO AT-RECEIPT-FOLLOW-UP.
  5564     MOVE WS-RESEND-DT           TO AT-AUTO-RE-SEND-DT.
  5565     MOVE LOW-VALUES             TO AT-LETTER-ANSWERED-DT
  5566                                    AT-LETTER-PURGED-DT.
  5567     MOVE WS-ARCHIVE-NO          TO AT-LETTER-ARCHIVE-NO.
  5568     MOVE '3'                    TO AT-LETTER-ORIGIN
  5569     MOVE BL-LETTER-ID           TO AT-STD-LETTER-FORM
  5570     MOVE SAVE-BIN-DATE          TO AT-INITIAL-PRINT-DATE
  5571     MOVE LOW-VALUES             TO AT-RESEND-PRINT-DATE
  5572
  5573* EXEC CICS WRITE
  5574*         DATASET    ('ELTRLR')
  5575*         FROM       (ACTIVITY-TRAILERS)
  5576*         RIDFLD     (AT-CONTROL-PRIMARY)
  5577*         RESP       (WS-RESPONSE)
  5578*    END-EXEC
  5579     MOVE LENGTH OF
  5580      ACTIVITY-TRAILERS
  5581       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  98
* NSRLTRBL.cbl
  5582     MOVE 'ELTRLR' TO DFHEIV1
  5583*    MOVE '&$ L                  ''  N#00005285' TO DFHEIV0
  5584     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5585     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5586     MOVE X'204E233030303035323835' TO DFHEIV0(25:11)
  5587     CALL 'kxdfhei1' USING DFHEIV0,
  5588           DFHEIV1,
  5589           ACTIVITY-TRAILERS,
  5590           DFHEIV11,
  5591           AT-CONTROL-PRIMARY,
  5592           DFHEIV99,
  5593           DFHEIV99
  5594     MOVE EIBRESP  TO WS-RESPONSE
  5595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5596     IF NOT RESP-NORMAL
  5597        DISPLAY ' 1600 WRITE TRLR ' WS-RESPONSE
  5598        GO TO 1600-EXIT
  5599     END-IF
  5600
  5601* EXEC CICS REWRITE
  5602*         DATASET    ('ELMSTR')
  5603*         FROM       (CLAIM-MASTER)
  5604*         RESP       (WS-RESPONSE)
  5605*    END-EXEC
  5606     MOVE LENGTH OF
  5607      CLAIM-MASTER
  5608       TO DFHEIV11
  5609     MOVE 'ELMSTR' TO DFHEIV1
  5610*    MOVE '&& L                  %  N#00005295' TO DFHEIV0
  5611     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5612     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5613     MOVE X'204E233030303035323935' TO DFHEIV0(25:11)
  5614     CALL 'kxdfhei1' USING DFHEIV0,
  5615           DFHEIV1,
  5616           CLAIM-MASTER,
  5617           DFHEIV11,
  5618           DFHEIV99
  5619     MOVE EIBRESP  TO WS-RESPONSE
  5620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5621     IF NOT RESP-NORMAL
  5622        DISPLAY ' 1600 REWRITE MSTR ' WS-RESPONSE
  5623     END-IF
  5624     .
  5625 1600-EXIT.
  5626     EXIT.
  5627 1700-GET-ELENCC.
  5628     MOVE CL-COMPANY-CD          TO WS-ELENCC-KEY
  5629     MOVE '1'                    TO WS-ELENCC-REC-TYPE
  5630     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  5631     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  5632        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  5633        OR (E1 > +5)
  5634     END-PERFORM
  5635     IF E1 < +5
  5636        MOVE CL-CERT-STATE       TO WS-ELENCC-ENC-CODE (E1:2)
  5637     END-IF
  5638
  5639* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page  99
* NSRLTRBL.cbl
  5640*        DATASET   ('ELENCC')
  5641*        INTO      (ENCLOSURE-CODES)
  5642*        RIDFLD    (WS-ELENCC-KEY)
  5643*        RESP      (WS-RESPONSE)
  5644*    END-EXEC
  5645     MOVE LENGTH OF
  5646      ENCLOSURE-CODES
  5647       TO DFHEIV11
  5648     MOVE 'ELENCC' TO DFHEIV1
  5649*    MOVE '&"IL       E          (  N#00005317' TO DFHEIV0
  5650     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5651     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5652     MOVE X'204E233030303035333137' TO DFHEIV0(25:11)
  5653     CALL 'kxdfhei1' USING DFHEIV0,
  5654           DFHEIV1,
  5655           ENCLOSURE-CODES,
  5656           DFHEIV11,
  5657           WS-ELENCC-KEY,
  5658           DFHEIV99,
  5659           DFHEIV99,
  5660           DFHEIV99
  5661     MOVE EIBRESP  TO WS-RESPONSE
  5662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5663     IF NOT RESP-NORMAL
  5664        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  5665
  5666* EXEC CICS READ
  5667*           DATASET   ('ELENCC')
  5668*           INTO      (ENCLOSURE-CODES)
  5669*           RIDFLD    (WS-ELENCC-KEY)
  5670*           RESP      (WS-RESPONSE)
  5671*       END-EXEC
  5672     MOVE LENGTH OF
  5673      ENCLOSURE-CODES
  5674       TO DFHEIV11
  5675     MOVE 'ELENCC' TO DFHEIV1
  5676*    MOVE '&"IL       E          (  N#00005325' TO DFHEIV0
  5677     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5678     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5679     MOVE X'204E233030303035333235' TO DFHEIV0(25:11)
  5680     CALL 'kxdfhei1' USING DFHEIV0,
  5681           DFHEIV1,
  5682           ENCLOSURE-CODES,
  5683           DFHEIV11,
  5684           WS-ELENCC-KEY,
  5685           DFHEIV99,
  5686           DFHEIV99,
  5687           DFHEIV99
  5688     MOVE EIBRESP  TO WS-RESPONSE
  5689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5690     END-IF
  5691     IF RESP-NORMAL
  5692        MOVE NC-OUTPUT-STACK     TO OUT-OUTSTACK
  5693        MOVE NC-ENCLOSURE-LINE   TO OUT-ENCLINE
  5694        MOVE NC-ATTACHMENTS      TO OUT-ENCATTS
  5695     END-IF
  5696     .
  5697 1700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page 100
* NSRLTRBL.cbl
  5698     EXIT.
  5699 1800-SET-EL150D-FIELDS.
  5700     MOVE SPACES TO WS-UNSORTED-TABLE
  5701                    WS-SORTED-TABLE
  5702
  5703     MOVE ' '                    TO WS-PDEF-RECORD-SW
  5704
  5705     MOVE CM-CONTROL-PRIMARY     TO ELCRTT-KEY
  5706     MOVE 'B'                    TO CRTT-REC-TYPE
  5707
  5708
  5709* EXEC CICS READ
  5710*       DATASET   ('ELCRTT')
  5711*       INTO      (CERTIFICATE-TRAILERS)
  5712*       RIDFLD    (ELCRTT-KEY)
  5713*       RESP      (WS-RESPONSE)
  5714*    END-EXEC
  5715     MOVE LENGTH OF
  5716      CERTIFICATE-TRAILERS
  5717       TO DFHEIV11
  5718     MOVE 'ELCRTT' TO DFHEIV1
  5719*    MOVE '&"IL       E          (  N#00005349' TO DFHEIV0
  5720     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5721     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5722     MOVE X'204E233030303035333439' TO DFHEIV0(25:11)
  5723     CALL 'kxdfhei1' USING DFHEIV0,
  5724           DFHEIV1,
  5725           CERTIFICATE-TRAILERS,
  5726           DFHEIV11,
  5727           ELCRTT-KEY,
  5728           DFHEIV99,
  5729           DFHEIV99,
  5730           DFHEIV99
  5731     MOVE EIBRESP  TO WS-RESPONSE
  5732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5733
  5734     IF NOT RESP-NORMAL
  5735        DISPLAY ' NSRLTRBL- NO TRLRS ' CL-CERT-NO
  5736        GO TO 1800-EXIT
  5737     END-IF
  5738
  5739     DISPLAY ' NSRLTRBL- GOOD READ ON ELCRTT '
  5740     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5741       (S1 > +24)
  5742       OR (CS-CLAIM-NO (S1) = SPACES)
  5743        MOVE CS-CLAIM-NO (S1)    TO WS-CLAIM-NO (S1)
  5744        MOVE CS-CLAIM-TYPE (S1)  TO WS-CLM-TYPE (S1)
  5745        IF CS-INSURED-TYPE (S1) = 'C'
  5746           MOVE '2'              TO WS-INS-TYPE (S1)
  5747        ELSE
  5748           MOVE '1'              TO WS-INS-TYPE (S1)
  5749        END-IF
  5750        MOVE CS-BENEFIT-PERIOD (S1)
  5751                                 TO WS-BEN-PER (S1)
  5752*       MOVE CS-DAYS-PAID (S1)   TO WS-DAYS-PAID (S1)
  5753        MOVE CS-TOTAL-PAID (S1)  TO WS-TOTAL-PAID (S1)
  5754        MOVE ' '                 TO WS-SORTED-SW (S1)
  5755
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page 101
* NSRLTRBL.cbl
  5756        MOVE CS-COMPANY-CD          TO WS-ELMSTR-COMPANY-CD
  5757        MOVE CS-CARRIER             TO WS-ELMSTR-CARRIER
  5758        MOVE CS-CLAIM-NO (S1)       TO WS-ELMSTR-CLAIM-NO
  5759        MOVE CS-CERT-NO             TO WS-ELMSTR-CERT-NO
  5760
  5761
  5762* EXEC CICS READ
  5763*          DATASET        ('ELMSTR')
  5764*          RIDFLD         (WS-ELMSTR-KEY)
  5765*          INTO           (CLAIM-MASTER)
  5766*          RESP           (WS-RESPONSE)
  5767*       END-EXEC
  5768     MOVE LENGTH OF
  5769      CLAIM-MASTER
  5770       TO DFHEIV11
  5771     MOVE 'ELMSTR' TO DFHEIV1
  5772*    MOVE '&"IL       E          (  N#00005383' TO DFHEIV0
  5773     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5774     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5775     MOVE X'204E233030303035333833' TO DFHEIV0(25:11)
  5776     CALL 'kxdfhei1' USING DFHEIV0,
  5777           DFHEIV1,
  5778           CLAIM-MASTER,
  5779           DFHEIV11,
  5780           WS-ELMSTR-KEY,
  5781           DFHEIV99,
  5782           DFHEIV99,
  5783           DFHEIV99
  5784     MOVE EIBRESP  TO WS-RESPONSE
  5785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5786        IF RESP-NORMAL
  5787           MOVE CL-INCURRED-DT   TO WS-INC-DT (S1)
  5788           MOVE CL-PAID-THRU-DT  TO WS-PD-THRU-DT (S1)
  5789           MOVE CL-CLAIM-STATUS  TO WS-STATUS (S1)
  5790           IF CL-CRITICAL-PERIOD NOT NUMERIC
  5791              MOVE ZEROS TO CL-CRITICAL-PERIOD
  5792           END-IF
  5793           MOVE CL-CRITICAL-PERIOD
  5794                                 TO WS-MAX-BENS (S1)
  5795           IF CL-CRITICAL-PERIOD = ZEROS
  5796              IF CL-CLAIM-TYPE = 'L' OR 'P' OR 'O'
  5797                 MOVE 01         TO WS-MAX-BENS (S1)
  5798              ELSE
  5799                 MOVE CM-AH-ORIG-TERM
  5800                                 TO WS-MAX-BENS (S1)
  5801              END-IF
  5802           END-IF
  5803           IF CL-DENIAL-TYPE = '1' OR '2' OR '3' OR '4'
  5804              MOVE 'D'           TO WS-STATUS (S1)
  5805           END-IF
  5806           IF CS-CLAIM-NO (S1) = BL-CLAIM-NO
  5807              MOVE CL-ACCIDENT-CLAIM-SW TO OUT-ACC-SW
  5808           END-IF
  5809
  5810           MOVE ' '                    TO WS-PDEF-RECORD-SW
  5811           IF (AM-DCC-PRODUCT-CODE NOT = SPACES)
  5812              PERFORM 1850-GET-DDF-LIMITS
  5813                                 THRU 1850-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page 102
* NSRLTRBL.cbl
  5814           END-IF
  5815           IF PDEF-FOUND
  5816              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  5817                 (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
  5818                 OR (P1 > +8)
  5819              END-PERFORM
  5820              IF P1 < +9
  5821                 IF CL-CLAIM-TYPE = 'L' OR 'P' OR 'O'
  5822                    IF (PD-MAX-AMT (P1) NOT = ZEROS)
  5823                       AND (PD-MAX-AMT (P1) < CM-LF-BENEFIT-AMT)
  5824                       MOVE PD-MAX-AMT (P1)
  5825                                 TO WS-MAX-MOBEN (S1)
  5826                    ELSE
  5827                       MOVE CM-LF-BENEFIT-AMT
  5828                                 TO WS-MAX-MOBEN (S1)
  5829                    END-IF
  5830                 ELSE
  5831                    IF PD-BEN-PCT (P1) NOT NUMERIC
  5832                       MOVE ZEROS   TO PD-BEN-PCT (P1)
  5833                    END-IF
  5834                    IF PD-BEN-PCT (P1) = ZEROS
  5835                       MOVE +1      TO WS-WORK-BEN-PCT
  5836                    ELSE
  5837                       MOVE PD-BEN-PCT (P1)
  5838                                    TO WS-WORK-BEN-PCT
  5839                    END-IF
  5840                    COMPUTE WS-MAX-MOBEN (S1) =
  5841                       CM-AH-BENEFIT-AMT * WS-WORK-BEN-PCT
  5842                    IF (PD-MAX-AMT (P1) NOT = ZEROS)
  5843                       AND (PD-MAX-AMT (P1) < WS-MAX-MOBEN (S1))
  5844                       MOVE PD-MAX-AMT (P1)
  5845                                 TO WS-MAX-MOBEN (S1)
  5846                    END-IF
  5847                 END-IF
  5848*                IF (PD-MAX-AMT (P1) NOT = ZEROS)
  5849*                   AND (PD-MAX-AMT (P1) < CM-AH-BENEFIT-AMT)
  5850*                   MOVE PD-MAX-AMT (P1) TO WS-MAX-MOBEN (S1)
  5851*                ELSE
  5852*                   MOVE CM-AH-BENEFIT-AMT TO WS-MAX-MOBEN (S1)
  5853*                END-IF
  5854                 MOVE PD-EXCLUSION-PERIOD-DAYS (P1)
  5855                                 TO WS-EXCL-PER (S1)
  5856                 MOVE PD-COVERAGE-ENDS-MOS (P1)
  5857                                 TO WS-COV-ENDS (S1)
  5858                 MOVE PD-ACCIDENT-ONLY-MOS (P1)
  5859                                 TO WS-ACC-PER (S1)
  5860                 MOVE PD-MAX-EXTENSION (P1)
  5861                                 TO WS-MAX-EXTEN (S1)
  5862                 EVALUATE TRUE
  5863                    WHEN PD-RECURRING-YN (P1) = 'N'
  5864                       MOVE 00   TO WS-REC-MOS (S1)
  5865                    WHEN PD-RECURRING-YN (P1) = 'Y'
  5866                       MOVE 99   TO WS-REC-MOS (S1)
  5867                    WHEN PD-REC-CRIT-PERIOD (P1) NUMERIC
  5868                       MOVE PD-REC-CRIT-PERIOD (P1)
  5869                                 TO WS-REC-MOS (S1)
  5870                    WHEN OTHER
  5871                       MOVE ZEROS TO WS-REC-MOS (S1)
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page 103
* NSRLTRBL.cbl
  5872                 END-EVALUATE
  5873                 IF WS-REC-MOS (S1) = ZEROS
  5874                    MOVE 01      TO WS-REC-MOS (S1)
  5875                 END-IF
  5876                 DISPLAY ' NSRLTRBL- PDEF FOUND ' WS-EXCL-PER (S1)
  5877              END-IF
  5878           ELSE
  5879              IF CL-CLAIM-TYPE NOT = 'L' AND 'P' AND 'O'
  5880                 MOVE CM-AH-BENEFIT-AMT
  5881                                 TO WS-MAX-MOBEN (S1)
  5882              ELSE
  5883                 MOVE ZEROS      TO WS-MAX-MOBEN (S1)
  5884              END-IF
  5885              MOVE ZEROS         TO WS-EXCL-PER (S1)
  5886                                    WS-MAX-EXTEN (S1)
  5887                                    WS-ACC-PER  (S1)
  5888              MOVE 999           TO WS-COV-ENDS (S1)
  5889              MOVE 01            TO WS-REC-MOS  (S1)
  5890           END-IF
  5891        END-IF
  5892     END-PERFORM
  5893
  5894*      SORT THE TABLE
  5895     MOVE HIGH-VALUES            TO WS-KEY (S1)
  5896     COMPUTE WS-MAX-SUB = S1 - +1
  5897     DISPLAY ' NSRLTRBL- JUST BUILT TABLE '   WS-MAX-SUB
  5898
  5899     MOVE WS-MAX-SUB             TO WS-CNTR
  5900
  5901     MOVE +1                     TO S2
  5902     MOVE +0                     TO S3
  5903     PERFORM UNTIL (WS-CNTR = ZERO) OR (S3 > 700)
  5904        MOVE +0 TO WS-HOLD-S1
  5905        MOVE HIGH-VALUES TO WS-HOLD-KEY
  5906        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5907           (S1 > WS-MAX-SUB)
  5908           IF (WS-SORTED-SW (S1) NOT = 'Y')
  5909              AND (WS-KEY (S1) <= WS-HOLD-KEY)
  5910              MOVE WS-KEY (S1)   TO WS-HOLD-KEY
  5911              MOVE S1            TO WS-HOLD-S1
  5912           END-IF
  5913        END-PERFORM
  5914        IF WS-HOLD-S1 NOT = ZEROS
  5915           MOVE WS-HOLD-S1         TO S1
  5916           MOVE WS-KEY        (S1) TO WS-SRTD-KEY        (S2)
  5917           MOVE WS-STATUS     (S1) TO WS-SRTD-STATUS     (S2)
  5918           MOVE WS-MAX-BENS   (S1) TO WS-SRTD-MAX-BENS   (S2)
  5919           MOVE WS-EXCL-PER   (S1) TO WS-SRTD-EXCL-PER   (S2)
  5920           MOVE WS-COV-ENDS   (S1) TO WS-SRTD-COV-ENDS   (S2)
  5921           MOVE WS-ACC-PER    (S1) TO WS-SRTD-ACC-PER    (S2)
  5922           MOVE WS-REC-MOS    (S1) TO WS-SRTD-REC-MOS    (S2)
  5923           MOVE WS-MAX-EXTEN  (S1) TO WS-SRTD-MAX-EXTEN  (S2)
  5924           MOVE WS-PD-THRU-DT (S1) TO WS-SRTD-PD-THRU-DT (S2)
  5925           MOVE WS-CLAIM-NO   (S1) TO WS-SRTD-CLAIM-NO   (S2)
  5926           MOVE WS-MAX-MOBEN  (S1) TO WS-SRTD-MAX-MOBEN  (S2)
  5927           MOVE WS-TOTAL-PAID (S1) TO WS-SRTD-TOTAL-PAID (S2)
  5928*          MOVE WS-REM-BENS   (S1) TO WS-SRTD-REM-BENS   (S2)
  5929           MOVE 'Y'                TO WS-SORTED-SW       (S1)
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page 104
* NSRLTRBL.cbl
  5930           SUBTRACT 1 FROM WS-CNTR
  5931           ADD +1 TO S2
  5932        END-IF
  5933        ADD 1 TO S3
  5934     END-PERFORM
  5935
  5936     DISPLAY ' NSRLTRBL- JUST SORTED TABLE '
  5937
  5938***  -----------------------
  5939     IF BL-COMP-ID NOT = 'DCC' AND 'VPP'
  5940        PERFORM 1900-BUILD-NON-DCC
  5941        GO TO 1800-EXIT
  5942     END-IF
  5943
  5944     MOVE SPACES                 TO WS-PREV-CLM-TYPE
  5945                                    WS-PREV-INS-TYPE
  5946     MOVE ZEROS                  TO WS-PREV-BEN-PER
  5947                                    WS-ACCUM-DAYS
  5948                                    WS-ACCUM-AMT
  5949                                    WS-ACCUM-PD-BENS
  5950
  5951     MOVE +1                     TO M1
  5952     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5953        S1 > WS-MAX-SUB
  5954        IF (WS-SRTD-CLM-TYPE (S1) = WS-PREV-CLM-TYPE)
  5955           AND (WS-SRTD-BEN-PER (S1) = WS-PREV-BEN-PER)
  5956           AND (WS-SRTD-INS-TYPE (S1) NOT = WS-PREV-INS-TYPE)
  5957           MOVE ZEROS            TO WS-ACCUM-DAYS
  5958                                    WS-ACCUM-AMT
  5959                                    WS-ACCUM-PD-BENS
  5960        END-IF
  5961        MOVE WS-SRTD-INS-TYPE (S1) TO WS-PREV-INS-TYPE
  5962        IF (WS-SRTD-CLM-TYPE (S1) = WS-PREV-CLM-TYPE)
  5963           AND (WS-SRTD-BEN-PER (S1) NOT = WS-PREV-BEN-PER)
  5964           MOVE ZEROS            TO WS-ACCUM-DAYS
  5965                                    WS-ACCUM-AMT
  5966                                    WS-ACCUM-PD-BENS
  5967        END-IF
  5968        MOVE WS-SRTD-BEN-PER (S1) TO WS-PREV-BEN-PER
  5969        IF WS-SRTD-CLM-TYPE (S1) NOT = WS-PREV-CLM-TYPE
  5970           PERFORM 1810-SET-NEW-HEAD
  5971                                 THRU 1810-EXIT
  5972           MOVE WS-SRTD-CLM-TYPE (S1)
  5973                                 TO WS-PREV-CLM-TYPE
  5974           ADD +1                TO M1
  5975        END-IF
  5976
  5977        MOVE WS-SRTD-BEN-PER (S1)  TO OUT-BEN-PER
  5978        IF WS-SRTD-INS-TYPE (S1) = '1'
  5979           MOVE 'PRIM'             TO OUT-INS-TYP
  5980        ELSE
  5981           MOVE 'COBO'             TO OUT-INS-TYP
  5982        END-IF
  5983*       EVALUATE WS-SRTD-STATUS (S1)
  5984*          WHEN 'C'
  5985*             MOVE 'CLOSED'        TO WSM-STATUS (M1)
  5986*          WHEN 'D'
  5987*             MOVE 'DENIED'        TO WSM-STATUS (M1)
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page 105
* NSRLTRBL.cbl
  5988*          WHEN 'O'
  5989*             MOVE 'OPEN'          TO WSM-STATUS (M1)
  5990*          WHEN OTHER
  5991*             MOVE 'OTHER'         TO WSM-STATUS (M1)
  5992*       END-EVALUATE
  5993*       MOVE WS-SRTD-CLAIM-NO (S1) TO WSM-CLAIM-NO (M1)
  5994*                                     PI-WSM-CLAIM-NOS (S1)
  5995*       MOVE WS-SRTD-TOTAL-PAID (S1) TO WSM-TOTAL-PAID (M1)
  5996
  5997        COMPUTE OUT-MAX-BENS =
  5998           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  5999
  6000        DISPLAY ' NSRLTRBL- MAX BENS 1 ' OUT-MAX-BENS ' '
  6001           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6002
  6003        MOVE ZEROS TO WK1 WK2
  6004        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  6005           COMPUTE WS-PD-BENS ROUNDED =
  6006              WS-SRTD-TOTAL-PAID (S1) / WS-SRTD-MAX-MOBEN (S1)
  6007           IF WS-SRTD-CLM-TYPE (S1) NOT = 'L' AND 'P'
  6008              DIVIDE WS-SRTD-TOTAL-PAID (S1) BY
  6009                 WS-SRTD-MAX-MOBEN(S1) GIVING WK1
  6010                 REMAINDER WK2
  6011           END-IF
  6012        ELSE
  6013           MOVE ZEROS            TO WS-PD-BENS
  6014        END-IF
  6015        IF (WS-PD-BENS = ZEROS)
  6016           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6017           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6018           MOVE 1                TO WS-PD-BENS
  6019        END-IF
  6020        MOVE WS-PD-BENS          TO OUT-PAID-BENS
  6021*       if wk2 not = zeros
  6022*          move '*'              to wsm-part (m1)
  6023*       end-if
  6024*       compute ws-accum-days =
  6025*          ws-accum-days + ws-srtd-days-paid (s1)
  6026        COMPUTE WS-ACCUM-AMT =
  6027           WS-ACCUM-AMT + WS-SRTD-TOTAL-PAID (S1)
  6028        DISPLAY ' NSRLTRBL- COMPUTE A PD BENS ' M1 ' '
  6029           WS-ACCUM-AMT ' ' WS-SRTD-MAX-MOBEN (S1)
  6030        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  6031           COMPUTE WS-ACCUM-PD-BENS ROUNDED =
  6032              WS-ACCUM-AMT / WS-SRTD-MAX-MOBEN (S1)
  6033        ELSE
  6034           MOVE ZEROS            TO WS-ACCUM-PD-BENS
  6035        END-IF
  6036        IF (WS-ACCUM-PD-BENS = ZEROS)
  6037           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6038           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6039           MOVE 1                TO WS-ACCUM-PD-BENS
  6040        END-IF
  6041        DISPLAY ' NSRLTRBL- COMPUTE REM BENS ' M1 ' '
  6042           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6043        COMPUTE OUT-REM-BENS =
  6044           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  6045        PERFORM 1820-FIND-QUALIFY THRU 1820-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page 106
* NSRLTRBL.cbl
  6046
  6047*       MOVE ws-srtd-inc-dt (s1)    TO DC-BIN-DATE-1
  6048*       MOVE ' '                    TO DC-OPTION-CODE
  6049*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6050*       IF NO-CONVERSION-ERROR
  6051*          MOVE DC-GREG-DATE-A-EDIT TO wsm-inc-date (m1)
  6052*       ELSE
  6053*          MOVE SPACES              TO wsm-inc-date (m1)
  6054*       END-IF
  6055*       MOVE ws-srtd-pd-thru-dt (s1) TO DC-BIN-DATE-1
  6056*       MOVE ' '                     TO DC-OPTION-CODE
  6057*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6058*       IF NO-CONVERSION-ERROR
  6059*          MOVE DC-GREG-DATE-A-EDIT TO wsm-pd-thru-dt (m1)
  6060*       ELSE
  6061*          MOVE SPACES              TO wsm-pd-thru-dt (m1)
  6062*       END-IF
  6063        ADD +1                   TO M1
  6064        IF WS-SRTD-CLAIM-NO (S1) = BL-CLAIM-NO
  6065           MOVE WS-SRTD-EXCL-PER (S1) TO OUT-EXCL-PER
  6066           MOVE 26 TO S1
  6067        END-IF
  6068
  6069     END-PERFORM
  6070
  6071*   DISPLAY ' NSRLTRBL- 1800 end MAX BENS '  OUT-MAX-BENS
  6072*   display  ' PAID BENS ' OUT-PAID-BENS ' REM BENS ' OUT-REM-BENS
  6073*   display  ' EXCL PER ' OUT-EXCL-PER ' REC MOS ' OUT-REC-MOS
  6074*   display  ' INS TYP ' OUT-INS-TYP ' BEN PER ' OUT-BEN-PER
  6075*   display  ' ACC SW ' OUT-ACC-SW
  6076
  6077     .
  6078 1800-EXIT.
  6079     EXIT.
  6080
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page 107
* NSRLTRBL.cbl
  6082
  6083 1810-SET-NEW-HEAD.
  6084     MOVE ZEROS                  TO WS-ACCUM-DAYS
  6085                                    WS-ACCUM-AMT
  6086                                    WS-ACCUM-PD-BENS
  6087     EVALUATE WS-SRTD-CLM-TYPE (S1)
  6088        WHEN 'A'
  6089           MOVE 'A&H'            TO WS-COV-TYPE
  6090        WHEN 'F'
  6091           MOVE 'FAM '           TO WS-COV-TYPE
  6092        WHEN 'I'
  6093           MOVE ' IU '           TO WS-COV-TYPE
  6094        WHEN 'L'
  6095           MOVE 'LIFE'           TO WS-COV-TYPE
  6096        WHEN OTHER
  6097           MOVE WS-SRTD-CLM-TYPE (S1)
  6098                                 TO WS-COV-TYPE
  6099     END-EVALUATE
  6100
  6101     MOVE WS-SRTD-REC-MOS (S1) TO OUT-REC-MOS
  6102     MOVE WS-SRTD-EXCL-PER (S1) TO OUT-EXCL-PER
  6103
  6104*    string '  ' ws-cov-type ' ExPer ' OUT-EXCL-PER
  6105*       ' CovEnd ' ws-srtd-cov-ends (s1)
  6106*       ' MaxBens ' ws-srtd-max-bens (s1)
  6107*       ' Recurring ' OUT-REC-MOS
  6108*       delimited by size into ws-map-output (m1)
  6109*    end-string
  6110
  6111     .
  6112 1810-EXIT.
  6113     EXIT.
  6114
  6115 1820-FIND-QUALIFY.
  6116     IF NOT PDEF-FOUND
  6117        GO TO 1820-EXIT
  6118     END-IF
  6119
  6120*    DISPLAY ' NSRLTRBL- MAX BENS 2 ' OUT-MAX-BENS ' '
  6121*       WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6122
  6123     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  6124     MOVE ws-srtd-inc-dt (s1)    TO DC-BIN-DATE-2
  6125     MOVE '1'                    TO DC-OPTION-CODE
  6126     MOVE +0                     TO DC-ELAPSED-MONTHS
  6127                                    DC-ELAPSED-DAYS
  6128     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6129
  6130     IF NO-CONVERSION-ERROR
  6131        DISPLAY ' NSRLTRBL- GOOD DATE CONVERT '
  6132        MOVE DC-ELAPSED-MONTHS   TO WS-MONTHS-BETWEEN
  6133        IF DC-ELAPSED-DAYS > 1
  6134           ADD 1 TO WS-MONTHS-BETWEEN
  6135        END-IF
  6136     ELSE
  6137        MOVE ZEROS               TO WS-MONTHS-BETWEEN
  6138     END-IF
  6139
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page 108
* NSRLTRBL.cbl
  6140*    DISPLAY ' NSRLTRBL- DISPLAY 3 ' OUT-EXCL-PER
  6141*       ' ' WS-SRTD-COV-ENDS (S1) ' ' WS-MONTHS-BETWEEN
  6142
  6143     EVALUATE TRUE
  6144        WHEN (OUT-EXCL-PER NOT = ZEROS)
  6145           AND (WS-MONTHS-BETWEEN <= OUT-EXCL-PER)
  6146           DISPLAY ' NSRLTRBL- ZERO 1 '
  6147           MOVE ZEROS TO OUT-MAX-BENS
  6148                         OUT-REM-BENS
  6149        WHEN (WS-SRTD-COV-ENDS (S1) NOT = ZEROS)
  6150           AND (WS-MONTHS-BETWEEN > WS-SRTD-COV-ENDS (S1))
  6151           DISPLAY ' NSRLTRBL- ZERO 2 '
  6152           MOVE ZEROS TO OUT-MAX-BENS
  6153     END-EVALUATE
  6154     IF OUT-REC-MOS < WS-SRTD-BEN-PER (S1)
  6155        MOVE ZEROS               TO OUT-REM-BENS
  6156     END-IF
  6157
  6158     .
  6159 1820-EXIT.
  6160     EXIT.
  6161
  6162 1850-GET-DDF-LIMITS.
  6163
  6164     IF CM-CLP-STATE = SPACES OR LOW-VALUES OR ZEROS
  6165        MOVE CM-STATE            TO CM-CLP-STATE
  6166     END-IF
  6167
  6168     MOVE CL-COMPANY-CD          TO ERPDEF-KEY
  6169     MOVE CM-CLP-STATE           TO ERPDEF-STATE
  6170     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  6171
  6172     IF (CL-CLAIM-TYPE = 'L' OR 'P' OR 'O')
  6173        AND (CM-LF-BENEFIT-CD NOT = '00' AND '  ' AND 'DD')
  6174        MOVE 'L'                 TO ERPDEF-BEN-TYPE
  6175        MOVE CM-LF-BENEFIT-CD    TO ERPDEF-BEN-CODE
  6176     ELSE
  6177        MOVE 'A'                 TO ERPDEF-BEN-TYPE
  6178        MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  6179     END-IF
  6180
  6181     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  6182
  6183*    DISPLAY ' NSRLTRBL- MADE 1850 ' ERPDEF-KEY (2:15)
  6184     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  6185
  6186
  6187* EXEC CICS STARTBR
  6188*        DATASET  ('ERPDEF')
  6189*        RIDFLD   (ERPDEF-KEY)
  6190*        GTEQ
  6191*        RESP     (WS-RESPONSE)
  6192*    END-EXEC
  6193     MOVE 'ERPDEF' TO DFHEIV1
  6194     MOVE 0
  6195       TO DFHEIV11
  6196*    MOVE '&,         G          &  N#00005789' TO DFHEIV0
  6197     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page 109
* NSRLTRBL.cbl
  6198     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6199     MOVE X'204E233030303035373839' TO DFHEIV0(25:11)
  6200     CALL 'kxdfhei1' USING DFHEIV0,
  6201           DFHEIV1,
  6202           ERPDEF-KEY,
  6203           DFHEIV99,
  6204           DFHEIV11,
  6205           DFHEIV99
  6206     MOVE EIBRESP  TO WS-RESPONSE
  6207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6208
  6209     IF NOT RESP-NORMAL
  6210        GO TO 1850-EXIT
  6211     END-IF
  6212
  6213     .
  6214 1850-READNEXT.
  6215
  6216
  6217* EXEC CICS READNEXT
  6218*       DATASET  ('ERPDEF')
  6219*       INTO     (PRODUCT-MASTER)
  6220*       RIDFLD   (ERPDEF-KEY)
  6221*       RESP     (WS-RESPONSE)
  6222*    END-EXEC
  6223     MOVE LENGTH OF
  6224      PRODUCT-MASTER
  6225       TO DFHEIV12
  6226     MOVE 'ERPDEF' TO DFHEIV1
  6227     MOVE 0
  6228       TO DFHEIV11
  6229*    MOVE '&.IL                  )  N#00005803' TO DFHEIV0
  6230     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6231     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6232     MOVE X'204E233030303035383033' TO DFHEIV0(25:11)
  6233     CALL 'kxdfhei1' USING DFHEIV0,
  6234           DFHEIV1,
  6235           PRODUCT-MASTER,
  6236           DFHEIV12,
  6237           ERPDEF-KEY,
  6238           DFHEIV99,
  6239           DFHEIV11,
  6240           DFHEIV99,
  6241           DFHEIV99
  6242     MOVE EIBRESP  TO WS-RESPONSE
  6243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6244
  6245     IF NOT RESP-NORMAL
  6246        GO TO 1850-ENDBR
  6247     END-IF
  6248
  6249     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  6250        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  6251           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  6252           DISPLAY ' NSRLTRBL- SETTING PDEF FOUND TO TRUE '
  6253        ELSE
  6254           GO TO 1850-READNEXT
  6255        END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page 110
* NSRLTRBL.cbl
  6256     ELSE
  6257        GO TO 1850-ENDBR
  6258     END-IF
  6259
  6260     .
  6261 1850-ENDBR.
  6262
  6263
  6264* EXEC CICS ENDBR
  6265*       DATASET  ('ERPDEF')
  6266*    END-EXEC
  6267     MOVE 'ERPDEF' TO DFHEIV1
  6268     MOVE 0
  6269       TO DFHEIV11
  6270*    MOVE '&2                    $   #00005828' TO DFHEIV0
  6271     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6272     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6273     MOVE X'2020233030303035383238' TO DFHEIV0(25:11)
  6274     CALL 'kxdfhei1' USING DFHEIV0,
  6275           DFHEIV1,
  6276           DFHEIV11,
  6277           DFHEIV99
  6278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6279
  6280     .
  6281 1850-EXIT.
  6282     EXIT.
  6283
  6284 1900-BUILD-NON-DCC.
  6285
  6286     MOVE SPACES                 TO WS-PREV-CLM-TYPE
  6287                                    WS-PREV-INS-TYPE
  6288     MOVE ZEROS                  TO WS-PREV-BEN-PER
  6289                                    WS-ACCUM-DAYS
  6290                                    WS-ACCUM-AMT
  6291                                    WS-ACCUM-PD-BENS
  6292
  6293     MOVE +1                     TO M1
  6294     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6295        S1 > WS-MAX-SUB
  6296        IF WS-SRTD-CLM-TYPE (S1) NOT = WS-PREV-CLM-TYPE
  6297           PERFORM 1810-SET-NEW-HEAD
  6298                                 THRU 1810-EXIT
  6299           MOVE WS-SRTD-CLM-TYPE (S1)
  6300                                 TO WS-PREV-CLM-TYPE
  6301           ADD +1                TO M1
  6302        END-IF
  6303        MOVE WS-SRTD-BEN-PER (S1)  TO OUT-BEN-PER
  6304        IF WS-SRTD-INS-TYPE (S1) = '1'
  6305           MOVE 'PRIM'             TO OUT-INS-TYP
  6306        ELSE
  6307           MOVE 'COBO'             TO OUT-INS-TYP
  6308        END-IF
  6309*       evaluate ws-srtd-status (s1)
  6310*          when 'C'
  6311*             MOVE 'CLOSED'        TO WSM-STATUS (M1)
  6312*          WHEN 'D'
  6313*             MOVE 'DENIED'        TO WSM-STATUS (M1)
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page 111
* NSRLTRBL.cbl
  6314*          WHEN 'O'
  6315*             MOVE 'OPEN'          TO WSM-STATUS (M1)
  6316*          WHEN OTHER
  6317*             MOVE 'OTHER'         TO WSM-STATUS (M1)
  6318*       END-EVALUATE
  6319*       move ws-srtd-claim-no (s1) to wsm-claim-no (m1)
  6320*                                     pi-wsm-claim-nos (s1)
  6321*       move ws-srtd-total-paid (s1) to wsm-total-paid (m1)
  6322
  6323        COMPUTE OUT-MAX-BENS =
  6324           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  6325
  6326        DISPLAY ' NSRLTRBL- MAX BENS 1 ' OUT-MAX-BENS ' '
  6327           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6328
  6329        MOVE ZEROS TO WK1 WK2
  6330        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  6331           COMPUTE WS-PD-BENS ROUNDED =
  6332              WS-SRTD-TOTAL-PAID (S1) / WS-SRTD-MAX-MOBEN (S1)
  6333           IF WS-SRTD-CLM-TYPE (S1) NOT = 'L' AND 'P'
  6334              DIVIDE WS-SRTD-TOTAL-PAID (S1) BY
  6335                 WS-SRTD-MAX-MOBEN(S1) GIVING WK1
  6336                 REMAINDER WK2
  6337           END-IF
  6338        ELSE
  6339           MOVE ZEROS            TO WS-PD-BENS
  6340        END-IF
  6341        IF (WS-PD-BENS = ZEROS)
  6342           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6343           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6344           MOVE 1                TO WS-PD-BENS
  6345        END-IF
  6346        MOVE WS-PD-BENS          TO OUT-PAID-BENS
  6347*       IF WK2 NOT = ZEROS
  6348*          MOVE '*'              TO WSM-PART (M1)
  6349*       END-IF
  6350        COMPUTE WS-ACCUM-AMT =
  6351           WS-ACCUM-AMT + WS-SRTD-TOTAL-PAID (S1)
  6352        DISPLAY ' NSRLTRBL- COMPUTE A PD BENS ' M1 ' '
  6353           WS-ACCUM-AMT ' ' WS-SRTD-MAX-MOBEN (S1)
  6354        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  6355           COMPUTE WS-ACCUM-PD-BENS ROUNDED =
  6356              WS-ACCUM-AMT / WS-SRTD-MAX-MOBEN (S1)
  6357        ELSE
  6358           MOVE ZEROS            TO WS-ACCUM-PD-BENS
  6359        END-IF
  6360        IF (WS-ACCUM-PD-BENS = ZEROS)
  6361           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6362           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6363           MOVE 1                TO WS-ACCUM-PD-BENS
  6364        END-IF
  6365        DISPLAY ' NSRLTRBL- COMPUTE REM BENS ' M1 ' '
  6366           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6367        COMPUTE OUT-REM-BENS =
  6368           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  6369
  6370*       MOVE ws-srtd-inc-dt (s1)    TO DC-BIN-DATE-1
  6371*       MOVE ' '                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page 112
* NSRLTRBL.cbl
  6372*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6373*       IF NO-CONVERSION-ERROR
  6374*          MOVE DC-GREG-DATE-A-EDIT TO wsm-inc-date (m1)
  6375*       ELSE
  6376*          MOVE SPACES              TO wsm-inc-date (m1)
  6377*       END-IF
  6378*       MOVE ws-srtd-pd-thru-dt (s1) TO DC-BIN-DATE-1
  6379*       MOVE ' '                     TO DC-OPTION-CODE
  6380*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6381*       IF NO-CONVERSION-ERROR
  6382*          MOVE DC-GREG-DATE-A-EDIT TO wsm-pd-thru-dt (m1)
  6383*       ELSE
  6384*          MOVE SPACES              TO wsm-pd-thru-dt (m1)
  6385*       END-IF
  6386*       move WS-MAP-OUTPUT (m1)  to replineo (m1)
  6387        IF WS-SRTD-CLAIM-NO (S1) = BL-CLAIM-NO
  6388           MOVE WS-SRTD-EXCL-PER (S1) TO OUT-EXCL-PER
  6389           MOVE 26 TO S1
  6390        END-IF
  6391
  6392        ADD +1                   TO M1
  6393     END-PERFORM
  6394*    DISPLAY ' NSRLTRBL- 1900 end MAX BENS '  OUT-MAX-BENS
  6395*    display ' PAID BENS ' OUT-PAID-BENS ' REM BENS ' OUT-REM-BENS
  6396*    display ' EXCL PER ' OUT-EXCL-PER ' REC MOS ' OUT-REC-MOS
  6397*    display ' INS TYP ' OUT-INS-TYP ' BEN PER ' OUT-BEN-PER
  6398*    display ' ACC SW ' OUT-ACC-SW
  6399     .
  6400 2000-BUILD-ELNAPS.
  6401     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6402     MOVE 'NA'                   TO NAPERSOFT-FILE
  6403     MOVE CL-COMPANY-CD          TO NA-COMPANY-CD
  6404     MOVE BL-CARRIER             TO NA-CARRIER
  6405     MOVE BL-CLAIM-NO            TO NA-CLAIM-NO
  6406     MOVE BL-CERT-NO             TO NA-CERT-NO
  6407     MOVE WS-ARCHIVE-NO          TO NA-ARCHIVE-NO
  6408                                    BL-ARCHIVE-NO
  6409     MOVE BL-LETTER-ID           TO NA-LETTER-ID
  6410     MOVE BL-NO-OF-COPIES        TO NA-NO-OF-COPIES
  6411     MOVE SAVE-BIN-DATE          TO NA-CREATION-DT
  6412                                    NA-INITIAL-PRINT-DT
  6413     MOVE LOW-VALUES             TO NA-FOLLOW-UP-DT
  6414                                    NA-RESEND-DT
  6415                                    NA-RESEND-PRINT-DT
  6416                                    NA-1ST-LTR-PRINT-DT
  6417                                    NA-NEXT-DUE-DT
  6418                                    NA-AUTOPYDT
  6419     MOVE CL-TRAILER-SEQ-CNT     TO NA-CORR-TRLR-SEQ
  6420     IF BL-FOLLOW-UP-DT NOT = SPACES AND LOW-VALUES
  6421        STRING BL-FOLLOW-UP-DT (7:2) BL-FOLLOW-UP-DT (1:2)
  6422           BL-FOLLOW-UP-DT (4:2) DELIMITED BY SIZE
  6423             INTO DC-GREG-DATE-1-YMD-R
  6424        END-STRING
  6425        MOVE '3'                 TO DC-OPTION-CODE
  6426        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6427        IF NO-CONVERSION-ERROR
  6428           MOVE DC-BIN-DATE-1    TO NA-FOLLOW-UP-DT
  6429                                    WS-FOLLOW-UP-DT
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page 113
* NSRLTRBL.cbl
  6430        ELSE
  6431           MOVE LOW-VALUES       TO NA-FOLLOW-UP-DT
  6432                                    WS-FOLLOW-UP-DT
  6433        END-IF
  6434     END-IF
  6435     IF BL-RESEND-DT NOT = SPACES AND LOW-VALUES
  6436        STRING BL-RESEND-DT (7:2) BL-RESEND-DT (1:2)
  6437           BL-RESEND-DT (4:2) DELIMITED BY SIZE
  6438             INTO DC-GREG-DATE-1-YMD-R
  6439        END-STRING
  6440        MOVE '3'                 TO DC-OPTION-CODE
  6441        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6442        IF NO-CONVERSION-ERROR
  6443           MOVE DC-BIN-DATE-1    TO NA-RESEND-DT
  6444                                    WS-RESEND-DT
  6445        ELSE
  6446           MOVE LOW-VALUES       TO NA-RESEND-DT
  6447                                    WS-RESEND-DT
  6448        END-IF
  6449     END-IF
  6450     PERFORM WITH TEST AFTER UNTIL RESP-NORMAL
  6451
  6452* EXEC CICS WRITE
  6453*          DATASET   ('ELNAPS')
  6454*          FROM      (NAPERSOFT-FILE)
  6455*          RIDFLD    (NA-CONTROL-PRIMARY)
  6456*          RESP      (WS-RESPONSE)
  6457*       END-EXEC
  6458     MOVE LENGTH OF
  6459      NAPERSOFT-FILE
  6460       TO DFHEIV11
  6461     MOVE 'ELNAPS' TO DFHEIV1
  6462*    MOVE '&$ L                  ''  N#00006003' TO DFHEIV0
  6463     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6464     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6465     MOVE X'204E233030303036303033' TO DFHEIV0(25:11)
  6466     CALL 'kxdfhei1' USING DFHEIV0,
  6467           DFHEIV1,
  6468           NAPERSOFT-FILE,
  6469           DFHEIV11,
  6470           NA-CONTROL-PRIMARY,
  6471           DFHEIV99,
  6472           DFHEIV99
  6473     MOVE EIBRESP  TO WS-RESPONSE
  6474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6475        IF RESP-NORMAL
  6476           CONTINUE
  6477        ELSE
  6478           IF RESP-DUPREC OR RESP-DUPKEY
  6479              ADD +1 TO NA-ARCHIVE-NO
  6480           ELSE
  6481              DISPLAY ' BAD WRITE ELNAPS ' WS-RESPONSE
  6482                 ' ' NA-CONTROL-PRIMARY (2:19)
  6483              SET RESP-NORMAL TO TRUE
  6484           END-IF
  6485        END-IF
  6486     END-PERFORM
  6487    .
* Micro Focus Server Express         V5.1 revision 000 15-Jun-21 09:40 Page 114
* NSRLTRBL.cbl
  6488 2000-EXIT.
  6489     EXIT.
  6490 9700-DATE-LINK.
  6491
  6492* EXEC CICS LINK
  6493*        PROGRAM   ('ELDATCV')
  6494*        COMMAREA  (DATE-CONVERSION-DATA)
  6495*        LENGTH    (DC-COMM-LENGTH)
  6496*    END-EXEC.
  6497     MOVE 'ELDATCV' TO DFHEIV1
  6498*    MOVE '."C                   (   #00006025' TO DFHEIV0
  6499     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6500     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6501     MOVE X'2020233030303036303235' TO DFHEIV0(25:11)
  6502     CALL 'kxdfhei1' USING DFHEIV0,
  6503           DFHEIV1,
  6504           DATE-CONVERSION-DATA,
  6505           DC-COMM-LENGTH,
  6506           DFHEIV99,
  6507           DFHEIV99,
  6508           DFHEIV99,
  6509           DFHEIV99
  6510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6511
  6512 9700-EXIT.
  6513      EXIT.
  6514
  6515 9999-DFHBACK SECTION.
  6516     MOVE '9%                    "   ' TO DFHEIV0
  6517     MOVE 'NSRLTRBL' TO DFHEIV1
  6518     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6519     GOBACK.
  6520 9999-DFHEXIT.
  6521     IF DFHEIGDJ EQUAL 0001
  6522         NEXT SENTENCE.
  6523     MOVE '9%                    "   ' TO DFHEIV0
  6524     MOVE 'NSRLTRBL' TO DFHEIV1
  6525     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6526     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       19096     Code:       16421
