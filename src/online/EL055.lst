* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page   1
* EL055.cbl
* Options: int("EL055.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL055.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL055.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL055.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 identification division.
     2 program-id. EL055.
     3******************************************************************
     4*                   C H A N G E   L O G
     5*
     6* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
     7*-----------------------------------------------------------------
     8*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
     9* EFFECTIVE    NUMBER
    10*-----------------------------------------------------------------
    11* 052020  CR2019111300001  PEMA  New program for 'K' transaction
    12* 072320  IR2020072100002  PEMA  Allow deletion of dup pend issue
    13* 072920  IR2020072900001  PEMA  Skip err if cert notfnd
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page   2
* EL055.cbl
    14******************************************************************
    15 environment division.
    16 data division.
    17 working-storage section.
    18 01  DFH-START PIC X(04).
    19 77  s1                          pic s999 comp-3 value +0.
    20 77  ns1                         pic s9(5) comp-3 value +0.
    21 77  nscntr                      pic s999 comp-3 value +0.
    22 77  ws-eof-sw                   pic x  value spaces.
    23     88  end-of-input                  value 'Y'.
    24 77  ws-error-sw                 pic x  value spaces.
    25     88  error-found               value 'Y'.
    26 77  ws-string-len               pic s999 comp-3 value zeros.
    27 77  ws-startbr-ind              pic x value spaces.
    28 77  ws-NS-startbr-ind           pic x value spaces.
    29 77  ws-bypass-ind               pic x value spaces.
    30     88  bypass-copy-files         value 'Y'.
    31 01  P pointer.
    32 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    33 01  var-ptr pointer.
    34 01  env-var-len                 pic 9(4)  binary.
    35 01  rc                          pic 9(9)  binary.
    36 01  ws-new-greg-eff-date        pic x(10).
    37 01  ws-old-greg-eff-date        pic x(10).
    38 01  WS-KIXSYS.
    39     05  WS-KIX-FIL1             PIC X(10).
    40     05  WS-KIX-APPS             PIC X(10).
    41     05  WS-KIX-ENV              PIC X(10).
    42     05  WS-KIX-MYENV            PIC X(10).
    43     05  WS-KIX-SYS              PIC X(10).
    44*                                copy ERCPNDB.
    45******************************************************************
    46*                                                                *
    47*                                                                *
    48*                            ERCPNDB.                            *
    49*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    50*                            VMOD=2.025                          *
    51*                                                                *
    52*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
    53*                                                                *
    54******************************************************************
    55*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
    56*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
    57******************************************************************
    58*                                                                *
    59*                                                                *
    60*   FILE TYPE = VSAM,KSDS                                        *
    61*   RECORD SIZE = 585  RECFORM = FIXED                           *
    62*                                                                *
    63*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
    64*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
    65*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
    66*                                                 RKP=13,LEN=36  *
    67*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
    68*                                      AND CHG-SEQ.)             *
    69*                                                RKP=49,LEN=11   *
    70*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
    71*                                      AND CHG-SEQ.)             *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page   3
* EL055.cbl
    72*                                                RKP=60,LEN=15   *
    73*                                                                *
    74*   LOG = NO                                                     *
    75*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
    76******************************************************************
    77******************************************************************
    78*                   C H A N G E   L O G
    79*
    80* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    81*-----------------------------------------------------------------
    82*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    83* EFFECTIVE    NUMBER
    84*-----------------------------------------------------------------
    85* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    86* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
    87* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    88* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    89* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
    90* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    91* 032306                   PEMA  ADD BOW LOAN NUMBER
    92* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
    93* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    94* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    95* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    96* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
    97* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
    98* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    99* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   100* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
   101* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   102* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
   103* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   104* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
   105******************************************************************
   106
   107 01  PENDING-BUSINESS.
   108     12  PB-RECORD-ID                     PIC XX.
   109         88  VALID-PB-ID                        VALUE 'PB'.
   110
   111     12  PB-CONTROL-PRIMARY.
   112         16  PB-COMPANY-CD                PIC X.
   113         16  PB-ENTRY-BATCH               PIC X(6).
   114         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   115         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   116
   117     12  PB-CONTROL-BY-ACCOUNT.
   118         16  PB-COMPANY-CD-A1             PIC X.
   119         16  PB-CARRIER                   PIC X.
   120         16  PB-GROUPING.
   121             20  PB-GROUPING-PREFIX       PIC XXX.
   122             20  PB-GROUPING-PRIME        PIC XXX.
   123         16  PB-STATE                     PIC XX.
   124         16  PB-ACCOUNT.
   125             20  PB-ACCOUNT-PREFIX        PIC X(4).
   126             20  PB-ACCOUNT-PRIME         PIC X(6).
   127         16  PB-CERT-EFF-DT               PIC XX.
   128         16  PB-CERT-NO.
   129             20  PB-CERT-PRIME            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page   4
* EL055.cbl
   130             20  PB-CERT-SFX              PIC X.
   131         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   132
   133         16  PB-RECORD-TYPE               PIC X.
   134             88  PB-MAILING-DATA                VALUE '0'.
   135             88  PB-ISSUE                       VALUE '1'.
   136             88  PB-CANCELLATION                VALUE '2'.
   137             88  PB-BATCH-TRAILER               VALUE '9'.
   138
   139     12  PB-CONTROL-BY-ORIG-BATCH.
   140         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   141         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   142         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   143         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   144
   145     12  PB-CONTROL-BY-CSR.
   146         16  PB-CSR-COMPANY-CD            PIC X.
   147         16  PB-CSR-ID                    PIC X(4).
   148         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   149         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   150         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   151******************************************************************
   152*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   153******************************************************************
   154
   155     12  PB-LAST-MAINT-DT                 PIC XX.
   156     12  PB-LAST-MAINT-BY                 PIC X(4).
   157     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   158
   159     12  PB-RECORD-BODY                   PIC X(375).
   160
   161     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   162         16  PB-CERT-ORIGIN               PIC X.
   163             88  CLASIC-CREATED-CERT         VALUE '1'.
   164         16  PB-I-NAME.
   165             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   166             20  PB-I-INSURED-FIRST-NAME.
   167                 24  PB-I-INSURED-1ST-INIT PIC X.
   168                 24  FILLER                PIC X(9).
   169             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   170         16  PB-I-AGE                     PIC S99   COMP-3.
   171         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   172         16  PB-I-BIRTHDAY                PIC XX.
   173         16  PB-I-INSURED-SEX             PIC X.
   174             88  PB-SEX-MALE     VALUE 'M'.
   175             88  PB-SEX-FEMALE   VALUE 'F'.
   176
   177         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   178         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   179         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   180         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   181         16  PB-I-SKIP-CODE               PIC X.
   182             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   183             88  PB-SKIP-JULY              VALUE '1'.
   184             88  PB-SKIP-AUGUST            VALUE '2'.
   185             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   186             88  PB-SKIP-JULY-AUG          VALUE '4'.
   187             88  PB-SKIP-AUG-SEPT          VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page   5
* EL055.cbl
   188             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
   189             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
   190             88  PB-SKIP-JUNE              VALUE '8'.
   191             88  PB-SKIP-JUNE-JULY         VALUE '9'.
   192             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
   193             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
   194         16  PB-I-TERM-TYPE               PIC X.
   195             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
   196             88  PB-PAID-WEEKLY            VALUE 'W'.
   197             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
   198             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
   199             88  PB-PAID-13-YEARLY         VALUE 'T'.
   200         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
   201         16  PB-I-POLICY-FORM-NO          PIC X(12).
   202         16  PB-I-DATA-ENTRY-SW           PIC X.
   203             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
   204             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
   205             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
   206             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
   207         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
   208         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
   209*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
   210         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
   211         16  PB-I-LETTER-REQD             PIC X.
   212
   213         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
   214             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
   215             88  PB-INVALID-LIFE             VALUE '  ' '00'
   216                                                   '90' THRU '99'.
   217         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
   218                                          PIC XX.
   219         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   220         16  PB-I-AMOUNT-FINANCED REDEFINES
   221                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
   222         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
   223         16  PB-I-UNPAID-CASH-PRICE REDEFINES
   224                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
   225         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   226         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
   227         16  PB-I-CLP-AMOUNT REDEFINES
   228                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
   229         16  PB-I-LF-CALC-FLAG            PIC X.
   230             88 PB-COMP-LF-PREM               VALUE '?'.
   231         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
   232         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
   233         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
   234         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
   235         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
   236         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
   237         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
   238         16  PB-I-LF-ABBR                 PIC XXX.
   239         16  PB-I-LF-INPUT-CD             PIC XX.
   240
   241         16  PB-I-AH-BENEFIT-CD           PIC XX.
   242             88  PB-VALID-AH                 VALUE '01' THRU '89'.
   243             88  PB-INVALID-AH               VALUE '  ' '00'
   244                                                   '90' THRU '99'.
   245         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page   6
* EL055.cbl
   246         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   247         16  PB-I-AH-CALC-FLAG            PIC X.
   248             88 PB-COMP-AH-PREM                  VALUE '?'.
   249         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
   250         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
   251         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
   252         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
   253         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
   254         16  PB-I-AH-ABBR                 PIC XXX.
   255         16  PB-I-AH-INPUT-CD             PIC XXX.
   256
   257         16  PB-I-SPECIAL-REIN-CODE       PIC X.
   258         16  PB-I-REIN-TABLE              PIC XXX.
   259         16  PB-I-BUSINESS-TYPE           PIC 99.
   260         16  PB-I-INDV-GRP-CD             PIC X.
   261         16  PB-I-MORT-CODE.
   262             20  PB-I-TABLE               PIC X.
   263             20  PB-I-INTEREST            PIC XX.
   264             20  PB-I-MORT-TYP            PIC X.
   265         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
   266         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
   267         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
   268         16  PB-I-INDV-GRP-OVRD           PIC X.
   269         16  PB-I-RATE-CLASS-OVRD         PIC XX.
   270         16  PB-I-SIG-SW                  PIC X.
   271             88  PB-POLICY-SIGNED             VALUE 'Y'.
   272         16  PB-I-RATE-CLASS              PIC XX.
   273         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
   274         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
   275         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
   276         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
   277         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
   278         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
   279         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
   280         16  PB-I-BENEFIT-TYPE            PIC XXX.
   281         16  PB-I-OB-FLAG                 PIC X.
   282             88  PB-I-OB                      VALUE 'B'.
   283             88  PB-I-SUMMARY                 VALUE 'Z'.
   284         16  PB-I-ENTRY-STATUS            PIC X.
   285             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
   286                                              'M' '5' '9' '2'.
   287             88  PB-I-NORMAL-ENTRY            VALUE '1'.
   288             88  PB-I-POLICY-PENDING          VALUE '2'.
   289             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
   290             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
   291             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
   292             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
   293             88  PB-I-REIN-ONLY               VALUE '9'.
   294             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
   295             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
   296             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
   297             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
   298         16  PB-I-INT-CODE                PIC X.
   299             88  PB-ADD-ON-INTEREST           VALUE 'A'.
   300             88  PB-SIMPLE-INTEREST           VALUE 'S'.
   301         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   302         16  PB-I-SOC-SEC-NO              PIC X(11).
   303         16  PB-I-MEMBER-NO               PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page   7
* EL055.cbl
   304         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
   305*        16  PB-I-LOAN-OFFICER            PIC XXX.
   306         16  PB-I-OLD-LOF                 PIC XXX.
   307         16  PB-I-LF-EXPIRE-DT            PIC XX.
   308         16  PB-I-AH-EXPIRE-DT            PIC XX.
   309         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
   310         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
   311         16  PB-I-LIFE-INDICATOR          PIC X.
   312             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
   313         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
   314         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
   315                                          PIC S9(5)V99    COMP-3.
   316         16  PB-I-MAIL-ADDRS-SW           PIC X.
   317             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
   318             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
   319         16  PB-I-1ST-PMT-DT              PIC XX.
   320         16  PB-I-JOINT-INSURED.
   321             20 PB-I-JOINT-LAST-NAME      PIC X(15).
   322             20 PB-I-JOINT-FIRST-NAME.
   323                24  PB-I-JOINT-FIRST-INIT PIC X.
   324                24  FILLER                PIC X(9).
   325             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
   326*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
   327         16  PB-I-BENEFICIARY-NAME.
   328             20  PB-I-BANK-NUMBER         PIC X(10).
   329             20  FILLER                   PIC X(15).
   330         16  PB-I-LAST-ADD-ON-DT          PIC XX.
   331         16  PB-I-REFERENCE               PIC X(12).
   332         16  FILLER REDEFINES PB-I-REFERENCE.
   333             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
   334             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
   335             20  PB-I-CLP-STATE           PIC XX.
   336         16  PB-I-UNDERWRITING-STATUS     PIC X.
   337             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
   338             88  PB-I-POLICY-DECLINED         VALUE 'D'.
   339             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
   340         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
   341         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
   342         16  PB-I-RESIDENT-STATE          PIC XX.
   343         16  PB-I-RATE-CODE               PIC X(4).
   344         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
   345         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   346         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   347         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
   348         16  PB-I-BANK-NOCHRGB            PIC 99.
   349         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
   350         16  PB-I-JOINT-BIRTHDAY          PIC XX.
   351
   352     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
   353         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
   354             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
   355         16  PB-C-CANCEL-ORIGIN           PIC X.
   356             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
   357         16  PB-C-LF-CANCEL-DT            PIC XX.
   358         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   359         16  PB-C-LF-CALC-REQ             PIC X.
   360             88 PB-COMP-LF-CANCEL            VALUE '?'.
   361         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page   8
* EL055.cbl
   362         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
   363         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
   364             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
   365         16  PB-C-AH-CANCEL-DT            PIC XX.
   366         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   367         16  PB-C-AH-CALC-REQ             PIC X.
   368             88 PB-COMP-AH-CANCEL            VALUE '?'.
   369         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
   370         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
   371         16  PB-C-LAST-NAME               PIC X(15).
   372         16  PB-C-REFUND-SW               PIC X.
   373             88  PB-C-REFUND-CREATED          VALUE 'Y'.
   374             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
   375         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
   376         16  PB-C-PAYEE-CODE              PIC X(6).
   377         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
   378         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
   379         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
   380         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
   381         16  PB-C-REFERENCE               PIC X(12).
   382         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   383         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   384         16  PB-C-POST-CARD-IND           PIC X.
   385         16  PB-C-CANCEL-REASON           PIC X.
   386         16  PB-C-REF-INTERFACE-SW        PIC X.
   387         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
   388         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
   389         16  FILLER                       PIC X(01).
   390*        16  FILLER                       PIC X(18).
   391         16  PB-C-POLICY-FORM-NO          PIC X(12).
   392*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
   393         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
   394         16  PB-CANCELED-CERT-DATA.
   395             20  PB-CI-INSURED-NAME.
   396                 24  PB-CI-LAST-NAME      PIC X(15).
   397                 24  PB-CI-INITIALS       PIC XX.
   398             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
   399             20  PB-CI-INSURED-SEX        PIC X.
   400             20  PB-CI-LF-TERM            PIC S999        COMP-3.
   401             20  PB-CI-LF-BENEFIT-CD      PIC XX.
   402             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
   403             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
   404             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   405             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
   406             20  PB-CI-AH-TERM            PIC S999        COMP-3.
   407             20  PB-CI-AH-BENEFIT-CD      PIC XX.
   408             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
   409             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   410             20  PB-CI-RATE-CLASS         PIC XX.
   411             20  PB-CI-RATE-DEV-LF        PIC XXX.
   412             20  PB-CI-RATE-DEV-AH        PIC XXX.
   413             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
   414             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
   415             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
   416             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
   417             20  PB-CI-LF-ABBR            PIC X(3).
   418             20  PB-CI-AH-ABBR            PIC X(3).
   419             20  PB-CI-OB-FLAG            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page   9
* EL055.cbl
   420                 88  PB-CI-OB                VALUE 'B'.
   421             20  PB-CI-LF-POLICY-STATUS   PIC X.
   422                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
   423                                           'M' '4' '5' '9' '2'.
   424                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
   425                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
   426                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
   427                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
   428                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
   429                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
   430                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   431                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
   432                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   433                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
   434                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
   435                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
   436                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
   437             20  PB-CI-AH-POLICY-STATUS   PIC X.
   438                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
   439                                           'M' '4' '5' '9' '2'.
   440                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
   441                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
   442                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
   443                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
   444                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
   445                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
   446                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   447                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
   448                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   449                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
   450                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
   451                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
   452                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
   453             20  PB-CI-PAY-FREQUENCY      PIC 99.
   454             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
   455             20  PB-CI-SOC-SEC-NO         PIC X(11).
   456             20  PB-CI-MEMBER-NO          PIC X(12).
   457             20  PB-CI-INT-CODE           PIC X.
   458                 88  PB-CI-ADD-ON                  VALUE 'A'.
   459                 88  PB-CI-SIMPLE                  VALUE 'S'.
   460             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
   461             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
   462             20  PB-CI-COMP-EXCP-SW       PIC X.
   463                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
   464                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
   465             20  PB-CI-ENTRY-STATUS       PIC X.
   466             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
   467             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
   468             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
   469             20  PB-CI-DEATH-DT           PIC XX.
   470             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
   471             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
   472             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
   473             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
   474             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
   475             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
   476             20  PB-CI-ENTRY-DT              PIC XX.
   477             20  PB-CI-ENTRY-BATCH           PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  10
* EL055.cbl
   478             20  PB-CI-LF-EXPIRE-DT          PIC XX.
   479             20  PB-CI-AH-EXPIRE-DT          PIC XX.
   480             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
   481             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
   482             20  PB-CI-OLD-LOF               PIC XXX.
   483*            20  PB-CI-LOAN-OFFICER          PIC XXX.
   484             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
   485             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
   486             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
   487             20  PB-CI-INDV-GRP-CD           PIC X.
   488             20  PB-CI-BENEFICIARY-NAME.
   489                 24  PB-CI-BANK-NUMBER       PIC X(10).
   490                 24  FILLER                  PIC X(15).
   491             20  PB-CI-NOTE-SW               PIC X.
   492             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
   493             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
   494             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
   495             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
   496             20  PB-CI-LOAN-OFFICER          PIC X(5).
   497             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
   498             20  PB-CI-FIRST-NAME            PIC X(10).
   499             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
   500
   501         16  FILLER                       PIC X(13).
   502*032306  16  FILLER                       PIC X(27).
   503*        16  FILLER                       PIC X(46).
   504
   505     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
   506         16  FILLER                       PIC X(10).
   507         16  PB-M-INSURED-LAST-NAME       PIC X(15).
   508         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
   509         16  PB-M-INSURED-MID-INIT        PIC X.
   510         16  PB-M-INSURED-AGE             PIC 99.
   511         16  PB-M-INSURED-BIRTHDAY        PIC XX.
   512         16  PB-M-INSURED-SEX             PIC X.
   513         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
   514         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
   515         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
   516         16  PB-M-INSURED-CITY-STATE.
   517             20  PB-M-INSURED-CITY        PIC X(28).
   518             20  PB-M-INSURED-STATE       PIC XX.
   519         16  PB-M-INSURED-ZIP-CODE.
   520             20  PB-M-INSURED-ZIP-PRIME.
   521                 24  PB-M-INSURED-ZIP-1   PIC X.
   522                     88  PB-M-CANADIAN-POST-CODE
   523                                             VALUE 'A' THRU 'Z'.
   524                 24  FILLER               PIC X(4).
   525             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
   526         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
   527                                        PB-M-INSURED-ZIP-CODE.
   528             20  PM-M-INS-CAN-POST1       PIC XXX.
   529             20  PM-M-INS-CAN-POST2       PIC XXX.
   530             20  FILLER                   PIC XXX.
   531         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
   532         16  PB-M-JOINT-BIRTHDAY          PIC XX.
   533         16  PB-M-CRED-BENE-NAME          PIC X(30).
   534         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
   535         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  11
* EL055.cbl
   536         16  PB-M-CRED-BENE-CITYST.
   537             20  PB-M-CRED-BENE-CITY      PIC X(28).
   538             20  PB-M-CRED-BENE-STATE     PIC XX.
   539         16  FILLER                       PIC X(92).
   540
   541     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
   542         16  FILLER                       PIC X(10).
   543         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   544         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   545         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   546         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   547         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   548         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   549         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   550         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   551         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   552         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   553         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   554         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   555         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   556         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   557         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   558         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   559         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   560         16  PB-ACCOUNT-NAME              PIC X(30).
   561         16  PB-PREM-REF-RPT-FLAG         PIC X.
   562         16  PB-REFERENCE                 PIC X(12).
   563         16  PB-B-RECEIVED-DT             PIC XX.
   564         16  FILLER                       PIC X(234).
   565
   566     12  PB-RECORD-STATUS.
   567         16  PB-CREDIT-SELECT-DT          PIC XX.
   568         16  PB-CREDIT-ACCEPT-DT          PIC XX.
   569         16  PB-BILLED-DT                 PIC XX.
   570         16  PB-BILLING-STATUS            PIC X.
   571             88  PB-ENTRY-REVERSED            VALUE 'R'.
   572             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
   573             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
   574         16  PB-RECORD-BILL               PIC X.
   575             88  PB-RECORD-ON-HOLD            VALUE 'H'.
   576             88  PB-RECORD-RETURNED           VALUE 'R'.
   577             88  PB-RECORD-ENDORSED           VALUE 'E'.
   578             88  PB-OVERRIDE-LIFE             VALUE 'L'.
   579             88  PB-OVERRIDE-AH               VALUE 'A'.
   580             88  PB-OVERRIDE-BOTH             VALUE 'B'.
   581         16  PB-BATCH-ENTRY               PIC X.
   582             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
   583             88  PB-REIN-ONLY-CERT            VALUE 'R'.
   584             88  PB-REISSUED-CERT             VALUE 'E'.
   585             88  PB-CASH-CERT                 VALUE 'C'.
   586             88  PB-MONTHLY-CERT              VALUE 'M'.
   587             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
   588             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
   589             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
   590         16  PB-FORCE-CODE                PIC X.
   591             88  PB-FORCE-OFF                 VALUE ' ' '0'.
   592             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
   593             88  PB-CANCEL-FORCE              VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  12
* EL055.cbl
   594             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
   595             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
   596             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
   597             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
   598             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
   599             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
   600             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
   601             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
   602         16  PB-FATAL-FLAG                PIC X.
   603             88  PB-FATAL-ERRORS              VALUE 'X'.
   604         16  PB-FORCE-ER-CD               PIC X.
   605             88  PB-FORCE-ERRORS              VALUE 'F'.
   606             88  PB-UNFORCED-ERRORS           VALUE 'X'.
   607         16  PB-WARN-ER-CD                PIC X.
   608             88  PB-WARNING-ERRORS            VALUE 'W'.
   609         16  FILLER                       PIC X.
   610         16  PB-OUT-BAL-CD                PIC X.
   611             88  PB-OUT-OF-BAL                VALUE 'O'.
   612         16  PB-LIFE-OVERRIDE-L1          PIC X.
   613         16  PB-AH-OVERRIDE-L1            PIC X.
   614         16  PB-INPUT-DT                  PIC XX.
   615         16  PB-INPUT-BY                  PIC X(4).
   616         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
   617         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
   618         16  PB-TOLERANCE-REJECT-SW       PIC X.
   619         16  PB-LF-EARNING-METHOD         PIC X.
   620         16  PB-AH-EARNING-METHOD         PIC X.
   621         16  PB-LF-TERM-CALC-METHOD       PIC X.
   622         16  PB-AH-TERM-CALC-METHOD       PIC X.
   623         16  PB-REIN-CD                   PIC XXX.
   624         16  PB-LF-REFUND-TYPE            PIC X.
   625         16  PB-AH-REFUND-TYPE            PIC X.
   626         16  PB-ACCT-EFF-DT               PIC XX.
   627         16  PB-ACCT-EXP-DT               PIC XX.
   628         16  PB-COMPANY-ID                PIC X(3).
   629         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
   630         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
   631         16  PB-SV-CARRIER                PIC X.
   632         16  PB-SV-GROUPING               PIC X(6).
   633         16  PB-SV-STATE                  PIC XX.
   634         16  PB-CONFIRMATION-REPT-DT      PIC XX.
   635         16  PB-GA-BILLING-INFO.
   636             20  PB-GA-BILL-DT OCCURS 5 TIMES
   637                                          PIC XX.
   638         16  PB-SV-REMIT-TO  REDEFINES
   639             PB-GA-BILLING-INFO           PIC X(10).
   640         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
   641         16  PB-I-LOAN-OFFICER            PIC X(5).
   642         16  PB-I-VIN                     PIC X(17).
   643
   644         16  FILLER                       PIC X(04).
   645         16  IMNET-BYPASS-SW              PIC X.
   646
   647******************************************************************
   648*                COMMON EDIT ERRORS                              *
   649******************************************************************
   650
   651     12  PB-COMMON-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  13
* EL055.cbl
   652         16  PB-COMMON-ERROR    OCCURS 10 TIMES
   653                                           PIC S9(4)     COMP.
   654
   655******************************************************************
   656*                                copy ELCCERT.
   657******************************************************************
   658*                                                                *
   659*                            ELCCERT.                            *
   660*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   661*                            VMOD=2.013                          *
   662*                                                                *
   663*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   664*                                                                *
   665*   FILE TYPE = VSAM,KSDS                                        *
   666*   RECORD SIZE = 450  RECFORM = FIXED                           *
   667*                                                                *
   668*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   669*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   670*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   671*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   672*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   673*                                                                *
   674*   LOG = YES                                                    *
   675*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   676******************************************************************
   677*                   C H A N G E   L O G
   678*
   679* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   680*-----------------------------------------------------------------
   681*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   682* EFFECTIVE    NUMBER
   683*-----------------------------------------------------------------
   684* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   685* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   686* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   687* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   688* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   689* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   690* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   691* 032612  CR2011110200001  PEMA  AHL CHANGES
   692* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   693* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   694* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   695******************************************************************
   696
   697 01  CERTIFICATE-MASTER.
   698     12  CM-RECORD-ID                      PIC XX.
   699         88  VALID-CM-ID                      VALUE 'CM'.
   700
   701     12  CM-CONTROL-PRIMARY.
   702         16  CM-COMPANY-CD                 PIC X.
   703         16  CM-CARRIER                    PIC X.
   704         16  CM-GROUPING.
   705             20  CM-GROUPING-PREFIX        PIC X(3).
   706             20  CM-GROUPING-PRIME         PIC X(3).
   707         16  CM-STATE                      PIC XX.
   708         16  CM-ACCOUNT.
   709             20  CM-ACCOUNT-PREFIX         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  14
* EL055.cbl
   710             20  CM-ACCOUNT-PRIME          PIC X(6).
   711         16  CM-CERT-EFF-DT                PIC XX.
   712         16  CM-CERT-NO.
   713             20  CM-CERT-PRIME             PIC X(10).
   714             20  CM-CERT-SFX               PIC X.
   715
   716     12  CM-CONTROL-BY-NAME.
   717         16  CM-COMPANY-CD-A1              PIC X.
   718         16  CM-INSURED-LAST-NAME          PIC X(15).
   719         16  CM-INSURED-INITIALS.
   720             20  CM-INSURED-INITIAL1       PIC X.
   721             20  CM-INSURED-INITIAL2       PIC X.
   722
   723     12  CM-CONTROL-BY-SSN.
   724         16  CM-COMPANY-CD-A2              PIC X.
   725         16  CM-SOC-SEC-NO.
   726             20  CM-SSN-STATE              PIC XX.
   727             20  CM-SSN-ACCOUNT            PIC X(6).
   728             20  CM-SSN-LN3.
   729                 25  CM-INSURED-INITIALS-A2.
   730                     30 CM-INSURED-INITIAL1-A2   PIC X.
   731                     30 CM-INSURED-INITIAL2-A2   PIC X.
   732                 25 CM-PART-LAST-NAME-A2         PIC X.
   733
   734     12  CM-CONTROL-BY-CERT-NO.
   735         16  CM-COMPANY-CD-A4              PIC X.
   736         16  CM-CERT-NO-A4                 PIC X(11).
   737
   738     12  CM-CONTROL-BY-MEMB.
   739         16  CM-COMPANY-CD-A5              PIC X.
   740         16  CM-MEMBER-NO.
   741             20  CM-MEMB-STATE             PIC XX.
   742             20  CM-MEMB-ACCOUNT           PIC X(6).
   743             20  CM-MEMB-LN4.
   744                 25  CM-INSURED-INITIALS-A5.
   745                     30 CM-INSURED-INITIAL1-A5   PIC X.
   746                     30 CM-INSURED-INITIAL2-A5   PIC X.
   747                 25 CM-PART-LAST-NAME-A5         PIC XX.
   748
   749     12  CM-INSURED-PROFILE-DATA.
   750         16  CM-INSURED-FIRST-NAME.
   751             20  CM-INSURED-1ST-INIT       PIC X.
   752             20  FILLER                    PIC X(9).
   753         16  CM-INSURED-ISSUE-AGE          PIC 99.
   754         16  CM-INSURED-SEX                PIC X.
   755             88  CM-SEX-MALE                  VALUE 'M'.
   756             88  CM-SEX-FEMAL                 VALUE 'F'.
   757         16  CM-INSURED-JOINT-AGE          PIC 99.
   758         16  CM-JOINT-INSURED-NAME.
   759             20  CM-JT-LAST-NAME           PIC X(15).
   760             20  CM-JT-FIRST-NAME.
   761                 24  CM-JT-1ST-INIT        PIC X.
   762                 24  FILLER                PIC X(9).
   763             20  CM-JT-INITIAL             PIC X.
   764
   765     12  CM-LIFE-DATA.
   766         16  CM-LF-BENEFIT-CD              PIC XX.
   767         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  15
* EL055.cbl
   768         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   769         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   770         16  CM-LF-DEV-CODE                PIC XXX.
   771         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   772         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   773         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   774         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   775         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   776         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   777         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   778         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   779         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   780         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   781         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   782         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   783         16  cm-temp-epiq                  pic xx.
   784             88  EPIQ-CLASS                  value 'EQ'.
   785*        16  FILLER                        PIC XX.
   786
   787     12  CM-AH-DATA.
   788         16  CM-AH-BENEFIT-CD              PIC XX.
   789         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   790         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   791         16  CM-AH-DEV-CODE                PIC XXX.
   792         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   793         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   794         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   795         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   796         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   797         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   798         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   799         16  CM-AH-PAID-THRU-DT            PIC XX.
   800             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   801         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   802         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
   803         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   804         16  FILLER                        PIC X.
   805
   806     12  CM-LOAN-INFORMATION.
   807         16  CM-LIVES                      PIC S9(7)     COMP-3.
   808         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   809                                           PIC S9(5)V99  COMP-3.
   810         16  CM-BILLED                     PIC S9(7)     COMP-3.
   811         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   812         16  CM-PAY-FREQUENCY              PIC S99.
   813         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   814         16  CM-RATE-CLASS                 PIC XX.
   815         16  CM-BENEFICIARY                PIC X(25).
   816         16  CM-POLICY-FORM-NO             PIC X(12).
   817         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   818         16  CM-LAST-ADD-ON-DT             PIC XX.
   819         16  CM-DEDUCTIBLE-AMOUNTS.
   820             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   821             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   822         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   823             20  CM-RESIDENT-STATE         PIC XX.
   824             20  CM-RATE-CODE              PIC X(4).
   825             20  FILLER                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  16
* EL055.cbl
   826         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   827             20  CM-LOAN-OFFICER           PIC X(5).
   828             20  FILLER                    PIC XXX.
   829         16  CM-CSR-CODE                   PIC XXX.
   830         16  CM-UNDERWRITING-CODE          PIC X.
   831             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   832         16  CM-POST-CARD-IND              PIC X.
   833         16  CM-REF-INTERFACE-SW           PIC X.
   834         16  CM-PREMIUM-TYPE               PIC X.
   835             88  CM-SING-PRM                  VALUE '1'.
   836             88  CM-O-B-COVERAGE              VALUE '2'.
   837             88  CM-OPEN-END                  VALUE '3'.
   838         16  CM-IND-GRP-TYPE               PIC X.
   839             88  CM-INDIVIDUAL                VALUE 'I'.
   840             88  CM-GROUP                     VALUE 'G'.
   841         16  CM-SKIP-CODE                  PIC X.
   842             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   843             88  SKIP-JULY                    VALUE '1'.
   844             88  SKIP-AUGUST                  VALUE '2'.
   845             88  SKIP-SEPTEMBER               VALUE '3'.
   846             88  SKIP-JULY-AUG                VALUE '4'.
   847             88  SKIP-AUG-SEPT                VALUE '5'.
   848             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   849             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   850             88  SKIP-JUNE                    VALUE '8'.
   851             88  SKIP-JUNE-JULY               VALUE '9'.
   852             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   853             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   854         16  CM-PAYMENT-MODE               PIC X.
   855             88  PAY-MONTHLY                  VALUE SPACE.
   856             88  PAY-WEEKLY                   VALUE '1'.
   857             88  PAY-SEMI-MONTHLY             VALUE '2'.
   858             88  PAY-BI-WEEKLY                VALUE '3'.
   859             88  PAY-SEMI-ANUALLY             VALUE '4'.
   860         16  CM-LOAN-NUMBER                PIC X(8).
   861         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   862         16  CM-OLD-LOF                    PIC XXX.
   863*        16  CM-LOAN-OFFICER               PIC XXX.
   864         16  CM-REIN-TABLE                 PIC XXX.
   865         16  CM-SPECIAL-REIN-CODE          PIC X.
   866         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   867         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   868         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   869
   870     12  CM-STATUS-DATA.
   871         16  CM-ENTRY-STATUS               PIC X.
   872         16  CM-ENTRY-DT                   PIC XX.
   873
   874         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   875         16  CM-LF-CANCEL-DT               PIC XX.
   876         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   877
   878         16  CM-LF-STATUS-AT-DEATH         PIC X.
   879         16  CM-LF-DEATH-DT                PIC XX.
   880         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   881
   882         16  CM-LF-CURRENT-STATUS          PIC X.
   883             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  17
* EL055.cbl
   884                                                'M' '4' '5' '9'.
   885             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   886             88  CM-LF-POLICY-PENDING         VALUE '2'.
   887             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   888             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   889             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   890             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   891             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   892             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   893             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   894             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   895             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   896             88  CM-LF-DECLINED               VALUE 'D'.
   897             88  CM-LF-VOIDED                 VALUE 'V'.
   898
   899         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   900         16  CM-AH-CANCEL-DT               PIC XX.
   901         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   902
   903         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   904         16  CM-AH-SETTLEMENT-DT           PIC XX.
   905         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   906
   907         16  CM-AH-CURRENT-STATUS          PIC X.
   908             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   909                                                'M' '4' '5' '9'.
   910             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   911             88  CM-AH-POLICY-PENDING         VALUE '2'.
   912             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   913             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   914             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   915             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   916             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   917             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   918             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   919             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   920             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   921             88  CM-AH-DECLINED               VALUE 'D'.
   922             88  CM-AH-VOIDED                 VALUE 'V'.
   923
   924         16  CM-CLAIM-INTERFACE-SW         PIC X.
   925             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   926             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   927             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   928         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   929
   930         16  CM-ENTRY-BATCH                PIC X(6).
   931         16  CM-LF-EXIT-BATCH              PIC X(6).
   932         16  CM-AH-EXIT-BATCH              PIC X(6).
   933         16  CM-LAST-MONTH-END             PIC XX.
   934
   935     12  CM-NOTE-SW                        PIC X.
   936         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   937         88  CERT-NOTES-PRESENT               VALUE '1'.
   938         88  BILLING-NOTES-PRESENT            VALUE '2'.
   939         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   940         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   941         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  18
* EL055.cbl
   942         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   943         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   944     12  CM-COMP-EXCP-SW                   PIC X.
   945         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   946         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   947     12  CM-INSURED-ADDRESS-SW             PIC X.
   948         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   949         88  INSURED-ADDR-PRESENT             VALUE '1'.
   950
   951*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   952     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   953     12  FILLER                            PIC X.
   954
   955*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   956     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   957     12  FILLER                            PIC X.
   958*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   959     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
   960
   961     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   962         88  CERT-ADDED-BATCH                 VALUE ' '.
   963         88  CERT-ADDED-ONLINE                VALUE '1'.
   964         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   965         88  CERT-PURGED-OFFLINE              VALUE '3'.
   966         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   967     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   968         88  CERT-AS-LOADED                   VALUE ' '.
   969         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   970         88  CERT-CLAIM-ONLINE                VALUE '2'.
   971         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   972         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   973         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   974         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   975         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   976
   977     12  CM-ACCOUNT-COMM-PCTS.
   978         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   979         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   980
   981     12  CM-USER-FIELD                     PIC X.
   982     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   983     12  CM-CLP-STATE                      PIC XX.
   984     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   985     12  CM-USER-RESERVED                  PIC XXX.
   986     12  FILLER REDEFINES CM-USER-RESERVED.
   987         16  CM-AH-CLASS-CD                PIC XX.
   988         16  F                             PIC X.
   989******************************************************************
   990*                                copy ELCCRTO.
   991******************************************************************
   992*                                                                *
   993*                            ELCCRTO.                            *
   994*                                                                *
   995*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
   996*                                                                *
   997*   FILE TYPE = VSAM,KSDS                                        *
   998*   RECORD SIZE = 524  RECFORM = FIXED                           *
   999*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  19
* EL055.cbl
  1000*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1001*                                                                *
  1002*   LOG = YES                                                    *
  1003*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1004******************************************************************
  1005*                   C H A N G E   L O G
  1006*
  1007* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1008*-----------------------------------------------------------------
  1009*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1010* EFFECTIVE    NUMBER
  1011*-----------------------------------------------------------------
  1012* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1013* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1014* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1015* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1016* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1017******************************************************************
  1018 01  ORIGINAL-CERTIFICATE.
  1019     12  OC-RECORD-ID                      PIC XX.
  1020         88  VALID-OC-ID                      VALUE 'OC'.
  1021     12  OC-CONTROL-PRIMARY.
  1022         16  OC-COMPANY-CD                 PIC X.
  1023         16  OC-CARRIER                    PIC X.
  1024         16  OC-GROUPING                   PIC X(6).
  1025         16  OC-STATE                      PIC XX.
  1026         16  OC-ACCOUNT                    PIC X(10).
  1027         16  OC-CERT-EFF-DT                PIC XX.
  1028         16  OC-CERT-NO.
  1029             20  OC-CERT-PRIME             PIC X(10).
  1030             20  OC-CERT-SFX               PIC X.
  1031         16  OC-RECORD-TYPE                PIC X.
  1032         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1033     12  OC-LAST-MAINT-DT                  PIC XX.
  1034     12  OC-LAST-MAINT-BY                  PIC X(4).
  1035     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1036     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1037     12  FILLER                            PIC X(49).
  1038     12  OC-ORIG-REC.
  1039         16  OC-INS-LAST-NAME              PIC X(15).
  1040         16  OC-INS-FIRST-NAME             PIC X(10).
  1041         16  OC-INS-MIDDLE-INIT            PIC X.
  1042         16  OC-INS-AGE                    PIC S999     COMP-3.
  1043         16  OC-JNT-LAST-NAME              PIC X(15).
  1044         16  OC-JNT-FIRST-NAME             PIC X(10).
  1045         16  OC-JNT-MIDDLE-INIT            PIC X.
  1046         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1047         16  OC-LF-BENCD                   PIC XX.
  1048         16  OC-LF-TERM                    PIC S999      COMP-3.
  1049         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1050         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1051         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1052         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1053         16  OC-LF-EXP-DT                  PIC XX.
  1054         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1055         16  OC-LF-CANCEL-DT               PIC XX.
  1056         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1057         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  20
* EL055.cbl
  1058         16  OC-AH-BENCD                   PIC XX.
  1059         16  OC-AH-TERM                    PIC S999      COMP-3.
  1060         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1061         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1062         16  OC-AH-EXP-DT                  PIC XX.
  1063         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1064         16  OC-AH-CP                      PIC 99.
  1065         16  OC-AH-CANCEL-DT               PIC XX.
  1066         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1067         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1068         16  OC-CRED-BENE-NAME             PIC X(25).
  1069         16  OC-1ST-PMT-DT                 PIC XX.
  1070         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1071         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1072         16  OC-ISSUE-TRAN-IND             PIC X.
  1073         16  OC-CANCEL-TRAN-IND            PIC X.
  1074         16  FILLER                        PIC X(211).
  1075
  1076     12  FILLER                            PIC X(50).
  1077******************************************************************
  1078*                                copy ELCCRTT.
  1079******************************************************************
  1080*                                                                *
  1081*                            ELCCRTT.                            *
  1082*                                                                *
  1083*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  1084*                                                                *
  1085*   FILE TYPE = VSAM,KSDS                                        *
  1086*   RECORD SIZE = 552  RECFORM = FIXED                           *
  1087*                                                                *
  1088*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  1089*                                                                *
  1090*   LOG = YES                                                    *
  1091*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1092******************************************************************
  1093*                   C H A N G E   L O G
  1094*
  1095* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1096*-----------------------------------------------------------------
  1097*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1098* EFFECTIVE    NUMBER
  1099*-----------------------------------------------------------------
  1100* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  1101* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  1102* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  1103* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1104* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1105* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1106* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1107* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  1108* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1109* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  1110* 091318  CR2018073000001  PEMA  ADD Refund methods
  1111* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  1112******************************************************************
  1113
  1114 01  CERTIFICATE-TRAILERS.
  1115     12  CS-RECORD-ID                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  21
* EL055.cbl
  1116         88  VALID-CS-ID                      VALUE 'CS'.
  1117
  1118     12  CS-CONTROL-PRIMARY.
  1119         16  CS-COMPANY-CD                 PIC X.
  1120         16  CS-CARRIER                    PIC X.
  1121         16  CS-GROUPING                   PIC X(6).
  1122         16  CS-STATE                      PIC XX.
  1123         16  CS-ACCOUNT                    PIC X(10).
  1124         16  CS-CERT-EFF-DT                PIC XX.
  1125         16  CS-CERT-NO.
  1126             20  CS-CERT-PRIME             PIC X(10).
  1127             20  CS-CERT-SFX               PIC X.
  1128         16  CS-TRAILER-TYPE               PIC X.
  1129             88  COMM-TRLR           VALUE 'A'.
  1130             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  1131             88  CERT-DATA-TRLR      VALUE 'C'.
  1132
  1133     12  CS-DATA-AREA                      PIC X(516).
  1134
  1135     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  1136         16  CS-BANK-COMMISSION-AREA.
  1137             20  CS-BANK-COMMS       OCCURS 10.
  1138                 24  CS-AGT                PIC X(10).
  1139                 24  CS-COM-TYP            PIC X.
  1140                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  1141                 24  CS-RECALC-LV-INDIC    PIC X.
  1142                 24  FILLER                PIC X(10).
  1143         16  FILLER                        PIC X(256).
  1144
  1145     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  1146****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  1147         16  CS-MB-CLAIM-DATA OCCURS 24.
  1148             20  CS-CLAIM-NO               PIC X(7).
  1149             20  CS-CLAIM-TYPE             PIC X.
  1150                 88  CS-AH-CLM               VALUE 'A'.
  1151                 88  CS-IU-CLM               VALUE 'I'.
  1152                 88  CS-GP-CLM               VALUE 'G'.
  1153                 88  CS-LF-CLM               VALUE 'L'.
  1154                 88  CS-PR-CLM               VALUE 'P'.
  1155                 88  CS-FL-CLM               VALUE 'F'.
  1156                 88  CS-OT-CLM               VALUE 'O'.
  1157             20  CS-INSURED-TYPE           PIC X.
  1158                 88  CS-PRIM-INSURED          VALUE 'P'.
  1159                 88  CS-CO-BORROWER           VALUE 'C'.
  1160             20  CS-BENEFIT-PERIOD         PIC 99.
  1161             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  1162             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  1163             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  1164         16  FILLER                        PIC X(12).
  1165     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  1166         16  CS-VIN-NUMBER                 PIC X(17).
  1167         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  1168         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  1169         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  1170         16  cs-agent-name.
  1171             20  cs-agent-fname            pic x(20).
  1172             20  cs-agent-mi               pic x.
  1173             20  cs-agent-lname            pic x(25).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  22
* EL055.cbl
  1174         16  cs-license-no                 pic x(15).
  1175         16  cs-npn-number                 pic x(10).
  1176         16  cs-agent-edit-status          pic x.
  1177             88  cs-ae-refer-to-manager      value 'M'.
  1178             88  cs-ae-cover-sheet           value 'C'.
  1179             88  cs-ae-sig-form              value 'S'.
  1180             88  cs-ae-verified              value 'V'.
  1181             88  cs-unidentified-signature   value 'U'.
  1182             88  cs-cert-returned            value 'R'.
  1183             88  cs-accept-no-commission     value 'N'.
  1184         16  cs-year                       pic 9999.
  1185         16  cs-make                       pic x(20).
  1186         16  cs-model                      pic x(20).
  1187         16  cs-future                     pic x(20).
  1188         16  cs-vehicle-odometer           pic s9(7) comp-3.
  1189         16  cs-claim-verification-status  pic x.
  1190             88  cs-clm-ver-eligible         value 'A'.
  1191             88  cs-clm-ver-partial-elig     value 'B'.
  1192             88  cs-clm-ver-not-eligible     value 'C'.
  1193             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  1194             88  cs-clm-ver-not-part-elig-rw value 'E'.
  1195             88  cs-clm-ver-ND-CERT          value 'F'.
  1196             88  cs-clm-ver-spec-other       value 'G'.
  1197             88  cs-clam-ver-pratial-corrected
  1198                                             value 'H'.
  1199             88  cs-clm-ver-no-matches       value 'I'.
  1200             88  cs-clm-ver-not-elig-corrected
  1201                                             value 'J'.
  1202             88  cs-clm-ver-needs-review     value 'R'.
  1203             88  cs-clm-ver-sent-to-claims   value 'W'.
  1204         16  CS-LF-REFUND-METHOD           PIC X.
  1205         16  CS-AH-REFUND-METHOD           PIC X.
  1206         16  FILLER                        PIC X(353). *> was 420
  1207*        16  FILLER                        PIC X(496).
  1208*                                copy ERCARCH.
  1209******************************************************************
  1210*                                                                *
  1211*                            ERCARCH.                            *
  1212*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1213*                            VMOD=2.002                          *
  1214*                                                                *
  1215*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  1216*                                                                *
  1217*   FILE TYPE = VSAM,KSDS                                        *
  1218*   RECORD SIZE = 250  RECFORM = FIXED                           *
  1219*                                                                *
  1220*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  1221*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  1222*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  1223*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  1224*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  1225*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  1226*                                                                *
  1227*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1228******************************************************************
  1229*                   C H A N G E   L O G
  1230*
  1231* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  23
* EL055.cbl
  1232*-----------------------------------------------------------------
  1233*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1234* EFFECTIVE    NUMBER
  1235*-----------------------------------------------------------------
  1236* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1237* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  1238* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1239* 102918  CR2018080300002  PEMA  ADD ONBASE STUFF
  1240******************************************************************
  1241 01  LETTER-ARCHIVE.
  1242     12  LA-RECORD-ID                PIC  X(02).
  1243         88  LA-VALID-ID                VALUE 'LA'.
  1244
  1245     12  LA-CONTROL-PRIMARY.
  1246         16  LA-COMPANY-CD           PIC  X(01).
  1247         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  1248
  1249     12  LA-CONTROL-BY-CERT-RESP.
  1250         16  LA-COMPANY-CD-A2        PIC  X(01).
  1251         16  LA-CERT-NO-A2.
  1252             20  LA-CERT-PRIME-A2    PIC  X(10).
  1253             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  1254         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  1255             20  LA-RESP-PERSON-A2   PIC  X(10).
  1256             20  LA-TYPE-A2          PIC  X(01).
  1257         16  LA-CARRIER-A2           PIC  X(01).
  1258         16  LA-GROUPING-A2          PIC  X(06).
  1259         16  LA-STATE-A2             PIC  X(02).
  1260         16  LA-ACCOUNT-A2           PIC  X(10).
  1261         16  LA-EFFECT-DATE-A2       PIC  X(02).
  1262         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  1263
  1264     12  LA-CONTROL-BY-FORM.
  1265         16  LA-COMPANY-CD-A3        PIC  X(01).
  1266         16  LA-FORM-A3              PIC  X(04).
  1267         16  LA-CARRIER-A3           PIC  X(01).
  1268         16  LA-GROUPING-A3          PIC  X(06).
  1269         16  LA-STATE-A3             PIC  X(02).
  1270         16  LA-ACCOUNT-A3           PIC  X(10).
  1271         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  1272
  1273     12  LA-CONTROL-BY-PROCESSOR.
  1274         16  LA-COMPANY-CD-A4        PIC  X(01).
  1275         16  LA-PROCESSOR-CD         PIC  X(04).
  1276         16  LA-CARRIER-A4           PIC  X(01).
  1277         16  LA-GROUPING-A4          PIC  X(06).
  1278         16  LA-STATE-A4             PIC  X(02).
  1279         16  LA-ACCOUNT-A4           PIC  X(10).
  1280         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  1281
  1282     12  LA-CONTROL-BY-KEY-FIELDS.
  1283         16  LA-COMPANY-CD-A5        PIC  X(01).
  1284         16  LA-CARRIER-A5           PIC  X(01).
  1285         16  LA-GROUPING-A5          PIC  X(06).
  1286         16  LA-STATE-A5             PIC  X(02).
  1287         16  LA-ACCOUNT-A5           PIC  X(10).
  1288         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  1289
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  24
* EL055.cbl
  1290     12  LA-CONTROL-BY-GROUP-CODE.
  1291         16  LA-COMPANY-CD-A6        PIC  X(01).
  1292         16  LA-ENTRY-A6.
  1293             20  LA-FILLER           PIC  X(02).
  1294             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  1295         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  1296
  1297     12  FILLER                      PIC  X(09).
  1298
  1299     12  LA-HEADER-RECORD.
  1300         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  1301         16  LA-CREATION-DATE        PIC  X(02).
  1302         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  1303         16  LA-FINAL-ACT-DATE       REDEFINES
  1304               LA-FOLLOW-UP-DATE     PIC  X(02).
  1305         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  1306         16  LA-NO-OF-COPIES         PIC S9(01).
  1307         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  1308         16  LA-REPLY-DATE           PIC  X(02).
  1309         16  LA-RESEND-DATES.
  1310             20  LA-RESEND-DATE      PIC  X(02).
  1311             20  LA-SENT-DATE        PIC  X(02).
  1312             20  FILLER              PIC  X(08).
  1313         16  LA-SOURCE-INFORMATION.
  1314             20  LA-DATA-SOURCE      PIC  X(01).
  1315             20  LA-ADDR-SOURCE      PIC  X(01).
  1316         16  LA-STATUS               PIC  X(01).
  1317             88  LA-STATUS-ACTIVE         VALUE 'A'.
  1318             88  LA-STATUS-COMPLETED      VALUE 'C'.
  1319             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  1320             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  1321             88  LA-STATUS-PURGED         VALUE 'P'.
  1322             88  LA-STATUS-VOIDED         VALUE 'V'.
  1323         16  LA-LAST-RESENT-PRINT-DATE
  1324                                     PIC  X(02).
  1325         16  LA-PRINT-RESTRICTION    PIC  X(01).
  1326             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  1327                                          VALUE 'C'.
  1328             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  1329                                          VALUE 'F'.
  1330             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  1331                                          VALUE 'P'.
  1332         16  LA-PURGED-DATE          PIC  X(02).
  1333         16  LA-VOIDED-DATE          PIC  X(02).
  1334         16  LA-RESEND-LETR          PIC  X(4).
  1335         16  LA-VOID-ONBASE-YN       PIC  X.
  1336         16  LA-ONBASE-UNIQUE-ID     PIC S9(5) COMP-3.
  1337         16  FILLER                  PIC  X(04).
  1338*        16  LA-RESEND-LETR-2        PIC  X(4).
  1339*        16  LA-RESEND-LETR-3        PIC  X(4).
  1340*        16  FILLER                  PIC  X(59).
  1341         16  LA-ARCHIVE-STATUS       PIC  X.
  1342             88  LA-TEMP                VALUE 'T'.
  1343             88  LA-QWS                 VALUE 'Q'.
  1344             88  LA-BATCH               VALUE 'B'.
  1345         16  LA-FINAL-ACT-IND        PIC  X(1).
  1346         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  1347         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  25
* EL055.cbl
  1348         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  1349                                     PIC X(4).
  1350         16  FILLER                  PIC  X(42).
  1351*        16  FILLER                  PIC  X(71).
  1352         16  LA-LAST-MAINT-DATE      PIC  X(2).
  1353         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  1354         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  1355                                     PIC  X(4).
  1356         16  LA-LAST-UPDATED-BY      PIC  X(4).
  1357
  1358******************************************************************
  1359*                                copy NSCASEXTR.
  1360******************************************************************
  1361*                                                                *
  1362*                                                                *
  1363*                            NSCASEXTR.                          *
  1364*                            VMOD=2.001                          *
  1365*                                                                *
  1366*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
  1367*                                                                *
  1368*   FILE TYPE = VSAM,KSDS                                        *
  1369*   RECORD SIZE = 4500 RECFORM = FIXED                           *
  1370*                                                                *
  1371*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
  1372*                                                                *
  1373*   LOG = NO                                                     *
  1374*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1375******************************************************************
  1376*-----------------------------------------------------------------
  1377*                   C H A N G E   L O G
  1378*
  1379* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1380*-----------------------------------------------------------------
  1381*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1382* EFFECTIVE    NUMBER
  1383*-----------------------------------------------------------------
  1384* 072211    2011022800001  PEMA  NEW FILE
  1385*-----------------------------------------------------------------
  1386 01 NSAS-EXTRACT-RECORD.
  1387    05  NSAS-CONTROL-PRIMARY.
  1388        10  NSAS-COMPANY-CD      PIC X.
  1389        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
  1390        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
  1391    05  NSAS-LETTER-VARIABLES    PIC X(4350).
  1392    05  FILLER                   PIC X(143).
  1393*                                copy ERCCHEK.
  1394******************************************************************
  1395*                                                                *
  1396*                                                                *
  1397*                            ERCCHEK                             *
  1398*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1399*                            VMOD=2.008                          *
  1400*                                                                *
  1401*   FILE DESCRIPTION = CHECK RECORDS                             *
  1402*                                                                *
  1403*   FILE TYPE = VSAM,KSDS                                        *
  1404*   RECORD SIZE = 600    RECFORM = FIXED                         *
  1405*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  26
* EL055.cbl
  1406*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  1407*       ALTERNATE INDEX = NONE                                   *
  1408*                                                                *
  1409*   LOG = YES                                                    *
  1410*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1411******************************************************************
  1412*                   C H A N G E   L O G
  1413*
  1414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1415*-----------------------------------------------------------------
  1416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1417* EFFECTIVE    NUMBER
  1418*-----------------------------------------------------------------
  1419* 021414    2003053000001  PEMA  changes for auto chk request
  1420******************************************************************
  1421 01  CHECK-RECORDS.
  1422     12  CH-RECORD-ID                      PIC XX.
  1423         88  VALID-CH-ID                      VALUE 'CH'.
  1424
  1425     12  CH-CONTROL-PRIMARY.
  1426         16  CH-COMPANY-CD                 PIC X.
  1427         16  CH-CARRIER                    PIC X.
  1428         16  CH-GROUPING                   PIC X(6).
  1429         16  CH-STATE                      PIC XX.
  1430         16  CH-ACCOUNT                    PIC X(10).
  1431         16  CH-CERT-EFF-DT                PIC XX.
  1432         16  CH-CERT-NO.
  1433             20  CH-CERT-PRIME             PIC X(10).
  1434             20  CH-CERT-SFX               PIC X.
  1435         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  1436
  1437     12  CH-RECORDED-DT                    PIC XX.
  1438     12  CH-RECORDED-BY                    PIC X(4).
  1439     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  1440
  1441     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  1442     12  CH-CHECK-NO                       PIC X(7).
  1443     12  CH-REASON-FOR-CHECK               PIC X(25).
  1444     12  CH-CHECK-WRITTEN-DT               PIC XX.
  1445     12  FILLER                            PIC X.
  1446
  1447     12  CH-PAYEE-INFO.
  1448         16  CH-PAYEE-NAME-1               PIC X(30).
  1449         16  CH-PAYEE-NAME-2               PIC X(30).
  1450         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  1451         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  1452         16  CH-PAYEE-CITY-ST.
  1453             20  CH-PAYEE-CITY             PIC X(28).
  1454             20  CH-PAYEE-STATE            PIC XX.
  1455         16  CH-PAYEE-ZIP-CODE.
  1456             20  CH-PAYEE-ZIP.
  1457                 24  CH-ZIP-PRI-1ST        PIC X.
  1458                     88  CH-CANADIAN-POST-CODE
  1459                                           VALUES 'A' THRU 'Z'.
  1460                 24  FILLER                PIC X(4).
  1461             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  1462         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  1463             20  CH-CAN-POSTAL-1           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  27
* EL055.cbl
  1464             20  CH-CAN-POSTAL-2           PIC XXX.
  1465             20  FILLER                    PIC XXX.
  1466
  1467     12  CH-CHECK-STUB-TEXT.
  1468         16  CH-STUB-LINE-1                PIC X(30).
  1469         16  CH-TEXT-LINE-1                PIC X(50).
  1470         16  CH-TEXT-LINE-2                PIC X(50).
  1471         16  CH-TEXT-LINE-3                PIC X(40).
  1472     12  CH-RETURN-TO                      PIC X(30).
  1473
  1474     12  CH-COMPENSATION-CONTROL.
  1475         16  CH-COMP-CARRIER               PIC X.
  1476         16  CH-COMP-GROUPING              PIC X(6).
  1477         16  CH-COMP-FIN-RESP              PIC X(10).
  1478         16  CH-COMP-ACCOUNT               PIC X(10).
  1479
  1480     12  CH-CREDIT-SELECT-DT               PIC XX.
  1481     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  1482     12  CH-PAYEE-CODE                     PIC X(6).
  1483
  1484     12  CH-VOID-DATA.
  1485         20  CH-VOID-DT                    PIC XX.
  1486         20  CH-VOID-BY                    PIC X(4).
  1487         20  CH-VOID-REASON                PIC X(25).
  1488
  1489     12  CH-APPROVAL-DATA.
  1490         20  CH-APPROVAL-DT                PIC XX.
  1491         20  CH-APPROVAL-STATUS            PIC X.
  1492             88  CH-IN-LIMBO                  VALUE ' '.
  1493             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  1494             88  CH-APPROVED                  VALUE 'A'.
  1495             88  CH-DENIED                    VALUE 'D'.
  1496         20  CH-APPROVED-BY                PIC XXXX.
  1497     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  1498             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  1499     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  1500
  1501     12  ch-released-dt                    pic xx.
  1502     12  ch-check-cashed-dt                pic xx.
  1503     12  FILLER                            PIC X.
  1504*    12  CH-CHECK-REFERENCE                PIC X(12).
  1505     12  CH-CHECK-ORIGIN-SW                PIC X.
  1506             88  CH-REFUND-CHECK              VALUE 'R'.
  1507             88  CH-MAINT-CHECK               VALUE 'M'.
  1508
  1509     12  CH-CANC-DT                        PIC XX.
  1510     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  1511     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  1512
  1513     12  CH-INSURED-NAME                   PIC X(28).
  1514
  1515     12  ch-released-by                    pic x(4).
  1516     12  ch-csr                            pic x(4).
  1517     12  ch-deduct-commission              pic x.
  1518         88  ch-deduct-comm                  value 'Y'.
  1519         88  ch-do-not-deduct-comm           value 'N'.
  1520
  1521     12  FILLER                            PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  28
* EL055.cbl
  1522*    12  CH-LETTER-TABLE.
  1523*        16  CH-LETTERS OCCURS 3 TIMES
  1524*                       INDEXED BY CH-LT-NDX
  1525*                                          PIC X(04).
  1526
  1527     12  FILLER                            PIC X(07).
  1528
  1529*                                copy ERCCNOT.
  1530******************************************************************
  1531*                                                                *
  1532*                            ERCCNOT                             *
  1533*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1534*                            VMOD=2.003                          *
  1535*                                                                *
  1536*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  1537*                                                                *
  1538*        FILE TYPE= VSAM,KSDS                                    *
  1539*        RECORD SIZE = 150    RECFORM = FIXED                    *
  1540*                                                                *
  1541*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  1542*                                                                *
  1543*        LOG = YES                                               *
  1544*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1545*                                                                *
  1546******************************************************************
  1547*                   C H A N G E   L O G
  1548*
  1549* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1550*-----------------------------------------------------------------
  1551*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1552* EFFECTIVE    NUMBER
  1553*-----------------------------------------------------------------
  1554* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  1555******************************************************************
  1556
  1557 01  CERT-NOTE-FILE.
  1558     12  CZ-RECORD-ID                PIC  XX.
  1559         88  VALID-CZ-ID                  VALUE 'CZ'.
  1560
  1561     12  CZ-CONTROL-PRIMARY.
  1562         16  CZ-COMPANY-CD           PIC X.
  1563         16  CZ-CARRIER              PIC X.
  1564         16  CZ-GROUPING.
  1565             20 CZ-GROUPING-PREFIX   PIC XXX.
  1566             20 CZ-GROUPING-PRIME    PIC XXX.
  1567         16  CZ-STATE                PIC XX.
  1568         16  CZ-ACCOUNT.
  1569             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  1570             20 CZ-ACCOUNT-PRIME     PIC X(6).
  1571         16  CZ-CERT-EFF-DT          PIC XX.
  1572         16  CZ-CERT-NO.
  1573             20  CZ-CERT-PRIME       PIC X(10).
  1574             20  CZ-CERT-SFX         PIC X.
  1575         16  CZ-RECORD-TYPE          PIC X.
  1576             88  CERT-NOTE           VALUE '1'.
  1577             88  CLAIM-CERT-NOTE     VALUE '2'.
  1578         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  1579
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  29
* EL055.cbl
  1580     12  CZ-LAST-MAINT-DT            PIC XX.
  1581     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1582     12  CZ-LAST-MAINT-USER          PIC X(4).
  1583
  1584     12  CZ-NOTE-INFORMATION.
  1585         16  CZ-NOTE                 PIC X(63).
  1586         16  FILLER                  PIC X(39).
  1587******************************************************************
  1588*                                copy ERCNOTE.
  1589******************************************************************
  1590*                                                                *
  1591*                                                                *
  1592*                            ERCNOTE                             *
  1593*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1594*                            VMOD=2.003                          *
  1595*                                                                *
  1596*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  1597*                                                                *
  1598*        FILE TYPE= VSAM,KSDS                                    *
  1599*        RECORD SIZE = 825    RECFORM = FIXED                    *
  1600*                                                                *
  1601*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  1602*                                                                *
  1603*        LOG = YES                                               *
  1604*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1605*                                                                *
  1606******************************************************************
  1607*                   C H A N G E   L O G
  1608*
  1609* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1610*-----------------------------------------------------------------
  1611*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1612* EFFECTIVE    NUMBER
  1613*-----------------------------------------------------------------
  1614* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  1615*                                FILE WILL CONTAIN BILLING NOTES O
  1616******************************************************************
  1617
  1618 01  CERTIFICATE-NOTE.
  1619     12  CN-RECORD-ID                PIC  XX.
  1620         88  VALID-CN-ID                  VALUE 'CN'.
  1621
  1622     12  CN-CONTROL-PRIMARY.
  1623         16  CN-COMPANY-CD           PIC X.
  1624         16  CN-CARRIER              PIC X.
  1625         16  CN-GROUPING.
  1626             20 CN-GROUPING-PREFIX   PIC XXX.
  1627             20 CN-GROUPING-PRIME    PIC XXX.
  1628         16  CN-STATE                PIC XX.
  1629         16  CN-ACCOUNT.
  1630             20 CN-ACCOUNT-PREFIX    PIC X(4).
  1631             20 CN-ACCOUNT-PRIME     PIC X(6).
  1632         16  CN-CERT-EFF-DT          PIC XX.
  1633         16  CN-CERT-NO.
  1634             20  CN-CERT-PRIME       PIC X(10).
  1635             20  CN-CERT-SFX         PIC X.
  1636
  1637     12  CN-BILLING-START-LINE-NO    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  30
* EL055.cbl
  1638     12  CN-BILLING-END-LINE-NO      PIC 99.
  1639
  1640     12  CN-LINES.
  1641         16  CN-LINE OCCURS 10       PIC X(77).
  1642
  1643     12  CN-LAST-MAINT-DT            PIC XX.
  1644     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1645     12  CN-LAST-MAINT-USER          PIC X(4).
  1646     12  FILLER                      PIC X(6).
  1647******************************************************************
  1648*                                copy ERCMAIL.
  1649******************************************************************
  1650*                                                                *
  1651*                                                                *
  1652*                            ERCMAIL                             *
  1653*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1654*                            VMOD=2.003                          *
  1655*                                                                *
  1656*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  1657*                                                                *
  1658*   FILE TYPE = VSAM,KSDS                                        *
  1659*   RECORD SIZE = 374   RECFORM = FIX                            *
  1660*                                                                *
  1661*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  1662*   ALTERNATE PATH    = NOT USED                                 *
  1663*                                                                *
  1664*   LOG = YES                                                    *
  1665*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1666******************************************************************
  1667*                   C H A N G E   L O G
  1668*
  1669* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1670*-----------------------------------------------------------------
  1671*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1672* EFFECTIVE    NUMBER
  1673*-----------------------------------------------------------------
  1674* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  1675* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1676* 111108                   PEMA  ADD CRED BENE ADDR2
  1677******************************************************************
  1678
  1679 01  MAILING-DATA.
  1680     12  MA-RECORD-ID                      PIC XX.
  1681         88  VALID-MA-ID                       VALUE 'MA'.
  1682
  1683     12  MA-CONTROL-PRIMARY.
  1684         16  MA-COMPANY-CD                 PIC X.
  1685         16  MA-CARRIER                    PIC X.
  1686         16  MA-GROUPING.
  1687             20  MA-GROUPING-PREFIX        PIC XXX.
  1688             20  MA-GROUPING-PRIME         PIC XXX.
  1689         16  MA-STATE                      PIC XX.
  1690         16  MA-ACCOUNT.
  1691             20  MA-ACCOUNT-PREFIX         PIC X(4).
  1692             20  MA-ACCOUNT-PRIME          PIC X(6).
  1693         16  MA-CERT-EFF-DT                PIC XX.
  1694         16  MA-CERT-NO.
  1695             20  MA-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  31
* EL055.cbl
  1696             20  MA-CERT-SFX               PIC X.
  1697
  1698     12  FILLER                            PIC XX.
  1699
  1700     12  MA-ACCESS-CONTROL.
  1701         16  MA-SOURCE-SYSTEM              PIC XX.
  1702             88  MA-FROM-CREDIT                VALUE 'CR'.
  1703             88  MA-FROM-VSI                   VALUE 'VS'.
  1704             88  MA-FROM-WARRANTY              VALUE 'WA'.
  1705             88  MA-FROM-OTHER                 VALUE 'OT'.
  1706         16  MA-RECORD-ADD-DT              PIC XX.
  1707         16  MA-RECORD-ADDED-BY            PIC XXXX.
  1708         16  MA-LAST-MAINT-DT              PIC XX.
  1709         16  MA-LAST-MAINT-BY              PIC XXXX.
  1710         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  1711
  1712     12  MA-PROFILE-INFO.
  1713         16  MA-QUALIFY-CODE-1             PIC XX.
  1714         16  MA-QUALIFY-CODE-2             PIC XX.
  1715         16  MA-QUALIFY-CODE-3             PIC XX.
  1716         16  MA-QUALIFY-CODE-4             PIC XX.
  1717         16  MA-QUALIFY-CODE-5             PIC XX.
  1718
  1719         16  MA-INSURED-LAST-NAME          PIC X(15).
  1720         16  MA-INSURED-FIRST-NAME         PIC X(10).
  1721         16  MA-INSURED-MIDDLE-INIT        PIC X.
  1722         16  MA-INSURED-ISSUE-AGE          PIC 99.
  1723         16  MA-INSURED-BIRTH-DT           PIC XX.
  1724         16  MA-INSURED-SEX                PIC X.
  1725             88  MA-SEX-MALE                   VALUE 'M'.
  1726             88  MA-SEX-FEMALE                 VALUE 'F'.
  1727         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  1728
  1729         16  MA-ADDRESS-CORRECTED          PIC X.
  1730         16  MA-JOINT-BIRTH-DT             PIC XX.
  1731*        16  FILLER                        PIC X(12).
  1732
  1733         16  MA-ADDRESS-LINE-1             PIC X(30).
  1734         16  MA-ADDRESS-LINE-2             PIC X(30).
  1735         16  MA-CITY-STATE.
  1736             20  MA-CITY                   PIC X(28).
  1737             20  MA-ADDR-STATE             PIC XX.
  1738         16  MA-ZIP.
  1739             20  MA-ZIP-CODE.
  1740                 24  MA-ZIP-CODE-1ST       PIC X(1).
  1741                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1742                 24  FILLER                PIC X(4).
  1743             20  MA-ZIP-PLUS4              PIC X(4).
  1744         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  1745             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  1746             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  1747             20  FILLER                    PIC X(3).
  1748
  1749         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  1750
  1751         16  FILLER                        PIC XXX.
  1752*        16  FILLER                        PIC X(10).
  1753
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  32
* EL055.cbl
  1754     12  MA-CRED-BENE-INFO.
  1755         16  MA-CRED-BENE-NAME                 PIC X(25).
  1756         16  MA-CRED-BENE-ADDR                 PIC X(30).
  1757         16  MA-CRED-BENE-ADDR2                PIC X(30).
  1758         16  MA-CRED-BENE-CTYST.
  1759             20  MA-CRED-BENE-CITY             PIC X(28).
  1760             20  MA-CRED-BENE-STATE            PIC XX.
  1761         16  MA-CRED-BENE-ZIP.
  1762             20  MA-CB-ZIP-CODE.
  1763                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  1764                     88  MA-CB-CANADIAN-POST-CODE
  1765                                           VALUE 'A' THRU 'Z'.
  1766                 24  FILLER                    PIC X(4).
  1767             20  MA-CB-ZIP-PLUS4               PIC X(4).
  1768         16  MA-CB-CANADIAN-POSTAL-CODE
  1769                            REDEFINES MA-CRED-BENE-ZIP.
  1770             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  1771             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  1772             20  FILLER                        PIC X(3).
  1773     12  MA-POST-CARD-MAIL-DATA.
  1774         16  MA-MAIL-DATA OCCURS 7.
  1775             20  MA-MAIL-TYPE              PIC X.
  1776                 88  MA-12MO-MAILING           VALUE '1'.
  1777                 88  MA-EXP-MAILING            VALUE '2'.
  1778             20  MA-MAIL-STATUS            PIC X.
  1779                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  1780                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  1781                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  1782             20  MA-MAIL-DATE              PIC XX.
  1783     12  FILLER                            PIC XX.
  1784     12  FILLER                            PIC XX.
  1785*    12  FILLER                            PIC X(30).
  1786******************************************************************
  1787*                                copy ERCENDR.
  1788******************************************************************
  1789*                                                                *
  1790*                                                                *
  1791*                            ERCENDR.                            *
  1792*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1793*                            VMOD=2.001                          *
  1794*                                                                *
  1795*   FILE DESCRIPTION = ENDORSEMENT SUMMARY BY ACCOUNT            *
  1796*                                                                *
  1797*                                                                *
  1798*                                                                *
  1799*   FILE TYPE = VSAM,KSDS                                        *
  1800*   RECORD SIZE = 513  RECFORM = FIXED                           *
  1801*                                                                *
  1802*   BASE CLUSTER = ERENDR                         RKP=2,LEN=36   *
  1803*                                                                *
  1804*   LOG = NO                                                     *
  1805*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1806******************************************************************
  1807*-----------------------------------------------------------------
  1808*                   C H A N G E   L O G
  1809*
  1810* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1811*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  33
* EL055.cbl
  1812*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1813* EFFECTIVE    NUMBER
  1814*-----------------------------------------------------------------
  1815* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1816*                                WITH OPEN CLAIMS
  1817*-----------------------------------------------------------------
  1818 01  ENDORSEMENT-RECORD.
  1819     12  EN-RECORD-ID            PIC XX.
  1820         88  VALID-EN-ID             VALUE 'EN'.
  1821     12  EN-CONTROL-PRIMARY.
  1822         16  EN-COMPANY-CD       PIC X.
  1823         16  EN-CARRIER          PIC X.
  1824         16  EN-GROUPING         PIC X(6).
  1825         16  EN-STATE            PIC XX.
  1826         16  EN-ACCOUNT          PIC X(10).
  1827         16  EN-CERT-EFF-DT      PIC XX.
  1828         16  EN-CERT-NO.
  1829             20  EN-CERT-PRIME   PIC X(10).
  1830             20  EN-CERT-SFX     PIC X.
  1831         16  EN-SEQ-NO           PIC S9(04) COMP.
  1832         16  EN-REC-TYPE         PIC X.
  1833             88  EN-ISSUE             VALUE '1'.
  1834             88  EN-CANCELLATION      VALUE '2'.
  1835     12  EN-LAST-MAINT-DT        PIC XX.
  1836     12  EN-LAST-MAINT-BY        PIC X(4).
  1837     12  EN-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  1838     12  EN-LAST-NAME            PIC X(15).
  1839     12  EN-FIRST-NAME           PIC X(10).
  1840     12  EN-MIDDLE-INIT          PIC X.
  1841     12  EN-JOINT-LAST-NAME      PIC X(15).
  1842     12  EN-JOINT-FIRST-NAME     PIC X(10).
  1843     12  EN-JOINT-MIDDLE-INIT    PIC X.
  1844     12  EN-LF-TERM              PIC S999      COMP-3.
  1845     12  EN-AH-TERM              PIC S999      COMP-3.
  1846     12  EN-LF-BEN-ENT-AMT       PIC S9(9)V99  COMP-3.
  1847     12  EN-AH-BEN-ENT-AMT       PIC S9(7)V99  COMP-3.
  1848     12  EN-LF-BEN-CAL-AMT       PIC S9(9)V99  COMP-3.
  1849     12  EN-AH-BEN-CAL-AMT       PIC S9(7)V99  COMP-3.
  1850     12  EN-LF-PREM-ENT-AMT      PIC S9(7)V99  COMP-3.
  1851     12  EN-AH-PREM-ENT-AMT      PIC S9(7)V99  COMP-3.
  1852     12  EN-LF-CANC-ENT-AMT      PIC S9(7)V99  COMP-3.
  1853     12  EN-AH-CANC-ENT-AMT      PIC S9(7)V99  COMP-3.
  1854     12  EN-LF-PREM-CAL-AMT      PIC S9(7)V99  COMP-3.
  1855     12  EN-AH-PREM-CAL-AMT      PIC S9(7)V99  COMP-3.
  1856     12  EN-LF-CANC-CAL-AMT      PIC S9(7)V99  COMP-3.
  1857     12  EN-AH-CANC-CAL-AMT      PIC S9(7)V99  COMP-3.
  1858     12  EN-LF-CANC-DT           PIC XX.
  1859     12  EN-AH-CANC-DT           PIC XX.
  1860     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  1861     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  1862     12  EN-LF-BEN-CD            PIC XX.
  1863     12  EN-AH-BEN-CD            PIC XX.
  1864*           12  FILLER                  PIC X(18).
  1865     12  FILLER                  PIC X(17).
  1866     12  EN-FLAG-CERT            PIC X.
  1867     12  EN-INPUT-DT             PIC XX.
  1868     12  EN-PRINT-DT             PIC XX.
  1869     12  EN-SIG-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  34
* EL055.cbl
  1870     12  EN-COMMENTS1            PIC X(70).
  1871     12  EN-COMMENTS2            PIC X(70).
  1872     12  EN-COMMENTS3            PIC X(70).
  1873     12  EN-COMMENTS4            PIC X(70).
  1874     12  FILLER                  PIC X(30).
  1875******************************************************************
  1876*                                copy ERCENDT replacing
  1877*          ENDORSEMENT-RECORD by ENDT-RECORD
  1878*          LEADING ==EN-== BY ==ET-==.
  1879******************************************************************
  1880*                                                                *
  1881*                                                                *
  1882*                            ERCENDT.                            *
  1883*                            VMOD=2.001                          *
  1884*                                                                *
  1885*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  1886*                                                                *
  1887*   FILE TYPE = VSAM,KSDS                                        *
  1888*   RECORD SIZE = 579  RECFORM = FIXED                           *
  1889*                                                                *
  1890*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  1891*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  1892*                                                                *
  1893*   LOG = NO                                                     *
  1894*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1895******************************************************************
  1896*-----------------------------------------------------------------
  1897*                   C H A N G E   L O G
  1898*
  1899* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1900*-----------------------------------------------------------------
  1901*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1902* EFFECTIVE    NUMBER
  1903*-----------------------------------------------------------------
  1904* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1905*                                WITH OPEN CLAIMS
  1906* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  1907* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1908* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1909* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  1910*-----------------------------------------------------------------
  1911 01  ENDT-RECORD.
  1912     12  ET-RECORD-ID                PIC XX.
  1913         88  VALID-EN-ID                VALUE 'EN'.
  1914     12  ET-CONTROL-PRIMARY.
  1915         16  ET-COMPANY-CD           PIC X.
  1916         16  ET-CARRIER              PIC X.
  1917         16  ET-GROUPING             PIC X(6).
  1918         16  ET-STATE                PIC XX.
  1919         16  ET-ACCOUNT              PIC X(10).
  1920         16  ET-CERT-EFF-DT          PIC XX.
  1921         16  ET-CERT-NO.
  1922             20  ET-CERT-PRIME       PIC X(10).
  1923             20  ET-CERT-SFX         PIC X.
  1924         16  ET-REC-TYPE             PIC X.
  1925             88  ET-ISSUE               VALUE 'I'.
  1926             88  ET-CANCELLATION        VALUE 'C'.
  1927         16  ET-SEQ-NO               PIC 9(04) BINARY.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  35
* EL055.cbl
  1928     12  ET-CONTROL-BY-ARCH-NO.
  1929         16  ET-COMPANY-CD-A1              PIC X.
  1930         16  ET-ARCHIVE-NO                 PIC 9(8) BINARY.
  1931     12  ET-LAST-MAINT-DT            PIC XX.
  1932     12  ET-LAST-MAINT-BY            PIC X(4).
  1933     12  ET-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  1934     12  ET-ENDORSEMENT-RECORD       PIC X(329).
  1935     12  ET-ISSUE-RECORD REDEFINES ET-ENDORSEMENT-RECORD.
  1936         16  ET-INS-ORIG-LAST-NAME   PIC X(15).
  1937         16  ET-INS-ORIG-FIRST-NAME  PIC X(10).
  1938         16  ET-INS-ORIG-MIDDLE-INIT PIC X.
  1939         16  ET-INS-ORIG-AGE         PIC S999     COMP-3.
  1940         16  ET-JNT-ORIG-LAST-NAME   PIC X(15).
  1941         16  ET-JNT-ORIG-FIRST-NAME  PIC X(10).
  1942         16  ET-JNT-ORIG-MIDDLE-INIT PIC X.
  1943         16  ET-JNT-ORIG-AGE         PIC S999     COMP-3.
  1944         16  ET-LF-ORIG-BENCD        PIC XX.
  1945         16  ET-LF-ORIG-TERM         PIC S999      COMP-3.
  1946         16  ET-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1947         16  ET-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1948         16  ET-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  1949         16  ET-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  1950         16  ET-LF-ORIG-EXP-DT       PIC XX.
  1951*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  1952         16  ET-ORIG-CRED-BENE       PIC X(25).
  1953         16  ET-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1954         16  FILLER                  PIC X.
  1955         16  ET-AH-ORIG-BENCD        PIC XX.
  1956         16  ET-AH-ORIG-TERM         PIC S999      COMP-3.
  1957         16  ET-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1958         16  ET-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1959         16  ET-AH-ORIG-EXP-DT       PIC XX.
  1960*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  1961*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  1962         16  ET-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1963         16  F                       PIC X(09).
  1964         16  ET-AH-ORIG-CP           PIC 99.
  1965         16  ET-INS-NEW-LAST-NAME    PIC X(15).
  1966         16  ET-INS-NEW-FIRST-NAME   PIC X(10).
  1967         16  ET-INS-NEW-MIDDLE-INIT  PIC X.
  1968         16  ET-INS-NEW-AGE          PIC S999     COMP-3.
  1969         16  ET-JNT-NEW-LAST-NAME    PIC X(15).
  1970         16  ET-JNT-NEW-FIRST-NAME   PIC X(10).
  1971         16  ET-JNT-NEW-MIDDLE-INIT  PIC X.
  1972         16  ET-JNT-NEW-AGE          PIC S999     COMP-3.
  1973         16  ET-LF-NEW-BENCD         PIC XX.
  1974         16  ET-LF-NEW-TERM          PIC S999      COMP-3.
  1975         16  ET-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1976         16  ET-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1977         16  ET-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  1978         16  ET-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  1979         16  ET-LF-NEW-EXP-DT        PIC XX.
  1980         16  ET-NEW-CRED-BENE        PIC X(25).
  1981         16  ET-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1982         16  FILLER                  PIC X.
  1983         16  ET-AH-NEW-BENCD         PIC XX.
  1984         16  ET-AH-NEW-TERM          PIC S999      COMP-3.
  1985         16  ET-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  36
* EL055.cbl
  1986         16  ET-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1987         16  ET-AH-NEW-EXP-DT        PIC XX.
  1988*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  1989*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  1990*        16  F                       PIC X(12).
  1991         16  ET-AH-NEW-CP            PIC 99.
  1992         16  ET-SIG-SW               PIC X.
  1993         16  ET-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1994         16  ET-INS-ORIG-AGE-DEF-FLAG PIC X.
  1995         16  ET-JNT-ORIG-AGE-DEF-FLAG PIC X.
  1996         16  ET-INS-NEW-AGE-DEF-FLAG PIC X.
  1997         16  ET-JNT-NEW-AGE-DEF-FLAG PIC X.
  1998         16  FILLER                  PIC X(33).
  1999     12  ET-CANCEL-RECORD REDEFINES ET-ENDORSEMENT-RECORD.
  2000         16  ET-LF-ORIG-REF-DT       PIC XX.
  2001         16  ET-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  2002         16  ET-AH-ORIG-REF-DT       PIC XX.
  2003         16  ET-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  2004         16  ET-LF-NEW-REF-DT        PIC XX.
  2005         16  ET-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  2006         16  ET-AH-NEW-REF-DT        PIC XX.
  2007         16  ET-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  2008         16  ET-FLAG-CERT            PIC X.
  2009         16  ET-INS-LAST-NAME        PIC X(15).
  2010         16  ET-INS-FIRST-NAME       PIC X(10).
  2011         16  ET-INS-MIDDLE-INIT      PIC X.
  2012         16  ET-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  2013         16  ET-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  2014         16  ET-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  2015         16  ET-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  2016         16  FILLER                  PIC X(262).
  2017     12  ET-MONEY-SW             PIC X.
  2018     12  ET-HEALTH-APP           PIC X.
  2019     12  ET-VOUCHER-SW           PIC X.
  2020     12  ET-PAYEE                PIC X(14).
  2021     12  ET-INPUT-DT             PIC XX.
  2022     12  ET-PROCESS-DT           PIC XX.
  2023     12  ET-LF-COMMISSION        PIC SV9(5)    COMP-3.
  2024     12  ET-AH-COMMISSION        PIC SV9(5)    COMP-3.
  2025     12  ET-REASON-CODES.
  2026         16  F OCCURS 12.
  2027             20  ET-REASON-CODE  PIC X(4).
  2028     12  ET-TEMPLATE-USED        PIC X(8).
  2029     12  ET-DOCU-TYPE            PIC X.
  2030         88  ET-VERI-DOCU          VALUE 'V'.
  2031         88  ET-GCE-DOCU           VALUE 'G'.
  2032         88  ET-CANC-DOCU          VALUE 'C'.
  2033     12  ET-COMMENTS1            PIC X(13).
  2034     12  ET-COMMENTS2            PIC X(70).
  2035     12  ET-COMM-CHGBK           PIC X.
  2036         88  ET-DO-NOT-CHG-ACCT    VALUE 'N'.
  2037         88  ET-CHG-ACCT           VALUE 'Y'.
  2038     12  ET-CSO-PORTION          PIC S9(5)V99  COMP-3.
  2039     12  ET-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  2040     12  ET-BATCH-NUMBER         PIC X(6).
  2041     12  ET-ACCT-SUMM            PIC X.
  2042     12  ET-CSO-SUMM             PIC X.
  2043     12  en-check-type           pic x.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  37
* EL055.cbl
  2044     12  FILLER                  PIC X(12).
  2045******************************************************************
  2046 01  ws-dummy-area               pic x(1000).
  2047 01  ws-misc.
  2048     05  ws-old-pndb-key.
  2049         10  opk-company-cd      pic x.
  2050         10  opk-carrier         pic x.
  2051         10  opk-group           pic x(6).
  2052         10  opk-state           pic xx.
  2053         10  opk-account         pic x(10).
  2054         10  opk-eff-dt          pic xx.
  2055         10  opk-cert-no         pic x(11).
  2056         10  opk-seq-no          pic xx.
  2057         10  opk-rec-type        pic x.
  2058 01  ws-disp-code                pic s9(11).
  2059 01  WS-RESPONSE2                PIC S9(8) COMP VALUE +0.
  2060 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
  2061     88  RESP-NORMAL                    VALUE +0.
  2062     88  resp-file-notfnd               value +12.
  2063     88  RESP-NOTFND                    VALUE +13.
  2064     88  resp-duprec                    value +14.
  2065     88  resp-dupkey                    value +15.
  2066     88  resp-invreq                    value +16.
  2067     88  RESP-NOTOPEN                   VALUE +19.
  2068     88  RESP-ENDFILE                   VALUE +20.
  2069     88  resp-lengtherr                 value +22.
  2070 01  erpndb-ridfld               pic x(11).
  2071 01  erpndb2-ridfld              pic x(36).
  2072 01  elcert-ridfld               pic x(33).
  2073 01  elcrto-ridfld.
  2074     05  filler                  pic x(33).
  2075     05  elcrto-rec-type         pic x.
  2076     05  elcrto-seq-no           pic s9(4) comp.
  2077 01  nsasextr-ridfld.
  2078     05  filler                  pic x(5).
  2079     05  nsasextr-seq-no         pic s9(4) comp.
  2080 01  elcrtt-ridfld.
  2081     05  filler                  pic x(33).
  2082     05  elcrtt-rec-type         pic x.
  2083 01  erarch-ridfld               pic x(5).
  2084 01  erarch2-ridfld.  *>  pic x(37).
  2085     05  erarch2-company-cd      pic x.
  2086     05  erarch2-cert-no         pic x(11).
  2087     05  erarch2-carrier         pic x.
  2088     05  erarch2-group           pic x(6).
  2089     05  erarch2-state           pic xx.
  2090     05  erarch2-account         pic x(10).
  2091     05  erarch2-eff-dt          pic xx.
  2092     05  erarch2-arch-no         pic s9(8) comp.
  2093 01  erchek-ridfld.
  2094     05  filler                  pic x(33).
  2095     05  erchek-seq-no           pic s9(4) comp.
  2096 01  ercnot-ridfld.
  2097     05  filler                  pic x(33).
  2098     05  ercnot-rec-type         pic x.
  2099     05  ercnot-seq-no           pic s9(4) comp.
  2100 01  ernote-ridfld               pic x(33).
  2101 01  ermail-ridfld               pic x(33).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  38
* EL055.cbl
  2102 01  erendr-ridfld.
  2103     05  filler                  pic x(33).
  2104     05  erendr-seq-no           pic s9(4) comp.
  2105     05  erendr-rec-type         pic x.
  2106 01  erendt-ridfld.
  2107     05  filler                  pic x(33).
  2108     05  erendt-rec-type         pic x.
  2109     05  erendt-seq-no           pic s9(4) comp.
  2110 01  msg-error.
  2111     05  filler                  pic x(08) value ' error- '.
  2112     05  me-response             pic 9(5)  value zeros.
  2113     05  filler                  pic xx value spaces.
  2114     05  me-response2            pic 9(5)  value zeros.
  2115     05  filler                  pic x(5)  value spaces.
  2116     05  me-command              pic x(20) value spaces.
  2117 01  WS-PASS-AREA.
  2118     05  PA-ERPNDB-KEY           PIC X(11).
  2119     05  pa-new-pndb-key.
  2120         10  filler              pic x(20).
  2121         10  pa-new-eff-dt       pic xx.
  2122         10  pa-new-cert-no      pic x(11).
  2123         10  filler              pic xxx.
  2124     05  pa-return-area.
  2125         10  ra-status-code      pic 9(4).
  2126         10  ra-message          pic x(205).
  2127*                                COPY ELCDATE.
  2128******************************************************************
  2129*                                                                *
  2130*                                                                *
  2131*                            ELCDATE.                            *
  2132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2133*                            VMOD=2.003
  2134*                                                                *
  2135*                                                                *
  2136*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2137*                 LENGTH = 200                                   *
  2138******************************************************************
  2139
  2140 01  DATE-CONVERSION-DATA.
  2141     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2142     12  DC-OPTION-CODE                PIC X.
  2143         88  BIN-TO-GREG                VALUE ' '.
  2144         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2145         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2146         88  YMD-GREG-TO-BIN            VALUE '3'.
  2147         88  MDY-GREG-TO-BIN            VALUE '4'.
  2148         88  JULIAN-TO-BIN              VALUE '5'.
  2149         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2150         88  FIND-CENTURY               VALUE '7'.
  2151         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2152         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2153         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2154         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2155         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2156         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2157         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2158         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2159         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  39
* EL055.cbl
  2160         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2161         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2162         88  BIN-3-TO-GREG              VALUE 'I'.
  2163         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2164         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2165         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2166         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2167         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2168         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2169         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2170         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2171         88  THREE-CHARACTER-BIN
  2172                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2173         88  GREGORIAN-TO-BIN
  2174                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2175         88  BIN-TO-GREGORIAN
  2176                  VALUES ' ' '1' 'I' '8' 'G'.
  2177         88  JULIAN-TO-BINARY
  2178                  VALUES '5' 'C' 'E' 'F'.
  2179     12  DC-ERROR-CODE                 PIC X.
  2180         88  NO-CONVERSION-ERROR        VALUE ' '.
  2181         88  DATE-CONVERSION-ERROR
  2182                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2183         88  DATE-IS-ZERO               VALUE '1'.
  2184         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2185         88  DATE-IS-INVALID            VALUE '3'.
  2186         88  DATE1-GREATER-DATE2        VALUE '4'.
  2187         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2188         88  DATE-INVALID-OPTION        VALUE '9'.
  2189         88  INVALID-CENTURY            VALUE 'A'.
  2190         88  ONLY-CENTURY               VALUE 'B'.
  2191         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2192         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2193     12  DC-END-OF-MONTH               PIC X.
  2194         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2195     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2196         88  USE-NORMAL-PROCESS         VALUE ' '.
  2197         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2198         88  ADJUST-UP-100-YRS          VALUE '2'.
  2199     12  FILLER                        PIC X.
  2200     12  DC-CONVERSION-DATES.
  2201         16  DC-BIN-DATE-1             PIC XX.
  2202         16  DC-BIN-DATE-2             PIC XX.
  2203         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2204         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2205                       DC-GREG-DATE-1-EDIT.
  2206             20  DC-EDIT1-MONTH        PIC 99.
  2207             20  SLASH1-1              PIC X.
  2208             20  DC-EDIT1-DAY          PIC 99.
  2209             20  SLASH1-2              PIC X.
  2210             20  DC-EDIT1-YEAR         PIC 99.
  2211         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2212         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2213                     DC-GREG-DATE-2-EDIT.
  2214             20  DC-EDIT2-MONTH        PIC 99.
  2215             20  SLASH2-1              PIC X.
  2216             20  DC-EDIT2-DAY          PIC 99.
  2217             20  SLASH2-2              PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  40
* EL055.cbl
  2218             20  DC-EDIT2-YEAR         PIC 99.
  2219         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2220         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2221                     DC-GREG-DATE-1-YMD.
  2222             20  DC-YMD-YEAR           PIC 99.
  2223             20  DC-YMD-MONTH          PIC 99.
  2224             20  DC-YMD-DAY            PIC 99.
  2225         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2226         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2227                      DC-GREG-DATE-1-MDY.
  2228             20  DC-MDY-MONTH          PIC 99.
  2229             20  DC-MDY-DAY            PIC 99.
  2230             20  DC-MDY-YEAR           PIC 99.
  2231         16  DC-GREG-DATE-1-ALPHA.
  2232             20  DC-ALPHA-MONTH        PIC X(10).
  2233             20  DC-ALPHA-DAY          PIC 99.
  2234             20  FILLER                PIC XX.
  2235             20  DC-ALPHA-CENTURY.
  2236                 24 DC-ALPHA-CEN-N     PIC 99.
  2237             20  DC-ALPHA-YEAR         PIC 99.
  2238         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2239         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2240         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2241         16  DC-JULIAN-DATE            PIC 9(05).
  2242         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  2243                                       PIC 9(05).
  2244         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2245             20  DC-JULIAN-YEAR        PIC 99.
  2246             20  DC-JULIAN-DAYS        PIC 999.
  2247         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2248         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2249         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2250     12  DATE-CONVERSION-VARIBLES.
  2251         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2252         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2253             20  FILLER                PIC 9(3).
  2254             20  HOLD-CEN-1-CCYY.
  2255                 24  HOLD-CEN-1-CC     PIC 99.
  2256                 24  HOLD-CEN-1-YY     PIC 99.
  2257             20  HOLD-CEN-1-MO         PIC 99.
  2258             20  HOLD-CEN-1-DA         PIC 99.
  2259         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2260             20  HOLD-CEN-1-R-MO       PIC 99.
  2261             20  HOLD-CEN-1-R-DA       PIC 99.
  2262             20  HOLD-CEN-1-R-CCYY.
  2263                 24  HOLD-CEN-1-R-CC   PIC 99.
  2264                 24  HOLD-CEN-1-R-YY   PIC 99.
  2265             20  FILLER                PIC 9(3).
  2266         16  HOLD-CENTURY-1-X.
  2267             20  FILLER                PIC X(3)  VALUE SPACES.
  2268             20  HOLD-CEN-1-X-CCYY.
  2269                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2270                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2271             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2272             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2273         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2274             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2275             20  HOLD-CEN-1-R-X-DA     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  41
* EL055.cbl
  2276             20  HOLD-CEN-1-R-X-CCYY.
  2277                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2278                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2279             20  FILLER                PIC XXX.
  2280         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2281         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2282         16  DC-JULIAN-DATE-1          PIC 9(07).
  2283         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2284             20  DC-JULIAN-1-CCYY.
  2285                 24  DC-JULIAN-1-CC    PIC 99.
  2286                 24  DC-JULIAN-1-YR    PIC 99.
  2287             20  DC-JULIAN-DA-1        PIC 999.
  2288         16  DC-JULIAN-DATE-2          PIC 9(07).
  2289         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2290             20  DC-JULIAN-2-CCYY.
  2291                 24  DC-JULIAN-2-CC    PIC 99.
  2292                 24  DC-JULIAN-2-YR    PIC 99.
  2293             20  DC-JULIAN-DA-2        PIC 999.
  2294         16  DC-GREG-DATE-A-EDIT.
  2295             20  DC-EDITA-MONTH        PIC 99.
  2296             20  SLASHA-1              PIC X VALUE '/'.
  2297             20  DC-EDITA-DAY          PIC 99.
  2298             20  SLASHA-2              PIC X VALUE '/'.
  2299             20  DC-EDITA-CCYY.
  2300                 24  DC-EDITA-CENT     PIC 99.
  2301                 24  DC-EDITA-YEAR     PIC 99.
  2302         16  DC-GREG-DATE-B-EDIT.
  2303             20  DC-EDITB-MONTH        PIC 99.
  2304             20  SLASHB-1              PIC X VALUE '/'.
  2305             20  DC-EDITB-DAY          PIC 99.
  2306             20  SLASHB-2              PIC X VALUE '/'.
  2307             20  DC-EDITB-CCYY.
  2308                 24  DC-EDITB-CENT     PIC 99.
  2309                 24  DC-EDITB-YEAR     PIC 99.
  2310         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2311         16  DC-GREG-DATE-CYMD-R REDEFINES
  2312                              DC-GREG-DATE-CYMD.
  2313             20  DC-CYMD-CEN           PIC 99.
  2314             20  DC-CYMD-YEAR          PIC 99.
  2315             20  DC-CYMD-MONTH         PIC 99.
  2316             20  DC-CYMD-DAY           PIC 99.
  2317         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2318         16  DC-GREG-DATE-MDCY-R REDEFINES
  2319                              DC-GREG-DATE-MDCY.
  2320             20  DC-MDCY-MONTH         PIC 99.
  2321             20  DC-MDCY-DAY           PIC 99.
  2322             20  DC-MDCY-CEN           PIC 99.
  2323             20  DC-MDCY-YEAR          PIC 99.
  2324    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2325        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2326    12  DC-EL310-DATE                  PIC X(21).
  2327    12  FILLER                         PIC X(28).
  2328****************************************************************
  2329*
  2330* Copyright (c) 2007-2013 Dell Inc.
  2331* All rights reserved.
  2332*
  2333****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  42
* EL055.cbl
  2334 01  DFHEIV.
  2335   02  DFHEIV0               PIC X(35).
  2336   02  DFHEIV1               PIC X(08).
  2337   02  DFHEIV2               PIC X(08).
  2338   02  DFHEIV3               PIC X(08).
  2339   02  DFHEIV4               PIC X(06).
  2340   02  DFHEIV5               PIC X(04).
  2341   02  DFHEIV6               PIC X(04).
  2342   02  DFHEIV7               PIC X(02).
  2343   02  DFHEIV8               PIC X(02).
  2344   02  DFHEIV9               PIC X(01).
  2345   02  DFHEIV10              PIC S9(7) COMP-3.
  2346   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2347   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2348   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2349   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2350   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2351   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2352   02  DFHEIV17              PIC X(04).
  2353   02  DFHEIV18              PIC X(04).
  2354   02  DFHEIV19              PIC X(04).
  2355   02  DFHEIV20              USAGE IS POINTER.
  2356   02  DFHEIV21              USAGE IS POINTER.
  2357   02  DFHEIV22              USAGE IS POINTER.
  2358   02  DFHEIV23              USAGE IS POINTER.
  2359   02  DFHEIV24              USAGE IS POINTER.
  2360   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2361   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2362   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2363   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2364   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2365   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2366   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2367   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2368   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2369   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2370   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2371   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2372   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2373   02  FILLER                PIC X(02).
  2374   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2375   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2376   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2377   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2378   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2379   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2380   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2381 LINKAGE  SECTION.
  2382*****************************************************************
  2383*                                                               *
  2384* Copyright (c) 2007-2013 Dell Inc.                             *
  2385* All rights reserved.                                          *
  2386*                                                               *
  2387*****************************************************************
  2388 01  dfheiblk.
  2389     02  eibtime          pic s9(7) comp-3.
  2390     02  eibdate          pic s9(7) comp-3.
  2391     02  eibtrnid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  43
* EL055.cbl
  2392     02  eibtaskn         pic s9(7) comp-3.
  2393     02  eibtrmid         pic x(4).
  2394     02  dfheigdi         pic s9(4) comp.
  2395     02  eibcposn         pic s9(4) comp.
  2396     02  eibcalen         pic s9(4) comp.
  2397     02  eibaid           pic x(1).
  2398     02  eibfiller1       pic x(1).
  2399     02  eibfn            pic x(2).
  2400     02  eibfiller2       pic x(2).
  2401     02  eibrcode         pic x(6).
  2402     02  eibfiller3       pic x(2).
  2403     02  eibds            pic x(8).
  2404     02  eibreqid         pic x(8).
  2405     02  eibrsrce         pic x(8).
  2406     02  eibsync          pic x(1).
  2407     02  eibfree          pic x(1).
  2408     02  eibrecv          pic x(1).
  2409     02  eibsend          pic x(1).
  2410     02  eibatt           pic x(1).
  2411     02  eibeoc           pic x(1).
  2412     02  eibfmh           pic x(1).
  2413     02  eibcompl         pic x(1).
  2414     02  eibsig           pic x(1).
  2415     02  eibconf          pic x(1).
  2416     02  eiberr           pic x(1).
  2417     02  eibrldbk         pic x(1).
  2418     02  eiberrcd         pic x(4).
  2419     02  eibsynrb         pic x(1).
  2420     02  eibnodat         pic x(1).
  2421     02  eibfiller5       pic x(2).
  2422     02  eibresp          pic s9(8) comp.
  2423     02  eibresp2         pic s9(8) comp.
  2424     02  dfheigdj         pic s9(4) comp.
  2425     02  dfheigdk         pic s9(4) comp.
  2426 01  DFHCOMMAREA                 PIC X(256).
  2427 01  var  pic x(30).
  2428 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  2429 0000-DFHEXIT SECTION.
  2430     MOVE '9#                    $   ' TO DFHEIV0.
  2431     MOVE 'EL055' TO DFHEIV1.
  2432     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2433     display ' entering program EL055'
  2434     perform 0010-init           thru 0010-exit
  2435     perform 0100-check-validity thru 0100-exit
  2436     perform 0200-convert-key    thru 0200-exit
  2437     perform 0050-bld-return-area thru 0050-exit
  2438     .
  2439 0000-return.
  2440     move ws-pass-area           to dfhcommarea
  2441
  2442* exec cics return
  2443*    end-exec
  2444*    MOVE '.(                    ''   #00002437' TO DFHEIV0
  2445     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2446     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2447     MOVE X'2020233030303032343337' TO DFHEIV0(25:11)
  2448     CALL 'kxdfhei1' USING DFHEIV0,
  2449           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  44
* EL055.cbl
  2450           DFHEIV99,
  2451           DFHEIV99,
  2452           DFHEIV99,
  2453           DFHEIV99,
  2454           DFHEIV99
  2455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2456
  2457* GOBACK
  2458
  2459     MOVE '9%                    "   ' TO DFHEIV0
  2460     MOVE 'EL055' TO DFHEIV1
  2461     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2462     GOBACK
  2463     .
  2464 0010-init.
  2465     move dfhcommarea            to ws-pass-AREA
  2466     set P to address of KIXSYS
  2467     CALL "getenv" using by value P returning var-ptr
  2468     if var-ptr = null then
  2469        display ' kixsys not set '
  2470     else
  2471        set address of var to var-ptr
  2472        move 0 to env-var-len
  2473        inspect var tallying env-var-len
  2474          for characters before X'00'
  2475        unstring var (1:env-var-len) delimited by '/'
  2476           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  2477              WS-KIX-SYS
  2478        end-unstring
  2479     end-if
  2480     .
  2481 0010-exit.
  2482     exit.
  2483 0050-bld-return-area.
  2484     move zeros                  to ra-status-code
  2485     move 'SUCCESS'              to ra-message
  2486     .
  2487 0050-exit.
  2488     exit.
  2489 0100-check-validity.
  2490**** ======================================================== ****
  2491****                                                          ****
  2492****    Make sure Key to change exists on ERPNDB              ****
  2493****                                                          ****
  2494**** ======================================================== ****
  2495     move PA-ERPNDB-KEY          to erpndb-ridfld
  2496
  2497* exec cics read
  2498*       dataset    ('ERPNDB')
  2499*       ridfld     (erpndb-ridfld)
  2500*       into       (pending-business)
  2501*       resp       (ws-response)
  2502*    end-exec
  2503     MOVE LENGTH OF
  2504      pending-business
  2505       TO DFHEIV11
  2506     MOVE 'ERPNDB' TO DFHEIV1
  2507*    MOVE '&"IL       E          (  N#00002473' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  45
* EL055.cbl
  2508     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2509     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2510     MOVE X'204E233030303032343733' TO DFHEIV0(25:11)
  2511     CALL 'kxdfhei1' USING DFHEIV0,
  2512           DFHEIV1,
  2513           pending-business,
  2514           DFHEIV11,
  2515           erpndb-ridfld,
  2516           DFHEIV99,
  2517           DFHEIV99,
  2518           DFHEIV99
  2519     MOVE EIBRESP  TO ws-response
  2520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2521     if not resp-normal
  2522        move ws-response         to ra-status-code
  2523        move ' erpndb read error '
  2524                                 to ra-message
  2525        display 'error-erpndb-read ' ws-response
  2526        go to 0000-return
  2527     end-if
  2528     move pb-control-by-account  to ws-old-pndb-key
  2529     move pb-cert-eff-dt         to dc-bin-date-1
  2530     move ' '                    to dc-option-code
  2531     perform 8500-date-convert   thru 8500-exit
  2532     if no-conversion-error
  2533        string
  2534           dc-cymd-cen
  2535           dc-cymd-year   '-'
  2536           dc-cymd-month  '-'
  2537           dc-cymd-day delimited by size
  2538              into ws-old-greg-eff-date
  2539        end-string
  2540     else
  2541        display ' Bad eff date convert ' pb-cert-no
  2542        go to 0000-return
  2543     end-if
  2544***  Might as well convert the new effective dt while we're at it
  2545     move pa-new-eff-dt          to dc-bin-date-1
  2546     move ' '                    to dc-option-code
  2547     perform 8500-date-convert   thru 8500-exit
  2548     if no-conversion-error
  2549        string
  2550           dc-cymd-cen
  2551           dc-cymd-year   '-'
  2552           dc-cymd-month  '-'
  2553           dc-cymd-day delimited by size
  2554              into ws-new-greg-eff-date
  2555        end-string
  2556     else
  2557        display ' Bad new eff date convert ' pb-cert-no
  2558        go to 0000-return
  2559     end-if
  2560**** ======================================================== ****
  2561**** ======================================================== ****
  2562****                                                          ****
  2563****    Make sure Key to change exists on ELCERT              ****
  2564****                                                          ****
  2565**** ======================================================== ****
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  46
* EL055.cbl
  2566     move spaces                 to ws-bypass-ind
  2567     move ws-old-pndb-key(1:33)  to elcert-ridfld
  2568
  2569* exec cics read
  2570*       dataset    ('ELCERT')
  2571*       ridfld     (elcert-ridfld)
  2572*       into       (certificate-master)
  2573*       resp       (ws-response)
  2574*    end-exec
  2575     MOVE LENGTH OF
  2576      certificate-master
  2577       TO DFHEIV11
  2578     MOVE 'ELCERT' TO DFHEIV1
  2579*    MOVE '&"IL       E          (  N#00002526' TO DFHEIV0
  2580     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2581     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2582     MOVE X'204E233030303032353236' TO DFHEIV0(25:11)
  2583     CALL 'kxdfhei1' USING DFHEIV0,
  2584           DFHEIV1,
  2585           certificate-master,
  2586           DFHEIV11,
  2587           elcert-ridfld,
  2588           DFHEIV99,
  2589           DFHEIV99,
  2590           DFHEIV99
  2591     MOVE EIBRESP  TO ws-response
  2592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2593     if ws-response = 13
  2594        set bypass-copy-files to true
  2595        go to 0100-check-erpndb2
  2596     end-if
  2597     if not resp-normal
  2598        move ws-response         to ra-status-code
  2599        move ' elcert read error '
  2600                                 to ra-message
  2601        display 'error-elcert-read ' ws-response
  2602        go to 0000-return
  2603     end-if
  2604     if cert-added-batch
  2605        set bypass-copy-files to true
  2606     end-if
  2607     if (cert-and-claim-online)
  2608        or (cert-was-created-for-claim)
  2609        or (cm-claim-attached-count > zeros)
  2610        move +99                 to ra-status-code
  2611        move 'Claim Exists '     to ra-message
  2612        go to 0000-return
  2613     end-if
  2614**** ======================================================== ****
  2615     .
  2616 0100-check-erpndb2.
  2617**** ======================================================== ****
  2618****                                                          ****
  2619****    Make sure new key does NOT exist on ERPNDB2           ****
  2620****                                                          ****
  2621**** ======================================================== ****
  2622     move PA-new-pndb-key        to erpndb2-ridfld
  2623
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  47
* EL055.cbl
  2624* exec cics read
  2625*       dataset    ('ERPNDB2')
  2626*       ridfld     (erpndb2-ridfld)
  2627*       into       (ws-dummy-area)
  2628*       resp       (ws-response)
  2629*    end-exec
  2630     MOVE LENGTH OF
  2631      ws-dummy-area
  2632       TO DFHEIV11
  2633     MOVE 'ERPNDB2' TO DFHEIV1
  2634*    MOVE '&"IL       E          (  N#00002562' TO DFHEIV0
  2635     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2636     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2637     MOVE X'204E233030303032353632' TO DFHEIV0(25:11)
  2638     CALL 'kxdfhei1' USING DFHEIV0,
  2639           DFHEIV1,
  2640           ws-dummy-area,
  2641           DFHEIV11,
  2642           erpndb2-ridfld,
  2643           DFHEIV99,
  2644           DFHEIV99,
  2645           DFHEIV99
  2646     MOVE EIBRESP  TO ws-response
  2647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2648     if (not RESP-NOTFND)
  2649        and (not resp-endfile)
  2650        move +88                 to ra-status-code
  2651        move ' pndb already exists '
  2652                                 to ra-message
  2653        display 'error-erpndb2-read ' ws-response
  2654        go to 0000-return
  2655     end-if
  2656**** ======================================================== ****
  2657**** ======================================================== ****
  2658****                                                          ****
  2659****    Make sure new key does NOT exist on ELCERT            ****
  2660****                                                          ****
  2661**** ======================================================== ****
  2662     move PA-new-pndb-key(1:33)  to elcert-ridfld
  2663
  2664* exec cics read
  2665*       dataset    ('ELCERT')
  2666*       ridfld     (elcert-ridfld)
  2667*       into       (ws-dummy-area)
  2668*       resp       (ws-response)
  2669*    end-exec
  2670     MOVE LENGTH OF
  2671      ws-dummy-area
  2672       TO DFHEIV11
  2673     MOVE 'ELCERT' TO DFHEIV1
  2674*    MOVE '&"IL       E          (  N#00002583' TO DFHEIV0
  2675     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2676     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2677     MOVE X'204E233030303032353833' TO DFHEIV0(25:11)
  2678     CALL 'kxdfhei1' USING DFHEIV0,
  2679           DFHEIV1,
  2680           ws-dummy-area,
  2681           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  48
* EL055.cbl
  2682           elcert-ridfld,
  2683           DFHEIV99,
  2684           DFHEIV99,
  2685           DFHEIV99
  2686     MOVE EIBRESP  TO ws-response
  2687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2688     if (not RESP-NOTFND)
  2689        and (not resp-endfile)
  2690        display ' setting status to 88 '
  2691        move +88                 to ra-status-code
  2692        move ' elcert already exist '
  2693                                 to ra-message
  2694        display 'error-elcert-read-exists ' ws-response
  2695        go to 0000-return
  2696     end-if
  2697**** ======================================================== ****
  2698**** ======================================================== ****
  2699****                                                          ****
  2700****    Right here, 1)rewrite erpndb with new key, 2)delete   ****
  2701****  elcert.                                                 ****
  2702****                                                          ****
  2703**** ======================================================== ****
  2704** 1)  Rewrite erpndb with new key
  2705     move PA-ERPNDB-KEY          to erpndb-ridfld
  2706
  2707* exec cics read update
  2708*       dataset    ('ERPNDB')
  2709*       ridfld     (erpndb-ridfld)
  2710*       into       (pending-business)
  2711*       resp       (ws-response)
  2712*    end-exec
  2713     MOVE LENGTH OF
  2714      pending-business
  2715       TO DFHEIV11
  2716     MOVE 'ERPNDB' TO DFHEIV1
  2717*    MOVE '&"IL       EU         (  N#00002607' TO DFHEIV0
  2718     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2719     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2720     MOVE X'204E233030303032363037' TO DFHEIV0(25:11)
  2721     CALL 'kxdfhei1' USING DFHEIV0,
  2722           DFHEIV1,
  2723           pending-business,
  2724           DFHEIV11,
  2725           erpndb-ridfld,
  2726           DFHEIV99,
  2727           DFHEIV99,
  2728           DFHEIV99
  2729     MOVE EIBRESP  TO ws-response
  2730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2731     if not resp-normal
  2732        move ws-response         to ra-status-code
  2733        move ' erpndb read update error '
  2734                                 to ra-message
  2735        display 'error-erpndb-read update ' ws-response
  2736        go to 0000-return
  2737     end-if
  2738     move pa-new-eff-dt          to pb-cert-eff-dt
  2739     move pa-new-cert-no         to pb-cert-no
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  49
* EL055.cbl
  2740
  2741* exec cics rewrite
  2742*       dataset  ('ERPNDB')
  2743*       from     (pending-business)
  2744*       resp     (ws-response)
  2745*    end-exec
  2746     MOVE LENGTH OF
  2747      pending-business
  2748       TO DFHEIV11
  2749     MOVE 'ERPNDB' TO DFHEIV1
  2750*    MOVE '&& L                  %  N#00002622' TO DFHEIV0
  2751     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2752     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2753     MOVE X'204E233030303032363232' TO DFHEIV0(25:11)
  2754     CALL 'kxdfhei1' USING DFHEIV0,
  2755           DFHEIV1,
  2756           pending-business,
  2757           DFHEIV11,
  2758           DFHEIV99
  2759     MOVE EIBRESP  TO ws-response
  2760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2761     if not resp-normal
  2762        move ws-response         to ra-status-code
  2763        move ' erpndb rewrite error '
  2764                                 to ra-message
  2765        display 'error-erpndb-rewrite ' ws-response
  2766        go to 0000-return
  2767     end-if
  2768     .
  2769 0100-check-for-claim.
  2770     if bypass-copy-files
  2771        go to 0000-return
  2772     end-if
  2773     move ws-old-pndb-key(1:33)  to elcert-ridfld
  2774
  2775* exec cics read update
  2776*       dataset    ('ELCERT')
  2777*       ridfld     (elcert-ridfld)
  2778*       into       (certificate-master)
  2779*       resp       (ws-response)
  2780*    end-exec
  2781     MOVE LENGTH OF
  2782      certificate-master
  2783       TO DFHEIV11
  2784     MOVE 'ELCERT' TO DFHEIV1
  2785*    MOVE '&"IL       EU         (  N#00002640' TO DFHEIV0
  2786     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2787     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2788     MOVE X'204E233030303032363430' TO DFHEIV0(25:11)
  2789     CALL 'kxdfhei1' USING DFHEIV0,
  2790           DFHEIV1,
  2791           certificate-master,
  2792           DFHEIV11,
  2793           elcert-ridfld,
  2794           DFHEIV99,
  2795           DFHEIV99,
  2796           DFHEIV99
  2797     MOVE EIBRESP  TO ws-response
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  50
* EL055.cbl
  2798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2799     if (cert-added-batch)
  2800        or (cert-and-claim-online)
  2801        or (cert-was-created-for-claim)
  2802        continue
  2803     else
  2804        go to 0100-delete-elcert
  2805     end-if
  2806     if (no-claim-attached)
  2807        or (cert-added-batch)
  2808
  2809* exec cics unlock
  2810*          dataset   ('ELCERT')
  2811*          resp      (ws-response)
  2812*       end-exec
  2813     MOVE 'ELCERT' TO DFHEIV1
  2814*    MOVE '&*                    #  N#00002655' TO DFHEIV0
  2815     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  2816     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2817     MOVE X'204E233030303032363535' TO DFHEIV0(25:11)
  2818     CALL 'kxdfhei1' USING DFHEIV0,
  2819           DFHEIV1,
  2820           DFHEIV99
  2821     MOVE EIBRESP  TO ws-response
  2822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2823     else
  2824        move spaces              to cm-credit-interface-sw-1
  2825        move '2'                 to cm-claim-interface-sw
  2826
  2827* exec cics rewrite
  2828*          dataset   ('ELCERT')
  2829*          from      (certificate-master)
  2830*          resp      (ws-response)
  2831*       end-exec
  2832     MOVE LENGTH OF
  2833      certificate-master
  2834       TO DFHEIV11
  2835     MOVE 'ELCERT' TO DFHEIV1
  2836*    MOVE '&& L                  %  N#00002662' TO DFHEIV0
  2837     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2838     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2839     MOVE X'204E233030303032363632' TO DFHEIV0(25:11)
  2840     CALL 'kxdfhei1' USING DFHEIV0,
  2841           DFHEIV1,
  2842           certificate-master,
  2843           DFHEIV11,
  2844           DFHEIV99
  2845     MOVE EIBRESP  TO ws-response
  2846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2847     end-if
  2848     if not resp-normal
  2849        move ws-response         to ra-status-code
  2850        move ' elcert rewrite error clm '
  2851                                 to ra-message
  2852        display 'error-elcert-rewrite ' ws-response
  2853        go to 0000-return
  2854     end-if
  2855     go to 0100-write-new-elcert
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  51
* EL055.cbl
  2856     .
  2857 0100-delete-elcert.
  2858** 2)  Delete ELCERT (old key)
  2859     move ws-old-pndb-key(1:33)  to elcert-ridfld
  2860
  2861* exec cics delete
  2862*       dataset  ('ELCERT')
  2863*       resp     (ws-response)
  2864*    end-exec
  2865     MOVE 'ELCERT' TO DFHEIV1
  2866*    MOVE '&(                    &  N#00002680' TO DFHEIV0
  2867     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2868     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2869     MOVE X'204E233030303032363830' TO DFHEIV0(25:11)
  2870     CALL 'kxdfhei1' USING DFHEIV0,
  2871           DFHEIV1,
  2872           DFHEIV99,
  2873           DFHEIV99,
  2874           DFHEIV99,
  2875           DFHEIV99
  2876     MOVE EIBRESP  TO ws-response
  2877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2878     if not resp-normal
  2879        move ws-response         to ra-status-code
  2880        move ' elcert delete error '
  2881                                 to ra-message
  2882        display 'error-elcert-delete  ' ws-response
  2883        go to 0000-return
  2884     end-if
  2885     .
  2886 0100-write-new-elcert.
  2887**  This is commented out because I want EL6311 to write
  2888**    the new ELCERT record.
  2889** 3)  Write new ELCERT record
  2890**  Not now. Let el6311 write the new one??
  2891**   move pa-new-eff-dt          to cm-cert-eff-dt
  2892**   move pa-new-cert-no         to cm-cert-no
  2893**
  2894**   exec cics write
  2895**      dataset  ('ELCERT')
  2896**      from     (certificate-master)
  2897**      ridfld   (cm-control-primary)
  2898**      resp     (ws-response)
  2899**   end-exec
  2900**
  2901**   if not resp-normal
  2902**      move ws-response         to ra-status-code
  2903**                               to ra-message
  2904**      display 'error-elcert-write   ' ws-response
  2905**      go to 0000-return
  2906**   end-if
  2907**** ======================================================== ****
  2908****                                                          ****
  2909****    Check for ELCRTO records                              ****
  2910****                                                          ****
  2911**** ======================================================== ****
  2912     move ' '                    to ws-startbr-ind
  2913     move ws-old-pndb-key(1:33)  to elcrto-ridfld(1:33)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  52
* EL055.cbl
  2914     move opk-rec-type           to elcrto-rec-type
  2915     move +0                     to elcrto-seq-no
  2916
  2917* exec cics startbr
  2918*       dataset    ('ELCRTO')
  2919*       ridfld     (elcrto-ridfld)
  2920*       gteq
  2921*       resp       (ws-response)
  2922*    end-exec
  2923     MOVE 'ELCRTO' TO DFHEIV1
  2924     MOVE 0
  2925       TO DFHEIV11
  2926*    MOVE '&,         G          &  N#00002723' TO DFHEIV0
  2927     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2928     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2929     MOVE X'204E233030303032373233' TO DFHEIV0(25:11)
  2930     CALL 'kxdfhei1' USING DFHEIV0,
  2931           DFHEIV1,
  2932           elcrto-ridfld,
  2933           DFHEIV99,
  2934           DFHEIV11,
  2935           DFHEIV99
  2936     MOVE EIBRESP  TO ws-response
  2937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2938     if RESP-NOTFND or resp-endfile
  2939        go to 0100-end-elcrto
  2940     else
  2941        if not resp-normal
  2942           move ws-response      to ra-status-code
  2943           move ' elcrto error startbr '
  2944                                 to ra-message
  2945           display 'error-elcrto-startbr ' ws-response
  2946           go to 0000-return
  2947        end-if
  2948     end-if
  2949     move 'Y'                    to ws-startbr-ind
  2950     .
  2951 0100-elcrto-loop.
  2952
  2953* exec cics readnext
  2954*       dataset    ('ELCRTO')
  2955*       ridfld     (elcrto-ridfld)
  2956*       into       (original-certificate)
  2957*       resp       (ws-response)
  2958*    end-exec
  2959     MOVE LENGTH OF
  2960      original-certificate
  2961       TO DFHEIV12
  2962     MOVE 'ELCRTO' TO DFHEIV1
  2963     MOVE 0
  2964       TO DFHEIV11
  2965*    MOVE '&.IL                  )  N#00002743' TO DFHEIV0
  2966     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2967     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2968     MOVE X'204E233030303032373433' TO DFHEIV0(25:11)
  2969     CALL 'kxdfhei1' USING DFHEIV0,
  2970           DFHEIV1,
  2971           original-certificate,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  53
* EL055.cbl
  2972           DFHEIV12,
  2973           elcrto-ridfld,
  2974           DFHEIV99,
  2975           DFHEIV11,
  2976           DFHEIV99,
  2977           DFHEIV99
  2978     MOVE EIBRESP  TO ws-response
  2979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2980     if (RESP-NOTFND)
  2981        or (resp-endfile)
  2982        or (elcrto-ridfld(1:33) <> ws-old-pndb-key(1:33))
  2983        go to 0100-end-elcrto
  2984     else
  2985        if not resp-normal
  2986           move ws-response      to ra-status-code
  2987           move ' elcrto error readnext '
  2988                                 to ra-message
  2989           display 'error-elcrto-readnext ' ws-response
  2990           go to 0000-return
  2991        end-if
  2992     end-if
  2993     if opk-rec-type <> oc-record-type
  2994        go to 0100-elcrto-loop
  2995     end-if
  2996***  delete and add with new key right here!!!
  2997
  2998* exec cics delete
  2999*       dataset  ('ELCRTO')
  3000*       ridfld   (elcrto-ridfld)
  3001*       resp     (ws-response)
  3002*    end-exec
  3003     MOVE 'ELCRTO' TO DFHEIV1
  3004*    MOVE '&(  R                 &  N#00002766' TO DFHEIV0
  3005     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3006     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3007     MOVE X'204E233030303032373636' TO DFHEIV0(25:11)
  3008     CALL 'kxdfhei1' USING DFHEIV0,
  3009           DFHEIV1,
  3010           elcrto-ridfld,
  3011           DFHEIV99,
  3012           DFHEIV99,
  3013           DFHEIV99
  3014     MOVE EIBRESP  TO ws-response
  3015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3016     if not resp-normal
  3017        move ws-response         to ra-status-code
  3018        move ' elcrto delete error '
  3019                                 to ra-message
  3020        display 'error-elcrto-delete  ' ws-response
  3021        go to 0000-return
  3022     end-if
  3023     move pa-new-eff-dt          to oc-cert-eff-dt
  3024     move pa-new-cert-no         to oc-cert-no
  3025
  3026* exec cics write
  3027*       dataset  ('ELCRTO')
  3028*       from     (original-certificate)
  3029*       ridfld   (oc-control-primary)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  54
* EL055.cbl
  3030*       resp     (ws-response)
  3031*    end-exec
  3032     MOVE LENGTH OF
  3033      original-certificate
  3034       TO DFHEIV11
  3035     MOVE 'ELCRTO' TO DFHEIV1
  3036*    MOVE '&$ L                  ''  N#00002780' TO DFHEIV0
  3037     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3038     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3039     MOVE X'204E233030303032373830' TO DFHEIV0(25:11)
  3040     CALL 'kxdfhei1' USING DFHEIV0,
  3041           DFHEIV1,
  3042           original-certificate,
  3043           DFHEIV11,
  3044           oc-control-primary,
  3045           DFHEIV99,
  3046           DFHEIV99
  3047     MOVE EIBRESP  TO ws-response
  3048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3049     if not resp-normal
  3050        move ws-response         to ra-status-code
  3051        move ' elcrto write  error '
  3052                                 to ra-message
  3053        display 'error-elcrto-write   ' ws-response
  3054        go to 0000-return
  3055     end-if
  3056     go to 0100-elcrto-loop
  3057     .
  3058 0100-end-elcrto.
  3059     if ws-startbr-ind = 'Y'
  3060
  3061* exec cics endbr
  3062*          dataset     ('ELCRTO')
  3063*       end-exec
  3064     MOVE 'ELCRTO' TO DFHEIV1
  3065     MOVE 0
  3066       TO DFHEIV11
  3067*    MOVE '&2                    $   #00002797' TO DFHEIV0
  3068     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3069     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3070     MOVE X'2020233030303032373937' TO DFHEIV0(25:11)
  3071     CALL 'kxdfhei1' USING DFHEIV0,
  3072           DFHEIV1,
  3073           DFHEIV11,
  3074           DFHEIV99
  3075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3076     end-if
  3077      .
  3078 0100-elcrtt.
  3079**** ======================================================== ****
  3080****                                                          ****
  3081****    Check for ELCRTT records                              ****
  3082****                                                          ****
  3083**** ======================================================== ****
  3084     move ' '                    to ws-startbr-ind
  3085     move ws-old-pndb-key(1:33)  to elcrtt-ridfld(1:33)
  3086     move ' '                    to elcrtt-rec-type
  3087
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  55
* EL055.cbl
  3088* exec cics startbr
  3089*       dataset    ('ELCRTT')
  3090*       ridfld     (elcrtt-ridfld)
  3091*       gteq
  3092*       resp       (ws-response)
  3093*    end-exec
  3094     MOVE 'ELCRTT' TO DFHEIV1
  3095     MOVE 0
  3096       TO DFHEIV11
  3097*    MOVE '&,         G          &  N#00002811' TO DFHEIV0
  3098     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3099     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3100     MOVE X'204E233030303032383131' TO DFHEIV0(25:11)
  3101     CALL 'kxdfhei1' USING DFHEIV0,
  3102           DFHEIV1,
  3103           elcrtt-ridfld,
  3104           DFHEIV99,
  3105           DFHEIV11,
  3106           DFHEIV99
  3107     MOVE EIBRESP  TO ws-response
  3108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3109     if RESP-NOTFND or resp-endfile
  3110        go to 0100-end-elcrtt
  3111     else
  3112        if not resp-normal
  3113           move ws-response      to ra-status-code
  3114           move ' elcrtt error startbr '
  3115                                 to ra-message
  3116           display 'error-elcrtt-startbr ' ws-response
  3117           go to 0000-return
  3118        end-if
  3119     end-if
  3120     move 'Y'                    to ws-startbr-ind
  3121     .
  3122 0100-elcrtt-loop.
  3123
  3124* exec cics readnext
  3125*       dataset    ('ELCRTT')
  3126*       ridfld     (elcrtt-ridfld)
  3127*       into       (certificate-trailers)
  3128*       resp       (ws-response)
  3129*    end-exec
  3130     MOVE LENGTH OF
  3131      certificate-trailers
  3132       TO DFHEIV12
  3133     MOVE 'ELCRTT' TO DFHEIV1
  3134     MOVE 0
  3135       TO DFHEIV11
  3136*    MOVE '&.IL                  )  N#00002831' TO DFHEIV0
  3137     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3138     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3139     MOVE X'204E233030303032383331' TO DFHEIV0(25:11)
  3140     CALL 'kxdfhei1' USING DFHEIV0,
  3141           DFHEIV1,
  3142           certificate-trailers,
  3143           DFHEIV12,
  3144           elcrtt-ridfld,
  3145           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  56
* EL055.cbl
  3146           DFHEIV11,
  3147           DFHEIV99,
  3148           DFHEIV99
  3149     MOVE EIBRESP  TO ws-response
  3150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3151     if (RESP-NOTFND)
  3152        or (resp-endfile)
  3153        or (elcrtt-ridfld(1:33) <> ws-old-pndb-key(1:33))
  3154        go to 0100-end-elcrtt
  3155     else
  3156        if not resp-normal
  3157           move ws-response      to ra-status-code
  3158           move ' elcrtt error readnext '
  3159                                 to ra-message
  3160           display 'error-elcrtt-readnext ' ws-response
  3161           go to 0000-return
  3162        end-if
  3163     end-if
  3164***  delete and add with new key right here!!!
  3165
  3166* exec cics delete
  3167*       dataset  ('ELCRTT')
  3168*       ridfld   (elcrtt-ridfld)
  3169*       resp     (ws-response)
  3170*    end-exec
  3171     MOVE 'ELCRTT' TO DFHEIV1
  3172*    MOVE '&(  R                 &  N#00002851' TO DFHEIV0
  3173     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3174     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3175     MOVE X'204E233030303032383531' TO DFHEIV0(25:11)
  3176     CALL 'kxdfhei1' USING DFHEIV0,
  3177           DFHEIV1,
  3178           elcrtt-ridfld,
  3179           DFHEIV99,
  3180           DFHEIV99,
  3181           DFHEIV99
  3182     MOVE EIBRESP  TO ws-response
  3183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3184     if not resp-normal
  3185        move ws-response         to ra-status-code
  3186        move ' elcrtt delete error '
  3187                                 to ra-message
  3188        display 'error-elcrtt-delete  ' ws-response
  3189        go to 0000-return
  3190     end-if
  3191     move pa-new-eff-dt          to cs-cert-eff-dt
  3192     move pa-new-cert-no         to cs-cert-no
  3193
  3194* exec cics write
  3195*       dataset  ('ELCRTT')
  3196*       from     (certificate-trailers)
  3197*       ridfld   (cs-control-primary)
  3198*       resp     (ws-response)
  3199*    end-exec
  3200     MOVE LENGTH OF
  3201      certificate-trailers
  3202       TO DFHEIV11
  3203     MOVE 'ELCRTT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  57
* EL055.cbl
  3204*    MOVE '&$ L                  ''  N#00002865' TO DFHEIV0
  3205     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3206     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3207     MOVE X'204E233030303032383635' TO DFHEIV0(25:11)
  3208     CALL 'kxdfhei1' USING DFHEIV0,
  3209           DFHEIV1,
  3210           certificate-trailers,
  3211           DFHEIV11,
  3212           cs-control-primary,
  3213           DFHEIV99,
  3214           DFHEIV99
  3215     MOVE EIBRESP  TO ws-response
  3216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3217     if not resp-normal
  3218        move ws-response         to ra-status-code
  3219        move ' elcrtt write  error '
  3220                                 to ra-message
  3221        display 'error-elcrtt-write   ' ws-response
  3222        go to 0000-return
  3223     end-if
  3224     go to 0100-elcrtt-loop
  3225     .
  3226 0100-end-elcrtt.
  3227     if ws-startbr-ind = 'Y'
  3228
  3229* exec cics endbr
  3230*          dataset     ('ELCRTT')
  3231*       end-exec
  3232     MOVE 'ELCRTT' TO DFHEIV1
  3233     MOVE 0
  3234       TO DFHEIV11
  3235*    MOVE '&2                    $   #00002882' TO DFHEIV0
  3236     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3237     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3238     MOVE X'2020233030303032383832' TO DFHEIV0(25:11)
  3239     CALL 'kxdfhei1' USING DFHEIV0,
  3240           DFHEIV1,
  3241           DFHEIV11,
  3242           DFHEIV99
  3243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3244     end-if
  3245     .
  3246 0100-erarch.
  3247**** ======================================================== ****
  3248****                                                          ****
  3249****    Check for ERARCH records                              ****
  3250****                                                          ****
  3251**** ======================================================== ****
  3252     move ' '                    to ws-startbr-ind
  3253     move opk-company-cd         to erarch2-company-cd
  3254     move opk-cert-no            to erarch2-cert-no
  3255     move ws-old-pndb-key(1:21)  to erarch2-ridfld(13:21)
  3256     move +0                     to erarch2-arch-no
  3257
  3258* exec cics startbr
  3259*       dataset    ('ERARCH2')
  3260*       ridfld     (erarch2-ridfld)
  3261*       gteq
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  58
* EL055.cbl
  3262*       resp       (ws-response)
  3263*    end-exec
  3264     MOVE 'ERARCH2' TO DFHEIV1
  3265     MOVE 0
  3266       TO DFHEIV11
  3267*    MOVE '&,         G          &  N#00002898' TO DFHEIV0
  3268     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3269     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3270     MOVE X'204E233030303032383938' TO DFHEIV0(25:11)
  3271     CALL 'kxdfhei1' USING DFHEIV0,
  3272           DFHEIV1,
  3273           erarch2-ridfld,
  3274           DFHEIV99,
  3275           DFHEIV11,
  3276           DFHEIV99
  3277     MOVE EIBRESP  TO ws-response
  3278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3279     if RESP-NOTFND or resp-endfile
  3280        go to 0100-end-erarch
  3281     else
  3282        if not resp-normal
  3283           move ws-response      to ra-status-code
  3284           move ' erarch2 error startbr '
  3285                                 to ra-message
  3286           display 'error-erarch2-startbr ' ws-response
  3287           go to 0000-return
  3288        end-if
  3289     end-if
  3290     move 'Y'                    to ws-startbr-ind
  3291     .
  3292 0100-erarch-loop.
  3293
  3294* exec cics readnext
  3295*       dataset    ('ERARCH2')
  3296*       ridfld     (erarch2-ridfld)
  3297*       into       (letter-archive)
  3298*       resp       (ws-response)
  3299*    end-exec
  3300     MOVE LENGTH OF
  3301      letter-archive
  3302       TO DFHEIV12
  3303     MOVE 'ERARCH2' TO DFHEIV1
  3304     MOVE 0
  3305       TO DFHEIV11
  3306*    MOVE '&.IL                  )  N#00002918' TO DFHEIV0
  3307     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3308     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3309     MOVE X'204E233030303032393138' TO DFHEIV0(25:11)
  3310     CALL 'kxdfhei1' USING DFHEIV0,
  3311           DFHEIV1,
  3312           letter-archive,
  3313           DFHEIV12,
  3314           erarch2-ridfld,
  3315           DFHEIV99,
  3316           DFHEIV11,
  3317           DFHEIV99,
  3318           DFHEIV99
  3319     MOVE EIBRESP  TO ws-response
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  59
* EL055.cbl
  3320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3321     if (RESP-NOTFND)
  3322        or (resp-endfile)
  3323        or (erarch2-company-cd <> opk-company-cd)
  3324        or (erarch2-cert-no <> opk-cert-no)
  3325        go to 0100-end-erarch
  3326     else
  3327        if not resp-normal
  3328           move ws-response      to ra-status-code
  3329           move ' erarch2 error readnext '
  3330                                 to ra-message
  3331           display 'error-erarch2-readnext ' ws-response
  3332           go to 0000-return
  3333        end-if
  3334     end-if
  3335     if (opk-carrier <> la-carrier-a2)
  3336        or (opk-group <> la-grouping-a2)
  3337        or (opk-state <> la-state-a2)
  3338        or (opk-account <> la-account-a2)
  3339        or (opk-eff-dt <> la-effect-date-a2)
  3340        go to 0100-erarch-loop
  3341     end-if
  3342***  Do rewrites to base cluster right here!!!
  3343     move la-control-primary     to erarch-ridfld
  3344                                    nsasextr-ridfld
  3345
  3346* exec cics read update
  3347*       dataset  ('ERARCH')
  3348*       into     (letter-archive)
  3349*       ridfld   (erarch-ridfld)
  3350*       resp     (ws-response)
  3351*    end-exec
  3352     MOVE LENGTH OF
  3353      letter-archive
  3354       TO DFHEIV11
  3355     MOVE 'ERARCH' TO DFHEIV1
  3356*    MOVE '&"IL       EU         (  N#00002948' TO DFHEIV0
  3357     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3358     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3359     MOVE X'204E233030303032393438' TO DFHEIV0(25:11)
  3360     CALL 'kxdfhei1' USING DFHEIV0,
  3361           DFHEIV1,
  3362           letter-archive,
  3363           DFHEIV11,
  3364           erarch-ridfld,
  3365           DFHEIV99,
  3366           DFHEIV99,
  3367           DFHEIV99
  3368     MOVE EIBRESP  TO ws-response
  3369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3370     if not resp-normal
  3371        move ws-response         to ra-status-code
  3372        move ' erarch read update error '
  3373                                 to ra-message
  3374        display 'error-erarch-read update ' ws-response
  3375        go to 0000-return
  3376     end-if
  3377     move pa-new-eff-dt          to la-effect-date-a2
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  60
* EL055.cbl
  3378     move pa-new-cert-no         to la-cert-no-a2
  3379
  3380* exec cics rewrite
  3381*       dataset  ('ERARCH')
  3382*       from     (letter-archive)
  3383*       resp     (ws-response)
  3384*    end-exec
  3385     MOVE LENGTH OF
  3386      letter-archive
  3387       TO DFHEIV11
  3388     MOVE 'ERARCH' TO DFHEIV1
  3389*    MOVE '&& L                  %  N#00002963' TO DFHEIV0
  3390     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3391     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3392     MOVE X'204E233030303032393633' TO DFHEIV0(25:11)
  3393     CALL 'kxdfhei1' USING DFHEIV0,
  3394           DFHEIV1,
  3395           letter-archive,
  3396           DFHEIV11,
  3397           DFHEIV99
  3398     MOVE EIBRESP  TO ws-response
  3399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3400     if not resp-normal
  3401        move ws-response         to ra-status-code
  3402        move ' erarch write  error '
  3403                                 to ra-message
  3404        display 'error-erarch-write   ' ws-response
  3405        go to 0000-return
  3406     end-if
  3407     perform 0500-process-nsasextr thru 0500-exit
  3408     go to 0100-erarch-loop
  3409     .
  3410 0100-end-erarch.
  3411     if ws-startbr-ind = 'Y'
  3412
  3413* exec cics endbr
  3414*          dataset     ('ERARCH2')
  3415*       end-exec
  3416     MOVE 'ERARCH2' TO DFHEIV1
  3417     MOVE 0
  3418       TO DFHEIV11
  3419*    MOVE '&2                    $   #00002980' TO DFHEIV0
  3420     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3421     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3422     MOVE X'2020233030303032393830' TO DFHEIV0(25:11)
  3423     CALL 'kxdfhei1' USING DFHEIV0,
  3424           DFHEIV1,
  3425           DFHEIV11,
  3426           DFHEIV99
  3427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3428     end-if
  3429     .
  3430 0100-erchek.
  3431**** ======================================================== ****
  3432****                                                          ****
  3433****    Check for ERCHEK records                              ****
  3434****                                                          ****
  3435**** ======================================================== ****
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  61
* EL055.cbl
  3436     move ' '                    to ws-startbr-ind
  3437     move ws-old-pndb-key(1:33)  to erchek-ridfld(1:33)
  3438     move +0                     to erchek-seq-no
  3439
  3440* exec cics startbr
  3441*       dataset    ('ERCHEK')
  3442*       ridfld     (erchek-ridfld)
  3443*       gteq
  3444*       resp       (ws-response)
  3445*    end-exec
  3446     MOVE 'ERCHEK' TO DFHEIV1
  3447     MOVE 0
  3448       TO DFHEIV11
  3449*    MOVE '&,         G          &  N#00002994' TO DFHEIV0
  3450     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3451     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3452     MOVE X'204E233030303032393934' TO DFHEIV0(25:11)
  3453     CALL 'kxdfhei1' USING DFHEIV0,
  3454           DFHEIV1,
  3455           erchek-ridfld,
  3456           DFHEIV99,
  3457           DFHEIV11,
  3458           DFHEIV99
  3459     MOVE EIBRESP  TO ws-response
  3460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3461     if RESP-NOTFND or resp-endfile
  3462        go to 0100-end-erchek
  3463     else
  3464        if not resp-normal
  3465           move ws-response      to ra-status-code
  3466           move ' erchek error startbr '
  3467                                 to ra-message
  3468           display 'error-erchek-startbr ' ws-response
  3469           go to 0000-return
  3470        end-if
  3471     end-if
  3472     move 'Y'                    to ws-startbr-ind
  3473     .
  3474 0100-erchek-loop.
  3475
  3476* exec cics readnext
  3477*       dataset    ('ERCHEK')
  3478*       ridfld     (erchek-ridfld)
  3479*       into       (check-records)
  3480*       resp       (ws-response)
  3481*    end-exec
  3482     MOVE LENGTH OF
  3483      check-records
  3484       TO DFHEIV12
  3485     MOVE 'ERCHEK' TO DFHEIV1
  3486     MOVE 0
  3487       TO DFHEIV11
  3488*    MOVE '&.IL                  )  N#00003014' TO DFHEIV0
  3489     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3490     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3491     MOVE X'204E233030303033303134' TO DFHEIV0(25:11)
  3492     CALL 'kxdfhei1' USING DFHEIV0,
  3493           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  62
* EL055.cbl
  3494           check-records,
  3495           DFHEIV12,
  3496           erchek-ridfld,
  3497           DFHEIV99,
  3498           DFHEIV11,
  3499           DFHEIV99,
  3500           DFHEIV99
  3501     MOVE EIBRESP  TO ws-response
  3502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3503     if (RESP-NOTFND)
  3504        or (resp-endfile)
  3505        or (erchek-ridfld(1:33) <> ws-old-pndb-key(1:33))
  3506        go to 0100-end-erchek
  3507     else
  3508        if not resp-normal
  3509           move ws-response      to ra-status-code
  3510           move ' erchek error readnext '
  3511                                 to ra-message
  3512           display 'error-erchek-readnext ' ws-response
  3513           go to 0000-return
  3514        end-if
  3515     end-if
  3516***  delete and add with new key right here!!!
  3517
  3518* exec cics delete
  3519*       dataset  ('ERCHEK')
  3520*       ridfld   (erchek-ridfld)
  3521*       resp     (ws-response)
  3522*    end-exec
  3523     MOVE 'ERCHEK' TO DFHEIV1
  3524*    MOVE '&(  R                 &  N#00003034' TO DFHEIV0
  3525     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3526     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3527     MOVE X'204E233030303033303334' TO DFHEIV0(25:11)
  3528     CALL 'kxdfhei1' USING DFHEIV0,
  3529           DFHEIV1,
  3530           erchek-ridfld,
  3531           DFHEIV99,
  3532           DFHEIV99,
  3533           DFHEIV99
  3534     MOVE EIBRESP  TO ws-response
  3535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3536     if not resp-normal
  3537        move ws-response         to ra-status-code
  3538        move ' erchek delete error '
  3539                                 to ra-message
  3540        display 'error-erchek-delete  ' ws-response
  3541        go to 0000-return
  3542     end-if
  3543     move pa-new-eff-dt          to ch-cert-eff-dt
  3544     move pa-new-cert-no         to ch-cert-no
  3545
  3546* exec cics write
  3547*       dataset  ('ERCHEK')
  3548*       from     (check-records)
  3549*       ridfld   (ch-control-primary)
  3550*       resp     (ws-response)
  3551*    end-exec
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  63
* EL055.cbl
  3552     MOVE LENGTH OF
  3553      check-records
  3554       TO DFHEIV11
  3555     MOVE 'ERCHEK' TO DFHEIV1
  3556*    MOVE '&$ L                  ''  N#00003048' TO DFHEIV0
  3557     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3558     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3559     MOVE X'204E233030303033303438' TO DFHEIV0(25:11)
  3560     CALL 'kxdfhei1' USING DFHEIV0,
  3561           DFHEIV1,
  3562           check-records,
  3563           DFHEIV11,
  3564           ch-control-primary,
  3565           DFHEIV99,
  3566           DFHEIV99
  3567     MOVE EIBRESP  TO ws-response
  3568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3569     if not resp-normal
  3570        move ws-response         to ra-status-code
  3571        move ' erchek write  error '
  3572                                 to ra-message
  3573        display 'error-erchek-write   ' ws-response
  3574        go to 0000-return
  3575     end-if
  3576     go to 0100-erchek-loop
  3577     .
  3578 0100-end-erchek.
  3579     if ws-startbr-ind = 'Y'
  3580
  3581* exec cics endbr
  3582*          dataset     ('ERCHEK')
  3583*       end-exec
  3584     MOVE 'ERCHEK' TO DFHEIV1
  3585     MOVE 0
  3586       TO DFHEIV11
  3587*    MOVE '&2                    $   #00003065' TO DFHEIV0
  3588     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3589     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3590     MOVE X'2020233030303033303635' TO DFHEIV0(25:11)
  3591     CALL 'kxdfhei1' USING DFHEIV0,
  3592           DFHEIV1,
  3593           DFHEIV11,
  3594           DFHEIV99
  3595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3596     end-if
  3597     .
  3598 0100-ercnot.
  3599**** ======================================================== ****
  3600****                                                          ****
  3601****    Check for ERCNOT records                              ****
  3602****                                                          ****
  3603**** ======================================================== ****
  3604     move ' '                    to ws-startbr-ind
  3605     move ws-old-pndb-key(1:33)  to ercnot-ridfld(1:33)
  3606     move opk-rec-type           to ercnot-rec-type
  3607     move +0                     to ercnot-seq-no
  3608
  3609* exec cics startbr
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  64
* EL055.cbl
  3610*       dataset    ('ERCNOT')
  3611*       ridfld     (ercnot-ridfld)
  3612*       gteq
  3613*       resp       (ws-response)
  3614*    end-exec
  3615     MOVE 'ERCNOT' TO DFHEIV1
  3616     MOVE 0
  3617       TO DFHEIV11
  3618*    MOVE '&,         G          &  N#00003080' TO DFHEIV0
  3619     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3620     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3621     MOVE X'204E233030303033303830' TO DFHEIV0(25:11)
  3622     CALL 'kxdfhei1' USING DFHEIV0,
  3623           DFHEIV1,
  3624           ercnot-ridfld,
  3625           DFHEIV99,
  3626           DFHEIV11,
  3627           DFHEIV99
  3628     MOVE EIBRESP  TO ws-response
  3629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3630     if RESP-NOTFND or resp-endfile
  3631        go to 0100-end-ercnot
  3632     else
  3633        if not resp-normal
  3634           move ws-response      to ra-status-code
  3635           move ' ercnot error startbr '
  3636                                 to ra-message
  3637           display 'error-ercnot-startbr ' ws-response
  3638           go to 0000-return
  3639        end-if
  3640     end-if
  3641     move 'Y'                    to ws-startbr-ind
  3642     .
  3643 0100-ercnot-loop.
  3644
  3645* exec cics readnext
  3646*       dataset    ('ERCNOT')
  3647*       ridfld     (ercnot-ridfld)
  3648*       into       (cert-note-file)
  3649*       resp       (ws-response)
  3650*    end-exec
  3651     MOVE LENGTH OF
  3652      cert-note-file
  3653       TO DFHEIV12
  3654     MOVE 'ERCNOT' TO DFHEIV1
  3655     MOVE 0
  3656       TO DFHEIV11
  3657*    MOVE '&.IL                  )  N#00003100' TO DFHEIV0
  3658     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3659     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3660     MOVE X'204E233030303033313030' TO DFHEIV0(25:11)
  3661     CALL 'kxdfhei1' USING DFHEIV0,
  3662           DFHEIV1,
  3663           cert-note-file,
  3664           DFHEIV12,
  3665           ercnot-ridfld,
  3666           DFHEIV99,
  3667           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  65
* EL055.cbl
  3668           DFHEIV99,
  3669           DFHEIV99
  3670     MOVE EIBRESP  TO ws-response
  3671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3672     if (RESP-NOTFND)
  3673        or (resp-endfile)
  3674        or (ercnot-ridfld(1:33) <> ws-old-pndb-key(1:33))
  3675        go to 0100-end-ercnot
  3676     else
  3677        if not resp-normal
  3678           move ws-response      to ra-status-code
  3679           move ' ercnot error readnext '
  3680                                 to ra-message
  3681           display 'error-ercnot-readnext ' ws-response
  3682           go to 0000-return
  3683        end-if
  3684     end-if
  3685     if cz-record-type <> '1'  *>  cert note
  3686        go to 0100-ercnot-loop
  3687     end-if
  3688***  delete and add with new key right here!!!
  3689
  3690* exec cics delete
  3691*       dataset  ('ERCNOT')
  3692*       ridfld   (ercnot-ridfld)
  3693*       resp     (ws-response)
  3694*    end-exec
  3695     MOVE 'ERCNOT' TO DFHEIV1
  3696*    MOVE '&(  R                 &  N#00003123' TO DFHEIV0
  3697     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3698     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3699     MOVE X'204E233030303033313233' TO DFHEIV0(25:11)
  3700     CALL 'kxdfhei1' USING DFHEIV0,
  3701           DFHEIV1,
  3702           ercnot-ridfld,
  3703           DFHEIV99,
  3704           DFHEIV99,
  3705           DFHEIV99
  3706     MOVE EIBRESP  TO ws-response
  3707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3708     if not resp-normal
  3709        move ws-response         to ra-status-code
  3710        move ' ercnot delete error '
  3711                                 to ra-message
  3712        display 'error-ercnot-delete  ' ws-response
  3713        go to 0000-return
  3714     end-if
  3715     move pa-new-eff-dt          to cz-cert-eff-dt
  3716     move pa-new-cert-no         to cz-cert-no
  3717
  3718* exec cics write
  3719*       dataset  ('ERCNOT')
  3720*       from     (cert-note-file)
  3721*       ridfld   (cz-control-primary)
  3722*       resp     (ws-response)
  3723*    end-exec
  3724     MOVE LENGTH OF
  3725      cert-note-file
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  66
* EL055.cbl
  3726       TO DFHEIV11
  3727     MOVE 'ERCNOT' TO DFHEIV1
  3728*    MOVE '&$ L                  ''  N#00003137' TO DFHEIV0
  3729     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3730     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3731     MOVE X'204E233030303033313337' TO DFHEIV0(25:11)
  3732     CALL 'kxdfhei1' USING DFHEIV0,
  3733           DFHEIV1,
  3734           cert-note-file,
  3735           DFHEIV11,
  3736           cz-control-primary,
  3737           DFHEIV99,
  3738           DFHEIV99
  3739     MOVE EIBRESP  TO ws-response
  3740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3741     if not resp-normal
  3742        move ws-response         to ra-status-code
  3743        move ' ercnot write  error '
  3744                                 to ra-message
  3745        display 'error-ercnot-write   ' ws-response
  3746        go to 0000-return
  3747     end-if
  3748     go to 0100-ercnot-loop
  3749     .
  3750 0100-end-ercnot.
  3751     if ws-startbr-ind = 'Y'
  3752
  3753* exec cics endbr
  3754*          dataset     ('ERCNOT')
  3755*       end-exec
  3756     MOVE 'ERCNOT' TO DFHEIV1
  3757     MOVE 0
  3758       TO DFHEIV11
  3759*    MOVE '&2                    $   #00003154' TO DFHEIV0
  3760     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3761     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3762     MOVE X'2020233030303033313534' TO DFHEIV0(25:11)
  3763     CALL 'kxdfhei1' USING DFHEIV0,
  3764           DFHEIV1,
  3765           DFHEIV11,
  3766           DFHEIV99
  3767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3768     end-if
  3769      .
  3770 0100-ernote.
  3771**** ======================================================== ****
  3772****                                                          ****
  3773****    Check for ERNOTE record.                              ****
  3774****                                                          ****
  3775**** ======================================================== ****
  3776     move ws-old-pndb-key(1:33)  to ernote-ridfld
  3777
  3778* exec cics read
  3779*       dataset    ('ERNOTE')
  3780*       ridfld     (ernote-ridfld)
  3781*       into       (certificate-note)
  3782*       resp       (ws-response)
  3783*    end-exec
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  67
* EL055.cbl
  3784     MOVE LENGTH OF
  3785      certificate-note
  3786       TO DFHEIV11
  3787     MOVE 'ERNOTE' TO DFHEIV1
  3788*    MOVE '&"IL       E          (  N#00003166' TO DFHEIV0
  3789     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3790     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3791     MOVE X'204E233030303033313636' TO DFHEIV0(25:11)
  3792     CALL 'kxdfhei1' USING DFHEIV0,
  3793           DFHEIV1,
  3794           certificate-note,
  3795           DFHEIV11,
  3796           ernote-ridfld,
  3797           DFHEIV99,
  3798           DFHEIV99,
  3799           DFHEIV99
  3800     MOVE EIBRESP  TO ws-response
  3801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3802     if (RESP-NOTFND)
  3803        or (resp-endfile)
  3804        go to 0100-end-ernote
  3805     else
  3806        if not resp-normal
  3807           move ws-response      to ra-status-code
  3808           move ' ernote error readnext '
  3809                                 to ra-message
  3810           display 'error-ernote-readnext ' ws-response
  3811           go to 0000-return
  3812        end-if
  3813     end-if
  3814***  delete and add with new key right here!!!
  3815** 1)  Delete ERNOTE (old key)
  3816
  3817* exec cics delete
  3818*       dataset  ('ERNOTE')
  3819*       ridfld   (ernote-ridfld)
  3820*       resp     (ws-response)
  3821*    end-exec
  3822     MOVE 'ERNOTE' TO DFHEIV1
  3823*    MOVE '&(  R                 &  N#00003186' TO DFHEIV0
  3824     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3825     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3826     MOVE X'204E233030303033313836' TO DFHEIV0(25:11)
  3827     CALL 'kxdfhei1' USING DFHEIV0,
  3828           DFHEIV1,
  3829           ernote-ridfld,
  3830           DFHEIV99,
  3831           DFHEIV99,
  3832           DFHEIV99
  3833     MOVE EIBRESP  TO ws-response
  3834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3835     if not resp-normal
  3836        move ws-response         to ra-status-code
  3837        move ' ernote delete error '
  3838                                 to ra-message
  3839        display 'error-ernote-delete  ' ws-response
  3840        go to 0000-return
  3841     end-if
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  68
* EL055.cbl
  3842** 2)  Write new ERNOTE record
  3843     move pa-new-eff-dt          to cn-cert-eff-dt
  3844     move pa-new-cert-no         to cn-cert-no
  3845
  3846* exec cics write
  3847*       dataset  ('ERNOTE')
  3848*       from     (certificate-note)
  3849*       ridfld   (cn-control-primary)
  3850*       resp     (ws-response)
  3851*    end-exec
  3852     MOVE LENGTH OF
  3853      certificate-note
  3854       TO DFHEIV11
  3855     MOVE 'ERNOTE' TO DFHEIV1
  3856*    MOVE '&$ L                  ''  N#00003201' TO DFHEIV0
  3857     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3858     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3859     MOVE X'204E233030303033323031' TO DFHEIV0(25:11)
  3860     CALL 'kxdfhei1' USING DFHEIV0,
  3861           DFHEIV1,
  3862           certificate-note,
  3863           DFHEIV11,
  3864           cn-control-primary,
  3865           DFHEIV99,
  3866           DFHEIV99
  3867     MOVE EIBRESP  TO ws-response
  3868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3869     if not resp-normal
  3870        move ws-response         to ra-status-code
  3871        move ' ernote write  error '
  3872                                 to ra-message
  3873        display 'error-ernote-write   ' ws-response
  3874        go to 0000-return
  3875     end-if
  3876     .
  3877 0100-end-ernote.
  3878     .
  3879 0100-ermail.
  3880**** ======================================================== ****
  3881****                                                          ****
  3882****    Check for ERMAIL record.                              ****
  3883****                                                          ****
  3884**** ======================================================== ****
  3885     move ws-old-pndb-key(1:33)  to ermail-ridfld
  3886
  3887* exec cics read
  3888*       dataset    ('ERMAIL')
  3889*       ridfld     (ermail-ridfld)
  3890*       into       (mailing-data)
  3891*       resp       (ws-response)
  3892*    end-exec
  3893     MOVE LENGTH OF
  3894      mailing-data
  3895       TO DFHEIV11
  3896     MOVE 'ERMAIL' TO DFHEIV1
  3897*    MOVE '&"IL       E          (  N#00003224' TO DFHEIV0
  3898     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3899     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  69
* EL055.cbl
  3900     MOVE X'204E233030303033323234' TO DFHEIV0(25:11)
  3901     CALL 'kxdfhei1' USING DFHEIV0,
  3902           DFHEIV1,
  3903           mailing-data,
  3904           DFHEIV11,
  3905           ermail-ridfld,
  3906           DFHEIV99,
  3907           DFHEIV99,
  3908           DFHEIV99
  3909     MOVE EIBRESP  TO ws-response
  3910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3911     if (RESP-NOTFND)
  3912        or (resp-endfile)
  3913        go to 0100-end-ermail
  3914     else
  3915        if not resp-normal
  3916           move ws-response      to ra-status-code
  3917           move ' ermail error readnext '
  3918                                 to ra-message
  3919           display 'error-ermail-readnext ' ws-response
  3920           go to 0000-return
  3921        end-if
  3922     end-if
  3923***  delete and add with new key right here!!!
  3924** 1)  Delete ERMAIL (old key)
  3925
  3926* exec cics delete
  3927*       dataset  ('ERMAIL')
  3928*       ridfld   (ermail-ridfld)
  3929*       resp     (ws-response)
  3930*    end-exec
  3931     MOVE 'ERMAIL' TO DFHEIV1
  3932*    MOVE '&(  R                 &  N#00003244' TO DFHEIV0
  3933     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3934     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3935     MOVE X'204E233030303033323434' TO DFHEIV0(25:11)
  3936     CALL 'kxdfhei1' USING DFHEIV0,
  3937           DFHEIV1,
  3938           ermail-ridfld,
  3939           DFHEIV99,
  3940           DFHEIV99,
  3941           DFHEIV99
  3942     MOVE EIBRESP  TO ws-response
  3943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3944     if not resp-normal
  3945        move ws-response         to ra-status-code
  3946        move ' ermail delete error '
  3947                                 to ra-message
  3948        display 'error-ermail-delete  ' ws-response
  3949        go to 0000-return
  3950     end-if
  3951** 2)  Write new ERMAIL record
  3952     move pa-new-eff-dt          to ma-cert-eff-dt
  3953     move pa-new-cert-no         to ma-cert-no
  3954
  3955* exec cics write
  3956*       dataset  ('ERMAIL')
  3957*       from     (mailing-data)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  70
* EL055.cbl
  3958*       ridfld   (ma-control-primary)
  3959*       resp     (ws-response)
  3960*    end-exec
  3961     MOVE LENGTH OF
  3962      mailing-data
  3963       TO DFHEIV11
  3964     MOVE 'ERMAIL' TO DFHEIV1
  3965*    MOVE '&$ L                  ''  N#00003259' TO DFHEIV0
  3966     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3967     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3968     MOVE X'204E233030303033323539' TO DFHEIV0(25:11)
  3969     CALL 'kxdfhei1' USING DFHEIV0,
  3970           DFHEIV1,
  3971           mailing-data,
  3972           DFHEIV11,
  3973           ma-control-primary,
  3974           DFHEIV99,
  3975           DFHEIV99
  3976     MOVE EIBRESP  TO ws-response
  3977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3978     if not resp-normal
  3979        move ws-response         to ra-status-code
  3980        move ' ermail write  error '
  3981                                 to ra-message
  3982        display 'error-ermail-write   ' ws-response
  3983        go to 0000-return
  3984     end-if
  3985     .
  3986 0100-end-ermail.
  3987     .
  3988 0100-erendr.
  3989**** ======================================================== ****
  3990****                                                          ****
  3991****    Check for ERENDR records                              ****
  3992****                                                          ****
  3993**** ======================================================== ****
  3994     move ' '                    to ws-startbr-ind
  3995     move ws-old-pndb-key(1:33)  to erendr-ridfld(1:33)
  3996     move +0                     to erendr-seq-no
  3997     move ' '                    to erendr-rec-type
  3998
  3999* exec cics startbr
  4000*       dataset    ('ERENDR')
  4001*       ridfld     (erendr-ridfld)
  4002*       gteq
  4003*       resp       (ws-response)
  4004*    end-exec
  4005     MOVE 'ERENDR' TO DFHEIV1
  4006     MOVE 0
  4007       TO DFHEIV11
  4008*    MOVE '&,         G          &  N#00003285' TO DFHEIV0
  4009     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4010     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4011     MOVE X'204E233030303033323835' TO DFHEIV0(25:11)
  4012     CALL 'kxdfhei1' USING DFHEIV0,
  4013           DFHEIV1,
  4014           erendr-ridfld,
  4015           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  71
* EL055.cbl
  4016           DFHEIV11,
  4017           DFHEIV99
  4018     MOVE EIBRESP  TO ws-response
  4019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4020     if RESP-NOTFND or resp-endfile
  4021        go to 0100-end-erendr
  4022     else
  4023        if not resp-normal
  4024           move ws-response      to ra-status-code
  4025           move ' erendr error startbr '
  4026                                 to ra-message
  4027           display 'error-erendr-startbr ' ws-response
  4028           go to 0000-return
  4029        end-if
  4030     end-if
  4031     move 'Y'                    to ws-startbr-ind
  4032     .
  4033 0100-erendr-loop.
  4034
  4035* exec cics readnext
  4036*       dataset    ('ERENDR')
  4037*       ridfld     (erendr-ridfld)
  4038*       into       (endorsement-record)
  4039*       resp       (ws-response)
  4040*    end-exec
  4041     MOVE LENGTH OF
  4042      endorsement-record
  4043       TO DFHEIV12
  4044     MOVE 'ERENDR' TO DFHEIV1
  4045     MOVE 0
  4046       TO DFHEIV11
  4047*    MOVE '&.IL                  )  N#00003305' TO DFHEIV0
  4048     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4049     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4050     MOVE X'204E233030303033333035' TO DFHEIV0(25:11)
  4051     CALL 'kxdfhei1' USING DFHEIV0,
  4052           DFHEIV1,
  4053           endorsement-record,
  4054           DFHEIV12,
  4055           erendr-ridfld,
  4056           DFHEIV99,
  4057           DFHEIV11,
  4058           DFHEIV99,
  4059           DFHEIV99
  4060     MOVE EIBRESP  TO ws-response
  4061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4062     if (RESP-NOTFND)
  4063        or (resp-endfile)
  4064        or (erendr-ridfld(1:33) <> ws-old-pndb-key(1:33))
  4065        go to 0100-end-erendr
  4066     else
  4067        if not resp-normal
  4068           move ws-response      to ra-status-code
  4069           move ' erendr error readnext '
  4070                                 to ra-message
  4071           display 'error-erendr-readnext ' ws-response
  4072           go to 0000-return
  4073        end-if
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  72
* EL055.cbl
  4074     end-if
  4075     if en-rec-type <> '1'  *>  Issue record
  4076        go to 0100-erendr-loop
  4077     end-if
  4078***  delete and add with new key right here!!!
  4079
  4080* exec cics delete
  4081*       dataset  ('ERENDR')
  4082*       ridfld   (erendr-ridfld)
  4083*       resp     (ws-response)
  4084*    end-exec
  4085     MOVE 'ERENDR' TO DFHEIV1
  4086*    MOVE '&(  R                 &  N#00003328' TO DFHEIV0
  4087     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  4088     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4089     MOVE X'204E233030303033333238' TO DFHEIV0(25:11)
  4090     CALL 'kxdfhei1' USING DFHEIV0,
  4091           DFHEIV1,
  4092           erendr-ridfld,
  4093           DFHEIV99,
  4094           DFHEIV99,
  4095           DFHEIV99
  4096     MOVE EIBRESP  TO ws-response
  4097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4098     if not resp-normal
  4099        move ws-response         to ra-status-code
  4100        move ' erendr delete error '
  4101                                 to ra-message
  4102        display 'error-erendr-delete  ' ws-response
  4103        go to 0000-return
  4104     end-if
  4105     move pa-new-eff-dt          to en-cert-eff-dt
  4106     move pa-new-cert-no         to en-cert-no
  4107
  4108* exec cics write
  4109*       dataset  ('ERENDR')
  4110*       from     (ENDORSEMENT-RECORD)
  4111*       ridfld   (en-control-primary)
  4112*       resp     (ws-response)
  4113*    end-exec
  4114     MOVE LENGTH OF
  4115      ENDORSEMENT-RECORD
  4116       TO DFHEIV11
  4117     MOVE 'ERENDR' TO DFHEIV1
  4118*    MOVE '&$ L                  ''  N#00003342' TO DFHEIV0
  4119     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4120     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4121     MOVE X'204E233030303033333432' TO DFHEIV0(25:11)
  4122     CALL 'kxdfhei1' USING DFHEIV0,
  4123           DFHEIV1,
  4124           ENDORSEMENT-RECORD,
  4125           DFHEIV11,
  4126           en-control-primary,
  4127           DFHEIV99,
  4128           DFHEIV99
  4129     MOVE EIBRESP  TO ws-response
  4130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4131     if not resp-normal
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  73
* EL055.cbl
  4132        move ws-response         to ra-status-code
  4133        move ' erendr write  error '
  4134                                 to ra-message
  4135        display 'error-erendr-write   ' ws-response
  4136        go to 0000-return
  4137     end-if
  4138     go to 0100-erendr-loop
  4139     .
  4140 0100-end-erendr.
  4141     if ws-startbr-ind = 'Y'
  4142
  4143* exec cics endbr
  4144*          dataset     ('ERENDR')
  4145*       end-exec
  4146     MOVE 'ERENDR' TO DFHEIV1
  4147     MOVE 0
  4148       TO DFHEIV11
  4149*    MOVE '&2                    $   #00003359' TO DFHEIV0
  4150     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4151     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4152     MOVE X'2020233030303033333539' TO DFHEIV0(25:11)
  4153     CALL 'kxdfhei1' USING DFHEIV0,
  4154           DFHEIV1,
  4155           DFHEIV11,
  4156           DFHEIV99
  4157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4158     end-if
  4159     .
  4160 0100-erendt.
  4161**** ======================================================== ****
  4162****                                                          ****
  4163****    Check for ERENDT records                              ****
  4164****                                                          ****
  4165**** ======================================================== ****
  4166     move ' '                    to ws-startbr-ind
  4167     move ws-old-pndb-key(1:33)  to erendt-ridfld(1:33)
  4168     move ' '                    to erendt-rec-type
  4169     move +0                     to erendt-seq-no
  4170
  4171* exec cics startbr
  4172*       dataset    ('ERENDT')
  4173*       ridfld     (erendt-ridfld)
  4174*       gteq
  4175*       resp       (ws-response)
  4176*    end-exec
  4177     MOVE 'ERENDT' TO DFHEIV1
  4178     MOVE 0
  4179       TO DFHEIV11
  4180*    MOVE '&,         G          &  N#00003374' TO DFHEIV0
  4181     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4182     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4183     MOVE X'204E233030303033333734' TO DFHEIV0(25:11)
  4184     CALL 'kxdfhei1' USING DFHEIV0,
  4185           DFHEIV1,
  4186           erendt-ridfld,
  4187           DFHEIV99,
  4188           DFHEIV11,
  4189           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  74
* EL055.cbl
  4190     MOVE EIBRESP  TO ws-response
  4191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4192     if RESP-NOTFND or resp-endfile
  4193        go to 0100-end-erendt
  4194     else
  4195        if not resp-normal
  4196           move ws-response      to ra-status-code
  4197           move ' erendt error startbr '
  4198                                 to ra-message
  4199           display 'error-erendt-startbr ' ws-response
  4200           go to 0000-return
  4201        end-if
  4202     end-if
  4203     move 'Y'                    to ws-startbr-ind
  4204     .
  4205 0100-erendt-loop.
  4206
  4207* exec cics readnext
  4208*       dataset    ('ERENDT')
  4209*       ridfld     (erendt-ridfld)
  4210*       into       (endt-record)
  4211*       resp       (ws-response)
  4212*    end-exec
  4213     MOVE LENGTH OF
  4214      endt-record
  4215       TO DFHEIV12
  4216     MOVE 'ERENDT' TO DFHEIV1
  4217     MOVE 0
  4218       TO DFHEIV11
  4219*    MOVE '&.IL                  )  N#00003394' TO DFHEIV0
  4220     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4221     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4222     MOVE X'204E233030303033333934' TO DFHEIV0(25:11)
  4223     CALL 'kxdfhei1' USING DFHEIV0,
  4224           DFHEIV1,
  4225           endt-record,
  4226           DFHEIV12,
  4227           erendt-ridfld,
  4228           DFHEIV99,
  4229           DFHEIV11,
  4230           DFHEIV99,
  4231           DFHEIV99
  4232     MOVE EIBRESP  TO ws-response
  4233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4234     if (RESP-NOTFND)
  4235        or (resp-endfile)
  4236        or (erendt-ridfld(1:33) <> ws-old-pndb-key(1:33))
  4237        go to 0100-end-erendt
  4238     else
  4239        if not resp-normal
  4240           move ws-response      to ra-status-code
  4241           move ' erendt error readnext '
  4242                                 to ra-message
  4243           display 'error-erendt-readnext ' ws-response
  4244           go to 0000-return
  4245        end-if
  4246     end-if
  4247     if et-rec-type <> 'I'  *>  Issue record
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  75
* EL055.cbl
  4248        go to 0100-erendt-loop
  4249     end-if
  4250***  delete and add with new key right here!!!
  4251
  4252* exec cics delete
  4253*       dataset  ('ERENDT')
  4254*       ridfld   (erendt-ridfld)
  4255*       resp     (ws-response)
  4256*    end-exec
  4257     MOVE 'ERENDT' TO DFHEIV1
  4258*    MOVE '&(  R                 &  N#00003417' TO DFHEIV0
  4259     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  4260     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4261     MOVE X'204E233030303033343137' TO DFHEIV0(25:11)
  4262     CALL 'kxdfhei1' USING DFHEIV0,
  4263           DFHEIV1,
  4264           erendt-ridfld,
  4265           DFHEIV99,
  4266           DFHEIV99,
  4267           DFHEIV99
  4268     MOVE EIBRESP  TO ws-response
  4269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4270     if not resp-normal
  4271        move ws-response         to ra-status-code
  4272        move ' erendt delete error '
  4273                                 to ra-message
  4274        display 'error-erendt-delete  ' ws-response
  4275        go to 0000-return
  4276     end-if
  4277     move pa-new-eff-dt          to et-cert-eff-dt
  4278     move pa-new-cert-no         to et-cert-no
  4279
  4280* exec cics write
  4281*       dataset  ('ERENDT')
  4282*       from     (ENDT-RECORD)
  4283*       ridfld   (et-control-primary)
  4284*       resp     (ws-response)
  4285*    end-exec
  4286     MOVE LENGTH OF
  4287      ENDT-RECORD
  4288       TO DFHEIV11
  4289     MOVE 'ERENDT' TO DFHEIV1
  4290*    MOVE '&$ L                  ''  N#00003431' TO DFHEIV0
  4291     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4292     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4293     MOVE X'204E233030303033343331' TO DFHEIV0(25:11)
  4294     CALL 'kxdfhei1' USING DFHEIV0,
  4295           DFHEIV1,
  4296           ENDT-RECORD,
  4297           DFHEIV11,
  4298           et-control-primary,
  4299           DFHEIV99,
  4300           DFHEIV99
  4301     MOVE EIBRESP  TO ws-response
  4302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4303     if not resp-normal
  4304        move ws-response         to ra-status-code
  4305        move ' erendt write  error '
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  76
* EL055.cbl
  4306                                 to ra-message
  4307        display 'error-erendt-write   ' ws-response
  4308        go to 0000-return
  4309     end-if
  4310     go to 0100-erendt-loop
  4311     .
  4312 0100-end-erendt.
  4313     if ws-startbr-ind = 'Y'
  4314
  4315* exec cics endbr
  4316*          dataset     ('ERENDT')
  4317*       end-exec
  4318     MOVE 'ERENDT' TO DFHEIV1
  4319     MOVE 0
  4320       TO DFHEIV11
  4321*    MOVE '&2                    $   #00003448' TO DFHEIV0
  4322     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4323     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4324     MOVE X'2020233030303033343438' TO DFHEIV0(25:11)
  4325     CALL 'kxdfhei1' USING DFHEIV0,
  4326           DFHEIV1,
  4327           DFHEIV11,
  4328           DFHEIV99
  4329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4330     end-if
  4331     .
  4332 0100-exit.
  4333     exit.
  4334 0200-convert-key.
  4335     .
  4336 0200-exit.
  4337     exit.
  4338 0500-process-nsasextr.
  4339**** ======================================================== ****
  4340****                                                          ****
  4341****    Check for NSASEXTR records                            ****
  4342****                                                          ****
  4343**** ======================================================== ****
  4344     move ' '                    to ws-NS-startbr-ind
  4345     move +0                     to nsasextr-seq-no
  4346
  4347* exec cics startbr
  4348*       dataset    ('NSASEXTR')
  4349*       ridfld     (nsasextr-ridfld)
  4350*       gteq
  4351*       resp       (ws-response)
  4352*    end-exec
  4353     MOVE 'NSASEXTR' TO DFHEIV1
  4354     MOVE 0
  4355       TO DFHEIV11
  4356*    MOVE '&,         G          &  N#00003467' TO DFHEIV0
  4357     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4358     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4359     MOVE X'204E233030303033343637' TO DFHEIV0(25:11)
  4360     CALL 'kxdfhei1' USING DFHEIV0,
  4361           DFHEIV1,
  4362           nsasextr-ridfld,
  4363           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  77
* EL055.cbl
  4364           DFHEIV11,
  4365           DFHEIV99
  4366     MOVE EIBRESP  TO ws-response
  4367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4368     if RESP-NOTFND or resp-endfile
  4369        go to 0500-end-nsasextr
  4370     else
  4371        if not resp-normal
  4372           move ws-response      to ra-status-code
  4373           move ' nsasextr error startbr '
  4374                                 to ra-message
  4375           display 'error-nsasextr-startbr ' ws-response
  4376           go to 0000-return
  4377        end-if
  4378     end-if
  4379     move 'Y'                    to ws-NS-startbr-ind
  4380     .
  4381 0500-nsasextr-loop.
  4382
  4383* exec cics readnext
  4384*       dataset    ('NSASEXTR')
  4385*       ridfld     (nsasextr-ridfld)
  4386*       into       (nsas-extract-record)
  4387*       resp       (ws-response)
  4388*    end-exec
  4389     MOVE LENGTH OF
  4390      nsas-extract-record
  4391       TO DFHEIV12
  4392     MOVE 'NSASEXTR' TO DFHEIV1
  4393     MOVE 0
  4394       TO DFHEIV11
  4395*    MOVE '&.IL                  )  N#00003487' TO DFHEIV0
  4396     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4397     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4398     MOVE X'204E233030303033343837' TO DFHEIV0(25:11)
  4399     CALL 'kxdfhei1' USING DFHEIV0,
  4400           DFHEIV1,
  4401           nsas-extract-record,
  4402           DFHEIV12,
  4403           nsasextr-ridfld,
  4404           DFHEIV99,
  4405           DFHEIV11,
  4406           DFHEIV99,
  4407           DFHEIV99
  4408     MOVE EIBRESP  TO ws-response
  4409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4410     if (RESP-NOTFND)
  4411        or (resp-endfile)
  4412        or (nsas-company-cd <> opk-company-cd)
  4413        or (nsas-archive-no <> la-archive-no)
  4414        go to 0500-end-nsasextr
  4415     else
  4416        if not resp-normal
  4417           move ws-response      to ra-status-code
  4418           move ' nsasextr error readnext '
  4419                                 to ra-message
  4420           display 'error-nsasextr-readnext ' ws-response
  4421           go to 0000-return
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  78
* EL055.cbl
  4422        end-if
  4423     end-if
  4424     move nsas-control-primary   to nsasextr-ridfld
  4425
  4426* exec cics read update
  4427*       dataset  ('NSASEXTR')
  4428*       into     (nsas-extract-record)
  4429*       ridfld   (nsasextr-ridfld)
  4430*       resp     (ws-response)
  4431*    end-exec
  4432     MOVE LENGTH OF
  4433      nsas-extract-record
  4434       TO DFHEIV11
  4435     MOVE 'NSASEXTR' TO DFHEIV1
  4436*    MOVE '&"IL       EU         (  N#00003508' TO DFHEIV0
  4437     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4438     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4439     MOVE X'204E233030303033353038' TO DFHEIV0(25:11)
  4440     CALL 'kxdfhei1' USING DFHEIV0,
  4441           DFHEIV1,
  4442           nsas-extract-record,
  4443           DFHEIV11,
  4444           nsasextr-ridfld,
  4445           DFHEIV99,
  4446           DFHEIV99,
  4447           DFHEIV99
  4448     MOVE EIBRESP  TO ws-response
  4449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4450     if not resp-normal
  4451        move ws-response         to ra-status-code
  4452        move ' nsasextr read update error '
  4453                                 to ra-message
  4454        display 'error-nsasextr-read update ' ws-response
  4455        go to 0000-return
  4456     end-if
  4457     move zeros                  to nscntr
  4458     perform varying ns1 from +1 by +1 until
  4459        nscntr = +10
  4460        if nsas-letter-variables(ns1:1) = '~'
  4461           compute nscntr = nscntr + 1
  4462        end-if
  4463     end-perform
  4464     if nscntr = +10
  4465        if (nsas-letter-variables(ns1:10) =
  4466              ws-old-greg-eff-date)
  4467           and (nsas-letter-variables(ns1:10) <>
  4468              ws-new-greg-eff-date)
  4469           move ws-new-greg-eff-date
  4470                                 to nsas-letter-variables(ns1:10)
  4471        end-if
  4472        perform varying ns1 from ns1 by +1
  4473           until (nsas-letter-variables(ns1:1) = '~')
  4474              or (ns1 > +4000)
  4475        end-perform
  4476        compute ns1 = ns1 + 1
  4477        if ns1 < +4000
  4478           if (nsas-letter-variables(ns1:11) =
  4479                 opk-cert-no)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  79
* EL055.cbl
  4480              and (nsas-letter-variables(ns1:11) <>
  4481                 pa-new-cert-no)
  4482              move pa-new-cert-no to
  4483                 nsas-letter-variables(ns1:11)
  4484           end-if
  4485        end-if
  4486     end-if
  4487
  4488* exec cics rewrite
  4489*       dataset  ('NSASEXTR')
  4490*       from     (nsas-extract-record)
  4491*       resp     (ws-response)
  4492*    end-exec
  4493     MOVE LENGTH OF
  4494      nsas-extract-record
  4495       TO DFHEIV11
  4496     MOVE 'NSASEXTR' TO DFHEIV1
  4497*    MOVE '&& L                  %  N#00003551' TO DFHEIV0
  4498     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4499     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4500     MOVE X'204E233030303033353531' TO DFHEIV0(25:11)
  4501     CALL 'kxdfhei1' USING DFHEIV0,
  4502           DFHEIV1,
  4503           nsas-extract-record,
  4504           DFHEIV11,
  4505           DFHEIV99
  4506     MOVE EIBRESP  TO ws-response
  4507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4508     if not resp-normal
  4509        move ws-response         to ra-status-code
  4510        move ' nsasextr write  error '
  4511                                 to ra-message
  4512        display 'error-nsasextr-write   ' ws-response
  4513        go to 0000-return
  4514     end-if
  4515     go to 0500-nsasextr-loop
  4516     .
  4517 0500-end-nsasextr.
  4518     if ws-NS-startbr-ind = 'Y'
  4519
  4520* exec cics endbr
  4521*          dataset     ('NSASEXTR')
  4522*       end-exec
  4523     MOVE 'NSASEXTR' TO DFHEIV1
  4524     MOVE 0
  4525       TO DFHEIV11
  4526*    MOVE '&2                    $   #00003567' TO DFHEIV0
  4527     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4528     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4529     MOVE X'2020233030303033353637' TO DFHEIV0(25:11)
  4530     CALL 'kxdfhei1' USING DFHEIV0,
  4531           DFHEIV1,
  4532           DFHEIV11,
  4533           DFHEIV99
  4534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4535     end-if
  4536     .
  4537 0500-exit.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-20 09:16 Page  80
* EL055.cbl
  4538     exit.
  4539 8500-DATE-CONVERT.
  4540
  4541* EXEC CICS LINK
  4542*        PROGRAM  ('ELDATCV')
  4543*        COMMAREA (DATE-CONVERSION-DATA)
  4544*        LENGTH   (DC-COMM-LENGTH)
  4545*    END-EXEC
  4546     MOVE 'ELDATCV' TO DFHEIV1
  4547*    MOVE '."C                   (   #00003575' TO DFHEIV0
  4548     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4549     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4550     MOVE X'2020233030303033353735' TO DFHEIV0(25:11)
  4551     CALL 'kxdfhei1' USING DFHEIV0,
  4552           DFHEIV1,
  4553           DATE-CONVERSION-DATA,
  4554           DC-COMM-LENGTH,
  4555           DFHEIV99,
  4556           DFHEIV99,
  4557           DFHEIV99,
  4558           DFHEIV99
  4559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4560     .
  4561 8500-EXIT.
  4562     EXIT.
  4563
  4564 9999-DFHBACK SECTION.
  4565     MOVE '9%                    "   ' TO DFHEIV0
  4566     MOVE 'EL055' TO DFHEIV1
  4567     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4568     GOBACK.
  4569 9999-DFHEXIT.
  4570     IF DFHEIGDJ EQUAL 0001
  4571         NEXT SENTENCE.
  4572     MOVE '9%                    "   ' TO DFHEIV0
  4573     MOVE 'EL055' TO DFHEIV1
  4574     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4575     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       13696     Code:       16150
