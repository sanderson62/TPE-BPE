* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL010.cbl
* Options: int("EL010.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL010.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL010.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL010.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL010 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:26:36.
     7*                            VMOD=2.005.
     8*AUTHOR.        LOGIC, INC.
     9*               DALLAS, TEXAS.
    10*
    11*DATE-COMPILED.
    12*SECURITY.   *****************************************************
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL010.cbl
    14*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    15*            *                                                   *
    16*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    17*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    19*            *                                                   *
    20*            *****************************************************
    21*REMARKS. EX99 - OPERATOR HELP FUNCTIONS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL010.cbl
    23 ENVIRONMENT DIVISION.
    24 DATA DIVISION.
    25 WORKING-STORAGE SECTION.
    26 01  DFH-START PIC X(04).
    27 01  LCP-TIME-OF-DAY-XX.
    28     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    29     05  FILLER                    PIC 99.
    30 01  LCP-CICS-TIME                 PIC 9(15).
    31 01  LCP-CURRENT-DATE-68.
    32     05  LCP-MONTH                 PIC X(2).
    33     05  FILLER                    PIC X VALUE '/'.
    34     05  LCP-DAY1                  PIC X(2).
    35     05  FILLER                    PIC X VALUE '/'.
    36     05  LCP-YEAR                  PIC X(2).
    37 01  LCP-CICS-DATE                 PIC 9(15).
    38 77  FILLER  PIC X(32)  VALUE '********************************'.
    39 77  FILLER  PIC X(32)  VALUE '*   EL010  WORKING STORAGE     *'.
    40 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.005 *********'.
    41
    42 77  WS-COMM-LENGTH              PIC S9(4)   COMP VALUE +1500.
    43 77  CHANGE-KEY-SW               PIC X.
    44     88  TIME-TO-CHANGE-KEY            VALUE 'X'.
    45
    46 01  LITERALS-NUMBERS.
    47     12  LIT-COMM                PIC X(4)    VALUE '010A'.
    48     12  LIT-BUFF                PIC X(4)    VALUE '010B'.
    49     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
    50     12  THIS-PGM                PIC X(8)    VALUE 'EL010'.
    51     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
    52     12  THIS-TRANS              PIC X(4)    VALUE 'EX99'.
    53
    54     12  ER-7008                 PIC X(4)    VALUE '7008'.
    55     12  ER-0015                 PIC X(4)    VALUE '0015'.
    56     12  ER-0064                 PIC X(4)    VALUE '0064'.
    57     12  ER-0130                 PIC X(4)    VALUE '0130'.
    58     12  ER-0131                 PIC X(4)    VALUE '0131'.
    59     12  ER-0268                 PIC X(4)    VALUE '0268'.
    60
    61     12  QUEUE-KEY.
    62         16  TERM-ID             PIC X(4).
    63         16  SUB-KEY             PIC X(4).
    64     12  COMM-KEY                PIC X(8).
    65     12  BUFFER-KEY              PIC X(8).
    66     12  TRANS-ID                PIC X(4).
    67     12  WCC-CTL                 PIC X       VALUE ' '.
    68     12  COUNT-1                 PIC 99.
    69     12  CHECK-PFKEYS            PIC 99.
    70     12  CALL-PGM                PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL010.cbl
    72 01  FORMATTED-LINE.
    73     12  FILLER                  PIC XX      VALUE SPACES.
    74     12  HOLD-LINE               PIC X(70).
    75     12  FILLER                  PIC X(7)    VALUE SPACES.
    76
    77 01  TIME-UNFORMATTED.
    78     12  UN-HOURS                PIC XX.
    79     12  UN-MINUTES              PIC XX.
    80     12  FILLER                  PIC X(4).
    81
    82 01  TIME-FORMATTED.
    83     12  FOR-HOURS               PIC XX.
    84     12  FILLER                  PIC X       VALUE '.'.
    85     12  FOR-MINUTES             PIC XX.
    86
    87 01  ERROR-SWITCHES.
    88     12  ERROR-SWITCH            PIC X.
    89         88  END-OF-FILE                     VALUE 'E'.
    90         88  SCREEN-FULL                     VALUE 'F'.
    91         88  SCREEN-ERROR                    VALUE 'X'.
    92
    93 01  FILE-READ-KEY.
    94     12  COMPANY-CODE            PIC X.
    95     12  HELP-TYPE               PIC X.
    96     12  ERROR-SCREEN            PIC X(4).
    97     12  HELP-COMPANY            PIC X(3).
    98     12  FILLER                  PIC X(4)    VALUE SPACES.
    99     12  LINE-SEQUENCE           PIC S9(4)   COMP.
   100
   101 01  COMP-LENGTHS.
   102     12  BUFFER-LENGTH           PIC S9(4)   COMP.
   103     12  CURSOR-POS              PIC S9(4)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL010.cbl
   105*    COPY ELCLOGOF.
   106******************************************************************
   107*                                                                *
   108*                                                                *
   109*                            ELCLOGOF.                           *
   110*                            VMOD=2.001                          *
   111*                                                                *
   112*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   113*                                                                *
   114******************************************************************
   115 01  CLASIC-LOGOFF.
   116     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   117     12  LOGOFF-TEXT.
   118         16  FILLER          PIC X(5)    VALUE SPACES.
   119         16  LOGOFF-MSG.
   120             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   121             20  FILLER      PIC X       VALUE SPACES.
   122             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   123         16  FILLER          PIC X(80)
   124           VALUE '* YOU ARE NOW LOGGED OFF'.
   125         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   126         16  FILLER          PIC X       VALUE QUOTE.
   127         16  LOGOFF-SYS-MSG  PIC X(17)
   128           VALUE 'S CLAS-IC SYSTEM '.
   129     12  TEXT-MESSAGES.
   130         16  UNACCESS-MSG    PIC X(29)
   131             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   132         16  PGMIDERR-MSG    PIC X(17)
   133             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL010.cbl
   135*    COPY EL010S.
   136 01  EL010AI.
   137     05  FILLER            PIC  X(0012).
   138*    -------------------------------
   139     05  DATEL PIC S9(0004) COMP.
   140     05  DATEF PIC  X(0001).
   141     05  FILLER REDEFINES DATEF.
   142         10  DATEA PIC  X(0001).
   143     05  DATEI PIC  X(0008).
   144*    -------------------------------
   145     05  TIMEL PIC S9(0004) COMP.
   146     05  TIMEF PIC  X(0001).
   147     05  FILLER REDEFINES TIMEF.
   148         10  TIMEA PIC  X(0001).
   149     05  TIMEI PIC  X(0005).
   150*    -------------------------------
   151     05  SCODEL PIC S9(0004) COMP.
   152     05  SCODEF PIC  X(0001).
   153     05  FILLER REDEFINES SCODEF.
   154         10  SCODEA PIC  X(0001).
   155     05  SCODEI PIC  X(0004).
   156*    -------------------------------
   157     05  ECODEL PIC S9(0004) COMP.
   158     05  ECODEF PIC  X(0001).
   159     05  FILLER REDEFINES ECODEF.
   160         10  ECODEA PIC  X(0001).
   161     05  ECODEI PIC  X(0004).
   162     05  INFOD OCCURS 15  TIMES.
   163*    -------------------------------
   164         10  INFOL PIC S9(0004) COMP.
   165         10  INFOF PIC  X(0001).
   166         10  FILLER REDEFINES INFOF.
   167             15  INFOA PIC  X(0001).
   168         10  INFOI PIC  X(0079).
   169*    -------------------------------
   170     05  MSGL PIC S9(0004) COMP.
   171     05  MSGF PIC  X(0001).
   172     05  FILLER REDEFINES MSGF.
   173         10  MSGA PIC  X(0001).
   174     05  MSGI PIC  X(0075).
   175*    -------------------------------
   176     05  PFKEYL PIC S9(0004) COMP.
   177     05  PFKEYF PIC  X(0001).
   178     05  FILLER REDEFINES PFKEYF.
   179         10  PFKEYA PIC  X(0001).
   180     05  PFKEYI PIC  X(0002).
   181 01  EL010AO REDEFINES EL010AI.
   182     05  FILLER            PIC  X(0012).
   183*    -------------------------------
   184     05  FILLER            PIC  X(0003).
   185     05  DATEO PIC  X(0008).
   186*    -------------------------------
   187     05  FILLER            PIC  X(0003).
   188     05  TIMEO PIC  X(0005).
   189*    -------------------------------
   190     05  FILLER            PIC  X(0003).
   191     05  SCODEO PIC  X(0004).
   192*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL010.cbl
   193     05  FILLER            PIC  X(0003).
   194     05  ECODEO PIC  X(0004).
   195*    -------------------------------
   196     05  INFOD OCCURS 15  TIMES.
   197         10  FILLER        PIC  X(0003).
   198         10  INFOO PIC  X(0079).
   199*    -------------------------------
   200     05  FILLER            PIC  X(0003).
   201     05  MSGO PIC  X(0075).
   202*    -------------------------------
   203     05  FILLER            PIC  X(0003).
   204     05  PFKEYO PIC  X(0002).
   205*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL010.cbl
   207*    COPY ELCAID.
   208******************************************************************
   209*                                                                *
   210*                            ELCAID.                             *
   211*                            VMOD=2.001                          *
   212*                                                                *
   213*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   214*                                                                *
   215*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   216*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   217******************************************************************
   218
   219 01  DFHAID.
   220   02  DFHNULL   PIC  X  VALUE  ' '.
   221   02  DFHENTER  PIC  X  VALUE  QUOTE.
   222   02  DFHCLEAR  PIC  X  VALUE  '_'.
   223   02  DFHPEN    PIC  X  VALUE  '='.
   224   02  DFHOPID   PIC  X  VALUE  'W'.
   225   02  DFHPA1    PIC  X  VALUE  '%'.
   226   02  DFHPA2    PIC  X  VALUE  '>'.
   227   02  DFHPA3    PIC  X  VALUE  ','.
   228   02  DFHPF1    PIC  X  VALUE  '1'.
   229   02  DFHPF2    PIC  X  VALUE  '2'.
   230   02  DFHPF3    PIC  X  VALUE  '3'.
   231   02  DFHPF4    PIC  X  VALUE  '4'.
   232   02  DFHPF5    PIC  X  VALUE  '5'.
   233   02  DFHPF6    PIC  X  VALUE  '6'.
   234   02  DFHPF7    PIC  X  VALUE  '7'.
   235   02  DFHPF8    PIC  X  VALUE  '8'.
   236   02  DFHPF9    PIC  X  VALUE  '9'.
   237   02  DFHPF10   PIC  X  VALUE  ':'.
   238   02  DFHPF11   PIC  X  VALUE  '#'.
   239   02  DFHPF12   PIC  X  VALUE  '@'.
   240   02  DFHPF13   PIC  X  VALUE  'A'.
   241   02  DFHPF14   PIC  X  VALUE  'B'.
   242   02  DFHPF15   PIC  X  VALUE  'C'.
   243   02  DFHPF16   PIC  X  VALUE  'D'.
   244   02  DFHPF17   PIC  X  VALUE  'E'.
   245   02  DFHPF18   PIC  X  VALUE  'F'.
   246   02  DFHPF19   PIC  X  VALUE  'G'.
   247   02  DFHPF20   PIC  X  VALUE  'H'.
   248   02  DFHPF21   PIC  X  VALUE  'I'.
   249*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   250   02  DFHPF22   PIC  X  VALUE  '['.
   251   02  DFHPF23   PIC  X  VALUE  '.'.
   252   02  DFHPF24   PIC  X  VALUE  '<'.
   253   02  DFHMSRE   PIC  X  VALUE  'X'.
   254   02  DFHSTRF   PIC  X  VALUE  'h'.
   255   02  DFHTRIG   PIC  X  VALUE  '"'.
   256 01  FILLER REDEFINES DFHAID.
   257     12  FILLER                  PIC X(8).
   258     12  AID-KEYS OCCURS 24 TIMES.
   259         16  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL010.cbl
   261*    COPY ELCINTF.
   262******************************************************************
   263*                                                                *
   264*                                                                *
   265*                            ELCINTF.                            *
   266*                            VMOD=2.017                          *
   267*                                                                *
   268*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   269*                                                                *
   270*       LENGTH = 1024                                            *
   271*                                                                *
   272******************************************************************
   273 01  PROGRAM-INTERFACE-BLOCK.
   274     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   275     12  PI-CALLING-PROGRAM              PIC X(8).
   276     12  PI-SAVED-PROGRAM-1              PIC X(8).
   277     12  PI-SAVED-PROGRAM-2              PIC X(8).
   278     12  PI-SAVED-PROGRAM-3              PIC X(8).
   279     12  PI-SAVED-PROGRAM-4              PIC X(8).
   280     12  PI-SAVED-PROGRAM-5              PIC X(8).
   281     12  PI-SAVED-PROGRAM-6              PIC X(8).
   282     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   283     12  PI-COMPANY-ID                   PIC XXX.
   284     12  PI-COMPANY-CD                   PIC X.
   285
   286     12  PI-COMPANY-PASSWORD             PIC X(8).
   287
   288     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   289
   290     12  PI-CONTROL-IN-PROGRESS.
   291         16  PI-CARRIER                  PIC X.
   292         16  PI-GROUPING                 PIC X(6).
   293         16  PI-STATE                    PIC XX.
   294         16  PI-ACCOUNT                  PIC X(10).
   295         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   296                                         PIC X(10).
   297         16  PI-CLAIM-CERT-GRP.
   298             20  PI-CLAIM-NO             PIC X(7).
   299             20  PI-CERT-NO.
   300                 25  PI-CERT-PRIME       PIC X(10).
   301                 25  PI-CERT-SFX         PIC X.
   302             20  PI-CERT-EFF-DT          PIC XX.
   303         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   304             20  PI-PLAN-CODE            PIC X(2).
   305             20  PI-REVISION-NUMBER      PIC X(3).
   306             20  PI-PLAN-EFF-DT          PIC X(2).
   307             20  PI-PLAN-EXP-DT          PIC X(2).
   308             20  FILLER                  PIC X(11).
   309         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   310             20  PI-OE-REFERENCE-1.
   311                 25  PI-OE-REF-1-PRIME   PIC X(18).
   312                 25  PI-OE-REF-1-SUFF    PIC XX.
   313
   314     12  PI-SESSION-IN-PROGRESS          PIC X.
   315         88  CLAIM-SESSION                   VALUE '1'.
   316         88  CREDIT-SESSION                  VALUE '2'.
   317         88  WARRANTY-SESSION                VALUE '3'.
   318         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL010.cbl
   319         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   320
   321
   322*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   323
   324     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   325     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   326
   327     12  PI-CREDIT-USER                  PIC X.
   328         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   329         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   330
   331     12  PI-CLAIM-USER                   PIC X.
   332         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   333         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   334
   335     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   336         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   337         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   338         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   339         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   340         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   341
   342     12  PI-PROCESSOR-ID                 PIC X(4).
   343
   344     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   345
   346     12  PI-MEMBER-CAPTION               PIC X(10).
   347
   348     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   349         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   350
   351     12  PI-LIFE-OVERRIDE-L1             PIC X.
   352     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   353     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   354     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   355
   356     12  PI-AH-OVERRIDE-L1               PIC X.
   357     12  PI-AH-OVERRIDE-L2               PIC XX.
   358     12  PI-AH-OVERRIDE-L6               PIC X(6).
   359     12  PI-AH-OVERRIDE-L12              PIC X(12).
   360
   361     12  PI-NEW-SYSTEM                   PIC X(2).
   362
   363     12  PI-PRIMARY-CERT-NO              PIC X(11).
   364     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   365         88  PI-USES-PAID-TO                 VALUE '1'.
   366     12  PI-CRDTCRD-SYSTEM.
   367         16  PI-CRDTCRD-USER             PIC X.
   368             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   369             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   370         16  PI-CC-MONTH-END-DT          PIC XX.
   371     12  PI-PROCESSOR-PRINTER            PIC X(4).
   372
   373     12  PI-OE-REFERENCE-2.
   374         16  PI-OE-REF-2-PRIME           PIC X(10).
   375         16  PI-OE-REF-2-SUFF            PIC X.
   376
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL010.cbl
   377     12  PI-REM-TRM-CALC-OPTION          PIC X.
   378
   379     12  PI-LANGUAGE-TYPE                PIC X.
   380             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   381             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   382             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   383
   384     12  PI-POLICY-LINKAGE-IND           PIC X.
   385         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   386         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   387                                                   LOW-VALUES.
   388
   389     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   390     12  PI-CLAIM-PW-SESSION             PIC X(1).
   391         88  PI-CLAIM-CREDIT                 VALUE '1'.
   392         88  PI-CLAIM-CONVEN                 VALUE '2'.
   393     12  FILLER                          PIC X(4).
   394
   395     12  PI-SYSTEM-LEVEL                 PIC X(145).
   396
   397     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   398         PI-SYSTEM-LEVEL.
   399
   400         16  PI-ENTRY-CODES.
   401             20  PI-ENTRY-CD-1           PIC X.
   402             20  PI-ENTRY-CD-2           PIC X.
   403
   404         16  PI-RETURN-CODES.
   405             20  PI-RETURN-CD-1          PIC X.
   406             20  PI-RETURN-CD-2          PIC X.
   407
   408         16  PI-UPDATE-STATUS-SAVE.
   409             20  PI-UPDATE-BY            PIC X(4).
   410             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   411
   412         16  PI-LOWER-CASE-LETTERS       PIC X.
   413             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   414
   415*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   416*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   417*            88  CARRIER-CLM-CNTL            VALUE '2'.
   418
   419         16  PI-CERT-ACCESS-CONTROL      PIC X.
   420             88  ST-ACCNT-CNTL               VALUE ' '.
   421             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   422             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   423             88  ACCNT-CNTL                  VALUE '3'.
   424             88  CARR-ACCNT-CNTL             VALUE '4'.
   425
   426         16  PI-PROCESSOR-CAP-LIST.
   427             20  PI-SYSTEM-CONTROLS.
   428                24 PI-SYSTEM-DISPLAY     PIC X.
   429                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   430                24 PI-SYSTEM-MODIFY      PIC X.
   431                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   432             20  FILLER                  PIC XX.
   433             20  PI-DISPLAY-CAP          PIC X.
   434                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL010.cbl
   435             20  PI-MODIFY-CAP           PIC X.
   436                 88  MODIFY-CAP              VALUE 'Y'.
   437             20  PI-MSG-AT-LOGON-CAP     PIC X.
   438                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   439             20  PI-FORCE-CAP            PIC X.
   440                 88  FORCE-CAP               VALUE 'Y'.
   441
   442         16  PI-PROGRAM-CONTROLS.
   443             20  PI-PGM-PRINT-OPT        PIC X.
   444             20  PI-PGM-FORMAT-OPT       PIC X.
   445             20  PI-PGM-PROCESS-OPT      PIC X.
   446             20  PI-PGM-TOTALS-OPT       PIC X.
   447
   448         16  PI-HELP-INTERFACE.
   449             20  PI-LAST-ERROR-NO        PIC X(4).
   450             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   451
   452         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   453             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   454
   455         16  PI-CR-CONTROL-IN-PROGRESS.
   456             20  PI-CR-CARRIER           PIC X.
   457             20  PI-CR-GROUPING          PIC X(6).
   458             20  PI-CR-STATE             PIC XX.
   459             20  PI-CR-ACCOUNT           PIC X(10).
   460             20  PI-CR-FIN-RESP          PIC X(10).
   461             20  PI-CR-TYPE              PIC X.
   462
   463         16  PI-CR-BATCH-NUMBER          PIC X(6).
   464
   465         16  PI-CR-MONTH-END-DT          PIC XX.
   466
   467         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   468             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   469             88  PI-ZERO-CARRIER             VALUE '1'.
   470             88  PI-ZERO-GROUPING            VALUE '2'.
   471             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   472
   473         16  PI-CARRIER-SECURITY         PIC X.
   474             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   475
   476         16  PI-ACCOUNT-SECURITY         PIC X(10).
   477             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   478             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   479
   480         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   481             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   482                                         INDEXED BY PI-ACCESS-NDX
   483                                         PIC X.
   484
   485         16  PI-GA-BILLING-CONTROL       PIC X.
   486             88  PI-GA-BILLING               VALUE '1'.
   487
   488         16  PI-MAIL-PROCESSING          PIC X.
   489             88  PI-MAIL-YES                 VALUE 'Y'.
   490
   491         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   492
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL010.cbl
   493         16  PI-AR-SYSTEM.
   494             20  PI-AR-PROCESSING-CNTL   PIC X.
   495                 88  PI-AR-PROCESSING        VALUE 'Y'.
   496             20  PI-AR-SUMMARY-CODE      PIC X(6).
   497             20  PI-AR-MONTH-END-DT      PIC XX.
   498
   499         16  PI-MP-SYSTEM.
   500             20  PI-MORTGAGE-USER            PIC X.
   501                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   502                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   503             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   504                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   505                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   506                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   507                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   508                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   509             20  PI-MP-MONTH-END-DT          PIC XX.
   510             20  PI-MP-REFERENCE-NO.
   511                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   512                 24  PI-MP-REFERENCE-SFX     PIC XX.
   513
   514         16  PI-LABEL-CONTROL            PIC X(01).
   515             88  PI-CREATE-LABELS                    VALUE 'Y'.
   516             88  PI-BYPASS-LABELS                    VALUE 'N'.
   517
   518         16  PI-BILL-GROUPING-CODE       PIC X(01).
   519             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   520
   521         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   522             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   523             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   524
   525         16  FILLER                      PIC X(14).
   526
   527     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   528******************************************************************
   529     12  EL010-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
   530         16  PI-CALLING-TRANS    PIC X(4).
   531         16  SAVE-CURSOR         PIC S9(4)   COMP.
   532         16  SAVE-KEY.
   533             20  SAVE-COMPANY-CD PIC X.
   534             20  SAVE-HELP-TYPE  PIC X.
   535             20  SAVE-CONTROL    PIC X(4).
   536             20  FILLER          PIC X(7).
   537             20  SAVE-LINE       PIC S9(4)   COMP.
   538         16  EOF-SWITCH          PIC X.
   539             88  LAST-REC-NOT-FOUND          VALUE 'W'.
   540             88  TOP-OF-FILE                 VALUE 'X'.
   541             88  BOTTOM-OF-FILE              VALUE 'Y'.
   542             88  BAD-BROWSE                  VALUE 'Z'.
   543         16  FILLER              PIC X(618).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL010.cbl
   545*    COPY ELCEMIB.
   546******************************************************************
   547*                                                                *
   548*                                                                *
   549*                            ELCEMIB.                            *
   550*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   551*                            VMOD=2.005                          *
   552*                                                                *
   553*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   554*                                                                *
   555******************************************************************
   556 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   557     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   558     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   559     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   560     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   561     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   562     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   563     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   564     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   565     12  EMI-SWITCH1             PIC X        VALUE '1'.
   566         88  EMI-NO-ERRORS                    VALUE '1'.
   567         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   568         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   569     12  EMI-SWITCH2             PIC X        VALUE '1'.
   570         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   571     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   572         88  EMI-AREA1-EMPTY                  VALUE '1'.
   573         88  EMI-AREA1-FULL                   VALUE '2'.
   574     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   575         88  EMI-AREA2-EMPTY                  VALUE '1'.
   576         88  EMI-AREA2-FULL                   VALUE '2'.
   577     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   578         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   579         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   580         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   581         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   582         88  EMI-BYPASS-FATALS                VALUE 'X'.
   583     12  EMI-ERROR-LINES.
   584         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   585         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   586         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   587         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   588             20  EMI-ERR-CODES OCCURS 10 TIMES.
   589                 24  EMI-ERR-NUM         PIC X(4).
   590                 24  EMI-FILLER          PIC X.
   591                 24  EMI-SEV             PIC X.
   592                 24  FILLER              PIC X.
   593             20  FILLER                  PIC X(02).
   594     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   595         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   596             20  EMI-ERROR-NUMBER    PIC X(4).
   597             20  EMI-FILL            PIC X.
   598             20  EMI-SEVERITY        PIC X.
   599             20  FILLER              PIC X.
   600             20  EMI-ERROR-TEXT.
   601                 24  EMI-TEXT-VARIABLE   PIC X(10).
   602                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL010.cbl
   603     12  EMI-SEVERITY-SAVE           PIC X.
   604         88  EMI-NOTE                    VALUE 'N'.
   605         88  EMI-WARNING                 VALUE 'W'.
   606         88  EMI-FORCABLE                VALUE 'F'.
   607         88  EMI-FATAL                   VALUE 'X'.
   608     12  EMI-MESSAGE-FLAG            PIC X.
   609         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   610         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   611     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   612     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   613         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   614         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   615         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   616     12  FILLER                      PIC X(137)  VALUE SPACES.
   617     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   618     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   619     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   620     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL010.cbl
   622****************************************************************
   623*
   624* Copyright (c) 2007 by Clerity Solutions, Inc.
   625* All rights reserved.
   626*
   627****************************************************************
   628 01  DFHEIV.
   629   02  DFHEIV0               PIC X(35).
   630   02  DFHEIV1               PIC X(08).
   631   02  DFHEIV2               PIC X(08).
   632   02  DFHEIV3               PIC X(08).
   633   02  DFHEIV4               PIC X(06).
   634   02  DFHEIV5               PIC X(04).
   635   02  DFHEIV6               PIC X(04).
   636   02  DFHEIV7               PIC X(02).
   637   02  DFHEIV8               PIC X(02).
   638   02  DFHEIV9               PIC X(01).
   639   02  DFHEIV10              PIC S9(7) COMP-3.
   640   02  DFHEIV11              PIC S9(4) COMP SYNC.
   641   02  DFHEIV12              PIC S9(4) COMP SYNC.
   642   02  DFHEIV13              PIC S9(4) COMP SYNC.
   643   02  DFHEIV14              PIC S9(4) COMP SYNC.
   644   02  DFHEIV15              PIC S9(4) COMP SYNC.
   645   02  DFHEIV16              PIC S9(9) COMP SYNC.
   646   02  DFHEIV17              PIC X(04).
   647   02  DFHEIV18              PIC X(04).
   648   02  DFHEIV19              PIC X(04).
   649   02  DFHEIV20              USAGE IS POINTER.
   650   02  DFHEIV21              USAGE IS POINTER.
   651   02  DFHEIV22              USAGE IS POINTER.
   652   02  DFHEIV23              USAGE IS POINTER.
   653   02  DFHEIV24              USAGE IS POINTER.
   654   02  DFHEIV25              PIC S9(9) COMP SYNC.
   655   02  DFHEIV26              PIC S9(9) COMP SYNC.
   656   02  DFHEIV27              PIC S9(9) COMP SYNC.
   657   02  DFHEIV28              PIC S9(9) COMP SYNC.
   658   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   659   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   660   02  FILLER                PIC X(02).
   661   02  DFHEIV99              PIC X(08) VALUE SPACE.
   662   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   663   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   664   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   665   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   666 LINKAGE  SECTION.
   667*****************************************************************
   668*                                                               *
   669* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   670* All rights reserved.                                          *
   671*                                                               *
   672*****************************************************************
   673 01  dfheiblk.
   674     02  eibtime          pic s9(7) comp-3.
   675     02  eibdate          pic s9(7) comp-3.
   676     02  eibtrnid         pic x(4).
   677     02  eibtaskn         pic s9(7) comp-3.
   678     02  eibtrmid         pic x(4).
   679     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL010.cbl
   680     02  eibcposn         pic s9(4) comp.
   681     02  eibcalen         pic s9(4) comp.
   682     02  eibaid           pic x(1).
   683     02  eibfiller1       pic x(1).
   684     02  eibfn            pic x(2).
   685     02  eibfiller2       pic x(2).
   686     02  eibrcode         pic x(6).
   687     02  eibfiller3       pic x(2).
   688     02  eibds            pic x(8).
   689     02  eibreqid         pic x(8).
   690     02  eibrsrce         pic x(8).
   691     02  eibsync          pic x(1).
   692     02  eibfree          pic x(1).
   693     02  eibrecv          pic x(1).
   694     02  eibsend          pic x(1).
   695     02  eibatt           pic x(1).
   696     02  eibeoc           pic x(1).
   697     02  eibfmh           pic x(1).
   698     02  eibcompl         pic x(1).
   699     02  eibsig           pic x(1).
   700     02  eibconf          pic x(1).
   701     02  eiberr           pic x(1).
   702     02  eibrldbk         pic x(1).
   703     02  eiberrcd         pic x(4).
   704     02  eibsynrb         pic x(1).
   705     02  eibnodat         pic x(1).
   706     02  eibfiller5       pic x(2).
   707     02  eibresp          pic 9(09) comp.
   708     02  eibresp2         pic 9(09) comp.
   709     02  dfheigdj         pic s9(4) comp.
   710     02  dfheigdk         pic s9(4) comp.
   711 01  DFHCOMMAREA                 PIC X(1500).
   712
   713*01 PARM-LIST .
   714*    12  FILLER                  PIC S9(8)   COMP.
   715*    12  HELP-PNT                PIC S9(8)   COMP.
   716*    12  BUFF-PNT                PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL010.cbl
   718*    COPY ELCTEXT.
   719******************************************************************
   720*                                                                *
   721*                                                                *
   722*                            ELCTEXT.                            *
   723*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   724*                            VMOD=2.008                          *
   725*                                                                *
   726*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   727*                                     FORM LETTERS,              *
   728*                                     CERT FORM DISPLAY.
   729*                                                                *
   730*   FILE TYPE = VSAM,KSDS                                        *
   731*   RECORD SIZE = 100   RECFORM = FIXED                          *
   732*                                                                *
   733*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   734*       ALTERNATE INDEX = NONE                                   *
   735*                                                                *
   736*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   737*       ALTERNATE INDEX = NONE                                   *
   738*                                                                *
   739*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   740*       ALTERNATE INDEX = NONE                                   *
   741*                                                                *
   742*   LOG = NO                                                     *
   743*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   744******************************************************************
   745 01  TEXT-FILES.
   746     12  TEXT-FILE-ID                PIC XX.
   747         88  FORMS-FILE-TEXT            VALUE 'TF'.
   748         88  LETTER-FILE-TEXT           VALUE 'TL'.
   749         88  HELP-FILE-TEXT             VALUE 'TH'.
   750
   751     12  TX-CONTROL-PRIMARY.
   752         16  TX-COMPANY-CD           PIC X.
   753             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   754         16  TX-ACCESS-CD-GENL       PIC X(12).
   755
   756         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   757             20  TX-LETTER-NO        PIC X(4).
   758             20  FILLER              PIC X(8).
   759
   760         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   761             20  TX-FORM-NO          PIC X(12).
   762
   763         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   764             20  TX-HELP-TYPE        PIC X.
   765                 88  HELP-FOR-GENERAL   VALUE ' '.
   766                 88  HELP-BY-SCREEN     VALUE 'S'.
   767                 88  HELP-BY-ERROR      VALUE 'E'.
   768             20  TX-SCREEN-OR-ERROR  PIC X(4).
   769                 88  GENERAL-INFO-HELP  VALUE '0000'.
   770             20  TX-HELP-FOR-COMPANY  PIC XXX.
   771                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   772             20  FILLER              PIC X(4).
   773
   774         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   775
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL010.cbl
   776     12  TX-PROCESS-CONTROL          PIC XX.
   777         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   778
   779     12  TX-TEXT-LINE                PIC X(70).
   780
   781     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   782         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   783         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   784         88  TX-VALID-FORM-SQUEEZE-VALUE
   785                                        VALUE 'Y' ' '.
   786
   787     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   788         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   789         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   790         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   791         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   792         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   793         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   794         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   795                                              'K' 'N' ' '
   796                                              'Z'.
   797
   798     12  TX-ARCHIVE-SW               PIC X.
   799         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   800         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   801         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   802
   803     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   804     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   805
   806     12  TX-BSR-CODE                 PIC X.
   807         88  TX-BSR-LETTER              VALUE 'B'.
   808         88  TX-NON-BSR-LETTER          VALUE ' '.
   809
   810     12  FILLER                      PIC X.
   811*****************************************************************
   812
   813 01  BUFFER-AREA                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL010.cbl
   815 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA TEXT-FILES
   816                          BUFFER-AREA.
   817 0000-DFHEXIT SECTION.
   818     MOVE '9#                    $   ' TO DFHEIV0.
   819     MOVE 'EL010' TO DFHEIV1.
   820     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   821
   822     IF EIBCALEN = ZERO
   823         GO TO 8800-UNAUTHORIZED-ACCESS.
   824
   825     MOVE THIS-TRANS             TO TRANS-ID.
   826     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
   827
   828     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
   829         MOVE LOW-VALUES         TO EL010AO
   830         MOVE ER-7008            TO EMI-ERROR
   831         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
   832         GO TO 8110-SEND-DATA.
   833
   834     MOVE SPACES                 TO CHANGE-KEY-SW.
   835
   836     IF PI-CALLING-PROGRAM NOT = THIS-PGM
   837         GO TO 0100-SAVE-BUFFER.
   838
   839     IF EIBAID = DFHCLEAR
   840         GO TO 0200-RESTORE-BUFFER.
   841
   842
   843* EXEC CICS HANDLE CONDITION
   844*        PGMIDERR  (8820-XCTL-ERROR)
   845*        MAPFAIL   (0050-MAPFAIL-HANDLE)
   846*        ERROR     (9990-ABEND)
   847*    END-EXEC.
   848*    MOVE '"$L?.                 ! " #00000838' TO DFHEIV0
   849     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
   850     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
   851     MOVE X'2220233030303030383338' TO DFHEIV0(25:11)
   852     CALL 'kxdfhei1' USING DFHEIV0
   853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   854
   855
   856
   857* EXEC CICS RECEIVE
   858*        MAP       ('EL010A')
   859*        MAPSET    ('EL010S')
   860*    END-EXEC.
   861     MOVE 'EL010A' TO DFHEIV1
   862     MOVE 'EL010S' TO DFHEIV2
   863*    MOVE '8"T                   ''   #00000844' TO DFHEIV0
   864     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
   865     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
   866     MOVE X'2020233030303030383434' TO DFHEIV0(25:11)
   867     CALL 'kxdfhei1' USING DFHEIV0,
   868           DFHEIV1,
   869           EL010AI,
   870           DFHEIV99,
   871           DFHEIV2,
   872           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL010.cbl
   873           DFHEIV99
   874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   875
   876
   877     MOVE SPACES                 TO ERROR-SWITCHES.
   878
   879     IF PFKEYL GREATER THAN ZERO
   880         PERFORM 0300-TRANS-PF THRU 0310-TRANS-PF-EXIT.
   881
   882     IF SCREEN-ERROR
   883         MOVE ER-7008            TO EMI-ERROR
   884         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
   885         GO TO 8110-SEND-DATA.
   886
   887     IF EIBAID = DFHPF1 OR DFHPF3
   888         GO TO 2000-BROWSE-FORWARD.
   889
   890     IF EIBAID = DFHPF2 OR DFHPF4
   891         GO TO 2100-BROWSE-BACKWARD.
   892
   893     IF EIBAID = DFHPF7
   894        MOVE SPACES              TO FILE-READ-KEY
   895        MOVE PI-COMPANY-CD       TO COMPANY-CODE
   896         GO TO 2600-USER-NOTES.
   897
   898     IF EIBAID = DFHPF5
   899        MOVE SPACES              TO FILE-READ-KEY
   900        MOVE LOW-VALUES          TO COMPANY-CODE
   901         GO TO 2400-SKIP-TO-SCREEN.
   902
   903     IF EIBAID = DFHPF6
   904        MOVE SPACES              TO FILE-READ-KEY
   905        MOVE LOW-VALUES          TO COMPANY-CODE
   906         GO TO 2500-SKIP-TO-ERROR.
   907
   908     MOVE ER-7008                TO EMI-ERROR.
   909     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
   910     GO TO 8110-SEND-DATA.
   911
   912
   913 0050-MAPFAIL-HANDLE.
   914     MOVE LOW-VALUES             TO EL010AO.
   915     MOVE 'Y'                    TO EOF-SWITCH.
   916     GO TO 2000-BROWSE-FORWARD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL010.cbl
   918
   919 0100-SAVE-BUFFER.
   920     MOVE EIBTRMID               TO TERM-ID.
   921     MOVE LIT-COMM               TO SUB-KEY.
   922     MOVE QUEUE-KEY              TO COMM-KEY.
   923     MOVE LIT-BUFF               TO SUB-KEY.
   924     MOVE QUEUE-KEY              TO BUFFER-KEY.
   925
   926     PERFORM 0400-DELETE-TS THRU 0420-DELETE-TS-EXIT.
   927
   928
   929* EXEC CICS WRITEQ TS
   930*        QUEUE   (COMM-KEY)
   931*        FROM    (PROGRAM-INTERFACE-BLOCK)
   932*        LENGTH  (WS-COMM-LENGTH)
   933*    END-EXEC.
   934*    MOVE '*"                    ''   #00000900' TO DFHEIV0
   935     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
   936     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
   937     MOVE X'2020233030303030393030' TO DFHEIV0(25:11)
   938     CALL 'kxdfhei1' USING DFHEIV0,
   939           COMM-KEY,
   940           PROGRAM-INTERFACE-BLOCK,
   941           WS-COMM-LENGTH,
   942           DFHEIV99,
   943           DFHEIV99,
   944           DFHEIV99
   945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   946
   947
   948     MOVE EIBTRNID               TO PI-CALLING-TRANS.
   949     MOVE EIBCPOSN               TO SAVE-CURSOR.
   950
   951
   952* EXEC CICS RECEIVE
   953*        SET     (ADDRESS OF BUFFER-AREA)
   954*        LENGTH  (BUFFER-LENGTH)
   955*        BUFFER
   956*    END-EXEC.
   957*    MOVE '$"S B  L              ''   #00000909' TO DFHEIV0
   958     MOVE X'242253204220204C20202020' TO DFHEIV0(1:12)
   959     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
   960     MOVE X'2020233030303030393039' TO DFHEIV0(25:11)
   961     CALL 'kxdfhei1' USING DFHEIV0,
   962           DFHEIV20,
   963           BUFFER-LENGTH,
   964           DFHEIV99,
   965           DFHEIV99,
   966           DFHEIV99,
   967           DFHEIV99
   968     SET ADDRESS OF BUFFER-AREA TO
   969         DFHEIV20
   970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   971
   972
   973
   974* EXEC CICS WRITEQ TS
   975*        QUEUE   (BUFFER-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL010.cbl
   976*        FROM    (BUFFER-AREA)
   977*        LENGTH  (BUFFER-LENGTH)
   978*    END-EXEC.
   979*    MOVE '*"                    ''   #00000915' TO DFHEIV0
   980     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
   981     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
   982     MOVE X'2020233030303030393135' TO DFHEIV0(25:11)
   983     CALL 'kxdfhei1' USING DFHEIV0,
   984           BUFFER-KEY,
   985           BUFFER-AREA,
   986           BUFFER-LENGTH,
   987           DFHEIV99,
   988           DFHEIV99,
   989           DFHEIV99
   990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   991
   992
   993     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
   994     MOVE LOW-VALUES             TO EL010AO.
   995     INSPECT PI-CURRENT-SCREEN-NO CONVERTING 'S' TO 'A'.
   996     MOVE PI-CURRENT-SCREEN-NO   TO SCODEO.
   997     MOVE PI-LAST-ERROR-NO       TO ECODEO.
   998
   999     MOVE SPACES                 TO FILE-READ-KEY
  1000     MOVE LOW-VALUES             TO COMPANY-CODE
  1001     GO TO  2400-SKIP-TO-SCREEN.
  1002
  1003*    IF PI-LAST-ERROR-NO = SPACES OR = ZEROS
  1004*       MOVE SPACES              TO FILE-READ-KEY
  1005*       MOVE LOW-VALUES          TO COMPANY-CODE
  1006*        GO TO  2400-SKIP-TO-SCREEN.
  1007*
  1008*    MOVE SPACES                 TO FILE-READ-KEY
  1009*    MOVE LOW-VALUES             TO COMPANY-CODE
  1010*    GO TO  2500-SKIP-TO-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL010.cbl
  1012 0200-RESTORE-BUFFER.
  1013     MOVE PI-CALLING-TRANS       TO TRANS-ID.
  1014     MOVE SAVE-CURSOR            TO CURSOR-POS.
  1015     MOVE EIBTRMID               TO TERM-ID.
  1016     MOVE LIT-COMM               TO SUB-KEY.
  1017     MOVE QUEUE-KEY              TO COMM-KEY.
  1018     MOVE LIT-BUFF               TO SUB-KEY.
  1019     MOVE QUEUE-KEY              TO BUFFER-KEY.
  1020
  1021
  1022* EXEC CICS READQ TS
  1023*        QUEUE   (COMM-KEY)
  1024*        INTO    (PROGRAM-INTERFACE-BLOCK)
  1025*        LENGTH  (WS-COMM-LENGTH)
  1026*    END-EXEC.
  1027*    MOVE '*$I    L              ''   #00000949' TO DFHEIV0
  1028     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  1029     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1030     MOVE X'2020233030303030393439' TO DFHEIV0(25:11)
  1031     CALL 'kxdfhei1' USING DFHEIV0,
  1032           COMM-KEY,
  1033           PROGRAM-INTERFACE-BLOCK,
  1034           WS-COMM-LENGTH,
  1035           DFHEIV99,
  1036           DFHEIV99,
  1037           DFHEIV99
  1038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1039
  1040
  1041
  1042* EXEC CICS READQ TS
  1043*        QUEUE   (BUFFER-KEY)
  1044*        SET     (ADDRESS OF BUFFER-AREA)
  1045*        LENGTH  (BUFFER-LENGTH)
  1046*    END-EXEC.
  1047*    MOVE '*$S    L              ''   #00000955' TO DFHEIV0
  1048     MOVE X'2A2453202020204C20202020' TO DFHEIV0(1:12)
  1049     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1050     MOVE X'2020233030303030393535' TO DFHEIV0(25:11)
  1051     CALL 'kxdfhei1' USING DFHEIV0,
  1052           BUFFER-KEY,
  1053           DFHEIV20,
  1054           BUFFER-LENGTH,
  1055           DFHEIV99,
  1056           DFHEIV99,
  1057           DFHEIV99
  1058     SET ADDRESS OF BUFFER-AREA TO
  1059         DFHEIV20
  1060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1061
  1062
  1063
  1064* EXEC CICS SEND
  1065*        FROM     (BUFFER-AREA)
  1066*        LENGTH   (BUFFER-LENGTH)
  1067*        CTLCHAR  (WCC-CTL)
  1068*    END-EXEC.
  1069*    MOVE '$$    C           L F ,   #00000961' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL010.cbl
  1070     MOVE X'242420202020432020202020' TO DFHEIV0(1:12)
  1071     MOVE X'2020202020204C2046202C20' TO DFHEIV0(13:12)
  1072     MOVE X'2020233030303030393631' TO DFHEIV0(25:11)
  1073     CALL 'kxdfhei1' USING DFHEIV0,
  1074           BUFFER-AREA,
  1075           BUFFER-LENGTH,
  1076           DFHEIV99,
  1077           DFHEIV99,
  1078           WCC-CTL,
  1079           DFHEIV99,
  1080           DFHEIV99,
  1081           DFHEIV99,
  1082           DFHEIV99,
  1083           DFHEIV99,
  1084           DFHEIV99
  1085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1086
  1087
  1088     MOVE LOW-VALUES             TO EL010AO.
  1089
  1090
  1091* EXEC CICS SEND
  1092*        MAP      ('EL010A')
  1093*        MAPSET   ('EL010S')
  1094*        CURSOR   (CURSOR-POS)
  1095*        DATAONLY
  1096*        FREEKB
  1097*    END-EXEC.
  1098     MOVE 'EL010A' TO DFHEIV1
  1099     MOVE 'EL010S' TO DFHEIV2
  1100*    MOVE '8$D    CT    F  H     ,   #00000969' TO DFHEIV0
  1101     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  1102     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
  1103     MOVE X'2020233030303030393639' TO DFHEIV0(25:11)
  1104     CALL 'kxdfhei1' USING DFHEIV0,
  1105           DFHEIV1,
  1106           EL010AO,
  1107           DFHEIV99,
  1108           DFHEIV2,
  1109           DFHEIV99,
  1110           DFHEIV99,
  1111           DFHEIV99,
  1112           CURSOR-POS,
  1113           DFHEIV99,
  1114           DFHEIV99,
  1115           DFHEIV99
  1116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1117
  1118
  1119     PERFORM 0400-DELETE-TS THRU 0420-DELETE-TS-EXIT.
  1120
  1121     GO TO 9000-RETURN-TRANS.
  1122
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL010.cbl
  1124 0300-TRANS-PF.
  1125     IF PFKEYI LESS 1 OR GREATER 24
  1126         MOVE 'X'                TO ERROR-SWITCH
  1127         GO TO 0310-TRANS-PF-EXIT.
  1128
  1129     MOVE PFKEYI                 TO CHECK-PFKEYS.
  1130     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  1131
  1132 0310-TRANS-PF-EXIT.
  1133     EXIT.
  1134
  1135 0400-DELETE-TS.
  1136
  1137* EXEC CICS HANDLE CONDITION
  1138*        QIDERR (0410-BUFF-KEY-NOT-FOUND)
  1139*    END-EXEC.
  1140*    MOVE '"$N                   ! # #00000994' TO DFHEIV0
  1141     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  1142     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1143     MOVE X'2320233030303030393934' TO DFHEIV0(25:11)
  1144     CALL 'kxdfhei1' USING DFHEIV0
  1145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1146
  1147
  1148
  1149* EXEC CICS DELETEQ TS
  1150*        QUEUE (BUFFER-KEY)
  1151*    END-EXEC.
  1152*    MOVE '*&                    #   #00000998' TO DFHEIV0
  1153     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  1154     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1155     MOVE X'2020233030303030393938' TO DFHEIV0(25:11)
  1156     CALL 'kxdfhei1' USING DFHEIV0,
  1157           BUFFER-KEY,
  1158           DFHEIV99
  1159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1160
  1161
  1162 0410-BUFF-KEY-NOT-FOUND.
  1163
  1164* EXEC CICS HANDLE CONDITION
  1165*        QIDERR (0420-DELETE-TS-EXIT)
  1166*    END-EXEC.
  1167*    MOVE '"$N                   ! $ #00001003' TO DFHEIV0
  1168     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  1169     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1170     MOVE X'2420233030303031303033' TO DFHEIV0(25:11)
  1171     CALL 'kxdfhei1' USING DFHEIV0
  1172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1173
  1174
  1175
  1176* EXEC CICS DELETEQ TS
  1177*        QUEUE (COMM-KEY)
  1178*    END-EXEC.
  1179*    MOVE '*&                    #   #00001007' TO DFHEIV0
  1180     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  1181     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL010.cbl
  1182     MOVE X'2020233030303031303037' TO DFHEIV0(25:11)
  1183     CALL 'kxdfhei1' USING DFHEIV0,
  1184           COMM-KEY,
  1185           DFHEIV99
  1186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1187
  1188
  1189 0420-DELETE-TS-EXIT.
  1190     EXIT.
  1191
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL010.cbl
  1193 2000-BROWSE-FORWARD.
  1194     IF BOTTOM-OF-FILE
  1195         MOVE ER-0130            TO EMI-ERROR
  1196         PERFORM 9900-ERROR-FORMAT
  1197             THRU 9900-EXIT
  1198        GO TO 8110-SEND-DATA.
  1199
  1200     MOVE SPACE                  TO EOF-SWITCH.
  1201
  1202     IF EIBAID = DFHPF1
  1203        ADD 15                   TO SAVE-LINE
  1204     ELSE
  1205        ADD 5                    TO SAVE-LINE.
  1206
  1207     MOVE SAVE-KEY               TO FILE-READ-KEY.
  1208
  1209 2010-SKIP-ADD.
  1210     MOVE 1                      TO COUNT-1
  1211     MOVE SPACES                 TO ERROR-SWITCH FORMATTED-LINE.
  1212
  1213     PERFORM 4000-START-BROWSE THRU 4010-START-BROWSE-EXIT.
  1214
  1215     IF BAD-BROWSE
  1216        MOVE ER-0064             TO EMI-ERROR
  1217        PERFORM 9900-ERROR-FORMAT
  1218           THRU 9900-EXIT
  1219        MOVE 'W'                 TO EOF-SWITCH
  1220        PERFORM 3100-FILL-SCREEN THRU 3110-FILL-SCREEN-EXIT
  1221             VARYING COUNT-1 FROM 1 BY 1 UNTIL COUNT-1 GREATER 15
  1222        GO TO 8110-SEND-DATA.
  1223
  1224     PERFORM 4020-READ-FILE THRU 4040-READ-FILE-EXIT.
  1225
  1226     IF (EIBTRNID NOT = THIS-TRANS OR EIBAID = DFHPF5
  1227        OR EIBAID = DFHPF6 OR EIBAID = DFHPF7)
  1228          AND ERROR-SCREEN NOT = SAVE-CONTROL
  1229        MOVE ER-0064             TO EMI-ERROR
  1230        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1231        MOVE 'W'                 TO EOF-SWITCH
  1232        PERFORM 3100-FILL-SCREEN THRU 3110-FILL-SCREEN-EXIT
  1233              VARYING COUNT-1 FROM 1 BY 1 UNTIL COUNT-1 GREATER 15
  1234        GO TO 8110-SEND-DATA.
  1235
  1236     IF END-OF-FILE
  1237        GO TO 2020-END-FILE.
  1238
  1239     MOVE FILE-READ-KEY          TO SAVE-KEY.
  1240
  1241     IF HELP-BY-SCREEN
  1242        MOVE ERROR-SCREEN        TO SCODEO
  1243     ELSE
  1244        IF HELP-BY-ERROR
  1245           MOVE ERROR-SCREEN     TO ECODEO
  1246        ELSE
  1247           MOVE SPACES           TO ECODEO  SCODEO.
  1248
  1249     PERFORM 3000-BUILD-SCREEN THRU 3010-BUILD-SCREEN-EXIT
  1250         VARYING COUNT-1 FROM 1 BY 1 UNTIL COUNT-1 GREATER 15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL010.cbl
  1251                 OR END-OF-FILE.
  1252
  1253 2020-END-FILE.
  1254     IF END-OF-FILE
  1255         PERFORM 3100-FILL-SCREEN THRU 3110-FILL-SCREEN-EXIT
  1256       VARYING COUNT-1 FROM COUNT-1 BY 1 UNTIL COUNT-1 GREATER 15.
  1257
  1258     PERFORM 4050-END-BROWSE THRU 4060-END-BROWSE-EXIT.
  1259     GO TO 8110-SEND-DATA.
  1260
  1261 2100-BROWSE-BACKWARD.
  1262     IF TOP-OF-FILE
  1263         MOVE ER-0131            TO EMI-ERROR
  1264         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1265         GO TO 8110-SEND-DATA.
  1266
  1267     IF LAST-REC-NOT-FOUND
  1268         MOVE ER-0268            TO EMI-ERROR
  1269         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1270         GO TO 8110-SEND-DATA.
  1271
  1272     MOVE SPACE TO EOF-SWITCH.
  1273
  1274     IF SAVE-LINE = 1 OR ZEROS
  1275         GO TO 2200-NEW-SCREEN.
  1276
  1277     IF EIBAID = DFHPF2
  1278        SUBTRACT 15                   FROM SAVE-LINE
  1279     ELSE
  1280        SUBTRACT 5                    FROM SAVE-LINE.
  1281
  1282     IF SAVE-LINE LESS ZERO
  1283         MOVE ZEROES             TO SAVE-LINE.
  1284
  1285     MOVE SAVE-KEY               TO FILE-READ-KEY.
  1286     GO TO 2010-SKIP-ADD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL010.cbl
  1288 2200-NEW-SCREEN.
  1289     MOVE SAVE-KEY               TO FILE-READ-KEY.
  1290     PERFORM 4000-START-BROWSE THRU 4010-START-BROWSE-EXIT.
  1291     PERFORM 4070-READ-PREV THRU 4090-READ-PREV-EXIT
  1292     PERFORM 4070-READ-PREV THRU 4090-READ-PREV-EXIT.
  1293
  1294     IF SAVE-COMPANY-CD NOT = COMPANY-CODE
  1295         MOVE ER-0131            TO EMI-ERROR
  1296         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1297         GO TO 8110-SEND-DATA.
  1298
  1299     IF END-OF-FILE
  1300        MOVE LOW-VALUES          TO ERROR-SCREEN.
  1301
  1302     MOVE ZEROS                  TO LINE-SEQUENCE.
  1303     MOVE FILE-READ-KEY          TO SAVE-KEY.
  1304     PERFORM 4050-END-BROWSE  THRU 4060-END-BROWSE-EXIT.
  1305     GO TO 2010-SKIP-ADD.
  1306
  1307 2400-SKIP-TO-SCREEN.
  1308     MOVE SPACES                 TO EOF-SWITCH.
  1309     MOVE ZEROES                 TO LINE-SEQUENCE.
  1310     MOVE 'S'                    TO HELP-TYPE.
  1311
  1312     IF SCODEI = LOW-VALUES OR SPACES
  1313         MOVE SPACES             TO ERROR-SCREEN
  1314     ELSE
  1315         MOVE SCODEI             TO ERROR-SCREEN.
  1316
  1317     IF SCODEI = ZEROES
  1318         MOVE SPACE              TO HELP-TYPE.
  1319
  1320     MOVE FILE-READ-KEY          TO SAVE-KEY
  1321     GO TO 2010-SKIP-ADD.
  1322
  1323 2500-SKIP-TO-ERROR.
  1324     MOVE SPACES                 TO EOF-SWITCH.
  1325     MOVE ZEROS                  TO LINE-SEQUENCE.
  1326     MOVE 'E'                    TO HELP-TYPE.
  1327
  1328     IF ECODEI = LOW-VALUES OR ZEROES
  1329         MOVE SPACES             TO ERROR-SCREEN
  1330     ELSE
  1331         MOVE ECODEI             TO ERROR-SCREEN.
  1332
  1333     IF ECODEI = ZEROES
  1334         MOVE SPACE              TO HELP-TYPE.
  1335
  1336     MOVE FILE-READ-KEY          TO SAVE-KEY
  1337     GO TO 2010-SKIP-ADD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL010.cbl
  1339 2600-USER-NOTES.
  1340     MOVE SPACES                 TO  EOF-SWITCH.
  1341     MOVE ZEROS                  TO  LINE-SEQUENCE.
  1342     MOVE SAVE-HELP-TYPE         TO  HELP-TYPE.
  1343     IF HELP-TYPE IS EQUAL TO 'S'
  1344         IF SCODEI IS EQUAL TO LOW-VALUES OR SPACES
  1345             MOVE SPACES         TO  ERROR-SCREEN
  1346         ELSE
  1347             MOVE SCODEI         TO  ERROR-SCREEN.
  1348     IF HELP-TYPE IS EQUAL TO 'E'
  1349         IF ECODEI IS EQUAL TO LOW-VALUES OR SPACES
  1350             MOVE SPACES         TO  ERROR-SCREEN
  1351         ELSE
  1352             MOVE ECODEI         TO  ERROR-SCREEN.
  1353     IF HELP-TYPE IS EQUAL TO 'S'
  1354         IF SCODEI IS EQUAL TO ZEROS
  1355             MOVE SPACE          TO  HELP-TYPE.
  1356     IF HELP-TYPE IS EQUAL TO 'E'
  1357         IF ECODEI IS EQUAL TO ZEROS
  1358             MOVE SPACE          TO  HELP-TYPE.
  1359     MOVE FILE-READ-KEY          TO  SAVE-KEY.
  1360     GO TO 2010-SKIP-ADD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL010.cbl
  1362 3000-BUILD-SCREEN.
  1363     MOVE TX-TEXT-LINE           TO HOLD-LINE.
  1364     MOVE FORMATTED-LINE         TO INFOO (COUNT-1).
  1365     PERFORM 4020-READ-FILE THRU 4040-READ-FILE-EXIT.
  1366
  1367     IF TX-SCREEN-OR-ERROR NOT = SAVE-CONTROL
  1368         MOVE 'E'                TO ERROR-SWITCH.
  1369
  1370 3010-BUILD-SCREEN-EXIT.
  1371     EXIT.
  1372
  1373
  1374 3100-FILL-SCREEN.
  1375     MOVE SPACES                 TO FORMATTED-LINE.
  1376     MOVE FORMATTED-LINE         TO INFOO (COUNT-1).
  1377
  1378 3110-FILL-SCREEN-EXIT.
  1379     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL010.cbl
  1381 4000-START-BROWSE.
  1382
  1383* EXEC CICS HANDLE CONDITION
  1384*        NOTOPEN (5000-HELP-NOT-OPEN)
  1385*        NOTFND  (4005-KEY-NOT-FOUND)
  1386*    END-EXEC.
  1387*    MOVE '"$JI                  ! % #00001204' TO DFHEIV0
  1388     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  1389     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1390     MOVE X'2520233030303031323034' TO DFHEIV0(25:11)
  1391     CALL 'kxdfhei1' USING DFHEIV0
  1392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1393
  1394
  1395
  1396* EXEC CICS STARTBR
  1397*        DATASET ('ELHELP')
  1398*        RIDFLD  (FILE-READ-KEY)
  1399*    END-EXEC.
  1400     MOVE 'ELHELP' TO DFHEIV1
  1401     MOVE 0
  1402       TO DFHEIV11
  1403*    MOVE '&,         G          &   #00001209' TO DFHEIV0
  1404     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1405     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1406     MOVE X'2020233030303031323039' TO DFHEIV0(25:11)
  1407     CALL 'kxdfhei1' USING DFHEIV0,
  1408           DFHEIV1,
  1409           FILE-READ-KEY,
  1410           DFHEIV99,
  1411           DFHEIV11,
  1412           DFHEIV99
  1413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1414
  1415
  1416     GO TO 4010-START-BROWSE-EXIT.
  1417
  1418 4005-KEY-NOT-FOUND.
  1419        MOVE 'Z'                    TO EOF-SWITCH.
  1420
  1421 4010-START-BROWSE-EXIT.
  1422     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL010.cbl
  1424 4020-READ-FILE.
  1425
  1426* EXEC CICS HANDLE CONDITION
  1427*        NOTFND  (4030-END-OF-FILE)
  1428*        ENDFILE (4030-END-OF-FILE)
  1429*    END-EXEC.
  1430*    MOVE '"$I''                  ! & #00001223' TO DFHEIV0
  1431     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  1432     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1433     MOVE X'2620233030303031323233' TO DFHEIV0(25:11)
  1434     CALL 'kxdfhei1' USING DFHEIV0
  1435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1436
  1437
  1438
  1439* EXEC CICS READNEXT
  1440*        SET      (ADDRESS OF TEXT-FILES)
  1441*        DATASET  ('ELHELP')
  1442*        RIDFLD   (FILE-READ-KEY)
  1443*    END-EXEC.
  1444     MOVE 'ELHELP' TO DFHEIV1
  1445     MOVE 0
  1446       TO DFHEIV11
  1447*    MOVE '&.S                   )   #00001228' TO DFHEIV0
  1448     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1449     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1450     MOVE X'2020233030303031323238' TO DFHEIV0(25:11)
  1451     CALL 'kxdfhei1' USING DFHEIV0,
  1452           DFHEIV1,
  1453           DFHEIV20,
  1454           DFHEIV99,
  1455           FILE-READ-KEY,
  1456           DFHEIV99,
  1457           DFHEIV11,
  1458           DFHEIV99,
  1459           DFHEIV99
  1460     SET ADDRESS OF TEXT-FILES TO
  1461         DFHEIV20
  1462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1463
  1464
  1465     IF TX-COMPANY-CD NOT = SAVE-COMPANY-CD
  1466           GO TO 4030-END-OF-FILE.
  1467
  1468     GO TO 4040-READ-FILE-EXIT.
  1469
  1470 4030-END-OF-FILE.
  1471     MOVE 'E'                    TO ERROR-SWITCH.
  1472     MOVE 'Y'                    TO EOF-SWITCH.
  1473     MOVE ER-0130                TO EMI-ERROR.
  1474     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1475
  1476 4040-READ-FILE-EXIT.
  1477     EXIT.
  1478
  1479 4050-END-BROWSE.
  1480
  1481* EXEC CICS ENDBR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL010.cbl
  1482*        DATASET ('ELHELP')
  1483*    END-EXEC.
  1484     MOVE 'ELHELP' TO DFHEIV1
  1485     MOVE 0
  1486       TO DFHEIV11
  1487*    MOVE '&2                    $   #00001249' TO DFHEIV0
  1488     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1489     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1490     MOVE X'2020233030303031323439' TO DFHEIV0(25:11)
  1491     CALL 'kxdfhei1' USING DFHEIV0,
  1492           DFHEIV1,
  1493           DFHEIV11,
  1494           DFHEIV99
  1495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1496
  1497
  1498 4060-END-BROWSE-EXIT.
  1499     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL010.cbl
  1501 4070-READ-PREV.
  1502
  1503* EXEC CICS HANDLE CONDITION
  1504*        ENDFILE (4080-END-OF-FILE)
  1505*        NOTFND  (4080-END-OF-FILE)
  1506*    END-EXEC.
  1507*    MOVE '"$''I                  ! '' #00001257' TO DFHEIV0
  1508     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  1509     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1510     MOVE X'2720233030303031323537' TO DFHEIV0(25:11)
  1511     CALL 'kxdfhei1' USING DFHEIV0
  1512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1513
  1514
  1515
  1516* EXEC CICS READPREV
  1517*        SET      (ADDRESS OF TEXT-FILES)
  1518*        DATASET  ('ELHELP')
  1519*        RIDFLD   (FILE-READ-KEY)
  1520*    END-EXEC.
  1521     MOVE 'ELHELP' TO DFHEIV1
  1522     MOVE 0
  1523       TO DFHEIV11
  1524*    MOVE '&0S                   )   #00001262' TO DFHEIV0
  1525     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  1526     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1527     MOVE X'2020233030303031323632' TO DFHEIV0(25:11)
  1528     CALL 'kxdfhei1' USING DFHEIV0,
  1529           DFHEIV1,
  1530           DFHEIV20,
  1531           DFHEIV99,
  1532           FILE-READ-KEY,
  1533           DFHEIV99,
  1534           DFHEIV11,
  1535           DFHEIV99,
  1536           DFHEIV99
  1537     SET ADDRESS OF TEXT-FILES TO
  1538         DFHEIV20
  1539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1540
  1541
  1542     GO TO 4090-READ-PREV-EXIT.
  1543
  1544 4080-END-OF-FILE.
  1545     MOVE 'E'                    TO ERROR-SWITCH.
  1546     MOVE 'X'                    TO EOF-SWITCH.
  1547     MOVE ER-0131                TO EMI-ERROR.
  1548     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1549
  1550 4090-READ-PREV-EXIT.
  1551     EXIT.
  1552
  1553 5000-HELP-NOT-OPEN.
  1554     MOVE ER-0015                TO EMI-ERROR.
  1555     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1556     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL010.cbl
  1558 8100-SEND-INITIAL-MAP.
  1559     PERFORM 8130-FORMAT-TIME-DATE
  1560             THRU 8140-FORMAT-TIME-DATE-EXIT.
  1561
  1562
  1563* EXEC CICS SEND
  1564*        MAP     ('EL010A')
  1565*        MAPSET  ('EL010S')
  1566*        ERASE
  1567*        FREEKB
  1568*    END-EXEC.
  1569     MOVE 'EL010A' TO DFHEIV1
  1570     MOVE 'EL010S' TO DFHEIV2
  1571*    MOVE '8$      T  E F  H     ,   #00001288' TO DFHEIV0
  1572     MOVE X'382420202020202054202045' TO DFHEIV0(1:12)
  1573     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
  1574     MOVE X'2020233030303031323838' TO DFHEIV0(25:11)
  1575     CALL 'kxdfhei1' USING DFHEIV0,
  1576           DFHEIV1,
  1577           EL010AO,
  1578           DFHEIV99,
  1579           DFHEIV2,
  1580           DFHEIV99,
  1581           DFHEIV99,
  1582           DFHEIV99,
  1583           DFHEIV99,
  1584           DFHEIV99,
  1585           DFHEIV99,
  1586           DFHEIV99
  1587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1588
  1589
  1590     GO TO 9000-RETURN-TRANS.
  1591
  1592 8110-SEND-DATA.
  1593     IF EIBTRNID NOT = THIS-TRANS
  1594        GO TO 8100-SEND-INITIAL-MAP.
  1595
  1596     PERFORM 8130-FORMAT-TIME-DATE
  1597             THRU 8140-FORMAT-TIME-DATE-EXIT.
  1598
  1599
  1600* EXEC CICS SEND
  1601*        MAP     ('EL010A')
  1602*        MAPSET  ('EL010S')
  1603*        DATAONLY
  1604*        FREEKB
  1605*    END-EXEC.
  1606     MOVE 'EL010A' TO DFHEIV1
  1607     MOVE 'EL010S' TO DFHEIV2
  1608*    MOVE '8$D     T    F  H     ,   #00001304' TO DFHEIV0
  1609     MOVE X'382444202020202054202020' TO DFHEIV0(1:12)
  1610     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
  1611     MOVE X'2020233030303031333034' TO DFHEIV0(25:11)
  1612     CALL 'kxdfhei1' USING DFHEIV0,
  1613           DFHEIV1,
  1614           EL010AO,
  1615           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL010.cbl
  1616           DFHEIV2,
  1617           DFHEIV99,
  1618           DFHEIV99,
  1619           DFHEIV99,
  1620           DFHEIV99,
  1621           DFHEIV99,
  1622           DFHEIV99,
  1623           DFHEIV99
  1624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1625
  1626
  1627     GO TO 9000-RETURN-TRANS.
  1628
  1629 8130-FORMAT-TIME-DATE.
  1630
  1631* EXEC CICS ASKTIME ABSTIME(LCP-CICS-DATE)
  1632*    END-EXEC
  1633*    MOVE '0"A                   "   #00001314' TO DFHEIV0
  1634     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
  1635     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  1636     MOVE X'2020233030303031333134' TO DFHEIV0(25:11)
  1637     CALL 'kxdfhei1' USING DFHEIV0,
  1638           LCP-CICS-DATE
  1639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1640
  1641* EXEC CICS FORMATTIME
  1642*              ABSTIME(LCP-CICS-DATE)
  1643*              YYMMDD(LCP-CURRENT-DATE-68)
  1644*              DATESEP('/')
  1645*    END-EXEC
  1646     MOVE '/' TO DFHEIV9
  1647*    MOVE 'j$((   "              $   #00001316' TO DFHEIV0
  1648     MOVE X'6A2428282020202220202020' TO DFHEIV0(1:12)
  1649     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1650     MOVE X'2020233030303031333136' TO DFHEIV0(25:11)
  1651     CALL 'kxdfhei1' USING DFHEIV0,
  1652           LCP-CICS-DATE,
  1653           LCP-CURRENT-DATE-68,
  1654           DFHEIV9
  1655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1656     MOVE LCP-CURRENT-DATE-68 TO DATEO.
  1657
  1658* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
  1659*    END-EXEC
  1660*    MOVE '0"A                   "   #00001322' TO DFHEIV0
  1661     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
  1662     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  1663     MOVE X'2020233030303031333232' TO DFHEIV0(25:11)
  1664     CALL 'kxdfhei1' USING DFHEIV0,
  1665           LCP-CICS-TIME
  1666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1667
  1668* EXEC CICS FORMATTIME
  1669*              ABSTIME(LCP-CICS-TIME)
  1670*              TIME(LCP-TIME-OF-DAY-XX)
  1671*    END-EXEC
  1672*    MOVE 'j$(     (             #   #00001324' TO DFHEIV0
  1673     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL010.cbl
  1674     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1675     MOVE X'2020233030303031333234' TO DFHEIV0(25:11)
  1676     CALL 'kxdfhei1' USING DFHEIV0,
  1677           LCP-CICS-TIME,
  1678           LCP-TIME-OF-DAY-XX
  1679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1680     MOVE  LCP-TIME-OF-DAY-68 TO TIME-UNFORMATTED.
  1681     MOVE UN-HOURS               TO FOR-HOURS.
  1682     MOVE UN-MINUTES             TO FOR-MINUTES.
  1683     MOVE TIME-FORMATTED         TO TIMEO.
  1684     MOVE EMI-MESSAGE-AREA (1)   TO MSGO.
  1685
  1686 8140-FORMAT-TIME-DATE-EXIT.
  1687     EXIT.
  1688
  1689 8800-UNAUTHORIZED-ACCESS.
  1690     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  1691     GO TO 8990-SEND-TEXT.
  1692
  1693 8820-XCTL-ERROR.
  1694
  1695* EXEC CICS HANDLE CONDITION
  1696*        PGMIDERR (8880-SIGN-OFF-ERROR)
  1697*    END-EXEC.
  1698*    MOVE '"$L                   ! ( #00001342' TO DFHEIV0
  1699     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  1700     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1701     MOVE X'2820233030303031333432' TO DFHEIV0(25:11)
  1702     CALL 'kxdfhei1' USING DFHEIV0
  1703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1704
  1705
  1706     MOVE SPACE                  TO PI-ENTRY-CD-1.
  1707     MOVE CALL-PGM               TO PI-CALLING-PROGRAM.
  1708     MOVE XCTL-EL005             TO CALL-PGM.
  1709     GO TO 9200-XCTL.
  1710
  1711 8880-SIGN-OFF-ERROR.
  1712     MOVE CALL-PGM               TO LOGOFF-PGM.
  1713     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  1714
  1715 8990-SEND-TEXT.
  1716
  1717* EXEC CICS SEND TEXT
  1718*        FROM    (LOGOFF-TEXT)
  1719*        LENGTH  (LOGOFF-LENGTH)
  1720*        ERASE
  1721*        FREEKB
  1722*    END-EXEC.
  1723*    MOVE '8&      T  E F  H   F -   #00001356' TO DFHEIV0
  1724     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  1725     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  1726     MOVE X'2020233030303031333536' TO DFHEIV0(25:11)
  1727     CALL 'kxdfhei1' USING DFHEIV0,
  1728           LOGOFF-TEXT,
  1729           LOGOFF-LENGTH,
  1730           DFHEIV99,
  1731           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL010.cbl
  1732           DFHEIV99,
  1733           DFHEIV99,
  1734           DFHEIV99,
  1735           DFHEIV99,
  1736           DFHEIV99,
  1737           DFHEIV99,
  1738           DFHEIV99,
  1739           DFHEIV99
  1740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1741
  1742
  1743     GO TO 9100-RETURN-CICS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL010.cbl
  1745 9000-RETURN-TRANS.
  1746
  1747* EXEC CICS RETURN
  1748*        TRANSID   (TRANS-ID)
  1749*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  1750*        LENGTH    (WS-COMM-LENGTH)
  1751*    END-EXEC.
  1752*    MOVE '.(CT                  &   #00001366' TO DFHEIV0
  1753     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  1754     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1755     MOVE X'2020233030303031333636' TO DFHEIV0(25:11)
  1756     CALL 'kxdfhei1' USING DFHEIV0,
  1757           TRANS-ID,
  1758           PROGRAM-INTERFACE-BLOCK,
  1759           WS-COMM-LENGTH,
  1760           DFHEIV99,
  1761           DFHEIV99
  1762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1763
  1764
  1765
  1766* GOBACK.
  1767     MOVE '9%                    "   ' TO DFHEIV0
  1768     MOVE 'EL010' TO DFHEIV1
  1769     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1770     GOBACK.
  1771
  1772 9100-RETURN-CICS.
  1773
  1774* EXEC CICS RETURN
  1775*    END-EXEC.
  1776*    MOVE '.(                    &   #00001375' TO DFHEIV0
  1777     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1778     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1779     MOVE X'2020233030303031333735' TO DFHEIV0(25:11)
  1780     CALL 'kxdfhei1' USING DFHEIV0,
  1781           DFHEIV99,
  1782           DFHEIV99,
  1783           DFHEIV99,
  1784           DFHEIV99,
  1785           DFHEIV99
  1786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1787
  1788
  1789
  1790* GOBACK.
  1791     MOVE '9%                    "   ' TO DFHEIV0
  1792     MOVE 'EL010' TO DFHEIV1
  1793     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1794     GOBACK.
  1795
  1796 9200-XCTL.
  1797
  1798* EXEC CICS XCTL
  1799*        PROGRAM   (CALL-PGM)
  1800*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  1801*        LENGTH    (WS-COMM-LENGTH)
  1802*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL010.cbl
  1803*    MOVE '.$C                   $   #00001381' TO DFHEIV0
  1804     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  1805     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1806     MOVE X'2020233030303031333831' TO DFHEIV0(25:11)
  1807     CALL 'kxdfhei1' USING DFHEIV0,
  1808           CALL-PGM,
  1809           PROGRAM-INTERFACE-BLOCK,
  1810           WS-COMM-LENGTH
  1811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1812
  1813
  1814 9900-ERROR-FORMAT.
  1815     IF NOT EMI-ERRORS-COMPLETE
  1816
  1817
  1818* EXEC CICS LINK
  1819*            PROGRAM   ('EL001')
  1820*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  1821*            LENGTH    (EMI-COMM-LENGTH)
  1822*        END-EXEC.
  1823     MOVE 'EL001' TO DFHEIV1
  1824*    MOVE '."C                   ''   #00001390' TO DFHEIV0
  1825     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1826     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1827     MOVE X'2020233030303031333930' TO DFHEIV0(25:11)
  1828     CALL 'kxdfhei1' USING DFHEIV0,
  1829           DFHEIV1,
  1830           ERROR-MESSAGE-INTERFACE-BLOCK,
  1831           EMI-COMM-LENGTH,
  1832           DFHEIV99,
  1833           DFHEIV99,
  1834           DFHEIV99
  1835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1836
  1837
  1838 9900-EXIT.
  1839     EXIT.
  1840
  1841 9990-ABEND.
  1842
  1843* EXEC CICS LINK
  1844*        PROGRAM   ('EL004')
  1845*        COMMAREA  (DFHEIBLK)
  1846*        LENGTH    (64)
  1847*    END-EXEC.
  1848     MOVE 'EL004' TO DFHEIV1
  1849     MOVE 64
  1850       TO DFHEIV11
  1851*    MOVE '."C                   ''   #00001400' TO DFHEIV0
  1852     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1853     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1854     MOVE X'2020233030303031343030' TO DFHEIV0(25:11)
  1855     CALL 'kxdfhei1' USING DFHEIV0,
  1856           DFHEIV1,
  1857           DFHEIBLK,
  1858           DFHEIV11,
  1859           DFHEIV99,
  1860           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL010.cbl
  1861           DFHEIV99
  1862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1863
  1864
  1865     GO TO 9100-RETURN-CICS.
  1866
  1867 9999-DFHBACK SECTION.
  1868     MOVE '9%                    "   ' TO DFHEIV0
  1869     MOVE 'EL010' TO DFHEIV1
  1870     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1871     GOBACK.
  1872 9999-DFHEXIT.
  1873     IF DFHEIGDJ EQUAL 0001
  1874         NEXT SENTENCE
  1875     ELSE IF DFHEIGDJ EQUAL 2
  1876         GO TO 8820-XCTL-ERROR,
  1877               0050-MAPFAIL-HANDLE,
  1878               9990-ABEND
  1879         DEPENDING ON DFHEIGDI
  1880     ELSE IF DFHEIGDJ EQUAL 3
  1881         GO TO 0410-BUFF-KEY-NOT-FOUND
  1882         DEPENDING ON DFHEIGDI
  1883     ELSE IF DFHEIGDJ EQUAL 4
  1884         GO TO 0420-DELETE-TS-EXIT
  1885         DEPENDING ON DFHEIGDI
  1886     ELSE IF DFHEIGDJ EQUAL 5
  1887         GO TO 5000-HELP-NOT-OPEN,
  1888               4005-KEY-NOT-FOUND
  1889         DEPENDING ON DFHEIGDI
  1890     ELSE IF DFHEIGDJ EQUAL 6
  1891         GO TO 4030-END-OF-FILE,
  1892               4030-END-OF-FILE
  1893         DEPENDING ON DFHEIGDI
  1894     ELSE IF DFHEIGDJ EQUAL 7
  1895         GO TO 4080-END-OF-FILE,
  1896               4080-END-OF-FILE
  1897         DEPENDING ON DFHEIGDI
  1898     ELSE IF DFHEIGDJ EQUAL 8
  1899         GO TO 8880-SIGN-OFF-ERROR
  1900         DEPENDING ON DFHEIGDI.
  1901     MOVE '9%                    "   ' TO DFHEIV0
  1902     MOVE 'EL010' TO DFHEIV1
  1903     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1904     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4428     Code:        6221
