* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL653.cbl
* Options: int("EL653.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL653.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL653.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL653.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL653 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:14:25.
     7*                            VMOD 2.007
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL653.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*                                                                *
    21*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    22*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    23*            *                                                   *
    24*            *****************************************************
    25*
    26*REMARKS.
    27*        TRANSACTION - EXD5 - COMMISSION MASTER MAINT.
    28*
    29******************************************************************
    30*                   C H A N G E   L O G
    31*
    32* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    33*-----------------------------------------------------------------
    34*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    35* EFFECTIVE    NUMBER
    36*-----------------------------------------------------------------
    37* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    38*                              ADJUSTED REDEFINES EL653AI FILLER
    39******************************************************************
    40
    41 ENVIRONMENT DIVISION.
    42 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL653.cbl
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46 77  FILLER  PIC X(32)  VALUE '********************************'.
    47 77  FILLER  PIC X(32)  VALUE '*    EL653 WORKING STORAGE     *'.
    48 77  FILLER  PIC X(32)  VALUE '************ V/M 2.007 *********'.
    49
    50 01  WS-DATE-AREA.
    51     12  SAVE-DATE           PIC  X(8)       VALUE SPACES.
    52     12  SAVE-BIN-DATE       PIC  XX         VALUE SPACES.
    53
    54 01  STANDARD-AREAS.
    55     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
    56     12  MAP-NAME            PIC  X(8)       VALUE 'EL653A'.
    57     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL653S'.
    58     12  TRANS-ID            PIC  X(4)       VALUE 'EXD5'.
    59     12  THIS-PGM            PIC  X(8)       VALUE 'EL653'.
    60     12  PGM-NAME            PIC  X(8).
    61     12  WS-COMP-CD-R.
    62         16  FILLER          PIC  X.
    63         16  WS-COMP-CD-X    PIC  X.
    64     12  WS-COMP-CD  REDEFINES
    65         WS-COMP-CD-R        PIC S9(4)                  COMP.
    66     12  TIME-IN             PIC S9(7).
    67     12  TIME-OUT-R  REDEFINES  TIME-IN.
    68         16  FILLER          PIC  X.
    69         16  TIME-OUT        PIC  99V99.
    70         16  FILLER          PIC  XX.
    71     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
    72     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
    73     12  XCTL-626            PIC  X(8)       VALUE 'EL126'.
    74     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
    75     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
    76     12  LINK-CLDATCV        PIC  X(8)       VALUE 'ELDATCV'.
    77     12  FILE-ID             PIC  X(8)       VALUE  SPACES.
    78     12  CTBL-FILE-ID        PIC  X(8)       VALUE 'ERCTBL'.
    79     12  CNTL-FILE-ID        PIC  X(8)       VALUE 'ELCNTL'.
    80
    81 01  MISC-WORK-AREAS.
    82     12  WS-PHONE-IN         PIC  9(10).
    83     12  WS-PHONE-IN-R  REDEFINES  WS-PHONE-IN.
    84         16  WSPI-AREA       PIC  X(3).
    85         16  WSPI-PFX        PIC  X(3).
    86         16  WSPI-SFX        PIC  X(4).
    87     12  WS-PHONE-OUT.
    88         16  WSPO-AREA       PIC  X(3).
    89         16  FILLER          PIC  X           VALUE '-'.
    90         16  WSPO-PFX        PIC  X(3).
    91         16  FILLER          PIC  X           VALUE '-'.
    92         16  WSPO-SFX        PIC  X(4).
    93     12  DEEDIT-FIELD        PIC  X(15).
    94     12  FILLER  REDEFINES  DEEDIT-FIELD.
    95         16  FILLER          PIC  X(8).
    96         16  DEEDIT-FIELD-X7 PIC  X(7).
    97     12  DEEDIT-FIELD-V0  REDEFINES
    98         DEEDIT-FIELD        PIC S9(15).
    99     12  DEEDIT-FIELD-V1  REDEFINES
   100         DEEDIT-FIELD        PIC S9(13)V99.
   101     12  DEEDIT-FIELD-V5  REDEFINES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL653.cbl
   102         DEEDIT-FIELD        PIC S9(10)V9(5).
   103     12  SUB1                PIC S9(4)        VALUE +0   COMP.
   104     12  SUB2                PIC S9(4)        VALUE +0   COMP.
   105     12  SUB3                PIC S9(4)        VALUE +0   COMP.
   106     12  SC-ITEM             PIC S9(4)        VALUE +1   COMP.
   107     12  ERCTBL-LENGTH       PIC S9(4)        VALUE +340 COMP.
   108     12  SV-CLMTOL           PIC  9(3)V99   VALUE ZEROS.
   109     12  DATE-TEST-AREA      PIC  9(6).
   110     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   111         16  DATE-TEST-MM    PIC  99.
   112         16  DATE-TEST-DD    PIC  99.
   113         16  DATE-TEST-YY    PIC  99.
   114     12  DIVIDE-RESULT       PIC  99.
   115     12  DIVIDE-REMAINDER    PIC  9.
   116     12  WS-ZERO             PIC  X           VALUE '0'.
   117     12  WS-ONE              PIC  X           VALUE '1'.
   118     12  WS-TWO              PIC  X           VALUE '2'.
   119     12  WS-MAX-AGE          PIC  99          VALUE 99.
   120     12  WS-MAX-BENEFIT      PIC S9(7)V99 VALUE +9999999.99.
   121     12  WS-BENEFIT          PIC S9(7)V99 VALUE +0.
   122     12  WS-PREV-TERM        PIC  9(3)        VALUE ZERO.
   123     12  WS-PREV-AGE         PIC  99          VALUE ZERO.
   124     12  WS-PREV-BENEFIT     PIC S9(7)V99 VALUE +0.
   125     12  WS-RATE             PIC SV9(5)   VALUE ZEROS.
   126     12  WS-SAVE-TABLE       PIC  X(3)        VALUE SPACES.
   127     12  BIN-CURRENT-SAVE    PIC  XX          VALUE SPACES.
   128     12  ERCTBL-KEY.
   129         16  CTBL-COMP-ID    PIC  X(3)        VALUE SPACES.
   130         16  CTBL-REC-TYPE   PIC  X           VALUE SPACES.
   131         16  CTBL-ACCESS     PIC  X(4)        VALUE SPACES.
   132         16  CTBL-SEQ-NO     PIC S9(4)        VALUE +0   COMP.
   133     12  ELCNTL-KEY.
   134         16  CNTL-COMP-ID    PIC  X(3)        VALUE SPACES.
   135         16  CNTL-REC-TYPE   PIC  X           VALUE SPACES.
   136         16  CNTL-ACCESS     PIC  X(4)        VALUE SPACES.
   137         16  CNTL-SEQ-NO     PIC S9(4)        VALUE +0   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL653.cbl
   139 01  ERROR-NUMBERS.
   140     12  ER-0000             PIC  X(4)       VALUE '0000'.
   141     12  ER-0004             PIC  X(4)       VALUE '0004'.
   142     12  ER-0008             PIC  X(4)       VALUE '0008'.
   143     12  ER-0029             PIC  X(4)       VALUE '0029'.
   144     12  ER-0050             PIC  X(4)       VALUE '0050'.
   145     12  ER-0068             PIC  X(4)       VALUE '0068'.
   146     12  ER-0070             PIC  X(4)       VALUE '0070'.
   147     12  ER-0142             PIC  X(4)       VALUE '0142'.
   148     12  ER-0583             PIC  X(4)       VALUE '0583'.
   149     12  ER-0590             PIC  X(4)       VALUE '0590'.
   150     12  ER-0591             PIC  X(4)       VALUE '0591'.
   151     12  ER-2039             PIC  X(4)       VALUE '2039'.
   152     12  ER-2055             PIC  X(4)       VALUE '2055'.
   153     12  ER-2056             PIC  X(4)       VALUE '2056'.
   154     12  ER-2067             PIC  X(4)       VALUE '2067'.
   155     12  ER-2115             PIC  X(4)       VALUE '2115'.
   156     12  ER-2116             PIC  X(4)       VALUE '2116'.
   157     12  ER-2117             PIC  X(4)       VALUE '2117'.
   158     12  ER-2118             PIC  X(4)       VALUE '2118'.
   159     12  ER-2120             PIC  X(4)       VALUE '2120'.
   160     12  ER-2121             PIC  X(4)       VALUE '2121'.
   161     12  ER-2122             PIC  X(4)       VALUE '2122'.
   162     12  ER-2123             PIC  X(4)       VALUE '2123'.
   163     12  ER-2124             PIC  X(4)       VALUE '2124'.
   164     12  ER-2125             PIC  X(4)       VALUE '2125'.
   165     12  ER-2127             PIC  X(4)       VALUE '2127'.
   166     12  ER-2128             PIC  X(4)       VALUE '2128'.
   167     12  ER-2130             PIC  X(4)       VALUE '2130'.
   168     12  ER-2133             PIC  X(4)       VALUE '2133'.
   169     12  ER-2135             PIC  X(4)       VALUE '2135'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL653.cbl
   171*                            COPY ELCSCTM.
   172******************************************************************
   173*                                                                *
   174*                                                                *
   175*                            ELCSCTM                             *
   176*                            VMOD=2.001                          *
   177*                                                                *
   178*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   179*                                                                *
   180******************************************************************
   181 01  SECURITY-MESSAGE.
   182     12  FILLER                          PIC X(30)
   183            VALUE '** LOGIC SECURITY VIOLATION -'.
   184     12  SM-READ                         PIC X(6).
   185     12  FILLER                          PIC X(5)
   186            VALUE ' PGM='.
   187     12  SM-PGM                          PIC X(6).
   188     12  FILLER                          PIC X(5)
   189            VALUE ' OPR='.
   190     12  SM-PROCESSOR-ID                 PIC X(4).
   191     12  FILLER                          PIC X(6)
   192            VALUE ' TERM='.
   193     12  SM-TERMID                       PIC X(4).
   194     12  FILLER                          PIC XX   VALUE SPACE.
   195     12  SM-JUL-DATE                     PIC 9(5).
   196     12  FILLER                          PIC X    VALUE SPACE.
   197     12  SM-TIME                         PIC 99.99.
   198
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL653.cbl
   200*                            COPY ELCSCRTY.
   201******************************************************************
   202*                                                                *
   203*                                                                *
   204*                            ELCSCRTY                            *
   205*                            VMOD=2.001                          *
   206*                                                                *
   207*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   208*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   209*        SAVED IN PI-SECURITY-ADDRESS.                           *
   210*                                                                *
   211******************************************************************
   212 01  SECURITY-CONTROL.
   213     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   214     12  FILLER                       PIC XX    VALUE 'SC'.
   215     12  SC-CREDIT-CODES.
   216         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   217             20  SC-CREDIT-DISPLAY    PIC X.
   218             20  SC-CREDIT-UPDATE     PIC X.
   219     12  SC-CLAIMS-CODES.
   220         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   221             20  SC-CLAIMS-DISPLAY    PIC X.
   222             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL653.cbl
   224*                            COPY ELCDATE.
   225******************************************************************
   226*                                                                *
   227*                                                                *
   228*                            ELCDATE.                            *
   229*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   230*                            VMOD=2.003
   231*                                                                *
   232*                                                                *
   233*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   234*                 LENGTH = 200                                   *
   235******************************************************************
   236
   237 01  DATE-CONVERSION-DATA.
   238     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   239     12  DC-OPTION-CODE                PIC X.
   240         88  BIN-TO-GREG                VALUE ' '.
   241         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   242         88  EDIT-GREG-TO-BIN           VALUE '2'.
   243         88  YMD-GREG-TO-BIN            VALUE '3'.
   244         88  MDY-GREG-TO-BIN            VALUE '4'.
   245         88  JULIAN-TO-BIN              VALUE '5'.
   246         88  BIN-PLUS-ELAPSED           VALUE '6'.
   247         88  FIND-CENTURY               VALUE '7'.
   248         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   249         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   250         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   251         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   252         88  JULIAN-TO-BIN-3            VALUE 'C'.
   253         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   254         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   255         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   256         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   257         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   258         88  CHECK-LEAP-YEAR            VALUE 'H'.
   259         88  BIN-3-TO-GREG              VALUE 'I'.
   260         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   261         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   262         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   263         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   264         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   265         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   266         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   267         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   268         88  THREE-CHARACTER-BIN
   269                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   270         88  GREGORIAN-TO-BIN
   271                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   272         88  BIN-TO-GREGORIAN
   273                  VALUES ' ' '1' 'I' '8' 'G'.
   274         88  JULIAN-TO-BINARY
   275                  VALUES '5' 'C' 'E' 'F'.
   276     12  DC-ERROR-CODE                 PIC X.
   277         88  NO-CONVERSION-ERROR        VALUE ' '.
   278         88  DATE-CONVERSION-ERROR
   279                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   280         88  DATE-IS-ZERO               VALUE '1'.
   281         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL653.cbl
   282         88  DATE-IS-INVALID            VALUE '3'.
   283         88  DATE1-GREATER-DATE2        VALUE '4'.
   284         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   285         88  DATE-INVALID-OPTION        VALUE '9'.
   286         88  INVALID-CENTURY            VALUE 'A'.
   287         88  ONLY-CENTURY               VALUE 'B'.
   288         88  ONLY-LEAP-YEAR             VALUE 'C'.
   289         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   290     12  DC-END-OF-MONTH               PIC X.
   291         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   292     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   293         88  USE-NORMAL-PROCESS         VALUE ' '.
   294         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   295         88  ADJUST-UP-100-YRS          VALUE '2'.
   296     12  FILLER                        PIC X.
   297     12  DC-CONVERSION-DATES.
   298         16  DC-BIN-DATE-1             PIC XX.
   299         16  DC-BIN-DATE-2             PIC XX.
   300         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   301         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   302                       DC-GREG-DATE-1-EDIT.
   303             20  DC-EDIT1-MONTH        PIC 99.
   304             20  SLASH1-1              PIC X.
   305             20  DC-EDIT1-DAY          PIC 99.
   306             20  SLASH1-2              PIC X.
   307             20  DC-EDIT1-YEAR         PIC 99.
   308         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   309         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   310                     DC-GREG-DATE-2-EDIT.
   311             20  DC-EDIT2-MONTH        PIC 99.
   312             20  SLASH2-1              PIC X.
   313             20  DC-EDIT2-DAY          PIC 99.
   314             20  SLASH2-2              PIC X.
   315             20  DC-EDIT2-YEAR         PIC 99.
   316         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   317         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   318                     DC-GREG-DATE-1-YMD.
   319             20  DC-YMD-YEAR           PIC 99.
   320             20  DC-YMD-MONTH          PIC 99.
   321             20  DC-YMD-DAY            PIC 99.
   322         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   323         16  DC-GREG-DATE-1-MDY-R REDEFINES
   324                      DC-GREG-DATE-1-MDY.
   325             20  DC-MDY-MONTH          PIC 99.
   326             20  DC-MDY-DAY            PIC 99.
   327             20  DC-MDY-YEAR           PIC 99.
   328         16  DC-GREG-DATE-1-ALPHA.
   329             20  DC-ALPHA-MONTH        PIC X(10).
   330             20  DC-ALPHA-DAY          PIC 99.
   331             20  FILLER                PIC XX.
   332             20  DC-ALPHA-CENTURY.
   333                 24 DC-ALPHA-CEN-N     PIC 99.
   334             20  DC-ALPHA-YEAR         PIC 99.
   335         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   336         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   337         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   338         16  DC-JULIAN-DATE            PIC 9(05).
   339         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL653.cbl
   340                                       PIC 9(05).
   341         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   342             20  DC-JULIAN-YEAR        PIC 99.
   343             20  DC-JULIAN-DAYS        PIC 999.
   344         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   345         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   346         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   347     12  DATE-CONVERSION-VARIBLES.
   348         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   349         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   350             20  FILLER                PIC 9(3).
   351             20  HOLD-CEN-1-CCYY.
   352                 24  HOLD-CEN-1-CC     PIC 99.
   353                 24  HOLD-CEN-1-YY     PIC 99.
   354             20  HOLD-CEN-1-MO         PIC 99.
   355             20  HOLD-CEN-1-DA         PIC 99.
   356         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   357             20  HOLD-CEN-1-R-MO       PIC 99.
   358             20  HOLD-CEN-1-R-DA       PIC 99.
   359             20  HOLD-CEN-1-R-CCYY.
   360                 24  HOLD-CEN-1-R-CC   PIC 99.
   361                 24  HOLD-CEN-1-R-YY   PIC 99.
   362             20  FILLER                PIC 9(3).
   363         16  HOLD-CENTURY-1-X.
   364             20  FILLER                PIC X(3)  VALUE SPACES.
   365             20  HOLD-CEN-1-X-CCYY.
   366                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   367                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   368             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   369             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   370         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   371             20  HOLD-CEN-1-R-X-MO     PIC XX.
   372             20  HOLD-CEN-1-R-X-DA     PIC XX.
   373             20  HOLD-CEN-1-R-X-CCYY.
   374                 24  HOLD-CEN-1-R-X-CC PIC XX.
   375                 24  HOLD-CEN-1-R-X-YY PIC XX.
   376             20  FILLER                PIC XXX.
   377         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   378         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   379         16  DC-JULIAN-DATE-1          PIC 9(07).
   380         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   381             20  DC-JULIAN-1-CCYY.
   382                 24  DC-JULIAN-1-CC    PIC 99.
   383                 24  DC-JULIAN-1-YR    PIC 99.
   384             20  DC-JULIAN-DA-1        PIC 999.
   385         16  DC-JULIAN-DATE-2          PIC 9(07).
   386         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   387             20  DC-JULIAN-2-CCYY.
   388                 24  DC-JULIAN-2-CC    PIC 99.
   389                 24  DC-JULIAN-2-YR    PIC 99.
   390             20  DC-JULIAN-DA-2        PIC 999.
   391         16  DC-GREG-DATE-A-EDIT.
   392             20  DC-EDITA-MONTH        PIC 99.
   393             20  SLASHA-1              PIC X VALUE '/'.
   394             20  DC-EDITA-DAY          PIC 99.
   395             20  SLASHA-2              PIC X VALUE '/'.
   396             20  DC-EDITA-CCYY.
   397                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL653.cbl
   398                 24  DC-EDITA-YEAR     PIC 99.
   399         16  DC-GREG-DATE-B-EDIT.
   400             20  DC-EDITB-MONTH        PIC 99.
   401             20  SLASHB-1              PIC X VALUE '/'.
   402             20  DC-EDITB-DAY          PIC 99.
   403             20  SLASHB-2              PIC X VALUE '/'.
   404             20  DC-EDITB-CCYY.
   405                 24  DC-EDITB-CENT     PIC 99.
   406                 24  DC-EDITB-YEAR     PIC 99.
   407         16  DC-GREG-DATE-CYMD         PIC 9(08).
   408         16  DC-GREG-DATE-CYMD-R REDEFINES
   409                              DC-GREG-DATE-CYMD.
   410             20  DC-CYMD-CEN           PIC 99.
   411             20  DC-CYMD-YEAR          PIC 99.
   412             20  DC-CYMD-MONTH         PIC 99.
   413             20  DC-CYMD-DAY           PIC 99.
   414         16  DC-GREG-DATE-MDCY         PIC 9(08).
   415         16  DC-GREG-DATE-MDCY-R REDEFINES
   416                              DC-GREG-DATE-MDCY.
   417             20  DC-MDCY-MONTH         PIC 99.
   418             20  DC-MDCY-DAY           PIC 99.
   419             20  DC-MDCY-CEN           PIC 99.
   420             20  DC-MDCY-YEAR          PIC 99.
   421    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   422        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   423    12  DC-EL310-DATE                  PIC X(21).
   424    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL653.cbl
   426*                            COPY ELCLOGOF.
   427******************************************************************
   428*                                                                *
   429*                                                                *
   430*                            ELCLOGOF.                           *
   431*                            VMOD=2.001                          *
   432*                                                                *
   433*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   434*                                                                *
   435******************************************************************
   436 01  CLASIC-LOGOFF.
   437     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   438     12  LOGOFF-TEXT.
   439         16  FILLER          PIC X(5)    VALUE SPACES.
   440         16  LOGOFF-MSG.
   441             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   442             20  FILLER      PIC X       VALUE SPACES.
   443             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   444         16  FILLER          PIC X(80)
   445           VALUE '* YOU ARE NOW LOGGED OFF'.
   446         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   447         16  FILLER          PIC X       VALUE QUOTE.
   448         16  LOGOFF-SYS-MSG  PIC X(17)
   449           VALUE 'S CLAS-IC SYSTEM '.
   450     12  TEXT-MESSAGES.
   451         16  UNACCESS-MSG    PIC X(29)
   452             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   453         16  PGMIDERR-MSG    PIC X(17)
   454             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL653.cbl
   456*                            COPY ELCATTR.
   457******************************************************************
   458*                                                                *
   459*                            ELCATTR.                            *
   460*                            VMOD=2.001                          *
   461*                                                                *
   462*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   463*                                                                *
   464*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   465*                                                                *
   466*                   POS 1   P=PROTECTED                          *
   467*                           U=UNPROTECTED                        *
   468*                           S=ASKIP                              *
   469*                   POS 2   A=ALPHA/NUMERIC                      *
   470*                           N=NUMERIC                            *
   471*                   POS 3   N=NORMAL                             *
   472*                           B=BRIGHT                             *
   473*                           D=DARK                               *
   474*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   475*                           OF=MODIFIED DATA TAG OFF             *
   476*                                                                *
   477*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   478******************************************************************
   479 01  ATTRIBUTE-LIST.
   480     12  AL-PABOF            PIC X       VALUE 'Y'.
   481     12  AL-PABON            PIC X       VALUE 'Z'.
   482     12  AL-PADOF            PIC X       VALUE '%'.
   483     12  AL-PADON            PIC X       VALUE '_'.
   484     12  AL-PANOF            PIC X       VALUE '-'.
   485     12  AL-PANON            PIC X       VALUE '/'.
   486     12  AL-SABOF            PIC X       VALUE '8'.
   487     12  AL-SABON            PIC X       VALUE '9'.
   488     12  AL-SADOF            PIC X       VALUE '@'.
   489     12  AL-SADON            PIC X       VALUE QUOTE.
   490     12  AL-SANOF            PIC X       VALUE '0'.
   491     12  AL-SANON            PIC X       VALUE '1'.
   492     12  AL-UABOF            PIC X       VALUE 'H'.
   493     12  AL-UABON            PIC X       VALUE 'I'.
   494     12  AL-UADOF            PIC X       VALUE '<'.
   495     12  AL-UADON            PIC X       VALUE '('.
   496     12  AL-UANOF            PIC X       VALUE ' '.
   497     12  AL-UANON            PIC X       VALUE 'A'.
   498     12  AL-UNBOF            PIC X       VALUE 'Q'.
   499     12  AL-UNBON            PIC X       VALUE 'R'.
   500     12  AL-UNDOF            PIC X       VALUE '*'.
   501     12  AL-UNDON            PIC X       VALUE ')'.
   502     12  AL-UNNOF            PIC X       VALUE '&'.
   503     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL653.cbl
   505*                            COPY ELCEMIB.
   506******************************************************************
   507*                                                                *
   508*                                                                *
   509*                            ELCEMIB.                            *
   510*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   511*                            VMOD=2.005                          *
   512*                                                                *
   513*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   514*                                                                *
   515******************************************************************
   516 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   517     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   518     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   519     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   520     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   521     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   522     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   523     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   524     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   525     12  EMI-SWITCH1             PIC X        VALUE '1'.
   526         88  EMI-NO-ERRORS                    VALUE '1'.
   527         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   528         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   529     12  EMI-SWITCH2             PIC X        VALUE '1'.
   530         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   531     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   532         88  EMI-AREA1-EMPTY                  VALUE '1'.
   533         88  EMI-AREA1-FULL                   VALUE '2'.
   534     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   535         88  EMI-AREA2-EMPTY                  VALUE '1'.
   536         88  EMI-AREA2-FULL                   VALUE '2'.
   537     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   538         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   539         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   540         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   541         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   542         88  EMI-BYPASS-FATALS                VALUE 'X'.
   543     12  EMI-ERROR-LINES.
   544         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   545         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   546         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   547         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   548             20  EMI-ERR-CODES OCCURS 10 TIMES.
   549                 24  EMI-ERR-NUM         PIC X(4).
   550                 24  EMI-FILLER          PIC X.
   551                 24  EMI-SEV             PIC X.
   552                 24  FILLER              PIC X.
   553             20  FILLER                  PIC X(02).
   554     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   555         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   556             20  EMI-ERROR-NUMBER    PIC X(4).
   557             20  EMI-FILL            PIC X.
   558             20  EMI-SEVERITY        PIC X.
   559             20  FILLER              PIC X.
   560             20  EMI-ERROR-TEXT.
   561                 24  EMI-TEXT-VARIABLE   PIC X(10).
   562                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL653.cbl
   563     12  EMI-SEVERITY-SAVE           PIC X.
   564         88  EMI-NOTE                    VALUE 'N'.
   565         88  EMI-WARNING                 VALUE 'W'.
   566         88  EMI-FORCABLE                VALUE 'F'.
   567         88  EMI-FATAL                   VALUE 'X'.
   568     12  EMI-MESSAGE-FLAG            PIC X.
   569         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   570         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   571     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   572     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   573         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   574         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   575         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   576     12  FILLER                      PIC X(137)  VALUE SPACES.
   577     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   578     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   579     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   580     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL653.cbl
   582*                            COPY ELCINTF.
   583******************************************************************
   584*                                                                *
   585*                                                                *
   586*                            ELCINTF.                            *
   587*                            VMOD=2.017                          *
   588*                                                                *
   589*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   590*                                                                *
   591*       LENGTH = 1024                                            *
   592*                                                                *
   593******************************************************************
   594 01  PROGRAM-INTERFACE-BLOCK.
   595     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   596     12  PI-CALLING-PROGRAM              PIC X(8).
   597     12  PI-SAVED-PROGRAM-1              PIC X(8).
   598     12  PI-SAVED-PROGRAM-2              PIC X(8).
   599     12  PI-SAVED-PROGRAM-3              PIC X(8).
   600     12  PI-SAVED-PROGRAM-4              PIC X(8).
   601     12  PI-SAVED-PROGRAM-5              PIC X(8).
   602     12  PI-SAVED-PROGRAM-6              PIC X(8).
   603     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   604     12  PI-COMPANY-ID                   PIC XXX.
   605     12  PI-COMPANY-CD                   PIC X.
   606
   607     12  PI-COMPANY-PASSWORD             PIC X(8).
   608
   609     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   610
   611     12  PI-CONTROL-IN-PROGRESS.
   612         16  PI-CARRIER                  PIC X.
   613         16  PI-GROUPING                 PIC X(6).
   614         16  PI-STATE                    PIC XX.
   615         16  PI-ACCOUNT                  PIC X(10).
   616         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   617                                         PIC X(10).
   618         16  PI-CLAIM-CERT-GRP.
   619             20  PI-CLAIM-NO             PIC X(7).
   620             20  PI-CERT-NO.
   621                 25  PI-CERT-PRIME       PIC X(10).
   622                 25  PI-CERT-SFX         PIC X.
   623             20  PI-CERT-EFF-DT          PIC XX.
   624         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   625             20  PI-PLAN-CODE            PIC X(2).
   626             20  PI-REVISION-NUMBER      PIC X(3).
   627             20  PI-PLAN-EFF-DT          PIC X(2).
   628             20  PI-PLAN-EXP-DT          PIC X(2).
   629             20  FILLER                  PIC X(11).
   630         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   631             20  PI-OE-REFERENCE-1.
   632                 25  PI-OE-REF-1-PRIME   PIC X(18).
   633                 25  PI-OE-REF-1-SUFF    PIC XX.
   634
   635     12  PI-SESSION-IN-PROGRESS          PIC X.
   636         88  CLAIM-SESSION                   VALUE '1'.
   637         88  CREDIT-SESSION                  VALUE '2'.
   638         88  WARRANTY-SESSION                VALUE '3'.
   639         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL653.cbl
   640         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   641
   642
   643*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   644
   645     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   646     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   647
   648     12  PI-CREDIT-USER                  PIC X.
   649         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   650         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   651
   652     12  PI-CLAIM-USER                   PIC X.
   653         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   654         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   655
   656     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   657         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   658         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   659         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   660         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   661         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   662
   663     12  PI-PROCESSOR-ID                 PIC X(4).
   664
   665     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   666
   667     12  PI-MEMBER-CAPTION               PIC X(10).
   668
   669     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   670         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   671
   672     12  PI-LIFE-OVERRIDE-L1             PIC X.
   673     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   674     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   675     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   676
   677     12  PI-AH-OVERRIDE-L1               PIC X.
   678     12  PI-AH-OVERRIDE-L2               PIC XX.
   679     12  PI-AH-OVERRIDE-L6               PIC X(6).
   680     12  PI-AH-OVERRIDE-L12              PIC X(12).
   681
   682     12  PI-NEW-SYSTEM                   PIC X(2).
   683
   684     12  PI-PRIMARY-CERT-NO              PIC X(11).
   685     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   686         88  PI-USES-PAID-TO                 VALUE '1'.
   687     12  PI-CRDTCRD-SYSTEM.
   688         16  PI-CRDTCRD-USER             PIC X.
   689             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   690             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   691         16  PI-CC-MONTH-END-DT          PIC XX.
   692     12  PI-PROCESSOR-PRINTER            PIC X(4).
   693
   694     12  PI-OE-REFERENCE-2.
   695         16  PI-OE-REF-2-PRIME           PIC X(10).
   696         16  PI-OE-REF-2-SUFF            PIC X.
   697
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL653.cbl
   698     12  PI-REM-TRM-CALC-OPTION          PIC X.
   699
   700     12  PI-LANGUAGE-TYPE                PIC X.
   701             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   702             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   703             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   704
   705     12  PI-POLICY-LINKAGE-IND           PIC X.
   706         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   707         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   708                                                   LOW-VALUES.
   709
   710     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   711     12  PI-CLAIM-PW-SESSION             PIC X(1).
   712         88  PI-CLAIM-CREDIT                 VALUE '1'.
   713         88  PI-CLAIM-CONVEN                 VALUE '2'.
   714     12  FILLER                          PIC X(4).
   715
   716     12  PI-SYSTEM-LEVEL                 PIC X(145).
   717
   718     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   719         PI-SYSTEM-LEVEL.
   720
   721         16  PI-ENTRY-CODES.
   722             20  PI-ENTRY-CD-1           PIC X.
   723             20  PI-ENTRY-CD-2           PIC X.
   724
   725         16  PI-RETURN-CODES.
   726             20  PI-RETURN-CD-1          PIC X.
   727             20  PI-RETURN-CD-2          PIC X.
   728
   729         16  PI-UPDATE-STATUS-SAVE.
   730             20  PI-UPDATE-BY            PIC X(4).
   731             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   732
   733         16  PI-LOWER-CASE-LETTERS       PIC X.
   734             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   735
   736*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   737*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   738*            88  CARRIER-CLM-CNTL            VALUE '2'.
   739
   740         16  PI-CERT-ACCESS-CONTROL      PIC X.
   741             88  ST-ACCNT-CNTL               VALUE ' '.
   742             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   743             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   744             88  ACCNT-CNTL                  VALUE '3'.
   745             88  CARR-ACCNT-CNTL             VALUE '4'.
   746
   747         16  PI-PROCESSOR-CAP-LIST.
   748             20  PI-SYSTEM-CONTROLS.
   749                24 PI-SYSTEM-DISPLAY     PIC X.
   750                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   751                24 PI-SYSTEM-MODIFY      PIC X.
   752                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   753             20  FILLER                  PIC XX.
   754             20  PI-DISPLAY-CAP          PIC X.
   755                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL653.cbl
   756             20  PI-MODIFY-CAP           PIC X.
   757                 88  MODIFY-CAP              VALUE 'Y'.
   758             20  PI-MSG-AT-LOGON-CAP     PIC X.
   759                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   760             20  PI-FORCE-CAP            PIC X.
   761                 88  FORCE-CAP               VALUE 'Y'.
   762
   763         16  PI-PROGRAM-CONTROLS.
   764             20  PI-PGM-PRINT-OPT        PIC X.
   765             20  PI-PGM-FORMAT-OPT       PIC X.
   766             20  PI-PGM-PROCESS-OPT      PIC X.
   767             20  PI-PGM-TOTALS-OPT       PIC X.
   768
   769         16  PI-HELP-INTERFACE.
   770             20  PI-LAST-ERROR-NO        PIC X(4).
   771             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   772
   773         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   774             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   775
   776         16  PI-CR-CONTROL-IN-PROGRESS.
   777             20  PI-CR-CARRIER           PIC X.
   778             20  PI-CR-GROUPING          PIC X(6).
   779             20  PI-CR-STATE             PIC XX.
   780             20  PI-CR-ACCOUNT           PIC X(10).
   781             20  PI-CR-FIN-RESP          PIC X(10).
   782             20  PI-CR-TYPE              PIC X.
   783
   784         16  PI-CR-BATCH-NUMBER          PIC X(6).
   785
   786         16  PI-CR-MONTH-END-DT          PIC XX.
   787
   788         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   789             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   790             88  PI-ZERO-CARRIER             VALUE '1'.
   791             88  PI-ZERO-GROUPING            VALUE '2'.
   792             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   793
   794         16  PI-CARRIER-SECURITY         PIC X.
   795             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   796
   797         16  PI-ACCOUNT-SECURITY         PIC X(10).
   798             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   799             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   800
   801         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   802             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   803                                         INDEXED BY PI-ACCESS-NDX
   804                                         PIC X.
   805
   806         16  PI-GA-BILLING-CONTROL       PIC X.
   807             88  PI-GA-BILLING               VALUE '1'.
   808
   809         16  PI-MAIL-PROCESSING          PIC X.
   810             88  PI-MAIL-YES                 VALUE 'Y'.
   811
   812         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   813
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL653.cbl
   814         16  PI-AR-SYSTEM.
   815             20  PI-AR-PROCESSING-CNTL   PIC X.
   816                 88  PI-AR-PROCESSING        VALUE 'Y'.
   817             20  PI-AR-SUMMARY-CODE      PIC X(6).
   818             20  PI-AR-MONTH-END-DT      PIC XX.
   819
   820         16  PI-MP-SYSTEM.
   821             20  PI-MORTGAGE-USER            PIC X.
   822                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   823                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   824             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   825                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   826                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   827                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   828                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   829                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   830             20  PI-MP-MONTH-END-DT          PIC XX.
   831             20  PI-MP-REFERENCE-NO.
   832                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   833                 24  PI-MP-REFERENCE-SFX     PIC XX.
   834
   835         16  PI-LABEL-CONTROL            PIC X(01).
   836             88  PI-CREATE-LABELS                    VALUE 'Y'.
   837             88  PI-BYPASS-LABELS                    VALUE 'N'.
   838
   839         16  PI-BILL-GROUPING-CODE       PIC X(01).
   840             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   841
   842         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   843             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   844             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   845
   846         16  FILLER                      PIC X(14).
   847
   848     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   849******************************************************************
   850     12  PI-WORK-AREA  REDEFINES  PI-PROGRAM-WORK-AREA.
   851         16  PI-CHECK-MAINT-TYPE     PIC  X.
   852             88  VALID-MAINT-TYPE            VALUE 'S' 'A'
   853                                                   'C' 'D'.
   854             88  ADD-FUNCTION                VALUE 'A'.
   855             88  SHOW-FUNCTION               VALUE 'S'.
   856             88  DELETE-FUNCTION             VALUE 'D'.
   857             88  CHANGE-FUNCTION             VALUE 'C'.
   858         16  PI-CHECK-TBLCODE.
   859             20  PI-TBLCODE-1ST-CHAR PIC  X.
   860                 88  1ST-CHAR-ALPHA          VALUE 'A' THRU 'Z'.
   861             20  PI-TBLCODE-REST     PIC  XX.
   862         16  PI-CHECK-COVERAGE       PIC  X.
   863         16  PI-BROWSE-SW            PIC  X.
   864             88  BROWSE-STARTED              VALUE 'Y'.
   865         16  PI-FIRST-TIME-SW        PIC  X.
   866             88  FIRST-TIME                  VALUE 'Y'.
   867         16  PI-ERCTBL-EOF-SW        PIC  X.
   868             88  ERCTBL-EOF                  VALUE 'Y'.
   869         16  PI-ERCTBL-KEY.
   870             20  PI-ERC-COMPANY-CD   PIC  X.
   871             20  PI-ERC-TABLE        PIC  X(3).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL653.cbl
   872             20  PI-ERC-CNTRL2.
   873                 24  PI-ERC-BEN-TYPE
   874                                     PIC  X.
   875                 24  PI-ERC-BEN-CODE
   876                                     PIC  XX.
   877         16  PI-SAVE-ERCTBL-KEY      PIC  X(7).
   878         16  FILLER                  PIC  X(618).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL653.cbl
   880*                            COPY ELCJPFX.
   881******************************************************************
   882*                                                                *
   883*                                                                *
   884*                            ELCJPFX.                            *
   885*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   886*                            VMOD=2.002                          *
   887*                                                                *
   888*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   889*                                                                *
   890*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   891*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   892*        ELCNTL - CONTROL FILE                                   *
   893*        ELMSTR - CLAIM MASTERS                                  *
   894*        ELTRLR - ACTIVITY TRAILERS                              *
   895*        ELCHKQ - CHECK QUE                                      *
   896******************************************************************
   897 01  JOURNAL-RECORD.
   898     12  JP-USER-ID                  PIC X(4).
   899     12  JP-FILE-ID                  PIC X(8).
   900     12  JP-PROGRAM-ID               PIC X(8).
   901     12  JP-RECORD-TYPE              PIC X.
   902         88 JP-ADD              VALUE 'A'.
   903         88 JP-BEFORE-CHANGE    VALUE 'B'.
   904         88 JP-AFTER-CHANGE     VALUE 'C'.
   905         88 JP-DELETE           VALUE 'D'.
   906         88 JP-GENERIC-DELETE   VALUE 'G'.
   907         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   908         88 JP-KEY-CHG-ADD      VALUE 'N'.
   909     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   910     12  JP-RECORD-AREA
   911
   912
   913                             PIC  X(750).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL653.cbl
   915*                            COPY ELCAID.
   916******************************************************************
   917*                                                                *
   918*                            ELCAID.                             *
   919*                            VMOD=2.001                          *
   920*                                                                *
   921*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   922*                                                                *
   923*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   924*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   925******************************************************************
   926
   927 01  DFHAID.
   928   02  DFHNULL   PIC  X  VALUE  ' '.
   929   02  DFHENTER  PIC  X  VALUE  QUOTE.
   930   02  DFHCLEAR  PIC  X  VALUE  '_'.
   931   02  DFHPEN    PIC  X  VALUE  '='.
   932   02  DFHOPID   PIC  X  VALUE  'W'.
   933   02  DFHPA1    PIC  X  VALUE  '%'.
   934   02  DFHPA2    PIC  X  VALUE  '>'.
   935   02  DFHPA3    PIC  X  VALUE  ','.
   936   02  DFHPF1    PIC  X  VALUE  '1'.
   937   02  DFHPF2    PIC  X  VALUE  '2'.
   938   02  DFHPF3    PIC  X  VALUE  '3'.
   939   02  DFHPF4    PIC  X  VALUE  '4'.
   940   02  DFHPF5    PIC  X  VALUE  '5'.
   941   02  DFHPF6    PIC  X  VALUE  '6'.
   942   02  DFHPF7    PIC  X  VALUE  '7'.
   943   02  DFHPF8    PIC  X  VALUE  '8'.
   944   02  DFHPF9    PIC  X  VALUE  '9'.
   945   02  DFHPF10   PIC  X  VALUE  ':'.
   946   02  DFHPF11   PIC  X  VALUE  '#'.
   947   02  DFHPF12   PIC  X  VALUE  '@'.
   948   02  DFHPF13   PIC  X  VALUE  'A'.
   949   02  DFHPF14   PIC  X  VALUE  'B'.
   950   02  DFHPF15   PIC  X  VALUE  'C'.
   951   02  DFHPF16   PIC  X  VALUE  'D'.
   952   02  DFHPF17   PIC  X  VALUE  'E'.
   953   02  DFHPF18   PIC  X  VALUE  'F'.
   954   02  DFHPF19   PIC  X  VALUE  'G'.
   955   02  DFHPF20   PIC  X  VALUE  'H'.
   956   02  DFHPF21   PIC  X  VALUE  'I'.
   957*00039    02  DFHPF22   PIC  X  VALUE  ''.
   958   02  DFHPF22   PIC  X  VALUE  '['.
   959   02  DFHPF23   PIC  X  VALUE  '.'.
   960   02  DFHPF24   PIC  X  VALUE  '<'.
   961   02  DFHMSRE   PIC  X  VALUE  'X'.
   962   02  DFHSTRF   PIC  X  VALUE  'h'.
   963   02  DFHTRIG   PIC  X  VALUE  '"'.
   964
   965 01  FILLER  REDEFINES  DFHAID.
   966     12  FILLER              PIC  X(8).
   967     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL653.cbl
   969*                            COPY EL653S.
   970 01  EL653AI.
   971     05  FILLER            PIC  X(0012).
   972*    -------------------------------
   973     05  RUNDATEL PIC S9(0004) COMP.
   974     05  RUNDATEF PIC  X(0001).
   975     05  FILLER REDEFINES RUNDATEF.
   976         10  RUNDATEA PIC  X(0001).
   977     05  RUNDATEI PIC  X(0008).
   978*    -------------------------------
   979     05  RUNTIMEL PIC S9(0004) COMP.
   980     05  RUNTIMEF PIC  X(0001).
   981     05  FILLER REDEFINES RUNTIMEF.
   982         10  RUNTIMEA PIC  X(0001).
   983     05  RUNTIMEI PIC  X(0005).
   984*    -------------------------------
   985     05  CMPNYIDL PIC S9(0004) COMP.
   986     05  CMPNYIDF PIC  X(0001).
   987     05  FILLER REDEFINES CMPNYIDF.
   988         10  CMPNYIDA PIC  X(0001).
   989     05  CMPNYIDI PIC  X(0003).
   990*    -------------------------------
   991     05  USERIDL PIC S9(0004) COMP.
   992     05  USERIDF PIC  X(0001).
   993     05  FILLER REDEFINES USERIDF.
   994         10  USERIDA PIC  X(0001).
   995     05  USERIDI PIC  X(0004).
   996*    -------------------------------
   997     05  MAINTYPL PIC S9(0004) COMP.
   998     05  MAINTYPF PIC  X(0001).
   999     05  FILLER REDEFINES MAINTYPF.
  1000         10  MAINTYPA PIC  X(0001).
  1001     05  MAINTYPI PIC  X(0001).
  1002*    -------------------------------
  1003     05  TBLCODEL PIC S9(0004) COMP.
  1004     05  TBLCODEF PIC  X(0001).
  1005     05  FILLER REDEFINES TBLCODEF.
  1006         10  TBLCODEA PIC  X(0001).
  1007     05  TBLCODEI PIC  X(0003).
  1008*    -------------------------------
  1009     05  COVTYPEL PIC S9(0004) COMP.
  1010     05  COVTYPEF PIC  X(0001).
  1011     05  FILLER REDEFINES COVTYPEF.
  1012         10  COVTYPEA PIC  X(0001).
  1013     05  COVTYPEI PIC  X(0001).
  1014*    -------------------------------
  1015     05  BENCODEL PIC S9(0004) COMP.
  1016     05  BENCODEF PIC  X(0001).
  1017     05  FILLER REDEFINES BENCODEF.
  1018         10  BENCODEA PIC  X(0001).
  1019     05  BENCODEI PIC  X(0002).
  1020*    -------------------------------
  1021     05  TERM1L PIC S9(0004) COMP.
  1022     05  TERM1F PIC  X(0001).
  1023     05  FILLER REDEFINES TERM1F.
  1024         10  TERM1A PIC  X(0001).
  1025     05  TERM1I PIC  X(0003).
  1026*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL653.cbl
  1027     05  TERM2L PIC S9(0004) COMP.
  1028     05  TERM2F PIC  X(0001).
  1029     05  FILLER REDEFINES TERM2F.
  1030         10  TERM2A PIC  X(0001).
  1031     05  TERM2I PIC  X(0003).
  1032*    -------------------------------
  1033     05  TERM3L PIC S9(0004) COMP.
  1034     05  TERM3F PIC  X(0001).
  1035     05  FILLER REDEFINES TERM3F.
  1036         10  TERM3A PIC  X(0001).
  1037     05  TERM3I PIC  X(0003).
  1038*    -------------------------------
  1039     05  BEN1L PIC S9(0004) COMP.
  1040     05  BEN1F PIC  X(0001).
  1041     05  FILLER REDEFINES BEN1F.
  1042         10  BEN1A PIC  X(0001).
  1043     05  BEN1I PIC  S9(9)V99.
  1044*    -------------------------------
  1045     05  AGE10L PIC S9(0004) COMP.
  1046     05  AGE10F PIC  X(0001).
  1047     05  FILLER REDEFINES AGE10F.
  1048         10  AGE10A PIC  X(0001).
  1049     05  AGE10I PIC  X(0002).
  1050*    -------------------------------
  1051     05  RATE1L PIC S9(0004) COMP.
  1052     05  RATE1F PIC  X(0001).
  1053     05  FILLER REDEFINES RATE1F.
  1054         10  RATE1A PIC  X(0001).
  1055     05  RATE1I PIC  X(0007).
  1056*    -------------------------------
  1057     05  RATE2L PIC S9(0004) COMP.
  1058     05  RATE2F PIC  X(0001).
  1059     05  FILLER REDEFINES RATE2F.
  1060         10  RATE2A PIC  X(0001).
  1061     05  RATE2I PIC  X(0007).
  1062*    -------------------------------
  1063     05  RATE3L PIC S9(0004) COMP.
  1064     05  RATE3F PIC  X(0001).
  1065     05  FILLER REDEFINES RATE3F.
  1066         10  RATE3A PIC  X(0001).
  1067     05  RATE3I PIC  X(0007).
  1068*    -------------------------------
  1069     05  AGE11L PIC S9(0004) COMP.
  1070     05  AGE11F PIC  X(0001).
  1071     05  FILLER REDEFINES AGE11F.
  1072         10  AGE11A PIC  X(0001).
  1073     05  AGE11I PIC  X(0002).
  1074*    -------------------------------
  1075     05  RATE4L PIC S9(0004) COMP.
  1076     05  RATE4F PIC  X(0001).
  1077     05  FILLER REDEFINES RATE4F.
  1078         10  RATE4A PIC  X(0001).
  1079     05  RATE4I PIC  X(0007).
  1080*    -------------------------------
  1081     05  RATE5L PIC S9(0004) COMP.
  1082     05  RATE5F PIC  X(0001).
  1083     05  FILLER REDEFINES RATE5F.
  1084         10  RATE5A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL653.cbl
  1085     05  RATE5I PIC  X(0007).
  1086*    -------------------------------
  1087     05  RATE6L PIC S9(0004) COMP.
  1088     05  RATE6F PIC  X(0001).
  1089     05  FILLER REDEFINES RATE6F.
  1090         10  RATE6A PIC  X(0001).
  1091     05  RATE6I PIC  X(0007).
  1092*    -------------------------------
  1093     05  AGE12L PIC S9(0004) COMP.
  1094     05  AGE12F PIC  X(0001).
  1095     05  FILLER REDEFINES AGE12F.
  1096         10  AGE12A PIC  X(0001).
  1097     05  AGE12I PIC  X(0002).
  1098*    -------------------------------
  1099     05  RATE7L PIC S9(0004) COMP.
  1100     05  RATE7F PIC  X(0001).
  1101     05  FILLER REDEFINES RATE7F.
  1102         10  RATE7A PIC  X(0001).
  1103     05  RATE7I PIC  X(0007).
  1104*    -------------------------------
  1105     05  RATE8L PIC S9(0004) COMP.
  1106     05  RATE8F PIC  X(0001).
  1107     05  FILLER REDEFINES RATE8F.
  1108         10  RATE8A PIC  X(0001).
  1109     05  RATE8I PIC  X(0007).
  1110*    -------------------------------
  1111     05  RATE9L PIC S9(0004) COMP.
  1112     05  RATE9F PIC  X(0001).
  1113     05  FILLER REDEFINES RATE9F.
  1114         10  RATE9A PIC  X(0001).
  1115     05  RATE9I PIC  X(0007).
  1116*    -------------------------------
  1117     05  BEN2L PIC S9(0004) COMP.
  1118     05  BEN2F PIC  X(0001).
  1119     05  FILLER REDEFINES BEN2F.
  1120         10  BEN2A PIC  X(0001).
  1121     05  BEN2I PIC  S9(9)V99.
  1122*    -------------------------------
  1123     05  AGE20L PIC S9(0004) COMP.
  1124     05  AGE20F PIC  X(0001).
  1125     05  FILLER REDEFINES AGE20F.
  1126         10  AGE20A PIC  X(0001).
  1127     05  AGE20I PIC  X(0002).
  1128*    -------------------------------
  1129     05  RATE10L PIC S9(0004) COMP.
  1130     05  RATE10F PIC  X(0001).
  1131     05  FILLER REDEFINES RATE10F.
  1132         10  RATE10A PIC  X(0001).
  1133     05  RATE10I PIC  X(0007).
  1134*    -------------------------------
  1135     05  RATE11L PIC S9(0004) COMP.
  1136     05  RATE11F PIC  X(0001).
  1137     05  FILLER REDEFINES RATE11F.
  1138         10  RATE11A PIC  X(0001).
  1139     05  RATE11I PIC  X(0007).
  1140*    -------------------------------
  1141     05  RATE12L PIC S9(0004) COMP.
  1142     05  RATE12F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL653.cbl
  1143     05  FILLER REDEFINES RATE12F.
  1144         10  RATE12A PIC  X(0001).
  1145     05  RATE12I PIC  X(0007).
  1146*    -------------------------------
  1147     05  AGE21L PIC S9(0004) COMP.
  1148     05  AGE21F PIC  X(0001).
  1149     05  FILLER REDEFINES AGE21F.
  1150         10  AGE21A PIC  X(0001).
  1151     05  AGE21I PIC  X(0002).
  1152*    -------------------------------
  1153     05  RATE13L PIC S9(0004) COMP.
  1154     05  RATE13F PIC  X(0001).
  1155     05  FILLER REDEFINES RATE13F.
  1156         10  RATE13A PIC  X(0001).
  1157     05  RATE13I PIC  X(0007).
  1158*    -------------------------------
  1159     05  RATE14L PIC S9(0004) COMP.
  1160     05  RATE14F PIC  X(0001).
  1161     05  FILLER REDEFINES RATE14F.
  1162         10  RATE14A PIC  X(0001).
  1163     05  RATE14I PIC  X(0007).
  1164*    -------------------------------
  1165     05  RATE15L PIC S9(0004) COMP.
  1166     05  RATE15F PIC  X(0001).
  1167     05  FILLER REDEFINES RATE15F.
  1168         10  RATE15A PIC  X(0001).
  1169     05  RATE15I PIC  X(0007).
  1170*    -------------------------------
  1171     05  AGE22L PIC S9(0004) COMP.
  1172     05  AGE22F PIC  X(0001).
  1173     05  FILLER REDEFINES AGE22F.
  1174         10  AGE22A PIC  X(0001).
  1175     05  AGE22I PIC  X(0002).
  1176*    -------------------------------
  1177     05  RATE16L PIC S9(0004) COMP.
  1178     05  RATE16F PIC  X(0001).
  1179     05  FILLER REDEFINES RATE16F.
  1180         10  RATE16A PIC  X(0001).
  1181     05  RATE16I PIC  X(0007).
  1182*    -------------------------------
  1183     05  RATE17L PIC S9(0004) COMP.
  1184     05  RATE17F PIC  X(0001).
  1185     05  FILLER REDEFINES RATE17F.
  1186         10  RATE17A PIC  X(0001).
  1187     05  RATE17I PIC  X(0007).
  1188*    -------------------------------
  1189     05  RATE18L PIC S9(0004) COMP.
  1190     05  RATE18F PIC  X(0001).
  1191     05  FILLER REDEFINES RATE18F.
  1192         10  RATE18A PIC  X(0001).
  1193     05  RATE18I PIC  X(0007).
  1194*    -------------------------------
  1195     05  BEN3L PIC S9(0004) COMP.
  1196     05  BEN3F PIC  X(0001).
  1197     05  FILLER REDEFINES BEN3F.
  1198         10  BEN3A PIC  X(0001).
  1199     05  BEN3I PIC  S9(9)V99.
  1200*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL653.cbl
  1201     05  AGE30L PIC S9(0004) COMP.
  1202     05  AGE30F PIC  X(0001).
  1203     05  FILLER REDEFINES AGE30F.
  1204         10  AGE30A PIC  X(0001).
  1205     05  AGE30I PIC  X(0002).
  1206*    -------------------------------
  1207     05  RATE19L PIC S9(0004) COMP.
  1208     05  RATE19F PIC  X(0001).
  1209     05  FILLER REDEFINES RATE19F.
  1210         10  RATE19A PIC  X(0001).
  1211     05  RATE19I PIC  X(0007).
  1212*    -------------------------------
  1213     05  RATE20L PIC S9(0004) COMP.
  1214     05  RATE20F PIC  X(0001).
  1215     05  FILLER REDEFINES RATE20F.
  1216         10  RATE20A PIC  X(0001).
  1217     05  RATE20I PIC  X(0007).
  1218*    -------------------------------
  1219     05  RATE21L PIC S9(0004) COMP.
  1220     05  RATE21F PIC  X(0001).
  1221     05  FILLER REDEFINES RATE21F.
  1222         10  RATE21A PIC  X(0001).
  1223     05  RATE21I PIC  X(0007).
  1224*    -------------------------------
  1225     05  AGE31L PIC S9(0004) COMP.
  1226     05  AGE31F PIC  X(0001).
  1227     05  FILLER REDEFINES AGE31F.
  1228         10  AGE31A PIC  X(0001).
  1229     05  AGE31I PIC  X(0002).
  1230*    -------------------------------
  1231     05  RATE22L PIC S9(0004) COMP.
  1232     05  RATE22F PIC  X(0001).
  1233     05  FILLER REDEFINES RATE22F.
  1234         10  RATE22A PIC  X(0001).
  1235     05  RATE22I PIC  X(0007).
  1236*    -------------------------------
  1237     05  RATE23L PIC S9(0004) COMP.
  1238     05  RATE23F PIC  X(0001).
  1239     05  FILLER REDEFINES RATE23F.
  1240         10  RATE23A PIC  X(0001).
  1241     05  RATE23I PIC  X(0007).
  1242*    -------------------------------
  1243     05  RATE24L PIC S9(0004) COMP.
  1244     05  RATE24F PIC  X(0001).
  1245     05  FILLER REDEFINES RATE24F.
  1246         10  RATE24A PIC  X(0001).
  1247     05  RATE24I PIC  X(0007).
  1248*    -------------------------------
  1249     05  AGE32L PIC S9(0004) COMP.
  1250     05  AGE32F PIC  X(0001).
  1251     05  FILLER REDEFINES AGE32F.
  1252         10  AGE32A PIC  X(0001).
  1253     05  AGE32I PIC  X(0002).
  1254*    -------------------------------
  1255     05  RATE25L PIC S9(0004) COMP.
  1256     05  RATE25F PIC  X(0001).
  1257     05  FILLER REDEFINES RATE25F.
  1258         10  RATE25A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL653.cbl
  1259     05  RATE25I PIC  X(0007).
  1260*    -------------------------------
  1261     05  RATE26L PIC S9(0004) COMP.
  1262     05  RATE26F PIC  X(0001).
  1263     05  FILLER REDEFINES RATE26F.
  1264         10  RATE26A PIC  X(0001).
  1265     05  RATE26I PIC  X(0007).
  1266*    -------------------------------
  1267     05  RATE27L PIC S9(0004) COMP.
  1268     05  RATE27F PIC  X(0001).
  1269     05  FILLER REDEFINES RATE27F.
  1270         10  RATE27A PIC  X(0001).
  1271     05  RATE27I PIC  X(0007).
  1272*    -------------------------------
  1273     05  ERRMSG1L PIC S9(0004) COMP.
  1274     05  ERRMSG1F PIC  X(0001).
  1275     05  FILLER REDEFINES ERRMSG1F.
  1276         10  ERRMSG1A PIC  X(0001).
  1277     05  ERRMSG1I PIC  X(0072).
  1278*    -------------------------------
  1279     05  ERRMSG2L PIC S9(0004) COMP.
  1280     05  ERRMSG2F PIC  X(0001).
  1281     05  FILLER REDEFINES ERRMSG2F.
  1282         10  ERRMSG2A PIC  X(0001).
  1283     05  ERRMSG2I PIC  X(0072).
  1284*    -------------------------------
  1285     05  PFENTERL PIC S9(0004) COMP.
  1286     05  PFENTERF PIC  X(0001).
  1287     05  FILLER REDEFINES PFENTERF.
  1288         10  PFENTERA PIC  X(0001).
  1289     05  PFENTERI PIC  99.
  1290 01  EL653AO REDEFINES EL653AI.
  1291     05  FILLER            PIC  X(0012).
  1292*    -------------------------------
  1293     05  FILLER            PIC  X(0003).
  1294     05  RUNDATEO PIC  X(0008).
  1295*    -------------------------------
  1296     05  FILLER            PIC  X(0003).
  1297     05  RUNTIMEO PIC  99.99.
  1298*    -------------------------------
  1299     05  FILLER            PIC  X(0003).
  1300     05  CMPNYIDO PIC  X(0003).
  1301*    -------------------------------
  1302     05  FILLER            PIC  X(0003).
  1303     05  USERIDO PIC  X(0004).
  1304*    -------------------------------
  1305     05  FILLER            PIC  X(0003).
  1306     05  MAINTYPO PIC  X(0001).
  1307*    -------------------------------
  1308     05  FILLER            PIC  X(0003).
  1309     05  TBLCODEO PIC  X(0003).
  1310*    -------------------------------
  1311     05  FILLER            PIC  X(0003).
  1312     05  COVTYPEO PIC  X(0001).
  1313*    -------------------------------
  1314     05  FILLER            PIC  X(0003).
  1315     05  BENCODEO PIC  X(0002).
  1316*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL653.cbl
  1317     05  FILLER            PIC  X(0003).
  1318     05  TERM1O PIC  X(0003).
  1319*    -------------------------------
  1320     05  FILLER            PIC  X(0003).
  1321     05  TERM2O PIC  X(0003).
  1322*    -------------------------------
  1323     05  FILLER            PIC  X(0003).
  1324     05  TERM3O PIC  X(0003).
  1325*    -------------------------------
  1326     05  FILLER            PIC  X(0003).
  1327     05  BEN1O PIC  ZZZZ,ZZZ.99.
  1328*    -------------------------------
  1329     05  FILLER            PIC  X(0003).
  1330     05  AGE10O PIC  X(0002).
  1331*    -------------------------------
  1332     05  FILLER            PIC  X(0003).
  1333     05  RATE1O PIC  .99999-.
  1334*    -------------------------------
  1335     05  FILLER            PIC  X(0003).
  1336     05  RATE2O PIC  .99999-.
  1337*    -------------------------------
  1338     05  FILLER            PIC  X(0003).
  1339     05  RATE3O PIC  .99999-.
  1340*    -------------------------------
  1341     05  FILLER            PIC  X(0003).
  1342     05  AGE11O PIC  X(0002).
  1343*    -------------------------------
  1344     05  FILLER            PIC  X(0003).
  1345     05  RATE4O PIC  .99999-.
  1346*    -------------------------------
  1347     05  FILLER            PIC  X(0003).
  1348     05  RATE5O PIC  .99999-.
  1349*    -------------------------------
  1350     05  FILLER            PIC  X(0003).
  1351     05  RATE6O PIC  .99999-.
  1352*    -------------------------------
  1353     05  FILLER            PIC  X(0003).
  1354     05  AGE12O PIC  X(0002).
  1355*    -------------------------------
  1356     05  FILLER            PIC  X(0003).
  1357     05  RATE7O PIC  .99999-.
  1358*    -------------------------------
  1359     05  FILLER            PIC  X(0003).
  1360     05  RATE8O PIC  .99999-.
  1361*    -------------------------------
  1362     05  FILLER            PIC  X(0003).
  1363     05  RATE9O PIC  .99999-.
  1364*    -------------------------------
  1365     05  FILLER            PIC  X(0003).
  1366     05  BEN2O PIC  ZZZZ,ZZZ.99.
  1367*    -------------------------------
  1368     05  FILLER            PIC  X(0003).
  1369     05  AGE20O PIC  X(0002).
  1370*    -------------------------------
  1371     05  FILLER            PIC  X(0003).
  1372     05  RATE10O PIC  .99999-.
  1373*    -------------------------------
  1374     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL653.cbl
  1375     05  RATE11O PIC  .99999-.
  1376*    -------------------------------
  1377     05  FILLER            PIC  X(0003).
  1378     05  RATE12O PIC  .99999-.
  1379*    -------------------------------
  1380     05  FILLER            PIC  X(0003).
  1381     05  AGE21O PIC  X(0002).
  1382*    -------------------------------
  1383     05  FILLER            PIC  X(0003).
  1384     05  RATE13O PIC  .99999-.
  1385*    -------------------------------
  1386     05  FILLER            PIC  X(0003).
  1387     05  RATE14O PIC  .99999-.
  1388*    -------------------------------
  1389     05  FILLER            PIC  X(0003).
  1390     05  RATE15O PIC  .99999-.
  1391*    -------------------------------
  1392     05  FILLER            PIC  X(0003).
  1393     05  AGE22O PIC  X(0002).
  1394*    -------------------------------
  1395     05  FILLER            PIC  X(0003).
  1396     05  RATE16O PIC  .99999-.
  1397*    -------------------------------
  1398     05  FILLER            PIC  X(0003).
  1399     05  RATE17O PIC  .99999-.
  1400*    -------------------------------
  1401     05  FILLER            PIC  X(0003).
  1402     05  RATE18O PIC  .99999-.
  1403*    -------------------------------
  1404     05  FILLER            PIC  X(0003).
  1405     05  BEN3O PIC  ZZZZ,ZZZ.99.
  1406*    -------------------------------
  1407     05  FILLER            PIC  X(0003).
  1408     05  AGE30O PIC  X(0002).
  1409*    -------------------------------
  1410     05  FILLER            PIC  X(0003).
  1411     05  RATE19O PIC  .99999-.
  1412*    -------------------------------
  1413     05  FILLER            PIC  X(0003).
  1414     05  RATE20O PIC  .99999-.
  1415*    -------------------------------
  1416     05  FILLER            PIC  X(0003).
  1417     05  RATE21O PIC  .99999-.
  1418*    -------------------------------
  1419     05  FILLER            PIC  X(0003).
  1420     05  AGE31O PIC  X(0002).
  1421*    -------------------------------
  1422     05  FILLER            PIC  X(0003).
  1423     05  RATE22O PIC  .99999-.
  1424*    -------------------------------
  1425     05  FILLER            PIC  X(0003).
  1426     05  RATE23O PIC  .99999-.
  1427*    -------------------------------
  1428     05  FILLER            PIC  X(0003).
  1429     05  RATE24O PIC  .99999-.
  1430*    -------------------------------
  1431     05  FILLER            PIC  X(0003).
  1432     05  AGE32O PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL653.cbl
  1433*    -------------------------------
  1434     05  FILLER            PIC  X(0003).
  1435     05  RATE25O PIC  .99999-.
  1436*    -------------------------------
  1437     05  FILLER            PIC  X(0003).
  1438     05  RATE26O PIC  .99999-.
  1439*    -------------------------------
  1440     05  FILLER            PIC  X(0003).
  1441     05  RATE27O PIC  .99999-.
  1442*    -------------------------------
  1443     05  FILLER            PIC  X(0003).
  1444     05  ERRMSG1O PIC  X(0072).
  1445*    -------------------------------
  1446     05  FILLER            PIC  X(0003).
  1447     05  ERRMSG2O PIC  X(0072).
  1448*    -------------------------------
  1449     05  FILLER            PIC  X(0003).
  1450     05  PFENTERO PIC  99.
  1451*    -------------------------------
  1452
  1453 01  EL653AO-R  REDEFINES  EL653AI.
  1454     12  FILLER                      PIC  X(81).
  1455     12  SCREEN-TABLE    OCCURS 3 TIMES
  1456                             INDEXED BY ST-INDX.
  1457         16  CTBL-TBF-L              PIC S9(4)          COMP.
  1458         16  CTBL-TBF-A              PIC  X.
  1459         16  CTBL-TBF                PIC S9(11).
  1460         16  CTBL-TBF-DISP  REDEFINES
  1461             CTBL-TBF                PIC ZZZZ,ZZZ.99.
  1462         16  CTBL-AGE-TABLE  OCCURS 3 TIMES
  1463                                 INDEXED BY AT-INDX.
  1464             20  CTBL-AGE-L          PIC S9(4)          COMP.
  1465             20  CTBL-AGE-A          PIC  X.
  1466             20  CTBL-AGE            PIC  99.
  1467             20  CTBL-RATE-TABLE OCCURS 3 TIMES
  1468                                     INDEXED BY RT-INDX.
  1469                 24  CTBL-RATE-L     PIC S9(4)          COMP.
  1470                 24  CTBL-RATE-A     PIC  X.
  1471                 24  CTBL-RATE       PIC X(7).
  1472                 24  CTBL-RATE-DISP  REDEFINES
  1473                     CTBL-RATE       PIC .99999-.
  1474     12  FILLER                      PIC  X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL653.cbl
  1476****************************************************************
  1477*
  1478* Copyright (c) 2007 by Clerity Solutions, Inc.
  1479* All rights reserved.
  1480*
  1481****************************************************************
  1482 01  DFHEIV.
  1483   02  DFHEIV0               PIC X(35).
  1484   02  DFHEIV1               PIC X(08).
  1485   02  DFHEIV2               PIC X(08).
  1486   02  DFHEIV3               PIC X(08).
  1487   02  DFHEIV4               PIC X(06).
  1488   02  DFHEIV5               PIC X(04).
  1489   02  DFHEIV6               PIC X(04).
  1490   02  DFHEIV7               PIC X(02).
  1491   02  DFHEIV8               PIC X(02).
  1492   02  DFHEIV9               PIC X(01).
  1493   02  DFHEIV10              PIC S9(7) COMP-3.
  1494   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1495   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1496   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1497   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1498   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1499   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1500   02  DFHEIV17              PIC X(04).
  1501   02  DFHEIV18              PIC X(04).
  1502   02  DFHEIV19              PIC X(04).
  1503   02  DFHEIV20              USAGE IS POINTER.
  1504   02  DFHEIV21              USAGE IS POINTER.
  1505   02  DFHEIV22              USAGE IS POINTER.
  1506   02  DFHEIV23              USAGE IS POINTER.
  1507   02  DFHEIV24              USAGE IS POINTER.
  1508   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1509   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1510   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1511   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1512   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1513   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1514   02  FILLER                PIC X(02).
  1515   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1516   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1517   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1518   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1519   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1520 LINKAGE  SECTION.
  1521*****************************************************************
  1522*                                                               *
  1523* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1524* All rights reserved.                                          *
  1525*                                                               *
  1526*****************************************************************
  1527 01  dfheiblk.
  1528     02  eibtime          pic s9(7) comp-3.
  1529     02  eibdate          pic s9(7) comp-3.
  1530     02  eibtrnid         pic x(4).
  1531     02  eibtaskn         pic s9(7) comp-3.
  1532     02  eibtrmid         pic x(4).
  1533     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL653.cbl
  1534     02  eibcposn         pic s9(4) comp.
  1535     02  eibcalen         pic s9(4) comp.
  1536     02  eibaid           pic x(1).
  1537     02  eibfiller1       pic x(1).
  1538     02  eibfn            pic x(2).
  1539     02  eibfiller2       pic x(2).
  1540     02  eibrcode         pic x(6).
  1541     02  eibfiller3       pic x(2).
  1542     02  eibds            pic x(8).
  1543     02  eibreqid         pic x(8).
  1544     02  eibrsrce         pic x(8).
  1545     02  eibsync          pic x(1).
  1546     02  eibfree          pic x(1).
  1547     02  eibrecv          pic x(1).
  1548     02  eibsend          pic x(1).
  1549     02  eibatt           pic x(1).
  1550     02  eibeoc           pic x(1).
  1551     02  eibfmh           pic x(1).
  1552     02  eibcompl         pic x(1).
  1553     02  eibsig           pic x(1).
  1554     02  eibconf          pic x(1).
  1555     02  eiberr           pic x(1).
  1556     02  eibrldbk         pic x(1).
  1557     02  eiberrcd         pic x(4).
  1558     02  eibsynrb         pic x(1).
  1559     02  eibnodat         pic x(1).
  1560     02  eibfiller5       pic x(2).
  1561     02  eibresp          pic 9(09) comp.
  1562     02  eibresp2         pic 9(09) comp.
  1563     02  dfheigdj         pic s9(4) comp.
  1564     02  dfheigdk         pic s9(4) comp.
  1565
  1566 01  DFHCOMMAREA             PIC  X(1024).
  1567
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL653.cbl
  1569*                            COPY ERCCTBL.
  1570******************************************************************
  1571*                                                                *
  1572*                                                                *
  1573*                            ERCCTBL                             *
  1574*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1575*                            VMOD=2.003
  1576*                                                                *
  1577*   ONLINE CREDIT SYSTEM                                         *
  1578*                                                                *
  1579*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  1580*                                                                *
  1581*   FILE TYPE = VSAM,KSDS                                        *
  1582*   RECORD SIZE = 200   RECFORM = FIXED                          *
  1583*                                                                *
  1584*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  1585*       ALTERNATE PATH = NONE                                    *
  1586*                                                                *
  1587*   LOG = NO                                                     *
  1588*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1589*                                                                *
  1590*                                                                *
  1591******************************************************************
  1592
  1593 01  COMM-TABLE-RECORD.
  1594     12  CT-RECORD-ID                      PIC XX.
  1595         88  VALID-CT-ID                      VALUE 'CT'.
  1596
  1597     12  CT-CONTROL-PRIMARY.
  1598         16  CT-COMPANY-CD                 PIC X.
  1599         16  CT-TABLE                      PIC XXX.
  1600         16  CT-CNTRL-2.
  1601             20  CT-BEN-TYPE               PIC X.
  1602             20  CT-BEN-CODE               PIC XX.
  1603
  1604     12  CT-MAINT-INFORMATION.
  1605         16  CT-LAST-MAINT-DT              PIC XX.
  1606         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1607         16  CT-LAST-MAINT-USER            PIC X(4).
  1608         16  FILLER                        PIC X(31).
  1609
  1610     12  CT-LIMITS.
  1611         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  1612
  1613         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  1614
  1615         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  1616
  1617     12  CT-RATES.
  1618         16  CT-RTX          OCCURS 27 TIMES.
  1619             20  CT-RT                     PIC SV9(5)     COMP-3.
  1620             20  CT-RT-R   REDEFINES
  1621                 CT-RT                     PIC XXX.
  1622
  1623     12  FILLER                            PIC  X(42).
  1624
  1625******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL653.cbl
  1627*                            COPY ELCCNTL.
  1628******************************************************************
  1629*                                                                *
  1630*                                                                *
  1631*                            ELCCNTL.                            *
  1632*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1633*                            VMOD=2.059                          *
  1634*                                                                *
  1635*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1636*                                                                *
  1637*   FILE TYPE = VSAM,KSDS                                        *
  1638*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1639*                                                                *
  1640*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1641*       ALTERNATE INDEX = NONE                                   *
  1642*                                                                *
  1643*   LOG = YES                                                    *
  1644*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1645******************************************************************
  1646*                   C H A N G E   L O G
  1647*
  1648* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1649*-----------------------------------------------------------------
  1650*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1651* EFFECTIVE    NUMBER
  1652*-----------------------------------------------------------------
  1653* 082503                   PEMA  ADD BENEFIT GROUP
  1654* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1655* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1656* 092705    2005050300006  PEMA  ADD SPP LEASES
  1657* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1658* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1659* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1660* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1661******************************************************************
  1662*
  1663 01  CONTROL-FILE.
  1664     12  CF-RECORD-ID                       PIC XX.
  1665         88  VALID-CF-ID                        VALUE 'CF'.
  1666
  1667     12  CF-CONTROL-PRIMARY.
  1668         16  CF-COMPANY-ID                  PIC XXX.
  1669         16  CF-RECORD-TYPE                 PIC X.
  1670             88  CF-COMPANY-MASTER              VALUE '1'.
  1671             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1672             88  CF-STATE-MASTER                VALUE '3'.
  1673             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1674             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1675             88  CF-CARRIER-MASTER              VALUE '6'.
  1676             88  CF-MORTALITY-MASTER            VALUE '7'.
  1677             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1678             88  CF-TERMINAL-MASTER             VALUE '9'.
  1679             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1680             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1681             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1682             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1683             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1684             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL653.cbl
  1685             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1686             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1687             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1688         16  CF-ACCESS-CD-GENL              PIC X(4).
  1689         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1690             20  CF-PROCESSOR               PIC X(4).
  1691         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1692             20  CF-STATE-CODE              PIC XX.
  1693             20  FILLER                     PIC XX.
  1694         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1695             20  FILLER                     PIC XX.
  1696             20  CF-HI-BEN-IN-REC           PIC XX.
  1697         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1698             20  FILLER                     PIC XXX.
  1699             20  CF-CARRIER-CNTL            PIC X.
  1700         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1701             20  FILLER                     PIC XX.
  1702             20  CF-HI-TYPE-IN-REC          PIC 99.
  1703         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1704             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1705                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1706             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1707             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1708         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1709             20  FILLER                     PIC X.
  1710             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1711         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1712             20  FILLER                     PIC XX.
  1713             20  CF-MORTGAGE-PLAN           PIC XX.
  1714         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1715
  1716     12  CF-LAST-MAINT-DT                   PIC XX.
  1717     12  CF-LAST-MAINT-BY                   PIC X(4).
  1718     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1719
  1720     12  CF-RECORD-BODY                     PIC X(728).
  1721
  1722
  1723****************************************************************
  1724*             COMPANY MASTER RECORD                            *
  1725****************************************************************
  1726
  1727     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1728         16  CF-COMPANY-ADDRESS.
  1729             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1730             20  CF-CL-IN-CARE-OF           PIC X(30).
  1731             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1732             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1733             20  CF-CL-CITY-STATE           PIC X(30).
  1734             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1735             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1736         16  CF-COMPANY-CD                  PIC X.
  1737         16  CF-COMPANY-PASSWORD            PIC X(8).
  1738         16  CF-SECURITY-OPTION             PIC X.
  1739             88  ALL-SECURITY                   VALUE '1'.
  1740             88  COMPANY-VERIFY                 VALUE '2'.
  1741             88  PROCESSOR-VERIFY               VALUE '3'.
  1742             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL653.cbl
  1743             88  ALL-BUT-TERM                   VALUE '5'.
  1744         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1745             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1746         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1747             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1748         16  CF-INFORCE-LOCATION            PIC X.
  1749             88  CERTS-ARE-ONLINE               VALUE '1'.
  1750             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1751             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1752         16  CF-LOWER-CASE-LETTERS          PIC X.
  1753         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1754             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1755             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1756             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1757             88  CF-ACCNT-CNTL                  VALUE '3'.
  1758             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1759
  1760         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1761         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1762
  1763         16  CF-LGX-CREDIT-USER             PIC X.
  1764             88  CO-IS-NOT-USER                 VALUE 'N'.
  1765             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1766
  1767         16 CF-CREDIT-CALC-CODES.
  1768             20  CF-CR-REM-TERM-CALC PIC X.
  1769               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1770               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1771               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1772               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1773               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1774               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1775               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1776             20  CF-CR-R78-METHOD           PIC X.
  1777               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1778               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1779
  1780         16  CF-CLAIM-CONTROL-COUNTS.
  1781             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1782                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1783
  1784             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1785                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1786
  1787             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1788                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1789
  1790             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1791                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1792
  1793         16  CF-CURRENT-MONTH-END           PIC XX.
  1794
  1795         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1796             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1797             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1798             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1799             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1800                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL653.cbl
  1801                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1802             20  CF-CO-PREM-REJECT-SW       PIC X.
  1803                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1804                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1805             20  CF-CO-REF-REJECT-SW        PIC X.
  1806                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1807                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1808
  1809         16  CF-CO-REPORTING-DT             PIC XX.
  1810         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1811         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1812           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1813           88  CF-CO-MONTH-END                  VALUE '1'.
  1814
  1815         16  CF-LGX-CLAIM-USER              PIC X.
  1816             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1817             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1818
  1819         16  CF-CREDIT-EDIT-CONTROLS.
  1820             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1821             20  CF-MIN-AGE                 PIC 99.
  1822             20  CF-DEFAULT-AGE             PIC 99.
  1823             20  CF-MIN-TERM                PIC S999      COMP-3.
  1824             20  CF-MAX-TERM                PIC S999      COMP-3.
  1825             20  CF-DEFAULT-SEX             PIC X.
  1826             20  CF-JOINT-AGE-INPUT         PIC X.
  1827                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1828             20  CF-BIRTH-DATE-INPUT        PIC X.
  1829                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1830             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1831                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1832                 88  CF-ZERO-CARRIER            VALUE '1'.
  1833                 88  CF-ZERO-GROUPING           VALUE '2'.
  1834                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1835             20  CF-EDIT-SW                 PIC X.
  1836                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1837             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1838             20  CF-CR-PR-METHOD            PIC X.
  1839               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1840               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1841             20  FILLER                     PIC X.
  1842
  1843         16  CF-CREDIT-MISC-CONTROLS.
  1844             20  CF-REIN-TABLE-SW           PIC X.
  1845                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1846             20  CF-COMP-TABLE-SW           PIC X.
  1847                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1848             20  CF-EXPERIENCE-RETENTION-AGE
  1849                                            PIC S9        COMP-3.
  1850             20  CF-CONVERSION-DT           PIC XX.
  1851             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1852             20  CF-RUN-FREQUENCY-SW        PIC X.
  1853                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1854                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1855
  1856             20  CF-CR-CHECK-NO-CONTROL.
  1857                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1858                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL653.cbl
  1859                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1860                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1861                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1862                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1863
  1864                 24  CF-CR-CHECK-COUNT       REDEFINES
  1865                     CF-CR-CHECK-COUNTER      PIC X(4).
  1866
  1867                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1868                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1869
  1870                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1871                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1872                 24  CF-MAIL-PROCESSING       PIC X.
  1873                     88  MAIL-PROCESSING          VALUE 'Y'.
  1874
  1875         16  CF-MISC-SYSTEM-CONTROL.
  1876             20  CF-SYSTEM-C                 PIC X.
  1877                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1878             20  CF-SYSTEM-D                 PIC X.
  1879                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1880             20  CF-SOC-SEC-NO-SW            PIC X.
  1881                 88  SOC-SEC-NO-USED             VALUE '1'.
  1882             20  CF-MEMBER-NO-SW             PIC X.
  1883                 88  MEMBER-NO-USED              VALUE '1'.
  1884             20  CF-TAX-ID-NUMBER            PIC X(11).
  1885             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1886             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1887                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1888                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1889                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1890                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1891             20  CF-SYSTEM-E                 PIC X.
  1892                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1893
  1894         16  CF-LGX-LIFE-USER               PIC X.
  1895             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1896             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1897
  1898         16  CF-CR-MONTH-END-DT             PIC XX.
  1899
  1900         16  CF-FILE-MAINT-DATES.
  1901             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1902                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1903             20  CF-LAST-BATCH       REDEFINES
  1904                 CF-LAST-BATCH-NO               PIC X(4).
  1905             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1906             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1907             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1908             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1909             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1910             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1911             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1912             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1913             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1914             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1915
  1916         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL653.cbl
  1917         16  FILLER                         PIC X.
  1918
  1919         16  CF-ALT-MORT-CODE               PIC X(4).
  1920         16  CF-MEMBER-CAPTION              PIC X(10).
  1921
  1922         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1923             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1924             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1925             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1926             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1927             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1928
  1929         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1930
  1931         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1932         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1933         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1934         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1935
  1936         16  CF-AH-OVERRIDE-L1              PIC X.
  1937         16  CF-AH-OVERRIDE-L2              PIC XX.
  1938         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1939         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1940
  1941         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1942         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1943
  1944         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1945         16  CF-AR-LAST-EL860-DT            PIC XX.
  1946         16  CF-MP-MONTH-END-DT             PIC XX.
  1947
  1948         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1949         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1950             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1951
  1952         16  CF-AR-MONTH-END-DT             PIC XX.
  1953
  1954         16  CF-CRDTCRD-USER                PIC X.
  1955             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1956             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1957
  1958         16  CF-CC-MONTH-END-DT             PIC XX.
  1959
  1960         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1961
  1962         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1963             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1964             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1965             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1966         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1967         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1968         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1969         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1970             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1971             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1972         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1973         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1974         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL653.cbl
  1975             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1976         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1977
  1978         16  CF-CL-ZIP-CODE.
  1979             20  CF-CL-ZIP-PRIME.
  1980                 24  CF-CL-ZIP-1ST          PIC X.
  1981                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1982                 24  FILLER                 PIC X(4).
  1983             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1984         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1985             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1986             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1987             20  FILLER                     PIC XXX.
  1988
  1989         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1990         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1991         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1992         16  CF-CO-OPTION-START-DATE        PIC XX.
  1993         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1994           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1995                                                      '3' '4'.
  1996           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1997           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1998           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1999           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2000           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2001           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2002
  2003         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2004
  2005         16  CF-PAYMENT-APPROVAL-LEVELS.
  2006             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2007             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2008             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2009             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2010             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2011             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2012
  2013         16  CF-END-USER-REPORTING-USER     PIC X.
  2014             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2015             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2016
  2017         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2018             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2019             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2020
  2021         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2022
  2023         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2024         16  FILLER                         PIC X.
  2025
  2026         16  CF-CREDIT-ARCHIVE-CNTL.
  2027             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2028             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2029             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2030
  2031         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2032
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL653.cbl
  2033         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2034             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2035             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2036
  2037         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2038             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2039             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2040
  2041         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2042
  2043         16  CF-CO-ACH-ID-CODE              PIC  X.
  2044             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2045             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2046             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2047         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2048         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2049         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2050         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2051         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2052         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2053         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2054         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2055         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2056                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2057         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2058                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2059
  2060         16  CF-CO-OVER-SHORT.
  2061             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2062             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2063
  2064*         16  FILLER                         PIC X(102).
  2065         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2066             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2067             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2068
  2069         16  CF-AH-APPROVAL-DAYS.
  2070             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2071             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2072             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2073             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2074
  2075         16  FILLER                         PIC X(82).
  2076****************************************************************
  2077*             PROCESSOR/USER RECORD                            *
  2078****************************************************************
  2079
  2080     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2081         16  CF-PROCESSOR-NAME              PIC X(30).
  2082         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2083         16  CF-PROCESSOR-TITLE             PIC X(26).
  2084         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2085                 88  MESSAGE-YES                VALUE 'Y'.
  2086                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2087
  2088*****************************************************
  2089****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2090****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL653.cbl
  2091****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2092****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2093*****************************************************
  2094
  2095         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2096             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2097             20  CF-APPLICATION-FORCE       PIC X.
  2098             20  CF-INDIVIDUAL-APP.
  2099                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2100                     28  CF-BROWSE-APP      PIC X.
  2101                     28  CF-UPDATE-APP      PIC X.
  2102
  2103         16  CF-CURRENT-TERM-ON             PIC X(4).
  2104         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2105             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2106             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2107             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2108             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2109             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2110             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2111             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2112         16  CF-PROCESSOR-CARRIER           PIC X.
  2113             88  NO-CARRIER-SECURITY            VALUE ' '.
  2114         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2115             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2116         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2117             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2118         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2119             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2120
  2121         16  CF-PROC-SYS-ACCESS-SW.
  2122             20  CF-PROC-CREDIT-CLAIMS-SW.
  2123                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2124                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2125                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2126                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2127             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2128                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2129                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2130             20  CF-PROC-LIFE-GNRLDGR-SW.
  2131                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2132                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2133                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2134                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2135             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2136                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2137                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2138         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2139             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2140             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2141         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2142
  2143         16  CF-APPROVAL-LEVEL                  PIC X.
  2144             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2145             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2146             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2147             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2148
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL653.cbl
  2149         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2150
  2151         16  CF-LANGUAGE-TYPE                   PIC X.
  2152             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2153             88  CF-LANG-IS-FR                      VALUE 'F'.
  2154         16  FILLER                             PIC  X(240).
  2155
  2156****************************************************************
  2157*             PROCESSOR/REMINDERS RECORD                       *
  2158****************************************************************
  2159
  2160     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2161         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2162             20  CF-START-REMIND-DT         PIC XX.
  2163             20  CF-END-REMIND-DT           PIC XX.
  2164             20  CF-REMINDER-TEXT           PIC X(50).
  2165         16  FILLER                         PIC X(296).
  2166
  2167
  2168****************************************************************
  2169*             STATE MASTER RECORD                              *
  2170****************************************************************
  2171
  2172     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2173         16  CF-STATE-ABBREVIATION          PIC XX.
  2174         16  CF-STATE-NAME                  PIC X(25).
  2175         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2176         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2177             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2178             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2179             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2180             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2181                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2182                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2183             20  CF-ST-PREM-REJECT-SW       PIC X.
  2184                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2185                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2186             20  CF-ST-REF-REJECT-SW        PIC X.
  2187                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2188                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2189         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2190         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2191         16  CF-ST-REFUND-RULES.
  2192             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2193             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2194             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2195         16  CF-ST-FST-PMT-EXTENSION.
  2196             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2197             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2198                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2199                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2200                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2201                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2202         16  CF-ST-STATE-CALL.
  2203             20  CF-ST-CALL-UNEARNED        PIC X.
  2204             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2205             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2206         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL653.cbl
  2207             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2208             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2209         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2210         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2211         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2212         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2213         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2214         16  FILLER                         PIC X.
  2215         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2216             20  CF-ST-BENEFIT-CD           PIC XX.
  2217             20  CF-ST-BENEFIT-KIND         PIC X.
  2218                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2219                 88  CF-ST-AH-KIND              VALUE 'A'.
  2220             20  CF-ST-REM-TERM-CALC        PIC X.
  2221                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2222                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2223                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2224                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2225                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2226                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2227                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2228                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2229
  2230             20  CF-ST-REFUND-CALC          PIC X.
  2231                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2232                 88  ST-REFD-BY-R78             VALUE '1'.
  2233                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2234                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2235                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2236                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2237                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2238                 88  ST-REFD-UTAH               VALUE '7'.
  2239                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2240                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2241                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2242
  2243             20  CF-ST-EARNING-CALC         PIC X.
  2244                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2245                 88  ST-EARN-BY-R78             VALUE '1'.
  2246                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2247                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2248                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2249                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2250                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2251                 88  ST-EARN-MEAN               VALUE '8'.
  2252                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2253
  2254             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2255                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2256                 88  ST-OVRD-BY-R78             VALUE '1'.
  2257                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2258                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2259                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2260                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2261                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2262                 88  ST-OVRD-MEAN               VALUE '8'.
  2263                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2264             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL653.cbl
  2265
  2266         16  CF-ST-COMMISSION-CAPS.
  2267             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2268             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2269             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2270             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2271         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2272                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2273
  2274         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2275
  2276         16  CF-ST-STATUTORY-INTEREST.
  2277             20  CF-ST-STAT-DATE-FROM       PIC X.
  2278                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2279                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2280             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2281             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2282             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2283             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2284             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2285
  2286         16  CF-ST-OVER-SHORT.
  2287             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2288             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2289
  2290         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2291
  2292         16  CF-ST-RT-CALC                  PIC X.
  2293
  2294         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2295         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2296         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2297         16  CF-ST-RF-LR-CALC               PIC X.
  2298         16  CF-ST-RF-LL-CALC               PIC X.
  2299         16  CF-ST-RF-LN-CALC               PIC X.
  2300         16  CF-ST-RF-AH-CALC               PIC X.
  2301         16  CF-ST-RF-CP-CALC               PIC X.
  2302*        16  FILLER                         PIC X(206).
  2303*CIDMOD         16  FILLER                         PIC X(192).
  2304         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2305             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2306         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2307         16  FILLER                         PIC X(187).
  2308
  2309****************************************************************
  2310*             BENEFIT MASTER RECORD                            *
  2311****************************************************************
  2312
  2313     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2314         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2315             20  CF-BENEFIT-CODE            PIC XX.
  2316             20  CF-BENEFIT-NUMERIC  REDEFINES
  2317                 CF-BENEFIT-CODE            PIC XX.
  2318             20  CF-BENEFIT-ALPHA           PIC XXX.
  2319             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2320             20  CF-BENEFIT-COMMENT         PIC X(10).
  2321
  2322             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL653.cbl
  2323                 88  CF-REDUCING                VALUE 'R'.
  2324                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2325
  2326             20  CF-SPECIAL-CALC-CD         PIC X.
  2327                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2328                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2329                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2330                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2331                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2332                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2333                 88  CF-FARM-PLAN               VALUE 'F'.
  2334                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2335                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2336                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2337                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2338                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2339                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2340                 88  CF-PRUDENTIAL              VALUE 'P'.
  2341                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2342                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2343                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2344                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2345                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2346                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2347
  2348             20  CF-JOINT-INDICATOR         PIC X.
  2349                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2350
  2351*            20  FILLER                     PIC X(12).
  2352             20  FILLER                     PIC X(11).
  2353             20  CF-BENEFIT-CATEGORY        PIC X.
  2354             20  CF-LOAN-TYPE               PIC X(8).
  2355
  2356             20  CF-CO-REM-TERM-CALC        PIC X.
  2357                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2358                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2359                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2360                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2361                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2362
  2363             20  CF-CO-EARNINGS-CALC        PIC X.
  2364                 88  CO-EARN-BY-R78             VALUE '1'.
  2365                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2366                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2367                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2368                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2369                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2370                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2371                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2372
  2373             20  CF-CO-REFUND-CALC          PIC X.
  2374                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2375                 88  CO-REFD-BY-R78             VALUE '1'.
  2376                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2377                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2378                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2379                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2380                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL653.cbl
  2381                 88  CO-REFD-MEAN               VALUE '8'.
  2382                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2383                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2384                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2385
  2386             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2387                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2388                 88  CO-OVRD-BY-R78             VALUE '1'.
  2389                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2390                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2391                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2392                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2393                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2394                 88  CO-OVRD-MEAN               VALUE '8'.
  2395                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2396
  2397             20  CF-CO-BEN-I-G-CD           PIC X.
  2398                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2399                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2400                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2401
  2402         16  FILLER                         PIC X(304).
  2403
  2404
  2405****************************************************************
  2406*             CARRIER MASTER RECORD                            *
  2407****************************************************************
  2408
  2409     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2410         16  CF-ADDRESS-DATA.
  2411             20  CF-MAIL-TO-NAME            PIC X(30).
  2412             20  CF-IN-CARE-OF              PIC X(30).
  2413             20  CF-ADDRESS-LINE-1          PIC X(30).
  2414             20  CF-ADDRESS-LINE-2          PIC X(30).
  2415             20  CF-CITY-STATE              PIC X(30).
  2416             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2417             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2418
  2419         16  CF-CLAIM-NO-CONTROL.
  2420             20  CF-CLAIM-NO-METHOD         PIC X.
  2421                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2422                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2423                 88  CLAIM-NO-SEQ               VALUE '3'.
  2424                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2425             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2426                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2427                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2428                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2429
  2430         16  CF-CHECK-NO-CONTROL.
  2431             20  CF-CHECK-NO-METHOD         PIC X.
  2432                 88  CHECK-NO-MANUAL            VALUE '1'.
  2433                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2434                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2435                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2436             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2437                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2438
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL653.cbl
  2439         16  CF-DOMICILE-STATE              PIC XX.
  2440
  2441         16  CF-EXPENSE-CONTROLS.
  2442             20  CF-EXPENSE-METHOD          PIC X.
  2443                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2444                 88  DOLLARS-PER-PMT            VALUE '2'.
  2445                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2446                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2447             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2448             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2449
  2450         16  CF-CORRESPONDENCE-CONTROL.
  2451             20  CF-LETTER-RESEND-OPT       PIC X.
  2452                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2453                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2454             20  FILLER                     PIC X(4).
  2455
  2456         16  CF-RESERVE-CONTROLS.
  2457             20  CF-MANUAL-SW               PIC X.
  2458                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2459             20  CF-FUTURE-SW               PIC X.
  2460                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2461             20  CF-PTC-SW                  PIC X.
  2462                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2463             20  CF-IBNR-SW                 PIC X.
  2464                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2465             20  CF-PTC-LF-SW               PIC X.
  2466                 88  CF-LF-PTC-USED             VALUE '1'.
  2467             20  CF-CDT-ACCESS-METHOD       PIC X.
  2468                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2469                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2470                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2471             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2472
  2473         16  CF-CLAIM-CALC-METHOD           PIC X.
  2474             88  360-PLUS-MONTHS                VALUE '1'.
  2475             88  365-PLUS-MONTHS                VALUE '2'.
  2476             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2477             88  360-DAILY                      VALUE '4'.
  2478             88  365-DAILY                      VALUE '5'.
  2479
  2480         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2481         16  FILLER                         PIC X(11).
  2482
  2483         16  CF-LIMIT-AMOUNTS.
  2484             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2485             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2486             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2487             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2488             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2489             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2490             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2491             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2492             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2493             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2494
  2495         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2496         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL653.cbl
  2497         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2498
  2499         16  CF-ZIP-CODE.
  2500             20  CF-ZIP-PRIME.
  2501                 24  CF-ZIP-1ST             PIC X.
  2502                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2503                 24  FILLER                 PIC X(4).
  2504             20  CF-ZIP-PLUS4               PIC X(4).
  2505         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2506             20  CF-CAN-POSTAL-1            PIC XXX.
  2507             20  CF-CAN-POSTAL-2            PIC XXX.
  2508             20  FILLER                     PIC XXX.
  2509
  2510         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2511         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2512         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2513
  2514         16  CF-RATING-SWITCH               PIC X.
  2515             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2516             88  CF-NO-RATING                   VALUE 'N'.
  2517
  2518         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2519
  2520         16  CF-CARRIER-OVER-SHORT.
  2521             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2522             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2523
  2524         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2525         16  CF-SECPAY-SWITCH               PIC X.
  2526             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2527             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2528         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2529         16  FILLER                         PIC X(448).
  2530*        16  FILLER                         PIC X(452).
  2531
  2532
  2533****************************************************************
  2534*             MORTALITY MASTER RECORD                          *
  2535****************************************************************
  2536
  2537     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2538         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2539                                INDEXED BY CF-MORT-NDX.
  2540             20  CF-MORT-TABLE              PIC X(5).
  2541             20  CF-MORT-TABLE-TYPE         PIC X.
  2542                 88  CF-MORT-JOINT              VALUE 'J'.
  2543                 88  CF-MORT-SINGLE             VALUE 'S'.
  2544                 88  CF-MORT-COMBINED           VALUE 'C'.
  2545                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2546                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2547             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2548             20  CF-MORT-AGE-METHOD         PIC XX.
  2549                 88  CF-AGE-LAST                VALUE 'AL'.
  2550                 88  CF-AGE-NEAR                VALUE 'AN'.
  2551             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2552             20  CF-MORT-ADJUSTMENT-DIRECTION
  2553                                            PIC X.
  2554                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL653.cbl
  2555                 88  CF-PLUS                    VALUE '+'.
  2556             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2557             20  CF-MORT-JOINT-CODE         PIC X.
  2558                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2559             20  CF-MORT-PC-Q               PIC X.
  2560                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2561             20  CF-MORT-TABLE-CODE         PIC X(4).
  2562             20  CF-MORT-COMMENTS           PIC X(15).
  2563             20  FILLER                     PIC X(14).
  2564
  2565         16  FILLER                         PIC X(251).
  2566
  2567
  2568****************************************************************
  2569*             BUSSINESS TYPE MASTER RECORD                     *
  2570****************************************************************
  2571
  2572     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2573* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2574* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2575* AND RECORD 05 IS TYPES 81-99
  2576         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2577             20  CF-BUSINESS-TITLE          PIC  X(19).
  2578             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2579                                            PIC S9V9(4) COMP-3.
  2580             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2581             20  FILLER                     PIC  X.
  2582         16  FILLER                         PIC  X(248).
  2583
  2584
  2585****************************************************************
  2586*             TERMINAL MASTER RECORD                           *
  2587****************************************************************
  2588
  2589     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2590
  2591         16  CF-COMPANY-TERMINALS.
  2592             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2593                                  PIC X(4).
  2594         16  FILLER               PIC X(248).
  2595
  2596
  2597****************************************************************
  2598*             LIFE EDIT MASTER RECORD                          *
  2599****************************************************************
  2600
  2601     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2602         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2603             20  CF-LIFE-CODE-IN            PIC XX.
  2604             20  CF-LIFE-CODE-OUT           PIC XX.
  2605         16  FILLER                         PIC X(248).
  2606
  2607
  2608****************************************************************
  2609*             AH EDIT MASTER RECORD                            *
  2610****************************************************************
  2611
  2612     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL653.cbl
  2613         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2614             20  CF-AH-CODE-IN              PIC XXX.
  2615             20  CF-AH-CODE-OUT             PIC XX.
  2616         16  FILLER                         PIC X(248).
  2617
  2618
  2619****************************************************************
  2620*             CREDIBILITY TABLES                               *
  2621****************************************************************
  2622
  2623     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2624         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2625                             INDEXED BY CF-CRDB-NDX.
  2626             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2627             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2628             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2629         16  FILLER                         PIC  X(332).
  2630
  2631
  2632****************************************************************
  2633*             REPORT CUSTOMIZATION RECORD                      *
  2634****************************************************************
  2635
  2636     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2637         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2638             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2639             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2640             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2641**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2642****       A T-TRANSFER.                                   ****
  2643             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2644
  2645         16  FILLER                         PIC XX.
  2646
  2647         16  CF-CARRIER-CNTL-OPT.
  2648             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2649                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2650                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2651             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2652                                            PIC X.
  2653         16  CF-GROUP-CNTL-OPT.
  2654             20  CF-GROUP-OPT-SEQ           PIC 9.
  2655                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2656                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2657             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2658                                            PIC X(6).
  2659         16  CF-STATE-CNTL-OPT.
  2660             20  CF-STATE-OPT-SEQ           PIC 9.
  2661                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2662                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2663             20  CF-STATE-SELECT OCCURS 3 TIMES
  2664                                            PIC XX.
  2665         16  CF-ACCOUNT-CNTL-OPT.
  2666             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2667                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2668                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2669             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2670                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL653.cbl
  2671         16  CF-BUS-TYP-CNTL-OPT.
  2672             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2673                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2674                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2675             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2676                                            PIC XX.
  2677         16  CF-LF-TYP-CNTL-OPT.
  2678             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2679                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2680                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2681             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2682                                            PIC XX.
  2683         16  CF-AH-TYP-CNTL-OPT.
  2684             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2685                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2686                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2687             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2688                                            PIC XX.
  2689         16  CF-REPTCD1-CNTL-OPT.
  2690             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2691                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2692                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2693             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2694                                            PIC X(10).
  2695         16  CF-REPTCD2-CNTL-OPT.
  2696             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2697                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2698                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2699             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2700                                            PIC X(10).
  2701         16  CF-USER1-CNTL-OPT.
  2702             20  CF-USER1-OPT-SEQ           PIC 9.
  2703                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2704                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2705             20  CF-USER1-SELECT OCCURS 3 TIMES
  2706                                            PIC X(10).
  2707         16  CF-USER2-CNTL-OPT.
  2708             20  CF-USER2-OPT-SEQ           PIC 9.
  2709                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2710                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2711             20  CF-USER2-SELECT OCCURS 3 TIMES
  2712                                            PIC X(10).
  2713         16  CF-USER3-CNTL-OPT.
  2714             20  CF-USER3-OPT-SEQ           PIC 9.
  2715                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2716                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2717             20  CF-USER3-SELECT OCCURS 3 TIMES
  2718                                            PIC X(10).
  2719         16  CF-USER4-CNTL-OPT.
  2720             20  CF-USER4-OPT-SEQ           PIC 9.
  2721                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2722                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2723             20  CF-USER4-SELECT OCCURS 3 TIMES
  2724                                            PIC X(10).
  2725         16  CF-USER5-CNTL-OPT.
  2726             20  CF-USER5-OPT-SEQ           PIC 9.
  2727                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2728                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL653.cbl
  2729             20  CF-USER5-SELECT OCCURS 3 TIMES
  2730                                            PIC X(10).
  2731         16  CF-REINS-CNTL-OPT.
  2732             20  CF-REINS-OPT-SEQ           PIC 9.
  2733                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2734                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2735             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2736                 24  CF-REINS-PRIME         PIC XXX.
  2737                 24  CF-REINS-SUB           PIC XXX.
  2738
  2739         16  CF-AGENT-CNTL-OPT.
  2740             20  CF-AGENT-OPT-SEQ           PIC 9.
  2741                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2742                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2743             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2744                                            PIC X(10).
  2745
  2746         16  FILLER                         PIC X(43).
  2747
  2748         16  CF-LOSS-RATIO-SELECT.
  2749             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2750             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2751         16  CF-ENTRY-DATE-SELECT.
  2752             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2753             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2754         16  CF-EFFECTIVE-DATE-SELECT.
  2755             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2756             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2757
  2758         16  CF-EXCEPTION-LIST-IND          PIC X.
  2759             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2760
  2761         16  FILLER                         PIC X(318).
  2762
  2763****************************************************************
  2764*                  EXCEPTION REPORTING RECORD                  *
  2765****************************************************************
  2766
  2767     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2768         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2769             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2770
  2771         16  CF-COMBINED-LIFE-AH-OPT.
  2772             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2773             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2774             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2775             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2776
  2777         16  CF-LIFE-OPT.
  2778             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2779             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2780             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2781             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2782             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2783             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2784             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2785             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2786             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL653.cbl
  2787             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2788
  2789         16  CF-AH-OPT.
  2790             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2791             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2792             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2793             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2794             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2795             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2796             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2797             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2798             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2799             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2800
  2801         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2802             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2803             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2804             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2805
  2806         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2807
  2808         16  FILLER                         PIC X(673).
  2809
  2810
  2811****************************************************************
  2812*             MORTGAGE SYSTEM PLAN RECORD                      *
  2813****************************************************************
  2814
  2815     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2816         16  CF-PLAN-TYPE                   PIC X.
  2817             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2818             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2819             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2820         16  CF-PLAN-ABBREV                 PIC XXX.
  2821         16  CF-PLAN-DESCRIPT               PIC X(10).
  2822         16  CF-PLAN-NOTES                  PIC X(20).
  2823         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2824         16  CF-PLAN-UNDERWRITING.
  2825             20  CF-PLAN-TERM-DATA.
  2826                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2827                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2828             20  CF-PLAN-AGE-DATA.
  2829                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2830                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2831                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2832             20  CF-PLAN-BENEFIT-DATA.
  2833                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2834                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2835                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2836                                            PIC S9(7)V99  COMP-3.
  2837         16  CF-PLAN-POLICY-FORMS.
  2838             20  CF-POLICY-FORM             PIC X(12).
  2839             20  CF-MASTER-APPLICATION      PIC X(12).
  2840             20  CF-MASTER-POLICY           PIC X(12).
  2841         16  CF-PLAN-RATING.
  2842             20  CF-RATE-CODE               PIC X(5).
  2843             20  CF-SEX-RATING              PIC X.
  2844                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL653.cbl
  2845                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2846             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2847             20  CF-SUB-STD-TYPE            PIC X.
  2848                 88  CF-PCT-OF-PREM            VALUE '1'.
  2849                 88  CF-PCT-OF-BENE            VALUE '2'.
  2850         16  CF-PLAN-PREM-TOLERANCES.
  2851             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2852             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2853         16  CF-PLAN-PYMT-TOLERANCES.
  2854             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2855             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2856         16  CF-PLAN-MISC-DATA.
  2857             20  FILLER                     PIC X.
  2858             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2859             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2860         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2861         16  CF-PLAN-IND-GRP                PIC X.
  2862             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2863                                                     '1'.
  2864             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2865                                                     '2'.
  2866         16  CF-MIB-SEARCH-SW               PIC X.
  2867             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2868             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2869             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2870             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2871         16  CF-ALPHA-SEARCH-SW             PIC X.
  2872             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2873             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2874             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2875             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2876             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2877             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2878             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2879             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2880             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2881             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2882                                                     'A' 'B' 'C'
  2883                                                     'X' 'Y' 'Z'.
  2884         16  CF-EFF-DT-RULE-SW              PIC X.
  2885             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2886             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2887             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2888             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2889             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2890         16  FILLER                         PIC X(4).
  2891         16  CF-HEALTH-QUESTIONS            PIC X.
  2892             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2893         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2894         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2895         16  CF-PLAN-SNGL-JNT               PIC X.
  2896             88  CF-COMBINED-PLAN              VALUE 'C'.
  2897             88  CF-JNT-PLAN                   VALUE 'J'.
  2898             88  CF-SNGL-PLAN                  VALUE 'S'.
  2899         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2900         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2901         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2902         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL653.cbl
  2903         16  CF-RERATE-CNTL                 PIC  X.
  2904             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2905             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2906             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2907             88  CF-AUTO-RECALC                 VALUE '4'.
  2908         16  CF-BENEFIT-TYPE                PIC  X.
  2909             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2910             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2911         16  CF-POLICY-FEE                  PIC S999V99
  2912                                                    COMP-3.
  2913         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2914         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2915         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2916         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2917         16  FILLER                         PIC  X(32).
  2918         16  CF-TERMINATION-FORM            PIC  X(04).
  2919         16  FILLER                         PIC  X(08).
  2920         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2921                                                       COMP-3.
  2922         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2923         16  CF-ISSUE-LETTER                PIC  X(4).
  2924         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2925         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2926             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2927             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2928         16  CF-MP-REFUND-CALC              PIC X.
  2929             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2930             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2931             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2932             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2933             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2934             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2935             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2936             88  CF-MP-REFD-MEAN                VALUE '8'.
  2937         16  CF-ALT-RATE-CODE               PIC  X(5).
  2938
  2939
  2940         16  FILLER                         PIC X(498).
  2941****************************************************************
  2942*             MORTGAGE COMPANY MASTER RECORD                   *
  2943****************************************************************
  2944
  2945     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2946         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2947         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2948             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2949             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2950             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2951             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2952             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2953
  2954         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2955         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2956         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2957         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2958         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2959
  2960         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL653.cbl
  2961             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2962         16  CF-MP-RECON-USE-IND            PIC X(1).
  2963             88  CF-MP-USE-RECON             VALUE 'Y'.
  2964         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2965             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2966         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2967             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2968             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2969         16  FILLER                         PIC X(1).
  2970         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2971             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2972         16  CF-MORTG-MIB-VERSION           PIC X.
  2973             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2974             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2975             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2976         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2977             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2978                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2979             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2980                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2981             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2982                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2983             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2984                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2985             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2986                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2987             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2988                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2989         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2990         16  FILLER                         PIC X(7).
  2991         16  CF-MORTG-DESTINATION-SYMBOL.
  2992             20  CF-MORTG-MIB-COMM          PIC X(5).
  2993             20  CF-MORTG-MIB-TERM          PIC X(5).
  2994         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2995             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2996         16  FILLER                         PIC X(03).
  2997         16  CF-MP-CHECK-NO-CONTROL.
  2998             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2999                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3000                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3001                                                ' ' LOW-VALUES.
  3002                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3003                                               VALUE '3'.
  3004         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3005         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3006         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3007             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3008                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3009             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3010                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3011             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3012                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3013             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3014                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3015             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3016                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3017             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3018                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL653.cbl
  3019         16  CF-MORTG-BILLING-AREA.
  3020             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3021                                            PIC X.
  3022         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3023         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3024         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3025         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3026             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3027             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3028         16  FILLER                         PIC X.
  3029         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3030             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3031             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3032         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3033         16  FILLER                         PIC X(8).
  3034         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3035         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3036         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3037         16  CF-ACH-COMPANY-ID.
  3038             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3039                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3040                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3041                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3042             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3043         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3044             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3045         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3046             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3047             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3048         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3049         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3050         16  FILLER                         PIC X(536).
  3051
  3052****************************************************************
  3053*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3054****************************************************************
  3055
  3056     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3057         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3058             20  CF-FEMALE-HEIGHT.
  3059                 24  CF-FEMALE-FT           PIC 99.
  3060                 24  CF-FEMALE-IN           PIC 99.
  3061             20  CF-FEMALE-MIN-WT           PIC 999.
  3062             20  CF-FEMALE-MAX-WT           PIC 999.
  3063         16  FILLER                         PIC X(428).
  3064
  3065     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3066         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3067             20  CF-MALE-HEIGHT.
  3068                 24  CF-MALE-FT             PIC 99.
  3069                 24  CF-MALE-IN             PIC 99.
  3070             20  CF-MALE-MIN-WT             PIC 999.
  3071             20  CF-MALE-MAX-WT             PIC 999.
  3072         16  FILLER                         PIC X(428).
  3073******************************************************************
  3074*             AUTOMATIC ACTIVITY RECORD                          *
  3075******************************************************************
  3076     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL653.cbl
  3077         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3078             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3079             20  CF-SYS-LETTER-ID           PIC X(04).
  3080             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3081             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3082             20  CF-SYS-RESET-SW            PIC X(01).
  3083             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3084             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3085
  3086         16  FILLER                         PIC X(50).
  3087
  3088         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3089             20  CF-USER-ACTIVE-SW          PIC X(01).
  3090             20  CF-USER-LETTER-ID          PIC X(04).
  3091             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3092             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3093             20  CF-USER-RESET-SW           PIC X(01).
  3094             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3095             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3096             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3097
  3098         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL653.cbl
  3100 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA COMM-TABLE-RECORD
  3101                          CONTROL-FILE.
  3102 0000-DFHEXIT SECTION.
  3103     MOVE '9#                    $   ' TO DFHEIV0.
  3104     MOVE 'EL653' TO DFHEIV1.
  3105     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3106     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3107     MOVE '5'                    TO  DC-OPTION-CODE.
  3108
  3109     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  3110
  3111     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  3112     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  3113     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3114
  3115 1000-START.
  3116     IF EIBCALEN = ZERO
  3117         GO TO 8800-UNAUTHORIZED-ACCESS.
  3118
  3119     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3120         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3121             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  3122             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  3123             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  3124             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  3125             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  3126             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  3127             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  3128             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  3129         ELSE
  3130             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  3131             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  3132             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  3133             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  3134             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  3135             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  3136             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  3137             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  3138
  3139
  3140* EXEC CICS HANDLE CONDITION
  3141*        NOTOPEN   (9990-ABEND)
  3142*        NOTFND    (8880-NOT-FOUND)
  3143*        PGMIDERR  (9600-PGMID-ERROR)
  3144*        ERROR     (9990-ABEND)
  3145*    END-EXEC.
  3146*    MOVE '"$JIL.                ! " #00003135' TO DFHEIV0
  3147     MOVE X'22244A494C2E202020202020' TO DFHEIV0(1:12)
  3148     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3149     MOVE X'2220233030303033313335' TO DFHEIV0(25:11)
  3150     CALL 'kxdfhei1' USING DFHEIV0
  3151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3152
  3153
  3154     IF EIBTRNID NOT = TRANS-ID
  3155         MOVE 'Y'                TO  PI-FIRST-TIME-SW
  3156         MOVE LOW-VALUES         TO  EL653AI
  3157         GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL653.cbl
  3158
  3159     IF EIBAID = DFHCLEAR
  3160         GO TO 9400-CLEAR.
  3161
  3162     IF PI-PROCESSOR-ID = 'LGXX'
  3163         GO TO 2000-RECEIVE.
  3164
  3165
  3166* EXEC CICS  READQ TS
  3167*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  3168*        INTO    (SECURITY-CONTROL)
  3169*        LENGTH  (SC-COMM-LENGTH)
  3170*        ITEM    (SC-ITEM)
  3171*    END-EXEC.
  3172*    MOVE '*$II   L              ''   #00003153' TO DFHEIV0
  3173     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3174     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3175     MOVE X'2020233030303033313533' TO DFHEIV0(25:11)
  3176     CALL 'kxdfhei1' USING DFHEIV0,
  3177           PI-SECURITY-TEMP-STORE-ID,
  3178           SECURITY-CONTROL,
  3179           SC-COMM-LENGTH,
  3180           SC-ITEM,
  3181           DFHEIV99,
  3182           DFHEIV99
  3183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3184
  3185
  3186     MOVE SC-CREDIT-DISPLAY (08)  TO  PI-DISPLAY-CAP.
  3187     MOVE SC-CREDIT-UPDATE  (08)  TO  PI-MODIFY-CAP.
  3188
  3189     IF NOT DISPLAY-CAP
  3190         MOVE 'READ'          TO SM-READ
  3191         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  3192         MOVE ER-0070        TO  EMI-ERROR
  3193         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3194         GO TO 8100-SEND-INITIAL-MAP.
  3195
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL653.cbl
  3197 2000-RECEIVE.
  3198     MOVE LOW-VALUES             TO  EL653AI.
  3199
  3200     IF EIBAID = DFHPA1 OR  DFHPA2  OR  DFHPA3
  3201         MOVE ER-0008            TO  EMI-ERROR
  3202         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3203         MOVE -1                 TO  MAINTYPL
  3204         GO TO 8200-SEND-DATAONLY.
  3205
  3206
  3207* EXEC CICS RECEIVE
  3208*        MAP     (MAP-NAME)
  3209*        MAPSET  (MAPSET-NAME)
  3210*        INTO    (EL653AI)
  3211*    END-EXEC.
  3212     MOVE LENGTH OF
  3213      EL653AI
  3214       TO DFHEIV11
  3215*    MOVE '8"T I  L              ''   #00003180' TO DFHEIV0
  3216     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3217     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3218     MOVE X'2020233030303033313830' TO DFHEIV0(25:11)
  3219     CALL 'kxdfhei1' USING DFHEIV0,
  3220           MAP-NAME,
  3221           EL653AI,
  3222           DFHEIV11,
  3223           MAPSET-NAME,
  3224           DFHEIV99,
  3225           DFHEIV99
  3226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3227
  3228
  3229     IF PFENTERL = ZERO
  3230         GO TO 3000-CHECK-PFENTERS.
  3231
  3232     IF EIBAID NOT = DFHENTER
  3233         MOVE ER-0004            TO  EMI-ERROR
  3234         GO TO 3100-INPUT-ERROR.
  3235
  3236     IF PFENTERI GREATER 0 AND LESS 25
  3237         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  3238     ELSE
  3239         MOVE ER-0029               TO  EMI-ERROR
  3240         GO TO 3100-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL653.cbl
  3242 3000-CHECK-PFENTERS.
  3243     IF EIBAID = DFHPF23
  3244         GO TO 8810-PF23.
  3245
  3246     IF EIBAID = DFHPF24
  3247         GO TO 9200-RETURN-MAIN-MENU.
  3248
  3249     IF EIBAID = DFHPF12
  3250         GO TO 9500-PF12.
  3251
  3252     IF MAINTYPL GREATER  ZERO
  3253         IF MAINTYPI NOT = SPACE
  3254             IF EIBAID NOT = DFHENTER
  3255                 MOVE ER-0050    TO  EMI-ERROR
  3256                 GO TO 3100-INPUT-ERROR.
  3257
  3258     IF EIBAID = DFHPF1
  3259         GO TO 7300-PAGE-TABLE-FORWARD.
  3260
  3261     IF EIBAID = DFHPF2
  3262         GO TO 7400-PAGE-TABLE-BACKWARD.
  3263
  3264     IF EIBAID = DFHPF3
  3265         GO TO 7500-PAGE-BENEFIT-FORWARD.
  3266
  3267     IF EIBAID = DFHPF4
  3268         GO TO 7600-PAGE-BENEFIT-BACKWARD.
  3269
  3270     IF EIBAID = DFHENTER
  3271         GO TO 4000-EDIT-MAINT.
  3272
  3273     MOVE ER-0029                TO  EMI-ERROR.
  3274
  3275 3100-INPUT-ERROR.
  3276     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3277
  3278     MOVE AL-UNBON               TO  PFENTERA.
  3279     MOVE -1                     TO  PFENTERL.
  3280
  3281     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL653.cbl
  3283 4000-EDIT-MAINT.
  3284     IF MAINTYPL GREATER ZERO
  3285         MOVE MAINTYPI           TO  PI-CHECK-MAINT-TYPE
  3286         IF VALID-MAINT-TYPE
  3287             MOVE AL-UANON       TO  MAINTYPA
  3288         ELSE
  3289             MOVE -1             TO  MAINTYPL
  3290             MOVE AL-UABON       TO  MAINTYPA
  3291             MOVE ER-2039        TO  EMI-ERROR
  3292             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3293     ELSE
  3294         MOVE -1                 TO  MAINTYPL
  3295         MOVE AL-UABON           TO  MAINTYPA
  3296         MOVE ER-2039            TO  EMI-ERROR
  3297         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3298
  3299     IF NOT MODIFY-CAP
  3300         IF SHOW-FUNCTION
  3301             NEXT SENTENCE
  3302         ELSE
  3303             MOVE 'UPDATE'       TO SM-READ
  3304             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  3305             MOVE ER-0070        TO  EMI-ERROR
  3306             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3307             GO TO 8100-SEND-INITIAL-MAP.
  3308
  3309     IF TBLCODEL GREATER ZERO
  3310         MOVE TBLCODEI           TO  PI-CHECK-TBLCODE
  3311         IF 1ST-CHAR-ALPHA
  3312             MOVE TBLCODEI       TO  PI-ERC-TABLE
  3313             MOVE AL-UANON       TO  TBLCODEA
  3314         ELSE
  3315             MOVE -1             TO  TBLCODEL
  3316             MOVE AL-UABON       TO  TBLCODEA
  3317             MOVE ER-2115        TO  EMI-ERROR
  3318             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3319     ELSE
  3320         MOVE -1                 TO  TBLCODEL
  3321         MOVE AL-UABON           TO  TBLCODEA
  3322         MOVE ER-2116            TO  EMI-ERROR
  3323         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3324
  3325     IF COVTYPEL GREATER ZERO
  3326         MOVE COVTYPEI           TO  PI-CHECK-COVERAGE
  3327         IF PI-CHECK-COVERAGE = PI-LIFE-OVERRIDE-L1
  3328           OR  PI-CHECK-COVERAGE = PI-AH-OVERRIDE-L1
  3329             MOVE COVTYPEI       TO  PI-ERC-BEN-TYPE
  3330             MOVE AL-UANON       TO  COVTYPEA
  3331         ELSE
  3332             MOVE -1             TO  COVTYPEL
  3333             MOVE AL-UABON       TO  COVTYPEA
  3334             MOVE ER-2117        TO  EMI-ERROR
  3335             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3336     ELSE
  3337         MOVE -1                 TO  COVTYPEL
  3338         MOVE AL-UABON           TO  COVTYPEA
  3339         MOVE ER-2117            TO  EMI-ERROR
  3340         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL653.cbl
  3341
  3342     IF BENCODEL GREATER ZERO
  3343         MOVE BENCODEI           TO  PI-ERC-BEN-CODE
  3344         MOVE AL-UANON           TO  BENCODEA
  3345     ELSE
  3346         MOVE -1                 TO  BENCODEL
  3347         MOVE AL-UABON           TO  BENCODEA
  3348         MOVE ER-2118            TO  EMI-ERROR
  3349         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3350
  3351     IF EMI-NO-ERRORS
  3352         NEXT SENTENCE
  3353     ELSE
  3354         GO TO 8200-SEND-DATAONLY.
  3355
  3356     IF CHANGE-FUNCTION
  3357         GO TO 4400-CHANGE.
  3358
  3359     IF DELETE-FUNCTION
  3360         GO TO 4600-DELETE.
  3361
  3362     IF SHOW-FUNCTION
  3363         GO TO 5000-BUILD-INITIAL-SCREEN.
  3364
  3365     IF ADD-FUNCTION
  3366         GO TO 4200-ADD.
  3367
  3368 4000-EXIT.
  3369     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL653.cbl
  3371 4200-ADD.
  3372     PERFORM 7000-EDIT  THRU  7049-EXIT.
  3373
  3374     IF EMI-NO-ERRORS
  3375         NEXT SENTENCE
  3376     ELSE
  3377         GO TO 8200-SEND-DATAONLY.
  3378
  3379
  3380* EXEC CICS HANDLE CONDITION
  3381*        NOTOPEN  (9990-ABEND)
  3382*        NOTFND   (4250-CONT)
  3383*        END-EXEC.
  3384*    MOVE '"$JI                  ! # #00003336' TO DFHEIV0
  3385     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  3386     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3387     MOVE X'2320233030303033333336' TO DFHEIV0(25:11)
  3388     CALL 'kxdfhei1' USING DFHEIV0
  3389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3390
  3391
  3392     PERFORM 7050-READ-ERCTBL  THRU  7050-EXIT.
  3393
  3394     MOVE ER-2133                TO  EMI-ERROR.
  3395
  3396     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3397
  3398     MOVE -1                     TO  MAINTYPL.
  3399
  3400     GO TO 8200-SEND-DATAONLY.
  3401
  3402 4250-CONT.
  3403     PERFORM 7150-ERCTBL-GETMAIN  THRU  7150-EXIT.
  3404
  3405     MOVE SPACES                 TO  COMM-TABLE-RECORD.
  3406     MOVE 'CT'                   TO  CT-RECORD-ID.
  3407     MOVE PI-COMPANY-CD          TO  CT-COMPANY-CD.
  3408     MOVE ZEROS                  TO  CT-LAST-MAINT-HHMMSS.
  3409     MOVE +99                    TO  CT-AGE (1)
  3410                                     CT-AGE (2)
  3411                                     CT-AGE (3).
  3412     MOVE +999                   TO  CT-TRM (1)
  3413                                     CT-TRM (2)
  3414                                     CT-TRM (3).
  3415     MOVE WS-MAX-BENEFIT         TO  CT-TBF (1)
  3416                                     CT-TBF (2)
  3417                                     CT-TBF (3).
  3418     MOVE +1                     TO  SUB1.
  3419
  3420 4275-ZERO-RATES.
  3421     IF SUB1 GREATER +27
  3422         NEXT SENTENCE
  3423     ELSE
  3424         MOVE ZEROS              TO  CT-RT (SUB1)
  3425         ADD +1                  TO  SUB1
  3426         GO TO 4275-ZERO-RATES.
  3427
  3428     PERFORM 6000-CHECK-FOR-UPDATE  THRU  6099-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL653.cbl
  3429
  3430     MOVE PI-PROCESSOR-ID        TO  CT-LAST-MAINT-USER.
  3431     MOVE EIBTIME                TO  CT-LAST-MAINT-HHMMSS.
  3432     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3433     MOVE '5'                    TO  DC-OPTION-CODE.
  3434     MOVE LINK-CLDATCV           TO  PGM-NAME.
  3435
  3436
  3437* EXEC CICS LINK
  3438*        PROGRAM   (PGM-NAME)
  3439*        COMMAREA  (DATE-CONVERSION-DATA)
  3440*        LENGTH    (DC-COMM-LENGTH)
  3441*    END-EXEC.
  3442*    MOVE '."C                   ''   #00003385' TO DFHEIV0
  3443     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3444     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3445     MOVE X'2020233030303033333835' TO DFHEIV0(25:11)
  3446     CALL 'kxdfhei1' USING DFHEIV0,
  3447           PGM-NAME,
  3448           DATE-CONVERSION-DATA,
  3449           DC-COMM-LENGTH,
  3450           DFHEIV99,
  3451           DFHEIV99,
  3452           DFHEIV99
  3453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3454
  3455
  3456     MOVE DC-BIN-DATE-1          TO  CT-LAST-MAINT-DT
  3457                                     BIN-CURRENT-SAVE.
  3458     MOVE PI-COMPANY-CD          TO  CT-COMPANY-CD.
  3459     MOVE 'CT'                   TO  CT-RECORD-ID.
  3460     MOVE CTBL-FILE-ID           TO  FILE-ID.
  3461     MOVE 'A'                    TO  JP-RECORD-TYPE.
  3462     MOVE COMM-TABLE-RECORD      TO  JP-RECORD-AREA.
  3463
  3464
  3465* EXEC CICS WRITE
  3466*        DATASET  (CTBL-FILE-ID)
  3467*        FROM     (COMM-TABLE-RECORD)
  3468*        RIDFLD   (CT-CONTROL-PRIMARY)
  3469*    END-EXEC.
  3470     MOVE LENGTH OF
  3471      COMM-TABLE-RECORD
  3472       TO DFHEIV11
  3473*    MOVE '&$ L                  ''   #00003399' TO DFHEIV0
  3474     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3475     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3476     MOVE X'2020233030303033333939' TO DFHEIV0(25:11)
  3477     CALL 'kxdfhei1' USING DFHEIV0,
  3478           CTBL-FILE-ID,
  3479           COMM-TABLE-RECORD,
  3480           DFHEIV11,
  3481           CT-CONTROL-PRIMARY,
  3482           DFHEIV99,
  3483           DFHEIV99
  3484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3485
  3486
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL653.cbl
  3487     PERFORM 8400-LOG-JOURNAL-RECORD.
  3488
  3489     PERFORM 8000-UPDATE-MAINT-DATE  THRU  8000-EXIT.
  3490
  3491     MOVE ER-0000                TO  EMI-ERROR.
  3492
  3493     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3494
  3495     MOVE LOW-VALUES             TO  EL653AO.
  3496     MOVE PI-ERC-TABLE           TO  TBLCODEO.
  3497     MOVE PI-ERC-BEN-TYPE        TO  COVTYPEO.
  3498     MOVE PI-ERC-BEN-CODE        TO  BENCODEO.
  3499     MOVE AL-UANON               TO  TBLCODEA
  3500                                     COVTYPEA
  3501                                     BENCODEA.
  3502
  3503     GO TO 8100-SEND-INITIAL-MAP.
  3504
  3505 4299-EXIT.
  3506     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL653.cbl
  3508 4400-CHANGE.
  3509     IF PI-ERCTBL-KEY = PI-SAVE-ERCTBL-KEY
  3510         NEXT SENTENCE
  3511     ELSE
  3512         MOVE ER-2056            TO  EMI-ERROR
  3513         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3514         MOVE -1                 TO  MAINTYPL
  3515         GO TO 8200-SEND-DATAONLY.
  3516
  3517     PERFORM 7000-EDIT  THRU  7049-EXIT.
  3518
  3519     IF EMI-NO-ERRORS
  3520         NEXT SENTENCE
  3521     ELSE
  3522         GO TO 8200-SEND-DATAONLY.
  3523
  3524     PERFORM 7200-READ-ERCTBL-UPDATE  THRU  7200-EXIT.
  3525
  3526     MOVE COMM-TABLE-RECORD      TO  JP-RECORD-AREA.
  3527
  3528     PERFORM 6000-CHECK-FOR-UPDATE  THRU  6099-EXIT.
  3529
  3530     IF CT-LAST-MAINT-USER   = PI-UPDATE-BY   OR
  3531        CT-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS
  3532         NEXT SENTENCE
  3533     ELSE
  3534
  3535* EXEC CICS UNLOCK
  3536*             DATASET  (CTBL-FILE-ID)
  3537*        END-EXEC
  3538*    MOVE '&*                    #   #00003452' TO DFHEIV0
  3539     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  3540     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3541     MOVE X'2020233030303033343532' TO DFHEIV0(25:11)
  3542     CALL 'kxdfhei1' USING DFHEIV0,
  3543           CTBL-FILE-ID,
  3544           DFHEIV99
  3545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3546         MOVE ER-0068            TO  EMI-ERROR
  3547         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3548         GO TO 8200-SEND-DATAONLY.
  3549
  3550     MOVE PI-PROCESSOR-ID        TO  CT-LAST-MAINT-USER.
  3551     MOVE EIBTIME                TO  CT-LAST-MAINT-HHMMSS.
  3552     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3553     MOVE '5'                    TO  DC-OPTION-CODE.
  3554     MOVE LINK-CLDATCV           TO  PGM-NAME.
  3555
  3556
  3557* EXEC CICS LINK
  3558*        PROGRAM   (PGM-NAME)
  3559*        COMMAREA  (DATE-CONVERSION-DATA)
  3560*        LENGTH    (DC-COMM-LENGTH)
  3561*    END-EXEC.
  3562*    MOVE '."C                   ''   #00003465' TO DFHEIV0
  3563     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3564     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3565     MOVE X'2020233030303033343635' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL653.cbl
  3566     CALL 'kxdfhei1' USING DFHEIV0,
  3567           PGM-NAME,
  3568           DATE-CONVERSION-DATA,
  3569           DC-COMM-LENGTH,
  3570           DFHEIV99,
  3571           DFHEIV99,
  3572           DFHEIV99
  3573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3574
  3575
  3576     MOVE DC-BIN-DATE-1          TO  CT-LAST-MAINT-DT
  3577                                     BIN-CURRENT-SAVE.
  3578     MOVE 'B'                    TO  JP-RECORD-TYPE.
  3579     MOVE CTBL-FILE-ID           TO  FILE-ID.
  3580
  3581     PERFORM 8400-LOG-JOURNAL-RECORD.
  3582
  3583     MOVE COMM-TABLE-RECORD      TO  JP-RECORD-AREA.
  3584
  3585
  3586* EXEC CICS REWRITE
  3587*        DATASET  (CTBL-FILE-ID)
  3588*        FROM     (COMM-TABLE-RECORD)
  3589*    END-EXEC.
  3590     MOVE LENGTH OF
  3591      COMM-TABLE-RECORD
  3592       TO DFHEIV11
  3593*    MOVE '&& L                  %   #00003480' TO DFHEIV0
  3594     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3595     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3596     MOVE X'2020233030303033343830' TO DFHEIV0(25:11)
  3597     CALL 'kxdfhei1' USING DFHEIV0,
  3598           CTBL-FILE-ID,
  3599           COMM-TABLE-RECORD,
  3600           DFHEIV11,
  3601           DFHEIV99
  3602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3603
  3604
  3605     MOVE 'C'                    TO  JP-RECORD-TYPE.
  3606     MOVE CTBL-FILE-ID           TO  FILE-ID.
  3607
  3608     PERFORM 8400-LOG-JOURNAL-RECORD.
  3609
  3610     PERFORM 8000-UPDATE-MAINT-DATE  THRU  8000-EXIT.
  3611
  3612     MOVE ER-0000                TO  EMI-ERROR.
  3613
  3614     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3615
  3616     MOVE LOW-VALUES             TO  EL653AO.
  3617     MOVE PI-ERC-TABLE           TO  TBLCODEO.
  3618     MOVE PI-ERC-BEN-TYPE        TO  COVTYPEO.
  3619     MOVE PI-ERC-BEN-CODE        TO  BENCODEO.
  3620     MOVE AL-UANON               TO  TBLCODEA
  3621                                     COVTYPEA
  3622                                     BENCODEA.
  3623
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL653.cbl
  3624     GO TO 5000-BUILD-INITIAL-SCREEN.
  3625
  3626 4400-EXIT.
  3627     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL653.cbl
  3629 4600-DELETE.
  3630     IF PI-ERCTBL-KEY = PI-SAVE-ERCTBL-KEY
  3631         NEXT SENTENCE
  3632     ELSE
  3633         MOVE ER-2056            TO  EMI-ERROR
  3634         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3635         MOVE -1                 TO  MAINTYPL
  3636         GO TO 8200-SEND-DATAONLY.
  3637
  3638     PERFORM 7200-READ-ERCTBL-UPDATE  THRU  7200-EXIT.
  3639
  3640     MOVE COMM-TABLE-RECORD      TO  JP-RECORD-AREA.
  3641
  3642     IF CT-LAST-MAINT-USER   = PI-UPDATE-BY   OR
  3643        CT-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS
  3644         NEXT SENTENCE
  3645     ELSE
  3646
  3647* EXEC CICS UNLOCK
  3648*             DATASET  (CTBL-FILE-ID)
  3649*        END-EXEC
  3650*    MOVE '&*                    #   #00003526' TO DFHEIV0
  3651     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  3652     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3653     MOVE X'2020233030303033353236' TO DFHEIV0(25:11)
  3654     CALL 'kxdfhei1' USING DFHEIV0,
  3655           CTBL-FILE-ID,
  3656           DFHEIV99
  3657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3658         MOVE ER-0068            TO  EMI-ERROR
  3659         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3660         GO TO 8200-SEND-DATAONLY.
  3661
  3662
  3663* EXEC CICS DELETE
  3664*         DATASET  (CTBL-FILE-ID)
  3665*    END-EXEC.
  3666*    MOVE '&(                    &   #00003533' TO DFHEIV0
  3667     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  3668     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3669     MOVE X'2020233030303033353333' TO DFHEIV0(25:11)
  3670     CALL 'kxdfhei1' USING DFHEIV0,
  3671           CTBL-FILE-ID,
  3672           DFHEIV99,
  3673           DFHEIV99,
  3674           DFHEIV99,
  3675           DFHEIV99
  3676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3677
  3678
  3679     MOVE 'D'                    TO  JP-RECORD-TYPE.
  3680     MOVE CTBL-FILE-ID           TO  FILE-ID.
  3681
  3682     PERFORM 8400-LOG-JOURNAL-RECORD.
  3683
  3684     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3685     MOVE '5'                    TO  DC-OPTION-CODE.
  3686     MOVE LINK-CLDATCV           TO  PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL653.cbl
  3687
  3688
  3689* EXEC CICS LINK
  3690*        PROGRAM   (PGM-NAME)
  3691*        COMMAREA  (DATE-CONVERSION-DATA)
  3692*        LENGTH    (DC-COMM-LENGTH)
  3693*    END-EXEC.
  3694*    MOVE '."C                   ''   #00003546' TO DFHEIV0
  3695     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3696     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3697     MOVE X'2020233030303033353436' TO DFHEIV0(25:11)
  3698     CALL 'kxdfhei1' USING DFHEIV0,
  3699           PGM-NAME,
  3700           DATE-CONVERSION-DATA,
  3701           DC-COMM-LENGTH,
  3702           DFHEIV99,
  3703           DFHEIV99,
  3704           DFHEIV99
  3705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3706
  3707
  3708     MOVE DC-BIN-DATE-1          TO  BIN-CURRENT-SAVE.
  3709
  3710     PERFORM 8000-UPDATE-MAINT-DATE  THRU  8000-EXIT.
  3711
  3712     MOVE ER-0000                TO  EMI-ERROR.
  3713
  3714     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3715
  3716     MOVE LOW-VALUES             TO  EL653AO.
  3717     MOVE PI-ERC-TABLE           TO  TBLCODEO.
  3718     MOVE PI-ERC-BEN-TYPE        TO  COVTYPEO.
  3719     MOVE PI-ERC-BEN-CODE        TO  BENCODEO.
  3720     MOVE AL-UANON               TO  TBLCODEA
  3721                                     COVTYPEA
  3722                                     BENCODEA.
  3723
  3724     GO TO 8100-SEND-INITIAL-MAP.
  3725
  3726 4600-EXIT.
  3727     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL653.cbl
  3729 5000-BUILD-INITIAL-SCREEN.
  3730     MOVE LOW-VALUES             TO  EL653AO.
  3731     MOVE PI-ERC-TABLE           TO  TBLCODEO.
  3732     MOVE PI-ERC-BEN-TYPE        TO  COVTYPEO.
  3733     MOVE PI-ERC-BEN-CODE        TO  BENCODEO.
  3734     MOVE AL-UANON               TO  MAINTYPA
  3735                                     TBLCODEA
  3736                                     COVTYPEA
  3737                                     BENCODEA.
  3738     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  3739
  3740     PERFORM 7050-READ-ERCTBL  THRU  7050-EXIT.
  3741
  3742     MOVE CT-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  3743     MOVE CT-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
  3744
  3745 5005-SET-UP-SCREEN.
  3746     MOVE CT-TRM (1)             TO  TERM1O.
  3747     MOVE CT-TRM (2)             TO  TERM2O.
  3748     MOVE CT-TRM (3)             TO  TERM3O.
  3749     MOVE AL-UNNON               TO  TERM1A
  3750                                     TERM2A
  3751                                     TERM3A.
  3752
  3753     SET ST-INDX                 TO  +1.
  3754     SET AT-INDX                 TO  +1.
  3755     SET RT-INDX                 TO  +1.
  3756
  3757     MOVE +1                     TO  SUB1
  3758                                     SUB2
  3759                                     SUB3.
  3760
  3761 5010-SET-UP-BENEFIT.
  3762     IF SUB1 GREATER +3
  3763         MOVE -1                 TO  MAINTYPL
  3764         GO TO 8100-SEND-INITIAL-MAP.
  3765
  3766     MOVE CT-TBF (SUB1)          TO  CTBL-TBF-DISP (ST-INDX)
  3767     MOVE AL-UNNON               TO  CTBL-TBF-A (ST-INDX).
  3768
  3769 5020-SET-UP-AGES.
  3770     IF SUB2 GREATER +3
  3771         SET ST-INDX  UP  BY  +1
  3772         SET AT-INDX             TO  +1
  3773         ADD  +1                 TO  SUB1
  3774         MOVE +1                 TO  SUB2
  3775         GO TO 5010-SET-UP-BENEFIT.
  3776
  3777     MOVE CT-AGE (SUB2)          TO  CTBL-AGE (ST-INDX AT-INDX)
  3778
  3779     IF SUB1 = +1
  3780         MOVE AL-UNNON       TO  CTBL-AGE-A (ST-INDX AT-INDX)
  3781     ELSE
  3782         MOVE AL-SANOF       TO  CTBL-AGE-A (ST-INDX AT-INDX).
  3783
  3784 5030-SET-UP-RATES.
  3785     IF RT-INDX GREATER +3
  3786         ADD +1                  TO  SUB2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL653.cbl
  3787         SET AT-INDX  UP  BY  +1
  3788         SET RT-INDX             TO  +1
  3789         GO TO 5020-SET-UP-AGES.
  3790
  3791     IF CT-RT (SUB3) = ZEROS
  3792         NEXT SENTENCE
  3793     ELSE
  3794         MOVE CT-RT (SUB3)
  3795             TO  CTBL-RATE-DISP (ST-INDX AT-INDX RT-INDX)
  3796         MOVE AL-UNNON
  3797             TO  CTBL-RATE-A (ST-INDX AT-INDX RT-INDX).
  3798
  3799     ADD +1                      TO  SUB3.
  3800
  3801     SET RT-INDX  UP  BY  +1.
  3802
  3803     GO TO 5030-SET-UP-RATES.
  3804
  3805 5099-EXIT.
  3806     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL653.cbl
  3808 6000-CHECK-FOR-UPDATE.
  3809      IF CHANGE-FUNCTION
  3810          GO TO 6010-CONT.
  3811
  3812      IF TBLCODEL GREATER ZERO
  3813          MOVE TBLCODEI          TO  CT-TABLE.
  3814
  3815      IF COVTYPEL GREATER ZERO
  3816          MOVE COVTYPEI          TO  CT-BEN-TYPE.
  3817
  3818      IF BENCODEL GREATER ZERO
  3819          MOVE BENCODEI          TO  CT-BEN-CODE.
  3820
  3821 6010-CONT.
  3822     IF TERM1L GREATER ZERO
  3823         MOVE TERM1I             TO  CT-TRM (1).
  3824
  3825     IF TERM2L GREATER ZERO
  3826         MOVE TERM2I             TO  CT-TRM (2).
  3827
  3828     IF TERM3L GREATER ZERO
  3829         MOVE TERM3I             TO  CT-TRM (3).
  3830
  3831     SET ST-INDX                 TO  +1.
  3832     SET AT-INDX                 TO  +1.
  3833     SET RT-INDX                 TO  +1.
  3834
  3835     MOVE +1                     TO  SUB1
  3836                                     SUB2
  3837                                     SUB3.
  3838
  3839 6010-PROCESS.
  3840     IF ST-INDX GREATER +3
  3841         GO TO 6099-EXIT.
  3842
  3843     IF CTBL-TBF-L (ST-INDX) GREATER ZERO
  3844         MOVE CTBL-TBF (ST-INDX)  TO  DEEDIT-FIELD
  3845         PERFORM 7100-DEEDIT  THRU  7100-EXIT
  3846         MOVE DEEDIT-FIELD-V1     TO  CT-TBF (SUB1).
  3847
  3848 6020-UPDATE-AGES.
  3849     IF AT-INDX GREATER +3
  3850         SET ST-INDX  UP  BY  +1
  3851         SET AT-INDX             TO  +1
  3852         ADD +1                  TO  SUB1
  3853         MOVE +1                 TO  SUB2
  3854         GO TO 6010-PROCESS.
  3855
  3856     IF CTBL-AGE-L (ST-INDX AT-INDX) GREATER ZERO
  3857         MOVE CTBL-AGE (ST-INDX AT-INDX)  TO  CT-AGE (SUB2).
  3858
  3859 6030-UPDATE-RATES.
  3860     IF RT-INDX GREATER +3
  3861         SET AT-INDX  UP  BY  +1
  3862         ADD +1                  TO  SUB2
  3863         SET RT-INDX             TO  +1
  3864         GO TO 6020-UPDATE-AGES.
  3865
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL653.cbl
  3866     IF CTBL-RATE-L (ST-INDX AT-INDX RT-INDX) GREATER ZERO
  3867         MOVE SPACES             TO  DEEDIT-FIELD
  3868         MOVE CTBL-RATE (ST-INDX AT-INDX RT-INDX)
  3869             TO  DEEDIT-FIELD-X7
  3870         PERFORM 7100-DEEDIT  THRU  7100-EXIT
  3871         MOVE DEEDIT-FIELD-V5    TO  CT-RT (SUB3).
  3872
  3873     SET RT-INDX  UP  BY  +1.
  3874
  3875     ADD +1                      TO  SUB3.
  3876
  3877     GO TO 6030-UPDATE-RATES.
  3878
  3879 6099-EXIT.
  3880     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL653.cbl
  3882 7000-EDIT.
  3883     IF TERM1L GREATER ZERO
  3884         IF TERM1I NUMERIC
  3885             IF TERM1I GREATER WS-PREV-TERM  OR
  3886                TERM1I = 000 OR  999
  3887                 MOVE TERM1I     TO  WS-PREV-TERM
  3888                 MOVE AL-UNNON   TO  TERM1A
  3889             ELSE
  3890                 MOVE -1         TO  TERM1L
  3891                 MOVE AL-UNBON   TO  TERM1A
  3892                 MOVE ER-2123    TO  EMI-ERROR
  3893                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3894         ELSE
  3895             MOVE -1             TO  TERM1L
  3896             MOVE AL-UNBON       TO  TERM1A
  3897             MOVE ER-2120        TO  EMI-ERROR
  3898             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3899
  3900     IF TERM2L GREATER ZERO
  3901         IF TERM2I NUMERIC
  3902             IF TERM2I GREATER WS-PREV-TERM  OR
  3903                TERM2I = 999
  3904                 MOVE TERM2I     TO  WS-PREV-TERM
  3905                 MOVE AL-UNNON   TO  TERM2A
  3906             ELSE
  3907                 MOVE -1         TO  TERM2L
  3908                 MOVE AL-UNBON   TO  TERM2A
  3909                 MOVE ER-2123    TO  EMI-ERROR
  3910                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3911         ELSE
  3912             MOVE -1             TO  TERM2L
  3913             MOVE AL-UNBON       TO  TERM2A
  3914             MOVE ER-2121        TO  EMI-ERROR
  3915             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3916
  3917     IF TERM3L GREATER ZERO
  3918         IF TERM3I NUMERIC
  3919             IF TERM3I GREATER WS-PREV-TERM  OR
  3920                TERM3I = 999
  3921                 MOVE TERM3I     TO  WS-PREV-TERM
  3922                 MOVE AL-UNNON   TO  TERM3A
  3923             ELSE
  3924                 MOVE -1         TO  TERM3L
  3925                 MOVE AL-UNBON   TO  TERM3A
  3926                 MOVE ER-2123    TO  EMI-ERROR
  3927                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3928         ELSE
  3929             MOVE -1             TO  TERM3L
  3930             MOVE AL-UNBON       TO  TERM3A
  3931             MOVE ER-2122        TO  EMI-ERROR
  3932             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3933
  3934     SET ST-INDX                 TO  +1.
  3935     SET AT-INDX                 TO  +1.
  3936     SET RT-INDX                 TO  +1.
  3937
  3938 7010-PROCESS.
  3939     IF ST-INDX GREATER +3
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL653.cbl
  3940         GO TO 7049-EXIT.
  3941
  3942     IF CTBL-TBF-L (ST-INDX) GREATER ZERO
  3943         MOVE CTBL-TBF (ST-INDX)  TO  DEEDIT-FIELD
  3944         IF CTBL-TBF (ST-INDX) NUMERIC
  3945             IF CTBL-TBF (ST-INDX) = ZEROS
  3946                 MOVE AL-UNBON    TO  CTBL-TBF-A (ST-INDX)
  3947                 MOVE -1          TO  CTBL-TBF-L (ST-INDX)
  3948                 MOVE ER-2124     TO  EMI-ERROR
  3949                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3950             END-IF
  3951         END-IF
  3952     ELSE
  3953         GO TO 7020-EDIT-AGE.
  3954
  3955     PERFORM 7100-DEEDIT  THRU  7100-EXIT.
  3956
  3957     IF DEEDIT-FIELD-V1 GREATER ZERO
  3958         MOVE DEEDIT-FIELD-V1    TO  WS-BENEFIT
  3959         IF WS-BENEFIT = +0999999.99
  3960             MOVE +9999999.99    TO WS-BENEFIT
  3961         END-IF
  3962         IF WS-BENEFIT GREATER WS-PREV-BENEFIT OR
  3963            WS-BENEFIT = WS-MAX-BENEFIT
  3964             MOVE AL-UNNON       TO  CTBL-TBF-A (ST-INDX)
  3965             MOVE WS-BENEFIT     TO  CTBL-TBF-DISP (ST-INDX)
  3966                                     WS-PREV-BENEFIT
  3967         ELSE
  3968             MOVE WS-BENEFIT     TO  CTBL-TBF-DISP (ST-INDX)
  3969             MOVE AL-UNBON       TO  CTBL-TBF-A (ST-INDX)
  3970             MOVE -1             TO  CTBL-TBF-L (ST-INDX)
  3971             MOVE ER-2125        TO  EMI-ERROR
  3972             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3973         END-IF
  3974     ELSE
  3975         MOVE AL-UNBON           TO  CTBL-TBF-A (ST-INDX)
  3976         MOVE -1                 TO  CTBL-TBF-L (ST-INDX)
  3977         MOVE ER-2124            TO  EMI-ERROR
  3978         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3979
  3980 7020-EDIT-AGE.
  3981     IF AT-INDX GREATER +3
  3982         SET ST-INDX  UP  BY  +1
  3983         SET AT-INDX      TO  +1
  3984         GO TO 7010-PROCESS.
  3985
  3986     IF CTBL-AGE-L (ST-INDX AT-INDX) GREATER ZERO
  3987         NEXT SENTENCE
  3988     ELSE
  3989         GO TO 7030-EDIT-RATE.
  3990
  3991     IF CTBL-AGE (ST-INDX AT-INDX) NUMERIC
  3992         IF CTBL-AGE (ST-INDX AT-INDX) GREATER WS-PREV-AGE  OR
  3993            CTBL-AGE (ST-INDX AT-INDX) = WS-MAX-AGE
  3994             MOVE AL-UNNON
  3995                 TO  CTBL-AGE-A (ST-INDX AT-INDX)
  3996             MOVE CTBL-AGE (ST-INDX AT-INDX)
  3997                 TO  WS-PREV-AGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL653.cbl
  3998         ELSE
  3999             MOVE -1        TO  CTBL-AGE-L (ST-INDX AT-INDX)
  4000             MOVE AL-UNBON  TO  CTBL-AGE-A (ST-INDX AT-INDX)
  4001             MOVE ER-2127   TO  EMI-ERROR
  4002             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4003     ELSE
  4004         MOVE -1            TO  CTBL-AGE-L (ST-INDX AT-INDX)
  4005         MOVE AL-UNBON      TO  CTBL-AGE-A (ST-INDX AT-INDX)
  4006         MOVE ER-2128       TO  EMI-ERROR
  4007         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4008
  4009 7030-EDIT-RATE.
  4010     IF RT-INDX GREATER +3
  4011         SET AT-INDX  UP  BY  +1
  4012         SET RT-INDX      TO  +1
  4013         GO TO 7020-EDIT-AGE.
  4014
  4015     IF CTBL-RATE-L (ST-INDX AT-INDX RT-INDX) GREATER ZERO
  4016         MOVE SPACES             TO  DEEDIT-FIELD
  4017         MOVE CTBL-RATE (ST-INDX AT-INDX RT-INDX)
  4018             TO  DEEDIT-FIELD-X7
  4019         PERFORM 7100-DEEDIT  THRU  7100-EXIT
  4020         MOVE DEEDIT-FIELD-V5    TO  WS-RATE
  4021         IF WS-RATE  NUMERIC
  4022             MOVE AL-UNNON
  4023                 TO  CTBL-RATE-A (ST-INDX AT-INDX RT-INDX)
  4024             MOVE WS-RATE
  4025                 TO  CTBL-RATE-DISP (ST-INDX AT-INDX RT-INDX)
  4026         ELSE
  4027             MOVE AL-UNBON
  4028                 TO  CTBL-RATE-A (ST-INDX AT-INDX RT-INDX)
  4029             MOVE -1
  4030                 TO  CTBL-RATE-L (ST-INDX AT-INDX RT-INDX)
  4031             MOVE WS-RATE
  4032                 TO  CTBL-RATE-DISP (ST-INDX AT-INDX RT-INDX)
  4033             MOVE ER-2130   TO EMI-ERROR
  4034             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4035
  4036     SET RT-INDX  UP  BY  +1.
  4037
  4038     GO TO 7030-EDIT-RATE.
  4039
  4040 7049-EXIT.
  4041     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL653.cbl
  4043 7050-READ-ERCTBL.
  4044     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  4045
  4046
  4047* EXEC CICS READ
  4048*         DATASET  (CTBL-FILE-ID)
  4049*         SET      (ADDRESS OF COMM-TABLE-RECORD)
  4050*         RIDFLD   (PI-ERCTBL-KEY)
  4051*    END-EXEC.
  4052*    MOVE '&"S        E          (   #00003890' TO DFHEIV0
  4053     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4054     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4055     MOVE X'2020233030303033383930' TO DFHEIV0(25:11)
  4056     CALL 'kxdfhei1' USING DFHEIV0,
  4057           CTBL-FILE-ID,
  4058           DFHEIV20,
  4059           DFHEIV99,
  4060           PI-ERCTBL-KEY,
  4061           DFHEIV99,
  4062           DFHEIV99,
  4063           DFHEIV99
  4064     SET ADDRESS OF COMM-TABLE-RECORD TO
  4065         DFHEIV20
  4066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4067
  4068
  4069     MOVE PI-ERCTBL-KEY          TO  PI-SAVE-ERCTBL-KEY.
  4070
  4071 7050-EXIT.
  4072     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL653.cbl
  4074 7100-DEEDIT.
  4075
  4076* EXEC CICS BIF
  4077*        DEEDIT
  4078*        FIELD   (DEEDIT-FIELD)
  4079*        LENGTH  (15)
  4080*    END-EXEC.
  4081     MOVE 15
  4082       TO DFHEIV11
  4083*    MOVE '@"L                   #   #00003902' TO DFHEIV0
  4084     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4085     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4086     MOVE X'2020233030303033393032' TO DFHEIV0(25:11)
  4087     CALL 'kxdfhei1' USING DFHEIV0,
  4088           DEEDIT-FIELD,
  4089           DFHEIV11
  4090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4091
  4092
  4093 7100-EXIT.
  4094     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL653.cbl
  4096 7150-ERCTBL-GETMAIN.
  4097
  4098* EXEC CICS GETMAIN
  4099*        SET      (ADDRESS OF COMM-TABLE-RECORD)
  4100*        LENGTH   (ERCTBL-LENGTH)
  4101*        INITIMG  (GETMAIN-SPACE)
  4102*    END-EXEC.
  4103*    MOVE ',"IL                  $   #00003912' TO DFHEIV0
  4104     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4105     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4106     MOVE X'2020233030303033393132' TO DFHEIV0(25:11)
  4107     CALL 'kxdfhei1' USING DFHEIV0,
  4108           DFHEIV20,
  4109           ERCTBL-LENGTH,
  4110           GETMAIN-SPACE
  4111     SET ADDRESS OF COMM-TABLE-RECORD TO
  4112         DFHEIV20
  4113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4114
  4115
  4116 7150-EXIT.
  4117     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL653.cbl
  4119 7200-READ-ERCTBL-UPDATE.
  4120     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  4121
  4122
  4123* EXEC CICS READ
  4124*        DATASET  (CTBL-FILE-ID)
  4125*        SET      (ADDRESS OF COMM-TABLE-RECORD)
  4126*        RIDFLD   (PI-ERCTBL-KEY)
  4127*        UPDATE
  4128*    END-EXEC.
  4129*    MOVE '&"S        EU         (   #00003924' TO DFHEIV0
  4130     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4131     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4132     MOVE X'2020233030303033393234' TO DFHEIV0(25:11)
  4133     CALL 'kxdfhei1' USING DFHEIV0,
  4134           CTBL-FILE-ID,
  4135           DFHEIV20,
  4136           DFHEIV99,
  4137           PI-ERCTBL-KEY,
  4138           DFHEIV99,
  4139           DFHEIV99,
  4140           DFHEIV99
  4141     SET ADDRESS OF COMM-TABLE-RECORD TO
  4142         DFHEIV20
  4143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4144
  4145
  4146 7200-EXIT.
  4147     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL653.cbl
  4149 7250-READ-ERCTBL-GTEQ.
  4150     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  4151
  4152
  4153* EXEC CICS READ
  4154*        DATASET  (CTBL-FILE-ID)
  4155*        SET      (ADDRESS OF COMM-TABLE-RECORD)
  4156*        RIDFLD   (PI-ERCTBL-KEY)
  4157*        GTEQ
  4158*    END-EXEC.
  4159*    MOVE '&"S        G          (   #00003937' TO DFHEIV0
  4160     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  4161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4162     MOVE X'2020233030303033393337' TO DFHEIV0(25:11)
  4163     CALL 'kxdfhei1' USING DFHEIV0,
  4164           CTBL-FILE-ID,
  4165           DFHEIV20,
  4166           DFHEIV99,
  4167           PI-ERCTBL-KEY,
  4168           DFHEIV99,
  4169           DFHEIV99,
  4170           DFHEIV99
  4171     SET ADDRESS OF COMM-TABLE-RECORD TO
  4172         DFHEIV20
  4173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4174
  4175
  4176 7250-EXIT.
  4177     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL653.cbl
  4179 7300-PAGE-TABLE-FORWARD.
  4180     MOVE SPACES                 TO  PI-ERCTBL-EOF-SW.
  4181
  4182     IF TBLCODEL GREATER ZERO
  4183         MOVE TBLCODEI           TO  PI-ERC-TABLE
  4184                                     WS-SAVE-TABLE
  4185         MOVE LOW-VALUES         TO  PI-ERC-BEN-TYPE
  4186                                     PI-ERC-BEN-CODE
  4187     ELSE
  4188         MOVE 'Y'                TO  PI-FIRST-TIME-SW
  4189         MOVE LOW-VALUES         TO  PI-ERCTBL-KEY
  4190                                     WS-SAVE-TABLE.
  4191
  4192     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  4193
  4194     PERFORM 7700-START-BROWSE  THRU  7700-EXIT.
  4195
  4196 7310-READNEXT.
  4197
  4198* EXEC CICS HANDLE CONDITION
  4199*        ENDFILE  (7350-ENDFILE)
  4200*        NOTFND   (7375-NOTFOUND)
  4201*    END-EXEC.
  4202*    MOVE '"$''I                  ! $ #00003965' TO DFHEIV0
  4203     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4204     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4205     MOVE X'2420233030303033393635' TO DFHEIV0(25:11)
  4206     CALL 'kxdfhei1' USING DFHEIV0
  4207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4208
  4209
  4210     PERFORM 7800-READNEXT  THRU  7800-EXIT.
  4211
  4212     IF ERCTBL-EOF
  4213         IF FIRST-TIME
  4214             MOVE LOW-VALUES     TO  EL653AO
  4215             MOVE ER-0583        TO  EMI-ERROR
  4216             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4217             MOVE -1             TO  MAINTYPL
  4218             GO TO 8100-SEND-INITIAL-MAP
  4219         ELSE
  4220             IF BROWSE-STARTED
  4221                 PERFORM 7950-END-BROWSE  THRU  7950-EXIT
  4222                 MOVE LOW-VALUES  TO  EL653AO
  4223                 GO TO 7300-PAGE-TABLE-FORWARD.
  4224
  4225     MOVE SPACE                  TO  PI-FIRST-TIME-SW.
  4226
  4227     IF WS-SAVE-TABLE = PI-ERC-TABLE
  4228         GO TO 7310-READNEXT.
  4229
  4230     MOVE CT-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  4231     MOVE CT-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
  4232     MOVE PI-ERCTBL-KEY          TO  PI-SAVE-ERCTBL-KEY.
  4233     MOVE LOW-VALUES             TO  EL653AO.
  4234     MOVE CT-TABLE               TO  TBLCODEO.
  4235     MOVE CT-BEN-TYPE            TO  COVTYPEO.
  4236     MOVE CT-BEN-CODE            TO  BENCODEO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL653.cbl
  4237     MOVE AL-UANON               TO  TBLCODEA
  4238                                     COVTYPEA
  4239                                     BENCODEA
  4240                                     MAINTYPA.
  4241
  4242     GO TO 5005-SET-UP-SCREEN.
  4243
  4244 7350-ENDFILE.
  4245     IF FIRST-TIME
  4246         MOVE LOW-VALUES         TO  EL653AO
  4247         MOVE ER-0583            TO  EMI-ERROR
  4248         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4249         MOVE -1                 TO  MAINTYPL
  4250         GO TO 8100-SEND-INITIAL-MAP.
  4251
  4252     IF BROWSE-STARTED
  4253         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  4254
  4255     MOVE ER-2067                TO  EMI-ERROR
  4256
  4257     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4258
  4259     MOVE LOW-VALUES             TO  EL653AO
  4260
  4261     GO TO 7300-PAGE-TABLE-FORWARD.
  4262
  4263 7375-NOTFOUND.
  4264     IF BROWSE-STARTED
  4265         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  4266
  4267     GO TO 8880-NOT-FOUND.
  4268
  4269 7399-EXIT.
  4270     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL653.cbl
  4272 7400-PAGE-TABLE-BACKWARD.
  4273     MOVE SPACES                 TO  PI-ERCTBL-EOF-SW.
  4274
  4275     IF TBLCODEL GREATER ZERO
  4276         MOVE TBLCODEI           TO  PI-ERC-TABLE
  4277                                     WS-SAVE-TABLE
  4278         MOVE LOW-VALUES         TO  PI-ERC-BEN-TYPE
  4279                                     PI-ERC-BEN-CODE
  4280     ELSE
  4281         GO TO 7450-ENDFILE.
  4282
  4283     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  4284
  4285     PERFORM 7700-START-BROWSE  THRU  7700-EXIT.
  4286
  4287     PERFORM 7800-READNEXT      THRU  7800-EXIT.
  4288
  4289 7410-READPREV.
  4290
  4291* EXEC CICS HANDLE CONDITION
  4292*        ENDFILE  (7450-ENDFILE)
  4293*        NOTFND   (7475-NOTFOUND)
  4294*    END-EXEC.
  4295*    MOVE '"$''I                  ! % #00004050' TO DFHEIV0
  4296     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4297     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4298     MOVE X'2520233030303034303530' TO DFHEIV0(25:11)
  4299     CALL 'kxdfhei1' USING DFHEIV0
  4300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4301
  4302
  4303     PERFORM 7900-READPREV  THRU  7900-EXIT.
  4304
  4305     IF ERCTBL-EOF
  4306         IF BROWSE-STARTED
  4307             PERFORM 7950-END-BROWSE  THRU  7950-EXIT
  4308             MOVE LOW-VALUES     TO  PI-ERCTBL-KEY
  4309             GO TO 7300-PAGE-TABLE-FORWARD.
  4310
  4311     IF WS-SAVE-TABLE = PI-ERC-TABLE
  4312         GO TO 7410-READPREV
  4313     ELSE
  4314         MOVE LOW-VALUES         TO  PI-ERC-BEN-TYPE
  4315                                     PI-ERC-BEN-CODE
  4316         PERFORM 7250-READ-ERCTBL-GTEQ  THRU  7250-EXIT.
  4317
  4318     IF ERCTBL-EOF
  4319         IF BROWSE-STARTED
  4320             PERFORM 7950-END-BROWSE  THRU  7950-EXIT
  4321             MOVE LOW-VALUES     TO  PI-ERCTBL-KEY
  4322             GO TO 7300-PAGE-TABLE-FORWARD.
  4323
  4324     MOVE CT-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  4325     MOVE CT-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
  4326     MOVE PI-ERCTBL-KEY          TO  PI-SAVE-ERCTBL-KEY.
  4327     MOVE LOW-VALUES             TO  EL653AO.
  4328     MOVE CT-TABLE               TO  TBLCODEO.
  4329     MOVE CT-BEN-TYPE            TO  COVTYPEO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL653.cbl
  4330     MOVE CT-BEN-CODE            TO  BENCODEO.
  4331     MOVE AL-UANON               TO  TBLCODEA
  4332                                     COVTYPEA
  4333                                     BENCODEA
  4334                                     MAINTYPA.
  4335
  4336     GO TO 5005-SET-UP-SCREEN.
  4337
  4338 7450-ENDFILE.
  4339     IF BROWSE-STARTED
  4340         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  4341
  4342     MOVE ER-2135                TO  EMI-ERROR
  4343
  4344     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4345
  4346     MOVE LOW-VALUES             TO  EL653AO
  4347
  4348     GO TO 7300-PAGE-TABLE-FORWARD.
  4349
  4350 7475-NOTFOUND.
  4351     IF BROWSE-STARTED
  4352         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  4353
  4354     GO TO 8880-NOT-FOUND.
  4355
  4356 7499-EXIT.
  4357     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL653.cbl
  4359 7500-PAGE-BENEFIT-FORWARD.
  4360     MOVE SPACES                 TO  PI-ERCTBL-EOF-SW.
  4361
  4362     IF TBLCODEL GREATER ZERO
  4363         MOVE TBLCODEI           TO  PI-ERC-TABLE
  4364                                     WS-SAVE-TABLE
  4365         MOVE COVTYPEI           TO  PI-ERC-BEN-TYPE
  4366         MOVE BENCODEI           TO  PI-ERC-BEN-CODE
  4367     ELSE
  4368         MOVE 'Y'                TO  PI-FIRST-TIME-SW
  4369         MOVE LOW-VALUES         TO  PI-ERCTBL-KEY
  4370                                     WS-SAVE-TABLE.
  4371
  4372     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  4373
  4374     PERFORM 7700-START-BROWSE  THRU  7700-EXIT.
  4375
  4376
  4377* EXEC CICS HANDLE CONDITION
  4378*        ENDFILE  (7550-ENDFILE)
  4379*        NOTFND   (7575-NOTFOUND)
  4380*    END-EXEC.
  4381*    MOVE '"$''I                  ! & #00004128' TO DFHEIV0
  4382     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4383     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4384     MOVE X'2620233030303034313238' TO DFHEIV0(25:11)
  4385     CALL 'kxdfhei1' USING DFHEIV0
  4386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4387
  4388
  4389     PERFORM 7800-READNEXT  THRU  7800-EXIT.
  4390
  4391     IF ERCTBL-EOF
  4392         IF FIRST-TIME
  4393             MOVE LOW-VALUES     TO  EL653AO
  4394             MOVE ER-0583        TO  EMI-ERROR
  4395             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4396             MOVE -1             TO  MAINTYPL
  4397             GO TO 8100-SEND-INITIAL-MAP
  4398         ELSE
  4399             IF BROWSE-STARTED
  4400                 PERFORM 7950-END-BROWSE  THRU  7950-EXIT
  4401                 GO TO 7500-PAGE-BENEFIT-FORWARD.
  4402
  4403     IF NOT FIRST-TIME
  4404         PERFORM 7800-READNEXT  THRU  7800-EXIT.
  4405
  4406     IF ERCTBL-EOF
  4407         PERFORM 7950-END-BROWSE  THRU  7950-EXIT
  4408         MOVE LOW-VALUES         TO  PI-ERCTBL-KEY
  4409         MOVE ER-0590            TO  EMI-ERROR
  4410         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4411         MOVE 'Y'                TO  PI-FIRST-TIME-SW
  4412         GO TO 7500-PAGE-BENEFIT-FORWARD.
  4413
  4414     IF PI-ERC-TABLE = WS-SAVE-TABLE
  4415         NEXT SENTENCE
  4416     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL653.cbl
  4417         IF FIRST-TIME
  4418             NEXT SENTENCE
  4419         ELSE
  4420             MOVE LOW-VALUES     TO  PI-ERCTBL-KEY
  4421             MOVE ER-0590        TO  EMI-ERROR
  4422             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4423             MOVE 'Y'            TO  PI-FIRST-TIME-SW
  4424             PERFORM 7950-END-BROWSE  THRU  7950-EXIT
  4425             GO TO 7500-PAGE-BENEFIT-FORWARD.
  4426
  4427     MOVE SPACES                 TO  PI-FIRST-TIME-SW.
  4428     MOVE CT-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  4429     MOVE CT-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
  4430     MOVE PI-ERCTBL-KEY          TO  PI-SAVE-ERCTBL-KEY.
  4431     MOVE LOW-VALUES             TO  EL653AO.
  4432     MOVE CT-TABLE               TO  TBLCODEO.
  4433     MOVE CT-BEN-TYPE            TO  COVTYPEO.
  4434     MOVE CT-BEN-CODE            TO  BENCODEO.
  4435     MOVE AL-UANON               TO  TBLCODEA
  4436                                     COVTYPEA
  4437                                     BENCODEA
  4438                                     MAINTYPA.
  4439
  4440     GO TO 5005-SET-UP-SCREEN.
  4441
  4442 7550-ENDFILE.
  4443     IF BROWSE-STARTED
  4444         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  4445
  4446     MOVE LOW-VALUES             TO  PI-ERCTBL-KEY.
  4447     MOVE ER-0590                TO  EMI-ERROR.
  4448
  4449     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4450
  4451     MOVE 'Y'                    TO  PI-FIRST-TIME-SW.
  4452
  4453     GO TO 7500-PAGE-BENEFIT-FORWARD.
  4454
  4455 7575-NOTFOUND.
  4456     IF BROWSE-STARTED
  4457         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  4458
  4459     GO TO 8880-NOT-FOUND.
  4460
  4461 7599-EXIT.
  4462     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL653.cbl
  4464 7600-PAGE-BENEFIT-BACKWARD.
  4465     MOVE SPACES                 TO  PI-ERCTBL-EOF-SW.
  4466
  4467     IF TBLCODEL GREATER ZERO
  4468         MOVE TBLCODEI           TO  PI-ERC-TABLE
  4469                                     WS-SAVE-TABLE
  4470         MOVE COVTYPEI           TO  PI-ERC-BEN-TYPE
  4471         MOVE BENCODEI           TO  PI-ERC-BEN-CODE
  4472     ELSE
  4473         GO TO 7650-ENDFILE.
  4474
  4475     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  4476
  4477     PERFORM 7700-START-BROWSE  THRU  7700-EXIT.
  4478
  4479
  4480* EXEC CICS HANDLE CONDITION
  4481*        ENDFILE  (7650-ENDFILE)
  4482*        NOTFND   (7675-NOTFOUND)
  4483*    END-EXEC.
  4484*    MOVE '"$''I                  ! '' #00004223' TO DFHEIV0
  4485     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4486     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4487     MOVE X'2720233030303034323233' TO DFHEIV0(25:11)
  4488     CALL 'kxdfhei1' USING DFHEIV0
  4489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4490
  4491
  4492     PERFORM 7900-READPREV  THRU  7900-EXIT.
  4493
  4494     IF ERCTBL-EOF
  4495         IF BROWSE-STARTED
  4496             PERFORM 7950-END-BROWSE  THRU  7950-EXIT
  4497             GO TO 7500-PAGE-BENEFIT-FORWARD.
  4498
  4499     IF FIRST-TIME
  4500         MOVE SPACES             TO  PI-FIRST-TIME-SW
  4501     ELSE
  4502         PERFORM 7900-READPREV  THRU  7900-EXIT.
  4503
  4504     IF ERCTBL-EOF
  4505         IF BROWSE-STARTED
  4506             PERFORM 7950-END-BROWSE  THRU  7950-EXIT
  4507             GO TO 7500-PAGE-BENEFIT-FORWARD.
  4508
  4509     IF PI-ERC-TABLE = WS-SAVE-TABLE
  4510         NEXT SENTENCE
  4511     ELSE
  4512         MOVE LOW-VALUES         TO  PI-ERCTBL-KEY
  4513         MOVE ER-0591            TO  EMI-ERROR
  4514         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4515         MOVE 'Y'                TO  PI-FIRST-TIME-SW
  4516         PERFORM 7950-END-BROWSE  THRU  7950-EXIT
  4517         GO TO 7500-PAGE-BENEFIT-FORWARD.
  4518
  4519     MOVE CT-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  4520     MOVE CT-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  4521     MOVE CT-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL653.cbl
  4522     MOVE PI-ERCTBL-KEY          TO  PI-SAVE-ERCTBL-KEY.
  4523     MOVE LOW-VALUES             TO  EL653AO.
  4524     MOVE CT-TABLE               TO  TBLCODEO.
  4525     MOVE CT-BEN-TYPE            TO  COVTYPEO.
  4526     MOVE CT-BEN-CODE            TO  BENCODEO.
  4527     MOVE AL-UANON               TO  TBLCODEA
  4528                                     COVTYPEA
  4529                                     BENCODEA
  4530                                     MAINTYPA.
  4531
  4532     GO TO 5005-SET-UP-SCREEN.
  4533
  4534 7650-ENDFILE.
  4535     IF BROWSE-STARTED
  4536         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  4537
  4538     MOVE ER-0591                TO  EMI-ERROR.
  4539
  4540     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4541
  4542     MOVE LOW-VALUES             TO  EL653AO.
  4543
  4544     GO TO 7300-PAGE-TABLE-FORWARD.
  4545
  4546 7675-NOTFOUND.
  4547     IF BROWSE-STARTED
  4548         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  4549
  4550     GO TO 8880-NOT-FOUND.
  4551
  4552 7699-EXIT.
  4553     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL653.cbl
  4555 7700-START-BROWSE.
  4556
  4557* EXEC CICS STARTBR
  4558*        DATASET  (CTBL-FILE-ID)
  4559*        RIDFLD   (PI-ERCTBL-KEY)
  4560*    END-EXEC.
  4561     MOVE 0
  4562       TO DFHEIV11
  4563*    MOVE '&,         G          &   #00004292' TO DFHEIV0
  4564     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4565     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4566     MOVE X'2020233030303034323932' TO DFHEIV0(25:11)
  4567     CALL 'kxdfhei1' USING DFHEIV0,
  4568           CTBL-FILE-ID,
  4569           PI-ERCTBL-KEY,
  4570           DFHEIV99,
  4571           DFHEIV11,
  4572           DFHEIV99
  4573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4574
  4575
  4576     MOVE 'Y'                    TO  PI-BROWSE-SW.
  4577
  4578 7700-EXIT.
  4579     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL653.cbl
  4581 7800-READNEXT.
  4582
  4583* EXEC CICS READNEXT
  4584*        DATASET  (CTBL-FILE-ID)
  4585*        SET      (ADDRESS OF COMM-TABLE-RECORD)
  4586*        RIDFLD   (PI-ERCTBL-KEY)
  4587*    END-EXEC.
  4588     MOVE 0
  4589       TO DFHEIV11
  4590*    MOVE '&.S                   )   #00004303' TO DFHEIV0
  4591     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4592     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4593     MOVE X'2020233030303034333033' TO DFHEIV0(25:11)
  4594     CALL 'kxdfhei1' USING DFHEIV0,
  4595           CTBL-FILE-ID,
  4596           DFHEIV20,
  4597           DFHEIV99,
  4598           PI-ERCTBL-KEY,
  4599           DFHEIV99,
  4600           DFHEIV11,
  4601           DFHEIV99,
  4602           DFHEIV99
  4603     SET ADDRESS OF COMM-TABLE-RECORD TO
  4604         DFHEIV20
  4605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4606
  4607
  4608     IF PI-COMPANY-CD NOT = CT-COMPANY-CD
  4609         MOVE LOW-VALUES         TO  EL653AO
  4610         MOVE 'Y'                TO  PI-ERCTBL-EOF-SW
  4611         IF FIRST-TIME
  4612             MOVE ER-0583        TO  EMI-ERROR
  4613         ELSE
  4614             MOVE ER-2067        TO  EMI-ERROR
  4615     ELSE
  4616         GO TO 7800-EXIT.
  4617
  4618     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4619
  4620 7800-EXIT.
  4621     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL653.cbl
  4623 7900-READPREV.
  4624
  4625* EXEC CICS READPREV
  4626*        DATASET  (CTBL-FILE-ID)
  4627*        SET      (ADDRESS OF COMM-TABLE-RECORD)
  4628*        RIDFLD   (PI-ERCTBL-KEY)
  4629*    END-EXEC.
  4630     MOVE 0
  4631       TO DFHEIV11
  4632*    MOVE '&0S                   )   #00004325' TO DFHEIV0
  4633     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4634     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4635     MOVE X'2020233030303034333235' TO DFHEIV0(25:11)
  4636     CALL 'kxdfhei1' USING DFHEIV0,
  4637           CTBL-FILE-ID,
  4638           DFHEIV20,
  4639           DFHEIV99,
  4640           PI-ERCTBL-KEY,
  4641           DFHEIV99,
  4642           DFHEIV11,
  4643           DFHEIV99,
  4644           DFHEIV99
  4645     SET ADDRESS OF COMM-TABLE-RECORD TO
  4646         DFHEIV20
  4647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4648
  4649
  4650     IF PI-COMPANY-CD NOT = CT-COMPANY-CD
  4651         MOVE ER-2067            TO EMI-ERROR
  4652         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4653         MOVE LOW-VALUES         TO  EL653AO
  4654         MOVE 'Y'                TO  PI-ERCTBL-EOF-SW.
  4655
  4656 7900-EXIT.
  4657     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL653.cbl
  4659 7950-END-BROWSE.
  4660
  4661* EXEC CICS ENDBR
  4662*        DATASET  (CTBL-FILE-ID)
  4663*    END-EXEC.
  4664     MOVE 0
  4665       TO DFHEIV11
  4666*    MOVE '&2                    $   #00004341' TO DFHEIV0
  4667     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4668     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4669     MOVE X'2020233030303034333431' TO DFHEIV0(25:11)
  4670     CALL 'kxdfhei1' USING DFHEIV0,
  4671           CTBL-FILE-ID,
  4672           DFHEIV11,
  4673           DFHEIV99
  4674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4675
  4676
  4677     MOVE SPACE          TO PI-BROWSE-SW.
  4678
  4679 7950-EXIT.
  4680     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL653.cbl
  4682 8000-UPDATE-MAINT-DATE.
  4683     MOVE SPACES                 TO  ELCNTL-KEY.
  4684     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  4685     MOVE '1'                    TO  CNTL-REC-TYPE.
  4686     MOVE +0                     TO  CNTL-SEQ-NO.
  4687
  4688
  4689* EXEC CICS HANDLE CONDITION
  4690*        NOTFND  (8000-EXIT)
  4691*    END-EXEC.
  4692*    MOVE '"$I                   ! ( #00004356' TO DFHEIV0
  4693     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4694     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4695     MOVE X'2820233030303034333536' TO DFHEIV0(25:11)
  4696     CALL 'kxdfhei1' USING DFHEIV0
  4697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4698
  4699
  4700
  4701* EXEC CICS READ
  4702*        UPDATE
  4703*        DATASET  (CNTL-FILE-ID)
  4704*        SET      (ADDRESS OF CONTROL-FILE)
  4705*        RIDFLD   (ELCNTL-KEY)
  4706*    END-EXEC.
  4707*    MOVE '&"S        EU         (   #00004360' TO DFHEIV0
  4708     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4709     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4710     MOVE X'2020233030303034333630' TO DFHEIV0(25:11)
  4711     CALL 'kxdfhei1' USING DFHEIV0,
  4712           CNTL-FILE-ID,
  4713           DFHEIV20,
  4714           DFHEIV99,
  4715           ELCNTL-KEY,
  4716           DFHEIV99,
  4717           DFHEIV99,
  4718           DFHEIV99
  4719     SET ADDRESS OF CONTROL-FILE TO
  4720         DFHEIV20
  4721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4722
  4723
  4724     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  4725     MOVE 'B'                    TO  JP-RECORD-TYPE.
  4726     MOVE CNTL-FILE-ID           TO  FILE-ID.
  4727
  4728     PERFORM 8400-LOG-JOURNAL-RECORD.
  4729
  4730     MOVE BIN-CURRENT-SAVE       TO  CF-COMMISSION-TAB-MAINT-DT.
  4731     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  4732     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4733     MOVE CNTL-FILE-ID           TO  FILE-ID.
  4734
  4735
  4736* EXEC CICS REWRITE
  4737*        DATASET  (CNTL-FILE-ID)
  4738*        FROM     (CONTROL-FILE)
  4739*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL653.cbl
  4740     MOVE LENGTH OF
  4741      CONTROL-FILE
  4742       TO DFHEIV11
  4743*    MOVE '&& L                  %   #00004378' TO DFHEIV0
  4744     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4745     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4746     MOVE X'2020233030303034333738' TO DFHEIV0(25:11)
  4747     CALL 'kxdfhei1' USING DFHEIV0,
  4748           CNTL-FILE-ID,
  4749           CONTROL-FILE,
  4750           DFHEIV11,
  4751           DFHEIV99
  4752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4753
  4754
  4755     PERFORM 8400-LOG-JOURNAL-RECORD.
  4756
  4757 8000-EXIT.
  4758      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL653.cbl
  4760 8100-SEND-INITIAL-MAP.
  4761     MOVE SAVE-DATE              TO  RUNDATEO.
  4762     MOVE EIBTIME                TO  TIME-IN.
  4763     MOVE TIME-OUT               TO  RUNTIMEO.
  4764     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  4765     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  4766     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  4767     MOVE -1                     TO  MAINTYPL.
  4768
  4769
  4770* EXEC CICS SEND
  4771*        MAP     (MAP-NAME)
  4772*        MAPSET  (MAPSET-NAME)
  4773*        FROM    (EL653AO)
  4774*        ERASE
  4775*        CURSOR
  4776*    END-EXEC.
  4777     MOVE LENGTH OF
  4778      EL653AO
  4779       TO DFHEIV12
  4780     MOVE -1
  4781       TO DFHEIV11
  4782*    MOVE '8$     CT  E    H L F ,   #00004397' TO DFHEIV0
  4783     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  4784     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4785     MOVE X'2020233030303034333937' TO DFHEIV0(25:11)
  4786     CALL 'kxdfhei1' USING DFHEIV0,
  4787           MAP-NAME,
  4788           EL653AO,
  4789           DFHEIV12,
  4790           MAPSET-NAME,
  4791           DFHEIV99,
  4792           DFHEIV99,
  4793           DFHEIV99,
  4794           DFHEIV11,
  4795           DFHEIV99,
  4796           DFHEIV99,
  4797           DFHEIV99
  4798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4799
  4800
  4801     GO TO 9100-RETURN-TRAN.
  4802
  4803 8200-SEND-DATAONLY.
  4804     MOVE SAVE-DATE              TO  RUNDATEO.
  4805     MOVE EIBTIME                TO  TIME-IN.
  4806     MOVE TIME-OUT               TO  RUNTIMEO.
  4807     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  4808     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  4809     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  4810
  4811
  4812* EXEC CICS SEND
  4813*        MAP     (MAP-NAME)
  4814*        MAPSET  (MAPSET-NAME)
  4815*        FROM    (EL653AO)
  4816*        DATAONLY
  4817*        CURSOR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL653.cbl
  4818*    END-EXEC.
  4819     MOVE LENGTH OF
  4820      EL653AO
  4821       TO DFHEIV12
  4822     MOVE -1
  4823       TO DFHEIV11
  4824*    MOVE '8$D    CT       H L F ,   #00004415' TO DFHEIV0
  4825     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  4826     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4827     MOVE X'2020233030303034343135' TO DFHEIV0(25:11)
  4828     CALL 'kxdfhei1' USING DFHEIV0,
  4829           MAP-NAME,
  4830           EL653AO,
  4831           DFHEIV12,
  4832           MAPSET-NAME,
  4833           DFHEIV99,
  4834           DFHEIV99,
  4835           DFHEIV99,
  4836           DFHEIV11,
  4837           DFHEIV99,
  4838           DFHEIV99,
  4839           DFHEIV99
  4840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4841
  4842
  4843     GO TO 9100-RETURN-TRAN.
  4844
  4845 8300-SEND-TEXT.
  4846
  4847* EXEC CICS SEND TEXT
  4848*        FROM    (LOGOFF-TEXT)
  4849*        LENGTH  (LOGOFF-LENGTH)
  4850*        ERASE
  4851*        FREEKB
  4852*    END-EXEC.
  4853*    MOVE '8&      T  E F  H   F -   #00004426' TO DFHEIV0
  4854     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  4855     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  4856     MOVE X'2020233030303034343236' TO DFHEIV0(25:11)
  4857     CALL 'kxdfhei1' USING DFHEIV0,
  4858           LOGOFF-TEXT,
  4859           LOGOFF-LENGTH,
  4860           DFHEIV99,
  4861           DFHEIV99,
  4862           DFHEIV99,
  4863           DFHEIV99,
  4864           DFHEIV99,
  4865           DFHEIV99,
  4866           DFHEIV99,
  4867           DFHEIV99,
  4868           DFHEIV99,
  4869           DFHEIV99
  4870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4871
  4872
  4873
  4874* EXEC CICS RETURN
  4875*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL653.cbl
  4876*    MOVE '.(                    &   #00004433' TO DFHEIV0
  4877     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4878     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4879     MOVE X'2020233030303034343333' TO DFHEIV0(25:11)
  4880     CALL 'kxdfhei1' USING DFHEIV0,
  4881           DFHEIV99,
  4882           DFHEIV99,
  4883           DFHEIV99,
  4884           DFHEIV99,
  4885           DFHEIV99
  4886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4887
  4888
  4889 8400-LOG-JOURNAL-RECORD.
  4890     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  4891     MOVE FILE-ID                TO  JP-FILE-ID.
  4892     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  4893
  4894*    EXEC CICS JOURNAL
  4895*        JFILEID  (PI-JOURNAL-FILE-ID)
  4896*        JTYPEID  ('EL')
  4897*        FROM     (JOURNAL-RECORD)
  4898*        LENGTH   (223)
  4899*    END-EXEC.
  4900
  4901 8800-UNAUTHORIZED-ACCESS.
  4902     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  4903
  4904     GO TO 8300-SEND-TEXT.
  4905
  4906 8810-PF23.
  4907     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  4908     MOVE XCTL-005               TO  PGM-NAME.
  4909
  4910     GO TO 9300-XCTL.
  4911
  4912 8880-NOT-FOUND.
  4913     MOVE ER-0142                TO  EMI-ERROR.
  4914
  4915     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4916
  4917     MOVE -1                     TO  MAINTYPL.
  4918
  4919     IF EIBTRNID NOT = TRANS-ID
  4920         GO TO 8100-SEND-INITIAL-MAP.
  4921
  4922     GO TO 8200-SEND-DATAONLY.
  4923
  4924 9100-RETURN-TRAN.
  4925     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  4926     MOVE '653A'                 TO  PI-CURRENT-SCREEN-NO.
  4927
  4928
  4929* EXEC CICS RETURN
  4930*        TRANSID   (TRANS-ID)
  4931*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  4932*        LENGTH    (PI-COMM-LENGTH)
  4933*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL653.cbl
  4934*    MOVE '.(CT                  &   #00004475' TO DFHEIV0
  4935     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  4936     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4937     MOVE X'2020233030303034343735' TO DFHEIV0(25:11)
  4938     CALL 'kxdfhei1' USING DFHEIV0,
  4939           TRANS-ID,
  4940           PROGRAM-INTERFACE-BLOCK,
  4941           PI-COMM-LENGTH,
  4942           DFHEIV99,
  4943           DFHEIV99
  4944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4945
  4946
  4947 9200-RETURN-MAIN-MENU.
  4948     MOVE XCTL-626               TO  PGM-NAME.
  4949
  4950     GO TO 9300-XCTL.
  4951
  4952 9300-XCTL.
  4953
  4954* EXEC CICS XCTL
  4955*        PROGRAM   (PGM-NAME)
  4956*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  4957*        LENGTH    (PI-COMM-LENGTH)
  4958*    END-EXEC.
  4959*    MOVE '.$C                   $   #00004487' TO DFHEIV0
  4960     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4961     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4962     MOVE X'2020233030303034343837' TO DFHEIV0(25:11)
  4963     CALL 'kxdfhei1' USING DFHEIV0,
  4964           PGM-NAME,
  4965           PROGRAM-INTERFACE-BLOCK,
  4966           PI-COMM-LENGTH
  4967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4968
  4969
  4970 9400-CLEAR.
  4971     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  4972
  4973     GO TO 9300-XCTL.
  4974
  4975 9500-PF12.
  4976     MOVE XCTL-010               TO  PGM-NAME.
  4977
  4978     GO TO 9300-XCTL.
  4979
  4980 9600-PGMID-ERROR.
  4981
  4982* EXEC CICS HANDLE CONDITION
  4983*        PGMIDERR  (8300-SEND-TEXT)
  4984*    END-EXEC.
  4985*    MOVE '"$L                   ! ) #00004504' TO DFHEIV0
  4986     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4987     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4988     MOVE X'2920233030303034353034' TO DFHEIV0(25:11)
  4989     CALL 'kxdfhei1' USING DFHEIV0
  4990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4991
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL653.cbl
  4992
  4993     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  4994     MOVE ' '                    TO  PI-ENTRY-CD-1.
  4995     MOVE XCTL-005               TO  PGM-NAME.
  4996     MOVE PGM-NAME               TO  LOGOFF-PGM.
  4997     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  4998
  4999     GO TO 9300-XCTL.
  5000
  5001 9700-LINK-DATE-CONVERT.
  5002
  5003* EXEC CICS LINK
  5004*        PROGRAM   ('ELDATCV')
  5005*        COMMAREA  (DATE-CONVERSION-DATA)
  5006*        LENGTH    (DC-COMM-LENGTH)
  5007*    END-EXEC.
  5008     MOVE 'ELDATCV' TO DFHEIV1
  5009*    MOVE '."C                   ''   #00004517' TO DFHEIV0
  5010     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5011     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5012     MOVE X'2020233030303034353137' TO DFHEIV0(25:11)
  5013     CALL 'kxdfhei1' USING DFHEIV0,
  5014           DFHEIV1,
  5015           DATE-CONVERSION-DATA,
  5016           DC-COMM-LENGTH,
  5017           DFHEIV99,
  5018           DFHEIV99,
  5019           DFHEIV99
  5020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5021
  5022
  5023 9700-EXIT.
  5024     EXIT.
  5025
  5026 9900-ERROR-FORMAT.
  5027     IF NOT EMI-ERRORS-COMPLETE
  5028         MOVE LINK-001           TO  PGM-NAME
  5029
  5030* EXEC CICS LINK
  5031*            PROGRAM   (PGM-NAME)
  5032*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  5033*            LENGTH    (EMI-COMM-LENGTH)
  5034*        END-EXEC.
  5035*    MOVE '."C                   ''   #00004529' TO DFHEIV0
  5036     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5037     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5038     MOVE X'2020233030303034353239' TO DFHEIV0(25:11)
  5039     CALL 'kxdfhei1' USING DFHEIV0,
  5040           PGM-NAME,
  5041           ERROR-MESSAGE-INTERFACE-BLOCK,
  5042           EMI-COMM-LENGTH,
  5043           DFHEIV99,
  5044           DFHEIV99,
  5045           DFHEIV99
  5046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5047
  5048
  5049 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL653.cbl
  5050     EXIT.
  5051
  5052 9990-ABEND.
  5053     MOVE LINK-004               TO  PGM-NAME.
  5054     MOVE DFHEIBLK               TO  EMI-LINE1.
  5055
  5056
  5057* EXEC CICS LINK
  5058*        PROGRAM   (PGM-NAME)
  5059*        COMMAREA  (EMI-LINE1)
  5060*        LENGTH    (72)
  5061*    END-EXEC.
  5062     MOVE 72
  5063       TO DFHEIV11
  5064*    MOVE '."C                   ''   #00004542' TO DFHEIV0
  5065     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5066     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5067     MOVE X'2020233030303034353432' TO DFHEIV0(25:11)
  5068     CALL 'kxdfhei1' USING DFHEIV0,
  5069           PGM-NAME,
  5070           EMI-LINE1,
  5071           DFHEIV11,
  5072           DFHEIV99,
  5073           DFHEIV99,
  5074           DFHEIV99
  5075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5076
  5077
  5078     GO TO 8200-SEND-DATAONLY.
  5079
  5080
  5081* GOBACK.
  5082     MOVE '9%                    "   ' TO DFHEIV0
  5083     MOVE 'EL653' TO DFHEIV1
  5084     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5085     GOBACK.
  5086
  5087 9995-SECURITY-VIOLATION.
  5088*                            COPY ELCSCTP.
  5089******************************************************************
  5090*                                                                *
  5091*                            ELCSCTP                             *
  5092*                            VMOD=2.001                          *
  5093*                                                                *
  5094*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5095******************************************************************
  5096
  5097
  5098     MOVE EIBDATE          TO SM-JUL-DATE.
  5099     MOVE EIBTRMID         TO SM-TERMID.
  5100     MOVE THIS-PGM         TO SM-PGM.
  5101     MOVE EIBTIME          TO TIME-IN.
  5102     MOVE TIME-OUT         TO SM-TIME.
  5103     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5104
  5105
  5106* EXEC CICS LINK
  5107*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL653.cbl
  5108*         COMMAREA (SECURITY-MESSAGE)
  5109*         LENGTH   (80)
  5110*    END-EXEC.
  5111     MOVE 'EL003' TO DFHEIV1
  5112     MOVE 80
  5113       TO DFHEIV11
  5114*    MOVE '."C                   ''   #00004570' TO DFHEIV0
  5115     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5116     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5117     MOVE X'2020233030303034353730' TO DFHEIV0(25:11)
  5118     CALL 'kxdfhei1' USING DFHEIV0,
  5119           DFHEIV1,
  5120           SECURITY-MESSAGE,
  5121           DFHEIV11,
  5122           DFHEIV99,
  5123           DFHEIV99,
  5124           DFHEIV99
  5125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5126
  5127
  5128******************************************************************
  5129
  5130
  5131 9995-EXIT.
  5132      EXIT.
  5133
  5134 9999-DFHBACK SECTION.
  5135     MOVE '9%                    "   ' TO DFHEIV0
  5136     MOVE 'EL653' TO DFHEIV1
  5137     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5138     GOBACK.
  5139 9999-DFHEXIT.
  5140     IF DFHEIGDJ EQUAL 0001
  5141         NEXT SENTENCE
  5142     ELSE IF DFHEIGDJ EQUAL 2
  5143         GO TO 9990-ABEND,
  5144               8880-NOT-FOUND,
  5145               9600-PGMID-ERROR,
  5146               9990-ABEND
  5147         DEPENDING ON DFHEIGDI
  5148     ELSE IF DFHEIGDJ EQUAL 3
  5149         GO TO 9990-ABEND,
  5150               4250-CONT
  5151         DEPENDING ON DFHEIGDI
  5152     ELSE IF DFHEIGDJ EQUAL 4
  5153         GO TO 7350-ENDFILE,
  5154               7375-NOTFOUND
  5155         DEPENDING ON DFHEIGDI
  5156     ELSE IF DFHEIGDJ EQUAL 5
  5157         GO TO 7450-ENDFILE,
  5158               7475-NOTFOUND
  5159         DEPENDING ON DFHEIGDI
  5160     ELSE IF DFHEIGDJ EQUAL 6
  5161         GO TO 7550-ENDFILE,
  5162               7575-NOTFOUND
  5163         DEPENDING ON DFHEIGDI
  5164     ELSE IF DFHEIGDJ EQUAL 7
  5165         GO TO 7650-ENDFILE,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL653.cbl
  5166               7675-NOTFOUND
  5167         DEPENDING ON DFHEIGDI
  5168     ELSE IF DFHEIGDJ EQUAL 8
  5169         GO TO 8000-EXIT
  5170         DEPENDING ON DFHEIGDI
  5171     ELSE IF DFHEIGDJ EQUAL 9
  5172         GO TO 8300-SEND-TEXT
  5173         DEPENDING ON DFHEIGDI.
  5174     MOVE '9%                    "   ' TO DFHEIV0
  5175     MOVE 'EL653' TO DFHEIV1
  5176     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5177     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5012     Code:       11787
