* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page   1
* PYRPTBL.cbl
* Options: int("PYRPTBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("PYRPTBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PYRPTBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"PYRPTBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   PYRPTBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM LORPT
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page   2
* PYRPTBL.cbl
    14* 111810                   PEMA  NEW PROGRAM
    15******************************************************************
    16 ENVIRONMENT DIVISION.
    17 DATA DIVISION.
    18 working-storage section.
    19 01  DFH-START PIC X(04).
    20 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    21 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    22 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    23 77  WS-TODAY-MINUS-7            PIC XX      VALUE LOW-VALUES.
    24 77  R1                          PIC S999 COMP-3 VALUE +0.
    25 77  E1                          PIC S999 COMP-3 VALUE +0.
    26 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    27 77  M1                          PIC S999 COMP-3 VALUE +0.
    28 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    29 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    30 77  WS-EOF-SW                   PIC X  VALUE ' '.
    31     88  END-OF-INPUT              VALUE 'Y'.
    32 77  WS-LOAN-OFF-SW              PIC X   VALUE ' '.
    33     88  LOAN-OFF-GOOD               VALUE 'Y'.
    34 77  WS-ACCT-SW                  PIC X VALUE ' '.
    35     88  ACCT-FOUND                  VALUE 'Y'.
    36     88  ACCT-NOT-FOUND              VALUE 'N'.
    37 77  WS-PNDB-SW                  PIC X VALUE ' '.
    38     88  PNDB-FOUND                  VALUE 'Y'.
    39     88  PNDB-NOT-FOUND              VALUE 'N'.
    40 77  WS-BROWSE-SW                PIC X  VALUE ' '.
    41     88  BROWSE-STARTED             VALUE 'Y'.
    42 77  WS-START-TRYS               PIC S999 COMP-3 VALUE +0.
    43 77  WS-READ-TRYS                PIC S999 COMP-3 VALUE +0.
    44 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    45 77  WS-PREV-PYAJ-KEY            PIC X(28)  VALUE LOW-VALUES.
    46 77  WS-SB-SW                    PIC X  VALUE ' '.
    47     88  PNDB-STARTBR              VALUE 'Y'.
    48 01 response-code         pic s9(8) comp.
    49 01 display-response      pic 9(8).
    50 01 bl-index              pic 9(8) comp.
    51 01 max-last-name         pic x(18).
    52 01 first-initial         pic x.
    53 01 name-in-range-flag    pic 9.
    54 01 max-entries           pic s9(8) comp value 100.
    55 01 lower-case    pic x(26) value
    56            "abcdefghijklmnopqrstuvwxyz".
    57 01 upper-case    pic x(26) value
    58            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
    59 01  WS-SAVE-PYAJ-DATA.
    60     05  WS-SAVE-CARRIER         PIC X.
    61     05  WS-SAVE-GROUPING        PIC X(6).
    62     05  WS-SAVE-STATE           PIC XX.
    63     05  WS-SAVE-RESP-NO         PIC X(10).
    64     05  WS-SAVE-ACCOUNT         PIC X(10).
    65     05  WS-SAVE-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
    66     05  WS-SAVE-TYPE            PIC X.
    67     05  WS-SAVE-GL-ACCT         PIC X(10).
    68     05  WS-SAVE-COMMENT         PIC X(13).
    69     05  WS-SAVE-MAINT-DT        PIC XX   VALUE LOW-VALUES.
    70 01  MISC.
    71     12  WS-RESPONSE             PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page   3
* PYRPTBL.cbl
    72         88  RESP-NORMAL                  VALUE +00.
    73         88  RESP-NOTFND                  VALUE +13.
    74         88  RESP-DUPREC                  VALUE +14.
    75         88  RESP-DUPKEY                  VALUE +15.
    76         88  RESP-NOTOPEN                 VALUE +19.
    77         88  RESP-ENDFILE                 VALUE +20.
    78 01  WS-ERPYAJ-KEY.
    79     05  WS-ERPYAJ-COMPANY-CD    PIC X.
    80     05  WS-ERPYAJ-CARRIER       PIC X.
    81     05  WS-ERPYAJ-GROUP         PIC X(6).
    82     05  WS-ERPYAJ-RESP          PIC X(10).
    83     05  WS-ERPYAJ-ACCT          PIC X(10).
    84     05  WS-ERPYAJ-SEQ           PIC S9(8) COMP.
    85     05  WS-ERPYAJ-TPYE          PIC X.
    86 01  WS-ERPNDB2-KEY.
    87     05  WS-ERPNDB2-COMPANY-CD    PIC X.
    88     05  WS-ERPNDB2-CARRIER       PIC X.
    89     05  WS-ERPNDB2-GROUP         PIC X(6).
    90     05  WS-ERPNDB2-STATE         PIC XX.
    91     05  WS-ERPNDB2-ACCOUNT       PIC X(10).
    92     05  WS-ERPNDB2-EFF-DT        PIC XX.
    93     05  WS-ERPNDB2-CERT-NO       PIC X(11).
    94     05  WS-ERPNDB2-CHG-SEQ       PIC S9(4) COMP.
    95     05  WS-ERPNDB2-REC-TYPE      PIC X.
    96 01  WS-ERACCT-KEY.
    97     05  WS-ERACCT-COMPANY-CD    PIC X.
    98     05  WS-ERACCT-CARRIER       PIC X.
    99     05  WS-ERACCT-GROUP         PIC X(6).
   100     05  WS-ERACCT-STATE         PIC XX.
   101     05  WS-ERACCT-ACCOUNT       PIC X(10).
   102     05  WS-ERACCT-EXP-DT        PIC XX.
   103     05  FILLER                  PIC XXXX.
   104 01  WS-ERCOMP-KEY.
   105     05  WS-ERCOMP-COMPANY-CD    PIC X.
   106     05  WS-ERCOMP-CARRIER       PIC X.
   107     05  WS-ERCOMP-GROUP         PIC X(6).
   108     05  WS-ERCOMP-FIN-RESP      PIC X(10).
   109     05  WS-ERCOMP-ACCOUNT       PIC X(10).
   110     05  WS-ERCOMP-TYPE          PIC X.
   111*                                COPY ELCDATE.
   112******************************************************************
   113*                                                                *
   114*                                                                *
   115*                            ELCDATE.                            *
   116*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   117*                            VMOD=2.003
   118*                                                                *
   119*                                                                *
   120*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   121*                 LENGTH = 200                                   *
   122******************************************************************
   123
   124 01  DATE-CONVERSION-DATA.
   125     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   126     12  DC-OPTION-CODE                PIC X.
   127         88  BIN-TO-GREG                VALUE ' '.
   128         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   129         88  EDIT-GREG-TO-BIN           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page   4
* PYRPTBL.cbl
   130         88  YMD-GREG-TO-BIN            VALUE '3'.
   131         88  MDY-GREG-TO-BIN            VALUE '4'.
   132         88  JULIAN-TO-BIN              VALUE '5'.
   133         88  BIN-PLUS-ELAPSED           VALUE '6'.
   134         88  FIND-CENTURY               VALUE '7'.
   135         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   136         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   137         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   138         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   139         88  JULIAN-TO-BIN-3            VALUE 'C'.
   140         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   141         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   142         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   143         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   144         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   145         88  CHECK-LEAP-YEAR            VALUE 'H'.
   146         88  BIN-3-TO-GREG              VALUE 'I'.
   147         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   148         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   149         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   150         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   151         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   152         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   153         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   154         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   155         88  THREE-CHARACTER-BIN
   156                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   157         88  GREGORIAN-TO-BIN
   158                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   159         88  BIN-TO-GREGORIAN
   160                  VALUES ' ' '1' 'I' '8' 'G'.
   161         88  JULIAN-TO-BINARY
   162                  VALUES '5' 'C' 'E' 'F'.
   163     12  DC-ERROR-CODE                 PIC X.
   164         88  NO-CONVERSION-ERROR        VALUE ' '.
   165         88  DATE-CONVERSION-ERROR
   166                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   167         88  DATE-IS-ZERO               VALUE '1'.
   168         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   169         88  DATE-IS-INVALID            VALUE '3'.
   170         88  DATE1-GREATER-DATE2        VALUE '4'.
   171         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   172         88  DATE-INVALID-OPTION        VALUE '9'.
   173         88  INVALID-CENTURY            VALUE 'A'.
   174         88  ONLY-CENTURY               VALUE 'B'.
   175         88  ONLY-LEAP-YEAR             VALUE 'C'.
   176         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   177     12  DC-END-OF-MONTH               PIC X.
   178         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   179     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   180         88  USE-NORMAL-PROCESS         VALUE ' '.
   181         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   182         88  ADJUST-UP-100-YRS          VALUE '2'.
   183     12  FILLER                        PIC X.
   184     12  DC-CONVERSION-DATES.
   185         16  DC-BIN-DATE-1             PIC XX.
   186         16  DC-BIN-DATE-2             PIC XX.
   187         16  DC-GREG-DATE-1-EDIT       PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page   5
* PYRPTBL.cbl
   188         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   189                       DC-GREG-DATE-1-EDIT.
   190             20  DC-EDIT1-MONTH        PIC 99.
   191             20  SLASH1-1              PIC X.
   192             20  DC-EDIT1-DAY          PIC 99.
   193             20  SLASH1-2              PIC X.
   194             20  DC-EDIT1-YEAR         PIC 99.
   195         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   196         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   197                     DC-GREG-DATE-2-EDIT.
   198             20  DC-EDIT2-MONTH        PIC 99.
   199             20  SLASH2-1              PIC X.
   200             20  DC-EDIT2-DAY          PIC 99.
   201             20  SLASH2-2              PIC X.
   202             20  DC-EDIT2-YEAR         PIC 99.
   203         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   204         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   205                     DC-GREG-DATE-1-YMD.
   206             20  DC-YMD-YEAR           PIC 99.
   207             20  DC-YMD-MONTH          PIC 99.
   208             20  DC-YMD-DAY            PIC 99.
   209         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   210         16  DC-GREG-DATE-1-MDY-R REDEFINES
   211                      DC-GREG-DATE-1-MDY.
   212             20  DC-MDY-MONTH          PIC 99.
   213             20  DC-MDY-DAY            PIC 99.
   214             20  DC-MDY-YEAR           PIC 99.
   215         16  DC-GREG-DATE-1-ALPHA.
   216             20  DC-ALPHA-MONTH        PIC X(10).
   217             20  DC-ALPHA-DAY          PIC 99.
   218             20  FILLER                PIC XX.
   219             20  DC-ALPHA-CENTURY.
   220                 24 DC-ALPHA-CEN-N     PIC 99.
   221             20  DC-ALPHA-YEAR         PIC 99.
   222         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   223         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   224         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   225         16  DC-JULIAN-DATE            PIC 9(05).
   226         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   227                                       PIC 9(05).
   228         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   229             20  DC-JULIAN-YEAR        PIC 99.
   230             20  DC-JULIAN-DAYS        PIC 999.
   231         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   232         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   233         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   234     12  DATE-CONVERSION-VARIBLES.
   235         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   236         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   237             20  FILLER                PIC 9(3).
   238             20  HOLD-CEN-1-CCYY.
   239                 24  HOLD-CEN-1-CC     PIC 99.
   240                 24  HOLD-CEN-1-YY     PIC 99.
   241             20  HOLD-CEN-1-MO         PIC 99.
   242             20  HOLD-CEN-1-DA         PIC 99.
   243         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   244             20  HOLD-CEN-1-R-MO       PIC 99.
   245             20  HOLD-CEN-1-R-DA       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page   6
* PYRPTBL.cbl
   246             20  HOLD-CEN-1-R-CCYY.
   247                 24  HOLD-CEN-1-R-CC   PIC 99.
   248                 24  HOLD-CEN-1-R-YY   PIC 99.
   249             20  FILLER                PIC 9(3).
   250         16  HOLD-CENTURY-1-X.
   251             20  FILLER                PIC X(3)  VALUE SPACES.
   252             20  HOLD-CEN-1-X-CCYY.
   253                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   254                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   255             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   256             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   257         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   258             20  HOLD-CEN-1-R-X-MO     PIC XX.
   259             20  HOLD-CEN-1-R-X-DA     PIC XX.
   260             20  HOLD-CEN-1-R-X-CCYY.
   261                 24  HOLD-CEN-1-R-X-CC PIC XX.
   262                 24  HOLD-CEN-1-R-X-YY PIC XX.
   263             20  FILLER                PIC XXX.
   264         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   265         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   266         16  DC-JULIAN-DATE-1          PIC 9(07).
   267         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   268             20  DC-JULIAN-1-CCYY.
   269                 24  DC-JULIAN-1-CC    PIC 99.
   270                 24  DC-JULIAN-1-YR    PIC 99.
   271             20  DC-JULIAN-DA-1        PIC 999.
   272         16  DC-JULIAN-DATE-2          PIC 9(07).
   273         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   274             20  DC-JULIAN-2-CCYY.
   275                 24  DC-JULIAN-2-CC    PIC 99.
   276                 24  DC-JULIAN-2-YR    PIC 99.
   277             20  DC-JULIAN-DA-2        PIC 999.
   278         16  DC-GREG-DATE-A-EDIT.
   279             20  DC-EDITA-MONTH        PIC 99.
   280             20  SLASHA-1              PIC X VALUE '/'.
   281             20  DC-EDITA-DAY          PIC 99.
   282             20  SLASHA-2              PIC X VALUE '/'.
   283             20  DC-EDITA-CCYY.
   284                 24  DC-EDITA-CENT     PIC 99.
   285                 24  DC-EDITA-YEAR     PIC 99.
   286         16  DC-GREG-DATE-B-EDIT.
   287             20  DC-EDITB-MONTH        PIC 99.
   288             20  SLASHB-1              PIC X VALUE '/'.
   289             20  DC-EDITB-DAY          PIC 99.
   290             20  SLASHB-2              PIC X VALUE '/'.
   291             20  DC-EDITB-CCYY.
   292                 24  DC-EDITB-CENT     PIC 99.
   293                 24  DC-EDITB-YEAR     PIC 99.
   294         16  DC-GREG-DATE-CYMD         PIC 9(08).
   295         16  DC-GREG-DATE-CYMD-R REDEFINES
   296                              DC-GREG-DATE-CYMD.
   297             20  DC-CYMD-CEN           PIC 99.
   298             20  DC-CYMD-YEAR          PIC 99.
   299             20  DC-CYMD-MONTH         PIC 99.
   300             20  DC-CYMD-DAY           PIC 99.
   301         16  DC-GREG-DATE-MDCY         PIC 9(08).
   302         16  DC-GREG-DATE-MDCY-R REDEFINES
   303                              DC-GREG-DATE-MDCY.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page   7
* PYRPTBL.cbl
   304             20  DC-MDCY-MONTH         PIC 99.
   305             20  DC-MDCY-DAY           PIC 99.
   306             20  DC-MDCY-CEN           PIC 99.
   307             20  DC-MDCY-YEAR          PIC 99.
   308    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   309        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   310    12  DC-EL310-DATE                  PIC X(21).
   311    12  FILLER                         PIC X(28).
   312*                                COPY ERCPYAJ.
   313******************************************************************
   314*                                                                *
   315*                            ERCPYAJ                             *
   316*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   317*                            VMOD=2.015                          *
   318*                                                                *
   319*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
   320*                                                                *
   321*                                                                *
   322*   FILE TYPE = VSAM,KSDS                                        *
   323*   RECORD SIZE = 200  RECFORM = FIXED                           *
   324*                                                                *
   325*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
   326*       ALTERNATE PATHS = NONE                                   *
   327*                                                                *
   328*   LOG = YES                                                    *
   329*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   330******************************************************************
   331******************************************************************
   332*                   C H A N G E   L O G
   333*
   334* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   335*-----------------------------------------------------------------
   336*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   337* EFFECTIVE    NUMBER
   338*-----------------------------------------------------------------
   339* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
   340* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
   341******************************************************************
   342
   343 01  PENDING-PAY-ADJ.
   344     12  PY-RECORD-ID                     PIC XX.
   345         88  VALID-PY-ID                        VALUE 'PY'.
   346
   347     12  PY-CONTROL-PRIMARY.
   348         16  PY-COMPANY-CD                PIC X.
   349         16  PY-CARRIER                   PIC X.
   350         16  PY-GROUPING                  PIC X(6).
   351         16  PY-FIN-RESP                  PIC X(10).
   352         16  PY-ACCOUNT                   PIC X(10).
   353         16  PY-PRODUCER REDEFINES PY-ACCOUNT
   354                                          PIC X(10).
   355         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
   356         16  PY-RECORD-TYPE               PIC X.
   357             88  PY-REMIT-RECEIVED            VALUE 'R'.
   358             88  PY-DEPOSIT                   VALUE 'D'.
   359             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
   360             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
   361             88  PY-ADJ-DEPOSIT               VALUE 'T'.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page   8
* PYRPTBL.cbl
   362             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
   363             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
   364             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
   365             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
   366             88  PY-FICA-ENTRY                VALUE 'F'.
   367             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
   368             88  PY-POLICY-FEE                VALUE 'W'.
   369             88  PY-DUE-PREM-ADJ              VALUE 'P'.
   370
   371     12  PY-PYMT-TYPE                     PIC X.
   372             88  PY-NEW-BUS-PYMT              VALUE 'B'.
   373             88  PY-REINS-PYMT                VALUE 'R'.
   374             88  PY-EXP-PYMT                  VALUE 'E'.
   375
   376     12  PY-BIL-INV                       PIC X(6).
   377     12  PY-REF-NO                        PIC X(12).
   378
   379     12  PY-LAST-MAINT-DT                 PIC XX.
   380     12  PY-LAST-MAINT-BY                 PIC X(4).
   381     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   382
   383     12  PY-PYADJ-RECORD.
   384         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
   385         16  PY-ENTRY-COMMENT             PIC X(30).
   386         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
   387             20  PY-GL-ACCOUNT            PIC X(10).
   388             20  PY-GL-STATE              PIC X(02).
   389             20  PY-GL-CANC-SW            PIC X(01).
   390                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
   391                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
   392             20  PY-GL-COMMENT            PIC X(10).
   393             20  FILLER      REDEFINES PY-GL-COMMENT.
   394                 24  PY-GL-CHECK-NO       PIC 9(06).
   395                 24  FILLER               PIC X(04).
   396             20  FILLER                   PIC X(07).
   397         16  PY-SAVE-ACCOUNT              PIC X(10).
   398         16  PY-SAVE-TYPE                 PIC X(01).
   399
   400         16  PY-LETTERS.
   401             20  PY-LETTER OCCURS 3 TIMES
   402                           INDEXED BY PY-LET-NDX
   403                                          PIC X(04).
   404
   405         16  PY-ERCOMP-TYPE               PIC X.
   406             88  PY-ACCOUNT-TYPE              VALUE 'A'.
   407             88  PY-GA-TYPE                   VALUE 'G'.
   408             88  PY-BANK-TYPE                 VALUE 'B'.
   409         16  FILLER                       PIC X(05).
   410
   411     12  PY-RECORD-STATUS.
   412         16  PY-CREDIT-SELECT-DT          PIC XX.
   413         16  PY-CREDIT-ACCEPT-DT          PIC XX.
   414         16  PY-BILLED-DATE               PIC XX.
   415         16  PY-REPORTED-DT               PIC XX.
   416         16  PY-PMT-APPLIED               PIC X.
   417             88  PY-ACCOUNT-PMT               VALUE 'A'.
   418             88  PY-GA-PMT                    VALUE 'G'.
   419             88  PY-OVWRITE-PMT               VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page   9
* PYRPTBL.cbl
   420             88  PY-NON-AR-PMT                VALUE 'N'.
   421         16  FILLER                       PIC X(5).
   422         16  PY-INPUT-DT                  PIC XX.
   423         16  PY-CHECK-NUMBER              PIC X(6).
   424         16  PY-VOID-SW                   PIC X.
   425             88  PY-CHECK-VOIDED              VALUE 'V'.
   426         16  PY-CHECK-ORIGIN-SW           PIC X.
   427             88  PY-BILLING-CHECK             VALUE 'B'.
   428             88  PY-REFUND-CHECK              VALUE 'R'.
   429             88  PY-GA-CHECK                  VALUE 'G'.
   430             88  PY-CHECK-WRITTEN             VALUE 'W'.
   431             88  PY-CHECK-REVERSAL            VALUE 'V'.
   432         16  PY-CHECK-WRITTEN-DT          PIC XX.
   433         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
   434         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
   435         16  PY-BILL-FLAG                 PIC X.
   436             88  PY-BILLED                    VALUE 'B'.
   437         16  PY-AR-FLAG                   PIC X.
   438             88  PY-AR-CYCLE                  VALUE 'C'.
   439             88  PY-AR-MONTH-END              VALUE 'M'.
   440         16  PY-AR-DATE                   PIC XX.
   441
   442     12  PY-GL-CODES.
   443         16  PY-GL-DB                     PIC X(14).
   444         16  PY-GL-CR                     PIC X(14).
   445         16  PY-GL-FLAG                   PIC X.
   446         16  PY-GL-DATE                   PIC XX.
   447
   448     12  PY-CANCEL-FEE-FLAG               PIC X(2).
   449     12  FILLER                           PIC X(3).
   450******************************************************************
   451*                                COPY ERCPNDB.
   452******************************************************************
   453*                                                                *
   454*                                                                *
   455*                            ERCPNDB.                            *
   456*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   457*                            VMOD=2.025                          *
   458*                                                                *
   459*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   460*                                                                *
   461******************************************************************
   462*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
   463*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   464******************************************************************
   465*                                                                *
   466*                                                                *
   467*   FILE TYPE = VSAM,KSDS                                        *
   468*   RECORD SIZE = 585  RECFORM = FIXED                           *
   469*                                                                *
   470*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
   471*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
   472*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   473*                                                 RKP=13,LEN=36  *
   474*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   475*                                      AND CHG-SEQ.)             *
   476*                                                RKP=49,LEN=11   *
   477*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  10
* PYRPTBL.cbl
   478*                                      AND CHG-SEQ.)             *
   479*                                                RKP=60,LEN=15   *
   480*                                                                *
   481*   LOG = NO                                                     *
   482*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   483******************************************************************
   484******************************************************************
   485*                   C H A N G E   L O G
   486*
   487* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   488*-----------------------------------------------------------------
   489*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   490* EFFECTIVE    NUMBER
   491*-----------------------------------------------------------------
   492* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   493* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   494* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   495* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   496* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   497* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   498* 032306                   PEMA  ADD BOW LOAN NUMBER
   499* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   500* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   501* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   502* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   503* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   504* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
   505* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   506* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   507******************************************************************
   508
   509 01  PENDING-BUSINESS.
   510     12  PB-RECORD-ID                     PIC XX.
   511         88  VALID-PB-ID                        VALUE 'PB'.
   512
   513     12  PB-CONTROL-PRIMARY.
   514         16  PB-COMPANY-CD                PIC X.
   515         16  PB-ENTRY-BATCH               PIC X(6).
   516         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   517         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   518
   519     12  PB-CONTROL-BY-ACCOUNT.
   520         16  PB-COMPANY-CD-A1             PIC X.
   521         16  PB-CARRIER                   PIC X.
   522         16  PB-GROUPING.
   523             20  PB-GROUPING-PREFIX       PIC XXX.
   524             20  PB-GROUPING-PRIME        PIC XXX.
   525         16  PB-STATE                     PIC XX.
   526         16  PB-ACCOUNT.
   527             20  PB-ACCOUNT-PREFIX        PIC X(4).
   528             20  PB-ACCOUNT-PRIME         PIC X(6).
   529         16  PB-CERT-EFF-DT               PIC XX.
   530         16  PB-CERT-NO.
   531             20  PB-CERT-PRIME            PIC X(10).
   532             20  PB-CERT-SFX              PIC X.
   533         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   534
   535         16  PB-RECORD-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  11
* PYRPTBL.cbl
   536             88  PB-MAILING-DATA                VALUE '0'.
   537             88  PB-ISSUE                       VALUE '1'.
   538             88  PB-CANCELLATION                VALUE '2'.
   539             88  PB-BATCH-TRAILER               VALUE '9'.
   540
   541     12  PB-CONTROL-BY-ORIG-BATCH.
   542         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   543         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   544         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   545         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   546
   547     12  PB-CONTROL-BY-CSR.
   548         16  PB-CSR-COMPANY-CD            PIC X.
   549         16  PB-CSR-ID                    PIC X(4).
   550         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   551         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   552         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   553******************************************************************
   554*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   555******************************************************************
   556
   557     12  PB-LAST-MAINT-DT                 PIC XX.
   558     12  PB-LAST-MAINT-BY                 PIC X(4).
   559     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   560
   561     12  PB-RECORD-BODY                   PIC X(375).
   562
   563     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   564         16  PB-CERT-ORIGIN               PIC X.
   565             88  CLASIC-CREATED-CERT         VALUE '1'.
   566         16  PB-I-NAME.
   567             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   568             20  PB-I-INSURED-FIRST-NAME.
   569                 24  PB-I-INSURED-1ST-INIT PIC X.
   570                 24  FILLER                PIC X(9).
   571             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   572         16  PB-I-AGE                     PIC S99   COMP-3.
   573         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   574         16  PB-I-BIRTHDAY                PIC XX.
   575         16  PB-I-INSURED-SEX             PIC X.
   576             88  PB-SEX-MALE     VALUE 'M'.
   577             88  PB-SEX-FEMALE   VALUE 'F'.
   578
   579         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   580         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   581         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   582         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   583         16  PB-I-SKIP-CODE               PIC X.
   584             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   585             88  PB-SKIP-JULY              VALUE '1'.
   586             88  PB-SKIP-AUGUST            VALUE '2'.
   587             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   588             88  PB-SKIP-JULY-AUG          VALUE '4'.
   589             88  PB-SKIP-AUG-SEPT          VALUE '5'.
   590             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
   591             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
   592             88  PB-SKIP-JUNE              VALUE '8'.
   593             88  PB-SKIP-JUNE-JULY         VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  12
* PYRPTBL.cbl
   594             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
   595             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
   596         16  PB-I-TERM-TYPE               PIC X.
   597             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
   598             88  PB-PAID-WEEKLY            VALUE 'W'.
   599             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
   600             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
   601             88  PB-PAID-13-YEARLY         VALUE 'T'.
   602         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
   603         16  PB-I-POLICY-FORM-NO          PIC X(12).
   604         16  PB-I-DATA-ENTRY-SW           PIC X.
   605             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
   606             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
   607             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
   608             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
   609         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
   610         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
   611*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
   612         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
   613         16  FILLER                       PIC X.
   614
   615         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
   616             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
   617             88  PB-INVALID-LIFE             VALUE '  ' '00'
   618                                                   '90' THRU '99'.
   619         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
   620                                          PIC XX.
   621         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   622         16  PB-I-AMOUNT-FINANCED REDEFINES
   623                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
   624         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
   625         16  PB-I-UNPAID-CASH-PRICE REDEFINES
   626                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
   627         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   628         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
   629         16  PB-I-CLP-AMOUNT REDEFINES
   630                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
   631         16  PB-I-LF-CALC-FLAG            PIC X.
   632             88 PB-COMP-LF-PREM               VALUE '?'.
   633         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
   634         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
   635         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
   636         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
   637         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
   638         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
   639         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
   640         16  PB-I-LF-ABBR                 PIC XXX.
   641         16  PB-I-LF-INPUT-CD             PIC XX.
   642
   643         16  PB-I-AH-BENEFIT-CD           PIC XX.
   644             88  PB-VALID-AH                 VALUE '01' THRU '89'.
   645             88  PB-INVALID-AH               VALUE '  ' '00'
   646                                                   '90' THRU '99'.
   647         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   648         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   649         16  PB-I-AH-CALC-FLAG            PIC X.
   650             88 PB-COMP-AH-PREM                  VALUE '?'.
   651         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  13
* PYRPTBL.cbl
   652         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
   653         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
   654         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
   655         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
   656         16  PB-I-AH-ABBR                 PIC XXX.
   657         16  PB-I-AH-INPUT-CD             PIC XXX.
   658
   659         16  PB-I-SPECIAL-REIN-CODE       PIC X.
   660         16  PB-I-REIN-TABLE              PIC XXX.
   661         16  PB-I-BUSINESS-TYPE           PIC 99.
   662         16  PB-I-INDV-GRP-CD             PIC X.
   663         16  PB-I-MORT-CODE.
   664             20  PB-I-TABLE               PIC X.
   665             20  PB-I-INTEREST            PIC XX.
   666             20  PB-I-MORT-TYP            PIC X.
   667         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
   668         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
   669         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
   670         16  PB-I-INDV-GRP-OVRD           PIC X.
   671         16  PB-I-RATE-CLASS-OVRD         PIC XX.
   672         16  PB-I-SIG-SW                  PIC X.
   673             88  PB-POLICY-SIGNED             VALUE 'Y'.
   674         16  PB-I-RATE-CLASS              PIC XX.
   675         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
   676         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
   677         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
   678         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
   679         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
   680         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
   681         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
   682         16  PB-I-BENEFIT-TYPE            PIC XXX.
   683         16  PB-I-OB-FLAG                 PIC X.
   684             88  PB-I-OB                      VALUE 'B'.
   685             88  PB-I-SUMMARY                 VALUE 'Z'.
   686         16  PB-I-ENTRY-STATUS            PIC X.
   687             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
   688                                              'M' '5' '9' '2'.
   689             88  PB-I-NORMAL-ENTRY            VALUE '1'.
   690             88  PB-I-POLICY-PENDING          VALUE '2'.
   691             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
   692             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
   693             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
   694             88  PB-I-REIN-ONLY               VALUE '9'.
   695             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
   696             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
   697             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
   698             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
   699         16  PB-I-INT-CODE                PIC X.
   700             88  PB-ADD-ON-INTEREST           VALUE 'A'.
   701             88  PB-SIMPLE-INTEREST           VALUE 'S'.
   702         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   703         16  PB-I-SOC-SEC-NO              PIC X(11).
   704         16  PB-I-MEMBER-NO               PIC X(12).
   705         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
   706*        16  PB-I-LOAN-OFFICER            PIC XXX.
   707         16  PB-I-OLD-LOF                 PIC XXX.
   708         16  PB-I-LF-EXPIRE-DT            PIC XX.
   709         16  PB-I-AH-EXPIRE-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  14
* PYRPTBL.cbl
   710         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
   711         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
   712         16  PB-I-LIFE-INDICATOR          PIC X.
   713             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
   714         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
   715         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
   716                                          PIC S9(5)V99    COMP-3.
   717         16  PB-I-MAIL-ADDRS-SW           PIC X.
   718             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
   719             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
   720         16  PB-I-1ST-PMT-DT              PIC XX.
   721         16  PB-I-JOINT-INSURED.
   722             20 PB-I-JOINT-LAST-NAME      PIC X(15).
   723             20 PB-I-JOINT-FIRST-NAME.
   724                24  PB-I-JOINT-FIRST-INIT PIC X.
   725                24  FILLER                PIC X(9).
   726             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
   727*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
   728         16  PB-I-BENEFICIARY-NAME.
   729             20  PB-I-BANK-NUMBER         PIC X(10).
   730             20  FILLER                   PIC X(15).
   731         16  PB-I-LAST-ADD-ON-DT          PIC XX.
   732         16  PB-I-REFERENCE               PIC X(12).
   733         16  FILLER REDEFINES PB-I-REFERENCE.
   734             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
   735             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
   736             20  PB-I-CLP-STATE           PIC XX.
   737         16  PB-I-UNDERWRITING-STATUS     PIC X.
   738             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
   739             88  PB-I-POLICY-DECLINED         VALUE 'D'.
   740             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
   741         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
   742         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
   743         16  PB-I-RESIDENT-STATE          PIC XX.
   744         16  PB-I-RATE-CODE               PIC X(4).
   745         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
   746         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   747         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   748         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
   749         16  PB-I-BANK-NOCHRGB            PIC 99.
   750         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
   751         16  PB-I-JOINT-BIRTHDAY          PIC XX.
   752
   753     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
   754         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
   755             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
   756         16  PB-C-CANCEL-ORIGIN           PIC X.
   757             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
   758         16  PB-C-LF-CANCEL-DT            PIC XX.
   759         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   760         16  PB-C-LF-CALC-REQ             PIC X.
   761             88 PB-COMP-LF-CANCEL            VALUE '?'.
   762         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
   763         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
   764         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
   765             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
   766         16  PB-C-AH-CANCEL-DT            PIC XX.
   767         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  15
* PYRPTBL.cbl
   768         16  PB-C-AH-CALC-REQ             PIC X.
   769             88 PB-COMP-AH-CANCEL            VALUE '?'.
   770         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
   771         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
   772         16  PB-C-LAST-NAME               PIC X(15).
   773         16  PB-C-REFUND-SW               PIC X.
   774             88  PB-C-REFUND-CREATED          VALUE 'Y'.
   775             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
   776         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
   777         16  PB-C-PAYEE-CODE              PIC X(6).
   778         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
   779         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
   780         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
   781         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
   782         16  PB-C-REFERENCE               PIC X(12).
   783         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   784         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   785         16  PB-C-POST-CARD-IND           PIC X.
   786         16  PB-C-CANCEL-REASON           PIC X.
   787         16  PB-C-REF-INTERFACE-SW        PIC X.
   788         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
   789         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
   790         16  FILLER                       PIC X(01).
   791*        16  FILLER                       PIC X(18).
   792         16  PB-C-POLICY-FORM-NO          PIC X(12).
   793*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
   794         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
   795         16  PB-CANCELED-CERT-DATA.
   796             20  PB-CI-INSURED-NAME.
   797                 24  PB-CI-LAST-NAME      PIC X(15).
   798                 24  PB-CI-INITIALS       PIC XX.
   799             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
   800             20  PB-CI-INSURED-SEX        PIC X.
   801             20  PB-CI-LF-TERM            PIC S999        COMP-3.
   802             20  PB-CI-LF-BENEFIT-CD      PIC XX.
   803             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
   804             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
   805             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   806             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
   807             20  PB-CI-AH-TERM            PIC S999        COMP-3.
   808             20  PB-CI-AH-BENEFIT-CD      PIC XX.
   809             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
   810             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   811             20  PB-CI-RATE-CLASS         PIC XX.
   812             20  PB-CI-RATE-DEV-LF        PIC XXX.
   813             20  PB-CI-RATE-DEV-AH        PIC XXX.
   814             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
   815             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
   816             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
   817             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
   818             20  PB-CI-LF-ABBR            PIC X(3).
   819             20  PB-CI-AH-ABBR            PIC X(3).
   820             20  PB-CI-OB-FLAG            PIC X.
   821                 88  PB-CI-OB                VALUE 'B'.
   822             20  PB-CI-LF-POLICY-STATUS   PIC X.
   823                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
   824                                           'M' '4' '5' '9' '2'.
   825                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  16
* PYRPTBL.cbl
   826                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
   827                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
   828                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
   829                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
   830                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   831                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
   832                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   833                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
   834                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
   835                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
   836                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
   837             20  PB-CI-AH-POLICY-STATUS   PIC X.
   838                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
   839                                           'M' '4' '5' '9' '2'.
   840                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
   841                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
   842                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
   843                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
   844                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
   845                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   846                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
   847                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   848                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
   849                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
   850                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
   851                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
   852             20  PB-CI-PAY-FREQUENCY      PIC 99.
   853             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
   854             20  PB-CI-SOC-SEC-NO         PIC X(11).
   855             20  PB-CI-MEMBER-NO          PIC X(12).
   856             20  PB-CI-INT-CODE           PIC X.
   857                 88  PB-CI-ADD-ON                  VALUE 'A'.
   858                 88  PB-CI-SIMPLE                  VALUE 'S'.
   859             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
   860             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
   861             20  PB-CI-COMP-EXCP-SW       PIC X.
   862                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
   863                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
   864             20  PB-CI-ENTRY-STATUS       PIC X.
   865             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
   866             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
   867             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
   868             20  PB-CI-DEATH-DT           PIC XX.
   869             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
   870             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
   871             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
   872             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
   873             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
   874             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
   875             20  PB-CI-ENTRY-DT              PIC XX.
   876             20  PB-CI-ENTRY-BATCH           PIC X(6).
   877             20  PB-CI-LF-EXPIRE-DT          PIC XX.
   878             20  PB-CI-AH-EXPIRE-DT          PIC XX.
   879             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
   880             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
   881             20  PB-CI-OLD-LOF               PIC XXX.
   882*            20  PB-CI-LOAN-OFFICER          PIC XXX.
   883             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  17
* PYRPTBL.cbl
   884             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
   885             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
   886             20  PB-CI-INDV-GRP-CD           PIC X.
   887             20  PB-CI-BENEFICIARY-NAME.
   888                 24  PB-CI-BANK-NUMBER       PIC X(10).
   889                 24  FILLER                  PIC X(15).
   890             20  PB-CI-NOTE-SW               PIC X.
   891             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
   892             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
   893             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
   894             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
   895             20  PB-CI-LOAN-OFFICER          PIC X(5).
   896             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
   897             20  PB-CI-FIRST-NAME            PIC X(10).
   898             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
   899
   900         16  FILLER                       PIC X(13).
   901*032306  16  FILLER                       PIC X(27).
   902*        16  FILLER                       PIC X(46).
   903
   904     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
   905         16  FILLER                       PIC X(10).
   906         16  PB-M-INSURED-LAST-NAME       PIC X(15).
   907         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
   908         16  PB-M-INSURED-MID-INIT        PIC X.
   909         16  PB-M-INSURED-AGE             PIC 99.
   910         16  PB-M-INSURED-BIRTHDAY        PIC XX.
   911         16  PB-M-INSURED-SEX             PIC X.
   912         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
   913         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
   914         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
   915         16  PB-M-INSURED-CITY-STATE.
   916             20  PB-M-INSURED-CITY        PIC X(28).
   917             20  PB-M-INSURED-STATE       PIC XX.
   918         16  PB-M-INSURED-ZIP-CODE.
   919             20  PB-M-INSURED-ZIP-PRIME.
   920                 24  PB-M-INSURED-ZIP-1   PIC X.
   921                     88  PB-M-CANADIAN-POST-CODE
   922                                             VALUE 'A' THRU 'Z'.
   923                 24  FILLER               PIC X(4).
   924             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
   925         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
   926                                        PB-M-INSURED-ZIP-CODE.
   927             20  PM-M-INS-CAN-POST1       PIC XXX.
   928             20  PM-M-INS-CAN-POST2       PIC XXX.
   929             20  FILLER                   PIC XXX.
   930         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
   931         16  PB-M-JOINT-BIRTHDAY          PIC XX.
   932         16  PB-M-CRED-BENE-NAME          PIC X(30).
   933         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
   934         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
   935         16  PB-M-CRED-BENE-CITYST.
   936             20  PB-M-CRED-BENE-CITY      PIC X(28).
   937             20  PB-M-CRED-BENE-STATE     PIC XX.
   938         16  FILLER                       PIC X(92).
   939
   940     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
   941         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  18
* PYRPTBL.cbl
   942         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   943         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   944         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   945         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   946         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   947         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   948         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   949         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   950         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   951         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   952         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   953         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   954         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   955         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   956         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   957         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   958         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   959         16  PB-ACCOUNT-NAME              PIC X(30).
   960         16  PB-PREM-REF-RPT-FLAG         PIC X.
   961         16  PB-REFERENCE                 PIC X(12).
   962         16  PB-B-RECEIVED-DT             PIC XX.
   963         16  FILLER                       PIC X(234).
   964
   965     12  PB-RECORD-STATUS.
   966         16  PB-CREDIT-SELECT-DT          PIC XX.
   967         16  PB-CREDIT-ACCEPT-DT          PIC XX.
   968         16  PB-BILLED-DT                 PIC XX.
   969         16  PB-BILLING-STATUS            PIC X.
   970             88  PB-ENTRY-REVERSED            VALUE 'R'.
   971             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
   972             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
   973         16  PB-RECORD-BILL               PIC X.
   974             88  PB-RECORD-ON-HOLD            VALUE 'H'.
   975             88  PB-RECORD-RETURNED           VALUE 'R'.
   976             88  PB-RECORD-ENDORSED           VALUE 'E'.
   977             88  PB-OVERRIDE-LIFE             VALUE 'L'.
   978             88  PB-OVERRIDE-AH               VALUE 'A'.
   979             88  PB-OVERRIDE-BOTH             VALUE 'B'.
   980         16  PB-BATCH-ENTRY               PIC X.
   981             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
   982             88  PB-REIN-ONLY-CERT            VALUE 'R'.
   983             88  PB-REISSUED-CERT             VALUE 'E'.
   984             88  PB-MONTHLY-CERT              VALUE 'M'.
   985             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
   986             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
   987             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
   988         16  PB-FORCE-CODE                PIC X.
   989             88  PB-FORCE-OFF                 VALUE ' ' '0'.
   990             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
   991             88  PB-CANCEL-FORCE              VALUE '8'.
   992             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
   993             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
   994             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
   995             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
   996             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
   997             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
   998             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
   999         16  PB-FATAL-FLAG                PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  19
* PYRPTBL.cbl
  1000             88  PB-FATAL-ERRORS              VALUE 'X'.
  1001         16  PB-FORCE-ER-CD               PIC X.
  1002             88  PB-FORCE-ERRORS              VALUE 'F'.
  1003             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1004         16  PB-WARN-ER-CD                PIC X.
  1005             88  PB-WARNING-ERRORS            VALUE 'W'.
  1006         16  FILLER                       PIC X.
  1007         16  PB-OUT-BAL-CD                PIC X.
  1008             88  PB-OUT-OF-BAL                VALUE 'O'.
  1009         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1010         16  PB-AH-OVERRIDE-L1            PIC X.
  1011         16  PB-INPUT-DT                  PIC XX.
  1012         16  PB-INPUT-BY                  PIC X(4).
  1013         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1014         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1015         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1016         16  PB-LF-EARNING-METHOD         PIC X.
  1017         16  PB-AH-EARNING-METHOD         PIC X.
  1018         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1019         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1020         16  PB-REIN-CD                   PIC XXX.
  1021         16  PB-LF-REFUND-TYPE            PIC X.
  1022         16  PB-AH-REFUND-TYPE            PIC X.
  1023         16  PB-ACCT-EFF-DT               PIC XX.
  1024         16  PB-ACCT-EXP-DT               PIC XX.
  1025         16  PB-COMPANY-ID                PIC X(3).
  1026         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1027         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1028         16  PB-SV-CARRIER                PIC X.
  1029         16  PB-SV-GROUPING               PIC X(6).
  1030         16  PB-SV-STATE                  PIC XX.
  1031         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  1032         16  PB-GA-BILLING-INFO.
  1033             20  PB-GA-BILL-DT OCCURS 5 TIMES
  1034                                          PIC XX.
  1035         16  PB-SV-REMIT-TO  REDEFINES
  1036             PB-GA-BILLING-INFO           PIC X(10).
  1037         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  1038         16  PB-I-LOAN-OFFICER            PIC X(5).
  1039         16  PB-I-VIN                     PIC X(17).
  1040
  1041         16  FILLER                       PIC X(04).
  1042         16  IMNET-BYPASS-SW              PIC X.
  1043
  1044******************************************************************
  1045*                COMMON EDIT ERRORS                              *
  1046******************************************************************
  1047
  1048     12  PB-COMMON-ERRORS.
  1049         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  1050                                           PIC S9(4)     COMP.
  1051
  1052******************************************************************
  1053*                                COPY ERCACCT.
  1054******************************************************************
  1055*                                                                *
  1056*                                                                *
  1057*                            ERCACCT                             *
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  20
* PYRPTBL.cbl
  1058*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1059*                            VMOD=2.031                          *
  1060*                                                                *
  1061*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1062*                                                                *
  1063*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1064*   VSAM ACCOUNT MASTER FILES.                                   *
  1065*                                                                *
  1066*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1067*                                                                *
  1068*   FILE TYPE = VSAM,KSDS                                        *
  1069*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1070*                                                                *
  1071*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1072*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1073*                                                                *
  1074*   LOG = NO                                                     *
  1075*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1076*                                                                *
  1077*                                                                *
  1078******************************************************************
  1079*                   C H A N G E   L O G
  1080*
  1081* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1082*-----------------------------------------------------------------
  1083*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1084* EFFECTIVE    NUMBER
  1085*-----------------------------------------------------------------
  1086* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1087* 092705    2005050300006  PEMA  ADD SPP LEASES
  1088* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1089* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1090* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1091* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1092* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1093******************************************************************
  1094
  1095 01  ACCOUNT-MASTER.
  1096     12  AM-RECORD-ID                      PIC XX.
  1097         88  VALID-AM-ID                      VALUE 'AM'.
  1098
  1099     12  AM-CONTROL-PRIMARY.
  1100         16  AM-COMPANY-CD                 PIC X.
  1101         16  AM-MSTR-CNTRL.
  1102             20  AM-CONTROL-A.
  1103                 24  AM-CARRIER            PIC X.
  1104                 24  AM-GROUPING.
  1105                     28 AM-GROUPING-PREFIX PIC XXX.
  1106                     28 AM-GROUPING-PRIME  PIC XXX.
  1107                 24  AM-STATE              PIC XX.
  1108                 24  AM-ACCOUNT.
  1109                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1110                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1111             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1112                                           PIC X(19).
  1113             20  AM-CNTRL-B.
  1114                 24  AM-EXPIRATION-DT      PIC XX.
  1115                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  21
* PYRPTBL.cbl
  1116             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1117                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1118
  1119     12  AM-CONTROL-BY-VAR-GRP.
  1120         16  AM-COMPANY-CD-A1              PIC X.
  1121         16  AM-VG-CARRIER                 PIC X.
  1122         16  AM-VG-GROUPING                PIC X(6).
  1123         16  AM-VG-STATE                   PIC XX.
  1124         16  AM-VG-ACCOUNT                 PIC X(10).
  1125         16  AM-VG-DATE.
  1126             20  AM-VG-EXPIRATION-DT       PIC XX.
  1127             20  FILLER                    PIC X(4).
  1128         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1129                                           PIC 9(11)      COMP-3.
  1130     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1131         16  FILLER                        PIC X(10).
  1132         16  AM-VG-KEY3.
  1133             20  AM-VG3-ACCOUNT            PIC X(10).
  1134             20  AM-VG3-EXP-DT             PIC XX.
  1135         16  FILLER                        PIC X(4).
  1136     12  AM-MAINT-INFORMATION.
  1137         16  AM-LAST-MAINT-DT              PIC XX.
  1138         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1139         16  AM-LAST-MAINT-USER            PIC X(4).
  1140         16  FILLER                        PIC XX.
  1141
  1142     12  AM-EFFECTIVE-DT                   PIC XX.
  1143     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1144
  1145     12  AM-PREV-DATES  COMP-3.
  1146         16  AM-PREV-EXP-DT                PIC 9(11).
  1147         16  AM-PREV-EFF-DT                PIC 9(11).
  1148
  1149     12  AM-REPORT-CODE-1                  PIC X(10).
  1150     12  AM-REPORT-CODE-2                  PIC X(10).
  1151
  1152     12  AM-CITY-CODE                      PIC X(4).
  1153     12  AM-COUNTY-PARISH                  PIC X(6).
  1154
  1155     12  AM-NAME                           PIC X(30).
  1156     12  AM-PERSON                         PIC X(30).
  1157     12  AM-ADDRS                          PIC X(30).
  1158     12  AM-CITY.
  1159         16  AM-ADDR-CITY                  PIC X(28).
  1160         16  AM-ADDR-STATE                 PIC XX.
  1161     12  AM-ZIP.
  1162         16  AM-ZIP-PRIME.
  1163             20  AM-ZIP-PRI-1ST            PIC X.
  1164                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1165             20  FILLER                    PIC X(4).
  1166         16  AM-ZIP-PLUS4                  PIC X(4).
  1167     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1168         16  AM-CAN-POSTAL-1               PIC XXX.
  1169         16  AM-CAN-POSTAL-2               PIC XXX.
  1170         16  FILLER                        PIC XXX.
  1171     12  AM-TEL-NO.
  1172         16  AM-AREA-CODE                  PIC 999.
  1173         16  AM-TEL-PRE                    PIC 999.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  22
* PYRPTBL.cbl
  1174         16  AM-TEL-NBR                    PIC 9(4).
  1175     12  AM-TEL-LOC                        PIC X.
  1176         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1177         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1178
  1179     12  AM-COMM-STRUCTURE.
  1180         16  AM-DEFN-1.
  1181             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1182                 24  AM-AGT.
  1183                     28  AM-AGT-PREFIX     PIC X(4).
  1184                     28  AM-AGT-PRIME      PIC X(6).
  1185                 24  AM-COM-TYP            PIC X.
  1186                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1187                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1188                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1189                 24  AM-RECALC-LV-INDIC    PIC X.
  1190                 24  AM-RETRO-LV-INDIC     PIC X.
  1191                 24  AM-GL-CODES           PIC X.
  1192                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1193                 24  FILLER                PIC X(01).
  1194         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1195             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1196                 24  FILLER                PIC X(11).
  1197                 24  AM-L-COMA             PIC XXX.
  1198                 24  AM-J-COMA             PIC XXX.
  1199                 24  AM-A-COMA             PIC XXX.
  1200                 24  FILLER                PIC X(6).
  1201
  1202     12  AM-COMM-CHANGE-STATUS             PIC X.
  1203         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1204
  1205     12  AM-CSR-CODE                       PIC X(4).
  1206
  1207     12  AM-BILLING-STATUS                 PIC X.
  1208         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1209         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1210     12  AM-AUTO-REFUND-SW                 PIC X.
  1211         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1212         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1213     12  AM-GPCD                           PIC 99.
  1214     12  AM-IG                             PIC X.
  1215         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1216         88  AM-HAS-GROUP                     VALUE '2'.
  1217     12  AM-STATUS                         PIC X.
  1218         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1219         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1220         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1221         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1222         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1223         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1224     12  AM-REMIT-TO                       PIC 99.
  1225     12  AM-ID-NO                          PIC X(11).
  1226
  1227     12  AM-CAL-TABLE                      PIC XX.
  1228     12  AM-LF-DEVIATION                   PIC XXX.
  1229     12  AM-AH-DEVIATION                   PIC XXX.
  1230     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1231     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  23
* PYRPTBL.cbl
  1232     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1233     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1234     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1235     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1236
  1237     12  AM-USER-FIELDS.
  1238         16  AM-FLD-1                      PIC XX.
  1239         16  AM-FLD-2                      PIC XX.
  1240         16  AM-FLD-3                      PIC XX.
  1241         16  AM-FLD-4                      PIC XX.
  1242         16  AM-FLD-5                      PIC XX.
  1243
  1244     12  AM-1ST-PROD-DATE.
  1245         16  AM-1ST-PROD-YR                PIC XX.
  1246         16  AM-1ST-PROD-MO                PIC XX.
  1247         16  AM-1ST-PROD-DA                PIC XX.
  1248     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1249     12  AM-CERTS-PURGED-DATE.
  1250         16  AM-PUR-YR                     PIC XX.
  1251         16  AM-PUR-MO                     PIC XX.
  1252         16  AM-PUR-DA                     PIC XX.
  1253     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1254     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1255     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1256     12  AM-INACTIVE-DATE.
  1257         16  AM-INA-MO                     PIC 99.
  1258         16  AM-INA-DA                     PIC 99.
  1259         16  AM-INA-YR                     PIC 99.
  1260     12  AM-AR-HI-CERT-DATE                PIC XX.
  1261
  1262     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1263     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1264
  1265     12  AM-OB-PAYMENT-MODE                PIC X.
  1266         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1267         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1268         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1269         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1270
  1271     12  AM-AH-ONLY-INDICATOR              PIC X.
  1272         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1273         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1274
  1275     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1276
  1277     12  AM-OVER-SHORT.
  1278         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1279         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1280
  1281     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1282     12  AM-DCC-CLP-STATE                  PIC XX.
  1283
  1284     12  AM-RECALC-COMM                    PIC X.
  1285     12  AM-RECALC-REIN                    PIC X.
  1286
  1287     12  AM-REI-TABLE                      PIC XXX.
  1288     12  AM-REI-ET-LF                      PIC X.
  1289     12  AM-REI-ET-AH                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  24
* PYRPTBL.cbl
  1290     12  AM-REI-PE-LF                      PIC X.
  1291     12  AM-REI-PE-AH                      PIC X.
  1292     12  AM-REI-PRT-ST                     PIC X.
  1293     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1294     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1295     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1296     12  AM-REI-GROUP-A                    PIC X(6).
  1297     12  AM-REI-MORT                       PIC X(4).
  1298     12  AM-REI-PRT-OW                     PIC X.
  1299     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1300     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1301     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1302     12  AM-REI-GROUP-B                    PIC X(6).
  1303
  1304     12  AM-TRUST-TYPE                     PIC X(2).
  1305
  1306     12  AM-EMPLOYER-STMT-USED             PIC X.
  1307     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1308
  1309     12  AM-STD-AH-TYPE                    PIC XX.
  1310     12  AM-EARN-METHODS.
  1311         16  AM-EARN-METHOD-R              PIC X.
  1312             88 AM-REF-RL-R78                 VALUE 'R'.
  1313             88 AM-REF-RL-PR                  VALUE 'P'.
  1314             88 AM-REF-RL-MEAN                VALUE 'M'.
  1315             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1316         16  AM-EARN-METHOD-L              PIC X.
  1317             88 AM-REF-LL-R78                 VALUE 'R'.
  1318             88 AM-REF-LL-PR                  VALUE 'P'.
  1319             88 AM-REF-LL-MEAN                VALUE 'M'.
  1320             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1321         16  AM-EARN-METHOD-A              PIC X.
  1322             88 AM-REF-AH-R78                 VALUE 'R'.
  1323             88 AM-REF-AH-PR                  VALUE 'P'.
  1324             88 AM-REF-AH-MEAN                VALUE 'M'.
  1325             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1326             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1327             88 AM-REF-AH-NET                 VALUE 'N'.
  1328
  1329     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1330     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1331     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1332
  1333     12  AM-RET-Y-N                        PIC X.
  1334     12  AM-RET-P-E                        PIC X.
  1335     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1336     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1337     12  AM-RET-GRP                        PIC X(6).
  1338     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1339         16  AM-POOL-PRIME                 PIC XXX.
  1340         16  AM-POOL-SUB                   PIC XXX.
  1341     12  AM-RETRO-EARNINGS.
  1342         16  AM-RET-EARN-R                 PIC X.
  1343         16  AM-RET-EARN-L                 PIC X.
  1344         16  AM-RET-EARN-A                 PIC X.
  1345     12  AM-RET-ST-TAX-USE                 PIC X.
  1346         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1347         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  25
* PYRPTBL.cbl
  1348     12  AM-RETRO-BEG-EARNINGS.
  1349         16  AM-RET-BEG-EARN-R             PIC X.
  1350         16  AM-RET-BEG-EARN-L             PIC X.
  1351         16  AM-RET-BEG-EARN-A             PIC X.
  1352     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1353     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1354
  1355     12  AM-USER-SELECT-OPTIONS.
  1356         16  AM-USER-SELECT-1              PIC X(10).
  1357         16  AM-USER-SELECT-2              PIC X(10).
  1358         16  AM-USER-SELECT-3              PIC X(10).
  1359         16  AM-USER-SELECT-4              PIC X(10).
  1360         16  AM-USER-SELECT-5              PIC X(10).
  1361
  1362     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1363
  1364     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1365
  1366     12  AM-RPT045A-SWITCH                 PIC X.
  1367         88  RPT045A-OFF                   VALUE 'N'.
  1368
  1369     12  AM-INSURANCE-LIMITS.
  1370         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1371         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1372
  1373     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1374         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1375
  1376     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1377         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1378         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1379
  1380     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1381
  1382     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1383     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1384     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1385     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1386     12  AM-DCC-UEF-STATE                  PIC XX.
  1387     12  FILLER                            PIC XXX.
  1388     12  AM-REPORT-CODE-3                  PIC X(10).
  1389*    12  FILLER                            PIC X(22).
  1390
  1391     12  AM-RESERVE-DATE.
  1392         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1393         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1394         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1395
  1396     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1397     12  AM-NOTIFICATION-TYPES.
  1398         16  AM-NOTIF-OF-LETTERS           PIC X.
  1399         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1400         16  AM-NOTIF-OF-REPORTS           PIC X.
  1401         16  AM-NOTIF-OF-STATUS            PIC X.
  1402
  1403     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1404         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1405         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  26
* PYRPTBL.cbl
  1406         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1407         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1408
  1409     12  AM-BENEFIT-CONTROLS.
  1410         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1411             20  AM-BENEFIT-CODE           PIC XX.
  1412             20  AM-BENEFIT-TYPE           PIC X.
  1413             20  AM-BENEFIT-REVISION       PIC XXX.
  1414             20  AM-BENEFIT-REM-TERM       PIC X.
  1415             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1416             20  FILLER                    PIC XX.
  1417         16  FILLER                        PIC X(80).
  1418
  1419     12  AM-TRANSFER-DATA.
  1420         16  AM-TRANSFERRED-FROM.
  1421             20  AM-TRNFROM-CARRIER        PIC X.
  1422             20  AM-TRNFROM-GROUPING.
  1423                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1424                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1425             20  AM-TRNFROM-STATE          PIC XX.
  1426             20  AM-TRNFROM-ACCOUNT.
  1427                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1428                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1429             20  AM-TRNFROM-DTE            PIC XX.
  1430         16  AM-TRANSFERRED-TO.
  1431             20  AM-TRNTO-CARRIER          PIC X.
  1432             20  AM-TRNTO-GROUPING.
  1433                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1434                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1435             20  AM-TRNTO-STATE            PIC XX.
  1436             20  AM-TRNTO-ACCOUNT.
  1437                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1438                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1439             20  AM-TRNTO-DTE              PIC XX.
  1440         16  FILLER                        PIC X(10).
  1441
  1442     12  AM-SAVED-REMIT-TO                 PIC 99.
  1443
  1444     12  AM-COMM-STRUCTURE-SAVED.
  1445         16  AM-DEFN-1-SAVED.
  1446             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1447                 24  AM-AGT-SV             PIC X(10).
  1448                 24  AM-COM-TYP-SV         PIC X.
  1449                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1450                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1451                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1452                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1453                 24  FILLER                PIC X.
  1454                 24  AM-GL-CODES-SV        PIC X.
  1455                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1456                 24  FILLER                PIC X.
  1457         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1458             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1459                 24  FILLER                PIC X(11).
  1460                 24  AM-L-COMA-SV          PIC XXX.
  1461                 24  AM-J-COMA-SV          PIC XXX.
  1462                 24  AM-A-COMA-SV          PIC XXX.
  1463                 24  FILLER                PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  27
* PYRPTBL.cbl
  1464
  1465     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1466         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1467            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1468            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1469            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1470
  1471     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1472     12  FILLER                            PIC X(120).
  1473
  1474     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1475         16  AM-CONTROL-NAME               PIC X(30).
  1476         16  AM-EXECUTIVE-ONE.
  1477             20  AM-EXEC1-NAME             PIC X(15).
  1478             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1479                                                          COMP-3.
  1480             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1481                                                          COMP-3.
  1482         16  AM-EXECUTIVE-TWO.
  1483             20  AM-EXEC2-NAME             PIC X(15).
  1484             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1485                                                          COMP-3.
  1486             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1487                                                          COMP-3.
  1488
  1489     12  AM-RETRO-ADDITIONAL-DATA.
  1490         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1491         16  AM-RETRO-PREM-P-E             PIC X.
  1492         16  AM-RETRO-CLMS-P-I             PIC X.
  1493         16  AM-RETRO-RET-BRACKET-LF.
  1494             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1495                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1496                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1497             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1498                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1499                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1500             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1501                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1502                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1503         16  AM-RETRO-RET-BRACKET-AH.
  1504             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1505                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1506                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1507                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1508             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1509                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1510                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1511             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1512                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1513                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1514
  1515     12  AM-COMMENTS.
  1516         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1517
  1518     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1519         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1520         16  AM-FLI-BILLING-CODE           PIC X.
  1521         16  AM-FLI-ALT-STATE-CODE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  28
* PYRPTBL.cbl
  1522         16  AM-FLI-UNITED-IDENT           PIC X.
  1523         16  AM-FLI-INTEREST-LOST-DATA.
  1524             20  AM-FLI-BANK-NO            PIC X(5).
  1525             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1526             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1527             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1528         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1529             20  AM-FLI-AGT                PIC X(9).
  1530             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1531             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1532         16  FILLER                        PIC X(102).
  1533
  1534     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1535         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1536             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1537             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1538             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1539             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1540             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1541         16  FILLER                          PIC X(10).
  1542******************************************************************
  1543*                                COPY ERCCOMP.
  1544******************************************************************
  1545*                                                                *
  1546*                                                                *
  1547*                            ERCCOMP                             *
  1548*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1549*                            VMOD=2.019                          *
  1550*                                                                *
  1551*   ONLINE CREDIT SYSTEM                                         *
  1552*                                                                *
  1553*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1554*                                                                *
  1555*   FILE TYPE = VSAM,KSDS                                        *
  1556*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1557*                                                                *
  1558*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1559*       ALTERNATE PATH = NONE                                    *
  1560*                                                                *
  1561*   LOG = NO                                                     *
  1562*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1563*                                                                *
  1564******************************************************************
  1565*                   C H A N G E   L O G
  1566*
  1567* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1568*-----------------------------------------------------------------
  1569*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1570* EFFECTIVE    NUMBER
  1571*-----------------------------------------------------------------
  1572* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1573* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1574* 092205    2005050300006  PEMA  ADD LEASE FEE
  1575* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1576* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1577* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1578* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1579* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  29
* PYRPTBL.cbl
  1580* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1581******************************************************************
  1582
  1583 01  COMPENSATION-MASTER.
  1584     12  CO-RECORD-ID                          PIC XX.
  1585         88  VALID-CO-ID                          VALUE 'CO'.
  1586
  1587     12  CO-CONTROL-PRIMARY.
  1588         16  CO-COMPANY-CD                     PIC X.
  1589         16  CO-CONTROL.
  1590             20  CO-CTL-1.
  1591                 24  CO-CARR-GROUP.
  1592                     28  CO-CARRIER            PIC X.
  1593                     28  CO-GROUPING.
  1594                         32  CO-GROUP-PREFIX   PIC XXX.
  1595                         32  CO-GROUP-PRIME    PIC XXX.
  1596                 24  CO-RESP-NO.
  1597                     28  CO-RESP-PREFIX        PIC X(4).
  1598                     28  CO-RESP-PRIME         PIC X(6).
  1599             20  CO-CTL-2.
  1600                 24  CO-ACCOUNT.
  1601                     28  CO-ACCT-PREFIX        PIC X(4).
  1602                     28  CO-ACCT-PRIME         PIC X(6).
  1603         16  CO-TYPE                           PIC X.
  1604             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1605             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1606             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1607
  1608     12  CO-MAINT-INFORMATION.
  1609         16  CO-LAST-MAINT-DT                  PIC XX.
  1610         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1611         16  CO-LAST-MAINT-USER                PIC X(4).
  1612     12  FILLER                                PIC XX.
  1613     12  CO-STMT-TYPE                          PIC XXX.
  1614     12  CO-COMP-TYPE                          PIC X.
  1615         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1616     12  CO-STMT-OWNER                         PIC X(4).
  1617     12  CO-BALANCE-CONTROL                    PIC X.
  1618         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1619         88  CO-NO-BALANCE                        VALUE 'N'.
  1620
  1621     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1622         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1623         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1624         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1625
  1626     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1627         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1628         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1629
  1630     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1631     12  CO-GA-DIRECT-DEP                      PIC X.
  1632     12  CO-FUTURE-SPACE                       PIC X.
  1633         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1634
  1635     12  CO-ACCT-NAME                          PIC X(30).
  1636     12  CO-MAIL-NAME                          PIC X(30).
  1637     12  CO-ADDR-1                             PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  30
* PYRPTBL.cbl
  1638     12  CO-ADDR-2                             PIC X(30).
  1639     12  CO-ADDR-3.
  1640         16  CO-ADDR-CITY                      PIC X(27).
  1641         16  CO-ADDR-STATE                     PIC XX.
  1642     12  CO-CSO-1099                           PIC X.
  1643     12  CO-ZIP.
  1644         16  CO-ZIP-PRIME.
  1645             20  CO-ZIP-PRI-1ST                PIC X.
  1646                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1647             20  FILLER                        PIC X(4).
  1648         16  CO-ZIP-PLUS4                      PIC X(4).
  1649     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1650         16  CO-CAN-POSTAL-1                   PIC XXX.
  1651         16  CO-CAN-POSTAL-2                   PIC XXX.
  1652         16  FILLER                            PIC XXX.
  1653     12  CO-SOC-SEC                            PIC X(13).
  1654     12  CO-TELEPHONE.
  1655         16  CO-AREA-CODE                      PIC XXX.
  1656         16  CO-PREFIX                         PIC XXX.
  1657         16  CO-PHONE                          PIC X(4).
  1658
  1659     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1660
  1661     12  CO-AR-BAL-LEVEL                       PIC X.
  1662         88  CO-AR-REF-LVL                        VALUE '1'.
  1663         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1664         88  CO-AR-BILL-LVL                       VALUE '2'.
  1665         88  CO-AR-AGT-LVL                        VALUE '3'.
  1666         88  CO-AR-FR-LVL                         VALUE '4'.
  1667
  1668     12  CO-AR-NORMAL-PRINT                    PIC X.
  1669         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1670         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1671
  1672     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1673
  1674     12  CO-AR-REPORTING                       PIC X.
  1675         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1676         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1677
  1678     12  CO-AR-PULL-CHECK                      PIC X.
  1679         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1680         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1681
  1682     12  CO-AR-BALANCE-PRINT                   PIC X.
  1683         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1684
  1685     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1686         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1687         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1688         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1689
  1690     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1691
  1692     12  CO-USER-CODE                          PIC X.
  1693     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1694
  1695******************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  31
* PYRPTBL.cbl
  1696*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1697*    THE LAST MONTH END RUN.
  1698******************************************************************
  1699
  1700     12  CO-LAST-ACTIVITY-DATE.
  1701         16  CO-ACT-YEAR                       PIC 99.
  1702         16  CO-ACT-MONTH                      PIC 99.
  1703         16  CO-ACT-DAY                        PIC 99.
  1704
  1705     12  CO-LAST-STMT-DT.
  1706         16  CO-LAST-STMT-YEAR                 PIC 99.
  1707         16  CO-LAST-STMT-MONTH                PIC 99.
  1708         16  CO-LAST-STMT-DAY                  PIC 99.
  1709
  1710     12  CO-MO-END-TOTALS.
  1711         16  CO-MONTHLY-TOTALS.
  1712             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1713             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1714             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1715             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1716             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1717
  1718         16  CO-AGING-TOTALS.
  1719             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1720             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1721             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1722             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1723
  1724         16  CO-YTD-TOTALS.
  1725             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1726             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1727
  1728         16  CO-OVER-UNDER-TOTALS.
  1729             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1730             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1731
  1732     12  CO-MISCELLANEOUS-TOTALS.
  1733         16  CO-FICA-TOTALS.
  1734             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1735             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1736
  1737         16  CO-CLAIM-TOTALS.
  1738             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1739             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1740
  1741******************************************************************
  1742*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1743*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1744******************************************************************
  1745
  1746     12  CO-CURRENT-TOTALS.
  1747         16  CO-CURRENT-LAST-STMT-DT.
  1748             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1749             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1750             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1751
  1752         16  CO-CURRENT-MONTHLY-TOTALS.
  1753             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  32
* PYRPTBL.cbl
  1754             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1755             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1756             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1757             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1758
  1759         16  CO-CURRENT-AGING-TOTALS.
  1760             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1761             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1762             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1763             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1764
  1765         16  CO-CURRENT-YTD-TOTALS.
  1766             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1767             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1768
  1769     12  CO-PAID-COMM-TOTALS.
  1770         16  CO-YTD-PAID-COMMS.
  1771             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1772             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1773
  1774     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1775         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1776         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1777
  1778     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1779         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1780         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1781         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1782         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1783         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1784         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1785         88  CO-FINAL-LETTER                  VALUE 'F'.
  1786         88  CO-RECONCILING                   VALUE 'R'.
  1787         88  CO-PHONE-CALL                    VALUE 'P'.
  1788         88  CO-LEGAL                         VALUE 'L'.
  1789         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1790         88  CO-WRITE-OFF                     VALUE 'W'.
  1791         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1792
  1793     12  CO-CSR-CODE                       PIC X(4).
  1794
  1795     12  CO-GA-STATUS-INFO.
  1796         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1797         16  CO-GA-TERMINATION-DT          PIC XX.
  1798         16  CO-GA-STATUS-CODE             PIC X.
  1799             88  CO-GA-ACTIVE                 VALUE 'A'.
  1800             88  CO-GA-INACTIVE               VALUE 'I'.
  1801             88  CO-GA-PENDING                VALUE 'P'.
  1802         16  CO-GA-COMMENTS.
  1803             20  CO-GA-COMMENT-1           PIC X(40).
  1804             20  CO-GA-COMMENT-2           PIC X(40).
  1805             20  CO-GA-COMMENT-3           PIC X(40).
  1806             20  CO-GA-COMMENT-4           PIC X(40).
  1807
  1808     12  CO-RPTCD2                         PIC X(10).
  1809     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1810         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1811         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  33
* PYRPTBL.cbl
  1812
  1813     12  CO-TYPE-AGENT                     PIC X(01).
  1814         88  CO-CORPORATION                   VALUE 'C'.
  1815         88  CO-PARTNERSHIP                   VALUE 'P'.
  1816         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1817         88  CO-TRUST                         VALUE 'T'.
  1818         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1819
  1820     12  CO-FAXNO.
  1821         16  CO-FAX-AREA-CODE                  PIC XXX.
  1822         16  CO-FAX-PREFIX                     PIC XXX.
  1823         16  CO-FAX-PHONE                      PIC X(4).
  1824
  1825     12  CO-BANK-INFORMATION.
  1826         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1827         16  CO-BANK-TRANSIT-NON REDEFINES
  1828             CO-BANK-TRANSIT-NO                PIC 9(8).
  1829
  1830         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1831     12  CO-MISC-DEDUCT-INFO REDEFINES
  1832                  CO-BANK-INFORMATION.
  1833         16  CO-MD-GL-ACCT                     PIC X(10).
  1834         16  CO-MD-DIV                         PIC XX.
  1835         16  CO-MD-CENTER                      PIC X(4).
  1836         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1837         16  CO-CREATE-AP-CHECK                PIC X.
  1838         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1839         16  FILLER                            PIC XXX.
  1840     12  CO-ACH-STATUS                         PIC X.
  1841         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1842         88  CO-ACH-PENDING                        VALUE 'P'.
  1843
  1844     12  CO-BILL-SW                            PIC X.
  1845     12  CO-CONTROL-NAME                       PIC X(30).
  1846     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1847     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1848     12  CO-CLP-STATE                          PIC XX.
  1849     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1850     12  CO-SPP-REFUND-EDIT                    PIC X.
  1851
  1852******************************************************************
  1853 01  FILLER                      PIC X(500)  VALUE SPACES.
  1854****************************************************************
  1855*
  1856* Copyright (c) 2007 by Clerity Solutions, Inc.
  1857* All rights reserved.
  1858*
  1859****************************************************************
  1860 01  DFHEIV.
  1861   02  DFHEIV0               PIC X(35).
  1862   02  DFHEIV1               PIC X(08).
  1863   02  DFHEIV2               PIC X(08).
  1864   02  DFHEIV3               PIC X(08).
  1865   02  DFHEIV4               PIC X(06).
  1866   02  DFHEIV5               PIC X(04).
  1867   02  DFHEIV6               PIC X(04).
  1868   02  DFHEIV7               PIC X(02).
  1869   02  DFHEIV8               PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  34
* PYRPTBL.cbl
  1870   02  DFHEIV9               PIC X(01).
  1871   02  DFHEIV10              PIC S9(7) COMP-3.
  1872   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1873   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1874   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1875   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1876   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1877   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1878   02  DFHEIV17              PIC X(04).
  1879   02  DFHEIV18              PIC X(04).
  1880   02  DFHEIV19              PIC X(04).
  1881   02  DFHEIV20              USAGE IS POINTER.
  1882   02  DFHEIV21              USAGE IS POINTER.
  1883   02  DFHEIV22              USAGE IS POINTER.
  1884   02  DFHEIV23              USAGE IS POINTER.
  1885   02  DFHEIV24              USAGE IS POINTER.
  1886   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1887   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1888   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1889   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1890   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1891   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1892   02  FILLER                PIC X(02).
  1893   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1894   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1895   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1896   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1897   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1898 LINKAGE  SECTION.
  1899*****************************************************************
  1900*                                                               *
  1901* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1902* All rights reserved.                                          *
  1903*                                                               *
  1904*****************************************************************
  1905 01  dfheiblk.
  1906     02  eibtime          pic s9(7) comp-3.
  1907     02  eibdate          pic s9(7) comp-3.
  1908     02  eibtrnid         pic x(4).
  1909     02  eibtaskn         pic s9(7) comp-3.
  1910     02  eibtrmid         pic x(4).
  1911     02  dfheigdi         pic s9(4) comp.
  1912     02  eibcposn         pic s9(4) comp.
  1913     02  eibcalen         pic s9(4) comp.
  1914     02  eibaid           pic x(1).
  1915     02  eibfiller1       pic x(1).
  1916     02  eibfn            pic x(2).
  1917     02  eibfiller2       pic x(2).
  1918     02  eibrcode         pic x(6).
  1919     02  eibfiller3       pic x(2).
  1920     02  eibds            pic x(8).
  1921     02  eibreqid         pic x(8).
  1922     02  eibrsrce         pic x(8).
  1923     02  eibsync          pic x(1).
  1924     02  eibfree          pic x(1).
  1925     02  eibrecv          pic x(1).
  1926     02  eibsend          pic x(1).
  1927     02  eibatt           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  35
* PYRPTBL.cbl
  1928     02  eibeoc           pic x(1).
  1929     02  eibfmh           pic x(1).
  1930     02  eibcompl         pic x(1).
  1931     02  eibsig           pic x(1).
  1932     02  eibconf          pic x(1).
  1933     02  eiberr           pic x(1).
  1934     02  eibrldbk         pic x(1).
  1935     02  eiberrcd         pic x(4).
  1936     02  eibsynrb         pic x(1).
  1937     02  eibnodat         pic x(1).
  1938     02  eibfiller5       pic x(2).
  1939     02  eibresp          pic 9(09) comp.
  1940     02  eibresp2         pic 9(09) comp.
  1941     02  dfheigdj         pic s9(4) comp.
  1942     02  dfheigdk         pic s9(4) comp.
  1943 01 dfhcommarea.
  1944  02  BL-COMMAREA.
  1945     03  BL-OUTPUT OCCURS 200.
  1946         05  BL-CARRIER          PIC X.
  1947         05  BL-STATE            PIC XX.
  1948         05  BL-FIN-RESP         PIC X(10).
  1949         05  BL-ACCOUNT          PIC X(10).
  1950         05  BL-ACCT-NAME        PIC X(33).
  1951         05  BL-NET-AMT          PIC 9(7)V99.
  1952         05  BL-TYPE             PIC X.
  1953         05  BL-GL-ACCT          PIC X(10).
  1954         05  BL-RETURN-CODE REDEFINES BL-GL-ACCT
  1955                                 PIC 9(10).
  1956         05  BL-COMMENT          PIC X(13).
  1957         05  BL-MAINT-DT         PIC X(10).
  1958     03  BL-COUNT                PIC 999.
  1959     03  BL-STATUS.
  1960         88  BL-OK                          VALUE "P".
  1961         88  BL-FAIL                      VALUE "F".
  1962         05  BL-MESSAGE          PIC X(50).
  1963 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1964 0000-DFHEXIT SECTION.
  1965     MOVE '9#                    $   ' TO DFHEIV0.
  1966     MOVE 'PYRPTBL' TO DFHEIV1.
  1967     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1968     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1969     MOVE '5'                    TO DC-OPTION-CODE
  1970     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  1971     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  1972     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  1973     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  1974     MOVE -7                     TO DC-ELAPSED-DAYS
  1975     MOVE +0                     TO DC-ELAPSED-MONTHS
  1976     MOVE '6'                    TO DC-OPTION-CODE
  1977     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  1978     IF NO-CONVERSION-ERROR
  1979        MOVE DC-BIN-DATE-2       TO WS-TODAY-MINUS-7
  1980     ELSE
  1981        DISPLAY ' ERROR CONVERTING DATE '
  1982     END-IF
  1983     PERFORM 0000-GET-STARTED    THRU 0000-EXIT
  1984     PERFORM 0050-PROCESS-INPUT  THRU 0050-EXIT UNTIL
  1985        (END-OF-INPUT)
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  36
* PYRPTBL.cbl
  1986        OR (R1 > 195)
  1987     MOVE ZEROS TO WS-RESPONSE
  1988     PERFORM 0100-PROCESS-INPUT  THRU 0100-EXIT
  1989     MOVE R1                     TO BL-COUNT
  1990     IF R1 = ZEROS
  1991        MOVE 1                   TO BL-COUNT
  1992        MOVE ' ALL IS WELL IN PAYMENT AND ADJUSTMENT LAND '
  1993                                 TO BL-MESSAGE
  1994     END-IF
  1995
  1996* exec cics return end-exec.
  1997*    MOVE '.(                    ''   #00001991' TO DFHEIV0
  1998     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1999     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2000     MOVE X'2020233030303031393931' TO DFHEIV0(25:11)
  2001     CALL 'kxdfhei1' USING DFHEIV0,
  2002           DFHEIV99,
  2003           DFHEIV99,
  2004           DFHEIV99,
  2005           DFHEIV99,
  2006           DFHEIV99,
  2007           DFHEIV99
  2008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2009
  2010     .
  2011 0000-GET-STARTED.
  2012     MOVE X'04'                  TO WS-ERPYAJ-KEY
  2013
  2014* EXEC CICS STARTBR
  2015*        DATASET   ('ERPYAJ')
  2016*        RIDFLD    (WS-ERPYAJ-KEY)
  2017*        GTEQ
  2018*        RESP      (WS-RESPONSE)
  2019*    END-EXEC
  2020     MOVE 'ERPYAJ' TO DFHEIV1
  2021     MOVE 0
  2022       TO DFHEIV11
  2023*    MOVE '&,         G          &  N#00001995' TO DFHEIV0
  2024     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2025     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2026     MOVE X'204E233030303031393935' TO DFHEIV0(25:11)
  2027     CALL 'kxdfhei1' USING DFHEIV0,
  2028           DFHEIV1,
  2029           WS-ERPYAJ-KEY,
  2030           DFHEIV99,
  2031           DFHEIV11,
  2032           DFHEIV99
  2033     MOVE EIBRESP  TO WS-RESPONSE
  2034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2035     IF NOT RESP-NORMAL
  2036        MOVE 1                   TO R1
  2037        MOVE ALL '?'             TO BL-OUTPUT (R1)
  2038        MOVE ' BAD STARTBR ON ERPYAJ ' TO BL-MESSAGE
  2039        MOVE WS-RESPONSE         TO BL-RETURN-CODE (R1)
  2040        DISPLAY BL-MESSAGE ' ' WS-RESPONSE
  2041        SET END-OF-INPUT         TO TRUE
  2042        GO TO 0000-EXIT
  2043     END-IF
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  37
* PYRPTBL.cbl
  2044     PERFORM 0110-READNEXT-ERPYAJ THRU 0110-EXIT
  2045     IF RESP-NORMAL
  2046        PERFORM 0120-MOVE-SAVE   THRU 0120-EXIT
  2047        MOVE PY-CONTROL-PRIMARY (1:28)
  2048                                 TO WS-PREV-PYAJ-KEY
  2049        PERFORM 0110-READNEXT-ERPYAJ
  2050                                 THRU 0110-EXIT
  2051     ELSE
  2052        IF RESP-NOTFND
  2053           OR RESP-ENDFILE
  2054           MOVE ' NOTHING ON FILE ' TO BL-MESSAGE
  2055           MOVE WS-RESPONSE TO BL-RETURN-CODE (R1)
  2056           DISPLAY BL-MESSAGE ' ' WS-RESPONSE
  2057           SET END-OF-INPUT TO TRUE
  2058           GO TO 0000-EXIT
  2059        ELSE
  2060           MOVE 'BAD READNEXT ON ERPYAJ ' TO BL-MESSAGE
  2061           MOVE WS-RESPONSE TO BL-RETURN-CODE (R1)
  2062           DISPLAY BL-MESSAGE ' ' WS-RESPONSE
  2063           SET END-OF-INPUT TO TRUE
  2064           GO TO 0000-EXIT
  2065        END-IF
  2066     END-IF
  2067     .
  2068 0000-EXIT.
  2069     EXIT.
  2070 0050-PROCESS-INPUT.
  2071     IF (PY-ACCOUNT NOT = LOW-VALUES)
  2072        AND (PY-RECORD-TYPE = 'R' OR 'C')
  2073        AND (PY-COMPANY-CD = X'04')
  2074        PERFORM 0100-PROCESS-INPUT THRU 0100-EXIT
  2075     END-IF
  2076     PERFORM 0110-READNEXT-ERPYAJ THRU 0110-EXIT
  2077     .
  2078 0050-EXIT.
  2079     EXIT.
  2080 0100-PROCESS-INPUT.
  2081     IF RESP-NORMAL
  2082        IF WS-PREV-PYAJ-KEY = PY-CONTROL-PRIMARY (1:28)
  2083           PERFORM 0120-MOVE-SAVE THRU 0120-EXIT
  2084           GO TO 0100-EXIT
  2085        END-IF
  2086     ELSE
  2087        GO TO 0100-EXIT
  2088     END-IF
  2089     IF (WS-SAVE-AMT NOT = ZEROS)
  2090        AND (WS-SAVE-MAINT-DT < WS-TODAY-MINUS-7)
  2091        MOVE WS-PREV-PYAJ-KEY    TO WS-ERCOMP-KEY
  2092        MOVE 'A'              TO WS-ERCOMP-TYPE
  2093
  2094* EXEC CICS READ
  2095*          INTO    (COMPENSATION-MASTER)
  2096*          DATASET ('ERCOMP')
  2097*          RIDFLD  (WS-ERCOMP-KEY)
  2098*          RESP    (WS-RESPONSE)
  2099*       END-EXEC
  2100     MOVE LENGTH OF
  2101      COMPENSATION-MASTER
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  38
* PYRPTBL.cbl
  2102       TO DFHEIV11
  2103     MOVE 'ERCOMP' TO DFHEIV1
  2104*    MOVE '&"IL       E          (  N#00002059' TO DFHEIV0
  2105     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2106     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2107     MOVE X'204E233030303032303539' TO DFHEIV0(25:11)
  2108     CALL 'kxdfhei1' USING DFHEIV0,
  2109           DFHEIV1,
  2110           COMPENSATION-MASTER,
  2111           DFHEIV11,
  2112           WS-ERCOMP-KEY,
  2113           DFHEIV99,
  2114           DFHEIV99,
  2115           DFHEIV99
  2116     MOVE EIBRESP  TO WS-RESPONSE
  2117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2118        IF RESP-NORMAL
  2119           IF ZEROS = CO-BAL-FWD AND CO-CUR-COM AND CO-CUR-CHG
  2120              AND CO-CUR-PMT AND CO-END-BAL
  2121              CONTINUE
  2122           ELSE
  2123              MOVE +0            TO WS-SAVE-AMT
  2124              MOVE LOW-VALUES    TO WS-SAVE-MAINT-DT
  2125              PERFORM 0120-MOVE-SAVE THRU 0120-EXIT
  2126              GO TO 0100-EXIT
  2127           END-IF
  2128        ELSE
  2129           MOVE +0            TO WS-SAVE-AMT
  2130           MOVE LOW-VALUES    TO WS-SAVE-MAINT-DT
  2131           PERFORM 0120-MOVE-SAVE THRU 0120-EXIT
  2132           GO TO 0100-EXIT
  2133        END-IF
  2134     ELSE
  2135        MOVE +0            TO WS-SAVE-AMT
  2136        MOVE LOW-VALUES    TO WS-SAVE-MAINT-DT
  2137        PERFORM 0120-MOVE-SAVE THRU 0120-EXIT
  2138        GO TO 0100-EXIT
  2139     END-IF
  2140     PERFORM 0130-FIND-ERACCT    THRU 0130-EXIT
  2141     IF ACCT-FOUND
  2142        PERFORM 0140-PROCESS-ERPNDB2
  2143                                 THRU 0140-EXIT
  2144     ELSE
  2145        PERFORM 0120-MOVE-SAVE THRU 0120-EXIT
  2146        GO TO 0100-EXIT
  2147     END-IF
  2148     IF PNDB-FOUND
  2149        MOVE +0            TO WS-SAVE-AMT
  2150        MOVE LOW-VALUES    TO WS-SAVE-MAINT-DT
  2151        PERFORM 0120-MOVE-SAVE THRU 0120-EXIT
  2152        GO TO 0100-EXIT
  2153     END-IF
  2154     ADD +1 TO R1
  2155     MOVE WS-SAVE-CARRIER        TO BL-CARRIER (R1)
  2156     MOVE WS-SAVE-STATE          TO BL-STATE (R1)
  2157     MOVE WS-SAVE-RESP-NO        TO BL-FIN-RESP (R1)
  2158     MOVE WS-SAVE-ACCOUNT        TO BL-ACCOUNT (R1)
  2159     MOVE AM-NAME                TO BL-ACCT-NAME (R1)
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  39
* PYRPTBL.cbl
  2160     MOVE WS-SAVE-AMT            TO BL-NET-AMT   (R1)
  2161     MOVE WS-SAVE-TYPE           TO BL-TYPE      (R1)
  2162     MOVE WS-SAVE-GL-ACCT        TO BL-GL-ACCT   (R1)
  2163     MOVE WS-SAVE-COMMENT        TO BL-COMMENT   (R1)
  2164     MOVE WS-SAVE-MAINT-DT       TO DC-BIN-DATE-1
  2165     MOVE ' '                    TO DC-OPTION-CODE
  2166     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  2167     IF NO-CONVERSION-ERROR
  2168        MOVE DC-GREG-DATE-A-EDIT TO BL-MAINT-DT (R1)
  2169     ELSE
  2170        MOVE '01/01/1900'        TO BL-MAINT-DT (R1)
  2171     END-IF
  2172     MOVE +0            TO WS-SAVE-AMT
  2173     MOVE LOW-VALUES    TO WS-SAVE-MAINT-DT
  2174     PERFORM 0120-MOVE-SAVE THRU 0120-EXIT
  2175     PERFORM 0500-SCRUB-DATA     THRU 0500-EXIT
  2176     .
  2177 0100-EXIT.
  2178     EXIT.
  2179 0110-READNEXT-ERPYAJ.
  2180
  2181* EXEC CICS READNEXT
  2182*       INTO    (PENDING-PAY-ADJ)
  2183*       DATASET ('ERPYAJ')
  2184*       RIDFLD  (WS-ERPYAJ-KEY)
  2185*       RESP    (WS-RESPONSE)
  2186*    END-EXEC
  2187     MOVE LENGTH OF
  2188      PENDING-PAY-ADJ
  2189       TO DFHEIV12
  2190     MOVE 'ERPYAJ' TO DFHEIV1
  2191     MOVE 0
  2192       TO DFHEIV11
  2193*    MOVE '&.IL                  )  N#00002127' TO DFHEIV0
  2194     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2195     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2196     MOVE X'204E233030303032313237' TO DFHEIV0(25:11)
  2197     CALL 'kxdfhei1' USING DFHEIV0,
  2198           DFHEIV1,
  2199           PENDING-PAY-ADJ,
  2200           DFHEIV12,
  2201           WS-ERPYAJ-KEY,
  2202           DFHEIV99,
  2203           DFHEIV11,
  2204           DFHEIV99,
  2205           DFHEIV99
  2206     MOVE EIBRESP  TO WS-RESPONSE
  2207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2208     IF NOT RESP-NORMAL
  2209        SET END-OF-INPUT         TO TRUE
  2210     END-IF
  2211     .
  2212 0110-EXIT.
  2213     EXIT.
  2214 0120-MOVE-SAVE.
  2215     MOVE PY-CARRIER             TO WS-SAVE-CARRIER
  2216     MOVE PY-GROUPING            TO WS-SAVE-GROUPING
  2217     MOVE PY-FIN-RESP            TO WS-SAVE-RESP-NO
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  40
* PYRPTBL.cbl
  2218     MOVE PY-ACCOUNT             TO WS-SAVE-ACCOUNT
  2219     IF PY-RECORD-TYPE = 'R'
  2220        ADD PY-ENTRY-AMT   TO WS-SAVE-AMT
  2221     ELSE
  2222        SUBTRACT PY-ENTRY-AMT FROM WS-SAVE-AMT
  2223     END-IF
  2224     MOVE PY-RECORD-TYPE         TO WS-SAVE-TYPE
  2225     MOVE PY-GL-ACCOUNT TO WS-SAVE-GL-ACCT
  2226     MOVE PY-GL-COMMENT TO WS-SAVE-COMMENT
  2227     IF PY-LAST-MAINT-DT > WS-SAVE-MAINT-DT
  2228        MOVE PY-LAST-MAINT-DT TO WS-SAVE-MAINT-DT
  2229     END-IF
  2230     MOVE PY-CONTROL-PRIMARY (1:28)
  2231                                 TO WS-PREV-PYAJ-KEY
  2232     .
  2233 0120-EXIT.
  2234     EXIT.
  2235 0130-FIND-ERACCT.
  2236     MOVE ' '                    TO WS-ACCT-SW
  2237     MOVE +0                     TO WS-READ-TRYS
  2238                                    WS-START-TRYS
  2239     MOVE CO-COMPANY-CD          TO WS-ERACCT-KEY
  2240     MOVE CO-CARRIER             TO WS-ERACCT-CARRIER
  2241     MOVE CO-GROUPING            TO WS-ERACCT-GROUP
  2242     MOVE CO-ADDR-STATE          TO WS-ERACCT-STATE
  2243                                    WS-SAVE-STATE
  2244     MOVE CO-ACCOUNT             TO WS-ERACCT-ACCOUNT
  2245     MOVE LOW-VALUES             TO WS-ERACCT-EXP-DT
  2246     .
  2247 0130-STARTBR.
  2248     ADD +1                      TO WS-START-TRYS
  2249
  2250* EXEC CICS STARTBR
  2251*        DATASET   ('ERACCT')
  2252*        RIDFLD    (WS-ERACCT-KEY)
  2253*        GTEQ
  2254*        RESP      (WS-RESPONSE)
  2255*    END-EXEC
  2256     MOVE 'ERACCT' TO DFHEIV1
  2257     MOVE 0
  2258       TO DFHEIV11
  2259*    MOVE '&,         G          &  N#00002174' TO DFHEIV0
  2260     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2261     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2262     MOVE X'204E233030303032313734' TO DFHEIV0(25:11)
  2263     CALL 'kxdfhei1' USING DFHEIV0,
  2264           DFHEIV1,
  2265           WS-ERACCT-KEY,
  2266           DFHEIV99,
  2267           DFHEIV11,
  2268           DFHEIV99
  2269     MOVE EIBRESP  TO WS-RESPONSE
  2270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2271     IF (RESP-ENDFILE OR RESP-NOTFND)
  2272        PERFORM VARYING A1 FROM +30 BY -1 UNTIL
  2273           (CO-ACCT-NAME (A1:1) = '*')
  2274           OR  (A1 < +1)
  2275        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  41
* PYRPTBL.cbl
  2276        IF (A1 > +1 AND < +29)
  2277           AND (WS-START-TRYS < +2)
  2278           MOVE CO-ACCT-NAME (A1 + 1 :2)
  2279                                 TO WS-ERACCT-STATE
  2280                                    WS-SAVE-STATE
  2281           GO TO 0130-STARTBR
  2282        ELSE
  2283           SET ACCT-NOT-FOUND    TO TRUE
  2284           GO TO 0130-EXIT
  2285        END-IF
  2286     ELSE
  2287        IF NOT RESP-NORMAL
  2288           SET ACCT-NOT-FOUND    TO TRUE
  2289           GO TO 0130-EXIT
  2290        END-IF
  2291     END-IF
  2292     .
  2293 0130-READ-NEXT.
  2294     ADD +1                      TO WS-READ-TRYS
  2295
  2296* EXEC CICS READNEXT
  2297*       INTO    (ACCOUNT-MASTER)
  2298*       DATASET ('ERACCT')
  2299*       RIDFLD  (WS-ERACCT-KEY)
  2300*       RESP    (WS-RESPONSE)
  2301*    END-EXEC
  2302     MOVE LENGTH OF
  2303      ACCOUNT-MASTER
  2304       TO DFHEIV12
  2305     MOVE 'ERACCT' TO DFHEIV1
  2306     MOVE 0
  2307       TO DFHEIV11
  2308*    MOVE '&.IL                  )  N#00002204' TO DFHEIV0
  2309     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2310     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2311     MOVE X'204E233030303032323034' TO DFHEIV0(25:11)
  2312     CALL 'kxdfhei1' USING DFHEIV0,
  2313           DFHEIV1,
  2314           ACCOUNT-MASTER,
  2315           DFHEIV12,
  2316           WS-ERACCT-KEY,
  2317           DFHEIV99,
  2318           DFHEIV11,
  2319           DFHEIV99,
  2320           DFHEIV99
  2321     MOVE EIBRESP  TO WS-RESPONSE
  2322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2323     IF RESP-NORMAL
  2324        AND AM-CARRIER = CO-CARRIER
  2325        AND AM-GROUPING = CO-GROUPING
  2326        AND AM-STATE = WS-SAVE-STATE
  2327        AND AM-ACCOUNT = CO-ACCOUNT
  2328        SET ACCT-FOUND           TO TRUE
  2329     ELSE
  2330        IF RESP-ENDFILE OR RESP-NOTFND
  2331           PERFORM VARYING A1 FROM +30 BY -1 UNTIL
  2332              (CO-ACCT-NAME (A1:1) = '*')
  2333              OR  (A1 < +1)
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  42
* PYRPTBL.cbl
  2334           END-PERFORM
  2335           IF (A1 > +1 AND < +29)
  2336              AND (WS-READ-TRYS < +2)
  2337              MOVE CO-ACCT-NAME (A1 + 1 :2)
  2338                                    TO WS-ERACCT-STATE
  2339                                       WS-SAVE-STATE
  2340              GO TO 0130-READ-NEXT
  2341           ELSE
  2342              SET ACCT-NOT-FOUND    TO TRUE
  2343              GO TO 0130-ENDBR
  2344           END-IF
  2345        ELSE
  2346           SET ACCT-NOT-FOUND    TO TRUE
  2347           GO TO 0130-ENDBR
  2348        END-IF
  2349     END-IF
  2350     .
  2351 0130-ENDBR.
  2352
  2353* EXEC CICS ENDBR
  2354*        DATASET   ('ERACCT')
  2355*        RESP      (WS-RESPONSE)
  2356*    END-EXEC
  2357     MOVE 'ERACCT' TO DFHEIV1
  2358     MOVE 0
  2359       TO DFHEIV11
  2360*    MOVE '&2                    $  N#00002239' TO DFHEIV0
  2361     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2362     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2363     MOVE X'204E233030303032323339' TO DFHEIV0(25:11)
  2364     CALL 'kxdfhei1' USING DFHEIV0,
  2365           DFHEIV1,
  2366           DFHEIV11,
  2367           DFHEIV99
  2368     MOVE EIBRESP  TO WS-RESPONSE
  2369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2370     .
  2371 0130-EXIT.
  2372     EXIT.
  2373 0140-PROCESS-ERPNDB2.
  2374     MOVE ' '                    TO WS-SB-SW
  2375     MOVE ' '                    TO WS-PNDB-SW
  2376     MOVE LOW-VALUES             TO WS-ERPNDB2-KEY
  2377     MOVE +0                     TO WS-ERPNDB2-CHG-SEQ
  2378     MOVE AM-CONTROL-PRIMARY (1:20)
  2379                                 TO WS-ERPNDB2-KEY (1:20)
  2380
  2381* EXEC CICS STARTBR
  2382*        DATASET   ('ERPNDB2')
  2383*        RIDFLD    (WS-ERPNDB2-KEY)
  2384*        RESP      (WS-RESPONSE)
  2385*    END-EXEC
  2386     MOVE 'ERPNDB2' TO DFHEIV1
  2387     MOVE 0
  2388       TO DFHEIV11
  2389*    MOVE '&,         G          &  N#00002253' TO DFHEIV0
  2390     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2391     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  43
* PYRPTBL.cbl
  2392     MOVE X'204E233030303032323533' TO DFHEIV0(25:11)
  2393     CALL 'kxdfhei1' USING DFHEIV0,
  2394           DFHEIV1,
  2395           WS-ERPNDB2-KEY,
  2396           DFHEIV99,
  2397           DFHEIV11,
  2398           DFHEIV99
  2399     MOVE EIBRESP  TO WS-RESPONSE
  2400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2401     .
  2402 0140-READNEXT.
  2403     IF RESP-NORMAL
  2404        SET PNDB-STARTBR         TO TRUE
  2405
  2406* EXEC CICS READNEXT
  2407*          INTO    (PENDING-BUSINESS)
  2408*          DATASET ('ERPNDB2')
  2409*          RIDFLD  (WS-ERPNDB2-KEY)
  2410*          RESP    (WS-RESPONSE)
  2411*       END-EXEC
  2412     MOVE LENGTH OF
  2413      PENDING-BUSINESS
  2414       TO DFHEIV12
  2415     MOVE 'ERPNDB2' TO DFHEIV1
  2416     MOVE 0
  2417       TO DFHEIV11
  2418*    MOVE '&.IL                  )  N#00002262' TO DFHEIV0
  2419     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2420     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2421     MOVE X'204E233030303032323632' TO DFHEIV0(25:11)
  2422     CALL 'kxdfhei1' USING DFHEIV0,
  2423           DFHEIV1,
  2424           PENDING-BUSINESS,
  2425           DFHEIV12,
  2426           WS-ERPNDB2-KEY,
  2427           DFHEIV99,
  2428           DFHEIV11,
  2429           DFHEIV99,
  2430           DFHEIV99
  2431     MOVE EIBRESP  TO WS-RESPONSE
  2432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2433        IF RESP-NORMAL
  2434           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  2435                AM-CONTROL-PRIMARY (1:20))
  2436           IF (PB-RECORD-TYPE = '1' OR '2')
  2437              SET PNDB-FOUND     TO TRUE
  2438           ELSE
  2439              GO TO 0140-READNEXT
  2440           END-IF
  2441        ELSE
  2442           SET PNDB-NOT-FOUND    TO TRUE
  2443        END-IF
  2444     ELSE
  2445        SET PNDB-NOT-FOUND       TO TRUE
  2446     END-IF
  2447     IF PNDB-STARTBR
  2448
  2449* EXEC CICS ENDBR
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  44
* PYRPTBL.cbl
  2450*          DATASET  ('ERPNDB2')
  2451*       END-EXEC
  2452     MOVE 'ERPNDB2' TO DFHEIV1
  2453     MOVE 0
  2454       TO DFHEIV11
  2455*    MOVE '&2                    $   #00002283' TO DFHEIV0
  2456     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2457     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2458     MOVE X'2020233030303032323833' TO DFHEIV0(25:11)
  2459     CALL 'kxdfhei1' USING DFHEIV0,
  2460           DFHEIV1,
  2461           DFHEIV11,
  2462           DFHEIV99
  2463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2464     END-IF
  2465     .
  2466 0140-EXIT.
  2467     EXIT.
  2468 0500-SCRUB-DATA.
  2469*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  2470*   A DIFFERENT DELIMITER IN PROGRAM NSREQLTR BUT
  2471*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  2472*   TO A HEX 26 TO GET BY THE DECODER
  2473     MOVE FUNCTION LENGTH(BL-ACCT-NAME (R1))
  2474                                 TO M1
  2475     MOVE SPACES                 TO WS-WORK-FIELD
  2476     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  2477        A1 > M1
  2478        OR BL-ACCT-NAME (R1) (A1:1) = '&'
  2479     END-PERFORM
  2480     IF A1 > M1
  2481        CONTINUE
  2482     ELSE
  2483        MOVE BL-ACCT-NAME (R1) (1:A1 - 1)
  2484                                 TO WS-WORK-FIELD (1:A1 - 1)
  2485        MOVE '%26'               TO WS-WORK-FIELD (A1:3)
  2486        MOVE BL-ACCT-NAME (R1) (A1 + 1:M1 - A1)
  2487                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  2488        MOVE WS-WORK-FIELD       TO BL-ACCT-NAME (R1)
  2489     END-IF
  2490     MOVE FUNCTION LENGTH(BL-COMMENT (R1))
  2491                                 TO M1
  2492     MOVE SPACES                 TO WS-WORK-FIELD
  2493     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  2494        A1 > M1
  2495        OR BL-COMMENT (R1) (A1:1) = '&'
  2496     END-PERFORM
  2497     IF A1 > M1
  2498        CONTINUE
  2499     ELSE
  2500        MOVE BL-COMMENT (R1) (1:A1 - 1)
  2501                                 TO WS-WORK-FIELD (1:A1 - 1)
  2502        MOVE '%26'               TO WS-WORK-FIELD (A1:3)
  2503        MOVE BL-COMMENT (R1) (A1 + 1:M1 - A1)
  2504                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  2505        MOVE WS-WORK-FIELD       TO BL-COMMENT (R1)
  2506     END-IF
  2507     .
* Micro Focus Server Express         V5.1 revision 000 13-Nov-12 08:33 Page  45
* PYRPTBL.cbl
  2508 0500-EXIT.
  2509     EXIT.
  2510 9700-DATE-LINK.
  2511
  2512* EXEC CICS LINK
  2513*        PROGRAM   ('ELDATCV')
  2514*        COMMAREA  (DATE-CONVERSION-DATA)
  2515*        LENGTH    (DC-COMM-LENGTH)
  2516*    END-EXEC.
  2517     MOVE 'ELDATCV' TO DFHEIV1
  2518*    MOVE '."C                   (   #00002333' TO DFHEIV0
  2519     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2520     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2521     MOVE X'2020233030303032333333' TO DFHEIV0(25:11)
  2522     CALL 'kxdfhei1' USING DFHEIV0,
  2523           DFHEIV1,
  2524           DATE-CONVERSION-DATA,
  2525           DC-COMM-LENGTH,
  2526           DFHEIV99,
  2527           DFHEIV99,
  2528           DFHEIV99,
  2529           DFHEIV99
  2530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2531
  2532 9700-EXIT.
  2533      EXIT.
  2534
  2535 9999-DFHBACK SECTION.
  2536     MOVE '9%                    "   ' TO DFHEIV0
  2537     MOVE 'PYRPTBL' TO DFHEIV1
  2538     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2539     GOBACK.
  2540 9999-DFHEXIT.
  2541     IF DFHEIGDJ EQUAL 0001
  2542         NEXT SENTENCE.
  2543     MOVE '9%                    "   ' TO DFHEIV0
  2544     MOVE 'PYRPTBL' TO DFHEIV1
  2545     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2546     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5772     Code:        4251
