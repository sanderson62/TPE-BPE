* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page   1
* ELVADS.cbl
* Options: int("ELVADS.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELVADS.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELVADS.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELVADS.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 ELVADS.
     3*AUTHOR.  PABLO.
     4*         OMAHA, NEBRASKA.
     5*SECURITY.   *****************************************************
     6*            *                                                   *
     7*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
     8*            *   HEALTH AND LIFE CO. OF OMAHA                    *
     9*            *                                                   *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    12*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page   2
* ELVADS.cbl
    14*            *****************************************************
    15*REMARKS. TRANSACTION VADS - VA DISCLOSURE PRINT TEST
    16*                        C H A N G E   L O G
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST  PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 103107    2007092500001   PEMA  NEW PROGRAM
    22* 100111    2011022800001   AJRA  NAPERSOFT
    23* 033015  IR2015032400002   PEMA  CORRECT CODE WHEN APR IS ZERO
    24******************************************************************
    25*
    26 ENVIRONMENT DIVISION.
    27 DATA DIVISION.
    28 WORKING-STORAGE SECTION.
    29 01  DFH-START PIC X(04).
    30 77  FILLER  PIC  X(32) VALUE '********************************'.
    31 77  FILLER  PIC  X(32) VALUE '*   ELVADS WORKING STORAGE     *'.
    32 77  FILLER  PIC  X(32) VALUE '********* V/M 2.001 ************'.
    33 77  VA-RATE-SW                  PIC X  VALUE ' '.
    34     88  FOUND-VA-RATE               VALUE 'F'.
    35     88  NO-VA-RATE-FOUND            VALUE 'N'.
    36 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    37 77  E1                          PIC S999 COMP-3 VALUE +0.
    38 77  ARCH-STATUS                 PIC X.
    39     88  ARCH-OK                        VALUE "P".
    40     88  ARCH-FAIL                      VALUE "F".
    41 01  WS-CALC-SWITCHES.
    42     05  WS-TYPE-OF-CERT         PIC X.
    43         88  GROSS-CERT              VALUE 'G'.
    44         88  NET-CERT                VALUE 'N'.
    45         88  LEVEL-CERT              VALUE 'L'.
    46         88  AH-ONLY                 VALUE 'A'.
    47     05  WS-CALC-LF-GROSS        PIC X.
    48         88  CALC-LF-GROSS           VALUE 'Y'.
    49     05  WS-CALC-LF-NET          PIC X.
    50         88  CALC-LF-NET             VALUE 'Y'.
    51     05  WS-CALC-LF-LEVEL        PIC X.
    52         88  CALC-LF-LEVEL           VALUE 'Y'.
    53     05  WS-CALC-AH              PIC X.
    54         88  CALC-AH                 VALUE 'Y'.
    55 01  WS-CALC-AREA.
    56     05  WS-NET-PMT-1            PIC S9(7)V99 COMP-3 VALUE +0.
    57     05  WS-NET-PMT-2            PIC S9(7)V99 COMP-3 VALUE +0.
    58     05  WS-NET-PMT-3            PIC S9(7)V99 COMP-3 VALUE +0.
    59     05  WS-NET-PMT-4            PIC S9(7)V99 COMP-3 VALUE +0.
    60     05  WS-GROSS-PMT-1          PIC S9(7)V99 COMP-3 VALUE +0.
    61     05  WS-GROSS-PMT-2          PIC S9(7)V99 COMP-3 VALUE +0.
    62     05  WS-GROSS-PMT-3          PIC S9(7)V99 COMP-3 VALUE +0.
    63     05  WS-GROSS-PMT-4          PIC S9(7)V99 COMP-3 VALUE +0.
    64     05  WS-LEVEL-PMT-1          PIC S9(7)V99 COMP-3 VALUE +0.
    65     05  WS-LEVEL-PMT-2          PIC S9(7)V99 COMP-3 VALUE +0.
    66     05  WS-LEVEL-PMT-3          PIC S9(7)V99 COMP-3 VALUE +0.
    67     05  WS-LEVEL-PMT-4          PIC S9(7)V99 COMP-3 VALUE +0.
    68     05  WS-NET-PREM-1           PIC S9(7)V99 COMP-3 VALUE +0.
    69     05  WS-NET-PREM-2           PIC S9(7)V99 COMP-3 VALUE +0.
    70     05  WS-NET-PREM-3           PIC S9(7)V99 COMP-3 VALUE +0.
    71     05  WS-NET-PREM-4           PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page   3
* ELVADS.cbl
    72     05  WS-GROSS-PREM-1         PIC S9(7)V99 COMP-3 VALUE +0.
    73     05  WS-GROSS-PREM-2         PIC S9(7)V99 COMP-3 VALUE +0.
    74     05  WS-GROSS-PREM-3         PIC S9(7)V99 COMP-3 VALUE +0.
    75     05  WS-GROSS-PREM-4         PIC S9(7)V99 COMP-3 VALUE +0.
    76     05  WS-LEVEL-PREM-1         PIC S9(7)V99 COMP-3 VALUE +0.
    77     05  WS-LEVEL-PREM-2         PIC S9(7)V99 COMP-3 VALUE +0.
    78     05  WS-LEVEL-PREM-3         PIC S9(7)V99 COMP-3 VALUE +0.
    79     05  WS-LEVEL-PREM-4         PIC S9(7)V99 COMP-3 VALUE +0.
    80     05  ANNUAL-DISCOUNT         PIC S99V999  COMP-3 VALUE +0.
    81     05  CUR-PMT                 PIC S9(7)V99 COMP-3 VALUE +0.
    82     05  AMT-FINANCED            PIC S9(9)V99 COMP-3 VALUE +0.
    83     05  PRINC-AMT               PIC S9(9)V99 COMP-3 VALUE +0.
    84     05  LFPREM                  PIC S9(7)V99 COMP-3 VALUE +0.
    85     05  AHPREM                  PIC S9(7)V99 COMP-3 VALUE +0.
    86     05  LFAMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    87     05  AHRATE                  PIC S99V9(5) COMP-3 VALUE +0.
    88     05  LF-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
    89     05  OBRATE                  PIC S99V9(5) COMP-3 VALUE +0.
    90     05  I                       PIC SV9(10)   COMP-3 VALUE +0.
    91     05  Z                       PIC S999     COMP-3 VALUE +0.
    92     05  D                       PIC S9(5)    COMP-3 VALUE +0.
    93     05  T                       PIC S9(5)    COMP-3 VALUE +0.
    94     05  DISC                    PIC SV9(9)   COMP-3 VALUE +0.
    95     05  V-M                     PIC S99V9(9) COMP-3 VALUE +0.
    96     05  VM-N                    PIC S99V9(9) COMP-3 VALUE +0.
    97     05  VM                      PIC S99V9(9) COMP-3 VALUE +0.
    98     05  V                       PIC S99V9(9) COMP-3 VALUE +0.
    99     05  X                       PIC S99V9(9) COMP-3 VALUE +0.
   100     05  Y                       PIC S99V9(9) COMP-3 VALUE +0.
   101     05  N                       PIC S999     COMP-3 VALUE +0.
   102     05  M                       PIC S999     COMP-3 VALUE +0.
   103     05  R                       PIC S9(7)V99 COMP-3 VALUE +0.
   104     05  FILLER PIC X(12) VALUE ' SP IS NEXT '.
   105     05  SP                      PIC S99V9(9) COMP-3 VALUE +0.
   106     05  ANGLEN                  PIC S9(5)V9(13) COMP-3 VALUE +0.
   107     05  ANGLENY                 PIC S999V9(9) COMP-3 VALUE +0.
   108     05  ANGLEN-LEVEL            PIC S999V9(9) COMP-3 VALUE +0.
   109     05  ANGLENY-LEVEL           PIC S999V9(9) COMP-3 VALUE +0.
   110     05  LDPN                    PIC S9(5)V99  COMP-3 VALUE +0.
   111     05  AHPN                    PIC S9(5)V99  COMP-3 VALUE +0.
   112     05  FILLER PIC X(12) VALUE ' LF IS NEXT '.
   113     05  LF                      PIC S99V9(11) COMP-3 VALUE +0.
   114     05  PPY                     PIC S999V9(7) COMP-3 VALUE +0.
   115 01  WS-HOLD-RATE-EXP.
   116     05  WS-HOLD-RATE-EXP-AL     PIC X(11).
   117     05  WS-HOLD-RATE-EXP-DT REDEFINES
   118         WS-HOLD-RATE-EXP-AL     PIC 9(11).
   119 01  ERRATE-KEY.
   120     05  RATE-COMPANY-CD         PIC X       VALUE SPACE.
   121     05  RATE-STATE-CODE.
   122         10  RATE-ST-CODE        PIC XX      VALUE SPACES.
   123         10  RATE-ST-CLASS       PIC XX      VALUE SPACES.
   124         10  RATE-ST-DEV         PIC XXX     VALUE SPACES.
   125     05  RATE-L-AH-CODE.
   126         10  RATE-L-AH           PIC X       VALUE SPACE.
   127         10  RATE-LAH-NUM        PIC XX      VALUE ZEROS.
   128     05  RATE-LIMITS.
   129         10  RATE-HIGH-AGE       PIC 99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page   4
* ELVADS.cbl
   130         10  RATE-HIGH-AMT       PIC 9(6)    VALUE ZEROS.
   131         10  RATE-FUTURE         PIC XX      VALUE SPACES.
   132         10  RATE-SEX            PIC X       VALUE '9'.
   133     05  RATE-EXPIRY-DATE        PIC 9(11)   COMP-3.
   134 01  SAVE-ERRATE-KEY.
   135     05  SVRT-COMPANY-CD         PIC X       VALUE SPACE.
   136     05  SVRT-STATE-CODE.
   137         10  SVRT-ST-CODE        PIC XX      VALUE SPACES.
   138         10  SVRT-ST-CLASS       PIC XX      VALUE SPACES.
   139         10  SVRT-ST-DEV         PIC XXX     VALUE SPACES.
   140     05  SVRT-L-AH-CODE.
   141         10  SVRT-L-AH           PIC X       VALUE SPACE.
   142         10  SVRT-LAH-NUM        PIC XX      VALUE ZEROS.
   143     05  SVRT-LIMITS.
   144         10  SVRT-HIGH-AGE       PIC 99      VALUE ZEROS.
   145         10  SVRT-HIGH-AMT       PIC 9(6)    VALUE ZEROS.
   146         10  SVRT-FUTURE         PIC XX      VALUE SPACES.
   147         10  SVRT-SEX            PIC X       VALUE '9'.
   148     05  SVRT-EXPIRY-DATE        PIC 9(11)   COMP-3.
   149*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   150*                         COPY ELCZREC.
   151******************************************************************
   152*                                                                *
   153*                                                                *
   154*                            ELCZREC.                            *
   155*                                                                *
   156*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   157*                                                                *
   158******************************************************************
   159*-----------------------------------------------------------------
   160*                   C H A N G E   L O G
   161*
   162* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   163*-----------------------------------------------------------------
   164*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   165* EFFECTIVE    NUMBER
   166*-----------------------------------------------------------------
   167* 122011    2011022800001  AJRA  NEW FILE
   168* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   169* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   170* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   171* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   172*-----------------------------------------------------------------
   173 01  W-Z-CONTROL-DATA.
   174     05  W-NUMBER-OF-COPIES      PIC  9.
   175     05  FILLER                  PIC  X.
   176     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   177     05  FILLER                  PIC  X.
   178     05  W-DAYS-TO-RESEND        PIC  999.
   179     05  FILLER                  PIC  X.
   180     05  W-FORM-TO-RESEND        PIC  X(4).
   181     05  W-ADD-BAR-CODE          PIC  X.
   182     05  W-PROMPT-LETTER         PIC  X.
   183     05  W-HAS-RETURN-ENV        PIC  X.
   184     05  W-ENCLOSURE-CD          PIC  XXX.
   185     05  W-SIG-FLAG-DEFAULT      PIC  X.
   186     05  W-AUTO-CLOSE-IND        PIC  X.
   187     05  FILLER                  PIC  X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page   5
* ELVADS.cbl
   188     05  W-LETTER-TO-BENE        PIC  X.
   189     05  FILLER                  PIC  X.
   190     05  W-LETTER-TO-ACCT        PIC  X.
   191     05  FILLER                  PIC  X.
   192     05  W-LETTER-TYPE           PIC  X.
   193     05  FILLER                  PIC  X.
   194     05  W-PRINT-CERTIFICATE     PIC  X.
   195     05  FILLER                  PIC  X.
   196     05  W-REFUND-REQUIRED       PIC  X.
   197     05  FILLER                  PIC  X.
   198     05  W-ONBASE-CODE           PIC  XX.
   199     05  FILLER                  PIC  X.
   200     05  W-ACCT-SUMM             PIC  X.
   201     05  FILLER                  PIC  X.
   202     05  W-CSO-SUMM              PIC  X.
   203     05  FILLER                  PIC  X.
   204     05  W-REASONS-REQUIRED      PIC  X.
   205     05  FILLER                  PIC  X(29).
   206
   207 01  WS-ELLETR-KEY.
   208     05  WS-ELLETR-COMPANY-CD    PIC X.
   209     05  WS-ELLETR-LETTER-ID     PIC X(12).
   210     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   211 01  WS-ELCNTL-KEY.
   212     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   213     05  WS-ELCNTL-REC-TYPE      PIC X.
   214     05  WS-ELCNTL-GENL.
   215         10  WS-ELCNTL-STATE     PIC XX  VALUE SPACES.
   216         10  WS-ELCNTL-BEN-CD.
   217             15  F               PIC X.
   218             15  WS-ELCNTL-CARR  PIC X.
   219     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   220 01  WS-ELENCC-KEY.
   221     05  WS-ELENCC-COMPANY-CD    PIC X.
   222     05  WS-ELENCC-REC-TYPE      PIC X.
   223     05  WS-ELENCC-ENC-CODE      PIC X(5).
   224     05  F                       PIC X(9).
   225
   226 01  WORK-AREA.
   227     05  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   228     05  PGM-NAME                PIC X(8).
   229     05  WS-RESPONSE             PIC S9(8)   COMP.
   230         88  RESP-NORMAL                  VALUE +00.
   231         88  RESP-NOTFND                  VALUE +13.
   232         88  RESP-DUPREC                  VALUE +14.
   233         88  RESP-DUPKEY                  VALUE +15.
   234         88  RESP-NOTOPEN                 VALUE +19.
   235         88  RESP-ENDFILE                 VALUE +20.
   236     05  WS-COMPANY-CD           PIC X  VALUE LOW-VALUES.
   237     05  WS-ARCHIVE-NO           PIC S9(8)  COMP VALUE +0.
   238     05  WS-FOLLOW-UP-DT         PIC XX  VALUE LOW-VALUES.
   239     05  WS-RESEND-DT            PIC XX  VALUE LOW-VALUES.
   240     05  WS-AUTO-LAST-SCHED-DT   PIC XX  VALUE LOW-VALUES.
   241     05  WS-LAST-ACT-DT          PIC XX  VALUE LOW-VALUES.
   242     05  WS-ACTIVITY-DT          PIC XX  VALUE LOW-VALUES.
   243     05  WS-FORM                 PIC XXXX  VALUE SPACES.
   244     05  WS-MESSAGE              PIC X(50) VALUE SPACES.
   245
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page   6
* ELVADS.cbl
   246 01  VAPRINT-LINE.
   247     05  VA-LETTER               PIC X(06) VALUE SPACES.
   248     05  VA-PROC-ID              PIC X(04) VALUE SPACES.
   249     05  VA-PROC-NAME            PIC X(30) VALUE SPACES.
   250     05  VA-PROC-TITLE           PIC X(30) VALUE SPACES.
   251     05  VA-CSR-CODE             PIC X(4) VALUE SPACES.
   252     05  VA-CSR-NAME             PIC X(30) VALUE SPACES.
   253     05  VA-CSR-TITLE            PIC X(30) VALUE SPACES.
   254     05  VA-CARRIER              PIC X(01) VALUE SPACES.
   255     05  VA-GROUPING             PIC X(06) VALUE SPACES.
   256     05  VA-STATE                PIC X(02) VALUE SPACES.
   257     05  VA-ACCOUNT              PIC X(10) VALUE SPACES.
   258     05  VA-EFFDATE              PIC X(10) VALUE SPACES.
   259     05  VA-CERT-NO              PIC X(11) VALUE SPACES.
   260     05  VA-FIRSTNAME            PIC X(10) VALUE SPACES.
   261     05  VA-MIDINIT              PIC X(1) VALUE SPACES.
   262     05  VA-LASTNAME             PIC X(15) VALUE SPACES.
   263     05  VA-ADDR1                PIC X(30) VALUE SPACES.
   264     05  VA-ADDR2                PIC X(30) VALUE SPACES.
   265     05  VA-ADDR-CITY            PIC X(28) VALUE SPACES.
   266     05  VA-ADDR-ST              PIC X(2) VALUE SPACES.
   267     05  VA-ADDR-ZIP             PIC X(9) VALUE SPACES.
   268     05  VA-JNT-FIRSTNAME        PIC X(10) VALUE SPACES.
   269     05  VA-JNT-MIDINIT          PIC X(1) VALUE SPACES.
   270     05  VA-JNT-LASTNAME         PIC X(15) VALUE SPACES.
   271     05  VA-ARCH-NO              PIC 9(9) VALUE ZEROS.
   272     05  VA-ENC-LINE             PIC X(50) VALUE SPACES.
   273     05  VA-ATTACH               PIC X(50) VALUE SPACES.
   274     05  VA-STACK                PIC X(10) VALUE SPACES.
   275     05  VA-PRINT-NOW            PIC X(01) VALUE SPACES.
   276     05  VA-BORROWER             PIC X(30) VALUE SPACES.
   277     05  VA-BENE                 PIC X(30) VALUE SPACES.
   278     05  VA-ACCT-NAME            PIC X(30) VALUE SPACES.
   279     05  VA-SL                   PIC X VALUE SPACES.
   280     05  VA-JL                   PIC X VALUE SPACES.
   281     05  VA-SA                   PIC X VALUE SPACES.
   282     05  VA-JA                   PIC X VALUE SPACES.
   283     05  VA-GD                   PIC X VALUE SPACES.
   284     05  VA-NP                   PIC X VALUE SPACES.
   285     05  VA-7R                   PIC X VALUE SPACES.
   286     05  VA-LL                   PIC X VALUE SPACES.
   287     05  VA-TN                   PIC X VALUE SPACES.
   288     05  VA-14R                  PIC X VALUE SPACES.
   289     05  VA-14E                  PIC X VALUE SPACES.
   290     05  VA-30R                  PIC X VALUE SPACES.
   291     05  VA-30E                  PIC X VALUE SPACES.
   292     05  VA-CL-NET-AMT           PIC 9(7).99 BLANK WHEN ZERO.
   293     05  VA-CL-GRS-AMT           PIC 9(7).99 BLANK WHEN ZERO.
   294     05  VA-CL-LEV-AMT           PIC 9(7).99 BLANK WHEN ZERO.
   295     05  VA-CL-NET-PMT           PIC 9(5).99  BLANK WHEN ZERO.
   296     05  VA-CL-GRS-PMT           PIC 9(5).99  BLANK WHEN ZERO.
   297     05  VA-CL-LEV-PMT           PIC 9(5).99  BLANK WHEN ZERO.
   298     05  VA-CL-NET-PRM           PIC 9(5).99  BLANK WHEN ZERO.
   299     05  VA-CL-GRS-PRM           PIC 9(5).99  BLANK WHEN ZERO.
   300     05  VA-CL-LEV-PRM           PIC 9(5).99  BLANK WHEN ZERO.
   301     05  VA-CD-NET-AMT           PIC 9(7).99 BLANK WHEN ZERO.
   302     05  VA-CD-GRS-AMT           PIC 9(7).99 BLANK WHEN ZERO.
   303     05  VA-CD-LEV-AMT           PIC 9(7).99 BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page   7
* ELVADS.cbl
   304     05  VA-CD-NET-PMT           PIC 9(5).99  BLANK WHEN ZERO.
   305     05  VA-CD-GRS-PMT           PIC 9(5).99  BLANK WHEN ZERO.
   306     05  VA-CD-LEV-PMT           PIC 9(5).99  BLANK WHEN ZERO.
   307     05  VA-CD-NET-PRM           PIC 9(5).99  BLANK WHEN ZERO.
   308     05  VA-CD-GRS-PRM           PIC 9(5).99  BLANK WHEN ZERO.
   309     05  VA-CD-LEV-PRM           PIC 9(5).99  BLANK WHEN ZERO.
   310     05  VA-CLD-NET-AMT          PIC 9(7).99 BLANK WHEN ZERO.
   311     05  VA-CLD-GRS-AMT          PIC 9(7).99 BLANK WHEN ZERO.
   312     05  VA-CLD-LEV-AMT          PIC 9(7).99 BLANK WHEN ZERO.
   313     05  VA-CLD-NET-PMT          PIC 9(5).99  BLANK WHEN ZERO.
   314     05  VA-CLD-GRS-PMT          PIC 9(5).99  BLANK WHEN ZERO.
   315     05  VA-CLD-LEV-PMT          PIC 9(5).99  BLANK WHEN ZERO.
   316     05  VA-CLD-NET-PRM          PIC 9(5).99  BLANK WHEN ZERO.
   317     05  VA-CLD-GRS-PRM          PIC 9(5).99  BLANK WHEN ZERO.
   318     05  VA-CLD-LEV-PRM          PIC 9(5).99  BLANK WHEN ZERO.
   319     05  VA-NO-NET-AMT           PIC 9(7).99 BLANK WHEN ZERO.
   320     05  VA-NO-GRS-AMT           PIC 9(7).99 BLANK WHEN ZERO.
   321     05  VA-NO-LEV-AMT           PIC 9(7).99 BLANK WHEN ZERO.
   322     05  VA-NO-NET-PMT           PIC 9(5).99  BLANK WHEN ZERO.
   323     05  VA-NO-GRS-PMT           PIC 9(5).99  BLANK WHEN ZERO.
   324     05  VA-NO-LEV-PMT           PIC 9(5).99  BLANK WHEN ZERO.
   325     05  VA-NO-NET-PRM           PIC 9(5).99  BLANK WHEN ZERO.
   326     05  VA-NO-GRS-PRM           PIC 9(5).99  BLANK WHEN ZERO.
   327     05  VA-NO-LEV-PRM           PIC 9(5).99  BLANK WHEN ZERO.
   328*                                COPY ERCRATE.
   329******************************************************************
   330*                                                                *
   331*                                                                *
   332*                            ERCRATE                             *
   333*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   334*                            VMOD=2.008                          *
   335*                                                                *
   336*   ONLINE CREDIT SYSTEM                                         *
   337*                                                                *
   338*   FILE DESCRIPTION = RATES MASTER FILE                         *
   339*                                                                *
   340*   FILE TYPE = VSAM,KSDS                                        *
   341*   RECORD SIZE = 1765  RECFORM = FIXED                          *
   342*                                                                *
   343*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
   344*       ALTERNATE PATH = NONE                                    *
   345*                                                                *
   346*   LOG = NO                                                     *
   347*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   348*                                                                *
   349******************************************************************
   350******************************************************************
   351*                   C H A N G E   L O G
   352*
   353* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   354*-----------------------------------------------------------------
   355*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   356* EFFECTIVE    NUMBER
   357*-----------------------------------------------------------------
   358* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   359******************************************************************
   360
   361 01  RATE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page   8
* ELVADS.cbl
   362     12  RT-RECORD-ID                      PIC XX.
   363         88  VALID-RT-ID                      VALUE 'RT'.
   364
   365     12  RT-CONTROL-PRIMARY.
   366         16  RT-COMPANY-CD                 PIC X.
   367         16  RT-STATE-CODE.
   368             20  RT-ST-CODE                PIC XX.
   369             20  RT-ST-CLASS               PIC XX.
   370             20  RT-ST-DEV                 PIC XXX.
   371         16  RT-L-AH-CODE.
   372             20  RT-L-AH                   PIC X.
   373             20  RT-LAH-NUM                PIC XX.
   374         16  RT-LIMITS.
   375             20  RT-HIGH-AGE               PIC 99.
   376             20  RT-HIGH-AMT               PIC 9(6).
   377             20  RT-FUTURE                 PIC XX.
   378             20  RT-SEX                    PIC X.
   379         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.
   380
   381     12  RT-MAINT-INFORMATION.
   382         16  RT-LAST-MAINT-DT              PIC XX.
   383         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   384         16  RT-LAST-MAINT-USER            PIC X(4).
   385         16  FILLER                        PIC X(10).
   386
   387     12  RT-STRUCTURE-COMMENT              PIC X(50).
   388     12  RT-RATE-COMMENT                   PIC X(50).
   389
   390     12  CSL-RESERVED                      PIC X(10).
   391     12  FILLER                            PIC X(12).
   392
   393     12  RT-MAX-AGE                        PIC 99.
   394
   395     12  RT-LIFE-LIMS-FLDS.
   396         16  RT-LIFE-MORT-CODE             PIC X(4).
   397         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
   398             20  RT-L-EX-AGE               PIC 99.
   399             20  RT-L-EX-TERM              PIC S999       COMP-3.
   400             20  RT-L-EX-FACE              PIC S9(7)      COMP-3.
   401         16  FILLER                        PIC X(20).
   402
   403     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.
   404         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.
   405             20  RT-AH-AGE                 PIC 99.
   406             20  RT-AH-TERM                PIC S999       COMP-3.
   407             20  RT-AH-BEN-M               PIC S9(5)      COMP-3.
   408             20  RT-AH-BEN-F               PIC S9(7)      COMP-3.
   409
   410     12  RT-LIFE-RATES.
   411         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
   412
   413     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.
   414         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
   415
   416     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.
   417
   418     12  RT-DISCOUNT-OPTION                PIC X.
   419         88  RT-DO-NOT-USE                     VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page   9
* ELVADS.cbl
   420         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.
   421         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.
   422
   423     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
   424     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
   425
   426     12  RT-COMPOSITE-OPTION               PIC X.
   427         88  RT-NO-COMPOSITE                   VALUE ' '.
   428         88  RT-USE-COMPOSITE-RATE             VALUE '1'.
   429
   430     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
   431
   432     12  RT-CANCEL-FEE                     PIC S9(3)V99   COMP-3.
   433     12  FILLER                            PIC X(13).
   434
   435     12  RT-TYPE-RATE                      PIC X.
   436         88  RT-IS-STND                        VALUE ' ' 'S'.
   437         88  RT-IS-OB                          VALUE 'O'.
   438
   439     12  RT-SRT-ALPHA                      PIC X.
   440
   441     12  RT-CONTROL-2.
   442         16  RTC-1                         PIC X(7).
   443         16  RTC-3                         PIC X(11).
   444         16  RTC-4                         PIC 9(11) COMP-3.
   445         16  RTC-2                         PIC X(3).
   446******************************************************************
   447*                                COPY ELCVADS.
   448******************************************************************
   449*                                                                *
   450*                                                                *
   451*                            ELCVADS.                            *
   452*                                                                *
   453*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
   454*   ELVADS                  LENGTH = 350                         *
   455******************************************************************
   456******************************************************************
   457*                   C H A N G E   L O G
   458*
   459* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   460*-----------------------------------------------------------------
   461*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   462* EFFECTIVE    NUMBER
   463*-----------------------------------------------------------------
   464* 100111    2011022800001  AJRA  NAPERSOFT
   465******************************************************************
   466
   467 01  VIRGINIA-DISCLOSURE.
   468     12  VD-COMPANY-CD              PIC X.
   469     12  VD-CARRIER                 PIC X.
   470     12  VD-GROUPING.
   471         20  VD-GROUPING-PREFIX     PIC XXX.
   472         20  VD-GROUPING-PRIME      PIC XXX.
   473     12  VD-STATE                   PIC XX.
   474     12  VD-ACCOUNT.
   475         20  VD-ACCOUNT-PREFIX      PIC X(4).
   476         20  VD-ACCOUNT-PRIME       PIC X(6).
   477     12  VD-CERT-EFF-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  10
* ELVADS.cbl
   478     12  VD-CERT-NO.
   479         20  VD-CERT-PRIME          PIC X(10).
   480         20  VD-CERT-SFX            PIC X.
   481     12  VD-ENTRY-BATCH             PIC X(6).
   482     12  VD-CSR-ID                  PIC X(4).
   483     12  VD-NAME.
   484         20  VD-INSURED-LAST-NAME   PIC X(15).
   485         20  VD-INSURED-FIRST-NAME.
   486             24  VD-INSURED-1ST-INIT PIC X.
   487             24  FILLER             PIC X(9).
   488         20  VD-INSURED-MIDDLE-INIT PIC X.
   489     12  VD-JOINT-INSURED.
   490         20 VD-JOINT-LAST-NAME      PIC X(15).
   491         20 VD-JOINT-FIRST-NAME.
   492            24  VD-JOINT-FIRST-INIT PIC X.
   493            24  FILLER              PIC X(9).
   494         20 VD-JOINT-MIDDLE-INIT    PIC X.
   495     12  VD-INSURED-ADDRESS-1       PIC X(30).
   496     12  VD-INSURED-ADDRESS-2       PIC X(30).
   497     12  VD-INSURED-CITY-STATE.
   498         20  VD-INSURED-CITY        PIC X(28).
   499         20  VD-INSURED-STATE       PIC XX.
   500     12  VD-INSURED-ZIP-CODE.
   501         20  VD-INSURED-ZIP-PRIME.
   502             24  VD-INSURED-ZIP-1   PIC X.
   503                 88  VD-CANADIAN-POST-CODE
   504                                       VALUE 'A' THRU 'Z'.
   505             24  FILLER             PIC X(4).
   506         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
   507     12  VD-BENEFICIARY-NAME        PIC X(30).
   508     12  VD-ACCOUNT-NAME            PIC X(30).
   509     12  VD-LOAN-TERM               PIC S999   COMP-3.
   510     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   511     12  VD-1ST-PMT-DT              PIC XX.
   512     12  VD-LIFE-BENEFIT-CD         PIC XX.
   513         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
   514         88  VD-INVALID-LIFE           VALUE '  ' '00'
   515                                             '90' THRU '99'.
   516     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
   517                                    PIC XX.
   518     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   519     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   520     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
   521     12  VD-LF-TERM                 PIC S999   COMP-3.
   522     12  VD-AH-BENEFIT-CD           PIC XX.
   523         88  VD-VALID-AH               VALUE '01' THRU '89'.
   524         88  VD-INVALID-AH             VALUE '  ' '00'
   525                                             '90' THRU '99'.
   526     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   527     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   528     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
   529     12  VD-AH-TERM                 PIC S999   COMP-3.
   530     12  VD-LETTER-ID               PIC X(4).
   531     12  VD-PROC-ID                 PIC X(4).
   532     12  VD-COMP-ID                 PIC X(3).
   533     12  VD-CURRENT-DATE            PIC XX.
   534     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
   535     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  11
* ELVADS.cbl
   536     12  FILLER                     PIC X(32).
   537*                                COPY ELCDATE.
   538******************************************************************
   539*                                                                *
   540*                                                                *
   541*                            ELCDATE.                            *
   542*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   543*                            VMOD=2.003
   544*                                                                *
   545*                                                                *
   546*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   547*                 LENGTH = 200                                   *
   548******************************************************************
   549
   550 01  DATE-CONVERSION-DATA.
   551     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   552     12  DC-OPTION-CODE                PIC X.
   553         88  BIN-TO-GREG                VALUE ' '.
   554         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   555         88  EDIT-GREG-TO-BIN           VALUE '2'.
   556         88  YMD-GREG-TO-BIN            VALUE '3'.
   557         88  MDY-GREG-TO-BIN            VALUE '4'.
   558         88  JULIAN-TO-BIN              VALUE '5'.
   559         88  BIN-PLUS-ELAPSED           VALUE '6'.
   560         88  FIND-CENTURY               VALUE '7'.
   561         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   562         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   563         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   564         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   565         88  JULIAN-TO-BIN-3            VALUE 'C'.
   566         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   567         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   568         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   569         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   570         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   571         88  CHECK-LEAP-YEAR            VALUE 'H'.
   572         88  BIN-3-TO-GREG              VALUE 'I'.
   573         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   574         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   575         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   576         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   577         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   578         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   579         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   580         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   581         88  THREE-CHARACTER-BIN
   582                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   583         88  GREGORIAN-TO-BIN
   584                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   585         88  BIN-TO-GREGORIAN
   586                  VALUES ' ' '1' 'I' '8' 'G'.
   587         88  JULIAN-TO-BINARY
   588                  VALUES '5' 'C' 'E' 'F'.
   589     12  DC-ERROR-CODE                 PIC X.
   590         88  NO-CONVERSION-ERROR        VALUE ' '.
   591         88  DATE-CONVERSION-ERROR
   592                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   593         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  12
* ELVADS.cbl
   594         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   595         88  DATE-IS-INVALID            VALUE '3'.
   596         88  DATE1-GREATER-DATE2        VALUE '4'.
   597         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   598         88  DATE-INVALID-OPTION        VALUE '9'.
   599         88  INVALID-CENTURY            VALUE 'A'.
   600         88  ONLY-CENTURY               VALUE 'B'.
   601         88  ONLY-LEAP-YEAR             VALUE 'C'.
   602         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   603     12  DC-END-OF-MONTH               PIC X.
   604         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   605     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   606         88  USE-NORMAL-PROCESS         VALUE ' '.
   607         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   608         88  ADJUST-UP-100-YRS          VALUE '2'.
   609     12  FILLER                        PIC X.
   610     12  DC-CONVERSION-DATES.
   611         16  DC-BIN-DATE-1             PIC XX.
   612         16  DC-BIN-DATE-2             PIC XX.
   613         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   614         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   615                       DC-GREG-DATE-1-EDIT.
   616             20  DC-EDIT1-MONTH        PIC 99.
   617             20  SLASH1-1              PIC X.
   618             20  DC-EDIT1-DAY          PIC 99.
   619             20  SLASH1-2              PIC X.
   620             20  DC-EDIT1-YEAR         PIC 99.
   621         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   622         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   623                     DC-GREG-DATE-2-EDIT.
   624             20  DC-EDIT2-MONTH        PIC 99.
   625             20  SLASH2-1              PIC X.
   626             20  DC-EDIT2-DAY          PIC 99.
   627             20  SLASH2-2              PIC X.
   628             20  DC-EDIT2-YEAR         PIC 99.
   629         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   630         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   631                     DC-GREG-DATE-1-YMD.
   632             20  DC-YMD-YEAR           PIC 99.
   633             20  DC-YMD-MONTH          PIC 99.
   634             20  DC-YMD-DAY            PIC 99.
   635         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   636         16  DC-GREG-DATE-1-MDY-R REDEFINES
   637                      DC-GREG-DATE-1-MDY.
   638             20  DC-MDY-MONTH          PIC 99.
   639             20  DC-MDY-DAY            PIC 99.
   640             20  DC-MDY-YEAR           PIC 99.
   641         16  DC-GREG-DATE-1-ALPHA.
   642             20  DC-ALPHA-MONTH        PIC X(10).
   643             20  DC-ALPHA-DAY          PIC 99.
   644             20  FILLER                PIC XX.
   645             20  DC-ALPHA-CENTURY.
   646                 24 DC-ALPHA-CEN-N     PIC 99.
   647             20  DC-ALPHA-YEAR         PIC 99.
   648         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   649         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   650         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   651         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  13
* ELVADS.cbl
   652         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   653                                       PIC 9(05).
   654         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   655             20  DC-JULIAN-YEAR        PIC 99.
   656             20  DC-JULIAN-DAYS        PIC 999.
   657         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   658         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   659         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   660     12  DATE-CONVERSION-VARIBLES.
   661         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   662         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   663             20  FILLER                PIC 9(3).
   664             20  HOLD-CEN-1-CCYY.
   665                 24  HOLD-CEN-1-CC     PIC 99.
   666                 24  HOLD-CEN-1-YY     PIC 99.
   667             20  HOLD-CEN-1-MO         PIC 99.
   668             20  HOLD-CEN-1-DA         PIC 99.
   669         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   670             20  HOLD-CEN-1-R-MO       PIC 99.
   671             20  HOLD-CEN-1-R-DA       PIC 99.
   672             20  HOLD-CEN-1-R-CCYY.
   673                 24  HOLD-CEN-1-R-CC   PIC 99.
   674                 24  HOLD-CEN-1-R-YY   PIC 99.
   675             20  FILLER                PIC 9(3).
   676         16  HOLD-CENTURY-1-X.
   677             20  FILLER                PIC X(3)  VALUE SPACES.
   678             20  HOLD-CEN-1-X-CCYY.
   679                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   680                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   681             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   682             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   683         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   684             20  HOLD-CEN-1-R-X-MO     PIC XX.
   685             20  HOLD-CEN-1-R-X-DA     PIC XX.
   686             20  HOLD-CEN-1-R-X-CCYY.
   687                 24  HOLD-CEN-1-R-X-CC PIC XX.
   688                 24  HOLD-CEN-1-R-X-YY PIC XX.
   689             20  FILLER                PIC XXX.
   690         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   691         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   692         16  DC-JULIAN-DATE-1          PIC 9(07).
   693         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   694             20  DC-JULIAN-1-CCYY.
   695                 24  DC-JULIAN-1-CC    PIC 99.
   696                 24  DC-JULIAN-1-YR    PIC 99.
   697             20  DC-JULIAN-DA-1        PIC 999.
   698         16  DC-JULIAN-DATE-2          PIC 9(07).
   699         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   700             20  DC-JULIAN-2-CCYY.
   701                 24  DC-JULIAN-2-CC    PIC 99.
   702                 24  DC-JULIAN-2-YR    PIC 99.
   703             20  DC-JULIAN-DA-2        PIC 999.
   704         16  DC-GREG-DATE-A-EDIT.
   705             20  DC-EDITA-MONTH        PIC 99.
   706             20  SLASHA-1              PIC X VALUE '/'.
   707             20  DC-EDITA-DAY          PIC 99.
   708             20  SLASHA-2              PIC X VALUE '/'.
   709             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  14
* ELVADS.cbl
   710                 24  DC-EDITA-CENT     PIC 99.
   711                 24  DC-EDITA-YEAR     PIC 99.
   712         16  DC-GREG-DATE-B-EDIT.
   713             20  DC-EDITB-MONTH        PIC 99.
   714             20  SLASHB-1              PIC X VALUE '/'.
   715             20  DC-EDITB-DAY          PIC 99.
   716             20  SLASHB-2              PIC X VALUE '/'.
   717             20  DC-EDITB-CCYY.
   718                 24  DC-EDITB-CENT     PIC 99.
   719                 24  DC-EDITB-YEAR     PIC 99.
   720         16  DC-GREG-DATE-CYMD         PIC 9(08).
   721         16  DC-GREG-DATE-CYMD-R REDEFINES
   722                              DC-GREG-DATE-CYMD.
   723             20  DC-CYMD-CEN           PIC 99.
   724             20  DC-CYMD-YEAR          PIC 99.
   725             20  DC-CYMD-MONTH         PIC 99.
   726             20  DC-CYMD-DAY           PIC 99.
   727         16  DC-GREG-DATE-MDCY         PIC 9(08).
   728         16  DC-GREG-DATE-MDCY-R REDEFINES
   729                              DC-GREG-DATE-MDCY.
   730             20  DC-MDCY-MONTH         PIC 99.
   731             20  DC-MDCY-DAY           PIC 99.
   732             20  DC-MDCY-CEN           PIC 99.
   733             20  DC-MDCY-YEAR          PIC 99.
   734    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   735        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   736    12  DC-EL310-DATE                  PIC X(21).
   737    12  FILLER                         PIC X(28).
   738*                                COPY ELCTEXT.
   739******************************************************************
   740*                                                                *
   741*                                                                *
   742*                            ELCTEXT.                            *
   743*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   744*                            VMOD=2.008                          *
   745*                                                                *
   746*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   747*                                     FORM LETTERS,              *
   748*                                     CERT FORM DISPLAY.
   749*                                                                *
   750*   FILE TYPE = VSAM,KSDS                                        *
   751*   RECORD SIZE = 100   RECFORM = FIXED                          *
   752*                                                                *
   753*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   754*       ALTERNATE INDEX = NONE                                   *
   755*                                                                *
   756*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   757*       ALTERNATE INDEX = NONE                                   *
   758*                                                                *
   759*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   760*       ALTERNATE INDEX = NONE                                   *
   761*                                                                *
   762*   LOG = NO                                                     *
   763*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   764******************************************************************
   765 01  TEXT-FILES.
   766     12  TEXT-FILE-ID                PIC XX.
   767         88  FORMS-FILE-TEXT            VALUE 'TF'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  15
* ELVADS.cbl
   768         88  LETTER-FILE-TEXT           VALUE 'TL'.
   769         88  HELP-FILE-TEXT             VALUE 'TH'.
   770
   771     12  TX-CONTROL-PRIMARY.
   772         16  TX-COMPANY-CD           PIC X.
   773             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   774         16  TX-ACCESS-CD-GENL       PIC X(12).
   775
   776         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   777             20  TX-LETTER-NO        PIC X(4).
   778             20  FILLER              PIC X(8).
   779
   780         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   781             20  TX-FORM-NO          PIC X(12).
   782
   783         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   784             20  TX-HELP-TYPE        PIC X.
   785                 88  HELP-FOR-GENERAL   VALUE ' '.
   786                 88  HELP-BY-SCREEN     VALUE 'S'.
   787                 88  HELP-BY-ERROR      VALUE 'E'.
   788             20  TX-SCREEN-OR-ERROR  PIC X(4).
   789                 88  GENERAL-INFO-HELP  VALUE '0000'.
   790             20  TX-HELP-FOR-COMPANY  PIC XXX.
   791                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   792             20  FILLER              PIC X(4).
   793
   794         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   795
   796     12  TX-PROCESS-CONTROL          PIC XX.
   797         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   798
   799     12  TX-TEXT-LINE                PIC X(70).
   800
   801     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   802         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   803         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   804         88  TX-VALID-FORM-SQUEEZE-VALUE
   805                                        VALUE 'Y' ' '.
   806
   807     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   808         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   809         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   810         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   811         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   812         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   813         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   814         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   815                                              'K' 'N' ' '
   816                                              'Z'.
   817
   818     12  TX-ARCHIVE-SW               PIC X.
   819         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   820         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   821         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   822
   823     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   824     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   825
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  16
* ELVADS.cbl
   826     12  TX-BSR-CODE                 PIC X.
   827         88  TX-BSR-LETTER              VALUE 'B'.
   828         88  TX-NON-BSR-LETTER          VALUE ' '.
   829
   830     12  FILLER                      PIC X.
   831*****************************************************************
   832*                                COPY ELCCNTL.
   833******************************************************************
   834*                                                                *
   835*                                                                *
   836*                            ELCCNTL.                            *
   837*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   838*                            VMOD=2.059                          *
   839*                                                                *
   840*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   841*                                                                *
   842*   FILE TYPE = VSAM,KSDS                                        *
   843*   RECORD SIZE = 750  RECFORM = FIXED                           *
   844*                                                                *
   845*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   846*       ALTERNATE INDEX = NONE                                   *
   847*                                                                *
   848*   LOG = YES                                                    *
   849*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   850******************************************************************
   851*                   C H A N G E   L O G
   852*
   853* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   854*-----------------------------------------------------------------
   855*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   856* EFFECTIVE    NUMBER
   857*-----------------------------------------------------------------
   858* 082503                   PEMA  ADD BENEFIT GROUP
   859* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   860* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   861* 092705    2005050300006  PEMA  ADD SPP LEASES
   862* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   863* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   864* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   865* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   866* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   867* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   868* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   869* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   870* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   871* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   872******************************************************************
   873*
   874 01  CONTROL-FILE.
   875     12  CF-RECORD-ID                       PIC XX.
   876         88  VALID-CF-ID                        VALUE 'CF'.
   877
   878     12  CF-CONTROL-PRIMARY.
   879         16  CF-COMPANY-ID                  PIC XXX.
   880         16  CF-RECORD-TYPE                 PIC X.
   881             88  CF-COMPANY-MASTER              VALUE '1'.
   882             88  CF-PROCESSOR-MASTER            VALUE '2'.
   883             88  CF-STATE-MASTER                VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  17
* ELVADS.cbl
   884             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   885             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   886             88  CF-CARRIER-MASTER              VALUE '6'.
   887             88  CF-MORTALITY-MASTER            VALUE '7'.
   888             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   889             88  CF-TERMINAL-MASTER             VALUE '9'.
   890             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   891             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   892             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   893             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   894             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   895             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   896             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   897             88  CF-REMINDERS-MASTER            VALUE 'R'.
   898             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   899         16  CF-ACCESS-CD-GENL              PIC X(4).
   900         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   901             20  CF-PROCESSOR               PIC X(4).
   902         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   903             20  CF-STATE-CODE              PIC XX.
   904             20  FILLER                     PIC XX.
   905         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   906             20  FILLER                     PIC XX.
   907             20  CF-HI-BEN-IN-REC           PIC XX.
   908         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   909             20  FILLER                     PIC XXX.
   910             20  CF-CARRIER-CNTL            PIC X.
   911         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   912             20  FILLER                     PIC XX.
   913             20  CF-HI-TYPE-IN-REC          PIC 99.
   914         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   915             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   916                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   917             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   918             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   919         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   920             20  FILLER                     PIC X.
   921             20  CF-CUSTOM-REPORT-NO        PIC 999.
   922         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   923             20  FILLER                     PIC XX.
   924             20  CF-MORTGAGE-PLAN           PIC XX.
   925         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   926
   927     12  CF-LAST-MAINT-DT                   PIC XX.
   928     12  CF-LAST-MAINT-BY                   PIC X(4).
   929     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   930
   931     12  CF-RECORD-BODY                     PIC X(728).
   932
   933
   934****************************************************************
   935*             COMPANY MASTER RECORD                            *
   936****************************************************************
   937
   938     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   939         16  CF-COMPANY-ADDRESS.
   940             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   941             20  CF-CL-IN-CARE-OF           PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  18
* ELVADS.cbl
   942             20  CF-CL-ADDR-LINE-1          PIC X(30).
   943             20  CF-CL-ADDR-LINE-2          PIC X(30).
   944             20  CF-CL-CITY-STATE           PIC X(30).
   945             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   946             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   947         16  CF-COMPANY-CD                  PIC X.
   948         16  CF-COMPANY-PASSWORD            PIC X(8).
   949         16  CF-SECURITY-OPTION             PIC X.
   950             88  ALL-SECURITY                   VALUE '1'.
   951             88  COMPANY-VERIFY                 VALUE '2'.
   952             88  PROCESSOR-VERIFY               VALUE '3'.
   953             88  NO-SECURITY                    VALUE '4'.
   954             88  ALL-BUT-TERM                   VALUE '5'.
   955         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   956             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   957         16  CF-LGX-INTERFACE-CNTL          PIC X.
   958             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   959         16  CF-INFORCE-LOCATION            PIC X.
   960             88  CERTS-ARE-ONLINE               VALUE '1'.
   961             88  CERTS-ARE-OFFLINE              VALUE '2'.
   962             88  NO-CERTS-AVAILABLE             VALUE '3'.
   963         16  CF-LOWER-CASE-LETTERS          PIC X.
   964         16  CF-CERT-ACCESS-CONTROL         PIC X.
   965             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   966             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   967             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   968             88  CF-ACCNT-CNTL                  VALUE '3'.
   969             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   970
   971         16  CF-FORMS-PRINTER-ID            PIC X(4).
   972         16  CF-CHECK-PRINTER-ID            PIC X(4).
   973
   974         16  CF-LGX-CREDIT-USER             PIC X.
   975             88  CO-IS-NOT-USER                 VALUE 'N'.
   976             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   977
   978         16 CF-CREDIT-CALC-CODES.
   979             20  CF-CR-REM-TERM-CALC PIC X.
   980               88  CR-EARN-AFTER-15TH           VALUE '1'.
   981               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   982               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   983               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   984               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   985               88  CR-EARN-AFTER-14TH           VALUE '6'.
   986               88  CR-EARN-AFTER-16TH           VALUE '7'.
   987             20  CF-CR-R78-METHOD           PIC X.
   988               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   989               88  DONT-USE-PLUS-ONE            VALUE '1'.
   990
   991         16  CF-CLAIM-CONTROL-COUNTS.
   992             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   993                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   994
   995             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   996                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   997
   998             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   999                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  19
* ELVADS.cbl
  1000
  1001             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1002                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1003
  1004         16  CF-CURRENT-MONTH-END           PIC XX.
  1005
  1006         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1007             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1008             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1009             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1010             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1011                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1012                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1013             20  CF-CO-PREM-REJECT-SW       PIC X.
  1014                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1015                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1016             20  CF-CO-REF-REJECT-SW        PIC X.
  1017                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1018                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1019
  1020         16  CF-CO-REPORTING-DT             PIC XX.
  1021         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1022         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1023           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1024           88  CF-CO-MONTH-END                  VALUE '1'.
  1025
  1026         16  CF-LGX-CLAIM-USER              PIC X.
  1027             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1028             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1029
  1030         16  CF-CREDIT-EDIT-CONTROLS.
  1031             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1032             20  CF-MIN-AGE                 PIC 99.
  1033             20  CF-DEFAULT-AGE             PIC 99.
  1034             20  CF-MIN-TERM                PIC S999      COMP-3.
  1035             20  CF-MAX-TERM                PIC S999      COMP-3.
  1036             20  CF-DEFAULT-SEX             PIC X.
  1037             20  CF-JOINT-AGE-INPUT         PIC X.
  1038                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1039             20  CF-BIRTH-DATE-INPUT        PIC X.
  1040                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1041             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1042                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1043                 88  CF-ZERO-CARRIER            VALUE '1'.
  1044                 88  CF-ZERO-GROUPING           VALUE '2'.
  1045                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1046             20  CF-EDIT-SW                 PIC X.
  1047                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1048             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1049             20  CF-CR-PR-METHOD            PIC X.
  1050               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1051               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1052             20  FILLER                     PIC X.
  1053
  1054         16  CF-CREDIT-MISC-CONTROLS.
  1055             20  CF-REIN-TABLE-SW           PIC X.
  1056                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1057             20  CF-COMP-TABLE-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  20
* ELVADS.cbl
  1058                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1059             20  CF-EXPERIENCE-RETENTION-AGE
  1060                                            PIC S9        COMP-3.
  1061             20  CF-CONVERSION-DT           PIC XX.
  1062             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1063             20  CF-RUN-FREQUENCY-SW        PIC X.
  1064                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1065                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1066
  1067             20  CF-CR-CHECK-NO-CONTROL.
  1068                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1069                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1070                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1071                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1072                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1073                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1074
  1075                 24  CF-CR-CHECK-COUNT       REDEFINES
  1076                     CF-CR-CHECK-COUNTER      PIC X(4).
  1077
  1078                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1079                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1080
  1081                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1082                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1083                 24  CF-MAIL-PROCESSING       PIC X.
  1084                     88  MAIL-PROCESSING          VALUE 'Y'.
  1085
  1086         16  CF-MISC-SYSTEM-CONTROL.
  1087             20  CF-SYSTEM-C                 PIC X.
  1088                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1089             20  CF-SYSTEM-D                 PIC X.
  1090                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1091             20  CF-SOC-SEC-NO-SW            PIC X.
  1092                 88  SOC-SEC-NO-USED             VALUE '1'.
  1093             20  CF-MEMBER-NO-SW             PIC X.
  1094                 88  MEMBER-NO-USED              VALUE '1'.
  1095             20  CF-TAX-ID-NUMBER            PIC X(11).
  1096             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1097             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1098                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1099                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1100                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1101                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1102             20  CF-SYSTEM-E                 PIC X.
  1103                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1104
  1105         16  CF-LGX-LIFE-USER               PIC X.
  1106             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1107             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1108
  1109         16  CF-CR-MONTH-END-DT             PIC XX.
  1110
  1111         16  CF-FILE-MAINT-DATES.
  1112             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1113                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1114             20  CF-LAST-BATCH       REDEFINES
  1115                 CF-LAST-BATCH-NO               PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  21
* ELVADS.cbl
  1116             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1117             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1118             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1119             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1120             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1121             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1122             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1123             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1124             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1125             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1126
  1127         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1128         16  FILLER                         PIC X.
  1129
  1130         16  CF-ALT-MORT-CODE               PIC X(4).
  1131         16  CF-MEMBER-CAPTION              PIC X(10).
  1132
  1133         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1134             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1135             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1136             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1137             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1138             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1139
  1140         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1141
  1142         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1143         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1144         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1145         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1146
  1147         16  CF-AH-OVERRIDE-L1              PIC X.
  1148         16  CF-AH-OVERRIDE-L2              PIC XX.
  1149         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1150         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1151
  1152         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1153         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1154
  1155         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1156         16  CF-AR-LAST-EL860-DT            PIC XX.
  1157         16  CF-MP-MONTH-END-DT             PIC XX.
  1158
  1159         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1160         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1161             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1162
  1163         16  CF-AR-MONTH-END-DT             PIC XX.
  1164
  1165         16  CF-CRDTCRD-USER                PIC X.
  1166             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1167             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1168
  1169         16  CF-CC-MONTH-END-DT             PIC XX.
  1170
  1171         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1172
  1173         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  22
* ELVADS.cbl
  1174             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1175             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1176             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1177         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1178         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1179         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1180         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1181             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1182             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1183         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1184         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1185         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1186             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1187         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1188
  1189         16  CF-CL-ZIP-CODE.
  1190             20  CF-CL-ZIP-PRIME.
  1191                 24  CF-CL-ZIP-1ST          PIC X.
  1192                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1193                 24  FILLER                 PIC X(4).
  1194             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1195         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1196             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1197             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1198             20  FILLER                     PIC XXX.
  1199
  1200         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1201         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1202         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1203         16  CF-CO-OPTION-START-DATE        PIC XX.
  1204         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1205           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1206                                                      '3' '4'.
  1207           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1208           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1209           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1210           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1211           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1212           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1213
  1214         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1215
  1216         16  CF-PAYMENT-APPROVAL-LEVELS.
  1217             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1218             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1219             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1220             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1221             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1222             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1223
  1224         16  CF-END-USER-REPORTING-USER     PIC X.
  1225             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1226             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1227
  1228         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1229             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1230             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1231
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  23
* ELVADS.cbl
  1232         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1233
  1234         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1235         16  FILLER                         PIC X.
  1236
  1237         16  CF-CREDIT-ARCHIVE-CNTL.
  1238             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1239             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1240             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1241
  1242         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1243
  1244         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1245             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1246             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1247
  1248         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1249             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1250             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1251
  1252         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1253
  1254         16  CF-CO-ACH-ID-CODE              PIC  X.
  1255             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1256             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1257             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1258         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1259         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1260         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1261         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1262         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1263         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1264         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1265         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1266         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1267                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1268         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1269                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1270
  1271         16  CF-CO-OVER-SHORT.
  1272             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1273             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1274
  1275*         16  FILLER                         PIC X(102).
  1276         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1277             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1278             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1279
  1280         16  CF-AH-APPROVAL-DAYS.
  1281             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1282             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1283             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1284             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1285
  1286         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1287
  1288         16  CF-APPROV-LEV-5.
  1289             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  24
* ELVADS.cbl
  1290             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1291             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1292
  1293         16  FILLER                         PIC X(68).
  1294****************************************************************
  1295*             PROCESSOR/USER RECORD                            *
  1296****************************************************************
  1297
  1298     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1299         16  CF-PROCESSOR-NAME              PIC X(30).
  1300         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1301         16  CF-PROCESSOR-TITLE             PIC X(26).
  1302         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1303                 88  MESSAGE-YES                VALUE 'Y'.
  1304                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1305
  1306*****************************************************
  1307****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1308****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1309****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1310****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1311*****************************************************
  1312
  1313         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1314             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1315             20  CF-APPLICATION-FORCE       PIC X.
  1316             20  CF-INDIVIDUAL-APP.
  1317                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1318                     28  CF-BROWSE-APP      PIC X.
  1319                     28  CF-UPDATE-APP      PIC X.
  1320
  1321         16  CF-CURRENT-TERM-ON             PIC X(4).
  1322         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1323             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1324             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1325             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1326             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1327             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1328             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1329             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1330         16  CF-PROCESSOR-CARRIER           PIC X.
  1331             88  NO-CARRIER-SECURITY            VALUE ' '.
  1332         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1333             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1334         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1335             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1336         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1337             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1338
  1339         16  CF-PROC-SYS-ACCESS-SW.
  1340             20  CF-PROC-CREDIT-CLAIMS-SW.
  1341                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1342                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1343                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1344                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1345             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1346                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1347                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  25
* ELVADS.cbl
  1348             20  CF-PROC-LIFE-GNRLDGR-SW.
  1349                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1350                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1351                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1352                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1353             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1354                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1355                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1356         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1357             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1358             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1359         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1360
  1361         16  CF-APPROVAL-LEVEL                  PIC X.
  1362             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1363             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1364             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1365             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1366             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1367
  1368         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1369
  1370         16  CF-LANGUAGE-TYPE                   PIC X.
  1371             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1372             88  CF-LANG-IS-FR                      VALUE 'F'.
  1373
  1374         16  CF-CSR-IND                         PIC X.
  1375         16  FILLER                             PIC X(239).
  1376
  1377****************************************************************
  1378*             PROCESSOR/REMINDERS RECORD                       *
  1379****************************************************************
  1380
  1381     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1382         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1383             20  CF-START-REMIND-DT         PIC XX.
  1384             20  CF-END-REMIND-DT           PIC XX.
  1385             20  CF-REMINDER-TEXT           PIC X(50).
  1386         16  FILLER                         PIC X(296).
  1387
  1388
  1389****************************************************************
  1390*             STATE MASTER RECORD                              *
  1391****************************************************************
  1392
  1393     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1394         16  CF-STATE-ABBREVIATION          PIC XX.
  1395         16  CF-STATE-NAME                  PIC X(25).
  1396         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1397         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1398             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1399             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1400             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1401             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1402                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1403                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1404             20  CF-ST-PREM-REJECT-SW       PIC X.
  1405                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  26
* ELVADS.cbl
  1406                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1407             20  CF-ST-REF-REJECT-SW        PIC X.
  1408                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1409                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1410         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1411         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1412         16  CF-ST-REFUND-RULES.
  1413             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1414             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1415             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1416         16  CF-ST-FST-PMT-EXTENSION.
  1417             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1418             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1419                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1420                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1421                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1422                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1423         16  CF-ST-STATE-CALL.
  1424             20  CF-ST-CALL-UNEARNED        PIC X.
  1425             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1426             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1427         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1428             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1429             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1430         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1431         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1432         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1433         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1434         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1435         16  FILLER                         PIC X.
  1436         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1437             20  CF-ST-BENEFIT-CD           PIC XX.
  1438             20  CF-ST-BENEFIT-KIND         PIC X.
  1439                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1440                 88  CF-ST-AH-KIND              VALUE 'A'.
  1441             20  CF-ST-REM-TERM-CALC        PIC X.
  1442                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1443                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1444                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1445                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1446                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1447                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1448                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1449                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1450
  1451             20  CF-ST-REFUND-CALC          PIC X.
  1452                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1453                 88  ST-REFD-BY-R78             VALUE '1'.
  1454                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1455                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1456                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1457                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1458                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1459                 88  ST-REFD-UTAH               VALUE '7'.
  1460                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1461                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1462                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1463
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  27
* ELVADS.cbl
  1464             20  CF-ST-EARNING-CALC         PIC X.
  1465                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1466                 88  ST-EARN-BY-R78             VALUE '1'.
  1467                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1468                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1469                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1470                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1471                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1472                 88  ST-EARN-MEAN               VALUE '8'.
  1473                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1474
  1475             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1476                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1477                 88  ST-OVRD-BY-R78             VALUE '1'.
  1478                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1479                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1480                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1481                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1482                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1483                 88  ST-OVRD-MEAN               VALUE '8'.
  1484                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1485             20  cf-st-extra-periods        pic 9.
  1486*            20  FILLER                     PIC X.
  1487
  1488         16  CF-ST-COMMISSION-CAPS.
  1489             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1490             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1491             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1492             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1493         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1494                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1495
  1496         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1497
  1498         16  CF-ST-STATUTORY-INTEREST.
  1499             20  CF-ST-STAT-DATE-FROM       PIC X.
  1500                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1501                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1502             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1503             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1504             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1505             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1506             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1507
  1508         16  CF-ST-OVER-SHORT.
  1509             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1510             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1511
  1512         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1513
  1514         16  CF-ST-RT-CALC                  PIC X.
  1515
  1516         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1517         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1518         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1519         16  CF-ST-RF-LR-CALC               PIC X.
  1520         16  CF-ST-RF-LL-CALC               PIC X.
  1521         16  CF-ST-RF-LN-CALC               PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  28
* ELVADS.cbl
  1522         16  CF-ST-RF-AH-CALC               PIC X.
  1523         16  CF-ST-RF-CP-CALC               PIC X.
  1524*        16  FILLER                         PIC X(206).
  1525*CIDMOD         16  FILLER                         PIC X(192).
  1526         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1527             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1528         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1529         16  CF-ST-VFY-2ND-BENE             PIC X.
  1530         16  CF-ST-CAUSAL-STATE             PIC X.
  1531         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1532         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1533         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1534             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1535         16  CF-ST-NET-ONLY-STATE           PIC X.
  1536             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1537         16  FILLER                         PIC X(181).
  1538
  1539****************************************************************
  1540*             BENEFIT MASTER RECORD                            *
  1541****************************************************************
  1542
  1543     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1544         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1545             20  CF-BENEFIT-CODE            PIC XX.
  1546             20  CF-BENEFIT-NUMERIC  REDEFINES
  1547                 CF-BENEFIT-CODE            PIC XX.
  1548             20  CF-BENEFIT-ALPHA           PIC XXX.
  1549             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1550             20  CF-BENEFIT-COMMENT         PIC X(10).
  1551
  1552             20  CF-LF-COVERAGE-TYPE        PIC X.
  1553                 88  CF-REDUCING                VALUE 'R'.
  1554                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1555
  1556             20  CF-SPECIAL-CALC-CD         PIC X.
  1557                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1558                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1559                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1560                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1561                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1562                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1563                 88  CF-FARM-PLAN               VALUE 'F'.
  1564                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1565                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1566                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1567                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1568                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1569                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1570                 88  CF-PRUDENTIAL              VALUE 'P'.
  1571                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1572                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1573                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1574                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1575                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1576                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1577
  1578             20  CF-JOINT-INDICATOR         PIC X.
  1579                 88  CF-JOINT-COVERAGE          VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  29
* ELVADS.cbl
  1580
  1581*            20  FILLER                     PIC X(12).
  1582             20  cf-maximum-benefits        pic s999 comp-3.
  1583             20  FILLER                     PIC X(09).
  1584             20  CF-BENEFIT-CATEGORY        PIC X.
  1585             20  CF-LOAN-TYPE               PIC X(8).
  1586
  1587             20  CF-CO-REM-TERM-CALC        PIC X.
  1588                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1589                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1590                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1591                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1592                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1593
  1594             20  CF-CO-EARNINGS-CALC        PIC X.
  1595                 88  CO-EARN-BY-R78             VALUE '1'.
  1596                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1597                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1598                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1599                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1600                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1601                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1602                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1603
  1604             20  CF-CO-REFUND-CALC          PIC X.
  1605                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1606                 88  CO-REFD-BY-R78             VALUE '1'.
  1607                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1608                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1609                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1610                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1611                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1612                 88  CO-REFD-MEAN               VALUE '8'.
  1613                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1614                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1615                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1616
  1617             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1618                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1619                 88  CO-OVRD-BY-R78             VALUE '1'.
  1620                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1621                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1622                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1623                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1624                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1625                 88  CO-OVRD-MEAN               VALUE '8'.
  1626                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1627
  1628             20  CF-CO-BEN-I-G-CD           PIC X.
  1629                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1630                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1631                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1632
  1633         16  FILLER                         PIC X(304).
  1634
  1635
  1636****************************************************************
  1637*             CARRIER MASTER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  30
* ELVADS.cbl
  1638****************************************************************
  1639
  1640     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1641         16  CF-ADDRESS-DATA.
  1642             20  CF-MAIL-TO-NAME            PIC X(30).
  1643             20  CF-IN-CARE-OF              PIC X(30).
  1644             20  CF-ADDRESS-LINE-1          PIC X(30).
  1645             20  CF-ADDRESS-LINE-2          PIC X(30).
  1646             20  CF-CITY-STATE              PIC X(30).
  1647             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1648             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1649
  1650         16  CF-CLAIM-NO-CONTROL.
  1651             20  CF-CLAIM-NO-METHOD         PIC X.
  1652                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1653                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1654                 88  CLAIM-NO-SEQ               VALUE '3'.
  1655                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1656             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1657                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1658                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1659                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1660
  1661         16  CF-CHECK-NO-CONTROL.
  1662             20  CF-CHECK-NO-METHOD         PIC X.
  1663                 88  CHECK-NO-MANUAL            VALUE '1'.
  1664                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1665                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1666                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1667             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1668                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1669
  1670         16  CF-DOMICILE-STATE              PIC XX.
  1671
  1672         16  CF-EXPENSE-CONTROLS.
  1673             20  CF-EXPENSE-METHOD          PIC X.
  1674                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1675                 88  DOLLARS-PER-PMT            VALUE '2'.
  1676                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1677                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1678             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1679             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1680
  1681         16  CF-CORRESPONDENCE-CONTROL.
  1682             20  CF-LETTER-RESEND-OPT       PIC X.
  1683                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1684                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1685             20  FILLER                     PIC X(4).
  1686
  1687         16  CF-RESERVE-CONTROLS.
  1688             20  CF-MANUAL-SW               PIC X.
  1689                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1690             20  CF-FUTURE-SW               PIC X.
  1691                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1692             20  CF-PTC-SW                  PIC X.
  1693                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1694             20  CF-IBNR-SW                 PIC X.
  1695                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  31
* ELVADS.cbl
  1696             20  CF-PTC-LF-SW               PIC X.
  1697                 88  CF-LF-PTC-USED             VALUE '1'.
  1698             20  CF-CDT-ACCESS-METHOD       PIC X.
  1699                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1700                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1701                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1702             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1703
  1704         16  CF-CLAIM-CALC-METHOD           PIC X.
  1705             88  360-PLUS-MONTHS                VALUE '1'.
  1706             88  365-PLUS-MONTHS                VALUE '2'.
  1707             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1708             88  360-DAILY                      VALUE '4'.
  1709             88  365-DAILY                      VALUE '5'.
  1710
  1711         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1712         16  FILLER                         PIC X(11).
  1713
  1714         16  CF-LIMIT-AMOUNTS.
  1715             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1716             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1717             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1718             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1719             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1720             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1721             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1722             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1723             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1724             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1725
  1726         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1727         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1728         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1729
  1730         16  CF-ZIP-CODE.
  1731             20  CF-ZIP-PRIME.
  1732                 24  CF-ZIP-1ST             PIC X.
  1733                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1734                 24  FILLER                 PIC X(4).
  1735             20  CF-ZIP-PLUS4               PIC X(4).
  1736         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1737             20  CF-CAN-POSTAL-1            PIC XXX.
  1738             20  CF-CAN-POSTAL-2            PIC XXX.
  1739             20  FILLER                     PIC XXX.
  1740
  1741         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1742         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1743         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1744
  1745         16  CF-RATING-SWITCH               PIC X.
  1746             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1747             88  CF-NO-RATING                   VALUE 'N'.
  1748
  1749         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1750
  1751         16  CF-CARRIER-OVER-SHORT.
  1752             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1753             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  32
* ELVADS.cbl
  1754
  1755         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1756         16  CF-SECPAY-SWITCH               PIC X.
  1757             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1758             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1759         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1760         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1761         16  FILLER                         PIC X(444).
  1762*        16  FILLER                         PIC X(452).
  1763
  1764
  1765****************************************************************
  1766*             MORTALITY MASTER RECORD                          *
  1767****************************************************************
  1768
  1769     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1770         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1771                                INDEXED BY CF-MORT-NDX.
  1772             20  CF-MORT-TABLE              PIC X(5).
  1773             20  CF-MORT-TABLE-TYPE         PIC X.
  1774                 88  CF-MORT-JOINT              VALUE 'J'.
  1775                 88  CF-MORT-SINGLE             VALUE 'S'.
  1776                 88  CF-MORT-COMBINED           VALUE 'C'.
  1777                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1778                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1779             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1780             20  CF-MORT-AGE-METHOD         PIC XX.
  1781                 88  CF-AGE-LAST                VALUE 'AL'.
  1782                 88  CF-AGE-NEAR                VALUE 'AN'.
  1783             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1784             20  CF-MORT-ADJUSTMENT-DIRECTION
  1785                                            PIC X.
  1786                 88  CF-MINUS                   VALUE '-'.
  1787                 88  CF-PLUS                    VALUE '+'.
  1788             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1789             20  CF-MORT-JOINT-CODE         PIC X.
  1790                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1791             20  CF-MORT-PC-Q               PIC X.
  1792                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1793             20  CF-MORT-TABLE-CODE         PIC X(4).
  1794             20  CF-MORT-COMMENTS           PIC X(15).
  1795             20  FILLER                     PIC X(14).
  1796
  1797         16  FILLER                         PIC X(251).
  1798
  1799
  1800****************************************************************
  1801*             BUSSINESS TYPE MASTER RECORD                     *
  1802****************************************************************
  1803
  1804     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1805* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1806* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1807* AND RECORD 05 IS TYPES 81-99
  1808         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1809             20  CF-BUSINESS-TITLE          PIC  X(19).
  1810             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1811                                            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  33
* ELVADS.cbl
  1812             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1813             20  FILLER                     PIC  X.
  1814         16  FILLER                         PIC  X(248).
  1815
  1816
  1817****************************************************************
  1818*             TERMINAL MASTER RECORD                           *
  1819****************************************************************
  1820
  1821     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1822
  1823         16  CF-COMPANY-TERMINALS.
  1824             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1825                                  PIC X(4).
  1826         16  FILLER               PIC X(248).
  1827
  1828
  1829****************************************************************
  1830*             LIFE EDIT MASTER RECORD                          *
  1831****************************************************************
  1832
  1833     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1834         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1835             20  CF-LIFE-CODE-IN            PIC XX.
  1836             20  CF-LIFE-CODE-OUT           PIC XX.
  1837         16  FILLER                         PIC X(248).
  1838
  1839
  1840****************************************************************
  1841*             AH EDIT MASTER RECORD                            *
  1842****************************************************************
  1843
  1844     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1845         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1846             20  CF-AH-CODE-IN              PIC XXX.
  1847             20  CF-AH-CODE-OUT             PIC XX.
  1848         16  FILLER                         PIC X(248).
  1849
  1850
  1851****************************************************************
  1852*             CREDIBILITY TABLES                               *
  1853****************************************************************
  1854
  1855     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1856         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1857                             INDEXED BY CF-CRDB-NDX.
  1858             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1859             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1860             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1861         16  FILLER                         PIC  X(332).
  1862
  1863
  1864****************************************************************
  1865*             REPORT CUSTOMIZATION RECORD                      *
  1866****************************************************************
  1867
  1868     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1869         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  34
* ELVADS.cbl
  1870             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1871             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1872             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1873**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1874****       A T-TRANSFER.                                   ****
  1875             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1876
  1877         16  FILLER                         PIC XX.
  1878
  1879         16  CF-CARRIER-CNTL-OPT.
  1880             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1881                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1882                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1883             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1884                                            PIC X.
  1885         16  CF-GROUP-CNTL-OPT.
  1886             20  CF-GROUP-OPT-SEQ           PIC 9.
  1887                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1888                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1889             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1890                                            PIC X(6).
  1891         16  CF-STATE-CNTL-OPT.
  1892             20  CF-STATE-OPT-SEQ           PIC 9.
  1893                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1894                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1895             20  CF-STATE-SELECT OCCURS 3 TIMES
  1896                                            PIC XX.
  1897         16  CF-ACCOUNT-CNTL-OPT.
  1898             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1899                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1900                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1901             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1902                                            PIC X(10).
  1903         16  CF-BUS-TYP-CNTL-OPT.
  1904             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1905                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1906                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1907             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1908                                            PIC XX.
  1909         16  CF-LF-TYP-CNTL-OPT.
  1910             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1911                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1912                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1913             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1914                                            PIC XX.
  1915         16  CF-AH-TYP-CNTL-OPT.
  1916             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1917                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1918                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1919             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1920                                            PIC XX.
  1921         16  CF-REPTCD1-CNTL-OPT.
  1922             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1923                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1924                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1925             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1926                                            PIC X(10).
  1927         16  CF-REPTCD2-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  35
* ELVADS.cbl
  1928             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1929                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1930                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1931             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1932                                            PIC X(10).
  1933         16  CF-USER1-CNTL-OPT.
  1934             20  CF-USER1-OPT-SEQ           PIC 9.
  1935                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1936                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1937             20  CF-USER1-SELECT OCCURS 3 TIMES
  1938                                            PIC X(10).
  1939         16  CF-USER2-CNTL-OPT.
  1940             20  CF-USER2-OPT-SEQ           PIC 9.
  1941                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1942                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1943             20  CF-USER2-SELECT OCCURS 3 TIMES
  1944                                            PIC X(10).
  1945         16  CF-USER3-CNTL-OPT.
  1946             20  CF-USER3-OPT-SEQ           PIC 9.
  1947                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1948                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1949             20  CF-USER3-SELECT OCCURS 3 TIMES
  1950                                            PIC X(10).
  1951         16  CF-USER4-CNTL-OPT.
  1952             20  CF-USER4-OPT-SEQ           PIC 9.
  1953                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1954                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1955             20  CF-USER4-SELECT OCCURS 3 TIMES
  1956                                            PIC X(10).
  1957         16  CF-USER5-CNTL-OPT.
  1958             20  CF-USER5-OPT-SEQ           PIC 9.
  1959                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1960                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1961             20  CF-USER5-SELECT OCCURS 3 TIMES
  1962                                            PIC X(10).
  1963         16  CF-REINS-CNTL-OPT.
  1964             20  CF-REINS-OPT-SEQ           PIC 9.
  1965                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1966                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1967             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1968                 24  CF-REINS-PRIME         PIC XXX.
  1969                 24  CF-REINS-SUB           PIC XXX.
  1970
  1971         16  CF-AGENT-CNTL-OPT.
  1972             20  CF-AGENT-OPT-SEQ           PIC 9.
  1973                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1974                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1975             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1976                                            PIC X(10).
  1977
  1978         16  FILLER                         PIC X(43).
  1979
  1980         16  CF-LOSS-RATIO-SELECT.
  1981             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1982             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1983         16  CF-ENTRY-DATE-SELECT.
  1984             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1985             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  36
* ELVADS.cbl
  1986         16  CF-EFFECTIVE-DATE-SELECT.
  1987             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1988             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1989
  1990         16  CF-EXCEPTION-LIST-IND          PIC X.
  1991             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1992
  1993         16  FILLER                         PIC X(318).
  1994
  1995****************************************************************
  1996*                  EXCEPTION REPORTING RECORD                  *
  1997****************************************************************
  1998
  1999     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2000         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2001             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2002
  2003         16  CF-COMBINED-LIFE-AH-OPT.
  2004             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2005             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2006             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2007             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2008
  2009         16  CF-LIFE-OPT.
  2010             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2011             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2012             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2013             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2014             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2015             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2016             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2017             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2018             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2019             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2020
  2021         16  CF-AH-OPT.
  2022             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2023             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2024             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2025             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2026             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2027             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2028             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2029             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2030             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2031             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2032
  2033         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2034             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2035             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2036             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2037
  2038         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2039
  2040         16  FILLER                         PIC X(673).
  2041
  2042
  2043****************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  37
* ELVADS.cbl
  2044*             MORTGAGE SYSTEM PLAN RECORD                      *
  2045****************************************************************
  2046
  2047     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2048         16  CF-PLAN-TYPE                   PIC X.
  2049             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2050             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2051             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2052         16  CF-PLAN-ABBREV                 PIC XXX.
  2053         16  CF-PLAN-DESCRIPT               PIC X(10).
  2054         16  CF-PLAN-NOTES                  PIC X(20).
  2055         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2056         16  CF-PLAN-UNDERWRITING.
  2057             20  CF-PLAN-TERM-DATA.
  2058                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2059                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2060             20  CF-PLAN-AGE-DATA.
  2061                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2062                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2063                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2064             20  CF-PLAN-BENEFIT-DATA.
  2065                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2066                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2067                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2068                                            PIC S9(7)V99  COMP-3.
  2069         16  CF-PLAN-POLICY-FORMS.
  2070             20  CF-POLICY-FORM             PIC X(12).
  2071             20  CF-MASTER-APPLICATION      PIC X(12).
  2072             20  CF-MASTER-POLICY           PIC X(12).
  2073         16  CF-PLAN-RATING.
  2074             20  CF-RATE-CODE               PIC X(5).
  2075             20  CF-SEX-RATING              PIC X.
  2076                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2077                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2078             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2079             20  CF-SUB-STD-TYPE            PIC X.
  2080                 88  CF-PCT-OF-PREM            VALUE '1'.
  2081                 88  CF-PCT-OF-BENE            VALUE '2'.
  2082         16  CF-PLAN-PREM-TOLERANCES.
  2083             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2084             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2085         16  CF-PLAN-PYMT-TOLERANCES.
  2086             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2087             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2088         16  CF-PLAN-MISC-DATA.
  2089             20  FILLER                     PIC X.
  2090             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2091             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2092         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2093         16  CF-PLAN-IND-GRP                PIC X.
  2094             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2095                                                     '1'.
  2096             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2097                                                     '2'.
  2098         16  CF-MIB-SEARCH-SW               PIC X.
  2099             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2100             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2101             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  38
* ELVADS.cbl
  2102             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2103         16  CF-ALPHA-SEARCH-SW             PIC X.
  2104             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2105             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2106             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2107             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2108             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2109             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2110             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2111             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2112             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2113             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2114                                                     'A' 'B' 'C'
  2115                                                     'X' 'Y' 'Z'.
  2116         16  CF-EFF-DT-RULE-SW              PIC X.
  2117             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2118             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2119             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2120             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2121             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2122         16  FILLER                         PIC X(4).
  2123         16  CF-HEALTH-QUESTIONS            PIC X.
  2124             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2125         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2126         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2127         16  CF-PLAN-SNGL-JNT               PIC X.
  2128             88  CF-COMBINED-PLAN              VALUE 'C'.
  2129             88  CF-JNT-PLAN                   VALUE 'J'.
  2130             88  CF-SNGL-PLAN                  VALUE 'S'.
  2131         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2132         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2133         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2134         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2135         16  CF-RERATE-CNTL                 PIC  X.
  2136             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2137             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2138             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2139             88  CF-AUTO-RECALC                 VALUE '4'.
  2140         16  CF-BENEFIT-TYPE                PIC  X.
  2141             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2142             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2143         16  CF-POLICY-FEE                  PIC S999V99
  2144                                                    COMP-3.
  2145         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2146         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2147         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2148         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2149         16  FILLER                         PIC  X(32).
  2150         16  CF-TERMINATION-FORM            PIC  X(04).
  2151         16  FILLER                         PIC  X(08).
  2152         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2153                                                       COMP-3.
  2154         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2155         16  CF-ISSUE-LETTER                PIC  X(4).
  2156         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2157         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2158             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2159             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  39
* ELVADS.cbl
  2160         16  CF-MP-REFUND-CALC              PIC X.
  2161             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2162             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2163             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2164             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2165             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2166             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2167             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2168             88  CF-MP-REFD-MEAN                VALUE '8'.
  2169         16  CF-ALT-RATE-CODE               PIC  X(5).
  2170
  2171
  2172         16  FILLER                         PIC X(498).
  2173****************************************************************
  2174*             MORTGAGE COMPANY MASTER RECORD                   *
  2175****************************************************************
  2176
  2177     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2178         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2179         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2180             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2181             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2182             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2183             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2184             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2185
  2186         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2187         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2188         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2189         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2190         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2191
  2192         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2193             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2194         16  CF-MP-RECON-USE-IND            PIC X(1).
  2195             88  CF-MP-USE-RECON             VALUE 'Y'.
  2196         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2197             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2198         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2199             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2200             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2201         16  FILLER                         PIC X(1).
  2202         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2203             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2204         16  CF-MORTG-MIB-VERSION           PIC X.
  2205             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2206             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2207             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2208         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2209             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2210                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2211             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2212                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2213             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2214                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2215             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2216                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2217             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  40
* ELVADS.cbl
  2218                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2219             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2220                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2221         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2222         16  FILLER                         PIC X(7).
  2223         16  CF-MORTG-DESTINATION-SYMBOL.
  2224             20  CF-MORTG-MIB-COMM          PIC X(5).
  2225             20  CF-MORTG-MIB-TERM          PIC X(5).
  2226         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2227             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2228         16  FILLER                         PIC X(03).
  2229         16  CF-MP-CHECK-NO-CONTROL.
  2230             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2231                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2232                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2233                                                ' ' LOW-VALUES.
  2234                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2235                                               VALUE '3'.
  2236         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2237         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2238         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2239             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2240                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2241             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2242                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2243             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2244                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2245             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2246                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2247             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2248                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2249             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2250                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2251         16  CF-MORTG-BILLING-AREA.
  2252             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2253                                            PIC X.
  2254         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2255         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2256         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2257         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2258             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2259             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2260         16  FILLER                         PIC X.
  2261         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2262             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2263             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2264         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2265         16  FILLER                         PIC X(8).
  2266         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2267         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2268         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2269         16  CF-ACH-COMPANY-ID.
  2270             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2271                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2272                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2273                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2274             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2275         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  41
* ELVADS.cbl
  2276             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2277         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2278             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2279             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2280         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2281         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2282         16  FILLER                         PIC X(536).
  2283
  2284****************************************************************
  2285*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2286****************************************************************
  2287
  2288     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2289         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2290             20  CF-FEMALE-HEIGHT.
  2291                 24  CF-FEMALE-FT           PIC 99.
  2292                 24  CF-FEMALE-IN           PIC 99.
  2293             20  CF-FEMALE-MIN-WT           PIC 999.
  2294             20  CF-FEMALE-MAX-WT           PIC 999.
  2295         16  FILLER                         PIC X(428).
  2296
  2297     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2298         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2299             20  CF-MALE-HEIGHT.
  2300                 24  CF-MALE-FT             PIC 99.
  2301                 24  CF-MALE-IN             PIC 99.
  2302             20  CF-MALE-MIN-WT             PIC 999.
  2303             20  CF-MALE-MAX-WT             PIC 999.
  2304         16  FILLER                         PIC X(428).
  2305******************************************************************
  2306*             AUTOMATIC ACTIVITY RECORD                          *
  2307******************************************************************
  2308     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2309         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2310             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2311             20  CF-SYS-LETTER-ID           PIC X(04).
  2312             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2313             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2314             20  CF-SYS-RESET-SW            PIC X(01).
  2315             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2316             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2317
  2318         16  FILLER                         PIC X(50).
  2319
  2320         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2321             20  CF-USER-ACTIVE-SW          PIC X(01).
  2322             20  CF-USER-LETTER-ID          PIC X(04).
  2323             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2324             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2325             20  CF-USER-RESET-SW           PIC X(01).
  2326             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2327             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2328             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2329
  2330         16  FILLER                         PIC X(246).
  2331*                                COPY ERCARCH.
  2332******************************************************************
  2333*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  42
* ELVADS.cbl
  2334*                            ERCARCH.                            *
  2335*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2336*                            VMOD=2.002                          *
  2337*                                                                *
  2338*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  2339*                                                                *
  2340*   FILE TYPE = VSAM,KSDS                                        *
  2341*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2342*                                                                *
  2343*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  2344*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  2345*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  2346*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  2347*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  2348*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  2349*                                                                *
  2350*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2351******************************************************************
  2352*                   C H A N G E   L O G
  2353*
  2354* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2355*-----------------------------------------------------------------
  2356*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2357* EFFECTIVE    NUMBER
  2358*-----------------------------------------------------------------
  2359* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2360* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  2361* 110612    2012101700002  AJRA  ADD NEW FIELDS
  2362******************************************************************
  2363 01  LETTER-ARCHIVE.
  2364     12  LA-RECORD-ID                PIC  X(02).
  2365         88  LA-VALID-ID                VALUE 'LA'.
  2366
  2367     12  LA-CONTROL-PRIMARY.
  2368         16  LA-COMPANY-CD           PIC  X(01).
  2369         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  2370
  2371     12  LA-CONTROL-BY-CERT-RESP.
  2372         16  LA-COMPANY-CD-A2        PIC  X(01).
  2373         16  LA-CERT-NO-A2.
  2374             20  LA-CERT-PRIME-A2    PIC  X(10).
  2375             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  2376         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  2377             20  LA-RESP-PERSON-A2   PIC  X(10).
  2378             20  LA-TYPE-A2          PIC  X(01).
  2379         16  LA-CARRIER-A2           PIC  X(01).
  2380         16  LA-GROUPING-A2          PIC  X(06).
  2381         16  LA-STATE-A2             PIC  X(02).
  2382         16  LA-ACCOUNT-A2           PIC  X(10).
  2383         16  LA-EFFECT-DATE-A2       PIC  X(02).
  2384         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  2385
  2386     12  LA-CONTROL-BY-FORM.
  2387         16  LA-COMPANY-CD-A3        PIC  X(01).
  2388         16  LA-FORM-A3              PIC  X(04).
  2389         16  LA-CARRIER-A3           PIC  X(01).
  2390         16  LA-GROUPING-A3          PIC  X(06).
  2391         16  LA-STATE-A3             PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  43
* ELVADS.cbl
  2392         16  LA-ACCOUNT-A3           PIC  X(10).
  2393         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  2394
  2395     12  LA-CONTROL-BY-PROCESSOR.
  2396         16  LA-COMPANY-CD-A4        PIC  X(01).
  2397         16  LA-PROCESSOR-CD         PIC  X(04).
  2398         16  LA-CARRIER-A4           PIC  X(01).
  2399         16  LA-GROUPING-A4          PIC  X(06).
  2400         16  LA-STATE-A4             PIC  X(02).
  2401         16  LA-ACCOUNT-A4           PIC  X(10).
  2402         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  2403
  2404     12  LA-CONTROL-BY-KEY-FIELDS.
  2405         16  LA-COMPANY-CD-A5        PIC  X(01).
  2406         16  LA-CARRIER-A5           PIC  X(01).
  2407         16  LA-GROUPING-A5          PIC  X(06).
  2408         16  LA-STATE-A5             PIC  X(02).
  2409         16  LA-ACCOUNT-A5           PIC  X(10).
  2410         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  2411
  2412     12  LA-CONTROL-BY-GROUP-CODE.
  2413         16  LA-COMPANY-CD-A6        PIC  X(01).
  2414         16  LA-ENTRY-A6.
  2415             20  LA-FILLER           PIC  X(02).
  2416             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  2417         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  2418
  2419     12  FILLER                      PIC  X(09).
  2420
  2421     12  LA-HEADER-RECORD.
  2422         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  2423         16  LA-CREATION-DATE        PIC  X(02).
  2424         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  2425         16  LA-FINAL-ACT-DATE       REDEFINES
  2426               LA-FOLLOW-UP-DATE     PIC  X(02).
  2427         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  2428         16  LA-NO-OF-COPIES         PIC S9(01).
  2429         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  2430         16  LA-REPLY-DATE           PIC  X(02).
  2431         16  LA-RESEND-DATES.
  2432             20  LA-RESEND-DATE      PIC  X(02).
  2433             20  LA-SENT-DATE        PIC  X(02).
  2434             20  FILLER              PIC  X(08).
  2435         16  LA-SOURCE-INFORMATION.
  2436             20  LA-DATA-SOURCE      PIC  X(01).
  2437             20  LA-ADDR-SOURCE      PIC  X(01).
  2438         16  LA-STATUS               PIC  X(01).
  2439             88  LA-STATUS-ACTIVE         VALUE 'A'.
  2440             88  LA-STATUS-COMPLETED      VALUE 'C'.
  2441             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  2442             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  2443             88  LA-STATUS-PURGED         VALUE 'P'.
  2444             88  LA-STATUS-VOIDED         VALUE 'V'.
  2445         16  LA-LAST-RESENT-PRINT-DATE
  2446                                     PIC  X(02).
  2447         16  LA-PRINT-RESTRICTION    PIC  X(01).
  2448             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  2449                                          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  44
* ELVADS.cbl
  2450             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  2451                                          VALUE 'F'.
  2452             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  2453                                          VALUE 'P'.
  2454         16  LA-PURGED-DATE          PIC  X(02).
  2455         16  LA-VOIDED-DATE          PIC  X(02).
  2456         16  LA-RESEND-LETR          PIC  X(4).
  2457         16  FILLER                  PIC  X(08).
  2458*        16  LA-RESEND-LETR-2        PIC  X(4).
  2459*        16  LA-RESEND-LETR-3        PIC  X(4).
  2460*        16  FILLER                  PIC  X(59).
  2461         16  LA-ARCHIVE-STATUS       PIC  X.
  2462             88  LA-TEMP                VALUE 'T'.
  2463             88  LA-QWS                 VALUE 'Q'.
  2464             88  LA-BATCH               VALUE 'B'.
  2465         16  LA-FINAL-ACT-IND        PIC  X(1).
  2466         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  2467         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  2468         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  2469                                     PIC X(4).
  2470         16  FILLER                  PIC  X(42).
  2471*        16  FILLER                  PIC  X(71).
  2472         16  LA-LAST-MAINT-DATE      PIC  X(2).
  2473         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  2474         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  2475                                     PIC  X(4).
  2476         16  LA-LAST-UPDATED-BY      PIC  X(4).
  2477
  2478******************************************************************
  2479*                                COPY ELCENCC.
  2480******************************************************************
  2481*                                                                *
  2482*                                                                *
  2483*                            ELCENCC                             *
  2484*                            VMOD=2.001                          *
  2485*                                                                *
  2486*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  2487*                                                                *
  2488*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  2489*   A NAPERSOFT DOCUMENT                                         *
  2490*                                                                *
  2491*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  2492*                                                                *
  2493*   FILE TYPE = VSAM,KSDS                                        *
  2494*   RECORD SIZE = 400   RECFORM = FIX                            *
  2495*                                                                *
  2496*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  2497*                                                                *
  2498*   LOG = NO                                                     *
  2499*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2500*                                                                *
  2501*                                                                *
  2502******************************************************************
  2503*                   C H A N G E   L O G
  2504*
  2505* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2506*-----------------------------------------------------------------
  2507*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  45
* ELVADS.cbl
  2508* EFFECTIVE    NUMBER
  2509*-----------------------------------------------------------------
  2510* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  2511* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  2512******************************************************************
  2513 01  ENCLOSURE-CODES.
  2514     12  NC-RECORD-ID                      PIC XX.
  2515         88  VALID-NC-ID                      VALUE 'NC'.
  2516     12  NC-CONTROL-PRIMARY.
  2517         16  NC-COMPANY-CD                 PIC X.
  2518         16  NC-REC-TYPE                   PIC X.
  2519             88  NC-CLAIMS                   VALUE '1'.
  2520             88  NC-ADMIN                    VALUE '2'.
  2521         16  NC-ENC-CODE                   PIC X(5).
  2522         16  FILLER                        PIC X(09).
  2523     12  NC-MAINT-INFORMATION.
  2524         16  NC-LAST-MAINT-DT              PIC XX.
  2525         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2526         16  NC-LAST-MAINT-USER            PIC X(4).
  2527         16  FILLER                        PIC XX.
  2528     12  NC-OUTPUT-STACK                   PIC XXX.
  2529     12  NC-ENCLOSURE-LINE                 PIC X(100).
  2530     12  NC-ATTACHMENTS                    PIC X(255).
  2531     12  NC-FUTURE                         PIC X(12).
  2532******************************************************************
  2533*                                COPY NSCASEXTR.
  2534******************************************************************
  2535*                                                                *
  2536*                                                                *
  2537*                            NSCASEXTR.                          *
  2538*                            VMOD=2.001                          *
  2539*                                                                *
  2540*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
  2541*                                                                *
  2542*   FILE TYPE = VSAM,KSDS                                        *
  2543*   RECORD SIZE = 4500 RECFORM = FIXED                           *
  2544*                                                                *
  2545*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
  2546*                                                                *
  2547*   LOG = NO                                                     *
  2548*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2549******************************************************************
  2550*-----------------------------------------------------------------
  2551*                   C H A N G E   L O G
  2552*
  2553* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2554*-----------------------------------------------------------------
  2555*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2556* EFFECTIVE    NUMBER
  2557*-----------------------------------------------------------------
  2558* 072211    2011022800001  PEMA  NEW FILE
  2559*-----------------------------------------------------------------
  2560 01 NSAS-EXTRACT-RECORD.
  2561    05  NSAS-CONTROL-PRIMARY.
  2562        10  NSAS-COMPANY-CD      PIC X.
  2563        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
  2564        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
  2565    05  NSAS-LETTER-VARIABLES    PIC X(4350).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  46
* ELVADS.cbl
  2566    05  FILLER                   PIC X(143).
  2567     01  WS-PASS-AREA.
  2568         05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
  2569         05  WS-COMMAREA.
  2570             10  WS-PASS-VADS-REC    PIC X(350).
  2571****************************************************************
  2572*
  2573* Copyright (c) 2007-2013 Dell Inc.
  2574* All rights reserved.
  2575*
  2576****************************************************************
  2577 01  DFHEIV.
  2578   02  DFHEIV0               PIC X(35).
  2579   02  DFHEIV1               PIC X(08).
  2580   02  DFHEIV2               PIC X(08).
  2581   02  DFHEIV3               PIC X(08).
  2582   02  DFHEIV4               PIC X(06).
  2583   02  DFHEIV5               PIC X(04).
  2584   02  DFHEIV6               PIC X(04).
  2585   02  DFHEIV7               PIC X(02).
  2586   02  DFHEIV8               PIC X(02).
  2587   02  DFHEIV9               PIC X(01).
  2588   02  DFHEIV10              PIC S9(7) COMP-3.
  2589   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2590   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2591   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2592   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2593   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2594   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2595   02  DFHEIV17              PIC X(04).
  2596   02  DFHEIV18              PIC X(04).
  2597   02  DFHEIV19              PIC X(04).
  2598   02  DFHEIV20              USAGE IS POINTER.
  2599   02  DFHEIV21              USAGE IS POINTER.
  2600   02  DFHEIV22              USAGE IS POINTER.
  2601   02  DFHEIV23              USAGE IS POINTER.
  2602   02  DFHEIV24              USAGE IS POINTER.
  2603   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2604   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2605   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2606   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2607   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2608   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2609   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2610   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2611   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2612   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2613   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2614   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2615   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2616   02  FILLER                PIC X(02).
  2617   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2618   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2619   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2620   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2621   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2622   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2623   02  DFHEIVL5              PIC X(255) VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  47
* ELVADS.cbl
  2624 LINKAGE  SECTION.
  2625*****************************************************************
  2626*                                                               *
  2627* Copyright (c) 2007-2013 Dell Inc.                             *
  2628* All rights reserved.                                          *
  2629*                                                               *
  2630*****************************************************************
  2631 01  dfheiblk.
  2632     02  eibtime          pic s9(7) comp-3.
  2633     02  eibdate          pic s9(7) comp-3.
  2634     02  eibtrnid         pic x(4).
  2635     02  eibtaskn         pic s9(7) comp-3.
  2636     02  eibtrmid         pic x(4).
  2637     02  dfheigdi         pic s9(4) comp.
  2638     02  eibcposn         pic s9(4) comp.
  2639     02  eibcalen         pic s9(4) comp.
  2640     02  eibaid           pic x(1).
  2641     02  eibfiller1       pic x(1).
  2642     02  eibfn            pic x(2).
  2643     02  eibfiller2       pic x(2).
  2644     02  eibrcode         pic x(6).
  2645     02  eibfiller3       pic x(2).
  2646     02  eibds            pic x(8).
  2647     02  eibreqid         pic x(8).
  2648     02  eibrsrce         pic x(8).
  2649     02  eibsync          pic x(1).
  2650     02  eibfree          pic x(1).
  2651     02  eibrecv          pic x(1).
  2652     02  eibsend          pic x(1).
  2653     02  eibatt           pic x(1).
  2654     02  eibeoc           pic x(1).
  2655     02  eibfmh           pic x(1).
  2656     02  eibcompl         pic x(1).
  2657     02  eibsig           pic x(1).
  2658     02  eibconf          pic x(1).
  2659     02  eiberr           pic x(1).
  2660     02  eibrldbk         pic x(1).
  2661     02  eiberrcd         pic x(4).
  2662     02  eibsynrb         pic x(1).
  2663     02  eibnodat         pic x(1).
  2664     02  eibfiller5       pic x(2).
  2665     02  eibresp          pic s9(8) comp.
  2666     02  eibresp2         pic s9(8) comp.
  2667     02  dfheigdj         pic s9(4) comp.
  2668     02  dfheigdk         pic s9(4) comp.
  2669
  2670 01  DFHCOMMAREA                     PIC X(1000).
  2671 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  2672 0000-DFHEXIT SECTION.
  2673     MOVE '9#                    $   ' TO DFHEIV0.
  2674     MOVE 'ELVADS' TO DFHEIV1.
  2675     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2676
  2677     MOVE DFHCOMMAREA          TO  WS-PASS-AREA.
  2678
  2679     MOVE WS-PASS-VADS-REC       TO VIRGINIA-DISCLOSURE
  2680     MOVE SPACES                 TO WS-CALC-SWITCHES
  2681     MOVE VD-COMPANY-CD          TO WS-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  48
* ELVADS.cbl
  2682     MOVE VD-LETTER-ID           TO VA-LETTER
  2683     MOVE VD-CARRIER             TO VA-CARRIER
  2684     MOVE VD-GROUPING            TO VA-GROUPING
  2685     MOVE VD-STATE               TO VA-STATE
  2686     MOVE VD-ACCOUNT             TO VA-ACCOUNT
  2687     MOVE VD-INSURED-LAST-NAME   TO VA-LASTNAME
  2688     MOVE VD-INSURED-FIRST-NAME  TO VA-FIRSTNAME
  2689     MOVE VD-INSURED-MIDDLE-INIT TO VA-MIDINIT
  2690     MOVE VD-INSURED-ADDRESS-1   TO VA-ADDR1
  2691     MOVE VD-INSURED-ADDRESS-2   TO VA-ADDR2
  2692     MOVE VD-INSURED-CITY        TO VA-ADDR-CITY
  2693     MOVE VD-INSURED-STATE       TO VA-ADDR-ST
  2694     MOVE VD-INSURED-ZIP-CODE    TO VA-ADDR-ZIP
  2695     MOVE VD-JOINT-LAST-NAME     TO VA-JNT-LASTNAME
  2696     MOVE VD-JOINT-FIRST-NAME    TO VA-JNT-FIRSTNAME
  2697     MOVE VD-JOINT-MIDDLE-INIT   TO VA-JNT-MIDINIT
  2698     IF VD-LF-BENEFIT-CD = '01' OR '03'
  2699        SET GROSS-CERT           TO TRUE
  2700        SET CALC-LF-GROSS        TO TRUE
  2701        SET CALC-LF-NET          TO TRUE
  2702     END-IF
  2703     IF VD-LF-BENEFIT-CD = '05' OR '06'
  2704        SET NET-CERT             TO TRUE
  2705        SET CALC-LF-NET          TO TRUE
  2706     END-IF
  2707     IF VD-LF-BENEFIT-CD = '02' OR '04'
  2708        SET CALC-LF-LEVEL        TO TRUE
  2709        SET LEVEL-CERT           TO TRUE
  2710     END-IF
  2711     IF VD-AH-BENEFIT-CD NOT = '00' AND '  '
  2712        SET CALC-AH              TO TRUE
  2713     END-IF
  2714     IF (VD-LF-BENEFIT-CD = '00' OR '  ')
  2715        AND (VD-AH-BENEFIT-CD NOT = '00' AND '  ')
  2716        SET AH-ONLY              TO TRUE
  2717     END-IF
  2718     MOVE VD-LF-PREMIUM-AMT      TO LFPREM
  2719     MOVE VD-AH-PREMIUM-AMT      TO AHPREM
  2720     MOVE VD-LF-BENEFIT-AMT      TO LFAMT
  2721     IF VD-LF-BENEFIT-CD NOT = '00' AND '  '
  2722        MOVE VD-LF-TERM          TO N
  2723     ELSE
  2724        MOVE VD-AH-TERM          TO N
  2725     END-IF
  2726     MOVE VD-LOAN-TERM           TO M
  2727     IF M = 0
  2728        MOVE N                   TO M
  2729     END-IF
  2730     COMPUTE I = VD-LOAN-APR / +1200
  2731     if i = zeros
  2732        move .0000000001         to i
  2733     end-if
  2734     MOVE ZEROS                  TO Z
  2735     MOVE +30                    TO T
  2736     MOVE +3.63                  TO ANNUAL-DISCOUNT
  2737     MOVE VD-CERT-EFF-DT         TO DC-BIN-DATE-1
  2738     MOVE VD-1ST-PMT-DT          TO DC-BIN-DATE-2
  2739     MOVE '1'                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  49
* ELVADS.cbl
  2740     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  2741     IF NO-CONVERSION-ERROR
  2742        COMPUTE D = (DC-ELAPSED-MONTHS * 30) + DC-ODD-DAYS-OVER
  2743     END-IF
  2744     IF VD-AH-BENEFIT-CD NOT = '  ' AND '00'
  2745        MOVE VD-AH-RATE          TO AHRATE
  2746     END-IF
  2747     IF GROSS-CERT OR LEVEL-CERT
  2748        COMPUTE LF-RATE = VD-LF-RATE / (N / 12)
  2749     END-IF
  2750     IF NET-CERT
  2751        MOVE VD-LF-RATE          TO OBRATE
  2752     END-IF
  2753     IF GROSS-CERT
  2754        PERFORM 1000-GET-ERRATE  THRU 1000-EXIT
  2755     END-IF
  2756     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  2757     COMPUTE DISC = ANNUAL-DISCOUNT / 1200
  2758     COMPUTE V-M = (1 / (1 + I)) ** N
  2759     COMPUTE VM = (1 / (1 + I)) ** M
  2760     COMPUTE VM-N = (1 / (1 + I)) ** (M - N)
  2761     COMPUTE V = 1 / (1 + I)
  2762     COMPUTE X = 1 / (1 + DISC)
  2763     COMPUTE Y = (1 + (D * I / T)) / (1 + I)
  2764     COMPUTE ANGLENY = ANGLEN / Y
  2765     COMPUTE LF = ((1 + (Z * I)) / I)
  2766        * (((X ** N - 1) / (X - 1))
  2767        - ((X ** N * VM-N - VM) / (X * (1 + I) - 1)))
  2768        * (OBRATE / 1000)
  2769*    COMPUTE LFA = (1 + (Z * I)) / I
  2770*    COMPUTE LFB = X ** N - 1
  2771*    COMPUTE LFC = X - 1
  2772*    COMPUTE LFD = LFB / LFC
  2773*    COMPUTE LFE = (((X ** N) * (V ** (M - N))) - (V ** M)) /
  2774*       ((X * (1 + I)) - 1)
  2775*    COMPUTE LF = LFA * (LFD - LFE) * (OBRATE / 1000)
  2776     COMPUTE R = LFAMT / (ANGLENY - LF - N * AHRATE / 100)
  2777     COMPUTE SP = (LF * 100) / (ANGLENY * (1 + (Z * I)))
  2778     COMPUTE LDPN = SP * R * ANGLENY * (1 + (Z * I)) / 100
  2779     COMPUTE AHPN = R * N * AHRATE / 100
  2780     COMPUTE Y = (1 + (D * I / T)) / (1 + I)
  2781     COMPUTE ANGLENY = ANGLEN / Y
  2782     IF GROSS-CERT
  2783        COMPUTE CUR-PMT = LFAMT / VD-LF-TERM
  2784        COMPUTE AMT-FINANCED = CUR-PMT * ANGLEN
  2785        COMPUTE PRINC-AMT = AMT-FINANCED - LFPREM - AHPREM
  2786     ELSE
  2787        IF NET-CERT
  2788           COMPUTE PRINC-AMT = LFAMT - LFPREM - AHPREM
  2789           MOVE LFAMT TO AMT-FINANCED
  2790        END-IF
  2791     END-IF
  2792     MOVE 000000.00              TO VA-CL-NET-AMT
  2793                                    VA-CL-GRS-AMT
  2794                                    VA-CL-LEV-AMT
  2795                                    VA-CD-NET-AMT
  2796                                    VA-CD-GRS-AMT
  2797                                    VA-CD-LEV-AMT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  50
* ELVADS.cbl
  2798                                    VA-CLD-NET-AMT
  2799                                    VA-CLD-GRS-AMT
  2800                                    VA-CLD-LEV-AMT
  2801                                    VA-NO-NET-AMT
  2802                                    VA-NO-GRS-AMT
  2803                                    VA-NO-LEV-AMT
  2804     MOVE 00000.00               TO VA-CL-NET-PMT
  2805                                    VA-CL-GRS-PMT
  2806                                    VA-CL-LEV-PMT
  2807                                    VA-CD-NET-PMT
  2808                                    VA-CD-GRS-PMT
  2809                                    VA-CD-LEV-PMT
  2810                                    VA-CLD-NET-PMT
  2811                                    VA-CLD-GRS-PMT
  2812                                    VA-CLD-LEV-PMT
  2813                                    VA-NO-NET-PMT
  2814                                    VA-NO-GRS-PMT
  2815                                    VA-NO-LEV-PMT
  2816     MOVE 00000.00               TO VA-CL-NET-PRM
  2817                                    VA-CL-GRS-PRM
  2818                                    VA-CL-LEV-PRM
  2819                                    VA-CD-NET-PRM
  2820                                    VA-CD-GRS-PRM
  2821                                    VA-CD-LEV-PRM
  2822                                    VA-CLD-NET-PRM
  2823                                    VA-CLD-GRS-PRM
  2824                                    VA-CLD-LEV-PRM
  2825                                    VA-NO-NET-PRM
  2826                                    VA-NO-GRS-PRM
  2827                                    VA-NO-LEV-PRM
  2828     IF NET-CERT
  2829        PERFORM 2000-BUILD-NET-AMTS
  2830                                 THRU 2000-EXIT
  2831     END-IF
  2832     IF GROSS-CERT
  2833        PERFORM 2000-BUILD-NET-AMTS
  2834                                 THRU 2000-EXIT
  2835        PERFORM 3000-BUILD-GROSS-AMTS
  2836                                 THRU 3000-EXIT
  2837     END-IF
  2838     IF LEVEL-CERT
  2839        PERFORM 4000-BUILD-LEVEL-AMTS
  2840                                 THRU 4000-EXIT
  2841     END-IF
  2842     IF AH-ONLY
  2843        PERFORM 3500-BUILD-AH-AMTS
  2844                                 THRU 3500-EXIT
  2845     END-IF
  2846     STRING VD-INSURED-FIRST-NAME ' '
  2847        VD-INSURED-LAST-NAME DELIMITED BY '  '
  2848        INTO VA-BORROWER
  2849     END-STRING
  2850     MOVE VD-CERT-NO             TO VA-CERT-NO
  2851     MOVE VD-ACCOUNT-NAME        TO VA-ACCT-NAME
  2852     MOVE VD-BENEFICIARY-NAME    TO VA-BENE
  2853     IF VD-LF-BENEFIT-CD = '03' OR '04' OR '06'
  2854        MOVE 'X'                 TO VA-JL
  2855     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  51
* ELVADS.cbl
  2856        IF VD-LF-BENEFIT-CD NOT = '00' AND '  '
  2857           MOVE 'X'              TO VA-SL
  2858        END-IF
  2859     END-IF
  2860     IF GROSS-CERT
  2861        MOVE 'X'                 TO VA-GD
  2862     ELSE
  2863        IF LEVEL-CERT
  2864           MOVE 'X'              TO VA-LL
  2865        ELSE
  2866           IF NET-CERT
  2867              MOVE 'X'           TO VA-NP
  2868           END-IF
  2869        END-IF
  2870     END-IF
  2871     IF CALC-AH
  2872        MOVE 'X'                 TO VA-SA
  2873        EVALUATE TRUE
  2874         WHEN VD-AH-BENEFIT-CD = '53' OR '54' OR
  2875           '55' OR '56' OR '57'
  2876           MOVE 'X'              TO VA-JA
  2877           MOVE ' '              TO VA-SA
  2878         WHEN VD-AH-BENEFIT-CD = '03' OR '53'
  2879           MOVE 'X'              TO VA-7R
  2880         WHEN VD-AH-BENEFIT-CD = '01' OR '54'
  2881           MOVE 'X'              TO VA-14R
  2882         WHEN VD-AH-BENEFIT-CD = '05' OR '56'
  2883           MOVE 'X'              TO VA-14E
  2884         WHEN VD-AH-BENEFIT-CD = '04' OR '55'
  2885           MOVE 'X'              TO VA-30R
  2886         WHEN VD-AH-BENEFIT-CD = '02' OR '57'
  2887           MOVE 'X'              TO VA-30E
  2888        END-EVALUATE
  2889     END-IF
  2890*    MOVE 'X'                    TO VA-SL VA-JL VA-SA VA-JA VA-GD
  2891*       VA-NP VA-7R VA-LL VA-TN VA-14R VA-14E VA-30R VA-30E
  2892     MOVE VD-CERT-EFF-DT         TO DC-BIN-DATE-1
  2893     MOVE SPACE                  TO DC-OPTION-CODE
  2894     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  2895     IF NO-CONVERSION-ERROR
  2896        STRING DC-GREG-DATE-CYMD-R (5:2) '/'
  2897               DC-GREG-DATE-CYMD-R (7:2) '/'
  2898               DC-GREG-DATE-CYMD-R (1:4) DELIMITED BY SIZE
  2899           INTO VA-EFFDATE
  2900        END-STRING
  2901     ELSE
  2902        MOVE '00/00/0000'        TO VA-EFFDATE
  2903     END-IF
  2904     PERFORM 4100-CREATE-ARCHIVE THRU 4100-EXIT.
  2905     GO TO 8000-RETURN
  2906     .
  2907 1000-GET-ERRATE.
  2908     MOVE ALL '9'                TO ERRATE-KEY
  2909     MOVE VD-COMPANY-CD          TO RATE-COMPANY-CD
  2910     MOVE ZEROS                  TO RATE-STATE-CODE
  2911     MOVE VD-STATE               TO RATE-ST-CODE
  2912     MOVE 'L'                    TO RATE-L-AH
  2913     IF GROSS-CERT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  52
* ELVADS.cbl
  2914        IF VD-LF-BENEFIT-CD = '01'
  2915           MOVE '05'             TO RATE-LAH-NUM
  2916        ELSE
  2917           MOVE '06'             TO RATE-LAH-NUM
  2918        END-IF
  2919     END-IF
  2920     IF NET-CERT
  2921        IF VD-LF-BENEFIT-CD = '05'
  2922           MOVE '01'             TO RATE-LAH-NUM
  2923        ELSE
  2924           MOVE '03'             TO RATE-LAH-NUM
  2925        END-IF
  2926     END-IF
  2927     MOVE 99                     TO RATE-HIGH-AGE
  2928     MOVE VD-LF-BENEFIT-AMT    TO RATE-HIGH-AMT
  2929     MOVE VD-CERT-EFF-DT         TO DC-BIN-DATE-1
  2930     MOVE SPACE                  TO DC-OPTION-CODE
  2931     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  2932     IF NO-CONVERSION-ERROR
  2933        MOVE ZEROS               TO RATE-EXPIRY-DATE
  2934                                    WS-HOLD-RATE-EXP-DT
  2935        MOVE DC-GREG-DATE-CYMD   TO WS-HOLD-RATE-EXP-AL(4:8)
  2936        MOVE WS-HOLD-RATE-EXP-DT TO RATE-EXPIRY-DATE
  2937        MOVE ERRATE-KEY          TO SAVE-ERRATE-KEY
  2938     ELSE
  2939        MOVE 00099999999         TO RATE-EXPIRY-DATE
  2940     END-IF
  2941     PERFORM 1010-STARTBR-ERRATE THRU 1010-EXIT
  2942     IF RESP-NORMAL
  2943       PERFORM UNTIL
  2944        (FOUND-VA-RATE)
  2945        OR (NO-VA-RATE-FOUND)
  2946        OR (NOT RESP-NORMAL)
  2947        PERFORM 1020-READNEXT-ERRATE
  2948                                 THRU 1020-EXIT
  2949        IF (RT-STATE-CODE = SVRT-STATE-CODE)
  2950           AND (RT-L-AH-CODE = SVRT-L-AH-CODE)
  2951           IF (RT-HIGH-AMT > SVRT-HIGH-AMT)
  2952              AND (RT-EXPIRY-DATE > SVRT-EXPIRY-DATE)
  2953              SET FOUND-VA-RATE     TO TRUE
  2954              IF SVRT-LAH-NUM = '05' OR '06'
  2955                 MOVE RT-DISCOUNT-OB-RATE
  2956                                 TO OBRATE
  2957              ELSE
  2958                 COMPUTE LF-RATE = RT-L-RATE (N) / (N / 12)
  2959              END-IF
  2960           END-IF
  2961        ELSE
  2962           SET NO-VA-RATE-FOUND  TO TRUE
  2963        END-IF
  2964       END-PERFORM
  2965     END-IF
  2966     .
  2967 1000-EXIT.
  2968     EXIT.
  2969 1010-STARTBR-ERRATE.
  2970
  2971* EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  53
* ELVADS.cbl
  2972*       DATASET    ('ERRATE')
  2973*       RIDFLD     (ERRATE-KEY)
  2974*       RESP       (WS-RESPONSE)
  2975*    END-EXEC
  2976     MOVE 'ERRATE' TO DFHEIV1
  2977     MOVE 0
  2978       TO DFHEIV11
  2979*    MOVE '&,         G          &  N#00002966' TO DFHEIV0
  2980     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2981     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2982     MOVE X'204E233030303032393636' TO DFHEIV0(25:11)
  2983     CALL 'kxdfhei1' USING DFHEIV0,
  2984           DFHEIV1,
  2985           ERRATE-KEY,
  2986           DFHEIV99,
  2987           DFHEIV11,
  2988           DFHEIV99
  2989     MOVE EIBRESP  TO WS-RESPONSE
  2990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2991     .
  2992 1010-EXIT.
  2993     EXIT.
  2994 1020-READNEXT-ERRATE.
  2995
  2996* EXEC CICS READNEXT
  2997*       DATASET    ('ERRATE')
  2998*       RIDFLD     (ERRATE-KEY)
  2999*       INTO       (RATE-RECORD)
  3000*       RESP       (WS-RESPONSE)
  3001*    END-EXEC
  3002     MOVE LENGTH OF
  3003      RATE-RECORD
  3004       TO DFHEIV12
  3005     MOVE 'ERRATE' TO DFHEIV1
  3006     MOVE 0
  3007       TO DFHEIV11
  3008*    MOVE '&.IL                  )  N#00002975' TO DFHEIV0
  3009     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3010     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3011     MOVE X'204E233030303032393735' TO DFHEIV0(25:11)
  3012     CALL 'kxdfhei1' USING DFHEIV0,
  3013           DFHEIV1,
  3014           RATE-RECORD,
  3015           DFHEIV12,
  3016           ERRATE-KEY,
  3017           DFHEIV99,
  3018           DFHEIV11,
  3019           DFHEIV99,
  3020           DFHEIV99
  3021     MOVE EIBRESP  TO WS-RESPONSE
  3022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3023     .
  3024 1020-EXIT.
  3025     EXIT.
  3026 2000-BUILD-NET-AMTS.
  3027     COMPUTE WS-NET-PMT-1 = PRINC-AMT / (ANGLEN - LF)
  3028     IF AHRATE NOT = ZEROS
  3029        COMPUTE WS-NET-PMT-2 = PRINC-AMT /
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  54
* ELVADS.cbl
  3030         (ANGLEN - (N * AHRATE / 100))
  3031     END-IF
  3032     COMPUTE WS-NET-PMT-3 = PRINC-AMT /
  3033       (ANGLEN - LF - (N * AHRATE / 100))
  3034     COMPUTE WS-NET-PMT-4 = PRINC-AMT / ANGLEN
  3035     COMPUTE WS-NET-PREM-1 = SP * WS-NET-PMT-1 * ANGLEN *
  3036       (1 + (Z * I)) / 100
  3037     COMPUTE WS-NET-PREM-2 = WS-NET-PMT-2 * N * AHRATE / 100
  3038     COMPUTE WS-NET-PREM-3 = (SP * WS-NET-PMT-3 * ANGLEN *
  3039       (1 + (Z * I)) / 100) + (WS-NET-PMT-3 * N * AHRATE / 100)
  3040     IF (VD-LF-BENEFIT-CD NOT = '00' AND '  ')
  3041        AND (VD-AH-BENEFIT-CD = '00' OR '  ')
  3042        COMPUTE VA-CL-NET-AMT = PRINC-AMT + WS-NET-PREM-1
  3043        MOVE WS-NET-PMT-1        TO VA-CL-NET-PMT
  3044        MOVE WS-NET-PREM-1       TO VA-CL-NET-PRM
  3045     END-IF
  3046     IF (VD-LF-BENEFIT-CD = '00' OR '  ')
  3047        AND (VD-AH-BENEFIT-CD NOT = '00' AND '  ')
  3048        IF WS-NET-PREM-2 NOT = ZEROS
  3049           COMPUTE VA-CD-NET-AMT = PRINC-AMT + WS-NET-PREM-2
  3050        END-IF
  3051        MOVE WS-NET-PMT-2        TO VA-CD-NET-PMT
  3052        MOVE WS-NET-PREM-2       TO VA-CD-NET-PRM
  3053     END-IF
  3054     IF (VD-LF-BENEFIT-CD NOT = '00' AND '  ')
  3055        AND (VD-AH-BENEFIT-CD NOT = '00' AND '  ')
  3056        COMPUTE VA-CLD-NET-AMT = PRINC-AMT + WS-NET-PREM-3
  3057        MOVE WS-NET-PMT-3        TO VA-CLD-NET-PMT
  3058        MOVE WS-NET-PREM-3       TO VA-CLD-NET-PRM
  3059     END-IF
  3060     MOVE PRINC-AMT              TO VA-NO-NET-AMT
  3061     MOVE WS-NET-PMT-4           TO VA-NO-NET-PMT
  3062     MOVE WS-NET-PREM-4           TO VA-NO-NET-PRM
  3063     .
  3064 2000-EXIT.
  3065     EXIT.
  3066 3000-BUILD-GROSS-AMTS.
  3067*    COMPUTE WS-GROSS-PMT-1 = PRINC-AMT /
  3068*      (ANGLENY - (N * (N + ((D - T) / T)) / 12 * LF-RATE / 100))
  3069*    COMPUTE WS-GROSS-PMT-1 = AMT-FINANCED / ANGLEN
  3070     COMPUTE WS-GROSS-PMT-1 = PRINC-AMT / (ANGLEN -
  3071       (N * N / 12 * LF-RATE / 100))
  3072*    COMPUTE WS-GROSS-PMT-2 = PRINC-AMT /
  3073*      (ANGLENY - (N * AHRATE / 100))
  3074     COMPUTE WS-GROSS-PMT-2 = PRINC-AMT /
  3075       (ANGLEN - (N * AHRATE / 100))
  3076*    COMPUTE WS-GROSS-PMT-3 = PRINC-AMT /
  3077*      (ANGLENY - ((N * (N + ((D - T) / T)) /
  3078*      12 * LF-RATE / 100) + (N * AHRATE / 100)))
  3079*    COMPUTE WS-GROSS-PMT-3 = (AMT-FINANCED / ANGLEN)
  3080*      + (N * AHRATE / 100)
  3081     COMPUTE WS-GROSS-PMT-3 = PRINC-AMT /
  3082        (ANGLEN - ((N * N / 12 * LF-RATE / 100)
  3083       + (N * AHRATE / 100)))
  3084*    COMPUTE WS-GROSS-PMT-4 = PRINC-AMT / ANGLENY
  3085     COMPUTE WS-GROSS-PMT-4 = PRINC-AMT / ANGLEN
  3086*    COMPUTE WS-GROSS-PREM-1 = WS-GROSS-PMT-1 *
  3087*      N * (N + ((D - T) / T)) / 12 * LF-RATE / 100
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  55
* ELVADS.cbl
  3088     COMPUTE WS-GROSS-PREM-1 = WS-GROSS-PMT-1 *
  3089       N * N / 12 * LF-RATE / 100
  3090     COMPUTE WS-GROSS-PREM-2 = WS-GROSS-PMT-2 * N * AHRATE / 100
  3091*    COMPUTE WS-GROSS-PREM-3 = (WS-GROSS-PMT-3 * N *
  3092*      (N + ((D - T) / T)) / 12 * LF-RATE / 100) +
  3093*      (WS-GROSS-PMT-3 * N * AHRATE / 100)
  3094     COMPUTE WS-GROSS-PREM-3 = (WS-GROSS-PMT-3 * N *
  3095       N / 12 * LF-RATE / 100) +
  3096       (WS-GROSS-PMT-3 * N * AHRATE / 100)
  3097     MOVE ZEROS                  TO WS-GROSS-PREM-4
  3098     IF (VD-LF-BENEFIT-CD NOT = '00' AND '  ')
  3099        AND (VD-AH-BENEFIT-CD = '00' OR '  ')
  3100        COMPUTE VA-CL-GRS-AMT = PRINC-AMT + WS-GROSS-PREM-1
  3101        MOVE WS-GROSS-PMT-1      TO VA-CL-GRS-PMT
  3102        MOVE WS-GROSS-PREM-1     TO VA-CL-GRS-PRM
  3103     END-IF
  3104     IF (VD-LF-BENEFIT-CD = '00' OR '  ')
  3105        AND (VD-AH-BENEFIT-CD NOT = '00' AND '  ')
  3106        COMPUTE VA-CD-GRS-AMT = PRINC-AMT + WS-GROSS-PREM-2
  3107        MOVE WS-GROSS-PMT-2      TO VA-CD-GRS-PMT
  3108        MOVE WS-GROSS-PREM-2     TO VA-CD-GRS-PRM
  3109     END-IF
  3110     IF (VD-LF-BENEFIT-CD NOT = '00' AND '  ')
  3111        AND (VD-AH-BENEFIT-CD NOT = '00' AND '  ')
  3112        COMPUTE VA-CLD-GRS-AMT = PRINC-AMT + WS-GROSS-PREM-3
  3113        MOVE WS-GROSS-PMT-3      TO VA-CLD-GRS-PMT
  3114        MOVE WS-GROSS-PREM-3     TO VA-CLD-GRS-PRM
  3115     END-IF
  3116     COMPUTE VA-NO-GRS-AMT = PRINC-AMT
  3117     MOVE WS-GROSS-PMT-4           TO VA-NO-GRS-PMT
  3118     MOVE WS-GROSS-PREM-4           TO VA-NO-GRS-PRM
  3119     .
  3120 3000-EXIT.
  3121     EXIT.
  3122 3500-BUILD-AH-AMTS.
  3123     MOVE VD-AH-BENEFIT-AMT    TO CUR-PMT
  3124     COMPUTE AMT-FINANCED = CUR-PMT * ANGLEN
  3125     COMPUTE PRINC-AMT = AMT-FINANCED - LFPREM - AHPREM
  3126     COMPUTE WS-GROSS-PMT-2 = PRINC-AMT /
  3127       (ANGLEN - (N * AHRATE / 100))
  3128     COMPUTE WS-GROSS-PMT-4 = PRINC-AMT / ANGLEN
  3129     COMPUTE WS-GROSS-PREM-2 = WS-GROSS-PMT-2 * N * AHRATE / 100
  3130     MOVE ZEROS                  TO WS-GROSS-PREM-4
  3131     COMPUTE VA-CD-GRS-AMT = PRINC-AMT + WS-GROSS-PREM-2
  3132     COMPUTE VA-NO-GRS-AMT = PRINC-AMT
  3133*    MOVE WS-GROSS-PMT-1           TO VA-CL-GRS-PMT
  3134     MOVE WS-GROSS-PMT-2           TO VA-CD-GRS-PMT
  3135*    MOVE WS-GROSS-PMT-3           TO VA-CLD-GRS-PMT
  3136     MOVE WS-GROSS-PMT-4           TO VA-NO-GRS-PMT
  3137*    MOVE WS-GROSS-PREM-1           TO VA-CL-GRS-PRM
  3138     MOVE WS-GROSS-PREM-2           TO VA-CD-GRS-PRM
  3139*    MOVE WS-GROSS-PREM-3           TO VA-CLD-GRS-PRM
  3140     MOVE WS-GROSS-PREM-4           TO VA-NO-GRS-PRM
  3141     .
  3142 3500-EXIT.
  3143     EXIT.
  3144 4000-BUILD-LEVEL-AMTS.
  3145     MOVE 1                      TO N
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  56
* ELVADS.cbl
  3146     COMPUTE PPY = 1 / M * 12
  3147     COMPUTE T = 360 * M / 12
  3148     COMPUTE D = D + T
  3149     COMPUTE I = VD-LOAN-APR / PPY / 100
  3150     COMPUTE Y = (1 + (D * I / T)) / (1 + I)
  3151     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** 1) / I
  3152     COMPUTE ANGLENY = ANGLEN / Y
  3153     COMPUTE PRINC-AMT = (LFAMT * ANGLENY) - LFPREM
  3154     COMPUTE WS-LEVEL-PMT-1 = PRINC-AMT / (ANGLENY -
  3155        (1 * ((1 + (D - T) / T) / PPY) * (LF-RATE / 100)))
  3156     COMPUTE WS-LEVEL-PMT-4 = PRINC-AMT / ANGLENY
  3157     COMPUTE WS-LEVEL-PREM-1 = WS-LEVEL-PMT-1 *
  3158        (1 * ((1 + (D - T) / T) / PPY) * (LF-RATE / 100))
  3159     MOVE ZEROS                  TO WS-LEVEL-PREM-4
  3160     MOVE WS-LEVEL-PMT-1           TO VA-CL-LEV-PMT
  3161     MOVE WS-LEVEL-PMT-4           TO VA-NO-LEV-PMT
  3162     MOVE WS-LEVEL-PREM-1           TO VA-CL-LEV-PRM
  3163     MOVE WS-LEVEL-PREM-4           TO VA-NO-LEV-PRM
  3164     COMPUTE VA-CL-LEV-AMT = PRINC-AMT + WS-LEVEL-PREM-1
  3165     MOVE PRINC-AMT              TO VA-NO-LEV-AMT
  3166     .
  3167 4000-EXIT.
  3168     EXIT.
  3169
  3170 4100-CREATE-ARCHIVE.
  3171
  3172     PERFORM 4125-GET-CSR-INFO THRU 4125-EXIT.
  3173     PERFORM 4250-GET-ELLETR   THRU 4250-EXIT.
  3174     PERFORM 4500-GET-ARCH-NO  THRU 4500-EXIT.
  3175     PERFORM 4700-GET-ELENCC   THRU 4700-EXIT.
  3176     PERFORM 5700-WRITE-EXTR THRU 5700-EXIT.
  3177
  3178 4100-EXIT.
  3179     EXIT.
  3180
  3181 4125-GET-CSR-INFO.
  3182
  3183     MOVE VD-PROC-ID             TO VA-PROC-ID
  3184     MOVE VD-CSR-ID              TO VA-CSR-CODE
  3185     MOVE VD-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  3186     MOVE '2'                    TO WS-ELCNTL-REC-TYPE
  3187     MOVE VD-CSR-ID              TO WS-ELCNTL-GENL
  3188     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  3189
  3190* EXEC CICS READ
  3191*       INTO    (CONTROL-FILE)
  3192*       DATASET ('ELCNTL')
  3193*       RIDFLD  (WS-ELCNTL-KEY)
  3194*       RESP    (WS-RESPONSE)
  3195*    END-EXEC
  3196     MOVE LENGTH OF
  3197      CONTROL-FILE
  3198       TO DFHEIV11
  3199     MOVE 'ELCNTL' TO DFHEIV1
  3200*    MOVE '&"IL       E          (  N#00003147' TO DFHEIV0
  3201     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3202     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3203     MOVE X'204E233030303033313437' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  57
* ELVADS.cbl
  3204     CALL 'kxdfhei1' USING DFHEIV0,
  3205           DFHEIV1,
  3206           CONTROL-FILE,
  3207           DFHEIV11,
  3208           WS-ELCNTL-KEY,
  3209           DFHEIV99,
  3210           DFHEIV99,
  3211           DFHEIV99
  3212     MOVE EIBRESP  TO WS-RESPONSE
  3213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3214     IF RESP-NORMAL
  3215        MOVE CF-PROCESSOR-NAME   TO VA-CSR-NAME
  3216                                    VA-PROC-NAME
  3217        MOVE VD-CSR-ID           TO VA-CSR-TITLE
  3218                                    VA-PROC-TITLE
  3219     END-IF
  3220
  3221     IF VD-PROC-ID NOT = VD-CSR-ID
  3222        MOVE VD-COMP-ID          TO WS-ELCNTL-COMPANY-ID
  3223        MOVE '2'                 TO WS-ELCNTL-REC-TYPE
  3224        MOVE VD-PROC-ID          TO WS-ELCNTL-GENL
  3225        MOVE +0                  TO WS-ELCNTL-SEQ-NO
  3226
  3227* EXEC CICS READ
  3228*          INTO    (CONTROL-FILE)
  3229*          DATASET ('ELCNTL')
  3230*          RIDFLD  (WS-ELCNTL-KEY)
  3231*          RESP    (WS-RESPONSE)
  3232*       END-EXEC
  3233     MOVE LENGTH OF
  3234      CONTROL-FILE
  3235       TO DFHEIV11
  3236     MOVE 'ELCNTL' TO DFHEIV1
  3237*    MOVE '&"IL       E          (  N#00003165' TO DFHEIV0
  3238     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3239     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3240     MOVE X'204E233030303033313635' TO DFHEIV0(25:11)
  3241     CALL 'kxdfhei1' USING DFHEIV0,
  3242           DFHEIV1,
  3243           CONTROL-FILE,
  3244           DFHEIV11,
  3245           WS-ELCNTL-KEY,
  3246           DFHEIV99,
  3247           DFHEIV99,
  3248           DFHEIV99
  3249     MOVE EIBRESP  TO WS-RESPONSE
  3250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3251        IF RESP-NORMAL
  3252           MOVE CF-PROCESSOR-NAME   TO VA-PROC-NAME
  3253           MOVE VD-PROC-ID          TO VA-PROC-TITLE
  3254        END-IF
  3255     END-IF
  3256
  3257     .
  3258 4125-EXIT.
  3259     EXIT.
  3260
  3261 4250-GET-ELLETR.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  58
* ELVADS.cbl
  3262
  3263     MOVE WS-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  3264     MOVE VD-LETTER-ID           TO WS-ELLETR-LETTER-ID
  3265     MOVE +0                     TO WS-ELLETR-SEQ-NO
  3266     MOVE SPACES                 TO W-Z-CONTROL-DATA
  3267
  3268
  3269* EXEC CICS READ
  3270*         DATASET    ('ELLETR')
  3271*         INTO       (TEXT-FILES)
  3272*         RIDFLD     (WS-ELLETR-KEY)
  3273*         RESP       (WS-RESPONSE)
  3274*         GTEQ
  3275*    END-EXEC
  3276     MOVE LENGTH OF
  3277      TEXT-FILES
  3278       TO DFHEIV11
  3279     MOVE 'ELLETR' TO DFHEIV1
  3280*    MOVE '&"IL       G          (  N#00003188' TO DFHEIV0
  3281     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  3282     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3283     MOVE X'204E233030303033313838' TO DFHEIV0(25:11)
  3284     CALL 'kxdfhei1' USING DFHEIV0,
  3285           DFHEIV1,
  3286           TEXT-FILES,
  3287           DFHEIV11,
  3288           WS-ELLETR-KEY,
  3289           DFHEIV99,
  3290           DFHEIV99,
  3291           DFHEIV99
  3292     MOVE EIBRESP  TO WS-RESPONSE
  3293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3294
  3295     IF RESP-NORMAL
  3296        IF (LETTER-FILE-TEXT)
  3297           AND (VD-LETTER-ID = TX-LETTER-NO)
  3298           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  3299           PERFORM 4280-PROCESS-Z-CONTROLS
  3300                                 THRU 4280-EXIT
  3301        END-IF
  3302     END-IF
  3303
  3304     .
  3305 4250-EXIT.
  3306     EXIT.
  3307
  3308
  3309 4280-PROCESS-Z-CONTROLS.
  3310
  3311     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  3312
  3313     .
  3314 4280-EXIT.
  3315     EXIT.
  3316
  3317
  3318 4500-GET-ARCH-NO.
  3319
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  59
* ELVADS.cbl
  3320     MOVE VD-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  3321     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  3322     MOVE SPACES                 TO WS-ELCNTL-GENL
  3323     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  3324
  3325
  3326* EXEC CICS READ
  3327*       INTO    (CONTROL-FILE)
  3328*       DATASET ('ELCNTL')
  3329*       RIDFLD  (WS-ELCNTL-KEY)
  3330*       UPDATE
  3331*       RESP    (WS-RESPONSE)
  3332*    END-EXEC
  3333     MOVE LENGTH OF
  3334      CONTROL-FILE
  3335       TO DFHEIV11
  3336     MOVE 'ELCNTL' TO DFHEIV1
  3337*    MOVE '&"IL       EU         (  N#00003226' TO DFHEIV0
  3338     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3339     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3340     MOVE X'204E233030303033323236' TO DFHEIV0(25:11)
  3341     CALL 'kxdfhei1' USING DFHEIV0,
  3342           DFHEIV1,
  3343           CONTROL-FILE,
  3344           DFHEIV11,
  3345           WS-ELCNTL-KEY,
  3346           DFHEIV99,
  3347           DFHEIV99,
  3348           DFHEIV99
  3349     MOVE EIBRESP  TO WS-RESPONSE
  3350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3351
  3352     IF RESP-NORMAL
  3353        AND (CF-COMPANY-ID  = VD-COMP-ID)
  3354        AND (CF-RECORD-TYPE = '1')
  3355        ADD +1                   TO CF-CREDIT-LAST-ARCH-NUM
  3356        MOVE CF-CREDIT-LAST-ARCH-NUM
  3357                                 TO WS-ARCHIVE-NO
  3358
  3359* EXEC CICS REWRITE
  3360*          FROM    (CONTROL-FILE)
  3361*          DATASET ('ELCNTL')
  3362*       END-EXEC
  3363     MOVE LENGTH OF
  3364      CONTROL-FILE
  3365       TO DFHEIV11
  3366     MOVE 'ELCNTL' TO DFHEIV1
  3367*    MOVE '&& L                  %   #00003240' TO DFHEIV0
  3368     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3369     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3370     MOVE X'2020233030303033323430' TO DFHEIV0(25:11)
  3371     CALL 'kxdfhei1' USING DFHEIV0,
  3372           DFHEIV1,
  3373           CONTROL-FILE,
  3374           DFHEIV11,
  3375           DFHEIV99
  3376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3377     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  60
* ELVADS.cbl
  3378        MOVE +0                  TO WS-ARCHIVE-NO
  3379     END-IF
  3380
  3381*** IF AN ARCHIVE NUMBER IS PASSED TO THIS PGM THEN
  3382*** IT IS SAVED IN VA-ARCH-NO.  THE VA DISC LETTER
  3383*** WILL CREATE A DIFFERENT ARCH NO.
  3384     IF VD-ARCHIVE-NO GREATER THAN ZERO
  3385         MOVE VD-ARCHIVE-NO      TO VA-ARCH-NO
  3386     ELSE
  3387         MOVE WS-ARCHIVE-NO      TO VA-ARCH-NO
  3388     END-IF
  3389    .
  3390 4500-EXIT.
  3391     EXIT.
  3392
  3393
  3394 4700-GET-ELENCC.
  3395
  3396     MOVE SPACES                 TO WS-ELENCC-KEY
  3397     MOVE WS-COMPANY-CD          TO WS-ELENCC-COMPANY-CD
  3398     MOVE '2'                    TO WS-ELENCC-REC-TYPE
  3399     MOVE W-ENCLOSURE-CD         TO WS-ELENCC-ENC-CODE
  3400     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  3401        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  3402        OR (E1 > +5)
  3403     END-PERFORM
  3404
  3405     IF E1 < +5
  3406        MOVE VD-STATE            TO WS-ELENCC-ENC-CODE (E1:2)
  3407     END-IF
  3408
  3409
  3410* EXEC CICS READ
  3411*        DATASET   ('ELENCC')
  3412*        INTO      (ENCLOSURE-CODES)
  3413*        RIDFLD    (WS-ELENCC-KEY)
  3414*        RESP      (WS-RESPONSE)
  3415*    END-EXEC
  3416     MOVE LENGTH OF
  3417      ENCLOSURE-CODES
  3418       TO DFHEIV11
  3419     MOVE 'ELENCC' TO DFHEIV1
  3420*    MOVE '&"IL       E          (  N#00003276' TO DFHEIV0
  3421     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3422     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3423     MOVE X'204E233030303033323736' TO DFHEIV0(25:11)
  3424     CALL 'kxdfhei1' USING DFHEIV0,
  3425           DFHEIV1,
  3426           ENCLOSURE-CODES,
  3427           DFHEIV11,
  3428           WS-ELENCC-KEY,
  3429           DFHEIV99,
  3430           DFHEIV99,
  3431           DFHEIV99
  3432     MOVE EIBRESP  TO WS-RESPONSE
  3433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3434
  3435     IF NOT RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  61
* ELVADS.cbl
  3436        MOVE W-ENCLOSURE-CD    TO WS-ELENCC-ENC-CODE
  3437
  3438* EXEC CICS READ
  3439*           DATASET   ('ELENCC')
  3440*           INTO      (ENCLOSURE-CODES)
  3441*           RIDFLD    (WS-ELENCC-KEY)
  3442*           RESP      (WS-RESPONSE)
  3443*       END-EXEC
  3444     MOVE LENGTH OF
  3445      ENCLOSURE-CODES
  3446       TO DFHEIV11
  3447     MOVE 'ELENCC' TO DFHEIV1
  3448*    MOVE '&"IL       E          (  N#00003285' TO DFHEIV0
  3449     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3450     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3451     MOVE X'204E233030303033323835' TO DFHEIV0(25:11)
  3452     CALL 'kxdfhei1' USING DFHEIV0,
  3453           DFHEIV1,
  3454           ENCLOSURE-CODES,
  3455           DFHEIV11,
  3456           WS-ELENCC-KEY,
  3457           DFHEIV99,
  3458           DFHEIV99,
  3459           DFHEIV99
  3460     MOVE EIBRESP  TO WS-RESPONSE
  3461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3462     END-IF
  3463
  3464     IF RESP-NORMAL
  3465        MOVE NC-OUTPUT-STACK     TO VA-STACK
  3466        MOVE NC-ENCLOSURE-LINE   TO VA-ENC-LINE
  3467        MOVE NC-ATTACHMENTS      TO VA-ATTACH
  3468        MOVE 'N'                 TO VA-PRINT-NOW
  3469     END-IF
  3470
  3471     .
  3472 4700-EXIT.
  3473     EXIT.
  3474
  3475
  3476 5000-BUILD-ERARCH.
  3477
  3478* DATA SOURCE MEANINGS  BL-DATA-SRCE
  3479*    1) FROM ACCT MAINT
  3480*    2) FROM CERT UPDATE
  3481*    3) FROM COMP MAINT
  3482*    4) FROM REVIEW AND CORRECTIONS
  3483******************************************************************
  3484
  3485
  3486     MOVE 'LA'                   TO LETTER-ARCHIVE
  3487
  3488     MOVE WS-ARCHIVE-NO          TO LA-ARCHIVE-NO
  3489                                    LA-ARCHIVE-NO-A2
  3490                                    LA-ARCHIVE-NO-A3
  3491                                    LA-ARCHIVE-NO-A4
  3492                                    LA-ARCHIVE-NO-A5
  3493                                    LA-ARCHIVE-NO-A6
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  62
* ELVADS.cbl
  3494
  3495     MOVE VD-COMPANY-CD          TO LA-COMPANY-CD
  3496                                    LA-COMPANY-CD-A2
  3497                                    LA-COMPANY-CD-A3
  3498                                    LA-COMPANY-CD-A4
  3499                                    LA-COMPANY-CD-A5
  3500                                    LA-COMPANY-CD-A6
  3501     MOVE VD-CARRIER             TO LA-CARRIER-A2
  3502                                    LA-CARRIER-A3
  3503                                    LA-CARRIER-A4
  3504                                    LA-CARRIER-A5
  3505     MOVE VD-GROUPING            TO LA-GROUPING-A2
  3506                                    LA-GROUPING-A3
  3507                                    LA-GROUPING-A4
  3508                                    LA-GROUPING-A5
  3509     MOVE VD-ACCOUNT             TO LA-ACCOUNT-A2
  3510                                    LA-ACCOUNT-A3
  3511                                    LA-ACCOUNT-A4
  3512                                    LA-ACCOUNT-A5
  3513     MOVE VD-STATE               TO LA-STATE-A2
  3514                                    LA-STATE-A3
  3515                                    LA-STATE-A4
  3516                                    LA-STATE-A5
  3517     MOVE VD-CERT-EFF-DT         TO LA-EFFECT-DATE-A2
  3518     MOVE VD-CERT-NO             TO LA-CERT-NO-A2
  3519
  3520     MOVE VD-ENTRY-BATCH         TO LA-ENTRY-A6
  3521
  3522     MOVE VD-PROC-ID             TO LA-PROCESSOR-CD
  3523
  3524     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  3525                                    LA-INITIAL-PRINT-DATE
  3526                                    LA-SENT-DATE
  3527                                    LA-REPLY-DATE
  3528                                    LA-RESEND-DATE
  3529                                    LA-FOLLOW-UP-DATE
  3530
  3531     MOVE 'A'                    TO LA-STATUS
  3532     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  3533     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  3534     MOVE VD-LETTER-ID           TO LA-FORM-A3
  3535     MOVE SPACES                 TO LA-DATA-SOURCE
  3536     MOVE 'B'                    TO LA-ARCHIVE-STATUS
  3537     MOVE VD-CURRENT-DATE        TO LA-CREATION-DATE
  3538     MOVE 'Y'                    TO LA-VA-DISCLOSURE-IND
  3539     MOVE VD-CURRENT-DATE        TO LA-LAST-MAINT-DATE
  3540     MOVE VD-CURRENT-TIME        TO LA-LAST-MAINT-TIME
  3541     MOVE VD-PROC-ID             TO LA-LAST-UPDATED-BY
  3542
  3543     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  3544                                    LA-NO-OF-TEXT-RECORDS
  3545
  3546
  3547* EXEC CICS WRITE
  3548*         DATASET   ('ERARCH')
  3549*         FROM      (LETTER-ARCHIVE)
  3550*         RIDFLD    (LA-CONTROL-PRIMARY)
  3551*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  63
* ELVADS.cbl
  3552*    END-EXEC
  3553     MOVE LENGTH OF
  3554      LETTER-ARCHIVE
  3555       TO DFHEIV11
  3556     MOVE 'ERARCH' TO DFHEIV1
  3557*    MOVE '&$ L                  ''  N#00003375' TO DFHEIV0
  3558     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3559     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3560     MOVE X'204E233030303033333735' TO DFHEIV0(25:11)
  3561     CALL 'kxdfhei1' USING DFHEIV0,
  3562           DFHEIV1,
  3563           LETTER-ARCHIVE,
  3564           DFHEIV11,
  3565           LA-CONTROL-PRIMARY,
  3566           DFHEIV99,
  3567           DFHEIV99
  3568     MOVE EIBRESP  TO WS-RESPONSE
  3569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3570
  3571     IF NOT RESP-NORMAL
  3572        SET ARCH-FAIL TO TRUE
  3573     END-IF
  3574
  3575     .
  3576 5000-EXIT.
  3577     EXIT.
  3578
  3579
  3580 5700-WRITE-EXTR.
  3581
  3582     PERFORM 5000-BUILD-ERARCH   THRU 5000-EXIT
  3583     IF ARCH-FAIL
  3584        MOVE ' COULDNT BUILD ERARCH ' TO WS-MESSAGE
  3585        GO TO 5700-EXIT
  3586     END-IF
  3587     MOVE WS-COMPANY-CD          TO NSAS-COMPANY-CD
  3588     MOVE WS-ARCHIVE-NO          TO NSAS-ARCHIVE-NO
  3589     MOVE +0                     TO NSAS-SEQ-NO
  3590     PERFORM 5710-BUILD-NSASEXTR THRU 5710-EXIT
  3591     PERFORM 5720-WRITE-NSASEXTR THRU 5720-EXIT
  3592     IF ARCH-FAIL
  3593        MOVE ' COULDNT BUILD STD NSASEXTR ' TO WS-MESSAGE
  3594        GO TO 5700-EXIT
  3595     END-IF
  3596     IF W-LETTER-TO-ACCT NOT = SPACES
  3597        MOVE W-LETTER-TO-ACCT   TO NSAS-LETTER-VARIABLES (5:1)
  3598        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  3599        MOVE WS-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  3600        MOVE +1                  TO NSAS-SEQ-NO
  3601        PERFORM 5720-WRITE-NSASEXTR
  3602                                 THRU 5720-EXIT
  3603        IF ARCH-FAIL
  3604           MOVE ' COULDNT BUILD ACCT NSASEXTR ' TO WS-MESSAGE
  3605           GO TO 5700-EXIT
  3606        END-IF
  3607     END-IF
  3608
  3609     IF W-LETTER-TO-BENE NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  64
* ELVADS.cbl
  3610        MOVE W-LETTER-TO-BENE   TO NSAS-LETTER-VARIABLES (5:1)
  3611        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  3612        MOVE WS-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  3613        MOVE +2                  TO NSAS-SEQ-NO
  3614        PERFORM 5720-WRITE-NSASEXTR
  3615                                 THRU 5720-EXIT
  3616        IF ARCH-FAIL
  3617           MOVE ' COULDNT BUILD BENE NSASEXTR ' TO WS-MESSAGE
  3618        END-IF
  3619     END-IF
  3620
  3621     .
  3622 5700-EXIT.
  3623     EXIT.
  3624
  3625 5710-BUILD-NSASEXTR.
  3626
  3627***  i added the extra space in front of the 1st ~
  3628***  only because there may be a letter to acct or bene
  3629
  3630     STRING
  3631         VA-LETTER                ' ~'
  3632         VA-PROC-ID               '~'
  3633         VA-PROC-NAME             '~'
  3634         VA-PROC-TITLE            '~'
  3635         VA-CSR-CODE              '~'
  3636         VA-CSR-NAME              '~'
  3637         VA-CSR-TITLE             '~'
  3638         VA-CARRIER               '~'
  3639         VA-GROUPING              '~'
  3640         VA-STATE                 '~'
  3641         VA-ACCOUNT               '~'
  3642         VA-EFFDATE               '~'
  3643         VA-CERT-NO               '~'
  3644         VA-FIRSTNAME             '~'
  3645         VA-MIDINIT               '~'
  3646         VA-LASTNAME              '~'
  3647         VA-ADDR1                 '~'
  3648         VA-ADDR2                 '~'
  3649         VA-ADDR-CITY             '~'
  3650         VA-ADDR-ST               '~'
  3651         VA-ADDR-ZIP              '~'
  3652         VA-JNT-FIRSTNAME         '~'
  3653         VA-JNT-MIDINIT           '~'
  3654         VA-JNT-LASTNAME          '~'
  3655         VA-ARCH-NO               '~'
  3656         VA-ENC-LINE              '~'
  3657         VA-ATTACH                '~'
  3658         VA-STACK                 '~'
  3659         VA-PRINT-NOW             '~'
  3660         VA-BORROWER              '~'
  3661         VA-BENE                  '~'
  3662         VA-ACCT-NAME             '~'
  3663         VA-SL                    '~'
  3664         VA-JL                    '~'
  3665         VA-SA                    '~'
  3666         VA-JA                    '~'
  3667         VA-GD                    '~'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  65
* ELVADS.cbl
  3668         VA-NP                    '~'
  3669         VA-7R                    '~'
  3670         VA-LL                    '~'
  3671         VA-TN                    '~'
  3672         VA-14R                   '~'
  3673         VA-14E                   '~'
  3674         VA-30R                   '~'
  3675         VA-30E                   '~'
  3676         VA-CL-NET-AMT            '~'
  3677         VA-CL-GRS-AMT            '~'
  3678         VA-CL-LEV-AMT            '~'
  3679         VA-CL-NET-PMT            '~'
  3680         VA-CL-GRS-PMT            '~'
  3681         VA-CL-LEV-PMT            '~'
  3682         VA-CL-NET-PRM            '~'
  3683         VA-CL-GRS-PRM            '~'
  3684         VA-CL-LEV-PRM            '~'
  3685         VA-CD-NET-AMT            '~'
  3686         VA-CD-GRS-AMT            '~'
  3687         VA-CD-LEV-AMT            '~'
  3688         VA-CD-NET-PMT            '~'
  3689         VA-CD-GRS-PMT            '~'
  3690         VA-CD-LEV-PMT            '~'
  3691         VA-CD-NET-PRM            '~'
  3692         VA-CD-GRS-PRM            '~'
  3693         VA-CD-LEV-PRM            '~'
  3694         VA-CLD-NET-AMT           '~'
  3695         VA-CLD-GRS-AMT           '~'
  3696         VA-CLD-LEV-AMT           '~'
  3697         VA-CLD-NET-PMT           '~'
  3698         VA-CLD-GRS-PMT           '~'
  3699         VA-CLD-LEV-PMT           '~'
  3700         VA-CLD-NET-PRM           '~'
  3701         VA-CLD-GRS-PRM           '~'
  3702         VA-CLD-LEV-PRM           '~'
  3703         VA-NO-NET-AMT            '~'
  3704         VA-NO-GRS-AMT            '~'
  3705         VA-NO-LEV-AMT            '~'
  3706         VA-NO-NET-PMT            '~'
  3707         VA-NO-GRS-PMT            '~'
  3708         VA-NO-LEV-PMT            '~'
  3709         VA-NO-NET-PRM            '~'
  3710         VA-NO-GRS-PRM            '~'
  3711         VA-NO-LEV-PRM            '~'
  3712            DELIMITED BY '  ' INTO NSAS-LETTER-VARIABLES
  3713     END-STRING
  3714
  3715     .
  3716 5710-EXIT.
  3717     EXIT.
  3718
  3719 5720-WRITE-NSASEXTR.
  3720
  3721
  3722* EXEC CICS WRITE
  3723*       DATASET    ('NSASEXTR')
  3724*       FROM       (NSAS-EXTRACT-RECORD)
  3725*       RIDFLD     (NSAS-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  66
* ELVADS.cbl
  3726*       RESP       (WS-RESPONSE)
  3727*    END-EXEC
  3728     MOVE LENGTH OF
  3729      NSAS-EXTRACT-RECORD
  3730       TO DFHEIV11
  3731     MOVE 'NSASEXTR' TO DFHEIV1
  3732*    MOVE '&$ L                  ''  N#00003532' TO DFHEIV0
  3733     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3734     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3735     MOVE X'204E233030303033353332' TO DFHEIV0(25:11)
  3736     CALL 'kxdfhei1' USING DFHEIV0,
  3737           DFHEIV1,
  3738           NSAS-EXTRACT-RECORD,
  3739           DFHEIV11,
  3740           NSAS-CONTROL-PRIMARY,
  3741           DFHEIV99,
  3742           DFHEIV99
  3743     MOVE EIBRESP  TO WS-RESPONSE
  3744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3745
  3746     IF NOT RESP-NORMAL
  3747        SET ARCH-FAIL TO TRUE
  3748     END-IF
  3749
  3750     .
  3751 5720-EXIT.
  3752     EXIT.
  3753
  3754 8000-RETURN.
  3755
  3756* EXEC CICS RETURN
  3757*    END-EXEC
  3758*    MOVE '.(                    ''   #00003548' TO DFHEIV0
  3759     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3760     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3761     MOVE X'2020233030303033353438' TO DFHEIV0(25:11)
  3762     CALL 'kxdfhei1' USING DFHEIV0,
  3763           DFHEIV99,
  3764           DFHEIV99,
  3765           DFHEIV99,
  3766           DFHEIV99,
  3767           DFHEIV99,
  3768           DFHEIV99
  3769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3770
  3771* GOBACK
  3772
  3773     MOVE '9%                    "   ' TO DFHEIV0
  3774     MOVE 'ELVADS' TO DFHEIV1
  3775     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3776     GOBACK
  3777     .
  3778 9700-DATE-LINK.
  3779     MOVE LINK-ELDATCV           TO PGM-NAME
  3780
  3781* EXEC CICS LINK
  3782*       PROGRAM    (PGM-NAME)
  3783*       COMMAREA   (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:32 Page  67
* ELVADS.cbl
  3784*       LENGTH     (DC-COMM-LENGTH)
  3785*    END-EXEC
  3786*    MOVE '."C                   (   #00003554' TO DFHEIV0
  3787     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3788     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3789     MOVE X'2020233030303033353534' TO DFHEIV0(25:11)
  3790     CALL 'kxdfhei1' USING DFHEIV0,
  3791           PGM-NAME,
  3792           DATE-CONVERSION-DATA,
  3793           DC-COMM-LENGTH,
  3794           DFHEIV99,
  3795           DFHEIV99,
  3796           DFHEIV99,
  3797           DFHEIV99
  3798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3799     .
  3800 9700-EXIT.
  3801     EXIT.
  3802
  3803 9999-DFHBACK SECTION.
  3804     MOVE '9%                    "   ' TO DFHEIV0
  3805     MOVE 'ELVADS' TO DFHEIV1
  3806     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3807     GOBACK.
  3808 9999-DFHEXIT.
  3809     IF DFHEIGDJ EQUAL 0001
  3810         NEXT SENTENCE.
  3811     MOVE '9%                    "   ' TO DFHEIV0
  3812     MOVE 'ELVADS' TO DFHEIV1
  3813     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3814     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       11804     Code:       17166
