* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL651.cbl
* Options: int("EL651.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL651.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL651.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL651.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL651.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/16/94 10:57:36.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.019
     9
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL651.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.    TRANSACTION - EXD1 - REINSURANCE MASTER MAINT.
    26
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL651.cbl
    28 ENVIRONMENT DIVISION.
    29 DATA DIVISION.
    30 WORKING-STORAGE SECTION.
    31 01  DFH-START PIC X(04).
    32 77  FILLER  PIC X(32)  VALUE '********************************'.
    33 77  FILLER  PIC X(32)  VALUE '*    EL651 WORKING STORAGE     *'.
    34 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.019 *********'.
    35
    36*                          COPY ELCSCTM.
    37******************************************************************
    38*                                                                *
    39*                                                                *
    40*                            ELCSCTM                             *
    41*                            VMOD=2.001                          *
    42*                                                                *
    43*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    44*                                                                *
    45******************************************************************
    46 01  SECURITY-MESSAGE.
    47     12  FILLER                          PIC X(30)
    48            VALUE '** LOGIC SECURITY VIOLATION -'.
    49     12  SM-READ                         PIC X(6).
    50     12  FILLER                          PIC X(5)
    51            VALUE ' PGM='.
    52     12  SM-PGM                          PIC X(6).
    53     12  FILLER                          PIC X(5)
    54            VALUE ' OPR='.
    55     12  SM-PROCESSOR-ID                 PIC X(4).
    56     12  FILLER                          PIC X(6)
    57            VALUE ' TERM='.
    58     12  SM-TERMID                       PIC X(4).
    59     12  FILLER                          PIC XX   VALUE SPACE.
    60     12  SM-JUL-DATE                     PIC 9(5).
    61     12  FILLER                          PIC X    VALUE SPACE.
    62     12  SM-TIME                         PIC 99.99.
    63
    64*                          COPY ELCSCRTY.
    65******************************************************************
    66*                                                                *
    67*                                                                *
    68*                            ELCSCRTY                            *
    69*                            VMOD=2.001                          *
    70*                                                                *
    71*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    72*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    73*        SAVED IN PI-SECURITY-ADDRESS.                           *
    74*                                                                *
    75******************************************************************
    76 01  SECURITY-CONTROL.
    77     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    78     12  FILLER                       PIC XX    VALUE 'SC'.
    79     12  SC-CREDIT-CODES.
    80         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    81             20  SC-CREDIT-DISPLAY    PIC X.
    82             20  SC-CREDIT-UPDATE     PIC X.
    83     12  SC-CLAIMS-CODES.
    84         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    85             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL651.cbl
    86             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL651.cbl
    88 01  WS-DATE-AREA.
    89     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    90     05  SAVE-BIN-DATE               PIC X(2)    VALUE SPACES.
    91
    92 01  STANDARD-AREAS.
    93     05  GETMAIN-SPACE               PIC X       VALUE SPACE.
    94     05  MAP-NAME                    PIC X(8)    VALUE 'EL651A'.
    95     05  MAPSET-NAME                 PIC X(8)    VALUE 'EL651S'.
    96     05  TRANS-ID                    PIC X(4)    VALUE 'EXD1'.
    97     05  EL6592-TRANS-ID             PIC X(4)    VALUE 'EX66'.
    98     05  THIS-PGM                    PIC X(8)    VALUE 'EL651'.
    99     05  PGM-NAME                    PIC X(8).
   100     05  SUB1                        PIC S99     VALUE +0.
   101     05  SC-ITEM                     PIC S9(4) COMP VALUE +1.
   102     05  WS-SAVE-PI-SUB              PIC S99     VALUE +0.
   103
   104     05  NINES                       PIC S9(9)V99 VALUE
   105                                                 +999999999.99.
   106     05  TIME-IN                     PIC S9(7).
   107     05  TIME-OUT-R  REDEFINES TIME-IN.
   108         10  FILLER                  PIC X.
   109         10  TIME-OUT                PIC 99V99.
   110         10  FILLER                  PIC X(2).
   111     05  TIME-MT                     PIC S9(7).
   112     05  TIME-MT-R  REDEFINES TIME-MT.
   113         10  FILLER                  PIC X.
   114         10  TIME-LMT                PIC 99V99.
   115         10  FILLER                  PIC X(2).
   116     05  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   117     05  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   118     05  XCTL-626                    PIC X(8)    VALUE 'EL126'.
   119     05  XCTL-6511                   PIC X(8)    VALUE 'EL6511'.
   120     05  XCTL-657                    PIC X(8)    VALUE 'EL657'.
   121     05  LINK-001                    PIC X(8)    VALUE 'EL001'.
   122     05  LINK-004                    PIC X(8)    VALUE 'EL004'.
   123     05  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   124     05  FILE-ID                     PIC X(8)    VALUE SPACES.
   125     05  REIN-FILE-ID                PIC X(8)    VALUE 'ERREIN'.
   126     05  CNTL-FILE-ID                PIC X(8)    VALUE 'ELCNTL'.
   127     05  BIN-CURRENT-SAVE            PIC XX      VALUE SPACES.
   128     05  WS-SAVE-REC                 PIC X(131)  VALUE SPACES.
   129
   130 01  MISC-WORK-AREAS.
   131     05  WS-LOW-DATE                 PIC X(8)    VALUE '00/00/00'.
   132     05  WS-HIGH-DATE                PIC X(8)    VALUE '99/99/99'.
   133     05  WS-HOLD-PIC98               PIC 9(8)    VALUE ZEROS.
   134     05  WS-HOLD-PIC98-2             PIC 9(8)    VALUE ZEROS.
   135     05  WS-PHONE-IN                 PIC 9(10).
   136     05  WS-PHONE-IN-R  REDEFINES WS-PHONE-IN.
   137         10  WSPI-AREA               PIC X(3).
   138         10  WSPI-PFX                PIC X(3).
   139         10  WSPI-SFX                PIC X(4).
   140     05  WS-PHONE-OUT.
   141         10  WSPO-AREA               PIC X(3).
   142         10  FILLER                  PIC X       VALUE '-'.
   143         10  WSPO-PFX                PIC X(3).
   144         10  FILLER                  PIC X       VALUE '-'.
   145         10  WSPO-SFX                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL651.cbl
   146     05  WS-SAVE-KEY                 PIC X(8).
   147     05  WS-GETMAIN-SW               PIC X       VALUE ' '.
   148
   149     05  DEEDIT-FIELD                PIC X(15).
   150     05  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD PIC S9(15).
   151     05  DEEDIT-FIELD-V1  REDEFINES DEEDIT-FIELD PIC S9(13)V99.
   152
   153     05  ERREIN-LENGTH               PIC S9(4)   VALUE +4023 COMP.
   154     05  ELCNTL-LENGTH               PIC S9(4)   VALUE +773  COMP.
   155     05  FILE-LENGTH                 PIC S9(4)   VALUE +0    COMP.
   156     05  DATE-TEST-AREA              PIC 9(8).
   157     05  DATE-TEST-AREA-R  REDEFINES DATE-TEST-AREA.
   158         10  DATE-TEST-CC            PIC 99.
   159         10  DATE-TEST-YY            PIC 99.
   160         10  DATE-TEST-MM            PIC 99.
   161         10  DATE-TEST-DD            PIC 99.
   162     05  DIVIDE-RESULT               PIC 99.
   163     05  DIVIDE-REMAINDER            PIC 9.
   164
   165     05  WS-PREV-AGE                 PIC 99       VALUE ZERO.
   166     05  WS-PREV-TRM                 PIC 999      VALUE ZERO.
   167     05  WS-PREV-AMT                 PIC S9(9)V99 VALUE ZERO.
   168
   169     05  WS-CHANGE-SW                PIC XX      VALUE SPACES.
   170         88  CHANGES-NOT-MADE                    VALUE SPACES.
   171
   172     05  WS-PAGE-LEVEL-SW            PIC X       VALUE SPACE.
   173         88  PAGE-LEVEL-FORWARD                  VALUE 'F'.
   174         88  PAGE-LEVEL-BACKWARD                 VALUE 'B'.
   175
   176     05  WS-CHECK-LEVEL              PIC S9(4)  VALUE +0  COMP.
   177         88  VALID-LEVEL                        VALUE +1 THRU +30.
   178
   179     05  WS-CHECK-PERCENT            PIC X       VALUE SPACE.
   180         88  EXCESS-LEVEL                        VALUE 'X'.
   181         88  NO-LEVEL                            VALUE ' '.
   182         88  VALID-PERCENT                       VALUE 'X' ' '.
   183
   184     05  WS-CHECK-QTED               PIC X       VALUE SPACE.
   185         88  VALID-QTED-CALC                     VALUE '1' '2'
   186                                                       '3' '4'
   187                                                       ' '.
   188
   189     05  WS-CHECK-BEN-CODE           PIC X      VALUE SPACE.
   190         88  VALID-BEN-CODE                     VALUE 'A' THRU 'N'
   191                                                  'P' 'R' 'S' ' '
   192                                                      '2' '3' '4'
   193                                                      '7' '8'.
   194
   195     05  WS-CHECK-INTR               PIC X       VALUE SPACE.
   196         88  VALID-INTR-CODE                     VALUE 'X' 'Y' 'Z'
   197                                                       'E' 'W'
   198                                                       'N' ' '.
   199
   200     05  WS-CHECK-REM                PIC X       VALUE SPACE.
   201         88  VALID-REM-SW                        VALUE 'X' 'Y' 'N'
   202                                                       'R' 'L' 'Z'
   203                                                       ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL651.cbl
   204
   205     05  WS-STATE-FOUND-SW           PIC X       VALUE SPACE.
   206         88  STATE-FOUND                         VALUE 'Y'.
   207
   208     05  WS-CARRIER-FOUND-SW         PIC X       VALUE SPACE.
   209         88  CARRIER-FOUND                       VALUE 'Y'.
   210
   211     05  WS-ACCESS.
   212         10  WS-STATE                PIC XX      VALUE SPACES.
   213         10  FILLER                  PIC XX      VALUE SPACES.
   214     05  CARRIER-ACCESS      REDEFINES
   215         WS-ACCESS.
   216         10  FILLER                  PIC X(3).
   217         10  WS-CARRIER              PIC X.
   218
   219     05  ELCNTL-KEY.
   220         10  CNTL-COMP-ID            PIC X(3)    VALUE SPACES.
   221         10  CNTL-REC-TYPE           PIC X       VALUE SPACES.
   222         10  CNTL-ACCESS             PIC X(4)    VALUE SPACES.
   223         10  CNTL-SEQ-NO             PIC S9(4)   VALUE +0  COMP.
   224
   225     05  MISC-SAVE-AREAS.
   226         10  WS-LO-HI-DATES.
   227             15  WS-LO-DATE          PIC 9(8).
   228             15  WS-HI-DATE          PIC 9(8).
   229         10  WS-LIFE-AGE-TRMS.
   230             15  WS-LFAGE-LO         PIC 99.
   231             15  WS-LFAGE-HI         PIC 99.
   232             15  WS-LFTRM-LO         PIC S999.
   233             15  WS-LFTRM-HI         PIC S999.
   234         10  WS-AH-AGE-TRMS.
   235             15  WS-AHAGE-LO         PIC 99.
   236             15  WS-AHAGE-HI         PIC 99.
   237             15  WS-AHTRM-LO         PIC S999.
   238             15  WS-AHTRM-HI         PIC S999.
   239         10  WS-LIFE-BEN-AMTS.
   240             15  WS-LF-LIM-LO        PIC S9(9)V99.
   241             15  WS-LF-LIM-HI        PIC S9(9)V99.
   242             15  WS-LF-LO            PIC S9(9)V99.
   243             15  WS-LF-HI            PIC S9(9)V99.
   244         10  WS-AH-BEN-AMTS.
   245             15  WS-AHBEN-LIM-LO     PIC S9(7)V99.
   246             15  WS-AHBEN-LIM-HI     PIC S9(7)V99.
   247             15  WS-AHMOA-LIM-LO     PIC S9(7)V99.
   248             15  WS-AHMOA-LIM-HI     PIC S9(7)V99.
   249             15  WS-AHBEN-LO         PIC S9(7)V99.
   250             15  WS-AHBEN-HI         PIC S9(7)V99.
   251             15  WS-AHMOA-LO         PIC S9(7)V99.
   252             15  WS-AHMOA-HI         PIC S9(7)V99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL651.cbl
   254     05  ERROR-MESSAGES.
   255         10  ER-0000                 PIC X(4)    VALUE '0000'.
   256         10  ER-0004                 PIC X(4)    VALUE '0004'.
   257         10  ER-0008                 PIC X(4)    VALUE '0008'.
   258         10  ER-0023                 PIC X(4)    VALUE '0023'.
   259         10  ER-0029                 PIC X(4)    VALUE '0029'.
   260         10  ER-0050                 PIC X(4)    VALUE '0050'.
   261         10  ER-0068                 PIC X(4)    VALUE '0068'.
   262         10  ER-0070                 PIC X(4)    VALUE '0070'.
   263         10  ER-0142                 PIC X(4)    VALUE '0142'.
   264         10  ER-0585                 PIC X(4)    VALUE '0585'.
   265         10  ER-0589                 PIC X(4)    VALUE '0589'.
   266         10  ER-0592                 PIC X(4)    VALUE '0592'.
   267         10  ER-0593                 PIC X(4)    VALUE '0593'.
   268         10  ER-2055                 PIC X(4)    VALUE '2055'.
   269         10  ER-2056                 PIC X(4)    VALUE '2056'.
   270         10  ER-2067                 PIC X(4)    VALUE '2067'.
   271         10  ER-2112                 PIC X(4)    VALUE '2112'.
   272         10  ER-2139                 PIC X(4)    VALUE '2139'.
   273         10  ER-2140                 PIC X(4)    VALUE '2140'.
   274         10  ER-2141                 PIC X(4)    VALUE '2141'.
   275         10  ER-2208                 PIC X(4)    VALUE '2208'.
   276         10  ER-2310                 PIC X(4)    VALUE '2310'.
   277         10  ER-2311                 PIC X(4)    VALUE '2311'.
   278         10  ER-2312                 PIC X(4)    VALUE '2312'.
   279         10  ER-2313                 PIC X(4)    VALUE '2313'.
   280         10  ER-2316                 PIC X(4)    VALUE '2316'.
   281         10  ER-2317                 PIC X(4)    VALUE '2317'.
   282         10  ER-2318                 PIC X(4)    VALUE '2318'.
   283         10  ER-2319                 PIC X(4)    VALUE '2319'.
   284         10  ER-2320                 PIC X(4)    VALUE '2320'.
   285         10  ER-2321                 PIC X(4)    VALUE '2321'.
   286         10  ER-2322                 PIC X(4)    VALUE '2322'.
   287         10  ER-2323                 PIC X(4)    VALUE '2323'.
   288         10  ER-2324                 PIC X(4)    VALUE '2324'.
   289         10  ER-2325                 PIC X(4)    VALUE '2325'.
   290         10  ER-2326                 PIC X(4)    VALUE '2326'.
   291         10  ER-2327                 PIC X(4)    VALUE '2327'.
   292         10  ER-2328                 PIC X(4)    VALUE '2328'.
   293         10  ER-2329                 PIC X(4)    VALUE '2329'.
   294         10  ER-2330                 PIC X(4)    VALUE '2330'.
   295         10  ER-2331                 PIC X(4)    VALUE '2331'.
   296         10  ER-2333                 PIC X(4)    VALUE '2333'.
   297         10  ER-2334                 PIC X(4)    VALUE '2334'.
   298         10  ER-2335                 PIC X(4)    VALUE '2335'.
   299         10  ER-2338                 PIC X(4)    VALUE '2338'.
   300         10  ER-2339                 PIC X(4)    VALUE '2339'.
   301         10  ER-2340                 PIC X(4)    VALUE '2340'.
   302         10  ER-2341                 PIC X(4)    VALUE '2341'.
   303         10  ER-2342                 PIC X(4)    VALUE '2342'.
   304         10  ER-2343                 PIC X(4)    VALUE '2343'.
   305         10  ER-2344                 PIC X(4)    VALUE '2344'.
   306         10  ER-2345                 PIC X(4)    VALUE '2345'.
   307         10  ER-2346                 PIC X(4)    VALUE '2346'.
   308         10  ER-2347                 PIC X(4)    VALUE '2347'.
   309         10  ER-2348                 PIC X(4)    VALUE '2348'.
   310         10  ER-2356                 PIC X(4)    VALUE '2356'.
   311         10  ER-2370                 PIC X(4)    VALUE '2370'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL651.cbl
   312         10  ER-4008                 PIC X(4)    VALUE '4008'.
   313         10  ER-7805                 PIC X(4)    VALUE '7805'.
   314
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL651.cbl
   316*                                    COPY ELCDATE.
   317******************************************************************
   318*                                                                *
   319*                                                                *
   320*                            ELCDATE.                            *
   321*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   322*                            VMOD=2.003
   323*                                                                *
   324*                                                                *
   325*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   326*                 LENGTH = 200                                   *
   327******************************************************************
   328
   329 01  DATE-CONVERSION-DATA.
   330     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   331     12  DC-OPTION-CODE                PIC X.
   332         88  BIN-TO-GREG                VALUE ' '.
   333         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   334         88  EDIT-GREG-TO-BIN           VALUE '2'.
   335         88  YMD-GREG-TO-BIN            VALUE '3'.
   336         88  MDY-GREG-TO-BIN            VALUE '4'.
   337         88  JULIAN-TO-BIN              VALUE '5'.
   338         88  BIN-PLUS-ELAPSED           VALUE '6'.
   339         88  FIND-CENTURY               VALUE '7'.
   340         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   341         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   342         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   343         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   344         88  JULIAN-TO-BIN-3            VALUE 'C'.
   345         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   346         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   347         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   348         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   349         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   350         88  CHECK-LEAP-YEAR            VALUE 'H'.
   351         88  BIN-3-TO-GREG              VALUE 'I'.
   352         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   353         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   354         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   355         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   356         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   357         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   358         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   359         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   360         88  THREE-CHARACTER-BIN
   361                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   362         88  GREGORIAN-TO-BIN
   363                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   364         88  BIN-TO-GREGORIAN
   365                  VALUES ' ' '1' 'I' '8' 'G'.
   366         88  JULIAN-TO-BINARY
   367                  VALUES '5' 'C' 'E' 'F'.
   368     12  DC-ERROR-CODE                 PIC X.
   369         88  NO-CONVERSION-ERROR        VALUE ' '.
   370         88  DATE-CONVERSION-ERROR
   371                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   372         88  DATE-IS-ZERO               VALUE '1'.
   373         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL651.cbl
   374         88  DATE-IS-INVALID            VALUE '3'.
   375         88  DATE1-GREATER-DATE2        VALUE '4'.
   376         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   377         88  DATE-INVALID-OPTION        VALUE '9'.
   378         88  INVALID-CENTURY            VALUE 'A'.
   379         88  ONLY-CENTURY               VALUE 'B'.
   380         88  ONLY-LEAP-YEAR             VALUE 'C'.
   381         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   382     12  DC-END-OF-MONTH               PIC X.
   383         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   384     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   385         88  USE-NORMAL-PROCESS         VALUE ' '.
   386         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   387         88  ADJUST-UP-100-YRS          VALUE '2'.
   388     12  FILLER                        PIC X.
   389     12  DC-CONVERSION-DATES.
   390         16  DC-BIN-DATE-1             PIC XX.
   391         16  DC-BIN-DATE-2             PIC XX.
   392         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   393         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   394                       DC-GREG-DATE-1-EDIT.
   395             20  DC-EDIT1-MONTH        PIC 99.
   396             20  SLASH1-1              PIC X.
   397             20  DC-EDIT1-DAY          PIC 99.
   398             20  SLASH1-2              PIC X.
   399             20  DC-EDIT1-YEAR         PIC 99.
   400         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   401         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   402                     DC-GREG-DATE-2-EDIT.
   403             20  DC-EDIT2-MONTH        PIC 99.
   404             20  SLASH2-1              PIC X.
   405             20  DC-EDIT2-DAY          PIC 99.
   406             20  SLASH2-2              PIC X.
   407             20  DC-EDIT2-YEAR         PIC 99.
   408         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   409         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   410                     DC-GREG-DATE-1-YMD.
   411             20  DC-YMD-YEAR           PIC 99.
   412             20  DC-YMD-MONTH          PIC 99.
   413             20  DC-YMD-DAY            PIC 99.
   414         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   415         16  DC-GREG-DATE-1-MDY-R REDEFINES
   416                      DC-GREG-DATE-1-MDY.
   417             20  DC-MDY-MONTH          PIC 99.
   418             20  DC-MDY-DAY            PIC 99.
   419             20  DC-MDY-YEAR           PIC 99.
   420         16  DC-GREG-DATE-1-ALPHA.
   421             20  DC-ALPHA-MONTH        PIC X(10).
   422             20  DC-ALPHA-DAY          PIC 99.
   423             20  FILLER                PIC XX.
   424             20  DC-ALPHA-CENTURY.
   425                 24 DC-ALPHA-CEN-N     PIC 99.
   426             20  DC-ALPHA-YEAR         PIC 99.
   427         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   428         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   429         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   430         16  DC-JULIAN-DATE            PIC 9(05).
   431         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL651.cbl
   432                                       PIC 9(05).
   433         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   434             20  DC-JULIAN-YEAR        PIC 99.
   435             20  DC-JULIAN-DAYS        PIC 999.
   436         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   437         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   438         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   439     12  DATE-CONVERSION-VARIBLES.
   440         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   441         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   442             20  FILLER                PIC 9(3).
   443             20  HOLD-CEN-1-CCYY.
   444                 24  HOLD-CEN-1-CC     PIC 99.
   445                 24  HOLD-CEN-1-YY     PIC 99.
   446             20  HOLD-CEN-1-MO         PIC 99.
   447             20  HOLD-CEN-1-DA         PIC 99.
   448         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   449             20  HOLD-CEN-1-R-MO       PIC 99.
   450             20  HOLD-CEN-1-R-DA       PIC 99.
   451             20  HOLD-CEN-1-R-CCYY.
   452                 24  HOLD-CEN-1-R-CC   PIC 99.
   453                 24  HOLD-CEN-1-R-YY   PIC 99.
   454             20  FILLER                PIC 9(3).
   455         16  HOLD-CENTURY-1-X.
   456             20  FILLER                PIC X(3)  VALUE SPACES.
   457             20  HOLD-CEN-1-X-CCYY.
   458                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   459                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   460             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   461             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   462         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   463             20  HOLD-CEN-1-R-X-MO     PIC XX.
   464             20  HOLD-CEN-1-R-X-DA     PIC XX.
   465             20  HOLD-CEN-1-R-X-CCYY.
   466                 24  HOLD-CEN-1-R-X-CC PIC XX.
   467                 24  HOLD-CEN-1-R-X-YY PIC XX.
   468             20  FILLER                PIC XXX.
   469         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   470         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   471         16  DC-JULIAN-DATE-1          PIC 9(07).
   472         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   473             20  DC-JULIAN-1-CCYY.
   474                 24  DC-JULIAN-1-CC    PIC 99.
   475                 24  DC-JULIAN-1-YR    PIC 99.
   476             20  DC-JULIAN-DA-1        PIC 999.
   477         16  DC-JULIAN-DATE-2          PIC 9(07).
   478         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   479             20  DC-JULIAN-2-CCYY.
   480                 24  DC-JULIAN-2-CC    PIC 99.
   481                 24  DC-JULIAN-2-YR    PIC 99.
   482             20  DC-JULIAN-DA-2        PIC 999.
   483         16  DC-GREG-DATE-A-EDIT.
   484             20  DC-EDITA-MONTH        PIC 99.
   485             20  SLASHA-1              PIC X VALUE '/'.
   486             20  DC-EDITA-DAY          PIC 99.
   487             20  SLASHA-2              PIC X VALUE '/'.
   488             20  DC-EDITA-CCYY.
   489                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL651.cbl
   490                 24  DC-EDITA-YEAR     PIC 99.
   491         16  DC-GREG-DATE-B-EDIT.
   492             20  DC-EDITB-MONTH        PIC 99.
   493             20  SLASHB-1              PIC X VALUE '/'.
   494             20  DC-EDITB-DAY          PIC 99.
   495             20  SLASHB-2              PIC X VALUE '/'.
   496             20  DC-EDITB-CCYY.
   497                 24  DC-EDITB-CENT     PIC 99.
   498                 24  DC-EDITB-YEAR     PIC 99.
   499         16  DC-GREG-DATE-CYMD         PIC 9(08).
   500         16  DC-GREG-DATE-CYMD-R REDEFINES
   501                              DC-GREG-DATE-CYMD.
   502             20  DC-CYMD-CEN           PIC 99.
   503             20  DC-CYMD-YEAR          PIC 99.
   504             20  DC-CYMD-MONTH         PIC 99.
   505             20  DC-CYMD-DAY           PIC 99.
   506         16  DC-GREG-DATE-MDCY         PIC 9(08).
   507         16  DC-GREG-DATE-MDCY-R REDEFINES
   508                              DC-GREG-DATE-MDCY.
   509             20  DC-MDCY-MONTH         PIC 99.
   510             20  DC-MDCY-DAY           PIC 99.
   511             20  DC-MDCY-CEN           PIC 99.
   512             20  DC-MDCY-YEAR          PIC 99.
   513    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   514        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   515    12  DC-EL310-DATE                  PIC X(21).
   516    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL651.cbl
   518*                                    COPY ELCLOGOF.
   519******************************************************************
   520*                                                                *
   521*                                                                *
   522*                            ELCLOGOF.                           *
   523*                            VMOD=2.001                          *
   524*                                                                *
   525*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   526*                                                                *
   527******************************************************************
   528 01  CLASIC-LOGOFF.
   529     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   530     12  LOGOFF-TEXT.
   531         16  FILLER          PIC X(5)    VALUE SPACES.
   532         16  LOGOFF-MSG.
   533             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   534             20  FILLER      PIC X       VALUE SPACES.
   535             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   536         16  FILLER          PIC X(80)
   537           VALUE '* YOU ARE NOW LOGGED OFF'.
   538         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   539         16  FILLER          PIC X       VALUE QUOTE.
   540         16  LOGOFF-SYS-MSG  PIC X(17)
   541           VALUE 'S CLAS-IC SYSTEM '.
   542     12  TEXT-MESSAGES.
   543         16  UNACCESS-MSG    PIC X(29)
   544             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   545         16  PGMIDERR-MSG    PIC X(17)
   546             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL651.cbl
   548*                                    COPY ELCATTR.
   549******************************************************************
   550*                                                                *
   551*                            ELCATTR.                            *
   552*                            VMOD=2.001                          *
   553*                                                                *
   554*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   555*                                                                *
   556*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   557*                                                                *
   558*                   POS 1   P=PROTECTED                          *
   559*                           U=UNPROTECTED                        *
   560*                           S=ASKIP                              *
   561*                   POS 2   A=ALPHA/NUMERIC                      *
   562*                           N=NUMERIC                            *
   563*                   POS 3   N=NORMAL                             *
   564*                           B=BRIGHT                             *
   565*                           D=DARK                               *
   566*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   567*                           OF=MODIFIED DATA TAG OFF             *
   568*                                                                *
   569*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   570******************************************************************
   571 01  ATTRIBUTE-LIST.
   572     12  AL-PABOF            PIC X       VALUE 'Y'.
   573     12  AL-PABON            PIC X       VALUE 'Z'.
   574     12  AL-PADOF            PIC X       VALUE '%'.
   575     12  AL-PADON            PIC X       VALUE '_'.
   576     12  AL-PANOF            PIC X       VALUE '-'.
   577     12  AL-PANON            PIC X       VALUE '/'.
   578     12  AL-SABOF            PIC X       VALUE '8'.
   579     12  AL-SABON            PIC X       VALUE '9'.
   580     12  AL-SADOF            PIC X       VALUE '@'.
   581     12  AL-SADON            PIC X       VALUE QUOTE.
   582     12  AL-SANOF            PIC X       VALUE '0'.
   583     12  AL-SANON            PIC X       VALUE '1'.
   584     12  AL-UABOF            PIC X       VALUE 'H'.
   585     12  AL-UABON            PIC X       VALUE 'I'.
   586     12  AL-UADOF            PIC X       VALUE '<'.
   587     12  AL-UADON            PIC X       VALUE '('.
   588     12  AL-UANOF            PIC X       VALUE ' '.
   589     12  AL-UANON            PIC X       VALUE 'A'.
   590     12  AL-UNBOF            PIC X       VALUE 'Q'.
   591     12  AL-UNBON            PIC X       VALUE 'R'.
   592     12  AL-UNDOF            PIC X       VALUE '*'.
   593     12  AL-UNDON            PIC X       VALUE ')'.
   594     12  AL-UNNOF            PIC X       VALUE '&'.
   595     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL651.cbl
   597*                                    COPY ELCEMIB.
   598******************************************************************
   599*                                                                *
   600*                                                                *
   601*                            ELCEMIB.                            *
   602*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   603*                            VMOD=2.005                          *
   604*                                                                *
   605*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   606*                                                                *
   607******************************************************************
   608 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   609     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   610     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   611     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   612     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   613     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   614     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   615     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   616     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   617     12  EMI-SWITCH1             PIC X        VALUE '1'.
   618         88  EMI-NO-ERRORS                    VALUE '1'.
   619         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   620         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   621     12  EMI-SWITCH2             PIC X        VALUE '1'.
   622         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   623     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   624         88  EMI-AREA1-EMPTY                  VALUE '1'.
   625         88  EMI-AREA1-FULL                   VALUE '2'.
   626     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   627         88  EMI-AREA2-EMPTY                  VALUE '1'.
   628         88  EMI-AREA2-FULL                   VALUE '2'.
   629     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   630         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   631         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   632         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   633         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   634         88  EMI-BYPASS-FATALS                VALUE 'X'.
   635     12  EMI-ERROR-LINES.
   636         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   637         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   638         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   639         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   640             20  EMI-ERR-CODES OCCURS 10 TIMES.
   641                 24  EMI-ERR-NUM         PIC X(4).
   642                 24  EMI-FILLER          PIC X.
   643                 24  EMI-SEV             PIC X.
   644                 24  FILLER              PIC X.
   645             20  FILLER                  PIC X(02).
   646     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   647         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   648             20  EMI-ERROR-NUMBER    PIC X(4).
   649             20  EMI-FILL            PIC X.
   650             20  EMI-SEVERITY        PIC X.
   651             20  FILLER              PIC X.
   652             20  EMI-ERROR-TEXT.
   653                 24  EMI-TEXT-VARIABLE   PIC X(10).
   654                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL651.cbl
   655     12  EMI-SEVERITY-SAVE           PIC X.
   656         88  EMI-NOTE                    VALUE 'N'.
   657         88  EMI-WARNING                 VALUE 'W'.
   658         88  EMI-FORCABLE                VALUE 'F'.
   659         88  EMI-FATAL                   VALUE 'X'.
   660     12  EMI-MESSAGE-FLAG            PIC X.
   661         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   662         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   663     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   664     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   665         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   666         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   667         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   668     12  FILLER                      PIC X(137)  VALUE SPACES.
   669     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   670     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   671     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   672     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL651.cbl
   674*                                    COPY ELCINTF.
   675******************************************************************
   676*                                                                *
   677*                                                                *
   678*                            ELCINTF.                            *
   679*                            VMOD=2.017                          *
   680*                                                                *
   681*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   682*                                                                *
   683*       LENGTH = 1024                                            *
   684*                                                                *
   685******************************************************************
   686 01  PROGRAM-INTERFACE-BLOCK.
   687     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   688     12  PI-CALLING-PROGRAM              PIC X(8).
   689     12  PI-SAVED-PROGRAM-1              PIC X(8).
   690     12  PI-SAVED-PROGRAM-2              PIC X(8).
   691     12  PI-SAVED-PROGRAM-3              PIC X(8).
   692     12  PI-SAVED-PROGRAM-4              PIC X(8).
   693     12  PI-SAVED-PROGRAM-5              PIC X(8).
   694     12  PI-SAVED-PROGRAM-6              PIC X(8).
   695     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   696     12  PI-COMPANY-ID                   PIC XXX.
   697     12  PI-COMPANY-CD                   PIC X.
   698
   699     12  PI-COMPANY-PASSWORD             PIC X(8).
   700
   701     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   702
   703     12  PI-CONTROL-IN-PROGRESS.
   704         16  PI-CARRIER                  PIC X.
   705         16  PI-GROUPING                 PIC X(6).
   706         16  PI-STATE                    PIC XX.
   707         16  PI-ACCOUNT                  PIC X(10).
   708         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   709                                         PIC X(10).
   710         16  PI-CLAIM-CERT-GRP.
   711             20  PI-CLAIM-NO             PIC X(7).
   712             20  PI-CERT-NO.
   713                 25  PI-CERT-PRIME       PIC X(10).
   714                 25  PI-CERT-SFX         PIC X.
   715             20  PI-CERT-EFF-DT          PIC XX.
   716         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   717             20  PI-PLAN-CODE            PIC X(2).
   718             20  PI-REVISION-NUMBER      PIC X(3).
   719             20  PI-PLAN-EFF-DT          PIC X(2).
   720             20  PI-PLAN-EXP-DT          PIC X(2).
   721             20  FILLER                  PIC X(11).
   722         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   723             20  PI-OE-REFERENCE-1.
   724                 25  PI-OE-REF-1-PRIME   PIC X(18).
   725                 25  PI-OE-REF-1-SUFF    PIC XX.
   726
   727     12  PI-SESSION-IN-PROGRESS          PIC X.
   728         88  CLAIM-SESSION                   VALUE '1'.
   729         88  CREDIT-SESSION                  VALUE '2'.
   730         88  WARRANTY-SESSION                VALUE '3'.
   731         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL651.cbl
   732         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   733
   734
   735*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   736
   737     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   738     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   739
   740     12  PI-CREDIT-USER                  PIC X.
   741         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   742         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   743
   744     12  PI-CLAIM-USER                   PIC X.
   745         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   746         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   747
   748     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   749         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   750         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   751         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   752         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   753         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   754
   755     12  PI-PROCESSOR-ID                 PIC X(4).
   756
   757     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   758
   759     12  PI-MEMBER-CAPTION               PIC X(10).
   760
   761     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   762         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   763
   764     12  PI-LIFE-OVERRIDE-L1             PIC X.
   765     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   766     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   767     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   768
   769     12  PI-AH-OVERRIDE-L1               PIC X.
   770     12  PI-AH-OVERRIDE-L2               PIC XX.
   771     12  PI-AH-OVERRIDE-L6               PIC X(6).
   772     12  PI-AH-OVERRIDE-L12              PIC X(12).
   773
   774     12  PI-NEW-SYSTEM                   PIC X(2).
   775
   776     12  PI-PRIMARY-CERT-NO              PIC X(11).
   777     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   778         88  PI-USES-PAID-TO                 VALUE '1'.
   779     12  PI-CRDTCRD-SYSTEM.
   780         16  PI-CRDTCRD-USER             PIC X.
   781             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   782             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   783         16  PI-CC-MONTH-END-DT          PIC XX.
   784     12  PI-PROCESSOR-PRINTER            PIC X(4).
   785
   786     12  PI-OE-REFERENCE-2.
   787         16  PI-OE-REF-2-PRIME           PIC X(10).
   788         16  PI-OE-REF-2-SUFF            PIC X.
   789
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL651.cbl
   790     12  PI-REM-TRM-CALC-OPTION          PIC X.
   791
   792     12  PI-LANGUAGE-TYPE                PIC X.
   793             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   794             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   795             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   796
   797     12  PI-POLICY-LINKAGE-IND           PIC X.
   798         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   799         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   800                                                   LOW-VALUES.
   801
   802     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   803     12  PI-CLAIM-PW-SESSION             PIC X(1).
   804         88  PI-CLAIM-CREDIT                 VALUE '1'.
   805         88  PI-CLAIM-CONVEN                 VALUE '2'.
   806     12  FILLER                          PIC X(4).
   807
   808     12  PI-SYSTEM-LEVEL                 PIC X(145).
   809
   810     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   811         PI-SYSTEM-LEVEL.
   812
   813         16  PI-ENTRY-CODES.
   814             20  PI-ENTRY-CD-1           PIC X.
   815             20  PI-ENTRY-CD-2           PIC X.
   816
   817         16  PI-RETURN-CODES.
   818             20  PI-RETURN-CD-1          PIC X.
   819             20  PI-RETURN-CD-2          PIC X.
   820
   821         16  PI-UPDATE-STATUS-SAVE.
   822             20  PI-UPDATE-BY            PIC X(4).
   823             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   824
   825         16  PI-LOWER-CASE-LETTERS       PIC X.
   826             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   827
   828*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   829*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   830*            88  CARRIER-CLM-CNTL            VALUE '2'.
   831
   832         16  PI-CERT-ACCESS-CONTROL      PIC X.
   833             88  ST-ACCNT-CNTL               VALUE ' '.
   834             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   835             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   836             88  ACCNT-CNTL                  VALUE '3'.
   837             88  CARR-ACCNT-CNTL             VALUE '4'.
   838
   839         16  PI-PROCESSOR-CAP-LIST.
   840             20  PI-SYSTEM-CONTROLS.
   841                24 PI-SYSTEM-DISPLAY     PIC X.
   842                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   843                24 PI-SYSTEM-MODIFY      PIC X.
   844                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   845             20  FILLER                  PIC XX.
   846             20  PI-DISPLAY-CAP          PIC X.
   847                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL651.cbl
   848             20  PI-MODIFY-CAP           PIC X.
   849                 88  MODIFY-CAP              VALUE 'Y'.
   850             20  PI-MSG-AT-LOGON-CAP     PIC X.
   851                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   852             20  PI-FORCE-CAP            PIC X.
   853                 88  FORCE-CAP               VALUE 'Y'.
   854
   855         16  PI-PROGRAM-CONTROLS.
   856             20  PI-PGM-PRINT-OPT        PIC X.
   857             20  PI-PGM-FORMAT-OPT       PIC X.
   858             20  PI-PGM-PROCESS-OPT      PIC X.
   859             20  PI-PGM-TOTALS-OPT       PIC X.
   860
   861         16  PI-HELP-INTERFACE.
   862             20  PI-LAST-ERROR-NO        PIC X(4).
   863             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   864
   865         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   866             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   867
   868         16  PI-CR-CONTROL-IN-PROGRESS.
   869             20  PI-CR-CARRIER           PIC X.
   870             20  PI-CR-GROUPING          PIC X(6).
   871             20  PI-CR-STATE             PIC XX.
   872             20  PI-CR-ACCOUNT           PIC X(10).
   873             20  PI-CR-FIN-RESP          PIC X(10).
   874             20  PI-CR-TYPE              PIC X.
   875
   876         16  PI-CR-BATCH-NUMBER          PIC X(6).
   877
   878         16  PI-CR-MONTH-END-DT          PIC XX.
   879
   880         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   881             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   882             88  PI-ZERO-CARRIER             VALUE '1'.
   883             88  PI-ZERO-GROUPING            VALUE '2'.
   884             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   885
   886         16  PI-CARRIER-SECURITY         PIC X.
   887             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   888
   889         16  PI-ACCOUNT-SECURITY         PIC X(10).
   890             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   891             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   892
   893         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   894             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   895                                         INDEXED BY PI-ACCESS-NDX
   896                                         PIC X.
   897
   898         16  PI-GA-BILLING-CONTROL       PIC X.
   899             88  PI-GA-BILLING               VALUE '1'.
   900
   901         16  PI-MAIL-PROCESSING          PIC X.
   902             88  PI-MAIL-YES                 VALUE 'Y'.
   903
   904         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   905
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL651.cbl
   906         16  PI-AR-SYSTEM.
   907             20  PI-AR-PROCESSING-CNTL   PIC X.
   908                 88  PI-AR-PROCESSING        VALUE 'Y'.
   909             20  PI-AR-SUMMARY-CODE      PIC X(6).
   910             20  PI-AR-MONTH-END-DT      PIC XX.
   911
   912         16  PI-MP-SYSTEM.
   913             20  PI-MORTGAGE-USER            PIC X.
   914                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   915                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   916             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   917                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   918                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   919                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   920                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   921                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   922             20  PI-MP-MONTH-END-DT          PIC XX.
   923             20  PI-MP-REFERENCE-NO.
   924                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   925                 24  PI-MP-REFERENCE-SFX     PIC XX.
   926
   927         16  PI-LABEL-CONTROL            PIC X(01).
   928             88  PI-CREATE-LABELS                    VALUE 'Y'.
   929             88  PI-BYPASS-LABELS                    VALUE 'N'.
   930
   931         16  PI-BILL-GROUPING-CODE       PIC X(01).
   932             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   933
   934         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   935             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   936             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   937
   938         16  FILLER                      PIC X(14).
   939
   940     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   941******************************************************************
   942     12  PI-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
   943         16  PI-CHECK-MAINT-TYPE     PIC X.
   944             88  VALID-MAINT-TYPE                VALUE 'S' 'A' 'C'
   945                                                       'D' 'K'.
   946             88  ADD-FUNCTION                    VALUE 'A'.
   947             88  SHOW-FUNCTION                   VALUE 'S'.
   948             88  DELETE-FUNCTION                 VALUE 'D'.
   949             88  CHANGE-FUNCTION                 VALUE 'C'.
   950             88  COPY-FUNCTION                   VALUE 'K'.
   951
   952         16  PI-PREV-MAINTYP         PIC X.
   953
   954         16  PI-ERREIN-KEY.
   955             20  PI-ERR-COMPANY-CD   PIC X.
   956             20  PI-ERR-CODE         PIC X.
   957             20  PI-ERR-TABLE        PIC X(3).
   958             20  PI-ERR-TABLE-SUB    PIC X(3).
   959
   960         16  PI-START-LEVEL          PIC 9(2).
   961
   962         16  PI-SAVE-ERREIN-KEY      PIC X(8).
   963
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL651.cbl
   964         16  PI-FIRST-TIME-SW        PIC X.
   965             88  FIRST-TIME                      VALUE 'Y'.
   966         16  PI-ENTRY-SW             PIC X.
   967             88  NOT-FIRST-ENTRY                 VALUE 'Y'.
   968         16  PI-BROWSE-SW            PIC X.
   969             88  BROWSE-STARTED                  VALUE 'Y'.
   970         16  PI-ERREIN-EOF-SW        PIC X.
   971             88  ERREIN-EOF                      VALUE 'Y'.
   972         16  PI-EXCESS-SW            PIC X.
   973             88  EXCESS-LEVEL-EXISTS             VALUE 'X'.
   974         16  PI-COMPANY-ADD-SW       PIC X.
   975             88  COMPANY-RECORD-ADDED            VALUE 'Y'.
   976
   977         16  PI-SUB                  PIC S99.
   978         16  PI-LAST-LEVEL           PIC S99.
   979
   980         16  PI-SAVE-TABLE           PIC X(3).
   981         16  PI-SAVE-COMPANY         PIC X(3).
   982         16  PI-SAVE-COMP-SUB        PIC X(3).
   983         16  PI-MAPNAME              PIC X(8).
   984         16  FILLER                  PIC X(593).
   985
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL651.cbl
   987*                                    COPY ELCJPFX.
   988******************************************************************
   989*                                                                *
   990*                                                                *
   991*                            ELCJPFX.                            *
   992*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   993*                            VMOD=2.002                          *
   994*                                                                *
   995*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   996*                                                                *
   997*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   998*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   999*        ELCNTL - CONTROL FILE                                   *
  1000*        ELMSTR - CLAIM MASTERS                                  *
  1001*        ELTRLR - ACTIVITY TRAILERS                              *
  1002*        ELCHKQ - CHECK QUE                                      *
  1003******************************************************************
  1004 01  JOURNAL-RECORD.
  1005     12  JP-USER-ID                  PIC X(4).
  1006     12  JP-FILE-ID                  PIC X(8).
  1007     12  JP-PROGRAM-ID               PIC X(8).
  1008     12  JP-RECORD-TYPE              PIC X.
  1009         88 JP-ADD              VALUE 'A'.
  1010         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1011         88 JP-AFTER-CHANGE     VALUE 'C'.
  1012         88 JP-DELETE           VALUE 'D'.
  1013         88 JP-GENERIC-DELETE   VALUE 'G'.
  1014         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1015         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1016     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1017     12  JP-RECORD-AREA
  1018
  1019
  1020                                     PIC X(4000).
  1021
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL651.cbl
  1023*                                    COPY ELCAID.
  1024******************************************************************
  1025*                                                                *
  1026*                            ELCAID.                             *
  1027*                            VMOD=2.001                          *
  1028*                                                                *
  1029*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1030*                                                                *
  1031*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1032*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1033******************************************************************
  1034
  1035 01  DFHAID.
  1036   02  DFHNULL   PIC  X  VALUE  ' '.
  1037   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1038   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1039   02  DFHPEN    PIC  X  VALUE  '='.
  1040   02  DFHOPID   PIC  X  VALUE  'W'.
  1041   02  DFHPA1    PIC  X  VALUE  '%'.
  1042   02  DFHPA2    PIC  X  VALUE  '>'.
  1043   02  DFHPA3    PIC  X  VALUE  ','.
  1044   02  DFHPF1    PIC  X  VALUE  '1'.
  1045   02  DFHPF2    PIC  X  VALUE  '2'.
  1046   02  DFHPF3    PIC  X  VALUE  '3'.
  1047   02  DFHPF4    PIC  X  VALUE  '4'.
  1048   02  DFHPF5    PIC  X  VALUE  '5'.
  1049   02  DFHPF6    PIC  X  VALUE  '6'.
  1050   02  DFHPF7    PIC  X  VALUE  '7'.
  1051   02  DFHPF8    PIC  X  VALUE  '8'.
  1052   02  DFHPF9    PIC  X  VALUE  '9'.
  1053   02  DFHPF10   PIC  X  VALUE  ':'.
  1054   02  DFHPF11   PIC  X  VALUE  '#'.
  1055   02  DFHPF12   PIC  X  VALUE  '@'.
  1056   02  DFHPF13   PIC  X  VALUE  'A'.
  1057   02  DFHPF14   PIC  X  VALUE  'B'.
  1058   02  DFHPF15   PIC  X  VALUE  'C'.
  1059   02  DFHPF16   PIC  X  VALUE  'D'.
  1060   02  DFHPF17   PIC  X  VALUE  'E'.
  1061   02  DFHPF18   PIC  X  VALUE  'F'.
  1062   02  DFHPF19   PIC  X  VALUE  'G'.
  1063   02  DFHPF20   PIC  X  VALUE  'H'.
  1064   02  DFHPF21   PIC  X  VALUE  'I'.
  1065*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1066   02  DFHPF22   PIC  X  VALUE  '['.
  1067   02  DFHPF23   PIC  X  VALUE  '.'.
  1068   02  DFHPF24   PIC  X  VALUE  '<'.
  1069   02  DFHMSRE   PIC  X  VALUE  'X'.
  1070   02  DFHSTRF   PIC  X  VALUE  'h'.
  1071   02  DFHTRIG   PIC  X  VALUE  '"'.
  1072 01  FILLER    REDEFINES DFHAID.
  1073     05  FILLER                      PIC X(8).
  1074     05  PF-VALUES                   PIC X       OCCURS 2.
  1075
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL651.cbl
  1077*                                    COPY EL651S.
  1078 01  EL651AI.
  1079     05  FILLER            PIC  X(0012).
  1080*    -------------------------------
  1081     05  RUNDATEL PIC S9(0004) COMP.
  1082     05  RUNDATEF PIC  X(0001).
  1083     05  FILLER REDEFINES RUNDATEF.
  1084         10  RUNDATEA PIC  X(0001).
  1085     05  RUNDATEI PIC  X(0008).
  1086*    -------------------------------
  1087     05  RUNTIMEL PIC S9(0004) COMP.
  1088     05  RUNTIMEF PIC  X(0001).
  1089     05  FILLER REDEFINES RUNTIMEF.
  1090         10  RUNTIMEA PIC  X(0001).
  1091     05  RUNTIMEI PIC  X(0005).
  1092*    -------------------------------
  1093     05  MAINTYPL PIC S9(0004) COMP.
  1094     05  MAINTYPF PIC  X(0001).
  1095     05  FILLER REDEFINES MAINTYPF.
  1096         10  MAINTYPA PIC  X(0001).
  1097     05  MAINTYPI PIC  X(0001).
  1098*    -------------------------------
  1099     05  LMBYL PIC S9(0004) COMP.
  1100     05  LMBYF PIC  X(0001).
  1101     05  FILLER REDEFINES LMBYF.
  1102         10  LMBYA PIC  X(0001).
  1103     05  LMBYI PIC  X(0004).
  1104*    -------------------------------
  1105     05  LMDATEL PIC S9(0004) COMP.
  1106     05  LMDATEF PIC  X(0001).
  1107     05  FILLER REDEFINES LMDATEF.
  1108         10  LMDATEA PIC  X(0001).
  1109     05  LMDATEI PIC  X(0008).
  1110*    -------------------------------
  1111     05  LMTIMEL PIC S9(0004) COMP.
  1112     05  LMTIMEF PIC  X(0001).
  1113     05  FILLER REDEFINES LMTIMEF.
  1114         10  LMTIMEA PIC  X(0001).
  1115     05  LMTIMEI PIC  X(0005).
  1116*    -------------------------------
  1117     05  TABLEL PIC S9(0004) COMP.
  1118     05  TABLEF PIC  X(0001).
  1119     05  FILLER REDEFINES TABLEF.
  1120         10  TABLEA PIC  X(0001).
  1121     05  TABLEI PIC  X(0003).
  1122*    -------------------------------
  1123     05  COMPANYL PIC S9(0004) COMP.
  1124     05  COMPANYF PIC  X(0001).
  1125     05  FILLER REDEFINES COMPANYF.
  1126         10  COMPANYA PIC  X(0001).
  1127     05  COMPANYI PIC  X(0003).
  1128*    -------------------------------
  1129     05  COMPSUBL PIC S9(0004) COMP.
  1130     05  COMPSUBF PIC  X(0001).
  1131     05  FILLER REDEFINES COMPSUBF.
  1132         10  COMPSUBA PIC  X(0001).
  1133     05  COMPSUBI PIC  X(0003).
  1134*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL651.cbl
  1135     05  LEVELL PIC S9(0004) COMP.
  1136     05  LEVELF PIC  X(0001).
  1137     05  FILLER REDEFINES LEVELF.
  1138         10  LEVELA PIC  X(0001).
  1139     05  LEVELI PIC  X(0002).
  1140*    -------------------------------
  1141     05  OFLEVELL PIC S9(0004) COMP.
  1142     05  OFLEVELF PIC  X(0001).
  1143     05  FILLER REDEFINES OFLEVELF.
  1144         10  OFLEVELA PIC  X(0001).
  1145     05  OFLEVELI PIC  X(0002).
  1146*    -------------------------------
  1147     05  TOTABLEL PIC S9(0004) COMP.
  1148     05  TOTABLEF PIC  X(0001).
  1149     05  FILLER REDEFINES TOTABLEF.
  1150         10  TOTABLEA PIC  X(0001).
  1151     05  TOTABLEI PIC  X(0003).
  1152*    -------------------------------
  1153     05  CARDESCL PIC S9(0004) COMP.
  1154     05  CARDESCF PIC  X(0001).
  1155     05  FILLER REDEFINES CARDESCF.
  1156         10  CARDESCA PIC  X(0001).
  1157     05  CARDESCI PIC  X(0011).
  1158*    -------------------------------
  1159     05  CARRIERL PIC S9(0004) COMP.
  1160     05  CARRIERF PIC  X(0001).
  1161     05  FILLER REDEFINES CARRIERF.
  1162         10  CARRIERA PIC  X(0001).
  1163     05  CARRIERI PIC  X(0001).
  1164*    -------------------------------
  1165     05  PERCNTL PIC S9(0004) COMP.
  1166     05  PERCNTF PIC  X(0001).
  1167     05  FILLER REDEFINES PERCNTF.
  1168         10  PERCNTA PIC  X(0001).
  1169     05  PERCNTI PIC  X(0001).
  1170*    -------------------------------
  1171     05  LIFEHDL PIC S9(0004) COMP.
  1172     05  LIFEHDF PIC  X(0001).
  1173     05  FILLER REDEFINES LIFEHDF.
  1174         10  LIFEHDA PIC  X(0001).
  1175     05  LIFEHDI PIC  X(0004).
  1176*    -------------------------------
  1177     05  FDATEL PIC S9(0004) COMP.
  1178     05  FDATEF PIC  X(0001).
  1179     05  FILLER REDEFINES FDATEF.
  1180         10  FDATEA PIC  X(0001).
  1181     05  FDATEI PIC  X(0008).
  1182*    -------------------------------
  1183     05  TDATEL PIC S9(0004) COMP.
  1184     05  TDATEF PIC  X(0001).
  1185     05  FILLER REDEFINES TDATEF.
  1186         10  TDATEA PIC  X(0001).
  1187     05  TDATEI PIC  X(0008).
  1188*    -------------------------------
  1189     05  LFLOAGEL PIC S9(0004) COMP.
  1190     05  LFLOAGEF PIC  X(0001).
  1191     05  FILLER REDEFINES LFLOAGEF.
  1192         10  LFLOAGEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL651.cbl
  1193     05  LFLOAGEI PIC  X(0002).
  1194*    -------------------------------
  1195     05  LFHIAGEL PIC S9(0004) COMP.
  1196     05  LFHIAGEF PIC  X(0001).
  1197     05  FILLER REDEFINES LFHIAGEF.
  1198         10  LFHIAGEA PIC  X(0001).
  1199     05  LFHIAGEI PIC  X(0002).
  1200*    -------------------------------
  1201     05  LFLOTRML PIC S9(0004) COMP.
  1202     05  LFLOTRMF PIC  X(0001).
  1203     05  FILLER REDEFINES LFLOTRMF.
  1204         10  LFLOTRMA PIC  X(0001).
  1205     05  LFLOTRMI PIC  X(0003).
  1206*    -------------------------------
  1207     05  LFHITRML PIC S9(0004) COMP.
  1208     05  LFHITRMF PIC  X(0001).
  1209     05  FILLER REDEFINES LFHITRMF.
  1210         10  LFHITRMA PIC  X(0001).
  1211     05  LFHITRMI PIC  X(0003).
  1212*    -------------------------------
  1213     05  LFLOBENL PIC S9(0004) COMP.
  1214     05  LFLOBENF PIC  X(0001).
  1215     05  FILLER REDEFINES LFLOBENF.
  1216         10  LFLOBENA PIC  X(0001).
  1217     05  LFLOBENI PIC  9(14).
  1218*    -------------------------------
  1219     05  LFHIBENL PIC S9(0004) COMP.
  1220     05  LFHIBENF PIC  X(0001).
  1221     05  FILLER REDEFINES LFHIBENF.
  1222         10  LFHIBENA PIC  X(0001).
  1223     05  LFHIBENI PIC  9(14).
  1224*    -------------------------------
  1225     05  AHHD1L PIC S9(0004) COMP.
  1226     05  AHHD1F PIC  X(0001).
  1227     05  FILLER REDEFINES AHHD1F.
  1228         10  AHHD1A PIC  X(0001).
  1229     05  AHHD1I PIC  X(0003).
  1230*    -------------------------------
  1231     05  AHLOAGEL PIC S9(0004) COMP.
  1232     05  AHLOAGEF PIC  X(0001).
  1233     05  FILLER REDEFINES AHLOAGEF.
  1234         10  AHLOAGEA PIC  X(0001).
  1235     05  AHLOAGEI PIC  X(0002).
  1236*    -------------------------------
  1237     05  AHHIAGEL PIC S9(0004) COMP.
  1238     05  AHHIAGEF PIC  X(0001).
  1239     05  FILLER REDEFINES AHHIAGEF.
  1240         10  AHHIAGEA PIC  X(0001).
  1241     05  AHHIAGEI PIC  X(0002).
  1242*    -------------------------------
  1243     05  AHLOTRML PIC S9(0004) COMP.
  1244     05  AHLOTRMF PIC  X(0001).
  1245     05  FILLER REDEFINES AHLOTRMF.
  1246         10  AHLOTRMA PIC  X(0001).
  1247     05  AHLOTRMI PIC  X(0003).
  1248*    -------------------------------
  1249     05  AHHITRML PIC S9(0004) COMP.
  1250     05  AHHITRMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL651.cbl
  1251     05  FILLER REDEFINES AHHITRMF.
  1252         10  AHHITRMA PIC  X(0001).
  1253     05  AHHITRMI PIC  X(0003).
  1254*    -------------------------------
  1255     05  AHLOBENL PIC S9(0004) COMP.
  1256     05  AHLOBENF PIC  X(0001).
  1257     05  FILLER REDEFINES AHLOBENF.
  1258         10  AHLOBENA PIC  X(0001).
  1259     05  AHLOBENI PIC  9(12).
  1260*    -------------------------------
  1261     05  AHHIBENL PIC S9(0004) COMP.
  1262     05  AHHIBENF PIC  X(0001).
  1263     05  FILLER REDEFINES AHHIBENF.
  1264         10  AHHIBENA PIC  X(0001).
  1265     05  AHHIBENI PIC  9(12).
  1266*    -------------------------------
  1267     05  AHHD2L PIC S9(0004) COMP.
  1268     05  AHHD2F PIC  X(0001).
  1269     05  FILLER REDEFINES AHHD2F.
  1270         10  AHHD2A PIC  X(0001).
  1271     05  AHHD2I PIC  X(0003).
  1272*    -------------------------------
  1273     05  AMLOBENL PIC S9(0004) COMP.
  1274     05  AMLOBENF PIC  X(0001).
  1275     05  FILLER REDEFINES AMLOBENF.
  1276         10  AMLOBENA PIC  X(0001).
  1277     05  AMLOBENI PIC  9(12).
  1278*    -------------------------------
  1279     05  AMHIBENL PIC S9(0004) COMP.
  1280     05  AMHIBENF PIC  X(0001).
  1281     05  FILLER REDEFINES AMHIBENF.
  1282         10  AMHIBENA PIC  X(0001).
  1283     05  AMHIBENI PIC  9(12).
  1284*    -------------------------------
  1285     05  LFQTEDL PIC S9(0004) COMP.
  1286     05  LFQTEDF PIC  X(0001).
  1287     05  FILLER REDEFINES LFQTEDF.
  1288         10  LFQTEDA PIC  X(0001).
  1289     05  LFQTEDI PIC  X(0001).
  1290*    -------------------------------
  1291     05  LIFEBENL PIC S9(0004) COMP.
  1292     05  LIFEBENF PIC  X(0001).
  1293     05  FILLER REDEFINES LIFEBENF.
  1294         10  LIFEBENA PIC  X(0001).
  1295     05  LIFEBENI PIC  X(0001).
  1296*    -------------------------------
  1297     05  LFINTRL PIC S9(0004) COMP.
  1298     05  LFINTRF PIC  X(0001).
  1299     05  FILLER REDEFINES LFINTRF.
  1300         10  LFINTRA PIC  X(0001).
  1301     05  LFINTRI PIC  X(0001).
  1302*    -------------------------------
  1303     05  LFREML PIC S9(0004) COMP.
  1304     05  LFREMF PIC  X(0001).
  1305     05  FILLER REDEFINES LFREMF.
  1306         10  LFREMA PIC  X(0001).
  1307     05  LFREMI PIC  X(0001).
  1308*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL651.cbl
  1309     05  LFSTATEL PIC S9(0004) COMP.
  1310     05  LFSTATEF PIC  X(0001).
  1311     05  FILLER REDEFINES LFSTATEF.
  1312         10  LFSTATEA PIC  X(0001).
  1313     05  LFSTATEI PIC  X(0002).
  1314*    -------------------------------
  1315     05  LFBENL PIC S9(0004) COMP.
  1316     05  LFBENF PIC  X(0001).
  1317     05  FILLER REDEFINES LFBENF.
  1318         10  LFBENA PIC  X(0001).
  1319     05  LFBENI PIC  9V9999.
  1320*    -------------------------------
  1321     05  LFLOAMTL PIC S9(0004) COMP.
  1322     05  LFLOAMTF PIC  X(0001).
  1323     05  FILLER REDEFINES LFLOAMTF.
  1324         10  LFLOAMTA PIC  X(0001).
  1325     05  LFLOAMTI PIC  9(14).
  1326*    -------------------------------
  1327     05  LFHIAMTL PIC S9(0004) COMP.
  1328     05  LFHIAMTF PIC  X(0001).
  1329     05  FILLER REDEFINES LFHIAMTF.
  1330         10  LFHIAMTA PIC  X(0001).
  1331     05  LFHIAMTI PIC  9(14).
  1332*    -------------------------------
  1333     05  AHQTEDL PIC S9(0004) COMP.
  1334     05  AHQTEDF PIC  X(0001).
  1335     05  FILLER REDEFINES AHQTEDF.
  1336         10  AHQTEDA PIC  X(0001).
  1337     05  AHQTEDI PIC  X(0001).
  1338*    -------------------------------
  1339     05  AHTBENL PIC S9(0004) COMP.
  1340     05  AHTBENF PIC  X(0001).
  1341     05  FILLER REDEFINES AHTBENF.
  1342         10  AHTBENA PIC  X(0001).
  1343     05  AHTBENI PIC  X(0001).
  1344*    -------------------------------
  1345     05  AHSTATEL PIC S9(0004) COMP.
  1346     05  AHSTATEF PIC  X(0001).
  1347     05  FILLER REDEFINES AHSTATEF.
  1348         10  AHSTATEA PIC  X(0001).
  1349     05  AHSTATEI PIC  X(0002).
  1350*    -------------------------------
  1351     05  AHBENL PIC S9(0004) COMP.
  1352     05  AHBENF PIC  X(0001).
  1353     05  FILLER REDEFINES AHBENF.
  1354         10  AHBENA PIC  X(0001).
  1355     05  AHBENI PIC  9V9999.
  1356*    -------------------------------
  1357     05  AHLOAMTL PIC S9(0004) COMP.
  1358     05  AHLOAMTF PIC  X(0001).
  1359     05  FILLER REDEFINES AHLOAMTF.
  1360         10  AHLOAMTA PIC  X(0001).
  1361     05  AHLOAMTI PIC  9(12).
  1362*    -------------------------------
  1363     05  AHHIAMTL PIC S9(0004) COMP.
  1364     05  AHHIAMTF PIC  X(0001).
  1365     05  FILLER REDEFINES AHHIAMTF.
  1366         10  AHHIAMTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL651.cbl
  1367     05  AHHIAMTI PIC  9(12).
  1368*    -------------------------------
  1369     05  AMLOAMTL PIC S9(0004) COMP.
  1370     05  AMLOAMTF PIC  X(0001).
  1371     05  FILLER REDEFINES AMLOAMTF.
  1372         10  AMLOAMTA PIC  X(0001).
  1373     05  AMLOAMTI PIC  9(12).
  1374*    -------------------------------
  1375     05  AMHIAMTL PIC S9(0004) COMP.
  1376     05  AMHIAMTF PIC  X(0001).
  1377     05  FILLER REDEFINES AMHIAMTF.
  1378         10  AMHIAMTA PIC  X(0001).
  1379     05  AMHIAMTI PIC  9(12).
  1380*    -------------------------------
  1381     05  ERRMSG1L PIC S9(0004) COMP.
  1382     05  ERRMSG1F PIC  X(0001).
  1383     05  FILLER REDEFINES ERRMSG1F.
  1384         10  ERRMSG1A PIC  X(0001).
  1385     05  ERRMSG1I PIC  X(0072).
  1386*    -------------------------------
  1387     05  PFENTERL PIC S9(0004) COMP.
  1388     05  PFENTERF PIC  X(0001).
  1389     05  FILLER REDEFINES PFENTERF.
  1390         10  PFENTERA PIC  X(0001).
  1391     05  PFENTERI PIC  99.
  1392 01  EL651AO REDEFINES EL651AI.
  1393     05  FILLER            PIC  X(0012).
  1394*    -------------------------------
  1395     05  FILLER            PIC  X(0003).
  1396     05  RUNDATEO PIC  X(0008).
  1397*    -------------------------------
  1398     05  FILLER            PIC  X(0003).
  1399     05  RUNTIMEO PIC  99.99.
  1400*    -------------------------------
  1401     05  FILLER            PIC  X(0003).
  1402     05  MAINTYPO PIC  X(0001).
  1403*    -------------------------------
  1404     05  FILLER            PIC  X(0003).
  1405     05  LMBYO PIC  X(0004).
  1406*    -------------------------------
  1407     05  FILLER            PIC  X(0003).
  1408     05  LMDATEO PIC  X(0008).
  1409*    -------------------------------
  1410     05  FILLER            PIC  X(0003).
  1411     05  LMTIMEO PIC  99.99.
  1412*    -------------------------------
  1413     05  FILLER            PIC  X(0003).
  1414     05  TABLEO PIC  X(0003).
  1415*    -------------------------------
  1416     05  FILLER            PIC  X(0003).
  1417     05  COMPANYO PIC  X(0003).
  1418*    -------------------------------
  1419     05  FILLER            PIC  X(0003).
  1420     05  COMPSUBO PIC  X(0003).
  1421*    -------------------------------
  1422     05  FILLER            PIC  X(0003).
  1423     05  LEVELO PIC  X(0002).
  1424*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL651.cbl
  1425     05  FILLER            PIC  X(0003).
  1426     05  OFLEVELO PIC  X(0002).
  1427*    -------------------------------
  1428     05  FILLER            PIC  X(0003).
  1429     05  TOTABLEO PIC  X(0003).
  1430*    -------------------------------
  1431     05  FILLER            PIC  X(0003).
  1432     05  CARDESCO PIC  X(0011).
  1433*    -------------------------------
  1434     05  FILLER            PIC  X(0003).
  1435     05  CARRIERO PIC  X(0001).
  1436*    -------------------------------
  1437     05  FILLER            PIC  X(0003).
  1438     05  PERCNTO PIC  X(0001).
  1439*    -------------------------------
  1440     05  FILLER            PIC  X(0003).
  1441     05  LIFEHDO PIC  X(0004).
  1442*    -------------------------------
  1443     05  FILLER            PIC  X(0003).
  1444     05  FDATEO PIC  X(0008).
  1445*    -------------------------------
  1446     05  FILLER            PIC  X(0003).
  1447     05  TDATEO PIC  X(0008).
  1448*    -------------------------------
  1449     05  FILLER            PIC  X(0003).
  1450     05  LFLOAGEO PIC  X(0002).
  1451*    -------------------------------
  1452     05  FILLER            PIC  X(0003).
  1453     05  LFHIAGEO PIC  X(0002).
  1454*    -------------------------------
  1455     05  FILLER            PIC  X(0003).
  1456     05  LFLOTRMO PIC  X(0003).
  1457*    -------------------------------
  1458     05  FILLER            PIC  X(0003).
  1459     05  LFHITRMO PIC  X(0003).
  1460*    -------------------------------
  1461     05  FILLER            PIC  X(0003).
  1462     05  LFLOBENO PIC  ZZZ,ZZZ,ZZZ.99.
  1463*    -------------------------------
  1464     05  FILLER            PIC  X(0003).
  1465     05  LFHIBENO PIC  ZZZ,ZZZ,ZZZ.99.
  1466*    -------------------------------
  1467     05  FILLER            PIC  X(0003).
  1468     05  AHHD1O PIC  X(0003).
  1469*    -------------------------------
  1470     05  FILLER            PIC  X(0003).
  1471     05  AHLOAGEO PIC  X(0002).
  1472*    -------------------------------
  1473     05  FILLER            PIC  X(0003).
  1474     05  AHHIAGEO PIC  X(0002).
  1475*    -------------------------------
  1476     05  FILLER            PIC  X(0003).
  1477     05  AHLOTRMO PIC  X(0003).
  1478*    -------------------------------
  1479     05  FILLER            PIC  X(0003).
  1480     05  AHHITRMO PIC  X(0003).
  1481*    -------------------------------
  1482     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL651.cbl
  1483     05  AHLOBENO PIC  Z,ZZZ,ZZZ.99.
  1484*    -------------------------------
  1485     05  FILLER            PIC  X(0003).
  1486     05  AHHIBENO PIC  Z,ZZZ,ZZZ.99.
  1487*    -------------------------------
  1488     05  FILLER            PIC  X(0003).
  1489     05  AHHD2O PIC  X(0003).
  1490*    -------------------------------
  1491     05  FILLER            PIC  X(0003).
  1492     05  AMLOBENO PIC  Z,ZZZ,ZZZ.99.
  1493*    -------------------------------
  1494     05  FILLER            PIC  X(0003).
  1495     05  AMHIBENO PIC  Z,ZZZ,ZZZ.99.
  1496*    -------------------------------
  1497     05  FILLER            PIC  X(0003).
  1498     05  LFQTEDO PIC  X(0001).
  1499*    -------------------------------
  1500     05  FILLER            PIC  X(0003).
  1501     05  LIFEBENO PIC  X(0001).
  1502*    -------------------------------
  1503     05  FILLER            PIC  X(0003).
  1504     05  LFINTRO PIC  X(0001).
  1505*    -------------------------------
  1506     05  FILLER            PIC  X(0003).
  1507     05  LFREMO PIC  X(0001).
  1508*    -------------------------------
  1509     05  FILLER            PIC  X(0003).
  1510     05  LFSTATEO PIC  X(0002).
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
  1513     05  LFBENO PIC  9V9999.
  1514*    -------------------------------
  1515     05  FILLER            PIC  X(0003).
  1516     05  LFLOAMTO PIC  ZZZ,ZZZ,ZZZ.99.
  1517*    -------------------------------
  1518     05  FILLER            PIC  X(0003).
  1519     05  LFHIAMTO PIC  ZZZ,ZZZ,ZZZ.99.
  1520*    -------------------------------
  1521     05  FILLER            PIC  X(0003).
  1522     05  AHQTEDO PIC  X(0001).
  1523*    -------------------------------
  1524     05  FILLER            PIC  X(0003).
  1525     05  AHTBENO PIC  X(0001).
  1526*    -------------------------------
  1527     05  FILLER            PIC  X(0003).
  1528     05  AHSTATEO PIC  X(0002).
  1529*    -------------------------------
  1530     05  FILLER            PIC  X(0003).
  1531     05  AHBENO PIC  9V9999.
  1532*    -------------------------------
  1533     05  FILLER            PIC  X(0003).
  1534     05  AHLOAMTO PIC  Z,ZZZ,ZZZ.99.
  1535*    -------------------------------
  1536     05  FILLER            PIC  X(0003).
  1537     05  AHHIAMTO PIC  Z,ZZZ,ZZZ.99.
  1538*    -------------------------------
  1539     05  FILLER            PIC  X(0003).
  1540     05  AMLOAMTO PIC  Z,ZZZ,ZZZ.99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL651.cbl
  1541*    -------------------------------
  1542     05  FILLER            PIC  X(0003).
  1543     05  AMHIAMTO PIC  Z,ZZZ,ZZZ.99.
  1544*    -------------------------------
  1545     05  FILLER            PIC  X(0003).
  1546     05  ERRMSG1O PIC  X(0072).
  1547*    -------------------------------
  1548     05  FILLER            PIC  X(0003).
  1549     05  PFENTERO PIC  99.
  1550*    -------------------------------
  1551
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL651.cbl
  1553
  1554****************************************************************
  1555*
  1556* Copyright (c) 2007 by Clerity Solutions, Inc.
  1557* All rights reserved.
  1558*
  1559****************************************************************
  1560 01  DFHEIV.
  1561   02  DFHEIV0               PIC X(35).
  1562   02  DFHEIV1               PIC X(08).
  1563   02  DFHEIV2               PIC X(08).
  1564   02  DFHEIV3               PIC X(08).
  1565   02  DFHEIV4               PIC X(06).
  1566   02  DFHEIV5               PIC X(04).
  1567   02  DFHEIV6               PIC X(04).
  1568   02  DFHEIV7               PIC X(02).
  1569   02  DFHEIV8               PIC X(02).
  1570   02  DFHEIV9               PIC X(01).
  1571   02  DFHEIV10              PIC S9(7) COMP-3.
  1572   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1573   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1574   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1575   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1576   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1577   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1578   02  DFHEIV17              PIC X(04).
  1579   02  DFHEIV18              PIC X(04).
  1580   02  DFHEIV19              PIC X(04).
  1581   02  DFHEIV20              USAGE IS POINTER.
  1582   02  DFHEIV21              USAGE IS POINTER.
  1583   02  DFHEIV22              USAGE IS POINTER.
  1584   02  DFHEIV23              USAGE IS POINTER.
  1585   02  DFHEIV24              USAGE IS POINTER.
  1586   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1587   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1588   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1589   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1590   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1591   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1592   02  FILLER                PIC X(02).
  1593   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1594   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1595   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1596   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1597   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1598 LINKAGE  SECTION.
  1599*****************************************************************
  1600*                                                               *
  1601* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1602* All rights reserved.                                          *
  1603*                                                               *
  1604*****************************************************************
  1605 01  dfheiblk.
  1606     02  eibtime          pic s9(7) comp-3.
  1607     02  eibdate          pic s9(7) comp-3.
  1608     02  eibtrnid         pic x(4).
  1609     02  eibtaskn         pic s9(7) comp-3.
  1610     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL651.cbl
  1611     02  dfheigdi         pic s9(4) comp.
  1612     02  eibcposn         pic s9(4) comp.
  1613     02  eibcalen         pic s9(4) comp.
  1614     02  eibaid           pic x(1).
  1615     02  eibfiller1       pic x(1).
  1616     02  eibfn            pic x(2).
  1617     02  eibfiller2       pic x(2).
  1618     02  eibrcode         pic x(6).
  1619     02  eibfiller3       pic x(2).
  1620     02  eibds            pic x(8).
  1621     02  eibreqid         pic x(8).
  1622     02  eibrsrce         pic x(8).
  1623     02  eibsync          pic x(1).
  1624     02  eibfree          pic x(1).
  1625     02  eibrecv          pic x(1).
  1626     02  eibsend          pic x(1).
  1627     02  eibatt           pic x(1).
  1628     02  eibeoc           pic x(1).
  1629     02  eibfmh           pic x(1).
  1630     02  eibcompl         pic x(1).
  1631     02  eibsig           pic x(1).
  1632     02  eibconf          pic x(1).
  1633     02  eiberr           pic x(1).
  1634     02  eibrldbk         pic x(1).
  1635     02  eiberrcd         pic x(4).
  1636     02  eibsynrb         pic x(1).
  1637     02  eibnodat         pic x(1).
  1638     02  eibfiller5       pic x(2).
  1639     02  eibresp          pic 9(09) comp.
  1640     02  eibresp2         pic 9(09) comp.
  1641     02  dfheigdj         pic s9(4) comp.
  1642     02  dfheigdk         pic s9(4) comp.
  1643
  1644 01  DFHCOMMAREA                     PIC X(1024).
  1645
  1646*01 PARMLIST .
  1647*    02  FILLER                      PIC S9(8)   COMP.
  1648*    02  ERREIN-POINTER              PIC S9(8)   COMP.
  1649*    02  ELCNTL-POINTER              PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL651.cbl
  1651*                                    COPY ERCREIN.
  1652******************************************************************
  1653*                                                                *
  1654*                            ERCREIN                             *
  1655*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1656*                            VMOD=2.010                          *
  1657*                                                                *
  1658*   ONLINE CREDIT SYSTEM                                         *
  1659*                                                                *
  1660*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  1661*                                                                *
  1662*   FILE TYPE = VSAM,KSDS                                        *
  1663*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  1664*                                                                *
  1665*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  1666*       ALTERNATE PATH = NONE                                    *
  1667*                                                                *
  1668*   LOG = NO                                                     *
  1669*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1670*                                                                *
  1671******************************************************************
  1672*                   C H A N G E   L O G
  1673*
  1674* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1675*-----------------------------------------------------------------
  1676*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1677* EFFECTIVE    NUMBER
  1678*-----------------------------------------------------------------
  1679* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  1680* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  1681******************************************************************
  1682 01  REINSURANCE-RECORD.
  1683     12  RE-RECORD-ID                      PIC XX.
  1684         88  VALID-RE-ID                      VALUE 'RE'.
  1685
  1686     12  RE-CONTROL-PRIMARY.
  1687         16  RE-COMPANY-CD                 PIC X.
  1688         16  RE-KEY.
  1689             20  RE-CODE                   PIC X.
  1690                 88  RE-TABLE-RECORD          VALUE 'A'.
  1691                 88  RE-COMPANY-RECORD        VALUE 'B'.
  1692             20  RE-TABLE                  PIC XXX.
  1693             20  FILLER                    PIC XXX.
  1694         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  1695             20  FILLER                    PIC X.
  1696             20  RE-COMPANY.
  1697                 24  RE-COMP-PRIME         PIC XXX.
  1698                 24  RE-COMP-SUB           PIC XXX.
  1699
  1700     12  RE-MAINT-INFORMATION.
  1701         16  RE-LAST-MAINT-DT              PIC XX.
  1702         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1703         16  RE-LAST-MAINT-USER            PIC X(4).
  1704         16  FILLER                        PIC X(10).
  1705
  1706     12  RE-TABLE-DATA.
  1707         16  RE-100-COMP                   PIC 99.
  1708
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL651.cbl
  1709         16  RE-COMP-INFO    OCCURS 30 TIMES.
  1710             20  RE-REI-COMP-NO.
  1711                 24  RE-REI-COMP           PIC XXX.
  1712                 24  RE-REI-COMP-SUB       PIC XXX.
  1713             20  RE-LF-QC                  PIC X.
  1714             20  RE-AH-QC                  PIC X.
  1715             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  1716             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  1717             20  RE-LFAGE-LO               PIC 99.
  1718             20  RE-LFAGE-HI               PIC 99.
  1719             20  RE-AHAGE-LO               PIC 99.
  1720             20  RE-AHAGE-HI               PIC 99.
  1721             20  RE-LFTRM-LO               PIC S999       COMP-3.
  1722             20  RE-LFTRM-HI               PIC S999       COMP-3.
  1723             20  RE-AHTRM-LO               PIC S999       COMP-3.
  1724             20  RE-AHTRM-HI               PIC S999       COMP-3.
  1725             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  1726             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  1727             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  1728             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  1729             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  1730             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  1731             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  1732             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  1733             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  1734             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  1735             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  1736             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  1737             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  1738             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  1739             20  RE-LF-BEN-CODE            PIC X.
  1740             20  RE-AH-BEN-CODE            PIC X.
  1741             20  RE-INTERACTIVE            PIC X.
  1742             20  RE-REMAINING              PIC X.
  1743             20  RE-LF-RUNOFF-SW           PIC X.
  1744             20  RE-AH-RUNOFF-SW           PIC X.
  1745             20  FILLER                    PIC X(19).
  1746
  1747         16  RE-COMP-INFO-END              PIC X(6).
  1748         16  RE-NSP-ST-CD-LF               PIC XX.
  1749         16  RE-NSP-ST-CD-AH               PIC XX.
  1750         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  1751             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  1752
  1753         16  FILLER                        PIC X(27).
  1754
  1755     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  1756         16  RE-NAME                       PIC X(30).
  1757         16  RE-LF-PE                      PIC X.
  1758         16  RE-AH-PE                      PIC X.
  1759         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  1760         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  1761         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  1762         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  1763         16  RE-PRT-ST                     PIC X.
  1764         16  RE-PRT-OW                     PIC X.
  1765         16  RE-MORT-CODE                  PIC X(4).
  1766         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL651.cbl
  1767         16  RE-ZERO-LF-FEE                PIC X.
  1768         16  RE-ZERO-AH-FEE                PIC X.
  1769         16  RE-CEDE-NAME                  PIC X(30).
  1770         16  RE-LF-COMM                    PIC X.
  1771         16  RE-AH-COMM                    PIC X.
  1772         16  RE-LF-TAX                     PIC X.
  1773         16  RE-AH-TAX                     PIC X.
  1774         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  1775         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  1776         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  1777
  1778         16  RE-COMP-CARRIER-SECURITY      PIC X.
  1779             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  1780
  1781         16  RE-LF-CEDING-FEE-BRACKETS.
  1782             20  RE-LF-FEE-METHOD          PIC X.
  1783                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  1784                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  1785                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  1786                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  1787             20  RE-LF-FEE-BASIS           PIC X.
  1788                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  1789                 88  RE-LF-NET-CEDED               VALUE '2'.
  1790                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  1791                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  1792                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  1793                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  1794                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  1795                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  1796             20  FILLER                    PIC XXX.
  1797             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  1798                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  1799                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  1800
  1801         16  RE-AH-CEDING-FEE-BRACKETS.
  1802             20  RE-AH-FEE-METHOD          PIC X.
  1803                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  1804                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  1805                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  1806                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  1807             20  RE-AH-FEE-BASIS           PIC X.
  1808                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  1809                 88  RE-AH-NET-CEDED               VALUE '2'.
  1810                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  1811                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  1812                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  1813                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  1814                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  1815                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  1816             20  FILLER                    PIC XXX.
  1817             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  1818                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  1819                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  1820
  1821         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  1822
  1823         16  RE-OLD-CEDING-STMT            PIC X.
  1824
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL651.cbl
  1825         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  1826         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  1827         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  1828         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  1829         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  1830         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  1831         16  RE-REINS-GROUPING-CODE        PIC X(6).
  1832         16  RE-MORT-SW                    PIC X.
  1833         16  RE-CEDING-TYPE-FLAG           PIC X.
  1834             88  RE-NO-CESSION-TYPE                VALUE ' '.
  1835             88  RE-CEDED                          VALUE 'C'.
  1836             88  RE-ASSUMED                        VALUE 'A'.
  1837             88  RE-PHANTOM                        VALUE 'P'.
  1838
  1839         16  RE-CEDING-STMT-OPT-A          PIC X.
  1840             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  1841         16  RE-CEDING-STMT-OPT-B          PIC X.
  1842             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  1843         16  RE-CEDING-STMT-OPT-C          PIC X.
  1844             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  1845         16  RE-CEDING-STMT-OPT-D          PIC X.
  1846             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  1847         16  RE-CEDING-STMT-OPT-E          PIC X.
  1848             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  1849
  1850         16  RE-PRT-CRSV                   PIC X.
  1851
  1852         16  RE-GL-CENTER                  PIC X(4).
  1853
  1854         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  1855
  1856         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  1857
  1858         16  RE-EARN-STOP-CODE             PIC X.
  1859             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  1860             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  1861
  1862         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  1863             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  1864
  1865         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  1866         16  FILLER                        PIC X(2281).
  1867
  1868         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  1869
  1870******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL651.cbl
  1872*                                    COPY ELCCNTL.
  1873******************************************************************
  1874*                                                                *
  1875*                                                                *
  1876*                            ELCCNTL.                            *
  1877*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1878*                            VMOD=2.059                          *
  1879*                                                                *
  1880*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1881*                                                                *
  1882*   FILE TYPE = VSAM,KSDS                                        *
  1883*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1884*                                                                *
  1885*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1886*       ALTERNATE INDEX = NONE                                   *
  1887*                                                                *
  1888*   LOG = YES                                                    *
  1889*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1890******************************************************************
  1891*                   C H A N G E   L O G
  1892*
  1893* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1894*-----------------------------------------------------------------
  1895*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1896* EFFECTIVE    NUMBER
  1897*-----------------------------------------------------------------
  1898* 082503                   PEMA  ADD BENEFIT GROUP
  1899* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1900* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1901* 092705    2005050300006  PEMA  ADD SPP LEASES
  1902* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1903* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1904* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1905* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1906******************************************************************
  1907*
  1908 01  CONTROL-FILE.
  1909     12  CF-RECORD-ID                       PIC XX.
  1910         88  VALID-CF-ID                        VALUE 'CF'.
  1911
  1912     12  CF-CONTROL-PRIMARY.
  1913         16  CF-COMPANY-ID                  PIC XXX.
  1914         16  CF-RECORD-TYPE                 PIC X.
  1915             88  CF-COMPANY-MASTER              VALUE '1'.
  1916             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1917             88  CF-STATE-MASTER                VALUE '3'.
  1918             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1919             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1920             88  CF-CARRIER-MASTER              VALUE '6'.
  1921             88  CF-MORTALITY-MASTER            VALUE '7'.
  1922             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1923             88  CF-TERMINAL-MASTER             VALUE '9'.
  1924             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1925             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1926             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1927             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1928             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1929             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL651.cbl
  1930             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1931             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1932             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1933         16  CF-ACCESS-CD-GENL              PIC X(4).
  1934         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1935             20  CF-PROCESSOR               PIC X(4).
  1936         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1937             20  CF-STATE-CODE              PIC XX.
  1938             20  FILLER                     PIC XX.
  1939         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1940             20  FILLER                     PIC XX.
  1941             20  CF-HI-BEN-IN-REC           PIC XX.
  1942         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1943             20  FILLER                     PIC XXX.
  1944             20  CF-CARRIER-CNTL            PIC X.
  1945         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1946             20  FILLER                     PIC XX.
  1947             20  CF-HI-TYPE-IN-REC          PIC 99.
  1948         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1949             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1950                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1951             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1952             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1953         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1954             20  FILLER                     PIC X.
  1955             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1956         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1957             20  FILLER                     PIC XX.
  1958             20  CF-MORTGAGE-PLAN           PIC XX.
  1959         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1960
  1961     12  CF-LAST-MAINT-DT                   PIC XX.
  1962     12  CF-LAST-MAINT-BY                   PIC X(4).
  1963     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1964
  1965     12  CF-RECORD-BODY                     PIC X(728).
  1966
  1967
  1968****************************************************************
  1969*             COMPANY MASTER RECORD                            *
  1970****************************************************************
  1971
  1972     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1973         16  CF-COMPANY-ADDRESS.
  1974             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1975             20  CF-CL-IN-CARE-OF           PIC X(30).
  1976             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1977             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1978             20  CF-CL-CITY-STATE           PIC X(30).
  1979             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1980             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1981         16  CF-COMPANY-CD                  PIC X.
  1982         16  CF-COMPANY-PASSWORD            PIC X(8).
  1983         16  CF-SECURITY-OPTION             PIC X.
  1984             88  ALL-SECURITY                   VALUE '1'.
  1985             88  COMPANY-VERIFY                 VALUE '2'.
  1986             88  PROCESSOR-VERIFY               VALUE '3'.
  1987             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL651.cbl
  1988             88  ALL-BUT-TERM                   VALUE '5'.
  1989         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1990             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1991         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1992             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1993         16  CF-INFORCE-LOCATION            PIC X.
  1994             88  CERTS-ARE-ONLINE               VALUE '1'.
  1995             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1996             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1997         16  CF-LOWER-CASE-LETTERS          PIC X.
  1998         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1999             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2000             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2001             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2002             88  CF-ACCNT-CNTL                  VALUE '3'.
  2003             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2004
  2005         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2006         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2007
  2008         16  CF-LGX-CREDIT-USER             PIC X.
  2009             88  CO-IS-NOT-USER                 VALUE 'N'.
  2010             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2011
  2012         16 CF-CREDIT-CALC-CODES.
  2013             20  CF-CR-REM-TERM-CALC PIC X.
  2014               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2015               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2016               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2017               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2018               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2019               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2020               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2021             20  CF-CR-R78-METHOD           PIC X.
  2022               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2023               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2024
  2025         16  CF-CLAIM-CONTROL-COUNTS.
  2026             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2027                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2028
  2029             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2030                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2031
  2032             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2033                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2034
  2035             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2036                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2037
  2038         16  CF-CURRENT-MONTH-END           PIC XX.
  2039
  2040         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2041             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2042             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2043             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2044             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2045                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL651.cbl
  2046                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2047             20  CF-CO-PREM-REJECT-SW       PIC X.
  2048                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2049                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2050             20  CF-CO-REF-REJECT-SW        PIC X.
  2051                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2052                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2053
  2054         16  CF-CO-REPORTING-DT             PIC XX.
  2055         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2056         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2057           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2058           88  CF-CO-MONTH-END                  VALUE '1'.
  2059
  2060         16  CF-LGX-CLAIM-USER              PIC X.
  2061             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2062             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2063
  2064         16  CF-CREDIT-EDIT-CONTROLS.
  2065             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2066             20  CF-MIN-AGE                 PIC 99.
  2067             20  CF-DEFAULT-AGE             PIC 99.
  2068             20  CF-MIN-TERM                PIC S999      COMP-3.
  2069             20  CF-MAX-TERM                PIC S999      COMP-3.
  2070             20  CF-DEFAULT-SEX             PIC X.
  2071             20  CF-JOINT-AGE-INPUT         PIC X.
  2072                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2073             20  CF-BIRTH-DATE-INPUT        PIC X.
  2074                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2075             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2076                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2077                 88  CF-ZERO-CARRIER            VALUE '1'.
  2078                 88  CF-ZERO-GROUPING           VALUE '2'.
  2079                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2080             20  CF-EDIT-SW                 PIC X.
  2081                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2082             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2083             20  CF-CR-PR-METHOD            PIC X.
  2084               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2085               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2086             20  FILLER                     PIC X.
  2087
  2088         16  CF-CREDIT-MISC-CONTROLS.
  2089             20  CF-REIN-TABLE-SW           PIC X.
  2090                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2091             20  CF-COMP-TABLE-SW           PIC X.
  2092                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2093             20  CF-EXPERIENCE-RETENTION-AGE
  2094                                            PIC S9        COMP-3.
  2095             20  CF-CONVERSION-DT           PIC XX.
  2096             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2097             20  CF-RUN-FREQUENCY-SW        PIC X.
  2098                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2099                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2100
  2101             20  CF-CR-CHECK-NO-CONTROL.
  2102                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2103                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL651.cbl
  2104                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2105                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2106                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2107                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2108
  2109                 24  CF-CR-CHECK-COUNT       REDEFINES
  2110                     CF-CR-CHECK-COUNTER      PIC X(4).
  2111
  2112                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2113                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2114
  2115                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2116                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2117                 24  CF-MAIL-PROCESSING       PIC X.
  2118                     88  MAIL-PROCESSING          VALUE 'Y'.
  2119
  2120         16  CF-MISC-SYSTEM-CONTROL.
  2121             20  CF-SYSTEM-C                 PIC X.
  2122                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2123             20  CF-SYSTEM-D                 PIC X.
  2124                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2125             20  CF-SOC-SEC-NO-SW            PIC X.
  2126                 88  SOC-SEC-NO-USED             VALUE '1'.
  2127             20  CF-MEMBER-NO-SW             PIC X.
  2128                 88  MEMBER-NO-USED              VALUE '1'.
  2129             20  CF-TAX-ID-NUMBER            PIC X(11).
  2130             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2131             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2132                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2133                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2134                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2135                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2136             20  CF-SYSTEM-E                 PIC X.
  2137                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2138
  2139         16  CF-LGX-LIFE-USER               PIC X.
  2140             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2141             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2142
  2143         16  CF-CR-MONTH-END-DT             PIC XX.
  2144
  2145         16  CF-FILE-MAINT-DATES.
  2146             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2147                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2148             20  CF-LAST-BATCH       REDEFINES
  2149                 CF-LAST-BATCH-NO               PIC X(4).
  2150             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2151             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2152             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2153             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2154             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2155             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2156             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2157             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2158             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2159             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2160
  2161         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL651.cbl
  2162         16  FILLER                         PIC X.
  2163
  2164         16  CF-ALT-MORT-CODE               PIC X(4).
  2165         16  CF-MEMBER-CAPTION              PIC X(10).
  2166
  2167         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2168             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2169             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2170             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2171             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2172             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2173
  2174         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2175
  2176         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2177         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2178         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2179         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2180
  2181         16  CF-AH-OVERRIDE-L1              PIC X.
  2182         16  CF-AH-OVERRIDE-L2              PIC XX.
  2183         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2184         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2185
  2186         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2187         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2188
  2189         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2190         16  CF-AR-LAST-EL860-DT            PIC XX.
  2191         16  CF-MP-MONTH-END-DT             PIC XX.
  2192
  2193         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2194         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2195             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2196
  2197         16  CF-AR-MONTH-END-DT             PIC XX.
  2198
  2199         16  CF-CRDTCRD-USER                PIC X.
  2200             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2201             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2202
  2203         16  CF-CC-MONTH-END-DT             PIC XX.
  2204
  2205         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2206
  2207         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2208             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2209             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2210             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2211         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2212         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2213         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2214         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2215             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2216             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2217         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2218         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2219         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL651.cbl
  2220             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2221         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2222
  2223         16  CF-CL-ZIP-CODE.
  2224             20  CF-CL-ZIP-PRIME.
  2225                 24  CF-CL-ZIP-1ST          PIC X.
  2226                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2227                 24  FILLER                 PIC X(4).
  2228             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2229         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2230             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2231             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2232             20  FILLER                     PIC XXX.
  2233
  2234         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2235         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2236         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2237         16  CF-CO-OPTION-START-DATE        PIC XX.
  2238         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2239           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2240                                                      '3' '4'.
  2241           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2242           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2243           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2244           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2245           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2246           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2247
  2248         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2249
  2250         16  CF-PAYMENT-APPROVAL-LEVELS.
  2251             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2252             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2253             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2254             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2255             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2256             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2257
  2258         16  CF-END-USER-REPORTING-USER     PIC X.
  2259             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2260             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2261
  2262         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2263             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2264             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2265
  2266         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2267
  2268         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2269         16  FILLER                         PIC X.
  2270
  2271         16  CF-CREDIT-ARCHIVE-CNTL.
  2272             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2273             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2274             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2275
  2276         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2277
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL651.cbl
  2278         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2279             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2280             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2281
  2282         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2283             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2284             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2285
  2286         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2287
  2288         16  CF-CO-ACH-ID-CODE              PIC  X.
  2289             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2290             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2291             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2292         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2293         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2294         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2295         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2296         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2297         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2298         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2299         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2300         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2301                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2302         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2303                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2304
  2305         16  CF-CO-OVER-SHORT.
  2306             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2307             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2308
  2309*         16  FILLER                         PIC X(102).
  2310         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2311             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2312             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2313
  2314         16  CF-AH-APPROVAL-DAYS.
  2315             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2316             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2317             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2318             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2319
  2320         16  FILLER                         PIC X(82).
  2321****************************************************************
  2322*             PROCESSOR/USER RECORD                            *
  2323****************************************************************
  2324
  2325     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2326         16  CF-PROCESSOR-NAME              PIC X(30).
  2327         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2328         16  CF-PROCESSOR-TITLE             PIC X(26).
  2329         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2330                 88  MESSAGE-YES                VALUE 'Y'.
  2331                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2332
  2333*****************************************************
  2334****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2335****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL651.cbl
  2336****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2337****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2338*****************************************************
  2339
  2340         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2341             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2342             20  CF-APPLICATION-FORCE       PIC X.
  2343             20  CF-INDIVIDUAL-APP.
  2344                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2345                     28  CF-BROWSE-APP      PIC X.
  2346                     28  CF-UPDATE-APP      PIC X.
  2347
  2348         16  CF-CURRENT-TERM-ON             PIC X(4).
  2349         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2350             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2351             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2352             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2353             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2354             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2355             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2356             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2357         16  CF-PROCESSOR-CARRIER           PIC X.
  2358             88  NO-CARRIER-SECURITY            VALUE ' '.
  2359         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2360             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2361         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2362             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2363         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2364             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2365
  2366         16  CF-PROC-SYS-ACCESS-SW.
  2367             20  CF-PROC-CREDIT-CLAIMS-SW.
  2368                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2369                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2370                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2371                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2372             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2373                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2374                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2375             20  CF-PROC-LIFE-GNRLDGR-SW.
  2376                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2377                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2378                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2379                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2380             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2381                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2382                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2383         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2384             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2385             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2386         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2387
  2388         16  CF-APPROVAL-LEVEL                  PIC X.
  2389             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2390             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2391             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2392             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2393
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL651.cbl
  2394         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2395
  2396         16  CF-LANGUAGE-TYPE                   PIC X.
  2397             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2398             88  CF-LANG-IS-FR                      VALUE 'F'.
  2399         16  FILLER                             PIC  X(240).
  2400
  2401****************************************************************
  2402*             PROCESSOR/REMINDERS RECORD                       *
  2403****************************************************************
  2404
  2405     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2406         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2407             20  CF-START-REMIND-DT         PIC XX.
  2408             20  CF-END-REMIND-DT           PIC XX.
  2409             20  CF-REMINDER-TEXT           PIC X(50).
  2410         16  FILLER                         PIC X(296).
  2411
  2412
  2413****************************************************************
  2414*             STATE MASTER RECORD                              *
  2415****************************************************************
  2416
  2417     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2418         16  CF-STATE-ABBREVIATION          PIC XX.
  2419         16  CF-STATE-NAME                  PIC X(25).
  2420         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2421         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2422             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2423             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2424             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2425             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2426                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2427                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2428             20  CF-ST-PREM-REJECT-SW       PIC X.
  2429                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2430                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2431             20  CF-ST-REF-REJECT-SW        PIC X.
  2432                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2433                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2434         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2435         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2436         16  CF-ST-REFUND-RULES.
  2437             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2438             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2439             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2440         16  CF-ST-FST-PMT-EXTENSION.
  2441             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2442             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2443                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2444                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2445                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2446                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2447         16  CF-ST-STATE-CALL.
  2448             20  CF-ST-CALL-UNEARNED        PIC X.
  2449             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2450             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2451         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL651.cbl
  2452             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2453             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2454         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2455         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2456         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2457         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2458         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2459         16  FILLER                         PIC X.
  2460         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2461             20  CF-ST-BENEFIT-CD           PIC XX.
  2462             20  CF-ST-BENEFIT-KIND         PIC X.
  2463                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2464                 88  CF-ST-AH-KIND              VALUE 'A'.
  2465             20  CF-ST-REM-TERM-CALC        PIC X.
  2466                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2467                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2468                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2469                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2470                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2471                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2472                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2473                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2474
  2475             20  CF-ST-REFUND-CALC          PIC X.
  2476                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2477                 88  ST-REFD-BY-R78             VALUE '1'.
  2478                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2479                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2480                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2481                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2482                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2483                 88  ST-REFD-UTAH               VALUE '7'.
  2484                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2485                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2486                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2487
  2488             20  CF-ST-EARNING-CALC         PIC X.
  2489                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2490                 88  ST-EARN-BY-R78             VALUE '1'.
  2491                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2492                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2493                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2494                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2495                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2496                 88  ST-EARN-MEAN               VALUE '8'.
  2497                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2498
  2499             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2500                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2501                 88  ST-OVRD-BY-R78             VALUE '1'.
  2502                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2503                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2504                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2505                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2506                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2507                 88  ST-OVRD-MEAN               VALUE '8'.
  2508                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2509             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL651.cbl
  2510
  2511         16  CF-ST-COMMISSION-CAPS.
  2512             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2513             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2514             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2515             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2516         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2517                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2518
  2519         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2520
  2521         16  CF-ST-STATUTORY-INTEREST.
  2522             20  CF-ST-STAT-DATE-FROM       PIC X.
  2523                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2524                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2525             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2526             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2527             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2528             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2529             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2530
  2531         16  CF-ST-OVER-SHORT.
  2532             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2533             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2534
  2535         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2536
  2537         16  CF-ST-RT-CALC                  PIC X.
  2538
  2539         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2540         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2541         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2542         16  CF-ST-RF-LR-CALC               PIC X.
  2543         16  CF-ST-RF-LL-CALC               PIC X.
  2544         16  CF-ST-RF-LN-CALC               PIC X.
  2545         16  CF-ST-RF-AH-CALC               PIC X.
  2546         16  CF-ST-RF-CP-CALC               PIC X.
  2547*        16  FILLER                         PIC X(206).
  2548*CIDMOD         16  FILLER                         PIC X(192).
  2549         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2550             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2551         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2552         16  FILLER                         PIC X(187).
  2553
  2554****************************************************************
  2555*             BENEFIT MASTER RECORD                            *
  2556****************************************************************
  2557
  2558     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2559         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2560             20  CF-BENEFIT-CODE            PIC XX.
  2561             20  CF-BENEFIT-NUMERIC  REDEFINES
  2562                 CF-BENEFIT-CODE            PIC XX.
  2563             20  CF-BENEFIT-ALPHA           PIC XXX.
  2564             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2565             20  CF-BENEFIT-COMMENT         PIC X(10).
  2566
  2567             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL651.cbl
  2568                 88  CF-REDUCING                VALUE 'R'.
  2569                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2570
  2571             20  CF-SPECIAL-CALC-CD         PIC X.
  2572                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2573                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2574                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2575                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2576                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2577                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2578                 88  CF-FARM-PLAN               VALUE 'F'.
  2579                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2580                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2581                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2582                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2583                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2584                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2585                 88  CF-PRUDENTIAL              VALUE 'P'.
  2586                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2587                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2588                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2589                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2590                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2591                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2592
  2593             20  CF-JOINT-INDICATOR         PIC X.
  2594                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2595
  2596*            20  FILLER                     PIC X(12).
  2597             20  FILLER                     PIC X(11).
  2598             20  CF-BENEFIT-CATEGORY        PIC X.
  2599             20  CF-LOAN-TYPE               PIC X(8).
  2600
  2601             20  CF-CO-REM-TERM-CALC        PIC X.
  2602                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2603                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2604                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2605                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2606                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2607
  2608             20  CF-CO-EARNINGS-CALC        PIC X.
  2609                 88  CO-EARN-BY-R78             VALUE '1'.
  2610                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2611                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2612                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2613                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2614                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2615                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2616                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2617
  2618             20  CF-CO-REFUND-CALC          PIC X.
  2619                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2620                 88  CO-REFD-BY-R78             VALUE '1'.
  2621                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2622                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2623                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2624                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2625                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL651.cbl
  2626                 88  CO-REFD-MEAN               VALUE '8'.
  2627                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2628                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2629                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2630
  2631             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2632                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2633                 88  CO-OVRD-BY-R78             VALUE '1'.
  2634                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2635                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2636                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2637                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2638                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2639                 88  CO-OVRD-MEAN               VALUE '8'.
  2640                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2641
  2642             20  CF-CO-BEN-I-G-CD           PIC X.
  2643                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2644                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2645                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2646
  2647         16  FILLER                         PIC X(304).
  2648
  2649
  2650****************************************************************
  2651*             CARRIER MASTER RECORD                            *
  2652****************************************************************
  2653
  2654     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2655         16  CF-ADDRESS-DATA.
  2656             20  CF-MAIL-TO-NAME            PIC X(30).
  2657             20  CF-IN-CARE-OF              PIC X(30).
  2658             20  CF-ADDRESS-LINE-1          PIC X(30).
  2659             20  CF-ADDRESS-LINE-2          PIC X(30).
  2660             20  CF-CITY-STATE              PIC X(30).
  2661             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2662             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2663
  2664         16  CF-CLAIM-NO-CONTROL.
  2665             20  CF-CLAIM-NO-METHOD         PIC X.
  2666                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2667                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2668                 88  CLAIM-NO-SEQ               VALUE '3'.
  2669                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2670             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2671                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2672                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2673                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2674
  2675         16  CF-CHECK-NO-CONTROL.
  2676             20  CF-CHECK-NO-METHOD         PIC X.
  2677                 88  CHECK-NO-MANUAL            VALUE '1'.
  2678                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2679                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2680                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2681             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2682                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2683
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL651.cbl
  2684         16  CF-DOMICILE-STATE              PIC XX.
  2685
  2686         16  CF-EXPENSE-CONTROLS.
  2687             20  CF-EXPENSE-METHOD          PIC X.
  2688                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2689                 88  DOLLARS-PER-PMT            VALUE '2'.
  2690                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2691                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2692             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2693             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2694
  2695         16  CF-CORRESPONDENCE-CONTROL.
  2696             20  CF-LETTER-RESEND-OPT       PIC X.
  2697                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2698                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2699             20  FILLER                     PIC X(4).
  2700
  2701         16  CF-RESERVE-CONTROLS.
  2702             20  CF-MANUAL-SW               PIC X.
  2703                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2704             20  CF-FUTURE-SW               PIC X.
  2705                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2706             20  CF-PTC-SW                  PIC X.
  2707                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2708             20  CF-IBNR-SW                 PIC X.
  2709                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2710             20  CF-PTC-LF-SW               PIC X.
  2711                 88  CF-LF-PTC-USED             VALUE '1'.
  2712             20  CF-CDT-ACCESS-METHOD       PIC X.
  2713                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2714                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2715                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2716             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2717
  2718         16  CF-CLAIM-CALC-METHOD           PIC X.
  2719             88  360-PLUS-MONTHS                VALUE '1'.
  2720             88  365-PLUS-MONTHS                VALUE '2'.
  2721             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2722             88  360-DAILY                      VALUE '4'.
  2723             88  365-DAILY                      VALUE '5'.
  2724
  2725         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2726         16  FILLER                         PIC X(11).
  2727
  2728         16  CF-LIMIT-AMOUNTS.
  2729             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2730             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2731             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2732             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2733             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2734             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2735             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2736             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2737             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2738             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2739
  2740         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2741         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL651.cbl
  2742         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2743
  2744         16  CF-ZIP-CODE.
  2745             20  CF-ZIP-PRIME.
  2746                 24  CF-ZIP-1ST             PIC X.
  2747                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2748                 24  FILLER                 PIC X(4).
  2749             20  CF-ZIP-PLUS4               PIC X(4).
  2750         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2751             20  CF-CAN-POSTAL-1            PIC XXX.
  2752             20  CF-CAN-POSTAL-2            PIC XXX.
  2753             20  FILLER                     PIC XXX.
  2754
  2755         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2756         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2757         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2758
  2759         16  CF-RATING-SWITCH               PIC X.
  2760             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2761             88  CF-NO-RATING                   VALUE 'N'.
  2762
  2763         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2764
  2765         16  CF-CARRIER-OVER-SHORT.
  2766             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2767             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2768
  2769         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2770         16  CF-SECPAY-SWITCH               PIC X.
  2771             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2772             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2773         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2774         16  FILLER                         PIC X(448).
  2775*        16  FILLER                         PIC X(452).
  2776
  2777
  2778****************************************************************
  2779*             MORTALITY MASTER RECORD                          *
  2780****************************************************************
  2781
  2782     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2783         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2784                                INDEXED BY CF-MORT-NDX.
  2785             20  CF-MORT-TABLE              PIC X(5).
  2786             20  CF-MORT-TABLE-TYPE         PIC X.
  2787                 88  CF-MORT-JOINT              VALUE 'J'.
  2788                 88  CF-MORT-SINGLE             VALUE 'S'.
  2789                 88  CF-MORT-COMBINED           VALUE 'C'.
  2790                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2791                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2792             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2793             20  CF-MORT-AGE-METHOD         PIC XX.
  2794                 88  CF-AGE-LAST                VALUE 'AL'.
  2795                 88  CF-AGE-NEAR                VALUE 'AN'.
  2796             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2797             20  CF-MORT-ADJUSTMENT-DIRECTION
  2798                                            PIC X.
  2799                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL651.cbl
  2800                 88  CF-PLUS                    VALUE '+'.
  2801             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2802             20  CF-MORT-JOINT-CODE         PIC X.
  2803                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2804             20  CF-MORT-PC-Q               PIC X.
  2805                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2806             20  CF-MORT-TABLE-CODE         PIC X(4).
  2807             20  CF-MORT-COMMENTS           PIC X(15).
  2808             20  FILLER                     PIC X(14).
  2809
  2810         16  FILLER                         PIC X(251).
  2811
  2812
  2813****************************************************************
  2814*             BUSSINESS TYPE MASTER RECORD                     *
  2815****************************************************************
  2816
  2817     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2818* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2819* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2820* AND RECORD 05 IS TYPES 81-99
  2821         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2822             20  CF-BUSINESS-TITLE          PIC  X(19).
  2823             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2824                                            PIC S9V9(4) COMP-3.
  2825             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2826             20  FILLER                     PIC  X.
  2827         16  FILLER                         PIC  X(248).
  2828
  2829
  2830****************************************************************
  2831*             TERMINAL MASTER RECORD                           *
  2832****************************************************************
  2833
  2834     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2835
  2836         16  CF-COMPANY-TERMINALS.
  2837             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2838                                  PIC X(4).
  2839         16  FILLER               PIC X(248).
  2840
  2841
  2842****************************************************************
  2843*             LIFE EDIT MASTER RECORD                          *
  2844****************************************************************
  2845
  2846     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2847         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2848             20  CF-LIFE-CODE-IN            PIC XX.
  2849             20  CF-LIFE-CODE-OUT           PIC XX.
  2850         16  FILLER                         PIC X(248).
  2851
  2852
  2853****************************************************************
  2854*             AH EDIT MASTER RECORD                            *
  2855****************************************************************
  2856
  2857     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL651.cbl
  2858         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2859             20  CF-AH-CODE-IN              PIC XXX.
  2860             20  CF-AH-CODE-OUT             PIC XX.
  2861         16  FILLER                         PIC X(248).
  2862
  2863
  2864****************************************************************
  2865*             CREDIBILITY TABLES                               *
  2866****************************************************************
  2867
  2868     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2869         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2870                             INDEXED BY CF-CRDB-NDX.
  2871             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2872             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2873             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2874         16  FILLER                         PIC  X(332).
  2875
  2876
  2877****************************************************************
  2878*             REPORT CUSTOMIZATION RECORD                      *
  2879****************************************************************
  2880
  2881     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2882         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2883             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2884             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2885             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2886**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2887****       A T-TRANSFER.                                   ****
  2888             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2889
  2890         16  FILLER                         PIC XX.
  2891
  2892         16  CF-CARRIER-CNTL-OPT.
  2893             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2894                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2895                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2896             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2897                                            PIC X.
  2898         16  CF-GROUP-CNTL-OPT.
  2899             20  CF-GROUP-OPT-SEQ           PIC 9.
  2900                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2901                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2902             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2903                                            PIC X(6).
  2904         16  CF-STATE-CNTL-OPT.
  2905             20  CF-STATE-OPT-SEQ           PIC 9.
  2906                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2907                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2908             20  CF-STATE-SELECT OCCURS 3 TIMES
  2909                                            PIC XX.
  2910         16  CF-ACCOUNT-CNTL-OPT.
  2911             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2912                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2913                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2914             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2915                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL651.cbl
  2916         16  CF-BUS-TYP-CNTL-OPT.
  2917             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2918                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2919                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2920             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2921                                            PIC XX.
  2922         16  CF-LF-TYP-CNTL-OPT.
  2923             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2924                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2925                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2926             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2927                                            PIC XX.
  2928         16  CF-AH-TYP-CNTL-OPT.
  2929             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2930                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2931                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2932             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2933                                            PIC XX.
  2934         16  CF-REPTCD1-CNTL-OPT.
  2935             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2936                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2937                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2938             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2939                                            PIC X(10).
  2940         16  CF-REPTCD2-CNTL-OPT.
  2941             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2942                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2943                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2944             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2945                                            PIC X(10).
  2946         16  CF-USER1-CNTL-OPT.
  2947             20  CF-USER1-OPT-SEQ           PIC 9.
  2948                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2949                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2950             20  CF-USER1-SELECT OCCURS 3 TIMES
  2951                                            PIC X(10).
  2952         16  CF-USER2-CNTL-OPT.
  2953             20  CF-USER2-OPT-SEQ           PIC 9.
  2954                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2955                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2956             20  CF-USER2-SELECT OCCURS 3 TIMES
  2957                                            PIC X(10).
  2958         16  CF-USER3-CNTL-OPT.
  2959             20  CF-USER3-OPT-SEQ           PIC 9.
  2960                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2961                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2962             20  CF-USER3-SELECT OCCURS 3 TIMES
  2963                                            PIC X(10).
  2964         16  CF-USER4-CNTL-OPT.
  2965             20  CF-USER4-OPT-SEQ           PIC 9.
  2966                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2967                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2968             20  CF-USER4-SELECT OCCURS 3 TIMES
  2969                                            PIC X(10).
  2970         16  CF-USER5-CNTL-OPT.
  2971             20  CF-USER5-OPT-SEQ           PIC 9.
  2972                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2973                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL651.cbl
  2974             20  CF-USER5-SELECT OCCURS 3 TIMES
  2975                                            PIC X(10).
  2976         16  CF-REINS-CNTL-OPT.
  2977             20  CF-REINS-OPT-SEQ           PIC 9.
  2978                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2979                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2980             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2981                 24  CF-REINS-PRIME         PIC XXX.
  2982                 24  CF-REINS-SUB           PIC XXX.
  2983
  2984         16  CF-AGENT-CNTL-OPT.
  2985             20  CF-AGENT-OPT-SEQ           PIC 9.
  2986                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2987                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2988             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2989                                            PIC X(10).
  2990
  2991         16  FILLER                         PIC X(43).
  2992
  2993         16  CF-LOSS-RATIO-SELECT.
  2994             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2995             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2996         16  CF-ENTRY-DATE-SELECT.
  2997             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2998             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2999         16  CF-EFFECTIVE-DATE-SELECT.
  3000             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3001             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3002
  3003         16  CF-EXCEPTION-LIST-IND          PIC X.
  3004             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3005
  3006         16  FILLER                         PIC X(318).
  3007
  3008****************************************************************
  3009*                  EXCEPTION REPORTING RECORD                  *
  3010****************************************************************
  3011
  3012     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3013         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3014             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3015
  3016         16  CF-COMBINED-LIFE-AH-OPT.
  3017             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3018             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3019             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3020             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3021
  3022         16  CF-LIFE-OPT.
  3023             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3024             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3025             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3026             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3027             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3028             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3029             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3030             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3031             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL651.cbl
  3032             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3033
  3034         16  CF-AH-OPT.
  3035             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3036             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3037             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3038             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3039             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3040             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3041             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3042             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3043             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3044             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3045
  3046         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3047             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3048             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3049             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3050
  3051         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3052
  3053         16  FILLER                         PIC X(673).
  3054
  3055
  3056****************************************************************
  3057*             MORTGAGE SYSTEM PLAN RECORD                      *
  3058****************************************************************
  3059
  3060     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3061         16  CF-PLAN-TYPE                   PIC X.
  3062             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3063             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3064             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3065         16  CF-PLAN-ABBREV                 PIC XXX.
  3066         16  CF-PLAN-DESCRIPT               PIC X(10).
  3067         16  CF-PLAN-NOTES                  PIC X(20).
  3068         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3069         16  CF-PLAN-UNDERWRITING.
  3070             20  CF-PLAN-TERM-DATA.
  3071                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3072                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3073             20  CF-PLAN-AGE-DATA.
  3074                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3075                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3076                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3077             20  CF-PLAN-BENEFIT-DATA.
  3078                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3079                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3080                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3081                                            PIC S9(7)V99  COMP-3.
  3082         16  CF-PLAN-POLICY-FORMS.
  3083             20  CF-POLICY-FORM             PIC X(12).
  3084             20  CF-MASTER-APPLICATION      PIC X(12).
  3085             20  CF-MASTER-POLICY           PIC X(12).
  3086         16  CF-PLAN-RATING.
  3087             20  CF-RATE-CODE               PIC X(5).
  3088             20  CF-SEX-RATING              PIC X.
  3089                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL651.cbl
  3090                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3091             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3092             20  CF-SUB-STD-TYPE            PIC X.
  3093                 88  CF-PCT-OF-PREM            VALUE '1'.
  3094                 88  CF-PCT-OF-BENE            VALUE '2'.
  3095         16  CF-PLAN-PREM-TOLERANCES.
  3096             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3097             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3098         16  CF-PLAN-PYMT-TOLERANCES.
  3099             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3100             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3101         16  CF-PLAN-MISC-DATA.
  3102             20  FILLER                     PIC X.
  3103             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3104             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3105         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3106         16  CF-PLAN-IND-GRP                PIC X.
  3107             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3108                                                     '1'.
  3109             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3110                                                     '2'.
  3111         16  CF-MIB-SEARCH-SW               PIC X.
  3112             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3113             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3114             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3115             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3116         16  CF-ALPHA-SEARCH-SW             PIC X.
  3117             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3118             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3119             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3120             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3121             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3122             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3123             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3124             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3125             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3126             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3127                                                     'A' 'B' 'C'
  3128                                                     'X' 'Y' 'Z'.
  3129         16  CF-EFF-DT-RULE-SW              PIC X.
  3130             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3131             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3132             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3133             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3134             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3135         16  FILLER                         PIC X(4).
  3136         16  CF-HEALTH-QUESTIONS            PIC X.
  3137             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3138         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3139         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3140         16  CF-PLAN-SNGL-JNT               PIC X.
  3141             88  CF-COMBINED-PLAN              VALUE 'C'.
  3142             88  CF-JNT-PLAN                   VALUE 'J'.
  3143             88  CF-SNGL-PLAN                  VALUE 'S'.
  3144         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3145         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3146         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3147         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL651.cbl
  3148         16  CF-RERATE-CNTL                 PIC  X.
  3149             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3150             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3151             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3152             88  CF-AUTO-RECALC                 VALUE '4'.
  3153         16  CF-BENEFIT-TYPE                PIC  X.
  3154             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3155             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3156         16  CF-POLICY-FEE                  PIC S999V99
  3157                                                    COMP-3.
  3158         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3159         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3160         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3161         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3162         16  FILLER                         PIC  X(32).
  3163         16  CF-TERMINATION-FORM            PIC  X(04).
  3164         16  FILLER                         PIC  X(08).
  3165         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3166                                                       COMP-3.
  3167         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3168         16  CF-ISSUE-LETTER                PIC  X(4).
  3169         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3170         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3171             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3172             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3173         16  CF-MP-REFUND-CALC              PIC X.
  3174             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3175             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3176             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3177             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3178             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3179             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3180             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3181             88  CF-MP-REFD-MEAN                VALUE '8'.
  3182         16  CF-ALT-RATE-CODE               PIC  X(5).
  3183
  3184
  3185         16  FILLER                         PIC X(498).
  3186****************************************************************
  3187*             MORTGAGE COMPANY MASTER RECORD                   *
  3188****************************************************************
  3189
  3190     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3191         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3192         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3193             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3194             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3195             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3196             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3197             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3198
  3199         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3200         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3201         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3202         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3203         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3204
  3205         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL651.cbl
  3206             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3207         16  CF-MP-RECON-USE-IND            PIC X(1).
  3208             88  CF-MP-USE-RECON             VALUE 'Y'.
  3209         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3210             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3211         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3212             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3213             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3214         16  FILLER                         PIC X(1).
  3215         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3216             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3217         16  CF-MORTG-MIB-VERSION           PIC X.
  3218             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3219             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3220             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3221         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3222             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3223                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3224             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3225                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3226             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3227                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3228             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3229                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3230             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3231                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3232             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3233                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3234         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3235         16  FILLER                         PIC X(7).
  3236         16  CF-MORTG-DESTINATION-SYMBOL.
  3237             20  CF-MORTG-MIB-COMM          PIC X(5).
  3238             20  CF-MORTG-MIB-TERM          PIC X(5).
  3239         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3240             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3241         16  FILLER                         PIC X(03).
  3242         16  CF-MP-CHECK-NO-CONTROL.
  3243             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3244                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3245                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3246                                                ' ' LOW-VALUES.
  3247                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3248                                               VALUE '3'.
  3249         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3250         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3251         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3252             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3253                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3254             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3255                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3256             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3257                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3258             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3259                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3260             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3261                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3262             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3263                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL651.cbl
  3264         16  CF-MORTG-BILLING-AREA.
  3265             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3266                                            PIC X.
  3267         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3268         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3269         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3270         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3271             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3272             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3273         16  FILLER                         PIC X.
  3274         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3275             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3276             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3277         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3278         16  FILLER                         PIC X(8).
  3279         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3280         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3281         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3282         16  CF-ACH-COMPANY-ID.
  3283             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3284                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3285                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3286                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3287             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3288         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3289             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3290         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3291             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3292             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3293         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3294         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3295         16  FILLER                         PIC X(536).
  3296
  3297****************************************************************
  3298*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3299****************************************************************
  3300
  3301     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3302         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3303             20  CF-FEMALE-HEIGHT.
  3304                 24  CF-FEMALE-FT           PIC 99.
  3305                 24  CF-FEMALE-IN           PIC 99.
  3306             20  CF-FEMALE-MIN-WT           PIC 999.
  3307             20  CF-FEMALE-MAX-WT           PIC 999.
  3308         16  FILLER                         PIC X(428).
  3309
  3310     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3311         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3312             20  CF-MALE-HEIGHT.
  3313                 24  CF-MALE-FT             PIC 99.
  3314                 24  CF-MALE-IN             PIC 99.
  3315             20  CF-MALE-MIN-WT             PIC 999.
  3316             20  CF-MALE-MAX-WT             PIC 999.
  3317         16  FILLER                         PIC X(428).
  3318******************************************************************
  3319*             AUTOMATIC ACTIVITY RECORD                          *
  3320******************************************************************
  3321     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL651.cbl
  3322         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3323             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3324             20  CF-SYS-LETTER-ID           PIC X(04).
  3325             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3326             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3327             20  CF-SYS-RESET-SW            PIC X(01).
  3328             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3329             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3330
  3331         16  FILLER                         PIC X(50).
  3332
  3333         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3334             20  CF-USER-ACTIVE-SW          PIC X(01).
  3335             20  CF-USER-LETTER-ID          PIC X(04).
  3336             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3337             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3338             20  CF-USER-RESET-SW           PIC X(01).
  3339             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3340             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3341             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3342
  3343         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL651.cbl
  3345
  3346 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  3347                          REINSURANCE-RECORD CONTROL-FILE.
  3348 0000-DFHEXIT SECTION.
  3349     MOVE '9#                    $   ' TO DFHEIV0.
  3350     MOVE 'EL651' TO DFHEIV1.
  3351     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3352     CONTINUE.
  3353
  3354     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3355     MOVE '5'                    TO  DC-OPTION-CODE.
  3356     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  3357     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  3358     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  3359
  3360     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3361
  3362 1000-START.
  3363     IF EIBCALEN = 0
  3364         GO TO 8800-UNAUTHORIZED-ACCESS.
  3365
  3366     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3367         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3368             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  3369             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  3370             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  3371             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  3372             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  3373             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  3374             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  3375             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  3376         ELSE
  3377             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  3378             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  3379             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  3380             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  3381             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  3382             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  3383             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  3384             MOVE SPACES               TO  PI-SAVED-PROGRAM-6.
  3385
  3386
  3387* EXEC CICS HANDLE CONDITION
  3388*        NOTOPEN  (9990-ABEND)
  3389*        NOTFND   (8880-NOT-FOUND)
  3390*        PGMIDERR (9600-PGMID-ERROR)
  3391*        ERROR    (9990-ABEND)
  3392*    END-EXEC.
  3393*    MOVE '"$JIL.                ! " #00003382' TO DFHEIV0
  3394     MOVE X'22244A494C2E202020202020' TO DFHEIV0(1:12)
  3395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3396     MOVE X'2220233030303033333832' TO DFHEIV0(25:11)
  3397     CALL 'kxdfhei1' USING DFHEIV0
  3398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3399
  3400
  3401     IF EIBTRNID = EL6592-TRANS-ID
  3402         MOVE 'S'                TO  MAINTYPI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL651.cbl
  3403                                     PI-CHECK-MAINT-TYPE
  3404         MOVE PI-ERR-TABLE       TO  TABLEI
  3405         MOVE PI-START-LEVEL     TO  LEVELI
  3406         MOVE +1                 TO  MAINTYPL
  3407         MOVE +3                 TO  TABLEL
  3408         MOVE +2                 TO  LEVELL
  3409         GO TO 4000-EDIT-MAINT.
  3410
  3411     IF EIBTRNID NOT = TRANS-ID
  3412         IF NOT-FIRST-ENTRY
  3413             MOVE +1             TO  PI-SUB
  3414             MOVE ZEROS          TO  PI-LAST-LEVEL
  3415                                     MISC-SAVE-AREAS
  3416             GO TO 5000-BUILD-INITIAL-SCREEN
  3417         ELSE
  3418             MOVE LOW-VALUES     TO  EL651AI
  3419                                     PI-PROGRAM-WORK-AREA
  3420             MOVE 'Y'            TO  PI-ENTRY-SW
  3421                                     PI-FIRST-TIME-SW
  3422             MOVE ZEROS          TO  PI-LAST-LEVEL
  3423             MOVE +1             TO  PI-SUB
  3424             GO TO 8100-SEND-INITIAL-MAP.
  3425
  3426
  3427     IF EIBAID = DFHCLEAR
  3428         GO TO 9400-CLEAR.
  3429
  3430     IF PI-PROCESSOR-ID = 'LGXX'
  3431         GO TO 2000-RECEIVE.
  3432
  3433
  3434* EXEC CICS READQ TS
  3435*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  3436*        INTO   (SECURITY-CONTROL)
  3437*        LENGTH (SC-COMM-LENGTH)
  3438*        ITEM   (SC-ITEM)
  3439*    END-EXEC.
  3440*    MOVE '*$II   L              ''   #00003421' TO DFHEIV0
  3441     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3442     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3443     MOVE X'2020233030303033343231' TO DFHEIV0(25:11)
  3444     CALL 'kxdfhei1' USING DFHEIV0,
  3445           PI-SECURITY-TEMP-STORE-ID,
  3446           SECURITY-CONTROL,
  3447           SC-COMM-LENGTH,
  3448           SC-ITEM,
  3449           DFHEIV99,
  3450           DFHEIV99
  3451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3452
  3453
  3454     MOVE SC-CREDIT-DISPLAY (07)  TO PI-DISPLAY-CAP.
  3455     MOVE SC-CREDIT-UPDATE  (07)  TO PI-MODIFY-CAP.
  3456
  3457     IF NOT DISPLAY-CAP
  3458         MOVE 'READ'          TO SM-READ
  3459         PERFORM 9995-SECURITY-VIOLATION
  3460         MOVE ER-0070        TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL651.cbl
  3461         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3462         GO TO 8100-SEND-INITIAL-MAP.
  3463
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL651.cbl
  3465 2000-RECEIVE.
  3466     MOVE LOW-VALUES             TO  EL651AI.
  3467
  3468     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  3469         MOVE ER-0008            TO  EMI-ERROR
  3470         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3471         MOVE -1                 TO  MAINTYPL
  3472         GO TO 8200-SEND-DATAONLY.
  3473
  3474
  3475* EXEC CICS RECEIVE
  3476*        MAP    (MAP-NAME)
  3477*        MAPSET (MAPSET-NAME)
  3478*        INTO   (EL651AI)
  3479*    END-EXEC.
  3480     MOVE LENGTH OF
  3481      EL651AI
  3482       TO DFHEIV11
  3483*    MOVE '8"T I  L              ''   #00003448' TO DFHEIV0
  3484     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3485     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3486     MOVE X'2020233030303033343438' TO DFHEIV0(25:11)
  3487     CALL 'kxdfhei1' USING DFHEIV0,
  3488           MAP-NAME,
  3489           EL651AI,
  3490           DFHEIV11,
  3491           MAPSET-NAME,
  3492           DFHEIV99,
  3493           DFHEIV99
  3494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3495
  3496
  3497     IF PFENTERL = 0
  3498         GO TO 3000-CHECK-PFENTERS.
  3499
  3500     IF EIBAID NOT = DFHENTER
  3501         MOVE ER-0004            TO  EMI-ERROR
  3502         GO TO 3100-INPUT-ERROR.
  3503
  3504     IF (PFENTERI NUMERIC) AND (PFENTERI GREATER 0 AND LESS 25)
  3505         MOVE PF-VALUES (PFENTERI)   TO EIBAID
  3506     ELSE
  3507         MOVE ER-0029                TO EMI-ERROR
  3508         GO TO 3100-INPUT-ERROR.
  3509
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL651.cbl
  3511 3000-CHECK-PFENTERS.
  3512     IF EIBAID = DFHPF23
  3513         GO TO 8810-PF23.
  3514
  3515     IF EIBAID = DFHPF24
  3516         GO TO 9200-RETURN-MAIN-MENU.
  3517
  3518     IF EIBAID = DFHPF12
  3519         GO TO 9500-PF12.
  3520
  3521     IF MAINTYPL GREATER ZERO
  3522         IF MAINTYPI NOT = SPACE
  3523             IF EIBAID = DFHENTER OR DFHPF10
  3524                NEXT SENTENCE
  3525               ELSE
  3526                MOVE ER-0050    TO  EMI-ERROR
  3527                GO TO 3100-INPUT-ERROR.
  3528
  3529     IF EIBAID = DFHPF1
  3530         GO TO 7100-PAGE-TABLE-FORWARD.
  3531
  3532     IF EIBAID = DFHPF2
  3533         GO TO 7200-PAGE-TABLE-BACKWARD.
  3534
  3535     IF EIBAID = DFHPF3
  3536         MOVE 'F'                TO  WS-PAGE-LEVEL-SW
  3537         GO TO 7300-PAGE-LEVEL.
  3538
  3539     IF EIBAID = DFHPF4
  3540         MOVE 'B'                TO  WS-PAGE-LEVEL-SW
  3541         GO TO 7300-PAGE-LEVEL.
  3542
  3543     IF EIBAID = DFHPF7
  3544         MOVE PI-ERR-TABLE       TO  PI-SAVE-TABLE
  3545         MOVE PI-SAVE-COMPANY    TO  PI-ERR-TABLE
  3546         MOVE PI-SAVE-COMP-SUB   TO  PI-ERR-TABLE-SUB
  3547         MOVE 'EL6511B'          TO  PI-MAPNAME
  3548         MOVE XCTL-6511          TO  PGM-NAME
  3549         GO TO 9300-XCTL.
  3550
  3551     IF EIBAID = DFHPF8
  3552         MOVE XCTL-657           TO  PGM-NAME
  3553         GO TO 9300-XCTL.
  3554
  3555     IF EIBAID = DFHPF9
  3556         MOVE PI-ERR-TABLE       TO  PI-SAVE-TABLE
  3557         MOVE PI-SAVE-COMPANY    TO  PI-ERR-TABLE
  3558         MOVE PI-SAVE-COMP-SUB   TO  PI-ERR-TABLE-SUB
  3559         MOVE XCTL-6511          TO  PGM-NAME
  3560         MOVE 'EL6511C'          TO  PI-MAPNAME
  3561         GO TO 9300-XCTL.
  3562
  3563     IF EIBAID = DFHENTER OR EIBAID = DFHPF10
  3564         GO TO 4000-EDIT-MAINT.
  3565
  3566     MOVE ER-0029                TO  EMI-ERROR.
  3567
  3568 3100-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL651.cbl
  3569     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3570     MOVE AL-UNBON               TO  PFENTERA.
  3571     MOVE -1                     TO  PFENTERL.
  3572     GO TO 8200-SEND-DATAONLY.
  3573
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL651.cbl
  3575 4000-EDIT-MAINT.
  3576     IF MAINTYPL GREATER ZERO
  3577         MOVE MAINTYPI           TO  PI-CHECK-MAINT-TYPE
  3578         IF VALID-MAINT-TYPE
  3579             MOVE AL-UANON       TO  MAINTYPA
  3580         ELSE
  3581             MOVE -1             TO  MAINTYPL
  3582             MOVE AL-UABON       TO  MAINTYPA
  3583             MOVE ER-0023        TO  EMI-ERROR
  3584             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3585     ELSE
  3586         MOVE -1                 TO  MAINTYPL
  3587         MOVE AL-UABON           TO  MAINTYPA
  3588         MOVE ER-0023            TO  EMI-ERROR
  3589         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3590
  3591     IF NOT MODIFY-CAP
  3592         IF NOT SHOW-FUNCTION
  3593             MOVE 'UPDATE'       TO SM-READ
  3594             PERFORM 9995-SECURITY-VIOLATION
  3595             MOVE ER-0070        TO  EMI-ERROR
  3596             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3597
  3598     IF TABLEL GREATER ZERO
  3599         MOVE ZERO TO TALLY
  3600         INSPECT TABLEI TALLYING TALLY FOR ALL SPACES
  3601         IF TALLY GREATER ZERO
  3602             MOVE -1             TO  TABLEL
  3603             MOVE AL-UABON       TO  TABLEA
  3604             MOVE ER-2341        TO  EMI-ERROR
  3605             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3606         ELSE
  3607             MOVE AL-UANON       TO  TABLEA
  3608             MOVE TABLEI         TO  PI-ERR-TABLE
  3609             MOVE LOW-VALUES     TO  PI-ERR-TABLE-SUB
  3610     ELSE
  3611         MOVE -1                 TO  TABLEL
  3612         MOVE AL-UABON           TO  TABLEA
  3613         MOVE ER-2140            TO  EMI-ERROR
  3614         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3615
  3616     IF LEVELL GREATER ZERO
  3617         IF LEVELI NOT NUMERIC
  3618             MOVE -1                     TO  LEVELL
  3619             MOVE AL-UNBON               TO  LEVELA
  3620             MOVE ER-2310                TO  EMI-ERROR
  3621             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3622         ELSE
  3623             MOVE LEVELI                 TO  WS-CHECK-LEVEL
  3624             IF VALID-LEVEL
  3625                 IF CHANGE-FUNCTION
  3626                     IF LEVELI = PI-SUB
  3627                         MOVE AL-UNNON   TO  LEVELA
  3628                     ELSE
  3629                         MOVE -1         TO  MAINTYPL
  3630                         MOVE ER-2056    TO  EMI-ERROR
  3631                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3632                         GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL651.cbl
  3633                 ELSE
  3634                     MOVE WS-CHECK-LEVEL TO  PI-SUB
  3635                     MOVE AL-UNNON       TO  LEVELA
  3636             ELSE
  3637                 MOVE -1                 TO  LEVELL
  3638                 MOVE AL-UNBON           TO  LEVELA
  3639                 MOVE ER-2310            TO  EMI-ERROR
  3640                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3641
  3642     IF TOTABLEL GREATER ZERO
  3643         MOVE ZERO TO TALLY
  3644         INSPECT TOTABLEI TALLYING TALLY FOR ALL SPACES
  3645         IF TALLY GREATER ZERO
  3646             MOVE -1             TO  TOTABLEL
  3647             MOVE AL-UABON       TO  TOTABLEA
  3648             MOVE ER-2342        TO  EMI-ERROR
  3649             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3650         ELSE
  3651             MOVE AL-UANON       TO  TOTABLEA
  3652     ELSE
  3653         IF COPY-FUNCTION
  3654             MOVE -1             TO  TOTABLEL
  3655             MOVE AL-UABON       TO  TOTABLEA
  3656             MOVE ER-2343        TO  EMI-ERROR
  3657             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3658
  3659     IF ADD-FUNCTION OR COPY-FUNCTION OR CHANGE-FUNCTION
  3660         IF (COMPANYI EQUAL ZEROS) AND
  3661                     (COMPSUBI EQUAL ZEROS)
  3662             MOVE -1             TO  COMPANYL
  3663             MOVE AL-UABON       TO  COMPANYA
  3664                                     COMPSUBA
  3665             MOVE ER-7805        TO  EMI-ERROR
  3666             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3667
  3668     IF EMI-NO-ERRORS
  3669         NEXT SENTENCE
  3670     ELSE
  3671         GO TO 8200-SEND-DATAONLY.
  3672
  3673     IF ADD-FUNCTION
  3674         GO TO 4200-ADD.
  3675
  3676     IF CHANGE-FUNCTION
  3677         GO TO 4400-CHANGE.
  3678
  3679     IF COPY-FUNCTION
  3680         GO TO 4500-COPY.
  3681
  3682     IF DELETE-FUNCTION OR EIBAID = DFHPF10
  3683         GO TO 4600-DELETE-LEVEL.
  3684
  3685     IF SHOW-FUNCTION
  3686         MOVE 'Y'                TO  WS-CHANGE-SW
  3687         GO TO 5000-BUILD-INITIAL-SCREEN.
  3688
  3689     MOVE -1                     TO  MAINTYPL.
  3690     MOVE ER-2056                TO  EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL651.cbl
  3691     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3692     GO TO 8200-SEND-DATAONLY.
  3693
  3694 4000-EXIT.
  3695     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL651.cbl
  3697
  3698 4200-ADD.
  3699     PERFORM 7000-EDIT THRU 7000-EXIT.
  3700
  3701     IF EMI-NO-ERRORS
  3702         NEXT SENTENCE
  3703     ELSE
  3704         GO TO 8200-SEND-DATAONLY.
  3705
  3706
  3707* EXEC CICS HANDLE CONDITION
  3708*        NOTOPEN  (9990-ABEND)
  3709*        NOTFND   (4250-ADD-REC)
  3710*        END-EXEC.
  3711*    MOVE '"$JI                  ! # #00003663' TO DFHEIV0
  3712     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  3713     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3714     MOVE X'2320233030303033363633' TO DFHEIV0(25:11)
  3715     CALL 'kxdfhei1' USING DFHEIV0
  3716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3717
  3718
  3719     MOVE 'A'                    TO  PI-ERR-CODE.
  3720
  3721     PERFORM 7650-READ-ERREIN THRU 7650-EXIT.
  3722
  3723******************************************************************
  3724*  CODE ADDED TO INSURE IF USER HAS CARRIER SECURITY THAT THEY   *
  3725*  ARE ONLY ALLOWED TO APPLY MAINTENANCE TO THOSE REIN. RECORDS  *
  3726*  WITH A MATCHING CARRIER IN THE RE-TABLE-CARRIER-SECURITY FIELD*
  3727******************************************************************
  3728
  3729     IF PI-CARRIER-SECURITY GREATER SPACE
  3730         IF PI-CARRIER-SECURITY = RE-TABLE-CARRIER-SECURITY
  3731             NEXT SENTENCE
  3732         ELSE
  3733             MOVE -1             TO  MAINTYPL
  3734             MOVE ER-2370        TO  EMI-ERROR
  3735             MOVE AL-UANON       TO  MAINTYPA
  3736             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3737             GO TO 8200-SEND-DATAONLY.
  3738
  3739     GO TO 4300-ADD-LEVEL.
  3740
  3741 4250-ADD-REC.
  3742     IF WS-GETMAIN-SW = '1'
  3743         MOVE ' '                TO  WS-GETMAIN-SW
  3744         MOVE SPACES             TO  REINSURANCE-RECORD
  3745     ELSE
  3746         PERFORM 7700-ERREIN-GETMAIN THRU 7700-EXIT.
  3747
  3748     MOVE ZEROS                  TO  RE-100-COMP
  3749                                     RE-LAST-MAINT-HHMMSS.
  3750     MOVE LOW-VALUES             TO  RE-KEY.
  3751     MOVE PI-ERR-CODE            TO  RE-CODE.
  3752     MOVE PI-ERR-TABLE           TO  RE-TABLE.
  3753
  3754     MOVE +1                     TO  PI-SUB.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL651.cbl
  3755
  3756 4255-ZERO-RECORD.
  3757     MOVE ZEROS                  TO  RE-LFAGE-LO (PI-SUB)
  3758                                     RE-AHAGE-LO (PI-SUB)
  3759                                     RE-LFTRM-LO (PI-SUB)
  3760                                     RE-AHTRM-LO (PI-SUB)
  3761                                     RE-LF-PCT (PI-SUB)
  3762                                     RE-AH-PCT (PI-SUB)
  3763                                     RE-LF-LIM-LO (PI-SUB)
  3764                                     RE-LF-LO (PI-SUB)
  3765                                     RE-AHBEN-LIM-LO (PI-SUB)
  3766                                     RE-AHBEN-LO (PI-SUB)
  3767                                     RE-AHMOA-LIM-LO (PI-SUB)
  3768                                     RE-AHMOA-LO (PI-SUB)
  3769                                     RE-LO-DATE (PI-SUB).
  3770
  3771      MOVE ALL '9'               TO  RE-LFAGE-HI (PI-SUB)
  3772                                     RE-AHAGE-HI (PI-SUB)
  3773                                     RE-LFTRM-HI (PI-SUB)
  3774                                     RE-AHTRM-HI (PI-SUB)
  3775                                     RE-HI-DATE (PI-SUB).
  3776
  3777     MOVE NINES                  TO  RE-LF-LIM-HI (PI-SUB)
  3778                                     RE-LF-HI (PI-SUB)
  3779                                     RE-AHBEN-LIM-HI (PI-SUB)
  3780                                     RE-AHBEN-HI (PI-SUB)
  3781                                     RE-AHMOA-LIM-HI (PI-SUB)
  3782                                     RE-AHMOA-HI (PI-SUB).
  3783     ADD +1                      TO  PI-SUB.
  3784
  3785     IF PI-SUB GREATER +30
  3786         MOVE +1                 TO  PI-SUB
  3787     ELSE
  3788         GO TO 4255-ZERO-RECORD.
  3789
  3790     PERFORM 6000-CHECK-FOR-UPDATE THRU 6099-EXIT.
  3791
  3792     MOVE PI-PROCESSOR-ID        TO  RE-LAST-MAINT-USER.
  3793     MOVE EIBTIME                TO  RE-LAST-MAINT-HHMMSS.
  3794     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3795
  3796     MOVE '5'                    TO  DC-OPTION-CODE.
  3797     MOVE LINK-ELDATCV           TO  PGM-NAME.
  3798
  3799
  3800* EXEC CICS LINK
  3801*        PROGRAM   (PGM-NAME)
  3802*        COMMAREA  (DATE-CONVERSION-DATA)
  3803*        LENGTH    (DC-COMM-LENGTH)
  3804*    END-EXEC.
  3805*    MOVE '."C                   ''   #00003748' TO DFHEIV0
  3806     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3807     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3808     MOVE X'2020233030303033373438' TO DFHEIV0(25:11)
  3809     CALL 'kxdfhei1' USING DFHEIV0,
  3810           PGM-NAME,
  3811           DATE-CONVERSION-DATA,
  3812           DC-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL651.cbl
  3813           DFHEIV99,
  3814           DFHEIV99,
  3815           DFHEIV99
  3816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3817
  3818
  3819     MOVE DC-BIN-DATE-1          TO  RE-LAST-MAINT-DT
  3820                                     BIN-CURRENT-SAVE.
  3821     MOVE PI-COMPANY-CD          TO  RE-COMPANY-CD.
  3822     MOVE 'RE'                   TO  RE-RECORD-ID.
  3823*    MOVE REIN-FILE-ID           TO  FILE-ID.
  3824*    MOVE 'A'                    TO  JP-RECORD-TYPE
  3825*    MOVE ERREIN-LENGTH          TO  FILE-LENGTH
  3826*    MOVE REINSURANCE-RECORD     TO  JP-RECORD-AREA.
  3827
  3828
  3829* EXEC CICS WRITE
  3830*        DATASET (REIN-FILE-ID)
  3831*        FROM    (REINSURANCE-RECORD)
  3832*        RIDFLD  (RE-CONTROL-PRIMARY)
  3833*    END-EXEC.
  3834     MOVE LENGTH OF
  3835      REINSURANCE-RECORD
  3836       TO DFHEIV11
  3837*    MOVE '&$ L                  ''   #00003763' TO DFHEIV0
  3838     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3839     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3840     MOVE X'2020233030303033373633' TO DFHEIV0(25:11)
  3841     CALL 'kxdfhei1' USING DFHEIV0,
  3842           REIN-FILE-ID,
  3843           REINSURANCE-RECORD,
  3844           DFHEIV11,
  3845           RE-CONTROL-PRIMARY,
  3846           DFHEIV99,
  3847           DFHEIV99
  3848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3849
  3850
  3851*    PERFORM 8400-LOG-JOURNAL-RECORD.
  3852     PERFORM 8000-UPDATE-MAINT-DATE THRU 8000-EXIT.
  3853
  3854     IF COMPANY-RECORD-ADDED
  3855         MOVE SPACE              TO  PI-COMPANY-ADD-SW
  3856         MOVE ER-2345            TO  EMI-ERROR
  3857     ELSE
  3858         MOVE ER-0000            TO  EMI-ERROR.
  3859
  3860     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3861
  3862     GO TO 5000-BUILD-INITIAL-SCREEN.
  3863
  3864 4200-EXIT.
  3865     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL651.cbl
  3867
  3868 4300-ADD-LEVEL.
  3869     IF PI-LAST-LEVEL = +30
  3870         MOVE -1                 TO  MAINTYPL
  3871         MOVE ER-2344            TO  EMI-ERROR
  3872         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3873         GO TO 8200-SEND-DATAONLY.
  3874
  3875     PERFORM 7750-READ-ERREIN-UPDATE THRU 7750-EXIT.
  3876
  3877*    MOVE REINSURANCE-RECORD     TO  JP-RECORD-AREA.
  3878
  3879     IF EXCESS-LEVEL-EXISTS
  3880         MOVE RE-COMP-INFO (PI-LAST-LEVEL) TO WS-SAVE-REC
  3881         MOVE PI-SUB             TO  WS-SAVE-PI-SUB
  3882         MOVE PI-LAST-LEVEL      TO  PI-SUB
  3883         PERFORM 6000-CHECK-FOR-UPDATE THRU 6099-EXIT
  3884         MOVE WS-SAVE-PI-SUB     TO  PI-SUB
  3885         ADD +1                  TO  PI-LAST-LEVEL
  3886                                     RE-100-COMP
  3887         MOVE WS-SAVE-REC        TO  RE-COMP-INFO (PI-LAST-LEVEL)
  3888     ELSE
  3889         ADD +1                  TO  PI-LAST-LEVEL
  3890         MOVE PI-SUB             TO  WS-SAVE-PI-SUB
  3891         MOVE PI-LAST-LEVEL      TO  PI-SUB
  3892         PERFORM 6000-CHECK-FOR-UPDATE THRU 6099-EXIT
  3893         MOVE WS-SAVE-PI-SUB     TO  PI-SUB.
  3894
  3895     IF RE-LAST-MAINT-USER = PI-UPDATE-BY OR
  3896        RE-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS
  3897         NEXT SENTENCE
  3898     ELSE
  3899
  3900* EXEC CICS UNLOCK
  3901*             DATASET  (REIN-FILE-ID)
  3902*        END-EXEC
  3903*    MOVE '&*                    #   #00003817' TO DFHEIV0
  3904     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  3905     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3906     MOVE X'2020233030303033383137' TO DFHEIV0(25:11)
  3907     CALL 'kxdfhei1' USING DFHEIV0,
  3908           REIN-FILE-ID,
  3909           DFHEIV99
  3910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3911         MOVE ER-0068            TO  EMI-ERROR
  3912         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3913         GO TO 5000-BUILD-INITIAL-SCREEN.
  3914
  3915     MOVE PI-PROCESSOR-ID        TO  RE-LAST-MAINT-USER.
  3916     MOVE EIBTIME                TO  RE-LAST-MAINT-HHMMSS.
  3917     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3918     MOVE '5'                    TO  DC-OPTION-CODE.
  3919     MOVE LINK-ELDATCV           TO  PGM-NAME.
  3920
  3921
  3922* EXEC CICS LINK
  3923*        PROGRAM   (PGM-NAME)
  3924*        COMMAREA  (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL651.cbl
  3925*        LENGTH    (DC-COMM-LENGTH)
  3926*    END-EXEC.
  3927*    MOVE '."C                   ''   #00003830' TO DFHEIV0
  3928     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3929     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3930     MOVE X'2020233030303033383330' TO DFHEIV0(25:11)
  3931     CALL 'kxdfhei1' USING DFHEIV0,
  3932           PGM-NAME,
  3933           DATE-CONVERSION-DATA,
  3934           DC-COMM-LENGTH,
  3935           DFHEIV99,
  3936           DFHEIV99,
  3937           DFHEIV99
  3938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3939
  3940
  3941     MOVE DC-BIN-DATE-1          TO  RE-LAST-MAINT-DT
  3942                                     BIN-CURRENT-SAVE.
  3943*    MOVE 'B'                    TO  JP-RECORD-TYPE
  3944*    MOVE REIN-FILE-ID           TO  FILE-ID.
  3945*    MOVE ERREIN-LENGTH          TO  FILE-LENGTH
  3946*    PERFORM 8400-LOG-JOURNAL-RECORD
  3947*    MOVE REINSURANCE-RECORD     TO JP-RECORD-AREA.
  3948
  3949
  3950* EXEC CICS REWRITE
  3951*        DATASET  (REIN-FILE-ID)
  3952*        FROM     (REINSURANCE-RECORD)
  3953*    END-EXEC.
  3954     MOVE LENGTH OF
  3955      REINSURANCE-RECORD
  3956       TO DFHEIV11
  3957*    MOVE '&& L                  %   #00003844' TO DFHEIV0
  3958     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3959     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3960     MOVE X'2020233030303033383434' TO DFHEIV0(25:11)
  3961     CALL 'kxdfhei1' USING DFHEIV0,
  3962           REIN-FILE-ID,
  3963           REINSURANCE-RECORD,
  3964           DFHEIV11,
  3965           DFHEIV99
  3966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3967
  3968
  3969*    MOVE 'C'                    TO  JP-RECORD-TYPE
  3970*    MOVE ERREIN-LENGTH          TO  FILE-LENGTH
  3971*    PERFORM 8400-LOG-JOURNAL-RECORD.
  3972     PERFORM 8000-UPDATE-MAINT-DATE THRU 8000-EXIT.
  3973     MOVE ER-0000                TO  EMI-ERROR.
  3974     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3975
  3976     MOVE 'Y'                    TO  WS-CHANGE-SW.
  3977
  3978     GO TO 5000-BUILD-INITIAL-SCREEN.
  3979
  3980 4300-EXIT.
  3981     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL651.cbl
  3983 4400-CHANGE.
  3984     IF PI-ERREIN-KEY = PI-SAVE-ERREIN-KEY
  3985         NEXT SENTENCE
  3986     ELSE
  3987         MOVE ER-2056            TO  EMI-ERROR
  3988         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3989         MOVE -1                 TO  MAINTYPL
  3990         GO TO 8200-SEND-DATAONLY.
  3991
  3992     PERFORM 7000-EDIT               THRU 7000-EXIT.
  3993
  3994     IF EMI-NO-ERRORS
  3995         NEXT SENTENCE
  3996     ELSE
  3997         GO TO 8200-SEND-DATAONLY.
  3998
  3999     PERFORM 7750-READ-ERREIN-UPDATE THRU 7750-EXIT.
  4000
  4001*    MOVE REINSURANCE-RECORD     TO  JP-RECORD-AREA.
  4002
  4003     PERFORM 6000-CHECK-FOR-UPDATE   THRU 6099-EXIT.
  4004
  4005     IF RE-LAST-MAINT-USER = PI-UPDATE-BY OR
  4006        RE-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS
  4007         NEXT SENTENCE
  4008     ELSE
  4009
  4010* EXEC CICS UNLOCK
  4011*             DATASET  (REIN-FILE-ID)
  4012*        END-EXEC
  4013*    MOVE '&*                    #   #00003889' TO DFHEIV0
  4014     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4015     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4016     MOVE X'2020233030303033383839' TO DFHEIV0(25:11)
  4017     CALL 'kxdfhei1' USING DFHEIV0,
  4018           REIN-FILE-ID,
  4019           DFHEIV99
  4020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4021         MOVE ER-0068            TO  EMI-ERROR
  4022         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4023         GO TO 8200-SEND-DATAONLY.
  4024
  4025     MOVE PI-PROCESSOR-ID        TO  RE-LAST-MAINT-USER.
  4026     MOVE EIBTIME                TO  RE-LAST-MAINT-HHMMSS.
  4027     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4028     MOVE '5'                    TO  DC-OPTION-CODE.
  4029     MOVE LINK-ELDATCV           TO  PGM-NAME.
  4030
  4031
  4032* EXEC CICS LINK
  4033*        PROGRAM   (PGM-NAME)
  4034*        COMMAREA  (DATE-CONVERSION-DATA)
  4035*        LENGTH    (DC-COMM-LENGTH)
  4036*    END-EXEC.
  4037*    MOVE '."C                   ''   #00003902' TO DFHEIV0
  4038     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4039     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4040     MOVE X'2020233030303033393032' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL651.cbl
  4041     CALL 'kxdfhei1' USING DFHEIV0,
  4042           PGM-NAME,
  4043           DATE-CONVERSION-DATA,
  4044           DC-COMM-LENGTH,
  4045           DFHEIV99,
  4046           DFHEIV99,
  4047           DFHEIV99
  4048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4049
  4050
  4051     MOVE DC-BIN-DATE-1          TO  RE-LAST-MAINT-DT
  4052                                     BIN-CURRENT-SAVE.
  4053*    MOVE 'B'                    TO  JP-RECORD-TYPE.
  4054*    MOVE REIN-FILE-ID           TO  FILE-ID.
  4055*    MOVE ERREIN-LENGTH          TO  FILE-LENGTH.
  4056*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4057*    MOVE REINSURANCE-RECORD     TO  JP-RECORD-AREA.
  4058
  4059
  4060* EXEC CICS REWRITE
  4061*        DATASET  (REIN-FILE-ID)
  4062*        FROM     (REINSURANCE-RECORD)
  4063*    END-EXEC.
  4064     MOVE LENGTH OF
  4065      REINSURANCE-RECORD
  4066       TO DFHEIV11
  4067*    MOVE '&& L                  %   #00003916' TO DFHEIV0
  4068     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4069     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4070     MOVE X'2020233030303033393136' TO DFHEIV0(25:11)
  4071     CALL 'kxdfhei1' USING DFHEIV0,
  4072           REIN-FILE-ID,
  4073           REINSURANCE-RECORD,
  4074           DFHEIV11,
  4075           DFHEIV99
  4076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4077
  4078
  4079*    MOVE 'C'                    TO  JP-RECORD-TYPE
  4080*    MOVE ERREIN-LENGTH          TO  FILE-LENGTH
  4081*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4082     PERFORM 8000-UPDATE-MAINT-DATE THRU 8000-EXIT.
  4083     MOVE ER-0000                TO  EMI-ERROR.
  4084     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4085
  4086     MOVE 'Y'                    TO  WS-CHANGE-SW.
  4087
  4088     GO TO 5000-BUILD-INITIAL-SCREEN.
  4089
  4090 4400-EXIT.
  4091     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL651.cbl
  4093
  4094 4500-COPY.
  4095     MOVE LOW-VALUES             TO  PI-ERREIN-KEY.
  4096     MOVE 'A'                    TO  PI-ERR-CODE.
  4097     MOVE TOTABLEI               TO  PI-ERR-TABLE.
  4098
  4099
  4100* EXEC CICS HANDLE CONDITION
  4101*        NOTOPEN  (9990-ABEND)
  4102*        NOTFND   (4550-COPY-REC)
  4103*    END-EXEC.
  4104*    MOVE '"$JI                  ! $ #00003941' TO DFHEIV0
  4105     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  4106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4107     MOVE X'2420233030303033393431' TO DFHEIV0(25:11)
  4108     CALL 'kxdfhei1' USING DFHEIV0
  4109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4110
  4111
  4112     PERFORM 7650-READ-ERREIN THRU 7650-EXIT.
  4113
  4114     MOVE -1                     TO  TOTABLEL.
  4115     MOVE AL-UABON               TO  TOTABLEA.
  4116     MOVE ER-2139                TO  EMI-ERROR.
  4117     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4118
  4119     GO TO 8200-SEND-DATAONLY.
  4120
  4121 4550-COPY-REC.
  4122
  4123* EXEC CICS HANDLE CONDITION
  4124*        NOTFND (8880-NOT-FOUND)
  4125*    END-EXEC.
  4126*    MOVE '"$I                   ! % #00003956' TO DFHEIV0
  4127     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4128     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4129     MOVE X'2520233030303033393536' TO DFHEIV0(25:11)
  4130     CALL 'kxdfhei1' USING DFHEIV0
  4131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4132
  4133
  4134     MOVE TABLEI                 TO  PI-ERR-TABLE.
  4135
  4136     PERFORM 7650-READ-ERREIN THRU 7650-EXIT.
  4137
  4138     MOVE TOTABLEI               TO  PI-ERR-TABLE
  4139                                     RE-TABLE.
  4140
  4141     MOVE PI-PROCESSOR-ID        TO  RE-LAST-MAINT-USER.
  4142     MOVE EIBTIME                TO  RE-LAST-MAINT-HHMMSS.
  4143     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4144
  4145     MOVE '5'                    TO  DC-OPTION-CODE.
  4146     MOVE LINK-ELDATCV           TO  PGM-NAME.
  4147
  4148
  4149* EXEC CICS LINK
  4150*        PROGRAM   (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL651.cbl
  4151*        COMMAREA  (DATE-CONVERSION-DATA)
  4152*        LENGTH    (DC-COMM-LENGTH)
  4153*    END-EXEC.
  4154*    MOVE '."C                   ''   #00003974' TO DFHEIV0
  4155     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4156     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4157     MOVE X'2020233030303033393734' TO DFHEIV0(25:11)
  4158     CALL 'kxdfhei1' USING DFHEIV0,
  4159           PGM-NAME,
  4160           DATE-CONVERSION-DATA,
  4161           DC-COMM-LENGTH,
  4162           DFHEIV99,
  4163           DFHEIV99,
  4164           DFHEIV99
  4165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4166
  4167
  4168     MOVE DC-BIN-DATE-1           TO  RE-LAST-MAINT-DT
  4169                                      BIN-CURRENT-SAVE.
  4170     MOVE PI-COMPANY-CD           TO  RE-COMPANY-CD.
  4171*    MOVE 'RE'                    TO  RE-RECORD-ID.
  4172*    MOVE REIN-FILE-ID            TO  FILE-ID.
  4173*    MOVE 'A'                     TO  JP-RECORD-TYPE.
  4174*    MOVE ERREIN-LENGTH           TO  FILE-LENGTH.
  4175*    MOVE REINSURANCE-RECORD      TO  JP-RECORD-AREA.
  4176
  4177
  4178* EXEC CICS WRITE
  4179*        DATASET (REIN-FILE-ID)
  4180*        FROM    (REINSURANCE-RECORD)
  4181*        RIDFLD  (RE-CONTROL-PRIMARY)
  4182*    END-EXEC.
  4183     MOVE LENGTH OF
  4184      REINSURANCE-RECORD
  4185       TO DFHEIV11
  4186*    MOVE '&$ L                  ''   #00003989' TO DFHEIV0
  4187     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4188     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4189     MOVE X'2020233030303033393839' TO DFHEIV0(25:11)
  4190     CALL 'kxdfhei1' USING DFHEIV0,
  4191           REIN-FILE-ID,
  4192           REINSURANCE-RECORD,
  4193           DFHEIV11,
  4194           RE-CONTROL-PRIMARY,
  4195           DFHEIV99,
  4196           DFHEIV99
  4197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4198
  4199
  4200*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4201     PERFORM 8000-UPDATE-MAINT-DATE THRU 8000-EXIT.
  4202     MOVE ER-0000                TO  EMI-ERROR.
  4203     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4204
  4205     MOVE LOW-VALUES             TO  EL651AO.
  4206
  4207     MOVE PI-ERR-TABLE           TO  TABLEO.
  4208     MOVE AL-UANON               TO  TABLEA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL651.cbl
  4209
  4210     GO TO 8100-SEND-INITIAL-MAP.
  4211
  4212 4500-EXIT.
  4213     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL651.cbl
  4215
  4216 4600-DELETE-LEVEL.
  4217     IF PI-ERREIN-KEY = PI-SAVE-ERREIN-KEY
  4218         NEXT SENTENCE
  4219     ELSE
  4220         MOVE ER-2056            TO  EMI-ERROR
  4221         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4222         MOVE -1                 TO  MAINTYPL
  4223         GO TO 8200-SEND-DATAONLY.
  4224
  4225     IF (PI-SUB  =  +1 AND PI-LAST-LEVEL = +1) OR
  4226         EIBAID = DFHPF10
  4227             GO TO 4800-DELETE.
  4228
  4229     PERFORM 7750-READ-ERREIN-UPDATE THRU 7750-EXIT.
  4230
  4231     MOVE REINSURANCE-RECORD     TO  JP-RECORD-AREA.
  4232
  4233 4625-ZERO-RECORD.
  4234     IF RE-REI-COMP (PI-SUB) NOT = SPACES
  4235         IF PI-SUB NOT = +30
  4236             MOVE PI-SUB         TO  SUB1
  4237             ADD +1              TO  SUB1
  4238             MOVE RE-COMP-INFO (SUB1)
  4239                                 TO  RE-COMP-INFO (PI-SUB)
  4240             ADD +1              TO  PI-SUB
  4241             GO TO 4625-ZERO-RECORD.
  4242
  4243     IF RE-REI-COMP (PI-SUB) = SPACES
  4244         GO TO 4650-CONT.
  4245
  4246     MOVE SPACES                 TO  RE-COMP-INFO (30).
  4247     MOVE ZEROS                  TO  RE-LFAGE-LO (30)
  4248                                     RE-AHAGE-LO (30)
  4249                                     RE-LFTRM-LO (30)
  4250                                     RE-AHTRM-LO (30)
  4251                                     RE-LF-PCT (30)
  4252                                     RE-AH-PCT (30)
  4253                                     RE-LF-LIM-LO (30)
  4254                                     RE-LF-LO (30)
  4255                                     RE-AHBEN-LIM-LO (30)
  4256                                     RE-AHBEN-LO (30)
  4257                                     RE-AHMOA-LIM-LO (30)
  4258                                     RE-AHMOA-LO (30)
  4259                                     RE-LO-DATE (30).
  4260
  4261      MOVE ALL '9'               TO  RE-LFAGE-HI (30)
  4262                                     RE-AHAGE-HI (30)
  4263                                     RE-LFTRM-HI (30)
  4264                                     RE-AHTRM-HI (30)
  4265                                     RE-HI-DATE (30).
  4266
  4267     MOVE NINES                  TO  RE-LF-LIM-HI (30)
  4268                                     RE-LF-HI (30)
  4269                                     RE-AHBEN-LIM-HI (30)
  4270                                     RE-AHBEN-HI (30)
  4271                                     RE-AHMOA-LIM-HI (30)
  4272                                     RE-AHMOA-HI (30).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL651.cbl
  4273
  4274 4650-CONT.
  4275     MOVE PI-PROCESSOR-ID        TO  RE-LAST-MAINT-USER.
  4276     MOVE EIBTIME                TO  RE-LAST-MAINT-HHMMSS.
  4277     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4278     MOVE '5'                    TO  DC-OPTION-CODE.
  4279     MOVE LINK-ELDATCV           TO  PGM-NAME.
  4280
  4281
  4282* EXEC CICS LINK
  4283*        PROGRAM   (PGM-NAME)
  4284*        COMMAREA  (DATE-CONVERSION-DATA)
  4285*        LENGTH    (DC-COMM-LENGTH)
  4286*    END-EXEC.
  4287*    MOVE '."C                   ''   #00004076' TO DFHEIV0
  4288     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4289     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4290     MOVE X'2020233030303034303736' TO DFHEIV0(25:11)
  4291     CALL 'kxdfhei1' USING DFHEIV0,
  4292           PGM-NAME,
  4293           DATE-CONVERSION-DATA,
  4294           DC-COMM-LENGTH,
  4295           DFHEIV99,
  4296           DFHEIV99,
  4297           DFHEIV99
  4298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4299
  4300
  4301     MOVE DC-BIN-DATE-1          TO  RE-LAST-MAINT-DT
  4302                                     BIN-CURRENT-SAVE.
  4303*    MOVE REIN-FILE-ID           TO  FILE-ID.
  4304*    MOVE 'B'                    TO  JP-RECORD-TYPE.
  4305*    MOVE ERREIN-LENGTH          TO  FILE-LENGTH.
  4306*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4307*    MOVE REINSURANCE-RECORD     TO  JP-RECORD-AREA.
  4308
  4309
  4310* EXEC CICS REWRITE
  4311*        DATASET  (REIN-FILE-ID)
  4312*        FROM     (REINSURANCE-RECORD)
  4313*    END-EXEC.
  4314     MOVE LENGTH OF
  4315      REINSURANCE-RECORD
  4316       TO DFHEIV11
  4317*    MOVE '&& L                  %   #00004090' TO DFHEIV0
  4318     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4319     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4320     MOVE X'2020233030303034303930' TO DFHEIV0(25:11)
  4321     CALL 'kxdfhei1' USING DFHEIV0,
  4322           REIN-FILE-ID,
  4323           REINSURANCE-RECORD,
  4324           DFHEIV11,
  4325           DFHEIV99
  4326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4327
  4328
  4329*    MOVE 'C'                    TO  JP-RECORD-TYPE
  4330*    MOVE ERREIN-LENGTH          TO  FILE-LENGTH
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL651.cbl
  4331*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4332     PERFORM 8000-UPDATE-MAINT-DATE THRU 8000-EXIT.
  4333     MOVE ER-0000                TO  EMI-ERROR.
  4334     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4335
  4336     MOVE +1                     TO  PI-SUB.
  4337
  4338     GO TO 5000-BUILD-INITIAL-SCREEN.
  4339
  4340 4600-EXIT.
  4341     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL651.cbl
  4343 4800-DELETE.
  4344     IF PI-ERREIN-KEY = PI-SAVE-ERREIN-KEY
  4345         NEXT SENTENCE
  4346     ELSE
  4347         MOVE ER-2056            TO  EMI-ERROR
  4348         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4349         MOVE -1                 TO  MAINTYPL
  4350         GO TO 8200-SEND-DATAONLY.
  4351
  4352     PERFORM 7750-READ-ERREIN-UPDATE THRU 7750-EXIT.
  4353
  4354*    MOVE REINSURANCE-RECORD     TO  JP-RECORD-AREA.
  4355
  4356     IF RE-LAST-MAINT-USER = PI-UPDATE-BY OR
  4357        RE-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS
  4358         NEXT SENTENCE
  4359     ELSE
  4360
  4361* EXEC CICS UNLOCK
  4362*             DATASET  (REIN-FILE-ID)
  4363*        END-EXEC
  4364*    MOVE '&*                    #   #00004126' TO DFHEIV0
  4365     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4366     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4367     MOVE X'2020233030303034313236' TO DFHEIV0(25:11)
  4368     CALL 'kxdfhei1' USING DFHEIV0,
  4369           REIN-FILE-ID,
  4370           DFHEIV99
  4371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4372         MOVE ER-0068            TO  EMI-ERROR
  4373         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4374         GO TO 8200-SEND-DATAONLY.
  4375
  4376
  4377* EXEC CICS DELETE
  4378*        DATASET  (REIN-FILE-ID)
  4379*    END-EXEC.
  4380*    MOVE '&(                    &   #00004133' TO DFHEIV0
  4381     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4382     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4383     MOVE X'2020233030303034313333' TO DFHEIV0(25:11)
  4384     CALL 'kxdfhei1' USING DFHEIV0,
  4385           REIN-FILE-ID,
  4386           DFHEIV99,
  4387           DFHEIV99,
  4388           DFHEIV99,
  4389           DFHEIV99
  4390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4391
  4392
  4393*    MOVE REIN-FILE-ID           TO  FILE-ID.
  4394*    MOVE ERREIN-LENGTH          TO  FILE-LENGTH.
  4395*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4396
  4397     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4398     MOVE '5'                    TO  DC-OPTION-CODE.
  4399     MOVE LINK-ELDATCV           TO  PGM-NAME.
  4400
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL651.cbl
  4401
  4402* EXEC CICS LINK
  4403*        PROGRAM   (PGM-NAME)
  4404*        COMMAREA  (DATE-CONVERSION-DATA)
  4405*        LENGTH    (DC-COMM-LENGTH)
  4406*    END-EXEC.
  4407*    MOVE '."C                   ''   #00004145' TO DFHEIV0
  4408     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4409     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4410     MOVE X'2020233030303034313435' TO DFHEIV0(25:11)
  4411     CALL 'kxdfhei1' USING DFHEIV0,
  4412           PGM-NAME,
  4413           DATE-CONVERSION-DATA,
  4414           DC-COMM-LENGTH,
  4415           DFHEIV99,
  4416           DFHEIV99,
  4417           DFHEIV99
  4418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4419
  4420
  4421     MOVE DC-BIN-DATE-1          TO  BIN-CURRENT-SAVE.
  4422     PERFORM 8000-UPDATE-MAINT-DATE THRU 8000-EXIT.
  4423
  4424     MOVE ER-0000                TO  EMI-ERROR.
  4425     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4426
  4427     MOVE LOW-VALUES             TO  EL651AO.
  4428
  4429     MOVE PI-ERR-TABLE           TO  TABLEO.
  4430     MOVE AL-UANON               TO  TABLEA.
  4431
  4432     GO TO 8100-SEND-INITIAL-MAP.
  4433
  4434 4800-EXIT.
  4435     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL651.cbl
  4437
  4438 5000-BUILD-INITIAL-SCREEN.
  4439     MOVE LOW-VALUES             TO  EL651AO.
  4440     MOVE ZEROS                  TO  MISC-SAVE-AREAS.
  4441     MOVE PI-COMPANY-CD          TO  PI-ERR-COMPANY-CD.
  4442     MOVE 'A'                    TO  PI-ERR-CODE.
  4443
  4444     PERFORM 7650-READ-ERREIN THRU 7650-EXIT.
  4445
  4446******************************************************************
  4447*    ADD CODE TO SHOW RECORDS WHICH HAVE A MATCHING CARRIER IF   *
  4448*    USER HAS CARRIER SECURITY.                                  *
  4449******************************************************************
  4450
  4451     IF PI-CARRIER-SECURITY GREATER SPACE
  4452         IF PI-CARRIER-SECURITY = RE-TABLE-CARRIER-SECURITY
  4453             NEXT SENTENCE
  4454         ELSE
  4455             GO TO 8880-NOT-FOUND.
  4456
  4457     MOVE RE-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  4458     MOVE RE-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
  4459     MOVE PI-ERREIN-KEY          TO  PI-SAVE-ERREIN-KEY.
  4460     MOVE ZEROS                  TO  PI-LAST-LEVEL.
  4461
  4462     IF CHANGES-NOT-MADE
  4463         MOVE +1                 TO  PI-SUB.
  4464
  4465     IF RE-100-COMP = ZERO
  4466         MOVE SPACE              TO  PI-EXCESS-SW
  4467     ELSE
  4468         MOVE 'X'                TO  PI-EXCESS-SW.
  4469
  4470 5050-SET-UP-SCREEN.
  4471     IF PI-SUB NOT NUMERIC
  4472         MOVE +1                 TO  PI-SUB.
  4473
  4474     MOVE PI-SUB                 TO  WS-CHECK-LEVEL
  4475
  4476     IF VALID-LEVEL
  4477        IF RE-REI-COMP (PI-SUB) = SPACES
  4478           MOVE +1               TO  PI-SUB
  4479           MOVE ER-2338          TO  EMI-ERROR
  4480           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4481        ELSE
  4482           NEXT SENTENCE
  4483     ELSE
  4484        MOVE +1                  TO  PI-SUB
  4485        MOVE ER-2338             TO  EMI-ERROR
  4486        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4487
  4488     IF RE-AH-PCT (PI-SUB) NOT NUMERIC
  4489        GO TO 5070-SEARCH-LAST-LEVEL.
  4490
  4491     IF RE-AH-PCT (PI-SUB) = ZEROS
  4492         NEXT SENTENCE
  4493     ELSE
  4494         MOVE RE-AH-PCT (PI-SUB) TO  AHBENO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL651.cbl
  4495         MOVE AL-UNNON           TO  AHBENA.
  4496
  4497     IF RE-LF-PCT (PI-SUB) = ZEROS
  4498         NEXT SENTENCE
  4499     ELSE
  4500         MOVE RE-LF-PCT (PI-SUB)     TO  LFBENO
  4501         MOVE AL-UNNON               TO  LFBENA.
  4502
  4503     IF RE-LO-DATE (PI-SUB) = ZEROS
  4504         MOVE WS-LOW-DATE            TO  FDATEO
  4505         MOVE AL-UNNON               TO  FDATEA
  4506     ELSE
  4507         MOVE RE-LO-DATE (PI-SUB)    TO  DC-GREG-DATE-1-YMD
  4508                                         WS-LO-DATE
  4509         MOVE '3'                    TO  DC-OPTION-CODE
  4510         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  4511         MOVE DC-GREG-DATE-1-EDIT    TO  FDATEO
  4512         MOVE AL-UNNON               TO  FDATEA.
  4513
  4514***  Y2K PROJ 7744
  4515     MOVE RE-HI-DATE(PI-SUB)         TO WS-HOLD-PIC98.
  4516
  4517     IF WS-HOLD-PIC98 = 99999999
  4518         MOVE WS-HIGH-DATE           TO  TDATEO
  4519         MOVE AL-UNNON               TO  TDATEA
  4520     ELSE
  4521         MOVE RE-HI-DATE (PI-SUB)    TO  DC-GREG-DATE-1-YMD
  4522                                         WS-HI-DATE
  4523         MOVE '3'                    TO  DC-OPTION-CODE
  4524         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  4525         MOVE DC-GREG-DATE-1-EDIT    TO  TDATEO
  4526         MOVE AL-UNNON               TO  TDATEA
  4527         MOVE DC-ALPHA-CENTURY       TO  WS-HI-DATE(1:2).
  4528
  4529     MOVE RE-LF-LIM-LO (PI-SUB)         TO  LFLOBENO.
  4530     MOVE RE-LF-LIM-HI (PI-SUB)         TO  LFHIBENO.
  4531     MOVE RE-AHBEN-LIM-LO (PI-SUB)      TO  AHLOBENO.
  4532     MOVE RE-AHBEN-LIM-HI (PI-SUB)      TO  AHHIBENO.
  4533     MOVE RE-AHMOA-LIM-LO (PI-SUB)      TO  AMLOBENO.
  4534     MOVE RE-AHMOA-LIM-HI (PI-SUB)      TO  AMHIBENO.
  4535     MOVE RE-LF-LO (PI-SUB)             TO  LFLOAMTO.
  4536     MOVE RE-LF-HI (PI-SUB)             TO  LFHIAMTO.
  4537     MOVE RE-AHBEN-LO (PI-SUB)          TO  AHLOAMTO.
  4538     MOVE RE-AHBEN-HI (PI-SUB)          TO  AHHIAMTO.
  4539     MOVE RE-AHMOA-LO (PI-SUB)          TO  AMLOAMTO.
  4540     MOVE RE-AHMOA-HI (PI-SUB)          TO  AMHIAMTO.
  4541     MOVE RE-REI-COMP (PI-SUB)          TO  COMPANYO
  4542                                            PI-SAVE-COMPANY.
  4543     MOVE RE-REI-COMP-SUB (PI-SUB)      TO  COMPSUBO
  4544                                            PI-SAVE-COMP-SUB.
  4545     MOVE RE-LFAGE-LO (PI-SUB)          TO  LFLOAGEO.
  4546     MOVE RE-LFAGE-HI (PI-SUB)          TO  LFHIAGEO.
  4547     MOVE RE-LFTRM-LO (PI-SUB)          TO  LFLOTRMO.
  4548     MOVE RE-LFTRM-HI (PI-SUB)          TO  LFHITRMO.
  4549     MOVE RE-LF-BEN-CODE (PI-SUB)       TO  LIFEBENO.
  4550     MOVE RE-AHAGE-LO (PI-SUB)          TO  AHLOAGEO.
  4551     MOVE RE-AHAGE-HI (PI-SUB)          TO  AHHIAGEO.
  4552     MOVE RE-AHTRM-LO (PI-SUB)          TO  AHLOTRMO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL651.cbl
  4553     MOVE RE-AHTRM-HI (PI-SUB)          TO  AHHITRMO.
  4554     MOVE RE-AH-BEN-CODE (PI-SUB)       TO  AHTBENO.
  4555     MOVE RE-LF-QC (PI-SUB)             TO  LFQTEDO.
  4556     MOVE RE-AH-QC (PI-SUB)             TO  AHQTEDO.
  4557     MOVE RE-REMAINING (PI-SUB)         TO  LFREMO.
  4558
  4559     MOVE RE-INTERACTIVE (PI-SUB)       TO  LFINTRO.
  4560     MOVE RE-NSP-ST-CD-LF               TO  LFSTATEO.
  4561     MOVE RE-NSP-ST-CD-AH               TO  AHSTATEO.
  4562     MOVE RE-TABLE-CARRIER-SECURITY     TO  CARRIERO.
  4563
  4564     IF PI-NO-CARRIER-SECURITY
  4565         MOVE AL-UANOF                  TO  CARRIERA
  4566     ELSE
  4567         MOVE AL-SANOF                  TO  CARRIERA.
  4568
  4569     MOVE AL-UANON               TO  AHTBENA     TABLEA
  4570                                     LFREMA      COMPANYA
  4571                                     COMPSUBA    AHQTEDA
  4572                                     LIFEBENA    LFQTEDA
  4573                                     LFINTRA.
  4574
  4575     MOVE AL-UNNON               TO  LFHIBENA    AHLOAMTA
  4576                                     LFHIAMTA    AMLOAMTA
  4577                                     AHHIAMTA    AMLOBENA
  4578                                     AHHIBENA    LFLOAGEA
  4579                                     AMHIBENA    LFHIAGEA
  4580                                     AMHIAMTA    AHLOAGEA
  4581                                     AHLOTRMA    AHHIAGEA
  4582                                     AHHITRMA    LFLOTRMA
  4583                                     LFLOBENA    LFHITRMA
  4584                                     AHLOBENA    LFLOAMTA.
  4585
  4586     MOVE PI-SUB                 TO   PI-LAST-LEVEL
  4587                                      SUB1.
  4588
  4589     MOVE RE-LAST-MAINT-DT       TO  DC-BIN-DATE-1.
  4590     MOVE SPACE                  TO  DC-OPTION-CODE.
  4591     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  4592     MOVE DC-GREG-DATE-1-EDIT    TO  LMDATEO.
  4593
  4594     MOVE RE-LAST-MAINT-USER     TO  LMBYO.
  4595     MOVE RE-LAST-MAINT-HHMMSS   TO  TIME-MT.
  4596     MOVE TIME-LMT               TO  LMTIMEO.
  4597
  4598 5070-SEARCH-LAST-LEVEL.
  4599     ADD +1                      TO  SUB1.
  4600
  4601     IF SUB1 GREATER +30
  4602         NEXT SENTENCE
  4603     ELSE
  4604         IF RE-REI-COMP (SUB1) = SPACES
  4605             NEXT SENTENCE
  4606         ELSE
  4607             MOVE SUB1           TO  PI-LAST-LEVEL
  4608             GO TO 5070-SEARCH-LAST-LEVEL.
  4609
  4610     IF EXCESS-LEVEL-EXISTS AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL651.cbl
  4611        PI-SUB = PI-LAST-LEVEL
  4612           MOVE 'X'              TO  PERCNTO
  4613           MOVE AL-UANON         TO  PERCNTA.
  4614
  4615     MOVE PI-SUB                 TO  LEVELO.
  4616     MOVE PI-LAST-LEVEL          TO  OFLEVELO.
  4617     MOVE PI-ERR-TABLE           TO  TABLEO.
  4618     MOVE AL-SANON               TO  OFLEVELA.
  4619     MOVE AL-UNNOF               TO  LEVELA.
  4620
  4621     MOVE SPACE                  TO  PI-FIRST-TIME-SW.
  4622     GO TO 8100-SEND-INITIAL-MAP.
  4623
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL651.cbl
  4625 6000-CHECK-FOR-UPDATE.
  4626      IF CHANGE-FUNCTION
  4627          GO TO 6010-CONT.
  4628
  4629      IF TABLEL GREATER ZERO
  4630          MOVE TABLEI            TO  RE-TABLE.
  4631
  4632 6010-CONT.
  4633      IF COMPANYL GREATER ZERO
  4634          MOVE COMPANYI          TO  RE-REI-COMP (PI-SUB).
  4635
  4636      IF COMPSUBL GREATER ZERO
  4637          MOVE COMPSUBI          TO  RE-REI-COMP-SUB (PI-SUB).
  4638
  4639      IF FDATEL GREATER ZERO
  4640          MOVE WS-LO-DATE        TO  RE-LO-DATE (PI-SUB).
  4641
  4642      IF TDATEL GREATER ZERO
  4643          MOVE WS-HI-DATE        TO  RE-HI-DATE (PI-SUB).
  4644
  4645      IF PERCNTL GREATER ZERO
  4646          IF PERCNTI = SPACE
  4647              MOVE ZEROS         TO  RE-100-COMP
  4648          ELSE
  4649              MOVE PI-SUB        TO  RE-100-COMP.
  4650
  4651      IF LFLOAGEL GREATER ZERO
  4652          MOVE WS-LFAGE-LO       TO  RE-LFAGE-LO (PI-SUB).
  4653
  4654      IF LFHIAGEL GREATER ZERO
  4655          MOVE WS-LFAGE-HI       TO  RE-LFAGE-HI (PI-SUB).
  4656
  4657      IF AHLOAGEL GREATER ZERO
  4658          MOVE WS-AHAGE-LO       TO  RE-AHAGE-LO (PI-SUB).
  4659
  4660      IF AHHIAGEL GREATER ZERO
  4661          MOVE WS-AHAGE-HI       TO  RE-AHAGE-HI (PI-SUB).
  4662
  4663      IF LFLOTRML GREATER ZERO
  4664          MOVE WS-LFTRM-LO       TO  RE-LFTRM-LO (PI-SUB).
  4665
  4666      IF LFHITRML GREATER ZERO
  4667          MOVE WS-LFTRM-HI       TO  RE-LFTRM-HI (PI-SUB).
  4668
  4669      IF AHLOTRML GREATER ZERO
  4670          MOVE WS-AHTRM-LO       TO  RE-AHTRM-LO (PI-SUB).
  4671
  4672      IF AHHITRML GREATER ZERO
  4673          MOVE WS-AHTRM-HI       TO  RE-AHTRM-HI (PI-SUB).
  4674
  4675      IF LFLOBENL GREATER ZERO
  4676          MOVE WS-LF-LIM-LO      TO  RE-LF-LIM-LO (PI-SUB).
  4677
  4678      IF LFHIBENL GREATER ZERO
  4679          MOVE WS-LF-LIM-HI      TO  RE-LF-LIM-HI (PI-SUB).
  4680
  4681      IF AHLOBENL GREATER ZERO
  4682          MOVE WS-AHBEN-LIM-LO   TO  RE-AHBEN-LIM-LO (PI-SUB).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL651.cbl
  4683
  4684      IF AHHIBENL GREATER ZERO
  4685          MOVE WS-AHBEN-LIM-HI   TO  RE-AHBEN-LIM-HI (PI-SUB).
  4686
  4687      IF AMLOBENL GREATER ZERO
  4688          MOVE WS-AHMOA-LIM-LO   TO  RE-AHMOA-LIM-LO (PI-SUB).
  4689
  4690      IF AMHIBENL GREATER ZERO
  4691          MOVE WS-AHMOA-LIM-HI   TO  RE-AHMOA-LIM-HI (PI-SUB).
  4692
  4693      IF LFLOAMTL GREATER ZERO
  4694          MOVE WS-LF-LO          TO  RE-LF-LO (PI-SUB).
  4695
  4696      IF LFHIAMTL GREATER ZERO
  4697          MOVE WS-LF-HI          TO  RE-LF-HI (PI-SUB).
  4698
  4699      IF AHLOAMTL GREATER ZERO
  4700          MOVE WS-AHBEN-LO       TO  RE-AHBEN-LO (PI-SUB).
  4701
  4702      IF AHHIAMTL GREATER ZERO
  4703          MOVE WS-AHBEN-HI       TO  RE-AHBEN-HI (PI-SUB).
  4704
  4705      IF AMLOAMTL GREATER ZERO
  4706          MOVE WS-AHMOA-LO       TO  RE-AHMOA-LO (PI-SUB).
  4707
  4708      IF AMHIAMTL GREATER ZERO
  4709          MOVE WS-AHMOA-HI       TO  RE-AHMOA-HI (PI-SUB).
  4710
  4711      IF LIFEBENL GREATER ZERO
  4712          MOVE LIFEBENI          TO  RE-LF-BEN-CODE (PI-SUB).
  4713
  4714      IF LFSTATEL GREATER ZERO
  4715          MOVE LFSTATEI          TO  RE-NSP-ST-CD-LF
  4716          MOVE ER-0585           TO  EMI-ERROR
  4717          PERFORM 9900-ERROR-FORMAT
  4718             THRU 9900-EXIT.
  4719
  4720      IF AHSTATEL GREATER ZERO
  4721          MOVE AHSTATEI          TO  RE-NSP-ST-CD-AH
  4722          MOVE ER-0585           TO  EMI-ERROR
  4723          PERFORM 9900-ERROR-FORMAT
  4724             THRU 9900-EXIT.
  4725
  4726      IF AHTBENL GREATER ZERO
  4727          MOVE AHTBENI           TO  RE-AH-BEN-CODE (PI-SUB).
  4728
  4729      IF LFBENL GREATER ZERO
  4730          MOVE LFBENI            TO  RE-LF-PCT (PI-SUB)
  4731      ELSE
  4732          MOVE ZEROS             TO  RE-LF-PCT (PI-SUB).
  4733
  4734      IF AHBENL GREATER ZERO
  4735          MOVE AHBENI            TO  RE-AH-PCT (PI-SUB)
  4736      ELSE
  4737          MOVE ZEROS             TO  RE-AH-PCT (PI-SUB).
  4738
  4739      IF LFBENL GREATER ZERO AND
  4740         AHBENL GREATER ZERO AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL651.cbl
  4741         AHBENI = ZEROS      AND
  4742         LFBENI = ZEROS
  4743          MOVE ER-0593           TO  EMI-ERROR
  4744          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4745
  4746      IF LFINTRL GREATER ZERO
  4747          MOVE LFINTRI           TO  RE-INTERACTIVE (PI-SUB).
  4748
  4749      IF LFQTEDL GREATER ZERO
  4750          MOVE LFQTEDI           TO  RE-LF-QC (PI-SUB).
  4751
  4752      IF AHQTEDL GREATER ZERO
  4753          MOVE AHQTEDI           TO  RE-AH-QC (PI-SUB).
  4754
  4755      IF LFREML GREATER ZERO
  4756          MOVE LFREMI            TO  RE-REMAINING (PI-SUB).
  4757
  4758      IF CARRIERL GREATER ZERO
  4759          MOVE CARRIERI          TO  RE-TABLE-CARRIER-SECURITY.
  4760
  4761      MOVE 'A'                   TO  RE-CODE.
  4762
  4763 6099-EXIT.
  4764     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL651.cbl
  4766
  4767 7000-EDIT.
  4768     IF COMPSUBL = ZERO
  4769         MOVE AL-UANON           TO  COMPSUBA
  4770         MOVE SPACES             TO  COMPSUBI.
  4771
  4772     IF COMPANYL GREATER ZERO
  4773         MOVE ZERO TO TALLY
  4774         INSPECT COMPANYI TALLYING TALLY FOR ALL SPACES
  4775         IF TALLY GREATER ZERO
  4776             MOVE -1             TO  COMPANYL
  4777             MOVE AL-UABON       TO  COMPANYA
  4778             MOVE ER-2340        TO  EMI-ERROR
  4779             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4780         ELSE
  4781             PERFORM 7400-SEARCH-FOR-COMPANY THRU 7499-EXIT
  4782             MOVE AL-UANON       TO  COMPANYA
  4783     ELSE
  4784         IF ADD-FUNCTION
  4785             MOVE -1             TO  COMPANYL
  4786             MOVE AL-UABON       TO  COMPANYA
  4787             MOVE ER-2311        TO  EMI-ERROR
  4788             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4789
  4790     IF PERCNTL GREATER ZERO
  4791         MOVE PERCNTI            TO  WS-CHECK-PERCENT
  4792         IF EXCESS-LEVEL
  4793             IF EXCESS-LEVEL-EXISTS
  4794                 IF PI-LAST-LEVEL = PI-SUB
  4795                     MOVE AL-UANON   TO  PERCNTA
  4796                 ELSE
  4797                     MOVE -1         TO  PERCNTL
  4798                     MOVE AL-UABON   TO  PERCNTA
  4799                     MOVE ER-2347    TO  EMI-ERROR
  4800                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4801             ELSE
  4802                 IF PI-LAST-LEVEL = PI-SUB
  4803                     MOVE AL-UANON   TO  PERCNTA
  4804                 ELSE
  4805                     MOVE -1         TO  PERCNTL
  4806                     MOVE AL-UABON   TO  PERCNTA
  4807                     MOVE ER-2348    TO  EMI-ERROR
  4808                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4809         ELSE
  4810             IF NO-LEVEL
  4811                 MOVE AL-UANON       TO  PERCNTA
  4812             ELSE
  4813                 MOVE -1             TO  PERCNTL
  4814                 MOVE AL-UABON       TO  PERCNTA
  4815                 MOVE ER-2316        TO  EMI-ERROR
  4816                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4817     ELSE
  4818         MOVE AL-UANON           TO  PERCNTA
  4819         MOVE SPACE              TO  PERCNTO.
  4820
  4821     IF PI-CARRIER-SECURITY GREATER SPACE
  4822         MOVE PI-CARRIER-SECURITY    TO  CARRIERI
  4823         MOVE AL-SANON               TO  CARRIERA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL651.cbl
  4824
  4825     IF CARRIERL GREATER ZERO
  4826         MOVE CARRIERI           TO  WS-CARRIER
  4827         PERFORM 7550-CHECK-CARRIER THRU 7550-EXIT
  4828         IF CARRIER-FOUND
  4829             MOVE AL-UANON       TO  CARRIERA
  4830         ELSE
  4831             IF CARRIERI = SPACES
  4832                 MOVE AL-UANON   TO  CARRIERA
  4833             ELSE
  4834                 MOVE -1         TO  CARRIERL
  4835                 MOVE AL-UABON   TO  CARRIERA
  4836                 MOVE ER-2208    TO  EMI-ERROR
  4837                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4838
  4839     MOVE ZEROS                  TO  DATE-TEST-AREA.
  4840
  4841***  Y2K PROJ 7744
  4842     IF FDATEL GREATER ZERO
  4843         MOVE FDATEI             TO  DEEDIT-FIELD
  4844         PERFORM 7500-DEEDIT THRU 7500-EXIT
  4845         IF DEEDIT-FIELD-V0 GREATER ZERO
  4846             MOVE DEEDIT-FIELD-V0    TO  DC-GREG-DATE-1-MDY
  4847             MOVE '4'                TO  DC-OPTION-CODE
  4848             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  4849             IF NO-CONVERSION-ERROR
  4850                 MOVE AL-UANON       TO  FDATEA
  4851                 MOVE DC-GREG-DATE-1-YMD   TO  DATE-TEST-AREA
  4852                                               WS-LO-DATE
  4853                 MOVE DC-ALPHA-CENTURY     TO  DATE-TEST-AREA(1:2)
  4854                                               WS-LO-DATE(1:2)
  4855                 MOVE DC-GREG-DATE-1-EDIT  TO FDATEO
  4856             ELSE
  4857                 MOVE -1         TO  FDATEL
  4858                 MOVE AL-UABON   TO  FDATEA
  4859                 MOVE ER-2312    TO  EMI-ERROR
  4860                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4861             END-IF
  4862         ELSE
  4863             MOVE WS-LOW-DATE    TO  FDATEO
  4864             MOVE ZEROS          TO  WS-LO-DATE
  4865             MOVE AL-UANON       TO  FDATEA
  4866         END-IF
  4867     ELSE
  4868         IF ADD-FUNCTION
  4869             MOVE WS-LOW-DATE    TO  FDATEO
  4870             MOVE ZEROS          TO  WS-LO-DATE
  4871             MOVE AL-UANON       TO  FDATEA
  4872         END-IF
  4873     END-IF.
  4874
  4875     IF TDATEL GREATER ZERO
  4876         MOVE TDATEI             TO  DEEDIT-FIELD
  4877         PERFORM 7500-DEEDIT THRU 7500-EXIT
  4878         IF DEEDIT-FIELD-V0 = 999999
  4879             MOVE WS-HIGH-DATE   TO  TDATEO
  4880             MOVE 99999999       TO  WS-HI-DATE
  4881             MOVE AL-UANON       TO  TDATEA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL651.cbl
  4882         ELSE
  4883             MOVE DEEDIT-FIELD-V0    TO  DC-GREG-DATE-1-MDY
  4884             MOVE '4'                TO  DC-OPTION-CODE
  4885             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  4886             IF NO-CONVERSION-ERROR
  4887                 MOVE DC-GREG-DATE-1-YMD TO WS-HOLD-PIC98-2
  4888                 MOVE DC-ALPHA-CENTURY   TO WS-HOLD-PIC98-2(1:2)
  4889                 IF WS-HOLD-PIC98-2 > DATE-TEST-AREA
  4890                     MOVE AL-UANON            TO  TDATEA
  4891                     MOVE DC-GREG-DATE-1-EDIT TO  TDATEO
  4892                     MOVE DC-GREG-DATE-1-YMD  TO  WS-HI-DATE
  4893                     MOVE DC-ALPHA-CENTURY    TO  WS-HI-DATE(1:2)
  4894                 ELSE
  4895                     MOVE -1         TO  TDATEL
  4896                     MOVE AL-UABON   TO  TDATEA
  4897                     MOVE ER-2339    TO  EMI-ERROR
  4898                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4899                 END-IF
  4900             ELSE
  4901                 MOVE -1         TO  TDATEL
  4902                 MOVE AL-UABON   TO  TDATEA
  4903                 MOVE ER-2313    TO  EMI-ERROR
  4904                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4905             END-IF
  4906         END-IF
  4907     ELSE
  4908         IF ADD-FUNCTION
  4909             MOVE WS-HIGH-DATE   TO  TDATEO
  4910             MOVE 99999999       TO  WS-HI-DATE
  4911             MOVE AL-UANON       TO  TDATEA
  4912         END-IF
  4913     END-IF.
  4914***  Y2K PROJ 7744
  4915
  4916     MOVE ZEROS                  TO  WS-PREV-AGE
  4917                                     WS-PREV-TRM
  4918                                     WS-PREV-AMT.
  4919
  4920     IF LFLOAGEL GREATER ZERO
  4921         IF LFLOAGEI NUMERIC
  4922             MOVE AL-UANON       TO  LFLOAGEA
  4923             MOVE LFLOAGEI       TO  WS-PREV-AGE
  4924                                     WS-LFAGE-LO
  4925         ELSE
  4926             MOVE -1             TO  LFLOAGEL
  4927             MOVE AL-UNBON       TO  LFLOAGEA
  4928             MOVE ER-2317        TO  EMI-ERROR
  4929             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4930     ELSE
  4931         IF ADD-FUNCTION
  4932             MOVE ZEROS          TO  LFLOAGEO
  4933                                     WS-LFAGE-LO
  4934             MOVE AL-UNNON       TO  LFLOAGEA.
  4935
  4936     IF LFHIAGEL GREATER ZERO
  4937         IF LFHIAGEI NUMERIC
  4938             IF LFHIAGEI LESS WS-PREV-AGE
  4939                 MOVE -1         TO  LFHIAGEL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL651.cbl
  4940                 MOVE AL-UNBON   TO  LFHIAGEA
  4941                 MOVE ER-2318    TO  EMI-ERROR
  4942                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4943             ELSE
  4944                 MOVE AL-UNNON   TO  LFHIAGEA
  4945                 MOVE LFHIAGEI   TO  WS-LFAGE-HI
  4946         ELSE
  4947             MOVE -1             TO  LFHIAGEL
  4948             MOVE AL-UNBON       TO  LFHIAGEA
  4949             MOVE ER-2319        TO  EMI-ERROR
  4950             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4951     ELSE
  4952         IF ADD-FUNCTION
  4953             MOVE 99             TO  LFHIAGEO
  4954                                     WS-LFAGE-HI
  4955             MOVE AL-UNNON       TO  LFHIAGEA.
  4956
  4957     IF LFLOTRML GREATER ZERO
  4958         IF LFLOTRMI NUMERIC
  4959             MOVE AL-UNNON       TO  LFLOTRMA
  4960             MOVE LFLOTRMI       TO  WS-PREV-TRM
  4961                                     WS-LFTRM-LO
  4962         ELSE
  4963             MOVE -1             TO  LFLOTRML
  4964             MOVE AL-UNBON       TO  LFLOTRMA
  4965             MOVE ER-2320        TO  EMI-ERROR
  4966             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4967     ELSE
  4968         IF ADD-FUNCTION
  4969             MOVE ZEROS          TO  LFLOTRMO
  4970                                     WS-LFTRM-LO
  4971             MOVE AL-UNNON       TO  LFLOTRMA.
  4972
  4973     IF LFHITRML GREATER ZERO
  4974         IF LFHITRMI NUMERIC
  4975             IF LFHITRMI LESS WS-PREV-TRM
  4976                 MOVE -1         TO  LFHITRML
  4977                 MOVE AL-UABON   TO  LFHITRMA
  4978                 MOVE ER-2321    TO  EMI-ERROR
  4979                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4980             ELSE
  4981                 MOVE AL-UNNON   TO  LFHITRMA
  4982                 MOVE LFHITRMI   TO  WS-LFTRM-HI
  4983         ELSE
  4984             MOVE -1             TO  LFHITRML
  4985             MOVE AL-UNBON       TO  LFHITRMA
  4986             MOVE ER-2322        TO  EMI-ERROR
  4987             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4988     ELSE
  4989         IF ADD-FUNCTION
  4990             MOVE 999            TO  LFHITRMO
  4991                                     WS-LFTRM-HI
  4992             MOVE AL-UNNON       TO  LFHITRMA.
  4993
  4994     IF LFLOBENL GREATER ZERO
  4995         MOVE LFLOBENI           TO  DEEDIT-FIELD
  4996         PERFORM 7500-DEEDIT THRU 7500-EXIT
  4997         IF DEEDIT-FIELD-V0 NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL651.cbl
  4998             MOVE DEEDIT-FIELD-V1    TO  WS-PREV-AMT
  4999                                         LFLOBENO
  5000                                         WS-LF-LIM-LO
  5001             MOVE AL-UNNON           TO  LFLOBENA
  5002         ELSE
  5003             MOVE -1             TO  LFLOBENL
  5004             MOVE AL-UNBON       TO  LFLOBENA
  5005             MOVE ER-2323        TO  EMI-ERROR
  5006             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5007     ELSE
  5008         IF ADD-FUNCTION
  5009             MOVE ZEROS          TO  LFLOBENO
  5010                                     WS-LF-LIM-LO
  5011             MOVE AL-UNNON       TO  LFLOBENA.
  5012
  5013     IF LFHIBENL GREATER ZERO
  5014         MOVE LFHIBENI           TO  DEEDIT-FIELD
  5015         PERFORM 7500-DEEDIT THRU 7500-EXIT
  5016         IF DEEDIT-FIELD-V0 NUMERIC
  5017             IF DEEDIT-FIELD-V1 LESS WS-PREV-AMT
  5018                 MOVE -1         TO  LFHIBENL
  5019                 MOVE AL-UNBON   TO  LFHIBENA
  5020                 MOVE ER-2324    TO  EMI-ERROR
  5021                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5022             ELSE
  5023                 MOVE AL-UNNON   TO  LFHIBENA
  5024                 MOVE DEEDIT-FIELD-V1    TO  LFHIBENO
  5025                                             WS-LF-LIM-HI
  5026         ELSE
  5027             MOVE -1             TO  LFHIBENL
  5028             MOVE AL-UNBON       TO  LFHIBENA
  5029             MOVE ER-2325        TO  EMI-ERROR
  5030             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5031     ELSE
  5032         IF ADD-FUNCTION
  5033             MOVE NINES          TO  LFHIBENO
  5034                                     WS-LF-LIM-HI
  5035             MOVE AL-UNNON       TO  LFHIBENA.
  5036
  5037     MOVE ZEROS                  TO  WS-PREV-AGE
  5038                                     WS-PREV-TRM
  5039                                     WS-PREV-AMT.
  5040
  5041     IF AHLOAGEL GREATER ZERO
  5042         IF AHLOAGEI NUMERIC
  5043             MOVE AL-UNNON       TO  AHLOAGEA
  5044             MOVE AHLOAGEI       TO  WS-PREV-AGE
  5045                                     WS-AHAGE-LO
  5046         ELSE
  5047             MOVE -1             TO  AHLOAGEL
  5048             MOVE AL-UNBON       TO  AHLOAGEA
  5049             MOVE ER-2317        TO  EMI-ERROR
  5050             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5051     ELSE
  5052         IF ADD-FUNCTION
  5053             MOVE ZEROS          TO  AHLOAGEO
  5054                                     WS-AHAGE-LO
  5055             MOVE AL-UNNON       TO  AHLOAGEA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL651.cbl
  5056
  5057     IF AHHIAGEL GREATER ZERO
  5058         IF AHHIAGEI NUMERIC
  5059             IF AHHIAGEI LESS WS-PREV-AGE
  5060                 MOVE -1         TO  AHHIAGEL
  5061                 MOVE AL-UNBON   TO  AHHIAGEA
  5062                 MOVE ER-2318    TO  EMI-ERROR
  5063                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5064             ELSE
  5065                 MOVE AL-UNNON   TO  AHHIAGEA
  5066                 MOVE AHHIAGEI   TO  WS-AHAGE-HI
  5067         ELSE
  5068             MOVE -1             TO  AHHIAGEL
  5069             MOVE AL-UNBON       TO  AHHIAGEA
  5070             MOVE ER-2319        TO  EMI-ERROR
  5071             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5072     ELSE
  5073         IF ADD-FUNCTION
  5074             MOVE 99             TO  AHHIAGEO
  5075                                     WS-AHAGE-HI
  5076             MOVE AL-UNNON       TO  AHHIAGEA.
  5077
  5078     IF AHLOTRML GREATER ZERO
  5079         IF AHLOTRMI NUMERIC
  5080             MOVE AL-UNNON       TO  AHLOTRMA
  5081             MOVE AHLOTRMI       TO  WS-PREV-TRM
  5082                                     WS-AHTRM-LO
  5083         ELSE
  5084             MOVE -1             TO  AHLOTRML
  5085             MOVE AL-UNBON       TO  AHLOTRMA
  5086             MOVE ER-2320        TO  EMI-ERROR
  5087             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5088     ELSE
  5089         IF ADD-FUNCTION
  5090             MOVE ZEROS          TO  AHLOTRMO
  5091                                     WS-AHTRM-LO
  5092             MOVE AL-UNNON       TO  AHLOTRMA.
  5093
  5094     IF AHHITRML GREATER ZERO
  5095         IF AHHITRMI NUMERIC
  5096             IF AHHITRMI LESS WS-PREV-TRM
  5097                 MOVE -1         TO  AHHITRML
  5098                 MOVE AL-UNBON   TO  AHHITRMA
  5099                 MOVE ER-2321    TO  EMI-ERROR
  5100                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5101             ELSE
  5102                 MOVE AL-UNNON   TO  AHHITRMA
  5103                 MOVE AHHITRMI   TO  WS-AHTRM-HI
  5104         ELSE
  5105             MOVE -1             TO  AHHITRML
  5106             MOVE AL-UNBON       TO  AHHITRMA
  5107             MOVE ER-2322        TO  EMI-ERROR
  5108             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5109     ELSE
  5110         IF ADD-FUNCTION
  5111             MOVE 999            TO  AHHITRMO
  5112                                     WS-AHTRM-HI
  5113             MOVE AL-UNNON       TO  AHHITRMA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL651.cbl
  5114
  5115     IF LFBENL GREATER ZERO AND
  5116        LFBENI NUMERIC AND
  5117        LFBENI GREATER +1
  5118        MOVE -1                  TO  LFBENL
  5119        MOVE AL-UNBON            TO  LFBENA
  5120        MOVE ER-2356             TO  EMI-ERROR
  5121        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5122
  5123     IF AHBENL GREATER ZERO AND
  5124        AHBENI NUMERIC AND
  5125        AHBENI GREATER +1
  5126        MOVE -1                  TO  AHBENL
  5127        MOVE AL-UNBON            TO  AHBENA
  5128        MOVE ER-2356             TO  EMI-ERROR
  5129        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5130
  5131     IF AHLOBENL GREATER ZERO
  5132         MOVE AHLOBENI           TO  DEEDIT-FIELD
  5133         PERFORM 7500-DEEDIT THRU 7500-EXIT
  5134         IF DEEDIT-FIELD-V0 NUMERIC
  5135             MOVE AL-UNNON       TO  AHLOBENA
  5136             MOVE DEEDIT-FIELD-V1    TO  WS-PREV-AMT
  5137                                         AHLOBENO
  5138                                         WS-AHBEN-LIM-LO
  5139         ELSE
  5140             MOVE -1             TO  AHLOBENL
  5141             MOVE AL-UNBON       TO  AHLOBENA
  5142             MOVE ER-2323        TO  EMI-ERROR
  5143             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5144     ELSE
  5145         IF ADD-FUNCTION
  5146             MOVE ZEROS          TO  AHLOBENO
  5147                                     WS-AHBEN-LIM-LO
  5148             MOVE AL-UNNON       TO  AHLOBENA.
  5149
  5150     IF AHHIBENL GREATER ZERO
  5151         MOVE AHHIBENI           TO  DEEDIT-FIELD
  5152         PERFORM 7500-DEEDIT THRU 7500-EXIT
  5153         IF DEEDIT-FIELD-V0 NUMERIC
  5154             IF DEEDIT-FIELD-V1 LESS WS-PREV-AMT
  5155                 MOVE -1         TO  AHHIBENL
  5156                 MOVE AL-UNBON   TO  AHHIBENA
  5157                 MOVE ER-2324    TO  EMI-ERROR
  5158                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5159             ELSE
  5160                 MOVE AL-UNNON   TO  AHHIBENA
  5161                 MOVE DEEDIT-FIELD-V1    TO  AHHIBENO
  5162                                             WS-AHBEN-LIM-HI
  5163         ELSE
  5164             MOVE -1             TO  AHHIBENL
  5165             MOVE AL-UNBON       TO  AHHIBENA
  5166             MOVE ER-2325        TO  EMI-ERROR
  5167             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5168     ELSE
  5169         IF ADD-FUNCTION
  5170             MOVE NINES          TO  AHHIBENO
  5171                                     WS-AHBEN-LIM-HI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL651.cbl
  5172             MOVE AL-UNNON       TO  AHHIBENA.
  5173
  5174     MOVE ZEROS                  TO  WS-PREV-AGE
  5175                                     WS-PREV-TRM
  5176                                     WS-PREV-AMT.
  5177
  5178     IF AMLOBENL GREATER ZERO
  5179         MOVE AMLOBENI           TO  DEEDIT-FIELD
  5180         PERFORM 7500-DEEDIT THRU 7500-EXIT
  5181         IF DEEDIT-FIELD-V0 NUMERIC
  5182             MOVE AL-UNNON       TO  AMLOBENA
  5183             MOVE DEEDIT-FIELD-V1    TO  WS-PREV-AMT
  5184                                         AMLOBENO
  5185                                         WS-AHMOA-LIM-LO
  5186         ELSE
  5187             MOVE -1             TO  AMLOBENL
  5188             MOVE AL-UNBON       TO  AMLOBENA
  5189             MOVE ER-2323        TO  EMI-ERROR
  5190             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5191     ELSE
  5192         IF ADD-FUNCTION
  5193             MOVE ZEROS          TO  AMLOBENO
  5194                                     WS-AHMOA-LIM-LO
  5195             MOVE AL-UNNON       TO  AMLOBENA.
  5196
  5197     IF AMHIBENL GREATER ZERO
  5198         MOVE AMHIBENI           TO  DEEDIT-FIELD
  5199         PERFORM 7500-DEEDIT THRU 7500-EXIT
  5200         IF DEEDIT-FIELD-V0 NUMERIC
  5201             IF DEEDIT-FIELD-V1 LESS WS-PREV-AMT
  5202                 MOVE -1         TO  AMHIBENL
  5203                 MOVE AL-UNBON   TO  AMHIBENA
  5204                 MOVE ER-2324    TO  EMI-ERROR
  5205                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5206             ELSE
  5207                 MOVE AL-UNNON   TO  AMHIBENA
  5208                 MOVE DEEDIT-FIELD-V1 TO AMHIBENO
  5209                                         WS-AHMOA-LIM-HI
  5210         ELSE
  5211             MOVE -1             TO  AMHIBENL
  5212             MOVE AL-UNBON       TO  AMHIBENA
  5213             MOVE ER-2325        TO  EMI-ERROR
  5214             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5215     ELSE
  5216         IF ADD-FUNCTION
  5217             MOVE NINES          TO  AMHIBENO
  5218                                     WS-AHMOA-LIM-HI
  5219             MOVE AL-UNNON       TO  AMHIBENA.
  5220
  5221     IF LFQTEDL GREATER ZERO
  5222         MOVE LFQTEDI            TO  WS-CHECK-QTED
  5223         IF VALID-QTED-CALC
  5224             MOVE AL-UANON       TO  LFQTEDA
  5225         ELSE
  5226             MOVE -1             TO  LFQTEDL
  5227             MOVE AL-UABON       TO  LFQTEDA
  5228             MOVE ER-2333        TO  EMI-ERROR
  5229             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL651.cbl
  5230     ELSE
  5231         IF ADD-FUNCTION
  5232             MOVE SPACE          TO  LFQTEDO
  5233             MOVE AL-UANON       TO  LFQTEDA.
  5234
  5235     IF LIFEBENL GREATER ZERO
  5236         MOVE LIFEBENI           TO  WS-CHECK-BEN-CODE
  5237         IF VALID-BEN-CODE
  5238             MOVE AL-UANON       TO  LIFEBENA
  5239         ELSE
  5240             MOVE -1             TO  LIFEBENL
  5241             MOVE AL-UABON       TO  LIFEBENA
  5242             MOVE ER-2326        TO  EMI-ERROR
  5243             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5244     ELSE
  5245         IF ADD-FUNCTION
  5246             MOVE SPACE          TO  LIFEBENO
  5247             MOVE AL-UABON       TO  LIFEBENA.
  5248
  5249     IF LFINTRL GREATER ZERO
  5250         MOVE LFINTRI            TO  WS-CHECK-INTR
  5251         IF VALID-INTR-CODE
  5252             MOVE AL-UANON       TO  LFINTRA
  5253         ELSE
  5254             MOVE -1             TO  LFINTRL
  5255             MOVE AL-UABON       TO  LFINTRA
  5256             MOVE ER-2327        TO  EMI-ERROR
  5257             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5258     ELSE
  5259         IF ADD-FUNCTION
  5260             MOVE SPACE          TO  LFINTRO
  5261             MOVE AL-UABON       TO  LFINTRA.
  5262
  5263     IF LFREML GREATER ZERO
  5264         MOVE LFREMI             TO  WS-CHECK-REM
  5265         IF VALID-REM-SW
  5266             MOVE AL-UANON       TO  LFREMA
  5267         ELSE
  5268         IF PI-COMPANY-ID EQUAL 'NSL' AND
  5269            WS-CHECK-REM EQUAL 'I'
  5270             MOVE AL-UANON       TO  LFREMA
  5271         ELSE
  5272             MOVE -1             TO  LFREML
  5273             MOVE AL-UABON       TO  LFREMA
  5274             MOVE ER-2334        TO  EMI-ERROR
  5275             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5276     ELSE
  5277         IF ADD-FUNCTION
  5278             MOVE SPACE          TO  LFREMO
  5279             MOVE AL-UANON       TO  LFREMA.
  5280
  5281     IF LFSTATEL GREATER ZERO
  5282         MOVE SPACES             TO  WS-ACCESS
  5283         MOVE LFSTATEI           TO  WS-STATE
  5284         PERFORM 7050-CHECK-STATE THRU 7050-EXIT
  5285         IF STATE-FOUND
  5286             MOVE AL-UANON       TO  LFSTATEA
  5287         ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL651.cbl
  5288             IF LFSTATEI = SPACES
  5289                 MOVE AL-UANON   TO  LFSTATEA
  5290             ELSE
  5291                 MOVE -1         TO  LFSTATEL
  5292                 MOVE AL-UABON   TO  LFSTATEA
  5293                 MOVE ER-2335    TO  EMI-ERROR
  5294                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5295
  5296     IF LFBENL GREATER ZERO
  5297         IF LFBENI NUMERIC
  5298             MOVE AL-UNNON       TO  LFBENA
  5299         ELSE
  5300             MOVE -1             TO  LFBENL
  5301             MOVE AL-UNBON       TO  LFBENA
  5302             MOVE ER-2331        TO  EMI-ERROR
  5303             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5304     ELSE
  5305         IF ADD-FUNCTION
  5306             MOVE ZEROS          TO  LFBENO
  5307             MOVE AL-UNNON       TO  LFBENA.
  5308
  5309     MOVE ZEROS                  TO  WS-PREV-AMT.
  5310
  5311     IF LFLOAMTL GREATER ZERO
  5312         MOVE LFLOAMTI           TO  DEEDIT-FIELD
  5313         PERFORM 7500-DEEDIT THRU 7500-EXIT
  5314         IF DEEDIT-FIELD-V0 NUMERIC
  5315             MOVE AL-UNNON       TO  LFLOAMTA
  5316             MOVE DEEDIT-FIELD-V1    TO  WS-PREV-AMT
  5317                                         LFLOAMTO
  5318                                         WS-LF-LO
  5319         ELSE
  5320             MOVE -1             TO  LFLOAMTL
  5321             MOVE AL-UNBON       TO  LFLOAMTA
  5322             MOVE ER-2328        TO  EMI-ERROR
  5323             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5324     ELSE
  5325         IF ADD-FUNCTION
  5326             MOVE ZEROS          TO  LFLOAMTO
  5327                                     WS-LF-LO
  5328             MOVE AL-UNNON       TO  LFLOAMTA.
  5329
  5330     IF LFHIAMTL GREATER ZERO
  5331         MOVE LFHIAMTI           TO  DEEDIT-FIELD
  5332         PERFORM 7500-DEEDIT THRU 7500-EXIT
  5333         IF DEEDIT-FIELD-V0 NUMERIC
  5334             IF DEEDIT-FIELD-V1 LESS WS-PREV-AMT
  5335                 MOVE -1         TO  LFHIAMTL
  5336                 MOVE AL-UNBON   TO  LFHIAMTA
  5337                 MOVE ER-2329    TO  EMI-ERROR
  5338                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5339             ELSE
  5340                 MOVE AL-UNNON   TO  LFHIAMTA
  5341                 MOVE DEEDIT-FIELD-V1 TO LFHIAMTO
  5342                                         WS-LF-HI
  5343         ELSE
  5344             MOVE -1             TO  LFHIAMTL
  5345             MOVE AL-UNBON       TO  LFHIAMTA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL651.cbl
  5346             MOVE ER-2330        TO  EMI-ERROR
  5347             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5348     ELSE
  5349         IF ADD-FUNCTION
  5350             MOVE NINES          TO  LFHIAMTO
  5351                                     WS-LF-HI
  5352             MOVE AL-UNNON       TO  LFHIAMTA.
  5353
  5354     IF AHQTEDL GREATER ZERO
  5355         MOVE AHQTEDI            TO  WS-CHECK-QTED
  5356         IF VALID-QTED-CALC
  5357             MOVE AL-UANON       TO  AHQTEDA
  5358         ELSE
  5359             MOVE -1             TO  AHQTEDL
  5360             MOVE AL-UABON       TO  AHQTEDA
  5361             MOVE ER-2333        TO  EMI-ERROR
  5362             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5363     ELSE
  5364         IF ADD-FUNCTION
  5365             MOVE SPACE          TO  AHQTEDO
  5366             MOVE AL-UANON       TO  AHQTEDA.
  5367
  5368     IF AHTBENL GREATER ZERO
  5369         MOVE AHTBENI            TO  WS-CHECK-BEN-CODE
  5370         IF VALID-BEN-CODE
  5371             MOVE AL-UANON       TO  AHTBENA
  5372         ELSE
  5373             MOVE -1             TO  AHTBENL
  5374             MOVE AL-UABON       TO  AHTBENA
  5375             MOVE ER-2326        TO  EMI-ERROR
  5376             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5377     ELSE
  5378         IF ADD-FUNCTION
  5379             MOVE SPACE          TO  AHTBENO
  5380             MOVE AL-UANON       TO  AHTBENA.
  5381
  5382     IF AHSTATEL GREATER ZERO
  5383         MOVE SPACES             TO  WS-ACCESS
  5384         MOVE AHSTATEI           TO  WS-STATE
  5385         PERFORM 7050-CHECK-STATE THRU 7050-EXIT
  5386         IF STATE-FOUND
  5387             MOVE AL-UANON       TO  AHSTATEA
  5388         ELSE
  5389             IF AHSTATEI = SPACES
  5390                 MOVE AL-UANON   TO  AHSTATEA
  5391             ELSE
  5392                 MOVE -1         TO  AHSTATEL
  5393                 MOVE AL-UABON   TO  AHSTATEA
  5394                 MOVE ER-2335    TO  EMI-ERROR
  5395                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5396
  5397     IF AHBENL GREATER ZERO
  5398         IF AHBENI NUMERIC
  5399             MOVE AL-UNNON       TO  AHBENA
  5400         ELSE
  5401             MOVE -1             TO  AHBENL
  5402             MOVE AL-UNBON       TO  AHBENA
  5403             MOVE ER-2331        TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL651.cbl
  5404             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5405     ELSE
  5406         IF ADD-FUNCTION
  5407             MOVE ZEROS          TO  AHBENO
  5408             MOVE AL-UNNON       TO  AHBENA.
  5409
  5410     MOVE ZEROS                  TO  WS-PREV-AMT.
  5411
  5412     IF AHLOAMTL GREATER ZERO
  5413         MOVE AHLOAMTI           TO  DEEDIT-FIELD
  5414         PERFORM 7500-DEEDIT THRU 7500-EXIT
  5415         IF DEEDIT-FIELD-V0 NUMERIC
  5416             MOVE AL-UNNON       TO  AHLOAMTA
  5417             MOVE DEEDIT-FIELD-V1 TO WS-PREV-AMT
  5418                                     AHLOAMTO
  5419                                     WS-AHBEN-LO
  5420         ELSE
  5421             MOVE -1             TO  AHLOAMTL
  5422             MOVE AL-UNBON       TO  AHLOAMTA
  5423             MOVE ER-2328        TO  EMI-ERROR
  5424             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5425     ELSE
  5426         IF ADD-FUNCTION
  5427             MOVE ZEROS          TO  AHLOAMTO
  5428                                     WS-AHBEN-LO
  5429             MOVE AL-UNNON       TO  AHLOAMTA.
  5430
  5431     IF AHHIAMTL GREATER ZERO
  5432         MOVE AHHIAMTI           TO  DEEDIT-FIELD
  5433         PERFORM 7500-DEEDIT THRU 7500-EXIT
  5434         IF DEEDIT-FIELD-V0 NUMERIC
  5435             IF DEEDIT-FIELD-V1 LESS WS-PREV-AMT
  5436                 MOVE -1         TO  AHHIAMTL
  5437                 MOVE AL-UNBON   TO  AHHIAMTA
  5438                 MOVE ER-2329    TO  EMI-ERROR
  5439                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5440             ELSE
  5441                 MOVE AL-UNNON   TO  AHHIAMTA
  5442                 MOVE DEEDIT-FIELD-V1    TO  AHHIAMTO
  5443                                             WS-AHBEN-HI
  5444         ELSE
  5445             MOVE -1             TO  AHHIAMTL
  5446             MOVE AL-UNBON       TO  AHHIAMTA
  5447             MOVE ER-2330        TO  EMI-ERROR
  5448             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5449     ELSE
  5450         IF ADD-FUNCTION
  5451             MOVE NINES          TO  AHHIAMTO
  5452                                     WS-AHBEN-HI
  5453             MOVE AL-UNNON       TO  AHHIAMTA.
  5454
  5455
  5456     MOVE ZEROS                  TO  WS-PREV-AMT.
  5457
  5458     IF AMLOAMTL GREATER ZERO
  5459         MOVE AMLOAMTI           TO  DEEDIT-FIELD
  5460         PERFORM 7500-DEEDIT THRU 7500-EXIT
  5461         IF DEEDIT-FIELD-V0 NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL651.cbl
  5462             MOVE AL-UNNON       TO  AMLOAMTA
  5463             MOVE DEEDIT-FIELD-V1    TO  WS-PREV-AMT
  5464                                         AMLOAMTO
  5465                                         WS-AHMOA-LO
  5466         ELSE
  5467             MOVE -1             TO  AMLOAMTL
  5468             MOVE AL-UNBON       TO  AMLOAMTA
  5469             MOVE ER-2328        TO  EMI-ERROR
  5470             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5471     ELSE
  5472         IF ADD-FUNCTION
  5473             MOVE ZEROS          TO  AMLOAMTO
  5474                                     WS-AHMOA-LO
  5475             MOVE AL-UNNON       TO  AMLOAMTA.
  5476
  5477     IF AMHIAMTL GREATER ZERO
  5478         MOVE AMHIAMTI           TO  DEEDIT-FIELD
  5479         PERFORM 7500-DEEDIT THRU 7500-EXIT
  5480         IF DEEDIT-FIELD-V0 NUMERIC
  5481             IF DEEDIT-FIELD-V1 LESS WS-PREV-AMT
  5482                 MOVE -1         TO  AMHIAMTL
  5483                 MOVE AL-UNBON   TO  AMHIAMTA
  5484                 MOVE ER-2329    TO  EMI-ERROR
  5485                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5486             ELSE
  5487                 MOVE AL-UNNON   TO  AMHIAMTA
  5488                 MOVE DEEDIT-FIELD-V1    TO  AMHIAMTO
  5489                                             WS-AHMOA-HI
  5490         ELSE
  5491             MOVE -1             TO  AMHIAMTL
  5492             MOVE AL-UNBON       TO  AMHIAMTA
  5493             MOVE ER-2330        TO  EMI-ERROR
  5494             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5495     ELSE
  5496         IF ADD-FUNCTION
  5497             MOVE NINES          TO  AMHIAMTO
  5498                                     WS-AHMOA-HI
  5499             MOVE AL-UNNON       TO  AMHIAMTA.
  5500
  5501     IF WS-LIFE-AGE-TRMS = ZEROS
  5502         IF WS-LIFE-BEN-AMTS NOT = ZEROS
  5503             MOVE -1             TO  LFLOAGEL
  5504             MOVE ER-2112        TO  EMI-ERROR
  5505             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5506             MOVE AL-UNBON       TO  LFLOAGEA  LFHIAGEA
  5507                                     LFLOTRMA  LFHITRMA
  5508                                     LFLOBENA  LFHIBENA
  5509                                     LFLOAMTA  LFHIAMTA.
  5510
  5511     IF WS-AH-AGE-TRMS = ZEROS
  5512         IF WS-AH-BEN-AMTS NOT = ZEROS
  5513             MOVE -1             TO  AHLOAGEL
  5514             MOVE ER-2112        TO  EMI-ERROR
  5515             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5516             MOVE AL-UNBON       TO  AHLOAGEA  AHHIAGEA
  5517                                     AHLOTRMA  AHHITRMA
  5518                                     AHLOBENA  AHHIBENA
  5519                                     AHLOAMTA  AHHIAMTA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL651.cbl
  5520                                     AMLOBENA  AMHIBENA
  5521                                     AMLOAMTA  AMHIAMTA.
  5522
  5523 7000-EXIT.
  5524     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL651.cbl
  5526 7050-CHECK-STATE.
  5527     MOVE SPACES                 TO  WS-STATE-FOUND-SW
  5528                                     ELCNTL-KEY.
  5529     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  5530     MOVE '3'                    TO  CNTL-REC-TYPE.
  5531     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  5532     MOVE +0                     TO  CNTL-SEQ-NO.
  5533
  5534
  5535* EXEC CICS HANDLE CONDITION
  5536*        NOTFND   (7050-EXIT)
  5537*    END-EXEC.
  5538*    MOVE '"$I                   ! & #00005264' TO DFHEIV0
  5539     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5540     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5541     MOVE X'2620233030303035323634' TO DFHEIV0(25:11)
  5542     CALL 'kxdfhei1' USING DFHEIV0
  5543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5544
  5545
  5546
  5547* EXEC CICS READ
  5548*        DATASET   (CNTL-FILE-ID)
  5549*        SET       (ADDRESS OF CONTROL-FILE)
  5550*        RIDFLD    (ELCNTL-KEY)
  5551*    END-EXEC.
  5552*    MOVE '&"S        E          (   #00005268' TO DFHEIV0
  5553     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5555     MOVE X'2020233030303035323638' TO DFHEIV0(25:11)
  5556     CALL 'kxdfhei1' USING DFHEIV0,
  5557           CNTL-FILE-ID,
  5558           DFHEIV20,
  5559           DFHEIV99,
  5560           ELCNTL-KEY,
  5561           DFHEIV99,
  5562           DFHEIV99,
  5563           DFHEIV99
  5564     SET ADDRESS OF CONTROL-FILE TO
  5565         DFHEIV20
  5566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5567
  5568
  5569     MOVE 'Y'                    TO  WS-STATE-FOUND-SW.
  5570
  5571 7050-EXIT.
  5572     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL651.cbl
  5574 7100-PAGE-TABLE-FORWARD.
  5575     MOVE SPACES                 TO  PI-ERREIN-EOF-SW.
  5576
  5577     IF TABLEL GREATER ZERO
  5578         MOVE ZERO TO TALLY
  5579         INSPECT TABLEI TALLYING TALLY FOR ALL SPACES
  5580         IF TALLY GREATER ZERO
  5581             MOVE -1             TO  TABLEL
  5582             MOVE AL-UABON       TO  TABLEA
  5583             MOVE ER-2341        TO  EMI-ERROR
  5584             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5585             GO TO 8200-SEND-DATAONLY
  5586         ELSE
  5587             MOVE AL-UANON       TO  TABLEA
  5588             MOVE TABLEI         TO  PI-ERR-TABLE
  5589     ELSE
  5590         MOVE LOW-VALUES         TO  PI-ERREIN-KEY
  5591         MOVE  'Y'               TO  PI-FIRST-TIME-SW.
  5592
  5593     MOVE PI-COMPANY-CD          TO  PI-ERR-COMPANY-CD.
  5594     MOVE 'A'                    TO  PI-ERR-CODE.
  5595     MOVE PI-ERREIN-KEY          TO  WS-SAVE-KEY.
  5596
  5597     PERFORM 7800-START-BROWSE THRU 7800-EXIT.
  5598
  5599
  5600* EXEC CICS HANDLE CONDITION
  5601*        ENDFILE  (7150-ENDFILE)
  5602*        NOTFND   (7175-NOTFOUND)
  5603*        END-EXEC.
  5604*    MOVE '"$''I                  ! '' #00005304' TO DFHEIV0
  5605     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5606     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5607     MOVE X'2720233030303035333034' TO DFHEIV0(25:11)
  5608     CALL 'kxdfhei1' USING DFHEIV0
  5609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5610
  5611
  5612 7110-READ-NEXT.
  5613     PERFORM 7850-READNEXT THRU 7850-EXIT.
  5614
  5615     IF ERREIN-EOF
  5616         GO TO 7150-ENDFILE.
  5617
  5618     IF PI-ERREIN-KEY = WS-SAVE-KEY
  5619         GO TO 7110-READ-NEXT.
  5620
  5621     IF PI-CARRIER-SECURITY GREATER SPACE
  5622         IF PI-CARRIER-SECURITY = RE-TABLE-CARRIER-SECURITY
  5623             NEXT SENTENCE
  5624         ELSE
  5625             GO TO 7110-READ-NEXT.
  5626
  5627     MOVE RE-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  5628     MOVE RE-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
  5629
  5630     MOVE PI-ERREIN-KEY          TO  PI-SAVE-ERREIN-KEY.
  5631
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL651.cbl
  5632     MOVE LOW-VALUES             TO  EL651AO.
  5633
  5634     MOVE +1                     TO  PI-SUB.
  5635
  5636     GO TO 5050-SET-UP-SCREEN.
  5637
  5638 7150-ENDFILE.
  5639     IF BROWSE-STARTED
  5640         PERFORM 7950-END-BROWSE THRU 7950-EXIT.
  5641
  5642     IF FIRST-TIME
  5643         MOVE LOW-VALUES         TO  EL651AO
  5644         MOVE ER-2346            TO  EMI-ERROR
  5645         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5646         MOVE -1                 TO  MAINTYPL
  5647         GO TO 8100-SEND-INITIAL-MAP
  5648     ELSE
  5649         MOVE ER-2067            TO  EMI-ERROR
  5650         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5651         MOVE LOW-VALUES         TO  EL651AO
  5652         GO TO 7100-PAGE-TABLE-FORWARD.
  5653
  5654 7175-NOTFOUND.
  5655     IF BROWSE-STARTED
  5656         PERFORM 7950-END-BROWSE THRU 7950-EXIT.
  5657
  5658     GO TO 8880-NOT-FOUND.
  5659
  5660 7199-EXIT.
  5661     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL651.cbl
  5663 7200-PAGE-TABLE-BACKWARD.
  5664     MOVE SPACES                 TO  PI-ERREIN-EOF-SW.
  5665
  5666     IF TABLEL GREATER ZERO
  5667         MOVE ZERO TO TALLY
  5668         INSPECT TABLEI TALLYING TALLY FOR ALL SPACES
  5669         IF TALLY GREATER ZERO
  5670             MOVE -1             TO  TABLEL
  5671             MOVE AL-UABON       TO  TABLEA
  5672             MOVE ER-2341        TO  EMI-ERROR
  5673             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5674             GO TO 8200-SEND-DATAONLY
  5675         ELSE
  5676             MOVE AL-UANON       TO  TABLEA
  5677             MOVE TABLEI         TO  PI-ERR-TABLE
  5678             MOVE LOW-VALUES     TO  PI-ERR-TABLE-SUB
  5679     ELSE
  5680         GO TO 7275-NOTFOUND.
  5681
  5682     MOVE PI-COMPANY-CD          TO  PI-ERR-COMPANY-CD.
  5683     MOVE 'A'                    TO  PI-ERR-CODE.
  5684     MOVE PI-ERREIN-KEY          TO  WS-SAVE-KEY.
  5685
  5686     PERFORM 7800-START-BROWSE THRU 7800-EXIT.
  5687
  5688
  5689* EXEC CICS HANDLE CONDITION
  5690*        ENDFILE  (7250-ENDFILE)
  5691*        NOTFND   (7275-NOTFOUND)
  5692*    END-EXEC.
  5693*    MOVE '"$''I                  ! ( #00005385' TO DFHEIV0
  5694     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5695     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5696     MOVE X'2820233030303035333835' TO DFHEIV0(25:11)
  5697     CALL 'kxdfhei1' USING DFHEIV0
  5698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5699
  5700
  5701     PERFORM 7850-READNEXT THRU 7850-EXIT.
  5702
  5703     IF ERREIN-EOF
  5704         GO TO 7250-ENDFILE.
  5705
  5706 7210-READ-PREV.
  5707     PERFORM 7900-READPREV THRU 7900-EXIT.
  5708
  5709     IF ERREIN-EOF
  5710         GO TO 7250-ENDFILE.
  5711
  5712     IF PI-ERREIN-KEY = WS-SAVE-KEY
  5713         GO TO 7210-READ-PREV.
  5714
  5715     IF PI-CARRIER-SECURITY GREATER SPACE
  5716        IF PI-CARRIER-SECURITY NOT = RE-TABLE-CARRIER-SECURITY
  5717             GO TO 7210-READ-PREV.
  5718
  5719     MOVE RE-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  5720     MOVE RE-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL651.cbl
  5721
  5722     MOVE PI-ERREIN-KEY          TO  PI-SAVE-ERREIN-KEY.
  5723
  5724     MOVE LOW-VALUES             TO  EL651AO.
  5725
  5726     MOVE +1                     TO  PI-SUB.
  5727
  5728     GO TO 5050-SET-UP-SCREEN.
  5729
  5730 7250-ENDFILE.
  5731     IF BROWSE-STARTED
  5732         PERFORM 7950-END-BROWSE THRU 7950-EXIT.
  5733
  5734     MOVE ER-2067                TO  EMI-ERROR
  5735     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5736     MOVE LOW-VALUES             TO  EL651AO
  5737     GO TO 7100-PAGE-TABLE-FORWARD.
  5738
  5739 7275-NOTFOUND.
  5740     IF BROWSE-STARTED
  5741         PERFORM 7950-END-BROWSE THRU 7950-EXIT.
  5742
  5743     GO TO 8880-NOT-FOUND.
  5744
  5745 7299-EXIT.
  5746     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL651.cbl
  5748 7300-PAGE-LEVEL.
  5749     MOVE SPACES                 TO  PI-ERREIN-EOF-SW.
  5750
  5751     IF TABLEL GREATER ZERO
  5752         MOVE ZERO TO TALLY
  5753         INSPECT TABLEI TALLYING TALLY FOR ALL SPACES
  5754         IF TALLY GREATER ZERO
  5755             MOVE -1             TO  TABLEL
  5756             MOVE AL-UABON       TO  TABLEA
  5757             MOVE ER-2341        TO  EMI-ERROR
  5758             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5759             GO TO 8200-SEND-DATAONLY
  5760         ELSE
  5761             MOVE AL-UANON       TO  TABLEA
  5762             MOVE TABLEI         TO  PI-ERR-TABLE
  5763             MOVE LOW-VALUES     TO  PI-ERR-TABLE-SUB
  5764     ELSE
  5765         MOVE -1                 TO  TABLEL
  5766         MOVE AL-UABON           TO  TABLEA
  5767         MOVE ER-2140            TO  EMI-ERROR
  5768         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5769         GO TO 8200-SEND-DATAONLY.
  5770
  5771     MOVE PI-COMPANY-CD          TO  PI-ERR-COMPANY-CD.
  5772     MOVE 'A'                    TO  PI-ERR-CODE.
  5773
  5774     PERFORM 7800-START-BROWSE THRU 7800-EXIT.
  5775
  5776
  5777* EXEC CICS HANDLE CONDITION
  5778*        ENDFILE  (7350-ENDFILE)
  5779*        NOTFND   (7375-NOTFOUND)
  5780*    END-EXEC.
  5781*    MOVE '"$''I                  ! ) #00005465' TO DFHEIV0
  5782     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5783     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5784     MOVE X'2920233030303035343635' TO DFHEIV0(25:11)
  5785     CALL 'kxdfhei1' USING DFHEIV0
  5786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5787
  5788
  5789     PERFORM 7850-READNEXT THRU 7850-EXIT.
  5790
  5791     IF ERREIN-EOF
  5792         IF BROWSE-STARTED
  5793             PERFORM 7950-END-BROWSE THRU 7950-EXIT
  5794             GO TO 7100-PAGE-TABLE-FORWARD.
  5795
  5796     MOVE RE-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  5797     MOVE RE-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
  5798
  5799     MOVE PI-ERREIN-KEY          TO  PI-SAVE-ERREIN-KEY.
  5800
  5801     IF LEVELL GREATER ZERO
  5802         MOVE LEVELI             TO  WS-CHECK-LEVEL
  5803         IF VALID-LEVEL
  5804             MOVE LEVELI         TO  PI-SUB
  5805             IF RE-REI-COMP (PI-SUB) = SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL651.cbl
  5806                 MOVE +1         TO  PI-SUB
  5807                 MOVE ER-2338    TO  EMI-ERROR
  5808                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5809                 GO TO 5000-BUILD-INITIAL-SCREEN
  5810             ELSE
  5811                 MOVE LOW-VALUES TO  EL651AO
  5812                 GO TO 5050-SET-UP-SCREEN
  5813         ELSE
  5814             MOVE +1             TO  PI-SUB
  5815             MOVE ER-2338        TO  EMI-ERROR
  5816             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5817             GO TO 5000-BUILD-INITIAL-SCREEN.
  5818
  5819     MOVE LOW-VALUES             TO  EL651AO.
  5820
  5821     IF PAGE-LEVEL-FORWARD
  5822         ADD +1                  TO  PI-SUB
  5823     ELSE
  5824         SUBTRACT +1 FROM PI-SUB.
  5825
  5826     IF PI-SUB GREATER +30 OR
  5827        RE-REI-COMP (PI-SUB) = SPACES
  5828            MOVE +1              TO  PI-SUB
  5829            MOVE ER-2338         TO  EMI-ERROR
  5830            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5831            GO TO 5000-BUILD-INITIAL-SCREEN
  5832     ELSE
  5833         IF PI-SUB LESS +1
  5834             MOVE PI-LAST-LEVEL  TO  PI-SUB
  5835             MOVE ER-0592        TO  EMI-ERROR
  5836             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5837
  5838     GO TO 5050-SET-UP-SCREEN.
  5839
  5840 7350-ENDFILE.
  5841     IF BROWSE-STARTED
  5842         PERFORM 7950-END-BROWSE THRU 7950-EXIT.
  5843
  5844     MOVE ER-2067                TO  EMI-ERROR.
  5845     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5846     MOVE LOW-VALUES             TO  EL651AO.
  5847     GO TO 7100-PAGE-TABLE-FORWARD.
  5848
  5849 7375-NOTFOUND.
  5850     IF BROWSE-STARTED
  5851         PERFORM 7950-END-BROWSE THRU 7950-EXIT.
  5852
  5853     GO TO 8880-NOT-FOUND.
  5854
  5855 7399-EXIT.
  5856     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL651.cbl
  5858
  5859 7400-SEARCH-FOR-COMPANY.
  5860     MOVE PI-ERREIN-KEY          TO  PI-SAVE-ERREIN-KEY.
  5861     MOVE COMPANYI               TO  PI-ERR-TABLE.
  5862     MOVE COMPSUBI               TO  PI-ERR-TABLE-SUB.
  5863     MOVE 'B'                    TO  PI-ERR-CODE.
  5864
  5865
  5866* EXEC CICS HANDLE CONDITION
  5867*        NOTOPEN  (9990-ABEND)
  5868*        NOTFND   (7425-NOT-FOUND)
  5869*    END-EXEC.
  5870*    MOVE '"$JI                  ! * #00005546' TO DFHEIV0
  5871     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  5872     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5873     MOVE X'2A20233030303035353436' TO DFHEIV0(25:11)
  5874     CALL 'kxdfhei1' USING DFHEIV0
  5875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5876
  5877
  5878     PERFORM 7650-READ-ERREIN THRU 7650-EXIT.
  5879
  5880     MOVE PI-SAVE-ERREIN-KEY     TO  PI-ERREIN-KEY.
  5881
  5882     GO TO 7499-EXIT.
  5883
  5884 7425-NOT-FOUND.
  5885     PERFORM 7700-ERREIN-GETMAIN THRU 7700-EXIT.
  5886     MOVE '1'                    TO  WS-GETMAIN-SW.
  5887
  5888     MOVE ZEROS                  TO  RE-LF-FEE
  5889                                     RE-AH-FEE
  5890                                     RE-AH-PR-PCT
  5891                                     RE-AH-78-PCT
  5892                                     RE-LF-PR-PCT
  5893                                     RE-LF-78-PCT
  5894*                                    RE-PR-PCT
  5895*                                    RE-78-PCT
  5896                                     RE-LF-IBNR-PCT
  5897                                     RE-AH-IBNR-PCT
  5898                                     RE-CLM-INCURRED-LIM
  5899                                     RE-LF-CLM-PCT
  5900                                     RE-AH-CLM-PCT
  5901                                     RE-LF-CLM-MAX
  5902                                     RE-AH-CLM-MAX
  5903                                     RE-LF-CEDING-FEE-BRACKETS
  5904                                     RE-AH-CEDING-FEE-BRACKETS
  5905                                     RE-EARNING-START-DT
  5906                                     RE-EARNING-STOP-DT
  5907                                     RE-CUSTODIAL-BAL
  5908                                     RE-LAST-MAINT-HHMMSS.
  5909
  5910     MOVE SPACES                 TO  RE-LF-FEE-METHOD
  5911                                     RE-AH-FEE-METHOD
  5912                                     RE-LF-FEE-BASIS
  5913                                     RE-AH-FEE-BASIS.
  5914
  5915     MOVE COMPANYI               TO  RE-COMP-PRIME
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL651.cbl
  5916                                     PI-ERR-TABLE.
  5917     MOVE COMPSUBI               TO  RE-COMP-SUB
  5918                                     PI-ERR-TABLE-SUB.
  5919     MOVE 'B'                    TO  RE-CODE
  5920                                     PI-ERR-CODE.
  5921     MOVE PI-COMPANY-CD          TO  PI-ERR-COMPANY-CD
  5922                                     RE-COMPANY-CD.
  5923
  5924     MOVE PI-PROCESSOR-ID        TO  RE-LAST-MAINT-USER.
  5925     MOVE EIBTIME                TO  RE-LAST-MAINT-HHMMSS.
  5926     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5927
  5928     MOVE '5'                    TO  DC-OPTION-CODE.
  5929     MOVE LINK-ELDATCV           TO  PGM-NAME.
  5930
  5931
  5932* EXEC CICS LINK
  5933*        PROGRAM   (PGM-NAME)
  5934*        COMMAREA  (DATE-CONVERSION-DATA)
  5935*        LENGTH    (DC-COMM-LENGTH)
  5936*    END-EXEC.
  5937*    MOVE '."C                   ''   #00005604' TO DFHEIV0
  5938     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5939     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5940     MOVE X'2020233030303035363034' TO DFHEIV0(25:11)
  5941     CALL 'kxdfhei1' USING DFHEIV0,
  5942           PGM-NAME,
  5943           DATE-CONVERSION-DATA,
  5944           DC-COMM-LENGTH,
  5945           DFHEIV99,
  5946           DFHEIV99,
  5947           DFHEIV99
  5948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5949
  5950
  5951     MOVE DC-BIN-DATE-1          TO  RE-LAST-MAINT-DT.
  5952     MOVE PI-COMPANY-CD          TO  RE-COMPANY-CD.
  5953     MOVE 'RE'                   TO  RE-RECORD-ID.
  5954*    MOVE REIN-FILE-ID           TO  FILE-ID.
  5955*    MOVE 'A'                    TO  JP-RECORD-AREA
  5956
  5957
  5958* EXEC CICS WRITE
  5959*        DATASET (REIN-FILE-ID)
  5960*        FROM    (REINSURANCE-RECORD)
  5961*        RIDFLD  (RE-CONTROL-PRIMARY)
  5962*    END-EXEC.
  5963     MOVE LENGTH OF
  5964      REINSURANCE-RECORD
  5965       TO DFHEIV11
  5966*    MOVE '&$ L                  ''   #00005616' TO DFHEIV0
  5967     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5968     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5969     MOVE X'2020233030303035363136' TO DFHEIV0(25:11)
  5970     CALL 'kxdfhei1' USING DFHEIV0,
  5971           REIN-FILE-ID,
  5972           REINSURANCE-RECORD,
  5973           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL651.cbl
  5974           RE-CONTROL-PRIMARY,
  5975           DFHEIV99,
  5976           DFHEIV99
  5977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5978
  5979
  5980*    MOVE REINSURANCE-RECORD     TO  JP-RECORD-AREA.
  5981
  5982*    PERFORM 8400-LOG-JOURNAL-RECORD.
  5983
  5984     MOVE PI-SAVE-ERREIN-KEY     TO  PI-ERREIN-KEY.
  5985     MOVE 'Y'                    TO  PI-COMPANY-ADD-SW.
  5986
  5987 7499-EXIT.
  5988     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL651.cbl
  5990 7500-DEEDIT.
  5991
  5992* EXEC CICS BIF
  5993*         DEEDIT
  5994*         FIELD  (DEEDIT-FIELD)
  5995*         LENGTH (15)
  5996*    END-EXEC.
  5997     MOVE 15
  5998       TO DFHEIV11
  5999*    MOVE '@"L                   #   #00005633' TO DFHEIV0
  6000     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6001     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6002     MOVE X'2020233030303035363333' TO DFHEIV0(25:11)
  6003     CALL 'kxdfhei1' USING DFHEIV0,
  6004           DEEDIT-FIELD,
  6005           DFHEIV11
  6006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6007
  6008
  6009 7500-EXIT.
  6010     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL651.cbl
  6012 7550-CHECK-CARRIER.
  6013     MOVE SPACES                 TO  WS-CARRIER-FOUND-SW
  6014                                     ELCNTL-KEY.
  6015     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  6016     MOVE '6'                    TO  CNTL-REC-TYPE.
  6017     MOVE CARRIER-ACCESS         TO  CNTL-ACCESS.
  6018     MOVE +0                     TO  CNTL-SEQ-NO.
  6019
  6020
  6021* EXEC CICS HANDLE CONDITION
  6022*        NOTFND   (7550-EXIT)
  6023*    END-EXEC.
  6024*    MOVE '"$I                   ! + #00005650' TO DFHEIV0
  6025     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6026     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6027     MOVE X'2B20233030303035363530' TO DFHEIV0(25:11)
  6028     CALL 'kxdfhei1' USING DFHEIV0
  6029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6030
  6031
  6032
  6033* EXEC CICS READ
  6034*        DATASET   (CNTL-FILE-ID)
  6035*        SET       (ADDRESS OF CONTROL-FILE)
  6036*        RIDFLD    (ELCNTL-KEY)
  6037*    END-EXEC.
  6038*    MOVE '&"S        E          (   #00005654' TO DFHEIV0
  6039     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6040     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6041     MOVE X'2020233030303035363534' TO DFHEIV0(25:11)
  6042     CALL 'kxdfhei1' USING DFHEIV0,
  6043           CNTL-FILE-ID,
  6044           DFHEIV20,
  6045           DFHEIV99,
  6046           ELCNTL-KEY,
  6047           DFHEIV99,
  6048           DFHEIV99,
  6049           DFHEIV99
  6050     SET ADDRESS OF CONTROL-FILE TO
  6051         DFHEIV20
  6052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6053
  6054
  6055     MOVE 'Y'                    TO  WS-CARRIER-FOUND-SW.
  6056
  6057 7550-EXIT.
  6058     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL651.cbl
  6060 7650-READ-ERREIN.
  6061     MOVE PI-COMPANY-CD          TO  PI-ERR-COMPANY-CD.
  6062
  6063
  6064* EXEC CICS READ
  6065*         DATASET  (REIN-FILE-ID)
  6066*         SET      (ADDRESS OF REINSURANCE-RECORD)
  6067*         RIDFLD   (PI-ERREIN-KEY)
  6068*    END-EXEC.
  6069*    MOVE '&"S        E          (   #00005668' TO DFHEIV0
  6070     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6071     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6072     MOVE X'2020233030303035363638' TO DFHEIV0(25:11)
  6073     CALL 'kxdfhei1' USING DFHEIV0,
  6074           REIN-FILE-ID,
  6075           DFHEIV20,
  6076           DFHEIV99,
  6077           PI-ERREIN-KEY,
  6078           DFHEIV99,
  6079           DFHEIV99,
  6080           DFHEIV99
  6081     SET ADDRESS OF REINSURANCE-RECORD TO
  6082         DFHEIV20
  6083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6084
  6085
  6086     CONTINUE.
  6087
  6088 7650-EXIT.
  6089     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL651.cbl
  6091 7700-ERREIN-GETMAIN.
  6092
  6093* EXEC CICS GETMAIN
  6094*         SET     (ADDRESS OF REINSURANCE-RECORD)
  6095*         LENGTH  (ERREIN-LENGTH)
  6096*         INITIMG (GETMAIN-SPACE)
  6097*    END-EXEC.
  6098*    MOVE ',"IL                  $   #00005680' TO DFHEIV0
  6099     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6100     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6101     MOVE X'2020233030303035363830' TO DFHEIV0(25:11)
  6102     CALL 'kxdfhei1' USING DFHEIV0,
  6103           DFHEIV20,
  6104           ERREIN-LENGTH,
  6105           GETMAIN-SPACE
  6106     SET ADDRESS OF REINSURANCE-RECORD TO
  6107         DFHEIV20
  6108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6109
  6110
  6111     CONTINUE.
  6112
  6113 7700-EXIT.
  6114     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL651.cbl
  6116 7750-READ-ERREIN-UPDATE.
  6117     MOVE PI-COMPANY-CD          TO  PI-ERR-COMPANY-CD.
  6118     MOVE 'A'                    TO  PI-ERR-CODE.
  6119
  6120
  6121* EXEC CICS READ
  6122*         DATASET  (REIN-FILE-ID)
  6123*         SET      (ADDRESS OF REINSURANCE-RECORD)
  6124*         RIDFLD   (PI-ERREIN-KEY)
  6125*         UPDATE
  6126*    END-EXEC.
  6127*    MOVE '&"S        EU         (   #00005695' TO DFHEIV0
  6128     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6129     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6130     MOVE X'2020233030303035363935' TO DFHEIV0(25:11)
  6131     CALL 'kxdfhei1' USING DFHEIV0,
  6132           REIN-FILE-ID,
  6133           DFHEIV20,
  6134           DFHEIV99,
  6135           PI-ERREIN-KEY,
  6136           DFHEIV99,
  6137           DFHEIV99,
  6138           DFHEIV99
  6139     SET ADDRESS OF REINSURANCE-RECORD TO
  6140         DFHEIV20
  6141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6142
  6143
  6144     CONTINUE.
  6145
  6146
  6147 7750-EXIT.
  6148     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL651.cbl
  6150 7800-START-BROWSE.
  6151
  6152* EXEC CICS STARTBR
  6153*         DATASET  (REIN-FILE-ID)
  6154*         RIDFLD   (PI-ERREIN-KEY)
  6155*    END-EXEC.
  6156     MOVE 0
  6157       TO DFHEIV11
  6158*    MOVE '&,         G          &   #00005709' TO DFHEIV0
  6159     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6160     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6161     MOVE X'2020233030303035373039' TO DFHEIV0(25:11)
  6162     CALL 'kxdfhei1' USING DFHEIV0,
  6163           REIN-FILE-ID,
  6164           PI-ERREIN-KEY,
  6165           DFHEIV99,
  6166           DFHEIV11,
  6167           DFHEIV99
  6168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6169
  6170
  6171     MOVE 'Y'                    TO  PI-BROWSE-SW.
  6172
  6173 7800-EXIT.
  6174     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL651.cbl
  6176 7850-READNEXT.
  6177
  6178* EXEC CICS READNEXT
  6179*         DATASET  (REIN-FILE-ID)
  6180*         SET      (ADDRESS OF REINSURANCE-RECORD)
  6181*         RIDFLD   (PI-ERREIN-KEY)
  6182*    END-EXEC.
  6183     MOVE 0
  6184       TO DFHEIV11
  6185*    MOVE '&.S                   )   #00005720' TO DFHEIV0
  6186     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6187     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6188     MOVE X'2020233030303035373230' TO DFHEIV0(25:11)
  6189     CALL 'kxdfhei1' USING DFHEIV0,
  6190           REIN-FILE-ID,
  6191           DFHEIV20,
  6192           DFHEIV99,
  6193           PI-ERREIN-KEY,
  6194           DFHEIV99,
  6195           DFHEIV11,
  6196           DFHEIV99,
  6197           DFHEIV99
  6198     SET ADDRESS OF REINSURANCE-RECORD TO
  6199         DFHEIV20
  6200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6201
  6202
  6203     CONTINUE.
  6204
  6205     IF PI-COMPANY-CD NOT = RE-COMPANY-CD OR
  6206        PI-ERR-CODE NOT = 'A'
  6207         MOVE LOW-VALUES         TO  EL651AO
  6208         MOVE 'Y'                TO  PI-ERREIN-EOF-SW
  6209         IF FIRST-TIME
  6210             MOVE ER-2346        TO  EMI-ERROR
  6211         ELSE
  6212             MOVE ER-2067        TO  EMI-ERROR
  6213     ELSE
  6214         GO TO 7850-EXIT.
  6215
  6216     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6217
  6218 7850-EXIT.
  6219     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL651.cbl
  6221 7900-READPREV.
  6222
  6223* EXEC CICS READPREV
  6224*         DATASET  (REIN-FILE-ID)
  6225*         SET      (ADDRESS OF REINSURANCE-RECORD)
  6226*         RIDFLD   (PI-ERREIN-KEY)
  6227*    END-EXEC.
  6228     MOVE 0
  6229       TO DFHEIV11
  6230*    MOVE '&0S                   )   #00005745' TO DFHEIV0
  6231     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  6232     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6233     MOVE X'2020233030303035373435' TO DFHEIV0(25:11)
  6234     CALL 'kxdfhei1' USING DFHEIV0,
  6235           REIN-FILE-ID,
  6236           DFHEIV20,
  6237           DFHEIV99,
  6238           PI-ERREIN-KEY,
  6239           DFHEIV99,
  6240           DFHEIV11,
  6241           DFHEIV99,
  6242           DFHEIV99
  6243     SET ADDRESS OF REINSURANCE-RECORD TO
  6244         DFHEIV20
  6245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6246
  6247
  6248     CONTINUE.
  6249
  6250     IF PI-COMPANY-CD NOT = RE-COMPANY-CD OR
  6251        PI-ERR-CODE NOT = 'A'
  6252         MOVE LOW-VALUES         TO  EL651AO
  6253         MOVE 'Y'                TO  PI-ERREIN-EOF-SW
  6254         IF FIRST-TIME
  6255             MOVE ER-2346        TO  EMI-ERROR
  6256             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6257         ELSE
  6258             MOVE ER-2067        TO  EMI-ERROR
  6259             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6260
  6261 7900-EXIT.
  6262     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL651.cbl
  6264 7950-END-BROWSE.
  6265
  6266* EXEC CICS ENDBR
  6267*         DATASET  (REIN-FILE-ID)
  6268*    END-EXEC.
  6269     MOVE 0
  6270       TO DFHEIV11
  6271*    MOVE '&2                    $   #00005768' TO DFHEIV0
  6272     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6273     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6274     MOVE X'2020233030303035373638' TO DFHEIV0(25:11)
  6275     CALL 'kxdfhei1' USING DFHEIV0,
  6276           REIN-FILE-ID,
  6277           DFHEIV11,
  6278           DFHEIV99
  6279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6280
  6281
  6282     MOVE SPACE                  TO  PI-BROWSE-SW.
  6283
  6284 7950-EXIT.
  6285     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL651.cbl
  6287 8000-UPDATE-MAINT-DATE.
  6288     MOVE SPACES                 TO  ELCNTL-KEY.
  6289
  6290     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  6291     MOVE '1'                    TO  CNTL-REC-TYPE.
  6292     MOVE +0                     TO  CNTL-SEQ-NO.
  6293
  6294
  6295* EXEC CICS HANDLE CONDITION
  6296*        NOTFND   (8000-EXIT)
  6297*    END-EXEC.
  6298*    MOVE '"$I                   ! , #00005784' TO DFHEIV0
  6299     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6300     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6301     MOVE X'2C20233030303035373834' TO DFHEIV0(25:11)
  6302     CALL 'kxdfhei1' USING DFHEIV0
  6303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6304
  6305
  6306
  6307* EXEC CICS READ
  6308*        UPDATE
  6309*        DATASET   (CNTL-FILE-ID)
  6310*        SET       (ADDRESS OF CONTROL-FILE)
  6311*        RIDFLD    (ELCNTL-KEY)
  6312*    END-EXEC.
  6313*    MOVE '&"S        EU         (   #00005788' TO DFHEIV0
  6314     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6315     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6316     MOVE X'2020233030303035373838' TO DFHEIV0(25:11)
  6317     CALL 'kxdfhei1' USING DFHEIV0,
  6318           CNTL-FILE-ID,
  6319           DFHEIV20,
  6320           DFHEIV99,
  6321           ELCNTL-KEY,
  6322           DFHEIV99,
  6323           DFHEIV99,
  6324           DFHEIV99
  6325     SET ADDRESS OF CONTROL-FILE TO
  6326         DFHEIV20
  6327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6328
  6329
  6330     CONTINUE.
  6331
  6332     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  6333     MOVE 'B'                    TO  JP-RECORD-TYPE.
  6334     MOVE CNTL-FILE-ID           TO  FILE-ID.
  6335     MOVE ELCNTL-LENGTH          TO  FILE-LENGTH.
  6336     PERFORM 8400-LOG-JOURNAL-RECORD.
  6337
  6338     MOVE BIN-CURRENT-SAVE       TO  CF-REINSURANCE-TAB-MAINT-DT.
  6339
  6340     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  6341     MOVE 'C'                    TO  JP-RECORD-TYPE.
  6342     MOVE CNTL-FILE-ID           TO  FILE-ID.
  6343     MOVE ELCNTL-LENGTH          TO  FILE-LENGTH.
  6344
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL651.cbl
  6345
  6346* EXEC CICS REWRITE
  6347*        DATASET   (CNTL-FILE-ID)
  6348*        FROM      (CONTROL-FILE)
  6349*    END-EXEC.
  6350     MOVE LENGTH OF
  6351      CONTROL-FILE
  6352       TO DFHEIV11
  6353*    MOVE '&& L                  %   #00005810' TO DFHEIV0
  6354     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6355     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6356     MOVE X'2020233030303035383130' TO DFHEIV0(25:11)
  6357     CALL 'kxdfhei1' USING DFHEIV0,
  6358           CNTL-FILE-ID,
  6359           CONTROL-FILE,
  6360           DFHEIV11,
  6361           DFHEIV99
  6362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6363
  6364
  6365     PERFORM 8400-LOG-JOURNAL-RECORD.
  6366
  6367 8000-EXIT.
  6368      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL651.cbl
  6370
  6371 8100-SEND-INITIAL-MAP.
  6372     MOVE SAVE-DATE              TO  RUNDATEO.
  6373     MOVE EIBTIME                TO  TIME-IN.
  6374     MOVE TIME-OUT               TO  RUNTIMEO.
  6375     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  6376     MOVE -1                     TO  MAINTYPL.
  6377     MOVE PI-LIFE-OVERRIDE-L2    TO  LIFEHDO.
  6378     MOVE PI-AH-OVERRIDE-L2      TO  AHHD1O  AHHD2O.
  6379     MOVE AL-SANON               TO  LIFEHDA  AHHD1A  AHHD2A.
  6380
  6381
  6382* EXEC CICS SEND
  6383*        MAP     (MAP-NAME)
  6384*        MAPSET  (MAPSET-NAME)
  6385*        FROM    (EL651AO)
  6386*        ERASE
  6387*        CURSOR
  6388*    END-EXEC.
  6389     MOVE LENGTH OF
  6390      EL651AO
  6391       TO DFHEIV12
  6392     MOVE -1
  6393       TO DFHEIV11
  6394*    MOVE '8$     CT  E    H L F ,   #00005831' TO DFHEIV0
  6395     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  6396     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  6397     MOVE X'2020233030303035383331' TO DFHEIV0(25:11)
  6398     CALL 'kxdfhei1' USING DFHEIV0,
  6399           MAP-NAME,
  6400           EL651AO,
  6401           DFHEIV12,
  6402           MAPSET-NAME,
  6403           DFHEIV99,
  6404           DFHEIV99,
  6405           DFHEIV99,
  6406           DFHEIV11,
  6407           DFHEIV99,
  6408           DFHEIV99,
  6409           DFHEIV99
  6410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6411
  6412
  6413     GO TO 9100-RETURN-TRAN.
  6414
  6415 8200-SEND-DATAONLY.
  6416     MOVE SAVE-DATE              TO  RUNDATEO.
  6417     MOVE EIBTIME                TO  TIME-IN.
  6418     MOVE TIME-OUT               TO  RUNTIMEO.
  6419     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  6420     MOVE PI-LIFE-OVERRIDE-L2    TO  LIFEHDO.
  6421     MOVE PI-AH-OVERRIDE-L2      TO  AHHD1O  AHHD2O.
  6422     MOVE AL-SANON               TO  LIFEHDA  AHHD1A  AHHD2A.
  6423
  6424
  6425* EXEC CICS SEND
  6426*        MAP     (MAP-NAME)
  6427*        MAPSET  (MAPSET-NAME)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL651.cbl
  6428*        FROM    (EL651AO)
  6429*        DATAONLY
  6430*        CURSOR
  6431*    END-EXEC.
  6432     MOVE LENGTH OF
  6433      EL651AO
  6434       TO DFHEIV12
  6435     MOVE -1
  6436       TO DFHEIV11
  6437*    MOVE '8$D    CT       H L F ,   #00005850' TO DFHEIV0
  6438     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  6439     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  6440     MOVE X'2020233030303035383530' TO DFHEIV0(25:11)
  6441     CALL 'kxdfhei1' USING DFHEIV0,
  6442           MAP-NAME,
  6443           EL651AO,
  6444           DFHEIV12,
  6445           MAPSET-NAME,
  6446           DFHEIV99,
  6447           DFHEIV99,
  6448           DFHEIV99,
  6449           DFHEIV11,
  6450           DFHEIV99,
  6451           DFHEIV99,
  6452           DFHEIV99
  6453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6454
  6455
  6456     GO TO 9100-RETURN-TRAN.
  6457
  6458 8300-SEND-TEXT.
  6459
  6460* EXEC CICS SEND TEXT
  6461*        FROM    (LOGOFF-TEXT)
  6462*        LENGTH  (LOGOFF-LENGTH)
  6463*        ERASE
  6464*        FREEKB
  6465*    END-EXEC.
  6466*    MOVE '8&      T  E F  H   F -   #00005861' TO DFHEIV0
  6467     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  6468     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  6469     MOVE X'2020233030303035383631' TO DFHEIV0(25:11)
  6470     CALL 'kxdfhei1' USING DFHEIV0,
  6471           LOGOFF-TEXT,
  6472           LOGOFF-LENGTH,
  6473           DFHEIV99,
  6474           DFHEIV99,
  6475           DFHEIV99,
  6476           DFHEIV99,
  6477           DFHEIV99,
  6478           DFHEIV99,
  6479           DFHEIV99,
  6480           DFHEIV99,
  6481           DFHEIV99,
  6482           DFHEIV99
  6483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6484
  6485
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL651.cbl
  6486
  6487* EXEC CICS RETURN
  6488*    END-EXEC.
  6489*    MOVE '.(                    &   #00005868' TO DFHEIV0
  6490     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6491     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6492     MOVE X'2020233030303035383638' TO DFHEIV0(25:11)
  6493     CALL 'kxdfhei1' USING DFHEIV0,
  6494           DFHEIV99,
  6495           DFHEIV99,
  6496           DFHEIV99,
  6497           DFHEIV99,
  6498           DFHEIV99
  6499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6500
  6501
  6502 8400-LOG-JOURNAL-RECORD.
  6503     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  6504     MOVE FILE-ID                TO  JP-FILE-ID.
  6505     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  6506*    IF PI-JOURNAL-FILE-ID NOT = ZERO
  6507*        EXEC CICS JOURNAL
  6508*            JFILEID  (PI-JOURNAL-FILE-ID)
  6509*            JTYPEID  ('EL')
  6510*            FROM     (JOURNAL-RECORD)
  6511*            LENGTH   (FILE-LENGTH)
  6512*        END-EXEC.
  6513
  6514 8800-UNAUTHORIZED-ACCESS.
  6515     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  6516     GO TO 8300-SEND-TEXT.
  6517
  6518 8810-PF23.
  6519     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  6520     MOVE XCTL-005               TO  PGM-NAME.
  6521     GO TO 9300-XCTL.
  6522
  6523 8870-NOTOPEN.
  6524     MOVE ER-2055                TO  EMI-ERROR.
  6525     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6526     MOVE -1                     TO  PFENTERL.
  6527     IF EIBTRNID NOT = TRANS-ID
  6528         GO TO 8100-SEND-INITIAL-MAP.
  6529
  6530     GO TO 8200-SEND-DATAONLY.
  6531
  6532 8880-NOT-FOUND.
  6533     MOVE ER-0142                TO  EMI-ERROR.
  6534     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6535     MOVE -1                     TO  MAINTYPL.
  6536     IF EIBTRNID NOT = TRANS-ID
  6537         GO TO 8100-SEND-INITIAL-MAP.
  6538
  6539     GO TO 8200-SEND-DATAONLY.
  6540
  6541 9000-RETURN-CICS.
  6542
  6543* EXEC CICS RETURN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL651.cbl
  6544*    END-EXEC.
  6545*    MOVE '.(                    &   #00005911' TO DFHEIV0
  6546     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6547     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6548     MOVE X'2020233030303035393131' TO DFHEIV0(25:11)
  6549     CALL 'kxdfhei1' USING DFHEIV0,
  6550           DFHEIV99,
  6551           DFHEIV99,
  6552           DFHEIV99,
  6553           DFHEIV99,
  6554           DFHEIV99
  6555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6556
  6557
  6558 9100-RETURN-TRAN.
  6559     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  6560     MOVE '651S'                 TO  PI-CURRENT-SCREEN-NO.
  6561
  6562* EXEC CICS RETURN
  6563*        TRANSID   (TRANS-ID)
  6564*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  6565*        LENGTH    (PI-COMM-LENGTH)
  6566*    END-EXEC.
  6567*    MOVE '.(CT                  &   #00005917' TO DFHEIV0
  6568     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  6569     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6570     MOVE X'2020233030303035393137' TO DFHEIV0(25:11)
  6571     CALL 'kxdfhei1' USING DFHEIV0,
  6572           TRANS-ID,
  6573           PROGRAM-INTERFACE-BLOCK,
  6574           PI-COMM-LENGTH,
  6575           DFHEIV99,
  6576           DFHEIV99
  6577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6578
  6579
  6580 9200-RETURN-MAIN-MENU.
  6581     MOVE XCTL-626               TO  PGM-NAME.
  6582     GO TO 9300-XCTL.
  6583
  6584 9300-XCTL.
  6585
  6586* EXEC CICS XCTL
  6587*        PROGRAM   (PGM-NAME)
  6588*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  6589*        LENGTH    (PI-COMM-LENGTH)
  6590*    END-EXEC.
  6591*    MOVE '.$C                   $   #00005928' TO DFHEIV0
  6592     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6593     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6594     MOVE X'2020233030303035393238' TO DFHEIV0(25:11)
  6595     CALL 'kxdfhei1' USING DFHEIV0,
  6596           PGM-NAME,
  6597           PROGRAM-INTERFACE-BLOCK,
  6598           PI-COMM-LENGTH
  6599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6600
  6601
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL651.cbl
  6602 9400-CLEAR.
  6603     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  6604     GO TO 9300-XCTL.
  6605
  6606 9500-PF12.
  6607     MOVE XCTL-010               TO  PGM-NAME.
  6608     GO TO 9300-XCTL.
  6609
  6610 9600-PGMID-ERROR.
  6611
  6612* EXEC CICS HANDLE CONDITION
  6613*        PGMIDERR  (8300-SEND-TEXT)
  6614*    END-EXEC.
  6615*    MOVE '"$L                   ! - #00005943' TO DFHEIV0
  6616     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  6617     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6618     MOVE X'2D20233030303035393433' TO DFHEIV0(25:11)
  6619     CALL 'kxdfhei1' USING DFHEIV0
  6620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6621
  6622
  6623     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  6624     MOVE ' '                    TO  PI-ENTRY-CD-1.
  6625     MOVE XCTL-005               TO  PGM-NAME.
  6626     MOVE PGM-NAME               TO  LOGOFF-PGM.
  6627     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  6628     GO TO 9300-XCTL.
  6629
  6630 9700-LINK-DATE-CONVERT.
  6631     MOVE LINK-ELDATCV           TO  PGM-NAME.
  6632
  6633
  6634* EXEC CICS LINK
  6635*        PROGRAM   (PGM-NAME)
  6636*        COMMAREA  (DATE-CONVERSION-DATA)
  6637*        LENGTH    (DC-COMM-LENGTH)
  6638*    END-EXEC.
  6639*    MOVE '."C                   ''   #00005957' TO DFHEIV0
  6640     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6641     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6642     MOVE X'2020233030303035393537' TO DFHEIV0(25:11)
  6643     CALL 'kxdfhei1' USING DFHEIV0,
  6644           PGM-NAME,
  6645           DATE-CONVERSION-DATA,
  6646           DC-COMM-LENGTH,
  6647           DFHEIV99,
  6648           DFHEIV99,
  6649           DFHEIV99
  6650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6651
  6652
  6653 9700-EXIT.
  6654     EXIT.
  6655
  6656 9900-ERROR-FORMAT.
  6657     IF NOT EMI-ERRORS-COMPLETE
  6658         MOVE LINK-001           TO  PGM-NAME
  6659
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL651.cbl
  6660* EXEC CICS LINK
  6661*            PROGRAM   (PGM-NAME)
  6662*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  6663*            LENGTH    (EMI-COMM-LENGTH)
  6664*        END-EXEC.
  6665*    MOVE '."C                   ''   #00005969' TO DFHEIV0
  6666     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6667     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6668     MOVE X'2020233030303035393639' TO DFHEIV0(25:11)
  6669     CALL 'kxdfhei1' USING DFHEIV0,
  6670           PGM-NAME,
  6671           ERROR-MESSAGE-INTERFACE-BLOCK,
  6672           EMI-COMM-LENGTH,
  6673           DFHEIV99,
  6674           DFHEIV99,
  6675           DFHEIV99
  6676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6677
  6678
  6679 9900-EXIT.
  6680     EXIT.
  6681
  6682 9990-ABEND.
  6683     MOVE LINK-004               TO  PGM-NAME.
  6684     MOVE DFHEIBLK               TO  EMI-LINE1
  6685
  6686* EXEC CICS LINK
  6687*        PROGRAM   (PGM-NAME)
  6688*        COMMAREA  (EMI-LINE1)
  6689*        LENGTH    (72)
  6690*    END-EXEC.
  6691     MOVE 72
  6692       TO DFHEIV11
  6693*    MOVE '."C                   ''   #00005981' TO DFHEIV0
  6694     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6695     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6696     MOVE X'2020233030303035393831' TO DFHEIV0(25:11)
  6697     CALL 'kxdfhei1' USING DFHEIV0,
  6698           PGM-NAME,
  6699           EMI-LINE1,
  6700           DFHEIV11,
  6701           DFHEIV99,
  6702           DFHEIV99,
  6703           DFHEIV99
  6704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6705
  6706
  6707     GO TO 8200-SEND-DATAONLY.
  6708
  6709
  6710* GOBACK.
  6711     MOVE '9%                    "   ' TO DFHEIV0
  6712     MOVE 'EL651' TO DFHEIV1
  6713     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6714     GOBACK.
  6715
  6716 9995-SECURITY-VIOLATION.
  6717*           COPY ELCSCTP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL651.cbl
  6718******************************************************************
  6719*                                                                *
  6720*                            ELCSCTP                             *
  6721*                            VMOD=2.001                          *
  6722*                                                                *
  6723*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  6724******************************************************************
  6725
  6726
  6727     MOVE EIBDATE          TO SM-JUL-DATE.
  6728     MOVE EIBTRMID         TO SM-TERMID.
  6729     MOVE THIS-PGM         TO SM-PGM.
  6730     MOVE EIBTIME          TO TIME-IN.
  6731     MOVE TIME-OUT         TO SM-TIME.
  6732     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  6733
  6734
  6735* EXEC CICS LINK
  6736*         PROGRAM  ('EL003')
  6737*         COMMAREA (SECURITY-MESSAGE)
  6738*         LENGTH   (80)
  6739*    END-EXEC.
  6740     MOVE 'EL003' TO DFHEIV1
  6741     MOVE 80
  6742       TO DFHEIV11
  6743*    MOVE '."C                   ''   #00006009' TO DFHEIV0
  6744     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6745     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6746     MOVE X'2020233030303036303039' TO DFHEIV0(25:11)
  6747     CALL 'kxdfhei1' USING DFHEIV0,
  6748           DFHEIV1,
  6749           SECURITY-MESSAGE,
  6750           DFHEIV11,
  6751           DFHEIV99,
  6752           DFHEIV99,
  6753           DFHEIV99
  6754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6755
  6756
  6757******************************************************************
  6758
  6759
  6760 9995-EXIT.
  6761      EXIT.
  6762
  6763 9999-DFHBACK SECTION.
  6764     MOVE '9%                    "   ' TO DFHEIV0
  6765     MOVE 'EL651' TO DFHEIV1
  6766     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6767     GOBACK.
  6768 9999-DFHEXIT.
  6769     IF DFHEIGDJ EQUAL 0001
  6770         NEXT SENTENCE
  6771     ELSE IF DFHEIGDJ EQUAL 2
  6772         GO TO 9990-ABEND,
  6773               8880-NOT-FOUND,
  6774               9600-PGMID-ERROR,
  6775               9990-ABEND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL651.cbl
  6776         DEPENDING ON DFHEIGDI
  6777     ELSE IF DFHEIGDJ EQUAL 3
  6778         GO TO 9990-ABEND,
  6779               4250-ADD-REC
  6780         DEPENDING ON DFHEIGDI
  6781     ELSE IF DFHEIGDJ EQUAL 4
  6782         GO TO 9990-ABEND,
  6783               4550-COPY-REC
  6784         DEPENDING ON DFHEIGDI
  6785     ELSE IF DFHEIGDJ EQUAL 5
  6786         GO TO 8880-NOT-FOUND
  6787         DEPENDING ON DFHEIGDI
  6788     ELSE IF DFHEIGDJ EQUAL 6
  6789         GO TO 7050-EXIT
  6790         DEPENDING ON DFHEIGDI
  6791     ELSE IF DFHEIGDJ EQUAL 7
  6792         GO TO 7150-ENDFILE,
  6793               7175-NOTFOUND
  6794         DEPENDING ON DFHEIGDI
  6795     ELSE IF DFHEIGDJ EQUAL 8
  6796         GO TO 7250-ENDFILE,
  6797               7275-NOTFOUND
  6798         DEPENDING ON DFHEIGDI
  6799     ELSE IF DFHEIGDJ EQUAL 9
  6800         GO TO 7350-ENDFILE,
  6801               7375-NOTFOUND
  6802         DEPENDING ON DFHEIGDI
  6803     ELSE IF DFHEIGDJ EQUAL 10
  6804         GO TO 9990-ABEND,
  6805               7425-NOT-FOUND
  6806         DEPENDING ON DFHEIGDI
  6807     ELSE IF DFHEIGDJ EQUAL 11
  6808         GO TO 7550-EXIT
  6809         DEPENDING ON DFHEIGDI
  6810     ELSE IF DFHEIGDJ EQUAL 12
  6811         GO TO 8000-EXIT
  6812         DEPENDING ON DFHEIGDI
  6813     ELSE IF DFHEIGDJ EQUAL 13
  6814         GO TO 8300-SEND-TEXT
  6815         DEPENDING ON DFHEIGDI.
  6816     MOVE '9%                    "   ' TO DFHEIV0
  6817     MOVE 'EL651' TO DFHEIV1
  6818     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6819     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8620     Code:       21414
