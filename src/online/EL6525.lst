* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6525.cbl
* Options: int("EL6525.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6525.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6525.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6525.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2 PROGRAM-ID. EL6525.
     3*AUTHOR.     PABLO.
     4*            COLLEYVILLE, TEXAS.
     5*DATE-COMPILED.
     6*SECURITY.   *****************************************************
     7*            *                                                   *
     8*            *   THIS PROGRAM IS THE PROPERTY OF CSO.            *
     9*            *                                                   *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*                                                                *
    12*            *   OF    CSO      IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6525.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*
    17*REMARKS.  TRANSACTION - EXDF - COMPENSATION BILLING INSTRUCTIONS
    18*
    19******************************************************************
    20*                   C H A N G E   L O G
    21*
    22* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    23*-----------------------------------------------------------------
    24*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    25* EFFECTIVE    NUMBER
    26*-----------------------------------------------------------------
    27* 081808    2008061100001  PEMA  NEW PROGRAM
    28******************************************************************
    29 ENVIRONMENT DIVISION.
    30 DATA DIVISION.
    31 WORKING-STORAGE SECTION.
    32 01  DFH-START PIC X(04).
    33 77  FILLER  PIC X(32)  VALUE '********************************'.
    34 77  FILLER  PIC X(32)  VALUE '*    EL6525 WORKING STORAGE    *'.
    35 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    36 01  WS-DATE-AREA.
    37     05  WS-SAVE-DATE                PIC X(8) VALUE SPACES.
    38     05  WS-SAVE-BIN-DT              PIC XX   VALUE SPACES.
    39     05  WS-EFF-YMD                  PIC X(6).
    40     05  WS-TRM-YMD                  PIC X(6).
    41     05  SUPPRESS-MAP-SW             PIC X    VALUE SPACE.
    42         88  DO-NOT-MOVE-TO-MAP          VALUE 'N'.
    43         88  MOVE-TO-MAP                 VALUE 'Y'.
    44     05  MAP-CHANGED-SW              PIC X    VALUE 'N'.
    45         88  MAP-NOT-CHANGED             VALUE 'N'.
    46         88  MAP-CHANGED                 VALUE 'Y'.
    47     05  BILL-INST-SW                PIC X.
    48         88  BILL-INST-CHANGED           VALUE 'Y'.
    49 01  WS-RESPONSE                 PIC S9(8)   COMP.
    50     88  RESP-NORMAL                  VALUE +00.
    51     88  RESP-NOTFND                  VALUE +13.
    52     88  RESP-NOTOPEN                 VALUE +19.
    53     88  RESP-ENDFILE                 VALUE +20.
    54 01  STANDARD-AREAS.
    55     12  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1024.
    56     12  WS-SUB                      PIC S9(4) COMP VALUE +0.
    57     12  MAP-NAME                    PIC X(8) VALUE 'EL6525A'.
    58     12  MAPSET-NAME                 PIC X(8) VALUE 'EL6525S'.
    59     12  SCREEN-NUMBER               PIC X(4) VALUE '652F'.
    60     12  TRANS-ID                    PIC X(4) VALUE 'EXDF'.
    61     12  EL611-TRANS-ID              PIC X(4) VALUE 'EXL3'.
    62     12  THIS-PGM                    PIC X(8) VALUE 'EL6525'.
    63     12  PGM-NAME                    PIC X(8).
    64     12  TIME-IN                     PIC S9(7).
    65     12  TIME-OUT-R  REDEFINES TIME-IN.
    66         16  FILLER                  PIC X.
    67         16  TIME-OUT                PIC 99V99.
    68         16  FILLER                  PIC XX.
    69     12  XCTL-005                    PIC X(8) VALUE 'EL005'.
    70     12  XCTL-010                    PIC X(8) VALUE 'EL010'.
    71     12  XCTL-626                    PIC X(8) VALUE 'EL626'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6525.cbl
    72     12  XCTL-611                    PIC X(8) VALUE 'EL611'.
    73     12  XCTL-652                    PIC X(8) VALUE 'EL652'.
    74     12  LINK-001                    PIC X(8) VALUE 'EL001'.
    75     12  LINK-004                    PIC X(8) VALUE 'EL004'.
    76     12  QID.
    77         16  QID-TERM                PIC X(4) VALUE SPACES.
    78         16  FILLER                  PIC X(4) VALUE '525A'.
    79     12  MAP-LENGTH                  PIC S9(4) VALUE +600  COMP.
    80     12  ERCOBI-FILE-ID              PIC X(8) VALUE 'ERCOBI'.
    81     12  ERCOMP-FILE-ID              PIC X(8) VALUE 'ERCOMP'.
    82     12  ELACHP-FILE-ID              PIC X(8) VALUE 'ELACHP'.
    83     12  ELBANK-FILE-ID              PIC X(8) VALUE 'ELBANK'.
    84     12  DEEDIT-FIELD                PIC X(15).
    85     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD PIC S9(15).
    86     12  WS-BILL-INST-SW            PIC X  VALUE SPACES.
    87         88  BILLING-INSTRUCTIONS-FOUND  VALUE 'Y'.
    88     12  ERROR-MESSAGES.
    89         16  ER-0000                 PIC X(4) VALUE '0000'.
    90         16  ER-0004                 PIC X(4) VALUE '0004'.
    91         16  ER-0008                 PIC X(4) VALUE '0008'.
    92         16  ER-0029                 PIC X(4) VALUE '0029'.
    93         16  ER-0068                 PIC X(4) VALUE '0068'.
    94         16  ER-0070                 PIC X(4) VALUE '0070'.
    95         16  ER-0348                 PIC X(4) VALUE '0348'.
    96         16  ER-0454                 PIC X(4) VALUE '0454'.
    97         16  ER-0876                 PIC X(4) VALUE '0876'.
    98         16  ER-1228                 PIC X(4) VALUE '1228'.
    99         16  ER-1626                 PIC X(4) VALUE '1626'.
   100         16  ER-1629                 PIC X(4) VALUE '1629'.
   101         16  ER-2039                 PIC X(4) VALUE '2039'.
   102         16  ER-2056                 PIC X(4) VALUE '2056'.
   103         16  ER-2057                 PIC X(4) VALUE '2057'.
   104         16  ER-2233                 PIC X(4) VALUE '2233'.
   105         16  ER-7430                 PIC X(4) VALUE '7430'.
   106         16  ER-7431                 PIC X(4) VALUE '7431'.
   107         16  ER-7432                 PIC X(4) VALUE '7432'.
   108         16  ER-7434                 PIC X(4) VALUE '7434'.
   109         16  ER-7435                 PIC X(4) VALUE '7435'.
   110         16  ER-7436                 PIC X(4) VALUE '7436'.
   111         16  ER-7438                 PIC X(4) VALUE '7438'.
   112         16  ER-7440                 PIC X(4) VALUE '7440'.
   113         16  ER-7447                 PIC X(4) VALUE '7447'.
   114         16  ER-7449                 PIC X(4) VALUE '7449'.
   115         16  ER-7462                 PIC X(4) VALUE '7462'.
   116         16  ER-7465                 PIC X(4) VALUE '7465'.
   117         16  ER-7468                 PIC X(4) VALUE '7468'.
   118         16  ER-7469                 PIC X(4) VALUE '7469'.
   119         16  ER-8799                 PIC X(4) VALUE '8799'.
   120         16  ER-9388                 PIC X(4) VALUE '9388'.
   121         16  ER-9399                 PIC X(4) VALUE '9399'.
   122         16  ER-9999                 PIC X(4) VALUE '9999'.
   123     12  ELCNTL-KEY.
   124         16  CNTL-COMP-ID            PIC X(3) VALUE SPACES.
   125         16  CNTL-REC-TYPE           PIC X    VALUE SPACES.
   126         16  CNTL-ACCESS             PIC X(4) VALUE SPACES.
   127         16  CNTL-SEQ-NO             PIC S9(4) VALUE +0  COMP.
   128*    COPY ELCLOGOF.
   129******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6525.cbl
   130*                                                                *
   131*                                                                *
   132*                            ELCLOGOF.                           *
   133*                            VMOD=2.001                          *
   134*                                                                *
   135*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   136*                                                                *
   137******************************************************************
   138 01  CLASIC-LOGOFF.
   139     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   140     12  LOGOFF-TEXT.
   141         16  FILLER          PIC X(5)    VALUE SPACES.
   142         16  LOGOFF-MSG.
   143             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   144             20  FILLER      PIC X       VALUE SPACES.
   145             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   146         16  FILLER          PIC X(80)
   147           VALUE '* YOU ARE NOW LOGGED OFF'.
   148         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   149         16  FILLER          PIC X       VALUE QUOTE.
   150         16  LOGOFF-SYS-MSG  PIC X(17)
   151           VALUE 'S CLAS-IC SYSTEM '.
   152     12  TEXT-MESSAGES.
   153         16  UNACCESS-MSG    PIC X(29)
   154             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   155         16  PGMIDERR-MSG    PIC X(17)
   156             VALUE 'PROGRAM NOT FOUND'.
   157*    COPY ELCDATE.
   158******************************************************************
   159*                                                                *
   160*                                                                *
   161*                            ELCDATE.                            *
   162*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   163*                            VMOD=2.003
   164*                                                                *
   165*                                                                *
   166*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   167*                 LENGTH = 200                                   *
   168******************************************************************
   169
   170 01  DATE-CONVERSION-DATA.
   171     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   172     12  DC-OPTION-CODE                PIC X.
   173         88  BIN-TO-GREG                VALUE ' '.
   174         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   175         88  EDIT-GREG-TO-BIN           VALUE '2'.
   176         88  YMD-GREG-TO-BIN            VALUE '3'.
   177         88  MDY-GREG-TO-BIN            VALUE '4'.
   178         88  JULIAN-TO-BIN              VALUE '5'.
   179         88  BIN-PLUS-ELAPSED           VALUE '6'.
   180         88  FIND-CENTURY               VALUE '7'.
   181         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   182         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   183         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   184         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   185         88  JULIAN-TO-BIN-3            VALUE 'C'.
   186         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   187         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6525.cbl
   188         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   189         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   190         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   191         88  CHECK-LEAP-YEAR            VALUE 'H'.
   192         88  BIN-3-TO-GREG              VALUE 'I'.
   193         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   194         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   195         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   196         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   197         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   198         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   199         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   200         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   201         88  THREE-CHARACTER-BIN
   202                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   203         88  GREGORIAN-TO-BIN
   204                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   205         88  BIN-TO-GREGORIAN
   206                  VALUES ' ' '1' 'I' '8' 'G'.
   207         88  JULIAN-TO-BINARY
   208                  VALUES '5' 'C' 'E' 'F'.
   209     12  DC-ERROR-CODE                 PIC X.
   210         88  NO-CONVERSION-ERROR        VALUE ' '.
   211         88  DATE-CONVERSION-ERROR
   212                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   213         88  DATE-IS-ZERO               VALUE '1'.
   214         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   215         88  DATE-IS-INVALID            VALUE '3'.
   216         88  DATE1-GREATER-DATE2        VALUE '4'.
   217         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   218         88  DATE-INVALID-OPTION        VALUE '9'.
   219         88  INVALID-CENTURY            VALUE 'A'.
   220         88  ONLY-CENTURY               VALUE 'B'.
   221         88  ONLY-LEAP-YEAR             VALUE 'C'.
   222         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   223     12  DC-END-OF-MONTH               PIC X.
   224         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   225     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   226         88  USE-NORMAL-PROCESS         VALUE ' '.
   227         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   228         88  ADJUST-UP-100-YRS          VALUE '2'.
   229     12  FILLER                        PIC X.
   230     12  DC-CONVERSION-DATES.
   231         16  DC-BIN-DATE-1             PIC XX.
   232         16  DC-BIN-DATE-2             PIC XX.
   233         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   234         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   235                       DC-GREG-DATE-1-EDIT.
   236             20  DC-EDIT1-MONTH        PIC 99.
   237             20  SLASH1-1              PIC X.
   238             20  DC-EDIT1-DAY          PIC 99.
   239             20  SLASH1-2              PIC X.
   240             20  DC-EDIT1-YEAR         PIC 99.
   241         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   242         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   243                     DC-GREG-DATE-2-EDIT.
   244             20  DC-EDIT2-MONTH        PIC 99.
   245             20  SLASH2-1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6525.cbl
   246             20  DC-EDIT2-DAY          PIC 99.
   247             20  SLASH2-2              PIC X.
   248             20  DC-EDIT2-YEAR         PIC 99.
   249         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   250         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   251                     DC-GREG-DATE-1-YMD.
   252             20  DC-YMD-YEAR           PIC 99.
   253             20  DC-YMD-MONTH          PIC 99.
   254             20  DC-YMD-DAY            PIC 99.
   255         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   256         16  DC-GREG-DATE-1-MDY-R REDEFINES
   257                      DC-GREG-DATE-1-MDY.
   258             20  DC-MDY-MONTH          PIC 99.
   259             20  DC-MDY-DAY            PIC 99.
   260             20  DC-MDY-YEAR           PIC 99.
   261         16  DC-GREG-DATE-1-ALPHA.
   262             20  DC-ALPHA-MONTH        PIC X(10).
   263             20  DC-ALPHA-DAY          PIC 99.
   264             20  FILLER                PIC XX.
   265             20  DC-ALPHA-CENTURY.
   266                 24 DC-ALPHA-CEN-N     PIC 99.
   267             20  DC-ALPHA-YEAR         PIC 99.
   268         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   269         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   270         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   271         16  DC-JULIAN-DATE            PIC 9(05).
   272         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   273                                       PIC 9(05).
   274         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   275             20  DC-JULIAN-YEAR        PIC 99.
   276             20  DC-JULIAN-DAYS        PIC 999.
   277         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   278         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   279         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   280     12  DATE-CONVERSION-VARIBLES.
   281         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   282         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   283             20  FILLER                PIC 9(3).
   284             20  HOLD-CEN-1-CCYY.
   285                 24  HOLD-CEN-1-CC     PIC 99.
   286                 24  HOLD-CEN-1-YY     PIC 99.
   287             20  HOLD-CEN-1-MO         PIC 99.
   288             20  HOLD-CEN-1-DA         PIC 99.
   289         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   290             20  HOLD-CEN-1-R-MO       PIC 99.
   291             20  HOLD-CEN-1-R-DA       PIC 99.
   292             20  HOLD-CEN-1-R-CCYY.
   293                 24  HOLD-CEN-1-R-CC   PIC 99.
   294                 24  HOLD-CEN-1-R-YY   PIC 99.
   295             20  FILLER                PIC 9(3).
   296         16  HOLD-CENTURY-1-X.
   297             20  FILLER                PIC X(3)  VALUE SPACES.
   298             20  HOLD-CEN-1-X-CCYY.
   299                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   300                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   301             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   302             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   303         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6525.cbl
   304             20  HOLD-CEN-1-R-X-MO     PIC XX.
   305             20  HOLD-CEN-1-R-X-DA     PIC XX.
   306             20  HOLD-CEN-1-R-X-CCYY.
   307                 24  HOLD-CEN-1-R-X-CC PIC XX.
   308                 24  HOLD-CEN-1-R-X-YY PIC XX.
   309             20  FILLER                PIC XXX.
   310         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   311         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   312         16  DC-JULIAN-DATE-1          PIC 9(07).
   313         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   314             20  DC-JULIAN-1-CCYY.
   315                 24  DC-JULIAN-1-CC    PIC 99.
   316                 24  DC-JULIAN-1-YR    PIC 99.
   317             20  DC-JULIAN-DA-1        PIC 999.
   318         16  DC-JULIAN-DATE-2          PIC 9(07).
   319         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   320             20  DC-JULIAN-2-CCYY.
   321                 24  DC-JULIAN-2-CC    PIC 99.
   322                 24  DC-JULIAN-2-YR    PIC 99.
   323             20  DC-JULIAN-DA-2        PIC 999.
   324         16  DC-GREG-DATE-A-EDIT.
   325             20  DC-EDITA-MONTH        PIC 99.
   326             20  SLASHA-1              PIC X VALUE '/'.
   327             20  DC-EDITA-DAY          PIC 99.
   328             20  SLASHA-2              PIC X VALUE '/'.
   329             20  DC-EDITA-CCYY.
   330                 24  DC-EDITA-CENT     PIC 99.
   331                 24  DC-EDITA-YEAR     PIC 99.
   332         16  DC-GREG-DATE-B-EDIT.
   333             20  DC-EDITB-MONTH        PIC 99.
   334             20  SLASHB-1              PIC X VALUE '/'.
   335             20  DC-EDITB-DAY          PIC 99.
   336             20  SLASHB-2              PIC X VALUE '/'.
   337             20  DC-EDITB-CCYY.
   338                 24  DC-EDITB-CENT     PIC 99.
   339                 24  DC-EDITB-YEAR     PIC 99.
   340         16  DC-GREG-DATE-CYMD         PIC 9(08).
   341         16  DC-GREG-DATE-CYMD-R REDEFINES
   342                              DC-GREG-DATE-CYMD.
   343             20  DC-CYMD-CEN           PIC 99.
   344             20  DC-CYMD-YEAR          PIC 99.
   345             20  DC-CYMD-MONTH         PIC 99.
   346             20  DC-CYMD-DAY           PIC 99.
   347         16  DC-GREG-DATE-MDCY         PIC 9(08).
   348         16  DC-GREG-DATE-MDCY-R REDEFINES
   349                              DC-GREG-DATE-MDCY.
   350             20  DC-MDCY-MONTH         PIC 99.
   351             20  DC-MDCY-DAY           PIC 99.
   352             20  DC-MDCY-CEN           PIC 99.
   353             20  DC-MDCY-YEAR          PIC 99.
   354    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   355        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   356    12  DC-EL310-DATE                  PIC X(21).
   357    12  FILLER                         PIC X(28).
   358*    COPY ELCATTR.
   359******************************************************************
   360*                                                                *
   361*                            ELCATTR.                            *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6525.cbl
   362*                            VMOD=2.001                          *
   363*                                                                *
   364*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   365*                                                                *
   366*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   367*                                                                *
   368*                   POS 1   P=PROTECTED                          *
   369*                           U=UNPROTECTED                        *
   370*                           S=ASKIP                              *
   371*                   POS 2   A=ALPHA/NUMERIC                      *
   372*                           N=NUMERIC                            *
   373*                   POS 3   N=NORMAL                             *
   374*                           B=BRIGHT                             *
   375*                           D=DARK                               *
   376*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   377*                           OF=MODIFIED DATA TAG OFF             *
   378*                                                                *
   379*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   380******************************************************************
   381 01  ATTRIBUTE-LIST.
   382     12  AL-PABOF            PIC X       VALUE 'Y'.
   383     12  AL-PABON            PIC X       VALUE 'Z'.
   384     12  AL-PADOF            PIC X       VALUE '%'.
   385     12  AL-PADON            PIC X       VALUE '_'.
   386     12  AL-PANOF            PIC X       VALUE '-'.
   387     12  AL-PANON            PIC X       VALUE '/'.
   388     12  AL-SABOF            PIC X       VALUE '8'.
   389     12  AL-SABON            PIC X       VALUE '9'.
   390     12  AL-SADOF            PIC X       VALUE '@'.
   391     12  AL-SADON            PIC X       VALUE QUOTE.
   392     12  AL-SANOF            PIC X       VALUE '0'.
   393     12  AL-SANON            PIC X       VALUE '1'.
   394     12  AL-UABOF            PIC X       VALUE 'H'.
   395     12  AL-UABON            PIC X       VALUE 'I'.
   396     12  AL-UADOF            PIC X       VALUE '<'.
   397     12  AL-UADON            PIC X       VALUE '('.
   398     12  AL-UANOF            PIC X       VALUE ' '.
   399     12  AL-UANON            PIC X       VALUE 'A'.
   400     12  AL-UNBOF            PIC X       VALUE 'Q'.
   401     12  AL-UNBON            PIC X       VALUE 'R'.
   402     12  AL-UNDOF            PIC X       VALUE '*'.
   403     12  AL-UNDON            PIC X       VALUE ')'.
   404     12  AL-UNNOF            PIC X       VALUE '&'.
   405     12  AL-UNNON            PIC X       VALUE 'J'.
   406*    COPY ELCEMIB.
   407******************************************************************
   408*                                                                *
   409*                                                                *
   410*                            ELCEMIB.                            *
   411*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   412*                            VMOD=2.005                          *
   413*                                                                *
   414*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   415*                                                                *
   416******************************************************************
   417 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   418     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   419     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6525.cbl
   420     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   421     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   422     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   423     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   424     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   425     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   426     12  EMI-SWITCH1             PIC X        VALUE '1'.
   427         88  EMI-NO-ERRORS                    VALUE '1'.
   428         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   429         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   430     12  EMI-SWITCH2             PIC X        VALUE '1'.
   431         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   432     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   433         88  EMI-AREA1-EMPTY                  VALUE '1'.
   434         88  EMI-AREA1-FULL                   VALUE '2'.
   435     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   436         88  EMI-AREA2-EMPTY                  VALUE '1'.
   437         88  EMI-AREA2-FULL                   VALUE '2'.
   438     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   439         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   440         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   441         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   442         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   443         88  EMI-BYPASS-FATALS                VALUE 'X'.
   444     12  EMI-ERROR-LINES.
   445         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   446         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   447         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   448         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   449             20  EMI-ERR-CODES OCCURS 10 TIMES.
   450                 24  EMI-ERR-NUM         PIC X(4).
   451                 24  EMI-FILLER          PIC X.
   452                 24  EMI-SEV             PIC X.
   453                 24  FILLER              PIC X.
   454             20  FILLER                  PIC X(02).
   455     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   456         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   457             20  EMI-ERROR-NUMBER    PIC X(4).
   458             20  EMI-FILL            PIC X.
   459             20  EMI-SEVERITY        PIC X.
   460             20  FILLER              PIC X.
   461             20  EMI-ERROR-TEXT.
   462                 24  EMI-TEXT-VARIABLE   PIC X(10).
   463                 24  FILLER          PIC X(55).
   464     12  EMI-SEVERITY-SAVE           PIC X.
   465         88  EMI-NOTE                    VALUE 'N'.
   466         88  EMI-WARNING                 VALUE 'W'.
   467         88  EMI-FORCABLE                VALUE 'F'.
   468         88  EMI-FATAL                   VALUE 'X'.
   469     12  EMI-MESSAGE-FLAG            PIC X.
   470         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   471         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   472     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   473     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   474         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   475         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   476         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   477     12  FILLER                      PIC X(137)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6525.cbl
   478     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   479     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   480     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   481     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   482*    COPY ELCSCTM.
   483******************************************************************
   484*                                                                *
   485*                                                                *
   486*                            ELCSCTM                             *
   487*                            VMOD=2.001                          *
   488*                                                                *
   489*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   490*                                                                *
   491******************************************************************
   492 01  SECURITY-MESSAGE.
   493     12  FILLER                          PIC X(30)
   494            VALUE '** LOGIC SECURITY VIOLATION -'.
   495     12  SM-READ                         PIC X(6).
   496     12  FILLER                          PIC X(5)
   497            VALUE ' PGM='.
   498     12  SM-PGM                          PIC X(6).
   499     12  FILLER                          PIC X(5)
   500            VALUE ' OPR='.
   501     12  SM-PROCESSOR-ID                 PIC X(4).
   502     12  FILLER                          PIC X(6)
   503            VALUE ' TERM='.
   504     12  SM-TERMID                       PIC X(4).
   505     12  FILLER                          PIC XX   VALUE SPACE.
   506     12  SM-JUL-DATE                     PIC 9(5).
   507     12  FILLER                          PIC X    VALUE SPACE.
   508     12  SM-TIME                         PIC 99.99.
   509
   510*    COPY ELCSCRTY.
   511******************************************************************
   512*                                                                *
   513*                                                                *
   514*                            ELCSCRTY                            *
   515*                            VMOD=2.001                          *
   516*                                                                *
   517*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   518*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   519*        SAVED IN PI-SECURITY-ADDRESS.                           *
   520*                                                                *
   521******************************************************************
   522 01  SECURITY-CONTROL.
   523     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   524     12  FILLER                       PIC XX    VALUE 'SC'.
   525     12  SC-CREDIT-CODES.
   526         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   527             20  SC-CREDIT-DISPLAY    PIC X.
   528             20  SC-CREDIT-UPDATE     PIC X.
   529     12  SC-CLAIMS-CODES.
   530         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   531             20  SC-CLAIMS-DISPLAY    PIC X.
   532             20  SC-CLAIMS-UPDATE     PIC X.
   533*    COPY ELCINTF.
   534******************************************************************
   535*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6525.cbl
   536*                                                                *
   537*                            ELCINTF.                            *
   538*                            VMOD=2.017                          *
   539*                                                                *
   540*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   541*                                                                *
   542*       LENGTH = 1024                                            *
   543*                                                                *
   544******************************************************************
   545 01  PROGRAM-INTERFACE-BLOCK.
   546     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   547     12  PI-CALLING-PROGRAM              PIC X(8).
   548     12  PI-SAVED-PROGRAM-1              PIC X(8).
   549     12  PI-SAVED-PROGRAM-2              PIC X(8).
   550     12  PI-SAVED-PROGRAM-3              PIC X(8).
   551     12  PI-SAVED-PROGRAM-4              PIC X(8).
   552     12  PI-SAVED-PROGRAM-5              PIC X(8).
   553     12  PI-SAVED-PROGRAM-6              PIC X(8).
   554     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   555     12  PI-COMPANY-ID                   PIC XXX.
   556     12  PI-COMPANY-CD                   PIC X.
   557
   558     12  PI-COMPANY-PASSWORD             PIC X(8).
   559
   560     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   561
   562     12  PI-CONTROL-IN-PROGRESS.
   563         16  PI-CARRIER                  PIC X.
   564         16  PI-GROUPING                 PIC X(6).
   565         16  PI-STATE                    PIC XX.
   566         16  PI-ACCOUNT                  PIC X(10).
   567         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   568                                         PIC X(10).
   569         16  PI-CLAIM-CERT-GRP.
   570             20  PI-CLAIM-NO             PIC X(7).
   571             20  PI-CERT-NO.
   572                 25  PI-CERT-PRIME       PIC X(10).
   573                 25  PI-CERT-SFX         PIC X.
   574             20  PI-CERT-EFF-DT          PIC XX.
   575         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   576             20  PI-PLAN-CODE            PIC X(2).
   577             20  PI-REVISION-NUMBER      PIC X(3).
   578             20  PI-PLAN-EFF-DT          PIC X(2).
   579             20  PI-PLAN-EXP-DT          PIC X(2).
   580             20  FILLER                  PIC X(11).
   581         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   582             20  PI-OE-REFERENCE-1.
   583                 25  PI-OE-REF-1-PRIME   PIC X(18).
   584                 25  PI-OE-REF-1-SUFF    PIC XX.
   585
   586     12  PI-SESSION-IN-PROGRESS          PIC X.
   587         88  CLAIM-SESSION                   VALUE '1'.
   588         88  CREDIT-SESSION                  VALUE '2'.
   589         88  WARRANTY-SESSION                VALUE '3'.
   590         88  MORTGAGE-SESSION                VALUE '4'.
   591         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   592
   593
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6525.cbl
   594*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   595
   596     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   597     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   598
   599     12  PI-CREDIT-USER                  PIC X.
   600         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   601         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   602
   603     12  PI-CLAIM-USER                   PIC X.
   604         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   605         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   606
   607     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   608         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   609         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   610         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   611         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   612         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   613
   614     12  PI-PROCESSOR-ID                 PIC X(4).
   615
   616     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   617
   618     12  PI-MEMBER-CAPTION               PIC X(10).
   619
   620     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   621         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   622
   623     12  PI-LIFE-OVERRIDE-L1             PIC X.
   624     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   625     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   626     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   627
   628     12  PI-AH-OVERRIDE-L1               PIC X.
   629     12  PI-AH-OVERRIDE-L2               PIC XX.
   630     12  PI-AH-OVERRIDE-L6               PIC X(6).
   631     12  PI-AH-OVERRIDE-L12              PIC X(12).
   632
   633     12  PI-NEW-SYSTEM                   PIC X(2).
   634
   635     12  PI-PRIMARY-CERT-NO              PIC X(11).
   636     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   637         88  PI-USES-PAID-TO                 VALUE '1'.
   638     12  PI-CRDTCRD-SYSTEM.
   639         16  PI-CRDTCRD-USER             PIC X.
   640             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   641             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   642         16  PI-CC-MONTH-END-DT          PIC XX.
   643     12  PI-PROCESSOR-PRINTER            PIC X(4).
   644
   645     12  PI-OE-REFERENCE-2.
   646         16  PI-OE-REF-2-PRIME           PIC X(10).
   647         16  PI-OE-REF-2-SUFF            PIC X.
   648
   649     12  PI-REM-TRM-CALC-OPTION          PIC X.
   650
   651     12  PI-LANGUAGE-TYPE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6525.cbl
   652             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   653             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   654             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   655
   656     12  PI-POLICY-LINKAGE-IND           PIC X.
   657         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   658         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   659                                                   LOW-VALUES.
   660
   661     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   662     12  PI-CLAIM-PW-SESSION             PIC X(1).
   663         88  PI-CLAIM-CREDIT                 VALUE '1'.
   664         88  PI-CLAIM-CONVEN                 VALUE '2'.
   665     12  FILLER                          PIC X(4).
   666
   667     12  PI-SYSTEM-LEVEL                 PIC X(145).
   668
   669     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   670         PI-SYSTEM-LEVEL.
   671
   672         16  PI-ENTRY-CODES.
   673             20  PI-ENTRY-CD-1           PIC X.
   674             20  PI-ENTRY-CD-2           PIC X.
   675
   676         16  PI-RETURN-CODES.
   677             20  PI-RETURN-CD-1          PIC X.
   678             20  PI-RETURN-CD-2          PIC X.
   679
   680         16  PI-UPDATE-STATUS-SAVE.
   681             20  PI-UPDATE-BY            PIC X(4).
   682             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   683
   684         16  PI-LOWER-CASE-LETTERS       PIC X.
   685             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   686
   687*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   688*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   689*            88  CARRIER-CLM-CNTL            VALUE '2'.
   690
   691         16  PI-CERT-ACCESS-CONTROL      PIC X.
   692             88  ST-ACCNT-CNTL               VALUE ' '.
   693             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   694             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   695             88  ACCNT-CNTL                  VALUE '3'.
   696             88  CARR-ACCNT-CNTL             VALUE '4'.
   697
   698         16  PI-PROCESSOR-CAP-LIST.
   699             20  PI-SYSTEM-CONTROLS.
   700                24 PI-SYSTEM-DISPLAY     PIC X.
   701                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   702                24 PI-SYSTEM-MODIFY      PIC X.
   703                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   704             20  FILLER                  PIC XX.
   705             20  PI-DISPLAY-CAP          PIC X.
   706                 88  DISPLAY-CAP             VALUE 'Y'.
   707             20  PI-MODIFY-CAP           PIC X.
   708                 88  MODIFY-CAP              VALUE 'Y'.
   709             20  PI-MSG-AT-LOGON-CAP     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6525.cbl
   710                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   711             20  PI-FORCE-CAP            PIC X.
   712                 88  FORCE-CAP               VALUE 'Y'.
   713
   714         16  PI-PROGRAM-CONTROLS.
   715             20  PI-PGM-PRINT-OPT        PIC X.
   716             20  PI-PGM-FORMAT-OPT       PIC X.
   717             20  PI-PGM-PROCESS-OPT      PIC X.
   718             20  PI-PGM-TOTALS-OPT       PIC X.
   719
   720         16  PI-HELP-INTERFACE.
   721             20  PI-LAST-ERROR-NO        PIC X(4).
   722             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   723
   724         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   725             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   726
   727         16  PI-CR-CONTROL-IN-PROGRESS.
   728             20  PI-CR-CARRIER           PIC X.
   729             20  PI-CR-GROUPING          PIC X(6).
   730             20  PI-CR-STATE             PIC XX.
   731             20  PI-CR-ACCOUNT           PIC X(10).
   732             20  PI-CR-FIN-RESP          PIC X(10).
   733             20  PI-CR-TYPE              PIC X.
   734
   735         16  PI-CR-BATCH-NUMBER          PIC X(6).
   736
   737         16  PI-CR-MONTH-END-DT          PIC XX.
   738
   739         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   740             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   741             88  PI-ZERO-CARRIER             VALUE '1'.
   742             88  PI-ZERO-GROUPING            VALUE '2'.
   743             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   744
   745         16  PI-CARRIER-SECURITY         PIC X.
   746             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   747
   748         16  PI-ACCOUNT-SECURITY         PIC X(10).
   749             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   750             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   751
   752         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   753             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   754                                         INDEXED BY PI-ACCESS-NDX
   755                                         PIC X.
   756
   757         16  PI-GA-BILLING-CONTROL       PIC X.
   758             88  PI-GA-BILLING               VALUE '1'.
   759
   760         16  PI-MAIL-PROCESSING          PIC X.
   761             88  PI-MAIL-YES                 VALUE 'Y'.
   762
   763         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   764
   765         16  PI-AR-SYSTEM.
   766             20  PI-AR-PROCESSING-CNTL   PIC X.
   767                 88  PI-AR-PROCESSING        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6525.cbl
   768             20  PI-AR-SUMMARY-CODE      PIC X(6).
   769             20  PI-AR-MONTH-END-DT      PIC XX.
   770
   771         16  PI-MP-SYSTEM.
   772             20  PI-MORTGAGE-USER            PIC X.
   773                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   774                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   775             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   776                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   777                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   778                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   779                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   780                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   781             20  PI-MP-MONTH-END-DT          PIC XX.
   782             20  PI-MP-REFERENCE-NO.
   783                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   784                 24  PI-MP-REFERENCE-SFX     PIC XX.
   785
   786         16  PI-LABEL-CONTROL            PIC X(01).
   787             88  PI-CREATE-LABELS                    VALUE 'Y'.
   788             88  PI-BYPASS-LABELS                    VALUE 'N'.
   789
   790         16  PI-BILL-GROUPING-CODE       PIC X(01).
   791             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   792
   793         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   794             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   795             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   796
   797         16  FILLER                      PIC X(14).
   798
   799     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   800******************************************************************
   801     12  PI-WORK-AREA  REDEFINES  PI-PROGRAM-WORK-AREA.
   802         16  PI-MAINT                PIC  X.
   803         16  PI-CHECK-TYPE           PIC  X.
   804         16  PI-CHECK-CARRY-BAL      PIC  X.
   805         16  PI-FIRST-TIME-SW        PIC  X.
   806             88  FIRST-TIME                  VALUE 'Y'.
   807         16  PI-ERCOMP-EOF-SW        PIC  X.
   808             88  ERCOMP-EOF                  VALUE 'Y'.
   809         16  PI-SAVE-PHONE           PIC  X(10).
   810         16  PI-SAVE-PHONE-RED REDEFINES PI-SAVE-PHONE  PIC 9(10).
   811         16  PI-ERC-END-BAL          PIC S9(9)V99       COMP-3.
   812         16  PI-ERCOMP-KEY.
   813             20  PI-ERC-GROUP-CD     PIC  X.
   814             20  PI-ERC-CARRIER      PIC  X.
   815             20  PI-ERC-GROUP        PIC  X(6).
   816             20  PI-ERC-RESP         PIC  X(10).
   817             20  PI-ERC-ACCT         PIC  X(10).
   818             20  PI-ERC-TYPE         PIC  X.
   819         16  PI-SAVE-ERCOMP-KEY      PIC  X(29).
   820         16  PI-BANK-TRANSIT-NUMBER.
   821             20  PI-BANK-COMPANY-CD  PIC X.
   822             20  PI-FEDERAL-NUMBER   PIC X(4).
   823             20  PI-BANK-NUMBER      PIC X(4).
   824         16  PI-BANK-ACCOUNT-NO      PIC X(17).
   825         16  PI-BANK-ACTION-CODE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6525.cbl
   826         16  PI-ERCOBI-KEY.
   827             20  PI-ERCOBI-COMPANY-CD PIC X.
   828             20  PI-ERCOBI-STMT-OWNER PIC X(4).
   829             20  PI-ERCOBI-RGID      PIC X(12).
   830         16  PI-SAVE-ERCOBI-KEY      PIC X(17).
   831         16  FILLER                  PIC  X(500).
   832*    COPY ELCAID.
   833******************************************************************
   834*                                                                *
   835*                            ELCAID.                             *
   836*                            VMOD=2.001                          *
   837*                                                                *
   838*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   839*                                                                *
   840*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   841*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   842******************************************************************
   843
   844 01  DFHAID.
   845   02  DFHNULL   PIC  X  VALUE  ' '.
   846   02  DFHENTER  PIC  X  VALUE  QUOTE.
   847   02  DFHCLEAR  PIC  X  VALUE  '_'.
   848   02  DFHPEN    PIC  X  VALUE  '='.
   849   02  DFHOPID   PIC  X  VALUE  'W'.
   850   02  DFHPA1    PIC  X  VALUE  '%'.
   851   02  DFHPA2    PIC  X  VALUE  '>'.
   852   02  DFHPA3    PIC  X  VALUE  ','.
   853   02  DFHPF1    PIC  X  VALUE  '1'.
   854   02  DFHPF2    PIC  X  VALUE  '2'.
   855   02  DFHPF3    PIC  X  VALUE  '3'.
   856   02  DFHPF4    PIC  X  VALUE  '4'.
   857   02  DFHPF5    PIC  X  VALUE  '5'.
   858   02  DFHPF6    PIC  X  VALUE  '6'.
   859   02  DFHPF7    PIC  X  VALUE  '7'.
   860   02  DFHPF8    PIC  X  VALUE  '8'.
   861   02  DFHPF9    PIC  X  VALUE  '9'.
   862   02  DFHPF10   PIC  X  VALUE  ':'.
   863   02  DFHPF11   PIC  X  VALUE  '#'.
   864   02  DFHPF12   PIC  X  VALUE  '@'.
   865   02  DFHPF13   PIC  X  VALUE  'A'.
   866   02  DFHPF14   PIC  X  VALUE  'B'.
   867   02  DFHPF15   PIC  X  VALUE  'C'.
   868   02  DFHPF16   PIC  X  VALUE  'D'.
   869   02  DFHPF17   PIC  X  VALUE  'E'.
   870   02  DFHPF18   PIC  X  VALUE  'F'.
   871   02  DFHPF19   PIC  X  VALUE  'G'.
   872   02  DFHPF20   PIC  X  VALUE  'H'.
   873   02  DFHPF21   PIC  X  VALUE  'I'.
   874*00039    02  DFHPF22   PIC  X  VALUE  ''.
   875   02  DFHPF22   PIC  X  VALUE  '['.
   876   02  DFHPF23   PIC  X  VALUE  '.'.
   877   02  DFHPF24   PIC  X  VALUE  '<'.
   878   02  DFHMSRE   PIC  X  VALUE  'X'.
   879   02  DFHSTRF   PIC  X  VALUE  'h'.
   880   02  DFHTRIG   PIC  X  VALUE  '"'.
   881 01  FILLER    REDEFINES DFHAID.
   882     12  FILLER                      PIC X(8).
   883     12  PF-VALUES                   PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6525.cbl
   884*                                COPY EL6525S.
   885 01  EL6525AI.
   886     05  FILLER            PIC  X(0012).
   887*    -------------------------------
   888     05  DATEL PIC S9(0004) COMP.
   889     05  DATEF PIC  X(0001).
   890     05  FILLER REDEFINES DATEF.
   891         10  DATEA PIC  X(0001).
   892     05  DATEI PIC  X(0008).
   893*    -------------------------------
   894     05  TIMEL PIC S9(0004) COMP.
   895     05  TIMEF PIC  X(0001).
   896     05  FILLER REDEFINES TIMEF.
   897         10  TIMEA PIC  X(0001).
   898     05  TIMEI PIC  X(0005).
   899*    -------------------------------
   900     05  CMPNYIDL PIC S9(0004) COMP.
   901     05  CMPNYIDF PIC  X(0001).
   902     05  FILLER REDEFINES CMPNYIDF.
   903         10  CMPNYIDA PIC  X(0001).
   904     05  CMPNYIDI PIC  X(0003).
   905*    -------------------------------
   906     05  USERIDL PIC S9(0004) COMP.
   907     05  USERIDF PIC  X(0001).
   908     05  FILLER REDEFINES USERIDF.
   909         10  USERIDA PIC  X(0001).
   910     05  USERIDI PIC  X(0004).
   911*    -------------------------------
   912     05  MAINTYPL PIC S9(0004) COMP.
   913     05  MAINTYPF PIC  X(0001).
   914     05  FILLER REDEFINES MAINTYPF.
   915         10  MAINTYPA PIC  X(0001).
   916     05  MAINTYPI PIC  X(0001).
   917*    -------------------------------
   918     05  DELTOL PIC S9(0004) COMP.
   919     05  DELTOF PIC  X(0001).
   920     05  FILLER REDEFINES DELTOF.
   921         10  DELTOA PIC  X(0001).
   922     05  DELTOI PIC  X(0004).
   923*    -------------------------------
   924     05  RGIDL PIC S9(0004) COMP.
   925     05  RGIDF PIC  X(0001).
   926     05  FILLER REDEFINES RGIDF.
   927         10  RGIDA PIC  X(0001).
   928     05  RGIDI PIC  X(0012).
   929*    -------------------------------
   930     05  ACCTNL PIC S9(0004) COMP.
   931     05  ACCTNF PIC  X(0001).
   932     05  FILLER REDEFINES ACCTNF.
   933         10  ACCTNA PIC  X(0001).
   934     05  ACCTNI PIC  X(0035).
   935*    -------------------------------
   936     05  CONTNL PIC S9(0004) COMP.
   937     05  CONTNF PIC  X(0001).
   938     05  FILLER REDEFINES CONTNF.
   939         10  CONTNA PIC  X(0001).
   940     05  CONTNI PIC  X(0035).
   941*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6525.cbl
   942     05  ADDR1L PIC S9(0004) COMP.
   943     05  ADDR1F PIC  X(0001).
   944     05  FILLER REDEFINES ADDR1F.
   945         10  ADDR1A PIC  X(0001).
   946     05  ADDR1I PIC  X(0030).
   947*    -------------------------------
   948     05  ADDR2L PIC S9(0004) COMP.
   949     05  ADDR2F PIC  X(0001).
   950     05  FILLER REDEFINES ADDR2F.
   951         10  ADDR2A PIC  X(0001).
   952     05  ADDR2I PIC  X(0030).
   953*    -------------------------------
   954     05  CITYL PIC S9(0004) COMP.
   955     05  CITYF PIC  X(0001).
   956     05  FILLER REDEFINES CITYF.
   957         10  CITYA PIC  X(0001).
   958     05  CITYI PIC  X(0030).
   959*    -------------------------------
   960     05  STL PIC S9(0004) COMP.
   961     05  STF PIC  X(0001).
   962     05  FILLER REDEFINES STF.
   963         10  STA PIC  X(0001).
   964     05  STI PIC  X(0002).
   965*    -------------------------------
   966     05  ZIPL PIC S9(0004) COMP.
   967     05  ZIPF PIC  X(0001).
   968     05  FILLER REDEFINES ZIPF.
   969         10  ZIPA PIC  X(0001).
   970     05  ZIPI PIC  X(0009).
   971*    -------------------------------
   972     05  NETL PIC S9(0004) COMP.
   973     05  NETF PIC  X(0001).
   974     05  FILLER REDEFINES NETF.
   975         10  NETA PIC  X(0001).
   976     05  NETI PIC  X(0001).
   977*    -------------------------------
   978     05  SEPL PIC S9(0004) COMP.
   979     05  SEPF PIC  X(0001).
   980     05  FILLER REDEFINES SEPF.
   981         10  SEPA PIC  X(0001).
   982     05  SEPI PIC  X(0001).
   983*    -------------------------------
   984     05  SI1L PIC S9(0004) COMP.
   985     05  SI1F PIC  X(0001).
   986     05  FILLER REDEFINES SI1F.
   987         10  SI1A PIC  X(0001).
   988     05  SI1I PIC  X(0070).
   989*    -------------------------------
   990     05  SI2L PIC S9(0004) COMP.
   991     05  SI2F PIC  X(0001).
   992     05  FILLER REDEFINES SI2F.
   993         10  SI2A PIC  X(0001).
   994     05  SI2I PIC  X(0070).
   995*    -------------------------------
   996     05  SI3L PIC S9(0004) COMP.
   997     05  SI3F PIC  X(0001).
   998     05  FILLER REDEFINES SI3F.
   999         10  SI3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6525.cbl
  1000     05  SI3I PIC  X(0070).
  1001*    -------------------------------
  1002     05  SI4L PIC S9(0004) COMP.
  1003     05  SI4F PIC  X(0001).
  1004     05  FILLER REDEFINES SI4F.
  1005         10  SI4A PIC  X(0001).
  1006     05  SI4I PIC  X(0070).
  1007*    -------------------------------
  1008     05  SI5L PIC S9(0004) COMP.
  1009     05  SI5F PIC  X(0001).
  1010     05  FILLER REDEFINES SI5F.
  1011         10  SI5A PIC  X(0001).
  1012     05  SI5I PIC  X(0070).
  1013*    -------------------------------
  1014     05  ERRMSG1L PIC S9(0004) COMP.
  1015     05  ERRMSG1F PIC  X(0001).
  1016     05  FILLER REDEFINES ERRMSG1F.
  1017         10  ERRMSG1A PIC  X(0001).
  1018     05  ERRMSG1I PIC  X(0071).
  1019*    -------------------------------
  1020     05  ERRMSG2L PIC S9(0004) COMP.
  1021     05  ERRMSG2F PIC  X(0001).
  1022     05  FILLER REDEFINES ERRMSG2F.
  1023         10  ERRMSG2A PIC  X(0001).
  1024     05  ERRMSG2I PIC  X(0071).
  1025*    -------------------------------
  1026     05  PFENTERL PIC S9(0004) COMP.
  1027     05  PFENTERF PIC  X(0001).
  1028     05  FILLER REDEFINES PFENTERF.
  1029         10  PFENTERA PIC  X(0001).
  1030     05  PFENTERI PIC  99.
  1031 01  EL6525AO REDEFINES EL6525AI.
  1032     05  FILLER            PIC  X(0012).
  1033*    -------------------------------
  1034     05  FILLER            PIC  X(0003).
  1035     05  DATEO PIC  X(0008).
  1036*    -------------------------------
  1037     05  FILLER            PIC  X(0003).
  1038     05  TIMEO PIC  99.99.
  1039*    -------------------------------
  1040     05  FILLER            PIC  X(0003).
  1041     05  CMPNYIDO PIC  X(0003).
  1042*    -------------------------------
  1043     05  FILLER            PIC  X(0003).
  1044     05  USERIDO PIC  X(0004).
  1045*    -------------------------------
  1046     05  FILLER            PIC  X(0003).
  1047     05  MAINTYPO PIC  X(0001).
  1048*    -------------------------------
  1049     05  FILLER            PIC  X(0003).
  1050     05  DELTOO PIC  X(0004).
  1051*    -------------------------------
  1052     05  FILLER            PIC  X(0003).
  1053     05  RGIDO PIC  X(0012).
  1054*    -------------------------------
  1055     05  FILLER            PIC  X(0003).
  1056     05  ACCTNO PIC  X(0035).
  1057*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6525.cbl
  1058     05  FILLER            PIC  X(0003).
  1059     05  CONTNO PIC  X(0035).
  1060*    -------------------------------
  1061     05  FILLER            PIC  X(0003).
  1062     05  ADDR1O PIC  X(0030).
  1063*    -------------------------------
  1064     05  FILLER            PIC  X(0003).
  1065     05  ADDR2O PIC  X(0030).
  1066*    -------------------------------
  1067     05  FILLER            PIC  X(0003).
  1068     05  CITYO PIC  X(0030).
  1069*    -------------------------------
  1070     05  FILLER            PIC  X(0003).
  1071     05  STO PIC  X(0002).
  1072*    -------------------------------
  1073     05  FILLER            PIC  X(0003).
  1074     05  ZIPO PIC  X(0009).
  1075*    -------------------------------
  1076     05  FILLER            PIC  X(0003).
  1077     05  NETO PIC  X(0001).
  1078*    -------------------------------
  1079     05  FILLER            PIC  X(0003).
  1080     05  SEPO PIC  X(0001).
  1081*    -------------------------------
  1082     05  FILLER            PIC  X(0003).
  1083     05  SI1O PIC  X(0070).
  1084*    -------------------------------
  1085     05  FILLER            PIC  X(0003).
  1086     05  SI2O PIC  X(0070).
  1087*    -------------------------------
  1088     05  FILLER            PIC  X(0003).
  1089     05  SI3O PIC  X(0070).
  1090*    -------------------------------
  1091     05  FILLER            PIC  X(0003).
  1092     05  SI4O PIC  X(0070).
  1093*    -------------------------------
  1094     05  FILLER            PIC  X(0003).
  1095     05  SI5O PIC  X(0070).
  1096*    -------------------------------
  1097     05  FILLER            PIC  X(0003).
  1098     05  ERRMSG1O PIC  X(0071).
  1099*    -------------------------------
  1100     05  FILLER            PIC  X(0003).
  1101     05  ERRMSG2O PIC  X(0071).
  1102*    -------------------------------
  1103     05  FILLER            PIC  X(0003).
  1104     05  PFENTERO PIC  99.
  1105*    -------------------------------
  1106****************************************************************
  1107*
  1108* Copyright (c) 2007 by Clerity Solutions, Inc.
  1109* All rights reserved.
  1110*
  1111****************************************************************
  1112 01  DFHEIV.
  1113   02  DFHEIV0               PIC X(35).
  1114   02  DFHEIV1               PIC X(08).
  1115   02  DFHEIV2               PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6525.cbl
  1116   02  DFHEIV3               PIC X(08).
  1117   02  DFHEIV4               PIC X(06).
  1118   02  DFHEIV5               PIC X(04).
  1119   02  DFHEIV6               PIC X(04).
  1120   02  DFHEIV7               PIC X(02).
  1121   02  DFHEIV8               PIC X(02).
  1122   02  DFHEIV9               PIC X(01).
  1123   02  DFHEIV10              PIC S9(7) COMP-3.
  1124   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1125   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1126   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1127   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1128   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1129   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1130   02  DFHEIV17              PIC X(04).
  1131   02  DFHEIV18              PIC X(04).
  1132   02  DFHEIV19              PIC X(04).
  1133   02  DFHEIV20              USAGE IS POINTER.
  1134   02  DFHEIV21              USAGE IS POINTER.
  1135   02  DFHEIV22              USAGE IS POINTER.
  1136   02  DFHEIV23              USAGE IS POINTER.
  1137   02  DFHEIV24              USAGE IS POINTER.
  1138   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1139   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1140   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1141   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1142   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1143   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1144   02  FILLER                PIC X(02).
  1145   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1146   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1147   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1148   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1149   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1150 LINKAGE  SECTION.
  1151*****************************************************************
  1152*                                                               *
  1153* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1154* All rights reserved.                                          *
  1155*                                                               *
  1156*****************************************************************
  1157 01  dfheiblk.
  1158     02  eibtime          pic s9(7) comp-3.
  1159     02  eibdate          pic s9(7) comp-3.
  1160     02  eibtrnid         pic x(4).
  1161     02  eibtaskn         pic s9(7) comp-3.
  1162     02  eibtrmid         pic x(4).
  1163     02  dfheigdi         pic s9(4) comp.
  1164     02  eibcposn         pic s9(4) comp.
  1165     02  eibcalen         pic s9(4) comp.
  1166     02  eibaid           pic x(1).
  1167     02  eibfiller1       pic x(1).
  1168     02  eibfn            pic x(2).
  1169     02  eibfiller2       pic x(2).
  1170     02  eibrcode         pic x(6).
  1171     02  eibfiller3       pic x(2).
  1172     02  eibds            pic x(8).
  1173     02  eibreqid         pic x(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6525.cbl
  1174     02  eibrsrce         pic x(8).
  1175     02  eibsync          pic x(1).
  1176     02  eibfree          pic x(1).
  1177     02  eibrecv          pic x(1).
  1178     02  eibsend          pic x(1).
  1179     02  eibatt           pic x(1).
  1180     02  eibeoc           pic x(1).
  1181     02  eibfmh           pic x(1).
  1182     02  eibcompl         pic x(1).
  1183     02  eibsig           pic x(1).
  1184     02  eibconf          pic x(1).
  1185     02  eiberr           pic x(1).
  1186     02  eibrldbk         pic x(1).
  1187     02  eiberrcd         pic x(4).
  1188     02  eibsynrb         pic x(1).
  1189     02  eibnodat         pic x(1).
  1190     02  eibfiller5       pic x(2).
  1191     02  eibresp          pic 9(09) comp.
  1192     02  eibresp2         pic 9(09) comp.
  1193     02  dfheigdj         pic s9(4) comp.
  1194     02  dfheigdk         pic s9(4) comp.
  1195 01  DFHCOMMAREA                     PIC X(1024).
  1196*    COPY ERCCOMP.
  1197******************************************************************
  1198*                                                                *
  1199*                                                                *
  1200*                            ERCCOMP                             *
  1201*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1202*                            VMOD=2.019                          *
  1203*                                                                *
  1204*   ONLINE CREDIT SYSTEM                                         *
  1205*                                                                *
  1206*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1207*                                                                *
  1208*   FILE TYPE = VSAM,KSDS                                        *
  1209*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1210*                                                                *
  1211*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1212*       ALTERNATE PATH = NONE                                    *
  1213*                                                                *
  1214*   LOG = NO                                                     *
  1215*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1216*                                                                *
  1217******************************************************************
  1218*                   C H A N G E   L O G
  1219*
  1220* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1221*-----------------------------------------------------------------
  1222*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1223* EFFECTIVE    NUMBER
  1224*-----------------------------------------------------------------
  1225* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1226* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1227* 092205    2005050300006  PEMA  ADD LEASE FEE
  1228* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1229* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1230* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1231* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6525.cbl
  1232* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1233******************************************************************
  1234
  1235 01  COMPENSATION-MASTER.
  1236     12  CO-RECORD-ID                          PIC XX.
  1237         88  VALID-CO-ID                          VALUE 'CO'.
  1238
  1239     12  CO-CONTROL-PRIMARY.
  1240         16  CO-COMPANY-CD                     PIC X.
  1241         16  CO-CONTROL.
  1242             20  CO-CTL-1.
  1243                 24  CO-CARR-GROUP.
  1244                     28  CO-CARRIER            PIC X.
  1245                     28  CO-GROUPING.
  1246                         32  CO-GROUP-PREFIX   PIC XXX.
  1247                         32  CO-GROUP-PRIME    PIC XXX.
  1248                 24  CO-RESP-NO.
  1249                     28  CO-RESP-PREFIX        PIC X(4).
  1250                     28  CO-RESP-PRIME         PIC X(6).
  1251             20  CO-CTL-2.
  1252                 24  CO-ACCOUNT.
  1253                     28  CO-ACCT-PREFIX        PIC X(4).
  1254                     28  CO-ACCT-PRIME         PIC X(6).
  1255         16  CO-TYPE                           PIC X.
  1256             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1257             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1258             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1259
  1260     12  CO-MAINT-INFORMATION.
  1261         16  CO-LAST-MAINT-DT                  PIC XX.
  1262         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1263         16  CO-LAST-MAINT-USER                PIC X(4).
  1264     12  FILLER                                PIC XX.
  1265     12  CO-STMT-TYPE                          PIC XXX.
  1266     12  CO-COMP-TYPE                          PIC X.
  1267         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1268     12  CO-STMT-OWNER                         PIC X(4).
  1269     12  CO-BALANCE-CONTROL                    PIC X.
  1270         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1271         88  CO-NO-BALANCE                        VALUE 'N'.
  1272
  1273     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1274         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1275         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1276         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1277
  1278     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1279         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1280         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1281
  1282     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1283     12  CO-GA-DIRECT-DEP                      PIC X.
  1284     12  CO-FUTURE-SPACE                       PIC X.
  1285         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1286
  1287     12  CO-ACCT-NAME                          PIC X(30).
  1288     12  CO-MAIL-NAME                          PIC X(30).
  1289     12  CO-ADDR-1                             PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6525.cbl
  1290     12  CO-ADDR-2                             PIC X(30).
  1291     12  CO-ADDR-3.
  1292         16  CO-ADDR-CITY                      PIC X(27).
  1293         16  CO-ADDR-STATE                     PIC XX.
  1294     12  CO-CSO-1099                           PIC X.
  1295     12  CO-ZIP.
  1296         16  CO-ZIP-PRIME.
  1297             20  CO-ZIP-PRI-1ST                PIC X.
  1298                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1299             20  FILLER                        PIC X(4).
  1300         16  CO-ZIP-PLUS4                      PIC X(4).
  1301     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1302         16  CO-CAN-POSTAL-1                   PIC XXX.
  1303         16  CO-CAN-POSTAL-2                   PIC XXX.
  1304         16  FILLER                            PIC XXX.
  1305     12  CO-SOC-SEC                            PIC X(13).
  1306     12  CO-TELEPHONE.
  1307         16  CO-AREA-CODE                      PIC XXX.
  1308         16  CO-PREFIX                         PIC XXX.
  1309         16  CO-PHONE                          PIC X(4).
  1310
  1311     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1312
  1313     12  CO-AR-BAL-LEVEL                       PIC X.
  1314         88  CO-AR-REF-LVL                        VALUE '1'.
  1315         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1316         88  CO-AR-BILL-LVL                       VALUE '2'.
  1317         88  CO-AR-AGT-LVL                        VALUE '3'.
  1318         88  CO-AR-FR-LVL                         VALUE '4'.
  1319
  1320     12  CO-AR-NORMAL-PRINT                    PIC X.
  1321         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1322         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1323
  1324     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1325
  1326     12  CO-AR-REPORTING                       PIC X.
  1327         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1328         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1329
  1330     12  CO-AR-PULL-CHECK                      PIC X.
  1331         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1332         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1333
  1334     12  CO-AR-BALANCE-PRINT                   PIC X.
  1335         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1336
  1337     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1338         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1339         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1340         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1341
  1342     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1343
  1344     12  CO-USER-CODE                          PIC X.
  1345     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1346
  1347******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6525.cbl
  1348*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1349*    THE LAST MONTH END RUN.
  1350******************************************************************
  1351
  1352     12  CO-LAST-ACTIVITY-DATE.
  1353         16  CO-ACT-YEAR                       PIC 99.
  1354         16  CO-ACT-MONTH                      PIC 99.
  1355         16  CO-ACT-DAY                        PIC 99.
  1356
  1357     12  CO-LAST-STMT-DT.
  1358         16  CO-LAST-STMT-YEAR                 PIC 99.
  1359         16  CO-LAST-STMT-MONTH                PIC 99.
  1360         16  CO-LAST-STMT-DAY                  PIC 99.
  1361
  1362     12  CO-MO-END-TOTALS.
  1363         16  CO-MONTHLY-TOTALS.
  1364             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1365             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1366             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1367             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1368             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1369
  1370         16  CO-AGING-TOTALS.
  1371             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1372             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1373             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1374             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1375
  1376         16  CO-YTD-TOTALS.
  1377             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1378             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1379
  1380         16  CO-OVER-UNDER-TOTALS.
  1381             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1382             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1383
  1384     12  CO-MISCELLANEOUS-TOTALS.
  1385         16  CO-FICA-TOTALS.
  1386             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1387             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1388
  1389         16  CO-CLAIM-TOTALS.
  1390             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1391             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1392
  1393******************************************************************
  1394*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1395*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1396******************************************************************
  1397
  1398     12  CO-CURRENT-TOTALS.
  1399         16  CO-CURRENT-LAST-STMT-DT.
  1400             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1401             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1402             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1403
  1404         16  CO-CURRENT-MONTHLY-TOTALS.
  1405             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6525.cbl
  1406             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1407             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1408             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1409             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1410
  1411         16  CO-CURRENT-AGING-TOTALS.
  1412             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1413             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1414             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1415             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1416
  1417         16  CO-CURRENT-YTD-TOTALS.
  1418             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1419             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1420
  1421     12  CO-PAID-COMM-TOTALS.
  1422         16  CO-YTD-PAID-COMMS.
  1423             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1424             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1425
  1426     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1427         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1428         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1429
  1430     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1431         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1432         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1433         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1434         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1435         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1436         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1437         88  CO-FINAL-LETTER                  VALUE 'F'.
  1438         88  CO-RECONCILING                   VALUE 'R'.
  1439         88  CO-PHONE-CALL                    VALUE 'P'.
  1440         88  CO-LEGAL                         VALUE 'L'.
  1441         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1442         88  CO-WRITE-OFF                     VALUE 'W'.
  1443         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1444
  1445     12  CO-CSR-CODE                       PIC X(4).
  1446
  1447     12  CO-GA-STATUS-INFO.
  1448         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1449         16  CO-GA-TERMINATION-DT          PIC XX.
  1450         16  CO-GA-STATUS-CODE             PIC X.
  1451             88  CO-GA-ACTIVE                 VALUE 'A'.
  1452             88  CO-GA-INACTIVE               VALUE 'I'.
  1453             88  CO-GA-PENDING                VALUE 'P'.
  1454         16  CO-GA-COMMENTS.
  1455             20  CO-GA-COMMENT-1           PIC X(40).
  1456             20  CO-GA-COMMENT-2           PIC X(40).
  1457             20  CO-GA-COMMENT-3           PIC X(40).
  1458             20  CO-GA-COMMENT-4           PIC X(40).
  1459
  1460     12  CO-RPTCD2                         PIC X(10).
  1461
  1462     12  CO-TYPE-AGENT                     PIC X(01).
  1463         88  CO-CORPORATION                   VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6525.cbl
  1464         88  CO-PARTNERSHIP                   VALUE 'P'.
  1465         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1466         88  CO-TRUST                         VALUE 'T'.
  1467         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1468
  1469     12  CO-FAXNO.
  1470         16  CO-FAX-AREA-CODE                  PIC XXX.
  1471         16  CO-FAX-PREFIX                     PIC XXX.
  1472         16  CO-FAX-PHONE                      PIC X(4).
  1473
  1474     12  CO-BANK-INFORMATION.
  1475         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1476         16  CO-BANK-TRANSIT-NON REDEFINES
  1477             CO-BANK-TRANSIT-NO                PIC 9(8).
  1478
  1479         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1480     12  CO-MISC-DEDUCT-INFO REDEFINES
  1481                  CO-BANK-INFORMATION.
  1482         16  CO-MD-GL-ACCT                     PIC X(10).
  1483         16  CO-MD-DIV                         PIC XX.
  1484         16  CO-MD-CENTER                      PIC X(4).
  1485         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1486         16  CO-CREATE-AP-CHECK                PIC X.
  1487         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1488         16  FILLER                            PIC XXX.
  1489     12  CO-ACH-STATUS                         PIC X.
  1490         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1491         88  CO-ACH-PENDING                        VALUE 'P'.
  1492
  1493     12  CO-BILL-SW                            PIC X.
  1494     12  CO-CONTROL-NAME                       PIC X(30).
  1495     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1496     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1497     12  CO-CLP-STATE                          PIC XX.
  1498     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1499     12  CO-SPP-REFUND-EDIT                    PIC X.
  1500
  1501******************************************************************
  1502*    COPY ERCCOBI.
  1503******************************************************************
  1504*                                                                *
  1505*                                                                *
  1506*                            ERCCOBI                             *
  1507*                                                                *
  1508*   ONLINE CREDIT SYSTEM                                         *
  1509*                                                                *
  1510*   FILE DESCRIPTION = COMPENSATION MASTER BILLING INSTRUCTIONS  *
  1511*                                                                *
  1512*   FILE TYPE = VSAM,KSDS                                        *
  1513*   RECORD SIZE = 620   RECFORM = FIXED                          *
  1514*                                                                *
  1515*   BASE CLUSTER NAME = ERCOBI                   RKP=2,LEN=17    *
  1516*       ALTERNATE PATH = NONE                                    *
  1517*                                                                *
  1518*   LOG = NO                                                     *
  1519*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1520*                                                                *
  1521******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6525.cbl
  1522*                   C H A N G E   L O G
  1523*
  1524* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1525*-----------------------------------------------------------------
  1526*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1527* EFFECTIVE    NUMBER
  1528*-----------------------------------------------------------------
  1529* 081808    2008061100001  PEMA  NEW FILE FOR BILLING INSTRUCTIONS
  1530******************************************************************
  1531 01  COMP-BILLING-INSTRUCTIONS.
  1532     12  BL-RECORD-ID                          PIC XX.
  1533         88  VALID-BL-ID                          VALUE 'BL'.
  1534     12  BL-CONTROL-PRIMARY.
  1535         16  BL-COMPANY-CD                     PIC X.
  1536         16  BL-STMT-OWNER                     PIC X(4).
  1537         16  BL-REPORT-GROUP-ID                PIC X(12).
  1538     12  BL-MAINT-INFORMATION.
  1539         16  BL-LAST-MAINT-DT                  PIC XX.
  1540         16  BL-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1541         16  BL-LAST-MAINT-USER                PIC X(4).
  1542         16  FILLER                            PIC X(10).
  1543     12  BL-ACCOUNT-NAME                       PIC X(35).
  1544     12  BL-CONTACT-NAME                       PIC X(35).
  1545     12  BL-ADDR1                              PIC X(30).
  1546     12  BL-ADDR2                              PIC X(30).
  1547     12  BL-CITY                               PIC X(30).
  1548     12  BL-STATE                              PIC XX.
  1549     12  BL-ZIP.
  1550         16  BL-ZIP-PRIME.
  1551             20  BL-ZIP-PRI-1ST                PIC X.
  1552                 88  BL-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1553             20  FILLER                        PIC X(4).
  1554         16  BL-ZIP-PLUS4                      PIC X(4).
  1555     12  BL-CANADIAN-POSTAL-CODE  REDEFINES  BL-ZIP.
  1556         16  BL-CAN-POSTAL-1                   PIC XXX.
  1557         16  BL-CAN-POSTAL-2                   PIC XXX.
  1558         16  FILLER                            PIC XXX.
  1559*    12  FILLER                                PIC X(30).
  1560     12  BL-CHECK-HANDLING                     PIC X.
  1561         88  BL-CHECKS-NET                VALUE '1' ' '.
  1562         88  BL-CHECKS-SEPARATE           VALUE '2'.
  1563     12  BL-SPECIAL-INSTRUCTIONS.
  1564         16  BL-SI-LINE-1                      PIC X(70).
  1565         16  BL-SI-LINE-2                      PIC X(70).
  1566         16  BL-SI-LINE-3                      PIC X(70).
  1567         16  BL-SI-LINE-4                      PIC X(70).
  1568         16  BL-SI-LINE-5                      PIC X(70).
  1569     12  FILLER                                PIC X(59).
  1570
  1571******************************************************************
  1572*    COPY ELCACHP.
  1573******************************************************************
  1574*                                                                *
  1575*                           ELCACHP                              *
  1576*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1577*                            VMOD=2.002                          *
  1578*                                                                *
  1579*   FILE DESCRIPTION = ACH PRE-NOTIFICATION                      *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6525.cbl
  1580*                                                                *
  1581*   FILE TYPE = VSAM,KSDS                                        *
  1582*   RECORD SIZE = 120  RECFORM = FIXED                           *
  1583*                                                                *
  1584*   BASE CLUSTER = ELACHP                         RKP=2,LEN=29   *
  1585*       ALTERNATE (NONE)                                         *
  1586*                                                                *
  1587*   LOG = YES                                                    *
  1588*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1589*                                                                *
  1590*  NO  CID  MODS  IN  COPYBOOK  ELCACHP                          *
  1591******************************************************************
  1592
  1593 01  ACH-PRENOTIFICATION.
  1594     12  AP-RECORD-ID                      PIC XX.
  1595         88  VALID-AP-ID                      VALUE 'AP'.
  1596
  1597******************************************************************
  1598*   BASE CLUSTER = ELACHP         (BASE KEY)      RKP=2,LEN=29   *
  1599******************************************************************
  1600
  1601     12  AP-CONTROL-PRIMARY.
  1602         16  AP-CONTROL-CD                 PIC X.
  1603         16  AP-CARRIER                    PIC X.
  1604         16  AP-GROUPING                   PIC X(6).
  1605         16  AP-FIN-RESP                   PIC X(10).
  1606         16  AP-ACCT-AGENT                 PIC X(10).
  1607         16  AP-CO-TYPE                    PIC X.
  1608
  1609     12  AP-CONTROL-ALT   REDEFINES  AP-CONTROL-PRIMARY.
  1610         16  AP-COMPANY-CD-ALT             PIC X.
  1611         16  AP-BENEFICIARY                PIC X(10).
  1612         16  FILLER                        PIC X(18).
  1613
  1614******************************************************************
  1615*                 FILE SYNCHRONIZATION DATA                      *
  1616******************************************************************
  1617
  1618     12  AP-FILE-SYNCH-DATA.
  1619         16  AP-LAST-CHANGE-DT             PIC XX.
  1620         16  AP-LAST-CHANGE-TIME           PIC S9(7)  COMP-3.
  1621         16  AP-LAST-CHANGE-PROCESSOR      PIC X(4).
  1622
  1623******************************************************************
  1624*                     PRENOTE INFORMATION
  1625******************************************************************
  1626
  1627     12  AP-BANK-INFORMATION.
  1628         16  AP-TRANSIT-NUMBER             PIC X(8).
  1629         16  AP-BANK-ACCOUNT-NO            PIC X(17).
  1630         16  AP-BANK-NAME                  PIC X(23).
  1631
  1632     12  FILLER                            PIC X(31).
  1633
  1634******************************************************************
  1635*    COPY ELCBANK.
  1636******************************************************************
  1637*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6525.cbl
  1638*                           ELCBANK                              *
  1639*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1640*                            VMOD=2.002                          *
  1641*                                                                *
  1642*   FILE DESCRIPTION = BANK MASTER FILE                          *
  1643*                                                                *
  1644*   FILE TYPE = VSAM,KSDS                                        *
  1645*   RECORD SIZE = 210  RECFORM = FIXED                           *
  1646*                                                                *
  1647*   BASE CLUSTER = ELBANK                         RKP=2,LEN=9    *
  1648*       ALTERNATE (NONE)                                         *
  1649*                                                                *
  1650*   LOG = YES                                                    *
  1651*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1652*                                                                *
  1653*  NO  CID  MODS  IN  COPYBOOK  ELCBANK                          *
  1654******************************************************************
  1655
  1656 01  BANK-MASTER.
  1657     12  BM-RECORD-ID                      PIC XX.
  1658         88  VALID-BM-ID                      VALUE 'BM'.
  1659
  1660******************************************************************
  1661*   BASE CLUSTER = MPBANK         (BASE KEY)      RKP=2,LEN=9    *
  1662******************************************************************
  1663
  1664     12  BM-CONTROL-PRIMARY.
  1665         16  BM-COMPANY-CD                 PIC X.
  1666         16  BM-TRANSIT-NUMBER.
  1667             20  BM-FEDERAL-NUMBER         PIC X(4).
  1668             20  BM-BANK-NUMBER            PIC X(4).
  1669     12  FILLER                            PIC X(20).
  1670
  1671******************************************************************
  1672*                 FILE SYNCHRONIZATION DATA                      *
  1673******************************************************************
  1674
  1675     12  BM-FILE-SYNCH-DATA.
  1676         16  BM-LAST-CHANGE-DT             PIC XX.
  1677         16  BM-LAST-CHANGE-TIME           PIC S9(7)  COMP-3.
  1678         16  BM-LAST-CHANGE-PROCESSOR      PIC X(4).
  1679
  1680******************************************************************
  1681*                       BANK INFORMATION                         *
  1682******************************************************************
  1683
  1684     12  BM-BANK-INFORMATION.
  1685         16  BM-NAME                       PIC X(30).
  1686         16  BM-ADDRESS1                   PIC X(30).
  1687         16  BM-ADDRESS2                   PIC X(30).
  1688         16  BM-CITY                       PIC X(25).
  1689         16  BM-STATE                      PIC X(25).
  1690         16  BM-ZIP.
  1691             20  BM-ZIP1                   PIC X(5).
  1692             20  BM-ZIP2                   PIC X(4).
  1693     12  FILLER                            PIC X(20).
  1694
  1695******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6525.cbl
  1696 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  1697                          COMPENSATION-MASTER
  1698                          COMP-BILLING-INSTRUCTIONS
  1699                          ACH-PRENOTIFICATION BANK-MASTER.
  1700 0000-DFHEXIT SECTION.
  1701     MOVE '9#                    $   ' TO DFHEIV0.
  1702     MOVE 'EL6525' TO DFHEIV1.
  1703     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1704     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1705     MOVE '5'                    TO DC-OPTION-CODE.
  1706     PERFORM 9700-DATE-CONVERT THRU 9700-EXIT.
  1707     MOVE DC-GREG-DATE-1-EDIT    TO WS-SAVE-DATE.
  1708     MOVE DC-BIN-DATE-1          TO WS-SAVE-BIN-DT.
  1709     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  1710     MOVE EIBTRMID               TO QID-TERM.
  1711     MOVE +2                     TO EMI-NUMBER-OF-LINES.
  1712     MOVE SPACE                  TO SUPPRESS-MAP-SW.
  1713     IF EIBCALEN = 0
  1714         GO TO 8800-UNAUTHORIZED-ACCESS.
  1715     MOVE LOW-VALUES             TO EL6525AI.
  1716     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1717         MOVE PI-SAVED-PROGRAM-5 TO  PI-SAVED-PROGRAM-6
  1718         MOVE PI-SAVED-PROGRAM-4 TO  PI-SAVED-PROGRAM-5
  1719         MOVE PI-SAVED-PROGRAM-3 TO  PI-SAVED-PROGRAM-4
  1720         MOVE PI-SAVED-PROGRAM-2 TO  PI-SAVED-PROGRAM-3
  1721         MOVE PI-SAVED-PROGRAM-1 TO  PI-SAVED-PROGRAM-2
  1722         MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  1723         MOVE PI-CALLING-PROGRAM TO  PI-RETURN-TO-PROGRAM
  1724         MOVE THIS-PGM           TO  PI-CALLING-PROGRAM.
  1725     IF EIBTRNID NOT = TRANS-ID
  1726        MOVE 'S'                 TO MAINTYPO
  1727        MOVE AL-UANON            TO MAINTYPA
  1728        MOVE -1                  TO MAINTYPL
  1729        MOVE PI-ERCOBI-STMT-OWNER
  1730                                 TO DELTOI
  1731        MOVE +4                  TO DELTOL
  1732        MOVE AL-UANON            TO DELTOA
  1733        MOVE PI-ERCOBI-RGID      TO RGIDI
  1734        MOVE +12                 TO RGIDL
  1735        MOVE AL-UANON            TO RGIDA
  1736        GO TO 4000-SHOW
  1737     END-IF
  1738
  1739* EXEC CICS HANDLE CONDITION
  1740*        PGMIDERR  (9600-PGMID-ERROR)
  1741*        ERROR     (9990-ABEND)
  1742*    END-EXEC.
  1743*    MOVE '"$L.                  ! " #00001734' TO DFHEIV0
  1744     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1745     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1746     MOVE X'2220233030303031373334' TO DFHEIV0(25:11)
  1747     CALL 'kxdfhei1' USING DFHEIV0
  1748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1749
  1750     IF EIBAID = DFHCLEAR
  1751         GO TO 9400-CLEAR.
  1752     .
  1753 0200-RECEIVE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6525.cbl
  1754     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1755         MOVE ER-0008            TO EMI-ERROR
  1756         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1757         MOVE -1                 TO PFENTERL
  1758         GO TO 8200-SEND-DATAONLY.
  1759
  1760* EXEC CICS RECEIVE
  1761*        MAP      (MAP-NAME)
  1762*        MAPSET   (MAPSET-NAME)
  1763*        INTO     (EL6525AI)
  1764*    END-EXEC.
  1765     MOVE LENGTH OF
  1766      EL6525AI
  1767       TO DFHEIV11
  1768*    MOVE '8"T I  L              ''   #00001747' TO DFHEIV0
  1769     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1770     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1771     MOVE X'2020233030303031373437' TO DFHEIV0(25:11)
  1772     CALL 'kxdfhei1' USING DFHEIV0,
  1773           MAP-NAME,
  1774           EL6525AI,
  1775           DFHEIV11,
  1776           MAPSET-NAME,
  1777           DFHEIV99,
  1778           DFHEIV99
  1779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1780
  1781     IF PFENTERL = 0
  1782         GO TO 0300-CHECK-PFKEYS.
  1783     IF EIBAID NOT = DFHENTER
  1784         MOVE ER-0004            TO EMI-ERROR
  1785         GO TO 0320-INPUT-ERROR.
  1786     IF (PFENTERI NUMERIC) AND (PFENTERI GREATER 0 AND LESS 25)
  1787         MOVE PF-VALUES (PFENTERI) TO EIBAID
  1788     ELSE
  1789         MOVE ER-0029              TO EMI-ERROR
  1790         GO TO 0320-INPUT-ERROR.
  1791 0300-CHECK-PFKEYS.
  1792     IF EIBAID = DFHPF23
  1793         GO TO 8810-PF23.
  1794     IF EIBAID = DFHPF24
  1795         GO TO 9200-RETURN-MAIN-MENU.
  1796     IF EIBAID = DFHPF12
  1797         GO TO 9500-PF12.
  1798     IF EIBAID = DFHENTER
  1799         GO TO 0330-CHECK-MAINTYP.
  1800     MOVE ER-0029                TO EMI-ERROR.
  1801 0320-INPUT-ERROR.
  1802     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1803     MOVE AL-UNBON               TO PFENTERA.
  1804     MOVE -1                     TO PFENTERL.
  1805     GO TO 8200-SEND-DATAONLY.
  1806 0330-CHECK-MAINTYP.
  1807     IF MAINTYPL > 0
  1808        IF MAINTYPI = 'S' OR 'C' OR 'A' OR 'D'
  1809           MOVE AL-UANON       TO MAINTYPA
  1810           MOVE MAINTYPI       TO PI-MAINT
  1811        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6525.cbl
  1812           MOVE -1             TO MAINTYPL
  1813           MOVE AL-UABON       TO MAINTYPA
  1814           MOVE ER-2039        TO EMI-ERROR
  1815           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1816           GO TO 8200-SEND-DATAONLY
  1817        END-IF
  1818     ELSE
  1819        MOVE -1                 TO MAINTYPL
  1820        MOVE AL-UABON           TO MAINTYPA
  1821        MOVE ER-2039            TO EMI-ERROR
  1822        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1823        GO TO 8200-SEND-DATAONLY
  1824     END-IF
  1825     IF DELTOL > 0
  1826        MOVE DELTOI              TO PI-ERCOBI-STMT-OWNER
  1827     END-IF
  1828     IF RGIDL > 0
  1829        MOVE RGIDI               TO PI-ERCOBI-RGID
  1830     END-IF
  1831     IF PI-MAINT = 'S'
  1832         GO TO 4000-SHOW.
  1833     IF PI-MAINT = 'D'
  1834        GO TO 4600-DELETE
  1835     END-IF
  1836     IF PI-MAINT = 'A'
  1837        GO TO 4200-ADD
  1838     END-IF
  1839     IF PI-MAINT = 'C'
  1840        GO TO 4400-CHANGE
  1841     END-IF
  1842     .
  1843 4000-SHOW.
  1844     MOVE PI-COMPANY-CD          TO PI-ERCOBI-COMPANY-CD
  1845     IF DELTOL > 0
  1846        MOVE DELTOI              TO PI-ERCOBI-STMT-OWNER
  1847     END-IF
  1848     IF RGIDL > 0
  1849        MOVE RGIDI               TO PI-ERCOBI-RGID
  1850     END-IF
  1851     PERFORM 7100-READ-ERCOBI    THRU 7100-EXIT
  1852     IF RESP-NOTOPEN
  1853        MOVE ER-2233             TO EMI-ERROR
  1854        PERFORM 9900-ERROR-FORMAT
  1855                                 THRU 9900-EXIT
  1856     ELSE
  1857        IF RESP-NOTFND
  1858           MOVE ER-7462          TO EMI-ERROR
  1859           MOVE -1               TO DELTOL
  1860           PERFORM 9900-ERROR-FORMAT
  1861                                 THRU 9900-EXIT
  1862        END-IF
  1863     END-IF
  1864     IF EMI-NO-ERRORS
  1865        CONTINUE
  1866     ELSE
  1867        GO TO 8200-SEND-DATAONLY
  1868     END-IF
  1869     MOVE LOW-VALUES             TO EL6525AO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6525.cbl
  1870     GO TO 5000-BUILD-INITIAL-SCREEN
  1871     .
  1872 4200-ADD.
  1873     IF PI-ERCOBI-KEY = PI-SAVE-ERCOBI-KEY
  1874        MOVE ER-2057             TO EMI-ERROR
  1875        PERFORM 9900-ERROR-FORMAT
  1876                                 THRU  9900-EXIT
  1877        MOVE -1                  TO MAINTYPL
  1878        GO TO 8200-SEND-DATAONLY
  1879     END-IF
  1880     PERFORM 7000-EDIT  THRU  7000-EXIT.
  1881     IF EMI-NO-ERRORS
  1882        CONTINUE
  1883     ELSE
  1884        GO TO 8200-SEND-DATAONLY
  1885     END-IF
  1886     PERFORM 7100-READ-ERCOBI    THRU 7100-EXIT
  1887     IF RESP-NOTOPEN
  1888        MOVE ER-2233             TO EMI-ERROR
  1889        PERFORM 9900-ERROR-FORMAT
  1890                                 THRU 9900-EXIT
  1891     ELSE
  1892        IF RESP-NOTFND
  1893           GO TO 4250-CONT
  1894        END-IF
  1895     END-IF
  1896     IF EMI-NO-ERRORS
  1897        CONTINUE
  1898     ELSE
  1899        GO TO 8200-SEND-DATAONLY
  1900     END-IF
  1901     MOVE ER-2057                TO  EMI-ERROR.
  1902     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  1903     MOVE LOW-VALUES             TO  PI-SAVE-ERCOBI-KEY.
  1904     MOVE -1                     TO  MAINTYPL.
  1905     GO TO 8200-SEND-DATAONLY.
  1906 4250-CONT.
  1907     PERFORM 7150-ERCOBI-GETMAIN  THRU  7150-EXIT.
  1908     MOVE SPACES                 TO  COMP-BILLING-INSTRUCTIONS
  1909     MOVE 'BL'                   TO BL-RECORD-ID
  1910     MOVE PI-COMPANY-CD          TO BL-COMPANY-CD
  1911     PERFORM 6000-CHECK-FOR-UPDATE  THRU  6000-EXIT
  1912     MOVE PI-PROCESSOR-ID        TO  BL-LAST-MAINT-USER.
  1913     MOVE EIBTIME                TO  BL-LAST-MAINT-HHMMSS.
  1914     MOVE WS-SAVE-BIN-DT         TO  BL-LAST-MAINT-DT
  1915
  1916* EXEC CICS WRITE
  1917*        DATASET  (ERCOBI-FILE-ID)
  1918*        FROM     (COMP-BILLING-INSTRUCTIONS)
  1919*        RIDFLD   (BL-CONTROL-PRIMARY)
  1920*    END-EXEC.
  1921     MOVE LENGTH OF
  1922      COMP-BILLING-INSTRUCTIONS
  1923       TO DFHEIV11
  1924*    MOVE '&$ L                  ''   #00001886' TO DFHEIV0
  1925     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  1926     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1927     MOVE X'2020233030303031383836' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6525.cbl
  1928     CALL 'kxdfhei1' USING DFHEIV0,
  1929           ERCOBI-FILE-ID,
  1930           COMP-BILLING-INSTRUCTIONS,
  1931           DFHEIV11,
  1932           BL-CONTROL-PRIMARY,
  1933           DFHEIV99,
  1934           DFHEIV99
  1935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1936
  1937     MOVE ER-0000                TO  EMI-ERROR.
  1938     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  1939     MOVE LOW-VALUES             TO  EL6525AO
  1940     MOVE PI-ERCOBI-STMT-OWNER   TO DELTOO
  1941     MOVE PI-ERCOBI-RGID         TO RGIDO
  1942     MOVE AL-UANON               TO DELTOA RGIDA
  1943     GO TO 5000-BUILD-INITIAL-SCREEN.
  1944 4200-EXIT.
  1945     EXIT.
  1946 4400-CHANGE.
  1947     IF PI-ERCOBI-KEY = PI-SAVE-ERCOBI-KEY
  1948        CONTINUE
  1949     ELSE
  1950        MOVE ER-2056             TO EMI-ERROR
  1951        PERFORM 9900-ERROR-FORMAT
  1952                                 THRU 9900-EXIT
  1953        MOVE -1                  TO MAINTYPL
  1954        GO TO 8200-SEND-DATAONLY
  1955     END-IF
  1956     PERFORM 7000-EDIT  THRU  7000-EXIT
  1957     IF EMI-NO-ERRORS
  1958         NEXT SENTENCE
  1959     ELSE
  1960         GO TO 8200-SEND-DATAONLY.
  1961     PERFORM 7300-READ-ERCOBI-UPDATE  THRU  7300-EXIT
  1962     PERFORM 6000-CHECK-FOR-UPDATE  THRU  6000-EXIT
  1963     IF (BL-LAST-MAINT-USER   = PI-UPDATE-BY)
  1964        OR (BL-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS)
  1965        CONTINUE
  1966     ELSE
  1967
  1968* EXEC CICS UNLOCK
  1969*            DATASET  (ERCOBI-FILE-ID)
  1970*       END-EXEC
  1971*    MOVE '&*                    #   #00001921' TO DFHEIV0
  1972     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  1973     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1974     MOVE X'2020233030303031393231' TO DFHEIV0(25:11)
  1975     CALL 'kxdfhei1' USING DFHEIV0,
  1976           ERCOBI-FILE-ID,
  1977           DFHEIV99
  1978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1979        MOVE ER-0068             TO EMI-ERROR
  1980        PERFORM 9900-ERROR-FORMAT
  1981                                 THRU 9900-EXIT
  1982        GO TO 8200-SEND-DATAONLY
  1983     END-IF
  1984     MOVE PI-PROCESSOR-ID        TO  BL-LAST-MAINT-USER.
  1985     MOVE EIBTIME                TO  BL-LAST-MAINT-HHMMSS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6525.cbl
  1986     MOVE WS-SAVE-BIN-DT         TO  BL-LAST-MAINT-DT
  1987     MOVE SPACE                  TO  DC-OPTION-CODE.
  1988
  1989* EXEC CICS REWRITE
  1990*        DATASET  (ERCOBI-FILE-ID)
  1991*        FROM     (COMP-BILLING-INSTRUCTIONS)
  1992*    END-EXEC
  1993     MOVE LENGTH OF
  1994      COMP-BILLING-INSTRUCTIONS
  1995       TO DFHEIV11
  1996*    MOVE '&& L                  %   #00001933' TO DFHEIV0
  1997     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1998     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1999     MOVE X'2020233030303031393333' TO DFHEIV0(25:11)
  2000     CALL 'kxdfhei1' USING DFHEIV0,
  2001           ERCOBI-FILE-ID,
  2002           COMP-BILLING-INSTRUCTIONS,
  2003           DFHEIV11,
  2004           DFHEIV99
  2005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2006     MOVE ER-0000                TO  EMI-ERROR.
  2007     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  2008     MOVE LOW-VALUES             TO EL6525AO
  2009     MOVE PI-ERCOBI-STMT-OWNER   TO DELTOO
  2010     MOVE PI-ERCOBI-RGID         TO RGIDO
  2011     MOVE AL-UANON               TO DELTOA RGIDA
  2012     GO TO 5000-BUILD-INITIAL-SCREEN.
  2013 4400-EXIT.
  2014     EXIT.
  2015 4600-DELETE.
  2016     IF PI-ERCOBI-KEY = PI-SAVE-ERCOBI-KEY
  2017        CONTINUE
  2018     ELSE
  2019        MOVE ER-2056             TO EMI-ERROR
  2020        PERFORM 9900-ERROR-FORMAT
  2021                                 THRU 9900-EXIT
  2022        MOVE -1                  TO MAINTYPL
  2023        GO TO 8200-SEND-DATAONLY
  2024     END-IF
  2025     PERFORM 7300-READ-ERCOBI-UPDATE THRU 7300-EXIT
  2026     IF (BL-LAST-MAINT-USER   = PI-UPDATE-BY)
  2027        AND (BL-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS)
  2028        CONTINUE
  2029     ELSE
  2030
  2031* EXEC CICS UNLOCK
  2032*          DATASET  (ERCOBI-FILE-ID)
  2033*       END-EXEC
  2034*    MOVE '&*                    #   #00001961' TO DFHEIV0
  2035     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  2036     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2037     MOVE X'2020233030303031393631' TO DFHEIV0(25:11)
  2038     CALL 'kxdfhei1' USING DFHEIV0,
  2039           ERCOBI-FILE-ID,
  2040           DFHEIV99
  2041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2042        MOVE ER-0068             TO EMI-ERROR
  2043        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6525.cbl
  2044                                 THRU 9900-EXIT
  2045        GO TO 8200-SEND-DATAONLY
  2046     END-IF
  2047
  2048* EXEC CICS DELETE
  2049*       DATASET  (ERCOBI-FILE-ID)
  2050*    END-EXEC
  2051*    MOVE '&(                    &   #00001969' TO DFHEIV0
  2052     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2053     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2054     MOVE X'2020233030303031393639' TO DFHEIV0(25:11)
  2055     CALL 'kxdfhei1' USING DFHEIV0,
  2056           ERCOBI-FILE-ID,
  2057           DFHEIV99,
  2058           DFHEIV99,
  2059           DFHEIV99,
  2060           DFHEIV99
  2061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2062     MOVE ER-0000                TO  EMI-ERROR
  2063     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  2064     MOVE LOW-VALUES             TO EL6525AO
  2065     MOVE PI-ERCOBI-STMT-OWNER   TO DELTOO
  2066     MOVE PI-ERCOBI-RGID         TO RGIDO
  2067     MOVE AL-UANON               TO DELTOA RGIDA
  2068     MOVE LOW-VALUES             TO PI-SAVE-ERCOBI-KEY
  2069     GO TO 8100-SEND-INITIAL-MAP
  2070     .
  2071 4600-EXIT.
  2072     EXIT.
  2073 5000-BUILD-INITIAL-SCREEN.
  2074     MOVE PI-ERCOBI-KEY          TO PI-SAVE-ERCOBI-KEY
  2075     MOVE BL-LAST-MAINT-USER     TO PI-UPDATE-BY
  2076     IF BL-LAST-MAINT-HHMMSS NUMERIC
  2077        MOVE BL-LAST-MAINT-HHMMSS
  2078                                 TO PI-UPDATE-HHMMSS
  2079     ELSE
  2080        MOVE ZEROS               TO PI-UPDATE-HHMMSS
  2081     END-IF
  2082     MOVE BL-STMT-OWNER          TO DELTOO
  2083     MOVE BL-REPORT-GROUP-ID     TO RGIDO
  2084     MOVE BL-ACCOUNT-NAME        TO ACCTNO
  2085     MOVE BL-CONTACT-NAME        TO CONTNO
  2086     MOVE BL-ADDR1               TO ADDR1O
  2087     MOVE BL-ADDR2               TO ADDR2O
  2088     MOVE BL-CITY                TO CITYO
  2089     MOVE BL-STATE               TO STO
  2090     MOVE BL-ZIP                 TO ZIPO
  2091     IF BL-CHECKS-SEPARATE
  2092        MOVE 'X'                 TO SEPO
  2093        MOVE ' '                 TO NETO
  2094     ELSE
  2095        MOVE 'X'                 TO NETO
  2096        MOVE ' '                 TO SEPO
  2097     END-IF
  2098     MOVE BL-SI-LINE-1           TO SI1O
  2099     MOVE BL-SI-LINE-2           TO SI2O
  2100     MOVE BL-SI-LINE-3           TO SI3O
  2101     MOVE BL-SI-LINE-4           TO SI4O
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6525.cbl
  2102     MOVE BL-SI-LINE-5           TO SI5O
  2103     MOVE PI-MAINT               TO MAINTYPO
  2104     MOVE AL-UANOF               TO MAINTYPA
  2105     MOVE -1                     TO MAINTYPL
  2106     GO TO 8100-SEND-INITIAL-MAP
  2107     .
  2108 5099-EXIT.
  2109     EXIT.
  2110 6000-CHECK-FOR-UPDATE.
  2111     IF DELTOL > ZERO
  2112        MOVE DELTOI              TO BL-STMT-OWNER
  2113     END-IF
  2114     IF RGIDL > ZERO
  2115        MOVE RGIDI               TO BL-REPORT-GROUP-ID
  2116     END-IF
  2117     IF ACCTNL > ZERO
  2118        MOVE ACCTNI              TO BL-ACCOUNT-NAME
  2119     END-IF
  2120     IF CONTNL > ZERO
  2121        MOVE CONTNI              TO BL-CONTACT-NAME
  2122     END-IF
  2123     IF ADDR1L > ZERO
  2124        MOVE ADDR1I              TO BL-ADDR1
  2125     END-IF
  2126     IF ADDR2L > ZERO
  2127        MOVE ADDR2I              TO BL-ADDR2
  2128     END-IF
  2129     IF CITYL > ZERO
  2130        MOVE CITYI               TO BL-CITY
  2131     END-IF
  2132     IF STL > ZERO
  2133        MOVE STI                 TO BL-STATE
  2134     END-IF
  2135     IF ZIPL > ZERO
  2136        MOVE ZIPI                TO BL-ZIP
  2137     END-IF
  2138     IF (NETL > ZERO)
  2139        AND (NETI = 'X' OR 'Y')
  2140        MOVE '1'                 TO BL-CHECK-HANDLING
  2141     ELSE
  2142        IF (SEPL > ZERO)
  2143           AND (SEPI = 'X' OR 'Y')
  2144           MOVE '2'              TO BL-CHECK-HANDLING
  2145        END-IF
  2146     END-IF
  2147     IF SI1L > ZERO
  2148        MOVE SI1I                TO BL-SI-LINE-1
  2149     END-IF
  2150     IF SI2L > ZERO
  2151        MOVE SI2I                TO BL-SI-LINE-2
  2152     END-IF
  2153     IF SI3L > ZERO
  2154        MOVE SI3I                TO BL-SI-LINE-3
  2155     END-IF
  2156     IF SI4L > ZERO
  2157        MOVE SI4I                TO BL-SI-LINE-4
  2158     END-IF
  2159     IF SI5L > ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6525.cbl
  2160        MOVE SI5I                TO BL-SI-LINE-5
  2161     END-IF
  2162     .
  2163 6000-EXIT.
  2164     EXIT.
  2165 7000-EDIT.
  2166     IF NETL > 0
  2167        IF NETI = ' ' OR 'X' OR 'Y'
  2168           CONTINUE
  2169        ELSE
  2170           MOVE -1               TO NETL
  2171           MOVE AL-UABON         TO NETA
  2172           MOVE ER-9999          TO EMI-ERROR
  2173           PERFORM 9900-ERROR-FORMAT
  2174                                 THRU 9900-EXIT
  2175        END-IF
  2176     END-IF
  2177     IF SEPL > 0
  2178        IF SEPI = ' ' OR 'X' OR 'Y'
  2179           CONTINUE
  2180        ELSE
  2181           MOVE -1               TO SEPL
  2182           MOVE AL-UABON         TO SEPA
  2183           MOVE ER-9999          TO EMI-ERROR
  2184           PERFORM 9900-ERROR-FORMAT
  2185                                 THRU 9900-EXIT
  2186        END-IF
  2187     END-IF
  2188     .
  2189 7000-EXIT.
  2190     EXIT.
  2191 7100-READ-ERCOBI.
  2192
  2193* EXEC CICS READ
  2194*         DATASET  (ERCOBI-FILE-ID)
  2195*         SET      (ADDRESS OF COMP-BILLING-INSTRUCTIONS)
  2196*         RIDFLD   (PI-ERCOBI-KEY)
  2197*         RESP     (WS-RESPONSE)
  2198*    END-EXEC.
  2199*    MOVE '&"S        E          (  N#00002102' TO DFHEIV0
  2200     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2201     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2202     MOVE X'204E233030303032313032' TO DFHEIV0(25:11)
  2203     CALL 'kxdfhei1' USING DFHEIV0,
  2204           ERCOBI-FILE-ID,
  2205           DFHEIV20,
  2206           DFHEIV99,
  2207           PI-ERCOBI-KEY,
  2208           DFHEIV99,
  2209           DFHEIV99,
  2210           DFHEIV99
  2211     SET ADDRESS OF COMP-BILLING-INSTRUCTIONS TO
  2212         DFHEIV20
  2213     MOVE EIBRESP  TO WS-RESPONSE
  2214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2215
  2216     IF RESP-NORMAL
  2217        MOVE BL-LAST-MAINT-USER     TO PI-UPDATE-BY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6525.cbl
  2218        MOVE BL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS
  2219        MOVE BL-CONTROL-PRIMARY     TO PI-ERCOBI-KEY
  2220        MOVE BL-STMT-OWNER          TO DELTOO
  2221        MOVE BL-REPORT-GROUP-ID     TO RGIDO
  2222     END-IF
  2223     .
  2224 7100-EXIT.
  2225     EXIT.
  2226 7150-ERCOBI-GETMAIN.
  2227
  2228* EXEC CICS GETMAIN
  2229*       SET  (ADDRESS OF COMP-BILLING-INSTRUCTIONS)
  2230*       LENGTH  (650)
  2231*       RESP    (WS-RESPONSE)
  2232*    END-EXEC
  2233     MOVE 650
  2234       TO DFHEIV11
  2235*    MOVE '," L                  $  N#00002119' TO DFHEIV0
  2236     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  2237     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2238     MOVE X'204E233030303032313139' TO DFHEIV0(25:11)
  2239     CALL 'kxdfhei1' USING DFHEIV0,
  2240           DFHEIV20,
  2241           DFHEIV11,
  2242           DFHEIV99
  2243     SET ADDRESS OF COMP-BILLING-INSTRUCTIONS TO
  2244         DFHEIV20
  2245     MOVE EIBRESP  TO WS-RESPONSE
  2246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2247     .
  2248 7150-EXIT.
  2249     EXIT.
  2250 7300-READ-ERCOBI-UPDATE.
  2251
  2252* EXEC CICS HANDLE CONDITION
  2253*        NOTFND  (7300-NOTFND)
  2254*        NOTOPEN (7300-NOTOPEN)
  2255*    END-EXEC.
  2256*    MOVE '"$IJ                  ! # #00002128' TO DFHEIV0
  2257     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  2258     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2259     MOVE X'2320233030303032313238' TO DFHEIV0(25:11)
  2260     CALL 'kxdfhei1' USING DFHEIV0
  2261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2262
  2263
  2264* EXEC CICS READ
  2265*         DATASET  (ERCOBI-FILE-ID)
  2266*         SET      (ADDRESS OF COMP-BILLING-INSTRUCTIONS)
  2267*         RIDFLD   (PI-ERCOBI-KEY)
  2268*         UPDATE
  2269*    END-EXEC.
  2270*    MOVE '&"S        EU         (   #00002132' TO DFHEIV0
  2271     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2272     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2273     MOVE X'2020233030303032313332' TO DFHEIV0(25:11)
  2274     CALL 'kxdfhei1' USING DFHEIV0,
  2275           ERCOBI-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6525.cbl
  2276           DFHEIV20,
  2277           DFHEIV99,
  2278           PI-ERCOBI-KEY,
  2279           DFHEIV99,
  2280           DFHEIV99,
  2281           DFHEIV99
  2282     SET ADDRESS OF COMP-BILLING-INSTRUCTIONS TO
  2283         DFHEIV20
  2284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2285
  2286     GO TO 7300-EXIT.
  2287 7300-NOTOPEN.
  2288     MOVE ER-2233               TO EMI-ERROR
  2289     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2290     GO TO 7300-EXIT.
  2291 7300-NOTFND.
  2292     MOVE ER-7462               TO EMI-ERROR
  2293     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2294     .
  2295 7300-EXIT.
  2296     EXIT.
  2297******************************************************************
  2298 8100-SEND-INITIAL-MAP.
  2299     MOVE WS-SAVE-DATE           TO DATEO.
  2300     MOVE EIBTIME                TO TIME-IN.
  2301     MOVE TIME-OUT               TO TIMEO.
  2302     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  2303     MOVE PI-PROCESSOR-ID        TO USERIDO.
  2304     MOVE -1                     TO MAINTYPL.
  2305     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  2306
  2307* EXEC CICS SEND
  2308*        MAP      (MAP-NAME)
  2309*        MAPSET   (MAPSET-NAME)
  2310*        FROM     (EL6525AO)
  2311*        ERASE
  2312*        CURSOR
  2313*    END-EXEC.
  2314     MOVE LENGTH OF
  2315      EL6525AO
  2316       TO DFHEIV12
  2317     MOVE -1
  2318       TO DFHEIV11
  2319*    MOVE '8$     CT  E    H L F ,   #00002158' TO DFHEIV0
  2320     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2321     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2322     MOVE X'2020233030303032313538' TO DFHEIV0(25:11)
  2323     CALL 'kxdfhei1' USING DFHEIV0,
  2324           MAP-NAME,
  2325           EL6525AO,
  2326           DFHEIV12,
  2327           MAPSET-NAME,
  2328           DFHEIV99,
  2329           DFHEIV99,
  2330           DFHEIV99,
  2331           DFHEIV11,
  2332           DFHEIV99,
  2333           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6525.cbl
  2334           DFHEIV99
  2335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2336
  2337     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6525.cbl
  2339 8200-SEND-DATAONLY.
  2340     IF EIBTRNID NOT = TRANS-ID
  2341        GO TO 8100-SEND-INITIAL-MAP
  2342     END-IF
  2343     MOVE WS-SAVE-DATE           TO DATEO.
  2344     MOVE EIBTIME                TO TIME-IN.
  2345     MOVE TIME-OUT               TO TIMEO.
  2346     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  2347     MOVE PI-PROCESSOR-ID        TO USERIDO.
  2348     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  2349
  2350* EXEC CICS SEND
  2351*        MAP      (MAP-NAME)
  2352*        MAPSET   (MAPSET-NAME)
  2353*        FROM     (EL6525AO)
  2354*        DATAONLY
  2355*        CURSOR
  2356*    END-EXEC.
  2357     MOVE LENGTH OF
  2358      EL6525AO
  2359       TO DFHEIV12
  2360     MOVE -1
  2361       TO DFHEIV11
  2362*    MOVE '8$D    CT       H L F ,   #00002177' TO DFHEIV0
  2363     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2364     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2365     MOVE X'2020233030303032313737' TO DFHEIV0(25:11)
  2366     CALL 'kxdfhei1' USING DFHEIV0,
  2367           MAP-NAME,
  2368           EL6525AO,
  2369           DFHEIV12,
  2370           MAPSET-NAME,
  2371           DFHEIV99,
  2372           DFHEIV99,
  2373           DFHEIV99,
  2374           DFHEIV11,
  2375           DFHEIV99,
  2376           DFHEIV99,
  2377           DFHEIV99
  2378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2379
  2380     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6525.cbl
  2382 8300-SEND-TEXT.
  2383
  2384* EXEC CICS SEND TEXT
  2385*        FROM     (LOGOFF-TEXT)
  2386*        LENGTH   (LOGOFF-LENGTH)
  2387*        ERASE
  2388*        FREEKB
  2389*    END-EXEC.
  2390*    MOVE '8&      T  E F  H   F -   #00002187' TO DFHEIV0
  2391     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2392     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2393     MOVE X'2020233030303032313837' TO DFHEIV0(25:11)
  2394     CALL 'kxdfhei1' USING DFHEIV0,
  2395           LOGOFF-TEXT,
  2396           LOGOFF-LENGTH,
  2397           DFHEIV99,
  2398           DFHEIV99,
  2399           DFHEIV99,
  2400           DFHEIV99,
  2401           DFHEIV99,
  2402           DFHEIV99,
  2403           DFHEIV99,
  2404           DFHEIV99,
  2405           DFHEIV99,
  2406           DFHEIV99
  2407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2408
  2409
  2410* EXEC CICS RETURN
  2411*    END-EXEC.
  2412*    MOVE '.(                    &   #00002193' TO DFHEIV0
  2413     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2414     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2415     MOVE X'2020233030303032313933' TO DFHEIV0(25:11)
  2416     CALL 'kxdfhei1' USING DFHEIV0,
  2417           DFHEIV99,
  2418           DFHEIV99,
  2419           DFHEIV99,
  2420           DFHEIV99,
  2421           DFHEIV99
  2422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2423
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6525.cbl
  2425 8600-DEEDIT.
  2426
  2427* EXEC CICS BIF DEEDIT
  2428*         FIELD(DEEDIT-FIELD)
  2429*         LENGTH(15)
  2430*    END-EXEC.
  2431     MOVE 15
  2432       TO DFHEIV11
  2433*    MOVE '@"L                   #   #00002197' TO DFHEIV0
  2434     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2435     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2436     MOVE X'2020233030303032313937' TO DFHEIV0(25:11)
  2437     CALL 'kxdfhei1' USING DFHEIV0,
  2438           DEEDIT-FIELD,
  2439           DFHEIV11
  2440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2441
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6525.cbl
  2443 8800-UNAUTHORIZED-ACCESS.
  2444     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  2445     GO TO 8300-SEND-TEXT.
  2446 8810-PF23.
  2447     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  2448     MOVE XCTL-005               TO PGM-NAME.
  2449     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6525.cbl
  2451 9100-RETURN-TRAN.
  2452     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  2453     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  2454
  2455* EXEC CICS RETURN
  2456*        TRANSID    (TRANS-ID)
  2457*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2458*        LENGTH     (WS-COMM-LENGTH)
  2459*    END-EXEC.
  2460*    MOVE '.(CT                  &   #00002213' TO DFHEIV0
  2461     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2462     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2463     MOVE X'2020233030303032323133' TO DFHEIV0(25:11)
  2464     CALL 'kxdfhei1' USING DFHEIV0,
  2465           TRANS-ID,
  2466           PROGRAM-INTERFACE-BLOCK,
  2467           WS-COMM-LENGTH,
  2468           DFHEIV99,
  2469           DFHEIV99
  2470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2471
  2472 9200-RETURN-MAIN-MENU.
  2473     MOVE XCTL-626               TO PGM-NAME.
  2474     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6525.cbl
  2476 9300-XCTL.
  2477
  2478* EXEC CICS XCTL
  2479*        PROGRAM    (PGM-NAME)
  2480*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2481*        LENGTH     (WS-COMM-LENGTH)
  2482*    END-EXEC.
  2483*    MOVE '.$C                   $   #00002223' TO DFHEIV0
  2484     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2485     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2486     MOVE X'2020233030303032323233' TO DFHEIV0(25:11)
  2487     CALL 'kxdfhei1' USING DFHEIV0,
  2488           PGM-NAME,
  2489           PROGRAM-INTERFACE-BLOCK,
  2490           WS-COMM-LENGTH
  2491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2492
  2493 9400-CLEAR.
  2494     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  2495     GO TO 9300-XCTL.
  2496 9500-PF12.
  2497     MOVE XCTL-010               TO PGM-NAME.
  2498     GO TO 9300-XCTL.
  2499 9600-PGMID-ERROR.
  2500
  2501* EXEC CICS HANDLE CONDITION
  2502*        PGMIDERR    (8300-SEND-TEXT)
  2503*    END-EXEC.
  2504*    MOVE '"$L                   ! $ #00002235' TO DFHEIV0
  2505     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2506     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2507     MOVE X'2420233030303032323335' TO DFHEIV0(25:11)
  2508     CALL 'kxdfhei1' USING DFHEIV0
  2509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2510
  2511     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  2512     MOVE ' '                    TO PI-ENTRY-CD-1.
  2513     MOVE XCTL-005               TO PGM-NAME.
  2514     MOVE PGM-NAME               TO LOGOFF-PGM.
  2515     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  2516     GO TO 9300-XCTL.
  2517 9700-DATE-CONVERT.
  2518
  2519* EXEC CICS LINK
  2520*        PROGRAM    ('ELDATCV')
  2521*        COMMAREA   (DATE-CONVERSION-DATA)
  2522*        LENGTH     (DC-COMM-LENGTH)
  2523*    END-EXEC.
  2524     MOVE 'ELDATCV' TO DFHEIV1
  2525*    MOVE '."C                   ''   #00002245' TO DFHEIV0
  2526     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2527     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2528     MOVE X'2020233030303032323435' TO DFHEIV0(25:11)
  2529     CALL 'kxdfhei1' USING DFHEIV0,
  2530           DFHEIV1,
  2531           DATE-CONVERSION-DATA,
  2532           DC-COMM-LENGTH,
  2533           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6525.cbl
  2534           DFHEIV99,
  2535           DFHEIV99
  2536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2537
  2538 9700-EXIT.
  2539     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6525.cbl
  2541 9900-ERROR-FORMAT.
  2542     IF NOT EMI-ERRORS-COMPLETE
  2543         MOVE LINK-001           TO PGM-NAME
  2544
  2545* EXEC CICS LINK
  2546*            PROGRAM    (PGM-NAME)
  2547*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  2548*            LENGTH     (EMI-COMM-LENGTH)
  2549*        END-EXEC.
  2550*    MOVE '."C                   ''   #00002256' TO DFHEIV0
  2551     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2552     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2553     MOVE X'2020233030303032323536' TO DFHEIV0(25:11)
  2554     CALL 'kxdfhei1' USING DFHEIV0,
  2555           PGM-NAME,
  2556           ERROR-MESSAGE-INTERFACE-BLOCK,
  2557           EMI-COMM-LENGTH,
  2558           DFHEIV99,
  2559           DFHEIV99,
  2560           DFHEIV99
  2561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2562
  2563 9900-EXIT.
  2564     EXIT.
  2565 9990-ABEND.
  2566     MOVE LINK-004               TO PGM-NAME.
  2567     MOVE DFHEIBLK               TO EMI-LINE1.
  2568
  2569* EXEC CICS LINK
  2570*        PROGRAM   (PGM-NAME)
  2571*        COMMAREA  (EMI-LINE1)
  2572*        LENGTH    (72)
  2573*    END-EXEC.
  2574     MOVE 72
  2575       TO DFHEIV11
  2576*    MOVE '."C                   ''   #00002266' TO DFHEIV0
  2577     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2578     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2579     MOVE X'2020233030303032323636' TO DFHEIV0(25:11)
  2580     CALL 'kxdfhei1' USING DFHEIV0,
  2581           PGM-NAME,
  2582           EMI-LINE1,
  2583           DFHEIV11,
  2584           DFHEIV99,
  2585           DFHEIV99,
  2586           DFHEIV99
  2587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2588
  2589     GO TO 8200-SEND-DATAONLY.
  2590 9995-SECURITY-VIOLATION.
  2591*           COPY ELCSCTP.
  2592******************************************************************
  2593*                                                                *
  2594*                            ELCSCTP                             *
  2595*                            VMOD=2.001                          *
  2596*                                                                *
  2597*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2598******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6525.cbl
  2599
  2600
  2601     MOVE EIBDATE          TO SM-JUL-DATE.
  2602     MOVE EIBTRMID         TO SM-TERMID.
  2603     MOVE THIS-PGM         TO SM-PGM.
  2604     MOVE EIBTIME          TO TIME-IN.
  2605     MOVE TIME-OUT         TO SM-TIME.
  2606     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2607
  2608
  2609* EXEC CICS LINK
  2610*         PROGRAM  ('EL003')
  2611*         COMMAREA (SECURITY-MESSAGE)
  2612*         LENGTH   (80)
  2613*    END-EXEC.
  2614     MOVE 'EL003' TO DFHEIV1
  2615     MOVE 80
  2616       TO DFHEIV11
  2617*    MOVE '."C                   ''   #00002290' TO DFHEIV0
  2618     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2619     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2620     MOVE X'2020233030303032323930' TO DFHEIV0(25:11)
  2621     CALL 'kxdfhei1' USING DFHEIV0,
  2622           DFHEIV1,
  2623           SECURITY-MESSAGE,
  2624           DFHEIV11,
  2625           DFHEIV99,
  2626           DFHEIV99,
  2627           DFHEIV99
  2628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2629
  2630
  2631******************************************************************
  2632
  2633 9995-EXIT.
  2634      EXIT.
  2635
  2636 9999-DFHBACK SECTION.
  2637     MOVE '9%                    "   ' TO DFHEIV0
  2638     MOVE 'EL6525' TO DFHEIV1
  2639     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2640     GOBACK.
  2641 9999-DFHEXIT.
  2642     IF DFHEIGDJ EQUAL 0001
  2643         NEXT SENTENCE
  2644     ELSE IF DFHEIGDJ EQUAL 2
  2645         GO TO 9600-PGMID-ERROR,
  2646               9990-ABEND
  2647         DEPENDING ON DFHEIGDI
  2648     ELSE IF DFHEIGDJ EQUAL 3
  2649         GO TO 7300-NOTFND,
  2650               7300-NOTOPEN
  2651         DEPENDING ON DFHEIGDI
  2652     ELSE IF DFHEIGDJ EQUAL 4
  2653         GO TO 8300-SEND-TEXT
  2654         DEPENDING ON DFHEIGDI.
  2655     MOVE '9%                    "   ' TO DFHEIV0
  2656     MOVE 'EL6525' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6525.cbl
  2657     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2658     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4372     Code:        5839
