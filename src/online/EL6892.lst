* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6892.cbl
* Options: int("EL6892.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6892.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6892.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6892.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL6892.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:59:40.
     7*                            VMOD=2.010.
     8*
     9*AUTHOR.           LOGIC,INC.
    10*                  DALLAS,TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6892.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            * THIS PROGRAM IS THE PROPERTY OF LOCIC, INC. *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS. TRANSACTION EXH5 - HARDCOPY PRINT PROGRAM
    25*        THIS PROGRAM IS USED TO PRINT LETTERS TO THE COMPANY
    26*        SPECIFIED PRINTER. IT IS ACTIVATED THROUGH THE START
    27*        COMMAND AND WILL HAVE THE INTERFACE BLOCK PASSED.
    28*        DATA IN THE INTERFACE BLOCK WILL INDICATE THE NUMBER OF
    29*        LINES TO PRINT AND THE NUMBER OF COPIES.
    30*        IT WILL ALSO CONTAIN THE TEMP STORAGE ID TO USE IN ORDER
    31*        TO RETRIEVE THE DATA TO BE PRINTED.
    32******************************************************************
    33*                   C H A N G E   L O G
    34*
    35* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    36*-----------------------------------------------------------------
    37*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    38* EFFECTIVE    NUMBER
    39*-----------------------------------------------------------------
    40* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    41******************************************************************
    42 ENVIRONMENT DIVISION.
    43 DATA DIVISION.
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46 77  THIS-PGM PIC X(8) VALUE 'EL6892'.
    47 77  FILLER  PIC X(32) VALUE '********************************'.
    48 77  FILLER  PIC X(32) VALUE '*   EL6892 WORKING STORAGE     *'.
    49 77  FILLER  PIC X(32) VALUE '******* VMOD=2.010 *************'.
    50
    51 01  W-CONSTANTS.
    52     12  FILLER                  PIC  X(18)
    53                             VALUE 'PROGRAM CONSTANTS:'.
    54
    55     12  W-ENTRIES-PER-RECORD    PIC  9(03) COMP-3 VALUE 50.
    56     12  W-TS-LENGTH             PIC S9(04) COMP VALUE +3650.
    57
    58     12  W-PGM-EL689             PIC  X(08) VALUE 'EL689'.
    59     12  W-TOP-OF-FORM-MESSAGE   PIC  X(08) VALUE '*****TOP'.
    60     12  W-TOP-FORM              PIC  X(01) VALUE '1'.
    61
    62 01  W-WORK-AREAS.
    63     12  FILLER                  PIC  X(18)
    64                             VALUE 'PROGRAM WORK AREA:'.
    65
    66     12  W-ASKTIME-CTR           PIC S9(04)  COMP.
    67     12  W-NDX                   PIC  9(02).
    68     12  W-RECORDS-PRINTED       PIC S9(03) COMP-3 VALUE 0.
    69     12  W-TS-ITEM               PIC  S9(04) COMP.
    70
    71     12  W-ERROR-LINE            PIC  X(70).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6892.cbl
    72     12  W-NEXT-TRAN             PIC  X(04).
    73     12  W-TERMINAL-ID.
    74         18  W-TERM-PREFIX       PIC  X(02).
    75         18  FILLER              PIC  X(02).
    76
    77     12  W-ADJUST-AREA.
    78         16  FILLER              PIC  X(07).
    79         16  W-AD-PRINT-AREA     PIC  X(70).
    80         16  FILLER              PIC  X(08).
    81
    82     12  W-TS-WORK-AREA          PIC X(3650).
    83     12  W-REC-ENTRIES REDEFINES W-TS-WORK-AREA.
    84         16  W-REC-ENT OCCURS 50 TIMES INDEXED BY W-TB-NDX.
    85             20  W-REC-TEXT.
    86                 24  W-REC-TEXT-TOP
    87                                 PIC  X(08).
    88                 24  FILLER      PIC  X(62).
    89             20  W-REC-PC        PIC  9(02).
    90             20  W-REC-SC        PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6892.cbl
    92 01  FILLER                      PIC  X(25)
    93                             VALUE 'PROGRAM INTERFACE STARTS:'.
    94*    COPY ELCINTF.
    95******************************************************************
    96*                                                                *
    97*                                                                *
    98*                            ELCINTF.                            *
    99*                            VMOD=2.017                          *
   100*                                                                *
   101*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   102*                                                                *
   103*       LENGTH = 1024                                            *
   104*                                                                *
   105******************************************************************
   106 01  PROGRAM-INTERFACE-BLOCK.
   107     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   108     12  PI-CALLING-PROGRAM              PIC X(8).
   109     12  PI-SAVED-PROGRAM-1              PIC X(8).
   110     12  PI-SAVED-PROGRAM-2              PIC X(8).
   111     12  PI-SAVED-PROGRAM-3              PIC X(8).
   112     12  PI-SAVED-PROGRAM-4              PIC X(8).
   113     12  PI-SAVED-PROGRAM-5              PIC X(8).
   114     12  PI-SAVED-PROGRAM-6              PIC X(8).
   115     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   116     12  PI-COMPANY-ID                   PIC XXX.
   117     12  PI-COMPANY-CD                   PIC X.
   118
   119     12  PI-COMPANY-PASSWORD             PIC X(8).
   120
   121     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   122
   123     12  PI-CONTROL-IN-PROGRESS.
   124         16  PI-CARRIER                  PIC X.
   125         16  PI-GROUPING                 PIC X(6).
   126         16  PI-STATE                    PIC XX.
   127         16  PI-ACCOUNT                  PIC X(10).
   128         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   129                                         PIC X(10).
   130         16  PI-CLAIM-CERT-GRP.
   131             20  PI-CLAIM-NO             PIC X(7).
   132             20  PI-CERT-NO.
   133                 25  PI-CERT-PRIME       PIC X(10).
   134                 25  PI-CERT-SFX         PIC X.
   135             20  PI-CERT-EFF-DT          PIC XX.
   136         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   137             20  PI-PLAN-CODE            PIC X(2).
   138             20  PI-REVISION-NUMBER      PIC X(3).
   139             20  PI-PLAN-EFF-DT          PIC X(2).
   140             20  PI-PLAN-EXP-DT          PIC X(2).
   141             20  FILLER                  PIC X(11).
   142         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   143             20  PI-OE-REFERENCE-1.
   144                 25  PI-OE-REF-1-PRIME   PIC X(18).
   145                 25  PI-OE-REF-1-SUFF    PIC XX.
   146
   147     12  PI-SESSION-IN-PROGRESS          PIC X.
   148         88  CLAIM-SESSION                   VALUE '1'.
   149         88  CREDIT-SESSION                  VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6892.cbl
   150         88  WARRANTY-SESSION                VALUE '3'.
   151         88  MORTGAGE-SESSION                VALUE '4'.
   152         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   153
   154
   155*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   156
   157     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   158     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   159
   160     12  PI-CREDIT-USER                  PIC X.
   161         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   162         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   163
   164     12  PI-CLAIM-USER                   PIC X.
   165         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   166         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   167
   168     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   169         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   170         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   171         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   172         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   173         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   174
   175     12  PI-PROCESSOR-ID                 PIC X(4).
   176
   177     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   178
   179     12  PI-MEMBER-CAPTION               PIC X(10).
   180
   181     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   182         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   183
   184     12  PI-LIFE-OVERRIDE-L1             PIC X.
   185     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   186     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   187     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   188
   189     12  PI-AH-OVERRIDE-L1               PIC X.
   190     12  PI-AH-OVERRIDE-L2               PIC XX.
   191     12  PI-AH-OVERRIDE-L6               PIC X(6).
   192     12  PI-AH-OVERRIDE-L12              PIC X(12).
   193
   194     12  PI-NEW-SYSTEM                   PIC X(2).
   195
   196     12  PI-PRIMARY-CERT-NO              PIC X(11).
   197     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   198         88  PI-USES-PAID-TO                 VALUE '1'.
   199     12  PI-CRDTCRD-SYSTEM.
   200         16  PI-CRDTCRD-USER             PIC X.
   201             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   202             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   203         16  PI-CC-MONTH-END-DT          PIC XX.
   204     12  PI-PROCESSOR-PRINTER            PIC X(4).
   205
   206     12  PI-OE-REFERENCE-2.
   207         16  PI-OE-REF-2-PRIME           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6892.cbl
   208         16  PI-OE-REF-2-SUFF            PIC X.
   209
   210     12  PI-REM-TRM-CALC-OPTION          PIC X.
   211
   212     12  PI-LANGUAGE-TYPE                PIC X.
   213             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   214             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   215             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   216
   217     12  PI-POLICY-LINKAGE-IND           PIC X.
   218         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   219         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   220                                                   LOW-VALUES.
   221
   222     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   223     12  PI-CLAIM-PW-SESSION             PIC X(1).
   224         88  PI-CLAIM-CREDIT                 VALUE '1'.
   225         88  PI-CLAIM-CONVEN                 VALUE '2'.
   226     12  FILLER                          PIC X(4).
   227
   228     12  PI-SYSTEM-LEVEL                 PIC X(145).
   229
   230     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   231         PI-SYSTEM-LEVEL.
   232
   233         16  PI-ENTRY-CODES.
   234             20  PI-ENTRY-CD-1           PIC X.
   235             20  PI-ENTRY-CD-2           PIC X.
   236
   237         16  PI-RETURN-CODES.
   238             20  PI-RETURN-CD-1          PIC X.
   239             20  PI-RETURN-CD-2          PIC X.
   240
   241         16  PI-UPDATE-STATUS-SAVE.
   242             20  PI-UPDATE-BY            PIC X(4).
   243             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   244
   245         16  PI-LOWER-CASE-LETTERS       PIC X.
   246             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   247
   248*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   249*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   250*            88  CARRIER-CLM-CNTL            VALUE '2'.
   251
   252         16  PI-CERT-ACCESS-CONTROL      PIC X.
   253             88  ST-ACCNT-CNTL               VALUE ' '.
   254             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   255             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   256             88  ACCNT-CNTL                  VALUE '3'.
   257             88  CARR-ACCNT-CNTL             VALUE '4'.
   258
   259         16  PI-PROCESSOR-CAP-LIST.
   260             20  PI-SYSTEM-CONTROLS.
   261                24 PI-SYSTEM-DISPLAY     PIC X.
   262                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   263                24 PI-SYSTEM-MODIFY      PIC X.
   264                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   265             20  FILLER                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6892.cbl
   266             20  PI-DISPLAY-CAP          PIC X.
   267                 88  DISPLAY-CAP             VALUE 'Y'.
   268             20  PI-MODIFY-CAP           PIC X.
   269                 88  MODIFY-CAP              VALUE 'Y'.
   270             20  PI-MSG-AT-LOGON-CAP     PIC X.
   271                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   272             20  PI-FORCE-CAP            PIC X.
   273                 88  FORCE-CAP               VALUE 'Y'.
   274
   275         16  PI-PROGRAM-CONTROLS.
   276             20  PI-PGM-PRINT-OPT        PIC X.
   277             20  PI-PGM-FORMAT-OPT       PIC X.
   278             20  PI-PGM-PROCESS-OPT      PIC X.
   279             20  PI-PGM-TOTALS-OPT       PIC X.
   280
   281         16  PI-HELP-INTERFACE.
   282             20  PI-LAST-ERROR-NO        PIC X(4).
   283             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   284
   285         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   286             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   287
   288         16  PI-CR-CONTROL-IN-PROGRESS.
   289             20  PI-CR-CARRIER           PIC X.
   290             20  PI-CR-GROUPING          PIC X(6).
   291             20  PI-CR-STATE             PIC XX.
   292             20  PI-CR-ACCOUNT           PIC X(10).
   293             20  PI-CR-FIN-RESP          PIC X(10).
   294             20  PI-CR-TYPE              PIC X.
   295
   296         16  PI-CR-BATCH-NUMBER          PIC X(6).
   297
   298         16  PI-CR-MONTH-END-DT          PIC XX.
   299
   300         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   301             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   302             88  PI-ZERO-CARRIER             VALUE '1'.
   303             88  PI-ZERO-GROUPING            VALUE '2'.
   304             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   305
   306         16  PI-CARRIER-SECURITY         PIC X.
   307             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   308
   309         16  PI-ACCOUNT-SECURITY         PIC X(10).
   310             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   311             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   312
   313         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   314             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   315                                         INDEXED BY PI-ACCESS-NDX
   316                                         PIC X.
   317
   318         16  PI-GA-BILLING-CONTROL       PIC X.
   319             88  PI-GA-BILLING               VALUE '1'.
   320
   321         16  PI-MAIL-PROCESSING          PIC X.
   322             88  PI-MAIL-YES                 VALUE 'Y'.
   323
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6892.cbl
   324         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   325
   326         16  PI-AR-SYSTEM.
   327             20  PI-AR-PROCESSING-CNTL   PIC X.
   328                 88  PI-AR-PROCESSING        VALUE 'Y'.
   329             20  PI-AR-SUMMARY-CODE      PIC X(6).
   330             20  PI-AR-MONTH-END-DT      PIC XX.
   331
   332         16  PI-MP-SYSTEM.
   333             20  PI-MORTGAGE-USER            PIC X.
   334                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   335                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   336             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   337                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   338                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   339                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   340                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   341                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   342             20  PI-MP-MONTH-END-DT          PIC XX.
   343             20  PI-MP-REFERENCE-NO.
   344                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   345                 24  PI-MP-REFERENCE-SFX     PIC XX.
   346
   347         16  PI-LABEL-CONTROL            PIC X(01).
   348             88  PI-CREATE-LABELS                    VALUE 'Y'.
   349             88  PI-BYPASS-LABELS                    VALUE 'N'.
   350
   351         16  PI-BILL-GROUPING-CODE       PIC X(01).
   352             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   353
   354         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   355             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   356             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   357
   358         16  FILLER                      PIC X(14).
   359
   360     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   361******************************************************************
   362     12  PI-WA  REDEFINES PI-PROGRAM-WORK-AREA.
   363*    COPY ELC1042.
   364******************************************************************
   365*                                                                *
   366*                                                                *
   367*                           ELC1042                              *
   368*                            VMOD=2.002                          *
   369*                                                                *
   370*    NOTE                                                        *
   371*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   372*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   373*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   374*        TO THESE PROGRAMS.                                      *
   375*                                                                *
   376*    NOTE                                                        *
   377*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   378*        USE ONLY!                                               *
   379*                                                                *
   380******************************************************************
   381
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6892.cbl
   382         16  PI-1042-WA.
   383             20  PI-ACTION       PIC  X(01).
   384                 88 PI-SHOW-MODE           VALUE '1'.
   385                 88 PI-CLEAR-MODE          VALUE '2'.
   386                 88 PI-CREATE-MODE         VALUE '3'.
   387             20  PI-COMM-CONTROL PIC  X(12).
   388             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   389             20  PI-EOF-SW       PIC  X(01).
   390                 88  PI-FILE-EOF           VALUE 'Y'.
   391             20  PI-FILETYP      PIC  X(01).
   392             20  PI-FORM-SQUEEZE-CONTROL
   393                                 PIC  X(01).
   394                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   395                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   396             20  PI-LAST-CONTROL PIC  X(12).
   397             20  PI-TEMP-STOR-ITEMS
   398                                 PIC S9(04) COMP.
   399             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   400             20  PI-UPDATE-SW    PIC  9(01).
   401                 88 ANY-UPDATES            VALUE 1.
   402             20  PI-104-SCREEN-SENT-IND
   403                                 PIC  X(01).
   404                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   405                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   406             20  PI-1042-SCREEN-SENT-IND
   407                                 PIC  X(01).
   408                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   409                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   410             20  PI-1042-ARCHIVE-IND
   411                                 PIC  X(01).
   412                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   413             20  FILLER          PIC  X(29).
   414*    COPY ELC689PI.
   415******************************************************************
   416*                                                                *
   417*                            ELC689PI                            *
   418*                            VMOD=2.003                          *
   419*                                                                *
   420*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   421*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
   422*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   423*                                                                *
   424*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   425*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   426*    BETWEEN PROGRAMS.                                           *
   427*                                                                *
   428*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   429*                                                                *
   430*               EL631 - EL689  - EL6891 - EL6892                 *
   431*                                                                *
   432******************************************************************
   433*                   C H A N G E   L O G
   434*
   435* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   436*-----------------------------------------------------------------
   437*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   438* EFFECTIVE    NUMBER
   439*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6892.cbl
   440* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
   441* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
   442* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
   443******************************************************************
   444
   445
   446         16  PI-689-WORK-AREA.
   447             20  PI-689-ALT-PRINTER-ID
   448                                 PIC  X(04).
   449             20  PI-689-ARCHIVE-NUMBER
   450                                 PIC  9(08).
   451             20  PI-689-ARCHIVE-SW
   452                                 PIC  X(01).
   453                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
   454             20  PI-689-DATA-SOURCE
   455                                 PIC  X(01).
   456                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
   457                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
   458                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
   459                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
   460                 88  PI-689-SRC-CHECKS         VALUE '5'.
   461             20  PI-689-ERROR-IND
   462                                 PIC  X(01).
   463                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
   464             20  PI-689-ERROR    PIC  9(04).
   465                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
   466                 88  PI-689-FATAL-ERROR
   467                     VALUES 0004 0006 0008 0013 0023 0029 0033
   468                            0042 0047 0051 0066 0067 0070
   469                            0168 0169 0174 0175 0176 0177 0179
   470                            0180 0181 0182 0184 0185 0189 0190
   471                            0191
   472                            0215 0279 0280
   473                            0412 0413 0454
   474                            0533 0537
   475                            2055 2114 2208 2209 2216 2232 2369
   476                            2398 2433 2908 2999
   477                            3000 3770 3771 3775
   478                            7250 7365 7367 7368 7369 7370 7371
   479                            7272 7373 7374 7376 7377 7378 7379
   480                            7381 7388 7390 7393 7395 7396 7398
   481                            9095 9096 9281 9298 9299 9320 9327
   482                            9426 9427.
   483                 88  PI-689-STOP-ERROR
   484                     VALUES 0004 0008 0013 0023 0029 0033
   485                            0042 0047 0066 0067 0070
   486                            0168 0169 0174 0175 0176 0177
   487                            0181 0182 0184 0185 0189 0190
   488                            0279 0280
   489                            0412 0413 0454
   490                            2055 2208 2209 2216 2232
   491                            2398 2999
   492                            3000 3770 3771 3775
   493                            7250 7365 7369 7370 7371
   494                            7272 7373 7374 7376 7377 7378 7379
   495                            7381 7388 7390 7393 7396 7398
   496                            9095 9096 9299 9320 9426.
   497             20  PI-689-FOLLOW-UP-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6892.cbl
   498                                 PIC  X(02).
   499             20  PI-689-FORM-NUMBER
   500                                 PIC  X(04).
   501             20  PI-689-LABEL-SOURCE
   502                                 PIC X(01).
   503                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
   504                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
   505                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
   506                 88  PI-689-SOURCE-COMP     VALUE '4'.
   507                 88  PI-689-SOURCE-MAIL     VALUE '5'.
   508                 88  PI-689-SOURCE-CHECK    VALUE '6'.
   509                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
   510             20  PI-689-NUMBER-COPIES
   511                                 PIC  9(01).
   512             20  PI-689-NUMBER-LABEL-LINES
   513                                 PIC  9(01).
   514             20  PI-689-NUMBER-TEXT-RECORDS
   515                                 PIC  9(03).
   516             20  PI-689-PRINT-ORDER-SW
   517                                 PIC  X(01).
   518                 88  PI-689-PRINT-FIRST     VALUE '1'.
   519                 88  PI-689-PRINT-SECOND    VALUE '2'.
   520                 88  PI-689-PRINT-LATER     VALUE '3'.
   521                 88  PI-689-PRINT-ONLY      VALUE '4'.
   522             20  PI-689-PRINT-RESTRICTION
   523                                 PIC  X(01).
   524                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
   525                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
   526                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
   527             20  PI-689-PRINT-SW PIC  X(01).
   528                 88  PI-689-PRINT-PERFORMED VALUE '1'.
   529             20  PI-689-RESEND-DATE-1
   530                                 PIC  X(02).
   531             20  PI-689-RESEND-LETR-1
   532                                 PIC X(4).
   533             20  PI-689-TEMP-STOR-ID
   534                                 PIC  X(08).
   535             20  PI-689-USE-SCREEN-IND
   536                                 PIC  X(01).
   537                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
   538             20  PI-689-ARCH-POINTER
   539                                 PIC S9(08) COMP.
   540                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
   541             20  PI-689-ARCT-POINTER
   542                                 PIC S9(08) COMP.
   543                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
   544             20  PI-689-VARIABLE-DATA-GRP.
   545                 24  PI-689-VARIABLE-DATA-1
   546                                 PIC  X(30).
   547                 24  PI-689-VARIABLE-DATA-2
   548                                 PIC  X(30).
   549                 24  PI-689-VARIABLE-DATA-3
   550                                 PIC  X(30).
   551                 24  PI-689-VARIABLE-DATA-4
   552                                 PIC  X(30).
   553
   554         16  PI-689-KEY-DATA-FIELDS.
   555             20  PI-689-ACCOUNT  PIC  X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6892.cbl
   556             20  PI-689-CARRIER  PIC  X(01).
   557             20  PI-689-CERT-NO.
   558                 24  PI-689-CERT-PRIME
   559                                 PIC  X(10).
   560                 24  PI-689-CERT-SFX
   561                                 PIC  X(01).
   562             20  PI-689-CHG-SEQ-NO
   563                                 PIC S9(04)    COMP.
   564             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
   565                                 PIC  X(02).
   566             20  PI-689-ENTRY-BATCH
   567                                 PIC  X(06).
   568             20  PI-689-EFF-DATE PIC  X(02).
   569             20  PI-689-EXP-DATE PIC  X(02).
   570             20  PI-689-GROUPING PIC  X(06).
   571             20  PI-689-RESP-PERSON
   572                                 PIC  X(10).
   573             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
   574             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
   575                                 PIC  X(04).
   576             20  PI-689-STATE    PIC  X(02).
   577             20  PI-689-TYPE     PIC  X(01).
   578             20  PI-689-CONTROL  PIC S9(08)    COMP.
   579             20  PI-689-ALT-SEQ-NO
   580                                 PIC S9(04)    COMP.
   581         16  PI-689-DATE-EDIT    PIC  X(08).
   582         16  PI-689-FOLLOW-UP-EDIT
   583                                 PIC  X(08).
   584         16  PI-689-RESEND1-EDIT PIC  X(08).
   585         16  PI-689-SEQ-EDIT     PIC  X(08).
   586         16  PI-689-BCSEQ-EDIT   PIC  X(04).
   587         16  PI-689-LBL-OVERRIDE PIC  X(01).
   588             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
   589         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
   590         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
   591     16  FILLER                  PIC X(280).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6892.cbl
   593 01  FILLER                      PIC  X(23)
   594                             VALUE 'PRINT WORK AREA STARTS:'.
   595*    COPY ELPRTCVD.
   596*****************************************************************
   597*                                                               *
   598*                            ELPRTCVD.                          *
   599*                            VMOD=2.001                         *
   600*****************************************************************.
   601
   602******************************************************************
   603***   WORK AREAS  FOR TERMINAL ONLINE PRINT ROUTINE
   604***                 -ELPRTCVD-
   605***   TO BE USED WITH PROCEDURE COPY MEMBER -ELPRTCVP-
   606******************************************************************
   607
   608 01  S-WORK-AREA                     SYNC.
   609     12  WS-LINE-LEN                 PIC S9(4)       VALUE +80
   610                                     COMP.
   611
   612     12  WS-LINE-LENGTH              PIC S9(4)       VALUE ZERO
   613                                     COMP.
   614
   615     12  WS-BUFFER-SIZE              PIC S9(4)       VALUE +1916
   616                                     COMP.
   617
   618     12  WS-BUFFER-LENGTH            PIC S9(4)       VALUE ZERO
   619                                     COMP.
   620
   621     12  WS-PROG-END                 PIC X           VALUE SPACES.
   622
   623     12  WS-PRINT-AREA.
   624         16  WS-PASSED-CNTL-CHAR     PIC X           VALUE SPACES.
   625           88  SINGLE-SPACE                          VALUE ' '.
   626           88  DOUBLE-SPACE                          VALUE '0'.
   627           88  TRIPLE-SPACE                          VALUE '-'.
   628           88  TOP-PAGE                              VALUE '1'.
   629
   630         16  WS-PASSED-DATA.
   631             20  WS-PRINT-BYTE       PIC X
   632                 OCCURS 132 TIMES    INDEXED BY PRT-INDEX.
   633
   634     12  WS-LINE-CNT                 PIC S9(3)        VALUE ZERO
   635                                     COMP-3.
   636     12  WS-WCC-CNTL                 PIC X(1)         VALUE 'H'.
   637
   638     12  WS-EM                       PIC S9(4)        VALUE +25
   639                                     COMP.
   640     12  FILLER   REDEFINES WS-EM.
   641         16  FILLER                  PIC X.
   642         16  T-EM                    PIC X.
   643
   644*    12  WS-SS                       PIC S9(4)        VALUE +21
   645     12  WS-SS                       PIC S9(4)        VALUE +10
   646                                     COMP.
   647     12  FILLER   REDEFINES WS-SS.
   648         16  FILLER                  PIC X.
   649         16  T-SS                    PIC X.
   650
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6892.cbl
   651     12  WS-TP                       PIC S9(4)      VALUE +12
   652                                     COMP.
   653     12  FILLER   REDEFINES WS-TP.
   654         16  FILLER                  PIC X.
   655         16  T-TP                    PIC X.
   656
   657     12  WS-FIRST-TIME-SW            PIC X           VALUE '1'.
   658         88  FIRST-TIME                              VALUE '1'.
   659         88  FIRST-LINE-NEXT-BUFFER                  VALUE '2'.
   660
   661     12  WS-BUFFER-AREA.
   662         16  WS-BUFFER-BYTE          PIC X
   663             OCCURS 1920 TIMES       INDEXED BY BUFFER-INDEX
   664                                                BUFFER-INDEX2.
   665
   666******************************************************************
   667 01  FILLER                      PIC  X(21)
   668                             VALUE 'PRINT WORK AREA ENDS:'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6892.cbl
   670*    COPY ELCDMD34.
   671******************************************************************
   672*                                                                *
   673*                                                                *
   674*                            ELCDMD34.                           *
   675*                            VMOD=2.001                          *
   676*                                                                *
   677*   FILE DESCRIPTION = DMD DLO034 PARAMETER AREA                 *
   678*                                                                *
   679*    LENGTH = 272    RECFRM = FIXED                              *
   680*                                                                *
   681******************************************************************
   682 01  DLO034-COMMUNICATION-AREA.
   683     12  DL34-PROCESS-TYPE             PIC X.
   684     12  DL34-COMPANY-ID               PIC XXX.
   685     12  DL34-PRINT-PROGRAM-ID         PIC X(8).
   686     12  DL34-USERID                   PIC X(4).
   687     12  DL34-PRINT-LINE               PIC X(250).
   688     12  DL34-OVERRIDE-PRINTER-ID      PIC X(4).
   689     12  DL34-RETURN-CODE              PIC XX.
   690 01  DLO034-REC-LENGTH                 PIC S9(4) COMP VALUE +272.
   691
   692****************************************************************
   693*
   694* Copyright (c) 2007 by Clerity Solutions, Inc.
   695* All rights reserved.
   696*
   697****************************************************************
   698 01  DFHEIV.
   699   02  DFHEIV0               PIC X(35).
   700   02  DFHEIV1               PIC X(08).
   701   02  DFHEIV2               PIC X(08).
   702   02  DFHEIV3               PIC X(08).
   703   02  DFHEIV4               PIC X(06).
   704   02  DFHEIV5               PIC X(04).
   705   02  DFHEIV6               PIC X(04).
   706   02  DFHEIV7               PIC X(02).
   707   02  DFHEIV8               PIC X(02).
   708   02  DFHEIV9               PIC X(01).
   709   02  DFHEIV10              PIC S9(7) COMP-3.
   710   02  DFHEIV11              PIC S9(4) COMP SYNC.
   711   02  DFHEIV12              PIC S9(4) COMP SYNC.
   712   02  DFHEIV13              PIC S9(4) COMP SYNC.
   713   02  DFHEIV14              PIC S9(4) COMP SYNC.
   714   02  DFHEIV15              PIC S9(4) COMP SYNC.
   715   02  DFHEIV16              PIC S9(9) COMP SYNC.
   716   02  DFHEIV17              PIC X(04).
   717   02  DFHEIV18              PIC X(04).
   718   02  DFHEIV19              PIC X(04).
   719   02  DFHEIV20              USAGE IS POINTER.
   720   02  DFHEIV21              USAGE IS POINTER.
   721   02  DFHEIV22              USAGE IS POINTER.
   722   02  DFHEIV23              USAGE IS POINTER.
   723   02  DFHEIV24              USAGE IS POINTER.
   724   02  DFHEIV25              PIC S9(9) COMP SYNC.
   725   02  DFHEIV26              PIC S9(9) COMP SYNC.
   726   02  DFHEIV27              PIC S9(9) COMP SYNC.
   727   02  DFHEIV28              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6892.cbl
   728   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   729   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   730   02  FILLER                PIC X(02).
   731   02  DFHEIV99              PIC X(08) VALUE SPACE.
   732   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   733   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   734   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   735   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   736 LINKAGE  SECTION.
   737*****************************************************************
   738*                                                               *
   739* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   740* All rights reserved.                                          *
   741*                                                               *
   742*****************************************************************
   743 01  dfheiblk.
   744     02  eibtime          pic s9(7) comp-3.
   745     02  eibdate          pic s9(7) comp-3.
   746     02  eibtrnid         pic x(4).
   747     02  eibtaskn         pic s9(7) comp-3.
   748     02  eibtrmid         pic x(4).
   749     02  dfheigdi         pic s9(4) comp.
   750     02  eibcposn         pic s9(4) comp.
   751     02  eibcalen         pic s9(4) comp.
   752     02  eibaid           pic x(1).
   753     02  eibfiller1       pic x(1).
   754     02  eibfn            pic x(2).
   755     02  eibfiller2       pic x(2).
   756     02  eibrcode         pic x(6).
   757     02  eibfiller3       pic x(2).
   758     02  eibds            pic x(8).
   759     02  eibreqid         pic x(8).
   760     02  eibrsrce         pic x(8).
   761     02  eibsync          pic x(1).
   762     02  eibfree          pic x(1).
   763     02  eibrecv          pic x(1).
   764     02  eibsend          pic x(1).
   765     02  eibatt           pic x(1).
   766     02  eibeoc           pic x(1).
   767     02  eibfmh           pic x(1).
   768     02  eibcompl         pic x(1).
   769     02  eibsig           pic x(1).
   770     02  eibconf          pic x(1).
   771     02  eiberr           pic x(1).
   772     02  eibrldbk         pic x(1).
   773     02  eiberrcd         pic x(4).
   774     02  eibsynrb         pic x(1).
   775     02  eibnodat         pic x(1).
   776     02  eibfiller5       pic x(2).
   777     02  eibresp          pic 9(09) comp.
   778     02  eibresp2         pic 9(09) comp.
   779     02  dfheigdj         pic s9(4) comp.
   780     02  dfheigdk         pic s9(4) comp.
   781 01  DFHCOMMAREA       PIC X(01).
   782 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
   783 0000-DFHEXIT SECTION.
   784     MOVE '9#                    $   ' TO DFHEIV0.
   785     MOVE 'EL6892' TO DFHEIV1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6892.cbl
   786     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   787
   788*    MOVE +132                   TO  WS-LINE-LEN.
   789     MOVE +85                    TO  WS-LINE-LEN.
   790     MOVE SPACES                 TO DL34-PROCESS-TYPE.
   791
   792 0100-RETRIEVE-LOOP.
   793
   794
   795* EXEC CICS HANDLE CONDITION
   796*         ENDDATA  (0200-END-DATA)
   797*         NOTFND   (0300-NOT-FOUND)
   798*    END-EXEC.
   799*    MOVE '"$&I                  ! " #00000790' TO DFHEIV0
   800     MOVE X'222426492020202020202020' TO DFHEIV0(1:12)
   801     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
   802     MOVE X'2220233030303030373930' TO DFHEIV0(25:11)
   803     CALL 'kxdfhei1' USING DFHEIV0
   804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   805
   806
   807
   808* EXEC CICS RETRIEVE
   809*         INTO      (PROGRAM-INTERFACE-BLOCK)
   810*         LENGTH    (PI-COMM-LENGTH)
   811*    END-EXEC.
   812*    MOVE '0*I L                 &   #00000795' TO DFHEIV0
   813     MOVE X'302A49204C20202020202020' TO DFHEIV0(1:12)
   814     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   815     MOVE X'2020233030303030373935' TO DFHEIV0(25:11)
   816     CALL 'kxdfhei1' USING DFHEIV0,
   817           PROGRAM-INTERFACE-BLOCK,
   818           PI-COMM-LENGTH,
   819           DFHEIV99,
   820           DFHEIV99,
   821           DFHEIV99
   822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   823
   824
   825* DLO034 OPEN WHEN DMD OR CID
   826     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
   827         IF DL34-PROCESS-TYPE IS EQUAL TO SPACES
   828             MOVE 'O'                TO DL34-PROCESS-TYPE
   829             MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
   830             MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
   831             MOVE PI-PROCESSOR-ID    TO DL34-USERID
   832             MOVE SPACES             TO DL34-PRINT-LINE
   833             MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
   834
   835* EXEC CICS LINK
   836*                PROGRAM    ('DLO034')
   837*                COMMAREA   (DLO034-COMMUNICATION-AREA)
   838*                LENGTH     (DLO034-REC-LENGTH)
   839*            END-EXEC
   840     MOVE 'DLO034' TO DFHEIV1
   841*    MOVE '."C                   ''   #00000809' TO DFHEIV0
   842     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
   843     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6892.cbl
   844     MOVE X'2020233030303030383039' TO DFHEIV0(25:11)
   845     CALL 'kxdfhei1' USING DFHEIV0,
   846           DFHEIV1,
   847           DLO034-COMMUNICATION-AREA,
   848           DLO034-REC-LENGTH,
   849           DFHEIV99,
   850           DFHEIV99,
   851           DFHEIV99
   852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   853             IF DL34-RETURN-CODE NOT = 'OK'
   854                 MOVE  '**DLO034 OPEN ERROR - ABORT**'
   855                                     TO W-ERROR-LINE
   856                 PERFORM 0400-SEND-TEXT
   857
   858* EXEC CICS RETURN
   859*                END-EXEC.
   860*    MOVE '.(                    &   #00000818' TO DFHEIV0
   861     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
   862     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   863     MOVE X'2020233030303030383138' TO DFHEIV0(25:11)
   864     CALL 'kxdfhei1' USING DFHEIV0,
   865           DFHEIV99,
   866           DFHEIV99,
   867           DFHEIV99,
   868           DFHEIV99,
   869           DFHEIV99
   870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   871
   872
   873     IF  PI-CALLING-PROGRAM = W-PGM-EL689
   874         GO TO 1000-PRINT-EL689.
   875
   876     GO TO 0100-RETRIEVE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6892.cbl
   878 0200-END-DATA.
   879*    MOVE 'L'                    TO DRS-SW.
   880*    PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
   881     MOVE 'MX27'                 TO W-NEXT-TRAN.
   882
   883     MOVE EIBTRMID               TO W-TERMINAL-ID
   884
   885* DLO034 CLOSE
   886     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
   887         MOVE 'C'                TO DL34-PROCESS-TYPE
   888         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
   889         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
   890         MOVE PI-PROCESSOR-ID    TO DL34-USERID
   891         MOVE SPACES             TO DL34-PRINT-LINE
   892                                    DL34-OVERRIDE-PRINTER-ID
   893
   894* EXEC CICS LINK
   895*            PROGRAM    ('DLO034')
   896*            COMMAREA   (DLO034-COMMUNICATION-AREA)
   897*            LENGTH     (DLO034-REC-LENGTH)
   898*        END-EXEC
   899     MOVE 'DLO034' TO DFHEIV1
   900*    MOVE '."C                   ''   #00000841' TO DFHEIV0
   901     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
   902     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
   903     MOVE X'2020233030303030383431' TO DFHEIV0(25:11)
   904     CALL 'kxdfhei1' USING DFHEIV0,
   905           DFHEIV1,
   906           DLO034-COMMUNICATION-AREA,
   907           DLO034-REC-LENGTH,
   908           DFHEIV99,
   909           DFHEIV99,
   910           DFHEIV99
   911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   912         IF DL34-RETURN-CODE NOT = 'OK'
   913             MOVE  '**DLO034 CLOSE ERROR - ABORT**'
   914                                 TO W-ERROR-LINE
   915             PERFORM 0400-SEND-TEXT
   916
   917* EXEC CICS RETURN
   918*                 TRANSID  (W-NEXT-TRAN)
   919*                 COMMAREA (PROGRAM-INTERFACE-BLOCK)
   920*                 LENGTH   (PI-COMM-LENGTH)
   921*            END-EXEC.
   922*    MOVE '.(CT                  &   #00000850' TO DFHEIV0
   923     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
   924     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   925     MOVE X'2020233030303030383530' TO DFHEIV0(25:11)
   926     CALL 'kxdfhei1' USING DFHEIV0,
   927           W-NEXT-TRAN,
   928           PROGRAM-INTERFACE-BLOCK,
   929           PI-COMM-LENGTH,
   930           DFHEIV99,
   931           DFHEIV99
   932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   933
   934
   935     IF  W-TERM-PREFIX = 'DU'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6892.cbl
   936
   937* EXEC CICS RETURN
   938*             TRANSID  (W-NEXT-TRAN)
   939*             COMMAREA (PROGRAM-INTERFACE-BLOCK)
   940*             LENGTH   (PI-COMM-LENGTH)
   941*        END-EXEC
   942*    MOVE '.(CT                  &   #00000857' TO DFHEIV0
   943     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
   944     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   945     MOVE X'2020233030303030383537' TO DFHEIV0(25:11)
   946     CALL 'kxdfhei1' USING DFHEIV0,
   947           W-NEXT-TRAN,
   948           PROGRAM-INTERFACE-BLOCK,
   949           PI-COMM-LENGTH,
   950           DFHEIV99,
   951           DFHEIV99
   952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   953     ELSE
   954
   955* EXEC CICS RETURN
   956*        END-EXEC.
   957*    MOVE '.(                    &   #00000863' TO DFHEIV0
   958     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
   959     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   960     MOVE X'2020233030303030383633' TO DFHEIV0(25:11)
   961     CALL 'kxdfhei1' USING DFHEIV0,
   962           DFHEIV99,
   963           DFHEIV99,
   964           DFHEIV99,
   965           DFHEIV99,
   966           DFHEIV99
   967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   968
   969
   970 0300-NOT-FOUND.
   971
   972     MOVE 'NO COMMUNICATION AREA FOUND' TO W-ERROR-LINE
   973     PERFORM 0400-SEND-TEXT
   974     GO TO 0200-END-DATA.
   975
   976 0400-SEND-TEXT.
   977
   978
   979* EXEC CICS SEND TEXT
   980*         FROM    (W-ERROR-LINE)
   981*         LENGTH  (70)
   982*    END-EXEC.
   983     MOVE 70
   984       TO DFHEIV11
   985*    MOVE '8&      T       H   F -   #00000874' TO DFHEIV0
   986     MOVE X'382620202020202054202020' TO DFHEIV0(1:12)
   987     MOVE X'202020204820202046202D20' TO DFHEIV0(13:12)
   988     MOVE X'2020233030303030383734' TO DFHEIV0(25:11)
   989     CALL 'kxdfhei1' USING DFHEIV0,
   990           W-ERROR-LINE,
   991           DFHEIV11,
   992           DFHEIV99,
   993           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6892.cbl
   994           DFHEIV99,
   995           DFHEIV99,
   996           DFHEIV99,
   997           DFHEIV99,
   998           DFHEIV99,
   999           DFHEIV99,
  1000           DFHEIV99,
  1001           DFHEIV99
  1002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1003
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6892.cbl
  1005 1000-PRINT-EL689.
  1006*    MOVE PI-PROCESSOR-PRINTER TO  CSO-PRINT-ID.
  1007*    MOVE 'F'       TO  DRS-SW.
  1008*    PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1009*    MOVE ' '       TO  DRS-SW.
  1010
  1011
  1012* EXEC CICS HANDLE CONDITION
  1013*         QIDERR  (1090-TS-QIDERR)
  1014*         ITEMERR (1089-TS-ITEMERR)
  1015*    END-EXEC.
  1016*    MOVE '"$N<                  ! # #00000885' TO DFHEIV0
  1017     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  1018     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1019     MOVE X'2320233030303030383835' TO DFHEIV0(25:11)
  1020     CALL 'kxdfhei1' USING DFHEIV0
  1021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1022
  1023
  1024     IF  PI-CREATE-LABELS
  1025         SUBTRACT PI-689-NUMBER-LABEL-LINES
  1026             FROM PI-TOTAL-LINES.
  1027*    SUBTRACT 7 FROM PI-TOTAL-LINES.
  1028
  1029 1005-READ-TEMP.
  1030
  1031     PERFORM 1010-TEMP-READ THRU 1019-EXIT
  1032             VARYING
  1033         W-TS-ITEM FROM 1 BY 1
  1034             UNTIL
  1035         W-TS-ITEM GREATER THAN PI-TEMP-STOR-ITEMS.
  1036
  1037     MOVE 'X'                    TO WS-PROG-END.
  1038*    MOVE SPACES                 TO WS-PASSED-DATA
  1039*                                   WS-PASSED-CNTL-CHAR.
  1040     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1041     MOVE ZEROS                  TO W-RECORDS-PRINTED.
  1042     SUBTRACT 1 FROM PI-689-NUMBER-COPIES.
  1043
  1044     IF  PI-689-NUMBER-COPIES = 0
  1045         PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT
  1046         GO TO 0100-RETRIEVE-LOOP.
  1047
  1048     GO TO 1005-READ-TEMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6892.cbl
  1050 1010-TEMP-READ.
  1051
  1052
  1053* EXEC CICS READQ TS
  1054*         INTO    (W-TS-WORK-AREA)
  1055*         QUEUE   (PI-689-TEMP-STOR-ID)
  1056*         LENGTH  (W-TS-LENGTH)
  1057*         ITEM    (W-TS-ITEM)
  1058*    END-EXEC.
  1059*    MOVE '*$II   L              ''   #00000918' TO DFHEIV0
  1060     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1061     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1062     MOVE X'2020233030303030393138' TO DFHEIV0(25:11)
  1063     CALL 'kxdfhei1' USING DFHEIV0,
  1064           PI-689-TEMP-STOR-ID,
  1065           W-TS-WORK-AREA,
  1066           W-TS-LENGTH,
  1067           W-TS-ITEM,
  1068           DFHEIV99,
  1069           DFHEIV99
  1070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1071
  1072
  1073
  1074     IF  W-TS-ITEM = 1
  1075             AND
  1076         W-RECORDS-PRINTED EQUAL ZEROS
  1077         SET W-TB-NDX            TO PI-689-NUMBER-LABEL-LINES
  1078         SET W-TB-NDX UP BY +1
  1079
  1080         IF  W-REC-TEXT (W-TB-NDX) EQUAL SPACES
  1081             MOVE W-TOP-FORM     TO WS-PASSED-CNTL-CHAR
  1082             PERFORM 1020-RECORD-PRINT THRU 1029-EXIT
  1083                     VARYING
  1084                 W-TB-NDX FROM W-TB-NDX BY +1
  1085                     UNTIL
  1086                 W-TB-NDX GREATER THAN W-ENTRIES-PER-RECORD
  1087
  1088         ELSE
  1089             IF  W-REC-TEXT-TOP (W-TB-NDX) EQUAL
  1090                     W-TOP-OF-FORM-MESSAGE
  1091                 SET W-TB-NDX UP BY +1
  1092                 MOVE W-TOP-FORM TO WS-PASSED-CNTL-CHAR
  1093
  1094                 IF  W-REC-TEXT (W-TB-NDX) EQUAL SPACES
  1095                     PERFORM 1020-RECORD-PRINT THRU 1029-EXIT
  1096                             VARYING
  1097                         W-TB-NDX FROM W-TB-NDX BY +1
  1098                             UNTIL
  1099                         W-TB-NDX GREATER THAN
  1100                             W-ENTRIES-PER-RECORD
  1101
  1102                 ELSE
  1103                     MOVE SPACES TO WS-PASSED-DATA
  1104                     MOVE -1     TO W-RECORDS-PRINTED
  1105                     PERFORM 1028-PRINT THRU 1028-EXIT
  1106                     PERFORM 1020-RECORD-PRINT THRU 1029-EXIT
  1107                             VARYING
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6892.cbl
  1108                         W-TB-NDX FROM W-TB-NDX BY +1
  1109                             UNTIL
  1110                         W-TB-NDX GREATER THAN
  1111                             W-ENTRIES-PER-RECORD
  1112
  1113             ELSE
  1114                 MOVE W-TOP-FORM TO WS-PASSED-CNTL-CHAR
  1115                 MOVE SPACES     TO WS-PASSED-DATA
  1116                 MOVE -1         TO W-RECORDS-PRINTED
  1117                 PERFORM 1028-PRINT THRU 1028-EXIT
  1118                 PERFORM 1020-RECORD-PRINT THRU 1029-EXIT
  1119                         VARYING
  1120                     W-TB-NDX FROM W-TB-NDX BY +1
  1121                         UNTIL
  1122                     W-TB-NDX GREATER THAN
  1123                         W-ENTRIES-PER-RECORD
  1124
  1125     ELSE
  1126         PERFORM 1020-RECORD-PRINT THRU 1029-EXIT
  1127                 VARYING
  1128             W-TB-NDX FROM 1 BY 1
  1129                 UNTIL
  1130             W-TB-NDX GREATER THAN W-ENTRIES-PER-RECORD.
  1131
  1132 1019-EXIT.
  1133      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6892.cbl
  1135 1020-RECORD-PRINT.
  1136
  1137     IF  W-REC-TEXT-TOP (W-TB-NDX) = W-TOP-OF-FORM-MESSAGE
  1138         MOVE W-TOP-FORM         TO WS-PASSED-CNTL-CHAR
  1139         MOVE SPACES             TO WS-PASSED-DATA
  1140         MOVE -1                 TO W-RECORDS-PRINTED
  1141         GO TO 1028-PRINT.
  1142
  1143     IF  W-TB-NDX GREATER THAN 50
  1144         MOVE 'INPUT RECORDS GREATER THAN 50'
  1145                                 TO W-ERROR-LINE
  1146         PERFORM 0400-SEND-TEXT
  1147         SET W-TB-NDX DOWN BY 1
  1148         MOVE W-REC-TEXT (W-TB-NDX)
  1149                                 TO W-ERROR-LINE
  1150         PERFORM 0400-SEND-TEXT
  1151         GO TO 0200-END-DATA.
  1152     IF W-REC-TEXT (W-TB-NDX) (1:6) = '&&&&&&'
  1153        GO TO 1029-EXIT
  1154     END-IF
  1155     MOVE SPACES                 TO W-ADJUST-AREA.
  1156
  1157     MOVE W-REC-TEXT (W-TB-NDX)  TO W-AD-PRINT-AREA.
  1158     MOVE W-ADJUST-AREA          TO WS-PASSED-DATA.
  1159
  1160 1028-PRINT.
  1161
  1162     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1163     MOVE SPACE                  TO WS-PASSED-CNTL-CHAR.
  1164     ADD 1                       TO W-RECORDS-PRINTED.
  1165
  1166 1028-EXIT.
  1167      EXIT.
  1168
  1169 1028-CONTINUE.
  1170
  1171     IF  W-RECORDS-PRINTED = PI-TOTAL-LINES
  1172         SET W-TB-NDX            TO W-ENTRIES-PER-RECORD
  1173         SET W-TB-NDX UP BY 1
  1174         GO TO 1029-EXIT.
  1175
  1176 1029-EXIT.
  1177      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6892.cbl
  1179 1089-TS-ITEMERR.
  1180
  1181     MOVE 'TEMP STORAGE RECORD NOT FOUND'
  1182                                  TO W-ERROR-LINE.
  1183     PERFORM 0400-SEND-TEXT.
  1184     GO TO 0100-RETRIEVE-LOOP.
  1185
  1186 1090-TS-QIDERR.
  1187
  1188     MOVE 'NO TEMP STORAGE RECORDS NOT FOUND'
  1189                                  TO W-ERROR-LINE.
  1190     PERFORM 0400-SEND-TEXT.
  1191     GO TO 0100-RETRIEVE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6892.cbl
  1193 7750-DELETE-TEMP-STOR.
  1194
  1195
  1196* EXEC CICS HANDLE CONDITION
  1197*         QIDERR (7750-EXIT)
  1198*    END-EXEC.
  1199*    MOVE '"$N                   ! $ #00001047' TO DFHEIV0
  1200     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  1201     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1202     MOVE X'2420233030303031303437' TO DFHEIV0(25:11)
  1203     CALL 'kxdfhei1' USING DFHEIV0
  1204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1205
  1206
  1207
  1208* EXEC CICS DELETEQ TS
  1209*         QUEUE  (PI-689-TEMP-STOR-ID)
  1210*    END-EXEC.
  1211*    MOVE '*&                    #   #00001051' TO DFHEIV0
  1212     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  1213     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1214     MOVE X'2020233030303031303531' TO DFHEIV0(25:11)
  1215     CALL 'kxdfhei1' USING DFHEIV0,
  1216           PI-689-TEMP-STOR-ID,
  1217           DFHEIV99
  1218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1219
  1220
  1221 7750-EXIT.
  1222     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6892.cbl
  1224*    COPY ELPRTCVP.
  1225******************************************************************
  1226***                                                              *
  1227***                          ELPRTCVP.                           *
  1228***                          VMOD=2.003                          *
  1229***                                                              *
  1230***     COPY MEMBER FOR TERMINAL ONLINE PRINT ROUTINE.           *
  1231***     THIS ROUTINE WILL ACCOMODATE PRINTING TO A 3270          *
  1232***     TERMINAL PRINTER. A BUFFER OF UP TO 1920 CHARACTERS      *
  1233***     IS ACCUMULATED AND PRINTED COLLECTIVELY.                 *
  1234***                                                              *
  1235***     THIS ROUTINE TO BE USED ONLY WITH ACCOMPANIMENT          *
  1236***      OF THE WORKING-STORAGE COPY MEMBER ( ELPRTCVD )         *
  1237***     THE HOST PROGRAM MUST INITIALIZE THE FOLLOWING 3 FIELDS  *
  1238***      FROM THE ABOVE COPY MEMBER FOR THIS PROCEDURE TO BE     *
  1239***      SUCCESSFUL.                                             *
  1240***      05  WS-LINE-LEN    PIC  S9(4)  COMP  VALUE +80.         *
  1241***                         LENGTH OF THE LINE TO BE PRINTED     *
  1242***                         DEFAULT IS 80, YOU CAN USE ANY NUMBER*
  1243***                         UP TO 132.  THIS FIELD IS ONLY ACCEP-*
  1244***                         TED THE FIRST TIME THRU THE ROUTINE. *
  1245***      05  WS-PROG-END    PIC  X  VALUE SPACES.                *
  1246***                         PROGRAM END SWITCH. INITIALIZED      *
  1247***                         TO SPACE-     MOVE IN ANY NONBLANK   *
  1248***                         TO IT WHEN PROGRAM IS FINISHED.      *
  1249***      05  WS-PRINT-AREA.                                      *
  1250***          10  WS-PASSED-CNTL-CHAR     PIC X.                  *
  1251***          10  WS-PASSED-DATA          PIC X(132).             *
  1252***                         USE THE DATA TO BE PRINTED IN THE    *
  1253***                         WS-PASSED-DATA.                      *
  1254***                         USE THE STANDARD CARRIAGE CONTROL    *
  1255***                         CHARACTER IN THE WS-PASSED-CNTL-CHAR *
  1256***                           SINGLE-SPACE            VALUE ' '  *
  1257***                           DOUBLE-SPACE            VALUE '0'  *
  1258***                           TRIPLE-SPACE            VALUE '-'  *
  1259***                           TOP-PAGE                VALUE '1'  *
  1260***      NOTE: A LINE COUNT IS PROVIDED IN FIELDNAME -WS-LINE-CNT*
  1261***            THE USE OF THIS FIELD IS OPTIONAL.                *
  1262***            THIS ROUTINE WILL ONLY ADD 1, 2, OR 3             *
  1263***            TO THIS COUNT DEPENDING ON THE WS-PASSED-CNTL-CHAR*
  1264***            AND RESET THE COUNT TO ZERO WHEN TOP-PAGE         *
  1265***            CONDITION.                                        *
  1266***                                                              *
  1267******************************************************************
  1268
  1269 ELPRTCVP.
  1270
  1271*    IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'CID'
  1272     IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'XXX'
  1273         MOVE 'P'                TO DL34-PROCESS-TYPE
  1274         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  1275         MOVE PI-PROCESSOR-ID    TO DL34-USERID
  1276         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  1277         MOVE WS-PRINT-AREA      TO DL34-PRINT-LINE
  1278         MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
  1279
  1280
  1281* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6892.cbl
  1282*            PROGRAM    ('DLO034')
  1283*            COMMAREA   (DLO034-COMMUNICATION-AREA)
  1284*            LENGTH     (DLO034-REC-LENGTH)
  1285*        END-EXEC
  1286     MOVE 'DLO034' TO DFHEIV1
  1287*    MOVE '."C                   ''   #00001114' TO DFHEIV0
  1288     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1289     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1290     MOVE X'2020233030303031313134' TO DFHEIV0(25:11)
  1291     CALL 'kxdfhei1' USING DFHEIV0,
  1292           DFHEIV1,
  1293           DLO034-COMMUNICATION-AREA,
  1294           DLO034-REC-LENGTH,
  1295           DFHEIV99,
  1296           DFHEIV99,
  1297           DFHEIV99
  1298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1299
  1300            IF DL34-RETURN-CODE = 'OK'
  1301                GO TO ELPRTCVP-EXIT
  1302            ELSE
  1303*               MOVE '8339'     TO EMI-ERROR ?????ERROR MESSAGE???
  1304                GO TO ELPRTCVP-EXIT.
  1305
  1306     IF NOT FIRST-TIME
  1307         GO TO ELPRTCVP-020.
  1308
  1309     IF WS-LINE-LEN NOT GREATER ZERO
  1310         GO TO ELPRTCVP-EXIT.
  1311
  1312     MOVE '2'                    TO WS-FIRST-TIME-SW.
  1313     MOVE LOW-VALUES             TO WS-BUFFER-AREA.
  1314
  1315     SET BUFFER-INDEX TO +1
  1316
  1317     IF EIBTRMID IS EQUAL TO 'AFLP'
  1318         NEXT SENTENCE
  1319     ELSE
  1320         IF NOT TOP-PAGE
  1321             MOVE T-TP           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1322             SET BUFFER-INDEX UP BY +1.
  1323
  1324 ELPRTCVP-020.
  1325     IF WS-PROG-END = SPACES
  1326         GO TO ELPRTCVP-030.
  1327
  1328     MOVE SPACES                 TO WS-PROG-END.
  1329
  1330     IF BUFFER-INDEX GREATER +1
  1331         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  1332
  1333     MOVE '1'                    TO WS-FIRST-TIME-SW.
  1334
  1335     GO TO ELPRTCVP-EXIT.
  1336
  1337 ELPRTCVP-030.
  1338     IF WS-PASSED-DATA = SPACES
  1339         SET PRT-INDEX TO +1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6892.cbl
  1340         GO TO ELPRTCVP-050.
  1341
  1342     SET PRT-INDEX TO WS-LINE-LEN.
  1343
  1344 ELPRTCVP-040.
  1345     IF WS-PRINT-BYTE (PRT-INDEX) NOT = SPACES
  1346         GO TO ELPRTCVP-050.
  1347
  1348     IF PRT-INDEX GREATER +1
  1349         SET PRT-INDEX DOWN BY +1
  1350         GO TO ELPRTCVP-040.
  1351
  1352 ELPRTCVP-050.
  1353     SET WS-LINE-LENGTH TO PRT-INDEX.
  1354     SET BUFFER-INDEX2 TO BUFFER-INDEX.
  1355     SET BUFFER-INDEX2 UP BY WS-LINE-LENGTH.
  1356
  1357     IF BUFFER-INDEX2 NOT LESS WS-BUFFER-SIZE
  1358         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  1359
  1360     IF TRIPLE-SPACE
  1361          ADD +2  TO  WS-LINE-CNT
  1362          MOVE T-SS           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1363                                 WS-BUFFER-BYTE (BUFFER-INDEX + 1)
  1364          SET BUFFER-INDEX UP BY +2.
  1365
  1366     IF DOUBLE-SPACE
  1367          ADD +1  TO  WS-LINE-CNT
  1368          MOVE T-SS             TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1369          SET BUFFER-INDEX UP BY +1.
  1370
  1371     ADD +1 TO WS-LINE-CNT
  1372************************************************************
  1373*     BYPASS NEW LINE SYMBOL                               *
  1374*        IF FIRST BUFFER SENT AND TOP-OF-FORM SET.         *
  1375*     OR IF FIRST LINE OF SUBSEQUENT BUFFERS.              *
  1376************************************************************
  1377
  1378     IF (BUFFER-INDEX GREATER +1 AND
  1379         WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-TP)  OR
  1380         FIRST-LINE-NEXT-BUFFER
  1381         MOVE ZERO               TO WS-FIRST-TIME-SW
  1382     ELSE
  1383         MOVE T-SS               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1384         SET BUFFER-INDEX UP BY +1.
  1385
  1386**   NOTE, SINGLE SPACE IS REQUIRED BEFORE TOP PAGE CHAR
  1387
  1388     IF TOP-PAGE
  1389         MOVE +1                TO WS-LINE-CNT
  1390         MOVE T-TP              TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1391         SET BUFFER-INDEX UP BY +1.
  1392
  1393     SET PRT-INDEX TO +1.
  1394
  1395 ELPRTCVP-060.
  1396     MOVE WS-PRINT-BYTE (PRT-INDEX)
  1397                                 TO WS-BUFFER-BYTE (BUFFER-INDEX).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6892.cbl
  1398     SET BUFFER-INDEX UP BY +1.
  1399
  1400     IF PRT-INDEX LESS WS-LINE-LENGTH
  1401         SET PRT-INDEX UP BY +1
  1402         GO TO ELPRTCVP-060.
  1403
  1404 ELPRTCVP-EXIT.
  1405     EXIT.
  1406
  1407 ELPRTCVP-PRINT-BUFFER.
  1408     IF WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-SS
  1409        MOVE SPACE               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1410        SET BUFFER-INDEX UP BY 1.
  1411
  1412     MOVE  T-EM                  TO  WS-BUFFER-BYTE (BUFFER-INDEX)
  1413     SET WS-BUFFER-LENGTH TO BUFFER-INDEX.
  1414
  1415
  1416* EXEC CICS SEND
  1417*        FROM    (WS-BUFFER-AREA)
  1418*        LENGTH  (WS-BUFFER-LENGTH)
  1419*        CTLCHAR (WS-WCC-CNTL)
  1420*        ERASE
  1421*    END-EXEC.
  1422*    MOVE '$$    C E         L F ,   #00001235' TO DFHEIV0
  1423     MOVE X'242420202020432045202020' TO DFHEIV0(1:12)
  1424     MOVE X'2020202020204C2046202C20' TO DFHEIV0(13:12)
  1425     MOVE X'2020233030303031323335' TO DFHEIV0(25:11)
  1426     CALL 'kxdfhei1' USING DFHEIV0,
  1427           WS-BUFFER-AREA,
  1428           WS-BUFFER-LENGTH,
  1429           DFHEIV99,
  1430           DFHEIV99,
  1431           WS-WCC-CNTL,
  1432           DFHEIV99,
  1433           DFHEIV99,
  1434           DFHEIV99,
  1435           DFHEIV99,
  1436           DFHEIV99,
  1437           DFHEIV99
  1438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1439
  1440
  1441     SET BUFFER-INDEX TO +1.
  1442     MOVE '2'                    TO WS-FIRST-TIME-SW.
  1443
  1444 ELPRTCVP-PRINT-EXIT.
  1445     EXIT.
  1446
  1447
  1448
  1449 9999-GOBACK.
  1450
  1451
  1452* GOBACK.
  1453     MOVE '9%                    "   ' TO DFHEIV0
  1454     MOVE 'EL6892' TO DFHEIV1
  1455     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6892.cbl
  1456     GOBACK.
  1457
  1458 9999-EXIT.
  1459     EXIT.
  1460
  1461 9999-DFHBACK SECTION.
  1462     MOVE '9%                    "   ' TO DFHEIV0
  1463     MOVE 'EL6892' TO DFHEIV1
  1464     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1465     GOBACK.
  1466 9999-DFHEXIT.
  1467     IF DFHEIGDJ EQUAL 0001
  1468         NEXT SENTENCE
  1469     ELSE IF DFHEIGDJ EQUAL 2
  1470         GO TO 0200-END-DATA,
  1471               0300-NOT-FOUND
  1472         DEPENDING ON DFHEIGDI
  1473     ELSE IF DFHEIGDJ EQUAL 3
  1474         GO TO 1090-TS-QIDERR,
  1475               1089-TS-ITEMERR
  1476         DEPENDING ON DFHEIGDI
  1477     ELSE IF DFHEIGDJ EQUAL 4
  1478         GO TO 7750-EXIT
  1479         DEPENDING ON DFHEIGDI.
  1480     MOVE '9%                    "   ' TO DFHEIV0
  1481     MOVE 'EL6892' TO DFHEIV1
  1482     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1483     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8456     Code:        4042
