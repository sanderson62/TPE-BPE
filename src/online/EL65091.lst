* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   1
* EL65091.cbl
* Options: int("EL65091.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL65091.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL65091.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL65091.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL65091.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 08:35:33.
     7*                            VMOD=2.003.
     8*
     9*
    10*AUTHOR.     LOGIC INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   2
* EL65091.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION - EXDB - ACCOUNT NOTEPAD PRINT ROUTINE.
    25
    26******************************************************************
    27*                   C H A N G E   L O G
    28*
    29* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    30*-----------------------------------------------------------------
    31*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    32* EFFECTIVE    NUMBER
    33*-----------------------------------------------------------------
    34* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
    35*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
    36******************************************************************
    37 ENVIRONMENT DIVISION.
    38
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   3
* EL65091.cbl
    40 DATA DIVISION.
    41 WORKING-STORAGE SECTION.
    42 01  DFH-START PIC X(04).
    43 77  FILLER  PIC X(32) VALUE '********************************'.
    44 77  FILLER  PIC X(32) VALUE '*   EL65091  WORKING-STORAGE   *'.
    45 77  FILLER  PIC X(32) VALUE '*********** V/M 2.003 **********'.
    46
    47 77  WS-LEN  PIC S9(4)  COMP    VALUE +326.
    48
    49 77  WS-SAVED-PI-COMPANY-ID     PIC XXX.
    50
    51 01  STANDARD-AREAS.
    52     12  W-DELAY-CNT             PIC S9(3)  COMP-3 VALUE ZERO.
    53     12  W-DELAY-INTERVAL        PIC S9(7)  COMP-3 VALUE +2.
    54     12  PGM-NAME                PIC X(8).
    55     12  LINK-001                PIC X(8)    VALUE  'EL001'.
    56     12  LINK-004                PIC X(8)    VALUE  'EL004'.
    57     12  LINK-ELDATCV            PIC X(8)    VALUE  'ELDATCV'.
    58     12  ERROR-LINE              PIC X(70).
    59
    60     12  W-DATE-AREA.
    61         16  W-CURRENT-DATE      PIC X(8)    VALUE SPACES.
    62         16  W-CURRENT-BIN-DATE  PIC X(2)    VALUE SPACES.
    63
    64     12  LINE-CNT                PIC S9(3)  COMP-3 VALUE ZERO.
    65     12  WS-TERMINAL-ID.
    66         16  WS-TERM-PREFIX      PIC XX.
    67         16  FILLER              PIC XX.
    68     12  ERACNT-FILE-ID          PIC X(8) VALUE 'ERACNT'.
    69     12  ERACCT-FILE-ID          PIC X(8) VALUE 'ERACCT'.
    70     12  FIRST-TIME-SW           PIC X  VALUE 'Y'.
    71         88 FIRST-ONE            VALUE 'Y'.
    72     12  ERACNT-KEY-LENGTH       PIC S9(4)   COMP  VALUE +23.
    73     12  ERACNT-START-LENGTH     PIC S9(4)   COMP  VALUE +21.
    74
    75     12  ERACNT-KEY.
    76         16  ERACNT-PARTIAL-KEY.
    77             20  ERACNT-COMPANY-CD    PIC X.
    78             20  ERACNT-CARRIER       PIC X.
    79             20  ERACNT-GROUPING      PIC X(06).
    80             20  ERACNT-STATE         PIC X(02).
    81             20  ERACNT-ACCOUNT       PIC X(10).
    82             20  ERACNT-REC-TYP       PIC X.
    83         16  ERACNT-SEQ          PIC S9(4) COMP.
    84
    85     12  ERACCT-KEY.
    86         16  ERACCT-PARTIAL-KEY.
    87             20  ERACCT-COMPANY-CD    PIC X.
    88             20  ERACCT-CARRIER       PIC X.
    89             20  ERACCT-GROUPING      PIC X(06).
    90             20  ERACCT-STATE         PIC X(02).
    91             20  ERACCT-ACCOUNT       PIC X(10).
    92         16  ERACCT-EXP-DT       PIC XX.
    93
    94     12  W-PRIOR-KEY.
    95         16  W-PRIOR-PARTIAL-KEY.
    96             20  W-PRIOR-COMPANY-CD   PIC X.
    97             20  W-PRIOR-CARRIER      PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   4
* EL65091.cbl
    98             20  W-PRIOR-GROUPING     PIC X(06).
    99             20  W-PRIOR-STATE        PIC X(02).
   100             20  W-PRIOR-ACCOUNT      PIC X(10).
   101             20  W-PRIOR-REC-TYP      PIC X.
   102         16  W-PRIOR-SEQ         PIC S9(4) COMP.
   103
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   5
* EL65091.cbl
   105 01  PRT-LINES.
   106     05  HEAD-LINE-1.
   107         10  FILLER              PIC X(01)    VALUE SPACES.
   108         10  H1-DATE             PIC X(08)    VALUE SPACES.
   109         10  FILLER              PIC X(22)    VALUE SPACES.
   110         10  FILLER              PIC X(18)    VALUE
   111             ' ACCOUNT NOTEPAD  '.
   112         10  FILLER              PIC X(23)    VALUE SPACES.
   113         10  THIS-PGM            PIC X(7)     VALUE 'EL65091'.
   114         10  FILLER              PIC X(01)    VALUE SPACES.
   115
   116     05  HEAD-LINE-ACCOUNT.
   117         10  FILLER              PIC X(01)    VALUE SPACES.
   118         10  FILLER              PIC X(07)    VALUE
   119            'CARRIER'.
   120         10  FILLER              PIC X(01)    VALUE SPACES.
   121         10  FILLER              PIC X(08)    VALUE
   122            'GROUPING'.
   123         10  FILLER              PIC X(02)    VALUE SPACES.
   124         10  FILLER              PIC X(05)    VALUE
   125            'STATE'.
   126         10  FILLER              PIC X(04)    VALUE SPACES.
   127         10  FILLER              PIC X(07)    VALUE
   128            'ACCOUNT'.
   129         10  FILLER              PIC X(07)    VALUE SPACES.
   130         10  FILLER              PIC X(04)    VALUE
   131            'NAME'.
   132         10  FILLER              PIC X(34)    VALUE SPACES.
   133
   134     05  DETAIL-LINE-ACCOUNT.
   135         10  FILLER              PIC X(01)    VALUE SPACES.
   136         10  FILLER              PIC X(03)    VALUE SPACES.
   137         10  DA-CARRIER          PIC X(01)    VALUE SPACES.
   138         10  FILLER              PIC X(05)    VALUE SPACES.
   139         10  DA-GROUPING         PIC X(06)    VALUE SPACES.
   140         10  FILLER              PIC X(05)    VALUE SPACES.
   141         10  DA-STATE            PIC X(02)    VALUE SPACES.
   142         10  FILLER              PIC X(04)    VALUE SPACES.
   143         10  DA-ACCOUNT          PIC X(10)    VALUE SPACES.
   144         10  FILLER              PIC X(05)    VALUE SPACES.
   145         10  DA-ACCT-NAME        PIC X(30)    VALUE SPACES.
   146         10  FILLER              PIC X(08)    VALUE SPACES.
   147
   148     05  HEAD-LINE-2.
   149         10  FILLER             PIC X(69)    VALUE SPACES.
   150         10  FILLER             PIC X(10)    VALUE
   151            'CHG       '.
   152         10  FILLER             PIC X(01)    VALUE SPACES.
   153
   154     05  HEAD-LINE-3.
   155         10  FILLER             PIC X(01)    VALUE SPACES.
   156         10  FILLER             PIC X(12)    VALUE
   157             'LINE    TEXT'.
   158         10  FILLER             PIC X(57)    VALUE SPACES.
   159         10  FILLER             PIC X(09)    VALUE
   160            'BY  DATE '.
   161         10  FILLER             PIC X(01)    VALUE SPACES.
   162
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   6
* EL65091.cbl
   163     05  DETAIL-LINE-1.
   164         10  FILLER             PIC X        VALUE SPACES.
   165         10  D1-LINE-NO         PIC Z99      VALUE ZEROS.
   166         10  FILLER             PIC X(01)    VALUE ' '.
   167         10  D1-TEXT            PIC X(60)    VALUE '*'.
   168         10  FILLER             PIC X(01)    VALUE SPACES.
   169         10  FILLER             PIC X(01)    VALUE SPACES.
   170         10  FILLER             PIC X(01)    VALUE SPACES.
   171         10  D1-MAINT-BY        PIC X(04)    VALUE SPACES.
   172         10  FILLER             PIC X        VALUE SPACES.
   173         10  D1-MAINT-DT        PIC X(6)     VALUE SPACES.
   174         10  FILLER             PIC X        VALUE SPACES.
   175*                                COPY ELCDMD34.
   176******************************************************************
   177*                                                                *
   178*                                                                *
   179*                            ELCDMD34.                           *
   180*                            VMOD=2.001                          *
   181*                                                                *
   182*   FILE DESCRIPTION = DMD DLO034 PARAMETER AREA                 *
   183*                                                                *
   184*    LENGTH = 272    RECFRM = FIXED                              *
   185*                                                                *
   186******************************************************************
   187 01  DLO034-COMMUNICATION-AREA.
   188     12  DL34-PROCESS-TYPE             PIC X.
   189     12  DL34-COMPANY-ID               PIC XXX.
   190     12  DL34-PRINT-PROGRAM-ID         PIC X(8).
   191     12  DL34-USERID                   PIC X(4).
   192     12  DL34-PRINT-LINE               PIC X(250).
   193     12  DL34-OVERRIDE-PRINTER-ID      PIC X(4).
   194     12  DL34-RETURN-CODE              PIC XX.
   195 01  DLO034-REC-LENGTH                 PIC S9(4) COMP VALUE +272.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   7
* EL65091.cbl
   197*                                COPY ELCAID.
   198******************************************************************
   199*                                                                *
   200*                            ELCAID.                             *
   201*                            VMOD=2.001                          *
   202*                                                                *
   203*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   204*                                                                *
   205*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   206*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   207******************************************************************
   208
   209 01  DFHAID.
   210   02  DFHNULL   PIC  X  VALUE  ' '.
   211   02  DFHENTER  PIC  X  VALUE  QUOTE.
   212   02  DFHCLEAR  PIC  X  VALUE  '_'.
   213   02  DFHPEN    PIC  X  VALUE  '='.
   214   02  DFHOPID   PIC  X  VALUE  'W'.
   215   02  DFHPA1    PIC  X  VALUE  '%'.
   216   02  DFHPA2    PIC  X  VALUE  '>'.
   217   02  DFHPA3    PIC  X  VALUE  ','.
   218   02  DFHPF1    PIC  X  VALUE  '1'.
   219   02  DFHPF2    PIC  X  VALUE  '2'.
   220   02  DFHPF3    PIC  X  VALUE  '3'.
   221   02  DFHPF4    PIC  X  VALUE  '4'.
   222   02  DFHPF5    PIC  X  VALUE  '5'.
   223   02  DFHPF6    PIC  X  VALUE  '6'.
   224   02  DFHPF7    PIC  X  VALUE  '7'.
   225   02  DFHPF8    PIC  X  VALUE  '8'.
   226   02  DFHPF9    PIC  X  VALUE  '9'.
   227   02  DFHPF10   PIC  X  VALUE  ':'.
   228   02  DFHPF11   PIC  X  VALUE  '#'.
   229   02  DFHPF12   PIC  X  VALUE  '@'.
   230   02  DFHPF13   PIC  X  VALUE  'A'.
   231   02  DFHPF14   PIC  X  VALUE  'B'.
   232   02  DFHPF15   PIC  X  VALUE  'C'.
   233   02  DFHPF16   PIC  X  VALUE  'D'.
   234   02  DFHPF17   PIC  X  VALUE  'E'.
   235   02  DFHPF18   PIC  X  VALUE  'F'.
   236   02  DFHPF19   PIC  X  VALUE  'G'.
   237   02  DFHPF20   PIC  X  VALUE  'H'.
   238   02  DFHPF21   PIC  X  VALUE  'I'.
   239*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   240   02  DFHPF22   PIC  X  VALUE  '['.
   241   02  DFHPF23   PIC  X  VALUE  '.'.
   242   02  DFHPF24   PIC  X  VALUE  '<'.
   243   02  DFHMSRE   PIC  X  VALUE  'X'.
   244   02  DFHSTRF   PIC  X  VALUE  'h'.
   245   02  DFHTRIG   PIC  X  VALUE  '"'.
   246 01  PF-AID REDEFINES DFHAID.
   247     05  FILLER                  PIC X(8).
   248     05  PF-VALUES  OCCURS 24    PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   8
* EL65091.cbl
   250*                                COPY ELPRTCVD.
   251*****************************************************************
   252*                                                               *
   253*                            ELPRTCVD.                          *
   254*                            VMOD=2.001                         *
   255*****************************************************************.
   256
   257******************************************************************
   258***   WORK AREAS  FOR TERMINAL ONLINE PRINT ROUTINE
   259***                 -ELPRTCVD-
   260***   TO BE USED WITH PROCEDURE COPY MEMBER -ELPRTCVP-
   261******************************************************************
   262
   263 01  S-WORK-AREA                     SYNC.
   264     12  WS-LINE-LEN                 PIC S9(4)       VALUE +80
   265                                     COMP.
   266
   267     12  WS-LINE-LENGTH              PIC S9(4)       VALUE ZERO
   268                                     COMP.
   269
   270     12  WS-BUFFER-SIZE              PIC S9(4)       VALUE +1916
   271                                     COMP.
   272
   273     12  WS-BUFFER-LENGTH            PIC S9(4)       VALUE ZERO
   274                                     COMP.
   275
   276     12  WS-PROG-END                 PIC X           VALUE SPACES.
   277
   278     12  WS-PRINT-AREA.
   279         16  WS-PASSED-CNTL-CHAR     PIC X           VALUE SPACES.
   280           88  SINGLE-SPACE                          VALUE ' '.
   281           88  DOUBLE-SPACE                          VALUE '0'.
   282           88  TRIPLE-SPACE                          VALUE '-'.
   283           88  TOP-PAGE                              VALUE '1'.
   284
   285         16  WS-PASSED-DATA.
   286             20  WS-PRINT-BYTE       PIC X
   287                 OCCURS 132 TIMES    INDEXED BY PRT-INDEX.
   288
   289     12  WS-LINE-CNT                 PIC S9(3)        VALUE ZERO
   290                                     COMP-3.
   291     12  WS-WCC-CNTL                 PIC X(1)         VALUE 'H'.
   292
   293     12  WS-EM                       PIC S9(4)        VALUE +25
   294                                     COMP.
   295     12  FILLER   REDEFINES WS-EM.
   296         16  FILLER                  PIC X.
   297         16  T-EM                    PIC X.
   298
   299*    12  WS-SS                       PIC S9(4)        VALUE +21
   300     12  WS-SS                       PIC S9(4)        VALUE +10
   301                                     COMP.
   302     12  FILLER   REDEFINES WS-SS.
   303         16  FILLER                  PIC X.
   304         16  T-SS                    PIC X.
   305
   306     12  WS-TP                       PIC S9(4)      VALUE +12
   307                                     COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   9
* EL65091.cbl
   308     12  FILLER   REDEFINES WS-TP.
   309         16  FILLER                  PIC X.
   310         16  T-TP                    PIC X.
   311
   312     12  WS-FIRST-TIME-SW            PIC X           VALUE '1'.
   313         88  FIRST-TIME                              VALUE '1'.
   314         88  FIRST-LINE-NEXT-BUFFER                  VALUE '2'.
   315
   316     12  WS-BUFFER-AREA.
   317         16  WS-BUFFER-BYTE          PIC X
   318             OCCURS 1920 TIMES       INDEXED BY BUFFER-INDEX
   319                                                BUFFER-INDEX2.
   320
   321******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  10
* EL65091.cbl
   323*                                COPY ELCINTF.
   324******************************************************************
   325*                                                                *
   326*                                                                *
   327*                            ELCINTF.                            *
   328*                            VMOD=2.017                          *
   329*                                                                *
   330*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   331*                                                                *
   332*       LENGTH = 1024                                            *
   333*                                                                *
   334******************************************************************
   335*                   C H A N G E   L O G
   336*
   337* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   338*-----------------------------------------------------------------
   339*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   340* EFFECTIVE    NUMBER
   341*-----------------------------------------------------------------
   342* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   343******************************************************************
   344 01  PROGRAM-INTERFACE-BLOCK.
   345     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   346     12  PI-CALLING-PROGRAM              PIC X(8).
   347     12  PI-SAVED-PROGRAM-1              PIC X(8).
   348     12  PI-SAVED-PROGRAM-2              PIC X(8).
   349     12  PI-SAVED-PROGRAM-3              PIC X(8).
   350     12  PI-SAVED-PROGRAM-4              PIC X(8).
   351     12  PI-SAVED-PROGRAM-5              PIC X(8).
   352     12  PI-SAVED-PROGRAM-6              PIC X(8).
   353     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   354     12  PI-COMPANY-ID                   PIC XXX.
   355     12  PI-COMPANY-CD                   PIC X.
   356
   357     12  PI-COMPANY-PASSWORD             PIC X(8).
   358
   359     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   360
   361     12  PI-CONTROL-IN-PROGRESS.
   362         16  PI-CARRIER                  PIC X.
   363         16  PI-GROUPING                 PIC X(6).
   364         16  PI-STATE                    PIC XX.
   365         16  PI-ACCOUNT                  PIC X(10).
   366         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   367                                         PIC X(10).
   368         16  PI-CLAIM-CERT-GRP.
   369             20  PI-CLAIM-NO             PIC X(7).
   370             20  PI-CERT-NO.
   371                 25  PI-CERT-PRIME       PIC X(10).
   372                 25  PI-CERT-SFX         PIC X.
   373             20  PI-CERT-EFF-DT          PIC XX.
   374         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   375             20  PI-PLAN-CODE            PIC X(2).
   376             20  PI-REVISION-NUMBER      PIC X(3).
   377             20  PI-PLAN-EFF-DT          PIC X(2).
   378             20  PI-PLAN-EXP-DT          PIC X(2).
   379             20  FILLER                  PIC X(11).
   380         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  11
* EL65091.cbl
   381             20  PI-OE-REFERENCE-1.
   382                 25  PI-OE-REF-1-PRIME   PIC X(18).
   383                 25  PI-OE-REF-1-SUFF    PIC XX.
   384
   385     12  PI-SESSION-IN-PROGRESS          PIC X.
   386         88  CLAIM-SESSION                   VALUE '1'.
   387         88  CREDIT-SESSION                  VALUE '2'.
   388         88  WARRANTY-SESSION                VALUE '3'.
   389         88  MORTGAGE-SESSION                VALUE '4'.
   390         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   391
   392
   393*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   394
   395     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   396     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   397
   398     12  PI-CREDIT-USER                  PIC X.
   399         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   400         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   401
   402     12  PI-CLAIM-USER                   PIC X.
   403         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   404         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   405
   406     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   407         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   408         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   409         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   410         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   411         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   412
   413     12  PI-PROCESSOR-ID                 PIC X(4).
   414
   415     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   416
   417     12  PI-MEMBER-CAPTION               PIC X(10).
   418
   419     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   420         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   421
   422     12  PI-LIFE-OVERRIDE-L1             PIC X.
   423     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   424     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   425     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   426
   427     12  PI-AH-OVERRIDE-L1               PIC X.
   428     12  PI-AH-OVERRIDE-L2               PIC XX.
   429     12  PI-AH-OVERRIDE-L6               PIC X(6).
   430     12  PI-AH-OVERRIDE-L12              PIC X(12).
   431
   432     12  PI-NEW-SYSTEM                   PIC X(2).
   433
   434     12  PI-PRIMARY-CERT-NO              PIC X(11).
   435     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   436         88  PI-USES-PAID-TO                 VALUE '1'.
   437     12  PI-CRDTCRD-SYSTEM.
   438         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  12
* EL65091.cbl
   439             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   440             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   441         16  PI-CC-MONTH-END-DT          PIC XX.
   442     12  PI-PROCESSOR-PRINTER            PIC X(4).
   443
   444     12  PI-OE-REFERENCE-2.
   445         16  PI-OE-REF-2-PRIME           PIC X(10).
   446         16  PI-OE-REF-2-SUFF            PIC X.
   447
   448     12  PI-REM-TRM-CALC-OPTION          PIC X.
   449
   450     12  PI-LANGUAGE-TYPE                PIC X.
   451             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   452             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   453             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   454
   455     12  PI-POLICY-LINKAGE-IND           PIC X.
   456         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   457         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   458                                                   LOW-VALUES.
   459
   460     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   461     12  PI-CLAIM-PW-SESSION             PIC X(1).
   462         88  PI-CLAIM-CREDIT                 VALUE '1'.
   463         88  PI-CLAIM-CONVEN                 VALUE '2'.
   464
   465     12  PI-PROCESSOR-CSR-IND            PIC X.
   466         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   467         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   468
   469     12  FILLER                          PIC X(3).
   470
   471     12  PI-SYSTEM-LEVEL                 PIC X(145).
   472
   473     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   474         PI-SYSTEM-LEVEL.
   475
   476         16  PI-ENTRY-CODES.
   477             20  PI-ENTRY-CD-1           PIC X.
   478             20  PI-ENTRY-CD-2           PIC X.
   479
   480         16  PI-RETURN-CODES.
   481             20  PI-RETURN-CD-1          PIC X.
   482             20  PI-RETURN-CD-2          PIC X.
   483
   484         16  PI-UPDATE-STATUS-SAVE.
   485             20  PI-UPDATE-BY            PIC X(4).
   486             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   487
   488         16  PI-LOWER-CASE-LETTERS       PIC X.
   489             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   490
   491*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   492*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   493*            88  CARRIER-CLM-CNTL            VALUE '2'.
   494
   495         16  PI-CERT-ACCESS-CONTROL      PIC X.
   496             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  13
* EL65091.cbl
   497             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   498             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   499             88  ACCNT-CNTL                  VALUE '3'.
   500             88  CARR-ACCNT-CNTL             VALUE '4'.
   501
   502         16  PI-PROCESSOR-CAP-LIST.
   503             20  PI-SYSTEM-CONTROLS.
   504                24 PI-SYSTEM-DISPLAY     PIC X.
   505                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   506                24 PI-SYSTEM-MODIFY      PIC X.
   507                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   508             20  FILLER                  PIC XX.
   509             20  PI-DISPLAY-CAP          PIC X.
   510                 88  DISPLAY-CAP             VALUE 'Y'.
   511             20  PI-MODIFY-CAP           PIC X.
   512                 88  MODIFY-CAP              VALUE 'Y'.
   513             20  PI-MSG-AT-LOGON-CAP     PIC X.
   514                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   515             20  PI-FORCE-CAP            PIC X.
   516                 88  FORCE-CAP               VALUE 'Y'.
   517
   518         16  PI-PROGRAM-CONTROLS.
   519             20  PI-PGM-PRINT-OPT        PIC X.
   520             20  PI-PGM-FORMAT-OPT       PIC X.
   521             20  PI-PGM-PROCESS-OPT      PIC X.
   522             20  PI-PGM-TOTALS-OPT       PIC X.
   523
   524         16  PI-HELP-INTERFACE.
   525             20  PI-LAST-ERROR-NO        PIC X(4).
   526             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   527
   528         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   529             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   530
   531         16  PI-CR-CONTROL-IN-PROGRESS.
   532             20  PI-CR-CARRIER           PIC X.
   533             20  PI-CR-GROUPING          PIC X(6).
   534             20  PI-CR-STATE             PIC XX.
   535             20  PI-CR-ACCOUNT           PIC X(10).
   536             20  PI-CR-FIN-RESP          PIC X(10).
   537             20  PI-CR-TYPE              PIC X.
   538
   539         16  PI-CR-BATCH-NUMBER          PIC X(6).
   540
   541         16  PI-CR-MONTH-END-DT          PIC XX.
   542
   543         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   544             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   545             88  PI-ZERO-CARRIER             VALUE '1'.
   546             88  PI-ZERO-GROUPING            VALUE '2'.
   547             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   548
   549         16  PI-CARRIER-SECURITY         PIC X.
   550             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   551
   552         16  PI-ACCOUNT-SECURITY         PIC X(10).
   553             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   554             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  14
* EL65091.cbl
   555
   556         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   557             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   558                                         INDEXED BY PI-ACCESS-NDX
   559                                         PIC X.
   560
   561         16  PI-GA-BILLING-CONTROL       PIC X.
   562             88  PI-GA-BILLING               VALUE '1'.
   563
   564         16  PI-MAIL-PROCESSING          PIC X.
   565             88  PI-MAIL-YES                 VALUE 'Y'.
   566
   567         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   568
   569         16  PI-AR-SYSTEM.
   570             20  PI-AR-PROCESSING-CNTL   PIC X.
   571                 88  PI-AR-PROCESSING        VALUE 'Y'.
   572             20  PI-AR-SUMMARY-CODE      PIC X(6).
   573             20  PI-AR-MONTH-END-DT      PIC XX.
   574
   575         16  PI-MP-SYSTEM.
   576             20  PI-MORTGAGE-USER            PIC X.
   577                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   578                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   579             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   580                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   581                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   582                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   583                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   584                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   585             20  PI-MP-MONTH-END-DT          PIC XX.
   586             20  PI-MP-REFERENCE-NO.
   587                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   588                 24  PI-MP-REFERENCE-SFX     PIC XX.
   589
   590         16  PI-LABEL-CONTROL            PIC X(01).
   591             88  PI-CREATE-LABELS                    VALUE 'Y'.
   592             88  PI-BYPASS-LABELS                    VALUE 'N'.
   593
   594         16  PI-BILL-GROUPING-CODE       PIC X(01).
   595             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   596
   597         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   598             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   599             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   600
   601         16  FILLER                      PIC X(14).
   602
   603     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   604******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  15
* EL65091.cbl
   606*                                COPY ELC650PI.
   607******************************************************************
   608*
   609*                            ELC650PI.
   610*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   611*                            VMOD=2.007
   612*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
   613*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
   614* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
   615*
   616******************************************************************
   617******************************************************************
   618*                   C H A N G E   L O G
   619*
   620* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   621*-----------------------------------------------------------------
   622*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   623* EFFECTIVE    NUMBER
   624*-----------------------------------------------------------------
   625* 101916  IR2016101900001  PEMA  Inc tot line to 3 bytes
   626
   627     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   628         16  PI-MAINT                   PIC X.
   629         16  PI-PREV-ACCOUNT            PIC X(20).
   630         16  PI-PREV-VG-ACCOUNT         PIC X(20).
   631         16  PI-ACCT-KEY.
   632             20  PI-ACCT-CCGSA-KEY.
   633                 24  PI-ACCT-CO             PIC X.
   634                 24  PI-ACCT-CARRIER        PIC X.
   635                 24  PI-ACCT-GROUPING       PIC X(6).
   636                 24  PI-ACCT-STATE          PIC XX.
   637                 24  PI-ACCT-ACCOUNT        PIC X(10).
   638             20  PI-ACCT-EXP-DT           PIC XX.
   639             20  PI-ACCT-REST-OF-EXP      PIC X(4).
   640         16  PI-ACCT-ID                 PIC X(8).
   641         16  PI-PLAN-KEY.
   642             20  PI-PLAN-ACCT-KEY.
   643                 24  PI-PLAN-COMPANY-CD PIC X.
   644                 24  PI-PLAN-CARRIER    PIC X.
   645                 24  PI-PLAN-GROUP      PIC X(6).
   646                 24  PI-PLAN-STATE      PIC X(2).
   647                 24  PI-PLAN-ACCOUNT    PIC X(10).
   648             20  PI-PLAN-BEN-TYPE       PIC X.
   649             20  PI-PLAN-BEN            PIC XX.
   650             20  PI-PLAN-REVISION       PIC X(3).
   651         16  PI-WS-STATE                PIC XX.
   652         16  PI-WS-CLASS                PIC XX.
   653         16  PI-WS-DEV                  PIC X(3).
   654         16  PI-WS-TYPE                 PIC X.
   655         16  PI-WS-PLAN                 PIC XX.
   656
   657         16  PI-ERPNDB-ALT-KEY.
   658             20  PI-PB-COMPANY-CD-A1    PIC X.
   659             20  PI-PB-CARRIER          PIC X.
   660             20  PI-PB-GROUPING         PIC X(6).
   661             20  PI-PB-STATE            PIC XX.
   662             20  PI-PB-ACCOUNT          PIC X(10).
   663             20  PI-PB-CERT-EFF-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  16
* EL65091.cbl
   664             20  PI-PB-CERT-NO          PIC X(10).
   665             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
   666             20  PI-PB-RECORD-TYPE      PIC X.
   667
   668         16  PI-DATE-RANGE-TABLE.
   669             20  PI-TABLE-ENT OCCURS 32 TIMES
   670                            INDEXED BY T-INDEX.
   671                 24  PI-BIN-EFF-DT          PIC XX.
   672                 24  PI-BIN-EXP-DT          PIC XX.
   673                 24  PI-BIN-MAINT-DT        PIC XX.
   674                 24  PI-BIN-LO-CERT         PIC XX.
   675                 24  PI-BIN-AR-HI-CERT      PIC XX.
   676                 24  PI-BIN-HI-CERT         PIC XX.
   677         16  PI-PAGE-NUMBER             PIC S9.
   678             88  PI-FST-PAGE               VALUE +1.
   679             88  PI-2ND-PAGE               VALUE +2.
   680             88  PI-3RD-PAGE               VALUE +3.
   681             88  PI-LST-PAGE               VALUE +4.
   682         16  PI-TOTAL-LINES             PIC S999.
   683         16  PI-LINE-SELECTED    PIC S9.
   684***  Y2K PROJ 7744
   685         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
   686         16  BIN-EFFCHG-SAVE     PIC XX.
   687         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
   688***  Y2K PROJ 7744
   689         16  BIN-EXPCHG-SAVE     PIC XX.
   690         16  PI-RECORD-ADDED-SW  PIC X.
   691             88  PI-RECORD-ADDED            VALUE '1'.
   692             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
   693         16  PI-ACCNAME          PIC X(30).
   694         16  PI-COMM-POINTER     PIC S9(8)   COMP.
   695         16  PI-SV-MAINT         PIC X.
   696         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
   697         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
   698         16  PI-UPDATE-SW        PIC X.
   699             88  PI-CHANGES-MADE             VALUE '1'.
   700         16  PI-NOTE-TYPE        PIC X.
   701             88  PI-ACCT-NOTE                VALUE '1'.
   702         16  PI-DMD-FILE-SW      PIC X.
   703             88  END-OF-FILE                 VALUE 'E'.
   704             88  INTO-NEXT-BENEFITS          VALUE 'I'.
   705             88  FIRST-OCCURS                VALUE 'F'.
   706         16  PI-DMD-OCCURS       PIC S999.
   707         16  PI-DMD-SCREEN       PIC X.
   708             88  SCREEN-1-DISPLAYED  VALUE '1'.
   709             88  SCREEN-2-DISPLAYED  VALUE '2'.
   710             88  SCREEN-3-DISPLAYED  VALUE '3'.
   711         16  PI-NAMEFLG          PIC X.
   712         16  PI-EL650-DEL-SW     PIC X.
   713         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
   714         16  PI-DCC-PROD-CODE    PIC XXX.
   715         16  FILLER              PIC X(34).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  17
* EL65091.cbl
   718*                                COPY ELCDATE.
   719******************************************************************
   720*                                                                *
   721*                                                                *
   722*                            ELCDATE.                            *
   723*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   724*                            VMOD=2.003
   725*                                                                *
   726*                                                                *
   727*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   728*                 LENGTH = 200                                   *
   729******************************************************************
   730
   731 01  DATE-CONVERSION-DATA.
   732     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   733     12  DC-OPTION-CODE                PIC X.
   734         88  BIN-TO-GREG                VALUE ' '.
   735         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   736         88  EDIT-GREG-TO-BIN           VALUE '2'.
   737         88  YMD-GREG-TO-BIN            VALUE '3'.
   738         88  MDY-GREG-TO-BIN            VALUE '4'.
   739         88  JULIAN-TO-BIN              VALUE '5'.
   740         88  BIN-PLUS-ELAPSED           VALUE '6'.
   741         88  FIND-CENTURY               VALUE '7'.
   742         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   743         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   744         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   745         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   746         88  JULIAN-TO-BIN-3            VALUE 'C'.
   747         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   748         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   749         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   750         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   751         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   752         88  CHECK-LEAP-YEAR            VALUE 'H'.
   753         88  BIN-3-TO-GREG              VALUE 'I'.
   754         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   755         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   756         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   757         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   758         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   759         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   760         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   761         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   762         88  THREE-CHARACTER-BIN
   763                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   764         88  GREGORIAN-TO-BIN
   765                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   766         88  BIN-TO-GREGORIAN
   767                  VALUES ' ' '1' 'I' '8' 'G'.
   768         88  JULIAN-TO-BINARY
   769                  VALUES '5' 'C' 'E' 'F'.
   770     12  DC-ERROR-CODE                 PIC X.
   771         88  NO-CONVERSION-ERROR        VALUE ' '.
   772         88  DATE-CONVERSION-ERROR
   773                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   774         88  DATE-IS-ZERO               VALUE '1'.
   775         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  18
* EL65091.cbl
   776         88  DATE-IS-INVALID            VALUE '3'.
   777         88  DATE1-GREATER-DATE2        VALUE '4'.
   778         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   779         88  DATE-INVALID-OPTION        VALUE '9'.
   780         88  INVALID-CENTURY            VALUE 'A'.
   781         88  ONLY-CENTURY               VALUE 'B'.
   782         88  ONLY-LEAP-YEAR             VALUE 'C'.
   783         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   784     12  DC-END-OF-MONTH               PIC X.
   785         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   786     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   787         88  USE-NORMAL-PROCESS         VALUE ' '.
   788         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   789         88  ADJUST-UP-100-YRS          VALUE '2'.
   790     12  FILLER                        PIC X.
   791     12  DC-CONVERSION-DATES.
   792         16  DC-BIN-DATE-1             PIC XX.
   793         16  DC-BIN-DATE-2             PIC XX.
   794         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   795         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   796                       DC-GREG-DATE-1-EDIT.
   797             20  DC-EDIT1-MONTH        PIC 99.
   798             20  SLASH1-1              PIC X.
   799             20  DC-EDIT1-DAY          PIC 99.
   800             20  SLASH1-2              PIC X.
   801             20  DC-EDIT1-YEAR         PIC 99.
   802         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   803         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   804                     DC-GREG-DATE-2-EDIT.
   805             20  DC-EDIT2-MONTH        PIC 99.
   806             20  SLASH2-1              PIC X.
   807             20  DC-EDIT2-DAY          PIC 99.
   808             20  SLASH2-2              PIC X.
   809             20  DC-EDIT2-YEAR         PIC 99.
   810         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   811         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   812                     DC-GREG-DATE-1-YMD.
   813             20  DC-YMD-YEAR           PIC 99.
   814             20  DC-YMD-MONTH          PIC 99.
   815             20  DC-YMD-DAY            PIC 99.
   816         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   817         16  DC-GREG-DATE-1-MDY-R REDEFINES
   818                      DC-GREG-DATE-1-MDY.
   819             20  DC-MDY-MONTH          PIC 99.
   820             20  DC-MDY-DAY            PIC 99.
   821             20  DC-MDY-YEAR           PIC 99.
   822         16  DC-GREG-DATE-1-ALPHA.
   823             20  DC-ALPHA-MONTH        PIC X(10).
   824             20  DC-ALPHA-DAY          PIC 99.
   825             20  FILLER                PIC XX.
   826             20  DC-ALPHA-CENTURY.
   827                 24 DC-ALPHA-CEN-N     PIC 99.
   828             20  DC-ALPHA-YEAR         PIC 99.
   829         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   830         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   831         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   832         16  DC-JULIAN-DATE            PIC 9(05).
   833         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  19
* EL65091.cbl
   834                                       PIC 9(05).
   835         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   836             20  DC-JULIAN-YEAR        PIC 99.
   837             20  DC-JULIAN-DAYS        PIC 999.
   838         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   839         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   840         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   841     12  DATE-CONVERSION-VARIBLES.
   842         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   843         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   844             20  FILLER                PIC 9(3).
   845             20  HOLD-CEN-1-CCYY.
   846                 24  HOLD-CEN-1-CC     PIC 99.
   847                 24  HOLD-CEN-1-YY     PIC 99.
   848             20  HOLD-CEN-1-MO         PIC 99.
   849             20  HOLD-CEN-1-DA         PIC 99.
   850         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   851             20  HOLD-CEN-1-R-MO       PIC 99.
   852             20  HOLD-CEN-1-R-DA       PIC 99.
   853             20  HOLD-CEN-1-R-CCYY.
   854                 24  HOLD-CEN-1-R-CC   PIC 99.
   855                 24  HOLD-CEN-1-R-YY   PIC 99.
   856             20  FILLER                PIC 9(3).
   857         16  HOLD-CENTURY-1-X.
   858             20  FILLER                PIC X(3)  VALUE SPACES.
   859             20  HOLD-CEN-1-X-CCYY.
   860                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   861                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   862             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   863             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   864         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   865             20  HOLD-CEN-1-R-X-MO     PIC XX.
   866             20  HOLD-CEN-1-R-X-DA     PIC XX.
   867             20  HOLD-CEN-1-R-X-CCYY.
   868                 24  HOLD-CEN-1-R-X-CC PIC XX.
   869                 24  HOLD-CEN-1-R-X-YY PIC XX.
   870             20  FILLER                PIC XXX.
   871         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   872         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   873         16  DC-JULIAN-DATE-1          PIC 9(07).
   874         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   875             20  DC-JULIAN-1-CCYY.
   876                 24  DC-JULIAN-1-CC    PIC 99.
   877                 24  DC-JULIAN-1-YR    PIC 99.
   878             20  DC-JULIAN-DA-1        PIC 999.
   879         16  DC-JULIAN-DATE-2          PIC 9(07).
   880         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   881             20  DC-JULIAN-2-CCYY.
   882                 24  DC-JULIAN-2-CC    PIC 99.
   883                 24  DC-JULIAN-2-YR    PIC 99.
   884             20  DC-JULIAN-DA-2        PIC 999.
   885         16  DC-GREG-DATE-A-EDIT.
   886             20  DC-EDITA-MONTH        PIC 99.
   887             20  SLASHA-1              PIC X VALUE '/'.
   888             20  DC-EDITA-DAY          PIC 99.
   889             20  SLASHA-2              PIC X VALUE '/'.
   890             20  DC-EDITA-CCYY.
   891                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  20
* EL65091.cbl
   892                 24  DC-EDITA-YEAR     PIC 99.
   893         16  DC-GREG-DATE-B-EDIT.
   894             20  DC-EDITB-MONTH        PIC 99.
   895             20  SLASHB-1              PIC X VALUE '/'.
   896             20  DC-EDITB-DAY          PIC 99.
   897             20  SLASHB-2              PIC X VALUE '/'.
   898             20  DC-EDITB-CCYY.
   899                 24  DC-EDITB-CENT     PIC 99.
   900                 24  DC-EDITB-YEAR     PIC 99.
   901         16  DC-GREG-DATE-CYMD         PIC 9(08).
   902         16  DC-GREG-DATE-CYMD-R REDEFINES
   903                              DC-GREG-DATE-CYMD.
   904             20  DC-CYMD-CEN           PIC 99.
   905             20  DC-CYMD-YEAR          PIC 99.
   906             20  DC-CYMD-MONTH         PIC 99.
   907             20  DC-CYMD-DAY           PIC 99.
   908         16  DC-GREG-DATE-MDCY         PIC 9(08).
   909         16  DC-GREG-DATE-MDCY-R REDEFINES
   910                              DC-GREG-DATE-MDCY.
   911             20  DC-MDCY-MONTH         PIC 99.
   912             20  DC-MDCY-DAY           PIC 99.
   913             20  DC-MDCY-CEN           PIC 99.
   914             20  DC-MDCY-YEAR          PIC 99.
   915    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   916        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   917    12  DC-EL310-DATE                  PIC X(21).
   918    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  21
* EL65091.cbl
   920
   921****************************************************************
   922*
   923* Copyright (c) 2007 by Clerity Solutions, Inc.
   924* All rights reserved.
   925*
   926****************************************************************
   927 01  DFHEIV.
   928   02  DFHEIV0               PIC X(35).
   929   02  DFHEIV1               PIC X(08).
   930   02  DFHEIV2               PIC X(08).
   931   02  DFHEIV3               PIC X(08).
   932   02  DFHEIV4               PIC X(06).
   933   02  DFHEIV5               PIC X(04).
   934   02  DFHEIV6               PIC X(04).
   935   02  DFHEIV7               PIC X(02).
   936   02  DFHEIV8               PIC X(02).
   937   02  DFHEIV9               PIC X(01).
   938   02  DFHEIV10              PIC S9(7) COMP-3.
   939   02  DFHEIV11              PIC S9(4) COMP SYNC.
   940   02  DFHEIV12              PIC S9(4) COMP SYNC.
   941   02  DFHEIV13              PIC S9(4) COMP SYNC.
   942   02  DFHEIV14              PIC S9(4) COMP SYNC.
   943   02  DFHEIV15              PIC S9(4) COMP SYNC.
   944   02  DFHEIV16              PIC S9(9) COMP SYNC.
   945   02  DFHEIV17              PIC X(04).
   946   02  DFHEIV18              PIC X(04).
   947   02  DFHEIV19              PIC X(04).
   948   02  DFHEIV20              USAGE IS POINTER.
   949   02  DFHEIV21              USAGE IS POINTER.
   950   02  DFHEIV22              USAGE IS POINTER.
   951   02  DFHEIV23              USAGE IS POINTER.
   952   02  DFHEIV24              USAGE IS POINTER.
   953   02  DFHEIV25              PIC S9(9) COMP SYNC.
   954   02  DFHEIV26              PIC S9(9) COMP SYNC.
   955   02  DFHEIV27              PIC S9(9) COMP SYNC.
   956   02  DFHEIV28              PIC S9(9) COMP SYNC.
   957   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   958   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   959   02  FILLER                PIC X(02).
   960   02  DFHEIV99              PIC X(08) VALUE SPACE.
   961   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   962   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   963   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   964   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   965 LINKAGE  SECTION.
   966*****************************************************************
   967*                                                               *
   968* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   969* All rights reserved.                                          *
   970*                                                               *
   971*****************************************************************
   972 01  dfheiblk.
   973     02  eibtime          pic s9(7) comp-3.
   974     02  eibdate          pic s9(7) comp-3.
   975     02  eibtrnid         pic x(4).
   976     02  eibtaskn         pic s9(7) comp-3.
   977     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  22
* EL65091.cbl
   978     02  dfheigdi         pic s9(4) comp.
   979     02  eibcposn         pic s9(4) comp.
   980     02  eibcalen         pic s9(4) comp.
   981     02  eibaid           pic x(1).
   982     02  eibfiller1       pic x(1).
   983     02  eibfn            pic x(2).
   984     02  eibfiller2       pic x(2).
   985     02  eibrcode         pic x(6).
   986     02  eibfiller3       pic x(2).
   987     02  eibds            pic x(8).
   988     02  eibreqid         pic x(8).
   989     02  eibrsrce         pic x(8).
   990     02  eibsync          pic x(1).
   991     02  eibfree          pic x(1).
   992     02  eibrecv          pic x(1).
   993     02  eibsend          pic x(1).
   994     02  eibatt           pic x(1).
   995     02  eibeoc           pic x(1).
   996     02  eibfmh           pic x(1).
   997     02  eibcompl         pic x(1).
   998     02  eibsig           pic x(1).
   999     02  eibconf          pic x(1).
  1000     02  eiberr           pic x(1).
  1001     02  eibrldbk         pic x(1).
  1002     02  eiberrcd         pic x(4).
  1003     02  eibsynrb         pic x(1).
  1004     02  eibnodat         pic x(1).
  1005     02  eibfiller5       pic x(2).
  1006     02  eibresp          pic 9(09) comp.
  1007     02  eibresp2         pic 9(09) comp.
  1008     02  dfheigdj         pic s9(4) comp.
  1009     02  dfheigdk         pic s9(4) comp.
  1010 01  DFHCOMMAREA                 PIC X(1500).
  1011
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  23
* EL65091.cbl
  1013*01  PARMLIST.
  1014*    05  FILLER                  PIC S9(8)   COMP.
  1015*    05  ERACNT-POINTER          PIC S9(8)   COMP.
  1016*    05  ERACCT-POINTER          PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  24
* EL65091.cbl
  1018*                                COPY ERCACNT.
  1019******************************************************************
  1020*                                                                *
  1021*                                                                *
  1022*                            ERCACNT.                            *
  1023*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1024*                            VMOD=2.002                          *
  1025*                                                                *
  1026*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  1027*                                                                *
  1028*   FILE TYPE = VSAM,KSDS                                        *
  1029*   RECORD SIZE = 120   RECFORM = FIXED                          *
  1030*                                                                *
  1031*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  1032*       ALTERNATE INDEX = NONE                                   *
  1033*                                                                *
  1034*                                                                *
  1035*   LOG = YES                                                    *
  1036*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1037******************************************************************
  1038*                   C H A N G E   L O G
  1039*
  1040* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1041*-----------------------------------------------------------------
  1042*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1043* EFFECTIVE    NUMBER
  1044*-----------------------------------------------------------------
  1045* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  1046*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  1047******************************************************************
  1048 01  NOTE-FILE.
  1049     12  NT-FILE-ID                  PIC XX.
  1050         88  VALID-NOTE-ID              VALUE 'NT'.
  1051
  1052     12  NT-CONTROL-PRIMARY.
  1053         16  NT-COMPANY-CD           PIC X.
  1054         16  NT-ACCT-NOTE-KEY.
  1055             18  NT-CARRIER              PIC X.
  1056             18  NT-GROUPING             PIC X(06).
  1057             18  NT-STATE                PIC XX.
  1058             18  NT-ACCOUNT              PIC X(10).
  1059         16  NT-RECORD-TYPE          PIC X.
  1060              88  ACCT-NOTE          VALUE '1'.
  1061              88  ACCT-BRANCH-LOC    VALUE '2'.
  1062              88  ACCT-SHIPPING-ADDR VALUE '3'.
  1063         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  1064
  1065     12  NT-LAST-MAINT-DT            PIC XX.
  1066     12  NT-LAST-MAINT-BY            PIC X(4).
  1067     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  1068
  1069*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  1070*     SEQUENCE NUMBERS
  1071     12  NT-NOTE-INFORMATION.
  1072         16  NT-NOTE-LINE            PIC X(60).
  1073         16  FILLER                  PIC X(25).
  1074*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  1075     12  NT-LOCATION-INFORMATION REDEFINES
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  25
* EL65091.cbl
  1076                         NT-NOTE-INFORMATION.
  1077         16  NT-BRANCH-LOC-LINE      PIC X(60).
  1078         16  FILLER                  PIC X(25).
  1079*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  1080*     SEQUENCE NUMBER 1 IS NAME LINE 1
  1081*     SEQUENCE NUMBER 2 IS NAME LINE 2
  1082*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  1083*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  1084*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  1085*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  1086     12  NT-SHIPPING-INFORMATION REDEFINES
  1087                         NT-NOTE-INFORMATION.
  1088         16  NT-SHIPPING-LINE        PIC X(60).
  1089         16  NT-SHIP-STATE           PIC XX.
  1090         16  NT-SHIP-ZIP             PIC X(10).
  1091         16  FILLER                  PIC X(13).
  1092*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  26
* EL65091.cbl
  1094*                                COPY ERCACCT.
  1095******************************************************************
  1096*                                                                *
  1097*                                                                *
  1098*                            ERCACCT                             *
  1099*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1100*                            VMOD=2.031                          *
  1101*                                                                *
  1102*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1103*                                                                *
  1104*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1105*   VSAM ACCOUNT MASTER FILES.                                   *
  1106*                                                                *
  1107*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1108*                                                                *
  1109*   FILE TYPE = VSAM,KSDS                                        *
  1110*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1111*                                                                *
  1112*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1113*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1114*                                                                *
  1115*   LOG = NO                                                     *
  1116*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1117*                                                                *
  1118*                                                                *
  1119******************************************************************
  1120*                   C H A N G E   L O G
  1121*
  1122* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1123*-----------------------------------------------------------------
  1124*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1125* EFFECTIVE    NUMBER
  1126*-----------------------------------------------------------------
  1127* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1128* 092705    2005050300006  PEMA  ADD SPP LEASES
  1129* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1130* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1131* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1132* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1133* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1134* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1135******************************************************************
  1136
  1137 01  ACCOUNT-MASTER.
  1138     12  AM-RECORD-ID                      PIC XX.
  1139         88  VALID-AM-ID                      VALUE 'AM'.
  1140
  1141     12  AM-CONTROL-PRIMARY.
  1142         16  AM-COMPANY-CD                 PIC X.
  1143         16  AM-MSTR-CNTRL.
  1144             20  AM-CONTROL-A.
  1145                 24  AM-CARRIER            PIC X.
  1146                 24  AM-GROUPING.
  1147                     28 AM-GROUPING-PREFIX PIC XXX.
  1148                     28 AM-GROUPING-PRIME  PIC XXX.
  1149                 24  AM-STATE              PIC XX.
  1150                 24  AM-ACCOUNT.
  1151                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  27
* EL65091.cbl
  1152                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1153             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1154                                           PIC X(19).
  1155             20  AM-CNTRL-B.
  1156                 24  AM-EXPIRATION-DT      PIC XX.
  1157                 24  FILLER                PIC X(4).
  1158             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1159                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1160
  1161     12  AM-CONTROL-BY-VAR-GRP.
  1162         16  AM-COMPANY-CD-A1              PIC X.
  1163         16  AM-VG-CARRIER                 PIC X.
  1164         16  AM-VG-GROUPING                PIC X(6).
  1165         16  AM-VG-STATE                   PIC XX.
  1166         16  AM-VG-ACCOUNT                 PIC X(10).
  1167         16  AM-VG-DATE.
  1168             20  AM-VG-EXPIRATION-DT       PIC XX.
  1169             20  FILLER                    PIC X(4).
  1170         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1171                                           PIC 9(11)      COMP-3.
  1172     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1173         16  FILLER                        PIC X(10).
  1174         16  AM-VG-KEY3.
  1175             20  AM-VG3-ACCOUNT            PIC X(10).
  1176             20  AM-VG3-EXP-DT             PIC XX.
  1177         16  FILLER                        PIC X(4).
  1178     12  AM-MAINT-INFORMATION.
  1179         16  AM-LAST-MAINT-DT              PIC XX.
  1180         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1181         16  AM-LAST-MAINT-USER            PIC X(4).
  1182         16  FILLER                        PIC XX.
  1183
  1184     12  AM-EFFECTIVE-DT                   PIC XX.
  1185     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1186
  1187     12  AM-PREV-DATES  COMP-3.
  1188         16  AM-PREV-EXP-DT                PIC 9(11).
  1189         16  AM-PREV-EFF-DT                PIC 9(11).
  1190
  1191     12  AM-REPORT-CODE-1                  PIC X(10).
  1192     12  AM-REPORT-CODE-2                  PIC X(10).
  1193
  1194     12  AM-CITY-CODE                      PIC X(4).
  1195     12  AM-COUNTY-PARISH                  PIC X(6).
  1196
  1197     12  AM-NAME                           PIC X(30).
  1198     12  AM-PERSON                         PIC X(30).
  1199     12  AM-ADDRS                          PIC X(30).
  1200     12  AM-CITY.
  1201         16  AM-ADDR-CITY                  PIC X(28).
  1202         16  AM-ADDR-STATE                 PIC XX.
  1203     12  AM-ZIP.
  1204         16  AM-ZIP-PRIME.
  1205             20  AM-ZIP-PRI-1ST            PIC X.
  1206                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1207             20  FILLER                    PIC X(4).
  1208         16  AM-ZIP-PLUS4                  PIC X(4).
  1209     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  28
* EL65091.cbl
  1210         16  AM-CAN-POSTAL-1               PIC XXX.
  1211         16  AM-CAN-POSTAL-2               PIC XXX.
  1212         16  FILLER                        PIC XXX.
  1213     12  AM-TEL-NO.
  1214         16  AM-AREA-CODE                  PIC 999.
  1215         16  AM-TEL-PRE                    PIC 999.
  1216         16  AM-TEL-NBR                    PIC 9(4).
  1217     12  AM-TEL-LOC                        PIC X.
  1218         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1219         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1220
  1221     12  AM-COMM-STRUCTURE.
  1222         16  AM-DEFN-1.
  1223             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1224                 24  AM-AGT.
  1225                     28  AM-AGT-PREFIX     PIC X(4).
  1226                     28  AM-AGT-PRIME      PIC X(6).
  1227                 24  AM-COM-TYP            PIC X.
  1228                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1229                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1230                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1231                 24  AM-RECALC-LV-INDIC    PIC X.
  1232                 24  AM-RETRO-LV-INDIC     PIC X.
  1233                 24  AM-GL-CODES           PIC X.
  1234                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1235                 24  FILLER                PIC X(01).
  1236         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1237             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1238                 24  FILLER                PIC X(11).
  1239                 24  AM-L-COMA             PIC XXX.
  1240                 24  AM-J-COMA             PIC XXX.
  1241                 24  AM-A-COMA             PIC XXX.
  1242                 24  FILLER                PIC X(6).
  1243
  1244     12  AM-COMM-CHANGE-STATUS             PIC X.
  1245         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1246
  1247     12  AM-CSR-CODE                       PIC X(4).
  1248
  1249     12  AM-BILLING-STATUS                 PIC X.
  1250         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1251         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1252     12  AM-AUTO-REFUND-SW                 PIC X.
  1253         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1254         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1255     12  AM-GPCD                           PIC 99.
  1256     12  AM-IG                             PIC X.
  1257         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1258         88  AM-HAS-GROUP                     VALUE '2'.
  1259     12  AM-STATUS                         PIC X.
  1260         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1261         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1262         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1263         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1264         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1265         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1266         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1267         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  29
* EL65091.cbl
  1268         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1269         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1270     12  AM-REMIT-TO                       PIC 99.
  1271     12  AM-ID-NO                          PIC X(11).
  1272
  1273     12  AM-CAL-TABLE                      PIC XX.
  1274     12  AM-LF-DEVIATION                   PIC XXX.
  1275     12  AM-AH-DEVIATION                   PIC XXX.
  1276     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1277     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1278     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1279     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1280     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1281     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1282
  1283     12  AM-USER-FIELDS.
  1284         16  AM-FLD-1                      PIC XX.
  1285         16  AM-FLD-2                      PIC XX.
  1286         16  AM-FLD-3                      PIC XX.
  1287         16  AM-FLD-4                      PIC XX.
  1288         16  AM-FLD-5                      PIC XX.
  1289
  1290     12  AM-1ST-PROD-DATE.
  1291         16  AM-1ST-PROD-YR                PIC XX.
  1292         16  AM-1ST-PROD-MO                PIC XX.
  1293         16  AM-1ST-PROD-DA                PIC XX.
  1294     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1295     12  AM-CERTS-PURGED-DATE.
  1296         16  AM-PUR-YR                     PIC XX.
  1297         16  AM-PUR-MO                     PIC XX.
  1298         16  AM-PUR-DA                     PIC XX.
  1299     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1300     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1301     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1302     12  AM-INACTIVE-DATE.
  1303         16  AM-INA-MO                     PIC 99.
  1304         16  AM-INA-DA                     PIC 99.
  1305         16  AM-INA-YR                     PIC 99.
  1306     12  AM-AR-HI-CERT-DATE                PIC XX.
  1307
  1308     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1309     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1310
  1311     12  AM-OB-PAYMENT-MODE                PIC X.
  1312         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1313         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1314         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1315         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1316
  1317     12  AM-AH-ONLY-INDICATOR              PIC X.
  1318         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1319         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1320
  1321     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1322
  1323     12  AM-OVER-SHORT.
  1324         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1325         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  30
* EL65091.cbl
  1326
  1327     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1328     12  AM-DCC-CLP-STATE                  PIC XX.
  1329
  1330     12  AM-RECALC-COMM                    PIC X.
  1331     12  AM-RECALC-REIN                    PIC X.
  1332
  1333     12  AM-REI-TABLE                      PIC XXX.
  1334     12  AM-REI-ET-LF                      PIC X.
  1335     12  AM-REI-ET-AH                      PIC X.
  1336     12  AM-REI-PE-LF                      PIC X.
  1337     12  AM-REI-PE-AH                      PIC X.
  1338     12  AM-REI-PRT-ST                     PIC X.
  1339     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1340     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1341     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1342     12  AM-REI-GROUP-A                    PIC X(6).
  1343     12  AM-REI-MORT                       PIC X(4).
  1344     12  AM-REI-PRT-OW                     PIC X.
  1345     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1346     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1347     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1348     12  AM-REI-GROUP-B                    PIC X(6).
  1349
  1350     12  AM-TRUST-TYPE                     PIC X(2).
  1351
  1352     12  AM-EMPLOYER-STMT-USED             PIC X.
  1353     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1354
  1355     12  AM-STD-AH-TYPE                    PIC XX.
  1356     12  AM-EARN-METHODS.
  1357         16  AM-EARN-METHOD-R              PIC X.
  1358             88 AM-REF-RL-R78                 VALUE 'R'.
  1359             88 AM-REF-RL-PR                  VALUE 'P'.
  1360             88 AM-REF-RL-MEAN                VALUE 'M'.
  1361             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1362         16  AM-EARN-METHOD-L              PIC X.
  1363             88 AM-REF-LL-R78                 VALUE 'R'.
  1364             88 AM-REF-LL-PR                  VALUE 'P'.
  1365             88 AM-REF-LL-MEAN                VALUE 'M'.
  1366             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1367         16  AM-EARN-METHOD-A              PIC X.
  1368             88 AM-REF-AH-R78                 VALUE 'R'.
  1369             88 AM-REF-AH-PR                  VALUE 'P'.
  1370             88 AM-REF-AH-MEAN                VALUE 'M'.
  1371             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1372             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1373             88 AM-REF-AH-NET                 VALUE 'N'.
  1374
  1375     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1376     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1377     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1378
  1379     12  AM-RET-Y-N                        PIC X.
  1380     12  AM-RET-P-E                        PIC X.
  1381     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1382     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1383     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  31
* EL65091.cbl
  1384     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1385         16  AM-POOL-PRIME                 PIC XXX.
  1386         16  AM-POOL-SUB                   PIC XXX.
  1387     12  AM-RETRO-EARNINGS.
  1388         16  AM-RET-EARN-R                 PIC X.
  1389         16  AM-RET-EARN-L                 PIC X.
  1390         16  AM-RET-EARN-A                 PIC X.
  1391     12  AM-RET-ST-TAX-USE                 PIC X.
  1392         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1393         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1394     12  AM-RETRO-BEG-EARNINGS.
  1395         16  AM-RET-BEG-EARN-R             PIC X.
  1396         16  AM-RET-BEG-EARN-L             PIC X.
  1397         16  AM-RET-BEG-EARN-A             PIC X.
  1398     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1399     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1400
  1401     12  AM-USER-SELECT-OPTIONS.
  1402         16  AM-USER-SELECT-1              PIC X(10).
  1403         16  AM-USER-SELECT-2              PIC X(10).
  1404         16  AM-USER-SELECT-3              PIC X(10).
  1405         16  AM-USER-SELECT-4              PIC X(10).
  1406         16  AM-USER-SELECT-5              PIC X(10).
  1407
  1408     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1409
  1410     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1411
  1412     12  AM-RPT045A-SWITCH                 PIC X.
  1413         88  RPT045A-OFF                   VALUE 'N'.
  1414
  1415     12  AM-INSURANCE-LIMITS.
  1416         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1417         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1418
  1419     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1420         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1421
  1422     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1423         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1424         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1425
  1426     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1427
  1428     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1429     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1430     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1431     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1432     12  AM-DCC-UEF-STATE                  PIC XX.
  1433     12  FILLER                            PIC XXX.
  1434     12  AM-REPORT-CODE-3                  PIC X(10).
  1435*    12  FILLER                            PIC X(22).
  1436
  1437     12  AM-RESERVE-DATE.
  1438         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1439         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1440         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1441
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  32
* EL65091.cbl
  1442     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1443     12  AM-NOTIFICATION-TYPES.
  1444         16  AM-NOTIF-OF-LETTERS           PIC X.
  1445         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1446         16  AM-NOTIF-OF-REPORTS           PIC X.
  1447         16  AM-NOTIF-OF-STATUS            PIC X.
  1448
  1449     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1450         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1451         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1452         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1453         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1454
  1455     12  AM-BENEFIT-CONTROLS.
  1456         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1457             20  AM-BENEFIT-CODE           PIC XX.
  1458             20  AM-BENEFIT-TYPE           PIC X.
  1459             20  AM-BENEFIT-REVISION       PIC XXX.
  1460             20  AM-BENEFIT-REM-TERM       PIC X.
  1461             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1462             20  FILLER                    PIC XX.
  1463         16  FILLER                        PIC X(80).
  1464
  1465     12  AM-TRANSFER-DATA.
  1466         16  AM-TRANSFERRED-FROM.
  1467             20  AM-TRNFROM-CARRIER        PIC X.
  1468             20  AM-TRNFROM-GROUPING.
  1469                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1470                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1471             20  AM-TRNFROM-STATE          PIC XX.
  1472             20  AM-TRNFROM-ACCOUNT.
  1473                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1474                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1475             20  AM-TRNFROM-DTE            PIC XX.
  1476         16  AM-TRANSFERRED-TO.
  1477             20  AM-TRNTO-CARRIER          PIC X.
  1478             20  AM-TRNTO-GROUPING.
  1479                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1480                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1481             20  AM-TRNTO-STATE            PIC XX.
  1482             20  AM-TRNTO-ACCOUNT.
  1483                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1484                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1485             20  AM-TRNTO-DTE              PIC XX.
  1486         16  FILLER                        PIC X(10).
  1487
  1488     12  AM-SAVED-REMIT-TO                 PIC 99.
  1489
  1490     12  AM-COMM-STRUCTURE-SAVED.
  1491         16  AM-DEFN-1-SAVED.
  1492             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1493                 24  AM-AGT-SV             PIC X(10).
  1494                 24  AM-COM-TYP-SV         PIC X.
  1495                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1496                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1497                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1498                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1499                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  33
* EL65091.cbl
  1500                 24  AM-GL-CODES-SV        PIC X.
  1501                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1502                 24  FILLER                PIC X.
  1503         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1504             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1505                 24  FILLER                PIC X(11).
  1506                 24  AM-L-COMA-SV          PIC XXX.
  1507                 24  AM-J-COMA-SV          PIC XXX.
  1508                 24  AM-A-COMA-SV          PIC XXX.
  1509                 24  FILLER                PIC X(6).
  1510
  1511     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1512         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1513            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1514            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1515            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1516
  1517     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1518     12  FILLER                            PIC X(120).
  1519
  1520     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1521         16  AM-CONTROL-NAME               PIC X(30).
  1522         16  AM-EXECUTIVE-ONE.
  1523             20  AM-EXEC1-NAME             PIC X(15).
  1524             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1525                                                          COMP-3.
  1526             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1527                                                          COMP-3.
  1528         16  AM-EXECUTIVE-TWO.
  1529             20  AM-EXEC2-NAME             PIC X(15).
  1530             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1531                                                          COMP-3.
  1532             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1533                                                          COMP-3.
  1534
  1535     12  AM-RETRO-ADDITIONAL-DATA.
  1536         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1537         16  AM-RETRO-PREM-P-E             PIC X.
  1538         16  AM-RETRO-CLMS-P-I             PIC X.
  1539         16  AM-RETRO-RET-BRACKET-LF.
  1540             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1541                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1542                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1543             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1544                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1545                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1546             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1547                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1548                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1549         16  AM-RETRO-RET-BRACKET-AH.
  1550             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1551                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1552                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1553                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1554             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1555                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1556                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1557             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  34
* EL65091.cbl
  1558                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1559                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1560
  1561     12  AM-COMMENTS.
  1562         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1563
  1564     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1565         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1566         16  AM-FLI-BILLING-CODE           PIC X.
  1567         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1568         16  AM-FLI-UNITED-IDENT           PIC X.
  1569         16  AM-FLI-INTEREST-LOST-DATA.
  1570             20  AM-FLI-BANK-NO            PIC X(5).
  1571             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1572             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1573             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1574         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1575             20  AM-FLI-AGT                PIC X(9).
  1576             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1577             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1578         16  FILLER                        PIC X(102).
  1579
  1580     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1581         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1582             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1583             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1584             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1585             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1586             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1587         16  FILLER                          PIC X(10).
  1588******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  35
* EL65091.cbl
  1590 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA NOTE-FILE
  1591                          ACCOUNT-MASTER.
  1592 0000-DFHEXIT SECTION.
  1593     MOVE '9#                    $   ' TO DFHEIV0.
  1594     MOVE 'EL65091' TO DFHEIV1.
  1595     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1596
  1597     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1598     MOVE '5'                    TO DC-OPTION-CODE.
  1599     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  1600     MOVE DC-GREG-DATE-1-EDIT    TO  W-CURRENT-DATE.
  1601     MOVE DC-BIN-DATE-1          TO  W-CURRENT-BIN-DATE.
  1602     MOVE SPACES                 TO DL34-PROCESS-TYPE.
  1603
  1604 0100-RETRIEVE.
  1605
  1606* EXEC CICS  HANDLE CONDITION
  1607*        ERROR    (8300-ABEND)
  1608*        PGMIDERR (8900-PGMIDERR)
  1609*        ENDDATA  (9999-FINALIZE)
  1610*        NOTFND   (8500-NOTFND)
  1611*    END-EXEC.
  1612*    MOVE '"$.L&I                ! " #00001601' TO DFHEIV0
  1613     MOVE X'22242E4C2649202020202020' TO DFHEIV0(1:12)
  1614     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1615     MOVE X'2220233030303031363031' TO DFHEIV0(25:11)
  1616     CALL 'kxdfhei1' USING DFHEIV0
  1617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1618
  1619
  1620
  1621* EXEC CICS  RETRIEVE
  1622*        INTO    (PROGRAM-INTERFACE-BLOCK)
  1623*        LENGTH  (PI-COMM-LENGTH)
  1624*    END-EXEC.
  1625*    MOVE '0*I L                 &   #00001608' TO DFHEIV0
  1626     MOVE X'302A49204C20202020202020' TO DFHEIV0(1:12)
  1627     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1628     MOVE X'2020233030303031363038' TO DFHEIV0(25:11)
  1629     CALL 'kxdfhei1' USING DFHEIV0,
  1630           PROGRAM-INTERFACE-BLOCK,
  1631           PI-COMM-LENGTH,
  1632           DFHEIV99,
  1633           DFHEIV99,
  1634           DFHEIV99
  1635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1636
  1637
  1638* DLO034 OPEN WHEN DMD OR CID
  1639     MOVE PI-COMPANY-ID             TO WS-SAVED-PI-COMPANY-ID.
  1640     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  1641         IF DL34-PROCESS-TYPE IS EQUAL TO SPACES
  1642             MOVE 'O'                TO DL34-PROCESS-TYPE
  1643             MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  1644             MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  1645             MOVE PI-PROCESSOR-ID    TO DL34-USERID
  1646             MOVE SPACES             TO DL34-PRINT-LINE
  1647             MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  36
* EL65091.cbl
  1648
  1649* EXEC CICS LINK
  1650*                PROGRAM    ('DLO034')
  1651*                COMMAREA   (DLO034-COMMUNICATION-AREA)
  1652*                LENGTH     (DLO034-REC-LENGTH)
  1653*            END-EXEC
  1654     MOVE 'DLO034' TO DFHEIV1
  1655*    MOVE '."C                   (   #00001623' TO DFHEIV0
  1656     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1657     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1658     MOVE X'2020233030303031363233' TO DFHEIV0(25:11)
  1659     CALL 'kxdfhei1' USING DFHEIV0,
  1660           DFHEIV1,
  1661           DLO034-COMMUNICATION-AREA,
  1662           DLO034-REC-LENGTH,
  1663           DFHEIV99,
  1664           DFHEIV99,
  1665           DFHEIV99,
  1666           DFHEIV99
  1667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1668             IF DL34-RETURN-CODE NOT = 'OK'
  1669                 MOVE  '**DLO034 OPEN ERROR - ABORT**'
  1670                                     TO   ERROR-LINE
  1671                 PERFORM 8400-SEND-TEXT
  1672
  1673* EXEC CICS RETURN
  1674*                END-EXEC.
  1675*    MOVE '.(                    ''   #00001632' TO DFHEIV0
  1676     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1677     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1678     MOVE X'2020233030303031363332' TO DFHEIV0(25:11)
  1679     CALL 'kxdfhei1' USING DFHEIV0,
  1680           DFHEIV99,
  1681           DFHEIV99,
  1682           DFHEIV99,
  1683           DFHEIV99,
  1684           DFHEIV99,
  1685           DFHEIV99
  1686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1687
  1688
  1689 1000-PRINT-RESULTS.
  1690     MOVE SPACES                 TO  ERACNT-KEY.
  1691     MOVE PI-COMPANY-CD          TO  ERACNT-COMPANY-CD.
  1692     MOVE '1'                    TO  ERACNT-REC-TYP.
  1693     MOVE PI-ACCT-CARRIER        TO  ERACNT-CARRIER.
  1694     MOVE PI-ACCT-GROUPING       TO  ERACNT-GROUPING.
  1695     MOVE PI-ACCT-STATE          TO  ERACNT-STATE.
  1696     MOVE PI-ACCT-ACCOUNT        TO  ERACNT-ACCOUNT.
  1697
  1698     PERFORM 2000-PRINT-HEADINGS  THRU 2000-EXIT.
  1699
  1700     MOVE ERACNT-KEY             TO  W-PRIOR-KEY.
  1701
  1702
  1703* EXEC CICS HANDLE CONDITION
  1704*         NOTFND(1400-NOTFND)
  1705*         NOTOPEN(1600-NOT-OPEN)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  37
* EL65091.cbl
  1706*         ENDFILE(1500-ENDBR)
  1707*    END-EXEC.
  1708*    MOVE '"$IJ''                 ! # #00001648' TO DFHEIV0
  1709     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  1710     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1711     MOVE X'2320233030303031363438' TO DFHEIV0(25:11)
  1712     CALL 'kxdfhei1' USING DFHEIV0
  1713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1714
  1715
  1716
  1717* EXEC CICS STARTBR
  1718*         DATASET(ERACNT-FILE-ID)
  1719*         RIDFLD(ERACNT-KEY)
  1720*         KEYLENGTH(ERACNT-START-LENGTH)
  1721*         GENERIC
  1722*         GTEQ
  1723*    END-EXEC.
  1724     MOVE 0
  1725       TO DFHEIV11
  1726*    MOVE '&,   KG    G          &   #00001654' TO DFHEIV0
  1727     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  1728     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1729     MOVE X'2020233030303031363534' TO DFHEIV0(25:11)
  1730     CALL 'kxdfhei1' USING DFHEIV0,
  1731           ERACNT-FILE-ID,
  1732           ERACNT-KEY,
  1733           ERACNT-START-LENGTH,
  1734           DFHEIV11,
  1735           DFHEIV99
  1736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1737
  1738
  1739 1001-LOOP.
  1740
  1741* EXEC CICS READNEXT
  1742*         SET(ADDRESS OF NOTE-FILE)
  1743*         DATASET(ERACNT-FILE-ID)
  1744*         RIDFLD(ERACNT-KEY)
  1745*    END-EXEC.
  1746     MOVE 0
  1747       TO DFHEIV11
  1748*    MOVE '&.S                   )   #00001663' TO DFHEIV0
  1749     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1750     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1751     MOVE X'2020233030303031363633' TO DFHEIV0(25:11)
  1752     CALL 'kxdfhei1' USING DFHEIV0,
  1753           ERACNT-FILE-ID,
  1754           DFHEIV20,
  1755           DFHEIV99,
  1756           ERACNT-KEY,
  1757           DFHEIV99,
  1758           DFHEIV11,
  1759           DFHEIV99,
  1760           DFHEIV99
  1761     SET ADDRESS OF NOTE-FILE TO
  1762         DFHEIV20
  1763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  38
* EL65091.cbl
  1764
  1765
  1766     ADD 1                       TO  W-DELAY-CNT.
  1767     IF W-DELAY-CNT GREATER THAN +50
  1768         MOVE +0 TO  W-DELAY-CNT
  1769
  1770* EXEC CICS DELAY
  1771*             INTERVAL (W-DELAY-INTERVAL)
  1772*             END-EXEC.
  1773*    MOVE '0$I                   &   #00001672' TO DFHEIV0
  1774     MOVE X'302449202020202020202020' TO DFHEIV0(1:12)
  1775     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1776     MOVE X'2020233030303031363732' TO DFHEIV0(25:11)
  1777     CALL 'kxdfhei1' USING DFHEIV0,
  1778           W-DELAY-INTERVAL,
  1779           DFHEIV99,
  1780           DFHEIV99,
  1781           DFHEIV99,
  1782           DFHEIV99
  1783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1784
  1785
  1786     IF FIRST-ONE
  1787         IF ERACNT-PARTIAL-KEY NOT = W-PRIOR-PARTIAL-KEY
  1788             GO TO 1400-NOTFND
  1789         ELSE
  1790             MOVE SPACE TO FIRST-TIME-SW
  1791             MOVE NT-CONTROL-PRIMARY TO W-PRIOR-KEY.
  1792
  1793     MOVE NT-CONTROL-PRIMARY        TO ERACNT-KEY.
  1794
  1795     IF W-PRIOR-PARTIAL-KEY = ERACNT-PARTIAL-KEY
  1796         NEXT SENTENCE
  1797     ELSE
  1798         GO TO 1500-ENDBR.
  1799
  1800     IF WS-LINE-CNT GREATER 55
  1801         PERFORM 2000-PRINT-HEADINGS  THRU 2000-EXIT.
  1802
  1803     ADD 1 TO LINE-CNT.
  1804     MOVE LINE-CNT      TO D1-LINE-NO.
  1805     MOVE NT-NOTE-LINE   TO D1-TEXT.
  1806     MOVE NT-LAST-MAINT-BY  TO D1-MAINT-BY.
  1807
  1808     IF NT-LAST-MAINT-DT = LOW-VALUES OR SPACES
  1809          MOVE SPACES   TO D1-MAINT-DT
  1810      ELSE
  1811        MOVE NT-LAST-MAINT-DT    TO DC-BIN-DATE-1
  1812        MOVE SPACE               TO DC-OPTION-CODE
  1813        PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  1814        MOVE DC-GREG-DATE-1-MDY   TO D1-MAINT-DT.
  1815
  1816     MOVE DETAIL-LINE-1        TO WS-PASSED-DATA.
  1817     MOVE SPACE                TO WS-PASSED-CNTL-CHAR.
  1818     PERFORM ELPRTCVP    THRU ELPRTCVP-EXIT.
  1819
  1820     MOVE NT-CONTROL-PRIMARY    TO W-PRIOR-KEY.
  1821
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  39
* EL65091.cbl
  1822     GO TO 1001-LOOP.
  1823
  1824 1400-NOTFND.
  1825     MOVE 'NOTES NOT FOUND ON FILE' TO WS-PASSED-DATA.
  1826     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  1827     GO TO 9999-FINALIZE.
  1828 1500-ENDBR.
  1829     MOVE SPACES TO WS-PASSED-DATA.
  1830     MOVE 'X'  TO WS-PROG-END.
  1831     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  1832*    GO TO 9999-FINALIZE.
  1833     GO TO 8999-RETURN-CICS.
  1834 1600-NOT-OPEN.
  1835     MOVE 'NOTE FILE NOT OPEN' TO WS-PASSED-DATA.
  1836     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  1837     GO TO 9999-FINALIZE.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  40
* EL65091.cbl
  1839 2000-PRINT-HEADINGS.
  1840     MOVE W-CURRENT-DATE TO H1-DATE.
  1841     MOVE '1'            TO WS-PASSED-CNTL-CHAR.
  1842     MOVE HEAD-LINE-1    TO WS-PASSED-DATA.
  1843     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  1844
  1845     PERFORM 5000-GET-ACCOUNT THRU 5999-EXIT.
  1846
  1847     MOVE HEAD-LINE-2       TO WS-PASSED-DATA.
  1848     MOVE '0'               TO WS-PASSED-CNTL-CHAR.
  1849     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  1850
  1851     MOVE HEAD-LINE-3       TO WS-PASSED-DATA.
  1852     MOVE SPACE             TO WS-PASSED-CNTL-CHAR.
  1853     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  1854
  1855 2000-EXIT.
  1856     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  41
* EL65091.cbl
  1858
  1859 5000-GET-ACCOUNT.
  1860     IF FIRST-ONE
  1861         NEXT SENTENCE
  1862     ELSE
  1863         GO TO 5500-PUT-LINES.
  1864
  1865
  1866* EXEC CICS HANDLE CONDITION
  1867*        NOTFND (5400-NOTFND)
  1868*    END-EXEC.
  1869*    MOVE '"$I                   ! $ #00001755' TO DFHEIV0
  1870     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  1871     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1872     MOVE X'2420233030303031373535' TO DFHEIV0(25:11)
  1873     CALL 'kxdfhei1' USING DFHEIV0
  1874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1875
  1876
  1877     MOVE PI-COMPANY-CD          TO  ERACCT-COMPANY-CD.
  1878     MOVE PI-ACCT-CARRIER        TO  ERACCT-CARRIER.
  1879     MOVE PI-ACCT-GROUPING       TO  ERACCT-GROUPING.
  1880     MOVE PI-ACCT-STATE          TO  ERACCT-STATE.
  1881     MOVE PI-ACCT-ACCOUNT        TO  ERACCT-ACCOUNT.
  1882     MOVE PI-ACCT-EXP-DT         TO  ERACCT-EXP-DT.
  1883
  1884
  1885* EXEC CICS READ
  1886*        DATASET (ERACCT-FILE-ID)
  1887*        RIDFLD  (ERACCT-KEY)
  1888*        SET     (ADDRESS OF ACCOUNT-MASTER)
  1889*        EQUAL
  1890*        END-EXEC.
  1891*    MOVE '&"S        E          (   #00001766' TO DFHEIV0
  1892     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1893     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1894     MOVE X'2020233030303031373636' TO DFHEIV0(25:11)
  1895     CALL 'kxdfhei1' USING DFHEIV0,
  1896           ERACCT-FILE-ID,
  1897           DFHEIV20,
  1898           DFHEIV99,
  1899           ERACCT-KEY,
  1900           DFHEIV99,
  1901           DFHEIV99,
  1902           DFHEIV99
  1903     SET ADDRESS OF ACCOUNT-MASTER TO
  1904         DFHEIV20
  1905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1906
  1907
  1908     MOVE AM-CARRIER             TO  DA-CARRIER.
  1909     MOVE AM-GROUPING            TO  DA-GROUPING.
  1910     MOVE AM-STATE               TO  DA-STATE.
  1911     MOVE AM-ACCOUNT             TO  DA-ACCOUNT.
  1912
  1913     MOVE AM-NAME                TO  DA-ACCT-NAME.
  1914
  1915     GO TO 5500-PUT-LINES.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  42
* EL65091.cbl
  1916
  1917 5400-NOTFND.
  1918      MOVE 'ACCOUNT MASTER NOT ON FILE '  TO WS-PASSED-DATA.
  1919      MOVE '0'                   TO WS-PASSED-CNTL-CHAR.
  1920      PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  1921      GO TO 5999-EXIT.
  1922
  1923 5500-PUT-LINES.
  1924      MOVE HEAD-LINE-ACCOUNT     TO WS-PASSED-DATA.
  1925      MOVE '0'                   TO WS-PASSED-CNTL-CHAR.
  1926      PERFORM ELPRTCVP    THRU ELPRTCVP-EXIT.
  1927      MOVE DETAIL-LINE-ACCOUNT   TO WS-PASSED-DATA.
  1928      MOVE ' '                   TO WS-PASSED-CNTL-CHAR.
  1929      PERFORM ELPRTCVP    THRU ELPRTCVP-EXIT.
  1930
  1931 5999-EXIT.  EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  43
* EL65091.cbl
  1933*****************************************************************
  1934*PRINT-RTN.  COPY ELPRTCVP.
  1935 PRINT-RTN.
  1936*    COPY ELPRTCVP.
  1937******************************************************************
  1938***                                                              *
  1939***                          ELPRTCVP.                           *
  1940***                          VMOD=2.003                          *
  1941***                                                              *
  1942***     COPY MEMBER FOR TERMINAL ONLINE PRINT ROUTINE.           *
  1943***     THIS ROUTINE WILL ACCOMODATE PRINTING TO A 3270          *
  1944***     TERMINAL PRINTER. A BUFFER OF UP TO 1920 CHARACTERS      *
  1945***     IS ACCUMULATED AND PRINTED COLLECTIVELY.                 *
  1946***                                                              *
  1947***     THIS ROUTINE TO BE USED ONLY WITH ACCOMPANIMENT          *
  1948***      OF THE WORKING-STORAGE COPY MEMBER ( ELPRTCVD )         *
  1949***     THE HOST PROGRAM MUST INITIALIZE THE FOLLOWING 3 FIELDS  *
  1950***      FROM THE ABOVE COPY MEMBER FOR THIS PROCEDURE TO BE     *
  1951***      SUCCESSFUL.                                             *
  1952***      05  WS-LINE-LEN    PIC  S9(4)  COMP  VALUE +80.         *
  1953***                         LENGTH OF THE LINE TO BE PRINTED     *
  1954***                         DEFAULT IS 80, YOU CAN USE ANY NUMBER*
  1955***                         UP TO 132.  THIS FIELD IS ONLY ACCEP-*
  1956***                         TED THE FIRST TIME THRU THE ROUTINE. *
  1957***      05  WS-PROG-END    PIC  X  VALUE SPACES.                *
  1958***                         PROGRAM END SWITCH. INITIALIZED      *
  1959***                         TO SPACE-     MOVE IN ANY NONBLANK   *
  1960***                         TO IT WHEN PROGRAM IS FINISHED.      *
  1961***      05  WS-PRINT-AREA.                                      *
  1962***          10  WS-PASSED-CNTL-CHAR     PIC X.                  *
  1963***          10  WS-PASSED-DATA          PIC X(132).             *
  1964***                         USE THE DATA TO BE PRINTED IN THE    *
  1965***                         WS-PASSED-DATA.                      *
  1966***                         USE THE STANDARD CARRIAGE CONTROL    *
  1967***                         CHARACTER IN THE WS-PASSED-CNTL-CHAR *
  1968***                           SINGLE-SPACE            VALUE ' '  *
  1969***                           DOUBLE-SPACE            VALUE '0'  *
  1970***                           TRIPLE-SPACE            VALUE '-'  *
  1971***                           TOP-PAGE                VALUE '1'  *
  1972***      NOTE: A LINE COUNT IS PROVIDED IN FIELDNAME -WS-LINE-CNT*
  1973***            THE USE OF THIS FIELD IS OPTIONAL.                *
  1974***            THIS ROUTINE WILL ONLY ADD 1, 2, OR 3             *
  1975***            TO THIS COUNT DEPENDING ON THE WS-PASSED-CNTL-CHAR*
  1976***            AND RESET THE COUNT TO ZERO WHEN TOP-PAGE         *
  1977***            CONDITION.                                        *
  1978***                                                              *
  1979******************************************************************
  1980
  1981 ELPRTCVP.
  1982
  1983*    IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'CID'
  1984     IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'XXX'
  1985         MOVE 'P'                TO DL34-PROCESS-TYPE
  1986         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  1987         MOVE PI-PROCESSOR-ID    TO DL34-USERID
  1988         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  1989         MOVE WS-PRINT-AREA      TO DL34-PRINT-LINE
  1990         MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  44
* EL65091.cbl
  1991
  1992
  1993* EXEC CICS LINK
  1994*            PROGRAM    ('DLO034')
  1995*            COMMAREA   (DLO034-COMMUNICATION-AREA)
  1996*            LENGTH     (DLO034-REC-LENGTH)
  1997*        END-EXEC
  1998     MOVE 'DLO034' TO DFHEIV1
  1999*    MOVE '."C                   (   #00001857' TO DFHEIV0
  2000     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2001     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2002     MOVE X'2020233030303031383537' TO DFHEIV0(25:11)
  2003     CALL 'kxdfhei1' USING DFHEIV0,
  2004           DFHEIV1,
  2005           DLO034-COMMUNICATION-AREA,
  2006           DLO034-REC-LENGTH,
  2007           DFHEIV99,
  2008           DFHEIV99,
  2009           DFHEIV99,
  2010           DFHEIV99
  2011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2012
  2013            IF DL34-RETURN-CODE = 'OK'
  2014                GO TO ELPRTCVP-EXIT
  2015            ELSE
  2016*               MOVE '8339'     TO EMI-ERROR ?????ERROR MESSAGE???
  2017                GO TO ELPRTCVP-EXIT.
  2018
  2019     IF NOT FIRST-TIME
  2020         GO TO ELPRTCVP-020.
  2021
  2022     IF WS-LINE-LEN NOT GREATER ZERO
  2023         GO TO ELPRTCVP-EXIT.
  2024
  2025     MOVE '2'                    TO WS-FIRST-TIME-SW.
  2026     MOVE LOW-VALUES             TO WS-BUFFER-AREA.
  2027
  2028     SET BUFFER-INDEX TO +1
  2029
  2030     IF EIBTRMID IS EQUAL TO 'AFLP'
  2031         NEXT SENTENCE
  2032     ELSE
  2033         IF NOT TOP-PAGE
  2034             MOVE T-TP           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2035             SET BUFFER-INDEX UP BY +1.
  2036
  2037 ELPRTCVP-020.
  2038     IF WS-PROG-END = SPACES
  2039         GO TO ELPRTCVP-030.
  2040
  2041     MOVE SPACES                 TO WS-PROG-END.
  2042
  2043     IF BUFFER-INDEX GREATER +1
  2044         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  2045
  2046     MOVE '1'                    TO WS-FIRST-TIME-SW.
  2047
  2048     GO TO ELPRTCVP-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  45
* EL65091.cbl
  2049
  2050 ELPRTCVP-030.
  2051     IF WS-PASSED-DATA = SPACES
  2052         SET PRT-INDEX TO +1
  2053         GO TO ELPRTCVP-050.
  2054
  2055     SET PRT-INDEX TO WS-LINE-LEN.
  2056
  2057 ELPRTCVP-040.
  2058     IF WS-PRINT-BYTE (PRT-INDEX) NOT = SPACES
  2059         GO TO ELPRTCVP-050.
  2060
  2061     IF PRT-INDEX GREATER +1
  2062         SET PRT-INDEX DOWN BY +1
  2063         GO TO ELPRTCVP-040.
  2064
  2065 ELPRTCVP-050.
  2066     SET WS-LINE-LENGTH TO PRT-INDEX.
  2067     SET BUFFER-INDEX2 TO BUFFER-INDEX.
  2068     SET BUFFER-INDEX2 UP BY WS-LINE-LENGTH.
  2069
  2070     IF BUFFER-INDEX2 NOT LESS WS-BUFFER-SIZE
  2071         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  2072
  2073     IF TRIPLE-SPACE
  2074          ADD +2  TO  WS-LINE-CNT
  2075          MOVE T-SS           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2076                                 WS-BUFFER-BYTE (BUFFER-INDEX + 1)
  2077          SET BUFFER-INDEX UP BY +2.
  2078
  2079     IF DOUBLE-SPACE
  2080          ADD +1  TO  WS-LINE-CNT
  2081          MOVE T-SS             TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2082          SET BUFFER-INDEX UP BY +1.
  2083
  2084     ADD +1 TO WS-LINE-CNT
  2085************************************************************
  2086*     BYPASS NEW LINE SYMBOL                               *
  2087*        IF FIRST BUFFER SENT AND TOP-OF-FORM SET.         *
  2088*     OR IF FIRST LINE OF SUBSEQUENT BUFFERS.              *
  2089************************************************************
  2090
  2091     IF (BUFFER-INDEX GREATER +1 AND
  2092         WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-TP)  OR
  2093         FIRST-LINE-NEXT-BUFFER
  2094         MOVE ZERO               TO WS-FIRST-TIME-SW
  2095     ELSE
  2096         MOVE T-SS               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2097         SET BUFFER-INDEX UP BY +1.
  2098
  2099**   NOTE, SINGLE SPACE IS REQUIRED BEFORE TOP PAGE CHAR
  2100
  2101     IF TOP-PAGE
  2102         MOVE +1                TO WS-LINE-CNT
  2103         MOVE T-TP              TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2104         SET BUFFER-INDEX UP BY +1.
  2105
  2106     SET PRT-INDEX TO +1.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  46
* EL65091.cbl
  2107
  2108 ELPRTCVP-060.
  2109     MOVE WS-PRINT-BYTE (PRT-INDEX)
  2110                                 TO WS-BUFFER-BYTE (BUFFER-INDEX).
  2111     SET BUFFER-INDEX UP BY +1.
  2112
  2113     IF PRT-INDEX LESS WS-LINE-LENGTH
  2114         SET PRT-INDEX UP BY +1
  2115         GO TO ELPRTCVP-060.
  2116
  2117 ELPRTCVP-EXIT.
  2118     EXIT.
  2119
  2120 ELPRTCVP-PRINT-BUFFER.
  2121     IF WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-SS
  2122        MOVE SPACE               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2123        SET BUFFER-INDEX UP BY 1.
  2124
  2125     MOVE  T-EM                  TO  WS-BUFFER-BYTE (BUFFER-INDEX)
  2126     SET WS-BUFFER-LENGTH TO BUFFER-INDEX.
  2127
  2128
  2129* EXEC CICS SEND
  2130*        FROM    (WS-BUFFER-AREA)
  2131*        LENGTH  (WS-BUFFER-LENGTH)
  2132*        CTLCHAR (WS-WCC-CNTL)
  2133*        ERASE
  2134*    END-EXEC.
  2135*    MOVE '$$    C E         L F ,   #00001978' TO DFHEIV0
  2136     MOVE X'242420202020432045202020' TO DFHEIV0(1:12)
  2137     MOVE X'2020202020204C2046202C20' TO DFHEIV0(13:12)
  2138     MOVE X'2020233030303031393738' TO DFHEIV0(25:11)
  2139     CALL 'kxdfhei1' USING DFHEIV0,
  2140           WS-BUFFER-AREA,
  2141           WS-BUFFER-LENGTH,
  2142           DFHEIV99,
  2143           DFHEIV99,
  2144           WS-WCC-CNTL,
  2145           DFHEIV99,
  2146           DFHEIV99,
  2147           DFHEIV99,
  2148           DFHEIV99,
  2149           DFHEIV99,
  2150           DFHEIV99
  2151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2152
  2153
  2154     SET BUFFER-INDEX TO +1.
  2155     MOVE '2'                    TO WS-FIRST-TIME-SW.
  2156
  2157 ELPRTCVP-PRINT-EXIT.
  2158     EXIT.
  2159
  2160
  2161
  2162*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  47
* EL65091.cbl
  2164 8300-ABEND.
  2165
  2166     MOVE SPACES                 TO WS-PASSED-DATA.
  2167     MOVE DFHEIBLK               TO WS-PASSED-DATA.
  2168     MOVE LINK-004               TO PGM-NAME.
  2169
  2170
  2171* EXEC CICS LINK
  2172*        PROGRAM   (PGM-NAME)
  2173*        COMMAREA  (WS-PASSED-DATA)
  2174*        LENGTH    (72)
  2175*    END-EXEC.
  2176     MOVE 72
  2177       TO DFHEIV11
  2178*    MOVE '."C                   (   #00002001' TO DFHEIV0
  2179     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2180     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2181     MOVE X'2020233030303032303031' TO DFHEIV0(25:11)
  2182     CALL 'kxdfhei1' USING DFHEIV0,
  2183           PGM-NAME,
  2184           WS-PASSED-DATA,
  2185           DFHEIV11,
  2186           DFHEIV99,
  2187           DFHEIV99,
  2188           DFHEIV99,
  2189           DFHEIV99
  2190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2191
  2192
  2193     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  2194
  2195     GO TO 9999-FINALIZE.
  2196
  2197 8400-SEND-TEXT.
  2198
  2199* EXEC CICS SEND TEXT
  2200*         FROM    (ERROR-LINE)
  2201*         LENGTH  (70)
  2202*         END-EXEC.
  2203     MOVE 70
  2204       TO DFHEIV11
  2205*    MOVE '8&      T       H   F -   #00002012' TO DFHEIV0
  2206     MOVE X'382620202020202054202020' TO DFHEIV0(1:12)
  2207     MOVE X'202020204820202046202D20' TO DFHEIV0(13:12)
  2208     MOVE X'2020233030303032303132' TO DFHEIV0(25:11)
  2209     CALL 'kxdfhei1' USING DFHEIV0,
  2210           ERROR-LINE,
  2211           DFHEIV11,
  2212           DFHEIV99,
  2213           DFHEIV99,
  2214           DFHEIV99,
  2215           DFHEIV99,
  2216           DFHEIV99,
  2217           DFHEIV99,
  2218           DFHEIV99,
  2219           DFHEIV99,
  2220           DFHEIV99,
  2221           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  48
* EL65091.cbl
  2222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2223
  2224
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  49
* EL65091.cbl
  2226
  2227 8500-DATE-CONVERT.
  2228     MOVE LINK-ELDATCV           TO PGM-NAME.
  2229
  2230
  2231* EXEC CICS LINK
  2232*        PROGRAM    (PGM-NAME)
  2233*        COMMAREA   (DATE-CONVERSION-DATA)
  2234*        LENGTH     (DC-COMM-LENGTH)
  2235*        END-EXEC.
  2236*    MOVE '."C                   (   #00002022' TO DFHEIV0
  2237     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2238     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2239     MOVE X'2020233030303032303232' TO DFHEIV0(25:11)
  2240     CALL 'kxdfhei1' USING DFHEIV0,
  2241           PGM-NAME,
  2242           DATE-CONVERSION-DATA,
  2243           DC-COMM-LENGTH,
  2244           DFHEIV99,
  2245           DFHEIV99,
  2246           DFHEIV99,
  2247           DFHEIV99
  2248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2249
  2250 8500-EXIT.
  2251     EXIT.
  2252



  2254 8500-NOTFND.
  2255     MOVE 'NO COMMUNICATION AREA FOUND' TO WS-PASSED-DATA.
  2256     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  2257     GO TO 9999-FINALIZE.



  2259 8900-PGMIDERR.
  2260     MOVE '* PROG NOT FOUND, NOTIFY DATA PROCESSING *'
  2261                          TO WS-PASSED-DATA.
  2262     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  2263     GO TO 9999-FINALIZE.
  2264
  2265* GOBACK.
  2266     MOVE '9%                    "   ' TO DFHEIV0
  2267     MOVE 'EL65091' TO DFHEIV1
  2268     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2269     GOBACK.
  2270 8900-EXIT.
  2271     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  50
* EL65091.cbl
  2273
  2274 8999-RETURN-CICS.
  2275
  2276     MOVE WS-SAVED-PI-COMPANY-ID    TO PI-COMPANY-ID.
  2277
  2278
  2279* EXEC CICS RETURN
  2280*    END-EXEC.
  2281*    MOVE '.(                    ''   #00002050' TO DFHEIV0
  2282     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2283     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2284     MOVE X'2020233030303032303530' TO DFHEIV0(25:11)
  2285     CALL 'kxdfhei1' USING DFHEIV0,
  2286           DFHEIV99,
  2287           DFHEIV99,
  2288           DFHEIV99,
  2289           DFHEIV99,
  2290           DFHEIV99,
  2291           DFHEIV99
  2292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2293
  2294
  2295 8999-EXIT. EXIT.
  2296
  2297 9999-FINALIZE.
  2298* DLO034 CLOSE
  2299     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  2300         IF DL34-PROCESS-TYPE IS NOT EQUAL TO SPACES
  2301             MOVE 'C'                TO DL34-PROCESS-TYPE
  2302             MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  2303             MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  2304             MOVE PI-PROCESSOR-ID    TO DL34-USERID
  2305             MOVE SPACES             TO DL34-PRINT-LINE
  2306                                        DL34-OVERRIDE-PRINTER-ID
  2307
  2308* EXEC CICS LINK
  2309*                PROGRAM    ('DLO034')
  2310*                COMMAREA   (DLO034-COMMUNICATION-AREA)
  2311*                LENGTH     (DLO034-REC-LENGTH)
  2312*            END-EXEC
  2313     MOVE 'DLO034' TO DFHEIV1
  2314*    MOVE '."C                   (   #00002065' TO DFHEIV0
  2315     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2316     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2317     MOVE X'2020233030303032303635' TO DFHEIV0(25:11)
  2318     CALL 'kxdfhei1' USING DFHEIV0,
  2319           DFHEIV1,
  2320           DLO034-COMMUNICATION-AREA,
  2321           DLO034-REC-LENGTH,
  2322           DFHEIV99,
  2323           DFHEIV99,
  2324           DFHEIV99,
  2325           DFHEIV99
  2326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2327             IF DL34-RETURN-CODE NOT = 'OK'
  2328                 MOVE  '**DLO034 CLOSE ERROR - ABORT**'
  2329                                     TO ERROR-LINE
  2330                 PERFORM 8400-SEND-TEXT
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  51
* EL65091.cbl
  2331
  2332* EXEC CICS RETURN
  2333*                END-EXEC.
  2334*    MOVE '.(                    ''   #00002074' TO DFHEIV0
  2335     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2336     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2337     MOVE X'2020233030303032303734' TO DFHEIV0(25:11)
  2338     CALL 'kxdfhei1' USING DFHEIV0,
  2339           DFHEIV99,
  2340           DFHEIV99,
  2341           DFHEIV99,
  2342           DFHEIV99,
  2343           DFHEIV99,
  2344           DFHEIV99
  2345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2346
  2347
  2348     MOVE SPACES TO WS-PASSED-DATA.
  2349     MOVE 'X'  TO WS-PROG-END.
  2350     PERFORM ELPRTCVP  THRU ELPRTCVP-EXIT.
  2351     GO TO 8999-RETURN-CICS.
  2352 9999-EXIT.
  2353
  2354 9999-DFHBACK SECTION.
  2355     MOVE '9%                    "   ' TO DFHEIV0
  2356     MOVE 'EL65091' TO DFHEIV1
  2357     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2358     GOBACK.
  2359 9999-DFHEXIT.
  2360     IF DFHEIGDJ EQUAL 0001
  2361         NEXT SENTENCE
  2362     ELSE IF DFHEIGDJ EQUAL 2
  2363         GO TO 8300-ABEND,
  2364               8900-PGMIDERR,
  2365               9999-FINALIZE,
  2366               8500-NOTFND
  2367         DEPENDING ON DFHEIGDI
  2368     ELSE IF DFHEIGDJ EQUAL 3
  2369         GO TO 1400-NOTFND,
  2370               1600-NOT-OPEN,
  2371               1500-ENDBR
  2372         DEPENDING ON DFHEIGDI
  2373     ELSE IF DFHEIGDJ EQUAL 4
  2374         GO TO 5400-NOTFND
  2375         DEPENDING ON DFHEIGDI.
  2376     MOVE '9%                    "   ' TO DFHEIV0
  2377     MOVE 'EL65091' TO DFHEIV1
  2378     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2379     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5428     Code:        4554
