* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6592.cbl
* Options: int("EL6592.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6592.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6592.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6592.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL6592.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/14/96 12:02:41.
     7*                            VMOD=2.010.
     8*
     9*
    10*AUTHOR.        LOGIC INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6592.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM PROVIDES THE BROWSE NECESSARY FOR THE
    27*    ACCOUNT MASTER (ACCOUNT NAME AND/OR MAIL TO NAME), COMPEN-
    28*    SATION MASTER (ACCOUNT NAME AND/OR MAIL TO NAME), AND THE
    29*    REINSURANCE COMPANY NAME (WITH LEVEL NUMBERS) LOOK-UP.
    30
    31*    SCREENS     - EL659B - ACCOUNT/COMPANY NAME LOOK-UP
    32
    33*    ENTERED BY  - EL659 - ACCOUNT/COMPANY NAME QUALIFICATION
    34
    35*    EXIT TO     - EL659 - ACCOUNT/COMPANY NAME QUALIFICATION
    36*                  EL650 - ACCOUNT MAINTENANCE
    37*                  EL652 - COMPENSATION MAINTENANCE
    38*                  EL651 - REINSURANCE TABLE MAINTENANCE
    39
    40*    INPUT FILE  - ERNAME - ACCOUNT/COMPANY NAME XREF FILE
    41
    42*    OUTPUT FILE - NONE
    43
    44*    COMMAREA    - PASSED.  IF AN ACCOUNT/COMPANY IS SELECTED,
    45*                  THE CONTROL OF THAT ACCOUNT/COMPANY IS PLACED
    46*                  IN THE APPROPRIATE FIELDS OF THE COMMAAREA FOR
    47*                  REFERENCE BY SUCCESSIVE PROGRAMS.  THE PROGRAM
    48*                  WORK AREA OF THE COMMAREA IS USED TO PASS THE
    49*                  RECORD KEY INFORMATION NEEDED BY EL650, EL651
    50*                  AND/OR EL652 TO LOCATE THAT ACCOUNT/COMPANY.
    51*
    52*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL659.  ON
    53*                  FIRST ENTRY, A SKELETON SCREEN IS SENT AND THE
    54*                  PROGRAM EXITS TO WAIT FOR INPUT.  ON SUCCESSIVE
    55*                  ENTRIES (XCTL FROM CICS VIA EX66) THE SCREEN
    56*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    57*                  MAINTENANCE TYPE INDICATED.
    58*
    59******************************************************************
    60*                   C H A N G E   L O G
    61*
    62* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    63*-----------------------------------------------------------------
    64*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    65* EFFECTIVE    NUMBER
    66*-----------------------------------------------------------------
    67* 101501    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    68*                              ADJUST REDEFINES EL659BI FILLER
    69******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6592.cbl
    71 ENVIRONMENT DIVISION.
    72 DATA DIVISION.
    73 WORKING-STORAGE SECTION.
    74 01  DFH-START PIC X(04).
    75 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    76 77  FILLER  PIC  X(32) VALUE '********************************'.
    77 77  FILLER  PIC  X(32) VALUE '*   EL6592 WORKING STORAGE     *'.
    78 77  FILLER  PIC  X(32) VALUE '*********** VMOD=2.010 *********'.
    79
    80*    COPY ELCSCTM.
    81******************************************************************
    82*                                                                *
    83*                                                                *
    84*                            ELCSCTM                             *
    85*                            VMOD=2.001                          *
    86*                                                                *
    87*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    88*                                                                *
    89******************************************************************
    90 01  SECURITY-MESSAGE.
    91     12  FILLER                          PIC X(30)
    92            VALUE '** LOGIC SECURITY VIOLATION -'.
    93     12  SM-READ                         PIC X(6).
    94     12  FILLER                          PIC X(5)
    95            VALUE ' PGM='.
    96     12  SM-PGM                          PIC X(6).
    97     12  FILLER                          PIC X(5)
    98            VALUE ' OPR='.
    99     12  SM-PROCESSOR-ID                 PIC X(4).
   100     12  FILLER                          PIC X(6)
   101            VALUE ' TERM='.
   102     12  SM-TERMID                       PIC X(4).
   103     12  FILLER                          PIC XX   VALUE SPACE.
   104     12  SM-JUL-DATE                     PIC 9(5).
   105     12  FILLER                          PIC X    VALUE SPACE.
   106     12  SM-TIME                         PIC 99.99.
   107
   108
   109*    COPY ELCSCRTY.
   110******************************************************************
   111*                                                                *
   112*                                                                *
   113*                            ELCSCRTY                            *
   114*                            VMOD=2.001                          *
   115*                                                                *
   116*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   117*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   118*        SAVED IN PI-SECURITY-ADDRESS.                           *
   119*                                                                *
   120******************************************************************
   121 01  SECURITY-CONTROL.
   122     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   123     12  FILLER                       PIC XX    VALUE 'SC'.
   124     12  SC-CREDIT-CODES.
   125         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   126             20  SC-CREDIT-DISPLAY    PIC X.
   127             20  SC-CREDIT-UPDATE     PIC X.
   128     12  SC-CLAIMS-CODES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6592.cbl
   129         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   130             20  SC-CLAIMS-DISPLAY    PIC X.
   131             20  SC-CLAIMS-UPDATE     PIC X.
   132
   133 01  WS-DATE-AREA.
   134     12  SAVE-DATE               PIC  X(08)      VALUE SPACES.
   135     12  SAVE-BIN-DATE           PIC  X(02)      VALUE SPACES.
   136
   137 01  FILLER              COMP-3.
   138     12  TIME-IN                 PIC S9(07)      VALUE ZERO.
   139     12  TIME-OUT  REDEFINES
   140         TIME-IN                 PIC S9(03)V9(4).
   141     12  WS-NAME-SW              PIC S9(01)      VALUE ZERO.
   142         88  WS-NO-NAME-FOUND                    VALUE ZERO.
   143     12  SUB                     PIC S9(02)      VALUE ZERO.
   144
   145 01  FILLER              COMP.
   146     12  WS-INDEX                PIC S9(04)      VALUE ZERO.
   147     12  WS-TS-LENGTH            PIC S9(04)      VALUE +1920.
   148     12  SC-ITEM                 PIC S9(04)      VALUE +0001.
   149
   150 01  FILLER.
   151     12  QID.
   152         16  QID-TERM                PIC  X(04).
   153         16  FILLER                  PIC  X(04)  VALUE '659B'.
   154     12  QID-PROC-AREA               PIC  X(03).
   155     12  QID-LENGTH                  PIC S9(04)  VALUE +3  COMP.
   156     12  QID-ITEM                    PIC S9(04)  VALUE +1  COMP.
   157     12  WS-MAPSET-NAME              PIC  X(08)  VALUE 'EL6592S'.
   158     12  WS-MAP-NAME                 PIC  X(08)  VALUE 'EL659B'.
   159     12  FILLER  REDEFINES  WS-MAP-NAME.
   160         16  FILLER                  PIC  X(02).
   161         16  WS-MAP-NUMBER           PIC  X(04).
   162         16  FILLER                  PIC  X(02).
   163     12  THIS-PGM                    PIC  X(08)  VALUE 'EL6592'.
   164     12  WS-TRANS-ID                 PIC  X(04)  VALUE 'EX66'.
   165     12  WS-TEMP-STORAGE-KEY.
   166         16  WS-TSK-TERM-ID          PIC  X(04)  VALUE 'XXXX'.
   167         16  FILLER                  PIC  X(04)  VALUE '6592'.
   168     12  WS-TEMP-STORAGE-KEY1.
   169         16  WS-TSK-TERM-ID1         PIC  X(04)  VALUE 'XXXX'.
   170         16  FILLER                  PIC  X(04)  VALUE '659P'.
   171     12  WS-KEY-HOLD.
   172         16  WS-KH-CHAR              PIC  X(01)
   173                 OCCURS  61  TIMES
   174                     INDEXED BY  KEY-INDEX.
   175     12  WS-KEY-INPUT.
   176         16  WS-KI-CHAR              PIC  X(01)
   177                 OCCURS  61  TIMES
   178                     INDEXED BY  KEY-INDEX2.
   179
   180     12  WS-CITY-INDEX               PIC  S9(4)  COMP.
   181     12  WS-COMPARE-INDICATOR        PIC  X.
   182         88 CITY-FOUND                         VALUE SPACE.
   183         88 CITY-NOT-FOUND                     VALUE 'X'.
   184     12  WS-NL-CITY                  PIC  X(15).
   185     12  WS-NL-CITY-CHAR  REDEFINES
   186         WS-NL-CITY                  PIC  X
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6592.cbl
   187                                     OCCURS 15.
   188     12  WS-PI-CITY                  PIC  X(15).
   189     12  WS-PI-CITY-CHAR  REDEFINES
   190         WS-PI-CITY                  PIC  X
   191                                     OCCURS 15.
   192
   193     12  WS-CALC-RDNXT               PIC S9(08) COMP VALUE ZERO.
   194     12  WS-CONTROL-PRIMARY          PIC X(33).
   195     12  ERROR-MESSAGES.
   196         16  ER-0004                 PIC  X(04)  VALUE '0004'.
   197         16  ER-0008                 PIC  X(04)  VALUE '0008'.
   198         16  ER-0029                 PIC  X(04)  VALUE '0029'.
   199         16  ER-0130                 PIC  X(04)  VALUE '0130'.
   200         16  ER-0200                 PIC  X(04)  VALUE '0200'.
   201         16  ER-0673                 PIC  X(04)  VALUE '0201'.
   202         16  ER-7323                 PIC  X(04)  VALUE '7323'.
   203         16  ER-7324                 PIC  X(04)  VALUE '7324'.
   204         16  ER-9262                 PIC  X(04)  VALUE '9262'.
   205     12  EL650-TRANS-ID              PIC  X(04)  VALUE 'EXC4'.
   206     12  EL651-TRANS-ID              PIC  X(04)  VALUE 'EXD1'.
   207     12  EL652-TRANS-ID              PIC  X(04)  VALUE 'EXD4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6592.cbl
   209 01  ACCOUNT-KEY-LINE.
   210     12  AKL-FILL-1              PIC  X(05).
   211     12  AKL-CARRIER             PIC  X(01).
   212     12  AKL-FILL-2              PIC  X(07).
   213     12  AKL-GROUPING            PIC  X(06).
   214     12  AKL-FILL-3              PIC  X(07).
   215     12  AKL-STATE               PIC  X(02).
   216     12  AKL-FILL-4              PIC  X(09).
   217     12  AKL-ACCOUNT             PIC  X(10).
   218     12  FILLER                  PIC  X(20).
   219
   220 01  COMPENSATION-KEY-LINE.
   221     12  CKL-FILL-1              PIC  X(05).
   222     12  CKL-CARRIER             PIC  X(01).
   223     12  CKL-FILL-2              PIC  X(07).
   224     12  CKL-GROUPING            PIC  X(06).
   225     12  CKL-FILL-3              PIC  X(10).
   226     12  CKL-RESP                PIC  X(10).
   227     12  CKL-FILL-4              PIC  X(09).
   228     12  CKL-ACCOUNT             PIC  X(10).
   229     12  CKL-FILL-5              PIC  X(06).
   230     12  CKL-TYPE                PIC  X(01).
   231     12  FILLER                  PIC  X(02).
   232
   233 01  REINSURANCE-KEY-LINE.
   234     12  RKL-FILL-1              PIC  X(06).
   235     12  RKL-REIN-TABLE          PIC  X(03).
   236     12  RKL-FILL-2              PIC  X(06).
   237     12  RKL-REIN-COMP           PIC  X(03).
   238     12  RKL-FILL-3              PIC  X(05).
   239     12  RKL-REIN-COMP-SUB       PIC  X(03).
   240     12  RKL-FILL-4              PIC  X(09).
   241     12  RKL-LEVELS      OCCURS  11  TIMES.
   242         16  RKL-FILL-5          PIC  X(01).
   243         16  RKL-LEVEL           PIC  9(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6592.cbl
   245*    COPY ELCINTF.
   246******************************************************************
   247*                                                                *
   248*                                                                *
   249*                            ELCINTF.                            *
   250*                            VMOD=2.017                          *
   251*                                                                *
   252*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   253*                                                                *
   254*       LENGTH = 1024                                            *
   255*                                                                *
   256******************************************************************
   257 01  PROGRAM-INTERFACE-BLOCK.
   258     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   259     12  PI-CALLING-PROGRAM              PIC X(8).
   260     12  PI-SAVED-PROGRAM-1              PIC X(8).
   261     12  PI-SAVED-PROGRAM-2              PIC X(8).
   262     12  PI-SAVED-PROGRAM-3              PIC X(8).
   263     12  PI-SAVED-PROGRAM-4              PIC X(8).
   264     12  PI-SAVED-PROGRAM-5              PIC X(8).
   265     12  PI-SAVED-PROGRAM-6              PIC X(8).
   266     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   267     12  PI-COMPANY-ID                   PIC XXX.
   268     12  PI-COMPANY-CD                   PIC X.
   269
   270     12  PI-COMPANY-PASSWORD             PIC X(8).
   271
   272     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   273
   274     12  PI-CONTROL-IN-PROGRESS.
   275         16  PI-CARRIER                  PIC X.
   276         16  PI-GROUPING                 PIC X(6).
   277         16  PI-STATE                    PIC XX.
   278         16  PI-ACCOUNT                  PIC X(10).
   279         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   280                                         PIC X(10).
   281         16  PI-CLAIM-CERT-GRP.
   282             20  PI-CLAIM-NO             PIC X(7).
   283             20  PI-CERT-NO.
   284                 25  PI-CERT-PRIME       PIC X(10).
   285                 25  PI-CERT-SFX         PIC X.
   286             20  PI-CERT-EFF-DT          PIC XX.
   287         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   288             20  PI-PLAN-CODE            PIC X(2).
   289             20  PI-REVISION-NUMBER      PIC X(3).
   290             20  PI-PLAN-EFF-DT          PIC X(2).
   291             20  PI-PLAN-EXP-DT          PIC X(2).
   292             20  FILLER                  PIC X(11).
   293         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   294             20  PI-OE-REFERENCE-1.
   295                 25  PI-OE-REF-1-PRIME   PIC X(18).
   296                 25  PI-OE-REF-1-SUFF    PIC XX.
   297
   298     12  PI-SESSION-IN-PROGRESS          PIC X.
   299         88  CLAIM-SESSION                   VALUE '1'.
   300         88  CREDIT-SESSION                  VALUE '2'.
   301         88  WARRANTY-SESSION                VALUE '3'.
   302         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6592.cbl
   303         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   304
   305
   306*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   307
   308     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   309     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   310
   311     12  PI-CREDIT-USER                  PIC X.
   312         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   313         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   314
   315     12  PI-CLAIM-USER                   PIC X.
   316         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   317         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   318
   319     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   320         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   321         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   322         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   323         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   324         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   325
   326     12  PI-PROCESSOR-ID                 PIC X(4).
   327
   328     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   329
   330     12  PI-MEMBER-CAPTION               PIC X(10).
   331
   332     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   333         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   334
   335     12  PI-LIFE-OVERRIDE-L1             PIC X.
   336     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   337     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   338     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   339
   340     12  PI-AH-OVERRIDE-L1               PIC X.
   341     12  PI-AH-OVERRIDE-L2               PIC XX.
   342     12  PI-AH-OVERRIDE-L6               PIC X(6).
   343     12  PI-AH-OVERRIDE-L12              PIC X(12).
   344
   345     12  PI-NEW-SYSTEM                   PIC X(2).
   346
   347     12  PI-PRIMARY-CERT-NO              PIC X(11).
   348     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   349         88  PI-USES-PAID-TO                 VALUE '1'.
   350     12  PI-CRDTCRD-SYSTEM.
   351         16  PI-CRDTCRD-USER             PIC X.
   352             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   353             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   354         16  PI-CC-MONTH-END-DT          PIC XX.
   355     12  PI-PROCESSOR-PRINTER            PIC X(4).
   356
   357     12  PI-OE-REFERENCE-2.
   358         16  PI-OE-REF-2-PRIME           PIC X(10).
   359         16  PI-OE-REF-2-SUFF            PIC X.
   360
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6592.cbl
   361     12  PI-REM-TRM-CALC-OPTION          PIC X.
   362
   363     12  PI-LANGUAGE-TYPE                PIC X.
   364             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   365             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   366             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   367
   368     12  PI-POLICY-LINKAGE-IND           PIC X.
   369         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   370         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   371                                                   LOW-VALUES.
   372
   373     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   374     12  PI-CLAIM-PW-SESSION             PIC X(1).
   375         88  PI-CLAIM-CREDIT                 VALUE '1'.
   376         88  PI-CLAIM-CONVEN                 VALUE '2'.
   377     12  FILLER                          PIC X(4).
   378
   379     12  PI-SYSTEM-LEVEL                 PIC X(145).
   380
   381     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   382         PI-SYSTEM-LEVEL.
   383
   384         16  PI-ENTRY-CODES.
   385             20  PI-ENTRY-CD-1           PIC X.
   386             20  PI-ENTRY-CD-2           PIC X.
   387
   388         16  PI-RETURN-CODES.
   389             20  PI-RETURN-CD-1          PIC X.
   390             20  PI-RETURN-CD-2          PIC X.
   391
   392         16  PI-UPDATE-STATUS-SAVE.
   393             20  PI-UPDATE-BY            PIC X(4).
   394             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   395
   396         16  PI-LOWER-CASE-LETTERS       PIC X.
   397             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   398
   399*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   400*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   401*            88  CARRIER-CLM-CNTL            VALUE '2'.
   402
   403         16  PI-CERT-ACCESS-CONTROL      PIC X.
   404             88  ST-ACCNT-CNTL               VALUE ' '.
   405             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   406             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   407             88  ACCNT-CNTL                  VALUE '3'.
   408             88  CARR-ACCNT-CNTL             VALUE '4'.
   409
   410         16  PI-PROCESSOR-CAP-LIST.
   411             20  PI-SYSTEM-CONTROLS.
   412                24 PI-SYSTEM-DISPLAY     PIC X.
   413                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   414                24 PI-SYSTEM-MODIFY      PIC X.
   415                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   416             20  FILLER                  PIC XX.
   417             20  PI-DISPLAY-CAP          PIC X.
   418                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6592.cbl
   419             20  PI-MODIFY-CAP           PIC X.
   420                 88  MODIFY-CAP              VALUE 'Y'.
   421             20  PI-MSG-AT-LOGON-CAP     PIC X.
   422                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   423             20  PI-FORCE-CAP            PIC X.
   424                 88  FORCE-CAP               VALUE 'Y'.
   425
   426         16  PI-PROGRAM-CONTROLS.
   427             20  PI-PGM-PRINT-OPT        PIC X.
   428             20  PI-PGM-FORMAT-OPT       PIC X.
   429             20  PI-PGM-PROCESS-OPT      PIC X.
   430             20  PI-PGM-TOTALS-OPT       PIC X.
   431
   432         16  PI-HELP-INTERFACE.
   433             20  PI-LAST-ERROR-NO        PIC X(4).
   434             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   435
   436         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   437             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   438
   439         16  PI-CR-CONTROL-IN-PROGRESS.
   440             20  PI-CR-CARRIER           PIC X.
   441             20  PI-CR-GROUPING          PIC X(6).
   442             20  PI-CR-STATE             PIC XX.
   443             20  PI-CR-ACCOUNT           PIC X(10).
   444             20  PI-CR-FIN-RESP          PIC X(10).
   445             20  PI-CR-TYPE              PIC X.
   446
   447         16  PI-CR-BATCH-NUMBER          PIC X(6).
   448
   449         16  PI-CR-MONTH-END-DT          PIC XX.
   450
   451         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   452             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   453             88  PI-ZERO-CARRIER             VALUE '1'.
   454             88  PI-ZERO-GROUPING            VALUE '2'.
   455             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   456
   457         16  PI-CARRIER-SECURITY         PIC X.
   458             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   459
   460         16  PI-ACCOUNT-SECURITY         PIC X(10).
   461             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   462             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   463
   464         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   465             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   466                                         INDEXED BY PI-ACCESS-NDX
   467                                         PIC X.
   468
   469         16  PI-GA-BILLING-CONTROL       PIC X.
   470             88  PI-GA-BILLING               VALUE '1'.
   471
   472         16  PI-MAIL-PROCESSING          PIC X.
   473             88  PI-MAIL-YES                 VALUE 'Y'.
   474
   475         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   476
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6592.cbl
   477         16  PI-AR-SYSTEM.
   478             20  PI-AR-PROCESSING-CNTL   PIC X.
   479                 88  PI-AR-PROCESSING        VALUE 'Y'.
   480             20  PI-AR-SUMMARY-CODE      PIC X(6).
   481             20  PI-AR-MONTH-END-DT      PIC XX.
   482
   483         16  PI-MP-SYSTEM.
   484             20  PI-MORTGAGE-USER            PIC X.
   485                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   486                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   487             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   488                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   489                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   490                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   491                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   492                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   493             20  PI-MP-MONTH-END-DT          PIC XX.
   494             20  PI-MP-REFERENCE-NO.
   495                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   496                 24  PI-MP-REFERENCE-SFX     PIC XX.
   497
   498         16  PI-LABEL-CONTROL            PIC X(01).
   499             88  PI-CREATE-LABELS                    VALUE 'Y'.
   500             88  PI-BYPASS-LABELS                    VALUE 'N'.
   501
   502         16  PI-BILL-GROUPING-CODE       PIC X(01).
   503             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   504
   505         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   506             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   507             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   508
   509         16  FILLER                      PIC X(14).
   510
   511     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   512******************************************************************
   513
   514*    COPY ELC659PI.
   515******************************************************************
   516*                                                                *
   517*                            ELC659PI                            *
   518*                            VMOD=2.002                          *
   519*                                                                *
   520******************************************************************
   521
   522     12  PI-WORK-AREA  REDEFINES  PI-PROGRAM-WORK-AREA.
   523         16  FILLER                      PIC  X(02).
   524         16  PI-ERREIN-KEY.
   525             20  PI-ERR-COMPANY-CD       PIC  X(01).
   526             20  PI-ERR-CODE             PIC  X(01).
   527             20  PI-ERR-TABLE            PIC  X(03).
   528             20  PI-ERR-SUB              PIC  X(03).
   529         16  PI-ERR-LEVEL                PIC  9(02).
   530         16  PI-1ST-TIME-SW              PIC S9(01)  COMP-3.
   531         16  PI-LINE-COUNT               PIC S9(03)  COMP-3.
   532         16  PI-AIX-RECORD-COUNT         PIC S9(04)  COMP SYNC.
   533         16  PI-START-SW                 PIC S9(01)  COMP-3.
   534         16  PI-BROWSE-SW                PIC S9(01)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6592.cbl
   535         16  PI-END-OF-FILE              PIC S9(01)  COMP-3.
   536         16  PI-DSID                     PIC  X(08).
   537         16  PI-OPTION                   PIC  X(01).
   538             88  NO-OPTION-SELECTED              VALUE ZERO.
   539             88  OPTION-ONE-SELECTED             VALUE '1'.
   540             88  OPTION-TWO-SELECTED             VALUE '2'.
   541             88  OPTION-THREE-SELECTED           VALUE '3'.
   542         16  PI-SELECTION-CRITERIA.
   543             20  PI-SC-COMPANY-CD        PIC  X(01).
   544             20  PI-SC-NAME              PIC  X(30).
   545             20  PI-SC-RECORD-TYPE       PIC  X(01).
   546             20  FILLER                  PIC  X(29).
   547         16  PI-NAME-LOOKUP-KEY.
   548             20  PI-NLK-COMPANY-CD       PIC  X(01).
   549             20  PI-NLK-NAME             PIC  X(30).
   550             20  PI-NLK-RECORD-TYPE      PIC  X(01).
   551             20  FILLER                  PIC  X(29).
   552         16  PI-PREV-NAME-LOOKUP-KEY.
   553             20  PI-PREV-NLK-COMPANY-CD  PIC  X(01).
   554             20  PI-PREV-NLK-NAME        PIC  X(30).
   555             20  PI-PREV-NLK-RECORD-TYPE
   556                                         PIC  X(01).
   557             20  FILLERV-CK-STATE        PIC  X(29).
   558         16  PI-CITY                     PIC  X(15).
   559         16  PI-ST                       PIC  XX.
   560         16  PI-CITY-LENGTH              PIC S9(04)  COMP SYNC.
   561         16  PI-KEY-LENGTH               PIC S9(04)  COMP SYNC.
   562         16  PI-TS-ITEM                  PIC S9(04)  COMP SYNC.
   563         16  PI-1ST-KEY                  PIC  X(61).
   564         16  FILLER                      PIC  X(43).
   565         16  PI-PREV-AID                 PIC  X(01).
   566         16  PI-START-NAME-LOOKUP-KEY.
   567             20  PI-START-COMPANY-CD     PIC  X(01).
   568             20  PI-START-NAME           PIC  X(30).
   569             20  PI-START-RECORD-TYPE    PIC  X(01).
   570             20  FILLER                  PIC  X(29).
   571         16  PI-END-NAME-LOOKUP-KEY.
   572             20  PI-END-COMPANY-CD       PIC  X(01).
   573             20  PI-END-NAME             PIC  X(30).
   574             20  PI-END-RECORD-TYPE      PIC  X(01).
   575             20  FILLER                  PIC  X(29).
   576         16  PI-LIN1-NAME-LOOKUP-KEY     PIC  X(61).
   577         16  PI-SCREEN-COUNT             PIC S9(08)  COMP.
   578         16  PI-SUB                      PIC S9(02).
   579         16  PI-FIRST-TIME-SW            PIC  X(01).
   580
   581******************************************************************
   582         16  PI-EL659-TO-EL130-CNTRL.
   583             20  PI-EL659-CARRIER    PIC X.
   584             20  PI-EL659-GROUPING   PIC X(6).
   585             20  PI-EL659-STATE      PIC XX.
   586             20  PI-EL659-ACCOUNT    PIC X(10).
   587         16  FILLER                  PIC X(90).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6592.cbl
   589*    COPY EL6592S.
   590 01  EL659BI.
   591     05  FILLER            PIC  X(0012).
   592*    -------------------------------
   593     05  BDATEL PIC S9(0004) COMP.
   594     05  BDATEF PIC  X(0001).
   595     05  FILLER REDEFINES BDATEF.
   596         10  BDATEA PIC  X(0001).
   597     05  BDATEI PIC  X(0008).
   598*    -------------------------------
   599     05  BTIMEL PIC S9(0004) COMP.
   600     05  BTIMEF PIC  X(0001).
   601     05  FILLER REDEFINES BTIMEF.
   602         10  BTIMEA PIC  X(0001).
   603     05  BTIMEI PIC  X(0005).
   604*    -------------------------------
   605     05  CMPNYIDL PIC S9(0004) COMP.
   606     05  CMPNYIDF PIC  X(0001).
   607     05  FILLER REDEFINES CMPNYIDF.
   608         10  CMPNYIDA PIC  X(0001).
   609     05  CMPNYIDI PIC  X(0003).
   610*    -------------------------------
   611     05  USERIDL PIC S9(0004) COMP.
   612     05  USERIDF PIC  X(0001).
   613     05  FILLER REDEFINES USERIDF.
   614         10  USERIDA PIC  X(0001).
   615     05  USERIDI PIC  X(0004).
   616*    -------------------------------
   617     05  BTYP01L PIC S9(0004) COMP.
   618     05  BTYP01F PIC  X(0001).
   619     05  FILLER REDEFINES BTYP01F.
   620         10  BTYP01A PIC  X(0001).
   621     05  BTYP01I PIC  X(0001).
   622*    -------------------------------
   623     05  BNAM01L PIC S9(0004) COMP.
   624     05  BNAM01F PIC  X(0001).
   625     05  FILLER REDEFINES BNAM01F.
   626         10  BNAM01A PIC  X(0001).
   627     05  BNAM01I PIC  X(0030).
   628*    -------------------------------
   629     05  BCITY1L PIC S9(0004) COMP.
   630     05  BCITY1F PIC  X(0001).
   631     05  FILLER REDEFINES BCITY1F.
   632         10  BCITY1A PIC  X(0001).
   633     05  BCITY1I PIC  X(0015).
   634*    -------------------------------
   635     05  BST1L PIC S9(0004) COMP.
   636     05  BST1F PIC  X(0001).
   637     05  FILLER REDEFINES BST1F.
   638         10  BST1A PIC  X(0001).
   639     05  BST1I PIC  X(0002).
   640*    -------------------------------
   641     05  BAST01L PIC S9(0004) COMP.
   642     05  BAST01F PIC  X(0001).
   643     05  FILLER REDEFINES BAST01F.
   644         10  BAST01A PIC  X(0001).
   645     05  BAST01I PIC  X(0001).
   646*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6592.cbl
   647     05  BKEY01L PIC S9(0004) COMP.
   648     05  BKEY01F PIC  X(0001).
   649     05  FILLER REDEFINES BKEY01F.
   650         10  BKEY01A PIC  X(0001).
   651     05  BKEY01I PIC  X(0068).
   652*    -------------------------------
   653     05  BTYP02L PIC S9(0004) COMP.
   654     05  BTYP02F PIC  X(0001).
   655     05  FILLER REDEFINES BTYP02F.
   656         10  BTYP02A PIC  X(0001).
   657     05  BTYP02I PIC  X(0001).
   658*    -------------------------------
   659     05  BNAM02L PIC S9(0004) COMP.
   660     05  BNAM02F PIC  X(0001).
   661     05  FILLER REDEFINES BNAM02F.
   662         10  BNAM02A PIC  X(0001).
   663     05  BNAM02I PIC  X(0030).
   664*    -------------------------------
   665     05  BCITY2L PIC S9(0004) COMP.
   666     05  BCITY2F PIC  X(0001).
   667     05  FILLER REDEFINES BCITY2F.
   668         10  BCITY2A PIC  X(0001).
   669     05  BCITY2I PIC  X(0015).
   670*    -------------------------------
   671     05  BST2L PIC S9(0004) COMP.
   672     05  BST2F PIC  X(0001).
   673     05  FILLER REDEFINES BST2F.
   674         10  BST2A PIC  X(0001).
   675     05  BST2I PIC  X(0002).
   676*    -------------------------------
   677     05  BAST02L PIC S9(0004) COMP.
   678     05  BAST02F PIC  X(0001).
   679     05  FILLER REDEFINES BAST02F.
   680         10  BAST02A PIC  X(0001).
   681     05  BAST02I PIC  X(0001).
   682*    -------------------------------
   683     05  BKEY02L PIC S9(0004) COMP.
   684     05  BKEY02F PIC  X(0001).
   685     05  FILLER REDEFINES BKEY02F.
   686         10  BKEY02A PIC  X(0001).
   687     05  BKEY02I PIC  X(0068).
   688*    -------------------------------
   689     05  BTYP03L PIC S9(0004) COMP.
   690     05  BTYP03F PIC  X(0001).
   691     05  FILLER REDEFINES BTYP03F.
   692         10  BTYP03A PIC  X(0001).
   693     05  BTYP03I PIC  X(0001).
   694*    -------------------------------
   695     05  BNAM03L PIC S9(0004) COMP.
   696     05  BNAM03F PIC  X(0001).
   697     05  FILLER REDEFINES BNAM03F.
   698         10  BNAM03A PIC  X(0001).
   699     05  BNAM03I PIC  X(0030).
   700*    -------------------------------
   701     05  BCITY3L PIC S9(0004) COMP.
   702     05  BCITY3F PIC  X(0001).
   703     05  FILLER REDEFINES BCITY3F.
   704         10  BCITY3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6592.cbl
   705     05  BCITY3I PIC  X(0015).
   706*    -------------------------------
   707     05  BST3L PIC S9(0004) COMP.
   708     05  BST3F PIC  X(0001).
   709     05  FILLER REDEFINES BST3F.
   710         10  BST3A PIC  X(0001).
   711     05  BST3I PIC  X(0002).
   712*    -------------------------------
   713     05  BAST03L PIC S9(0004) COMP.
   714     05  BAST03F PIC  X(0001).
   715     05  FILLER REDEFINES BAST03F.
   716         10  BAST03A PIC  X(0001).
   717     05  BAST03I PIC  X(0001).
   718*    -------------------------------
   719     05  BKEY03L PIC S9(0004) COMP.
   720     05  BKEY03F PIC  X(0001).
   721     05  FILLER REDEFINES BKEY03F.
   722         10  BKEY03A PIC  X(0001).
   723     05  BKEY03I PIC  X(0068).
   724*    -------------------------------
   725     05  BTYP04L PIC S9(0004) COMP.
   726     05  BTYP04F PIC  X(0001).
   727     05  FILLER REDEFINES BTYP04F.
   728         10  BTYP04A PIC  X(0001).
   729     05  BTYP04I PIC  X(0001).
   730*    -------------------------------
   731     05  BNAM04L PIC S9(0004) COMP.
   732     05  BNAM04F PIC  X(0001).
   733     05  FILLER REDEFINES BNAM04F.
   734         10  BNAM04A PIC  X(0001).
   735     05  BNAM04I PIC  X(0030).
   736*    -------------------------------
   737     05  BCITY4L PIC S9(0004) COMP.
   738     05  BCITY4F PIC  X(0001).
   739     05  FILLER REDEFINES BCITY4F.
   740         10  BCITY4A PIC  X(0001).
   741     05  BCITY4I PIC  X(0015).
   742*    -------------------------------
   743     05  BST4L PIC S9(0004) COMP.
   744     05  BST4F PIC  X(0001).
   745     05  FILLER REDEFINES BST4F.
   746         10  BST4A PIC  X(0001).
   747     05  BST4I PIC  X(0002).
   748*    -------------------------------
   749     05  BAST04L PIC S9(0004) COMP.
   750     05  BAST04F PIC  X(0001).
   751     05  FILLER REDEFINES BAST04F.
   752         10  BAST04A PIC  X(0001).
   753     05  BAST04I PIC  X(0001).
   754*    -------------------------------
   755     05  BKEY04L PIC S9(0004) COMP.
   756     05  BKEY04F PIC  X(0001).
   757     05  FILLER REDEFINES BKEY04F.
   758         10  BKEY04A PIC  X(0001).
   759     05  BKEY04I PIC  X(0068).
   760*    -------------------------------
   761     05  BTYP05L PIC S9(0004) COMP.
   762     05  BTYP05F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6592.cbl
   763     05  FILLER REDEFINES BTYP05F.
   764         10  BTYP05A PIC  X(0001).
   765     05  BTYP05I PIC  X(0001).
   766*    -------------------------------
   767     05  BNAM05L PIC S9(0004) COMP.
   768     05  BNAM05F PIC  X(0001).
   769     05  FILLER REDEFINES BNAM05F.
   770         10  BNAM05A PIC  X(0001).
   771     05  BNAM05I PIC  X(0030).
   772*    -------------------------------
   773     05  BCITY5L PIC S9(0004) COMP.
   774     05  BCITY5F PIC  X(0001).
   775     05  FILLER REDEFINES BCITY5F.
   776         10  BCITY5A PIC  X(0001).
   777     05  BCITY5I PIC  X(0015).
   778*    -------------------------------
   779     05  BST5L PIC S9(0004) COMP.
   780     05  BST5F PIC  X(0001).
   781     05  FILLER REDEFINES BST5F.
   782         10  BST5A PIC  X(0001).
   783     05  BST5I PIC  X(0002).
   784*    -------------------------------
   785     05  BAST05L PIC S9(0004) COMP.
   786     05  BAST05F PIC  X(0001).
   787     05  FILLER REDEFINES BAST05F.
   788         10  BAST05A PIC  X(0001).
   789     05  BAST05I PIC  X(0001).
   790*    -------------------------------
   791     05  BKEY05L PIC S9(0004) COMP.
   792     05  BKEY05F PIC  X(0001).
   793     05  FILLER REDEFINES BKEY05F.
   794         10  BKEY05A PIC  X(0001).
   795     05  BKEY05I PIC  X(0068).
   796*    -------------------------------
   797     05  BTYP06L PIC S9(0004) COMP.
   798     05  BTYP06F PIC  X(0001).
   799     05  FILLER REDEFINES BTYP06F.
   800         10  BTYP06A PIC  X(0001).
   801     05  BTYP06I PIC  X(0001).
   802*    -------------------------------
   803     05  BNAM06L PIC S9(0004) COMP.
   804     05  BNAM06F PIC  X(0001).
   805     05  FILLER REDEFINES BNAM06F.
   806         10  BNAM06A PIC  X(0001).
   807     05  BNAM06I PIC  X(0030).
   808*    -------------------------------
   809     05  BCITY6L PIC S9(0004) COMP.
   810     05  BCITY6F PIC  X(0001).
   811     05  FILLER REDEFINES BCITY6F.
   812         10  BCITY6A PIC  X(0001).
   813     05  BCITY6I PIC  X(0015).
   814*    -------------------------------
   815     05  BST6L PIC S9(0004) COMP.
   816     05  BST6F PIC  X(0001).
   817     05  FILLER REDEFINES BST6F.
   818         10  BST6A PIC  X(0001).
   819     05  BST6I PIC  X(0002).
   820*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6592.cbl
   821     05  BAST06L PIC S9(0004) COMP.
   822     05  BAST06F PIC  X(0001).
   823     05  FILLER REDEFINES BAST06F.
   824         10  BAST06A PIC  X(0001).
   825     05  BAST06I PIC  X(0001).
   826*    -------------------------------
   827     05  BKEY06L PIC S9(0004) COMP.
   828     05  BKEY06F PIC  X(0001).
   829     05  FILLER REDEFINES BKEY06F.
   830         10  BKEY06A PIC  X(0001).
   831     05  BKEY06I PIC  X(0068).
   832*    -------------------------------
   833     05  BTYP07L PIC S9(0004) COMP.
   834     05  BTYP07F PIC  X(0001).
   835     05  FILLER REDEFINES BTYP07F.
   836         10  BTYP07A PIC  X(0001).
   837     05  BTYP07I PIC  X(0001).
   838*    -------------------------------
   839     05  BNAM07L PIC S9(0004) COMP.
   840     05  BNAM07F PIC  X(0001).
   841     05  FILLER REDEFINES BNAM07F.
   842         10  BNAM07A PIC  X(0001).
   843     05  BNAM07I PIC  X(0030).
   844*    -------------------------------
   845     05  BCITY7L PIC S9(0004) COMP.
   846     05  BCITY7F PIC  X(0001).
   847     05  FILLER REDEFINES BCITY7F.
   848         10  BCITY7A PIC  X(0001).
   849     05  BCITY7I PIC  X(0015).
   850*    -------------------------------
   851     05  BST7L PIC S9(0004) COMP.
   852     05  BST7F PIC  X(0001).
   853     05  FILLER REDEFINES BST7F.
   854         10  BST7A PIC  X(0001).
   855     05  BST7I PIC  X(0002).
   856*    -------------------------------
   857     05  BAST07L PIC S9(0004) COMP.
   858     05  BAST07F PIC  X(0001).
   859     05  FILLER REDEFINES BAST07F.
   860         10  BAST07A PIC  X(0001).
   861     05  BAST07I PIC  X(0001).
   862*    -------------------------------
   863     05  BKEY07L PIC S9(0004) COMP.
   864     05  BKEY07F PIC  X(0001).
   865     05  FILLER REDEFINES BKEY07F.
   866         10  BKEY07A PIC  X(0001).
   867     05  BKEY07I PIC  X(0068).
   868*    -------------------------------
   869     05  BTYP08L PIC S9(0004) COMP.
   870     05  BTYP08F PIC  X(0001).
   871     05  FILLER REDEFINES BTYP08F.
   872         10  BTYP08A PIC  X(0001).
   873     05  BTYP08I PIC  X(0001).
   874*    -------------------------------
   875     05  BNAM08L PIC S9(0004) COMP.
   876     05  BNAM08F PIC  X(0001).
   877     05  FILLER REDEFINES BNAM08F.
   878         10  BNAM08A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6592.cbl
   879     05  BNAM08I PIC  X(0030).
   880*    -------------------------------
   881     05  BCITY8L PIC S9(0004) COMP.
   882     05  BCITY8F PIC  X(0001).
   883     05  FILLER REDEFINES BCITY8F.
   884         10  BCITY8A PIC  X(0001).
   885     05  BCITY8I PIC  X(0015).
   886*    -------------------------------
   887     05  BST8L PIC S9(0004) COMP.
   888     05  BST8F PIC  X(0001).
   889     05  FILLER REDEFINES BST8F.
   890         10  BST8A PIC  X(0001).
   891     05  BST8I PIC  X(0002).
   892*    -------------------------------
   893     05  BAST08L PIC S9(0004) COMP.
   894     05  BAST08F PIC  X(0001).
   895     05  FILLER REDEFINES BAST08F.
   896         10  BAST08A PIC  X(0001).
   897     05  BAST08I PIC  X(0001).
   898*    -------------------------------
   899     05  BKEY08L PIC S9(0004) COMP.
   900     05  BKEY08F PIC  X(0001).
   901     05  FILLER REDEFINES BKEY08F.
   902         10  BKEY08A PIC  X(0001).
   903     05  BKEY08I PIC  X(0068).
   904*    -------------------------------
   905     05  BEMSG1L PIC S9(0004) COMP.
   906     05  BEMSG1F PIC  X(0001).
   907     05  FILLER REDEFINES BEMSG1F.
   908         10  BEMSG1A PIC  X(0001).
   909     05  BEMSG1I PIC  X(0079).
   910*    -------------------------------
   911     05  BSELL PIC S9(0004) COMP.
   912     05  BSELF PIC  X(0001).
   913     05  FILLER REDEFINES BSELF.
   914         10  BSELA PIC  X(0001).
   915     05  BSELI PIC  9.
   916*    -------------------------------
   917     05  BPFKL PIC S9(0004) COMP.
   918     05  BPFKF PIC  X(0001).
   919     05  FILLER REDEFINES BPFKF.
   920         10  BPFKA PIC  X(0001).
   921     05  BPFKI PIC  99.
   922 01  EL659BO REDEFINES EL659BI.
   923     05  FILLER            PIC  X(0012).
   924*    -------------------------------
   925     05  FILLER            PIC  X(0003).
   926     05  BDATEO PIC  X(0008).
   927*    -------------------------------
   928     05  FILLER            PIC  X(0003).
   929     05  BTIMEO PIC  99.99.
   930*    -------------------------------
   931     05  FILLER            PIC  X(0003).
   932     05  CMPNYIDO PIC  X(0003).
   933*    -------------------------------
   934     05  FILLER            PIC  X(0003).
   935     05  USERIDO PIC  X(0004).
   936*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6592.cbl
   937     05  FILLER            PIC  X(0003).
   938     05  BTYP01O PIC  X(0001).
   939*    -------------------------------
   940     05  FILLER            PIC  X(0003).
   941     05  BNAM01O PIC  X(0030).
   942*    -------------------------------
   943     05  FILLER            PIC  X(0003).
   944     05  BCITY1O PIC  X(0015).
   945*    -------------------------------
   946     05  FILLER            PIC  X(0003).
   947     05  BST1O PIC  X(0002).
   948*    -------------------------------
   949     05  FILLER            PIC  X(0003).
   950     05  BAST01O PIC  X(0001).
   951*    -------------------------------
   952     05  FILLER            PIC  X(0003).
   953     05  BKEY01O PIC  X(0068).
   954*    -------------------------------
   955     05  FILLER            PIC  X(0003).
   956     05  BTYP02O PIC  X(0001).
   957*    -------------------------------
   958     05  FILLER            PIC  X(0003).
   959     05  BNAM02O PIC  X(0030).
   960*    -------------------------------
   961     05  FILLER            PIC  X(0003).
   962     05  BCITY2O PIC  X(0015).
   963*    -------------------------------
   964     05  FILLER            PIC  X(0003).
   965     05  BST2O PIC  X(0002).
   966*    -------------------------------
   967     05  FILLER            PIC  X(0003).
   968     05  BAST02O PIC  X(0001).
   969*    -------------------------------
   970     05  FILLER            PIC  X(0003).
   971     05  BKEY02O PIC  X(0068).
   972*    -------------------------------
   973     05  FILLER            PIC  X(0003).
   974     05  BTYP03O PIC  X(0001).
   975*    -------------------------------
   976     05  FILLER            PIC  X(0003).
   977     05  BNAM03O PIC  X(0030).
   978*    -------------------------------
   979     05  FILLER            PIC  X(0003).
   980     05  BCITY3O PIC  X(0015).
   981*    -------------------------------
   982     05  FILLER            PIC  X(0003).
   983     05  BST3O PIC  X(0002).
   984*    -------------------------------
   985     05  FILLER            PIC  X(0003).
   986     05  BAST03O PIC  X(0001).
   987*    -------------------------------
   988     05  FILLER            PIC  X(0003).
   989     05  BKEY03O PIC  X(0068).
   990*    -------------------------------
   991     05  FILLER            PIC  X(0003).
   992     05  BTYP04O PIC  X(0001).
   993*    -------------------------------
   994     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6592.cbl
   995     05  BNAM04O PIC  X(0030).
   996*    -------------------------------
   997     05  FILLER            PIC  X(0003).
   998     05  BCITY4O PIC  X(0015).
   999*    -------------------------------
  1000     05  FILLER            PIC  X(0003).
  1001     05  BST4O PIC  X(0002).
  1002*    -------------------------------
  1003     05  FILLER            PIC  X(0003).
  1004     05  BAST04O PIC  X(0001).
  1005*    -------------------------------
  1006     05  FILLER            PIC  X(0003).
  1007     05  BKEY04O PIC  X(0068).
  1008*    -------------------------------
  1009     05  FILLER            PIC  X(0003).
  1010     05  BTYP05O PIC  X(0001).
  1011*    -------------------------------
  1012     05  FILLER            PIC  X(0003).
  1013     05  BNAM05O PIC  X(0030).
  1014*    -------------------------------
  1015     05  FILLER            PIC  X(0003).
  1016     05  BCITY5O PIC  X(0015).
  1017*    -------------------------------
  1018     05  FILLER            PIC  X(0003).
  1019     05  BST5O PIC  X(0002).
  1020*    -------------------------------
  1021     05  FILLER            PIC  X(0003).
  1022     05  BAST05O PIC  X(0001).
  1023*    -------------------------------
  1024     05  FILLER            PIC  X(0003).
  1025     05  BKEY05O PIC  X(0068).
  1026*    -------------------------------
  1027     05  FILLER            PIC  X(0003).
  1028     05  BTYP06O PIC  X(0001).
  1029*    -------------------------------
  1030     05  FILLER            PIC  X(0003).
  1031     05  BNAM06O PIC  X(0030).
  1032*    -------------------------------
  1033     05  FILLER            PIC  X(0003).
  1034     05  BCITY6O PIC  X(0015).
  1035*    -------------------------------
  1036     05  FILLER            PIC  X(0003).
  1037     05  BST6O PIC  X(0002).
  1038*    -------------------------------
  1039     05  FILLER            PIC  X(0003).
  1040     05  BAST06O PIC  X(0001).
  1041*    -------------------------------
  1042     05  FILLER            PIC  X(0003).
  1043     05  BKEY06O PIC  X(0068).
  1044*    -------------------------------
  1045     05  FILLER            PIC  X(0003).
  1046     05  BTYP07O PIC  X(0001).
  1047*    -------------------------------
  1048     05  FILLER            PIC  X(0003).
  1049     05  BNAM07O PIC  X(0030).
  1050*    -------------------------------
  1051     05  FILLER            PIC  X(0003).
  1052     05  BCITY7O PIC  X(0015).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6592.cbl
  1053*    -------------------------------
  1054     05  FILLER            PIC  X(0003).
  1055     05  BST7O PIC  X(0002).
  1056*    -------------------------------
  1057     05  FILLER            PIC  X(0003).
  1058     05  BAST07O PIC  X(0001).
  1059*    -------------------------------
  1060     05  FILLER            PIC  X(0003).
  1061     05  BKEY07O PIC  X(0068).
  1062*    -------------------------------
  1063     05  FILLER            PIC  X(0003).
  1064     05  BTYP08O PIC  X(0001).
  1065*    -------------------------------
  1066     05  FILLER            PIC  X(0003).
  1067     05  BNAM08O PIC  X(0030).
  1068*    -------------------------------
  1069     05  FILLER            PIC  X(0003).
  1070     05  BCITY8O PIC  X(0015).
  1071*    -------------------------------
  1072     05  FILLER            PIC  X(0003).
  1073     05  BST8O PIC  X(0002).
  1074*    -------------------------------
  1075     05  FILLER            PIC  X(0003).
  1076     05  BAST08O PIC  X(0001).
  1077*    -------------------------------
  1078     05  FILLER            PIC  X(0003).
  1079     05  BKEY08O PIC  X(0068).
  1080*    -------------------------------
  1081     05  FILLER            PIC  X(0003).
  1082     05  BEMSG1O PIC  X(0079).
  1083*    -------------------------------
  1084     05  FILLER            PIC  X(0003).
  1085     05  BSELO PIC  X(0001).
  1086*    -------------------------------
  1087     05  FILLER            PIC  X(0003).
  1088     05  BPFKO PIC  X(0002).
  1089*    -------------------------------
  1090
  1091 01  FILLER  REDEFINES  EL659BI.
  1092     12  FILLER                      PIC  X(44).
  1093     12  EL659B-MAP-LINE     OCCURS  8  TIMES
  1094             INDEXED  BY  EL659B-INDEX  EL659B-INDEX2.
  1095         16  EL659B-TYPE-LENGTH      PIC S9(04)      COMP.
  1096         16  EL659B-TYPE-ATTR        PIC  X(01).
  1097         16  EL659B-TYPE             PIC  X(01).
  1098         16  EL659B-NAME-LENGTH      PIC S9(04)      COMP.
  1099         16  EL659B-NAME-ATTR        PIC  X(01).
  1100         16  EL659B-NAME             PIC  X(30).
  1101         16  EL659B-CITY-LENGTH      PIC S9(04)      COMP.
  1102         16  EL659B-CITY-ATTR        PIC  X(01).
  1103         16  EL659B-CITY             PIC  X(15).
  1104         16  EL659B-ST-LENGTH        PIC S9(04)      COMP.
  1105         16  EL659B-ST-ATTR          PIC  X(01).
  1106         16  EL659B-ST               PIC  XX.
  1107         16  EL659B-AST-LENGTH       PIC S9(04)      COMP.
  1108         16  EL659B-AST-ATTR         PIC  X(01).
  1109         16  EL659B-AST              PIC  X(01).
  1110         16  EL659B-KEY-LENGTH       PIC S9(04)      COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6592.cbl
  1111         16  EL659B-KEY-ATTR         PIC  X(01).
  1112         16  EL659B-KEY              PIC  X(68).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6592.cbl
  1114*    COPY ELCDATE.
  1115******************************************************************
  1116*                                                                *
  1117*                                                                *
  1118*                            ELCDATE.                            *
  1119*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1120*                            VMOD=2.003
  1121*                                                                *
  1122*                                                                *
  1123*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1124*                 LENGTH = 200                                   *
  1125******************************************************************
  1126
  1127 01  DATE-CONVERSION-DATA.
  1128     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1129     12  DC-OPTION-CODE                PIC X.
  1130         88  BIN-TO-GREG                VALUE ' '.
  1131         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1132         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1133         88  YMD-GREG-TO-BIN            VALUE '3'.
  1134         88  MDY-GREG-TO-BIN            VALUE '4'.
  1135         88  JULIAN-TO-BIN              VALUE '5'.
  1136         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1137         88  FIND-CENTURY               VALUE '7'.
  1138         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1139         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1140         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1141         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1142         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1143         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1144         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1145         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1146         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1147         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1148         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1149         88  BIN-3-TO-GREG              VALUE 'I'.
  1150         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1151         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1152         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1153         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1154         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1155         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1156         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1157         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1158         88  THREE-CHARACTER-BIN
  1159                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1160         88  GREGORIAN-TO-BIN
  1161                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1162         88  BIN-TO-GREGORIAN
  1163                  VALUES ' ' '1' 'I' '8' 'G'.
  1164         88  JULIAN-TO-BINARY
  1165                  VALUES '5' 'C' 'E' 'F'.
  1166     12  DC-ERROR-CODE                 PIC X.
  1167         88  NO-CONVERSION-ERROR        VALUE ' '.
  1168         88  DATE-CONVERSION-ERROR
  1169                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1170         88  DATE-IS-ZERO               VALUE '1'.
  1171         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6592.cbl
  1172         88  DATE-IS-INVALID            VALUE '3'.
  1173         88  DATE1-GREATER-DATE2        VALUE '4'.
  1174         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1175         88  DATE-INVALID-OPTION        VALUE '9'.
  1176         88  INVALID-CENTURY            VALUE 'A'.
  1177         88  ONLY-CENTURY               VALUE 'B'.
  1178         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1179         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1180     12  DC-END-OF-MONTH               PIC X.
  1181         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1182     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1183         88  USE-NORMAL-PROCESS         VALUE ' '.
  1184         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1185         88  ADJUST-UP-100-YRS          VALUE '2'.
  1186     12  FILLER                        PIC X.
  1187     12  DC-CONVERSION-DATES.
  1188         16  DC-BIN-DATE-1             PIC XX.
  1189         16  DC-BIN-DATE-2             PIC XX.
  1190         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1191         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1192                       DC-GREG-DATE-1-EDIT.
  1193             20  DC-EDIT1-MONTH        PIC 99.
  1194             20  SLASH1-1              PIC X.
  1195             20  DC-EDIT1-DAY          PIC 99.
  1196             20  SLASH1-2              PIC X.
  1197             20  DC-EDIT1-YEAR         PIC 99.
  1198         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1199         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1200                     DC-GREG-DATE-2-EDIT.
  1201             20  DC-EDIT2-MONTH        PIC 99.
  1202             20  SLASH2-1              PIC X.
  1203             20  DC-EDIT2-DAY          PIC 99.
  1204             20  SLASH2-2              PIC X.
  1205             20  DC-EDIT2-YEAR         PIC 99.
  1206         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1207         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1208                     DC-GREG-DATE-1-YMD.
  1209             20  DC-YMD-YEAR           PIC 99.
  1210             20  DC-YMD-MONTH          PIC 99.
  1211             20  DC-YMD-DAY            PIC 99.
  1212         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1213         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1214                      DC-GREG-DATE-1-MDY.
  1215             20  DC-MDY-MONTH          PIC 99.
  1216             20  DC-MDY-DAY            PIC 99.
  1217             20  DC-MDY-YEAR           PIC 99.
  1218         16  DC-GREG-DATE-1-ALPHA.
  1219             20  DC-ALPHA-MONTH        PIC X(10).
  1220             20  DC-ALPHA-DAY          PIC 99.
  1221             20  FILLER                PIC XX.
  1222             20  DC-ALPHA-CENTURY.
  1223                 24 DC-ALPHA-CEN-N     PIC 99.
  1224             20  DC-ALPHA-YEAR         PIC 99.
  1225         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1226         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1227         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1228         16  DC-JULIAN-DATE            PIC 9(05).
  1229         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6592.cbl
  1230                                       PIC 9(05).
  1231         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1232             20  DC-JULIAN-YEAR        PIC 99.
  1233             20  DC-JULIAN-DAYS        PIC 999.
  1234         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1235         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1236         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1237     12  DATE-CONVERSION-VARIBLES.
  1238         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1239         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1240             20  FILLER                PIC 9(3).
  1241             20  HOLD-CEN-1-CCYY.
  1242                 24  HOLD-CEN-1-CC     PIC 99.
  1243                 24  HOLD-CEN-1-YY     PIC 99.
  1244             20  HOLD-CEN-1-MO         PIC 99.
  1245             20  HOLD-CEN-1-DA         PIC 99.
  1246         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1247             20  HOLD-CEN-1-R-MO       PIC 99.
  1248             20  HOLD-CEN-1-R-DA       PIC 99.
  1249             20  HOLD-CEN-1-R-CCYY.
  1250                 24  HOLD-CEN-1-R-CC   PIC 99.
  1251                 24  HOLD-CEN-1-R-YY   PIC 99.
  1252             20  FILLER                PIC 9(3).
  1253         16  HOLD-CENTURY-1-X.
  1254             20  FILLER                PIC X(3)  VALUE SPACES.
  1255             20  HOLD-CEN-1-X-CCYY.
  1256                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1257                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1258             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1259             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1260         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1261             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1262             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1263             20  HOLD-CEN-1-R-X-CCYY.
  1264                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1265                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1266             20  FILLER                PIC XXX.
  1267         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1268         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1269         16  DC-JULIAN-DATE-1          PIC 9(07).
  1270         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1271             20  DC-JULIAN-1-CCYY.
  1272                 24  DC-JULIAN-1-CC    PIC 99.
  1273                 24  DC-JULIAN-1-YR    PIC 99.
  1274             20  DC-JULIAN-DA-1        PIC 999.
  1275         16  DC-JULIAN-DATE-2          PIC 9(07).
  1276         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1277             20  DC-JULIAN-2-CCYY.
  1278                 24  DC-JULIAN-2-CC    PIC 99.
  1279                 24  DC-JULIAN-2-YR    PIC 99.
  1280             20  DC-JULIAN-DA-2        PIC 999.
  1281         16  DC-GREG-DATE-A-EDIT.
  1282             20  DC-EDITA-MONTH        PIC 99.
  1283             20  SLASHA-1              PIC X VALUE '/'.
  1284             20  DC-EDITA-DAY          PIC 99.
  1285             20  SLASHA-2              PIC X VALUE '/'.
  1286             20  DC-EDITA-CCYY.
  1287                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6592.cbl
  1288                 24  DC-EDITA-YEAR     PIC 99.
  1289         16  DC-GREG-DATE-B-EDIT.
  1290             20  DC-EDITB-MONTH        PIC 99.
  1291             20  SLASHB-1              PIC X VALUE '/'.
  1292             20  DC-EDITB-DAY          PIC 99.
  1293             20  SLASHB-2              PIC X VALUE '/'.
  1294             20  DC-EDITB-CCYY.
  1295                 24  DC-EDITB-CENT     PIC 99.
  1296                 24  DC-EDITB-YEAR     PIC 99.
  1297         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1298         16  DC-GREG-DATE-CYMD-R REDEFINES
  1299                              DC-GREG-DATE-CYMD.
  1300             20  DC-CYMD-CEN           PIC 99.
  1301             20  DC-CYMD-YEAR          PIC 99.
  1302             20  DC-CYMD-MONTH         PIC 99.
  1303             20  DC-CYMD-DAY           PIC 99.
  1304         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1305         16  DC-GREG-DATE-MDCY-R REDEFINES
  1306                              DC-GREG-DATE-MDCY.
  1307             20  DC-MDCY-MONTH         PIC 99.
  1308             20  DC-MDCY-DAY           PIC 99.
  1309             20  DC-MDCY-CEN           PIC 99.
  1310             20  DC-MDCY-YEAR          PIC 99.
  1311    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1312        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1313    12  DC-EL310-DATE                  PIC X(21).
  1314    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6592.cbl
  1316*    COPY ELCEMIB.
  1317******************************************************************
  1318*                                                                *
  1319*                                                                *
  1320*                            ELCEMIB.                            *
  1321*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1322*                            VMOD=2.005                          *
  1323*                                                                *
  1324*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1325*                                                                *
  1326******************************************************************
  1327 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1328     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1329     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1330     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1331     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1332     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1333     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1334     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1335     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1336     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1337         88  EMI-NO-ERRORS                    VALUE '1'.
  1338         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1339         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1340     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1341         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1342     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1343         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1344         88  EMI-AREA1-FULL                   VALUE '2'.
  1345     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1346         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1347         88  EMI-AREA2-FULL                   VALUE '2'.
  1348     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1349         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1350         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1351         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1352         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1353         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1354     12  EMI-ERROR-LINES.
  1355         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1356         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1357         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1358         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1359             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1360                 24  EMI-ERR-NUM         PIC X(4).
  1361                 24  EMI-FILLER          PIC X.
  1362                 24  EMI-SEV             PIC X.
  1363                 24  FILLER              PIC X.
  1364             20  FILLER                  PIC X(02).
  1365     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1366         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1367             20  EMI-ERROR-NUMBER    PIC X(4).
  1368             20  EMI-FILL            PIC X.
  1369             20  EMI-SEVERITY        PIC X.
  1370             20  FILLER              PIC X.
  1371             20  EMI-ERROR-TEXT.
  1372                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1373                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6592.cbl
  1374     12  EMI-SEVERITY-SAVE           PIC X.
  1375         88  EMI-NOTE                    VALUE 'N'.
  1376         88  EMI-WARNING                 VALUE 'W'.
  1377         88  EMI-FORCABLE                VALUE 'F'.
  1378         88  EMI-FATAL                   VALUE 'X'.
  1379     12  EMI-MESSAGE-FLAG            PIC X.
  1380         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1381         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1382     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1383     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1384         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1385         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1386         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1387     12  FILLER                      PIC X(137)  VALUE SPACES.
  1388     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1389     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1390     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1391     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6592.cbl
  1393*    COPY ELCLOGOF.
  1394******************************************************************
  1395*                                                                *
  1396*                                                                *
  1397*                            ELCLOGOF.                           *
  1398*                            VMOD=2.001                          *
  1399*                                                                *
  1400*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1401*                                                                *
  1402******************************************************************
  1403 01  CLASIC-LOGOFF.
  1404     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1405     12  LOGOFF-TEXT.
  1406         16  FILLER          PIC X(5)    VALUE SPACES.
  1407         16  LOGOFF-MSG.
  1408             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1409             20  FILLER      PIC X       VALUE SPACES.
  1410             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1411         16  FILLER          PIC X(80)
  1412           VALUE '* YOU ARE NOW LOGGED OFF'.
  1413         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1414         16  FILLER          PIC X       VALUE QUOTE.
  1415         16  LOGOFF-SYS-MSG  PIC X(17)
  1416           VALUE 'S CLAS-IC SYSTEM '.
  1417     12  TEXT-MESSAGES.
  1418         16  UNACCESS-MSG    PIC X(29)
  1419             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1420         16  PGMIDERR-MSG    PIC X(17)
  1421             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6592.cbl
  1423*    COPY ELCATTR.
  1424******************************************************************
  1425*                                                                *
  1426*                            ELCATTR.                            *
  1427*                            VMOD=2.001                          *
  1428*                                                                *
  1429*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1430*                                                                *
  1431*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1432*                                                                *
  1433*                   POS 1   P=PROTECTED                          *
  1434*                           U=UNPROTECTED                        *
  1435*                           S=ASKIP                              *
  1436*                   POS 2   A=ALPHA/NUMERIC                      *
  1437*                           N=NUMERIC                            *
  1438*                   POS 3   N=NORMAL                             *
  1439*                           B=BRIGHT                             *
  1440*                           D=DARK                               *
  1441*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1442*                           OF=MODIFIED DATA TAG OFF             *
  1443*                                                                *
  1444*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1445******************************************************************
  1446 01  ATTRIBUTE-LIST.
  1447     12  AL-PABOF            PIC X       VALUE 'Y'.
  1448     12  AL-PABON            PIC X       VALUE 'Z'.
  1449     12  AL-PADOF            PIC X       VALUE '%'.
  1450     12  AL-PADON            PIC X       VALUE '_'.
  1451     12  AL-PANOF            PIC X       VALUE '-'.
  1452     12  AL-PANON            PIC X       VALUE '/'.
  1453     12  AL-SABOF            PIC X       VALUE '8'.
  1454     12  AL-SABON            PIC X       VALUE '9'.
  1455     12  AL-SADOF            PIC X       VALUE '@'.
  1456     12  AL-SADON            PIC X       VALUE QUOTE.
  1457     12  AL-SANOF            PIC X       VALUE '0'.
  1458     12  AL-SANON            PIC X       VALUE '1'.
  1459     12  AL-UABOF            PIC X       VALUE 'H'.
  1460     12  AL-UABON            PIC X       VALUE 'I'.
  1461     12  AL-UADOF            PIC X       VALUE '<'.
  1462     12  AL-UADON            PIC X       VALUE '('.
  1463     12  AL-UANOF            PIC X       VALUE ' '.
  1464     12  AL-UANON            PIC X       VALUE 'A'.
  1465     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1466     12  AL-UNBON            PIC X       VALUE 'R'.
  1467     12  AL-UNDOF            PIC X       VALUE '*'.
  1468     12  AL-UNDON            PIC X       VALUE ')'.
  1469     12  AL-UNNOF            PIC X       VALUE '&'.
  1470     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6592.cbl
  1472*    COPY ELCAID.
  1473******************************************************************
  1474*                                                                *
  1475*                            ELCAID.                             *
  1476*                            VMOD=2.001                          *
  1477*                                                                *
  1478*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1479*                                                                *
  1480*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1481*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1482******************************************************************
  1483
  1484 01  DFHAID.
  1485   02  DFHNULL   PIC  X  VALUE  ' '.
  1486   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1487   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1488   02  DFHPEN    PIC  X  VALUE  '='.
  1489   02  DFHOPID   PIC  X  VALUE  'W'.
  1490   02  DFHPA1    PIC  X  VALUE  '%'.
  1491   02  DFHPA2    PIC  X  VALUE  '>'.
  1492   02  DFHPA3    PIC  X  VALUE  ','.
  1493   02  DFHPF1    PIC  X  VALUE  '1'.
  1494   02  DFHPF2    PIC  X  VALUE  '2'.
  1495   02  DFHPF3    PIC  X  VALUE  '3'.
  1496   02  DFHPF4    PIC  X  VALUE  '4'.
  1497   02  DFHPF5    PIC  X  VALUE  '5'.
  1498   02  DFHPF6    PIC  X  VALUE  '6'.
  1499   02  DFHPF7    PIC  X  VALUE  '7'.
  1500   02  DFHPF8    PIC  X  VALUE  '8'.
  1501   02  DFHPF9    PIC  X  VALUE  '9'.
  1502   02  DFHPF10   PIC  X  VALUE  ':'.
  1503   02  DFHPF11   PIC  X  VALUE  '#'.
  1504   02  DFHPF12   PIC  X  VALUE  '@'.
  1505   02  DFHPF13   PIC  X  VALUE  'A'.
  1506   02  DFHPF14   PIC  X  VALUE  'B'.
  1507   02  DFHPF15   PIC  X  VALUE  'C'.
  1508   02  DFHPF16   PIC  X  VALUE  'D'.
  1509   02  DFHPF17   PIC  X  VALUE  'E'.
  1510   02  DFHPF18   PIC  X  VALUE  'F'.
  1511   02  DFHPF19   PIC  X  VALUE  'G'.
  1512   02  DFHPF20   PIC  X  VALUE  'H'.
  1513   02  DFHPF21   PIC  X  VALUE  'I'.
  1514*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1515   02  DFHPF22   PIC  X  VALUE  '['.
  1516   02  DFHPF23   PIC  X  VALUE  '.'.
  1517   02  DFHPF24   PIC  X  VALUE  '<'.
  1518   02  DFHMSRE   PIC  X  VALUE  'X'.
  1519   02  DFHSTRF   PIC  X  VALUE  'h'.
  1520   02  DFHTRIG   PIC  X  VALUE  '"'.
  1521
  1522 01  FILLER  REDEFINES  DFHAID.
  1523     12  FILLER                  PIC  X(08).
  1524     12  PF-VALUES               PIC  X(01)
  1525             OCCURS  24  TIMES.
  1526
  1527****************************************************************
  1528*
  1529* Copyright (c) 2007 by Clerity Solutions, Inc.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6592.cbl
  1530* All rights reserved.
  1531*
  1532****************************************************************
  1533 01  DFHEIV.
  1534   02  DFHEIV0               PIC X(35).
  1535   02  DFHEIV1               PIC X(08).
  1536   02  DFHEIV2               PIC X(08).
  1537   02  DFHEIV3               PIC X(08).
  1538   02  DFHEIV4               PIC X(06).
  1539   02  DFHEIV5               PIC X(04).
  1540   02  DFHEIV6               PIC X(04).
  1541   02  DFHEIV7               PIC X(02).
  1542   02  DFHEIV8               PIC X(02).
  1543   02  DFHEIV9               PIC X(01).
  1544   02  DFHEIV10              PIC S9(7) COMP-3.
  1545   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1546   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1547   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1548   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1549   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1550   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1551   02  DFHEIV17              PIC X(04).
  1552   02  DFHEIV18              PIC X(04).
  1553   02  DFHEIV19              PIC X(04).
  1554   02  DFHEIV20              USAGE IS POINTER.
  1555   02  DFHEIV21              USAGE IS POINTER.
  1556   02  DFHEIV22              USAGE IS POINTER.
  1557   02  DFHEIV23              USAGE IS POINTER.
  1558   02  DFHEIV24              USAGE IS POINTER.
  1559   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1560   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1561   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1562   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1563   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1564   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1565   02  FILLER                PIC X(02).
  1566   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1567   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1568   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1569   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1570   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1571 LINKAGE  SECTION.
  1572*****************************************************************
  1573*                                                               *
  1574* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1575* All rights reserved.                                          *
  1576*                                                               *
  1577*****************************************************************
  1578 01  dfheiblk.
  1579     02  eibtime          pic s9(7) comp-3.
  1580     02  eibdate          pic s9(7) comp-3.
  1581     02  eibtrnid         pic x(4).
  1582     02  eibtaskn         pic s9(7) comp-3.
  1583     02  eibtrmid         pic x(4).
  1584     02  dfheigdi         pic s9(4) comp.
  1585     02  eibcposn         pic s9(4) comp.
  1586     02  eibcalen         pic s9(4) comp.
  1587     02  eibaid           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6592.cbl
  1588     02  eibfiller1       pic x(1).
  1589     02  eibfn            pic x(2).
  1590     02  eibfiller2       pic x(2).
  1591     02  eibrcode         pic x(6).
  1592     02  eibfiller3       pic x(2).
  1593     02  eibds            pic x(8).
  1594     02  eibreqid         pic x(8).
  1595     02  eibrsrce         pic x(8).
  1596     02  eibsync          pic x(1).
  1597     02  eibfree          pic x(1).
  1598     02  eibrecv          pic x(1).
  1599     02  eibsend          pic x(1).
  1600     02  eibatt           pic x(1).
  1601     02  eibeoc           pic x(1).
  1602     02  eibfmh           pic x(1).
  1603     02  eibcompl         pic x(1).
  1604     02  eibsig           pic x(1).
  1605     02  eibconf          pic x(1).
  1606     02  eiberr           pic x(1).
  1607     02  eibrldbk         pic x(1).
  1608     02  eiberrcd         pic x(4).
  1609     02  eibsynrb         pic x(1).
  1610     02  eibnodat         pic x(1).
  1611     02  eibfiller5       pic x(2).
  1612     02  eibresp          pic 9(09) comp.
  1613     02  eibresp2         pic 9(09) comp.
  1614     02  dfheigdj         pic s9(4) comp.
  1615     02  dfheigdk         pic s9(4) comp.
  1616
  1617 01  DFHCOMMAREA                 PIC  X(1024).
  1618
  1619*01 PARMLIST             COMP.
  1620*    12  FILLER                  PIC S9(09).
  1621*    12  ERNAME-POINTER          PIC S9(09).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6592.cbl
  1623*    COPY ERCNAME.
  1624******************************************************************
  1625*                                                                *
  1626*                                                                *
  1627*                            ERCNAME                             *
  1628*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1629*                            VMOD=2.003                          *
  1630*                                                                *
  1631*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  1632*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  1633*                                                                *
  1634*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  1635*                                                                *
  1636*   FILE TYPE = VSAM,KSDS                                        *
  1637*   RECORD SIZE = 160   RECFORM = FIX                            *
  1638*                                                                *
  1639*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  1640*                                                                *
  1641*   LOG = NO                                                     *
  1642*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1643*                                                                *
  1644*                                                                *
  1645******************************************************************
  1646
  1647 01  NAME-LOOKUP-MASTER.
  1648     12  NL-RECORD-ID                PIC  X(02).
  1649         88  VALID-NL-ID                         VALUE 'NL'.
  1650
  1651     12  NL-RECORD-KEY.
  1652         16  NL-CONTROL-PRIMARY.
  1653             20  NL-COMPANY-CD       PIC  X(01).
  1654             20  NL-NAME             PIC  X(30).
  1655             20  NL-RECORD-TYPE      PIC  X(01).
  1656                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  1657                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  1658                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  1659
  1660         16  NL-ACCOUNT-MASTER.
  1661             20  NL-AM-COMPANY-CD    PIC  X(01).
  1662             20  NL-AM-CARRIER       PIC  X(01).
  1663             20  NL-AM-GROUPING      PIC  X(06).
  1664             20  NL-AM-STATE         PIC  X(02).
  1665             20  NL-AM-ACCOUNT       PIC  X(10).
  1666             20  FILLER              PIC  X(09).
  1667
  1668         16  NL-COMPENSATION-MASTER
  1669                                 REDEFINES  NL-ACCOUNT-MASTER.
  1670             20  NL-CO-COMPANY-CD    PIC  X(01).
  1671             20  NL-CO-CARRIER       PIC  X(01).
  1672             20  NL-CO-GROUPING      PIC  X(06).
  1673             20  NL-CO-RESP-NO       PIC  X(10).
  1674             20  NL-CO-ACCOUNT       PIC  X(10).
  1675             20  NL-CO-TYPE          PIC  X(01).
  1676
  1677         16  NL-REINSURANCE-RECORD
  1678                                 REDEFINES  NL-ACCOUNT-MASTER.
  1679             20  NL-RE-COMPANY-CD    PIC  X(01).
  1680             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6592.cbl
  1681             20  NL-RE-COMPANY.
  1682                 24  NL-RE-COMP      PIC  X(03).
  1683                 24  NL-RE-CO-SUB    PIC  X(03).
  1684             20  NL-RE-TABLE         PIC  X(03).
  1685             20  FILLER              PIC  X(18).
  1686
  1687     12  NL-MAINT-INFORMATION.
  1688         16  NL-LAST-MAINT-DT        PIC  X(02).
  1689         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  1690         16  NL-LAST-MAINT-USER      PIC  X(04).
  1691         16  FILLER                  PIC  X(10).
  1692
  1693     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  1694         16  NL-RE-LEVEL             PIC  9(02).
  1695
  1696     12  NL-CITY                     PIC  X(15).
  1697     12  NL-ST                       PIC  XX.
  1698
  1699******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6592.cbl
  1701 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  1702                          NAME-LOOKUP-MASTER.
  1703 0000-DFHEXIT SECTION.
  1704     MOVE '9#                    $   ' TO DFHEIV0.
  1705     MOVE 'EL6592' TO DFHEIV1.
  1706     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1707
  1708     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  1709     MOVE '5'                    TO  DC-OPTION-CODE.
  1710
  1711     PERFORM 8500-DATE-CONVERSION.
  1712
  1713     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  1714     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  1715     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  1716
  1717*    NOTE *******************************************************
  1718*         *      ACCESS TO THIS MODULE CAN BE ONLY FROM AN XCTL *
  1719*         *  FROM ANOTHER MODULE.                               *
  1720*         *******************************************************.
  1721
  1722     IF EIBCALEN  IS NOT GREATER THAN  ZERO
  1723         MOVE UNACCESS-MSG       TO  LOGOFF-MSG
  1724         PERFORM 8300-SEND-TEXT.
  1725
  1726
  1727* EXEC CICS HANDLE CONDITION
  1728*        PGMIDERR  (9600-PGMIDERR)
  1729*        NOTFND    (8700-NOT-FOUND)
  1730*        ENDFILE   (4600-ENDFILE)
  1731*        DUPKEY    (4015-DUPKEY)
  1732*        ERROR     (9990-ERROR)
  1733*    END-EXEC.
  1734*    MOVE '"$LI''$.               ! " #00001722' TO DFHEIV0
  1735     MOVE X'22244C4927242E2020202020' TO DFHEIV0(1:12)
  1736     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1737     MOVE X'2220233030303031373232' TO DFHEIV0(25:11)
  1738     CALL 'kxdfhei1' USING DFHEIV0
  1739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1740
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6592.cbl
  1742 0010-MAIN-LOGIC.
  1743     IF PI-CALLING-PROGRAM  IS EQUAL TO  THIS-PGM
  1744         GO TO 0100-MAIN-LOGIC.
  1745
  1746     IF PI-RETURN-TO-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  1747         MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  1748         MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  1749         MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  1750         MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  1751         MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  1752         MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  1753         MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  1754         MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  1755     ELSE
  1756         MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  1757         MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  1758         MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  1759         MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  1760         MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  1761         MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  1762         MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  1763         MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  1764
  1765     MOVE ZERO                   TO  PI-SCREEN-COUNT.
  1766     MOVE +0                     TO  PI-SUB.
  1767     MOVE PI-NAME-LOOKUP-KEY     TO  PI-1ST-KEY.
  1768
  1769     IF EIBTRNID = EL650-TRANS-ID OR
  1770                   EL651-TRANS-ID OR
  1771                   EL652-TRANS-ID
  1772         MOVE EIBTRMID           TO  WS-TSK-TERM-ID
  1773                                     WS-TSK-TERM-ID1
  1774
  1775* EXEC CICS READQ TS
  1776*            QUEUE   (WS-TEMP-STORAGE-KEY)
  1777*            ITEM    (SC-ITEM)
  1778*            INTO    (EL659BI)
  1779*            LENGTH  (WS-TS-LENGTH)
  1780*        END-EXEC
  1781*    MOVE '*$II   L              ''   #00001762' TO DFHEIV0
  1782     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1783     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1784     MOVE X'2020233030303031373632' TO DFHEIV0(25:11)
  1785     CALL 'kxdfhei1' USING DFHEIV0,
  1786           WS-TEMP-STORAGE-KEY,
  1787           EL659BI,
  1788           WS-TS-LENGTH,
  1789           SC-ITEM,
  1790           DFHEIV99,
  1791           DFHEIV99
  1792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1793
  1794* EXEC CICS DELETEQ TS
  1795*            QUEUE  (WS-TEMP-STORAGE-KEY)
  1796*        END-EXEC
  1797*    MOVE '*&                    #   #00001768' TO DFHEIV0
  1798     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  1799     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6592.cbl
  1800     MOVE X'2020233030303031373638' TO DFHEIV0(25:11)
  1801     CALL 'kxdfhei1' USING DFHEIV0,
  1802           WS-TEMP-STORAGE-KEY,
  1803           DFHEIV99
  1804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1805
  1806* EXEC CICS READQ TS
  1807*            QUEUE   (WS-TEMP-STORAGE-KEY1)
  1808*            ITEM    (SC-ITEM)
  1809*            INTO    (PROGRAM-INTERFACE-BLOCK)
  1810*            LENGTH  (WS-TS-LENGTH)
  1811*        END-EXEC
  1812*    MOVE '*$II   L              ''   #00001771' TO DFHEIV0
  1813     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1814     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1815     MOVE X'2020233030303031373731' TO DFHEIV0(25:11)
  1816     CALL 'kxdfhei1' USING DFHEIV0,
  1817           WS-TEMP-STORAGE-KEY1,
  1818           PROGRAM-INTERFACE-BLOCK,
  1819           WS-TS-LENGTH,
  1820           SC-ITEM,
  1821           DFHEIV99,
  1822           DFHEIV99
  1823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1824
  1825* EXEC CICS DELETEQ TS
  1826*            QUEUE  (WS-TEMP-STORAGE-KEY1)
  1827*        END-EXEC
  1828*    MOVE '*&                    #   #00001777' TO DFHEIV0
  1829     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  1830     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1831     MOVE X'2020233030303031373737' TO DFHEIV0(25:11)
  1832     CALL 'kxdfhei1' USING DFHEIV0,
  1833           WS-TEMP-STORAGE-KEY1,
  1834           DFHEIV99
  1835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1836         MOVE ZERO               TO  PI-1ST-TIME-SW
  1837         MOVE LOW-VALUES         TO  BSELO
  1838                                     BPFKO
  1839         PERFORM 6000-SET-ATTRB
  1840             VARYING  EL659B-INDEX  FROM  PI-LINE-COUNT  BY  -1
  1841                 UNTIL  EL659B-INDEX  IS NOT GREATER THAN  ZERO
  1842         PERFORM 8100-SEND-INITIAL-MAP
  1843         GO TO 9100-RETURN-TRAN.
  1844
  1845     PERFORM 4000-BROWSE-CERT-FILE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6592.cbl
  1847 0100-MAIN-LOGIC.
  1848*    NOTE *******************************************************
  1849*         *      AFTER THE FIRST TIME THROUGH THE PROPER ATTEN- *
  1850*         *  TION KEY USAGE NEEDS TO BE CHECKED FOR VALIDITY    *
  1851*         *  BEFORE ANY FURTHER PROCESSING CAN BE DONE.         *
  1852*         *******************************************************.
  1853
  1854     IF EIBAID  IS EQUAL TO  DFHCLEAR
  1855         PERFORM 9400-CLEAR.
  1856
  1857     IF EIBAID  IS EQUAL TO  DFHPA1  OR  DFHPA2  OR  DFHPA3
  1858         MOVE LOW-VALUES         TO  EL659BO
  1859         MOVE -1                 TO  BPFKL
  1860         MOVE ER-0008            TO  EMI-ERROR
  1861         PERFORM 8200-SEND-DATAONLY
  1862         GO TO 9100-RETURN-TRAN.
  1863
  1864
  1865* EXEC CICS RECEIVE
  1866*        INTO    (EL659BI)
  1867*        MAPSET  (WS-MAPSET-NAME)
  1868*        MAP     (WS-MAP-NAME)
  1869*    END-EXEC.
  1870     MOVE LENGTH OF
  1871      EL659BI
  1872       TO DFHEIV11
  1873*    MOVE '8"T I  L              ''   #00001808' TO DFHEIV0
  1874     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1875     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1876     MOVE X'2020233030303031383038' TO DFHEIV0(25:11)
  1877     CALL 'kxdfhei1' USING DFHEIV0,
  1878           WS-MAP-NAME,
  1879           EL659BI,
  1880           DFHEIV11,
  1881           WS-MAPSET-NAME,
  1882           DFHEIV99,
  1883           DFHEIV99
  1884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1885
  1886
  1887     IF BPFKL  IS GREATER THAN  ZERO
  1888         IF EIBAID  IS NOT EQUAL TO  DFHENTER
  1889             MOVE ER-0004        TO  EMI-ERROR
  1890             MOVE AL-UNBOF       TO  BPFKA
  1891             MOVE -1             TO  BPFKL
  1892             PERFORM 8200-SEND-DATAONLY
  1893             GO TO 9100-RETURN-TRAN
  1894         ELSE
  1895             IF (BPFKI  IS NUMERIC)
  1896               AND (BPFKI  IS GREATER THAN  ZERO
  1897                   AND BPFKI  IS LESS THAN  25)
  1898                     MOVE PF-VALUES (BPFKI)
  1899                                 TO  EIBAID
  1900                 ELSE
  1901                     MOVE ER-0029
  1902                                 TO  EMI-ERROR
  1903                     MOVE AL-UNBOF
  1904                                 TO  BPFKA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6592.cbl
  1905                     MOVE -1     TO  BPFKL
  1906                     PERFORM 8200-SEND-DATAONLY
  1907                     GO TO 9100-RETURN-TRAN.
  1908
  1909*    NOTE *******************************************************
  1910*         *      PF KEY      USAGE                              *
  1911*         *        PF1       SEARCH FORWARD                     *
  1912*         *        PF2       SEARCH BACKWARD                    *
  1913*         *        PF3       NEW CLAIM SETUP                    *
  1914*         *        PF12      HELP                               *
  1915*         *        PF23      LOGOFF                             *
  1916*         *        PF24      RETURN TO MASTER MENU              *
  1917*         *******************************************************.
  1918
  1919     IF EIBAID  IS EQUAL TO  DFHPF12
  1920         MOVE 'EL010'            TO  THIS-PGM
  1921         GO TO 9300-XCTL.
  1922
  1923     IF EIBAID  IS EQUAL TO  DFHPF23
  1924         PERFORM 9000-RETURN-CICS.
  1925
  1926     IF EIBAID  IS EQUAL TO  DFHPF24
  1927         MOVE 'EL126'            TO  THIS-PGM
  1928         GO TO 9300-XCTL.
  1929
  1930     IF BSELL  IS GREATER THAN  ZERO
  1931         IF BSELI  IS NUMERIC
  1932             NEXT SENTENCE
  1933         ELSE
  1934             MOVE -1             TO  BSELL
  1935             MOVE ER-0200        TO  EMI-ERROR
  1936             PERFORM 8200-SEND-DATAONLY
  1937             GO TO 9100-RETURN-TRAN.
  1938
  1939     IF BSELL  IS GREATER THAN  ZERO
  1940         NEXT SENTENCE
  1941     ELSE
  1942         GO TO 0120-MAIN-LOGIC.
  1943
  1944     IF BSELL  IS GREATER THAN  ZERO
  1945       AND BSELO  IS GREATER THAN  ZERO
  1946       AND BSELO  IS LESS THAN  '9'
  1947       AND BSELI  IS NOT GREATER THAN  PI-LINE-COUNT
  1948         NEXT SENTENCE
  1949     ELSE
  1950         MOVE -1                 TO  BSELL
  1951         MOVE ER-0200            TO  EMI-ERROR
  1952         PERFORM 8200-SEND-DATAONLY
  1953         GO TO 9100-RETURN-TRAN.
  1954
  1955     IF EIBAID = DFHPF3
  1956      IF PI-SAVED-PROGRAM-1 NOT = 'EL130'
  1957        MOVE -1                 TO  BSELL
  1958        MOVE ER-7324            TO  EMI-ERROR
  1959        PERFORM 8200-SEND-DATAONLY
  1960        GO TO 9100-RETURN-TRAN
  1961       ELSE
  1962        SET EL659B-INDEX        TO  BSELI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6592.cbl
  1963       IF EL659B-TYPE (EL659B-INDEX) = 'A'
  1964         MOVE EL659B-KEY (EL659B-INDEX)
  1965                                 TO  ACCOUNT-KEY-LINE
  1966         MOVE AKL-CARRIER        TO PI-EL659-CARRIER
  1967         MOVE AKL-GROUPING       TO PI-EL659-GROUPING
  1968         MOVE AKL-STATE          TO PI-EL659-STATE
  1969         MOVE AKL-ACCOUNT        TO PI-EL659-ACCOUNT
  1970         MOVE 'EL130'            TO THIS-PGM
  1971         GO TO 9300-XCTL
  1972       ELSE
  1973         MOVE -1                 TO  BSELL
  1974         MOVE ER-9262            TO  EMI-ERROR
  1975         PERFORM 8200-SEND-DATAONLY
  1976         GO TO 9100-RETURN-TRAN.
  1977
  1978     IF BSELL  IS GREATER THAN  ZERO
  1979         MOVE EIBTRMID       TO  WS-TSK-TERM-ID
  1980                                 WS-TSK-TERM-ID1
  1981         MOVE -1             TO  BSELL
  1982
  1983* EXEC CICS WRITEQ TS
  1984*            FROM    (EL659BO)
  1985*            LENGTH  (WS-TS-LENGTH)
  1986*            QUEUE   (WS-TEMP-STORAGE-KEY)
  1987*            ITEM    (SC-ITEM)
  1988*        END-EXEC
  1989*    MOVE '*" I                  ''   #00001909' TO DFHEIV0
  1990     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  1991     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1992     MOVE X'2020233030303031393039' TO DFHEIV0(25:11)
  1993     CALL 'kxdfhei1' USING DFHEIV0,
  1994           WS-TEMP-STORAGE-KEY,
  1995           EL659BO,
  1996           WS-TS-LENGTH,
  1997           SC-ITEM,
  1998           DFHEIV99,
  1999           DFHEIV99
  2000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2001
  2002* EXEC CICS WRITEQ TS
  2003*            FROM    (PROGRAM-INTERFACE-BLOCK)
  2004*            LENGTH  (WS-TS-LENGTH)
  2005*            QUEUE   (WS-TEMP-STORAGE-KEY1)
  2006*            ITEM    (SC-ITEM)
  2007*        END-EXEC.
  2008*    MOVE '*" I                  ''   #00001915' TO DFHEIV0
  2009     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  2010     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2011     MOVE X'2020233030303031393135' TO DFHEIV0(25:11)
  2012     CALL 'kxdfhei1' USING DFHEIV0,
  2013           WS-TEMP-STORAGE-KEY1,
  2014           PROGRAM-INTERFACE-BLOCK,
  2015           WS-TS-LENGTH,
  2016           SC-ITEM,
  2017           DFHEIV99,
  2018           DFHEIV99
  2019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2020
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6592.cbl
  2022 0110-MAIN-LOGIC.
  2023     SET EL659B-INDEX            TO  BSELI.
  2024
  2025     MOVE PI-SAVED-PROGRAM-1     TO  THIS-PGM.
  2026
  2027     IF EL659B-TYPE (EL659B-INDEX)  IS EQUAL TO  'C'
  2028         GO TO 0112-SET-COMP-KEY.
  2029
  2030     IF EL659B-TYPE (EL659B-INDEX)  IS EQUAL TO  'R'
  2031         GO TO 0113-SET-REIN-KEY.
  2032
  2033 0111-SET-ACCT-KEY.
  2034     MOVE EL659B-KEY (EL659B-INDEX)
  2035                                 TO  ACCOUNT-KEY-LINE.
  2036     MOVE AKL-CARRIER            TO  PI-CR-CARRIER.
  2037     MOVE AKL-GROUPING           TO  PI-CR-GROUPING.
  2038     MOVE AKL-STATE              TO  PI-CR-STATE.
  2039     MOVE AKL-ACCOUNT            TO  PI-CR-ACCOUNT.
  2040     MOVE 'EL650'                TO  THIS-PGM.
  2041
  2042     GO TO 0114-CONTINUE.
  2043
  2044 0112-SET-COMP-KEY.
  2045     MOVE EL659B-KEY (EL659B-INDEX)
  2046                                 TO  COMPENSATION-KEY-LINE.
  2047     MOVE CKL-CARRIER            TO  PI-CR-CARRIER.
  2048     MOVE CKL-TYPE               TO  PI-CR-TYPE.
  2049
  2050     IF CKL-GROUPING IS EQUAL TO SPACES
  2051        MOVE LOW-VALUES          TO  PI-CR-GROUPING
  2052     ELSE
  2053        MOVE CKL-GROUPING        TO  PI-CR-GROUPING.
  2054
  2055     IF CKL-RESP  IS EQUAL TO  SPACES
  2056         MOVE LOW-VALUES         TO  PI-CR-FIN-RESP
  2057     ELSE
  2058         MOVE CKL-RESP           TO  PI-CR-FIN-RESP.
  2059
  2060     IF CKL-ACCOUNT  IS EQUAL TO  SPACES
  2061         MOVE LOW-VALUES         TO  PI-CR-ACCOUNT
  2062     ELSE
  2063         MOVE CKL-ACCOUNT        TO  PI-CR-ACCOUNT.
  2064
  2065     MOVE 'EL652'                TO  THIS-PGM.
  2066
  2067     GO TO 0114-CONTINUE.
  2068
  2069 0113-SET-REIN-KEY.
  2070     MOVE EL659B-KEY (EL659B-INDEX)
  2071                                 TO  REINSURANCE-KEY-LINE.
  2072     MOVE LOW-VALUES             TO  PI-ERREIN-KEY.
  2073     MOVE PI-COMPANY-CD          TO  PI-ERR-COMPANY-CD.
  2074     MOVE 'A'                    TO  PI-ERR-CODE.
  2075     MOVE RKL-REIN-TABLE         TO  PI-ERR-TABLE.
  2076     MOVE RKL-LEVEL (1)          TO  PI-ERR-LEVEL.
  2077     MOVE 'EL651'                TO  THIS-PGM.
  2078
  2079 0114-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6592.cbl
  2080     MOVE +2                     TO  PI-1ST-TIME-SW.
  2081
  2082     IF THIS-PGM  IS NOT EQUAL TO  'EL6592'
  2083         MOVE 'EL6592'           TO  PI-CALLING-PROGRAM
  2084         MOVE PI-SAVED-PROGRAM-1 TO  PI-RETURN-TO-PROGRAM
  2085         MOVE PI-SAVED-PROGRAM-2 TO  PI-SAVED-PROGRAM-1
  2086         MOVE PI-SAVED-PROGRAM-3 TO  PI-SAVED-PROGRAM-2
  2087         MOVE PI-SAVED-PROGRAM-4 TO  PI-SAVED-PROGRAM-3
  2088         MOVE PI-SAVED-PROGRAM-5 TO  PI-SAVED-PROGRAM-4
  2089         MOVE PI-SAVED-PROGRAM-6 TO  PI-SAVED-PROGRAM-5
  2090         MOVE SPACES             TO  PI-SAVED-PROGRAM-6.
  2091
  2092     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6592.cbl
  2094 0120-MAIN-LOGIC.
  2095     IF BSELL  = ZERO AND
  2096        EIBAID = DFHPF3
  2097         MOVE ER-7323            TO  EMI-ERROR
  2098         MOVE -1                 TO  BSELL
  2099         PERFORM 8200-SEND-DATAONLY
  2100         GO TO 9100-RETURN-TRAN.
  2101
  2102     IF EIBAID  IS EQUAL TO  (DFHENTER  OR  DFHPF1)
  2103       OR ((EIBAID  IS EQUAL TO  DFHPF2)
  2104       AND (PI-SCREEN-COUNT  IS GREATER THAN  +1))
  2105         NEXT SENTENCE
  2106     ELSE
  2107         MOVE ER-0008            TO  EMI-ERROR
  2108         MOVE -1                 TO  BPFKL
  2109         PERFORM 8200-SEND-DATAONLY
  2110         GO TO 9100-RETURN-TRAN.
  2111
  2112     IF PI-END-OF-FILE  IS NOT GREATER THAN  ZERO
  2113         PERFORM 4000-BROWSE-CERT-FILE.
  2114
  2115     IF PI-END-OF-FILE  IS GREATER THAN  ZERO
  2116         IF EIBAID  IS EQUAL TO  DFHPF2
  2117             NEXT SENTENCE
  2118         ELSE
  2119             MOVE -1             TO  BSELL
  2120             PERFORM 8200-SEND-DATAONLY
  2121             GO TO 9100-RETURN-TRAN.
  2122
  2123     IF EIBAID  IS EQUAL TO  DFHPF2
  2124         NEXT SENTENCE
  2125     ELSE
  2126         IF PI-DSID  IS NOT EQUAL TO  'ERNAME'
  2127             PERFORM 9400-CLEAR.
  2128
  2129     IF (PI-PREV-AID  IS EQUAL TO  (DFHPF1  OR  DFHENTER)
  2130       AND EIBAID  IS EQUAL TO  DFHPF2)
  2131       OR (PI-PREV-AID  IS EQUAL TO  DFHPF2
  2132       AND EIBAID  IS EQUAL TO  (DFHPF1  OR  DFHENTER))
  2133         PERFORM 4000-BROWSE-CERT-FILE
  2134     ELSE
  2135         PERFORM 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6592.cbl
  2137 4000-BROWSE-CERT-FILE  SECTION.
  2138
  2139* EXEC CICS HANDLE CONDITION
  2140*        NOTFND  (8700-NOT-FOUND)
  2141*    END-EXEC.
  2142*    MOVE '"$I                   ! # #00002038' TO DFHEIV0
  2143     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2144     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2145     MOVE X'2320233030303032303338' TO DFHEIV0(25:11)
  2146     CALL 'kxdfhei1' USING DFHEIV0
  2147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2148
  2149
  2150     MOVE LOW-VALUES             TO  EL659BO.
  2151
  2152     IF PI-BROWSE-SW  IS EQUAL TO  ZERO
  2153       AND PI-START-SW  IS EQUAL TO  +1
  2154
  2155* EXEC CICS STARTBR
  2156*            DATASET    (PI-DSID)
  2157*            RIDFLD     (PI-NAME-LOOKUP-KEY)
  2158*            GENERIC
  2159*            EQUAL
  2160*            KEYLENGTH  (PI-KEY-LENGTH)
  2161*        END-EXEC
  2162     MOVE 0
  2163       TO DFHEIV11
  2164*    MOVE '&,   KG    E          &   #00002046' TO DFHEIV0
  2165     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
  2166     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2167     MOVE X'2020233030303032303436' TO DFHEIV0(25:11)
  2168     CALL 'kxdfhei1' USING DFHEIV0,
  2169           PI-DSID,
  2170           PI-NAME-LOOKUP-KEY,
  2171           PI-KEY-LENGTH,
  2172           DFHEIV11,
  2173           DFHEIV99
  2174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2175         GO TO 4005-NEXT-SENTENCE.
  2176
  2177     IF EIBAID  IS EQUAL TO  DFHPF2
  2178         SUBTRACT 2              FROM  PI-SCREEN-COUNT
  2179         PERFORM 7000-PF2-POSITION
  2180         GO TO 4005-NEXT-SENTENCE.
  2181
  2182
  2183* EXEC CICS STARTBR
  2184*        DATASET  (PI-DSID)
  2185*        RIDFLD   (PI-NAME-LOOKUP-KEY)
  2186*        EQUAL
  2187*    END-EXEC.
  2188     MOVE 0
  2189       TO DFHEIV11
  2190*    MOVE '&,         E          &   #00002060' TO DFHEIV0
  2191     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
  2192     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2193     MOVE X'2020233030303032303630' TO DFHEIV0(25:11)
  2194     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6592.cbl
  2195           PI-DSID,
  2196           PI-NAME-LOOKUP-KEY,
  2197           DFHEIV99,
  2198           DFHEIV11,
  2199           DFHEIV99
  2200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2201
  2202
  2203 4005-NEXT-SENTENCE.
  2204     MOVE +1                     TO  PI-BROWSE-SW.
  2205     MOVE ZERO                   TO  PI-LINE-COUNT.
  2206     MOVE LOW-VALUES             TO  EL659BO.
  2207     MOVE PI-NAME-LOOKUP-KEY     TO  WS-KEY-HOLD.
  2208     SET EL659B-INDEX            TO  +1.
  2209
  2210 4010-READNEXT.
  2211     MOVE PI-NAME-LOOKUP-KEY     TO  PI-PREV-NAME-LOOKUP-KEY.
  2212
  2213
  2214* EXEC CICS READNEXT
  2215*        DATASET  (PI-DSID)
  2216*        RIDFLD   (PI-NAME-LOOKUP-KEY)
  2217*        SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  2218*    END-EXEC.
  2219     MOVE 0
  2220       TO DFHEIV11
  2221*    MOVE '&.S                   )   #00002076' TO DFHEIV0
  2222     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2223     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2224     MOVE X'2020233030303032303736' TO DFHEIV0(25:11)
  2225     CALL 'kxdfhei1' USING DFHEIV0,
  2226           PI-DSID,
  2227           DFHEIV20,
  2228           DFHEIV99,
  2229           PI-NAME-LOOKUP-KEY,
  2230           DFHEIV99,
  2231           DFHEIV11,
  2232           DFHEIV99,
  2233           DFHEIV99
  2234     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  2235         DFHEIV20
  2236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2237
  2238
  2239 4015-DUPKEY.
  2240     IF NL-COMPANY-CD GREATER PI-COMPANY-CD
  2241         GO TO 4600-ENDFILE.
  2242
  2243     IF PI-ST NOT = SPACES
  2244       IF PI-ST = NL-ST
  2245           NEXT SENTENCE
  2246         ELSE
  2247           GO TO 4010-READNEXT.
  2248
  2249     IF PI-CITY = SPACES
  2250         GO TO 4017-CONTINUE.
  2251
  2252     MOVE PI-CITY                TO WS-PI-CITY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6592.cbl
  2253     MOVE NL-CITY                TO WS-NL-CITY.
  2254
  2255     MOVE SPACE                  TO WS-COMPARE-INDICATOR.
  2256     PERFORM 4099-CHECK-CITY THRU 4099-EXIT
  2257         VARYING WS-CITY-INDEX FROM PI-CITY-LENGTH BY -1
  2258             UNTIL WS-CITY-INDEX = ZERO.
  2259
  2260     IF CITY-NOT-FOUND
  2261         GO TO 4010-READNEXT.
  2262
  2263 4017-CONTINUE.
  2264     IF OPTION-ONE-SELECTED
  2265         GO TO 4018-CONTINUE.
  2266
  2267     IF OPTION-TWO-SELECTED
  2268         IF NL-RECORD-TYPE  IS EQUAL TO  PI-SC-RECORD-TYPE
  2269             GO TO 4018-CONTINUE
  2270         ELSE
  2271             GO TO 4010-READNEXT.
  2272
  2273     IF OPTION-THREE-SELECTED
  2274         IF NL-RECORD-TYPE  IS EQUAL TO  PI-SC-RECORD-TYPE
  2275             GO TO 4021-CONTINUE
  2276         ELSE
  2277             GO TO 4010-READNEXT.
  2278
  2279 4018-CONTINUE.
  2280     MOVE PI-NAME-LOOKUP-KEY     TO  WS-KEY-INPUT.
  2281
  2282     SET KEY-INDEX
  2283         KEY-INDEX2              TO  +1.
  2284
  2285 4020-COMPARE-KEY.
  2286     IF WS-KH-CHAR (KEY-INDEX)
  2287         IS NOT EQUAL TO  WS-KI-CHAR (KEY-INDEX2)
  2288             GO TO 4700-END-OF-BROWSE.
  2289
  2290     IF KEY-INDEX  IS LESS THAN  PI-KEY-LENGTH
  2291         SET KEY-INDEX
  2292             KEY-INDEX2  UP  BY  +1
  2293         GO TO 4020-COMPARE-KEY.
  2294
  2295******************************************************************
  2296*        SECURITY CHECK FOR CARRIER AND ACCOUNT NUMBER           *
  2297*                        04/04/84                                *
  2298******************************************************************
  2299
  2300******************************************************************
  2301*    IF THE SECURITY CHECK ROUTINE IS CHANGED HERE, YOU MUST     *
  2302*        ALSO CHANGE THE SECURITY CHECK ROUTINE IN               *
  2303*        7100-READNEXT-PF2.                                      *
  2304******************************************************************
  2305
  2306 4021-CONTINUE.
  2307     IF NL-RECORD-TYPE  IS EQUAL TO  'R'
  2308         GO TO 4090-MOVE-DATA.
  2309
  2310     IF PI-NO-CARRIER-SECURITY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6592.cbl
  2311       AND PI-NO-ACCOUNT-SECURITY
  2312         GO TO 4090-MOVE-DATA.
  2313
  2314     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  2315         NEXT SENTENCE
  2316     ELSE
  2317         GO TO 4022-CONTINUE.
  2318
  2319     IF NL-RECORD-TYPE  IS EQUAL TO  'A'
  2320         IF NL-AM-CARRIER  IS EQUAL TO  PI-CARRIER-SECURITY
  2321             GO TO 4022-CONTINUE
  2322         ELSE
  2323             GO TO 4010-READNEXT.
  2324
  2325     IF NL-CO-CARRIER  IS EQUAL TO  PI-CARRIER-SECURITY
  2326         NEXT SENTENCE
  2327     ELSE
  2328         GO TO 4010-READNEXT.
  2329
  2330 4022-CONTINUE.
  2331     IF PI-ACCOUNT-SECURITY  IS GREATER THAN  SPACES
  2332         NEXT SENTENCE
  2333     ELSE
  2334         GO TO 4090-MOVE-DATA.
  2335
  2336     IF NL-RECORD-TYPE  IS EQUAL TO  'A'
  2337         IF NL-AM-ACCOUNT  IS EQUAL TO  PI-ACCOUNT-SECURITY
  2338             GO TO 4090-MOVE-DATA
  2339         ELSE
  2340             GO TO 4010-READNEXT.
  2341
  2342     IF NL-CO-ACCOUNT  IS EQUAL TO  PI-ACCOUNT-SECURITY
  2343         NEXT SENTENCE
  2344     ELSE
  2345         GO TO 4010-READNEXT.
  2346
  2347 4090-MOVE-DATA.
  2348     MOVE LOW-VALUES             TO  ACCOUNT-KEY-LINE
  2349
  2350     IF LCP-ONCTR-01 =  0
  2351         ADD 1 TO LCP-ONCTR-01
  2352         MOVE +1                 TO  WS-NAME-SW
  2353         MOVE PI-NAME-LOOKUP-KEY TO  PI-LIN1-NAME-LOOKUP-KEY.
  2354
  2355     ADD +1                      TO  PI-LINE-COUNT.
  2356
  2357     IF EL659B-INDEX  IS EQUAL TO  1
  2358         MOVE NL-RECORD-KEY      TO  PI-START-NAME-LOOKUP-KEY.
  2359
  2360     MOVE NL-RECORD-KEY          TO  PI-END-NAME-LOOKUP-KEY.
  2361     MOVE NL-RECORD-TYPE         TO  EL659B-TYPE (EL659B-INDEX).
  2362     MOVE NL-NAME                TO  EL659B-NAME (EL659B-INDEX).
  2363     MOVE NL-CITY                TO  EL659B-CITY (EL659B-INDEX).
  2364     MOVE NL-ST                  TO  EL659B-ST   (EL659B-INDEX).
  2365
  2366     IF NL-RECORD-TYPE  IS EQUAL TO  'C'
  2367         GO TO 4100-MOVE-COMP.
  2368
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6592.cbl
  2369     IF NL-RECORD-TYPE  IS EQUAL TO  'R'
  2370         GO TO 4110-MOVE-REIN.
  2371
  2372     MOVE SPACES                 TO  ACCOUNT-KEY-LINE.
  2373     MOVE 'CARR '                TO  AKL-FILL-1.
  2374     MOVE NL-AM-CARRIER          TO  AKL-CARRIER.
  2375     MOVE ' GROUP '              TO  AKL-FILL-2.
  2376     MOVE NL-AM-GROUPING         TO  AKL-GROUPING.
  2377     MOVE ' STATE '              TO  AKL-FILL-3.
  2378     MOVE NL-AM-STATE            TO  AKL-STATE.
  2379     MOVE ' ACCOUNT '            TO  AKL-FILL-4.
  2380     MOVE NL-AM-ACCOUNT          TO  AKL-ACCOUNT.
  2381     MOVE ACCOUNT-KEY-LINE       TO  EL659B-KEY (EL659B-INDEX).
  2382
  2383     GO TO 4200-CONTINUE.
  2384
  2385 4099-CHECK-CITY.
  2386     IF WS-NL-CITY-CHAR (WS-CITY-INDEX) NOT =
  2387        WS-PI-CITY-CHAR (WS-CITY-INDEX)
  2388          MOVE 'X'               TO WS-COMPARE-INDICATOR.
  2389
  2390 4099-EXIT.
  2391      EXIT.
  2392
  2393 4100-MOVE-COMP.
  2394     MOVE LOW-VALUES             TO  COMPENSATION-KEY-LINE
  2395
  2396     MOVE 'CARR '                TO  CKL-FILL-1.
  2397     MOVE NL-CO-CARRIER          TO  CKL-CARRIER.
  2398     MOVE ' GROUP '              TO  CKL-FILL-2.
  2399
  2400     IF NL-CO-GROUPING IS EQUAL TO LOW-VALUES
  2401         MOVE SPACES             TO  CKL-GROUPING
  2402     ELSE
  2403         MOVE NL-CO-GROUPING     TO  CKL-GROUPING.
  2404
  2405     MOVE ' FIN RESP '           TO  CKL-FILL-3.
  2406
  2407     IF NL-CO-RESP-NO  IS EQUAL TO  LOW-VALUES
  2408         MOVE SPACES             TO  CKL-RESP
  2409     ELSE
  2410         MOVE NL-CO-RESP-NO      TO  CKL-RESP.
  2411
  2412     MOVE ' ACCOUNT '            TO  CKL-FILL-4.
  2413
  2414     IF NL-CO-ACCOUNT  IS EQUAL TO  LOW-VALUES
  2415         MOVE SPACES             TO  CKL-ACCOUNT
  2416     ELSE
  2417         MOVE NL-CO-ACCOUNT      TO  CKL-ACCOUNT.
  2418
  2419     MOVE ' TYPE '               TO  CKL-FILL-5.
  2420     MOVE NL-CO-TYPE             TO  CKL-TYPE.
  2421     MOVE COMPENSATION-KEY-LINE  TO  EL659B-KEY (EL659B-INDEX).
  2422
  2423     GO TO 4200-CONTINUE.
  2424
  2425 4110-MOVE-REIN.
  2426     MOVE LOW-VALUES             TO  REINSURANCE-KEY-LINE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6592.cbl
  2427
  2428     IF NL-RE-LEVEL (12)  IS NOT EQUAL TO  SPACES
  2429         MOVE '*'                TO  EL659B-AST (EL659B-INDEX).
  2430
  2431     MOVE 'TABLE '               TO  RKL-FILL-1.
  2432     MOVE NL-RE-TABLE            TO  RKL-REIN-TABLE.
  2433     MOVE ' COMP '               TO  RKL-FILL-2.
  2434     MOVE NL-RE-COMP             TO  RKL-REIN-COMP.
  2435     MOVE ' SUB '                TO  RKL-FILL-3.
  2436     MOVE NL-RE-CO-SUB           TO  RKL-REIN-COMP-SUB.
  2437     MOVE ' ON LEVEL'            TO  RKL-FILL-4.
  2438
  2439     IF NL-RE-LEVEL (1)  IS NUMERIC
  2440         IF NL-RE-LEVEL (1)  IS GREATER THAN  ZERO
  2441             MOVE ' '            TO  RKL-FILL-5 (1)
  2442             MOVE NL-RE-LEVEL (1)
  2443                                 TO  RKL-LEVEL (1).
  2444
  2445     IF NL-RE-LEVEL (2)  IS NUMERIC
  2446         IF NL-RE-LEVEL (2)  IS GREATER THAN  ZERO
  2447             MOVE ' '            TO  RKL-FILL-5 (2)
  2448             MOVE NL-RE-LEVEL (2)
  2449                                 TO  RKL-LEVEL (2).
  2450
  2451     IF NL-RE-LEVEL (3)  IS NUMERIC
  2452         IF NL-RE-LEVEL (3)  IS GREATER THAN  ZERO
  2453             MOVE ' '            TO  RKL-FILL-5 (3)
  2454             MOVE NL-RE-LEVEL (3)
  2455                                 TO  RKL-LEVEL (3).
  2456
  2457     IF NL-RE-LEVEL (4)  IS NUMERIC
  2458         IF NL-RE-LEVEL (4)  IS GREATER THAN  ZERO
  2459             MOVE ' '            TO  RKL-FILL-5 (4)
  2460             MOVE NL-RE-LEVEL (4)
  2461                                 TO  RKL-LEVEL (4).
  2462
  2463     IF NL-RE-LEVEL (5)  IS NUMERIC
  2464         IF NL-RE-LEVEL (5)  IS GREATER THAN  ZERO
  2465             MOVE ' '            TO  RKL-FILL-5 (5)
  2466             MOVE NL-RE-LEVEL (5)
  2467                                 TO  RKL-LEVEL (5).
  2468
  2469     IF NL-RE-LEVEL (6)  IS NUMERIC
  2470         IF NL-RE-LEVEL (6)  IS GREATER THAN  ZERO
  2471             MOVE ' '            TO  RKL-FILL-5 (6)
  2472             MOVE NL-RE-LEVEL (6)
  2473                                 TO  RKL-LEVEL (6).
  2474
  2475     IF NL-RE-LEVEL (7)  IS NUMERIC
  2476         IF NL-RE-LEVEL (7)  IS GREATER THAN  ZERO
  2477             MOVE ' '            TO  RKL-FILL-5 (7)
  2478             MOVE NL-RE-LEVEL (7)
  2479                                 TO  RKL-LEVEL (7).
  2480
  2481     IF NL-RE-LEVEL (8)  IS NUMERIC
  2482         IF NL-RE-LEVEL (8)  IS GREATER THAN  ZERO
  2483             MOVE ' '            TO  RKL-FILL-5 (8)
  2484             MOVE NL-RE-LEVEL (8)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6592.cbl
  2485                                 TO  RKL-LEVEL (8).
  2486
  2487     IF NL-RE-LEVEL (9)  IS NUMERIC
  2488         IF NL-RE-LEVEL (9)  IS GREATER THAN  ZERO
  2489             MOVE ' '            TO  RKL-FILL-5 (9)
  2490             MOVE NL-RE-LEVEL (9)
  2491                                 TO  RKL-LEVEL (9).
  2492
  2493     IF NL-RE-LEVEL (10)  IS NUMERIC
  2494         IF NL-RE-LEVEL (10)  IS GREATER THAN  ZERO
  2495             MOVE ' '            TO  RKL-FILL-5 (10)
  2496             MOVE NL-RE-LEVEL (10)
  2497                                 TO  RKL-LEVEL (10).
  2498
  2499     IF NL-RE-LEVEL (11)  IS NUMERIC
  2500         IF NL-RE-LEVEL (11)  IS GREATER THAN  ZERO
  2501             MOVE ' '            TO  RKL-FILL-5 (11)
  2502             MOVE NL-RE-LEVEL (11)
  2503                                 TO  RKL-LEVEL (11).
  2504
  2505     MOVE REINSURANCE-KEY-LINE   TO  EL659B-KEY (EL659B-INDEX).
  2506
  2507 4200-CONTINUE.
  2508     PERFORM 6000-SET-ATTRB  THRU  6000-EXIT.
  2509
  2510     IF EL659B-INDEX  IS LESS THAN  +8
  2511         SET EL659B-INDEX  UP  BY  +1
  2512         GO TO 4010-READNEXT.
  2513
  2514     GO TO 4900-ENDBROWSE.
  2515
  2516 4600-ENDFILE.
  2517     MOVE ER-0130                TO  EMI-ERROR.
  2518
  2519 4700-END-OF-BROWSE.
  2520     ADD +1                      TO  PI-END-OF-FILE.
  2521
  2522 4900-ENDBROWSE.
  2523     ADD 1                       TO  PI-SCREEN-COUNT.
  2524
  2525
  2526* EXEC CICS ENDBR
  2527*        DATASET  (PI-DSID)
  2528*    END-EXEC.
  2529     MOVE 0
  2530       TO DFHEIV11
  2531*    MOVE '&2                    $   #00002368' TO DFHEIV0
  2532     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2533     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2534     MOVE X'2020233030303032333638' TO DFHEIV0(25:11)
  2535     CALL 'kxdfhei1' USING DFHEIV0,
  2536           PI-DSID,
  2537           DFHEIV11,
  2538           DFHEIV99
  2539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2540
  2541
  2542 4910-SEND-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6592.cbl
  2543     IF WS-NO-NAME-FOUND
  2544         MOVE +9                 TO  PI-BROWSE-SW
  2545         PERFORM 9400-CLEAR.
  2546
  2547     MOVE -1                     TO  BSELL.
  2548
  2549     PERFORM 8100-SEND-INITIAL-MAP.
  2550
  2551     GO TO 9100-RETURN-TRAN.
  2552
  2553 4990-EXIT.
  2554     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL6592.cbl
  2556 6000-SET-ATTRB  SECTION.
  2557     MOVE AL-SABON           TO  EL659B-TYPE-ATTR (EL659B-INDEX)
  2558                                 EL659B-NAME-ATTR (EL659B-INDEX)
  2559                                 EL659B-CITY-ATTR (EL659B-INDEX)
  2560                                 EL659B-ST-ATTR   (EL659B-INDEX)
  2561                                 EL659B-AST-ATTR  (EL659B-INDEX).
  2562     MOVE AL-SANON           TO  EL659B-KEY-ATTR  (EL659B-INDEX).
  2563
  2564     MOVE AL-UNNON               TO  BSELA.
  2565
  2566 6000-EXIT.
  2567     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL6592.cbl
  2569 7000-PF2-POSITION  SECTION.
  2570
  2571* EXEC CICS IGNORE CONDITION
  2572*        DUPKEY
  2573*    END-EXEC.
  2574*    MOVE '"*$                   !   #00002400' TO DFHEIV0
  2575     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
  2576     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2577     MOVE X'2020233030303032343030' TO DFHEIV0(25:11)
  2578     CALL 'kxdfhei1' USING DFHEIV0
  2579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2580
  2581
  2582
  2583* EXEC CICS HANDLE CONDITION
  2584*        NOTFND  (8700-NOT-FOUND)
  2585*    END-EXEC.
  2586*    MOVE '"$I                   ! $ #00002404' TO DFHEIV0
  2587     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2589     MOVE X'2420233030303032343034' TO DFHEIV0(25:11)
  2590     CALL 'kxdfhei1' USING DFHEIV0
  2591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2592
  2593
  2594     COMPUTE WS-CALC-RDNXT  =  PI-SCREEN-COUNT  *  7.
  2595
  2596     MOVE PI-1ST-KEY             TO  PI-NAME-LOOKUP-KEY.
  2597     MOVE ZERO                   TO  PI-END-OF-FILE.
  2598
  2599
  2600* EXEC CICS STARTBR
  2601*        DATASET    (PI-DSID)
  2602*        RIDFLD     (PI-NAME-LOOKUP-KEY)
  2603*        GENERIC
  2604*        EQUAL
  2605*        KEYLENGTH  (PI-KEY-LENGTH)
  2606*    END-EXEC.
  2607     MOVE 0
  2608       TO DFHEIV11
  2609*    MOVE '&,   KG    E          &   #00002413' TO DFHEIV0
  2610     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
  2611     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2612     MOVE X'2020233030303032343133' TO DFHEIV0(25:11)
  2613     CALL 'kxdfhei1' USING DFHEIV0,
  2614           PI-DSID,
  2615           PI-NAME-LOOKUP-KEY,
  2616           PI-KEY-LENGTH,
  2617           DFHEIV11,
  2618           DFHEIV99
  2619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2620
  2621
  2622 7100-READNEXT-PF2.
  2623     IF WS-CALC-RDNXT  IS GREATER THAN  ZERO
  2624         NEXT SENTENCE
  2625     ELSE
  2626         GO TO 7999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL6592.cbl
  2627
  2628
  2629* EXEC CICS READNEXT
  2630*        DATASET  (PI-DSID)
  2631*        RIDFLD   (PI-NAME-LOOKUP-KEY)
  2632*        SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  2633*    END-EXEC.
  2634     MOVE 0
  2635       TO DFHEIV11
  2636*    MOVE '&.S                   )   #00002427' TO DFHEIV0
  2637     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2638     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2639     MOVE X'2020233030303032343237' TO DFHEIV0(25:11)
  2640     CALL 'kxdfhei1' USING DFHEIV0,
  2641           PI-DSID,
  2642           DFHEIV20,
  2643           DFHEIV99,
  2644           PI-NAME-LOOKUP-KEY,
  2645           DFHEIV99,
  2646           DFHEIV11,
  2647           DFHEIV99,
  2648           DFHEIV99
  2649     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  2650         DFHEIV20
  2651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2652
  2653
  2654******************************************************************
  2655*    IF THE SECURITY CHECKING ROUTINE, INITIAL COMPARE ROUTINE   *
  2656*        OR THE ACCOUNT COMPARE ROUTINE IS CHANGED HERE, YOU     *
  2657*        MUST ALSO CHANGE THE CORRESPONDING ROUTINE IN           *
  2658*        PARAGRAPH 4020-COMPARE-KEY OR 4030-CHECK-OPTION.        *
  2659******************************************************************
  2660
  2661     IF NL-COMPANY-CD  IS EQUAL TO  PI-COMPANY-CD
  2662         NEXT SENTENCE
  2663     ELSE
  2664         GO TO 7100-READNEXT-PF2.
  2665
  2666     IF OPTION-ONE-SELECTED
  2667         GO TO 7110-CHECK-SECURITY.
  2668
  2669     IF OPTION-TWO-SELECTED OR
  2670        OPTION-THREE-SELECTED
  2671         IF NL-RECORD-TYPE  IS EQUAL TO  PI-SC-RECORD-TYPE
  2672             GO TO 7110-CHECK-SECURITY
  2673         ELSE
  2674             GO TO 7100-READNEXT-PF2.
  2675
  2676 7110-CHECK-SECURITY.
  2677     IF NL-RECORD-TYPE  IS EQUAL TO  'R'
  2678         GO TO 7190-COMPUTE.
  2679
  2680     IF PI-NO-CARRIER-SECURITY
  2681       AND PI-NO-ACCOUNT-SECURITY
  2682         GO TO 7190-COMPUTE.
  2683
  2684     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL6592.cbl
  2685         NEXT SENTENCE
  2686     ELSE
  2687         GO TO 7120-CONTINUE.
  2688
  2689     IF NL-RECORD-TYPE  IS EQUAL TO  'A'
  2690         IF NL-AM-CARRIER  IS EQUAL TO  PI-CARRIER-SECURITY
  2691             GO TO 7120-CONTINUE
  2692         ELSE
  2693             GO TO 7100-READNEXT-PF2.
  2694
  2695     IF NL-CO-CARRIER  IS EQUAL TO  PI-CARRIER-SECURITY
  2696         NEXT SENTENCE
  2697     ELSE
  2698         GO TO 7100-READNEXT-PF2.
  2699
  2700 7120-CONTINUE.
  2701     IF PI-ACCOUNT-SECURITY  IS GREATER THAN  SPACES
  2702         NEXT SENTENCE
  2703     ELSE
  2704         GO TO 7190-COMPUTE.
  2705
  2706     IF NL-RECORD-TYPE  IS EQUAL TO  'A'
  2707         IF NL-AM-ACCOUNT  IS EQUAL TO  PI-ACCOUNT-SECURITY
  2708             GO TO 7190-COMPUTE
  2709         ELSE
  2710             GO TO 7100-READNEXT-PF2.
  2711
  2712     IF NL-CO-ACCOUNT  IS EQUAL TO  PI-ACCOUNT-SECURITY
  2713         NEXT SENTENCE
  2714     ELSE
  2715         GO TO 7100-READNEXT-PF2.
  2716
  2717 7190-COMPUTE.
  2718     COMPUTE WS-CALC-RDNXT  =  WS-CALC-RDNXT  -  1.
  2719
  2720     GO TO 7100-READNEXT-PF2.
  2721
  2722 7999-EXIT.
  2723     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL6592.cbl
  2725 8100-SEND-INITIAL-MAP  SECTION.
  2726     MOVE SAVE-DATE              TO  BDATEO.
  2727     MOVE EIBTIME                TO  TIME-IN.
  2728     MOVE TIME-OUT               TO  BTIMEO.
  2729     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  2730     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  2731
  2732     IF EMI-ERROR  IS NOT EQUAL TO  ZERO
  2733         PERFORM 9900-ERROR-FORMAT.
  2734
  2735     MOVE EMI-MESSAGE-AREA (1)   TO  BEMSG1O.
  2736
  2737
  2738* EXEC CICS SEND
  2739*        FROM    (EL659BO)
  2740*        MAPSET  (WS-MAPSET-NAME)
  2741*        MAP     (WS-MAP-NAME)
  2742*        CURSOR
  2743*        ERASE
  2744*    END-EXEC.
  2745     MOVE LENGTH OF
  2746      EL659BO
  2747       TO DFHEIV12
  2748     MOVE -1
  2749       TO DFHEIV11
  2750*    MOVE '8$     CT  E    H L F ,   #00002516' TO DFHEIV0
  2751     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2752     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2753     MOVE X'2020233030303032353136' TO DFHEIV0(25:11)
  2754     CALL 'kxdfhei1' USING DFHEIV0,
  2755           WS-MAP-NAME,
  2756           EL659BO,
  2757           DFHEIV12,
  2758           WS-MAPSET-NAME,
  2759           DFHEIV99,
  2760           DFHEIV99,
  2761           DFHEIV99,
  2762           DFHEIV11,
  2763           DFHEIV99,
  2764           DFHEIV99,
  2765           DFHEIV99
  2766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2767
  2768
  2769 8100-EXIT.
  2770     EXIT.
  2771
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL6592.cbl
  2773 8200-SEND-DATAONLY  SECTION.
  2774     MOVE SAVE-DATE              TO  BDATEO.
  2775     MOVE EIBTIME                TO  TIME-IN.
  2776     MOVE TIME-OUT               TO  BTIMEO.
  2777     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  2778     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  2779
  2780     IF EMI-ERROR  IS NOT EQUAL TO  ZERO
  2781         PERFORM 9900-ERROR-FORMAT.
  2782
  2783     MOVE EMI-MESSAGE-AREA (1)   TO  BEMSG1O.
  2784
  2785
  2786* EXEC CICS SEND DATAONLY
  2787*        FROM    (EL659BO)
  2788*        MAPSET  (WS-MAPSET-NAME)
  2789*        MAP     (WS-MAP-NAME)
  2790*        CURSOR
  2791*    END-EXEC.
  2792     MOVE LENGTH OF
  2793      EL659BO
  2794       TO DFHEIV12
  2795     MOVE -1
  2796       TO DFHEIV11
  2797*    MOVE '8$D    CT       H L F ,   #00002540' TO DFHEIV0
  2798     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2799     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2800     MOVE X'2020233030303032353430' TO DFHEIV0(25:11)
  2801     CALL 'kxdfhei1' USING DFHEIV0,
  2802           WS-MAP-NAME,
  2803           EL659BO,
  2804           DFHEIV12,
  2805           WS-MAPSET-NAME,
  2806           DFHEIV99,
  2807           DFHEIV99,
  2808           DFHEIV99,
  2809           DFHEIV11,
  2810           DFHEIV99,
  2811           DFHEIV99,
  2812           DFHEIV99
  2813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2814
  2815
  2816 8200-EXIT.
  2817     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL6592.cbl
  2819 8300-SEND-TEXT  SECTION.
  2820
  2821* EXEC CICS SEND TEXT
  2822*        FROM    (LOGOFF-TEXT)
  2823*        LENGTH  (LOGOFF-LENGTH)
  2824*        ERASE
  2825*        FREEKB
  2826*    END-EXEC.
  2827*    MOVE '8&      T  E F  H   F -   #00002551' TO DFHEIV0
  2828     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2829     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2830     MOVE X'2020233030303032353531' TO DFHEIV0(25:11)
  2831     CALL 'kxdfhei1' USING DFHEIV0,
  2832           LOGOFF-TEXT,
  2833           LOGOFF-LENGTH,
  2834           DFHEIV99,
  2835           DFHEIV99,
  2836           DFHEIV99,
  2837           DFHEIV99,
  2838           DFHEIV99,
  2839           DFHEIV99,
  2840           DFHEIV99,
  2841           DFHEIV99,
  2842           DFHEIV99,
  2843           DFHEIV99
  2844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2845
  2846
  2847
  2848* EXEC CICS RETURN
  2849*    END-EXEC.
  2850*    MOVE '.(                    &   #00002558' TO DFHEIV0
  2851     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2852     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2853     MOVE X'2020233030303032353538' TO DFHEIV0(25:11)
  2854     CALL 'kxdfhei1' USING DFHEIV0,
  2855           DFHEIV99,
  2856           DFHEIV99,
  2857           DFHEIV99,
  2858           DFHEIV99,
  2859           DFHEIV99
  2860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2861
  2862
  2863 8300-EXIT.
  2864     EXIT.
  2865
  2866 8500-DATE-CONVERSION  SECTION.
  2867
  2868* EXEC CICS LINK
  2869*        PROGRAM   ('ELDATCV')
  2870*        COMMAREA  (DATE-CONVERSION-DATA)
  2871*        LENGTH    (DC-COMM-LENGTH)
  2872*    END-EXEC.
  2873     MOVE 'ELDATCV' TO DFHEIV1
  2874*    MOVE '."C                   ''   #00002565' TO DFHEIV0
  2875     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2876     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL6592.cbl
  2877     MOVE X'2020233030303032353635' TO DFHEIV0(25:11)
  2878     CALL 'kxdfhei1' USING DFHEIV0,
  2879           DFHEIV1,
  2880           DATE-CONVERSION-DATA,
  2881           DC-COMM-LENGTH,
  2882           DFHEIV99,
  2883           DFHEIV99,
  2884           DFHEIV99
  2885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2886
  2887
  2888 8500-EXIT.
  2889     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL6592.cbl
  2891 8650-WRITE-SECURITY-TEMP-STORE  SECTION.
  2892
  2893* EXEC CICS HANDLE CONDITION
  2894*        QIDERR  (8651-WRITE-SECURITY)
  2895*    END-EXEC.
  2896*    MOVE '"$N                   ! % #00002575' TO DFHEIV0
  2897     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  2898     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2899     MOVE X'2520233030303032353735' TO DFHEIV0(25:11)
  2900     CALL 'kxdfhei1' USING DFHEIV0
  2901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2902
  2903
  2904     MOVE EIBTRMID               TO  QID.
  2905
  2906 8651-WRITE-SECURITY.
  2907
  2908* EXEC CICS WRITEQ TS
  2909*        QUEUE   (QID)
  2910*        FROM    (SECURITY-CONTROL)
  2911*        LENGTH  (SC-COMM-LENGTH)
  2912*        ITEM    (QID-ITEM)
  2913*    END-EXEC.
  2914*    MOVE '*" I                  ''   #00002582' TO DFHEIV0
  2915     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  2916     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2917     MOVE X'2020233030303032353832' TO DFHEIV0(25:11)
  2918     CALL 'kxdfhei1' USING DFHEIV0,
  2919           QID,
  2920           SECURITY-CONTROL,
  2921           SC-COMM-LENGTH,
  2922           QID-ITEM,
  2923           DFHEIV99,
  2924           DFHEIV99
  2925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2926
  2927
  2928     MOVE QID                    TO  PI-SECURITY-TEMP-STORE-ID.
  2929
  2930     IF PI-PROCESSOR-ID  IS EQUAL TO  'LGXX'
  2931         MOVE ALL 'Y'            TO  SC-CREDIT-CODES
  2932                                     SC-CLAIMS-CODES
  2933                                     PI-PROCESSOR-USER-ALMIGHTY.
  2934
  2935 8650-EXIT.
  2936     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL6592.cbl
  2938 8700-NOT-FOUND  SECTION.
  2939     PERFORM 8800-INITIALIZE-MAP
  2940         VARYING  EL659B-INDEX  FROM  +1  BY  +1
  2941             UNTIL  EL659B-INDEX  IS GREATER THAN  +8.
  2942
  2943     MOVE -1                     TO  BSELL.
  2944     MOVE ER-0673                TO  EMI-ERROR.
  2945
  2946     PERFORM 8100-SEND-INITIAL-MAP.
  2947
  2948     GO TO 9100-RETURN-TRAN.
  2949
  2950 8700-EXIT.
  2951     EXIT.
  2952
  2953 8800-INITIALIZE-MAP  SECTION.
  2954     MOVE LOW-VALUES         TO  EL659B-MAP-LINE (EL659B-INDEX).
  2955
  2956 8800-EXIT.
  2957     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL6592.cbl
  2959 9000-RETURN-CICS  SECTION.
  2960     MOVE 'EL005'                TO  THIS-PGM.
  2961     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  2962
  2963     GO TO 9300-XCTL.
  2964
  2965 9000-EXIT.
  2966     EXIT.
  2967
  2968 9100-RETURN-TRAN  SECTION.
  2969     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  2970     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  2971     MOVE EIBAID                 TO  PI-PREV-AID.
  2972
  2973
  2974* EXEC CICS RETURN
  2975*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  2976*        LENGTH    (PI-COMM-LENGTH)
  2977*        TRANSID   (WS-TRANS-ID)
  2978*    END-EXEC.
  2979*    MOVE '.(CT                  &   #00002634' TO DFHEIV0
  2980     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2981     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2982     MOVE X'2020233030303032363334' TO DFHEIV0(25:11)
  2983     CALL 'kxdfhei1' USING DFHEIV0,
  2984           WS-TRANS-ID,
  2985           PROGRAM-INTERFACE-BLOCK,
  2986           PI-COMM-LENGTH,
  2987           DFHEIV99,
  2988           DFHEIV99
  2989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2990
  2991
  2992 9100-EXIT.
  2993     EXIT.
  2994
  2995 9300-XCTL  SECTION.
  2996     MOVE DFHENTER               TO  EIBAID.
  2997
  2998
  2999* EXEC CICS XCTL
  3000*        PROGRAM   (THIS-PGM)
  3001*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  3002*        LENGTH    (PI-COMM-LENGTH)
  3003*    END-EXEC.
  3004*    MOVE '.$C                   $   #00002646' TO DFHEIV0
  3005     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3006     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3007     MOVE X'2020233030303032363436' TO DFHEIV0(25:11)
  3008     CALL 'kxdfhei1' USING DFHEIV0,
  3009           THIS-PGM,
  3010           PROGRAM-INTERFACE-BLOCK,
  3011           PI-COMM-LENGTH
  3012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3013
  3014
  3015 9300-EXIT.
  3016     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL6592.cbl
  3018 9400-CLEAR  SECTION.
  3019     MOVE PI-RETURN-TO-PROGRAM   TO  THIS-PGM.
  3020
  3021     GO TO 9300-XCTL.
  3022
  3023 9400-EXIT.
  3024     EXIT.
  3025
  3026 9600-PGMIDERR  SECTION.
  3027
  3028* EXEC CICS HANDLE CONDITION
  3029*        PGMIDERR  (8300-SEND-TEXT)
  3030*    END-EXEC.
  3031*    MOVE '"$L                   ! & #00002664' TO DFHEIV0
  3032     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3033     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3034     MOVE X'2620233030303032363634' TO DFHEIV0(25:11)
  3035     CALL 'kxdfhei1' USING DFHEIV0
  3036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3037
  3038
  3039     MOVE THIS-PGM               TO  PI-CALLING-PROGRAM
  3040                                     LOGOFF-PGM.
  3041     MOVE 'EL005'                TO  THIS-PGM.
  3042     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  3043     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  3044
  3045     GO TO 9300-XCTL.
  3046
  3047 9600-EXIT.
  3048     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL6592.cbl
  3050 9900-ERROR-FORMAT  SECTION.
  3051     IF EMI-ERRORS-COMPLETE
  3052         GO TO 9900-EXIT.
  3053
  3054
  3055* EXEC CICS LINK
  3056*        PROGRAM   ('EL001')
  3057*        COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  3058*        LENGTH    (EMI-COMM-LENGTH)
  3059*    END-EXEC.
  3060     MOVE 'EL001' TO DFHEIV1
  3061*    MOVE '."C                   ''   #00002683' TO DFHEIV0
  3062     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3063     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3064     MOVE X'2020233030303032363833' TO DFHEIV0(25:11)
  3065     CALL 'kxdfhei1' USING DFHEIV0,
  3066           DFHEIV1,
  3067           ERROR-MESSAGE-INTERFACE-BLOCK,
  3068           EMI-COMM-LENGTH,
  3069           DFHEIV99,
  3070           DFHEIV99,
  3071           DFHEIV99
  3072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3073
  3074
  3075 9900-EXIT.
  3076     EXIT.
  3077
  3078 9990-ERROR  SECTION.
  3079     MOVE DFHEIBLK               TO  EMI-LINE1.
  3080
  3081
  3082* EXEC CICS LINK
  3083*        PROGRAM  ('EL004')
  3084*        COMMAREA (EMI-LINE1)
  3085*        LENGTH   (72)
  3086*    END-EXEC.
  3087     MOVE 'EL004' TO DFHEIV1
  3088     MOVE 72
  3089       TO DFHEIV11
  3090*    MOVE '."C                   ''   #00002695' TO DFHEIV0
  3091     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3092     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3093     MOVE X'2020233030303032363935' TO DFHEIV0(25:11)
  3094     CALL 'kxdfhei1' USING DFHEIV0,
  3095           DFHEIV1,
  3096           EMI-LINE1,
  3097           DFHEIV11,
  3098           DFHEIV99,
  3099           DFHEIV99,
  3100           DFHEIV99
  3101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3102
  3103
  3104     MOVE -1                     TO  BSELL.
  3105
  3106     PERFORM 8100-SEND-INITIAL-MAP.
  3107
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL6592.cbl
  3108     GO TO 9100-RETURN-TRAN.
  3109
  3110 9990-EXIT.
  3111     EXIT.
  3112
  3113 9999-LAST-PARAGRAPH  SECTION.
  3114
  3115* GOBACK.
  3116     MOVE '9%                    "   ' TO DFHEIV0
  3117     MOVE 'EL6592' TO DFHEIV1
  3118     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3119     GOBACK.
  3121
  3122 9999-DFHBACK SECTION.
  3123     MOVE '9%                    "   ' TO DFHEIV0
  3124     MOVE 'EL6592' TO DFHEIV1
  3125     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3126     GOBACK.
  3127 9999-DFHEXIT.
  3128     IF DFHEIGDJ EQUAL 0001
  3129         NEXT SENTENCE
  3130     ELSE IF DFHEIGDJ EQUAL 2
  3131         GO TO 9600-PGMIDERR,
  3132               8700-NOT-FOUND,
  3133               4600-ENDFILE,
  3134               4015-DUPKEY,
  3135               9990-ERROR
  3136         DEPENDING ON DFHEIGDI
  3137     ELSE IF DFHEIGDJ EQUAL 3
  3138         GO TO 8700-NOT-FOUND
  3139         DEPENDING ON DFHEIGDI
  3140     ELSE IF DFHEIGDJ EQUAL 4
  3141         GO TO 8700-NOT-FOUND
  3142         DEPENDING ON DFHEIGDI
  3143     ELSE IF DFHEIGDJ EQUAL 5
  3144         GO TO 8651-WRITE-SECURITY
  3145         DEPENDING ON DFHEIGDI
  3146     ELSE IF DFHEIGDJ EQUAL 6
  3147         GO TO 8300-SEND-TEXT
  3148         DEPENDING ON DFHEIGDI.
  3149     MOVE '9%                    "   ' TO DFHEIV0
  3150     MOVE 'EL6592' TO DFHEIV1
  3151     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3152     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5024     Code:        8168
