* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL642T.cbl
* Options: int("EL642T.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL642T.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL642T.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL642T.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL642 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 01/06/95 10:16:47.
     7*                            VMOD=2.031
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL642T.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXH7 - GENERAL AGENT BILLING
    27*                           (PREPARE AN AGENT STATEMENT).
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    38******************************************************************
    39
    40 ENVIRONMENT DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL642T.cbl
    42 DATA DIVISION.
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45
    46 77  FILLER  PIC X(32)  VALUE '********************************'.
    47 77  FILLER  PIC X(32)  VALUE '*    EL642 WORKING STORAGE     *'.
    48 77  FILLER  PIC X(32)  VALUE '***********VMOD 2.031 **********'.
    49
    50*    COPY ELCSCTM.
    51******************************************************************
    52*                                                                *
    53*                                                                *
    54*                            ELCSCTM                             *
    55*                            VMOD=2.001                          *
    56*                                                                *
    57*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    58*                                                                *
    59******************************************************************
    60 01  SECURITY-MESSAGE.
    61     12  FILLER                          PIC X(30)
    62            VALUE '** LOGIC SECURITY VIOLATION -'.
    63     12  SM-READ                         PIC X(6).
    64     12  FILLER                          PIC X(5)
    65            VALUE ' PGM='.
    66     12  SM-PGM                          PIC X(6).
    67     12  FILLER                          PIC X(5)
    68            VALUE ' OPR='.
    69     12  SM-PROCESSOR-ID                 PIC X(4).
    70     12  FILLER                          PIC X(6)
    71            VALUE ' TERM='.
    72     12  SM-TERMID                       PIC X(4).
    73     12  FILLER                          PIC XX   VALUE SPACE.
    74     12  SM-JUL-DATE                     PIC 9(5).
    75     12  FILLER                          PIC X    VALUE SPACE.
    76     12  SM-TIME                         PIC 99.99.
    77
    78*    COPY ELCSCRTY.
    79******************************************************************
    80*                                                                *
    81*                                                                *
    82*                            ELCSCRTY                            *
    83*                            VMOD=2.001                          *
    84*                                                                *
    85*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    86*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    87*        SAVED IN PI-SECURITY-ADDRESS.                           *
    88*                                                                *
    89******************************************************************
    90 01  SECURITY-CONTROL.
    91     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    92     12  FILLER                       PIC XX    VALUE 'SC'.
    93     12  SC-CREDIT-CODES.
    94         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    95             20  SC-CREDIT-DISPLAY    PIC X.
    96             20  SC-CREDIT-UPDATE     PIC X.
    97     12  SC-CLAIMS-CODES.
    98         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    99             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL642T.cbl
   100             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL642T.cbl
   102 01  STANDARD-AREAS.
   103     12  SC-ITEM             PIC S9(4)   COMP    VALUE +1.
   104
   105     12  W-TRANSFER-CONTROL.
   106         16  WT-CR-CARRIER           PIC X.
   107         16  WT-CR-GROUPING          PIC X(6).
   108         16  WT-CR-STATE             PIC XX.
   109         16  WT-CR-ACCOUNT           PIC X(10).
   110         16  WT-CR-FIN-RESP          PIC X(10).
   111         16  WT-CR-TYPE              PIC X.
   112
   113     12  GETMAIN-SPACE       PIC  X              VALUE SPACE.
   114     12  MAP-NAME            PIC  X(8)           VALUE 'EL642A'.
   115     12  MAPSET-NAME         PIC  X(8)           VALUE 'EL642S'.
   116     12  SCREEN-NUMBER       PIC  X(4)           VALUE '642A'.
   117     12  TRANS-ID            PIC  X(4)           VALUE 'EXH7'.
   118     12  EL633-TRANS-ID      PIC  X(4)           VALUE 'EXB7'.
   119     12  EL633DMD-TRANS-ID   PIC  X(4)           VALUE 'EX1F'.
   120     12  EL635-TRANS-ID      PIC  X(4)           VALUE 'EXJ4'.
   121     12  EL650-TRANS-ID      PIC  X(4)           VALUE 'EXC4'.
   122     12  EL652-TRANS-ID      PIC  X(4)           VALUE 'EXD4'.
   123     12  EL658-TRANS-ID      PIC  X(4)           VALUE 'EXJ3'.
   124     12  THIS-PGM            PIC  X(8)           VALUE 'EL642'.
   125     12  EL642A              PIC  X(8)           VALUE 'EL642A'.
   126     12  EL642B              PIC  X(8)           VALUE 'EL642B'.
   127     12  PGM-NAME            PIC  X(8).
   128     12  TIME-IN             PIC S9(7).
   129     12  TIME-OUT-R  REDEFINES  TIME-IN.
   130         16  FILLER          PIC  X.
   131         16  TIME-OUT        PIC  99V99.
   132         16  FILLER          PIC  XX.
   133     12  XCTL-005            PIC  X(8)           VALUE 'EL005'.
   134     12  XCTL-010            PIC  X(8)           VALUE 'EL010'.
   135     12  XCTL-626            PIC  X(8)           VALUE 'EL626'.
   136     12  XCTL-633            PIC  X(8)           VALUE 'EL633'.
   137     12  XCTL-633DMD         PIC  X(8)           VALUE 'EL633DMD'.
   138     12  XCTL-635            PIC  X(8)           VALUE 'EL635'.
   139     12  XCTL-PYAJ           PIC  X(8)           VALUE 'EL633'.
   140     12  XCTL-650            PIC  X(8)           VALUE 'EL650'.
   141     12  XCTL-652            PIC  X(8)           VALUE 'EL652'.
   142     12  XCTL-6401           PIC  X(8)           VALUE 'EL6401'.
   143     12  XCTL-658            PIC  X(8)           VALUE 'EL658'.
   144     12  LINK-001            PIC  X(8)           VALUE 'EL001'.
   145     12  LINK-004            PIC  X(8)           VALUE 'EL004'.
   146     12  LINK-ELDATCV        PIC  X(8)           VALUE 'ELDATCV'.
   147     12  ERPNDB-ALT-FILE-ID  PIC  X(8)           VALUE 'ERPNDB2'.
   148     12  ERPNDB-FILE-ID      PIC  X(8)           VALUE 'ERPNDB'.
   149     12  ELCNTL-FILE-ID      PIC  X(8)           VALUE 'ELCNTL'.
   150     12  ERCOMP-FILE-ID      PIC  X(8)           VALUE 'ERCOMP'.
   151     12  ERPYAJ-FILE-ID      PIC  X(8)           VALUE 'ERPYAJ'.
   152     12  ERACCT-ALT-FILE-ID  PIC  X(8)           VALUE 'ERACCT2'.
   153     12  ERACCT-FILE-ID      PIC  X(8)           VALUE 'ERACCT'.
   154     12  ERBILL-FILE-ID      PIC  X(8)           VALUE 'ERBILL'.
   155     12  ERGXRF-FILE-ID      PIC  X(8)           VALUE 'ERGXRF'.
   156     12  ERCOMM-FILE-ID      PIC  X(8)           VALUE 'ERCOMM'.
   157     12  ERCTBL-FILE-ID      PIC  X(8)           VALUE 'ERCTBL'.
   158     12  ERRESC-FILE-ID      PIC  X(8)           VALUE 'ERRESC'.
   159     12  RETURNED-FROM       PIC  X(8)           VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL642T.cbl
   160     12  QID.
   161         16  QID-TERM        PIC  X(4).
   162         16  FILLER          PIC  X(4)           VALUE '642A'.
   163
   164 01  WORK-AREA.
   165     12  FIRST-TIME-SW               PIC  X      VALUE 'Y'.
   166         88  FIRST-TIME                          VALUE 'Y'.
   167     12  COMPENSATION-SW             PIC  X      VALUE ' '.
   168         88  GENERAL-AGENT                       VALUE 'G'.
   169     12  LIFE-INDICATOR              PIC  X      VALUE ' '.
   170         88  JOINT-LIFE                          VALUE 'J'.
   171     12  BENEFIT-MASTER-FOUND-SW     PIC  X      VALUE ' '.
   172         88  BENEFIT-MASTER-FOUND                VALUE 'Y'.
   173     12  COMMISSION-TBL-SW           PIC  X      VALUE ' '.
   174         88  COMMISSION-TBL-PRESENT              VALUE 'Y'.
   175     12  INVALID-ACCOUNT-SW          PIC  X      VALUE ' '.
   176         88  INVALID-ACCOUNT                     VALUE 'Y'.
   177     12  NEW-ACCOUNT-SW              PIC  X      VALUE ' '.
   178         88  NEW-ACCOUNT                         VALUE 'Y'.
   179     12  VALID-BILL-TYPE-VALUES      PIC  X      VALUE SPACE.
   180         88  VALID-BILL-TYPE                     VALUE  '1' '2'
   181                                                    '3' '4' '5'.
   182     12  BILL-BATCH-TRAILER-SW       PIC  X      VALUE SPACE.
   183         88  BILL-BATCH-TRAILER                  VALUE 'Y'.
   184     12  ERCOMM-FOUND-SW             PIC  X      VALUE SPACE.
   185         88  ERCOMM-FOUND                        VALUE 'Y'.
   186         88  ERCOMM-NOT-FOUND                    VALUE 'N'.
   187     12  ERCTBL-FOUND-SW             PIC  X      VALUE SPACE.
   188         88  ERCTBL-FOUND                        VALUE 'Y'.
   189         88  ERCTBL-NOT-FOUND                    VALUE 'N'.
   190     12  GXRF-EOF-SW                 PIC  X      VALUE SPACE.
   191         88  GXRF-EOF                            VALUE 'Y'.
   192     12  PNDB-EOF-SW                 PIC  X      VALUE SPACE.
   193         88  PNDB-EOF                            VALUE 'Y'.
   194     12  PYAJ-EOF-SW                 PIC  X      VALUE SPACE.
   195         88  PYAJ-EOF                            VALUE 'Y'.
   196     12  COMP-UPDATE-SW              PIC  X      VALUE SPACE.
   197         88  UPDATE-COMP-TOTALS                  VALUE 'Y'.
   198     12  LIMIT-BILLING-SW            PIC  X      VALUE SPACE.
   199         88  LIMIT-BILLING                       VALUE 'Y'.
   200     12  WS-PROCESS-SW               PIC  X      VALUE SPACE.
   201         88  DO-NOT-BILL-THIS-ACCT               VALUE 'Y'.
   202     12  NO-BILL-REC-SW              PIC  X      VALUE SPACE.
   203         88  NO-BILL-RECS                        VALUE 'Y'.
   204     12  DATA-VOIDED-SW              PIC  X      VALUE SPACE.
   205         88  DATA-VOIDED                         VALUE 'Y'.
   206     12  BATCHES-PROCESSED-SW        PIC  X      VALUE SPACE.
   207         88  MORE-THAN-6-BATCHES                 VALUE 'Y'.
   208     12  ACCOUNT-CARRY-BAL-SW        PIC  X      VALUE SPACE.
   209         88  ACCOUNT-CARRY-BAL                   VALUE 'Y'.
   210     12  BILLING-DETAIL-TYPE         PIC  XX VALUE SPACES.
   211         88  TOTAL-STATEMENT                     VALUE 'TS'.
   212         88  TOTAL-ACCOUNT                       VALUE 'TA'.
   213         88  TOTAL-BOTH                          VALUE 'TB'.
   214         88  GEN-AGT-ADDRESS                     VALUE 'GA'.
   215     12  ELCNTL-UPDATE-SW            PIC  X      VALUE SPACE.
   216         88  ELCNTL-UPDATE                       VALUE 'Y'.
   217     12  WS-BILL-TYPE                PIC  X      VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL642T.cbl
   218         88  WS-UPDATE-FILES                     VALUE '3' '4'
   219                                                       '5'.
   220     12  SUB                     PIC S999 COMP-3 VALUE ZEROS.
   221     12  ACCOM-SUB               PIC  99 COMP VALUE ZEROS.
   222     12  GX-SUB                  PIC S9(4) COMP VALUE ZEROS.
   223     12  COMP-SUB                PIC S9(4) COMP VALUE ZEROS.
   224     12  CE-SUB                  PIC S9(4) COMP VALUE ZEROS.
   225     12  BEN-SUB                 PIC S9(4) COMP VALUE ZEROS.
   226     12  WORK-SEQ-NO             PIC S9(9) COMP-3.
   227     12  WS-ERROR-MSG.
   228         16  WS-ERROR-TEXT       PIC  X(35)      VALUE SPACES.
   229         16  WS-ERROR-BATCH      PIC  X(6)       VALUE SPACES.
   230         16  FILLER              PIC  X(24)      VALUE SPACES.
   231     12  WS-WORK-DATE.
   232         16  WS-MONTH            PIC  99         VALUE ZEROS.
   233         16  WS-DAY              PIC  99         VALUE ZEROS.
   234         16  WS-YEAR             PIC  99         VALUE ZEROS.
   235     12  WS-MONTH-END-DATE.
   236         16  WS-ME-YEAR          PIC  99         VALUE ZEROS.
   237         16  WS-ME-MONTH         PIC  99         VALUE ZEROS.
   238         16  WS-ME-DAY           PIC  99         VALUE ZEROS.
   239     12  WS-CURRENT-DATE         PIC  XX         VALUE SPACES.
   240     12  WS-CURRENT-DATE-MDY     PIC  X(6)       VALUE SPACES.
   241     12  WS-CURRENT-DATE-EDIT    PIC  X(8)       VALUE SPACES.
   242     12  WS-PREV-BILL-DATE       PIC  XX     VALUE LOW-VALUES.
   243     12  MONTHS-DIFF-LF          PIC S9(05).
   244     12  MONTHS-DIFF-AH          PIC S9(05).
   245     12  WS-LF-CANCEL-DATE.
   246         16  WS-LF-CANCEL-YR     PIC 99.
   247         16  WS-LF-CANCEL-MO     PIC 99.
   248         16  WS-LF-CANCEL-DA     PIC 99.
   249     12  WS-AH-CANCEL-DATE.
   250         16  WS-AH-CANCEL-YR     PIC 99.
   251         16  WS-AH-CANCEL-MO     PIC 99.
   252         16  WS-AH-CANCEL-DA     PIC 99.
   253     12  WS-EFFECT-DATE.
   254         16  WS-EFFECT-YR        PIC 99.
   255         16  WS-EFFECT-MO        PIC 99.
   256         16  WS-EFFECT-DA        PIC 99.
   257     12  WS-BEGIN-DATE.
   258         16  FILLER              PIC  X(3)       VALUE SPACES.
   259         16  WS-BEGIN-DAY        PIC  XX         VALUE SPACES.
   260         16  FILLER              PIC  X(3)       VALUE SPACES.
   261     12  PRINT-CONTROL.
   262         16  SINGLE-SPACE        PIC  X          VALUE SPACE.
   263         16  DOUBLE-SPACE        PIC  X          VALUE ZERO.
   264         16  TRIPLE-SPACE        PIC  X          VALUE '-'.
   265         16  SUPPRESS-SPACE      PIC  X          VALUE '+'.
   266         16  TOP-OF-PAGE         PIC  X          VALUE '1'.
   267     12  WS-EXP-DATE.
   268         16  WS-SAV-EXP-DT   OCCURS  10  TIMES
   269                 INDEXED BY  DTNDX   PIC  XX.
   270     12  WS-REMIT-TO.
   271         16  WS-SAV-REMIT-TO     OCCURS  10  TIMES
   272                 INDEXED BY  RTNDX   PIC  X(6).
   273     12  WORK-REMIT-TO           PIC  X(6)       VALUE SPACES.
   274     12  WS-REMITTED             PIC S9(6)V99    VALUE ZEROS.
   275     12  WS-LINECTR              PIC  99         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL642T.cbl
   276     12  WS-PGECTR               PIC  9(3)       VALUE 1.
   277     12  WS-LINE-SEQ-NO          PIC S9(4) COMP VALUE +1.
   278     12  WS-CARR-COMP.
   279         16  WS-CARRIER          PIC  X          VALUE SPACE.
   280         16  WS-COMP             PIC  X(3)       VALUE SPACES.
   281     12  WORK-AMT                PIC S9(7)V99    VALUE ZEROS.
   282     12  JOURNAL-LENGTH          PIC S9(4) COMP VALUE ZERO.
   283     12  LF-COMM-TBL-NO          PIC  X(3)       VALUE SPACES.
   284     12  JT-COMM-TBL-NO          PIC  X(3)       VALUE SPACES.
   285     12  AH-COMM-TBL-NO          PIC  X(3)       VALUE SPACES.
   286     12  AGENT-OWES              PIC  X(18)      VALUE
   287             'AGENT OWES       ='.
   288     12  OWED-TO-AGENT           PIC  X(18)      VALUE
   289             'OWED TO AGENT    ='.
   290     12  WS-PY-ENTRY-COMMENT.
   291         16  WS-PY-CURRENT-DATE  PIC  X(6).
   292         16  FILLER              PIC  X(14)      VALUE
   293                 ' CHK TO AGENT'.
   294     12  WS-ACCT-NOT-BILLED      PIC  X(18)      VALUE
   295             'ACCOUNT NOT BILLED'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL642T.cbl
   297     12  WS-AGENT-ADDR-AREA.
   298         16  WS-AGENT-LINES  OCCURS  6  TIMES
   299                 INDEXED BY  A-INDX.
   300             20  WS-AGENT-ZIP.
   301                 24  WS-AGENT-1ST-ZIP    PIC  X(4).
   302                 24  WS-AGENT-2ND-ZIP    PIC  X(5).
   303             20  FILLER                  PIC  X(12).
   304             20  WS-A-LAST-ZIP.
   305                 24  WS-A-LAST-1ST-ZIP   PIC  X(4).
   306                 24  WS-A-LAST-2ND-ZIP   PIC  X(5).
   307     12  WS-COMPENSATION-WORK-AREA.
   308         16  WS-COMM-CK-AMT      PIC S9(5)V99 COMP-3 VALUE +0.
   309         16  WS-COMM-AGE         PIC  99.
   310         16  WS-COMM-TERM        PIC  9(3).
   311         16  WS-LF-ISS-COMP      PIC S9(5)V99 COMP-3 VALUE +0.
   312         16  WS-AH-ISS-COMP      PIC S9(5)V99 COMP-3 VALUE +0.
   313         16  WS-I-LF-PREMIUM-AMT PIC S9(7)V99 COMP-3 VALUE +0.
   314         16  WS-I-AH-PREMIUM-AMT PIC S9(7)V99 COMP-3 VALUE +0.
   315         16  WS-I-LF-BENEFIT-AMT PIC S9(9)V99 COMP-3 VALUE +0.
   316         16  WS-I-AH-BENEFIT-AMT PIC S9(9)V99 COMP-3 VALUE +0.
   317         16  WS-C-LF-CANCEL-AMT  PIC S9(7)V99 COMP-3 VALUE +0.
   318         16  WS-C-AH-CANCEL-AMT  PIC S9(7)V99 COMP-3 VALUE +0.
   319         16  WS-WK-RATE          PIC SV9(5)    COMP-3 VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL642T.cbl
   321     12  WS-ACCOUNT-TOTALS       COMP-3.
   322         16  WS-ACCT-BEG-BAL         PIC S9(7)V99 VALUE ZEROS.
   323         16  WS-ACCT-NET-PREM        PIC S9(7)V99 VALUE ZEROS.
   324         16  WS-ACCT-COMP            PIC S9(7)V99 VALUE ZEROS.
   325         16  WS-ACCT-PAY-ADJS        PIC S9(7)V99 VALUE ZEROS.
   326         16  WS-ACCT-UNPAID-NET-PREM PIC S9(7)V99 VALUE ZEROS.
   327         16  WS-ACCT-LF-OVERWRITE    PIC S9(7)V99 VALUE ZEROS.
   328         16  WS-ACCT-AH-OVERWRITE    PIC S9(7)V99 VALUE ZEROS.
   329     12  WS-GENERAL-AGENT-TOTALS COMP-3.
   330         16  WS-GA-BEG-BAL           PIC S9(7)V99 VALUE ZEROS.
   331         16  WS-GA-NET-PREM          PIC S9(7)V99 VALUE ZEROS.
   332         16  WS-GA-COMP              PIC S9(7)V99 VALUE ZEROS.
   333         16  WS-GA-PAY-ADJS          PIC S9(7)V99 VALUE ZEROS.
   334         16  WS-GA-UNPAID-NET-PREM   PIC S9(7)V99 VALUE ZEROS.
   335         16  WS-GA-LF-OVERWRITE      PIC S9(7)V99 VALUE ZEROS.
   336         16  WS-GA-AH-OVERWRITE      PIC S9(7)V99 VALUE ZEROS.
   337         16  WS-GA-END-BAL           PIC S9(7)V99 VALUE ZEROS.
   338         16  WS-GA-AMT-DUE           PIC S9(7)V99 VALUE ZEROS.
   339     12  WS-GENERAL-AGENT-COMMISSIONS.
   340         16  WS-GA-LEVEL         PIC S99     COMP   VALUE +0.
   341         16  WS-GA-LF-COM        PIC SV9(5) COMP-3 VALUE +.0.
   342         16  WS-GA-AH-COM        PIC SV9(5) COMP-3 VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL642T.cbl
   344 01  ACCESS-KEYS.
   345     12  ERPNDB-PRIME-KEY.
   346         16  ERPNDB-CO-CD        PIC  X          VALUE SPACES.
   347         16  ERPNDB-BATCH        PIC  X(6)       VALUE SPACES.
   348         16  ERPNDB-SEQ-NO       PIC S9(4) COMP.
   349         16  ERPNDB-CHG-SEQ-NO   PIC S9(4) COMP.
   350     12  ERPNDB-LENGTH           PIC S9(4) COMP VALUE +585.
   351     12  ERPNDB-ALT-KEY.
   352         16  ERPNDB-CO-CD-A1     PIC  X          VALUE SPACES.
   353         16  ERPNDB-CARR         PIC  X          VALUE SPACES.
   354         16  ERPNDB-GROUP        PIC  X(6)       VALUE SPACES.
   355         16  ERPNDB-STATE        PIC  XX         VALUE SPACES.
   356         16  ERPNDB-ACCT         PIC  X(10)      VALUE SPACES.
   357         16  ERPNDB-EFF-DT       PIC  XX         VALUE SPACES.
   358         16  ERPNDB-CERT.
   359             20  ERPNDB-CERT-PRM PIC  X(10)      VALUE SPACES.
   360             20  ERPNDB-CERTSFX  PIC  X          VALUE SPACES.
   361         16  ERPNDB-ACHG-SEQ-NO  PIC S9(4) COMP.
   362         16  ERPNDB-REC-TYPE     PIC  X          VALUE SPACES.
   363     12  ELCNTL-KEY.
   364         16  ELCNTL-COMPANY-ID   PIC  X(3)       VALUE SPACES.
   365         16  ELCNTL-REC-TYPE     PIC  X          VALUE SPACES.
   366         16  ELCNTL-FILLER       PIC  X(3)       VALUE SPACES.
   367         16  ELCNTL-CARRIER      PIC  X          VALUE SPACES.
   368         16  ELCNTL-SEQ-NO       PIC S9(4) COMP VALUE ZEROS.
   369     12  ELCNTL-BENEFIT-KEY.
   370         16  CLBENF-COMPANY-ID   PIC  X(3)       VALUE SPACES.
   371         16  CLBENF-REC-TYPE     PIC  X          VALUE SPACES.
   372         16  CLBENF-ACCESS.
   373             20  FILLER          PIC  XX         VALUE SPACES.
   374             20  CLBENF-CD       PIC  XX         VALUE SPACES.
   375         16  CLBENF-SEQ-NO       PIC S9(4) COMP VALUE ZEROS.
   376     12  ELCNTL-LENGTH           PIC S9(4) COMP VALUE +504.
   377     12  ERCOMP-KEY.
   378         16  ERCOMP-COMP-CD      PIC  X          VALUE SPACE.
   379         16  ERCOMP-CARRIER      PIC  X          VALUE SPACES.
   380         16  ERCOMP-GROUPING     PIC  X(6)       VALUE SPACES.
   381         16  ERCOMP-FIN-RESP     PIC  X(10)      VALUE SPACES.
   382         16  ERCOMP-ACCT         PIC  X(10)      VALUE SPACES.
   383         16  ERCOMP-RECORD-TYPE  PIC  X          VALUE SPACES.
   384     12  ERPYAJ-BROWSE-COMP-KEY.
   385         16  ERPYAJ-BR-COMP-CD   PIC  X          VALUE SPACE.
   386         16  ERPYAJ-BR-CARRIER   PIC  X          VALUE SPACES.
   387         16  ERPYAJ-BR-GROUPING  PIC  X(6)       VALUE SPACES.
   388         16  ERPYAJ-BR-FIN-RESP  PIC  X(10)      VALUE SPACES.
   389         16  ERPYAJ-BR-ACCOUNT   PIC  X(10)      VALUE SPACES.
   390     12  ERCOMP-PREV-KEY         PIC  X(29)      VALUE SPACES.
   391     12  ERCOMP-LENGTH           PIC S9(4) COMP VALUE +700.
   392     12  ERPYAJ-KEY.
   393         16  ERPYAJ-COMP-CD      PIC  X          VALUE SPACE.
   394         16  ERPYAJ-CARRIER      PIC  X          VALUE SPACES.
   395         16  ERPYAJ-GROUPING     PIC  X(6)       VALUE SPACES.
   396         16  ERPYAJ-FIN-RESP     PIC  X(10)      VALUE SPACES.
   397         16  ERPYAJ-ACCOUNT      PIC  X(10)      VALUE SPACES.
   398         16  ERPYAJ-FILE-SEQ-NO  PIC S9(8) COMP VALUE +0.
   399         16  ERPYAJ-RECORD-TYPE  PIC  X          VALUE SPACES.
   400     12  ERPYAJ-LENGTH           PIC S9(4) COMP VALUE +200.
   401     12  ERACCT-PRIME-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL642T.cbl
   402         16  ERACCT-P-CO-CD      PIC  X          VALUE SPACES.
   403         16  ERACCT-P-CARRIER    PIC  X          VALUE SPACES.
   404         16  ERACCT-P-GROUPING   PIC  X(6)       VALUE SPACES.
   405         16  ERACCT-P-STATE      PIC  XX         VALUE SPACES.
   406         16  ERACCT-P-ACCOUNT    PIC  X(10)      VALUE SPACES.
   407         16  ERACCT-P-EXP-DATE   PIC  XX         VALUE SPACES.
   408         16  FILLER              PIC  X(4)   VALUE LOW-VALUES.
   409     12  ERACCT-LENGTH           PIC S9(4) COMP VALUE +2000.
   410     12  ERACCT-ALT-KEY.
   411         16  ERACCT-A-CO-CD      PIC  X          VALUE SPACES.
   412         16  ERACCT-A-CARRIER    PIC  X          VALUE SPACES.
   413         16  ERACCT-A-GROUPING   PIC  X(6)       VALUE SPACES.
   414         16  ERACCT-A-STATE      PIC  XX         VALUE SPACES.
   415         16  ERACCT-A-ACCOUNT    PIC  X(10)      VALUE SPACES.
   416         16  ERACCT-A-EXP-DATE   PIC  XX         VALUE SPACES.
   417         16  FILLER              PIC  X(4)   VALUE LOW-VALUES.
   418     12  ERBILL-KEY.
   419         16  ERBILL-CO-CD        PIC  X.
   420         16  ERBILL-CARRIER      PIC  X.
   421         16  ERBILL-GROUP        PIC  X(6).
   422         16  ERBILL-ACCT         PIC  X(10).
   423         16  ERBILL-FIN-RESP     PIC  X(10).
   424         16  ERBILL-REC-TYPE     PIC  X.
   425         16  ERBILL-LINE-SEQ-NO  PIC S9(4) COMP.
   426     12  ERBILL-LENGTH           PIC S9(4) COMP VALUE +210.
   427     12  ERGXRF-KEY.
   428         16  ERGXRF-COMPANY-CD   PIC  X.
   429         16  ERGXRF-CARRIER      PIC  X.
   430         16  ERGXRF-GROUPING     PIC  X(6).
   431         16  ERGXRF-AGENT-NO     PIC  X(10).
   432     12  ERGXRF-FIXED-LENGTH     PIC S9(4) COMP VALUE +64.
   433     12  ERGXRF-VAR-LENGTH       PIC S9(4) COMP VALUE +24.
   434     12  ERGXRF-LENGTH           PIC S9(4) COMP VALUE ZEROS.
   435     12  ERCOMM-KEY.
   436         16  ERCOMM-COMPANY-CD   PIC  X.
   437         16  ERCOMM-CARRIER      PIC  X.
   438         16  ERCOMM-GROUPING     PIC  X(6).
   439         16  ERCOMM-STATE        PIC  XX.
   440         16  ERCOMM-ACCOUNT      PIC  X(10).
   441         16  ERCOMM-CERT-EFF-DT  PIC  XX.
   442         16  ERCOMM-CERT-NO.
   443             20  CE-CERT-PRIME   PIC  X(10).
   444             20  CE-CERT-SFX     PIC  X.
   445     12  ERCOMM-LENGTH           PIC S9(4) COMP VALUE +250.
   446     12  ERCTBL-KEY.
   447         16  ERCTBL-COMPANY-CD       PIC  X.
   448         16  ERCTBL-TABLE            PIC  X(3).
   449         16  ERCTBL-CNTRL-2.
   450             20  ERCTBL-BEN-TYPE     PIC  X.
   451             20  ERCTBL-BEN-CODE     PIC  XX.
   452     12  ERCTBL-LENGTH               PIC S9(4) COMP VALUE +200.
   453     12  SAVE-ERACCT-PRIME-KEY.
   454         16  SV-ERACCT-P-CO-CD       PIC  X      VALUE SPACES.
   455         16  SV-ERACCT-P-CARRIER     PIC  X      VALUE SPACES.
   456         16  SV-ERACCT-P-GROUPING    PIC  X(6)   VALUE SPACES.
   457         16  SV-ERACCT-P-STATE       PIC  XX     VALUE SPACES.
   458         16  SV-ERACCT-P-ACCOUNT     PIC  X(10)  VALUE SPACES.
   459         16  SV-ERACCT-P-EXP-DATE    PIC  XX     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL642T.cbl
   460*****************************************************************
   461*      START OF WORKING STORAGE FOR CLIENT-DMD                  *
   462*****************************************************************
   463*RESIDENT STATE TAXES MASTER(ERRESC)
   464*
   465     12  WS-SV-ERRESC-KEY             PIC X(32).
   466
   467     12  WS-ERRESC-KEY.
   468         16 WS-ERRESC-SEARCH-KEY.
   469             20  WS-ERRESC-COMPANY-CD PIC  X.
   470             20  WS-ERRESC-CARRIER    PIC  X.
   471             20  WS-ERRESC-GROUP      PIC X(6).
   472             20  WS-ERRESC-STATE      PIC XX.
   473             20  WS-ERRESC-ACCOUNT    PIC X(10).
   474         16 WS-ERRESC-RESIDUAL-KEY.
   475             20  WS-ERRESC-AGENT      PIC X(10).
   476             20  WS-ERRESC-RES-STATE  PIC XX.
   477             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   478*                                          YYYYMMDD
   479     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   480     12  WS-SUB1                      PIC    S99 COMP-3.
   481     12  WS-SUB                       PIC    S99 COMP-3.
   482     12  WS-CONTRACT-DATE             PIC 9(8).
   483     12  WS-COMM-SW                   PIC XX VALUE SPACES.
   484         88  AH-COMM                             VALUE 'AH'.
   485         88  LF-COMM                             VALUE 'LF'.
   486*****************************************************************
   487*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   488*****************************************************************
   489
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL642T.cbl
   491 01  ERROR-NUMBERS.
   492     12  ER-0004             PIC  X(4)           VALUE '0004'.
   493     12  ER-0008             PIC  X(4)           VALUE '0008'.
   494     12  ER-0022             PIC  X(4)           VALUE '0022'.
   495     12  ER-0029             PIC  X(4)           VALUE '0029'.
   496     12  ER-0070             PIC  X(4)           VALUE '0070'.
   497     12  ER-0194             PIC  X(4)           VALUE '0194'.
   498     12  ER-0195             PIC  X(4)           VALUE '0195'.
   499     12  ER-0196             PIC  X(4)           VALUE '0196'.
   500     12  ER-0197             PIC  X(4)           VALUE '0197'.
   501     12  ER-2208             PIC  X(4)           VALUE '2208'.
   502     12  ER-2210             PIC  X(4)           VALUE '2210'.
   503     12  ER-2215             PIC  X(4)           VALUE '2215'.
   504     12  ER-2230             PIC  X(4)           VALUE '2230'.
   505     12  ER-2233             PIC  X(4)           VALUE '2233'.
   506     12  ER-2370             PIC  X(4)           VALUE '2370'.
   507     12  ER-2371             PIC  X(4)           VALUE '2371'.
   508     12  ER-2249             PIC  X(4)           VALUE '2249'.
   509     12  ER-2250             PIC  X(4)           VALUE '2250'.
   510     12  ER-2383             PIC  X(4)           VALUE '2383'.
   511     12  ER-2385             PIC  X(4)           VALUE '2385'.
   512     12  ER-2399             PIC  X(4)           VALUE '2399'.
   513     12  ER-2400             PIC  X(4)           VALUE '2400'.
   514     12  ER-2401             PIC  X(4)           VALUE '2401'.
   515     12  ER-2403             PIC  X(4)           VALUE '2403'.
   516     12  ER-2404             PIC  X(4)           VALUE '2404'.
   517     12  ER-2405             PIC  X(4)           VALUE '2405'.
   518     12  ER-2406             PIC  X(4)           VALUE '2406'.
   519     12  ER-2407             PIC  X(4)           VALUE '2407'.
   520     12  ER-2408             PIC  X(4)           VALUE '2408'.
   521     12  ER-2409             PIC  X(4)           VALUE '2409'.
   522     12  ER-2411             PIC  X(4)           VALUE '2411'.
   523     12  ER-2421             PIC  X(4)           VALUE '2421'.
   524     12  ER-2434             PIC  X(4)           VALUE '2434'.
   525     12  ER-2435             PIC  X(4)           VALUE '2435'.
   526     12  ER-2436             PIC  X(4)           VALUE '2436'.
   527     12  ER-2438             PIC  X(4)           VALUE '2438'.
   528     12  ER-2439             PIC  X(4)           VALUE '2439'.
   529     12  ER-2443             PIC  X(4)           VALUE '2443'.
   530     12  ER-2472             PIC  X(4)           VALUE '2472'.
   531     12  ER-2564             PIC  X(4)           VALUE '2564'.
   532     12  ER-2570             PIC  X(4)           VALUE '2570'.
   533     12  ER-2571             PIC  X(4)           VALUE '2571'.
   534     12  ER-2590             PIC  X(4)           VALUE '2571'.
   535     12  ER-2597             PIC  X(4)           VALUE '2597'.
   536     12  ER-2910             PIC  X(4)           VALUE '2910'.
   537     12  ER-2911             PIC  X(4)           VALUE '2911'.
   538     12  ER-2912             PIC  X(4)           VALUE '2912'.
   539     12  ER-2913             PIC  X(4)           VALUE '2913'.
   540     12  ER-2914             PIC  X(4)           VALUE '2914'.
   541     12  ER-2915             PIC  X(4)           VALUE '2915'.
   542     12  ER-2916             PIC  X(4)           VALUE '2916'.
   543     12  ER-2917             PIC  X(4)           VALUE '2917'.
   544     12  ER-2918             PIC  X(4)           VALUE '2918'.
   545     12  ER-3145             PIC  X(4)           VALUE '3145'.
   546     12  ER-3165             PIC  X(4)           VALUE '3165'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL642T.cbl
   548 01  CENTER-DATA-WORK-AREA.
   549     12  X1                  PIC S9(4)   COMP    VALUE +0.
   550     12  X2                  PIC S9(4)   COMP    VALUE +0.
   551     12  X3                  PIC S9(4)   COMP    VALUE +0.
   552     12  X-LEN               PIC S9(4)   COMP    VALUE +0.
   553     12  CENTER-WORK-1.
   554         16  CW1-PIC         PIC  X      OCCURS  44  TIMES.
   555     12  CENTER-WORK-2.
   556         16  CW2-PIC         PIC  X      OCCURS  44  TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL642T.cbl
   558 01  GA-REPORT-HEADINGS.
   559     12  GA-PREVIEW-HD.
   560         16  FILLER          PIC  X(44)          VALUE
   561                 '                                          **'.
   562         16  FILLER          PIC  X(45)          VALUE
   563                 '** STATEMENT IS FOR REVIEW PURPOSES ONLY ***'.
   564         16  FILLER          PIC  X(44)          VALUE
   565                 '*                                           '.
   566     12  GA-HD1.
   567         16  FILLER          PIC  X(44)          VALUE SPACES.
   568         16  FILLER          PIC  X(44)          VALUE
   569                 '            AGENT    STATEMENT              '.
   570         16  FILLER          PIC  X(37)          VALUE SPACES.
   571         16  FILLER          PIC  X(7)           VALUE ' EL642 '.
   572     12  GA-HD2.
   573         16  FILLER          PIC  X(43)          VALUE SPACES.
   574         16  HD-CO           PIC  X(44)          VALUE SPACES.
   575         16  FILLER          PIC  X(37)          VALUE SPACES.
   576         16  HD-RUN-DT       PIC  X(8)           VALUE SPACES.
   577     12  GA-HD3.
   578         16  FILLER          PIC  X(57)          VALUE SPACES.
   579         16  HD-DT           PIC  X(18)          VALUE SPACES.
   580         16  FILLER          PIC  X(37)          VALUE SPACES.
   581         16  FILLER          PIC  X(5)           VALUE 'PAGE '.
   582         16  HD-PG           PIC ZZ,ZZ9.
   583     12  GA-HD4.
   584         16  FILLER          PIC  X(44)          VALUE
   585                 ' ------------- A C C O U N T -------------  '.
   586         16  FILLER          PIC  X(44)          VALUE
   587                 'BEGINNING      NET       ACCOUNT    PAYMENTS'.
   588         16  FILLER          PIC  X(44)          VALUE
   589                 '     UNPAID                          AMT.   '.
   590     12  GA-HD5.
   591         16  FILLER          PIC  X(44)          VALUE
   592                 '   NUMBER                 NAME              '.
   593         16  FILLER          PIC  X(44)          VALUE
   594                 ' BALANCE     PREMIUM     COMPENS.   ADJUSTS.'.
   595         16  FILLER          PIC  X(44)          VALUE
   596                 '  NET PREMIUM  BENEFIT  OVERWRITE    DUE    '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL642T.cbl
   598*                            COPY ELCDATE.
   599******************************************************************
   600*                                                                *
   601*                                                                *
   602*                            ELCDATE.                            *
   603*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   604*                            VMOD=2.003
   605*                                                                *
   606*                                                                *
   607*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   608*                 LENGTH = 200                                   *
   609******************************************************************
   610
   611 01  DATE-CONVERSION-DATA.
   612     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   613     12  DC-OPTION-CODE                PIC X.
   614         88  BIN-TO-GREG                VALUE ' '.
   615         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   616         88  EDIT-GREG-TO-BIN           VALUE '2'.
   617         88  YMD-GREG-TO-BIN            VALUE '3'.
   618         88  MDY-GREG-TO-BIN            VALUE '4'.
   619         88  JULIAN-TO-BIN              VALUE '5'.
   620         88  BIN-PLUS-ELAPSED           VALUE '6'.
   621         88  FIND-CENTURY               VALUE '7'.
   622         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   623         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   624         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   625         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   626         88  JULIAN-TO-BIN-3            VALUE 'C'.
   627         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   628         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   629         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   630         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   631         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   632         88  CHECK-LEAP-YEAR            VALUE 'H'.
   633         88  BIN-3-TO-GREG              VALUE 'I'.
   634         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   635         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   636         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   637         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   638         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   639         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   640         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   641         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   642         88  THREE-CHARACTER-BIN
   643                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   644         88  GREGORIAN-TO-BIN
   645                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   646         88  BIN-TO-GREGORIAN
   647                  VALUES ' ' '1' 'I' '8' 'G'.
   648         88  JULIAN-TO-BINARY
   649                  VALUES '5' 'C' 'E' 'F'.
   650     12  DC-ERROR-CODE                 PIC X.
   651         88  NO-CONVERSION-ERROR        VALUE ' '.
   652         88  DATE-CONVERSION-ERROR
   653                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   654         88  DATE-IS-ZERO               VALUE '1'.
   655         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL642T.cbl
   656         88  DATE-IS-INVALID            VALUE '3'.
   657         88  DATE1-GREATER-DATE2        VALUE '4'.
   658         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   659         88  DATE-INVALID-OPTION        VALUE '9'.
   660         88  INVALID-CENTURY            VALUE 'A'.
   661         88  ONLY-CENTURY               VALUE 'B'.
   662         88  ONLY-LEAP-YEAR             VALUE 'C'.
   663         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   664     12  DC-END-OF-MONTH               PIC X.
   665         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   666     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   667         88  USE-NORMAL-PROCESS         VALUE ' '.
   668         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   669         88  ADJUST-UP-100-YRS          VALUE '2'.
   670     12  FILLER                        PIC X.
   671     12  DC-CONVERSION-DATES.
   672         16  DC-BIN-DATE-1             PIC XX.
   673         16  DC-BIN-DATE-2             PIC XX.
   674         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   675         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   676                       DC-GREG-DATE-1-EDIT.
   677             20  DC-EDIT1-MONTH        PIC 99.
   678             20  SLASH1-1              PIC X.
   679             20  DC-EDIT1-DAY          PIC 99.
   680             20  SLASH1-2              PIC X.
   681             20  DC-EDIT1-YEAR         PIC 99.
   682         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   683         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   684                     DC-GREG-DATE-2-EDIT.
   685             20  DC-EDIT2-MONTH        PIC 99.
   686             20  SLASH2-1              PIC X.
   687             20  DC-EDIT2-DAY          PIC 99.
   688             20  SLASH2-2              PIC X.
   689             20  DC-EDIT2-YEAR         PIC 99.
   690         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   691         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   692                     DC-GREG-DATE-1-YMD.
   693             20  DC-YMD-YEAR           PIC 99.
   694             20  DC-YMD-MONTH          PIC 99.
   695             20  DC-YMD-DAY            PIC 99.
   696         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   697         16  DC-GREG-DATE-1-MDY-R REDEFINES
   698                      DC-GREG-DATE-1-MDY.
   699             20  DC-MDY-MONTH          PIC 99.
   700             20  DC-MDY-DAY            PIC 99.
   701             20  DC-MDY-YEAR           PIC 99.
   702         16  DC-GREG-DATE-1-ALPHA.
   703             20  DC-ALPHA-MONTH        PIC X(10).
   704             20  DC-ALPHA-DAY          PIC 99.
   705             20  FILLER                PIC XX.
   706             20  DC-ALPHA-CENTURY.
   707                 24 DC-ALPHA-CEN-N     PIC 99.
   708             20  DC-ALPHA-YEAR         PIC 99.
   709         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   710         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   711         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   712         16  DC-JULIAN-DATE            PIC 9(05).
   713         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL642T.cbl
   714                                       PIC 9(05).
   715         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   716             20  DC-JULIAN-YEAR        PIC 99.
   717             20  DC-JULIAN-DAYS        PIC 999.
   718         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   719         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   720         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   721     12  DATE-CONVERSION-VARIBLES.
   722         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   723         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   724             20  FILLER                PIC 9(3).
   725             20  HOLD-CEN-1-CCYY.
   726                 24  HOLD-CEN-1-CC     PIC 99.
   727                 24  HOLD-CEN-1-YY     PIC 99.
   728             20  HOLD-CEN-1-MO         PIC 99.
   729             20  HOLD-CEN-1-DA         PIC 99.
   730         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   731             20  HOLD-CEN-1-R-MO       PIC 99.
   732             20  HOLD-CEN-1-R-DA       PIC 99.
   733             20  HOLD-CEN-1-R-CCYY.
   734                 24  HOLD-CEN-1-R-CC   PIC 99.
   735                 24  HOLD-CEN-1-R-YY   PIC 99.
   736             20  FILLER                PIC 9(3).
   737         16  HOLD-CENTURY-1-X.
   738             20  FILLER                PIC X(3)  VALUE SPACES.
   739             20  HOLD-CEN-1-X-CCYY.
   740                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   741                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   742             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   743             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   744         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   745             20  HOLD-CEN-1-R-X-MO     PIC XX.
   746             20  HOLD-CEN-1-R-X-DA     PIC XX.
   747             20  HOLD-CEN-1-R-X-CCYY.
   748                 24  HOLD-CEN-1-R-X-CC PIC XX.
   749                 24  HOLD-CEN-1-R-X-YY PIC XX.
   750             20  FILLER                PIC XXX.
   751         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   752         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   753         16  DC-JULIAN-DATE-1          PIC 9(07).
   754         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   755             20  DC-JULIAN-1-CCYY.
   756                 24  DC-JULIAN-1-CC    PIC 99.
   757                 24  DC-JULIAN-1-YR    PIC 99.
   758             20  DC-JULIAN-DA-1        PIC 999.
   759         16  DC-JULIAN-DATE-2          PIC 9(07).
   760         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   761             20  DC-JULIAN-2-CCYY.
   762                 24  DC-JULIAN-2-CC    PIC 99.
   763                 24  DC-JULIAN-2-YR    PIC 99.
   764             20  DC-JULIAN-DA-2        PIC 999.
   765         16  DC-GREG-DATE-A-EDIT.
   766             20  DC-EDITA-MONTH        PIC 99.
   767             20  SLASHA-1              PIC X VALUE '/'.
   768             20  DC-EDITA-DAY          PIC 99.
   769             20  SLASHA-2              PIC X VALUE '/'.
   770             20  DC-EDITA-CCYY.
   771                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL642T.cbl
   772                 24  DC-EDITA-YEAR     PIC 99.
   773         16  DC-GREG-DATE-B-EDIT.
   774             20  DC-EDITB-MONTH        PIC 99.
   775             20  SLASHB-1              PIC X VALUE '/'.
   776             20  DC-EDITB-DAY          PIC 99.
   777             20  SLASHB-2              PIC X VALUE '/'.
   778             20  DC-EDITB-CCYY.
   779                 24  DC-EDITB-CENT     PIC 99.
   780                 24  DC-EDITB-YEAR     PIC 99.
   781         16  DC-GREG-DATE-CYMD         PIC 9(08).
   782         16  DC-GREG-DATE-CYMD-R REDEFINES
   783                              DC-GREG-DATE-CYMD.
   784             20  DC-CYMD-CEN           PIC 99.
   785             20  DC-CYMD-YEAR          PIC 99.
   786             20  DC-CYMD-MONTH         PIC 99.
   787             20  DC-CYMD-DAY           PIC 99.
   788         16  DC-GREG-DATE-MDCY         PIC 9(08).
   789         16  DC-GREG-DATE-MDCY-R REDEFINES
   790                              DC-GREG-DATE-MDCY.
   791             20  DC-MDCY-MONTH         PIC 99.
   792             20  DC-MDCY-DAY           PIC 99.
   793             20  DC-MDCY-CEN           PIC 99.
   794             20  DC-MDCY-YEAR          PIC 99.
   795    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   796        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   797    12  DC-EL310-DATE                  PIC X(21).
   798    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL642T.cbl
   800*                            COPY ELCLOGOF.
   801******************************************************************
   802*                                                                *
   803*                                                                *
   804*                            ELCLOGOF.                           *
   805*                            VMOD=2.001                          *
   806*                                                                *
   807*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   808*                                                                *
   809******************************************************************
   810 01  CLASIC-LOGOFF.
   811     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   812     12  LOGOFF-TEXT.
   813         16  FILLER          PIC X(5)    VALUE SPACES.
   814         16  LOGOFF-MSG.
   815             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   816             20  FILLER      PIC X       VALUE SPACES.
   817             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   818         16  FILLER          PIC X(80)
   819           VALUE '* YOU ARE NOW LOGGED OFF'.
   820         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   821         16  FILLER          PIC X       VALUE QUOTE.
   822         16  LOGOFF-SYS-MSG  PIC X(17)
   823           VALUE 'S CLAS-IC SYSTEM '.
   824     12  TEXT-MESSAGES.
   825         16  UNACCESS-MSG    PIC X(29)
   826             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   827         16  PGMIDERR-MSG    PIC X(17)
   828             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL642T.cbl
   830*                            COPY ELCATTR.
   831******************************************************************
   832*                                                                *
   833*                            ELCATTR.                            *
   834*                            VMOD=2.001                          *
   835*                                                                *
   836*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   837*                                                                *
   838*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   839*                                                                *
   840*                   POS 1   P=PROTECTED                          *
   841*                           U=UNPROTECTED                        *
   842*                           S=ASKIP                              *
   843*                   POS 2   A=ALPHA/NUMERIC                      *
   844*                           N=NUMERIC                            *
   845*                   POS 3   N=NORMAL                             *
   846*                           B=BRIGHT                             *
   847*                           D=DARK                               *
   848*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   849*                           OF=MODIFIED DATA TAG OFF             *
   850*                                                                *
   851*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   852******************************************************************
   853 01  ATTRIBUTE-LIST.
   854     12  AL-PABOF            PIC X       VALUE 'Y'.
   855     12  AL-PABON            PIC X       VALUE 'Z'.
   856     12  AL-PADOF            PIC X       VALUE '%'.
   857     12  AL-PADON            PIC X       VALUE '_'.
   858     12  AL-PANOF            PIC X       VALUE '-'.
   859     12  AL-PANON            PIC X       VALUE '/'.
   860     12  AL-SABOF            PIC X       VALUE '8'.
   861     12  AL-SABON            PIC X       VALUE '9'.
   862     12  AL-SADOF            PIC X       VALUE '@'.
   863     12  AL-SADON            PIC X       VALUE QUOTE.
   864     12  AL-SANOF            PIC X       VALUE '0'.
   865     12  AL-SANON            PIC X       VALUE '1'.
   866     12  AL-UABOF            PIC X       VALUE 'H'.
   867     12  AL-UABON            PIC X       VALUE 'I'.
   868     12  AL-UADOF            PIC X       VALUE '<'.
   869     12  AL-UADON            PIC X       VALUE '('.
   870     12  AL-UANOF            PIC X       VALUE ' '.
   871     12  AL-UANON            PIC X       VALUE 'A'.
   872     12  AL-UNBOF            PIC X       VALUE 'Q'.
   873     12  AL-UNBON            PIC X       VALUE 'R'.
   874     12  AL-UNDOF            PIC X       VALUE '*'.
   875     12  AL-UNDON            PIC X       VALUE ')'.
   876     12  AL-UNNOF            PIC X       VALUE '&'.
   877     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL642T.cbl
   879*                            COPY ELCEMIB.
   880******************************************************************
   881*                                                                *
   882*                                                                *
   883*                            ELCEMIB.                            *
   884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   885*                            VMOD=2.005                          *
   886*                                                                *
   887*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   888*                                                                *
   889******************************************************************
   890 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   891     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   892     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   893     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   894     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   895     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   896     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   897     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   898     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   899     12  EMI-SWITCH1             PIC X        VALUE '1'.
   900         88  EMI-NO-ERRORS                    VALUE '1'.
   901         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   902         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   903     12  EMI-SWITCH2             PIC X        VALUE '1'.
   904         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   905     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   906         88  EMI-AREA1-EMPTY                  VALUE '1'.
   907         88  EMI-AREA1-FULL                   VALUE '2'.
   908     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   909         88  EMI-AREA2-EMPTY                  VALUE '1'.
   910         88  EMI-AREA2-FULL                   VALUE '2'.
   911     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   912         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   913         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   914         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   915         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   916         88  EMI-BYPASS-FATALS                VALUE 'X'.
   917     12  EMI-ERROR-LINES.
   918         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   919         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   920         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   921         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   922             20  EMI-ERR-CODES OCCURS 10 TIMES.
   923                 24  EMI-ERR-NUM         PIC X(4).
   924                 24  EMI-FILLER          PIC X.
   925                 24  EMI-SEV             PIC X.
   926                 24  FILLER              PIC X.
   927             20  FILLER                  PIC X(02).
   928     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   929         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   930             20  EMI-ERROR-NUMBER    PIC X(4).
   931             20  EMI-FILL            PIC X.
   932             20  EMI-SEVERITY        PIC X.
   933             20  FILLER              PIC X.
   934             20  EMI-ERROR-TEXT.
   935                 24  EMI-TEXT-VARIABLE   PIC X(10).
   936                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL642T.cbl
   937     12  EMI-SEVERITY-SAVE           PIC X.
   938         88  EMI-NOTE                    VALUE 'N'.
   939         88  EMI-WARNING                 VALUE 'W'.
   940         88  EMI-FORCABLE                VALUE 'F'.
   941         88  EMI-FATAL                   VALUE 'X'.
   942     12  EMI-MESSAGE-FLAG            PIC X.
   943         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   944         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   945     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   946     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   947         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   948         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   949         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   950     12  FILLER                      PIC X(137)  VALUE SPACES.
   951     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   952     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   953     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   954     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL642T.cbl
   956*                            COPY ELCINTF.
   957******************************************************************
   958*                                                                *
   959*                                                                *
   960*                            ELCINTF.                            *
   961*                            VMOD=2.017                          *
   962*                                                                *
   963*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   964*                                                                *
   965*       LENGTH = 1024                                            *
   966*                                                                *
   967******************************************************************
   968 01  PROGRAM-INTERFACE-BLOCK.
   969     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   970     12  PI-CALLING-PROGRAM              PIC X(8).
   971     12  PI-SAVED-PROGRAM-1              PIC X(8).
   972     12  PI-SAVED-PROGRAM-2              PIC X(8).
   973     12  PI-SAVED-PROGRAM-3              PIC X(8).
   974     12  PI-SAVED-PROGRAM-4              PIC X(8).
   975     12  PI-SAVED-PROGRAM-5              PIC X(8).
   976     12  PI-SAVED-PROGRAM-6              PIC X(8).
   977     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   978     12  PI-COMPANY-ID                   PIC XXX.
   979     12  PI-COMPANY-CD                   PIC X.
   980
   981     12  PI-COMPANY-PASSWORD             PIC X(8).
   982
   983     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   984
   985     12  PI-CONTROL-IN-PROGRESS.
   986         16  PI-CARRIER                  PIC X.
   987         16  PI-GROUPING                 PIC X(6).
   988         16  PI-STATE                    PIC XX.
   989         16  PI-ACCOUNT                  PIC X(10).
   990         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   991                                         PIC X(10).
   992         16  PI-CLAIM-CERT-GRP.
   993             20  PI-CLAIM-NO             PIC X(7).
   994             20  PI-CERT-NO.
   995                 25  PI-CERT-PRIME       PIC X(10).
   996                 25  PI-CERT-SFX         PIC X.
   997             20  PI-CERT-EFF-DT          PIC XX.
   998         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   999             20  PI-PLAN-CODE            PIC X(2).
  1000             20  PI-REVISION-NUMBER      PIC X(3).
  1001             20  PI-PLAN-EFF-DT          PIC X(2).
  1002             20  PI-PLAN-EXP-DT          PIC X(2).
  1003             20  FILLER                  PIC X(11).
  1004         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1005             20  PI-OE-REFERENCE-1.
  1006                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1007                 25  PI-OE-REF-1-SUFF    PIC XX.
  1008
  1009     12  PI-SESSION-IN-PROGRESS          PIC X.
  1010         88  CLAIM-SESSION                   VALUE '1'.
  1011         88  CREDIT-SESSION                  VALUE '2'.
  1012         88  WARRANTY-SESSION                VALUE '3'.
  1013         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL642T.cbl
  1014         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1015
  1016
  1017*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1018
  1019     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1020     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1021
  1022     12  PI-CREDIT-USER                  PIC X.
  1023         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1024         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1025
  1026     12  PI-CLAIM-USER                   PIC X.
  1027         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1028         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1029
  1030     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1031         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1032         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1033         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1034         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1035         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1036
  1037     12  PI-PROCESSOR-ID                 PIC X(4).
  1038
  1039     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1040
  1041     12  PI-MEMBER-CAPTION               PIC X(10).
  1042
  1043     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1044         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1045
  1046     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1047     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1048     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1049     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1050
  1051     12  PI-AH-OVERRIDE-L1               PIC X.
  1052     12  PI-AH-OVERRIDE-L2               PIC XX.
  1053     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1054     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1055
  1056     12  PI-NEW-SYSTEM                   PIC X(2).
  1057
  1058     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1059     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1060         88  PI-USES-PAID-TO                 VALUE '1'.
  1061     12  PI-CRDTCRD-SYSTEM.
  1062         16  PI-CRDTCRD-USER             PIC X.
  1063             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1064             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1065         16  PI-CC-MONTH-END-DT          PIC XX.
  1066     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1067
  1068     12  PI-OE-REFERENCE-2.
  1069         16  PI-OE-REF-2-PRIME           PIC X(10).
  1070         16  PI-OE-REF-2-SUFF            PIC X.
  1071
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL642T.cbl
  1072     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1073
  1074     12  PI-LANGUAGE-TYPE                PIC X.
  1075             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1076             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1077             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1078
  1079     12  PI-POLICY-LINKAGE-IND           PIC X.
  1080         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1081         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1082                                                   LOW-VALUES.
  1083
  1084     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1085     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1086         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1087         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1088     12  FILLER                          PIC X(4).
  1089
  1090     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1091
  1092     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1093         PI-SYSTEM-LEVEL.
  1094
  1095         16  PI-ENTRY-CODES.
  1096             20  PI-ENTRY-CD-1           PIC X.
  1097             20  PI-ENTRY-CD-2           PIC X.
  1098
  1099         16  PI-RETURN-CODES.
  1100             20  PI-RETURN-CD-1          PIC X.
  1101             20  PI-RETURN-CD-2          PIC X.
  1102
  1103         16  PI-UPDATE-STATUS-SAVE.
  1104             20  PI-UPDATE-BY            PIC X(4).
  1105             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1106
  1107         16  PI-LOWER-CASE-LETTERS       PIC X.
  1108             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1109
  1110*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1111*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1112*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1113
  1114         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1115             88  ST-ACCNT-CNTL               VALUE ' '.
  1116             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1117             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1118             88  ACCNT-CNTL                  VALUE '3'.
  1119             88  CARR-ACCNT-CNTL             VALUE '4'.
  1120
  1121         16  PI-PROCESSOR-CAP-LIST.
  1122             20  PI-SYSTEM-CONTROLS.
  1123                24 PI-SYSTEM-DISPLAY     PIC X.
  1124                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1125                24 PI-SYSTEM-MODIFY      PIC X.
  1126                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1127             20  FILLER                  PIC XX.
  1128             20  PI-DISPLAY-CAP          PIC X.
  1129                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL642T.cbl
  1130             20  PI-MODIFY-CAP           PIC X.
  1131                 88  MODIFY-CAP              VALUE 'Y'.
  1132             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1133                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1134             20  PI-FORCE-CAP            PIC X.
  1135                 88  FORCE-CAP               VALUE 'Y'.
  1136
  1137         16  PI-PROGRAM-CONTROLS.
  1138             20  PI-PGM-PRINT-OPT        PIC X.
  1139             20  PI-PGM-FORMAT-OPT       PIC X.
  1140             20  PI-PGM-PROCESS-OPT      PIC X.
  1141             20  PI-PGM-TOTALS-OPT       PIC X.
  1142
  1143         16  PI-HELP-INTERFACE.
  1144             20  PI-LAST-ERROR-NO        PIC X(4).
  1145             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1146
  1147         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1148             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1149
  1150         16  PI-CR-CONTROL-IN-PROGRESS.
  1151             20  PI-CR-CARRIER           PIC X.
  1152             20  PI-CR-GROUPING          PIC X(6).
  1153             20  PI-CR-STATE             PIC XX.
  1154             20  PI-CR-ACCOUNT           PIC X(10).
  1155             20  PI-CR-FIN-RESP          PIC X(10).
  1156             20  PI-CR-TYPE              PIC X.
  1157
  1158         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1159
  1160         16  PI-CR-MONTH-END-DT          PIC XX.
  1161
  1162         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1163             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1164             88  PI-ZERO-CARRIER             VALUE '1'.
  1165             88  PI-ZERO-GROUPING            VALUE '2'.
  1166             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1167
  1168         16  PI-CARRIER-SECURITY         PIC X.
  1169             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1170
  1171         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1172             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1173             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1174
  1175         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1176             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1177                                         INDEXED BY PI-ACCESS-NDX
  1178                                         PIC X.
  1179
  1180         16  PI-GA-BILLING-CONTROL       PIC X.
  1181             88  PI-GA-BILLING               VALUE '1'.
  1182
  1183         16  PI-MAIL-PROCESSING          PIC X.
  1184             88  PI-MAIL-YES                 VALUE 'Y'.
  1185
  1186         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1187
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL642T.cbl
  1188         16  PI-AR-SYSTEM.
  1189             20  PI-AR-PROCESSING-CNTL   PIC X.
  1190                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1191             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1192             20  PI-AR-MONTH-END-DT      PIC XX.
  1193
  1194         16  PI-MP-SYSTEM.
  1195             20  PI-MORTGAGE-USER            PIC X.
  1196                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1197                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1198             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1199                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1200                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1201                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1202                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1203                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1204             20  PI-MP-MONTH-END-DT          PIC XX.
  1205             20  PI-MP-REFERENCE-NO.
  1206                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1207                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1208
  1209         16  PI-LABEL-CONTROL            PIC X(01).
  1210             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1211             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1212
  1213         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1214             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1215
  1216         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1217             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1218             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1219
  1220         16  FILLER                      PIC X(14).
  1221
  1222     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1223******************************************************************
  1224     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1225         16  PI-MAP-NAME         PIC  X(8).
  1226         16  PI-AGENT-NAME       PIC  X(20).
  1227         16  PI-SAV-REMIT-TO     PIC  X(10).
  1228         16  PI-SAV-FIN-RESP     PIC  X(10).
  1229         16  PI-SAV-ACCT         PIC  X(10).
  1230         16  PI-SAV-ACCT-AGT     PIC  X(10).
  1231         16  PI-SAV-ACCT-NAME    PIC  X(30).
  1232         16  PI-SAV-AGENT        PIC  X(10).
  1233         16  PI-SAV-CARR         PIC  X.
  1234         16  PI-SAV-GROUP        PIC  X(6).
  1235         16  PI-SAV-STATE        PIC  XX.
  1236         16  PI-SAV-EXP-DT       PIC  XX.
  1237         16  PI-UNPAID-NET-PREM  PIC S9(7)V99    COMP-3.
  1238         16  PI-COMP-UNPAID-PREM PIC S9(7)V99    COMP-3.
  1239         16  PI-BAL-FRWD         PIC S9(7)V99    COMP-3.
  1240         16  PI-PREMIUM          PIC S9(7)V99    COMP-3.
  1241         16  PI-REMITTED         PIC S9(7)V99    COMP-3.
  1242         16  PI-TOT-ISS-COMP     PIC S9(7)V99    COMP-3.
  1243         16  PI-TOT-CAN-COMP     PIC S9(7)V99    COMP-3.
  1244         16  PI-ADJUSTMNTS       PIC S9(7)V99    COMP-3.
  1245         16  PI-DISBURSED        PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL642T.cbl
  1246         16  PI-END-BAL          PIC S9(7)V99    COMP-3.
  1247         16  PI-LF-ISS-COMP      PIC S9(7)V99    COMP-3.
  1248         16  PI-AH-ISS-COMP      PIC S9(7)V99    COMP-3.
  1249         16  PI-LF-CAN-COMP      PIC S9(7)V99    COMP-3.
  1250         16  PI-AH-CAN-COMP      PIC S9(7)V99    COMP-3.
  1251         16  PI-DUE-FOR-ACCT     PIC S9(7)V99    COMP-3.
  1252         16  PI-ACCT-BEG-BAL     PIC S9(7)V99    COMP-3.
  1253         16  PI-ACCT-NET-PREM    PIC S9(7)V99    COMP-3.
  1254         16  PI-ACCT-COMP        PIC S9(7)V99    COMP-3.
  1255         16  PI-ACCT-PAY-ADJS    PIC S9(7)V99    COMP-3.
  1256         16  PI-BILL-TYPE        PIC  X.
  1257             88  PI-PREV-BILL                    VALUE '1'.
  1258             88  PI-PREV-REBILL                  VALUE '2'.
  1259             88  PI-PREVIEW                      VALUE '1' '2'.
  1260             88  PI-BILL                         VALUE '3'.
  1261             88  PI-REBILLING                    VALUE '4'.
  1262             88  PI-VOID-BILL                    VALUE '5'.
  1263             88  PI-TOT-REBILL                   VALUE '2' '4'.
  1264             88  PI-UPDATE-FILES                 VALUE '3' '4'
  1265                                                       '5'.
  1266             88  PI-BILLING-FUNCTION             VALUE '1' '2'
  1267                                                       '3' '4'.
  1268         16  PI-BILL-ERRS        PIC  X.
  1269         16  PI-CHECK-SW         PIC  X.
  1270             88  PI-CHECK-PRODUCED               VALUE 'Y'.
  1271         16  PI-DATA-BILLED-SW   PIC  X.
  1272             88  PI-DATA-BILLED                  VALUE 'Y'.
  1273         16  PI-ACCT-BILLED-SW   PIC  X.
  1274             88  PI-ACCT-BILLED                  VALUE 'Y'.
  1275         16  PI-MONTH-END-DATE.
  1276             20  PI-ME-MONTH     PIC  99.
  1277             20  FILLER          PIC  X.
  1278             20  PI-ME-DAY       PIC  99.
  1279             20  FILLER          PIC  X.
  1280             20  PI-ME-YEAR      PIC  99.
  1281         16  PI-LIMIT-BILLING-ACCOUNTS.
  1282             20  PI-BILLING-ACCOUNTS     OCCURS  3  TIMES
  1283                                     PIC  X(10).
  1284         16  PI-ISSUE-INFO.
  1285             20  PI-ISSUES-BILLED    PIC S9(6) COMP-3.
  1286             20  PI-ISSUES-INER      PIC S9(6) COMP-3.
  1287             20  PI-ISSUES-PREV      PIC S9(6) COMP-3.
  1288         16  PI-CANCEL-INFO.
  1289             20  PI-CANCELS-BILLED   PIC S9(6) COMP-3.
  1290             20  PI-CANCELS-INER     PIC S9(6) COMP-3.
  1291             20  PI-CANCELS-PREV     PIC S9(6) COMP-3.
  1292         16  PI-UNKNOWN              PIC S9(6) COMP-3.
  1293         16  PI-COMP-CONTROL.
  1294             20  PI-COMP-CARRIER     PIC  X.
  1295             20  PI-COMP-GROUPING    PIC  X(6).
  1296             20  PI-COMP-FIN-RESP    PIC  X(10).
  1297         16  PI-SCRN-CONTROL.
  1298             20  PI-SCR-CARRIER      PIC  X.
  1299             20  PI-SCR-GROUPING     PIC  X(6).
  1300             20  PI-SCR-STATE        PIC  XX.
  1301             20  PI-SCR-ACCOUNT      PIC  X(10).
  1302             20  PI-SCR-FIN-RESP     PIC  X(10).
  1303             20  PI-SCR-TYPE         PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL642T.cbl
  1304         16  PI-TRANSFER-SW          PIC  X.
  1305             88  PI-TRANSFER-BEFORE-ACT  VALUE 'Y'.
  1306         16  FILLER                  PIC  X(307).
  1307
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL642T.cbl
  1309*                            COPY ELCJPFX.
  1310******************************************************************
  1311*                                                                *
  1312*                                                                *
  1313*                            ELCJPFX.                            *
  1314*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1315*                            VMOD=2.002                          *
  1316*                                                                *
  1317*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1318*                                                                *
  1319*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1320*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1321*        ELCNTL - CONTROL FILE                                   *
  1322*        ELMSTR - CLAIM MASTERS                                  *
  1323*        ELTRLR - ACTIVITY TRAILERS                              *
  1324*        ELCHKQ - CHECK QUE                                      *
  1325******************************************************************
  1326 01  JOURNAL-RECORD.
  1327     12  JP-USER-ID                  PIC X(4).
  1328     12  JP-FILE-ID                  PIC X(8).
  1329     12  JP-PROGRAM-ID               PIC X(8).
  1330     12  JP-RECORD-TYPE              PIC X.
  1331         88 JP-ADD              VALUE 'A'.
  1332         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1333         88 JP-AFTER-CHANGE     VALUE 'C'.
  1334         88 JP-DELETE           VALUE 'D'.
  1335         88 JP-GENERIC-DELETE   VALUE 'G'.
  1336         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1337         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1338     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1339     12  JP-RECORD-AREA
  1340
  1341
  1342                             PIC  X(1464).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL642T.cbl
  1344*                            COPY ELCAID.
  1345******************************************************************
  1346*                                                                *
  1347*                            ELCAID.                             *
  1348*                            VMOD=2.001                          *
  1349*                                                                *
  1350*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1351*                                                                *
  1352*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1353*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1354******************************************************************
  1355
  1356 01  DFHAID.
  1357   02  DFHNULL   PIC  X  VALUE  ' '.
  1358   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1359   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1360   02  DFHPEN    PIC  X  VALUE  '='.
  1361   02  DFHOPID   PIC  X  VALUE  'W'.
  1362   02  DFHPA1    PIC  X  VALUE  '%'.
  1363   02  DFHPA2    PIC  X  VALUE  '>'.
  1364   02  DFHPA3    PIC  X  VALUE  ','.
  1365   02  DFHPF1    PIC  X  VALUE  '1'.
  1366   02  DFHPF2    PIC  X  VALUE  '2'.
  1367   02  DFHPF3    PIC  X  VALUE  '3'.
  1368   02  DFHPF4    PIC  X  VALUE  '4'.
  1369   02  DFHPF5    PIC  X  VALUE  '5'.
  1370   02  DFHPF6    PIC  X  VALUE  '6'.
  1371   02  DFHPF7    PIC  X  VALUE  '7'.
  1372   02  DFHPF8    PIC  X  VALUE  '8'.
  1373   02  DFHPF9    PIC  X  VALUE  '9'.
  1374   02  DFHPF10   PIC  X  VALUE  ':'.
  1375   02  DFHPF11   PIC  X  VALUE  '#'.
  1376   02  DFHPF12   PIC  X  VALUE  '@'.
  1377   02  DFHPF13   PIC  X  VALUE  'A'.
  1378   02  DFHPF14   PIC  X  VALUE  'B'.
  1379   02  DFHPF15   PIC  X  VALUE  'C'.
  1380   02  DFHPF16   PIC  X  VALUE  'D'.
  1381   02  DFHPF17   PIC  X  VALUE  'E'.
  1382   02  DFHPF18   PIC  X  VALUE  'F'.
  1383   02  DFHPF19   PIC  X  VALUE  'G'.
  1384   02  DFHPF20   PIC  X  VALUE  'H'.
  1385   02  DFHPF21   PIC  X  VALUE  'I'.
  1386*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1387   02  DFHPF22   PIC  X  VALUE  '['.
  1388   02  DFHPF23   PIC  X  VALUE  '.'.
  1389   02  DFHPF24   PIC  X  VALUE  '<'.
  1390   02  DFHMSRE   PIC  X  VALUE  'X'.
  1391   02  DFHSTRF   PIC  X  VALUE  'h'.
  1392   02  DFHTRIG   PIC  X  VALUE  '"'.
  1393
  1394 01  FILLER  REDEFINES  DFHAID.
  1395     12  FILLER              PIC  X(8).
  1396     12  PF-VALUES           PIC  X      OCCURS  2  TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL642T.cbl
  1398*                            COPY EL642S.
  1399 01  EL642AI.
  1400     05  FILLER            PIC  X(0012).
  1401*    -------------------------------
  1402     05  ADATEL PIC S9(0004) COMP.
  1403     05  ADATEF PIC  X(0001).
  1404     05  FILLER REDEFINES ADATEF.
  1405         10  ADATEA PIC  X(0001).
  1406     05  ADATEI PIC  X(0008).
  1407*    -------------------------------
  1408     05  ATIMEL PIC S9(0004) COMP.
  1409     05  ATIMEF PIC  X(0001).
  1410     05  FILLER REDEFINES ATIMEF.
  1411         10  ATIMEA PIC  X(0001).
  1412     05  ATIMEI PIC  X(0005).
  1413*    -------------------------------
  1414     05  CMPNYIDL PIC S9(0004) COMP.
  1415     05  CMPNYIDF PIC  X(0001).
  1416     05  FILLER REDEFINES CMPNYIDF.
  1417         10  CMPNYIDA PIC  X(0001).
  1418     05  CMPNYIDI PIC  X(0003).
  1419*    -------------------------------
  1420     05  USERIDL PIC S9(0004) COMP.
  1421     05  USERIDF PIC  X(0001).
  1422     05  FILLER REDEFINES USERIDF.
  1423         10  USERIDA PIC  X(0001).
  1424     05  USERIDI PIC  X(0004).
  1425*    -------------------------------
  1426     05  ABEGBALL PIC S9(0004) COMP.
  1427     05  ABEGBALF PIC  X(0001).
  1428     05  FILLER REDEFINES ABEGBALF.
  1429         10  ABEGBALA PIC  X(0001).
  1430     05  ABEGBALI PIC  X(0010).
  1431*    -------------------------------
  1432     05  ACARHDGL PIC S9(0004) COMP.
  1433     05  ACARHDGF PIC  X(0001).
  1434     05  FILLER REDEFINES ACARHDGF.
  1435         10  ACARHDGA PIC  X(0001).
  1436     05  ACARHDGI PIC  X(0007).
  1437*    -------------------------------
  1438     05  AGRPHDGL PIC S9(0004) COMP.
  1439     05  AGRPHDGF PIC  X(0001).
  1440     05  FILLER REDEFINES AGRPHDGF.
  1441         10  AGRPHDGA PIC  X(0001).
  1442     05  AGRPHDGI PIC  X(0005).
  1443*    -------------------------------
  1444     05  AUPDPRML PIC S9(0004) COMP.
  1445     05  AUPDPRMF PIC  X(0001).
  1446     05  FILLER REDEFINES AUPDPRMF.
  1447         10  AUPDPRMA PIC  X(0001).
  1448     05  AUPDPRMI PIC  X(0010).
  1449*    -------------------------------
  1450     05  AAGENTL PIC S9(0004) COMP.
  1451     05  AAGENTF PIC  X(0001).
  1452     05  FILLER REDEFINES AAGENTF.
  1453         10  AAGENTA PIC  X(0001).
  1454     05  AAGENTI PIC  X(0010).
  1455*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL642T.cbl
  1456     05  ACARIERL PIC S9(0004) COMP.
  1457     05  ACARIERF PIC  X(0001).
  1458     05  FILLER REDEFINES ACARIERF.
  1459         10  ACARIERA PIC  X(0001).
  1460     05  ACARIERI PIC  X(0001).
  1461*    -------------------------------
  1462     05  AGROUPL PIC S9(0004) COMP.
  1463     05  AGROUPF PIC  X(0001).
  1464     05  FILLER REDEFINES AGROUPF.
  1465         10  AGROUPA PIC  X(0001).
  1466     05  AGROUPI PIC  X(0006).
  1467*    -------------------------------
  1468     05  AUPDCOML PIC S9(0004) COMP.
  1469     05  AUPDCOMF PIC  X(0001).
  1470     05  FILLER REDEFINES AUPDCOMF.
  1471         10  AUPDCOMA PIC  X(0001).
  1472     05  AUPDCOMI PIC  X(0010).
  1473*    -------------------------------
  1474     05  APREMUML PIC S9(0004) COMP.
  1475     05  APREMUMF PIC  X(0001).
  1476     05  FILLER REDEFINES APREMUMF.
  1477         10  APREMUMA PIC  X(0001).
  1478     05  APREMUMI PIC  X(0010).
  1479*    -------------------------------
  1480     05  ACOMPISL PIC S9(0004) COMP.
  1481     05  ACOMPISF PIC  X(0001).
  1482     05  FILLER REDEFINES ACOMPISF.
  1483         10  ACOMPISA PIC  X(0001).
  1484     05  ACOMPISI PIC  X(0010).
  1485*    -------------------------------
  1486     05  ACOMCANL PIC S9(0004) COMP.
  1487     05  ACOMCANF PIC  X(0001).
  1488     05  FILLER REDEFINES ACOMCANF.
  1489         10  ACOMCANA PIC  X(0001).
  1490     05  ACOMCANI PIC  X(0010).
  1491*    -------------------------------
  1492     05  ABILL1L PIC S9(0004) COMP.
  1493     05  ABILL1F PIC  X(0001).
  1494     05  FILLER REDEFINES ABILL1F.
  1495         10  ABILL1A PIC  X(0001).
  1496     05  ABILL1I PIC  X(0005).
  1497*    -------------------------------
  1498     05  AINER1L PIC S9(0004) COMP.
  1499     05  AINER1F PIC  X(0001).
  1500     05  FILLER REDEFINES AINER1F.
  1501         10  AINER1A PIC  X(0001).
  1502     05  AINER1I PIC  X(0005).
  1503*    -------------------------------
  1504     05  APRVBL1L PIC S9(0004) COMP.
  1505     05  APRVBL1F PIC  X(0001).
  1506     05  FILLER REDEFINES APRVBL1F.
  1507         10  APRVBL1A PIC  X(0001).
  1508     05  APRVBL1I PIC  X(0005).
  1509*    -------------------------------
  1510     05  AADJUSTL PIC S9(0004) COMP.
  1511     05  AADJUSTF PIC  X(0001).
  1512     05  FILLER REDEFINES AADJUSTF.
  1513         10  AADJUSTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL642T.cbl
  1514     05  AADJUSTI PIC  X(0010).
  1515*    -------------------------------
  1516     05  ABILL2L PIC S9(0004) COMP.
  1517     05  ABILL2F PIC  X(0001).
  1518     05  FILLER REDEFINES ABILL2F.
  1519         10  ABILL2A PIC  X(0001).
  1520     05  ABILL2I PIC  X(0005).
  1521*    -------------------------------
  1522     05  AINER2L PIC S9(0004) COMP.
  1523     05  AINER2F PIC  X(0001).
  1524     05  FILLER REDEFINES AINER2F.
  1525         10  AINER2A PIC  X(0001).
  1526     05  AINER2I PIC  X(0005).
  1527*    -------------------------------
  1528     05  APRVBL2L PIC S9(0004) COMP.
  1529     05  APRVBL2F PIC  X(0001).
  1530     05  FILLER REDEFINES APRVBL2F.
  1531         10  APRVBL2A PIC  X(0001).
  1532     05  APRVBL2I PIC  X(0005).
  1533*    -------------------------------
  1534     05  AREMITL PIC S9(0004) COMP.
  1535     05  AREMITF PIC  X(0001).
  1536     05  FILLER REDEFINES AREMITF.
  1537         10  AREMITA PIC  X(0001).
  1538     05  AREMITI PIC  X(0010).
  1539*    -------------------------------
  1540     05  ADISBURL PIC S9(0004) COMP.
  1541     05  ADISBURF PIC  X(0001).
  1542     05  FILLER REDEFINES ADISBURF.
  1543         10  ADISBURA PIC  X(0001).
  1544     05  ADISBURI PIC  X(0010).
  1545*    -------------------------------
  1546     05  AACTHDGL PIC S9(0004) COMP.
  1547     05  AACTHDGF PIC  X(0001).
  1548     05  FILLER REDEFINES AACTHDGF.
  1549         10  AACTHDGA PIC  X(0001).
  1550     05  AACTHDGI PIC  X(0029).
  1551*    -------------------------------
  1552     05  AACTDUEL PIC S9(0004) COMP.
  1553     05  AACTDUEF PIC  X(0001).
  1554     05  FILLER REDEFINES AACTDUEF.
  1555         10  AACTDUEA PIC  X(0001).
  1556     05  AACTDUEI PIC  X(0010).
  1557*    -------------------------------
  1558     05  AENDHDGL PIC S9(0004) COMP.
  1559     05  AENDHDGF PIC  X(0001).
  1560     05  FILLER REDEFINES AENDHDGF.
  1561         10  AENDHDGA PIC  X(0001).
  1562     05  AENDHDGI PIC  X(0018).
  1563*    -------------------------------
  1564     05  ANETDUEL PIC S9(0004) COMP.
  1565     05  ANETDUEF PIC  X(0001).
  1566     05  FILLER REDEFINES ANETDUEF.
  1567         10  ANETDUEA PIC  X(0001).
  1568     05  ANETDUEI PIC  X(0010).
  1569*    -------------------------------
  1570     05  ABILTYPL PIC S9(0004) COMP.
  1571     05  ABILTYPF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL642T.cbl
  1572     05  FILLER REDEFINES ABILTYPF.
  1573         10  ABILTYPA PIC  X(0001).
  1574     05  ABILTYPI PIC  X(0001).
  1575*    -------------------------------
  1576     05  APRODSWL PIC S9(0004) COMP.
  1577     05  APRODSWF PIC  X(0001).
  1578     05  FILLER REDEFINES APRODSWF.
  1579         10  APRODSWA PIC  X(0001).
  1580     05  APRODSWI PIC  X(0001).
  1581*    -------------------------------
  1582     05  AACCT1L PIC S9(0004) COMP.
  1583     05  AACCT1F PIC  X(0001).
  1584     05  FILLER REDEFINES AACCT1F.
  1585         10  AACCT1A PIC  X(0001).
  1586     05  AACCT1I PIC  X(0010).
  1587*    -------------------------------
  1588     05  AACCT2L PIC S9(0004) COMP.
  1589     05  AACCT2F PIC  X(0001).
  1590     05  FILLER REDEFINES AACCT2F.
  1591         10  AACCT2A PIC  X(0001).
  1592     05  AACCT2I PIC  X(0010).
  1593*    -------------------------------
  1594     05  AACCT3L PIC S9(0004) COMP.
  1595     05  AACCT3F PIC  X(0001).
  1596     05  FILLER REDEFINES AACCT3F.
  1597         10  AACCT3A PIC  X(0001).
  1598     05  AACCT3I PIC  X(0010).
  1599*    -------------------------------
  1600     05  AUNKNERL PIC S9(0004) COMP.
  1601     05  AUNKNERF PIC  X(0001).
  1602     05  FILLER REDEFINES AUNKNERF.
  1603         10  AUNKNERA PIC  X(0001).
  1604     05  AUNKNERI PIC  X(0008).
  1605*    -------------------------------
  1606     05  AERMSG1L PIC S9(0004) COMP.
  1607     05  AERMSG1F PIC  X(0001).
  1608     05  FILLER REDEFINES AERMSG1F.
  1609         10  AERMSG1A PIC  X(0001).
  1610     05  AERMSG1I PIC  X(0076).
  1611*    -------------------------------
  1612     05  AERMSG2L PIC S9(0004) COMP.
  1613     05  AERMSG2F PIC  X(0001).
  1614     05  FILLER REDEFINES AERMSG2F.
  1615         10  AERMSG2A PIC  X(0001).
  1616     05  AERMSG2I PIC  X(0076).
  1617*    -------------------------------
  1618     05  APFNTERL PIC S9(0004) COMP.
  1619     05  APFNTERF PIC  X(0001).
  1620     05  FILLER REDEFINES APFNTERF.
  1621         10  APFNTERA PIC  X(0001).
  1622     05  APFNTERI PIC  9(2).
  1623 01  EL642AO REDEFINES EL642AI.
  1624     05  FILLER            PIC  X(0012).
  1625*    -------------------------------
  1626     05  FILLER            PIC  X(0003).
  1627     05  ADATEO PIC  X(0008).
  1628*    -------------------------------
  1629     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL642T.cbl
  1630     05  ATIMEO PIC  99.99.
  1631*    -------------------------------
  1632     05  FILLER            PIC  X(0003).
  1633     05  CMPNYIDO PIC  X(0003).
  1634*    -------------------------------
  1635     05  FILLER            PIC  X(0003).
  1636     05  USERIDO PIC  X(0004).
  1637*    -------------------------------
  1638     05  FILLER            PIC  X(0003).
  1639     05  ABEGBALO PIC  ZZZZZ9.99-.
  1640*    -------------------------------
  1641     05  FILLER            PIC  X(0003).
  1642     05  ACARHDGO PIC  X(0007).
  1643*    -------------------------------
  1644     05  FILLER            PIC  X(0003).
  1645     05  AGRPHDGO PIC  X(0005).
  1646*    -------------------------------
  1647     05  FILLER            PIC  X(0003).
  1648     05  AUPDPRMO PIC  ZZZZZ9.99-.
  1649*    -------------------------------
  1650     05  FILLER            PIC  X(0003).
  1651     05  AAGENTO PIC  X(0010).
  1652*    -------------------------------
  1653     05  FILLER            PIC  X(0003).
  1654     05  ACARIERO PIC  X(0001).
  1655*    -------------------------------
  1656     05  FILLER            PIC  X(0003).
  1657     05  AGROUPO PIC  X(0006).
  1658*    -------------------------------
  1659     05  FILLER            PIC  X(0003).
  1660     05  AUPDCOMO PIC  ZZZZZ9.99-.
  1661*    -------------------------------
  1662     05  FILLER            PIC  X(0003).
  1663     05  APREMUMO PIC  ZZZZZ9.99-.
  1664*    -------------------------------
  1665     05  FILLER            PIC  X(0003).
  1666     05  ACOMPISO PIC  ZZZZZ9.99-.
  1667*    -------------------------------
  1668     05  FILLER            PIC  X(0003).
  1669     05  ACOMCANO PIC  ZZZZZ9.99-.
  1670*    -------------------------------
  1671     05  FILLER            PIC  X(0003).
  1672     05  ABILL1O PIC  Z,ZZZ.
  1673*    -------------------------------
  1674     05  FILLER            PIC  X(0003).
  1675     05  AINER1O PIC  Z,ZZZ.
  1676*    -------------------------------
  1677     05  FILLER            PIC  X(0003).
  1678     05  APRVBL1O PIC  Z,ZZZ.
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
  1681     05  AADJUSTO PIC  ZZZZZ9.99-.
  1682*    -------------------------------
  1683     05  FILLER            PIC  X(0003).
  1684     05  ABILL2O PIC  Z,ZZZ.
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  AINER2O PIC  Z,ZZZ.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL642T.cbl
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  APRVBL2O PIC  Z,ZZZ.
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  AREMITO PIC  ZZZZZ9.99-.
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  ADISBURO PIC  ZZZZZ9.99-.
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  AACTHDGO PIC  X(0029).
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  AACTDUEO PIC  ZZZZZ9.99-.
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  AENDHDGO PIC  X(0018).
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  ANETDUEO PIC  ZZZZZ9.99-.
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  ABILTYPO PIC  X(0001).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  APRODSWO PIC  X(0001).
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  AACCT1O PIC  X(0010).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  AACCT2O PIC  X(0010).
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  AACCT3O PIC  X(0010).
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  AUNKNERO PIC  ZZZ,ZZZ-.
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  AERMSG1O PIC  X(0076).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  AERMSG2O PIC  X(0076).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  APFNTERO PIC  99.
  1736*    -------------------------------
  1737 01  EL642BI REDEFINES EL642AI.
  1738     05  FILLER            PIC  X(0012).
  1739*    -------------------------------
  1740     05  BDATEL PIC S9(0004) COMP.
  1741     05  BDATEF PIC  X(0001).
  1742     05  FILLER REDEFINES BDATEF.
  1743         10  BDATEA PIC  X(0001).
  1744     05  BDATEI PIC  X(0008).
  1745*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL642T.cbl
  1746     05  BTIMEL PIC S9(0004) COMP.
  1747     05  BTIMEF PIC  X(0001).
  1748     05  FILLER REDEFINES BTIMEF.
  1749         10  BTIMEA PIC  X(0001).
  1750     05  BTIMEI PIC  X(0005).
  1751*    -------------------------------
  1752     05  BCMPNYL PIC S9(0004) COMP.
  1753     05  BCMPNYF PIC  X(0001).
  1754     05  FILLER REDEFINES BCMPNYF.
  1755         10  BCMPNYA PIC  X(0001).
  1756     05  BCMPNYI PIC  X(0003).
  1757*    -------------------------------
  1758     05  BUSERIDL PIC S9(0004) COMP.
  1759     05  BUSERIDF PIC  X(0001).
  1760     05  FILLER REDEFINES BUSERIDF.
  1761         10  BUSERIDA PIC  X(0001).
  1762     05  BUSERIDI PIC  X(0004).
  1763*    -------------------------------
  1764     05  BCHKNOL PIC S9(0004) COMP.
  1765     05  BCHKNOF PIC  X(0001).
  1766     05  FILLER REDEFINES BCHKNOF.
  1767         10  BCHKNOA PIC  X(0001).
  1768     05  BCHKNOI PIC  9(6).
  1769*    -------------------------------
  1770     05  BNAMEL PIC S9(0004) COMP.
  1771     05  BNAMEF PIC  X(0001).
  1772     05  FILLER REDEFINES BNAMEF.
  1773         10  BNAMEA PIC  X(0001).
  1774     05  BNAMEI PIC  X(0029).
  1775*    -------------------------------
  1776     05  BCHKAMTL PIC S9(0004) COMP.
  1777     05  BCHKAMTF PIC  X(0001).
  1778     05  FILLER REDEFINES BCHKAMTF.
  1779         10  BCHKAMTA PIC  X(0001).
  1780     05  BCHKAMTI PIC  9(7)V99.
  1781*    -------------------------------
  1782     05  BADDR1L PIC S9(0004) COMP.
  1783     05  BADDR1F PIC  X(0001).
  1784     05  FILLER REDEFINES BADDR1F.
  1785         10  BADDR1A PIC  X(0001).
  1786     05  BADDR1I PIC  X(0029).
  1787*    -------------------------------
  1788     05  BADDR2L PIC S9(0004) COMP.
  1789     05  BADDR2F PIC  X(0001).
  1790     05  FILLER REDEFINES BADDR2F.
  1791         10  BADDR2A PIC  X(0001).
  1792     05  BADDR2I PIC  X(0029).
  1793*    -------------------------------
  1794     05  BPAYDT1L PIC S9(0004) COMP.
  1795     05  BPAYDT1F PIC  X(0001).
  1796     05  FILLER REDEFINES BPAYDT1F.
  1797         10  BPAYDT1A PIC  X(0001).
  1798     05  BPAYDT1I PIC  X(0008).
  1799*    -------------------------------
  1800     05  BCITYSTL PIC S9(0004) COMP.
  1801     05  BCITYSTF PIC  X(0001).
  1802     05  FILLER REDEFINES BCITYSTF.
  1803         10  BCITYSTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL642T.cbl
  1804     05  BCITYSTI PIC  X(0029).
  1805*    -------------------------------
  1806     05  BPAYDT2L PIC S9(0004) COMP.
  1807     05  BPAYDT2F PIC  X(0001).
  1808     05  FILLER REDEFINES BPAYDT2F.
  1809         10  BPAYDT2A PIC  X(0001).
  1810     05  BPAYDT2I PIC  X(0008).
  1811*    -------------------------------
  1812     05  BZIPL PIC S9(0004) COMP.
  1813     05  BZIPF PIC  X(0001).
  1814     05  FILLER REDEFINES BZIPF.
  1815         10  BZIPA PIC  X(0001).
  1816     05  BZIPI PIC  X(0009).
  1817*    -------------------------------
  1818     05  BALAMTL PIC S9(0004) COMP.
  1819     05  BALAMTF PIC  X(0001).
  1820     05  FILLER REDEFINES BALAMTF.
  1821         10  BALAMTA PIC  X(0001).
  1822     05  BALAMTI PIC  X(0010).
  1823*    -------------------------------
  1824     05  BERMSGL PIC S9(0004) COMP.
  1825     05  BERMSGF PIC  X(0001).
  1826     05  FILLER REDEFINES BERMSGF.
  1827         10  BERMSGA PIC  X(0001).
  1828     05  BERMSGI PIC  X(0078).
  1829*    -------------------------------
  1830     05  BPFNTERL PIC S9(0004) COMP.
  1831     05  BPFNTERF PIC  X(0001).
  1832     05  FILLER REDEFINES BPFNTERF.
  1833         10  BPFNTERA PIC  X(0001).
  1834     05  BPFNTERI PIC  9(2).
  1835 01  EL642BO REDEFINES EL642AI.
  1836     05  FILLER            PIC  X(0012).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  BDATEO PIC  X(0008).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  BTIMEO PIC  99.99.
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  BCMPNYO PIC  X(0003).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  BUSERIDO PIC  X(0004).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  BCHKNOO PIC  X(0006).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  BNAMEO PIC  X(0029).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  BCHKAMTO PIC  Z(6).99.
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  BADDR1O PIC  X(0029).
  1861*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL642T.cbl
  1862     05  FILLER            PIC  X(0003).
  1863     05  BADDR2O PIC  X(0029).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  BPAYDT1O PIC  X(0008).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  BCITYSTO PIC  X(0029).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  BPAYDT2O PIC  X(0008).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  BZIPO PIC  X(0009).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  BALAMTO PIC  Z(6).99-.
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  BERMSGO PIC  X(0078).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  BPFNTERO PIC  9(2).
  1885*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL642T.cbl
  1887****************************************************************
  1888*
  1889* Copyright (c) 2007 by Clerity Solutions, Inc.
  1890* All rights reserved.
  1891*
  1892****************************************************************
  1893 01  DFHEIV.
  1894   02  DFHEIV0               PIC X(35).
  1895   02  DFHEIV1               PIC X(08).
  1896   02  DFHEIV2               PIC X(08).
  1897   02  DFHEIV3               PIC X(08).
  1898   02  DFHEIV4               PIC X(06).
  1899   02  DFHEIV5               PIC X(04).
  1900   02  DFHEIV6               PIC X(04).
  1901   02  DFHEIV7               PIC X(02).
  1902   02  DFHEIV8               PIC X(02).
  1903   02  DFHEIV9               PIC X(01).
  1904   02  DFHEIV10              PIC S9(7) COMP-3.
  1905   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1906   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1907   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1908   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1909   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1910   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1911   02  DFHEIV17              PIC X(04).
  1912   02  DFHEIV18              PIC X(04).
  1913   02  DFHEIV19              PIC X(04).
  1914   02  DFHEIV20              USAGE IS POINTER.
  1915   02  DFHEIV21              USAGE IS POINTER.
  1916   02  DFHEIV22              USAGE IS POINTER.
  1917   02  DFHEIV23              USAGE IS POINTER.
  1918   02  DFHEIV24              USAGE IS POINTER.
  1919   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1920   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1921   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1922   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1923   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1924   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1925   02  FILLER                PIC X(02).
  1926   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1927   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1928   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1929   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1930   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1931 LINKAGE  SECTION.
  1932*****************************************************************
  1933*                                                               *
  1934* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1935* All rights reserved.                                          *
  1936*                                                               *
  1937*****************************************************************
  1938 01  dfheiblk.
  1939     02  eibtime          pic s9(7) comp-3.
  1940     02  eibdate          pic s9(7) comp-3.
  1941     02  eibtrnid         pic x(4).
  1942     02  eibtaskn         pic s9(7) comp-3.
  1943     02  eibtrmid         pic x(4).
  1944     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL642T.cbl
  1945     02  eibcposn         pic s9(4) comp.
  1946     02  eibcalen         pic s9(4) comp.
  1947     02  eibaid           pic x(1).
  1948     02  eibfiller1       pic x(1).
  1949     02  eibfn            pic x(2).
  1950     02  eibfiller2       pic x(2).
  1951     02  eibrcode         pic x(6).
  1952     02  eibfiller3       pic x(2).
  1953     02  eibds            pic x(8).
  1954     02  eibreqid         pic x(8).
  1955     02  eibrsrce         pic x(8).
  1956     02  eibsync          pic x(1).
  1957     02  eibfree          pic x(1).
  1958     02  eibrecv          pic x(1).
  1959     02  eibsend          pic x(1).
  1960     02  eibatt           pic x(1).
  1961     02  eibeoc           pic x(1).
  1962     02  eibfmh           pic x(1).
  1963     02  eibcompl         pic x(1).
  1964     02  eibsig           pic x(1).
  1965     02  eibconf          pic x(1).
  1966     02  eiberr           pic x(1).
  1967     02  eibrldbk         pic x(1).
  1968     02  eiberrcd         pic x(4).
  1969     02  eibsynrb         pic x(1).
  1970     02  eibnodat         pic x(1).
  1971     02  eibfiller5       pic x(2).
  1972     02  eibresp          pic 9(09) comp.
  1973     02  eibresp2         pic 9(09) comp.
  1974     02  dfheigdj         pic s9(4) comp.
  1975     02  dfheigdk         pic s9(4) comp.
  1976
  1977 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL642T.cbl
  1979*01 PARMLIST             COMP.
  1980*    12  FILLER              PIC S9(8).
  1981*    12  ERPNDB-POINTER      PIC S9(8).
  1982*    12  ELCNTL-POINTER      PIC S9(8).
  1983*    12  ERCOMP-POINTER      PIC S9(8).
  1984*    12  ERPYAJ-POINTER      PIC S9(8).
  1985*    12  ERACCT-POINTER      PIC S9(8).
  1986*    12  ERBILL-POINTER      PIC S9(8).
  1987*    12  ERCOMM-POINTER      PIC S9(8).
  1988*    12  ERCTBL-POINTER      PIC S9(8).
  1989*    12  ERGXRF-POINTER      PIC S9(8).
  1990*    12  ERGXRF2-POINTER     PIC S9(8).
  1991*    12  ERGXRF3-POINTER     PIC S9(8).
  1992*    12  ERGXRF4-POINTER     PIC S9(8).
  1993*    12  ERGXRF5-POINTER     PIC S9(8).
  1994*    12  ERGXRF6-POINTER     PIC S9(8).
  1995*    12  ERGXRF7-POINTER     PIC S9(8).
  1996*    12  ERGXRF8-POINTER     PIC S9(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL642T.cbl
  1998*                            COPY ERCPNDB.
  1999******************************************************************
  2000*                                                                *
  2001*                                                                *
  2002*                            ERCPNDB.                            *
  2003*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2004*                            VMOD=2.025                          *
  2005*                                                                *
  2006*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  2007*                                                                *
  2008******************************************************************
  2009*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  2010*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  2011******************************************************************
  2012*                                                                *
  2013*                                                                *
  2014*   FILE TYPE = VSAM,KSDS                                        *
  2015*   RECORD SIZE = 585  RECFORM = FIXED                           *
  2016*                                                                *
  2017*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  2018*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  2019*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  2020*                                                 RKP=13,LEN=36  *
  2021*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  2022*                                      AND CHG-SEQ.)             *
  2023*                                                RKP=49,LEN=11   *
  2024*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  2025*                                      AND CHG-SEQ.)             *
  2026*                                                RKP=60,LEN=15   *
  2027*                                                                *
  2028*   LOG = NO                                                     *
  2029*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2030******************************************************************
  2031******************************************************************
  2032*                   C H A N G E   L O G
  2033*
  2034* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2035*-----------------------------------------------------------------
  2036*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2037* EFFECTIVE    NUMBER
  2038*-----------------------------------------------------------------
  2039* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2040* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2041* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2042* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2043* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  2044* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2045* 032306                   PEMA  ADD BOW LOAN NUMBER
  2046* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  2047* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  2048* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2049* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2050* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  2051* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  2052* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2053******************************************************************
  2054
  2055 01  PENDING-BUSINESS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL642T.cbl
  2056     12  PB-RECORD-ID                     PIC XX.
  2057         88  VALID-PB-ID                        VALUE 'PB'.
  2058
  2059     12  PB-CONTROL-PRIMARY.
  2060         16  PB-COMPANY-CD                PIC X.
  2061         16  PB-ENTRY-BATCH               PIC X(6).
  2062         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  2063         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  2064
  2065     12  PB-CONTROL-BY-ACCOUNT.
  2066         16  PB-COMPANY-CD-A1             PIC X.
  2067         16  PB-CARRIER                   PIC X.
  2068         16  PB-GROUPING.
  2069             20  PB-GROUPING-PREFIX       PIC XXX.
  2070             20  PB-GROUPING-PRIME        PIC XXX.
  2071         16  PB-STATE                     PIC XX.
  2072         16  PB-ACCOUNT.
  2073             20  PB-ACCOUNT-PREFIX        PIC X(4).
  2074             20  PB-ACCOUNT-PRIME         PIC X(6).
  2075         16  PB-CERT-EFF-DT               PIC XX.
  2076         16  PB-CERT-NO.
  2077             20  PB-CERT-PRIME            PIC X(10).
  2078             20  PB-CERT-SFX              PIC X.
  2079         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  2080
  2081         16  PB-RECORD-TYPE               PIC X.
  2082             88  PB-MAILING-DATA                VALUE '0'.
  2083             88  PB-ISSUE                       VALUE '1'.
  2084             88  PB-CANCELLATION                VALUE '2'.
  2085             88  PB-BATCH-TRAILER               VALUE '9'.
  2086
  2087     12  PB-CONTROL-BY-ORIG-BATCH.
  2088         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  2089         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  2090         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  2091         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  2092
  2093     12  PB-CONTROL-BY-CSR.
  2094         16  PB-CSR-COMPANY-CD            PIC X.
  2095         16  PB-CSR-ID                    PIC X(4).
  2096         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  2097         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  2098         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  2099******************************************************************
  2100*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  2101******************************************************************
  2102
  2103     12  PB-LAST-MAINT-DT                 PIC XX.
  2104     12  PB-LAST-MAINT-BY                 PIC X(4).
  2105     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2106
  2107     12  PB-RECORD-BODY                   PIC X(375).
  2108
  2109     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  2110         16  PB-CERT-ORIGIN               PIC X.
  2111             88  CLASIC-CREATED-CERT         VALUE '1'.
  2112         16  PB-I-NAME.
  2113             20  PB-I-INSURED-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL642T.cbl
  2114             20  PB-I-INSURED-FIRST-NAME.
  2115                 24  PB-I-INSURED-1ST-INIT PIC X.
  2116                 24  FILLER                PIC X(9).
  2117             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  2118         16  PB-I-AGE                     PIC S99   COMP-3.
  2119         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  2120         16  PB-I-BIRTHDAY                PIC XX.
  2121         16  PB-I-INSURED-SEX             PIC X.
  2122             88  PB-SEX-MALE     VALUE 'M'.
  2123             88  PB-SEX-FEMALE   VALUE 'F'.
  2124
  2125         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  2126         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  2127         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  2128         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  2129         16  PB-I-SKIP-CODE               PIC X.
  2130             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  2131             88  PB-SKIP-JULY              VALUE '1'.
  2132             88  PB-SKIP-AUGUST            VALUE '2'.
  2133             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  2134             88  PB-SKIP-JULY-AUG          VALUE '4'.
  2135             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  2136             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  2137             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  2138             88  PB-SKIP-JUNE              VALUE '8'.
  2139             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  2140             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  2141             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  2142         16  PB-I-TERM-TYPE               PIC X.
  2143             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  2144             88  PB-PAID-WEEKLY            VALUE 'W'.
  2145             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  2146             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  2147             88  PB-PAID-13-YEARLY         VALUE 'T'.
  2148         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  2149         16  PB-I-POLICY-FORM-NO          PIC X(12).
  2150         16  PB-I-DATA-ENTRY-SW           PIC X.
  2151             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  2152             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  2153             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  2154             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  2155         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  2156         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  2157*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  2158         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  2159         16  FILLER                       PIC X.
  2160
  2161         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  2162             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  2163             88  PB-INVALID-LIFE             VALUE '  ' '00'
  2164                                                   '90' THRU '99'.
  2165         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  2166                                          PIC XX.
  2167         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2168         16  PB-I-AMOUNT-FINANCED REDEFINES
  2169                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  2170         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  2171         16  PB-I-UNPAID-CASH-PRICE REDEFINES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL642T.cbl
  2172                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  2173         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2174         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  2175         16  PB-I-CLP-AMOUNT REDEFINES
  2176                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  2177         16  PB-I-LF-CALC-FLAG            PIC X.
  2178             88 PB-COMP-LF-PREM               VALUE '?'.
  2179         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2180         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2181         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2182         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2183         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2184         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2185         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2186         16  PB-I-LF-ABBR                 PIC XXX.
  2187         16  PB-I-LF-INPUT-CD             PIC XX.
  2188
  2189         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2190             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2191             88  PB-INVALID-AH               VALUE '  ' '00'
  2192                                                   '90' THRU '99'.
  2193         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2194         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2195         16  PB-I-AH-CALC-FLAG            PIC X.
  2196             88 PB-COMP-AH-PREM                  VALUE '?'.
  2197         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2198         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2199         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2200         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2201         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2202         16  PB-I-AH-ABBR                 PIC XXX.
  2203         16  PB-I-AH-INPUT-CD             PIC XXX.
  2204
  2205         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2206         16  PB-I-REIN-TABLE              PIC XXX.
  2207         16  PB-I-BUSINESS-TYPE           PIC 99.
  2208         16  PB-I-INDV-GRP-CD             PIC X.
  2209         16  PB-I-MORT-CODE.
  2210             20  PB-I-TABLE               PIC X.
  2211             20  PB-I-INTEREST            PIC XX.
  2212             20  PB-I-MORT-TYP            PIC X.
  2213         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2214         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2215         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2216         16  PB-I-INDV-GRP-OVRD           PIC X.
  2217         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2218         16  PB-I-SIG-SW                  PIC X.
  2219             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2220         16  PB-I-RATE-CLASS              PIC XX.
  2221         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2222         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2223         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2224         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2225         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2226         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2227         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  2228         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2229         16  PB-I-OB-FLAG                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL642T.cbl
  2230             88  PB-I-OB                      VALUE 'B'.
  2231             88  PB-I-SUMMARY                 VALUE 'Z'.
  2232         16  PB-I-ENTRY-STATUS            PIC X.
  2233             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2234                                              'M' '5' '9' '2'.
  2235             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2236             88  PB-I-POLICY-PENDING          VALUE '2'.
  2237             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2238             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2239             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2240             88  PB-I-REIN-ONLY               VALUE '9'.
  2241             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2242             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2243             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2244             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2245         16  PB-I-INT-CODE                PIC X.
  2246             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2247             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2248         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2249         16  PB-I-SOC-SEC-NO              PIC X(11).
  2250         16  PB-I-MEMBER-NO               PIC X(12).
  2251         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2252*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2253         16  PB-I-OLD-LOF                 PIC XXX.
  2254         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2255         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2256         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2257         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2258         16  PB-I-LIFE-INDICATOR          PIC X.
  2259             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2260         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2261         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2262             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2263             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2264         16  PB-I-1ST-PMT-DT              PIC XX.
  2265         16  PB-I-JOINT-INSURED.
  2266             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2267             20 PB-I-JOINT-FIRST-NAME.
  2268                24  PB-I-JOINT-FIRST-INIT PIC X.
  2269                24  FILLER                PIC X(9).
  2270             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2271*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2272         16  PB-I-BENEFICIARY-NAME.
  2273             20  PB-I-BANK-NUMBER         PIC X(10).
  2274             20  FILLER                   PIC X(15).
  2275         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2276         16  PB-I-REFERENCE               PIC X(12).
  2277         16  FILLER REDEFINES PB-I-REFERENCE.
  2278             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2279             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2280             20  PB-I-CLP-STATE           PIC XX.
  2281         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2282             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2283             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  2284             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2285         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2286         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2287         16  PB-I-RESIDENT-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL642T.cbl
  2288         16  PB-I-RATE-CODE               PIC X(4).
  2289         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2290         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2291         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2292         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2293         16  PB-I-BANK-NOCHRGB            PIC 99.
  2294         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2295         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2296
  2297     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2298         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2299             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2300         16  PB-C-CANCEL-ORIGIN           PIC X.
  2301             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2302         16  PB-C-LF-CANCEL-DT            PIC XX.
  2303         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2304         16  PB-C-LF-CALC-REQ             PIC X.
  2305             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2306         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2307         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2308         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2309             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2310         16  PB-C-AH-CANCEL-DT            PIC XX.
  2311         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2312         16  PB-C-AH-CALC-REQ             PIC X.
  2313             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2314         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2315         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2316         16  PB-C-LAST-NAME               PIC X(15).
  2317         16  PB-C-REFUND-SW               PIC X.
  2318             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2319             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2320         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2321         16  PB-C-PAYEE-CODE              PIC X(6).
  2322         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2323         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2324         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2325         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2326         16  PB-C-REFERENCE               PIC X(12).
  2327         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2328         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2329         16  PB-C-POST-CARD-IND           PIC X.
  2330         16  PB-C-CANCEL-REASON           PIC X.
  2331         16  PB-C-REF-INTERFACE-SW        PIC X.
  2332         16  FILLER                       PIC X(09).
  2333*        16  FILLER                       PIC X(18).
  2334         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2335*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2336         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2337         16  PB-CANCELED-CERT-DATA.
  2338             20  PB-CI-INSURED-NAME.
  2339                 24  PB-CI-LAST-NAME      PIC X(15).
  2340                 24  PB-CI-INITIALS       PIC XX.
  2341             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2342             20  PB-CI-INSURED-SEX        PIC X.
  2343             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2344             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2345             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL642T.cbl
  2346             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2347             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2348             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2349             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2350             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2351             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2352             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2353             20  PB-CI-RATE-CLASS         PIC XX.
  2354             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2355             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2356             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2357             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2358             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2359             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2360             20  PB-CI-LF-ABBR            PIC X(3).
  2361             20  PB-CI-AH-ABBR            PIC X(3).
  2362             20  PB-CI-OB-FLAG            PIC X.
  2363                 88  PB-CI-OB                VALUE 'B'.
  2364             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2365                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2366                                           'M' '4' '5' '9' '2'.
  2367                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2368                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2369                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2370                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2371                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2372                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2373                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2374                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2375                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2376                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2377                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2378                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2379             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2380                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2381                                           'M' '4' '5' '9' '2'.
  2382                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2383                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2384                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2385                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2386                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2387                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2388                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2389                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2390                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2391                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2392                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2393                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2394             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2395             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2396             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2397             20  PB-CI-MEMBER-NO          PIC X(12).
  2398             20  PB-CI-INT-CODE           PIC X.
  2399                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2400                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2401             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2402             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2403             20  PB-CI-COMP-EXCP-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL642T.cbl
  2404                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2405                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2406             20  PB-CI-ENTRY-STATUS       PIC X.
  2407             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2408             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2409             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2410             20  PB-CI-DEATH-DT           PIC XX.
  2411             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2412             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2413             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2414             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2415             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2416             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2417             20  PB-CI-ENTRY-DT              PIC XX.
  2418             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2419             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2420             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2421             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2422             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2423             20  PB-CI-OLD-LOF               PIC XXX.
  2424*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2425             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2426             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2427             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2428             20  PB-CI-INDV-GRP-CD           PIC X.
  2429             20  PB-CI-BENEFICIARY-NAME.
  2430                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2431                 24  FILLER                  PIC X(15).
  2432             20  PB-CI-NOTE-SW               PIC X.
  2433             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2434             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2435             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2436             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2437             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2438             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2439             20  PB-CI-FIRST-NAME            PIC X(10).
  2440
  2441         16  FILLER                       PIC X(17).
  2442*032306  16  FILLER                       PIC X(27).
  2443*        16  FILLER                       PIC X(46).
  2444
  2445     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2446         16  FILLER                       PIC X(10).
  2447         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2448         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2449         16  PB-M-INSURED-MID-INIT        PIC X.
  2450         16  PB-M-INSURED-AGE             PIC 99.
  2451         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2452         16  PB-M-INSURED-SEX             PIC X.
  2453         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2454         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  2455         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2456         16  PB-M-INSURED-CITY-STATE.
  2457             20  PB-M-INSURED-CITY        PIC X(28).
  2458             20  PB-M-INSURED-STATE       PIC XX.
  2459         16  PB-M-INSURED-ZIP-CODE.
  2460             20  PB-M-INSURED-ZIP-PRIME.
  2461                 24  PB-M-INSURED-ZIP-1   PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL642T.cbl
  2462                     88  PB-M-CANADIAN-POST-CODE
  2463                                             VALUE 'A' THRU 'Z'.
  2464                 24  FILLER               PIC X(4).
  2465             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2466         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2467                                        PB-M-INSURED-ZIP-CODE.
  2468             20  PM-M-INS-CAN-POST1       PIC XXX.
  2469             20  PM-M-INS-CAN-POST2       PIC XXX.
  2470             20  FILLER                   PIC XXX.
  2471         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2472         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2473         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2474         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2475         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2476         16  PB-M-CRED-BENE-CITYST.
  2477             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2478             20  PB-M-CRED-BENE-STATE     PIC XX.
  2479         16  FILLER                       PIC X(92).
  2480
  2481     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2482         16  FILLER                       PIC X(10).
  2483         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2484         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2485         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2486         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2487         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2488         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2489         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2490         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2491         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2492         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2493         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2494         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2495         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2496         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2497         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2498         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2499         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2500         16  PB-ACCOUNT-NAME              PIC X(30).
  2501         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2502         16  PB-REFERENCE                 PIC X(12).
  2503         16  PB-B-RECEIVED-DT             PIC XX.
  2504         16  FILLER                       PIC X(234).
  2505
  2506     12  PB-RECORD-STATUS.
  2507         16  PB-CREDIT-SELECT-DT          PIC XX.
  2508         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2509         16  PB-BILLED-DT                 PIC XX.
  2510         16  PB-BILLING-STATUS            PIC X.
  2511             88  PB-ENTRY-REVERSED            VALUE 'R'.
  2512             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2513             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2514         16  PB-RECORD-BILL               PIC X.
  2515             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2516             88  PB-RECORD-RETURNED           VALUE 'R'.
  2517             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2518             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2519             88  PB-OVERRIDE-AH               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL642T.cbl
  2520             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2521         16  PB-BATCH-ENTRY               PIC X.
  2522             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2523             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2524             88  PB-REISSUED-CERT             VALUE 'E'.
  2525             88  PB-MONTHLY-CERT              VALUE 'M'.
  2526             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2527             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2528             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2529         16  PB-FORCE-CODE                PIC X.
  2530             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2531             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2532             88  PB-CANCEL-FORCE              VALUE '8'.
  2533             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2534             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2535             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2536             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2537             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2538             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2539             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2540         16  PB-FATAL-FLAG                PIC X.
  2541             88  PB-FATAL-ERRORS              VALUE 'X'.
  2542         16  PB-FORCE-ER-CD               PIC X.
  2543             88  PB-FORCE-ERRORS              VALUE 'F'.
  2544             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2545         16  PB-WARN-ER-CD                PIC X.
  2546             88  PB-WARNING-ERRORS            VALUE 'W'.
  2547         16  FILLER                       PIC X.
  2548         16  PB-OUT-BAL-CD                PIC X.
  2549             88  PB-OUT-OF-BAL                VALUE 'O'.
  2550         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2551         16  PB-AH-OVERRIDE-L1            PIC X.
  2552         16  PB-INPUT-DT                  PIC XX.
  2553         16  PB-INPUT-BY                  PIC X(4).
  2554         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2555         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2556         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2557         16  PB-LF-EARNING-METHOD         PIC X.
  2558         16  PB-AH-EARNING-METHOD         PIC X.
  2559         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2560         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2561         16  PB-REIN-CD                   PIC XXX.
  2562         16  PB-LF-REFUND-TYPE            PIC X.
  2563         16  PB-AH-REFUND-TYPE            PIC X.
  2564         16  PB-ACCT-EFF-DT               PIC XX.
  2565         16  PB-ACCT-EXP-DT               PIC XX.
  2566         16  PB-COMPANY-ID                PIC X(3).
  2567         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2568         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2569         16  PB-SV-CARRIER                PIC X.
  2570         16  PB-SV-GROUPING               PIC X(6).
  2571         16  PB-SV-STATE                  PIC XX.
  2572         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2573         16  PB-GA-BILLING-INFO.
  2574             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2575                                          PIC XX.
  2576         16  PB-SV-REMIT-TO  REDEFINES
  2577             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL642T.cbl
  2578         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2579         16  PB-I-LOAN-OFFICER            PIC X(5).
  2580         16  PB-I-VIN                     PIC X(17).
  2581
  2582         16  FILLER                       PIC X(04).
  2583         16  IMNET-BYPASS-SW              PIC X.
  2584
  2585******************************************************************
  2586*                COMMON EDIT ERRORS                              *
  2587******************************************************************
  2588
  2589     12  PB-COMMON-ERRORS.
  2590         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2591                                           PIC S9(4)     COMP.
  2592
  2593******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL642T.cbl
  2595*                            COPY ELCCNTL.
  2596******************************************************************
  2597*                                                                *
  2598*                                                                *
  2599*                            ELCCNTL.                            *
  2600*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2601*                            VMOD=2.059                          *
  2602*                                                                *
  2603*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2604*                                                                *
  2605*   FILE TYPE = VSAM,KSDS                                        *
  2606*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2607*                                                                *
  2608*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2609*       ALTERNATE INDEX = NONE                                   *
  2610*                                                                *
  2611*   LOG = YES                                                    *
  2612*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2613******************************************************************
  2614*                   C H A N G E   L O G
  2615*
  2616* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2617*-----------------------------------------------------------------
  2618*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2619* EFFECTIVE    NUMBER
  2620*-----------------------------------------------------------------
  2621* 082503                   PEMA  ADD BENEFIT GROUP
  2622* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2623* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2624* 092705    2005050300006  PEMA  ADD SPP LEASES
  2625* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2626* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2627* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2628* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2629******************************************************************
  2630*
  2631 01  CONTROL-FILE.
  2632     12  CF-RECORD-ID                       PIC XX.
  2633         88  VALID-CF-ID                        VALUE 'CF'.
  2634
  2635     12  CF-CONTROL-PRIMARY.
  2636         16  CF-COMPANY-ID                  PIC XXX.
  2637         16  CF-RECORD-TYPE                 PIC X.
  2638             88  CF-COMPANY-MASTER              VALUE '1'.
  2639             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2640             88  CF-STATE-MASTER                VALUE '3'.
  2641             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2642             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2643             88  CF-CARRIER-MASTER              VALUE '6'.
  2644             88  CF-MORTALITY-MASTER            VALUE '7'.
  2645             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2646             88  CF-TERMINAL-MASTER             VALUE '9'.
  2647             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2648             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2649             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2650             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2651             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2652             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL642T.cbl
  2653             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2654             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2655             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2656         16  CF-ACCESS-CD-GENL              PIC X(4).
  2657         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2658             20  CF-PROCESSOR               PIC X(4).
  2659         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2660             20  CF-STATE-CODE              PIC XX.
  2661             20  FILLER                     PIC XX.
  2662         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2663             20  FILLER                     PIC XX.
  2664             20  CF-HI-BEN-IN-REC           PIC XX.
  2665         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2666             20  FILLER                     PIC XXX.
  2667             20  CF-CARRIER-CNTL            PIC X.
  2668         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2669             20  FILLER                     PIC XX.
  2670             20  CF-HI-TYPE-IN-REC          PIC 99.
  2671         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2672             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2673                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2674             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2675             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2676         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2677             20  FILLER                     PIC X.
  2678             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2679         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2680             20  FILLER                     PIC XX.
  2681             20  CF-MORTGAGE-PLAN           PIC XX.
  2682         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2683
  2684     12  CF-LAST-MAINT-DT                   PIC XX.
  2685     12  CF-LAST-MAINT-BY                   PIC X(4).
  2686     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2687
  2688     12  CF-RECORD-BODY                     PIC X(728).
  2689
  2690
  2691****************************************************************
  2692*             COMPANY MASTER RECORD                            *
  2693****************************************************************
  2694
  2695     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2696         16  CF-COMPANY-ADDRESS.
  2697             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2698             20  CF-CL-IN-CARE-OF           PIC X(30).
  2699             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2700             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2701             20  CF-CL-CITY-STATE           PIC X(30).
  2702             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2703             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2704         16  CF-COMPANY-CD                  PIC X.
  2705         16  CF-COMPANY-PASSWORD            PIC X(8).
  2706         16  CF-SECURITY-OPTION             PIC X.
  2707             88  ALL-SECURITY                   VALUE '1'.
  2708             88  COMPANY-VERIFY                 VALUE '2'.
  2709             88  PROCESSOR-VERIFY               VALUE '3'.
  2710             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL642T.cbl
  2711             88  ALL-BUT-TERM                   VALUE '5'.
  2712         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2713             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2714         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2715             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2716         16  CF-INFORCE-LOCATION            PIC X.
  2717             88  CERTS-ARE-ONLINE               VALUE '1'.
  2718             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2719             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2720         16  CF-LOWER-CASE-LETTERS          PIC X.
  2721         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2722             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2723             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2724             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2725             88  CF-ACCNT-CNTL                  VALUE '3'.
  2726             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2727
  2728         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2729         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2730
  2731         16  CF-LGX-CREDIT-USER             PIC X.
  2732             88  CO-IS-NOT-USER                 VALUE 'N'.
  2733             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2734
  2735         16 CF-CREDIT-CALC-CODES.
  2736             20  CF-CR-REM-TERM-CALC PIC X.
  2737               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2738               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2739               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2740               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2741               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2742               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2743               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2744             20  CF-CR-R78-METHOD           PIC X.
  2745               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2746               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2747
  2748         16  CF-CLAIM-CONTROL-COUNTS.
  2749             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2750                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2751
  2752             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2753                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2754
  2755             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2756                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2757
  2758             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2759                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2760
  2761         16  CF-CURRENT-MONTH-END           PIC XX.
  2762
  2763         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2764             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2765             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2766             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2767             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2768                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL642T.cbl
  2769                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2770             20  CF-CO-PREM-REJECT-SW       PIC X.
  2771                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2772                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2773             20  CF-CO-REF-REJECT-SW        PIC X.
  2774                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2775                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2776
  2777         16  CF-CO-REPORTING-DT             PIC XX.
  2778         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2779         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2780           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2781           88  CF-CO-MONTH-END                  VALUE '1'.
  2782
  2783         16  CF-LGX-CLAIM-USER              PIC X.
  2784             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2785             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2786
  2787         16  CF-CREDIT-EDIT-CONTROLS.
  2788             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2789             20  CF-MIN-AGE                 PIC 99.
  2790             20  CF-DEFAULT-AGE             PIC 99.
  2791             20  CF-MIN-TERM                PIC S999      COMP-3.
  2792             20  CF-MAX-TERM                PIC S999      COMP-3.
  2793             20  CF-DEFAULT-SEX             PIC X.
  2794             20  CF-JOINT-AGE-INPUT         PIC X.
  2795                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2796             20  CF-BIRTH-DATE-INPUT        PIC X.
  2797                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2798             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2799                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2800                 88  CF-ZERO-CARRIER            VALUE '1'.
  2801                 88  CF-ZERO-GROUPING           VALUE '2'.
  2802                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2803             20  CF-EDIT-SW                 PIC X.
  2804                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2805             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2806             20  CF-CR-PR-METHOD            PIC X.
  2807               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2808               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2809             20  FILLER                     PIC X.
  2810
  2811         16  CF-CREDIT-MISC-CONTROLS.
  2812             20  CF-REIN-TABLE-SW           PIC X.
  2813                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2814             20  CF-COMP-TABLE-SW           PIC X.
  2815                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2816             20  CF-EXPERIENCE-RETENTION-AGE
  2817                                            PIC S9        COMP-3.
  2818             20  CF-CONVERSION-DT           PIC XX.
  2819             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2820             20  CF-RUN-FREQUENCY-SW        PIC X.
  2821                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2822                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2823
  2824             20  CF-CR-CHECK-NO-CONTROL.
  2825                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2826                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL642T.cbl
  2827                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2828                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2829                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2830                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2831
  2832                 24  CF-CR-CHECK-COUNT       REDEFINES
  2833                     CF-CR-CHECK-COUNTER      PIC X(4).
  2834
  2835                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2836                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2837
  2838                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2839                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2840                 24  CF-MAIL-PROCESSING       PIC X.
  2841                     88  MAIL-PROCESSING          VALUE 'Y'.
  2842
  2843         16  CF-MISC-SYSTEM-CONTROL.
  2844             20  CF-SYSTEM-C                 PIC X.
  2845                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2846             20  CF-SYSTEM-D                 PIC X.
  2847                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2848             20  CF-SOC-SEC-NO-SW            PIC X.
  2849                 88  SOC-SEC-NO-USED             VALUE '1'.
  2850             20  CF-MEMBER-NO-SW             PIC X.
  2851                 88  MEMBER-NO-USED              VALUE '1'.
  2852             20  CF-TAX-ID-NUMBER            PIC X(11).
  2853             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2854             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2855                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2856                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2857                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2858                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2859             20  CF-SYSTEM-E                 PIC X.
  2860                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2861
  2862         16  CF-LGX-LIFE-USER               PIC X.
  2863             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2864             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2865
  2866         16  CF-CR-MONTH-END-DT             PIC XX.
  2867
  2868         16  CF-FILE-MAINT-DATES.
  2869             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2870                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2871             20  CF-LAST-BATCH       REDEFINES
  2872                 CF-LAST-BATCH-NO               PIC X(4).
  2873             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2874             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2875             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2876             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2877             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2878             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2879             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2880             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2881             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2882             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2883
  2884         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL642T.cbl
  2885         16  FILLER                         PIC X.
  2886
  2887         16  CF-ALT-MORT-CODE               PIC X(4).
  2888         16  CF-MEMBER-CAPTION              PIC X(10).
  2889
  2890         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2891             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2892             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2893             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2894             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2895             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2896
  2897         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2898
  2899         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2900         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2901         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2902         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2903
  2904         16  CF-AH-OVERRIDE-L1              PIC X.
  2905         16  CF-AH-OVERRIDE-L2              PIC XX.
  2906         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2907         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2908
  2909         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2910         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2911
  2912         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2913         16  CF-AR-LAST-EL860-DT            PIC XX.
  2914         16  CF-MP-MONTH-END-DT             PIC XX.
  2915
  2916         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2917         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2918             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2919
  2920         16  CF-AR-MONTH-END-DT             PIC XX.
  2921
  2922         16  CF-CRDTCRD-USER                PIC X.
  2923             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2924             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2925
  2926         16  CF-CC-MONTH-END-DT             PIC XX.
  2927
  2928         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2929
  2930         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2931             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2932             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2933             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2934         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2935         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2936         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2937         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2938             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2939             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2940         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2941         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2942         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL642T.cbl
  2943             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2944         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2945
  2946         16  CF-CL-ZIP-CODE.
  2947             20  CF-CL-ZIP-PRIME.
  2948                 24  CF-CL-ZIP-1ST          PIC X.
  2949                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2950                 24  FILLER                 PIC X(4).
  2951             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2952         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2953             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2954             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2955             20  FILLER                     PIC XXX.
  2956
  2957         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2958         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2959         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2960         16  CF-CO-OPTION-START-DATE        PIC XX.
  2961         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2962           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2963                                                      '3' '4'.
  2964           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2965           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2966           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2967           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2968           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2969           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2970
  2971         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2972
  2973         16  CF-PAYMENT-APPROVAL-LEVELS.
  2974             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2975             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2976             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2977             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2978             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2979             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2980
  2981         16  CF-END-USER-REPORTING-USER     PIC X.
  2982             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2983             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2984
  2985         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2986             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2987             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2988
  2989         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2990
  2991         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2992         16  FILLER                         PIC X.
  2993
  2994         16  CF-CREDIT-ARCHIVE-CNTL.
  2995             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2996             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2997             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2998
  2999         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3000
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL642T.cbl
  3001         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3002             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3003             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3004
  3005         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3006             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3007             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3008
  3009         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3010
  3011         16  CF-CO-ACH-ID-CODE              PIC  X.
  3012             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3013             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3014             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3015         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3016         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3017         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3018         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3019         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3020         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3021         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3022         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3023         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3024                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3025         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3026                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3027
  3028         16  CF-CO-OVER-SHORT.
  3029             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3030             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3031
  3032*         16  FILLER                         PIC X(102).
  3033         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3034             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3035             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3036
  3037         16  CF-AH-APPROVAL-DAYS.
  3038             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3039             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3040             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3041             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3042
  3043         16  FILLER                         PIC X(82).
  3044****************************************************************
  3045*             PROCESSOR/USER RECORD                            *
  3046****************************************************************
  3047
  3048     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3049         16  CF-PROCESSOR-NAME              PIC X(30).
  3050         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3051         16  CF-PROCESSOR-TITLE             PIC X(26).
  3052         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3053                 88  MESSAGE-YES                VALUE 'Y'.
  3054                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3055
  3056*****************************************************
  3057****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3058****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL642T.cbl
  3059****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3060****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3061*****************************************************
  3062
  3063         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3064             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3065             20  CF-APPLICATION-FORCE       PIC X.
  3066             20  CF-INDIVIDUAL-APP.
  3067                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3068                     28  CF-BROWSE-APP      PIC X.
  3069                     28  CF-UPDATE-APP      PIC X.
  3070
  3071         16  CF-CURRENT-TERM-ON             PIC X(4).
  3072         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3073             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3074             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3075             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3076             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3077             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3078             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3079             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3080         16  CF-PROCESSOR-CARRIER           PIC X.
  3081             88  NO-CARRIER-SECURITY            VALUE ' '.
  3082         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3083             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3084         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3085             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3086         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3087             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3088
  3089         16  CF-PROC-SYS-ACCESS-SW.
  3090             20  CF-PROC-CREDIT-CLAIMS-SW.
  3091                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3092                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3093                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3094                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3095             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3096                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3097                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3098             20  CF-PROC-LIFE-GNRLDGR-SW.
  3099                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3100                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3101                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3102                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3103             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3104                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3105                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3106         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3107             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3108             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3109         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3110
  3111         16  CF-APPROVAL-LEVEL                  PIC X.
  3112             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3113             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3114             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3115             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3116
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL642T.cbl
  3117         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3118
  3119         16  CF-LANGUAGE-TYPE                   PIC X.
  3120             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3121             88  CF-LANG-IS-FR                      VALUE 'F'.
  3122         16  FILLER                             PIC  X(240).
  3123
  3124****************************************************************
  3125*             PROCESSOR/REMINDERS RECORD                       *
  3126****************************************************************
  3127
  3128     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3129         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3130             20  CF-START-REMIND-DT         PIC XX.
  3131             20  CF-END-REMIND-DT           PIC XX.
  3132             20  CF-REMINDER-TEXT           PIC X(50).
  3133         16  FILLER                         PIC X(296).
  3134
  3135
  3136****************************************************************
  3137*             STATE MASTER RECORD                              *
  3138****************************************************************
  3139
  3140     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3141         16  CF-STATE-ABBREVIATION          PIC XX.
  3142         16  CF-STATE-NAME                  PIC X(25).
  3143         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3144         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3145             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3146             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3147             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3148             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3149                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3150                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3151             20  CF-ST-PREM-REJECT-SW       PIC X.
  3152                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3153                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3154             20  CF-ST-REF-REJECT-SW        PIC X.
  3155                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3156                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3157         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3158         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3159         16  CF-ST-REFUND-RULES.
  3160             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3161             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3162             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3163         16  CF-ST-FST-PMT-EXTENSION.
  3164             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3165             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3166                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3167                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3168                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3169                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3170         16  CF-ST-STATE-CALL.
  3171             20  CF-ST-CALL-UNEARNED        PIC X.
  3172             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3173             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3174         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL642T.cbl
  3175             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3176             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3177         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3178         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3179         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3180         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3181         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3182         16  FILLER                         PIC X.
  3183         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3184             20  CF-ST-BENEFIT-CD           PIC XX.
  3185             20  CF-ST-BENEFIT-KIND         PIC X.
  3186                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3187                 88  CF-ST-AH-KIND              VALUE 'A'.
  3188             20  CF-ST-REM-TERM-CALC        PIC X.
  3189                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3190                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3191                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3192                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3193                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3194                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3195                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3196                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3197
  3198             20  CF-ST-REFUND-CALC          PIC X.
  3199                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3200                 88  ST-REFD-BY-R78             VALUE '1'.
  3201                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3202                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3203                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3204                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3205                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3206                 88  ST-REFD-UTAH               VALUE '7'.
  3207                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3208                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3209                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3210
  3211             20  CF-ST-EARNING-CALC         PIC X.
  3212                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3213                 88  ST-EARN-BY-R78             VALUE '1'.
  3214                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3215                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3216                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3217                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3218                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3219                 88  ST-EARN-MEAN               VALUE '8'.
  3220                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3221
  3222             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3223                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3224                 88  ST-OVRD-BY-R78             VALUE '1'.
  3225                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3226                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3227                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3228                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3229                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3230                 88  ST-OVRD-MEAN               VALUE '8'.
  3231                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3232             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL642T.cbl
  3233
  3234         16  CF-ST-COMMISSION-CAPS.
  3235             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3236             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3237             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3238             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3239         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3240                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3241
  3242         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3243
  3244         16  CF-ST-STATUTORY-INTEREST.
  3245             20  CF-ST-STAT-DATE-FROM       PIC X.
  3246                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3247                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3248             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3249             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3250             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3251             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3252             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3253
  3254         16  CF-ST-OVER-SHORT.
  3255             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3256             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3257
  3258         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3259
  3260         16  CF-ST-RT-CALC                  PIC X.
  3261
  3262         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3263         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3264         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3265         16  CF-ST-RF-LR-CALC               PIC X.
  3266         16  CF-ST-RF-LL-CALC               PIC X.
  3267         16  CF-ST-RF-LN-CALC               PIC X.
  3268         16  CF-ST-RF-AH-CALC               PIC X.
  3269         16  CF-ST-RF-CP-CALC               PIC X.
  3270*        16  FILLER                         PIC X(206).
  3271*CIDMOD         16  FILLER                         PIC X(192).
  3272         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3273             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3274         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3275         16  FILLER                         PIC X(187).
  3276
  3277****************************************************************
  3278*             BENEFIT MASTER RECORD                            *
  3279****************************************************************
  3280
  3281     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3282         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3283             20  CF-BENEFIT-CODE            PIC XX.
  3284             20  CF-BENEFIT-NUMERIC  REDEFINES
  3285                 CF-BENEFIT-CODE            PIC XX.
  3286             20  CF-BENEFIT-ALPHA           PIC XXX.
  3287             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3288             20  CF-BENEFIT-COMMENT         PIC X(10).
  3289
  3290             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL642T.cbl
  3291                 88  CF-REDUCING                VALUE 'R'.
  3292                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3293
  3294             20  CF-SPECIAL-CALC-CD         PIC X.
  3295                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3296                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3297                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3298                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3299                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3300                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3301                 88  CF-FARM-PLAN               VALUE 'F'.
  3302                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3303                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3304                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3305                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3306                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3307                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3308                 88  CF-PRUDENTIAL              VALUE 'P'.
  3309                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3310                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3311                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3312                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3313                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3314                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3315
  3316             20  CF-JOINT-INDICATOR         PIC X.
  3317                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3318
  3319*            20  FILLER                     PIC X(12).
  3320             20  FILLER                     PIC X(11).
  3321             20  CF-BENEFIT-CATEGORY        PIC X.
  3322             20  CF-LOAN-TYPE               PIC X(8).
  3323
  3324             20  CF-CO-REM-TERM-CALC        PIC X.
  3325                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3326                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3327                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3328                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3329                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3330
  3331             20  CF-CO-EARNINGS-CALC        PIC X.
  3332                 88  CO-EARN-BY-R78             VALUE '1'.
  3333                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3334                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3335                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3336                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3337                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3338                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3339                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3340
  3341             20  CF-CO-REFUND-CALC          PIC X.
  3342                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3343                 88  CO-REFD-BY-R78             VALUE '1'.
  3344                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3345                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3346                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3347                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3348                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL642T.cbl
  3349                 88  CO-REFD-MEAN               VALUE '8'.
  3350                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3351                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3352                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3353
  3354             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3355                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3356                 88  CO-OVRD-BY-R78             VALUE '1'.
  3357                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3358                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3359                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3360                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3361                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3362                 88  CO-OVRD-MEAN               VALUE '8'.
  3363                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3364
  3365             20  CF-CO-BEN-I-G-CD           PIC X.
  3366                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3367                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3368                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3369
  3370         16  FILLER                         PIC X(304).
  3371
  3372
  3373****************************************************************
  3374*             CARRIER MASTER RECORD                            *
  3375****************************************************************
  3376
  3377     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3378         16  CF-ADDRESS-DATA.
  3379             20  CF-MAIL-TO-NAME            PIC X(30).
  3380             20  CF-IN-CARE-OF              PIC X(30).
  3381             20  CF-ADDRESS-LINE-1          PIC X(30).
  3382             20  CF-ADDRESS-LINE-2          PIC X(30).
  3383             20  CF-CITY-STATE              PIC X(30).
  3384             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3385             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3386
  3387         16  CF-CLAIM-NO-CONTROL.
  3388             20  CF-CLAIM-NO-METHOD         PIC X.
  3389                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3390                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3391                 88  CLAIM-NO-SEQ               VALUE '3'.
  3392                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3393             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3394                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3395                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3396                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3397
  3398         16  CF-CHECK-NO-CONTROL.
  3399             20  CF-CHECK-NO-METHOD         PIC X.
  3400                 88  CHECK-NO-MANUAL            VALUE '1'.
  3401                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3402                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3403                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3404             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3405                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3406
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL642T.cbl
  3407         16  CF-DOMICILE-STATE              PIC XX.
  3408
  3409         16  CF-EXPENSE-CONTROLS.
  3410             20  CF-EXPENSE-METHOD          PIC X.
  3411                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3412                 88  DOLLARS-PER-PMT            VALUE '2'.
  3413                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3414                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3415             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3416             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3417
  3418         16  CF-CORRESPONDENCE-CONTROL.
  3419             20  CF-LETTER-RESEND-OPT       PIC X.
  3420                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3421                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3422             20  FILLER                     PIC X(4).
  3423
  3424         16  CF-RESERVE-CONTROLS.
  3425             20  CF-MANUAL-SW               PIC X.
  3426                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3427             20  CF-FUTURE-SW               PIC X.
  3428                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3429             20  CF-PTC-SW                  PIC X.
  3430                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3431             20  CF-IBNR-SW                 PIC X.
  3432                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3433             20  CF-PTC-LF-SW               PIC X.
  3434                 88  CF-LF-PTC-USED             VALUE '1'.
  3435             20  CF-CDT-ACCESS-METHOD       PIC X.
  3436                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3437                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3438                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3439             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3440
  3441         16  CF-CLAIM-CALC-METHOD           PIC X.
  3442             88  360-PLUS-MONTHS                VALUE '1'.
  3443             88  365-PLUS-MONTHS                VALUE '2'.
  3444             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3445             88  360-DAILY                      VALUE '4'.
  3446             88  365-DAILY                      VALUE '5'.
  3447
  3448         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3449         16  FILLER                         PIC X(11).
  3450
  3451         16  CF-LIMIT-AMOUNTS.
  3452             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3453             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3454             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3455             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3456             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3457             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3458             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3459             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3460             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3461             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3462
  3463         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3464         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL642T.cbl
  3465         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3466
  3467         16  CF-ZIP-CODE.
  3468             20  CF-ZIP-PRIME.
  3469                 24  CF-ZIP-1ST             PIC X.
  3470                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3471                 24  FILLER                 PIC X(4).
  3472             20  CF-ZIP-PLUS4               PIC X(4).
  3473         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3474             20  CF-CAN-POSTAL-1            PIC XXX.
  3475             20  CF-CAN-POSTAL-2            PIC XXX.
  3476             20  FILLER                     PIC XXX.
  3477
  3478         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3479         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3480         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3481
  3482         16  CF-RATING-SWITCH               PIC X.
  3483             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3484             88  CF-NO-RATING                   VALUE 'N'.
  3485
  3486         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3487
  3488         16  CF-CARRIER-OVER-SHORT.
  3489             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3490             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3491
  3492         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3493         16  CF-SECPAY-SWITCH               PIC X.
  3494             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3495             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3496         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3497         16  FILLER                         PIC X(448).
  3498*        16  FILLER                         PIC X(452).
  3499
  3500
  3501****************************************************************
  3502*             MORTALITY MASTER RECORD                          *
  3503****************************************************************
  3504
  3505     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3506         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3507                                INDEXED BY CF-MORT-NDX.
  3508             20  CF-MORT-TABLE              PIC X(5).
  3509             20  CF-MORT-TABLE-TYPE         PIC X.
  3510                 88  CF-MORT-JOINT              VALUE 'J'.
  3511                 88  CF-MORT-SINGLE             VALUE 'S'.
  3512                 88  CF-MORT-COMBINED           VALUE 'C'.
  3513                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3514                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3515             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3516             20  CF-MORT-AGE-METHOD         PIC XX.
  3517                 88  CF-AGE-LAST                VALUE 'AL'.
  3518                 88  CF-AGE-NEAR                VALUE 'AN'.
  3519             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3520             20  CF-MORT-ADJUSTMENT-DIRECTION
  3521                                            PIC X.
  3522                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL642T.cbl
  3523                 88  CF-PLUS                    VALUE '+'.
  3524             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3525             20  CF-MORT-JOINT-CODE         PIC X.
  3526                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3527             20  CF-MORT-PC-Q               PIC X.
  3528                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3529             20  CF-MORT-TABLE-CODE         PIC X(4).
  3530             20  CF-MORT-COMMENTS           PIC X(15).
  3531             20  FILLER                     PIC X(14).
  3532
  3533         16  FILLER                         PIC X(251).
  3534
  3535
  3536****************************************************************
  3537*             BUSSINESS TYPE MASTER RECORD                     *
  3538****************************************************************
  3539
  3540     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3541* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3542* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3543* AND RECORD 05 IS TYPES 81-99
  3544         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3545             20  CF-BUSINESS-TITLE          PIC  X(19).
  3546             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3547                                            PIC S9V9(4) COMP-3.
  3548             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3549             20  FILLER                     PIC  X.
  3550         16  FILLER                         PIC  X(248).
  3551
  3552
  3553****************************************************************
  3554*             TERMINAL MASTER RECORD                           *
  3555****************************************************************
  3556
  3557     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3558
  3559         16  CF-COMPANY-TERMINALS.
  3560             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3561                                  PIC X(4).
  3562         16  FILLER               PIC X(248).
  3563
  3564
  3565****************************************************************
  3566*             LIFE EDIT MASTER RECORD                          *
  3567****************************************************************
  3568
  3569     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3570         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3571             20  CF-LIFE-CODE-IN            PIC XX.
  3572             20  CF-LIFE-CODE-OUT           PIC XX.
  3573         16  FILLER                         PIC X(248).
  3574
  3575
  3576****************************************************************
  3577*             AH EDIT MASTER RECORD                            *
  3578****************************************************************
  3579
  3580     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL642T.cbl
  3581         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3582             20  CF-AH-CODE-IN              PIC XXX.
  3583             20  CF-AH-CODE-OUT             PIC XX.
  3584         16  FILLER                         PIC X(248).
  3585
  3586
  3587****************************************************************
  3588*             CREDIBILITY TABLES                               *
  3589****************************************************************
  3590
  3591     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3592         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3593                             INDEXED BY CF-CRDB-NDX.
  3594             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3595             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3596             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3597         16  FILLER                         PIC  X(332).
  3598
  3599
  3600****************************************************************
  3601*             REPORT CUSTOMIZATION RECORD                      *
  3602****************************************************************
  3603
  3604     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3605         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3606             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3607             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3608             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3609**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3610****       A T-TRANSFER.                                   ****
  3611             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3612
  3613         16  FILLER                         PIC XX.
  3614
  3615         16  CF-CARRIER-CNTL-OPT.
  3616             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3617                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3618                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3619             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3620                                            PIC X.
  3621         16  CF-GROUP-CNTL-OPT.
  3622             20  CF-GROUP-OPT-SEQ           PIC 9.
  3623                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3624                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3625             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3626                                            PIC X(6).
  3627         16  CF-STATE-CNTL-OPT.
  3628             20  CF-STATE-OPT-SEQ           PIC 9.
  3629                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3630                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3631             20  CF-STATE-SELECT OCCURS 3 TIMES
  3632                                            PIC XX.
  3633         16  CF-ACCOUNT-CNTL-OPT.
  3634             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3635                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3636                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3637             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3638                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL642T.cbl
  3639         16  CF-BUS-TYP-CNTL-OPT.
  3640             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3641                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3642                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3643             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3644                                            PIC XX.
  3645         16  CF-LF-TYP-CNTL-OPT.
  3646             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3647                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3648                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3649             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3650                                            PIC XX.
  3651         16  CF-AH-TYP-CNTL-OPT.
  3652             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3653                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3654                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3655             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3656                                            PIC XX.
  3657         16  CF-REPTCD1-CNTL-OPT.
  3658             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3659                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3660                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3661             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3662                                            PIC X(10).
  3663         16  CF-REPTCD2-CNTL-OPT.
  3664             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3665                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3666                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3667             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3668                                            PIC X(10).
  3669         16  CF-USER1-CNTL-OPT.
  3670             20  CF-USER1-OPT-SEQ           PIC 9.
  3671                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3672                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3673             20  CF-USER1-SELECT OCCURS 3 TIMES
  3674                                            PIC X(10).
  3675         16  CF-USER2-CNTL-OPT.
  3676             20  CF-USER2-OPT-SEQ           PIC 9.
  3677                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3678                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3679             20  CF-USER2-SELECT OCCURS 3 TIMES
  3680                                            PIC X(10).
  3681         16  CF-USER3-CNTL-OPT.
  3682             20  CF-USER3-OPT-SEQ           PIC 9.
  3683                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3684                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3685             20  CF-USER3-SELECT OCCURS 3 TIMES
  3686                                            PIC X(10).
  3687         16  CF-USER4-CNTL-OPT.
  3688             20  CF-USER4-OPT-SEQ           PIC 9.
  3689                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3690                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3691             20  CF-USER4-SELECT OCCURS 3 TIMES
  3692                                            PIC X(10).
  3693         16  CF-USER5-CNTL-OPT.
  3694             20  CF-USER5-OPT-SEQ           PIC 9.
  3695                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3696                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL642T.cbl
  3697             20  CF-USER5-SELECT OCCURS 3 TIMES
  3698                                            PIC X(10).
  3699         16  CF-REINS-CNTL-OPT.
  3700             20  CF-REINS-OPT-SEQ           PIC 9.
  3701                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3702                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3703             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3704                 24  CF-REINS-PRIME         PIC XXX.
  3705                 24  CF-REINS-SUB           PIC XXX.
  3706
  3707         16  CF-AGENT-CNTL-OPT.
  3708             20  CF-AGENT-OPT-SEQ           PIC 9.
  3709                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3710                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3711             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3712                                            PIC X(10).
  3713
  3714         16  FILLER                         PIC X(43).
  3715
  3716         16  CF-LOSS-RATIO-SELECT.
  3717             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3718             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3719         16  CF-ENTRY-DATE-SELECT.
  3720             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3721             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3722         16  CF-EFFECTIVE-DATE-SELECT.
  3723             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3724             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3725
  3726         16  CF-EXCEPTION-LIST-IND          PIC X.
  3727             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3728
  3729         16  FILLER                         PIC X(318).
  3730
  3731****************************************************************
  3732*                  EXCEPTION REPORTING RECORD                  *
  3733****************************************************************
  3734
  3735     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3736         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3737             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3738
  3739         16  CF-COMBINED-LIFE-AH-OPT.
  3740             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3741             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3742             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3743             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3744
  3745         16  CF-LIFE-OPT.
  3746             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3747             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3748             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3749             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3750             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3751             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3752             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3753             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3754             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL642T.cbl
  3755             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3756
  3757         16  CF-AH-OPT.
  3758             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3759             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3760             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3761             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3762             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3763             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3764             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3765             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3766             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3767             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3768
  3769         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3770             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3771             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3772             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3773
  3774         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3775
  3776         16  FILLER                         PIC X(673).
  3777
  3778
  3779****************************************************************
  3780*             MORTGAGE SYSTEM PLAN RECORD                      *
  3781****************************************************************
  3782
  3783     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3784         16  CF-PLAN-TYPE                   PIC X.
  3785             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3786             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3787             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3788         16  CF-PLAN-ABBREV                 PIC XXX.
  3789         16  CF-PLAN-DESCRIPT               PIC X(10).
  3790         16  CF-PLAN-NOTES                  PIC X(20).
  3791         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3792         16  CF-PLAN-UNDERWRITING.
  3793             20  CF-PLAN-TERM-DATA.
  3794                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3795                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3796             20  CF-PLAN-AGE-DATA.
  3797                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3798                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3799                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3800             20  CF-PLAN-BENEFIT-DATA.
  3801                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3802                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3803                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3804                                            PIC S9(7)V99  COMP-3.
  3805         16  CF-PLAN-POLICY-FORMS.
  3806             20  CF-POLICY-FORM             PIC X(12).
  3807             20  CF-MASTER-APPLICATION      PIC X(12).
  3808             20  CF-MASTER-POLICY           PIC X(12).
  3809         16  CF-PLAN-RATING.
  3810             20  CF-RATE-CODE               PIC X(5).
  3811             20  CF-SEX-RATING              PIC X.
  3812                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL642T.cbl
  3813                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3814             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3815             20  CF-SUB-STD-TYPE            PIC X.
  3816                 88  CF-PCT-OF-PREM            VALUE '1'.
  3817                 88  CF-PCT-OF-BENE            VALUE '2'.
  3818         16  CF-PLAN-PREM-TOLERANCES.
  3819             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3820             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3821         16  CF-PLAN-PYMT-TOLERANCES.
  3822             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3823             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3824         16  CF-PLAN-MISC-DATA.
  3825             20  FILLER                     PIC X.
  3826             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3827             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3828         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3829         16  CF-PLAN-IND-GRP                PIC X.
  3830             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3831                                                     '1'.
  3832             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3833                                                     '2'.
  3834         16  CF-MIB-SEARCH-SW               PIC X.
  3835             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3836             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3837             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3838             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3839         16  CF-ALPHA-SEARCH-SW             PIC X.
  3840             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3841             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3842             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3843             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3844             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3845             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3846             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3847             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3848             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3849             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3850                                                     'A' 'B' 'C'
  3851                                                     'X' 'Y' 'Z'.
  3852         16  CF-EFF-DT-RULE-SW              PIC X.
  3853             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3854             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3855             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3856             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3857             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3858         16  FILLER                         PIC X(4).
  3859         16  CF-HEALTH-QUESTIONS            PIC X.
  3860             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3861         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3862         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3863         16  CF-PLAN-SNGL-JNT               PIC X.
  3864             88  CF-COMBINED-PLAN              VALUE 'C'.
  3865             88  CF-JNT-PLAN                   VALUE 'J'.
  3866             88  CF-SNGL-PLAN                  VALUE 'S'.
  3867         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3868         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3869         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3870         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL642T.cbl
  3871         16  CF-RERATE-CNTL                 PIC  X.
  3872             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3873             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3874             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3875             88  CF-AUTO-RECALC                 VALUE '4'.
  3876         16  CF-BENEFIT-TYPE                PIC  X.
  3877             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3878             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3879         16  CF-POLICY-FEE                  PIC S999V99
  3880                                                    COMP-3.
  3881         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3882         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3883         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3884         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3885         16  FILLER                         PIC  X(32).
  3886         16  CF-TERMINATION-FORM            PIC  X(04).
  3887         16  FILLER                         PIC  X(08).
  3888         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3889                                                       COMP-3.
  3890         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3891         16  CF-ISSUE-LETTER                PIC  X(4).
  3892         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3893         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3894             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3895             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3896         16  CF-MP-REFUND-CALC              PIC X.
  3897             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3898             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3899             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3900             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3901             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3902             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3903             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3904             88  CF-MP-REFD-MEAN                VALUE '8'.
  3905         16  CF-ALT-RATE-CODE               PIC  X(5).
  3906
  3907
  3908         16  FILLER                         PIC X(498).
  3909****************************************************************
  3910*             MORTGAGE COMPANY MASTER RECORD                   *
  3911****************************************************************
  3912
  3913     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3914         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3915         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3916             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3917             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3918             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3919             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3920             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3921
  3922         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3923         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3924         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3925         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3926         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3927
  3928         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL642T.cbl
  3929             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3930         16  CF-MP-RECON-USE-IND            PIC X(1).
  3931             88  CF-MP-USE-RECON             VALUE 'Y'.
  3932         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3933             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3934         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3935             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3936             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3937         16  FILLER                         PIC X(1).
  3938         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3939             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3940         16  CF-MORTG-MIB-VERSION           PIC X.
  3941             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3942             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3943             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3944         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3945             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3946                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3947             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3948                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3949             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3950                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3951             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3952                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3953             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3954                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3955             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3956                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3957         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3958         16  FILLER                         PIC X(7).
  3959         16  CF-MORTG-DESTINATION-SYMBOL.
  3960             20  CF-MORTG-MIB-COMM          PIC X(5).
  3961             20  CF-MORTG-MIB-TERM          PIC X(5).
  3962         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3963             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3964         16  FILLER                         PIC X(03).
  3965         16  CF-MP-CHECK-NO-CONTROL.
  3966             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3967                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3968                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3969                                                ' ' LOW-VALUES.
  3970                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3971                                               VALUE '3'.
  3972         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3973         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3974         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3975             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3976                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3977             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3978                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3979             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3980                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3981             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3982                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3983             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3984                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3985             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3986                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL642T.cbl
  3987         16  CF-MORTG-BILLING-AREA.
  3988             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3989                                            PIC X.
  3990         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3991         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3992         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3993         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3994             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3995             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3996         16  FILLER                         PIC X.
  3997         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3998             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3999             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4000         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4001         16  FILLER                         PIC X(8).
  4002         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4003         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4004         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4005         16  CF-ACH-COMPANY-ID.
  4006             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4007                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4008                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4009                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4010             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4011         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4012             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4013         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4014             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4015             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4016         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4017         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4018         16  FILLER                         PIC X(536).
  4019
  4020****************************************************************
  4021*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4022****************************************************************
  4023
  4024     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4025         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4026             20  CF-FEMALE-HEIGHT.
  4027                 24  CF-FEMALE-FT           PIC 99.
  4028                 24  CF-FEMALE-IN           PIC 99.
  4029             20  CF-FEMALE-MIN-WT           PIC 999.
  4030             20  CF-FEMALE-MAX-WT           PIC 999.
  4031         16  FILLER                         PIC X(428).
  4032
  4033     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4034         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4035             20  CF-MALE-HEIGHT.
  4036                 24  CF-MALE-FT             PIC 99.
  4037                 24  CF-MALE-IN             PIC 99.
  4038             20  CF-MALE-MIN-WT             PIC 999.
  4039             20  CF-MALE-MAX-WT             PIC 999.
  4040         16  FILLER                         PIC X(428).
  4041******************************************************************
  4042*             AUTOMATIC ACTIVITY RECORD                          *
  4043******************************************************************
  4044     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL642T.cbl
  4045         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4046             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4047             20  CF-SYS-LETTER-ID           PIC X(04).
  4048             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4049             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4050             20  CF-SYS-RESET-SW            PIC X(01).
  4051             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4052             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4053
  4054         16  FILLER                         PIC X(50).
  4055
  4056         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4057             20  CF-USER-ACTIVE-SW          PIC X(01).
  4058             20  CF-USER-LETTER-ID          PIC X(04).
  4059             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4060             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4061             20  CF-USER-RESET-SW           PIC X(01).
  4062             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4063             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4064             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4065
  4066         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL642T.cbl
  4068*                            COPY ERCCOMP.
  4069******************************************************************
  4070*                                                                *
  4071*                                                                *
  4072*                            ERCCOMP                             *
  4073*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4074*                            VMOD=2.019                          *
  4075*                                                                *
  4076*   ONLINE CREDIT SYSTEM                                         *
  4077*                                                                *
  4078*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4079*                                                                *
  4080*   FILE TYPE = VSAM,KSDS                                        *
  4081*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4082*                                                                *
  4083*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4084*       ALTERNATE PATH = NONE                                    *
  4085*                                                                *
  4086*   LOG = NO                                                     *
  4087*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4088*                                                                *
  4089******************************************************************
  4090*                   C H A N G E   L O G
  4091*
  4092* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4093*-----------------------------------------------------------------
  4094*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4095* EFFECTIVE    NUMBER
  4096*-----------------------------------------------------------------
  4097* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4098* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4099* 092205    2005050300006  PEMA  ADD LEASE FEE
  4100* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4101* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4102* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4103* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4104* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4105******************************************************************
  4106
  4107 01  COMPENSATION-MASTER.
  4108     12  CO-RECORD-ID                          PIC XX.
  4109         88  VALID-CO-ID                          VALUE 'CO'.
  4110
  4111     12  CO-CONTROL-PRIMARY.
  4112         16  CO-COMPANY-CD                     PIC X.
  4113         16  CO-CONTROL.
  4114             20  CO-CTL-1.
  4115                 24  CO-CARR-GROUP.
  4116                     28  CO-CARRIER            PIC X.
  4117                     28  CO-GROUPING.
  4118                         32  CO-GROUP-PREFIX   PIC XXX.
  4119                         32  CO-GROUP-PRIME    PIC XXX.
  4120                 24  CO-RESP-NO.
  4121                     28  CO-RESP-PREFIX        PIC X(4).
  4122                     28  CO-RESP-PRIME         PIC X(6).
  4123             20  CO-CTL-2.
  4124                 24  CO-ACCOUNT.
  4125                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL642T.cbl
  4126                     28  CO-ACCT-PRIME         PIC X(6).
  4127         16  CO-TYPE                           PIC X.
  4128             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4129             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4130             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4131
  4132     12  CO-MAINT-INFORMATION.
  4133         16  CO-LAST-MAINT-DT                  PIC XX.
  4134         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4135         16  CO-LAST-MAINT-USER                PIC X(4).
  4136     12  FILLER                                PIC XX.
  4137     12  CO-STMT-TYPE                          PIC XXX.
  4138     12  CO-COMP-TYPE                          PIC X.
  4139         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4140     12  CO-STMT-OWNER                         PIC X(4).
  4141     12  CO-BALANCE-CONTROL                    PIC X.
  4142         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4143         88  CO-NO-BALANCE                        VALUE 'N'.
  4144
  4145     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4146         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4147         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4148         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4149
  4150     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4151         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4152         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4153
  4154     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4155     12  CO-GA-DIRECT-DEP                      PIC X.
  4156     12  CO-FUTURE-SPACE                       PIC X.
  4157         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4158
  4159     12  CO-ACCT-NAME                          PIC X(30).
  4160     12  CO-MAIL-NAME                          PIC X(30).
  4161     12  CO-ADDR-1                             PIC X(30).
  4162     12  CO-ADDR-2                             PIC X(30).
  4163     12  CO-ADDR-3.
  4164         16  CO-ADDR-CITY                      PIC X(27).
  4165         16  CO-ADDR-STATE                     PIC XX.
  4166     12  CO-CSO-1099                           PIC X.
  4167     12  CO-ZIP.
  4168         16  CO-ZIP-PRIME.
  4169             20  CO-ZIP-PRI-1ST                PIC X.
  4170                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4171             20  FILLER                        PIC X(4).
  4172         16  CO-ZIP-PLUS4                      PIC X(4).
  4173     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4174         16  CO-CAN-POSTAL-1                   PIC XXX.
  4175         16  CO-CAN-POSTAL-2                   PIC XXX.
  4176         16  FILLER                            PIC XXX.
  4177     12  CO-SOC-SEC                            PIC X(13).
  4178     12  CO-TELEPHONE.
  4179         16  CO-AREA-CODE                      PIC XXX.
  4180         16  CO-PREFIX                         PIC XXX.
  4181         16  CO-PHONE                          PIC X(4).
  4182
  4183     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL642T.cbl
  4184
  4185     12  CO-AR-BAL-LEVEL                       PIC X.
  4186         88  CO-AR-REF-LVL                        VALUE '1'.
  4187         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4188         88  CO-AR-BILL-LVL                       VALUE '2'.
  4189         88  CO-AR-AGT-LVL                        VALUE '3'.
  4190         88  CO-AR-FR-LVL                         VALUE '4'.
  4191
  4192     12  CO-AR-NORMAL-PRINT                    PIC X.
  4193         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4194         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4195
  4196     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4197
  4198     12  CO-AR-REPORTING                       PIC X.
  4199         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4200         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4201
  4202     12  CO-AR-PULL-CHECK                      PIC X.
  4203         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4204         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4205
  4206     12  CO-AR-BALANCE-PRINT                   PIC X.
  4207         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4208
  4209     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4210         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4211         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4212         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4213
  4214     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4215
  4216     12  CO-USER-CODE                          PIC X.
  4217     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4218
  4219******************************************************************
  4220*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4221*    THE LAST MONTH END RUN.
  4222******************************************************************
  4223
  4224     12  CO-LAST-ACTIVITY-DATE.
  4225         16  CO-ACT-YEAR                       PIC 99.
  4226         16  CO-ACT-MONTH                      PIC 99.
  4227         16  CO-ACT-DAY                        PIC 99.
  4228
  4229     12  CO-LAST-STMT-DT.
  4230         16  CO-LAST-STMT-YEAR                 PIC 99.
  4231         16  CO-LAST-STMT-MONTH                PIC 99.
  4232         16  CO-LAST-STMT-DAY                  PIC 99.
  4233
  4234     12  CO-MO-END-TOTALS.
  4235         16  CO-MONTHLY-TOTALS.
  4236             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4237             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4238             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4239             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4240             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4241
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL642T.cbl
  4242         16  CO-AGING-TOTALS.
  4243             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4244             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4245             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4246             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4247
  4248         16  CO-YTD-TOTALS.
  4249             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4250             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4251
  4252         16  CO-OVER-UNDER-TOTALS.
  4253             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4254             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4255
  4256     12  CO-MISCELLANEOUS-TOTALS.
  4257         16  CO-FICA-TOTALS.
  4258             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4259             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4260
  4261         16  CO-CLAIM-TOTALS.
  4262             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4263             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4264
  4265******************************************************************
  4266*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4267*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4268******************************************************************
  4269
  4270     12  CO-CURRENT-TOTALS.
  4271         16  CO-CURRENT-LAST-STMT-DT.
  4272             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4273             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4274             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4275
  4276         16  CO-CURRENT-MONTHLY-TOTALS.
  4277             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4278             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4279             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4280             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4281             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4282
  4283         16  CO-CURRENT-AGING-TOTALS.
  4284             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4285             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4286             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4287             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4288
  4289         16  CO-CURRENT-YTD-TOTALS.
  4290             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4291             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4292
  4293     12  CO-PAID-COMM-TOTALS.
  4294         16  CO-YTD-PAID-COMMS.
  4295             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4296             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4297
  4298     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4299         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL642T.cbl
  4300         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4301
  4302     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4303         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4304         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4305         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4306         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4307         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4308         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4309         88  CO-FINAL-LETTER                  VALUE 'F'.
  4310         88  CO-RECONCILING                   VALUE 'R'.
  4311         88  CO-PHONE-CALL                    VALUE 'P'.
  4312         88  CO-LEGAL                         VALUE 'L'.
  4313         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4314         88  CO-WRITE-OFF                     VALUE 'W'.
  4315         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4316
  4317     12  CO-CSR-CODE                       PIC X(4).
  4318
  4319     12  CO-GA-STATUS-INFO.
  4320         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4321         16  CO-GA-TERMINATION-DT          PIC XX.
  4322         16  CO-GA-STATUS-CODE             PIC X.
  4323             88  CO-GA-ACTIVE                 VALUE 'A'.
  4324             88  CO-GA-INACTIVE               VALUE 'I'.
  4325             88  CO-GA-PENDING                VALUE 'P'.
  4326         16  CO-GA-COMMENTS.
  4327             20  CO-GA-COMMENT-1           PIC X(40).
  4328             20  CO-GA-COMMENT-2           PIC X(40).
  4329             20  CO-GA-COMMENT-3           PIC X(40).
  4330             20  CO-GA-COMMENT-4           PIC X(40).
  4331
  4332     12  CO-RPTCD2                         PIC X(10).
  4333
  4334     12  CO-TYPE-AGENT                     PIC X(01).
  4335         88  CO-CORPORATION                   VALUE 'C'.
  4336         88  CO-PARTNERSHIP                   VALUE 'P'.
  4337         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4338         88  CO-TRUST                         VALUE 'T'.
  4339         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4340
  4341     12  CO-FAXNO.
  4342         16  CO-FAX-AREA-CODE                  PIC XXX.
  4343         16  CO-FAX-PREFIX                     PIC XXX.
  4344         16  CO-FAX-PHONE                      PIC X(4).
  4345
  4346     12  CO-BANK-INFORMATION.
  4347         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4348         16  CO-BANK-TRANSIT-NON REDEFINES
  4349             CO-BANK-TRANSIT-NO                PIC 9(8).
  4350
  4351         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4352     12  CO-MISC-DEDUCT-INFO REDEFINES
  4353                  CO-BANK-INFORMATION.
  4354         16  CO-MD-GL-ACCT                     PIC X(10).
  4355         16  CO-MD-DIV                         PIC XX.
  4356         16  CO-MD-CENTER                      PIC X(4).
  4357         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL642T.cbl
  4358         16  CO-CREATE-AP-CHECK                PIC X.
  4359         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4360         16  FILLER                            PIC XXX.
  4361     12  CO-ACH-STATUS                         PIC X.
  4362         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4363         88  CO-ACH-PENDING                        VALUE 'P'.
  4364
  4365     12  CO-BILL-SW                            PIC X.
  4366     12  CO-CONTROL-NAME                       PIC X(30).
  4367     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4368     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4369     12  CO-CLP-STATE                          PIC XX.
  4370     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4371     12  CO-SPP-REFUND-EDIT                    PIC X.
  4372
  4373******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL642T.cbl
  4375*                            COPY ERCPYAJ.
  4376******************************************************************
  4377*                                                                *
  4378*                            ERCPYAJ                             *
  4379*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4380*                            VMOD=2.015                          *
  4381*                                                                *
  4382*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  4383*                                                                *
  4384*                                                                *
  4385*   FILE TYPE = VSAM,KSDS                                        *
  4386*   RECORD SIZE = 200  RECFORM = FIXED                           *
  4387*                                                                *
  4388*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  4389*       ALTERNATE PATHS = NONE                                   *
  4390*                                                                *
  4391*   LOG = YES                                                    *
  4392*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4393******************************************************************
  4394******************************************************************
  4395*                   C H A N G E   L O G
  4396*
  4397* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4398*-----------------------------------------------------------------
  4399*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4400* EFFECTIVE    NUMBER
  4401*-----------------------------------------------------------------
  4402* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  4403* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  4404******************************************************************
  4405
  4406 01  PENDING-PAY-ADJ.
  4407     12  PY-RECORD-ID                     PIC XX.
  4408         88  VALID-PY-ID                        VALUE 'PY'.
  4409
  4410     12  PY-CONTROL-PRIMARY.
  4411         16  PY-COMPANY-CD                PIC X.
  4412         16  PY-CARRIER                   PIC X.
  4413         16  PY-GROUPING                  PIC X(6).
  4414         16  PY-FIN-RESP                  PIC X(10).
  4415         16  PY-ACCOUNT                   PIC X(10).
  4416         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  4417                                          PIC X(10).
  4418         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  4419         16  PY-RECORD-TYPE               PIC X.
  4420             88  PY-REMIT-RECEIVED            VALUE 'R'.
  4421             88  PY-DEPOSIT                   VALUE 'D'.
  4422             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  4423             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  4424             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  4425             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  4426             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  4427             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  4428             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  4429             88  PY-FICA-ENTRY                VALUE 'F'.
  4430             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  4431             88  PY-POLICY-FEE                VALUE 'W'.
  4432             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL642T.cbl
  4433
  4434     12  PY-PYMT-TYPE                     PIC X.
  4435             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  4436             88  PY-REINS-PYMT                VALUE 'R'.
  4437             88  PY-EXP-PYMT                  VALUE 'E'.
  4438
  4439     12  PY-BIL-INV                       PIC X(6).
  4440     12  PY-REF-NO                        PIC X(12).
  4441
  4442     12  PY-LAST-MAINT-DT                 PIC XX.
  4443     12  PY-LAST-MAINT-BY                 PIC X(4).
  4444     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4445
  4446     12  PY-PYADJ-RECORD.
  4447         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  4448         16  PY-ENTRY-COMMENT             PIC X(30).
  4449         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  4450             20  PY-GL-ACCOUNT            PIC X(10).
  4451             20  PY-GL-STATE              PIC X(02).
  4452             20  PY-GL-CANC-SW            PIC X(01).
  4453                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  4454                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  4455             20  PY-GL-COMMENT            PIC X(10).
  4456             20  FILLER      REDEFINES PY-GL-COMMENT.
  4457                 24  PY-GL-CHECK-NO       PIC 9(06).
  4458                 24  FILLER               PIC X(04).
  4459             20  FILLER                   PIC X(07).
  4460         16  PY-SAVE-ACCOUNT              PIC X(10).
  4461         16  PY-SAVE-TYPE                 PIC X(01).
  4462
  4463         16  PY-LETTERS.
  4464             20  PY-LETTER OCCURS 3 TIMES
  4465                           INDEXED BY PY-LET-NDX
  4466                                          PIC X(04).
  4467
  4468         16  PY-ERCOMP-TYPE               PIC X.
  4469             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  4470             88  PY-GA-TYPE                   VALUE 'G'.
  4471             88  PY-BANK-TYPE                 VALUE 'B'.
  4472         16  FILLER                       PIC X(05).
  4473
  4474     12  PY-RECORD-STATUS.
  4475         16  PY-CREDIT-SELECT-DT          PIC XX.
  4476         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  4477         16  PY-BILLED-DATE               PIC XX.
  4478         16  PY-REPORTED-DT               PIC XX.
  4479         16  PY-PMT-APPLIED               PIC X.
  4480             88  PY-ACCOUNT-PMT               VALUE 'A'.
  4481             88  PY-GA-PMT                    VALUE 'G'.
  4482             88  PY-OVWRITE-PMT               VALUE 'O'.
  4483             88  PY-NON-AR-PMT                VALUE 'N'.
  4484         16  FILLER                       PIC X(5).
  4485         16  PY-INPUT-DT                  PIC XX.
  4486         16  PY-CHECK-NUMBER              PIC X(6).
  4487         16  PY-VOID-SW                   PIC X.
  4488             88  PY-CHECK-VOIDED              VALUE 'V'.
  4489         16  PY-CHECK-ORIGIN-SW           PIC X.
  4490             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL642T.cbl
  4491             88  PY-REFUND-CHECK              VALUE 'R'.
  4492             88  PY-GA-CHECK                  VALUE 'G'.
  4493             88  PY-CHECK-WRITTEN             VALUE 'W'.
  4494             88  PY-CHECK-REVERSAL            VALUE 'V'.
  4495         16  PY-CHECK-WRITTEN-DT          PIC XX.
  4496         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  4497         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  4498         16  PY-BILL-FLAG                 PIC X.
  4499             88  PY-BILLED                    VALUE 'B'.
  4500         16  PY-AR-FLAG                   PIC X.
  4501             88  PY-AR-CYCLE                  VALUE 'C'.
  4502             88  PY-AR-MONTH-END              VALUE 'M'.
  4503         16  PY-AR-DATE                   PIC XX.
  4504
  4505     12  PY-GL-CODES.
  4506         16  PY-GL-DB                     PIC X(14).
  4507         16  PY-GL-CR                     PIC X(14).
  4508         16  PY-GL-FLAG                   PIC X.
  4509         16  PY-GL-DATE                   PIC XX.
  4510
  4511     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  4512     12  FILLER                           PIC X(3).
  4513******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL642T.cbl
  4515*                            COPY ERCACCT.
  4516******************************************************************
  4517*                                                                *
  4518*                                                                *
  4519*                            ERCACCT                             *
  4520*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4521*                            VMOD=2.031                          *
  4522*                                                                *
  4523*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4524*                                                                *
  4525*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4526*   VSAM ACCOUNT MASTER FILES.                                   *
  4527*                                                                *
  4528*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4529*                                                                *
  4530*   FILE TYPE = VSAM,KSDS                                        *
  4531*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4532*                                                                *
  4533*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4534*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4535*                                                                *
  4536*   LOG = NO                                                     *
  4537*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4538*                                                                *
  4539*                                                                *
  4540******************************************************************
  4541*                   C H A N G E   L O G
  4542*
  4543* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4544*-----------------------------------------------------------------
  4545*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4546* EFFECTIVE    NUMBER
  4547*-----------------------------------------------------------------
  4548* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4549* 092705    2005050300006  PEMA  ADD SPP LEASES
  4550* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4551* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4552******************************************************************
  4553
  4554 01  ACCOUNT-MASTER.
  4555     12  AM-RECORD-ID                      PIC XX.
  4556         88  VALID-AM-ID                      VALUE 'AM'.
  4557
  4558     12  AM-CONTROL-PRIMARY.
  4559         16  AM-COMPANY-CD                 PIC X.
  4560         16  AM-MSTR-CNTRL.
  4561             20  AM-CONTROL-A.
  4562                 24  AM-CARRIER            PIC X.
  4563                 24  AM-GROUPING.
  4564                     28 AM-GROUPING-PREFIX PIC XXX.
  4565                     28 AM-GROUPING-PRIME  PIC XXX.
  4566                 24  AM-STATE              PIC XX.
  4567                 24  AM-ACCOUNT.
  4568                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4569                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4570             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4571                                           PIC X(19).
  4572             20  AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL642T.cbl
  4573                 24  AM-EXPIRATION-DT      PIC XX.
  4574                 24  FILLER                PIC X(4).
  4575             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4576                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4577
  4578     12  AM-CONTROL-BY-VAR-GRP.
  4579         16  AM-COMPANY-CD-A1              PIC X.
  4580         16  AM-VG-CARRIER                 PIC X.
  4581         16  AM-VG-GROUPING                PIC X(6).
  4582         16  AM-VG-STATE                   PIC XX.
  4583         16  AM-VG-ACCOUNT                 PIC X(10).
  4584         16  AM-VG-DATE.
  4585             20  AM-VG-EXPIRATION-DT       PIC XX.
  4586             20  FILLER                    PIC X(4).
  4587         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4588                                           PIC 9(11)      COMP-3.
  4589     12  AM-MAINT-INFORMATION.
  4590         16  AM-LAST-MAINT-DT              PIC XX.
  4591         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4592         16  AM-LAST-MAINT-USER            PIC X(4).
  4593         16  FILLER                        PIC XX.
  4594
  4595     12  AM-EFFECTIVE-DT                   PIC XX.
  4596     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4597
  4598     12  AM-PREV-DATES  COMP-3.
  4599         16  AM-PREV-EXP-DT                PIC 9(11).
  4600         16  AM-PREV-EFF-DT                PIC 9(11).
  4601
  4602     12  AM-REPORT-CODE-1                  PIC X(10).
  4603     12  AM-REPORT-CODE-2                  PIC X(10).
  4604
  4605     12  AM-CITY-CODE                      PIC X(4).
  4606     12  AM-COUNTY-PARISH                  PIC X(6).
  4607
  4608     12  AM-NAME                           PIC X(30).
  4609     12  AM-PERSON                         PIC X(30).
  4610     12  AM-ADDRS                          PIC X(30).
  4611     12  AM-CITY.
  4612         16  AM-ADDR-CITY                  PIC X(28).
  4613         16  AM-ADDR-STATE                 PIC XX.
  4614     12  AM-ZIP.
  4615         16  AM-ZIP-PRIME.
  4616             20  AM-ZIP-PRI-1ST            PIC X.
  4617                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4618             20  FILLER                    PIC X(4).
  4619         16  AM-ZIP-PLUS4                  PIC X(4).
  4620     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4621         16  AM-CAN-POSTAL-1               PIC XXX.
  4622         16  AM-CAN-POSTAL-2               PIC XXX.
  4623         16  FILLER                        PIC XXX.
  4624     12  AM-TEL-NO.
  4625         16  AM-AREA-CODE                  PIC 999.
  4626         16  AM-TEL-PRE                    PIC 999.
  4627         16  AM-TEL-NBR                    PIC 9(4).
  4628     12  AM-TEL-LOC                        PIC X.
  4629         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4630         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL642T.cbl
  4631
  4632     12  AM-COMM-STRUCTURE.
  4633         16  AM-DEFN-1.
  4634             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4635                 24  AM-AGT.
  4636                     28  AM-AGT-PREFIX     PIC X(4).
  4637                     28  AM-AGT-PRIME      PIC X(6).
  4638                 24  AM-COM-TYP            PIC X.
  4639                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4640                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4641                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4642                 24  AM-RECALC-LV-INDIC    PIC X.
  4643                 24  AM-RETRO-LV-INDIC     PIC X.
  4644                 24  AM-GL-CODES           PIC X.
  4645                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4646                 24  FILLER                PIC X(01).
  4647         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4648             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4649                 24  FILLER                PIC X(11).
  4650                 24  AM-L-COMA             PIC XXX.
  4651                 24  AM-J-COMA             PIC XXX.
  4652                 24  AM-A-COMA             PIC XXX.
  4653                 24  FILLER                PIC X(6).
  4654
  4655     12  AM-COMM-CHANGE-STATUS             PIC X.
  4656         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4657
  4658     12  AM-CSR-CODE                       PIC X(4).
  4659
  4660     12  AM-BILLING-STATUS                 PIC X.
  4661         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4662         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4663     12  AM-AUTO-REFUND-SW                 PIC X.
  4664         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4665         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4666     12  AM-GPCD                           PIC 99.
  4667     12  AM-IG                             PIC X.
  4668         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4669         88  AM-HAS-GROUP                     VALUE '2'.
  4670     12  AM-STATUS                         PIC X.
  4671         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4672         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4673         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4674         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4675         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4676     12  AM-REMIT-TO                       PIC 99.
  4677     12  AM-ID-NO                          PIC X(11).
  4678
  4679     12  AM-CAL-TABLE                      PIC XX.
  4680     12  AM-LF-DEVIATION                   PIC XXX.
  4681     12  AM-AH-DEVIATION                   PIC XXX.
  4682     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4683     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4684     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4685     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4686     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4687     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4688
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL642T.cbl
  4689     12  AM-USER-FIELDS.
  4690         16  AM-FLD-1                      PIC XX.
  4691         16  AM-FLD-2                      PIC XX.
  4692         16  AM-FLD-3                      PIC XX.
  4693         16  AM-FLD-4                      PIC XX.
  4694         16  AM-FLD-5                      PIC XX.
  4695
  4696     12  AM-1ST-PROD-DATE.
  4697         16  AM-1ST-PROD-YR                PIC XX.
  4698         16  AM-1ST-PROD-MO                PIC XX.
  4699         16  AM-1ST-PROD-DA                PIC XX.
  4700     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4701     12  AM-CERTS-PURGED-DATE.
  4702         16  AM-PUR-YR                     PIC XX.
  4703         16  AM-PUR-MO                     PIC XX.
  4704         16  AM-PUR-DA                     PIC XX.
  4705     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4706     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4707     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4708     12  AM-INACTIVE-DATE.
  4709         16  AM-INA-MO                     PIC 99.
  4710         16  AM-INA-DA                     PIC 99.
  4711         16  AM-INA-YR                     PIC 99.
  4712     12  AM-AR-HI-CERT-DATE                PIC XX.
  4713
  4714     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4715     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4716
  4717     12  AM-OB-PAYMENT-MODE                PIC X.
  4718         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4719         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4720         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4721         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4722
  4723     12  AM-AH-ONLY-INDICATOR              PIC X.
  4724         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4725         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4726
  4727     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4728
  4729     12  AM-OVER-SHORT.
  4730         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4731         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4732
  4733     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4734     12  AM-DCC-CLP-STATE                  PIC XX.
  4735
  4736     12  AM-RECALC-COMM                    PIC X.
  4737     12  AM-RECALC-REIN                    PIC X.
  4738
  4739     12  AM-REI-TABLE                      PIC XXX.
  4740     12  AM-REI-ET-LF                      PIC X.
  4741     12  AM-REI-ET-AH                      PIC X.
  4742     12  AM-REI-PE-LF                      PIC X.
  4743     12  AM-REI-PE-AH                      PIC X.
  4744     12  AM-REI-PRT-ST                     PIC X.
  4745     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4746     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL642T.cbl
  4747     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4748     12  AM-REI-GROUP-A                    PIC X(6).
  4749     12  AM-REI-MORT                       PIC X(4).
  4750     12  AM-REI-PRT-OW                     PIC X.
  4751     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4752     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4753     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4754     12  AM-REI-GROUP-B                    PIC X(6).
  4755
  4756     12  AM-TRUST-TYPE                     PIC X(2).
  4757
  4758     12  AM-EMPLOYER-STMT-USED             PIC X.
  4759     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4760
  4761     12  AM-STD-AH-TYPE                    PIC XX.
  4762     12  AM-EARN-METHODS.
  4763         16  AM-EARN-METHOD-R              PIC X.
  4764             88 AM-REF-RL-R78                 VALUE 'R'.
  4765             88 AM-REF-RL-PR                  VALUE 'P'.
  4766             88 AM-REF-RL-MEAN                VALUE 'M'.
  4767             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4768         16  AM-EARN-METHOD-L              PIC X.
  4769             88 AM-REF-LL-R78                 VALUE 'R'.
  4770             88 AM-REF-LL-PR                  VALUE 'P'.
  4771             88 AM-REF-LL-MEAN                VALUE 'M'.
  4772             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4773         16  AM-EARN-METHOD-A              PIC X.
  4774             88 AM-REF-AH-R78                 VALUE 'R'.
  4775             88 AM-REF-AH-PR                  VALUE 'P'.
  4776             88 AM-REF-AH-MEAN                VALUE 'M'.
  4777             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4778             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4779             88 AM-REF-AH-NET                 VALUE 'N'.
  4780
  4781     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4782     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4783     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4784
  4785     12  AM-RET-Y-N                        PIC X.
  4786     12  AM-RET-P-E                        PIC X.
  4787     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4788     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4789     12  AM-RET-GRP                        PIC X(6).
  4790     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4791         16  AM-POOL-PRIME                 PIC XXX.
  4792         16  AM-POOL-SUB                   PIC XXX.
  4793     12  AM-RETRO-EARNINGS.
  4794         16  AM-RET-EARN-R                 PIC X.
  4795         16  AM-RET-EARN-L                 PIC X.
  4796         16  AM-RET-EARN-A                 PIC X.
  4797     12  AM-RET-ST-TAX-USE                 PIC X.
  4798         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4799         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4800     12  AM-RETRO-BEG-EARNINGS.
  4801         16  AM-RET-BEG-EARN-R             PIC X.
  4802         16  AM-RET-BEG-EARN-L             PIC X.
  4803         16  AM-RET-BEG-EARN-A             PIC X.
  4804     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL642T.cbl
  4805     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4806
  4807     12  AM-USER-SELECT-OPTIONS.
  4808         16  AM-USER-SELECT-1              PIC X(10).
  4809         16  AM-USER-SELECT-2              PIC X(10).
  4810         16  AM-USER-SELECT-3              PIC X(10).
  4811         16  AM-USER-SELECT-4              PIC X(10).
  4812         16  AM-USER-SELECT-5              PIC X(10).
  4813
  4814     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4815
  4816     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4817
  4818     12  AM-RPT045A-SWITCH                 PIC X.
  4819         88  RPT045A-OFF                   VALUE 'N'.
  4820
  4821     12  AM-INSURANCE-LIMITS.
  4822         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4823         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4824
  4825     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4826         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4827
  4828     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4829         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4830         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4831
  4832     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4833
  4834     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4835     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4836     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4837     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4838     12  FILLER                            PIC X(5).
  4839     12  AM-REPORT-CODE-3                  PIC X(10).
  4840*    12  FILLER                            PIC X(22).
  4841
  4842     12  AM-RESERVE-DATE.
  4843         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4844         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4845         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4846
  4847     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4848     12  AM-NOTIFICATION-TYPES.
  4849         16  AM-NOTIF-OF-LETTERS           PIC X.
  4850         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4851         16  AM-NOTIF-OF-REPORTS           PIC X.
  4852         16  AM-NOTIF-OF-STATUS            PIC X.
  4853
  4854     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4855         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4856         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4857         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4858         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4859
  4860     12  AM-BENEFIT-CONTROLS.
  4861         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4862             20  AM-BENEFIT-CODE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL642T.cbl
  4863             20  AM-BENEFIT-TYPE           PIC X.
  4864             20  AM-BENEFIT-REVISION       PIC XXX.
  4865             20  AM-BENEFIT-REM-TERM       PIC X.
  4866             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4867             20  FILLER                    PIC XX.
  4868         16  FILLER                        PIC X(80).
  4869
  4870     12  AM-TRANSFER-DATA.
  4871         16  AM-TRANSFERRED-FROM.
  4872             20  AM-TRNFROM-CARRIER        PIC X.
  4873             20  AM-TRNFROM-GROUPING.
  4874                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4875                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4876             20  AM-TRNFROM-STATE          PIC XX.
  4877             20  AM-TRNFROM-ACCOUNT.
  4878                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4879                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4880             20  AM-TRNFROM-DTE            PIC XX.
  4881         16  AM-TRANSFERRED-TO.
  4882             20  AM-TRNTO-CARRIER          PIC X.
  4883             20  AM-TRNTO-GROUPING.
  4884                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4885                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4886             20  AM-TRNTO-STATE            PIC XX.
  4887             20  AM-TRNTO-ACCOUNT.
  4888                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4889                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4890             20  AM-TRNTO-DTE              PIC XX.
  4891         16  FILLER                        PIC X(10).
  4892
  4893     12  AM-SAVED-REMIT-TO                 PIC 99.
  4894
  4895     12  AM-COMM-STRUCTURE-SAVED.
  4896         16  AM-DEFN-1-SAVED.
  4897             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4898                 24  AM-AGT-SV             PIC X(10).
  4899                 24  AM-COM-TYP-SV         PIC X.
  4900                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4901                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4902                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4903                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4904                 24  FILLER                PIC X.
  4905                 24  AM-GL-CODES-SV        PIC X.
  4906                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4907                 24  FILLER                PIC X.
  4908         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4909             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4910                 24  FILLER                PIC X(11).
  4911                 24  AM-L-COMA-SV          PIC XXX.
  4912                 24  AM-J-COMA-SV          PIC XXX.
  4913                 24  AM-A-COMA-SV          PIC XXX.
  4914                 24  FILLER                PIC X(6).
  4915
  4916     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4917         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4918            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4919            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4920            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL642T.cbl
  4921
  4922     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4923     12  FILLER                            PIC X(120).
  4924
  4925     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4926         16  AM-CONTROL-NAME               PIC X(30).
  4927         16  AM-EXECUTIVE-ONE.
  4928             20  AM-EXEC1-NAME             PIC X(15).
  4929             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4930                                                          COMP-3.
  4931             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4932                                                          COMP-3.
  4933         16  AM-EXECUTIVE-TWO.
  4934             20  AM-EXEC2-NAME             PIC X(15).
  4935             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4936                                                          COMP-3.
  4937             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4938                                                          COMP-3.
  4939
  4940     12  AM-RETRO-ADDITIONAL-DATA.
  4941         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4942         16  AM-RETRO-PREM-P-E             PIC X.
  4943         16  AM-RETRO-CLMS-P-I             PIC X.
  4944         16  AM-RETRO-RET-BRACKET-LF.
  4945             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4946                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4947                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4948             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4949                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4950                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4951             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4952                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4953                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4954         16  AM-RETRO-RET-BRACKET-AH.
  4955             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4956                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4957                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4958                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4959             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4960                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4961                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4962             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4963                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4964                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4965
  4966     12  AM-COMMENTS.
  4967         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4968
  4969     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4970         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4971         16  AM-FLI-BILLING-CODE           PIC X.
  4972         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4973         16  AM-FLI-UNITED-IDENT           PIC X.
  4974         16  AM-FLI-INTEREST-LOST-DATA.
  4975             20  AM-FLI-BANK-NO            PIC X(5).
  4976             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4977             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4978             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL642T.cbl
  4979         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4980             20  AM-FLI-AGT                PIC X(9).
  4981             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4982             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4983         16  FILLER                        PIC X(102).
  4984
  4985     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4986         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4987             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4988             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4989             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4990             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4991             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4992         16  FILLER                          PIC X(10).
  4993******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL642T.cbl
  4995*                            COPY ERCBILL.
  4996******************************************************************
  4997*                                                                *
  4998*                                                                *
  4999*                            ERCBILL                             *
  5000*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5001*                            VMOD=2.007                          *
  5002*                                                                *
  5003*   FILE DESCRIPTION = BILLING STATEMENTS FOR PRINTING           *
  5004*                                                                *
  5005*   FILE TYPE = VSAM,KSDS                                        *
  5006*   RECORD SIZE = 210  RECFORM = FIXED                           *
  5007*                                                                *
  5008*   BASE CLUSTER = ERBILL                        RKP=2,LEN=31    *
  5009*                                                                *
  5010*   LOG = NO                                                     *
  5011*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5012******************************************************************
  5013 01  BILLING-STATEMENT.
  5014     02 BILLING-STATEMENT-FILE.
  5015     12  BI-RECORD-ID                PIC XX.
  5016         88  VALID-BI-ID                VALUE 'BI'.
  5017
  5018     12  BI-CONTROL-PRIMARY.
  5019         16  BI-COMPANY-CD           PIC X.
  5020         16  BI-CARRIER              PIC X.
  5021         16  BI-GROUPING             PIC X(6).
  5022         16  BI-ACCOUNT              PIC X(10).
  5023         16  BI-FIN-RESP             PIC X(10).
  5024         16  BI-RECORD-TYPE          PIC X.
  5025             88  BI-HEADER-DATA         VALUE '1'.
  5026             88  BI-ADDRESS-DATA        VALUE '2'.
  5027             88  BI-TEXT-DATA           VALUE '3'.
  5028         16  BI-LINE-SEQ-NO          PIC S9(4)     COMP.
  5029
  5030     12  BI-TEXT-RECORD.
  5031         16  BI-SKIP-CONTROL         PIC X.
  5032         16  BI-TEXT-LINE            PIC X(157).
  5033         16  BI-TEXT-LINE-1 REDEFINES BI-TEXT-LINE.
  5034             20  BI-ADDR-LIT         PIC X(14).
  5035             20  BI-CO               PIC X(7).
  5036             20  BI-DASH             PIC X.
  5037             20  BI-ACCT             PIC X(10).
  5038             20  FILLER              PIC XX.
  5039             20  BI-ACCT-ADDR        PIC X(30).
  5040             20  FILLER              PIC X.
  5041             20  BI-REMIT-LIT        PIC X(11).
  5042             20  FILLER              PIC XX.
  5043             20  BI-REMIT-ADDR       PIC X(30).
  5044             20  FILLER              PIC X(49).
  5045         16  BI-TEXT-LINE-2 REDEFINES BI-TEXT-LINE.
  5046             20  BI-INS-LAST-NAME    PIC X(15).
  5047             20  FILLER              PIC X.
  5048             20  BI-INS-1ST-NAME     PIC X(10).
  5049             20  FILLER REDEFINES BI-INS-1ST-NAME.
  5050                 24  BI-INS-INITS    PIC XX.
  5051                 24  FILLER          PIC X(8).
  5052             20  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL642T.cbl
  5053             20  BI-UNDRWRTR.
  5054                 24  BI-INS-INIT     PIC X.
  5055                 24  FILLER          PIC XXX.
  5056             20  BI-CERT             PIC X(11).
  5057             20  FILLER              PIC XX.
  5058             20  BI-EFF-DT           PIC X(8).
  5059             20  FILLER              PIC XX.
  5060             20  BI-CAN-DT           PIC X(8).
  5061             20  FILLER              PIC XX.
  5062             20  BI-ED-TERM          PIC ZZZ.
  5063             20  FILLER              PIC XX.
  5064             20  BI-TYPE             PIC XXXX.
  5065             20  FILLER              PIC X.
  5066             20  BI-PREM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  5067             20  FILLER              PIC X(3).
  5068             20  BI-ED-RATE          PIC ZZZ.ZZZ.
  5069             20  FILLER              PIC XX.
  5070             20  BI-COMM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  5071             20  FILLER              PIC XX.
  5072             20  BI-FACE-AMT         PIC ZZZ,ZZZ,ZZZ.ZZ-.
  5073             20  FILLER              PIC X(26).
  5074         16  BI-TEXT-LINE-3 REDEFINES BI-TEXT-LINE.
  5075             20  FILLER              PIC X(42).
  5076             20  BI-TOT-DESC         PIC X(20).
  5077             20  FILLER REDEFINES BI-TOT-DESC.
  5078                 24  BI-TOT-LIT      PIC X(6).
  5079                 24  BI-OVERRIDE-L6  PIC X(14).
  5080             20  FILLER              PIC X(11).
  5081             20  BI-TOT-PREM         PIC ZZZ,ZZZ,ZZZ.99-.
  5082             20  BI-TOT-DASH REDEFINES
  5083                 BI-TOT-PREM         PIC X(15).
  5084             20  FILLER              PIC X(11).
  5085             20  BI-COM-TOT          PIC ZZZ,ZZZ,ZZZ.99-.
  5086             20  FILLER              PIC XX.
  5087             20  BI-FACE-TOT         PIC ZZZ,ZZZ,ZZZ.99-.
  5088             20  FILLER              PIC X(26).
  5089         16  BI-TEXT-LINE-4 REDEFINES BI-TEXT-LINE.
  5090             20  BI-ENTRY-DESC       PIC X(30).
  5091             20  FILLER              PIC X(11).
  5092             20  BI-ENTRY-AMT        PIC ZZZZ,ZZZ,ZZZ.99-.
  5093             20  FILLER              PIC X(31).
  5094             20  BI-ACCTG-COMMENT    PIC X(30).
  5095             20  FILLER              PIC X(39).
  5096         16  BI-TEXT-LINE-5 REDEFINES BI-TEXT-LINE.
  5097             20  FILLER              PIC X(42).
  5098             20  BI-TOT-DESC5        PIC X(20).
  5099             20  FILLER              PIC X(11).
  5100             20  BI-TOT-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5101             20  BI-COM-TOT5         PIC ZZZ,ZZZ,ZZZ.99-.
  5102             20  BI-NON-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5103             20  BI-NON-COMM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5104             20  FILLER              PIC X(24).
  5105         16  BI-TEXT-FIRST REDEFINES BI-TEXT-LINE.
  5106             20  BI-TEXT-2-81        PIC X(80).
  5107             20  FILLER              PIC X(77).
  5108         16  BI-TEXT-LAST REDEFINES BI-TEXT-LINE.
  5109             20  FILLER              PIC X(53).
  5110             20  BI-TEXT-55-133      PIC X(79).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL642T.cbl
  5111             20  FILLER              PIC X(25).
  5112         16  BI-TEXT-TYPE            PIC X.
  5113             88 DETAIL-LINE              VALUE 'D'.
  5114         16  BI-TERM                 PIC S999.
  5115         16  BI-BENEFIT-AMT          PIC S9(9)V99 COMP-3.
  5116         16  BI-PREMIUM-AMT          PIC S9(7)V99 COMP-3.
  5117         16  BI-RATE                 PIC S99V9(5) COMP-3.
  5118
  5119     12  BI-ADDRESS-RECORD  REDEFINES  BI-TEXT-RECORD.
  5120         16  FILLER                  PIC X.
  5121         16  BI-ACCT-ADDRESS-LINE    PIC X(30).
  5122         16  FILLER                  PIC X(10).
  5123         16  BI-REMIT-ADDRESS-LINE   PIC X(30).
  5124         16  FILLER                  PIC X(106).
  5125
  5126     12  BI-HEADER-RECORD  REDEFINES  BI-TEXT-RECORD.
  5127         16  BI-PROCESSOR-CD         PIC X(4).
  5128         16  BI-STATEMENT-TYPE       PIC X.
  5129             88  BI-PREVIEW-ONLY         VALUE 'P'.
  5130         16  BI-NO-OF-COPIES         PIC S9.
  5131         16  BI-CREATION-DT          PIC XX.
  5132         16  BI-INITIAL-PRINT-DATE   PIC XX.
  5133         16  BI-ACCOUNT-TOTALS.
  5134             20  BI-BAL-FRWD         PIC S9(9)V99     COMP-3.
  5135             20  BI-PREMIUM          PIC S9(9)V99     COMP-3.
  5136             20  BI-REMITTED         PIC S9(9)V99     COMP-3.
  5137             20  BI-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5138             20  BI-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5139             20  BI-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5140             20  BI-DISBURSED        PIC S9(9)V99     COMP-3.
  5141             20  BI-END-BAL          PIC S9(9)V99     COMP-3.
  5142         16  BI-FIN-RESP-ACCT        PIC X(10).
  5143         16  BI-FIN-RESP-NAME        PIC X(30).
  5144         16  FILLER                  PIC X(79).
  5145
  5146
  5147     02 GA-BILLING-STATEMENT REDEFINES BILLING-STATEMENT-FILE.
  5148     12  FILLER                      PIC XX.
  5149
  5150     12  GA-CONTROL-PRIMARY.
  5151         16  FILLER                  PIC X(31).
  5152
  5153     12  GA-TEXT-RECORD.
  5154         16  GA-SKIP-CONTROL         PIC X.
  5155         16  GA-TEXT-LINE            PIC X(132).
  5156         16  GA-TEXT-LINE-1 REDEFINES GA-TEXT-LINE.
  5157             20  FILLER              PIC X.
  5158             20  GA-CARRIER          PIC X.
  5159             20  GA-GROUPING         PIC X(6).
  5160             20  GA-DASH             PIC X.
  5161             20  GA-AGENT            PIC X(10).
  5162             20  FILLER              PIC X.
  5163             20  GA-AGENT-ADDR       PIC X(30).
  5164             20  FILLER              PIC X(82).
  5165         16  GA-TEXT-LINE-2 REDEFINES GA-TEXT-LINE.
  5166             20  GA-ACCT             PIC X(10).
  5167             20  FILLER              PIC X.
  5168             20  GA-ACCT-NAME        PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL642T.cbl
  5169             20  GA-BEG-BAL          PIC ZZZZ,ZZZ.99-.
  5170             20  GA-NET-PREM         PIC ZZZZ,ZZZ.ZZ-.
  5171             20  GA-ACCT-COMP        PIC ZZZZ,ZZZ.ZZ-.
  5172             20  GA-PMTS-ADJS        PIC ZZZZ,ZZZ.ZZ-.
  5173             20  GA-UNPAID-NET-PREM  PIC ZZZZ,ZZZ.ZZ-.
  5174             20  GA-BEN-OVERRIDE-L6  PIC X(6).
  5175             20  FILLER              PIC X.
  5176             20  GA-OVERWRITE        PIC ZZZZ,ZZZ.ZZ-.
  5177             20  GA-AMT-DUE          PIC ZZZ,ZZZ.99-.
  5178             20  FILLER              PIC X.
  5179         16  GA-TEXT-LINE-3 REDEFINES GA-TEXT-LINE.
  5180             20  FILLER              PIC X(11).
  5181             20  GA-ENTRY-DESC       PIC X(30).
  5182             20  FILLER              PIC X(60).
  5183             20  GA-ENTRY-COMMENT    PIC X(30).
  5184             20  FILLER              PIC X.
  5185         16  FILLER.
  5186             20  GA-BENEFIT-CD       PIC XX.
  5187             20  GA-BEG-BAL-AMT      PIC S9(7)V99 COMP-3.
  5188             20  GA-END-BAL-AMT      PIC S9(7)V99 COMP-3.
  5189             20  GA-NET-PREM-AMT     PIC S9(7)V99 COMP-3.
  5190             20  GA-ACCT-COMP-AMT    PIC S9(7)V99 COMP-3.
  5191             20  GA-PMTS-ADJS-AMT    PIC S9(7)V99 COMP-3.
  5192             20  GA-UNPAID-NET-AMT   PIC S9(7)V99 COMP-3.
  5193             20  GA-OVERWRITE-AMT    PIC S9(7)V99 COMP-3.
  5194             20  GA-AMT-DUE-AMT      PIC S9(7)V99 COMP-3.
  5195
  5196     12  GA-ADDRESS-RECORD  REDEFINES  GA-TEXT-RECORD.
  5197         16  FILLER                  PIC X.
  5198         16  GA-ACCT-ADDRESS-LINE    PIC X(30).
  5199         16  FILLER                  PIC X(144).
  5200
  5201     12  GA-HEADER-RECORD  REDEFINES  GA-TEXT-RECORD.
  5202         16  GA-PROCESSOR-CD         PIC X(4).
  5203         16  GA-STATEMENT-TYPE       PIC X.
  5204             88  GA-PREVIEW-ONLY         VALUE 'P'.
  5205         16  GA-NO-OF-COPIES         PIC S9.
  5206         16  GA-CREATION-DT          PIC XX.
  5207         16  GA-INITIAL-PRINT-DATE   PIC XX.
  5208         16  GA-AGENT-TOTALS.
  5209             20  GA-NET-UNPD         PIC S9(9)V99     COMP-3.
  5210             20  GA-COMP-UNPD-PREM   PIC S9(9)V99     COMP-3.
  5211             20  GA-PREMIUM          PIC S9(9)V99     COMP-3.
  5212             20  GA-REMITTED         PIC S9(9)V99     COMP-3.
  5213             20  GA-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5214             20  GA-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5215             20  GA-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5216             20  GA-DISBURSED        PIC S9(9)V99     COMP-3.
  5217             20  GA-END-BALANCE      PIC S9(9)V99     COMP-3.
  5218         16  GA-AGENTS-NAME          PIC X(30).
  5219         16  FILLER                  PIC X(81).
  5220     12  FILLER                      PIC XX.
  5221
  5222
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL642T.cbl
  5224*                            COPY ERCCOMM.
  5225******************************************************************
  5226*                                                                *
  5227*                                                                *
  5228*                            ERCCOMM                             *
  5229*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5230*                            VMOD=2.003                          *
  5231*                                                                *
  5232*        FILE DESCRIPTION = COMPENSATION RATES WHEN DIFFERENT    *
  5233*                             FROM THOSE IN ACCOUNT MASTER       *
  5234*                                                                *
  5235*        FILE TYPE= VSAM,KSDS                                    *
  5236*        RECORD SIZE = 250    RECFORM = FIXED                    *
  5237*                                                                *
  5238*        BASE CLUSTER = CRCOMM        RKP=2,LEN=33               *
  5239*                                                                *
  5240*        LOG = YES                                               *
  5241*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5242*                                                                *
  5243******************************************************************
  5244
  5245 01  COMMISSION-EXCEPTIONS.
  5246     12  CE-RECORD-ID                PIC  XX.
  5247         88  VALID-CE-ID         VALUE 'CE'.
  5248
  5249     12  CE-CONTROL-PRIMARY.
  5250         16  CE-COMPANY-CD           PIC  X.
  5251         16  CE-CARRIER              PIC  X.
  5252         16  CE-GROUPING             PIC  X(6).
  5253         16  CE-STATE                PIC  XX.
  5254         16  CE-ACCOUNT              PIC  X(10).
  5255         16  CE-CERT-EFF-DT          PIC  XX.
  5256         16  CE-CERT-NO.
  5257             20  CE-CERT-PRIME       PIC  X(10).
  5258             20  CE-CERT-SFX         PIC  X.
  5259
  5260     12  CE-CERT-EXPIRATION-DT       PIC  XX.
  5261
  5262     12  CE-COMP-STRUCTURE.
  5263         16  CE-DEFN-1.
  5264             20  CE-AGT-COMMS       OCCURS 10 TIMES.
  5265                 24  CE-AGENT-NO    PIC  X(10).
  5266                 24  CE-COMP-TYPE   PIC  X.
  5267                 24  CE-LF-COMP     PIC SV9(5)      COMP-3.
  5268                 24  CE-AH-COMP     PIC SV9(5)      COMP-3.
  5269         16  CE-DEFN-2              REDEFINES CE-DEFN-1.
  5270             20  CE-COMP-TABLES     OCCURS 10 TIMES.
  5271                 24  FILLER         PIC  X(11).
  5272                 24  CE-LF-COMPT    PIC  X(3).
  5273                 24  CE-AH-COMPT    PIC  X(3).
  5274
  5275     12  FILLER                     PIC  X(43).
  5276******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL642T.cbl
  5278*                            COPY ERCCTBL.
  5279******************************************************************
  5280*                                                                *
  5281*                                                                *
  5282*                            ERCCTBL                             *
  5283*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5284*                            VMOD=2.003
  5285*                                                                *
  5286*   ONLINE CREDIT SYSTEM                                         *
  5287*                                                                *
  5288*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  5289*                                                                *
  5290*   FILE TYPE = VSAM,KSDS                                        *
  5291*   RECORD SIZE = 200   RECFORM = FIXED                          *
  5292*                                                                *
  5293*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  5294*       ALTERNATE PATH = NONE                                    *
  5295*                                                                *
  5296*   LOG = NO                                                     *
  5297*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5298*                                                                *
  5299*                                                                *
  5300******************************************************************
  5301
  5302 01  COMM-TABLE-RECORD.
  5303     12  CT-RECORD-ID                      PIC XX.
  5304         88  VALID-CT-ID                      VALUE 'CT'.
  5305
  5306     12  CT-CONTROL-PRIMARY.
  5307         16  CT-COMPANY-CD                 PIC X.
  5308         16  CT-TABLE                      PIC XXX.
  5309         16  CT-CNTRL-2.
  5310             20  CT-BEN-TYPE               PIC X.
  5311             20  CT-BEN-CODE               PIC XX.
  5312
  5313     12  CT-MAINT-INFORMATION.
  5314         16  CT-LAST-MAINT-DT              PIC XX.
  5315         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5316         16  CT-LAST-MAINT-USER            PIC X(4).
  5317         16  FILLER                        PIC X(31).
  5318
  5319     12  CT-LIMITS.
  5320         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  5321
  5322         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  5323
  5324         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  5325
  5326     12  CT-RATES.
  5327         16  CT-RTX          OCCURS 27 TIMES.
  5328             20  CT-RT                     PIC SV9(5)     COMP-3.
  5329             20  CT-RT-R   REDEFINES
  5330                 CT-RT                     PIC XXX.
  5331
  5332     12  FILLER                            PIC  X(42).
  5333
  5334******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL642T.cbl
  5336*                            COPY ERCGXRF.
  5337******************************************************************
  5338*                                                                *
  5339*                                                                *
  5340*                            ERCGXRF                             *
  5341*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5342*                            VMOD=2.002                          *
  5343*                                                                *
  5344*   ONLINE CREDIT SYSTEM                                         *
  5345*                                                                *
  5346*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
  5347*                                                                *
  5348*   FILE TYPE = VSAM,KSDS                                        *
  5349*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  5350*                                                                *
  5351*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
  5352*       ALTERNATE PATH = NONE                                    *
  5353*                                                                *
  5354*   LOG = NO                                                     *
  5355*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5356*                                                                *
  5357******************************************************************
  5358
  5359 01  AGENT-CROSS-REFERENCE.
  5360     12  GX-RECORD-ID                PIC XX.
  5361         88  VALID-GX-ID             VALUE 'GX'.
  5362
  5363     12  GX-CONTROL-PRIMARY.
  5364         16  GX-COMPANY-CD           PIC X.
  5365         16  GX-CARRIER              PIC X.
  5366         16  GX-GROUPING             PIC X(6).
  5367         16  GX-AGENT-NO             PIC X(10).
  5368
  5369     12  GX-MAINT-INFORMATION.
  5370         16  GX-LAST-MAINT-DT        PIC XX.
  5371         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  5372         16  GX-LAST-MAINT-USER      PIC X(4).
  5373         16  FILLER                  PIC X(9).
  5374
  5375     12  FILLER                      PIC X(37).
  5376
  5377     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
  5378
  5379     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
  5380                            DEPENDING ON GX-AGENT-POINTER-CNT.
  5381         16  GX-AM-CARRIER           PIC X.
  5382         16  GX-AM-GROUPING          PIC X(6).
  5383         16  GX-AM-STATE             PIC XX.
  5384         16  GX-AM-ACCOUNT           PIC X(10).
  5385         16  GX-AM-EXPIRATION-DT     PIC XX.
  5386         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
  5387         16  GX-LAST-BILL-DT         PIC XX.
  5388         16  GX-AM-EFF-DT            PIC XX.
  5389         16  FILLER                  PIC X(4).
  5390
  5391******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL642T.cbl
  5393*                            COPY ERCRESC.
  5394******************************************************************
  5395*                                                                *
  5396*                            ERCRESC                             *
  5397*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5398*                            VMOD=2.003                          *
  5399*                                                                *
  5400*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  5401*                                                                *
  5402*   FILE TYPE = VSAM,KSDS                                        *
  5403*   RECORD SIZE = 103 RECFORM = FIXED                            *
  5404*                                                                *
  5405*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  5406*       ALTERNATE PATH1 = NONE                                   *
  5407*                                                                *
  5408*   LOG = NO                                                     *
  5409*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5410*                                                                *
  5411******************************************************************
  5412
  5413 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  5414
  5415     10  ERRESC-RECORD-KEY.
  5416         15  RESC-COMPANY-CD           PIC   X.
  5417         15  RESC-CARRIER              PIC   X.
  5418         15  RESC-GROUP                PIC   X(6).
  5419         15  RESC-STATE                PIC   XX.
  5420         15  RESC-ACCOUNT              PIC   X(10).
  5421         15  RESC-AGENT                PIC   X(10).
  5422         15  RESC-RESIDENT-STATE       PIC   XX.
  5423         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  5424*                                           YYYYMMDD
  5425     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  5426
  5427     10  RESC-COMM-RECORD-DATA.
  5428         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  5429             20 RESC-COVERAGE-CAT      PIC    X.
  5430             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  5431             20 RESC-COMMISSION-TAB REDEFINES
  5432                RESC-COMMISSION-PER    PIC  XXX.
  5433
  5434     10  RESC-MAINT-BY                 PIC X(4).
  5435     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  5436     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  5437*                                          YYYYMMDD
  5438
  5439 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  5440                          CONTROL-FILE COMPENSATION-MASTER
  5441                          PENDING-PAY-ADJ ACCOUNT-MASTER
  5442                          BILLING-STATEMENT
  5443                          COMMISSION-EXCEPTIONS
  5444                          COMM-TABLE-RECORD
  5445                          AGENT-CROSS-REFERENCE
  5446                          ACCOUNT-RESIDENT-ST-COMMISSION.
  5447 0000-DFHEXIT SECTION.
  5448     MOVE '9#                    $   ' TO DFHEIV0.
  5449     MOVE 'EL642' TO DFHEIV1.
  5450     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL642T.cbl
  5451
  5452     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5453     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5454     MOVE EIBTRMID               TO  QID-TERM.
  5455     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5456     MOVE '5'                    TO  DC-OPTION-CODE.
  5457
  5458     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  5459
  5460     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-DATE.
  5461     MOVE DC-GREG-DATE-1-MDY     TO  WS-CURRENT-DATE-MDY.
  5462     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DATE-EDIT.
  5463
  5464     IF EIBCALEN  =  ZERO
  5465         GO TO 8800-UNAUTHORIZED-ACCESS.
  5466
  5467     IF PI-RETURN-TO-PROGRAM  =  THIS-PGM
  5468         MOVE PI-CALLING-PROGRAM  TO  RETURNED-FROM.
  5469
  5470     IF PI-CALLING-PROGRAM NOT  =  THIS-PGM
  5471         IF PI-RETURN-TO-PROGRAM NOT  =  THIS-PGM
  5472             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  5473             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  5474             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  5475             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  5476             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  5477             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  5478             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  5479             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  5480             MOVE PI-CR-CONTROL-IN-PROGRESS
  5481                                        TO  W-TRANSFER-CONTROL
  5482             MOVE SPACES
  5483                                   TO  PI-CR-CONTROL-IN-PROGRESS
  5484         ELSE
  5485             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  5486             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  5487             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  5488             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  5489             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  5490             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  5491             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  5492             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  5493
  5494     MOVE LOW-VALUES             TO  EL642AI.
  5495
  5496     IF PI-AR-PROCESSING
  5497        MOVE XCTL-635            TO XCTL-PYAJ.
  5498
  5499     IF PI-COMPANY-ID = 'DMD'
  5500        MOVE XCTL-633DMD         TO XCTL-PYAJ.
  5501
  5502     IF RETURNED-FROM  NOT =  SPACES
  5503         PERFORM 0600-RECOVER-TEMP-STORAGE  THRU  0690-EXIT
  5504         IF RETURNED-FROM  =  XCTL-PYAJ
  5505           AND  NOT  PI-VOID-BILL
  5506             MOVE ZEROS          TO  PI-ADJUSTMNTS
  5507                                     PI-DISBURSED
  5508                                     PI-REMITTED
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL642T.cbl
  5509             GO TO 1200-PYAJ-BILLING-COMPLETE
  5510         ELSE
  5511             MOVE -1             TO  APFNTERL
  5512             IF PI-TRANSFER-BEFORE-ACT
  5513                 GO TO 8100-SEND-INITIAL-MAP
  5514             ELSE
  5515                 PERFORM 5000-FORMAT-SCREEN  THRU  5090-EXIT
  5516                 GO TO 8100-SEND-INITIAL-MAP.
  5517
  5518     IF EIBTRNID  NOT =  TRANS-ID
  5519         MOVE EL642A             TO  PI-MAP-NAME
  5520         MOVE -1                 TO  APFNTERL
  5521         GO TO 8100-SEND-INITIAL-MAP.
  5522
  5523
  5524* EXEC CICS HANDLE CONDITION
  5525*        PGMIDERR  (9600-PGMID-ERROR)
  5526*        ERROR     (9990-ABEND)
  5527*    END-EXEC.
  5528*    MOVE '"$L.                  ! " #00005519' TO DFHEIV0
  5529     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5530     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5531     MOVE X'2220233030303035353139' TO DFHEIV0(25:11)
  5532     CALL 'kxdfhei1' USING DFHEIV0
  5533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5534
  5535
  5536     IF EIBAID  =  DFHCLEAR
  5537         IF PI-MAP-NAME  =  EL642B
  5538             PERFORM 5000-FORMAT-SCREEN  THRU  5090-EXIT
  5539             MOVE EL642A         TO  PI-MAP-NAME
  5540             MOVE -1             TO  APFNTERL
  5541             GO TO 8100-SEND-INITIAL-MAP
  5542         ELSE
  5543             GO TO 9400-CLEAR.
  5544
  5545     IF PI-PROCESSOR-ID  =  'LGXX'
  5546         GO TO 0200-RECEIVE.
  5547
  5548
  5549* EXEC CICS READQ TS
  5550*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  5551*        INTO    (SECURITY-CONTROL)
  5552*        LENGTH  (SC-COMM-LENGTH)
  5553*        ITEM    (SC-ITEM)
  5554*    END-EXEC.
  5555*    MOVE '*$II   L              ''   #00005536' TO DFHEIV0
  5556     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5557     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5558     MOVE X'2020233030303035353336' TO DFHEIV0(25:11)
  5559     CALL 'kxdfhei1' USING DFHEIV0,
  5560           PI-SECURITY-TEMP-STORE-ID,
  5561           SECURITY-CONTROL,
  5562           SC-COMM-LENGTH,
  5563           SC-ITEM,
  5564           DFHEIV99,
  5565           DFHEIV99
  5566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL642T.cbl
  5567
  5568
  5569     MOVE SC-CREDIT-DISPLAY (19)  TO  PI-DISPLAY-CAP.
  5570     MOVE SC-CREDIT-UPDATE  (19)  TO  PI-MODIFY-CAP.
  5571
  5572     IF NOT  DISPLAY-CAP
  5573         MOVE 'READ'              TO  SM-READ
  5574         PERFORM 9995-SECURITY-VIOLATION
  5575         MOVE ER-0070             TO  EMI-ERROR
  5576         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5577         GO TO 8100-SEND-INITIAL-MAP.
  5578
  5579 0200-RECEIVE.
  5580     IF EIBAID  =  DFHPA1  OR  DFHPA2  OR  DFHPA3
  5581         MOVE ER-0008            TO  EMI-ERROR
  5582         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5583         IF PI-MAP-NAME  =  EL642A
  5584             MOVE -1             TO  APFNTERL
  5585             GO TO 8200-SEND-DATAONLY
  5586         ELSE
  5587             MOVE -1             TO  BPFNTERL
  5588             GO TO 8200-SEND-DATAONLY.
  5589
  5590
  5591* EXEC CICS RECEIVE
  5592*        MAP     (PI-MAP-NAME)
  5593*        MAPSET  (MAPSET-NAME)
  5594*        INTO    (EL642AI)
  5595*    END-EXEC.
  5596     MOVE LENGTH OF
  5597      EL642AI
  5598       TO DFHEIV11
  5599*    MOVE '8"T I  L              ''   #00005564' TO DFHEIV0
  5600     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5601     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5602     MOVE X'2020233030303035353634' TO DFHEIV0(25:11)
  5603     CALL 'kxdfhei1' USING DFHEIV0,
  5604           PI-MAP-NAME,
  5605           EL642AI,
  5606           DFHEIV11,
  5607           MAPSET-NAME,
  5608           DFHEIV99,
  5609           DFHEIV99
  5610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5611
  5612
  5613     IF PI-MAP-NAME  =  EL642A
  5614         IF APFNTERL  GREATER THAN  ZERO
  5615             IF EIBAID  NOT =  DFHENTER
  5616                 MOVE ER-0004    TO  EMI-ERROR
  5617                 MOVE AL-UNBOF   TO  APFNTERA
  5618                 MOVE -1         TO  APFNTERL
  5619                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5620                 GO TO 8200-SEND-DATAONLY
  5621             ELSE
  5622                 IF APFNTERI  NUMERIC
  5623                   AND  APFNTERI  GREATER THAN  ZERO
  5624                   AND  APFNTERI  LESS THAN  25
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL642T.cbl
  5625                     MOVE PF-VALUES (APFNTERI)  TO  EIBAID
  5626                 ELSE
  5627                     MOVE ER-0029   TO  EMI-ERROR
  5628                     MOVE AL-UNBOF  TO  APFNTERA
  5629                     MOVE -1        TO  APFNTERL
  5630                     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5631                     GO TO 8200-SEND-DATAONLY
  5632         ELSE
  5633             NEXT SENTENCE
  5634     ELSE
  5635         IF PI-MAP-NAME  =  EL642B
  5636             IF BPFNTERL  GREATER THAN  ZERO
  5637                 IF EIBAID  NOT =  DFHENTER
  5638                     MOVE ER-0004   TO  EMI-ERROR
  5639                     MOVE AL-UNBOF  TO  BPFNTERA
  5640                     MOVE -1        TO  BPFNTERL
  5641                     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5642                     GO TO 8200-SEND-DATAONLY
  5643                 ELSE
  5644                     IF BPFNTERI  NUMERIC
  5645                       AND  BPFNTERI  GREATER THAN  ZERO
  5646                       AND  BPFNTERI  LESS THAN  25
  5647                         MOVE PF-VALUES (BPFNTERI)  TO  EIBAID
  5648                     ELSE
  5649                         MOVE ER-0029   TO  EMI-ERROR
  5650                         MOVE AL-UNBOF  TO  BPFNTERA
  5651                         MOVE -1        TO  BPFNTERL
  5652                         PERFORM 9900-ERROR-FORMAT
  5653                             THRU  9900-EXIT
  5654                         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL642T.cbl
  5656 0300-CHECK-PFKEYS.
  5657     IF EIBAID  =  DFHPF23
  5658         GO TO 8810-PF23.
  5659
  5660     IF EIBAID  =  DFHPF24
  5661         GO TO 9200-RETURN-MAIN-MENU.
  5662
  5663     IF EIBAID  =  DFHPF12
  5664         GO TO 9500-PF12.
  5665
  5666 0310-CHECK-PFKEYS.
  5667     IF EIBAID  =  DFHPF3
  5668       AND  PI-MAP-NAME  =  EL642A
  5669         PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5670         MOVE SPACES             TO  PI-CR-CONTROL-IN-PROGRESS
  5671         MOVE XCTL-650           TO  PGM-NAME
  5672         GO TO 9300-XCTL.
  5673
  5674     IF EIBAID  =  DFHPF4
  5675       AND  PI-MAP-NAME  =  EL642A
  5676        NEXT SENTENCE
  5677     ELSE
  5678        GO TO 0320-CONT-PFKEYS.
  5679
  5680     IF PI-CR-FIN-RESP  NOT =  SPACES
  5681         MOVE PI-COMP-CARRIER   TO  PI-CR-CARRIER
  5682         MOVE PI-COMP-GROUPING  TO  PI-CR-GROUPING
  5683         MOVE SPACE             TO  PI-CR-STATE
  5684         MOVE LOW-VALUES        TO  PI-CR-ACCOUNT
  5685         MOVE PI-SAV-AGENT      TO  PI-CR-FIN-RESP
  5686         MOVE 'G'               TO  PI-CR-TYPE
  5687         PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5688         MOVE XCTL-652       TO  PGM-NAME
  5689         GO TO 9300-XCTL.
  5690
  5691     IF PI-SCR-FIN-RESP EQUAL SPACES OR LOW-VALUES
  5692         GO TO 0315-PF4-ERROR.
  5693
  5694     PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT.
  5695
  5696     MOVE PI-SCR-CARRIER        TO  PI-CR-CARRIER.
  5697     MOVE PI-SCR-GROUPING       TO  PI-CR-GROUPING.
  5698     MOVE SPACE                 TO  PI-CR-STATE.
  5699     MOVE LOW-VALUES            TO  PI-CR-ACCOUNT.
  5700     MOVE PI-SCR-FIN-RESP       TO  PI-CR-FIN-RESP.
  5701     MOVE 'G'                   TO  PI-CR-TYPE.
  5702     MOVE 'Y'                   TO  PI-TRANSFER-SW.
  5703
  5704     IF PI-ZERO-CARRIER
  5705       OR  PI-ZERO-CAR-GROUP
  5706         MOVE ZEROS              TO  PI-CR-CARRIER.
  5707
  5708     IF PI-ZERO-GROUPING
  5709        OR  PI-ZERO-CAR-GROUP
  5710         MOVE ZEROS              TO  PI-CR-GROUPING.
  5711
  5712     MOVE XCTL-652       TO  PGM-NAME
  5713
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL642T.cbl
  5714     GO TO 9300-XCTL.
  5715
  5716 0315-PF4-ERROR.
  5717
  5718     MOVE ER-2407        TO  EMI-ERROR.
  5719     MOVE -1             TO  APFNTERL.
  5720     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5721     GO TO 8200-SEND-DATAONLY.
  5722
  5723 0320-CONT-PFKEYS.
  5724
  5725     IF EIBAID  =  DFHPF6
  5726       AND  PI-MAP-NAME  =  EL642A
  5727         MOVE LOW-VALUES         TO  EL642AO
  5728         MOVE PI-SAV-CARR        TO  PI-CR-CARRIER
  5729         MOVE PI-SAV-GROUP       TO  PI-CR-GROUPING
  5730         MOVE SPACE              TO  PI-CR-STATE
  5731         MOVE LOW-VALUES         TO  PI-CR-ACCOUNT
  5732         MOVE PI-SAV-AGENT       TO  PI-CR-FIN-RESP
  5733         MOVE 'G'                TO  PI-CR-TYPE
  5734         PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5735         MOVE XCTL-6401          TO  PGM-NAME
  5736         GO TO 9300-XCTL.
  5737
  5738     IF EIBAID  =  DFHPF7
  5739       AND  PI-MAP-NAME  =  EL642A
  5740         IF PI-CR-FIN-RESP  NOT =  SPACES
  5741             MOVE PI-COMP-CARRIER   TO  PI-CR-CARRIER
  5742             MOVE PI-COMP-GROUPING  TO  PI-CR-GROUPING
  5743             MOVE SPACE             TO  PI-CR-STATE
  5744             MOVE LOW-VALUES        TO  PI-CR-ACCOUNT
  5745             MOVE PI-SAV-AGENT      TO  PI-CR-FIN-RESP
  5746             MOVE 'G'               TO  PI-CR-TYPE
  5747             PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5748             MOVE XCTL-PYAJ      TO  PGM-NAME
  5749             GO TO 9300-XCTL
  5750         ELSE
  5751             IF PI-RETURN-TO-PROGRAM = XCTL-633 OR XCTL-635 OR
  5752                                       XCTL-633DMD
  5753                 GO TO 9400-CLEAR
  5754            ELSE
  5755                 MOVE ER-2411        TO  EMI-ERROR
  5756                 MOVE -1             TO  APFNTERL
  5757                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5758                 GO TO 8200-SEND-DATAONLY.
  5759
  5760     IF EIBAID  =  DFHPF8
  5761       AND  PI-MAP-NAME  =  EL642A
  5762         IF PI-CR-FIN-RESP  NOT =  SPACES
  5763             MOVE PI-SAV-CARR    TO  PI-CR-CARRIER
  5764             MOVE PI-SAV-GROUP   TO  PI-CR-GROUPING
  5765             MOVE SPACE          TO  PI-CR-STATE
  5766             MOVE LOW-VALUES     TO  PI-CR-ACCOUNT
  5767             MOVE PI-SAV-AGENT   TO  PI-CR-FIN-RESP
  5768             MOVE 'G'            TO  PI-CR-TYPE
  5769             PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5770             MOVE XCTL-658       TO  PGM-NAME
  5771             GO TO 9300-XCTL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL642T.cbl
  5772         ELSE
  5773         IF PI-SCR-FIN-RESP  NOT =  SPACES
  5774             PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5775             MOVE PI-SCR-CARRIER  TO  PI-CR-CARRIER
  5776             MOVE PI-SCR-GROUPING TO  PI-CR-GROUPING
  5777             MOVE SPACE           TO  PI-CR-STATE
  5778             MOVE LOW-VALUES      TO  PI-CR-ACCOUNT
  5779             MOVE PI-SCR-FIN-RESP TO  PI-CR-FIN-RESP
  5780             MOVE 'G'             TO  PI-CR-TYPE
  5781             MOVE XCTL-658       TO  PGM-NAME
  5782             GO TO 9300-XCTL
  5783         ELSE
  5784             MOVE ER-2399        TO  EMI-ERROR
  5785             MOVE -1             TO  APFNTERL
  5786             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5787             GO TO 8200-SEND-DATAONLY.
  5788
  5789     IF EIBAID  =  DFHPF1
  5790       AND  PI-MAP-NAME  =  EL642B
  5791         GO TO 7500-PRODUCE-CHECK.
  5792
  5793     IF EIBAID  =  DFHPF5
  5794       AND  PI-MAP-NAME  =  EL642A
  5795         IF PI-CR-FIN-RESP NOT  =  SPACES
  5796             MOVE PI-SAV-CARR    TO  PI-CR-CARRIER
  5797             MOVE PI-SAV-GROUP   TO  PI-CR-GROUPING
  5798             MOVE SPACE          TO  PI-CR-STATE
  5799             MOVE LOW-VALUES     TO  PI-CR-ACCOUNT
  5800             MOVE PI-SAV-AGENT   TO  PI-CR-FIN-RESP
  5801             MOVE 'G'            TO  PI-CR-TYPE
  5802             MOVE EL642B         TO  PI-MAP-NAME
  5803             GO TO 7000-PROCESS-CHECK
  5804         ELSE
  5805             MOVE ER-2400        TO  EMI-ERROR
  5806             MOVE -1             TO  APFNTERL
  5807             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5808             GO TO 8200-SEND-DATAONLY.
  5809
  5810     IF PI-MAP-NAME  =  EL642A
  5811         IF EIBAID  =  DFHENTER
  5812           OR  DFHPF3
  5813             GO TO 0330-EDIT-DATA.
  5814
  5815 0320-INPUT-ERROR.
  5816     MOVE ER-0029                TO  EMI-ERROR.
  5817
  5818     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5819
  5820     IF PI-MAP-NAME  =  EL642A
  5821         MOVE AL-UNBON           TO  APFNTERA
  5822         MOVE -1                 TO  APFNTERL
  5823     ELSE
  5824         MOVE AL-UNBON           TO  BPFNTERA
  5825         MOVE -1                 TO  BPFNTERL.
  5826
  5827     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL642T.cbl
  5829 0330-EDIT-DATA.
  5830     MOVE ABILTYPI               TO  VALID-BILL-TYPE-VALUES.
  5831
  5832     IF VALID-BILL-TYPE
  5833         IF NOT MODIFY-CAP
  5834             IF ABILTYPI  =  '1' OR '2'
  5835                 NEXT SENTENCE
  5836             ELSE
  5837                 MOVE 'UPDATE'   TO  SM-READ
  5838                 PERFORM 9995-SECURITY-VIOLATION
  5839                 MOVE ER-0070    TO  EMI-ERROR
  5840                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5841                 GO TO 8100-SEND-INITIAL-MAP.
  5842
  5843     MOVE SPACES                 TO  PI-LIMIT-BILLING-ACCOUNTS.
  5844
  5845 0350-ERROR-CHECK.
  5846     IF EMI-ERROR  =  ZEROS
  5847         NEXT SENTENCE
  5848     ELSE
  5849         GO TO 8200-SEND-DATAONLY.
  5850
  5851     IF AAGENTL  GREATER THAN  ZEROS
  5852         MOVE AL-UANON           TO  AAGENTA
  5853         MOVE AAGENTI            TO  PI-SAV-AGENT
  5854     ELSE
  5855         MOVE -1                 TO  AAGENTL
  5856         MOVE AL-UABON           TO  AAGENTA
  5857         MOVE ER-2910            TO  EMI-ERROR
  5858         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5859
  5860     IF ACARIERL  GREATER THAN  ZEROS
  5861         MOVE AL-UANON           TO  ACARIERA
  5862         MOVE ACARIERI           TO  PI-SAV-CARR
  5863                                     PI-CR-CARRIER
  5864                                     PI-COMP-CARRIER
  5865     ELSE
  5866         IF NOT  PI-ZERO-CARRIER
  5867           AND  NOT  PI-ZERO-CAR-GROUP
  5868             MOVE -1             TO  ACARIERL
  5869             MOVE AL-UABON       TO  ACARIERA
  5870             MOVE ER-0194        TO  EMI-ERROR
  5871             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5872         ELSE
  5873             MOVE ZERO           TO  PI-SAV-CARR
  5874                                     PI-COMP-CARRIER.
  5875
  5876     IF AGROUPL  GREATER THAN  ZEROS
  5877         MOVE AL-UANON           TO  AGROUPA
  5878         MOVE AGROUPI            TO  PI-SAV-GROUP
  5879                                     PI-CR-GROUPING
  5880                                     PI-COMP-GROUPING
  5881     ELSE
  5882         IF NOT  PI-ZERO-GROUPING
  5883           AND  NOT  PI-ZERO-CAR-GROUP
  5884             MOVE -1             TO  AGROUPL
  5885             MOVE AL-UABON       TO  AGROUPA
  5886             MOVE ER-0195        TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL642T.cbl
  5887             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5888         ELSE
  5889             MOVE ZERO           TO  PI-SAV-GROUP
  5890                                     PI-COMP-GROUPING.
  5891
  5892     MOVE ABILTYPI               TO  VALID-BILL-TYPE-VALUES.
  5893
  5894     IF VALID-BILL-TYPE
  5895         MOVE AL-UANON           TO  ABILTYPA
  5896         MOVE ABILTYPI           TO  PI-BILL-TYPE
  5897                                     WS-BILL-TYPE
  5898     ELSE
  5899         MOVE -1                 TO  ABILTYPL
  5900         MOVE ER-2249            TO  EMI-ERROR
  5901         MOVE AL-UABON           TO  ABILTYPA
  5902         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5903
  5904     IF PI-AR-PROCESSING
  5905        IF PI-PREVIEW
  5906           NEXT SENTENCE
  5907        ELSE
  5908           MOVE -1               TO ABILTYPL
  5909           MOVE ER-3145          TO EMI-ERROR
  5910           MOVE AL-UABON         TO ABILTYPA
  5911           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5912
  5913     IF APRODSWL  NOT =  ZEROS
  5914         IF PI-PREVIEW
  5915             IF APRODSWI  =  'Y'  OR  'N'
  5916                 MOVE AL-UANON   TO  APRODSWA
  5917             ELSE
  5918                 MOVE -1         TO  APRODSWL
  5919                 MOVE ER-2436    TO  EMI-ERROR
  5920                 MOVE AL-UABON   TO  APRODSWA
  5921                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5922         ELSE
  5923             MOVE -1             TO  APRODSWL
  5924             MOVE ER-2434        TO  EMI-ERROR
  5925             MOVE AL-UABON       TO  APRODSWA
  5926             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5927     ELSE
  5928         IF PI-PREVIEW
  5929             MOVE -1             TO  APRODSWL
  5930             MOVE ER-2435        TO  EMI-ERROR
  5931             MOVE AL-UABON       TO  APRODSWA
  5932             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5933
  5934     IF AACCT1L  NOT =  ZEROS
  5935         MOVE AL-UANON           TO  AACCT1A
  5936         MOVE 'Y'                TO  LIMIT-BILLING-SW
  5937         MOVE AACCT1I            TO  PI-BILLING-ACCOUNTS (1).
  5938
  5939     IF AACCT2L  NOT =  ZEROS
  5940         MOVE AL-UANON           TO  AACCT2A
  5941         MOVE 'Y'                TO  LIMIT-BILLING-SW
  5942         MOVE AACCT2I            TO  PI-BILLING-ACCOUNTS (2).
  5943
  5944     IF AACCT3L  NOT =  ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL642T.cbl
  5945         MOVE AL-UANON           TO  AACCT3A
  5946         MOVE 'Y'                TO  LIMIT-BILLING-SW
  5947         MOVE AACCT3I            TO  PI-BILLING-ACCOUNTS (3).
  5948
  5949     IF EMI-ERROR  =  ZEROS
  5950         GO TO 1000-BILLING-PROCESS.
  5951
  5952     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL642T.cbl
  5954 0500-CREATE-TEMP-STORAGE.
  5955     IF PI-BAL-FRWD  NOT  NUMERIC
  5956         MOVE ZEROS              TO  PI-BAL-FRWD
  5957                                     PI-PREMIUM
  5958                                     PI-REMITTED
  5959                                     PI-TOT-ISS-COMP
  5960                                     PI-TOT-CAN-COMP
  5961                                     PI-ADJUSTMNTS
  5962                                     PI-DISBURSED
  5963                                     PI-END-BAL
  5964                                     PI-UNPAID-NET-PREM
  5965                                     PI-COMP-UNPAID-PREM
  5966                                     PI-LF-ISS-COMP
  5967                                     PI-AH-ISS-COMP
  5968                                     PI-LF-CAN-COMP
  5969                                     PI-AH-CAN-COMP
  5970                                     PI-DUE-FOR-ACCT
  5971                                     PI-ACCT-BEG-BAL
  5972                                     PI-ACCT-NET-PREM
  5973                                     PI-ACCT-COMP
  5974                                     PI-ACCT-PAY-ADJS.
  5975
  5976
  5977* EXEC CICS WRITEQ TS
  5978*        QUEUE   (QID)
  5979*        FROM    (PROGRAM-INTERFACE-BLOCK)
  5980*        LENGTH  (PI-COMM-LENGTH)
  5981*    END-EXEC.
  5982*    MOVE '*"                    ''   #00005933' TO DFHEIV0
  5983     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  5984     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5985     MOVE X'2020233030303035393333' TO DFHEIV0(25:11)
  5986     CALL 'kxdfhei1' USING DFHEIV0,
  5987           QID,
  5988           PROGRAM-INTERFACE-BLOCK,
  5989           PI-COMM-LENGTH,
  5990           DFHEIV99,
  5991           DFHEIV99,
  5992           DFHEIV99
  5993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5994
  5995
  5996 0590-EXIT.
  5997      EXIT.
  5998
  5999 0600-RECOVER-TEMP-STORAGE.
  6000
  6001* EXEC CICS READQ TS
  6002*        QUEUE   (QID)
  6003*        INTO    (PROGRAM-INTERFACE-BLOCK)
  6004*        LENGTH  (PI-COMM-LENGTH)
  6005*    END-EXEC.
  6006*    MOVE '*$I    L              ''   #00005943' TO DFHEIV0
  6007     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  6008     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6009     MOVE X'2020233030303035393433' TO DFHEIV0(25:11)
  6010     CALL 'kxdfhei1' USING DFHEIV0,
  6011           QID,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL642T.cbl
  6012           PROGRAM-INTERFACE-BLOCK,
  6013           PI-COMM-LENGTH,
  6014           DFHEIV99,
  6015           DFHEIV99,
  6016           DFHEIV99
  6017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6018
  6019
  6020     PERFORM 0800-DELETE-TS  THRU  0890-EXIT.
  6021
  6022     MOVE PI-SCRN-CONTROL TO W-TRANSFER-CONTROL.
  6023
  6024 0690-EXIT.
  6025      EXIT.
  6026
  6027 0800-DELETE-TS.
  6028
  6029* EXEC CICS HANDLE CONDITION
  6030*        QIDERR  (0890-EXIT)
  6031*    END-EXEC.
  6032*    MOVE '"$N                   ! # #00005957' TO DFHEIV0
  6033     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  6034     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6035     MOVE X'2320233030303035393537' TO DFHEIV0(25:11)
  6036     CALL 'kxdfhei1' USING DFHEIV0
  6037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6038
  6039
  6040
  6041* EXEC CICS DELETEQ TS
  6042*        QUEUE  (QID)
  6043*    END-EXEC.
  6044*    MOVE '*&                    #   #00005961' TO DFHEIV0
  6045     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  6046     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6047     MOVE X'2020233030303035393631' TO DFHEIV0(25:11)
  6048     CALL 'kxdfhei1' USING DFHEIV0,
  6049           QID,
  6050           DFHEIV99
  6051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6052
  6053
  6054 0890-EXIT.
  6055      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL642T.cbl
  6057******************************************************************
  6058*    THIS SECTION PROCESSES THE PENDING BUSINESS FILE BASED ON   *
  6059*    ACCOUNT DATE RANGES FOR EACH ACCOUNT THAT A GENERAL AGENT   *
  6060*    RECEIVES COMMISION FROM.  THE PROFILE OF A GENERAL AGENT    *
  6061*    IS MAINTAINED IN THE AGENT-CROSS-REFERENCE FILE.            *
  6062*                                                                *
  6063*    1.  IF VOID BILLING                                         *
  6064*            GO TO VOID-BILLING.                                 *
  6065*                                                                *
  6066*    2.  READ COMPENSATIONG MASTER FOR GENERAL AGENT TO GET      *
  6067*        THE AGENT'S ENDING BALANCE AND ADDRESS.                 *
  6068*                                                                *
  6069*    3.  READ THE AGENT-CROSS-REFERENCE-FILE.                    *
  6070*                                                                *
  6071*    4.  PROCESS EACH ACCOUNT ASSOCIATED WITH A GENERAL AGENT.   *
  6072*                                                                *
  6073*        A.  PROCESSS EACH DATE RANGE PER ACCOUNT AND ACCUMULATE *
  6074*            STATISTICS FOR THAT ACCOUNT.                        *
  6075*                                                                *
  6076*            1. PROCESS THE ACTIVE RECORDS ON PENDING BUSINESS.  *
  6077*               OMIT ANY RECORDS THAT HAVE ANY FATAL OR UNFORCED *
  6078*               ERRORS.  DO NOT PROCESS ANY REINSURANCE OR BILL- *
  6079*               ING ADJUSTMENT RECORDS.  IF BILLING UPDATE, FLAG
  6080*               EACH PENDING BUSINESS RECORD THAT IS PRCESSED.   *
  6081*                                                                *
  6082*            2.  ACCUMULATE STATISTICS FOR SCREEN DISPLAY.       *
  6083*                                                                *
  6084*            3.  COMPUTE ACCOUNT AND AGENT COMMISSION.           *
  6085*                                                                *
  6086*         B.  ACCUMULATE THE PAYMENT AND ADJUSTMENTS FOR         *
  6087*             EACH ACCOUNT THE GENERAL AGENT IS RESPONSIBLE FOR. *
  6088*                                                                *
  6089*         C.  PRINT ACCUMULATED STATISTICS FOR EACH ACCOUNT.     *
  6090*             OMITT ANY ACCOUNTS THAT DIDN'T HAVE ANY NEW BUS.   *
  6091*                                                                *
  6092*    5.  PRINT AN AGENT TOTAL OF ALL THE ACCOUNTS AND THE        *
  6093*        GENERAL AGENTS PAYMENTS AND ADJUSTMENTS.                *
  6094******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL642T.cbl
  6096 1000-BILLING-PROCESS.
  6097     MOVE PI-COMPANY-CD          TO  ERPNDB-CO-CD
  6098                                     ERPNDB-CO-CD-A1
  6099                                     ERCOMP-COMP-CD
  6100                                     ERPYAJ-COMP-CD
  6101                                     ERACCT-P-CO-CD
  6102                                     ERACCT-A-CO-CD
  6103                                     ERCOMM-COMPANY-CD
  6104                                     ERCTBL-COMPANY-CD.
  6105
  6106     MOVE ZEROS                  TO  PI-BAL-FRWD
  6107                                     PI-UNKNOWN
  6108                                     PI-UNPAID-NET-PREM
  6109                                     PI-COMP-UNPAID-PREM
  6110                                     PI-PREMIUM
  6111                                     PI-REMITTED
  6112                                     PI-TOT-ISS-COMP
  6113                                     PI-TOT-CAN-COMP
  6114                                     PI-ADJUSTMNTS
  6115                                     PI-DISBURSED
  6116                                     PI-END-BAL
  6117                                     PI-LF-ISS-COMP
  6118                                     PI-AH-ISS-COMP
  6119                                     PI-LF-CAN-COMP
  6120                                     PI-AH-CAN-COMP
  6121                                     PI-DUE-FOR-ACCT
  6122                                     PI-ACCT-BEG-BAL
  6123                                     PI-ACCT-NET-PREM
  6124                                     PI-ACCT-COMP
  6125                                     PI-ACCT-PAY-ADJS
  6126                                     PI-ISSUES-BILLED
  6127                                     PI-ISSUES-INER
  6128                                     PI-ISSUES-PREV
  6129                                     PI-CANCELS-BILLED
  6130                                     PI-CANCELS-INER
  6131                                     PI-CANCELS-PREV.
  6132
  6133     IF PI-VOID-BILL
  6134         GO TO 2000-VOID-BILLING.
  6135
  6136     MOVE SPACES                 TO  ELCNTL-KEY.
  6137     MOVE '1'                    TO  ELCNTL-REC-TYPE.
  6138
  6139     PERFORM 6100-READ-CONTROL-FILE  THRU  6190-EXIT.
  6140
  6141     IF EMI-ERROR  NOT =  ZEROS
  6142         GO TO 8200-SEND-DATAONLY.
  6143
  6144     IF CF-ACCOUNT-MSTR-MAINT-DT  =  LOW-VALUES
  6145       OR  CF-COMPENSATION-MSTR-MAINT-DT  =  LOW-VALUES
  6146         MOVE ER-2571            TO  EMI-ERROR
  6147         MOVE -1                 TO  APFNTERL
  6148         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6149         GO TO 8200-SEND-DATAONLY.
  6150
  6151     IF CF-FORMS-PRINTER-ID  =  SPACES
  6152       AND  (ABILTYPI = '3'  OR  '4')
  6153         MOVE ER-2590            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL642T.cbl
  6154         MOVE -1                 TO  ABILTYPL
  6155         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6156         GO TO 8200-SEND-DATAONLY.
  6157
  6158     MOVE CF-CURRENT-MONTH-END   TO  DC-BIN-DATE-1.
  6159     MOVE SPACE                  TO  DC-OPTION-CODE.
  6160
  6161     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  6162
  6163     MOVE DC-GREG-DATE-1-EDIT    TO  PI-MONTH-END-DATE.
  6164     MOVE WS-CURRENT-DATE-EDIT   TO  HD-RUN-DT.
  6165     MOVE CF-CL-MAIL-TO-NAME     TO  CENTER-WORK-1.
  6166     MOVE +44                    TO  X-LEN.
  6167
  6168     PERFORM 8600-CENTER-DATA  THRU  8690-C-D-X.
  6169
  6170     MOVE CENTER-WORK-2          TO  HD-CO.
  6171     MOVE SPACE                  TO  PI-DATA-BILLED-SW.
  6172     MOVE 'G'                    TO  COMPENSATION-SW
  6173                                     PI-CR-TYPE.
  6174
  6175     PERFORM 6000-READ-COMP-MASTER  THRU  6090-EXIT.
  6176
  6177     PERFORM 6400-READ-CROSS-REFERENCE  THRU  6490-EXIT.
  6178
  6179     MOVE +0                     TO  GX-SUB.
  6180
  6181 1005-GXRF-BILLING-PROCESS-LOOP.
  6182     ADD +1                      TO  GX-SUB.
  6183
  6184     IF GX-SUB  GREATER THAN  GX-AGENT-POINTER-CNT
  6185         IF PI-ACCT-BILLED
  6186             PERFORM 1100-PYAJ-BILLING-PROCESS  THRU  1190-EXIT
  6187             GO TO 1200-PYAJ-BILLING-COMPLETE
  6188         ELSE
  6189             GO TO 1200-PYAJ-BILLING-COMPLETE.
  6190
  6191     IF LIMIT-BILLING
  6192         IF GX-AM-ACCOUNT (GX-SUB)  =  PI-BILLING-ACCOUNTS (1)
  6193                                   OR  PI-BILLING-ACCOUNTS (2)
  6194                                   OR  PI-BILLING-ACCOUNTS (3)
  6195             NEXT SENTENCE
  6196         ELSE
  6197             GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6198
  6199     IF FIRST-TIME
  6200         MOVE 'N'                      TO  FIRST-TIME-SW
  6201         MOVE GX-AM-CARRIER (GX-SUB)   TO  PI-CR-CARRIER
  6202         MOVE GX-AM-GROUPING (GX-SUB)  TO  PI-CR-GROUPING
  6203         MOVE GX-AM-STATE (GX-SUB)     TO  PI-CR-STATE
  6204         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  PI-CR-ACCOUNT.
  6205
  6206     IF GX-AM-CARRIER (GX-SUB)  =  PI-CR-CARRIER
  6207       AND  GX-AM-GROUPING (GX-SUB)  =  PI-CR-GROUPING
  6208       AND  GX-AM-STATE (GX-SUB)  =  PI-CR-STATE
  6209       AND  GX-AM-ACCOUNT (GX-SUB)  =  PI-CR-ACCOUNT
  6210         NEXT SENTENCE
  6211     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL642T.cbl
  6212         IF PI-ACCT-BILLED
  6213             PERFORM 1100-PYAJ-BILLING-PROCESS  THRU  1190-EXIT
  6214             MOVE 'TA'           TO  BILLING-DETAIL-TYPE
  6215             IF APRODSWI  =  'N'
  6216                 NEXT SENTENCE
  6217             ELSE
  6218                 PERFORM 3000-WRITE-BILLING-DETAIL
  6219                     THRU  3990-EXIT.
  6220
  6221     MOVE GX-AM-CARRIER (GX-SUB)   TO  PI-CR-CARRIER.
  6222     MOVE GX-AM-GROUPING (GX-SUB)  TO  PI-CR-GROUPING.
  6223     MOVE GX-AM-STATE (GX-SUB)     TO  PI-CR-STATE.
  6224     MOVE GX-AM-ACCOUNT (GX-SUB)   TO  PI-SAV-ACCT
  6225                                       PI-CR-ACCOUNT.
  6226     MOVE GX-AM-EXPIRATION-DT (GX-SUB)
  6227                                   TO  PI-SAV-EXP-DT.
  6228
  6229     PERFORM 4300-READ-ACCOUNT-MASTER  THRU  4390-EXIT.
  6230
  6231     IF INVALID-ACCOUNT
  6232         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6233
  6234     IF PI-UPDATE-FILES
  6235         MOVE WS-GA-LEVEL        TO  GX-AM-LEVEL-NO (GX-SUB)
  6236         MOVE WS-CURRENT-DATE    TO  GX-LAST-BILL-DT (GX-SUB).
  6237
  6238     IF NEW-ACCOUNT
  6239         IF PI-ACCT-BILLED
  6240             PERFORM 1100-PYAJ-BILLING-PROCESS  THRU  1190-EXIT
  6241             MOVE 'TA'           TO  BILLING-DETAIL-TYPE
  6242             IF APRODSWI  =  'N'
  6243                 NEXT SENTENCE
  6244             ELSE
  6245                 PERFORM 3000-WRITE-BILLING-DETAIL
  6246                     THRU  3990-EXIT.
  6247
  6248     MOVE 'A'                    TO  COMPENSATION-SW
  6249                                      PI-CR-TYPE.
  6250
  6251     PERFORM 6000-READ-COMP-MASTER     THRU 6090-EXIT.
  6252     PERFORM 1100-PYAJ-BILLING-PROCESS THRU 1190-EXIT.
  6253     PERFORM 4000-PNDB-START-BROWSE    THRU 4090-EXIT.
  6254
  6255     IF PNDB-EOF
  6256         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6257
  6258 1010-PNDB-BILLING-PROCESS-LOOP.
  6259     PERFORM 4100-PNDB-READ-NEXT  THRU  4150-EXIT.
  6260
  6261     IF PNDB-EOF
  6262         PERFORM 4160-PNDB-END-BROWSE
  6263         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6264
  6265     IF PB-COMPANY-CD-A1  =  PI-COMPANY-CD  AND
  6266        PB-SV-CARRIER     =  PI-CR-CARRIER  AND
  6267        PB-SV-GROUPING    =  PI-CR-GROUPING AND
  6268        PB-SV-STATE       =  PI-CR-STATE    AND
  6269        PB-ACCOUNT        =  PI-CR-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL642T.cbl
  6270         NEXT SENTENCE
  6271     ELSE
  6272         PERFORM 4160-PNDB-END-BROWSE
  6273         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6274
  6275     IF PB-BATCH-TRAILER
  6276         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6277
  6278     IF PB-ALT-CHG-SEQ-NO  NOT =  ZEROS
  6279         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6280
  6281     IF PB-CERT-EFF-DT LESS GX-AM-EXPIRATION-DT (GX-SUB)
  6282         NEXT SENTENCE
  6283      ELSE
  6284         PERFORM 4160-PNDB-END-BROWSE
  6285         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6286
  6287     IF PB-CERT-EFF-DT  LESS THAN  GX-AM-EFF-DT (GX-SUB)
  6288         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6289
  6290     IF PB-CERT-EFF-DT  GREATER THAN  ERACCT-P-EXP-DATE
  6291         PERFORM 4160-PNDB-END-BROWSE
  6292         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6293
  6294     IF (PB-ISSUE)
  6295       AND
  6296        (PB-I-POLICY-IS-REISSUE OR PB-I-REIN-ONLY OR
  6297         PB-I-POLICY-IS-MONTHLY OR
  6298         PB-I-POLICY-IS-DECLINED OR PB-I-POLICY-IS-VOIDED OR
  6299         PB-I-UNDERWRITE-POLICY)
  6300           GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6301     ELSE
  6302         IF (PB-CANCELLATION)
  6303           AND  (PB-CI-LF-POLICY-IS-REISSUE
  6304             OR  PB-CI-AH-POLICY-IS-REISSUE
  6305             OR  PB-CI-LF-POLICY-IS-MONTHLY
  6306             OR  PB-CI-AH-POLICY-IS-MONTHLY
  6307             OR  PB-CI-LF-POLICY-IS-DECLINED
  6308             OR  PB-CI-AH-POLICY-IS-VOID
  6309             OR  PB-CI-LF-REIN-ONLY
  6310             OR  PB-CI-AH-REIN-ONLY)
  6311               GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6312
  6313     IF PB-CREDIT-ACCEPT-DT  NOT =  LOW-VALUES
  6314         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6315
  6316     IF PB-RECORD-ON-HOLD
  6317         PERFORM 1040-UPDATE-BILLING-STATISTICS  THRU  1049-EXIT
  6318         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6319
  6320     IF PB-FATAL-ERRORS
  6321       OR  PB-UNFORCED-ERRORS
  6322         PERFORM 1040-UPDATE-BILLING-STATISTICS  THRU  1049-EXIT
  6323         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6324
  6325     MOVE 'Y'                    TO  PI-ACCT-BILLED-SW
  6326                                     PI-DATA-BILLED-SW.
  6327
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL642T.cbl
  6328     PERFORM 1040-UPDATE-BILLING-STATISTICS  THRU  1049-EXIT.
  6329
  6330     PERFORM 1030-COMPUTE-COMMISSION-TOTALS  THRU  1039-EXIT.
  6331
  6332     IF PI-BILL
  6333       OR  PI-REBILLING
  6334         PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT.
  6335
  6336     GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL642T.cbl
  6338 1030-COMPUTE-COMMISSION-TOTALS.
  6339     IF PB-CANCELLATION
  6340         GO TO 1035-COMPUTE-CANCEL-COMM.
  6341
  6342     PERFORM 4400-FIND-COMMISSION  THRU  4490-EXIT.
  6343
  6344     IF PB-OVERRIDE-LIFE
  6345       OR  PB-OVERRIDE-BOTH
  6346         COMPUTE WS-I-LF-PREMIUM-AMT = PB-I-LF-PREM-CALC +
  6347                                       PB-I-LF-ALT-PREM-CALC
  6348     ELSE
  6349         COMPUTE WS-I-LF-PREMIUM-AMT = PB-I-LF-PREMIUM-AMT +
  6350                                       PB-I-LF-ALT-PREMIUM-AMT.
  6351
  6352     IF PB-OVERRIDE-AH
  6353       OR  PB-OVERRIDE-BOTH
  6354         MOVE PB-I-AH-PREM-CALC  TO  WS-I-AH-PREMIUM-AMT
  6355     ELSE
  6356         MOVE PB-I-AH-PREMIUM-AMT
  6357                                 TO  WS-I-AH-PREMIUM-AMT.
  6358
  6359     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  (LOW-VALUES OR SPACES)
  6360       OR  PI-TOT-REBILL
  6361         COMPUTE PI-UNPAID-NET-PREM = PI-UNPAID-NET-PREM +
  6362             WS-I-LF-PREMIUM-AMT + WS-I-AH-PREMIUM-AMT
  6363         COMPUTE WS-ACCT-UNPAID-NET-PREM =
  6364             (WS-I-LF-PREMIUM-AMT + WS-I-AH-PREMIUM-AMT) +
  6365              WS-ACCT-UNPAID-NET-PREM.
  6366
  6367     COMPUTE PI-PREMIUM = PI-PREMIUM +
  6368         (WS-I-LF-PREMIUM-AMT + WS-I-AH-PREMIUM-AMT).
  6369
  6370     COMPUTE PI-LF-ISS-COMP ROUNDED =
  6371         (WS-I-LF-PREMIUM-AMT * WS-GA-LF-COM).
  6372
  6373     COMPUTE PI-AH-ISS-COMP ROUNDED =
  6374         (WS-I-AH-PREMIUM-AMT  * WS-GA-AH-COM).
  6375
  6376     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  (LOW-VALUES OR SPACES)
  6377       OR  PI-TOT-REBILL
  6378         COMPUTE WS-ACCT-LF-OVERWRITE =
  6379             (PI-LF-ISS-COMP + WS-ACCT-LF-OVERWRITE)
  6380         COMPUTE WS-ACCT-AH-OVERWRITE =
  6381             (PI-AH-ISS-COMP + WS-ACCT-AH-OVERWRITE)
  6382         COMPUTE PI-COMP-UNPAID-PREM = PI-COMP-UNPAID-PREM +
  6383             PI-LF-ISS-COMP + PI-AH-ISS-COMP.
  6384
  6385     COMPUTE PI-TOT-ISS-COMP = PI-TOT-ISS-COMP +
  6386         (PI-LF-ISS-COMP + PI-AH-ISS-COMP).
  6387
  6388 1033-COMPUTE-ACCOUNT-COMM.
  6389
  6390     COMPUTE WS-ACCT-NET-PREM ROUNDED = WS-ACCT-NET-PREM +
  6391         (WS-I-LF-PREMIUM-AMT + WS-I-AH-PREMIUM-AMT).
  6392
  6393     IF PI-SAV-AGENT  NOT =  PI-SAV-REMIT-TO
  6394         GO TO 1039-EXIT.
  6395
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL642T.cbl
  6396     COMPUTE WS-ACCT-COMP ROUNDED =
  6397         (WS-I-LF-PREMIUM-AMT * PB-I-LIFE-COMMISSION) +
  6398         (WS-I-AH-PREMIUM-AMT * PB-I-AH-COMMISSION)   +
  6399          WS-ACCT-COMP.
  6400
  6401     GO TO 1039-EXIT.
  6402
  6403 1035-COMPUTE-CANCEL-COMM.
  6404     IF PB-CI-CERT-HAS-ERCOMM-ENTRY
  6405         PERFORM 4700-PROCESS-COMM-EXCEPTION  THRU  4790-EXIT
  6406     ELSE
  6407         PERFORM 4400-FIND-COMMISSION  THRU  4490-EXIT.
  6408
  6409     IF PB-OVERRIDE-LIFE
  6410       OR  PB-OVERRIDE-BOTH
  6411         MOVE PB-C-LF-REF-CALC   TO  WS-C-LF-CANCEL-AMT
  6412     ELSE
  6413         MOVE PB-C-LF-CANCEL-AMT
  6414                                 TO  WS-C-LF-CANCEL-AMT.
  6415
  6416     IF PB-OVERRIDE-AH
  6417       OR  PB-OVERRIDE-BOTH
  6418         MOVE PB-C-AH-REF-CALC   TO  WS-C-AH-CANCEL-AMT
  6419     ELSE
  6420         MOVE PB-C-AH-CANCEL-AMT
  6421                                 TO  WS-C-AH-CANCEL-AMT.
  6422
  6423     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  LOW-VALUES  OR  SPACES
  6424       OR  PI-TOT-REBILL
  6425         COMPUTE PI-UNPAID-NET-PREM = PI-UNPAID-NET-PREM -
  6426             (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT)
  6427         COMPUTE WS-ACCT-UNPAID-NET-PREM =
  6428             WS-ACCT-UNPAID-NET-PREM -
  6429             (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT).
  6430
  6431     COMPUTE PI-PREMIUM = PI-PREMIUM -
  6432         (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT).
  6433
  6434     MOVE  PB-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6435     MOVE  PB-C-LF-CANCEL-DT      TO  DC-BIN-DATE-2.
  6436     MOVE  '1'                    TO  DC-OPTION-CODE.
  6437     PERFORM  8500-DATE-CONVERT  THRU  8500-EXIT.
  6438     MOVE  DC-ELAPSED-MONTHS      TO  MONTHS-DIFF-LF.
  6439
  6440     IF DC-ODD-DAYS-OVER  GREATER THAN   ZEROS
  6441         ADD  +1                  TO  MONTHS-DIFF-LF.
  6442
  6443     MOVE  PB-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6444     MOVE  PB-C-AH-CANCEL-DT      TO  DC-BIN-DATE-2.
  6445     MOVE  '1'                    TO  DC-OPTION-CODE.
  6446     PERFORM  8500-DATE-CONVERT  THRU  8500-EXIT.
  6447     MOVE  DC-ELAPSED-MONTHS      TO  MONTHS-DIFF-AH.
  6448
  6449     IF DC-ODD-DAYS-OVER  GREATER THAN   ZEROS
  6450         ADD  +1                  TO  MONTHS-DIFF-AH.
  6451
  6452     MOVE ZEROS                   TO  SUB.
  6453     MOVE ZEROS                   TO  PI-LF-CAN-COMP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL642T.cbl
  6454                                      PI-AH-CAN-COMP.
  6455
  6456 1036-COMPUTE-GA-LOOP.
  6457
  6458     ADD  +1                      TO  SUB.
  6459
  6460     IF SUB > +10
  6461         MOVE  ZEROS              TO  SUB
  6462         GO TO  1037-CONTINUE.
  6463
  6464     IF AM-AGT (SUB)   NOT  EQUAL  PI-SAV-AGENT
  6465         GO TO  1036-COMPUTE-GA-LOOP.
  6466
  6467     IF AM-COM-TYP (SUB) = 'O' OR 'P' OR 'G' OR 'B'
  6468         NEXT SENTENCE
  6469     ELSE
  6470         GO TO  1036-COMPUTE-GA-LOOP.
  6471
  6472     IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  6473         MOVE  ZEROS               TO  AM-COMM-CHARGEBACK (SUB).
  6474
  6475     IF AM-COMM-CHARGEBACK (SUB) = '99'
  6476         MOVE  ZEROS           TO  PI-LF-CAN-COMP
  6477         GO TO 1037-CHECK-AH-COMM.
  6478
  6479     IF (MONTHS-DIFF-LF  GREATER THAN  AM-COMM-CHARGEBACK (SUB))
  6480                              AND
  6481        (AM-COMM-CHARGEBACK (SUB)  NOT  EQUAL   ZEROS)
  6482         MOVE  ZEROS               TO  PI-LF-CAN-COMP
  6483     ELSE
  6484         COMPUTE PI-LF-CAN-COMP ROUNDED = PI-LF-CAN-COMP +
  6485             (WS-C-LF-CANCEL-AMT * WS-GA-LF-COM).
  6486
  6487 1037-CHECK-AH-COMM.
  6488
  6489     IF AM-COMM-CHARGEBACK (SUB)    EQUAL   '99'
  6490         MOVE  ZEROS           TO  PI-AH-CAN-COMP
  6491         GO TO 1036-COMPUTE-GA-LOOP.
  6492
  6493     IF (MONTHS-DIFF-AH GREATER THAN  AM-COMM-CHARGEBACK (SUB))
  6494                              AND
  6495        (AM-COMM-CHARGEBACK (SUB)  NOT  EQUAL   ZEROS)
  6496         MOVE  ZEROS               TO  PI-AH-CAN-COMP
  6497     ELSE
  6498         COMPUTE PI-AH-CAN-COMP ROUNDED =  PI-AH-CAN-COMP +
  6499             (WS-C-AH-CANCEL-AMT  * WS-GA-AH-COM).
  6500
  6501     GO TO 1036-COMPUTE-GA-LOOP.
  6502
  6503 1037-CONTINUE.
  6504
  6505     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  (LOW-VALUES  OR  SPACES)
  6506       OR  PI-TOT-REBILL
  6507         COMPUTE WS-ACCT-LF-OVERWRITE =
  6508             (WS-ACCT-LF-OVERWRITE - PI-LF-CAN-COMP)
  6509         COMPUTE WS-ACCT-AH-OVERWRITE =
  6510             (WS-ACCT-AH-OVERWRITE - PI-AH-CAN-COMP)
  6511         COMPUTE PI-COMP-UNPAID-PREM = PI-COMP-UNPAID-PREM -
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL642T.cbl
  6512             PI-LF-CAN-COMP - PI-AH-CAN-COMP.
  6513
  6514     COMPUTE PI-TOT-CAN-COMP = PI-TOT-CAN-COMP +
  6515         (PI-LF-CAN-COMP + PI-AH-CAN-COMP).
  6516
  6517 1038-COMPUTE-ACCOUNT-COMM.
  6518
  6519     COMPUTE WS-ACCT-NET-PREM = WS-ACCT-NET-PREM -
  6520         (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT).
  6521
  6522     IF PI-SAV-AGENT  NOT =  PI-SAV-REMIT-TO
  6523         GO TO 1039-EXIT.
  6524
  6525     MOVE ZEROS                   TO  SUB.
  6526
  6527 103X-ACCOUNT-LOOP.
  6528
  6529     ADD  +1                      TO  SUB.
  6530
  6531     IF SUB > +10
  6532         MOVE  ZEROS              TO  SUB
  6533         GO TO  1039-EXIT.
  6534
  6535     IF AM-COM-TYP (SUB) = 'C' OR 'D' OR 'F' OR 'S'
  6536         NEXT SENTENCE
  6537     ELSE
  6538         GO TO  103X-ACCOUNT-LOOP.
  6539
  6540     IF AM-COMM-CHARGEBACK (SUB)    NOT NUMERIC
  6541         MOVE  ZEROS               TO  AM-COMM-CHARGEBACK (SUB).
  6542
  6543     IF AM-COMM-CHARGEBACK (SUB)   EQUAL   '99'
  6544         MOVE  ZEROS          TO  WS-C-LF-CANCEL-AMT
  6545         GO TO 103X-CHECK-AH-COMM.
  6546
  6547     IF (MONTHS-DIFF-LF  GREATER THAN  AM-COMM-CHARGEBACK (SUB))
  6548                              AND
  6549        (AM-COMM-CHARGEBACK (SUB)  NOT  EQUAL   ZEROS)
  6550         MOVE  ZEROS              TO  WS-C-LF-CANCEL-AMT.
  6551
  6552 103X-CHECK-AH-COMM.
  6553
  6554     IF AM-COMM-CHARGEBACK (SUB)   EQUAL   '99'
  6555         MOVE  ZEROS          TO  WS-C-AH-CANCEL-AMT
  6556         GO TO 103X-COMPUTE-ACCT-TOT.
  6557
  6558     IF (MONTHS-DIFF-AH  GREATER THAN  AM-COMM-CHARGEBACK (SUB))
  6559                              AND
  6560        (AM-COMM-CHARGEBACK (SUB)  NOT  EQUAL   ZEROS)
  6561         MOVE  ZEROS              TO  WS-C-AH-CANCEL-AMT.
  6562
  6563 103X-COMPUTE-ACCT-TOT.
  6564
  6565     COMPUTE WS-ACCT-COMP   ROUNDED  =  WS-ACCT-COMP  -
  6566         ((WS-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION) +
  6567          (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION)).
  6568
  6569     GO TO 103X-ACCOUNT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL642T.cbl
  6570
  6571 1039-EXIT.
  6572     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL642T.cbl
  6574 1040-UPDATE-BILLING-STATISTICS.
  6575     IF PB-ISSUE
  6576         IF PB-FATAL-ERRORS
  6577           OR  PB-UNFORCED-ERRORS
  6578           OR  PB-RECORD-ON-HOLD
  6579             ADD +1              TO  PI-ISSUES-INER
  6580             GO TO 1049-EXIT.
  6581
  6582     IF PB-CANCELLATION
  6583         IF PB-FATAL-ERRORS
  6584           OR  PB-UNFORCED-ERRORS
  6585           OR  PB-RECORD-ON-HOLD
  6586             ADD +1              TO  PI-CANCELS-INER
  6587             GO TO 1049-EXIT.
  6588
  6589     IF PB-ISSUE
  6590         IF PB-GA-BILL-DT (WS-GA-LEVEL)  =
  6591                (LOW-VALUES OR SPACES)
  6592           OR  PI-TOT-REBILL
  6593             ADD +1              TO  PI-ISSUES-BILLED
  6594             GO TO 1049-EXIT.
  6595
  6596     IF PB-CANCELLATION
  6597         IF PB-GA-BILL-DT (WS-GA-LEVEL)  =
  6598                (LOW-VALUES OR SPACES)
  6599           OR  PI-TOT-REBILL
  6600             ADD +1              TO  PI-CANCELS-BILLED
  6601             GO TO 1049-EXIT.
  6602
  6603     IF PB-ISSUE
  6604         IF PB-GA-BILL-DT (WS-GA-LEVEL)  NOT =  LOW-VALUES
  6605           AND  SPACES
  6606             ADD +1              TO  PI-ISSUES-PREV
  6607             GO TO 1049-EXIT.
  6608
  6609     IF PB-CANCELLATION
  6610         IF PB-GA-BILL-DT (WS-GA-LEVEL)  NOT =  LOW-VALUES
  6611           AND  SPACES
  6612             ADD +1              TO  PI-CANCELS-PREV
  6613             GO TO 1049-EXIT.
  6614
  6615     ADD +1                      TO  PI-UNKNOWN.
  6616
  6617 1049-EXIT.
  6618     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL642T.cbl
  6620 1100-PYAJ-BILLING-PROCESS.
  6621******************************************************************
  6622*   PROCESS THE ACCOUNTS PAYMENTS AND ADUSTMENTS. IF THE GENERAL *
  6623*   AGENT IS NOT FINANCIALLY RESPONSIBLE FOR THE ACCOUNT DO NOT  *
  6624*   PROCESS THE ACCOUNT'S PAYMENTS AND ADJUSTMENTS.              *
  6625*                                                                *
  6626*   1.  PROCESS THE ACCOUNT'S PAYMENTS AND ADUSTMENTS.           *
  6627*                                                                *
  6628*   2.  IF THE GENERAL AGENT IS NOT FINANCIALLY RESPONSIBLE FOR  *
  6629*       THE ACCOUNT, DO NOT PROCESS THE ACCOUNT'S PAYMENTS AND   *
  6630*       ADJUSTMENTS.                                             *
  6631*                                                                *
  6632*   3.  IF PRINTED BILL IS NOT PRODUCED, DO NOT PROCESS THE      *
  6633*       ACCOUNT'S PAYMENTS AND ADJUSTMENTS.                      *
  6634******************************************************************
  6635
  6636     IF PI-SAV-AGENT  =  PI-SAV-REMIT-TO
  6637         NEXT SENTENCE
  6638     ELSE
  6639         GO TO 1190-EXIT.
  6640
  6641     IF PI-UPDATE-FILES
  6642       OR  (PI-PREVIEW  AND  APRODSWI = 'Y')
  6643         NEXT SENTENCE
  6644     ELSE
  6645         GO TO 1190-EXIT.
  6646
  6647 1105-PYAJ-BILLING-STARTBR-LOOP.
  6648     MOVE 'A'                    TO  COMPENSATION-SW.
  6649
  6650     PERFORM 4500-PYAJ-START-BROWSE  THRU  4590-EXIT.
  6651
  6652     IF PYAJ-EOF
  6653         GO TO 1190-EXIT.
  6654
  6655 1110-PYAJ-BILLING-READ-LOOP.
  6656     PERFORM 4600-PYAJ-READ-NEXT  THRU  4690-EXIT.
  6657
  6658     IF PYAJ-EOF
  6659         PERFORM 4800-PYAJ-END-BROWSE
  6660         GO TO 1190-EXIT.
  6661
  6662     IF PY-COMPANY-CD  =  ERPYAJ-BR-COMP-CD
  6663       AND  PY-CARRIER  =  ERPYAJ-BR-CARRIER
  6664       AND  PY-GROUPING  =  ERPYAJ-BR-GROUPING
  6665       AND  PY-FIN-RESP  =  ERPYAJ-BR-FIN-RESP
  6666       AND  PY-ACCOUNT  =  ERPYAJ-BR-ACCOUNT
  6667         NEXT SENTENCE
  6668     ELSE
  6669         PERFORM 4800-PYAJ-END-BROWSE
  6670         GO TO 1190-EXIT.
  6671
  6672     IF PY-CREDIT-ACCEPT-DT  NOT =  LOW-VALUES
  6673         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6674
  6675     IF PY-RECORD-TYPE  = 'R' OR 'D' OR 'C' OR 'S' OR 'T' OR 'U'
  6676                              OR 'Z'
  6677         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL642T.cbl
  6678     ELSE
  6679         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6680
  6681     IF PY-VOID-SW  NOT =  SPACES
  6682         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6683
  6684     IF PI-AR-PROCESSING
  6685        IF PY-AR-DATE  =  LOW-VALUES
  6686           NEXT SENTENCE
  6687        ELSE
  6688           GO TO 1110-PYAJ-BILLING-READ-LOOP
  6689     ELSE
  6690        IF (PY-BILLED-DATE  =  LOW-VALUES AND
  6691            PY-AR-DATE = LOW-VALUES)
  6692           NEXT SENTENCE
  6693        ELSE
  6694           GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6695
  6696     IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  6697        PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  6698        PY-ADD-TO-BALANCE
  6699         ADD PY-ENTRY-AMT        TO  WS-ACCT-PAY-ADJS
  6700     ELSE
  6701         SUBTRACT PY-ENTRY-AMT   FROM  WS-ACCT-PAY-ADJS.
  6702
  6703     GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6704
  6705 1190-EXIT.
  6706     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL642T.cbl
  6708 1200-PYAJ-BILLING-COMPLETE.
  6709******************************************************************
  6710*      1. IF PRINTED BILL IS PRODUCED PRINT THE GENERAL AGENT'S  *
  6711*         TOTALS.                                                *
  6712*                                                                *
  6713*      2. PROCESS THE GENERAL AGENT'S PAYMENTS AND ADJUSTMENTS.  *
  6714******************************************************************
  6715
  6716     IF PI-DATA-BILLED
  6717         NEXT SENTENCE
  6718     ELSE
  6719         MOVE ER-2913            TO  EMI-ERROR
  6720         MOVE -1                 TO  AACCT1L
  6721         MOVE AL-UABON           TO  AACCT1A
  6722         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6723
  6724     IF RETURNED-FROM  =  SPACES
  6725         IF PI-UPDATE-FILES
  6726           OR  (PI-PREVIEW  AND  APRODSWI = 'Y')
  6727             IF PI-ACCT-BILLED
  6728                 MOVE 'TB'       TO  BILLING-DETAIL-TYPE
  6729                 PERFORM 3000-WRITE-BILLING-DETAIL
  6730                         THRU  3990-EXIT
  6731             ELSE
  6732                 MOVE 'TS'       TO  BILLING-DETAIL-TYPE
  6733                 PERFORM 3000-WRITE-BILLING-DETAIL
  6734                         THRU  3990-EXIT.
  6735
  6736 1205-PYAJ-BILLING-STARTBR-LOOP.
  6737     MOVE PI-SAV-AGENT           TO  PI-SAV-FIN-RESP.
  6738     MOVE 'G'                    TO  COMPENSATION-SW.
  6739
  6740     PERFORM 4500-PYAJ-START-BROWSE  THRU  4590-EXIT.
  6741
  6742     IF PYAJ-EOF
  6743         GO TO 1260-BILLING-COMPLETE.
  6744
  6745 1210-PYAJ-BILLING-READ-LOOP.
  6746     PERFORM 4600-PYAJ-READ-NEXT  THRU  4690-EXIT.
  6747
  6748     IF PYAJ-EOF
  6749         GO TO 1250-END-AGENTS-PAY-ADJS.
  6750
  6751     IF NOT PI-AR-PROCESSING
  6752         IF PY-COMPANY-CD  =  ERPYAJ-BR-COMP-CD
  6753           AND  PY-CARRIER  =  ERPYAJ-BR-CARRIER
  6754           AND  PY-GROUPING  =  ERPYAJ-BR-GROUPING
  6755           AND  PY-FIN-RESP  =  ERPYAJ-BR-FIN-RESP
  6756           AND  PY-ACCOUNT  =  ERPYAJ-BR-ACCOUNT
  6757             GO TO 1230-CHECK-PYAJ-ENTRY
  6758         ELSE
  6759             GO TO 1250-END-AGENTS-PAY-ADJS
  6760     ELSE
  6761         IF PY-COMPANY-CD  =  ERPYAJ-BR-COMP-CD
  6762           AND  PY-CARRIER  =  ERPYAJ-BR-CARRIER
  6763           AND  PY-GROUPING  =  ERPYAJ-BR-GROUPING
  6764           AND  PY-FIN-RESP  =  ERPYAJ-BR-FIN-RESP
  6765             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL642T.cbl
  6766         ELSE
  6767             GO TO 1250-END-AGENTS-PAY-ADJS.
  6768
  6769      IF PY-PMT-APPLIED = 'O' OR
  6770         PY-ACCOUNT = LOW-VALUES
  6771          NEXT SENTENCE
  6772      ELSE
  6773          GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6774
  6775 1230-CHECK-PYAJ-ENTRY.
  6776
  6777     IF PY-CREDIT-ACCEPT-DT  NOT =  LOW-VALUES
  6778         GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6779
  6780     IF PY-RECORD-TYPE  = 'R' OR 'D' OR 'C' OR 'S' OR 'T' OR 'U'
  6781                              OR 'Z'
  6782         NEXT SENTENCE
  6783     ELSE
  6784         GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6785
  6786     IF PY-VOID-SW  NOT =  SPACES
  6787         GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6788
  6789     IF PI-AR-PROCESSING
  6790        IF PY-AR-DATE  =  LOW-VALUES
  6791           OR  PI-TOT-REBILL
  6792           OR  RETURNED-FROM  =  XCTL-PYAJ
  6793               NEXT SENTENCE
  6794        ELSE
  6795           GO TO 1210-PYAJ-BILLING-READ-LOOP
  6796     ELSE
  6797        IF (PY-BILLED-DATE  =  LOW-VALUES AND
  6798            PY-AR-DATE = LOW-VALUES)
  6799           OR  PI-TOT-REBILL
  6800           OR  RETURNED-FROM  =  XCTL-PYAJ
  6801           NEXT SENTENCE
  6802        ELSE
  6803           GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6804
  6805     IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  6806        PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  6807        PY-ADD-TO-BALANCE
  6808         ADD PY-ENTRY-AMT        TO  PI-REMITTED
  6809     ELSE
  6810         IF PY-CHARGE-TO-AGENT
  6811           OR  PY-ADJ-CHG-TO-AGT
  6812             IF PY-GA-CHECK
  6813                 ADD PY-ENTRY-AMT  TO  PI-DISBURSED
  6814             ELSE
  6815                 ADD PY-ENTRY-AMT  TO  PI-ADJUSTMNTS.
  6816
  6817     IF RETURNED-FROM  =  SPACES
  6818         IF PI-UPDATE-FILES
  6819           OR  (PI-PREVIEW  AND  APRODSWI = 'Y')
  6820             MOVE 'BP'           TO  BILLING-DETAIL-TYPE
  6821             PERFORM 3000-WRITE-BILLING-DETAIL  THRU  3990-EXIT.
  6822
  6823     GO TO 1210-PYAJ-BILLING-READ-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL642T.cbl
  6824
  6825 1250-END-AGENTS-PAY-ADJS.
  6826     PERFORM 4800-PYAJ-END-BROWSE.
  6827
  6828     IF PI-DATA-BILLED
  6829         NEXT SENTENCE
  6830     ELSE
  6831         MOVE ER-2913            TO  EMI-ERROR
  6832         MOVE -1                 TO  AACCT1L
  6833         MOVE AL-UABON           TO  AACCT1A
  6834         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6835
  6836 1260-BILLING-COMPLETE.
  6837     IF WS-UPDATE-FILES
  6838         PERFORM 6500-REWRITE-CROSS-REFERENCE.
  6839
  6840     IF EMI-NO-ERRORS
  6841         MOVE 0000               TO  EMI-ERROR
  6842         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6843
  6844     MOVE -1                     TO  AAGENTL.
  6845
  6846     PERFORM 5000-FORMAT-SCREEN  THRU  5090-EXIT.
  6847
  6848     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL642T.cbl
  6850 2000-VOID-BILLING.
  6851******************************************************************
  6852*     THIS SECTION WILL RESET THE GA-BILLING-FLAGS IN THE        *
  6853*     PENDING BUSINESS RECORDS AND RESET THE LAST BILLED         *
  6854*     DATE IN THE GENERAL AGENT'S CROSS-REFERENCE-FILE TO        *
  6855*     LOW-VALUES.                                                *
  6856******************************************************************
  6857
  6858     MOVE SPACES                 TO  ELCNTL-KEY.
  6859     MOVE '1'                    TO  ELCNTL-REC-TYPE.
  6860
  6861     PERFORM 6100-READ-CONTROL-FILE  THRU  6190-EXIT.
  6862
  6863     IF EMI-ERROR  NOT =  ZEROS
  6864         GO TO 8200-SEND-DATAONLY.
  6865
  6866     MOVE CF-CURRENT-MONTH-END   TO  DC-BIN-DATE-1.
  6867     MOVE SPACE                  TO  DC-OPTION-CODE.
  6868
  6869     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  6870
  6871     MOVE DC-GREG-DATE-1-EDIT    TO  PI-MONTH-END-DATE.
  6872
  6873     PERFORM 6400-READ-CROSS-REFERENCE  THRU  6490-EXIT.
  6874
  6875     MOVE +0                     TO  GX-SUB.
  6876
  6877 2005-GXRF-BILLING-PROCESS-LOOP.
  6878     ADD +1                      TO  GX-SUB.
  6879
  6880     IF GX-SUB  GREATER THAN  GX-AGENT-POINTER-CNT
  6881         GO TO 2100-VOID-PNDB-COMPLETE.
  6882
  6883     MOVE GX-AM-CARRIER (GX-SUB)   TO  PI-CR-CARRIER.
  6884     MOVE GX-AM-GROUPING (GX-SUB)  TO  PI-CR-GROUPING.
  6885     MOVE GX-AM-STATE (GX-SUB)     TO  PI-CR-STATE.
  6886     MOVE GX-AM-ACCOUNT (GX-SUB)   TO  PI-CR-ACCOUNT.
  6887     MOVE GX-AGENT-NO              TO  PI-SAV-AGENT.
  6888     MOVE GX-AM-EXPIRATION-DT (GX-SUB)
  6889                                   TO  PI-SAV-EXP-DT.
  6890     MOVE GX-AM-LEVEL-NO (GX-SUB)  TO  WS-GA-LEVEL.
  6891     MOVE LOW-VALUES               TO  GX-LAST-BILL-DT (GX-SUB).
  6892
  6893     PERFORM 4000-PNDB-START-BROWSE  THRU  4090-EXIT.
  6894
  6895     IF PNDB-EOF
  6896         PERFORM 4160-PNDB-END-BROWSE
  6897         GO TO 2005-GXRF-BILLING-PROCESS-LOOP.
  6898
  6899 2010-VOID-PNDB-LOOP.
  6900     PERFORM 4100-PNDB-READ-NEXT  THRU  4150-EXIT.
  6901
  6902     IF PNDB-EOF
  6903         PERFORM 4160-PNDB-END-BROWSE
  6904         GO TO 2005-GXRF-BILLING-PROCESS-LOOP.
  6905
  6906     IF PB-COMPANY-CD-A1  =  PI-COMPANY-CD
  6907       AND  PB-SV-CARRIER  =  PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL642T.cbl
  6908       AND  PB-SV-GROUPING  =  PI-CR-GROUPING
  6909       AND  PB-SV-STATE  =  PI-CR-STATE
  6910       AND  PB-ACCOUNT  =  PI-CR-ACCOUNT
  6911         NEXT SENTENCE
  6912     ELSE
  6913         PERFORM 4160-PNDB-END-BROWSE
  6914         GO TO 2005-GXRF-BILLING-PROCESS-LOOP.
  6915
  6916     IF PB-CREDIT-ACCEPT-DT  NOT =  LOW-VALUES
  6917         GO TO 2010-VOID-PNDB-LOOP.
  6918
  6919     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  (LOW-VALUES  OR  SPACES)
  6920         GO TO 2010-VOID-PNDB-LOOP.
  6921
  6922     IF PB-CERT-EFF-DT  =  GX-AM-EXPIRATION-DT (GX-SUB)
  6923       OR  PB-CERT-EFF-DT  GREATER THAN
  6924               GX-AM-EXPIRATION-DT (GX-SUB)
  6925         PERFORM 4160-PNDB-END-BROWSE
  6926         GO TO 2005-GXRF-BILLING-PROCESS-LOOP.
  6927
  6928     IF PB-CERT-EFF-DT  LESS THAN  GX-AM-EFF-DT (GX-SUB)
  6929         GO TO 2010-VOID-PNDB-LOOP.
  6930
  6931     IF PB-BATCH-TRAILER
  6932         GO TO 2010-VOID-PNDB-LOOP.
  6933
  6934     PERFORM 4200-PNDB-REWRITE  THRU  4290-EXIT.
  6935
  6936     MOVE 'Y'                    TO  DATA-VOIDED-SW.
  6937
  6938     GO TO 2010-VOID-PNDB-LOOP.
  6939
  6940 2100-VOID-PNDB-COMPLETE.
  6941     IF DATA-VOIDED
  6942         NEXT SENTENCE
  6943     ELSE
  6944         MOVE -1                 TO  APFNTERL
  6945         MOVE ER-2401            TO  EMI-ERROR
  6946         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6947         GO TO 8100-SEND-INITIAL-MAP.
  6948
  6949     PERFORM 3940-BILL-GENERIC-DELETE  THRU  3940-EXIT.
  6950
  6951     PERFORM 6500-REWRITE-CROSS-REFERENCE  THRU  6590-EXIT.
  6952
  6953 2105-VOID-COMPLETE.
  6954     MOVE 0000                   TO  EMI-ERROR
  6955
  6956     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6957
  6958     MOVE -1                     TO  AAGENTL.
  6959
  6960     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL642T.cbl
  6962 3000-WRITE-BILLING-DETAIL.
  6963******************************************************************
  6964*     THIS SECTION FORMATS THE BILLING PRINT RECORDS.  THESE     *
  6965*     RECORDS ARE CREATED IN THE SAME FORMAT THAT THEY APPEAR    *
  6966*     WHEN PRINTED.                                              *
  6967*                                                                *
  6968*     THIS SECTION PRINTS THE BILLING STATEMENT AND PRINT LABELS.*
  6969*     BILLING-DETAIL-TYPES                                       *
  6970*            TOTAL-STATEMENT   TS                                *
  6971*            TOTAL-ACCOUNT     TA                                *
  6972*            TOTAL-BOTH        TB                                *
  6973*            GAN-AGT-ADDRESS   GA                                *
  6974*                              BP                                *
  6975******************************************************************
  6976
  6977     IF GEN-AGT-ADDRESS
  6978         PERFORM 3930-BILL-READ  THRU  3930-EXIT
  6979         IF NO-BILL-RECS
  6980             GO TO 3200-FORMAT-HDR-ADDR-RECS
  6981         ELSE
  6982             IF BI-PREVIEW-ONLY
  6983               OR  BI-INITIAL-PRINT-DATE  NOT =  LOW-VALUES
  6984               OR  PI-TOT-REBILL
  6985                 PERFORM 3940-BILL-GENERIC-DELETE
  6986                     THRU  3940-EXIT
  6987                 GO TO 3200-FORMAT-HDR-ADDR-RECS
  6988             ELSE
  6989                 MOVE ER-2403    TO  EMI-ERROR
  6990                 MOVE -1         TO  ABILTYPL
  6991                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6992                 GO TO 8200-SEND-DATAONLY.
  6993
  6994 3100-FORMAT-DETAIL-LINES.
  6995     IF WS-LINECTR  GREATER THAN  23
  6996         MOVE ZEROS              TO  WS-LINECTR
  6997         MOVE '3'                TO  BI-RECORD-TYPE
  6998         MOVE TRIPLE-SPACE       TO  BI-SKIP-CONTROL
  6999         MOVE '          CONTINUED ON NEXT PAGE'
  7000                                 TO  BI-TEXT-LINE
  7001         PERFORM 3920-BILL-WRITE
  7002         PERFORM 3300-FORMAT-HEADINGS  THRU  3380-EXIT.
  7003
  7004     IF WS-LINECTR  =  ZEROS
  7005         MOVE DOUBLE-SPACE       TO  BI-SKIP-CONTROL
  7006     ELSE
  7007         MOVE SINGLE-SPACE       TO  BI-SKIP-CONTROL.
  7008
  7009     MOVE '3'                    TO  BI-RECORD-TYPE.
  7010     MOVE SPACES                 TO  GA-TEXT-LINE.
  7011
  7012     IF TOTAL-STATEMENT
  7013         GO TO 3175-CHECK-AGENT-TOTAL.
  7014
  7015     IF BILLING-DETAIL-TYPE  =  'BP'
  7016        IF PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT
  7017            MOVE PY-ENTRY-COMMENT
  7018                                 TO  GA-ENTRY-DESC
  7019            MULTIPLY PY-ENTRY-AMT  BY  -1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL642T.cbl
  7020                GIVING  GA-PMTS-ADJS
  7021            MOVE PY-ENTRY-COMMENT
  7022                                 TO  GA-ENTRY-DESC
  7023            MOVE '* ACCOUNTING ENTRY *'
  7024                                 TO  GA-ENTRY-COMMENT
  7025            ADD +1               TO  WS-LINECTR
  7026            IF PY-ACCOUNT = LOW-VALUES
  7027                MOVE SPACES      TO  GA-ACCT
  7028                PERFORM 3920-BILL-WRITE
  7029                GO TO 3990-EXIT
  7030            ELSE
  7031                MOVE PY-ACCOUNT  TO  GA-ACCT
  7032                PERFORM 3920-BILL-WRITE
  7033                GO TO 3990-EXIT.
  7034
  7035     IF BILLING-DETAIL-TYPE  =  'BP'
  7036         MOVE PY-ENTRY-COMMENT   TO  GA-ENTRY-DESC
  7037         MOVE PY-ENTRY-AMT       TO  GA-PMTS-ADJS
  7038         MOVE '* ACCOUNTING ENTRY *'
  7039                                 TO  GA-ENTRY-COMMENT
  7040         MOVE PY-ACCOUNT         TO  GA-ACCT
  7041         ADD +1                  TO  WS-LINECTR
  7042            IF PY-ACCOUNT = LOW-VALUES
  7043                MOVE SPACES      TO  GA-ACCT
  7044                PERFORM 3920-BILL-WRITE
  7045                GO TO 3990-EXIT
  7046            ELSE
  7047                MOVE PY-ACCOUNT  TO  GA-ACCT
  7048                PERFORM 3920-BILL-WRITE
  7049                GO TO 3990-EXIT.
  7050
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL642T.cbl
  7052 3150-FORMAT-ACCOUNT-LINE.
  7053     MOVE SPACES                 TO  GA-TEXT-LINE.
  7054     MOVE PI-SAV-ACCT-AGT        TO  GA-ACCT.
  7055     MOVE PI-SAV-ACCT-NAME       TO  GA-ACCT-NAME.
  7056     MOVE WS-ACCT-BEG-BAL        TO  GA-BEG-BAL
  7057                                     GA-BEG-BAL-AMT.
  7058     MOVE WS-ACCT-NET-PREM       TO  GA-NET-PREM
  7059                                     GA-NET-PREM-AMT.
  7060     MOVE WS-ACCT-COMP           TO  GA-ACCT-COMP
  7061                                     GA-ACCT-COMP-AMT.
  7062     MOVE WS-ACCT-PAY-ADJS       TO  GA-PMTS-ADJS
  7063                                     GA-PMTS-ADJS-AMT.
  7064
  7065     IF PI-SAV-AGENT  NOT =  PI-SAV-REMIT-TO
  7066         MOVE ZEROS              TO  GA-END-BAL-AMT
  7067     ELSE
  7068         COMPUTE GA-END-BAL-AMT =
  7069             (WS-ACCT-BEG-BAL + WS-ACCT-NET-PREM) -
  7070              (WS-ACCT-COMP + WS-ACCT-PAY-ADJS).
  7071
  7072     MOVE WS-ACCT-UNPAID-NET-PREM
  7073                                 TO  GA-UNPAID-NET-PREM
  7074                                     GA-UNPAID-NET-AMT.
  7075     MOVE ZEROS                  TO  GA-OVERWRITE-AMT.
  7076
  7077     IF WS-ACCT-LF-OVERWRITE  NOT =  ZEROS
  7078         MOVE PI-LIFE-OVERRIDE-L6
  7079                                 TO  GA-BEN-OVERRIDE-L6
  7080         MOVE PI-LIFE-OVERRIDE-L2
  7081                                 TO  GA-BENEFIT-CD
  7082         MOVE WS-ACCT-LF-OVERWRITE
  7083                                 TO  GA-OVERWRITE
  7084                                     GA-OVERWRITE-AMT
  7085     ELSE
  7086         IF WS-ACCT-AH-OVERWRITE  NOT =  ZEROS
  7087             MOVE PI-AH-OVERRIDE-L6
  7088                                 TO  GA-BEN-OVERRIDE-L6
  7089             MOVE PI-AH-OVERRIDE-L2
  7090                                 TO  GA-BENEFIT-CD
  7091             MOVE WS-ACCT-AH-OVERWRITE
  7092                                 TO  GA-OVERWRITE
  7093                                     GA-OVERWRITE-AMT.
  7094
  7095     COMPUTE GA-AMT-DUE-AMT = GA-END-BAL-AMT -
  7096         (WS-ACCT-LF-OVERWRITE + WS-ACCT-AH-OVERWRITE).
  7097
  7098     ADD  GA-AMT-DUE-AMT         TO  WS-GA-AMT-DUE.
  7099
  7100     MOVE GA-AMT-DUE-AMT         TO  GA-AMT-DUE.
  7101
  7102     ADD +1                      TO  WS-LINECTR.
  7103
  7104     PERFORM 3920-BILL-WRITE.
  7105
  7106     MOVE SPACES                 TO  GA-TEXT-LINE.
  7107     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7108
  7109     IF WS-ACCT-LF-OVERWRITE  NOT =  ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL642T.cbl
  7110         IF WS-ACCT-AH-OVERWRITE  NOT =  ZEROS
  7111             MOVE PI-AH-OVERRIDE-L6
  7112                                 TO  GA-BEN-OVERRIDE-L6
  7113             MOVE PI-AH-OVERRIDE-L2
  7114                                 TO  GA-BENEFIT-CD
  7115             MOVE WS-ACCT-AH-OVERWRITE
  7116                                 TO  GA-OVERWRITE
  7117                                     GA-OVERWRITE-AMT
  7118             MOVE ZEROS          TO  GA-BEG-BAL-AMT
  7119                                     GA-END-BAL-AMT
  7120                                     GA-NET-PREM-AMT
  7121                                     GA-ACCT-COMP-AMT
  7122                                     GA-PMTS-ADJS-AMT
  7123                                     GA-UNPAID-NET-AMT
  7124                                     GA-AMT-DUE-AMT
  7125             ADD +1              TO  WS-LINECTR
  7126             PERFORM 3920-BILL-WRITE.
  7127
  7128     ADD WS-ACCT-BEG-BAL         TO  WS-GA-BEG-BAL
  7129                                     PI-ACCT-BEG-BAL.
  7130     ADD WS-ACCT-NET-PREM        TO  WS-GA-NET-PREM
  7131                                     PI-ACCT-NET-PREM.
  7132     ADD WS-ACCT-COMP            TO  WS-GA-COMP
  7133                                     PI-ACCT-COMP.
  7134     ADD WS-ACCT-PAY-ADJS        TO  WS-GA-PAY-ADJS
  7135                                     PI-ACCT-PAY-ADJS.
  7136     ADD WS-ACCT-UNPAID-NET-PREM
  7137                                 TO  WS-GA-UNPAID-NET-PREM.
  7138     ADD WS-ACCT-LF-OVERWRITE    TO  WS-GA-LF-OVERWRITE.
  7139     ADD WS-ACCT-AH-OVERWRITE    TO  WS-GA-AH-OVERWRITE.
  7140     ADD GA-END-BAL-AMT          TO  WS-GA-END-BAL.
  7141
  7142     MOVE ZEROS                  TO  WS-ACCT-BEG-BAL
  7143                                     WS-ACCT-NET-PREM
  7144                                     WS-ACCT-COMP
  7145                                     WS-ACCT-PAY-ADJS
  7146                                     WS-ACCT-UNPAID-NET-PREM
  7147                                     WS-ACCT-LF-OVERWRITE
  7148                                     WS-ACCT-AH-OVERWRITE.
  7149     MOVE SPACE                  TO  PI-ACCT-BILLED-SW.
  7150     MOVE SPACE                  TO  ACCOUNT-CARRY-BAL-SW.
  7151
  7152     IF TOTAL-STATEMENT
  7153         GO TO 3400-FORMAT-TOTAL-LINE.
  7154
  7155 3175-CHECK-AGENT-TOTAL.
  7156
  7157     IF TOTAL-STATEMENT OR
  7158        TOTAL-BOTH
  7159         GO TO 3400-FORMAT-TOTAL-LINE.
  7160
  7161     GO TO 3990-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL642T.cbl
  7163 3200-FORMAT-HDR-ADDR-RECS.
  7164     PERFORM 3910-BILL-GETMAIN.
  7165
  7166     MOVE ZEROS                  TO  WS-LINE-SEQ-NO.
  7167
  7168     SET A-INDX                  TO  1.
  7169
  7170     PERFORM 3210-FORMAT-ADDR-RECS  THRU  3210-EXIT  6  TIMES.
  7171
  7172     MOVE ZEROS                  TO  WS-LINE-SEQ-NO.
  7173
  7174     PERFORM 3300-FORMAT-HEADINGS  THRU  3380-EXIT.
  7175
  7176     PERFORM 3220-WRITE-AGENTS-BAL  THRU  3220-EXIT.
  7177
  7178     GO TO 3990-EXIT.
  7179
  7180 3210-FORMAT-ADDR-RECS.
  7181     MOVE '2'                    TO  BI-RECORD-TYPE.
  7182     MOVE SPACES                 TO  GA-TEXT-LINE.
  7183     MOVE WS-AGENT-LINES (A-INDX)
  7184                                 TO  GA-ACCT-ADDRESS-LINE.
  7185
  7186     PERFORM 3920-BILL-WRITE.
  7187
  7188     SET A-INDX                  UP  BY  1.
  7189
  7190 3210-EXIT.
  7191     EXIT.
  7192
  7193 3220-WRITE-AGENTS-BAL.
  7194     MOVE SPACES                 TO GA-TEXT-LINE.
  7195     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7196
  7197     PERFORM 3920-BILL-WRITE.
  7198
  7199     MOVE 'BEGINNING BALANCE'    TO  GA-ACCT-NAME
  7200     MOVE PI-BAL-FRWD            TO  GA-BEG-BAL.
  7201     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7202
  7203     PERFORM 3920-BILL-WRITE.
  7204
  7205     MOVE SPACES                 TO  GA-TEXT-LINE.
  7206     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7207
  7208     PERFORM 3920-BILL-WRITE.
  7209
  7210 3220-EXIT.
  7211     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL642T.cbl
  7213 3300-FORMAT-HEADINGS.
  7214     MOVE WS-PGECTR              TO  HD-PG.
  7215
  7216     ADD +1                      TO  WS-PGECTR.
  7217
  7218     MOVE '3'                    TO  BI-RECORD-TYPE.
  7219     MOVE TOP-OF-PAGE            TO  BI-SKIP-CONTROL.
  7220
  7221     IF NOT PI-PREVIEW
  7222         MOVE GA-HD1             TO  GA-TEXT-LINE
  7223     ELSE
  7224         MOVE GA-PREVIEW-HD      TO  GA-TEXT-LINE
  7225         PERFORM 3920-BILL-WRITE
  7226         MOVE '3'                TO  BI-RECORD-TYPE
  7227         MOVE DOUBLE-SPACE       TO  BI-SKIP-CONTROL
  7228         MOVE GA-HD1             TO  GA-TEXT-LINE.
  7229
  7230     PERFORM 3920-BILL-WRITE.
  7231
  7232     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7233     MOVE GA-HD2                 TO  GA-TEXT-LINE.
  7234
  7235     PERFORM 3920-BILL-WRITE.
  7236
  7237     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7238     MOVE GA-HD3                 TO  GA-TEXT-LINE.
  7239
  7240     PERFORM 3920-BILL-WRITE.
  7241
  7242     SET A-INDX                  TO  1.
  7243
  7244     PERFORM 3390-FORMAT-ADDR-TEXT-LINES  THRU  3390-EXIT
  7245         6  TIMES.
  7246
  7247     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7248     MOVE GA-HD4                 TO  GA-TEXT-LINE.
  7249
  7250     PERFORM 3920-BILL-WRITE.
  7251
  7252     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7253     MOVE GA-HD5                 TO  GA-TEXT-LINE.
  7254
  7255     PERFORM 3920-BILL-WRITE.
  7256
  7257 3380-EXIT.
  7258     EXIT.
  7259
  7260 3390-FORMAT-ADDR-TEXT-LINES.
  7261     MOVE '3'                    TO  BI-RECORD-TYPE.
  7262     MOVE SPACES                 TO  GA-TEXT-LINE.
  7263
  7264     IF A-INDX  =  1
  7265         MOVE DOUBLE-SPACE       TO  BI-SKIP-CONTROL
  7266         MOVE PI-SAV-CARR        TO  GA-CARRIER
  7267         MOVE PI-SAV-GROUP       TO  GA-GROUPING
  7268         MOVE PI-SAV-AGENT       TO  GA-AGENT
  7269         MOVE '-'                TO  GA-DASH
  7270     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL642T.cbl
  7271         MOVE SINGLE-SPACE       TO  BI-SKIP-CONTROL.
  7272
  7273     MOVE WS-AGENT-LINES (A-INDX)  TO  GA-AGENT-ADDR.
  7274
  7275     PERFORM 3920-BILL-WRITE.
  7276
  7277     SET A-INDX                  UP  BY  1.
  7278
  7279 3390-EXIT.
  7280     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL642T.cbl
  7282 3400-FORMAT-TOTAL-LINE.
  7283     MOVE SPACES                 TO  GA-TEXT-LINE.
  7284     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7285     MOVE '3'                    TO  BI-RECORD-TYPE.
  7286     MOVE SPACES                 TO  GA-TEXT-LINE.
  7287
  7288     PERFORM 3920-BILL-WRITE.
  7289
  7290     MOVE SPACES                 TO  GA-TEXT-LINE.
  7291     MOVE 'AGENT TOTAL'          TO  GA-ACCT-NAME.
  7292     MOVE WS-GA-BEG-BAL          TO  GA-BEG-BAL
  7293                                     GA-BEG-BAL-AMT.
  7294     MOVE WS-GA-NET-PREM         TO  GA-NET-PREM
  7295                                     GA-NET-PREM-AMT.
  7296     MOVE WS-GA-COMP             TO  GA-ACCT-COMP
  7297                                     GA-ACCT-COMP-AMT.
  7298     MOVE WS-GA-PAY-ADJS         TO  GA-PMTS-ADJS
  7299                                     GA-PMTS-ADJS-AMT.
  7300     MOVE WS-GA-END-BAL          TO  GA-END-BAL-AMT.
  7301     MOVE WS-GA-UNPAID-NET-PREM  TO  GA-UNPAID-NET-PREM
  7302                                     GA-UNPAID-NET-AMT.
  7303     MOVE PI-LIFE-OVERRIDE-L6    TO  GA-BEN-OVERRIDE-L6.
  7304     MOVE PI-LIFE-OVERRIDE-L2    TO  GA-BENEFIT-CD.
  7305     MOVE WS-GA-LF-OVERWRITE     TO  GA-OVERWRITE
  7306                                     GA-OVERWRITE-AMT.
  7307     MOVE WS-GA-AMT-DUE          TO  GA-AMT-DUE-AMT
  7308                                     GA-AMT-DUE.
  7309
  7310     PERFORM 3920-BILL-WRITE.
  7311
  7312     MOVE SPACES                 TO  GA-TEXT-LINE.
  7313     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7314     MOVE PI-AH-OVERRIDE-L6      TO  GA-BEN-OVERRIDE-L6
  7315     MOVE PI-AH-OVERRIDE-L2      TO  GA-BENEFIT-CD
  7316     MOVE WS-GA-AH-OVERWRITE     TO  GA-OVERWRITE
  7317                                     GA-OVERWRITE-AMT.
  7318
  7319     PERFORM 3920-BILL-WRITE.
  7320
  7321     MOVE SPACES                 TO  GA-TEXT-LINE.
  7322     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7323
  7324     PERFORM 3920-BILL-WRITE.
  7325
  7326     MOVE SPACES                 TO  GA-TEXT-LINE.
  7327     MOVE '1'                    TO  BI-RECORD-TYPE.
  7328     MOVE PI-PROCESSOR-ID        TO  GA-PROCESSOR-CD.
  7329
  7330     IF PI-PREV-BILL
  7331       OR  PI-PREV-REBILL
  7332         MOVE 'P'                TO  GA-STATEMENT-TYPE.
  7333
  7334     MOVE +1                     TO  GA-NO-OF-COPIES.
  7335     MOVE WS-CURRENT-DATE        TO  GA-CREATION-DT.
  7336     MOVE LOW-VALUES             TO  GA-INITIAL-PRINT-DATE.
  7337     MOVE PI-UNPAID-NET-PREM     TO  GA-NET-UNPD.
  7338     MOVE PI-COMP-UNPAID-PREM    TO  GA-COMP-UNPD-PREM.
  7339     MOVE PI-PREMIUM             TO  GA-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL642T.cbl
  7340     MOVE PI-REMITTED            TO  GA-REMITTED.
  7341     MOVE PI-TOT-ISS-COMP        TO  GA-TOT-ISS-COMP.
  7342     MOVE PI-TOT-CAN-COMP        TO  GA-TOT-CAN-COMP.
  7343     MOVE PI-ADJUSTMNTS          TO  GA-ADJUSTMNTS.
  7344     MOVE PI-DISBURSED           TO  GA-DISBURSED.
  7345     MOVE PI-AGENT-NAME          TO  GA-AGENTS-NAME.
  7346
  7347     PERFORM 3920-BILL-WRITE.
  7348
  7349     GO TO 3990-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL642T.cbl
  7351 3910-BILL-GETMAIN.
  7352
  7353* EXEC CICS GETMAIN
  7354*        SET      (ADDRESS OF BILLING-STATEMENT)
  7355*        LENGTH   (210)
  7356*        INITIMG  (GETMAIN-SPACE)
  7357*    END-EXEC.
  7358     MOVE 210
  7359       TO DFHEIV11
  7360*    MOVE ',"IL                  $   #00007263' TO DFHEIV0
  7361     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7362     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7363     MOVE X'2020233030303037323633' TO DFHEIV0(25:11)
  7364     CALL 'kxdfhei1' USING DFHEIV0,
  7365           DFHEIV20,
  7366           DFHEIV11,
  7367           GETMAIN-SPACE
  7368     SET ADDRESS OF BILLING-STATEMENT TO
  7369         DFHEIV20
  7370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7371
  7372
  7373 3920-BILL-WRITE.
  7374     MOVE PI-COMPANY-CD          TO  BI-COMPANY-CD.
  7375     MOVE PI-SAV-CARR            TO  BI-CARRIER.
  7376     MOVE PI-SAV-GROUP           TO  BI-GROUPING.
  7377     MOVE LOW-VALUES             TO  BI-ACCOUNT.
  7378     MOVE PI-SAV-AGENT           TO  BI-FIN-RESP.
  7379     MOVE 'BI'                   TO  BI-RECORD-ID.
  7380
  7381     ADD +1                      TO  WS-LINE-SEQ-NO.
  7382
  7383     IF BI-RECORD-TYPE = '1'
  7384         MOVE ZEROS              TO  BI-LINE-SEQ-NO
  7385     ELSE
  7386         MOVE WS-LINE-SEQ-NO     TO  BI-LINE-SEQ-NO.
  7387
  7388
  7389* EXEC CICS WRITE
  7390*        DATASET  (ERBILL-FILE-ID)
  7391*        FROM     (BILLING-STATEMENT)
  7392*        RIDFLD   (BI-CONTROL-PRIMARY)
  7393*    END-EXEC.
  7394     MOVE LENGTH OF
  7395      BILLING-STATEMENT
  7396       TO DFHEIV11
  7397*    MOVE '&$ L                  ''   #00007284' TO DFHEIV0
  7398     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7399     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7400     MOVE X'2020233030303037323834' TO DFHEIV0(25:11)
  7401     CALL 'kxdfhei1' USING DFHEIV0,
  7402           ERBILL-FILE-ID,
  7403           BILLING-STATEMENT,
  7404           DFHEIV11,
  7405           BI-CONTROL-PRIMARY,
  7406           DFHEIV99,
  7407           DFHEIV99
  7408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL642T.cbl
  7409
  7410
  7411 3930-BILL-READ.
  7412     MOVE PI-COMPANY-CD          TO  ERBILL-CO-CD.
  7413     MOVE PI-SAV-CARR            TO  ERBILL-CARRIER.
  7414     MOVE PI-SAV-GROUP           TO  ERBILL-GROUP.
  7415     MOVE LOW-VALUES             TO  ERBILL-ACCT.
  7416     MOVE PI-SAV-AGENT           TO  ERBILL-FIN-RESP.
  7417     MOVE '1'                    TO  ERBILL-REC-TYPE.
  7418     MOVE ZEROS                  TO  ERBILL-LINE-SEQ-NO.
  7419
  7420
  7421* EXEC CICS HANDLE CONDITION
  7422*        NOTFND  (3930-BILL-NOTFND)
  7423*    END-EXEC.
  7424*    MOVE '"$I                   ! $ #00007299' TO DFHEIV0
  7425     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7426     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7427     MOVE X'2420233030303037323939' TO DFHEIV0(25:11)
  7428     CALL 'kxdfhei1' USING DFHEIV0
  7429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7430
  7431
  7432
  7433* EXEC CICS READ
  7434*        SET      (ADDRESS OF BILLING-STATEMENT)
  7435*        DATASET  (ERBILL-FILE-ID)
  7436*        RIDFLD   (ERBILL-KEY)
  7437*        GTEQ
  7438*    END-EXEC.
  7439*    MOVE '&"S        G          (   #00007303' TO DFHEIV0
  7440     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7441     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7442     MOVE X'2020233030303037333033' TO DFHEIV0(25:11)
  7443     CALL 'kxdfhei1' USING DFHEIV0,
  7444           ERBILL-FILE-ID,
  7445           DFHEIV20,
  7446           DFHEIV99,
  7447           ERBILL-KEY,
  7448           DFHEIV99,
  7449           DFHEIV99,
  7450           DFHEIV99
  7451     SET ADDRESS OF BILLING-STATEMENT TO
  7452         DFHEIV20
  7453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7454
  7455
  7456     IF BI-COMPANY-CD  =  PI-COMPANY-CD
  7457       AND  BI-CARRIER  =  ERBILL-CARRIER
  7458       AND  BI-GROUPING  =  ERBILL-GROUP
  7459       AND  BI-ACCOUNT  =  ERBILL-ACCT
  7460       AND  BI-FIN-RESP  =  ERBILL-FIN-RESP
  7461         MOVE SPACE              TO  NO-BILL-REC-SW
  7462         GO TO 3930-EXIT
  7463     ELSE
  7464         GO TO 3930-BILL-NOTFND.
  7465
  7466 3930-BILL-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL642T.cbl
  7467     MOVE 'Y'                    TO  NO-BILL-REC-SW.
  7468
  7469 3930-EXIT.
  7470     EXIT.
  7471
  7472 3940-BILL-GENERIC-DELETE.
  7473
  7474* EXEC CICS HANDLE CONDITION
  7475*        NOTFND  (3940-EXIT)
  7476*    END-EXEC.
  7477*    MOVE '"$I                   ! % #00007327' TO DFHEIV0
  7478     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7479     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7480     MOVE X'2520233030303037333237' TO DFHEIV0(25:11)
  7481     CALL 'kxdfhei1' USING DFHEIV0
  7482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7483
  7484
  7485     MOVE PI-COMPANY-CD          TO  ERBILL-CO-CD.
  7486     MOVE PI-SAV-CARR            TO  ERBILL-CARRIER.
  7487     MOVE PI-SAV-GROUP           TO  ERBILL-GROUP.
  7488     MOVE LOW-VALUES             TO  ERBILL-ACCT.
  7489     MOVE PI-SAV-AGENT           TO  ERBILL-FIN-RESP.
  7490
  7491
  7492* EXEC CICS DELETE
  7493*        DATASET    (ERBILL-FILE-ID)
  7494*        RIDFLD     (ERBILL-KEY)
  7495*        KEYLENGTH  (28)
  7496*        GENERIC
  7497*    END-EXEC.
  7498     MOVE 28
  7499       TO DFHEIV11
  7500*    MOVE '&(  RKG               &   #00007337' TO DFHEIV0
  7501     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  7502     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7503     MOVE X'2020233030303037333337' TO DFHEIV0(25:11)
  7504     CALL 'kxdfhei1' USING DFHEIV0,
  7505           ERBILL-FILE-ID,
  7506           ERBILL-KEY,
  7507           DFHEIV11,
  7508           DFHEIV99,
  7509           DFHEIV99
  7510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7511
  7512
  7513 3940-EXIT.
  7514     EXIT.
  7515
  7516 3990-EXIT.
  7517     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL642T.cbl
  7519 4000-PNDB-START-BROWSE.
  7520     MOVE SPACES                 TO  ERPNDB-ALT-KEY.
  7521     MOVE PI-COMPANY-CD          TO  ERPNDB-CO-CD-A1.
  7522
  7523     IF CARR-GROUP-ST-ACCNT-CNTL
  7524         MOVE GX-AM-CARRIER  (GX-SUB)  TO  ERPNDB-CARR
  7525         MOVE GX-AM-GROUPING (GX-SUB)  TO  ERPNDB-GROUP
  7526         MOVE GX-AM-STATE    (GX-SUB)  TO  ERPNDB-STATE
  7527         MOVE GX-AM-ACCOUNT  (GX-SUB)  TO  ERPNDB-ACCT
  7528     ELSE
  7529     IF CARR-ST-ACCNT-CNTL
  7530         MOVE GX-AM-CARRIER (GX-SUB)   TO  ERPNDB-CARR
  7531         MOVE GX-AM-STATE   (GX-SUB)   TO  ERPNDB-STATE
  7532         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  ERPNDB-ACCT
  7533     ELSE
  7534     IF CARR-ACCNT-CNTL
  7535         MOVE GX-AM-CARRIER (GX-SUB)   TO  ERPNDB-CARR
  7536         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  ERPNDB-ACCT
  7537     ELSE
  7538     IF ACCNT-CNTL
  7539         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  ERPNDB-ACCT
  7540     ELSE
  7541         MOVE GX-AM-STATE   (GX-SUB)   TO  ERPNDB-STATE
  7542         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  ERPNDB-ACCT.
  7543
  7544     MOVE GX-AM-EFF-DT (GX-SUB)  TO  ERPNDB-EFF-DT.
  7545
  7546
  7547* EXEC CICS HANDLE CONDITION
  7548*        NOTFND  (4010-REC-NOT-FND)
  7549*    END-EXEC.
  7550*    MOVE '"$I                   ! & #00007377' TO DFHEIV0
  7551     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7552     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7553     MOVE X'2620233030303037333737' TO DFHEIV0(25:11)
  7554     CALL 'kxdfhei1' USING DFHEIV0
  7555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7556
  7557
  7558
  7559* EXEC CICS STARTBR
  7560*        DATASET  (ERPNDB-ALT-FILE-ID)
  7561*        RIDFLD   (ERPNDB-ALT-KEY)
  7562*        GTEQ
  7563*    END-EXEC.
  7564     MOVE 0
  7565       TO DFHEIV11
  7566*    MOVE '&,         G          &   #00007381' TO DFHEIV0
  7567     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7568     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7569     MOVE X'2020233030303037333831' TO DFHEIV0(25:11)
  7570     CALL 'kxdfhei1' USING DFHEIV0,
  7571           ERPNDB-ALT-FILE-ID,
  7572           ERPNDB-ALT-KEY,
  7573           DFHEIV99,
  7574           DFHEIV11,
  7575           DFHEIV99
  7576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL642T.cbl
  7577
  7578
  7579     GO TO 4090-EXIT.
  7580
  7581 4010-REC-NOT-FND.
  7582     MOVE 'Y'                    TO  PNDB-EOF-SW.
  7583
  7584 4090-EXIT.
  7585     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL642T.cbl
  7587 4100-PNDB-READ-NEXT.
  7588
  7589* EXEC CICS HANDLE CONDITION
  7590*        ENDFILE  (4110-END-OF-FILE)
  7591*    END-EXEC.
  7592*    MOVE '"$''                   ! '' #00007396' TO DFHEIV0
  7593     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7594     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7595     MOVE X'2720233030303037333936' TO DFHEIV0(25:11)
  7596     CALL 'kxdfhei1' USING DFHEIV0
  7597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7598
  7599
  7600
  7601* EXEC CICS READNEXT
  7602*        SET      (ADDRESS OF PENDING-BUSINESS)
  7603*        DATASET  (ERPNDB-ALT-FILE-ID)
  7604*        RIDFLD   (ERPNDB-ALT-KEY)
  7605*    END-EXEC.
  7606     MOVE 0
  7607       TO DFHEIV11
  7608*    MOVE '&.S                   )   #00007400' TO DFHEIV0
  7609     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7610     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7611     MOVE X'2020233030303037343030' TO DFHEIV0(25:11)
  7612     CALL 'kxdfhei1' USING DFHEIV0,
  7613           ERPNDB-ALT-FILE-ID,
  7614           DFHEIV20,
  7615           DFHEIV99,
  7616           ERPNDB-ALT-KEY,
  7617           DFHEIV99,
  7618           DFHEIV11,
  7619           DFHEIV99,
  7620           DFHEIV99
  7621     SET ADDRESS OF PENDING-BUSINESS TO
  7622         DFHEIV20
  7623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7624
  7625
  7626     GO TO 4150-EXIT.
  7627
  7628 4110-END-OF-FILE.
  7629     MOVE 'Y'                    TO  PNDB-EOF-SW.
  7630
  7631 4150-EXIT.
  7632     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL642T.cbl
  7634 4160-PNDB-END-BROWSE.
  7635
  7636* EXEC CICS ENDBR
  7637*        DATASET  (ERPNDB-ALT-FILE-ID)
  7638*    END-EXEC.
  7639     MOVE 0
  7640       TO DFHEIV11
  7641*    MOVE '&2                    $   #00007415' TO DFHEIV0
  7642     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7643     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7644     MOVE X'2020233030303037343135' TO DFHEIV0(25:11)
  7645     CALL 'kxdfhei1' USING DFHEIV0,
  7646           ERPNDB-ALT-FILE-ID,
  7647           DFHEIV11,
  7648           DFHEIV99
  7649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7650
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL642T.cbl
  7652 4200-PNDB-REWRITE.
  7653     MOVE PB-COMPANY-CD          TO  ERPNDB-CO-CD.
  7654     MOVE PB-ENTRY-BATCH         TO  ERPNDB-BATCH.
  7655     MOVE PB-BATCH-SEQ-NO        TO  ERPNDB-SEQ-NO.
  7656     MOVE PB-BATCH-CHG-SEQ-NO    TO  ERPNDB-CHG-SEQ-NO.
  7657
  7658     PERFORM 4160-PNDB-END-BROWSE
  7659
  7660
  7661* EXEC CICS READ
  7662*        SET      (ADDRESS OF PENDING-BUSINESS)
  7663*        DATASET  (ERPNDB-FILE-ID)
  7664*        RIDFLD   (ERPNDB-PRIME-KEY)
  7665*        UPDATE
  7666*    END-EXEC.
  7667*    MOVE '&"S        EU         (   #00007427' TO DFHEIV0
  7668     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7669     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7670     MOVE X'2020233030303037343237' TO DFHEIV0(25:11)
  7671     CALL 'kxdfhei1' USING DFHEIV0,
  7672           ERPNDB-FILE-ID,
  7673           DFHEIV20,
  7674           DFHEIV99,
  7675           ERPNDB-PRIME-KEY,
  7676           DFHEIV99,
  7677           DFHEIV99,
  7678           DFHEIV99
  7679     SET ADDRESS OF PENDING-BUSINESS TO
  7680         DFHEIV20
  7681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7682
  7683
  7684     MOVE 'B'                    TO  JP-RECORD-TYPE.
  7685     MOVE PENDING-BUSINESS       TO  JP-RECORD-AREA.
  7686     MOVE ERPNDB-FILE-ID         TO  JP-FILE-ID.
  7687
  7688     COMPUTE JOURNAL-LENGTH = ERPNDB-LENGTH + 23.
  7689
  7690     PERFORM 8400-LOG-JOURNAL-RECORD.
  7691
  7692     IF PI-VOID-BILL
  7693         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (WS-GA-LEVEL)
  7694     ELSE
  7695         MOVE WS-CURRENT-DATE    TO  PB-GA-BILL-DT (WS-GA-LEVEL).
  7696
  7697     MOVE PI-PROCESSOR-ID        TO  PB-LAST-MAINT-BY.
  7698     MOVE EIBTIME                TO  PB-LAST-MAINT-HHMMSS.
  7699     MOVE WS-CURRENT-DATE        TO  PB-LAST-MAINT-DT.
  7700     MOVE 'C'                    TO  JP-RECORD-TYPE.
  7701     MOVE PENDING-BUSINESS       TO  JP-RECORD-AREA.
  7702     MOVE ERPNDB-FILE-ID         TO  JP-FILE-ID.
  7703
  7704     COMPUTE JOURNAL-LENGTH = ERPNDB-LENGTH + 23.
  7705
  7706
  7707* EXEC CICS REWRITE
  7708*        DATASET  (ERPNDB-FILE-ID)
  7709*        FROM     (PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL642T.cbl
  7710*    END-EXEC.
  7711     MOVE LENGTH OF
  7712      PENDING-BUSINESS
  7713       TO DFHEIV11
  7714*    MOVE '&& L                  %   #00007456' TO DFHEIV0
  7715     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7716     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7717     MOVE X'2020233030303037343536' TO DFHEIV0(25:11)
  7718     CALL 'kxdfhei1' USING DFHEIV0,
  7719           ERPNDB-FILE-ID,
  7720           PENDING-BUSINESS,
  7721           DFHEIV11,
  7722           DFHEIV99
  7723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7724
  7725
  7726     PERFORM 8400-LOG-JOURNAL-RECORD.
  7727
  7728
  7729* EXEC CICS HANDLE CONDITION
  7730*        NOTFND  (4290-REC-NOT-FND)
  7731*    END-EXEC.
  7732*    MOVE '"$I                   ! ( #00007463' TO DFHEIV0
  7733     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7734     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7735     MOVE X'2820233030303037343633' TO DFHEIV0(25:11)
  7736     CALL 'kxdfhei1' USING DFHEIV0
  7737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7738
  7739
  7740
  7741* EXEC CICS STARTBR
  7742*        DATASET  (ERPNDB-ALT-FILE-ID)
  7743*        RIDFLD   (ERPNDB-ALT-KEY)
  7744*        GTEQ
  7745*    END-EXEC.
  7746     MOVE 0
  7747       TO DFHEIV11
  7748*    MOVE '&,         G          &   #00007467' TO DFHEIV0
  7749     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7750     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7751     MOVE X'2020233030303037343637' TO DFHEIV0(25:11)
  7752     CALL 'kxdfhei1' USING DFHEIV0,
  7753           ERPNDB-ALT-FILE-ID,
  7754           ERPNDB-ALT-KEY,
  7755           DFHEIV99,
  7756           DFHEIV11,
  7757           DFHEIV99
  7758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7759
  7760
  7761     PERFORM 4100-PNDB-READ-NEXT  THRU  4150-EXIT.
  7762
  7763     GO TO 4290-EXIT.
  7764
  7765 4290-REC-NOT-FND.
  7766     MOVE 'Y'                    TO  PYAJ-EOF-SW.
  7767
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL642T.cbl
  7768 4290-EXIT.
  7769     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL642T.cbl
  7771 4300-READ-ACCOUNT-MASTER.
  7772
  7773     MOVE SPACE                  TO  INVALID-ACCOUNT-SW.
  7774     MOVE PI-COMPANY-CD          TO  ERACCT-P-CO-CD.
  7775     MOVE PI-CR-CARRIER          TO  ERACCT-P-CARRIER.
  7776     MOVE PI-CR-GROUPING         TO  ERACCT-P-GROUPING.
  7777     MOVE PI-CR-STATE            TO  ERACCT-P-STATE.
  7778     MOVE PI-CR-ACCOUNT          TO  ERACCT-P-ACCOUNT.
  7779     MOVE PI-SAV-EXP-DT          TO  ERACCT-P-EXP-DATE.
  7780
  7781
  7782* EXEC CICS HANDLE CONDITION
  7783*        NOTFND  (4370-ACCOUNT-INVALID)
  7784*    END-EXEC.
  7785*    MOVE '"$I                   ! ) #00007493' TO DFHEIV0
  7786     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7787     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7788     MOVE X'2920233030303037343933' TO DFHEIV0(25:11)
  7789     CALL 'kxdfhei1' USING DFHEIV0
  7790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7791
  7792
  7793
  7794* EXEC CICS READ
  7795*        DATASET  (ERACCT-FILE-ID)
  7796*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7797*        RIDFLD   (ERACCT-PRIME-KEY)
  7798*        EQUAL
  7799*    END-EXEC.
  7800*    MOVE '&"S        E          (   #00007497' TO DFHEIV0
  7801     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7802     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7803     MOVE X'2020233030303037343937' TO DFHEIV0(25:11)
  7804     CALL 'kxdfhei1' USING DFHEIV0,
  7805           ERACCT-FILE-ID,
  7806           DFHEIV20,
  7807           DFHEIV99,
  7808           ERACCT-PRIME-KEY,
  7809           DFHEIV99,
  7810           DFHEIV99,
  7811           DFHEIV99
  7812     SET ADDRESS OF ACCOUNT-MASTER TO
  7813         DFHEIV20
  7814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7815
  7816
  7817     IF AM-REMIT-TO  NOT GREATER THAN  '00'
  7818         GO TO 4370-ACCOUNT-INVALID.
  7819
  7820     IF AM-AGT (AM-REMIT-TO)  =  SPACES
  7821         MOVE PI-CR-ACCOUNT      TO  PI-SAV-REMIT-TO
  7822     ELSE
  7823         MOVE AM-AGT (AM-REMIT-TO)
  7824                                 TO  PI-SAV-REMIT-TO.
  7825
  7826     MOVE AM-EXPIRATION-DT       TO  ERACCT-P-EXP-DATE.
  7827     MOVE AM-CARRIER             TO  PI-CR-CARRIER.
  7828     MOVE AM-GROUPING            TO  PI-CR-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL642T.cbl
  7829     MOVE AM-STATE               TO  PI-CR-STATE.
  7830     MOVE AM-AGT (AM-REMIT-TO)   TO  PI-SAV-FIN-RESP
  7831                                     PI-COMP-FIN-RESP.
  7832
  7833     IF PI-ZERO-CARRIER
  7834       OR  PI-ZERO-CAR-GROUP
  7835         MOVE ZEROS              TO  PI-COMP-CARRIER
  7836     ELSE
  7837         MOVE AM-CARRIER         TO  PI-COMP-CARRIER.
  7838
  7839     IF PI-ZERO-GROUPING
  7840        OR  PI-ZERO-CAR-GROUP
  7841         MOVE ZEROS              TO  PI-COMP-GROUPING
  7842     ELSE
  7843         MOVE AM-GROUPING        TO  PI-COMP-GROUPING.
  7844
  7845     IF CARR-GROUP-ST-ACCNT-CNTL
  7846         MOVE SPACE              TO  NEW-ACCOUNT-SW.
  7847
  7848     MOVE +0                     TO  ACCOM-SUB.
  7849
  7850 4320-FIND-ACCT-RESPONSIBILITY.
  7851     ADD +1                      TO  ACCOM-SUB.
  7852
  7853     IF ACCOM-SUB  GREATER THAN  +10
  7854         MOVE  AM-ACCOUNT        TO  GA-ACCT
  7855         GO TO 4330-FIND-GA-COMMISSION.
  7856
  7857     IF AM-COM-TYP (ACCOM-SUB) = 'C' OR 'D' OR 'F' OR 'S'
  7858         NEXT SENTENCE
  7859     ELSE
  7860         GO TO 4320-FIND-ACCT-RESPONSIBILITY.
  7861
  7862     IF AM-AGT (ACCOM-SUB)  NOT =  PI-SAV-ACCT-AGT
  7863         MOVE 'Y'                TO  NEW-ACCOUNT-SW.
  7864
  7865     MOVE AM-AGT (ACCOM-SUB)     TO  PI-SAV-ACCT-AGT.
  7866     MOVE AM-NAME                TO  PI-SAV-ACCT-NAME.
  7867
  7868 4330-FIND-GA-COMMISSION.
  7869     MOVE ZEROS                  TO  WS-GA-LEVEL
  7870                                     WS-GA-LF-COM
  7871                                     WS-GA-AH-COM.
  7872     MOVE +0                     TO  ACCOM-SUB.
  7873
  7874 4340-SEARCH-FOR-GA-COMMISSION.
  7875     ADD +1                      TO  ACCOM-SUB.
  7876
  7877     IF ACCOM-SUB  GREATER THAN  +10
  7878         GO TO 4370-ACCOUNT-INVALID.
  7879
  7880     IF AM-COM-TYP (ACCOM-SUB)  = 'O' OR 'P' OR 'G' OR 'B'
  7881         NEXT SENTENCE
  7882     ELSE
  7883         GO TO 4340-SEARCH-FOR-GA-COMMISSION.
  7884
  7885     IF AM-AGT (ACCOM-SUB)  NOT =  PI-SAV-AGENT
  7886         GO TO 4340-SEARCH-FOR-GA-COMMISSION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL642T.cbl
  7887
  7888     MOVE ACCOM-SUB              TO  WS-GA-LEVEL.
  7889
  7890     GO TO 4390-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL642T.cbl
  7892 4370-ACCOUNT-INVALID.
  7893     MOVE 'Y'                    TO  INVALID-ACCOUNT-SW.
  7894     MOVE ER-2210                TO  EMI-ERROR.
  7895
  7896     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7897
  7898     GO TO 4390-EXIT.
  7899
  7900 4390-EXIT.
  7901     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL642T.cbl
  7903 4400-FIND-COMMISSION.
  7904******************************************************************
  7905*    IF THE AGENT'S COMMISSION IS NUMERIC FOR A&H AND LIFE       *
  7906*    IN THE ACCOUNT MASTER THAT IS THE COMMISSION.  IF THE       *
  7907*    COMMISSION IN THE A&H AND LIFE CONTAINS A TABLE CODE        *
  7908*    READ THE COMMISSION-TABLE TO GET THE COMMISSION RATE.       *
  7909*    FOR CLIENT "DMD" THE ABOVE COMMISSION MAY BE OVERWRITTEN    *
  7910*    IF AN ACCOUNT RESIDENT STATE COMMISSION RECORD EXISTS.      *
  7911******************************************************************
  7912
  7913     MOVE PI-COMPANY-CD          TO  ERCTBL-COMPANY-CD.
  7914
  7915 4405-FIND-AH-COMMISSION.
  7916* SET UP COMMISSION TABLE KEY BEFORE DETERMINING COMMISSION
  7917     IF PB-ISSUE
  7918         MOVE PB-I-AH-BENEFIT-CD  TO  ERCTBL-BEN-CODE
  7919     ELSE
  7920         MOVE PB-CI-AH-BENEFIT-CD TO  ERCTBL-BEN-CODE.
  7921
  7922     MOVE 'A'                     TO  ERCTBL-BEN-TYPE.
  7923
  7924     MOVE 'AH'                   TO WS-COMM-SW.
  7925
  7926     IF AM-A-COM (WS-GA-LEVEL)  NUMERIC
  7927         MOVE AM-A-COM (WS-GA-LEVEL)
  7928                                 TO  WS-COMMISSION
  7929         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
  7930         MOVE WS-COMMISSION      TO  WS-GA-AH-COM
  7931         GO TO 4410-FIND-LIFE-COMMISSION.
  7932
  7933     IF ERCTBL-BEN-CODE  =  ZEROS
  7934         MOVE ZEROS              TO  WS-GA-LF-COM
  7935         GO TO 4410-FIND-LIFE-COMMISSION.
  7936
  7937     MOVE ZEROS                  TO WS-SUB1.
  7938     PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT.
  7939     IF WS-SUB1 IS GREATER THAN ZEROS
  7940         GO TO 4410-FIND-LIFE-COMMISSION.
  7941
  7942     MOVE 'A'                     TO  ERCTBL-BEN-TYPE.
  7943
  7944     MOVE AM-A-COMA (WS-GA-LEVEL) TO ERCTBL-TABLE.
  7945     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  7946
  7947     IF ERCTBL-NOT-FOUND
  7948         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  7949         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  7950         IF ERCTBL-NOT-FOUND
  7951             MOVE -1             TO  AAGENTL
  7952             MOVE ER-2916        TO  EMI-ERROR
  7953             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7954             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  7955             GO TO 8200-SEND-DATAONLY.
  7956
  7957     PERFORM 6680-AH-GET-COMP-RATE.
  7958
  7959 4410-FIND-LIFE-COMMISSION.
  7960     IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL642T.cbl
  7961         MOVE PB-CI-LF-BENEFIT-CD  TO CLBENF-CD
  7962     ELSE
  7963         MOVE PB-I-LF-BENEFIT-CD   TO CLBENF-CD.
  7964
  7965     MOVE 'LF'                   TO WS-COMM-SW.
  7966
  7967     IF CLBENF-CD  =  ZEROS  OR  SPACES
  7968         MOVE ZEROS              TO  WS-GA-LF-COM
  7969         GO TO 4490-EXIT.
  7970
  7971     IF PB-ISSUE
  7972         MOVE PB-I-LIFE-INDICATOR TO LIFE-INDICATOR
  7973         GO TO 4420-CONT-FIND-LIFE-COMMISSION.
  7974
  7975     PERFORM 6800-READ-BENEFIT-MASTER  THRU  6890-EXIT.
  7976
  7977     IF BENEFIT-MASTER-FOUND
  7978         NEXT SENTENCE
  7979     ELSE
  7980         MOVE -1                 TO  AAGENTL
  7981         MOVE ER-2917            TO  EMI-ERROR
  7982         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7983         PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  7984         GO TO 8200-SEND-DATAONLY.
  7985
  7986 4420-CONT-FIND-LIFE-COMMISSION.
  7987* SET UP COMMISSION TABLE KEY BEFORE DETERMINING COMMISSION
  7988
  7989     IF PB-ISSUE
  7990         MOVE PB-I-LF-BENEFIT-CD  TO  ERCTBL-BEN-CODE
  7991     ELSE
  7992         MOVE PB-CI-LF-BENEFIT-CD TO  ERCTBL-BEN-CODE.
  7993
  7994     MOVE 'L'                     TO  ERCTBL-BEN-TYPE.
  7995
  7996     IF JOINT-LIFE
  7997         NEXT SENTENCE
  7998     ELSE
  7999         GO TO 4430-SINGLE-LIFE-COMMISSION.
  8000
  8001     IF AM-J-COM (WS-GA-LEVEL)  NUMERIC
  8002         MOVE AM-J-COM (WS-GA-LEVEL)
  8003                                 TO  WS-COMMISSION
  8004         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
  8005         MOVE WS-COMMISSION      TO  WS-GA-LF-COM
  8006         GO TO 4490-EXIT.
  8007
  8008     MOVE ZEROS                  TO WS-SUB1.
  8009     PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT.
  8010     IF WS-SUB1 IS GREATER THAN ZEROS
  8011         GO TO 4490-EXIT.
  8012
  8013     MOVE AM-J-COMA (WS-GA-LEVEL) TO ERCTBL-TABLE.
  8014
  8015     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8016
  8017     IF ERCTBL-NOT-FOUND
  8018         MOVE 'AA'               TO  ERCTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL642T.cbl
  8019         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8020         IF ERCTBL-NOT-FOUND
  8021             MOVE -1             TO  AAGENTL
  8022             MOVE ER-2916        TO  EMI-ERROR
  8023             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8024             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8025             GO TO 8200-SEND-DATAONLY.
  8026
  8027     PERFORM 6680-LF-GET-COMP-RATE.
  8028     GO TO 4490-EXIT.
  8029
  8030 4430-SINGLE-LIFE-COMMISSION.
  8031* SET UP COMMISSION TABLE KEY BEFORE DETERMINING COMMISSION
  8032
  8033     IF PB-ISSUE
  8034         MOVE PB-I-LF-BENEFIT-CD  TO  ERCTBL-BEN-CODE
  8035     ELSE
  8036         MOVE PB-CI-LF-BENEFIT-CD TO  ERCTBL-BEN-CODE.
  8037
  8038     MOVE 'L'                     TO  ERCTBL-BEN-TYPE.
  8039*
  8040     IF AM-L-COM (WS-GA-LEVEL)  NUMERIC
  8041         MOVE AM-L-COM (WS-GA-LEVEL)
  8042                                 TO  WS-COMMISSION
  8043         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
  8044         MOVE WS-COMMISSION      TO  WS-GA-LF-COM
  8045         GO TO 4490-EXIT.
  8046
  8047     MOVE ZEROS                  TO WS-SUB1.
  8048     PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT.
  8049     IF WS-SUB1 IS GREATER THAN ZEROS
  8050         GO TO 4490-EXIT.
  8051
  8052     MOVE ZEROS                  TO WS-SUB1.
  8053     MOVE AM-L-COMA (WS-GA-LEVEL) TO ERCTBL-TABLE
  8054
  8055     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8056
  8057     IF ERCTBL-NOT-FOUND
  8058         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8059         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8060         IF ERCTBL-NOT-FOUND
  8061             MOVE -1             TO  AAGENTL
  8062             MOVE ER-2916        TO  EMI-ERROR
  8063             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8064             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8065             GO TO 8200-SEND-DATAONLY.
  8066
  8067     PERFORM 6680-LF-GET-COMP-RATE.
  8068     GO TO 4490-EXIT.
  8069
  8070 4490-EXIT.
  8071     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL642T.cbl
  8073 4500-PYAJ-START-BROWSE.
  8074     MOVE LOW-VALUES             TO  ERPYAJ-KEY.
  8075     MOVE PI-COMPANY-CD          TO  ERPYAJ-COMP-CD.
  8076
  8077     IF GENERAL-AGENT
  8078         MOVE PI-SAV-CARR        TO  ERPYAJ-CARRIER
  8079         MOVE PI-SAV-GROUP       TO  ERPYAJ-GROUPING
  8080         MOVE PI-SAV-AGENT       TO  ERPYAJ-FIN-RESP
  8081         MOVE LOW-VALUES         TO  ERPYAJ-ACCOUNT
  8082     ELSE
  8083         MOVE PI-COMP-CARRIER    TO  ERPYAJ-CARRIER
  8084         MOVE PI-COMP-GROUPING   TO  ERPYAJ-GROUPING
  8085         MOVE PI-COMP-FIN-RESP   TO  ERPYAJ-FIN-RESP
  8086         MOVE PI-CR-ACCOUNT      TO  ERPYAJ-ACCOUNT.
  8087
  8088     MOVE ERPYAJ-KEY             TO  ERPYAJ-BROWSE-COMP-KEY.
  8089
  8090
  8091* EXEC CICS HANDLE CONDITION
  8092*        NOTFND  (4510-REC-NOT-FND)
  8093*    END-EXEC.
  8094*    MOVE '"$I                   ! * #00007777' TO DFHEIV0
  8095     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8096     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8097     MOVE X'2A20233030303037373737' TO DFHEIV0(25:11)
  8098     CALL 'kxdfhei1' USING DFHEIV0
  8099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8100
  8101
  8102
  8103* EXEC CICS STARTBR
  8104*        DATASET  (ERPYAJ-FILE-ID)
  8105*        RIDFLD   (ERPYAJ-KEY)
  8106*        GTEQ
  8107*    END-EXEC.
  8108     MOVE 0
  8109       TO DFHEIV11
  8110*    MOVE '&,         G          &   #00007781' TO DFHEIV0
  8111     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8112     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8113     MOVE X'2020233030303037373831' TO DFHEIV0(25:11)
  8114     CALL 'kxdfhei1' USING DFHEIV0,
  8115           ERPYAJ-FILE-ID,
  8116           ERPYAJ-KEY,
  8117           DFHEIV99,
  8118           DFHEIV11,
  8119           DFHEIV99
  8120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8121
  8122
  8123     GO TO 4590-EXIT.
  8124
  8125 4510-REC-NOT-FND.
  8126     MOVE 'Y'                    TO  PYAJ-EOF-SW.
  8127
  8128 4590-EXIT.
  8129     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL642T.cbl
  8131 4600-PYAJ-READ-NEXT.
  8132
  8133* EXEC CICS HANDLE CONDITION
  8134*        ENDFILE  (4610-END-OF-FILE)
  8135*    END-EXEC.
  8136*    MOVE '"$''                   ! + #00007796' TO DFHEIV0
  8137     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8138     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8139     MOVE X'2B20233030303037373936' TO DFHEIV0(25:11)
  8140     CALL 'kxdfhei1' USING DFHEIV0
  8141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8142
  8143
  8144
  8145* EXEC CICS READNEXT
  8146*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  8147*        DATASET  (ERPYAJ-FILE-ID)
  8148*        RIDFLD   (ERPYAJ-KEY)
  8149*    END-EXEC.
  8150     MOVE 0
  8151       TO DFHEIV11
  8152*    MOVE '&.S                   )   #00007800' TO DFHEIV0
  8153     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8154     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8155     MOVE X'2020233030303037383030' TO DFHEIV0(25:11)
  8156     CALL 'kxdfhei1' USING DFHEIV0,
  8157           ERPYAJ-FILE-ID,
  8158           DFHEIV20,
  8159           DFHEIV99,
  8160           ERPYAJ-KEY,
  8161           DFHEIV99,
  8162           DFHEIV11,
  8163           DFHEIV99,
  8164           DFHEIV99
  8165     SET ADDRESS OF PENDING-PAY-ADJ TO
  8166         DFHEIV20
  8167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8168
  8169
  8170     GO TO 4690-EXIT.
  8171
  8172 4610-END-OF-FILE.
  8173     MOVE 'Y'                    TO  PYAJ-EOF-SW.
  8174
  8175 4690-EXIT.
  8176     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL642T.cbl
  8178 4700-PROCESS-COMM-EXCEPTION.
  8179     PERFORM 6600-READ-COMMISSION-EXCEPTION  THRU  6620-EXIT.
  8180
  8181     IF ERCOMM-NOT-FOUND
  8182         MOVE -1                 TO  AAGENTL
  8183         MOVE ER-2915            TO  EMI-ERROR
  8184         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8185         PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8186         GO TO 8200-SEND-DATAONLY.
  8187
  8188     MOVE WS-GA-LEVEL            TO  CE-SUB.
  8189     MOVE PI-COMPANY-CD          TO  ERCTBL-COMPANY-CD.
  8190
  8191     IF CE-LF-COMP (CE-SUB)  NUMERIC
  8192         IF CE-AH-COMP (CE-SUB)  NUMERIC
  8193             MOVE CE-LF-COMP (CE-SUB)  TO  WS-GA-LF-COM
  8194             MOVE CE-AH-COMP (CE-SUB)  TO  WS-GA-AH-COM
  8195             GO TO 4790-EXIT.
  8196
  8197 4715-FIND-AH-COMMISSION.
  8198     IF CE-AH-COMP (CE-SUB)  NUMERIC
  8199         MOVE CE-AH-COMP (CE-SUB)  TO  WS-GA-AH-COM
  8200         GO TO 4750-FIND-LIFE-COMMISSION.
  8201
  8202     MOVE CE-AH-COMPT (CE-SUB)   TO  ERCTBL-TABLE.
  8203
  8204     IF PB-ISSUE
  8205         MOVE PB-I-AH-BENEFIT-CD   TO  ERCTBL-BEN-CODE
  8206     ELSE
  8207         MOVE PB-CI-AH-BENEFIT-CD  TO  ERCTBL-BEN-CODE.
  8208
  8209     IF ERCTBL-BEN-CODE  =  ZEROS
  8210         MOVE ZEROS              TO  WS-GA-AH-COM
  8211         GO TO 4750-FIND-LIFE-COMMISSION.
  8212
  8213     MOVE 'A'                    TO  ERCTBL-BEN-TYPE.
  8214
  8215     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8216
  8217     IF ERCTBL-NOT-FOUND
  8218         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8219         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8220         IF ERCTBL-NOT-FOUND
  8221             MOVE -1             TO  AAGENTL
  8222             MOVE ER-2916        TO  EMI-ERROR
  8223             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8224             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8225             GO TO 8200-SEND-DATAONLY.
  8226
  8227     IF PB-ISSUE
  8228         COMPUTE WS-COMM-CK-AMT =
  8229             PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8230         MOVE PB-I-AGE           TO  WS-COMM-AGE
  8231         MOVE PB-I-AH-TERM       TO  WS-COMM-TERM
  8232     ELSE
  8233         COMPUTE WS-COMM-CK-AMT =
  8234             PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8235         MOVE PB-CI-INSURED-AGE  TO  WS-COMM-AGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL642T.cbl
  8236         MOVE PB-CI-AH-TERM      TO  WS-COMM-TERM.
  8237
  8238     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  8239
  8240     MOVE WS-WK-RATE             TO  WS-GA-AH-COM.
  8241
  8242 4750-FIND-LIFE-COMMISSION.
  8243     IF PB-ISSUE
  8244         MOVE PB-I-LF-BENEFIT-CD   TO  CLBENF-CD
  8245     ELSE
  8246         MOVE PB-CI-LF-BENEFIT-CD  TO  CLBENF-CD.
  8247
  8248     IF CLBENF-CD  =  ZEROS  OR  SPACES
  8249         MOVE ZEROS              TO  WS-GA-LF-COM
  8250         GO TO 4790-EXIT.
  8251
  8252     IF PB-ISSUE
  8253         MOVE PB-I-LIFE-INDICATOR  TO  LIFE-INDICATOR
  8254         GO TO 4760-CONT-FIND-LIFE-COMMISSION.
  8255
  8256     PERFORM 6800-READ-BENEFIT-MASTER  THRU  6890-EXIT.
  8257
  8258     IF BENEFIT-MASTER-FOUND
  8259         NEXT SENTENCE
  8260     ELSE
  8261         MOVE -1                 TO  AAGENTL
  8262         MOVE ER-2917            TO  EMI-ERROR
  8263         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8264         PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8265         GO TO 8200-SEND-DATAONLY.
  8266
  8267 4760-CONT-FIND-LIFE-COMMISSION.
  8268     IF JOINT-LIFE NEXT SENTENCE
  8269     ELSE
  8270         GO TO 4770-SINGLE-LIFE-COMMISSION.
  8271
  8272     IF CE-LF-COMP (CE-SUB)  NUMERIC
  8273         MOVE CE-LF-COMP (CE-SUB)  TO  WS-GA-LF-COM
  8274         GO TO 4790-EXIT.
  8275
  8276     MOVE CE-LF-COMPT (CE-SUB)   TO  ERCTBL-TABLE.
  8277
  8278     IF PB-ISSUE
  8279         MOVE PB-I-LF-BENEFIT-CD   TO  ERCTBL-BEN-CODE
  8280     ELSE
  8281         MOVE PB-CI-LF-BENEFIT-CD  TO  ERCTBL-BEN-CODE.
  8282
  8283     MOVE 'J'                    TO  ERCTBL-BEN-TYPE.
  8284
  8285     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8286
  8287     IF ERCTBL-NOT-FOUND
  8288         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8289         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8290         IF ERCTBL-NOT-FOUND
  8291             MOVE -1             TO  AAGENTL
  8292             MOVE ER-2916        TO  EMI-ERROR
  8293             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL642T.cbl
  8294             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8295             GO TO 8200-SEND-DATAONLY.
  8296
  8297     IF PB-ISSUE
  8298         MOVE PB-I-LF-BENEFIT-AMT   TO  WS-COMM-CK-AMT
  8299         MOVE PB-I-AGE              TO  WS-COMM-AGE
  8300         MOVE PB-I-LF-TERM          TO  WS-COMM-TERM
  8301     ELSE
  8302         MOVE PB-CI-INSURED-AGE     TO  WS-COMM-AGE
  8303         MOVE PB-CI-LF-TERM         TO  WS-COMM-TERM
  8304         MOVE PB-CI-LF-BENEFIT-AMT  TO  WS-COMM-CK-AMT.
  8305
  8306     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  8307
  8308     MOVE WS-WK-RATE             TO  WS-GA-LF-COM.
  8309
  8310     GO TO 4790-EXIT.
  8311
  8312 4770-SINGLE-LIFE-COMMISSION.
  8313     IF CE-LF-COMP (CE-SUB)  NUMERIC
  8314         MOVE CE-LF-COMP (CE-SUB)  TO  WS-GA-LF-COM
  8315         GO TO 4790-EXIT.
  8316
  8317     MOVE CE-LF-COMPT (CE-SUB)   TO  ERCTBL-TABLE.
  8318
  8319     IF PB-ISSUE
  8320         MOVE PB-I-LF-BENEFIT-CD   TO  ERCTBL-BEN-CODE
  8321     ELSE
  8322         MOVE PB-CI-LF-BENEFIT-CD  TO  ERCTBL-BEN-CODE.
  8323
  8324     MOVE 'L'                    TO  ERCTBL-BEN-TYPE.
  8325
  8326     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8327
  8328     IF ERCTBL-NOT-FOUND
  8329         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8330         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8331         IF ERCTBL-NOT-FOUND
  8332             MOVE -1             TO  AAGENTL
  8333             MOVE ER-2916        TO  EMI-ERROR
  8334             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8335             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8336             GO TO 8200-SEND-DATAONLY.
  8337
  8338     IF PB-ISSUE
  8339         MOVE PB-I-LF-BENEFIT-AMT   TO  WS-COMM-CK-AMT
  8340         MOVE PB-I-AGE              TO  WS-COMM-AGE
  8341         MOVE PB-I-LF-TERM          TO  WS-COMM-TERM
  8342     ELSE
  8343         MOVE PB-CI-INSURED-AGE     TO  WS-COMM-AGE
  8344         MOVE PB-CI-LF-TERM         TO  WS-COMM-TERM
  8345         MOVE PB-CI-LF-BENEFIT-AMT  TO  WS-COMM-CK-AMT.
  8346
  8347     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  8348
  8349     MOVE WS-WK-RATE             TO  WS-GA-LF-COM.
  8350
  8351 4790-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL642T.cbl
  8352     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL642T.cbl
  8354 4800-PYAJ-END-BROWSE.
  8355
  8356* EXEC CICS ENDBR
  8357*        DATASET  (ERPYAJ-FILE-ID)
  8358*    END-EXEC.
  8359     MOVE 0
  8360       TO DFHEIV11
  8361*    MOVE '&2                    $   #00007991' TO DFHEIV0
  8362     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8363     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8364     MOVE X'2020233030303037393931' TO DFHEIV0(25:11)
  8365     CALL 'kxdfhei1' USING DFHEIV0,
  8366           ERPYAJ-FILE-ID,
  8367           DFHEIV11,
  8368           DFHEIV99
  8369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8370
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL642T.cbl
  8372 4900-GET-COMP-RATE.
  8373     MOVE +1                     TO  COMP-SUB.
  8374
  8375     IF WS-COMM-CK-AMT  GREATER THAN  CT-TBF (1)
  8376         ADD +9                  TO  COMP-SUB
  8377         IF WS-COMM-CK-AMT  GREATER THAN  CT-TBF (2)
  8378             ADD +9              TO  COMP-SUB
  8379             IF WS-COMM-CK-AMT  GREATER THAN  CT-TBF (3)
  8380                 MOVE -1         TO  AAGENTL
  8381                 MOVE ER-2918    TO  EMI-ERROR
  8382                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8383                 PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8384                 GO TO 8200-SEND-DATAONLY.
  8385
  8386     IF WS-COMM-AGE  GREATER THAN  CT-AGE (1)
  8387         ADD +3                  TO  COMP-SUB
  8388         IF WS-COMM-AGE  GREATER THAN  CT-AGE (2)
  8389             ADD +1              TO  COMP-SUB
  8390             IF WS-COMM-AGE  GREATER THAN  CT-AGE (3)
  8391                 MOVE -1         TO  AAGENTL
  8392                 MOVE ER-2918    TO  EMI-ERROR
  8393                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8394                 PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8395                 GO TO 8200-SEND-DATAONLY.
  8396
  8397     IF WS-COMM-TERM  GREATER  CT-TRM (1)
  8398         ADD +1                  TO  COMP-SUB
  8399         IF WS-COMM-TERM  GREATER THAN  CT-TRM (2)
  8400             ADD +1              TO  COMP-SUB
  8401             IF WS-COMM-TERM  GREATER THAN  CT-TRM (3)
  8402                 MOVE -1         TO  AAGENTL
  8403                 MOVE ER-2918    TO  EMI-ERROR
  8404                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8405                 PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8406                 GO TO 8200-SEND-DATAONLY.
  8407
  8408     IF CT-RT (COMP-SUB)  NOT  NUMERIC
  8409         MOVE CT-RT-R (COMP-SUB)  TO  ERCTBL-TABLE
  8410         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8411         GO TO 4900-GET-COMP-RATE.
  8412
  8413     MOVE CT-RT (COMP-SUB)       TO  WS-WK-RATE.
  8414
  8415 4990-EXIT.
  8416     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 174
* EL642T.cbl
  8418 5000-FORMAT-SCREEN.
  8419     MOVE LOW-VALUES             TO  EL642AO.
  8420
  8421     IF PI-SAV-AGENT  GREATER THAN  SPACES
  8422         MOVE PI-SAV-AGENT       TO  AAGENTO
  8423         MOVE PI-SAV-CARR        TO  ACARIERO
  8424         MOVE PI-SAV-GROUP       TO  AGROUPO.
  8425
  8426     MOVE PI-BILL-TYPE           TO  ABILTYPI.
  8427     MOVE AL-UANON               TO  AAGENTA
  8428                                     ACARIERA
  8429                                     AGROUPA
  8430                                     ABILTYPA.
  8431
  8432     IF PI-BILLING-ACCOUNTS (1)  NOT =  SPACES
  8433         MOVE PI-BILLING-ACCOUNTS (1)
  8434                                 TO  AACCT1I
  8435         MOVE AL-UANON           TO  AACCT1A.
  8436
  8437     IF PI-BILLING-ACCOUNTS (2)  NOT =  SPACES
  8438         MOVE PI-BILLING-ACCOUNTS (2)
  8439                                 TO  AACCT2I
  8440         MOVE AL-UANON           TO  AACCT2A.
  8441
  8442     IF PI-BILLING-ACCOUNTS (3)  NOT =  SPACES
  8443         MOVE PI-BILLING-ACCOUNTS (3)
  8444                                 TO  AACCT3I
  8445         MOVE AL-UANON           TO  AACCT3A.
  8446
  8447 5005-FORMAT-STATS.
  8448
  8449     IF PI-CR-FIN-RESP = SPACES
  8450         GO TO 5090-EXIT.
  8451
  8452     MOVE PI-BAL-FRWD            TO  ABEGBALO.
  8453     MOVE PI-UNPAID-NET-PREM     TO  AUPDPRMO.
  8454     MOVE PI-COMP-UNPAID-PREM    TO  AUPDCOMO.
  8455     MOVE PI-ISSUES-BILLED       TO  ABILL1O.
  8456     MOVE PI-ISSUES-INER         TO  AINER1O.
  8457     MOVE PI-ISSUES-PREV         TO  APRVBL1O.
  8458     MOVE PI-CANCELS-BILLED      TO  ABILL2O.
  8459     MOVE PI-CANCELS-INER        TO  AINER2O.
  8460     MOVE PI-CANCELS-PREV        TO  APRVBL2O.
  8461
  8462
  8463     IF PI-UNKNOWN  GREATER THAN  ZEROS
  8464         MOVE ER-2912            TO  EMI-ERROR
  8465         MOVE PI-UNKNOWN         TO  AUNKNERO
  8466         MOVE AL-SABOF           TO  AUNKNERA
  8467         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8468
  8469     MOVE PI-PREMIUM             TO  APREMUMO.
  8470     MOVE PI-REMITTED            TO  AREMITO.
  8471     MOVE PI-TOT-ISS-COMP        TO  ACOMPISO.
  8472     MOVE PI-TOT-CAN-COMP        TO  ACOMCANO.
  8473     MOVE PI-ADJUSTMNTS          TO  AADJUSTO.
  8474     MOVE PI-DISBURSED           TO  ADISBURO.
  8475     MOVE ZERO                   TO  PI-END-BAL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 175
* EL642T.cbl
  8476
  8477     IF PI-SAV-AGENT = PI-SAV-REMIT-TO
  8478         COMPUTE PI-DUE-FOR-ACCT =
  8479             (PI-ACCT-BEG-BAL + PI-ACCT-NET-PREM) -
  8480              (PI-ACCT-COMP + PI-ACCT-PAY-ADJS).
  8481
  8482     COMPUTE PI-END-BAL = PI-BAL-FRWD - PI-TOT-ISS-COMP
  8483                        + PI-TOT-CAN-COMP + PI-ADJUSTMNTS
  8484                        - PI-REMITTED + PI-DISBURSED.
  8485
  8486     MOVE PI-END-BAL             TO  ANETDUEO.
  8487
  8488     IF PI-END-BAL  NEGATIVE
  8489         MOVE OWED-TO-AGENT      TO  AENDHDGO
  8490     ELSE
  8491         IF PI-END-BAL  GREATER THAN  ZERO
  8492             MOVE AGENT-OWES     TO  AENDHDGO
  8493         ELSE
  8494             MOVE 'BALANCE='     TO  AENDHDGO.
  8495
  8496     IF PI-SAV-AGENT = PI-SAV-REMIT-TO
  8497         IF PI-DUE-FOR-ACCT  NOT =  ZERO
  8498             MOVE PI-DUE-FOR-ACCT
  8499                                 TO  AACTDUEO
  8500             IF PI-DUE-FOR-ACCT  NEGATIVE
  8501                 MOVE 'DUE GA ON BEHALF OF ACCOUNTS'
  8502                                 TO  AACTHDGO
  8503             ELSE
  8504                 MOVE 'GA OWES ON BEHALF OF ACCOUNTS'
  8505                                 TO  AACTHDGO.
  8506
  8507 5080-CONT.
  8508     IF RETURNED-FROM  NOT =  SPACES
  8509         IF RETURNED-FROM  NOT =  XCTL-6401
  8510             MOVE ER-2421        TO  EMI-ERROR
  8511             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8512             MOVE ZEROS          TO  EMI-ERROR.
  8513
  8514 5090-EXIT.
  8515     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 176
* EL642T.cbl
  8517 6000-READ-COMP-MASTER.
  8518
  8519* EXEC CICS HANDLE CONDITION
  8520*        NOTFND  (6070-NO-COMP-MSTR)
  8521*    END-EXEC.
  8522*    MOVE '"$I                   ! , #00008141' TO DFHEIV0
  8523     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8524     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8525     MOVE X'2C20233030303038313431' TO DFHEIV0(25:11)
  8526     CALL 'kxdfhei1' USING DFHEIV0
  8527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8528
  8529
  8530     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
  8531
  8532     IF GENERAL-AGENT
  8533         MOVE PI-SAV-CARR        TO  ERCOMP-CARRIER
  8534         MOVE PI-SAV-GROUP       TO  ERCOMP-GROUPING
  8535         MOVE PI-SAV-AGENT       TO  ERCOMP-FIN-RESP
  8536     ELSE
  8537         MOVE PI-COMP-CARRIER    TO  ERCOMP-CARRIER
  8538         MOVE PI-COMP-GROUPING   TO  ERCOMP-GROUPING
  8539         MOVE PI-COMP-FIN-RESP   TO  ERCOMP-FIN-RESP.
  8540
  8541     MOVE ERCOMP-FIN-RESP        TO  PI-CR-FIN-RESP.
  8542
  8543     IF EIBAID  =  DFHPF5  OR  GENERAL-AGENT
  8544         MOVE LOW-VALUES         TO  ERCOMP-ACCT
  8545         MOVE 'G'                TO  ERCOMP-RECORD-TYPE
  8546     ELSE
  8547         MOVE PI-SAV-ACCT-AGT    TO  ERCOMP-ACCT
  8548         MOVE 'A'                TO  ERCOMP-RECORD-TYPE.
  8549
  8550     IF ERCOMP-KEY  =  ERCOMP-PREV-KEY
  8551         GO TO 6090-EXIT.
  8552
  8553     MOVE ERCOMP-KEY             TO  ERCOMP-PREV-KEY.
  8554
  8555
  8556* EXEC CICS READ
  8557*        DATASET  (ERCOMP-FILE-ID)
  8558*        SET      (ADDRESS OF COMPENSATION-MASTER)
  8559*        RIDFLD   (ERCOMP-KEY)
  8560*    END-EXEC.
  8561*    MOVE '&"S        E          (   #00008170' TO DFHEIV0
  8562     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8563     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8564     MOVE X'2020233030303038313730' TO DFHEIV0(25:11)
  8565     CALL 'kxdfhei1' USING DFHEIV0,
  8566           ERCOMP-FILE-ID,
  8567           DFHEIV20,
  8568           DFHEIV99,
  8569           ERCOMP-KEY,
  8570           DFHEIV99,
  8571           DFHEIV99,
  8572           DFHEIV99
  8573     SET ADDRESS OF COMPENSATION-MASTER TO
  8574         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 177
* EL642T.cbl
  8575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8576
  8577
  8578     IF PI-MAP-NAME  =  EL642B
  8579         GO TO 6090-EXIT.
  8580
  8581     IF GENERAL-AGENT
  8582         MOVE CO-CURRENT-END-BAL TO  PI-BAL-FRWD
  8583     ELSE
  8584         IF PI-SAV-AGENT  =  PI-SAV-REMIT-TO
  8585             MOVE CO-CURRENT-END-BAL
  8586                                 TO  WS-ACCT-BEG-BAL
  8587             GO TO 6090-EXIT
  8588         ELSE
  8589             MOVE ZEROS          TO  WS-ACCT-BEG-BAL
  8590             GO TO 6090-EXIT.
  8591
  8592     IF PI-UPDATE-FILES
  8593       OR  (PI-PREVIEW  AND  APRODSWI  =  'Y')
  8594         NEXT SENTENCE
  8595     ELSE
  8596         GO TO 6090-EXIT.
  8597
  8598 6002-FORMAT-ADDRESS-LOOP.
  8599     MOVE CO-ACCT-NAME           TO  PI-AGENT-NAME.
  8600     MOVE CO-MAIL-NAME           TO  WS-AGENT-LINES (1).
  8601     MOVE CO-ACCT-NAME           TO  WS-AGENT-LINES (2).
  8602     MOVE CO-ADDR-1              TO  WS-AGENT-LINES (3).
  8603     MOVE CO-ADDR-2              TO  WS-AGENT-LINES (4).
  8604     MOVE CO-ADDR-3              TO  WS-AGENT-LINES (5).
  8605     MOVE CO-ZIP                 TO  WS-AGENT-LINES (6).
  8606
  8607 6060-FORMAT-ADDRESS-LOOP.
  8608     IF WS-AGENT-ADDR-AREA  =  SPACES
  8609         GO TO 6090-EXIT.
  8610
  8611     IF WS-AGENT-LINES (1)  =  SPACES
  8612         MOVE WS-AGENT-LINES (2)  TO  WS-AGENT-LINES (1)
  8613         MOVE WS-AGENT-LINES (3)  TO  WS-AGENT-LINES (2)
  8614         MOVE WS-AGENT-LINES (4)  TO  WS-AGENT-LINES (3)
  8615         MOVE WS-AGENT-LINES (5)  TO  WS-AGENT-LINES (4)
  8616         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8617         MOVE SPACES              TO  WS-AGENT-LINES (6)
  8618         GO TO 6060-FORMAT-ADDRESS-LOOP.
  8619
  8620     IF WS-AGENT-LINES (2)  =  SPACES
  8621       AND  WS-AGENT-LINES (3)  =  SPACES
  8622       AND  WS-AGENT-LINES (4)  =  SPACES
  8623       AND  WS-AGENT-LINES (5)  =  SPACES
  8624       AND  WS-AGENT-LINES (6)  =  SPACES
  8625         GO TO 6065-MOVE-ZIP.
  8626
  8627     IF WS-AGENT-LINES (2)  =  SPACES
  8628         MOVE WS-AGENT-LINES (3)  TO  WS-AGENT-LINES (2)
  8629         MOVE WS-AGENT-LINES (4)  TO  WS-AGENT-LINES (3)
  8630         MOVE WS-AGENT-LINES (5)  TO  WS-AGENT-LINES (4)
  8631         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8632         MOVE SPACES              TO  WS-AGENT-LINES (6)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 178
* EL642T.cbl
  8633         GO TO 6060-FORMAT-ADDRESS-LOOP.
  8634
  8635     IF WS-AGENT-LINES (3)  =  SPACES
  8636       AND  WS-AGENT-LINES (4)  =  SPACES
  8637       AND  WS-AGENT-LINES (5)  =  SPACES
  8638       AND  WS-AGENT-LINES (6)  =  SPACES
  8639         GO TO 6065-MOVE-ZIP.
  8640
  8641     IF WS-AGENT-LINES (3)  =  SPACES
  8642         MOVE WS-AGENT-LINES (4)  TO  WS-AGENT-LINES (3)
  8643         MOVE WS-AGENT-LINES (5)  TO  WS-AGENT-LINES (4)
  8644         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8645         MOVE SPACES              TO  WS-AGENT-LINES (6)
  8646         GO TO 6060-FORMAT-ADDRESS-LOOP.
  8647
  8648     IF WS-AGENT-LINES (4)  =  SPACES
  8649       AND  WS-AGENT-LINES (5)  =  SPACES
  8650       AND  WS-AGENT-LINES (6)  =  SPACES
  8651         GO TO 6065-MOVE-ZIP.
  8652
  8653     IF WS-AGENT-LINES (4)  =  SPACES
  8654         MOVE WS-AGENT-LINES (5)  TO  WS-AGENT-LINES (4)
  8655         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8656         MOVE SPACES              TO  WS-AGENT-LINES (6)
  8657         GO TO 6060-FORMAT-ADDRESS-LOOP.
  8658
  8659     IF WS-AGENT-LINES (5)  =  SPACES
  8660         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8661         MOVE SPACES              TO  WS-AGENT-LINES (6).
  8662
  8663 6065-MOVE-ZIP.
  8664
  8665     IF WS-AGENT-LINES (6) NOT =  SPACES
  8666         IF CO-CANADIAN-POST-CODE
  8667                 OR
  8668            WS-AGENT-1ST-ZIP (6)  NOT =  ZEROS
  8669             MOVE WS-AGENT-ZIP (6)
  8670                                 TO  WS-A-LAST-ZIP (5)
  8671             MOVE SPACES         TO  WS-AGENT-LINES (6)
  8672         ELSE
  8673             MOVE WS-AGENT-2ND-ZIP (5)
  8674                                 TO  WS-A-LAST-2ND-ZIP (4)
  8675             MOVE SPACES         TO  WS-AGENT-LINES (5)
  8676     ELSE
  8677         IF WS-AGENT-LINES (5) NOT =  SPACES
  8678             IF CO-CANADIAN-POST-CODE
  8679                     OR
  8680                WS-AGENT-1ST-ZIP (5)  NOT =  ZEROS
  8681                 MOVE WS-AGENT-ZIP (5)
  8682                                 TO  WS-A-LAST-ZIP (5)
  8683                 MOVE SPACES     TO  WS-AGENT-ZIP (5)
  8684             ELSE
  8685                 MOVE WS-AGENT-2ND-ZIP (5)
  8686                                 TO  WS-A-LAST-2ND-ZIP (5)
  8687                 MOVE SPACES     TO  WS-AGENT-ZIP (5)
  8688         ELSE
  8689             IF WS-AGENT-LINES (4) NOT =  SPACES
  8690                 IF CO-CANADIAN-POST-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 179
* EL642T.cbl
  8691                         OR
  8692                    WS-AGENT-1ST-ZIP (4)  NOT =  ZEROS
  8693                     MOVE WS-AGENT-ZIP (4)
  8694                                 TO  WS-A-LAST-ZIP (4)
  8695                     MOVE SPACES TO  WS-AGENT-ZIP (4)
  8696                 ELSE
  8697                     MOVE WS-AGENT-2ND-ZIP (4)
  8698                                 TO  WS-A-LAST-2ND-ZIP (4)
  8699                     MOVE SPACES TO  WS-AGENT-ZIP (4).
  8700
  8701     MOVE 'GA'                   TO  BILLING-DETAIL-TYPE.
  8702
  8703     PERFORM 3000-WRITE-BILLING-DETAIL  THRU  3990-EXIT.
  8704
  8705     GO TO 6090-EXIT.
  8706
  8707 6070-NO-COMP-MSTR.
  8708     IF GENERAL-AGENT
  8709         MOVE -1                 TO  AAGENTL
  8710         MOVE ER-2230            TO  EMI-ERROR
  8711         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8712         GO TO 8200-SEND-DATAONLY.
  8713
  8714     MOVE ZEROS                  TO  WS-ACCT-BEG-BAL.
  8715
  8716     GO TO 6090-EXIT.
  8717
  8718 6090-EXIT.
  8719     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 180
* EL642T.cbl
  8721 6100-READ-CONTROL-FILE.
  8722     MOVE PI-COMPANY-ID          TO  ELCNTL-COMPANY-ID.
  8723     MOVE +0                     TO  ELCNTL-SEQ-NO.
  8724
  8725
  8726* EXEC CICS HANDLE CONDITION
  8727*        NOTFND  (6110-NO-RECORD)
  8728*    END-EXEC.
  8729*    MOVE '"$I                   ! - #00008323' TO DFHEIV0
  8730     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8731     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8732     MOVE X'2D20233030303038333233' TO DFHEIV0(25:11)
  8733     CALL 'kxdfhei1' USING DFHEIV0
  8734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8735
  8736
  8737     IF NOT  ELCNTL-UPDATE
  8738
  8739* EXEC CICS READ
  8740*            DATASET  (ELCNTL-FILE-ID)
  8741*            SET      (ADDRESS OF CONTROL-FILE)
  8742*            RIDFLD   (ELCNTL-KEY)
  8743*        END-EXEC
  8744*    MOVE '&"S        E          (   #00008328' TO DFHEIV0
  8745     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8746     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8747     MOVE X'2020233030303038333238' TO DFHEIV0(25:11)
  8748     CALL 'kxdfhei1' USING DFHEIV0,
  8749           ELCNTL-FILE-ID,
  8750           DFHEIV20,
  8751           DFHEIV99,
  8752           ELCNTL-KEY,
  8753           DFHEIV99,
  8754           DFHEIV99,
  8755           DFHEIV99
  8756     SET ADDRESS OF CONTROL-FILE TO
  8757         DFHEIV20
  8758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8759     ELSE
  8760         MOVE SPACE              TO  ELCNTL-UPDATE-SW
  8761
  8762* EXEC CICS READ
  8763*            DATASET  (ELCNTL-FILE-ID)
  8764*            SET      (ADDRESS OF CONTROL-FILE)
  8765*            RIDFLD   (ELCNTL-KEY)
  8766*            UPDATE
  8767*        END-EXEC.
  8768*    MOVE '&"S        EU         (   #00008335' TO DFHEIV0
  8769     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8770     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8771     MOVE X'2020233030303038333335' TO DFHEIV0(25:11)
  8772     CALL 'kxdfhei1' USING DFHEIV0,
  8773           ELCNTL-FILE-ID,
  8774           DFHEIV20,
  8775           DFHEIV99,
  8776           ELCNTL-KEY,
  8777           DFHEIV99,
  8778           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 181
* EL642T.cbl
  8779           DFHEIV99
  8780     SET ADDRESS OF CONTROL-FILE TO
  8781         DFHEIV20
  8782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8783
  8784
  8785     GO TO 6190-EXIT.
  8786
  8787 6110-NO-RECORD.
  8788     IF ELCNTL-REC-TYPE  =  1
  8789         MOVE ER-0022            TO  EMI-ERROR
  8790     ELSE
  8791         MOVE ER-2208            TO  EMI-ERROR
  8792         MOVE -1                 TO  ACARIERL
  8793         MOVE AL-UABON           TO  ACARIERA
  8794
  8795     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8796
  8797 6190-EXIT.
  8798     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 182
* EL642T.cbl
  8800 6200-REWRITE-CONTROL-FILE.
  8801     MOVE 'C'                    TO  JP-RECORD-TYPE.
  8802     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  8803     MOVE ELCNTL-FILE-ID         TO  JP-FILE-ID.
  8804
  8805     COMPUTE JOURNAL-LENGTH = ELCNTL-LENGTH + 23.
  8806
  8807
  8808* EXEC CICS REWRITE
  8809*        DATASET  (ELCNTL-FILE-ID)
  8810*        FROM     (CONTROL-FILE)
  8811*    END-EXEC.
  8812     MOVE LENGTH OF
  8813      CONTROL-FILE
  8814       TO DFHEIV11
  8815*    MOVE '&& L                  %   #00008364' TO DFHEIV0
  8816     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8817     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8818     MOVE X'2020233030303038333634' TO DFHEIV0(25:11)
  8819     CALL 'kxdfhei1' USING DFHEIV0,
  8820           ELCNTL-FILE-ID,
  8821           CONTROL-FILE,
  8822           DFHEIV11,
  8823           DFHEIV99
  8824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8825
  8826
  8827     PERFORM 8400-LOG-JOURNAL-RECORD.
  8828
  8829 6290-EXIT.
  8830     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 183
* EL642T.cbl
  8832 6400-READ-CROSS-REFERENCE.
  8833     MOVE PI-COMPANY-CD          TO  ERGXRF-COMPANY-CD.
  8834     MOVE PI-SAV-AGENT           TO  ERGXRF-AGENT-NO.
  8835
  8836     IF NOT  PI-ZERO-CARRIER
  8837       AND  NOT  PI-ZERO-CAR-GROUP
  8838         MOVE PI-CR-CARRIER      TO  ERGXRF-CARRIER
  8839     ELSE
  8840         MOVE ZEROS              TO  ERGXRF-CARRIER.
  8841
  8842     IF NOT  PI-ZERO-GROUPING
  8843       AND  NOT  PI-ZERO-CAR-GROUP
  8844         MOVE PI-CR-GROUPING     TO  ERGXRF-GROUPING
  8845     ELSE
  8846         MOVE ZEROS              TO  ERGXRF-GROUPING.
  8847
  8848
  8849* EXEC CICS HANDLE CONDITION
  8850*        NOTFND  (6410-NOT-FOUND)
  8851*    END-EXEC.
  8852*    MOVE '"$I                   ! . #00008390' TO DFHEIV0
  8853     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8854     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8855     MOVE X'2E20233030303038333930' TO DFHEIV0(25:11)
  8856     CALL 'kxdfhei1' USING DFHEIV0
  8857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8858
  8859
  8860
  8861* EXEC CICS READ
  8862*        SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  8863*        DATASET  (ERGXRF-FILE-ID)
  8864*        RIDFLD   (ERGXRF-KEY)
  8865*        LENGTH   (ERGXRF-LENGTH)
  8866*        UPDATE
  8867*    END-EXEC.
  8868*    MOVE '&"SL       EU         (   #00008394' TO DFHEIV0
  8869     MOVE X'2622534C2020202020202045' TO DFHEIV0(1:12)
  8870     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8871     MOVE X'2020233030303038333934' TO DFHEIV0(25:11)
  8872     CALL 'kxdfhei1' USING DFHEIV0,
  8873           ERGXRF-FILE-ID,
  8874           DFHEIV20,
  8875           ERGXRF-LENGTH,
  8876           ERGXRF-KEY,
  8877           DFHEIV99,
  8878           DFHEIV99,
  8879           DFHEIV99
  8880     SET ADDRESS OF AGENT-CROSS-REFERENCE TO
  8881         DFHEIV20
  8882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8883
  8884
  8885     MOVE GX-AGENT-POINTER-CNT   TO  GX-AGENT-POINTER-CNT.
  8886
  8887     IF PI-UPDATE-FILES
  8888         MOVE 'B'                TO  JP-RECORD-TYPE
  8889         MOVE AGENT-CROSS-REFERENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 184
* EL642T.cbl
  8890                                 TO  JP-RECORD-AREA
  8891         MOVE ERGXRF-FILE-ID     TO  JP-FILE-ID
  8892         COMPUTE JOURNAL-LENGTH = ERGXRF-LENGTH + 23
  8893         PERFORM 8400-LOG-JOURNAL-RECORD.
  8894
  8895     GO TO 6490-EXIT.
  8896
  8897 6410-NOT-FOUND.
  8898     MOVE -1                     TO  AAGENTL.
  8899     MOVE ER-2911                TO  EMI-ERROR.
  8900
  8901     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8902
  8903     GO TO 8200-SEND-DATAONLY.
  8904
  8905 6490-EXIT.
  8906     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 185
* EL642T.cbl
  8908 6500-REWRITE-CROSS-REFERENCE.
  8909     MOVE 'C'                    TO  JP-RECORD-TYPE.
  8910     MOVE AGENT-CROSS-REFERENCE  TO  JP-RECORD-AREA.
  8911     MOVE ERGXRF-FILE-ID         TO  JP-FILE-ID.
  8912
  8913
  8914* EXEC CICS REWRITE
  8915*        DATASET  (ERGXRF-FILE-ID)
  8916*        FROM     (AGENT-CROSS-REFERENCE)
  8917*        LENGTH   (ERGXRF-LENGTH)
  8918*    END-EXEC.
  8919*    MOVE '&& L                  %   #00008430' TO DFHEIV0
  8920     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8921     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8922     MOVE X'2020233030303038343330' TO DFHEIV0(25:11)
  8923     CALL 'kxdfhei1' USING DFHEIV0,
  8924           ERGXRF-FILE-ID,
  8925           AGENT-CROSS-REFERENCE,
  8926           ERGXRF-LENGTH,
  8927           DFHEIV99
  8928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8929
  8930
  8931     PERFORM 8400-LOG-JOURNAL-RECORD.
  8932
  8933 6590-EXIT.
  8934     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 186
* EL642T.cbl
  8936 6600-READ-COMMISSION-EXCEPTION.
  8937
  8938* EXEC CICS HANDLE CONDITION
  8939*        NOTFND  (6610-NOT-FOUND)
  8940*    END-EXEC.
  8941*    MOVE '"$I                   ! / #00008442' TO DFHEIV0
  8942     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8943     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8944     MOVE X'2F20233030303038343432' TO DFHEIV0(25:11)
  8945     CALL 'kxdfhei1' USING DFHEIV0
  8946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8947
  8948
  8949     MOVE 'Y'                    TO ERCOMM-FOUND-SW.
  8950     MOVE PB-CONTROL-BY-ACCOUNT  TO  ERCOMM-KEY.
  8951     MOVE PB-SV-CARRIER          TO  ERCOMM-CARRIER.
  8952     MOVE PB-SV-GROUPING         TO  ERCOMM-GROUPING.
  8953     MOVE PB-SV-STATE            TO  ERCOMM-STATE.
  8954
  8955
  8956* EXEC CICS READ
  8957*        SET      (ADDRESS OF COMMISSION-EXCEPTIONS)
  8958*        DATASET  (ERCOMM-FILE-ID)
  8959*        RIDFLD   (ERCOMM-KEY)
  8960*    END-EXEC.
  8961*    MOVE '&"S        E          (   #00008452' TO DFHEIV0
  8962     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8963     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8964     MOVE X'2020233030303038343532' TO DFHEIV0(25:11)
  8965     CALL 'kxdfhei1' USING DFHEIV0,
  8966           ERCOMM-FILE-ID,
  8967           DFHEIV20,
  8968           DFHEIV99,
  8969           ERCOMM-KEY,
  8970           DFHEIV99,
  8971           DFHEIV99,
  8972           DFHEIV99
  8973     SET ADDRESS OF COMMISSION-EXCEPTIONS TO
  8974         DFHEIV20
  8975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8976
  8977
  8978     GO TO 6620-EXIT.
  8979
  8980 6610-NOT-FOUND.
  8981     MOVE 'N'                    TO  ERCOMM-FOUND-SW.
  8982
  8983 6620-EXIT.
  8984     EXIT.
  8985
  8986**START***********************************************************
  8987*      CUSTOM CODING FOR CLIENT "DMD"
  8988******************************************************************
  8989*
  8990 6650-GET-RES-STATE-COMM.
  8991*6650-BROWSE-FORWARD.
  8992
  8993     IF PB-COMPANY-ID NOT = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 187
* EL642T.cbl
  8994         GO TO 6700-COMM-EXIT.
  8995
  8996     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
  8997     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
  8998     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
  8999     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
  9000     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
  9001     MOVE AM-AGT (WS-GA-LEVEL) TO WS-ERRESC-AGENT.
  9002     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
  9003
  9004*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
  9005*
  9006     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
  9007     SET BIN-TO-GREG          TO TRUE.
  9008     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9009
  9010     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
  9011
  9012     IF DC-GREG-DATE-1-YMD (1:2) IS LESS THAN '10'
  9013         MOVE '20'            TO WS-CONTRACT-DATE (1:2)
  9014     ELSE
  9015         MOVE '19'            TO WS-CONTRACT-DATE (1:2).
  9016
  9017     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
  9018
  9019
  9020* EXEC CICS HANDLE CONDITION
  9021*        INVREQ    (6660-START-BROWSE)
  9022*        NOTFND    (6700-COMM-EXIT)
  9023*    END-EXEC.
  9024*    MOVE '"$8I                  ! 0 #00008499' TO DFHEIV0
  9025     MOVE X'222438492020202020202020' TO DFHEIV0(1:12)
  9026     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9027     MOVE X'3020233030303038343939' TO DFHEIV0(25:11)
  9028     CALL 'kxdfhei1' USING DFHEIV0
  9029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9030
  9031
  9032
  9033* EXEC CICS RESETBR
  9034*        DATASET (ERRESC-FILE-ID)
  9035*        RIDFLD  (WS-ERRESC-KEY)
  9036*    END-EXEC.
  9037     MOVE 0
  9038       TO DFHEIV11
  9039*    MOVE '&4         G          &   #00008504' TO DFHEIV0
  9040     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
  9041     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9042     MOVE X'2020233030303038353034' TO DFHEIV0(25:11)
  9043     CALL 'kxdfhei1' USING DFHEIV0,
  9044           ERRESC-FILE-ID,
  9045           WS-ERRESC-KEY,
  9046           DFHEIV99,
  9047           DFHEIV11,
  9048           DFHEIV99
  9049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9050
  9051
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 188
* EL642T.cbl
  9052 6660-START-BROWSE.
  9053
  9054
  9055* EXEC CICS HANDLE CONDITION
  9056*        NOTFND    (6700-COMM-EXIT)
  9057*        ENDFILE   (6700-COMM-EXIT)
  9058*    END-EXEC.
  9059*    MOVE '"$I''                  ! 1 #00008511' TO DFHEIV0
  9060     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9061     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9062     MOVE X'3120233030303038353131' TO DFHEIV0(25:11)
  9063     CALL 'kxdfhei1' USING DFHEIV0
  9064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9065
  9066
  9067
  9068* EXEC CICS STARTBR
  9069*        DATASET (ERRESC-FILE-ID)
  9070*        RIDFLD  (WS-ERRESC-KEY)
  9071*        GTEQ
  9072*    END-EXEC.
  9073     MOVE 0
  9074       TO DFHEIV11
  9075*    MOVE '&,         G          &   #00008516' TO DFHEIV0
  9076     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9077     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9078     MOVE X'2020233030303038353136' TO DFHEIV0(25:11)
  9079     CALL 'kxdfhei1' USING DFHEIV0,
  9080           ERRESC-FILE-ID,
  9081           WS-ERRESC-KEY,
  9082           DFHEIV99,
  9083           DFHEIV11,
  9084           DFHEIV99
  9085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9086
  9087
  9088     MOVE WS-ERRESC-KEY           TO WS-SV-ERRESC-KEY.
  9089
  9090 6670-READ-NEXT-ERRESC-MASTER.
  9091
  9092
  9093* EXEC CICS HANDLE CONDITION
  9094*        NOTFND    (6700-COMM-EXIT)
  9095*        ENDFILE   (6700-COMM-EXIT)
  9096*    END-EXEC.
  9097*    MOVE '"$I''                  ! 2 #00008526' TO DFHEIV0
  9098     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9099     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9100     MOVE X'3220233030303038353236' TO DFHEIV0(25:11)
  9101     CALL 'kxdfhei1' USING DFHEIV0
  9102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9103
  9104
  9105
  9106* EXEC CICS READNEXT
  9107*        SET      (ADDRESS OF ACCOUNT-RESIDENT-ST-COMMISSION)
  9108*        DATASET (ERRESC-FILE-ID)
  9109*        RIDFLD  (WS-ERRESC-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 189
* EL642T.cbl
  9110*    END-EXEC.
  9111     MOVE 0
  9112       TO DFHEIV11
  9113*    MOVE '&.S                   )   #00008531' TO DFHEIV0
  9114     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9115     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9116     MOVE X'2020233030303038353331' TO DFHEIV0(25:11)
  9117     CALL 'kxdfhei1' USING DFHEIV0,
  9118           ERRESC-FILE-ID,
  9119           DFHEIV20,
  9120           DFHEIV99,
  9121           WS-ERRESC-KEY,
  9122           DFHEIV99,
  9123           DFHEIV11,
  9124           DFHEIV99,
  9125           DFHEIV99
  9126     SET ADDRESS OF ACCOUNT-RESIDENT-ST-COMMISSION TO
  9127         DFHEIV20
  9128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9129
  9130
  9131     IF ERRESC-RECORD-KEY (1:32) = WS-SV-ERRESC-KEY
  9132        NEXT SENTENCE
  9133     ELSE
  9134
  9135* EXEC CICS ENDBR
  9136*            DATASET (ERRESC-FILE-ID)
  9137*       END-EXEC
  9138     MOVE 0
  9139       TO DFHEIV11
  9140*    MOVE '&2                    $   #00008540' TO DFHEIV0
  9141     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9142     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9143     MOVE X'2020233030303038353430' TO DFHEIV0(25:11)
  9144     CALL 'kxdfhei1' USING DFHEIV0,
  9145           ERRESC-FILE-ID,
  9146           DFHEIV11,
  9147           DFHEIV99
  9148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9149        GO TO 6700-COMM-EXIT.
  9150
  9151* CHECK IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT RESIDENT
  9152* STATE COMMISSIONS RECORD'S EFFECT TIME PERIOD????
  9153     IF WS-CONTRACT-DATE IS LESS THAN RESC-EFFECTIVE-DATE
  9154
  9155* EXEC CICS ENDBR
  9156*            DATASET (ERRESC-FILE-ID)
  9157*       END-EXEC
  9158     MOVE 0
  9159       TO DFHEIV11
  9160*    MOVE '&2                    $   #00008548' TO DFHEIV0
  9161     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9162     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9163     MOVE X'2020233030303038353438' TO DFHEIV0(25:11)
  9164     CALL 'kxdfhei1' USING DFHEIV0,
  9165           ERRESC-FILE-ID,
  9166           DFHEIV11,
  9167           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 190
* EL642T.cbl
  9168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9169        GO TO 6700-COMM-EXIT.
  9170
  9171* SEARCH FOR MATCHING CATEGORY CODE ENTRY
  9172*
  9173*    IF RESC-COMMISSION IS NUMERIC THAT IS THE COMMISSION TO OVER-
  9174*    RIDE AH OR LIFE COMMISSION IN IN THE ACCOUNT MASTER.
  9175*    IF RESC-COMMISSION NOT NUMERIC, USE VALUE TO GET COMMISSION
  9176*    FROM COMMISSION TABLE IF RECORD EXISTS.
  9177*
  9178     MOVE ZEROS               TO WS-SUB WS-SUB1.
  9179
  9180     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
  9181
  9182     IF WS-SUB1 IS GREATER THAN ZERO
  9183         IF RESC-COMMISSION-TAB (WS-SUB) NUMERIC
  9184             PERFORM 6680-SET-COMMISSION
  9185         ELSE
  9186             PERFORM 6680-SET-TABLE-CODE.
  9187
  9188
  9189* EXEC CICS ENDBR
  9190*         DATASET (ERRESC-FILE-ID)
  9191*    END-EXEC.
  9192     MOVE 0
  9193       TO DFHEIV11
  9194*    MOVE '&2                    $   #00008570' TO DFHEIV0
  9195     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9196     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9197     MOVE X'2020233030303038353730' TO DFHEIV0(25:11)
  9198     CALL 'kxdfhei1' USING DFHEIV0,
  9199           ERRESC-FILE-ID,
  9200           DFHEIV11,
  9201           DFHEIV99
  9202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9203
  9204
  9205     GO TO 6700-COMM-EXIT.
  9206
  9207 6680-SET-TABLE-CODE.
  9208     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
  9209        MOVE ZEROS             TO WS-SUB1
  9210     ELSE
  9211
  9212* READ COMMISSION TABLE(CTBL)  KEY VALUES PRESET IN CALLING
  9213* PARAGRAPHS(4405-FIND-AH, 4420-CONT-FIND-LIFE, 4430-SINGLE-LIFE)
  9214
  9215     MOVE RESC-COMMISSION-TAB (WS-SUB) TO ERCTBL-TABLE
  9216     PERFORM 6680-READ-CTBL-TABLE.
  9217
  9218 6680-READ-CTBL-TABLE.
  9219*
  9220* READ COMMISSION TABLE TO VERIFY IF ACCOUNT RESIDENT STATE
  9221* COMMISSION RECORD CONTAINS A VALID COMPENSATION TABLE CODE.
  9222* IF CODE IS NOT VALID USE CODE IN ACCOUNT MASTER
  9223
  9224     PERFORM 6700-READ-COMMISSION-TABLE THRU 6790-EXIT.
  9225
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 191
* EL642T.cbl
  9226     IF ERCTBL-NOT-FOUND
  9227         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  9228         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  9229         IF ERCTBL-NOT-FOUND
  9230             MOVE ZEROS          TO  WS-SUB1.
  9231
  9232     IF ERCTBL-FOUND
  9233        IF AH-COMM
  9234            PERFORM 6680-AH-GET-COMP-RATE
  9235        ELSE
  9236            PERFORM 6680-LF-GET-COMP-RATE.
  9237
  9238 6680-AH-GET-COMP-RATE.
  9239     IF PB-ISSUE
  9240         COMPUTE WS-COMM-CK-AMT =
  9241             PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  9242         MOVE PB-I-AGE           TO  WS-COMM-AGE
  9243         MOVE PB-I-AH-TERM       TO  WS-COMM-TERM
  9244     ELSE
  9245         COMPUTE WS-COMM-CK-AMT =
  9246             PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  9247         MOVE PB-CI-INSURED-AGE  TO  WS-COMM-AGE
  9248         MOVE PB-CI-AH-TERM      TO  WS-COMM-TERM.
  9249
  9250     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  9251
  9252     MOVE WS-WK-RATE             TO  WS-GA-AH-COM.
  9253
  9254 6680-LF-GET-COMP-RATE.
  9255     IF PB-ISSUE
  9256         MOVE PB-I-LF-BENEFIT-AMT
  9257                                 TO  WS-COMM-CK-AMT
  9258         MOVE PB-I-AGE           TO  WS-COMM-AGE
  9259         MOVE PB-I-LF-TERM       TO  WS-COMM-TERM
  9260     ELSE
  9261         MOVE PB-CI-INSURED-AGE  TO  WS-COMM-AGE
  9262         MOVE PB-CI-LF-TERM      TO  WS-COMM-TERM
  9263         MOVE PB-CI-LF-BENEFIT-AMT
  9264                                 TO  WS-COMM-CK-AMT.
  9265
  9266     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  9267
  9268     MOVE WS-WK-RATE             TO  WS-GA-LF-COM.
  9269
  9270 6680-SET-COMMISSION.
  9271     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
  9272           MOVE ZEROS          TO WS-SUB1
  9273       ELSE
  9274           MOVE RESC-COMMISSION-PER (WS-SUB)
  9275                              TO WS-COMMISSION
  9276           IF AH-COMM
  9277              MOVE WS-COMMISSION TO WS-GA-AH-COM
  9278           ELSE
  9279              MOVE WS-COMMISSION TO WS-GA-LF-COM.
  9280
  9281 6680-SEARCH-CATEGORY.
  9282     ADD +1 TO WS-SUB.
  9283     IF WS-SUB IS GREATER THAN +12
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 192
* EL642T.cbl
  9284         GO TO 6680-EXIT.
  9285
  9286     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
  9287          MOVE WS-SUB         TO WS-SUB1
  9288          GO TO 6680-EXIT.
  9289
  9290     GO TO 6680-SEARCH-CATEGORY.
  9291
  9292 6680-EXIT.
  9293     EXIT.
  9294
  9295 6700-COMM-EXIT.
  9296     EXIT.
  9297**END*************************************************************
  9298*      CUSTOM CODING FOR CLIENT "DMD"
  9299******************************************************************
  9300*
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 193
* EL642T.cbl
  9302 6700-READ-COMMISSION-TABLE.
  9303
  9304* EXEC CICS HANDLE CONDITION
  9305*        NOTFND  (6710-NOT-FOUND)
  9306*    END-EXEC.
  9307*    MOVE '"$I                   ! 3 #00008672' TO DFHEIV0
  9308     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9309     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9310     MOVE X'3320233030303038363732' TO DFHEIV0(25:11)
  9311     CALL 'kxdfhei1' USING DFHEIV0
  9312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9313
  9314
  9315     MOVE 'Y'                    TO  ERCTBL-FOUND-SW.
  9316
  9317
  9318* EXEC CICS READ
  9319*        SET      (ADDRESS OF COMM-TABLE-RECORD)
  9320*        DATASET  (ERCTBL-FILE-ID)
  9321*        RIDFLD   (ERCTBL-KEY)
  9322*    END-EXEC.
  9323*    MOVE '&"S        E          (   #00008678' TO DFHEIV0
  9324     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9325     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9326     MOVE X'2020233030303038363738' TO DFHEIV0(25:11)
  9327     CALL 'kxdfhei1' USING DFHEIV0,
  9328           ERCTBL-FILE-ID,
  9329           DFHEIV20,
  9330           DFHEIV99,
  9331           ERCTBL-KEY,
  9332           DFHEIV99,
  9333           DFHEIV99,
  9334           DFHEIV99
  9335     SET ADDRESS OF COMM-TABLE-RECORD TO
  9336         DFHEIV20
  9337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9338
  9339
  9340     GO TO 6790-EXIT.
  9341
  9342 6710-NOT-FOUND.
  9343     MOVE 'N'                    TO  ERCTBL-FOUND-SW.
  9344
  9345 6790-EXIT.
  9346     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 194
* EL642T.cbl
  9348 6800-READ-BENEFIT-MASTER.
  9349
  9350* EXEC CICS HANDLE CONDITION
  9351*        NOTFND  (6880-NOT-FOUND)
  9352*    END-EXEC.
  9353*    MOVE '"$I                   ! 4 #00008693' TO DFHEIV0
  9354     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9355     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9356     MOVE X'3420233030303038363933' TO DFHEIV0(25:11)
  9357     CALL 'kxdfhei1' USING DFHEIV0
  9358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9359
  9360
  9361     MOVE 'Y'                    TO  BENEFIT-MASTER-FOUND-SW.
  9362     MOVE PB-COMPANY-ID          TO  CLBENF-COMPANY-ID.
  9363     MOVE '4'                    TO  CLBENF-REC-TYPE.
  9364     MOVE +0                     TO  CLBENF-SEQ-NO.
  9365
  9366
  9367* EXEC CICS READ
  9368*        SET      (ADDRESS OF CONTROL-FILE)
  9369*        DATASET  (ELCNTL-FILE-ID)
  9370*        RIDFLD   (ELCNTL-BENEFIT-KEY)
  9371*        GTEQ
  9372*    END-EXEC.
  9373*    MOVE '&"S        G          (   #00008702' TO DFHEIV0
  9374     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9375     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9376     MOVE X'2020233030303038373032' TO DFHEIV0(25:11)
  9377     CALL 'kxdfhei1' USING DFHEIV0,
  9378           ELCNTL-FILE-ID,
  9379           DFHEIV20,
  9380           DFHEIV99,
  9381           ELCNTL-BENEFIT-KEY,
  9382           DFHEIV99,
  9383           DFHEIV99,
  9384           DFHEIV99
  9385     SET ADDRESS OF CONTROL-FILE TO
  9386         DFHEIV20
  9387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9388
  9389
  9390     IF CLBENF-COMPANY-ID  NOT =  CF-COMPANY-ID
  9391         GO TO 6880-NOT-FOUND.
  9392
  9393     IF CLBENF-REC-TYPE  NOT =  CF-RECORD-TYPE
  9394         GO TO 6880-NOT-FOUND.
  9395
  9396     MOVE +0                     TO  BEN-SUB.
  9397
  9398 6810-FIND-BENEFIT.
  9399     ADD +1                      TO  BEN-SUB.
  9400
  9401     IF BEN-SUB  GREATER THAN  +8
  9402         GO TO 6880-NOT-FOUND.
  9403
  9404     IF CF-BENEFIT-CODE (BEN-SUB)  =  CLBENF-CD
  9405         MOVE CF-JOINT-INDICATOR (BEN-SUB)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 195
* EL642T.cbl
  9406                                 TO  LIFE-INDICATOR
  9407         GO TO 6890-EXIT.
  9408
  9409     GO TO 6810-FIND-BENEFIT.
  9410
  9411 6880-NOT-FOUND.
  9412     MOVE 'N'                    TO  BENEFIT-MASTER-FOUND-SW.
  9413
  9414 6890-EXIT.
  9415     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 196
* EL642T.cbl
  9417 7000-PROCESS-CHECK.
  9418     MOVE LOW-VALUES             TO  EL642BO.
  9419
  9420     MOVE 'G'                    TO  COMPENSATION-SW
  9421                                     PI-CR-TYPE.
  9422
  9423     PERFORM 6000-READ-COMP-MASTER  THRU  6090-EXIT.
  9424
  9425     IF EMI-ERROR = ZEROS
  9426         MOVE CO-MAIL-NAME       TO  BNAMEO
  9427         MOVE CO-ADDR-1          TO  BADDR1O
  9428         MOVE CO-ADDR-2          TO  BADDR2O
  9429         MOVE CO-ADDR-3          TO  BCITYSTO
  9430         MOVE CO-ZIP             TO  BZIPO
  9431     ELSE
  9432         MOVE EL642A             TO  PI-MAP-NAME
  9433         MOVE -1                 TO  BPFNTERL
  9434         GO TO 8200-SEND-DATAONLY.
  9435
  9436     IF PI-COMP-UNPAID-PREM  GREATER THAN  ZERO
  9437         MOVE PI-COMP-UNPAID-PREM
  9438                                 TO BCHKAMTO
  9439     ELSE
  9440         MOVE ZEROS              TO  BCHKAMTO.
  9441
  9442     MOVE AL-UNNON               TO  BCHKAMTA.
  9443     MOVE WS-CURRENT-DATE-EDIT   TO  BPAYDT1O.
  9444     MOVE -1                     TO  BCHKNOL.
  9445
  9446     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 197
* EL642T.cbl
  9448 7500-PRODUCE-CHECK.
  9449     MOVE SPACES                 TO  ELCNTL-KEY.
  9450     MOVE '1'                    TO  ELCNTL-REC-TYPE.
  9451     MOVE 'Y'                    TO  ELCNTL-UPDATE-SW.
  9452
  9453     PERFORM 6100-READ-CONTROL-FILE  THRU  6190-EXIT.
  9454
  9455     IF EMI-ERROR  NOT =  ZEROS
  9456         GO TO 8200-SEND-DATAONLY.
  9457
  9458     IF CR-CHECK-NO-AUTO-SEQ
  9459         MOVE 'B'                TO  JP-RECORD-TYPE
  9460         MOVE CONTROL-FILE       TO  JP-RECORD-AREA
  9461         MOVE ELCNTL-FILE-ID     TO  JP-FILE-ID
  9462         COMPUTE JOURNAL-LENGTH = ELCNTL-LENGTH + 23
  9463         PERFORM 8400-LOG-JOURNAL-RECORD
  9464         IF CR-CHECK-CNT-RESET-VALUE
  9465             MOVE CF-CR-CHECK-COUNTER
  9466                                 TO  BCHKNOI
  9467             MOVE +1             TO  CF-CR-CHECK-COUNTER
  9468             MOVE 6              TO  BCHKNOL
  9469         ELSE
  9470             MOVE CF-CR-CHECK-COUNTER
  9471                                 TO  BCHKNOI
  9472             MOVE 6              TO  BCHKNOL
  9473             ADD +1              TO  CF-CR-CHECK-COUNTER.
  9474
  9475     IF CR-CHECK-NO-MANUAL
  9476         IF BCHKNOL = ZEROS
  9477             MOVE ER-2438        TO  EMI-ERROR
  9478             MOVE -1             TO  BCHKNOL
  9479             MOVE AL-UNBON       TO  BCHKNOA
  9480             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9481             GO TO 8200-SEND-DATAONLY
  9482         ELSE
  9483             IF BCHKNOI NOT NUMERIC
  9484                 MOVE ER-2439    TO  EMI-ERROR
  9485                 MOVE -1         TO  BCHKNOL
  9486                 MOVE AL-UNBON   TO  BCHKNOA
  9487                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9488                 GO TO 8200-SEND-DATAONLY.
  9489
  9490
  9491* EXEC CICS GETMAIN
  9492*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  9493*        LENGTH   (ERPYAJ-LENGTH)
  9494*        INITIMG  (GETMAIN-SPACE)
  9495*    END-EXEC.
  9496*    MOVE ',"IL                  $   #00008809' TO DFHEIV0
  9497     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9498     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9499     MOVE X'2020233030303038383039' TO DFHEIV0(25:11)
  9500     CALL 'kxdfhei1' USING DFHEIV0,
  9501           DFHEIV20,
  9502           ERPYAJ-LENGTH,
  9503           GETMAIN-SPACE
  9504     SET ADDRESS OF PENDING-PAY-ADJ TO
  9505         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 198
* EL642T.cbl
  9506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9507
  9508
  9509
  9510* EXEC CICS BIF DEEDIT
  9511*        FIELD   (BCHKAMTI)
  9512*        LENGTH  (09)
  9513*    END-EXEC.
  9514     MOVE 09
  9515       TO DFHEIV11
  9516*    MOVE '@"L                   #   #00008815' TO DFHEIV0
  9517     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9518     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9519     MOVE X'2020233030303038383135' TO DFHEIV0(25:11)
  9520     CALL 'kxdfhei1' USING DFHEIV0,
  9521           BCHKAMTI,
  9522           DFHEIV11
  9523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9524
  9525
  9526     IF BCHKAMTI NOT GREATER THAN ZEROS
  9527         MOVE ER-3165    TO  EMI-ERROR
  9528         MOVE -1         TO  BCHKAMTL
  9529         MOVE AL-UNBON   TO  BCHKAMTA
  9530         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9531         GO TO 8200-SEND-DATAONLY.
  9532
  9533     MOVE 'Y'                    TO  PI-CHECK-SW.
  9534     MOVE 'PY'                   TO  PY-RECORD-ID.
  9535     MOVE PI-COMPANY-CD          TO  PY-COMPANY-CD.
  9536     MOVE PI-SAV-CARR            TO  PY-CARRIER.
  9537     MOVE PI-SAV-GROUP           TO  PY-GROUPING.
  9538     MOVE PI-SAV-AGENT           TO  PY-FIN-RESP.
  9539     MOVE LOW-VALUES             TO  PY-ACCOUNT.
  9540     MOVE 'C'                    TO  PY-RECORD-TYPE.
  9541     MOVE EIBTIME                TO  PY-FILE-SEQ-NO.
  9542     MOVE WS-CURRENT-DATE-MDY    TO  WS-PY-CURRENT-DATE.
  9543     MOVE WS-PY-ENTRY-COMMENT    TO  PY-ENTRY-COMMENT.
  9544     MOVE BCHKAMTI               TO  PY-ENTRY-AMT.
  9545
  9546     ADD BCHKAMTI                TO  PI-DISBURSED.
  9547
  9548     IF NOT  CR-CHECK-NO-AT-PRINT
  9549         MOVE BCHKNOI            TO  PY-CHECK-NUMBER.
  9550
  9551     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  9552     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  9553     MOVE WS-CURRENT-DATE        TO  PY-LAST-MAINT-DT
  9554                                     PY-INPUT-DT.
  9555     MOVE LOW-VALUES             TO  PY-BILLED-DATE
  9556                                     PY-AR-DATE.
  9557     MOVE ZEROS                  TO  PY-CHECK-QUE-CONTROL
  9558                                     PY-CHECK-QUE-SEQUENCE.
  9559     MOVE LOW-VALUES             TO  PY-CREDIT-ACCEPT-DT
  9560                                     PY-REPORTED-DT
  9561                                     PY-CHECK-WRITTEN-DT.
  9562     MOVE PI-CR-MONTH-END-DT     TO  PY-CREDIT-SELECT-DT.
  9563     MOVE 'G'                    TO  PY-CHECK-ORIGIN-SW.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 199
* EL642T.cbl
  9564     MOVE 'A'                    TO  JP-RECORD-TYPE.
  9565     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  9566     MOVE ERPYAJ-FILE-ID         TO  JP-FILE-ID.
  9567
  9568     COMPUTE JOURNAL-LENGTH = ERPYAJ-LENGTH + 23.
  9569
  9570
  9571* EXEC CICS WRITE
  9572*        DATASET  (ERPYAJ-FILE-ID)
  9573*        FROM     (PENDING-PAY-ADJ)
  9574*        RIDFLD   (PY-CONTROL-PRIMARY)
  9575*    END-EXEC.
  9576     MOVE LENGTH OF
  9577      PENDING-PAY-ADJ
  9578       TO DFHEIV11
  9579*    MOVE '&$ L                  ''   #00008864' TO DFHEIV0
  9580     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9581     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9582     MOVE X'2020233030303038383634' TO DFHEIV0(25:11)
  9583     CALL 'kxdfhei1' USING DFHEIV0,
  9584           ERPYAJ-FILE-ID,
  9585           PENDING-PAY-ADJ,
  9586           DFHEIV11,
  9587           PY-CONTROL-PRIMARY,
  9588           DFHEIV99,
  9589           DFHEIV99
  9590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9591
  9592
  9593     PERFORM 8400-LOG-JOURNAL-RECORD.
  9594
  9595     IF CR-CHECK-NO-AUTO-SEQ
  9596         PERFORM 6200-REWRITE-CONTROL-FILE  THRU  6290-EXIT
  9597     ELSE
  9598
  9599* EXEC CICS UNLOCK
  9600*            DATASET  (ELCNTL-FILE-ID)
  9601*        END-EXEC.
  9602*    MOVE '&*                    #   #00008875' TO DFHEIV0
  9603     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9604     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9605     MOVE X'2020233030303038383735' TO DFHEIV0(25:11)
  9606     CALL 'kxdfhei1' USING DFHEIV0,
  9607           ELCNTL-FILE-ID,
  9608           DFHEIV99
  9609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9610
  9611
  9612     MOVE EL642A                 TO  PI-MAP-NAME.
  9613
  9614     PERFORM 5000-FORMAT-SCREEN  THRU  5090-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 200
* EL642T.cbl
  9616 8100-SEND-INITIAL-MAP.
  9617
  9618     MOVE SPACES TO PI-TRANSFER-SW.
  9619
  9620     IF PI-MAP-NAME  =  EL642A
  9621         NEXT SENTENCE
  9622     ELSE
  9623         GO TO 8110-SEND-INITIAL-CHECK-MAP.
  9624
  9625     MOVE WS-CURRENT-DATE-EDIT   TO  ADATEO.
  9626     MOVE EIBTIME                TO  TIME-IN.
  9627     MOVE TIME-OUT               TO  ATIMEO.
  9628     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9629     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9630     MOVE -1                     TO  AAGENTL.
  9631     MOVE EMI-MESSAGE-AREA (1)   TO  AERMSG1O.
  9632     MOVE EMI-MESSAGE-AREA (2)   TO  AERMSG2O.
  9633
  9634     IF PI-ZERO-CARRIER
  9635         MOVE AL-SADOF           TO  ACARHDGA
  9636                                     ACARIERA.
  9637
  9638     IF PI-ZERO-GROUPING
  9639         MOVE AL-SADOF           TO  AGRPHDGA
  9640                                     AGROUPA.
  9641
  9642     IF PI-ZERO-CAR-GROUP
  9643         MOVE AL-SADOF           TO  ACARHDGA
  9644                                     ACARIERA
  9645         MOVE AL-SADOF           TO  AGRPHDGA
  9646                                     AGROUPA.
  9647
  9648     IF (EIBTRNID = EL633-TRANS-ID OR EL635-TRANS-ID OR
  9649                    EL633DMD-TRANS-ID OR
  9650                    EL650-TRANS-ID OR EL652-TRANS-ID OR
  9651                    EL658-TRANS-ID)    AND
  9652        (WT-CR-FIN-RESP NOT EQUAL SPACES AND LOW-VALUES)
  9653         MOVE -1                    TO  ABILTYPL
  9654         MOVE WT-CR-STATE           TO  PI-SCR-STATE
  9655         MOVE WT-CR-ACCOUNT         TO  PI-SCR-ACCOUNT
  9656         MOVE WT-CR-TYPE            TO  PI-SCR-TYPE
  9657         IF PI-ZERO-CARRIER
  9658             MOVE WT-CR-FIN-RESP    TO  AAGENTI
  9659                                        PI-SCR-FIN-RESP
  9660             MOVE WT-CR-GROUPING    TO  AGROUPI
  9661                                        PI-SCR-GROUPING
  9662             MOVE AL-UANON          TO  AAGENTA
  9663                                        AGROUPA
  9664             MOVE 10                TO  AAGENTL
  9665             MOVE 6                 TO  AGROUPL
  9666         ELSE
  9667            IF PI-ZERO-GROUPING
  9668                MOVE WT-CR-CARRIER    TO  ACARIERI
  9669                                          PI-SCR-CARRIER
  9670                MOVE WT-CR-FIN-RESP   TO  AAGENTI
  9671                                          PI-SCR-FIN-RESP
  9672                MOVE AL-UANON         TO  ACARIERA
  9673                                          AAGENTA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 201
* EL642T.cbl
  9674                MOVE 10               TO  AAGENTL
  9675                MOVE 1                TO  ACARIERL
  9676            ELSE
  9677               IF PI-ZERO-CAR-GROUP
  9678                   MOVE WT-CR-FIN-RESP TO  AAGENTI
  9679                                           PI-SCR-FIN-RESP
  9680                   MOVE AL-UANON       TO  AAGENTA
  9681                   MOVE 10             TO  AAGENTL
  9682               ELSE
  9683                   MOVE WT-CR-CARRIER     TO  ACARIERI
  9684                                              PI-SCR-CARRIER
  9685                   MOVE WT-CR-FIN-RESP    TO  AAGENTI
  9686                                              PI-SCR-FIN-RESP
  9687                   MOVE WT-CR-GROUPING    TO  AGROUPI
  9688                                              PI-SCR-GROUPING
  9689                   MOVE AL-UANON          TO  AAGENTA
  9690                                              AGROUPA
  9691                                              ACARIERA
  9692                   MOVE 10                TO  AAGENTL
  9693                   MOVE 6                 TO  AGROUPL
  9694                   MOVE 1                 TO  ACARIERL.
  9695
  9696
  9697* EXEC CICS SEND
  9698*        MAP     (PI-MAP-NAME)
  9699*        MAPSET  (MAPSET-NAME)
  9700*        FROM    (EL642AO)
  9701*        ERASE
  9702*        CURSOR
  9703*    END-EXEC.
  9704     MOVE LENGTH OF
  9705      EL642AO
  9706       TO DFHEIV12
  9707     MOVE -1
  9708       TO DFHEIV11
  9709*    MOVE '8$     CT  E    H L F ,   #00008963' TO DFHEIV0
  9710     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9711     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9712     MOVE X'2020233030303038393633' TO DFHEIV0(25:11)
  9713     CALL 'kxdfhei1' USING DFHEIV0,
  9714           PI-MAP-NAME,
  9715           EL642AO,
  9716           DFHEIV12,
  9717           MAPSET-NAME,
  9718           DFHEIV99,
  9719           DFHEIV99,
  9720           DFHEIV99,
  9721           DFHEIV11,
  9722           DFHEIV99,
  9723           DFHEIV99,
  9724           DFHEIV99
  9725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9726
  9727
  9728     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 202
* EL642T.cbl
  9730 8110-SEND-INITIAL-CHECK-MAP.
  9731     MOVE WS-CURRENT-DATE-EDIT   TO  BDATEO.
  9732     MOVE EIBTIME                TO  TIME-IN.
  9733     MOVE TIME-OUT               TO  BTIMEO.
  9734     MOVE PI-COMPANY-ID          TO  BCMPNYO.
  9735     MOVE PI-PROCESSOR-ID        TO  BUSERIDO.
  9736     MOVE -1                     TO  BPFNTERL.
  9737     MOVE EMI-MESSAGE-AREA (1)   TO  BERMSGO.
  9738
  9739
  9740* EXEC CICS SEND
  9741*        MAP     (PI-MAP-NAME)
  9742*        MAPSET  (MAPSET-NAME)
  9743*        FROM    (EL642BO)
  9744*        ERASE
  9745*        CURSOR
  9746*    END-EXEC.
  9747     MOVE LENGTH OF
  9748      EL642BO
  9749       TO DFHEIV12
  9750     MOVE -1
  9751       TO DFHEIV11
  9752*    MOVE '8$     CT  E    H L F ,   #00008982' TO DFHEIV0
  9753     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9754     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9755     MOVE X'2020233030303038393832' TO DFHEIV0(25:11)
  9756     CALL 'kxdfhei1' USING DFHEIV0,
  9757           PI-MAP-NAME,
  9758           EL642BO,
  9759           DFHEIV12,
  9760           MAPSET-NAME,
  9761           DFHEIV99,
  9762           DFHEIV99,
  9763           DFHEIV99,
  9764           DFHEIV11,
  9765           DFHEIV99,
  9766           DFHEIV99,
  9767           DFHEIV99
  9768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9769
  9770
  9771     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 203
* EL642T.cbl
  9773 8200-SEND-DATAONLY.
  9774     IF PI-MAP-NAME  =  EL642A
  9775         MOVE WS-CURRENT-DATE-EDIT  TO  ADATEO
  9776         MOVE EIBTIME               TO  TIME-IN
  9777         MOVE TIME-OUT              TO  ATIMEO
  9778         MOVE PI-COMPANY-ID         TO  CMPNYIDO
  9779         MOVE PI-PROCESSOR-ID       TO  USERIDO
  9780         MOVE EMI-MESSAGE-AREA (1)  TO  AERMSG1O
  9781         MOVE EMI-MESSAGE-AREA (2)  TO  AERMSG2O
  9782
  9783* EXEC CICS SEND
  9784*            MAP     (PI-MAP-NAME)
  9785*            MAPSET  (MAPSET-NAME)
  9786*            FROM    (EL642AO)
  9787*            DATAONLY
  9788*            ERASEAUP
  9789*            CURSOR
  9790*        END-EXEC
  9791     MOVE LENGTH OF
  9792      EL642AO
  9793       TO DFHEIV12
  9794     MOVE -1
  9795       TO DFHEIV11
  9796*    MOVE '8$D    CT  A    H L F ,   #00009001' TO DFHEIV0
  9797     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  9798     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9799     MOVE X'2020233030303039303031' TO DFHEIV0(25:11)
  9800     CALL 'kxdfhei1' USING DFHEIV0,
  9801           PI-MAP-NAME,
  9802           EL642AO,
  9803           DFHEIV12,
  9804           MAPSET-NAME,
  9805           DFHEIV99,
  9806           DFHEIV99,
  9807           DFHEIV99,
  9808           DFHEIV11,
  9809           DFHEIV99,
  9810           DFHEIV99,
  9811           DFHEIV99
  9812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9813     ELSE
  9814         MOVE WS-CURRENT-DATE-EDIT  TO  BDATEO
  9815         MOVE EIBTIME               TO  TIME-IN
  9816         MOVE TIME-OUT              TO  BTIMEO
  9817         MOVE PI-COMPANY-ID         TO  BCMPNYO
  9818         MOVE PI-PROCESSOR-ID       TO  BUSERIDO
  9819         MOVE EMI-MESSAGE-AREA (1)  TO  BERMSGO
  9820
  9821* EXEC CICS SEND
  9822*            MAP     (PI-MAP-NAME)
  9823*            MAPSET  (MAPSET-NAME)
  9824*            FROM    (EL642BO)
  9825*            DATAONLY
  9826*            ERASEAUP
  9827*            CURSOR
  9828*        END-EXEC.
  9829     MOVE LENGTH OF
  9830      EL642BO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 204
* EL642T.cbl
  9831       TO DFHEIV12
  9832     MOVE -1
  9833       TO DFHEIV11
  9834*    MOVE '8$D    CT  A    H L F ,   #00009016' TO DFHEIV0
  9835     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  9836     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9837     MOVE X'2020233030303039303136' TO DFHEIV0(25:11)
  9838     CALL 'kxdfhei1' USING DFHEIV0,
  9839           PI-MAP-NAME,
  9840           EL642BO,
  9841           DFHEIV12,
  9842           MAPSET-NAME,
  9843           DFHEIV99,
  9844           DFHEIV99,
  9845           DFHEIV99,
  9846           DFHEIV11,
  9847           DFHEIV99,
  9848           DFHEIV99,
  9849           DFHEIV99
  9850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9851
  9852
  9853     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 205
* EL642T.cbl
  9855 8300-SEND-TEXT.
  9856
  9857* EXEC CICS SEND TEXT
  9858*        FROM    (LOGOFF-TEXT)
  9859*        LENGTH  (LOGOFF-LENGTH)
  9860*        ERASE
  9861*        FREEKB
  9862*    END-EXEC.
  9863*    MOVE '8&      T  E F  H   F -   #00009028' TO DFHEIV0
  9864     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9865     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9866     MOVE X'2020233030303039303238' TO DFHEIV0(25:11)
  9867     CALL 'kxdfhei1' USING DFHEIV0,
  9868           LOGOFF-TEXT,
  9869           LOGOFF-LENGTH,
  9870           DFHEIV99,
  9871           DFHEIV99,
  9872           DFHEIV99,
  9873           DFHEIV99,
  9874           DFHEIV99,
  9875           DFHEIV99,
  9876           DFHEIV99,
  9877           DFHEIV99,
  9878           DFHEIV99,
  9879           DFHEIV99
  9880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9881
  9882
  9883
  9884* EXEC CICS RETURN
  9885*    END-EXEC.
  9886*    MOVE '.(                    &   #00009035' TO DFHEIV0
  9887     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9888     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9889     MOVE X'2020233030303039303335' TO DFHEIV0(25:11)
  9890     CALL 'kxdfhei1' USING DFHEIV0,
  9891           DFHEIV99,
  9892           DFHEIV99,
  9893           DFHEIV99,
  9894           DFHEIV99,
  9895           DFHEIV99
  9896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9897
  9898
  9899 8400-LOG-JOURNAL-RECORD.
  9900     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  9901     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  9902
  9903*    EXEC CICS JOURNAL
  9904*        JFILEID  (PI-JOURNAL-FILE-ID)
  9905*        JTYPEID  ('EL')
  9906*        FROM     (JOURNAL-RECORD)
  9907*        LENGTH   (JOURNAL-LENGTH)
  9908*    END-EXEC.
  9909
  9910 8500-DATE-CONVERT.
  9911
  9912* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 206
* EL642T.cbl
  9913*        PROGRAM   (LINK-ELDATCV)
  9914*        COMMAREA  (DATE-CONVERSION-DATA)
  9915*        LENGTH    (DC-COMM-LENGTH) END-EXEC.
  9916*    MOVE '."C                   ''   #00009050' TO DFHEIV0
  9917     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9918     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9919     MOVE X'2020233030303039303530' TO DFHEIV0(25:11)
  9920     CALL 'kxdfhei1' USING DFHEIV0,
  9921           LINK-ELDATCV,
  9922           DATE-CONVERSION-DATA,
  9923           DC-COMM-LENGTH,
  9924           DFHEIV99,
  9925           DFHEIV99,
  9926           DFHEIV99
  9927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9928
  9929
  9930 8500-EXIT.
  9931     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 207
* EL642T.cbl
  9933 8600-CENTER-DATA.
  9934     MOVE SPACE                  TO  CENTER-WORK-2.
  9935
  9936     IF CW1-PIC (1)  NOT =  SPACE
  9937       AND  CW1-PIC (X-LEN)  NOT =  SPACE
  9938         MOVE CENTER-WORK-1      TO  CENTER-WORK-2
  9939         GO TO 8690-C-D-X.
  9940
  9941     MOVE +0                     TO  X1.
  9942     MOVE X-LEN                  TO  X2.
  9943
  9944 8660-C-D-LOOP-1.
  9945     IF CW1-PIC (X2)  =  SPACE
  9946         ADD +1                  TO  X1
  9947         SUBTRACT +1             FROM  X2
  9948         GO TO 8660-C-D-LOOP-1.
  9949
  9950     MOVE +1                     TO  X2.
  9951
  9952 8670-C-D-LOOP-2.
  9953     IF CW1-PIC (X2)  =  SPACE
  9954         ADD +1                  TO  X1  X2
  9955         GO TO 8670-C-D-LOOP-2.
  9956
  9957     COMPUTE X3 = (X1 / +2) + +1.
  9958     COMPUTE X1 = X-LEN - X1.
  9959
  9960 8680-C-D-LOOP-3.
  9961     IF X1  NOT =  +0
  9962         MOVE CW1-PIC (X2)       TO  CW2-PIC (X3)
  9963         ADD +1                  TO  X2  X3
  9964         SUBTRACT +1             FROM  X1
  9965         GO TO 8680-C-D-LOOP-3.
  9966
  9967 8690-C-D-X.
  9968     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 208
* EL642T.cbl
  9970 8800-UNAUTHORIZED-ACCESS.
  9971     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  9972
  9973     GO TO 8300-SEND-TEXT.
  9974
  9975 8810-PF23.
  9976     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  9977     MOVE XCTL-005               TO  PGM-NAME.
  9978
  9979     GO TO 9300-XCTL.
  9980
  9981 8900-SYNCPOINT-ROLLBACK.
  9982
  9983* EXEC CICS SYNCPOINT
  9984*        ROLLBACK
  9985*    END-EXEC.
  9986*    MOVE '6"R                   !   #00009107' TO DFHEIV0
  9987     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  9988     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9989     MOVE X'2020233030303039313037' TO DFHEIV0(25:11)
  9990     CALL 'kxdfhei1' USING DFHEIV0
  9991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9992
  9993
  9994
  9995* EXEC CICS DUMP
  9996*        DUMPCODE  ('LGXX')
  9997*        TASK
  9998*    END-EXEC.
  9999     MOVE 'LGXX' TO DFHEIV5
 10000*    MOVE '<"   T                $   #00009111' TO DFHEIV0
 10001     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 10002     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10003     MOVE X'2020233030303039313131' TO DFHEIV0(25:11)
 10004     CALL 'kxdfhei1' USING DFHEIV0,
 10005           DFHEIV5,
 10006           DFHEIV99,
 10007           DFHEIV99
 10008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10009
 10010
 10011 8900-EXIT.
 10012     EXIT.
 10013
 10014 9100-RETURN-TRAN.
 10015     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10016     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10017
 10018
 10019* EXEC CICS RETURN
 10020*        TRANSID   (TRANS-ID)
 10021*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10022*        LENGTH    (PI-COMM-LENGTH)
 10023*    END-EXEC.
 10024*    MOVE '.(CT                  &   #00009123' TO DFHEIV0
 10025     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10026     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10027     MOVE X'2020233030303039313233' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 209
* EL642T.cbl
 10028     CALL 'kxdfhei1' USING DFHEIV0,
 10029           TRANS-ID,
 10030           PROGRAM-INTERFACE-BLOCK,
 10031           PI-COMM-LENGTH,
 10032           DFHEIV99,
 10033           DFHEIV99
 10034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10035
 10036
 10037 9200-RETURN-MAIN-MENU.
 10038     MOVE XCTL-626               TO  PGM-NAME.
 10039
 10040     GO TO 9300-XCTL.
 10041
 10042 9300-XCTL.
 10043
 10044* EXEC CICS XCTL
 10045*        PROGRAM   (PGM-NAME)
 10046*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10047*        LENGTH    (PI-COMM-LENGTH)
 10048*    END-EXEC.
 10049*    MOVE '.$C                   $   #00009135' TO DFHEIV0
 10050     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10051     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10052     MOVE X'2020233030303039313335' TO DFHEIV0(25:11)
 10053     CALL 'kxdfhei1' USING DFHEIV0,
 10054           PGM-NAME,
 10055           PROGRAM-INTERFACE-BLOCK,
 10056           PI-COMM-LENGTH
 10057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10058
 10059
 10060 9400-CLEAR.
 10061     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME
 10062
 10063     GO TO 9300-XCTL.
 10064
 10065 9500-PF12.
 10066     MOVE XCTL-010               TO  PGM-NAME.
 10067
 10068     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 210
* EL642T.cbl
 10070 9600-PGMID-ERROR.
 10071
 10072* EXEC CICS HANDLE CONDITION
 10073*        PGMIDERR  (8300-SEND-TEXT)
 10074*    END-EXEC.
 10075*    MOVE '"$L                   ! 5 #00009152' TO DFHEIV0
 10076     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10077     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10078     MOVE X'3520233030303039313532' TO DFHEIV0(25:11)
 10079     CALL 'kxdfhei1' USING DFHEIV0
 10080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10081
 10082
 10083     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10084     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10085     MOVE XCTL-005               TO  PGM-NAME.
 10086     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10087     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10088
 10089     GO TO 9300-XCTL.
 10090
 10091 9900-ERROR-FORMAT.
 10092     IF NOT  EMI-ERRORS-COMPLETE
 10093         MOVE LINK-001           TO  PGM-NAME
 10094
 10095* EXEC CICS LINK
 10096*            PROGRAM   (PGM-NAME)
 10097*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 10098*            LENGTH    (EMI-COMM-LENGTH)
 10099*        END-EXEC.
 10100*    MOVE '."C                   ''   #00009167' TO DFHEIV0
 10101     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10102     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10103     MOVE X'2020233030303039313637' TO DFHEIV0(25:11)
 10104     CALL 'kxdfhei1' USING DFHEIV0,
 10105           PGM-NAME,
 10106           ERROR-MESSAGE-INTERFACE-BLOCK,
 10107           EMI-COMM-LENGTH,
 10108           DFHEIV99,
 10109           DFHEIV99,
 10110           DFHEIV99
 10111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10112
 10113
 10114 9900-EXIT.
 10115     EXIT.
 10116
 10117 9990-ABEND.
 10118     MOVE LINK-004               TO  PGM-NAME.
 10119     MOVE DFHEIBLK               TO  EMI-LINE1
 10120
 10121
 10122* EXEC CICS LINK
 10123*        PROGRAM   (PGM-NAME)
 10124*        COMMAREA  (EMI-LINE1)
 10125*        LENGTH    (72)
 10126*    END-EXEC.
 10127     MOVE 72
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 211
* EL642T.cbl
 10128       TO DFHEIV11
 10129*    MOVE '."C                   ''   #00009180' TO DFHEIV0
 10130     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10131     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10132     MOVE X'2020233030303039313830' TO DFHEIV0(25:11)
 10133     CALL 'kxdfhei1' USING DFHEIV0,
 10134           PGM-NAME,
 10135           EMI-LINE1,
 10136           DFHEIV11,
 10137           DFHEIV99,
 10138           DFHEIV99,
 10139           DFHEIV99
 10140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10141
 10142
 10143     IF PI-MAP-NAME  =  EL642A
 10144         MOVE -1                 TO  APFNTERL
 10145     ELSE
 10146         MOVE -1                 TO  BPFNTERL.
 10147
 10148     GO TO 8200-SEND-DATAONLY.
 10149
 10150 9995-SECURITY-VIOLATION.
 10151*                            COPY ELCSCTP.
 10152******************************************************************
 10153*                                                                *
 10154*                            ELCSCTP                             *
 10155*                            VMOD=2.001                          *
 10156*                                                                *
 10157*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10158******************************************************************
 10159
 10160
 10161     MOVE EIBDATE          TO SM-JUL-DATE.
 10162     MOVE EIBTRMID         TO SM-TERMID.
 10163     MOVE THIS-PGM         TO SM-PGM.
 10164     MOVE EIBTIME          TO TIME-IN.
 10165     MOVE TIME-OUT         TO SM-TIME.
 10166     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10167
 10168
 10169* EXEC CICS LINK
 10170*         PROGRAM  ('EL003')
 10171*         COMMAREA (SECURITY-MESSAGE)
 10172*         LENGTH   (80)
 10173*    END-EXEC.
 10174     MOVE 'EL003' TO DFHEIV1
 10175     MOVE 80
 10176       TO DFHEIV11
 10177*    MOVE '."C                   ''   #00009211' TO DFHEIV0
 10178     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10179     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10180     MOVE X'2020233030303039323131' TO DFHEIV0(25:11)
 10181     CALL 'kxdfhei1' USING DFHEIV0,
 10182           DFHEIV1,
 10183           SECURITY-MESSAGE,
 10184           DFHEIV11,
 10185           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 212
* EL642T.cbl
 10186           DFHEIV99,
 10187           DFHEIV99
 10188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10189
 10190
 10191******************************************************************
 10192
 10193
 10194 9999-DFHBACK SECTION.
 10195     MOVE '9%                    "   ' TO DFHEIV0
 10196     MOVE 'EL642' TO DFHEIV1
 10197     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10198     GOBACK.
 10199 9999-DFHEXIT.
 10200     IF DFHEIGDJ EQUAL 0001
 10201         NEXT SENTENCE
 10202     ELSE IF DFHEIGDJ EQUAL 2
 10203         GO TO 9600-PGMID-ERROR,
 10204               9990-ABEND
 10205         DEPENDING ON DFHEIGDI
 10206     ELSE IF DFHEIGDJ EQUAL 3
 10207         GO TO 0890-EXIT
 10208         DEPENDING ON DFHEIGDI
 10209     ELSE IF DFHEIGDJ EQUAL 4
 10210         GO TO 3930-BILL-NOTFND
 10211         DEPENDING ON DFHEIGDI
 10212     ELSE IF DFHEIGDJ EQUAL 5
 10213         GO TO 3940-EXIT
 10214         DEPENDING ON DFHEIGDI
 10215     ELSE IF DFHEIGDJ EQUAL 6
 10216         GO TO 4010-REC-NOT-FND
 10217         DEPENDING ON DFHEIGDI
 10218     ELSE IF DFHEIGDJ EQUAL 7
 10219         GO TO 4110-END-OF-FILE
 10220         DEPENDING ON DFHEIGDI
 10221     ELSE IF DFHEIGDJ EQUAL 8
 10222         GO TO 4290-REC-NOT-FND
 10223         DEPENDING ON DFHEIGDI
 10224     ELSE IF DFHEIGDJ EQUAL 9
 10225         GO TO 4370-ACCOUNT-INVALID
 10226         DEPENDING ON DFHEIGDI
 10227     ELSE IF DFHEIGDJ EQUAL 10
 10228         GO TO 4510-REC-NOT-FND
 10229         DEPENDING ON DFHEIGDI
 10230     ELSE IF DFHEIGDJ EQUAL 11
 10231         GO TO 4610-END-OF-FILE
 10232         DEPENDING ON DFHEIGDI
 10233     ELSE IF DFHEIGDJ EQUAL 12
 10234         GO TO 6070-NO-COMP-MSTR
 10235         DEPENDING ON DFHEIGDI
 10236     ELSE IF DFHEIGDJ EQUAL 13
 10237         GO TO 6110-NO-RECORD
 10238         DEPENDING ON DFHEIGDI
 10239     ELSE IF DFHEIGDJ EQUAL 14
 10240         GO TO 6410-NOT-FOUND
 10241         DEPENDING ON DFHEIGDI
 10242     ELSE IF DFHEIGDJ EQUAL 15
 10243         GO TO 6610-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 213
* EL642T.cbl
 10244         DEPENDING ON DFHEIGDI
 10245     ELSE IF DFHEIGDJ EQUAL 16
 10246         GO TO 6660-START-BROWSE,
 10247               6700-COMM-EXIT
 10248         DEPENDING ON DFHEIGDI
 10249     ELSE IF DFHEIGDJ EQUAL 17
 10250         GO TO 6700-COMM-EXIT,
 10251               6700-COMM-EXIT
 10252         DEPENDING ON DFHEIGDI
 10253     ELSE IF DFHEIGDJ EQUAL 18
 10254         GO TO 6700-COMM-EXIT,
 10255               6700-COMM-EXIT
 10256         DEPENDING ON DFHEIGDI
 10257     ELSE IF DFHEIGDJ EQUAL 19
 10258         GO TO 6710-NOT-FOUND
 10259         DEPENDING ON DFHEIGDI
 10260     ELSE IF DFHEIGDJ EQUAL 20
 10261         GO TO 6880-NOT-FOUND
 10262         DEPENDING ON DFHEIGDI
 10263     ELSE IF DFHEIGDJ EQUAL 21
 10264         GO TO 8300-SEND-TEXT
 10265         DEPENDING ON DFHEIGDI.
 10266     MOVE '9%                    "   ' TO DFHEIV0
 10267     MOVE 'EL642' TO DFHEIV1
 10268     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10269     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        7976     Code:       28493
