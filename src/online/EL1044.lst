* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page   1
* EL1044.cbl
* Options: int("EL1044.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1044.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1044.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1044.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2 PROGRAM-ID.                 EL1044.
     3*
     4*AUTHOR.     PABLO
     5*            OMAHA NE
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF CENTRAL STATES IS EXPRESSLY PROHIBITED       *
    12*            *   WITHOUT THE PRIOR WRITTEN PERMISSION OF         *
    13*            *   CENTRAL STATES                                  *
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page   2
* EL1044.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*REMARKS.
    17*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    18*    FOR THE Z LETTER CONTROLS FOR ACCOUNT SERVICES
    19*    SCREENS     - EL1044Z - LETTER (Z) CONTROL MAINTENANCE
    20*    ENTERED BY  - EL1042 - TEXT MAINT
    21*    EXIT TO     - EL1042 - TEXT MAINT
    22*    INPUT FILE  - ELLETR -              - LETTER TEXT
    23*    OUTPUT FILE - ELLETR -              - LETTER TEXT
    24*    COMMAREA    - PASSED
    25*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL1042. ON
    26*                  FIRST ENTRY, WE READ THE ELLETR FILE USING THE
    27*                  LETTER ID PASSED FROM EL1042.     ON SUBSEQUENT
    28*                  ENTRIES (XCTL FROM CICS VIA     ) THE SCREEN
    29*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    30*                  MAINTENANCE TYPE INDICATED.
    31******************************************************************
    32*                   C H A N G E   L O G
    33*
    34* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    35*-----------------------------------------------------------------
    36*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    37* EFFECTIVE    NUMBER
    38*-----------------------------------------------------------------
    39* 122011    2011022800001  AJRA  ADD ELCZREC COPYBOOK
    40* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
    41* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
    42* 080113    2013062000003  AJRA  ADD BARCODE,RETURN ENV FLAG
    43* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
    44* 010914    2013090300001  AJRA  VALIDATE ENC CODE AGAINST ELENCC
    45* 030516  CR2016012700004  PEMA  Add acct summ code of 5
    46* 092419  CR2019030500002  TANA  Add letter type of A
    47******************************************************************
    48 ENVIRONMENT DIVISION.
    49 DATA DIVISION.
    50 WORKING-STORAGE SECTION.
    51 01  DFH-START PIC X(04).
    52 77  FILLER  PIC X(32)  VALUE '********************************'.
    53 77  FILLER  PIC X(32)  VALUE '*   EL1044 WORKING STORAGE     *'.
    54 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    55 77  M1                          PIC S999 COMP-3 VALUE +0.
    56 77  M2                          PIC S999 COMP-3 VALUE +0.
    57 77  WS-STOP-SW                  PIC X  VALUE ' '.
    58     88  I-SAY-TO-STOP              VALUE 'Y'.
    59 77  WS-FIND-SW                  PIC X  VALUE ' '.
    60     88  WE-FOUND-IT                VALUE 'Y'.
    61 77  WS-DONE-WITH-ENCC           PIC X  VALUE ' '.
    62     88  DONE-WITH-ENCC             VALUE 'Y'.
    63 77  WS-SEQ-NO-TO-USE            PIC S9(4) COMP VALUE +0.
    64 01  ACCESS-KEYS.
    65     12  ELLETR-KEY.
    66         16  ELLETR-COMPANY-CD   PIC X.
    67         16  ELLETR-ACCESS-CD    PIC X(12).
    68         16  ELLETR-SEQ-NO       PIC S9(4) COMP.
    69
    70     12  ELENCC-KEY.
    71         16  ELENCC-COMPANY-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page   3
* EL1044.cbl
    72         16  ELENCC-REC-TYPE      PIC X.
    73         16  ELENCC-ENC-CODE      PIC X(5).
    74         16  F                    PIC X(09).
    75 01  WS-DATE-AREA.
    76     05  SAVE-DATE                   PIC X(08)   VALUE SPACES.
    77     05  SAVE-BIN-DATE               PIC X(02)   VALUE SPACES.
    78 01  MISC-WORK-AREAS.
    79     12  WS-RESPONSE             PIC S9(8)   COMP.
    80         88  RESP-NORMAL              VALUE +00.
    81         88  RESP-ERROR               VALUE +01.
    82         88  RESP-NOTFND              VALUE +13.
    83         88  RESP-NOTOPEN             VALUE +19.
    84         88  RESP-ENDFILE             VALUE +20.
    85     12  WS-NUMVAL.
    86         16  WS-NUMVAL-OF-DEEDIT     PIC 9(11) VALUE ZEROS.
    87         16  WS-9V999-OF-DEEDIT REDEFINES
    88             WS-NUMVAL-OF-DEEDIT     PIC 9(8)V999.
    89     12  DEEDIT-FIELD                PIC X(11).
    90     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
    91                                     PIC S9(11).
    92     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
    93                                     PIC S9(09)V99.
    94
    95     12  WS-TEST-STATE               PIC X(2) VALUE SPACES.
    96         88 STATE-SPECIFIC    VALUES 'AK','AL','AR','AS','AZ',
    97            'CA','CO','CT','DC','DE','FL','GA','GU','HI','IA',
    98            'ID','IL','IN','KS','KY','LA','MA','MD','ME','MI',
    99            'MN','MO','MS','MT','NC','ND','NE','NH','NJ','NM',
   100            'NV','NY','OH','OK','OR','PA','PR','RI','SC','SD',
   101            'TN','TX','UT','VA','VI','VT','WA','WI','WV','WY'.
   102 01  STANDARD-AREAS.
   103     12  SC-ITEM                     PIC S9(4)   VALUE +1  COMP.
   104     12  TRANS-ID                    PIC X(04)   VALUE 'EX1F'.
   105     12  PGM-NAME                    PIC X(08).
   106     12  TIME-IN                     PIC S9(07).
   107     12  TIME-OUT-R  REDEFINES TIME-IN.
   108         16  FILLER                  PIC X(01).
   109         16  TIME-OUT                PIC 99V99.
   110         16  FILLER                  PIC X(02).
   111     12  XCTL-005                    PIC X(08)   VALUE 'EL005'.
   112     12  XCTL-010                    PIC X(08)   VALUE 'EL010'.
   113     12  XCTL-155                    PIC X(08)   VALUE 'EL155'.
   114     12  XCTL-626                    PIC X(08)   VALUE 'EL626'.
   115     12  LINK-001                    PIC X(08)   VALUE 'EL001'.
   116     12  LINK-004                    PIC X(08)   VALUE 'EL004'.
   117     12  LINK-ELDATCV                PIC X(08)   VALUE 'ELDATCV'.
   118     12  THIS-PGM                    PIC X(08)   VALUE 'EL1044'.
   119     12  ELLETR-FILE-ID              PIC X(08)   VALUE 'ELLETR'.
   120     12  ELLETR-LENGTH               PIC S9(04)  VALUE +100  COMP.
   121     12  ELENCC-FILE-ID              PIC X(08)   VALUE 'ELENCC'.
   122     12  ELENCC-LENGTH               PIC S9(04)  VALUE +400  COMP.
   123     12  SUB                         PIC 9(02).
   124     12  SUB-1                       PIC 9(02).
   125     12  SUB2                        PIC 9(02).
   126     12  GETMAIN-SPACE               PIC X(01)   VALUE SPACE.
   127     12  MAPSET-NAME                 PIC X(08)   VALUE 'EL1044S'.
   128     12  WS-MAP-NAME                 PIC X(08)   VALUE 'EL1044Z'.
   129     12  WS-PF-KEY                   PIC 9(02)   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page   4
* EL1044.cbl
   130     12  HOLD-ENC-CODES              PIC X(120)  VALUE SPACES.
   131     12  WS-SUB1                     PIC S9(03).
   132     12  WS-SUB2                     PIC S9(03).
   133     12  WS-SUB3                     PIC S9(03).
   134****  Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   135*                                    COPY ELCZREC.
   136******************************************************************
   137*                                                                *
   138*                                                                *
   139*                            ELCZREC.                            *
   140*                                                                *
   141*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   142*                                                                *
   143******************************************************************
   144*-----------------------------------------------------------------
   145*                   C H A N G E   L O G
   146*
   147* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   148*-----------------------------------------------------------------
   149*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   150* EFFECTIVE    NUMBER
   151*-----------------------------------------------------------------
   152* 122011    2011022800001  AJRA  NEW FILE
   153* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   154* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   155* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   156* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   157*-----------------------------------------------------------------
   158 01  W-Z-CONTROL-DATA.
   159     05  W-NUMBER-OF-COPIES      PIC  9.
   160     05  FILLER                  PIC  X.
   161     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   162     05  FILLER                  PIC  X.
   163     05  W-DAYS-TO-RESEND        PIC  999.
   164     05  FILLER                  PIC  X.
   165     05  W-FORM-TO-RESEND        PIC  X(4).
   166     05  W-ADD-BAR-CODE          PIC  X.
   167     05  W-PROMPT-LETTER         PIC  X.
   168     05  W-HAS-RETURN-ENV        PIC  X.
   169     05  W-ENCLOSURE-CD          PIC  XXX.
   170     05  W-SIG-FLAG-DEFAULT      PIC  X.
   171     05  W-AUTO-CLOSE-IND        PIC  X.
   172     05  FILLER                  PIC  X.
   173     05  W-LETTER-TO-BENE        PIC  X.
   174     05  FILLER                  PIC  X.
   175     05  W-LETTER-TO-ACCT        PIC  X.
   176     05  FILLER                  PIC  X.
   177     05  W-LETTER-TYPE           PIC  X.
   178     05  FILLER                  PIC  X.
   179     05  W-PRINT-CERTIFICATE     PIC  X.
   180     05  FILLER                  PIC  X.
   181     05  W-REFUND-REQUIRED       PIC  X.
   182     05  FILLER                  PIC  X.
   183     05  W-ONBASE-CODE           PIC  XX.
   184     05  FILLER                  PIC  X.
   185     05  W-ACCT-SUMM             PIC  X.
   186     05  FILLER                  PIC  X.
   187     05  W-CSO-SUMM              PIC  X.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page   5
* EL1044.cbl
   188     05  FILLER                  PIC  X.
   189     05  W-REASONS-REQUIRED      PIC  X.
   190     05  FILLER                  PIC  X(29).
   191*                                    COPY ELCSCTM.
   192******************************************************************
   193*                                                                *
   194*                                                                *
   195*                            ELCSCTM                             *
   196*                            VMOD=2.001                          *
   197*                                                                *
   198*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   199*                                                                *
   200******************************************************************
   201 01  SECURITY-MESSAGE.
   202     12  FILLER                          PIC X(30)
   203            VALUE '** LOGIC SECURITY VIOLATION -'.
   204     12  SM-READ                         PIC X(6).
   205     12  FILLER                          PIC X(5)
   206            VALUE ' PGM='.
   207     12  SM-PGM                          PIC X(6).
   208     12  FILLER                          PIC X(5)
   209            VALUE ' OPR='.
   210     12  SM-PROCESSOR-ID                 PIC X(4).
   211     12  FILLER                          PIC X(6)
   212            VALUE ' TERM='.
   213     12  SM-TERMID                       PIC X(4).
   214     12  FILLER                          PIC XX   VALUE SPACE.
   215     12  SM-JUL-DATE                     PIC 9(5).
   216     12  FILLER                          PIC X    VALUE SPACE.
   217     12  SM-TIME                         PIC 99.99.
   218
   219*                                    COPY ELCSCRTY.
   220******************************************************************
   221*                                                                *
   222*                                                                *
   223*                            ELCSCRTY                            *
   224*                            VMOD=2.001                          *
   225*                                                                *
   226*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   227*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   228*        SAVED IN PI-SECURITY-ADDRESS.                           *
   229*                                                                *
   230******************************************************************
   231 01  SECURITY-CONTROL.
   232     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   233     12  FILLER                       PIC XX    VALUE 'SC'.
   234     12  SC-CREDIT-CODES.
   235         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   236             20  SC-CREDIT-DISPLAY    PIC X.
   237             20  SC-CREDIT-UPDATE     PIC X.
   238     12  SC-CLAIMS-CODES.
   239         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   240             20  SC-CLAIMS-DISPLAY    PIC X.
   241             20  SC-CLAIMS-UPDATE     PIC X.
   242 01  ERROR-MESSAGES.
   243     12  ER-0000                     PIC X(04)   VALUE '0000'.
   244     12  ER-0005                     PIC X(04)   VALUE '0005'.
   245     12  ER-0023                     PIC X(04)   VALUE '0023'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page   6
* EL1044.cbl
   246     12  ER-0029                     PIC X(04)   VALUE '0029'.
   247     12  ER-0050                     PIC X(04)   VALUE '0050'.
   248     12  ER-0068                     PIC X(04)   VALUE '0068'.
   249     12  ER-0070                     PIC X(04)   VALUE '0070'.
   250     12  ER-0130                     PIC X(04)   VALUE '0130'.
   251     12  ER-0131                     PIC X(04)   VALUE '0131'.
   252     12  ER-0132                     PIC X(04)   VALUE '0132'.
   253     12  ER-0138                     PIC X(04)   VALUE '0138'.
   254     12  ER-0144                     PIC X(04)   VALUE '0144'.
   255     12  ER-0145                     PIC X(04)   VALUE '0145'.
   256     12  ER-0184                     PIC X(04)   VALUE '0184'.
   257     12  ER-0418                     PIC X(04)   VALUE '0418'.
   258     12  ER-0491                     PIC X(04)   VALUE '0491'.
   259     12  ER-0582                     PIC X(04)   VALUE '0582'.
   260     12  ER-0627                     PIC X(04)   VALUE '0627'.
   261     12  ER-0701                     PIC X(04)   VALUE '0701'.
   262     12  ER-0702                     PIC X(04)   VALUE '0702'.
   263     12  ER-0703                     PIC X(04)   VALUE '0703'.
   264     12  ER-0704                     PIC X(04)   VALUE '0704'.
   265     12  ER-0705                     PIC X(04)   VALUE '0705'.
   266     12  ER-0706                     PIC X(04)   VALUE '0706'.
   267     12  ER-0707                     PIC X(04)   VALUE '0707'.
   268     12  ER-0708                     PIC X(04)   VALUE '0708'.
   269     12  ER-0709                     PIC X(04)   VALUE '0709'.
   270     12  ER-0710                     PIC X(04)   VALUE '0710'.
   271     12  ER-0711                     PIC X(04)   VALUE '0711'.
   272     12  ER-0712                     PIC X(04)   VALUE '0712'.
   273     12  ER-0713                     PIC X(04)   VALUE '0713'.
   274     12  ER-0717                     PIC X(04)   VALUE '0717'.
   275     12  ER-0718                     PIC X(04)   VALUE '0718'.
   276     12  ER-0719                     PIC X(04)   VALUE '0719'.
   277     12  ER-0720                     PIC X(04)   VALUE '0720'.
   278     12  ER-0721                     PIC X(04)   VALUE '0721'.
   279     12  ER-0722                     PIC X(04)   VALUE '0722'.
   280     12  ER-0723                     PIC X(04)   VALUE '0723'.
   281     12  ER-0724                     PIC X(04)   VALUE '0724'.
   282     12  ER-0725                     PIC X(04)   VALUE '0725'.
   283     12  ER-0726                     PIC X(04)   VALUE '0726'.
   284     12  ER-0727                     PIC X(04)   VALUE '0727'.
   285     12  ER-0729                     PIC X(04)   VALUE '0729'.
   286     12  ER-0754                     PIC X(04)   VALUE '0754'.
   287     12  ER-1560                     PIC X(04)   VALUE '1560'.
   288     12  ER-1562                     PIC X(04)   VALUE '1562'.
   289     12  ER-1564                     PIC X(04)   VALUE '1564'.
   290     12  ER-2241                     PIC X(04)   VALUE '2241'.
   291     12  ER-2276                     PIC X(04)   VALUE '2276'.
   292     12  ER-3804                     PIC X(04)   VALUE '3804'.
   293     12  ER-3820                     PIC X(04)   VALUE '3820'.
   294     12  ER-3821                     PIC X(04)   VALUE '3821'.
   295     12  ER-7008                     PIC X(04)   VALUE '7008'.
   296     12  ER-7031                     PIC X(04)   VALUE '7031'.
   297     12  ER-7123                     PIC X(04)   VALUE '7123'.
   298     12  ER-8150                     PIC X(04)   VALUE '8150'.
   299     12  ER-9999                     PIC XXXX    VALUE '9999'.
   300*                                    COPY ELCDATE.
   301******************************************************************
   302*                                                                *
   303*                                                                *
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page   7
* EL1044.cbl
   304*                            ELCDATE.                            *
   305*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   306*                            VMOD=2.003
   307*                                                                *
   308*                                                                *
   309*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   310*                 LENGTH = 200                                   *
   311******************************************************************
   312
   313 01  DATE-CONVERSION-DATA.
   314     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   315     12  DC-OPTION-CODE                PIC X.
   316         88  BIN-TO-GREG                VALUE ' '.
   317         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   318         88  EDIT-GREG-TO-BIN           VALUE '2'.
   319         88  YMD-GREG-TO-BIN            VALUE '3'.
   320         88  MDY-GREG-TO-BIN            VALUE '4'.
   321         88  JULIAN-TO-BIN              VALUE '5'.
   322         88  BIN-PLUS-ELAPSED           VALUE '6'.
   323         88  FIND-CENTURY               VALUE '7'.
   324         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   325         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   326         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   327         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   328         88  JULIAN-TO-BIN-3            VALUE 'C'.
   329         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   330         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   331         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   332         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   333         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   334         88  CHECK-LEAP-YEAR            VALUE 'H'.
   335         88  BIN-3-TO-GREG              VALUE 'I'.
   336         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   337         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   338         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   339         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   340         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   341         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   342         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   343         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   344         88  THREE-CHARACTER-BIN
   345                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   346         88  GREGORIAN-TO-BIN
   347                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   348         88  BIN-TO-GREGORIAN
   349                  VALUES ' ' '1' 'I' '8' 'G'.
   350         88  JULIAN-TO-BINARY
   351                  VALUES '5' 'C' 'E' 'F'.
   352     12  DC-ERROR-CODE                 PIC X.
   353         88  NO-CONVERSION-ERROR        VALUE ' '.
   354         88  DATE-CONVERSION-ERROR
   355                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   356         88  DATE-IS-ZERO               VALUE '1'.
   357         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   358         88  DATE-IS-INVALID            VALUE '3'.
   359         88  DATE1-GREATER-DATE2        VALUE '4'.
   360         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   361         88  DATE-INVALID-OPTION        VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page   8
* EL1044.cbl
   362         88  INVALID-CENTURY            VALUE 'A'.
   363         88  ONLY-CENTURY               VALUE 'B'.
   364         88  ONLY-LEAP-YEAR             VALUE 'C'.
   365         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   366     12  DC-END-OF-MONTH               PIC X.
   367         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   368     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   369         88  USE-NORMAL-PROCESS         VALUE ' '.
   370         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   371         88  ADJUST-UP-100-YRS          VALUE '2'.
   372     12  FILLER                        PIC X.
   373     12  DC-CONVERSION-DATES.
   374         16  DC-BIN-DATE-1             PIC XX.
   375         16  DC-BIN-DATE-2             PIC XX.
   376         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   377         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   378                       DC-GREG-DATE-1-EDIT.
   379             20  DC-EDIT1-MONTH        PIC 99.
   380             20  SLASH1-1              PIC X.
   381             20  DC-EDIT1-DAY          PIC 99.
   382             20  SLASH1-2              PIC X.
   383             20  DC-EDIT1-YEAR         PIC 99.
   384         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   385         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   386                     DC-GREG-DATE-2-EDIT.
   387             20  DC-EDIT2-MONTH        PIC 99.
   388             20  SLASH2-1              PIC X.
   389             20  DC-EDIT2-DAY          PIC 99.
   390             20  SLASH2-2              PIC X.
   391             20  DC-EDIT2-YEAR         PIC 99.
   392         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   393         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   394                     DC-GREG-DATE-1-YMD.
   395             20  DC-YMD-YEAR           PIC 99.
   396             20  DC-YMD-MONTH          PIC 99.
   397             20  DC-YMD-DAY            PIC 99.
   398         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   399         16  DC-GREG-DATE-1-MDY-R REDEFINES
   400                      DC-GREG-DATE-1-MDY.
   401             20  DC-MDY-MONTH          PIC 99.
   402             20  DC-MDY-DAY            PIC 99.
   403             20  DC-MDY-YEAR           PIC 99.
   404         16  DC-GREG-DATE-1-ALPHA.
   405             20  DC-ALPHA-MONTH        PIC X(10).
   406             20  DC-ALPHA-DAY          PIC 99.
   407             20  FILLER                PIC XX.
   408             20  DC-ALPHA-CENTURY.
   409                 24 DC-ALPHA-CEN-N     PIC 99.
   410             20  DC-ALPHA-YEAR         PIC 99.
   411         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   412         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   413         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   414         16  DC-JULIAN-DATE            PIC 9(05).
   415         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   416                                       PIC 9(05).
   417         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   418             20  DC-JULIAN-YEAR        PIC 99.
   419             20  DC-JULIAN-DAYS        PIC 999.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page   9
* EL1044.cbl
   420         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   421         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   422         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   423     12  DATE-CONVERSION-VARIBLES.
   424         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   425         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   426             20  FILLER                PIC 9(3).
   427             20  HOLD-CEN-1-CCYY.
   428                 24  HOLD-CEN-1-CC     PIC 99.
   429                 24  HOLD-CEN-1-YY     PIC 99.
   430             20  HOLD-CEN-1-MO         PIC 99.
   431             20  HOLD-CEN-1-DA         PIC 99.
   432         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   433             20  HOLD-CEN-1-R-MO       PIC 99.
   434             20  HOLD-CEN-1-R-DA       PIC 99.
   435             20  HOLD-CEN-1-R-CCYY.
   436                 24  HOLD-CEN-1-R-CC   PIC 99.
   437                 24  HOLD-CEN-1-R-YY   PIC 99.
   438             20  FILLER                PIC 9(3).
   439         16  HOLD-CENTURY-1-X.
   440             20  FILLER                PIC X(3)  VALUE SPACES.
   441             20  HOLD-CEN-1-X-CCYY.
   442                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   443                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   444             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   445             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   446         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   447             20  HOLD-CEN-1-R-X-MO     PIC XX.
   448             20  HOLD-CEN-1-R-X-DA     PIC XX.
   449             20  HOLD-CEN-1-R-X-CCYY.
   450                 24  HOLD-CEN-1-R-X-CC PIC XX.
   451                 24  HOLD-CEN-1-R-X-YY PIC XX.
   452             20  FILLER                PIC XXX.
   453         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   454         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   455         16  DC-JULIAN-DATE-1          PIC 9(07).
   456         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   457             20  DC-JULIAN-1-CCYY.
   458                 24  DC-JULIAN-1-CC    PIC 99.
   459                 24  DC-JULIAN-1-YR    PIC 99.
   460             20  DC-JULIAN-DA-1        PIC 999.
   461         16  DC-JULIAN-DATE-2          PIC 9(07).
   462         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   463             20  DC-JULIAN-2-CCYY.
   464                 24  DC-JULIAN-2-CC    PIC 99.
   465                 24  DC-JULIAN-2-YR    PIC 99.
   466             20  DC-JULIAN-DA-2        PIC 999.
   467         16  DC-GREG-DATE-A-EDIT.
   468             20  DC-EDITA-MONTH        PIC 99.
   469             20  SLASHA-1              PIC X VALUE '/'.
   470             20  DC-EDITA-DAY          PIC 99.
   471             20  SLASHA-2              PIC X VALUE '/'.
   472             20  DC-EDITA-CCYY.
   473                 24  DC-EDITA-CENT     PIC 99.
   474                 24  DC-EDITA-YEAR     PIC 99.
   475         16  DC-GREG-DATE-B-EDIT.
   476             20  DC-EDITB-MONTH        PIC 99.
   477             20  SLASHB-1              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  10
* EL1044.cbl
   478             20  DC-EDITB-DAY          PIC 99.
   479             20  SLASHB-2              PIC X VALUE '/'.
   480             20  DC-EDITB-CCYY.
   481                 24  DC-EDITB-CENT     PIC 99.
   482                 24  DC-EDITB-YEAR     PIC 99.
   483         16  DC-GREG-DATE-CYMD         PIC 9(08).
   484         16  DC-GREG-DATE-CYMD-R REDEFINES
   485                              DC-GREG-DATE-CYMD.
   486             20  DC-CYMD-CEN           PIC 99.
   487             20  DC-CYMD-YEAR          PIC 99.
   488             20  DC-CYMD-MONTH         PIC 99.
   489             20  DC-CYMD-DAY           PIC 99.
   490         16  DC-GREG-DATE-MDCY         PIC 9(08).
   491         16  DC-GREG-DATE-MDCY-R REDEFINES
   492                              DC-GREG-DATE-MDCY.
   493             20  DC-MDCY-MONTH         PIC 99.
   494             20  DC-MDCY-DAY           PIC 99.
   495             20  DC-MDCY-CEN           PIC 99.
   496             20  DC-MDCY-YEAR          PIC 99.
   497    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   498        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   499    12  DC-EL310-DATE                  PIC X(21).
   500    12  FILLER                         PIC X(28).
   501*                                    COPY ELCLOGOF.
   502******************************************************************
   503*                                                                *
   504*                                                                *
   505*                            ELCLOGOF.                           *
   506*                            VMOD=2.001                          *
   507*                                                                *
   508*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   509*                                                                *
   510******************************************************************
   511 01  CLASIC-LOGOFF.
   512     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   513     12  LOGOFF-TEXT.
   514         16  FILLER          PIC X(5)    VALUE SPACES.
   515         16  LOGOFF-MSG.
   516             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   517             20  FILLER      PIC X       VALUE SPACES.
   518             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   519         16  FILLER          PIC X(80)
   520           VALUE '* YOU ARE NOW LOGGED OFF'.
   521         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   522         16  FILLER          PIC X       VALUE QUOTE.
   523         16  LOGOFF-SYS-MSG  PIC X(17)
   524           VALUE 'S CLAS-IC SYSTEM '.
   525     12  TEXT-MESSAGES.
   526         16  UNACCESS-MSG    PIC X(29)
   527             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   528         16  PGMIDERR-MSG    PIC X(17)
   529             VALUE 'PROGRAM NOT FOUND'.
   530*                                    COPY ELCATTR.
   531******************************************************************
   532*                                                                *
   533*                            ELCATTR.                            *
   534*                            VMOD=2.001                          *
   535*                                                                *
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  11
* EL1044.cbl
   536*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   537*                                                                *
   538*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   539*                                                                *
   540*                   POS 1   P=PROTECTED                          *
   541*                           U=UNPROTECTED                        *
   542*                           S=ASKIP                              *
   543*                   POS 2   A=ALPHA/NUMERIC                      *
   544*                           N=NUMERIC                            *
   545*                   POS 3   N=NORMAL                             *
   546*                           B=BRIGHT                             *
   547*                           D=DARK                               *
   548*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   549*                           OF=MODIFIED DATA TAG OFF             *
   550*                                                                *
   551*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   552******************************************************************
   553 01  ATTRIBUTE-LIST.
   554     12  AL-PABOF            PIC X       VALUE 'Y'.
   555     12  AL-PABON            PIC X       VALUE 'Z'.
   556     12  AL-PADOF            PIC X       VALUE '%'.
   557     12  AL-PADON            PIC X       VALUE '_'.
   558     12  AL-PANOF            PIC X       VALUE '-'.
   559     12  AL-PANON            PIC X       VALUE '/'.
   560     12  AL-SABOF            PIC X       VALUE '8'.
   561     12  AL-SABON            PIC X       VALUE '9'.
   562     12  AL-SADOF            PIC X       VALUE '@'.
   563     12  AL-SADON            PIC X       VALUE QUOTE.
   564     12  AL-SANOF            PIC X       VALUE '0'.
   565     12  AL-SANON            PIC X       VALUE '1'.
   566     12  AL-UABOF            PIC X       VALUE 'H'.
   567     12  AL-UABON            PIC X       VALUE 'I'.
   568     12  AL-UADOF            PIC X       VALUE '<'.
   569     12  AL-UADON            PIC X       VALUE '('.
   570     12  AL-UANOF            PIC X       VALUE ' '.
   571     12  AL-UANON            PIC X       VALUE 'A'.
   572     12  AL-UNBOF            PIC X       VALUE 'Q'.
   573     12  AL-UNBON            PIC X       VALUE 'R'.
   574     12  AL-UNDOF            PIC X       VALUE '*'.
   575     12  AL-UNDON            PIC X       VALUE ')'.
   576     12  AL-UNNOF            PIC X       VALUE '&'.
   577     12  AL-UNNON            PIC X       VALUE 'J'.
   578*                                    COPY ELCEMIB.
   579******************************************************************
   580*                                                                *
   581*                                                                *
   582*                            ELCEMIB.                            *
   583*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   584*                            VMOD=2.005                          *
   585*                                                                *
   586*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   587*                                                                *
   588******************************************************************
   589 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   590     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   591     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   592     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   593     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  12
* EL1044.cbl
   594     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   595     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   596     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   597     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   598     12  EMI-SWITCH1             PIC X        VALUE '1'.
   599         88  EMI-NO-ERRORS                    VALUE '1'.
   600         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   601         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   602     12  EMI-SWITCH2             PIC X        VALUE '1'.
   603         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   604     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   605         88  EMI-AREA1-EMPTY                  VALUE '1'.
   606         88  EMI-AREA1-FULL                   VALUE '2'.
   607     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   608         88  EMI-AREA2-EMPTY                  VALUE '1'.
   609         88  EMI-AREA2-FULL                   VALUE '2'.
   610     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   611         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   612         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   613         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   614         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   615         88  EMI-BYPASS-FATALS                VALUE 'X'.
   616     12  EMI-ERROR-LINES.
   617         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   618         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   619         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   620         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   621             20  EMI-ERR-CODES OCCURS 10 TIMES.
   622                 24  EMI-ERR-NUM         PIC X(4).
   623                 24  EMI-FILLER          PIC X.
   624                 24  EMI-SEV             PIC X.
   625                 24  FILLER              PIC X.
   626             20  FILLER                  PIC X(02).
   627     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   628         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   629             20  EMI-ERROR-NUMBER    PIC X(4).
   630             20  EMI-FILL            PIC X.
   631             20  EMI-SEVERITY        PIC X.
   632             20  FILLER              PIC X.
   633             20  EMI-ERROR-TEXT.
   634                 24  EMI-TEXT-VARIABLE   PIC X(10).
   635                 24  FILLER          PIC X(55).
   636     12  EMI-SEVERITY-SAVE           PIC X.
   637         88  EMI-NOTE                    VALUE 'N'.
   638         88  EMI-WARNING                 VALUE 'W'.
   639         88  EMI-FORCABLE                VALUE 'F'.
   640         88  EMI-FATAL                   VALUE 'X'.
   641     12  EMI-MESSAGE-FLAG            PIC X.
   642         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   643         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   644     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   645     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   646         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   647         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   648         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   649     12  emi-claim-no                pic x(7).
   650     12  emi-claim-type              pic x(6).
   651     12  FILLER                      PIC X(124)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  13
* EL1044.cbl
   652     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   653     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   654     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   655     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   656*                                    COPY ELCJPFX.
   657******************************************************************
   658*                                                                *
   659*                                                                *
   660*                            ELCJPFX.                            *
   661*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   662*                            VMOD=2.002                          *
   663*                                                                *
   664*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   665*                                                                *
   666*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   667*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   668*        ELCNTL - CONTROL FILE                                   *
   669*        ELMSTR - CLAIM MASTERS                                  *
   670*        ELTRLR - ACTIVITY TRAILERS                              *
   671*        ELCHKQ - CHECK QUE                                      *
   672******************************************************************
   673 01  JOURNAL-RECORD.
   674     12  jp-date                     pic s9(5) comp-3.
   675     12  jp-time                     pic s9(7) comp-3.
   676     12  JP-USER-ID                  PIC X(4).
   677     12  JP-FILE-ID                  PIC X(8).
   678     12  JP-PROGRAM-ID               PIC X(8).
   679     12  JP-RECORD-TYPE              PIC X.
   680         88 JP-ADD              VALUE 'A'.
   681         88 JP-BEFORE-CHANGE    VALUE 'B'.
   682         88 JP-AFTER-CHANGE     VALUE 'C'.
   683         88 JP-DELETE           VALUE 'D'.
   684         88 JP-GENERIC-DELETE   VALUE 'G'.
   685         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   686         88 JP-KEY-CHG-ADD      VALUE 'N'.
   687     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   688     12  JP-RECORD-AREA
   689
   690
   691                                     PIC X(530).
   692*                                    COPY ELCINTF.
   693******************************************************************
   694*                                                                *
   695*                                                                *
   696*                            ELCINTF.                            *
   697*                            VMOD=2.017                          *
   698*                                                                *
   699*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   700*                                                                *
   701*       LENGTH = 1024                                            *
   702*                                                                *
   703******************************************************************
   704*                   C H A N G E   L O G
   705*
   706* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   707*-----------------------------------------------------------------
   708*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   709* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  14
* EL1044.cbl
   710*-----------------------------------------------------------------
   711* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   712******************************************************************
   713 01  PROGRAM-INTERFACE-BLOCK.
   714     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   715     12  PI-CALLING-PROGRAM              PIC X(8).
   716     12  PI-SAVED-PROGRAM-1              PIC X(8).
   717     12  PI-SAVED-PROGRAM-2              PIC X(8).
   718     12  PI-SAVED-PROGRAM-3              PIC X(8).
   719     12  PI-SAVED-PROGRAM-4              PIC X(8).
   720     12  PI-SAVED-PROGRAM-5              PIC X(8).
   721     12  PI-SAVED-PROGRAM-6              PIC X(8).
   722     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   723     12  PI-COMPANY-ID                   PIC XXX.
   724     12  PI-COMPANY-CD                   PIC X.
   725
   726     12  PI-COMPANY-PASSWORD             PIC X(8).
   727
   728     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   729
   730     12  PI-CONTROL-IN-PROGRESS.
   731         16  PI-CARRIER                  PIC X.
   732         16  PI-GROUPING                 PIC X(6).
   733         16  PI-STATE                    PIC XX.
   734         16  PI-ACCOUNT                  PIC X(10).
   735         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   736                                         PIC X(10).
   737         16  PI-CLAIM-CERT-GRP.
   738             20  PI-CLAIM-NO             PIC X(7).
   739             20  PI-CERT-NO.
   740                 25  PI-CERT-PRIME       PIC X(10).
   741                 25  PI-CERT-SFX         PIC X.
   742             20  PI-CERT-EFF-DT          PIC XX.
   743         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   744             20  PI-PLAN-CODE            PIC X(2).
   745             20  PI-REVISION-NUMBER      PIC X(3).
   746             20  PI-PLAN-EFF-DT          PIC X(2).
   747             20  PI-PLAN-EXP-DT          PIC X(2).
   748             20  FILLER                  PIC X(11).
   749         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   750             20  PI-OE-REFERENCE-1.
   751                 25  PI-OE-REF-1-PRIME   PIC X(18).
   752                 25  PI-OE-REF-1-SUFF    PIC XX.
   753
   754     12  PI-SESSION-IN-PROGRESS          PIC X.
   755         88  CLAIM-SESSION                   VALUE '1'.
   756         88  CREDIT-SESSION                  VALUE '2'.
   757         88  WARRANTY-SESSION                VALUE '3'.
   758         88  MORTGAGE-SESSION                VALUE '4'.
   759         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   760
   761
   762*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   763
   764     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   765     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   766
   767     12  PI-CREDIT-USER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  15
* EL1044.cbl
   768         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   769         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   770
   771     12  PI-CLAIM-USER                   PIC X.
   772         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   773         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   774
   775     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   776         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   777         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   778         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   779         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   780         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   781
   782     12  PI-PROCESSOR-ID                 PIC X(4).
   783
   784     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   785
   786     12  PI-MEMBER-CAPTION               PIC X(10).
   787
   788     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   789         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   790
   791     12  PI-LIFE-OVERRIDE-L1             PIC X.
   792     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   793     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   794     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   795
   796     12  PI-AH-OVERRIDE-L1               PIC X.
   797     12  PI-AH-OVERRIDE-L2               PIC XX.
   798     12  PI-AH-OVERRIDE-L6               PIC X(6).
   799     12  PI-AH-OVERRIDE-L12              PIC X(12).
   800
   801     12  PI-NEW-SYSTEM                   PIC X(2).
   802
   803     12  PI-PRIMARY-CERT-NO              PIC X(11).
   804     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   805         88  PI-USES-PAID-TO                 VALUE '1'.
   806     12  PI-CRDTCRD-SYSTEM.
   807         16  PI-CRDTCRD-USER             PIC X.
   808             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   809             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   810         16  PI-CC-MONTH-END-DT          PIC XX.
   811     12  PI-PROCESSOR-PRINTER            PIC X(4).
   812
   813     12  PI-OE-REFERENCE-2.
   814         16  PI-OE-REF-2-PRIME           PIC X(10).
   815         16  PI-OE-REF-2-SUFF            PIC X.
   816
   817     12  PI-REM-TRM-CALC-OPTION          PIC X.
   818
   819     12  PI-LANGUAGE-TYPE                PIC X.
   820             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   821             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   822             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   823
   824     12  PI-POLICY-LINKAGE-IND           PIC X.
   825         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  16
* EL1044.cbl
   826         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   827                                                   LOW-VALUES.
   828
   829     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   830     12  PI-CLAIM-PW-SESSION             PIC X(1).
   831         88  PI-CLAIM-CREDIT                 VALUE '1'.
   832         88  PI-CLAIM-CONVEN                 VALUE '2'.
   833
   834     12  PI-PROCESSOR-CSR-IND            PIC X.
   835         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   836         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   837
   838     12  FILLER                          PIC X(3).
   839
   840     12  PI-SYSTEM-LEVEL                 PIC X(145).
   841
   842     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   843         PI-SYSTEM-LEVEL.
   844
   845         16  PI-ENTRY-CODES.
   846             20  PI-ENTRY-CD-1           PIC X.
   847             20  PI-ENTRY-CD-2           PIC X.
   848
   849         16  PI-RETURN-CODES.
   850             20  PI-RETURN-CD-1          PIC X.
   851             20  PI-RETURN-CD-2          PIC X.
   852
   853         16  PI-UPDATE-STATUS-SAVE.
   854             20  PI-UPDATE-BY            PIC X(4).
   855             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   856
   857         16  PI-LOWER-CASE-LETTERS       PIC X.
   858             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   859
   860*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   861*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   862*            88  CARRIER-CLM-CNTL            VALUE '2'.
   863
   864         16  PI-CERT-ACCESS-CONTROL      PIC X.
   865             88  ST-ACCNT-CNTL               VALUE ' '.
   866             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   867             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   868             88  ACCNT-CNTL                  VALUE '3'.
   869             88  CARR-ACCNT-CNTL             VALUE '4'.
   870
   871         16  PI-PROCESSOR-CAP-LIST.
   872             20  PI-SYSTEM-CONTROLS.
   873                24 PI-SYSTEM-DISPLAY     PIC X.
   874                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   875                24 PI-SYSTEM-MODIFY      PIC X.
   876                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   877             20  FILLER                  PIC XX.
   878             20  PI-DISPLAY-CAP          PIC X.
   879                 88  DISPLAY-CAP             VALUE 'Y'.
   880             20  PI-MODIFY-CAP           PIC X.
   881                 88  MODIFY-CAP              VALUE 'Y'.
   882             20  PI-MSG-AT-LOGON-CAP     PIC X.
   883                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  17
* EL1044.cbl
   884             20  PI-FORCE-CAP            PIC X.
   885                 88  FORCE-CAP               VALUE 'Y'.
   886
   887         16  PI-PROGRAM-CONTROLS.
   888             20  PI-PGM-PRINT-OPT        PIC X.
   889             20  PI-PGM-FORMAT-OPT       PIC X.
   890             20  PI-PGM-PROCESS-OPT      PIC X.
   891             20  PI-PGM-TOTALS-OPT       PIC X.
   892
   893         16  PI-HELP-INTERFACE.
   894             20  PI-LAST-ERROR-NO        PIC X(4).
   895             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   896
   897         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   898             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   899
   900         16  PI-CR-CONTROL-IN-PROGRESS.
   901             20  PI-CR-CARRIER           PIC X.
   902             20  PI-CR-GROUPING          PIC X(6).
   903             20  PI-CR-STATE             PIC XX.
   904             20  PI-CR-ACCOUNT           PIC X(10).
   905             20  PI-CR-FIN-RESP          PIC X(10).
   906             20  PI-CR-TYPE              PIC X.
   907
   908         16  PI-CR-BATCH-NUMBER          PIC X(6).
   909
   910         16  PI-CR-MONTH-END-DT          PIC XX.
   911
   912         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   913             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   914             88  PI-ZERO-CARRIER             VALUE '1'.
   915             88  PI-ZERO-GROUPING            VALUE '2'.
   916             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   917
   918         16  PI-CARRIER-SECURITY         PIC X.
   919             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   920
   921         16  PI-ACCOUNT-SECURITY         PIC X(10).
   922             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   923             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   924
   925         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   926             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   927                                         INDEXED BY PI-ACCESS-NDX
   928                                         PIC X.
   929
   930         16  PI-GA-BILLING-CONTROL       PIC X.
   931             88  PI-GA-BILLING               VALUE '1'.
   932
   933         16  PI-MAIL-PROCESSING          PIC X.
   934             88  PI-MAIL-YES                 VALUE 'Y'.
   935
   936         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   937
   938         16  PI-AR-SYSTEM.
   939             20  PI-AR-PROCESSING-CNTL   PIC X.
   940                 88  PI-AR-PROCESSING        VALUE 'Y'.
   941             20  PI-AR-SUMMARY-CODE      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  18
* EL1044.cbl
   942             20  PI-AR-MONTH-END-DT      PIC XX.
   943
   944         16  PI-MP-SYSTEM.
   945             20  PI-MORTGAGE-USER            PIC X.
   946                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   947                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   948             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   949                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   950                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   951                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   952                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   953                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   954             20  PI-MP-MONTH-END-DT          PIC XX.
   955             20  PI-MP-REFERENCE-NO.
   956                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   957                 24  PI-MP-REFERENCE-SFX     PIC XX.
   958
   959         16  PI-LABEL-CONTROL            PIC X(01).
   960             88  PI-CREATE-LABELS                    VALUE 'Y'.
   961             88  PI-BYPASS-LABELS                    VALUE 'N'.
   962
   963         16  PI-BILL-GROUPING-CODE       PIC X(01).
   964             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   965
   966         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   967             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   968             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   969
   970         16  FILLER                      PIC X(14).
   971
   972     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   973******************************************************************
   974     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   975*                                    COPY ELC1042.
   976******************************************************************
   977*                                                                *
   978*                                                                *
   979*                           ELC1042                              *
   980*                            VMOD=2.002                          *
   981*                                                                *
   982*    NOTE                                                        *
   983*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   984*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   985*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   986*        TO THESE PROGRAMS.                                      *
   987*                                                                *
   988*    NOTE                                                        *
   989*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   990*        USE ONLY!                                               *
   991*                                                                *
   992******************************************************************
   993
   994         16  PI-1042-WA.
   995             20  PI-ACTION       PIC  X(01).
   996                 88 PI-SHOW-MODE           VALUE '1'.
   997                 88 PI-CLEAR-MODE          VALUE '2'.
   998                 88 PI-CREATE-MODE         VALUE '3'.
   999             20  PI-COMM-CONTROL PIC  X(12).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  19
* EL1044.cbl
  1000             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1001             20  PI-EOF-SW       PIC  X(01).
  1002                 88  PI-FILE-EOF           VALUE 'Y'.
  1003             20  PI-FILETYP      PIC  X(01).
  1004             20  PI-FORM-SQUEEZE-CONTROL
  1005                                 PIC  X(01).
  1006                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1007                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1008             20  PI-LAST-CONTROL PIC  X(12).
  1009             20  PI-TEMP-STOR-ITEMS
  1010                                 PIC S9(04) COMP.
  1011             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1012             20  PI-UPDATE-SW    PIC  9(01).
  1013                 88 ANY-UPDATES            VALUE 1.
  1014             20  PI-104-SCREEN-SENT-IND
  1015                                 PIC  X(01).
  1016                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1017                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1018             20  PI-1042-SCREEN-SENT-IND
  1019                                 PIC  X(01).
  1020                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1021                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1022             20  PI-1042-ARCHIVE-IND
  1023                                 PIC  X(01).
  1024                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1025             20  FILLER          PIC  X(29).
  1026         16  PI-PREV-LETR-KEY        PIC X(15).
  1027         16  PI-CURR-LETR-KEY        PIC X(15).
  1028         16  PI-UPDATE-DT            PIC XX.
  1029         16  PI-ENC-CODES            PIC X(120).
  1030         16  PI-SPLIT-SUB            PIC S9(3)  COMP.
  1031         16  FILLER                  PIC X(434).
  1032*                                    COPY ELCAID.
  1033******************************************************************
  1034*                                                                *
  1035*                            ELCAID.                             *
  1036*                            VMOD=2.001                          *
  1037*                                                                *
  1038*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1039*                                                                *
  1040*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1041*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1042******************************************************************
  1043
  1044 01  DFHAID.
  1045   02  DFHNULL   PIC  X  VALUE  ' '.
  1046   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1047   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1048   02  DFHPEN    PIC  X  VALUE  '='.
  1049   02  DFHOPID   PIC  X  VALUE  'W'.
  1050   02  DFHPA1    PIC  X  VALUE  '%'.
  1051   02  DFHPA2    PIC  X  VALUE  '>'.
  1052   02  DFHPA3    PIC  X  VALUE  ','.
  1053   02  DFHPF1    PIC  X  VALUE  '1'.
  1054   02  DFHPF2    PIC  X  VALUE  '2'.
  1055   02  DFHPF3    PIC  X  VALUE  '3'.
  1056   02  DFHPF4    PIC  X  VALUE  '4'.
  1057   02  DFHPF5    PIC  X  VALUE  '5'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  20
* EL1044.cbl
  1058   02  DFHPF6    PIC  X  VALUE  '6'.
  1059   02  DFHPF7    PIC  X  VALUE  '7'.
  1060   02  DFHPF8    PIC  X  VALUE  '8'.
  1061   02  DFHPF9    PIC  X  VALUE  '9'.
  1062   02  DFHPF10   PIC  X  VALUE  ':'.
  1063   02  DFHPF11   PIC  X  VALUE  '#'.
  1064   02  DFHPF12   PIC  X  VALUE  '@'.
  1065   02  DFHPF13   PIC  X  VALUE  'A'.
  1066   02  DFHPF14   PIC  X  VALUE  'B'.
  1067   02  DFHPF15   PIC  X  VALUE  'C'.
  1068   02  DFHPF16   PIC  X  VALUE  'D'.
  1069   02  DFHPF17   PIC  X  VALUE  'E'.
  1070   02  DFHPF18   PIC  X  VALUE  'F'.
  1071   02  DFHPF19   PIC  X  VALUE  'G'.
  1072   02  DFHPF20   PIC  X  VALUE  'H'.
  1073   02  DFHPF21   PIC  X  VALUE  'I'.
  1074*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1075   02  DFHPF22   PIC  X  VALUE  '['.
  1076   02  DFHPF23   PIC  X  VALUE  '.'.
  1077   02  DFHPF24   PIC  X  VALUE  '<'.
  1078   02  DFHMSRE   PIC  X  VALUE  'X'.
  1079   02  DFHSTRF   PIC  X  VALUE  'h'.
  1080   02  DFHTRIG   PIC  X  VALUE  '"'.
  1081 01  FILLER    REDEFINES DFHAID.
  1082     12  FILLER                      PIC X(08).
  1083     12  PF-VALUES                   PIC X         OCCURS 24.
  1084*                                    COPY EL1044S.
  1085 01  EL1044ZI.
  1086     05  FILLER            PIC  X(0012).
  1087*    -------------------------------
  1088     05  DATEL PIC S9(0004) COMP.
  1089     05  DATEF PIC  X(0001).
  1090     05  FILLER REDEFINES DATEF.
  1091         10  DATEA PIC  X(0001).
  1092     05  FILLER            PIC  X(3).
  1093     05  DATEI PIC  X(0008).
  1094*    -------------------------------
  1095     05  TIMEL PIC S9(0004) COMP.
  1096     05  TIMEF PIC  X(0001).
  1097     05  FILLER REDEFINES TIMEF.
  1098         10  TIMEA PIC  X(0001).
  1099     05  FILLER            PIC  X(3).
  1100     05  TIMEI PIC  X(0005).
  1101*    -------------------------------
  1102     05  CMPNYIDL PIC S9(0004) COMP.
  1103     05  CMPNYIDF PIC  X(0001).
  1104     05  FILLER REDEFINES CMPNYIDF.
  1105         10  CMPNYIDA PIC  X(0001).
  1106     05  FILLER            PIC  X(3).
  1107     05  CMPNYIDI PIC  X(0003).
  1108*    -------------------------------
  1109     05  USERIDL PIC S9(0004) COMP.
  1110     05  USERIDF PIC  X(0001).
  1111     05  FILLER REDEFINES USERIDF.
  1112         10  USERIDA PIC  X(0001).
  1113     05  FILLER            PIC  X(3).
  1114     05  USERIDI PIC  X(0004).
  1115*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  21
* EL1044.cbl
  1116     05  MAINTL PIC S9(0004) COMP.
  1117     05  MAINTF PIC  X(0001).
  1118     05  FILLER REDEFINES MAINTF.
  1119         10  MAINTA PIC  X(0001).
  1120     05  FILLER            PIC  X(3).
  1121     05  MAINTI PIC  X(0001).
  1122*    -------------------------------
  1123     05  LSTUSRL PIC S9(0004) COMP.
  1124     05  LSTUSRF PIC  X(0001).
  1125     05  FILLER REDEFINES LSTUSRF.
  1126         10  LSTUSRA PIC  X(0001).
  1127     05  FILLER            PIC  X(3).
  1128     05  LSTUSRI PIC  X(0004).
  1129*    -------------------------------
  1130     05  LSTDTEL PIC S9(0004) COMP.
  1131     05  LSTDTEF PIC  X(0001).
  1132     05  FILLER REDEFINES LSTDTEF.
  1133         10  LSTDTEA PIC  X(0001).
  1134     05  FILLER            PIC  X(3).
  1135     05  LSTDTEI PIC  X(0008).
  1136*    -------------------------------
  1137     05  ZLETRL PIC S9(0004) COMP.
  1138     05  ZLETRF PIC  X(0001).
  1139     05  FILLER REDEFINES ZLETRF.
  1140         10  ZLETRA PIC  X(0001).
  1141     05  FILLER            PIC  X(3).
  1142     05  ZLETRI PIC  X(0004).
  1143*    -------------------------------
  1144     05  ZCOPIESL PIC S9(0004) COMP.
  1145     05  ZCOPIESF PIC  X(0001).
  1146     05  FILLER REDEFINES ZCOPIESF.
  1147         10  ZCOPIESA PIC  X(0001).
  1148     05  FILLER            PIC  X(3).
  1149     05  ZCOPIESI PIC  X(0001).
  1150*    -------------------------------
  1151     05  ZPROMPTL PIC S9(0004) COMP.
  1152     05  ZPROMPTF PIC  X(0001).
  1153     05  FILLER REDEFINES ZPROMPTF.
  1154         10  ZPROMPTA PIC  X(0001).
  1155     05  FILLER            PIC  X(3).
  1156     05  ZPROMPTI PIC  X(0001).
  1157*    -------------------------------
  1158     05  ZENCCDL PIC S9(0004) COMP.
  1159     05  ZENCCDF PIC  X(0001).
  1160     05  FILLER REDEFINES ZENCCDF.
  1161         10  ZENCCDA PIC  X(0001).
  1162     05  FILLER            PIC  X(3).
  1163     05  ZENCCDI PIC  X(0003).
  1164*    -------------------------------
  1165     05  ZRDAYSL PIC S9(0004) COMP.
  1166     05  ZRDAYSF PIC  X(0001).
  1167     05  FILLER REDEFINES ZRDAYSF.
  1168         10  ZRDAYSA PIC  X(0001).
  1169     05  FILLER            PIC  X(3).
  1170     05  ZRDAYSI PIC  X(0003).
  1171*    -------------------------------
  1172     05  ZFORML PIC S9(0004) COMP.
  1173     05  ZFORMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  22
* EL1044.cbl
  1174     05  FILLER REDEFINES ZFORMF.
  1175         10  ZFORMA PIC  X(0001).
  1176     05  FILLER            PIC  X(3).
  1177     05  ZFORMI PIC  X(0004).
  1178*    -------------------------------
  1179     05  ZBENEL PIC S9(0004) COMP.
  1180     05  ZBENEF PIC  X(0001).
  1181     05  FILLER REDEFINES ZBENEF.
  1182         10  ZBENEA PIC  X(0001).
  1183     05  FILLER            PIC  X(3).
  1184     05  ZBENEI PIC  X(0001).
  1185*    -------------------------------
  1186     05  ZACCTL PIC S9(0004) COMP.
  1187     05  ZACCTF PIC  X(0001).
  1188     05  FILLER REDEFINES ZACCTF.
  1189         10  ZACCTA PIC  X(0001).
  1190     05  FILLER            PIC  X(3).
  1191     05  ZACCTI PIC  X(0001).
  1192*    -------------------------------
  1193     05  ZTYPEL PIC S9(0004) COMP.
  1194     05  ZTYPEF PIC  X(0001).
  1195     05  FILLER REDEFINES ZTYPEF.
  1196         10  ZTYPEA PIC  X(0001).
  1197     05  FILLER            PIC  X(3).
  1198     05  ZTYPEI PIC  X(0001).
  1199*    -------------------------------
  1200     05  ZPRTCRTL PIC S9(0004) COMP.
  1201     05  ZPRTCRTF PIC  X(0001).
  1202     05  FILLER REDEFINES ZPRTCRTF.
  1203         10  ZPRTCRTA PIC  X(0001).
  1204     05  FILLER            PIC  X(3).
  1205     05  ZPRTCRTI PIC  X(0001).
  1206*    -------------------------------
  1207     05  ZREFREQL PIC S9(0004) COMP.
  1208     05  ZREFREQF PIC  X(0001).
  1209     05  FILLER REDEFINES ZREFREQF.
  1210         10  ZREFREQA PIC  X(0001).
  1211     05  FILLER            PIC  X(3).
  1212     05  ZREFREQI PIC  X(0001).
  1213*    -------------------------------
  1214     05  ZONBASEL PIC S9(0004) COMP.
  1215     05  ZONBASEF PIC  X(0001).
  1216     05  FILLER REDEFINES ZONBASEF.
  1217         10  ZONBASEA PIC  X(0001).
  1218     05  FILLER            PIC  X(3).
  1219     05  ZONBASEI PIC  X(0002).
  1220*    -------------------------------
  1221     05  ZACTSUML PIC S9(0004) COMP.
  1222     05  ZACTSUMF PIC  X(0001).
  1223     05  FILLER REDEFINES ZACTSUMF.
  1224         10  ZACTSUMA PIC  X(0001).
  1225     05  FILLER            PIC  X(3).
  1226     05  ZACTSUMI PIC  X(0001).
  1227*    -------------------------------
  1228     05  ZCSOSUML PIC S9(0004) COMP.
  1229     05  ZCSOSUMF PIC  X(0001).
  1230     05  FILLER REDEFINES ZCSOSUMF.
  1231         10  ZCSOSUMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  23
* EL1044.cbl
  1232     05  FILLER            PIC  X(3).
  1233     05  ZCSOSUMI PIC  X(0001).
  1234*    -------------------------------
  1235     05  ZREASONL PIC S9(0004) COMP.
  1236     05  ZREASONF PIC  X(0001).
  1237     05  FILLER REDEFINES ZREASONF.
  1238         10  ZREASONA PIC  X(0001).
  1239     05  FILLER            PIC  X(3).
  1240     05  ZREASONI PIC  X(0001).
  1241*    -------------------------------
  1242     05  ZBARCODL PIC S9(0004) COMP.
  1243     05  ZBARCODF PIC  X(0001).
  1244     05  FILLER REDEFINES ZBARCODF.
  1245         10  ZBARCODA PIC  X(0001).
  1246     05  FILLER            PIC  X(3).
  1247     05  ZBARCODI PIC  X(0001).
  1248*    -------------------------------
  1249     05  ZRETENVL PIC S9(0004) COMP.
  1250     05  ZRETENVF PIC  X(0001).
  1251     05  FILLER REDEFINES ZRETENVF.
  1252         10  ZRETENVA PIC  X(0001).
  1253     05  FILLER            PIC  X(3).
  1254     05  ZRETENVI PIC  X(0001).
  1255*    -------------------------------
  1256     05  ZSIGFLGL PIC S9(0004) COMP.
  1257     05  ZSIGFLGF PIC  X(0001).
  1258     05  FILLER REDEFINES ZSIGFLGF.
  1259         10  ZSIGFLGA PIC  X(0001).
  1260     05  FILLER            PIC  X(3).
  1261     05  ZSIGFLGI PIC  X(0001).
  1262*    -------------------------------
  1263     05  ZCODES1L PIC S9(0004) COMP.
  1264     05  ZCODES1F PIC  X(0001).
  1265     05  FILLER REDEFINES ZCODES1F.
  1266         10  ZCODES1A PIC  X(0001).
  1267     05  FILLER            PIC  X(3).
  1268     05  ZCODES1I PIC  X(0053).
  1269*    -------------------------------
  1270     05  ZCODES2L PIC S9(0004) COMP.
  1271     05  ZCODES2F PIC  X(0001).
  1272     05  FILLER REDEFINES ZCODES2F.
  1273         10  ZCODES2A PIC  X(0001).
  1274     05  FILLER            PIC  X(3).
  1275     05  ZCODES2I PIC  X(0078).
  1276*    -------------------------------
  1277     05  ZFADAYSL PIC S9(0004) COMP.
  1278     05  ZFADAYSF PIC  X(0001).
  1279     05  FILLER REDEFINES ZFADAYSF.
  1280         10  ZFADAYSA PIC  X(0001).
  1281     05  FILLER            PIC  X(3).
  1282     05  ZFADAYSI PIC  X(0003).
  1283*    -------------------------------
  1284     05  ZACLOSEL PIC S9(0004) COMP.
  1285     05  ZACLOSEF PIC  X(0001).
  1286     05  FILLER REDEFINES ZACLOSEF.
  1287         10  ZACLOSEA PIC  X(0001).
  1288     05  FILLER            PIC  X(3).
  1289     05  ZACLOSEI PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  24
* EL1044.cbl
  1290*    -------------------------------
  1291     05  ERRMSGL PIC S9(0004) COMP.
  1292     05  ERRMSGF PIC  X(0001).
  1293     05  FILLER REDEFINES ERRMSGF.
  1294         10  ERRMSGA PIC  X(0001).
  1295     05  FILLER            PIC  X(3).
  1296     05  ERRMSGI PIC  X(0072).
  1297*    -------------------------------
  1298     05  PFKEYL PIC S9(0004) COMP.
  1299     05  PFKEYF PIC  X(0001).
  1300     05  FILLER REDEFINES PFKEYF.
  1301         10  PFKEYA PIC  X(0001).
  1302     05  FILLER            PIC  X(3).
  1303     05  PFKEYI PIC  99.
  1304 01  EL1044ZO REDEFINES EL1044ZI.
  1305     05  FILLER            PIC  X(0012).
  1306*    -------------------------------
  1307     05  FILLER            PIC  X(3).
  1308     05  DATEC PIC  X(0001).
  1309     05  DATEH PIC  X(0001).
  1310     05  DATEU PIC  X(0001).
  1311     05  DATEO PIC  X(0008).
  1312*    -------------------------------
  1313     05  FILLER            PIC  X(3).
  1314     05  TIMEC PIC  X(0001).
  1315     05  TIMEH PIC  X(0001).
  1316     05  TIMEU PIC  X(0001).
  1317     05  TIMEO PIC  99.99.
  1318*    -------------------------------
  1319     05  FILLER            PIC  X(3).
  1320     05  CMPNYIDC PIC  X(0001).
  1321     05  CMPNYIDH PIC  X(0001).
  1322     05  CMPNYIDU PIC  X(0001).
  1323     05  CMPNYIDO PIC  X(0003).
  1324*    -------------------------------
  1325     05  FILLER            PIC  X(3).
  1326     05  USERIDC PIC  X(0001).
  1327     05  USERIDH PIC  X(0001).
  1328     05  USERIDU PIC  X(0001).
  1329     05  USERIDO PIC  X(0004).
  1330*    -------------------------------
  1331     05  FILLER            PIC  X(3).
  1332     05  MAINTC PIC  X(0001).
  1333     05  MAINTH PIC  X(0001).
  1334     05  MAINTU PIC  X(0001).
  1335     05  MAINTO PIC  X(0001).
  1336*    -------------------------------
  1337     05  FILLER            PIC  X(3).
  1338     05  LSTUSRC PIC  X(0001).
  1339     05  LSTUSRH PIC  X(0001).
  1340     05  LSTUSRU PIC  X(0001).
  1341     05  LSTUSRO PIC  X(0004).
  1342*    -------------------------------
  1343     05  FILLER            PIC  X(3).
  1344     05  LSTDTEC PIC  X(0001).
  1345     05  LSTDTEH PIC  X(0001).
  1346     05  LSTDTEU PIC  X(0001).
  1347     05  LSTDTEO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  25
* EL1044.cbl
  1348*    -------------------------------
  1349     05  FILLER            PIC  X(3).
  1350     05  ZLETRC PIC  X(0001).
  1351     05  ZLETRH PIC  X(0001).
  1352     05  ZLETRU PIC  X(0001).
  1353     05  ZLETRO PIC  X(0004).
  1354*    -------------------------------
  1355     05  FILLER            PIC  X(3).
  1356     05  ZCOPIESC PIC  X(0001).
  1357     05  ZCOPIESH PIC  X(0001).
  1358     05  ZCOPIESU PIC  X(0001).
  1359     05  ZCOPIESO PIC  9.
  1360*    -------------------------------
  1361     05  FILLER            PIC  X(3).
  1362     05  ZPROMPTC PIC  X(0001).
  1363     05  ZPROMPTH PIC  X(0001).
  1364     05  ZPROMPTU PIC  X(0001).
  1365     05  ZPROMPTO PIC  X(0001).
  1366*    -------------------------------
  1367     05  FILLER            PIC  X(3).
  1368     05  ZENCCDC PIC  X(0001).
  1369     05  ZENCCDH PIC  X(0001).
  1370     05  ZENCCDU PIC  X(0001).
  1371     05  ZENCCDO PIC  X(0003).
  1372*    -------------------------------
  1373     05  FILLER            PIC  X(3).
  1374     05  ZRDAYSC PIC  X(0001).
  1375     05  ZRDAYSH PIC  X(0001).
  1376     05  ZRDAYSU PIC  X(0001).
  1377     05  ZRDAYSO PIC  999.
  1378*    -------------------------------
  1379     05  FILLER            PIC  X(3).
  1380     05  ZFORMC PIC  X(0001).
  1381     05  ZFORMH PIC  X(0001).
  1382     05  ZFORMU PIC  X(0001).
  1383     05  ZFORMO PIC  X(0004).
  1384*    -------------------------------
  1385     05  FILLER            PIC  X(3).
  1386     05  ZBENEC PIC  X(0001).
  1387     05  ZBENEH PIC  X(0001).
  1388     05  ZBENEU PIC  X(0001).
  1389     05  ZBENEO PIC  X(0001).
  1390*    -------------------------------
  1391     05  FILLER            PIC  X(3).
  1392     05  ZACCTC PIC  X(0001).
  1393     05  ZACCTH PIC  X(0001).
  1394     05  ZACCTU PIC  X(0001).
  1395     05  ZACCTO PIC  X(0001).
  1396*    -------------------------------
  1397     05  FILLER            PIC  X(3).
  1398     05  ZTYPEC PIC  X(0001).
  1399     05  ZTYPEH PIC  X(0001).
  1400     05  ZTYPEU PIC  X(0001).
  1401     05  ZTYPEO PIC  X(0001).
  1402*    -------------------------------
  1403     05  FILLER            PIC  X(3).
  1404     05  ZPRTCRTC PIC  X(0001).
  1405     05  ZPRTCRTH PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  26
* EL1044.cbl
  1406     05  ZPRTCRTU PIC  X(0001).
  1407     05  ZPRTCRTO PIC  X(0001).
  1408*    -------------------------------
  1409     05  FILLER            PIC  X(3).
  1410     05  ZREFREQC PIC  X(0001).
  1411     05  ZREFREQH PIC  X(0001).
  1412     05  ZREFREQU PIC  X(0001).
  1413     05  ZREFREQO PIC  X(0001).
  1414*    -------------------------------
  1415     05  FILLER            PIC  X(3).
  1416     05  ZONBASEC PIC  X(0001).
  1417     05  ZONBASEH PIC  X(0001).
  1418     05  ZONBASEU PIC  X(0001).
  1419     05  ZONBASEO PIC  X(0002).
  1420*    -------------------------------
  1421     05  FILLER            PIC  X(3).
  1422     05  ZACTSUMC PIC  X(0001).
  1423     05  ZACTSUMH PIC  X(0001).
  1424     05  ZACTSUMU PIC  X(0001).
  1425     05  ZACTSUMO PIC  X(0001).
  1426*    -------------------------------
  1427     05  FILLER            PIC  X(3).
  1428     05  ZCSOSUMC PIC  X(0001).
  1429     05  ZCSOSUMH PIC  X(0001).
  1430     05  ZCSOSUMU PIC  X(0001).
  1431     05  ZCSOSUMO PIC  X(0001).
  1432*    -------------------------------
  1433     05  FILLER            PIC  X(3).
  1434     05  ZREASONC PIC  X(0001).
  1435     05  ZREASONH PIC  X(0001).
  1436     05  ZREASONU PIC  X(0001).
  1437     05  ZREASONO PIC  X(0001).
  1438*    -------------------------------
  1439     05  FILLER            PIC  X(3).
  1440     05  ZBARCODC PIC  X(0001).
  1441     05  ZBARCODH PIC  X(0001).
  1442     05  ZBARCODU PIC  X(0001).
  1443     05  ZBARCODO PIC  X(0001).
  1444*    -------------------------------
  1445     05  FILLER            PIC  X(3).
  1446     05  ZRETENVC PIC  X(0001).
  1447     05  ZRETENVH PIC  X(0001).
  1448     05  ZRETENVU PIC  X(0001).
  1449     05  ZRETENVO PIC  X(0001).
  1450*    -------------------------------
  1451     05  FILLER            PIC  X(3).
  1452     05  ZSIGFLGC PIC  X(0001).
  1453     05  ZSIGFLGH PIC  X(0001).
  1454     05  ZSIGFLGU PIC  X(0001).
  1455     05  ZSIGFLGO PIC  X(0001).
  1456*    -------------------------------
  1457     05  FILLER            PIC  X(3).
  1458     05  ZCODES1C PIC  X(0001).
  1459     05  ZCODES1H PIC  X(0001).
  1460     05  ZCODES1U PIC  X(0001).
  1461     05  ZCODES1O PIC  X(0053).
  1462*    -------------------------------
  1463     05  FILLER            PIC  X(3).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  27
* EL1044.cbl
  1464     05  ZCODES2C PIC  X(0001).
  1465     05  ZCODES2H PIC  X(0001).
  1466     05  ZCODES2U PIC  X(0001).
  1467     05  ZCODES2O PIC  X(0078).
  1468*    -------------------------------
  1469     05  FILLER            PIC  X(3).
  1470     05  ZFADAYSC PIC  X(0001).
  1471     05  ZFADAYSH PIC  X(0001).
  1472     05  ZFADAYSU PIC  X(0001).
  1473     05  ZFADAYSO PIC  999.
  1474*    -------------------------------
  1475     05  FILLER            PIC  X(3).
  1476     05  ZACLOSEC PIC  X(0001).
  1477     05  ZACLOSEH PIC  X(0001).
  1478     05  ZACLOSEU PIC  X(0001).
  1479     05  ZACLOSEO PIC  X(0001).
  1480*    -------------------------------
  1481     05  FILLER            PIC  X(3).
  1482     05  ERRMSGC PIC  X(0001).
  1483     05  ERRMSGH PIC  X(0001).
  1484     05  ERRMSGU PIC  X(0001).
  1485     05  ERRMSGO PIC  X(0072).
  1486*    -------------------------------
  1487     05  FILLER            PIC  X(3).
  1488     05  PFKEYC PIC  X(0001).
  1489     05  PFKEYH PIC  X(0001).
  1490     05  PFKEYU PIC  X(0001).
  1491     05  PFKEYO PIC  99.
  1492*    -------------------------------
  1493****************************************************************
  1494*
  1495* Copyright (c) 2007-2013 Dell Inc.
  1496* All rights reserved.
  1497*
  1498****************************************************************
  1499 01  DFHEIV.
  1500   02  DFHEIV0               PIC X(35).
  1501   02  DFHEIV1               PIC X(08).
  1502   02  DFHEIV2               PIC X(08).
  1503   02  DFHEIV3               PIC X(08).
  1504   02  DFHEIV4               PIC X(06).
  1505   02  DFHEIV5               PIC X(04).
  1506   02  DFHEIV6               PIC X(04).
  1507   02  DFHEIV7               PIC X(02).
  1508   02  DFHEIV8               PIC X(02).
  1509   02  DFHEIV9               PIC X(01).
  1510   02  DFHEIV10              PIC S9(7) COMP-3.
  1511   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1512   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1513   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1514   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1515   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1516   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1517   02  DFHEIV17              PIC X(04).
  1518   02  DFHEIV18              PIC X(04).
  1519   02  DFHEIV19              PIC X(04).
  1520   02  DFHEIV20              USAGE IS POINTER.
  1521   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  28
* EL1044.cbl
  1522   02  DFHEIV22              USAGE IS POINTER.
  1523   02  DFHEIV23              USAGE IS POINTER.
  1524   02  DFHEIV24              USAGE IS POINTER.
  1525   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1526   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1527   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1528   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1529   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1530   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1531   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1532   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1533   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1534   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1535   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1536   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1537   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1538   02  FILLER                PIC X(02).
  1539   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1540   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1541   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1542   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1543   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1544   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1545   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1546 LINKAGE  SECTION.
  1547*****************************************************************
  1548*                                                               *
  1549* Copyright (c) 2007-2013 Dell Inc.                             *
  1550* All rights reserved.                                          *
  1551*                                                               *
  1552*****************************************************************
  1553 01  dfheiblk.
  1554     02  eibtime          pic s9(7) comp-3.
  1555     02  eibdate          pic s9(7) comp-3.
  1556     02  eibtrnid         pic x(4).
  1557     02  eibtaskn         pic s9(7) comp-3.
  1558     02  eibtrmid         pic x(4).
  1559     02  dfheigdi         pic s9(4) comp.
  1560     02  eibcposn         pic s9(4) comp.
  1561     02  eibcalen         pic s9(4) comp.
  1562     02  eibaid           pic x(1).
  1563     02  eibfiller1       pic x(1).
  1564     02  eibfn            pic x(2).
  1565     02  eibfiller2       pic x(2).
  1566     02  eibrcode         pic x(6).
  1567     02  eibfiller3       pic x(2).
  1568     02  eibds            pic x(8).
  1569     02  eibreqid         pic x(8).
  1570     02  eibrsrce         pic x(8).
  1571     02  eibsync          pic x(1).
  1572     02  eibfree          pic x(1).
  1573     02  eibrecv          pic x(1).
  1574     02  eibsend          pic x(1).
  1575     02  eibatt           pic x(1).
  1576     02  eibeoc           pic x(1).
  1577     02  eibfmh           pic x(1).
  1578     02  eibcompl         pic x(1).
  1579     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  29
* EL1044.cbl
  1580     02  eibconf          pic x(1).
  1581     02  eiberr           pic x(1).
  1582     02  eibrldbk         pic x(1).
  1583     02  eiberrcd         pic x(4).
  1584     02  eibsynrb         pic x(1).
  1585     02  eibnodat         pic x(1).
  1586     02  eibfiller5       pic x(2).
  1587     02  eibresp          pic s9(8) comp.
  1588     02  eibresp2         pic s9(8) comp.
  1589     02  dfheigdj         pic s9(4) comp.
  1590     02  dfheigdk         pic s9(4) comp.
  1591 01  DFHCOMMAREA                     PIC X(1024).
  1592*                                    COPY ELCTEXT.
  1593******************************************************************
  1594*                                                                *
  1595*                                                                *
  1596*                            ELCTEXT.                            *
  1597*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1598*                            VMOD=2.008                          *
  1599*                                                                *
  1600*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1601*                                     FORM LETTERS,              *
  1602*                                     CERT FORM DISPLAY.
  1603*                                                                *
  1604*   FILE TYPE = VSAM,KSDS                                        *
  1605*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1606*                                                                *
  1607*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1608*       ALTERNATE INDEX = NONE                                   *
  1609*                                                                *
  1610*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1611*       ALTERNATE INDEX = NONE                                   *
  1612*                                                                *
  1613*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1614*       ALTERNATE INDEX = NONE                                   *
  1615*                                                                *
  1616*   LOG = NO                                                     *
  1617*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1618******************************************************************
  1619 01  TEXT-FILES.
  1620     12  TEXT-FILE-ID                PIC XX.
  1621         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1622         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1623         88  HELP-FILE-TEXT             VALUE 'TH'.
  1624
  1625     12  TX-CONTROL-PRIMARY.
  1626         16  TX-COMPANY-CD           PIC X.
  1627             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1628         16  TX-ACCESS-CD-GENL       PIC X(12).
  1629
  1630         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1631             20  TX-LETTER-NO        PIC X(4).
  1632             20  FILLER              PIC X(8).
  1633
  1634         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1635             20  TX-FORM-NO          PIC X(12).
  1636
  1637         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  30
* EL1044.cbl
  1638             20  TX-HELP-TYPE        PIC X.
  1639                 88  HELP-FOR-GENERAL   VALUE ' '.
  1640                 88  HELP-BY-SCREEN     VALUE 'S'.
  1641                 88  HELP-BY-ERROR      VALUE 'E'.
  1642             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1643                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1644             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1645                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1646             20  FILLER              PIC X(4).
  1647
  1648         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1649
  1650     12  TX-PROCESS-CONTROL          PIC XX.
  1651         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1652
  1653     12  TX-TEXT-LINE                PIC X(70).
  1654
  1655     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1656         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1657         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1658         88  TX-VALID-FORM-SQUEEZE-VALUE
  1659                                        VALUE 'Y' ' '.
  1660
  1661     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1662         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1663         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1664         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1665         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1666         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1667         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1668         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1669                                              'K' 'N' ' '
  1670                                              'Z'.
  1671
  1672     12  TX-ARCHIVE-SW               PIC X.
  1673         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1674         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1675         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1676
  1677     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1678     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1679
  1680     12  TX-BSR-CODE                 PIC X.
  1681         88  TX-BSR-LETTER              VALUE 'B'.
  1682         88  TX-NON-BSR-LETTER          VALUE ' '.
  1683
  1684     12  FILLER                      PIC X.
  1685*****************************************************************
  1686*                                    COPY ELCENCC.
  1687******************************************************************
  1688*                                                                *
  1689*                                                                *
  1690*                            ELCENCC                             *
  1691*                            VMOD=2.001                          *
  1692*                                                                *
  1693*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  1694*                                                                *
  1695*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  31
* EL1044.cbl
  1696*   A NAPERSOFT DOCUMENT                                         *
  1697*                                                                *
  1698*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  1699*                                                                *
  1700*   FILE TYPE = VSAM,KSDS                                        *
  1701*   RECORD SIZE = 400   RECFORM = FIX                            *
  1702*                                                                *
  1703*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  1704*                                                                *
  1705*   LOG = NO                                                     *
  1706*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1707*                                                                *
  1708*                                                                *
  1709******************************************************************
  1710*                   C H A N G E   L O G
  1711*
  1712* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1713*-----------------------------------------------------------------
  1714*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1715* EFFECTIVE    NUMBER
  1716*-----------------------------------------------------------------
  1717* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  1718* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  1719******************************************************************
  1720 01  ENCLOSURE-CODES.
  1721     12  NC-RECORD-ID                      PIC XX.
  1722         88  VALID-NC-ID                      VALUE 'NC'.
  1723     12  NC-CONTROL-PRIMARY.
  1724         16  NC-COMPANY-CD                 PIC X.
  1725         16  NC-REC-TYPE                   PIC X.
  1726             88  NC-CLAIMS                   VALUE '1'.
  1727             88  NC-ADMIN                    VALUE '2'.
  1728         16  NC-ENC-CODE                   PIC X(5).
  1729         16  FILLER                        PIC X(09).
  1730     12  NC-MAINT-INFORMATION.
  1731         16  NC-LAST-MAINT-DT              PIC XX.
  1732         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1733         16  NC-LAST-MAINT-USER            PIC X(4).
  1734         16  FILLER                        PIC XX.
  1735     12  NC-OUTPUT-STACK                   PIC XXX.
  1736     12  NC-ENCLOSURE-LINE                 PIC X(100).
  1737     12  NC-ATTACHMENTS                    PIC X(255).
  1738     12  NC-FUTURE                         PIC X(12).
  1739******************************************************************
  1740 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA TEXT-FILES
  1741                          ENCLOSURE-CODES.
  1742 0000-DFHEXIT SECTION.
  1743     MOVE '9#                    $   ' TO DFHEIV0.
  1744     MOVE 'EL1044' TO DFHEIV1.
  1745     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1746     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1747     MOVE '5'                    TO DC-OPTION-CODE
  1748     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  1749     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  1750     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  1751     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  1752     IF EIBCALEN = 0
  1753        GO TO 8800-UNAUTHORIZED-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  32
* EL1044.cbl
  1754     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  1755     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  1756     MOVE 1                      TO EMI-NUMBER-OF-LINES
  1757
  1758* EXEC CICS HANDLE CONDITION
  1759*        DUPREC     (8850-DUPREC)
  1760*        NOTOPEN    (8870-NOTOPEN)
  1761*        NOTFND     (8880-NOT-FOUND)
  1762*        PGMIDERR   (9600-PGMID-ERROR)
  1763*        ERROR      (9990-ABEND)
  1764*    END-EXEC.
  1765*    MOVE '"$%JIL.               ! " #00001753' TO DFHEIV0
  1766     MOVE X'2224254A494C2E2020202020' TO DFHEIV0(1:12)
  1767     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1768     MOVE X'2220233030303031373533' TO DFHEIV0(25:11)
  1769     CALL 'kxdfhei1' USING DFHEIV0
  1770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1771
  1772     .
  1773 0150-SET-PROGRAM-SAVES.
  1774     IF PI-CALLING-PROGRAM NOT EQUAL THIS-PGM
  1775         IF PI-RETURN-TO-PROGRAM NOT EQUAL THIS-PGM
  1776             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1777             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1778             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1779             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1780             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1781             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1782             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1783             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1784         ELSE
  1785             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1786             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1787             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1788             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1789             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1790             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1791             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1792             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  1793     ELSE
  1794         GO TO 0200-RECEIVE.
  1795*    DISPLAY ' COMM KEY PASSED ' PI-COMM-CONTROL
  1796     MOVE PI-COMPANY-CD          TO ELLETR-KEY
  1797     MOVE PI-COMM-CONTROL        TO ELLETR-KEY (2:12)
  1798     MOVE ZEROS                  TO ELLETR-SEQ-NO
  1799     MOVE ELLETR-KEY             TO PI-CURR-LETR-KEY
  1800                                    PI-PREV-LETR-KEY
  1801
  1802     PERFORM 6500-BUILD-CURRENT-CODES THRU 6500-EXIT
  1803
  1804     GO TO 1000-SHOW-LETR-RECORD
  1805     .
  1806 0200-RECEIVE.
  1807     IF EIBAID = DFHCLEAR
  1808        GO TO 9400-CLEAR.
  1809     IF EIBAID EQUAL DFHPA1 OR DFHPA2 OR DFHPA3
  1810         MOVE LOW-VALUES             TO  EL1044ZI
  1811         MOVE ER-7008                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  33
* EL1044.cbl
  1812         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1813         MOVE -1                     TO  MAINTL
  1814         GO TO 8200-SEND-DATAONLY.
  1815     IF PI-PROCESSOR-ID EQUAL 'LGXX'
  1816         NEXT SENTENCE
  1817     ELSE
  1818
  1819* EXEC CICS READQ TS
  1820*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  1821*            INTO   (SECURITY-CONTROL)
  1822*            LENGTH (SC-COMM-LENGTH)
  1823*            ITEM   (SC-ITEM)
  1824*        END-EXEC
  1825*    MOVE '*$II   L              ''   #00001806' TO DFHEIV0
  1826     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1827     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1828     MOVE X'2020233030303031383036' TO DFHEIV0(25:11)
  1829     CALL 'kxdfhei1' USING DFHEIV0,
  1830           PI-SECURITY-TEMP-STORE-ID,
  1831           SECURITY-CONTROL,
  1832           SC-COMM-LENGTH,
  1833           SC-ITEM,
  1834           DFHEIV99,
  1835           DFHEIV99
  1836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1837         MOVE SC-CREDIT-DISPLAY (3)  TO  PI-DISPLAY-CAP
  1838         MOVE SC-CREDIT-UPDATE  (3)  TO  PI-MODIFY-CAP.
  1839
  1840* EXEC CICS RECEIVE
  1841*        MAP      (WS-MAP-NAME)
  1842*        MAPSET   (MAPSET-NAME)
  1843*        INTO     (EL1044ZI)
  1844*    END-EXEC
  1845     MOVE LENGTH OF
  1846      EL1044ZI
  1847       TO DFHEIV11
  1848*    MOVE '8"T I  L              ''   #00001814' TO DFHEIV0
  1849     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1850     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1851     MOVE X'2020233030303031383134' TO DFHEIV0(25:11)
  1852     CALL 'kxdfhei1' USING DFHEIV0,
  1853           WS-MAP-NAME,
  1854           EL1044ZI,
  1855           DFHEIV11,
  1856           MAPSET-NAME,
  1857           DFHEIV99,
  1858           DFHEIV99
  1859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1860     IF PFKEYL = +0
  1861         GO TO 0300-CHECK-PFKEYS.
  1862     IF (PFKEYI NUMERIC) AND (PFKEYI GREATER 0 AND LESS 25)
  1863         MOVE PF-VALUES (PFKEYI)     TO  EIBAID
  1864     ELSE
  1865         MOVE ER-0029                TO  EMI-ERROR
  1866         GO TO 0320-INPUT-ERROR.
  1867 0300-CHECK-PFKEYS.
  1868     IF EIBAID EQUAL DFHPF23
  1869         GO TO 8810-PF23.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  34
* EL1044.cbl
  1870     IF EIBAID EQUAL DFHPF24
  1871         GO TO 9200-RETURN-MAIN-MENU.
  1872     IF EIBAID EQUAL DFHPF12
  1873         GO TO 9500-PF12.
  1874     IF (MAINTL <> 0) AND (EIBAID <> DFHENTER)
  1875         MOVE ER-0050            TO EMI-ERROR
  1876         GO TO 0320-INPUT-ERROR.
  1877     IF EIBAID EQUAL DFHENTER
  1878         GO TO 0330-EDIT-DATA.
  1879     MOVE ER-0029                    TO  EMI-ERROR.
  1880 0320-INPUT-ERROR.
  1881     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1882     MOVE AL-UNBON                   TO  PFKEYA.
  1883     MOVE -1                         TO  PFKEYL.
  1884     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  35
* EL1044.cbl
  1886 0330-EDIT-DATA.
  1887     IF NOT DISPLAY-CAP
  1888         MOVE 'READ'                 TO  SM-READ
  1889         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1890         MOVE ER-0070                TO  EMI-ERROR
  1891         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1892         MOVE -1                     TO  MAINTL
  1893         GO TO 8100-SEND-INITIAL-MAP.
  1894     IF MAINTI EQUAL 'S'
  1895        GO TO 1000-SHOW-LETR-RECORD.
  1896     IF MAINTI = 'C' OR 'A'
  1897        IF NOT MODIFY-CAP
  1898           PERFORM 9995-SECURITY-VIOLATION
  1899                                 THRU 9995-EXIT
  1900           MOVE ER-0070          TO EMI-ERROR
  1901           PERFORM 9900-ERROR-FORMAT
  1902                                 THRU 9900-EXIT
  1903           MOVE LOW-VALUES       TO EL1044ZO
  1904           MOVE -1               TO MAINTL
  1905           GO TO 8100-SEND-INITIAL-MAP
  1906        END-IF
  1907     END-IF
  1908     IF MAINTI = 'C'
  1909        GO TO 2000-CHANGE-LETR-RECORD
  1910     END-IF
  1911     IF MAINTI = 'A'
  1912        GO TO 3000-ADD-LETR-RECORD
  1913     END-IF
  1914     MOVE ER-0023                    TO  EMI-ERROR.
  1915     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1916     MOVE -1                         TO  MAINTL.
  1917     MOVE AL-UABON                   TO  MAINTA.
  1918     GO TO 8200-SEND-DATAONLY.
  1919 1000-SHOW-LETR-RECORD.
  1920     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1921
  1922* EXEC CICS STARTBR
  1923*        DATASET   (ELLETR-FILE-ID)
  1924*        RIDFLD    (ELLETR-KEY)
  1925*        GTEQ
  1926*        RESP      (WS-RESPONSE)
  1927*    END-EXEC
  1928     MOVE 0
  1929       TO DFHEIV11
  1930*    MOVE '&,         G          &  N#00001882' TO DFHEIV0
  1931     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1932     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1933     MOVE X'204E233030303031383832' TO DFHEIV0(25:11)
  1934     CALL 'kxdfhei1' USING DFHEIV0,
  1935           ELLETR-FILE-ID,
  1936           ELLETR-KEY,
  1937           DFHEIV99,
  1938           DFHEIV11,
  1939           DFHEIV99
  1940     MOVE EIBRESP  TO WS-RESPONSE
  1941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1942     IF RESP-NORMAL
  1943        PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  36
* EL1044.cbl
  1944           OR WE-FOUND-IT
  1945
  1946* EXEC CICS READNEXT
  1947*              DATASET    (ELLETR-FILE-ID)
  1948*              SET        (ADDRESS OF TEXT-FILES)
  1949*              RIDFLD     (ELLETR-KEY)
  1950*              RESP       (WS-RESPONSE)
  1951*          END-EXEC
  1952     MOVE 0
  1953       TO DFHEIV11
  1954*    MOVE '&.S                   )  N#00001891' TO DFHEIV0
  1955     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1956     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1957     MOVE X'204E233030303031383931' TO DFHEIV0(25:11)
  1958     CALL 'kxdfhei1' USING DFHEIV0,
  1959           ELLETR-FILE-ID,
  1960           DFHEIV20,
  1961           DFHEIV99,
  1962           ELLETR-KEY,
  1963           DFHEIV99,
  1964           DFHEIV11,
  1965           DFHEIV99,
  1966           DFHEIV99
  1967     SET ADDRESS OF TEXT-FILES TO
  1968         DFHEIV20
  1969     MOVE EIBRESP  TO WS-RESPONSE
  1970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1971           IF (RESP-NORMAL)
  1972              AND (TX-LETTER-NO = PI-COMM-CONTROL (1:4))
  1973              IF (TX-LINE-SQUEEZE-CONTROL = 'Z')
  1974                 SET WE-FOUND-IT   TO TRUE
  1975              END-IF
  1976           ELSE
  1977              SET I-SAY-TO-STOP  TO TRUE
  1978           END-IF
  1979        END-PERFORM
  1980     END-IF
  1981     IF WE-FOUND-IT
  1982        MOVE TX-CONTROL-PRIMARY  TO PI-CURR-LETR-KEY
  1983                                    PI-PREV-LETR-KEY
  1984        GO TO 7000-BUILD-OUTPUT-MAP
  1985     END-IF
  1986     MOVE ER-0418                TO EMI-ERROR.
  1987     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  1988     MOVE -1                     TO MAINTL
  1989     MOVE 'A'                    TO MAINTI
  1990     MOVE AL-UANON               TO MAINTA
  1991     MOVE PI-COMM-CONTROL (1:4)  TO ZLETRI
  1992     MOVE +4                     TO ZLETRL
  1993     MOVE AL-UANON               TO ZLETRA
  1994     GO TO 8100-SEND-INITIAL-MAP
  1995     .
  1996 2000-CHANGE-LETR-RECORD.
  1997*    display ' curr   ' pi-curr-letr-key
  1998*    display ' prev   ' pi-prev-letr-key
  1999     IF PI-CURR-LETR-KEY NOT = PI-PREV-LETR-KEY
  2000        MOVE ER-0145             TO EMI-ERROR
  2001        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  37
* EL1044.cbl
  2002        MOVE -1                  TO MAINTL
  2003        GO TO 8200-SEND-DATAONLY
  2004     END-IF
  2005     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  2006     IF NOT EMI-NO-ERRORS
  2007         GO TO 8200-SEND-DATAONLY.
  2008     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  2009     .
  2010 2000-CHANGE-CONTINUE.
  2011
  2012* EXEC CICS READ
  2013*        DATASET    (ELLETR-FILE-ID)
  2014*        SET        (ADDRESS OF TEXT-FILES)
  2015*        RIDFLD     (ELLETR-KEY)
  2016*        UPDATE
  2017*        RESP       (WS-RESPONSE)
  2018*    END-EXEC
  2019*    MOVE '&"S        EU         (  N#00001938' TO DFHEIV0
  2020     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2021     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2022     MOVE X'204E233030303031393338' TO DFHEIV0(25:11)
  2023     CALL 'kxdfhei1' USING DFHEIV0,
  2024           ELLETR-FILE-ID,
  2025           DFHEIV20,
  2026           DFHEIV99,
  2027           ELLETR-KEY,
  2028           DFHEIV99,
  2029           DFHEIV99,
  2030           DFHEIV99
  2031     SET ADDRESS OF TEXT-FILES TO
  2032         DFHEIV20
  2033     MOVE EIBRESP  TO WS-RESPONSE
  2034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2035     IF RESP-NOTFND
  2036        IF ELLETR-SEQ-NO = +0
  2037           GO TO 2000-CONTINUE-CHANGE
  2038        END-IF
  2039     END-IF
  2040     IF TX-LAST-MAINTENANCED-BY NOT = PI-UPDATE-BY OR
  2041        TX-LAST-MAINTENANCED-DT NOT = PI-UPDATE-DT
  2042
  2043* EXEC CICS UNLOCK
  2044*            DATASET   (ELLETR-FILE-ID)
  2045*        END-EXEC
  2046*    MOVE '&*                    #   #00001952' TO DFHEIV0
  2047     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  2048     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2049     MOVE X'2020233030303031393532' TO DFHEIV0(25:11)
  2050     CALL 'kxdfhei1' USING DFHEIV0,
  2051           ELLETR-FILE-ID,
  2052           DFHEIV99
  2053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2054         MOVE ER-0068                TO  EMI-ERROR
  2055         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2056         GO TO 1000-SHOW-LETR-RECORD.
  2057     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  2058     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
  2059     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  38
* EL1044.cbl
  2060     IF ZCOPIESL > +0
  2061        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  2062     END-IF
  2063     IF ZFADAYSL > +0
  2064        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  2065     END-IF
  2066     IF ZRDAYSL > +0
  2067        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  2068     END-IF
  2069     IF ZFORML > +0
  2070        MOVE ZFORMI              TO W-FORM-TO-RESEND
  2071     END-IF
  2072     IF ZPROMPTL > +0
  2073        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  2074     END-IF
  2075     IF ZENCCDL > +0
  2076        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  2077     END-IF
  2078     IF ZACLOSEL > +0
  2079        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  2080     END-IF
  2081     IF ZBENEL > +0
  2082        MOVE ZBENEI              TO W-LETTER-TO-BENE
  2083     END-IF
  2084     IF ZACCTL > +0
  2085        MOVE ZACCTI              TO W-LETTER-TO-ACCT
  2086     END-IF
  2087     IF ZTYPEL > +0
  2088        MOVE ZTYPEI              TO W-LETTER-TYPE
  2089     END-IF
  2090     IF ZPRTCRTL > +0
  2091        MOVE ZPRTCRTI            TO W-PRINT-CERTIFICATE
  2092     END-IF
  2093     IF ZREFREQL > +0
  2094        MOVE ZREFREQI            TO W-REFUND-REQUIRED
  2095     END-IF
  2096     IF ZONBASEL > +0
  2097         MOVE ZONBASEI           TO W-ONBASE-CODE
  2098     END-IF
  2099
  2100     IF ZACTSUML > +0
  2101         MOVE ZACTSUMI           TO W-ACCT-SUMM
  2102     END-IF
  2103
  2104     IF ZCSOSUML > +0
  2105         MOVE ZCSOSUMI           TO W-CSO-SUMM
  2106     END-IF
  2107
  2108     IF ZREASONL > +0
  2109        MOVE ZREASONI            TO W-REASONS-REQUIRED
  2110     END-IF
  2111
  2112     IF ZBARCODL > +0
  2113        MOVE ZBARCODI            TO W-ADD-BAR-CODE
  2114     END-IF
  2115
  2116     IF ZRETENVL > +0
  2117        MOVE ZRETENVI            TO W-HAS-RETURN-ENV
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  39
* EL1044.cbl
  2118     END-IF
  2119
  2120     IF ZSIGFLGL > +0
  2121        MOVE ZSIGFLGI            TO W-SIG-FLAG-DEFAULT
  2122     END-IF
  2123     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  2124     .
  2125 2000-CONTINUE-CHANGE.
  2126
  2127* EXEC CICS REWRITE
  2128*        DATASET   (ELLETR-FILE-ID)
  2129*        FROM      (TEXT-FILES)
  2130*    END-EXEC.
  2131     MOVE LENGTH OF
  2132      TEXT-FILES
  2133       TO DFHEIV11
  2134*    MOVE '&& L                  %   #00002028' TO DFHEIV0
  2135     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2136     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2137     MOVE X'2020233030303032303238' TO DFHEIV0(25:11)
  2138     CALL 'kxdfhei1' USING DFHEIV0,
  2139           ELLETR-FILE-ID,
  2140           TEXT-FILES,
  2141           DFHEIV11,
  2142           DFHEIV99
  2143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2144
  2145     MOVE ER-0000                    TO  EMI-ERROR.
  2146     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2147     GO TO 1000-SHOW-LETR-RECORD
  2148     .
  2149 3000-ADD-LETR-RECORD.
  2150*    display ' curr   ' pi-curr-letr-key
  2151*    display ' prev   ' pi-prev-letr-key
  2152     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  2153     .
  2154 3000-CONTINUE-ADD.
  2155     IF NOT EMI-NO-ERRORS
  2156        GO TO 8200-SEND-DATAONLY
  2157     END-IF
  2158     MOVE SPACES                 TO ELLETR-KEY
  2159     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD
  2160     MOVE ZLETRI                 TO ELLETR-ACCESS-CD
  2161     MOVE +0                     TO ELLETR-SEQ-NO
  2162
  2163* EXEC CICS READ
  2164*        DATASET    (ELLETR-FILE-ID)
  2165*        SET        (ADDRESS OF TEXT-FILES)
  2166*        RIDFLD     (ELLETR-KEY)
  2167*        GTEQ
  2168*        RESP       (WS-RESPONSE)
  2169*    END-EXEC
  2170*    MOVE '&"S        G          (  N#00002050' TO DFHEIV0
  2171     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  2172     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2173     MOVE X'204E233030303032303530' TO DFHEIV0(25:11)
  2174     CALL 'kxdfhei1' USING DFHEIV0,
  2175           ELLETR-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  40
* EL1044.cbl
  2176           DFHEIV20,
  2177           DFHEIV99,
  2178           ELLETR-KEY,
  2179           DFHEIV99,
  2180           DFHEIV99,
  2181           DFHEIV99
  2182     SET ADDRESS OF TEXT-FILES TO
  2183         DFHEIV20
  2184     MOVE EIBRESP  TO WS-RESPONSE
  2185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2186     IF RESP-NORMAL
  2187        IF TX-LETTER-NO = ZLETRI
  2188           IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  2189              MOVE ER-0132       TO EMI-ERROR
  2190              PERFORM 9900-ERROR-FORMAT
  2191                                 THRU 9900-EXIT
  2192              MOVE -1            TO ZLETRL
  2193              MOVE AL-UABON      TO ZLETRA
  2194              GO TO 8200-SEND-DATAONLY
  2195           ELSE
  2196              MOVE +0            TO WS-SEQ-NO-TO-USE
  2197           END-IF
  2198        ELSE
  2199           MOVE +1               TO WS-SEQ-NO-TO-USE
  2200        END-IF
  2201     ELSE
  2202        MOVE +1                  TO WS-SEQ-NO-TO-USE
  2203     END-IF
  2204
  2205* EXEC CICS GETMAIN
  2206*       SET(ADDRESS OF TEXT-FILES)
  2207*       LENGTH(ELLETR-LENGTH)
  2208*    END-EXEC
  2209*    MOVE '," L                  $   #00002075' TO DFHEIV0
  2210     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  2211     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2212     MOVE X'2020233030303032303735' TO DFHEIV0(25:11)
  2213     CALL 'kxdfhei1' USING DFHEIV0,
  2214           DFHEIV20,
  2215           ELLETR-LENGTH,
  2216           DFHEIV99
  2217     SET ADDRESS OF TEXT-FILES TO
  2218         DFHEIV20
  2219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2220     MOVE SPACES                 TO TEXT-FILES
  2221     MOVE 'TL'                   TO TEXT-FILE-ID
  2222     MOVE PI-COMPANY-CD          TO TX-COMPANY-CD
  2223     MOVE ZLETRI                 TO TX-LETTER-NO
  2224     MOVE WS-SEQ-NO-TO-USE       TO TX-LINE-SEQUENCE
  2225     MOVE 'Z'                    TO TX-LINE-SQUEEZE-CONTROL
  2226     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  2227     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
  2228     MOVE SPACES                 TO W-Z-CONTROL-DATA
  2229     IF ZCOPIESL > +0
  2230        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  2231     ELSE
  2232        MOVE 1                   TO W-NUMBER-OF-COPIES
  2233     END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  41
* EL1044.cbl
  2234     IF ZFADAYSL > +0
  2235        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  2236     END-IF
  2237     IF ZRDAYSL > +0
  2238        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  2239     ELSE
  2240        MOVE ZEROS               TO W-DAYS-TO-RESEND
  2241     END-IF
  2242     IF ZFORML > +0
  2243        MOVE ZFORMI              TO W-FORM-TO-RESEND
  2244     END-IF
  2245     IF ZPROMPTL > +0
  2246        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  2247     END-IF
  2248     IF ZENCCDL > +0
  2249        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  2250     END-IF
  2251     IF ZACLOSEL > +0
  2252        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  2253     END-IF
  2254     IF ZBENEL > +0
  2255        MOVE ZBENEI              TO W-LETTER-TO-BENE
  2256     END-IF
  2257     IF ZACCTL > +0
  2258        MOVE ZACCTI              TO W-LETTER-TO-ACCT
  2259     END-IF
  2260     IF ZTYPEL > +0
  2261        MOVE ZTYPEI              TO W-LETTER-TYPE
  2262     END-IF
  2263     IF ZPRTCRTL > +0
  2264        MOVE ZPRTCRTI            TO W-PRINT-CERTIFICATE
  2265     END-IF
  2266     IF ZREFREQL > +0
  2267        MOVE ZREFREQI            TO W-REFUND-REQUIRED
  2268     END-IF
  2269     IF ZONBASEL > +0
  2270        MOVE ZONBASEI            TO W-ONBASE-CODE
  2271     END-IF
  2272
  2273     IF ZACTSUML > +0
  2274         MOVE ZACTSUMI           TO W-ACCT-SUMM
  2275     END-IF
  2276
  2277     IF ZCSOSUML > +0
  2278         MOVE ZCSOSUMI           TO W-CSO-SUMM
  2279     END-IF
  2280
  2281     IF ZREASONL > +0
  2282        MOVE ZREASONI            TO W-REASONS-REQUIRED
  2283     END-IF
  2284
  2285     IF ZBARCODL > +0
  2286        MOVE ZBARCODI            TO W-ADD-BAR-CODE
  2287     END-IF
  2288
  2289     IF ZRETENVL > +0
  2290        MOVE ZRETENVI            TO W-HAS-RETURN-ENV
  2291     END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  42
* EL1044.cbl
  2292
  2293     IF ZSIGFLGL > +0
  2294        MOVE ZSIGFLGI            TO W-SIG-FLAG-DEFAULT
  2295     END-IF
  2296     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  2297     MOVE TX-CONTROL-PRIMARY     TO ELLETR-KEY
  2298                                    PI-CURR-LETR-KEY
  2299                                    PI-PREV-LETR-KEY
  2300
  2301* EXEC CICS WRITE
  2302*       DATASET (ELLETR-FILE-ID)
  2303*       FROM    (TEXT-FILES)
  2304*       RIDFLD  (ELLETR-KEY)
  2305*    END-EXEC
  2306     MOVE LENGTH OF
  2307      TEXT-FILES
  2308       TO DFHEIV11
  2309*    MOVE '&$ L                  ''   #00002160' TO DFHEIV0
  2310     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2311     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2312     MOVE X'2020233030303032313630' TO DFHEIV0(25:11)
  2313     CALL 'kxdfhei1' USING DFHEIV0,
  2314           ELLETR-FILE-ID,
  2315           TEXT-FILES,
  2316           DFHEIV11,
  2317           ELLETR-KEY,
  2318           DFHEIV99,
  2319           DFHEIV99
  2320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2321     MOVE ER-0000                    TO  EMI-ERROR.
  2322     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2323     GO TO 1000-SHOW-LETR-RECORD
  2324     .
  2325 5000-FIND-NEXT-PROD-RECORD.
  2326*    MOVE PI-PROD-KEY            TO ELLETR-KEY
  2327*
  2328*    EXEC CICS STARTBR
  2329*        DATASET   (ELLETR-FILE-ID)
  2330*        RIDFLD    (ELLETR-KEY)
  2331*        GTEQ
  2332*        RESP      (WS-RESPONSE)
  2333*    END-EXEC
  2334*
  2335*    IF NOT RESP-NORMAL
  2336*       MOVE -1                  TO PFKEYL
  2337*       MOVE ER-0130             TO EMI-ERROR
  2338*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2339*       GO TO 8200-SEND-DATAONLY
  2340*    END-IF
  2341     .
  2342 5000-READNEXT-LOOP.
  2343*    EXEC CICS READNEXT
  2344*        DATASET   (ELLETR-FILE-ID)
  2345*        SET       (ADDRESS OF PRODUCT-MASTER)
  2346*        RIDFLD    (ELLETR-KEY)
  2347*        RESP      (WS-RESPONSE)
  2348*    END-EXEC
  2349*
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  43
* EL1044.cbl
  2350*    IF (NOT RESP-NORMAL)
  2351*       OR (PD-COMPANY-CD NOT = PI-COMPANY-CD)
  2352*       PERFORM 5000-END-BROWSE
  2353*       MOVE -1                  TO PFKEYL
  2354*       MOVE ER-0130             TO EMI-ERROR
  2355*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2356*       GO TO 1000-SHOW-LETR-RECORD
  2357*    END-IF
  2358*
  2359*    IF ELLETR-KEY = PI-PREV-LETR-KEY
  2360*       GO TO 5000-READNEXT-LOOP
  2361*    END-IF
  2362*
  2363*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2364*
  2365*    PERFORM 5000-END-BROWSE
  2366*    GO TO 7000-BUILD-OUTPUT-MAP
  2367     .
  2368 5000-END-BROWSE.
  2369*    EXEC CICS ENDBR
  2370*        DATASET   (ELLETR-FILE-ID)
  2371*    END-EXEC
  2372     .
  2373 5100-FIND-PREV-PROD-RECORD.
  2374*    MOVE PI-PREV-LETR-KEY       TO ELLETR-KEY
  2375*    IF STATEL > +0
  2376*       MOVE STATEI              TO ELLETR-STATE
  2377*    END-IF
  2378*    IF PRODCDL > +0
  2379*       MOVE PRODCDI             TO ELLETR-PROD-CD
  2380*    END-IF
  2381*    IF BENTYPL > +0
  2382*        MOVE BENTYPI                TO  ELLETR-BEN-TYPE.
  2383*    IF BENCODEL > +0
  2384*        MOVE BENCODEI               TO  ELLETR-BEN-CODE.
  2385*    IF EXPDTL IS GREATER THAN +0
  2386*        MOVE EXPDTI                 TO  DEEDIT-FIELD
  2387*        PERFORM 8600-DEEDIT THRU 8600-EXIT
  2388*        IF WS-NUMVAL-OF-DEEDIT >= 999999
  2389*            MOVE HIGH-VALUES        TO  ELLETR-EXP-DT
  2390*        ELSE
  2391*          STRING WS-NUMVAL (8:4) WS-NUMVAL (4:2) WS-NUMVAL (6:12)
  2392*             DELIMITED BY SIZE INTO DC-GREG-DATE-CYMD
  2393*          END-STRING
  2394*           MOVE 'L'                    TO  DC-OPTION-CODE
  2395*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  2396*            IF NO-CONVERSION-ERROR
  2397*                MOVE DC-BIN-DATE-1  TO  ELLETR-EXP-DT
  2398*            ELSE
  2399*                MOVE LOW-VALUES     TO  ELLETR-EXP-DT.
  2400*
  2401*    EXEC CICS HANDLE CONDITION
  2402*        ENDFILE (5100-UNSUCCESSFUL-SEARCH)
  2403*    END-EXEC.
  2404*
  2405*    EXEC CICS STARTBR
  2406*        DATASET   (ELLETR-FILE-ID)
  2407*        RIDFLD    (ELLETR-KEY)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  44
* EL1044.cbl
  2408*        GTEQ
  2409*    END-EXEC.
  2410 5100-READPREV-LOOP.
  2411*    EXEC CICS READPREV
  2412*        DATASET   (ELLETR-FILE-ID)
  2413*        SET       (ADDRESS OF PRODUCT-MASTER)
  2414*        RIDFLD    (ELLETR-KEY)
  2415*    END-EXEC.
  2416*
  2417*    IF PD-COMPANY-CD  NOT EQUAL PI-COMPANY-CD
  2418*        GO TO 5100-UNSUCCESSFUL-SEARCH.
  2419*
  2420*    IF ELLETR-KEY IS EQUAL TO PI-PREV-LETR-KEY
  2421*        GO TO 5100-READPREV-LOOP.
  2422*
  2423*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2424*
  2425*    GO TO 7000-BUILD-OUTPUT-MAP.
  2426 5100-END-BROWSE.
  2427*    EXEC CICS ENDBR
  2428*        DATASET   (ELLETR-FILE-ID)
  2429*    END-EXEC.
  2430 5100-UNSUCCESSFUL-SEARCH.
  2431     PERFORM 5100-END-BROWSE.
  2432     MOVE ER-0131                    TO  EMI-ERROR.
  2433     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2434     GO TO 1000-SHOW-LETR-RECORD.
  2435     .
  2436 6000-EDIT-INPUT-DATA.
  2437     IF MAINTI = 'A'
  2438        IF ZLETRL > +0
  2439           AND ZLETRI NOT = SPACES
  2440           CONTINUE
  2441        ELSE
  2442           MOVE AL-UNBON         TO ZCOPIESA
  2443           MOVE -1               TO ZCOPIESL
  2444           MOVE ER-0005          TO EMI-ERROR
  2445           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2446        END-IF
  2447     END-IF
  2448     IF ZCOPIESL > +0
  2449        IF ZCOPIESI NUMERIC
  2450           CONTINUE
  2451        ELSE
  2452           MOVE AL-UNBON         TO ZCOPIESA
  2453           MOVE -1               TO ZCOPIESL
  2454           MOVE ER-0184          TO EMI-ERROR
  2455           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2456        END-IF
  2457     END-IF
  2458     IF ZFADAYSL > +0
  2459       IF ZFADAYSI NOT EQUAL SPACES
  2460          IF ZFADAYSI NUMERIC
  2461             CONTINUE
  2462          ELSE
  2463             MOVE AL-UNBON         TO ZFADAYSA
  2464             MOVE -1               TO ZFADAYSL
  2465             MOVE ER-0491          TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  45
* EL1044.cbl
  2466             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2467          END-IF
  2468       END-IF
  2469     END-IF
  2470     IF ZRDAYSL > +0
  2471       IF ZRDAYSI NOT EQUAL SPACES
  2472          IF ZRDAYSI NUMERIC
  2473             CONTINUE
  2474          ELSE
  2475             MOVE AL-UNBON         TO ZRDAYSA
  2476             MOVE -1               TO ZRDAYSL
  2477             MOVE ER-0491          TO EMI-ERROR
  2478             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2479          END-IF
  2480       END-IF
  2481     END-IF
  2482     IF ZPROMPTL > +0
  2483        IF ZPROMPTI = 'Y' OR 'N' OR ' '
  2484           CONTINUE
  2485        ELSE
  2486           MOVE AL-UABON         TO ZPROMPTA
  2487           MOVE -1               TO ZPROMPTL
  2488           MOVE ER-0627          TO EMI-ERROR
  2489           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2490        END-IF
  2491     END-IF
  2492     IF MAINTI = 'A'
  2493        AND ZENCCDL <= 0
  2494        MOVE AL-UABON            TO ZENCCDA
  2495        MOVE -1                  TO ZENCCDL
  2496        MOVE ER-1560             TO EMI-ERROR
  2497        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2498     END-IF
  2499     IF ZENCCDL > +0
  2500        IF ZENCCDI = '@'
  2501            CONTINUE
  2502        ELSE
  2503           MOVE SPACES             TO ELENCC-KEY
  2504           MOVE PI-COMPANY-CD      TO ELENCC-COMPANY-CD
  2505           MOVE '2'                TO ELENCC-REC-TYPE
  2506           MOVE ZENCCDI            TO ELENCC-ENC-CODE
  2507
  2508
  2509* EXEC CICS READ
  2510*              DATASET    (ELENCC-FILE-ID)
  2511*              SET        (ADDRESS OF ENCLOSURE-CODES)
  2512*              RIDFLD     (ELENCC-KEY)
  2513*              RESP       (WS-RESPONSE)
  2514*          END-EXEC
  2515*    MOVE '&"S        E          (  N#00002352' TO DFHEIV0
  2516     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2517     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2518     MOVE X'204E233030303032333532' TO DFHEIV0(25:11)
  2519     CALL 'kxdfhei1' USING DFHEIV0,
  2520           ELENCC-FILE-ID,
  2521           DFHEIV20,
  2522           DFHEIV99,
  2523           ELENCC-KEY,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  46
* EL1044.cbl
  2524           DFHEIV99,
  2525           DFHEIV99,
  2526           DFHEIV99
  2527     SET ADDRESS OF ENCLOSURE-CODES TO
  2528         DFHEIV20
  2529     MOVE EIBRESP  TO WS-RESPONSE
  2530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2531
  2532           IF RESP-NORMAL
  2533              CONTINUE
  2534           ELSE
  2535              MOVE AL-UABON         TO ZENCCDA
  2536              MOVE -1               TO ZENCCDL
  2537              MOVE ER-1560          TO EMI-ERROR
  2538              PERFORM 9900-ERROR-FORMAT
  2539                                 THRU 9900-EXIT
  2540           END-IF
  2541        END-IF
  2542     END-IF
  2543     IF MAINTI = 'A'
  2544        AND ZTYPEL <= 0
  2545        MOVE AL-UABON            TO ZTYPEA
  2546        MOVE -1                  TO ZTYPEL
  2547        MOVE ER-1564             TO EMI-ERROR
  2548        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2549     END-IF
  2550     IF ZTYPEL > +0
  2551        IF ZTYPEI = 'C' OR 'P' OR 'U' OR 'A'
  2552           CONTINUE
  2553        ELSE
  2554           MOVE -1               TO ZTYPEL
  2555           MOVE AL-UABON         TO ZTYPEA
  2556           MOVE ER-1564          TO EMI-ERROR
  2557           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2558        END-IF
  2559     END-IF
  2560     IF ZACLOSEL > +0
  2561        IF ZACLOSEI = 'S' OR 'C' OR 'B' OR ' '
  2562           CONTINUE
  2563        ELSE
  2564           MOVE -1               TO ZACLOSEL
  2565           MOVE AL-UABON         TO ZACLOSEA
  2566           MOVE ER-1562          TO EMI-ERROR
  2567           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2568        END-IF
  2569     END-IF
  2570     IF ZPRTCRTL > +0
  2571        IF ZPRTCRTI = 'Y' OR 'N' OR ' '
  2572           CONTINUE
  2573        ELSE
  2574           MOVE AL-UABON         TO ZPRTCRTA
  2575           MOVE -1               TO ZPRTCRTL
  2576           MOVE ER-0627          TO EMI-ERROR
  2577           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2578        END-IF
  2579     END-IF
  2580     IF ZREFREQL > +0
  2581        IF ZREFREQI = 'Y' OR 'N' OR ' '
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  47
* EL1044.cbl
  2582           CONTINUE
  2583        ELSE
  2584           MOVE AL-UABON         TO ZREFREQA
  2585           MOVE -1               TO ZREFREQL
  2586           MOVE ER-0627          TO EMI-ERROR
  2587           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2588        END-IF
  2589     END-IF
  2590     IF MAINTI = 'A'
  2591        AND ZONBASEL <= 0
  2592        MOVE AL-UABON            TO ZONBASEA
  2593        MOVE -1                  TO ZONBASEL
  2594        MOVE ER-3804             TO EMI-ERROR
  2595        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2596     END-IF
  2597     IF ZONBASEL > +0
  2598        IF ZONBASEI = ' '
  2599           MOVE AL-UABON            TO ZONBASEA
  2600           MOVE -1                  TO ZONBASEL
  2601           MOVE ER-3804             TO EMI-ERROR
  2602           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2603        END-IF
  2604     END-IF
  2605
  2606     IF ZACTSUML > +0
  2607        IF ZACTSUMI = '1' OR '2' OR '5' or ' '
  2608           CONTINUE
  2609        ELSE
  2610           MOVE AL-UABON         TO ZACTSUMA
  2611           MOVE -1               TO ZACTSUML
  2612           MOVE ER-3820          TO EMI-ERROR
  2613           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2614        END-IF
  2615     END-IF
  2616
  2617     IF ZCSOSUML > +0
  2618        IF ZCSOSUMI = '3' OR '4' OR ' '
  2619           CONTINUE
  2620        ELSE
  2621           MOVE AL-UABON         TO ZCSOSUMA
  2622           MOVE -1               TO ZCSOSUML
  2623           MOVE ER-3821          TO EMI-ERROR
  2624           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2625        END-IF
  2626     END-IF
  2627
  2628     IF ZREASONL > +0
  2629        IF ZREASONI = 'Y' OR 'N' OR ' '
  2630           CONTINUE
  2631        ELSE
  2632           MOVE AL-UABON         TO ZREASONA
  2633           MOVE -1               TO ZREASONL
  2634           MOVE ER-0627          TO EMI-ERROR
  2635           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2636        END-IF
  2637     END-IF
  2638
  2639     IF ZBARCODL > +0
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  48
* EL1044.cbl
  2640        IF ZBARCODI = 'Y' OR 'N' OR ' '
  2641           CONTINUE
  2642        ELSE
  2643           MOVE AL-UABON         TO ZBARCODA
  2644           MOVE -1               TO ZBARCODL
  2645           MOVE ER-0627          TO EMI-ERROR
  2646           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2647        END-IF
  2648     END-IF
  2649
  2650     IF ZRETENVL > +0
  2651        IF ZRETENVI = 'Y' OR 'N' OR ' '
  2652           CONTINUE
  2653        ELSE
  2654           MOVE AL-UABON         TO ZRETENVA
  2655           MOVE -1               TO ZRETENVL
  2656           MOVE ER-0627          TO EMI-ERROR
  2657           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2658        END-IF
  2659     END-IF
  2660
  2661     IF ZSIGFLGL > +0
  2662        IF ZSIGFLGI = 'Y' OR 'N' OR ' '
  2663           CONTINUE
  2664        ELSE
  2665           MOVE AL-UABON         TO ZSIGFLGA
  2666           MOVE -1               TO ZSIGFLGL
  2667           MOVE ER-0627          TO EMI-ERROR
  2668           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2669        END-IF
  2670     END-IF
  2671
  2672     .
  2673 6000-EXIT.
  2674     EXIT.
  2675
  2676
  2677 6500-BUILD-CURRENT-CODES.
  2678      MOVE SPACES             TO ELENCC-KEY
  2679      MOVE PI-COMPANY-CD      TO ELENCC-COMPANY-CD
  2680      MOVE '2'                TO ELENCC-REC-TYPE
  2681      MOVE LOW-VALUES         TO ELENCC-ENC-CODE
  2682      MOVE SPACES             TO HOLD-ENC-CODES
  2683      MOVE '@'                TO HOLD-ENC-CODES (1:1)
  2684      MOVE HOLD-ENC-CODES     TO PI-ENC-CODES
  2685
  2686
  2687* EXEC CICS STARTBR
  2688*        DATASET   (ELENCC-FILE-ID)
  2689*        RIDFLD    (ELENCC-KEY)
  2690*        GTEQ
  2691*        RESP      (WS-RESPONSE)
  2692*     END-EXEC
  2693     MOVE 0
  2694       TO DFHEIV11
  2695*    MOVE '&,         G          &  N#00002513' TO DFHEIV0
  2696     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2697     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  49
* EL1044.cbl
  2698     MOVE X'204E233030303032353133' TO DFHEIV0(25:11)
  2699     CALL 'kxdfhei1' USING DFHEIV0,
  2700           ELENCC-FILE-ID,
  2701           ELENCC-KEY,
  2702           DFHEIV99,
  2703           DFHEIV11,
  2704           DFHEIV99
  2705     MOVE EIBRESP  TO WS-RESPONSE
  2706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2707
  2708      IF RESP-NORMAL
  2709        PERFORM UNTIL DONE-WITH-ENCC
  2710           MOVE PI-ENC-CODES TO HOLD-ENC-CODES
  2711
  2712* EXEC CICS READNEXT
  2713*              DATASET    (ELENCC-FILE-ID)
  2714*              SET        (ADDRESS OF ENCLOSURE-CODES)
  2715*              RIDFLD     (ELENCC-KEY)
  2716*              RESP       (WS-RESPONSE)
  2717*          END-EXEC
  2718     MOVE 0
  2719       TO DFHEIV11
  2720*    MOVE '&.S                   )  N#00002523' TO DFHEIV0
  2721     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2722     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2723     MOVE X'204E233030303032353233' TO DFHEIV0(25:11)
  2724     CALL 'kxdfhei1' USING DFHEIV0,
  2725           ELENCC-FILE-ID,
  2726           DFHEIV20,
  2727           DFHEIV99,
  2728           ELENCC-KEY,
  2729           DFHEIV99,
  2730           DFHEIV11,
  2731           DFHEIV99,
  2732           DFHEIV99
  2733     SET ADDRESS OF ENCLOSURE-CODES TO
  2734         DFHEIV20
  2735     MOVE EIBRESP  TO WS-RESPONSE
  2736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2737           IF (RESP-NORMAL)
  2738              AND (ELENCC-COMPANY-CD = PI-COMPANY-CD)
  2739              AND (ELENCC-REC-TYPE = '2')
  2740                 PERFORM VARYING WS-SUB1 FROM 5 BY -1
  2741                      UNTIL ELENCC-ENC-CODE (WS-SUB1:1) <> ' '
  2742                 END-PERFORM
  2743                 IF WS-SUB1 > 2
  2744                     SUBTRACT +1 FROM WS-SUB1
  2745                 END-IF
  2746                 MOVE ELENCC-ENC-CODE (WS-SUB1:2) TO
  2747                             WS-TEST-STATE
  2748                 IF STATE-SPECIFIC AND
  2749                    ELENCC-ENC-CODE NOT = 'ENV'
  2750                    CONTINUE
  2751                 ELSE
  2752                    STRING HOLD-ENC-CODES DELIMITED BY ' '
  2753                         ','
  2754                         ELENCC-ENC-CODE DELIMITED BY ' '
  2755                    INTO PI-ENC-CODES
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  50
* EL1044.cbl
  2756                 END-IF
  2757           ELSE
  2758              SET DONE-WITH-ENCC  TO TRUE
  2759           END-IF
  2760        END-PERFORM
  2761     END-IF
  2762
  2763     MOVE +53 TO PI-SPLIT-SUB
  2764     PERFORM UNTIL PI-ENC-CODES (PI-SPLIT-SUB:1) = ' ' OR ','
  2765         SUBTRACT +1 FROM PI-SPLIT-SUB
  2766     END-PERFORM
  2767
  2768     .
  2769 6500-EXIT.
  2770     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  51
* EL1044.cbl
  2772 7000-BUILD-OUTPUT-MAP.
  2773     MOVE LOW-VALUES             TO EL1044ZO
  2774     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  2775     MOVE TX-LETTER-NO           TO ZLETRO
  2776     MOVE W-NUMBER-OF-COPIES     TO ZCOPIESO
  2777     MOVE W-DAYS-TO-FOLLOW-UP    TO ZFADAYSO
  2778     MOVE W-DAYS-TO-RESEND       TO ZRDAYSO
  2779     MOVE W-FORM-TO-RESEND       TO ZFORMO
  2780     MOVE W-PROMPT-LETTER        TO ZPROMPTO
  2781     MOVE W-ENCLOSURE-CD         TO ZENCCDO
  2782     MOVE W-AUTO-CLOSE-IND       TO ZACLOSEO
  2783     MOVE W-LETTER-TO-BENE       TO ZBENEO
  2784     MOVE W-LETTER-TO-ACCT       TO ZACCTO
  2785     MOVE W-LETTER-TYPE          TO ZTYPEO
  2786     MOVE W-PRINT-CERTIFICATE    TO ZPRTCRTO
  2787     MOVE W-REFUND-REQUIRED      TO ZREFREQO
  2788     MOVE W-ONBASE-CODE          TO ZONBASEO
  2789     MOVE W-ACCT-SUMM            TO ZACTSUMO
  2790     MOVE W-CSO-SUMM             TO ZCSOSUMO
  2791     MOVE W-REASONS-REQUIRED     TO ZREASONO
  2792     MOVE W-ADD-BAR-CODE         TO ZBARCODO
  2793     MOVE W-HAS-RETURN-ENV       TO ZRETENVO
  2794     MOVE W-SIG-FLAG-DEFAULT     TO ZSIGFLGO
  2795     MOVE PI-SPLIT-SUB           TO WS-SUB1
  2796     COMPUTE WS-SUB2 = PI-SPLIT-SUB + 1
  2797     COMPUTE WS-SUB3 = 120 - PI-SPLIT-SUB
  2798     MOVE PI-ENC-CODES (1:WS-SUB1) TO ZCODES1O
  2799     MOVE PI-ENC-CODES (WS-SUB2:WS-SUB3) TO ZCODES2O
  2800     MOVE TX-LAST-MAINTENANCED-BY TO LSTUSRO
  2801                                    PI-UPDATE-BY
  2802     MOVE TX-LAST-MAINTENANCED-DT TO PI-UPDATE-DT
  2803                                    DC-BIN-DATE-1
  2804     MOVE ' '                    TO DC-OPTION-CODE
  2805     MOVE +0                     TO DC-ELAPSED-DAYS
  2806                                     DC-ELAPSED-MONTHS.
  2807     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2808     IF NO-CONVERSION-ERROR
  2809        MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO
  2810     ELSE
  2811        MOVE LOW-VALUES          TO LSTDTEO
  2812     END-IF
  2813     MOVE -1                     TO MAINTL
  2814     .
  2815 8100-SEND-INITIAL-MAP.
  2816     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2817     MOVE EIBTIME                    TO  TIME-IN.
  2818     MOVE SAVE-DATE                  TO  DATEO.
  2819     MOVE TIME-OUT                   TO  TIMEO
  2820     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2821     MOVE PI-PROCESSOR-ID        TO USERIDO
  2822
  2823* EXEC CICS SEND
  2824*        MAP      (WS-MAP-NAME)
  2825*        MAPSET   (MAPSET-NAME)
  2826*        FROM     (EL1044ZO)
  2827*        ERASE
  2828*        CURSOR
  2829*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  52
* EL1044.cbl
  2830     MOVE LENGTH OF
  2831      EL1044ZO
  2832       TO DFHEIV12
  2833     MOVE -1
  2834       TO DFHEIV11
  2835*    MOVE '8$     CT  E    H L F ,   #00002614' TO DFHEIV0
  2836     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2837     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2838     MOVE X'2020233030303032363134' TO DFHEIV0(25:11)
  2839     CALL 'kxdfhei1' USING DFHEIV0,
  2840           WS-MAP-NAME,
  2841           EL1044ZO,
  2842           DFHEIV12,
  2843           MAPSET-NAME,
  2844           DFHEIV99,
  2845           DFHEIV99,
  2846           DFHEIV99,
  2847           DFHEIV11,
  2848           DFHEIV99,
  2849           DFHEIV99,
  2850           DFHEIV99
  2851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2852
  2853     MOVE '044Z'                 TO PI-CURRENT-SCREEN-NO
  2854     GO TO 9100-RETURN-TRAN
  2855     .
  2856 8200-SEND-DATAONLY.
  2857     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2858     MOVE EIBTIME                    TO  TIME-IN.
  2859     MOVE SAVE-DATE                  TO  DATEO.
  2860     MOVE TIME-OUT                   TO  TIMEO.
  2861     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2862     MOVE PI-PROCESSOR-ID        TO USERIDO
  2863
  2864* EXEC CICS SEND
  2865*        MAP      (WS-MAP-NAME)
  2866*        MAPSET   (MAPSET-NAME)
  2867*        FROM     (EL1044ZO)
  2868*        DATAONLY
  2869*        CURSOR
  2870*    END-EXEC.
  2871     MOVE LENGTH OF
  2872      EL1044ZO
  2873       TO DFHEIV12
  2874     MOVE -1
  2875       TO DFHEIV11
  2876*    MOVE '8$D    CT       H L F ,   #00002632' TO DFHEIV0
  2877     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2878     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2879     MOVE X'2020233030303032363332' TO DFHEIV0(25:11)
  2880     CALL 'kxdfhei1' USING DFHEIV0,
  2881           WS-MAP-NAME,
  2882           EL1044ZO,
  2883           DFHEIV12,
  2884           MAPSET-NAME,
  2885           DFHEIV99,
  2886           DFHEIV99,
  2887           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  53
* EL1044.cbl
  2888           DFHEIV11,
  2889           DFHEIV99,
  2890           DFHEIV99,
  2891           DFHEIV99
  2892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2893
  2894     GO TO 9100-RETURN-TRAN
  2895     .
  2896 8300-SEND-TEXT.
  2897
  2898* EXEC CICS SEND TEXT
  2899*        FROM  (LOGOFF-TEXT)
  2900*        LENGTH(LOGOFF-LENGTH)
  2901*        ERASE
  2902*        FREEKB
  2903*    END-EXEC.
  2904*    MOVE '8&      T  E F  H   F -   #00002642' TO DFHEIV0
  2905     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2906     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2907     MOVE X'2020233030303032363432' TO DFHEIV0(25:11)
  2908     CALL 'kxdfhei1' USING DFHEIV0,
  2909           LOGOFF-TEXT,
  2910           LOGOFF-LENGTH,
  2911           DFHEIV99,
  2912           DFHEIV99,
  2913           DFHEIV99,
  2914           DFHEIV99,
  2915           DFHEIV99,
  2916           DFHEIV99,
  2917           DFHEIV99,
  2918           DFHEIV99,
  2919           DFHEIV99,
  2920           DFHEIV99
  2921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2922
  2923
  2924* EXEC CICS RETURN
  2925*        END-EXEC.
  2926*    MOVE '.(                    ''   #00002648' TO DFHEIV0
  2927     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2928     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2929     MOVE X'2020233030303032363438' TO DFHEIV0(25:11)
  2930     CALL 'kxdfhei1' USING DFHEIV0,
  2931           DFHEIV99,
  2932           DFHEIV99,
  2933           DFHEIV99,
  2934           DFHEIV99,
  2935           DFHEIV99,
  2936           DFHEIV99
  2937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2938
  2939     .
  2940 8500-DEEDIT.
  2941     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2942                                 TO WS-9V999-OF-DEEDIT
  2943     .
  2944 8500-EXIT.
  2945     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  54
* EL1044.cbl
  2946 8600-DEEDIT.
  2947     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2948                                 TO WS-NUMVAL-OF-DEEDIT
  2949     .
  2950 8600-EXIT.
  2951     EXIT.
  2952 8800-UNAUTHORIZED-ACCESS.
  2953     MOVE UNACCESS-MSG               TO  LOGOFF-MSG.
  2954     GO TO 8300-SEND-TEXT.
  2955 8810-PF23.
  2956     MOVE EIBAID                     TO  PI-ENTRY-CD-1.
  2957     MOVE XCTL-005                   TO  PGM-NAME.
  2958     GO TO 9300-XCTL.
  2959 8850-DUPREC.
  2960     MOVE ER-0132                    TO  EMI-ERROR.
  2961     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2962     MOVE -1                         TO  MAINTL
  2963     MOVE AL-UABON                   TO  ZLETRA
  2964     GO TO 8100-SEND-INITIAL-MAP.
  2965 8870-NOTOPEN.
  2966     MOVE LOW-VALUES                 TO  EL1044ZO.
  2967     MOVE -1                         TO  MAINTL.
  2968     MOVE ER-0701                    TO  EMI-ERROR.
  2969     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2970     GO TO 8100-SEND-INITIAL-MAP.
  2971 8880-NOT-FOUND.
  2972     MOVE ER-0702                    TO  EMI-ERROR.
  2973     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2974     MOVE -1                         TO  MAINTL
  2975     MOVE AL-UABON                   TO  ZLETRA
  2976     GO TO 8100-SEND-INITIAL-MAP.
  2977     .
  2978 9100-RETURN-TRAN.
  2979     MOVE EMI-ERROR-NUMBER (1)       TO  PI-LAST-ERROR-NO.
  2980
  2981* EXEC CICS RETURN
  2982*        TRANSID    (TRANS-ID)
  2983*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2984*        LENGTH     (PI-COMM-LENGTH)
  2985*    END-EXEC.
  2986*    MOVE '.(CT                  ''   #00002691' TO DFHEIV0
  2987     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2988     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2989     MOVE X'2020233030303032363931' TO DFHEIV0(25:11)
  2990     CALL 'kxdfhei1' USING DFHEIV0,
  2991           TRANS-ID,
  2992           PROGRAM-INTERFACE-BLOCK,
  2993           PI-COMM-LENGTH,
  2994           DFHEIV99,
  2995           DFHEIV99,
  2996           DFHEIV99
  2997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2998
  2999 9200-RETURN-MAIN-MENU.
  3000     MOVE XCTL-626                   TO  PGM-NAME.
  3001     GO TO 9300-XCTL.
  3002 9300-XCTL.
  3003
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  55
* EL1044.cbl
  3004* EXEC CICS XCTL
  3005*        PROGRAM    (PGM-NAME)
  3006*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3007*        LENGTH     (PI-COMM-LENGTH)
  3008*    END-EXEC.
  3009*    MOVE '.$C                   %   #00002700' TO DFHEIV0
  3010     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3011     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3012     MOVE X'2020233030303032373030' TO DFHEIV0(25:11)
  3013     CALL 'kxdfhei1' USING DFHEIV0,
  3014           PGM-NAME,
  3015           PROGRAM-INTERFACE-BLOCK,
  3016           PI-COMM-LENGTH,
  3017           DFHEIV99
  3018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3019
  3020 9400-CLEAR.
  3021     MOVE PI-RETURN-TO-PROGRAM       TO  PGM-NAME.
  3022     GO TO 9300-XCTL.
  3023 9500-PF12.
  3024     MOVE XCTL-010                   TO  PGM-NAME.
  3025     GO TO 9300-XCTL.
  3026 9600-PGMID-ERROR.
  3027
  3028* EXEC CICS HANDLE CONDITION
  3029*        PGMIDERR   (8300-SEND-TEXT)
  3030*    END-EXEC.
  3031*    MOVE '"$L                   ! # #00002712' TO DFHEIV0
  3032     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3033     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3034     MOVE X'2320233030303032373132' TO DFHEIV0(25:11)
  3035     CALL 'kxdfhei1' USING DFHEIV0
  3036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3037
  3038     MOVE PGM-NAME                   TO  PI-CALLING-PROGRAM.
  3039     MOVE ' '                        TO  PI-ENTRY-CD-1.
  3040     MOVE XCTL-005                   TO  PGM-NAME.
  3041     MOVE PGM-NAME                   TO  LOGOFF-PGM.
  3042     MOVE PGMIDERR-MSG               TO  LOGOFF-FILL.
  3043     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  56
* EL1044.cbl
  3045 9700-LINK-DATE-CONVERT.
  3046
  3047* EXEC CICS LINK
  3048*        PROGRAM    ('ELDATCV')
  3049*        COMMAREA   (DATE-CONVERSION-DATA)
  3050*        LENGTH     (DC-COMM-LENGTH)
  3051*    END-EXEC.
  3052     MOVE 'ELDATCV' TO DFHEIV1
  3053*    MOVE '."C                   (   #00002723' TO DFHEIV0
  3054     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3055     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3056     MOVE X'2020233030303032373233' TO DFHEIV0(25:11)
  3057     CALL 'kxdfhei1' USING DFHEIV0,
  3058           DFHEIV1,
  3059           DATE-CONVERSION-DATA,
  3060           DC-COMM-LENGTH,
  3061           DFHEIV99,
  3062           DFHEIV99,
  3063           DFHEIV99,
  3064           DFHEIV99
  3065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3066
  3067 9700-EXIT.
  3068     EXIT.
  3069 9900-ERROR-FORMAT.
  3070     IF NOT EMI-ERRORS-COMPLETE
  3071         MOVE LINK-001               TO  PGM-NAME
  3072
  3073* EXEC CICS LINK
  3074*            PROGRAM    (PGM-NAME)
  3075*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  3076*            LENGTH     (EMI-COMM-LENGTH)
  3077*        END-EXEC.
  3078*    MOVE '."C                   (   #00002733' TO DFHEIV0
  3079     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3080     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3081     MOVE X'2020233030303032373333' TO DFHEIV0(25:11)
  3082     CALL 'kxdfhei1' USING DFHEIV0,
  3083           PGM-NAME,
  3084           ERROR-MESSAGE-INTERFACE-BLOCK,
  3085           EMI-COMM-LENGTH,
  3086           DFHEIV99,
  3087           DFHEIV99,
  3088           DFHEIV99,
  3089           DFHEIV99
  3090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3091
  3092 9900-EXIT.
  3093     EXIT.
  3094 9990-ABEND.
  3095     MOVE LINK-004                   TO  PGM-NAME.
  3096     MOVE DFHEIBLK                   TO  EMI-LINE1.
  3097
  3098* EXEC CICS LINK
  3099*        PROGRAM   (PGM-NAME)
  3100*        COMMAREA  (EMI-LINE1)
  3101*        LENGTH    (72)
  3102*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  57
* EL1044.cbl
  3103     MOVE 72
  3104       TO DFHEIV11
  3105*    MOVE '."C                   (   #00002743' TO DFHEIV0
  3106     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3107     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3108     MOVE X'2020233030303032373433' TO DFHEIV0(25:11)
  3109     CALL 'kxdfhei1' USING DFHEIV0,
  3110           PGM-NAME,
  3111           EMI-LINE1,
  3112           DFHEIV11,
  3113           DFHEIV99,
  3114           DFHEIV99,
  3115           DFHEIV99,
  3116           DFHEIV99
  3117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3118
  3119     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  58
* EL1044.cbl
  3121 9995-SECURITY-VIOLATION.
  3122*                            COPY ELCSCTP.
  3123******************************************************************
  3124*                                                                *
  3125*                            ELCSCTP                             *
  3126*                            VMOD=2.001                          *
  3127*                                                                *
  3128*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3129******************************************************************
  3130
  3131
  3132     MOVE EIBDATE          TO SM-JUL-DATE.
  3133     MOVE EIBTRMID         TO SM-TERMID.
  3134     MOVE THIS-PGM         TO SM-PGM.
  3135     MOVE EIBTIME          TO TIME-IN.
  3136     MOVE TIME-OUT         TO SM-TIME.
  3137     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3138
  3139
  3140* EXEC CICS LINK
  3141*         PROGRAM  ('EL003')
  3142*         COMMAREA (SECURITY-MESSAGE)
  3143*         LENGTH   (80)
  3144*    END-EXEC.
  3145     MOVE 'EL003' TO DFHEIV1
  3146     MOVE 80
  3147       TO DFHEIV11
  3148*    MOVE '."C                   (   #00002768' TO DFHEIV0
  3149     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3150     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3151     MOVE X'2020233030303032373638' TO DFHEIV0(25:11)
  3152     CALL 'kxdfhei1' USING DFHEIV0,
  3153           DFHEIV1,
  3154           SECURITY-MESSAGE,
  3155           DFHEIV11,
  3156           DFHEIV99,
  3157           DFHEIV99,
  3158           DFHEIV99,
  3159           DFHEIV99
  3160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3161
  3162
  3163******************************************************************
  3164
  3165 9995-EXIT.
  3166     EXIT.
  3167
  3168 9999-DFHBACK SECTION.
  3169     MOVE '9%                    "   ' TO DFHEIV0
  3170     MOVE 'EL1044' TO DFHEIV1
  3171     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3172     GOBACK.
  3173 9999-DFHEXIT.
  3174     IF DFHEIGDJ EQUAL 0001
  3175         NEXT SENTENCE
  3176     ELSE IF DFHEIGDJ EQUAL 2
  3177         GO TO 8850-DUPREC,
  3178               8870-NOTOPEN,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-19 09:53 Page  59
* EL1044.cbl
  3179               8880-NOT-FOUND,
  3180               9600-PGMID-ERROR,
  3181               9990-ABEND
  3182         DEPENDING ON DFHEIGDI
  3183     ELSE IF DFHEIGDJ EQUAL 3
  3184         GO TO 8300-SEND-TEXT
  3185         DEPENDING ON DFHEIGDI.
  3186     MOVE '9%                    "   ' TO DFHEIV0
  3187     MOVE 'EL1044' TO DFHEIV1
  3188     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3189     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5500     Code:        8650
