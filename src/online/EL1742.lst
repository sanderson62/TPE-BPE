* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL1742.cbl
* Options: int("EL1742.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1742.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1742.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1742.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1742.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/13/96 09:34:05.
     7*                            VMOD=2.010
     8*
     9*AUTHOR.    LOGIC, INC.
    10*           DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL1742.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        THIS PROGRAM PRINTS A REPORT SHOWING ALL CHECKS THAT
    26*    ARE WAITING TO BE PRINTED.
    27
    28*    ENTERED BY  - EL174   EX64 - CHECKS TO BE PRINTED REPORT.
    29
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL1742.cbl
    31 ENVIRONMENT DIVISION.
    32
    33 DATA DIVISION.
    34
    35 WORKING-STORAGE SECTION.
    36 01  DFH-START PIC X(04).
    37
    38 77  THIS-PGM PIC X(6)  VALUE 'EL1742'.
    39 77  FILLER  PIC X(32)  VALUE '********************************'.
    40 77  FILLER  PIC X(32)  VALUE '*   EL1742 WORKING STORAGE     *'.
    41 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.010 *********'.
    42
    43*    COPY ELCDMD34.
    44******************************************************************
    45*                                                                *
    46*                                                                *
    47*                            ELCDMD34.                           *
    48*                            VMOD=2.001                          *
    49*                                                                *
    50*   FILE DESCRIPTION = DMD DLO034 PARAMETER AREA                 *
    51*                                                                *
    52*    LENGTH = 272    RECFRM = FIXED                              *
    53*                                                                *
    54******************************************************************
    55 01  DLO034-COMMUNICATION-AREA.
    56     12  DL34-PROCESS-TYPE             PIC X.
    57     12  DL34-COMPANY-ID               PIC XXX.
    58     12  DL34-PRINT-PROGRAM-ID         PIC X(8).
    59     12  DL34-USERID                   PIC X(4).
    60     12  DL34-PRINT-LINE               PIC X(250).
    61     12  DL34-OVERRIDE-PRINTER-ID      PIC X(4).
    62     12  DL34-RETURN-CODE              PIC XX.
    63 01  DLO034-REC-LENGTH                 PIC S9(4) COMP VALUE +272.
    64 01  WS-DATE-AREA.
    65     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    66     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
    67
    68 01  FILLER                          COMP-3.
    69     05  WS-READNEXT-SW              PIC S9          VALUE ZERO.
    70
    71     05  WS-TIME-WORK                PIC S9(7)       VALUE ZERO.
    72     05  WS-TIME                     REDEFINES
    73         WS-TIME-WORK                PIC S9(3)V9(4).
    74
    75 01  FILLER.
    76     05  WS-ACTIVITY-TRAILERS-KEY.
    77         10  WS-ATK-COMPANY-CD       PIC X.
    78         10  WS-ATK-CARRIER          PIC X.
    79         10  WS-ATK-CLAIM-NO         PIC X(7).
    80         10  WS-ATK-CERT-NO          PIC X(11).
    81         10  WS-ATK-SEQUENCE-NO      PIC S9(4)  COMP.
    82
    83     05  ERROR-LINE                 PIC X(80).
    84     05  WS-CHECK-AIX-DSID          PIC X(8) VALUE 'ELCHKQ2'.
    85     05  WS-ACTIVITY-TRAILERS-DSID  PIC X(8) VALUE 'ELTRLR'.
    86     05  WS-NO-CHECKS-L             PIC S9(4) VALUE +0.
    87     05  WS-NO-CHECKS-A             PIC S9(4) VALUE +0.
    88     05  WS-NO-CHECKS               PIC S9(4) VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL1742.cbl
    89
    90*    COPY ELCINTF.
    91******************************************************************
    92*                                                                *
    93*                                                                *
    94*                            ELCINTF.                            *
    95*                            VMOD=2.017                          *
    96*                                                                *
    97*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
    98*                                                                *
    99*       LENGTH = 1024                                            *
   100*                                                                *
   101******************************************************************
   102 01  PROGRAM-INTERFACE-BLOCK.
   103     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   104     12  PI-CALLING-PROGRAM              PIC X(8).
   105     12  PI-SAVED-PROGRAM-1              PIC X(8).
   106     12  PI-SAVED-PROGRAM-2              PIC X(8).
   107     12  PI-SAVED-PROGRAM-3              PIC X(8).
   108     12  PI-SAVED-PROGRAM-4              PIC X(8).
   109     12  PI-SAVED-PROGRAM-5              PIC X(8).
   110     12  PI-SAVED-PROGRAM-6              PIC X(8).
   111     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   112     12  PI-COMPANY-ID                   PIC XXX.
   113     12  PI-COMPANY-CD                   PIC X.
   114
   115     12  PI-COMPANY-PASSWORD             PIC X(8).
   116
   117     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   118
   119     12  PI-CONTROL-IN-PROGRESS.
   120         16  PI-CARRIER                  PIC X.
   121         16  PI-GROUPING                 PIC X(6).
   122         16  PI-STATE                    PIC XX.
   123         16  PI-ACCOUNT                  PIC X(10).
   124         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   125                                         PIC X(10).
   126         16  PI-CLAIM-CERT-GRP.
   127             20  PI-CLAIM-NO             PIC X(7).
   128             20  PI-CERT-NO.
   129                 25  PI-CERT-PRIME       PIC X(10).
   130                 25  PI-CERT-SFX         PIC X.
   131             20  PI-CERT-EFF-DT          PIC XX.
   132         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   133             20  PI-PLAN-CODE            PIC X(2).
   134             20  PI-REVISION-NUMBER      PIC X(3).
   135             20  PI-PLAN-EFF-DT          PIC X(2).
   136             20  PI-PLAN-EXP-DT          PIC X(2).
   137             20  FILLER                  PIC X(11).
   138         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   139             20  PI-OE-REFERENCE-1.
   140                 25  PI-OE-REF-1-PRIME   PIC X(18).
   141                 25  PI-OE-REF-1-SUFF    PIC XX.
   142
   143     12  PI-SESSION-IN-PROGRESS          PIC X.
   144         88  CLAIM-SESSION                   VALUE '1'.
   145         88  CREDIT-SESSION                  VALUE '2'.
   146         88  WARRANTY-SESSION                VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL1742.cbl
   147         88  MORTGAGE-SESSION                VALUE '4'.
   148         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   149
   150
   151*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   152
   153     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   154     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   155
   156     12  PI-CREDIT-USER                  PIC X.
   157         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   158         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   159
   160     12  PI-CLAIM-USER                   PIC X.
   161         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   162         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   163
   164     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   165         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   166         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   167         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   168         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   169         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   170
   171     12  PI-PROCESSOR-ID                 PIC X(4).
   172
   173     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   174
   175     12  PI-MEMBER-CAPTION               PIC X(10).
   176
   177     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   178         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   179
   180     12  PI-LIFE-OVERRIDE-L1             PIC X.
   181     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   182     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   183     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   184
   185     12  PI-AH-OVERRIDE-L1               PIC X.
   186     12  PI-AH-OVERRIDE-L2               PIC XX.
   187     12  PI-AH-OVERRIDE-L6               PIC X(6).
   188     12  PI-AH-OVERRIDE-L12              PIC X(12).
   189
   190     12  PI-NEW-SYSTEM                   PIC X(2).
   191
   192     12  PI-PRIMARY-CERT-NO              PIC X(11).
   193     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   194         88  PI-USES-PAID-TO                 VALUE '1'.
   195     12  PI-CRDTCRD-SYSTEM.
   196         16  PI-CRDTCRD-USER             PIC X.
   197             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   198             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   199         16  PI-CC-MONTH-END-DT          PIC XX.
   200     12  PI-PROCESSOR-PRINTER            PIC X(4).
   201
   202     12  PI-OE-REFERENCE-2.
   203         16  PI-OE-REF-2-PRIME           PIC X(10).
   204         16  PI-OE-REF-2-SUFF            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL1742.cbl
   205
   206     12  PI-REM-TRM-CALC-OPTION          PIC X.
   207
   208     12  PI-LANGUAGE-TYPE                PIC X.
   209             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   210             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   211             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   212
   213     12  PI-POLICY-LINKAGE-IND           PIC X.
   214         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   215         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   216                                                   LOW-VALUES.
   217
   218     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   219     12  PI-CLAIM-PW-SESSION             PIC X(1).
   220         88  PI-CLAIM-CREDIT                 VALUE '1'.
   221         88  PI-CLAIM-CONVEN                 VALUE '2'.
   222     12  FILLER                          PIC X(4).
   223
   224     12  PI-SYSTEM-LEVEL                 PIC X(145).
   225
   226     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   227         PI-SYSTEM-LEVEL.
   228
   229         16  PI-ENTRY-CODES.
   230             20  PI-ENTRY-CD-1           PIC X.
   231             20  PI-ENTRY-CD-2           PIC X.
   232
   233         16  PI-RETURN-CODES.
   234             20  PI-RETURN-CD-1          PIC X.
   235             20  PI-RETURN-CD-2          PIC X.
   236
   237         16  PI-UPDATE-STATUS-SAVE.
   238             20  PI-UPDATE-BY            PIC X(4).
   239             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   240
   241         16  PI-LOWER-CASE-LETTERS       PIC X.
   242             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   243
   244*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   245*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   246*            88  CARRIER-CLM-CNTL            VALUE '2'.
   247
   248         16  PI-CERT-ACCESS-CONTROL      PIC X.
   249             88  ST-ACCNT-CNTL               VALUE ' '.
   250             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   251             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   252             88  ACCNT-CNTL                  VALUE '3'.
   253             88  CARR-ACCNT-CNTL             VALUE '4'.
   254
   255         16  PI-PROCESSOR-CAP-LIST.
   256             20  PI-SYSTEM-CONTROLS.
   257                24 PI-SYSTEM-DISPLAY     PIC X.
   258                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   259                24 PI-SYSTEM-MODIFY      PIC X.
   260                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   261             20  FILLER                  PIC XX.
   262             20  PI-DISPLAY-CAP          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL1742.cbl
   263                 88  DISPLAY-CAP             VALUE 'Y'.
   264             20  PI-MODIFY-CAP           PIC X.
   265                 88  MODIFY-CAP              VALUE 'Y'.
   266             20  PI-MSG-AT-LOGON-CAP     PIC X.
   267                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   268             20  PI-FORCE-CAP            PIC X.
   269                 88  FORCE-CAP               VALUE 'Y'.
   270
   271         16  PI-PROGRAM-CONTROLS.
   272             20  PI-PGM-PRINT-OPT        PIC X.
   273             20  PI-PGM-FORMAT-OPT       PIC X.
   274             20  PI-PGM-PROCESS-OPT      PIC X.
   275             20  PI-PGM-TOTALS-OPT       PIC X.
   276
   277         16  PI-HELP-INTERFACE.
   278             20  PI-LAST-ERROR-NO        PIC X(4).
   279             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   280
   281         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   282             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   283
   284         16  PI-CR-CONTROL-IN-PROGRESS.
   285             20  PI-CR-CARRIER           PIC X.
   286             20  PI-CR-GROUPING          PIC X(6).
   287             20  PI-CR-STATE             PIC XX.
   288             20  PI-CR-ACCOUNT           PIC X(10).
   289             20  PI-CR-FIN-RESP          PIC X(10).
   290             20  PI-CR-TYPE              PIC X.
   291
   292         16  PI-CR-BATCH-NUMBER          PIC X(6).
   293
   294         16  PI-CR-MONTH-END-DT          PIC XX.
   295
   296         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   297             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   298             88  PI-ZERO-CARRIER             VALUE '1'.
   299             88  PI-ZERO-GROUPING            VALUE '2'.
   300             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   301
   302         16  PI-CARRIER-SECURITY         PIC X.
   303             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   304
   305         16  PI-ACCOUNT-SECURITY         PIC X(10).
   306             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   307             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   308
   309         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   310             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   311                                         INDEXED BY PI-ACCESS-NDX
   312                                         PIC X.
   313
   314         16  PI-GA-BILLING-CONTROL       PIC X.
   315             88  PI-GA-BILLING               VALUE '1'.
   316
   317         16  PI-MAIL-PROCESSING          PIC X.
   318             88  PI-MAIL-YES                 VALUE 'Y'.
   319
   320         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL1742.cbl
   321
   322         16  PI-AR-SYSTEM.
   323             20  PI-AR-PROCESSING-CNTL   PIC X.
   324                 88  PI-AR-PROCESSING        VALUE 'Y'.
   325             20  PI-AR-SUMMARY-CODE      PIC X(6).
   326             20  PI-AR-MONTH-END-DT      PIC XX.
   327
   328         16  PI-MP-SYSTEM.
   329             20  PI-MORTGAGE-USER            PIC X.
   330                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   331                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   332             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   333                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   334                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   335                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   336                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   337                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   338             20  PI-MP-MONTH-END-DT          PIC XX.
   339             20  PI-MP-REFERENCE-NO.
   340                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   341                 24  PI-MP-REFERENCE-SFX     PIC XX.
   342
   343         16  PI-LABEL-CONTROL            PIC X(01).
   344             88  PI-CREATE-LABELS                    VALUE 'Y'.
   345             88  PI-BYPASS-LABELS                    VALUE 'N'.
   346
   347         16  PI-BILL-GROUPING-CODE       PIC X(01).
   348             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   349
   350         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   351             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   352             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   353
   354         16  FILLER                      PIC X(14).
   355
   356     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   357******************************************************************
   358
   359     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
   360         16  PI-CHECK-AIX-KEY.
   361             20  PI-CK-COMPANY-CODE     PIC X.
   362             20  PI-CK-CONTROL-NO       PIC S9(8)          COMP.
   363             20  PI-CK-CARRIER          PIC X.
   364             20  PI-CK-GROUPING         PIC X(6).
   365             20  PI-CK-STATE            PIC XX.
   366             20  PI-CK-BENE-ACCT        PIC X(10).
   367             20  PI-CK-SEQUENCE-NO      PIC S9(4)          COMP.
   368
   369         16  PI-PREV-CHECK-AIX-KEY.
   370             20  PI-PREV-CK-COMPANY-CODE     PIC X.
   371             20  PI-PREV-CK-CONTROL-NO       PIC S9(8) COMP.
   372             20  PI-PREV-CK-CARRIER          PIC X.
   373             20  PI-PREV-CK-GROUPING         PIC X(06).
   374             20  PI-PREV-CK-STATE            PIC XX.
   375             20  PI-PREV-CK-BENE-ACCT        PIC X(10).
   376             20  PI-PREV-CK-SEQUENCE-NO      PIC S9(4) COMP.
   377
   378         16 FILLER                       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL1742.cbl
   379
   380         16 PI-CONTROL-TOTALS.
   381            20 PI-CONTROL-TOT            PIC S9(7)V99 COMP-3.
   382            20 PI-CONTROL-GRAND-TOT      PIC S9(7)V99 COMP-3.
   383            20 PI-CONTROL-SAVE-CONTROL   PIC S9(8) COMP.
   384
   385         16 PI-FIRST-TIME-SWT        PIC X.
   386            88 PI-FIRST-TIME         VALUE 'Y'.
   387            88 PI-NOT-FIRST-TIME     VALUE 'N'.
   388
   389         16 FILLER                   PIC XX.
   390
   391         16 PI-CHECK-MODE            PIC X.
   392            88 CHECKS-TO-BE-PRINTED  VALUE SPACE.
   393            88 CHECKS-RELEASED       VALUE 'R'.
   394            88 CHECKS-PRINTED        VALUE 'Y'.
   395
   396         16 PI-START-CONTROL-NO      PIC S9(8)   COMP.
   397
   398         16 PI-PAGE                  PIC S999     COMP-3.
   399         16 PI-LINE-COUNT            PIC S999     COMP-3.
   400
   401         16 PI-TOT-CHECKS            PIC S9(4).
   402
   403         16 PI-ADDTL-TOTALS.
   404            20 PI-CONTROL-TOT-L          PIC S9(7)V99 COMP-3.
   405            20 PI-CONTROL-TOT-A          PIC S9(7)V99 COMP-3.
   406            20 PI-CONTROL-GRAND-TOT-L    PIC S9(7)V99 COMP-3.
   407            20 PI-CONTROL-GRAND-TOT-A    PIC S9(7)V99 COMP-3.
   408            20 PI-TOT-CHECKS-L           PIC S9(4).
   409            20 PI-TOT-CHECKS-A           PIC S9(4).
   410
   411         16  PI-END-CONTROL-NO       PIC S9(08)    COMP.
   412         16  PI-MONTH-END-SAVE       PIC XX.
   413         16  PI-NON-CASH-REL-CNT     PIC S9(05)    COMP-3.
   414         16  PI-NON-CASH-REL-AMT     PIC S9(9)V99  COMP-3.
   415
   416         16  FILLER                  PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL1742.cbl
   418 01  HEADING-1.
   419     12  FILLER                  PIC XX      VALUE SPACES.
   420     12  ADATE                   PIC X(8).
   421     12  FILLER                  PIC XX      VALUE SPACES.
   422     12  ATIME                   PIC 99.99.
   423     12  FILLER                  PIC X(8)    VALUE SPACES.
   424     12  ACOMP                   PIC XXX.
   425     12  FILLER                  PIC X       VALUE SPACES.
   426     12  HDG1                    PIC X(25)   VALUE SPACES.
   427     12  FILLER                  PIC X(7)    VALUE SPACES.
   428     12  FILLER                  PIC X(5)    VALUE 'PAGE'.
   429     12  PAGE-NO                 PIC ZZ9.
   430     12  FILLER                  PIC X(3)    VALUE SPACES.
   431     12  HDG1-RPT                PIC X(6)    VALUE 'EL174A'.
   432
   433 01  FILLER.
   434     12  VAR-HEADING1A           PIC X(24)   VALUE
   435             '- CHECKS TO BE PRINTED -'.
   436     12  VAR-HEADING1B           PIC X(24)   VALUE
   437             '-    PRINTED CHECKS    -'.
   438     12  VAR-HEADING1C           PIC X(27)   VALUE
   439             '- RELEASED CONTROL GROUPS -'.
   440
   441 01  HEADING-2.
   442     12  FILLER                  PIC XX      VALUE SPACES.
   443     12  FILLER                  PIC X(54)
   444     VALUE 'CONTROL CHK NO  PMT TYPE  L/A CLAIM  CAR CERT NO'.
   445     12  FILLER                  PIC X(22)
   446     VALUE 'PMT AMOUNT  PAYEE   BY'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL1742.cbl
   448
   449 01  DETAIL-LINE.
   450         15  FILLER                  PIC XX.
   451         15  EL174A-CONTROL          PIC 9(7).
   452         15  FILLER                  PIC X.
   453         15  EL174A-CHECK-NO         PIC X(7).
   454         15  FILLER                  PIC X.
   455         15  EL174A-PMT-TYPE         PIC X(10).
   456         15  FILLER                  PIC X.
   457         15  EL174A-COV-TYPE         PIC X.
   458         15  FILLER                  PIC X.
   459         15  EL174A-CLAIM-NO         PIC X(7).
   460         15  FILLER                  PIC XX.
   461         15  EL174A-CARRIER          PIC X.
   462         15  FILLER                  PIC X.
   463         15  EL174A-CERT-NO          PIC X(11).
   464         15  FILLER                  PIC X.
   465         15  EL174A-AMT              PIC Z,ZZZ,ZZ9.99-.
   466         15  FILLER                  PIC X.
   467         15  EL174A-PAYEE            PIC X(7).
   468         15  FILLER                  PIC X.
   469         15  EL174A-BY               PIC X(4).
   470
   471 01  TOTAL-LINE                      REDEFINES
   472     DETAIL-LINE.
   473         15  FILLER                  PIC X(13).
   474         15  EL174A-NO-CHECKS-DESC   PIC X(13).
   475         15  EL174A-NO-CHECKS        PIC ZZZ9.
   476         15  FILLER                  PIC X(10).
   477         15  EL174A-CNTL-DESC        PIC X(12).
   478         15  EL174A-CNTL-TOTAL       PIC Z,ZZZ,ZZ9.99-.
   479         15  FILLER                  PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL1742.cbl
   481*    COPY ELPRTCVD.
   482*****************************************************************
   483*                                                               *
   484*                            ELPRTCVD.                          *
   485*                            VMOD=2.001                         *
   486*****************************************************************.
   487
   488******************************************************************
   489***   WORK AREAS  FOR TERMINAL ONLINE PRINT ROUTINE
   490***                 -ELPRTCVD-
   491***   TO BE USED WITH PROCEDURE COPY MEMBER -ELPRTCVP-
   492******************************************************************
   493
   494 01  S-WORK-AREA                     SYNC.
   495     12  WS-LINE-LEN                 PIC S9(4)       VALUE +80
   496                                     COMP.
   497
   498     12  WS-LINE-LENGTH              PIC S9(4)       VALUE ZERO
   499                                     COMP.
   500
   501     12  WS-BUFFER-SIZE              PIC S9(4)       VALUE +1916
   502                                     COMP.
   503
   504     12  WS-BUFFER-LENGTH            PIC S9(4)       VALUE ZERO
   505                                     COMP.
   506
   507     12  WS-PROG-END                 PIC X           VALUE SPACES.
   508
   509     12  WS-PRINT-AREA.
   510         16  WS-PASSED-CNTL-CHAR     PIC X           VALUE SPACES.
   511           88  SINGLE-SPACE                          VALUE ' '.
   512           88  DOUBLE-SPACE                          VALUE '0'.
   513           88  TRIPLE-SPACE                          VALUE '-'.
   514           88  TOP-PAGE                              VALUE '1'.
   515
   516         16  WS-PASSED-DATA.
   517             20  WS-PRINT-BYTE       PIC X
   518                 OCCURS 132 TIMES    INDEXED BY PRT-INDEX.
   519
   520     12  WS-LINE-CNT                 PIC S9(3)        VALUE ZERO
   521                                     COMP-3.
   522     12  WS-WCC-CNTL                 PIC X(1)         VALUE 'H'.
   523
   524     12  WS-EM                       PIC S9(4)        VALUE +25
   525                                     COMP.
   526     12  FILLER   REDEFINES WS-EM.
   527         16  FILLER                  PIC X.
   528         16  T-EM                    PIC X.
   529
   530*    12  WS-SS                       PIC S9(4)        VALUE +21
   531     12  WS-SS                       PIC S9(4)        VALUE +10
   532                                     COMP.
   533     12  FILLER   REDEFINES WS-SS.
   534         16  FILLER                  PIC X.
   535         16  T-SS                    PIC X.
   536
   537     12  WS-TP                       PIC S9(4)      VALUE +12
   538                                     COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL1742.cbl
   539     12  FILLER   REDEFINES WS-TP.
   540         16  FILLER                  PIC X.
   541         16  T-TP                    PIC X.
   542
   543     12  WS-FIRST-TIME-SW            PIC X           VALUE '1'.
   544         88  FIRST-TIME                              VALUE '1'.
   545         88  FIRST-LINE-NEXT-BUFFER                  VALUE '2'.
   546
   547     12  WS-BUFFER-AREA.
   548         16  WS-BUFFER-BYTE          PIC X
   549             OCCURS 1920 TIMES       INDEXED BY BUFFER-INDEX
   550                                                BUFFER-INDEX2.
   551
   552******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL1742.cbl
   554*    COPY ELCDATE.
   555******************************************************************
   556*                                                                *
   557*                                                                *
   558*                            ELCDATE.                            *
   559*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   560*                            VMOD=2.003
   561*                                                                *
   562*                                                                *
   563*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   564*                 LENGTH = 200                                   *
   565******************************************************************
   566
   567 01  DATE-CONVERSION-DATA.
   568     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   569     12  DC-OPTION-CODE                PIC X.
   570         88  BIN-TO-GREG                VALUE ' '.
   571         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   572         88  EDIT-GREG-TO-BIN           VALUE '2'.
   573         88  YMD-GREG-TO-BIN            VALUE '3'.
   574         88  MDY-GREG-TO-BIN            VALUE '4'.
   575         88  JULIAN-TO-BIN              VALUE '5'.
   576         88  BIN-PLUS-ELAPSED           VALUE '6'.
   577         88  FIND-CENTURY               VALUE '7'.
   578         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   579         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   580         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   581         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   582         88  JULIAN-TO-BIN-3            VALUE 'C'.
   583         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   584         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   585         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   586         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   587         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   588         88  CHECK-LEAP-YEAR            VALUE 'H'.
   589         88  BIN-3-TO-GREG              VALUE 'I'.
   590         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   591         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   592         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   593         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   594         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   595         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   596         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   597         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   598         88  THREE-CHARACTER-BIN
   599                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   600         88  GREGORIAN-TO-BIN
   601                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   602         88  BIN-TO-GREGORIAN
   603                  VALUES ' ' '1' 'I' '8' 'G'.
   604         88  JULIAN-TO-BINARY
   605                  VALUES '5' 'C' 'E' 'F'.
   606     12  DC-ERROR-CODE                 PIC X.
   607         88  NO-CONVERSION-ERROR        VALUE ' '.
   608         88  DATE-CONVERSION-ERROR
   609                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   610         88  DATE-IS-ZERO               VALUE '1'.
   611         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL1742.cbl
   612         88  DATE-IS-INVALID            VALUE '3'.
   613         88  DATE1-GREATER-DATE2        VALUE '4'.
   614         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   615         88  DATE-INVALID-OPTION        VALUE '9'.
   616         88  INVALID-CENTURY            VALUE 'A'.
   617         88  ONLY-CENTURY               VALUE 'B'.
   618         88  ONLY-LEAP-YEAR             VALUE 'C'.
   619         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   620     12  DC-END-OF-MONTH               PIC X.
   621         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   622     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   623         88  USE-NORMAL-PROCESS         VALUE ' '.
   624         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   625         88  ADJUST-UP-100-YRS          VALUE '2'.
   626     12  FILLER                        PIC X.
   627     12  DC-CONVERSION-DATES.
   628         16  DC-BIN-DATE-1             PIC XX.
   629         16  DC-BIN-DATE-2             PIC XX.
   630         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   631         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   632                       DC-GREG-DATE-1-EDIT.
   633             20  DC-EDIT1-MONTH        PIC 99.
   634             20  SLASH1-1              PIC X.
   635             20  DC-EDIT1-DAY          PIC 99.
   636             20  SLASH1-2              PIC X.
   637             20  DC-EDIT1-YEAR         PIC 99.
   638         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   639         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   640                     DC-GREG-DATE-2-EDIT.
   641             20  DC-EDIT2-MONTH        PIC 99.
   642             20  SLASH2-1              PIC X.
   643             20  DC-EDIT2-DAY          PIC 99.
   644             20  SLASH2-2              PIC X.
   645             20  DC-EDIT2-YEAR         PIC 99.
   646         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   647         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   648                     DC-GREG-DATE-1-YMD.
   649             20  DC-YMD-YEAR           PIC 99.
   650             20  DC-YMD-MONTH          PIC 99.
   651             20  DC-YMD-DAY            PIC 99.
   652         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   653         16  DC-GREG-DATE-1-MDY-R REDEFINES
   654                      DC-GREG-DATE-1-MDY.
   655             20  DC-MDY-MONTH          PIC 99.
   656             20  DC-MDY-DAY            PIC 99.
   657             20  DC-MDY-YEAR           PIC 99.
   658         16  DC-GREG-DATE-1-ALPHA.
   659             20  DC-ALPHA-MONTH        PIC X(10).
   660             20  DC-ALPHA-DAY          PIC 99.
   661             20  FILLER                PIC XX.
   662             20  DC-ALPHA-CENTURY.
   663                 24 DC-ALPHA-CEN-N     PIC 99.
   664             20  DC-ALPHA-YEAR         PIC 99.
   665         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   666         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   667         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   668         16  DC-JULIAN-DATE            PIC 9(05).
   669         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL1742.cbl
   670                                       PIC 9(05).
   671         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   672             20  DC-JULIAN-YEAR        PIC 99.
   673             20  DC-JULIAN-DAYS        PIC 999.
   674         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   675         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   676         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   677     12  DATE-CONVERSION-VARIBLES.
   678         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   679         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   680             20  FILLER                PIC 9(3).
   681             20  HOLD-CEN-1-CCYY.
   682                 24  HOLD-CEN-1-CC     PIC 99.
   683                 24  HOLD-CEN-1-YY     PIC 99.
   684             20  HOLD-CEN-1-MO         PIC 99.
   685             20  HOLD-CEN-1-DA         PIC 99.
   686         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   687             20  HOLD-CEN-1-R-MO       PIC 99.
   688             20  HOLD-CEN-1-R-DA       PIC 99.
   689             20  HOLD-CEN-1-R-CCYY.
   690                 24  HOLD-CEN-1-R-CC   PIC 99.
   691                 24  HOLD-CEN-1-R-YY   PIC 99.
   692             20  FILLER                PIC 9(3).
   693         16  HOLD-CENTURY-1-X.
   694             20  FILLER                PIC X(3)  VALUE SPACES.
   695             20  HOLD-CEN-1-X-CCYY.
   696                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   697                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   698             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   699             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   700         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   701             20  HOLD-CEN-1-R-X-MO     PIC XX.
   702             20  HOLD-CEN-1-R-X-DA     PIC XX.
   703             20  HOLD-CEN-1-R-X-CCYY.
   704                 24  HOLD-CEN-1-R-X-CC PIC XX.
   705                 24  HOLD-CEN-1-R-X-YY PIC XX.
   706             20  FILLER                PIC XXX.
   707         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   708         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   709         16  DC-JULIAN-DATE-1          PIC 9(07).
   710         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   711             20  DC-JULIAN-1-CCYY.
   712                 24  DC-JULIAN-1-CC    PIC 99.
   713                 24  DC-JULIAN-1-YR    PIC 99.
   714             20  DC-JULIAN-DA-1        PIC 999.
   715         16  DC-JULIAN-DATE-2          PIC 9(07).
   716         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   717             20  DC-JULIAN-2-CCYY.
   718                 24  DC-JULIAN-2-CC    PIC 99.
   719                 24  DC-JULIAN-2-YR    PIC 99.
   720             20  DC-JULIAN-DA-2        PIC 999.
   721         16  DC-GREG-DATE-A-EDIT.
   722             20  DC-EDITA-MONTH        PIC 99.
   723             20  SLASHA-1              PIC X VALUE '/'.
   724             20  DC-EDITA-DAY          PIC 99.
   725             20  SLASHA-2              PIC X VALUE '/'.
   726             20  DC-EDITA-CCYY.
   727                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL1742.cbl
   728                 24  DC-EDITA-YEAR     PIC 99.
   729         16  DC-GREG-DATE-B-EDIT.
   730             20  DC-EDITB-MONTH        PIC 99.
   731             20  SLASHB-1              PIC X VALUE '/'.
   732             20  DC-EDITB-DAY          PIC 99.
   733             20  SLASHB-2              PIC X VALUE '/'.
   734             20  DC-EDITB-CCYY.
   735                 24  DC-EDITB-CENT     PIC 99.
   736                 24  DC-EDITB-YEAR     PIC 99.
   737         16  DC-GREG-DATE-CYMD         PIC 9(08).
   738         16  DC-GREG-DATE-CYMD-R REDEFINES
   739                              DC-GREG-DATE-CYMD.
   740             20  DC-CYMD-CEN           PIC 99.
   741             20  DC-CYMD-YEAR          PIC 99.
   742             20  DC-CYMD-MONTH         PIC 99.
   743             20  DC-CYMD-DAY           PIC 99.
   744         16  DC-GREG-DATE-MDCY         PIC 9(08).
   745         16  DC-GREG-DATE-MDCY-R REDEFINES
   746                              DC-GREG-DATE-MDCY.
   747             20  DC-MDCY-MONTH         PIC 99.
   748             20  DC-MDCY-DAY           PIC 99.
   749             20  DC-MDCY-CEN           PIC 99.
   750             20  DC-MDCY-YEAR          PIC 99.
   751    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   752        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   753    12  DC-EL310-DATE                  PIC X(21).
   754    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL1742.cbl
   756****************************************************************
   757*
   758* Copyright (c) 2007 by Clerity Solutions, Inc.
   759* All rights reserved.
   760*
   761****************************************************************
   762 01  DFHEIV.
   763   02  DFHEIV0               PIC X(35).
   764   02  DFHEIV1               PIC X(08).
   765   02  DFHEIV2               PIC X(08).
   766   02  DFHEIV3               PIC X(08).
   767   02  DFHEIV4               PIC X(06).
   768   02  DFHEIV5               PIC X(04).
   769   02  DFHEIV6               PIC X(04).
   770   02  DFHEIV7               PIC X(02).
   771   02  DFHEIV8               PIC X(02).
   772   02  DFHEIV9               PIC X(01).
   773   02  DFHEIV10              PIC S9(7) COMP-3.
   774   02  DFHEIV11              PIC S9(4) COMP SYNC.
   775   02  DFHEIV12              PIC S9(4) COMP SYNC.
   776   02  DFHEIV13              PIC S9(4) COMP SYNC.
   777   02  DFHEIV14              PIC S9(4) COMP SYNC.
   778   02  DFHEIV15              PIC S9(4) COMP SYNC.
   779   02  DFHEIV16              PIC S9(9) COMP SYNC.
   780   02  DFHEIV17              PIC X(04).
   781   02  DFHEIV18              PIC X(04).
   782   02  DFHEIV19              PIC X(04).
   783   02  DFHEIV20              USAGE IS POINTER.
   784   02  DFHEIV21              USAGE IS POINTER.
   785   02  DFHEIV22              USAGE IS POINTER.
   786   02  DFHEIV23              USAGE IS POINTER.
   787   02  DFHEIV24              USAGE IS POINTER.
   788   02  DFHEIV25              PIC S9(9) COMP SYNC.
   789   02  DFHEIV26              PIC S9(9) COMP SYNC.
   790   02  DFHEIV27              PIC S9(9) COMP SYNC.
   791   02  DFHEIV28              PIC S9(9) COMP SYNC.
   792   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   793   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   794   02  FILLER                PIC X(02).
   795   02  DFHEIV99              PIC X(08) VALUE SPACE.
   796   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   797   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   798   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   799   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   800 LINKAGE  SECTION.
   801*****************************************************************
   802*                                                               *
   803* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   804* All rights reserved.                                          *
   805*                                                               *
   806*****************************************************************
   807 01  dfheiblk.
   808     02  eibtime          pic s9(7) comp-3.
   809     02  eibdate          pic s9(7) comp-3.
   810     02  eibtrnid         pic x(4).
   811     02  eibtaskn         pic s9(7) comp-3.
   812     02  eibtrmid         pic x(4).
   813     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL1742.cbl
   814     02  eibcposn         pic s9(4) comp.
   815     02  eibcalen         pic s9(4) comp.
   816     02  eibaid           pic x(1).
   817     02  eibfiller1       pic x(1).
   818     02  eibfn            pic x(2).
   819     02  eibfiller2       pic x(2).
   820     02  eibrcode         pic x(6).
   821     02  eibfiller3       pic x(2).
   822     02  eibds            pic x(8).
   823     02  eibreqid         pic x(8).
   824     02  eibrsrce         pic x(8).
   825     02  eibsync          pic x(1).
   826     02  eibfree          pic x(1).
   827     02  eibrecv          pic x(1).
   828     02  eibsend          pic x(1).
   829     02  eibatt           pic x(1).
   830     02  eibeoc           pic x(1).
   831     02  eibfmh           pic x(1).
   832     02  eibcompl         pic x(1).
   833     02  eibsig           pic x(1).
   834     02  eibconf          pic x(1).
   835     02  eiberr           pic x(1).
   836     02  eibrldbk         pic x(1).
   837     02  eiberrcd         pic x(4).
   838     02  eibsynrb         pic x(1).
   839     02  eibnodat         pic x(1).
   840     02  eibfiller5       pic x(2).
   841     02  eibresp          pic 9(09) comp.
   842     02  eibresp2         pic 9(09) comp.
   843     02  dfheigdj         pic s9(4) comp.
   844     02  dfheigdk         pic s9(4) comp.
   845
   846*    COPY ELCCHKQ.
   847******************************************************************
   848*                                                                *
   849*                                                                *
   850*                            ELCCHKQ.                            *
   851*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   852*                            VMOD=2.007                          *
   853*                                                                *
   854*   FILE DESCRIPTION = CHECK QUE FILE                            *
   855*                                                                *
   856*   FILE TYPE = VSAM,KSDS                                        *
   857*   RECORD SIZE = 100  RECFORM = FIXED                           *
   858*                                                                *
   859*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
   860*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
   861*                                                                *
   862*   LOG = YES                                                    *
   863*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   864******************************************************************
   865 01  DFHCOMMAREA       PIC X(01).
   866 01  CHECK-QUE.
   867     12  CQ-RECORD-ID                PIC XX.
   868         88  VALID-CQ-ID         VALUE 'CQ'.
   869
   870     12  CQ-CONTROL-PRIMARY.
   871         16  CQ-COMPANY-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL1742.cbl
   872         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
   873         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
   874
   875     12  CQ-CONTROL-BY-PAYEE.
   876         16  CQ-CONTROL-BY-NUMBER.
   877             20  CQ-COMPANY-CD-A1     PIC X.
   878             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
   879         16  CQ-PAYEE-CARRIER        PIC X.
   880         16  CQ-PAYEE-GROUPING       PIC X(6).
   881         16  CQ-PAYEE-STATE          PIC XX.
   882         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
   883         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
   884
   885     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
   886         16  CQ-DMD-COMPANY-CD-A2    PIC X.
   887         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
   888         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
   889         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
   890         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
   891         16  FILLER                  PIC X(3).
   892
   893     12  CQ-ENTRY-TYPE               PIC X.
   894             88  CHECK-ON-QUE           VALUE 'Q'.
   895             88  ALIGNMENT-CHECK        VALUE 'A'.
   896             88  SPOILED-CHECK          VALUE 'S'.
   897             88  PAYMENT-ABORTED        VALUE 'X'.
   898
   899     12  CQ-CLAIM-MAST-CNTL.
   900         16  CQ-CARRIER              PIC X.
   901         16  CQ-CLAIM-NO             PIC X(7).
   902         16  CQ-CERT-NO.
   903             20  CQ-CERT-PRIME       PIC X(10).
   904             20  CQ-CERT-SFX         PIC X.
   905         16  CQ-CLAIM-TYPE           PIC X.
   906             88  CQ-LIFE-CLAIM          VALUE 'L'.
   907             88  CQ-AH-CLAIM            VALUE 'A'.
   908         16  CQ-CLAIM-SUB-TYPE       PIC X.
   909             88  CQ-FIXED-COVERAGE      VALUE '1'.
   910             88  CQ-O-B-COVERAGE        VALUE '2'.
   911             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
   912
   913     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
   914     12  CQ-CHECK-NUMBER             PIC X(7).
   915     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
   916     12  CQ-PAYMENT-TYPE             PIC X.
   917             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
   918             88  CQ-FINAL-PAYMENT          VALUE '2'.
   919             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
   920             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
   921             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
   922             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
   923             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
   924             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
   925     12  CQ-VOID-INDICATOR           PIC X.
   926             88  CHECK-IS-STOPPED          VALUE 'S'.
   927             88  CHECK-IS-VOID             VALUE 'V'.
   928     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
   929     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL1742.cbl
   930     12  CQ-CHECK-BY-USER            PIC X(4).
   931     12  CQ-PRE-NUMBERING-SW         PIC X.
   932       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
   933       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
   934
   935     12  CQ-CHECK-WRITTEN-DT         PIC XX.
   936     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
   937     12  CQ-LEDGER-FLAG              PIC X(01).
   938     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
   939     12  CQ-LAST-UPDATED-DT          PIC XX.
   940     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
   941     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
   942
   943     12  FILLER                      PIC X(04).
   944
   945******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL1742.cbl
   947*    COPY ELCTRLR.
   948******************************************************************
   949*                                                                *
   950*                            ELCTRLR.                            *
   951*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   952*                            VMOD=2.014                          *
   953*                                                                *
   954*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
   955*                                                                *
   956*   FILE TYPE = VSAM,KSDS                                        *
   957*   RECORD SIZE = 200    RECFORM = FIXED                         *
   958*                                                                *
   959*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
   960*       ALTERNATE INDEX = NONE                                   *
   961*                                                                *
   962*   LOG = YES                                                    *
   963*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   964******************************************************************
   965*                   C H A N G E   L O G
   966*
   967* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   968*-----------------------------------------------------------------
   969*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   970* EFFECTIVE    NUMBER
   971*-----------------------------------------------------------------
   972* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   973* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
   974* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
   975* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
   976* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
   977* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
   978* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
   979* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
   980* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
   981* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
   982* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
   983* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
   984******************************************************************
   985 01  ACTIVITY-TRAILERS.
   986     12  AT-RECORD-ID                    PIC XX.
   987         88  VALID-AT-ID                       VALUE 'AT'.
   988
   989     12  AT-CONTROL-PRIMARY.
   990         16  AT-COMPANY-CD               PIC X.
   991         16  AT-CARRIER                  PIC X.
   992         16  AT-CLAIM-NO                 PIC X(7).
   993         16  AT-CERT-NO.
   994             20  AT-CERT-PRIME           PIC X(10).
   995             20  AT-CERT-SFX             PIC X.
   996         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
   997             88  AT-1ST-TRL-AVAIL             VALUE +4095.
   998             88  AT-LAST-TRL-AVAIL            VALUE +100.
   999             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  1000             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  1001             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  1002             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  1003             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  1004             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL1742.cbl
  1005             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  1006             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  1007             88  AT-DIAGNOSIS-TRL             VALUE +90.
  1008             88  AT-BENEFICIARY-TRL           VALUE +91.
  1009             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  1010
  1011     12  AT-TRAILER-TYPE                 PIC X.
  1012         88  RESERVE-EXPENSE-TR               VALUE '1'.
  1013         88  PAYMENT-TR                       VALUE '2'.
  1014         88  AUTO-PAY-TR                      VALUE '3'.
  1015         88  CORRESPONDENCE-TR                VALUE '4'.
  1016         88  ADDRESS-TR                       VALUE '5'.
  1017         88  GENERAL-INFO-TR                  VALUE '6'.
  1018         88  AUTO-PROMPT-TR                   VALUE '7'.
  1019         88  DENIAL-TR                        VALUE '8'.
  1020         88  INCURRED-CHG-TR                  VALUE '9'.
  1021         88  FORM-CONTROL-TR                  VALUE 'A'.
  1022
  1023     12  AT-RECORDED-DT                  PIC XX.
  1024     12  AT-RECORDED-BY                  PIC X(4).
  1025     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  1026
  1027     12  AT-TRAILER-BODY                 PIC X(165).
  1028
  1029     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  1030         16  AT-RESERVE-CONTROLS.
  1031             20  AT-MANUAL-SW            PIC X.
  1032                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  1033             20  AT-FUTURE-SW            PIC X.
  1034                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  1035             20  AT-PTC-SW               PIC X.
  1036                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  1037             20  AT-IBNR-SW              PIC X.
  1038                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  1039             20  AT-PTC-LF-SW            PIC X.
  1040                 88  AT-LF-PTC-USED          VALUE '1'.
  1041             20  AT-CDT-ACCESS-METHOD    PIC X.
  1042                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  1043                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  1044                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  1045             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  1046         16  AT-LAST-COMPUTED-DT         PIC XX.
  1047         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  1048         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  1049         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  1050         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  1051         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  1052         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  1053         16  AT-EXPENSE-CONTROLS.
  1054             20  AT-EXPENSE-METHOD       PIC X.
  1055                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  1056                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  1057                 88  PERCENT-OF-PMT           VALUE '3'.
  1058                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  1059             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  1060             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  1061         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  1062         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL1742.cbl
  1063
  1064         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  1065         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  1066
  1067*        16  FILLER                      PIC X(53).
  1068         16  FILLER                      PIC X(47).
  1069
  1070         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  1071         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  1072
  1073         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  1074             20  AT-OPEN-CLOSE-DATE      PIC XX.
  1075             20  AT-OPEN-CLOSE-TYPE      PIC X.
  1076*                    C = CLOSED
  1077*                    O = OPEN
  1078             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  1079*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  1080
  1081     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  1082         16  AT-PAYMENT-TYPE             PIC X.
  1083             88  PARTIAL-PAYMENT                VALUE '1'.
  1084             88  FINAL-PAYMENT                  VALUE '2'.
  1085             88  LUMP-SUM-PAYMENT               VALUE '3'.
  1086             88  ADDITIONAL-PAYMENT             VALUE '4'.
  1087             88  CHARGEABLE-EXPENSE             VALUE '5'.
  1088             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  1089             88  VOIDED-PAYMENT                 VALUE '9'.
  1090             88  TRANSFER                       VALUE 'T'.
  1091             88  LIFE-INTEREST                  VALUE 'I'.
  1092
  1093         16  AT-CLAIM-TYPE               PIC X.
  1094             88  PAID-FOR-AH                    VALUE 'A'.
  1095             88  PAID-FOR-LIFE                  VALUE 'L'.
  1096             88  PAID-FOR-IUI                   VALUE 'I'.
  1097             88  PAID-FOR-GAP                   VALUE 'G'.
  1098         16  AT-CLAIM-PREM-TYPE          PIC X.
  1099             88  AT-SINGLE-PREMIUM              VALUE '1'.
  1100             88  AT-O-B-COVERAGE                VALUE '2'.
  1101             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  1102         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  1103         16  AT-CHECK-NO                 PIC X(7).
  1104         16  AT-PAID-FROM-DT             PIC XX.
  1105         16  AT-PAID-THRU-DT             PIC XX.
  1106         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  1107         16  FILLER                      PIC X.
  1108         16  AT-PAYEES-NAME              PIC X(30).
  1109         16  AT-PAYMENT-ORIGIN           PIC X.
  1110             88  ONLINE-MANUAL-PMT              VALUE '1'.
  1111             88  ONLINE-AUTO-PMT                VALUE '2'.
  1112             88  OFFLINE-PMT                    VALUE '3'.
  1113         16  AT-CHECK-WRITTEN-DT         PIC XX.
  1114         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  1115         16  AT-VOID-DATA.
  1116             20  AT-VOID-DT              PIC XX.
  1117*00144       20  AT-VOID-REASON          PIC X(30).
  1118             20  AT-VOID-REASON          PIC X(26).
  1119         16  AT-PMT-APPROVED-BY          PIC X(04).
  1120         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL1742.cbl
  1121         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  1122         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  1123                                         PIC S99V9(5)  COMP-3.
  1124         16  AT-CREDIT-INTERFACE.
  1125             20  AT-PMT-SELECT-DT        PIC XX.
  1126                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  1127             20  AT-PMT-ACCEPT-DT        PIC XX.
  1128                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  1129             20  AT-VOID-SELECT-DT       PIC XX.
  1130                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  1131             20  AT-VOID-ACCEPT-DT       PIC XX.
  1132                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  1133
  1134         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  1135                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  1136                 88  CONVERSION-PAYMENT           VALUE +99999999.
  1137         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  1138
  1139         16  AT-FORCE-CONTROL            PIC X.
  1140             88  PAYMENT-WAS-FORCED           VALUE '1'.
  1141         16  AT-PREV-LAST-PMT-DT         PIC XX.
  1142         16  AT-PREV-PAID-THRU-DT        PIC XX.
  1143         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  1144         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  1145         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  1146         16  AT-BENEFIT-TYPE             PIC X.
  1147
  1148         16  AT-EXPENSE-TYPE             PIC X.
  1149         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  1150
  1151         16  AT-PAYEE-TYPE-CD.
  1152             20  AT-PAYEE-TYPE           PIC X.
  1153                 88  INSURED-PAID           VALUE 'I'.
  1154                 88  BENEFICIARY-PAID       VALUE 'B'.
  1155                 88  ACCOUNT-PAID           VALUE 'A'.
  1156                 88  OTHER-1-PAID           VALUE 'O'.
  1157                 88  OTHER-2-PAID           VALUE 'Q'.
  1158                 88  DOCTOR-PAID            VALUE 'P'.
  1159                 88  EMPLOYER-PAID          VALUE 'E'.
  1160             20  AT-PAYEE-SEQ            PIC X.
  1161
  1162         16  AT-CASH-PAYMENT             PIC X.
  1163         16  AT-GROUPED-PAYMENT          PIC X.
  1164         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  1165         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  1166         16  AT-APPROVED-LEVEL           PIC X.
  1167         16  AT-VOID-TYPE                PIC X.
  1168             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  1169             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  1170         16  AT-AIG-UNEMP-IND            PIC X.
  1171             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  1172         16  AT-ASSOCIATES               PIC X.
  1173             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  1174             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  1175
  1176         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  1177         16  AT-CV-PMT-CODE              PIC X.
  1178             88  FULL-DEATH-PAYMENT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL1742.cbl
  1179             88  HALF-DEATH-PAYMENT         VALUE '2'.
  1180             88  FULL-ADD-PAYMENT           VALUE '3'.
  1181             88  HALF-ADD-PAYMENT           VALUE '4'.
  1182             88  FULL-RIDER-PAYMENT         VALUE '5'.
  1183             88  HALF-RIDER-PAYMENT         VALUE '6'.
  1184             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  1185             88  ADDL-PAYMENT               VALUE '8'.
  1186
  1187         16  AT-EOB-CODE1                PIC XXX.
  1188         16  AT-EOB-CODE2                PIC XXX.
  1189         16  AT-EOB-CODE3                PIC XXX.
  1190         16  AT-EOB-CODE4                PIC XXX.
  1191         16  FILLER REDEFINES AT-EOB-CODE4.
  1192             20  AT-INT-PMT-SELECT-DT    PIC XX.
  1193             20  FILLER                  PIC X.
  1194         16  AT-EOB-CODE5                PIC XXX.
  1195         16  FILLER REDEFINES AT-EOB-CODE5.
  1196             20  AT-PMT-PROOF-DT         PIC XX.
  1197             20  FILLER                  PIC X.
  1198
  1199         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  1200             88  AT-PRINT-EOB            VALUE 'Y'.
  1201
  1202         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  1203         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  1204
  1205     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  1206         16  AT-SCHEDULE-START-DT        PIC XX.
  1207         16  AT-SCHEDULE-END-DT          PIC XX.
  1208         16  AT-TERMINATED-DT            PIC XX.
  1209         16  AT-LAST-PMT-TYPE            PIC X.
  1210             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  1211             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  1212         16  AT-FIRST-PMT-DATA.
  1213             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  1214             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  1215             20  AT-1ST-PAY-THRU-DT      PIC XX.
  1216         16  AT-REGULAR-PMT-DATA.
  1217             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  1218             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  1219             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  1220         16  AT-AUTO-PAYEE-CD.
  1221             20  AT-AUTO-PAYEE-TYPE      PIC X.
  1222                 88  INSURED-PAID-AUTO      VALUE 'I'.
  1223                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  1224                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  1225                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  1226                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  1227             20  AT-AUTO-PAYEE-SEQ       PIC X.
  1228         16  AT-AUTO-PAY-DAY             PIC 99.
  1229         16  AT-AUTO-CASH                PIC X.
  1230             88  AT-CASH                      VALUE 'Y'.
  1231             88  AT-NON-CASH                  VALUE 'N'.
  1232*        16  FILLER                      PIC X(129).
  1233         16  AT-AUTO-END-LETTER          PIC X(4).
  1234         16  FILLER                      PIC X(125).
  1235
  1236         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL1742.cbl
  1237         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  1238
  1239     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  1240         16  AT-LETTER-SENT-DT           PIC XX.
  1241         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  1242         16  AT-AUTO-RE-SEND-DT          PIC XX.
  1243         16  AT-LETTER-ANSWERED-DT       PIC XX.
  1244         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  1245         16  AT-LETTER-ORIGIN            PIC X.
  1246             88  ONLINE-CREATION              VALUE '1' '3'.
  1247             88  OFFLINE-CREATION             VALUE '2' '4'.
  1248             88  NAPER-ONLINE-CREATION        VALUE '3'.
  1249             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  1250         16  AT-STD-LETTER-FORM          PIC X(4).
  1251         16  AT-REASON-TEXT              PIC X(70).
  1252         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  1253         16  AT-ADDRESEE-TYPE            PIC X.
  1254              88  INSURED-ADDRESEE            VALUE 'I'.
  1255              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  1256              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  1257              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  1258              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  1259              88  OTHER-ADDRESEE-1            VALUE 'O'.
  1260              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  1261         16  AT-ADDRESSEE-NAME           PIC X(30).
  1262         16  AT-INITIAL-PRINT-DATE       PIC XX.
  1263         16  AT-RESEND-PRINT-DATE        PIC XX.
  1264         16  AT-CORR-SOL-UNSOL           PIC X.
  1265         16  AT-LETTER-PURGED-DT         PIC XX.
  1266*
  1267*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  1268*
  1269         16  AT-CSO-REDEFINITION.
  1270             20  AT-RESEND-LETTER-FORM   PIC X(4).
  1271             20  AT-AUTO-CLOSE-IND       PIC X(1).
  1272             20  AT-LETTER-TO-BENE       PIC X(1).
  1273             20  AT-STOP-LETTER-DT       PIC X(2).
  1274             20  FILLER                  PIC X(19).
  1275*             20  FILLER                  PIC X(27).
  1276             20  AT-CSO-LETTER-STATUS    PIC X.
  1277                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  1278                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  1279                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  1280             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  1281             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  1282*
  1283*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  1284*
  1285*        16  FILLER                      PIC X(26).
  1286*
  1287*        16  AT-DMD-BSR-CODE             PIC X.
  1288*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  1289*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  1290*
  1291*        16  AT-DMD-LETTER-STATUS        PIC X.
  1292*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  1293*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  1294*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL1742.cbl
  1295*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  1296*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  1297
  1298         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  1299         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  1300
  1301     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  1302         16  AT-ADDRESS-TYPE             PIC X.
  1303             88  INSURED-ADDRESS               VALUE 'I'.
  1304             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  1305             88  ACCOUNT-ADDRESS               VALUE 'A'.
  1306             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  1307             88  EMPLOYER-ADDRESS              VALUE 'E'.
  1308             88  OTHER-ADDRESS-1               VALUE 'O'.
  1309             88  OTHER-ADDRESS-2               VALUE 'Q'.
  1310         16  AT-MAIL-TO-NAME             PIC X(30).
  1311         16  AT-ADDRESS-LINE-1           PIC X(30).
  1312         16  AT-ADDRESS-LINE-2           PIC X(30).
  1313         16  AT-CITY-STATE.
  1314             20  AT-CITY                 PIC X(28).
  1315             20  AT-STATE                PIC XX.
  1316         16  AT-ZIP.
  1317             20  AT-ZIP-CODE.
  1318                 24  AT-ZIP-1ST          PIC X.
  1319                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1320                 24  FILLER              PIC X(4).
  1321             20  AT-ZIP-PLUS4            PIC X(4).
  1322         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  1323             20  AT-CAN-POSTAL-1         PIC XXX.
  1324             20  AT-CAN-POSTAL-2         PIC XXX.
  1325             20  FILLER                  PIC XXX.
  1326         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  1327         16  FILLER                      PIC X(23).
  1328         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  1329         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  1330
  1331     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1332         16  AT-INFO-LINE-1              PIC X(60).
  1333         16  AT-INFO-LINE-2              PIC X(60).
  1334         16  AT-INFO-TRAILER-TYPE        PIC X.
  1335             88  AT-PAYMENT-NOTE         VALUE 'P'.
  1336             88  AT-CALL-NOTE            VALUE 'C'.
  1337             88  AT-MAINT-NOTE           VALUE 'M'.
  1338             88  AT-CERT-CHANGE          VALUE 'X'.
  1339             88  AT-APPROVAL-NOTE        VALUE 'R'.
  1340             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  1341         16  AT-CALL-TYPE                PIC X.
  1342             88  AT-PHONE-CALL-IN        VALUE 'I'.
  1343             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  1344         16  AT-NOTE-CONTINUATION        PIC X.
  1345             88  AT-CONTINUED-NOTE       VALUE 'X'.
  1346         16  AT-EOB-CODES-EXIST          PIC X.
  1347             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  1348         16  FILLER                      PIC X(35).
  1349         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  1350         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  1351
  1352     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL1742.cbl
  1353         16  AT-PROMPT-LINE-1            PIC X(60).
  1354         16  AT-PROMPT-LINE-2            PIC X(60).
  1355         16  AT-PROMPT-START-DT          PIC XX.
  1356         16  AT-PROMPT-END-DT            PIC XX.
  1357         16  FILLER                      PIC X(35).
  1358         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  1359         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  1360
  1361     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1362         16  AT-DENIAL-INFO-1            PIC X(60).
  1363         16  AT-DENIAL-INFO-2            PIC X(60).
  1364         16  AT-DENIAL-DT                PIC XX.
  1365         16  AT-RETRACTION-DT            PIC XX.
  1366         16  AT-DENIAL-REASON-CODE       PIC X(4).
  1367*         16  FILLER                      PIC X(31).
  1368         16  AT-DENIAL-PROOF-DT          PIC XX.
  1369         16  FILLER                      PIC X(29).
  1370         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  1371         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  1372
  1373     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  1374         16  AT-OLD-INCURRED-DT          PIC XX.
  1375         16  AT-OLD-REPORTED-DT          PIC XX.
  1376         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  1377         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  1378         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  1379         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  1380         16  AT-OLD-PAID-THRU-DT         PIC XX.
  1381         16  AT-LAST-PMT-MADE-DT         PIC XX.
  1382         16  FILLER                      PIC X(26).
  1383         16  AT-OLD-DIAG-CODE            PIC X(6).
  1384         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  1385         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  1386         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  1387         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  1388         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  1389         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  1390         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  1391         16  FILLER                      PIC X(25).
  1392         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  1393
  1394     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  1395         16  AT-FORM-SEND-ON-DT          PIC XX.
  1396         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  1397         16  AT-FORM-RE-SEND-DT          PIC XX.
  1398         16  AT-FORM-ANSWERED-DT         PIC XX.
  1399         16  AT-FORM-PRINTED-DT          PIC XX.
  1400         16  AT-FORM-REPRINT-DT          PIC XX.
  1401         16  AT-FORM-TYPE                PIC X.
  1402             88  INITIAL-FORM                  VALUE '1'.
  1403             88  PROGRESS-FORM                 VALUE '2'.
  1404         16  AT-INSTRUCT-LN-1            PIC X(28).
  1405         16  AT-INSTRUCT-LN-2            PIC X(28).
  1406         16  AT-INSTRUCT-LN-3            PIC X(28).
  1407         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  1408         16  AT-FORM-ADDRESS             PIC X.
  1409             88  FORM-TO-INSURED              VALUE 'I'.
  1410             88  FORM-TO-ACCOUNT              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL1742.cbl
  1411             88  FORM-TO-OTHER-1              VALUE 'O'.
  1412             88  FORM-TO-OTHER-2              VALUE 'Q'.
  1413         16  AT-RELATED-1.
  1414             20 AT-REL-CARR-1            PIC X.
  1415             20 AT-REL-CLAIM-1           PIC X(7).
  1416             20 AT-REL-CERT-1            PIC X(11).
  1417         16  AT-RELATED-2.
  1418             20 AT-REL-CARR-2            PIC X.
  1419             20 AT-REL-CLAIM-2           PIC X(7).
  1420             20 AT-REL-CERT-2            PIC X(11).
  1421         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  1422         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  1423         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  1424         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  1425         16  AT-FORM-REM-PRINT-DT        PIC XX.
  1426         16  AT-STOP-FORM-DT             PIC X(2).
  1427
  1428         16  FILLER                      PIC X(09).
  1429         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  1430         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  1431******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL1742.cbl
  1433 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-QUE
  1434                          ACTIVITY-TRAILERS.
  1435 0000-DFHEXIT SECTION.
  1436     MOVE '9#                    $   ' TO DFHEIV0.
  1437     MOVE 'EL1742' TO DFHEIV1.
  1438     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1439
  1440     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  1441     MOVE '5'                   TO DC-OPTION-CODE.
  1442     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  1443     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  1444     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  1445
  1446     MOVE 80                     TO WS-LINE-LEN.
  1447
  1448     MOVE SPACES                 TO DL34-PROCESS-TYPE.
  1449
  1450 0100-RETRIEVE-LOOP.
  1451
  1452* EXEC CICS HANDLE CONDITION
  1453*         ENDDATA    (200-END-DATA)
  1454*         ENDFILE    (4800-END-OF-FILE)
  1455*         NOTFND     (300-NOT-FOUND)
  1456*    END-EXEC.
  1457*    MOVE '"$&''I                 ! " #00001447' TO DFHEIV0
  1458     MOVE X'222426274920202020202020' TO DFHEIV0(1:12)
  1459     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1460     MOVE X'2220233030303031343437' TO DFHEIV0(25:11)
  1461     CALL 'kxdfhei1' USING DFHEIV0
  1462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1463
  1464
  1465
  1466* EXEC CICS RETRIEVE
  1467*         INTO(PROGRAM-INTERFACE-BLOCK)
  1468*         LENGTH(PI-COMM-LENGTH)
  1469*    END-EXEC.
  1470*    MOVE '0*I L                 &   #00001453' TO DFHEIV0
  1471     MOVE X'302A49204C20202020202020' TO DFHEIV0(1:12)
  1472     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1473     MOVE X'2020233030303031343533' TO DFHEIV0(25:11)
  1474     CALL 'kxdfhei1' USING DFHEIV0,
  1475           PROGRAM-INTERFACE-BLOCK,
  1476           PI-COMM-LENGTH,
  1477           DFHEIV99,
  1478           DFHEIV99,
  1479           DFHEIV99
  1480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1481
  1482
  1483* DLO034 OPEN WHEN DMD OR CID
  1484     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  1485         IF DL34-PROCESS-TYPE = SPACES
  1486             MOVE 'O'                TO DL34-PROCESS-TYPE
  1487             MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  1488             MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  1489             MOVE PI-PROCESSOR-ID    TO DL34-USERID
  1490             MOVE SPACES             TO DL34-PRINT-LINE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL1742.cbl
  1491             MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
  1492
  1493* EXEC CICS LINK
  1494*                PROGRAM    ('DLO034')
  1495*                COMMAREA   (DLO034-COMMUNICATION-AREA)
  1496*                LENGTH     (DLO034-REC-LENGTH)
  1497*            END-EXEC
  1498     MOVE 'DLO034' TO DFHEIV1
  1499*    MOVE '."C                   ''   #00001467' TO DFHEIV0
  1500     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1501     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1502     MOVE X'2020233030303031343637' TO DFHEIV0(25:11)
  1503     CALL 'kxdfhei1' USING DFHEIV0,
  1504           DFHEIV1,
  1505           DLO034-COMMUNICATION-AREA,
  1506           DLO034-REC-LENGTH,
  1507           DFHEIV99,
  1508           DFHEIV99,
  1509           DFHEIV99
  1510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1511             IF DL34-RETURN-CODE NOT = 'OK'
  1512                 MOVE  '**DLO034 OPEN ERROR - ABORT**'
  1513                                     TO ERROR-LINE
  1514                 PERFORM 400-SEND-TEXT
  1515
  1516* EXEC CICS
  1517*                    RETURN
  1518*                END-EXEC.
  1519*    MOVE '.(                    &   #00001476' TO DFHEIV0
  1520     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1521     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1522     MOVE X'2020233030303031343736' TO DFHEIV0(25:11)
  1523     CALL 'kxdfhei1' USING DFHEIV0,
  1524           DFHEIV99,
  1525           DFHEIV99,
  1526           DFHEIV99,
  1527           DFHEIV99,
  1528           DFHEIV99
  1529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1530
  1531
  1532     PERFORM 1000-INITIALIZE.
  1533
  1534     PERFORM 4000-BROWSE-CHECK-QUEUE-FILE.
  1535
  1536     MOVE SPACES                 TO TOTAL-LINE.
  1537     MOVE PI-LIFE-OVERRIDE-L6    TO EL174A-NO-CHECKS-DESC.
  1538     MOVE WS-NO-CHECKS-L         TO EL174A-NO-CHECKS.
  1539     MOVE PI-CONTROL-TOT-L       TO EL174A-CNTL-TOTAL.
  1540     MOVE TOTAL-LINE             TO WS-PASSED-DATA.
  1541     MOVE '0'                    TO WS-PASSED-CNTL-CHAR.
  1542     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1543     PERFORM 3000-BUMP-LINE-COUNT.
  1544
  1545     MOVE SPACES                 TO TOTAL-LINE.
  1546     MOVE PI-AH-OVERRIDE-L6      TO EL174A-NO-CHECKS-DESC.
  1547     MOVE WS-NO-CHECKS-A         TO EL174A-NO-CHECKS.
  1548     MOVE PI-CONTROL-TOT-A       TO EL174A-CNTL-TOTAL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL1742.cbl
  1549     MOVE TOTAL-LINE             TO WS-PASSED-DATA.
  1550     MOVE ' '                    TO WS-PASSED-CNTL-CHAR.
  1551     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1552     PERFORM 3000-BUMP-LINE-COUNT.
  1553
  1554     MOVE SPACES                 TO TOTAL-LINE.
  1555     MOVE 'NO. CHECKS'           TO EL174A-NO-CHECKS-DESC.
  1556     MOVE WS-NO-CHECKS           TO EL174A-NO-CHECKS.
  1557     MOVE 'CONTL TOTAL'          TO EL174A-CNTL-DESC.
  1558     MOVE PI-CONTROL-TOT         TO EL174A-CNTL-TOTAL.
  1559     MOVE TOTAL-LINE             TO WS-PASSED-DATA.
  1560     MOVE ' '                    TO WS-PASSED-CNTL-CHAR.
  1561     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1562     PERFORM 3000-BUMP-LINE-COUNT.
  1563
  1564     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  1565       IF PI-CALLING-PROGRAM = 'EL175'
  1566         MOVE SPACES              TO TOTAL-LINE
  1567         MOVE 'NON CASH  '        TO EL174A-NO-CHECKS-DESC
  1568         MOVE PI-NON-CASH-REL-CNT TO EL174A-NO-CHECKS
  1569         MOVE PI-NON-CASH-REL-AMT TO EL174A-CNTL-TOTAL
  1570         MOVE TOTAL-LINE          TO WS-PASSED-DATA
  1571         MOVE '0'                 TO WS-PASSED-CNTL-CHAR
  1572         PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  1573         PERFORM 3000-BUMP-LINE-COUNT
  1574         ADD PI-NON-CASH-REL-CNT TO PI-TOT-CHECKS
  1575         ADD PI-NON-CASH-REL-AMT TO PI-CONTROL-GRAND-TOT.
  1576
  1577     MOVE SPACES                 TO TOTAL-LINE.
  1578     MOVE PI-LIFE-OVERRIDE-L6    TO EL174A-NO-CHECKS-DESC.
  1579     MOVE PI-TOT-CHECKS-L        TO EL174A-NO-CHECKS.
  1580     MOVE PI-CONTROL-GRAND-TOT-L TO EL174A-CNTL-TOTAL.
  1581     MOVE TOTAL-LINE             TO WS-PASSED-DATA.
  1582     MOVE '0'                    TO WS-PASSED-CNTL-CHAR.
  1583     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1584     PERFORM 3000-BUMP-LINE-COUNT.
  1585
  1586     MOVE SPACES                 TO TOTAL-LINE.
  1587     MOVE PI-AH-OVERRIDE-L6      TO EL174A-NO-CHECKS-DESC.
  1588     MOVE PI-TOT-CHECKS-A        TO EL174A-NO-CHECKS.
  1589     MOVE PI-CONTROL-GRAND-TOT-A TO EL174A-CNTL-TOTAL.
  1590     MOVE TOTAL-LINE             TO WS-PASSED-DATA.
  1591     MOVE ' '                    TO WS-PASSED-CNTL-CHAR.
  1592     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1593     PERFORM 3000-BUMP-LINE-COUNT.
  1594
  1595     MOVE SPACES                 TO TOTAL-LINE.
  1596     MOVE 'NO. CHECKS'           TO EL174A-NO-CHECKS-DESC.
  1597     MOVE PI-TOT-CHECKS          TO EL174A-NO-CHECKS.
  1598     MOVE 'GRAND TOTAL'          TO EL174A-CNTL-DESC.
  1599     MOVE PI-CONTROL-GRAND-TOT   TO EL174A-CNTL-TOTAL.
  1600     MOVE TOTAL-LINE             TO WS-PASSED-DATA.
  1601     MOVE ' '                    TO WS-PASSED-CNTL-CHAR.
  1602     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1603     MOVE 'X'                    TO WS-PROG-END.
  1604     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1605     GO TO 0100-RETRIEVE-LOOP.
  1606
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL1742.cbl
  1607 200-END-DATA.
  1608
  1609* DLO034 CLOSE
  1610     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  1611         MOVE 'C'                TO DL34-PROCESS-TYPE
  1612         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  1613         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  1614         MOVE PI-PROCESSOR-ID    TO DL34-USERID
  1615         MOVE SPACES             TO DL34-PRINT-LINE
  1616                                    DL34-OVERRIDE-PRINTER-ID
  1617
  1618* EXEC CICS LINK
  1619*            PROGRAM    ('DLO034')
  1620*            COMMAREA   (DLO034-COMMUNICATION-AREA)
  1621*            LENGTH     (DLO034-REC-LENGTH)
  1622*        END-EXEC
  1623     MOVE 'DLO034' TO DFHEIV1
  1624*    MOVE '."C                   ''   #00001565' TO DFHEIV0
  1625     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1626     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1627     MOVE X'2020233030303031353635' TO DFHEIV0(25:11)
  1628     CALL 'kxdfhei1' USING DFHEIV0,
  1629           DFHEIV1,
  1630           DLO034-COMMUNICATION-AREA,
  1631           DLO034-REC-LENGTH,
  1632           DFHEIV99,
  1633           DFHEIV99,
  1634           DFHEIV99
  1635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1636         IF DL34-RETURN-CODE NOT = 'OK'
  1637             MOVE  '**DLO034 CLOSE ERROR - ABORT**'
  1638                                 TO ERROR-LINE
  1639             PERFORM 400-SEND-TEXT.
  1640
  1641
  1642* EXEC CICS RETURN
  1643*    END-EXEC.
  1644*    MOVE '.(                    &   #00001575' TO DFHEIV0
  1645     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1646     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1647     MOVE X'2020233030303031353735' TO DFHEIV0(25:11)
  1648     CALL 'kxdfhei1' USING DFHEIV0,
  1649           DFHEIV99,
  1650           DFHEIV99,
  1651           DFHEIV99,
  1652           DFHEIV99,
  1653           DFHEIV99
  1654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1655
  1656
  1657 300-NOT-FOUND.
  1658     MOVE 'NO COMMUNICATION AREA FOUND' TO ERROR-LINE.
  1659
  1660     PERFORM 400-SEND-TEXT.
  1661
  1662     GO TO 200-END-DATA.
  1663
  1664 400-SEND-TEXT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL1742.cbl
  1665
  1666* EXEC CICS SEND TEXT
  1667*         FROM  (ERROR-LINE)
  1668*         LENGTH(70)
  1669*    END-EXEC.
  1670     MOVE 70
  1671       TO DFHEIV11
  1672*    MOVE '8&      T       H   F -   #00001586' TO DFHEIV0
  1673     MOVE X'382620202020202054202020' TO DFHEIV0(1:12)
  1674     MOVE X'202020204820202046202D20' TO DFHEIV0(13:12)
  1675     MOVE X'2020233030303031353836' TO DFHEIV0(25:11)
  1676     CALL 'kxdfhei1' USING DFHEIV0,
  1677           ERROR-LINE,
  1678           DFHEIV11,
  1679           DFHEIV99,
  1680           DFHEIV99,
  1681           DFHEIV99,
  1682           DFHEIV99,
  1683           DFHEIV99,
  1684           DFHEIV99,
  1685           DFHEIV99,
  1686           DFHEIV99,
  1687           DFHEIV99,
  1688           DFHEIV99
  1689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1690
  1691
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL1742.cbl
  1693 1000-INITIALIZE    SECTION.
  1694
  1695*    NOTE *******************************************************
  1696*         *                                                     *
  1697*         *      INITALIZE THE WORK FIELDS FOR THE PROGRAM      *
  1698*         *  INTERFACE BLOCK FOR THIS MODULE.                   *
  1699*         *                                                     *
  1700*         *******************************************************.
  1701
  1702     IF PI-CALLING-PROGRAM = 'EL175'
  1703         MOVE LOW-VALUES         TO  PI-CK-COMPANY-CODE
  1704                                     PI-CK-CARRIER
  1705                                     PI-CK-GROUPING
  1706                                     PI-CK-STATE
  1707                                     PI-CK-BENE-ACCT
  1708         MOVE ZEROS              TO  PI-CK-SEQUENCE-NO
  1709         MOVE 'R'                TO  PI-CHECK-MODE
  1710     ELSE
  1711         IF CHECKS-PRINTED
  1712             MOVE LOW-VALUES             TO  PI-CHECK-AIX-KEY
  1713             MOVE PI-START-CONTROL-NO    TO  PI-CK-CONTROL-NO
  1714         ELSE
  1715             MOVE LOW-VALUES             TO  PI-CHECK-AIX-KEY.
  1716
  1717     MOVE LOW-VALUES             TO  PI-PREV-CHECK-AIX-KEY.
  1718
  1719     MOVE ZEROS                  TO  PI-CONTROL-TOT
  1720                                     PI-CONTROL-TOT-L
  1721                                     PI-CONTROL-TOT-A
  1722                                     PI-CONTROL-SAVE-CONTROL
  1723                                     PI-CONTROL-GRAND-TOT
  1724                                     PI-CONTROL-GRAND-TOT-L
  1725                                     PI-CONTROL-GRAND-TOT-A
  1726                                     PI-TOT-CHECKS
  1727                                     PI-TOT-CHECKS-L
  1728                                     PI-TOT-CHECKS-A
  1729                                     WS-NO-CHECKS-L
  1730                                     WS-NO-CHECKS-A
  1731                                     WS-NO-CHECKS.
  1732     MOVE 1                      TO  PI-PAGE
  1733                                     PI-LINE-COUNT.
  1734
  1735     MOVE PI-COMPANY-CD          TO PI-CK-COMPANY-CODE.
  1736     MOVE 'Y'                    TO PI-FIRST-TIME-SWT.
  1737
  1738     MOVE EIBTIME                TO  WS-TIME-WORK.
  1739
  1740     MOVE SAVE-DATE              TO  ADATE.
  1741     MOVE WS-TIME                TO  ATIME.
  1742     MOVE PI-COMPANY-ID          TO  ACOMP.
  1743     PERFORM 2000-PRINT-HEADING.
  1744
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL1742.cbl
  1746 2000-PRINT-HEADING   SECTION.
  1747     MOVE PI-PAGE                TO PAGE-NO.
  1748
  1749     IF CHECKS-TO-BE-PRINTED
  1750         MOVE VAR-HEADING1A      TO HDG1
  1751     ELSE
  1752         IF CHECKS-PRINTED
  1753             MOVE VAR-HEADING1B  TO HDG1
  1754             MOVE 'EL174B'       TO HDG1-RPT
  1755         ELSE
  1756             MOVE VAR-HEADING1C  TO HDG1
  1757             MOVE 'EL175A'       TO HDG1-RPT.
  1758
  1759     MOVE '1'                    TO WS-PASSED-CNTL-CHAR.
  1760
  1761     IF PI-COMPANY-ID = 'AFL' OR 'AFC' OR 'RIC' OR 'SRL'
  1762         IF PI-FIRST-TIME-SWT = 'Y'
  1763             MOVE ' '            TO WS-PASSED-CNTL-CHAR.
  1764
  1765     MOVE HEADING-1              TO WS-PASSED-DATA.
  1766     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1767     MOVE 1                      TO PI-LINE-COUNT.
  1768
  1769     MOVE HEADING-2              TO WS-PASSED-DATA.
  1770     MOVE '0'                    TO WS-PASSED-CNTL-CHAR.
  1771     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1772     ADD 2                       TO PI-LINE-COUNT.
  1773
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL1742.cbl
  1775 3000-BUMP-LINE-COUNT   SECTION.
  1776     IF WS-PASSED-CNTL-CHAR = SPACES
  1777        ADD 1                    TO PI-LINE-COUNT
  1778      ELSE
  1779        ADD  2                   TO PI-LINE-COUNT.
  1780
  1781     IF PI-LINE-COUNT GREATER 60
  1782        MOVE ZEROS TO PI-LINE-COUNT
  1783        ADD 1   TO PI-PAGE
  1784        PERFORM 2000-PRINT-HEADING.
  1785
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL1742.cbl
  1787 4000-BROWSE-CHECK-QUEUE-FILE SECTION.
  1788
  1789
  1790* EXEC CICS STARTBR
  1791*        DATASET (WS-CHECK-AIX-DSID)
  1792*        RIDFLD  (PI-CHECK-AIX-KEY)
  1793*        GTEQ
  1794*    END-EXEC.
  1795     MOVE 0
  1796       TO DFHEIV11
  1797*    MOVE '&,         G          &   #00001688' TO DFHEIV0
  1798     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1799     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1800     MOVE X'2020233030303031363838' TO DFHEIV0(25:11)
  1801     CALL 'kxdfhei1' USING DFHEIV0,
  1802           WS-CHECK-AIX-DSID,
  1803           PI-CHECK-AIX-KEY,
  1804           DFHEIV99,
  1805           DFHEIV11,
  1806           DFHEIV99
  1807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1808
  1809
  1810 4100-READNEXT.
  1811     MOVE PI-CHECK-AIX-KEY           TO  PI-PREV-CHECK-AIX-KEY.
  1812
  1813
  1814* EXEC CICS READNEXT
  1815*        DATASET (WS-CHECK-AIX-DSID)
  1816*        RIDFLD  (PI-CHECK-AIX-KEY)
  1817*        SET     (ADDRESS OF CHECK-QUE)
  1818*    END-EXEC.
  1819     MOVE 0
  1820       TO DFHEIV11
  1821*    MOVE '&.S                   )   #00001697' TO DFHEIV0
  1822     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1823     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1824     MOVE X'2020233030303031363937' TO DFHEIV0(25:11)
  1825     CALL 'kxdfhei1' USING DFHEIV0,
  1826           WS-CHECK-AIX-DSID,
  1827           DFHEIV20,
  1828           DFHEIV99,
  1829           PI-CHECK-AIX-KEY,
  1830           DFHEIV99,
  1831           DFHEIV11,
  1832           DFHEIV99,
  1833           DFHEIV99
  1834     SET ADDRESS OF CHECK-QUE TO
  1835         DFHEIV20
  1836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1837
  1838
  1839     IF CQ-COMPANY-CD NOT = PI-COMPANY-CD
  1840         GO TO 4800-END-OF-FILE.
  1841
  1842     IF PI-CALLING-PROGRAM = 'EL175'
  1843        IF PI-COMPANY-ID = 'DMD'
  1844           IF CQ-CONTROL-NUMBER NOT = PI-END-CONTROL-NO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL1742.cbl
  1845              GO TO 4100-READNEXT
  1846            ELSE
  1847              NEXT SENTENCE
  1848          ELSE
  1849        IF PI-CONTROL-SAVE-CONTROL NOT = CQ-CONTROL-NUMBER
  1850           IF NOT PI-FIRST-TIME
  1851              IF CQ-CONTROL-NUMBER > PI-END-CONTROL-NO
  1852                 GO TO 4800-END-OF-FILE.
  1853
  1854     IF CQ-ENTRY-TYPE NOT = 'Q'
  1855         GO TO 4100-READNEXT.
  1856
  1857     IF CHECKS-TO-BE-PRINTED
  1858         IF CQ-TIMES-PRINTED NOT = ZERO
  1859             GO TO 4100-READNEXT.
  1860
  1861     IF CHECKS-PRINTED
  1862         IF CQ-TIMES-PRINTED = ZERO
  1863             GO TO 4100-READNEXT.
  1864
  1865     IF PI-COMPANY-ID = 'DMD'
  1866     IF CHECKS-PRINTED
  1867        IF PI-START-CONTROL-NO > CQ-CONTROL-NUMBER
  1868           GO TO 4100-READNEXT.
  1869
  1870     IF PI-CONTROL-SAVE-CONTROL NOT = CQ-CONTROL-NUMBER
  1871        IF PI-FIRST-TIME
  1872           NEXT SENTENCE
  1873        ELSE
  1874           MOVE SPACES              TO  TOTAL-LINE
  1875           MOVE PI-LIFE-OVERRIDE-L6 TO EL174A-NO-CHECKS-DESC
  1876           MOVE WS-NO-CHECKS-L      TO EL174A-NO-CHECKS
  1877           MOVE PI-CONTROL-TOT-L    TO EL174A-CNTL-TOTAL
  1878           MOVE TOTAL-LINE          TO WS-PASSED-DATA
  1879           MOVE '0'                 TO WS-PASSED-CNTL-CHAR
  1880           PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  1881           PERFORM 3000-BUMP-LINE-COUNT
  1882           MOVE SPACES              TO TOTAL-LINE
  1883           MOVE PI-AH-OVERRIDE-L6   TO EL174A-NO-CHECKS-DESC
  1884           MOVE WS-NO-CHECKS-A      TO EL174A-NO-CHECKS
  1885           MOVE PI-CONTROL-TOT-A    TO EL174A-CNTL-TOTAL
  1886           MOVE TOTAL-LINE          TO WS-PASSED-DATA
  1887           MOVE ' '                 TO WS-PASSED-CNTL-CHAR
  1888           PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  1889           PERFORM 3000-BUMP-LINE-COUNT
  1890           MOVE SPACES                 TO TOTAL-LINE
  1891           MOVE 'NO. CHECKS'           TO EL174A-NO-CHECKS-DESC
  1892           MOVE WS-NO-CHECKS           TO EL174A-NO-CHECKS
  1893           MOVE 'CONTL TOTAL'          TO EL174A-CNTL-DESC
  1894           MOVE PI-CONTROL-TOT         TO EL174A-CNTL-TOTAL
  1895           MOVE TOTAL-LINE             TO WS-PASSED-DATA
  1896           MOVE ' '                    TO WS-PASSED-CNTL-CHAR
  1897           PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  1898           PERFORM 3000-BUMP-LINE-COUNT
  1899           MOVE SPACES                 TO WS-PASSED-DATA
  1900           MOVE '0'                    TO WS-PASSED-CNTL-CHAR
  1901           PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  1902           PERFORM 3000-BUMP-LINE-COUNT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL1742.cbl
  1903           MOVE ZEROS            TO PI-CONTROL-TOT
  1904                                    PI-CONTROL-TOT-L
  1905                                    PI-CONTROL-TOT-A
  1906                                    WS-NO-CHECKS-L
  1907                                    WS-NO-CHECKS-A
  1908                                    WS-NO-CHECKS.
  1909
  1910     MOVE CQ-CONTROL-NUMBER      TO PI-CONTROL-SAVE-CONTROL.
  1911     MOVE 'N'                    TO PI-FIRST-TIME-SWT.
  1912
  1913     ADD +1                      TO WS-NO-CHECKS
  1914                                    PI-TOT-CHECKS.
  1915     IF CQ-LIFE-CLAIM
  1916         ADD +1                  TO WS-NO-CHECKS-L
  1917                                    PI-TOT-CHECKS-L
  1918         ADD CQ-CHECK-AMOUNT     TO PI-CONTROL-TOT-L
  1919                                    PI-CONTROL-GRAND-TOT-L
  1920      ELSE
  1921     IF CQ-AH-CLAIM
  1922         ADD +1                  TO WS-NO-CHECKS-A
  1923                                    PI-TOT-CHECKS-A
  1924         ADD CQ-CHECK-AMOUNT     TO PI-CONTROL-TOT-A
  1925                                    PI-CONTROL-GRAND-TOT-A.
  1926
  1927     MOVE SPACES                 TO DETAIL-LINE.
  1928     ADD CQ-CHECK-AMOUNT         TO PI-CONTROL-TOT.
  1929     MOVE CQ-CONTROL-NUMBER      TO EL174A-CONTROL.
  1930     MOVE CQ-CHECK-NUMBER        TO EL174A-CHECK-NO.
  1931
  1932     IF CQ-PAYMENT-TYPE = '1'
  1933         MOVE 'PARTIAL'          TO EL174A-PMT-TYPE
  1934       ELSE
  1935     IF CQ-PAYMENT-TYPE = '2'
  1936         MOVE 'FINAL'            TO EL174A-PMT-TYPE
  1937       ELSE
  1938     IF CQ-PAYMENT-TYPE = '3'
  1939         MOVE 'LUMP SUM'         TO EL174A-PMT-TYPE
  1940       ELSE
  1941     IF CQ-PAYMENT-TYPE = '4'
  1942         MOVE 'ADDITIONAL'       TO EL174A-PMT-TYPE
  1943       ELSE
  1944     IF CQ-PAYMENT-TYPE = '5'
  1945         MOVE 'CHG EXP'          TO EL174A-PMT-TYPE
  1946       ELSE
  1947     IF CQ-PAYMENT-TYPE = '6'
  1948         MOVE 'NON CHG EXP'      TO EL174A-PMT-TYPE
  1949       ELSE
  1950     IF CQ-PAYMENT-TYPE = '7'
  1951         MOVE 'LIFE REFUND'      TO EL174A-PMT-TYPE
  1952       ELSE
  1953     IF CQ-PAYMENT-TYPE = '8'
  1954         MOVE 'A&H REFUND'       TO EL174A-PMT-TYPE.
  1955
  1956     IF CQ-LIFE-CLAIM
  1957         MOVE 'L'                TO EL174A-COV-TYPE
  1958       ELSE
  1959         MOVE 'A'                TO EL174A-COV-TYPE.
  1960
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL1742.cbl
  1961     ADD CQ-CHECK-AMOUNT        TO  PI-CONTROL-GRAND-TOT.
  1962     MOVE CQ-CLAIM-NO           TO  EL174A-CLAIM-NO.
  1963     MOVE CQ-CARRIER            TO  EL174A-CARRIER.
  1964     MOVE CQ-CERT-NO            TO  EL174A-CERT-NO.
  1965     MOVE CQ-CHECK-AMOUNT       TO  EL174A-AMT.
  1966
  1967     MOVE SPACES                TO  WS-ACTIVITY-TRAILERS-KEY.
  1968
  1969     MOVE CQ-COMPANY-CD         TO  WS-ATK-COMPANY-CD.
  1970     MOVE CQ-CARRIER            TO  WS-ATK-CARRIER.
  1971     MOVE CQ-CLAIM-NO           TO  WS-ATK-CLAIM-NO.
  1972     MOVE CQ-CERT-NO            TO  WS-ATK-CERT-NO.
  1973     MOVE CQ-PMT-TRLR-SEQUENCE  TO  WS-ATK-SEQUENCE-NO.
  1974
  1975
  1976* EXEC CICS READ
  1977*        DATASET (WS-ACTIVITY-TRAILERS-DSID)
  1978*        RIDFLD  (WS-ACTIVITY-TRAILERS-KEY)
  1979*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  1980*    END-EXEC.
  1981*    MOVE '&"S        E          (   #00001839' TO DFHEIV0
  1982     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1983     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1984     MOVE X'2020233030303031383339' TO DFHEIV0(25:11)
  1985     CALL 'kxdfhei1' USING DFHEIV0,
  1986           WS-ACTIVITY-TRAILERS-DSID,
  1987           DFHEIV20,
  1988           DFHEIV99,
  1989           WS-ACTIVITY-TRAILERS-KEY,
  1990           DFHEIV99,
  1991           DFHEIV99,
  1992           DFHEIV99
  1993     SET ADDRESS OF ACTIVITY-TRAILERS TO
  1994         DFHEIV20
  1995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1996
  1997
  1998     IF AT-PAYEE-TYPE = 'I'
  1999         MOVE 'INSURED'          TO  EL174A-PAYEE
  2000       ELSE
  2001     IF AT-PAYEE-TYPE = 'B'
  2002         MOVE 'BENEFICIARY'      TO  EL174A-PAYEE
  2003       ELSE
  2004     IF AT-PAYEE-TYPE = 'A'
  2005         MOVE 'ACCOUNT'          TO  EL174A-PAYEE
  2006       ELSE
  2007     IF AT-PAYEE-TYPE = 'O'
  2008         MOVE 'OTHER 1'          TO  EL174A-PAYEE
  2009       ELSE
  2010     IF AT-PAYEE-TYPE = 'Q'
  2011         MOVE 'OTHER 2'          TO  EL174A-PAYEE
  2012       ELSE
  2013     IF AT-PAYEE-TYPE = 'P'
  2014         MOVE 'DOCTOR'           TO  EL174A-PAYEE
  2015       ELSE
  2016     IF AT-PAYEE-TYPE = 'E'
  2017         MOVE 'EMPLOYER'         TO  EL174A-PAYEE.
  2018
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL1742.cbl
  2019     MOVE AT-RECORDED-BY         TO  EL174A-BY.
  2020
  2021     MOVE DETAIL-LINE            TO WS-PASSED-DATA.
  2022     MOVE ' '                    TO WS-PASSED-CNTL-CHAR.
  2023     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  2024     PERFORM 3000-BUMP-LINE-COUNT.
  2025
  2026     GO TO 4100-READNEXT.
  2027
  2028 4800-END-OF-FILE.
  2029     IF PI-PREV-CHECK-AIX-KEY  = LOW-VALUES
  2030        GO TO 4990-EXIT.
  2031
  2032
  2033* EXEC CICS ENDBR
  2034*        DATASET (WS-CHECK-AIX-DSID)
  2035*    END-EXEC.
  2036     MOVE 0
  2037       TO DFHEIV11
  2038*    MOVE '&2                    $   #00001879' TO DFHEIV0
  2039     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2040     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2041     MOVE X'2020233030303031383739' TO DFHEIV0(25:11)
  2042     CALL 'kxdfhei1' USING DFHEIV0,
  2043           WS-CHECK-AIX-DSID,
  2044           DFHEIV11,
  2045           DFHEIV99
  2046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2047
  2048
  2049 4990-EXIT.
  2050      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL1742.cbl
  2052*9500-PRINT-ROUTINE SECTION.  COPY ELPRTCVP.
  2053 9500-PRINT-ROUTINE SECTION.
  2054*    COPY ELPRTCVP.
  2055******************************************************************
  2056***                                                              *
  2057***                          ELPRTCVP.                           *
  2058***                          VMOD=2.003                          *
  2059***                                                              *
  2060***     COPY MEMBER FOR TERMINAL ONLINE PRINT ROUTINE.           *
  2061***     THIS ROUTINE WILL ACCOMODATE PRINTING TO A 3270          *
  2062***     TERMINAL PRINTER. A BUFFER OF UP TO 1920 CHARACTERS      *
  2063***     IS ACCUMULATED AND PRINTED COLLECTIVELY.                 *
  2064***                                                              *
  2065***     THIS ROUTINE TO BE USED ONLY WITH ACCOMPANIMENT          *
  2066***      OF THE WORKING-STORAGE COPY MEMBER ( ELPRTCVD )         *
  2067***     THE HOST PROGRAM MUST INITIALIZE THE FOLLOWING 3 FIELDS  *
  2068***      FROM THE ABOVE COPY MEMBER FOR THIS PROCEDURE TO BE     *
  2069***      SUCCESSFUL.                                             *
  2070***      05  WS-LINE-LEN    PIC  S9(4)  COMP  VALUE +80.         *
  2071***                         LENGTH OF THE LINE TO BE PRINTED     *
  2072***                         DEFAULT IS 80, YOU CAN USE ANY NUMBER*
  2073***                         UP TO 132.  THIS FIELD IS ONLY ACCEP-*
  2074***                         TED THE FIRST TIME THRU THE ROUTINE. *
  2075***      05  WS-PROG-END    PIC  X  VALUE SPACES.                *
  2076***                         PROGRAM END SWITCH. INITIALIZED      *
  2077***                         TO SPACE-     MOVE IN ANY NONBLANK   *
  2078***                         TO IT WHEN PROGRAM IS FINISHED.      *
  2079***      05  WS-PRINT-AREA.                                      *
  2080***          10  WS-PASSED-CNTL-CHAR     PIC X.                  *
  2081***          10  WS-PASSED-DATA          PIC X(132).             *
  2082***                         USE THE DATA TO BE PRINTED IN THE    *
  2083***                         WS-PASSED-DATA.                      *
  2084***                         USE THE STANDARD CARRIAGE CONTROL    *
  2085***                         CHARACTER IN THE WS-PASSED-CNTL-CHAR *
  2086***                           SINGLE-SPACE            VALUE ' '  *
  2087***                           DOUBLE-SPACE            VALUE '0'  *
  2088***                           TRIPLE-SPACE            VALUE '-'  *
  2089***                           TOP-PAGE                VALUE '1'  *
  2090***      NOTE: A LINE COUNT IS PROVIDED IN FIELDNAME -WS-LINE-CNT*
  2091***            THE USE OF THIS FIELD IS OPTIONAL.                *
  2092***            THIS ROUTINE WILL ONLY ADD 1, 2, OR 3             *
  2093***            TO THIS COUNT DEPENDING ON THE WS-PASSED-CNTL-CHAR*
  2094***            AND RESET THE COUNT TO ZERO WHEN TOP-PAGE         *
  2095***            CONDITION.                                        *
  2096***                                                              *
  2097******************************************************************
  2098
  2099 ELPRTCVP.
  2100
  2101*    IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'CID'
  2102     IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'XXX'
  2103         MOVE 'P'                TO DL34-PROCESS-TYPE
  2104         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  2105         MOVE PI-PROCESSOR-ID    TO DL34-USERID
  2106         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  2107         MOVE WS-PRINT-AREA      TO DL34-PRINT-LINE
  2108         MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
  2109
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL1742.cbl
  2110
  2111* EXEC CICS LINK
  2112*            PROGRAM    ('DLO034')
  2113*            COMMAREA   (DLO034-COMMUNICATION-AREA)
  2114*            LENGTH     (DLO034-REC-LENGTH)
  2115*        END-EXEC
  2116     MOVE 'DLO034' TO DFHEIV1
  2117*    MOVE '."C                   ''   #00001944' TO DFHEIV0
  2118     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2119     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2120     MOVE X'2020233030303031393434' TO DFHEIV0(25:11)
  2121     CALL 'kxdfhei1' USING DFHEIV0,
  2122           DFHEIV1,
  2123           DLO034-COMMUNICATION-AREA,
  2124           DLO034-REC-LENGTH,
  2125           DFHEIV99,
  2126           DFHEIV99,
  2127           DFHEIV99
  2128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2129
  2130            IF DL34-RETURN-CODE = 'OK'
  2131                GO TO ELPRTCVP-EXIT
  2132            ELSE
  2133*               MOVE '8339'     TO EMI-ERROR ?????ERROR MESSAGE???
  2134                GO TO ELPRTCVP-EXIT.
  2135
  2136     IF NOT FIRST-TIME
  2137         GO TO ELPRTCVP-020.
  2138
  2139     IF WS-LINE-LEN NOT GREATER ZERO
  2140         GO TO ELPRTCVP-EXIT.
  2141
  2142     MOVE '2'                    TO WS-FIRST-TIME-SW.
  2143     MOVE LOW-VALUES             TO WS-BUFFER-AREA.
  2144
  2145     SET BUFFER-INDEX TO +1
  2146
  2147     IF EIBTRMID IS EQUAL TO 'AFLP'
  2148         NEXT SENTENCE
  2149     ELSE
  2150         IF NOT TOP-PAGE
  2151             MOVE T-TP           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2152             SET BUFFER-INDEX UP BY +1.
  2153
  2154 ELPRTCVP-020.
  2155     IF WS-PROG-END = SPACES
  2156         GO TO ELPRTCVP-030.
  2157
  2158     MOVE SPACES                 TO WS-PROG-END.
  2159
  2160     IF BUFFER-INDEX GREATER +1
  2161         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  2162
  2163     MOVE '1'                    TO WS-FIRST-TIME-SW.
  2164
  2165     GO TO ELPRTCVP-EXIT.
  2166
  2167 ELPRTCVP-030.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL1742.cbl
  2168     IF WS-PASSED-DATA = SPACES
  2169         SET PRT-INDEX TO +1
  2170         GO TO ELPRTCVP-050.
  2171
  2172     SET PRT-INDEX TO WS-LINE-LEN.
  2173
  2174 ELPRTCVP-040.
  2175     IF WS-PRINT-BYTE (PRT-INDEX) NOT = SPACES
  2176         GO TO ELPRTCVP-050.
  2177
  2178     IF PRT-INDEX GREATER +1
  2179         SET PRT-INDEX DOWN BY +1
  2180         GO TO ELPRTCVP-040.
  2181
  2182 ELPRTCVP-050.
  2183     SET WS-LINE-LENGTH TO PRT-INDEX.
  2184     SET BUFFER-INDEX2 TO BUFFER-INDEX.
  2185     SET BUFFER-INDEX2 UP BY WS-LINE-LENGTH.
  2186
  2187     IF BUFFER-INDEX2 NOT LESS WS-BUFFER-SIZE
  2188         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  2189
  2190     IF TRIPLE-SPACE
  2191          ADD +2  TO  WS-LINE-CNT
  2192          MOVE T-SS           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2193                                 WS-BUFFER-BYTE (BUFFER-INDEX + 1)
  2194          SET BUFFER-INDEX UP BY +2.
  2195
  2196     IF DOUBLE-SPACE
  2197          ADD +1  TO  WS-LINE-CNT
  2198          MOVE T-SS             TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2199          SET BUFFER-INDEX UP BY +1.
  2200
  2201     ADD +1 TO WS-LINE-CNT
  2202************************************************************
  2203*     BYPASS NEW LINE SYMBOL                               *
  2204*        IF FIRST BUFFER SENT AND TOP-OF-FORM SET.         *
  2205*     OR IF FIRST LINE OF SUBSEQUENT BUFFERS.              *
  2206************************************************************
  2207
  2208     IF (BUFFER-INDEX GREATER +1 AND
  2209         WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-TP)  OR
  2210         FIRST-LINE-NEXT-BUFFER
  2211         MOVE ZERO               TO WS-FIRST-TIME-SW
  2212     ELSE
  2213         MOVE T-SS               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2214         SET BUFFER-INDEX UP BY +1.
  2215
  2216**   NOTE, SINGLE SPACE IS REQUIRED BEFORE TOP PAGE CHAR
  2217
  2218     IF TOP-PAGE
  2219         MOVE +1                TO WS-LINE-CNT
  2220         MOVE T-TP              TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2221         SET BUFFER-INDEX UP BY +1.
  2222
  2223     SET PRT-INDEX TO +1.
  2224
  2225 ELPRTCVP-060.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL1742.cbl
  2226     MOVE WS-PRINT-BYTE (PRT-INDEX)
  2227                                 TO WS-BUFFER-BYTE (BUFFER-INDEX).
  2228     SET BUFFER-INDEX UP BY +1.
  2229
  2230     IF PRT-INDEX LESS WS-LINE-LENGTH
  2231         SET PRT-INDEX UP BY +1
  2232         GO TO ELPRTCVP-060.
  2233
  2234 ELPRTCVP-EXIT.
  2235     EXIT.
  2236
  2237 ELPRTCVP-PRINT-BUFFER.
  2238     IF WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-SS
  2239        MOVE SPACE               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2240        SET BUFFER-INDEX UP BY 1.
  2241
  2242     MOVE  T-EM                  TO  WS-BUFFER-BYTE (BUFFER-INDEX)
  2243     SET WS-BUFFER-LENGTH TO BUFFER-INDEX.
  2244
  2245
  2246* EXEC CICS SEND
  2247*        FROM    (WS-BUFFER-AREA)
  2248*        LENGTH  (WS-BUFFER-LENGTH)
  2249*        CTLCHAR (WS-WCC-CNTL)
  2250*        ERASE
  2251*    END-EXEC.
  2252*    MOVE '$$    C E         L F ,   #00002065' TO DFHEIV0
  2253     MOVE X'242420202020432045202020' TO DFHEIV0(1:12)
  2254     MOVE X'2020202020204C2046202C20' TO DFHEIV0(13:12)
  2255     MOVE X'2020233030303032303635' TO DFHEIV0(25:11)
  2256     CALL 'kxdfhei1' USING DFHEIV0,
  2257           WS-BUFFER-AREA,
  2258           WS-BUFFER-LENGTH,
  2259           DFHEIV99,
  2260           DFHEIV99,
  2261           WS-WCC-CNTL,
  2262           DFHEIV99,
  2263           DFHEIV99,
  2264           DFHEIV99,
  2265           DFHEIV99,
  2266           DFHEIV99,
  2267           DFHEIV99
  2268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2269
  2270
  2271     SET BUFFER-INDEX TO +1.
  2272     MOVE '2'                    TO WS-FIRST-TIME-SW.
  2273
  2274 ELPRTCVP-PRINT-EXIT.
  2275     EXIT.
  2276
  2277
  2278 9700-LINK-DATE-CONVERT  SECTION.
  2279
  2280
  2281* EXEC CICS LINK
  2282*        PROGRAM    ('ELDATCV')
  2283*        COMMAREA   (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL1742.cbl
  2284*        LENGTH     (DC-COMM-LENGTH)
  2285*    END-EXEC.
  2286     MOVE 'ELDATCV' TO DFHEIV1
  2287*    MOVE '."C                   ''   #00002081' TO DFHEIV0
  2288     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2289     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2290     MOVE X'2020233030303032303831' TO DFHEIV0(25:11)
  2291     CALL 'kxdfhei1' USING DFHEIV0,
  2292           DFHEIV1,
  2293           DATE-CONVERSION-DATA,
  2294           DC-COMM-LENGTH,
  2295           DFHEIV99,
  2296           DFHEIV99,
  2297           DFHEIV99
  2298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2299
  2300
  2301 9700-EXIT.
  2302     EXIT.
  2303
  2304 9900-LAST-PARAGRAPH SECTION.
  2305
  2306* GOBACK.
  2307     MOVE '9%                    "   ' TO DFHEIV0
  2308     MOVE 'EL1742' TO DFHEIV1
  2309     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2310     GOBACK.
  2311
  2312 9999-DFHBACK SECTION.
  2313     MOVE '9%                    "   ' TO DFHEIV0
  2314     MOVE 'EL1742' TO DFHEIV1
  2315     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2316     GOBACK.
  2317 9999-DFHEXIT.
  2318     IF DFHEIGDJ EQUAL 0001
  2319         NEXT SENTENCE
  2320     ELSE IF DFHEIGDJ EQUAL 2
  2321         GO TO 200-END-DATA,
  2322               4800-END-OF-FILE,
  2323               300-NOT-FOUND
  2324         DEPENDING ON DFHEIGDI.
  2325     MOVE '9%                    "   ' TO DFHEIV0
  2326     MOVE 'EL1742' TO DFHEIV1
  2327     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2328     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5156     Code:        5546
