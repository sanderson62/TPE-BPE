* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page   1
* EL652.cbl
* Options: int("EL652.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL652.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL652.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL652.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL652 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 09/14/94 07:57:28.
     7*                            VMOD=2.059
     8*
     9*AUTHOR.        LOGIC,INC.
    10*               DALLAS, TEXAS.
    11*
    12*REMARKS.
    13*        TRANSACTION - EXD4 - COMPENSATION MASTER MAINT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page   2
* EL652.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    24* 102202    2002032200002  SMVA  ADD PF8 KEY FOR COMP MSTR NOTES
    25* 111103    2003080800002  PEMA  ADD BANKFEE,CLPST,MAXFEE  & PF10
    26*                                FOR SECURE PAY
    27* 111204    2004110300005  PEMA  SPLIT AGENT COMMISSION CHANGES
    28* 033105    2005031100003  PEMA  ADD VALID TYPE OF 'B' (BANK)
    29* 042005    2005031100004  PEMA  ALLOW UPDATES TO PCONT FOR 'B'
    30* 042005                         AND 'G' RECORD TYPES.
    31* 092205    2005050300006  PEMA  ADD LEASE FEES
    32* 041106    2006022800001  AJRA  INIT CO-FIRST-WRITTEN-DT ON ADD
    33* 060506    2002061100007  PEMA  ADD CODES TO ERCOMP FILE
    34* 072406    2006022400001  PEMA  ADD REFUND ONLY EDIT
    35* 110706  CR2006071700002  PEMA  FIX NAME LOOK UP
    36* 043007  IR2007042600002  PEMA  TURN OFF YTDCOMM ATTR
    37* 102908  CR2007052100005  PEMA  UNPROT PCONT ATTRB
    38* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    39* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    40* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    41* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    42* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL
    43******************************************************************
    44
    45 ENVIRONMENT DIVISION.
    46 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page   3
* EL652.cbl
    48 WORKING-STORAGE SECTION.
    49 01  DFH-START PIC X(04).
    50 77  FILLER  PIC X(32)  VALUE '********************************'.
    51 77  FILLER  PIC X(32)  VALUE '*    EL652 WORKING STORAGE     *'.
    52 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.059 *********'.
    53 77  WS-TOT-FEES                 PIC S9(3)V99 COMP-3 VALUE +0.
    54 77  S1                          PIC S999 VALUE +0 COMP-3.
    55
    56 01  WS-DATE-AREA.
    57     12  SAVE-DATE           PIC  X(8)       VALUE SPACES.
    58     12  SAVE-BIN-DATE       PIC  XX         VALUE SPACES.
    59
    60 01  STANDARD-AREAS.
    61     12  WS-RESPONSE             PIC S9(8)   COMP.
    62         88  RESP-NORMAL                  VALUE +00.
    63         88  RESP-NOTFND                  VALUE +13.
    64         88  RESP-NOTOPEN                 VALUE +19.
    65         88  RESP-ENDFILE                 VALUE +20.
    66     12  RETURNED-FROM       PIC X(8)        VALUE SPACES.
    67     12  QID-PI.
    68         16  QID-TERM        PIC X(4).
    69         16  FILLER          PIC X(4)        VALUE '652A'.
    70     12  QID-ITEM            PIC S9(4) COMP  VALUE +0001.
    71     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
    72     12  MAP-NAME            PIC  X(8)       VALUE 'EL652A'.
    73     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL652S'.
    74     12  TRANS-ID            PIC  X(4)       VALUE 'EXD4'.
    75     12  EL640-TRANS-ID      PIC  X(4)       VALUE 'EXC1'.
    76     12  EL642-TRANS-ID      PIC  X(4)       VALUE 'EXH7'.
    77     12  EL633-TRANS-ID      PIC  X(4)       VALUE 'EXB7'.
    78     12  EL633DMD-TRANS-ID   PIC  X(4)       VALUE 'EX1F'.
    79     12  EL635-TRANS-ID      PIC  X(4)       VALUE 'EXJ4'.
    80     12  EL6501-TRANS-ID     PIC  X(4)       VALUE 'EXC5'.
    81     12  EL6592-TRANS-ID     PIC  X(4)       VALUE 'EX66'.
    82     12  EL856-TRANS-ID      PIC  X(4)       VALUE 'EXJ8'.
    83     12  EM6508-TRANS-ID     PIC  X(4)       VALUE 'MXG8'.
    84     12  THIS-PGM            PIC  X(8)       VALUE 'EL652'.
    85     12  PGM-NAME            PIC  X(8).
    86     12  WS-COMP-CD-R.
    87         16  FILLER          PIC  X.
    88         16  WS-COMP-CD-X    PIC  X.
    89     12  WS-COMP-CD  REDEFINES
    90         WS-COMP-CD-R        PIC S9(4)                  COMP.
    91     12  TIME-IN             PIC S9(7).
    92     12  TIME-OUT-R  REDEFINES  TIME-IN.
    93         16  FILLER          PIC  X.
    94         16  TIME-OUT        PIC  99V99.
    95         16  FILLER          PIC  XX.
    96     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
    97     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
    98     12  XCTL-126            PIC  X(8)       VALUE 'EL126'.
    99     12  XCTL-626            PIC  X(8)       VALUE 'EL626'.
   100     12  XCTL-633            PIC  X(8)       VALUE 'EL633'.
   101     12  XCTL-633DMD         PIC  X(8)       VALUE 'EL633DMD'.
   102     12  XCTL-635            PIC  X(8)       VALUE 'EL635'.
   103     12  XCTL-650            PIC  X(8)       VALUE 'EL650'.
   104     12  XCTL-6521           PIC  X(8)       VALUE 'EL6521'.
   105     12  XCTL-6522           PIC  X(8)       VALUE 'EL6522'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page   4
* EL652.cbl
   106     12  XCTL-6523           PIC  X(8)       VALUE 'EL6523'.
   107     12  XCTL-6524           PIC  X(8)       VALUE 'EL6524'.
   108     12  XCTL-689            PIC  X(8)       VALUE 'EL689'.
   109     12  XCTL-690            PIC  X(8)       VALUE 'EL690'.
   110     12  XCTL-856            PIC  X(8)       VALUE 'EL856'.
   111     12  XCTL-EM626          PIC  X(8)       VALUE 'EM626'.
   112     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   113     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   114     12  LINK-ELDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   115     12  FILE-ID             PIC  X(8)       VALUE SPACES.
   116     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   117     12  NAME-FILE-ID        PIC  X(8)       VALUE 'ERNAME'.
   118     12  CNTL-FILE-ID        PIC  X(8)       VALUE 'ELCNTL'.
   119     12  SUMM-FILE-ID        PIC  X(8)       VALUE 'ERSUMM'.
   120     12  RQST-FILE-ID        PIC  X(8)       VALUE 'ERRQST'.
   121     12  RQST-FILE-ID-3      PIC  X(8)       VALUE 'ERRQST3'.
   122
   123 01  MISC-WORK-AREAS.
   124     12  WS-SRCH-STATE       PIC X(30)  VALUE SPACES.
   125     12  STNDX               PIC S999   COMP-3 VALUE +0.
   126     12  W-APPL-SCRTY-NDX    PIC S9(04) COMP   VALUE +35.
   127     12  WS-PHONE-IN         PIC  9(10).
   128     12  WS-PHONE-IN-R  REDEFINES  WS-PHONE-IN.
   129         16  WSPI-AREA       PIC  X(3).
   130         16  WSPI-PFX        PIC  X(3).
   131         16  WSPI-SFX        PIC  X(4).
   132     12  WS-PHONE-OUT.
   133         16  WSPO-AREA       PIC  X(3).
   134         16  FILLER          PIC  X            VALUE '-'.
   135         16  WSPO-PFX        PIC  X(3).
   136         16  FILLER          PIC  X            VALUE '-'.
   137         16  WSPO-SFX        PIC  X(4).
   138     12  DEEDIT-FIELD        PIC  X(15).
   139     12  DEEDIT-FIELD-V0  REDEFINES
   140         DEEDIT-FIELD        PIC S9(15).
   141     12  DEEDIT-FIELD-V1  REDEFINES
   142         DEEDIT-FIELD        PIC S9(13)V99.
   143     12  SUB1                PIC S9(4)         VALUE +0   COMP.
   144     12  SUB2                PIC S9(4)         VALUE +0   COMP.
   145     12  SC-ITEM-CL-CR       PIC S9(4)         VALUE +1   COMP.
   146     12  ERCOMP-LENGTH       PIC S9(4)         VALUE +700 COMP.
   147     12  ERSUMM-LENGTH       PIC S9(4)         VALUE +150 COMP.
   148     12  ERNAME-LENGTH       PIC S9(4)         VALUE +160 COMP.
   149     12  SV-CLMTOL           PIC  9(3)V99      VALUE ZEROS.
   150     12  WK-DATE.
   151         16  WK-MO           PIC  99.
   152         16  WK-DA           PIC  99.
   153         16  WK-YR           PIC  99.
   154     12  DATE-TEST-AREA      PIC  9(6).
   155     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   156         16  DATE-TEST-MM    PIC  99.
   157         16  DATE-TEST-DD    PIC  99.
   158         16  DATE-TEST-YY    PIC  99.
   159     12  DIVIDE-RESULT       PIC  99.
   160     12  DIVIDE-REMAINDER    PIC  9.
   161     12  WS-ZERO             PIC  X            VALUE '0'.
   162     12  WS-ONE              PIC  X            VALUE '1'.
   163     12  WS-TWO              PIC  X            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page   5
* EL652.cbl
   164     12  WS-ACCESS.
   165         16  FILLER          PIC  X(3)         VALUE SPACES.
   166         16  WS-CARRIER      PIC  X.
   167     12  BIN-CURRENT-SAVE    PIC  XX.
   168     12  WS-BROWSE-SW        PIC  X.
   169         88  BROWSE-STARTED                    VALUE 'Y'.
   170     12  WS-SAVE-KEY         PIC  X(29)        VALUE SPACES.
   171     12  WS-SAVE-SUMM        PIC  X(6)         VALUE SPACES.
   172     12  WS-SUMM-FOR-RQST    PIC  X(6)         VALUE SPACES.
   173     12  WS-SAVE-RQST        PIC X(46)         VALUE SPACES.
   174     12  WS-SHOW-SAVE-TOTALS PIC  X            VALUE SPACE.
   175         88  SHOW-SAVE-TOTALS                  VALUE 'Y'.
   176     12  ELCNTL-KEY.
   177         16  CNTL-COMP-ID    PIC  X(3)         VALUE SPACES.
   178         16  CNTL-REC-TYPE   PIC  X            VALUE SPACES.
   179         16  CNTL-ACCESS     PIC  X(4)         VALUE SPACES.
   180         16  CNTL-SEQ-NO     PIC S9(4)         VALUE +0   COMP.
   181     12  ELCNTL-KEY2.
   182         16  CNTL-COMP-ID-2  PIC  X(3)         VALUE SPACES.
   183         16  CNTL-REC-TYPE-2 PIC  X            VALUE SPACES.
   184         16  CNTL-STATE-2    PIC  X(2)         VALUE SPACES.
   185         16  FILLER          PIC  X(2)         VALUE SPACES.
   186         16  CNTL-SEQ-NO-2   PIC S9(4)         VALUE +0   COMP.
   187     12  ERSUMM-KEY.
   188         16  SUMM-COMP-ID    PIC  X            VALUE SPACES.
   189         16  SUMM-SUMMARY    PIC  X(6)         VALUE SPACES.
   190         16  SUMM-CARRIER    PIC  X            VALUE SPACES.
   191         16  SUMM-GROUP      PIC  X(6)         VALUE SPACES.
   192         16  SUMM-FIN-RESP   PIC  X(10)        VALUE SPACES.
   193         16  SUMM-ACCT-AGENT PIC  X(10)        VALUE SPACES.
   194     12  ERRQST-KEY.
   195         16  RQST-COMP-ID-PC PIC  X            VALUE SPACES.
   196         16  RQST-BATCH-PC   PIC  X(6)         VALUE SPACES.
   197     12  ERRQST-KEY-3.
   198         16  RQST-COMP-ID    PIC  X            VALUE SPACES.
   199         16  RQST-CARRIER    PIC  X            VALUE SPACES.
   200         16  RQST-GROUP      PIC  X(6)         VALUE SPACES.
   201         16  RQST-FIN-RESP   PIC  X(10)        VALUE SPACES.
   202         16  RQST-ACCT-AGENT PIC  X(10)        VALUE SPACES.
   203         16  RQST-REFERENCE  PIC  X(12)        VALUE SPACES.
   204         16  RQST-BATCH      PIC  X(06)        VALUE SPACES.
   205     12  WS-DATE-MDY-8.
   206         16  WS-DMDY8-MM     PIC  XX.
   207         16  WS-DMDY8-SL1    PIC  X.
   208         16  WS-DMDY8-DD     PIC  XX.
   209         16  WS-DMDY8-SL2    PIC  X.
   210         16  WS-DMDY8-YY     PIC  XX.
   211     12  WS-DATE-MDY-6  REDEFINES  WS-DATE-MDY-8.
   212         16  WS-DMDY6-MM     PIC  XX.
   213         16  WS-DMDY6-DD     PIC  XX.
   214         16  WS-DMDY6-YY     PIC  XX.
   215         16  WS-DMDY6-BLNK   PIC  XX.
   216     12  WS-YMD-DATE.
   217         16  WS-YMD-YY       PIC  XX.
   218         16  WS-YMD-MM       PIC  XX.
   219         16  WS-YMD-DD       PIC  XX.
   220     12  WS-YMD-DATE-NUM  REDEFINES
   221         WS-YMD-DATE         PIC  9(6).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page   6
* EL652.cbl
   222     12  WS-SAVE-SUMMARY     PIC X(6)          VALUE SPACES.
   223     12  WS-SAVE-NAME        PIC X(30)         VALUE SPACES.
   224     12  WS-SAVE-BALFWD      PIC S9(7)V99      VALUE +0   COMP-3.
   225     12  WS-SAVE-CURCOM      PIC S9(7)V99      VALUE +0   COMP-3.
   226     12  WS-SAVE-CURCHG      PIC S9(7)V99      VALUE +0   COMP-3.
   227     12  WS-SAVE-CURPMT      PIC S9(7)V99      VALUE +0   COMP-3.
   228     12  WS-SAVE-ENDBAL      PIC S9(7)V99      VALUE +0   COMP-3.
   229     12  WS-SAVE-YTDCOM      PIC S9(7)V99      VALUE +0   COMP-3.
   230     12  WS-SOC-SEC-WORK-FIELD.
   231         16  WS-SS-TYPE          PIC X.
   232         16  WS-SOC-SEC          PIC X(12).
   233
   234     12  WS-ZIP-CODE.
   235         16  WS-ZIP-1            PIC X.
   236             88  WS-CANADIAN-ZIP    VALUE 'A' THRU 'Z'.
   237         16  WS-ZIP-2-3          PIC XX.
   238         16  WS-ZIP-4            PIC X.
   239         16  WS-ZIP-5            PIC X.
   240         16  WS-ZIP-6            PIC X.
   241         16  FILLER              PIC X(4).
   242     12  WS-ZIP-AM-1  REDEFINES  WS-ZIP-CODE.
   243         16  WS-ZIP-AM-1-CODE    PIC X(5).
   244         16  WS-ZIP-AM-1-PLUS4   PIC X(4).
   245         16  FILLER              PIC X.
   246     12  WS-ZIP-AM-2  REDEFINES  WS-ZIP-CODE.
   247         16  WS-ZIP-AM-2-CODE    PIC X(5).
   248         16  WS-ZIP-AM-2-DASH    PIC X.
   249         16  WS-ZIP-AM-2-PLUS4   PIC X(4).
   250     12  WS-ZIP-CAN-1  REDEFINES  WS-ZIP-CODE.
   251         16  WS-ZIP-CAN-1-POST1  PIC XXX.
   252         16  WS-ZIP-CAN-1-POST2  PIC XXX.
   253         16  FILLER              PIC X(4).
   254     12  WS-ZIP-CAN-2  REDEFINES  WS-ZIP-CODE.
   255         16  WS-ZIP-CAN-2-POST1  PIC XXX.
   256         16  FILLER              PIC X.
   257         16  WS-ZIP-CAN-2-POST2  PIC XXX.
   258         16  FILLER              PIC XXX.
   259
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page   7
* EL652.cbl
   261 01  ERROR-NUMBERS.
   262     12  ER-0000             PIC  X(4)       VALUE '0000'.
   263     12  ER-0002             PIC  X(4)       VALUE '0002'.
   264     12  ER-0004             PIC  X(4)       VALUE '0004'.
   265     12  ER-0008             PIC  X(4)       VALUE '0008'.
   266     12  ER-0029             PIC  X(4)       VALUE '0029'.
   267     12  ER-0033             PIC  X(4)       VALUE '0033'.
   268     12  ER-0035             PIC  X(4)       VALUE '0035'.
   269     12  ER-0046             PIC  X(4)       VALUE '0046'.
   270     12  ER-0068             PIC  X(4)       VALUE '0068'.
   271     12  ER-0070             PIC  X(4)       VALUE '0070'.
   272     12  ER-0142             PIC  X(4)       VALUE '0142'.
   273     12  ER-0144             PIC  X(4)       VALUE '0144'.
   274     12  ER-0187             PIC  X(4)       VALUE '0187'.
   275     12  ER-0193             PIC  X(4)       VALUE '0193'.
   276     12  ER-0314             PIC  X(4)       VALUE '0314'.
   277     12  ER-0584             PIC  X(4)       VALUE '0584'.
   278     12  ER-0829             PIC  X(4)       VALUE '0829'.
   279     12  ER-1299             PIC  X(4)       VALUE '1299'.
   280     12  ER-1778             PIC  X(4)       VALUE '1778'.
   281     12  ER-1883             PIC  X(4)       VALUE '1883'.
   282     12  ER-2039             PIC  X(4)       VALUE '2039'.
   283     12  ER-2042             PIC  X(4)       VALUE '2042'.
   284     12  ER-2045             PIC  X(4)       VALUE '2045'.
   285     12  ER-2046             PIC  X(4)       VALUE '2046'.
   286     12  ER-2047             PIC  X(4)       VALUE '2047'.
   287     12  ER-2048             PIC  X(4)       VALUE '2048'.
   288     12  ER-2049             PIC  X(4)       VALUE '2049'.
   289     12  ER-2050             PIC  X(4)       VALUE '2050'.
   290     12  ER-2055             PIC  X(4)       VALUE '2055'.
   291     12  ER-2056             PIC  X(4)       VALUE '2056'.
   292     12  ER-2057             PIC  X(4)       VALUE '2057'.
   293     12  ER-2067             PIC  X(4)       VALUE '2067'.
   294     12  ER-2088             PIC  X(4)       VALUE '2088'.
   295     12  ER-2089             PIC  X(4)       VALUE '2089'.
   296     12  ER-2091             PIC  X(4)       VALUE '2091'.
   297     12  ER-2092             PIC  X(4)       VALUE '2092'.
   298     12  ER-2093             PIC  X(4)       VALUE '2093'.
   299     12  ER-2094             PIC  X(4)       VALUE '2094'.
   300     12  ER-2095             PIC  X(4)       VALUE '2095'.
   301     12  ER-2096             PIC  X(4)       VALUE '2096'.
   302     12  ER-2097             PIC  X(4)       VALUE '2097'.
   303     12  ER-2209             PIC  X(4)       VALUE '2209'.
   304     12  ER-2238             PIC  X(4)       VALUE '2238'.
   305     12  ER-2370             PIC  X(4)       VALUE '2370'.
   306     12  ER-2572             PIC  X(4)       VALUE '2572'.
   307     12  ER-2717             PIC  X(4)       VALUE '2717'.
   308     12  ER-2790             PIC  X(4)       VALUE '2790'.
   309     12  ER-2872             PIC  X(4)       VALUE '2872'.
   310     12  ER-3021             PIC  X(4)       VALUE '3021'.
   311     12  ER-3053             PIC  X(4)       VALUE '3053'.
   312     12  ER-3055             PIC  X(4)       VALUE '3055'.
   313     12  ER-3056             PIC  X(4)       VALUE '3056'.
   314     12  ER-3150             PIC  X(4)       VALUE '3150'.
   315     12  ER-3151             PIC  X(4)       VALUE '3151'.
   316     12  ER-3152             PIC  X(4)       VALUE '3152'.
   317     12  ER-3153             PIC  X(4)       VALUE '3153'.
   318     12  ER-3154             PIC  X(4)       VALUE '3154'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page   8
* EL652.cbl
   319     12  ER-3168             PIC  X(4)       VALUE '3168'.
   320     12  ER-3170             PIC  X(4)       VALUE '3170'.
   321     12  ER-3174             PIC  X(4)       VALUE '3174'.
   322     12  ER-3261             PIC  X(4)       VALUE '3261'.
   323     12  ER-9096             PIC  X(4)       VALUE '9096'.
   324     12  ER-9097             PIC  X(4)       VALUE '9097'.
   325     12  ER-9999             PIC  X(4)       VALUE '9999'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page   9
* EL652.cbl
   327*                          COPY ELCSCTM.
   328******************************************************************
   329*                                                                *
   330*                                                                *
   331*                            ELCSCTM                             *
   332*                            VMOD=2.001                          *
   333*                                                                *
   334*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   335*                                                                *
   336******************************************************************
   337 01  SECURITY-MESSAGE.
   338     12  FILLER                          PIC X(30)
   339            VALUE '** LOGIC SECURITY VIOLATION -'.
   340     12  SM-READ                         PIC X(6).
   341     12  FILLER                          PIC X(5)
   342            VALUE ' PGM='.
   343     12  SM-PGM                          PIC X(6).
   344     12  FILLER                          PIC X(5)
   345            VALUE ' OPR='.
   346     12  SM-PROCESSOR-ID                 PIC X(4).
   347     12  FILLER                          PIC X(6)
   348            VALUE ' TERM='.
   349     12  SM-TERMID                       PIC X(4).
   350     12  FILLER                          PIC XX   VALUE SPACE.
   351     12  SM-JUL-DATE                     PIC 9(5).
   352     12  FILLER                          PIC X    VALUE SPACE.
   353     12  SM-TIME                         PIC 99.99.
   354
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  10
* EL652.cbl
   356*                          COPY ELCSCRTY.
   357******************************************************************
   358*                                                                *
   359*                                                                *
   360*                            ELCSCRTY                            *
   361*                            VMOD=2.001                          *
   362*                                                                *
   363*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   364*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   365*        SAVED IN PI-SECURITY-ADDRESS.                           *
   366*                                                                *
   367******************************************************************
   368 01  SECURITY-CONTROL.
   369     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   370     12  FILLER                       PIC XX    VALUE 'SC'.
   371     12  SC-CREDIT-CODES.
   372         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   373             20  SC-CREDIT-DISPLAY    PIC X.
   374             20  SC-CREDIT-UPDATE     PIC X.
   375     12  SC-CLAIMS-CODES.
   376         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   377             20  SC-CLAIMS-DISPLAY    PIC X.
   378             20  SC-CLAIMS-UPDATE     PIC X.
   379*                          COPY MPCSCRT.
   380******************************************************************
   381*                                                                *
   382*                            MPCSCRT                             *
   383*                            VMOD=1.001                          *
   384*                                                                *
   385*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   386*        ACQUIRED BY SIGN-ON PROGRAM EL125.                      *
   387*                                      (MP MORTGAGE PROTECTION)  *
   388*                                                                *
   389******************************************************************
   390*
   391 01  SECURITY-CONTROL-E.
   392     12  SC-COMM-LENGTH-E             PIC S9(04) VALUE +144 COMP.
   393     12  FILLER                       PIC  X(02) VALUE 'SC'.
   394     12  SC-QUID-KEY.
   395         16  SC-QUID-TERMINAL         PIC  X(04).
   396         16  SC-QUID-SYSTEM           PIC  X(04).
   397     12  SC-ITEM                      PIC S9(04) VALUE +1   COMP.
   398     12  SC-SECURITY-ACCESS-CODE      PIC  X(01).
   399     12  SC-PRODUCER-AUTHORIZED-SW    PIC  X(01).
   400         88 SC-PRODUCER-AUTHORIZED               VALUE ' '.
   401         88 SC-PRODUCER-NOT-AUTHORIZED           VALUE 'N'.
   402     12  SC-MP-CODES.
   403         16  SC-MP-AUTHORIZATION OCCURS 44 TIMES.
   404             20  SC-MP-DISPLAY        PIC  X(01).
   405             20  SC-MP-UPDATE         PIC  X(01).
   406     12  FILLER                       PIC  X(40).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  11
* EL652.cbl
   408 01  FILLER                  PIC X(16)  VALUE ALL 'A'.
   409*                          COPY ELCDATE.
   410******************************************************************
   411*                                                                *
   412*                                                                *
   413*                            ELCDATE.                            *
   414*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   415*                            VMOD=2.003
   416*                                                                *
   417*                                                                *
   418*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   419*                 LENGTH = 200                                   *
   420******************************************************************
   421
   422 01  DATE-CONVERSION-DATA.
   423     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   424     12  DC-OPTION-CODE                PIC X.
   425         88  BIN-TO-GREG                VALUE ' '.
   426         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   427         88  EDIT-GREG-TO-BIN           VALUE '2'.
   428         88  YMD-GREG-TO-BIN            VALUE '3'.
   429         88  MDY-GREG-TO-BIN            VALUE '4'.
   430         88  JULIAN-TO-BIN              VALUE '5'.
   431         88  BIN-PLUS-ELAPSED           VALUE '6'.
   432         88  FIND-CENTURY               VALUE '7'.
   433         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   434         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   435         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   436         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   437         88  JULIAN-TO-BIN-3            VALUE 'C'.
   438         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   439         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   440         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   441         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   442         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   443         88  CHECK-LEAP-YEAR            VALUE 'H'.
   444         88  BIN-3-TO-GREG              VALUE 'I'.
   445         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   446         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   447         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   448         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   449         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   450         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   451         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   452         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   453         88  THREE-CHARACTER-BIN
   454                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   455         88  GREGORIAN-TO-BIN
   456                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   457         88  BIN-TO-GREGORIAN
   458                  VALUES ' ' '1' 'I' '8' 'G'.
   459         88  JULIAN-TO-BINARY
   460                  VALUES '5' 'C' 'E' 'F'.
   461     12  DC-ERROR-CODE                 PIC X.
   462         88  NO-CONVERSION-ERROR        VALUE ' '.
   463         88  DATE-CONVERSION-ERROR
   464                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   465         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  12
* EL652.cbl
   466         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   467         88  DATE-IS-INVALID            VALUE '3'.
   468         88  DATE1-GREATER-DATE2        VALUE '4'.
   469         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   470         88  DATE-INVALID-OPTION        VALUE '9'.
   471         88  INVALID-CENTURY            VALUE 'A'.
   472         88  ONLY-CENTURY               VALUE 'B'.
   473         88  ONLY-LEAP-YEAR             VALUE 'C'.
   474         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   475     12  DC-END-OF-MONTH               PIC X.
   476         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   477     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   478         88  USE-NORMAL-PROCESS         VALUE ' '.
   479         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   480         88  ADJUST-UP-100-YRS          VALUE '2'.
   481     12  FILLER                        PIC X.
   482     12  DC-CONVERSION-DATES.
   483         16  DC-BIN-DATE-1             PIC XX.
   484         16  DC-BIN-DATE-2             PIC XX.
   485         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   486         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   487                       DC-GREG-DATE-1-EDIT.
   488             20  DC-EDIT1-MONTH        PIC 99.
   489             20  SLASH1-1              PIC X.
   490             20  DC-EDIT1-DAY          PIC 99.
   491             20  SLASH1-2              PIC X.
   492             20  DC-EDIT1-YEAR         PIC 99.
   493         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   494         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   495                     DC-GREG-DATE-2-EDIT.
   496             20  DC-EDIT2-MONTH        PIC 99.
   497             20  SLASH2-1              PIC X.
   498             20  DC-EDIT2-DAY          PIC 99.
   499             20  SLASH2-2              PIC X.
   500             20  DC-EDIT2-YEAR         PIC 99.
   501         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   502         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   503                     DC-GREG-DATE-1-YMD.
   504             20  DC-YMD-YEAR           PIC 99.
   505             20  DC-YMD-MONTH          PIC 99.
   506             20  DC-YMD-DAY            PIC 99.
   507         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   508         16  DC-GREG-DATE-1-MDY-R REDEFINES
   509                      DC-GREG-DATE-1-MDY.
   510             20  DC-MDY-MONTH          PIC 99.
   511             20  DC-MDY-DAY            PIC 99.
   512             20  DC-MDY-YEAR           PIC 99.
   513         16  DC-GREG-DATE-1-ALPHA.
   514             20  DC-ALPHA-MONTH        PIC X(10).
   515             20  DC-ALPHA-DAY          PIC 99.
   516             20  FILLER                PIC XX.
   517             20  DC-ALPHA-CENTURY.
   518                 24 DC-ALPHA-CEN-N     PIC 99.
   519             20  DC-ALPHA-YEAR         PIC 99.
   520         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   521         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   522         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   523         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  13
* EL652.cbl
   524         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   525                                       PIC 9(05).
   526         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   527             20  DC-JULIAN-YEAR        PIC 99.
   528             20  DC-JULIAN-DAYS        PIC 999.
   529         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   530         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   531         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   532     12  DATE-CONVERSION-VARIBLES.
   533         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   534         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   535             20  FILLER                PIC 9(3).
   536             20  HOLD-CEN-1-CCYY.
   537                 24  HOLD-CEN-1-CC     PIC 99.
   538                 24  HOLD-CEN-1-YY     PIC 99.
   539             20  HOLD-CEN-1-MO         PIC 99.
   540             20  HOLD-CEN-1-DA         PIC 99.
   541         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   542             20  HOLD-CEN-1-R-MO       PIC 99.
   543             20  HOLD-CEN-1-R-DA       PIC 99.
   544             20  HOLD-CEN-1-R-CCYY.
   545                 24  HOLD-CEN-1-R-CC   PIC 99.
   546                 24  HOLD-CEN-1-R-YY   PIC 99.
   547             20  FILLER                PIC 9(3).
   548         16  HOLD-CENTURY-1-X.
   549             20  FILLER                PIC X(3)  VALUE SPACES.
   550             20  HOLD-CEN-1-X-CCYY.
   551                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   552                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   553             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   554             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   555         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   556             20  HOLD-CEN-1-R-X-MO     PIC XX.
   557             20  HOLD-CEN-1-R-X-DA     PIC XX.
   558             20  HOLD-CEN-1-R-X-CCYY.
   559                 24  HOLD-CEN-1-R-X-CC PIC XX.
   560                 24  HOLD-CEN-1-R-X-YY PIC XX.
   561             20  FILLER                PIC XXX.
   562         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   563         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   564         16  DC-JULIAN-DATE-1          PIC 9(07).
   565         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   566             20  DC-JULIAN-1-CCYY.
   567                 24  DC-JULIAN-1-CC    PIC 99.
   568                 24  DC-JULIAN-1-YR    PIC 99.
   569             20  DC-JULIAN-DA-1        PIC 999.
   570         16  DC-JULIAN-DATE-2          PIC 9(07).
   571         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   572             20  DC-JULIAN-2-CCYY.
   573                 24  DC-JULIAN-2-CC    PIC 99.
   574                 24  DC-JULIAN-2-YR    PIC 99.
   575             20  DC-JULIAN-DA-2        PIC 999.
   576         16  DC-GREG-DATE-A-EDIT.
   577             20  DC-EDITA-MONTH        PIC 99.
   578             20  SLASHA-1              PIC X VALUE '/'.
   579             20  DC-EDITA-DAY          PIC 99.
   580             20  SLASHA-2              PIC X VALUE '/'.
   581             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  14
* EL652.cbl
   582                 24  DC-EDITA-CENT     PIC 99.
   583                 24  DC-EDITA-YEAR     PIC 99.
   584         16  DC-GREG-DATE-B-EDIT.
   585             20  DC-EDITB-MONTH        PIC 99.
   586             20  SLASHB-1              PIC X VALUE '/'.
   587             20  DC-EDITB-DAY          PIC 99.
   588             20  SLASHB-2              PIC X VALUE '/'.
   589             20  DC-EDITB-CCYY.
   590                 24  DC-EDITB-CENT     PIC 99.
   591                 24  DC-EDITB-YEAR     PIC 99.
   592         16  DC-GREG-DATE-CYMD         PIC 9(08).
   593         16  DC-GREG-DATE-CYMD-R REDEFINES
   594                              DC-GREG-DATE-CYMD.
   595             20  DC-CYMD-CEN           PIC 99.
   596             20  DC-CYMD-YEAR          PIC 99.
   597             20  DC-CYMD-MONTH         PIC 99.
   598             20  DC-CYMD-DAY           PIC 99.
   599         16  DC-GREG-DATE-MDCY         PIC 9(08).
   600         16  DC-GREG-DATE-MDCY-R REDEFINES
   601                              DC-GREG-DATE-MDCY.
   602             20  DC-MDCY-MONTH         PIC 99.
   603             20  DC-MDCY-DAY           PIC 99.
   604             20  DC-MDCY-CEN           PIC 99.
   605             20  DC-MDCY-YEAR          PIC 99.
   606    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   607        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   608    12  DC-EL310-DATE                  PIC X(21).
   609    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  15
* EL652.cbl
   611*                          COPY ELCLOGOF.
   612******************************************************************
   613*                                                                *
   614*                                                                *
   615*                            ELCLOGOF.                           *
   616*                            VMOD=2.001                          *
   617*                                                                *
   618*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   619*                                                                *
   620******************************************************************
   621 01  CLASIC-LOGOFF.
   622     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   623     12  LOGOFF-TEXT.
   624         16  FILLER          PIC X(5)    VALUE SPACES.
   625         16  LOGOFF-MSG.
   626             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   627             20  FILLER      PIC X       VALUE SPACES.
   628             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   629         16  FILLER          PIC X(80)
   630           VALUE '* YOU ARE NOW LOGGED OFF'.
   631         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   632         16  FILLER          PIC X       VALUE QUOTE.
   633         16  LOGOFF-SYS-MSG  PIC X(17)
   634           VALUE 'S CLAS-IC SYSTEM '.
   635     12  TEXT-MESSAGES.
   636         16  UNACCESS-MSG    PIC X(29)
   637             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   638         16  PGMIDERR-MSG    PIC X(17)
   639             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  16
* EL652.cbl
   641*                          COPY ELCATTR.
   642******************************************************************
   643*                                                                *
   644*                            ELCATTR.                            *
   645*                            VMOD=2.001                          *
   646*                                                                *
   647*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   648*                                                                *
   649*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   650*                                                                *
   651*                   POS 1   P=PROTECTED                          *
   652*                           U=UNPROTECTED                        *
   653*                           S=ASKIP                              *
   654*                   POS 2   A=ALPHA/NUMERIC                      *
   655*                           N=NUMERIC                            *
   656*                   POS 3   N=NORMAL                             *
   657*                           B=BRIGHT                             *
   658*                           D=DARK                               *
   659*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   660*                           OF=MODIFIED DATA TAG OFF             *
   661*                                                                *
   662*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   663******************************************************************
   664 01  ATTRIBUTE-LIST.
   665     12  AL-PABOF            PIC X       VALUE 'Y'.
   666     12  AL-PABON            PIC X       VALUE 'Z'.
   667     12  AL-PADOF            PIC X       VALUE '%'.
   668     12  AL-PADON            PIC X       VALUE '_'.
   669     12  AL-PANOF            PIC X       VALUE '-'.
   670     12  AL-PANON            PIC X       VALUE '/'.
   671     12  AL-SABOF            PIC X       VALUE '8'.
   672     12  AL-SABON            PIC X       VALUE '9'.
   673     12  AL-SADOF            PIC X       VALUE '@'.
   674     12  AL-SADON            PIC X       VALUE QUOTE.
   675     12  AL-SANOF            PIC X       VALUE '0'.
   676     12  AL-SANON            PIC X       VALUE '1'.
   677     12  AL-UABOF            PIC X       VALUE 'H'.
   678     12  AL-UABON            PIC X       VALUE 'I'.
   679     12  AL-UADOF            PIC X       VALUE '<'.
   680     12  AL-UADON            PIC X       VALUE '('.
   681     12  AL-UANOF            PIC X       VALUE ' '.
   682     12  AL-UANON            PIC X       VALUE 'A'.
   683     12  AL-UNBOF            PIC X       VALUE 'Q'.
   684     12  AL-UNBON            PIC X       VALUE 'R'.
   685     12  AL-UNDOF            PIC X       VALUE '*'.
   686     12  AL-UNDON            PIC X       VALUE ')'.
   687     12  AL-UNNOF            PIC X       VALUE '&'.
   688     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  17
* EL652.cbl
   690*                          COPY ELCEMIB.
   691******************************************************************
   692*                                                                *
   693*                                                                *
   694*                            ELCEMIB.                            *
   695*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   696*                            VMOD=2.005                          *
   697*                                                                *
   698*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   699*                                                                *
   700******************************************************************
   701 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   702     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   703     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   704     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   705     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   706     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   707     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   708     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   709     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   710     12  EMI-SWITCH1             PIC X        VALUE '1'.
   711         88  EMI-NO-ERRORS                    VALUE '1'.
   712         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   713         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   714     12  EMI-SWITCH2             PIC X        VALUE '1'.
   715         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   716     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   717         88  EMI-AREA1-EMPTY                  VALUE '1'.
   718         88  EMI-AREA1-FULL                   VALUE '2'.
   719     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   720         88  EMI-AREA2-EMPTY                  VALUE '1'.
   721         88  EMI-AREA2-FULL                   VALUE '2'.
   722     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   723         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   724         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   725         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   726         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   727         88  EMI-BYPASS-FATALS                VALUE 'X'.
   728     12  EMI-ERROR-LINES.
   729         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   730         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   731         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   732         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   733             20  EMI-ERR-CODES OCCURS 10 TIMES.
   734                 24  EMI-ERR-NUM         PIC X(4).
   735                 24  EMI-FILLER          PIC X.
   736                 24  EMI-SEV             PIC X.
   737                 24  FILLER              PIC X.
   738             20  FILLER                  PIC X(02).
   739     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   740         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   741             20  EMI-ERROR-NUMBER    PIC X(4).
   742             20  EMI-FILL            PIC X.
   743             20  EMI-SEVERITY        PIC X.
   744             20  FILLER              PIC X.
   745             20  EMI-ERROR-TEXT.
   746                 24  EMI-TEXT-VARIABLE   PIC X(10).
   747                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  18
* EL652.cbl
   748     12  EMI-SEVERITY-SAVE           PIC X.
   749         88  EMI-NOTE                    VALUE 'N'.
   750         88  EMI-WARNING                 VALUE 'W'.
   751         88  EMI-FORCABLE                VALUE 'F'.
   752         88  EMI-FATAL                   VALUE 'X'.
   753     12  EMI-MESSAGE-FLAG            PIC X.
   754         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   755         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   756     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   757     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   758         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   759         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   760         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   761     12  emi-claim-no                pic x(7).
   762     12  emi-claim-type              pic x(6).
   763     12  FILLER                      PIC X(124)  VALUE SPACES.
   764     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   765     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   766     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   767     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  19
* EL652.cbl
   769 01  FILLER                  PIC X(16)  VALUE ALL 'B'.
   770*                          COPY ELCINTF.
   771******************************************************************
   772*                                                                *
   773*                                                                *
   774*                            ELCINTF.                            *
   775*                            VMOD=2.017                          *
   776*                                                                *
   777*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   778*                                                                *
   779*       LENGTH = 1024                                            *
   780*                                                                *
   781******************************************************************
   782*                   C H A N G E   L O G
   783*
   784* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   785*-----------------------------------------------------------------
   786*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   787* EFFECTIVE    NUMBER
   788*-----------------------------------------------------------------
   789* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   790******************************************************************
   791 01  PROGRAM-INTERFACE-BLOCK.
   792     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   793     12  PI-CALLING-PROGRAM              PIC X(8).
   794     12  PI-SAVED-PROGRAM-1              PIC X(8).
   795     12  PI-SAVED-PROGRAM-2              PIC X(8).
   796     12  PI-SAVED-PROGRAM-3              PIC X(8).
   797     12  PI-SAVED-PROGRAM-4              PIC X(8).
   798     12  PI-SAVED-PROGRAM-5              PIC X(8).
   799     12  PI-SAVED-PROGRAM-6              PIC X(8).
   800     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   801     12  PI-COMPANY-ID                   PIC XXX.
   802     12  PI-COMPANY-CD                   PIC X.
   803
   804     12  PI-COMPANY-PASSWORD             PIC X(8).
   805
   806     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   807
   808     12  PI-CONTROL-IN-PROGRESS.
   809         16  PI-CARRIER                  PIC X.
   810         16  PI-GROUPING                 PIC X(6).
   811         16  PI-STATE                    PIC XX.
   812         16  PI-ACCOUNT                  PIC X(10).
   813         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   814                                         PIC X(10).
   815         16  PI-CLAIM-CERT-GRP.
   816             20  PI-CLAIM-NO             PIC X(7).
   817             20  PI-CERT-NO.
   818                 25  PI-CERT-PRIME       PIC X(10).
   819                 25  PI-CERT-SFX         PIC X.
   820             20  PI-CERT-EFF-DT          PIC XX.
   821         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   822             20  PI-PLAN-CODE            PIC X(2).
   823             20  PI-REVISION-NUMBER      PIC X(3).
   824             20  PI-PLAN-EFF-DT          PIC X(2).
   825             20  PI-PLAN-EXP-DT          PIC X(2).
   826             20  FILLER                  PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  20
* EL652.cbl
   827         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   828             20  PI-OE-REFERENCE-1.
   829                 25  PI-OE-REF-1-PRIME   PIC X(18).
   830                 25  PI-OE-REF-1-SUFF    PIC XX.
   831
   832     12  PI-SESSION-IN-PROGRESS          PIC X.
   833         88  CLAIM-SESSION                   VALUE '1'.
   834         88  CREDIT-SESSION                  VALUE '2'.
   835         88  WARRANTY-SESSION                VALUE '3'.
   836         88  MORTGAGE-SESSION                VALUE '4'.
   837         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   838
   839
   840*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   841
   842     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   843     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   844
   845     12  PI-CREDIT-USER                  PIC X.
   846         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   847         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   848
   849     12  PI-CLAIM-USER                   PIC X.
   850         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   851         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   852
   853     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   854         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   855         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   856         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   857         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   858         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   859
   860     12  PI-PROCESSOR-ID                 PIC X(4).
   861
   862     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   863
   864     12  PI-MEMBER-CAPTION               PIC X(10).
   865
   866     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   867         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   868
   869     12  PI-LIFE-OVERRIDE-L1             PIC X.
   870     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   871     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   872     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   873
   874     12  PI-AH-OVERRIDE-L1               PIC X.
   875     12  PI-AH-OVERRIDE-L2               PIC XX.
   876     12  PI-AH-OVERRIDE-L6               PIC X(6).
   877     12  PI-AH-OVERRIDE-L12              PIC X(12).
   878
   879     12  PI-NEW-SYSTEM                   PIC X(2).
   880
   881     12  PI-PRIMARY-CERT-NO              PIC X(11).
   882     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   883         88  PI-USES-PAID-TO                 VALUE '1'.
   884     12  PI-CRDTCRD-SYSTEM.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  21
* EL652.cbl
   885         16  PI-CRDTCRD-USER             PIC X.
   886             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   887             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   888         16  PI-CC-MONTH-END-DT          PIC XX.
   889     12  PI-PROCESSOR-PRINTER            PIC X(4).
   890
   891     12  PI-OE-REFERENCE-2.
   892         16  PI-OE-REF-2-PRIME           PIC X(10).
   893         16  PI-OE-REF-2-SUFF            PIC X.
   894
   895     12  PI-REM-TRM-CALC-OPTION          PIC X.
   896
   897     12  PI-LANGUAGE-TYPE                PIC X.
   898             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   899             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   900             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   901
   902     12  PI-POLICY-LINKAGE-IND           PIC X.
   903         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   904         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   905                                                   LOW-VALUES.
   906
   907     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   908     12  PI-CLAIM-PW-SESSION             PIC X(1).
   909         88  PI-CLAIM-CREDIT                 VALUE '1'.
   910         88  PI-CLAIM-CONVEN                 VALUE '2'.
   911
   912     12  PI-PROCESSOR-CSR-IND            PIC X.
   913         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   914         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   915
   916     12  FILLER                          PIC X(3).
   917
   918     12  PI-SYSTEM-LEVEL                 PIC X(145).
   919
   920     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   921         PI-SYSTEM-LEVEL.
   922
   923         16  PI-ENTRY-CODES.
   924             20  PI-ENTRY-CD-1           PIC X.
   925             20  PI-ENTRY-CD-2           PIC X.
   926
   927         16  PI-RETURN-CODES.
   928             20  PI-RETURN-CD-1          PIC X.
   929             20  PI-RETURN-CD-2          PIC X.
   930
   931         16  PI-UPDATE-STATUS-SAVE.
   932             20  PI-UPDATE-BY            PIC X(4).
   933             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   934
   935         16  PI-LOWER-CASE-LETTERS       PIC X.
   936             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   937
   938*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   939*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   940*            88  CARRIER-CLM-CNTL            VALUE '2'.
   941
   942         16  PI-CERT-ACCESS-CONTROL      PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  22
* EL652.cbl
   943             88  ST-ACCNT-CNTL               VALUE ' '.
   944             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   945             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   946             88  ACCNT-CNTL                  VALUE '3'.
   947             88  CARR-ACCNT-CNTL             VALUE '4'.
   948
   949         16  PI-PROCESSOR-CAP-LIST.
   950             20  PI-SYSTEM-CONTROLS.
   951                24 PI-SYSTEM-DISPLAY     PIC X.
   952                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   953                24 PI-SYSTEM-MODIFY      PIC X.
   954                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   955             20  FILLER                  PIC XX.
   956             20  PI-DISPLAY-CAP          PIC X.
   957                 88  DISPLAY-CAP             VALUE 'Y'.
   958             20  PI-MODIFY-CAP           PIC X.
   959                 88  MODIFY-CAP              VALUE 'Y'.
   960             20  PI-MSG-AT-LOGON-CAP     PIC X.
   961                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   962             20  PI-FORCE-CAP            PIC X.
   963                 88  FORCE-CAP               VALUE 'Y'.
   964
   965         16  PI-PROGRAM-CONTROLS.
   966             20  PI-PGM-PRINT-OPT        PIC X.
   967             20  PI-PGM-FORMAT-OPT       PIC X.
   968             20  PI-PGM-PROCESS-OPT      PIC X.
   969             20  PI-PGM-TOTALS-OPT       PIC X.
   970
   971         16  PI-HELP-INTERFACE.
   972             20  PI-LAST-ERROR-NO        PIC X(4).
   973             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   974
   975         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   976             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   977
   978         16  PI-CR-CONTROL-IN-PROGRESS.
   979             20  PI-CR-CARRIER           PIC X.
   980             20  PI-CR-GROUPING          PIC X(6).
   981             20  PI-CR-STATE             PIC XX.
   982             20  PI-CR-ACCOUNT           PIC X(10).
   983             20  PI-CR-FIN-RESP          PIC X(10).
   984             20  PI-CR-TYPE              PIC X.
   985
   986         16  PI-CR-BATCH-NUMBER          PIC X(6).
   987
   988         16  PI-CR-MONTH-END-DT          PIC XX.
   989
   990         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   991             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   992             88  PI-ZERO-CARRIER             VALUE '1'.
   993             88  PI-ZERO-GROUPING            VALUE '2'.
   994             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   995
   996         16  PI-CARRIER-SECURITY         PIC X.
   997             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   998
   999         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1000             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  23
* EL652.cbl
  1001             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1002
  1003         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1004             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1005                                         INDEXED BY PI-ACCESS-NDX
  1006                                         PIC X.
  1007
  1008         16  PI-GA-BILLING-CONTROL       PIC X.
  1009             88  PI-GA-BILLING               VALUE '1'.
  1010
  1011         16  PI-MAIL-PROCESSING          PIC X.
  1012             88  PI-MAIL-YES                 VALUE 'Y'.
  1013
  1014         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1015
  1016         16  PI-AR-SYSTEM.
  1017             20  PI-AR-PROCESSING-CNTL   PIC X.
  1018                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1019             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1020             20  PI-AR-MONTH-END-DT      PIC XX.
  1021
  1022         16  PI-MP-SYSTEM.
  1023             20  PI-MORTGAGE-USER            PIC X.
  1024                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1025                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1026             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1027                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1028                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1029                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1030                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1031                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1032             20  PI-MP-MONTH-END-DT          PIC XX.
  1033             20  PI-MP-REFERENCE-NO.
  1034                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1035                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1036
  1037         16  PI-LABEL-CONTROL            PIC X(01).
  1038             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1039             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1040
  1041         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1042             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1043
  1044         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1045             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1046             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1047
  1048         16  FILLER                      PIC X(14).
  1049
  1050     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1051******************************************************************
  1052     12  PI-WORK-AREA  REDEFINES  PI-PROGRAM-WORK-AREA.
  1053         16  PI-CHECK-MAINT-TYPE     PIC  X.
  1054             88  VALID-MAINT-TYPE            VALUE 'S' 'A'
  1055                                                   'C' 'D'.
  1056             88  ADD-FUNCTION                VALUE 'A'.
  1057             88  SHOW-FUNCTION               VALUE 'S'.
  1058             88  DELETE-FUNCTION             VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  24
* EL652.cbl
  1059             88  CHANGE-FUNCTION             VALUE 'C'.
  1060         16  PI-CHECK-TYPE           PIC  X.
  1061             88  VALID-TYPE                  VALUE 'A' 'B' 'C'
  1062                                                           'G'.
  1063         16  PI-CHECK-CARRY-BAL      PIC  X.
  1064             88  VALID-CARRY-BAL             VALUE 'Y' 'N'.
  1065         16  PI-FIRST-TIME-SW        PIC  X.
  1066             88  FIRST-TIME                  VALUE 'Y'.
  1067         16  PI-ERCOMP-EOF-SW        PIC  X.
  1068             88  ERCOMP-EOF                  VALUE 'Y'.
  1069         16  PI-SAVE-PHONE           PIC  X(10).
  1070         16  PI-SAVE-PHONE-RED REDEFINES PI-SAVE-PHONE  PIC 9(10).
  1071         16  PI-ERC-END-BAL          PIC S9(9)V99       COMP-3.
  1072         16  PI-ERCOMP-KEY.
  1073             20  PI-ERC-COMPANY-CD   PIC  X.
  1074             20  PI-ERC-CARRIER      PIC  X.
  1075             20  PI-ERC-GROUP        PIC  X(6).
  1076             20  PI-ERC-RESP         PIC  X(10).
  1077             20  PI-ERC-ACCT         PIC  X(10).
  1078             20  PI-ERC-TYPE         PIC  X.
  1079         16  PI-SAVE-ERCOMP-KEY      PIC  X(29).
  1080         16  PI-SAVE-FAXNO           PIC  X(10).
  1081         16  PI-SAVE-FAXNO-RED REDEFINES PI-SAVE-FAXNO  PIC 9(10).
  1082         16  PI-SAVE-ADDR2           PIC X(30).
  1083         16  PI-SAVE-CITYST.
  1084             20  PI-SAVE-CITY        PIC X(28).
  1085             20  PI-SAVE-STATE       PIC XX.
  1086         16  PI-SAVE-ACCT-NAME       PIC X(30).
  1087         16  PI-EL652-DEL-SW         PIC X.
  1088         16  PI-UPDATE-SW            PIC X.
  1089         16  FILLER                  PIC  X(457).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  25
* EL652.cbl
  1091*                            COPY ELCJPFX.
  1092******************************************************************
  1093*                                                                *
  1094*                                                                *
  1095*                            ELCJPFX.                            *
  1096*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1097*                            VMOD=2.002                          *
  1098*                                                                *
  1099*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1100*                                                                *
  1101*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1102*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1103*        ELCNTL - CONTROL FILE                                   *
  1104*        ELMSTR - CLAIM MASTERS                                  *
  1105*        ELTRLR - ACTIVITY TRAILERS                              *
  1106*        ELCHKQ - CHECK QUE                                      *
  1107******************************************************************
  1108 01  JOURNAL-RECORD.
  1109     12  jp-date                     pic s9(5) comp-3.
  1110     12  jp-time                     pic s9(7) comp-3.
  1111     12  JP-USER-ID                  PIC X(4).
  1112     12  JP-FILE-ID                  PIC X(8).
  1113     12  JP-PROGRAM-ID               PIC X(8).
  1114     12  JP-RECORD-TYPE              PIC X.
  1115         88 JP-ADD              VALUE 'A'.
  1116         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1117         88 JP-AFTER-CHANGE     VALUE 'C'.
  1118         88 JP-DELETE           VALUE 'D'.
  1119         88 JP-GENERIC-DELETE   VALUE 'G'.
  1120         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1121         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1122     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1123     12  JP-RECORD-AREA
  1124
  1125
  1126                             PIC  X(750).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  26
* EL652.cbl
  1128*                            COPY ELCAID.
  1129******************************************************************
  1130*                                                                *
  1131*                            ELCAID.                             *
  1132*                            VMOD=2.001                          *
  1133*                                                                *
  1134*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1135*                                                                *
  1136*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1137*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1138******************************************************************
  1139
  1140 01  DFHAID.
  1141   02  DFHNULL   PIC  X  VALUE  ' '.
  1142   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1143   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1144   02  DFHPEN    PIC  X  VALUE  '='.
  1145   02  DFHOPID   PIC  X  VALUE  'W'.
  1146   02  DFHPA1    PIC  X  VALUE  '%'.
  1147   02  DFHPA2    PIC  X  VALUE  '>'.
  1148   02  DFHPA3    PIC  X  VALUE  ','.
  1149   02  DFHPF1    PIC  X  VALUE  '1'.
  1150   02  DFHPF2    PIC  X  VALUE  '2'.
  1151   02  DFHPF3    PIC  X  VALUE  '3'.
  1152   02  DFHPF4    PIC  X  VALUE  '4'.
  1153   02  DFHPF5    PIC  X  VALUE  '5'.
  1154   02  DFHPF6    PIC  X  VALUE  '6'.
  1155   02  DFHPF7    PIC  X  VALUE  '7'.
  1156   02  DFHPF8    PIC  X  VALUE  '8'.
  1157   02  DFHPF9    PIC  X  VALUE  '9'.
  1158   02  DFHPF10   PIC  X  VALUE  ':'.
  1159   02  DFHPF11   PIC  X  VALUE  '#'.
  1160   02  DFHPF12   PIC  X  VALUE  '@'.
  1161   02  DFHPF13   PIC  X  VALUE  'A'.
  1162   02  DFHPF14   PIC  X  VALUE  'B'.
  1163   02  DFHPF15   PIC  X  VALUE  'C'.
  1164   02  DFHPF16   PIC  X  VALUE  'D'.
  1165   02  DFHPF17   PIC  X  VALUE  'E'.
  1166   02  DFHPF18   PIC  X  VALUE  'F'.
  1167   02  DFHPF19   PIC  X  VALUE  'G'.
  1168   02  DFHPF20   PIC  X  VALUE  'H'.
  1169   02  DFHPF21   PIC  X  VALUE  'I'.
  1170*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1171   02  DFHPF22   PIC  X  VALUE  '['.
  1172   02  DFHPF23   PIC  X  VALUE  '.'.
  1173   02  DFHPF24   PIC  X  VALUE  '<'.
  1174   02  DFHMSRE   PIC  X  VALUE  'X'.
  1175   02  DFHSTRF   PIC  X  VALUE  'h'.
  1176   02  DFHTRIG   PIC  X  VALUE  '"'.
  1177
  1178 01  FILLER  REDEFINES  DFHAID.
  1179     12  FILLER              PIC  X(8).
  1180     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  27
* EL652.cbl
  1182*                            COPY EL652S.
  1183 01  EL652AI.
  1184     05  FILLER            PIC  X(0012).
  1185*    -------------------------------
  1186     05  RUNDATEL PIC S9(0004) COMP.
  1187     05  RUNDATEF PIC  X(0001).
  1188     05  FILLER REDEFINES RUNDATEF.
  1189         10  RUNDATEA PIC  X(0001).
  1190     05  RUNDATEI PIC  X(0008).
  1191*    -------------------------------
  1192     05  RUNTIMEL PIC S9(0004) COMP.
  1193     05  RUNTIMEF PIC  X(0001).
  1194     05  FILLER REDEFINES RUNTIMEF.
  1195         10  RUNTIMEA PIC  X(0001).
  1196     05  RUNTIMEI PIC  X(0005).
  1197*    -------------------------------
  1198     05  CMPNYIDL PIC S9(0004) COMP.
  1199     05  CMPNYIDF PIC  X(0001).
  1200     05  FILLER REDEFINES CMPNYIDF.
  1201         10  CMPNYIDA PIC  X(0001).
  1202     05  CMPNYIDI PIC  X(0003).
  1203*    -------------------------------
  1204     05  USERIDL PIC S9(0004) COMP.
  1205     05  USERIDF PIC  X(0001).
  1206     05  FILLER REDEFINES USERIDF.
  1207         10  USERIDA PIC  X(0001).
  1208     05  USERIDI PIC  X(0004).
  1209*    -------------------------------
  1210     05  MAINTYPL PIC S9(0004) COMP.
  1211     05  MAINTYPF PIC  X(0001).
  1212     05  FILLER REDEFINES MAINTYPF.
  1213         10  MAINTYPA PIC  X(0001).
  1214     05  MAINTYPI PIC  X(0001).
  1215*    -------------------------------
  1216     05  SCDESCL PIC S9(0004) COMP.
  1217     05  SCDESCF PIC  X(0001).
  1218     05  FILLER REDEFINES SCDESCF.
  1219         10  SCDESCA PIC  X(0001).
  1220     05  SCDESCI PIC  X(0008).
  1221*    -------------------------------
  1222     05  FLITYPEL PIC S9(0004) COMP.
  1223     05  FLITYPEF PIC  X(0001).
  1224     05  FILLER REDEFINES FLITYPEF.
  1225         10  FLITYPEA PIC  X(0001).
  1226     05  FLITYPEI PIC  X(0004).
  1227*    -------------------------------
  1228     05  CARRIERL PIC S9(0004) COMP.
  1229     05  CARRIERF PIC  X(0001).
  1230     05  FILLER REDEFINES CARRIERF.
  1231         10  CARRIERA PIC  X(0001).
  1232     05  CARRIERI PIC  X(0001).
  1233*    -------------------------------
  1234     05  GROUPL PIC S9(0004) COMP.
  1235     05  GROUPF PIC  X(0001).
  1236     05  FILLER REDEFINES GROUPF.
  1237         10  GROUPA PIC  X(0001).
  1238     05  GROUPI PIC  X(0006).
  1239*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  28
* EL652.cbl
  1240     05  TYPEL PIC S9(0004) COMP.
  1241     05  TYPEF PIC  X(0001).
  1242     05  FILLER REDEFINES TYPEF.
  1243         10  TYPEA PIC  X(0001).
  1244     05  TYPEI PIC  X(0001).
  1245*    -------------------------------
  1246     05  FINRESPL PIC S9(0004) COMP.
  1247     05  FINRESPF PIC  X(0001).
  1248     05  FILLER REDEFINES FINRESPF.
  1249         10  FINRESPA PIC  X(0001).
  1250     05  FINRESPI PIC  X(0010).
  1251*    -------------------------------
  1252     05  ACCTNOL PIC S9(0004) COMP.
  1253     05  ACCTNOF PIC  X(0001).
  1254     05  FILLER REDEFINES ACCTNOF.
  1255         10  ACCTNOA PIC  X(0001).
  1256     05  ACCTNOI PIC  X(0010).
  1257*    -------------------------------
  1258     05  SUMMNOL PIC S9(0004) COMP.
  1259     05  SUMMNOF PIC  X(0001).
  1260     05  FILLER REDEFINES SUMMNOF.
  1261         10  SUMMNOA PIC  X(0001).
  1262     05  SUMMNOI PIC  X(0006).
  1263*    -------------------------------
  1264     05  LSTMDTL PIC S9(0004) COMP.
  1265     05  LSTMDTF PIC  X(0001).
  1266     05  FILLER REDEFINES LSTMDTF.
  1267         10  LSTMDTA PIC  X(0001).
  1268     05  LSTMDTI PIC  X(0008).
  1269*    -------------------------------
  1270     05  FLITYPL PIC S9(0004) COMP.
  1271     05  FLITYPF PIC  X(0001).
  1272     05  FILLER REDEFINES FLITYPF.
  1273         10  FLITYPA PIC  X(0001).
  1274     05  FLITYPI PIC  X(0001).
  1275*    -------------------------------
  1276     05  PCONTL PIC S9(0004) COMP.
  1277     05  PCONTF PIC  X(0001).
  1278     05  FILLER REDEFINES PCONTF.
  1279         10  PCONTA PIC  X(0001).
  1280     05  PCONTI PIC  X(0030).
  1281*    -------------------------------
  1282     05  PNT1099L PIC S9(0004) COMP.
  1283     05  PNT1099F PIC  X(0001).
  1284     05  FILLER REDEFINES PNT1099F.
  1285         10  PNT1099A PIC  X(0001).
  1286     05  PNT1099I PIC  X(0001).
  1287*    -------------------------------
  1288     05  MAILNAML PIC S9(0004) COMP.
  1289     05  MAILNAMF PIC  X(0001).
  1290     05  FILLER REDEFINES MAILNAMF.
  1291         10  MAILNAMA PIC  X(0001).
  1292     05  MAILNAMI PIC  X(0030).
  1293*    -------------------------------
  1294     05  SSNL PIC S9(0004) COMP.
  1295     05  SSNF PIC  X(0001).
  1296     05  FILLER REDEFINES SSNF.
  1297         10  SSNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  29
* EL652.cbl
  1298     05  SSNI PIC  X(0013).
  1299*    -------------------------------
  1300     05  ACCTNAML PIC S9(0004) COMP.
  1301     05  ACCTNAMF PIC  X(0001).
  1302     05  FILLER REDEFINES ACCTNAMF.
  1303         10  ACCTNAMA PIC  X(0001).
  1304     05  ACCTNAMI PIC  X(0030).
  1305*    -------------------------------
  1306     05  PHONEL PIC S9(0004) COMP.
  1307     05  PHONEF PIC  X(0001).
  1308     05  FILLER REDEFINES PHONEF.
  1309         10  PHONEA PIC  X(0001).
  1310     05  PHONEI PIC  X(0012).
  1311*    -------------------------------
  1312     05  ADDR1L PIC S9(0004) COMP.
  1313     05  ADDR1F PIC  X(0001).
  1314     05  FILLER REDEFINES ADDR1F.
  1315         10  ADDR1A PIC  X(0001).
  1316     05  ADDR1I PIC  X(0030).
  1317*    -------------------------------
  1318     05  FAXDESCL PIC S9(0004) COMP.
  1319     05  FAXDESCF PIC  X(0001).
  1320     05  FILLER REDEFINES FAXDESCF.
  1321         10  FAXDESCA PIC  X(0001).
  1322     05  FAXDESCI PIC  X(0016).
  1323*    -------------------------------
  1324     05  FAXNOL PIC S9(0004) COMP.
  1325     05  FAXNOF PIC  X(0001).
  1326     05  FILLER REDEFINES FAXNOF.
  1327         10  FAXNOA PIC  X(0001).
  1328     05  FAXNOI PIC  X(0012).
  1329*    -------------------------------
  1330     05  ADDR2L PIC S9(0004) COMP.
  1331     05  ADDR2F PIC  X(0001).
  1332     05  FILLER REDEFINES ADDR2F.
  1333         10  ADDR2A PIC  X(0001).
  1334     05  ADDR2I PIC  X(0030).
  1335*    -------------------------------
  1336     05  CARBALL PIC S9(0004) COMP.
  1337     05  CARBALF PIC  X(0001).
  1338     05  FILLER REDEFINES CARBALF.
  1339         10  CARBALA PIC  X(0001).
  1340     05  CARBALI PIC  X(0001).
  1341*    -------------------------------
  1342     05  CITYL PIC S9(0004) COMP.
  1343     05  CITYF PIC  X(0001).
  1344     05  FILLER REDEFINES CITYF.
  1345         10  CITYA PIC  X(0001).
  1346     05  CITYI PIC  X(0028).
  1347*    -------------------------------
  1348     05  STATEL PIC S9(0004) COMP.
  1349     05  STATEF PIC  X(0001).
  1350     05  FILLER REDEFINES STATEF.
  1351         10  STATEA PIC  X(0001).
  1352     05  STATEI PIC  X(0002).
  1353*    -------------------------------
  1354     05  REFEHL PIC S9(0004) COMP.
  1355     05  REFEHF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  30
* EL652.cbl
  1356     05  FILLER REDEFINES REFEHF.
  1357         10  REFEHA PIC  X(0001).
  1358     05  REFEHI PIC  X(0013).
  1359*    -------------------------------
  1360     05  REFEL PIC S9(0004) COMP.
  1361     05  REFEF PIC  X(0001).
  1362     05  FILLER REDEFINES REFEF.
  1363         10  REFEA PIC  X(0001).
  1364     05  REFEI PIC  X(0001).
  1365*    -------------------------------
  1366     05  ZIPCODEL PIC S9(0004) COMP.
  1367     05  ZIPCODEF PIC  X(0001).
  1368     05  FILLER REDEFINES ZIPCODEF.
  1369         10  ZIPCODEA PIC  X(0001).
  1370     05  ZIPCODEI PIC  X(0010).
  1371*    -------------------------------
  1372     05  NGDESCL PIC S9(0004) COMP.
  1373     05  NGDESCF PIC  X(0001).
  1374     05  FILLER REDEFINES NGDESCF.
  1375         10  NGDESCA PIC  X(0001).
  1376     05  NGDESCI PIC  X(0012).
  1377*    -------------------------------
  1378     05  NETGRSL PIC S9(0004) COMP.
  1379     05  NETGRSF PIC  X(0001).
  1380     05  FILLER REDEFINES NETGRSF.
  1381         10  NETGRSA PIC  X(0001).
  1382     05  NETGRSI PIC  X(0001).
  1383*    -------------------------------
  1384     05  AHL120L PIC S9(0004) COMP.
  1385     05  AHL120F PIC  X(0001).
  1386     05  FILLER REDEFINES AHL120F.
  1387         10  AHL120A PIC  X(0001).
  1388     05  AHL120I PIC  X(0016).
  1389*    -------------------------------
  1390     05  OVER120L PIC S9(0004) COMP.
  1391     05  OVER120F PIC  X(0001).
  1392     05  FILLER REDEFINES OVER120F.
  1393         10  OVER120A PIC  X(0001).
  1394     05  OVER120I PIC  X(0013).
  1395*    -------------------------------
  1396     05  CSRL PIC S9(0004) COMP.
  1397     05  CSRF PIC  X(0001).
  1398     05  FILLER REDEFINES CSRF.
  1399         10  CSRA PIC  X(0001).
  1400     05  CSRI PIC  X(0004).
  1401*    -------------------------------
  1402     05  RPTCDDL PIC S9(0004) COMP.
  1403     05  RPTCDDF PIC  X(0001).
  1404     05  FILLER REDEFINES RPTCDDF.
  1405         10  RPTCDDA PIC  X(0001).
  1406     05  RPTCDDI PIC  X(0010).
  1407*    -------------------------------
  1408     05  RPTCD2L PIC S9(0004) COMP.
  1409     05  RPTCD2F PIC  X(0001).
  1410     05  FILLER REDEFINES RPTCD2F.
  1411         10  RPTCD2A PIC  X(0001).
  1412     05  RPTCD2I PIC  X(0010).
  1413*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  31
* EL652.cbl
  1414     05  CKDESCL PIC S9(0004) COMP.
  1415     05  CKDESCF PIC  X(0001).
  1416     05  FILLER REDEFINES CKDESCF.
  1417         10  CKDESCA PIC  X(0001).
  1418     05  CKDESCI PIC  X(0016).
  1419*    -------------------------------
  1420     05  CKPULLL PIC S9(0004) COMP.
  1421     05  CKPULLF PIC  X(0001).
  1422     05  FILLER REDEFINES CKPULLF.
  1423         10  CKPULLA PIC  X(0001).
  1424     05  CKPULLI PIC  X(0001).
  1425*    -------------------------------
  1426     05  BILLPRTL PIC S9(0004) COMP.
  1427     05  BILLPRTF PIC  X(0001).
  1428     05  FILLER REDEFINES BILLPRTF.
  1429         10  BILLPRTA PIC  X(0001).
  1430     05  BILLPRTI PIC  X(0001).
  1431*    -------------------------------
  1432     05  LETDESCL PIC S9(0004) COMP.
  1433     05  LETDESCF PIC  X(0001).
  1434     05  FILLER REDEFINES LETDESCF.
  1435         10  LETDESCA PIC  X(0001).
  1436     05  LETDESCI PIC  X(0011).
  1437*    -------------------------------
  1438     05  LETRCDL PIC S9(0004) COMP.
  1439     05  LETRCDF PIC  X(0001).
  1440     05  FILLER REDEFINES LETRCDF.
  1441         10  LETRCDA PIC  X(0001).
  1442     05  LETRCDI PIC  X(0001).
  1443*    -------------------------------
  1444     05  BALPRTL PIC S9(0004) COMP.
  1445     05  BALPRTF PIC  X(0001).
  1446     05  FILLER REDEFINES BALPRTF.
  1447         10  BALPRTA PIC  X(0001).
  1448     05  BALPRTI PIC  X(0011).
  1449*    -------------------------------
  1450     05  BALCDL PIC S9(0004) COMP.
  1451     05  BALCDF PIC  X(0001).
  1452     05  FILLER REDEFINES BALCDF.
  1453         10  BALCDA PIC  X(0001).
  1454     05  BALCDI PIC  X(0001).
  1455*    -------------------------------
  1456     05  SPPDDHL PIC S9(0004) COMP.
  1457     05  SPPDDHF PIC  X(0001).
  1458     05  FILLER REDEFINES SPPDDHF.
  1459         10  SPPDDHA PIC  X(0001).
  1460     05  SPPDDHI PIC  X(0012).
  1461*    -------------------------------
  1462     05  SPPDDL PIC S9(0004) COMP.
  1463     05  SPPDDF PIC  X(0001).
  1464     05  FILLER REDEFINES SPPDDF.
  1465         10  SPPDDA PIC  X(0001).
  1466     05  SPPDDI PIC  X(0001).
  1467*    -------------------------------
  1468     05  MFLABLL PIC S9(0004) COMP.
  1469     05  MFLABLF PIC  X(0001).
  1470     05  FILLER REDEFINES MFLABLF.
  1471         10  MFLABLA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  32
* EL652.cbl
  1472     05  MFLABLI PIC  X(0016).
  1473*    -------------------------------
  1474     05  MAXFEEL PIC S9(0004) COMP.
  1475     05  MAXFEEF PIC  X(0001).
  1476     05  FILLER REDEFINES MAXFEEF.
  1477         10  MAXFEEA PIC  X(0001).
  1478     05  MAXFEEI PIC  S9(04)V99.
  1479*    -------------------------------
  1480     05  CSLABLL PIC S9(0004) COMP.
  1481     05  CSLABLF PIC  X(0001).
  1482     05  FILLER REDEFINES CSLABLF.
  1483         10  CSLABLA PIC  X(0001).
  1484     05  CSLABLI PIC  X(0012).
  1485*    -------------------------------
  1486     05  CLPSTL PIC S9(0004) COMP.
  1487     05  CLPSTF PIC  X(0001).
  1488     05  FILLER REDEFINES CLPSTF.
  1489         10  CLPSTA PIC  X(0001).
  1490     05  CLPSTI PIC  X(0002).
  1491*    -------------------------------
  1492     05  LFLABLL PIC S9(0004) COMP.
  1493     05  LFLABLF PIC  X(0001).
  1494     05  FILLER REDEFINES LFLABLF.
  1495         10  LFLABLA PIC  X(0001).
  1496     05  LFLABLI PIC  X(0016).
  1497*    -------------------------------
  1498     05  MAXLFL PIC S9(0004) COMP.
  1499     05  MAXLFF PIC  X(0001).
  1500     05  FILLER REDEFINES MAXLFF.
  1501         10  MAXLFA PIC  X(0001).
  1502     05  MAXLFI PIC  S9(04)V99.
  1503*    -------------------------------
  1504     05  BALFWDL PIC S9(0004) COMP.
  1505     05  BALFWDF PIC  X(0001).
  1506     05  FILLER REDEFINES BALFWDF.
  1507         10  BALFWDA PIC  X(0001).
  1508     05  BALFWDI PIC  S9(11)V99.
  1509*    -------------------------------
  1510     05  CURCOML PIC S9(0004) COMP.
  1511     05  CURCOMF PIC  X(0001).
  1512     05  FILLER REDEFINES CURCOMF.
  1513         10  CURCOMA PIC  X(0001).
  1514     05  CURCOMI PIC  S9(11)V99.
  1515*    -------------------------------
  1516     05  CURCHGL PIC S9(0004) COMP.
  1517     05  CURCHGF PIC  X(0001).
  1518     05  FILLER REDEFINES CURCHGF.
  1519         10  CURCHGA PIC  X(0001).
  1520     05  CURCHGI PIC  S9(11)V99.
  1521*    -------------------------------
  1522     05  CURPMTL PIC S9(0004) COMP.
  1523     05  CURPMTF PIC  X(0001).
  1524     05  FILLER REDEFINES CURPMTF.
  1525         10  CURPMTA PIC  X(0001).
  1526     05  CURPMTI PIC  S9(11)V99.
  1527*    -------------------------------
  1528     05  ENDBALL PIC S9(0004) COMP.
  1529     05  ENDBALF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  33
* EL652.cbl
  1530     05  FILLER REDEFINES ENDBALF.
  1531         10  ENDBALA PIC  X(0001).
  1532     05  ENDBALI PIC  S9(11)V99.
  1533*    -------------------------------
  1534     05  CURRENTL PIC S9(0004) COMP.
  1535     05  CURRENTF PIC  X(0001).
  1536     05  FILLER REDEFINES CURRENTF.
  1537         10  CURRENTA PIC  X(0001).
  1538     05  CURRENTI PIC  X(0013).
  1539*    -------------------------------
  1540     05  OVER30L PIC S9(0004) COMP.
  1541     05  OVER30F PIC  X(0001).
  1542     05  FILLER REDEFINES OVER30F.
  1543         10  OVER30A PIC  X(0001).
  1544     05  OVER30I PIC  X(0013).
  1545*    -------------------------------
  1546     05  OVER60L PIC S9(0004) COMP.
  1547     05  OVER60F PIC  X(0001).
  1548     05  FILLER REDEFINES OVER60F.
  1549         10  OVER60A PIC  X(0001).
  1550     05  OVER60I PIC  X(0013).
  1551*    -------------------------------
  1552     05  OVER90L PIC S9(0004) COMP.
  1553     05  OVER90F PIC  X(0001).
  1554     05  FILLER REDEFINES OVER90F.
  1555         10  OVER90A PIC  X(0001).
  1556     05  OVER90I PIC  X(0013).
  1557*    -------------------------------
  1558     05  YTDCOML PIC S9(0004) COMP.
  1559     05  YTDCOMF PIC  X(0001).
  1560     05  FILLER REDEFINES YTDCOMF.
  1561         10  YTDCOMA PIC  X(0001).
  1562     05  YTDCOMI PIC  S9(11)V99.
  1563*    -------------------------------
  1564     05  LSTDTEL PIC S9(0004) COMP.
  1565     05  LSTDTEF PIC  X(0001).
  1566     05  FILLER REDEFINES LSTDTEF.
  1567         10  LSTDTEA PIC  X(0001).
  1568     05  LSTDTEI PIC  X(0008).
  1569*    -------------------------------
  1570     05  LSTTIMEL PIC S9(0004) COMP.
  1571     05  LSTTIMEF PIC  X(0001).
  1572     05  FILLER REDEFINES LSTTIMEF.
  1573         10  LSTTIMEA PIC  X(0001).
  1574     05  LSTTIMEI PIC  X(0005).
  1575*    -------------------------------
  1576     05  LSTUSRL PIC S9(0004) COMP.
  1577     05  LSTUSRF PIC  X(0001).
  1578     05  FILLER REDEFINES LSTUSRF.
  1579         10  LSTUSRA PIC  X(0001).
  1580     05  LSTUSRI PIC  X(0004).
  1581*    -------------------------------
  1582     05  ERRMSG1L PIC S9(0004) COMP.
  1583     05  ERRMSG1F PIC  X(0001).
  1584     05  FILLER REDEFINES ERRMSG1F.
  1585         10  ERRMSG1A PIC  X(0001).
  1586     05  ERRMSG1I PIC  X(0072).
  1587*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  34
* EL652.cbl
  1588     05  PFKEYL PIC S9(0004) COMP.
  1589     05  PFKEYF PIC  X(0001).
  1590     05  FILLER REDEFINES PFKEYF.
  1591         10  PFKEYA PIC  X(0001).
  1592     05  PFKEYI PIC  99.
  1593*    -------------------------------
  1594     05  PFK5L PIC S9(0004) COMP.
  1595     05  PFK5F PIC  X(0001).
  1596     05  FILLER REDEFINES PFK5F.
  1597         10  PFK5A PIC  X(0001).
  1598     05  PFK5I PIC  X(0011).
  1599*    -------------------------------
  1600     05  PFK7L PIC S9(0004) COMP.
  1601     05  PFK7F PIC  X(0001).
  1602     05  FILLER REDEFINES PFK7F.
  1603         10  PFK7A PIC  X(0001).
  1604     05  PFK7I PIC  X(0012).
  1605*    -------------------------------
  1606     05  PFK9L PIC S9(0004) COMP.
  1607     05  PFK9F PIC  X(0001).
  1608     05  FILLER REDEFINES PFK9F.
  1609         10  PFK9A PIC  X(0001).
  1610     05  PFK9I PIC  X(0012).
  1611*    -------------------------------
  1612     05  PFK13L PIC S9(0004) COMP.
  1613     05  PFK13F PIC  X(0001).
  1614     05  FILLER REDEFINES PFK13F.
  1615         10  PFK13A PIC  X(0001).
  1616     05  PFK13I PIC  X(0011).
  1617*    -------------------------------
  1618     05  PFK4L PIC S9(0004) COMP.
  1619     05  PFK4F PIC  X(0001).
  1620     05  FILLER REDEFINES PFK4F.
  1621         10  PFK4A PIC  X(0001).
  1622     05  PFK4I PIC  X(0012).
  1623*    -------------------------------
  1624     05  PFK6L PIC S9(0004) COMP.
  1625     05  PFK6F PIC  X(0001).
  1626     05  FILLER REDEFINES PFK6F.
  1627         10  PFK6A PIC  X(0001).
  1628     05  PFK6I PIC  X(0011).
  1629*    -------------------------------
  1630     05  PFK10L PIC S9(0004) COMP.
  1631     05  PFK10F PIC  X(0001).
  1632     05  FILLER REDEFINES PFK10F.
  1633         10  PFK10A PIC  X(0001).
  1634     05  PFK10I PIC  X(0014).
  1635 01  EL652AO REDEFINES EL652AI.
  1636     05  FILLER            PIC  X(0012).
  1637*    -------------------------------
  1638     05  FILLER            PIC  X(0003).
  1639     05  RUNDATEO PIC  X(0008).
  1640*    -------------------------------
  1641     05  FILLER            PIC  X(0003).
  1642     05  RUNTIMEO PIC  99.99.
  1643*    -------------------------------
  1644     05  FILLER            PIC  X(0003).
  1645     05  CMPNYIDO PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  35
* EL652.cbl
  1646*    -------------------------------
  1647     05  FILLER            PIC  X(0003).
  1648     05  USERIDO PIC  X(0004).
  1649*    -------------------------------
  1650     05  FILLER            PIC  X(0003).
  1651     05  MAINTYPO PIC  X(0001).
  1652*    -------------------------------
  1653     05  FILLER            PIC  X(0003).
  1654     05  SCDESCO PIC  X(0008).
  1655*    -------------------------------
  1656     05  FILLER            PIC  X(0003).
  1657     05  FLITYPEO PIC  X(0004).
  1658*    -------------------------------
  1659     05  FILLER            PIC  X(0003).
  1660     05  CARRIERO PIC  X(0001).
  1661*    -------------------------------
  1662     05  FILLER            PIC  X(0003).
  1663     05  GROUPO PIC  X(0006).
  1664*    -------------------------------
  1665     05  FILLER            PIC  X(0003).
  1666     05  TYPEO PIC  X(0001).
  1667*    -------------------------------
  1668     05  FILLER            PIC  X(0003).
  1669     05  FINRESPO PIC  X(0010).
  1670*    -------------------------------
  1671     05  FILLER            PIC  X(0003).
  1672     05  ACCTNOO PIC  X(0010).
  1673*    -------------------------------
  1674     05  FILLER            PIC  X(0003).
  1675     05  SUMMNOO PIC  X(0006).
  1676*    -------------------------------
  1677     05  FILLER            PIC  X(0003).
  1678     05  LSTMDTO PIC  X(0008).
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
  1681     05  FLITYPO PIC  X(0001).
  1682*    -------------------------------
  1683     05  FILLER            PIC  X(0003).
  1684     05  PCONTO PIC  X(0030).
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  PNT1099O PIC  X(0001).
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  MAILNAMO PIC  X(0030).
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  SSNO PIC  X(0013).
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  ACCTNAMO PIC  X(0030).
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  PHONEO PIC  X(0012).
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  ADDR1O PIC  X(0030).
  1703*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  36
* EL652.cbl
  1704     05  FILLER            PIC  X(0003).
  1705     05  FAXDESCO PIC  X(0016).
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  FAXNOO PIC  X(0012).
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  ADDR2O PIC  X(0030).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  CARBALO PIC  X(0001).
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  CITYO PIC  X(0028).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  STATEO PIC  X(0002).
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  REFEHO PIC  X(0013).
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  REFEO PIC  X(0001).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  ZIPCODEO PIC  X(0010).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  NGDESCO PIC  X(0012).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  NETGRSO PIC  X(0001).
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  AHL120O PIC  X(0016).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  OVER120O PIC  Z,ZZZ,ZZZ.99-.
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  CSRO PIC  X(0004).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  RPTCDDO PIC  X(0010).
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  RPTCD2O PIC  X(0010).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  CKDESCO PIC  X(0016).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  CKPULLO PIC  X(0001).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  BILLPRTO PIC  X(0001).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  37
* EL652.cbl
  1762     05  LETDESCO PIC  X(0011).
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  LETRCDO PIC  X(0001).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  BALPRTO PIC  X(0011).
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  BALCDO PIC  X(0001).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  SPPDDHO PIC  X(0012).
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  SPPDDO PIC  X(0001).
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  MFLABLO PIC  X(0016).
  1781*    -------------------------------
  1782     05  FILLER            PIC  X(0003).
  1783     05  MAXFEEO PIC  Z99.99.
  1784*    -------------------------------
  1785     05  FILLER            PIC  X(0003).
  1786     05  CSLABLO PIC  X(0012).
  1787*    -------------------------------
  1788     05  FILLER            PIC  X(0003).
  1789     05  CLPSTO PIC  X(0002).
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  LFLABLO PIC  X(0016).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  MAXLFO PIC  Z99.99.
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  BALFWDO PIC  Z,ZZZ,ZZZ.99-.
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  CURCOMO PIC  Z,ZZZ,ZZZ.99-.
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  CURCHGO PIC  Z,ZZZ,ZZZ.99-.
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  CURPMTO PIC  Z,ZZZ,ZZZ.99-.
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  ENDBALO PIC  Z,ZZZ,ZZZ.99-.
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  CURRENTO PIC  Z,ZZZ,ZZZ.99-.
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  OVER30O PIC  Z,ZZZ,ZZZ.99-.
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  OVER60O PIC  Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  38
* EL652.cbl
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  OVER90O PIC  Z,ZZZ,ZZZ.99-.
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  YTDCOMO PIC  Z,ZZZ,ZZZ.99-.
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  LSTDTEO PIC  X(0008).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  LSTTIMEO PIC  99.99.
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  LSTUSRO PIC  X(0004).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  ERRMSG1O PIC  X(0072).
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  PFKEYO PIC  X(0002).
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  PFK5O PIC  X(0011).
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  PFK7O PIC  X(0012).
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  PFK9O PIC  X(0012).
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  PFK13O PIC  X(0011).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  PFK4O PIC  X(0012).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  PFK6O PIC  X(0011).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  PFK10O PIC  X(0014).
  1862*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  39
* EL652.cbl
  1864****************************************************************
  1865*
  1866* Copyright (c) 2007-2013 Dell Inc.
  1867* All rights reserved.
  1868*
  1869****************************************************************
  1870 01  DFHEIV.
  1871   02  DFHEIV0               PIC X(35).
  1872   02  DFHEIV1               PIC X(08).
  1873   02  DFHEIV2               PIC X(08).
  1874   02  DFHEIV3               PIC X(08).
  1875   02  DFHEIV4               PIC X(06).
  1876   02  DFHEIV5               PIC X(04).
  1877   02  DFHEIV6               PIC X(04).
  1878   02  DFHEIV7               PIC X(02).
  1879   02  DFHEIV8               PIC X(02).
  1880   02  DFHEIV9               PIC X(01).
  1881   02  DFHEIV10              PIC S9(7) COMP-3.
  1882   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1883   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1884   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1885   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1886   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1887   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1888   02  DFHEIV17              PIC X(04).
  1889   02  DFHEIV18              PIC X(04).
  1890   02  DFHEIV19              PIC X(04).
  1891   02  DFHEIV20              USAGE IS POINTER.
  1892   02  DFHEIV21              USAGE IS POINTER.
  1893   02  DFHEIV22              USAGE IS POINTER.
  1894   02  DFHEIV23              USAGE IS POINTER.
  1895   02  DFHEIV24              USAGE IS POINTER.
  1896   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1897   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1898   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1899   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1900   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1901   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1902   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1903   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1904   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1905   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1906   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1907   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1908   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1909   02  FILLER                PIC X(02).
  1910   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1911   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1912   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1913   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1914   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1915   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1916   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1917 LINKAGE  SECTION.
  1918*****************************************************************
  1919*                                                               *
  1920* Copyright (c) 2007-2013 Dell Inc.                             *
  1921* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  40
* EL652.cbl
  1922*                                                               *
  1923*****************************************************************
  1924 01  dfheiblk.
  1925     02  eibtime          pic s9(7) comp-3.
  1926     02  eibdate          pic s9(7) comp-3.
  1927     02  eibtrnid         pic x(4).
  1928     02  eibtaskn         pic s9(7) comp-3.
  1929     02  eibtrmid         pic x(4).
  1930     02  dfheigdi         pic s9(4) comp.
  1931     02  eibcposn         pic s9(4) comp.
  1932     02  eibcalen         pic s9(4) comp.
  1933     02  eibaid           pic x(1).
  1934     02  eibfiller1       pic x(1).
  1935     02  eibfn            pic x(2).
  1936     02  eibfiller2       pic x(2).
  1937     02  eibrcode         pic x(6).
  1938     02  eibfiller3       pic x(2).
  1939     02  eibds            pic x(8).
  1940     02  eibreqid         pic x(8).
  1941     02  eibrsrce         pic x(8).
  1942     02  eibsync          pic x(1).
  1943     02  eibfree          pic x(1).
  1944     02  eibrecv          pic x(1).
  1945     02  eibsend          pic x(1).
  1946     02  eibatt           pic x(1).
  1947     02  eibeoc           pic x(1).
  1948     02  eibfmh           pic x(1).
  1949     02  eibcompl         pic x(1).
  1950     02  eibsig           pic x(1).
  1951     02  eibconf          pic x(1).
  1952     02  eiberr           pic x(1).
  1953     02  eibrldbk         pic x(1).
  1954     02  eiberrcd         pic x(4).
  1955     02  eibsynrb         pic x(1).
  1956     02  eibnodat         pic x(1).
  1957     02  eibfiller5       pic x(2).
  1958     02  eibresp          pic s9(8) comp.
  1959     02  eibresp2         pic s9(8) comp.
  1960     02  dfheigdj         pic s9(4) comp.
  1961     02  dfheigdk         pic s9(4) comp.
  1962
  1963 01  DFHCOMMAREA             PIC  X(1024).
  1964
  1965*01 PARMLIST .
  1966*    12  FILLER              PIC S9(8)                  COMP.
  1967*    12  ERCOMP-POINTER      PIC S9(8)                  COMP.
  1968*    12  ERNAME-POINTER      PIC S9(8)                  COMP.
  1969*    12  ELCNTL-POINTER      PIC S9(8)                  COMP.
  1970*    12  ERSUMM-POINTER      PIC S9(8)                  COMP.
  1971*    12  ERRQST-POINTER      PIC S9(8)                  COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  41
* EL652.cbl
  1973*                            COPY ERCCOMP.
  1974******************************************************************
  1975*                                                                *
  1976*                                                                *
  1977*                            ERCCOMP                             *
  1978*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1979*                            VMOD=2.019                          *
  1980*                                                                *
  1981*   ONLINE CREDIT SYSTEM                                         *
  1982*                                                                *
  1983*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1984*                                                                *
  1985*   FILE TYPE = VSAM,KSDS                                        *
  1986*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1987*                                                                *
  1988*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1989*       ALTERNATE PATH = NONE                                    *
  1990*                                                                *
  1991*   LOG = NO                                                     *
  1992*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1993*                                                                *
  1994******************************************************************
  1995*                   C H A N G E   L O G
  1996*
  1997* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1998*-----------------------------------------------------------------
  1999*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2000* EFFECTIVE    NUMBER
  2001*-----------------------------------------------------------------
  2002* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2003* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2004* 092205    2005050300006  PEMA  ADD LEASE FEE
  2005* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2006* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2007* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2008* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2009* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2010* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  2011******************************************************************
  2012
  2013 01  COMPENSATION-MASTER.
  2014     12  CO-RECORD-ID                          PIC XX.
  2015         88  VALID-CO-ID                          VALUE 'CO'.
  2016
  2017     12  CO-CONTROL-PRIMARY.
  2018         16  CO-COMPANY-CD                     PIC X.
  2019         16  CO-CONTROL.
  2020             20  CO-CTL-1.
  2021                 24  CO-CARR-GROUP.
  2022                     28  CO-CARRIER            PIC X.
  2023                     28  CO-GROUPING.
  2024                         32  CO-GROUP-PREFIX   PIC XXX.
  2025                         32  CO-GROUP-PRIME    PIC XXX.
  2026                 24  CO-RESP-NO.
  2027                     28  CO-RESP-PREFIX        PIC X(4).
  2028                     28  CO-RESP-PRIME         PIC X(6).
  2029             20  CO-CTL-2.
  2030                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  42
* EL652.cbl
  2031                     28  CO-ACCT-PREFIX        PIC X(4).
  2032                     28  CO-ACCT-PRIME         PIC X(6).
  2033         16  CO-TYPE                           PIC X.
  2034             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2035             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2036             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2037
  2038     12  CO-MAINT-INFORMATION.
  2039         16  CO-LAST-MAINT-DT                  PIC XX.
  2040         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2041         16  CO-LAST-MAINT-USER                PIC X(4).
  2042     12  FILLER                                PIC XX.
  2043     12  CO-STMT-TYPE                          PIC XXX.
  2044     12  CO-COMP-TYPE                          PIC X.
  2045         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2046     12  CO-STMT-OWNER                         PIC X(4).
  2047     12  CO-BALANCE-CONTROL                    PIC X.
  2048         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2049         88  CO-NO-BALANCE                        VALUE 'N'.
  2050
  2051     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2052         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2053         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2054         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2055
  2056     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2057         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2058         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2059
  2060     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2061     12  CO-GA-DIRECT-DEP                      PIC X.
  2062     12  CO-FUTURE-SPACE                       PIC X.
  2063         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2064
  2065     12  CO-ACCT-NAME                          PIC X(30).
  2066     12  CO-MAIL-NAME                          PIC X(30).
  2067     12  CO-ADDR-1                             PIC X(30).
  2068     12  CO-ADDR-2                             PIC X(30).
  2069     12  CO-ADDR-3.
  2070         16  CO-ADDR-CITY                      PIC X(27).
  2071         16  CO-ADDR-STATE                     PIC XX.
  2072     12  CO-CSO-1099                           PIC X.
  2073     12  CO-ZIP.
  2074         16  CO-ZIP-PRIME.
  2075             20  CO-ZIP-PRI-1ST                PIC X.
  2076                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2077             20  FILLER                        PIC X(4).
  2078         16  CO-ZIP-PLUS4                      PIC X(4).
  2079     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2080         16  CO-CAN-POSTAL-1                   PIC XXX.
  2081         16  CO-CAN-POSTAL-2                   PIC XXX.
  2082         16  FILLER                            PIC XXX.
  2083     12  CO-SOC-SEC                            PIC X(13).
  2084     12  CO-TELEPHONE.
  2085         16  CO-AREA-CODE                      PIC XXX.
  2086         16  CO-PREFIX                         PIC XXX.
  2087         16  CO-PHONE                          PIC X(4).
  2088
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  43
* EL652.cbl
  2089     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2090
  2091     12  CO-AR-BAL-LEVEL                       PIC X.
  2092         88  CO-AR-REF-LVL                        VALUE '1'.
  2093         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2094         88  CO-AR-BILL-LVL                       VALUE '2'.
  2095         88  CO-AR-AGT-LVL                        VALUE '3'.
  2096         88  CO-AR-FR-LVL                         VALUE '4'.
  2097
  2098     12  CO-AR-NORMAL-PRINT                    PIC X.
  2099         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2100         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2101
  2102     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2103
  2104     12  CO-AR-REPORTING                       PIC X.
  2105         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2106         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2107
  2108     12  CO-AR-PULL-CHECK                      PIC X.
  2109         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2110         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2111
  2112     12  CO-AR-BALANCE-PRINT                   PIC X.
  2113         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2114
  2115     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2116         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2117         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2118         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2119
  2120     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2121
  2122     12  CO-USER-CODE                          PIC X.
  2123     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2124
  2125******************************************************************
  2126*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2127*    THE LAST MONTH END RUN.
  2128******************************************************************
  2129
  2130     12  CO-LAST-ACTIVITY-DATE.
  2131         16  CO-ACT-YEAR                       PIC 99.
  2132         16  CO-ACT-MONTH                      PIC 99.
  2133         16  CO-ACT-DAY                        PIC 99.
  2134
  2135     12  CO-LAST-STMT-DT.
  2136         16  CO-LAST-STMT-YEAR                 PIC 99.
  2137         16  CO-LAST-STMT-MONTH                PIC 99.
  2138         16  CO-LAST-STMT-DAY                  PIC 99.
  2139
  2140     12  CO-MO-END-TOTALS.
  2141         16  CO-MONTHLY-TOTALS.
  2142             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2143             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2144             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2145             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  2146             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  44
* EL652.cbl
  2147
  2148         16  CO-AGING-TOTALS.
  2149             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2150             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2151             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2152             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2153
  2154         16  CO-YTD-TOTALS.
  2155             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2156             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2157
  2158         16  CO-OVER-UNDER-TOTALS.
  2159             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2160             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2161
  2162     12  CO-MISCELLANEOUS-TOTALS.
  2163         16  CO-FICA-TOTALS.
  2164             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2165             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2166
  2167         16  CO-CLAIM-TOTALS.
  2168             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2169             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2170
  2171******************************************************************
  2172*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2173*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2174******************************************************************
  2175
  2176     12  CO-CURRENT-TOTALS.
  2177         16  CO-CURRENT-LAST-STMT-DT.
  2178             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2179             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2180             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2181
  2182         16  CO-CURRENT-MONTHLY-TOTALS.
  2183             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2184             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2185             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2186             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2187             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2188
  2189         16  CO-CURRENT-AGING-TOTALS.
  2190             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2191             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2192             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2193             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2194
  2195         16  CO-CURRENT-YTD-TOTALS.
  2196             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2197             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2198
  2199     12  CO-PAID-COMM-TOTALS.
  2200         16  CO-YTD-PAID-COMMS.
  2201             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2202             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2203
  2204     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  45
* EL652.cbl
  2205         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  2206         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2207
  2208     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2209         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2210         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2211         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2212         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2213         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2214         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2215         88  CO-FINAL-LETTER                  VALUE 'F'.
  2216         88  CO-RECONCILING                   VALUE 'R'.
  2217         88  CO-PHONE-CALL                    VALUE 'P'.
  2218         88  CO-LEGAL                         VALUE 'L'.
  2219         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2220         88  CO-WRITE-OFF                     VALUE 'W'.
  2221         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2222
  2223     12  CO-CSR-CODE                       PIC X(4).
  2224
  2225     12  CO-GA-STATUS-INFO.
  2226         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2227         16  CO-GA-TERMINATION-DT          PIC XX.
  2228         16  CO-GA-STATUS-CODE             PIC X.
  2229             88  CO-GA-ACTIVE                 VALUE 'A'.
  2230             88  CO-GA-INACTIVE               VALUE 'I'.
  2231             88  CO-GA-PENDING                VALUE 'P'.
  2232         16  CO-GA-COMMENTS.
  2233             20  CO-GA-COMMENT-1           PIC X(40).
  2234             20  CO-GA-COMMENT-2           PIC X(40).
  2235             20  CO-GA-COMMENT-3           PIC X(40).
  2236             20  CO-GA-COMMENT-4           PIC X(40).
  2237
  2238     12  CO-RPTCD2                         PIC X(10).
  2239     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  2240         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  2241         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  2242
  2243     12  CO-TYPE-AGENT                     PIC X(01).
  2244         88  CO-CORPORATION                   VALUE 'C'.
  2245         88  CO-PARTNERSHIP                   VALUE 'P'.
  2246         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2247         88  CO-TRUST                         VALUE 'T'.
  2248         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2249
  2250     12  CO-FAXNO.
  2251         16  CO-FAX-AREA-CODE                  PIC XXX.
  2252         16  CO-FAX-PREFIX                     PIC XXX.
  2253         16  CO-FAX-PHONE                      PIC X(4).
  2254
  2255     12  CO-BANK-INFORMATION.
  2256         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2257         16  CO-BANK-TRANSIT-NON REDEFINES
  2258             CO-BANK-TRANSIT-NO                PIC 9(8).
  2259
  2260         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2261     12  CO-MISC-DEDUCT-INFO REDEFINES
  2262                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  46
* EL652.cbl
  2263         16  CO-MD-GL-ACCT                     PIC X(10).
  2264         16  CO-MD-DIV                         PIC XX.
  2265         16  CO-MD-CENTER                      PIC X(4).
  2266         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  2267         16  CO-CREATE-AP-CHECK                PIC X.
  2268         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2269         16  FILLER                            PIC XXX.
  2270     12  CO-ACH-STATUS                         PIC X.
  2271         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2272         88  CO-ACH-PENDING                        VALUE 'P'.
  2273
  2274     12  CO-BILL-SW                            PIC X.
  2275     12  CO-CONTROL-NAME                       PIC X(30).
  2276     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2277     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2278     12  CO-CLP-STATE                          PIC XX.
  2279     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2280     12  CO-SPP-REFUND-EDIT                    PIC X.
  2281
  2282******************************************************************
  2283*                            COPY ERCAGTC.
  2284******************************************************************
  2285*                                                                *
  2286*                                                                *
  2287*                            ERCAGTC                             *
  2288*                            VMOD=2.001                          *
  2289*                                                                *
  2290*   ONLINE CREDIT SYSTEM                                         *
  2291*                                                                *
  2292*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2293*                                                                *
  2294*   FILE TYPE = VSAM,KSDS                                        *
  2295*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2296*                                                                *
  2297*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2298*       ALTERNATE PATH = NONE                                    *
  2299*                                                                *
  2300*   LOG = NO                                                     *
  2301*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2302*                                                                *
  2303******************************************************************
  2304*                   C H A N G E   L O G
  2305*
  2306* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2307*-----------------------------------------------------------------
  2308*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2309* EFFECTIVE    NUMBER
  2310*-----------------------------------------------------------------
  2311* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2312* 111004                         NEW FILE AND COPYBOOK
  2313* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2314******************************************************************
  2315 01  AGENT-COMMISSIONS.
  2316     12  AG-RECORD-ID                          PIC XX.
  2317         88  VALID-CO-ID                          VALUE 'AG'.
  2318     12  AG-CONTROL-PRIMARY.
  2319         16  AG-COMPANY-CD                     PIC X.
  2320         16  AG-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  47
* EL652.cbl
  2321             20  AG-CTL-1.
  2322                 24  AG-CARR-GROUP.
  2323                     28  AG-CARRIER            PIC X.
  2324                     28  AG-GROUPING           PIC X(6).
  2325                 24  AG-BANK                   PIC X(10).
  2326             20  AG-CTL-2.
  2327                 24  AG-EXP-DT                 PIC XX.
  2328         16  AG-TYPE                           PIC X.
  2329             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2330             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2331     12  AG-MAINT-INFORMATION.
  2332         16  AG-LAST-MAINT-DT                  PIC XX.
  2333         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2334         16  AG-LAST-MAINT-USER                PIC X(4).
  2335         16  FILLER                            PIC X(10).
  2336     12  AG-EFF-DT                             PIC XX.
  2337     12  AG-COMM-STRUCTURE.
  2338         16  AG-AGT-COMMS OCCURS 10.
  2339             20  AG-AGT                PIC X(10).
  2340             20  AG-COM-TYP            PIC X.
  2341             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2342             20  AG-RECALC-LV-INDIC    PIC X.
  2343             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2344             20  AG-LRCALC-LV-INDIC    PIC X.
  2345             20  FILLER                PIC X(05).
  2346     12  FILLER                  PIC X(145).
  2347******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  48
* EL652.cbl
  2349*                            COPY ERCNAME.
  2350******************************************************************
  2351*                                                                *
  2352*                                                                *
  2353*                            ERCNAME                             *
  2354*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2355*                            VMOD=2.003                          *
  2356*                                                                *
  2357*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  2358*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  2359*                                                                *
  2360*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  2361*                                                                *
  2362*   FILE TYPE = VSAM,KSDS                                        *
  2363*   RECORD SIZE = 160   RECFORM = FIX                            *
  2364*                                                                *
  2365*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  2366*                                                                *
  2367*   LOG = NO                                                     *
  2368*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2369*                                                                *
  2370*                                                                *
  2371******************************************************************
  2372
  2373 01  NAME-LOOKUP-MASTER.
  2374     12  NL-RECORD-ID                PIC  X(02).
  2375         88  VALID-NL-ID                         VALUE 'NL'.
  2376
  2377     12  NL-RECORD-KEY.
  2378         16  NL-CONTROL-PRIMARY.
  2379             20  NL-COMPANY-CD       PIC  X(01).
  2380             20  NL-NAME             PIC  X(30).
  2381             20  NL-RECORD-TYPE      PIC  X(01).
  2382                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  2383                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  2384                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  2385
  2386         16  NL-ACCOUNT-MASTER.
  2387             20  NL-AM-COMPANY-CD    PIC  X(01).
  2388             20  NL-AM-CARRIER       PIC  X(01).
  2389             20  NL-AM-GROUPING      PIC  X(06).
  2390             20  NL-AM-STATE         PIC  X(02).
  2391             20  NL-AM-ACCOUNT       PIC  X(10).
  2392             20  FILLER              PIC  X(09).
  2393
  2394         16  NL-COMPENSATION-MASTER
  2395                                 REDEFINES  NL-ACCOUNT-MASTER.
  2396             20  NL-CO-COMPANY-CD    PIC  X(01).
  2397             20  NL-CO-CARRIER       PIC  X(01).
  2398             20  NL-CO-GROUPING      PIC  X(06).
  2399             20  NL-CO-RESP-NO       PIC  X(10).
  2400             20  NL-CO-ACCOUNT       PIC  X(10).
  2401             20  NL-CO-TYPE          PIC  X(01).
  2402
  2403         16  NL-REINSURANCE-RECORD
  2404                                 REDEFINES  NL-ACCOUNT-MASTER.
  2405             20  NL-RE-COMPANY-CD    PIC  X(01).
  2406             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  49
* EL652.cbl
  2407             20  NL-RE-COMPANY.
  2408                 24  NL-RE-COMP      PIC  X(03).
  2409                 24  NL-RE-CO-SUB    PIC  X(03).
  2410             20  NL-RE-TABLE         PIC  X(03).
  2411             20  FILLER              PIC  X(18).
  2412
  2413     12  NL-MAINT-INFORMATION.
  2414         16  NL-LAST-MAINT-DT        PIC  X(02).
  2415         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  2416         16  NL-LAST-MAINT-USER      PIC  X(04).
  2417         16  FILLER                  PIC  X(10).
  2418
  2419     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  2420         16  NL-RE-LEVEL             PIC  9(02).
  2421
  2422     12  NL-CITY                     PIC  X(15).
  2423     12  NL-ST                       PIC  XX.
  2424
  2425******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  50
* EL652.cbl
  2427*                            COPY ELCCNTL.
  2428******************************************************************
  2429*                                                                *
  2430*                                                                *
  2431*                            ELCCNTL.                            *
  2432*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2433*                            VMOD=2.059                          *
  2434*                                                                *
  2435*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2436*                                                                *
  2437*   FILE TYPE = VSAM,KSDS                                        *
  2438*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2439*                                                                *
  2440*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2441*       ALTERNATE INDEX = NONE                                   *
  2442*                                                                *
  2443*   LOG = YES                                                    *
  2444*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2445******************************************************************
  2446*                   C H A N G E   L O G
  2447*
  2448* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2449*-----------------------------------------------------------------
  2450*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2451* EFFECTIVE    NUMBER
  2452*-----------------------------------------------------------------
  2453* 082503                   PEMA  ADD BENEFIT GROUP
  2454* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2455* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2456* 092705    2005050300006  PEMA  ADD SPP LEASES
  2457* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2458* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2459* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2460* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2461* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2462* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2463* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2464* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2465* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2466* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2467* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2468******************************************************************
  2469*
  2470 01  CONTROL-FILE.
  2471     12  CF-RECORD-ID                       PIC XX.
  2472         88  VALID-CF-ID                        VALUE 'CF'.
  2473
  2474     12  CF-CONTROL-PRIMARY.
  2475         16  CF-COMPANY-ID                  PIC XXX.
  2476         16  CF-RECORD-TYPE                 PIC X.
  2477             88  CF-COMPANY-MASTER              VALUE '1'.
  2478             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2479             88  CF-STATE-MASTER                VALUE '3'.
  2480             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2481             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2482             88  CF-CARRIER-MASTER              VALUE '6'.
  2483             88  CF-MORTALITY-MASTER            VALUE '7'.
  2484             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  51
* EL652.cbl
  2485             88  CF-TERMINAL-MASTER             VALUE '9'.
  2486             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2487             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2488             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2489             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2490             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2491             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2492             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2493             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2494             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2495         16  CF-ACCESS-CD-GENL              PIC X(4).
  2496         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2497             20  CF-PROCESSOR               PIC X(4).
  2498         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2499             20  CF-STATE-CODE              PIC XX.
  2500             20  FILLER                     PIC XX.
  2501         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2502             20  FILLER                     PIC XX.
  2503             20  CF-HI-BEN-IN-REC           PIC XX.
  2504         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2505             20  FILLER                     PIC XXX.
  2506             20  CF-CARRIER-CNTL            PIC X.
  2507         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2508             20  FILLER                     PIC XX.
  2509             20  CF-HI-TYPE-IN-REC          PIC 99.
  2510         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2511             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2512                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2513             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2514             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2515         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2516             20  FILLER                     PIC X.
  2517             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2518         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2519             20  FILLER                     PIC XX.
  2520             20  CF-MORTGAGE-PLAN           PIC XX.
  2521         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2522
  2523     12  CF-LAST-MAINT-DT                   PIC XX.
  2524     12  CF-LAST-MAINT-BY                   PIC X(4).
  2525     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2526
  2527     12  CF-RECORD-BODY                     PIC X(728).
  2528
  2529
  2530****************************************************************
  2531*             COMPANY MASTER RECORD                            *
  2532****************************************************************
  2533
  2534     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2535         16  CF-COMPANY-ADDRESS.
  2536             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2537             20  CF-CL-IN-CARE-OF           PIC X(30).
  2538             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2539             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2540             20  CF-CL-CITY-STATE           PIC X(30).
  2541             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2542             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  52
* EL652.cbl
  2543         16  CF-COMPANY-CD                  PIC X.
  2544         16  CF-COMPANY-PASSWORD            PIC X(8).
  2545         16  CF-SECURITY-OPTION             PIC X.
  2546             88  ALL-SECURITY                   VALUE '1'.
  2547             88  COMPANY-VERIFY                 VALUE '2'.
  2548             88  PROCESSOR-VERIFY               VALUE '3'.
  2549             88  NO-SECURITY                    VALUE '4'.
  2550             88  ALL-BUT-TERM                   VALUE '5'.
  2551         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2552             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2553         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2554             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2555         16  CF-INFORCE-LOCATION            PIC X.
  2556             88  CERTS-ARE-ONLINE               VALUE '1'.
  2557             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2558             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2559         16  CF-LOWER-CASE-LETTERS          PIC X.
  2560         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2561             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2562             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2563             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2564             88  CF-ACCNT-CNTL                  VALUE '3'.
  2565             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2566
  2567         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2568         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2569
  2570         16  CF-LGX-CREDIT-USER             PIC X.
  2571             88  CO-IS-NOT-USER                 VALUE 'N'.
  2572             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2573
  2574         16 CF-CREDIT-CALC-CODES.
  2575             20  CF-CR-REM-TERM-CALC PIC X.
  2576               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2577               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2578               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2579               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2580               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2581               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2582               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2583             20  CF-CR-R78-METHOD           PIC X.
  2584               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2585               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2586
  2587         16  CF-CLAIM-CONTROL-COUNTS.
  2588             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2589                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2590
  2591             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2592                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2593
  2594             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2595                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2596
  2597             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2598                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2599
  2600         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  53
* EL652.cbl
  2601
  2602         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2603             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2604             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2605             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2606             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2607                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2608                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2609             20  CF-CO-PREM-REJECT-SW       PIC X.
  2610                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2611                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2612             20  CF-CO-REF-REJECT-SW        PIC X.
  2613                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2614                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2615
  2616         16  CF-CO-REPORTING-DT             PIC XX.
  2617         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2618         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2619           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2620           88  CF-CO-MONTH-END                  VALUE '1'.
  2621
  2622         16  CF-LGX-CLAIM-USER              PIC X.
  2623             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2624             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2625
  2626         16  CF-CREDIT-EDIT-CONTROLS.
  2627             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2628             20  CF-MIN-AGE                 PIC 99.
  2629             20  CF-DEFAULT-AGE             PIC 99.
  2630             20  CF-MIN-TERM                PIC S999      COMP-3.
  2631             20  CF-MAX-TERM                PIC S999      COMP-3.
  2632             20  CF-DEFAULT-SEX             PIC X.
  2633             20  CF-JOINT-AGE-INPUT         PIC X.
  2634                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2635             20  CF-BIRTH-DATE-INPUT        PIC X.
  2636                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2637             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2638                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2639                 88  CF-ZERO-CARRIER            VALUE '1'.
  2640                 88  CF-ZERO-GROUPING           VALUE '2'.
  2641                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2642             20  CF-EDIT-SW                 PIC X.
  2643                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2644             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2645             20  CF-CR-PR-METHOD            PIC X.
  2646               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2647               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2648             20  FILLER                     PIC X.
  2649
  2650         16  CF-CREDIT-MISC-CONTROLS.
  2651             20  CF-REIN-TABLE-SW           PIC X.
  2652                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2653             20  CF-COMP-TABLE-SW           PIC X.
  2654                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2655             20  CF-EXPERIENCE-RETENTION-AGE
  2656                                            PIC S9        COMP-3.
  2657             20  CF-CONVERSION-DT           PIC XX.
  2658             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  54
* EL652.cbl
  2659             20  CF-RUN-FREQUENCY-SW        PIC X.
  2660                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2661                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2662
  2663             20  CF-CR-CHECK-NO-CONTROL.
  2664                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2665                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2666                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2667                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2668                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2669                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2670
  2671                 24  CF-CR-CHECK-COUNT       REDEFINES
  2672                     CF-CR-CHECK-COUNTER      PIC X(4).
  2673
  2674                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2675                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2676
  2677                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2678                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2679                 24  CF-MAIL-PROCESSING       PIC X.
  2680                     88  MAIL-PROCESSING          VALUE 'Y'.
  2681
  2682         16  CF-MISC-SYSTEM-CONTROL.
  2683             20  CF-SYSTEM-C                 PIC X.
  2684                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2685             20  CF-SYSTEM-D                 PIC X.
  2686                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2687             20  CF-SOC-SEC-NO-SW            PIC X.
  2688                 88  SOC-SEC-NO-USED             VALUE '1'.
  2689             20  CF-MEMBER-NO-SW             PIC X.
  2690                 88  MEMBER-NO-USED              VALUE '1'.
  2691             20  CF-TAX-ID-NUMBER            PIC X(11).
  2692             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2693             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2694                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2695                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2696                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2697                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2698             20  CF-SYSTEM-E                 PIC X.
  2699                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2700
  2701         16  CF-LGX-LIFE-USER               PIC X.
  2702             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2703             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2704
  2705         16  CF-CR-MONTH-END-DT             PIC XX.
  2706
  2707         16  CF-FILE-MAINT-DATES.
  2708             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2709                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2710             20  CF-LAST-BATCH       REDEFINES
  2711                 CF-LAST-BATCH-NO               PIC X(4).
  2712             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2713             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2714             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2715             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2716             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  55
* EL652.cbl
  2717             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2718             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2719             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2720             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2721             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2722
  2723         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2724         16  FILLER                         PIC X.
  2725
  2726         16  CF-ALT-MORT-CODE               PIC X(4).
  2727         16  CF-MEMBER-CAPTION              PIC X(10).
  2728
  2729         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2730             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2731             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2732             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2733             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2734             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2735
  2736         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2737
  2738         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2739         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2740         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2741         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2742
  2743         16  CF-AH-OVERRIDE-L1              PIC X.
  2744         16  CF-AH-OVERRIDE-L2              PIC XX.
  2745         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2746         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2747
  2748         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2749         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2750
  2751         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2752         16  CF-AR-LAST-EL860-DT            PIC XX.
  2753         16  CF-MP-MONTH-END-DT             PIC XX.
  2754
  2755         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2756         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2757             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2758
  2759         16  CF-AR-MONTH-END-DT             PIC XX.
  2760
  2761         16  CF-CRDTCRD-USER                PIC X.
  2762             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2763             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2764
  2765         16  CF-CC-MONTH-END-DT             PIC XX.
  2766
  2767         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2768
  2769         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2770             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2771             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2772             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2773         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2774         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  56
* EL652.cbl
  2775         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2776         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2777             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2778             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2779         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2780         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2781         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2782             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2783         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2784
  2785         16  CF-CL-ZIP-CODE.
  2786             20  CF-CL-ZIP-PRIME.
  2787                 24  CF-CL-ZIP-1ST          PIC X.
  2788                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2789                 24  FILLER                 PIC X(4).
  2790             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2791         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2792             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2793             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2794             20  FILLER                     PIC XXX.
  2795
  2796         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2797         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2798         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2799         16  CF-CO-OPTION-START-DATE        PIC XX.
  2800         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2801           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2802                                                      '3' '4'.
  2803           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2804           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2805           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2806           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2807           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2808           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2809
  2810         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2811
  2812         16  CF-PAYMENT-APPROVAL-LEVELS.
  2813             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2814             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2815             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2816             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2817             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2818             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2819
  2820         16  CF-END-USER-REPORTING-USER     PIC X.
  2821             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2822             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2823
  2824         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2825             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2826             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2827
  2828         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2829
  2830         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2831         16  FILLER                         PIC X.
  2832
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  57
* EL652.cbl
  2833         16  CF-CREDIT-ARCHIVE-CNTL.
  2834             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2835             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2836             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2837
  2838         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2839
  2840         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2841             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2842             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2843
  2844         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2845             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2846             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2847
  2848         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2849
  2850         16  CF-CO-ACH-ID-CODE              PIC  X.
  2851             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2852             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2853             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2854         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2855         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2856         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2857         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2858         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2859         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2860         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2861         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2862         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2863                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2864         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2865                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2866
  2867         16  CF-CO-OVER-SHORT.
  2868             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2869             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2870
  2871*         16  FILLER                         PIC X(102).
  2872         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2873             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2874             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2875
  2876         16  CF-AH-APPROVAL-DAYS.
  2877             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2878             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2879             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2880             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2881
  2882         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2883
  2884         16  CF-APPROV-LEV-5.
  2885             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2886             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2887             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2888
  2889         16  FILLER                         PIC X(68).
  2890****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  58
* EL652.cbl
  2891*             PROCESSOR/USER RECORD                            *
  2892****************************************************************
  2893
  2894     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2895         16  CF-PROCESSOR-NAME              PIC X(30).
  2896         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2897         16  CF-PROCESSOR-TITLE             PIC X(26).
  2898         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2899                 88  MESSAGE-YES                VALUE 'Y'.
  2900                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2901
  2902*****************************************************
  2903****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2904****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2905****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2906****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2907*****************************************************
  2908
  2909         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2910             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2911             20  CF-APPLICATION-FORCE       PIC X.
  2912             20  CF-INDIVIDUAL-APP.
  2913                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2914                     28  CF-BROWSE-APP      PIC X.
  2915                     28  CF-UPDATE-APP      PIC X.
  2916
  2917         16  CF-CURRENT-TERM-ON             PIC X(4).
  2918         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2919             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2920             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2921             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2922             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2923             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2924             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2925             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2926         16  CF-PROCESSOR-CARRIER           PIC X.
  2927             88  NO-CARRIER-SECURITY            VALUE ' '.
  2928         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2929             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2930         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2931             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2932         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2933             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2934
  2935         16  CF-PROC-SYS-ACCESS-SW.
  2936             20  CF-PROC-CREDIT-CLAIMS-SW.
  2937                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2938                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2939                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2940                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2941             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2942                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2943                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2944             20  CF-PROC-LIFE-GNRLDGR-SW.
  2945                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2946                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2947                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2948                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  59
* EL652.cbl
  2949             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2950                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2951                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2952         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2953             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2954             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2955         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2956
  2957         16  CF-APPROVAL-LEVEL                  PIC X.
  2958             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2959             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2960             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2961             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2962             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2963
  2964         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2965
  2966         16  CF-LANGUAGE-TYPE                   PIC X.
  2967             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2968             88  CF-LANG-IS-FR                      VALUE 'F'.
  2969
  2970         16  CF-CSR-IND                         PIC X.
  2971         16  FILLER                             PIC X(239).
  2972
  2973****************************************************************
  2974*             PROCESSOR/REMINDERS RECORD                       *
  2975****************************************************************
  2976
  2977     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2978         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2979             20  CF-START-REMIND-DT         PIC XX.
  2980             20  CF-END-REMIND-DT           PIC XX.
  2981             20  CF-REMINDER-TEXT           PIC X(50).
  2982         16  FILLER                         PIC X(296).
  2983
  2984
  2985****************************************************************
  2986*             STATE MASTER RECORD                              *
  2987****************************************************************
  2988
  2989     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2990         16  CF-STATE-ABBREVIATION          PIC XX.
  2991         16  CF-STATE-NAME                  PIC X(25).
  2992         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2993         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2994             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2995             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2996             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2997             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2998                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2999                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3000             20  CF-ST-PREM-REJECT-SW       PIC X.
  3001                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3002                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3003             20  CF-ST-REF-REJECT-SW        PIC X.
  3004                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3005                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3006         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  60
* EL652.cbl
  3007         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3008         16  CF-ST-REFUND-RULES.
  3009             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3010             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3011             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3012         16  CF-ST-FST-PMT-EXTENSION.
  3013             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3014             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3015                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3016                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3017                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3018                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3019         16  CF-ST-STATE-CALL.
  3020             20  CF-ST-CALL-UNEARNED        PIC X.
  3021             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3022             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3023         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3024             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3025             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3026         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3027         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3028         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3029         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3030         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3031         16  FILLER                         PIC X.
  3032         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3033             20  CF-ST-BENEFIT-CD           PIC XX.
  3034             20  CF-ST-BENEFIT-KIND         PIC X.
  3035                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3036                 88  CF-ST-AH-KIND              VALUE 'A'.
  3037             20  CF-ST-REM-TERM-CALC        PIC X.
  3038                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3039                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3040                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3041                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3042                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3043                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3044                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3045                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3046
  3047             20  CF-ST-REFUND-CALC          PIC X.
  3048                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3049                 88  ST-REFD-BY-R78             VALUE '1'.
  3050                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3051                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3052                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3053                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3054                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3055                 88  ST-REFD-UTAH               VALUE '7'.
  3056                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3057                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3058                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3059
  3060             20  CF-ST-EARNING-CALC         PIC X.
  3061                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3062                 88  ST-EARN-BY-R78             VALUE '1'.
  3063                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3064                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  61
* EL652.cbl
  3065                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3066                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3067                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3068                 88  ST-EARN-MEAN               VALUE '8'.
  3069                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3070
  3071             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3072                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3073                 88  ST-OVRD-BY-R78             VALUE '1'.
  3074                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3075                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3076                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3077                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3078                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3079                 88  ST-OVRD-MEAN               VALUE '8'.
  3080                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3081             20  cf-st-extra-periods        pic 9.
  3082*            20  FILLER                     PIC X.
  3083
  3084         16  CF-ST-COMMISSION-CAPS.
  3085             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3086             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3087             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3088             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3089         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3090                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3091                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  3092                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  3093
  3094         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3095
  3096         16  CF-ST-STATUTORY-INTEREST.
  3097             20  CF-ST-STAT-DATE-FROM       PIC X.
  3098                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3099                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3100             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3101             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3102             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3103             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3104             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3105
  3106         16  CF-ST-OVER-SHORT.
  3107             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3108             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3109
  3110         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3111
  3112         16  CF-ST-RT-CALC                  PIC X.
  3113
  3114         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3115         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3116         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3117         16  CF-ST-RF-LR-CALC               PIC X.
  3118         16  CF-ST-RF-LL-CALC               PIC X.
  3119         16  CF-ST-RF-LN-CALC               PIC X.
  3120         16  CF-ST-RF-AH-CALC               PIC X.
  3121         16  CF-ST-RF-CP-CALC               PIC X.
  3122*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  62
* EL652.cbl
  3123*CIDMOD         16  FILLER                         PIC X(192).
  3124         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3125             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3126         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3127         16  CF-ST-VFY-2ND-BENE             PIC X.
  3128         16  CF-ST-CAUSAL-STATE             PIC X.
  3129         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3130         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3131         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3132             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3133         16  CF-ST-NET-ONLY-STATE           PIC X.
  3134             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3135         16  cf-commission-cap-required     pic x.
  3136         16  CF-ST-GA-COMMISSION-CAPS.
  3137             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  3138             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  3139             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  3140             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  3141         16  CF-ST-TOT-COMMISSION-CAPS.
  3142             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  3143             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  3144             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  3145             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  3146         16  FILLER                         PIC X(156).
  3147
  3148****************************************************************
  3149*             BENEFIT MASTER RECORD                            *
  3150****************************************************************
  3151
  3152     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3153         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3154             20  CF-BENEFIT-CODE            PIC XX.
  3155             20  CF-BENEFIT-NUMERIC  REDEFINES
  3156                 CF-BENEFIT-CODE            PIC XX.
  3157             20  CF-BENEFIT-ALPHA           PIC XXX.
  3158             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3159             20  CF-BENEFIT-COMMENT         PIC X(10).
  3160
  3161             20  CF-LF-COVERAGE-TYPE        PIC X.
  3162                 88  CF-REDUCING                VALUE 'R'.
  3163                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3164
  3165             20  CF-SPECIAL-CALC-CD         PIC X.
  3166                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3167                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3168                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3169                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3170                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3171                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3172                 88  CF-FARM-PLAN               VALUE 'F'.
  3173                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3174                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3175                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3176                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3177                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3178                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3179                 88  CF-PRUDENTIAL              VALUE 'P'.
  3180                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  63
* EL652.cbl
  3181                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3182                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3183                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3184                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3185                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3186
  3187             20  CF-JOINT-INDICATOR         PIC X.
  3188                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3189
  3190*            20  FILLER                     PIC X(12).
  3191             20  cf-maximum-benefits        pic s999 comp-3.
  3192             20  FILLER                     PIC X(09).
  3193             20  CF-BENEFIT-CATEGORY        PIC X.
  3194             20  CF-LOAN-TYPE               PIC X(8).
  3195
  3196             20  CF-CO-REM-TERM-CALC        PIC X.
  3197                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3198                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3199                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3200                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3201                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3202
  3203             20  CF-CO-EARNINGS-CALC        PIC X.
  3204                 88  CO-EARN-BY-R78             VALUE '1'.
  3205                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3206                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3207                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3208                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3209                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3210                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3211                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3212
  3213             20  CF-CO-REFUND-CALC          PIC X.
  3214                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3215                 88  CO-REFD-BY-R78             VALUE '1'.
  3216                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3217                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3218                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3219                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3220                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3221                 88  CO-REFD-MEAN               VALUE '8'.
  3222                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3223                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3224                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3225
  3226             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3227                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3228                 88  CO-OVRD-BY-R78             VALUE '1'.
  3229                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3230                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3231                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3232                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3233                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3234                 88  CO-OVRD-MEAN               VALUE '8'.
  3235                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3236
  3237             20  CF-CO-BEN-I-G-CD           PIC X.
  3238                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  64
* EL652.cbl
  3239                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3240                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3241
  3242         16  FILLER                         PIC X(304).
  3243
  3244
  3245****************************************************************
  3246*             CARRIER MASTER RECORD                            *
  3247****************************************************************
  3248
  3249     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3250         16  CF-ADDRESS-DATA.
  3251             20  CF-MAIL-TO-NAME            PIC X(30).
  3252             20  CF-IN-CARE-OF              PIC X(30).
  3253             20  CF-ADDRESS-LINE-1          PIC X(30).
  3254             20  CF-ADDRESS-LINE-2          PIC X(30).
  3255             20  CF-CITY-STATE              PIC X(30).
  3256             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3257             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3258
  3259         16  CF-CLAIM-NO-CONTROL.
  3260             20  CF-CLAIM-NO-METHOD         PIC X.
  3261                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3262                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3263                 88  CLAIM-NO-SEQ               VALUE '3'.
  3264                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3265             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3266                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3267                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3268                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3269
  3270         16  CF-CHECK-NO-CONTROL.
  3271             20  CF-CHECK-NO-METHOD         PIC X.
  3272                 88  CHECK-NO-MANUAL            VALUE '1'.
  3273                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3274                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3275                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3276             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3277                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3278
  3279         16  CF-DOMICILE-STATE              PIC XX.
  3280
  3281         16  CF-EXPENSE-CONTROLS.
  3282             20  CF-EXPENSE-METHOD          PIC X.
  3283                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3284                 88  DOLLARS-PER-PMT            VALUE '2'.
  3285                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3286                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3287             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3288             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3289
  3290         16  CF-CORRESPONDENCE-CONTROL.
  3291             20  CF-LETTER-RESEND-OPT       PIC X.
  3292                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3293                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3294             20  FILLER                     PIC X(4).
  3295
  3296         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  65
* EL652.cbl
  3297             20  CF-MANUAL-SW               PIC X.
  3298                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3299             20  CF-FUTURE-SW               PIC X.
  3300                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3301             20  CF-PTC-SW                  PIC X.
  3302                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3303             20  CF-IBNR-SW                 PIC X.
  3304                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3305             20  CF-PTC-LF-SW               PIC X.
  3306                 88  CF-LF-PTC-USED             VALUE '1'.
  3307             20  CF-CDT-ACCESS-METHOD       PIC X.
  3308                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3309                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3310                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3311             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3312
  3313         16  CF-CLAIM-CALC-METHOD           PIC X.
  3314             88  360-PLUS-MONTHS                VALUE '1'.
  3315             88  365-PLUS-MONTHS                VALUE '2'.
  3316             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3317             88  360-DAILY                      VALUE '4'.
  3318             88  365-DAILY                      VALUE '5'.
  3319
  3320         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3321         16  FILLER                         PIC X(11).
  3322
  3323         16  CF-LIMIT-AMOUNTS.
  3324             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3325             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3326             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3327             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3328             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3329             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3330             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3331             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3332             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3333             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3334
  3335         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3336         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3337         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3338
  3339         16  CF-ZIP-CODE.
  3340             20  CF-ZIP-PRIME.
  3341                 24  CF-ZIP-1ST             PIC X.
  3342                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3343                 24  FILLER                 PIC X(4).
  3344             20  CF-ZIP-PLUS4               PIC X(4).
  3345         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3346             20  CF-CAN-POSTAL-1            PIC XXX.
  3347             20  CF-CAN-POSTAL-2            PIC XXX.
  3348             20  FILLER                     PIC XXX.
  3349
  3350         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3351         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3352         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3353
  3354         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  66
* EL652.cbl
  3355             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3356             88  CF-NO-RATING                   VALUE 'N'.
  3357
  3358         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3359
  3360         16  CF-CARRIER-OVER-SHORT.
  3361             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3362             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3363
  3364         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3365         16  CF-SECPAY-SWITCH               PIC X.
  3366             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3367             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3368         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3369         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3370         16  FILLER                         PIC X(444).
  3371*        16  FILLER                         PIC X(452).
  3372
  3373
  3374****************************************************************
  3375*             MORTALITY MASTER RECORD                          *
  3376****************************************************************
  3377
  3378     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3379         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3380                                INDEXED BY CF-MORT-NDX.
  3381             20  CF-MORT-TABLE              PIC X(5).
  3382             20  CF-MORT-TABLE-TYPE         PIC X.
  3383                 88  CF-MORT-JOINT              VALUE 'J'.
  3384                 88  CF-MORT-SINGLE             VALUE 'S'.
  3385                 88  CF-MORT-COMBINED           VALUE 'C'.
  3386                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3387                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3388             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3389             20  CF-MORT-AGE-METHOD         PIC XX.
  3390                 88  CF-AGE-LAST                VALUE 'AL'.
  3391                 88  CF-AGE-NEAR                VALUE 'AN'.
  3392             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3393             20  CF-MORT-ADJUSTMENT-DIRECTION
  3394                                            PIC X.
  3395                 88  CF-MINUS                   VALUE '-'.
  3396                 88  CF-PLUS                    VALUE '+'.
  3397             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3398             20  CF-MORT-JOINT-CODE         PIC X.
  3399                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3400             20  CF-MORT-PC-Q               PIC X.
  3401                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3402             20  CF-MORT-TABLE-CODE         PIC X(4).
  3403             20  CF-MORT-COMMENTS           PIC X(15).
  3404             20  FILLER                     PIC X(14).
  3405
  3406         16  FILLER                         PIC X(251).
  3407
  3408
  3409****************************************************************
  3410*             BUSSINESS TYPE MASTER RECORD                     *
  3411****************************************************************
  3412
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  67
* EL652.cbl
  3413     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3414* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3415* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3416* AND RECORD 05 IS TYPES 81-99
  3417         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3418             20  CF-BUSINESS-TITLE          PIC  X(19).
  3419             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3420                                            PIC S9V9(4) COMP-3.
  3421             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3422             20  FILLER                     PIC  X.
  3423         16  FILLER                         PIC  X(248).
  3424
  3425
  3426****************************************************************
  3427*             TERMINAL MASTER RECORD                           *
  3428****************************************************************
  3429
  3430     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3431
  3432         16  CF-COMPANY-TERMINALS.
  3433             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3434                                  PIC X(4).
  3435         16  FILLER               PIC X(248).
  3436
  3437
  3438****************************************************************
  3439*             LIFE EDIT MASTER RECORD                          *
  3440****************************************************************
  3441
  3442     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3443         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3444             20  CF-LIFE-CODE-IN            PIC XX.
  3445             20  CF-LIFE-CODE-OUT           PIC XX.
  3446         16  FILLER                         PIC X(248).
  3447
  3448
  3449****************************************************************
  3450*             AH EDIT MASTER RECORD                            *
  3451****************************************************************
  3452
  3453     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3454         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3455             20  CF-AH-CODE-IN              PIC XXX.
  3456             20  CF-AH-CODE-OUT             PIC XX.
  3457         16  FILLER                         PIC X(248).
  3458
  3459
  3460****************************************************************
  3461*             CREDIBILITY TABLES                               *
  3462****************************************************************
  3463
  3464     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3465         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3466                             INDEXED BY CF-CRDB-NDX.
  3467             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3468             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3469             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3470         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  68
* EL652.cbl
  3471
  3472
  3473****************************************************************
  3474*             REPORT CUSTOMIZATION RECORD                      *
  3475****************************************************************
  3476
  3477     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3478         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3479             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3480             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3481             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3482**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3483****       A T-TRANSFER.                                   ****
  3484             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3485
  3486         16  FILLER                         PIC XX.
  3487
  3488         16  CF-CARRIER-CNTL-OPT.
  3489             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3490                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3491                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3492             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3493                                            PIC X.
  3494         16  CF-GROUP-CNTL-OPT.
  3495             20  CF-GROUP-OPT-SEQ           PIC 9.
  3496                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3497                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3498             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3499                                            PIC X(6).
  3500         16  CF-STATE-CNTL-OPT.
  3501             20  CF-STATE-OPT-SEQ           PIC 9.
  3502                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3503                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3504             20  CF-STATE-SELECT OCCURS 3 TIMES
  3505                                            PIC XX.
  3506         16  CF-ACCOUNT-CNTL-OPT.
  3507             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3508                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3509                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3510             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3511                                            PIC X(10).
  3512         16  CF-BUS-TYP-CNTL-OPT.
  3513             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3514                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3515                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3516             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3517                                            PIC XX.
  3518         16  CF-LF-TYP-CNTL-OPT.
  3519             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3520                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3521                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3522             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3523                                            PIC XX.
  3524         16  CF-AH-TYP-CNTL-OPT.
  3525             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3526                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3527                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3528             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  69
* EL652.cbl
  3529                                            PIC XX.
  3530         16  CF-REPTCD1-CNTL-OPT.
  3531             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3532                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3533                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3534             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3535                                            PIC X(10).
  3536         16  CF-REPTCD2-CNTL-OPT.
  3537             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3538                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3539                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3540             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3541                                            PIC X(10).
  3542         16  CF-USER1-CNTL-OPT.
  3543             20  CF-USER1-OPT-SEQ           PIC 9.
  3544                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3545                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3546             20  CF-USER1-SELECT OCCURS 3 TIMES
  3547                                            PIC X(10).
  3548         16  CF-USER2-CNTL-OPT.
  3549             20  CF-USER2-OPT-SEQ           PIC 9.
  3550                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3551                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3552             20  CF-USER2-SELECT OCCURS 3 TIMES
  3553                                            PIC X(10).
  3554         16  CF-USER3-CNTL-OPT.
  3555             20  CF-USER3-OPT-SEQ           PIC 9.
  3556                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3557                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3558             20  CF-USER3-SELECT OCCURS 3 TIMES
  3559                                            PIC X(10).
  3560         16  CF-USER4-CNTL-OPT.
  3561             20  CF-USER4-OPT-SEQ           PIC 9.
  3562                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3563                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3564             20  CF-USER4-SELECT OCCURS 3 TIMES
  3565                                            PIC X(10).
  3566         16  CF-USER5-CNTL-OPT.
  3567             20  CF-USER5-OPT-SEQ           PIC 9.
  3568                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3569                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3570             20  CF-USER5-SELECT OCCURS 3 TIMES
  3571                                            PIC X(10).
  3572         16  CF-REINS-CNTL-OPT.
  3573             20  CF-REINS-OPT-SEQ           PIC 9.
  3574                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3575                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3576             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3577                 24  CF-REINS-PRIME         PIC XXX.
  3578                 24  CF-REINS-SUB           PIC XXX.
  3579
  3580         16  CF-AGENT-CNTL-OPT.
  3581             20  CF-AGENT-OPT-SEQ           PIC 9.
  3582                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3583                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3584             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3585                                            PIC X(10).
  3586
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  70
* EL652.cbl
  3587         16  FILLER                         PIC X(43).
  3588
  3589         16  CF-LOSS-RATIO-SELECT.
  3590             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3591             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3592         16  CF-ENTRY-DATE-SELECT.
  3593             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3594             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3595         16  CF-EFFECTIVE-DATE-SELECT.
  3596             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3597             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3598
  3599         16  CF-EXCEPTION-LIST-IND          PIC X.
  3600             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3601
  3602         16  FILLER                         PIC X(318).
  3603
  3604****************************************************************
  3605*                  EXCEPTION REPORTING RECORD                  *
  3606****************************************************************
  3607
  3608     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3609         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3610             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3611
  3612         16  CF-COMBINED-LIFE-AH-OPT.
  3613             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3614             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3615             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3616             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3617
  3618         16  CF-LIFE-OPT.
  3619             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3620             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3621             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3622             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3623             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3624             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3625             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3626             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3627             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3628             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3629
  3630         16  CF-AH-OPT.
  3631             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3632             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3633             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3634             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3635             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3636             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3637             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3638             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3639             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3640             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3641
  3642         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3643             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3644             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  71
* EL652.cbl
  3645             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3646
  3647         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3648
  3649         16  FILLER                         PIC X(673).
  3650
  3651
  3652****************************************************************
  3653*             MORTGAGE SYSTEM PLAN RECORD                      *
  3654****************************************************************
  3655
  3656     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3657         16  CF-PLAN-TYPE                   PIC X.
  3658             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3659             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3660             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3661         16  CF-PLAN-ABBREV                 PIC XXX.
  3662         16  CF-PLAN-DESCRIPT               PIC X(10).
  3663         16  CF-PLAN-NOTES                  PIC X(20).
  3664         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3665         16  CF-PLAN-UNDERWRITING.
  3666             20  CF-PLAN-TERM-DATA.
  3667                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3668                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3669             20  CF-PLAN-AGE-DATA.
  3670                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3671                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3672                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3673             20  CF-PLAN-BENEFIT-DATA.
  3674                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3675                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3676                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3677                                            PIC S9(7)V99  COMP-3.
  3678         16  CF-PLAN-POLICY-FORMS.
  3679             20  CF-POLICY-FORM             PIC X(12).
  3680             20  CF-MASTER-APPLICATION      PIC X(12).
  3681             20  CF-MASTER-POLICY           PIC X(12).
  3682         16  CF-PLAN-RATING.
  3683             20  CF-RATE-CODE               PIC X(5).
  3684             20  CF-SEX-RATING              PIC X.
  3685                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3686                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3687             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3688             20  CF-SUB-STD-TYPE            PIC X.
  3689                 88  CF-PCT-OF-PREM            VALUE '1'.
  3690                 88  CF-PCT-OF-BENE            VALUE '2'.
  3691         16  CF-PLAN-PREM-TOLERANCES.
  3692             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3693             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3694         16  CF-PLAN-PYMT-TOLERANCES.
  3695             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3696             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3697         16  CF-PLAN-MISC-DATA.
  3698             20  FILLER                     PIC X.
  3699             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3700             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3701         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3702         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  72
* EL652.cbl
  3703             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3704                                                     '1'.
  3705             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3706                                                     '2'.
  3707         16  CF-MIB-SEARCH-SW               PIC X.
  3708             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3709             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3710             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3711             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3712         16  CF-ALPHA-SEARCH-SW             PIC X.
  3713             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3714             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3715             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3716             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3717             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3718             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3719             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3720             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3721             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3722             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3723                                                     'A' 'B' 'C'
  3724                                                     'X' 'Y' 'Z'.
  3725         16  CF-EFF-DT-RULE-SW              PIC X.
  3726             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3727             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3728             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3729             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3730             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3731         16  FILLER                         PIC X(4).
  3732         16  CF-HEALTH-QUESTIONS            PIC X.
  3733             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3734         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3735         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3736         16  CF-PLAN-SNGL-JNT               PIC X.
  3737             88  CF-COMBINED-PLAN              VALUE 'C'.
  3738             88  CF-JNT-PLAN                   VALUE 'J'.
  3739             88  CF-SNGL-PLAN                  VALUE 'S'.
  3740         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3741         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3742         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3743         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3744         16  CF-RERATE-CNTL                 PIC  X.
  3745             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3746             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3747             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3748             88  CF-AUTO-RECALC                 VALUE '4'.
  3749         16  CF-BENEFIT-TYPE                PIC  X.
  3750             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3751             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3752         16  CF-POLICY-FEE                  PIC S999V99
  3753                                                    COMP-3.
  3754         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3755         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3756         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3757         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3758         16  FILLER                         PIC  X(32).
  3759         16  CF-TERMINATION-FORM            PIC  X(04).
  3760         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  73
* EL652.cbl
  3761         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3762                                                       COMP-3.
  3763         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3764         16  CF-ISSUE-LETTER                PIC  X(4).
  3765         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3766         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3767             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3768             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3769         16  CF-MP-REFUND-CALC              PIC X.
  3770             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3771             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3772             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3773             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3774             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3775             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3776             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3777             88  CF-MP-REFD-MEAN                VALUE '8'.
  3778         16  CF-ALT-RATE-CODE               PIC  X(5).
  3779
  3780
  3781         16  FILLER                         PIC X(498).
  3782****************************************************************
  3783*             MORTGAGE COMPANY MASTER RECORD                   *
  3784****************************************************************
  3785
  3786     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3787         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3788         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3789             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3790             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3791             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3792             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3793             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3794
  3795         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3796         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3797         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3798         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3799         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3800
  3801         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3802             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3803         16  CF-MP-RECON-USE-IND            PIC X(1).
  3804             88  CF-MP-USE-RECON             VALUE 'Y'.
  3805         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3806             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3807         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3808             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3809             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3810         16  FILLER                         PIC X(1).
  3811         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3812             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3813         16  CF-MORTG-MIB-VERSION           PIC X.
  3814             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3815             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3816             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3817         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3818             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  74
* EL652.cbl
  3819                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3820             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3821                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3822             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3823                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3824             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3825                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3826             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3827                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3828             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3829                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3830         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3831         16  FILLER                         PIC X(7).
  3832         16  CF-MORTG-DESTINATION-SYMBOL.
  3833             20  CF-MORTG-MIB-COMM          PIC X(5).
  3834             20  CF-MORTG-MIB-TERM          PIC X(5).
  3835         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3836             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3837         16  FILLER                         PIC X(03).
  3838         16  CF-MP-CHECK-NO-CONTROL.
  3839             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3840                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3841                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3842                                                ' ' LOW-VALUES.
  3843                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3844                                               VALUE '3'.
  3845         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3846         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3847         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3848             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3849                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3850             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3851                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3852             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3853                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3854             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3855                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3856             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3857                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3858             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3859                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3860         16  CF-MORTG-BILLING-AREA.
  3861             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3862                                            PIC X.
  3863         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3864         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3865         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3866         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3867             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3868             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3869         16  FILLER                         PIC X.
  3870         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3871             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3872             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3873         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3874         16  FILLER                         PIC X(8).
  3875         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3876         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  75
* EL652.cbl
  3877         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3878         16  CF-ACH-COMPANY-ID.
  3879             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3880                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3881                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3882                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3883             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3884         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3885             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3886         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3887             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3888             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3889         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3890         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3891         16  FILLER                         PIC X(536).
  3892
  3893****************************************************************
  3894*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3895****************************************************************
  3896
  3897     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3898         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3899             20  CF-FEMALE-HEIGHT.
  3900                 24  CF-FEMALE-FT           PIC 99.
  3901                 24  CF-FEMALE-IN           PIC 99.
  3902             20  CF-FEMALE-MIN-WT           PIC 999.
  3903             20  CF-FEMALE-MAX-WT           PIC 999.
  3904         16  FILLER                         PIC X(428).
  3905
  3906     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3907         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3908             20  CF-MALE-HEIGHT.
  3909                 24  CF-MALE-FT             PIC 99.
  3910                 24  CF-MALE-IN             PIC 99.
  3911             20  CF-MALE-MIN-WT             PIC 999.
  3912             20  CF-MALE-MAX-WT             PIC 999.
  3913         16  FILLER                         PIC X(428).
  3914******************************************************************
  3915*             AUTOMATIC ACTIVITY RECORD                          *
  3916******************************************************************
  3917     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3918         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3919             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3920             20  CF-SYS-LETTER-ID           PIC X(04).
  3921             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3922             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3923             20  CF-SYS-RESET-SW            PIC X(01).
  3924             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3925             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3926
  3927         16  FILLER                         PIC X(50).
  3928
  3929         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3930             20  CF-USER-ACTIVE-SW          PIC X(01).
  3931             20  CF-USER-LETTER-ID          PIC X(04).
  3932             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3933             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3934             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  76
* EL652.cbl
  3935             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3936             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3937             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3938
  3939         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  77
* EL652.cbl
  3941*                            COPY ERCSUMM.
  3942******************************************************************
  3943*                                                                *
  3944*                                                                *
  3945*                            ERCSUMM                             *
  3946*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3947*                            VMOD=2.002                          *
  3948*                                                                *
  3949*   ONLINE CREDIT SYSTEM                                         *
  3950*                                                                *
  3951*   FILE DESCRIPTION = AR SUMMARY CROSS REFERENCE                *
  3952*                                                                *
  3953*   FILE TYPE = VSAM,KSDS                                        *
  3954*   RECORD SIZE = 150           RECFORM = FIXED                  *
  3955*                                                                *
  3956*   BASE CLUSTER NAME = ERSUMM                   RKP=2,LEN=34    *
  3957*                                                                *
  3958*       ALTERNATE PATH1 = ERSUMM2  (BY CO SUMMARY CARR           *
  3959*                                      GROUP F.R. AGENT)         *
  3960*                                                 RKP=36 ,LEN=34 *
  3961*                                                                *
  3962*   LOG = NO                                                     *
  3963*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3964*                                                                *
  3965******************************************************************
  3966
  3967 01  SUMM-CROSS-REFERENCE.
  3968     12  SX-RECORD-ID                PIC XX.
  3969         88  VALID-SX-ID             VALUE 'SX'.
  3970
  3971     12  SX-CONTROL-PRIMARY.
  3972         16  SX-COMPANY-CD           PIC X.
  3973         16  SX-SUMMARY              PIC X(6).
  3974         16  SX-CARRIER              PIC X.
  3975         16  SX-GROUP                PIC X(6).
  3976         16  SX-FIN-RESP             PIC X(10).
  3977         16  SX-ACCT-AGENT           PIC X(10).
  3978
  3979     12  SX-CONTROL-A1.
  3980         16  SX-COMPANY-A1           PIC X.
  3981         16  SX-ACCT-AGENT-A1        PIC X(10).
  3982         16  SX-SUMMARY-A1           PIC X(6).
  3983         16  SX-CARR-A1              PIC X.
  3984         16  SX-GROUP-A1             PIC X(6).
  3985         16  SX-FIN-RESP-A1          PIC X(10).
  3986
  3987     12  SX-MAINT-INFORMATION.
  3988         16  SX-LAST-MAINT-DT        PIC XX.
  3989         16  SX-LAST-MAINT-BY        PIC X(4).
  3990         16  SX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  3991
  3992     12  SX-SUMM-OR-AGT-NAME         PIC X(30).
  3993
  3994     12  FILLER                      PIC X(40).
  3995
  3996******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  78
* EL652.cbl
  3998*                            COPY ERCRQST.
  3999******************************************************************
  4000*                                                                *
  4001*                                                                *
  4002*                            ERCRQST.                            *
  4003*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4004*                            VMOD=2.002                          *
  4005*                                                                *
  4006*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  4007*                                                                *
  4008*   FILE TYPE = VSAM,KSDS                                        *
  4009*   RECORD SIZE = 200  RECFORM = FIXED                           *
  4010*                                                                *
  4011*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  4012*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  4013*                                   ACCOUNT, REF, BATCH)         *
  4014*                                                RKP=9, LEN=38   *
  4015*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  4016*                                   ACCOUNT, REF, BATCH)         *
  4017*                                                RKP=47, LEN=46  *
  4018*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  4019*                                   BATCH)                       *
  4020*                                                RKP=93, LEN=24  *
  4021*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  4022*                                   REF, BATCH)                  *
  4023*                                                RKP=117, LEN=35 *
  4024*   LOG = NO                                                     *
  4025*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4026******************************************************************
  4027
  4028 01  AR-REQUEST-RECORD.
  4029     12  RQ-RECORD-ID                     PIC XX.
  4030         88  VALID-RQ-ID                        VALUE 'RQ'.
  4031
  4032     12  RQ-CONTROL-PRIMARY.
  4033         16  RQ-COMPANY-CD                PIC X.
  4034         16  RQ-ENTRY-BATCH               PIC X(6).
  4035
  4036     12  RQ-CONTROL-BY-ACCT-REF.
  4037         16  RQ-COMPANY-CD-A1             PIC X.
  4038         16  RQ-CARRIER-A1                PIC X.
  4039         16  RQ-GROUPING-A1               PIC X(6).
  4040         16  RQ-STATE-A1                  PIC XX.
  4041         16  RQ-ACCOUNT-A1                PIC X(10).
  4042         16  RQ-REFERENCE-A1              PIC X(12).
  4043         16  RQ-BATCH-A1                  PIC X(6).
  4044
  4045     12  RQ-CONTROL-BY-FIN-RESP.
  4046         16  RQ-COMPANY-CD-A2             PIC X.
  4047         16  RQ-CARRIER-A2                PIC X.
  4048         16  RQ-GROUPING-A2               PIC X(6).
  4049         16  RQ-FIN-RESP-A2               PIC X(10).
  4050         16  RQ-ACCT-AGENT-A2             PIC X(10).
  4051         16  RQ-REFERENCE-A2              PIC X(12).
  4052         16  RQ-BATCH-A2                  PIC X(6).
  4053
  4054     12  RQ-CONTROL-BY-ACCT-AGENT.
  4055         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  79
* EL652.cbl
  4056         16  RQ-CARRIER-A3                PIC X.
  4057         16  RQ-GROUPING-A3               PIC X(6).
  4058         16  RQ-ACCT-AGENT-A3             PIC X(10).
  4059         16  RQ-BATCH-A3                  PIC X(6).
  4060
  4061     12  RQ-CONTROL-BY-SUMMARY.
  4062         16  RQ-COMPANY-CD-A4             PIC X.
  4063         16  RQ-SUMMARY-CODE              PIC X(6).
  4064         16  RQ-ACCOUNT-A4                PIC X(10).
  4065         16  RQ-REFERENCE-A4              PIC X(12).
  4066         16  RQ-BATCH-A4                  PIC X(6).
  4067
  4068     12  RQ-REQUEST-METHOD                PIC X.
  4069         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  4070         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  4071         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  4072         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  4073     12  FILLER                           PIC X.
  4074     12  RQ-STATUS                        PIC X.
  4075         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  4076         88  RQ-RESUBMIT                      VALUE 'R'.
  4077     12  RQ-PROCESSOR-ID                  PIC X(4).
  4078     12  RQ-ENTRY-DT                      PIC XX.
  4079     12  RQ-MO-END-DT                     PIC XX.
  4080     12  RQ-REQUEST-DT                    PIC XX.
  4081     12  RQ-STMT-DT                       PIC XX.
  4082     12  RQ-REVERSAL-DT                   PIC XX.
  4083     12  RQ-CREDIT-SELECT-DT              PIC XX.
  4084     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  4085
  4086     12  FILLER                           PIC X(27).
  4087
  4088******************************************************************
  4089
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  80
* EL652.cbl
  4091 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  4092                          COMPENSATION-MASTER AGENT-COMMISSIONS
  4093                          NAME-LOOKUP-MASTER CONTROL-FILE
  4094                          SUMM-CROSS-REFERENCE
  4095                          AR-REQUEST-RECORD.
  4096 0000-DFHEXIT SECTION.
  4097     MOVE '9#                    $   ' TO DFHEIV0.
  4098     MOVE 'EL652' TO DFHEIV1.
  4099     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4100
  4101     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4102     MOVE '5'                    TO  DC-OPTION-CODE.
  4103     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  4104     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4105     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4106
  4107     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  4108     MOVE EIBTRMID               TO  QID-TERM.
  4109
  4110 1000-START.
  4111     IF EIBCALEN = ZERO
  4112         GO TO 8800-UNAUTHORIZED-ACCESS.
  4113
  4114     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  4115         MOVE PI-CALLING-PROGRAM        TO  RETURNED-FROM.
  4116
  4117     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  4118         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  4119             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  4120             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  4121             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  4122             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  4123             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  4124             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  4125             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  4126             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  4127             PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  4128         ELSE
  4129             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  4130             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  4131             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  4132             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  4133             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  4134             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  4135             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  4136             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  4137
  4138     IF  RETURNED-FROM = XCTL-633
  4139             OR
  4140         RETURNED-FROM = XCTL-633DMD
  4141             OR
  4142         RETURNED-FROM = XCTL-635
  4143             OR
  4144         RETURNED-FROM = XCTL-6521
  4145             OR
  4146         RETURNED-FROM = XCTL-6522
  4147             OR
  4148         RETURNED-FROM = XCTL-6523
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  81
* EL652.cbl
  4149             OR
  4150         RETURNED-FROM = XCTL-6524
  4151             OR
  4152         RETURNED-FROM = XCTL-689
  4153             OR
  4154         RETURNED-FROM = XCTL-690
  4155             OR
  4156         RETURNED-FROM = XCTL-650
  4157         GO TO 3475-RECOVER-TEMP-STOR-PI.
  4158
  4159
  4160* EXEC CICS HANDLE CONDITION
  4161*        NOTOPEN   (9990-ABEND)
  4162*        NOTFND    (8880-NOT-FOUND)
  4163*        PGMIDERR  (9600-PGMID-ERROR)
  4164*        ERROR     (9990-ABEND)
  4165*    END-EXEC.
  4166*    MOVE '"$JIL.                ! " #00004155' TO DFHEIV0
  4167     MOVE X'22244A494C2E202020202020' TO DFHEIV0(1:12)
  4168     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4169     MOVE X'2220233030303034313535' TO DFHEIV0(25:11)
  4170     CALL 'kxdfhei1' USING DFHEIV0
  4171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4172
  4173
  4174     IF  EIBTRNID NOT = TRANS-ID
  4175         MOVE LOW-VALUES         TO  EL652AI
  4176         IF  EIBTRNID = EM6508-TRANS-ID
  4177             MOVE DFHENTER       TO  EIBAID
  4178             MOVE 'S'            TO  MAINTYPI
  4179             MOVE PI-CARRIER     TO  CARRIERI
  4180             MOVE PI-GROUPING    TO  GROUPI
  4181             MOVE 'A'            TO  TYPEI
  4182             MOVE PI-CR-FIN-RESP TO  FINRESPI
  4183             MOVE PI-CR-ACCOUNT  TO  ACCTNOI
  4184             MOVE 1              TO  CARRIERL TYPEL MAINTYPL
  4185             MOVE 6              TO  GROUPL
  4186             MOVE 10             TO  FINRESPL  ACCTNOL
  4187             GO TO 4000-EDIT-MAINT
  4188         ELSE
  4189             IF  (EIBTRNID NOT = EL640-TRANS-ID AND
  4190                                 EL633-TRANS-ID AND
  4191                                 EL633DMD-TRANS-ID AND
  4192                                 EL635-TRANS-ID AND
  4193                                 EL642-TRANS-ID AND
  4194                                 EL6501-TRANS-ID AND
  4195                                 EL6592-TRANS-ID AND
  4196                                 EL856-TRANS-ID)
  4197                 OR PI-CR-FIN-RESP = SPACES
  4198                 GO TO 8100-SEND-INITIAL-MAP
  4199             ELSE
  4200                 MOVE DFHENTER   TO  EIBAID
  4201                 MOVE 'S'        TO  MAINTYPI
  4202                 MOVE PI-CR-CARRIER  TO  CARRIERI
  4203                 MOVE PI-CR-GROUPING TO  GROUPI
  4204                 MOVE PI-CR-TYPE     TO  TYPEI
  4205                 MOVE PI-CR-FIN-RESP TO  FINRESPI
  4206                 MOVE PI-CR-ACCOUNT  TO  ACCTNOI
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  82
* EL652.cbl
  4207                 MOVE 1              TO  CARRIERL
  4208                                         TYPEL
  4209                                         MAINTYPL
  4210                 MOVE 6              TO  GROUPL
  4211                 MOVE 10             TO  FINRESPL
  4212                                         ACCTNOL
  4213                 GO TO 4000-EDIT-MAINT.
  4214
  4215     IF  EIBAID = DFHCLEAR
  4216             OR
  4217         NOT DISPLAY-CAP
  4218         GO TO 9400-CLEAR.
  4219
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  83
* EL652.cbl
  4221 2000-RECEIVE.
  4222     MOVE LOW-VALUES             TO  EL652AI.
  4223
  4224     IF EIBAID = DFHPA1 OR  DFHPA2  OR  DFHPA3
  4225         MOVE ER-0008            TO  EMI-ERROR
  4226         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4227         MOVE -1                 TO  MAINTYPL
  4228         GO TO 8200-SEND-DATAONLY.
  4229
  4230
  4231* EXEC CICS RECEIVE
  4232*        MAP     (MAP-NAME)
  4233*        MAPSET  (MAPSET-NAME)
  4234*        INTO    (EL652AI)
  4235*    END-EXEC.
  4236     MOVE LENGTH OF
  4237      EL652AI
  4238       TO DFHEIV11
  4239*    MOVE '8"T I  L              ''   #00004218' TO DFHEIV0
  4240     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4241     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4242     MOVE X'2020233030303034323138' TO DFHEIV0(25:11)
  4243     CALL 'kxdfhei1' USING DFHEIV0,
  4244           MAP-NAME,
  4245           EL652AI,
  4246           DFHEIV11,
  4247           MAPSET-NAME,
  4248           DFHEIV99,
  4249           DFHEIV99
  4250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4251
  4252
  4253     IF PFKEYL = ZERO
  4254         GO TO 3000-CHECK-PFKEYS.
  4255
  4256     IF EIBAID NOT = DFHENTER
  4257         MOVE ER-0004            TO EMI-ERROR
  4258         GO TO 3100-INPUT-ERROR.
  4259
  4260     IF (PFKEYI NUMERIC) AND (PFKEYI > 0 AND < 25)
  4261         MOVE PF-VALUES (PFKEYI)  TO  EIBAID
  4262     ELSE
  4263         MOVE ER-0029             TO  EMI-ERROR
  4264         GO TO 3100-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  84
* EL652.cbl
  4266 3000-CHECK-PFKEYS.
  4267     IF EIBAID = DFHPF23
  4268         GO TO 8810-PF23.
  4269
  4270     IF EIBAID = DFHPF24
  4271         GO TO 9200-RETURN-MAIN-MENU.
  4272
  4273     IF EIBAID = DFHPF12
  4274         GO TO 9500-PF12.
  4275
  4276     if (maintypl not = zeros)
  4277        and (maintypi not = 'D')
  4278        move spaces              to pi-el652-del-sw
  4279     end-if
  4280     IF EIBAID = DFHPF1
  4281         IF PI-CHECK-MAINT-TYPE = 'C' OR 'D'
  4282             MOVE 'S'            TO  MAINTYPO
  4283             MOVE AL-UANON       TO  MAINTYPA
  4284             MOVE 1              TO  MAINTYPL
  4285             GO TO 7250-PAGE-FORWARD
  4286         ELSE
  4287             GO TO 7250-PAGE-FORWARD.
  4288
  4289     IF EIBAID = DFHPF2
  4290         IF PI-CHECK-MAINT-TYPE = 'C' OR 'D'
  4291             MOVE 'S'            TO  MAINTYPO
  4292             MOVE AL-UANON       TO  MAINTYPA
  4293             MOVE 1              TO  MAINTYPL
  4294             GO TO 7300-PAGE-BACKWARD
  4295         ELSE
  4296             GO TO 7300-PAGE-BACKWARD.
  4297
  4298     IF EIBAID = DFHPF3
  4299        IF PI-AR-PROCESSING
  4300            IF PI-ERCOMP-KEY  NOT =       SPACES
  4301                MOVE PI-ERC-CARRIER TO  PI-CR-CARRIER
  4302                MOVE PI-ERC-GROUP   TO  PI-CR-GROUPING
  4303                MOVE PI-ERC-RESP    TO  PI-CR-FIN-RESP
  4304                MOVE PI-ERC-ACCT    TO  PI-CR-ACCOUNT
  4305                MOVE PI-ERC-TYPE    TO  PI-CR-TYPE
  4306                IF PI-CR-ACCOUNT =  LOW-VALUES
  4307                   MOVE 'G'         TO  PI-CR-TYPE
  4308                                        PI-ERC-TYPE
  4309                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4310                   MOVE XCTL-635    TO PGM-NAME
  4311                   GO TO 9300-XCTL
  4312                ELSE
  4313                   MOVE 'A'         TO  PI-CR-TYPE
  4314                                        PI-ERC-TYPE
  4315                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4316                   MOVE XCTL-635    TO PGM-NAME
  4317                   GO TO 9300-XCTL
  4318            ELSE
  4319                MOVE ER-3021        TO  EMI-ERROR
  4320                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4321                GO TO 8100-SEND-INITIAL-MAP
  4322        ELSE
  4323            IF PI-ERCOMP-KEY NOT = SPACES AND LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  85
* EL652.cbl
  4324                MOVE PI-ERC-CARRIER TO  PI-CR-CARRIER
  4325                MOVE PI-ERC-GROUP   TO  PI-CR-GROUPING
  4326                MOVE PI-ERC-RESP    TO  PI-CR-FIN-RESP
  4327                MOVE PI-ERC-ACCT    TO  PI-CR-ACCOUNT
  4328                MOVE PI-ERC-TYPE    TO  PI-CR-TYPE
  4329                IF PI-CR-ACCOUNT =  LOW-VALUES
  4330*                  MOVE 'G'         TO  PI-CR-TYPE
  4331*                                       PI-ERC-TYPE
  4332                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4333                   IF PI-COMPANY-ID = 'DMD'
  4334                      MOVE XCTL-633DMD TO PGM-NAME
  4335                      GO TO 9300-XCTL
  4336                   ELSE
  4337                      MOVE XCTL-633    TO PGM-NAME
  4338                      GO TO 9300-XCTL
  4339                ELSE
  4340                   MOVE 'A'         TO  PI-CR-TYPE
  4341                                        PI-ERC-TYPE
  4342                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4343                   IF PI-COMPANY-ID = 'DMD'
  4344                      MOVE XCTL-633DMD TO PGM-NAME
  4345                      GO TO 9300-XCTL
  4346                   ELSE
  4347                      MOVE XCTL-633    TO PGM-NAME
  4348                      GO TO 9300-XCTL
  4349            ELSE
  4350                MOVE ER-3021        TO  EMI-ERROR
  4351                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4352                GO TO 8100-SEND-INITIAL-MAP.
  4353
  4354     IF EIBAID = DFHPF4
  4355         IF PI-ERC-TYPE = 'G' OR 'A' OR 'B'
  4356             PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4357             MOVE XCTL-6521      TO PGM-NAME
  4358             GO TO 9300-XCTL
  4359         ELSE
  4360             MOVE ER-2872        TO  EMI-ERROR
  4361             GO TO 3100-INPUT-ERROR.
  4362
  4363     IF  EIBAID = DFHPF5
  4364         MOVE XCTL-689           TO PGM-NAME
  4365         IF  PI-ERCOMP-KEY NOT = SPACES
  4366             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4367             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4368             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
  4369             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4370             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4371
  4372             IF  PI-CR-ACCOUNT =  LOW-VALUES
  4373*                MOVE 'G'        TO PI-CR-TYPE, PI-ERC-TYPE
  4374                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4375                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
  4376                 GO TO 9300-XCTL
  4377
  4378             ELSE
  4379                 MOVE 'A'        TO PI-CR-TYPE, PI-ERC-TYPE
  4380                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4381                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  86
* EL652.cbl
  4382                 GO TO 9300-XCTL
  4383
  4384         ELSE
  4385             PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4386             MOVE LOW-VALUES     TO PI-PROGRAM-WORK-AREA
  4387             GO TO 9300-XCTL.
  4388
  4389     IF  EIBAID = DFHPF6
  4390
  4391         MOVE XCTL-690           TO PGM-NAME
  4392
  4393         IF  PI-ERCOMP-KEY NOT = SPACES
  4394             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4395             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4396             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
  4397             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4398             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4399
  4400             IF  PI-CR-ACCOUNT =  LOW-VALUES
  4401*                MOVE 'G'        TO PI-CR-TYPE, PI-ERC-TYPE
  4402                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4403                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
  4404                 GO TO 9300-XCTL
  4405
  4406             ELSE
  4407                 MOVE 'A'        TO PI-CR-TYPE, PI-ERC-TYPE
  4408                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4409                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
  4410                 GO TO 9300-XCTL
  4411
  4412         ELSE
  4413             PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4414             MOVE LOW-VALUES     TO PI-PROGRAM-WORK-AREA
  4415             GO TO 9300-XCTL.
  4416
  4417     IF EIBAID = DFHPF7
  4418         IF PI-ERC-TYPE = 'A'
  4419            MOVE PI-ERC-CARRIER  TO PI-CR-CARRIER
  4420            MOVE PI-ERC-GROUP    TO PI-CR-GROUPING
  4421            MOVE PI-ERC-ACCT     TO PI-CR-ACCOUNT
  4422*           PERFORM 3200-FIND-STATE
  4423*                                THRU 3200-EXIT
  4424            MOVE PI-SAVE-STATE   TO PI-CR-STATE
  4425            PERFORM 3400-CREATE-TS-PI
  4426                                 THRU 3400-EXIT
  4427            MOVE XCTL-650        TO PGM-NAME
  4428            GO TO 9300-XCTL
  4429         ELSE
  4430            MOVE ER-0035         TO EMI-ERROR
  4431            GO TO 3100-INPUT-ERROR
  4432         END-IF
  4433     END-IF.
  4434
  4435     IF EIBAID = DFHPF8
  4436         IF PI-ERCOMP-KEY NOT = SPACES
  4437             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4438             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4439             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  87
* EL652.cbl
  4440             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4441             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4442             PERFORM 3400-CREATE-TS-PI  THRU 3400-EXIT
  4443             MOVE XCTL-6522             TO PGM-NAME
  4444             GO TO 9300-XCTL
  4445         ELSE
  4446            MOVE ER-0187                TO EMI-ERROR
  4447            GO TO 3100-INPUT-ERROR
  4448         END-IF
  4449     END-IF.
  4450
  4451*****************************************************************
  4452*  SPECIAL CODE - ENABLES DISPLAY OF PRIOR MONTH-END TOTALS*
  4453*  PF9 AVAILABLE TO A/R USERS                                   *
  4454*****************************************************************
  4455
  4456     IF PI-AR-PROCESSING OR PI-PROCESSOR-ID = 'LGXX'
  4457         IF EIBAID = DFHPF9
  4458             MOVE 'Y'            TO  WS-SHOW-SAVE-TOTALS
  4459             GO TO 4000-EDIT-MAINT.
  4460
  4461     IF EIBAID = DFHPF10
  4462        IF PI-ERC-TYPE = 'B'
  4463         IF PI-ERCOMP-KEY NOT = SPACES
  4464             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4465             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4466             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
  4467             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4468             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4469             PERFORM 3400-CREATE-TS-PI  THRU 3400-EXIT
  4470             MOVE XCTL-6523             TO PGM-NAME
  4471             GO TO 9300-XCTL
  4472         ELSE
  4473            MOVE ER-0187                TO EMI-ERROR
  4474            GO TO 3100-INPUT-ERROR
  4475         END-IF
  4476        ELSE
  4477           MOVE ER-0035          TO EMI-ERROR
  4478           GO TO 3100-INPUT-ERROR
  4479        END-IF
  4480     END-IF
  4481     IF EIBAID = DFHPF13
  4482        IF PI-ERC-TYPE = 'B'
  4483           IF PI-ERCOMP-KEY NOT = SPACES
  4484              MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4485              MOVE PI-ERC-GROUP  TO PI-CR-GROUPING
  4486              MOVE PI-ERC-RESP   TO PI-CR-FIN-RESP
  4487              MOVE PI-ERC-ACCT   TO PI-CR-ACCOUNT
  4488              MOVE PI-ERC-TYPE   TO PI-CR-TYPE
  4489              PERFORM 3400-CREATE-TS-PI
  4490                                 THRU 3400-EXIT
  4491              MOVE XCTL-6524     TO PGM-NAME
  4492              GO TO 9300-XCTL
  4493           ELSE
  4494              MOVE ER-0187       TO EMI-ERROR
  4495              GO TO 3100-INPUT-ERROR
  4496           END-IF
  4497        ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  88
* EL652.cbl
  4498           MOVE ER-0035          TO EMI-ERROR
  4499           GO TO 3100-INPUT-ERROR
  4500        END-IF
  4501     END-IF
  4502     IF EIBAID = DFHENTER
  4503         GO TO 4000-EDIT-MAINT.
  4504
  4505     MOVE ER-0029                TO  EMI-ERROR.
  4506
  4507 3100-INPUT-ERROR.
  4508     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4509
  4510     MOVE AL-UNBON               TO  PFKEYA.
  4511     MOVE -1                     TO  PFKEYL.
  4512
  4513     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  89
* EL652.cbl
  4515 3200-FIND-STATE.
  4516
  4517     IF PI-SAVE-CITYST NOT = SPACES
  4518        MOVE PI-SAVE-CITYST       TO WS-SRCH-STATE
  4519     ELSE
  4520        IF PI-SAVE-ADDR2 NOT = SPACES
  4521           MOVE PI-SAVE-ADDR2     TO WS-SRCH-STATE
  4522        END-IF
  4523     END-IF
  4524
  4525     PERFORM VARYING STNDX FROM +29 BY -1 UNTIL
  4526          (STNDX < +1) OR
  4527          ((WS-SRCH-STATE (STNDX:2) ALPHABETIC) AND
  4528          (WS-SRCH-STATE (STNDX:2) NOT = SPACES AND LOW-VALUES)
  4529          AND
  4530          (WS-SRCH-STATE (STNDX + 1:1) NOT = ' ' AND ',' AND
  4531                   '.' AND LOW-VALUES) AND
  4532          (WS-SRCH-STATE (STNDX:1) NOT = ' ' AND ',' AND
  4533                   '.' AND LOW-VALUES))
  4534     END-PERFORM
  4535
  4536     IF STNDX NOT < +1
  4537        MOVE WS-SRCH-STATE (STNDX:2)
  4538                                 TO PI-SAVE-STATE
  4539     ELSE
  4540        MOVE SPACES              TO PI-SAVE-STATE
  4541     END-IF
  4542
  4543     .
  4544 3200-EXIT.
  4545     EXIT.
  4546 3400-CREATE-TS-PI.
  4547
  4548     PERFORM 3450-DELETE-TEMP-STOR-PI THRU 3450-EXIT.
  4549
  4550
  4551* EXEC CICS HANDLE CONDITION
  4552*        QIDERR  (3400-EXIT)
  4553*    END-EXEC.
  4554*    MOVE '"$N                   ! # #00004521' TO DFHEIV0
  4555     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4556     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4557     MOVE X'2320233030303034353231' TO DFHEIV0(25:11)
  4558     CALL 'kxdfhei1' USING DFHEIV0
  4559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4560
  4561
  4562
  4563* EXEC CICS WRITEQ TS
  4564*        QUEUE   (QID-PI)
  4565*        FROM    (PROGRAM-INTERFACE-BLOCK)
  4566*        LENGTH  (PI-COMM-LENGTH)
  4567*        ITEM    (QID-ITEM)
  4568*    END-EXEC.
  4569*    MOVE '*" I   L              ''   #00004525' TO DFHEIV0
  4570     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
  4571     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4572     MOVE X'2020233030303034353235' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  90
* EL652.cbl
  4573     CALL 'kxdfhei1' USING DFHEIV0,
  4574           QID-PI,
  4575           PROGRAM-INTERFACE-BLOCK,
  4576           PI-COMM-LENGTH,
  4577           QID-ITEM,
  4578           DFHEIV99,
  4579           DFHEIV99
  4580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4581
  4582
  4583 3400-EXIT.
  4584      EXIT.
  4585
  4586 3450-DELETE-TEMP-STOR-PI.
  4587
  4588
  4589* EXEC CICS HANDLE CONDITION
  4590*        QIDERR  (3450-EXIT)
  4591*    END-EXEC.
  4592*    MOVE '"$N                   ! $ #00004537' TO DFHEIV0
  4593     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4594     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4595     MOVE X'2420233030303034353337' TO DFHEIV0(25:11)
  4596     CALL 'kxdfhei1' USING DFHEIV0
  4597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4598
  4599
  4600
  4601* EXEC CICS DELETEQ TS
  4602*        QUEUE  (QID-PI)
  4603*    END-EXEC.
  4604*    MOVE '*&                    #   #00004541' TO DFHEIV0
  4605     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  4606     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4607     MOVE X'2020233030303034353431' TO DFHEIV0(25:11)
  4608     CALL 'kxdfhei1' USING DFHEIV0,
  4609           QID-PI,
  4610           DFHEIV99
  4611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4612
  4613
  4614
  4615* EXEC CICS SYNCPOINT
  4616*    END-EXEC.
  4617*    MOVE '6"                    !   #00004545' TO DFHEIV0
  4618     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  4619     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4620     MOVE X'2020233030303034353435' TO DFHEIV0(25:11)
  4621     CALL 'kxdfhei1' USING DFHEIV0
  4622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4623
  4624
  4625 3450-EXIT.
  4626      EXIT.
  4627
  4628 3475-RECOVER-TEMP-STOR-PI.
  4629
  4630     MOVE LOW-VALUES            TO  EL652AI.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  91
* EL652.cbl
  4631
  4632
  4633* EXEC CICS HANDLE CONDITION
  4634*        NOTOPEN   (9990-ABEND)
  4635*        NOTFND    (8880-NOT-FOUND)
  4636*        PGMIDERR  (9600-PGMID-ERROR)
  4637*        ERROR     (9990-ABEND)
  4638*    END-EXEC.
  4639*    MOVE '"$JIL.                ! % #00004555' TO DFHEIV0
  4640     MOVE X'22244A494C2E202020202020' TO DFHEIV0(1:12)
  4641     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4642     MOVE X'2520233030303034353535' TO DFHEIV0(25:11)
  4643     CALL 'kxdfhei1' USING DFHEIV0
  4644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4645
  4646
  4647
  4648* EXEC CICS HANDLE CONDITION
  4649*        QIDERR  (3475-EXIT)
  4650*    END-EXEC.
  4651*    MOVE '"$N                   ! & #00004562' TO DFHEIV0
  4652     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4653     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4654     MOVE X'2620233030303034353632' TO DFHEIV0(25:11)
  4655     CALL 'kxdfhei1' USING DFHEIV0
  4656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4657
  4658
  4659
  4660* EXEC CICS READQ TS
  4661*        QUEUE   (QID-PI)
  4662*        ITEM    (1)
  4663*        INTO    (PROGRAM-INTERFACE-BLOCK)
  4664*        LENGTH  (PI-COMM-LENGTH)
  4665*    END-EXEC.
  4666     MOVE 1
  4667       TO DFHEIV11
  4668*    MOVE '*$II   L              ''   #00004566' TO DFHEIV0
  4669     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4670     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4671     MOVE X'2020233030303034353636' TO DFHEIV0(25:11)
  4672     CALL 'kxdfhei1' USING DFHEIV0,
  4673           QID-PI,
  4674           PROGRAM-INTERFACE-BLOCK,
  4675           PI-COMM-LENGTH,
  4676           DFHEIV11,
  4677           DFHEIV99,
  4678           DFHEIV99
  4679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4680
  4681
  4682     PERFORM 3450-DELETE-TEMP-STOR-PI THRU 3450-EXIT.
  4683
  4684     IF  PI-ERCOMP-KEY = SPACES OR LOW-VALUES
  4685         GO TO 8100-SEND-INITIAL-MAP.
  4686
  4687     IF  PI-ERC-CARRIER > LOW-VALUES
  4688         MOVE +1                 TO CARRIERL
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  92
* EL652.cbl
  4689         MOVE PI-ERC-CARRIER     TO CARRIERI.
  4690
  4691     IF  PI-ERC-GROUP > LOW-VALUES
  4692         MOVE +6                 TO GROUPL
  4693         MOVE PI-ERC-GROUP       TO GROUPI.
  4694
  4695     IF  PI-ERC-RESP > LOW-VALUES
  4696         MOVE +10                TO FINRESPL
  4697         MOVE PI-ERC-RESP        TO FINRESPI.
  4698
  4699     IF  PI-ERC-ACCT > LOW-VALUES
  4700         MOVE +1                 TO ACCTNOL
  4701         MOVE PI-ERC-ACCT        TO ACCTNOI.
  4702
  4703     IF  PI-ERC-TYPE > LOW-VALUES
  4704         MOVE +1                 TO TYPEL
  4705         MOVE PI-ERC-TYPE        TO TYPEI.
  4706
  4707     MOVE 'S'                    TO MAINTYPI.
  4708     MOVE 1                      TO MAINTYPL.
  4709     GO TO 4000-EDIT-MAINT.
  4710
  4711 3475-EXIT.
  4712      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  93
* EL652.cbl
  4714 4000-EDIT-MAINT.
  4715     IF MAINTYPL > ZERO
  4716         MOVE MAINTYPI           TO  PI-CHECK-MAINT-TYPE
  4717         IF VALID-MAINT-TYPE
  4718             MOVE AL-UANON       TO  MAINTYPA
  4719             IF MAINTYPI NOT = 'S'
  4720                 MOVE SPACES     TO  WS-ACCESS
  4721                 MOVE '1'        TO  CNTL-REC-TYPE
  4722                 PERFORM 7400-READ-CONTROL-FILE  THRU  7499-EXIT
  4723             ELSE
  4724                 NEXT SENTENCE
  4725         ELSE
  4726             MOVE -1             TO  MAINTYPL
  4727             MOVE AL-UABON       TO  MAINTYPA
  4728             MOVE ER-2039        TO  EMI-ERROR
  4729             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4730     ELSE
  4731         MOVE -1                 TO  MAINTYPL
  4732         MOVE AL-UABON           TO  MAINTYPA
  4733         MOVE ER-2039            TO  EMI-ERROR
  4734         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4735
  4736     IF  NOT MODIFY-CAP
  4737             AND
  4738         NOT SHOW-FUNCTION
  4739         MOVE 'UPDATE'           TO SM-READ
  4740         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  4741         IF  MORTGAGE-SESSION
  4742             MOVE ER-9096        TO  EMI-ERROR
  4743             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4744             GO TO 8100-SEND-INITIAL-MAP
  4745         ELSE
  4746             MOVE ER-0070        TO  EMI-ERROR
  4747             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4748             GO TO 8100-SEND-INITIAL-MAP.
  4749
  4750     IF CARRIERL > ZERO
  4751         IF PI-CARRIER-SECURITY > SPACES
  4752             IF CARRIERI = PI-CARRIER-SECURITY
  4753                 NEXT SENTENCE
  4754             ELSE
  4755                 MOVE -1            TO  CARRIERL
  4756                 MOVE ER-2370       TO  EMI-ERROR
  4757                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4758                 MOVE AL-UABON      TO  CARRIERA
  4759                 GO TO 8200-SEND-DATAONLY.
  4760
  4761     IF CARRIERL > ZERO
  4762         IF ADD-FUNCTION
  4763             IF PI-ZERO-CARRIER
  4764               OR PI-ZERO-CAR-GROUP
  4765                 MOVE ZEROS      TO  PI-ERC-CARRIER
  4766                                     CARRIERI
  4767                 MOVE AL-UANON   TO  CARRIERA
  4768             ELSE
  4769                 MOVE CARRIERI   TO  WS-CARRIER
  4770                 MOVE '6'        TO  CNTL-REC-TYPE
  4771                 PERFORM 7400-READ-CONTROL-FILE  THRU  7499-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  94
* EL652.cbl
  4772         ELSE
  4773             IF PI-ZERO-CARRIER
  4774               OR PI-ZERO-CAR-GROUP
  4775                 MOVE ZEROS      TO  PI-ERC-CARRIER
  4776                                     CARRIERI
  4777                 MOVE AL-UANON   TO  CARRIERA
  4778             ELSE
  4779                 MOVE AL-UANON   TO  CARRIERA
  4780                 MOVE CARRIERI   TO  PI-ERC-CARRIER
  4781     ELSE
  4782         IF ADD-FUNCTION
  4783             IF PI-ZERO-CARRIER
  4784               OR PI-ZERO-CAR-GROUP
  4785                 MOVE ZEROS      TO  PI-ERC-CARRIER
  4786                                     CARRIERI
  4787                 MOVE AL-UANON   TO  CARRIERA
  4788             ELSE
  4789                 MOVE -1         TO  CARRIERL
  4790                 MOVE AL-UABON   TO  CARRIERA
  4791                 MOVE ER-0193    TO  EMI-ERROR
  4792                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4793         ELSE
  4794             MOVE -1             TO  CARRIERL
  4795             MOVE AL-UABON       TO  CARRIERA
  4796             MOVE ER-0193        TO  EMI-ERROR
  4797             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4798
  4799     IF GROUPL > ZERO
  4800         IF PI-ZERO-GROUPING
  4801           OR PI-ZERO-CAR-GROUP
  4802             MOVE ZEROS          TO  PI-ERC-GROUP
  4803                                     GROUPI
  4804             MOVE AL-UANON       TO  GROUPA
  4805         ELSE
  4806             MOVE AL-UANON       TO  GROUPA
  4807             MOVE GROUPI         TO  PI-ERC-GROUP
  4808     ELSE
  4809         IF ADD-FUNCTION
  4810             IF PI-ZERO-GROUPING
  4811               OR PI-ZERO-CAR-GROUP
  4812                 MOVE ZEROS      TO  PI-ERC-GROUP
  4813                                     GROUPI
  4814                 MOVE AL-UANON   TO  GROUPA
  4815             ELSE
  4816                 MOVE LOW-VALUES  TO  PI-ERC-GROUP
  4817         ELSE
  4818             MOVE LOW-VALUES     TO  PI-ERC-GROUP.
  4819
  4820     IF TYPEL > ZERO
  4821         MOVE TYPEI              TO  PI-CHECK-TYPE
  4822         IF VALID-TYPE
  4823             MOVE AL-UANON       TO  TYPEA
  4824             MOVE TYPEI          TO  PI-ERC-TYPE
  4825         ELSE
  4826             MOVE -1             TO  TYPEL
  4827             MOVE AL-UABON       TO  TYPEA
  4828             MOVE ER-2042        TO  EMI-ERROR
  4829             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  95
* EL652.cbl
  4830     ELSE
  4831         MOVE -1                 TO  TYPEL
  4832         MOVE AL-UABON           TO  TYPEA
  4833         MOVE ER-2042            TO  EMI-ERROR
  4834         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4835
  4836     IF FINRESPL >        ZERO
  4837         MOVE AL-UANON           TO  FINRESPA
  4838         IF FINRESPI = SPACES
  4839             MOVE LOW-VALUES     TO  PI-ERC-RESP
  4840         ELSE
  4841             MOVE FINRESPI       TO  PI-ERC-RESP
  4842     ELSE
  4843         MOVE LOW-VALUES         TO  PI-ERC-RESP.
  4844
  4845     IF ACCTNOL > ZERO
  4846         MOVE AL-UANON           TO  ACCTNOA
  4847         IF ACCTNOI = SPACES
  4848             MOVE LOW-VALUES     TO  PI-ERC-ACCT
  4849         ELSE
  4850             MOVE ACCTNOI        TO  PI-ERC-ACCT
  4851     ELSE
  4852         MOVE LOW-VALUES         TO  PI-ERC-ACCT.
  4853
  4854     IF ADDR2L > ZERO
  4855        MOVE AL-UANON            TO ADDR2A
  4856        IF ADDR2I = SPACES
  4857           MOVE LOW-VALUES       TO PI-SAVE-ADDR2
  4858        ELSE
  4859           MOVE ADDR2I           TO PI-SAVE-ADDR2
  4860        END-IF
  4861     ELSE
  4862        MOVE LOW-VALUES          TO PI-SAVE-ADDR2
  4863     END-IF
  4864
  4865     IF CITYL > ZERO
  4866        MOVE AL-UANON            TO CITYA
  4867        IF CITYI = SPACES
  4868           MOVE LOW-VALUES       TO PI-SAVE-CITY
  4869        ELSE
  4870           MOVE CITYI            TO PI-SAVE-CITY
  4871        END-IF
  4872     ELSE
  4873        MOVE LOW-VALUES          TO PI-SAVE-CITY
  4874     END-IF
  4875
  4876     IF STATEL > ZERO
  4877        MOVE AL-UANON            TO STATEA
  4878        IF STATEI = SPACES
  4879           MOVE LOW-VALUES       TO PI-SAVE-STATE
  4880        ELSE
  4881           MOVE STATEI           TO PI-SAVE-STATE
  4882        END-IF
  4883     ELSE
  4884        MOVE LOW-VALUES          TO PI-SAVE-STATE
  4885     END-IF
  4886
  4887     IF NOT MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  96
* EL652.cbl
  4888         IF SHOW-FUNCTION
  4889             GO TO 5000-BUILD-INITIAL-SCREEN
  4890         ELSE
  4891             MOVE 'UPDATE'       TO SM-READ
  4892             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  4893             MOVE ER-0070        TO  EMI-ERROR
  4894             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4895             GO TO 8100-SEND-INITIAL-MAP.
  4896
  4897     IF EMI-NO-ERRORS
  4898         NEXT SENTENCE
  4899     ELSE
  4900        IF EIBTRNID NOT = TRANS-ID
  4901            GO TO 8100-SEND-INITIAL-MAP
  4902         ELSE
  4903            GO TO 8200-SEND-DATAONLY.
  4904
  4905     IF CHANGE-FUNCTION
  4906         GO TO 4400-CHANGE.
  4907
  4908     IF DELETE-FUNCTION
  4909         GO TO 4600-DELETE.
  4910
  4911     IF SHOW-FUNCTION
  4912         GO TO 5000-BUILD-INITIAL-SCREEN.
  4913
  4914     IF TYPEI = 'C'
  4915         IF FINRESPI NOT = LOW-VALUES OR
  4916            ACCTNOI  NOT = LOW-VALUES
  4917               MOVE -1           TO  FINRESPL
  4918               MOVE AL-UABON     TO  FINRESPA
  4919                                     ACCTNOA
  4920               MOVE ER-2088      TO  EMI-ERROR
  4921               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4922
  4923     IF TYPEI = 'A'
  4924         IF FINRESPI = LOW-VALUES OR
  4925             ACCTNOI = LOW-VALUES
  4926               MOVE -1           TO  FINRESPL
  4927               MOVE AL-UABON     TO  FINRESPA
  4928                                     ACCTNOA
  4929               MOVE ER-2089      TO  EMI-ERROR
  4930               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4931
  4932     IF TYPEI = 'G' OR 'B'
  4933         IF ACCTNOI NOT = LOW-VALUES
  4934             MOVE -1             TO  ACCTNOL
  4935             MOVE AL-UABON       TO  ACCTNOA
  4936             MOVE ER-2091        TO  EMI-ERROR
  4937             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4938         ELSE
  4939             IF FINRESPI = LOW-VALUES
  4940                 MOVE -1         TO  FINRESPL
  4941                 MOVE AL-UABON   TO  FINRESPA
  4942                 MOVE ER-2097    TO  EMI-ERROR
  4943                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4944
  4945     IF TYPEI = 'G' OR 'B'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  97
* EL652.cbl
  4946         IF SUMMNOI NOT = LOW-VALUES
  4947             MOVE -1             TO  SUMMNOL
  4948             MOVE AL-UABON       TO  SUMMNOA
  4949             MOVE ER-3153        TO  EMI-ERROR
  4950             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4951
  4952     IF TYPEI = 'G' OR 'B'
  4953         IF NETGRSI NOT = LOW-VALUES
  4954             MOVE -1             TO  NETGRSL
  4955             MOVE AL-UABON       TO  NETGRSA
  4956             MOVE ER-3154        TO  EMI-ERROR
  4957             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4958
  4959     IF EMI-NO-ERRORS
  4960         NEXT SENTENCE
  4961     ELSE
  4962         GO TO 8200-SEND-DATAONLY.
  4963
  4964     IF ADD-FUNCTION
  4965         GO TO 4200-ADD.
  4966
  4967     MOVE -1                     TO  MAINTYPL.
  4968     MOVE ER-2056                TO  EMI-ERROR.
  4969     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4970
  4971     GO TO 8200-SEND-DATAONLY.
  4972
  4973 4000-EXIT.
  4974     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  98
* EL652.cbl
  4976 4200-ADD.
  4977     IF PI-ERCOMP-KEY = PI-SAVE-ERCOMP-KEY
  4978         MOVE ER-2057            TO  EMI-ERROR
  4979         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4980         MOVE -1                 TO  MAINTYPL
  4981         GO TO 8200-SEND-DATAONLY.
  4982
  4983     PERFORM 7000-EDIT  THRU  7000-EXIT.
  4984
  4985     IF EMI-NO-ERRORS
  4986         NEXT SENTENCE
  4987     ELSE
  4988         GO TO 8200-SEND-DATAONLY.
  4989
  4990
  4991* EXEC CICS HANDLE CONDITION
  4992*        NOTOPEN  (9990-ABEND)
  4993*        NOTFND   (4250-CONT)
  4994*    END-EXEC.
  4995*    MOVE '"$JI                  ! '' #00004881' TO DFHEIV0
  4996     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  4997     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4998     MOVE X'2720233030303034383831' TO DFHEIV0(25:11)
  4999     CALL 'kxdfhei1' USING DFHEIV0
  5000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5001
  5002
  5003     PERFORM 7050-READ-ERCOMP  THRU  7050-EXIT.
  5004
  5005     MOVE ER-2057                TO  EMI-ERROR.
  5006     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5007
  5008     MOVE LOW-VALUES             TO  PI-SAVE-ERCOMP-KEY.
  5009
  5010     MOVE -1                     TO  MAINTYPL.
  5011
  5012     GO TO 8200-SEND-DATAONLY.
  5013
  5014 4250-CONT.
  5015     PERFORM 7150-ERCOMP-GETMAIN  THRU  7150-EXIT.
  5016
  5017     MOVE SPACES                 TO  COMPENSATION-MASTER.
  5018     MOVE ZEROS                  TO  CO-LF-CLM-AMT
  5019                                     CO-AH-CLM-AMT
  5020                                     CO-CUR-FICA
  5021                                     CO-YTD-FICA
  5022                                     CO-CUR-OVR-UNDR
  5023                                     CO-YTD-OVR-UNDR
  5024                                     CO-MAX-BANK-FEE-LEASE
  5025                                     CO-MAX-BANK-FEE
  5026                                     CO-BAL-FWD
  5027                                     CO-CUR-COM
  5028                                     CO-CUR-CHG
  5029                                     CO-CUR-PMT
  5030                                     CO-END-BAL
  5031                                     CO-CUR
  5032                                     CO-OV30
  5033                                     CO-OV60
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page  99
* EL652.cbl
  5034                                     CO-OV90
  5035                                     co-ov120
  5036                                     CO-YTD-COM
  5037                                     CO-YTD-OV
  5038                                     CO-YTD-PAID-COM
  5039                                     CO-YTD-PAID-OV
  5040                                     CO-CURRENT-BAL-FWD
  5041                                     CO-CURRENT-CUR-COM
  5042                                     CO-CURRENT-CUR-CHG
  5043                                     CO-CURRENT-CUR-PMT
  5044                                     CO-CURRENT-END-BAL
  5045                                     CO-CURRENT-CUR
  5046                                     CO-CURRENT-OV30
  5047                                     CO-CURRENT-OV60
  5048                                     CO-CURRENT-OV90
  5049                                     co-current-ov120
  5050                                     CO-CURRENT-YTD-COM
  5051                                     CO-CURRENT-YTD-OV
  5052                                     CO-ACT-YEAR
  5053                                     CO-ACT-MONTH
  5054                                     CO-ACT-DAY.
  5055     MOVE LOW-VALUES             TO  CO-LAST-ACTIVITY-DATE
  5056                                     CO-LAST-STMT-DT
  5057                                     CO-CURRENT-LAST-STMT-DT
  5058                                     CO-GA-EFFECTIVE-DT
  5059                                     CO-GA-TERMINATION-DT.
  5060     MOVE LOW-VALUES             TO  CO-FIRST-WRITTEN-DT.
  5061
  5062     MOVE 'N'                    TO  CO-INTERNAL-CONTROL-1
  5063                                     CO-INTERNAL-CONTROL-2.
  5064     PERFORM 6000-CHECK-FOR-UPDATE  THRU  6099-EXIT.
  5065
  5066     MOVE PI-PROCESSOR-ID        TO  CO-LAST-MAINT-USER.
  5067     MOVE EIBTIME                TO  CO-LAST-MAINT-HHMMSS.
  5068     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5069     MOVE '5'                    TO  DC-OPTION-CODE.
  5070     MOVE LINK-ELDATCV           TO  PGM-NAME.
  5071
  5072
  5073* EXEC CICS LINK
  5074*        PROGRAM   (PGM-NAME)
  5075*        COMMAREA  (DATE-CONVERSION-DATA)
  5076*        LENGTH    (DC-COMM-LENGTH)
  5077*    END-EXEC.
  5078*    MOVE '."C                   (   #00004955' TO DFHEIV0
  5079     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5080     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5081     MOVE X'2020233030303034393535' TO DFHEIV0(25:11)
  5082     CALL 'kxdfhei1' USING DFHEIV0,
  5083           PGM-NAME,
  5084           DATE-CONVERSION-DATA,
  5085           DC-COMM-LENGTH,
  5086           DFHEIV99,
  5087           DFHEIV99,
  5088           DFHEIV99,
  5089           DFHEIV99
  5090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5091
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 100
* EL652.cbl
  5092
  5093     MOVE DC-BIN-DATE-1          TO  CO-LAST-MAINT-DT
  5094                                     BIN-CURRENT-SAVE.
  5095     MOVE PI-CR-MONTH-END-DT     TO  CO-ROLADEX-PRINT-DT.
  5096     MOVE PI-CR-MONTH-END-DT     TO  DC-BIN-DATE-1
  5097     MOVE SPACE                  TO  DC-OPTION-CODE.
  5098
  5099
  5100* EXEC CICS LINK
  5101*        PROGRAM   (PGM-NAME)
  5102*        COMMAREA  (DATE-CONVERSION-DATA)
  5103*        LENGTH    (DC-COMM-LENGTH)
  5104*    END-EXEC.
  5105*    MOVE '."C                   (   #00004967' TO DFHEIV0
  5106     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5107     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5108     MOVE X'2020233030303034393637' TO DFHEIV0(25:11)
  5109     CALL 'kxdfhei1' USING DFHEIV0,
  5110           PGM-NAME,
  5111           DATE-CONVERSION-DATA,
  5112           DC-COMM-LENGTH,
  5113           DFHEIV99,
  5114           DFHEIV99,
  5115           DFHEIV99,
  5116           DFHEIV99
  5117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5118
  5119
  5120     MOVE PI-COMPANY-CD          TO  CO-COMPANY-CD.
  5121     MOVE 'CO'                   TO  CO-RECORD-ID.
  5122     MOVE 'A'                    TO  JP-RECORD-TYPE.
  5123     MOVE COMP-FILE-ID           TO  FILE-ID.
  5124     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5125
  5126     PERFORM 4300-ADD-COMPENSATION-NAME  THRU  4300-EXIT.
  5127
  5128
  5129* EXEC CICS WRITE
  5130*        DATASET  (COMP-FILE-ID)
  5131*        FROM     (COMPENSATION-MASTER)
  5132*        RIDFLD   (CO-CONTROL-PRIMARY)
  5133*    END-EXEC.
  5134     MOVE LENGTH OF
  5135      COMPENSATION-MASTER
  5136       TO DFHEIV11
  5137*    MOVE '&$ L                  ''   #00004981' TO DFHEIV0
  5138     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5139     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5140     MOVE X'2020233030303034393831' TO DFHEIV0(25:11)
  5141     CALL 'kxdfhei1' USING DFHEIV0,
  5142           COMP-FILE-ID,
  5143           COMPENSATION-MASTER,
  5144           DFHEIV11,
  5145           CO-CONTROL-PRIMARY,
  5146           DFHEIV99,
  5147           DFHEIV99
  5148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5149
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 101
* EL652.cbl
  5150
  5151     PERFORM 8400-LOG-JOURNAL-RECORD.
  5152
  5153     PERFORM 8000-UPDATE-MAINT-DATE  THRU  8000-EXIT.
  5154
  5155     IF PI-AR-PROCESSING
  5156         IF SUMMNOL > ZERO
  5157             MOVE SUMMNOI        TO PI-AR-SUMMARY-CODE
  5158             PERFORM 7500-UPDATE-SUMM  THRU  7599-EXIT
  5159             MOVE PI-AR-SUMMARY-CODE
  5160                                 TO  WS-SUMM-FOR-RQST
  5161             PERFORM 6500-UPDATE-RQST  THRU  6599-EXIT.
  5162
  5163     MOVE ER-0000                TO  EMI-ERROR.
  5164     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5165
  5166     MOVE LOW-VALUES             TO  EL652AO.
  5167     MOVE PI-ERC-CARRIER         TO  CARRIERO.
  5168     MOVE PI-ERC-TYPE            TO  TYPEO.
  5169     MOVE AL-UANON               TO  CARRIERA
  5170                                     TYPEA.
  5171
  5172     IF PI-ERC-GROUP NOT = SPACES
  5173         MOVE PI-ERC-GROUP       TO  GROUPO
  5174         MOVE AL-UANON           TO  GROUPA.
  5175
  5176     IF PI-ERC-RESP NOT = SPACES
  5177         MOVE PI-ERC-RESP        TO  FINRESPO
  5178         MOVE AL-UANON           TO  FINRESPA.
  5179
  5180     IF PI-ERC-ACCT NOT = SPACES
  5181         MOVE PI-ERC-ACCT        TO  ACCTNOO
  5182         MOVE AL-UANON           TO  ACCTNOA.
  5183
  5184     GO TO 5000-BUILD-INITIAL-SCREEN.
  5185
  5186 4200-EXIT.
  5187     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 102
* EL652.cbl
  5189 4300-ADD-COMPENSATION-NAME.
  5190
  5191* EXEC CICS HANDLE CONDITION
  5192*         DUPREC   (4300-EXIT)
  5193*    END-EXEC.
  5194*    MOVE '"$%                   ! ( #00005026' TO DFHEIV0
  5195     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  5196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5197     MOVE X'2820233030303035303236' TO DFHEIV0(25:11)
  5198     CALL 'kxdfhei1' USING DFHEIV0
  5199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5200
  5201
  5202
  5203* EXEC CICS GETMAIN
  5204*         LENGTH   (ERNAME-LENGTH)
  5205*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  5206*         INITIMG  (GETMAIN-SPACE)
  5207*    END-EXEC.
  5208*    MOVE ',"IL                  $   #00005030' TO DFHEIV0
  5209     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5210     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5211     MOVE X'2020233030303035303330' TO DFHEIV0(25:11)
  5212     CALL 'kxdfhei1' USING DFHEIV0,
  5213           DFHEIV20,
  5214           ERNAME-LENGTH,
  5215           GETMAIN-SPACE
  5216     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  5217         DFHEIV20
  5218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5219
  5220
  5221     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  5222     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  5223     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  5224     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  5225     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  5226     MOVE CO-ACCT-NAME           TO  NL-NAME.
  5227     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  5228        MOVE NL-NAME (5:26)      TO NL-NAME
  5229     END-IF
  5230     MOVE CO-ADDR-CITY           TO  NL-CITY.
  5231     MOVE CO-ADDR-STATE          TO  NL-ST
  5232     MOVE 'C'                    TO  NL-RECORD-TYPE.
  5233     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  5234     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  5235     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  5236     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  5237     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  5238     MOVE CO-TYPE                TO  NL-CO-TYPE.
  5239
  5240
  5241* EXEC CICS WRITE
  5242*        FROM      (NAME-LOOKUP-MASTER)
  5243*        RIDFLD    (NL-CONTROL-PRIMARY)
  5244*        DATASET   (NAME-FILE-ID)
  5245*    END-EXEC.
  5246     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 103
* EL652.cbl
  5247      NAME-LOOKUP-MASTER
  5248       TO DFHEIV11
  5249*    MOVE '&$ L                  ''   #00005055' TO DFHEIV0
  5250     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5251     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5252     MOVE X'2020233030303035303535' TO DFHEIV0(25:11)
  5253     CALL 'kxdfhei1' USING DFHEIV0,
  5254           NAME-FILE-ID,
  5255           NAME-LOOKUP-MASTER,
  5256           DFHEIV11,
  5257           NL-CONTROL-PRIMARY,
  5258           DFHEIV99,
  5259           DFHEIV99
  5260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5261
  5262
  5263 4300-EXIT.
  5264     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 104
* EL652.cbl
  5266 4400-CHANGE.
  5267     IF PI-ERCOMP-KEY = PI-SAVE-ERCOMP-KEY
  5268         NEXT SENTENCE
  5269     ELSE
  5270**** MUST SHOW RECORD FIRST
  5271         MOVE ER-2056            TO  EMI-ERROR
  5272         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5273         MOVE -1                 TO  MAINTYPL
  5274         GO TO 8200-SEND-DATAONLY.
  5275
  5276     PERFORM 7000-EDIT  THRU  7000-EXIT.
  5277
  5278     IF EMI-NO-ERRORS
  5279         NEXT SENTENCE
  5280     ELSE
  5281         GO TO 8200-SEND-DATAONLY.
  5282
  5283     PERFORM 7200-READ-ERCOMP-UPDATE  THRU  7200-EXIT.
  5284
  5285     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5286     MOVE CO-AR-SUMMARY-CODE     TO  WS-SAVE-SUMM.
  5287
  5288     PERFORM 6000-CHECK-FOR-UPDATE  THRU  6099-EXIT.
  5289
  5290     IF (CO-LAST-MAINT-USER   = PI-UPDATE-BY)
  5291        OR (CO-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS)
  5292        CONTINUE
  5293     ELSE
  5294
  5295* EXEC CICS UNLOCK
  5296*            DATASET  (COMP-FILE-ID)
  5297*       END-EXEC
  5298*    MOVE '&*                    #   #00005092' TO DFHEIV0
  5299     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5300     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5301     MOVE X'2020233030303035303932' TO DFHEIV0(25:11)
  5302     CALL 'kxdfhei1' USING DFHEIV0,
  5303           COMP-FILE-ID,
  5304           DFHEIV99
  5305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5306        MOVE ER-0068             TO EMI-ERROR
  5307        PERFORM 9900-ERROR-FORMAT
  5308                                 THRU 9900-EXIT
  5309        GO TO 8200-SEND-DATAONLY
  5310     END-IF
  5311
  5312     MOVE PI-PROCESSOR-ID        TO  CO-LAST-MAINT-USER.
  5313     MOVE EIBTIME                TO  CO-LAST-MAINT-HHMMSS.
  5314     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5315     MOVE '5'                    TO  DC-OPTION-CODE.
  5316     MOVE LINK-ELDATCV           TO  PGM-NAME.
  5317
  5318
  5319* EXEC CICS LINK
  5320*        PROGRAM   (PGM-NAME)
  5321*        COMMAREA  (DATE-CONVERSION-DATA)
  5322*        LENGTH    (DC-COMM-LENGTH)
  5323*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 105
* EL652.cbl
  5324*    MOVE '."C                   (   #00005107' TO DFHEIV0
  5325     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5326     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5327     MOVE X'2020233030303035313037' TO DFHEIV0(25:11)
  5328     CALL 'kxdfhei1' USING DFHEIV0,
  5329           PGM-NAME,
  5330           DATE-CONVERSION-DATA,
  5331           DC-COMM-LENGTH,
  5332           DFHEIV99,
  5333           DFHEIV99,
  5334           DFHEIV99,
  5335           DFHEIV99
  5336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5337
  5338
  5339     MOVE DC-BIN-DATE-1          TO  CO-LAST-MAINT-DT
  5340                                     BIN-CURRENT-SAVE.
  5341     MOVE SPACE                  TO  DC-OPTION-CODE.
  5342     MOVE PI-CR-MONTH-END-DT     TO  CO-ROLADEX-PRINT-DT.
  5343     MOVE PI-CR-MONTH-END-DT     TO  DC-BIN-DATE-1
  5344
  5345
  5346* EXEC CICS LINK
  5347*        PROGRAM   (PGM-NAME)
  5348*        COMMAREA  (DATE-CONVERSION-DATA)
  5349*        LENGTH    (DC-COMM-LENGTH)
  5350*    END-EXEC.
  5351*    MOVE '."C                   (   #00005119' TO DFHEIV0
  5352     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5353     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5354     MOVE X'2020233030303035313139' TO DFHEIV0(25:11)
  5355     CALL 'kxdfhei1' USING DFHEIV0,
  5356           PGM-NAME,
  5357           DATE-CONVERSION-DATA,
  5358           DC-COMM-LENGTH,
  5359           DFHEIV99,
  5360           DFHEIV99,
  5361           DFHEIV99,
  5362           DFHEIV99
  5363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5364
  5365
  5366     MOVE 'N'                    TO  CO-INTERNAL-CONTROL-1.
  5367     MOVE 'B'                    TO  JP-RECORD-TYPE.
  5368     MOVE COMP-FILE-ID           TO  FILE-ID.
  5369
  5370     PERFORM 8400-LOG-JOURNAL-RECORD.
  5371
  5372     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5373
  5374     PERFORM 4300-ADD-COMPENSATION-NAME  THRU  4300-EXIT.
  5375
  5376
  5377* EXEC CICS REWRITE
  5378*        DATASET  (COMP-FILE-ID)
  5379*        FROM     (COMPENSATION-MASTER)
  5380*    END-EXEC.
  5381     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 106
* EL652.cbl
  5382      COMPENSATION-MASTER
  5383       TO DFHEIV11
  5384*    MOVE '&& L                  %   #00005135' TO DFHEIV0
  5385     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5386     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5387     MOVE X'2020233030303035313335' TO DFHEIV0(25:11)
  5388     CALL 'kxdfhei1' USING DFHEIV0,
  5389           COMP-FILE-ID,
  5390           COMPENSATION-MASTER,
  5391           DFHEIV11,
  5392           DFHEIV99
  5393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5394
  5395
  5396     MOVE 'C'                    TO  JP-RECORD-TYPE.
  5397
  5398     PERFORM 8400-LOG-JOURNAL-RECORD.
  5399
  5400     IF NOT PI-AR-PROCESSING
  5401         GO TO 4400-CONT.
  5402
  5403     IF SUMMNOL NOT > ZERO
  5404         GO TO 4400-CONT.
  5405
  5406     IF SUMMNOI  = WS-SAVE-SUMM
  5407         GO TO 4400-CONT
  5408     ELSE
  5409         PERFORM 7600-DELETE-SUMM  THRU  7699-EXIT.
  5410
  5411     MOVE SUMMNOI                 TO WS-SUMM-FOR-RQST.
  5412     PERFORM 6500-UPDATE-RQST  THRU  6599-EXIT.
  5413
  5414     IF SUMMNOI = SPACES
  5415         GO TO 4400-CONT.
  5416
  5417     MOVE SUMMNOI                 TO PI-AR-SUMMARY-CODE.
  5418     PERFORM 7500-UPDATE-SUMM  THRU  7599-EXIT.
  5419
  5420 4400-CONT.
  5421     PERFORM 8000-UPDATE-MAINT-DATE  THRU  8000-EXIT.
  5422
  5423     MOVE ER-0000                TO  EMI-ERROR.
  5424     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5425
  5426     MOVE LOW-VALUES             TO  EL652AO.
  5427     MOVE PI-ERC-CARRIER         TO  CARRIERO.
  5428     MOVE PI-ERC-TYPE            TO  TYPEO.
  5429     MOVE AL-UANON               TO  CARRIERA
  5430                                     TYPEA.
  5431
  5432     IF PI-ERC-GROUP NOT = SPACES
  5433         MOVE PI-ERC-GROUP       TO  GROUPO
  5434         MOVE AL-UANON           TO  GROUPA.
  5435
  5436     IF PI-ERC-RESP NOT = SPACES
  5437         MOVE PI-ERC-RESP        TO  FINRESPO
  5438         MOVE AL-UANON           TO  FINRESPA.
  5439
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 107
* EL652.cbl
  5440     IF PI-ERC-ACCT NOT = SPACES
  5441         MOVE PI-ERC-ACCT        TO  ACCTNOO
  5442         MOVE AL-UANON           TO  ACCTNOA.
  5443
  5444     GO TO 5000-BUILD-INITIAL-SCREEN.
  5445
  5446 4400-EXIT.
  5447     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 108
* EL652.cbl
  5449 4600-DELETE.
  5450     IF PI-ERCOMP-KEY = PI-SAVE-ERCOMP-KEY
  5451         NEXT SENTENCE
  5452     ELSE
  5453         MOVE ER-2056            TO  EMI-ERROR
  5454         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5455         MOVE -1                 TO  MAINTYPL
  5456         GO TO 8200-SEND-DATAONLY.
  5457
  5458     PERFORM 7200-READ-ERCOMP-UPDATE  THRU  7200-EXIT.
  5459
  5460     MOVE CO-AR-SUMMARY-CODE     TO  WS-SAVE-SUMM.
  5461
  5462     IF (CO-YTD-COM NOT = ZERO) OR
  5463        (CO-END-BAL NOT = ZERO)
  5464
  5465* EXEC CICS UNLOCK
  5466*            DATASET  (COMP-FILE-ID)
  5467*        END-EXEC
  5468*    MOVE '&*                    #   #00005208' TO DFHEIV0
  5469     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5470     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5471     MOVE X'2020233030303035323038' TO DFHEIV0(25:11)
  5472     CALL 'kxdfhei1' USING DFHEIV0,
  5473           COMP-FILE-ID,
  5474           DFHEIV99
  5475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5476         MOVE ER-2092            TO  EMI-ERROR
  5477         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5478         MOVE -1                 TO  MAINTYPL
  5479         GO TO 8200-SEND-DATAONLY.
  5480
  5481     MOVE 'D'                    TO  JP-RECORD-TYPE.
  5482     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5483     MOVE COMP-FILE-ID           TO  FILE-ID.
  5484
  5485     IF CO-LAST-MAINT-USER   = PI-UPDATE-BY OR
  5486        CO-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS
  5487         continue
  5488     ELSE
  5489
  5490* EXEC CICS UNLOCK
  5491*            DATASET  (COMP-FILE-ID)
  5492*        END-EXEC
  5493*    MOVE '&*                    #   #00005224' TO DFHEIV0
  5494     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5495     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5496     MOVE X'2020233030303035323234' TO DFHEIV0(25:11)
  5497     CALL 'kxdfhei1' USING DFHEIV0,
  5498           COMP-FILE-ID,
  5499           DFHEIV99
  5500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5501         MOVE ER-0068            TO  EMI-ERROR
  5502         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5503         GO TO 8200-SEND-DATAONLY
  5504     end-if
  5505     if pi-el652-del-sw = 'Y'
  5506        continue
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 109
* EL652.cbl
  5507     else
  5508        move 'Y'                 to pi-el652-del-sw
  5509        move er-1299             to emi-error
  5510        perform 9900-error-format thru 9900-exit
  5511        move spaces              to maintypo
  5512        MOVE -1                  TO MAINTypL
  5513        GO TO 8200-send-dataonly
  5514     end-if
  5515
  5516* EXEC CICS DELETE
  5517*        DATASET  (COMP-FILE-ID)
  5518*    END-EXEC
  5519*    MOVE '&(                    &   #00005241' TO DFHEIV0
  5520     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5521     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5522     MOVE X'2020233030303035323431' TO DFHEIV0(25:11)
  5523     CALL 'kxdfhei1' USING DFHEIV0,
  5524           COMP-FILE-ID,
  5525           DFHEIV99,
  5526           DFHEIV99,
  5527           DFHEIV99,
  5528           DFHEIV99
  5529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5530
  5531     PERFORM 8400-LOG-JOURNAL-RECORD
  5532     MOVE EIBDATE                TO  DC-JULIAN-YYDDD
  5533     MOVE '5'                    TO  DC-OPTION-CODE
  5534     MOVE LINK-ELDATCV           TO  PGM-NAME
  5535
  5536
  5537* EXEC CICS LINK
  5538*        PROGRAM   (PGM-NAME)
  5539*        COMMAREA  (DATE-CONVERSION-DATA)
  5540*        LENGTH    (DC-COMM-LENGTH)
  5541*    END-EXEC
  5542*    MOVE '."C                   (   #00005250' TO DFHEIV0
  5543     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5544     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5545     MOVE X'2020233030303035323530' TO DFHEIV0(25:11)
  5546     CALL 'kxdfhei1' USING DFHEIV0,
  5547           PGM-NAME,
  5548           DATE-CONVERSION-DATA,
  5549           DC-COMM-LENGTH,
  5550           DFHEIV99,
  5551           DFHEIV99,
  5552           DFHEIV99,
  5553           DFHEIV99
  5554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5555
  5556     MOVE DC-BIN-DATE-1          TO  BIN-CURRENT-SAVE
  5557
  5558     PERFORM 8000-UPDATE-MAINT-DATE  THRU  8000-EXIT
  5559
  5560     MOVE ER-0000                TO  EMI-ERROR
  5561     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5562
  5563     IF PI-AR-PROCESSING
  5564         IF WS-SAVE-SUMM NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 110
* EL652.cbl
  5565             PERFORM 7600-DELETE-SUMM  THRU  7699-EXIT
  5566             MOVE SPACES         TO  WS-SUMM-FOR-RQST
  5567             PERFORM  6500-UPDATE-RQST  THRU  6599-EXIT
  5568         end-if
  5569     end-if
  5570
  5571     MOVE LOW-VALUES             TO  EL652AO
  5572     MOVE PI-ERC-CARRIER         TO  CARRIERO
  5573     MOVE PI-ERC-TYPE            TO  TYPEO
  5574     MOVE AL-UANON               TO  CARRIERA
  5575                                     TYPEA
  5576
  5577     IF PI-ERC-GROUP NOT = SPACES
  5578         MOVE PI-ERC-GROUP       TO  GROUPO
  5579         MOVE AL-UANON           TO  GROUPA
  5580     end-if
  5581
  5582     IF PI-ERC-RESP NOT = SPACES
  5583         MOVE PI-ERC-RESP        TO  FINRESPO
  5584         MOVE AL-UANON           TO  FINRESPA
  5585     end-if
  5586
  5587     IF PI-ERC-ACCT NOT = SPACES
  5588         MOVE PI-ERC-ACCT        TO  ACCTNOO
  5589         MOVE AL-UANON           TO  ACCTNOA
  5590     end-if
  5591
  5592     MOVE LOW-VALUES             TO  PI-SAVE-ERCOMP-KEY
  5593
  5594     GO TO 8100-SEND-INITIAL-MAP
  5595     .
  5596 4600-EXIT.
  5597     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 111
* EL652.cbl
  5599
  5600 4700-CHECK-STATE.
  5601     IF CLPSTI =  SPACES
  5602         GO TO 4799-EXIT
  5603     END-IF.
  5604
  5605     MOVE SPACES                 TO  ELCNTL-KEY2.
  5606     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID-2.
  5607     MOVE '3'                    TO  CNTL-REC-TYPE-2.
  5608     MOVE CLPSTI                 TO  CNTL-STATE-2.
  5609     MOVE +0                     TO  CNTL-SEQ-NO-2.
  5610
  5611
  5612* EXEC CICS  HANDLE CONDITION
  5613*        NOTFND  (4750-NO-STATE)
  5614*    END-EXEC.
  5615*    MOVE '"$I                   ! ) #00005311' TO DFHEIV0
  5616     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5617     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5618     MOVE X'2920233030303035333131' TO DFHEIV0(25:11)
  5619     CALL 'kxdfhei1' USING DFHEIV0
  5620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5621
  5622
  5623
  5624* EXEC CICS  READ
  5625*        DATASET  (CNTL-FILE-ID)
  5626*        SET      (ADDRESS OF CONTROL-FILE)
  5627*        RIDFLD   (ELCNTL-KEY2)
  5628*    END-EXEC.
  5629*    MOVE '&"S        E          (   #00005315' TO DFHEIV0
  5630     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5631     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5632     MOVE X'2020233030303035333135' TO DFHEIV0(25:11)
  5633     CALL 'kxdfhei1' USING DFHEIV0,
  5634           CNTL-FILE-ID,
  5635           DFHEIV20,
  5636           DFHEIV99,
  5637           ELCNTL-KEY2,
  5638           DFHEIV99,
  5639           DFHEIV99,
  5640           DFHEIV99
  5641     SET ADDRESS OF CONTROL-FILE TO
  5642         DFHEIV20
  5643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5644
  5645
  5646     GO TO 4799-EXIT.
  5647
  5648 4750-NO-STATE.
  5649     MOVE ER-0144                TO  EMI-ERROR.
  5650     MOVE -1                     TO  CLPSTL.
  5651     MOVE AL-UABON               TO  CLPSTA.
  5652
  5653     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5654
  5655 4799-EXIT.
  5656     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 112
* EL652.cbl
  5657
  5658 5000-BUILD-INITIAL-SCREEN.
  5659     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  5660
  5661     PERFORM 7050-READ-ERCOMP  THRU  7050-EXIT.
  5662
  5663     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  5664     MOVE CO-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  5665
  5666     IF CO-LAST-MAINT-HHMMSS NUMERIC
  5667        MOVE CO-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS
  5668        ELSE
  5669        MOVE ZEROS                  TO  PI-UPDATE-HHMMSS.
  5670
  5671 5050-SET-UP-SCREEN.
  5672     MOVE CO-CONTROL-NAME        TO  PCONTO.
  5673     MOVE CO-MAIL-NAME           TO  MAILNAMO.
  5674     MOVE CO-ACCT-NAME           TO  ACCTNAMO.
  5675     MOVE CO-ACCT-NAME           TO  PI-SAVE-ACCT-NAME.
  5676     MOVE CO-ADDR-1              TO  ADDR1O.
  5677     MOVE CO-ADDR-2              TO  ADDR2O
  5678                                     PI-SAVE-ADDR2
  5679     MOVE CO-ADDR-CITY           TO  CITYO
  5680                                     PI-SAVE-CITY
  5681     MOVE CO-ADDR-STATE          TO  STATEO
  5682                                     PI-SAVE-STATE
  5683     MOVE SPACES                 TO  WS-ZIP-CODE.
  5684
  5685     IF CO-CANADIAN-POST-CODE
  5686         MOVE CO-CAN-POSTAL-1    TO  WS-ZIP-CAN-2-POST1
  5687         MOVE CO-CAN-POSTAL-2    TO  WS-ZIP-CAN-2-POST2
  5688     ELSE
  5689         MOVE CO-ZIP-PRIME       TO  WS-ZIP-AM-2-CODE
  5690         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  5691             MOVE '-'            TO  WS-ZIP-AM-2-DASH
  5692             MOVE CO-ZIP-PLUS4   TO  WS-ZIP-AM-2-PLUS4.
  5693
  5694     MOVE WS-ZIP-CODE            TO  ZIPCODEO.
  5695
  5696     IF CO-BILL-SW = ' ' OR 'B' OR 'R' OR 'T' OR 'S'
  5697        OR 'O' OR 'E' OR 'C'
  5698         MOVE AL-UANON           TO  BILLPRTA
  5699         MOVE CO-BILL-SW         TO  BILLPRTO
  5700     END-IF.
  5701
  5702     MOVE CO-CSO-1099            TO  PNT1099O.
  5703
  5704     MOVE CO-CSR-CODE            TO  CSRO.
  5705
  5706     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
  5707        AND (CO-TYPE = 'A')
  5708        IF CO-COMP-TYPE = '1'
  5709           MOVE 'Y'              TO SPPDDO
  5710        ELSE
  5711           MOVE 'N'              TO SPPDDO
  5712        END-IF
  5713     END-IF
  5714     MOVE CO-SOC-SEC             TO  SSNO.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 113
* EL652.cbl
  5715
  5716     MOVE CO-BALANCE-CONTROL     TO  CARBALO.
  5717
  5718     IF PI-AR-PROCESSING
  5719         IF CO-AR-SUMMARY-CODE > SPACES
  5720             MOVE AL-UANON       TO  SUMMNOA
  5721             MOVE CO-AR-SUMMARY-CODE
  5722                                 TO  SUMMNOO
  5723         ELSE
  5724             MOVE LOW-VALUES     TO  SUMMNOO.
  5725
  5726     IF PI-AR-PROCESSING
  5727        IF NOT CO-ACCOUNT-TYPE
  5728           MOVE AL-SADOF         TO SCDESCA
  5729           MOVE AL-SANOF         TO SUMMNOA
  5730        ELSE
  5731           MOVE AL-UANOF         TO SUMMNOA.
  5732
  5733     IF PI-AR-PROCESSING
  5734*        MOVE CO-AR-BAL-LEVEL    TO  ARBALO
  5735         MOVE CO-AR-PULL-CHECK   TO  CKPULLO.
  5736
  5737     IF PI-AR-PROCESSING
  5738         IF CO-ACCOUNT-TYPE
  5739             MOVE CO-AR-REPORTING
  5740                                 TO  NETGRSO
  5741         ELSE
  5742             MOVE SPACES         TO  NETGRSO.
  5743
  5744     MOVE SPACES                 TO  FLITYPO.
  5745
  5746     IF CO-COMPANY-TYPE
  5747         MOVE SPACES             TO  RPTCD2O
  5748         MOVE AL-SADOF           TO  RPTCDDA.
  5749
  5750     MOVE SPACES                 TO  LETRCDO.
  5751     MOVE AL-SADOF               TO  LETDESCA.
  5752     MOVE SPACES                 TO  BALCDO.
  5753     MOVE AL-SADOF               TO  BALPRTA.
  5754     MOVE CO-CLP-STATE           TO  CLPSTO.
  5755     MOVE CO-MAX-BANK-FEE        TO  MAXFEEO
  5756     MOVE CO-SPP-REFUND-EDIT     TO  REFEO
  5757     IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  5758        MOVE +0                  TO CO-MAX-BANK-FEE-LEASE
  5759     END-IF
  5760     MOVE CO-MAX-BANK-FEE-LEASE  TO  MAXLFO
  5761     .
  5762 5060-BUILD-TOTALS.
  5763     IF SHOW-SAVE-TOTALS
  5764         NEXT SENTENCE
  5765     ELSE
  5766         GO TO 5070-BUILD-CURRENT-TOTALS.
  5767
  5768     IF CO-LAST-STMT-DT = SPACES
  5769         MOVE SPACES             TO  LSTMDTO
  5770         GO TO 5060-LST-STMT-OK.
  5771
  5772     MOVE CO-LAST-STMT-MONTH     TO  WS-YMD-MM.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 114
* EL652.cbl
  5773     MOVE CO-LAST-STMT-DAY       TO  WS-YMD-DD.
  5774     MOVE CO-LAST-STMT-YEAR      TO  WS-YMD-YY.
  5775
  5776     IF WS-YMD-DATE-NUM NUMERIC
  5777         NEXT SENTENCE
  5778     ELSE
  5779         MOVE SPACES             TO  LSTMDTO
  5780         GO TO 5060-LST-STMT-OK.
  5781
  5782     MOVE WS-YMD-DATE            TO  DC-GREG-DATE-1-YMD.
  5783     MOVE '3'                    TO  DC-OPTION-CODE.
  5784
  5785     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  5786
  5787     IF NO-CONVERSION-ERROR
  5788         NEXT SENTENCE
  5789     ELSE
  5790         MOVE SPACES             TO  LSTMDTO
  5791         GO TO 5060-LST-STMT-OK.
  5792
  5793     MOVE CO-LAST-STMT-MONTH     TO  WS-DMDY8-MM.
  5794     MOVE CO-LAST-STMT-DAY       TO  WS-DMDY8-DD.
  5795     MOVE CO-LAST-STMT-YEAR      TO  WS-DMDY8-YY.
  5796     MOVE '/'                    TO  WS-DMDY8-SL1
  5797                                     WS-DMDY8-SL2.
  5798     MOVE WS-DATE-MDY-8          TO  LSTMDTO.
  5799
  5800 5060-LST-STMT-OK.
  5801     MOVE CO-BAL-FWD             TO  BALFWDO.
  5802     MOVE CO-CUR-COM             TO  CURCOMO.
  5803     MOVE CO-CUR-PMT             TO  CURPMTO.
  5804     MOVE CO-CUR-CHG             TO  CURCHGO.
  5805     MOVE CO-END-BAL             TO  ENDBALO.
  5806     MOVE CO-CUR                 TO  CURRENTO.
  5807     MOVE CO-OV30                TO  OVER30O.
  5808     MOVE CO-OV60                TO  OVER60O.
  5809     MOVE CO-OV90                TO  OVER90O.
  5810     if pi-company-id = 'AHL'
  5811        if co-ov120 not numeric
  5812           move zeros            to co-ov120
  5813        end-if
  5814        move co-ov120            to over120o
  5815     end-if
  5816     IF CO-ACCOUNT-TYPE
  5817        MOVE CO-YTD-COM          TO YTDCOMO
  5818     ELSE
  5819        MOVE CO-YTD-OV           TO YTDCOMO
  5820     END-IF
  5821
  5822     MOVE AL-SADOF               TO  PFK9A.
  5823     MOVE 'PREV. END-OF-MONTH TOTALS DISPLAYED'
  5824                                 TO  EMI-MESSAGE-AREA (1).
  5825
  5826     GO TO 5090-CONTD.
  5827
  5828 5070-BUILD-CURRENT-TOTALS.
  5829     IF CO-CURRENT-LAST-STMT-DT = SPACES
  5830         MOVE SPACES             TO  LSTMDTO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 115
* EL652.cbl
  5831         GO TO 5070-LST-STMT-OK.
  5832
  5833     MOVE CO-CURRENT-LAST-STMT-MONTH
  5834                                 TO WS-YMD-MM.
  5835     MOVE CO-CURRENT-LAST-STMT-DAY
  5836                                 TO  WS-YMD-DD.
  5837     MOVE CO-CURRENT-LAST-STMT-YEAR
  5838                                 TO  WS-YMD-YY.
  5839
  5840     IF WS-YMD-DATE-NUM NUMERIC
  5841         NEXT SENTENCE
  5842     ELSE
  5843         MOVE SPACES             TO  LSTMDTO
  5844         GO TO 5070-LST-STMT-OK.
  5845
  5846     MOVE WS-YMD-DATE            TO  DC-GREG-DATE-1-YMD.
  5847     MOVE '3'                    TO  DC-OPTION-CODE.
  5848
  5849     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  5850
  5851     IF NO-CONVERSION-ERROR
  5852         NEXT SENTENCE
  5853     ELSE
  5854         MOVE SPACES             TO  LSTMDTO
  5855         GO TO 5070-LST-STMT-OK.
  5856
  5857     MOVE CO-CURRENT-LAST-STMT-MONTH
  5858                                 TO  WS-DMDY8-MM.
  5859     MOVE CO-CURRENT-LAST-STMT-DAY
  5860                                 TO  WS-DMDY8-DD.
  5861     MOVE CO-CURRENT-LAST-STMT-YEAR
  5862                                 TO  WS-DMDY8-YY.
  5863     MOVE '/'                    TO  WS-DMDY8-SL1
  5864                                     WS-DMDY8-SL2.
  5865     MOVE WS-DATE-MDY-8          TO  LSTMDTO.
  5866
  5867 5070-LST-STMT-OK.
  5868     MOVE CO-CURRENT-BAL-FWD     TO  BALFWDO.
  5869     MOVE CO-CURRENT-CUR-COM     TO  CURCOMO.
  5870     MOVE CO-CURRENT-CUR-PMT     TO  CURPMTO.
  5871     MOVE CO-CURRENT-CUR-CHG     TO  CURCHGO.
  5872     MOVE CO-CURRENT-END-BAL     TO  ENDBALO
  5873                                     PI-ERC-END-BAL.
  5874     MOVE CO-CURRENT-CUR         TO  CURRENTO.
  5875     MOVE CO-CURRENT-OV30        TO  OVER30O.
  5876     MOVE CO-CURRENT-OV60        TO  OVER60O.
  5877     MOVE CO-CURRENT-OV90        TO  OVER90O.
  5878     if pi-company-id = 'AHL'
  5879        if co-current-ov120 not numeric
  5880           move zeros            to co-current-ov120
  5881        end-if
  5882        move co-current-ov120    to over120o
  5883     end-if
  5884     IF CO-ACCOUNT-TYPE
  5885        MOVE CO-CURRENT-YTD-COM  TO YTDCOMO
  5886     ELSE
  5887        MOVE CO-CURRENT-YTD-OV   TO YTDCOMO
  5888     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 116
* EL652.cbl
  5889     .
  5890 5090-CONTD.
  5891
  5892     MOVE CO-LAST-MAINT-USER     TO LSTUSRO.
  5893
  5894     MOVE ' '              TO DC-OPTION-CODE.
  5895     MOVE CO-LAST-MAINT-DT TO DC-BIN-DATE-1.
  5896
  5897     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  5898
  5899     MOVE DC-GREG-DATE-1-EDIT    TO LSTDTEO.
  5900
  5901     IF CO-LAST-MAINT-HHMMSS NUMERIC
  5902         MOVE CO-LAST-MAINT-HHMMSS
  5903                                 TO TIME-IN
  5904         MOVE TIME-OUT           TO LSTTIMEO
  5905     ELSE
  5906         MOVE ZEROS              TO TIME-IN
  5907         MOVE TIME-OUT           TO LSTTIMEO.
  5908
  5909     IF PI-COMPANY-ID =  'FLI'  OR  'FLU'  OR  'UCL'
  5910         MOVE AL-SANOF           TO  FLITYPEA
  5911         MOVE AL-UANON           TO  FLITYPA
  5912     ELSE
  5913         MOVE AL-SANON           TO  FLITYPA.
  5914
  5915     IF PI-COMPANY-ID = 'NCL'
  5916         IF CO-ACCOUNT-TYPE
  5917             MOVE AL-SANOF       TO  RPTCD2A
  5918         ELSE
  5919             IF CO-COMPANY-TYPE
  5920                MOVE AL-SANOF    TO  RPTCD2A
  5921                MOVE AL-SADOF    TO  RPTCDDA.
  5922
  5923     IF PI-COMPANY-ID = 'NCL'
  5924         IF CO-GEN-AGENT-TYPE
  5925            MOVE AL-UANON       TO  RPTCD2A.
  5926
  5927     IF PI-COMPANY-ID = 'NCL'
  5928         MOVE AL-UANON           TO  LETRCDA
  5929     ELSE
  5930         MOVE AL-SANOF           TO  LETRCDA
  5931         MOVE AL-SADOF           TO  LETDESCA.
  5932
  5933     IF PI-COMPANY-ID  NOT =  'DDB' AND 'ANT' AND 'ASL' AND
  5934                              'AN1' AND 'TFS'
  5935         MOVE AL-SANOF           TO  BALCDA
  5936         MOVE AL-SADOF           TO  BALPRTA.
  5937
  5938     IF PI-AR-PROCESSING
  5939         IF CO-ACCOUNT-TYPE
  5940             MOVE AL-SANOF       TO  SCDESCA
  5941             MOVE AL-SANOF       TO  NGDESCA
  5942             MOVE AL-UANON       TO  NETGRSA
  5943             IF PI-COMPANY-ID  =  'DDB' OR 'ANT' OR 'ASL' OR
  5944                                  'AN1' OR 'TFS'
  5945                 MOVE AL-SANOF   TO  BALPRTA
  5946                 MOVE AL-UANON   TO  BALCDA.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 117
* EL652.cbl
  5947
  5948     IF PI-AR-PROCESSING
  5949*            MOVE AL-SANOF       TO  BALDESCA
  5950             move al-sanof       to  CKDESCA
  5951*            MOVE AL-UANON       TO  ARBALA
  5952             move al-uanon       to  CKPULLA.
  5953
  5954
  5955     MOVE AL-UANON               TO  MAILNAMA
  5956                                     ACCTNAMA
  5957                                     ADDR1A
  5958                                     ADDR2A
  5959                                     CITYA
  5960                                     STATEA
  5961                                     SSNA
  5962                                     ZIPCODEA
  5963                                     BILLPRTA
  5964                                     PNT1099A
  5965                                     CARBALA.
  5966
  5967     IF NOT SHOW-SAVE-TOTALS
  5968         IF PI-PROCESSOR-ID = 'LGXX'
  5969             GO TO 5100-CONTD.
  5970
  5971     MOVE AL-SANOF               TO  BALFWDA
  5972                                     CURCOMA
  5973                                     CURPMTA
  5974                                     CURCHGA
  5975                                     ENDBALA.
  5976
  5977 5100-CONTD.
  5978     IF CO-TELEPHONE NUMERIC
  5979         MOVE CO-TELEPHONE       TO  WS-PHONE-IN
  5980                                     PI-SAVE-PHONE
  5981         MOVE WSPI-AREA          TO  WSPO-AREA
  5982         MOVE WSPI-PFX           TO  WSPO-PFX
  5983         MOVE WSPI-SFX           TO  WSPO-SFX
  5984         MOVE WS-PHONE-OUT       TO  PHONEO
  5985         MOVE AL-UNNON           TO  PHONEA
  5986     ELSE
  5987         MOVE SPACES             TO  PHONEO.
  5988
  5989     IF CO-FAXNO NUMERIC
  5990         MOVE CO-FAXNO           TO  WS-PHONE-IN
  5991                                     PI-SAVE-FAXNO
  5992         MOVE WSPI-AREA          TO  WSPO-AREA
  5993         MOVE WSPI-PFX           TO  WSPO-PFX
  5994         MOVE WSPI-SFX           TO  WSPO-SFX
  5995         MOVE WS-PHONE-OUT       TO  FAXNOO
  5996         MOVE AL-UNNON           TO  FAXNOA
  5997     ELSE
  5998         MOVE SPACES             TO  FAXNOO.
  5999
  6000     MOVE 'S'                    TO  MAINTYPO
  6001                                     PI-CHECK-MAINT-TYPE.
  6002     MOVE AL-UANON               TO  MAINTYPA.
  6003     MOVE -1                     TO  MAINTYPL.
  6004
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 118
* EL652.cbl
  6005     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 119
* EL652.cbl
  6007 6000-CHECK-FOR-UPDATE.
  6008     IF CHANGE-FUNCTION
  6009         GO TO 6010-CONT.
  6010
  6011     IF CARRIERL > ZERO
  6012         MOVE CARRIERI           TO  CO-CARRIER.
  6013
  6014     IF GROUPL > ZERO
  6015         MOVE GROUPI             TO  CO-GROUPING
  6016     ELSE
  6017         MOVE LOW-VALUES         TO  CO-GROUPING.
  6018
  6019     IF FINRESPL > ZERO
  6020         MOVE FINRESPI           TO  CO-RESP-NO
  6021     ELSE
  6022         MOVE LOW-VALUES         TO  CO-RESP-NO.
  6023
  6024     IF ACCTNOL > ZERO
  6025         MOVE ACCTNOI            TO  CO-ACCOUNT
  6026     ELSE
  6027         MOVE LOW-VALUES         TO  CO-ACCOUNT.
  6028
  6029     IF TYPEL > ZERO
  6030         MOVE TYPEI              TO  CO-TYPE.
  6031
  6032 6010-CONT.
  6033     IF PI-PROCESSOR-ID = 'LGXX'
  6034         IF LSTMDTL > ZERO
  6035             MOVE WS-YMD-YY      TO  CO-CURRENT-LAST-STMT-YEAR
  6036                                     WS-DMDY8-YY
  6037             MOVE WS-YMD-MM      TO  CO-CURRENT-LAST-STMT-MONTH
  6038                                     WS-DMDY8-MM
  6039             MOVE WS-YMD-DD      TO  CO-CURRENT-LAST-STMT-DAY
  6040                                     WS-DMDY8-DD
  6041             MOVE '/'            TO  WS-DMDY8-SL1  WS-DMDY8-SL2
  6042             MOVE WS-DATE-MDY-8  TO  LSTMDTO.
  6043
  6044     IF PI-AR-PROCESSING
  6045         IF TYPEI = 'A'
  6046             IF SUMMNOL > ZERO
  6047                 MOVE SUMMNOI   TO  CO-AR-SUMMARY-CODE
  6048                                    WS-SAVE-SUMMARY.
  6049
  6050     IF PI-AR-PROCESSING
  6051         IF TYPEI = 'A'
  6052             IF NETGRSL > ZERO
  6053                 MOVE NETGRSI   TO  CO-AR-REPORTING
  6054             ELSE
  6055                 IF ADD-FUNCTION
  6056                     MOVE 'G'   TO  CO-AR-REPORTING.
  6057
  6058     IF PI-AR-PROCESSING
  6059*        IF ARBALL > ZERO
  6060*            MOVE ARBALI        TO  CO-AR-BAL-LEVEL
  6061*        ELSE
  6062             IF ADD-FUNCTION
  6063                 MOVE '1'       TO  CO-AR-BAL-LEVEL.
  6064
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 120
* EL652.cbl
  6065     IF PI-AR-PROCESSING
  6066         IF CKPULLL > ZERO
  6067             MOVE CKPULLI       TO  CO-AR-PULL-CHECK
  6068         ELSE
  6069             IF ADD-FUNCTION
  6070                 MOVE 'Y'       TO  CO-AR-PULL-CHECK.
  6071
  6072     IF MAILNAML > ZERO
  6073         MOVE MAILNAMI           TO  CO-MAIL-NAME
  6074                                     WS-SAVE-NAME.
  6075
  6076     IF ACCTNAML > ZERO
  6077         MOVE ACCTNAMI           TO  CO-ACCT-NAME.
  6078
  6079     IF ADDR1L > ZERO
  6080         MOVE ADDR1I             TO  CO-ADDR-1.
  6081
  6082     IF ADDR2L > ZERO
  6083         MOVE ADDR2I             TO  CO-ADDR-2.
  6084
  6085     IF CITYL > ZERO
  6086         MOVE CITYI              TO  CO-ADDR-CITY.
  6087     IF STATEL > ZERO
  6088         MOVE STATEI             TO  CO-ADDR-STATE.
  6089
  6090     IF ZIPCODEL NOT > ZERO
  6091         GO TO 6015-CONT.
  6092
  6093     MOVE ZIPCODEI               TO  WS-ZIP-CODE.
  6094
  6095     IF WS-CANADIAN-ZIP
  6096         IF WS-ZIP-4 = SPACE  OR  '-'
  6097             MOVE WS-ZIP-CAN-2-POST1     TO  CO-CAN-POSTAL-1
  6098             MOVE WS-ZIP-CAN-2-POST2     TO  CO-CAN-POSTAL-2
  6099         ELSE
  6100             MOVE WS-ZIP-CAN-1-POST1     TO  CO-CAN-POSTAL-1
  6101             MOVE WS-ZIP-CAN-1-POST2     TO  CO-CAN-POSTAL-2
  6102     ELSE
  6103         IF WS-ZIP-6 = SPACE  OR  '-'
  6104             MOVE WS-ZIP-AM-2-CODE       TO  CO-ZIP-PRIME
  6105             MOVE WS-ZIP-AM-2-PLUS4      TO  CO-ZIP-PLUS4
  6106         ELSE
  6107             MOVE WS-ZIP-AM-1-CODE       TO  CO-ZIP-PRIME
  6108             MOVE WS-ZIP-AM-1-PLUS4      TO  CO-ZIP-PLUS4.
  6109
  6110 6015-CONT.
  6111     IF BILLPRTL > ZERO
  6112         IF BILLPRTI = ' ' OR 'B' OR 'R' OR 'T' OR 'S'
  6113            OR 'O' OR 'E' OR 'C'
  6114             MOVE  BILLPRTI          TO  CO-BILL-SW
  6115         ELSE
  6116             MOVE SPACES         TO  CO-BILL-SW
  6117                                     BILLPRTO
  6118         END-IF
  6119     END-IF.
  6120     IF SPPDDL > ZERO
  6121        IF SPPDDI = 'Y'
  6122           MOVE '1'              TO CO-COMP-TYPE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 121
* EL652.cbl
  6123        ELSE
  6124           MOVE ' '              TO CO-COMP-TYPE
  6125        END-IF
  6126     END-IF
  6127     IF PNT1099L > ZERO
  6128         IF PNT1099I = 'N' OR 'Y'
  6129             MOVE  PNT1099I      TO  CO-CSO-1099
  6130         ELSE
  6131             MOVE 'N'            TO  CO-CSO-1099
  6132                                     PNT1099O
  6133         END-IF
  6134     END-IF.
  6135
  6136     IF CSRL > ZERO
  6137         MOVE CSRI               TO  CO-CSR-CODE.
  6138
  6139     IF SSNL > ZERO
  6140         MOVE SSNI               TO  CO-SOC-SEC.
  6141
  6142     IF PHONEL > ZERO
  6143         MOVE PI-SAVE-PHONE      TO  CO-TELEPHONE
  6144         MOVE ZEROS              TO  PI-SAVE-PHONE.
  6145
  6146     IF FAXNOL > ZERO
  6147         MOVE PI-SAVE-FAXNO      TO  CO-FAXNO
  6148         MOVE ZEROS              TO  PI-SAVE-FAXNO.
  6149
  6150     IF PCONTL > ZEROS
  6151        MOVE PCONTI              TO CO-CONTROL-NAME
  6152     END-IF
  6153     IF CLPSTL > ZERO
  6154         MOVE CLPSTI             TO  CO-CLP-STATE
  6155     END-IF
  6156     IF REFEL > ZERO
  6157        MOVE REFEI               TO CO-SPP-REFUND-EDIT
  6158     END-IF
  6159     IF MAXFEEL > ZERO
  6160         MOVE MAXFEEI            TO  CO-MAX-BANK-FEE
  6161*        IF ADD-FUNCTION
  6162*           MOVE CO-MAX-BANK-FEE TO  CO-BANK-FEE
  6163*        ELSE
  6164*           IF CHANGE-FUNCTION
  6165*              PERFORM 6100-EDIT-ERAGTC
  6166*                                THRU 6100-EXIT
  6167*              IF WS-TOT-FEES > CO-MAX-BANK-FEE
  6168*                 MOVE ER-2717   TO EMI-ERROR
  6169*                 MOVE -1        TO MAXFEEL
  6170*                 MOVE AL-UABON  TO MAXFEEA
  6171*                 PERFORM 9900-ERROR-FORMAT
  6172*                                THRU 9900-EXIT
  6173*              ELSE
  6174*                 COMPUTE CO-BANK-FEE = CO-MAX-BANK-FEE
  6175*                    - WS-TOT-FEES
  6176*              END-IF
  6177*           END-IF
  6178*        END-IF
  6179     END-IF
  6180
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 122
* EL652.cbl
  6181     IF MAXLFL > ZERO
  6182         MOVE MAXLFI             TO CO-MAX-BANK-FEE-LEASE
  6183     END-IF
  6184     IF CARBALL > ZERO
  6185         MOVE CARBALI            TO  CO-BALANCE-CONTROL
  6186         GO TO 6020-CONT.
  6187
  6188     IF NOT PI-AR-PROCESSING
  6189         GO TO 6020-CONT.
  6190
  6191     IF ADD-FUNCTION
  6192        AND (TYPEI = 'G' OR 'B')
  6193         MOVE 'Y'                TO  CO-BALANCE-CONTROL
  6194         GO TO 6020-CONT.
  6195
  6196     IF ADD-FUNCTION
  6197         IF TYPEI = 'A'
  6198             IF FINRESPI = ACCTNOI
  6199                 MOVE 'Y'        TO  CO-BALANCE-CONTROL
  6200             ELSE
  6201                 MOVE 'N'        TO  CO-BALANCE-CONTROL.
  6202
  6203     IF ADD-FUNCTION AND TYPEI = 'C'
  6204         MOVE 'N'                TO  CO-BALANCE-CONTROL.
  6205
  6206 6020-CONT.
  6207     IF BALFWDL > ZERO
  6208         MOVE WS-SAVE-BALFWD     TO  CO-CURRENT-BAL-FWD.
  6209
  6210     IF CURCOML > ZERO
  6211         MOVE WS-SAVE-CURCOM     TO  CO-CURRENT-CUR-COM.
  6212
  6213     IF CURCHGL > ZERO
  6214         MOVE WS-SAVE-CURCHG     TO  CO-CURRENT-CUR-CHG.
  6215
  6216     IF CURPMTL > ZERO
  6217         MOVE WS-SAVE-CURPMT     TO  CO-CURRENT-CUR-PMT.
  6218
  6219     IF ENDBALL > ZERO
  6220         MOVE WS-SAVE-ENDBAL     TO  CO-CURRENT-END-BAL.
  6221
  6222*    IF YTDCOML > ZERO
  6223*       IF CO-ACCOUNT-TYPE
  6224*          MOVE WS-SAVE-YTDCOM   TO CO-CURRENT-YTD-COM
  6225*       ELSE
  6226*          MOVE WS-SAVE-YTDCOM   TO CO-CURRENT-YTD-OV
  6227*       END-IF
  6228*    END-IF
  6229     .
  6230 6099-EXIT.
  6231     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 123
* EL652.cbl
  6233 6100-EDIT-ERAGTC.
  6234
  6235* EXEC CICS READ
  6236*         SET     (ADDRESS OF AGENT-COMMISSIONS)
  6237*         DATASET ('ERAGTC')
  6238*         RIDFLD  (PI-ERCOMP-KEY)
  6239*         RESP    (WS-RESPONSE)
  6240*    END-EXEC
  6241     MOVE 'ERAGTC' TO DFHEIV1
  6242*    MOVE '&"S        E          (  N#00005909' TO DFHEIV0
  6243     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6244     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6245     MOVE X'204E233030303035393039' TO DFHEIV0(25:11)
  6246     CALL 'kxdfhei1' USING DFHEIV0,
  6247           DFHEIV1,
  6248           DFHEIV20,
  6249           DFHEIV99,
  6250           PI-ERCOMP-KEY,
  6251           DFHEIV99,
  6252           DFHEIV99,
  6253           DFHEIV99
  6254     SET ADDRESS OF AGENT-COMMISSIONS TO
  6255         DFHEIV20
  6256     MOVE EIBRESP  TO WS-RESPONSE
  6257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6258     MOVE +0                     TO WS-TOT-FEES
  6259     IF RESP-NORMAL
  6260        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6261           (S1 > +10)
  6262           COMPUTE WS-TOT-FEES = WS-TOT-FEES
  6263              + AG-SPP-FEES (S1)
  6264        END-PERFORM
  6265     END-IF
  6266     .
  6267 6100-EXIT.
  6268     EXIT.
  6269 6500-UPDATE-RQST.
  6270
  6271     MOVE LOW-VALUES             TO  ERRQST-KEY-3.
  6272     MOVE PI-ERC-COMPANY-CD      TO  RQST-COMP-ID.
  6273     MOVE PI-ERC-CARRIER         TO  RQST-CARRIER.
  6274     MOVE PI-ERC-GROUP           TO  RQST-GROUP.
  6275     MOVE PI-ERC-RESP            TO  RQST-FIN-RESP.
  6276     MOVE PI-ERC-ACCT            TO  RQST-ACCT-AGENT.
  6277
  6278
  6279* EXEC CICS HANDLE CONDITION
  6280*        ENDFILE  (6550-END-BROWSE)
  6281*        NOTFND   (6550-END-BROWSE)
  6282*    END-EXEC.
  6283*    MOVE '"$''I                  ! * #00005935' TO DFHEIV0
  6284     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6285     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6286     MOVE X'2A20233030303035393335' TO DFHEIV0(25:11)
  6287     CALL 'kxdfhei1' USING DFHEIV0
  6288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6289
  6290
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 124
* EL652.cbl
  6291
  6292* EXEC CICS STARTBR
  6293*        DATASET  (RQST-FILE-ID-3)
  6294*        RIDFLD   (ERRQST-KEY-3)
  6295*    END-EXEC.
  6296     MOVE 0
  6297       TO DFHEIV11
  6298*    MOVE '&,         G          &   #00005940' TO DFHEIV0
  6299     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6300     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6301     MOVE X'2020233030303035393430' TO DFHEIV0(25:11)
  6302     CALL 'kxdfhei1' USING DFHEIV0,
  6303           RQST-FILE-ID-3,
  6304           ERRQST-KEY-3,
  6305           DFHEIV99,
  6306           DFHEIV11,
  6307           DFHEIV99
  6308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6309
  6310
  6311 6525-READ-LOOP.
  6312
  6313* EXEC CICS HANDLE CONDITION
  6314*        ENDFILE  (6550-END-BROWSE)
  6315*        NOTFND   (6550-END-BROWSE)
  6316*    END-EXEC.
  6317*    MOVE '"$''I                  ! + #00005946' TO DFHEIV0
  6318     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6319     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6320     MOVE X'2B20233030303035393436' TO DFHEIV0(25:11)
  6321     CALL 'kxdfhei1' USING DFHEIV0
  6322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6323
  6324
  6325
  6326* EXEC CICS READNEXT
  6327*        DATASET  (RQST-FILE-ID-3)
  6328*        SET      (ADDRESS OF AR-REQUEST-RECORD)
  6329*        RIDFLD   (ERRQST-KEY-3)
  6330*    END-EXEC.
  6331     MOVE 0
  6332       TO DFHEIV11
  6333*    MOVE '&.S                   )   #00005951' TO DFHEIV0
  6334     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6335     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6336     MOVE X'2020233030303035393531' TO DFHEIV0(25:11)
  6337     CALL 'kxdfhei1' USING DFHEIV0,
  6338           RQST-FILE-ID-3,
  6339           DFHEIV20,
  6340           DFHEIV99,
  6341           ERRQST-KEY-3,
  6342           DFHEIV99,
  6343           DFHEIV11,
  6344           DFHEIV99,
  6345           DFHEIV99
  6346     SET ADDRESS OF AR-REQUEST-RECORD TO
  6347         DFHEIV20
  6348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 125
* EL652.cbl
  6349
  6350
  6351     IF RQ-CONTROL-BY-FIN-RESP = WS-SAVE-RQST
  6352         GO TO 6525-READ-LOOP.
  6353
  6354     IF RQ-COMPANY-CD-A2 =  PI-ERC-COMPANY-CD AND
  6355        RQ-CARRIER-A2    =  PI-ERC-CARRIER    AND
  6356        RQ-GROUPING-A2   =  PI-ERC-GROUP      AND
  6357        RQ-FIN-RESP-A2   =  PI-ERC-RESP       AND
  6358        RQ-ACCT-AGENT-A2 =  PI-ERC-ACCT
  6359         NEXT SENTENCE
  6360     ELSE
  6361         GO TO 6550-END-BROWSE.
  6362
  6363     IF WS-SUMM-FOR-RQST = RQ-SUMMARY-CODE
  6364         GO TO 6525-READ-LOOP.
  6365
  6366     MOVE RQ-CONTROL-BY-FIN-RESP TO  WS-SAVE-RQST.
  6367     MOVE RQ-CONTROL-PRIMARY     TO  ERRQST-KEY.
  6368
  6369
  6370* EXEC CICS ENDBR
  6371*        DATASET  (RQST-FILE-ID-3)
  6372*    END-EXEC.
  6373     MOVE 0
  6374       TO DFHEIV11
  6375*    MOVE '&2                    $   #00005975' TO DFHEIV0
  6376     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6377     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6378     MOVE X'2020233030303035393735' TO DFHEIV0(25:11)
  6379     CALL 'kxdfhei1' USING DFHEIV0,
  6380           RQST-FILE-ID-3,
  6381           DFHEIV11,
  6382           DFHEIV99
  6383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6384
  6385
  6386
  6387* EXEC CICS HANDLE CONDITION
  6388*        ENDFILE  (6599-EXIT)
  6389*        NOTFND   (6599-EXIT)
  6390*    END-EXEC.
  6391*    MOVE '"$''I                  ! , #00005979' TO DFHEIV0
  6392     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6393     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6394     MOVE X'2C20233030303035393739' TO DFHEIV0(25:11)
  6395     CALL 'kxdfhei1' USING DFHEIV0
  6396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6397
  6398
  6399
  6400* EXEC CICS READ
  6401*        DATASET  (RQST-FILE-ID)
  6402*        SET      (ADDRESS OF AR-REQUEST-RECORD)
  6403*        RIDFLD   (ERRQST-KEY)
  6404*        UPDATE
  6405*    END-EXEC.
  6406*    MOVE '&"S        EU         (   #00005984' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 126
* EL652.cbl
  6407     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6408     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6409     MOVE X'2020233030303035393834' TO DFHEIV0(25:11)
  6410     CALL 'kxdfhei1' USING DFHEIV0,
  6411           RQST-FILE-ID,
  6412           DFHEIV20,
  6413           DFHEIV99,
  6414           ERRQST-KEY,
  6415           DFHEIV99,
  6416           DFHEIV99,
  6417           DFHEIV99
  6418     SET ADDRESS OF AR-REQUEST-RECORD TO
  6419         DFHEIV20
  6420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6421
  6422
  6423     MOVE WS-SUMM-FOR-RQST       TO  RQ-SUMMARY-CODE.
  6424
  6425
  6426* EXEC CICS REWRITE
  6427*        DATASET  (RQST-FILE-ID)
  6428*        FROM     (AR-REQUEST-RECORD)
  6429*    END-EXEC.
  6430     MOVE LENGTH OF
  6431      AR-REQUEST-RECORD
  6432       TO DFHEIV11
  6433*    MOVE '&& L                  %   #00005993' TO DFHEIV0
  6434     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6435     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6436     MOVE X'2020233030303035393933' TO DFHEIV0(25:11)
  6437     CALL 'kxdfhei1' USING DFHEIV0,
  6438           RQST-FILE-ID,
  6439           AR-REQUEST-RECORD,
  6440           DFHEIV11,
  6441           DFHEIV99
  6442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6443
  6444
  6445     GO TO 6500-UPDATE-RQST.
  6446
  6447 6550-END-BROWSE.
  6448
  6449
  6450* EXEC CICS ENDBR
  6451*        DATASET  (RQST-FILE-ID-3)
  6452*    END-EXEC.
  6453     MOVE 0
  6454       TO DFHEIV11
  6455*    MOVE '&2                    $   #00006002' TO DFHEIV0
  6456     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6457     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6458     MOVE X'2020233030303036303032' TO DFHEIV0(25:11)
  6459     CALL 'kxdfhei1' USING DFHEIV0,
  6460           RQST-FILE-ID-3,
  6461           DFHEIV11,
  6462           DFHEIV99
  6463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6464
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 127
* EL652.cbl
  6465
  6466 6599-EXIT.
  6467     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 128
* EL652.cbl
  6469
  6470 7000-EDIT.
  6471     MOVE LSTMDTI                TO  WS-DATE-MDY-8.
  6472
  6473     IF LSTMDTL > ZERO
  6474         NEXT SENTENCE
  6475     ELSE
  6476         GO TO 7100-EDIT-CONTD.
  6477
  6478     IF LSTMDTI = SPACES
  6479         GO TO 7100-EDIT-CONTD.
  6480
  6481     IF WS-DMDY8-SL1 = '/'  AND
  6482        WS-DMDY8-SL2 = '/'
  6483         MOVE WS-DMDY8-MM        TO  WS-YMD-MM
  6484         MOVE WS-DMDY8-DD        TO  WS-YMD-DD
  6485         MOVE WS-DMDY8-YY        TO  WS-YMD-YY
  6486     ELSE
  6487         MOVE WS-DMDY6-MM        TO  WS-YMD-MM
  6488         MOVE WS-DMDY6-DD        TO  WS-YMD-DD
  6489         MOVE WS-DMDY6-YY        TO  WS-YMD-YY.
  6490
  6491     MOVE WS-YMD-DATE            TO  DC-GREG-DATE-1-YMD.
  6492     MOVE '3'                    TO  DC-OPTION-CODE.
  6493
  6494     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  6495
  6496     IF NO-CONVERSION-ERROR
  6497         NEXT SENTENCE
  6498     ELSE
  6499         GO TO 7090-DATE-ERROR.
  6500
  6501     IF DC-BIN-DATE-1 > PI-CR-MONTH-END-DT
  6502         NEXT SENTENCE
  6503     ELSE
  6504         GO TO 7100-EDIT-CONTD.
  6505
  6506 7090-DATE-ERROR.
  6507     MOVE -1                     TO  LSTMDTL.
  6508     MOVE AL-UABON               TO  LSTMDTA.
  6509     MOVE ER-0314                TO  EMI-ERROR.
  6510
  6511     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6512
  6513 7100-EDIT-CONTD.
  6514
  6515     IF CSRL > ZEROS
  6516         MOVE AL-UANON           TO  CSRA
  6517     END-IF
  6518
  6519     IF MAILNAML > ZERO
  6520         MOVE AL-UANON           TO  MAILNAMA.
  6521
  6522     IF SSNL > ZERO
  6523         MOVE AL-UANON           TO  SSNA.
  6524
  6525     IF ACCTNAML > ZERO
  6526         MOVE AL-UANON           TO  ACCTNAMA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 129
* EL652.cbl
  6527     ELSE
  6528         IF ADD-FUNCTION
  6529             MOVE -1             TO  ACCTNAML
  6530             MOVE AL-UABON       TO  ACCTNAMA
  6531             MOVE ER-2045        TO  EMI-ERROR
  6532             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6533
  6534     IF PHONEL > ZERO
  6535         MOVE PHONEI               TO  DEEDIT-FIELD
  6536         PERFORM 7100-DEEDIT  THRU  7100-EXIT
  6537         IF DEEDIT-FIELD-V0 = ZEROS
  6538             MOVE SPACES               TO  PHONEO
  6539                                           PI-SAVE-PHONE
  6540         ELSE
  6541             IF (DEEDIT-FIELD-V0 > 9999999999
  6542               OR < 2000000000)
  6543                 MOVE -1               TO  PHONEL
  6544                 MOVE AL-UNBON         TO  PHONEA
  6545                 MOVE ER-2046          TO  EMI-ERROR
  6546                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6547             ELSE
  6548                 MOVE DEEDIT-FIELD-V0  TO  WS-PHONE-IN
  6549                                           PI-SAVE-PHONE-RED
  6550                 MOVE WSPI-AREA        TO  WSPO-AREA
  6551                 MOVE WSPI-PFX         TO  WSPO-PFX
  6552                 MOVE WSPI-SFX         TO  WSPO-SFX
  6553                 MOVE WS-PHONE-OUT     TO  PHONEO
  6554                 MOVE AL-UNNON         TO  PHONEA.
  6555
  6556     IF FAXNOL > ZERO
  6557         MOVE FAXNOI               TO  DEEDIT-FIELD
  6558         PERFORM 7100-DEEDIT  THRU  7100-EXIT
  6559         IF DEEDIT-FIELD-V0 = ZEROS
  6560             MOVE SPACES               TO  FAXNOO
  6561                                           PI-SAVE-FAXNO
  6562         ELSE
  6563             IF (DEEDIT-FIELD-V0 > 9999999999
  6564               OR < 2000000000)
  6565                 MOVE -1               TO  FAXNOL
  6566                 MOVE AL-UNBON         TO  FAXNOA
  6567                 MOVE ER-3055          TO  EMI-ERROR
  6568                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6569             ELSE
  6570                 MOVE DEEDIT-FIELD-V0  TO  WS-PHONE-IN
  6571                                           PI-SAVE-FAXNO-RED
  6572                 MOVE WSPI-AREA        TO  WSPO-AREA
  6573                 MOVE WSPI-PFX         TO  WSPO-PFX
  6574                 MOVE WSPI-SFX         TO  WSPO-SFX
  6575                 MOVE WS-PHONE-OUT     TO  FAXNOO
  6576                 MOVE AL-UNNON         TO  FAXNOA.
  6577
  6578     IF ADDR1L > ZERO
  6579         MOVE AL-UANON           TO  ADDR1A
  6580     ELSE
  6581         IF ADD-FUNCTION
  6582             MOVE -1             TO  ADDR1L
  6583             MOVE AL-UABON       TO  ADDR1A
  6584             MOVE ER-2047        TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 130
* EL652.cbl
  6585             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6586
  6587     IF ADDR2L > ZERO
  6588         MOVE AL-UANON           TO  ADDR2A.
  6589
  6590     IF CARBALL > ZERO OR CHANGE-FUNCTION
  6591         MOVE CARBALI            TO  PI-CHECK-CARRY-BAL
  6592         IF VALID-CARRY-BAL
  6593             PERFORM 7010-EDIT-CARBAL  THRU  7010-EXIT
  6594         ELSE
  6595             MOVE -1             TO  CARBALL
  6596             MOVE AL-UABON       TO  CARBALA
  6597             MOVE ER-2048        TO  EMI-ERROR
  6598             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6599     ELSE
  6600         IF ADD-FUNCTION AND NOT PI-AR-PROCESSING
  6601             MOVE -1             TO  CARBALL
  6602             MOVE AL-UABON       TO  CARBALA
  6603             MOVE ER-2048        TO  EMI-ERROR
  6604             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6605
  6606     IF PI-AR-PROCESSING
  6607         IF TYPEI = 'A'
  6608            IF NETGRSL > ZERO OR CHANGE-FUNCTION
  6609                 IF NETGRSI = 'N' OR 'G'
  6610                    MOVE AL-UANON    TO  NETGRSA
  6611                 ELSE
  6612                     MOVE -1         TO  NETGRSL
  6613                     MOVE AL-UABON   TO  NETGRSA
  6614                     MOVE ER-3151    TO  EMI-ERROR
  6615                     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6616
  6617     IF CITYL > ZERO
  6618         MOVE AL-UANON           TO  CITYA
  6619     ELSE
  6620         IF ADD-FUNCTION
  6621             MOVE -1             TO  CITYL
  6622             MOVE AL-UABON       TO  CITYA
  6623             MOVE ER-2049        TO  EMI-ERROR
  6624             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6625
  6626     IF STATEL   > ZERO
  6627        MOVE AL-UANON            TO STATEA
  6628        MOVE SPACES              TO ELCNTL-KEY
  6629        MOVE PI-COMPANY-ID       TO CNTL-COMP-ID
  6630        MOVE '3'                 TO CNTL-REC-TYPE
  6631        MOVE STATEI              TO CNTL-ACCESS
  6632        MOVE +0                  TO CNTL-SEQ-NO
  6633
  6634* EXEC CICS READ
  6635*          DATASET   (CNTL-FILE-ID)
  6636*          SET       (ADDRESS OF CONTROL-FILE)
  6637*          RIDFLD    (ELCNTL-KEY)
  6638*          RESP      (WS-RESPONSE)
  6639*       END-EXEC
  6640*    MOVE '&"S        E          (  N#00006173' TO DFHEIV0
  6641     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6642     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 131
* EL652.cbl
  6643     MOVE X'204E233030303036313733' TO DFHEIV0(25:11)
  6644     CALL 'kxdfhei1' USING DFHEIV0,
  6645           CNTL-FILE-ID,
  6646           DFHEIV20,
  6647           DFHEIV99,
  6648           ELCNTL-KEY,
  6649           DFHEIV99,
  6650           DFHEIV99,
  6651           DFHEIV99
  6652     SET ADDRESS OF CONTROL-FILE TO
  6653         DFHEIV20
  6654     MOVE EIBRESP  TO WS-RESPONSE
  6655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6656        IF RESP-NORMAL
  6657           CONTINUE
  6658        ELSE
  6659           MOVE ER-2209          TO EMI-ERROR
  6660           MOVE -1               TO STATEL
  6661           MOVE AL-UABON         TO STATEA
  6662           PERFORM 9900-ERROR-FORMAT
  6663                                 THRU 9900-EXIT
  6664        END-IF
  6665     ELSE
  6666         IF ADD-FUNCTION
  6667             MOVE -1             TO  STATEL
  6668             MOVE AL-UABON       TO  STATEA
  6669             MOVE ER-2049        TO  EMI-ERROR
  6670             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6671
  6672*     IF PI-AR-PROCESSING
  6673*         IF ARBALL > ZERO OR CHANGE-FUNCTION
  6674*             IF ARBALI = '1' OR '2' OR '3' OR '4'
  6675*                 MOVE AL-UANON   TO  ARBALA
  6676*             ELSE
  6677*                 MOVE -1         TO  ARBALL
  6678*                 MOVE AL-UABON   TO  ARBALA
  6679*                 MOVE ER-3150    TO  EMI-ERROR
  6680*                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6681
  6682     IF PI-AR-PROCESSING
  6683         IF CKPULLL > ZERO OR CHANGE-FUNCTION
  6684             IF CKPULLI = 'Y' OR 'N'
  6685                 MOVE AL-UANON   TO  CKPULLA
  6686             ELSE
  6687                 MOVE -1         TO  CKPULLL
  6688                 MOVE AL-UABON   TO  CKPULLA
  6689                 MOVE ER-3170    TO  EMI-ERROR
  6690                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6691
  6692     IF ZIPCODEL > ZERO
  6693         MOVE AL-UANON           TO  ZIPCODEA.
  6694
  6695     IF PI-COMPANY-ID = 'CID' OR 'AHL' or 'FNL'
  6696        CONTINUE
  6697     ELSE
  6698        IF PI-ERC-TYPE = 'B'
  6699           IF CLPSTL > ZERO
  6700              PERFORM 4700-CHECK-STATE       THRU 4799-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 132
* EL652.cbl
  6701              IF CLPSTI = SPACES
  6702                 MOVE -1         TO  CLPSTL
  6703                 MOVE AL-UABON   TO  CLPSTA
  6704                 MOVE ER-0144    TO  EMI-ERROR
  6705                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6706              ELSE
  6707                 MOVE AL-UANON   TO  CLPSTA
  6708              END-IF
  6709           ELSE
  6710              IF ADD-FUNCTION
  6711                 MOVE -1         TO  CLPSTL
  6712                 MOVE AL-UABON   TO  CLPSTA
  6713                 MOVE ER-0144    TO  EMI-ERROR
  6714                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6715              END-IF
  6716           END-IF
  6717
  6718           IF MAXFEEL  > ZERO
  6719
  6720* EXEC CICS BIF
  6721*                  DEEDIT
  6722*                  FIELD   (MAXFEEI)
  6723*                  LENGTH  (6)
  6724*             END-EXEC
  6725     MOVE 6
  6726       TO DFHEIV11
  6727*    MOVE '@"L                   #   #00006242' TO DFHEIV0
  6728     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6729     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6730     MOVE X'2020233030303036323432' TO DFHEIV0(25:11)
  6731     CALL 'kxdfhei1' USING DFHEIV0,
  6732           MAXFEEI,
  6733           DFHEIV11
  6734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6735              IF MAXFEEI NUMERIC
  6736                 MOVE AL-UNNON   TO  MAXFEEA
  6737              ELSE
  6738                 MOVE -1         TO  MAXFEEL
  6739                 MOVE AL-UABON   TO  MAXFEEA
  6740                 MOVE ER-3261    TO  EMI-ERROR
  6741                 PERFORM 9900-ERROR-FORMAT
  6742                                 THRU  9900-EXIT
  6743              END-IF
  6744           ELSE
  6745              IF ADD-FUNCTION
  6746                 MOVE -1         TO  MAXFEEL
  6747                 MOVE AL-UABON   TO  MAXFEEA
  6748                 MOVE ER-3261    TO  EMI-ERROR
  6749                 PERFORM 9900-ERROR-FORMAT
  6750                                 THRU  9900-EXIT
  6751              END-IF
  6752           END-IF
  6753           IF MAXLFL  > ZERO
  6754
  6755* EXEC CICS BIF
  6756*                  DEEDIT
  6757*                  FIELD   (MAXLFI)
  6758*                  LENGTH  (6)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 133
* EL652.cbl
  6759*             END-EXEC
  6760     MOVE 6
  6761       TO DFHEIV11
  6762*    MOVE '@"L                   #   #00006266' TO DFHEIV0
  6763     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6764     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6765     MOVE X'2020233030303036323636' TO DFHEIV0(25:11)
  6766     CALL 'kxdfhei1' USING DFHEIV0,
  6767           MAXLFI,
  6768           DFHEIV11
  6769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6770              IF MAXLFI NUMERIC
  6771                 MOVE AL-UNNON   TO  MAXLFA
  6772              ELSE
  6773                 MOVE -1         TO  MAXLFL
  6774                 MOVE AL-UABON   TO  MAXLFA
  6775                 MOVE ER-3261    TO  EMI-ERROR
  6776                 PERFORM 9900-ERROR-FORMAT
  6777                                 THRU  9900-EXIT
  6778              END-IF
  6779           ELSE
  6780              IF ADD-FUNCTION
  6781                 MOVE -1         TO  MAXLFL
  6782                 MOVE AL-UABON   TO  MAXLFA
  6783                 MOVE ER-3261    TO  EMI-ERROR
  6784                 PERFORM 9900-ERROR-FORMAT
  6785                                 THRU  9900-EXIT
  6786              END-IF
  6787           END-IF
  6788           IF REFEL > ZERO
  6789              IF REFEI = ' ' OR 'R' OR 'N' OR 'B'
  6790                 MOVE AL-UANON   TO REFEA
  6791              ELSE
  6792                 MOVE -1         TO REFEL
  6793                 MOVE AL-UABON   TO REFEA
  6794                 MOVE ER-2790    TO EMI-ERROR
  6795                 PERFORM 9900-ERROR-FORMAT
  6796                                 THRU  9900-EXIT
  6797              END-IF
  6798           END-IF
  6799        END-IF
  6800     END-IF
  6801
  6802     IF BALFWDL > ZERO
  6803
  6804* EXEC CICS BIF
  6805*            DEEDIT
  6806*            FIELD   (BALFWDI)
  6807*            LENGTH  (13)
  6808*        END-EXEC
  6809     MOVE 13
  6810       TO DFHEIV11
  6811*    MOVE '@"L                   #   #00006304' TO DFHEIV0
  6812     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6813     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6814     MOVE X'2020233030303036333034' TO DFHEIV0(25:11)
  6815     CALL 'kxdfhei1' USING DFHEIV0,
  6816           BALFWDI,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 134
* EL652.cbl
  6817           DFHEIV11
  6818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6819         MOVE AL-UNNON           TO  BALFWDA
  6820         MOVE BALFWDI            TO  WS-SAVE-BALFWD.
  6821
  6822     IF CURCOML >        ZERO
  6823
  6824* EXEC CICS BIF
  6825*            DEEDIT
  6826*            FIELD   (CURCOMI)
  6827*            LENGTH  (13)
  6828*        END-EXEC
  6829     MOVE 13
  6830       TO DFHEIV11
  6831*    MOVE '@"L                   #   #00006313' TO DFHEIV0
  6832     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6833     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6834     MOVE X'2020233030303036333133' TO DFHEIV0(25:11)
  6835     CALL 'kxdfhei1' USING DFHEIV0,
  6836           CURCOMI,
  6837           DFHEIV11
  6838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6839         MOVE AL-UNNON           TO  CURCOMA
  6840         MOVE CURCOMI            TO  WS-SAVE-CURCOM.
  6841
  6842     IF CURCHGL > ZERO
  6843
  6844* EXEC CICS BIF
  6845*            DEEDIT
  6846*            FIELD   (CURCHGI)
  6847*            LENGTH  (13)
  6848*        END-EXEC
  6849     MOVE 13
  6850       TO DFHEIV11
  6851*    MOVE '@"L                   #   #00006322' TO DFHEIV0
  6852     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6853     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6854     MOVE X'2020233030303036333232' TO DFHEIV0(25:11)
  6855     CALL 'kxdfhei1' USING DFHEIV0,
  6856           CURCHGI,
  6857           DFHEIV11
  6858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6859         MOVE AL-UNNON           TO  CURCHGA
  6860         MOVE CURCHGI            TO  WS-SAVE-CURCHG.
  6861
  6862     IF CURPMTL > ZERO
  6863
  6864* EXEC CICS BIF
  6865*            DEEDIT
  6866*            FIELD   (CURPMTI)
  6867*            LENGTH  (13)
  6868*        END-EXEC
  6869     MOVE 13
  6870       TO DFHEIV11
  6871*    MOVE '@"L                   #   #00006331' TO DFHEIV0
  6872     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6873     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6874     MOVE X'2020233030303036333331' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 135
* EL652.cbl
  6875     CALL 'kxdfhei1' USING DFHEIV0,
  6876           CURPMTI,
  6877           DFHEIV11
  6878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6879         MOVE AL-UNNON           TO  CURPMTA
  6880         MOVE CURPMTI            TO  WS-SAVE-CURPMT.
  6881
  6882     IF ENDBALL > ZERO
  6883
  6884* EXEC CICS BIF
  6885*            DEEDIT
  6886*            FIELD   (ENDBALI)
  6887*            LENGTH  (13)
  6888*        END-EXEC
  6889     MOVE 13
  6890       TO DFHEIV11
  6891*    MOVE '@"L                   #   #00006340' TO DFHEIV0
  6892     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6893     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6894     MOVE X'2020233030303036333430' TO DFHEIV0(25:11)
  6895     CALL 'kxdfhei1' USING DFHEIV0,
  6896           ENDBALI,
  6897           DFHEIV11
  6898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6899         MOVE AL-UNNON           TO  ENDBALA
  6900         MOVE ENDBALI            TO  WS-SAVE-ENDBAL.
  6901
  6902*    IF YTDCOML > ZERO
  6903*       EXEC CICS BIF
  6904*            DEEDIT
  6905*            FIELD   (YTDCOMI)
  6906*            LENGTH  (13)
  6907*       END-EXEC
  6908*       MOVE AL-UNNON            TO YTDCOMA
  6909*       MOVE YTDCOMI             TO WS-SAVE-YTDCOM
  6910*    END-IF
  6911     .
  6912 7000-EXIT.
  6913     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 136
* EL652.cbl
  6915 7010-EDIT-CARBAL.
  6916     IF TYPEI = 'G' OR 'B'
  6917         IF CARBALI NOT = 'Y'
  6918             MOVE -1             TO  CARBALL
  6919             MOVE AL-UABON       TO  CARBALA
  6920             MOVE ER-2093        TO  EMI-ERROR
  6921             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6922             GO TO 7010-EXIT.
  6923
  6924     IF TYPEI = 'A'
  6925         IF FINRESPI = ACCTNOI
  6926             IF CARBALI NOT = 'Y'
  6927                 MOVE -1         TO  CARBALL
  6928                 MOVE AL-UABON   TO  CARBALA
  6929                 MOVE ER-2094    TO  EMI-ERROR
  6930                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6931                 GO TO 7010-EXIT.
  6932
  6933     IF PI-PROCESSOR-ID = 'E864'
  6934         NEXT SENTENCE
  6935     ELSE
  6936        IF TYPEI = 'A'
  6937           IF PI-AR-PROCESSING
  6938               IF FINRESPI NOT = ACCTNOI
  6939                    IF CARBALI = 'Y'
  6940                       MOVE -1             TO  CARBALL
  6941                       MOVE AL-UABON       TO  CARBALA
  6942                       MOVE ER-3174        TO  EMI-ERROR
  6943                       PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6944
  6945     IF TYPEI = 'C'
  6946         IF CARBALI NOT = 'N'
  6947             MOVE -1             TO  CARBALL
  6948             MOVE AL-UABON       TO  CARBALA
  6949             MOVE ER-2096        TO  EMI-ERROR
  6950             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6951             GO TO 7010-EXIT.
  6952
  6953     IF PI-PROCESSOR-ID = 'E864'
  6954         NEXT SENTENCE
  6955     ELSE
  6956        IF CHANGE-FUNCTION
  6957            IF PI-ERC-END-BAL NOT = ZERO
  6958                IF CARBALI = 'N'
  6959                    MOVE -1         TO  CARBALL
  6960                    MOVE AL-UABON   TO  CARBALA
  6961                    MOVE ER-2095    TO  EMI-ERROR
  6962                    PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6963                    GO TO 7010-EXIT.
  6964
  6965     MOVE AL-UANON               TO  CARBALA.
  6966
  6967 7010-EXIT.
  6968     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 137
* EL652.cbl
  6970 7050-READ-ERCOMP.
  6971     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  6972
  6973
  6974* EXEC CICS READ
  6975*        DATASET  (COMP-FILE-ID)
  6976*        SET      (ADDRESS OF COMPENSATION-MASTER)
  6977*        RIDFLD   (PI-ERCOMP-KEY)
  6978*    END-EXEC.
  6979*    MOVE '&"S        E          (   #00006419' TO DFHEIV0
  6980     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6981     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6982     MOVE X'2020233030303036343139' TO DFHEIV0(25:11)
  6983     CALL 'kxdfhei1' USING DFHEIV0,
  6984           COMP-FILE-ID,
  6985           DFHEIV20,
  6986           DFHEIV99,
  6987           PI-ERCOMP-KEY,
  6988           DFHEIV99,
  6989           DFHEIV99,
  6990           DFHEIV99
  6991     SET ADDRESS OF COMPENSATION-MASTER TO
  6992         DFHEIV20
  6993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6994
  6995
  6996     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  6997
  6998 7050-EXIT.
  6999     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 138
* EL652.cbl
  7001 7100-DEEDIT.
  7002
  7003* EXEC CICS BIF
  7004*        DEEDIT
  7005*        FIELD   (DEEDIT-FIELD)
  7006*        LENGTH  (15)
  7007*    END-EXEC.
  7008     MOVE 15
  7009       TO DFHEIV11
  7010*    MOVE '@"L                   #   #00006431' TO DFHEIV0
  7011     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7012     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7013     MOVE X'2020233030303036343331' TO DFHEIV0(25:11)
  7014     CALL 'kxdfhei1' USING DFHEIV0,
  7015           DEEDIT-FIELD,
  7016           DFHEIV11
  7017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7018
  7019
  7020 7100-EXIT.
  7021     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 139
* EL652.cbl
  7023 7150-ERCOMP-GETMAIN.
  7024
  7025* EXEC CICS GETMAIN
  7026*        SET      (ADDRESS OF COMPENSATION-MASTER)
  7027*        LENGTH   (ERCOMP-LENGTH)
  7028*        INITIMG  (GETMAIN-SPACE)
  7029*    END-EXEC.
  7030*    MOVE ',"IL                  $   #00006441' TO DFHEIV0
  7031     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7032     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7033     MOVE X'2020233030303036343431' TO DFHEIV0(25:11)
  7034     CALL 'kxdfhei1' USING DFHEIV0,
  7035           DFHEIV20,
  7036           ERCOMP-LENGTH,
  7037           GETMAIN-SPACE
  7038     SET ADDRESS OF COMPENSATION-MASTER TO
  7039         DFHEIV20
  7040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7041
  7042
  7043 7150-EXIT.
  7044     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 140
* EL652.cbl
  7046 7200-READ-ERCOMP-UPDATE.
  7047     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  7048
  7049
  7050* EXEC CICS READ
  7051*        DATASET  (COMP-FILE-ID)
  7052*        SET      (ADDRESS OF COMPENSATION-MASTER)
  7053*        RIDFLD   (PI-ERCOMP-KEY)
  7054*        UPDATE
  7055*    END-EXEC.
  7056*    MOVE '&"S        EU         (   #00006453' TO DFHEIV0
  7057     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7058     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7059     MOVE X'2020233030303036343533' TO DFHEIV0(25:11)
  7060     CALL 'kxdfhei1' USING DFHEIV0,
  7061           COMP-FILE-ID,
  7062           DFHEIV20,
  7063           DFHEIV99,
  7064           PI-ERCOMP-KEY,
  7065           DFHEIV99,
  7066           DFHEIV99,
  7067           DFHEIV99
  7068     SET ADDRESS OF COMPENSATION-MASTER TO
  7069         DFHEIV20
  7070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7071
  7072
  7073 7200-EXIT.
  7074     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 141
* EL652.cbl
  7076 7250-PAGE-FORWARD.
  7077     MOVE SPACES                 TO  PI-ERCOMP-EOF-SW.
  7078
  7079     IF MAINTYPL > ZERO
  7080         MOVE GROUPI             TO  PI-ERC-GROUP
  7081         MOVE CARRIERI           TO  PI-ERC-CARRIER
  7082         MOVE FINRESPI           TO  PI-ERC-RESP
  7083         MOVE ACCTNOI            TO  PI-ERC-ACCT
  7084         MOVE TYPEI              TO  PI-ERC-TYPE
  7085     ELSE
  7086         MOVE LOW-VALUES         TO  PI-ERCOMP-KEY
  7087         MOVE 'Y'                TO  PI-FIRST-TIME-SW.
  7088
  7089     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  7090     MOVE PI-ERCOMP-KEY          TO  WS-SAVE-KEY.
  7091
  7092
  7093* EXEC CICS HANDLE CONDITION
  7094*        ENDFILE  (7250-ENDFILE)
  7095*        NOTFND   (7250-ENDFILE)
  7096*        ERROR    (9990-ABEND)
  7097*    END-EXEC.
  7098*    MOVE '"$''I.                 ! - #00006479' TO DFHEIV0
  7099     MOVE X'222427492E20202020202020' TO DFHEIV0(1:12)
  7100     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7101     MOVE X'2D20233030303036343739' TO DFHEIV0(25:11)
  7102     CALL 'kxdfhei1' USING DFHEIV0
  7103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7104
  7105
  7106     PERFORM 7850-START-BROWSE  THRU  7850-EXIT.
  7107
  7108 7250-READ-NEXT.
  7109
  7110* EXEC CICS HANDLE CONDITION
  7111*        ENDFILE  (7250-ENDFILE)
  7112*        NOTFND   (7275-NOTFOUND)
  7113*    END-EXEC.
  7114*    MOVE '"$''I                  ! . #00006488' TO DFHEIV0
  7115     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7116     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7117     MOVE X'2E20233030303036343838' TO DFHEIV0(25:11)
  7118     CALL 'kxdfhei1' USING DFHEIV0
  7119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7120
  7121
  7122     PERFORM 7900-READNEXT  THRU  7900-EXIT.
  7123
  7124     IF PI-CARRIER-SECURITY > SPACES
  7125         IF PI-ERC-CARRIER = PI-CARRIER-SECURITY
  7126             NEXT SENTENCE
  7127         ELSE
  7128             GO TO 7250-READ-NEXT.
  7129
  7130     IF ERCOMP-EOF
  7131         IF FIRST-TIME
  7132             MOVE LOW-VALUES     TO  EL652AO
  7133             MOVE ER-0584        TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 142
* EL652.cbl
  7134             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7135             GO TO 8100-SEND-INITIAL-MAP
  7136         ELSE
  7137             MOVE LOW-VALUES     TO  EL652AO
  7138             MOVE ER-2067        TO  EMI-ERROR
  7139             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7140             PERFORM 7950-END-BROWSE  THRU  7950-EXIT
  7141             GO TO 7250-PAGE-FORWARD.
  7142
  7143     IF PI-ERCOMP-KEY = WS-SAVE-KEY
  7144         GO TO 7250-READ-NEXT.
  7145
  7146     MOVE CO-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  7147     MOVE CO-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
  7148     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  7149     MOVE LOW-VALUES             TO  EL652AO.
  7150     MOVE CO-CARRIER             TO  CARRIERO.
  7151     MOVE CO-GROUPING            TO  GROUPO.
  7152     MOVE CO-RESP-NO             TO  FINRESPO.
  7153     MOVE CO-ACCOUNT             TO  ACCTNOO.
  7154     MOVE CO-TYPE                TO  TYPEO.
  7155     MOVE AL-UANON               TO  CARRIERA
  7156                                     GROUPA
  7157                                     TYPEA
  7158                                     FINRESPA
  7159                                     ACCTNOA
  7160                                     MAINTYPA.
  7161     MOVE 'S'                    TO  MAINTYPO
  7162                                     PI-CHECK-MAINT-TYPE.
  7163
  7164     GO TO 5050-SET-UP-SCREEN.
  7165
  7166 7250-ENDFILE.
  7167     IF FIRST-TIME
  7168         MOVE LOW-VALUES         TO  EL652AO
  7169         MOVE ER-0584            TO  EMI-ERROR
  7170         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7171         GO TO 8100-SEND-INITIAL-MAP.
  7172
  7173     IF BROWSE-STARTED
  7174         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  7175
  7176     MOVE ER-2067                TO  EMI-ERROR.
  7177     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7178
  7179     MOVE LOW-VALUES             TO  EL652AO.
  7180
  7181     GO TO 7250-PAGE-FORWARD.
  7182
  7183 7275-NOTFOUND.
  7184     IF BROWSE-STARTED
  7185         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  7186
  7187     GO TO 8880-NOT-FOUND.
  7188
  7189 7299-EXIT.
  7190     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 143
* EL652.cbl
  7192 7300-PAGE-BACKWARD.
  7193     MOVE SPACES                 TO  PI-ERCOMP-EOF-SW.
  7194
  7195     IF MAINTYPL > ZERO
  7196         MOVE GROUPI             TO  PI-ERC-GROUP
  7197         MOVE CARRIERI           TO  PI-ERC-CARRIER
  7198         MOVE FINRESPI           TO  PI-ERC-RESP
  7199         MOVE ACCTNOI            TO  PI-ERC-ACCT
  7200         MOVE TYPEI              TO  PI-ERC-TYPE
  7201     ELSE
  7202         MOVE LOW-VALUES         TO  PI-ERCOMP-KEY.
  7203
  7204     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  7205
  7206
  7207* EXEC CICS HANDLE CONDITION
  7208*        ENDFILE  (7375-ENDFILE)
  7209*        NOTFND   (7375-ENDFILE)
  7210*        ERROR    (9990-ABEND)
  7211*    END-EXEC.
  7212*    MOVE '"$''I.                 ! / #00006577' TO DFHEIV0
  7213     MOVE X'222427492E20202020202020' TO DFHEIV0(1:12)
  7214     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7215     MOVE X'2F20233030303036353737' TO DFHEIV0(25:11)
  7216     CALL 'kxdfhei1' USING DFHEIV0
  7217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7218
  7219
  7220     PERFORM 7850-START-BROWSE  THRU  7850-EXIT.
  7221
  7222     PERFORM 8050-READPREV  THRU  8050-EXIT.
  7223
  7224 7350-READ-PREV.
  7225
  7226* EXEC CICS HANDLE CONDITION
  7227*        ENDFILE  (7375-ENDFILE)
  7228*        NOTFND   (7275-NOTFOUND)
  7229*    END-EXEC.
  7230*    MOVE '"$''I                  ! 0 #00006588' TO DFHEIV0
  7231     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7232     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7233     MOVE X'3020233030303036353838' TO DFHEIV0(25:11)
  7234     CALL 'kxdfhei1' USING DFHEIV0
  7235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7236
  7237
  7238     PERFORM 8050-READPREV  THRU  8050-EXIT.
  7239
  7240     IF PI-CARRIER-SECURITY > SPACES
  7241         IF PI-ERC-CARRIER = PI-CARRIER-SECURITY
  7242             NEXT SENTENCE
  7243         ELSE
  7244             GO TO 7350-READ-PREV.
  7245
  7246     IF PI-COMPANY-CD NOT = CO-COMPANY-CD
  7247         GO TO 7375-ENDFILE.
  7248
  7249     MOVE CO-LAST-MAINT-USER     TO  PI-UPDATE-BY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 144
* EL652.cbl
  7250     MOVE CO-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
  7251     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  7252     MOVE LOW-VALUES             TO  EL652AO.
  7253     MOVE CO-CARRIER             TO  CARRIERO.
  7254     MOVE CO-GROUPING            TO  GROUPO.
  7255     MOVE CO-RESP-NO             TO  FINRESPO.
  7256     MOVE CO-ACCOUNT             TO  ACCTNOO.
  7257     MOVE CO-TYPE                TO  TYPEO.
  7258     MOVE AL-UANON               TO  CARRIERA
  7259                                     GROUPA
  7260                                     TYPEA
  7261                                     FINRESPA
  7262                                     ACCTNOA
  7263                                     MAINTYPA.
  7264     MOVE 'S'                    TO  MAINTYPO
  7265                                     PI-CHECK-MAINT-TYPE.
  7266
  7267     GO TO 5050-SET-UP-SCREEN.
  7268
  7269 7375-ENDFILE.
  7270     IF BROWSE-STARTED
  7271         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  7272
  7273     MOVE ER-2238                TO  EMI-ERROR.
  7274     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7275
  7276     MOVE -1                     TO  MAINTYPL.
  7277
  7278     GO TO 8200-SEND-DATAONLY.
  7279
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 145
* EL652.cbl
  7281 7400-READ-CONTROL-FILE.
  7282     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7283     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  7284
  7285
  7286* EXEC CICS HANDLE CONDITION
  7287*        NOTFND  (7490-NOT-FOUND)
  7288*        ERROR   (9990-ABEND)
  7289*    END-EXEC.
  7290*    MOVE '"$I.                  ! 1 #00006640' TO DFHEIV0
  7291     MOVE X'2224492E2020202020202020' TO DFHEIV0(1:12)
  7292     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7293     MOVE X'3120233030303036363430' TO DFHEIV0(25:11)
  7294     CALL 'kxdfhei1' USING DFHEIV0
  7295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7296
  7297
  7298
  7299* EXEC CICS READ
  7300*        DATASET  (CNTL-FILE-ID)
  7301*        SET      (ADDRESS OF CONTROL-FILE)
  7302*        RIDFLD   (ELCNTL-KEY)
  7303*    END-EXEC.
  7304*    MOVE '&"S        E          (   #00006645' TO DFHEIV0
  7305     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7306     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7307     MOVE X'2020233030303036363435' TO DFHEIV0(25:11)
  7308     CALL 'kxdfhei1' USING DFHEIV0,
  7309           CNTL-FILE-ID,
  7310           DFHEIV20,
  7311           DFHEIV99,
  7312           ELCNTL-KEY,
  7313           DFHEIV99,
  7314           DFHEIV99,
  7315           DFHEIV99
  7316     SET ADDRESS OF CONTROL-FILE TO
  7317         DFHEIV20
  7318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7319
  7320
  7321     IF CNTL-REC-TYPE = '6'
  7322         MOVE AL-UANON           TO  CARRIERA
  7323         MOVE CARRIERI           TO  PI-ERC-CARRIER
  7324         GO TO 7499-EXIT.
  7325
  7326     IF CF-COMPENSATION-MSTR-MAINT-DT NOT = LOW-VALUES
  7327         GO TO 7499-EXIT
  7328     ELSE
  7329         MOVE -1                 TO  MAINTYPL
  7330         MOVE ER-2572            TO  EMI-ERROR
  7331         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7332         GO TO 7499-EXIT.
  7333
  7334 7490-NOT-FOUND.
  7335     IF CNTL-REC-TYPE = '6'
  7336         MOVE -1                 TO  CARRIERL
  7337         MOVE AL-UABON           TO  CARRIERA
  7338         MOVE ER-0193            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 146
* EL652.cbl
  7339     ELSE
  7340         IF CNTL-REC-TYPE = '2'
  7341             MOVE -1                TO  CSRL
  7342             MOVE AL-UABON          TO  CSRA
  7343             MOVE ER-1883           TO  EMI-ERROR
  7344         ELSE
  7345            MOVE ER-0002            TO  EMI-ERROR
  7346            MOVE -1                 TO  PFKEYL.
  7347
  7348     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7349
  7350 7499-EXIT.
  7351     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 147
* EL652.cbl
  7353
  7354 7500-UPDATE-SUMM.
  7355
  7356     PERFORM 7700-ERSUMM-GETMAIN  THRU  7700-EXIT.
  7357
  7358     MOVE 'SX'                   TO SX-RECORD-ID.
  7359     MOVE PI-COMPANY-CD          TO SX-COMPANY-CD.
  7360     MOVE PI-AR-SUMMARY-CODE     TO SX-SUMMARY.
  7361     MOVE PI-ERC-CARRIER         TO SX-CARRIER.
  7362     MOVE PI-ERC-GROUP           TO SX-GROUP.
  7363     MOVE PI-ERC-RESP            TO SX-FIN-RESP.
  7364     MOVE PI-ERC-ACCT            TO SX-ACCT-AGENT.
  7365     MOVE WS-SAVE-NAME           TO SX-SUMM-OR-AGT-NAME.
  7366     MOVE PI-PROCESSOR-ID        TO SX-LAST-MAINT-BY.
  7367     MOVE EIBTIME                TO SX-LAST-MAINT-HHMMSS.
  7368     MOVE BIN-CURRENT-SAVE       TO SX-LAST-MAINT-DT.
  7369     MOVE PI-COMPANY-CD          TO SX-COMPANY-A1.
  7370     MOVE PI-ERC-ACCT            TO SX-ACCT-AGENT-A1.
  7371     MOVE PI-AR-SUMMARY-CODE     TO SX-SUMMARY-A1.
  7372     MOVE PI-ERC-CARRIER         TO SX-CARR-A1.
  7373     MOVE PI-ERC-GROUP           TO SX-GROUP-A1.
  7374     MOVE PI-ERC-RESP            TO SX-FIN-RESP-A1.
  7375
  7376
  7377* EXEC CICS HANDLE CONDITION
  7378*        DUPREC  (7550-DUP)
  7379*    END-EXEC.
  7380*    MOVE '"$%                   ! 2 #00006706' TO DFHEIV0
  7381     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7382     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7383     MOVE X'3220233030303036373036' TO DFHEIV0(25:11)
  7384     CALL 'kxdfhei1' USING DFHEIV0
  7385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7386
  7387
  7388
  7389* EXEC CICS WRITE
  7390*        DATASET  (SUMM-FILE-ID)
  7391*        FROM     (SUMM-CROSS-REFERENCE)
  7392*        RIDFLD   (SX-CONTROL-PRIMARY)
  7393*    END-EXEC.
  7394     MOVE LENGTH OF
  7395      SUMM-CROSS-REFERENCE
  7396       TO DFHEIV11
  7397*    MOVE '&$ L                  ''   #00006710' TO DFHEIV0
  7398     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7399     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7400     MOVE X'2020233030303036373130' TO DFHEIV0(25:11)
  7401     CALL 'kxdfhei1' USING DFHEIV0,
  7402           SUMM-FILE-ID,
  7403           SUMM-CROSS-REFERENCE,
  7404           DFHEIV11,
  7405           SX-CONTROL-PRIMARY,
  7406           DFHEIV99,
  7407           DFHEIV99
  7408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7409
  7410
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 148
* EL652.cbl
  7411     MOVE LOW-VALUES             TO ERSUMM-KEY.
  7412     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7413     MOVE PI-AR-SUMMARY-CODE     TO SUMM-SUMMARY.
  7414
  7415
  7416* EXEC CICS HANDLE CONDITION
  7417*        NOTFND  (7540-WRITE)
  7418*    END-EXEC.
  7419*    MOVE '"$I                   ! 3 #00006720' TO DFHEIV0
  7420     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7421     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7422     MOVE X'3320233030303036373230' TO DFHEIV0(25:11)
  7423     CALL 'kxdfhei1' USING DFHEIV0
  7424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7425
  7426
  7427
  7428* EXEC CICS READ
  7429*        DATASET  (SUMM-FILE-ID)
  7430*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7431*        RIDFLD   (ERSUMM-KEY)
  7432*    END-EXEC.
  7433*    MOVE '&"S        E          (   #00006724' TO DFHEIV0
  7434     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7435     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7436     MOVE X'2020233030303036373234' TO DFHEIV0(25:11)
  7437     CALL 'kxdfhei1' USING DFHEIV0,
  7438           SUMM-FILE-ID,
  7439           DFHEIV20,
  7440           DFHEIV99,
  7441           ERSUMM-KEY,
  7442           DFHEIV99,
  7443           DFHEIV99,
  7444           DFHEIV99
  7445     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7446         DFHEIV20
  7447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7448
  7449     GO TO 7599-EXIT.
  7450
  7451 7540-WRITE.
  7452
  7453     MOVE ERSUMM-KEY             TO SX-CONTROL-PRIMARY.
  7454     MOVE LOW-VALUES             TO SX-CONTROL-A1.
  7455     MOVE PI-COMPANY-CD          TO SX-COMPANY-A1.
  7456     MOVE PI-AR-SUMMARY-CODE     TO SX-SUMMARY-A1.
  7457     MOVE SPACES                 TO SX-SUMM-OR-AGT-NAME.
  7458     MOVE 'LGXX'                 TO SX-LAST-MAINT-BY.
  7459
  7460
  7461* EXEC CICS WRITE
  7462*        DATASET  (SUMM-FILE-ID)
  7463*        FROM     (SUMM-CROSS-REFERENCE)
  7464*        RIDFLD   (SX-CONTROL-PRIMARY)
  7465*    END-EXEC.
  7466     MOVE LENGTH OF
  7467      SUMM-CROSS-REFERENCE
  7468       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 149
* EL652.cbl
  7469*    MOVE '&$ L                  ''   #00006740' TO DFHEIV0
  7470     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7471     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7472     MOVE X'2020233030303036373430' TO DFHEIV0(25:11)
  7473     CALL 'kxdfhei1' USING DFHEIV0,
  7474           SUMM-FILE-ID,
  7475           SUMM-CROSS-REFERENCE,
  7476           DFHEIV11,
  7477           SX-CONTROL-PRIMARY,
  7478           DFHEIV99,
  7479           DFHEIV99
  7480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7481
  7482
  7483     MOVE PI-ERC-CARRIER         TO PI-CR-CARRIER.
  7484     MOVE PI-ERC-GROUP           TO PI-CR-GROUPING.
  7485     MOVE PI-ERC-TYPE            TO PI-CR-TYPE.
  7486     MOVE PI-ERC-RESP            TO PI-CR-FIN-RESP.
  7487     MOVE PI-ERC-ACCT            TO PI-CR-ACCOUNT.
  7488
  7489     MOVE XCTL-856               TO PGM-NAME.
  7490     GO TO 9300-XCTL.
  7491
  7492 7550-DUP.
  7493
  7494     MOVE ER-3152                TO EMI-ERROR.
  7495     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7496
  7497     MOVE -1                     TO MAINTYPL.
  7498
  7499     GO TO 8200-SEND-DATAONLY.
  7500
  7501 7599-EXIT.
  7502     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 150
* EL652.cbl
  7504
  7505 7600-DELETE-SUMM.
  7506
  7507     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7508     MOVE WS-SAVE-SUMM           TO SUMM-SUMMARY.
  7509     MOVE PI-ERC-CARRIER         TO SUMM-CARRIER.
  7510     MOVE PI-ERC-GROUP           TO SUMM-GROUP.
  7511     MOVE PI-ERC-RESP            TO SUMM-FIN-RESP.
  7512     MOVE PI-ERC-ACCT            TO SUMM-ACCT-AGENT.
  7513
  7514 7620-READ-ERSUMM.
  7515
  7516* EXEC CICS HANDLE CONDITION
  7517*        NOTFND  (7699-EXIT)
  7518*    END-EXEC.
  7519*    MOVE '"$I                   ! 4 #00006778' TO DFHEIV0
  7520     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7522     MOVE X'3420233030303036373738' TO DFHEIV0(25:11)
  7523     CALL 'kxdfhei1' USING DFHEIV0
  7524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7525
  7526
  7527
  7528* EXEC CICS READ
  7529*        DATASET  (SUMM-FILE-ID)
  7530*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7531*        RIDFLD   (ERSUMM-KEY)
  7532*        UPDATE
  7533*    END-EXEC.
  7534*    MOVE '&"S        EU         (   #00006782' TO DFHEIV0
  7535     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7536     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7537     MOVE X'2020233030303036373832' TO DFHEIV0(25:11)
  7538     CALL 'kxdfhei1' USING DFHEIV0,
  7539           SUMM-FILE-ID,
  7540           DFHEIV20,
  7541           DFHEIV99,
  7542           ERSUMM-KEY,
  7543           DFHEIV99,
  7544           DFHEIV99,
  7545           DFHEIV99
  7546     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7547         DFHEIV20
  7548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7549
  7550
  7551
  7552* EXEC CICS DELETE
  7553*        DATASET  (SUMM-FILE-ID)
  7554*    END-EXEC.
  7555*    MOVE '&(                    &   #00006789' TO DFHEIV0
  7556     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7557     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7558     MOVE X'2020233030303036373839' TO DFHEIV0(25:11)
  7559     CALL 'kxdfhei1' USING DFHEIV0,
  7560           SUMM-FILE-ID,
  7561           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 151
* EL652.cbl
  7562           DFHEIV99,
  7563           DFHEIV99,
  7564           DFHEIV99
  7565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7566
  7567
  7568     MOVE LOW-VALUES             TO ERSUMM-KEY.
  7569     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7570     MOVE WS-SAVE-SUMM           TO SUMM-SUMMARY.
  7571
  7572
  7573* EXEC CICS STARTBR
  7574*        DATASET  (SUMM-FILE-ID)
  7575*        RIDFLD   (ERSUMM-KEY)
  7576*    END-EXEC.
  7577     MOVE 0
  7578       TO DFHEIV11
  7579*    MOVE '&,         G          &   #00006797' TO DFHEIV0
  7580     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7581     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7582     MOVE X'2020233030303036373937' TO DFHEIV0(25:11)
  7583     CALL 'kxdfhei1' USING DFHEIV0,
  7584           SUMM-FILE-ID,
  7585           ERSUMM-KEY,
  7586           DFHEIV99,
  7587           DFHEIV11,
  7588           DFHEIV99
  7589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7590
  7591
  7592
  7593* EXEC CICS READNEXT
  7594*        DATASET  (SUMM-FILE-ID)
  7595*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7596*        RIDFLD   (ERSUMM-KEY)
  7597*    END-EXEC.
  7598     MOVE 0
  7599       TO DFHEIV11
  7600*    MOVE '&.S                   )   #00006802' TO DFHEIV0
  7601     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7602     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7603     MOVE X'2020233030303036383032' TO DFHEIV0(25:11)
  7604     CALL 'kxdfhei1' USING DFHEIV0,
  7605           SUMM-FILE-ID,
  7606           DFHEIV20,
  7607           DFHEIV99,
  7608           ERSUMM-KEY,
  7609           DFHEIV99,
  7610           DFHEIV11,
  7611           DFHEIV99,
  7612           DFHEIV99
  7613     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7614         DFHEIV20
  7615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7616
  7617
  7618     IF SX-CARRIER = LOW-VALUES
  7619         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 152
* EL652.cbl
  7620     ELSE
  7621         GO TO 7640-END-BROWSE.
  7622
  7623
  7624* EXEC CICS HANDLE CONDITION
  7625*        ENDFILE  (7630-DELETE)
  7626*    END-EXEC.
  7627*    MOVE '"$''                   ! 5 #00006813' TO DFHEIV0
  7628     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7629     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7630     MOVE X'3520233030303036383133' TO DFHEIV0(25:11)
  7631     CALL 'kxdfhei1' USING DFHEIV0
  7632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7633
  7634
  7635
  7636* EXEC CICS READNEXT
  7637*        DATASET  (SUMM-FILE-ID)
  7638*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7639*        RIDFLD   (ERSUMM-KEY)
  7640*    END-EXEC.
  7641     MOVE 0
  7642       TO DFHEIV11
  7643*    MOVE '&.S                   )   #00006817' TO DFHEIV0
  7644     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7645     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7646     MOVE X'2020233030303036383137' TO DFHEIV0(25:11)
  7647     CALL 'kxdfhei1' USING DFHEIV0,
  7648           SUMM-FILE-ID,
  7649           DFHEIV20,
  7650           DFHEIV99,
  7651           ERSUMM-KEY,
  7652           DFHEIV99,
  7653           DFHEIV11,
  7654           DFHEIV99,
  7655           DFHEIV99
  7656     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7657         DFHEIV20
  7658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7659
  7660
  7661     IF SX-SUMMARY = WS-SAVE-SUMM
  7662         GO TO 7640-END-BROWSE.
  7663
  7664 7630-DELETE.
  7665
  7666* EXEC CICS ENDBR
  7667*        DATASET  (SUMM-FILE-ID)
  7668*    END-EXEC.
  7669     MOVE 0
  7670       TO DFHEIV11
  7671*    MOVE '&2                    $   #00006827' TO DFHEIV0
  7672     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7673     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7674     MOVE X'2020233030303036383237' TO DFHEIV0(25:11)
  7675     CALL 'kxdfhei1' USING DFHEIV0,
  7676           SUMM-FILE-ID,
  7677           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 153
* EL652.cbl
  7678           DFHEIV99
  7679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7680
  7681
  7682     MOVE LOW-VALUES             TO ERSUMM-KEY.
  7683     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7684     MOVE WS-SAVE-SUMM           TO SUMM-SUMMARY.
  7685
  7686
  7687* EXEC CICS READ
  7688*        DATASET  (SUMM-FILE-ID)
  7689*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7690*        RIDFLD   (ERSUMM-KEY)
  7691*        UPDATE
  7692*    END-EXEC.
  7693*    MOVE '&"S        EU         (   #00006835' TO DFHEIV0
  7694     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7695     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7696     MOVE X'2020233030303036383335' TO DFHEIV0(25:11)
  7697     CALL 'kxdfhei1' USING DFHEIV0,
  7698           SUMM-FILE-ID,
  7699           DFHEIV20,
  7700           DFHEIV99,
  7701           ERSUMM-KEY,
  7702           DFHEIV99,
  7703           DFHEIV99,
  7704           DFHEIV99
  7705     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7706         DFHEIV20
  7707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7708
  7709
  7710
  7711* EXEC CICS DELETE
  7712*        DATASET  (SUMM-FILE-ID)
  7713*    END-EXEC.
  7714*    MOVE '&(                    &   #00006842' TO DFHEIV0
  7715     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7716     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7717     MOVE X'2020233030303036383432' TO DFHEIV0(25:11)
  7718     CALL 'kxdfhei1' USING DFHEIV0,
  7719           SUMM-FILE-ID,
  7720           DFHEIV99,
  7721           DFHEIV99,
  7722           DFHEIV99,
  7723           DFHEIV99
  7724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7725
  7726
  7727     GO TO 7699-EXIT.
  7728
  7729 7640-END-BROWSE.
  7730
  7731* EXEC CICS ENDBR
  7732*        DATASET  (SUMM-FILE-ID)
  7733*    END-EXEC.
  7734     MOVE 0
  7735       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 154
* EL652.cbl
  7736*    MOVE '&2                    $   #00006849' TO DFHEIV0
  7737     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7738     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7739     MOVE X'2020233030303036383439' TO DFHEIV0(25:11)
  7740     CALL 'kxdfhei1' USING DFHEIV0,
  7741           SUMM-FILE-ID,
  7742           DFHEIV11,
  7743           DFHEIV99
  7744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7745
  7746
  7747 7699-EXIT.
  7748     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 155
* EL652.cbl
  7750
  7751 7700-ERSUMM-GETMAIN.
  7752
  7753* EXEC CICS GETMAIN
  7754*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7755*        LENGTH   (ERSUMM-LENGTH)
  7756*        INITIMG  (GETMAIN-SPACE)
  7757*    END-EXEC.
  7758*    MOVE ',"IL                  $   #00006858' TO DFHEIV0
  7759     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7760     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7761     MOVE X'2020233030303036383538' TO DFHEIV0(25:11)
  7762     CALL 'kxdfhei1' USING DFHEIV0,
  7763           DFHEIV20,
  7764           ERSUMM-LENGTH,
  7765           GETMAIN-SPACE
  7766     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7767         DFHEIV20
  7768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7769
  7770
  7771 7700-EXIT.
  7772     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 156
* EL652.cbl
  7774
  7775 7850-START-BROWSE.
  7776
  7777* EXEC CICS STARTBR
  7778*        DATASET  (COMP-FILE-ID)
  7779*        RIDFLD   (PI-ERCOMP-KEY)
  7780*    END-EXEC.
  7781     MOVE 0
  7782       TO DFHEIV11
  7783*    MOVE '&,         G          &   #00006869' TO DFHEIV0
  7784     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7785     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7786     MOVE X'2020233030303036383639' TO DFHEIV0(25:11)
  7787     CALL 'kxdfhei1' USING DFHEIV0,
  7788           COMP-FILE-ID,
  7789           PI-ERCOMP-KEY,
  7790           DFHEIV99,
  7791           DFHEIV11,
  7792           DFHEIV99
  7793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7794
  7795
  7796     MOVE 'Y'                    TO  WS-BROWSE-SW.
  7797
  7798 7850-EXIT.
  7799     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 157
* EL652.cbl
  7801 7900-READNEXT.
  7802
  7803* EXEC CICS READNEXT
  7804*        DATASET  (COMP-FILE-ID)
  7805*        SET      (ADDRESS OF COMPENSATION-MASTER)
  7806*        RIDFLD   (PI-ERCOMP-KEY)
  7807*    END-EXEC.
  7808     MOVE 0
  7809       TO DFHEIV11
  7810*    MOVE '&.S                   )   #00006880' TO DFHEIV0
  7811     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7812     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7813     MOVE X'2020233030303036383830' TO DFHEIV0(25:11)
  7814     CALL 'kxdfhei1' USING DFHEIV0,
  7815           COMP-FILE-ID,
  7816           DFHEIV20,
  7817           DFHEIV99,
  7818           PI-ERCOMP-KEY,
  7819           DFHEIV99,
  7820           DFHEIV11,
  7821           DFHEIV99,
  7822           DFHEIV99
  7823     SET ADDRESS OF COMPENSATION-MASTER TO
  7824         DFHEIV20
  7825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7826
  7827
  7828     IF PI-COMPANY-CD NOT = CO-COMPANY-CD
  7829         MOVE 'Y'                TO  PI-ERCOMP-EOF-SW
  7830     ELSE
  7831         MOVE SPACE              TO  PI-FIRST-TIME-SW.
  7832
  7833 7900-EXIT.
  7834     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 158
* EL652.cbl
  7836 7950-END-BROWSE.
  7837
  7838* EXEC CICS ENDBR
  7839*        DATASET  (COMP-FILE-ID)
  7840*    END-EXEC.
  7841     MOVE 0
  7842       TO DFHEIV11
  7843*    MOVE '&2                    $   #00006895' TO DFHEIV0
  7844     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7845     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7846     MOVE X'2020233030303036383935' TO DFHEIV0(25:11)
  7847     CALL 'kxdfhei1' USING DFHEIV0,
  7848           COMP-FILE-ID,
  7849           DFHEIV11,
  7850           DFHEIV99
  7851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7852
  7853
  7854     MOVE 'N'                    TO  WS-BROWSE-SW.
  7855
  7856 7950-EXIT.
  7857     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 159
* EL652.cbl
  7859 8000-UPDATE-MAINT-DATE.
  7860     MOVE SPACES                 TO  ELCNTL-KEY.
  7861     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7862     MOVE '1'                    TO  CNTL-REC-TYPE.
  7863     MOVE +0                     TO  CNTL-SEQ-NO.
  7864
  7865
  7866* EXEC CICS HANDLE CONDITION
  7867*        NOTFND  (8000-EXIT)
  7868*    END-EXEC.
  7869*    MOVE '"$I                   ! 6 #00006910' TO DFHEIV0
  7870     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7871     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7872     MOVE X'3620233030303036393130' TO DFHEIV0(25:11)
  7873     CALL 'kxdfhei1' USING DFHEIV0
  7874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7875
  7876
  7877
  7878* EXEC CICS READ
  7879*        UPDATE
  7880*        DATASET  (CNTL-FILE-ID)
  7881*        SET      (ADDRESS OF CONTROL-FILE)
  7882*        RIDFLD   (ELCNTL-KEY)
  7883*    END-EXEC.
  7884*    MOVE '&"S        EU         (   #00006914' TO DFHEIV0
  7885     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7886     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7887     MOVE X'2020233030303036393134' TO DFHEIV0(25:11)
  7888     CALL 'kxdfhei1' USING DFHEIV0,
  7889           CNTL-FILE-ID,
  7890           DFHEIV20,
  7891           DFHEIV99,
  7892           ELCNTL-KEY,
  7893           DFHEIV99,
  7894           DFHEIV99,
  7895           DFHEIV99
  7896     SET ADDRESS OF CONTROL-FILE TO
  7897         DFHEIV20
  7898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7899
  7900
  7901     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  7902     MOVE 'B'                    TO  JP-RECORD-TYPE.
  7903     MOVE CNTL-FILE-ID           TO  FILE-ID.
  7904
  7905     PERFORM 8400-LOG-JOURNAL-RECORD.
  7906
  7907     MOVE BIN-CURRENT-SAVE  TO  CF-COMPENSATION-MSTR-MAINT-DT.
  7908     MOVE CONTROL-FILE      TO  JP-RECORD-AREA.
  7909     MOVE 'C'               TO  JP-RECORD-TYPE.
  7910     MOVE CNTL-FILE-ID      TO  FILE-ID.
  7911
  7912
  7913* EXEC CICS REWRITE
  7914*        DATASET  (CNTL-FILE-ID)
  7915*        FROM     (CONTROL-FILE)
  7916*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 160
* EL652.cbl
  7917     MOVE LENGTH OF
  7918      CONTROL-FILE
  7919       TO DFHEIV11
  7920*    MOVE '&& L                  %   #00006932' TO DFHEIV0
  7921     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7922     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7923     MOVE X'2020233030303036393332' TO DFHEIV0(25:11)
  7924     CALL 'kxdfhei1' USING DFHEIV0,
  7925           CNTL-FILE-ID,
  7926           CONTROL-FILE,
  7927           DFHEIV11,
  7928           DFHEIV99
  7929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7930
  7931
  7932     PERFORM 8400-LOG-JOURNAL-RECORD.
  7933
  7934 8000-EXIT.
  7935      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 161
* EL652.cbl
  7937 8050-READPREV.
  7938
  7939* EXEC CICS READPREV
  7940*        DATASET  (COMP-FILE-ID)
  7941*        SET      (ADDRESS OF COMPENSATION-MASTER)
  7942*        RIDFLD   (PI-ERCOMP-KEY)
  7943*    END-EXEC.
  7944     MOVE 0
  7945       TO DFHEIV11
  7946*    MOVE '&0S                   )   #00006943' TO DFHEIV0
  7947     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  7948     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7949     MOVE X'2020233030303036393433' TO DFHEIV0(25:11)
  7950     CALL 'kxdfhei1' USING DFHEIV0,
  7951           COMP-FILE-ID,
  7952           DFHEIV20,
  7953           DFHEIV99,
  7954           PI-ERCOMP-KEY,
  7955           DFHEIV99,
  7956           DFHEIV11,
  7957           DFHEIV99,
  7958           DFHEIV99
  7959     SET ADDRESS OF COMPENSATION-MASTER TO
  7960         DFHEIV20
  7961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7962
  7963
  7964 8050-EXIT.
  7965     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 162
* EL652.cbl
  7967 8100-SEND-INITIAL-MAP.
  7968
  7969     IF  NOT CREDIT-SESSION
  7970         MOVE AL-SADOF           TO PFK5A
  7971                                    PFK6A.
  7972
  7973     IF PI-COMPANY-ID NOT = 'NCL'
  7974         MOVE AL-SANOF           TO  LETRCDA
  7975         MOVE AL-SADOF           TO  LETDESCA.
  7976
  7977     IF PI-COMPANY-ID  NOT = 'DDB' AND 'ANT' AND 'ASL' AND
  7978                             'AN1' AND 'TFS'
  7979         MOVE AL-SANOF           TO  BALCDA
  7980         MOVE AL-SADOF           TO  BALPRTA.
  7981
  7982     IF PI-COMPANY-ID   = 'NCL'
  7983        IF TYPEI =  'G' OR 'B'
  7984           MOVE AL-UNNOF         TO  RPTCD2A
  7985           MOVE AL-SANOF         TO  RPTCDDA.
  7986
  7987     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  7988        IF TYPEI = 'A'
  7989           MOVE AL-SANOF         TO SPPDDHA
  7990           MOVE AL-UANON         TO SPPDDA
  7991        END-IF
  7992     END-IF
  7993     MOVE AL-SANON               TO  FLITYPA.
  7994
  7995     IF EIBTRNID NOT = TRANS-ID
  7996        IF PI-AR-PROCESSING
  7997             MOVE AL-SANOF       TO  SCDESCA
  7998                                     NGDESCA
  7999*                                    BALDESCA
  8000                                     CKDESCA
  8001             MOVE AL-UANON       TO  SUMMNOA
  8002                                     NETGRSA
  8003*                                    ARBALA
  8004                                     CKPULLA.
  8005
  8006     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  8007         MOVE AL-UANOF           TO  LSTMDTA
  8008         MOVE AL-SANOF           TO  PFK9A
  8009     ELSE
  8010         IF PI-AR-PROCESSING
  8011             MOVE AL-SANOF       TO  PFK9A
  8012         ELSE
  8013             MOVE AL-SANOF       TO  LSTMDTA
  8014             MOVE AL-SADOF       TO  PFK9A.
  8015
  8016*    IF (PI-ERC-TYPE NOT = 'G' AND SPACE)
  8017*       OR (PI-COMPANY-ID NOT = 'DCC')
  8018     IF PI-ERC-TYPE = 'A'
  8019        MOVE AL-SANOF            TO PCONTA
  8020     END-IF
  8021     IF PI-ERC-TYPE NOT = 'B' AND SPACE
  8022         MOVE AL-SADOF           TO  PFK10A
  8023                                     PFK13A
  8024         MOVE AL-SADOF           TO  CSLABLA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 163
* EL652.cbl
  8025         MOVE AL-SADOF           TO  CLPSTA
  8026         MOVE AL-SADOF           TO  MFLABLA
  8027         MOVE AL-SADOF           TO  MAXFEEA
  8028         MOVE AL-SADOF           TO  LFLABLA
  8029         MOVE AL-SADOF           TO  MAXLFA
  8030         MOVE AL-SADOF           TO  REFEHA
  8031                                     REFEA
  8032     END-IF
  8033     if pi-company-id = 'AHL'
  8034        move al-sanof            to ahl120a
  8035                                    over120a
  8036     end-if
  8037     MOVE SAVE-DATE              TO  RUNDATEO.
  8038     MOVE EIBTIME                TO  TIME-IN.
  8039     MOVE TIME-OUT               TO  RUNTIMEO.
  8040     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  8041     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  8042     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  8043     MOVE -1                     TO  MAINTYPL.
  8044
  8045
  8046* EXEC CICS SEND
  8047*        MAP     (MAP-NAME)
  8048*        MAPSET  (MAPSET-NAME)
  8049*        FROM    (EL652AO)
  8050*        ERASE
  8051*        CURSOR
  8052*    END-EXEC.
  8053     MOVE LENGTH OF
  8054      EL652AO
  8055       TO DFHEIV12
  8056     MOVE -1
  8057       TO DFHEIV11
  8058*    MOVE '8$     CT  E    H L F ,   #00007030' TO DFHEIV0
  8059     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8060     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8061     MOVE X'2020233030303037303330' TO DFHEIV0(25:11)
  8062     CALL 'kxdfhei1' USING DFHEIV0,
  8063           MAP-NAME,
  8064           EL652AO,
  8065           DFHEIV12,
  8066           MAPSET-NAME,
  8067           DFHEIV99,
  8068           DFHEIV99,
  8069           DFHEIV99,
  8070           DFHEIV11,
  8071           DFHEIV99,
  8072           DFHEIV99,
  8073           DFHEIV99
  8074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8075
  8076
  8077     GO TO 9100-RETURN-TRAN.
  8078
  8079 8200-SEND-DATAONLY.
  8080
  8081     IF  NOT CREDIT-SESSION
  8082         MOVE AL-SADOF           TO PFK5A
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 164
* EL652.cbl
  8083                                    PFK6A.
  8084
  8085     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  8086         MOVE AL-UANOF           TO  LSTMDTA
  8087         MOVE AL-SANOF           TO  PFK9A
  8088     ELSE
  8089         IF PI-AR-PROCESSING
  8090             MOVE AL-SANOF       TO  PFK9A
  8091         ELSE
  8092             MOVE AL-SANOF       TO  LSTMDTA
  8093             MOVE AL-SADOF       TO  PFK9A.
  8094     IF PI-ERC-TYPE = 'A'
  8095        MOVE AL-SANOF            TO PCONTA
  8096     END-IF
  8097
  8098     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  8099        IF TYPEI = 'A'
  8100           MOVE AL-SANOF         TO SPPDDHA
  8101           MOVE AL-UANON         TO SPPDDA
  8102        END-IF
  8103     END-IF
  8104*    IF (PI-ERC-TYPE NOT = 'G')
  8105*       OR (PI-COMPANY-ID NOT = 'DCC')
  8106     IF PI-ERC-TYPE NOT = 'B'
  8107         MOVE AL-SADOF           TO  PFK10A
  8108                                     PFK13A
  8109         MOVE AL-SADOF           TO  CSLABLA
  8110         MOVE AL-SADOF           TO  CLPSTA
  8111         MOVE AL-SADOF           TO  MFLABLA
  8112         MOVE AL-SADOF           TO  MAXFEEA
  8113         MOVE AL-SADOF           TO  LFLABLA
  8114         MOVE AL-SADOF           TO  MAXLFA
  8115     END-IF.
  8116
  8117     MOVE SAVE-DATE              TO  RUNDATEO.
  8118     MOVE EIBTIME                TO  TIME-IN.
  8119     MOVE TIME-OUT               TO  RUNTIMEO.
  8120     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  8121     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  8122     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  8123
  8124
  8125* EXEC CICS SEND
  8126*        MAP     (MAP-NAME)
  8127*        MAPSET  (MAPSET-NAME)
  8128*        FROM    (EL652AO)
  8129*        DATAONLY
  8130*        CURSOR
  8131*    END-EXEC.
  8132     MOVE LENGTH OF
  8133      EL652AO
  8134       TO DFHEIV12
  8135     MOVE -1
  8136       TO DFHEIV11
  8137*    MOVE '8$D    CT       H L F ,   #00007085' TO DFHEIV0
  8138     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  8139     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8140     MOVE X'2020233030303037303835' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 165
* EL652.cbl
  8141     CALL 'kxdfhei1' USING DFHEIV0,
  8142           MAP-NAME,
  8143           EL652AO,
  8144           DFHEIV12,
  8145           MAPSET-NAME,
  8146           DFHEIV99,
  8147           DFHEIV99,
  8148           DFHEIV99,
  8149           DFHEIV11,
  8150           DFHEIV99,
  8151           DFHEIV99,
  8152           DFHEIV99
  8153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8154
  8155
  8156     GO TO 9100-RETURN-TRAN.
  8157
  8158 8300-SEND-TEXT.
  8159
  8160* EXEC CICS SEND TEXT
  8161*        FROM    (LOGOFF-TEXT)
  8162*        LENGTH  (LOGOFF-LENGTH)
  8163*        ERASE
  8164*        FREEKB
  8165*    END-EXEC.
  8166*    MOVE '8&      T  E F  H   F -   #00007096' TO DFHEIV0
  8167     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8168     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8169     MOVE X'2020233030303037303936' TO DFHEIV0(25:11)
  8170     CALL 'kxdfhei1' USING DFHEIV0,
  8171           LOGOFF-TEXT,
  8172           LOGOFF-LENGTH,
  8173           DFHEIV99,
  8174           DFHEIV99,
  8175           DFHEIV99,
  8176           DFHEIV99,
  8177           DFHEIV99,
  8178           DFHEIV99,
  8179           DFHEIV99,
  8180           DFHEIV99,
  8181           DFHEIV99,
  8182           DFHEIV99
  8183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8184
  8185
  8186
  8187* EXEC CICS RETURN
  8188*    END-EXEC.
  8189*    MOVE '.(                    ''   #00007103' TO DFHEIV0
  8190     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8191     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8192     MOVE X'2020233030303037313033' TO DFHEIV0(25:11)
  8193     CALL 'kxdfhei1' USING DFHEIV0,
  8194           DFHEIV99,
  8195           DFHEIV99,
  8196           DFHEIV99,
  8197           DFHEIV99,
  8198           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 166
* EL652.cbl
  8199           DFHEIV99
  8200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8201
  8202
  8203 8400-LOG-JOURNAL-RECORD.
  8204     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  8205     MOVE FILE-ID                TO  JP-FILE-ID.
  8206     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  8207
  8208*    EXEC CICS JOURNAL
  8209*        JFILEID  (PI-JOURNAL-FILE-ID)
  8210*        JTYPEID  ('EL')
  8211*        FROM     (JOURNAL-RECORD)
  8212*        LENGTH   (473)
  8213*    END-EXEC.
  8214
  8215 8800-UNAUTHORIZED-ACCESS.
  8216     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  8217
  8218     GO TO 8300-SEND-TEXT.
  8219
  8220 8810-PF23.
  8221     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  8222     MOVE XCTL-005               TO  PGM-NAME.
  8223
  8224     GO TO 9300-XCTL.
  8225
  8226 8880-NOT-FOUND.
  8227     MOVE ER-0142                TO  EMI-ERROR.
  8228     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8229
  8230     MOVE SPACE                  TO  PI-ERC-TYPE.
  8231     MOVE -1                     TO  MAINTYPL.
  8232
  8233     IF EIBTRNID NOT = TRANS-ID
  8234         GO TO 8100-SEND-INITIAL-MAP.
  8235
  8236     GO TO 8200-SEND-DATAONLY.
  8237
  8238 9100-RETURN-TRAN.
  8239     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  8240     MOVE '652A'                 TO  PI-CURRENT-SCREEN-NO.
  8241
  8242
  8243* EXEC CICS RETURN
  8244*        TRANSID   (TRANS-ID)
  8245*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8246*        LENGTH    (PI-COMM-LENGTH)
  8247*    END-EXEC.
  8248*    MOVE '.(CT                  ''   #00007145' TO DFHEIV0
  8249     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8250     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8251     MOVE X'2020233030303037313435' TO DFHEIV0(25:11)
  8252     CALL 'kxdfhei1' USING DFHEIV0,
  8253           TRANS-ID,
  8254           PROGRAM-INTERFACE-BLOCK,
  8255           PI-COMM-LENGTH,
  8256           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 167
* EL652.cbl
  8257           DFHEIV99,
  8258           DFHEIV99
  8259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8260
  8261
  8262 9200-RETURN-MAIN-MENU.
  8263
  8264     IF  MORTGAGE-SESSION
  8265         MOVE XCTL-EM626         TO PGM-NAME
  8266     ELSE
  8267         IF  CREDIT-SESSION
  8268             MOVE XCTL-626       TO PGM-NAME
  8269         ELSE
  8270             MOVE XCTL-126       TO PGM-NAME.
  8271
  8272     GO TO 9300-XCTL.
  8273
  8274 9300-XCTL.
  8275
  8276* EXEC CICS XCTL
  8277*        PROGRAM   (PGM-NAME)
  8278*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8279*        LENGTH    (PI-COMM-LENGTH)
  8280*    END-EXEC.
  8281*    MOVE '.$C                   %   #00007164' TO DFHEIV0
  8282     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8283     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8284     MOVE X'2020233030303037313634' TO DFHEIV0(25:11)
  8285     CALL 'kxdfhei1' USING DFHEIV0,
  8286           PGM-NAME,
  8287           PROGRAM-INTERFACE-BLOCK,
  8288           PI-COMM-LENGTH,
  8289           DFHEIV99
  8290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8291
  8292
  8293 9400-CLEAR.
  8294     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  8295
  8296     GO TO 9300-XCTL.
  8297
  8298 9500-PF12.
  8299     MOVE XCTL-010               TO  PGM-NAME.
  8300
  8301     GO TO 9300-XCTL.
  8302
  8303 9600-PGMID-ERROR.
  8304
  8305* EXEC CICS HANDLE CONDITION
  8306*        PGMIDERR  (8300-SEND-TEXT)
  8307*    END-EXEC.
  8308*    MOVE '"$L                   ! 7 #00007181' TO DFHEIV0
  8309     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8310     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8311     MOVE X'3720233030303037313831' TO DFHEIV0(25:11)
  8312     CALL 'kxdfhei1' USING DFHEIV0
  8313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8314
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 168
* EL652.cbl
  8315
  8316     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  8317     MOVE ' '                    TO  PI-ENTRY-CD-1.
  8318     MOVE XCTL-005               TO  PGM-NAME.
  8319     MOVE PGM-NAME               TO  LOGOFF-PGM.
  8320     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  8321
  8322     GO TO 9300-XCTL.
  8323
  8324 9700-LINK-DATE-CONVERT.
  8325
  8326* EXEC CICS LINK
  8327*        PROGRAM   ('ELDATCV')
  8328*        COMMAREA  (DATE-CONVERSION-DATA)
  8329*        LENGTH    (DC-COMM-LENGTH)
  8330*    END-EXEC.
  8331     MOVE 'ELDATCV' TO DFHEIV1
  8332*    MOVE '."C                   (   #00007194' TO DFHEIV0
  8333     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8334     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8335     MOVE X'2020233030303037313934' TO DFHEIV0(25:11)
  8336     CALL 'kxdfhei1' USING DFHEIV0,
  8337           DFHEIV1,
  8338           DATE-CONVERSION-DATA,
  8339           DC-COMM-LENGTH,
  8340           DFHEIV99,
  8341           DFHEIV99,
  8342           DFHEIV99,
  8343           DFHEIV99
  8344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8345
  8346
  8347 9700-EXIT.
  8348     EXIT.
  8349
  8350 9900-ERROR-FORMAT.
  8351     IF NOT EMI-ERRORS-COMPLETE
  8352         MOVE LINK-001           TO  PGM-NAME
  8353
  8354* EXEC CICS LINK
  8355*            PROGRAM   (PGM-NAME)
  8356*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  8357*            LENGTH    (EMI-COMM-LENGTH)
  8358*        END-EXEC.
  8359*    MOVE '."C                   (   #00007206' TO DFHEIV0
  8360     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8361     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8362     MOVE X'2020233030303037323036' TO DFHEIV0(25:11)
  8363     CALL 'kxdfhei1' USING DFHEIV0,
  8364           PGM-NAME,
  8365           ERROR-MESSAGE-INTERFACE-BLOCK,
  8366           EMI-COMM-LENGTH,
  8367           DFHEIV99,
  8368           DFHEIV99,
  8369           DFHEIV99,
  8370           DFHEIV99
  8371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8372
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 169
* EL652.cbl
  8373
  8374 9900-EXIT.
  8375     EXIT.
  8376
  8377 9910-INITIALIZE-SECURITY.
  8378******************************************************************
  8379*                                                                *
  8380*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  8381*       USER SECURITY RECORD SET UP BY EL125.  THIS PROGRAM      *
  8382*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  8383*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  8384*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  8385*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  8386*                                                                *
  8387******************************************************************
  8388
  8389     IF  PI-PROCESSOR-ID NOT = 'LGXX'
  8390
  8391         IF  MORTGAGE-SESSION
  8392             MOVE '125E'             TO SC-QUID-SYSTEM
  8393             MOVE EIBTRMID           TO SC-QUID-TERMINAL
  8394
  8395
  8396* EXEC CICS READQ TS
  8397*                QUEUE  (SC-QUID-KEY)
  8398*                INTO   (SECURITY-CONTROL-E)
  8399*                LENGTH (SC-COMM-LENGTH-E)
  8400*                ITEM   (SC-ITEM)
  8401*            END-EXEC
  8402*    MOVE '*$II   L              ''   #00007233' TO DFHEIV0
  8403     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8404     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8405     MOVE X'2020233030303037323333' TO DFHEIV0(25:11)
  8406     CALL 'kxdfhei1' USING DFHEIV0,
  8407           SC-QUID-KEY,
  8408           SECURITY-CONTROL-E,
  8409           SC-COMM-LENGTH-E,
  8410           SC-ITEM,
  8411           DFHEIV99,
  8412           DFHEIV99
  8413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8414
  8415             MOVE SC-MP-DISPLAY (W-APPL-SCRTY-NDX)
  8416                                     TO PI-DISPLAY-CAP
  8417             MOVE SC-MP-UPDATE (W-APPL-SCRTY-NDX)
  8418                                     TO PI-MODIFY-CAP
  8419
  8420             IF  NOT DISPLAY-CAP
  8421                 MOVE 'READ'         TO SM-READ
  8422                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8423                 MOVE ER-9097        TO EMI-ERROR
  8424                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8425                 GO TO 8100-SEND-INITIAL-MAP
  8426             ELSE
  8427                 GO TO 9910-EXIT
  8428         ELSE
  8429
  8430* EXEC CICS  READQ TS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 170
* EL652.cbl
  8431*                QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8432*                INTO    (SECURITY-CONTROL)
  8433*                LENGTH  (SC-COMM-LENGTH)
  8434*                ITEM    (SC-ITEM-CL-CR)
  8435*                END-EXEC
  8436*    MOVE '*$II   L              ''   #00007254' TO DFHEIV0
  8437     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8438     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8439     MOVE X'2020233030303037323534' TO DFHEIV0(25:11)
  8440     CALL 'kxdfhei1' USING DFHEIV0,
  8441           PI-SECURITY-TEMP-STORE-ID,
  8442           SECURITY-CONTROL,
  8443           SC-COMM-LENGTH,
  8444           SC-ITEM-CL-CR,
  8445           DFHEIV99,
  8446           DFHEIV99
  8447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8448
  8449             MOVE SC-CREDIT-DISPLAY (05)
  8450                                 TO PI-DISPLAY-CAP
  8451             MOVE SC-CREDIT-UPDATE  (05)
  8452                                 TO PI-MODIFY-CAP
  8453
  8454             IF  NOT DISPLAY-CAP
  8455                 MOVE 'READ'     TO SM-READ
  8456                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8457                 MOVE ER-0070    TO  EMI-ERROR
  8458                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8459                 GO TO 8100-SEND-INITIAL-MAP.
  8460
  8461 9910-EXIT.
  8462     EXIT.
  8463
  8464 9990-ABEND.
  8465     MOVE LINK-004               TO  PGM-NAME.
  8466     MOVE DFHEIBLK               TO  EMI-LINE1.
  8467
  8468
  8469* EXEC CICS LINK
  8470*        PROGRAM   (PGM-NAME)
  8471*        COMMAREA  (EMI-LINE1)
  8472*        LENGTH    (72)
  8473*    END-EXEC.
  8474     MOVE 72
  8475       TO DFHEIV11
  8476*    MOVE '."C                   (   #00007280' TO DFHEIV0
  8477     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8478     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8479     MOVE X'2020233030303037323830' TO DFHEIV0(25:11)
  8480     CALL 'kxdfhei1' USING DFHEIV0,
  8481           PGM-NAME,
  8482           EMI-LINE1,
  8483           DFHEIV11,
  8484           DFHEIV99,
  8485           DFHEIV99,
  8486           DFHEIV99,
  8487           DFHEIV99
  8488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 171
* EL652.cbl
  8489
  8490
  8491     GO TO 8200-SEND-DATAONLY.
  8492
  8493 9995-SECURITY-VIOLATION.
  8494*           COPY ELCSCTP.
  8495******************************************************************
  8496*                                                                *
  8497*                            ELCSCTP                             *
  8498*                            VMOD=2.001                          *
  8499*                                                                *
  8500*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8501******************************************************************
  8502
  8503
  8504     MOVE EIBDATE          TO SM-JUL-DATE.
  8505     MOVE EIBTRMID         TO SM-TERMID.
  8506     MOVE THIS-PGM         TO SM-PGM.
  8507     MOVE EIBTIME          TO TIME-IN.
  8508     MOVE TIME-OUT         TO SM-TIME.
  8509     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8510
  8511
  8512* EXEC CICS LINK
  8513*         PROGRAM  ('EL003')
  8514*         COMMAREA (SECURITY-MESSAGE)
  8515*         LENGTH   (80)
  8516*    END-EXEC.
  8517     MOVE 'EL003' TO DFHEIV1
  8518     MOVE 80
  8519       TO DFHEIV11
  8520*    MOVE '."C                   (   #00007306' TO DFHEIV0
  8521     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8522     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8523     MOVE X'2020233030303037333036' TO DFHEIV0(25:11)
  8524     CALL 'kxdfhei1' USING DFHEIV0,
  8525           DFHEIV1,
  8526           SECURITY-MESSAGE,
  8527           DFHEIV11,
  8528           DFHEIV99,
  8529           DFHEIV99,
  8530           DFHEIV99,
  8531           DFHEIV99
  8532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8533
  8534
  8535******************************************************************
  8536
  8537 9995-EXIT.
  8538      EXIT.
  8539
  8540 9999-DFHBACK SECTION.
  8541     MOVE '9%                    "   ' TO DFHEIV0
  8542     MOVE 'EL652' TO DFHEIV1
  8543     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8544     GOBACK.
  8545 9999-DFHEXIT.
  8546     IF DFHEIGDJ EQUAL 0001
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 172
* EL652.cbl
  8547         NEXT SENTENCE
  8548     ELSE IF DFHEIGDJ EQUAL 2
  8549         GO TO 9990-ABEND,
  8550               8880-NOT-FOUND,
  8551               9600-PGMID-ERROR,
  8552               9990-ABEND
  8553         DEPENDING ON DFHEIGDI
  8554     ELSE IF DFHEIGDJ EQUAL 3
  8555         GO TO 3400-EXIT
  8556         DEPENDING ON DFHEIGDI
  8557     ELSE IF DFHEIGDJ EQUAL 4
  8558         GO TO 3450-EXIT
  8559         DEPENDING ON DFHEIGDI
  8560     ELSE IF DFHEIGDJ EQUAL 5
  8561         GO TO 9990-ABEND,
  8562               8880-NOT-FOUND,
  8563               9600-PGMID-ERROR,
  8564               9990-ABEND
  8565         DEPENDING ON DFHEIGDI
  8566     ELSE IF DFHEIGDJ EQUAL 6
  8567         GO TO 3475-EXIT
  8568         DEPENDING ON DFHEIGDI
  8569     ELSE IF DFHEIGDJ EQUAL 7
  8570         GO TO 9990-ABEND,
  8571               4250-CONT
  8572         DEPENDING ON DFHEIGDI
  8573     ELSE IF DFHEIGDJ EQUAL 8
  8574         GO TO 4300-EXIT
  8575         DEPENDING ON DFHEIGDI
  8576     ELSE IF DFHEIGDJ EQUAL 9
  8577         GO TO 4750-NO-STATE
  8578         DEPENDING ON DFHEIGDI
  8579     ELSE IF DFHEIGDJ EQUAL 10
  8580         GO TO 6550-END-BROWSE,
  8581               6550-END-BROWSE
  8582         DEPENDING ON DFHEIGDI
  8583     ELSE IF DFHEIGDJ EQUAL 11
  8584         GO TO 6550-END-BROWSE,
  8585               6550-END-BROWSE
  8586         DEPENDING ON DFHEIGDI
  8587     ELSE IF DFHEIGDJ EQUAL 12
  8588         GO TO 6599-EXIT,
  8589               6599-EXIT
  8590         DEPENDING ON DFHEIGDI
  8591     ELSE IF DFHEIGDJ EQUAL 13
  8592         GO TO 7250-ENDFILE,
  8593               7250-ENDFILE,
  8594               9990-ABEND
  8595         DEPENDING ON DFHEIGDI
  8596     ELSE IF DFHEIGDJ EQUAL 14
  8597         GO TO 7250-ENDFILE,
  8598               7275-NOTFOUND
  8599         DEPENDING ON DFHEIGDI
  8600     ELSE IF DFHEIGDJ EQUAL 15
  8601         GO TO 7375-ENDFILE,
  8602               7375-ENDFILE,
  8603               9990-ABEND
  8604         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:41 Page 173
* EL652.cbl
  8605     ELSE IF DFHEIGDJ EQUAL 16
  8606         GO TO 7375-ENDFILE,
  8607               7275-NOTFOUND
  8608         DEPENDING ON DFHEIGDI
  8609     ELSE IF DFHEIGDJ EQUAL 17
  8610         GO TO 7490-NOT-FOUND,
  8611               9990-ABEND
  8612         DEPENDING ON DFHEIGDI
  8613     ELSE IF DFHEIGDJ EQUAL 18
  8614         GO TO 7550-DUP
  8615         DEPENDING ON DFHEIGDI
  8616     ELSE IF DFHEIGDJ EQUAL 19
  8617         GO TO 7540-WRITE
  8618         DEPENDING ON DFHEIGDI
  8619     ELSE IF DFHEIGDJ EQUAL 20
  8620         GO TO 7699-EXIT
  8621         DEPENDING ON DFHEIGDI
  8622     ELSE IF DFHEIGDJ EQUAL 21
  8623         GO TO 7630-DELETE
  8624         DEPENDING ON DFHEIGDI
  8625     ELSE IF DFHEIGDJ EQUAL 22
  8626         GO TO 8000-EXIT
  8627         DEPENDING ON DFHEIGDI
  8628     ELSE IF DFHEIGDJ EQUAL 23
  8629         GO TO 8300-SEND-TEXT
  8630         DEPENDING ON DFHEIGDI.
  8631     MOVE '9%                    "   ' TO DFHEIV0
  8632     MOVE 'EL652' TO DFHEIV1
  8633     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8634     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6812     Code:       25565
