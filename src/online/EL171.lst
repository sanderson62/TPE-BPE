* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL171.cbl
* Options: int("EL171.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL171.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL171.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL171.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL171.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/13/96 09:31:11.
     7*                            VMOD=2.004.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    REPORT MENU.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL171.cbl
    14
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 012103                   SMVA  FIX SELECT CODE FUNCTIONALITY
    24* 121703                   SMVA  DISABLE PF11 CHECK RECON
    25******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL171.cbl
    27 ENVIRONMENT DIVISION.
    28 DATA DIVISION.
    29 WORKING-STORAGE SECTION.
    30 01  DFH-START PIC X(04).
    31 77  FILLER  PIC X(32)  VALUE '********************************'.
    32 77  FILLER  PIC X(32)  VALUE '*    EL171 WORKING STORAGE     *'.
    33 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.004 *********'.
    34
    35*                                COPY ELCSCTM.
    36******************************************************************
    37*                                                                *
    38*                                                                *
    39*                            ELCSCTM                             *
    40*                            VMOD=2.001                          *
    41*                                                                *
    42*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    43*                                                                *
    44******************************************************************
    45 01  SECURITY-MESSAGE.
    46     12  FILLER                          PIC X(30)
    47            VALUE '** LOGIC SECURITY VIOLATION -'.
    48     12  SM-READ                         PIC X(6).
    49     12  FILLER                          PIC X(5)
    50            VALUE ' PGM='.
    51     12  SM-PGM                          PIC X(6).
    52     12  FILLER                          PIC X(5)
    53            VALUE ' OPR='.
    54     12  SM-PROCESSOR-ID                 PIC X(4).
    55     12  FILLER                          PIC X(6)
    56            VALUE ' TERM='.
    57     12  SM-TERMID                       PIC X(4).
    58     12  FILLER                          PIC XX   VALUE SPACE.
    59     12  SM-JUL-DATE                     PIC 9(5).
    60     12  FILLER                          PIC X    VALUE SPACE.
    61     12  SM-TIME                         PIC 99.99.
    62
    63
    64*                                COPY ELCSCRTY.
    65******************************************************************
    66*                                                                *
    67*                                                                *
    68*                            ELCSCRTY                            *
    69*                            VMOD=2.001                          *
    70*                                                                *
    71*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    72*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    73*        SAVED IN PI-SECURITY-ADDRESS.                           *
    74*                                                                *
    75******************************************************************
    76 01  SECURITY-CONTROL.
    77     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    78     12  FILLER                       PIC XX    VALUE 'SC'.
    79     12  SC-CREDIT-CODES.
    80         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    81             20  SC-CREDIT-DISPLAY    PIC X.
    82             20  SC-CREDIT-UPDATE     PIC X.
    83     12  SC-CLAIMS-CODES.
    84         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL171.cbl
    85             20  SC-CLAIMS-DISPLAY    PIC X.
    86             20  SC-CLAIMS-UPDATE     PIC X.
    87
    88 01  WS-DATE-AREA.
    89     05  SAVE-DATE               PIC X(8)    VALUE SPACES.
    90     05  SAVE-BIN-DATE           PIC X(2)    VALUE SPACES.
    91
    92 01  MISC-WORK-AREAS.
    93     12  SC-ITEM                 PIC S9(4)   VALUE +0001  COMP.
    94     12  MAP-NAME                PIC X(8)    VALUE 'EL171A  '.
    95     12  MAPSET-NAME             PIC X(8)    VALUE 'EL171S  '.
    96     12  TRANS-ID                PIC X(4)    VALUE 'EX01'.
    97     12  THIS-PGM                PIC X(8)    VALUE 'EL171   '.
    98     12  PGM-NAME                PIC X(8).
    99     12  TIME-IN                 PIC S9(7).
   100     12  TIME-OUT-R  REDEFINES TIME-IN.
   101         16  FILLER              PIC X.
   102         16  TIME-OUT            PIC 99V99.
   103         16  FILLER              PIC X(2).
   104     12  XCTL-005                PIC X(5)    VALUE 'EL005'.
   105     12  XCTL-010                PIC X(5)    VALUE 'EL010'.
   106     12  XCTL-172                PIC X(5)    VALUE 'EL172'.
   107     12  XCTL-173                PIC X(5)    VALUE 'EL173'.
   108     12  XCTL-174                PIC X(5)    VALUE 'EL174'.
   109     12  XCTL-175                PIC X(5)    VALUE 'EL175'.
   110     12  XCTL-176                PIC X(5)    VALUE 'EL176'.
   111     12  XCTL-178                PIC X(5)    VALUE 'EL178'.
   112     12  XCTL-179                PIC X(5)    VALUE 'EL179'.
   113     12  XCTL-180                PIC X(5)    VALUE 'EL180'.
   114     12  XCTL-181                PIC X(5)    VALUE 'EL181'.
   115     12  XCTL-183                PIC X(5)    VALUE 'EL183'.
   116     12  XCTL-126                PIC X(5)    VALUE 'EL126'.
   117     12  XCTL-146                PIC X(5)    VALUE 'EL146'.
   118     12  LINK-001                PIC X(5)    VALUE 'EL001'.
   119     12  LINK-004                PIC X(5)    VALUE 'EL004'.
   120
   121     12  ER-0004                 PIC X(4)    VALUE '0004'.
   122     12  ER-0070                 PIC X(4)    VALUE '0070'.
   123     12  ER-7008                 PIC X(4)    VALUE '7008'.
   124     12  ER-0029                 PIC X(4)    VALUE '0029'.
   125     12  ER-2371                 PIC X(4)    VALUE '2371'.
   126     12  ER-9812                 PIC X(4)    VALUE '9812'.
   127
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL171.cbl
   129*                                COPY ELCLOGOF.
   130******************************************************************
   131*                                                                *
   132*                                                                *
   133*                            ELCLOGOF.                           *
   134*                            VMOD=2.001                          *
   135*                                                                *
   136*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   137*                                                                *
   138******************************************************************
   139 01  CLASIC-LOGOFF.
   140     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   141     12  LOGOFF-TEXT.
   142         16  FILLER          PIC X(5)    VALUE SPACES.
   143         16  LOGOFF-MSG.
   144             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   145             20  FILLER      PIC X       VALUE SPACES.
   146             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   147         16  FILLER          PIC X(80)
   148           VALUE '* YOU ARE NOW LOGGED OFF'.
   149         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   150         16  FILLER          PIC X       VALUE QUOTE.
   151         16  LOGOFF-SYS-MSG  PIC X(17)
   152           VALUE 'S CLAS-IC SYSTEM '.
   153     12  TEXT-MESSAGES.
   154         16  UNACCESS-MSG    PIC X(29)
   155             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   156         16  PGMIDERR-MSG    PIC X(17)
   157             VALUE 'PROGRAM NOT FOUND'.
   158
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL171.cbl
   160*                                COPY ELCDATE.
   161******************************************************************
   162*                                                                *
   163*                                                                *
   164*                            ELCDATE.                            *
   165*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   166*                            VMOD=2.003
   167*                                                                *
   168*                                                                *
   169*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   170*                 LENGTH = 200                                   *
   171******************************************************************
   172
   173 01  DATE-CONVERSION-DATA.
   174     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   175     12  DC-OPTION-CODE                PIC X.
   176         88  BIN-TO-GREG                VALUE ' '.
   177         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   178         88  EDIT-GREG-TO-BIN           VALUE '2'.
   179         88  YMD-GREG-TO-BIN            VALUE '3'.
   180         88  MDY-GREG-TO-BIN            VALUE '4'.
   181         88  JULIAN-TO-BIN              VALUE '5'.
   182         88  BIN-PLUS-ELAPSED           VALUE '6'.
   183         88  FIND-CENTURY               VALUE '7'.
   184         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   185         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   186         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   187         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   188         88  JULIAN-TO-BIN-3            VALUE 'C'.
   189         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   190         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   191         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   192         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   193         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   194         88  CHECK-LEAP-YEAR            VALUE 'H'.
   195         88  BIN-3-TO-GREG              VALUE 'I'.
   196         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   197         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   198         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   199         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   200         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   201         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   202         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   203         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   204         88  THREE-CHARACTER-BIN
   205                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   206         88  GREGORIAN-TO-BIN
   207                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   208         88  BIN-TO-GREGORIAN
   209                  VALUES ' ' '1' 'I' '8' 'G'.
   210         88  JULIAN-TO-BINARY
   211                  VALUES '5' 'C' 'E' 'F'.
   212     12  DC-ERROR-CODE                 PIC X.
   213         88  NO-CONVERSION-ERROR        VALUE ' '.
   214         88  DATE-CONVERSION-ERROR
   215                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   216         88  DATE-IS-ZERO               VALUE '1'.
   217         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL171.cbl
   218         88  DATE-IS-INVALID            VALUE '3'.
   219         88  DATE1-GREATER-DATE2        VALUE '4'.
   220         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   221         88  DATE-INVALID-OPTION        VALUE '9'.
   222         88  INVALID-CENTURY            VALUE 'A'.
   223         88  ONLY-CENTURY               VALUE 'B'.
   224         88  ONLY-LEAP-YEAR             VALUE 'C'.
   225         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   226     12  DC-END-OF-MONTH               PIC X.
   227         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   228     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   229         88  USE-NORMAL-PROCESS         VALUE ' '.
   230         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   231         88  ADJUST-UP-100-YRS          VALUE '2'.
   232     12  FILLER                        PIC X.
   233     12  DC-CONVERSION-DATES.
   234         16  DC-BIN-DATE-1             PIC XX.
   235         16  DC-BIN-DATE-2             PIC XX.
   236         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   237         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   238                       DC-GREG-DATE-1-EDIT.
   239             20  DC-EDIT1-MONTH        PIC 99.
   240             20  SLASH1-1              PIC X.
   241             20  DC-EDIT1-DAY          PIC 99.
   242             20  SLASH1-2              PIC X.
   243             20  DC-EDIT1-YEAR         PIC 99.
   244         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   245         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   246                     DC-GREG-DATE-2-EDIT.
   247             20  DC-EDIT2-MONTH        PIC 99.
   248             20  SLASH2-1              PIC X.
   249             20  DC-EDIT2-DAY          PIC 99.
   250             20  SLASH2-2              PIC X.
   251             20  DC-EDIT2-YEAR         PIC 99.
   252         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   253         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   254                     DC-GREG-DATE-1-YMD.
   255             20  DC-YMD-YEAR           PIC 99.
   256             20  DC-YMD-MONTH          PIC 99.
   257             20  DC-YMD-DAY            PIC 99.
   258         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   259         16  DC-GREG-DATE-1-MDY-R REDEFINES
   260                      DC-GREG-DATE-1-MDY.
   261             20  DC-MDY-MONTH          PIC 99.
   262             20  DC-MDY-DAY            PIC 99.
   263             20  DC-MDY-YEAR           PIC 99.
   264         16  DC-GREG-DATE-1-ALPHA.
   265             20  DC-ALPHA-MONTH        PIC X(10).
   266             20  DC-ALPHA-DAY          PIC 99.
   267             20  FILLER                PIC XX.
   268             20  DC-ALPHA-CENTURY.
   269                 24 DC-ALPHA-CEN-N     PIC 99.
   270             20  DC-ALPHA-YEAR         PIC 99.
   271         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   272         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   273         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   274         16  DC-JULIAN-DATE            PIC 9(05).
   275         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL171.cbl
   276                                       PIC 9(05).
   277         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   278             20  DC-JULIAN-YEAR        PIC 99.
   279             20  DC-JULIAN-DAYS        PIC 999.
   280         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   281         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   282         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   283     12  DATE-CONVERSION-VARIBLES.
   284         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   285         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   286             20  FILLER                PIC 9(3).
   287             20  HOLD-CEN-1-CCYY.
   288                 24  HOLD-CEN-1-CC     PIC 99.
   289                 24  HOLD-CEN-1-YY     PIC 99.
   290             20  HOLD-CEN-1-MO         PIC 99.
   291             20  HOLD-CEN-1-DA         PIC 99.
   292         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   293             20  HOLD-CEN-1-R-MO       PIC 99.
   294             20  HOLD-CEN-1-R-DA       PIC 99.
   295             20  HOLD-CEN-1-R-CCYY.
   296                 24  HOLD-CEN-1-R-CC   PIC 99.
   297                 24  HOLD-CEN-1-R-YY   PIC 99.
   298             20  FILLER                PIC 9(3).
   299         16  HOLD-CENTURY-1-X.
   300             20  FILLER                PIC X(3)  VALUE SPACES.
   301             20  HOLD-CEN-1-X-CCYY.
   302                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   303                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   304             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   305             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   306         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   307             20  HOLD-CEN-1-R-X-MO     PIC XX.
   308             20  HOLD-CEN-1-R-X-DA     PIC XX.
   309             20  HOLD-CEN-1-R-X-CCYY.
   310                 24  HOLD-CEN-1-R-X-CC PIC XX.
   311                 24  HOLD-CEN-1-R-X-YY PIC XX.
   312             20  FILLER                PIC XXX.
   313         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   314         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   315         16  DC-JULIAN-DATE-1          PIC 9(07).
   316         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   317             20  DC-JULIAN-1-CCYY.
   318                 24  DC-JULIAN-1-CC    PIC 99.
   319                 24  DC-JULIAN-1-YR    PIC 99.
   320             20  DC-JULIAN-DA-1        PIC 999.
   321         16  DC-JULIAN-DATE-2          PIC 9(07).
   322         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   323             20  DC-JULIAN-2-CCYY.
   324                 24  DC-JULIAN-2-CC    PIC 99.
   325                 24  DC-JULIAN-2-YR    PIC 99.
   326             20  DC-JULIAN-DA-2        PIC 999.
   327         16  DC-GREG-DATE-A-EDIT.
   328             20  DC-EDITA-MONTH        PIC 99.
   329             20  SLASHA-1              PIC X VALUE '/'.
   330             20  DC-EDITA-DAY          PIC 99.
   331             20  SLASHA-2              PIC X VALUE '/'.
   332             20  DC-EDITA-CCYY.
   333                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL171.cbl
   334                 24  DC-EDITA-YEAR     PIC 99.
   335         16  DC-GREG-DATE-B-EDIT.
   336             20  DC-EDITB-MONTH        PIC 99.
   337             20  SLASHB-1              PIC X VALUE '/'.
   338             20  DC-EDITB-DAY          PIC 99.
   339             20  SLASHB-2              PIC X VALUE '/'.
   340             20  DC-EDITB-CCYY.
   341                 24  DC-EDITB-CENT     PIC 99.
   342                 24  DC-EDITB-YEAR     PIC 99.
   343         16  DC-GREG-DATE-CYMD         PIC 9(08).
   344         16  DC-GREG-DATE-CYMD-R REDEFINES
   345                              DC-GREG-DATE-CYMD.
   346             20  DC-CYMD-CEN           PIC 99.
   347             20  DC-CYMD-YEAR          PIC 99.
   348             20  DC-CYMD-MONTH         PIC 99.
   349             20  DC-CYMD-DAY           PIC 99.
   350         16  DC-GREG-DATE-MDCY         PIC 9(08).
   351         16  DC-GREG-DATE-MDCY-R REDEFINES
   352                              DC-GREG-DATE-MDCY.
   353             20  DC-MDCY-MONTH         PIC 99.
   354             20  DC-MDCY-DAY           PIC 99.
   355             20  DC-MDCY-CEN           PIC 99.
   356             20  DC-MDCY-YEAR          PIC 99.
   357    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   358        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   359    12  DC-EL310-DATE                  PIC X(21).
   360    12  FILLER                         PIC X(28).
   361
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL171.cbl
   363*                                COPY ELCATTR.
   364******************************************************************
   365*                                                                *
   366*                            ELCATTR.                            *
   367*                            VMOD=2.001                          *
   368*                                                                *
   369*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   370*                                                                *
   371*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   372*                                                                *
   373*                   POS 1   P=PROTECTED                          *
   374*                           U=UNPROTECTED                        *
   375*                           S=ASKIP                              *
   376*                   POS 2   A=ALPHA/NUMERIC                      *
   377*                           N=NUMERIC                            *
   378*                   POS 3   N=NORMAL                             *
   379*                           B=BRIGHT                             *
   380*                           D=DARK                               *
   381*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   382*                           OF=MODIFIED DATA TAG OFF             *
   383*                                                                *
   384*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   385******************************************************************
   386 01  ATTRIBUTE-LIST.
   387     12  AL-PABOF            PIC X       VALUE 'Y'.
   388     12  AL-PABON            PIC X       VALUE 'Z'.
   389     12  AL-PADOF            PIC X       VALUE '%'.
   390     12  AL-PADON            PIC X       VALUE '_'.
   391     12  AL-PANOF            PIC X       VALUE '-'.
   392     12  AL-PANON            PIC X       VALUE '/'.
   393     12  AL-SABOF            PIC X       VALUE '8'.
   394     12  AL-SABON            PIC X       VALUE '9'.
   395     12  AL-SADOF            PIC X       VALUE '@'.
   396     12  AL-SADON            PIC X       VALUE QUOTE.
   397     12  AL-SANOF            PIC X       VALUE '0'.
   398     12  AL-SANON            PIC X       VALUE '1'.
   399     12  AL-UABOF            PIC X       VALUE 'H'.
   400     12  AL-UABON            PIC X       VALUE 'I'.
   401     12  AL-UADOF            PIC X       VALUE '<'.
   402     12  AL-UADON            PIC X       VALUE '('.
   403     12  AL-UANOF            PIC X       VALUE ' '.
   404     12  AL-UANON            PIC X       VALUE 'A'.
   405     12  AL-UNBOF            PIC X       VALUE 'Q'.
   406     12  AL-UNBON            PIC X       VALUE 'R'.
   407     12  AL-UNDOF            PIC X       VALUE '*'.
   408     12  AL-UNDON            PIC X       VALUE ')'.
   409     12  AL-UNNOF            PIC X       VALUE '&'.
   410     12  AL-UNNON            PIC X       VALUE 'J'.
   411
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL171.cbl
   413*                                COPY ELCEMIB.
   414******************************************************************
   415*                                                                *
   416*                                                                *
   417*                            ELCEMIB.                            *
   418*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   419*                            VMOD=2.005                          *
   420*                                                                *
   421*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   422*                                                                *
   423******************************************************************
   424 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   425     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   426     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   427     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   428     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   429     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   430     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   431     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   432     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   433     12  EMI-SWITCH1             PIC X        VALUE '1'.
   434         88  EMI-NO-ERRORS                    VALUE '1'.
   435         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   436         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   437     12  EMI-SWITCH2             PIC X        VALUE '1'.
   438         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   439     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   440         88  EMI-AREA1-EMPTY                  VALUE '1'.
   441         88  EMI-AREA1-FULL                   VALUE '2'.
   442     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   443         88  EMI-AREA2-EMPTY                  VALUE '1'.
   444         88  EMI-AREA2-FULL                   VALUE '2'.
   445     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   446         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   447         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   448         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   449         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   450         88  EMI-BYPASS-FATALS                VALUE 'X'.
   451     12  EMI-ERROR-LINES.
   452         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   453         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   454         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   455         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   456             20  EMI-ERR-CODES OCCURS 10 TIMES.
   457                 24  EMI-ERR-NUM         PIC X(4).
   458                 24  EMI-FILLER          PIC X.
   459                 24  EMI-SEV             PIC X.
   460                 24  FILLER              PIC X.
   461             20  FILLER                  PIC X(02).
   462     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   463         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   464             20  EMI-ERROR-NUMBER    PIC X(4).
   465             20  EMI-FILL            PIC X.
   466             20  EMI-SEVERITY        PIC X.
   467             20  FILLER              PIC X.
   468             20  EMI-ERROR-TEXT.
   469                 24  EMI-TEXT-VARIABLE   PIC X(10).
   470                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL171.cbl
   471     12  EMI-SEVERITY-SAVE           PIC X.
   472         88  EMI-NOTE                    VALUE 'N'.
   473         88  EMI-WARNING                 VALUE 'W'.
   474         88  EMI-FORCABLE                VALUE 'F'.
   475         88  EMI-FATAL                   VALUE 'X'.
   476     12  EMI-MESSAGE-FLAG            PIC X.
   477         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   478         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   479     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   480     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   481         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   482         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   483         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   484     12  FILLER                      PIC X(137)  VALUE SPACES.
   485     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   486     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   487     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   488     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   489
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL171.cbl
   491*                                COPY ELCINTF.
   492******************************************************************
   493*                                                                *
   494*                                                                *
   495*                            ELCINTF.                            *
   496*                            VMOD=2.017                          *
   497*                                                                *
   498*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   499*                                                                *
   500*       LENGTH = 1024                                            *
   501*                                                                *
   502******************************************************************
   503 01  PROGRAM-INTERFACE-BLOCK.
   504     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   505     12  PI-CALLING-PROGRAM              PIC X(8).
   506     12  PI-SAVED-PROGRAM-1              PIC X(8).
   507     12  PI-SAVED-PROGRAM-2              PIC X(8).
   508     12  PI-SAVED-PROGRAM-3              PIC X(8).
   509     12  PI-SAVED-PROGRAM-4              PIC X(8).
   510     12  PI-SAVED-PROGRAM-5              PIC X(8).
   511     12  PI-SAVED-PROGRAM-6              PIC X(8).
   512     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   513     12  PI-COMPANY-ID                   PIC XXX.
   514     12  PI-COMPANY-CD                   PIC X.
   515
   516     12  PI-COMPANY-PASSWORD             PIC X(8).
   517
   518     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   519
   520     12  PI-CONTROL-IN-PROGRESS.
   521         16  PI-CARRIER                  PIC X.
   522         16  PI-GROUPING                 PIC X(6).
   523         16  PI-STATE                    PIC XX.
   524         16  PI-ACCOUNT                  PIC X(10).
   525         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   526                                         PIC X(10).
   527         16  PI-CLAIM-CERT-GRP.
   528             20  PI-CLAIM-NO             PIC X(7).
   529             20  PI-CERT-NO.
   530                 25  PI-CERT-PRIME       PIC X(10).
   531                 25  PI-CERT-SFX         PIC X.
   532             20  PI-CERT-EFF-DT          PIC XX.
   533         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   534             20  PI-PLAN-CODE            PIC X(2).
   535             20  PI-REVISION-NUMBER      PIC X(3).
   536             20  PI-PLAN-EFF-DT          PIC X(2).
   537             20  PI-PLAN-EXP-DT          PIC X(2).
   538             20  FILLER                  PIC X(11).
   539         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   540             20  PI-OE-REFERENCE-1.
   541                 25  PI-OE-REF-1-PRIME   PIC X(18).
   542                 25  PI-OE-REF-1-SUFF    PIC XX.
   543
   544     12  PI-SESSION-IN-PROGRESS          PIC X.
   545         88  CLAIM-SESSION                   VALUE '1'.
   546         88  CREDIT-SESSION                  VALUE '2'.
   547         88  WARRANTY-SESSION                VALUE '3'.
   548         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL171.cbl
   549         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   550
   551
   552*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   553
   554     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   555     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   556
   557     12  PI-CREDIT-USER                  PIC X.
   558         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   559         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   560
   561     12  PI-CLAIM-USER                   PIC X.
   562         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   563         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   564
   565     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   566         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   567         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   568         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   569         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   570         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   571
   572     12  PI-PROCESSOR-ID                 PIC X(4).
   573
   574     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   575
   576     12  PI-MEMBER-CAPTION               PIC X(10).
   577
   578     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   579         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   580
   581     12  PI-LIFE-OVERRIDE-L1             PIC X.
   582     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   583     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   584     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   585
   586     12  PI-AH-OVERRIDE-L1               PIC X.
   587     12  PI-AH-OVERRIDE-L2               PIC XX.
   588     12  PI-AH-OVERRIDE-L6               PIC X(6).
   589     12  PI-AH-OVERRIDE-L12              PIC X(12).
   590
   591     12  PI-NEW-SYSTEM                   PIC X(2).
   592
   593     12  PI-PRIMARY-CERT-NO              PIC X(11).
   594     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   595         88  PI-USES-PAID-TO                 VALUE '1'.
   596     12  PI-CRDTCRD-SYSTEM.
   597         16  PI-CRDTCRD-USER             PIC X.
   598             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   599             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   600         16  PI-CC-MONTH-END-DT          PIC XX.
   601     12  PI-PROCESSOR-PRINTER            PIC X(4).
   602
   603     12  PI-OE-REFERENCE-2.
   604         16  PI-OE-REF-2-PRIME           PIC X(10).
   605         16  PI-OE-REF-2-SUFF            PIC X.
   606
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL171.cbl
   607     12  PI-REM-TRM-CALC-OPTION          PIC X.
   608
   609     12  PI-LANGUAGE-TYPE                PIC X.
   610             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   611             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   612             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   613
   614     12  PI-POLICY-LINKAGE-IND           PIC X.
   615         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   616         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   617                                                   LOW-VALUES.
   618
   619     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   620     12  PI-CLAIM-PW-SESSION             PIC X(1).
   621         88  PI-CLAIM-CREDIT                 VALUE '1'.
   622         88  PI-CLAIM-CONVEN                 VALUE '2'.
   623     12  FILLER                          PIC X(4).
   624
   625     12  PI-SYSTEM-LEVEL                 PIC X(145).
   626
   627     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   628         PI-SYSTEM-LEVEL.
   629
   630         16  PI-ENTRY-CODES.
   631             20  PI-ENTRY-CD-1           PIC X.
   632             20  PI-ENTRY-CD-2           PIC X.
   633
   634         16  PI-RETURN-CODES.
   635             20  PI-RETURN-CD-1          PIC X.
   636             20  PI-RETURN-CD-2          PIC X.
   637
   638         16  PI-UPDATE-STATUS-SAVE.
   639             20  PI-UPDATE-BY            PIC X(4).
   640             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   641
   642         16  PI-LOWER-CASE-LETTERS       PIC X.
   643             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   644
   645*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   646*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   647*            88  CARRIER-CLM-CNTL            VALUE '2'.
   648
   649         16  PI-CERT-ACCESS-CONTROL      PIC X.
   650             88  ST-ACCNT-CNTL               VALUE ' '.
   651             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   652             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   653             88  ACCNT-CNTL                  VALUE '3'.
   654             88  CARR-ACCNT-CNTL             VALUE '4'.
   655
   656         16  PI-PROCESSOR-CAP-LIST.
   657             20  PI-SYSTEM-CONTROLS.
   658                24 PI-SYSTEM-DISPLAY     PIC X.
   659                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   660                24 PI-SYSTEM-MODIFY      PIC X.
   661                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   662             20  FILLER                  PIC XX.
   663             20  PI-DISPLAY-CAP          PIC X.
   664                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL171.cbl
   665             20  PI-MODIFY-CAP           PIC X.
   666                 88  MODIFY-CAP              VALUE 'Y'.
   667             20  PI-MSG-AT-LOGON-CAP     PIC X.
   668                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   669             20  PI-FORCE-CAP            PIC X.
   670                 88  FORCE-CAP               VALUE 'Y'.
   671
   672         16  PI-PROGRAM-CONTROLS.
   673             20  PI-PGM-PRINT-OPT        PIC X.
   674             20  PI-PGM-FORMAT-OPT       PIC X.
   675             20  PI-PGM-PROCESS-OPT      PIC X.
   676             20  PI-PGM-TOTALS-OPT       PIC X.
   677
   678         16  PI-HELP-INTERFACE.
   679             20  PI-LAST-ERROR-NO        PIC X(4).
   680             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   681
   682         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   683             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   684
   685         16  PI-CR-CONTROL-IN-PROGRESS.
   686             20  PI-CR-CARRIER           PIC X.
   687             20  PI-CR-GROUPING          PIC X(6).
   688             20  PI-CR-STATE             PIC XX.
   689             20  PI-CR-ACCOUNT           PIC X(10).
   690             20  PI-CR-FIN-RESP          PIC X(10).
   691             20  PI-CR-TYPE              PIC X.
   692
   693         16  PI-CR-BATCH-NUMBER          PIC X(6).
   694
   695         16  PI-CR-MONTH-END-DT          PIC XX.
   696
   697         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   698             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   699             88  PI-ZERO-CARRIER             VALUE '1'.
   700             88  PI-ZERO-GROUPING            VALUE '2'.
   701             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   702
   703         16  PI-CARRIER-SECURITY         PIC X.
   704             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   705
   706         16  PI-ACCOUNT-SECURITY         PIC X(10).
   707             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   708             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   709
   710         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   711             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   712                                         INDEXED BY PI-ACCESS-NDX
   713                                         PIC X.
   714
   715         16  PI-GA-BILLING-CONTROL       PIC X.
   716             88  PI-GA-BILLING               VALUE '1'.
   717
   718         16  PI-MAIL-PROCESSING          PIC X.
   719             88  PI-MAIL-YES                 VALUE 'Y'.
   720
   721         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   722
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL171.cbl
   723         16  PI-AR-SYSTEM.
   724             20  PI-AR-PROCESSING-CNTL   PIC X.
   725                 88  PI-AR-PROCESSING        VALUE 'Y'.
   726             20  PI-AR-SUMMARY-CODE      PIC X(6).
   727             20  PI-AR-MONTH-END-DT      PIC XX.
   728
   729         16  PI-MP-SYSTEM.
   730             20  PI-MORTGAGE-USER            PIC X.
   731                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   732                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   733             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   734                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   735                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   736                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   737                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   738                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   739             20  PI-MP-MONTH-END-DT          PIC XX.
   740             20  PI-MP-REFERENCE-NO.
   741                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   742                 24  PI-MP-REFERENCE-SFX     PIC XX.
   743
   744         16  PI-LABEL-CONTROL            PIC X(01).
   745             88  PI-CREATE-LABELS                    VALUE 'Y'.
   746             88  PI-BYPASS-LABELS                    VALUE 'N'.
   747
   748         16  PI-BILL-GROUPING-CODE       PIC X(01).
   749             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   750
   751         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   752             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   753             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   754
   755         16  FILLER                      PIC X(14).
   756
   757     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   758******************************************************************
   759
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL171.cbl
   761*                                COPY ELCAID.
   762******************************************************************
   763*                                                                *
   764*                            ELCAID.                             *
   765*                            VMOD=2.001                          *
   766*                                                                *
   767*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   768*                                                                *
   769*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   770*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   771******************************************************************
   772
   773 01  DFHAID.
   774   02  DFHNULL   PIC  X  VALUE  ' '.
   775   02  DFHENTER  PIC  X  VALUE  QUOTE.
   776   02  DFHCLEAR  PIC  X  VALUE  '_'.
   777   02  DFHPEN    PIC  X  VALUE  '='.
   778   02  DFHOPID   PIC  X  VALUE  'W'.
   779   02  DFHPA1    PIC  X  VALUE  '%'.
   780   02  DFHPA2    PIC  X  VALUE  '>'.
   781   02  DFHPA3    PIC  X  VALUE  ','.
   782   02  DFHPF1    PIC  X  VALUE  '1'.
   783   02  DFHPF2    PIC  X  VALUE  '2'.
   784   02  DFHPF3    PIC  X  VALUE  '3'.
   785   02  DFHPF4    PIC  X  VALUE  '4'.
   786   02  DFHPF5    PIC  X  VALUE  '5'.
   787   02  DFHPF6    PIC  X  VALUE  '6'.
   788   02  DFHPF7    PIC  X  VALUE  '7'.
   789   02  DFHPF8    PIC  X  VALUE  '8'.
   790   02  DFHPF9    PIC  X  VALUE  '9'.
   791   02  DFHPF10   PIC  X  VALUE  ':'.
   792   02  DFHPF11   PIC  X  VALUE  '#'.
   793   02  DFHPF12   PIC  X  VALUE  '@'.
   794   02  DFHPF13   PIC  X  VALUE  'A'.
   795   02  DFHPF14   PIC  X  VALUE  'B'.
   796   02  DFHPF15   PIC  X  VALUE  'C'.
   797   02  DFHPF16   PIC  X  VALUE  'D'.
   798   02  DFHPF17   PIC  X  VALUE  'E'.
   799   02  DFHPF18   PIC  X  VALUE  'F'.
   800   02  DFHPF19   PIC  X  VALUE  'G'.
   801   02  DFHPF20   PIC  X  VALUE  'H'.
   802   02  DFHPF21   PIC  X  VALUE  'I'.
   803*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   804   02  DFHPF22   PIC  X  VALUE  '['.
   805   02  DFHPF23   PIC  X  VALUE  '.'.
   806   02  DFHPF24   PIC  X  VALUE  '<'.
   807   02  DFHMSRE   PIC  X  VALUE  'X'.
   808   02  DFHSTRF   PIC  X  VALUE  'h'.
   809   02  DFHTRIG   PIC  X  VALUE  '"'.
   810
   811 01  FILLER    REDEFINES DFHAID.
   812     12  FILLER                  PIC X(8).
   813     12  PF-VALUES               PIC X       OCCURS 24.
   814
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL171.cbl
   816*                                COPY EL171S.
   817 01  EL171AI.
   818     05  FILLER            PIC  X(0012).
   819*    -------------------------------
   820     05  RUNDTEL PIC S9(0004) COMP.
   821     05  RUNDTEF PIC  X(0001).
   822     05  FILLER REDEFINES RUNDTEF.
   823         10  RUNDTEA PIC  X(0001).
   824     05  RUNDTEI PIC  X(0008).
   825*    -------------------------------
   826     05  RUNTIMEL PIC S9(0004) COMP.
   827     05  RUNTIMEF PIC  X(0001).
   828     05  FILLER REDEFINES RUNTIMEF.
   829         10  RUNTIMEA PIC  X(0001).
   830     05  RUNTIMEI PIC  X(0005).
   831*    -------------------------------
   832     05  SELCODEL PIC S9(0004) COMP.
   833     05  SELCODEF PIC  X(0001).
   834     05  FILLER REDEFINES SELCODEF.
   835         10  SELCODEA PIC  X(0001).
   836     05  SELCODEI PIC  99.
   837*    -------------------------------
   838     05  USERCDL PIC S9(0004) COMP.
   839     05  USERCDF PIC  X(0001).
   840     05  FILLER REDEFINES USERCDF.
   841         10  USERCDA PIC  X(0001).
   842     05  USERCDI PIC  X(0004).
   843*    -------------------------------
   844     05  ERRMSGL PIC S9(0004) COMP.
   845     05  ERRMSGF PIC  X(0001).
   846     05  FILLER REDEFINES ERRMSGF.
   847         10  ERRMSGA PIC  X(0001).
   848     05  ERRMSGI PIC  X(0070).
   849 01  EL171AO REDEFINES EL171AI.
   850     05  FILLER            PIC  X(0012).
   851*    -------------------------------
   852     05  FILLER            PIC  X(0003).
   853     05  RUNDTEO PIC  X(0008).
   854*    -------------------------------
   855     05  FILLER            PIC  X(0003).
   856     05  RUNTIMEO PIC  99.99.
   857*    -------------------------------
   858     05  FILLER            PIC  X(0003).
   859     05  SELCODEO PIC  X(0002).
   860*    -------------------------------
   861     05  FILLER            PIC  X(0003).
   862     05  USERCDO PIC  X(0004).
   863*    -------------------------------
   864     05  FILLER            PIC  X(0003).
   865     05  ERRMSGO PIC  X(0070).
   866*    -------------------------------
   867
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL171.cbl
   869****************************************************************
   870*
   871* Copyright (c) 2007 by Clerity Solutions, Inc.
   872* All rights reserved.
   873*
   874****************************************************************
   875 01  DFHEIV.
   876   02  DFHEIV0               PIC X(35).
   877   02  DFHEIV1               PIC X(08).
   878   02  DFHEIV2               PIC X(08).
   879   02  DFHEIV3               PIC X(08).
   880   02  DFHEIV4               PIC X(06).
   881   02  DFHEIV5               PIC X(04).
   882   02  DFHEIV6               PIC X(04).
   883   02  DFHEIV7               PIC X(02).
   884   02  DFHEIV8               PIC X(02).
   885   02  DFHEIV9               PIC X(01).
   886   02  DFHEIV10              PIC S9(7) COMP-3.
   887   02  DFHEIV11              PIC S9(4) COMP SYNC.
   888   02  DFHEIV12              PIC S9(4) COMP SYNC.
   889   02  DFHEIV13              PIC S9(4) COMP SYNC.
   890   02  DFHEIV14              PIC S9(4) COMP SYNC.
   891   02  DFHEIV15              PIC S9(4) COMP SYNC.
   892   02  DFHEIV16              PIC S9(9) COMP SYNC.
   893   02  DFHEIV17              PIC X(04).
   894   02  DFHEIV18              PIC X(04).
   895   02  DFHEIV19              PIC X(04).
   896   02  DFHEIV20              USAGE IS POINTER.
   897   02  DFHEIV21              USAGE IS POINTER.
   898   02  DFHEIV22              USAGE IS POINTER.
   899   02  DFHEIV23              USAGE IS POINTER.
   900   02  DFHEIV24              USAGE IS POINTER.
   901   02  DFHEIV25              PIC S9(9) COMP SYNC.
   902   02  DFHEIV26              PIC S9(9) COMP SYNC.
   903   02  DFHEIV27              PIC S9(9) COMP SYNC.
   904   02  DFHEIV28              PIC S9(9) COMP SYNC.
   905   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   906   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   907   02  FILLER                PIC X(02).
   908   02  DFHEIV99              PIC X(08) VALUE SPACE.
   909   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   910   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   911   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   912   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   913 LINKAGE  SECTION.
   914*****************************************************************
   915*                                                               *
   916* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   917* All rights reserved.                                          *
   918*                                                               *
   919*****************************************************************
   920 01  dfheiblk.
   921     02  eibtime          pic s9(7) comp-3.
   922     02  eibdate          pic s9(7) comp-3.
   923     02  eibtrnid         pic x(4).
   924     02  eibtaskn         pic s9(7) comp-3.
   925     02  eibtrmid         pic x(4).
   926     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL171.cbl
   927     02  eibcposn         pic s9(4) comp.
   928     02  eibcalen         pic s9(4) comp.
   929     02  eibaid           pic x(1).
   930     02  eibfiller1       pic x(1).
   931     02  eibfn            pic x(2).
   932     02  eibfiller2       pic x(2).
   933     02  eibrcode         pic x(6).
   934     02  eibfiller3       pic x(2).
   935     02  eibds            pic x(8).
   936     02  eibreqid         pic x(8).
   937     02  eibrsrce         pic x(8).
   938     02  eibsync          pic x(1).
   939     02  eibfree          pic x(1).
   940     02  eibrecv          pic x(1).
   941     02  eibsend          pic x(1).
   942     02  eibatt           pic x(1).
   943     02  eibeoc           pic x(1).
   944     02  eibfmh           pic x(1).
   945     02  eibcompl         pic x(1).
   946     02  eibsig           pic x(1).
   947     02  eibconf          pic x(1).
   948     02  eiberr           pic x(1).
   949     02  eibrldbk         pic x(1).
   950     02  eiberrcd         pic x(4).
   951     02  eibsynrb         pic x(1).
   952     02  eibnodat         pic x(1).
   953     02  eibfiller5       pic x(2).
   954     02  eibresp          pic 9(09) comp.
   955     02  eibresp2         pic 9(09) comp.
   956     02  dfheigdj         pic s9(4) comp.
   957     02  dfheigdk         pic s9(4) comp.
   958 01  DFHCOMMAREA                 PIC X(1024).
   959
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL171.cbl
   961 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
   962 0000-DFHEXIT SECTION.
   963     MOVE '9#                    $   ' TO DFHEIV0.
   964     MOVE 'EL171' TO DFHEIV1.
   965     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   966
   967     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
   968
   969     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
   970     MOVE '5'                    TO DC-OPTION-CODE.
   971     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
   972     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
   973     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE.
   974
   975     IF EIBCALEN = 0
   976         GO TO 8800-UNAUTHORIZED-ACCESS.
   977
   978     IF PI-CALLING-PROGRAM NOT = THIS-PGM
   979         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
   980             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
   981             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
   982             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
   983             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
   984             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
   985             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
   986             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
   987             MOVE THIS-PGM       TO PI-CALLING-PROGRAM
   988         ELSE
   989             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
   990             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
   991             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
   992             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
   993             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
   994             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
   995             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
   996             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
   997
   998     IF EIBTRNID NOT = TRANS-ID
   999         GO TO 8100-SEND-INITIAL-MAP.
  1000
  1001
  1002* EXEC CICS HANDLE CONDITION
  1003*        PGMIDERR  (9600-PGMID-ERROR)
  1004*        ERROR     (9990-ABEND)
  1005*        END-EXEC.
  1006*    MOVE '"$L.                  ! " #00000997' TO DFHEIV0
  1007     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1008     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1009     MOVE X'2220233030303030393937' TO DFHEIV0(25:11)
  1010     CALL 'kxdfhei1' USING DFHEIV0
  1011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1012
  1013
  1014     IF EIBAID = DFHCLEAR
  1015         GO TO 9400-CLEAR.
  1016
  1017     IF PI-PROCESSOR-ID = 'LGXX'
  1018         GO TO 0200-RECEIVE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL171.cbl
  1019
  1020
  1021* EXEC CICS READQ TS
  1022*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  1023*        INTO    (SECURITY-CONTROL)
  1024*        LENGTH  (SC-COMM-LENGTH)
  1025*        ITEM    (SC-ITEM)
  1026*    END-EXEC.
  1027*    MOVE '*$II   L              ''   #00001008' TO DFHEIV0
  1028     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1029     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1030     MOVE X'2020233030303031303038' TO DFHEIV0(25:11)
  1031     CALL 'kxdfhei1' USING DFHEIV0,
  1032           PI-SECURITY-TEMP-STORE-ID,
  1033           SECURITY-CONTROL,
  1034           SC-COMM-LENGTH,
  1035           SC-ITEM,
  1036           DFHEIV99,
  1037           DFHEIV99
  1038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1039
  1040
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL171.cbl
  1042 0200-RECEIVE.
  1043     MOVE LOW-VALUES             TO EL171AI.
  1044
  1045     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1046         MOVE ER-7008            TO EMI-ERROR
  1047         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1048         MOVE -1                 TO SELCODEL
  1049         GO TO 8200-SEND-DATAONLY.
  1050
  1051
  1052* EXEC CICS RECEIVE
  1053*        MAP     (MAP-NAME)
  1054*        MAPSET  (MAPSET-NAME)
  1055*        INTO    (EL171AI)
  1056*        END-EXEC.
  1057     MOVE LENGTH OF
  1058      EL171AI
  1059       TO DFHEIV11
  1060*    MOVE '8"T I  L              ''   #00001025' TO DFHEIV0
  1061     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1062     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1063     MOVE X'2020233030303031303235' TO DFHEIV0(25:11)
  1064     CALL 'kxdfhei1' USING DFHEIV0,
  1065           MAP-NAME,
  1066           EL171AI,
  1067           DFHEIV11,
  1068           MAPSET-NAME,
  1069           DFHEIV99,
  1070           DFHEIV99
  1071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1072
  1073
  1074     IF SELCODEL = 0
  1075         GO TO 0300-CHECK-PFKEYS.
  1076
  1077     IF EIBAID NOT = DFHENTER
  1078         MOVE ER-0004            TO EMI-ERROR
  1079         GO TO 0320-INPUT-ERROR.
  1080
  1081     IF (SELCODEI NUMERIC) AND (SELCODEI GREATER 0 AND LESS 25)
  1082         MOVE PF-VALUES (SELCODEI) TO EIBAID
  1083     ELSE
  1084         MOVE ER-0029            TO EMI-ERROR
  1085         GO TO 0320-INPUT-ERROR.
  1086
  1087 0300-CHECK-PFKEYS.
  1088     MOVE ' '                    TO PI-ENTRY-CD-1.
  1089
  1090     IF EIBAID = DFHPF23
  1091         GO TO 8810-PF23.
  1092
  1093     IF EIBAID = DFHPF24
  1094         GO TO 9200-RETURN-MAIN-MENU.
  1095
  1096     IF EIBAID = DFHPF12
  1097         GO TO 9500-PF12.
  1098
  1099     IF USERCDL = ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL171.cbl
  1100         MOVE SPACES             TO PI-PROGRAM-WORK-AREA
  1101     ELSE
  1102         MOVE USERCDI            TO PI-PROGRAM-WORK-AREA.
  1103
  1104     IF EIBAID = DFHPF1
  1105         MOVE XCTL-172           TO PGM-NAME
  1106         IF (NOT PI-NO-CARRIER-SECURITY) OR
  1107            (NOT PI-NO-ACCOUNT-SECURITY)
  1108            MOVE PI-PROCESSOR-ID TO PI-PROGRAM-WORK-AREA
  1109            GO TO 9300-XCTL
  1110         ELSE
  1111            GO TO 9300-XCTL.
  1112
  1113     IF EIBAID = DFHPF2
  1114         IF PI-PROCESSOR-ID = 'LGXX'
  1115             MOVE XCTL-173                  TO PGM-NAME
  1116             GO TO 9300-XCTL
  1117         ELSE
  1118             IF PI-NO-ACCOUNT-SECURITY
  1119                MOVE SC-CLAIMS-DISPLAY (17) TO  PI-DISPLAY-CAP
  1120                MOVE SC-CLAIMS-UPDATE  (17) TO  PI-MODIFY-CAP
  1121                IF NOT DISPLAY-CAP
  1122                    MOVE XCTL-173           TO  THIS-PGM
  1123                    MOVE 'READ'             TO  SM-READ
  1124                    PERFORM 9995-SECURITY-VIOLATION
  1125                                      THRU 9995-EXIT
  1126                    MOVE ER-0070            TO  EMI-ERROR
  1127                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1128                    GO TO 8100-SEND-INITIAL-MAP
  1129                ELSE
  1130                    MOVE XCTL-173        TO PGM-NAME
  1131                    GO TO 9300-XCTL
  1132             ELSE
  1133                 MOVE ER-2371         TO EMI-ERROR
  1134                 GO TO 0320-INPUT-ERROR.
  1135
  1136     IF EIBAID = DFHPF3
  1137         IF PI-PROCESSOR-ID = 'LGXX'
  1138             MOVE XCTL-174              TO  PGM-NAME
  1139             GO TO 9300-XCTL
  1140         ELSE
  1141             IF PI-NO-ACCOUNT-SECURITY
  1142                 MOVE SC-CLAIMS-DISPLAY (11) TO  PI-DISPLAY-CAP
  1143                 MOVE SC-CLAIMS-UPDATE  (11) TO  PI-MODIFY-CAP
  1144                 IF NOT DISPLAY-CAP
  1145                     MOVE XCTL-174           TO  THIS-PGM
  1146                     MOVE 'READ'             TO  SM-READ
  1147                     PERFORM 9995-SECURITY-VIOLATION
  1148                                             THRU 9995-EXIT
  1149                     MOVE ER-0070            TO  EMI-ERROR
  1150                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1151                     GO TO 8100-SEND-INITIAL-MAP
  1152                 ELSE
  1153                     MOVE XCTL-174        TO PGM-NAME
  1154                     GO TO 9300-XCTL
  1155             ELSE
  1156                 MOVE ER-2371         TO EMI-ERROR
  1157                 GO TO 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL171.cbl
  1158
  1159     IF EIBAID = DFHPF4
  1160         IF PI-PROCESSOR-ID = 'LGXX'
  1161             MOVE XCTL-175                  TO  PGM-NAME
  1162             GO TO 9300-XCTL
  1163         ELSE
  1164             IF PI-NO-ACCOUNT-SECURITY
  1165                 MOVE SC-CLAIMS-DISPLAY (12) TO  PI-DISPLAY-CAP
  1166                 MOVE SC-CLAIMS-UPDATE  (12) TO  PI-MODIFY-CAP
  1167                 IF NOT DISPLAY-CAP
  1168                     MOVE XCTL-175           TO  THIS-PGM
  1169                     MOVE 'READ'             TO  SM-READ
  1170                     PERFORM 9995-SECURITY-VIOLATION
  1171                                             THRU 9995-EXIT
  1172                     MOVE ER-0070            TO  EMI-ERROR
  1173                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1174                     GO TO 8100-SEND-INITIAL-MAP
  1175                 ELSE
  1176                     MOVE XCTL-175        TO PGM-NAME
  1177                     GO TO 9300-XCTL
  1178             ELSE
  1179                 MOVE ER-2371         TO EMI-ERROR
  1180                 GO TO 0320-INPUT-ERROR.
  1181
  1182     IF EIBAID = DFHPF5
  1183         IF PI-PROCESSOR-ID = 'LGXX'
  1184             MOVE XCTL-176              TO  PGM-NAME
  1185             GO TO 9300-XCTL
  1186         ELSE
  1187             IF PI-NO-ACCOUNT-SECURITY
  1188                 MOVE SC-CLAIMS-DISPLAY (13) TO  PI-DISPLAY-CAP
  1189                 MOVE SC-CLAIMS-UPDATE  (13) TO  PI-MODIFY-CAP
  1190                 IF NOT DISPLAY-CAP
  1191                     MOVE XCTL-176           TO  THIS-PGM
  1192                     MOVE 'READ'             TO  SM-READ
  1193                     PERFORM 9995-SECURITY-VIOLATION
  1194                                             THRU 9995-EXIT
  1195                     MOVE ER-0070            TO  EMI-ERROR
  1196                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1197                     GO TO 8100-SEND-INITIAL-MAP
  1198                 ELSE
  1199                     MOVE XCTL-176        TO PGM-NAME
  1200                     GO TO 9300-XCTL
  1201             ELSE
  1202                 MOVE ER-2371         TO EMI-ERROR
  1203                 GO TO 0320-INPUT-ERROR.
  1204
  1205     IF EIBAID = DFHPF6
  1206         IF PI-PROCESSOR-ID = 'LGXX'
  1207             MOVE XCTL-178                   TO  PGM-NAME
  1208             GO TO 9300-XCTL
  1209         ELSE
  1210             IF PI-NO-CARRIER-SECURITY AND PI-NO-ACCOUNT-SECURITY
  1211                 MOVE SC-CLAIMS-DISPLAY (20) TO  PI-DISPLAY-CAP
  1212                 MOVE SC-CLAIMS-UPDATE  (20) TO  PI-MODIFY-CAP
  1213                 IF NOT DISPLAY-CAP
  1214                     MOVE XCTL-178           TO  THIS-PGM
  1215                     MOVE 'READ'             TO  SM-READ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL171.cbl
  1216                     PERFORM 9995-SECURITY-VIOLATION
  1217                                             THRU 9995-EXIT
  1218                     MOVE ER-0070            TO  EMI-ERROR
  1219                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1220                     GO TO 8100-SEND-INITIAL-MAP
  1221                 ELSE
  1222                     MOVE XCTL-178           TO PGM-NAME
  1223                     GO TO 9300-XCTL
  1224             ELSE
  1225                 MOVE ER-2371                TO EMI-ERROR
  1226                 GO TO 0320-INPUT-ERROR.
  1227
  1228     IF EIBAID = DFHPF7
  1229         IF PI-PROCESSOR-ID = 'LGXX'
  1230             MOVE XCTL-181               TO  PGM-NAME
  1231             GO TO 9300-XCTL
  1232         ELSE
  1233             MOVE SC-CLAIMS-DISPLAY (18) TO  PI-DISPLAY-CAP
  1234             MOVE SC-CLAIMS-UPDATE  (18) TO  PI-MODIFY-CAP
  1235             IF NOT DISPLAY-CAP
  1236                 MOVE XCTL-181           TO  THIS-PGM
  1237                 MOVE 'READ'             TO  SM-READ
  1238                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1239                 MOVE ER-0070            TO  EMI-ERROR
  1240                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1241                 GO TO 8100-SEND-INITIAL-MAP
  1242             ELSE
  1243                 MOVE XCTL-181           TO PGM-NAME
  1244                 GO TO 9300-XCTL.
  1245
  1246     IF EIBAID = DFHPF8
  1247         IF PI-PROCESSOR-ID = 'LGXX'
  1248             MOVE XCTL-180                  TO PGM-NAME
  1249             GO TO 9300-XCTL
  1250         ELSE
  1251             IF PI-NO-CARRIER-SECURITY AND PI-NO-ACCOUNT-SECURITY
  1252                 MOVE SC-CLAIMS-DISPLAY (19) TO  PI-DISPLAY-CAP
  1253                 MOVE SC-CLAIMS-UPDATE  (19) TO  PI-MODIFY-CAP
  1254                 IF NOT DISPLAY-CAP
  1255                     MOVE XCTL-180           TO  THIS-PGM
  1256                     MOVE 'READ'             TO  SM-READ
  1257                     PERFORM 9995-SECURITY-VIOLATION
  1258                                             THRU 9995-EXIT
  1259                     MOVE ER-0070            TO  EMI-ERROR
  1260                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1261                     GO TO 8100-SEND-INITIAL-MAP
  1262                 ELSE
  1263                     MOVE XCTL-180        TO PGM-NAME
  1264                     GO TO 9300-XCTL
  1265             ELSE
  1266                 MOVE ER-2371         TO EMI-ERROR
  1267                 GO TO 0320-INPUT-ERROR.
  1268
  1269     IF EIBAID = DFHPF9
  1270         IF PI-PROCESSOR-ID IS EQUAL TO 'LGXX'
  1271             MOVE XCTL-179                   TO  PGM-NAME
  1272             GO TO 9300-XCTL
  1273         ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL171.cbl
  1274             IF PI-NO-CARRIER-SECURITY AND PI-NO-ACCOUNT-SECURITY
  1275                 MOVE SC-CLAIMS-DISPLAY (27) TO  PI-DISPLAY-CAP
  1276                 MOVE SC-CLAIMS-UPDATE  (27) TO  PI-MODIFY-CAP
  1277                 IF NOT DISPLAY-CAP
  1278                     MOVE XCTL-179           TO  PGM-NAME
  1279                     MOVE 'READ'             TO  SM-READ
  1280                     PERFORM 9995-SECURITY-VIOLATION
  1281                                             THRU 9995-EXIT
  1282                     MOVE ER-0070            TO  EMI-ERROR
  1283                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1284                     GO TO 8100-SEND-INITIAL-MAP
  1285                 ELSE
  1286                     MOVE XCTL-179           TO  PGM-NAME
  1287                     GO TO 9300-XCTL
  1288             ELSE
  1289                 MOVE ER-2371                TO  EMI-ERROR
  1290                 GO TO 0320-INPUT-ERROR.
  1291
  1292     IF EIBAID = DFHPF10
  1293         IF PI-PROCESSOR-ID = 'LGXX'
  1294             MOVE XCTL-183                   TO  PGM-NAME
  1295             GO TO 9300-XCTL
  1296         ELSE
  1297             IF PI-NO-CARRIER-SECURITY AND PI-NO-ACCOUNT-SECURITY
  1298                 MOVE SC-CLAIMS-DISPLAY (26) TO  PI-DISPLAY-CAP
  1299                 MOVE SC-CLAIMS-UPDATE  (26) TO  PI-MODIFY-CAP
  1300                 IF NOT DISPLAY-CAP
  1301                     MOVE XCTL-183           TO  THIS-PGM
  1302                     MOVE 'READ'             TO  SM-READ
  1303                     PERFORM 9995-SECURITY-VIOLATION
  1304                                            THRU 9995-EXIT
  1305                     MOVE ER-0070            TO  EMI-ERROR
  1306                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1307                     GO TO 8100-SEND-INITIAL-MAP
  1308                 ELSE
  1309                     MOVE XCTL-183           TO PGM-NAME
  1310                     GO TO 9300-XCTL
  1311             ELSE
  1312                 MOVE ER-2371                TO EMI-ERROR
  1313                 GO TO 0320-INPUT-ERROR.
  1314
  1315     IF EIBAID = DFHPF11
  1316         MOVE ER-9812                       TO EMI-ERROR
  1317         PERFORM 9900-ERROR-FORMAT          THRU 9900-EXIT
  1318         GO TO 8100-SEND-INITIAL-MAP
  1319     END-IF.
  1320*        IF PI-PROCESSOR-ID = 'LGXX'
  1321*            MOVE XCTL-146                  TO PGM-NAME
  1322*            GO TO 9300-XCTL
  1323*        ELSE
  1324*            MOVE SC-CLAIMS-DISPLAY (23)    TO  PI-DISPLAY-CAP
  1325*            MOVE SC-CLAIMS-UPDATE  (23)    TO  PI-MODIFY-CAP
  1326*            IF NOT DISPLAY-CAP
  1327*                MOVE XCTL-146              TO  THIS-PGM
  1328*                MOVE 'READ'                TO  SM-READ
  1329*                PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1330*                MOVE ER-0070               TO  EMI-ERROR
  1331*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL171.cbl
  1332*                GO TO 8100-SEND-INITIAL-MAP
  1333*            ELSE
  1334*                MOVE XCTL-146              TO PGM-NAME
  1335*                GO TO 9300-XCTL.
  1336
  1337     MOVE ER-0029                TO EMI-ERROR.
  1338
  1339
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL171.cbl
  1341 0320-INPUT-ERROR.
  1342     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1343     MOVE AL-UNBON               TO SELCODEA.
  1344     MOVE -1                     TO SELCODEL.
  1345     GO TO 8200-SEND-DATAONLY.
  1346
  1347
  1348
  1349 8100-SEND-INITIAL-MAP.
  1350     MOVE LOW-VALUES             TO EL171AO.
  1351     MOVE EIBTIME                TO TIME-IN.
  1352     MOVE TIME-OUT               TO RUNTIMEO.
  1353     MOVE SAVE-DATE              TO RUNDTEO.
  1354     MOVE -1                     TO SELCODEL.
  1355     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  1356
  1357
  1358* EXEC CICS SEND
  1359*        MAP     (MAP-NAME)
  1360*        MAPSET  (MAPSET-NAME)
  1361*        FROM    (EL171AO)
  1362*        ERASE
  1363*        CURSOR
  1364*        END-EXEC.
  1365     MOVE LENGTH OF
  1366      EL171AO
  1367       TO DFHEIV12
  1368     MOVE -1
  1369       TO DFHEIV11
  1370*    MOVE '8$     CT  E    H L F ,   #00001314' TO DFHEIV0
  1371     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  1372     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1373     MOVE X'2020233030303031333134' TO DFHEIV0(25:11)
  1374     CALL 'kxdfhei1' USING DFHEIV0,
  1375           MAP-NAME,
  1376           EL171AO,
  1377           DFHEIV12,
  1378           MAPSET-NAME,
  1379           DFHEIV99,
  1380           DFHEIV99,
  1381           DFHEIV99,
  1382           DFHEIV11,
  1383           DFHEIV99,
  1384           DFHEIV99,
  1385           DFHEIV99
  1386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1387
  1388
  1389     GO TO 9100-RETURN-TRAN.
  1390
  1391
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL171.cbl
  1393 8200-SEND-DATAONLY.
  1394     MOVE SAVE-DATE              TO RUNDTEO.
  1395     MOVE EIBTIME                TO TIME-IN.
  1396     MOVE TIME-OUT               TO RUNTIMEO.
  1397     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  1398
  1399
  1400* EXEC CICS SEND
  1401*        MAP     (MAP-NAME)
  1402*        MAPSET  (MAPSET-NAME)
  1403*        FROM    (EL171AO)
  1404*        DATAONLY
  1405*        CURSOR
  1406*        END-EXEC.
  1407     MOVE LENGTH OF
  1408      EL171AO
  1409       TO DFHEIV12
  1410     MOVE -1
  1411       TO DFHEIV11
  1412*    MOVE '8$D    CT       H L F ,   #00001332' TO DFHEIV0
  1413     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  1414     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1415     MOVE X'2020233030303031333332' TO DFHEIV0(25:11)
  1416     CALL 'kxdfhei1' USING DFHEIV0,
  1417           MAP-NAME,
  1418           EL171AO,
  1419           DFHEIV12,
  1420           MAPSET-NAME,
  1421           DFHEIV99,
  1422           DFHEIV99,
  1423           DFHEIV99,
  1424           DFHEIV11,
  1425           DFHEIV99,
  1426           DFHEIV99,
  1427           DFHEIV99
  1428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1429
  1430
  1431     GO TO 9100-RETURN-TRAN.
  1432
  1433
  1434
  1435 8300-SEND-TEXT.
  1436
  1437
  1438* EXEC CICS SEND TEXT
  1439*        FROM    (LOGOFF-TEXT)
  1440*        LENGTH  (LOGOFF-LENGTH)
  1441*        ERASE
  1442*        FREEKB
  1443*        END-EXEC.
  1444*    MOVE '8&      T  E F  H   F -   #00001346' TO DFHEIV0
  1445     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  1446     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  1447     MOVE X'2020233030303031333436' TO DFHEIV0(25:11)
  1448     CALL 'kxdfhei1' USING DFHEIV0,
  1449           LOGOFF-TEXT,
  1450           LOGOFF-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL171.cbl
  1451           DFHEIV99,
  1452           DFHEIV99,
  1453           DFHEIV99,
  1454           DFHEIV99,
  1455           DFHEIV99,
  1456           DFHEIV99,
  1457           DFHEIV99,
  1458           DFHEIV99,
  1459           DFHEIV99,
  1460           DFHEIV99
  1461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1462
  1463
  1464
  1465* EXEC CICS RETURN
  1466*        END-EXEC.
  1467*    MOVE '.(                    &   #00001353' TO DFHEIV0
  1468     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1469     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1470     MOVE X'2020233030303031333533' TO DFHEIV0(25:11)
  1471     CALL 'kxdfhei1' USING DFHEIV0,
  1472           DFHEIV99,
  1473           DFHEIV99,
  1474           DFHEIV99,
  1475           DFHEIV99,
  1476           DFHEIV99
  1477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1478
  1479
  1480
  1481
  1482 8800-UNAUTHORIZED-ACCESS.
  1483     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  1484     GO TO 8300-SEND-TEXT.
  1485
  1486
  1487
  1488 8810-PF23.
  1489     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  1490     MOVE XCTL-005               TO PGM-NAME.
  1491     GO TO 9300-XCTL.
  1492
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL171.cbl
  1494
  1495 9000-RETURN-CICS.
  1496
  1497* EXEC CICS RETURN
  1498*        END-EXEC.
  1499*    MOVE '.(                    &   #00001372' TO DFHEIV0
  1500     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1501     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1502     MOVE X'2020233030303031333732' TO DFHEIV0(25:11)
  1503     CALL 'kxdfhei1' USING DFHEIV0,
  1504           DFHEIV99,
  1505           DFHEIV99,
  1506           DFHEIV99,
  1507           DFHEIV99,
  1508           DFHEIV99
  1509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1510
  1511
  1512
  1513 9100-RETURN-TRAN.
  1514     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  1515     MOVE '171A'                 TO PI-CURRENT-SCREEN-NO.
  1516
  1517
  1518* EXEC CICS RETURN
  1519*        TRANSID   (TRANS-ID)
  1520*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  1521*        LENGTH    (PI-COMM-LENGTH)
  1522*        END-EXEC.
  1523*    MOVE '.(CT                  &   #00001380' TO DFHEIV0
  1524     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  1525     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1526     MOVE X'2020233030303031333830' TO DFHEIV0(25:11)
  1527     CALL 'kxdfhei1' USING DFHEIV0,
  1528           TRANS-ID,
  1529           PROGRAM-INTERFACE-BLOCK,
  1530           PI-COMM-LENGTH,
  1531           DFHEIV99,
  1532           DFHEIV99
  1533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1534
  1535
  1536
  1537
  1538 9200-RETURN-MAIN-MENU.
  1539     MOVE XCTL-126               TO PGM-NAME.
  1540     GO TO 9300-XCTL.
  1541
  1542
  1543
  1544 9300-XCTL.
  1545     MOVE SPACES                 TO PI-CONTROL-IN-PROGRESS.
  1546     MOVE SPACES                 TO PI-ENTRY-CD-2.
  1547     MOVE SPACES                 TO PI-RETURN-CODES.
  1548     MOVE SPACES                 TO PI-UPDATE-BY.
  1549     MOVE ZEROS                  TO PI-UPDATE-HHMMSS.
  1550     MOVE SPACES                 TO PI-PROGRAM-CONTROLS.
  1551
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL171.cbl
  1552
  1553* EXEC CICS XCTL
  1554*        PROGRAM   (PGM-NAME)
  1555*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  1556*        LENGTH  (PI-COMM-LENGTH)
  1557*        END-EXEC.
  1558*    MOVE '.$C                   $   #00001402' TO DFHEIV0
  1559     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  1560     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1561     MOVE X'2020233030303031343032' TO DFHEIV0(25:11)
  1562     CALL 'kxdfhei1' USING DFHEIV0,
  1563           PGM-NAME,
  1564           PROGRAM-INTERFACE-BLOCK,
  1565           PI-COMM-LENGTH
  1566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1567
  1568
  1569
  1570
  1571 9400-CLEAR.
  1572     MOVE XCTL-126               TO PGM-NAME.
  1573     GO TO 9300-XCTL.
  1574
  1575
  1576
  1577 9500-PF12.
  1578     MOVE XCTL-010               TO PGM-NAME.
  1579     GO TO 9300-XCTL.
  1580
  1581
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL171.cbl
  1583 9600-PGMID-ERROR.
  1584
  1585* EXEC CICS HANDLE CONDITION
  1586*        PGMIDERR  (8300-SEND-TEXT)
  1587*        END-EXEC.
  1588*    MOVE '"$L                   ! # #00001423' TO DFHEIV0
  1589     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  1590     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1591     MOVE X'2320233030303031343233' TO DFHEIV0(25:11)
  1592     CALL 'kxdfhei1' USING DFHEIV0
  1593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1594
  1595
  1596     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  1597     MOVE ' '                    TO PI-ENTRY-CD-1.
  1598     MOVE XCTL-005               TO PGM-NAME.
  1599     MOVE PGM-NAME               TO LOGOFF-PGM.
  1600     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  1601     GO TO 9300-XCTL.
  1602
  1603
  1604 9700-LINK-DATE-CONVERT.
  1605
  1606* EXEC CICS LINK
  1607*        PROGRAM    ('ELDATCV')
  1608*        COMMAREA   (DATE-CONVERSION-DATA)
  1609*        LENGTH     (DC-COMM-LENGTH)
  1610*        END-EXEC.
  1611     MOVE 'ELDATCV' TO DFHEIV1
  1612*    MOVE '."C                   ''   #00001436' TO DFHEIV0
  1613     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1614     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1615     MOVE X'2020233030303031343336' TO DFHEIV0(25:11)
  1616     CALL 'kxdfhei1' USING DFHEIV0,
  1617           DFHEIV1,
  1618           DATE-CONVERSION-DATA,
  1619           DC-COMM-LENGTH,
  1620           DFHEIV99,
  1621           DFHEIV99,
  1622           DFHEIV99
  1623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1624
  1625
  1626 9700-EXIT.
  1627     EXIT.
  1628
  1629
  1630 9900-ERROR-FORMAT.
  1631     IF NOT EMI-ERRORS-COMPLETE
  1632         MOVE LINK-001           TO PGM-NAME
  1633
  1634* EXEC CICS LINK
  1635*            PROGRAM   (PGM-NAME)
  1636*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  1637*            LENGTH    (EMI-COMM-LENGTH)
  1638*            END-EXEC.
  1639*    MOVE '."C                   ''   #00001449' TO DFHEIV0
  1640     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL171.cbl
  1641     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1642     MOVE X'2020233030303031343439' TO DFHEIV0(25:11)
  1643     CALL 'kxdfhei1' USING DFHEIV0,
  1644           PGM-NAME,
  1645           ERROR-MESSAGE-INTERFACE-BLOCK,
  1646           EMI-COMM-LENGTH,
  1647           DFHEIV99,
  1648           DFHEIV99,
  1649           DFHEIV99
  1650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1651
  1652
  1653 9900-EXIT.
  1654     EXIT.
  1655
  1656
  1657 9990-ABEND.
  1658     MOVE LINK-004               TO PGM-NAME.
  1659     MOVE DFHEIBLK               TO EMI-LINE1.
  1660
  1661
  1662* EXEC CICS LINK
  1663*        PROGRAM   (PGM-NAME)
  1664*        COMMAREA  (EMI-LINE1)
  1665*        LENGTH    (72)
  1666*        END-EXEC.
  1667     MOVE 72
  1668       TO DFHEIV11
  1669*    MOVE '."C                   ''   #00001463' TO DFHEIV0
  1670     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1671     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1672     MOVE X'2020233030303031343633' TO DFHEIV0(25:11)
  1673     CALL 'kxdfhei1' USING DFHEIV0,
  1674           PGM-NAME,
  1675           EMI-LINE1,
  1676           DFHEIV11,
  1677           DFHEIV99,
  1678           DFHEIV99,
  1679           DFHEIV99
  1680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1681
  1682
  1683     GO TO 8200-SEND-DATAONLY.
  1684
  1685 9995-SECURITY-VIOLATION.
  1686*                            COPY ELCSCTP.
  1687******************************************************************
  1688*                                                                *
  1689*                            ELCSCTP                             *
  1690*                            VMOD=2.001                          *
  1691*                                                                *
  1692*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  1693******************************************************************
  1694
  1695
  1696     MOVE EIBDATE          TO SM-JUL-DATE.
  1697     MOVE EIBTRMID         TO SM-TERMID.
  1698     MOVE THIS-PGM         TO SM-PGM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL171.cbl
  1699     MOVE EIBTIME          TO TIME-IN.
  1700     MOVE TIME-OUT         TO SM-TIME.
  1701     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  1702
  1703
  1704* EXEC CICS LINK
  1705*         PROGRAM  ('EL003')
  1706*         COMMAREA (SECURITY-MESSAGE)
  1707*         LENGTH   (80)
  1708*    END-EXEC.
  1709     MOVE 'EL003' TO DFHEIV1
  1710     MOVE 80
  1711       TO DFHEIV11
  1712*    MOVE '."C                   ''   #00001489' TO DFHEIV0
  1713     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1714     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1715     MOVE X'2020233030303031343839' TO DFHEIV0(25:11)
  1716     CALL 'kxdfhei1' USING DFHEIV0,
  1717           DFHEIV1,
  1718           SECURITY-MESSAGE,
  1719           DFHEIV11,
  1720           DFHEIV99,
  1721           DFHEIV99,
  1722           DFHEIV99
  1723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1724
  1725
  1726******************************************************************
  1727
  1728
  1729 9995-EXIT.
  1730     EXIT.
  1731
  1732 9999-LAST-PARAGRAPH.
  1733
  1734* GOBACK.
  1735     MOVE '9%                    "   ' TO DFHEIV0
  1736     MOVE 'EL171' TO DFHEIV1
  1737     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1738     GOBACK.
  1739
  1740 9999-DFHBACK SECTION.
  1741     MOVE '9%                    "   ' TO DFHEIV0
  1742     MOVE 'EL171' TO DFHEIV1
  1743     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1744     GOBACK.
  1745 9999-DFHEXIT.
  1746     IF DFHEIGDJ EQUAL 0001
  1747         NEXT SENTENCE
  1748     ELSE IF DFHEIGDJ EQUAL 2
  1749         GO TO 9600-PGMID-ERROR,
  1750               9990-ABEND
  1751         DEPENDING ON DFHEIGDI
  1752     ELSE IF DFHEIGDJ EQUAL 3
  1753         GO TO 8300-SEND-TEXT
  1754         DEPENDING ON DFHEIGDI.
  1755     MOVE '9%                    "   ' TO DFHEIV0
  1756     MOVE 'EL171' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL171.cbl
  1757     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1758     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3492     Code:        4283
