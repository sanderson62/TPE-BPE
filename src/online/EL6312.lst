* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6312.cbl
* Options: int("EL6312.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6312.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6312.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6312.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL6312.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 01/12/96 10:01:33.
     7*                            VMOD=2.015.
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6312.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        TRANSACTION - EXB2 - REVIEW AND CORRECTION
    27*                             DISPLAY EDIT CRITERIA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6312.cbl
    29 ENVIRONMENT DIVISION.
    30 DATA DIVISION.
    31 WORKING-STORAGE SECTION.
    32 01  DFH-START PIC X(04).
    33 77  FILLER  PIC X(32)  VALUE '********************************'.
    34 77  FILLER  PIC X(32)  VALUE '*    EL6312 WORKING STORAGE    *'.
    35 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.015 ************'.
    36
    37*    COPY ELCSCTM.
    38******************************************************************
    39*                                                                *
    40*                                                                *
    41*                            ELCSCTM                             *
    42*                            VMOD=2.001                          *
    43*                                                                *
    44*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    45*                                                                *
    46******************************************************************
    47 01  SECURITY-MESSAGE.
    48     12  FILLER                          PIC X(30)
    49            VALUE '** LOGIC SECURITY VIOLATION -'.
    50     12  SM-READ                         PIC X(6).
    51     12  FILLER                          PIC X(5)
    52            VALUE ' PGM='.
    53     12  SM-PGM                          PIC X(6).
    54     12  FILLER                          PIC X(5)
    55            VALUE ' OPR='.
    56     12  SM-PROCESSOR-ID                 PIC X(4).
    57     12  FILLER                          PIC X(6)
    58            VALUE ' TERM='.
    59     12  SM-TERMID                       PIC X(4).
    60     12  FILLER                          PIC XX   VALUE SPACE.
    61     12  SM-JUL-DATE                     PIC 9(5).
    62     12  FILLER                          PIC X    VALUE SPACE.
    63     12  SM-TIME                         PIC 99.99.
    64
    65
    66*    COPY ELCSCRTY.
    67******************************************************************
    68*                                                                *
    69*                                                                *
    70*                            ELCSCRTY                            *
    71*                            VMOD=2.001                          *
    72*                                                                *
    73*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    74*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    75*        SAVED IN PI-SECURITY-ADDRESS.                           *
    76*                                                                *
    77******************************************************************
    78 01  SECURITY-CONTROL.
    79     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    80     12  FILLER                       PIC XX    VALUE 'SC'.
    81     12  SC-CREDIT-CODES.
    82         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    83             20  SC-CREDIT-DISPLAY    PIC X.
    84             20  SC-CREDIT-UPDATE     PIC X.
    85     12  SC-CLAIMS-CODES.
    86         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6312.cbl
    87             20  SC-CLAIMS-DISPLAY    PIC X.
    88             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6312.cbl
    90 01  STANDARD-AREAS.
    91     12  MAP-NAME            PIC X(8)    VALUE 'EL631E'.
    92     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6312S'.
    93     12  SCREEN-NUMBER       PIC X(4)    VALUE '631E'.
    94     12  TRANS-ID            PIC X(4)    VALUE 'EXB2'.
    95     12  THIS-PGM            PIC X(8)    VALUE 'EL6312'.
    96     12  PGM-NAME            PIC X(8).
    97     12  TIME-IN             PIC S9(7).
    98     12  TIME-OUT-R  REDEFINES TIME-IN.
    99         16  FILLER          PIC X.
   100         16  TIME-OUT        PIC 99V99.
   101         16  FILLER          PIC X(2).
   102     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   103     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   104     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   105     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   106     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   107     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   108     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   109     12  WS-PHONE.
   110         16  WS-PH1              PIC XXX.
   111         16  WS-PH2              PIC XXX.
   112         16  WS-PH3              PIC XXXX.
   113     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   114     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   115
   116 01  ERROR-MESSAGES.
   117     12  ER-0004                 PIC X(4)  VALUE '0004'.
   118     12  ER-0008                 PIC X(4)  VALUE '0008'.
   119     12  ER-0029                 PIC X(4)  VALUE '0029'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6312.cbl
   121*    COPY ELCDATE.
   122******************************************************************
   123*                                                                *
   124*                                                                *
   125*                            ELCDATE.                            *
   126*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   127*                            VMOD=2.003
   128*                                                                *
   129*                                                                *
   130*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   131*                 LENGTH = 200                                   *
   132******************************************************************
   133
   134 01  DATE-CONVERSION-DATA.
   135     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   136     12  DC-OPTION-CODE                PIC X.
   137         88  BIN-TO-GREG                VALUE ' '.
   138         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   139         88  EDIT-GREG-TO-BIN           VALUE '2'.
   140         88  YMD-GREG-TO-BIN            VALUE '3'.
   141         88  MDY-GREG-TO-BIN            VALUE '4'.
   142         88  JULIAN-TO-BIN              VALUE '5'.
   143         88  BIN-PLUS-ELAPSED           VALUE '6'.
   144         88  FIND-CENTURY               VALUE '7'.
   145         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   146         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   147         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   148         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   149         88  JULIAN-TO-BIN-3            VALUE 'C'.
   150         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   151         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   152         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   153         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   154         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   155         88  CHECK-LEAP-YEAR            VALUE 'H'.
   156         88  BIN-3-TO-GREG              VALUE 'I'.
   157         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   158         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   159         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   160         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   161         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   162         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   163         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   164         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   165         88  THREE-CHARACTER-BIN
   166                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   167         88  GREGORIAN-TO-BIN
   168                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   169         88  BIN-TO-GREGORIAN
   170                  VALUES ' ' '1' 'I' '8' 'G'.
   171         88  JULIAN-TO-BINARY
   172                  VALUES '5' 'C' 'E' 'F'.
   173     12  DC-ERROR-CODE                 PIC X.
   174         88  NO-CONVERSION-ERROR        VALUE ' '.
   175         88  DATE-CONVERSION-ERROR
   176                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   177         88  DATE-IS-ZERO               VALUE '1'.
   178         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6312.cbl
   179         88  DATE-IS-INVALID            VALUE '3'.
   180         88  DATE1-GREATER-DATE2        VALUE '4'.
   181         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   182         88  DATE-INVALID-OPTION        VALUE '9'.
   183         88  INVALID-CENTURY            VALUE 'A'.
   184         88  ONLY-CENTURY               VALUE 'B'.
   185         88  ONLY-LEAP-YEAR             VALUE 'C'.
   186         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   187     12  DC-END-OF-MONTH               PIC X.
   188         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   189     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   190         88  USE-NORMAL-PROCESS         VALUE ' '.
   191         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   192         88  ADJUST-UP-100-YRS          VALUE '2'.
   193     12  FILLER                        PIC X.
   194     12  DC-CONVERSION-DATES.
   195         16  DC-BIN-DATE-1             PIC XX.
   196         16  DC-BIN-DATE-2             PIC XX.
   197         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   198         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   199                       DC-GREG-DATE-1-EDIT.
   200             20  DC-EDIT1-MONTH        PIC 99.
   201             20  SLASH1-1              PIC X.
   202             20  DC-EDIT1-DAY          PIC 99.
   203             20  SLASH1-2              PIC X.
   204             20  DC-EDIT1-YEAR         PIC 99.
   205         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   206         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   207                     DC-GREG-DATE-2-EDIT.
   208             20  DC-EDIT2-MONTH        PIC 99.
   209             20  SLASH2-1              PIC X.
   210             20  DC-EDIT2-DAY          PIC 99.
   211             20  SLASH2-2              PIC X.
   212             20  DC-EDIT2-YEAR         PIC 99.
   213         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   214         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   215                     DC-GREG-DATE-1-YMD.
   216             20  DC-YMD-YEAR           PIC 99.
   217             20  DC-YMD-MONTH          PIC 99.
   218             20  DC-YMD-DAY            PIC 99.
   219         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   220         16  DC-GREG-DATE-1-MDY-R REDEFINES
   221                      DC-GREG-DATE-1-MDY.
   222             20  DC-MDY-MONTH          PIC 99.
   223             20  DC-MDY-DAY            PIC 99.
   224             20  DC-MDY-YEAR           PIC 99.
   225         16  DC-GREG-DATE-1-ALPHA.
   226             20  DC-ALPHA-MONTH        PIC X(10).
   227             20  DC-ALPHA-DAY          PIC 99.
   228             20  FILLER                PIC XX.
   229             20  DC-ALPHA-CENTURY.
   230                 24 DC-ALPHA-CEN-N     PIC 99.
   231             20  DC-ALPHA-YEAR         PIC 99.
   232         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   233         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   234         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   235         16  DC-JULIAN-DATE            PIC 9(05).
   236         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6312.cbl
   237                                       PIC 9(05).
   238         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   239             20  DC-JULIAN-YEAR        PIC 99.
   240             20  DC-JULIAN-DAYS        PIC 999.
   241         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   242         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   243         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   244     12  DATE-CONVERSION-VARIBLES.
   245         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   246         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   247             20  FILLER                PIC 9(3).
   248             20  HOLD-CEN-1-CCYY.
   249                 24  HOLD-CEN-1-CC     PIC 99.
   250                 24  HOLD-CEN-1-YY     PIC 99.
   251             20  HOLD-CEN-1-MO         PIC 99.
   252             20  HOLD-CEN-1-DA         PIC 99.
   253         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   254             20  HOLD-CEN-1-R-MO       PIC 99.
   255             20  HOLD-CEN-1-R-DA       PIC 99.
   256             20  HOLD-CEN-1-R-CCYY.
   257                 24  HOLD-CEN-1-R-CC   PIC 99.
   258                 24  HOLD-CEN-1-R-YY   PIC 99.
   259             20  FILLER                PIC 9(3).
   260         16  HOLD-CENTURY-1-X.
   261             20  FILLER                PIC X(3)  VALUE SPACES.
   262             20  HOLD-CEN-1-X-CCYY.
   263                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   264                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   265             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   266             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   267         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   268             20  HOLD-CEN-1-R-X-MO     PIC XX.
   269             20  HOLD-CEN-1-R-X-DA     PIC XX.
   270             20  HOLD-CEN-1-R-X-CCYY.
   271                 24  HOLD-CEN-1-R-X-CC PIC XX.
   272                 24  HOLD-CEN-1-R-X-YY PIC XX.
   273             20  FILLER                PIC XXX.
   274         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   275         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   276         16  DC-JULIAN-DATE-1          PIC 9(07).
   277         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   278             20  DC-JULIAN-1-CCYY.
   279                 24  DC-JULIAN-1-CC    PIC 99.
   280                 24  DC-JULIAN-1-YR    PIC 99.
   281             20  DC-JULIAN-DA-1        PIC 999.
   282         16  DC-JULIAN-DATE-2          PIC 9(07).
   283         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   284             20  DC-JULIAN-2-CCYY.
   285                 24  DC-JULIAN-2-CC    PIC 99.
   286                 24  DC-JULIAN-2-YR    PIC 99.
   287             20  DC-JULIAN-DA-2        PIC 999.
   288         16  DC-GREG-DATE-A-EDIT.
   289             20  DC-EDITA-MONTH        PIC 99.
   290             20  SLASHA-1              PIC X VALUE '/'.
   291             20  DC-EDITA-DAY          PIC 99.
   292             20  SLASHA-2              PIC X VALUE '/'.
   293             20  DC-EDITA-CCYY.
   294                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6312.cbl
   295                 24  DC-EDITA-YEAR     PIC 99.
   296         16  DC-GREG-DATE-B-EDIT.
   297             20  DC-EDITB-MONTH        PIC 99.
   298             20  SLASHB-1              PIC X VALUE '/'.
   299             20  DC-EDITB-DAY          PIC 99.
   300             20  SLASHB-2              PIC X VALUE '/'.
   301             20  DC-EDITB-CCYY.
   302                 24  DC-EDITB-CENT     PIC 99.
   303                 24  DC-EDITB-YEAR     PIC 99.
   304         16  DC-GREG-DATE-CYMD         PIC 9(08).
   305         16  DC-GREG-DATE-CYMD-R REDEFINES
   306                              DC-GREG-DATE-CYMD.
   307             20  DC-CYMD-CEN           PIC 99.
   308             20  DC-CYMD-YEAR          PIC 99.
   309             20  DC-CYMD-MONTH         PIC 99.
   310             20  DC-CYMD-DAY           PIC 99.
   311         16  DC-GREG-DATE-MDCY         PIC 9(08).
   312         16  DC-GREG-DATE-MDCY-R REDEFINES
   313                              DC-GREG-DATE-MDCY.
   314             20  DC-MDCY-MONTH         PIC 99.
   315             20  DC-MDCY-DAY           PIC 99.
   316             20  DC-MDCY-CEN           PIC 99.
   317             20  DC-MDCY-YEAR          PIC 99.
   318    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   319        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   320    12  DC-EL310-DATE                  PIC X(21).
   321    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6312.cbl
   323*    COPY ELCLOGOF.
   324******************************************************************
   325*                                                                *
   326*                                                                *
   327*                            ELCLOGOF.                           *
   328*                            VMOD=2.001                          *
   329*                                                                *
   330*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   331*                                                                *
   332******************************************************************
   333 01  CLASIC-LOGOFF.
   334     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   335     12  LOGOFF-TEXT.
   336         16  FILLER          PIC X(5)    VALUE SPACES.
   337         16  LOGOFF-MSG.
   338             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   339             20  FILLER      PIC X       VALUE SPACES.
   340             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   341         16  FILLER          PIC X(80)
   342           VALUE '* YOU ARE NOW LOGGED OFF'.
   343         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   344         16  FILLER          PIC X       VALUE QUOTE.
   345         16  LOGOFF-SYS-MSG  PIC X(17)
   346           VALUE 'S CLAS-IC SYSTEM '.
   347     12  TEXT-MESSAGES.
   348         16  UNACCESS-MSG    PIC X(29)
   349             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   350         16  PGMIDERR-MSG    PIC X(17)
   351             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6312.cbl
   353*    COPY ELCATTR.
   354******************************************************************
   355*                                                                *
   356*                            ELCATTR.                            *
   357*                            VMOD=2.001                          *
   358*                                                                *
   359*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   360*                                                                *
   361*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   362*                                                                *
   363*                   POS 1   P=PROTECTED                          *
   364*                           U=UNPROTECTED                        *
   365*                           S=ASKIP                              *
   366*                   POS 2   A=ALPHA/NUMERIC                      *
   367*                           N=NUMERIC                            *
   368*                   POS 3   N=NORMAL                             *
   369*                           B=BRIGHT                             *
   370*                           D=DARK                               *
   371*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   372*                           OF=MODIFIED DATA TAG OFF             *
   373*                                                                *
   374*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   375******************************************************************
   376 01  ATTRIBUTE-LIST.
   377     12  AL-PABOF            PIC X       VALUE 'Y'.
   378     12  AL-PABON            PIC X       VALUE 'Z'.
   379     12  AL-PADOF            PIC X       VALUE '%'.
   380     12  AL-PADON            PIC X       VALUE '_'.
   381     12  AL-PANOF            PIC X       VALUE '-'.
   382     12  AL-PANON            PIC X       VALUE '/'.
   383     12  AL-SABOF            PIC X       VALUE '8'.
   384     12  AL-SABON            PIC X       VALUE '9'.
   385     12  AL-SADOF            PIC X       VALUE '@'.
   386     12  AL-SADON            PIC X       VALUE QUOTE.
   387     12  AL-SANOF            PIC X       VALUE '0'.
   388     12  AL-SANON            PIC X       VALUE '1'.
   389     12  AL-UABOF            PIC X       VALUE 'H'.
   390     12  AL-UABON            PIC X       VALUE 'I'.
   391     12  AL-UADOF            PIC X       VALUE '<'.
   392     12  AL-UADON            PIC X       VALUE '('.
   393     12  AL-UANOF            PIC X       VALUE ' '.
   394     12  AL-UANON            PIC X       VALUE 'A'.
   395     12  AL-UNBOF            PIC X       VALUE 'Q'.
   396     12  AL-UNBON            PIC X       VALUE 'R'.
   397     12  AL-UNDOF            PIC X       VALUE '*'.
   398     12  AL-UNDON            PIC X       VALUE ')'.
   399     12  AL-UNNOF            PIC X       VALUE '&'.
   400     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6312.cbl
   402*    COPY ELCEMIB.
   403******************************************************************
   404*                                                                *
   405*                                                                *
   406*                            ELCEMIB.                            *
   407*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   408*                            VMOD=2.005                          *
   409*                                                                *
   410*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   411*                                                                *
   412******************************************************************
   413 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   414     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   415     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   416     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   417     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   418     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   419     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   420     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   421     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   422     12  EMI-SWITCH1             PIC X        VALUE '1'.
   423         88  EMI-NO-ERRORS                    VALUE '1'.
   424         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   425         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   426     12  EMI-SWITCH2             PIC X        VALUE '1'.
   427         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   428     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   429         88  EMI-AREA1-EMPTY                  VALUE '1'.
   430         88  EMI-AREA1-FULL                   VALUE '2'.
   431     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   432         88  EMI-AREA2-EMPTY                  VALUE '1'.
   433         88  EMI-AREA2-FULL                   VALUE '2'.
   434     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   435         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   436         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   437         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   438         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   439         88  EMI-BYPASS-FATALS                VALUE 'X'.
   440     12  EMI-ERROR-LINES.
   441         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   442         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   443         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   444         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   445             20  EMI-ERR-CODES OCCURS 10 TIMES.
   446                 24  EMI-ERR-NUM         PIC X(4).
   447                 24  EMI-FILLER          PIC X.
   448                 24  EMI-SEV             PIC X.
   449                 24  FILLER              PIC X.
   450             20  FILLER                  PIC X(02).
   451     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   452         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   453             20  EMI-ERROR-NUMBER    PIC X(4).
   454             20  EMI-FILL            PIC X.
   455             20  EMI-SEVERITY        PIC X.
   456             20  FILLER              PIC X.
   457             20  EMI-ERROR-TEXT.
   458                 24  EMI-TEXT-VARIABLE   PIC X(10).
   459                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6312.cbl
   460     12  EMI-SEVERITY-SAVE           PIC X.
   461         88  EMI-NOTE                    VALUE 'N'.
   462         88  EMI-WARNING                 VALUE 'W'.
   463         88  EMI-FORCABLE                VALUE 'F'.
   464         88  EMI-FATAL                   VALUE 'X'.
   465     12  EMI-MESSAGE-FLAG            PIC X.
   466         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   467         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   468     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   469     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   470         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   471         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   472         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   473     12  FILLER                      PIC X(137)  VALUE SPACES.
   474     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   475     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   476     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   477     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6312.cbl
   479*    COPY ELCINTF.
   480******************************************************************
   481*                                                                *
   482*                                                                *
   483*                            ELCINTF.                            *
   484*                            VMOD=2.017                          *
   485*                                                                *
   486*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   487*                                                                *
   488*       LENGTH = 1024                                            *
   489*                                                                *
   490******************************************************************
   491 01  PROGRAM-INTERFACE-BLOCK.
   492     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   493     12  PI-CALLING-PROGRAM              PIC X(8).
   494     12  PI-SAVED-PROGRAM-1              PIC X(8).
   495     12  PI-SAVED-PROGRAM-2              PIC X(8).
   496     12  PI-SAVED-PROGRAM-3              PIC X(8).
   497     12  PI-SAVED-PROGRAM-4              PIC X(8).
   498     12  PI-SAVED-PROGRAM-5              PIC X(8).
   499     12  PI-SAVED-PROGRAM-6              PIC X(8).
   500     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   501     12  PI-COMPANY-ID                   PIC XXX.
   502     12  PI-COMPANY-CD                   PIC X.
   503
   504     12  PI-COMPANY-PASSWORD             PIC X(8).
   505
   506     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   507
   508     12  PI-CONTROL-IN-PROGRESS.
   509         16  PI-CARRIER                  PIC X.
   510         16  PI-GROUPING                 PIC X(6).
   511         16  PI-STATE                    PIC XX.
   512         16  PI-ACCOUNT                  PIC X(10).
   513         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   514                                         PIC X(10).
   515         16  PI-CLAIM-CERT-GRP.
   516             20  PI-CLAIM-NO             PIC X(7).
   517             20  PI-CERT-NO.
   518                 25  PI-CERT-PRIME       PIC X(10).
   519                 25  PI-CERT-SFX         PIC X.
   520             20  PI-CERT-EFF-DT          PIC XX.
   521         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   522             20  PI-PLAN-CODE            PIC X(2).
   523             20  PI-REVISION-NUMBER      PIC X(3).
   524             20  PI-PLAN-EFF-DT          PIC X(2).
   525             20  PI-PLAN-EXP-DT          PIC X(2).
   526             20  FILLER                  PIC X(11).
   527         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   528             20  PI-OE-REFERENCE-1.
   529                 25  PI-OE-REF-1-PRIME   PIC X(18).
   530                 25  PI-OE-REF-1-SUFF    PIC XX.
   531
   532     12  PI-SESSION-IN-PROGRESS          PIC X.
   533         88  CLAIM-SESSION                   VALUE '1'.
   534         88  CREDIT-SESSION                  VALUE '2'.
   535         88  WARRANTY-SESSION                VALUE '3'.
   536         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6312.cbl
   537         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   538
   539
   540*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   541
   542     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   543     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   544
   545     12  PI-CREDIT-USER                  PIC X.
   546         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   547         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   548
   549     12  PI-CLAIM-USER                   PIC X.
   550         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   551         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   552
   553     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   554         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   555         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   556         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   557         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   558         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   559
   560     12  PI-PROCESSOR-ID                 PIC X(4).
   561
   562     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   563
   564     12  PI-MEMBER-CAPTION               PIC X(10).
   565
   566     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   567         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   568
   569     12  PI-LIFE-OVERRIDE-L1             PIC X.
   570     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   571     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   572     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   573
   574     12  PI-AH-OVERRIDE-L1               PIC X.
   575     12  PI-AH-OVERRIDE-L2               PIC XX.
   576     12  PI-AH-OVERRIDE-L6               PIC X(6).
   577     12  PI-AH-OVERRIDE-L12              PIC X(12).
   578
   579     12  PI-NEW-SYSTEM                   PIC X(2).
   580
   581     12  PI-PRIMARY-CERT-NO              PIC X(11).
   582     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   583         88  PI-USES-PAID-TO                 VALUE '1'.
   584     12  PI-CRDTCRD-SYSTEM.
   585         16  PI-CRDTCRD-USER             PIC X.
   586             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   587             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   588         16  PI-CC-MONTH-END-DT          PIC XX.
   589     12  PI-PROCESSOR-PRINTER            PIC X(4).
   590
   591     12  PI-OE-REFERENCE-2.
   592         16  PI-OE-REF-2-PRIME           PIC X(10).
   593         16  PI-OE-REF-2-SUFF            PIC X.
   594
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6312.cbl
   595     12  PI-REM-TRM-CALC-OPTION          PIC X.
   596
   597     12  PI-LANGUAGE-TYPE                PIC X.
   598             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   599             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   600             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   601
   602     12  PI-POLICY-LINKAGE-IND           PIC X.
   603         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   604         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   605                                                   LOW-VALUES.
   606
   607     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   608     12  PI-CLAIM-PW-SESSION             PIC X(1).
   609         88  PI-CLAIM-CREDIT                 VALUE '1'.
   610         88  PI-CLAIM-CONVEN                 VALUE '2'.
   611     12  FILLER                          PIC X(4).
   612
   613     12  PI-SYSTEM-LEVEL                 PIC X(145).
   614
   615     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   616         PI-SYSTEM-LEVEL.
   617
   618         16  PI-ENTRY-CODES.
   619             20  PI-ENTRY-CD-1           PIC X.
   620             20  PI-ENTRY-CD-2           PIC X.
   621
   622         16  PI-RETURN-CODES.
   623             20  PI-RETURN-CD-1          PIC X.
   624             20  PI-RETURN-CD-2          PIC X.
   625
   626         16  PI-UPDATE-STATUS-SAVE.
   627             20  PI-UPDATE-BY            PIC X(4).
   628             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   629
   630         16  PI-LOWER-CASE-LETTERS       PIC X.
   631             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   632
   633*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   634*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   635*            88  CARRIER-CLM-CNTL            VALUE '2'.
   636
   637         16  PI-CERT-ACCESS-CONTROL      PIC X.
   638             88  ST-ACCNT-CNTL               VALUE ' '.
   639             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   640             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   641             88  ACCNT-CNTL                  VALUE '3'.
   642             88  CARR-ACCNT-CNTL             VALUE '4'.
   643
   644         16  PI-PROCESSOR-CAP-LIST.
   645             20  PI-SYSTEM-CONTROLS.
   646                24 PI-SYSTEM-DISPLAY     PIC X.
   647                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   648                24 PI-SYSTEM-MODIFY      PIC X.
   649                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   650             20  FILLER                  PIC XX.
   651             20  PI-DISPLAY-CAP          PIC X.
   652                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6312.cbl
   653             20  PI-MODIFY-CAP           PIC X.
   654                 88  MODIFY-CAP              VALUE 'Y'.
   655             20  PI-MSG-AT-LOGON-CAP     PIC X.
   656                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   657             20  PI-FORCE-CAP            PIC X.
   658                 88  FORCE-CAP               VALUE 'Y'.
   659
   660         16  PI-PROGRAM-CONTROLS.
   661             20  PI-PGM-PRINT-OPT        PIC X.
   662             20  PI-PGM-FORMAT-OPT       PIC X.
   663             20  PI-PGM-PROCESS-OPT      PIC X.
   664             20  PI-PGM-TOTALS-OPT       PIC X.
   665
   666         16  PI-HELP-INTERFACE.
   667             20  PI-LAST-ERROR-NO        PIC X(4).
   668             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   669
   670         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   671             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   672
   673         16  PI-CR-CONTROL-IN-PROGRESS.
   674             20  PI-CR-CARRIER           PIC X.
   675             20  PI-CR-GROUPING          PIC X(6).
   676             20  PI-CR-STATE             PIC XX.
   677             20  PI-CR-ACCOUNT           PIC X(10).
   678             20  PI-CR-FIN-RESP          PIC X(10).
   679             20  PI-CR-TYPE              PIC X.
   680
   681         16  PI-CR-BATCH-NUMBER          PIC X(6).
   682
   683         16  PI-CR-MONTH-END-DT          PIC XX.
   684
   685         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   686             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   687             88  PI-ZERO-CARRIER             VALUE '1'.
   688             88  PI-ZERO-GROUPING            VALUE '2'.
   689             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   690
   691         16  PI-CARRIER-SECURITY         PIC X.
   692             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   693
   694         16  PI-ACCOUNT-SECURITY         PIC X(10).
   695             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   696             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   697
   698         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   699             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   700                                         INDEXED BY PI-ACCESS-NDX
   701                                         PIC X.
   702
   703         16  PI-GA-BILLING-CONTROL       PIC X.
   704             88  PI-GA-BILLING               VALUE '1'.
   705
   706         16  PI-MAIL-PROCESSING          PIC X.
   707             88  PI-MAIL-YES                 VALUE 'Y'.
   708
   709         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   710
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6312.cbl
   711         16  PI-AR-SYSTEM.
   712             20  PI-AR-PROCESSING-CNTL   PIC X.
   713                 88  PI-AR-PROCESSING        VALUE 'Y'.
   714             20  PI-AR-SUMMARY-CODE      PIC X(6).
   715             20  PI-AR-MONTH-END-DT      PIC XX.
   716
   717         16  PI-MP-SYSTEM.
   718             20  PI-MORTGAGE-USER            PIC X.
   719                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   720                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   721             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   722                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   723                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   724                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   725                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   726                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   727             20  PI-MP-MONTH-END-DT          PIC XX.
   728             20  PI-MP-REFERENCE-NO.
   729                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   730                 24  PI-MP-REFERENCE-SFX     PIC XX.
   731
   732         16  PI-LABEL-CONTROL            PIC X(01).
   733             88  PI-CREATE-LABELS                    VALUE 'Y'.
   734             88  PI-BYPASS-LABELS                    VALUE 'N'.
   735
   736         16  PI-BILL-GROUPING-CODE       PIC X(01).
   737             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   738
   739         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   740             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   741             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   742
   743         16  FILLER                      PIC X(14).
   744
   745     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   746******************************************************************
   747     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
   748*    COPY ELC631PI.
   749******************************************************************
   750*                                                                *
   751*                                                                *
   752*                            ELC631PI                            *
   753*                            VMOD=2.012                          *
   754*                                                                *
   755*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   756*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
   757*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   758*                                                                *
   759*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   760*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   761*    BETWEEN PROGRAMS.                                           *
   762*                                                                *
   763*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   764*                                                                *
   765*               EL631 - EL6311 - EL6312 - EL6313                 *
   766*                                                                *
   767******************************************************************
   768
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6312.cbl
   769         16  PI-631-DATA.
   770             20  PI-ERPNDB-KEY.
   771                 24  PI-PB-COMPANY-CD     PIC X.
   772                 24  PI-PB-ENTRY-BATCH    PIC X(6).
   773                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
   774                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
   775
   776             20  PI-ERPNDB-ALT-KEY.
   777                 24  PI-PB-COMPANY-CD-A1  PIC X.
   778                 24  PI-PB-CARRIER        PIC X.
   779                 24  PI-PB-GROUPING       PIC X(6).
   780                 24  PI-PB-STATE          PIC XX.
   781                 24  PI-PB-ACCOUNT        PIC X(10).
   782                 24  PI-PB-CERT-EFF-DT    PIC XX.
   783                 24  PI-PB-CERT-NO.
   784                     28  PI-PB-CERT-PRIME PIC X(10).
   785                     28  PI-PB-CERT-SFX   PIC X.
   786                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
   787                 24  PI-PB-RECORD-TYPE    PIC X.
   788
   789             20  PI-ERPNDB-CSR-KEY.
   790                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
   791                 24  PI-PB-CSR-ID             PIC X(4).
   792                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
   793                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
   794                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
   795
   796             20  PI-BROWSE-TYPE               PIC X.
   797                 88  PI-FILE-BROWSE             VALUE ' '.
   798                 88  PI-PRIMARY-BROWSE          VALUE '1'.
   799                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
   800                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
   801                 88  PI-CSR-BROWSE              VALUE '4'.
   802
   803             20  PI-MAINT-FUNCTION            PIC X.
   804                 88  PI-ADD-FUNCTION            VALUE 'A'.
   805                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
   806                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
   807                 88  PI-DELETE-FUNCTION         VALUE 'D'.
   808                 88  PI-SHOW-FUNCTION           VALUE 'S'.
   809                 88  PI-PF5-FUNCTION            VALUE '5'.
   810                 88  PI-PF6-FUNCTION            VALUE '6'.
   811
   812             20  PI-FILE-SWITCHES.
   813                 24  PI-ALL-ISSUES-SW         PIC X.
   814                     88  ALL-ISSUES             VALUE 'Y'.
   815                 24  PI-ALL-CANCELS-SW        PIC X.
   816                     88  ALL-CANCELS            VALUE 'Y'.
   817                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
   818                     88  ISSUES-IN-ERROR        VALUE 'Y'.
   819                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
   820                     88  CANCEL-IN-ERROR        VALUE 'Y'.
   821                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
   822                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
   823                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
   824                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
   825                 24  PI-HOLD-REC-SW           PIC X.
   826                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6312.cbl
   827                 24  PI-CHANGE-REC-SW         PIC X.
   828                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
   829                 24  PI-CHK-REQ-REC-SW        PIC X.
   830                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
   831                 24  PI-ISSUE-WARNING-SW      PIC X.
   832                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
   833                 24  PI-CANCEL-WARNING-SW     PIC X.
   834                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
   835             20  PI-DISPLAY-SCREEN-SW         PIC X.
   836                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
   837             20  PI-ORIGINAL-BATCH-SW         PIC X.
   838                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
   839
   840             20  PI-MAP-NAME                  PIC X(8).
   841
   842             20  PI-CURSOR                    PIC S9(4) COMP.
   843
   844             20  PI-PREV-ALT-KEY              PIC X(36).
   845             20  PI-PREV-CSR-KEY              PIC X(15).
   846             20  PI-PREV-KEY.
   847                 24  PI-PREV-COMPANY-CD       PIC X.
   848                 24  PI-PREV-BATCH            PIC X(6).
   849                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
   850                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
   851             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
   852             20  PI-BROWSE-SW                 PIC X.
   853                 88  PI-GOOD-BROWSE             VALUE 'Y'.
   854                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
   855             20  PI-SV-CARRIER                PIC X.
   856             20  PI-SV-GROUPING               PIC X(6).
   857             20  PI-SV-STATE                  PIC XX.
   858             20  PI-EDIT-SW                   PIC X.
   859             20  PI-DISPLAY-SW                PIC XX.
   860                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
   861                 88 PI-DISPLAY-AH          VALUE 'AH'.
   862             20  PI-CRITERIA-DATA             PIC X(350).
   863             20  PI-BMODE                     PIC X.
   864             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
   865             20  PI-BPMTS                     PIC S999     COMP-3.
   866             20  PI-BTYPE                     PIC XXX OCCURS 2.
   867             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
   868             20  FILLER                       PIC X(7).
   869
   870        16  FILLER          PIC X(94).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6312.cbl
   872 01  EDIT-CRITERIA-AREA.
   873*    COPY ELCEDITC.
   874******************************************************************
   875*                                                                *
   876*                                                                *
   877*                            ELCEDITC                            *
   878*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   879*                            VMOD=2.012                          *
   880*                                                                *
   881*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
   882*                     EL6313, EL050 AND EL517.                   *
   883*                                                                *
   884******************************************************************
   885******************************************************************
   886*                   C H A N G E   L O G
   887*
   888* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   889*-----------------------------------------------------------------
   890*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   891* EFFECTIVE    NUMBER
   892*-----------------------------------------------------------------
   893* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   894******************************************************************
   895
   896     12  EDIT-CRITERIA-DATA.
   897         16  EC-CO-MONTH-END-DT       PIC XX.
   898         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
   899         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
   900         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
   901         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
   902         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
   903         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
   904         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
   905         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
   906         16  EC-CO-REM-TERM-CALC      PIC X.
   907               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
   908               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
   909               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
   910               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
   911
   912         16  EC-BR-LF-EARNINGS-CALC    PIC X.
   913               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
   914               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
   915               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
   916               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
   917               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
   918               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
   919               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
   920               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
   921               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
   922               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
   923
   924         16  EC-BR-AH-EARNINGS-CALC    PIC X.
   925               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
   926               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
   927               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
   928               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
   929               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6312.cbl
   930               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
   931               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
   932               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
   933
   934         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
   935                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
   936                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
   937
   938         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
   939                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
   940                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
   941                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
   942                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
   943                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
   944                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
   945                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
   946                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
   947
   948         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
   949               88  EC-BR-REDUCING                   VALUE 'R'.
   950               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
   951
   952         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
   953         16  EC-BR-LF-DESC             PIC X(10).
   954         16  EC-BR-AH-DESC             PIC X(10).
   955         16  EC-BR-LF-COMMENT          PIC X(10).
   956         16  EC-BR-AH-COMMENT          PIC X(10).
   957
   958         16  EC-BR-LF-REM-TERM-CALC    PIC X.
   959               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
   960               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
   961               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
   962               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
   963
   964         16  EC-BR-AH-REM-TERM-CALC    PIC X.
   965               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
   966               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
   967               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
   968               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
   969
   970         16  EC-BR-LF-REFUND-CALC      PIC X.
   971                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
   972                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
   973                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
   974                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
   975                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
   976                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
   977                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
   978
   979         16  EC-BR-AH-REFUND-CALC      PIC X.
   980                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
   981                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
   982                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
   983                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
   984                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
   985                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
   986                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
   987                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6312.cbl
   988
   989         16  EC-BR-LF-BEN-I-G-CD       PIC X.
   990                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
   991                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
   992                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
   993
   994         16  EC-BR-AH-BEN-I-G-CD       PIC X.
   995                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
   996                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
   997                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
   998
   999         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  1000         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  1001         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  1002         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  1003
  1004         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  1005         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  1006                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  1007                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  1008                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  1009                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  1010
  1011         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  1012               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  1013               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  1014               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  1015               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  1016               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  1017
  1018         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  1019               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  1020               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  1021               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  1022               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  1023               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  1024
  1025         16  EC-ST-LF-REFUND-CALC      PIC X.
  1026                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  1027                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  1028                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  1029                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  1030                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  1031                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  1032                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  1033                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  1034
  1035         16  EC-ST-AH-REFUND-CALC      PIC X.
  1036                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  1037                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  1038                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  1039                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  1040                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  1041                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  1042                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  1043                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  1044
  1045         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6312.cbl
  1046         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  1047         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  1048         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  1049         16  EC-AM-EXPIRATION-DT       PIC XX.
  1050         16  EC-AM-EFFECTIVE-DT        PIC XX.
  1051         16  EC-AM-CLASS-CD            PIC XX.
  1052         16  EC-AM-LF-DEVIATION        PIC XXX.
  1053         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  1054         16  EC-AM-AH-DEVIATION        PIC XXX.
  1055         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  1056         16  EC-AM-PHONE-NO            PIC X(10).
  1057
  1058         16  EC-AM-LF-REFUND-CALC      PIC X.
  1059                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  1060                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  1061                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  1062                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  1063                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  1064                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  1065                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  1066
  1067         16  EC-AM-AH-REFUND-CALC      PIC X.
  1068                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  1069                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  1070                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  1071                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  1072                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  1073                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  1074                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  1075
  1076         16  EC-AM-BEN-I-G-CD          PIC X.
  1077                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  1078                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  1079                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  1080
  1081         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  1082         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  1083         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  1084         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  1085         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  1086         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  1087         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  1088         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  1089         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  1090
  1091         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  1092         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  1093         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  1094         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  1095         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  1096         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  1097         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  1098         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  1099         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  1100         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  1101         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  1102         16  EC-RT-LF-NSP-ST           PIC XX.
  1103         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6312.cbl
  1104         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  1105         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  1106
  1107         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  1108             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  1109                                             'M' '5' '9' '2'.
  1110             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  1111             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  1112             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  1113             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  1114             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  1115             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  1116             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  1117             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  1118             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  1119             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  1120
  1121         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  1122             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  1123                                             'M' '5' '9' '2'.
  1124             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  1125             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  1126             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  1127             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  1128             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  1129             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  1130             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  1131             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  1132             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  1133             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  1134
  1135         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  1136         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  1137         16  EC-CM-LF-CANCEL-DT        PIC XX.
  1138         16  EC-CM-AH-CANCEL-DT        PIC XX.
  1139         16  EC-CM-DEATH-DT            PIC XX.
  1140
  1141*DMD CUSTOM CODING FIELDS BELOW
  1142*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  1143         16  EC-BR-DMD-RATING-SW       PIC X.
  1144                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  1145                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  1146                 88  NO-DMD-RATING               VALUE 'N'.
  1147
  1148         16  EC-NEW-CERT               PIC X(11).
  1149         16  EC-NEW-STATE              PIC XX.
  1150         16  FILLER                    PIC X.
  1151*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  1152         16  OVER-SHORT-EDIT-FIELDS.
  1153             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  1154             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  1155             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  1156             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  1157             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  1158             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  1159             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  1160             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  1161             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6312.cbl
  1162         16  FILLER                    PIC X(71).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6312.cbl
  1164*    COPY ELCAID.
  1165******************************************************************
  1166*                                                                *
  1167*                            ELCAID.                             *
  1168*                            VMOD=2.001                          *
  1169*                                                                *
  1170*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1171*                                                                *
  1172*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1173*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1174******************************************************************
  1175
  1176 01  DFHAID.
  1177   02  DFHNULL   PIC  X  VALUE  ' '.
  1178   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1179   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1180   02  DFHPEN    PIC  X  VALUE  '='.
  1181   02  DFHOPID   PIC  X  VALUE  'W'.
  1182   02  DFHPA1    PIC  X  VALUE  '%'.
  1183   02  DFHPA2    PIC  X  VALUE  '>'.
  1184   02  DFHPA3    PIC  X  VALUE  ','.
  1185   02  DFHPF1    PIC  X  VALUE  '1'.
  1186   02  DFHPF2    PIC  X  VALUE  '2'.
  1187   02  DFHPF3    PIC  X  VALUE  '3'.
  1188   02  DFHPF4    PIC  X  VALUE  '4'.
  1189   02  DFHPF5    PIC  X  VALUE  '5'.
  1190   02  DFHPF6    PIC  X  VALUE  '6'.
  1191   02  DFHPF7    PIC  X  VALUE  '7'.
  1192   02  DFHPF8    PIC  X  VALUE  '8'.
  1193   02  DFHPF9    PIC  X  VALUE  '9'.
  1194   02  DFHPF10   PIC  X  VALUE  ':'.
  1195   02  DFHPF11   PIC  X  VALUE  '#'.
  1196   02  DFHPF12   PIC  X  VALUE  '@'.
  1197   02  DFHPF13   PIC  X  VALUE  'A'.
  1198   02  DFHPF14   PIC  X  VALUE  'B'.
  1199   02  DFHPF15   PIC  X  VALUE  'C'.
  1200   02  DFHPF16   PIC  X  VALUE  'D'.
  1201   02  DFHPF17   PIC  X  VALUE  'E'.
  1202   02  DFHPF18   PIC  X  VALUE  'F'.
  1203   02  DFHPF19   PIC  X  VALUE  'G'.
  1204   02  DFHPF20   PIC  X  VALUE  'H'.
  1205   02  DFHPF21   PIC  X  VALUE  'I'.
  1206*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1207   02  DFHPF22   PIC  X  VALUE  '['.
  1208   02  DFHPF23   PIC  X  VALUE  '.'.
  1209   02  DFHPF24   PIC  X  VALUE  '<'.
  1210   02  DFHMSRE   PIC  X  VALUE  'X'.
  1211   02  DFHSTRF   PIC  X  VALUE  'h'.
  1212   02  DFHTRIG   PIC  X  VALUE  '"'.
  1213
  1214 01  FILLER    REDEFINES DFHAID.
  1215     12  FILLER              PIC X(8).
  1216     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6312.cbl
  1218*   COPY EL6312S.
  1219 01  EL631EI.
  1220     05  FILLER            PIC  X(0012).
  1221*    -------------------------------
  1222     05  DATEL PIC S9(0004) COMP.
  1223     05  DATEF PIC  X(0001).
  1224     05  FILLER REDEFINES DATEF.
  1225         10  DATEA PIC  X(0001).
  1226     05  DATEI PIC  X(0008).
  1227*    -------------------------------
  1228     05  TIMEL PIC S9(0004) COMP.
  1229     05  TIMEF PIC  X(0001).
  1230     05  FILLER REDEFINES TIMEF.
  1231         10  TIMEA PIC  X(0001).
  1232     05  TIMEI PIC  X(0005).
  1233*    -------------------------------
  1234     05  HEADL PIC S9(0004) COMP.
  1235     05  HEADF PIC  X(0001).
  1236     05  FILLER REDEFINES HEADF.
  1237         10  HEADA PIC  X(0001).
  1238     05  HEADI PIC  X(0006).
  1239*    -------------------------------
  1240     05  CISSTOLL PIC S9(0004) COMP.
  1241     05  CISSTOLF PIC  X(0001).
  1242     05  FILLER REDEFINES CISSTOLF.
  1243         10  CISSTOLA PIC  X(0001).
  1244     05  CISSTOLI PIC  X(0006).
  1245*    -------------------------------
  1246     05  CCANTOLL PIC S9(0004) COMP.
  1247     05  CCANTOLF PIC  X(0001).
  1248     05  FILLER REDEFINES CCANTOLF.
  1249         10  CCANTOLA PIC  X(0001).
  1250     05  CCANTOLI PIC  X(0006).
  1251*    -------------------------------
  1252     05  COVSAMTL PIC S9(0004) COMP.
  1253     05  COVSAMTF PIC  X(0001).
  1254     05  FILLER REDEFINES COVSAMTF.
  1255         10  COVSAMTA PIC  X(0001).
  1256     05  COVSAMTI PIC  X(0006).
  1257*    -------------------------------
  1258     05  CMAGEL PIC S9(0004) COMP.
  1259     05  CMAGEF PIC  X(0001).
  1260     05  FILLER REDEFINES CMAGEF.
  1261         10  CMAGEA PIC  X(0001).
  1262     05  CMAGEI PIC  X(0002).
  1263*    -------------------------------
  1264     05  CMPREML PIC S9(0004) COMP.
  1265     05  CMPREMF PIC  X(0001).
  1266     05  FILLER REDEFINES CMPREMF.
  1267         10  CMPREMA PIC  X(0001).
  1268     05  CMPREMI PIC  X(0008).
  1269*    -------------------------------
  1270     05  CMENDL PIC S9(0004) COMP.
  1271     05  CMENDF PIC  X(0001).
  1272     05  FILLER REDEFINES CMENDF.
  1273         10  CMENDA PIC  X(0001).
  1274     05  CMENDI PIC  X(0008).
  1275*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6312.cbl
  1276     05  CMTERML PIC S9(0004) COMP.
  1277     05  CMTERMF PIC  X(0001).
  1278     05  FILLER REDEFINES CMTERMF.
  1279         10  CMTERMA PIC  X(0001).
  1280     05  CMTERMI PIC  X(0003).
  1281*    -------------------------------
  1282     05  CMXTERML PIC S9(0004) COMP.
  1283     05  CMXTERMF PIC  X(0001).
  1284     05  FILLER REDEFINES CMXTERMF.
  1285         10  CMXTERMA PIC  X(0001).
  1286     05  CMXTERMI PIC  X(0003).
  1287*    -------------------------------
  1288     05  CRTERML PIC S9(0004) COMP.
  1289     05  CRTERMF PIC  X(0001).
  1290     05  FILLER REDEFINES CRTERMF.
  1291         10  CRTERMA PIC  X(0001).
  1292     05  CRTERMI PIC  X(0010).
  1293*    -------------------------------
  1294     05  BTYPEL PIC S9(0004) COMP.
  1295     05  BTYPEF PIC  X(0001).
  1296     05  FILLER REDEFINES BTYPEF.
  1297         10  BTYPEA PIC  X(0001).
  1298     05  BTYPEI PIC  X(0008).
  1299*    -------------------------------
  1300     05  BCOMML PIC S9(0004) COMP.
  1301     05  BCOMMF PIC  X(0001).
  1302     05  FILLER REDEFINES BCOMMF.
  1303         10  BCOMMA PIC  X(0001).
  1304     05  BCOMMI PIC  X(0010).
  1305*    -------------------------------
  1306     05  BEARNML PIC S9(0004) COMP.
  1307     05  BEARNMF PIC  X(0001).
  1308     05  FILLER REDEFINES BEARNMF.
  1309         10  BEARNMA PIC  X(0001).
  1310     05  BEARNMI PIC  X(0010).
  1311*    -------------------------------
  1312     05  BSPECL PIC S9(0004) COMP.
  1313     05  BSPECF PIC  X(0001).
  1314     05  FILLER REDEFINES BSPECF.
  1315         10  BSPECA PIC  X(0001).
  1316     05  BSPECI PIC  X(0010).
  1317*    -------------------------------
  1318     05  BRMETHL PIC S9(0004) COMP.
  1319     05  BRMETHF PIC  X(0001).
  1320     05  FILLER REDEFINES BRMETHF.
  1321         10  BRMETHA PIC  X(0001).
  1322     05  BRMETHI PIC  X(0010).
  1323*    -------------------------------
  1324     05  BIGL PIC S9(0004) COMP.
  1325     05  BIGF PIC  X(0001).
  1326     05  FILLER REDEFINES BIGF.
  1327         10  BIGA PIC  X(0001).
  1328     05  BIGI PIC  X(0001).
  1329*    -------------------------------
  1330     05  BRTERML PIC S9(0004) COMP.
  1331     05  BRTERMF PIC  X(0001).
  1332     05  FILLER REDEFINES BRTERMF.
  1333         10  BRTERMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6312.cbl
  1334     05  BRTERMI PIC  X(0010).
  1335*    -------------------------------
  1336     05  SISSTOLL PIC S9(0004) COMP.
  1337     05  SISSTOLF PIC  X(0001).
  1338     05  FILLER REDEFINES SISSTOLF.
  1339         10  SISSTOLA PIC  X(0001).
  1340     05  SISSTOLI PIC  X(0006).
  1341*    -------------------------------
  1342     05  SISSPCTL PIC S9(0004) COMP.
  1343     05  SISSPCTF PIC  X(0001).
  1344     05  FILLER REDEFINES SISSPCTF.
  1345         10  SISSPCTA PIC  X(0001).
  1346     05  SISSPCTI PIC  X(0006).
  1347*    -------------------------------
  1348     05  SOVSTOLL PIC S9(0004) COMP.
  1349     05  SOVSTOLF PIC  X(0001).
  1350     05  FILLER REDEFINES SOVSTOLF.
  1351         10  SOVSTOLA PIC  X(0001).
  1352     05  SOVSTOLI PIC  X(0006).
  1353*    -------------------------------
  1354     05  SCANTOLL PIC S9(0004) COMP.
  1355     05  SCANTOLF PIC  X(0001).
  1356     05  FILLER REDEFINES SCANTOLF.
  1357         10  SCANTOLA PIC  X(0001).
  1358     05  SCANTOLI PIC  X(0006).
  1359*    -------------------------------
  1360     05  SOVSPCTL PIC S9(0004) COMP.
  1361     05  SOVSPCTF PIC  X(0001).
  1362     05  FILLER REDEFINES SOVSPCTF.
  1363         10  SOVSPCTA PIC  X(0001).
  1364     05  SOVSPCTI PIC  X(0006).
  1365*    -------------------------------
  1366     05  SCANPCTL PIC S9(0004) COMP.
  1367     05  SCANPCTF PIC  X(0001).
  1368     05  FILLER REDEFINES SCANPCTF.
  1369         10  SCANPCTA PIC  X(0001).
  1370     05  SCANPCTI PIC  X(0006).
  1371*    -------------------------------
  1372     05  SRMETHL PIC S9(0004) COMP.
  1373     05  SRMETHF PIC  X(0001).
  1374     05  FILLER REDEFINES SRMETHF.
  1375         10  SRMETHA PIC  X(0001).
  1376     05  SRMETHI PIC  X(0009).
  1377*    -------------------------------
  1378     05  SRTERML PIC S9(0004) COMP.
  1379     05  SRTERMF PIC  X(0001).
  1380     05  FILLER REDEFINES SRTERMF.
  1381         10  SRTERMA PIC  X(0001).
  1382     05  SRTERMI PIC  X(0010).
  1383*    -------------------------------
  1384     05  AISSTOLL PIC S9(0004) COMP.
  1385     05  AISSTOLF PIC  X(0001).
  1386     05  FILLER REDEFINES AISSTOLF.
  1387         10  AISSTOLA PIC  X(0001).
  1388     05  AISSTOLI PIC  X(0006).
  1389*    -------------------------------
  1390     05  AEFFDTL PIC S9(0004) COMP.
  1391     05  AEFFDTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6312.cbl
  1392     05  FILLER REDEFINES AEFFDTF.
  1393         10  AEFFDTA PIC  X(0001).
  1394     05  AEFFDTI PIC  X(0008).
  1395*    -------------------------------
  1396     05  AEXPDTEL PIC S9(0004) COMP.
  1397     05  AEXPDTEF PIC  X(0001).
  1398     05  FILLER REDEFINES AEXPDTEF.
  1399         10  AEXPDTEA PIC  X(0001).
  1400     05  AEXPDTEI PIC  X(0008).
  1401*    -------------------------------
  1402     05  ARMETHL PIC S9(0004) COMP.
  1403     05  ARMETHF PIC  X(0001).
  1404     05  FILLER REDEFINES ARMETHF.
  1405         10  ARMETHA PIC  X(0001).
  1406     05  ARMETHI PIC  X(0010).
  1407*    -------------------------------
  1408     05  AOVSTOLL PIC S9(0004) COMP.
  1409     05  AOVSTOLF PIC  X(0001).
  1410     05  FILLER REDEFINES AOVSTOLF.
  1411         10  AOVSTOLA PIC  X(0001).
  1412     05  AOVSTOLI PIC  X(0006).
  1413*    -------------------------------
  1414     05  ACANTOLL PIC S9(0004) COMP.
  1415     05  ACANTOLF PIC  X(0001).
  1416     05  FILLER REDEFINES ACANTOLF.
  1417         10  ACANTOLA PIC  X(0001).
  1418     05  ACANTOLI PIC  X(0006).
  1419*    -------------------------------
  1420     05  AIGL PIC S9(0004) COMP.
  1421     05  AIGF PIC  X(0001).
  1422     05  FILLER REDEFINES AIGF.
  1423         10  AIGA PIC  X(0001).
  1424     05  AIGI PIC  X(0001).
  1425*    -------------------------------
  1426     05  ACLASSL PIC S9(0004) COMP.
  1427     05  ACLASSF PIC  X(0001).
  1428     05  FILLER REDEFINES ACLASSF.
  1429         10  ACLASSA PIC  X(0001).
  1430     05  ACLASSI PIC  X(0002).
  1431*    -------------------------------
  1432     05  ADEVL PIC S9(0004) COMP.
  1433     05  ADEVF PIC  X(0001).
  1434     05  FILLER REDEFINES ADEVF.
  1435         10  ADEVA PIC  X(0001).
  1436     05  ADEVI PIC  X(0003).
  1437*    -------------------------------
  1438     05  ADEVPCTL PIC S9(0004) COMP.
  1439     05  ADEVPCTF PIC  X(0001).
  1440     05  FILLER REDEFINES ADEVPCTF.
  1441         10  ADEVPCTA PIC  X(0001).
  1442     05  ADEVPCTI PIC  99V999999.
  1443*    -------------------------------
  1444     05  AHEADML PIC S9(0004) COMP.
  1445     05  AHEADMF PIC  X(0001).
  1446     05  FILLER REDEFINES AHEADMF.
  1447         10  AHEADMA PIC  X(0001).
  1448     05  AHEADMI PIC  X(0011).
  1449*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6312.cbl
  1450     05  OBHEADL PIC S9(0004) COMP.
  1451     05  OBHEADF PIC  X(0001).
  1452     05  FILLER REDEFINES OBHEADF.
  1453         10  OBHEADA PIC  X(0001).
  1454     05  OBHEADI PIC  X(0011).
  1455*    -------------------------------
  1456     05  AMAAGEL PIC S9(0004) COMP.
  1457     05  AMAAGEF PIC  X(0001).
  1458     05  FILLER REDEFINES AMAAGEF.
  1459         10  AMAAGEA PIC  X(0001).
  1460     05  AMAAGEI PIC  X(0003).
  1461*    -------------------------------
  1462     05  AMAGEL PIC S9(0004) COMP.
  1463     05  AMAGEF PIC  X(0001).
  1464     05  FILLER REDEFINES AMAGEF.
  1465         10  AMAGEA PIC  X(0001).
  1466     05  AMAGEI PIC  X(0003).
  1467*    -------------------------------
  1468     05  AMTERML PIC S9(0004) COMP.
  1469     05  AMTERMF PIC  X(0001).
  1470     05  FILLER REDEFINES AMTERMF.
  1471         10  AMTERMA PIC  X(0001).
  1472     05  AMTERMI PIC  X(0003).
  1473*    -------------------------------
  1474     05  AMTBENL PIC S9(0004) COMP.
  1475     05  AMTBENF PIC  X(0001).
  1476     05  FILLER REDEFINES AMTBENF.
  1477         10  AMTBENA PIC  X(0001).
  1478     05  AMTBENI PIC  X(0010).
  1479*    -------------------------------
  1480     05  AMMBENL PIC S9(0004) COMP.
  1481     05  AMMBENF PIC  X(0001).
  1482     05  FILLER REDEFINES AMMBENF.
  1483         10  AMMBENA PIC  X(0001).
  1484     05  AMMBENI PIC  X(0010).
  1485*    -------------------------------
  1486     05  OBRATEL PIC S9(0004) COMP.
  1487     05  OBRATEF PIC  X(0001).
  1488     05  FILLER REDEFINES OBRATEF.
  1489         10  OBRATEA PIC  X(0001).
  1490     05  OBRATEI PIC  X(0010).
  1491*    -------------------------------
  1492     05  PHONEL PIC S9(0004) COMP.
  1493     05  PHONEF PIC  X(0001).
  1494     05  FILLER REDEFINES PHONEF.
  1495         10  PHONEA PIC  X(0001).
  1496     05  PHONEI PIC  X(0012).
  1497*    -------------------------------
  1498     05  RMAAGEL PIC S9(0004) COMP.
  1499     05  RMAAGEF PIC  X(0001).
  1500     05  FILLER REDEFINES RMAAGEF.
  1501         10  RMAAGEA PIC  X(0001).
  1502     05  RMAAGEI PIC  X(0003).
  1503*    -------------------------------
  1504     05  RMAGEL PIC S9(0004) COMP.
  1505     05  RMAGEF PIC  X(0001).
  1506     05  FILLER REDEFINES RMAGEF.
  1507         10  RMAGEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6312.cbl
  1508     05  RMAGEI PIC  X(0003).
  1509*    -------------------------------
  1510     05  RMTERML PIC S9(0004) COMP.
  1511     05  RMTERMF PIC  X(0001).
  1512     05  FILLER REDEFINES RMTERMF.
  1513         10  RMTERMA PIC  X(0001).
  1514     05  RMTERMI PIC  X(0003).
  1515*    -------------------------------
  1516     05  RMTBENL PIC S9(0004) COMP.
  1517     05  RMTBENF PIC  X(0001).
  1518     05  FILLER REDEFINES RMTBENF.
  1519         10  RMTBENA PIC  X(0001).
  1520     05  RMTBENI PIC  X(0010).
  1521*    -------------------------------
  1522     05  RMMBENL PIC S9(0004) COMP.
  1523     05  RMMBENF PIC  X(0001).
  1524     05  FILLER REDEFINES RMMBENF.
  1525         10  RMMBENA PIC  X(0001).
  1526     05  RMMBENI PIC  X(0010).
  1527*    -------------------------------
  1528     05  RRATESL PIC S9(0004) COMP.
  1529     05  RRATESF PIC  X(0001).
  1530     05  FILLER REDEFINES RRATESF.
  1531         10  RRATESA PIC  X(0001).
  1532     05  RRATESI PIC  X(0009).
  1533*    -------------------------------
  1534     05  RNSPSTL PIC S9(0004) COMP.
  1535     05  RNSPSTF PIC  X(0001).
  1536     05  FILLER REDEFINES RNSPSTF.
  1537         10  RNSPSTA PIC  X(0001).
  1538     05  RNSPSTI PIC  X(0002).
  1539*    -------------------------------
  1540     05  RNSPRTL PIC S9(0004) COMP.
  1541     05  RNSPRTF PIC  X(0001).
  1542     05  FILLER REDEFINES RNSPRTF.
  1543         10  RNSPRTA PIC  X(0001).
  1544     05  RNSPRTI PIC  X(0008).
  1545*    -------------------------------
  1546     05  CTDATEHL PIC S9(0004) COMP.
  1547     05  CTDATEHF PIC  X(0001).
  1548     05  FILLER REDEFINES CTDATEHF.
  1549         10  CTDATEHA PIC  X(0001).
  1550     05  CTDATEHI PIC  X(0010).
  1551*    -------------------------------
  1552     05  DRATESL PIC S9(0004) COMP.
  1553     05  DRATESF PIC  X(0001).
  1554     05  FILLER REDEFINES DRATESF.
  1555         10  DRATESA PIC  X(0001).
  1556     05  DRATESI PIC  X(0009).
  1557*    -------------------------------
  1558     05  CTSTL PIC S9(0004) COMP.
  1559     05  CTSTF PIC  X(0001).
  1560     05  FILLER REDEFINES CTSTF.
  1561         10  CTSTA PIC  X(0001).
  1562     05  CTSTI PIC  X(0009).
  1563*    -------------------------------
  1564     05  CTRFUNDL PIC S9(0004) COMP.
  1565     05  CTRFUNDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6312.cbl
  1566     05  FILLER REDEFINES CTRFUNDF.
  1567         10  CTRFUNDA PIC  X(0001).
  1568     05  CTRFUNDI PIC  X(0010).
  1569*    -------------------------------
  1570     05  CTDATEL PIC S9(0004) COMP.
  1571     05  CTDATEF PIC  X(0001).
  1572     05  FILLER REDEFINES CTDATEF.
  1573         10  CTDATEA PIC  X(0001).
  1574     05  CTDATEI PIC  X(0008).
  1575*    -------------------------------
  1576     05  ERRMSG1L PIC S9(0004) COMP.
  1577     05  ERRMSG1F PIC  X(0001).
  1578     05  FILLER REDEFINES ERRMSG1F.
  1579         10  ERRMSG1A PIC  X(0001).
  1580     05  ERRMSG1I PIC  X(0074).
  1581*    -------------------------------
  1582     05  PFENTERL PIC S9(0004) COMP.
  1583     05  PFENTERF PIC  X(0001).
  1584     05  FILLER REDEFINES PFENTERF.
  1585         10  PFENTERA PIC  X(0001).
  1586     05  PFENTERI PIC  9(2).
  1587*    -------------------------------
  1588     05  PFOPTL PIC S9(0004) COMP.
  1589     05  PFOPTF PIC  X(0001).
  1590     05  FILLER REDEFINES PFOPTF.
  1591         10  PFOPTA PIC  X(0001).
  1592     05  PFOPTI PIC  X(0006).
  1593 01  EL631EO REDEFINES EL631EI.
  1594     05  FILLER            PIC  X(0012).
  1595*    -------------------------------
  1596     05  FILLER            PIC  X(0003).
  1597     05  DATEO PIC  X(0008).
  1598*    -------------------------------
  1599     05  FILLER            PIC  X(0003).
  1600     05  TIMEO PIC  99.99.
  1601*    -------------------------------
  1602     05  FILLER            PIC  X(0003).
  1603     05  HEADO PIC  X(0006).
  1604*    -------------------------------
  1605     05  FILLER            PIC  X(0003).
  1606     05  CISSTOLO PIC  ZZZ.99.
  1607*    -------------------------------
  1608     05  FILLER            PIC  X(0003).
  1609     05  CCANTOLO PIC  ZZZ.99.
  1610*    -------------------------------
  1611     05  FILLER            PIC  X(0003).
  1612     05  COVSAMTO PIC  ZZZ.99.
  1613*    -------------------------------
  1614     05  FILLER            PIC  X(0003).
  1615     05  CMAGEO PIC  99.
  1616*    -------------------------------
  1617     05  FILLER            PIC  X(0003).
  1618     05  CMPREMO PIC  ZZZZZ.99.
  1619*    -------------------------------
  1620     05  FILLER            PIC  X(0003).
  1621     05  CMENDO PIC  X(0008).
  1622*    -------------------------------
  1623     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6312.cbl
  1624     05  CMTERMO PIC  ZZ9.
  1625*    -------------------------------
  1626     05  FILLER            PIC  X(0003).
  1627     05  CMXTERMO PIC  ZZ9.
  1628*    -------------------------------
  1629     05  FILLER            PIC  X(0003).
  1630     05  CRTERMO PIC  X(0010).
  1631*    -------------------------------
  1632     05  FILLER            PIC  X(0003).
  1633     05  BTYPEO PIC  X(0008).
  1634*    -------------------------------
  1635     05  FILLER            PIC  X(0003).
  1636     05  BCOMMO PIC  X(0010).
  1637*    -------------------------------
  1638     05  FILLER            PIC  X(0003).
  1639     05  BEARNMO PIC  X(0010).
  1640*    -------------------------------
  1641     05  FILLER            PIC  X(0003).
  1642     05  BSPECO PIC  X(0010).
  1643*    -------------------------------
  1644     05  FILLER            PIC  X(0003).
  1645     05  BRMETHO PIC  X(0010).
  1646*    -------------------------------
  1647     05  FILLER            PIC  X(0003).
  1648     05  BIGO PIC  X(0001).
  1649*    -------------------------------
  1650     05  FILLER            PIC  X(0003).
  1651     05  BRTERMO PIC  X(0010).
  1652*    -------------------------------
  1653     05  FILLER            PIC  X(0003).
  1654     05  SISSTOLO PIC  ZZZ.99.
  1655*    -------------------------------
  1656     05  FILLER            PIC  X(0003).
  1657     05  SISSPCTO PIC  Z.9999.
  1658*    -------------------------------
  1659     05  FILLER            PIC  X(0003).
  1660     05  SOVSTOLO PIC  ZZZ.99.
  1661*    -------------------------------
  1662     05  FILLER            PIC  X(0003).
  1663     05  SCANTOLO PIC  ZZZ.99.
  1664*    -------------------------------
  1665     05  FILLER            PIC  X(0003).
  1666     05  SOVSPCTO PIC  Z.9999.
  1667*    -------------------------------
  1668     05  FILLER            PIC  X(0003).
  1669     05  SCANPCTO PIC  Z.9999.
  1670*    -------------------------------
  1671     05  FILLER            PIC  X(0003).
  1672     05  SRMETHO PIC  X(0009).
  1673*    -------------------------------
  1674     05  FILLER            PIC  X(0003).
  1675     05  SRTERMO PIC  X(0010).
  1676*    -------------------------------
  1677     05  FILLER            PIC  X(0003).
  1678     05  AISSTOLO PIC  ZZZ.99.
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
  1681     05  AEFFDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6312.cbl
  1682*    -------------------------------
  1683     05  FILLER            PIC  X(0003).
  1684     05  AEXPDTEO PIC  X(0008).
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  ARMETHO PIC  X(0010).
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  AOVSTOLO PIC  ZZZ.99.
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  ACANTOLO PIC  ZZZ.99.
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  AIGO PIC  X(0001).
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  ACLASSO PIC  X(0002).
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  ADEVO PIC  X(0003).
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  ADEVPCTO PIC  9.999999.
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  AHEADMO PIC  X(0011).
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  OBHEADO PIC  X(0011).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  AMAAGEO PIC  ZZ9.
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  AMAGEO PIC  ZZ9.
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  AMTERMO PIC  ZZ9.
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  AMTBENO PIC  ZZZZZZ9.99.
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  AMMBENO PIC  ZZZZZZ9.99.
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  OBRATEO PIC  ZZZ9.99999.
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  PHONEO PIC  999B999B9999.
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  RMAAGEO PIC  ZZ9.
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  RMAGEO PIC  ZZ9.
  1739*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6312.cbl
  1740     05  FILLER            PIC  X(0003).
  1741     05  RMTERMO PIC  ZZ9.
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  RMTBENO PIC  ZZZZZZ9.99.
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  RMMBENO PIC  ZZZZZZ9.99.
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  RRATESO PIC  ZZZ.99999.
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  RNSPSTO PIC  X(0002).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  RNSPRTO PIC  ZZ.99999.
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  CTDATEHO PIC  X(0010).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  DRATESO PIC  ZZZ.99999.
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  CTSTO PIC  X(0009).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  CTRFUNDO PIC  ZZZZZZ9.99.
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  CTDATEO PIC  X(0008).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  ERRMSG1O PIC  X(0074).
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  PFENTERO PIC  99.
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  PFOPTO PIC  X(0006).
  1781*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6312.cbl
  1783****************************************************************
  1784*
  1785* Copyright (c) 2007 by Clerity Solutions, Inc.
  1786* All rights reserved.
  1787*
  1788****************************************************************
  1789 01  DFHEIV.
  1790   02  DFHEIV0               PIC X(35).
  1791   02  DFHEIV1               PIC X(08).
  1792   02  DFHEIV2               PIC X(08).
  1793   02  DFHEIV3               PIC X(08).
  1794   02  DFHEIV4               PIC X(06).
  1795   02  DFHEIV5               PIC X(04).
  1796   02  DFHEIV6               PIC X(04).
  1797   02  DFHEIV7               PIC X(02).
  1798   02  DFHEIV8               PIC X(02).
  1799   02  DFHEIV9               PIC X(01).
  1800   02  DFHEIV10              PIC S9(7) COMP-3.
  1801   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1802   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1803   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1804   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1805   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1806   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1807   02  DFHEIV17              PIC X(04).
  1808   02  DFHEIV18              PIC X(04).
  1809   02  DFHEIV19              PIC X(04).
  1810   02  DFHEIV20              USAGE IS POINTER.
  1811   02  DFHEIV21              USAGE IS POINTER.
  1812   02  DFHEIV22              USAGE IS POINTER.
  1813   02  DFHEIV23              USAGE IS POINTER.
  1814   02  DFHEIV24              USAGE IS POINTER.
  1815   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1816   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1817   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1818   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1819   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1820   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1821   02  FILLER                PIC X(02).
  1822   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1823   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1824   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1825   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1826   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1827 LINKAGE  SECTION.
  1828*****************************************************************
  1829*                                                               *
  1830* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1831* All rights reserved.                                          *
  1832*                                                               *
  1833*****************************************************************
  1834 01  dfheiblk.
  1835     02  eibtime          pic s9(7) comp-3.
  1836     02  eibdate          pic s9(7) comp-3.
  1837     02  eibtrnid         pic x(4).
  1838     02  eibtaskn         pic s9(7) comp-3.
  1839     02  eibtrmid         pic x(4).
  1840     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6312.cbl
  1841     02  eibcposn         pic s9(4) comp.
  1842     02  eibcalen         pic s9(4) comp.
  1843     02  eibaid           pic x(1).
  1844     02  eibfiller1       pic x(1).
  1845     02  eibfn            pic x(2).
  1846     02  eibfiller2       pic x(2).
  1847     02  eibrcode         pic x(6).
  1848     02  eibfiller3       pic x(2).
  1849     02  eibds            pic x(8).
  1850     02  eibreqid         pic x(8).
  1851     02  eibrsrce         pic x(8).
  1852     02  eibsync          pic x(1).
  1853     02  eibfree          pic x(1).
  1854     02  eibrecv          pic x(1).
  1855     02  eibsend          pic x(1).
  1856     02  eibatt           pic x(1).
  1857     02  eibeoc           pic x(1).
  1858     02  eibfmh           pic x(1).
  1859     02  eibcompl         pic x(1).
  1860     02  eibsig           pic x(1).
  1861     02  eibconf          pic x(1).
  1862     02  eiberr           pic x(1).
  1863     02  eibrldbk         pic x(1).
  1864     02  eiberrcd         pic x(4).
  1865     02  eibsynrb         pic x(1).
  1866     02  eibnodat         pic x(1).
  1867     02  eibfiller5       pic x(2).
  1868     02  eibresp          pic 9(09) comp.
  1869     02  eibresp2         pic 9(09) comp.
  1870     02  dfheigdj         pic s9(4) comp.
  1871     02  dfheigdk         pic s9(4) comp.
  1872 01  DFHCOMMAREA             PIC X(1300).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6312.cbl
  1874 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1875 0000-DFHEXIT SECTION.
  1876     MOVE '9#                    $   ' TO DFHEIV0.
  1877     MOVE 'EL6312' TO DFHEIV1.
  1878     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1879     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  1880     MOVE PI-CRITERIA-DATA       TO EDIT-CRITERIA-DATA.
  1881
  1882     IF EIBCALEN = 0
  1883         GO TO 8800-UNAUTHORIZED-ACCESS.
  1884
  1885     MOVE LOW-VALUES             TO EL631EI.
  1886
  1887     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1888         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1889             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1890             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1891             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1892             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1893             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1894             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1895             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1896             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1897             GO TO 0350-DISPLAY-COMMON-DATA.
  1898
  1899     IF EIBAID = DFHCLEAR
  1900         GO TO 9400-CLEAR.
  1901
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6312.cbl
  1903 0200-RECEIVE.
  1904     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1905         MOVE ER-0008            TO EMI-ERROR
  1906         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1907         MOVE -1                 TO PFENTERL
  1908         GO TO 8100-SEND-INITIAL-MAP.
  1909
  1910
  1911* EXEC CICS RECEIVE
  1912*        MAP      (MAP-NAME)
  1913*        MAPSET   (MAPSET-NAME)
  1914*        INTO     (EL631EI)
  1915*    END-EXEC.
  1916     MOVE LENGTH OF
  1917      EL631EI
  1918       TO DFHEIV11
  1919*    MOVE '8"T I  L              ''   #00001906' TO DFHEIV0
  1920     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1921     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1922     MOVE X'2020233030303031393036' TO DFHEIV0(25:11)
  1923     CALL 'kxdfhei1' USING DFHEIV0,
  1924           MAP-NAME,
  1925           EL631EI,
  1926           DFHEIV11,
  1927           MAPSET-NAME,
  1928           DFHEIV99,
  1929           DFHEIV99
  1930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1931
  1932
  1933     IF PFENTERL = 0
  1934         GO TO 0300-CHECK-PFKEYS.
  1935     IF EIBAID NOT = DFHENTER
  1936         MOVE ER-0004            TO EMI-ERROR
  1937         GO TO 0320-INPUT-ERROR.
  1938     IF (PFENTERI NUMERIC) AND (PFENTERI > 0 AND < 25)
  1939         MOVE PF-VALUES (PFENTERI) TO EIBAID
  1940     ELSE
  1941         MOVE ER-0029            TO EMI-ERROR
  1942         GO TO 0320-INPUT-ERROR.
  1943
  1944 0300-CHECK-PFKEYS.
  1945     IF EIBAID = DFHPF1
  1946        GO TO 0350-DISPLAY-COMMON-DATA.
  1947
  1948     IF EIBAID = DFHPF23
  1949         GO TO 8810-PF23.
  1950
  1951     IF EIBAID = DFHPF24
  1952         GO TO 9200-RETURN-MAIN-MENU.
  1953
  1954     IF EIBAID = DFHPF12
  1955         GO TO 9500-PF12.
  1956
  1957     IF EIBAID = DFHENTER
  1958         GO TO 8200-SEND-DATAONLY.
  1959
  1960     MOVE ER-0029                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6312.cbl
  1961 0320-INPUT-ERROR.
  1962     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1963     MOVE AL-UNBON               TO PFENTERA.
  1964     MOVE -1                     TO PFENTERL.
  1965     GO TO 8200-SEND-DATAONLY.
  1966
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6312.cbl
  1968 0350-DISPLAY-COMMON-DATA.
  1969     IF EC-CO-TOL-PREM    NUMERIC
  1970        IF EC-CO-TOL-PREM NOT = ZEROS
  1971           MOVE EC-CO-TOL-PREM      TO CISSTOLO.
  1972
  1973     IF EC-CO-TOL-REFUND  NUMERIC
  1974        IF EC-CO-TOL-REFUND NOT = ZEROS
  1975           MOVE EC-CO-TOL-REFUND    TO COVSAMTO.
  1976
  1977     IF EC-CO-OVR-SHT-AMT NUMERIC
  1978        IF EC-CO-OVR-SHT-AMT > +0
  1979           MOVE EC-CO-OVR-SHT-AMT   TO CCANTOLO.
  1980
  1981     IF EC-CO-MIN-AGE     NUMERIC
  1982        IF EC-CO-MIN-AGE  NOT = ZEROS
  1983           MOVE EC-CO-MIN-AGE       TO CMAGEO.
  1984
  1985     IF EC-CO-MIN-PREMIUM NUMERIC
  1986        IF EC-CO-MIN-PREMIUM NOT = ZEROS
  1987           MOVE EC-CO-MIN-PREMIUM   TO CMPREMO.
  1988
  1989     IF EC-CO-MIN-TERM    NUMERIC
  1990        IF EC-CO-MIN-TERM NOT = ZEROS
  1991           MOVE EC-CO-MIN-TERM      TO CMTERMO.
  1992
  1993     IF EC-CO-MAX-TERM    NUMERIC
  1994        IF EC-CO-MAX-TERM NOT = ZEROS
  1995           MOVE EC-CO-MAX-TERM      TO CMXTERMO.
  1996
  1997     IF EC-CO-REM-TERM-CALC   = '1'
  1998       MOVE 'AFTER 15TH'   TO CRTERMO
  1999      ELSE
  2000       IF EC-CO-REM-TERM-CALC   = '2'
  2001         MOVE 'FIRST HALF'   TO CRTERMO
  2002        ELSE
  2003         IF EC-CO-REM-TERM-CALC   = '3'
  2004           MOVE 'ON 1ST DAY'   TO CRTERMO
  2005          ELSE
  2006           IF EC-CO-REM-TERM-CALC   = '4'
  2007             MOVE 'ON LAST DAY'   TO CRTERMO
  2008            ELSE
  2009             IF EC-CO-REM-TERM-CALC   = '5'
  2010               MOVE 'NO DAYS'       TO CRTERMO
  2011              ELSE
  2012               IF EC-CO-REM-TERM-CALC   = '6'
  2013                 MOVE 'AFTER 14TH'    TO CRTERMO
  2014                ELSE
  2015                 IF EC-CO-REM-TERM-CALC   = '7'
  2016                   MOVE 'AFTER 16TH'    TO CRTERMO.
  2017
  2018     MOVE EC-CO-MONTH-END-DT     TO DC-BIN-DATE-1.
  2019     MOVE SPACE                  TO DC-OPTION-CODE.
  2020     PERFORM 9700-DATE-LINK.
  2021     IF NO-CONVERSION-ERROR
  2022        MOVE DC-GREG-DATE-1-EDIT TO CMENDO.
  2023
  2024      IF EIBTRNID  NOT = TRANS-ID
  2025         IF EC-BR-LF-DESC NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6312.cbl
  2026            GO TO 500-DISPLAY-LIFE.
  2027
  2028     IF PI-DISPLAY-AH
  2029        GO TO 500-DISPLAY-LIFE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6312.cbl
  2031 400-DISPLAY-AH.
  2032     MOVE 'AH'                   TO PI-DISPLAY-SW.
  2033     MOVE PI-AH-OVERRIDE-L6      TO HEADI.
  2034     MOVE PI-LIFE-OVERRIDE-L6    TO PFOPTI.
  2035
  2036     IF EC-BR-AH-EARN-BY-R78
  2037         MOVE 'RULE 78'           TO BEARNMO
  2038        ELSE
  2039         IF EC-BR-AH-EARN-BY-PRO-RATA
  2040             MOVE 'PRO-RATA'          TO BEARNMO
  2041           ELSE
  2042             IF EC-BR-AH-EARN-AS-CALIF
  2043                 MOVE 'CALIF'          TO BEARNMO
  2044              ELSE
  2045                 IF EC-BR-AH-EARN-IS-NET-PAY
  2046                    MOVE 'NET PAY'        TO BEARNMO
  2047                 ELSE
  2048                    IF EC-BR-AH-EARN-ANTICIPATION
  2049                       MOVE 'ANTICIPAT'      TO BEARNMO
  2050                    ELSE
  2051                       IF EC-BR-AH-EARN-MEAN
  2052                          MOVE 'MEAN'        TO BEARNMO
  2053                       ELSE
  2054                          IF EC-BR-AH-EARN-REG-BALLOON
  2055                             MOVE 'BALLOON'  TO BEARNMO.
  2056
  2057        IF EC-CF-AH-OUTSTANDING-BAL
  2058           MOVE 'OUT BAL'           TO BSPECO
  2059        ELSE
  2060           IF EC-CF-AH-CRITICAL-PERIOD
  2061              MOVE 'CRT PERIOD'    TO BSPECO.
  2062
  2063        EVALUATE TRUE
  2064           WHEN EC-BR-AH-REFD-BY-R78
  2065              MOVE 'RULE 78'           TO BRMETHO
  2066           WHEN EC-BR-AH-REFD-BY-PRO-RATA
  2067              MOVE 'PRO-RATA'          TO BRMETHO
  2068           WHEN EC-BR-AH-REFD-AS-CALIF
  2069              MOVE 'CALIFORNIA'        TO BRMETHO
  2070           WHEN EC-BR-AH-REFD-AS-TEXAS
  2071              MOVE 'IRREG'             TO BRMETHO
  2072           WHEN EC-BR-AH-REFD-IS-NET-PAY
  2073              MOVE 'NET PAY'        TO BRMETHO
  2074           WHEN EC-BR-AH-REFD-ANTICIPATION
  2075              MOVE 'ANTICIPAT'      TO BRMETHO
  2076           WHEN EC-BR-AH-REFD-IS-MEAN
  2077              MOVE 'MEAN'           TO BRMETHO
  2078           WHEN EC-BR-AH-REFD-SUM-OF-DIGIT
  2079              MOVE 'SUM DIGIT'      TO BRMETHO
  2080        END-EVALUATE.
  2081
  2082
  2083     MOVE EC-BR-AH-DESC          TO BTYPEO.
  2084     MOVE EC-BR-AH-COMMENT       TO BCOMMO.
  2085     MOVE EC-BR-AH-BEN-I-G-CD    TO BIGO.
  2086
  2087     IF EC-BR-AH-REM-TERM-CALC = '1'
  2088       MOVE 'AFTER 15TH'   TO BRTERMO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6312.cbl
  2089      ELSE
  2090       IF EC-BR-AH-REM-TERM-CALC = '2'
  2091         MOVE 'FIRST HALF'   TO BRTERMO
  2092        ELSE
  2093         IF EC-BR-AH-REM-TERM-CALC = '3'
  2094           MOVE 'ON 1ST DAY'   TO BRTERMO
  2095          ELSE
  2096           IF EC-BR-AH-REM-TERM-CALC = '4'
  2097             MOVE 'ON LAST DAY'   TO BRTERMO
  2098            ELSE
  2099             IF EC-BR-AH-REM-TERM-CALC = '5'
  2100               MOVE 'NO DAYS'       TO BRTERMO
  2101              ELSE
  2102               IF EC-BR-AH-REM-TERM-CALC = '6'
  2103                 MOVE 'AFTER 14TH'    TO BRTERMO
  2104                ELSE
  2105                 IF EC-BR-AH-REM-TERM-CALC = '7'
  2106                   MOVE 'AFTER 16TH'    TO BRTERMO.
  2107
  2108     IF EC-ST-TOL-PREM    NUMERIC
  2109        IF EC-ST-TOL-PREM NOT = ZEROS
  2110           MOVE EC-ST-TOL-PREM   TO SISSTOLO.
  2111
  2112     IF EC-ST-TOL-REFUND NUMERIC
  2113        IF EC-ST-TOL-REFUND NOT = ZEROS
  2114           MOVE EC-ST-TOL-REFUND TO SCANTOLO.
  2115
  2116     IF EC-ST-OVR-SHT-AMT NUMERIC
  2117        IF EC-ST-OVR-SHT-AMT >+ 0
  2118           MOVE EC-ST-OVR-SHT-AMT TO SOVSTOLO.
  2119
  2120     IF EC-ST-TOL-PREM-PCT NUMERIC
  2121        IF EC-ST-TOL-PREM-PCT GREATER THAN +0
  2122           MOVE EC-ST-TOL-PREM-PCT
  2123                                 TO SISSPCTO.
  2124
  2125     IF EC-ST-TOL-REFUND-PCT NUMERIC
  2126        IF EC-ST-TOL-REFUND-PCT GREATER THAN +0
  2127           MOVE EC-ST-TOL-REFUND-PCT
  2128                                 TO SCANPCTO.
  2129
  2130     IF EC-ST-OVR-SHT-PCT NUMERIC
  2131        IF EC-ST-OVR-SHT-PCT > +0
  2132           MOVE EC-ST-OVR-SHT-PCT TO SOVSPCTO.
  2133
  2134     IF EC-ST-AH-REM-TERM-CALC   = '1'
  2135       MOVE 'AFTER 15TH'   TO SRTERMO
  2136      ELSE
  2137       IF EC-ST-AH-REM-TERM-CALC   = '2'
  2138         MOVE 'FIRST HALF'   TO SRTERMO
  2139        ELSE
  2140         IF EC-ST-AH-REM-TERM-CALC   = '3'
  2141           MOVE 'ON 1ST DAY'     TO SRTERMO
  2142          ELSE
  2143           IF EC-ST-AH-REM-TERM-CALC   = '4'
  2144             MOVE 'ON LAST DAY'   TO SRTERMO
  2145            ELSE
  2146             IF EC-ST-AH-REM-TERM-CALC   = '5'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6312.cbl
  2147               MOVE 'NO DAYS'       TO SRTERMO
  2148              ELSE
  2149               IF EC-ST-AH-REM-TERM-CALC   = '6'
  2150                 MOVE 'AFTER 14TH'    TO SRTERMO
  2151                ELSE
  2152                 IF EC-ST-AH-REM-TERM-CALC   = '7'
  2153                   MOVE 'AFTER 16TH'    TO SRTERMO.
  2154
  2155     EVALUATE TRUE
  2156        WHEN EC-ST-AH-REFD-BY-R78
  2157           MOVE 'RULE 78'        TO SRMETHO
  2158        WHEN EC-ST-AH-REFD-BY-PRO-RATA
  2159           MOVE 'PRO-RATA'       TO SRMETHO
  2160        WHEN EC-ST-AH-REFD-AS-CALIF
  2161           MOVE 'CALIFORNIA'     TO SRMETHO
  2162        WHEN EC-ST-AH-REFD-AS-TEXAS
  2163           MOVE 'IRREG'          TO SRMETHO
  2164        WHEN EC-ST-AH-REFD-IS-NET-PAY
  2165           MOVE 'NET PAY'        TO SRMETHO
  2166        WHEN EC-ST-AH-REFD-ANTICIPATION
  2167           MOVE 'ANTICIPAT'      TO SRMETHO
  2168        WHEN EC-ST-AH-REFD-IS-MEAN
  2169           MOVE 'MEAN'           TO SRMETHO
  2170        WHEN EC-ST-AH-REFD-SUM-OF-DIGIT
  2171           MOVE 'SUM DIGIT'      TO SRMETHO
  2172     END-EVALUATE.
  2173
  2174     IF EC-AM-AH-TOL-PREM    NUMERIC
  2175        IF EC-AM-AH-TOL-PREM NOT = ZEROS
  2176           MOVE EC-AM-AH-TOL-PREM   TO AISSTOLO.
  2177
  2178     IF EC-AM-AH-TOL-REFUND  NUMERIC
  2179        IF EC-AM-AH-TOL-REFUND NOT = ZEROS
  2180           MOVE EC-AM-AH-TOL-REFUND TO ACANTOLO.
  2181
  2182     IF EC-AM-AH-OVR-SHT-AMT NUMERIC
  2183        IF EC-AM-AH-OVR-SHT-AMT > +0
  2184           MOVE EC-AM-AH-OVR-SHT-AMT TO AOVSTOLO.
  2185
  2186     EVALUATE TRUE
  2187        WHEN EC-AM-AH-REFD-BY-R78
  2188           MOVE 'RULE 78'           TO ARMETHO
  2189        WHEN EC-AM-AH-REFD-BY-PRO-RATA
  2190           MOVE 'PRO-RATA'          TO ARMETHO
  2191        WHEN EC-AM-AH-REFD-AS-CALIF
  2192           MOVE 'CALIFORNIA'        TO ARMETHO
  2193        WHEN EC-AM-AH-REFD-ANTICIPATION
  2194           MOVE 'ANTICIPAT'      TO ARMETHO
  2195        WHEN EC-AM-AH-REFD-IS-MEAN
  2196           MOVE 'MEAN'           TO ARMETHO
  2197        WHEN EC-AM-AH-REFD-IS-NET
  2198          MOVE 'NET PAY'        TO ARMETHO
  2199        WHEN EC-AM-AH-REFD-SUM-OF-DIGIT
  2200           MOVE 'SUM DIGIT'      TO ARMETHO
  2201     END-EVALUATE.
  2202
  2203     MOVE EC-AM-BEN-I-G-CD       TO AIGO.
  2204     MOVE EC-AM-CLASS-CD         TO ACLASSO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6312.cbl
  2205     MOVE EC-AM-AH-DEVIATION     TO ADEVO.
  2206     MOVE EC-AM-PHONE-NO         TO WS-PHONE.
  2207     MOVE WS-PHONE-NUM           TO PHONEO.
  2208     INSPECT PHONEO REPLACING ALL ' ' BY '-'.
  2209
  2210     IF EC-AM-AH-DEV-PERCENT NUMERIC
  2211        IF  EC-AM-AH-DEV-PERCENT > +0
  2212            MOVE EC-AM-AH-DEV-PERCENT   TO ADEVPCTO.
  2213
  2214     IF EC-AM-EXPIRATION-DT NOT = HIGH-VALUES
  2215        MOVE EC-AM-EXPIRATION-DT    TO DC-BIN-DATE-1
  2216        MOVE SPACE                  TO DC-OPTION-CODE
  2217        PERFORM 9700-DATE-LINK
  2218        IF NO-CONVERSION-ERROR
  2219           MOVE DC-GREG-DATE-1-EDIT TO AEXPDTEO
  2220          ELSE
  2221           NEXT SENTENCE
  2222        ELSE
  2223         MOVE '99/99/99'          TO AEXPDTEO.
  2224
  2225     MOVE EC-AM-EFFECTIVE-DT     TO DC-BIN-DATE-1.
  2226     MOVE SPACE                  TO DC-OPTION-CODE.
  2227     PERFORM 9700-DATE-LINK.
  2228     IF NO-CONVERSION-ERROR
  2229        MOVE DC-GREG-DATE-1-EDIT TO AEFFDTO.
  2230
  2231     IF EC-AM-AH-MAX-ATT-AGE  NUMERIC
  2232        IF EC-AM-AH-MAX-ATT-AGE NOT = ZEROS
  2233           MOVE EC-AM-AH-MAX-ATT-AGE  TO AMAAGEO.
  2234
  2235     IF EC-AM-AH-MAX-AGE  NUMERIC
  2236        IF EC-AM-AH-MAX-AGE NOT = ZEROS
  2237           MOVE EC-AM-AH-MAX-AGE      TO AMAGEO.
  2238
  2239     IF EC-AM-AH-MAX-TERM   NUMERIC
  2240        IF EC-AM-AH-MAX-TERM NOT = ZEROS
  2241           MOVE EC-AM-AH-MAX-TERM   TO AMTERMO.
  2242
  2243     IF EC-AM-AH-MAX-TOT-BEN NUMERIC
  2244        IF EC-AM-AH-MAX-TOT-BEN NOT = ZEROS
  2245           MOVE EC-AM-AH-MAX-TOT-BEN  TO AMTBENO.
  2246
  2247     IF EC-AM-AH-MAX-MON-BEN NUMERIC
  2248        IF EC-AM-AH-MAX-MON-BEN NOT = ZEROS
  2249           MOVE EC-AM-AH-MAX-MON-BEN  TO AMMBENO
  2250           MOVE 'MAX-MON-BEN'         TO AHEADMO.
  2251
  2252     IF EC-RT-AH-MAX-ATT-AGE  NUMERIC
  2253        IF EC-RT-AH-MAX-ATT-AGE NOT = ZEROS
  2254           MOVE EC-RT-AH-MAX-ATT-AGE  TO RMAAGEO.
  2255
  2256     IF EC-RT-AH-MAX-AGE  NUMERIC
  2257        IF EC-RT-AH-MAX-AGE NOT = ZEROS
  2258           MOVE EC-RT-AH-MAX-AGE      TO RMAGEO.
  2259
  2260     IF EC-RT-AH-MAX-TERM   NUMERIC
  2261        IF EC-RT-AH-MAX-TERM NOT = ZEROS
  2262           MOVE EC-RT-AH-MAX-TERM   TO RMTERMO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6312.cbl
  2263
  2264     IF EC-RT-AH-MAX-TOT-BEN NUMERIC
  2265        IF EC-RT-AH-MAX-TOT-BEN NOT = ZEROS
  2266           MOVE EC-RT-AH-MAX-TOT-BEN  TO RMTBENO.
  2267
  2268     IF EC-RT-AH-MAX-MON-BEN NUMERIC
  2269        IF EC-RT-AH-MAX-MON-BEN NOT = ZEROS
  2270           MOVE EC-RT-AH-MAX-MON-BEN  TO RMMBENO.
  2271
  2272     IF EC-RT-AH-RATE   NUMERIC
  2273         IF EC-CF-AH-OUTSTANDING-BAL
  2274             MOVE ZEROS           TO RRATESO
  2275             MOVE EC-RT-AH-RATE   TO OBRATEO
  2276             MOVE ' OB RATE'      TO OBHEADO
  2277         ELSE
  2278             MOVE EC-RT-AH-RATE   TO RRATESO
  2279             COMPUTE WS-DEV-RT = EC-RT-AH-RATE *
  2280                                 EC-AM-AH-DEV-PERCENT
  2281             MOVE WS-DEV-RT       TO DRATESO.
  2282
  2283     MOVE EC-RT-AH-NSP-ST        TO RNSPSTO.
  2284
  2285     IF EC-RT-AH-NSP-ST NOT = SPACES
  2286        IF EC-RT-AH-NSP-RATE   NUMERIC
  2287           MOVE EC-RT-AH-NSP-RATE       TO RNSPRTO.
  2288
  2289     IF EC-CM-AH-POLICY-IS-ACTIVE
  2290        MOVE 'ACTIVE'            TO CTSTO
  2291        ELSE
  2292        IF EC-CM-AH-LUMP-SUM-DISAB
  2293           MOVE 'LUMP SUM'    TO CTSTO
  2294           ELSE
  2295           IF EC-CM-AH-DEATH-CLAIM-APPLIED
  2296              MOVE 'DEATH'    TO CTSTO  CTDATEHO
  2297              MOVE 'DEATH-DT' TO CTDATEHO
  2298              ELSE
  2299              IF EC-CM-AH-CANCEL-APPLIED
  2300                 MOVE 'CANCELLED'   TO CTSTO  CTDATEHO
  2301                 MOVE 'CANCEL-DT'   TO CTDATEHO.
  2302
  2303     IF EC-CM-AH-PRIOR-REFUND  NUMERIC
  2304        IF EC-CM-AH-PRIOR-REFUND  NOT = ZEROS
  2305           MOVE EC-CM-AH-PRIOR-REFUND    TO CTRFUNDO.
  2306
  2307     IF EC-CM-AH-DEATH-CLAIM-APPLIED
  2308        MOVE EC-CM-DEATH-DT         TO DC-BIN-DATE-1
  2309        MOVE SPACE                  TO DC-OPTION-CODE
  2310        PERFORM 9700-DATE-LINK
  2311        IF NO-CONVERSION-ERROR
  2312           MOVE DC-GREG-DATE-1-EDIT TO CTDATEO.
  2313
  2314     IF EC-CM-AH-CANCEL-APPLIED
  2315        MOVE EC-CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
  2316        MOVE SPACE                  TO DC-OPTION-CODE
  2317        PERFORM 9700-DATE-LINK
  2318        IF NO-CONVERSION-ERROR
  2319           MOVE DC-GREG-DATE-1-EDIT TO CTDATEO.
  2320     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6312.cbl
  2322 500-DISPLAY-LIFE.
  2323     MOVE 'LF'                   TO PI-DISPLAY-SW
  2324     MOVE PI-LIFE-OVERRIDE-L6    TO HEADI
  2325     MOVE PI-AH-OVERRIDE-L6      TO PFOPTI.
  2326
  2327     EVALUATE TRUE
  2328        WHEN EC-BR-LF-EARN-BY-R78
  2329           MOVE 'RULE 78'           TO BEARNMO
  2330        WHEN EC-BR-LF-EARN-BY-PRO-RATA
  2331           MOVE 'PRO-RATA'          TO BEARNMO
  2332        WHEN EC-BR-LF-EARN-AS-TEXAS
  2333           MOVE 'IRREG'             TO BEARNMO
  2334        WHEN EC-BR-LF-EARN-AS-FARM-PLAN
  2335           MOVE 'FARM'              TO BEARNMO
  2336        WHEN EC-BR-LF-EARN-IS-NET-PAY
  2337           MOVE 'NET PAY'           TO BEARNMO
  2338        WHEN EC-BR-LF-EARN-ANTICIPATION
  2339           MOVE 'ANTICIPAT'         TO BEARNMO
  2340        WHEN EC-BR-LF-EARN-MEAN
  2341           MOVE 'MEAN'              TO BEARNMO
  2342        WHEN EC-BR-LF-EARN-REG-BALLOON
  2343           MOVE 'BALLOON'           TO BEARNMO
  2344        WHEN EC-BR-LF-EARN-SUM-OF-DIGIT
  2345           MOVE 'SUM DIGIT'         TO BEARNMO
  2346        WHEN OTHER
  2347           MOVE SPACES              TO BEARNMO
  2348     END-EVALUATE.
  2349
  2350        IF EC-CF-LF-OUTSTANDING-BAL
  2351           MOVE 'OUT BAL'           TO BSPECO
  2352         ELSE
  2353           IF EC-CF-LF-ALTERNATE-NET-PAY
  2354              MOVE 'ALT NET PY'        TO BSPECO
  2355           ELSE
  2356              IF EC-CF-LF-NET-PAY-SIMPLE
  2357                    MOVE 'NET PAY'           TO BSPECO
  2358               ELSE
  2359                 IF EC-CF-LF-CRITICAL-PERIOD
  2360                    MOVE 'CRT PERIOD'    TO BSPECO
  2361                 ELSE
  2362                       IF EC-CF-LF-TERM-IN-DAYS
  2363                          MOVE 'TRM IN DAY'    TO BSPECO.
  2364
  2365     EVALUATE TRUE
  2366        WHEN EC-BR-LF-REFD-BY-R78
  2367           MOVE 'RULE 78'        TO BRMETHO
  2368        WHEN EC-BR-LF-REFD-BY-PRO-RATA
  2369           MOVE 'PRO-RATA'       TO BRMETHO
  2370        WHEN EC-BR-LF-REFD-AS-TEXAS
  2371           MOVE 'IRREG'          TO BRMETHO
  2372        WHEN EC-BR-LF-REFD-IS-NET-PAY
  2373           MOVE 'NET PAY'        TO BRMETHO
  2374        WHEN EC-BR-LF-REFD-ANTICIPATION
  2375           MOVE 'ANTICIPAT'      TO BRMETHO
  2376        WHEN EC-BR-LF-REFD-IS-MEAN
  2377           MOVE 'MEAN'           TO BRMETHO
  2378        WHEN EC-BR-LF-REFD-IS-SUM-OF-DIGIT
  2379           MOVE 'SUM DIGIT'      TO BRMETHO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6312.cbl
  2380        WHEN OTHER
  2381           MOVE SPACES           TO BRMETHO
  2382     END-EVALUATE.
  2383
  2384     MOVE EC-BR-LF-DESC          TO BTYPEO.
  2385     MOVE EC-BR-LF-COMMENT       TO BCOMMO.
  2386     MOVE EC-BR-LF-BEN-I-G-CD    TO BIGO.
  2387
  2388     IF EC-BR-LF-REM-TERM-CALC = '1'
  2389       MOVE 'AFTER 15TH'   TO BRTERMO
  2390      ELSE
  2391       IF EC-BR-LF-REM-TERM-CALC = '2'
  2392         MOVE 'FIRST HALF'   TO BRTERMO
  2393        ELSE
  2394         IF EC-BR-LF-REM-TERM-CALC = '3'
  2395           MOVE 'ON 1ST DAY'   TO BRTERMO
  2396          ELSE
  2397           IF EC-BR-LF-REM-TERM-CALC = '4'
  2398             MOVE 'ON LAST DAY'   TO BRTERMO
  2399            ELSE
  2400             IF EC-BR-LF-REM-TERM-CALC = '5'
  2401               MOVE 'NO DAYS'       TO BRTERMO
  2402              ELSE
  2403              IF EC-BR-LF-REM-TERM-CALC = '6'
  2404                MOVE 'AFTER 14TH'    TO BRTERMO
  2405               ELSE
  2406                IF EC-BR-LF-REM-TERM-CALC = '7'
  2407                  MOVE 'AFTER 16TH'    TO BRTERMO.
  2408
  2409     IF EC-ST-TOL-PREM    NUMERIC
  2410        IF EC-ST-TOL-PREM NOT = ZEROS
  2411           MOVE EC-ST-TOL-PREM      TO SISSTOLO.
  2412
  2413     IF EC-ST-OVR-SHT-AMT NUMERIC
  2414        IF EC-ST-OVR-SHT-AMT > +0
  2415           MOVE EC-ST-OVR-SHT-AMT   TO SOVSTOLO.
  2416
  2417     IF EC-ST-TOL-REFUND  NUMERIC
  2418        IF EC-ST-TOL-REFUND  NOT = ZEROS
  2419           MOVE EC-ST-TOL-REFUND    TO SCANTOLO.
  2420
  2421     IF EC-ST-TOL-PREM-PCT NUMERIC
  2422        IF EC-ST-TOL-PREM-PCT GREATER THAN +0
  2423           MOVE EC-ST-TOL-PREM-PCT
  2424                                 TO SISSPCTO.
  2425
  2426     IF EC-ST-TOL-REFUND-PCT NUMERIC
  2427        IF EC-ST-TOL-REFUND-PCT GREATER THAN +0
  2428           MOVE EC-ST-TOL-REFUND-PCT
  2429                                 TO SCANPCTO.
  2430
  2431     IF EC-ST-OVR-SHT-PCT NUMERIC
  2432        IF EC-ST-OVR-SHT-PCT > +0
  2433           MOVE EC-ST-OVR-SHT-PCT TO SOVSPCTO.
  2434
  2435     IF EC-ST-LF-REM-TERM-CALC   = '1'
  2436       MOVE 'AFTER 15TH'   TO SRTERMO
  2437      ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6312.cbl
  2438       IF EC-ST-LF-REM-TERM-CALC   = '2'
  2439         MOVE 'FIRST HALF'   TO SRTERMO
  2440        ELSE
  2441         IF EC-ST-LF-REM-TERM-CALC   = '3'
  2442           MOVE 'ON 1ST DAY'     TO SRTERMO
  2443          ELSE
  2444           IF EC-ST-LF-REM-TERM-CALC   = '4'
  2445             MOVE 'ON LAST DAY'   TO SRTERMO
  2446          ELSE
  2447           IF EC-ST-LF-REM-TERM-CALC   = '5'
  2448             MOVE 'NO DAYS'       TO SRTERMO
  2449          ELSE
  2450           IF EC-ST-LF-REM-TERM-CALC   = '6'
  2451             MOVE 'AFTER 14TH'    TO SRTERMO
  2452          ELSE
  2453           IF EC-ST-LF-REM-TERM-CALC   = '7'
  2454             MOVE 'AFTER 16TH'    TO SRTERMO.
  2455
  2456     EVALUATE TRUE
  2457        WHEN EC-ST-LF-REFD-BY-R78
  2458           MOVE 'RULE 78'           TO SRMETHO
  2459        WHEN EC-ST-LF-REFD-BY-PRO-RATA
  2460           MOVE 'PRO-RATA'          TO SRMETHO
  2461        WHEN EC-ST-LF-REFD-AS-CALIF
  2462           MOVE 'CALIFORNIA'        TO SRMETHO
  2463        WHEN EC-ST-LF-REFD-AS-TEXAS
  2464           MOVE 'IRREG'             TO SRMETHO
  2465        WHEN EC-ST-LF-REFD-IS-NET-PAY
  2466           MOVE 'NET PAY'           TO SRMETHO
  2467        WHEN EC-ST-LF-REFD-ANTICIPATION
  2468           MOVE 'ANTICIPAT'         TO SRMETHO
  2469        WHEN EC-ST-LF-REFD-IS-MEAN
  2470           MOVE 'MEAN'              TO SRMETHO
  2471        WHEN EC-ST-LF-REFD-IS-SUM-OF-DIGIT
  2472           MOVE 'SUM DIGIT'         TO SRMETHO
  2473        WHEN OTHER
  2474           MOVE SPACES              TO SRMETHO
  2475     END-EVALUATE.
  2476
  2477     IF EC-AM-LF-TOL-PREM    NUMERIC
  2478        IF EC-AM-LF-TOL-PREM  NOT = ZEROS
  2479           MOVE EC-AM-LF-TOL-PREM   TO AISSTOLO.
  2480
  2481     IF EC-AM-LF-TOL-REFUND  NUMERIC
  2482        IF EC-AM-LF-TOL-REFUND  NOT = ZEROS
  2483           MOVE EC-AM-LF-TOL-REFUND TO ACANTOLO.
  2484
  2485     IF EC-AM-LF-OVR-SHT-AMT NUMERIC
  2486        IF EC-AM-LF-OVR-SHT-AMT > +0
  2487           MOVE EC-AM-LF-OVR-SHT-AMT TO AOVSTOLO.
  2488
  2489     EVALUATE TRUE
  2490        WHEN EC-AM-LF-REFD-BY-R78
  2491           MOVE 'RULE 78'        TO ARMETHO
  2492        WHEN EC-AM-LF-REFD-BY-PRO-RATA
  2493           MOVE 'PRO-RATA'       TO ARMETHO
  2494        WHEN EC-AM-LF-REFD-AS-TEXAS
  2495           MOVE 'IRREG'          TO ARMETHO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL6312.cbl
  2496        WHEN EC-AM-LF-REFD-IS-NET-PAY
  2497           MOVE 'NET PAY'        TO ARMETHO
  2498        WHEN EC-AM-LF-REFD-ANTICIPATION
  2499           MOVE 'ANTICIPAT'      TO ARMETHO
  2500        WHEN EC-AM-LF-REFD-IS-MEAN
  2501           MOVE 'MEAN'           TO ARMETHO
  2502        WHEN EC-AM-LF-REFD-IS-SUM-OF-DIGIT
  2503           MOVE 'SUM DIGIT'      TO ARMETHO
  2504        WHEN OTHER
  2505           MOVE SPACES           TO ARMETHO
  2506     END-EVALUATE.
  2507
  2508     MOVE EC-AM-BEN-I-G-CD       TO AIGO.
  2509     MOVE EC-AM-CLASS-CD         TO ACLASSO.
  2510     MOVE EC-AM-LF-DEVIATION     TO ADEVO.
  2511     MOVE EC-AM-LF-DEV-PERCENT   TO ADEVPCTO.
  2512     MOVE EC-AM-PHONE-NO         TO WS-PHONE.
  2513     MOVE WS-PHONE-NUM           TO PHONEO.
  2514     INSPECT PHONEO CONVERTING ' ' TO '-'.
  2515
  2516     IF EC-AM-EXPIRATION-DT NOT = HIGH-VALUES
  2517        MOVE EC-AM-EXPIRATION-DT    TO DC-BIN-DATE-1
  2518        MOVE SPACE                  TO DC-OPTION-CODE
  2519        PERFORM 9700-DATE-LINK
  2520        IF NO-CONVERSION-ERROR
  2521           MOVE DC-GREG-DATE-1-EDIT TO AEXPDTEO
  2522           ELSE
  2523           NEXT SENTENCE
  2524        ELSE
  2525        MOVE '99/99/99'          TO AEXPDTEO.
  2526
  2527     MOVE EC-AM-EFFECTIVE-DT     TO DC-BIN-DATE-1.
  2528     MOVE SPACE                  TO DC-OPTION-CODE.
  2529     PERFORM 9700-DATE-LINK.
  2530     IF NO-CONVERSION-ERROR
  2531        MOVE DC-GREG-DATE-1-EDIT TO AEFFDTO.
  2532
  2533     IF EC-AM-LF-MAX-ATT-AGE  NUMERIC
  2534        IF EC-AM-LF-MAX-ATT-AGE  NOT = ZEROS
  2535           MOVE EC-AM-LF-MAX-ATT-AGE  TO AMAAGEO.
  2536
  2537     IF EC-AM-LF-MAX-AGE  NUMERIC
  2538        IF EC-AM-LF-MAX-AGE  NOT = ZEROS
  2539           MOVE EC-AM-LF-MAX-AGE      TO AMAGEO.
  2540
  2541     IF EC-AM-LF-MAX-TERM   NUMERIC
  2542        IF EC-AM-LF-MAX-TERM  NOT = ZEROS
  2543           MOVE EC-AM-LF-MAX-TERM   TO AMTERMO.
  2544
  2545     IF EC-AM-LF-MAX-TOT-BEN NUMERIC
  2546        IF EC-AM-LF-MAX-TOT-BEN  NOT = ZEROS
  2547           MOVE EC-AM-LF-MAX-TOT-BEN  TO AMTBENO.
  2548
  2549     IF EC-RT-LF-MAX-ATT-AGE  NUMERIC
  2550        IF EC-RT-LF-MAX-ATT-AGE  NOT = ZEROS
  2551           MOVE EC-RT-LF-MAX-ATT-AGE  TO RMAAGEO.
  2552
  2553     IF EC-RT-LF-MAX-AGE  NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL6312.cbl
  2554        IF EC-RT-LF-MAX-AGE  NOT = ZEROS
  2555           MOVE EC-RT-LF-MAX-AGE      TO RMAGEO.
  2556
  2557     IF EC-RT-LF-MAX-TERM   NUMERIC
  2558        IF EC-RT-LF-MAX-TERM NOT = ZEROS
  2559           MOVE EC-RT-LF-MAX-TERM   TO RMTERMO.
  2560
  2561     IF EC-RT-LF-MAX-TOT-BEN NUMERIC
  2562        IF EC-RT-LF-MAX-TOT-BEN NOT = ZEROS
  2563           MOVE EC-RT-LF-MAX-TOT-BEN  TO RMTBENO.
  2564
  2565     IF EC-RT-LF-RATE   NUMERIC
  2566         IF  EC-CF-LF-OUTSTANDING-BAL
  2567             MOVE ZEROS           TO RRATESO
  2568             MOVE EC-RT-LF-RATE   TO OBRATEO
  2569             MOVE ' OB RATE'      TO OBHEADO
  2570         ELSE
  2571             MOVE EC-RT-LF-RATE   TO RRATESO
  2572             COMPUTE WS-DEV-RT = EC-RT-LF-RATE *
  2573                                 EC-AM-LF-DEV-PERCENT
  2574             MOVE WS-DEV-RT       TO DRATESO.
  2575
  2576     MOVE EC-RT-LF-NSP-ST        TO RNSPSTO.
  2577
  2578     IF EC-RT-LF-NSP-ST NOT = SPACES
  2579        IF EC-RT-LF-NSP-RATE   NUMERIC
  2580           MOVE EC-RT-LF-NSP-RATE       TO RNSPRTO.
  2581
  2582     IF EC-CM-LF-POLICY-IS-ACTIVE
  2583        MOVE 'ACTIVE'            TO CTSTO
  2584        ELSE
  2585        IF EC-CM-LF-LUMP-SUM-DISAB
  2586           MOVE 'LUMP SUM'    TO CTSTO
  2587           ELSE
  2588           IF EC-CM-LF-DEATH-CLAIM-APPLIED
  2589              MOVE 'DEATH'    TO CTSTO
  2590              MOVE 'DEATH-DT' TO CTDATEHO
  2591              ELSE
  2592              IF EC-CM-LF-CANCEL-APPLIED
  2593                 MOVE 'CANCELLED'   TO CTSTO
  2594                 MOVE 'CANCEL-DT'   TO CTDATEHO.
  2595
  2596     IF EC-CM-LF-PRIOR-REFUND  NUMERIC
  2597        IF EC-CM-LF-PRIOR-REFUND NOT = ZEROS
  2598           MOVE EC-CM-LF-PRIOR-REFUND    TO CTRFUNDO.
  2599
  2600     IF EC-CM-LF-DEATH-CLAIM-APPLIED
  2601        MOVE EC-CM-DEATH-DT         TO DC-BIN-DATE-1
  2602        MOVE SPACE                  TO DC-OPTION-CODE
  2603        PERFORM 9700-DATE-LINK
  2604        IF NO-CONVERSION-ERROR
  2605           MOVE DC-GREG-DATE-1-EDIT TO CTDATEO.
  2606
  2607     IF EC-CM-LF-CANCEL-APPLIED
  2608        MOVE EC-CM-LF-CANCEL-DT     TO DC-BIN-DATE-1
  2609        MOVE SPACE                  TO DC-OPTION-CODE
  2610        PERFORM 9700-DATE-LINK
  2611        IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL6312.cbl
  2612           MOVE DC-GREG-DATE-1-EDIT TO CTDATEO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL6312.cbl
  2614 8100-SEND-INITIAL-MAP.
  2615     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  2616     MOVE '5'                   TO DC-OPTION-CODE.
  2617     PERFORM 9700-DATE-LINK.
  2618     MOVE DC-GREG-DATE-1-EDIT   TO  DATEO.
  2619     MOVE EIBTIME                TO TIME-IN.
  2620     MOVE TIME-OUT               TO TIMEO.
  2621     MOVE -1                     TO PFENTERL
  2622     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  2623
  2624* EXEC CICS SEND
  2625*        MAP      (MAP-NAME)
  2626*        MAPSET   (MAPSET-NAME)
  2627*        FROM     (EL631EO)
  2628*        ERASE
  2629*        CURSOR
  2630*    END-EXEC.
  2631     MOVE LENGTH OF
  2632      EL631EO
  2633       TO DFHEIV12
  2634     MOVE -1
  2635       TO DFHEIV11
  2636*    MOVE '8$     CT  E    H L F ,   #00002602' TO DFHEIV0
  2637     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2638     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2639     MOVE X'2020233030303032363032' TO DFHEIV0(25:11)
  2640     CALL 'kxdfhei1' USING DFHEIV0,
  2641           MAP-NAME,
  2642           EL631EO,
  2643           DFHEIV12,
  2644           MAPSET-NAME,
  2645           DFHEIV99,
  2646           DFHEIV99,
  2647           DFHEIV99,
  2648           DFHEIV11,
  2649           DFHEIV99,
  2650           DFHEIV99,
  2651           DFHEIV99
  2652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2653
  2654
  2655     GO TO 9100-RETURN-TRAN.
  2656
  2657 8200-SEND-DATAONLY.
  2658     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  2659     MOVE '5'                   TO DC-OPTION-CODE.
  2660     PERFORM 9700-DATE-LINK.
  2661     MOVE DC-GREG-DATE-1-EDIT   TO  DATEO.
  2662     MOVE EIBTIME                TO TIME-IN.
  2663     MOVE TIME-OUT               TO TIMEO.
  2664     MOVE -1                     TO PFENTERL
  2665     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  2666
  2667* EXEC CICS SEND
  2668*        MAP      (MAP-NAME)
  2669*        MAPSET   (MAPSET-NAME)
  2670*        FROM     (EL631EO)
  2671*        DATAONLY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL6312.cbl
  2672*        ERASEAUP
  2673*        CURSOR
  2674*    END-EXEC.
  2675     MOVE LENGTH OF
  2676      EL631EO
  2677       TO DFHEIV12
  2678     MOVE -1
  2679       TO DFHEIV11
  2680*    MOVE '8$D    CT  A    H L F ,   #00002621' TO DFHEIV0
  2681     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  2682     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2683     MOVE X'2020233030303032363231' TO DFHEIV0(25:11)
  2684     CALL 'kxdfhei1' USING DFHEIV0,
  2685           MAP-NAME,
  2686           EL631EO,
  2687           DFHEIV12,
  2688           MAPSET-NAME,
  2689           DFHEIV99,
  2690           DFHEIV99,
  2691           DFHEIV99,
  2692           DFHEIV11,
  2693           DFHEIV99,
  2694           DFHEIV99,
  2695           DFHEIV99
  2696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2697
  2698
  2699     GO TO 9100-RETURN-TRAN.
  2700
  2701 8300-SEND-TEXT.
  2702
  2703* EXEC CICS SEND TEXT
  2704*        FROM     (LOGOFF-TEXT)
  2705*        LENGTH   (LOGOFF-LENGTH)
  2706*        ERASE
  2707*        FREEKB
  2708*    END-EXEC.
  2709*    MOVE '8&      T  E F  H   F -   #00002633' TO DFHEIV0
  2710     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2711     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2712     MOVE X'2020233030303032363333' TO DFHEIV0(25:11)
  2713     CALL 'kxdfhei1' USING DFHEIV0,
  2714           LOGOFF-TEXT,
  2715           LOGOFF-LENGTH,
  2716           DFHEIV99,
  2717           DFHEIV99,
  2718           DFHEIV99,
  2719           DFHEIV99,
  2720           DFHEIV99,
  2721           DFHEIV99,
  2722           DFHEIV99,
  2723           DFHEIV99,
  2724           DFHEIV99,
  2725           DFHEIV99
  2726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2727
  2728
  2729
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL6312.cbl
  2730* EXEC CICS RETURN
  2731*    END-EXEC.
  2732*    MOVE '.(                    &   #00002640' TO DFHEIV0
  2733     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2734     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2735     MOVE X'2020233030303032363430' TO DFHEIV0(25:11)
  2736     CALL 'kxdfhei1' USING DFHEIV0,
  2737           DFHEIV99,
  2738           DFHEIV99,
  2739           DFHEIV99,
  2740           DFHEIV99,
  2741           DFHEIV99
  2742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2743
  2744
  2745 8800-UNAUTHORIZED-ACCESS.
  2746     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  2747     GO TO 8300-SEND-TEXT.
  2748
  2749 8810-PF23.
  2750     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  2751     MOVE XCTL-005               TO PGM-NAME.
  2752     GO TO 9300-XCTL.
  2753 9000-RETURN-CICS.
  2754
  2755* EXEC CICS RETURN
  2756*    END-EXEC.
  2757*    MOVE '.(                    &   #00002652' TO DFHEIV0
  2758     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2759     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2760     MOVE X'2020233030303032363532' TO DFHEIV0(25:11)
  2761     CALL 'kxdfhei1' USING DFHEIV0,
  2762           DFHEIV99,
  2763           DFHEIV99,
  2764           DFHEIV99,
  2765           DFHEIV99,
  2766           DFHEIV99
  2767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2768
  2769
  2770 9100-RETURN-TRAN.
  2771     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  2772     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  2773
  2774
  2775* EXEC CICS RETURN
  2776*        TRANSID    (TRANS-ID)
  2777*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2778*        LENGTH     (1300)
  2779*    END-EXEC.
  2780     MOVE 1300
  2781       TO DFHEIV11
  2782*    MOVE '.(CT                  &   #00002659' TO DFHEIV0
  2783     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2784     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2785     MOVE X'2020233030303032363539' TO DFHEIV0(25:11)
  2786     CALL 'kxdfhei1' USING DFHEIV0,
  2787           TRANS-ID,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL6312.cbl
  2788           PROGRAM-INTERFACE-BLOCK,
  2789           DFHEIV11,
  2790           DFHEIV99,
  2791           DFHEIV99
  2792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2793
  2794
  2795 9200-RETURN-MAIN-MENU.
  2796     MOVE XCTL-626               TO PGM-NAME.
  2797     GO TO 9300-XCTL.
  2798
  2799 9300-XCTL.
  2800
  2801* EXEC CICS XCTL
  2802*        PROGRAM    (PGM-NAME)
  2803*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2804*        LENGTH     (1300)
  2805*    END-EXEC.
  2806     MOVE 1300
  2807       TO DFHEIV11
  2808*    MOVE '.$C                   $   #00002670' TO DFHEIV0
  2809     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2810     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2811     MOVE X'2020233030303032363730' TO DFHEIV0(25:11)
  2812     CALL 'kxdfhei1' USING DFHEIV0,
  2813           PGM-NAME,
  2814           PROGRAM-INTERFACE-BLOCK,
  2815           DFHEIV11
  2816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2817
  2818
  2819 9400-CLEAR.
  2820     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  2821
  2822
  2823* EXEC CICS XCTL
  2824*        PROGRAM    (PGM-NAME)
  2825*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2826*        LENGTH     (1300)
  2827*    END-EXEC.
  2828     MOVE 1300
  2829       TO DFHEIV11
  2830*    MOVE '.$C                   $   #00002679' TO DFHEIV0
  2831     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2832     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2833     MOVE X'2020233030303032363739' TO DFHEIV0(25:11)
  2834     CALL 'kxdfhei1' USING DFHEIV0,
  2835           PGM-NAME,
  2836           PROGRAM-INTERFACE-BLOCK,
  2837           DFHEIV11
  2838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2839
  2840
  2841 9500-PF12.
  2842     MOVE XCTL-010               TO PGM-NAME.
  2843     GO TO 9300-XCTL.
  2844
  2845 9600-PGMID-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL6312.cbl
  2846
  2847* EXEC CICS HANDLE CONDITION
  2848*        PGMIDERR    (8300-SEND-TEXT)
  2849*    END-EXEC.
  2850*    MOVE '"$L                   ! " #00002690' TO DFHEIV0
  2851     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2852     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2853     MOVE X'2220233030303032363930' TO DFHEIV0(25:11)
  2854     CALL 'kxdfhei1' USING DFHEIV0
  2855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2856
  2857
  2858     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  2859     MOVE ' '                    TO PI-ENTRY-CD-1.
  2860     MOVE XCTL-005               TO PGM-NAME.
  2861     MOVE PGM-NAME               TO LOGOFF-PGM.
  2862     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  2863     GO TO 9300-XCTL.
  2864
  2865 9700-DATE-LINK.
  2866     MOVE LINK-ELDATCV           TO PGM-NAME.
  2867
  2868
  2869* EXEC CICS LINK
  2870*        PROGRAM    (PGM-NAME)
  2871*        COMMAREA   (DATE-CONVERSION-DATA)
  2872*        LENGTH     (DC-COMM-LENGTH)
  2873*    END-EXEC.
  2874*    MOVE '."C                   ''   #00002704' TO DFHEIV0
  2875     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2876     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2877     MOVE X'2020233030303032373034' TO DFHEIV0(25:11)
  2878     CALL 'kxdfhei1' USING DFHEIV0,
  2879           PGM-NAME,
  2880           DATE-CONVERSION-DATA,
  2881           DC-COMM-LENGTH,
  2882           DFHEIV99,
  2883           DFHEIV99,
  2884           DFHEIV99
  2885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2886
  2887
  2888 9900-ERROR-FORMAT.
  2889     IF NOT EMI-ERRORS-COMPLETE
  2890         MOVE LINK-001           TO PGM-NAME
  2891
  2892* EXEC CICS LINK
  2893*            PROGRAM    (PGM-NAME)
  2894*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  2895*            LENGTH     (EMI-COMM-LENGTH)
  2896*        END-EXEC.
  2897*    MOVE '."C                   ''   #00002713' TO DFHEIV0
  2898     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2899     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2900     MOVE X'2020233030303032373133' TO DFHEIV0(25:11)
  2901     CALL 'kxdfhei1' USING DFHEIV0,
  2902           PGM-NAME,
  2903           ERROR-MESSAGE-INTERFACE-BLOCK,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL6312.cbl
  2904           EMI-COMM-LENGTH,
  2905           DFHEIV99,
  2906           DFHEIV99,
  2907           DFHEIV99
  2908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2909
  2910
  2911 9900-EXIT.
  2912     EXIT.
  2913
  2914 9990-ABEND.
  2915     MOVE LINK-004               TO PGM-NAME.
  2916     MOVE DFHEIBLK               TO EMI-LINE1.
  2917
  2918* EXEC CICS LINK
  2919*        PROGRAM   (PGM-NAME)
  2920*        COMMAREA  (EMI-LINE1)
  2921*        LENGTH    (72)
  2922*    END-EXEC.
  2923     MOVE 72
  2924       TO DFHEIV11
  2925*    MOVE '."C                   ''   #00002725' TO DFHEIV0
  2926     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2927     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2928     MOVE X'2020233030303032373235' TO DFHEIV0(25:11)
  2929     CALL 'kxdfhei1' USING DFHEIV0,
  2930           PGM-NAME,
  2931           EMI-LINE1,
  2932           DFHEIV11,
  2933           DFHEIV99,
  2934           DFHEIV99,
  2935           DFHEIV99
  2936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2937
  2938
  2939     GO TO 8200-SEND-DATAONLY.
  2940
  2941
  2942* GOBACK.
  2943     MOVE '9%                    "   ' TO DFHEIV0
  2944     MOVE 'EL6312' TO DFHEIV1
  2945     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2946     GOBACK.
  2947
  2948 9995-SECURITY-VIOLATION.
  2949*                            COPY ELCSCTP.
  2950******************************************************************
  2951*                                                                *
  2952*                            ELCSCTP                             *
  2953*                            VMOD=2.001                          *
  2954*                                                                *
  2955*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2956******************************************************************
  2957
  2958
  2959     MOVE EIBDATE          TO SM-JUL-DATE.
  2960     MOVE EIBTRMID         TO SM-TERMID.
  2961     MOVE THIS-PGM         TO SM-PGM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL6312.cbl
  2962     MOVE EIBTIME          TO TIME-IN.
  2963     MOVE TIME-OUT         TO SM-TIME.
  2964     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2965
  2966
  2967* EXEC CICS LINK
  2968*         PROGRAM  ('EL003')
  2969*         COMMAREA (SECURITY-MESSAGE)
  2970*         LENGTH   (80)
  2971*    END-EXEC.
  2972     MOVE 'EL003' TO DFHEIV1
  2973     MOVE 80
  2974       TO DFHEIV11
  2975*    MOVE '."C                   ''   #00002753' TO DFHEIV0
  2976     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2977     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2978     MOVE X'2020233030303032373533' TO DFHEIV0(25:11)
  2979     CALL 'kxdfhei1' USING DFHEIV0,
  2980           DFHEIV1,
  2981           SECURITY-MESSAGE,
  2982           DFHEIV11,
  2983           DFHEIV99,
  2984           DFHEIV99,
  2985           DFHEIV99
  2986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2987
  2988
  2989******************************************************************
  2990
  2991
  2992 9995-EXIT.
  2993     EXIT.
  2994
  2995
  2996 9999-DFHBACK SECTION.
  2997     MOVE '9%                    "   ' TO DFHEIV0
  2998     MOVE 'EL6312' TO DFHEIV1
  2999     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3000     GOBACK.
  3001 9999-DFHEXIT.
  3002     IF DFHEIGDJ EQUAL 0001
  3003         NEXT SENTENCE
  3004     ELSE IF DFHEIGDJ EQUAL 2
  3005         GO TO 8300-SEND-TEXT
  3006         DEPENDING ON DFHEIGDI.
  3007     MOVE '9%                    "   ' TO DFHEIV0
  3008     MOVE 'EL6312' TO DFHEIV1
  3009     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3010     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4396     Code:        8310
