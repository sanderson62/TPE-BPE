* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page   1
* EL640.cbl
* Options: int("EL640.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL640.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL640.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL640.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL640.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 15:38:12.
     7*                            VMOD=2.040
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page   2
* EL640.cbl
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22*
    23*REMARKS.    TRANSACTION - EXC1 - ACCOUNT BILLING.
    24*
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    34*                              ADJUSTED REDEFINES EL640AO FILLER
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 083104    2004083000002  PEMA PREVENT ONLINE BILLING
    37* 072105    2004120100002  PEMA FIX ONLINE BILLING FOR DCC SPP
    38* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    39* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    40* 032113  CR2012110800003  PEMA  CORRECT SPP AH REF COMMISSION
    41* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    42* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    43* 032219  CR2019020800001  PEMA  Increase width of bi-type column
    44******************************************************************
    45 ENVIRONMENT DIVISION.
    46
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page   3
* EL640.cbl
    48 DATA DIVISION.
    49 WORKING-STORAGE SECTION.
    50 01  DFH-START PIC X(04).
    51 77  FILLER  PIC X(32)  VALUE '********************************'.
    52 77  FILLER  PIC X(32)  VALUE '*    EL640 WORKING STORAGE     *'.
    53 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.040 ************'.
    54 77  CNC-FACT                    PIC S999V9(7) COMP-3 VALUE +0.
    55 77  S1                          PIC S999 COMP-3 VALUE +0.
    56*    COPY ELCSCTM.
    57******************************************************************
    58*                                                                *
    59*                                                                *
    60*                            ELCSCTM                             *
    61*                            VMOD=2.001                          *
    62*                                                                *
    63*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    64*                                                                *
    65******************************************************************
    66 01  SECURITY-MESSAGE.
    67     12  FILLER                          PIC X(30)
    68            VALUE '** LOGIC SECURITY VIOLATION -'.
    69     12  SM-READ                         PIC X(6).
    70     12  FILLER                          PIC X(5)
    71            VALUE ' PGM='.
    72     12  SM-PGM                          PIC X(6).
    73     12  FILLER                          PIC X(5)
    74            VALUE ' OPR='.
    75     12  SM-PROCESSOR-ID                 PIC X(4).
    76     12  FILLER                          PIC X(6)
    77            VALUE ' TERM='.
    78     12  SM-TERMID                       PIC X(4).
    79     12  FILLER                          PIC XX   VALUE SPACE.
    80     12  SM-JUL-DATE                     PIC 9(5).
    81     12  FILLER                          PIC X    VALUE SPACE.
    82     12  SM-TIME                         PIC 99.99.
    83
    84*    COPY ELCSCRTY.
    85******************************************************************
    86*                                                                *
    87*                                                                *
    88*                            ELCSCRTY                            *
    89*                            VMOD=2.001                          *
    90*                                                                *
    91*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    92*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    93*        SAVED IN PI-SECURITY-ADDRESS.                           *
    94*                                                                *
    95******************************************************************
    96 01  SECURITY-CONTROL.
    97     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    98     12  FILLER                       PIC XX    VALUE 'SC'.
    99     12  SC-CREDIT-CODES.
   100         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   101             20  SC-CREDIT-DISPLAY    PIC X.
   102             20  SC-CREDIT-UPDATE     PIC X.
   103     12  SC-CLAIMS-CODES.
   104         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   105             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page   4
* EL640.cbl
   106             20  SC-CLAIMS-UPDATE     PIC X.
   107     12  WS-RESPONSE             PIC S9(8)       COMP.
   108         88  WS-RESP-NORMAL                      VALUE +00.
   109         88  WS-RESP-NOTFND                      VALUE +13.
   110         88  WS-RESP-DUPREC                      VALUE +14.
   111         88  WS-RESP-DUPKEY                      VALUE +15.
   112         88  WS-RESP-NOTOPEN                     VALUE +19.
   113         88  WS-RESP-ENDFILE                     VALUE +20.
   114 01  benefit-code-stuff.
   115     05  ws-lf-benefit-cd-stuff.
   116         10  ws-lf-alpha         pic xxx   value spaces.
   117         10  ws-lf-descrip       pic x(10) value spaces.
   118         10  ws-lf-comment       pic x(10) value spaces.
   119         10  ws-lf-cov-type      pic x     value spaces.
   120         10  ws-lf-spec-calc-cd  pic x     value spaces.
   121         10  ws-lf-joint-ind     pic x     value spaces.
   122     05  ws-ah-benefit-cd-stuff.
   123         10  ws-ah-alpha         pic xxx   value spaces.
   124         10  ws-ah-descrip       pic x(10) value spaces.
   125         10  ws-ah-comment       pic x(10) value spaces.
   126         10  ws-ah-spec-calc-cd  pic x     value spaces.
   127         10  ws-ah-joint-ind     pic x     value spaces.
   128         10  WS-AH-CATEGORY      PIC X     VALUE ' '.
   129 01  STANDARD-AREAS.
   130     12  CLAS-LOOK                   PIC XX      VALUE '  '.
   131     12  SC-ITEM             PIC S9(4) COMP VALUE +1.
   132
   133     12  W-TRANSFER-CONTROL.
   134         16  WT-CR-CARRIER           PIC X     VALUE SPACES.
   135         16  WT-CR-GROUPING          PIC X(6)  VALUE SPACES.
   136         16  WT-CR-STATE             PIC XX    VALUE SPACES.
   137         16  WT-CR-ACCOUNT           PIC X(10) VALUE SPACES.
   138         16  WT-CR-FIN-RESP          PIC X(10) VALUE SPACES.
   139         16  WT-CR-TYPE              PIC X     VALUE SPACES.
   140
   141     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   142     12  MAP-NAME            PIC X(8)    VALUE 'EL640A'.
   143     12  MAPSET-NAME         PIC X(8)    VALUE 'EL640S'.
   144     12  SCREEN-NUMBER       PIC X(4)    VALUE '640A'.
   145     12  TRANS-ID            PIC X(4)    VALUE 'EXC1'.
   146     12  EL6311-TRANS-ID     PIC X(4)    VALUE 'EXB1'.
   147     12  EL633-TRANS-ID      PIC X(4)    VALUE 'EXB7'.
   148     12  EL633DMD-TRANS-ID   PIC X(4)    VALUE 'EX1F'.
   149     12  EL635-TRANS-ID      PIC X(4)    VALUE 'EXJ4'.
   150     12  EL650-TRANS-ID      PIC X(4)    VALUE 'EXC4'.
   151     12  EL652-TRANS-ID      PIC X(4)    VALUE 'EXD4'.
   152     12  EL658-TRANS-ID      PIC X(4)    VALUE 'EXJ3'.
   153     12  THIS-PGM            PIC X(8)    VALUE 'EL640'.
   154     12  EL640A              PIC X(8)    VALUE 'EL640A'.
   155     12  EL640B              PIC X(8)    VALUE 'EL640B'.
   156     12  PGM-NAME            PIC X(8).
   157     12  TIME-IN             PIC S9(7).
   158     12  TIME-OUT-R  REDEFINES TIME-IN.
   159         16  FILLER          PIC X.
   160         16  TIME-OUT        PIC 99V99.
   161         16  FILLER          PIC XX.
   162
   163     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page   5
* EL640.cbl
   164     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   165     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   166     12  XCTL-633            PIC X(8)    VALUE 'EL633'.
   167     12  XCTL-633DMD         PIC X(8)    VALUE 'EL633DMD'.
   168     12  XCTL-635            PIC X(8)    VALUE 'EL635'.
   169     12  XCTL-PYAJ           PIC X(8)    VALUE 'EL633'.
   170     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   171     12  XCTL-652            PIC X(8)    VALUE 'EL652'.
   172     12  XCTL-658            PIC X(8)    VALUE 'EL658'.
   173     12  XCTL-6401           PIC X(8)    VALUE 'EL6401'.
   174     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   175     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   176     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   177     12  ERPNDB-ALT-FILE-ID  PIC X(8)    VALUE 'ERPNDB2'.
   178     12  ERPNDB-FILE-ID      PIC X(8)    VALUE 'ERPNDB'.
   179     12  ELCNTL-FILE-ID      PIC X(8)    VALUE 'ELCNTL'.
   180     12  ELLETR-FILE-ID      PIC X(8)    VALUE 'ELLETR'.
   181     12  ERCOMP-FILE-ID      PIC X(8)    VALUE 'ERCOMP'.
   182     12  ERPYAJ-FILE-ID      PIC X(8)    VALUE 'ERPYAJ'.
   183     12  ERACCT-ALT-FILE-ID  PIC X(8)    VALUE 'ERACCT2'.
   184     12  ERACCT-FILE-ID      PIC X(8)    VALUE 'ERACCT'.
   185     12  ERBILL-FILE-ID      PIC X(8)    VALUE 'ERBILL'.
   186     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   187     12  QID.
   188         16  QID-TERM        PIC X(4).
   189         16  FILLER          PIC X(4)    VALUE '640A'.
   190     12  CLIENT-ITY          PIC XXX     VALUE 'ITY'.
   191
   192 01  WORK-AREA.
   193     12  W-LETTER-IND            PIC X     VALUE SPACE.
   194         88  W-LETTER-NOT-FOUND    VALUE 'Y'.
   195     12  FIRST-TIME-SW           PIC X     VALUE 'Y'.
   196         88  FIRST-TIME            VALUE 'Y'.
   197     12  C-RECORD-FOUND-SW       PIC X     VALUE 'Y'.
   198         88  C-RECORD-FOUND        VALUE 'Y'.
   199     12  ACCOUNT-FIN-RESP-SW     PIC X     VALUE ' '.
   200         88  ACCOUNT-FIN-RESP      VALUE 'Y'.
   201         88  ACCOUNT-NOT-FIN-RESP  VALUE 'N'.
   202     12  VALID-BILL-TYPE-VALUES  PIC X     VALUE SPACE.
   203         88  VALID-BILL-TYPE       VALUE  '1' '2'.
   204*        88  VALID-BILL-TYPE       VALUE  '1' '2' '3' '4' '5'.
   205     12  BILL-BATCH-TRAILER-SW   PIC X     VALUE SPACE.
   206         88  BILL-BATCH-TRAILER    VALUE 'Y'.
   207     12  PNDB-EOF-SW             PIC X     VALUE SPACE.
   208         88  PNDB-EOF              VALUE 'Y'.
   209     12  PYAJ-EOF-SW             PIC X     VALUE SPACE.
   210         88  PYAJ-EOF              VALUE 'Y'.
   211     12  COMP-UPDATE-SW          PIC X     VALUE SPACE.
   212         88  UPDATE-COMP-TOTALS    VALUE 'Y'.
   213     12  LIMIT-BILLING-SW        PIC X     VALUE SPACE.
   214         88  LIMIT-BILLING         VALUE 'Y'.
   215     12  WS-PROCESS-SW           PIC X     VALUE SPACE.
   216         88  DO-NOT-BILL-THIS-ACCT VALUE 'Y'.
   217     12  WS-CHARGEBACK-LF-SW     PIC X     VALUE SPACE.
   218         88  CHARGEBACK-CAN-LF     VALUE 'Y'.
   219         88  NO-CHARGEBACK-LF      VALUE 'N'.
   220     12  WS-CHARGEBACK-AH-SW     PIC X     VALUE SPACE.
   221         88  CHARGEBACK-CAN-AH     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page   6
* EL640.cbl
   222         88  NO-CHARGEBACK-AH      VALUE 'N'.
   223     12  NO-BILL-REC-SW          PIC X     VALUE SPACE.
   224         88  NO-BILL-RECS          VALUE 'Y'.
   225     12  DATA-VOIDED-SW          PIC X     VALUE SPACE.
   226         88  DATA-VOIDED           VALUE 'Y'.
   227     12  BATCHES-PROCESSED-SW    PIC X     VALUE SPACE.
   228         88  MORE-THAN-6-BATCHES   VALUE 'Y'.
   229     12  BILLING-DETAIL-TYPE     PIC XX    VALUE SPACES.
   230         88  TOTAL-STATEMENT       VALUE 'TS'.
   231         88  BILLING-DETAIL        VALUE 'BD'.
   232         88  CARRIER-ADDRESS       VALUE 'CA'.
   233         88  GEN-AGT-ADDRESS       VALUE 'GA'.
   234     12  ELCNTL-UPDATE-SW        PIC X     VALUE SPACE.
   235         88  ELCNTL-UPDATE         VALUE 'Y'.
   236     12  WS-ENTERED-FROM-MAP     PIC X     VALUE 'A'.
   237         88  WS-ENTERED-FROM-A     VALUE 'A'.
   238
   239     12  ACCOM-SUB               PIC 99    VALUE ZEROS.
   240     12  SUB                     PIC S999  COMP-3  VALUE ZEROS.
   241
   242     12  WORK-ZIP                PIC 9(9)  VALUE ZEROS.
   243     12  WORK-ZIPR1 REDEFINES WORK-ZIP.
   244         16  WORK-ZIPR1-4        PIC 9(4).
   245         16  WORK-ZIPR1-5        PIC 9(5).
   246     12  WORK-ZIPR2 REDEFINES WORK-ZIP.
   247         16  WORK-ZIPR2-5        PIC 9(5).
   248         16  WORK-ZIPR2-4        PIC 9(4).
   249     12  WS-AM-ZIP.
   250         16  WS-AM-ZIP-PRIME     PIC X(5).
   251         16  WS-AM-ZIP-DASH      PIC X.
   252         16  WS-AM-ZIP-PLUS4     PIC X(4).
   253     12  WS-AM-CANADIAN-ZIP  REDEFINES  WS-AM-ZIP.
   254         16  WS-AM-CAN-POST-1    PIC XXX.
   255         16  FILLER              PIC X.
   256         16  WS-AM-CAN-POST-2    PIC XXX.
   257         16  FILLER              PIC XXX.
   258     12  WS-CF-ZIP.
   259         16  WS-CF-ZIP-PRIME     PIC X(5) VALUE SPACES.
   260         16  WS-CF-ZIP-DASH      PIC X    VALUE SPACES.
   261         16  WS-CF-ZIP-PLUS4     PIC X(4) VALUE SPACES.
   262     12  WS-CF-CANADIAN-ZIP  REDEFINES  WS-CF-ZIP.
   263         16  WS-CF-CAN-POST-1    PIC XXX.
   264         16  FILLER              PIC X.
   265         16  WS-CF-CAN-POST-2    PIC XXX.
   266         16  FILLER              PIC XXX.
   267     12  WS-CO-ZIP.
   268         16  WS-CO-ZIP-PRIME     PIC X(5) VALUE SPACES.
   269         16  WS-CO-ZIP-DASH      PIC X    VALUE SPACES.
   270         16  WS-CO-ZIP-PLUS4     PIC X(4) VALUE SPACES.
   271     12  WS-CO-CANADIAN-ZIP  REDEFINES  WS-CO-ZIP.
   272         16  WS-CO-CAN-POST-1    PIC XXX.
   273         16  FILLER              PIC X.
   274         16  WS-CO-CAN-POST-2    PIC XXX.
   275         16  FILLER              PIC XXX.
   276
   277     12  WORK-SEQ-NO             PIC S9(9)   COMP-3 VALUE +0.
   278     12  WS-ERROR-MSG.
   279         16  WS-ERROR-TEXT       PIC X(35) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page   7
* EL640.cbl
   280         16  WS-ERROR-BATCH      PIC X(6)  VALUE SPACES.
   281         16  FILLER              PIC X(24) VALUE SPACES.
   282     12  WS-WORK-DATE.
   283         16  WS-MONTH            PIC 99    VALUE ZEROS.
   284         16  WS-DAY              PIC 99    VALUE ZEROS.
   285         16  WS-YEAR             PIC 99    VALUE ZEROS.
   286     12  WS-MONTH-END-DATE.
   287         16  WS-ME-YEAR          PIC 99    VALUE ZEROS.
   288         16  WS-ME-MONTH         PIC 99    VALUE ZEROS.
   289         16  WS-ME-DAY           PIC 99    VALUE ZEROS.
   290     12  WS-CURRENT-DATE         PIC XX    VALUE SPACES.
   291     12  WS-CURRENT-DATE-MDY     PIC X(6)  VALUE SPACES.
   292     12  WS-CURRENT-DATE-EDIT    PIC X(8)  VALUE SPACES.
   293     12  WS-PREV-BILL-DATE       PIC XX    VALUE LOW-VALUES.
   294     12  WS-BEGIN-DATE.
   295         16  FILLER              PIC X(3)  VALUE SPACES.
   296         16  WS-BEGIN-DAY        PIC XX    VALUE SPACES.
   297         16  FILLER              PIC X(3)  VALUE SPACES.
   298     12  PRINT-CONTROL.
   299         16  SINGLE-SPACE        PIC X     VALUE SPACE.
   300         16  DOUBLE-SPACE        PIC X     VALUE ZERO.
   301         16  TRIPLE-SPACE        PIC X     VALUE '-'.
   302         16  SUPPRESS-SPACE      PIC X     VALUE '+'.
   303         16  TOP-OF-PAGE         PIC X     VALUE '1'.
   304     12  WS-EXP-DATE.
   305         16  WS-SAV-EXP-DT     OCCURS 10 TIMES
   306                               INDEXED BY DTNDX  PIC XX.
   307     12  WS-REMIT-TO.
   308         16  WS-SAV-REMIT-TO   OCCURS 10 TIMES
   309                               INDEXED BY RTNDX  PIC X(10).
   310     12  WORK-REMIT-TO           PIC X(10) VALUE SPACES.
   311     12  WS-REMITTED             PIC S9(6)V99 VALUE ZEROS.
   312     12  WS-LINECTR              PIC 99    VALUE ZEROS.
   313     12  WS-PGECTR               PIC 999   VALUE 1.
   314     12  WS-LINE-SEQ-NO          PIC S9(4) COMP VALUE +1.
   315     12  WS-CARR-COMP.
   316         16  WS-CARRIER          PIC X     VALUE SPACE.
   317         16  WS-COMP             PIC X(6)  VALUE SPACES.
   318
   319     12  REPORT-TOTALS.
   320         16  TOT-REPT-LF-PREM    PIC S9(7)V99   VALUE ZEROS.
   321         16  TOT-REPT-LF-REF     PIC S9(7)V99   VALUE ZEROS.
   322         16  TOT-REPT-LF-COMP    PIC S9(7)V99   VALUE ZEROS.
   323         16  TOT-REPT-LF-COMP-R  PIC S9(7)V99   VALUE ZEROS.
   324         16  TOT-REPT-AH-PREM    PIC S9(7)V99   VALUE ZEROS.
   325         16  TOT-REPT-AH-REF     PIC S9(7)V99   VALUE ZEROS.
   326         16  TOT-REPT-AH-COMP    PIC S9(7)V99   VALUE ZEROS.
   327         16  TOT-REPT-AH-COMP-R  PIC S9(7)V99   VALUE ZEROS.
   328         16  TOT-LF-REPT-FACE-AMT   PIC S9(7)V99   VALUE ZEROS.
   329         16  TOT-AH-REPT-FACE-AMT   PIC S9(7)V99   VALUE ZEROS.
   330         16  TOT-REPT-PREM       PIC S9(7)V99   VALUE ZEROS.
   331         16  TOT-REPT-CANCEL-FEE PIC S9(7)V99   VALUE ZEROS.
   332     12  WORK-AMT                PIC S9(7)V99   VALUE ZEROS.
   333     12  WORK-CHECK-AMT          PIC S9(7)V99   VALUE ZEROS.
   334     12  WORK-CANCEL-FEE         PIC S9(7)V99   VALUE ZEROS.
   335     12  WS-I-LF-PREMIUM-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   336     12  WS-I-LF-BENEFIT-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   337     12  WS-I-AH-PREMIUM-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page   8
* EL640.cbl
   338     12  WS-I-AH-BENEFIT-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   339     12  WS-C-LF-CANCEL-AMT      PIC S9(5)V99   COMP-3 VALUE +0.
   340     12  WS-C-AH-CANCEL-AMT      PIC S9(5)V99   COMP-3 VALUE +0.
   341     12  WS-C-CANCEL-FEE         PIC S9(5)V99   COMP-3 VALUE +0.
   342     12  WS-LF-CAN-COMP          PIC S9(6)V99   COMP-3 VALUE +0.
   343     12  WS-AH-CAN-COMP          PIC S9(6)V99   COMP-3 VALUE +0.
   344     12  WS-PAY-ADJ              PIC S9(6)V99   COMP-3 VALUE +0.
   345     12  WS-CI-LIFE-BENEFIT      PIC S9(7)V99   COMP-3 VALUE +0.
   346     12  LF-COMM-TBL-NO          PIC X(3)       VALUE SPACES.
   347     12  JT-COMM-TBL-NO          PIC X(3)       VALUE SPACES.
   348     12  AH-COMM-TBL-NO          PIC X(3)       VALUE SPACES.
   349     12  AGENT-OWES              PIC X(18)
   350                         VALUE 'AGENT OWES       ='.
   351     12  OWED-TO-AGENT           PIC X(18)
   352                         VALUE 'OWED TO AGENT    ='.
   353     12  WS-PY-ENTRY-COMMENT.
   354         16  WS-PY-CURRENT-DATE      PIC X(6) VALUE SPACES.
   355         16  FILLER                  PIC X(14) VALUE
   356             ' CHK TO AGENT'.
   357
   358     12  WS-ITY-COMMENT.
   359         16  WS-PY-BEGIN-DT          PIC X(8) VALUE SPACES.
   360         16  FILLER                  PIC X(06) VALUE
   361             ' THRU '.
   362         16  WS-PY-END-DT            PIC X(8) VALUE SPACES.
   363
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page   9
* EL640.cbl
   365     12  WS-ACCT-ADDR-AREA.
   366         16  WS-ACCT-LINES OCCURS 6 TIMES INDEXED BY A-INDX.
   367           18  WS-ACCT-ZIP           PIC X(10) VALUE SPACES.
   368           18  FILLER                PIC X(10) VALUE SPACES.
   369           18  WS-A-LAST-ZIP         PIC X(10) VALUE SPACES.
   370
   371     12  WS-REMIT-ADDR-AREA.
   372         16  WS-REMIT-ACCT           PIC X(10) VALUE SPACES.
   373         16  WS-REMIT-LINES OCCURS 6 TIMES INDEXED BY R-INDX.
   374           18  WS-REMIT-ZIP          PIC X(10) VALUE SPACES.
   375           18  FILLER                PIC X(10) VALUE SPACES.
   376           18  WS-R-LAST-ZIP         PIC X(10) VALUE SPACES.
   377
   378     12  WS-EFFECT-DATE.
   379         16  WS-EFFECT-YR            PIC 99 VALUE ZEROS.
   380         16  WS-EFFECT-MO            PIC 99 VALUE ZEROS.
   381         16  WS-EFFECT-DA            PIC 99 VALUE ZEROS.
   382
   383     12  WS-LIFE-CANCEL-DT.
   384         16  WS-LF-CANCEL-YR         PIC 99 VALUE ZEROS.
   385         16  WS-LF-CANCEL-MO         PIC 99 VALUE ZEROS.
   386         16  WS-LF-CANCEL-DA         PIC 99 VALUE ZEROS.
   387
   388     12  WS-AH-CANCEL-DT.
   389         16  WS-AH-CANCEL-YR         PIC 99 VALUE ZEROS.
   390         16  WS-AH-CANCEL-MO         PIC 99 VALUE ZEROS.
   391         16  WS-AH-CANCEL-DA         PIC 99 VALUE ZEROS.
   392
   393     12  MONTHS-DIFF-LF            PIC S9(05)  VALUE ZEROS.
   394     12  MONTHS-DIFF-AH            PIC S9(05)  VALUE ZEROS.
   395
   396     12  WS-BENEFIT.
   397         16  FILLER                PIC X   VALUE SPACES.
   398         16  WS-BENE-CD            PIC XX  VALUE SPACES.
   399
   400     12  WS-DESC.
   401         16 WS-BATCH-DESC        PIC X(10) VALUE SPACES.
   402         16 WS-BATCH-NBR         PIC X(6)  VALUE SPACES.
   403         16 FILLER               PIC X(4)  VALUE SPACES.
   404     12  WS-NON-PREM             PIC S9(7)V99   COMP-3.
   405     12  WS-NON-COMM             PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  10
* EL640.cbl
   407 01  ACCESS-KEYS.
   408     12  ERPNDB-PRIME-KEY.
   409         16  ERPNDB-CO-CD        PIC X     VALUE SPACES.
   410         16  ERPNDB-BATCH        PIC X(6)  VALUE SPACES.
   411         16  ERPNDB-SEQ-NO       PIC S9(4) COMP VALUE +0.
   412         16  ERPNDB-CHG-SEQ-NO   PIC S9(4) COMP VALUE +0.
   413
   414     12  ERPNDB-LENGTH           PIC S9(4) COMP VALUE +585.
   415
   416     12  ERPNDB-ALT-KEY.
   417         16  ERPNDB-CO-CD-A1     PIC X     VALUE SPACES.
   418         16  ERPNDB-CARR         PIC X     VALUE SPACES.
   419         16  ERPNDB-GROUP        PIC X(6)  VALUE SPACES.
   420         16  ERPNDB-STATE        PIC XX    VALUE SPACES.
   421         16  ERPNDB-ACCT         PIC X(10) VALUE SPACES.
   422         16  ERPNDB-EFF-DT       PIC XX    VALUE SPACES.
   423         16  ERPNDB-CERT.
   424             20  ERPNDB-CERT-PRM PIC X(10) VALUE SPACES.
   425             20  ERPNDB-CERTSFX  PIC X     VALUE SPACES.
   426         16  ERPNDB-ACHG-SEQ-NO  PIC S9(4) COMP.
   427         16  ERPNDB-REC-TYPE     PIC X     VALUE SPACES.
   428
   429     12  ELCNTL-KEY.
   430         16  ELCNTL-COMPANY-ID   PIC XXX   VALUE SPACES.
   431         16  ELCNTL-REC-TYPE     PIC X     VALUE SPACES.
   432         16  ELCNTL-ACCESS.
   433             20  ELCNTL-FILLER   PIC X(3)  VALUE SPACES.
   434             20  ELCNTL-CARRIER  PIC X     VALUE SPACES.
   435         16  ELCNTL-SEQ-NO       PIC S9(4) COMP VALUE ZEROS.
   436
   437     12  ELCNTL-LENGTH           PIC S9(4) COMP VALUE +504.
   438
   439     12  ERCOMP-KEY.
   440         16  ERCOMP-COMP-CD      PIC X     VALUE SPACE.
   441         16  ERCOMP-CARRIER      PIC X     VALUE SPACES.
   442         16  ERCOMP-GROUPING     PIC X(6)  VALUE SPACES.
   443         16  ERCOMP-FIN-RESP     PIC X(10) VALUE SPACES.
   444         16  ERCOMP-ACCT         PIC X(10) VALUE SPACES.
   445         16  ERCOMP-RECORD-TYPE  PIC X     VALUE SPACES.
   446
   447     12  ERPYAJ-BROWSE-COMP-KEY.
   448         16  ERPYAJ-BR-COMP-CD   PIC X     VALUE SPACE.
   449         16  ERPYAJ-BR-CARRIER   PIC X     VALUE SPACES.
   450         16  ERPYAJ-BR-GROUPING  PIC X(6)  VALUE SPACES.
   451         16  ERPYAJ-BR-FIN-RESP  PIC X(10) VALUE SPACES.
   452         16  ERPYAJ-BR-ACCOUNT   PIC X(10) VALUE SPACES.
   453
   454     12  ERCOMP-LENGTH           PIC S9(4) COMP VALUE +700.
   455
   456     12  ERPYAJ-KEY.
   457         16  ERPYAJ-COMP-CD      PIC X     VALUE SPACE.
   458         16  ERPYAJ-CARRIER      PIC X     VALUE SPACES.
   459         16  ERPYAJ-GROUPING     PIC X(6)  VALUE SPACES.
   460         16  ERPYAJ-FIN-RESP     PIC X(10) VALUE SPACES.
   461         16  ERPYAJ-ACCOUNT      PIC X(10) VALUE SPACES.
   462         16  ERPYAJ-FILE-SEQ-NO  PIC S9(8) VALUE +0 COMP.
   463         16  ERPYAJ-RECORD-TYPE  PIC X     VALUE SPACES.
   464
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  11
* EL640.cbl
   465     12  ERPYAJ-LENGTH           PIC S9(4) COMP VALUE +200.
   466
   467     12  ERACCT-PRIME-KEY.
   468         16  ERACCT-P-CO-CD      PIC X     VALUE SPACES.
   469         16  ERACCT-P-CARRIER    PIC X     VALUE SPACES.
   470         16  ERACCT-P-GROUPING   PIC X(6)  VALUE SPACES.
   471         16  ERACCT-P-STATE      PIC XX    VALUE SPACES.
   472         16  ERACCT-P-ACCOUNT    PIC X(10) VALUE SPACES.
   473         16  ERACCT-P-EXP-DATE   PIC XX    VALUE SPACES.
   474         16  FILLER              PIC X(4)  VALUE SPACES.
   475
   476     12  ERACCT-LENGTH           PIC S9(4) COMP VALUE +2000.
   477
   478     12  ERACCT-ALT-KEY.
   479         16  ERACCT-A-CO-CD      PIC X     VALUE SPACES.
   480         16  ERACCT-A-CARRIER    PIC X     VALUE SPACES.
   481         16  ERACCT-A-GROUPING   PIC X(6)  VALUE SPACES.
   482         16  ERACCT-A-STATE      PIC XX    VALUE SPACES.
   483         16  ERACCT-A-ACCOUNT    PIC X(10) VALUE SPACES.
   484         16  ERACCT-A-EXP-DATE   PIC XX    VALUE SPACES.
   485         16  FILLER              PIC X(4)  VALUE SPACES.
   486
   487     12  ERBILL-KEY.
   488         16  ERBILL-CO-CD        PIC X.
   489         16  ERBILL-CARRIER      PIC X.
   490         16  ERBILL-GROUP        PIC X(6).
   491         16  ERBILL-ACCT         PIC X(10).
   492         16  ERBILL-FIN-RESP     PIC X(10).
   493         16  ERBILL-REC-TYPE     PIC X.
   494         16  ERBILL-LINE-SEQ-NO  PIC S9(4) COMP.
   495
   496     12  ERBILL-LENGTH           PIC S9(4) COMP VALUE +210.
   497
   498     12  ELLETR-KEY.
   499         16  ELLETR-COMPANY-CD   PIC  X      VALUE SPACE.
   500         16  ELLETR-FORM-NO      PIC  X(12)  VALUE SPACES.
   501         16  ELLETR-LINE-SEQ     PIC S9(04)  VALUE +0 COMP.
   502
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  12
* EL640.cbl
   504
   505 01  ERROR-NUMBERS.
   506     12  ER-0004                 PIC X(4)  VALUE '0004'.
   507     12  ER-0008                 PIC X(4)  VALUE '0008'.
   508     12  ER-0013                 PIC X(4)  VALUE '0013'.
   509     12  ER-0022                 PIC X(4)  VALUE '0022'.
   510     12  ER-0029                 PIC X(4)  VALUE '0029'.
   511     12  ER-0070                 PIC X(4)  VALUE '0070'.
   512     12  ER-0194                 PIC X(4)  VALUE '0194'.
   513     12  ER-0195                 PIC X(4)  VALUE '0195'.
   514     12  ER-0196                 PIC X(4)  VALUE '0196'.
   515     12  ER-0197                 PIC X(4)  VALUE '0197'.
   516     12  ER-2208                 PIC X(4)  VALUE '2208'.
   517     12  ER-2210                 PIC X(4)  VALUE '2210'.
   518     12  ER-2212                 PIC X(4)  VALUE '2212'.
   519     12  ER-2215                 PIC X(4)  VALUE '2215'.
   520     12  ER-2230                 PIC X(4)  VALUE '2230'.
   521     12  ER-2233                 PIC X(4)  VALUE '2233'.
   522     12  ER-2249                 PIC X(4)  VALUE '2249'.
   523     12  ER-2250                 PIC X(4)  VALUE '2250'.
   524     12  ER-2370                 PIC X(4)  VALUE '2370'.
   525     12  ER-2371                 PIC X(4)  VALUE '2371'.
   526     12  ER-2383                 PIC X(4)  VALUE '2383'.
   527     12  ER-2385                 PIC X(4)  VALUE '2385'.
   528     12  ER-2401                 PIC X(4)  VALUE '2401'.
   529     12  ER-2403                 PIC X(4)  VALUE '2403'.
   530     12  ER-2404                 PIC X(4)  VALUE '2404'.
   531     12  ER-2405                 PIC X(4)  VALUE '2405'.
   532     12  ER-2406                 PIC X(4)  VALUE '2406'.
   533     12  ER-2407                 PIC X(4)  VALUE '2407'.
   534     12  ER-2408                 PIC X(4)  VALUE '2408'.
   535     12  ER-2409                 PIC X(4)  VALUE '2409'.
   536     12  ER-2411                 PIC X(4)  VALUE '2411'.
   537     12  ER-2421                 PIC X(4)  VALUE '2421'.
   538     12  ER-2434                 PIC X(4)  VALUE '2434'.
   539     12  ER-2435                 PIC X(4)  VALUE '2435'.
   540     12  ER-2436                 PIC X(4)  VALUE '2436'.
   541     12  ER-2438                 PIC X(4)  VALUE '2438'.
   542     12  ER-2439                 PIC X(4)  VALUE '2439'.
   543     12  ER-2443                 PIC X(4)  VALUE '2443'.
   544     12  ER-2472                 PIC X(4)  VALUE '2472'.
   545     12  ER-2539                 PIC X(4)  VALUE '2539'.
   546     12  ER-2564                 PIC X(4)  VALUE '2564'.
   547     12  ER-2570                 PIC X(4)  VALUE '2570'.
   548     12  ER-2571                 PIC X(4)  VALUE '2571'.
   549     12  ER-2597                 PIC X(4)  VALUE '2597'.
   550     12  ER-3145                 PIC X(4)  VALUE '3145'.
   551     12  ER-3165                 PIC X(4)  VALUE '3165'.
   552     12  ER-3188                 PIC X(4)  VALUE '3188'.
   553     12  ER-7285                 PIC X(4)  VALUE '7285'.
   554     12  ER-7389                 PIC X(4)  VALUE '7389'.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  13
* EL640.cbl
   556 01  BI-REPORT-HEADINGS.
   557     12  BI-PREVIEW-HD.
   558         16  FILLER          PIC X(42)           VALUE SPACES.
   559         16  FILLER          PIC X(47)           VALUE
   560                '**** STATEMENT IS FOR REVIEW PURPOSES ONLY ****'.
   561         16  FILLER          PIC X(43)           VALUE SPACES.
   562
   563     12  BI-HD1.
   564         16  FILLER          PIC X(44)           VALUE SPACES.
   565         16  FILLER          PIC X(44)           VALUE
   566                 '  CREDIT LIFE, ACCIDENT & HEALTH STATEMENT  '.
   567         16  FILLER          PIC X(36)           VALUE SPACES.
   568         16  FILLER          PIC X(8)            VALUE ' EL640 '.
   569
   570     12  BI-HD2.
   571         16  FILLER          PIC X(51)           VALUE SPACES.
   572         16  BI-HD-CO        PIC X(30).
   573         16  FILLER          PIC X(43)           VALUE SPACES.
   574         16  BI-HD-RUN-DT    PIC X(8)            VALUE SPACES.
   575
   576     12  BI-HD3.
   577         16  FILLER          PIC X(57)           VALUE SPACES.
   578         16  BI-HD-BILL-DT   PIC X(18).
   579         16  FILLER          PIC X(37)           VALUE SPACES.
   580         16  FILLER          PIC X(5)            VALUE 'PAGE'.
   581         16  BI-HD-PG        PIC ZZ,ZZ9.
   582
   583     12  BI-HD4.
   584         16  filler          pic  x(92)      value
   585         '                             CERTIFICATE  EFFECTIVE CANC
   586-        'EL          BEN.            WRITTEN '.
   587
   588*        16  FILLER          PIC  X(44)      VALUE
   589*            '                             CERTIFICATE  EF'.
   590*        16  FILLER          PIC  X(44)      VALUE
   591*            'EFFECTIVE   CANCEL       BEN.      WRITTEN  '.
   592*  ===>  12  FILLER          PIC  X(44)      VALUE
   593*            '    COMP.                    FACE AMOUNT /  '.
   594
   595     12  BI-HD5.
   596         16  filler          pic x(131)   value
   597             '       NAME OF INSURED         NUMBER       DATE
   598-            ' DATE   TERM    TYPE            PREMIUM       PCT.
   599-            '   COMPENSATION    BENEFIT '.
   600
   601*        16  FILLER          PIC  X(44)      VALUE
   602*            '       NAME OF INSURED            NUMBER    '.
   603*        16  FILLER          PIC  X(44)      VALUE
   604*            '  DATE       DATE   TERM TYPE      PREMIUM  '.
   605*        16  FILLER          PIC  X(44)      VALUE
   606*            '     PCT.    COMPENSATION        BENEFIT    '.
   607
   608     12  BI-HD6.
   609         16  FILLER          PIC  X(44)      VALUE SPACES.
   610         16  FILLER          PIC  X(37)      VALUE SPACES.
   611         16  FILLER          PIC  X(45)      VALUE
   612             '     PROCESSED                  NON-PROCESSED'.
   613         16  FILLER          PIC  X(07)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  14
* EL640.cbl
   614     12  BI-HD7.
   615         16  FILLER          PIC  X(44)      VALUE SPACES.
   616         16  FILLER          PIC  X(35)      VALUE SPACES.
   617         16  FILLER          PIC  X(45)      VALUE
   618             ' PREMIUM     COMMISSION        PREMIUM     CO'.
   619         16  FILLER          PIC  X(09)      VALUE
   620             'MMISSION'.
   621
   622*                                COPY ELCDATE.
   623******************************************************************
   624*                                                                *
   625*                                                                *
   626*                            ELCDATE.                            *
   627*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   628*                            VMOD=2.003
   629*                                                                *
   630*                                                                *
   631*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   632*                 LENGTH = 200                                   *
   633******************************************************************
   634
   635 01  DATE-CONVERSION-DATA.
   636     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   637     12  DC-OPTION-CODE                PIC X.
   638         88  BIN-TO-GREG                VALUE ' '.
   639         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   640         88  EDIT-GREG-TO-BIN           VALUE '2'.
   641         88  YMD-GREG-TO-BIN            VALUE '3'.
   642         88  MDY-GREG-TO-BIN            VALUE '4'.
   643         88  JULIAN-TO-BIN              VALUE '5'.
   644         88  BIN-PLUS-ELAPSED           VALUE '6'.
   645         88  FIND-CENTURY               VALUE '7'.
   646         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   647         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   648         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   649         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   650         88  JULIAN-TO-BIN-3            VALUE 'C'.
   651         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   652         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   653         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   654         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   655         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   656         88  CHECK-LEAP-YEAR            VALUE 'H'.
   657         88  BIN-3-TO-GREG              VALUE 'I'.
   658         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   659         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   660         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   661         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   662         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   663         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   664         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   665         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   666         88  THREE-CHARACTER-BIN
   667                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   668         88  GREGORIAN-TO-BIN
   669                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   670         88  BIN-TO-GREGORIAN
   671                  VALUES ' ' '1' 'I' '8' 'G'.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  15
* EL640.cbl
   672         88  JULIAN-TO-BINARY
   673                  VALUES '5' 'C' 'E' 'F'.
   674     12  DC-ERROR-CODE                 PIC X.
   675         88  NO-CONVERSION-ERROR        VALUE ' '.
   676         88  DATE-CONVERSION-ERROR
   677                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   678         88  DATE-IS-ZERO               VALUE '1'.
   679         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   680         88  DATE-IS-INVALID            VALUE '3'.
   681         88  DATE1-GREATER-DATE2        VALUE '4'.
   682         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   683         88  DATE-INVALID-OPTION        VALUE '9'.
   684         88  INVALID-CENTURY            VALUE 'A'.
   685         88  ONLY-CENTURY               VALUE 'B'.
   686         88  ONLY-LEAP-YEAR             VALUE 'C'.
   687         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   688     12  DC-END-OF-MONTH               PIC X.
   689         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   690     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   691         88  USE-NORMAL-PROCESS         VALUE ' '.
   692         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   693         88  ADJUST-UP-100-YRS          VALUE '2'.
   694     12  FILLER                        PIC X.
   695     12  DC-CONVERSION-DATES.
   696         16  DC-BIN-DATE-1             PIC XX.
   697         16  DC-BIN-DATE-2             PIC XX.
   698         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   699         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   700                       DC-GREG-DATE-1-EDIT.
   701             20  DC-EDIT1-MONTH        PIC 99.
   702             20  SLASH1-1              PIC X.
   703             20  DC-EDIT1-DAY          PIC 99.
   704             20  SLASH1-2              PIC X.
   705             20  DC-EDIT1-YEAR         PIC 99.
   706         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   707         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   708                     DC-GREG-DATE-2-EDIT.
   709             20  DC-EDIT2-MONTH        PIC 99.
   710             20  SLASH2-1              PIC X.
   711             20  DC-EDIT2-DAY          PIC 99.
   712             20  SLASH2-2              PIC X.
   713             20  DC-EDIT2-YEAR         PIC 99.
   714         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   715         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   716                     DC-GREG-DATE-1-YMD.
   717             20  DC-YMD-YEAR           PIC 99.
   718             20  DC-YMD-MONTH          PIC 99.
   719             20  DC-YMD-DAY            PIC 99.
   720         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   721         16  DC-GREG-DATE-1-MDY-R REDEFINES
   722                      DC-GREG-DATE-1-MDY.
   723             20  DC-MDY-MONTH          PIC 99.
   724             20  DC-MDY-DAY            PIC 99.
   725             20  DC-MDY-YEAR           PIC 99.
   726         16  DC-GREG-DATE-1-ALPHA.
   727             20  DC-ALPHA-MONTH        PIC X(10).
   728             20  DC-ALPHA-DAY          PIC 99.
   729             20  FILLER                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  16
* EL640.cbl
   730             20  DC-ALPHA-CENTURY.
   731                 24 DC-ALPHA-CEN-N     PIC 99.
   732             20  DC-ALPHA-YEAR         PIC 99.
   733         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   734         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   735         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   736         16  DC-JULIAN-DATE            PIC 9(05).
   737         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   738                                       PIC 9(05).
   739         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   740             20  DC-JULIAN-YEAR        PIC 99.
   741             20  DC-JULIAN-DAYS        PIC 999.
   742         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   743         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   744         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   745     12  DATE-CONVERSION-VARIBLES.
   746         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   747         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   748             20  FILLER                PIC 9(3).
   749             20  HOLD-CEN-1-CCYY.
   750                 24  HOLD-CEN-1-CC     PIC 99.
   751                 24  HOLD-CEN-1-YY     PIC 99.
   752             20  HOLD-CEN-1-MO         PIC 99.
   753             20  HOLD-CEN-1-DA         PIC 99.
   754         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   755             20  HOLD-CEN-1-R-MO       PIC 99.
   756             20  HOLD-CEN-1-R-DA       PIC 99.
   757             20  HOLD-CEN-1-R-CCYY.
   758                 24  HOLD-CEN-1-R-CC   PIC 99.
   759                 24  HOLD-CEN-1-R-YY   PIC 99.
   760             20  FILLER                PIC 9(3).
   761         16  HOLD-CENTURY-1-X.
   762             20  FILLER                PIC X(3)  VALUE SPACES.
   763             20  HOLD-CEN-1-X-CCYY.
   764                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   765                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   766             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   767             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   768         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   769             20  HOLD-CEN-1-R-X-MO     PIC XX.
   770             20  HOLD-CEN-1-R-X-DA     PIC XX.
   771             20  HOLD-CEN-1-R-X-CCYY.
   772                 24  HOLD-CEN-1-R-X-CC PIC XX.
   773                 24  HOLD-CEN-1-R-X-YY PIC XX.
   774             20  FILLER                PIC XXX.
   775         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   776         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   777         16  DC-JULIAN-DATE-1          PIC 9(07).
   778         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   779             20  DC-JULIAN-1-CCYY.
   780                 24  DC-JULIAN-1-CC    PIC 99.
   781                 24  DC-JULIAN-1-YR    PIC 99.
   782             20  DC-JULIAN-DA-1        PIC 999.
   783         16  DC-JULIAN-DATE-2          PIC 9(07).
   784         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   785             20  DC-JULIAN-2-CCYY.
   786                 24  DC-JULIAN-2-CC    PIC 99.
   787                 24  DC-JULIAN-2-YR    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  17
* EL640.cbl
   788             20  DC-JULIAN-DA-2        PIC 999.
   789         16  DC-GREG-DATE-A-EDIT.
   790             20  DC-EDITA-MONTH        PIC 99.
   791             20  SLASHA-1              PIC X VALUE '/'.
   792             20  DC-EDITA-DAY          PIC 99.
   793             20  SLASHA-2              PIC X VALUE '/'.
   794             20  DC-EDITA-CCYY.
   795                 24  DC-EDITA-CENT     PIC 99.
   796                 24  DC-EDITA-YEAR     PIC 99.
   797         16  DC-GREG-DATE-B-EDIT.
   798             20  DC-EDITB-MONTH        PIC 99.
   799             20  SLASHB-1              PIC X VALUE '/'.
   800             20  DC-EDITB-DAY          PIC 99.
   801             20  SLASHB-2              PIC X VALUE '/'.
   802             20  DC-EDITB-CCYY.
   803                 24  DC-EDITB-CENT     PIC 99.
   804                 24  DC-EDITB-YEAR     PIC 99.
   805         16  DC-GREG-DATE-CYMD         PIC 9(08).
   806         16  DC-GREG-DATE-CYMD-R REDEFINES
   807                              DC-GREG-DATE-CYMD.
   808             20  DC-CYMD-CEN           PIC 99.
   809             20  DC-CYMD-YEAR          PIC 99.
   810             20  DC-CYMD-MONTH         PIC 99.
   811             20  DC-CYMD-DAY           PIC 99.
   812         16  DC-GREG-DATE-MDCY         PIC 9(08).
   813         16  DC-GREG-DATE-MDCY-R REDEFINES
   814                              DC-GREG-DATE-MDCY.
   815             20  DC-MDCY-MONTH         PIC 99.
   816             20  DC-MDCY-DAY           PIC 99.
   817             20  DC-MDCY-CEN           PIC 99.
   818             20  DC-MDCY-YEAR          PIC 99.
   819    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   820        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   821    12  DC-EL310-DATE                  PIC X(21).
   822    12  FILLER                         PIC X(28).
   823*                                COPY ELCLOGOF.
   824******************************************************************
   825*                                                                *
   826*                                                                *
   827*                            ELCLOGOF.                           *
   828*                            VMOD=2.001                          *
   829*                                                                *
   830*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   831*                                                                *
   832******************************************************************
   833 01  CLASIC-LOGOFF.
   834     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   835     12  LOGOFF-TEXT.
   836         16  FILLER          PIC X(5)    VALUE SPACES.
   837         16  LOGOFF-MSG.
   838             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   839             20  FILLER      PIC X       VALUE SPACES.
   840             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   841         16  FILLER          PIC X(80)
   842           VALUE '* YOU ARE NOW LOGGED OFF'.
   843         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   844         16  FILLER          PIC X       VALUE QUOTE.
   845         16  LOGOFF-SYS-MSG  PIC X(17)
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  18
* EL640.cbl
   846           VALUE 'S CLAS-IC SYSTEM '.
   847     12  TEXT-MESSAGES.
   848         16  UNACCESS-MSG    PIC X(29)
   849             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   850         16  PGMIDERR-MSG    PIC X(17)
   851             VALUE 'PROGRAM NOT FOUND'.
   852*                                COPY ELCATTR.
   853******************************************************************
   854*                                                                *
   855*                            ELCATTR.                            *
   856*                            VMOD=2.001                          *
   857*                                                                *
   858*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   859*                                                                *
   860*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   861*                                                                *
   862*                   POS 1   P=PROTECTED                          *
   863*                           U=UNPROTECTED                        *
   864*                           S=ASKIP                              *
   865*                   POS 2   A=ALPHA/NUMERIC                      *
   866*                           N=NUMERIC                            *
   867*                   POS 3   N=NORMAL                             *
   868*                           B=BRIGHT                             *
   869*                           D=DARK                               *
   870*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   871*                           OF=MODIFIED DATA TAG OFF             *
   872*                                                                *
   873*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   874******************************************************************
   875 01  ATTRIBUTE-LIST.
   876     12  AL-PABOF            PIC X       VALUE 'Y'.
   877     12  AL-PABON            PIC X       VALUE 'Z'.
   878     12  AL-PADOF            PIC X       VALUE '%'.
   879     12  AL-PADON            PIC X       VALUE '_'.
   880     12  AL-PANOF            PIC X       VALUE '-'.
   881     12  AL-PANON            PIC X       VALUE '/'.
   882     12  AL-SABOF            PIC X       VALUE '8'.
   883     12  AL-SABON            PIC X       VALUE '9'.
   884     12  AL-SADOF            PIC X       VALUE '@'.
   885     12  AL-SADON            PIC X       VALUE QUOTE.
   886     12  AL-SANOF            PIC X       VALUE '0'.
   887     12  AL-SANON            PIC X       VALUE '1'.
   888     12  AL-UABOF            PIC X       VALUE 'H'.
   889     12  AL-UABON            PIC X       VALUE 'I'.
   890     12  AL-UADOF            PIC X       VALUE '<'.
   891     12  AL-UADON            PIC X       VALUE '('.
   892     12  AL-UANOF            PIC X       VALUE ' '.
   893     12  AL-UANON            PIC X       VALUE 'A'.
   894     12  AL-UNBOF            PIC X       VALUE 'Q'.
   895     12  AL-UNBON            PIC X       VALUE 'R'.
   896     12  AL-UNDOF            PIC X       VALUE '*'.
   897     12  AL-UNDON            PIC X       VALUE ')'.
   898     12  AL-UNNOF            PIC X       VALUE '&'.
   899     12  AL-UNNON            PIC X       VALUE 'J'.
   900*                                COPY ELCEMIB.
   901******************************************************************
   902*                                                                *
   903*                                                                *
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  19
* EL640.cbl
   904*                            ELCEMIB.                            *
   905*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   906*                            VMOD=2.005                          *
   907*                                                                *
   908*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   909*                                                                *
   910******************************************************************
   911 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   912     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   913     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   914     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   915     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   916     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   917     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   918     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   919     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   920     12  EMI-SWITCH1             PIC X        VALUE '1'.
   921         88  EMI-NO-ERRORS                    VALUE '1'.
   922         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   923         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   924     12  EMI-SWITCH2             PIC X        VALUE '1'.
   925         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   926     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   927         88  EMI-AREA1-EMPTY                  VALUE '1'.
   928         88  EMI-AREA1-FULL                   VALUE '2'.
   929     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   930         88  EMI-AREA2-EMPTY                  VALUE '1'.
   931         88  EMI-AREA2-FULL                   VALUE '2'.
   932     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   933         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   934         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   935         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   936         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   937         88  EMI-BYPASS-FATALS                VALUE 'X'.
   938     12  EMI-ERROR-LINES.
   939         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   940         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   941         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   942         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   943             20  EMI-ERR-CODES OCCURS 10 TIMES.
   944                 24  EMI-ERR-NUM         PIC X(4).
   945                 24  EMI-FILLER          PIC X.
   946                 24  EMI-SEV             PIC X.
   947                 24  FILLER              PIC X.
   948             20  FILLER                  PIC X(02).
   949     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   950         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   951             20  EMI-ERROR-NUMBER    PIC X(4).
   952             20  EMI-FILL            PIC X.
   953             20  EMI-SEVERITY        PIC X.
   954             20  FILLER              PIC X.
   955             20  EMI-ERROR-TEXT.
   956                 24  EMI-TEXT-VARIABLE   PIC X(10).
   957                 24  FILLER          PIC X(55).
   958     12  EMI-SEVERITY-SAVE           PIC X.
   959         88  EMI-NOTE                    VALUE 'N'.
   960         88  EMI-WARNING                 VALUE 'W'.
   961         88  EMI-FORCABLE                VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  20
* EL640.cbl
   962         88  EMI-FATAL                   VALUE 'X'.
   963     12  EMI-MESSAGE-FLAG            PIC X.
   964         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   965         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   966     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   967     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   968         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   969         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   970         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   971     12  emi-claim-no                pic x(7).
   972     12  emi-claim-type              pic x(6).
   973     12  FILLER                      PIC X(124)  VALUE SPACES.
   974     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   975     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   976     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   977     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   978*                                COPY ELCINTF.
   979******************************************************************
   980*                                                                *
   981*                                                                *
   982*                            ELCINTF.                            *
   983*                            VMOD=2.017                          *
   984*                                                                *
   985*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   986*                                                                *
   987*       LENGTH = 1024                                            *
   988*                                                                *
   989******************************************************************
   990*                   C H A N G E   L O G
   991*
   992* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   993*-----------------------------------------------------------------
   994*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   995* EFFECTIVE    NUMBER
   996*-----------------------------------------------------------------
   997* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   998******************************************************************
   999 01  PROGRAM-INTERFACE-BLOCK.
  1000     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1001     12  PI-CALLING-PROGRAM              PIC X(8).
  1002     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1003     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1004     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1005     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1006     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1007     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1008     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1009     12  PI-COMPANY-ID                   PIC XXX.
  1010     12  PI-COMPANY-CD                   PIC X.
  1011
  1012     12  PI-COMPANY-PASSWORD             PIC X(8).
  1013
  1014     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1015
  1016     12  PI-CONTROL-IN-PROGRESS.
  1017         16  PI-CARRIER                  PIC X.
  1018         16  PI-GROUPING                 PIC X(6).
  1019         16  PI-STATE                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  21
* EL640.cbl
  1020         16  PI-ACCOUNT                  PIC X(10).
  1021         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1022                                         PIC X(10).
  1023         16  PI-CLAIM-CERT-GRP.
  1024             20  PI-CLAIM-NO             PIC X(7).
  1025             20  PI-CERT-NO.
  1026                 25  PI-CERT-PRIME       PIC X(10).
  1027                 25  PI-CERT-SFX         PIC X.
  1028             20  PI-CERT-EFF-DT          PIC XX.
  1029         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1030             20  PI-PLAN-CODE            PIC X(2).
  1031             20  PI-REVISION-NUMBER      PIC X(3).
  1032             20  PI-PLAN-EFF-DT          PIC X(2).
  1033             20  PI-PLAN-EXP-DT          PIC X(2).
  1034             20  FILLER                  PIC X(11).
  1035         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1036             20  PI-OE-REFERENCE-1.
  1037                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1038                 25  PI-OE-REF-1-SUFF    PIC XX.
  1039
  1040     12  PI-SESSION-IN-PROGRESS          PIC X.
  1041         88  CLAIM-SESSION                   VALUE '1'.
  1042         88  CREDIT-SESSION                  VALUE '2'.
  1043         88  WARRANTY-SESSION                VALUE '3'.
  1044         88  MORTGAGE-SESSION                VALUE '4'.
  1045         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1046
  1047
  1048*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1049
  1050     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1051     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1052
  1053     12  PI-CREDIT-USER                  PIC X.
  1054         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1055         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1056
  1057     12  PI-CLAIM-USER                   PIC X.
  1058         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1059         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1060
  1061     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1062         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1063         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1064         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1065         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1066         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1067
  1068     12  PI-PROCESSOR-ID                 PIC X(4).
  1069
  1070     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1071
  1072     12  PI-MEMBER-CAPTION               PIC X(10).
  1073
  1074     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1075         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1076
  1077     12  PI-LIFE-OVERRIDE-L1             PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  22
* EL640.cbl
  1078     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1079     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1080     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1081
  1082     12  PI-AH-OVERRIDE-L1               PIC X.
  1083     12  PI-AH-OVERRIDE-L2               PIC XX.
  1084     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1085     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1086
  1087     12  PI-NEW-SYSTEM                   PIC X(2).
  1088
  1089     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1090     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1091         88  PI-USES-PAID-TO                 VALUE '1'.
  1092     12  PI-CRDTCRD-SYSTEM.
  1093         16  PI-CRDTCRD-USER             PIC X.
  1094             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1095             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1096         16  PI-CC-MONTH-END-DT          PIC XX.
  1097     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1098
  1099     12  PI-OE-REFERENCE-2.
  1100         16  PI-OE-REF-2-PRIME           PIC X(10).
  1101         16  PI-OE-REF-2-SUFF            PIC X.
  1102
  1103     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1104
  1105     12  PI-LANGUAGE-TYPE                PIC X.
  1106             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1107             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1108             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1109
  1110     12  PI-POLICY-LINKAGE-IND           PIC X.
  1111         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1112         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1113                                                   LOW-VALUES.
  1114
  1115     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1116     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1117         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1118         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1119
  1120     12  PI-PROCESSOR-CSR-IND            PIC X.
  1121         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1122         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1123
  1124     12  FILLER                          PIC X(3).
  1125
  1126     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1127
  1128     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1129         PI-SYSTEM-LEVEL.
  1130
  1131         16  PI-ENTRY-CODES.
  1132             20  PI-ENTRY-CD-1           PIC X.
  1133             20  PI-ENTRY-CD-2           PIC X.
  1134
  1135         16  PI-RETURN-CODES.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  23
* EL640.cbl
  1136             20  PI-RETURN-CD-1          PIC X.
  1137             20  PI-RETURN-CD-2          PIC X.
  1138
  1139         16  PI-UPDATE-STATUS-SAVE.
  1140             20  PI-UPDATE-BY            PIC X(4).
  1141             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1142
  1143         16  PI-LOWER-CASE-LETTERS       PIC X.
  1144             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1145
  1146*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1147*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1148*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1149
  1150         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1151             88  ST-ACCNT-CNTL               VALUE ' '.
  1152             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1153             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1154             88  ACCNT-CNTL                  VALUE '3'.
  1155             88  CARR-ACCNT-CNTL             VALUE '4'.
  1156
  1157         16  PI-PROCESSOR-CAP-LIST.
  1158             20  PI-SYSTEM-CONTROLS.
  1159                24 PI-SYSTEM-DISPLAY     PIC X.
  1160                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1161                24 PI-SYSTEM-MODIFY      PIC X.
  1162                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1163             20  FILLER                  PIC XX.
  1164             20  PI-DISPLAY-CAP          PIC X.
  1165                 88  DISPLAY-CAP             VALUE 'Y'.
  1166             20  PI-MODIFY-CAP           PIC X.
  1167                 88  MODIFY-CAP              VALUE 'Y'.
  1168             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1169                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1170             20  PI-FORCE-CAP            PIC X.
  1171                 88  FORCE-CAP               VALUE 'Y'.
  1172
  1173         16  PI-PROGRAM-CONTROLS.
  1174             20  PI-PGM-PRINT-OPT        PIC X.
  1175             20  PI-PGM-FORMAT-OPT       PIC X.
  1176             20  PI-PGM-PROCESS-OPT      PIC X.
  1177             20  PI-PGM-TOTALS-OPT       PIC X.
  1178
  1179         16  PI-HELP-INTERFACE.
  1180             20  PI-LAST-ERROR-NO        PIC X(4).
  1181             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1182
  1183         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1184             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1185
  1186         16  PI-CR-CONTROL-IN-PROGRESS.
  1187             20  PI-CR-CARRIER           PIC X.
  1188             20  PI-CR-GROUPING          PIC X(6).
  1189             20  PI-CR-STATE             PIC XX.
  1190             20  PI-CR-ACCOUNT           PIC X(10).
  1191             20  PI-CR-FIN-RESP          PIC X(10).
  1192             20  PI-CR-TYPE              PIC X.
  1193
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  24
* EL640.cbl
  1194         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1195
  1196         16  PI-CR-MONTH-END-DT          PIC XX.
  1197
  1198         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1199             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1200             88  PI-ZERO-CARRIER             VALUE '1'.
  1201             88  PI-ZERO-GROUPING            VALUE '2'.
  1202             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1203
  1204         16  PI-CARRIER-SECURITY         PIC X.
  1205             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1206
  1207         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1208             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1209             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1210
  1211         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1212             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1213                                         INDEXED BY PI-ACCESS-NDX
  1214                                         PIC X.
  1215
  1216         16  PI-GA-BILLING-CONTROL       PIC X.
  1217             88  PI-GA-BILLING               VALUE '1'.
  1218
  1219         16  PI-MAIL-PROCESSING          PIC X.
  1220             88  PI-MAIL-YES                 VALUE 'Y'.
  1221
  1222         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1223
  1224         16  PI-AR-SYSTEM.
  1225             20  PI-AR-PROCESSING-CNTL   PIC X.
  1226                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1227             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1228             20  PI-AR-MONTH-END-DT      PIC XX.
  1229
  1230         16  PI-MP-SYSTEM.
  1231             20  PI-MORTGAGE-USER            PIC X.
  1232                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1233                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1234             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1235                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1236                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1237                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1238                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1239                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1240             20  PI-MP-MONTH-END-DT          PIC XX.
  1241             20  PI-MP-REFERENCE-NO.
  1242                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1243                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1244
  1245         16  PI-LABEL-CONTROL            PIC X(01).
  1246             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1247             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1248
  1249         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1250             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1251
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  25
* EL640.cbl
  1252         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1253             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1254             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1255
  1256         16  FILLER                      PIC X(14).
  1257
  1258     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1259******************************************************************
  1260     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1261         16  PI-MAP-NAME         PIC X(8).
  1262         16  PI-ACCT-NAME        PIC X(30).
  1263         16  PI-SAV-REMIT-TO     PIC X(10).
  1264         16  PI-SAV-ACCT         PIC X(10).
  1265         16  PI-SAV-CARR         PIC X.
  1266         16  PI-SAV-GROUP        PIC X(6).
  1267         16  PI-SAV-STATE        PIC XX.
  1268         16  PI-SAV-EXP-DT       PIC XX.
  1269         16  PI-BAL-FRWD-GA      PIC S9(7)V99   COMP-3.
  1270         16  PI-BAL-FRWD         PIC S9(7)V99   COMP-3.
  1271         16  PI-PREMIUM          PIC S9(7)V99   COMP-3.
  1272         16  PI-REMITTED         PIC S9(7)V99   COMP-3.
  1273         16  PI-TOT-ISS-COMP     PIC S9(7)V99   COMP-3.
  1274         16  PI-TOT-CAN-COMP     PIC S9(7)V99   COMP-3.
  1275         16  PI-ADJUSTMENTS      PIC S9(7)V99   COMP-3.
  1276         16  PI-DISBURSED        PIC S9(7)V99   COMP-3.
  1277         16  PI-END-BAL          PIC S9(7)V99   COMP-3.
  1278         16  PI-LF-ISS-COMP      PIC S9(7)V99   COMP-3.
  1279         16  PI-AH-ISS-COMP      PIC S9(7)V99   COMP-3.
  1280         16  PI-LF-CAN-COMP      PIC S9(7)V99   COMP-3.
  1281         16  PI-AH-CAN-COMP      PIC S9(7)V99   COMP-3.
  1282         16  PI-LIMIT-BILLING-BTCHS.
  1283             20  PI-BILLING-BATCHES   OCCURS 3 TIMES
  1284                                 PIC X(6).
  1285         16  PI-BILL-TYPE        PIC X.
  1286             88  PI-PREV-BILL        VALUE '1'.
  1287             88  PI-PREV-REBILL      VALUE '2'.
  1288             88  PI-PREVIEW          VALUE '1' '2'.
  1289             88  PI-BILL             VALUE '3'.
  1290             88  PI-REBILLING        VALUE '4'.
  1291             88  PI-VOID-BILL        VALUE '5'.
  1292             88  PI-TOT-REBILL       VALUE '2' '4'.
  1293             88  PI-UPDATE-FILES     VALUE '3' '4' '5'.
  1294             88  PI-BILLING-FUNCTION VALUE '1' '2' '3' '4'.
  1295         16  PI-BILL-ERRS        PIC X.
  1296         16  PI-CHECK-SW         PIC X.
  1297             88  PI-CHECK-PRODUCED   VALUE 'Y'.
  1298         16  PI-DATA-BILLED-SW   PIC X.
  1299             88  PI-DATA-BILLED      VALUE 'Y'.
  1300         16  PI-MONTH-END-DATE.
  1301             20  PI-ME-MONTH     PIC 99.
  1302             20  FILLER          PIC X.
  1303             20  PI-ME-DAY       PIC 99.
  1304             20  FILLER          PIC X.
  1305             20  PI-ME-YEAR      PIC 99.
  1306         16  PI-BILLING-COUNTS.
  1307             20  FILLER OCCURS 6 TIMES INDEXED BY PINDX.
  1308                 24  PI-BATCH    PIC X(6).
  1309                 24  PI-BILLED   PIC 9(6)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  26
* EL640.cbl
  1310                 24  PI-PREV     PIC 9(6)  COMP-3.
  1311                 24  PI-NOBILL   PIC 9(6)  COMP-3.
  1312                 24  PI-PREM     PIC S9(7)V99   COMP-3.
  1313                 24  PI-COMM     PIC S9(7)V99   COMP-3.
  1314                 24  PI-NON-PREM PIC S9(7)V99   COMP-3.
  1315                 24  PI-NON-COMM PIC S9(7)V99   COMP-3.
  1316         16  PI-COMP-CONTROL.
  1317             20  PI-COMP-CARRIER     PIC X.
  1318             20  PI-COMP-GROUPING    PIC X(6).
  1319             20  PI-COMP-FIN-RESP    PIC X(10).
  1320         16  PI-SCRN-CONTROL.
  1321             20  PI-SCR-CARRIER      PIC X.
  1322             20  PI-SCR-GROUPING     PIC X(6).
  1323             20  PI-SCR-STATE        PIC X(02).
  1324             20  PI-SCR-ACCOUNT      PIC X(10).
  1325             20  PI-SCR-FIN-RESP     PIC X(10).
  1326             20  PI-SCR-TYPE         PIC X.
  1327         16  PI-TRANSFER-SW          PIC X.
  1328             88  PI-TRANSFER-BEFORE-ACT   VALUE 'Y'.
  1329         16  FILLER                  PIC X(200).
  1330
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  27
* EL640.cbl
  1332*                            COPY ELCJPFX.
  1333******************************************************************
  1334*                                                                *
  1335*                                                                *
  1336*                            ELCJPFX.                            *
  1337*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1338*                            VMOD=2.002                          *
  1339*                                                                *
  1340*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1341*                                                                *
  1342*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1343*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1344*        ELCNTL - CONTROL FILE                                   *
  1345*        ELMSTR - CLAIM MASTERS                                  *
  1346*        ELTRLR - ACTIVITY TRAILERS                              *
  1347*        ELCHKQ - CHECK QUE                                      *
  1348******************************************************************
  1349 01  JOURNAL-RECORD.
  1350     12  jp-date                     pic s9(5) comp-3.
  1351     12  jp-time                     pic s9(7) comp-3.
  1352     12  JP-USER-ID                  PIC X(4).
  1353     12  JP-FILE-ID                  PIC X(8).
  1354     12  JP-PROGRAM-ID               PIC X(8).
  1355     12  JP-RECORD-TYPE              PIC X.
  1356         88 JP-ADD              VALUE 'A'.
  1357         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1358         88 JP-AFTER-CHANGE     VALUE 'C'.
  1359         88 JP-DELETE           VALUE 'D'.
  1360         88 JP-GENERIC-DELETE   VALUE 'G'.
  1361         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1362         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1363     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1364     12  JP-RECORD-AREA
  1365
  1366
  1367                             PIC X(1464).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  28
* EL640.cbl
  1369*                            COPY ELCAID.
  1370******************************************************************
  1371*                                                                *
  1372*                            ELCAID.                             *
  1373*                            VMOD=2.001                          *
  1374*                                                                *
  1375*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1376*                                                                *
  1377*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1378*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1379******************************************************************
  1380
  1381 01  DFHAID.
  1382   02  DFHNULL   PIC  X  VALUE  ' '.
  1383   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1384   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1385   02  DFHPEN    PIC  X  VALUE  '='.
  1386   02  DFHOPID   PIC  X  VALUE  'W'.
  1387   02  DFHPA1    PIC  X  VALUE  '%'.
  1388   02  DFHPA2    PIC  X  VALUE  '>'.
  1389   02  DFHPA3    PIC  X  VALUE  ','.
  1390   02  DFHPF1    PIC  X  VALUE  '1'.
  1391   02  DFHPF2    PIC  X  VALUE  '2'.
  1392   02  DFHPF3    PIC  X  VALUE  '3'.
  1393   02  DFHPF4    PIC  X  VALUE  '4'.
  1394   02  DFHPF5    PIC  X  VALUE  '5'.
  1395   02  DFHPF6    PIC  X  VALUE  '6'.
  1396   02  DFHPF7    PIC  X  VALUE  '7'.
  1397   02  DFHPF8    PIC  X  VALUE  '8'.
  1398   02  DFHPF9    PIC  X  VALUE  '9'.
  1399   02  DFHPF10   PIC  X  VALUE  ':'.
  1400   02  DFHPF11   PIC  X  VALUE  '#'.
  1401   02  DFHPF12   PIC  X  VALUE  '@'.
  1402   02  DFHPF13   PIC  X  VALUE  'A'.
  1403   02  DFHPF14   PIC  X  VALUE  'B'.
  1404   02  DFHPF15   PIC  X  VALUE  'C'.
  1405   02  DFHPF16   PIC  X  VALUE  'D'.
  1406   02  DFHPF17   PIC  X  VALUE  'E'.
  1407   02  DFHPF18   PIC  X  VALUE  'F'.
  1408   02  DFHPF19   PIC  X  VALUE  'G'.
  1409   02  DFHPF20   PIC  X  VALUE  'H'.
  1410   02  DFHPF21   PIC  X  VALUE  'I'.
  1411*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1412   02  DFHPF22   PIC  X  VALUE  '['.
  1413   02  DFHPF23   PIC  X  VALUE  '.'.
  1414   02  DFHPF24   PIC  X  VALUE  '<'.
  1415   02  DFHMSRE   PIC  X  VALUE  'X'.
  1416   02  DFHSTRF   PIC  X  VALUE  'h'.
  1417   02  DFHTRIG   PIC  X  VALUE  '"'.
  1418 01  FILLER    REDEFINES DFHAID.
  1419     12  FILLER              PIC X(8).
  1420     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  29
* EL640.cbl
  1422*                                         COPY EL640S.
  1423 01  EL640AI.
  1424     05  FILLER            PIC  X(0012).
  1425*    -------------------------------
  1426     05  ADATEL PIC S9(0004) COMP.
  1427     05  ADATEF PIC  X(0001).
  1428     05  FILLER REDEFINES ADATEF.
  1429         10  ADATEA PIC  X(0001).
  1430     05  ADATEI PIC  X(0008).
  1431*    -------------------------------
  1432     05  ATIMEL PIC S9(0004) COMP.
  1433     05  ATIMEF PIC  X(0001).
  1434     05  FILLER REDEFINES ATIMEF.
  1435         10  ATIMEA PIC  X(0001).
  1436     05  ATIMEI PIC  X(0005).
  1437*    -------------------------------
  1438     05  CMPNYIDL PIC S9(0004) COMP.
  1439     05  CMPNYIDF PIC  X(0001).
  1440     05  FILLER REDEFINES CMPNYIDF.
  1441         10  CMPNYIDA PIC  X(0001).
  1442     05  CMPNYIDI PIC  X(0003).
  1443*    -------------------------------
  1444     05  USERIDL PIC S9(0004) COMP.
  1445     05  USERIDF PIC  X(0001).
  1446     05  FILLER REDEFINES USERIDF.
  1447         10  USERIDA PIC  X(0001).
  1448     05  USERIDI PIC  X(0004).
  1449*    -------------------------------
  1450     05  AACTNAML PIC S9(0004) COMP.
  1451     05  AACTNAMF PIC  X(0001).
  1452     05  FILLER REDEFINES AACTNAMF.
  1453         10  AACTNAMA PIC  X(0001).
  1454     05  AACTNAMI PIC  X(0030).
  1455*    -------------------------------
  1456     05  ACARHDGL PIC S9(0004) COMP.
  1457     05  ACARHDGF PIC  X(0001).
  1458     05  FILLER REDEFINES ACARHDGF.
  1459         10  ACARHDGA PIC  X(0001).
  1460     05  ACARHDGI PIC  X(0007).
  1461*    -------------------------------
  1462     05  AGRPHDGL PIC S9(0004) COMP.
  1463     05  AGRPHDGF PIC  X(0001).
  1464     05  FILLER REDEFINES AGRPHDGF.
  1465         10  AGRPHDGA PIC  X(0001).
  1466     05  AGRPHDGI PIC  X(0005).
  1467*    -------------------------------
  1468     05  ASTHDGL PIC S9(0004) COMP.
  1469     05  ASTHDGF PIC  X(0001).
  1470     05  FILLER REDEFINES ASTHDGF.
  1471         10  ASTHDGA PIC  X(0001).
  1472     05  ASTHDGI PIC  X(0005).
  1473*    -------------------------------
  1474     05  AACCTL PIC S9(0004) COMP.
  1475     05  AACCTF PIC  X(0001).
  1476     05  FILLER REDEFINES AACCTF.
  1477         10  AACCTA PIC  X(0001).
  1478     05  AACCTI PIC  X(0010).
  1479*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  30
* EL640.cbl
  1480     05  ACARIERL PIC S9(0004) COMP.
  1481     05  ACARIERF PIC  X(0001).
  1482     05  FILLER REDEFINES ACARIERF.
  1483         10  ACARIERA PIC  X(0001).
  1484     05  ACARIERI PIC  X(0001).
  1485*    -------------------------------
  1486     05  AGROUPL PIC S9(0004) COMP.
  1487     05  AGROUPF PIC  X(0001).
  1488     05  FILLER REDEFINES AGROUPF.
  1489         10  AGROUPA PIC  X(0001).
  1490     05  AGROUPI PIC  X(0006).
  1491*    -------------------------------
  1492     05  ASTATEL PIC S9(0004) COMP.
  1493     05  ASTATEF PIC  X(0001).
  1494     05  FILLER REDEFINES ASTATEF.
  1495         10  ASTATEA PIC  X(0001).
  1496     05  ASTATEI PIC  X(0002).
  1497*    -------------------------------
  1498     05  ABALFWDL PIC S9(0004) COMP.
  1499     05  ABALFWDF PIC  X(0001).
  1500     05  FILLER REDEFINES ABALFWDF.
  1501         10  ABALFWDA PIC  X(0001).
  1502     05  ABALFWDI PIC  X(0011).
  1503*    -------------------------------
  1504     05  APREMUML PIC S9(0004) COMP.
  1505     05  APREMUMF PIC  X(0001).
  1506     05  FILLER REDEFINES APREMUMF.
  1507         10  APREMUMA PIC  X(0001).
  1508     05  APREMUMI PIC  X(0011).
  1509*    -------------------------------
  1510     05  AHD1L PIC S9(0004) COMP.
  1511     05  AHD1F PIC  X(0001).
  1512     05  FILLER REDEFINES AHD1F.
  1513         10  AHD1A PIC  X(0001).
  1514     05  AHD1I PIC  X(0018).
  1515*    -------------------------------
  1516     05  AREMITL PIC S9(0004) COMP.
  1517     05  AREMITF PIC  X(0001).
  1518     05  FILLER REDEFINES AREMITF.
  1519         10  AREMITA PIC  X(0001).
  1520     05  AREMITI PIC  X(0011).
  1521*    -------------------------------
  1522     05  ABATCH1L PIC S9(0004) COMP.
  1523     05  ABATCH1F PIC  X(0001).
  1524     05  FILLER REDEFINES ABATCH1F.
  1525         10  ABATCH1A PIC  X(0001).
  1526     05  ABATCH1I PIC  X(0006).
  1527*    -------------------------------
  1528     05  ABILL1L PIC S9(0004) COMP.
  1529     05  ABILL1F PIC  X(0001).
  1530     05  FILLER REDEFINES ABILL1F.
  1531         10  ABILL1A PIC  X(0001).
  1532     05  ABILL1I PIC  X(0006).
  1533*    -------------------------------
  1534     05  APREV1L PIC S9(0004) COMP.
  1535     05  APREV1F PIC  X(0001).
  1536     05  FILLER REDEFINES APREV1F.
  1537         10  APREV1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  31
* EL640.cbl
  1538     05  APREV1I PIC  X(0006).
  1539*    -------------------------------
  1540     05  ANOBIL1L PIC S9(0004) COMP.
  1541     05  ANOBIL1F PIC  X(0001).
  1542     05  FILLER REDEFINES ANOBIL1F.
  1543         10  ANOBIL1A PIC  X(0001).
  1544     05  ANOBIL1I PIC  X(0006).
  1545*    -------------------------------
  1546     05  AHD2L PIC S9(0004) COMP.
  1547     05  AHD2F PIC  X(0001).
  1548     05  FILLER REDEFINES AHD2F.
  1549         10  AHD2A PIC  X(0001).
  1550     05  AHD2I PIC  X(0018).
  1551*    -------------------------------
  1552     05  ACOMPISL PIC S9(0004) COMP.
  1553     05  ACOMPISF PIC  X(0001).
  1554     05  FILLER REDEFINES ACOMPISF.
  1555         10  ACOMPISA PIC  X(0001).
  1556     05  ACOMPISI PIC  X(0011).
  1557*    -------------------------------
  1558     05  ABATCH2L PIC S9(0004) COMP.
  1559     05  ABATCH2F PIC  X(0001).
  1560     05  FILLER REDEFINES ABATCH2F.
  1561         10  ABATCH2A PIC  X(0001).
  1562     05  ABATCH2I PIC  X(0006).
  1563*    -------------------------------
  1564     05  ABILL2L PIC S9(0004) COMP.
  1565     05  ABILL2F PIC  X(0001).
  1566     05  FILLER REDEFINES ABILL2F.
  1567         10  ABILL2A PIC  X(0001).
  1568     05  ABILL2I PIC  X(0006).
  1569*    -------------------------------
  1570     05  APREV2L PIC S9(0004) COMP.
  1571     05  APREV2F PIC  X(0001).
  1572     05  FILLER REDEFINES APREV2F.
  1573         10  APREV2A PIC  X(0001).
  1574     05  APREV2I PIC  X(0006).
  1575*    -------------------------------
  1576     05  ANOBIL2L PIC S9(0004) COMP.
  1577     05  ANOBIL2F PIC  X(0001).
  1578     05  FILLER REDEFINES ANOBIL2F.
  1579         10  ANOBIL2A PIC  X(0001).
  1580     05  ANOBIL2I PIC  X(0006).
  1581*    -------------------------------
  1582     05  AHD3L PIC S9(0004) COMP.
  1583     05  AHD3F PIC  X(0001).
  1584     05  FILLER REDEFINES AHD3F.
  1585         10  AHD3A PIC  X(0001).
  1586     05  AHD3I PIC  X(0018).
  1587*    -------------------------------
  1588     05  ACOMCANL PIC S9(0004) COMP.
  1589     05  ACOMCANF PIC  X(0001).
  1590     05  FILLER REDEFINES ACOMCANF.
  1591         10  ACOMCANA PIC  X(0001).
  1592     05  ACOMCANI PIC  X(0011).
  1593*    -------------------------------
  1594     05  ABATCH3L PIC S9(0004) COMP.
  1595     05  ABATCH3F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  32
* EL640.cbl
  1596     05  FILLER REDEFINES ABATCH3F.
  1597         10  ABATCH3A PIC  X(0001).
  1598     05  ABATCH3I PIC  X(0006).
  1599*    -------------------------------
  1600     05  ABILL3L PIC S9(0004) COMP.
  1601     05  ABILL3F PIC  X(0001).
  1602     05  FILLER REDEFINES ABILL3F.
  1603         10  ABILL3A PIC  X(0001).
  1604     05  ABILL3I PIC  X(0006).
  1605*    -------------------------------
  1606     05  APREV3L PIC S9(0004) COMP.
  1607     05  APREV3F PIC  X(0001).
  1608     05  FILLER REDEFINES APREV3F.
  1609         10  APREV3A PIC  X(0001).
  1610     05  APREV3I PIC  X(0006).
  1611*    -------------------------------
  1612     05  ANOBIL3L PIC S9(0004) COMP.
  1613     05  ANOBIL3F PIC  X(0001).
  1614     05  FILLER REDEFINES ANOBIL3F.
  1615         10  ANOBIL3A PIC  X(0001).
  1616     05  ANOBIL3I PIC  X(0006).
  1617*    -------------------------------
  1618     05  AHD4L PIC S9(0004) COMP.
  1619     05  AHD4F PIC  X(0001).
  1620     05  FILLER REDEFINES AHD4F.
  1621         10  AHD4A PIC  X(0001).
  1622     05  AHD4I PIC  X(0018).
  1623*    -------------------------------
  1624     05  AADJUSTL PIC S9(0004) COMP.
  1625     05  AADJUSTF PIC  X(0001).
  1626     05  FILLER REDEFINES AADJUSTF.
  1627         10  AADJUSTA PIC  X(0001).
  1628     05  AADJUSTI PIC  X(0011).
  1629*    -------------------------------
  1630     05  ABATCH4L PIC S9(0004) COMP.
  1631     05  ABATCH4F PIC  X(0001).
  1632     05  FILLER REDEFINES ABATCH4F.
  1633         10  ABATCH4A PIC  X(0001).
  1634     05  ABATCH4I PIC  X(0006).
  1635*    -------------------------------
  1636     05  ABILL4L PIC S9(0004) COMP.
  1637     05  ABILL4F PIC  X(0001).
  1638     05  FILLER REDEFINES ABILL4F.
  1639         10  ABILL4A PIC  X(0001).
  1640     05  ABILL4I PIC  X(0006).
  1641*    -------------------------------
  1642     05  APREV4L PIC S9(0004) COMP.
  1643     05  APREV4F PIC  X(0001).
  1644     05  FILLER REDEFINES APREV4F.
  1645         10  APREV4A PIC  X(0001).
  1646     05  APREV4I PIC  X(0006).
  1647*    -------------------------------
  1648     05  ANOBIL4L PIC S9(0004) COMP.
  1649     05  ANOBIL4F PIC  X(0001).
  1650     05  FILLER REDEFINES ANOBIL4F.
  1651         10  ANOBIL4A PIC  X(0001).
  1652     05  ANOBIL4I PIC  X(0006).
  1653*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  33
* EL640.cbl
  1654     05  AHD5L PIC S9(0004) COMP.
  1655     05  AHD5F PIC  X(0001).
  1656     05  FILLER REDEFINES AHD5F.
  1657         10  AHD5A PIC  X(0001).
  1658     05  AHD5I PIC  X(0018).
  1659*    -------------------------------
  1660     05  ADISBURL PIC S9(0004) COMP.
  1661     05  ADISBURF PIC  X(0001).
  1662     05  FILLER REDEFINES ADISBURF.
  1663         10  ADISBURA PIC  X(0001).
  1664     05  ADISBURI PIC  X(0011).
  1665*    -------------------------------
  1666     05  ABATCH5L PIC S9(0004) COMP.
  1667     05  ABATCH5F PIC  X(0001).
  1668     05  FILLER REDEFINES ABATCH5F.
  1669         10  ABATCH5A PIC  X(0001).
  1670     05  ABATCH5I PIC  X(0006).
  1671*    -------------------------------
  1672     05  ABILL5L PIC S9(0004) COMP.
  1673     05  ABILL5F PIC  X(0001).
  1674     05  FILLER REDEFINES ABILL5F.
  1675         10  ABILL5A PIC  X(0001).
  1676     05  ABILL5I PIC  X(0006).
  1677*    -------------------------------
  1678     05  APREV5L PIC S9(0004) COMP.
  1679     05  APREV5F PIC  X(0001).
  1680     05  FILLER REDEFINES APREV5F.
  1681         10  APREV5A PIC  X(0001).
  1682     05  APREV5I PIC  X(0006).
  1683*    -------------------------------
  1684     05  ANOBIL5L PIC S9(0004) COMP.
  1685     05  ANOBIL5F PIC  X(0001).
  1686     05  FILLER REDEFINES ANOBIL5F.
  1687         10  ANOBIL5A PIC  X(0001).
  1688     05  ANOBIL5I PIC  X(0006).
  1689*    -------------------------------
  1690     05  AENDHDGL PIC S9(0004) COMP.
  1691     05  AENDHDGF PIC  X(0001).
  1692     05  FILLER REDEFINES AENDHDGF.
  1693         10  AENDHDGA PIC  X(0001).
  1694     05  AENDHDGI PIC  X(0018).
  1695*    -------------------------------
  1696     05  ANETDUEL PIC S9(0004) COMP.
  1697     05  ANETDUEF PIC  X(0001).
  1698     05  FILLER REDEFINES ANETDUEF.
  1699         10  ANETDUEA PIC  X(0001).
  1700     05  ANETDUEI PIC  X(0011).
  1701*    -------------------------------
  1702     05  ABATCH6L PIC S9(0004) COMP.
  1703     05  ABATCH6F PIC  X(0001).
  1704     05  FILLER REDEFINES ABATCH6F.
  1705         10  ABATCH6A PIC  X(0001).
  1706     05  ABATCH6I PIC  X(0006).
  1707*    -------------------------------
  1708     05  ABILL6L PIC S9(0004) COMP.
  1709     05  ABILL6F PIC  X(0001).
  1710     05  FILLER REDEFINES ABILL6F.
  1711         10  ABILL6A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  34
* EL640.cbl
  1712     05  ABILL6I PIC  X(0006).
  1713*    -------------------------------
  1714     05  APREV6L PIC S9(0004) COMP.
  1715     05  APREV6F PIC  X(0001).
  1716     05  FILLER REDEFINES APREV6F.
  1717         10  APREV6A PIC  X(0001).
  1718     05  APREV6I PIC  X(0006).
  1719*    -------------------------------
  1720     05  ANOBIL6L PIC S9(0004) COMP.
  1721     05  ANOBIL6F PIC  X(0001).
  1722     05  FILLER REDEFINES ANOBIL6F.
  1723         10  ANOBIL6A PIC  X(0001).
  1724     05  ANOBIL6I PIC  X(0006).
  1725*    -------------------------------
  1726     05  ABILTYPL PIC S9(0004) COMP.
  1727     05  ABILTYPF PIC  X(0001).
  1728     05  FILLER REDEFINES ABILTYPF.
  1729         10  ABILTYPA PIC  X(0001).
  1730     05  ABILTYPI PIC  X(0001).
  1731*    -------------------------------
  1732     05  APRODSWL PIC S9(0004) COMP.
  1733     05  APRODSWF PIC  X(0001).
  1734     05  FILLER REDEFINES APRODSWF.
  1735         10  APRODSWA PIC  X(0001).
  1736     05  APRODSWI PIC  X(0001).
  1737*    -------------------------------
  1738     05  ABILERRL PIC S9(0004) COMP.
  1739     05  ABILERRF PIC  X(0001).
  1740     05  FILLER REDEFINES ABILERRF.
  1741         10  ABILERRA PIC  X(0001).
  1742     05  ABILERRI PIC  X(0001).
  1743*    -------------------------------
  1744     05  ABTCH1L PIC S9(0004) COMP.
  1745     05  ABTCH1F PIC  X(0001).
  1746     05  FILLER REDEFINES ABTCH1F.
  1747         10  ABTCH1A PIC  X(0001).
  1748     05  ABTCH1I PIC  X(0006).
  1749*    -------------------------------
  1750     05  ABTCH2L PIC S9(0004) COMP.
  1751     05  ABTCH2F PIC  X(0001).
  1752     05  FILLER REDEFINES ABTCH2F.
  1753         10  ABTCH2A PIC  X(0001).
  1754     05  ABTCH2I PIC  X(0006).
  1755*    -------------------------------
  1756     05  ABTCH3L PIC S9(0004) COMP.
  1757     05  ABTCH3F PIC  X(0001).
  1758     05  FILLER REDEFINES ABTCH3F.
  1759         10  ABTCH3A PIC  X(0001).
  1760     05  ABTCH3I PIC  X(0006).
  1761*    -------------------------------
  1762     05  AERMSG1L PIC S9(0004) COMP.
  1763     05  AERMSG1F PIC  X(0001).
  1764     05  FILLER REDEFINES AERMSG1F.
  1765         10  AERMSG1A PIC  X(0001).
  1766     05  AERMSG1I PIC  X(0076).
  1767*    -------------------------------
  1768     05  AERMSG2L PIC S9(0004) COMP.
  1769     05  AERMSG2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  35
* EL640.cbl
  1770     05  FILLER REDEFINES AERMSG2F.
  1771         10  AERMSG2A PIC  X(0001).
  1772     05  AERMSG2I PIC  X(0076).
  1773*    -------------------------------
  1774     05  APFNTERL PIC S9(0004) COMP.
  1775     05  APFNTERF PIC  X(0001).
  1776     05  FILLER REDEFINES APFNTERF.
  1777         10  APFNTERA PIC  X(0001).
  1778     05  APFNTERI PIC  9(2).
  1779*    -------------------------------
  1780     05  APF5HDGL PIC S9(0004) COMP.
  1781     05  APF5HDGF PIC  X(0001).
  1782     05  FILLER REDEFINES APF5HDGF.
  1783         10  APF5HDGA PIC  X(0001).
  1784     05  APF5HDGI PIC  X(0020).
  1785*    -------------------------------
  1786     05  AGAHDGL PIC S9(0004) COMP.
  1787     05  AGAHDGF PIC  X(0001).
  1788     05  FILLER REDEFINES AGAHDGF.
  1789         10  AGAHDGA PIC  X(0001).
  1790     05  AGAHDGI PIC  X(0025).
  1791 01  EL640AO REDEFINES EL640AI.
  1792     05  FILLER            PIC  X(0012).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  ADATEO PIC  X(0008).
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  ATIMEO PIC  99.99.
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  CMPNYIDO PIC  X(0003).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  USERIDO PIC  X(0004).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  AACTNAMO PIC  X(0030).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  ACARHDGO PIC  X(0007).
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  AGRPHDGO PIC  X(0005).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  ASTHDGO PIC  X(0005).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  AACCTO PIC  X(0010).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  ACARIERO PIC  X(0001).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  AGROUPO PIC  X(0006).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  36
* EL640.cbl
  1828     05  ASTATEO PIC  X(0002).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  ABALFWDO PIC  ZZZZZZ9.99-.
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  APREMUMO PIC  ZZZZZZ9.99-.
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  AHD1O PIC  X(0018).
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  AREMITO PIC  ZZZZZZ9.99-.
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  ABATCH1O PIC  X(0006).
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  ABILL1O PIC  Z(5)9.
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  APREV1O PIC  Z(5)9.
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  ANOBIL1O PIC  Z(5)9.
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  AHD2O PIC  X(0018).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  ACOMPISO PIC  ZZZZZZ9.99-.
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  ABATCH2O PIC  X(0006).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  ABILL2O PIC  Z(5)9.
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  APREV2O PIC  Z(5)9.
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
  1870     05  ANOBIL2O PIC  Z(5)9.
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  AHD3O PIC  X(0018).
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  ACOMCANO PIC  ZZZZZZ9.99-.
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  ABATCH3O PIC  X(0006).
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  ABILL3O PIC  Z(5)9.
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  APREV3O PIC  Z(5)9.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  37
* EL640.cbl
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
  1888     05  ANOBIL3O PIC  Z(5)9.
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  AHD4O PIC  X(0018).
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  AADJUSTO PIC  ZZZZZZ9.99-.
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  ABATCH4O PIC  X(0006).
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  ABILL4O PIC  Z(5)9.
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  APREV4O PIC  Z(5)9.
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  ANOBIL4O PIC  Z(5)9.
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  AHD5O PIC  X(0018).
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  ADISBURO PIC  ZZZZZZ9.99-.
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  ABATCH5O PIC  X(0006).
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  ABILL5O PIC  Z(5)9.
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  APREV5O PIC  Z(5)9.
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  ANOBIL5O PIC  Z(5)9.
  1925*    -------------------------------
  1926     05  FILLER            PIC  X(0003).
  1927     05  AENDHDGO PIC  X(0018).
  1928*    -------------------------------
  1929     05  FILLER            PIC  X(0003).
  1930     05  ANETDUEO PIC  ZZZZZZ9.99-.
  1931*    -------------------------------
  1932     05  FILLER            PIC  X(0003).
  1933     05  ABATCH6O PIC  X(0006).
  1934*    -------------------------------
  1935     05  FILLER            PIC  X(0003).
  1936     05  ABILL6O PIC  Z(5)9.
  1937*    -------------------------------
  1938     05  FILLER            PIC  X(0003).
  1939     05  APREV6O PIC  Z(5)9.
  1940*    -------------------------------
  1941     05  FILLER            PIC  X(0003).
  1942     05  ANOBIL6O PIC  Z(5)9.
  1943*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  38
* EL640.cbl
  1944     05  FILLER            PIC  X(0003).
  1945     05  ABILTYPO PIC  X(0001).
  1946*    -------------------------------
  1947     05  FILLER            PIC  X(0003).
  1948     05  APRODSWO PIC  X(0001).
  1949*    -------------------------------
  1950     05  FILLER            PIC  X(0003).
  1951     05  ABILERRO PIC  X(0001).
  1952*    -------------------------------
  1953     05  FILLER            PIC  X(0003).
  1954     05  ABTCH1O PIC  X(0006).
  1955*    -------------------------------
  1956     05  FILLER            PIC  X(0003).
  1957     05  ABTCH2O PIC  X(0006).
  1958*    -------------------------------
  1959     05  FILLER            PIC  X(0003).
  1960     05  ABTCH3O PIC  X(0006).
  1961*    -------------------------------
  1962     05  FILLER            PIC  X(0003).
  1963     05  AERMSG1O PIC  X(0076).
  1964*    -------------------------------
  1965     05  FILLER            PIC  X(0003).
  1966     05  AERMSG2O PIC  X(0076).
  1967*    -------------------------------
  1968     05  FILLER            PIC  X(0003).
  1969     05  APFNTERO PIC  99.
  1970*    -------------------------------
  1971     05  FILLER            PIC  X(0003).
  1972     05  APF5HDGO PIC  X(0020).
  1973*    -------------------------------
  1974     05  FILLER            PIC  X(0003).
  1975     05  AGAHDGO PIC  X(0025).
  1976*    -------------------------------
  1977 01  EL640BI REDEFINES EL640AI.
  1978     05  FILLER            PIC  X(0012).
  1979*    -------------------------------
  1980     05  BDATEL PIC S9(0004) COMP.
  1981     05  BDATEF PIC  X(0001).
  1982     05  FILLER REDEFINES BDATEF.
  1983         10  BDATEA PIC  X(0001).
  1984     05  BDATEI PIC  X(0008).
  1985*    -------------------------------
  1986     05  BTIMEL PIC S9(0004) COMP.
  1987     05  BTIMEF PIC  X(0001).
  1988     05  FILLER REDEFINES BTIMEF.
  1989         10  BTIMEA PIC  X(0001).
  1990     05  BTIMEI PIC  X(0005).
  1991*    -------------------------------
  1992     05  BCMPNYL PIC S9(0004) COMP.
  1993     05  BCMPNYF PIC  X(0001).
  1994     05  FILLER REDEFINES BCMPNYF.
  1995         10  BCMPNYA PIC  X(0001).
  1996     05  BCMPNYI PIC  X(0003).
  1997*    -------------------------------
  1998     05  BUSERIDL PIC S9(0004) COMP.
  1999     05  BUSERIDF PIC  X(0001).
  2000     05  FILLER REDEFINES BUSERIDF.
  2001         10  BUSERIDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  39
* EL640.cbl
  2002     05  BUSERIDI PIC  X(0004).
  2003*    -------------------------------
  2004     05  BCHKNOL PIC S9(0004) COMP.
  2005     05  BCHKNOF PIC  X(0001).
  2006     05  FILLER REDEFINES BCHKNOF.
  2007         10  BCHKNOA PIC  X(0001).
  2008     05  BCHKNOI PIC  9(6).
  2009*    -------------------------------
  2010     05  BNAMEL PIC S9(0004) COMP.
  2011     05  BNAMEF PIC  X(0001).
  2012     05  FILLER REDEFINES BNAMEF.
  2013         10  BNAMEA PIC  X(0001).
  2014     05  BNAMEI PIC  X(0029).
  2015*    -------------------------------
  2016     05  BCHKAMTL PIC S9(0004) COMP.
  2017     05  BCHKAMTF PIC  X(0001).
  2018     05  FILLER REDEFINES BCHKAMTF.
  2019         10  BCHKAMTA PIC  X(0001).
  2020     05  BCHKAMTI PIC  S9(9)V99.
  2021*    -------------------------------
  2022     05  BADDR1L PIC S9(0004) COMP.
  2023     05  BADDR1F PIC  X(0001).
  2024     05  FILLER REDEFINES BADDR1F.
  2025         10  BADDR1A PIC  X(0001).
  2026     05  BADDR1I PIC  X(0029).
  2027*    -------------------------------
  2028     05  BADDR2L PIC S9(0004) COMP.
  2029     05  BADDR2F PIC  X(0001).
  2030     05  FILLER REDEFINES BADDR2F.
  2031         10  BADDR2A PIC  X(0001).
  2032     05  BADDR2I PIC  X(0029).
  2033*    -------------------------------
  2034     05  BPAYDT1L PIC S9(0004) COMP.
  2035     05  BPAYDT1F PIC  X(0001).
  2036     05  FILLER REDEFINES BPAYDT1F.
  2037         10  BPAYDT1A PIC  X(0001).
  2038     05  BPAYDT1I PIC  X(0008).
  2039*    -------------------------------
  2040     05  BCITYSTL PIC S9(0004) COMP.
  2041     05  BCITYSTF PIC  X(0001).
  2042     05  FILLER REDEFINES BCITYSTF.
  2043         10  BCITYSTA PIC  X(0001).
  2044     05  BCITYSTI PIC  X(0029).
  2045*    -------------------------------
  2046     05  BPAYDT2L PIC S9(0004) COMP.
  2047     05  BPAYDT2F PIC  X(0001).
  2048     05  FILLER REDEFINES BPAYDT2F.
  2049         10  BPAYDT2A PIC  X(0001).
  2050     05  BPAYDT2I PIC  X(0008).
  2051*    -------------------------------
  2052     05  BZIPL PIC S9(0004) COMP.
  2053     05  BZIPF PIC  X(0001).
  2054     05  FILLER REDEFINES BZIPF.
  2055         10  BZIPA PIC  X(0001).
  2056     05  BZIPI PIC  X(0010).
  2057*    -------------------------------
  2058     05  BACCNAML PIC S9(0004) COMP.
  2059     05  BACCNAMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  40
* EL640.cbl
  2060     05  FILLER REDEFINES BACCNAMF.
  2061         10  BACCNAMA PIC  X(0001).
  2062     05  BACCNAMI PIC  X(0030).
  2063*    -------------------------------
  2064     05  BACCTL PIC S9(0004) COMP.
  2065     05  BACCTF PIC  X(0001).
  2066     05  FILLER REDEFINES BACCTF.
  2067         10  BACCTA PIC  X(0001).
  2068     05  BACCTI PIC  X(0010).
  2069*    -------------------------------
  2070     05  BCARIERL PIC S9(0004) COMP.
  2071     05  BCARIERF PIC  X(0001).
  2072     05  FILLER REDEFINES BCARIERF.
  2073         10  BCARIERA PIC  X(0001).
  2074     05  BCARIERI PIC  X(0001).
  2075*    -------------------------------
  2076     05  BGROUPL PIC S9(0004) COMP.
  2077     05  BGROUPF PIC  X(0001).
  2078     05  FILLER REDEFINES BGROUPF.
  2079         10  BGROUPA PIC  X(0001).
  2080     05  BGROUPI PIC  X(0006).
  2081*    -------------------------------
  2082     05  BSTATEL PIC S9(0004) COMP.
  2083     05  BSTATEF PIC  X(0001).
  2084     05  FILLER REDEFINES BSTATEF.
  2085         10  BSTATEA PIC  X(0001).
  2086     05  BSTATEI PIC  X(0002).
  2087*    -------------------------------
  2088     05  BFORM1L PIC S9(0004) COMP.
  2089     05  BFORM1F PIC  X(0001).
  2090     05  FILLER REDEFINES BFORM1F.
  2091         10  BFORM1A PIC  X(0001).
  2092     05  BFORM1I PIC  X(0004).
  2093*    -------------------------------
  2094     05  BFORM2L PIC S9(0004) COMP.
  2095     05  BFORM2F PIC  X(0001).
  2096     05  FILLER REDEFINES BFORM2F.
  2097         10  BFORM2A PIC  X(0001).
  2098     05  BFORM2I PIC  X(0004).
  2099*    -------------------------------
  2100     05  BFORM3L PIC S9(0004) COMP.
  2101     05  BFORM3F PIC  X(0001).
  2102     05  FILLER REDEFINES BFORM3F.
  2103         10  BFORM3A PIC  X(0001).
  2104     05  BFORM3I PIC  X(0004).
  2105*    -------------------------------
  2106     05  BALAMTL PIC S9(0004) COMP.
  2107     05  BALAMTF PIC  X(0001).
  2108     05  FILLER REDEFINES BALAMTF.
  2109         10  BALAMTA PIC  X(0001).
  2110     05  BALAMTI PIC  X(0011).
  2111*    -------------------------------
  2112     05  BERMSGL PIC S9(0004) COMP.
  2113     05  BERMSGF PIC  X(0001).
  2114     05  FILLER REDEFINES BERMSGF.
  2115         10  BERMSGA PIC  X(0001).
  2116     05  BERMSGI PIC  X(0078).
  2117*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  41
* EL640.cbl
  2118     05  BPFNTERL PIC S9(0004) COMP.
  2119     05  BPFNTERF PIC  X(0001).
  2120     05  FILLER REDEFINES BPFNTERF.
  2121         10  BPFNTERA PIC  X(0001).
  2122     05  BPFNTERI PIC  9(2).
  2123 01  EL640BO REDEFINES EL640AI.
  2124     05  FILLER            PIC  X(0012).
  2125*    -------------------------------
  2126     05  FILLER            PIC  X(0003).
  2127     05  BDATEO PIC  X(0008).
  2128*    -------------------------------
  2129     05  FILLER            PIC  X(0003).
  2130     05  BTIMEO PIC  99.99.
  2131*    -------------------------------
  2132     05  FILLER            PIC  X(0003).
  2133     05  BCMPNYO PIC  X(0003).
  2134*    -------------------------------
  2135     05  FILLER            PIC  X(0003).
  2136     05  BUSERIDO PIC  X(0004).
  2137*    -------------------------------
  2138     05  FILLER            PIC  X(0003).
  2139     05  BCHKNOO PIC  X(0006).
  2140*    -------------------------------
  2141     05  FILLER            PIC  X(0003).
  2142     05  BNAMEO PIC  X(0029).
  2143*    -------------------------------
  2144     05  FILLER            PIC  X(0003).
  2145     05  BCHKAMTO PIC  Z(7).ZZ-.
  2146*    -------------------------------
  2147     05  FILLER            PIC  X(0003).
  2148     05  BADDR1O PIC  X(0029).
  2149*    -------------------------------
  2150     05  FILLER            PIC  X(0003).
  2151     05  BADDR2O PIC  X(0029).
  2152*    -------------------------------
  2153     05  FILLER            PIC  X(0003).
  2154     05  BPAYDT1O PIC  X(0008).
  2155*    -------------------------------
  2156     05  FILLER            PIC  X(0003).
  2157     05  BCITYSTO PIC  X(0029).
  2158*    -------------------------------
  2159     05  FILLER            PIC  X(0003).
  2160     05  BPAYDT2O PIC  X(0008).
  2161*    -------------------------------
  2162     05  FILLER            PIC  X(0003).
  2163     05  BZIPO PIC  X(0010).
  2164*    -------------------------------
  2165     05  FILLER            PIC  X(0003).
  2166     05  BACCNAMO PIC  X(0030).
  2167*    -------------------------------
  2168     05  FILLER            PIC  X(0003).
  2169     05  BACCTO PIC  X(0010).
  2170*    -------------------------------
  2171     05  FILLER            PIC  X(0003).
  2172     05  BCARIERO PIC  X(0001).
  2173*    -------------------------------
  2174     05  FILLER            PIC  X(0003).
  2175     05  BGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  42
* EL640.cbl
  2176*    -------------------------------
  2177     05  FILLER            PIC  X(0003).
  2178     05  BSTATEO PIC  X(0002).
  2179*    -------------------------------
  2180     05  FILLER            PIC  X(0003).
  2181     05  BFORM1O PIC  X(0004).
  2182*    -------------------------------
  2183     05  FILLER            PIC  X(0003).
  2184     05  BFORM2O PIC  X(0004).
  2185*    -------------------------------
  2186     05  FILLER            PIC  X(0003).
  2187     05  BFORM3O PIC  X(0004).
  2188*    -------------------------------
  2189     05  FILLER            PIC  X(0003).
  2190     05  BALAMTO PIC  Z(7).99-.
  2191*    -------------------------------
  2192     05  FILLER            PIC  X(0003).
  2193     05  BERMSGO PIC  X(0078).
  2194*    -------------------------------
  2195     05  FILLER            PIC  X(0003).
  2196     05  BPFNTERO PIC  9(2).
  2197*    -------------------------------
  2198 01  MAP-A REDEFINES EL640AO.
  2199     12  FILLER                  PIC X(162).
  2200     12  FILLER OCCURS 6 TIMES INDEXED BY ANDX.
  2201         16  FILLER              PIC X(35).
  2202         16  BATCH-LEN           PIC S9(4)   COMP.
  2203         16  BATCH-ATTRB         PIC X.
  2204         16  BATCH               PIC X(6).
  2205         16  BILL-LEN            PIC S9(4)   COMP.
  2206         16  BILL-ATTRB          PIC X.
  2207         16  BILL                PIC Z(6).
  2208         16  PREV-LEN            PIC S9(4)   COMP.
  2209         16  PREV-ATTRB          PIC X.
  2210         16  PREV                PIC Z(6).
  2211         16  NOBILL-LEN          PIC S9(4)   COMP.
  2212         16  NOBILL-ATTRB        PIC X.
  2213         16  NOBILL              PIC Z(6).
  2214****************************************************************
  2215*
  2216* Copyright (c) 2007-2013 Dell Inc.
  2217* All rights reserved.
  2218*
  2219****************************************************************
  2220 01  DFHEIV.
  2221   02  DFHEIV0               PIC X(35).
  2222   02  DFHEIV1               PIC X(08).
  2223   02  DFHEIV2               PIC X(08).
  2224   02  DFHEIV3               PIC X(08).
  2225   02  DFHEIV4               PIC X(06).
  2226   02  DFHEIV5               PIC X(04).
  2227   02  DFHEIV6               PIC X(04).
  2228   02  DFHEIV7               PIC X(02).
  2229   02  DFHEIV8               PIC X(02).
  2230   02  DFHEIV9               PIC X(01).
  2231   02  DFHEIV10              PIC S9(7) COMP-3.
  2232   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2233   02  DFHEIV12              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  43
* EL640.cbl
  2234   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2235   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2236   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2237   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2238   02  DFHEIV17              PIC X(04).
  2239   02  DFHEIV18              PIC X(04).
  2240   02  DFHEIV19              PIC X(04).
  2241   02  DFHEIV20              USAGE IS POINTER.
  2242   02  DFHEIV21              USAGE IS POINTER.
  2243   02  DFHEIV22              USAGE IS POINTER.
  2244   02  DFHEIV23              USAGE IS POINTER.
  2245   02  DFHEIV24              USAGE IS POINTER.
  2246   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2247   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2248   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2249   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2250   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2251   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2252   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2253   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2254   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2255   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2256   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2257   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2258   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2259   02  FILLER                PIC X(02).
  2260   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2261   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2262   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2263   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2264   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2265   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2266   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2267 LINKAGE  SECTION.
  2268*****************************************************************
  2269*                                                               *
  2270* Copyright (c) 2007-2013 Dell Inc.                             *
  2271* All rights reserved.                                          *
  2272*                                                               *
  2273*****************************************************************
  2274 01  dfheiblk.
  2275     02  eibtime          pic s9(7) comp-3.
  2276     02  eibdate          pic s9(7) comp-3.
  2277     02  eibtrnid         pic x(4).
  2278     02  eibtaskn         pic s9(7) comp-3.
  2279     02  eibtrmid         pic x(4).
  2280     02  dfheigdi         pic s9(4) comp.
  2281     02  eibcposn         pic s9(4) comp.
  2282     02  eibcalen         pic s9(4) comp.
  2283     02  eibaid           pic x(1).
  2284     02  eibfiller1       pic x(1).
  2285     02  eibfn            pic x(2).
  2286     02  eibfiller2       pic x(2).
  2287     02  eibrcode         pic x(6).
  2288     02  eibfiller3       pic x(2).
  2289     02  eibds            pic x(8).
  2290     02  eibreqid         pic x(8).
  2291     02  eibrsrce         pic x(8).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  44
* EL640.cbl
  2292     02  eibsync          pic x(1).
  2293     02  eibfree          pic x(1).
  2294     02  eibrecv          pic x(1).
  2295     02  eibsend          pic x(1).
  2296     02  eibatt           pic x(1).
  2297     02  eibeoc           pic x(1).
  2298     02  eibfmh           pic x(1).
  2299     02  eibcompl         pic x(1).
  2300     02  eibsig           pic x(1).
  2301     02  eibconf          pic x(1).
  2302     02  eiberr           pic x(1).
  2303     02  eibrldbk         pic x(1).
  2304     02  eiberrcd         pic x(4).
  2305     02  eibsynrb         pic x(1).
  2306     02  eibnodat         pic x(1).
  2307     02  eibfiller5       pic x(2).
  2308     02  eibresp          pic s9(8) comp.
  2309     02  eibresp2         pic s9(8) comp.
  2310     02  dfheigdj         pic s9(4) comp.
  2311     02  dfheigdk         pic s9(4) comp.
  2312 01  DFHCOMMAREA             PIC X(1024).
  2313
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  45
* EL640.cbl
  2316*                            COPY ERCPNDB.
  2317******************************************************************
  2318*                                                                *
  2319*                                                                *
  2320*                            ERCPNDB.                            *
  2321*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2322*                            VMOD=2.025                          *
  2323*                                                                *
  2324*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  2325*                                                                *
  2326******************************************************************
  2327*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  2328*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  2329******************************************************************
  2330*                                                                *
  2331*                                                                *
  2332*   FILE TYPE = VSAM,KSDS                                        *
  2333*   RECORD SIZE = 585  RECFORM = FIXED                           *
  2334*                                                                *
  2335*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  2336*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  2337*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  2338*                                                 RKP=13,LEN=36  *
  2339*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  2340*                                      AND CHG-SEQ.)             *
  2341*                                                RKP=49,LEN=11   *
  2342*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  2343*                                      AND CHG-SEQ.)             *
  2344*                                                RKP=60,LEN=15   *
  2345*                                                                *
  2346*   LOG = NO                                                     *
  2347*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2348******************************************************************
  2349******************************************************************
  2350*                   C H A N G E   L O G
  2351*
  2352* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2353*-----------------------------------------------------------------
  2354*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2355* EFFECTIVE    NUMBER
  2356*-----------------------------------------------------------------
  2357* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2358* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2359* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2360* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2361* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  2362* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2363* 032306                   PEMA  ADD BOW LOAN NUMBER
  2364* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  2365* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  2366* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2367* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2368* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  2369* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  2370* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2371* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2372* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  2373* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  46
* EL640.cbl
  2374* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  2375* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2376******************************************************************
  2377
  2378 01  PENDING-BUSINESS.
  2379     12  PB-RECORD-ID                     PIC XX.
  2380         88  VALID-PB-ID                        VALUE 'PB'.
  2381
  2382     12  PB-CONTROL-PRIMARY.
  2383         16  PB-COMPANY-CD                PIC X.
  2384         16  PB-ENTRY-BATCH               PIC X(6).
  2385         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  2386         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  2387
  2388     12  PB-CONTROL-BY-ACCOUNT.
  2389         16  PB-COMPANY-CD-A1             PIC X.
  2390         16  PB-CARRIER                   PIC X.
  2391         16  PB-GROUPING.
  2392             20  PB-GROUPING-PREFIX       PIC XXX.
  2393             20  PB-GROUPING-PRIME        PIC XXX.
  2394         16  PB-STATE                     PIC XX.
  2395         16  PB-ACCOUNT.
  2396             20  PB-ACCOUNT-PREFIX        PIC X(4).
  2397             20  PB-ACCOUNT-PRIME         PIC X(6).
  2398         16  PB-CERT-EFF-DT               PIC XX.
  2399         16  PB-CERT-NO.
  2400             20  PB-CERT-PRIME            PIC X(10).
  2401             20  PB-CERT-SFX              PIC X.
  2402         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  2403
  2404         16  PB-RECORD-TYPE               PIC X.
  2405             88  PB-MAILING-DATA                VALUE '0'.
  2406             88  PB-ISSUE                       VALUE '1'.
  2407             88  PB-CANCELLATION                VALUE '2'.
  2408             88  PB-BATCH-TRAILER               VALUE '9'.
  2409
  2410     12  PB-CONTROL-BY-ORIG-BATCH.
  2411         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  2412         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  2413         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  2414         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  2415
  2416     12  PB-CONTROL-BY-CSR.
  2417         16  PB-CSR-COMPANY-CD            PIC X.
  2418         16  PB-CSR-ID                    PIC X(4).
  2419         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  2420         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  2421         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  2422******************************************************************
  2423*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  2424******************************************************************
  2425
  2426     12  PB-LAST-MAINT-DT                 PIC XX.
  2427     12  PB-LAST-MAINT-BY                 PIC X(4).
  2428     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2429
  2430     12  PB-RECORD-BODY                   PIC X(375).
  2431
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  47
* EL640.cbl
  2432     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  2433         16  PB-CERT-ORIGIN               PIC X.
  2434             88  CLASIC-CREATED-CERT         VALUE '1'.
  2435         16  PB-I-NAME.
  2436             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  2437             20  PB-I-INSURED-FIRST-NAME.
  2438                 24  PB-I-INSURED-1ST-INIT PIC X.
  2439                 24  FILLER                PIC X(9).
  2440             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  2441         16  PB-I-AGE                     PIC S99   COMP-3.
  2442         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  2443         16  PB-I-BIRTHDAY                PIC XX.
  2444         16  PB-I-INSURED-SEX             PIC X.
  2445             88  PB-SEX-MALE     VALUE 'M'.
  2446             88  PB-SEX-FEMALE   VALUE 'F'.
  2447
  2448         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  2449         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  2450         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  2451         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  2452         16  PB-I-SKIP-CODE               PIC X.
  2453             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  2454             88  PB-SKIP-JULY              VALUE '1'.
  2455             88  PB-SKIP-AUGUST            VALUE '2'.
  2456             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  2457             88  PB-SKIP-JULY-AUG          VALUE '4'.
  2458             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  2459             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  2460             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  2461             88  PB-SKIP-JUNE              VALUE '8'.
  2462             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  2463             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  2464             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  2465         16  PB-I-TERM-TYPE               PIC X.
  2466             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  2467             88  PB-PAID-WEEKLY            VALUE 'W'.
  2468             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  2469             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  2470             88  PB-PAID-13-YEARLY         VALUE 'T'.
  2471         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  2472         16  PB-I-POLICY-FORM-NO          PIC X(12).
  2473         16  PB-I-DATA-ENTRY-SW           PIC X.
  2474             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  2475             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  2476             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  2477             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  2478         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  2479         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  2480*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  2481         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  2482         16  FILLER                       PIC X.
  2483
  2484         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  2485             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  2486             88  PB-INVALID-LIFE             VALUE '  ' '00'
  2487                                                   '90' THRU '99'.
  2488         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  2489                                          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  48
* EL640.cbl
  2490         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2491         16  PB-I-AMOUNT-FINANCED REDEFINES
  2492                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  2493         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  2494         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  2495                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  2496         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2497         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  2498         16  PB-I-CLP-AMOUNT REDEFINES
  2499                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  2500         16  PB-I-LF-CALC-FLAG            PIC X.
  2501             88 PB-COMP-LF-PREM               VALUE '?'.
  2502         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2503         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2504         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2505         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2506         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2507         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2508         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2509         16  PB-I-LF-ABBR                 PIC XXX.
  2510         16  PB-I-LF-INPUT-CD             PIC XX.
  2511
  2512         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2513             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2514             88  PB-INVALID-AH               VALUE '  ' '00'
  2515                                                   '90' THRU '99'.
  2516         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2517         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2518         16  PB-I-AH-CALC-FLAG            PIC X.
  2519             88 PB-COMP-AH-PREM                  VALUE '?'.
  2520         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2521         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2522         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  2523         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2524         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2525         16  PB-I-AH-ABBR                 PIC XXX.
  2526         16  PB-I-AH-INPUT-CD             PIC XXX.
  2527
  2528         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2529         16  PB-I-REIN-TABLE              PIC XXX.
  2530         16  PB-I-BUSINESS-TYPE           PIC 99.
  2531         16  PB-I-INDV-GRP-CD             PIC X.
  2532         16  PB-I-MORT-CODE.
  2533             20  PB-I-TABLE               PIC X.
  2534             20  PB-I-INTEREST            PIC XX.
  2535             20  PB-I-MORT-TYP            PIC X.
  2536         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2537         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2538         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2539         16  PB-I-INDV-GRP-OVRD           PIC X.
  2540         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2541         16  PB-I-SIG-SW                  PIC X.
  2542             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2543         16  PB-I-RATE-CLASS              PIC XX.
  2544         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2545         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2546         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2547         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  49
* EL640.cbl
  2548         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2549         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2550         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  2551         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2552         16  PB-I-OB-FLAG                 PIC X.
  2553             88  PB-I-OB                      VALUE 'B'.
  2554             88  PB-I-SUMMARY                 VALUE 'Z'.
  2555         16  PB-I-ENTRY-STATUS            PIC X.
  2556             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2557                                              'M' '5' '9' '2'.
  2558             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2559             88  PB-I-POLICY-PENDING          VALUE '2'.
  2560             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2561             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2562             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  2563             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2564             88  PB-I-REIN-ONLY               VALUE '9'.
  2565             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2566             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2567             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2568             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2569         16  PB-I-INT-CODE                PIC X.
  2570             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2571             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2572         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2573         16  PB-I-SOC-SEC-NO              PIC X(11).
  2574         16  PB-I-MEMBER-NO               PIC X(12).
  2575         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2576*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2577         16  PB-I-OLD-LOF                 PIC XXX.
  2578         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2579         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2580         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2581         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2582         16  PB-I-LIFE-INDICATOR          PIC X.
  2583             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2584         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2585         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2586                                          PIC S9(5)V99    COMP-3.
  2587         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2588             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2589             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2590         16  PB-I-1ST-PMT-DT              PIC XX.
  2591         16  PB-I-JOINT-INSURED.
  2592             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2593             20 PB-I-JOINT-FIRST-NAME.
  2594                24  PB-I-JOINT-FIRST-INIT PIC X.
  2595                24  FILLER                PIC X(9).
  2596             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2597*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2598         16  PB-I-BENEFICIARY-NAME.
  2599             20  PB-I-BANK-NUMBER         PIC X(10).
  2600             20  FILLER                   PIC X(15).
  2601         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2602         16  PB-I-REFERENCE               PIC X(12).
  2603         16  FILLER REDEFINES PB-I-REFERENCE.
  2604             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2605             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  50
* EL640.cbl
  2606             20  PB-I-CLP-STATE           PIC XX.
  2607         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2608             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2609             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  2610             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2611         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2612         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2613         16  PB-I-RESIDENT-STATE          PIC XX.
  2614         16  PB-I-RATE-CODE               PIC X(4).
  2615         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2616         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2617         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2618         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2619         16  PB-I-BANK-NOCHRGB            PIC 99.
  2620         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2621         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2622
  2623     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2624         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2625             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2626         16  PB-C-CANCEL-ORIGIN           PIC X.
  2627             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2628         16  PB-C-LF-CANCEL-DT            PIC XX.
  2629         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2630         16  PB-C-LF-CALC-REQ             PIC X.
  2631             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2632         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2633         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2634         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2635             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2636         16  PB-C-AH-CANCEL-DT            PIC XX.
  2637         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2638         16  PB-C-AH-CALC-REQ             PIC X.
  2639             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2640         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2641         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2642         16  PB-C-LAST-NAME               PIC X(15).
  2643         16  PB-C-REFUND-SW               PIC X.
  2644             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2645             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2646         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2647         16  PB-C-PAYEE-CODE              PIC X(6).
  2648         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2649         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2650         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2651         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2652         16  PB-C-REFERENCE               PIC X(12).
  2653         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2654         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2655         16  PB-C-POST-CARD-IND           PIC X.
  2656         16  PB-C-CANCEL-REASON           PIC X.
  2657         16  PB-C-REF-INTERFACE-SW        PIC X.
  2658         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2659         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2660         16  FILLER                       PIC X(01).
  2661*        16  FILLER                       PIC X(18).
  2662         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2663*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  51
* EL640.cbl
  2664         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  2665         16  PB-CANCELED-CERT-DATA.
  2666             20  PB-CI-INSURED-NAME.
  2667                 24  PB-CI-LAST-NAME      PIC X(15).
  2668                 24  PB-CI-INITIALS       PIC XX.
  2669             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2670             20  PB-CI-INSURED-SEX        PIC X.
  2671             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2672             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2673             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2674             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2675             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2676             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2677             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2678             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2679             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2680             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2681             20  PB-CI-RATE-CLASS         PIC XX.
  2682             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2683             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2684             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2685             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2686             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2687             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2688             20  PB-CI-LF-ABBR            PIC X(3).
  2689             20  PB-CI-AH-ABBR            PIC X(3).
  2690             20  PB-CI-OB-FLAG            PIC X.
  2691                 88  PB-CI-OB                VALUE 'B'.
  2692             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2693                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2694                                           'M' '4' '5' '9' '2'.
  2695                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2696                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2697                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2698                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2699                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2700                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  2701                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2702                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2703                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2704                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2705                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2706                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2707                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2708             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2709                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2710                                           'M' '4' '5' '9' '2'.
  2711                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2712                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2713                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2714                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2715                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2716                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  2717                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2718                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2719                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2720                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2721                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  52
* EL640.cbl
  2722                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2723                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2724             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2725             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2726             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2727             20  PB-CI-MEMBER-NO          PIC X(12).
  2728             20  PB-CI-INT-CODE           PIC X.
  2729                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2730                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2731             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2732             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2733             20  PB-CI-COMP-EXCP-SW       PIC X.
  2734                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2735                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2736             20  PB-CI-ENTRY-STATUS       PIC X.
  2737             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2738             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2739             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2740             20  PB-CI-DEATH-DT           PIC XX.
  2741             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2742             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2743             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2744             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2745             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2746             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2747             20  PB-CI-ENTRY-DT              PIC XX.
  2748             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2749             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2750             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2751             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2752             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2753             20  PB-CI-OLD-LOF               PIC XXX.
  2754*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2755             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2756             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2757             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2758             20  PB-CI-INDV-GRP-CD           PIC X.
  2759             20  PB-CI-BENEFICIARY-NAME.
  2760                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2761                 24  FILLER                  PIC X(15).
  2762             20  PB-CI-NOTE-SW               PIC X.
  2763             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2764             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2765             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2766             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2767             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2768             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2769             20  PB-CI-FIRST-NAME            PIC X(10).
  2770             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2771
  2772         16  FILLER                       PIC X(13).
  2773*032306  16  FILLER                       PIC X(27).
  2774*        16  FILLER                       PIC X(46).
  2775
  2776     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2777         16  FILLER                       PIC X(10).
  2778         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2779         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  53
* EL640.cbl
  2780         16  PB-M-INSURED-MID-INIT        PIC X.
  2781         16  PB-M-INSURED-AGE             PIC 99.
  2782         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2783         16  PB-M-INSURED-SEX             PIC X.
  2784         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2785         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  2786         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2787         16  PB-M-INSURED-CITY-STATE.
  2788             20  PB-M-INSURED-CITY        PIC X(28).
  2789             20  PB-M-INSURED-STATE       PIC XX.
  2790         16  PB-M-INSURED-ZIP-CODE.
  2791             20  PB-M-INSURED-ZIP-PRIME.
  2792                 24  PB-M-INSURED-ZIP-1   PIC X.
  2793                     88  PB-M-CANADIAN-POST-CODE
  2794                                             VALUE 'A' THRU 'Z'.
  2795                 24  FILLER               PIC X(4).
  2796             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2797         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2798                                        PB-M-INSURED-ZIP-CODE.
  2799             20  PM-M-INS-CAN-POST1       PIC XXX.
  2800             20  PM-M-INS-CAN-POST2       PIC XXX.
  2801             20  FILLER                   PIC XXX.
  2802         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2803         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2804         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2805         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2806         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2807         16  PB-M-CRED-BENE-CITYST.
  2808             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2809             20  PB-M-CRED-BENE-STATE     PIC XX.
  2810         16  FILLER                       PIC X(92).
  2811
  2812     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2813         16  FILLER                       PIC X(10).
  2814         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2815         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2816         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2817         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2818         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2819         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2820         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2821         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2822         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2823         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2824         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2825         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2826         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2827         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2828         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2829         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2830         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2831         16  PB-ACCOUNT-NAME              PIC X(30).
  2832         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2833         16  PB-REFERENCE                 PIC X(12).
  2834         16  PB-B-RECEIVED-DT             PIC XX.
  2835         16  FILLER                       PIC X(234).
  2836
  2837     12  PB-RECORD-STATUS.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  54
* EL640.cbl
  2838         16  PB-CREDIT-SELECT-DT          PIC XX.
  2839         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2840         16  PB-BILLED-DT                 PIC XX.
  2841         16  PB-BILLING-STATUS            PIC X.
  2842             88  PB-ENTRY-REVERSED            VALUE 'R'.
  2843             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2844             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2845         16  PB-RECORD-BILL               PIC X.
  2846             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2847             88  PB-RECORD-RETURNED           VALUE 'R'.
  2848             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2849             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2850             88  PB-OVERRIDE-AH               VALUE 'A'.
  2851             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2852         16  PB-BATCH-ENTRY               PIC X.
  2853             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2854             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2855             88  PB-REISSUED-CERT             VALUE 'E'.
  2856             88  PB-CASH-CERT                 VALUE 'C'.
  2857             88  PB-MONTHLY-CERT              VALUE 'M'.
  2858             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2859             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2860             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2861         16  PB-FORCE-CODE                PIC X.
  2862             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2863             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2864             88  PB-CANCEL-FORCE              VALUE '8'.
  2865             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2866             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2867             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2868             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2869             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2870             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2871             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  2872             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2873         16  PB-FATAL-FLAG                PIC X.
  2874             88  PB-FATAL-ERRORS              VALUE 'X'.
  2875         16  PB-FORCE-ER-CD               PIC X.
  2876             88  PB-FORCE-ERRORS              VALUE 'F'.
  2877             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2878         16  PB-WARN-ER-CD                PIC X.
  2879             88  PB-WARNING-ERRORS            VALUE 'W'.
  2880         16  FILLER                       PIC X.
  2881         16  PB-OUT-BAL-CD                PIC X.
  2882             88  PB-OUT-OF-BAL                VALUE 'O'.
  2883         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2884         16  PB-AH-OVERRIDE-L1            PIC X.
  2885         16  PB-INPUT-DT                  PIC XX.
  2886         16  PB-INPUT-BY                  PIC X(4).
  2887         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2888         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2889         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2890         16  PB-LF-EARNING-METHOD         PIC X.
  2891         16  PB-AH-EARNING-METHOD         PIC X.
  2892         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2893         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2894         16  PB-REIN-CD                   PIC XXX.
  2895         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  55
* EL640.cbl
  2896         16  PB-AH-REFUND-TYPE            PIC X.
  2897         16  PB-ACCT-EFF-DT               PIC XX.
  2898         16  PB-ACCT-EXP-DT               PIC XX.
  2899         16  PB-COMPANY-ID                PIC X(3).
  2900         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2901         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2902         16  PB-SV-CARRIER                PIC X.
  2903         16  PB-SV-GROUPING               PIC X(6).
  2904         16  PB-SV-STATE                  PIC XX.
  2905         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2906         16  PB-GA-BILLING-INFO.
  2907             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2908                                          PIC XX.
  2909         16  PB-SV-REMIT-TO  REDEFINES
  2910             PB-GA-BILLING-INFO           PIC X(10).
  2911         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2912         16  PB-I-LOAN-OFFICER            PIC X(5).
  2913         16  PB-I-VIN                     PIC X(17).
  2914
  2915         16  FILLER                       PIC X(04).
  2916         16  IMNET-BYPASS-SW              PIC X.
  2917
  2918******************************************************************
  2919*                COMMON EDIT ERRORS                              *
  2920******************************************************************
  2921
  2922     12  PB-COMMON-ERRORS.
  2923         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2924                                           PIC S9(4)     COMP.
  2925
  2926******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  56
* EL640.cbl
  2928*                            COPY ELCCNTL.
  2929******************************************************************
  2930*                                                                *
  2931*                                                                *
  2932*                            ELCCNTL.                            *
  2933*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2934*                            VMOD=2.059                          *
  2935*                                                                *
  2936*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2937*                                                                *
  2938*   FILE TYPE = VSAM,KSDS                                        *
  2939*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2940*                                                                *
  2941*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2942*       ALTERNATE INDEX = NONE                                   *
  2943*                                                                *
  2944*   LOG = YES                                                    *
  2945*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2946******************************************************************
  2947*                   C H A N G E   L O G
  2948*
  2949* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2950*-----------------------------------------------------------------
  2951*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2952* EFFECTIVE    NUMBER
  2953*-----------------------------------------------------------------
  2954* 082503                   PEMA  ADD BENEFIT GROUP
  2955* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2956* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2957* 092705    2005050300006  PEMA  ADD SPP LEASES
  2958* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2959* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2960* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2961* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2962* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2963* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2964* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2965* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2966* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2967* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2968* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2969******************************************************************
  2970*
  2971 01  CONTROL-FILE.
  2972     12  CF-RECORD-ID                       PIC XX.
  2973         88  VALID-CF-ID                        VALUE 'CF'.
  2974
  2975     12  CF-CONTROL-PRIMARY.
  2976         16  CF-COMPANY-ID                  PIC XXX.
  2977         16  CF-RECORD-TYPE                 PIC X.
  2978             88  CF-COMPANY-MASTER              VALUE '1'.
  2979             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2980             88  CF-STATE-MASTER                VALUE '3'.
  2981             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2982             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2983             88  CF-CARRIER-MASTER              VALUE '6'.
  2984             88  CF-MORTALITY-MASTER            VALUE '7'.
  2985             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  57
* EL640.cbl
  2986             88  CF-TERMINAL-MASTER             VALUE '9'.
  2987             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2988             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2989             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2990             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2991             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2992             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2993             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2994             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2995             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2996         16  CF-ACCESS-CD-GENL              PIC X(4).
  2997         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2998             20  CF-PROCESSOR               PIC X(4).
  2999         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3000             20  CF-STATE-CODE              PIC XX.
  3001             20  FILLER                     PIC XX.
  3002         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3003             20  FILLER                     PIC XX.
  3004             20  CF-HI-BEN-IN-REC           PIC XX.
  3005         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3006             20  FILLER                     PIC XXX.
  3007             20  CF-CARRIER-CNTL            PIC X.
  3008         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3009             20  FILLER                     PIC XX.
  3010             20  CF-HI-TYPE-IN-REC          PIC 99.
  3011         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3012             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3013                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3014             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3015             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3016         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3017             20  FILLER                     PIC X.
  3018             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3019         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3020             20  FILLER                     PIC XX.
  3021             20  CF-MORTGAGE-PLAN           PIC XX.
  3022         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3023
  3024     12  CF-LAST-MAINT-DT                   PIC XX.
  3025     12  CF-LAST-MAINT-BY                   PIC X(4).
  3026     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3027
  3028     12  CF-RECORD-BODY                     PIC X(728).
  3029
  3030
  3031****************************************************************
  3032*             COMPANY MASTER RECORD                            *
  3033****************************************************************
  3034
  3035     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3036         16  CF-COMPANY-ADDRESS.
  3037             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3038             20  CF-CL-IN-CARE-OF           PIC X(30).
  3039             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3040             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3041             20  CF-CL-CITY-STATE           PIC X(30).
  3042             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3043             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  58
* EL640.cbl
  3044         16  CF-COMPANY-CD                  PIC X.
  3045         16  CF-COMPANY-PASSWORD            PIC X(8).
  3046         16  CF-SECURITY-OPTION             PIC X.
  3047             88  ALL-SECURITY                   VALUE '1'.
  3048             88  COMPANY-VERIFY                 VALUE '2'.
  3049             88  PROCESSOR-VERIFY               VALUE '3'.
  3050             88  NO-SECURITY                    VALUE '4'.
  3051             88  ALL-BUT-TERM                   VALUE '5'.
  3052         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3053             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3054         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3055             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3056         16  CF-INFORCE-LOCATION            PIC X.
  3057             88  CERTS-ARE-ONLINE               VALUE '1'.
  3058             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3059             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3060         16  CF-LOWER-CASE-LETTERS          PIC X.
  3061         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3062             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3063             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3064             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3065             88  CF-ACCNT-CNTL                  VALUE '3'.
  3066             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3067
  3068         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3069         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3070
  3071         16  CF-LGX-CREDIT-USER             PIC X.
  3072             88  CO-IS-NOT-USER                 VALUE 'N'.
  3073             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3074
  3075         16 CF-CREDIT-CALC-CODES.
  3076             20  CF-CR-REM-TERM-CALC PIC X.
  3077               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3078               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3079               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3080               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3081               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3082               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3083               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3084             20  CF-CR-R78-METHOD           PIC X.
  3085               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3086               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3087
  3088         16  CF-CLAIM-CONTROL-COUNTS.
  3089             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3090                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3091
  3092             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3093                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3094
  3095             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3096                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3097
  3098             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3099                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3100
  3101         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  59
* EL640.cbl
  3102
  3103         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3104             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3105             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3106             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3107             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3108                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3109                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3110             20  CF-CO-PREM-REJECT-SW       PIC X.
  3111                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3112                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3113             20  CF-CO-REF-REJECT-SW        PIC X.
  3114                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3115                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3116
  3117         16  CF-CO-REPORTING-DT             PIC XX.
  3118         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3119         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3120           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3121           88  CF-CO-MONTH-END                  VALUE '1'.
  3122
  3123         16  CF-LGX-CLAIM-USER              PIC X.
  3124             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3125             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3126
  3127         16  CF-CREDIT-EDIT-CONTROLS.
  3128             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3129             20  CF-MIN-AGE                 PIC 99.
  3130             20  CF-DEFAULT-AGE             PIC 99.
  3131             20  CF-MIN-TERM                PIC S999      COMP-3.
  3132             20  CF-MAX-TERM                PIC S999      COMP-3.
  3133             20  CF-DEFAULT-SEX             PIC X.
  3134             20  CF-JOINT-AGE-INPUT         PIC X.
  3135                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3136             20  CF-BIRTH-DATE-INPUT        PIC X.
  3137                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3138             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3139                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3140                 88  CF-ZERO-CARRIER            VALUE '1'.
  3141                 88  CF-ZERO-GROUPING           VALUE '2'.
  3142                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3143             20  CF-EDIT-SW                 PIC X.
  3144                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3145             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3146             20  CF-CR-PR-METHOD            PIC X.
  3147               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3148               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3149             20  FILLER                     PIC X.
  3150
  3151         16  CF-CREDIT-MISC-CONTROLS.
  3152             20  CF-REIN-TABLE-SW           PIC X.
  3153                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3154             20  CF-COMP-TABLE-SW           PIC X.
  3155                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3156             20  CF-EXPERIENCE-RETENTION-AGE
  3157                                            PIC S9        COMP-3.
  3158             20  CF-CONVERSION-DT           PIC XX.
  3159             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  60
* EL640.cbl
  3160             20  CF-RUN-FREQUENCY-SW        PIC X.
  3161                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3162                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3163
  3164             20  CF-CR-CHECK-NO-CONTROL.
  3165                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3166                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3167                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3168                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3169                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3170                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3171
  3172                 24  CF-CR-CHECK-COUNT       REDEFINES
  3173                     CF-CR-CHECK-COUNTER      PIC X(4).
  3174
  3175                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3176                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3177
  3178                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3179                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3180                 24  CF-MAIL-PROCESSING       PIC X.
  3181                     88  MAIL-PROCESSING          VALUE 'Y'.
  3182
  3183         16  CF-MISC-SYSTEM-CONTROL.
  3184             20  CF-SYSTEM-C                 PIC X.
  3185                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3186             20  CF-SYSTEM-D                 PIC X.
  3187                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3188             20  CF-SOC-SEC-NO-SW            PIC X.
  3189                 88  SOC-SEC-NO-USED             VALUE '1'.
  3190             20  CF-MEMBER-NO-SW             PIC X.
  3191                 88  MEMBER-NO-USED              VALUE '1'.
  3192             20  CF-TAX-ID-NUMBER            PIC X(11).
  3193             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3194             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3195                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3196                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3197                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3198                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3199             20  CF-SYSTEM-E                 PIC X.
  3200                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3201
  3202         16  CF-LGX-LIFE-USER               PIC X.
  3203             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3204             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3205
  3206         16  CF-CR-MONTH-END-DT             PIC XX.
  3207
  3208         16  CF-FILE-MAINT-DATES.
  3209             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3210                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3211             20  CF-LAST-BATCH       REDEFINES
  3212                 CF-LAST-BATCH-NO               PIC X(4).
  3213             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3214             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3215             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3216             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3217             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  61
* EL640.cbl
  3218             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3219             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3220             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3221             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3222             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3223
  3224         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3225         16  FILLER                         PIC X.
  3226
  3227         16  CF-ALT-MORT-CODE               PIC X(4).
  3228         16  CF-MEMBER-CAPTION              PIC X(10).
  3229
  3230         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3231             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3232             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3233             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3234             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3235             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3236
  3237         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3238
  3239         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3240         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3241         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3242         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3243
  3244         16  CF-AH-OVERRIDE-L1              PIC X.
  3245         16  CF-AH-OVERRIDE-L2              PIC XX.
  3246         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3247         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3248
  3249         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3250         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3251
  3252         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3253         16  CF-AR-LAST-EL860-DT            PIC XX.
  3254         16  CF-MP-MONTH-END-DT             PIC XX.
  3255
  3256         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3257         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3258             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3259
  3260         16  CF-AR-MONTH-END-DT             PIC XX.
  3261
  3262         16  CF-CRDTCRD-USER                PIC X.
  3263             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3264             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3265
  3266         16  CF-CC-MONTH-END-DT             PIC XX.
  3267
  3268         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3269
  3270         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3271             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3272             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3273             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3274         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3275         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  62
* EL640.cbl
  3276         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3277         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3278             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3279             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3280         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3281         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3282         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3283             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3284         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3285
  3286         16  CF-CL-ZIP-CODE.
  3287             20  CF-CL-ZIP-PRIME.
  3288                 24  CF-CL-ZIP-1ST          PIC X.
  3289                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3290                 24  FILLER                 PIC X(4).
  3291             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3292         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3293             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3294             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3295             20  FILLER                     PIC XXX.
  3296
  3297         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3298         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3299         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3300         16  CF-CO-OPTION-START-DATE        PIC XX.
  3301         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3302           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3303                                                      '3' '4'.
  3304           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3305           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3306           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3307           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3308           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3309           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3310
  3311         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3312
  3313         16  CF-PAYMENT-APPROVAL-LEVELS.
  3314             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3315             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3316             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3317             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3318             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3319             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3320
  3321         16  CF-END-USER-REPORTING-USER     PIC X.
  3322             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3323             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3324
  3325         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3326             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3327             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3328
  3329         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3330
  3331         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3332         16  FILLER                         PIC X.
  3333
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  63
* EL640.cbl
  3334         16  CF-CREDIT-ARCHIVE-CNTL.
  3335             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3336             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3337             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3338
  3339         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3340
  3341         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3342             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3343             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3344
  3345         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3346             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3347             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3348
  3349         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3350
  3351         16  CF-CO-ACH-ID-CODE              PIC  X.
  3352             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3353             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3354             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3355         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3356         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3357         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3358         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3359         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3360         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3361         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3362         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3363         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3364                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3365         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3366                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3367
  3368         16  CF-CO-OVER-SHORT.
  3369             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3370             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3371
  3372*         16  FILLER                         PIC X(102).
  3373         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3374             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3375             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3376
  3377         16  CF-AH-APPROVAL-DAYS.
  3378             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3379             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3380             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3381             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3382
  3383         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3384
  3385         16  CF-APPROV-LEV-5.
  3386             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3387             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3388             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3389
  3390         16  FILLER                         PIC X(68).
  3391****************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  64
* EL640.cbl
  3392*             PROCESSOR/USER RECORD                            *
  3393****************************************************************
  3394
  3395     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3396         16  CF-PROCESSOR-NAME              PIC X(30).
  3397         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3398         16  CF-PROCESSOR-TITLE             PIC X(26).
  3399         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3400                 88  MESSAGE-YES                VALUE 'Y'.
  3401                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3402
  3403*****************************************************
  3404****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3405****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3406****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3407****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3408*****************************************************
  3409
  3410         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3411             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3412             20  CF-APPLICATION-FORCE       PIC X.
  3413             20  CF-INDIVIDUAL-APP.
  3414                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3415                     28  CF-BROWSE-APP      PIC X.
  3416                     28  CF-UPDATE-APP      PIC X.
  3417
  3418         16  CF-CURRENT-TERM-ON             PIC X(4).
  3419         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3420             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3421             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3422             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3423             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3424             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3425             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3426             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3427         16  CF-PROCESSOR-CARRIER           PIC X.
  3428             88  NO-CARRIER-SECURITY            VALUE ' '.
  3429         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3430             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3431         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3432             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3433         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3434             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3435
  3436         16  CF-PROC-SYS-ACCESS-SW.
  3437             20  CF-PROC-CREDIT-CLAIMS-SW.
  3438                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3439                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3440                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3441                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3442             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3443                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3444                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3445             20  CF-PROC-LIFE-GNRLDGR-SW.
  3446                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3447                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3448                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3449                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  65
* EL640.cbl
  3450             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3451                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3452                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3453         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3454             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3455             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3456         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3457
  3458         16  CF-APPROVAL-LEVEL                  PIC X.
  3459             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3460             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3461             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3462             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3463             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3464
  3465         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3466
  3467         16  CF-LANGUAGE-TYPE                   PIC X.
  3468             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3469             88  CF-LANG-IS-FR                      VALUE 'F'.
  3470
  3471         16  CF-CSR-IND                         PIC X.
  3472         16  FILLER                             PIC X(239).
  3473
  3474****************************************************************
  3475*             PROCESSOR/REMINDERS RECORD                       *
  3476****************************************************************
  3477
  3478     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3479         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3480             20  CF-START-REMIND-DT         PIC XX.
  3481             20  CF-END-REMIND-DT           PIC XX.
  3482             20  CF-REMINDER-TEXT           PIC X(50).
  3483         16  FILLER                         PIC X(296).
  3484
  3485
  3486****************************************************************
  3487*             STATE MASTER RECORD                              *
  3488****************************************************************
  3489
  3490     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3491         16  CF-STATE-ABBREVIATION          PIC XX.
  3492         16  CF-STATE-NAME                  PIC X(25).
  3493         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3494         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3495             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3496             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3497             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3498             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3499                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3500                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3501             20  CF-ST-PREM-REJECT-SW       PIC X.
  3502                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3503                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3504             20  CF-ST-REF-REJECT-SW        PIC X.
  3505                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3506                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3507         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  66
* EL640.cbl
  3508         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3509         16  CF-ST-REFUND-RULES.
  3510             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3511             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3512             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3513         16  CF-ST-FST-PMT-EXTENSION.
  3514             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3515             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3516                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3517                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3518                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3519                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3520         16  CF-ST-STATE-CALL.
  3521             20  CF-ST-CALL-UNEARNED        PIC X.
  3522             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3523             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3524         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3525             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3526             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3527         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3528         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3529         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3530         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3531         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3532         16  FILLER                         PIC X.
  3533         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3534             20  CF-ST-BENEFIT-CD           PIC XX.
  3535             20  CF-ST-BENEFIT-KIND         PIC X.
  3536                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3537                 88  CF-ST-AH-KIND              VALUE 'A'.
  3538             20  CF-ST-REM-TERM-CALC        PIC X.
  3539                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3540                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3541                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3542                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3543                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3544                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3545                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3546                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3547
  3548             20  CF-ST-REFUND-CALC          PIC X.
  3549                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3550                 88  ST-REFD-BY-R78             VALUE '1'.
  3551                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3552                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3553                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3554                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3555                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3556                 88  ST-REFD-UTAH               VALUE '7'.
  3557                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3558                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3559                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3560
  3561             20  CF-ST-EARNING-CALC         PIC X.
  3562                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3563                 88  ST-EARN-BY-R78             VALUE '1'.
  3564                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3565                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  67
* EL640.cbl
  3566                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3567                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3568                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3569                 88  ST-EARN-MEAN               VALUE '8'.
  3570                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3571
  3572             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3573                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3574                 88  ST-OVRD-BY-R78             VALUE '1'.
  3575                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3576                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3577                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3578                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3579                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3580                 88  ST-OVRD-MEAN               VALUE '8'.
  3581                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3582             20  cf-st-extra-periods        pic 9.
  3583*            20  FILLER                     PIC X.
  3584
  3585         16  CF-ST-COMMISSION-CAPS.
  3586             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3587             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3588             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3589             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3590         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3591                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3592                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  3593                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  3594
  3595         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3596
  3597         16  CF-ST-STATUTORY-INTEREST.
  3598             20  CF-ST-STAT-DATE-FROM       PIC X.
  3599                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3600                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3601             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3602             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3603             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3604             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3605             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3606
  3607         16  CF-ST-OVER-SHORT.
  3608             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3609             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3610
  3611         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3612
  3613         16  CF-ST-RT-CALC                  PIC X.
  3614
  3615         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3616         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3617         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3618         16  CF-ST-RF-LR-CALC               PIC X.
  3619         16  CF-ST-RF-LL-CALC               PIC X.
  3620         16  CF-ST-RF-LN-CALC               PIC X.
  3621         16  CF-ST-RF-AH-CALC               PIC X.
  3622         16  CF-ST-RF-CP-CALC               PIC X.
  3623*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  68
* EL640.cbl
  3624*CIDMOD         16  FILLER                         PIC X(192).
  3625         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3626             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3627         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3628         16  CF-ST-VFY-2ND-BENE             PIC X.
  3629         16  CF-ST-CAUSAL-STATE             PIC X.
  3630         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3631         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3632         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3633             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3634         16  CF-ST-NET-ONLY-STATE           PIC X.
  3635             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3636         16  cf-commission-cap-required     pic x.
  3637         16  CF-ST-GA-COMMISSION-CAPS.
  3638             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  3639             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  3640             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  3641             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  3642         16  CF-ST-TOT-COMMISSION-CAPS.
  3643             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  3644             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  3645             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  3646             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  3647         16  FILLER                         PIC X(156).
  3648
  3649****************************************************************
  3650*             BENEFIT MASTER RECORD                            *
  3651****************************************************************
  3652
  3653     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3654         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3655             20  CF-BENEFIT-CODE            PIC XX.
  3656             20  CF-BENEFIT-NUMERIC  REDEFINES
  3657                 CF-BENEFIT-CODE            PIC XX.
  3658             20  CF-BENEFIT-ALPHA           PIC XXX.
  3659             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3660             20  CF-BENEFIT-COMMENT         PIC X(10).
  3661
  3662             20  CF-LF-COVERAGE-TYPE        PIC X.
  3663                 88  CF-REDUCING                VALUE 'R'.
  3664                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3665
  3666             20  CF-SPECIAL-CALC-CD         PIC X.
  3667                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3668                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3669                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3670                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3671                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3672                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3673                 88  CF-FARM-PLAN               VALUE 'F'.
  3674                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3675                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3676                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3677                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3678                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3679                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3680                 88  CF-PRUDENTIAL              VALUE 'P'.
  3681                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  69
* EL640.cbl
  3682                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3683                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3684                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3685                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3686                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3687
  3688             20  CF-JOINT-INDICATOR         PIC X.
  3689                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3690
  3691*            20  FILLER                     PIC X(12).
  3692             20  cf-maximum-benefits        pic s999 comp-3.
  3693             20  FILLER                     PIC X(09).
  3694             20  CF-BENEFIT-CATEGORY        PIC X.
  3695             20  CF-LOAN-TYPE               PIC X(8).
  3696
  3697             20  CF-CO-REM-TERM-CALC        PIC X.
  3698                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3699                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3700                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3701                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3702                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3703
  3704             20  CF-CO-EARNINGS-CALC        PIC X.
  3705                 88  CO-EARN-BY-R78             VALUE '1'.
  3706                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3707                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3708                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3709                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3710                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3711                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3712                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3713
  3714             20  CF-CO-REFUND-CALC          PIC X.
  3715                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3716                 88  CO-REFD-BY-R78             VALUE '1'.
  3717                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3718                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3719                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3720                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3721                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3722                 88  CO-REFD-MEAN               VALUE '8'.
  3723                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3724                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3725                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3726
  3727             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3728                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3729                 88  CO-OVRD-BY-R78             VALUE '1'.
  3730                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3731                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3732                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3733                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3734                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3735                 88  CO-OVRD-MEAN               VALUE '8'.
  3736                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3737
  3738             20  CF-CO-BEN-I-G-CD           PIC X.
  3739                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  70
* EL640.cbl
  3740                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3741                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3742
  3743         16  FILLER                         PIC X(304).
  3744
  3745
  3746****************************************************************
  3747*             CARRIER MASTER RECORD                            *
  3748****************************************************************
  3749
  3750     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3751         16  CF-ADDRESS-DATA.
  3752             20  CF-MAIL-TO-NAME            PIC X(30).
  3753             20  CF-IN-CARE-OF              PIC X(30).
  3754             20  CF-ADDRESS-LINE-1          PIC X(30).
  3755             20  CF-ADDRESS-LINE-2          PIC X(30).
  3756             20  CF-CITY-STATE              PIC X(30).
  3757             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3758             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3759
  3760         16  CF-CLAIM-NO-CONTROL.
  3761             20  CF-CLAIM-NO-METHOD         PIC X.
  3762                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3763                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3764                 88  CLAIM-NO-SEQ               VALUE '3'.
  3765                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3766             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3767                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3768                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3769                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3770
  3771         16  CF-CHECK-NO-CONTROL.
  3772             20  CF-CHECK-NO-METHOD         PIC X.
  3773                 88  CHECK-NO-MANUAL            VALUE '1'.
  3774                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3775                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3776                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3777             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3778                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3779
  3780         16  CF-DOMICILE-STATE              PIC XX.
  3781
  3782         16  CF-EXPENSE-CONTROLS.
  3783             20  CF-EXPENSE-METHOD          PIC X.
  3784                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3785                 88  DOLLARS-PER-PMT            VALUE '2'.
  3786                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3787                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3788             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3789             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3790
  3791         16  CF-CORRESPONDENCE-CONTROL.
  3792             20  CF-LETTER-RESEND-OPT       PIC X.
  3793                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3794                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3795             20  FILLER                     PIC X(4).
  3796
  3797         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  71
* EL640.cbl
  3798             20  CF-MANUAL-SW               PIC X.
  3799                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3800             20  CF-FUTURE-SW               PIC X.
  3801                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3802             20  CF-PTC-SW                  PIC X.
  3803                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3804             20  CF-IBNR-SW                 PIC X.
  3805                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3806             20  CF-PTC-LF-SW               PIC X.
  3807                 88  CF-LF-PTC-USED             VALUE '1'.
  3808             20  CF-CDT-ACCESS-METHOD       PIC X.
  3809                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3810                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3811                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3812             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3813
  3814         16  CF-CLAIM-CALC-METHOD           PIC X.
  3815             88  360-PLUS-MONTHS                VALUE '1'.
  3816             88  365-PLUS-MONTHS                VALUE '2'.
  3817             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3818             88  360-DAILY                      VALUE '4'.
  3819             88  365-DAILY                      VALUE '5'.
  3820
  3821         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3822         16  FILLER                         PIC X(11).
  3823
  3824         16  CF-LIMIT-AMOUNTS.
  3825             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3826             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3827             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3828             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3829             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3830             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3831             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3832             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3833             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3834             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3835
  3836         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3837         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3838         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3839
  3840         16  CF-ZIP-CODE.
  3841             20  CF-ZIP-PRIME.
  3842                 24  CF-ZIP-1ST             PIC X.
  3843                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3844                 24  FILLER                 PIC X(4).
  3845             20  CF-ZIP-PLUS4               PIC X(4).
  3846         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3847             20  CF-CAN-POSTAL-1            PIC XXX.
  3848             20  CF-CAN-POSTAL-2            PIC XXX.
  3849             20  FILLER                     PIC XXX.
  3850
  3851         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3852         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3853         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3854
  3855         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  72
* EL640.cbl
  3856             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3857             88  CF-NO-RATING                   VALUE 'N'.
  3858
  3859         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3860
  3861         16  CF-CARRIER-OVER-SHORT.
  3862             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3863             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3864
  3865         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3866         16  CF-SECPAY-SWITCH               PIC X.
  3867             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3868             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3869         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3870         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3871         16  FILLER                         PIC X(444).
  3872*        16  FILLER                         PIC X(452).
  3873
  3874
  3875****************************************************************
  3876*             MORTALITY MASTER RECORD                          *
  3877****************************************************************
  3878
  3879     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3880         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3881                                INDEXED BY CF-MORT-NDX.
  3882             20  CF-MORT-TABLE              PIC X(5).
  3883             20  CF-MORT-TABLE-TYPE         PIC X.
  3884                 88  CF-MORT-JOINT              VALUE 'J'.
  3885                 88  CF-MORT-SINGLE             VALUE 'S'.
  3886                 88  CF-MORT-COMBINED           VALUE 'C'.
  3887                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3888                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3889             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3890             20  CF-MORT-AGE-METHOD         PIC XX.
  3891                 88  CF-AGE-LAST                VALUE 'AL'.
  3892                 88  CF-AGE-NEAR                VALUE 'AN'.
  3893             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3894             20  CF-MORT-ADJUSTMENT-DIRECTION
  3895                                            PIC X.
  3896                 88  CF-MINUS                   VALUE '-'.
  3897                 88  CF-PLUS                    VALUE '+'.
  3898             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3899             20  CF-MORT-JOINT-CODE         PIC X.
  3900                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3901             20  CF-MORT-PC-Q               PIC X.
  3902                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3903             20  CF-MORT-TABLE-CODE         PIC X(4).
  3904             20  CF-MORT-COMMENTS           PIC X(15).
  3905             20  FILLER                     PIC X(14).
  3906
  3907         16  FILLER                         PIC X(251).
  3908
  3909
  3910****************************************************************
  3911*             BUSSINESS TYPE MASTER RECORD                     *
  3912****************************************************************
  3913
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  73
* EL640.cbl
  3914     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3915* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3916* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3917* AND RECORD 05 IS TYPES 81-99
  3918         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3919             20  CF-BUSINESS-TITLE          PIC  X(19).
  3920             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3921                                            PIC S9V9(4) COMP-3.
  3922             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3923             20  FILLER                     PIC  X.
  3924         16  FILLER                         PIC  X(248).
  3925
  3926
  3927****************************************************************
  3928*             TERMINAL MASTER RECORD                           *
  3929****************************************************************
  3930
  3931     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3932
  3933         16  CF-COMPANY-TERMINALS.
  3934             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3935                                  PIC X(4).
  3936         16  FILLER               PIC X(248).
  3937
  3938
  3939****************************************************************
  3940*             LIFE EDIT MASTER RECORD                          *
  3941****************************************************************
  3942
  3943     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3944         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3945             20  CF-LIFE-CODE-IN            PIC XX.
  3946             20  CF-LIFE-CODE-OUT           PIC XX.
  3947         16  FILLER                         PIC X(248).
  3948
  3949
  3950****************************************************************
  3951*             AH EDIT MASTER RECORD                            *
  3952****************************************************************
  3953
  3954     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3955         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3956             20  CF-AH-CODE-IN              PIC XXX.
  3957             20  CF-AH-CODE-OUT             PIC XX.
  3958         16  FILLER                         PIC X(248).
  3959
  3960
  3961****************************************************************
  3962*             CREDIBILITY TABLES                               *
  3963****************************************************************
  3964
  3965     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3966         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3967                             INDEXED BY CF-CRDB-NDX.
  3968             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3969             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3970             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3971         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  74
* EL640.cbl
  3972
  3973
  3974****************************************************************
  3975*             REPORT CUSTOMIZATION RECORD                      *
  3976****************************************************************
  3977
  3978     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3979         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3980             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3981             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3982             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3983**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3984****       A T-TRANSFER.                                   ****
  3985             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3986
  3987         16  FILLER                         PIC XX.
  3988
  3989         16  CF-CARRIER-CNTL-OPT.
  3990             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3991                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3992                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3993             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3994                                            PIC X.
  3995         16  CF-GROUP-CNTL-OPT.
  3996             20  CF-GROUP-OPT-SEQ           PIC 9.
  3997                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3998                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3999             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4000                                            PIC X(6).
  4001         16  CF-STATE-CNTL-OPT.
  4002             20  CF-STATE-OPT-SEQ           PIC 9.
  4003                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4004                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4005             20  CF-STATE-SELECT OCCURS 3 TIMES
  4006                                            PIC XX.
  4007         16  CF-ACCOUNT-CNTL-OPT.
  4008             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4009                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4010                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4011             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4012                                            PIC X(10).
  4013         16  CF-BUS-TYP-CNTL-OPT.
  4014             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4015                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4016                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4017             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4018                                            PIC XX.
  4019         16  CF-LF-TYP-CNTL-OPT.
  4020             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4021                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4022                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4023             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4024                                            PIC XX.
  4025         16  CF-AH-TYP-CNTL-OPT.
  4026             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4027                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4028                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4029             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  75
* EL640.cbl
  4030                                            PIC XX.
  4031         16  CF-REPTCD1-CNTL-OPT.
  4032             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4033                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4034                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4035             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4036                                            PIC X(10).
  4037         16  CF-REPTCD2-CNTL-OPT.
  4038             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4039                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4040                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4041             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4042                                            PIC X(10).
  4043         16  CF-USER1-CNTL-OPT.
  4044             20  CF-USER1-OPT-SEQ           PIC 9.
  4045                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4046                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4047             20  CF-USER1-SELECT OCCURS 3 TIMES
  4048                                            PIC X(10).
  4049         16  CF-USER2-CNTL-OPT.
  4050             20  CF-USER2-OPT-SEQ           PIC 9.
  4051                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4052                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4053             20  CF-USER2-SELECT OCCURS 3 TIMES
  4054                                            PIC X(10).
  4055         16  CF-USER3-CNTL-OPT.
  4056             20  CF-USER3-OPT-SEQ           PIC 9.
  4057                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4058                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4059             20  CF-USER3-SELECT OCCURS 3 TIMES
  4060                                            PIC X(10).
  4061         16  CF-USER4-CNTL-OPT.
  4062             20  CF-USER4-OPT-SEQ           PIC 9.
  4063                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4064                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4065             20  CF-USER4-SELECT OCCURS 3 TIMES
  4066                                            PIC X(10).
  4067         16  CF-USER5-CNTL-OPT.
  4068             20  CF-USER5-OPT-SEQ           PIC 9.
  4069                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4070                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4071             20  CF-USER5-SELECT OCCURS 3 TIMES
  4072                                            PIC X(10).
  4073         16  CF-REINS-CNTL-OPT.
  4074             20  CF-REINS-OPT-SEQ           PIC 9.
  4075                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4076                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4077             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4078                 24  CF-REINS-PRIME         PIC XXX.
  4079                 24  CF-REINS-SUB           PIC XXX.
  4080
  4081         16  CF-AGENT-CNTL-OPT.
  4082             20  CF-AGENT-OPT-SEQ           PIC 9.
  4083                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4084                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4085             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4086                                            PIC X(10).
  4087
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  76
* EL640.cbl
  4088         16  FILLER                         PIC X(43).
  4089
  4090         16  CF-LOSS-RATIO-SELECT.
  4091             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4092             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4093         16  CF-ENTRY-DATE-SELECT.
  4094             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4095             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4096         16  CF-EFFECTIVE-DATE-SELECT.
  4097             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4098             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4099
  4100         16  CF-EXCEPTION-LIST-IND          PIC X.
  4101             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4102
  4103         16  FILLER                         PIC X(318).
  4104
  4105****************************************************************
  4106*                  EXCEPTION REPORTING RECORD                  *
  4107****************************************************************
  4108
  4109     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4110         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4111             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4112
  4113         16  CF-COMBINED-LIFE-AH-OPT.
  4114             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4115             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4116             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4117             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4118
  4119         16  CF-LIFE-OPT.
  4120             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4121             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4122             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4123             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4124             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4125             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4126             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4127             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4128             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4129             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4130
  4131         16  CF-AH-OPT.
  4132             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4133             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4134             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4135             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4136             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4137             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4138             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4139             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4140             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4141             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4142
  4143         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4144             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4145             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  77
* EL640.cbl
  4146             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4147
  4148         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4149
  4150         16  FILLER                         PIC X(673).
  4151
  4152
  4153****************************************************************
  4154*             MORTGAGE SYSTEM PLAN RECORD                      *
  4155****************************************************************
  4156
  4157     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4158         16  CF-PLAN-TYPE                   PIC X.
  4159             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4160             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4161             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4162         16  CF-PLAN-ABBREV                 PIC XXX.
  4163         16  CF-PLAN-DESCRIPT               PIC X(10).
  4164         16  CF-PLAN-NOTES                  PIC X(20).
  4165         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4166         16  CF-PLAN-UNDERWRITING.
  4167             20  CF-PLAN-TERM-DATA.
  4168                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4169                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4170             20  CF-PLAN-AGE-DATA.
  4171                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4172                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4173                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4174             20  CF-PLAN-BENEFIT-DATA.
  4175                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4176                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4177                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4178                                            PIC S9(7)V99  COMP-3.
  4179         16  CF-PLAN-POLICY-FORMS.
  4180             20  CF-POLICY-FORM             PIC X(12).
  4181             20  CF-MASTER-APPLICATION      PIC X(12).
  4182             20  CF-MASTER-POLICY           PIC X(12).
  4183         16  CF-PLAN-RATING.
  4184             20  CF-RATE-CODE               PIC X(5).
  4185             20  CF-SEX-RATING              PIC X.
  4186                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4187                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4188             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4189             20  CF-SUB-STD-TYPE            PIC X.
  4190                 88  CF-PCT-OF-PREM            VALUE '1'.
  4191                 88  CF-PCT-OF-BENE            VALUE '2'.
  4192         16  CF-PLAN-PREM-TOLERANCES.
  4193             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4194             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4195         16  CF-PLAN-PYMT-TOLERANCES.
  4196             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4197             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4198         16  CF-PLAN-MISC-DATA.
  4199             20  FILLER                     PIC X.
  4200             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4201             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4202         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4203         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  78
* EL640.cbl
  4204             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4205                                                     '1'.
  4206             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4207                                                     '2'.
  4208         16  CF-MIB-SEARCH-SW               PIC X.
  4209             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4210             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4211             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4212             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4213         16  CF-ALPHA-SEARCH-SW             PIC X.
  4214             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4215             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4216             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4217             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4218             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4219             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4220             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4221             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4222             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4223             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4224                                                     'A' 'B' 'C'
  4225                                                     'X' 'Y' 'Z'.
  4226         16  CF-EFF-DT-RULE-SW              PIC X.
  4227             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4228             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4229             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4230             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4231             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4232         16  FILLER                         PIC X(4).
  4233         16  CF-HEALTH-QUESTIONS            PIC X.
  4234             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4235         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4236         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4237         16  CF-PLAN-SNGL-JNT               PIC X.
  4238             88  CF-COMBINED-PLAN              VALUE 'C'.
  4239             88  CF-JNT-PLAN                   VALUE 'J'.
  4240             88  CF-SNGL-PLAN                  VALUE 'S'.
  4241         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4242         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4243         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4244         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4245         16  CF-RERATE-CNTL                 PIC  X.
  4246             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4247             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4248             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4249             88  CF-AUTO-RECALC                 VALUE '4'.
  4250         16  CF-BENEFIT-TYPE                PIC  X.
  4251             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4252             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4253         16  CF-POLICY-FEE                  PIC S999V99
  4254                                                    COMP-3.
  4255         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4256         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4257         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4258         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4259         16  FILLER                         PIC  X(32).
  4260         16  CF-TERMINATION-FORM            PIC  X(04).
  4261         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  79
* EL640.cbl
  4262         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4263                                                       COMP-3.
  4264         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4265         16  CF-ISSUE-LETTER                PIC  X(4).
  4266         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4267         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4268             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4269             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4270         16  CF-MP-REFUND-CALC              PIC X.
  4271             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4272             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4273             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4274             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4275             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4276             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4277             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4278             88  CF-MP-REFD-MEAN                VALUE '8'.
  4279         16  CF-ALT-RATE-CODE               PIC  X(5).
  4280
  4281
  4282         16  FILLER                         PIC X(498).
  4283****************************************************************
  4284*             MORTGAGE COMPANY MASTER RECORD                   *
  4285****************************************************************
  4286
  4287     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4288         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4289         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4290             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4291             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4292             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4293             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4294             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4295
  4296         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4297         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4298         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4299         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4300         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4301
  4302         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4303             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4304         16  CF-MP-RECON-USE-IND            PIC X(1).
  4305             88  CF-MP-USE-RECON             VALUE 'Y'.
  4306         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4307             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4308         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4309             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4310             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4311         16  FILLER                         PIC X(1).
  4312         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4313             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4314         16  CF-MORTG-MIB-VERSION           PIC X.
  4315             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4316             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4317             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4318         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4319             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  80
* EL640.cbl
  4320                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4321             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4322                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4323             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4324                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4325             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4326                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4327             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4328                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4329             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4330                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4331         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4332         16  FILLER                         PIC X(7).
  4333         16  CF-MORTG-DESTINATION-SYMBOL.
  4334             20  CF-MORTG-MIB-COMM          PIC X(5).
  4335             20  CF-MORTG-MIB-TERM          PIC X(5).
  4336         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4337             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4338         16  FILLER                         PIC X(03).
  4339         16  CF-MP-CHECK-NO-CONTROL.
  4340             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4341                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4342                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4343                                                ' ' LOW-VALUES.
  4344                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4345                                               VALUE '3'.
  4346         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4347         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4348         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4349             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4350                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4351             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4352                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4353             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4354                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4355             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4356                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4357             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4358                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4359             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4360                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4361         16  CF-MORTG-BILLING-AREA.
  4362             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4363                                            PIC X.
  4364         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4365         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4366         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4367         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4368             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4369             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4370         16  FILLER                         PIC X.
  4371         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4372             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4373             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4374         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4375         16  FILLER                         PIC X(8).
  4376         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4377         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  81
* EL640.cbl
  4378         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4379         16  CF-ACH-COMPANY-ID.
  4380             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4381                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4382                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4383                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4384             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4385         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4386             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4387         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4388             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4389             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4390         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4391         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4392         16  FILLER                         PIC X(536).
  4393
  4394****************************************************************
  4395*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4396****************************************************************
  4397
  4398     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4399         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4400             20  CF-FEMALE-HEIGHT.
  4401                 24  CF-FEMALE-FT           PIC 99.
  4402                 24  CF-FEMALE-IN           PIC 99.
  4403             20  CF-FEMALE-MIN-WT           PIC 999.
  4404             20  CF-FEMALE-MAX-WT           PIC 999.
  4405         16  FILLER                         PIC X(428).
  4406
  4407     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4408         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4409             20  CF-MALE-HEIGHT.
  4410                 24  CF-MALE-FT             PIC 99.
  4411                 24  CF-MALE-IN             PIC 99.
  4412             20  CF-MALE-MIN-WT             PIC 999.
  4413             20  CF-MALE-MAX-WT             PIC 999.
  4414         16  FILLER                         PIC X(428).
  4415******************************************************************
  4416*             AUTOMATIC ACTIVITY RECORD                          *
  4417******************************************************************
  4418     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4419         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4420             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4421             20  CF-SYS-LETTER-ID           PIC X(04).
  4422             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4423             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4424             20  CF-SYS-RESET-SW            PIC X(01).
  4425             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4426             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4427
  4428         16  FILLER                         PIC X(50).
  4429
  4430         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4431             20  CF-USER-ACTIVE-SW          PIC X(01).
  4432             20  CF-USER-LETTER-ID          PIC X(04).
  4433             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4434             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4435             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  82
* EL640.cbl
  4436             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4437             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4438             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4439
  4440         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  83
* EL640.cbl
  4442*                            COPY ERCCOMP.
  4443******************************************************************
  4444*                                                                *
  4445*                                                                *
  4446*                            ERCCOMP                             *
  4447*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4448*                            VMOD=2.019                          *
  4449*                                                                *
  4450*   ONLINE CREDIT SYSTEM                                         *
  4451*                                                                *
  4452*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4453*                                                                *
  4454*   FILE TYPE = VSAM,KSDS                                        *
  4455*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4456*                                                                *
  4457*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4458*       ALTERNATE PATH = NONE                                    *
  4459*                                                                *
  4460*   LOG = NO                                                     *
  4461*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4462*                                                                *
  4463******************************************************************
  4464*                   C H A N G E   L O G
  4465*
  4466* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4467*-----------------------------------------------------------------
  4468*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4469* EFFECTIVE    NUMBER
  4470*-----------------------------------------------------------------
  4471* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4472* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4473* 092205    2005050300006  PEMA  ADD LEASE FEE
  4474* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4475* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4476* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4477* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4478* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4479* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4480******************************************************************
  4481
  4482 01  COMPENSATION-MASTER.
  4483     12  CO-RECORD-ID                          PIC XX.
  4484         88  VALID-CO-ID                          VALUE 'CO'.
  4485
  4486     12  CO-CONTROL-PRIMARY.
  4487         16  CO-COMPANY-CD                     PIC X.
  4488         16  CO-CONTROL.
  4489             20  CO-CTL-1.
  4490                 24  CO-CARR-GROUP.
  4491                     28  CO-CARRIER            PIC X.
  4492                     28  CO-GROUPING.
  4493                         32  CO-GROUP-PREFIX   PIC XXX.
  4494                         32  CO-GROUP-PRIME    PIC XXX.
  4495                 24  CO-RESP-NO.
  4496                     28  CO-RESP-PREFIX        PIC X(4).
  4497                     28  CO-RESP-PRIME         PIC X(6).
  4498             20  CO-CTL-2.
  4499                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  84
* EL640.cbl
  4500                     28  CO-ACCT-PREFIX        PIC X(4).
  4501                     28  CO-ACCT-PRIME         PIC X(6).
  4502         16  CO-TYPE                           PIC X.
  4503             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4504             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4505             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4506
  4507     12  CO-MAINT-INFORMATION.
  4508         16  CO-LAST-MAINT-DT                  PIC XX.
  4509         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4510         16  CO-LAST-MAINT-USER                PIC X(4).
  4511     12  FILLER                                PIC XX.
  4512     12  CO-STMT-TYPE                          PIC XXX.
  4513     12  CO-COMP-TYPE                          PIC X.
  4514         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4515     12  CO-STMT-OWNER                         PIC X(4).
  4516     12  CO-BALANCE-CONTROL                    PIC X.
  4517         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4518         88  CO-NO-BALANCE                        VALUE 'N'.
  4519
  4520     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4521         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4522         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4523         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4524
  4525     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4526         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4527         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4528
  4529     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4530     12  CO-GA-DIRECT-DEP                      PIC X.
  4531     12  CO-FUTURE-SPACE                       PIC X.
  4532         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4533
  4534     12  CO-ACCT-NAME                          PIC X(30).
  4535     12  CO-MAIL-NAME                          PIC X(30).
  4536     12  CO-ADDR-1                             PIC X(30).
  4537     12  CO-ADDR-2                             PIC X(30).
  4538     12  CO-ADDR-3.
  4539         16  CO-ADDR-CITY                      PIC X(27).
  4540         16  CO-ADDR-STATE                     PIC XX.
  4541     12  CO-CSO-1099                           PIC X.
  4542     12  CO-ZIP.
  4543         16  CO-ZIP-PRIME.
  4544             20  CO-ZIP-PRI-1ST                PIC X.
  4545                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4546             20  FILLER                        PIC X(4).
  4547         16  CO-ZIP-PLUS4                      PIC X(4).
  4548     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4549         16  CO-CAN-POSTAL-1                   PIC XXX.
  4550         16  CO-CAN-POSTAL-2                   PIC XXX.
  4551         16  FILLER                            PIC XXX.
  4552     12  CO-SOC-SEC                            PIC X(13).
  4553     12  CO-TELEPHONE.
  4554         16  CO-AREA-CODE                      PIC XXX.
  4555         16  CO-PREFIX                         PIC XXX.
  4556         16  CO-PHONE                          PIC X(4).
  4557
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  85
* EL640.cbl
  4558     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4559
  4560     12  CO-AR-BAL-LEVEL                       PIC X.
  4561         88  CO-AR-REF-LVL                        VALUE '1'.
  4562         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4563         88  CO-AR-BILL-LVL                       VALUE '2'.
  4564         88  CO-AR-AGT-LVL                        VALUE '3'.
  4565         88  CO-AR-FR-LVL                         VALUE '4'.
  4566
  4567     12  CO-AR-NORMAL-PRINT                    PIC X.
  4568         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4569         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4570
  4571     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4572
  4573     12  CO-AR-REPORTING                       PIC X.
  4574         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4575         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4576
  4577     12  CO-AR-PULL-CHECK                      PIC X.
  4578         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4579         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4580
  4581     12  CO-AR-BALANCE-PRINT                   PIC X.
  4582         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4583
  4584     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4585         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4586         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4587         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4588
  4589     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4590
  4591     12  CO-USER-CODE                          PIC X.
  4592     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4593
  4594******************************************************************
  4595*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4596*    THE LAST MONTH END RUN.
  4597******************************************************************
  4598
  4599     12  CO-LAST-ACTIVITY-DATE.
  4600         16  CO-ACT-YEAR                       PIC 99.
  4601         16  CO-ACT-MONTH                      PIC 99.
  4602         16  CO-ACT-DAY                        PIC 99.
  4603
  4604     12  CO-LAST-STMT-DT.
  4605         16  CO-LAST-STMT-YEAR                 PIC 99.
  4606         16  CO-LAST-STMT-MONTH                PIC 99.
  4607         16  CO-LAST-STMT-DAY                  PIC 99.
  4608
  4609     12  CO-MO-END-TOTALS.
  4610         16  CO-MONTHLY-TOTALS.
  4611             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4612             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4613             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4614             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4615             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  86
* EL640.cbl
  4616
  4617         16  CO-AGING-TOTALS.
  4618             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4619             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4620             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4621             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4622
  4623         16  CO-YTD-TOTALS.
  4624             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4625             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4626
  4627         16  CO-OVER-UNDER-TOTALS.
  4628             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4629             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4630
  4631     12  CO-MISCELLANEOUS-TOTALS.
  4632         16  CO-FICA-TOTALS.
  4633             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4634             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4635
  4636         16  CO-CLAIM-TOTALS.
  4637             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4638             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4639
  4640******************************************************************
  4641*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4642*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4643******************************************************************
  4644
  4645     12  CO-CURRENT-TOTALS.
  4646         16  CO-CURRENT-LAST-STMT-DT.
  4647             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4648             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4649             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4650
  4651         16  CO-CURRENT-MONTHLY-TOTALS.
  4652             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4653             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4654             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4655             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4656             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4657
  4658         16  CO-CURRENT-AGING-TOTALS.
  4659             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4660             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4661             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4662             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4663
  4664         16  CO-CURRENT-YTD-TOTALS.
  4665             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4666             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4667
  4668     12  CO-PAID-COMM-TOTALS.
  4669         16  CO-YTD-PAID-COMMS.
  4670             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4671             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4672
  4673     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  87
* EL640.cbl
  4674         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4675         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4676
  4677     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4678         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4679         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4680         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4681         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4682         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4683         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4684         88  CO-FINAL-LETTER                  VALUE 'F'.
  4685         88  CO-RECONCILING                   VALUE 'R'.
  4686         88  CO-PHONE-CALL                    VALUE 'P'.
  4687         88  CO-LEGAL                         VALUE 'L'.
  4688         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4689         88  CO-WRITE-OFF                     VALUE 'W'.
  4690         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4691
  4692     12  CO-CSR-CODE                       PIC X(4).
  4693
  4694     12  CO-GA-STATUS-INFO.
  4695         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4696         16  CO-GA-TERMINATION-DT          PIC XX.
  4697         16  CO-GA-STATUS-CODE             PIC X.
  4698             88  CO-GA-ACTIVE                 VALUE 'A'.
  4699             88  CO-GA-INACTIVE               VALUE 'I'.
  4700             88  CO-GA-PENDING                VALUE 'P'.
  4701         16  CO-GA-COMMENTS.
  4702             20  CO-GA-COMMENT-1           PIC X(40).
  4703             20  CO-GA-COMMENT-2           PIC X(40).
  4704             20  CO-GA-COMMENT-3           PIC X(40).
  4705             20  CO-GA-COMMENT-4           PIC X(40).
  4706
  4707     12  CO-RPTCD2                         PIC X(10).
  4708     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4709         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4710         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4711
  4712     12  CO-TYPE-AGENT                     PIC X(01).
  4713         88  CO-CORPORATION                   VALUE 'C'.
  4714         88  CO-PARTNERSHIP                   VALUE 'P'.
  4715         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4716         88  CO-TRUST                         VALUE 'T'.
  4717         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4718
  4719     12  CO-FAXNO.
  4720         16  CO-FAX-AREA-CODE                  PIC XXX.
  4721         16  CO-FAX-PREFIX                     PIC XXX.
  4722         16  CO-FAX-PHONE                      PIC X(4).
  4723
  4724     12  CO-BANK-INFORMATION.
  4725         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4726         16  CO-BANK-TRANSIT-NON REDEFINES
  4727             CO-BANK-TRANSIT-NO                PIC 9(8).
  4728
  4729         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4730     12  CO-MISC-DEDUCT-INFO REDEFINES
  4731                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  88
* EL640.cbl
  4732         16  CO-MD-GL-ACCT                     PIC X(10).
  4733         16  CO-MD-DIV                         PIC XX.
  4734         16  CO-MD-CENTER                      PIC X(4).
  4735         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4736         16  CO-CREATE-AP-CHECK                PIC X.
  4737         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4738         16  FILLER                            PIC XXX.
  4739     12  CO-ACH-STATUS                         PIC X.
  4740         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4741         88  CO-ACH-PENDING                        VALUE 'P'.
  4742
  4743     12  CO-BILL-SW                            PIC X.
  4744     12  CO-CONTROL-NAME                       PIC X(30).
  4745     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4746     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4747     12  CO-CLP-STATE                          PIC XX.
  4748     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4749     12  CO-SPP-REFUND-EDIT                    PIC X.
  4750
  4751******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  89
* EL640.cbl
  4753*                            COPY ERCPYAJ.
  4754******************************************************************
  4755*                                                                *
  4756*                            ERCPYAJ                             *
  4757*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4758*                            VMOD=2.015                          *
  4759*                                                                *
  4760*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  4761*                                                                *
  4762*                                                                *
  4763*   FILE TYPE = VSAM,KSDS                                        *
  4764*   RECORD SIZE = 200  RECFORM = FIXED                           *
  4765*                                                                *
  4766*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  4767*       ALTERNATE PATHS = NONE                                   *
  4768*                                                                *
  4769*   LOG = YES                                                    *
  4770*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4771******************************************************************
  4772******************************************************************
  4773*                   C H A N G E   L O G
  4774*
  4775* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4776*-----------------------------------------------------------------
  4777*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4778* EFFECTIVE    NUMBER
  4779*-----------------------------------------------------------------
  4780* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  4781* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  4782******************************************************************
  4783
  4784 01  PENDING-PAY-ADJ.
  4785     12  PY-RECORD-ID                     PIC XX.
  4786         88  VALID-PY-ID                        VALUE 'PY'.
  4787
  4788     12  PY-CONTROL-PRIMARY.
  4789         16  PY-COMPANY-CD                PIC X.
  4790         16  PY-CARRIER                   PIC X.
  4791         16  PY-GROUPING                  PIC X(6).
  4792         16  PY-FIN-RESP                  PIC X(10).
  4793         16  PY-ACCOUNT                   PIC X(10).
  4794         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  4795                                          PIC X(10).
  4796         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  4797         16  PY-RECORD-TYPE               PIC X.
  4798             88  PY-REMIT-RECEIVED            VALUE 'R'.
  4799             88  PY-DEPOSIT                   VALUE 'D'.
  4800             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  4801             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  4802             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  4803             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  4804             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  4805             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  4806             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  4807             88  PY-FICA-ENTRY                VALUE 'F'.
  4808             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  4809             88  PY-POLICY-FEE                VALUE 'W'.
  4810             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  90
* EL640.cbl
  4811
  4812     12  PY-PYMT-TYPE                     PIC X.
  4813             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  4814             88  PY-REINS-PYMT                VALUE 'R'.
  4815             88  PY-EXP-PYMT                  VALUE 'E'.
  4816
  4817     12  PY-BIL-INV                       PIC X(6).
  4818     12  PY-REF-NO                        PIC X(12).
  4819
  4820     12  PY-LAST-MAINT-DT                 PIC XX.
  4821     12  PY-LAST-MAINT-BY                 PIC X(4).
  4822     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4823
  4824     12  PY-PYADJ-RECORD.
  4825         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  4826         16  PY-ENTRY-COMMENT             PIC X(30).
  4827         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  4828             20  PY-GL-ACCOUNT            PIC X(10).
  4829             20  PY-GL-STATE              PIC X(02).
  4830             20  PY-GL-CANC-SW            PIC X(01).
  4831                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  4832                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  4833             20  PY-GL-COMMENT            PIC X(10).
  4834             20  FILLER      REDEFINES PY-GL-COMMENT.
  4835                 24  PY-GL-CHECK-NO       PIC 9(06).
  4836                 24  FILLER               PIC X(04).
  4837             20  FILLER                   PIC X(07).
  4838         16  PY-SAVE-ACCOUNT              PIC X(10).
  4839         16  PY-SAVE-TYPE                 PIC X(01).
  4840
  4841         16  PY-LETTERS.
  4842             20  PY-LETTER OCCURS 3 TIMES
  4843                           INDEXED BY PY-LET-NDX
  4844                                          PIC X(04).
  4845
  4846         16  PY-ERCOMP-TYPE               PIC X.
  4847             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  4848             88  PY-GA-TYPE                   VALUE 'G'.
  4849             88  PY-BANK-TYPE                 VALUE 'B'.
  4850         16  FILLER                       PIC X(05).
  4851
  4852     12  PY-RECORD-STATUS.
  4853         16  PY-CREDIT-SELECT-DT          PIC XX.
  4854         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  4855         16  PY-BILLED-DATE               PIC XX.
  4856         16  PY-REPORTED-DT               PIC XX.
  4857         16  PY-PMT-APPLIED               PIC X.
  4858             88  PY-ACCOUNT-PMT               VALUE 'A'.
  4859             88  PY-GA-PMT                    VALUE 'G'.
  4860             88  PY-OVWRITE-PMT               VALUE 'O'.
  4861             88  PY-NON-AR-PMT                VALUE 'N'.
  4862         16  FILLER                       PIC X(5).
  4863         16  PY-INPUT-DT                  PIC XX.
  4864         16  PY-CHECK-NUMBER              PIC X(6).
  4865         16  PY-VOID-SW                   PIC X.
  4866             88  PY-CHECK-VOIDED              VALUE 'V'.
  4867         16  PY-CHECK-ORIGIN-SW           PIC X.
  4868             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  91
* EL640.cbl
  4869             88  PY-REFUND-CHECK              VALUE 'R'.
  4870             88  PY-GA-CHECK                  VALUE 'G'.
  4871             88  PY-CHECK-WRITTEN             VALUE 'W'.
  4872             88  PY-CHECK-REVERSAL            VALUE 'V'.
  4873         16  PY-CHECK-WRITTEN-DT          PIC XX.
  4874         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  4875         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  4876         16  PY-BILL-FLAG                 PIC X.
  4877             88  PY-BILLED                    VALUE 'B'.
  4878         16  PY-AR-FLAG                   PIC X.
  4879             88  PY-AR-CYCLE                  VALUE 'C'.
  4880             88  PY-AR-MONTH-END              VALUE 'M'.
  4881         16  PY-AR-DATE                   PIC XX.
  4882
  4883     12  PY-GL-CODES.
  4884         16  PY-GL-DB                     PIC X(14).
  4885         16  PY-GL-CR                     PIC X(14).
  4886         16  PY-GL-FLAG                   PIC X.
  4887         16  PY-GL-DATE                   PIC XX.
  4888
  4889     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  4890     12  FILLER                           PIC X(3).
  4891******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  92
* EL640.cbl
  4893*                            COPY ERCACCT.
  4894******************************************************************
  4895*                                                                *
  4896*                                                                *
  4897*                            ERCACCT                             *
  4898*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4899*                            VMOD=2.031                          *
  4900*                                                                *
  4901*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4902*                                                                *
  4903*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4904*   VSAM ACCOUNT MASTER FILES.                                   *
  4905*                                                                *
  4906*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4907*                                                                *
  4908*   FILE TYPE = VSAM,KSDS                                        *
  4909*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4910*                                                                *
  4911*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4912*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4913*                                                                *
  4914*   LOG = NO                                                     *
  4915*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4916*                                                                *
  4917*                                                                *
  4918******************************************************************
  4919*                   C H A N G E   L O G
  4920*
  4921* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4922*-----------------------------------------------------------------
  4923*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4924* EFFECTIVE    NUMBER
  4925*-----------------------------------------------------------------
  4926* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4927* 092705    2005050300006  PEMA  ADD SPP LEASES
  4928* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4929* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4930* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4931* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4932* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4933* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  4934******************************************************************
  4935
  4936 01  ACCOUNT-MASTER.
  4937     12  AM-RECORD-ID                      PIC XX.
  4938         88  VALID-AM-ID                      VALUE 'AM'.
  4939
  4940     12  AM-CONTROL-PRIMARY.
  4941         16  AM-COMPANY-CD                 PIC X.
  4942         16  AM-MSTR-CNTRL.
  4943             20  AM-CONTROL-A.
  4944                 24  AM-CARRIER            PIC X.
  4945                 24  AM-GROUPING.
  4946                     28 AM-GROUPING-PREFIX PIC XXX.
  4947                     28 AM-GROUPING-PRIME  PIC XXX.
  4948                 24  AM-STATE              PIC XX.
  4949                 24  AM-ACCOUNT.
  4950                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  93
* EL640.cbl
  4951                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4952             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4953                                           PIC X(19).
  4954             20  AM-CNTRL-B.
  4955                 24  AM-EXPIRATION-DT      PIC XX.
  4956                 24  FILLER                PIC X(4).
  4957             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4958                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4959
  4960     12  AM-CONTROL-BY-VAR-GRP.
  4961         16  AM-COMPANY-CD-A1              PIC X.
  4962         16  AM-VG-CARRIER                 PIC X.
  4963         16  AM-VG-GROUPING                PIC X(6).
  4964         16  AM-VG-STATE                   PIC XX.
  4965         16  AM-VG-ACCOUNT                 PIC X(10).
  4966         16  AM-VG-DATE.
  4967             20  AM-VG-EXPIRATION-DT       PIC XX.
  4968             20  FILLER                    PIC X(4).
  4969         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4970                                           PIC 9(11)      COMP-3.
  4971     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4972         16  FILLER                        PIC X(10).
  4973         16  AM-VG-KEY3.
  4974             20  AM-VG3-ACCOUNT            PIC X(10).
  4975             20  AM-VG3-EXP-DT             PIC XX.
  4976         16  FILLER                        PIC X(4).
  4977     12  AM-MAINT-INFORMATION.
  4978         16  AM-LAST-MAINT-DT              PIC XX.
  4979         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4980         16  AM-LAST-MAINT-USER            PIC X(4).
  4981         16  FILLER                        PIC XX.
  4982
  4983     12  AM-EFFECTIVE-DT                   PIC XX.
  4984     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4985
  4986     12  AM-PREV-DATES  COMP-3.
  4987         16  AM-PREV-EXP-DT                PIC 9(11).
  4988         16  AM-PREV-EFF-DT                PIC 9(11).
  4989
  4990     12  AM-REPORT-CODE-1                  PIC X(10).
  4991     12  AM-REPORT-CODE-2                  PIC X(10).
  4992
  4993     12  AM-CITY-CODE                      PIC X(4).
  4994     12  AM-COUNTY-PARISH                  PIC X(6).
  4995
  4996     12  AM-NAME                           PIC X(30).
  4997     12  AM-PERSON                         PIC X(30).
  4998     12  AM-ADDRS                          PIC X(30).
  4999     12  AM-CITY.
  5000         16  AM-ADDR-CITY                  PIC X(28).
  5001         16  AM-ADDR-STATE                 PIC XX.
  5002     12  AM-ZIP.
  5003         16  AM-ZIP-PRIME.
  5004             20  AM-ZIP-PRI-1ST            PIC X.
  5005                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5006             20  FILLER                    PIC X(4).
  5007         16  AM-ZIP-PLUS4                  PIC X(4).
  5008     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  94
* EL640.cbl
  5009         16  AM-CAN-POSTAL-1               PIC XXX.
  5010         16  AM-CAN-POSTAL-2               PIC XXX.
  5011         16  FILLER                        PIC XXX.
  5012     12  AM-TEL-NO.
  5013         16  AM-AREA-CODE                  PIC 999.
  5014         16  AM-TEL-PRE                    PIC 999.
  5015         16  AM-TEL-NBR                    PIC 9(4).
  5016     12  AM-TEL-LOC                        PIC X.
  5017         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5018         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5019
  5020     12  AM-COMM-STRUCTURE.
  5021         16  AM-DEFN-1.
  5022             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5023                 24  AM-AGT.
  5024                     28  AM-AGT-PREFIX     PIC X(4).
  5025                     28  AM-AGT-PRIME      PIC X(6).
  5026                 24  AM-COM-TYP            PIC X.
  5027                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5028                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5029                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5030                 24  AM-RECALC-LV-INDIC    PIC X.
  5031                 24  AM-RETRO-LV-INDIC     PIC X.
  5032                 24  AM-GL-CODES           PIC X.
  5033                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5034                 24  FILLER                PIC X(01).
  5035         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5036             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5037                 24  FILLER                PIC X(11).
  5038                 24  AM-L-COMA             PIC XXX.
  5039                 24  AM-J-COMA             PIC XXX.
  5040                 24  AM-A-COMA             PIC XXX.
  5041                 24  FILLER                PIC X(6).
  5042
  5043     12  AM-COMM-CHANGE-STATUS             PIC X.
  5044         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5045
  5046     12  AM-CSR-CODE                       PIC X(4).
  5047
  5048     12  AM-BILLING-STATUS                 PIC X.
  5049         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5050         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5051     12  AM-AUTO-REFUND-SW                 PIC X.
  5052         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5053         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5054     12  AM-GPCD                           PIC 99.
  5055     12  AM-IG                             PIC X.
  5056         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5057         88  AM-HAS-GROUP                     VALUE '2'.
  5058     12  AM-STATUS                         PIC X.
  5059         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5060         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5061         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5062         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5063         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5064         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5065         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  5066         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  95
* EL640.cbl
  5067         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  5068         88  AM-ACCOUNT-PENDING               VALUE '9'.
  5069     12  AM-REMIT-TO                       PIC 99.
  5070     12  AM-ID-NO                          PIC X(11).
  5071
  5072     12  AM-CAL-TABLE                      PIC XX.
  5073     12  AM-LF-DEVIATION                   PIC XXX.
  5074     12  AM-AH-DEVIATION                   PIC XXX.
  5075     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5076     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5077     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5078     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5079     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5080     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5081
  5082     12  AM-USER-FIELDS.
  5083         16  AM-FLD-1                      PIC XX.
  5084         16  AM-FLD-2                      PIC XX.
  5085         16  AM-FLD-3                      PIC XX.
  5086         16  AM-FLD-4                      PIC XX.
  5087         16  AM-FLD-5                      PIC XX.
  5088
  5089     12  AM-1ST-PROD-DATE.
  5090         16  AM-1ST-PROD-YR                PIC XX.
  5091         16  AM-1ST-PROD-MO                PIC XX.
  5092         16  AM-1ST-PROD-DA                PIC XX.
  5093     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5094     12  AM-CERTS-PURGED-DATE.
  5095         16  AM-PUR-YR                     PIC XX.
  5096         16  AM-PUR-MO                     PIC XX.
  5097         16  AM-PUR-DA                     PIC XX.
  5098     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5099     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5100     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5101     12  AM-INACTIVE-DATE.
  5102         16  AM-INA-MO                     PIC 99.
  5103         16  AM-INA-DA                     PIC 99.
  5104         16  AM-INA-YR                     PIC 99.
  5105     12  AM-AR-HI-CERT-DATE                PIC XX.
  5106
  5107     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5108     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5109
  5110     12  AM-OB-PAYMENT-MODE                PIC X.
  5111         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5112         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5113         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5114         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5115
  5116     12  AM-AH-ONLY-INDICATOR              PIC X.
  5117         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5118         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5119
  5120     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5121
  5122     12  AM-OVER-SHORT.
  5123         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5124         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  96
* EL640.cbl
  5125
  5126     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5127     12  AM-DCC-CLP-STATE                  PIC XX.
  5128
  5129     12  AM-RECALC-COMM                    PIC X.
  5130     12  AM-RECALC-REIN                    PIC X.
  5131
  5132     12  AM-REI-TABLE                      PIC XXX.
  5133     12  AM-REI-ET-LF                      PIC X.
  5134     12  AM-REI-ET-AH                      PIC X.
  5135     12  AM-REI-PE-LF                      PIC X.
  5136     12  AM-REI-PE-AH                      PIC X.
  5137     12  AM-REI-PRT-ST                     PIC X.
  5138     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5139     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5140     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5141     12  AM-REI-GROUP-A                    PIC X(6).
  5142     12  AM-REI-MORT                       PIC X(4).
  5143     12  AM-REI-PRT-OW                     PIC X.
  5144     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5145     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5146     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5147     12  AM-REI-GROUP-B                    PIC X(6).
  5148
  5149     12  AM-TRUST-TYPE                     PIC X(2).
  5150
  5151     12  AM-EMPLOYER-STMT-USED             PIC X.
  5152     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5153
  5154     12  AM-STD-AH-TYPE                    PIC XX.
  5155     12  AM-EARN-METHODS.
  5156         16  AM-EARN-METHOD-R              PIC X.
  5157             88 AM-REF-RL-R78                 VALUE 'R'.
  5158             88 AM-REF-RL-PR                  VALUE 'P'.
  5159             88 AM-REF-RL-MEAN                VALUE 'M'.
  5160             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5161         16  AM-EARN-METHOD-L              PIC X.
  5162             88 AM-REF-LL-R78                 VALUE 'R'.
  5163             88 AM-REF-LL-PR                  VALUE 'P'.
  5164             88 AM-REF-LL-MEAN                VALUE 'M'.
  5165             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5166         16  AM-EARN-METHOD-A              PIC X.
  5167             88 AM-REF-AH-R78                 VALUE 'R'.
  5168             88 AM-REF-AH-PR                  VALUE 'P'.
  5169             88 AM-REF-AH-MEAN                VALUE 'M'.
  5170             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5171             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5172             88 AM-REF-AH-NET                 VALUE 'N'.
  5173
  5174     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5175     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5176     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5177
  5178     12  AM-RET-Y-N                        PIC X.
  5179     12  AM-RET-P-E                        PIC X.
  5180     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5181     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5182     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  97
* EL640.cbl
  5183     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5184         16  AM-POOL-PRIME                 PIC XXX.
  5185         16  AM-POOL-SUB                   PIC XXX.
  5186     12  AM-RETRO-EARNINGS.
  5187         16  AM-RET-EARN-R                 PIC X.
  5188         16  AM-RET-EARN-L                 PIC X.
  5189         16  AM-RET-EARN-A                 PIC X.
  5190     12  AM-RET-ST-TAX-USE                 PIC X.
  5191         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5192         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5193     12  AM-RETRO-BEG-EARNINGS.
  5194         16  AM-RET-BEG-EARN-R             PIC X.
  5195         16  AM-RET-BEG-EARN-L             PIC X.
  5196         16  AM-RET-BEG-EARN-A             PIC X.
  5197     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5198     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5199
  5200     12  AM-USER-SELECT-OPTIONS.
  5201         16  AM-USER-SELECT-1              PIC X(10).
  5202         16  AM-USER-SELECT-2              PIC X(10).
  5203         16  AM-USER-SELECT-3              PIC X(10).
  5204         16  AM-USER-SELECT-4              PIC X(10).
  5205         16  AM-USER-SELECT-5              PIC X(10).
  5206
  5207     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5208
  5209     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5210
  5211     12  AM-RPT045A-SWITCH                 PIC X.
  5212         88  RPT045A-OFF                   VALUE 'N'.
  5213
  5214     12  AM-INSURANCE-LIMITS.
  5215         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5216         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5217
  5218     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5219         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5220
  5221     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5222         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5223         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5224
  5225     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5226
  5227     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5228     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5229     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5230     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5231     12  AM-DCC-UEF-STATE                  PIC XX.
  5232     12  FILLER                            PIC XXX.
  5233     12  AM-REPORT-CODE-3                  PIC X(10).
  5234*    12  FILLER                            PIC X(22).
  5235
  5236     12  AM-RESERVE-DATE.
  5237         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5238         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5239         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5240
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  98
* EL640.cbl
  5241     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5242     12  AM-NOTIFICATION-TYPES.
  5243         16  AM-NOTIF-OF-LETTERS           PIC X.
  5244         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5245         16  AM-NOTIF-OF-REPORTS           PIC X.
  5246         16  AM-NOTIF-OF-STATUS            PIC X.
  5247
  5248     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5249         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5250         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5251         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5252         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5253
  5254     12  AM-BENEFIT-CONTROLS.
  5255         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5256             20  AM-BENEFIT-CODE           PIC XX.
  5257             20  AM-BENEFIT-TYPE           PIC X.
  5258             20  AM-BENEFIT-REVISION       PIC XXX.
  5259             20  AM-BENEFIT-REM-TERM       PIC X.
  5260             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5261             20  FILLER                    PIC XX.
  5262         16  FILLER                        PIC X(80).
  5263
  5264     12  AM-TRANSFER-DATA.
  5265         16  AM-TRANSFERRED-FROM.
  5266             20  AM-TRNFROM-CARRIER        PIC X.
  5267             20  AM-TRNFROM-GROUPING.
  5268                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5269                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5270             20  AM-TRNFROM-STATE          PIC XX.
  5271             20  AM-TRNFROM-ACCOUNT.
  5272                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5273                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5274             20  AM-TRNFROM-DTE            PIC XX.
  5275         16  AM-TRANSFERRED-TO.
  5276             20  AM-TRNTO-CARRIER          PIC X.
  5277             20  AM-TRNTO-GROUPING.
  5278                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5279                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5280             20  AM-TRNTO-STATE            PIC XX.
  5281             20  AM-TRNTO-ACCOUNT.
  5282                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5283                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5284             20  AM-TRNTO-DTE              PIC XX.
  5285         16  FILLER                        PIC X(10).
  5286
  5287     12  AM-SAVED-REMIT-TO                 PIC 99.
  5288
  5289     12  AM-COMM-STRUCTURE-SAVED.
  5290         16  AM-DEFN-1-SAVED.
  5291             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5292                 24  AM-AGT-SV             PIC X(10).
  5293                 24  AM-COM-TYP-SV         PIC X.
  5294                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5295                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5296                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5297                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5298                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page  99
* EL640.cbl
  5299                 24  AM-GL-CODES-SV        PIC X.
  5300                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5301                 24  FILLER                PIC X.
  5302         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5303             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5304                 24  FILLER                PIC X(11).
  5305                 24  AM-L-COMA-SV          PIC XXX.
  5306                 24  AM-J-COMA-SV          PIC XXX.
  5307                 24  AM-A-COMA-SV          PIC XXX.
  5308                 24  FILLER                PIC X(6).
  5309
  5310     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5311         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5312            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5313            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5314            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5315
  5316     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5317     12  FILLER                            PIC X(120).
  5318
  5319     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5320         16  AM-CONTROL-NAME               PIC X(30).
  5321         16  AM-EXECUTIVE-ONE.
  5322             20  AM-EXEC1-NAME             PIC X(15).
  5323             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5324                                                          COMP-3.
  5325             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5326                                                          COMP-3.
  5327         16  AM-EXECUTIVE-TWO.
  5328             20  AM-EXEC2-NAME             PIC X(15).
  5329             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5330                                                          COMP-3.
  5331             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5332                                                          COMP-3.
  5333
  5334     12  AM-RETRO-ADDITIONAL-DATA.
  5335         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5336         16  AM-RETRO-PREM-P-E             PIC X.
  5337         16  AM-RETRO-CLMS-P-I             PIC X.
  5338         16  AM-RETRO-RET-BRACKET-LF.
  5339             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5340                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5341                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5342             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5343                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5344                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5345             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5346                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5347                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5348         16  AM-RETRO-RET-BRACKET-AH.
  5349             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5350                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5351                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5352                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5353             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5354                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5355                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5356             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 100
* EL640.cbl
  5357                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5358                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5359
  5360     12  AM-COMMENTS.
  5361         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5362
  5363     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5364         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5365         16  AM-FLI-BILLING-CODE           PIC X.
  5366         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5367         16  AM-FLI-UNITED-IDENT           PIC X.
  5368         16  AM-FLI-INTEREST-LOST-DATA.
  5369             20  AM-FLI-BANK-NO            PIC X(5).
  5370             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5371             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5372             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5373         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5374             20  AM-FLI-AGT                PIC X(9).
  5375             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5376             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5377         16  FILLER                        PIC X(102).
  5378
  5379     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5380         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5381             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5382             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5383             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5384             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5385             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5386         16  FILLER                          PIC X(10).
  5387******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 101
* EL640.cbl
  5389*                            COPY ERCBILL.
  5390******************************************************************
  5391*                                                                *
  5392*                                                                *
  5393*                            ERCBILL                             *
  5394*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5395*                            VMOD=2.007                          *
  5396*                                                                *
  5397*   FILE DESCRIPTION = BILLING STATEMENTS FOR PRINTING           *
  5398*                                                                *
  5399*   FILE TYPE = VSAM,KSDS                                        *
  5400*   RECORD SIZE = 210  RECFORM = FIXED                           *
  5401*                                                                *
  5402*   BASE CLUSTER = ERBILL                        RKP=2,LEN=31    *
  5403*                                                                *
  5404*   LOG = NO                                                     *
  5405*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5406******************************************************************
  5407******************************************************************
  5408*                   C H A N G E   L O G
  5409*
  5410* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5411*-----------------------------------------------------------------
  5412*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5413* EFFECTIVE    NUMBER
  5414*-----------------------------------------------------------------
  5415* 032219  CR2019020800001  PEMA  Increase width of bi-type column
  5416******************************************************************
  5417 01  BILLING-STATEMENT.
  5418     02 BILLING-STATEMENT-FILE.
  5419     12  BI-RECORD-ID                PIC XX.
  5420         88  VALID-BI-ID                VALUE 'BI'.
  5421
  5422     12  BI-CONTROL-PRIMARY.
  5423         16  BI-COMPANY-CD           PIC X.
  5424         16  BI-CARRIER              PIC X.
  5425         16  BI-GROUPING             PIC X(6).
  5426         16  BI-ACCOUNT              PIC X(10).
  5427         16  BI-FIN-RESP             PIC X(10).
  5428         16  BI-RECORD-TYPE          PIC X.
  5429             88  BI-HEADER-DATA         VALUE '1'.
  5430             88  BI-ADDRESS-DATA        VALUE '2'.
  5431             88  BI-TEXT-DATA           VALUE '3'.
  5432         16  BI-LINE-SEQ-NO          PIC S9(4)     COMP.
  5433
  5434     12  BI-TEXT-RECORD.
  5435         16  BI-SKIP-CONTROL         PIC X.
  5436         16  BI-TEXT-LINE            PIC X(157).
  5437         16  BI-TEXT-LINE-1 REDEFINES BI-TEXT-LINE.
  5438             20  BI-ADDR-LIT         PIC X(14).
  5439             20  BI-CO               PIC X(7).
  5440             20  BI-DASH             PIC X.
  5441             20  BI-ACCT             PIC X(10).
  5442             20  FILLER              PIC XX.
  5443             20  BI-ACCT-ADDR        PIC X(30).
  5444             20  FILLER              PIC X.
  5445             20  BI-REMIT-LIT        PIC X(11).
  5446             20  FILLER              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 102
* EL640.cbl
  5447             20  BI-REMIT-ADDR       PIC X(30).
  5448             20  FILLER              PIC X(49).
  5449         16  BI-TEXT-LINE-2 REDEFINES BI-TEXT-LINE.
  5450             20  BI-INS-LAST-NAME    PIC X(15).
  5451             20  FILLER              PIC X.
  5452             20  BI-INS-1ST-NAME     PIC X(10).
  5453             20  FILLER REDEFINES BI-INS-1ST-NAME.
  5454                 24  BI-INS-INITS    PIC XX.
  5455                 24  FILLER          PIC X(8).
  5456             20  FILLER              PIC X.
  5457             20  BI-UNDRWRTR.
  5458                 24  BI-INS-INIT     PIC X.
  5459                 24  FILLER          PIC XX.
  5460             20  BI-CERT             PIC X(11).
  5461             20  FILLER              PIC X.
  5462             20  BI-EFF-DT           PIC X(8).
  5463             20  FILLER              PIC X.
  5464             20  BI-CAN-DT           PIC X(8).
  5465             20  FILLER              PIC X.
  5466             20  BI-ED-TERM          PIC ZZZ.
  5467             20  FILLER              PIC X.
  5468             20  BI-TYPE             PIC X(17).
  5469*            20  FILLER              PIC X.
  5470             20  BI-PREM             PIC Z,ZZZ,ZZZ.ZZ-.
  5471             20  FILLER              PIC XX.
  5472             20  BI-ED-RATE          PIC ZZZ.ZZZ.
  5473             20  FILLER              PIC XX.
  5474             20  BI-COMM             PIC ZZZ,ZZZ.ZZ-.
  5475             20  FILLER              PIC X.
  5476             20  BI-FACE-AMT         PIC ZZ,ZZZ,ZZZ.ZZ-.
  5477             20  FILLER              PIC X(26).
  5478         16  BI-TEXT-LINE-3 REDEFINES BI-TEXT-LINE.
  5479             20  FILLER              PIC X(42).
  5480             20  BI-TOT-DESC         PIC X(20).
  5481             20  FILLER REDEFINES BI-TOT-DESC.
  5482                 24  BI-TOT-LIT      PIC X(6).
  5483                 24  BI-OVERRIDE-L6  PIC X(14).
  5484             20  FILLER              PIC X(17).
  5485             20  BI-TOT-PREM         PIC ZZZ,ZZZ,ZZZ.99-.
  5486             20  BI-TOT-DASH REDEFINES
  5487                 BI-TOT-PREM         PIC X(15).
  5488             20  FILLER              PIC X(07).
  5489             20  BI-COM-TOT          PIC ZZZ,ZZZ,ZZZ.99-.
  5490             20  FILLER              PIC XX.
  5491             20  BI-FACE-TOT         PIC ZZZ,ZZZ,ZZZ.99-.
  5492             20  FILLER              PIC X(24).
  5493         16  BI-TEXT-LINE-4 REDEFINES BI-TEXT-LINE.
  5494             20  BI-ENTRY-DESC       PIC X(30).
  5495             20  FILLER              PIC X(11).
  5496             20  BI-ENTRY-AMT        PIC ZZZZ,ZZZ,ZZZ.99-.
  5497             20  FILLER              PIC X(31).
  5498             20  BI-ACCTG-COMMENT    PIC X(30).
  5499             20  FILLER              PIC X(39).
  5500         16  BI-TEXT-LINE-5 REDEFINES BI-TEXT-LINE.
  5501             20  FILLER              PIC X(42).
  5502             20  BI-TOT-DESC5        PIC X(20).
  5503             20  FILLER              PIC X(11).
  5504             20  BI-TOT-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 103
* EL640.cbl
  5505             20  BI-COM-TOT5         PIC ZZZ,ZZZ,ZZZ.99-.
  5506             20  BI-NON-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5507             20  BI-NON-COMM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5508             20  FILLER              PIC X(24).
  5509         16  BI-TEXT-FIRST REDEFINES BI-TEXT-LINE.
  5510             20  BI-TEXT-2-81        PIC X(80).
  5511             20  FILLER              PIC X(77).
  5512         16  BI-TEXT-LAST REDEFINES BI-TEXT-LINE.
  5513             20  FILLER              PIC X(53).
  5514             20  BI-TEXT-55-133      PIC X(79).
  5515             20  FILLER              PIC X(25).
  5516         16  BI-TEXT-TYPE            PIC X.
  5517             88 DETAIL-LINE              VALUE 'D'.
  5518         16  BI-TERM                 PIC S999.
  5519         16  BI-BENEFIT-AMT          PIC S9(9)V99 COMP-3.
  5520         16  BI-PREMIUM-AMT          PIC S9(7)V99 COMP-3.
  5521         16  BI-RATE                 PIC S99V9(5) COMP-3.
  5522
  5523     12  BI-ADDRESS-RECORD  REDEFINES  BI-TEXT-RECORD.
  5524         16  FILLER                  PIC X.
  5525         16  BI-ACCT-ADDRESS-LINE    PIC X(30).
  5526         16  FILLER                  PIC X(10).
  5527         16  BI-REMIT-ADDRESS-LINE   PIC X(30).
  5528         16  FILLER                  PIC X(106).
  5529
  5530     12  BI-HEADER-RECORD  REDEFINES  BI-TEXT-RECORD.
  5531         16  BI-PROCESSOR-CD         PIC X(4).
  5532         16  BI-STATEMENT-TYPE       PIC X.
  5533             88  BI-PREVIEW-ONLY         VALUE 'P'.
  5534         16  BI-NO-OF-COPIES         PIC S9.
  5535         16  BI-CREATION-DT          PIC XX.
  5536         16  BI-INITIAL-PRINT-DATE   PIC XX.
  5537         16  BI-ACCOUNT-TOTALS.
  5538             20  BI-BAL-FRWD         PIC S9(9)V99     COMP-3.
  5539             20  BI-PREMIUM          PIC S9(9)V99     COMP-3.
  5540             20  BI-REMITTED         PIC S9(9)V99     COMP-3.
  5541             20  BI-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5542             20  BI-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5543             20  BI-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5544             20  BI-DISBURSED        PIC S9(9)V99     COMP-3.
  5545             20  BI-END-BAL          PIC S9(9)V99     COMP-3.
  5546         16  BI-FIN-RESP-ACCT        PIC X(10).
  5547         16  BI-FIN-RESP-NAME        PIC X(30).
  5548         16  FILLER                  PIC X(79).
  5549
  5550
  5551     02 GA-BILLING-STATEMENT REDEFINES BILLING-STATEMENT-FILE.
  5552     12  FILLER                      PIC XX.
  5553
  5554     12  GA-CONTROL-PRIMARY.
  5555         16  FILLER                  PIC X(31).
  5556
  5557     12  GA-TEXT-RECORD.
  5558         16  GA-SKIP-CONTROL         PIC X.
  5559         16  GA-TEXT-LINE            PIC X(132).
  5560         16  GA-TEXT-LINE-1 REDEFINES GA-TEXT-LINE.
  5561             20  FILLER              PIC X.
  5562             20  GA-CARRIER          PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 104
* EL640.cbl
  5563             20  GA-GROUPING         PIC X(6).
  5564             20  GA-DASH             PIC X.
  5565             20  GA-AGENT            PIC X(10).
  5566             20  FILLER              PIC X.
  5567             20  GA-AGENT-ADDR       PIC X(30).
  5568             20  FILLER              PIC X(82).
  5569         16  GA-TEXT-LINE-2 REDEFINES GA-TEXT-LINE.
  5570             20  GA-ACCT             PIC X(10).
  5571             20  FILLER              PIC X.
  5572             20  GA-ACCT-NAME        PIC X(30).
  5573             20  GA-BEG-BAL          PIC ZZZZ,ZZZ.99-.
  5574             20  GA-NET-PREM         PIC ZZZZ,ZZZ.ZZ-.
  5575             20  GA-ACCT-COMP        PIC ZZZZ,ZZZ.ZZ-.
  5576             20  GA-PMTS-ADJS        PIC ZZZZ,ZZZ.ZZ-.
  5577             20  GA-UNPAID-NET-PREM  PIC ZZZZ,ZZZ.ZZ-.
  5578             20  GA-BEN-OVERRIDE-L6  PIC X(6).
  5579             20  FILLER              PIC X.
  5580             20  GA-OVERWRITE        PIC ZZZZ,ZZZ.ZZ-.
  5581             20  GA-AMT-DUE          PIC ZZZ,ZZZ.99-.
  5582             20  FILLER              PIC X.
  5583         16  GA-TEXT-LINE-3 REDEFINES GA-TEXT-LINE.
  5584             20  FILLER              PIC X(11).
  5585             20  GA-ENTRY-DESC       PIC X(30).
  5586             20  FILLER              PIC X(60).
  5587             20  GA-ENTRY-COMMENT    PIC X(30).
  5588             20  FILLER              PIC X.
  5589         16  FILLER.
  5590             20  GA-BENEFIT-CD       PIC XX.
  5591             20  GA-BEG-BAL-AMT      PIC S9(7)V99 COMP-3.
  5592             20  GA-END-BAL-AMT      PIC S9(7)V99 COMP-3.
  5593             20  GA-NET-PREM-AMT     PIC S9(7)V99 COMP-3.
  5594             20  GA-ACCT-COMP-AMT    PIC S9(7)V99 COMP-3.
  5595             20  GA-PMTS-ADJS-AMT    PIC S9(7)V99 COMP-3.
  5596             20  GA-UNPAID-NET-AMT   PIC S9(7)V99 COMP-3.
  5597             20  GA-OVERWRITE-AMT    PIC S9(7)V99 COMP-3.
  5598             20  GA-AMT-DUE-AMT      PIC S9(7)V99 COMP-3.
  5599
  5600     12  GA-ADDRESS-RECORD  REDEFINES  GA-TEXT-RECORD.
  5601         16  FILLER                  PIC X.
  5602         16  GA-ACCT-ADDRESS-LINE    PIC X(30).
  5603         16  FILLER                  PIC X(144).
  5604
  5605     12  GA-HEADER-RECORD  REDEFINES  GA-TEXT-RECORD.
  5606         16  GA-PROCESSOR-CD         PIC X(4).
  5607         16  GA-STATEMENT-TYPE       PIC X.
  5608             88  GA-PREVIEW-ONLY         VALUE 'P'.
  5609         16  GA-NO-OF-COPIES         PIC S9.
  5610         16  GA-CREATION-DT          PIC XX.
  5611         16  GA-INITIAL-PRINT-DATE   PIC XX.
  5612         16  GA-AGENT-TOTALS.
  5613             20  GA-NET-UNPD         PIC S9(9)V99     COMP-3.
  5614             20  GA-COMP-UNPD-PREM   PIC S9(9)V99     COMP-3.
  5615             20  GA-PREMIUM          PIC S9(9)V99     COMP-3.
  5616             20  GA-REMITTED         PIC S9(9)V99     COMP-3.
  5617             20  GA-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5618             20  GA-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5619             20  GA-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5620             20  GA-DISBURSED        PIC S9(9)V99     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 105
* EL640.cbl
  5621             20  GA-END-BALANCE      PIC S9(9)V99     COMP-3.
  5622         16  GA-AGENTS-NAME          PIC X(30).
  5623         16  FILLER                  PIC X(81).
  5624     12  FILLER                      PIC XX.
  5625
  5626
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 106
* EL640.cbl
  5628*                            COPY ELCTEXT.
  5629******************************************************************
  5630*                                                                *
  5631*                                                                *
  5632*                            ELCTEXT.                            *
  5633*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5634*                            VMOD=2.008                          *
  5635*                                                                *
  5636*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  5637*                                     FORM LETTERS,              *
  5638*                                     CERT FORM DISPLAY.
  5639*                                                                *
  5640*   FILE TYPE = VSAM,KSDS                                        *
  5641*   RECORD SIZE = 100   RECFORM = FIXED                          *
  5642*                                                                *
  5643*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  5644*       ALTERNATE INDEX = NONE                                   *
  5645*                                                                *
  5646*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  5647*       ALTERNATE INDEX = NONE                                   *
  5648*                                                                *
  5649*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  5650*       ALTERNATE INDEX = NONE                                   *
  5651*                                                                *
  5652*   LOG = NO                                                     *
  5653*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5654******************************************************************
  5655 01  TEXT-FILES.
  5656     12  TEXT-FILE-ID                PIC XX.
  5657         88  FORMS-FILE-TEXT            VALUE 'TF'.
  5658         88  LETTER-FILE-TEXT           VALUE 'TL'.
  5659         88  HELP-FILE-TEXT             VALUE 'TH'.
  5660
  5661     12  TX-CONTROL-PRIMARY.
  5662         16  TX-COMPANY-CD           PIC X.
  5663             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  5664         16  TX-ACCESS-CD-GENL       PIC X(12).
  5665
  5666         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5667             20  TX-LETTER-NO        PIC X(4).
  5668             20  FILLER              PIC X(8).
  5669
  5670         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5671             20  TX-FORM-NO          PIC X(12).
  5672
  5673         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5674             20  TX-HELP-TYPE        PIC X.
  5675                 88  HELP-FOR-GENERAL   VALUE ' '.
  5676                 88  HELP-BY-SCREEN     VALUE 'S'.
  5677                 88  HELP-BY-ERROR      VALUE 'E'.
  5678             20  TX-SCREEN-OR-ERROR  PIC X(4).
  5679                 88  GENERAL-INFO-HELP  VALUE '0000'.
  5680             20  TX-HELP-FOR-COMPANY  PIC XXX.
  5681                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  5682             20  FILLER              PIC X(4).
  5683
  5684         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  5685
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 107
* EL640.cbl
  5686     12  TX-PROCESS-CONTROL          PIC XX.
  5687         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  5688
  5689     12  TX-TEXT-LINE                PIC X(70).
  5690
  5691     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  5692         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  5693         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  5694         88  TX-VALID-FORM-SQUEEZE-VALUE
  5695                                        VALUE 'Y' ' '.
  5696
  5697     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  5698         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  5699         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  5700         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  5701         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  5702         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  5703         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  5704         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  5705                                              'K' 'N' ' '
  5706                                              'Z'.
  5707
  5708     12  TX-ARCHIVE-SW               PIC X.
  5709         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  5710         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  5711         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  5712
  5713     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  5714     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  5715
  5716     12  TX-BSR-CODE                 PIC X.
  5717         88  TX-BSR-LETTER              VALUE 'B'.
  5718         88  TX-NON-BSR-LETTER          VALUE ' '.
  5719
  5720     12  FILLER                      PIC X.
  5721*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 108
* EL640.cbl
  5723
  5724 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  5725                          CONTROL-FILE COMPENSATION-MASTER
  5726                          PENDING-PAY-ADJ ACCOUNT-MASTER
  5727                          BILLING-STATEMENT TEXT-FILES.
  5728 0000-DFHEXIT SECTION.
  5729     MOVE '9#                    $   ' TO DFHEIV0.
  5730     MOVE 'EL640' TO DFHEIV1.
  5731     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5732
  5733     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5734     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  5735     MOVE EIBTRMID               TO QID-TERM.
  5736     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  5737     MOVE '5'                    TO DC-OPTION-CODE.
  5738     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  5739     MOVE DC-BIN-DATE-1          TO WS-CURRENT-DATE.
  5740     MOVE DC-GREG-DATE-1-MDY     TO WS-CURRENT-DATE-MDY.
  5741     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DATE-EDIT.
  5742
  5743     IF EIBCALEN = 0
  5744         GO TO 8800-UNAUTHORIZED-ACCESS.
  5745
  5746     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5747         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  5748
  5749     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5750         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5751             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5752             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5753             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5754             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5755             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5756             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5757             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5758             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5759             MOVE PI-CR-CONTROL-IN-PROGRESS TO W-TRANSFER-CONTROL
  5760             MOVE SPACES          TO PI-CR-CONTROL-IN-PROGRESS
  5761         ELSE
  5762             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  5763             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  5764             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  5765             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  5766             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  5767             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  5768             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  5769             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  5770
  5771     MOVE LOW-VALUES             TO EL640AI.
  5772
  5773     IF PI-AR-PROCESSING
  5774        MOVE XCTL-635            TO XCTL-PYAJ.
  5775
  5776     IF PI-COMPANY-ID = 'DMD'
  5777        MOVE XCTL-633DMD         TO XCTL-PYAJ.
  5778
  5779     IF RETURNED-FROM NOT = SPACES
  5780         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 109
* EL640.cbl
  5781         IF RETURNED-FROM = XCTL-PYAJ AND NOT PI-VOID-BILL
  5782             MOVE ZEROS          TO PI-ADJUSTMENTS
  5783                                    PI-DISBURSED
  5784                                    PI-REMITTED
  5785             GO TO 1100-PYAJ-BILLING-PROCESS
  5786         ELSE
  5787             MOVE -1             TO APFNTERL
  5788             PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT
  5789             GO TO 8100-SEND-INITIAL-MAP.
  5790
  5791     IF EIBTRNID NOT = TRANS-ID
  5792         PERFORM 0400-CLEAR-PI  THRU  0499-EXIT
  5793         MOVE EL640A             TO PI-MAP-NAME
  5794         MOVE -1                 TO APFNTERL
  5795         GO TO 8100-SEND-INITIAL-MAP.
  5796
  5797
  5798* EXEC CICS HANDLE CONDITION
  5799*        PGMIDERR  (9600-PGMID-ERROR)
  5800*        ERROR     (9990-ABEND)
  5801*    END-EXEC.
  5802*    MOVE '"$L.                  ! " #00005793' TO DFHEIV0
  5803     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5804     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5805     MOVE X'2220233030303035373933' TO DFHEIV0(25:11)
  5806     CALL 'kxdfhei1' USING DFHEIV0
  5807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5808
  5809
  5810     IF EIBAID = DFHCLEAR
  5811         IF PI-MAP-NAME = EL640B
  5812             PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT
  5813             MOVE EL640A         TO PI-MAP-NAME
  5814             MOVE -1             TO APFNTERL
  5815             GO TO 8100-SEND-INITIAL-MAP
  5816         ELSE
  5817             GO TO 9400-CLEAR.
  5818
  5819     IF PI-PROCESSOR-ID = 'LGXX'
  5820         GO TO 0200-RECEIVE.
  5821
  5822
  5823* EXEC CICS READQ TS
  5824*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5825*        INTO   (SECURITY-CONTROL)
  5826*        LENGTH (SC-COMM-LENGTH)
  5827*        ITEM   (SC-ITEM)
  5828*    END-EXEC.
  5829*    MOVE '*$II   L              ''   #00005810' TO DFHEIV0
  5830     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5831     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5832     MOVE X'2020233030303035383130' TO DFHEIV0(25:11)
  5833     CALL 'kxdfhei1' USING DFHEIV0,
  5834           PI-SECURITY-TEMP-STORE-ID,
  5835           SECURITY-CONTROL,
  5836           SC-COMM-LENGTH,
  5837           SC-ITEM,
  5838           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 110
* EL640.cbl
  5839           DFHEIV99
  5840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5841
  5842
  5843     MOVE SC-CREDIT-DISPLAY (18)  TO PI-DISPLAY-CAP.
  5844     MOVE SC-CREDIT-UPDATE  (18)  TO PI-MODIFY-CAP.
  5845
  5846     IF NOT DISPLAY-CAP
  5847         MOVE 'READ'          TO SM-READ
  5848         PERFORM 9995-SECURITY-VIOLATION
  5849         MOVE ER-0070         TO  EMI-ERROR
  5850         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5851         GO TO 8100-SEND-INITIAL-MAP.
  5852
  5853 0200-RECEIVE.
  5854     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5855         MOVE ER-0008            TO EMI-ERROR
  5856         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5857         IF PI-MAP-NAME = EL640A
  5858             MOVE -1             TO APFNTERL
  5859             GO TO 8200-SEND-DATAONLY
  5860         ELSE
  5861             MOVE -1             TO BPFNTERL
  5862             GO TO 8200-SEND-DATAONLY.
  5863
  5864
  5865* EXEC CICS RECEIVE
  5866*        MAP      (PI-MAP-NAME)
  5867*        MAPSET   (MAPSET-NAME)
  5868*        INTO     (EL640AI)
  5869*    END-EXEC.
  5870     MOVE LENGTH OF
  5871      EL640AI
  5872       TO DFHEIV11
  5873*    MOVE '8"T I  L              ''   #00005838' TO DFHEIV0
  5874     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5875     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5876     MOVE X'2020233030303035383338' TO DFHEIV0(25:11)
  5877     CALL 'kxdfhei1' USING DFHEIV0,
  5878           PI-MAP-NAME,
  5879           EL640AI,
  5880           DFHEIV11,
  5881           MAPSET-NAME,
  5882           DFHEIV99,
  5883           DFHEIV99
  5884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5885
  5886
  5887     IF PI-END-BAL NOT NUMERIC
  5888         MOVE ZEROS              TO PI-END-BAL.
  5889
  5890     IF PI-MAP-NAME = EL640A
  5891         IF APFNTERL > ZERO
  5892             IF EIBAID NOT = DFHENTER
  5893                 MOVE ER-0004    TO EMI-ERROR
  5894                 MOVE AL-UNBOF   TO APFNTERA
  5895                 MOVE -1         TO APFNTERL
  5896                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 111
* EL640.cbl
  5897                 GO TO 8200-SEND-DATAONLY
  5898             ELSE
  5899                 IF APFNTERI NUMERIC AND
  5900                   (APFNTERI > 0 AND < 25)
  5901                     MOVE PF-VALUES (APFNTERI) TO EIBAID
  5902                 ELSE
  5903                     MOVE ER-0029  TO EMI-ERROR
  5904                     MOVE AL-UNBOF TO APFNTERA
  5905                     MOVE -1       TO APFNTERL
  5906                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5907                     GO TO 8200-SEND-DATAONLY
  5908         ELSE
  5909             NEXT SENTENCE
  5910     ELSE
  5911     IF PI-MAP-NAME = EL640B
  5912         IF BPFNTERL > ZERO
  5913             IF EIBAID NOT = DFHENTER
  5914                 MOVE ER-0004    TO EMI-ERROR
  5915                 MOVE AL-UNBOF   TO BPFNTERA
  5916                 MOVE -1         TO BPFNTERL
  5917                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5918                 GO TO 8200-SEND-DATAONLY
  5919             ELSE
  5920                 IF BPFNTERI NUMERIC AND
  5921                   (BPFNTERI > 0 AND < 25)
  5922                     MOVE PF-VALUES (BPFNTERI) TO EIBAID
  5923                 ELSE
  5924                     MOVE ER-0029  TO EMI-ERROR
  5925                     MOVE AL-UNBOF TO BPFNTERA
  5926                     MOVE -1       TO BPFNTERL
  5927                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5928                     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 112
* EL640.cbl
  5930 0300-CHECK-PFKEYS.
  5931     IF EIBAID = DFHPF23
  5932         GO TO 8810-PF23.
  5933
  5934     IF EIBAID = DFHPF24
  5935         GO TO 9200-RETURN-MAIN-MENU.
  5936
  5937     IF EIBAID = DFHPF12
  5938         GO TO 9500-PF12.
  5939
  5940******************************************************************
  5941*       IF CARRIER OR ACCOUNT SECURITY ALLOW ONLY                *
  5942*            BILLING TYPE OPTION ONE OR TWO.                     *
  5943*                        04/27/84                                *
  5944******************************************************************
  5945
  5946     IF PI-NO-CARRIER-SECURITY OR
  5947        PI-NO-ACCOUNT-SECURITY
  5948          GO TO 0305-CHECK-PFKEYS.
  5949
  5950     IF EIBAID = DFHENTER OR DFHPF6
  5951        NEXT SENTENCE
  5952       ELSE
  5953        GO TO 0320-INPUT-ERROR.
  5954
  5955 0305-CHECK-PFKEYS.
  5956     IF EIBAID = DFHPF3
  5957       AND PI-MAP-NAME = EL640A
  5958         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5959         MOVE PI-CARRIER         TO PI-CR-CARRIER
  5960         MOVE PI-GROUPING        TO PI-CR-GROUPING
  5961         MOVE PI-STATE           TO PI-CR-STATE
  5962         MOVE PI-ACCOUNT         TO PI-CR-ACCOUNT
  5963         MOVE XCTL-650           TO PGM-NAME
  5964         GO TO 9300-XCTL.
  5965
  5966     IF EIBAID = DFHPF4
  5967       AND PI-MAP-NAME = EL640A
  5968        NEXT SENTENCE
  5969     ELSE
  5970        GO TO 0320-CONT-PFKEYS.
  5971
  5972     IF PI-CR-FIN-RESP NOT = SPACES
  5973         PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5974         MOVE PI-COMP-CARRIER    TO PI-CR-CARRIER
  5975         MOVE PI-COMP-GROUPING   TO PI-CR-GROUPING
  5976         MOVE PI-COMP-FIN-RESP   TO PI-CR-FIN-RESP
  5977         MOVE XCTL-652           TO PGM-NAME
  5978         GO TO 9300-XCTL.
  5979
  5980     IF PI-SCR-FIN-RESP = SPACES OR LOW-VALUES
  5981         GO TO 0315-PF4-ERROR.
  5982
  5983     PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT.
  5984
  5985     MOVE PI-SCR-CARRIER    TO PI-CR-CARRIER.
  5986     MOVE PI-SCR-GROUPING   TO PI-CR-GROUPING.
  5987     MOVE PI-SCR-FIN-RESP   TO PI-CR-FIN-RESP.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 113
* EL640.cbl
  5988     MOVE PI-SCR-ACCOUNT    TO PI-CR-ACCOUNT.
  5989     MOVE PI-SCR-TYPE       TO PI-CR-TYPE.
  5990     MOVE 'Y'               TO PI-TRANSFER-SW.
  5991
  5992     IF PI-ZERO-CARRIER  OR
  5993        PI-ZERO-CAR-GROUP
  5994         MOVE ZEROS              TO PI-CR-CARRIER.
  5995
  5996     IF PI-ZERO-GROUPING  OR
  5997        PI-ZERO-CAR-GROUP
  5998         MOVE ZEROS              TO PI-CR-GROUPING.
  5999
  6000     MOVE XCTL-652               TO PGM-NAME.
  6001
  6002     GO TO 9300-XCTL.
  6003
  6004 0315-PF4-ERROR.
  6005
  6006     MOVE ER-2407                TO EMI-ERROR.
  6007     MOVE -1                     TO APFNTERL.
  6008     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6009     GO TO 8200-SEND-DATAONLY.
  6010
  6011 0320-CONT-PFKEYS.
  6012     IF EIBAID = DFHPF6
  6013       AND PI-MAP-NAME = EL640A
  6014         MOVE LOW-VALUES         TO EL640AO
  6015         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  6016         MOVE XCTL-6401          TO PGM-NAME
  6017         GO TO 9300-XCTL.
  6018
  6019     IF EIBAID = DFHPF7
  6020       AND PI-MAP-NAME = EL640A
  6021         IF PI-CR-FIN-RESP NOT = SPACES
  6022             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  6023             MOVE PI-COMP-CARRIER    TO PI-CR-CARRIER
  6024             MOVE PI-COMP-GROUPING   TO PI-CR-GROUPING
  6025             MOVE PI-COMP-FIN-RESP   TO PI-CR-FIN-RESP
  6026             MOVE XCTL-PYAJ          TO PGM-NAME
  6027             GO TO 9300-XCTL
  6028         ELSE
  6029             IF PI-RETURN-TO-PROGRAM = XCTL-633 OR XCTL-635 OR
  6030                                       XCTL-633DMD
  6031                 GO TO 9400-CLEAR
  6032             ELSE
  6033                 MOVE ER-2411        TO EMI-ERROR
  6034                 MOVE -1             TO APFNTERL
  6035                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6036                 GO TO 8200-SEND-DATAONLY.
  6037
  6038     IF EIBAID = DFHPF8
  6039       AND PI-MAP-NAME = EL640A
  6040           PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  6041           MOVE SPACES         TO PI-CR-CONTROL-IN-PROGRESS
  6042           MOVE XCTL-658       TO PGM-NAME
  6043           GO TO 9300-XCTL.
  6044
  6045     IF EIBAID = DFHPF1
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 114
* EL640.cbl
  6046       AND PI-MAP-NAME = EL640B
  6047         GO TO 7500-PRODUCE-CHECK.
  6048
  6049     IF EIBAID = DFHPF5
  6050       AND PI-AR-PROCESSING
  6051         MOVE ER-3188            TO EMI-ERROR
  6052         MOVE -1                 TO APFNTERL
  6053         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6054         GO TO 8200-SEND-DATAONLY.
  6055
  6056     IF PI-COMPANY-ID = 'DMD'
  6057       IF EIBAID = DFHPF5
  6058         GO TO 0320-INPUT-ERROR.
  6059
  6060     IF EIBAID = DFHPF5
  6061       AND PI-MAP-NAME = EL640A
  6062            MOVE EL640B     TO PI-MAP-NAME
  6063            GO TO 7000-PROCESS-CHECK.
  6064
  6065     IF PI-MAP-NAME = EL640A
  6066         IF EIBAID = DFHENTER OR DFHPF3
  6067             GO TO 0330-EDIT-DATA
  6068         ELSE
  6069             GO TO 0320-INPUT-ERROR
  6070     ELSE
  6071         IF PI-MAP-NAME = EL640B
  6072             IF EIBAID = DFHENTER
  6073
  6074* EXEC CICS BIF DEEDIT
  6075*                    FIELD  (BCHKAMTI)
  6076*                    LENGTH (11)
  6077*                END-EXEC
  6078     MOVE 11
  6079       TO DFHEIV11
  6080*    MOVE '@"L                   #   #00006030' TO DFHEIV0
  6081     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6082     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6083     MOVE X'2020233030303036303330' TO DFHEIV0(25:11)
  6084     CALL 'kxdfhei1' USING DFHEIV0,
  6085           BCHKAMTI,
  6086           DFHEIV11
  6087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6088                 MOVE BCHKAMTI   TO  WORK-CHECK-AMT
  6089                 MOVE 'B'        TO  WS-ENTERED-FROM-MAP
  6090                 GO TO 7000-PROCESS-CHECK.
  6091
  6092 0320-INPUT-ERROR.
  6093     MOVE ER-0029                TO EMI-ERROR.
  6094     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6095
  6096     IF PI-MAP-NAME = EL640A
  6097         MOVE AL-UNBON           TO APFNTERA
  6098         MOVE -1                 TO APFNTERL
  6099     ELSE
  6100         MOVE AL-UNBON           TO BPFNTERA
  6101         MOVE -1                 TO BPFNTERL.
  6102
  6103     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 115
* EL640.cbl
  6104
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 116
* EL640.cbl
  6106 0330-EDIT-DATA.
  6107     MOVE ABILTYPI               TO VALID-BILL-TYPE-VALUES.
  6108
  6109     IF VALID-BILL-TYPE
  6110        IF NOT MODIFY-CAP
  6111           IF ABILTYPI = '1' OR '2'
  6112              NEXT SENTENCE
  6113           ELSE
  6114              MOVE 'UPDATE'         TO SM-READ
  6115              PERFORM 9995-SECURITY-VIOLATION
  6116              MOVE ER-0070          TO EMI-ERROR
  6117              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6118              GO TO 8100-SEND-INITIAL-MAP.
  6119
  6120     MOVE SPACES                 TO PI-BILLING-COUNTS
  6121                                    PI-LIMIT-BILLING-BTCHS.
  6122
  6123******************************************************************
  6124*         SECURITY CHECK FOR CARRIER AND ACCOUNT.                *
  6125*                     04/12/84                                   *
  6126******************************************************************
  6127
  6128     IF PI-CARRIER-SECURITY > SPACES
  6129        IF ACARIERL > ZEROS
  6130            IF PI-CARRIER-SECURITY = ACARIERI
  6131                MOVE AL-UANON    TO ACARIERA
  6132            ELSE
  6133                MOVE -1          TO ACARIERL
  6134                MOVE AL-UABON    TO ACARIERA
  6135                MOVE ER-2370     TO EMI-ERROR
  6136                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6137
  6138 350-ERROR-CHECK.
  6139     IF EMI-ERROR = ZEROS
  6140         NEXT SENTENCE
  6141     ELSE
  6142         GO TO 8200-SEND-DATAONLY.
  6143
  6144     IF AACCTL > ZEROS
  6145         MOVE AL-UANON           TO AACCTA
  6146         MOVE AACCTI             TO PI-SAV-ACCT
  6147                                    PI-CR-ACCOUNT
  6148     ELSE
  6149         MOVE -1                 TO AACCTL
  6150         MOVE AL-UABON           TO AACCTA
  6151         MOVE ER-0197            TO EMI-ERROR
  6152         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6153
  6154     IF ACARIERL > ZEROS
  6155         MOVE AL-UANON           TO ACARIERA
  6156         MOVE ACARIERI           TO PI-SAV-CARR
  6157                                    WS-CARRIER
  6158     ELSE
  6159         IF NOT ST-ACCNT-CNTL AND NOT ACCNT-CNTL
  6160             MOVE -1             TO ACARIERL
  6161             MOVE AL-UABON       TO ACARIERA
  6162             MOVE ER-0194        TO EMI-ERROR
  6163             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 117
* EL640.cbl
  6164
  6165     IF AGROUPL > ZEROS
  6166         MOVE AL-UANON           TO AGROUPA
  6167         MOVE AGROUPI            TO PI-SAV-GROUP
  6168                                    WS-COMP
  6169     ELSE
  6170         IF CARR-GROUP-ST-ACCNT-CNTL
  6171             MOVE -1             TO AGROUPL
  6172             MOVE AL-UABON       TO AGROUPA
  6173             MOVE ER-0195        TO EMI-ERROR
  6174             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6175
  6176     IF ASTATEL > ZEROS
  6177         MOVE AL-UANON           TO ASTATEA
  6178         MOVE ASTATEI            TO PI-SAV-STATE
  6179     ELSE
  6180         IF NOT ACCNT-CNTL AND NOT CARR-ACCNT-CNTL
  6181             MOVE -1             TO ASTATEL
  6182             MOVE AL-UABON       TO ASTATEA
  6183             MOVE ER-0196        TO EMI-ERROR
  6184             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6185
  6186     MOVE ABILTYPI               TO VALID-BILL-TYPE-VALUES.
  6187
  6188     IF VALID-BILL-TYPE
  6189         MOVE AL-UANON           TO ABILTYPA
  6190         MOVE ABILTYPI           TO PI-BILL-TYPE
  6191     ELSE
  6192         MOVE -1                 TO ABILTYPL
  6193         MOVE ER-2249            TO EMI-ERROR
  6194         MOVE AL-UABON           TO ABILTYPA
  6195         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6196
  6197     IF PI-AR-PROCESSING
  6198        IF PI-PREVIEW
  6199           NEXT SENTENCE
  6200        ELSE
  6201           MOVE -1               TO ABILTYPL
  6202           MOVE ER-3145          TO EMI-ERROR
  6203           MOVE AL-UABON         TO ABILTYPA
  6204           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6205
  6206     IF APRODSWL NOT = ZEROS
  6207         IF PI-PREVIEW
  6208             IF APRODSWI = 'Y' OR 'N'
  6209                 MOVE AL-UANON   TO APRODSWA
  6210             ELSE
  6211                 MOVE -1         TO APRODSWL
  6212                 MOVE ER-2436    TO EMI-ERROR
  6213                 MOVE AL-UABON   TO APRODSWA
  6214                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6215         ELSE
  6216             MOVE -1             TO APRODSWL
  6217             MOVE ER-2434        TO EMI-ERROR
  6218             MOVE AL-UABON       TO APRODSWA
  6219             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6220     ELSE
  6221         IF PI-PREVIEW
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 118
* EL640.cbl
  6222             MOVE -1             TO APRODSWL
  6223             MOVE ER-2435        TO EMI-ERROR
  6224             MOVE AL-UABON       TO APRODSWA
  6225             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6226
  6227     IF ABILERRI = 'Y' OR 'N'
  6228         MOVE ABILERRI           TO PI-BILL-ERRS
  6229         MOVE AL-UANON           TO ABILERRA
  6230     ELSE
  6231         IF NOT PI-VOID-BILL
  6232             MOVE -1             TO ABILERRL
  6233             MOVE ER-2250        TO EMI-ERROR
  6234             MOVE AL-UABON       TO ABILERRA
  6235             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6236
  6237     IF ABTCH1L NOT = ZEROS
  6238         MOVE AL-UANON           TO ABTCH1A
  6239         MOVE 'Y'                TO LIMIT-BILLING-SW
  6240         MOVE ABTCH1I            TO PI-BILLING-BATCHES (1).
  6241
  6242     IF ABTCH2L NOT = ZEROS
  6243         MOVE AL-UANON           TO ABTCH2A
  6244         MOVE 'Y'                TO LIMIT-BILLING-SW
  6245         MOVE ABTCH2I            TO PI-BILLING-BATCHES (2).
  6246
  6247     IF ABTCH3L NOT = ZEROS
  6248         MOVE AL-UANON           TO ABTCH3A
  6249         MOVE 'Y'                TO LIMIT-BILLING-SW
  6250         MOVE ABTCH3I            TO PI-BILLING-BATCHES (3).
  6251
  6252     IF EMI-ERROR = ZEROS
  6253         GO TO 1000-BILLING-PROCESS.
  6254
  6255     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 119
* EL640.cbl
  6257 0400-CLEAR-PI.
  6258     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  6259
  6260     MOVE ZEROS                  TO PI-BAL-FRWD-GA  PI-BAL-FRWD
  6261                                    PI-PREMIUM      PI-REMITTED
  6262                                    PI-TOT-ISS-COMP
  6263                                    PI-TOT-CAN-COMP
  6264                                    PI-ADJUSTMENTS  PI-DISBURSED
  6265                                    PI-END-BAL      PI-LF-ISS-COMP
  6266                                    PI-AH-ISS-COMP  PI-LF-CAN-COMP
  6267                                    PI-AH-CAN-COMP.
  6268
  6269     MOVE SPACES                 TO PI-BATCH (1)
  6270                                    PI-BATCH (2)
  6271                                    PI-BATCH (3)
  6272                                    PI-BATCH (4)
  6273                                    PI-BATCH (5)
  6274                                    PI-BATCH (6).
  6275
  6276     MOVE SPACES                 TO PI-BILLING-BATCHES (1)
  6277                                    PI-BILLING-BATCHES (2)
  6278                                    PI-BILLING-BATCHES (3).
  6279
  6280     MOVE ZEROS                  TO PI-BILLED (1) PI-PREV (1)
  6281                                    PI-NOBILL (1)
  6282                                    PI-PREM (1)   PI-COMM (1)
  6283                                    PI-NON-PREM (1)
  6284                                    PI-NON-COMM (1)
  6285                                    PI-BILLED (2) PI-PREV (2)
  6286                                    PI-NOBILL (2)
  6287                                    PI-PREM (2)   PI-COMM (2)
  6288                                    PI-NON-PREM (2)
  6289                                    PI-NON-COMM (2)
  6290                                    PI-BILLED (3) PI-PREV (3)
  6291                                    PI-NOBILL (3)
  6292                                    PI-PREM (3)   PI-COMM (3)
  6293                                    PI-NON-PREM (3)
  6294                                    PI-NON-COMM (3)
  6295                                    PI-BILLED (4) PI-PREV (4)
  6296                                    PI-NOBILL (4)
  6297                                    PI-PREM (4)   PI-COMM (4)
  6298                                    PI-NON-PREM (4)
  6299                                    PI-NON-COMM (4)
  6300                                    PI-BILLED (5) PI-PREV (5)
  6301                                    PI-NOBILL (5)
  6302                                    PI-PREM (5)   PI-COMM (5)
  6303                                    PI-NON-PREM (5)
  6304                                    PI-NON-COMM (5)
  6305                                    PI-BILLED (6) PI-PREV (6)
  6306                                    PI-NOBILL (6)
  6307                                    PI-PREM (6)   PI-COMM (6)
  6308                                    PI-NON-PREM (6)
  6309                                    PI-NON-COMM (6).
  6310
  6311 0499-EXIT.
  6312      EXIT.
  6313
  6314 0500-CREATE-TEMP-STORAGE.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 120
* EL640.cbl
  6315
  6316     IF PI-BAL-FRWD NOT NUMERIC
  6317         MOVE ZEROS              TO PI-BAL-FRWD
  6318                                    PI-PREMIUM
  6319                                    PI-REMITTED
  6320                                    PI-TOT-ISS-COMP
  6321                                    PI-TOT-CAN-COMP
  6322                                    PI-ADJUSTMENTS
  6323                                    PI-DISBURSED
  6324                                    PI-END-BAL.
  6325
  6326
  6327* EXEC CICS WRITEQ TS
  6328*        QUEUE  (QID)
  6329*        FROM   (PROGRAM-INTERFACE-BLOCK)
  6330*        LENGTH (PI-COMM-LENGTH)
  6331*    END-EXEC.
  6332*    MOVE '*"     L              ''   #00006272' TO DFHEIV0
  6333     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  6334     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6335     MOVE X'2020233030303036323732' TO DFHEIV0(25:11)
  6336     CALL 'kxdfhei1' USING DFHEIV0,
  6337           QID,
  6338           PROGRAM-INTERFACE-BLOCK,
  6339           PI-COMM-LENGTH,
  6340           DFHEIV99,
  6341           DFHEIV99,
  6342           DFHEIV99
  6343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6344
  6345
  6346 0590-EXIT.
  6347      EXIT.
  6348
  6349 0600-RECOVER-TEMP-STORAGE.
  6350
  6351* EXEC CICS READQ TS
  6352*        QUEUE  (QID)
  6353*        INTO   (PROGRAM-INTERFACE-BLOCK)
  6354*        LENGTH (PI-COMM-LENGTH)
  6355*    END-EXEC.
  6356*    MOVE '*$I    L              ''   #00006282' TO DFHEIV0
  6357     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  6358     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6359     MOVE X'2020233030303036323832' TO DFHEIV0(25:11)
  6360     CALL 'kxdfhei1' USING DFHEIV0,
  6361           QID,
  6362           PROGRAM-INTERFACE-BLOCK,
  6363           PI-COMM-LENGTH,
  6364           DFHEIV99,
  6365           DFHEIV99,
  6366           DFHEIV99
  6367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6368
  6369
  6370     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  6371
  6372     MOVE PI-CR-CARRIER    TO PI-SCR-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 121
* EL640.cbl
  6373     MOVE PI-CR-GROUPING   TO PI-SCR-GROUPING.
  6374     MOVE PI-CR-FIN-RESP   TO PI-SCR-FIN-RESP.
  6375     MOVE PI-CR-ACCOUNT    TO PI-SCR-ACCOUNT.
  6376     MOVE PI-CR-TYPE       TO PI-SCR-TYPE.
  6377
  6378     MOVE PI-SCRN-CONTROL TO W-TRANSFER-CONTROL.
  6379
  6380 0690-EXIT.
  6381      EXIT.
  6382
  6383 0800-DELETE-TS.
  6384
  6385* EXEC CICS HANDLE CONDITION
  6386*        QIDERR (0890-EXIT)
  6387*    END-EXEC.
  6388*    MOVE '"$N                   ! # #00006302' TO DFHEIV0
  6389     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  6390     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6391     MOVE X'2320233030303036333032' TO DFHEIV0(25:11)
  6392     CALL 'kxdfhei1' USING DFHEIV0
  6393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6394
  6395
  6396
  6397* EXEC CICS DELETEQ TS
  6398*        QUEUE  (QID)
  6399*    END-EXEC.
  6400*    MOVE '*&                    #   #00006306' TO DFHEIV0
  6401     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  6402     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6403     MOVE X'2020233030303036333036' TO DFHEIV0(25:11)
  6404     CALL 'kxdfhei1' USING DFHEIV0,
  6405           QID,
  6406           DFHEIV99
  6407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6408
  6409
  6410 0890-EXIT.
  6411      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 122
* EL640.cbl
  6413 1000-BILLING-PROCESS.
  6414*                *******************************************
  6415*                *  THIS SECTION PROCESSES THE PENDING     *
  6416*                *  BUSINESS AND PAYMNTS/ADJMNTS FILES.    *
  6417*                *  THE PREMIUM AMT WRITTEN IS EXTRACTED   *
  6418*                *  FROM THE PENDING BUSINESS FILE.        *
  6419*                *******************************************
  6420
  6421     MOVE PI-COMPANY-CD          TO ERPNDB-CO-CD
  6422                                    ERPNDB-CO-CD-A1
  6423                                    ERCOMP-COMP-CD
  6424                                    ERPYAJ-COMP-CD
  6425                                    ERACCT-P-CO-CD
  6426                                    ERACCT-A-CO-CD.
  6427
  6428     MOVE WS-CURRENT-DATE-EDIT   TO BI-HD-RUN-DT.
  6429
  6430     MOVE ZEROS                  TO PI-BAL-FRWD
  6431                                    PI-PREMIUM
  6432                                    PI-REMITTED
  6433                                    PI-TOT-ISS-COMP
  6434                                    PI-TOT-CAN-COMP
  6435                                    PI-ADJUSTMENTS
  6436                                    PI-DISBURSED
  6437                                    PI-END-BAL.
  6438
  6439     IF PI-VOID-BILL
  6440         GO TO 2000-VOID-BILLING.
  6441
  6442     MOVE SPACES                 TO ELCNTL-KEY.
  6443     MOVE '1'                    TO ELCNTL-REC-TYPE.
  6444     PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT.
  6445
  6446     IF EMI-ERROR NOT = ZEROS
  6447         GO TO 8200-SEND-DATAONLY.
  6448
  6449     IF CF-ACCOUNT-MSTR-MAINT-DT      = LOW-VALUES  OR
  6450        CF-COMPENSATION-MSTR-MAINT-DT = LOW-VALUES
  6451         MOVE ER-2571            TO EMI-ERROR
  6452         MOVE -1                 TO APFNTERL
  6453         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6454         GO TO 8200-SEND-DATAONLY.
  6455
  6456     IF CF-FORMS-PRINTER-ID = SPACES
  6457        IF ABILTYPI = '3' OR '4'
  6458          MOVE 2590               TO EMI-ERROR
  6459          MOVE -1                 TO ABILTYPL
  6460          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6461          GO TO 8200-SEND-DATAONLY.
  6462
  6463     MOVE CF-CL-MAIL-TO-NAME     TO BI-HD-CO.
  6464     MOVE CF-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  6465     MOVE SPACE                  TO DC-OPTION-CODE.
  6466     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6467     MOVE DC-GREG-DATE-1-EDIT    TO PI-MONTH-END-DATE.
  6468     MOVE DC-GREG-DATE-1-ALPHA   TO BI-HD-BILL-DT.
  6469     MOVE SPACE                  TO PI-DATA-BILLED-SW.
  6470
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 123
* EL640.cbl
  6471     PERFORM 4000-PNDB-START-BROWSE THRU 4090-EXIT.
  6472
  6473     IF PNDB-EOF
  6474         GO TO 1100-PYAJ-BILLING-PROCESS.
  6475
  6476 1010-PNDB-BILLING-PROCESS-LOOP.
  6477     PERFORM 4100-PNDB-READ-NEXT THRU 4190-EXIT.
  6478
  6479     IF PNDB-EOF
  6480         PERFORM 3500-TOTAL-OUT-DETAIL THRU 3599-EXIT
  6481         GO TO 1100-PYAJ-BILLING-PROCESS.
  6482
  6483     IF PB-COMPANY-CD-A1 = PI-COMPANY-CD  AND
  6484        PB-CARRIER       = PI-SAV-CARR    AND
  6485        PB-GROUPING      = PI-SAV-GROUP   AND
  6486        PB-STATE         = PI-SAV-STATE   AND
  6487        PB-ACCOUNT       = PI-SAV-ACCT
  6488         NEXT SENTENCE
  6489     ELSE
  6490         PERFORM 3500-TOTAL-OUT-DETAIL THRU 3599-EXIT
  6491         GO TO 1100-PYAJ-BILLING-PROCESS.
  6492
  6493     IF (PB-ISSUE) AND
  6494        (PB-I-POLICY-IS-REISSUE OR PB-I-REIN-ONLY OR
  6495         PB-I-POLICY-IS-MONTHLY OR
  6496         PB-I-POLICY-IS-DECLINED OR PB-I-POLICY-IS-VOIDED OR
  6497         PB-I-UNDERWRITE-POLICY)
  6498          GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6499     ELSE
  6500        IF (PB-CANCELLATION)
  6501           AND  (PB-CI-LF-POLICY-IS-REISSUE
  6502             OR  PB-CI-AH-POLICY-IS-REISSUE
  6503             OR  PB-CI-LF-POLICY-IS-MONTHLY
  6504             OR  PB-CI-AH-POLICY-IS-MONTHLY
  6505             OR  PB-CI-LF-POLICY-IS-DECLINED
  6506             OR  PB-CI-AH-POLICY-IS-VOID
  6507             OR  PB-CI-LF-REIN-ONLY
  6508             OR  PB-CI-AH-REIN-ONLY)
  6509             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6510
  6511     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  6512         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6513
  6514     IF PB-RECORD-ON-HOLD OR
  6515        PB-RECORD-RETURNED
  6516         PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  6517         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6518
  6519     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  6520         IF PB-ENTRY-REVERSED
  6521             GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6522         ELSE
  6523             IF PI-REBILLING
  6524                 PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT
  6525                 GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6526
  6527     IF PB-BILLED-DT = LOW-VALUES
  6528       OR PI-TOT-REBILL
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 124
* EL640.cbl
  6529       OR PB-ALT-CHG-SEQ-NO NOT = ZEROS
  6530         NEXT SENTENCE
  6531     ELSE
  6532         IF NOT PB-BATCH-TRAILER
  6533             PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  6534             GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6535         ELSE
  6536             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6537
  6538     IF LIMIT-BILLING
  6539         IF PB-ENTRY-BATCH = ABTCH1I OR
  6540                             ABTCH2I OR
  6541                             ABTCH3I
  6542             NEXT SENTENCE
  6543         ELSE
  6544             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6545
  6546     IF PB-FATAL-ERRORS  OR
  6547        PB-UNFORCED-ERRORS
  6548         IF ABILERRI = 'N'
  6549             PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6550             PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT
  6551             MOVE ER-2570        TO EMI-ERROR
  6552             MOVE -1             TO ABILERRL
  6553             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6554             SET EMI-INDX TO 1
  6555             IF EMI-ERROR-NUMBER (EMI-INDX) = ER-2570
  6556                 MOVE EMI-ERROR-TEXT (EMI-INDX) TO WS-ERROR-TEXT
  6557                 MOVE PB-ENTRY-BATCH            TO WS-ERROR-BATCH
  6558                 MOVE WS-ERROR-MSG TO EMI-ERROR-TEXT (EMI-INDX)
  6559                 GO TO 8200-SEND-DATAONLY
  6560             ELSE
  6561                 SET EMI-INDX    TO 2
  6562                 MOVE EMI-ERROR-TEXT (EMI-INDX) TO WS-ERROR-TEXT
  6563                 MOVE PB-ENTRY-BATCH            TO WS-ERROR-BATCH
  6564                 MOVE WS-ERROR-MSG TO EMI-ERROR-TEXT (EMI-INDX)
  6565                 GO TO 8200-SEND-DATAONLY
  6566         ELSE
  6567             PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  6568             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6569
  6570     IF PB-BATCH-TRAILER
  6571         IF PI-UPDATE-FILES
  6572             PERFORM 1050-BILL-BATCH-TRAILER-CHK THRU 1059-EXIT
  6573             IF BILL-BATCH-TRAILER
  6574                 MOVE SPACE           TO BILL-BATCH-TRAILER-SW
  6575                 MOVE WS-CURRENT-DATE TO PB-BILLED-DT
  6576                 PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT
  6577                 GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6578             ELSE
  6579                 GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6580         ELSE
  6581             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6582
  6583     MOVE 'Y'                    TO PI-DATA-BILLED-SW.
  6584
  6585     PERFORM 1300-CHECK-OVERRIDE-PREM THRU 1399-EXIT.
  6586
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 125
* EL640.cbl
  6587     IF PB-CERT-EFF-DT > ERACCT-A-EXP-DATE
  6588         MOVE SPACE              TO WS-PROCESS-SW
  6589         MOVE PB-CERT-EFF-DT     TO PI-SAV-EXP-DT
  6590         PERFORM 4300-READ-ACCOUNT-MASTER  THRU 4390-EXIT
  6591         PERFORM 1020-CHK-IF-AGENT-IS-SAME THRU 1029-EXIT
  6592         IF EMI-ERROR NOT = ZEROS
  6593             IF PI-UPDATE-FILES
  6594               OR (PI-PREVIEW AND APRODSWI = 'Y')
  6595                 PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6596                 IF EMI-ERROR NOT = '2403'
  6597                     PERFORM 3940-BILL-GENERIC-DELETE
  6598                             THRU 3940-EXIT
  6599                     GO TO 8200-SEND-DATAONLY
  6600                 ELSE
  6601                     GO TO 8200-SEND-DATAONLY
  6602             ELSE
  6603                 GO TO 8200-SEND-DATAONLY.
  6604
  6605     PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT.
  6606
  6607     IF DO-NOT-BILL-THIS-ACCT
  6608         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6609
  6610     PERFORM 1030-COMPUTE-COMMISSION-TOTALS THRU 1039-EXIT.
  6611
  6612     IF EMI-ERROR NOT = ZEROS
  6613         IF PI-UPDATE-FILES
  6614           OR (PI-PREVIEW AND APRODSWI = 'Y')
  6615             PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6616             PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT
  6617             GO TO 8200-SEND-DATAONLY
  6618         ELSE
  6619             GO TO 8200-SEND-DATAONLY.
  6620
  6621     IF PI-UPDATE-FILES
  6622       OR (PI-PREVIEW AND APRODSWI = 'Y')
  6623         MOVE 'BD'               TO BILLING-DETAIL-TYPE
  6624         PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  6625
  6626     IF PI-BILL OR PI-REBILLING
  6627         PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT.
  6628
  6629     GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 126
* EL640.cbl
  6631 1020-CHK-IF-AGENT-IS-SAME.
  6632     MOVE +1 TO ACCOM-SUB.
  6633
  6634 1025-FIND-AGENT-LOOP.
  6635     IF AM-COM-TYP (ACCOM-SUB) = 'C' OR 'D' OR 'F'
  6636         NEXT SENTENCE
  6637     ELSE
  6638         ADD +1 TO ACCOM-SUB
  6639         IF ACCOM-SUB > 10
  6640             MOVE -1             TO AACCTL
  6641             MOVE ER-2404        TO EMI-ERROR
  6642             MOVE AL-UABON       TO AACCTA
  6643             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6644         ELSE
  6645             GO TO 1025-FIND-AGENT-LOOP.
  6646
  6647     IF AM-AGT (ACCOM-SUB) NOT = PI-SAV-ACCT
  6648         IF FIRST-TIME
  6649             MOVE -1             TO AACCTL
  6650             MOVE ER-2405        TO EMI-ERROR
  6651             MOVE AL-UABON       TO AACCTA
  6652             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6653             GO TO 1029-EXIT
  6654         ELSE
  6655             MOVE 'Y'            TO WS-PROCESS-SW
  6656             GO TO 1029-EXIT.
  6657
  6658     IF FIRST-TIME
  6659         MOVE AM-AGT (AM-REMIT-TO) TO PI-SAV-REMIT-TO
  6660                                      PI-CR-FIN-RESP
  6661         MOVE 'A'                  TO PI-CR-TYPE
  6662         PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  6663         MOVE SPACE                TO FIRST-TIME-SW
  6664         IF EMI-ERROR NOT = ZEROS
  6665             GO TO 1029-EXIT.
  6666
  6667     IF AM-AGT (AM-REMIT-TO) = PI-SAV-REMIT-TO
  6668         NEXT SENTENCE
  6669     ELSE
  6670         MOVE 'Y'                TO WS-PROCESS-SW
  6671         MOVE ER-2408            TO EMI-ERROR
  6672         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6673         PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6674         PERFORM 3940-BILL-GENERIC-DELETE  THRU  3940-EXIT
  6675         MOVE -1                 TO AACCTL
  6676         GO TO 8200-SEND-DATAONLY.
  6677
  6678     MOVE AM-NAME                TO PI-ACCT-NAME.
  6679
  6680     IF PI-BILL OR PI-REBILLING
  6681         PERFORM 4400-ERACCT-REWRITE THRU 4490-EXIT.
  6682
  6683 1029-EXIT.
  6684     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 127
* EL640.cbl
  6686 1030-COMPUTE-COMMISSION-TOTALS.
  6687     IF PB-CANCELLATION
  6688         GO TO 1035-COMPUTE-CANCEL-COMM.
  6689
  6690     MOVE SPACES                 TO WS-AH-benefit-cd-stuff
  6691     IF NOT PB-INVALID-AH
  6692        MOVE SPACES              TO ELCNTL-KEY
  6693        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6694        MOVE '5'                 TO ELCNTL-REC-TYPE
  6695        MOVE PB-I-AH-BENEFIT-CD  TO ELCNTL-ACCESS (3:2)
  6696                                    CLAS-LOOK
  6697        MOVE +0                  TO ELCNTL-SEQ-NO
  6698        PERFORM 6130-FIND-AH-BENEFIT-CD
  6699                                 THRU 6130-EXIT
  6700     END-IF
  6701     if (pi-company-id = 'DCC' or 'VPP')
  6702        and (ws-ah-category = 'G' or 'L')
  6703        compute pi-premium = ws-i-ah-premium-amt + pi-premium
  6704        move zeros               to ws-i-lf-premium-amt
  6705     else
  6706        COMPUTE PI-PREMIUM = (WS-I-LF-PREMIUM-AMT +
  6707           WS-I-AH-PREMIUM-AMT) + PI-PREMIUM
  6708     end-if
  6709     COMPUTE PI-LF-ISS-COMP ROUNDED =
  6710         (WS-I-LF-PREMIUM-AMT * PB-I-LIFE-COMMISSION).
  6711     IF WS-AH-CATEGORY = 'G' OR 'L'
  6712        COMPUTE PI-AH-ISS-COMP ROUNDED =
  6713           WS-I-AH-PREMIUM-AMT - PB-I-LF-ALT-PREMIUM-AMT
  6714              - PB-I-ADDL-CLP
  6715     ELSE
  6716        COMPUTE PI-AH-ISS-COMP ROUNDED =
  6717            (WS-I-AH-PREMIUM-AMT * PB-I-AH-COMMISSION)
  6718     END-IF
  6719     COMPUTE PI-TOT-ISS-COMP = PI-TOT-ISS-COMP +
  6720                               PI-LF-ISS-COMP +
  6721                               PI-AH-ISS-COMP.
  6722     GO TO 1039-EXIT.
  6723
  6724 1035-COMPUTE-CANCEL-COMM.
  6725
  6726     MOVE SPACES                 TO WS-AH-benefit-cd-stuff
  6727     if (PB-CI-AH-BENEFIT-CD NOT = SPACES AND ZEROS)
  6728        MOVE SPACES              TO ELCNTL-KEY
  6729        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6730        MOVE '5'                 TO ELCNTL-REC-TYPE
  6731        MOVE PB-CI-AH-BENEFIT-CD TO ELCNTL-ACCESS (3:2)
  6732                                    CLAS-LOOK
  6733        MOVE +0                  TO ELCNTL-SEQ-NO
  6734        PERFORM 6130-FIND-AH-BENEFIT-CD
  6735                                 THRU 6130-EXIT
  6736     END-IF
  6737     IF WS-AH-CATEGORY = 'G' OR 'L'
  6738        COMPUTE PI-PREMIUM = PI-PREMIUM -
  6739          WS-C-AH-CANCEL-AMT
  6740     ELSE
  6741        COMPUTE PI-PREMIUM = PI-PREMIUM -
  6742         (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT)
  6743     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 128
* EL640.cbl
  6744
  6745     COMPUTE PI-LF-CAN-COMP   ROUNDED =
  6746         (WS-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION) * -1.
  6747     IF WS-AH-CATEGORY = 'G' OR 'L'
  6748        IF AM-DCC-PRODUCT-CODE = 'DDF'
  6749           COMPUTE CNC-FACT = PB-C-AH-RFND-CLP /
  6750              pb-ci-lf-alt-premium-amt
  6751        else
  6752           COMPUTE CNC-FACT = PB-C-AH-CANCEL-AMT /
  6753              PB-CI-AH-PREMIUM-AMT
  6754        end-if
  6755        COMPUTE PI-AH-CAN-COMP ROUNDED =
  6756           (CNC-FACT * (PB-CI-AH-PREMIUM-AMT -
  6757           PB-CI-LF-ALT-PREMIUM-AMT - PB-CI-ADDL-CLP))
  6758     ELSE
  6759        COMPUTE PI-AH-CAN-COMP   ROUNDED =
  6760         (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION) * -1
  6761     END-IF
  6762     MOVE PB-CERT-EFF-DT           TO  DC-BIN-DATE-1.
  6763     MOVE PB-C-LF-CANCEL-DT        TO  DC-BIN-DATE-2.
  6764     MOVE '1'                      TO  DC-OPTION-CODE.
  6765     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6766     MOVE DC-ELAPSED-MONTHS        TO  MONTHS-DIFF-LF.
  6767
  6768     IF DC-ODD-DAYS-OVER > ZEROS
  6769         ADD +1 TO MONTHS-DIFF-LF.
  6770
  6771     MOVE PB-CERT-EFF-DT           TO  DC-BIN-DATE-1.
  6772     MOVE PB-C-AH-CANCEL-DT        TO  DC-BIN-DATE-2.
  6773     MOVE '1'                      TO  DC-OPTION-CODE.
  6774     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6775     MOVE DC-ELAPSED-MONTHS        TO  MONTHS-DIFF-AH.
  6776
  6777     IF DC-ODD-DAYS-OVER > ZEROS
  6778         ADD +1 TO MONTHS-DIFF-AH.
  6779
  6780     PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT.
  6781
  6782     MOVE  +0                       TO  SUB.
  6783     MOVE  'Y'                      TO  WS-CHARGEBACK-LF-SW
  6784                                        WS-CHARGEBACK-AH-SW.
  6785
  6786     MOVE ZEROS                     TO  WS-LF-CAN-COMP
  6787                                        WS-AH-CAN-COMP.
  6788 1035-ACCT-COMM-LOOP.
  6789
  6790     ADD +1 TO SUB.
  6791
  6792     IF SUB > +10
  6793         GO TO 1035-COMPUTE-TOT-CAN.
  6794
  6795     IF AM-COM-TYP (SUB) NOT = 'C' AND 'D' AND 'F'
  6796         GO TO 1035-ACCT-COMM-LOOP.
  6797
  6798     IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  6799         MOVE  ZEROS            TO  AM-COMM-CHARGEBACK (SUB).
  6800
  6801     IF AM-COMM-CHARGEBACK (SUB) = '99'
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 129
* EL640.cbl
  6802         MOVE  'N'               TO  WS-CHARGEBACK-LF-SW
  6803         GO TO 1035-CHECK-AH-CHARGEBACK.
  6804
  6805     IF (MONTHS-DIFF-LF > AM-COMM-CHARGEBACK (SUB))
  6806                            AND
  6807        (AM-COMM-CHARGEBACK (SUB) NOT = ZEROS)
  6808         MOVE  'N'               TO  WS-CHARGEBACK-LF-SW
  6809     ELSE
  6810         COMPUTE WS-LF-CAN-COMP   ROUNDED =  WS-LF-CAN-COMP +
  6811            (WS-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION).
  6812
  6813 1035-CHECK-AH-CHARGEBACK.
  6814
  6815     IF AM-COMM-CHARGEBACK (SUB) = '99'
  6816         MOVE  'N'                TO  WS-CHARGEBACK-AH-SW
  6817         GO TO  1035-ACCT-COMM-LOOP.
  6818
  6819     IF (MONTHS-DIFF-AH > AM-COMM-CHARGEBACK (SUB))
  6820                            AND
  6821        (AM-COMM-CHARGEBACK (SUB) NOT = ZEROS)
  6822         MOVE  'N'                TO  WS-CHARGEBACK-AH-SW
  6823     ELSE
  6824        IF WS-AH-CATEGORY = 'G' OR 'L'
  6825           MOVE PI-AH-CAN-COMP   TO WS-AH-CAN-COMP
  6826        ELSE
  6827         COMPUTE WS-AH-CAN-COMP ROUNDED = WS-AH-CAN-COMP +
  6828            (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION)
  6829        END-IF
  6830     END-IF
  6831
  6832     GO TO 1035-ACCT-COMM-LOOP.
  6833
  6834 1035-COMPUTE-TOT-CAN.
  6835
  6836     COMPUTE PI-TOT-CAN-COMP = PI-TOT-CAN-COMP +
  6837                               WS-LF-CAN-COMP +
  6838                               WS-AH-CAN-COMP.
  6839
  6840 1039-EXIT.
  6841     EXIT.
  6842
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 130
* EL640.cbl
  6844 1040-UPDATE-BILLING-STATISTICS.
  6845     SET PINDX                   TO 1.
  6846
  6847 1041-SEARCH-LOOP.
  6848     IF PI-NON-PREM (PINDX) NOT NUMERIC
  6849        MOVE ZEROS               TO PI-NON-PREM (PINDX).
  6850     IF WS-NON-PREM  NOT NUMERIC
  6851        MOVE ZEROS               TO WS-NON-PREM.
  6852     IF PI-NON-COMM (PINDX) NOT NUMERIC
  6853        MOVE ZEROS               TO PI-NON-COMM (PINDX).
  6854     IF WS-NON-COMM  NOT NUMERIC
  6855        MOVE ZEROS               TO WS-NON-COMM.
  6856
  6857     IF PI-BATCH (PINDX) NOT = SPACES
  6858         GO TO 1042-CHECK-FOR-MATCH.
  6859
  6860     MOVE PB-ENTRY-BATCH         TO PI-BATCH (PINDX).
  6861
  6862     IF PI-COMPANY-ID = 'DMD'
  6863         PERFORM 1060-DMD-ERROR-ROUTINE THRU 1060-EXIT.
  6864
  6865     IF DO-NOT-BILL-THIS-ACCT OR
  6866        PB-FATAL-ERRORS       OR
  6867        PB-UNFORCED-ERRORS    OR
  6868        PB-RECORD-ON-HOLD     OR
  6869        PB-RECORD-RETURNED    OR
  6870        PI-VOID-BILL
  6871         MOVE +1                 TO PI-NOBILL (PINDX)
  6872         MOVE ZEROS              TO PI-BILLED (PINDX)
  6873                                    PI-PREV   (PINDX)
  6874     ELSE
  6875         IF PB-BILLED-DT = LOW-VALUES
  6876           OR PI-TOT-REBILL
  6877             MOVE +1             TO PI-BILLED (PINDX)
  6878             MOVE ZEROS          TO PI-NOBILL (PINDX)
  6879                                    PI-PREV   (PINDX)
  6880         ELSE
  6881             MOVE +1             TO PI-PREV   (PINDX)
  6882             MOVE ZEROS          TO PI-BILLED (PINDX)
  6883                                    PI-NOBILL (PINDX).
  6884
  6885     GO TO 1049-EXIT.
  6886
  6887 1042-CHECK-FOR-MATCH.
  6888     IF PI-BATCH (PINDX) = PB-ENTRY-BATCH
  6889         NEXT SENTENCE
  6890     ELSE
  6891         GO TO 1043-SET-INDEX-UP.
  6892
  6893     IF PI-COMPANY-ID = 'DMD'
  6894         PERFORM 1060-DMD-ERROR-ROUTINE THRU 1060-EXIT.
  6895
  6896     IF DO-NOT-BILL-THIS-ACCT OR
  6897        PB-FATAL-ERRORS       OR
  6898        PB-UNFORCED-ERRORS    OR
  6899        PB-RECORD-ON-HOLD     OR
  6900        PB-RECORD-RETURNED    OR
  6901        PI-VOID-BILL
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 131
* EL640.cbl
  6902         ADD +1 TO PI-NOBILL (PINDX)
  6903     ELSE
  6904         IF PB-BILLED-DT = LOW-VALUES
  6905           OR PI-TOT-REBILL
  6906             ADD +1          TO PI-BILLED (PINDX)
  6907         ELSE
  6908             ADD +1          TO PI-PREV   (PINDX).
  6909
  6910     GO TO 1049-EXIT.
  6911
  6912 1043-SET-INDEX-UP.
  6913     SET PINDX UP BY 1.
  6914
  6915     IF PINDX > +6
  6916         MOVE 'Y'                TO BATCHES-PROCESSED-SW
  6917         GO TO 1049-EXIT
  6918     ELSE
  6919         GO TO 1041-SEARCH-LOOP.
  6920
  6921 1049-EXIT.
  6922     EXIT.
  6923
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 132
* EL640.cbl
  6925 1050-BILL-BATCH-TRAILER-CHK.
  6926     SET PINDX                   TO 1.
  6927
  6928 1052-LOOP.
  6929     IF PI-BATCH (PINDX) = SPACES
  6930         GO TO 1059-EXIT.
  6931
  6932     IF PB-ENTRY-BATCH = PI-BATCH (PINDX)
  6933       AND PI-BILLED (PINDX) NOT = ZEROS
  6934         MOVE 'Y'                TO BILL-BATCH-TRAILER-SW
  6935         GO TO 1059-EXIT.
  6936
  6937     SET PINDX UP BY 1.
  6938     IF PINDX NOT > 6
  6939         GO TO 1052-LOOP.
  6940
  6941 1059-EXIT.
  6942     EXIT.
  6943
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 133
* EL640.cbl
  6945 1060-DMD-ERROR-ROUTINE.
  6946     IF PB-FATAL-ERRORS OR PB-UNFORCED-ERRORS
  6947        IF ABILERRI = 'Y'
  6948           IF PB-ISSUE
  6949              COMPUTE WS-NON-PREM = PB-I-LF-PREMIUM-AMT
  6950                 + PB-I-LF-ALT-PREMIUM-AMT
  6951                 + PB-I-AH-PREMIUM-AMT
  6952              ADD WS-NON-PREM TO PI-NON-PREM (PINDX)
  6953              COMPUTE WS-NON-COMM ROUNDED =
  6954              ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
  6955                                    * PB-I-LIFE-COMMISSION)
  6956                                    +
  6957               (PB-I-AH-PREMIUM-AMT * PB-I-AH-COMMISSION)
  6958              ADD WS-NON-COMM TO PI-NON-COMM (PINDX)
  6959           ELSE
  6960           IF PB-CANCELLATION
  6961              COMPUTE WS-NON-PREM =
  6962              (PB-C-LF-CANCEL-AMT +  PB-C-AH-CANCEL-AMT) * -1
  6963              ADD WS-NON-PREM TO PI-NON-PREM (PINDX)
  6964              COMPUTE WS-NON-COMM ROUNDED =
  6965              ((PB-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION)
  6966                                   +
  6967               (PB-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION))
  6968                                   * -1
  6969              ADD WS-NON-COMM TO PI-NON-COMM (PINDX).
  6970
  6971 1060-EXIT.
  6972     EXIT.
  6973
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 134
* EL640.cbl
  6975 1100-PYAJ-BILLING-PROCESS.
  6976*                *******************************************
  6977*                *  PROCESS THE PAYMENTS/ADJUSTMENTS FILE    *
  6978*                *******************************************
  6979
  6980     IF LIMIT-BILLING AND NOT PI-DATA-BILLED
  6981         MOVE ER-2443            TO EMI-ERROR
  6982         MOVE -1                 TO ABTCH1L
  6983         MOVE AL-UABON           TO ABTCH1A
  6984         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6985         GO TO 8200-SEND-DATAONLY.
  6986
  6987     IF NOT PI-DATA-BILLED
  6988         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  6989         IF EMI-ERROR = ZEROS
  6990             MOVE AM-AGT (AM-REMIT-TO) TO PI-SAV-REMIT-TO
  6991                                          PI-CR-FIN-RESP
  6992             MOVE AM-REMIT-TO            TO ACCOM-SUB
  6993             MOVE 'A'                    TO PI-CR-TYPE
  6994             PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  6995             IF EMI-ERROR NOT = ZEROS
  6996                 GO TO 8200-SEND-DATAONLY
  6997             ELSE
  6998                 NEXT SENTENCE
  6999         ELSE
  7000             GO TO 8200-SEND-DATAONLY.
  7001
  7002 1105-PYAJ-BILLING-STARTBR-LOOP.
  7003     PERFORM 4500-PYAJ-START-BROWSE THRU 4590-EXIT.
  7004
  7005     IF PYAJ-EOF
  7006         GO TO 1200-PYAJ-BILLING-COMPLETE.
  7007
  7008 1110-PYAJ-BILLING-READ-LOOP.
  7009     PERFORM 4600-PYAJ-READ-NEXT THRU 4690-EXIT.
  7010
  7011     IF PYAJ-EOF
  7012         GO TO 1200-PYAJ-BILLING-COMPLETE.
  7013
  7014     IF PY-COMPANY-CD = PI-COMPANY-CD      AND
  7015        PY-CARRIER    = ERPYAJ-BR-CARRIER  AND
  7016        PY-GROUPING   = ERPYAJ-BR-GROUPING AND
  7017        PY-FIN-RESP   = PI-SAV-REMIT-TO    AND
  7018        PY-ACCOUNT    = PI-SAV-ACCT
  7019         NEXT SENTENCE
  7020     ELSE
  7021         GO TO 1200-PYAJ-BILLING-COMPLETE.
  7022
  7023     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  7024         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  7025
  7026     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'C' OR 'S' OR 'T' OR 'U'
  7027                         OR 'Z'
  7028         NEXT SENTENCE
  7029     ELSE
  7030         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  7031
  7032     IF PY-VOID-SW NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 135
* EL640.cbl
  7033         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  7034
  7035     IF PI-AR-PROCESSING
  7036        IF PY-AR-DATE = LOW-VALUES
  7037           OR PI-TOT-REBILL
  7038           OR RETURNED-FROM = XCTL-PYAJ
  7039           NEXT SENTENCE
  7040        ELSE
  7041           GO TO 1110-PYAJ-BILLING-READ-LOOP
  7042     ELSE
  7043        IF (PY-BILLED-DATE = LOW-VALUES AND
  7044            PY-AR-DATE = LOW-VALUES)
  7045           OR PI-TOT-REBILL
  7046           OR RETURNED-FROM = XCTL-PYAJ
  7047           NEXT SENTENCE
  7048        ELSE
  7049           GO TO 1110-PYAJ-BILLING-READ-LOOP.
  7050
  7051     MOVE 'Y'                    TO PI-DATA-BILLED-SW.
  7052
  7053     IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  7054         PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  7055         PY-ADD-TO-BALANCE
  7056         ADD PY-ENTRY-AMT  TO  PI-REMITTED
  7057     ELSE
  7058         IF (PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT)
  7059            AND PY-BILLING-CHECK
  7060             ADD PY-ENTRY-AMT TO PI-DISBURSED
  7061         ELSE
  7062             ADD PY-ENTRY-AMT TO PI-ADJUSTMENTS.
  7063
  7064     IF RETURNED-FROM = SPACES
  7065         IF PI-UPDATE-FILES
  7066           OR (PI-PREVIEW AND APRODSWI = 'Y')
  7067             MOVE 'BP'           TO BILLING-DETAIL-TYPE
  7068             PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  7069
  7070     IF RETURNED-FROM = SPACES
  7071       AND (PI-BILL OR PI-REBILLING)
  7072         PERFORM 4800-PYAJ-END-BROWSE
  7073         PERFORM 4700-PYAJ-REWRITE THRU 4790-EXIT
  7074         ADD +1 TO ERPYAJ-FILE-SEQ-NO
  7075         GO TO 1105-PYAJ-BILLING-STARTBR-LOOP.
  7076
  7077     GO TO 1110-PYAJ-BILLING-READ-LOOP.
  7078
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 136
* EL640.cbl
  7080 1200-PYAJ-BILLING-COMPLETE.
  7081     IF PI-DATA-BILLED
  7082       IF RETURNED-FROM = SPACES
  7083         IF PI-UPDATE-FILES
  7084            OR (PI-PREVIEW AND APRODSWI = 'Y')
  7085               MOVE 'TS'           TO BILLING-DETAIL-TYPE
  7086               PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  7087
  7088     PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT.
  7089
  7090     GO TO 8100-SEND-INITIAL-MAP.
  7091
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 137
* EL640.cbl
  7093 1300-CHECK-OVERRIDE-PREM.
  7094     IF PB-CANCELLATION
  7095        IF PB-CI-CANCEL-FEE NOT NUMERIC
  7096           MOVE ZEROS  TO  PB-CI-CANCEL-FEE
  7097        END-IF
  7098     END-IF
  7099
  7100     MOVE ZEROS                  TO WS-I-LF-PREMIUM-AMT
  7101                                    WS-I-LF-BENEFIT-AMT
  7102     IF PB-OVERRIDE-LIFE  OR
  7103        PB-OVERRIDE-BOTH
  7104         GO TO 1310-LIFE-OVERRIDE.
  7105
  7106     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7107         IF PB-ISSUE
  7108           IF NOT PB-INVALID-LIFE
  7109            COMPUTE  WS-I-LF-PREMIUM-AMT =
  7110                    (PB-I-LF-PREMIUM-AMT +
  7111                     PB-I-LF-ALT-PREMIUM-AMT) * -1
  7112            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7113                    (PB-I-LF-BENEFIT-AMT +
  7114                     PB-I-LF-ALT-BENEFIT-AMT) * -1
  7115           END-IF
  7116         ELSE
  7117             MULTIPLY PB-C-LF-CANCEL-AMT BY -1
  7118                            GIVING WS-C-LF-CANCEL-AMT
  7119             MULTIPLY PB-CI-LF-BENEFIT-AMT BY -1
  7120                            GIVING WS-CI-LIFE-BENEFIT
  7121         END-IF
  7122     ELSE
  7123         IF PB-ISSUE
  7124           IF NOT PB-INVALID-LIFE
  7125            ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
  7126                GIVING WS-I-LF-PREMIUM-AMT
  7127            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7128                     PB-I-LF-BENEFIT-AMT +
  7129                     PB-I-LF-ALT-BENEFIT-AMT
  7130           END-IF
  7131         ELSE
  7132            MOVE PB-C-LF-CANCEL-AMT   TO WS-C-LF-CANCEL-AMT
  7133            MOVE PB-CI-LF-BENEFIT-AMT TO WS-CI-LIFE-BENEFIT
  7134         END-IF
  7135     END-IF
  7136
  7137     GO TO 1320-CHECK-AH
  7138
  7139     .
  7140 1310-LIFE-OVERRIDE.
  7141     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7142         IF PB-ISSUE
  7143           IF NOT PB-INVALID-LIFE
  7144            COMPUTE WS-I-LF-PREMIUM-AMT =
  7145                   (PB-I-LF-PREM-CALC +
  7146                      PB-I-LF-ALT-PREM-CALC) * -1
  7147            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7148                     (PB-I-LF-BENEFIT-AMT +
  7149                      PB-I-LF-ALT-BENEFIT-AMT) * -1
  7150           END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 138
* EL640.cbl
  7151         ELSE
  7152             MULTIPLY PB-C-LF-REF-CALC BY -1
  7153                            GIVING WS-C-LF-CANCEL-AMT
  7154             MULTIPLY PB-CI-LF-BENEFIT-AMT BY -1
  7155                            GIVING WS-CI-LIFE-BENEFIT
  7156         END-IF
  7157     ELSE
  7158         IF PB-ISSUE
  7159           IF NOT PB-INVALID-LIFE
  7160            ADD PB-I-LF-PREM-CALC   PB-I-LF-ALT-PREM-CALC
  7161                GIVING WS-I-LF-PREMIUM-AMT
  7162            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7163                     PB-I-LF-BENEFIT-AMT +
  7164                     PB-I-LF-ALT-BENEFIT-AMT
  7165           END-IF
  7166         ELSE
  7167            MOVE PB-C-LF-REF-CALC     TO WS-C-LF-CANCEL-AMT
  7168            MOVE PB-CI-LF-BENEFIT-AMT TO WS-CI-LIFE-BENEFIT
  7169         END-IF
  7170     END-IF
  7171     .
  7172 1320-CHECK-AH.
  7173     IF PB-OVERRIDE-AH  OR
  7174        PB-OVERRIDE-BOTH
  7175         GO TO 1330-AH-OVERRIDE.
  7176
  7177     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7178         IF PB-ISSUE
  7179            MULTIPLY PB-I-AH-BENEFIT-AMT BY -1
  7180                            GIVING WS-I-AH-BENEFIT-AMT
  7181            MULTIPLY PB-I-AH-PREMIUM-AMT BY -1
  7182                            GIVING WS-I-AH-PREMIUM-AMT
  7183         ELSE
  7184             MULTIPLY PB-C-AH-CANCEL-AMT BY -1
  7185                            GIVING WS-C-AH-CANCEL-AMT
  7186     ELSE
  7187         IF PB-ISSUE
  7188            MOVE PB-I-AH-BENEFIT-AMT TO WS-I-AH-BENEFIT-AMT
  7189            MOVE PB-I-AH-PREMIUM-AMT TO WS-I-AH-PREMIUM-AMT
  7190         ELSE
  7191            MOVE PB-C-AH-CANCEL-AMT TO WS-C-AH-CANCEL-AMT
  7192            IF  PB-CI-CANCEL-FEE > ZEROS
  7193                MOVE PB-CI-CANCEL-FEE     TO WS-C-CANCEL-FEE
  7194                MULTIPLY WS-C-CANCEL-FEE BY -1
  7195                                          GIVING WORK-CANCEL-FEE
  7196                ADD WORK-CANCEL-FEE       TO TOT-REPT-CANCEL-FEE.
  7197
  7198     GO TO 1399-EXIT.
  7199
  7200 1330-AH-OVERRIDE.
  7201     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7202         IF PB-ISSUE
  7203            MULTIPLY PB-I-AH-BENEFIT-AMT BY -1
  7204                            GIVING WS-I-AH-BENEFIT-AMT
  7205            MULTIPLY PB-I-AH-PREM-CALC BY -1
  7206                            GIVING WS-I-AH-PREMIUM-AMT
  7207         ELSE
  7208             MULTIPLY PB-C-AH-REF-CALC BY -1
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 139
* EL640.cbl
  7209                            GIVING WS-C-AH-CANCEL-AMT
  7210     ELSE
  7211         IF PB-ISSUE
  7212            MOVE PB-I-AH-BENEFIT-AMT TO WS-I-AH-BENEFIT-AMT
  7213            MOVE PB-I-AH-PREM-CALC   TO WS-I-AH-PREMIUM-AMT
  7214         ELSE
  7215            MOVE PB-C-AH-REF-CALC    TO WS-C-AH-CANCEL-AMT
  7216            IF PB-CI-CANCEL-FEE > ZEROS
  7217                MOVE PB-CI-CANCEL-FEE     TO WS-C-CANCEL-FEE
  7218                MULTIPLY WS-C-CANCEL-FEE BY -1
  7219                                          GIVING WORK-CANCEL-FEE
  7220                ADD WORK-CANCEL-FEE       TO TOT-REPT-CANCEL-FEE.
  7221
  7222 1399-EXIT.
  7223     EXIT.
  7224
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 140
* EL640.cbl
  7226 2000-VOID-BILLING.
  7227
  7228*                *******************************************
  7229*                *  PROCESS VOID BILLING.  THIS SECTION    *
  7230*                *  WILL RESET THE FILES TO THE STATUS     *
  7231*                *  THEY WERE IN PRIOR TO THE LAST BILLING *
  7232*                *******************************************
  7233
  7234     MOVE SPACES                 TO WS-EXP-DATE
  7235                                    WS-REMIT-TO.
  7236     SET DTNDX  RTNDX            TO 1.
  7237     MOVE SPACES                 TO ELCNTL-KEY.
  7238     MOVE '1'                    TO ELCNTL-REC-TYPE.
  7239
  7240     PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT.
  7241
  7242     IF EMI-ERROR NOT = ZEROS
  7243         GO TO 8200-SEND-DATAONLY.
  7244
  7245     MOVE CF-CURRENT-MONTH-END   TO DC-BIN-DATE-1.
  7246     MOVE SPACE                  TO DC-OPTION-CODE.
  7247     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7248     MOVE DC-GREG-DATE-1-EDIT    TO PI-MONTH-END-DATE.
  7249
  7250     PERFORM 4000-PNDB-START-BROWSE THRU 4090-EXIT.
  7251
  7252     IF PNDB-EOF
  7253         GO TO 2100-VOID-PNDB-COMPLETE.
  7254
  7255 2010-VOID-PNDB-LOOP.
  7256     PERFORM 4100-PNDB-READ-NEXT THRU 4190-EXIT.
  7257
  7258     IF PNDB-EOF
  7259         GO TO 2100-VOID-PNDB-COMPLETE.
  7260
  7261     IF PB-COMPANY-CD-A1 = PI-COMPANY-CD  AND
  7262        PB-CARRIER       = PI-SAV-CARR    AND
  7263        PB-GROUPING      = PI-SAV-GROUP   AND
  7264        PB-STATE         = PI-SAV-STATE   AND
  7265        PB-ACCOUNT       = PI-SAV-ACCT
  7266         NEXT SENTENCE
  7267     ELSE
  7268         GO TO 2100-VOID-PNDB-COMPLETE.
  7269
  7270     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  7271         GO TO 2010-VOID-PNDB-LOOP.
  7272
  7273     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7274         MOVE PB-CONTROL-PRIMARY TO ERPNDB-PRIME-KEY
  7275
  7276* EXEC CICS ENDBR
  7277*             DATASET (ERPNDB-ALT-FILE-ID)
  7278*        END-EXEC
  7279     MOVE 0
  7280       TO DFHEIV11
  7281*    MOVE '&2                    $   #00007175' TO DFHEIV0
  7282     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7283     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 141
* EL640.cbl
  7284     MOVE X'2020233030303037313735' TO DFHEIV0(25:11)
  7285     CALL 'kxdfhei1' USING DFHEIV0,
  7286           ERPNDB-ALT-FILE-ID,
  7287           DFHEIV11,
  7288           DFHEIV99
  7289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7290
  7291* EXEC CICS DELETE
  7292*            DATASET (ERPNDB-FILE-ID)
  7293*            RIDFLD  (ERPNDB-PRIME-KEY)
  7294*        END-EXEC
  7295*    MOVE '&(  R                 &   #00007178' TO DFHEIV0
  7296     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7297     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7298     MOVE X'2020233030303037313738' TO DFHEIV0(25:11)
  7299     CALL 'kxdfhei1' USING DFHEIV0,
  7300           ERPNDB-FILE-ID,
  7301           ERPNDB-PRIME-KEY,
  7302           DFHEIV99,
  7303           DFHEIV99,
  7304           DFHEIV99
  7305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7306         PERFORM 4000-PNDB-START-BROWSE THRU 4090-EXIT
  7307         IF PNDB-EOF
  7308            GO TO 2100-VOID-PNDB-COMPLETE
  7309         ELSE
  7310            GO TO 2010-VOID-PNDB-LOOP.
  7311
  7312     IF PB-BILLED-DT = LOW-VALUES  AND
  7313        PB-CHG-COUNT = ZEROS
  7314         GO TO 2010-VOID-PNDB-LOOP.
  7315
  7316     IF PB-BATCH-TRAILER
  7317         GO TO 2115-CONT.
  7318
  7319     IF PB-CERT-EFF-DT > ERACCT-A-EXP-DATE
  7320         MOVE PB-CERT-EFF-DT     TO PI-SAV-EXP-DT
  7321         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  7322         IF AM-AGT (AM-REMIT-TO) NOT = WORK-REMIT-TO
  7323             MOVE AM-AGT (AM-REMIT-TO) TO WORK-REMIT-TO
  7324                                          WS-SAV-REMIT-TO (RTNDX)
  7325             IF RTNDX < 10
  7326                 SET RTNDX UP BY 1.
  7327
  7328 2115-CONT.
  7329     IF NOT PB-BATCH-TRAILER
  7330         PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  7331         PERFORM 1300-CHECK-OVERRIDE-PREM       THRU 1399-EXIT
  7332         PERFORM 1030-COMPUTE-COMMISSION-TOTALS THRU 1039-EXIT.
  7333
  7334     PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT.
  7335
  7336     MOVE 'Y'                    TO DATA-VOIDED-SW.
  7337     GO TO 2010-VOID-PNDB-LOOP.
  7338
  7339 2100-VOID-PNDB-COMPLETE.
  7340     SET RTNDX                   TO 1.
  7341
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 142
* EL640.cbl
  7342     IF NOT DATA-VOIDED
  7343         SET DTNDX TO RTNDX
  7344         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  7345         MOVE AM-AGT (AM-REMIT-TO) TO WS-SAV-REMIT-TO (RTNDX).
  7346
  7347 2105-PYAJ-LOOP.
  7348     IF RTNDX > 10
  7349       OR WS-SAV-REMIT-TO (RTNDX) = SPACES
  7350         GO TO 2105-VOID-CONTINUE.
  7351
  7352     MOVE WS-SAV-REMIT-TO (RTNDX) TO PI-SAV-REMIT-TO.
  7353     PERFORM 2200-VOID-PYAJ THRU 2290-EXIT.
  7354
  7355     SET RTNDX UP BY 1.
  7356     GO TO 2105-PYAJ-LOOP.
  7357
  7358 2105-VOID-CONTINUE.
  7359     IF DATA-VOIDED
  7360         NEXT SENTENCE
  7361     ELSE
  7362         MOVE -1                 TO APFNTERL
  7363         MOVE ER-2401            TO EMI-ERROR
  7364         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7365         GO TO 8100-SEND-INITIAL-MAP.
  7366
  7367     SET DTNDX                   TO 1.
  7368
  7369 2105-VOID-MASTERS-LOOP.
  7370     IF WS-SAV-EXP-DT (DTNDX) = SPACES
  7371       OR DTNDX > 10
  7372         GO TO 2105-VOID-COMPLETE.
  7373
  7374     MOVE WS-SAV-EXP-DT (DTNDX) TO PI-SAV-EXP-DT.
  7375
  7376     PERFORM 4400-ERACCT-REWRITE THRU 4490-EXIT.
  7377
  7378     IF PI-SAV-REMIT-TO NOT = ERCOMP-FIN-RESP
  7379         PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  7380         PERFORM 3930-BILL-READ        THRU 3930-EXIT
  7381         IF NOT NO-BILL-RECS
  7382             PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT.
  7383
  7384     SET DTNDX UP BY 1.
  7385
  7386     GO TO 2105-VOID-MASTERS-LOOP.
  7387
  7388 2105-VOID-COMPLETE.
  7389     MOVE 0000                   TO EMI-ERROR.
  7390     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7391     SET PINDX ANDX TO 1.
  7392
  7393 2110-FORMAT-LOOP.
  7394     IF PI-BATCH (PINDX) NOT = SPACES
  7395         MOVE PI-BATCH  (PINDX)  TO BATCH  (ANDX)
  7396         MOVE PI-NOBILL (PINDX)  TO NOBILL (ANDX)
  7397         MOVE PI-BILLED (PINDX)  TO BILL   (ANDX)
  7398         SET ANDX PINDX UP BY 1
  7399         IF PINDX > 6
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 143
* EL640.cbl
  7400             NEXT SENTENCE
  7401         ELSE
  7402             GO TO 2110-FORMAT-LOOP.
  7403
  7404     MOVE -1                     TO AACCTL.
  7405
  7406     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 144
* EL640.cbl
  7408 2200-VOID-PYAJ.
  7409     PERFORM 4500-PYAJ-START-BROWSE THRU 4590-EXIT.
  7410
  7411     IF PYAJ-EOF
  7412         GO TO 2290-EXIT.
  7413
  7414 2210-VOID-PYAJ-LOOP.
  7415     PERFORM 4600-PYAJ-READ-NEXT THRU 4690-EXIT.
  7416
  7417     IF PYAJ-EOF
  7418         PERFORM 4800-PYAJ-END-BROWSE
  7419         GO TO 2290-EXIT.
  7420
  7421     IF PY-COMPANY-CD = PI-COMPANY-CD      AND
  7422        PY-CARRIER    = ERPYAJ-BR-CARRIER  AND
  7423        PY-GROUPING   = ERPYAJ-BR-GROUPING AND
  7424        PY-FIN-RESP   = PI-SAV-REMIT-TO    AND
  7425        PY-ACCOUNT    = PI-SAV-ACCT
  7426         NEXT SENTENCE
  7427     ELSE
  7428         PERFORM 4800-PYAJ-END-BROWSE
  7429         GO TO 2290-EXIT.
  7430
  7431     IF (PY-BILLED-DATE = LOW-VALUES AND
  7432            PY-AR-DATE = LOW-VALUES)
  7433       OR PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  7434         GO TO 2210-VOID-PYAJ-LOOP.
  7435
  7436     PERFORM 4800-PYAJ-END-BROWSE.
  7437
  7438     PERFORM 4700-PYAJ-REWRITE THRU 4790-EXIT.
  7439
  7440     MOVE 'Y'                    TO DATA-VOIDED-SW.
  7441     ADD +1 TO ERPYAJ-FILE-SEQ-NO.
  7442
  7443     GO TO 2200-VOID-PYAJ.
  7444
  7445 2290-EXIT.
  7446     EXIT.
  7447
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 145
* EL640.cbl
  7449
  7450 3000-WRITE-BILLING-DETAIL.
  7451
  7452*                *******************************************
  7453*                *  FORMATS THE BILLING DETAIL RECORDS.    *
  7454*                *  THESE RECORDS ARE CREATED IN THE       *
  7455*                *  SAME FORMAT THAT THEY WILL APPEAR      *
  7456*                *  WHEN PRINTED.                          *
  7457*                *******************************************
  7458
  7459     IF CARRIER-ADDRESS  OR
  7460        GEN-AGT-ADDRESS
  7461          PERFORM 3930-BILL-READ THRU 3930-EXIT
  7462         IF NO-BILL-RECS
  7463             GO TO 3200-FORMAT-HDR-ADDR-RECS
  7464         ELSE
  7465             IF BI-PREVIEW-ONLY
  7466               OR BI-INITIAL-PRINT-DATE NOT = LOW-VALUES
  7467               OR PI-TOT-REBILL
  7468                 PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT
  7469                 GO TO 3200-FORMAT-HDR-ADDR-RECS
  7470             ELSE
  7471                 MOVE ER-2403    TO EMI-ERROR
  7472                 MOVE -1         TO ABILTYPL
  7473                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7474                 GO TO 3990-EXIT.
  7475
  7476     IF TOTAL-STATEMENT
  7477         GO TO 3400-FORMAT-TOTAL-LINES.
  7478
  7479 3100-FORMAT-DETAIL-LINES.
  7480     IF PI-PREM (PINDX) NOT NUMERIC
  7481        MOVE ZEROS               TO PI-PREM (PINDX).
  7482     IF PI-COMM (PINDX) NOT NUMERIC
  7483        MOVE ZEROS               TO PI-COMM (PINDX).
  7484
  7485     IF WS-LINECTR > 23
  7486         MOVE ZEROS              TO WS-LINECTR
  7487         MOVE '3'                TO BI-RECORD-TYPE
  7488         MOVE TRIPLE-SPACE       TO BI-SKIP-CONTROL
  7489         MOVE '          CONTINUED ON NEXT PAGE'
  7490                                 TO BI-TEXT-LINE
  7491         PERFORM 3920-BILL-WRITE
  7492         PERFORM 3300-FORMAT-HEADINGS THRU 3380-EXIT.
  7493
  7494     IF WS-LINECTR = ZEROS
  7495         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7496     ELSE
  7497         MOVE SINGLE-SPACE       TO BI-SKIP-CONTROL
  7498     END-IF.
  7499
  7500     MOVE '3'                    TO BI-RECORD-TYPE.
  7501
  7502     IF BILLING-DETAIL-TYPE = 'BP'
  7503        IF PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT
  7504             MOVE PY-ENTRY-COMMENT   TO BI-TEXT-LINE
  7505             MULTIPLY PY-ENTRY-AMT   BY -1
  7506                              GIVING BI-TOT-PREM
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 146
* EL640.cbl
  7507             MOVE '* ACCOUNTING ENTRY *'  TO BI-TOT-DESC
  7508             ADD +1 TO WS-LINECTR
  7509             PERFORM 3920-BILL-WRITE
  7510             GO TO 3990-EXIT.
  7511
  7512     IF BILLING-DETAIL-TYPE = 'BP'
  7513         MOVE PY-ENTRY-COMMENT   TO BI-TEXT-LINE
  7514         MOVE PY-ENTRY-AMT       TO BI-TOT-PREM
  7515         MOVE '* ACCOUNTING ENTRY *'  TO BI-TOT-DESC
  7516         ADD +1 TO WS-LINECTR
  7517         PERFORM 3920-BILL-WRITE
  7518         GO TO 3990-EXIT.
  7519
  7520     MOVE SPACES                 TO BI-TEXT-LINE.
  7521
  7522     IF PB-ISSUE
  7523        NEXT SENTENCE
  7524     ELSE
  7525        GO TO 3110-FORMAT-DETAIL-CANCEL.
  7526
  7527     MOVE PB-I-INSURED-FIRST-NAME    TO BI-INS-1ST-NAME.
  7528     MOVE PB-I-INSURED-MIDDLE-INIT   TO BI-INS-INIT.
  7529
  7530     MOVE PB-I-INSURED-LAST-NAME     TO BI-INS-LAST-NAME.
  7531     MOVE PB-CERT-NO                 TO BI-CERT.
  7532     MOVE PB-I-LF-TERM               TO BI-ED-TERM  BI-TERM.
  7533     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
  7534     MOVE SPACE                      TO DC-OPTION-CODE.
  7535     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7536     MOVE DC-GREG-DATE-1-EDIT        TO BI-EFF-DT.
  7537
  7538     IF PI-COMPANY-ID = 'DMD' AND
  7539        PB-ISSUE  AND
  7540        NOT PB-INVALID-LIFE
  7541          MOVE PB-I-LF-BENEFIT-CD    TO WS-BENE-CD
  7542          MOVE WS-BENEFIT            TO PB-I-LF-ABBR.
  7543     move spaces                 to ws-lf-benefit-cd-stuff
  7544                                    bi-type
  7545     if not pb-invalid-life
  7546        move spaces              to bi-type
  7547        MOVE SPACES              TO ELCNTL-KEY
  7548        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  7549        MOVE '4'                 TO ELCNTL-REC-TYPE
  7550        MOVE PB-I-LF-BENEFIT-CD  TO ELCNTL-ACCESS (3:2)
  7551                                    CLAS-LOOK
  7552        MOVE +0                  TO ELCNTL-SEQ-NO
  7553        perform 6135-find-lf-benefit-cd
  7554                                 thru 6135-exit
  7555        if ws-lf-alpha <> spaces
  7556           if ws-lf-joint-ind = 'J'
  7557              move 'JOINT LIFE'  to bi-type
  7558           else
  7559              move 'SINGLE LIFE' to bi-type
  7560           end-if
  7561        end-if
  7562     end-if
  7563     IF NOT PB-INVALID-LIFE
  7564        if bi-type = spaces
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 147
* EL640.cbl
  7565           move pb-i-lf-abbr         to bi-type
  7566        end-if
  7567        MOVE WS-I-LF-PREMIUM-AMT     TO BI-PREM
  7568                                        BI-PREMIUM-AMT
  7569        ADD WS-I-LF-PREMIUM-AMT      TO TOT-REPT-LF-PREM
  7570        MULTIPLY PB-I-LIFE-COMMISSION BY 100 GIVING BI-ED-RATE
  7571        MOVE PB-I-LIFE-COMMISSION    TO BI-RATE
  7572        MOVE PI-LF-ISS-COMP          TO BI-COMM
  7573        ADD  PI-LF-ISS-COMP          TO TOT-REPT-LF-COMP
  7574        MOVE WS-I-LF-BENEFIT-AMT     TO BI-FACE-AMT
  7575                                        BI-BENEFIT-AMT
  7576        ADD WS-I-LF-BENEFIT-AMT      TO TOT-LF-REPT-FACE-AMT
  7577        ADD WS-I-LF-PREMIUM-AMT      TO  PI-PREM (PINDX)
  7578        ADD PI-LF-ISS-COMP           TO  PI-COMM (PINDX)
  7579        PERFORM 3920-BILL-WRITE
  7580        ADD +1 TO WS-LINECTR
  7581        MOVE SINGLE-SPACE            TO BI-SKIP-CONTROL
  7582        MOVE SPACES                  TO BI-TEXT-LINE.
  7583
  7584     IF PI-COMPANY-ID = 'DMD' AND
  7585        PB-ISSUE  AND
  7586        NOT PB-INVALID-AH
  7587          MOVE PB-I-AH-BENEFIT-CD    TO WS-BENE-CD
  7588          MOVE WS-BENEFIT            TO PB-I-AH-ABBR.
  7589
  7590     IF NOT PB-INVALID-AH
  7591        if ws-ah-alpha <> spaces
  7592           if ws-ah-joint-ind = 'J'
  7593              move 'JOINT DISABILITY'
  7594                                 to bi-type
  7595           else
  7596              move 'SINGLE DISABILITY'
  7597                                 to bi-type
  7598           end-if
  7599        else
  7600           MOVE PB-I-AH-ABBR         TO BI-TYPE
  7601        end-if
  7602        MOVE WS-I-AH-PREMIUM-AMT     TO BI-PREM
  7603                                        BI-PREMIUM-AMT
  7604        ADD WS-I-AH-PREMIUM-AMT      TO TOT-REPT-AH-PREM
  7605        MULTIPLY PB-I-AH-COMMISSION BY 100 GIVING BI-ED-RATE
  7606        MOVE PB-I-AH-COMMISSION      TO BI-RATE
  7607        MOVE PI-AH-ISS-COMP          TO BI-COMM
  7608        ADD PI-AH-ISS-COMP           TO TOT-REPT-AH-COMP
  7609        MOVE WS-I-AH-BENEFIT-AMT     TO BI-FACE-AMT
  7610        ADD WS-I-AH-BENEFIT-AMT      TO TOT-AH-REPT-FACE-AMT
  7611        ADD WS-I-AH-PREMIUM-AMT      TO  PI-PREM (PINDX)
  7612        ADD PI-AH-ISS-COMP           TO  PI-COMM (PINDX)
  7613        PERFORM 3920-BILL-WRITE
  7614        MOVE SINGLE-SPACE            TO BI-SKIP-CONTROL
  7615        ADD +1                       TO WS-LINECTR.
  7616
  7617     GO TO 3990-EXIT.
  7618
  7619 3110-FORMAT-DETAIL-CANCEL.
  7620     MOVE PB-CI-LAST-NAME            TO BI-INS-LAST-NAME.
  7621     MOVE PB-CI-INITIALS             TO BI-INS-INITS.
  7622
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 148
* EL640.cbl
  7623     MOVE PB-CERT-NO                 TO BI-CERT.
  7624     MOVE PB-CI-LF-TERM              TO BI-ED-TERM
  7625                                        BI-TERM.
  7626     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
  7627     MOVE SPACE                      TO DC-OPTION-CODE.
  7628     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7629     MOVE DC-GREG-DATE-1-EDIT        TO BI-EFF-DT.
  7630
  7631     IF PI-COMPANY-ID = 'DMD' AND
  7632        PB-CANCELLATION AND
  7633        PB-CI-LF-ABBR > SPACES
  7634          MOVE PB-CI-LF-BENEFIT-CD   TO WS-BENE-CD
  7635          MOVE WS-BENEFIT            TO PB-CI-LF-ABBR.
  7636     move spaces                 to bi-type
  7637     if pb-ci-lf-benefit-cd <> '  ' and '00'
  7638        move spaces              to bi-type
  7639        MOVE SPACES              TO ELCNTL-KEY
  7640        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  7641        MOVE '4'                 TO ELCNTL-REC-TYPE
  7642        MOVE PB-ci-lf-benefit-cd TO ELCNTL-ACCESS (3:2)
  7643                                    CLAS-LOOK
  7644        MOVE +0                  TO ELCNTL-SEQ-NO
  7645        perform 6135-find-lf-benefit-cd
  7646                                 thru 6135-exit
  7647        if ws-lf-alpha not = spaces
  7648           if ws-lf-joint-ind = 'J'
  7649              move 'JOINT LIFE'  to bi-type
  7650           else
  7651              move 'SINGLE LIFE' to bi-type
  7652           end-if
  7653        end-if
  7654     end-if
  7655     IF PB-CI-LF-ABBR > SPACES
  7656         MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
  7657         MOVE SPACE                  TO DC-OPTION-CODE
  7658         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7659         MOVE DC-GREG-DATE-1-EDIT    TO BI-CAN-DT
  7660         if bi-type = spaces
  7661            MOVE PB-CI-LF-ABBR       TO BI-TYPE
  7662         end-if
  7663         MOVE WS-C-LF-CANCEL-AMT     TO BI-PREMIUM-AMT
  7664         MULTIPLY WS-C-LF-CANCEL-AMT BY -1 GIVING WORK-AMT
  7665         MOVE WORK-AMT               TO BI-PREM
  7666         ADD WS-C-LF-CANCEL-AMT      TO TOT-REPT-LF-REF
  7667         ADD WORK-AMT                TO TOT-REPT-LF-PREM
  7668                                        PI-PREM (PINDX)
  7669         MULTIPLY PB-CI-LIFE-COMMISSION
  7670                                     BY 100 GIVING BI-ED-RATE
  7671         MOVE PB-CI-LIFE-COMMISSION  TO BI-RATE
  7672         IF WS-CHARGEBACK-LF-SW = 'N'
  7673             MOVE  ZEROS                 TO PI-LF-CAN-COMP
  7674             MOVE PI-LF-CAN-COMP         TO BI-COMM
  7675             ADD PI-LF-CAN-COMP          TO TOT-REPT-LF-COMP
  7676                                            PI-COMM (PINDX)
  7677             COMPUTE TOT-REPT-LF-COMP-R =
  7678               TOT-REPT-LF-COMP-R + (PI-LF-CAN-COMP * -1)
  7679             MOVE WS-CI-LIFE-BENEFIT     TO BI-BENEFIT-AMT
  7680             ADD +1                      TO WS-LINECTR
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 149
* EL640.cbl
  7681             PERFORM 3920-BILL-WRITE
  7682             MOVE SPACES                 TO BI-TEXT-LINE
  7683         ELSE
  7684             MOVE PI-LF-CAN-COMP         TO BI-COMM
  7685             ADD PI-LF-CAN-COMP          TO TOT-REPT-LF-COMP
  7686                                            PI-COMM (PINDX)
  7687             COMPUTE TOT-REPT-LF-COMP-R =
  7688               TOT-REPT-LF-COMP-R + (PI-LF-CAN-COMP * -1)
  7689             MOVE  ZEROS                 TO PI-LF-CAN-COMP
  7690             MOVE WS-CI-LIFE-BENEFIT     TO BI-BENEFIT-AMT
  7691             ADD +1                      TO WS-LINECTR
  7692             PERFORM 3920-BILL-WRITE
  7693             MOVE SPACES                 TO BI-TEXT-LINE.
  7694
  7695     IF PI-COMPANY-ID = 'DMD' AND
  7696        PB-CANCELLATION AND
  7697        PB-CI-AH-ABBR > SPACES
  7698          MOVE PB-CI-AH-BENEFIT-CD   TO WS-BENE-CD
  7699          MOVE WS-BENEFIT            TO PB-CI-AH-ABBR.
  7700
  7701     IF PB-CI-AH-ABBR > SPACES
  7702        if ws-ah-alpha not = spaces
  7703           if ws-ah-joint-ind = 'J'
  7704              move 'JOINT DISABILITY'
  7705                                 to bi-type
  7706           else
  7707              move 'SINGLE DISABILITY'
  7708                                 to bi-type
  7709           end-if
  7710        else
  7711           move pb-ci-ah-abbr    to bi-type
  7712        end-if
  7713         MOVE PB-C-AH-CANCEL-DT      TO DC-BIN-DATE-1
  7714         MOVE SPACE                  TO DC-OPTION-CODE
  7715         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7716         MOVE DC-GREG-DATE-1-EDIT    TO BI-CAN-DT
  7717         MOVE WS-C-AH-CANCEL-AMT     TO BI-PREMIUM-AMT
  7718         MULTIPLY WS-C-AH-CANCEL-AMT BY -1 GIVING WORK-AMT
  7719         MOVE WORK-AMT               TO BI-PREM
  7720         ADD WS-C-AH-CANCEL-AMT      TO TOT-REPT-AH-REF
  7721         ADD WORK-AMT                TO TOT-REPT-AH-PREM
  7722                                        PI-PREM (PINDX)
  7723         MULTIPLY PB-CI-AH-COMMISSION BY 100 GIVING BI-ED-RATE
  7724         MOVE PB-CI-AH-COMMISSION    TO BI-RATE
  7725         IF WS-CHARGEBACK-AH-SW = 'N'
  7726             MOVE  ZEROS                 TO PI-AH-CAN-COMP
  7727             MOVE PI-AH-CAN-COMP         TO BI-COMM
  7728             ADD PI-AH-CAN-COMP          TO TOT-REPT-AH-COMP
  7729                                            PI-COMM (PINDX)
  7730             COMPUTE TOT-REPT-AH-COMP-R =
  7731               TOT-REPT-AH-COMP-R + (PI-AH-CAN-COMP * -1)
  7732             ADD +1                      TO WS-LINECTR
  7733             PERFORM 3920-BILL-WRITE
  7734         ELSE
  7735             MOVE PI-AH-CAN-COMP         TO BI-COMM
  7736             ADD PI-AH-CAN-COMP          TO TOT-REPT-AH-COMP
  7737                                            PI-COMM (PINDX)
  7738             COMPUTE TOT-REPT-AH-COMP-R =
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 150
* EL640.cbl
  7739               TOT-REPT-AH-COMP-R + (PI-AH-CAN-COMP * -1)
  7740             MOVE  ZEROS                 TO PI-AH-CAN-COMP
  7741             ADD +1                      TO WS-LINECTR
  7742             PERFORM 3920-BILL-WRITE.
  7743
  7744     IF PB-CI-CANCEL-FEE NOT NUMERIC
  7745         MOVE ZEROS                      TO PB-CI-CANCEL-FEE.
  7746
  7747     IF PB-CI-CANCEL-FEE > ZEROS
  7748         MOVE SPACES                 TO BI-INS-LAST-NAME
  7749                                        BI-INS-INITS
  7750                                        BI-EFF-DT
  7751                                        BI-CAN-DT
  7752                                        BI-TYPE
  7753         MOVE 'CANCEL FEE'           TO BI-CERT
  7754         MOVE WORK-CANCEL-FEE        TO BI-PREM
  7755                                        BI-COMM
  7756         MOVE ZEROS                  TO BI-PREMIUM-AMT
  7757                                        BI-RATE
  7758                                        BI-ED-RATE
  7759                                        BI-ED-TERM
  7760                                        BI-TERM
  7761         ADD +1                      TO WS-LINECTR
  7762         PERFORM 3920-BILL-WRITE.
  7763
  7764     GO TO 3990-EXIT.
  7765
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 151
* EL640.cbl
  7767
  7768 3200-FORMAT-HDR-ADDR-RECS.
  7769     PERFORM 3910-BILL-GETMAIN.
  7770
  7771     MOVE ZEROS                  TO WS-LINE-SEQ-NO.
  7772     SET A-INDX  R-INDX          TO 1.
  7773     PERFORM 3210-FORMAT-ADDR-RECS  THRU 3210-EXIT 6 TIMES.
  7774     MOVE ZEROS                  TO WS-LINE-SEQ-NO.
  7775     PERFORM 3300-FORMAT-HEADINGS THRU 3380-EXIT.
  7776     GO TO 3990-EXIT.
  7777
  7778 3210-FORMAT-ADDR-RECS.
  7779     MOVE '2'                     TO BI-RECORD-TYPE.
  7780     MOVE WS-ACCT-LINES (A-INDX)  TO BI-ACCT-ADDRESS-LINE.
  7781     MOVE WS-REMIT-LINES (R-INDX) TO BI-REMIT-ADDRESS-LINE.
  7782     PERFORM 3920-BILL-WRITE.
  7783     SET A-INDX  R-INDX         UP BY 1.
  7784
  7785 3210-EXIT.
  7786     EXIT.
  7787
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 152
* EL640.cbl
  7789 3300-FORMAT-HEADINGS.
  7790     MOVE WS-PGECTR              TO BI-HD-PG.
  7791     ADD +1                      TO WS-PGECTR.
  7792     MOVE '3'                    TO BI-RECORD-TYPE.
  7793     MOVE TOP-OF-PAGE            TO BI-SKIP-CONTROL.
  7794
  7795     IF NOT PI-PREVIEW
  7796         MOVE BI-HD1             TO BI-TEXT-LINE
  7797     ELSE
  7798         MOVE BI-PREVIEW-HD      TO BI-TEXT-LINE
  7799         PERFORM 3920-BILL-WRITE
  7800         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7801         MOVE BI-HD1             TO BI-TEXT-LINE.
  7802
  7803     PERFORM 3920-BILL-WRITE.
  7804     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7805     MOVE BI-HD2                 TO BI-TEXT-LINE.
  7806     PERFORM 3920-BILL-WRITE.
  7807     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7808     MOVE BI-HD3                 TO BI-TEXT-LINE.
  7809     PERFORM 3920-BILL-WRITE.
  7810     SET A-INDX  R-INDX          TO 1.
  7811     PERFORM 3390-FORMAT-ADDR-TEXT-LINES THRU 3390-EXIT 5 TIMES.
  7812     MOVE '3'                    TO BI-RECORD-TYPE.
  7813     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7814     MOVE BI-HD4                 TO BI-TEXT-LINE.
  7815     PERFORM 3920-BILL-WRITE.
  7816     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7817     MOVE BI-HD5                 TO BI-TEXT-LINE.
  7818     PERFORM 3920-BILL-WRITE.
  7819
  7820 3380-EXIT.
  7821     EXIT.
  7822
  7823 3390-FORMAT-ADDR-TEXT-LINES.
  7824     MOVE '3'                    TO BI-RECORD-TYPE.
  7825     MOVE SPACES                 TO BI-TEXT-LINE.
  7826
  7827     IF A-INDX = 1
  7828         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7829         MOVE 'ACCOUNT NO. - '   TO BI-ADDR-LIT
  7830         MOVE WS-CARR-COMP       TO BI-CO
  7831         MOVE '-'                TO BI-DASH
  7832         MOVE PI-SAV-ACCT        TO BI-ACCT
  7833         MOVE 'REMIT TO - '      TO BI-REMIT-LIT
  7834     ELSE
  7835         MOVE SINGLE-SPACE       TO BI-SKIP-CONTROL.
  7836
  7837     MOVE WS-ACCT-LINES (A-INDX)  TO BI-ACCT-ADDR.
  7838     MOVE WS-REMIT-LINES (R-INDX) TO BI-REMIT-ADDR.
  7839     PERFORM 3920-BILL-WRITE.
  7840     SET A-INDX  R-INDX  UP BY 1.
  7841
  7842 3390-EXIT.
  7843     EXIT.
  7844
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 153
* EL640.cbl
  7846 3400-FORMAT-TOTAL-LINES.
  7847     COMPUTE PI-END-BAL = PI-BAL-FRWD +
  7848                          PI-PREMIUM +
  7849                          TOT-REPT-CANCEL-FEE -
  7850                          PI-REMITTED -
  7851                          PI-TOT-ISS-COMP +
  7852                          PI-TOT-CAN-COMP +
  7853                          PI-ADJUSTMENTS +
  7854                          PI-DISBURSED.
  7855
  7856     MOVE SPACES                 TO BI-TEXT-LINE.
  7857
  7858     MOVE '1'                    TO BI-RECORD-TYPE.
  7859     MOVE PI-PROCESSOR-ID        TO BI-PROCESSOR-CD.
  7860
  7861     IF PI-PREV-BILL OR PI-PREV-REBILL
  7862         MOVE 'P'                TO BI-STATEMENT-TYPE.
  7863
  7864     MOVE +1                     TO BI-NO-OF-COPIES.
  7865     MOVE WS-CURRENT-DATE        TO BI-CREATION-DT.
  7866     MOVE LOW-VALUES             TO BI-INITIAL-PRINT-DATE.
  7867     MOVE PI-BAL-FRWD            TO BI-BAL-FRWD.
  7868     MOVE PI-PREMIUM             TO BI-PREMIUM.
  7869     MOVE PI-REMITTED            TO BI-REMITTED.
  7870     MOVE PI-TOT-ISS-COMP        TO BI-TOT-ISS-COMP.
  7871     MOVE PI-TOT-CAN-COMP        TO BI-TOT-CAN-COMP.
  7872     MOVE PI-ADJUSTMENTS         TO BI-ADJUSTMNTS.
  7873     MOVE PI-DISBURSED           TO BI-DISBURSED.
  7874     MOVE PI-END-BAL             TO BI-END-BAL.
  7875
  7876     IF PI-SAV-ACCT = PI-SAV-REMIT-TO
  7877         MOVE WS-ACCT-LINES (1)  TO BI-FIN-RESP-NAME
  7878     ELSE
  7879         MOVE WS-REMIT-LINES (1) TO BI-FIN-RESP-NAME.
  7880
  7881     PERFORM 3920-BILL-WRITE.
  7882
  7883     IF WS-LINECTR > 16
  7884         MOVE ZEROS              TO WS-LINECTR
  7885         MOVE '3'                TO BI-RECORD-TYPE
  7886         MOVE TRIPLE-SPACE       TO BI-SKIP-CONTROL
  7887         MOVE '          CONTINUED ON NEXT PAGE'
  7888                                 TO BI-TEXT-LINE
  7889         PERFORM 3920-BILL-WRITE
  7890         PERFORM 3300-FORMAT-HEADINGS THRU 3380-EXIT.
  7891
  7892     IF PI-BAL-FRWD NOT = ZERO
  7893         MOVE SPACES             TO BI-TEXT-LINE
  7894         MOVE '3'                TO BI-RECORD-TYPE
  7895         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7896         MOVE 'BALANCE FORWARD'  TO BI-TOT-DESC
  7897         MOVE PI-BAL-FRWD        TO BI-TOT-PREM
  7898         PERFORM 3920-BILL-WRITE.
  7899
  7900     IF PI-PREMIUM NOT = ZERO
  7901         MOVE SPACES             TO BI-TEXT-LINE
  7902         MOVE '3'                TO BI-RECORD-TYPE
  7903         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 154
* EL640.cbl
  7904         MOVE 'THIS MONTHS PREMIUM'  TO BI-TOT-DESC
  7905         COMPUTE WORK-AMT  =  TOT-REPT-CANCEL-FEE + PI-PREMIUM
  7906         MOVE WORK-AMT           TO BI-TOT-PREM
  7907         PERFORM 3920-BILL-WRITE.
  7908
  7909     IF PI-TOT-ISS-COMP NOT = ZEROS  OR
  7910        PI-TOT-CAN-COMP NOT = ZEROS
  7911         MOVE SPACES             TO BI-TEXT-LINE
  7912         MOVE '3'                TO BI-RECORD-TYPE
  7913         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7914         MOVE 'LESS COMPENSATION' TO BI-TOT-DESC
  7915         SUBTRACT PI-TOT-CAN-COMP FROM PI-TOT-ISS-COMP
  7916                          GIVING BI-TOT-PREM
  7917         PERFORM 3920-BILL-WRITE.
  7918
  7919     IF PI-REMITTED  NOT = ZEROS  OR
  7920        PI-DISBURSED NOT = ZEROS
  7921         MOVE SPACES             TO BI-TEXT-LINE
  7922         MOVE '3'                TO BI-RECORD-TYPE
  7923         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7924         MOVE 'LESS PAYMENTS'    TO BI-TOT-DESC
  7925         IF PI-COMPANY-ID = 'UCL'
  7926             SUBTRACT PI-DISBURSED FROM PI-REMITTED
  7927                      GIVING BI-TOT-PREM
  7928             PERFORM 3920-BILL-WRITE
  7929           ELSE
  7930             MOVE PI-REMITTED        TO BI-TOT-PREM
  7931             PERFORM 3920-BILL-WRITE.
  7932
  7933     IF PI-ADJUSTMENTS NOT = ZERO
  7934         MOVE SPACES             TO BI-TEXT-LINE
  7935         MOVE '3'                TO BI-RECORD-TYPE
  7936         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7937         MOVE 'ADJUSTMENT'       TO BI-TOT-DESC
  7938         ADD PI-ADJUSTMENTS, PI-DISBURSED GIVING BI-TOT-PREM
  7939         PERFORM 3920-BILL-WRITE.
  7940
  7941     MOVE SPACES                 TO BI-TEXT-LINE.
  7942     MOVE '3'                    TO BI-RECORD-TYPE.
  7943     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7944     MOVE ALL '-'                TO BI-TOT-DASH.
  7945     PERFORM 3920-BILL-WRITE.
  7946
  7947     MOVE SPACES                 TO BI-TEXT-LINE.
  7948     MOVE '3'                    TO BI-RECORD-TYPE.
  7949     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7950
  7951     IF PI-END-BAL < +1.00 AND > -1.00
  7952         NEXT SENTENCE
  7953     ELSE
  7954         IF PI-END-BAL < +0
  7955             MOVE 'WE WILL REFUND' TO BI-TOT-DESC
  7956         ELSE
  7957             MOVE 'PLEASE REMIT' TO BI-TOT-DESC.
  7958
  7959     MOVE PI-END-BAL             TO BI-TOT-PREM.
  7960
  7961     PERFORM 3920-BILL-WRITE.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 155
* EL640.cbl
  7962
  7963     IF CO-CARRY-BALANCE
  7964         IF PI-END-BAL > +1.00
  7965             MOVE SPACES         TO BI-TEXT-LINE
  7966             MOVE '3'            TO BI-RECORD-TYPE
  7967             MOVE DOUBLE-SPACE   TO BI-SKIP-CONTROL
  7968             MOVE 'PLEASE RETURN ONE COPY WITH REMITTANCE'
  7969                                 TO BI-TEXT-LINE
  7970             PERFORM 3920-BILL-WRITE.
  7971
  7972     IF PI-COMPANY-ID = 'DMD'
  7973        MOVE SPACES                 TO BI-TEXT-LINE
  7974        MOVE '3'                    TO BI-RECORD-TYPE
  7975        MOVE '0'                    TO BI-SKIP-CONTROL
  7976        MOVE BI-HD6                 TO BI-TEXT-LINE
  7977        PERFORM 3920-BILL-WRITE
  7978        MOVE SPACES                 TO BI-TEXT-LINE
  7979        MOVE ' '                    TO BI-SKIP-CONTROL
  7980        MOVE BI-HD7                 TO BI-TEXT-LINE
  7981        PERFORM 3920-BILL-WRITE
  7982
  7983        PERFORM 3600-FIND-BATCH-NUMBER THRU 3699-EXIT
  7984          VARYING PINDX FROM 1 BY 1
  7985            UNTIL PINDX > +6.
  7986
  7987     MOVE ZEROS                  TO PI-PREM     (PINDX)
  7988                                    PI-COMM     (PINDX)
  7989                                    PI-NON-PREM (PINDX)
  7990                                    PI-NON-COMM (PINDX).
  7991
  7992     GO TO 3990-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 156
* EL640.cbl
  7994
  7995 3500-TOTAL-OUT-DETAIL.
  7996     IF PI-DATA-BILLED AND
  7997        RETURNED-FROM = SPACES
  7998           NEXT SENTENCE
  7999       ELSE
  8000           GO TO 3599-EXIT.
  8001
  8002     IF PI-UPDATE-FILES  OR
  8003        (PI-PREVIEW AND APRODSWI = 'Y')
  8004           NEXT SENTENCE
  8005        ELSE
  8006           GO TO 3599-EXIT.
  8007
  8008     MOVE SPACES                 TO BI-TEXT-LINE.
  8009*    MOVE '3'                    TO BI-RECORD-TYPE.
  8010*    MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  8011*    MOVE 'TOTAL'                TO BI-TOT-LIT.
  8012*    MOVE PI-LIFE-OVERRIDE-L6    TO BI-OVERRIDE-L6.
  8013*    MOVE TOT-REPT-LF-PREM       TO BI-TOT-PREM.
  8014*    MOVE TOT-REPT-LF-COMP       TO BI-COM-TOT.
  8015*    MOVE TOT-LF-REPT-FACE-AMT   TO BI-FACE-TOT.
  8016*    PERFORM 3920-BILL-WRITE.
  8017*
  8018*    MOVE SPACES                 TO BI-TEXT-LINE.
  8019*    MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  8020*    MOVE 'TOTAL'                TO BI-TOT-LIT.
  8021*    MOVE PI-AH-OVERRIDE-L6      TO BI-OVERRIDE-L6.
  8022*    MOVE TOT-REPT-AH-PREM       TO BI-TOT-PREM
  8023*    MOVE TOT-REPT-AH-COMP       TO BI-COM-TOT.
  8024*    MOVE TOT-AH-REPT-FACE-AMT   TO BI-FACE-TOT.
  8025*    PERFORM 3920-BILL-WRITE.
  8026
  8027     MOVE SPACES                 TO BI-TEXT-LINE.
  8028     MOVE '3'                    TO BI-RECORD-TYPE.
  8029     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  8030     MOVE 'TOTAL PREM '          TO BI-TOT-DESC
  8031     MOVE PI-LIFE-OVERRIDE-L6    TO BI-TOT-DESC (12:6)
  8032     ADD TOT-REPT-LF-REF TOT-REPT-LF-PREM
  8033          GIVING BI-TOT-PREM
  8034     ADD TOT-REPT-LF-COMP TOT-REPT-LF-COMP-R
  8035          GIVING BI-COM-TOT
  8036*    MOVE TOT-REPT-LF-COMP       TO BI-COM-TOT.
  8037*    MOVE TOT-LF-REPT-FACE-AMT   TO BI-FACE-TOT.
  8038     PERFORM 3920-BILL-WRITE.
  8039
  8040     MOVE SPACES                 TO BI-TEXT-LINE.
  8041     MOVE '3'                    TO BI-RECORD-TYPE.
  8042     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  8043     MOVE 'TOTAL REF  '          TO BI-TOT-DESC
  8044     MOVE PI-LIFE-OVERRIDE-L6    TO BI-TOT-DESC (12:6)
  8045     MOVE TOT-REPT-LF-REF        TO BI-TOT-PREM.
  8046     MOVE TOT-REPT-LF-COMP-R     TO BI-COM-TOT
  8047     PERFORM 3920-BILL-WRITE.
  8048
  8049     MOVE SPACES                 TO BI-TEXT-LINE.
  8050     MOVE '3'                    TO BI-RECORD-TYPE.
  8051     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 157
* EL640.cbl
  8052     MOVE 'TOTAL NET  '          TO BI-TOT-DESC
  8053     MOVE PI-LIFE-OVERRIDE-L6    TO BI-TOT-DESC (12:6)
  8054     MOVE TOT-REPT-LF-PREM       TO BI-TOT-PREM
  8055     MOVE TOT-REPT-LF-COMP       TO BI-COM-TOT
  8056     MOVE TOT-LF-REPT-FACE-AMT   TO BI-FACE-TOT.
  8057     PERFORM 3920-BILL-WRITE.
  8058
  8059     MOVE SPACES                 TO BI-TEXT-LINE.
  8060     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  8061     MOVE 'TOTAL PREM '          TO BI-TOT-DESC
  8062     MOVE PI-AH-OVERRIDE-L6      TO BI-TOT-DESC (12:6)
  8063     ADD TOT-REPT-AH-REF TOT-REPT-AH-PREM
  8064          GIVING BI-TOT-PREM
  8065     ADD TOT-REPT-AH-COMP TOT-REPT-AH-COMP-R
  8066          GIVING BI-COM-TOT
  8067*    MOVE TOT-AH-REPT-FACE-AMT   TO BI-FACE-TOT.
  8068     PERFORM 3920-BILL-WRITE.
  8069
  8070     MOVE SPACES                 TO BI-TEXT-LINE.
  8071     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  8072     MOVE 'TOTAL REF  '          TO BI-TOT-DESC
  8073     MOVE PI-AH-OVERRIDE-L6      TO BI-TOT-DESC (12:6)
  8074     MOVE TOT-REPT-AH-REF        TO BI-TOT-PREM
  8075     MOVE TOT-REPT-AH-COMP-R     TO BI-COM-TOT.
  8076     PERFORM 3920-BILL-WRITE.
  8077
  8078     MOVE SPACES                 TO BI-TEXT-LINE.
  8079     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  8080     MOVE 'TOTAL NET  '          TO BI-TOT-DESC
  8081     MOVE PI-AH-OVERRIDE-L6      TO BI-TOT-DESC (12:6)
  8082     MOVE TOT-REPT-AH-PREM       TO BI-TOT-PREM
  8083     MOVE TOT-REPT-AH-COMP       TO BI-COM-TOT.
  8084     MOVE TOT-AH-REPT-FACE-AMT   TO BI-FACE-TOT.
  8085     PERFORM 3920-BILL-WRITE.
  8086
  8087     IF PB-CI-CANCEL-FEE NOT NUMERIC
  8088         MOVE ZEROS  TO  PB-CI-CANCEL-FEE.
  8089
  8090     IF PB-CI-CANCEL-FEE > ZEROS
  8091         MOVE SPACES                 TO BI-TEXT-LINE
  8092         MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL
  8093         MOVE 'TOTAL'                TO BI-TOT-LIT
  8094         MOVE 'CAN-FE'               TO BI-OVERRIDE-L6
  8095         MOVE TOT-REPT-CANCEL-FEE    TO BI-TOT-PREM
  8096                                        BI-COM-TOT
  8097         MOVE ZEROS                  TO BI-FACE-TOT
  8098         PERFORM 3920-BILL-WRITE.
  8099
  8100     MOVE SPACES                 TO BI-TEXT-LINE.
  8101     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  8102     PERFORM 3920-BILL-WRITE.
  8103
  8104 3599-EXIT.
  8105     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 158
* EL640.cbl
  8107
  8108 3600-FIND-BATCH-NUMBER.
  8109     IF PI-PREM (PINDX) NOT NUMERIC
  8110        MOVE ZEROS               TO PI-PREM (PINDX).
  8111     IF PI-COMM (PINDX) NOT NUMERIC
  8112        MOVE ZEROS               TO PI-COMM (PINDX).
  8113     IF PI-NON-PREM (PINDX) NOT NUMERIC
  8114        MOVE ZEROS               TO PI-NON-PREM (PINDX).
  8115     IF PI-NON-COMM (PINDX) NOT NUMERIC
  8116        MOVE ZEROS               TO PI-NON-COMM (PINDX).
  8117
  8118     IF PI-PREM (PINDX)     = ZEROS   AND
  8119        PI-COMM (PINDX)     = ZEROS   AND
  8120        PI-NON-PREM (PINDX) = ZEROS   AND
  8121        PI-NON-COMM (PINDX) = ZEROS
  8122          GO TO 3699-EXIT.
  8123
  8124     MOVE SPACES                 TO BI-TEXT-LINE.
  8125     MOVE '3'                    TO BI-RECORD-TYPE.
  8126     MOVE ' '                    TO BI-SKIP-CONTROL.
  8127     MOVE 'BATCH NO. '           TO WS-BATCH-DESC.
  8128     MOVE PI-BATCH (PINDX)       TO WS-BATCH-NBR.
  8129     MOVE WS-DESC                TO BI-TOT-DESC5.
  8130     MOVE PI-PREM (PINDX)        TO BI-TOT-PREM5.
  8131     MOVE PI-COMM (PINDX)        TO BI-COM-TOT5.
  8132     MOVE PI-NON-PREM (PINDX)    TO BI-NON-PREM5.
  8133     MOVE PI-NON-COMM (PINDX)    TO BI-NON-COMM5.
  8134     PERFORM 3920-BILL-WRITE.
  8135
  8136 3699-EXIT.
  8137     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 159
* EL640.cbl
  8139
  8140 3910-BILL-GETMAIN.
  8141
  8142* EXEC CICS GETMAIN
  8143*        SET     (ADDRESS OF BILLING-STATEMENT)
  8144*        LENGTH  (210)
  8145*        INITIMG (GETMAIN-SPACE)
  8146*    END-EXEC.
  8147     MOVE 210
  8148       TO DFHEIV11
  8149*    MOVE ',"IL                  $   #00008017' TO DFHEIV0
  8150     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8151     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8152     MOVE X'2020233030303038303137' TO DFHEIV0(25:11)
  8153     CALL 'kxdfhei1' USING DFHEIV0,
  8154           DFHEIV20,
  8155           DFHEIV11,
  8156           GETMAIN-SPACE
  8157     SET ADDRESS OF BILLING-STATEMENT TO
  8158         DFHEIV20
  8159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8160
  8161
  8162 3920-BILL-WRITE.
  8163     MOVE PI-COMPANY-CD          TO BI-COMPANY-CD.
  8164     MOVE PI-CR-CARRIER          TO BI-CARRIER.
  8165     MOVE PI-CR-GROUPING         TO BI-GROUPING
  8166     MOVE PI-SAV-ACCT            TO BI-ACCOUNT.
  8167     MOVE PI-SAV-REMIT-TO        TO BI-FIN-RESP.
  8168
  8169     MOVE 'BI'                   TO BI-RECORD-ID.
  8170     ADD +1                      TO WS-LINE-SEQ-NO.
  8171
  8172     IF BI-RECORD-TYPE = '1'
  8173         MOVE ZEROS              TO BI-LINE-SEQ-NO
  8174     ELSE
  8175         MOVE WS-LINE-SEQ-NO     TO BI-LINE-SEQ-NO.
  8176
  8177
  8178* EXEC CICS WRITE
  8179*        DATASET (ERBILL-FILE-ID)
  8180*        FROM    (BILLING-STATEMENT)
  8181*        RIDFLD  (BI-CONTROL-PRIMARY)
  8182*    END-EXEC.
  8183     MOVE LENGTH OF
  8184      BILLING-STATEMENT
  8185       TO DFHEIV11
  8186*    MOVE '&$ L                  ''   #00008038' TO DFHEIV0
  8187     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8188     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8189     MOVE X'2020233030303038303338' TO DFHEIV0(25:11)
  8190     CALL 'kxdfhei1' USING DFHEIV0,
  8191           ERBILL-FILE-ID,
  8192           BILLING-STATEMENT,
  8193           DFHEIV11,
  8194           BI-CONTROL-PRIMARY,
  8195           DFHEIV99,
  8196           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 160
* EL640.cbl
  8197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8198
  8199
  8200 3930-BILL-READ.
  8201     MOVE PI-COMPANY-CD          TO ERBILL-CO-CD.
  8202     MOVE PI-CR-CARRIER          TO ERBILL-CARRIER.
  8203     MOVE PI-CR-GROUPING         TO ERBILL-GROUP.
  8204     MOVE PI-SAV-ACCT            TO ERBILL-ACCT.
  8205     MOVE PI-SAV-REMIT-TO        TO ERBILL-FIN-RESP.
  8206     MOVE '1'                    TO ERBILL-REC-TYPE.
  8207     MOVE ZEROS                  TO ERBILL-LINE-SEQ-NO.
  8208
  8209
  8210* EXEC CICS HANDLE CONDITION
  8211*        NOTFND  (3930-BILL-NOTFND)
  8212*        NOTOPEN (3930-BILL-NOTOPEN)
  8213*    END-EXEC.
  8214*    MOVE '"$IJ                  ! $ #00008053' TO DFHEIV0
  8215     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8216     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8217     MOVE X'2420233030303038303533' TO DFHEIV0(25:11)
  8218     CALL 'kxdfhei1' USING DFHEIV0
  8219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8220
  8221
  8222
  8223* EXEC CICS READ
  8224*        SET     (ADDRESS OF BILLING-STATEMENT)
  8225*        DATASET (ERBILL-FILE-ID)
  8226*        RIDFLD  (ERBILL-KEY)
  8227*        GTEQ
  8228*    END-EXEC.
  8229*    MOVE '&"S        G          (   #00008058' TO DFHEIV0
  8230     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8231     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8232     MOVE X'2020233030303038303538' TO DFHEIV0(25:11)
  8233     CALL 'kxdfhei1' USING DFHEIV0,
  8234           ERBILL-FILE-ID,
  8235           DFHEIV20,
  8236           DFHEIV99,
  8237           ERBILL-KEY,
  8238           DFHEIV99,
  8239           DFHEIV99,
  8240           DFHEIV99
  8241     SET ADDRESS OF BILLING-STATEMENT TO
  8242         DFHEIV20
  8243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8244
  8245
  8246     IF BI-COMPANY-CD = PI-COMPANY-CD  AND
  8247        BI-CARRIER    = ERBILL-CARRIER AND
  8248        BI-GROUPING   = ERBILL-GROUP   AND
  8249        BI-ACCOUNT    = ERBILL-ACCT    AND
  8250        BI-FIN-RESP   = ERBILL-FIN-RESP
  8251          MOVE SPACE              TO NO-BILL-REC-SW
  8252          GO TO 3930-EXIT
  8253      ELSE
  8254          GO TO 3930-BILL-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 161
* EL640.cbl
  8255
  8256 3930-BILL-NOTOPEN.
  8257     MOVE ER-2564                TO EMI-ERROR.
  8258     MOVE -1 TO APFNTERL.
  8259     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8260     GO TO 8200-SEND-DATAONLY.
  8261
  8262 3930-BILL-NOTFND.
  8263     MOVE 'Y'                    TO NO-BILL-REC-SW.
  8264
  8265 3930-EXIT.
  8266     EXIT.
  8267
  8268 3940-BILL-GENERIC-DELETE.
  8269
  8270* EXEC CICS HANDLE CONDITION
  8271*        NOTFND (3940-EXIT)
  8272*    END-EXEC.
  8273*    MOVE '"$I                   ! % #00008088' TO DFHEIV0
  8274     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8275     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8276     MOVE X'2520233030303038303838' TO DFHEIV0(25:11)
  8277     CALL 'kxdfhei1' USING DFHEIV0
  8278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8279
  8280
  8281     MOVE PI-COMPANY-CD          TO ERBILL-CO-CD.
  8282     MOVE PI-CR-CARRIER          TO ERBILL-CARRIER.
  8283     MOVE PI-CR-GROUPING         TO ERBILL-GROUP.
  8284     MOVE PI-SAV-ACCT            TO ERBILL-ACCT.
  8285
  8286     IF ST-ACCNT-CNTL OR ACCNT-CNTL
  8287        MOVE ZEROS               TO ERBILL-CARRIER
  8288                                    ERBILL-GROUP.
  8289
  8290     IF CARR-ST-ACCNT-CNTL OR CARR-ACCNT-CNTL
  8291        MOVE ZEROS               TO ERBILL-GROUP.
  8292
  8293
  8294* EXEC CICS DELETE
  8295*        DATASET   (ERBILL-FILE-ID)
  8296*        RIDFLD    (ERBILL-KEY)
  8297*        KEYLENGTH (18)
  8298*        GENERIC
  8299*    END-EXEC.
  8300     MOVE 18
  8301       TO DFHEIV11
  8302*    MOVE '&(  RKG               &   #00008104' TO DFHEIV0
  8303     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  8304     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8305     MOVE X'2020233030303038313034' TO DFHEIV0(25:11)
  8306     CALL 'kxdfhei1' USING DFHEIV0,
  8307           ERBILL-FILE-ID,
  8308           ERBILL-KEY,
  8309           DFHEIV11,
  8310           DFHEIV99,
  8311           DFHEIV99
  8312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 162
* EL640.cbl
  8313
  8314
  8315 3940-EXIT.
  8316     EXIT.
  8317
  8318 3990-EXIT.
  8319     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 163
* EL640.cbl
  8321******************************************************************
  8322*                                                                *
  8323*   ALL I/O FOR THE VARIOUS FILES OTHER THAN THE COMPENSATION    *
  8324*   MASTER IS DONE IN THE FOLLOWING SECTIONS BEGINNING WITH 4XXX *
  8325*   WERE THE XXX INDICATES NUMERIC VALUES.                       *
  8326*                                                                *
  8327******************************************************************
  8328 4000-PNDB-START-BROWSE.
  8329     MOVE PI-COMPANY-CD          TO ERPNDB-CO-CD-A1.
  8330     MOVE PI-SAV-CARR            TO ERPNDB-CARR
  8331     MOVE PI-SAV-GROUP           TO ERPNDB-GROUP.
  8332     MOVE PI-SAV-STATE           TO ERPNDB-STATE.
  8333     MOVE PI-SAV-ACCT            TO ERPNDB-ACCT.
  8334     MOVE LOW-VALUES             TO ERPNDB-CERT.
  8335
  8336
  8337* EXEC CICS HANDLE CONDITION
  8338*        NOTFND (4010-REC-NOT-FND)
  8339*    END-EXEC.
  8340*    MOVE '"$I                   ! & #00008132' TO DFHEIV0
  8341     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8342     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8343     MOVE X'2620233030303038313332' TO DFHEIV0(25:11)
  8344     CALL 'kxdfhei1' USING DFHEIV0
  8345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8346
  8347
  8348
  8349* EXEC CICS STARTBR
  8350*        DATASET(ERPNDB-ALT-FILE-ID)
  8351*        RIDFLD (ERPNDB-ALT-KEY)
  8352*        GTEQ
  8353*    END-EXEC.
  8354     MOVE 0
  8355       TO DFHEIV11
  8356*    MOVE '&,         G          &   #00008136' TO DFHEIV0
  8357     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8358     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8359     MOVE X'2020233030303038313336' TO DFHEIV0(25:11)
  8360     CALL 'kxdfhei1' USING DFHEIV0,
  8361           ERPNDB-ALT-FILE-ID,
  8362           ERPNDB-ALT-KEY,
  8363           DFHEIV99,
  8364           DFHEIV11,
  8365           DFHEIV99
  8366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8367
  8368
  8369     GO TO 4090-EXIT.
  8370
  8371 4010-REC-NOT-FND.
  8372     MOVE 'Y'                    TO PNDB-EOF-SW.
  8373
  8374 4090-EXIT.
  8375     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 164
* EL640.cbl
  8377 4100-PNDB-READ-NEXT.
  8378
  8379* EXEC CICS HANDLE CONDITION
  8380*        ENDFILE (4110-END-OF-FILE)
  8381*    END-EXEC.
  8382*    MOVE '"$''                   ! '' #00008151' TO DFHEIV0
  8383     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8384     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8385     MOVE X'2720233030303038313531' TO DFHEIV0(25:11)
  8386     CALL 'kxdfhei1' USING DFHEIV0
  8387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8388
  8389
  8390
  8391* EXEC CICS READNEXT
  8392*        SET     (ADDRESS OF PENDING-BUSINESS)
  8393*        DATASET (ERPNDB-ALT-FILE-ID)
  8394*        RIDFLD  (ERPNDB-ALT-KEY)
  8395*    END-EXEC.
  8396     MOVE 0
  8397       TO DFHEIV11
  8398*    MOVE '&.S                   )   #00008155' TO DFHEIV0
  8399     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8400     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8401     MOVE X'2020233030303038313535' TO DFHEIV0(25:11)
  8402     CALL 'kxdfhei1' USING DFHEIV0,
  8403           ERPNDB-ALT-FILE-ID,
  8404           DFHEIV20,
  8405           DFHEIV99,
  8406           ERPNDB-ALT-KEY,
  8407           DFHEIV99,
  8408           DFHEIV11,
  8409           DFHEIV99,
  8410           DFHEIV99
  8411     SET ADDRESS OF PENDING-BUSINESS TO
  8412         DFHEIV20
  8413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8414
  8415
  8416     GO TO 4190-EXIT.
  8417
  8418 4110-END-OF-FILE.
  8419     MOVE 'Y'                    TO PNDB-EOF-SW.
  8420
  8421 4190-EXIT.
  8422     EXIT.
  8423
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 165
* EL640.cbl
  8425 4200-PNDB-REWRITE.
  8426     MOVE PB-COMPANY-CD          TO ERPNDB-CO-CD.
  8427     MOVE PB-ENTRY-BATCH         TO ERPNDB-BATCH.
  8428     MOVE PB-BATCH-SEQ-NO        TO ERPNDB-SEQ-NO.
  8429     MOVE PB-BATCH-CHG-SEQ-NO    TO ERPNDB-CHG-SEQ-NO.
  8430
  8431
  8432* EXEC CICS ENDBR
  8433*        DATASET (ERPNDB-ALT-FILE-ID)
  8434*    END-EXEC.
  8435     MOVE 0
  8436       TO DFHEIV11
  8437*    MOVE '&2                    $   #00008176' TO DFHEIV0
  8438     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8439     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8440     MOVE X'2020233030303038313736' TO DFHEIV0(25:11)
  8441     CALL 'kxdfhei1' USING DFHEIV0,
  8442           ERPNDB-ALT-FILE-ID,
  8443           DFHEIV11,
  8444           DFHEIV99
  8445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8446
  8447
  8448
  8449* EXEC CICS HANDLE CONDITION
  8450*        NOTFND   (4270-PNDB-NOTFIND)
  8451*        NOTOPEN  (4280-PNDB-FILE-NOTOPEN)
  8452*    END-EXEC.
  8453*    MOVE '"$IJ                  ! ( #00008180' TO DFHEIV0
  8454     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8455     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8456     MOVE X'2820233030303038313830' TO DFHEIV0(25:11)
  8457     CALL 'kxdfhei1' USING DFHEIV0
  8458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8459
  8460
  8461
  8462* EXEC CICS READ
  8463*        SET     (ADDRESS OF PENDING-BUSINESS)
  8464*        DATASET (ERPNDB-FILE-ID)
  8465*        RIDFLD  (ERPNDB-PRIME-KEY)
  8466*        UPDATE
  8467*    END-EXEC.
  8468*    MOVE '&"S        EU         (   #00008185' TO DFHEIV0
  8469     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8470     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8471     MOVE X'2020233030303038313835' TO DFHEIV0(25:11)
  8472     CALL 'kxdfhei1' USING DFHEIV0,
  8473           ERPNDB-FILE-ID,
  8474           DFHEIV20,
  8475           DFHEIV99,
  8476           ERPNDB-PRIME-KEY,
  8477           DFHEIV99,
  8478           DFHEIV99,
  8479           DFHEIV99
  8480     SET ADDRESS OF PENDING-BUSINESS TO
  8481         DFHEIV20
  8482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 166
* EL640.cbl
  8483
  8484
  8485     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  8486         MOVE 'R'                TO PB-BILLING-STATUS.
  8487
  8488     IF PI-VOID-BILL
  8489         MOVE LOW-VALUES         TO PB-BILLED-DT
  8490         MOVE ZEROS              TO PB-CHG-COUNT
  8491     ELSE
  8492         MOVE WS-CURRENT-DATE    TO PB-BILLED-DT.
  8493
  8494     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
  8495     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  8496     MOVE WS-CURRENT-DATE        TO PB-LAST-MAINT-DT.
  8497
  8498
  8499* EXEC CICS REWRITE
  8500*        DATASET (ERPNDB-FILE-ID)
  8501*        FROM    (PENDING-BUSINESS)
  8502*    END-EXEC.
  8503     MOVE LENGTH OF
  8504      PENDING-BUSINESS
  8505       TO DFHEIV11
  8506*    MOVE '&& L                  %   #00008205' TO DFHEIV0
  8507     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8508     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8509     MOVE X'2020233030303038323035' TO DFHEIV0(25:11)
  8510     CALL 'kxdfhei1' USING DFHEIV0,
  8511           ERPNDB-FILE-ID,
  8512           PENDING-BUSINESS,
  8513           DFHEIV11,
  8514           DFHEIV99
  8515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8516
  8517
  8518
  8519* EXEC CICS STARTBR
  8520*        DATASET (ERPNDB-ALT-FILE-ID)
  8521*        RIDFLD  (ERPNDB-ALT-KEY)
  8522*        GTEQ
  8523*    END-EXEC.
  8524     MOVE 0
  8525       TO DFHEIV11
  8526*    MOVE '&,         G          &   #00008210' TO DFHEIV0
  8527     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8528     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8529     MOVE X'2020233030303038323130' TO DFHEIV0(25:11)
  8530     CALL 'kxdfhei1' USING DFHEIV0,
  8531           ERPNDB-ALT-FILE-ID,
  8532           ERPNDB-ALT-KEY,
  8533           DFHEIV99,
  8534           DFHEIV11,
  8535           DFHEIV99
  8536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8537
  8538
  8539     PERFORM 4100-PNDB-READ-NEXT THRU 4190-EXIT.
  8540
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 167
* EL640.cbl
  8541     GO TO 4290-EXIT.
  8542
  8543 4270-PNDB-NOTFIND.
  8544     MOVE ER-2212                TO EMI-ERROR.
  8545     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8546     GO TO 4290-EXIT.
  8547
  8548 4280-PNDB-FILE-NOTOPEN.
  8549     MOVE -1                     TO ACARIERL.
  8550     MOVE ER-2210                TO EMI-ERROR.
  8551     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8552
  8553 4290-EXIT.
  8554     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 168
* EL640.cbl
  8556 4300-READ-ACCOUNT-MASTER.
  8557     MOVE PI-COMPANY-CD          TO ERACCT-A-CO-CD.
  8558     MOVE PI-SAV-CARR            TO ERACCT-A-CARRIER.
  8559     MOVE PI-SAV-GROUP           TO ERACCT-A-GROUPING.
  8560     MOVE PI-SAV-STATE           TO ERACCT-A-STATE.
  8561     MOVE PI-SAV-ACCT            TO ERACCT-A-ACCOUNT.
  8562     MOVE PI-SAV-EXP-DT          TO ERACCT-A-EXP-DATE.
  8563
  8564     MOVE SPACES                 TO WS-AM-ZIP.
  8565
  8566
  8567* EXEC CICS HANDLE CONDITION
  8568*        NOTFND   (4370-ACCOUNT-INVALID)
  8569*        NOTOPEN  (4380-ACCT-FILE-NOTOPEN)
  8570*    END-EXEC.
  8571*    MOVE '"$IJ                  ! ) #00008243' TO DFHEIV0
  8572     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8573     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8574     MOVE X'2920233030303038323433' TO DFHEIV0(25:11)
  8575     CALL 'kxdfhei1' USING DFHEIV0
  8576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8577
  8578
  8579
  8580* EXEC CICS READ
  8581*        DATASET   (ERACCT-ALT-FILE-ID)
  8582*        SET       (ADDRESS OF ACCOUNT-MASTER)
  8583*        RIDFLD    (ERACCT-ALT-KEY)
  8584*        GTEQ
  8585*    END-EXEC.
  8586*    MOVE '&"S        G          (   #00008248' TO DFHEIV0
  8587     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8588     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8589     MOVE X'2020233030303038323438' TO DFHEIV0(25:11)
  8590     CALL 'kxdfhei1' USING DFHEIV0,
  8591           ERACCT-ALT-FILE-ID,
  8592           DFHEIV20,
  8593           DFHEIV99,
  8594           ERACCT-ALT-KEY,
  8595           DFHEIV99,
  8596           DFHEIV99,
  8597           DFHEIV99
  8598     SET ADDRESS OF ACCOUNT-MASTER TO
  8599         DFHEIV20
  8600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8601
  8602
  8603     IF AM-CANADIAN-POST-CODE
  8604         MOVE AM-CAN-POSTAL-1    TO WS-AM-CAN-POST-1
  8605         MOVE AM-CAN-POSTAL-2    TO WS-AM-CAN-POST-2
  8606     ELSE
  8607         MOVE AM-ZIP-PRIME       TO WS-AM-ZIP-PRIME
  8608         IF AM-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  8609             MOVE '-'            TO WS-AM-ZIP-DASH
  8610             MOVE AM-ZIP-PLUS4   TO WS-AM-ZIP-PLUS4.
  8611
  8612     IF AM-REMIT-TO NOT NUMERIC
  8613         MOVE +00 TO AM-REMIT-TO.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 169
* EL640.cbl
  8614
  8615     IF AM-REMIT-TO = ZEROS
  8616         MOVE ER-2385            TO EMI-ERROR
  8617         MOVE -1                 TO AACCTL
  8618         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8619
  8620     MOVE AM-CARRIER             TO PI-CARRIER.
  8621     MOVE AM-GROUPING            TO PI-GROUPING.
  8622     MOVE AM-STATE               TO PI-STATE.
  8623     MOVE AM-ACCOUNT             TO PI-ACCOUNT.
  8624
  8625     MOVE AM-AGT (AM-REMIT-TO)   TO PI-COMP-FIN-RESP.
  8626
  8627     IF PI-ZERO-CARRIER  OR
  8628        PI-ZERO-CAR-GROUP
  8629         MOVE ZEROS              TO PI-COMP-CARRIER
  8630     ELSE
  8631         MOVE AM-CARRIER         TO PI-COMP-CARRIER.
  8632
  8633     IF PI-ZERO-GROUPING  OR
  8634        PI-ZERO-CAR-GROUP
  8635         MOVE ZEROS              TO PI-COMP-GROUPING
  8636     ELSE
  8637         MOVE AM-GROUPING        TO PI-COMP-GROUPING.
  8638
  8639     IF CARR-GROUP-ST-ACCNT-CNTL
  8640         MOVE AM-CARRIER         TO PI-CR-CARRIER
  8641         MOVE AM-GROUPING        TO PI-CR-GROUPING
  8642         MOVE AM-STATE           TO PI-CR-STATE.
  8643
  8644     IF ST-ACCNT-CNTL
  8645         MOVE ZEROS              TO PI-CR-CARRIER
  8646                                    PI-CR-GROUPING
  8647         MOVE AM-STATE           TO PI-CR-STATE.
  8648
  8649     IF CARR-ST-ACCNT-CNTL
  8650         MOVE AM-CARRIER         TO PI-CR-CARRIER
  8651         MOVE ZEROS              TO PI-CR-GROUPING
  8652         MOVE AM-STATE           TO PI-CR-STATE.
  8653
  8654     IF ACCNT-CNTL
  8655         MOVE ZEROS              TO PI-CR-CARRIER
  8656                                    PI-CR-GROUPING
  8657                                    PI-CR-STATE.
  8658
  8659     IF CARR-ACCNT-CNTL
  8660         MOVE AM-CARRIER         TO PI-CR-CARRIER
  8661         MOVE ZEROS              TO PI-CR-GROUPING
  8662                                    PI-CR-STATE.
  8663
  8664     MOVE AM-EXPIRATION-DT       TO ERACCT-A-EXP-DATE.
  8665
  8666     IF AM-AGT (AM-REMIT-TO) = PI-SAV-ACCT
  8667         MOVE 'Y'                TO ACCOUNT-FIN-RESP-SW
  8668     ELSE
  8669         MOVE 'N'                TO ACCOUNT-FIN-RESP-SW.
  8670
  8671     IF PI-VOID-BILL
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 170
* EL640.cbl
  8672         MOVE AM-EXPIRATION-DT   TO WS-SAV-EXP-DT (DTNDX)
  8673         IF DTNDX < 10
  8674             SET DTNDX UP BY 1
  8675             GO TO 4390-EXIT
  8676         ELSE
  8677             GO TO 4390-EXIT.
  8678
  8679     IF PI-COMPANY-CD = AM-COMPANY-CD-A1 AND
  8680        PI-SAV-CARR   = AM-VG-CARRIER    AND
  8681        PI-SAV-GROUP  = AM-VG-GROUPING   AND
  8682        PI-SAV-STATE  = AM-VG-STATE      AND
  8683        PI-SAV-ACCT   = AM-VG-ACCOUNT
  8684          NEXT SENTENCE
  8685     ELSE
  8686          GO TO 4370-ACCOUNT-INVALID.
  8687
  8688     IF PI-GA-BILLING
  8689         NEXT SENTENCE
  8690     ELSE
  8691         GO TO 4390-EXIT.
  8692
  8693     IF AM-AGT (AM-REMIT-TO) = PI-SAV-ACCT
  8694         MOVE 'Y'                TO ACCOUNT-FIN-RESP-SW
  8695     ELSE
  8696         MOVE 'N'                TO ACCOUNT-FIN-RESP-SW.
  8697
  8698     GO TO 4390-EXIT.
  8699
  8700 4370-ACCOUNT-INVALID.
  8701     MOVE -1                     TO AACCTL.
  8702
  8703     MOVE SPACES                 TO PI-CARRIER
  8704                                    PI-GROUPING
  8705                                    PI-STATE
  8706                                    PI-ACCOUNT.
  8707
  8708     IF CARR-GROUP-ST-ACCNT-CNTL
  8709         MOVE AL-UABON           TO ACARIERA
  8710                                    AGROUPA
  8711                                    ASTATEA
  8712                                    AACCTA
  8713     ELSE
  8714         IF ST-ACCNT-CNTL
  8715             MOVE AL-UABON       TO ASTATEA
  8716                                    AACCTA
  8717         ELSE
  8718             IF CARR-ST-ACCNT-CNTL
  8719                 MOVE AL-UABON   TO ACARIERA
  8720                                    ASTATEA
  8721                                    AACCTA
  8722             ELSE
  8723                 IF ACCNT-CNTL
  8724                     MOVE AL-UABON
  8725                                 TO AACCTA
  8726                 ELSE
  8727                     MOVE AL-UABON
  8728                                 TO ACARIERA
  8729                                    AACCTA.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 171
* EL640.cbl
  8730
  8731     MOVE ER-2210                TO EMI-ERROR.
  8732     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8733     GO TO 4390-EXIT.
  8734
  8735 4380-ACCT-FILE-NOTOPEN.
  8736     MOVE -1                     TO ACARIERL.
  8737     MOVE ER-2215                TO EMI-ERROR.
  8738     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8739
  8740 4390-EXIT.
  8741     EXIT.
  8742
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 172
* EL640.cbl
  8744 4400-ERACCT-REWRITE.
  8745     IF NOT PI-VOID-BILL
  8746         MOVE LOW-VALUES         TO ERACCT-PRIME-KEY
  8747         MOVE AM-COMPANY-CD      TO ERACCT-P-CO-CD
  8748         MOVE AM-CARRIER         TO ERACCT-P-CARRIER
  8749         MOVE AM-GROUPING        TO ERACCT-P-GROUPING
  8750         MOVE AM-STATE           TO ERACCT-P-STATE
  8751         MOVE AM-ACCOUNT         TO ERACCT-P-ACCOUNT
  8752         MOVE AM-EXPIRATION-DT   TO ERACCT-P-EXP-DATE
  8753     ELSE
  8754         MOVE LOW-VALUES         TO ERACCT-PRIME-KEY
  8755         MOVE PI-COMPANY-CD      TO ERACCT-P-CO-CD
  8756         MOVE PI-CARRIER         TO ERACCT-P-CARRIER
  8757         MOVE PI-GROUPING        TO ERACCT-P-GROUPING
  8758         MOVE PI-STATE           TO ERACCT-P-STATE
  8759         MOVE PI-SAV-ACCT        TO ERACCT-P-ACCOUNT
  8760         MOVE PI-SAV-EXP-DT      TO ERACCT-P-EXP-DATE.
  8761
  8762
  8763* EXEC CICS HANDLE CONDITION
  8764*        NOTFND   (4470-ACCOUNT-INVALID)
  8765*        NOTOPEN  (4480-ACCT-FILE-NOTOPEN)
  8766*    END-EXEC.
  8767*    MOVE '"$IJ                  ! * #00008414' TO DFHEIV0
  8768     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8769     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8770     MOVE X'2A20233030303038343134' TO DFHEIV0(25:11)
  8771     CALL 'kxdfhei1' USING DFHEIV0
  8772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8773
  8774
  8775
  8776* EXEC CICS READ
  8777*        DATASET   (ERACCT-FILE-ID)
  8778*        SET       (ADDRESS OF ACCOUNT-MASTER)
  8779*        RIDFLD    (ERACCT-PRIME-KEY)
  8780*        UPDATE
  8781*    END-EXEC.
  8782*    MOVE '&"S        EU         (   #00008419' TO DFHEIV0
  8783     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8784     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8785     MOVE X'2020233030303038343139' TO DFHEIV0(25:11)
  8786     CALL 'kxdfhei1' USING DFHEIV0,
  8787           ERACCT-FILE-ID,
  8788           DFHEIV20,
  8789           DFHEIV99,
  8790           ERACCT-PRIME-KEY,
  8791           DFHEIV99,
  8792           DFHEIV99,
  8793           DFHEIV99
  8794     SET ADDRESS OF ACCOUNT-MASTER TO
  8795         DFHEIV20
  8796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8797
  8798
  8799     IF PI-VOID-BILL
  8800         MOVE AM-AGT (AM-REMIT-TO) TO PI-SAV-REMIT-TO.
  8801
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 173
* EL640.cbl
  8802     IF PI-VOID-BILL
  8803         MOVE SPACE              TO AM-BILLING-STATUS
  8804     ELSE
  8805         MOVE 'B'                TO AM-BILLING-STATUS.
  8806
  8807     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  8808     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  8809     MOVE WS-CURRENT-DATE        TO AM-LAST-MAINT-DT.
  8810
  8811
  8812* EXEC CICS REWRITE
  8813*        DATASET (ERACCT-FILE-ID)
  8814*        FROM    (ACCOUNT-MASTER)
  8815*    END-EXEC.
  8816     MOVE LENGTH OF
  8817      ACCOUNT-MASTER
  8818       TO DFHEIV11
  8819*    MOVE '&& L                  %   #00008438' TO DFHEIV0
  8820     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8821     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8822     MOVE X'2020233030303038343338' TO DFHEIV0(25:11)
  8823     CALL 'kxdfhei1' USING DFHEIV0,
  8824           ERACCT-FILE-ID,
  8825           ACCOUNT-MASTER,
  8826           DFHEIV11,
  8827           DFHEIV99
  8828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8829
  8830
  8831     GO TO 4490-EXIT.
  8832
  8833 4470-ACCOUNT-INVALID.
  8834     MOVE -1                     TO AACCTL.
  8835
  8836     MOVE SPACES                 TO PI-CARRIER
  8837                                    PI-GROUPING
  8838                                    PI-STATE
  8839                                    PI-ACCOUNT.
  8840
  8841     IF CARR-GROUP-ST-ACCNT-CNTL
  8842         MOVE AL-UABON           TO ACARIERA
  8843                                    AGROUPA
  8844                                    ASTATEA
  8845                                    AACCTA
  8846     ELSE
  8847         IF ST-ACCNT-CNTL
  8848             MOVE AL-UABON       TO ASTATEA
  8849                                    AACCTA
  8850         ELSE
  8851             IF CARR-ST-ACCNT-CNTL
  8852                 MOVE AL-UABON   TO ACARIERA
  8853                                    ASTATEA
  8854                                    AACCTA
  8855             ELSE
  8856                 IF ACCNT-CNTL
  8857                     MOVE AL-UABON
  8858                                 TO AACCTA
  8859                 ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 174
* EL640.cbl
  8860                     MOVE AL-UABON
  8861                                 TO ACARIERA
  8862                                    AACCTA.
  8863
  8864     MOVE ER-2210                TO EMI-ERROR.
  8865     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8866     GO TO 4490-EXIT.
  8867
  8868 4480-ACCT-FILE-NOTOPEN.
  8869     MOVE -1                     TO ACARIERL.
  8870     MOVE ER-2215                TO EMI-ERROR.
  8871     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8872
  8873 4490-EXIT.
  8874     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 175
* EL640.cbl
  8876
  8877 4500-PYAJ-START-BROWSE.
  8878     MOVE PI-COMPANY-CD          TO ERPYAJ-COMP-CD.
  8879
  8880     IF NOT PI-ZERO-CARRIER  AND
  8881        NOT PI-ZERO-CAR-GROUP
  8882         MOVE PI-COMP-CARRIER    TO ERPYAJ-CARRIER
  8883     ELSE
  8884         MOVE ZEROS              TO ERPYAJ-CARRIER.
  8885
  8886     IF NOT PI-ZERO-GROUPING  AND
  8887        NOT PI-ZERO-CAR-GROUP
  8888         MOVE PI-COMP-GROUPING   TO ERPYAJ-GROUPING
  8889     ELSE
  8890         MOVE ZEROS              TO ERPYAJ-GROUPING.
  8891
  8892     MOVE PI-SAV-REMIT-TO        TO ERPYAJ-FIN-RESP.
  8893     MOVE PI-SAV-ACCT            TO ERPYAJ-ACCOUNT.
  8894
  8895     IF PI-SAV-REMIT-TO = SPACES
  8896         MOVE PI-SAV-ACCT        TO PI-SAV-REMIT-TO
  8897                                    ERPYAJ-FIN-RESP.
  8898
  8899     MOVE LOW-VALUES             TO ERPYAJ-RECORD-TYPE.
  8900     MOVE ERPYAJ-KEY             TO ERPYAJ-BROWSE-COMP-KEY.
  8901
  8902
  8903* EXEC CICS HANDLE CONDITION
  8904*        NOTFND (4510-REC-NOT-FND)
  8905*    END-EXEC.
  8906*    MOVE '"$I                   ! + #00008514' TO DFHEIV0
  8907     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8908     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8909     MOVE X'2B20233030303038353134' TO DFHEIV0(25:11)
  8910     CALL 'kxdfhei1' USING DFHEIV0
  8911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8912
  8913
  8914
  8915* EXEC CICS STARTBR
  8916*        DATASET(ERPYAJ-FILE-ID)
  8917*        RIDFLD (ERPYAJ-KEY)
  8918*        GTEQ
  8919*    END-EXEC.
  8920     MOVE 0
  8921       TO DFHEIV11
  8922*    MOVE '&,         G          &   #00008518' TO DFHEIV0
  8923     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8924     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8925     MOVE X'2020233030303038353138' TO DFHEIV0(25:11)
  8926     CALL 'kxdfhei1' USING DFHEIV0,
  8927           ERPYAJ-FILE-ID,
  8928           ERPYAJ-KEY,
  8929           DFHEIV99,
  8930           DFHEIV11,
  8931           DFHEIV99
  8932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8933
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 176
* EL640.cbl
  8934
  8935     GO TO 4590-EXIT.
  8936
  8937 4510-REC-NOT-FND.
  8938     MOVE 'Y'                    TO PYAJ-EOF-SW.
  8939
  8940 4590-EXIT.
  8941     EXIT.
  8942
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 177
* EL640.cbl
  8944 4600-PYAJ-READ-NEXT.
  8945
  8946* EXEC CICS HANDLE CONDITION
  8947*        ENDFILE (4610-END-OF-FILE)
  8948*    END-EXEC.
  8949*    MOVE '"$''                   ! , #00008534' TO DFHEIV0
  8950     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8951     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8952     MOVE X'2C20233030303038353334' TO DFHEIV0(25:11)
  8953     CALL 'kxdfhei1' USING DFHEIV0
  8954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8955
  8956
  8957
  8958* EXEC CICS READNEXT
  8959*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  8960*        DATASET (ERPYAJ-FILE-ID)
  8961*        RIDFLD  (ERPYAJ-KEY)
  8962*    END-EXEC.
  8963     MOVE 0
  8964       TO DFHEIV11
  8965*    MOVE '&.S                   )   #00008538' TO DFHEIV0
  8966     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8967     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8968     MOVE X'2020233030303038353338' TO DFHEIV0(25:11)
  8969     CALL 'kxdfhei1' USING DFHEIV0,
  8970           ERPYAJ-FILE-ID,
  8971           DFHEIV20,
  8972           DFHEIV99,
  8973           ERPYAJ-KEY,
  8974           DFHEIV99,
  8975           DFHEIV11,
  8976           DFHEIV99,
  8977           DFHEIV99
  8978     SET ADDRESS OF PENDING-PAY-ADJ TO
  8979         DFHEIV20
  8980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8981
  8982
  8983     GO TO 4690-EXIT.
  8984
  8985 4610-END-OF-FILE.
  8986     MOVE 'Y'                    TO PYAJ-EOF-SW.
  8987
  8988 4690-EXIT.
  8989     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 178
* EL640.cbl
  8991 4700-PYAJ-REWRITE.
  8992
  8993* EXEC CICS READ
  8994*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  8995*        DATASET (ERPYAJ-FILE-ID)
  8996*        RIDFLD  (ERPYAJ-KEY)
  8997*        UPDATE
  8998*    END-EXEC.
  8999*    MOVE '&"S        EU         (   #00008553' TO DFHEIV0
  9000     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9001     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9002     MOVE X'2020233030303038353533' TO DFHEIV0(25:11)
  9003     CALL 'kxdfhei1' USING DFHEIV0,
  9004           ERPYAJ-FILE-ID,
  9005           DFHEIV20,
  9006           DFHEIV99,
  9007           ERPYAJ-KEY,
  9008           DFHEIV99,
  9009           DFHEIV99,
  9010           DFHEIV99
  9011     SET ADDRESS OF PENDING-PAY-ADJ TO
  9012         DFHEIV20
  9013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9014
  9015
  9016     IF PI-VOID-BILL
  9017         MOVE LOW-VALUES         TO PY-BILLED-DATE
  9018                                    PY-AR-DATE
  9019         IF ACCOUNT-NOT-FIN-RESP
  9020             IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  9021                 PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  9022                 PY-ADD-TO-BALANCE
  9023                 ADD PY-ENTRY-AMT  TO  PI-REMITTED
  9024             ELSE
  9025                 IF (PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT)
  9026                    AND PY-BILLING-CHECK
  9027                    ADD PY-ENTRY-AMT TO PI-DISBURSED
  9028                 ELSE
  9029                     ADD PY-ENTRY-AMT TO PI-ADJUSTMENTS
  9030         ELSE
  9031             NEXT SENTENCE
  9032     ELSE
  9033         MOVE WS-CURRENT-DATE    TO PY-BILLED-DATE.
  9034
  9035     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  9036     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  9037     MOVE WS-CURRENT-DATE        TO PY-LAST-MAINT-DT.
  9038
  9039
  9040* EXEC CICS REWRITE
  9041*        DATASET (ERPYAJ-FILE-ID)
  9042*        FROM    (PENDING-PAY-ADJ)
  9043*    END-EXEC.
  9044     MOVE LENGTH OF
  9045      PENDING-PAY-ADJ
  9046       TO DFHEIV11
  9047*    MOVE '&& L                  %   #00008583' TO DFHEIV0
  9048     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 179
* EL640.cbl
  9049     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9050     MOVE X'2020233030303038353833' TO DFHEIV0(25:11)
  9051     CALL 'kxdfhei1' USING DFHEIV0,
  9052           ERPYAJ-FILE-ID,
  9053           PENDING-PAY-ADJ,
  9054           DFHEIV11,
  9055           DFHEIV99
  9056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9057
  9058
  9059 4790-EXIT.
  9060     EXIT.
  9061
  9062 4800-PYAJ-END-BROWSE.
  9063
  9064* EXEC CICS ENDBR
  9065*        DATASET (ERPYAJ-FILE-ID)
  9066*    END-EXEC.
  9067     MOVE 0
  9068       TO DFHEIV11
  9069*    MOVE '&2                    $   #00008592' TO DFHEIV0
  9070     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9071     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9072     MOVE X'2020233030303038353932' TO DFHEIV0(25:11)
  9073     CALL 'kxdfhei1' USING DFHEIV0,
  9074           ERPYAJ-FILE-ID,
  9075           DFHEIV11,
  9076           DFHEIV99
  9077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9078
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 180
* EL640.cbl
  9080 5000-FORMAT-SCREEN.
  9081*                **********************************************
  9082*                *  FORMAT THE BILLING TOTALS SCREEN (EL640A) *
  9083*                **********************************************
  9084     MOVE LOW-VALUES             TO EL640AO.
  9085
  9086     IF PI-SAV-ACCT > SPACES
  9087        MOVE PI-SAV-ACCT         TO AACCTO
  9088        MOVE PI-SAV-CARR         TO ACARIERO
  9089        MOVE PI-SAV-GROUP        TO AGROUPO
  9090        MOVE PI-SAV-STATE        TO ASTATEO.
  9091
  9092     MOVE PI-BILL-TYPE           TO ABILTYPI.
  9093     MOVE PI-BILL-ERRS           TO ABILERRI.
  9094     MOVE AL-UANON               TO AACCTA
  9095                                    ACARIERA
  9096                                    AGROUPA
  9097                                    ASTATEA
  9098                                    ABILTYPA
  9099                                    ABILERRA.
  9100
  9101     IF ACCOUNT-NOT-FIN-RESP
  9102         MOVE ER-2539            TO EMI-ERROR
  9103         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9104
  9105     IF PI-BILLING-BATCHES (1) NOT = SPACES
  9106         MOVE PI-BILLING-BATCHES (1) TO ABTCH1I
  9107         MOVE AL-UANON               TO ABTCH1A.
  9108
  9109     IF PI-BILLING-BATCHES (2) NOT = SPACES
  9110         MOVE PI-BILLING-BATCHES (2) TO ABTCH2I
  9111         MOVE AL-UANON               TO ABTCH2A.
  9112
  9113     IF PI-BILLING-BATCHES (3) NOT = SPACES
  9114         MOVE PI-BILLING-BATCHES (3) TO ABTCH3I
  9115         MOVE AL-UANON               TO ABTCH3A.
  9116
  9117     SET ANDX  PINDX            TO 1.
  9118
  9119 5005-FORMAT-LOOP.
  9120     IF PI-BATCH (PINDX) NOT = SPACES
  9121         MOVE PI-BATCH  (PINDX)  TO BATCH  (ANDX)
  9122         MOVE PI-NOBILL (PINDX)  TO NOBILL (ANDX)
  9123         MOVE PI-BILLED (PINDX)  TO BILL   (ANDX)
  9124         MOVE PI-PREV   (PINDX)  TO PREV   (ANDX)
  9125         SET ANDX PINDX UP BY 1
  9126         IF ANDX > 6
  9127             NEXT SENTENCE
  9128         ELSE
  9129             GO TO 5005-FORMAT-LOOP.
  9130
  9131     IF MORE-THAN-6-BATCHES
  9132         MOVE ER-2472            TO EMI-ERROR
  9133         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9134         MOVE ZEROS              TO EMI-ERROR.
  9135
  9136     IF NOT PI-DATA-BILLED
  9137         IF RETURNED-FROM NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 181
* EL640.cbl
  9138             GO TO 5080-CONT
  9139         ELSE
  9140             MOVE ER-2409        TO EMI-ERROR
  9141             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9142             GO TO 5090-EXIT.
  9143
  9144     MOVE PI-BAL-FRWD            TO ABALFWDO.
  9145     MOVE PI-PREMIUM             TO APREMUMO.
  9146     MOVE PI-REMITTED            TO AREMITO.
  9147     MOVE PI-TOT-ISS-COMP        TO ACOMPISO.
  9148     MOVE PI-TOT-CAN-COMP        TO ACOMCANO.
  9149     COMPUTE PI-ADJUSTMENTS  =   PI-ADJUSTMENTS  +
  9150                                 TOT-REPT-CANCEL-FEE.
  9151     MOVE PI-ADJUSTMENTS         TO AADJUSTO.
  9152     MOVE PI-DISBURSED           TO ADISBURO.
  9153
  9154     COMPUTE PI-END-BAL = PI-BAL-FRWD +
  9155                          PI-PREMIUM -
  9156                          PI-REMITTED -
  9157                          PI-TOT-ISS-COMP +
  9158                          PI-TOT-CAN-COMP +
  9159                          PI-ADJUSTMENTS +
  9160                          PI-DISBURSED.
  9161
  9162     MOVE PI-END-BAL             TO ANETDUEO.
  9163
  9164     IF PI-END-BAL NEGATIVE
  9165         MOVE OWED-TO-AGENT      TO AENDHDGO
  9166     ELSE
  9167         IF PI-END-BAL > ZERO
  9168             MOVE AGENT-OWES     TO AENDHDGO
  9169         ELSE
  9170             MOVE 'BALANCE          =' TO AENDHDGO.
  9171
  9172 5080-CONT.
  9173     IF RETURNED-FROM NOT = SPACES
  9174         IF (RETURNED-FROM NOT = XCTL-6401)  AND
  9175             (PI-CR-FIN-RESP NOT = SPACES)
  9176               MOVE ER-2421        TO EMI-ERROR
  9177               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9178               MOVE ZEROS          TO EMI-ERROR
  9179         ELSE
  9180             NEXT SENTENCE
  9181     ELSE
  9182         IF PI-BILL OR PI-REBILLING
  9183             MOVE 'Y'            TO COMP-UPDATE-SW
  9184             PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  9185             MOVE 'Y'            TO ELCNTL-UPDATE-SW
  9186             MOVE SPACES         TO ELCNTL-KEY
  9187             MOVE '1'            TO ELCNTL-REC-TYPE
  9188             PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT
  9189             MOVE WS-CURRENT-DATE TO CF-ACCOUNT-MSTR-MAINT-DT
  9190                                     CF-COMPENSATION-MSTR-MAINT-DT
  9191             PERFORM 6200-REWRITE-CONTROL-FILE THRU 6290-EXIT.
  9192
  9193 5090-EXIT.
  9194     EXIT.
  9195
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 182
* EL640.cbl
  9197 6000-READ-COMP-MASTER.
  9198
  9199* EXEC CICS HANDLE CONDITION
  9200*        NOTFND   (6070-NO-COMP-MSTR)
  9201*        NOTOPEN  (6080-COMP-FILE-NOTOPEN)
  9202*    END-EXEC.
  9203*    MOVE '"$IJ                  ! - #00008714' TO DFHEIV0
  9204     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9205     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9206     MOVE X'2D20233030303038373134' TO DFHEIV0(25:11)
  9207     CALL 'kxdfhei1' USING DFHEIV0
  9208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9209
  9210
  9211     MOVE PI-COMPANY-CD          TO ERCOMP-COMP-CD.
  9212     MOVE PI-COMP-CARRIER        TO ERCOMP-CARRIER
  9213     MOVE PI-COMP-GROUPING       TO ERCOMP-GROUPING
  9214     MOVE PI-COMP-FIN-RESP       TO ERCOMP-FIN-RESP.
  9215
  9216     MOVE SPACES                 TO WS-CO-ZIP.
  9217
  9218     IF EIBAID = DFHPF5
  9219         MOVE LOW-VALUES         TO ERCOMP-ACCT
  9220         MOVE 'G'                TO ERCOMP-RECORD-TYPE
  9221     ELSE
  9222         MOVE PI-SAV-ACCT        TO ERCOMP-ACCT
  9223         MOVE 'A'                TO ERCOMP-RECORD-TYPE.
  9224
  9225 6001-READ.
  9226     IF UPDATE-COMP-TOTALS OR PI-VOID-BILL
  9227
  9228* EXEC CICS READ
  9229*            DATASET   (ERCOMP-FILE-ID)
  9230*            SET       (ADDRESS OF COMPENSATION-MASTER)
  9231*            RIDFLD    (ERCOMP-KEY)
  9232*            UPDATE
  9233*        END-EXEC
  9234*    MOVE '&"S        EU         (   #00008735' TO DFHEIV0
  9235     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9236     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9237     MOVE X'2020233030303038373335' TO DFHEIV0(25:11)
  9238     CALL 'kxdfhei1' USING DFHEIV0,
  9239           ERCOMP-FILE-ID,
  9240           DFHEIV20,
  9241           DFHEIV99,
  9242           ERCOMP-KEY,
  9243           DFHEIV99,
  9244           DFHEIV99,
  9245           DFHEIV99
  9246     SET ADDRESS OF COMPENSATION-MASTER TO
  9247         DFHEIV20
  9248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9249     ELSE
  9250
  9251* EXEC CICS READ
  9252*            DATASET   (ERCOMP-FILE-ID)
  9253*            SET       (ADDRESS OF COMPENSATION-MASTER)
  9254*            RIDFLD    (ERCOMP-KEY)
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 183
* EL640.cbl
  9255*        END-EXEC.
  9256*    MOVE '&"S        E          (   #00008742' TO DFHEIV0
  9257     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9258     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9259     MOVE X'2020233030303038373432' TO DFHEIV0(25:11)
  9260     CALL 'kxdfhei1' USING DFHEIV0,
  9261           ERCOMP-FILE-ID,
  9262           DFHEIV20,
  9263           DFHEIV99,
  9264           ERCOMP-KEY,
  9265           DFHEIV99,
  9266           DFHEIV99,
  9267           DFHEIV99
  9268     SET ADDRESS OF COMPENSATION-MASTER TO
  9269         DFHEIV20
  9270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9271
  9272
  9273     IF CO-CANADIAN-POST-CODE
  9274         MOVE CO-CAN-POSTAL-1    TO WS-CO-CAN-POST-1
  9275         MOVE CO-CAN-POSTAL-2    TO WS-CO-CAN-POST-2
  9276     ELSE
  9277         MOVE CO-ZIP-PRIME       TO WS-CO-ZIP-PRIME
  9278         IF CO-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  9279             MOVE '-'            TO WS-CO-ZIP-DASH
  9280             MOVE CO-ZIP-PLUS4   TO WS-CO-ZIP-PLUS4.
  9281
  9282 6002-CONTINUE.
  9283     IF EIBAID = DFHPF5
  9284         GO TO 6090-EXIT.
  9285
  9286     IF FIRST-TIME
  9287        MOVE CO-MAIL-NAME        TO WS-ACCT-LINES (1)
  9288        MOVE CO-ACCT-NAME        TO WS-ACCT-LINES (2)
  9289        MOVE CO-ADDR-1           TO WS-ACCT-LINES (3)
  9290        MOVE CO-ADDR-2           TO WS-ACCT-LINES (4)
  9291        MOVE CO-ADDR-3           TO WS-ACCT-LINES (5)
  9292        MOVE WS-CO-ZIP           TO WS-ACCT-LINES (6)
  9293        PERFORM 6400-FORMAT-ACCOUNT-ADDRS THRU 6490-EXIT.
  9294
  9295     IF PI-VOID-BILL
  9296         MOVE  PI-ME-MONTH       TO WS-ME-MONTH
  9297         MOVE  PI-ME-DAY         TO WS-ME-DAY
  9298         MOVE  PI-ME-YEAR        TO WS-ME-YEAR
  9299         IF ACCOUNT-FIN-RESP
  9300             MOVE CO-MONTHLY-TOTALS TO CO-CURRENT-MONTHLY-TOTALS
  9301             MOVE CO-AGING-TOTALS   TO CO-CURRENT-AGING-TOTALS
  9302             MOVE CO-YTD-TOTALS     TO CO-CURRENT-YTD-TOTALS
  9303             MOVE CO-LAST-STMT-DT   TO CO-CURRENT-LAST-STMT-DT
  9304             PERFORM 6060-ERCOMP-REWRITE
  9305             GO TO 6090-EXIT
  9306         ELSE
  9307             MOVE CO-YTD-TOTALS     TO CO-CURRENT-YTD-TOTALS
  9308             MOVE CO-LAST-STMT-DT   TO CO-CURRENT-LAST-STMT-DT
  9309             PERFORM 6060-ERCOMP-REWRITE
  9310             MOVE LOW-VALUES        TO ERCOMP-ACCT
  9311             MOVE 'G'               TO ERCOMP-RECORD-TYPE
  9312             PERFORM 6001-READ
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 184
* EL640.cbl
  9313             COMPUTE CO-CURRENT-CUR-CHG =
  9314                     CO-CURRENT-CUR-CHG - PI-PREMIUM
  9315             COMPUTE CO-CURRENT-CUR-COM =
  9316                     CO-CURRENT-CUR-COM - PI-TOT-ISS-COMP -
  9317                     PI-TOT-CAN-COMP
  9318             COMPUTE CO-CURRENT-CUR-PMT =
  9319                     CO-CURRENT-CUR-PMT - PI-REMITTED +
  9320                     PI-DISBURSED + PI-ADJUSTMENTS
  9321             COMPUTE CO-CURRENT-END-BAL =
  9322                     CO-CURRENT-BAL-FWD + CO-CURRENT-CUR-CHG -
  9323                     CO-CURRENT-CUR-COM - CO-CURRENT-CUR-PMT
  9324             MOVE CO-AGING-TOTALS   TO  CO-CURRENT-AGING-TOTALS
  9325             PERFORM 6050-AGING  THRU  6059-AGING-EXIT
  9326             IF CO-CURRENT-CUR-CHG = ZEROS AND
  9327                CO-CURRENT-CUR-COM = ZEROS AND
  9328                CO-CURRENT-CUR-PMT = ZEROS
  9329                 MOVE CO-LAST-STMT-DT TO CO-CURRENT-LAST-STMT-DT
  9330                 PERFORM 6060-ERCOMP-REWRITE
  9331                 GO TO 6090-EXIT
  9332             ELSE
  9333                 PERFORM 6060-ERCOMP-REWRITE
  9334                 GO TO 6090-EXIT.
  9335
  9336     IF UPDATE-COMP-TOTALS
  9337         MOVE  PI-ME-MONTH       TO WS-ME-MONTH
  9338         MOVE  PI-ME-DAY         TO WS-ME-DAY
  9339         MOVE  PI-ME-YEAR        TO WS-ME-YEAR
  9340         IF ACCOUNT-FIN-RESP
  9341             IF NOT PI-CHECK-PRODUCED
  9342                 IF CO-CURRENT-LAST-STMT-DT = WS-MONTH-END-DATE
  9343                     MOVE CO-CURRENT-END-BAL
  9344                                 TO CO-CURRENT-BAL-FWD
  9345                     COMPUTE CO-CURRENT-CUR-COM =
  9346                             CO-CURRENT-CUR-COM +
  9347                             PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9348                     COMPUTE CO-CURRENT-YTD-COM =
  9349                             CO-CURRENT-YTD-COM +
  9350                             PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9351                     COMPUTE CO-CURRENT-CUR-CHG =
  9352                             CO-CURRENT-CUR-CHG + PI-PREMIUM
  9353                     COMPUTE CO-CURRENT-CUR-PMT =
  9354                             CO-CURRENT-CUR-PMT +
  9355                             PI-REMITTED - PI-DISBURSED -
  9356                             PI-ADJUSTMENTS
  9357                     COMPUTE CO-CURRENT-END-BAL =
  9358                             CO-CURRENT-BAL-FWD + PI-PREMIUM -
  9359                             PI-TOT-ISS-COMP + PI-TOT-CAN-COMP -
  9360                             PI-REMITTED + PI-DISBURSED +
  9361                             PI-ADJUSTMENTS
  9362                     PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9363                     PERFORM 6060-ERCOMP-REWRITE
  9364                     GO TO 6090-EXIT
  9365                ELSE
  9366                    MOVE CO-CURRENT-END-BAL TO CO-CURRENT-BAL-FWD
  9367                    MOVE PI-END-BAL         TO CO-CURRENT-END-BAL
  9368                    COMPUTE CO-CURRENT-CUR-COM =
  9369                            PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9370                    ADD CO-CURRENT-CUR-COM TO CO-CURRENT-YTD-COM
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 185
* EL640.cbl
  9371                    MOVE PI-PREMIUM        TO CO-CURRENT-CUR-CHG
  9372                    COMPUTE CO-CURRENT-CUR-PMT =
  9373                             PI-REMITTED - PI-DISBURSED -
  9374                             PI-ADJUSTMENTS
  9375                    PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9376                    MOVE WS-MONTH-END-DATE
  9377                                 TO CO-CURRENT-LAST-STMT-DT
  9378                    PERFORM 6060-ERCOMP-REWRITE
  9379                    GO TO 6090-EXIT
  9380             ELSE
  9381                 MOVE SPACE      TO PI-CHECK-SW
  9382                 MOVE PI-END-BAL TO CO-CURRENT-END-BAL
  9383                 COMPUTE CO-CURRENT-CUR-CHG = PI-PREMIUM +
  9384                         (PI-ADJUSTMENTS - PI-DISBURSED)
  9385                 PERFORM 6060-ERCOMP-REWRITE
  9386                 GO TO 6090-EXIT
  9387         ELSE
  9388             COMPUTE CO-CURRENT-YTD-COM =
  9389                     CO-CURRENT-YTD-COM + PI-TOT-ISS-COMP
  9390                                        - PI-TOT-CAN-COMP
  9391             PERFORM 6060-ERCOMP-REWRITE
  9392             MOVE LOW-VALUES    TO ERCOMP-ACCT
  9393             MOVE 'G'           TO ERCOMP-RECORD-TYPE
  9394             PERFORM 6001-READ
  9395             IF CO-CURRENT-LAST-STMT-DT = WS-MONTH-END-DATE
  9396                 MOVE CO-CURRENT-END-BAL TO CO-CURRENT-BAL-FWD
  9397                 COMPUTE CO-CURRENT-CUR-COM =
  9398                         CO-CURRENT-CUR-COM +
  9399                         PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9400                 COMPUTE CO-CURRENT-CUR-CHG =
  9401                         CO-CURRENT-CUR-CHG + PI-PREMIUM
  9402                 COMPUTE CO-CURRENT-CUR-PMT =
  9403                         CO-CURRENT-CUR-PMT +
  9404                         PI-REMITTED - PI-DISBURSED -
  9405                         PI-ADJUSTMENTS
  9406                 COMPUTE CO-CURRENT-END-BAL =
  9407                         CO-CURRENT-BAL-FWD + PI-PREMIUM -
  9408                         PI-TOT-ISS-COMP + PI-TOT-CAN-COMP -
  9409                         PI-REMITTED + PI-DISBURSED +
  9410                         PI-ADJUSTMENTS
  9411                 PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9412                 PERFORM 6060-ERCOMP-REWRITE
  9413                 GO TO 6090-EXIT
  9414             ELSE
  9415                 MOVE CO-CURRENT-END-BAL TO CO-CURRENT-BAL-FWD
  9416                 COMPUTE CO-CURRENT-CUR-COM =
  9417                         PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9418                 MOVE PI-PREMIUM         TO CO-CURRENT-CUR-CHG
  9419                 COMPUTE CO-CURRENT-CUR-PMT =
  9420                         PI-REMITTED - PI-DISBURSED -
  9421                         PI-ADJUSTMENTS
  9422                 COMPUTE CO-CURRENT-END-BAL =
  9423                         CO-CURRENT-BAL-FWD + PI-PREMIUM -
  9424                         PI-TOT-ISS-COMP + PI-TOT-CAN-COMP -
  9425                         PI-REMITTED + PI-DISBURSED +
  9426                         PI-ADJUSTMENTS
  9427                 PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9428                 MOVE WS-MONTH-END-DATE
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 186
* EL640.cbl
  9429                                      TO CO-CURRENT-LAST-STMT-DT
  9430                 PERFORM 6060-ERCOMP-REWRITE
  9431                 GO TO 6090-EXIT.
  9432
  9433     IF PI-TOT-REBILL
  9434         MOVE CO-END-BAL           TO PI-BAL-FRWD
  9435     ELSE
  9436         MOVE CO-CURRENT-END-BAL   TO PI-BAL-FRWD.
  9437
  9438     IF PI-UPDATE-FILES
  9439       OR (PI-PREVIEW AND APRODSWI = 'Y')
  9440         NEXT SENTENCE
  9441     ELSE
  9442         GO TO 6090-EXIT.
  9443
  9444     IF AM-AGT (ACCOM-SUB) = PI-SAV-REMIT-TO
  9445         PERFORM 6040-READ-COMP-MASTER THRU 6049-EXIT
  9446         IF C-RECORD-FOUND
  9447             MOVE CO-ACCT-NAME   TO WS-REMIT-LINES (1)
  9448             MOVE CO-MAIL-NAME   TO WS-REMIT-LINES (2)
  9449             MOVE CO-ADDR-1      TO WS-REMIT-LINES (3)
  9450             MOVE CO-ADDR-2      TO WS-REMIT-LINES (4)
  9451             MOVE CO-ADDR-3      TO WS-REMIT-LINES (5)
  9452             MOVE WS-CO-ZIP      TO WS-REMIT-LINES (6)
  9453             PERFORM 6300-ELIMINATE-LINE-SPACES THRU 6390-EXIT
  9454             MOVE 'CA'           TO BILLING-DETAIL-TYPE
  9455             PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT
  9456         ELSE
  9457             MOVE SPACES         TO ELCNTL-KEY
  9458             MOVE '6'            TO ELCNTL-REC-TYPE
  9459             MOVE PI-CARRIER     TO ELCNTL-CARRIER
  9460             PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT
  9461             MOVE CF-MAIL-TO-NAME   TO WS-REMIT-LINES (1)
  9462             MOVE CF-IN-CARE-OF     TO WS-REMIT-LINES (2)
  9463             MOVE CF-ADDRESS-LINE-1 TO WS-REMIT-LINES (3)
  9464             MOVE CF-ADDRESS-LINE-2 TO WS-REMIT-LINES (4)
  9465             MOVE CF-CITY-STATE     TO WS-REMIT-LINES (5)
  9466             MOVE WS-CF-ZIP         TO WS-REMIT-LINES (6)
  9467             PERFORM 6300-ELIMINATE-LINE-SPACES THRU 6390-EXIT
  9468             MOVE 'CA'              TO BILLING-DETAIL-TYPE
  9469             PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT
  9470     ELSE
  9471         MOVE LOW-VALUES         TO ERCOMP-ACCT
  9472         MOVE 'G'                TO ERCOMP-RECORD-TYPE
  9473         PERFORM 6001-READ
  9474         MOVE CO-ACCT-NAME       TO WS-REMIT-LINES (1)
  9475         MOVE CO-MAIL-NAME       TO WS-REMIT-LINES (2)
  9476         MOVE CO-ADDR-1          TO WS-REMIT-LINES (3)
  9477         MOVE CO-ADDR-2          TO WS-REMIT-LINES (4)
  9478         MOVE CO-ADDR-3          TO WS-REMIT-LINES (5)
  9479         MOVE WS-CO-ZIP          TO WS-REMIT-LINES (6)
  9480         MOVE CO-CURRENT-END-BAL TO PI-BAL-FRWD-GA
  9481         PERFORM 6300-ELIMINATE-LINE-SPACES THRU 6390-EXIT
  9482         MOVE 'GA'               TO BILLING-DETAIL-TYPE
  9483         PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  9484
  9485     GO TO 6090-EXIT.
  9486
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 187
* EL640.cbl
  9487 6070-NO-COMP-MSTR.
  9488     MOVE ER-2230                TO EMI-ERROR.
  9489     MOVE -1                     TO AACCTL.
  9490     MOVE AL-UABON               TO ACARIERA
  9491                                    AGROUPA
  9492                                    AACCTA.
  9493     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9494     GO TO 6090-EXIT.
  9495
  9496 6080-COMP-FILE-NOTOPEN.
  9497     MOVE -1                     TO APFNTERL
  9498     MOVE ER-2233                TO EMI-ERROR.
  9499     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9500
  9501 6090-EXIT.
  9502     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 188
* EL640.cbl
  9504
  9505 6040-READ-COMP-MASTER.
  9506
  9507* EXEC CICS HANDLE CONDITION
  9508*        NOTFND   (6045-NO-COMP-MSTR)
  9509*        NOTOPEN  (6045-COMP-FILE-NOTOPEN)
  9510*    END-EXEC.
  9511*    MOVE '"$IJ                  ! . #00008981' TO DFHEIV0
  9512     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9513     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9514     MOVE X'2E20233030303038393831' TO DFHEIV0(25:11)
  9515     CALL 'kxdfhei1' USING DFHEIV0
  9516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9517
  9518
  9519     MOVE 'Y'                    TO C-RECORD-FOUND-SW.
  9520     MOVE PI-COMPANY-CD          TO ERCOMP-COMP-CD.
  9521     MOVE PI-COMP-CARRIER        TO ERCOMP-CARRIER
  9522     MOVE PI-COMP-GROUPING       TO ERCOMP-GROUPING
  9523     MOVE LOW-VALUES             TO ERCOMP-FIN-RESP
  9524                                    ERCOMP-ACCT.
  9525     MOVE 'C'                    TO ERCOMP-RECORD-TYPE.
  9526
  9527     MOVE SPACES                 TO WS-CO-ZIP.
  9528
  9529
  9530* EXEC CICS READ
  9531*        DATASET   (ERCOMP-FILE-ID)
  9532*        SET       (ADDRESS OF COMPENSATION-MASTER)
  9533*        RIDFLD    (ERCOMP-KEY)
  9534*    END-EXEC.
  9535*    MOVE '&"S        E          (   #00008996' TO DFHEIV0
  9536     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9537     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9538     MOVE X'2020233030303038393936' TO DFHEIV0(25:11)
  9539     CALL 'kxdfhei1' USING DFHEIV0,
  9540           ERCOMP-FILE-ID,
  9541           DFHEIV20,
  9542           DFHEIV99,
  9543           ERCOMP-KEY,
  9544           DFHEIV99,
  9545           DFHEIV99,
  9546           DFHEIV99
  9547     SET ADDRESS OF COMPENSATION-MASTER TO
  9548         DFHEIV20
  9549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9550
  9551
  9552     IF CO-CANADIAN-POST-CODE
  9553         MOVE CO-CAN-POSTAL-1    TO WS-CO-CAN-POST-1
  9554         MOVE CO-CAN-POSTAL-2    TO WS-CO-CAN-POST-2
  9555     ELSE
  9556         MOVE CO-ZIP-PRIME       TO WS-CO-ZIP-PRIME
  9557         IF CO-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  9558             MOVE '-'            TO WS-CO-ZIP-DASH
  9559             MOVE CO-ZIP-PLUS4   TO WS-CO-ZIP-PLUS4.
  9560
  9561     GO TO 6049-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 189
* EL640.cbl
  9562
  9563 6045-COMP-FILE-NOTOPEN.
  9564     MOVE -1                     TO APFNTERL.
  9565     MOVE ER-2233                TO EMI-ERROR.
  9566     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9567
  9568     GO TO 6049-EXIT.
  9569
  9570 6045-NO-COMP-MSTR.
  9571     MOVE 'N'                    TO C-RECORD-FOUND-SW.
  9572
  9573 6049-EXIT.
  9574     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 190
* EL640.cbl
  9576
  9577 6050-AGING.
  9578
  9579     IF NOT PI-VOID-BILL
  9580        IF CO-CURRENT-LAST-STMT-DT NOT = WS-MONTH-END-DATE
  9581           if pi-company-id = 'AHL'
  9582              add co-current-ov90
  9583                                 to co-current-ov120
  9584              move co-current-ov60
  9585                                 to co-current-ov90
  9586              move co-current-ov30
  9587                                 to co-current-ov60
  9588              move co-current-cur
  9589                                 to co-current-ov30
  9590           else
  9591              ADD CO-CURRENT-OV60
  9592                                 TO CO-CURRENT-OV90
  9593              MOVE CO-CURRENT-OV30
  9594                                 TO CO-CURRENT-OV60
  9595              MOVE CO-CURRENT-CUR
  9596                                 TO CO-CURRENT-OV30
  9597           end-if
  9598        end-if
  9599     end-if
  9600
  9601     COMPUTE CO-CURRENT-CUR =
  9602             CO-CURRENT-CUR-CHG - CO-CURRENT-CUR-COM.
  9603
  9604     COMPUTE WS-PAY-ADJ =
  9605             PI-REMITTED - PI-DISBURSED - PI-ADJUSTMENTS.
  9606
  9607     IF WS-PAY-ADJ NEGATIVE
  9608         SUBTRACT WS-PAY-ADJ  FROM  CO-CURRENT-CUR
  9609     ELSE
  9610        if pi-company-id = 'AHL'
  9611           subtract ws-pay-adj from co-current-ov120
  9612        else
  9613           SUBTRACT WS-PAY-ADJ  FROM  CO-CURRENT-OV90
  9614        end-if
  9615     end-if
  9616
  9617     IF CO-CURRENT-CUR NEGATIVE
  9618        if pi-company-id = 'AHL'
  9619           add co-current-cur to co-current-ov120
  9620        else
  9621           ADD CO-CURRENT-CUR  TO  CO-CURRENT-OV90
  9622        end-if
  9623        MOVE ZEROS              TO  CO-CURRENT-CUR
  9624     end-if
  9625
  9626     if pi-company-id = 'AHL'
  9627        if co-current-ov120 negative
  9628           add co-current-ov120 to co-current-ov90
  9629           move zeros           to co-current-ov120
  9630        end-if
  9631     end-if
  9632     IF CO-CURRENT-OV90 NEGATIVE
  9633         ADD CO-CURRENT-OV90  TO  CO-CURRENT-OV60
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 191
* EL640.cbl
  9634         MOVE ZEROS              TO  CO-CURRENT-OV90.
  9635
  9636     IF CO-CURRENT-OV60 NEGATIVE
  9637         ADD CO-CURRENT-OV60  TO  CO-CURRENT-OV30
  9638         MOVE ZEROS              TO  CO-CURRENT-OV60.
  9639
  9640     IF CO-CURRENT-OV30 NEGATIVE
  9641         ADD CO-CURRENT-OV30  TO  CO-CURRENT-CUR
  9642         MOVE ZEROS              TO  CO-CURRENT-OV30.
  9643
  9644 6059-AGING-EXIT.
  9645     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 192
* EL640.cbl
  9647
  9648 6060-ERCOMP-REWRITE.
  9649
  9650
  9651* EXEC CICS REWRITE
  9652*        DATASET (ERCOMP-FILE-ID)
  9653*        FROM    (COMPENSATION-MASTER)
  9654*    END-EXEC.
  9655     MOVE LENGTH OF
  9656      COMPENSATION-MASTER
  9657       TO DFHEIV11
  9658*    MOVE '&& L                  %   #00009100' TO DFHEIV0
  9659     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9660     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9661     MOVE X'2020233030303039313030' TO DFHEIV0(25:11)
  9662     CALL 'kxdfhei1' USING DFHEIV0,
  9663           ERCOMP-FILE-ID,
  9664           COMPENSATION-MASTER,
  9665           DFHEIV11,
  9666           DFHEIV99
  9667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9668
  9669
  9670 6100-READ-CONTROL-FILE.
  9671     MOVE PI-COMPANY-ID          TO ELCNTL-COMPANY-ID.
  9672     MOVE +0                     TO ELCNTL-SEQ-NO.
  9673
  9674     MOVE SPACES                 TO WS-CF-ZIP.
  9675
  9676
  9677* EXEC CICS HANDLE CONDITION
  9678*        NOTFND   (6110-NO-RECORD)
  9679*    END-EXEC.
  9680*    MOVE '"$I                   ! / #00009111' TO DFHEIV0
  9681     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9682     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9683     MOVE X'2F20233030303039313131' TO DFHEIV0(25:11)
  9684     CALL 'kxdfhei1' USING DFHEIV0
  9685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9686
  9687
  9688     IF NOT ELCNTL-UPDATE
  9689
  9690* EXEC CICS READ
  9691*            DATASET (ELCNTL-FILE-ID)
  9692*            SET     (ADDRESS OF CONTROL-FILE)
  9693*            RIDFLD  (ELCNTL-KEY)
  9694*        END-EXEC
  9695*    MOVE '&"S        E          (   #00009116' TO DFHEIV0
  9696     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9697     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9698     MOVE X'2020233030303039313136' TO DFHEIV0(25:11)
  9699     CALL 'kxdfhei1' USING DFHEIV0,
  9700           ELCNTL-FILE-ID,
  9701           DFHEIV20,
  9702           DFHEIV99,
  9703           ELCNTL-KEY,
  9704           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 193
* EL640.cbl
  9705           DFHEIV99,
  9706           DFHEIV99
  9707     SET ADDRESS OF CONTROL-FILE TO
  9708         DFHEIV20
  9709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9710     ELSE
  9711         MOVE SPACE              TO ELCNTL-UPDATE-SW
  9712
  9713* EXEC CICS READ
  9714*            DATASET (ELCNTL-FILE-ID)
  9715*            SET     (ADDRESS OF CONTROL-FILE)
  9716*            RIDFLD  (ELCNTL-KEY)
  9717*            UPDATE
  9718*        END-EXEC.
  9719*    MOVE '&"S        EU         (   #00009123' TO DFHEIV0
  9720     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9721     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9722     MOVE X'2020233030303039313233' TO DFHEIV0(25:11)
  9723     CALL 'kxdfhei1' USING DFHEIV0,
  9724           ELCNTL-FILE-ID,
  9725           DFHEIV20,
  9726           DFHEIV99,
  9727           ELCNTL-KEY,
  9728           DFHEIV99,
  9729           DFHEIV99,
  9730           DFHEIV99
  9731     SET ADDRESS OF CONTROL-FILE TO
  9732         DFHEIV20
  9733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9734
  9735
  9736     IF CF-ZIP-CODE-NUM NOT NUMERIC
  9737         MOVE ZEROS              TO CF-ZIP-CODE-NUM.
  9738
  9739     IF CF-ZIP-CODE-NUM NOT = ZEROS
  9740         MOVE CF-ZIP-CODE-NUM    TO WORK-ZIP
  9741         IF WORK-ZIPR1-4 = ZEROS
  9742             MOVE WORK-ZIPR1-5   TO WORK-ZIPR2-5
  9743             MOVE ZEROS          TO WORK-ZIPR2-4
  9744             MOVE WORK-ZIP       TO CF-ZIP-CODE
  9745         ELSE
  9746             MOVE WORK-ZIP       TO CF-ZIP-CODE.
  9747
  9748     IF CF-CANADIAN-POST-CODE
  9749         MOVE CF-CAN-POSTAL-1    TO WS-CF-CAN-POST-1
  9750         MOVE CF-CAN-POSTAL-2    TO WS-CF-CAN-POST-2
  9751     ELSE
  9752         MOVE CF-ZIP-PRIME       TO WS-CF-ZIP-PRIME
  9753         IF CF-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  9754             MOVE '-'            TO WS-CF-ZIP-DASH
  9755             MOVE CF-ZIP-PLUS4   TO WS-CF-ZIP-PLUS4.
  9756
  9757     GO TO 6120-EXIT.
  9758
  9759 6110-NO-RECORD.
  9760     IF ELCNTL-REC-TYPE = 1
  9761         MOVE ER-0022            TO EMI-ERROR
  9762     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 194
* EL640.cbl
  9763         MOVE ER-2208            TO EMI-ERROR
  9764         MOVE -1                 TO ACARIERL
  9765         MOVE AL-UABON           TO ACARIERA
  9766         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9767
  9768 6120-EXIT.
  9769     EXIT.
  9770 6130-FIND-AH-BENEFIT-CD.
  9771
  9772* EXEC CICS READ
  9773*       DATASET (ELCNTL-FILE-ID)
  9774*       SET     (ADDRESS OF CONTROL-FILE)
  9775*       RIDFLD  (ELCNTL-KEY)
  9776*       GTEQ
  9777*       RESP    (WS-RESPONSE)
  9778*    END-EXEC
  9779*    MOVE '&"S        G          (  N#00009165' TO DFHEIV0
  9780     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9781     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9782     MOVE X'204E233030303039313635' TO DFHEIV0(25:11)
  9783     CALL 'kxdfhei1' USING DFHEIV0,
  9784           ELCNTL-FILE-ID,
  9785           DFHEIV20,
  9786           DFHEIV99,
  9787           ELCNTL-KEY,
  9788           DFHEIV99,
  9789           DFHEIV99,
  9790           DFHEIV99
  9791     SET ADDRESS OF CONTROL-FILE TO
  9792         DFHEIV20
  9793     MOVE EIBRESP  TO WS-RESPONSE
  9794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9795     IF ws-RESP-NORMAL
  9796        IF (CF-COMPANY-ID = PI-COMPANY-ID)
  9797           AND (CF-RECORD-TYPE = '5')
  9798           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  9799              (S1 > +8)
  9800              OR (CF-BENEFIT-CODE (S1) = CLAS-LOOK)
  9801           END-PERFORM
  9802           IF S1 NOT > +8
  9803              MOVE CF-BENEFIT-CATEGORY (S1)
  9804                                 TO WS-AH-CATEGORY
  9805              move cf-benefit-alpha(s1)
  9806                                 to ws-ah-alpha
  9807              move cf-benefit-descrip(s1)
  9808                                 to ws-ah-descrip
  9809              move cf-benefit-comment(s1)
  9810                                 to ws-ah-comment
  9811              move cf-special-calc-cd(s1)
  9812                                 to ws-ah-spec-calc-cd
  9813              move cf-joint-indicator(s1)
  9814                                 to ws-ah-joint-ind
  9815              GO TO 6130-EXIT
  9816           END-IF
  9817        END-IF
  9818     END-IF
  9819     MOVE ER-7285                TO EMI-ERROR
  9820     MOVE -1                     TO ACARIERL
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 195
* EL640.cbl
  9821     MOVE AL-UABON               TO ACARIERA
  9822     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  9823
  9824     .
  9825 6130-EXIT.
  9826     EXIT.
  9827 6135-FIND-LF-BENEFIT-CD.
  9828
  9829     move spaces                 to ws-lf-benefit-cd-stuff
  9830
  9831
  9832* EXEC CICS READ
  9833*       DATASET (ELCNTL-FILE-ID)
  9834*       SET     (ADDRESS OF CONTROL-FILE)
  9835*       RIDFLD  (ELCNTL-KEY)
  9836*       GTEQ
  9837*       RESP    (WS-RESPONSE)
  9838*    END-EXEC
  9839*    MOVE '&"S        G          (  N#00009208' TO DFHEIV0
  9840     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9841     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9842     MOVE X'204E233030303039323038' TO DFHEIV0(25:11)
  9843     CALL 'kxdfhei1' USING DFHEIV0,
  9844           ELCNTL-FILE-ID,
  9845           DFHEIV20,
  9846           DFHEIV99,
  9847           ELCNTL-KEY,
  9848           DFHEIV99,
  9849           DFHEIV99,
  9850           DFHEIV99
  9851     SET ADDRESS OF CONTROL-FILE TO
  9852         DFHEIV20
  9853     MOVE EIBRESP  TO WS-RESPONSE
  9854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9855
  9856     IF ws-RESP-NORMAL
  9857        IF (CF-COMPANY-ID = PI-COMPANY-ID)
  9858           AND (CF-RECORD-TYPE = '4')
  9859           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  9860              (S1 > +8)
  9861              OR (CF-BENEFIT-CODE (S1) = CLAS-LOOK)
  9862           END-PERFORM
  9863           IF S1 NOT > +8
  9864              move cf-benefit-alpha(s1)
  9865                                 to ws-lf-alpha
  9866              move cf-benefit-descrip(s1)
  9867                                 to ws-lf-descrip
  9868              move cf-benefit-comment(s1)
  9869                                 to ws-lf-comment
  9870              move cf-lf-coverage-type(s1)
  9871                                 to ws-lf-cov-type
  9872              move cf-special-calc-cd(s1)
  9873                                 to ws-lf-spec-calc-cd
  9874              move cf-joint-indicator(s1)
  9875                                 to ws-lf-joint-ind
  9876              GO TO 6135-EXIT
  9877           END-IF
  9878        END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 196
* EL640.cbl
  9879     END-IF
  9880
  9881     MOVE ER-7285                TO EMI-ERROR
  9882     MOVE -1                     TO ACARIERL
  9883     MOVE AL-UABON               TO ACARIERA
  9884     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  9885
  9886     .
  9887 6135-EXIT.
  9888     EXIT.
  9889 6200-REWRITE-CONTROL-FILE.
  9890
  9891
  9892* EXEC CICS REWRITE
  9893*        DATASET (ELCNTL-FILE-ID)
  9894*        FROM    (CONTROL-FILE)
  9895*    END-EXEC.
  9896     MOVE LENGTH OF
  9897      CONTROL-FILE
  9898       TO DFHEIV11
  9899*    MOVE '&& L                  %   #00009251' TO DFHEIV0
  9900     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9901     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9902     MOVE X'2020233030303039323531' TO DFHEIV0(25:11)
  9903     CALL 'kxdfhei1' USING DFHEIV0,
  9904           ELCNTL-FILE-ID,
  9905           CONTROL-FILE,
  9906           DFHEIV11,
  9907           DFHEIV99
  9908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9909
  9910
  9911 6290-EXIT.
  9912     EXIT.
  9913
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 197
* EL640.cbl
  9915 6300-ELIMINATE-LINE-SPACES.
  9916     IF WS-REMIT-LINES (1) = SPACES
  9917         MOVE WS-REMIT-LINES (2)  TO WS-REMIT-LINES (1)
  9918         MOVE WS-REMIT-LINES (3)  TO WS-REMIT-LINES (2)
  9919         MOVE WS-REMIT-LINES (4)  TO WS-REMIT-LINES (3)
  9920         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9921         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9922         MOVE SPACES              TO WS-REMIT-LINES (6)
  9923         GO TO 6300-ELIMINATE-LINE-SPACES.
  9924
  9925     IF WS-REMIT-LINES (2) = SPACES AND
  9926        WS-REMIT-LINES (3) = SPACES AND
  9927        WS-REMIT-LINES (4) = SPACES AND
  9928        WS-REMIT-LINES (5) = SPACES AND
  9929        WS-REMIT-LINES (6) = SPACES
  9930          GO TO 6350-MOVE-ZIP.
  9931
  9932     IF WS-REMIT-LINES (2) = SPACES
  9933         MOVE WS-REMIT-LINES (3)  TO WS-REMIT-LINES (2)
  9934         MOVE WS-REMIT-LINES (4)  TO WS-REMIT-LINES (3)
  9935         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9936         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9937         MOVE SPACES              TO WS-REMIT-LINES (6)
  9938         GO TO 6300-ELIMINATE-LINE-SPACES.
  9939
  9940     IF WS-REMIT-LINES (3) = SPACES AND
  9941        WS-REMIT-LINES (4) = SPACES AND
  9942        WS-REMIT-LINES (5) = SPACES AND
  9943        WS-REMIT-LINES (6) = SPACES
  9944          GO TO 6350-MOVE-ZIP.
  9945
  9946     IF WS-REMIT-LINES (3) = SPACES
  9947         MOVE WS-REMIT-LINES (4)  TO WS-REMIT-LINES (3)
  9948         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9949         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9950         MOVE SPACES              TO WS-REMIT-LINES (6)
  9951         GO TO 6300-ELIMINATE-LINE-SPACES.
  9952
  9953     IF WS-REMIT-LINES (4) = SPACES AND
  9954        WS-REMIT-LINES (5) = SPACES AND
  9955        WS-REMIT-LINES (6) = SPACES
  9956          GO TO 6350-MOVE-ZIP.
  9957
  9958     IF WS-REMIT-LINES (4) = SPACES
  9959         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9960         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9961         MOVE SPACES              TO WS-REMIT-LINES (6)
  9962         GO TO 6300-ELIMINATE-LINE-SPACES.
  9963
  9964     IF WS-REMIT-LINES (5) = SPACES
  9965         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9966         MOVE SPACES              TO WS-REMIT-LINES (6).
  9967
  9968 6350-MOVE-ZIP.
  9969     IF WS-REMIT-LINES (6) NOT = SPACES
  9970         MOVE WS-REMIT-ZIP (6)        TO WS-R-LAST-ZIP (5)
  9971         MOVE SPACES                  TO WS-REMIT-LINES (6)
  9972     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 198
* EL640.cbl
  9973         IF WS-REMIT-LINES (5) NOT = SPACES
  9974             MOVE WS-REMIT-ZIP (5)     TO WS-R-LAST-ZIP (5)
  9975             MOVE SPACES               TO WS-REMIT-ZIP (5)
  9976         ELSE
  9977             IF WS-REMIT-LINES (4) NOT = SPACES
  9978                 MOVE WS-REMIT-ZIP (4) TO WS-R-LAST-ZIP (4)
  9979                 MOVE SPACES           TO WS-REMIT-ZIP (4).
  9980
  9981 6390-EXIT.
  9982     EXIT.
  9983
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 199
* EL640.cbl
  9985 6400-FORMAT-ACCOUNT-ADDRS.
  9986     IF WS-ACCT-ADDR-AREA = SPACES
  9987         GO TO 6490-EXIT.
  9988
  9989     IF WS-ACCT-LINES (1) = SPACES
  9990         MOVE WS-ACCT-LINES (2)  TO WS-ACCT-LINES (1)
  9991         MOVE WS-ACCT-LINES (3)  TO WS-ACCT-LINES (2)
  9992         MOVE WS-ACCT-LINES (4)  TO WS-ACCT-LINES (3)
  9993         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9994         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9995         MOVE SPACES              TO WS-ACCT-LINES (6)
  9996         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9997
  9998     IF WS-ACCT-LINES (2) = SPACES AND
  9999        WS-ACCT-LINES (3) = SPACES AND
 10000        WS-ACCT-LINES (4) = SPACES AND
 10001        WS-ACCT-LINES (5) = SPACES AND
 10002        WS-ACCT-LINES (6) = SPACES
 10003          GO TO 6450-MOVE-ZIP.
 10004
 10005     IF WS-ACCT-LINES (2) = SPACES
 10006         MOVE WS-ACCT-LINES (3)  TO WS-ACCT-LINES (2)
 10007         MOVE WS-ACCT-LINES (4)  TO WS-ACCT-LINES (3)
 10008         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
 10009         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
 10010         MOVE SPACES             TO WS-ACCT-LINES (6)
 10011         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
 10012
 10013     IF WS-ACCT-LINES (3) = SPACES AND
 10014        WS-ACCT-LINES (4) = SPACES AND
 10015        WS-ACCT-LINES (5) = SPACES AND
 10016        WS-ACCT-LINES (6) = SPACES
 10017          GO TO 6450-MOVE-ZIP.
 10018
 10019     IF WS-ACCT-LINES (3) = SPACES
 10020         MOVE WS-ACCT-LINES (4)  TO WS-ACCT-LINES (3)
 10021         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
 10022         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
 10023         MOVE SPACES             TO WS-ACCT-LINES (6)
 10024         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
 10025
 10026     IF WS-ACCT-LINES (4) = SPACES AND
 10027        WS-ACCT-LINES (5) = SPACES AND
 10028        WS-ACCT-LINES (6) = SPACES
 10029          GO TO 6450-MOVE-ZIP.
 10030
 10031     IF WS-ACCT-LINES (4) = SPACES
 10032         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
 10033         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
 10034         MOVE SPACES             TO WS-ACCT-LINES (6)
 10035         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
 10036
 10037     IF WS-ACCT-LINES (5) = SPACES
 10038         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
 10039         MOVE SPACES             TO WS-ACCT-LINES (6).
 10040
 10041 6450-MOVE-ZIP.
 10042     IF WS-ACCT-LINES (6) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 200
* EL640.cbl
 10043         MOVE WS-ACCT-ZIP (6)         TO WS-A-LAST-ZIP (5)
 10044         MOVE SPACES                  TO WS-ACCT-LINES (6)
 10045     ELSE
 10046         IF WS-ACCT-LINES (5) NOT = SPACES
 10047             MOVE WS-ACCT-ZIP (5)      TO WS-A-LAST-ZIP (5)
 10048             MOVE SPACES               TO WS-ACCT-ZIP (5)
 10049         ELSE
 10050             IF WS-ACCT-LINES (4) NOT = SPACES
 10051                 MOVE WS-ACCT-ZIP (4)  TO WS-A-LAST-ZIP (4)
 10052                 MOVE SPACES           TO WS-ACCT-ZIP (4).
 10053
 10054 6490-EXIT.
 10055     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 201
* EL640.cbl
 10057 7000-PROCESS-CHECK.
 10058*                *******************************************
 10059*                *    FORMAT THE CHECK SCREEN (EL640D)     *
 10060*                *******************************************
 10061     MOVE LOW-VALUES             TO EL640BO.
 10062
 10063     IF PI-SAV-ACCT = PI-SAV-REMIT-TO
 10064         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
 10065         IF EMI-ERROR = ZEROS
 10066             MOVE AM-NAME        TO BNAMEO
 10067             MOVE AM-PERSON      TO BADDR1O
 10068             MOVE AM-ADDRS       TO BADDR2O
 10069*            MOVE AM-CITY        TO BCITYSTO
 10070             STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 10071                DELIMITED BY '  ' INTO BCITYSTO
 10072             END-STRING
 10073             MOVE WS-AM-ZIP      TO BZIPO
 10074         ELSE
 10075             MOVE EL640A         TO PI-MAP-NAME
 10076             MOVE -1             TO BPFNTERL
 10077             GO TO 8200-SEND-DATAONLY
 10078     ELSE
 10079         PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
 10080         IF EMI-ERROR = ZEROS
 10081             MOVE CO-ACCT-NAME   TO BNAMEO
 10082             MOVE CO-ADDR-1      TO BADDR1O
 10083             MOVE CO-ADDR-2      TO BADDR2O
 10084*            MOVE CO-ADDR-3      TO BCITYSTO
 10085             STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 10086                DELIMITED BY '  ' INTO BCITYSTO
 10087             END-STRING
 10088             MOVE WS-CO-ZIP      TO BZIPO
 10089         ELSE
 10090             MOVE EL640A         TO PI-MAP-NAME
 10091             MOVE -1             TO BPFNTERL
 10092             GO TO 8200-SEND-DATAONLY.
 10093
 10094     MOVE AL-UNNON               TO BCHKAMTA.
 10095     MOVE PI-ACCT-NAME           TO BACCNAMO.
 10096     MOVE PI-SAV-ACCT            TO BACCTO.
 10097     MOVE PI-COMP-CARRIER        TO BCARIERO.
 10098     MOVE PI-COMP-GROUPING       TO BGROUPO.
 10099     MOVE PI-SAV-STATE           TO BSTATEO.
 10100     MOVE PI-MONTH-END-DATE      TO BPAYDT2O
 10101                                    WS-BEGIN-DATE.
 10102     MOVE '01'                   TO WS-BEGIN-DAY.
 10103     MOVE WS-BEGIN-DATE          TO BPAYDT1O.
 10104     MOVE -1                     TO BCHKNOL
 10105
 10106     IF WS-ENTERED-FROM-A
 10107         COMPUTE WORK-CHECK-AMT = PI-END-BAL * -1
 10108         MOVE WORK-CHECK-AMT     TO BCHKAMTO
 10109     ELSE
 10110         MOVE WORK-CHECK-AMT     TO BCHKAMTO.
 10111
 10112     IF WORK-CHECK-AMT NOT > ZEROS
 10113         MOVE ER-3165    TO  EMI-ERROR
 10114         MOVE -1         TO  BCHKAMTL
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 202
* EL640.cbl
 10115         MOVE AL-UNBON   TO  BCHKAMTA
 10116         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10117
 10118     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 203
* EL640.cbl
 10120
 10121 7500-PRODUCE-CHECK.
 10122*                *******************************************
 10123*                *   PRODUCES A CHECK FOR LATER PRINTING   *
 10124*                *******************************************
 10125     MOVE SPACES                 TO ELCNTL-KEY.
 10126     MOVE '1'                    TO ELCNTL-REC-TYPE.
 10127     MOVE 'Y'                    TO ELCNTL-UPDATE-SW.
 10128     PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT.
 10129
 10130     IF EMI-ERROR NOT = ZEROS
 10131         GO TO 8200-SEND-DATAONLY.
 10132
 10133     IF CR-CHECK-NO-AUTO-SEQ
 10134         IF CR-CHECK-CNT-RESET-VALUE
 10135             MOVE CF-CR-CHECK-COUNTER TO BCHKNOI
 10136             MOVE +1             TO CF-CR-CHECK-COUNTER
 10137             MOVE 6              TO BCHKNOL
 10138         ELSE
 10139             MOVE CF-CR-CHECK-COUNTER TO BCHKNOI
 10140             MOVE 6              TO BCHKNOL
 10141             ADD +1              TO CF-CR-CHECK-COUNTER.
 10142
 10143     IF CR-CHECK-NO-MANUAL
 10144         IF BCHKNOL = ZEROS
 10145             MOVE ER-2438        TO EMI-ERROR
 10146             MOVE -1             TO BCHKNOL
 10147             MOVE AL-UNBON       TO BCHKNOA
 10148             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10149             GO TO 8200-SEND-DATAONLY
 10150         ELSE
 10151             IF BCHKNOI NOT NUMERIC
 10152                 MOVE ER-2439    TO EMI-ERROR
 10153                 MOVE -1         TO BCHKNOL
 10154                 MOVE AL-UNBON   TO BCHKNOA
 10155                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10156                 GO TO 8200-SEND-DATAONLY.
 10157
 10158     PERFORM 7600-CHECK-FORMS THRU 7600-EXIT.
 10159
 10160
 10161* EXEC CICS GETMAIN
 10162*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 10163*        LENGTH  (ERPYAJ-LENGTH)
 10164*        INITIMG (GETMAIN-SPACE)
 10165*    END-EXEC.
 10166*    MOVE ',"IL                  $   #00009505' TO DFHEIV0
 10167     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10168     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10169     MOVE X'2020233030303039353035' TO DFHEIV0(25:11)
 10170     CALL 'kxdfhei1' USING DFHEIV0,
 10171           DFHEIV20,
 10172           ERPYAJ-LENGTH,
 10173           GETMAIN-SPACE
 10174     SET ADDRESS OF PENDING-PAY-ADJ TO
 10175         DFHEIV20
 10176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10177
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 204
* EL640.cbl
 10178
 10179
 10180* EXEC CICS BIF DEEDIT
 10181*        FIELD  (BCHKAMTI)
 10182*        LENGTH (11)
 10183*    END-EXEC.
 10184     MOVE 11
 10185       TO DFHEIV11
 10186*    MOVE '@"L                   #   #00009511' TO DFHEIV0
 10187     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10188     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10189     MOVE X'2020233030303039353131' TO DFHEIV0(25:11)
 10190     CALL 'kxdfhei1' USING DFHEIV0,
 10191           BCHKAMTI,
 10192           DFHEIV11
 10193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10194
 10195
 10196     IF BCHKAMTI NOT > ZEROS
 10197         MOVE ER-3165    TO  EMI-ERROR
 10198         MOVE -1         TO  BCHKAMTL
 10199         MOVE AL-UNBON   TO  BCHKAMTA
 10200         MOVE BCHKAMTI   TO  BCHKAMTO
 10201         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10202         GO TO 8200-SEND-DATAONLY.
 10203
 10204     MOVE 'Y'                    TO PI-CHECK-SW.
 10205     MOVE 'PY'                   TO PY-RECORD-ID.
 10206     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
 10207     MOVE PI-COMP-CARRIER        TO PY-CARRIER.
 10208     MOVE PI-COMP-GROUPING       TO PY-GROUPING.
 10209     MOVE PI-SAV-REMIT-TO        TO PY-FIN-RESP.
 10210     MOVE PI-SAV-ACCT            TO PY-ACCOUNT.
 10211     MOVE 'C'                    TO PY-RECORD-TYPE.
 10212     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
 10213
 10214     IF PI-COMPANY-ID = CLIENT-ITY
 10215        MOVE PI-MONTH-END-DATE   TO WS-PY-END-DT
 10216                                    WS-BEGIN-DATE
 10217        MOVE '01'                TO WS-BEGIN-DAY
 10218        MOVE WS-BEGIN-DATE       TO WS-PY-BEGIN-DT
 10219        MOVE WS-ITY-COMMENT      TO PY-ENTRY-COMMENT
 10220     ELSE
 10221        MOVE WS-CURRENT-DATE-MDY TO WS-PY-CURRENT-DATE
 10222        MOVE WS-PY-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
 10223
 10224     MOVE BCHKAMTI               TO PY-ENTRY-AMT.
 10225     ADD BCHKAMTI TO PI-DISBURSED.
 10226     MOVE BFORM1I                TO PY-LETTER (1).
 10227     MOVE BFORM2I                TO PY-LETTER (2).
 10228     MOVE BFORM3I                TO PY-LETTER (3).
 10229
 10230     IF NOT CR-CHECK-NO-AT-PRINT
 10231         MOVE BCHKNOI            TO PY-CHECK-NUMBER.
 10232
 10233     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
 10234     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
 10235     MOVE WS-CURRENT-DATE        TO PY-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 205
* EL640.cbl
 10236                                    PY-INPUT-DT.
 10237     IF PI-BILL OR PI-REBILLING
 10238         MOVE DC-BIN-DATE-1      TO PY-BILLED-DATE
 10239     ELSE
 10240         MOVE LOW-VALUES         TO PY-BILLED-DATE
 10241                                    PY-AR-DATE.
 10242
 10243     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 10244                                    PY-CHECK-QUE-SEQUENCE.
 10245     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 10246                                    PY-REPORTED-DT
 10247                                    PY-CHECK-WRITTEN-DT.
 10248     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
 10249     MOVE 'B'                    TO PY-CHECK-ORIGIN-SW.
 10250
 10251
 10252* EXEC CICS WRITE
 10253*        DATASET (ERPYAJ-FILE-ID)
 10254*        FROM    (PENDING-PAY-ADJ)
 10255*        RIDFLD  (PY-CONTROL-PRIMARY)
 10256*    END-EXEC.
 10257     MOVE LENGTH OF
 10258      PENDING-PAY-ADJ
 10259       TO DFHEIV11
 10260*    MOVE '&$ L                  ''   #00009571' TO DFHEIV0
 10261     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10262     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10263     MOVE X'2020233030303039353731' TO DFHEIV0(25:11)
 10264     CALL 'kxdfhei1' USING DFHEIV0,
 10265           ERPYAJ-FILE-ID,
 10266           PENDING-PAY-ADJ,
 10267           DFHEIV11,
 10268           PY-CONTROL-PRIMARY,
 10269           DFHEIV99,
 10270           DFHEIV99
 10271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10272
 10273
 10274     IF CR-CHECK-NO-AUTO-SEQ
 10275         PERFORM 6200-REWRITE-CONTROL-FILE THRU 6290-EXIT
 10276     ELSE
 10277
 10278* EXEC CICS UNLOCK
 10279*            DATASET (ELCNTL-FILE-ID)
 10280*        END-EXEC.
 10281*    MOVE '&*                    #   #00009580' TO DFHEIV0
 10282     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10283     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10284     MOVE X'2020233030303039353830' TO DFHEIV0(25:11)
 10285     CALL 'kxdfhei1' USING DFHEIV0,
 10286           ELCNTL-FILE-ID,
 10287           DFHEIV99
 10288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10289
 10290
 10291     MOVE EL640A                 TO PI-MAP-NAME.
 10292     PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT.
 10293     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 206
* EL640.cbl
 10294
 10295 7600-CHECK-FORMS.
 10296
 10297     IF BFORM1L NOT = ZEROS
 10298             AND
 10299        BFORM1I NOT = SPACES
 10300         MOVE BFORM1I            TO ELLETR-FORM-NO
 10301         PERFORM 7620-CHECK-ON-LETTER THRU 7620-EXIT
 10302         IF W-LETTER-NOT-FOUND
 10303             MOVE ER-7389        TO EMI-ERROR
 10304             MOVE -1             TO BFORM1L
 10305             MOVE AL-UABON       TO BFORM1A
 10306             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10307             GO TO 8200-SEND-DATAONLY.
 10308
 10309     IF BFORM2L NOT = ZEROS
 10310             AND
 10311        BFORM2I NOT = SPACES
 10312         MOVE BFORM2I            TO ELLETR-FORM-NO
 10313         PERFORM 7620-CHECK-ON-LETTER THRU 7620-EXIT
 10314
 10315         IF W-LETTER-NOT-FOUND
 10316             MOVE ER-7389        TO EMI-ERROR
 10317             MOVE -1             TO BFORM2L
 10318             MOVE AL-UABON       TO BFORM2A
 10319             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10320             GO TO 8200-SEND-DATAONLY.
 10321
 10322     IF BFORM3L NOT = ZEROS
 10323             AND
 10324        BFORM3I NOT = SPACES
 10325         MOVE BFORM3I            TO ELLETR-FORM-NO
 10326         IF  W-LETTER-NOT-FOUND
 10327             MOVE ER-7389        TO EMI-ERROR
 10328             MOVE -1             TO BFORM3L
 10329             MOVE AL-UABON       TO BFORM3A
 10330             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10331             GO TO 8200-SEND-DATAONLY.
 10332
 10333     IF BFORM1L = ZEROS
 10334         IF BFORM2L NOT = ZEROS
 10335             MOVE BFORM2L        TO BFORM1L
 10336             MOVE BFORM3L        TO BFORM2L
 10337             MOVE BFORM2A        TO BFORM1A
 10338             MOVE BFORM3A        TO BFORM2A
 10339             MOVE BFORM2I        TO BFORM1I
 10340             MOVE BFORM3I        TO BFORM2I
 10341             MOVE LOW-VALUES     TO BFORM3I
 10342                                    BFORM3A
 10343             MOVE ZEROS          TO BFORM3L
 10344         ELSE
 10345             IF BFORM3L NOT = ZEROS
 10346                 MOVE BFORM3L    TO BFORM1L
 10347                 MOVE BFORM3I    TO BFORM1I
 10348                 MOVE BFORM3A    TO BFORM1A
 10349                 MOVE LOW-VALUES TO BFORM3I
 10350                                    BFORM3A
 10351                 MOVE ZEROS      TO BFORM3L
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 207
* EL640.cbl
 10352             ELSE
 10353                 NEXT SENTENCE
 10354     ELSE
 10355         IF BFORM2L = ZEROS
 10356             IF BFORM3L NOT = ZEROS
 10357                 MOVE BFORM3L    TO BFORM2L
 10358                 MOVE BFORM3I    TO BFORM2I
 10359                 MOVE BFORM3A    TO BFORM2A
 10360                 MOVE LOW-VALUES TO BFORM3I
 10361                                    BFORM3A
 10362                 MOVE ZEROS      TO BFORM3L.
 10363
 10364 7600-EXIT.
 10365      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 208
* EL640.cbl
 10367 7620-CHECK-ON-LETTER.
 10368
 10369     MOVE SPACES                 TO W-LETTER-IND.
 10370
 10371     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD.
 10372     MOVE +1                     TO ELLETR-LINE-SEQ.
 10373
 10374
 10375* EXEC CICS HANDLE CONDITION
 10376*        NOTFND   (7620-LETR-NOT-FOUND)
 10377*        ENDFILE  (7620-LETR-NOT-FOUND)
 10378*        NOTOPEN  (7620-LETR-NOT-OPEN)
 10379*    END-EXEC.
 10380*    MOVE '"$I''J                 ! 0 #00009667' TO DFHEIV0
 10381     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
 10382     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10383     MOVE X'3020233030303039363637' TO DFHEIV0(25:11)
 10384     CALL 'kxdfhei1' USING DFHEIV0
 10385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10386
 10387
 10388
 10389* EXEC CICS READ
 10390*        SET     (ADDRESS OF TEXT-FILES)
 10391*        DATASET (ELLETR-FILE-ID)
 10392*        RIDFLD  (ELLETR-KEY)
 10393*    END-EXEC.
 10394*    MOVE '&"S        E          (   #00009673' TO DFHEIV0
 10395     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10396     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10397     MOVE X'2020233030303039363733' TO DFHEIV0(25:11)
 10398     CALL 'kxdfhei1' USING DFHEIV0,
 10399           ELLETR-FILE-ID,
 10400           DFHEIV20,
 10401           DFHEIV99,
 10402           ELLETR-KEY,
 10403           DFHEIV99,
 10404           DFHEIV99,
 10405           DFHEIV99
 10406     SET ADDRESS OF TEXT-FILES TO
 10407         DFHEIV20
 10408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10409
 10410
 10411     GO TO 7620-EXIT.
 10412
 10413 7620-LETR-NOT-FOUND.
 10414
 10415     MOVE 'Y'                    TO W-LETTER-IND.
 10416     GO TO 7620-EXIT.
 10417
 10418 7620-LETR-NOT-OPEN.
 10419
 10420     MOVE ER-0013                TO EMI-ERROR.
 10421     MOVE -1                     TO BFORM1L.
 10422     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10423     GO TO 8200-SEND-DATAONLY.
 10424
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 209
* EL640.cbl
 10425 7620-EXIT.
 10426      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 210
* EL640.cbl
 10428 8100-SEND-INITIAL-MAP.
 10429
 10430     MOVE SPACES TO PI-TRANSFER-SW.
 10431
 10432     IF PI-MAP-NAME = EL640A
 10433         NEXT SENTENCE
 10434     ELSE
 10435         GO TO 8110-SEND-INITIAL-CHECK-MAP.
 10436
 10437     IF PI-COMPANY-ID = 'DMD'
 10438        MOVE AL-SADOF            TO APF5HDGA.
 10439
 10440     IF NOT PI-GA-BILLING
 10441        MOVE AL-SADOF            TO AGAHDGA.
 10442
 10443     MOVE WS-CURRENT-DATE-EDIT   TO ADATEO.
 10444     MOVE EIBTIME                TO TIME-IN.
 10445     MOVE TIME-OUT               TO ATIMEO.
 10446     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10447     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10448
 10449     MOVE -1                     TO AACCTL.
 10450     MOVE EMI-MESSAGE-AREA (1)   TO AERMSG1O.
 10451     MOVE EMI-MESSAGE-AREA (2)   TO AERMSG2O.
 10452
 10453     IF CARR-GROUP-ST-ACCNT-CNTL
 10454         NEXT SENTENCE
 10455     ELSE
 10456         IF ST-ACCNT-CNTL
 10457             MOVE AL-SADOF       TO ACARHDGA
 10458                                    AGRPHDGA
 10459             MOVE AL-SANOF       TO ACARIERA
 10460                                    AGROUPA
 10461         ELSE
 10462             IF CARR-ST-ACCNT-CNTL
 10463                 MOVE AL-SADOF   TO AGRPHDGA
 10464                 MOVE AL-SANOF   TO AGROUPA
 10465             ELSE
 10466                 IF ACCNT-CNTL
 10467                     MOVE AL-SADOF TO ACARHDGA
 10468                                      AGRPHDGA
 10469                                      ASTHDGA
 10470                     MOVE AL-SANOF TO ACARIERA
 10471                                      AGROUPA
 10472                                      ASTATEA
 10473                 ELSE
 10474                     IF CARR-ACCNT-CNTL
 10475                         MOVE AL-SADOF TO AGRPHDGA
 10476                                          ASTHDGA
 10477                         MOVE AL-SANOF TO AGROUPA
 10478                                          ASTATEA.
 10479
 10480     IF (EIBTRNID = EL633-TRANS-ID  OR  EL635-TRANS-ID  OR
 10481                    EL633DMD-TRANS-ID  OR
 10482                    EL650-TRANS-ID  OR  EL652-TRANS-ID  OR
 10483                    EL658-TRANS-ID)  AND
 10484          (WT-CR-ACCOUNT NOT = SPACES AND LOW-VALUES)
 10485        MOVE WT-CR-CARRIER       TO PI-SCR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 211
* EL640.cbl
 10486        MOVE WT-CR-GROUPING      TO PI-SCR-GROUPING
 10487        MOVE WT-CR-STATE         TO PI-SCR-STATE
 10488        MOVE WT-CR-FIN-RESP      TO PI-SCR-FIN-RESP
 10489        MOVE WT-CR-TYPE          TO PI-SCR-TYPE
 10490        IF CARR-GROUP-ST-ACCNT-CNTL
 10491            MOVE AL-UANON        TO ACARIERA
 10492                                    AGROUPA
 10493                                    ASTATEA
 10494                                    AACCTA
 10495            MOVE WT-CR-CARRIER   TO ACARIERI
 10496                                    PI-SCR-CARRIER
 10497            MOVE WT-CR-GROUPING  TO AGROUPI
 10498                                    PI-SCR-GROUPING
 10499            MOVE WT-CR-ACCOUNT   TO AACCTI
 10500                                    PI-SCR-ACCOUNT
 10501            MOVE 1               TO ACARIERL
 10502            MOVE 6               TO AGROUPL
 10503            MOVE 10              TO AACCTL
 10504            MOVE -1              TO ASTATEL
 10505        ELSE
 10506         IF ST-ACCNT-CNTL
 10507            MOVE AL-UANON        TO ASTATEA
 10508                                    AACCTA
 10509            MOVE WT-CR-ACCOUNT   TO AACCTI
 10510                                    PI-SCR-ACCOUNT
 10511            MOVE 10              TO AACCTL
 10512            MOVE -1              TO ASTATEL
 10513         ELSE
 10514            IF CARR-ST-ACCNT-CNTL
 10515                MOVE AL-UANON       TO ACARIERA
 10516                                       ASTATEA
 10517                                       AACCTA
 10518                MOVE WT-CR-CARRIER TO ACARIERI
 10519                                      PI-SCR-CARRIER
 10520                MOVE WT-CR-ACCOUNT TO AACCTI
 10521                                      PI-SCR-ACCOUNT
 10522                MOVE 1              TO ACARIERL
 10523                MOVE 10             TO AACCTL
 10524                MOVE -1             TO ASTATEL
 10525            ELSE
 10526                IF ACCNT-CNTL
 10527                    MOVE AL-UANON       TO AACCTA
 10528                    MOVE WT-CR-ACCOUNT  TO AACCTI
 10529                                           PI-SCR-ACCOUNT
 10530                    MOVE 10             TO AACCTL
 10531                    MOVE -1             TO ABILTYPL
 10532                ELSE
 10533                    IF CARR-ACCNT-CNTL
 10534                        MOVE AL-UANON        TO ACARIERA
 10535                                                AACCTA
 10536                        MOVE WT-CR-CARRIER   TO ACARIERI
 10537                                                PI-SCR-CARRIER
 10538                        MOVE WT-CR-ACCOUNT   TO AACCTI
 10539                                                PI-SCR-ACCOUNT
 10540                        MOVE 1               TO ACARIERL
 10541                        MOVE 10              TO AACCTL
 10542                        MOVE -1              TO ABILTYPL.
 10543
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 212
* EL640.cbl
 10544     IF (EIBTRNID = EL6311-TRANS-ID) AND
 10545          (WT-CR-ACCOUNT NOT = SPACES AND LOW-VALUES)
 10546        MOVE WT-CR-CARRIER       TO PI-SCR-CARRIER
 10547        MOVE WT-CR-GROUPING      TO PI-SCR-GROUPING
 10548        MOVE WT-CR-STATE         TO PI-SCR-STATE
 10549        MOVE WT-CR-FIN-RESP      TO PI-SCR-FIN-RESP
 10550        MOVE WT-CR-TYPE          TO PI-SCR-TYPE
 10551        MOVE SPACES              TO PI-SAV-CARR
 10552                                    PI-SAV-GROUP
 10553                                    PI-SAV-STATE
 10554                                    PI-SAV-ACCT
 10555        MOVE LOW-VALUES          TO PI-SAV-EXP-DT
 10556        IF CARR-GROUP-ST-ACCNT-CNTL
 10557            MOVE AL-UANON        TO ACARIERA
 10558                                    AGROUPA
 10559                                    ASTATEA
 10560                                    AACCTA
 10561            MOVE WT-CR-CARRIER   TO ACARIERI
 10562                                    PI-SCR-CARRIER
 10563                                    PI-SAV-CARR
 10564            MOVE WT-CR-GROUPING  TO AGROUPI
 10565                                    PI-SCR-GROUPING
 10566                                    PI-SAV-GROUP
 10567            MOVE WT-CR-STATE     TO ASTATEI
 10568                                    PI-SCR-STATE
 10569            MOVE WT-CR-ACCOUNT   TO AACCTI
 10570                                    PI-SCR-ACCOUNT
 10571            MOVE 1               TO ACARIERL
 10572            MOVE 6               TO AGROUPL
 10573            MOVE 10              TO AACCTL
 10574            MOVE 2               TO ASTATEL
 10575            MOVE -1              TO ABILTYPL
 10576        ELSE
 10577         IF ST-ACCNT-CNTL
 10578            MOVE AL-UANON        TO ASTATEA
 10579                                    AACCTA
 10580            MOVE WT-CR-STATE     TO ASTATEI
 10581                                    PI-SCR-STATE
 10582                                    PI-SAV-STATE
 10583            MOVE WT-CR-ACCOUNT   TO AACCTI
 10584                                    PI-SCR-ACCOUNT
 10585                                    PI-SAV-ACCT
 10586            MOVE 10              TO AACCTL
 10587            MOVE -1              TO ASTATEL
 10588         ELSE
 10589            IF CARR-ST-ACCNT-CNTL
 10590                MOVE AL-UANON      TO ACARIERA
 10591                                      ASTATEA
 10592                                      AACCTA
 10593                MOVE WT-CR-CARRIER TO ACARIERI
 10594                                      PI-SCR-CARRIER
 10595                                      PI-SAV-CARR
 10596                MOVE WT-CR-STATE   TO ASTATEI
 10597                                      PI-SCR-STATE
 10598                                      PI-SAV-STATE
 10599                MOVE WT-CR-ACCOUNT TO AACCTI
 10600                                      PI-SCR-ACCOUNT
 10601                                      PI-SAV-ACCT
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 213
* EL640.cbl
 10602                MOVE 1             TO ACARIERL
 10603                MOVE 10            TO AACCTL
 10604                MOVE 2             TO ASTATEL
 10605                MOVE -1            TO ABILTYPL
 10606            ELSE
 10607                IF ACCNT-CNTL
 10608                    MOVE AL-UANON       TO AACCTA
 10609                    MOVE WT-CR-ACCOUNT  TO AACCTI
 10610                                           PI-SCR-ACCOUNT
 10611                                           PI-SAV-ACCT
 10612                    MOVE 10             TO AACCTL
 10613                    MOVE -1             TO ABILTYPL
 10614                ELSE
 10615                    IF CARR-ACCNT-CNTL
 10616                        MOVE AL-UANON        TO ACARIERA
 10617                                                AACCTA
 10618                        MOVE WT-CR-CARRIER   TO ACARIERI
 10619                                                PI-SCR-CARRIER
 10620                                                PI-SAV-CARR
 10621                        MOVE WT-CR-ACCOUNT   TO AACCTI
 10622                                                PI-SCR-ACCOUNT
 10623                                                PI-SAV-ACCT
 10624                        MOVE 1               TO ACARIERL
 10625                        MOVE 10              TO AACCTL
 10626                        MOVE -1              TO ABILTYPL.
 10627
 10628
 10629* EXEC CICS SEND
 10630*        MAP      (PI-MAP-NAME)
 10631*        MAPSET   (MAPSET-NAME)
 10632*        FROM     (EL640AO)
 10633*        ERASE
 10634*        CURSOR
 10635*    END-EXEC.
 10636     MOVE LENGTH OF
 10637      EL640AO
 10638       TO DFHEIV12
 10639     MOVE -1
 10640       TO DFHEIV11
 10641*    MOVE '8$     CT  E    H L F ,   #00009896' TO DFHEIV0
 10642     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10643     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10644     MOVE X'2020233030303039383936' TO DFHEIV0(25:11)
 10645     CALL 'kxdfhei1' USING DFHEIV0,
 10646           PI-MAP-NAME,
 10647           EL640AO,
 10648           DFHEIV12,
 10649           MAPSET-NAME,
 10650           DFHEIV99,
 10651           DFHEIV99,
 10652           DFHEIV99,
 10653           DFHEIV11,
 10654           DFHEIV99,
 10655           DFHEIV99,
 10656           DFHEIV99
 10657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10658
 10659
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 214
* EL640.cbl
 10660     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 215
* EL640.cbl
 10662 8110-SEND-INITIAL-CHECK-MAP.
 10663     MOVE WS-CURRENT-DATE-EDIT   TO BDATEO.
 10664     MOVE EIBTIME                TO TIME-IN.
 10665     MOVE TIME-OUT               TO BTIMEO.
 10666     MOVE PI-COMPANY-ID          TO BCMPNYO.
 10667     MOVE PI-PROCESSOR-ID        TO BUSERIDO.
 10668     MOVE -1                     TO BPFNTERL.
 10669     MOVE EMI-MESSAGE-AREA (1)   TO BERMSGO.
 10670
 10671
 10672* EXEC CICS SEND
 10673*        MAP      (PI-MAP-NAME)
 10674*        MAPSET   (MAPSET-NAME)
 10675*        FROM     (EL640BO)
 10676*        ERASE
 10677*        CURSOR
 10678*    END-EXEC.
 10679     MOVE LENGTH OF
 10680      EL640BO
 10681       TO DFHEIV12
 10682     MOVE -1
 10683       TO DFHEIV11
 10684*    MOVE '8$     CT  E    H L F ,   #00009915' TO DFHEIV0
 10685     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10686     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10687     MOVE X'2020233030303039393135' TO DFHEIV0(25:11)
 10688     CALL 'kxdfhei1' USING DFHEIV0,
 10689           PI-MAP-NAME,
 10690           EL640BO,
 10691           DFHEIV12,
 10692           MAPSET-NAME,
 10693           DFHEIV99,
 10694           DFHEIV99,
 10695           DFHEIV99,
 10696           DFHEIV11,
 10697           DFHEIV99,
 10698           DFHEIV99,
 10699           DFHEIV99
 10700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10701
 10702
 10703     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 216
* EL640.cbl
 10705 8200-SEND-DATAONLY.
 10706     IF PI-MAP-NAME = EL640A
 10707         MOVE WS-CURRENT-DATE-EDIT   TO ADATEO
 10708         MOVE EIBTIME                TO TIME-IN
 10709         MOVE TIME-OUT               TO ATIMEO
 10710         MOVE PI-COMPANY-ID          TO CMPNYIDO
 10711         MOVE PI-PROCESSOR-ID        TO USERIDO
 10712         MOVE EMI-MESSAGE-AREA (1)   TO AERMSG1O
 10713         MOVE EMI-MESSAGE-AREA (2)   TO AERMSG2O
 10714
 10715* EXEC CICS SEND
 10716*            MAP      (PI-MAP-NAME)
 10717*            MAPSET   (MAPSET-NAME)
 10718*            FROM     (EL640AO)
 10719*            DATAONLY
 10720*            ERASEAUP
 10721*            CURSOR
 10722*        END-EXEC
 10723     MOVE LENGTH OF
 10724      EL640AO
 10725       TO DFHEIV12
 10726     MOVE -1
 10727       TO DFHEIV11
 10728*    MOVE '8$D    CT  A    H L F ,   #00009934' TO DFHEIV0
 10729     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 10730     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10731     MOVE X'2020233030303039393334' TO DFHEIV0(25:11)
 10732     CALL 'kxdfhei1' USING DFHEIV0,
 10733           PI-MAP-NAME,
 10734           EL640AO,
 10735           DFHEIV12,
 10736           MAPSET-NAME,
 10737           DFHEIV99,
 10738           DFHEIV99,
 10739           DFHEIV99,
 10740           DFHEIV11,
 10741           DFHEIV99,
 10742           DFHEIV99,
 10743           DFHEIV99
 10744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10745     ELSE
 10746         MOVE WS-CURRENT-DATE-EDIT   TO BDATEO
 10747         MOVE EIBTIME                TO TIME-IN
 10748         MOVE TIME-OUT               TO BTIMEO
 10749         MOVE PI-COMPANY-ID          TO BCMPNYO
 10750         MOVE PI-PROCESSOR-ID        TO BUSERIDO
 10751         MOVE EMI-MESSAGE-AREA (1)   TO BERMSGO
 10752
 10753* EXEC CICS SEND
 10754*            MAP      (PI-MAP-NAME)
 10755*            MAPSET   (MAPSET-NAME)
 10756*            FROM     (EL640BO)
 10757*            DATAONLY
 10758*            ERASEAUP
 10759*            CURSOR
 10760*        END-EXEC.
 10761     MOVE LENGTH OF
 10762      EL640BO
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 217
* EL640.cbl
 10763       TO DFHEIV12
 10764     MOVE -1
 10765       TO DFHEIV11
 10766*    MOVE '8$D    CT  A    H L F ,   #00009949' TO DFHEIV0
 10767     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 10768     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10769     MOVE X'2020233030303039393439' TO DFHEIV0(25:11)
 10770     CALL 'kxdfhei1' USING DFHEIV0,
 10771           PI-MAP-NAME,
 10772           EL640BO,
 10773           DFHEIV12,
 10774           MAPSET-NAME,
 10775           DFHEIV99,
 10776           DFHEIV99,
 10777           DFHEIV99,
 10778           DFHEIV11,
 10779           DFHEIV99,
 10780           DFHEIV99,
 10781           DFHEIV99
 10782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10783
 10784
 10785     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 218
* EL640.cbl
 10787 8300-SEND-TEXT.
 10788
 10789* EXEC CICS SEND TEXT
 10790*        FROM     (LOGOFF-TEXT)
 10791*        LENGTH   (LOGOFF-LENGTH)
 10792*        ERASE
 10793*        FREEKB
 10794*    END-EXEC.
 10795*    MOVE '8&      T  E F  H   F -   #00009961' TO DFHEIV0
 10796     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10797     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10798     MOVE X'2020233030303039393631' TO DFHEIV0(25:11)
 10799     CALL 'kxdfhei1' USING DFHEIV0,
 10800           LOGOFF-TEXT,
 10801           LOGOFF-LENGTH,
 10802           DFHEIV99,
 10803           DFHEIV99,
 10804           DFHEIV99,
 10805           DFHEIV99,
 10806           DFHEIV99,
 10807           DFHEIV99,
 10808           DFHEIV99,
 10809           DFHEIV99,
 10810           DFHEIV99,
 10811           DFHEIV99
 10812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10813
 10814
 10815
 10816* EXEC CICS RETURN
 10817*    END-EXEC.
 10818*    MOVE '.(                    ''   #00009968' TO DFHEIV0
 10819     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10820     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10821     MOVE X'2020233030303039393638' TO DFHEIV0(25:11)
 10822     CALL 'kxdfhei1' USING DFHEIV0,
 10823           DFHEIV99,
 10824           DFHEIV99,
 10825           DFHEIV99,
 10826           DFHEIV99,
 10827           DFHEIV99,
 10828           DFHEIV99
 10829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10830
 10831
 10832 8500-DATE-CONVERT.
 10833
 10834* EXEC CICS LINK
 10835*        PROGRAM  (LINK-ELDATCV)
 10836*        COMMAREA (DATE-CONVERSION-DATA)
 10837*        LENGTH   (DC-COMM-LENGTH)
 10838*    END-EXEC.
 10839*    MOVE '."C                   (   #00009972' TO DFHEIV0
 10840     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10841     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10842     MOVE X'2020233030303039393732' TO DFHEIV0(25:11)
 10843     CALL 'kxdfhei1' USING DFHEIV0,
 10844           LINK-ELDATCV,
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 219
* EL640.cbl
 10845           DATE-CONVERSION-DATA,
 10846           DC-COMM-LENGTH,
 10847           DFHEIV99,
 10848           DFHEIV99,
 10849           DFHEIV99,
 10850           DFHEIV99
 10851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10852
 10853
 10854 8500-EXIT.
 10855     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 220
* EL640.cbl
 10857 8800-UNAUTHORIZED-ACCESS.
 10858     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 10859     GO TO 8300-SEND-TEXT.
 10860
 10861 8810-PF23.
 10862     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 10863     MOVE XCTL-005               TO PGM-NAME.
 10864     GO TO 9300-XCTL.
 10865
 10866 8900-SYNCPOINT-ROLLBACK.
 10867
 10868* EXEC CICS SYNCPOINT
 10869*         ROLLBACK
 10870*    END-EXEC.
 10871*    MOVE '6"R                   !   #00009991' TO DFHEIV0
 10872     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10873     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10874     MOVE X'2020233030303039393931' TO DFHEIV0(25:11)
 10875     CALL 'kxdfhei1' USING DFHEIV0
 10876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10877
 10878
 10879 8900-EXIT.
 10880     EXIT.
 10881
 10882 9100-RETURN-TRAN.
 10883     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 10884     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
 10885
 10886
 10887* EXEC CICS RETURN
 10888*        TRANSID    (TRANS-ID)
 10889*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10890*        LENGTH     (PI-COMM-LENGTH)
 10891*    END-EXEC.
 10892*    MOVE '.(CT                  ''   #00010002' TO DFHEIV0
 10893     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10894     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10895     MOVE X'2020233030303130303032' TO DFHEIV0(25:11)
 10896     CALL 'kxdfhei1' USING DFHEIV0,
 10897           TRANS-ID,
 10898           PROGRAM-INTERFACE-BLOCK,
 10899           PI-COMM-LENGTH,
 10900           DFHEIV99,
 10901           DFHEIV99,
 10902           DFHEIV99
 10903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10904
 10905
 10906 9200-RETURN-MAIN-MENU.
 10907     MOVE XCTL-626               TO PGM-NAME.
 10908     GO TO 9300-XCTL.
 10909
 10910 9300-XCTL.
 10911
 10912* EXEC CICS XCTL
 10913*        PROGRAM    (PGM-NAME)
 10914*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 221
* EL640.cbl
 10915*        LENGTH     (PI-COMM-LENGTH)
 10916*    END-EXEC.
 10917*    MOVE '.$C                   %   #00010013' TO DFHEIV0
 10918     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10919     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10920     MOVE X'2020233030303130303133' TO DFHEIV0(25:11)
 10921     CALL 'kxdfhei1' USING DFHEIV0,
 10922           PGM-NAME,
 10923           PROGRAM-INTERFACE-BLOCK,
 10924           PI-COMM-LENGTH,
 10925           DFHEIV99
 10926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10927
 10928
 10929 9400-CLEAR.
 10930     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME
 10931     GO TO 9300-XCTL.
 10932
 10933 9500-PF12.
 10934     MOVE XCTL-010               TO PGM-NAME.
 10935     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 222
* EL640.cbl
 10937 9600-PGMID-ERROR.
 10938
 10939* EXEC CICS HANDLE CONDITION
 10940*        PGMIDERR    (8300-SEND-TEXT)
 10941*    END-EXEC.
 10942*    MOVE '"$L                   ! 1 #00010028' TO DFHEIV0
 10943     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10944     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10945     MOVE X'3120233030303130303238' TO DFHEIV0(25:11)
 10946     CALL 'kxdfhei1' USING DFHEIV0
 10947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10948
 10949
 10950     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 10951     MOVE ' '                    TO PI-ENTRY-CD-1.
 10952     MOVE XCTL-005               TO PGM-NAME.
 10953     MOVE PGM-NAME               TO LOGOFF-PGM.
 10954     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 10955     GO TO 9300-XCTL.
 10956
 10957 9900-ERROR-FORMAT.
 10958     IF NOT EMI-ERRORS-COMPLETE
 10959         MOVE LINK-001           TO PGM-NAME
 10960
 10961* EXEC CICS LINK
 10962*            PROGRAM    (PGM-NAME)
 10963*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10964*            LENGTH     (EMI-COMM-LENGTH)
 10965*        END-EXEC.
 10966*    MOVE '."C                   (   #00010042' TO DFHEIV0
 10967     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10968     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10969     MOVE X'2020233030303130303432' TO DFHEIV0(25:11)
 10970     CALL 'kxdfhei1' USING DFHEIV0,
 10971           PGM-NAME,
 10972           ERROR-MESSAGE-INTERFACE-BLOCK,
 10973           EMI-COMM-LENGTH,
 10974           DFHEIV99,
 10975           DFHEIV99,
 10976           DFHEIV99,
 10977           DFHEIV99
 10978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10979
 10980
 10981 9900-EXIT.
 10982     EXIT.
 10983
 10984 9990-ABEND.
 10985     MOVE LINK-004               TO PGM-NAME.
 10986     MOVE DFHEIBLK               TO EMI-LINE1.
 10987
 10988
 10989* EXEC CICS LINK
 10990*        PROGRAM   (PGM-NAME)
 10991*        COMMAREA  (EMI-LINE1)
 10992*        LENGTH    (72)
 10993*    END-EXEC.
 10994     MOVE 72
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 223
* EL640.cbl
 10995       TO DFHEIV11
 10996*    MOVE '."C                   (   #00010055' TO DFHEIV0
 10997     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10998     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10999     MOVE X'2020233030303130303535' TO DFHEIV0(25:11)
 11000     CALL 'kxdfhei1' USING DFHEIV0,
 11001           PGM-NAME,
 11002           EMI-LINE1,
 11003           DFHEIV11,
 11004           DFHEIV99,
 11005           DFHEIV99,
 11006           DFHEIV99,
 11007           DFHEIV99
 11008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11009
 11010
 11011     IF PI-MAP-NAME = EL640A
 11012         MOVE -1 TO APFNTERL
 11013     ELSE
 11014         MOVE -1 TO BPFNTERL.
 11015
 11016     GO TO 8200-SEND-DATAONLY.
 11017
 11018 9995-SECURITY-VIOLATION.
 11019*                            COPY ELCSCTP.
 11020******************************************************************
 11021*                                                                *
 11022*                            ELCSCTP                             *
 11023*                            VMOD=2.001                          *
 11024*                                                                *
 11025*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 11026******************************************************************
 11027
 11028
 11029     MOVE EIBDATE          TO SM-JUL-DATE.
 11030     MOVE EIBTRMID         TO SM-TERMID.
 11031     MOVE THIS-PGM         TO SM-PGM.
 11032     MOVE EIBTIME          TO TIME-IN.
 11033     MOVE TIME-OUT         TO SM-TIME.
 11034     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 11035
 11036
 11037* EXEC CICS LINK
 11038*         PROGRAM  ('EL003')
 11039*         COMMAREA (SECURITY-MESSAGE)
 11040*         LENGTH   (80)
 11041*    END-EXEC.
 11042     MOVE 'EL003' TO DFHEIV1
 11043     MOVE 80
 11044       TO DFHEIV11
 11045*    MOVE '."C                   (   #00010086' TO DFHEIV0
 11046     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11047     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11048     MOVE X'2020233030303130303836' TO DFHEIV0(25:11)
 11049     CALL 'kxdfhei1' USING DFHEIV0,
 11050           DFHEIV1,
 11051           SECURITY-MESSAGE,
 11052           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 224
* EL640.cbl
 11053           DFHEIV99,
 11054           DFHEIV99,
 11055           DFHEIV99,
 11056           DFHEIV99
 11057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11058
 11059
 11060******************************************************************
 11061
 11062
 11063
 11064 9999-DFHBACK SECTION.
 11065     MOVE '9%                    "   ' TO DFHEIV0
 11066     MOVE 'EL640' TO DFHEIV1
 11067     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 11068     GOBACK.
 11069 9999-DFHEXIT.
 11070     IF DFHEIGDJ EQUAL 0001
 11071         NEXT SENTENCE
 11072     ELSE IF DFHEIGDJ EQUAL 2
 11073         GO TO 9600-PGMID-ERROR,
 11074               9990-ABEND
 11075         DEPENDING ON DFHEIGDI
 11076     ELSE IF DFHEIGDJ EQUAL 3
 11077         GO TO 0890-EXIT
 11078         DEPENDING ON DFHEIGDI
 11079     ELSE IF DFHEIGDJ EQUAL 4
 11080         GO TO 3930-BILL-NOTFND,
 11081               3930-BILL-NOTOPEN
 11082         DEPENDING ON DFHEIGDI
 11083     ELSE IF DFHEIGDJ EQUAL 5
 11084         GO TO 3940-EXIT
 11085         DEPENDING ON DFHEIGDI
 11086     ELSE IF DFHEIGDJ EQUAL 6
 11087         GO TO 4010-REC-NOT-FND
 11088         DEPENDING ON DFHEIGDI
 11089     ELSE IF DFHEIGDJ EQUAL 7
 11090         GO TO 4110-END-OF-FILE
 11091         DEPENDING ON DFHEIGDI
 11092     ELSE IF DFHEIGDJ EQUAL 8
 11093         GO TO 4270-PNDB-NOTFIND,
 11094               4280-PNDB-FILE-NOTOPEN
 11095         DEPENDING ON DFHEIGDI
 11096     ELSE IF DFHEIGDJ EQUAL 9
 11097         GO TO 4370-ACCOUNT-INVALID,
 11098               4380-ACCT-FILE-NOTOPEN
 11099         DEPENDING ON DFHEIGDI
 11100     ELSE IF DFHEIGDJ EQUAL 10
 11101         GO TO 4470-ACCOUNT-INVALID,
 11102               4480-ACCT-FILE-NOTOPEN
 11103         DEPENDING ON DFHEIGDI
 11104     ELSE IF DFHEIGDJ EQUAL 11
 11105         GO TO 4510-REC-NOT-FND
 11106         DEPENDING ON DFHEIGDI
 11107     ELSE IF DFHEIGDJ EQUAL 12
 11108         GO TO 4610-END-OF-FILE
 11109         DEPENDING ON DFHEIGDI
 11110     ELSE IF DFHEIGDJ EQUAL 13
* Micro Focus Server Express         V5.1 revision 000 11-Apr-19 09:40 Page 225
* EL640.cbl
 11111         GO TO 6070-NO-COMP-MSTR,
 11112               6080-COMP-FILE-NOTOPEN
 11113         DEPENDING ON DFHEIGDI
 11114     ELSE IF DFHEIGDJ EQUAL 14
 11115         GO TO 6045-NO-COMP-MSTR,
 11116               6045-COMP-FILE-NOTOPEN
 11117         DEPENDING ON DFHEIGDI
 11118     ELSE IF DFHEIGDJ EQUAL 15
 11119         GO TO 6110-NO-RECORD
 11120         DEPENDING ON DFHEIGDI
 11121     ELSE IF DFHEIGDJ EQUAL 16
 11122         GO TO 7620-LETR-NOT-FOUND,
 11123               7620-LETR-NOT-FOUND,
 11124               7620-LETR-NOT-OPEN
 11125         DEPENDING ON DFHEIGDI
 11126     ELSE IF DFHEIGDJ EQUAL 17
 11127         GO TO 8300-SEND-TEXT
 11128         DEPENDING ON DFHEIGDI.
 11129     MOVE '9%                    "   ' TO DFHEIV0
 11130     MOVE 'EL640' TO DFHEIV1
 11131     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 11132     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        9132     Code:       35403
