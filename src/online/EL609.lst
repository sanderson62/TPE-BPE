* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL609.cbl
* Options: int("EL609.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL609.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL609.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL609.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL609 .
     3*                            VMOD=2.001.
     4*
     5*
     6*AUTHOR.    CSO.
     7*           OMAHA, NEBRASKA.
     8*DATE-COMPILED.
     9*SECURITY.   *****************************************************
    10*            *                                                   *
    11*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
    12*            *                                                   *
    13*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL609.cbl
    14*            *   OF    CSO      IS EXPRESSLY PROHIBITED WITHOUT  *
    15*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    16*            *                                                   *
    17*            *****************************************************
    18*REMARKS.
    19*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    20*    FOR THE LIFE CLAIM INTEREST SELECTION CRITERIA.
    21*
    22*    SCREENS     - EL609A - INTEREST RATE MAINTENANCE
    23*
    24*    ENTERED BY  - EL605 - LIFE CLAIM INTEREST MENU
    25*
    26*    EXIT TO     - EL605 - LIFE CLAIM INTEREST MENU
    27*
    28*    COMMAREA    - PASSED
    29*
    30*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL605.  ON
    31*                  FIRST ENTRY, A SKELETON SCREEN IS SENT AND THE
    32*                  PROGRAM EXITS TO WAIT FOR INPUT.  ON SUCCESSIVE
    33*                  ENTRIES (XCTL FROM CICS VIA EX  ) THE SCREEN
    34*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    35*                  MAINTENANCE TYPE INDICATED.
    36******************************************************************
    37*                   C H A N G E   L O G
    38*
    39* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    40*-----------------------------------------------------------------
    41*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    42* EFFECTIVE    NUMBER
    43*-----------------------------------------------------------------
    44* 052605    2004040700004  PEMA  NEW PROGRAM
    45******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL609.cbl
    47 ENVIRONMENT DIVISION.
    48 DATA DIVISION.
    49 WORKING-STORAGE SECTION.
    50 01  DFH-START PIC X(04).
    51 77  FILLER  PIC X(32)  VALUE '********************************'.
    52 77  FILLER  PIC X(32)  VALUE '*   EL609  WORKING STORAGE     *'.
    53 77  FILLER  PIC X(32)  VALUE '***********VMOD=2.001 **********'.
    54 77  CI1                PIC S999  COMP-3 VALUE +0.
    55 77  B1                 PIC S999  COMP-3 VALUE +0.
    56*    COPY ELCSCTM.
    57******************************************************************
    58*                                                                *
    59*                                                                *
    60*                            ELCSCTM                             *
    61*                            VMOD=2.001                          *
    62*                                                                *
    63*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    64*                                                                *
    65******************************************************************
    66 01  SECURITY-MESSAGE.
    67     12  FILLER                          PIC X(30)
    68            VALUE '** LOGIC SECURITY VIOLATION -'.
    69     12  SM-READ                         PIC X(6).
    70     12  FILLER                          PIC X(5)
    71            VALUE ' PGM='.
    72     12  SM-PGM                          PIC X(6).
    73     12  FILLER                          PIC X(5)
    74            VALUE ' OPR='.
    75     12  SM-PROCESSOR-ID                 PIC X(4).
    76     12  FILLER                          PIC X(6)
    77            VALUE ' TERM='.
    78     12  SM-TERMID                       PIC X(4).
    79     12  FILLER                          PIC XX   VALUE SPACE.
    80     12  SM-JUL-DATE                     PIC 9(5).
    81     12  FILLER                          PIC X    VALUE SPACE.
    82     12  SM-TIME                         PIC 99.99.
    83
    84*    COPY ELCSCRTY.
    85******************************************************************
    86*                                                                *
    87*                                                                *
    88*                            ELCSCRTY                            *
    89*                            VMOD=2.001                          *
    90*                                                                *
    91*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    92*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    93*        SAVED IN PI-SECURITY-ADDRESS.                           *
    94*                                                                *
    95******************************************************************
    96 01  SECURITY-CONTROL.
    97     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    98     12  FILLER                       PIC XX    VALUE 'SC'.
    99     12  SC-CREDIT-CODES.
   100         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   101             20  SC-CREDIT-DISPLAY    PIC X.
   102             20  SC-CREDIT-UPDATE     PIC X.
   103     12  SC-CLAIMS-CODES.
   104         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL609.cbl
   105             20  SC-CLAIMS-DISPLAY    PIC X.
   106             20  SC-CLAIMS-UPDATE     PIC X.
   107 01  WS-DATE-AREA.
   108     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   109    05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   110 01  FILLER                          COMP-3.
   111     05  WS-RECORD-COUNT             PIC S9(3)   VALUE ZERO.
   112     05  WS-READNEXT-SW              PIC S9      VALUE ZERO.
   113     05  WS-LAST-ERROR-COUNT         PIC S9(3)   VALUE ZERO.
   114     05  WS-UPDATE-SW                PIC S9      VALUE ZERO.
   115     05  WS-COMPLETED-SUCCESSFUL     PIC S9      VALUE ZERO.
   116       88  TRANSACTION-SUCCESSFUL                    VALUE +1.
   117       88  INITIAL-TRANSACTION                       VALUE +2.
   118       88  CHANGE-SUCCESSFUL                         VALUE +3.
   119     05  TIME-IN                     PIC S9(7)   VALUE ZERO.
   120     05  TIME-OUT                    REDEFINES
   121         TIME-IN                     PIC S9(3)V9(4).
   122 01  FILLER                          COMP SYNC.
   123     05  WS-INDEX                    PIC S9(4)   VALUE ZERO.
   124     05  WS-JOURNAL-FILE-ID          PIC S9(4)   VALUE +1.
   125     05  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +773.
   126     05  ELCIIR-LENGTH               PIC S9(4)   VALUE +100.
   127     05  GETMAIN-SPACE               PIC  X      VALUE SPACE.
   128 01  FILLER.
   129     05  DEEDIT-FIELD        PIC  X(10).
   130     05  DEEDIT-FIELD-V0  REDEFINES
   131         DEEDIT-FIELD        PIC S9(10).
   132     05  WS-RESPONSE             PIC S9(8)   COMP.
   133         88  RESP-NORMAL              VALUE +00.
   134         88  RESP-ERROR               VALUE +01.
   135         88  RESP-NOTFND              VALUE +13.
   136         88  RESP-NOTOPEN             VALUE +19.
   137         88  RESP-ENDFILE             VALUE +20.
   138     05  WS-CONTROL-PRIMARY.
   139         10  WS-COMPANY-CD           PIC X      VALUE SPACES.
   140         10  WS-INT-RATE-CODE        PIC XXX    VALUE SPACES.
   141     05  WS-MAPSET-NAME              PIC X(8)  VALUE 'EL609S'.
   142     05  WS-MAP-NAME                 PIC X(8)  VALUE 'EL609A'.
   143     05  FILLER                      REDEFINES
   144         WS-MAP-NAME.
   145         10  FILLER                  PIC XX.
   146         10  WS-MAP-NUMBER           PIC X(4).
   147         10  FILLER                  PIC XX.
   148     05  THIS-PGM                    PIC X(8)  VALUE 'EL609'.
   149     05  WS-JOURNAL-TYPE-ID          PIC XX      VALUE 'EL'.
   150     05  WS-LOW-VALUES               PIC X VALUE LOW-VALUES.
   151     05  WS-SPACE                    PIC X       VALUE SPACE.
   152     05  WS-TRANS-ID                 PIC X(4)    VALUE 'EXAE'.
   153     05  WS-TEMP-STORAGE-KEY.
   154         10  WS-TS-TERM-ID           PIC X(4)    VALUE 'XXXX'.
   155         10  FILLER                  PIC X(4)    VALUE '609'.
   156     05  WS-ERROR-MESSAGE-AREA.
   157         10  ER-0000                 PIC 9(4)   VALUE 0000.
   158         10  ER-0004                 PIC 9(4)   VALUE 0004.
   159         10  ER-0006                 PIC 9(4)   VALUE 0006.
   160         10  ER-0008                 PIC 9(4)   VALUE 0008.
   161         10  ER-0023                 PIC 9(4)   VALUE 0023.
   162         10  ER-0029                 PIC 9(4)   VALUE 0029.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL609.cbl
   163         10  ER-0070                 PIC 9(4)   VALUE 0070.
   164         10  ER-0150                 PIC 9(4)   VALUE 0150.
   165         10  ER-0491                 PIC 9(4)   VALUE 0491.
   166         10  ER-1079                 PIC 9(4)   VALUE 1079.
   167         10  ER-1257                 PIC 9(4)   VALUE 1257.
   168         10  ER-1258                 PIC 9(4)   VALUE 1258.
   169         10  ER-2261                 PIC 9(4)   VALUE 2261.
   170         10  ER-3800                 PIC 9(4)   VALUE 3800.
   171         10  ER-3801                 PIC 9(4)   VALUE 3801.
   172         10  ER-3802                 PIC 9(4)   VALUE 3802.
   173         10  ER-3803                 PIC 9(4)   VALUE 3803.
   174         10  ER-3804                 PIC 9(4)   VALUE 3804.
   175         10  ER-3805                 PIC 9(4)   VALUE 3805.
   176         10  ER-3806                 PIC 9(4)   VALUE 3806.
   177         10  ER-3807                 PIC 9(4)   VALUE 3807.
   178         10  ER-3810                 PIC 9(4)   VALUE 3810.
   179         10  ER-7220                 PIC 9(4)   VALUE 7220.
   180         10  ER-7698                 PIC 9(4)   VALUE 7698.
   181         10  ER-9999                 PIC 9(4)   VALUE 9999.
   182*    COPY ELCINTF.
   183******************************************************************
   184*                                                                *
   185*                                                                *
   186*                            ELCINTF.                            *
   187*                            VMOD=2.017                          *
   188*                                                                *
   189*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   190*                                                                *
   191*       LENGTH = 1024                                            *
   192*                                                                *
   193******************************************************************
   194 01  PROGRAM-INTERFACE-BLOCK.
   195     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   196     12  PI-CALLING-PROGRAM              PIC X(8).
   197     12  PI-SAVED-PROGRAM-1              PIC X(8).
   198     12  PI-SAVED-PROGRAM-2              PIC X(8).
   199     12  PI-SAVED-PROGRAM-3              PIC X(8).
   200     12  PI-SAVED-PROGRAM-4              PIC X(8).
   201     12  PI-SAVED-PROGRAM-5              PIC X(8).
   202     12  PI-SAVED-PROGRAM-6              PIC X(8).
   203     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   204     12  PI-COMPANY-ID                   PIC XXX.
   205     12  PI-COMPANY-CD                   PIC X.
   206
   207     12  PI-COMPANY-PASSWORD             PIC X(8).
   208
   209     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   210
   211     12  PI-CONTROL-IN-PROGRESS.
   212         16  PI-CARRIER                  PIC X.
   213         16  PI-GROUPING                 PIC X(6).
   214         16  PI-STATE                    PIC XX.
   215         16  PI-ACCOUNT                  PIC X(10).
   216         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   217                                         PIC X(10).
   218         16  PI-CLAIM-CERT-GRP.
   219             20  PI-CLAIM-NO             PIC X(7).
   220             20  PI-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL609.cbl
   221                 25  PI-CERT-PRIME       PIC X(10).
   222                 25  PI-CERT-SFX         PIC X.
   223             20  PI-CERT-EFF-DT          PIC XX.
   224         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   225             20  PI-PLAN-CODE            PIC X(2).
   226             20  PI-REVISION-NUMBER      PIC X(3).
   227             20  PI-PLAN-EFF-DT          PIC X(2).
   228             20  PI-PLAN-EXP-DT          PIC X(2).
   229             20  FILLER                  PIC X(11).
   230         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   231             20  PI-OE-REFERENCE-1.
   232                 25  PI-OE-REF-1-PRIME   PIC X(18).
   233                 25  PI-OE-REF-1-SUFF    PIC XX.
   234
   235     12  PI-SESSION-IN-PROGRESS          PIC X.
   236         88  CLAIM-SESSION                   VALUE '1'.
   237         88  CREDIT-SESSION                  VALUE '2'.
   238         88  WARRANTY-SESSION                VALUE '3'.
   239         88  MORTGAGE-SESSION                VALUE '4'.
   240         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   241
   242
   243*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   244
   245     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   246     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   247
   248     12  PI-CREDIT-USER                  PIC X.
   249         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   250         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   251
   252     12  PI-CLAIM-USER                   PIC X.
   253         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   254         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   255
   256     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   257         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   258         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   259         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   260         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   261         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   262
   263     12  PI-PROCESSOR-ID                 PIC X(4).
   264
   265     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   266
   267     12  PI-MEMBER-CAPTION               PIC X(10).
   268
   269     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   270         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   271
   272     12  PI-LIFE-OVERRIDE-L1             PIC X.
   273     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   274     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   275     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   276
   277     12  PI-AH-OVERRIDE-L1               PIC X.
   278     12  PI-AH-OVERRIDE-L2               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL609.cbl
   279     12  PI-AH-OVERRIDE-L6               PIC X(6).
   280     12  PI-AH-OVERRIDE-L12              PIC X(12).
   281
   282     12  PI-NEW-SYSTEM                   PIC X(2).
   283
   284     12  PI-PRIMARY-CERT-NO              PIC X(11).
   285     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   286         88  PI-USES-PAID-TO                 VALUE '1'.
   287     12  PI-CRDTCRD-SYSTEM.
   288         16  PI-CRDTCRD-USER             PIC X.
   289             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   290             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   291         16  PI-CC-MONTH-END-DT          PIC XX.
   292     12  PI-PROCESSOR-PRINTER            PIC X(4).
   293
   294     12  PI-OE-REFERENCE-2.
   295         16  PI-OE-REF-2-PRIME           PIC X(10).
   296         16  PI-OE-REF-2-SUFF            PIC X.
   297
   298     12  PI-REM-TRM-CALC-OPTION          PIC X.
   299
   300     12  PI-LANGUAGE-TYPE                PIC X.
   301             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   302             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   303             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   304
   305     12  PI-POLICY-LINKAGE-IND           PIC X.
   306         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   307         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   308                                                   LOW-VALUES.
   309
   310     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   311     12  PI-CLAIM-PW-SESSION             PIC X(1).
   312         88  PI-CLAIM-CREDIT                 VALUE '1'.
   313         88  PI-CLAIM-CONVEN                 VALUE '2'.
   314     12  FILLER                          PIC X(4).
   315
   316     12  PI-SYSTEM-LEVEL                 PIC X(145).
   317
   318     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   319         PI-SYSTEM-LEVEL.
   320
   321         16  PI-ENTRY-CODES.
   322             20  PI-ENTRY-CD-1           PIC X.
   323             20  PI-ENTRY-CD-2           PIC X.
   324
   325         16  PI-RETURN-CODES.
   326             20  PI-RETURN-CD-1          PIC X.
   327             20  PI-RETURN-CD-2          PIC X.
   328
   329         16  PI-UPDATE-STATUS-SAVE.
   330             20  PI-UPDATE-BY            PIC X(4).
   331             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   332
   333         16  PI-LOWER-CASE-LETTERS       PIC X.
   334             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   335
   336*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL609.cbl
   337*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   338*            88  CARRIER-CLM-CNTL            VALUE '2'.
   339
   340         16  PI-CERT-ACCESS-CONTROL      PIC X.
   341             88  ST-ACCNT-CNTL               VALUE ' '.
   342             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   343             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   344             88  ACCNT-CNTL                  VALUE '3'.
   345             88  CARR-ACCNT-CNTL             VALUE '4'.
   346
   347         16  PI-PROCESSOR-CAP-LIST.
   348             20  PI-SYSTEM-CONTROLS.
   349                24 PI-SYSTEM-DISPLAY     PIC X.
   350                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   351                24 PI-SYSTEM-MODIFY      PIC X.
   352                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   353             20  FILLER                  PIC XX.
   354             20  PI-DISPLAY-CAP          PIC X.
   355                 88  DISPLAY-CAP             VALUE 'Y'.
   356             20  PI-MODIFY-CAP           PIC X.
   357                 88  MODIFY-CAP              VALUE 'Y'.
   358             20  PI-MSG-AT-LOGON-CAP     PIC X.
   359                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   360             20  PI-FORCE-CAP            PIC X.
   361                 88  FORCE-CAP               VALUE 'Y'.
   362
   363         16  PI-PROGRAM-CONTROLS.
   364             20  PI-PGM-PRINT-OPT        PIC X.
   365             20  PI-PGM-FORMAT-OPT       PIC X.
   366             20  PI-PGM-PROCESS-OPT      PIC X.
   367             20  PI-PGM-TOTALS-OPT       PIC X.
   368
   369         16  PI-HELP-INTERFACE.
   370             20  PI-LAST-ERROR-NO        PIC X(4).
   371             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   372
   373         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   374             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   375
   376         16  PI-CR-CONTROL-IN-PROGRESS.
   377             20  PI-CR-CARRIER           PIC X.
   378             20  PI-CR-GROUPING          PIC X(6).
   379             20  PI-CR-STATE             PIC XX.
   380             20  PI-CR-ACCOUNT           PIC X(10).
   381             20  PI-CR-FIN-RESP          PIC X(10).
   382             20  PI-CR-TYPE              PIC X.
   383
   384         16  PI-CR-BATCH-NUMBER          PIC X(6).
   385
   386         16  PI-CR-MONTH-END-DT          PIC XX.
   387
   388         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   389             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   390             88  PI-ZERO-CARRIER             VALUE '1'.
   391             88  PI-ZERO-GROUPING            VALUE '2'.
   392             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   393
   394         16  PI-CARRIER-SECURITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL609.cbl
   395             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   396
   397         16  PI-ACCOUNT-SECURITY         PIC X(10).
   398             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   399             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   400
   401         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   402             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   403                                         INDEXED BY PI-ACCESS-NDX
   404                                         PIC X.
   405
   406         16  PI-GA-BILLING-CONTROL       PIC X.
   407             88  PI-GA-BILLING               VALUE '1'.
   408
   409         16  PI-MAIL-PROCESSING          PIC X.
   410             88  PI-MAIL-YES                 VALUE 'Y'.
   411
   412         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   413
   414         16  PI-AR-SYSTEM.
   415             20  PI-AR-PROCESSING-CNTL   PIC X.
   416                 88  PI-AR-PROCESSING        VALUE 'Y'.
   417             20  PI-AR-SUMMARY-CODE      PIC X(6).
   418             20  PI-AR-MONTH-END-DT      PIC XX.
   419
   420         16  PI-MP-SYSTEM.
   421             20  PI-MORTGAGE-USER            PIC X.
   422                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   423                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   424             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   425                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   426                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   427                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   428                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   429                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   430             20  PI-MP-MONTH-END-DT          PIC XX.
   431             20  PI-MP-REFERENCE-NO.
   432                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   433                 24  PI-MP-REFERENCE-SFX     PIC XX.
   434
   435         16  PI-LABEL-CONTROL            PIC X(01).
   436             88  PI-CREATE-LABELS                    VALUE 'Y'.
   437             88  PI-BYPASS-LABELS                    VALUE 'N'.
   438
   439         16  PI-BILL-GROUPING-CODE       PIC X(01).
   440             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   441
   442         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   443             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   444             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   445
   446         16  FILLER                      PIC X(14).
   447
   448     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   449******************************************************************
   450     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
   451         16  PI-1ST-TIME-SW          PIC S9     COMP-3.
   452         16  PI-MODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL609.cbl
   453             88  ADD-FUNCTION         VALUE 'A'.
   454         16  PI-CI-RCODE             PIC XXX.
   455         16  PI-CI-TOP-KEY           PIC X(4).
   456         16  PI-CI-BOT-KEY           PIC X(4).
   457         16  PI-CI-KEYS OCCURS 10.
   458             20  PI-CI-KEY           PIC X(4).
   459         16  PI-LAST-BENEFIT-NUMBER  PIC XX.
   460         16  PI-NEXT-BENEFIT-NUMBER  PIC XX.
   461         16  PI-LINE-COUNT           PIC S9(3)  COMP-3.
   462         16  PI-BROWSE-SW            PIC S9     COMP-3.
   463         16  PI-SHOW-SW              PIC S9     COMP-3.
   464         16  PI-CHANGE-SW            PIC S9     COMP-3.
   465         16  FILLER                  PIC X(553).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL609.cbl
   467*    COPY EL609S.
   468 01  EL609AI.
   469     05  FILLER            PIC  X(0012).
   470*    -------------------------------
   471     05  ADATEL PIC S9(0004) COMP.
   472     05  ADATEF PIC  X(0001).
   473     05  FILLER REDEFINES ADATEF.
   474         10  ADATEA PIC  X(0001).
   475     05  ADATEI PIC  X(0008).
   476*    -------------------------------
   477     05  ATIMEL PIC S9(0004) COMP.
   478     05  ATIMEF PIC  X(0001).
   479     05  FILLER REDEFINES ATIMEF.
   480         10  ATIMEA PIC  X(0001).
   481     05  ATIMEI PIC  X(0005).
   482*    -------------------------------
   483     05  AMAINTL PIC S9(0004) COMP.
   484     05  AMAINTF PIC  X(0001).
   485     05  FILLER REDEFINES AMAINTF.
   486         10  AMAINTA PIC  X(0001).
   487     05  AMAINTI PIC  X(0001).
   488*    -------------------------------
   489     05  RCODE01L PIC S9(0004) COMP.
   490     05  RCODE01F PIC  X(0001).
   491     05  FILLER REDEFINES RCODE01F.
   492         10  RCODE01A PIC  X(0001).
   493     05  RCODE01I PIC  X(0003).
   494*    -------------------------------
   495     05  DESC01L PIC S9(0004) COMP.
   496     05  DESC01F PIC  X(0001).
   497     05  FILLER REDEFINES DESC01F.
   498         10  DESC01A PIC  X(0001).
   499     05  DESC01I PIC  X(0025).
   500*    -------------------------------
   501     05  RATE01L PIC S9(0004) COMP.
   502     05  RATE01F PIC  X(0001).
   503     05  FILLER REDEFINES RATE01F.
   504         10  RATE01A PIC  X(0001).
   505     05  RATE01I PIC  X(0007).
   506*    -------------------------------
   507     05  RCODE02L PIC S9(0004) COMP.
   508     05  RCODE02F PIC  X(0001).
   509     05  FILLER REDEFINES RCODE02F.
   510         10  RCODE02A PIC  X(0001).
   511     05  RCODE02I PIC  X(0003).
   512*    -------------------------------
   513     05  DESC02L PIC S9(0004) COMP.
   514     05  DESC02F PIC  X(0001).
   515     05  FILLER REDEFINES DESC02F.
   516         10  DESC02A PIC  X(0001).
   517     05  DESC02I PIC  X(0025).
   518*    -------------------------------
   519     05  RATE02L PIC S9(0004) COMP.
   520     05  RATE02F PIC  X(0001).
   521     05  FILLER REDEFINES RATE02F.
   522         10  RATE02A PIC  X(0001).
   523     05  RATE02I PIC  X(0007).
   524*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL609.cbl
   525     05  RCODE03L PIC S9(0004) COMP.
   526     05  RCODE03F PIC  X(0001).
   527     05  FILLER REDEFINES RCODE03F.
   528         10  RCODE03A PIC  X(0001).
   529     05  RCODE03I PIC  X(0003).
   530*    -------------------------------
   531     05  DESC03L PIC S9(0004) COMP.
   532     05  DESC03F PIC  X(0001).
   533     05  FILLER REDEFINES DESC03F.
   534         10  DESC03A PIC  X(0001).
   535     05  DESC03I PIC  X(0025).
   536*    -------------------------------
   537     05  RATE03L PIC S9(0004) COMP.
   538     05  RATE03F PIC  X(0001).
   539     05  FILLER REDEFINES RATE03F.
   540         10  RATE03A PIC  X(0001).
   541     05  RATE03I PIC  X(0007).
   542*    -------------------------------
   543     05  RCODE04L PIC S9(0004) COMP.
   544     05  RCODE04F PIC  X(0001).
   545     05  FILLER REDEFINES RCODE04F.
   546         10  RCODE04A PIC  X(0001).
   547     05  RCODE04I PIC  X(0003).
   548*    -------------------------------
   549     05  DESC04L PIC S9(0004) COMP.
   550     05  DESC04F PIC  X(0001).
   551     05  FILLER REDEFINES DESC04F.
   552         10  DESC04A PIC  X(0001).
   553     05  DESC04I PIC  X(0025).
   554*    -------------------------------
   555     05  RATE04L PIC S9(0004) COMP.
   556     05  RATE04F PIC  X(0001).
   557     05  FILLER REDEFINES RATE04F.
   558         10  RATE04A PIC  X(0001).
   559     05  RATE04I PIC  X(0007).
   560*    -------------------------------
   561     05  RCODE05L PIC S9(0004) COMP.
   562     05  RCODE05F PIC  X(0001).
   563     05  FILLER REDEFINES RCODE05F.
   564         10  RCODE05A PIC  X(0001).
   565     05  RCODE05I PIC  X(0003).
   566*    -------------------------------
   567     05  DESC05L PIC S9(0004) COMP.
   568     05  DESC05F PIC  X(0001).
   569     05  FILLER REDEFINES DESC05F.
   570         10  DESC05A PIC  X(0001).
   571     05  DESC05I PIC  X(0025).
   572*    -------------------------------
   573     05  RATE05L PIC S9(0004) COMP.
   574     05  RATE05F PIC  X(0001).
   575     05  FILLER REDEFINES RATE05F.
   576         10  RATE05A PIC  X(0001).
   577     05  RATE05I PIC  X(0007).
   578*    -------------------------------
   579     05  RCODE06L PIC S9(0004) COMP.
   580     05  RCODE06F PIC  X(0001).
   581     05  FILLER REDEFINES RCODE06F.
   582         10  RCODE06A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL609.cbl
   583     05  RCODE06I PIC  X(0003).
   584*    -------------------------------
   585     05  DESC06L PIC S9(0004) COMP.
   586     05  DESC06F PIC  X(0001).
   587     05  FILLER REDEFINES DESC06F.
   588         10  DESC06A PIC  X(0001).
   589     05  DESC06I PIC  X(0025).
   590*    -------------------------------
   591     05  RATE06L PIC S9(0004) COMP.
   592     05  RATE06F PIC  X(0001).
   593     05  FILLER REDEFINES RATE06F.
   594         10  RATE06A PIC  X(0001).
   595     05  RATE06I PIC  X(0007).
   596*    -------------------------------
   597     05  RCODE07L PIC S9(0004) COMP.
   598     05  RCODE07F PIC  X(0001).
   599     05  FILLER REDEFINES RCODE07F.
   600         10  RCODE07A PIC  X(0001).
   601     05  RCODE07I PIC  X(0003).
   602*    -------------------------------
   603     05  DESC07L PIC S9(0004) COMP.
   604     05  DESC07F PIC  X(0001).
   605     05  FILLER REDEFINES DESC07F.
   606         10  DESC07A PIC  X(0001).
   607     05  DESC07I PIC  X(0025).
   608*    -------------------------------
   609     05  RATE07L PIC S9(0004) COMP.
   610     05  RATE07F PIC  X(0001).
   611     05  FILLER REDEFINES RATE07F.
   612         10  RATE07A PIC  X(0001).
   613     05  RATE07I PIC  X(0007).
   614*    -------------------------------
   615     05  RCODE08L PIC S9(0004) COMP.
   616     05  RCODE08F PIC  X(0001).
   617     05  FILLER REDEFINES RCODE08F.
   618         10  RCODE08A PIC  X(0001).
   619     05  RCODE08I PIC  X(0003).
   620*    -------------------------------
   621     05  DESC08L PIC S9(0004) COMP.
   622     05  DESC08F PIC  X(0001).
   623     05  FILLER REDEFINES DESC08F.
   624         10  DESC08A PIC  X(0001).
   625     05  DESC08I PIC  X(0025).
   626*    -------------------------------
   627     05  RATE08L PIC S9(0004) COMP.
   628     05  RATE08F PIC  X(0001).
   629     05  FILLER REDEFINES RATE08F.
   630         10  RATE08A PIC  X(0001).
   631     05  RATE08I PIC  X(0007).
   632*    -------------------------------
   633     05  RCODE09L PIC S9(0004) COMP.
   634     05  RCODE09F PIC  X(0001).
   635     05  FILLER REDEFINES RCODE09F.
   636         10  RCODE09A PIC  X(0001).
   637     05  RCODE09I PIC  X(0003).
   638*    -------------------------------
   639     05  DESC09L PIC S9(0004) COMP.
   640     05  DESC09F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL609.cbl
   641     05  FILLER REDEFINES DESC09F.
   642         10  DESC09A PIC  X(0001).
   643     05  DESC09I PIC  X(0025).
   644*    -------------------------------
   645     05  RATE09L PIC S9(0004) COMP.
   646     05  RATE09F PIC  X(0001).
   647     05  FILLER REDEFINES RATE09F.
   648         10  RATE09A PIC  X(0001).
   649     05  RATE09I PIC  X(0007).
   650*    -------------------------------
   651     05  RCODE10L PIC S9(0004) COMP.
   652     05  RCODE10F PIC  X(0001).
   653     05  FILLER REDEFINES RCODE10F.
   654         10  RCODE10A PIC  X(0001).
   655     05  RCODE10I PIC  X(0003).
   656*    -------------------------------
   657     05  DESC10L PIC S9(0004) COMP.
   658     05  DESC10F PIC  X(0001).
   659     05  FILLER REDEFINES DESC10F.
   660         10  DESC10A PIC  X(0001).
   661     05  DESC10I PIC  X(0025).
   662*    -------------------------------
   663     05  RATE10L PIC S9(0004) COMP.
   664     05  RATE10F PIC  X(0001).
   665     05  FILLER REDEFINES RATE10F.
   666         10  RATE10A PIC  X(0001).
   667     05  RATE10I PIC  X(0007).
   668*    -------------------------------
   669     05  AEMSG1L PIC S9(0004) COMP.
   670     05  AEMSG1F PIC  X(0001).
   671     05  FILLER REDEFINES AEMSG1F.
   672         10  AEMSG1A PIC  X(0001).
   673     05  AEMSG1I PIC  X(0079).
   674*    -------------------------------
   675     05  AEMSG2L PIC S9(0004) COMP.
   676     05  AEMSG2F PIC  X(0001).
   677     05  FILLER REDEFINES AEMSG2F.
   678         10  AEMSG2A PIC  X(0001).
   679     05  AEMSG2I PIC  X(0079).
   680*    -------------------------------
   681     05  APFKL PIC S9(0004) COMP.
   682     05  APFKF PIC  X(0001).
   683     05  FILLER REDEFINES APFKF.
   684         10  APFKA PIC  X(0001).
   685     05  APFKI PIC  S99.
   686 01  EL609AO REDEFINES EL609AI.
   687     05  FILLER            PIC  X(0012).
   688*    -------------------------------
   689     05  FILLER            PIC  X(0003).
   690     05  ADATEO PIC  X(0008).
   691*    -------------------------------
   692     05  FILLER            PIC  X(0003).
   693     05  ATIMEO PIC  99.99.
   694*    -------------------------------
   695     05  FILLER            PIC  X(0003).
   696     05  AMAINTO PIC  X(0001).
   697*    -------------------------------
   698     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL609.cbl
   699     05  RCODE01O PIC  X(0003).
   700*    -------------------------------
   701     05  FILLER            PIC  X(0003).
   702     05  DESC01O PIC  X(0025).
   703*    -------------------------------
   704     05  FILLER            PIC  X(0003).
   705     05  RATE01O PIC  X(0007).
   706*    -------------------------------
   707     05  FILLER            PIC  X(0003).
   708     05  RCODE02O PIC  X(0003).
   709*    -------------------------------
   710     05  FILLER            PIC  X(0003).
   711     05  DESC02O PIC  X(0025).
   712*    -------------------------------
   713     05  FILLER            PIC  X(0003).
   714     05  RATE02O PIC  X(0007).
   715*    -------------------------------
   716     05  FILLER            PIC  X(0003).
   717     05  RCODE03O PIC  X(0003).
   718*    -------------------------------
   719     05  FILLER            PIC  X(0003).
   720     05  DESC03O PIC  X(0025).
   721*    -------------------------------
   722     05  FILLER            PIC  X(0003).
   723     05  RATE03O PIC  X(0007).
   724*    -------------------------------
   725     05  FILLER            PIC  X(0003).
   726     05  RCODE04O PIC  X(0003).
   727*    -------------------------------
   728     05  FILLER            PIC  X(0003).
   729     05  DESC04O PIC  X(0025).
   730*    -------------------------------
   731     05  FILLER            PIC  X(0003).
   732     05  RATE04O PIC  X(0007).
   733*    -------------------------------
   734     05  FILLER            PIC  X(0003).
   735     05  RCODE05O PIC  X(0003).
   736*    -------------------------------
   737     05  FILLER            PIC  X(0003).
   738     05  DESC05O PIC  X(0025).
   739*    -------------------------------
   740     05  FILLER            PIC  X(0003).
   741     05  RATE05O PIC  X(0007).
   742*    -------------------------------
   743     05  FILLER            PIC  X(0003).
   744     05  RCODE06O PIC  X(0003).
   745*    -------------------------------
   746     05  FILLER            PIC  X(0003).
   747     05  DESC06O PIC  X(0025).
   748*    -------------------------------
   749     05  FILLER            PIC  X(0003).
   750     05  RATE06O PIC  X(0007).
   751*    -------------------------------
   752     05  FILLER            PIC  X(0003).
   753     05  RCODE07O PIC  X(0003).
   754*    -------------------------------
   755     05  FILLER            PIC  X(0003).
   756     05  DESC07O PIC  X(0025).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL609.cbl
   757*    -------------------------------
   758     05  FILLER            PIC  X(0003).
   759     05  RATE07O PIC  X(0007).
   760*    -------------------------------
   761     05  FILLER            PIC  X(0003).
   762     05  RCODE08O PIC  X(0003).
   763*    -------------------------------
   764     05  FILLER            PIC  X(0003).
   765     05  DESC08O PIC  X(0025).
   766*    -------------------------------
   767     05  FILLER            PIC  X(0003).
   768     05  RATE08O PIC  X(0007).
   769*    -------------------------------
   770     05  FILLER            PIC  X(0003).
   771     05  RCODE09O PIC  X(0003).
   772*    -------------------------------
   773     05  FILLER            PIC  X(0003).
   774     05  DESC09O PIC  X(0025).
   775*    -------------------------------
   776     05  FILLER            PIC  X(0003).
   777     05  RATE09O PIC  X(0007).
   778*    -------------------------------
   779     05  FILLER            PIC  X(0003).
   780     05  RCODE10O PIC  X(0003).
   781*    -------------------------------
   782     05  FILLER            PIC  X(0003).
   783     05  DESC10O PIC  X(0025).
   784*    -------------------------------
   785     05  FILLER            PIC  X(0003).
   786     05  RATE10O PIC  X(0007).
   787*    -------------------------------
   788     05  FILLER            PIC  X(0003).
   789     05  AEMSG1O PIC  X(0079).
   790*    -------------------------------
   791     05  FILLER            PIC  X(0003).
   792     05  AEMSG2O PIC  X(0079).
   793*    -------------------------------
   794     05  FILLER            PIC  X(0003).
   795     05  APFKO PIC  X(0002).
   796*    -------------------------------
   797 01  EL609AO-R REDEFINES EL609AI.
   798     05  FILLER                      PIC X(35).
   799     05  WS-MAP-LINE                 OCCURS 10
   800                                     INDEXED BY M1.
   801         10  RCODEL                  PIC S9(4)  COMP.
   802         10  RCODEA                  PIC X.
   803         10  RCODEO                  PIC XXX.
   804         10  RCODEI                  REDEFINES
   805             RCODEO                  PIC XXX.
   806         10  DESCL                   PIC S9(4)   COMP.
   807         10  DESCLA                  PIC X.
   808         10  DESCO                   PIC X(25).
   809         10  DESCI                   REDEFINES
   810             DESCO                   PIC X(25).
   811         10  RATEL                   PIC S9(4)   COMP.
   812         10  RATEA                   PIC X.
   813         10  RATEO                   PIC 9.99999.
   814         10  RATEI                   REDEFINES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL609.cbl
   815             RATEO                   PIC 99V99999.
   816*    COPY ELCJPFX.
   817******************************************************************
   818*                                                                *
   819*                                                                *
   820*                            ELCJPFX.                            *
   821*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   822*                            VMOD=2.002                          *
   823*                                                                *
   824*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   825*                                                                *
   826*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   827*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   828*        ELCNTL - CONTROL FILE                                   *
   829*        ELMSTR - CLAIM MASTERS                                  *
   830*        ELTRLR - ACTIVITY TRAILERS                              *
   831*        ELCHKQ - CHECK QUE                                      *
   832******************************************************************
   833 01  JOURNAL-RECORD.
   834     12  JP-USER-ID                  PIC X(4).
   835     12  JP-FILE-ID                  PIC X(8).
   836     12  JP-PROGRAM-ID               PIC X(8).
   837     12  JP-RECORD-TYPE              PIC X.
   838         88 JP-ADD              VALUE 'A'.
   839         88 JP-BEFORE-CHANGE    VALUE 'B'.
   840         88 JP-AFTER-CHANGE     VALUE 'C'.
   841         88 JP-DELETE           VALUE 'D'.
   842         88 JP-GENERIC-DELETE   VALUE 'G'.
   843         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   844         88 JP-KEY-CHG-ADD      VALUE 'N'.
   845     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   846     12  JP-RECORD-AREA
   847
   848
   849                                     PIC X(750).
   850*    COPY ELCEMIB.
   851******************************************************************
   852*                                                                *
   853*                                                                *
   854*                            ELCEMIB.                            *
   855*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   856*                            VMOD=2.005                          *
   857*                                                                *
   858*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   859*                                                                *
   860******************************************************************
   861 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   862     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   863     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   864     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   865     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   866     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   867     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   868     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   869     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   870     12  EMI-SWITCH1             PIC X        VALUE '1'.
   871         88  EMI-NO-ERRORS                    VALUE '1'.
   872         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL609.cbl
   873         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   874     12  EMI-SWITCH2             PIC X        VALUE '1'.
   875         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   876     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   877         88  EMI-AREA1-EMPTY                  VALUE '1'.
   878         88  EMI-AREA1-FULL                   VALUE '2'.
   879     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   880         88  EMI-AREA2-EMPTY                  VALUE '1'.
   881         88  EMI-AREA2-FULL                   VALUE '2'.
   882     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   883         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   884         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   885         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   886         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   887         88  EMI-BYPASS-FATALS                VALUE 'X'.
   888     12  EMI-ERROR-LINES.
   889         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   890         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   891         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   892         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   893             20  EMI-ERR-CODES OCCURS 10 TIMES.
   894                 24  EMI-ERR-NUM         PIC X(4).
   895                 24  EMI-FILLER          PIC X.
   896                 24  EMI-SEV             PIC X.
   897                 24  FILLER              PIC X.
   898             20  FILLER                  PIC X(02).
   899     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   900         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   901             20  EMI-ERROR-NUMBER    PIC X(4).
   902             20  EMI-FILL            PIC X.
   903             20  EMI-SEVERITY        PIC X.
   904             20  FILLER              PIC X.
   905             20  EMI-ERROR-TEXT.
   906                 24  EMI-TEXT-VARIABLE   PIC X(10).
   907                 24  FILLER          PIC X(55).
   908     12  EMI-SEVERITY-SAVE           PIC X.
   909         88  EMI-NOTE                    VALUE 'N'.
   910         88  EMI-WARNING                 VALUE 'W'.
   911         88  EMI-FORCABLE                VALUE 'F'.
   912         88  EMI-FATAL                   VALUE 'X'.
   913     12  EMI-MESSAGE-FLAG            PIC X.
   914         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   915         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   916     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   917     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   918         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   919         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   920         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   921     12  FILLER                      PIC X(137)  VALUE SPACES.
   922     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   923     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   924     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   925     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   926*    COPY ELCDATE.
   927******************************************************************
   928*                                                                *
   929*                                                                *
   930*                            ELCDATE.                            *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL609.cbl
   931*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   932*                            VMOD=2.003
   933*                                                                *
   934*                                                                *
   935*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   936*                 LENGTH = 200                                   *
   937******************************************************************
   938
   939 01  DATE-CONVERSION-DATA.
   940     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   941     12  DC-OPTION-CODE                PIC X.
   942         88  BIN-TO-GREG                VALUE ' '.
   943         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   944         88  EDIT-GREG-TO-BIN           VALUE '2'.
   945         88  YMD-GREG-TO-BIN            VALUE '3'.
   946         88  MDY-GREG-TO-BIN            VALUE '4'.
   947         88  JULIAN-TO-BIN              VALUE '5'.
   948         88  BIN-PLUS-ELAPSED           VALUE '6'.
   949         88  FIND-CENTURY               VALUE '7'.
   950         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   951         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   952         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   953         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   954         88  JULIAN-TO-BIN-3            VALUE 'C'.
   955         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   956         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   957         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   958         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   959         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   960         88  CHECK-LEAP-YEAR            VALUE 'H'.
   961         88  BIN-3-TO-GREG              VALUE 'I'.
   962         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   963         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   964         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   965         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   966         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   967         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   968         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   969         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   970         88  THREE-CHARACTER-BIN
   971                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   972         88  GREGORIAN-TO-BIN
   973                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   974         88  BIN-TO-GREGORIAN
   975                  VALUES ' ' '1' 'I' '8' 'G'.
   976         88  JULIAN-TO-BINARY
   977                  VALUES '5' 'C' 'E' 'F'.
   978     12  DC-ERROR-CODE                 PIC X.
   979         88  NO-CONVERSION-ERROR        VALUE ' '.
   980         88  DATE-CONVERSION-ERROR
   981                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   982         88  DATE-IS-ZERO               VALUE '1'.
   983         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   984         88  DATE-IS-INVALID            VALUE '3'.
   985         88  DATE1-GREATER-DATE2        VALUE '4'.
   986         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   987         88  DATE-INVALID-OPTION        VALUE '9'.
   988         88  INVALID-CENTURY            VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL609.cbl
   989         88  ONLY-CENTURY               VALUE 'B'.
   990         88  ONLY-LEAP-YEAR             VALUE 'C'.
   991         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   992     12  DC-END-OF-MONTH               PIC X.
   993         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   994     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   995         88  USE-NORMAL-PROCESS         VALUE ' '.
   996         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   997         88  ADJUST-UP-100-YRS          VALUE '2'.
   998     12  FILLER                        PIC X.
   999     12  DC-CONVERSION-DATES.
  1000         16  DC-BIN-DATE-1             PIC XX.
  1001         16  DC-BIN-DATE-2             PIC XX.
  1002         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1003         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1004                       DC-GREG-DATE-1-EDIT.
  1005             20  DC-EDIT1-MONTH        PIC 99.
  1006             20  SLASH1-1              PIC X.
  1007             20  DC-EDIT1-DAY          PIC 99.
  1008             20  SLASH1-2              PIC X.
  1009             20  DC-EDIT1-YEAR         PIC 99.
  1010         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1011         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1012                     DC-GREG-DATE-2-EDIT.
  1013             20  DC-EDIT2-MONTH        PIC 99.
  1014             20  SLASH2-1              PIC X.
  1015             20  DC-EDIT2-DAY          PIC 99.
  1016             20  SLASH2-2              PIC X.
  1017             20  DC-EDIT2-YEAR         PIC 99.
  1018         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1019         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1020                     DC-GREG-DATE-1-YMD.
  1021             20  DC-YMD-YEAR           PIC 99.
  1022             20  DC-YMD-MONTH          PIC 99.
  1023             20  DC-YMD-DAY            PIC 99.
  1024         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1025         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1026                      DC-GREG-DATE-1-MDY.
  1027             20  DC-MDY-MONTH          PIC 99.
  1028             20  DC-MDY-DAY            PIC 99.
  1029             20  DC-MDY-YEAR           PIC 99.
  1030         16  DC-GREG-DATE-1-ALPHA.
  1031             20  DC-ALPHA-MONTH        PIC X(10).
  1032             20  DC-ALPHA-DAY          PIC 99.
  1033             20  FILLER                PIC XX.
  1034             20  DC-ALPHA-CENTURY.
  1035                 24 DC-ALPHA-CEN-N     PIC 99.
  1036             20  DC-ALPHA-YEAR         PIC 99.
  1037         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1038         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1039         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1040         16  DC-JULIAN-DATE            PIC 9(05).
  1041         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1042                                       PIC 9(05).
  1043         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1044             20  DC-JULIAN-YEAR        PIC 99.
  1045             20  DC-JULIAN-DAYS        PIC 999.
  1046         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL609.cbl
  1047         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1048         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1049     12  DATE-CONVERSION-VARIBLES.
  1050         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1051         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1052             20  FILLER                PIC 9(3).
  1053             20  HOLD-CEN-1-CCYY.
  1054                 24  HOLD-CEN-1-CC     PIC 99.
  1055                 24  HOLD-CEN-1-YY     PIC 99.
  1056             20  HOLD-CEN-1-MO         PIC 99.
  1057             20  HOLD-CEN-1-DA         PIC 99.
  1058         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1059             20  HOLD-CEN-1-R-MO       PIC 99.
  1060             20  HOLD-CEN-1-R-DA       PIC 99.
  1061             20  HOLD-CEN-1-R-CCYY.
  1062                 24  HOLD-CEN-1-R-CC   PIC 99.
  1063                 24  HOLD-CEN-1-R-YY   PIC 99.
  1064             20  FILLER                PIC 9(3).
  1065         16  HOLD-CENTURY-1-X.
  1066             20  FILLER                PIC X(3)  VALUE SPACES.
  1067             20  HOLD-CEN-1-X-CCYY.
  1068                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1069                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1070             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1071             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1072         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1073             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1074             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1075             20  HOLD-CEN-1-R-X-CCYY.
  1076                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1077                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1078             20  FILLER                PIC XXX.
  1079         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1080         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1081         16  DC-JULIAN-DATE-1          PIC 9(07).
  1082         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1083             20  DC-JULIAN-1-CCYY.
  1084                 24  DC-JULIAN-1-CC    PIC 99.
  1085                 24  DC-JULIAN-1-YR    PIC 99.
  1086             20  DC-JULIAN-DA-1        PIC 999.
  1087         16  DC-JULIAN-DATE-2          PIC 9(07).
  1088         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1089             20  DC-JULIAN-2-CCYY.
  1090                 24  DC-JULIAN-2-CC    PIC 99.
  1091                 24  DC-JULIAN-2-YR    PIC 99.
  1092             20  DC-JULIAN-DA-2        PIC 999.
  1093         16  DC-GREG-DATE-A-EDIT.
  1094             20  DC-EDITA-MONTH        PIC 99.
  1095             20  SLASHA-1              PIC X VALUE '/'.
  1096             20  DC-EDITA-DAY          PIC 99.
  1097             20  SLASHA-2              PIC X VALUE '/'.
  1098             20  DC-EDITA-CCYY.
  1099                 24  DC-EDITA-CENT     PIC 99.
  1100                 24  DC-EDITA-YEAR     PIC 99.
  1101         16  DC-GREG-DATE-B-EDIT.
  1102             20  DC-EDITB-MONTH        PIC 99.
  1103             20  SLASHB-1              PIC X VALUE '/'.
  1104             20  DC-EDITB-DAY          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL609.cbl
  1105             20  SLASHB-2              PIC X VALUE '/'.
  1106             20  DC-EDITB-CCYY.
  1107                 24  DC-EDITB-CENT     PIC 99.
  1108                 24  DC-EDITB-YEAR     PIC 99.
  1109         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1110         16  DC-GREG-DATE-CYMD-R REDEFINES
  1111                              DC-GREG-DATE-CYMD.
  1112             20  DC-CYMD-CEN           PIC 99.
  1113             20  DC-CYMD-YEAR          PIC 99.
  1114             20  DC-CYMD-MONTH         PIC 99.
  1115             20  DC-CYMD-DAY           PIC 99.
  1116         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1117         16  DC-GREG-DATE-MDCY-R REDEFINES
  1118                              DC-GREG-DATE-MDCY.
  1119             20  DC-MDCY-MONTH         PIC 99.
  1120             20  DC-MDCY-DAY           PIC 99.
  1121             20  DC-MDCY-CEN           PIC 99.
  1122             20  DC-MDCY-YEAR          PIC 99.
  1123    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1124        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1125    12  DC-EL310-DATE                  PIC X(21).
  1126    12  FILLER                         PIC X(28).
  1127*    COPY ELCLOGOF.
  1128******************************************************************
  1129*                                                                *
  1130*                                                                *
  1131*                            ELCLOGOF.                           *
  1132*                            VMOD=2.001                          *
  1133*                                                                *
  1134*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1135*                                                                *
  1136******************************************************************
  1137 01  CLASIC-LOGOFF.
  1138     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1139     12  LOGOFF-TEXT.
  1140         16  FILLER          PIC X(5)    VALUE SPACES.
  1141         16  LOGOFF-MSG.
  1142             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1143             20  FILLER      PIC X       VALUE SPACES.
  1144             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1145         16  FILLER          PIC X(80)
  1146           VALUE '* YOU ARE NOW LOGGED OFF'.
  1147         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1148         16  FILLER          PIC X       VALUE QUOTE.
  1149         16  LOGOFF-SYS-MSG  PIC X(17)
  1150           VALUE 'S CLAS-IC SYSTEM '.
  1151     12  TEXT-MESSAGES.
  1152         16  UNACCESS-MSG    PIC X(29)
  1153             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1154         16  PGMIDERR-MSG    PIC X(17)
  1155             VALUE 'PROGRAM NOT FOUND'.
  1156*    COPY ELCATTR.
  1157******************************************************************
  1158*                                                                *
  1159*                            ELCATTR.                            *
  1160*                            VMOD=2.001                          *
  1161*                                                                *
  1162*             LIST OF STANDARD ATTRIBUTE VALUES                  *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL609.cbl
  1163*                                                                *
  1164*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1165*                                                                *
  1166*                   POS 1   P=PROTECTED                          *
  1167*                           U=UNPROTECTED                        *
  1168*                           S=ASKIP                              *
  1169*                   POS 2   A=ALPHA/NUMERIC                      *
  1170*                           N=NUMERIC                            *
  1171*                   POS 3   N=NORMAL                             *
  1172*                           B=BRIGHT                             *
  1173*                           D=DARK                               *
  1174*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1175*                           OF=MODIFIED DATA TAG OFF             *
  1176*                                                                *
  1177*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1178******************************************************************
  1179 01  ATTRIBUTE-LIST.
  1180     12  AL-PABOF            PIC X       VALUE 'Y'.
  1181     12  AL-PABON            PIC X       VALUE 'Z'.
  1182     12  AL-PADOF            PIC X       VALUE '%'.
  1183     12  AL-PADON            PIC X       VALUE '_'.
  1184     12  AL-PANOF            PIC X       VALUE '-'.
  1185     12  AL-PANON            PIC X       VALUE '/'.
  1186     12  AL-SABOF            PIC X       VALUE '8'.
  1187     12  AL-SABON            PIC X       VALUE '9'.
  1188     12  AL-SADOF            PIC X       VALUE '@'.
  1189     12  AL-SADON            PIC X       VALUE QUOTE.
  1190     12  AL-SANOF            PIC X       VALUE '0'.
  1191     12  AL-SANON            PIC X       VALUE '1'.
  1192     12  AL-UABOF            PIC X       VALUE 'H'.
  1193     12  AL-UABON            PIC X       VALUE 'I'.
  1194     12  AL-UADOF            PIC X       VALUE '<'.
  1195     12  AL-UADON            PIC X       VALUE '('.
  1196     12  AL-UANOF            PIC X       VALUE ' '.
  1197     12  AL-UANON            PIC X       VALUE 'A'.
  1198     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1199     12  AL-UNBON            PIC X       VALUE 'R'.
  1200     12  AL-UNDOF            PIC X       VALUE '*'.
  1201     12  AL-UNDON            PIC X       VALUE ')'.
  1202     12  AL-UNNOF            PIC X       VALUE '&'.
  1203     12  AL-UNNON            PIC X       VALUE 'J'.
  1204*    COPY ELCAID.
  1205******************************************************************
  1206*                                                                *
  1207*                            ELCAID.                             *
  1208*                            VMOD=2.001                          *
  1209*                                                                *
  1210*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1211*                                                                *
  1212*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1213*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1214******************************************************************
  1215
  1216 01  DFHAID.
  1217   02  DFHNULL   PIC  X  VALUE  ' '.
  1218   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1219   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1220   02  DFHPEN    PIC  X  VALUE  '='.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL609.cbl
  1221   02  DFHOPID   PIC  X  VALUE  'W'.
  1222   02  DFHPA1    PIC  X  VALUE  '%'.
  1223   02  DFHPA2    PIC  X  VALUE  '>'.
  1224   02  DFHPA3    PIC  X  VALUE  ','.
  1225   02  DFHPF1    PIC  X  VALUE  '1'.
  1226   02  DFHPF2    PIC  X  VALUE  '2'.
  1227   02  DFHPF3    PIC  X  VALUE  '3'.
  1228   02  DFHPF4    PIC  X  VALUE  '4'.
  1229   02  DFHPF5    PIC  X  VALUE  '5'.
  1230   02  DFHPF6    PIC  X  VALUE  '6'.
  1231   02  DFHPF7    PIC  X  VALUE  '7'.
  1232   02  DFHPF8    PIC  X  VALUE  '8'.
  1233   02  DFHPF9    PIC  X  VALUE  '9'.
  1234   02  DFHPF10   PIC  X  VALUE  ':'.
  1235   02  DFHPF11   PIC  X  VALUE  '#'.
  1236   02  DFHPF12   PIC  X  VALUE  '@'.
  1237   02  DFHPF13   PIC  X  VALUE  'A'.
  1238   02  DFHPF14   PIC  X  VALUE  'B'.
  1239   02  DFHPF15   PIC  X  VALUE  'C'.
  1240   02  DFHPF16   PIC  X  VALUE  'D'.
  1241   02  DFHPF17   PIC  X  VALUE  'E'.
  1242   02  DFHPF18   PIC  X  VALUE  'F'.
  1243   02  DFHPF19   PIC  X  VALUE  'G'.
  1244   02  DFHPF20   PIC  X  VALUE  'H'.
  1245   02  DFHPF21   PIC  X  VALUE  'I'.
  1246*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1247   02  DFHPF22   PIC  X  VALUE  '['.
  1248   02  DFHPF23   PIC  X  VALUE  '.'.
  1249   02  DFHPF24   PIC  X  VALUE  '<'.
  1250   02  DFHMSRE   PIC  X  VALUE  'X'.
  1251   02  DFHSTRF   PIC  X  VALUE  'h'.
  1252   02  DFHTRIG   PIC  X  VALUE  '"'.
  1253 01  FILLER    REDEFINES DFHAID.
  1254     05  FILLER                      PIC X(8).
  1255     05  PF-VALUES                   PIC X
  1256         OCCURS 24 TIMES.
  1257****************************************************************
  1258*
  1259* Copyright (c) 2007 by Clerity Solutions, Inc.
  1260* All rights reserved.
  1261*
  1262****************************************************************
  1263 01  DFHEIV.
  1264   02  DFHEIV0               PIC X(35).
  1265   02  DFHEIV1               PIC X(08).
  1266   02  DFHEIV2               PIC X(08).
  1267   02  DFHEIV3               PIC X(08).
  1268   02  DFHEIV4               PIC X(06).
  1269   02  DFHEIV5               PIC X(04).
  1270   02  DFHEIV6               PIC X(04).
  1271   02  DFHEIV7               PIC X(02).
  1272   02  DFHEIV8               PIC X(02).
  1273   02  DFHEIV9               PIC X(01).
  1274   02  DFHEIV10              PIC S9(7) COMP-3.
  1275   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1276   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1277   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1278   02  DFHEIV14              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL609.cbl
  1279   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1280   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1281   02  DFHEIV17              PIC X(04).
  1282   02  DFHEIV18              PIC X(04).
  1283   02  DFHEIV19              PIC X(04).
  1284   02  DFHEIV20              USAGE IS POINTER.
  1285   02  DFHEIV21              USAGE IS POINTER.
  1286   02  DFHEIV22              USAGE IS POINTER.
  1287   02  DFHEIV23              USAGE IS POINTER.
  1288   02  DFHEIV24              USAGE IS POINTER.
  1289   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1290   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1291   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1292   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1293   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1294   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1295   02  FILLER                PIC X(02).
  1296   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1297   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1298   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1299   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1300   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1301 LINKAGE  SECTION.
  1302*****************************************************************
  1303*                                                               *
  1304* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1305* All rights reserved.                                          *
  1306*                                                               *
  1307*****************************************************************
  1308 01  dfheiblk.
  1309     02  eibtime          pic s9(7) comp-3.
  1310     02  eibdate          pic s9(7) comp-3.
  1311     02  eibtrnid         pic x(4).
  1312     02  eibtaskn         pic s9(7) comp-3.
  1313     02  eibtrmid         pic x(4).
  1314     02  dfheigdi         pic s9(4) comp.
  1315     02  eibcposn         pic s9(4) comp.
  1316     02  eibcalen         pic s9(4) comp.
  1317     02  eibaid           pic x(1).
  1318     02  eibfiller1       pic x(1).
  1319     02  eibfn            pic x(2).
  1320     02  eibfiller2       pic x(2).
  1321     02  eibrcode         pic x(6).
  1322     02  eibfiller3       pic x(2).
  1323     02  eibds            pic x(8).
  1324     02  eibreqid         pic x(8).
  1325     02  eibrsrce         pic x(8).
  1326     02  eibsync          pic x(1).
  1327     02  eibfree          pic x(1).
  1328     02  eibrecv          pic x(1).
  1329     02  eibsend          pic x(1).
  1330     02  eibatt           pic x(1).
  1331     02  eibeoc           pic x(1).
  1332     02  eibfmh           pic x(1).
  1333     02  eibcompl         pic x(1).
  1334     02  eibsig           pic x(1).
  1335     02  eibconf          pic x(1).
  1336     02  eiberr           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL609.cbl
  1337     02  eibrldbk         pic x(1).
  1338     02  eiberrcd         pic x(4).
  1339     02  eibsynrb         pic x(1).
  1340     02  eibnodat         pic x(1).
  1341     02  eibfiller5       pic x(2).
  1342     02  eibresp          pic 9(09) comp.
  1343     02  eibresp2         pic 9(09) comp.
  1344     02  dfheigdj         pic s9(4) comp.
  1345     02  dfheigdk         pic s9(4) comp.
  1346 01  DFHCOMMAREA                     PIC X(1024).
  1347*    COPY ELCCIIR.
  1348******************************************************************
  1349*                                                                *
  1350*                                                                *
  1351*                            ELCCIIR.                            *
  1352*                            VMOD=2.001                          *
  1353*                                                                *
  1354*   FILE DESCRIPTION = LIFE CLAIM INTEREST RATES                 *
  1355*                                                                *
  1356*   FILE TYPE = VSAM,KSDS                                        *
  1357*   RECORD SIZE = 100  RECFORM = FIXED                           *
  1358*                                                                *
  1359*   BASE CLUSTER = ELCIIR                        RKP=2,LEN=04    *
  1360*       ALTERNATE INDEX = NONE                                   *
  1361*                                                                *
  1362*   LOG = YES                                                    *
  1363*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1364******************************************************************
  1365*                   C H A N G E   L O G
  1366*
  1367* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1368*-----------------------------------------------------------------
  1369*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1370* EFFECTIVE    NUMBER
  1371*-----------------------------------------------------------------
  1372* 053105                   PEMA  NEW FILE AND COPYBOOK
  1373******************************************************************
  1374*
  1375 01  CLAIM-INTEREST-IR.
  1376     12  IR-RECORD-ID                       PIC XX.
  1377         88  VALID-IR-ID                        VALUE 'IR'.
  1378     12  IR-CONTROL-PRIMARY.
  1379         16  IR-COMPANY-CD                  PIC X.
  1380         16  IR-INT-RATE-CODE               PIC XXX.
  1381     12  IR-LAST-MAINT-BY                   PIC X(4).
  1382     12  IR-LAST-MAINT-DT                   PIC XX.
  1383     12  IR-LAST-MAINT-HHMMSS               PIC S9(6) COMP-3.
  1384     12  IR-DESCRIPTION                     PIC X(25).
  1385     12  IR-INT-RATE                        PIC S99V9(5).
  1386     12  FILLER                             PIC X(52).
  1387 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-INTEREST-IR.
  1388 0000-DFHEXIT SECTION.
  1389     MOVE '9#                    $   ' TO DFHEIV0.
  1390     MOVE 'EL609' TO DFHEIV1.
  1391     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1392     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  1393     MOVE '5'                   TO DC-OPTION-CODE.
  1394     PERFORM 8500-DATE-CONVERSION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL609.cbl
  1395                                THRU 8500-EXIT
  1396     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  1397     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  1398     MOVE DFHCOMMAREA           TO  PROGRAM-INTERFACE-BLOCK.
  1399     MOVE +2                    TO  EMI-NUMBER-OF-LINES
  1400                                    EMI-SWITCH2.
  1401     IF EIBCALEN NOT > ZERO
  1402        MOVE UNACCESS-MSG        TO LOGOFF-MSG
  1403        GO TO 8300-SEND-TEXT
  1404     END-IF
  1405
  1406* EXEC CICS HANDLE CONDITION
  1407*        PGMIDERR (9600-PGMIDERR)
  1408*        ERROR    (9990-ERROR)
  1409*    END-EXEC
  1410*    MOVE '"$L.                  ! " #00001401' TO DFHEIV0
  1411     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1412     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1413     MOVE X'2220233030303031343031' TO DFHEIV0(25:11)
  1414     CALL 'kxdfhei1' USING DFHEIV0
  1415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1416     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1417        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1418           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  1419           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  1420           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  1421           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  1422           MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  1423           MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  1424           MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  1425           MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  1426        ELSE
  1427           MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  1428           MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  1429           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  1430           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  1431           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  1432           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  1433           MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  1434           MOVE SPACES               TO  PI-SAVED-PROGRAM-6
  1435        END-IF
  1436     END-IF
  1437     IF EIBTRNID NOT = WS-TRANS-ID
  1438        GO TO 1000-INITIAL-SCREEN
  1439     END-IF
  1440     IF EIBAID = DFHCLEAR
  1441        GO TO 9400-CLEAR
  1442     END-IF
  1443     IF NOT SYSTEM-DISPLAY-CAP
  1444        MOVE 'READ'              TO SM-READ
  1445        PERFORM 9995-SECURITY-VIOLATION
  1446        MOVE ER-0070             TO EMI-ERROR
  1447        PERFORM 9900-ERROR-FORMAT
  1448                                 THRU 9900-EXIT
  1449        GO TO 8100-SEND-INITIAL-MAP
  1450     END-IF
  1451     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1452        MOVE LOW-VALUES          TO EL609AO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL609.cbl
  1453        MOVE -1                  TO APFKL
  1454        MOVE ER-0008             TO EMI-ERROR
  1455        GO TO 8200-SEND-DATAONLY
  1456     END-IF
  1457
  1458* EXEC CICS RECEIVE
  1459*        INTO   (EL609AO)
  1460*        MAPSET (WS-MAPSET-NAME)
  1461*        MAP    (WS-MAP-NAME)
  1462*    END-EXEC
  1463     MOVE LENGTH OF
  1464      EL609AO
  1465       TO DFHEIV11
  1466*    MOVE '8"T I  L              ''   #00001446' TO DFHEIV0
  1467     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1468     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1469     MOVE X'2020233030303031343436' TO DFHEIV0(25:11)
  1470     CALL 'kxdfhei1' USING DFHEIV0,
  1471           WS-MAP-NAME,
  1472           EL609AO,
  1473           DFHEIV11,
  1474           WS-MAPSET-NAME,
  1475           DFHEIV99,
  1476           DFHEIV99
  1477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1478     IF APFKL > ZERO
  1479        IF EIBAID NOT = DFHENTER
  1480           MOVE ER-0004          TO EMI-ERROR
  1481           MOVE AL-UNBOF         TO APFKA
  1482           MOVE -1               TO APFKL
  1483           GO TO 8200-SEND-DATAONLY
  1484        ELSE
  1485           IF APFKO NUMERIC AND
  1486              (APFKO > ZERO AND LESS '25')
  1487              MOVE PF-VALUES (APFKI)
  1488                                 TO  EIBAID
  1489           ELSE
  1490              MOVE ER-0029       TO  EMI-ERROR
  1491              MOVE AL-UNBOF      TO  APFKA
  1492              MOVE -1            TO  APFKL
  1493              GO TO 8200-SEND-DATAONLY
  1494           END-IF
  1495        END-IF
  1496     END-IF
  1497     IF EIBAID = DFHPF12
  1498        MOVE 'EL010'             TO THIS-PGM
  1499        GO TO 9300-XCTL
  1500     END-IF
  1501     IF EIBAID = DFHPF23
  1502        GO TO 9000-RETURN-CICS
  1503     END-IF
  1504     IF EIBAID = DFHPF24
  1505        IF CREDIT-SESSION
  1506           MOVE 'EL626'          TO THIS-PGM
  1507           GO TO 9300-XCTL
  1508        ELSE
  1509           MOVE 'EL126'          TO THIS-PGM
  1510           GO TO 9300-XCTL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL609.cbl
  1511        END-IF
  1512     END-IF
  1513     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2
  1514        CONTINUE
  1515     ELSE
  1516        MOVE ER-0008             TO EMI-ERROR
  1517        MOVE -1                  TO APFKL
  1518        GO TO 8200-SEND-DATAONLY
  1519     END-IF
  1520     IF AMAINTL > ZERO
  1521        IF AMAINTI = 'A' OR 'C' OR 'D' OR 'S'
  1522           MOVE AL-UANON         TO AMAINTA
  1523           MOVE AMAINTI          TO PI-MODE
  1524        ELSE
  1525           MOVE AL-UABOF         TO AMAINTA
  1526           MOVE -1               TO AMAINTL
  1527           MOVE ER-0023          TO EMI-ERROR
  1528           PERFORM 9900-ERROR-FORMAT
  1529        END-IF
  1530     ELSE
  1531        IF EIBAID = DFHPF1 OR DFHPF2
  1532           MOVE 'S'              TO PI-MODE
  1533        ELSE
  1534           MOVE AL-UABOF         TO AMAINTA
  1535           MOVE -1               TO AMAINTL
  1536           MOVE ER-0023          TO EMI-ERROR
  1537           PERFORM 9900-ERROR-FORMAT
  1538        END-IF
  1539     END-IF
  1540     IF SYSTEM-MODIFY-CAP
  1541        CONTINUE
  1542     ELSE
  1543        IF AMAINTI = 'A' OR 'C' OR 'D'
  1544           MOVE 'UPDATE'         TO SM-READ
  1545           PERFORM 9995-SECURITY-VIOLATION
  1546           MOVE ER-0070          TO EMI-ERROR
  1547           MOVE -1               TO  AMAINTL
  1548           MOVE AL-UABON         TO  AMAINTA
  1549           GO TO 8200-SEND-DATAONLY
  1550        END-IF
  1551     END-IF
  1552     IF EMI-FATAL-CTR > ZERO
  1553        GO TO 8200-SEND-DATAONLY
  1554     END-IF
  1555     IF PI-MODE EQUAL 'S'
  1556        GO TO 2000-PROCESS-SHOW
  1557     END-IF
  1558     IF PI-MODE EQUAL 'C'
  1559        GO TO 3000-PROCESS-CHANGE
  1560     END-IF
  1561     IF PI-MODE EQUAL 'A'
  1562        GO TO 5000-PROCESS-ADD
  1563     END-IF
  1564     IF PI-MODE EQUAL 'D'
  1565        GO TO 6000-PROCESS-DELETE
  1566     END-IF
  1567     MOVE 'LOGIC ERROR HAS OCCURRED - PROGRAM EL609'
  1568                                 TO  LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL609.cbl
  1569     GO TO 8300-SEND-TEXT.
  1570     .
  1571 1000-INITIAL-SCREEN.
  1572     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA
  1573     MOVE PI-COMPANY-CD          TO PI-CI-TOP-KEY (1:1)
  1574                                    PI-CI-BOT-KEY (1:1)
  1575     MOVE ZERO                   TO PI-1ST-TIME-SW
  1576                                    PI-LINE-COUNT
  1577                                    PI-BROWSE-SW
  1578                                    PI-SHOW-SW
  1579                                    PI-CHANGE-SW
  1580     MOVE LOW-VALUES             TO EL609AO
  1581     MOVE -1                     TO AMAINTL
  1582     MOVE +2                     TO WS-COMPLETED-SUCCESSFUL
  1583     GO TO 8100-SEND-INITIAL-MAP
  1584     .
  1585 2000-PROCESS-SHOW.
  1586*IF THE USER PRIMED THE FIRST RATE  CODE THEN USE IT TO BROWSE
  1587     IF RCODEL (1) > +0
  1588        MOVE RCODEI (1)          TO PI-CI-BOT-KEY (2:3)
  1589                                    PI-CI-TOP-KEY (2:3)
  1590     END-IF
  1591     EVALUATE EIBAID
  1592        WHEN DFHPF2
  1593           MOVE PI-CI-TOP-KEY    TO WS-CONTROL-PRIMARY
  1594           GO TO 8000-BROWSE-BWD
  1595        WHEN DFHPF1
  1596           MOVE PI-CI-BOT-KEY    TO WS-CONTROL-PRIMARY
  1597           GO TO 7000-BROWSE-FWD
  1598        WHEN OTHER
  1599           MOVE PI-COMPANY-CD    TO WS-CONTROL-PRIMARY
  1600           GO TO 7000-BROWSE-FWD
  1601     END-EVALUATE
  1602     MOVE +1                     TO  PI-SHOW-SW
  1603     GO TO 7000-BROWSE-FWD
  1604     .
  1605*****************************************************************
  1606 3000-PROCESS-CHANGE.
  1607*****************************************************************
  1608     SET M1                      TO +1
  1609     PERFORM UNTIL
  1610        M1 > +10
  1611        IF (DESCL (M1) > +0)
  1612           OR (RATEL (M1) > +0)
  1613           PERFORM 6010-EDIT-DATA
  1614                                 THRU 6010-EXIT
  1615        END-IF
  1616        SET M1                   UP BY +1
  1617     END-PERFORM
  1618     IF NOT EMI-NO-ERRORS
  1619        GO TO 8200-SEND-DATAONLY
  1620     END-IF
  1621     SET M1                      TO +1
  1622     PERFORM UNTIL
  1623        M1 > +10
  1624        IF (DESCL (M1) > +0)
  1625           OR (RATEL (M1) > +0)
  1626           PERFORM 6030-UPDATE-RECORD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL609.cbl
  1627                                 THRU 6030-EXIT
  1628        END-IF
  1629        SET M1                   UP BY +1
  1630     END-PERFORM
  1631     MOVE PI-CI-TOP-KEY          TO WS-CONTROL-PRIMARY
  1632     GO TO 7000-BROWSE-FWD
  1633     .
  1634*****************************************************************
  1635 5000-PROCESS-ADD.
  1636*****************************************************************
  1637     SET M1                      TO +1
  1638     PERFORM UNTIL
  1639        M1 > +10
  1640        IF (RCODEL    (M1) > +0)
  1641           PERFORM 6020-EDIT-KEY-DATA
  1642                                 THRU 6020-EXIT
  1643           PERFORM 6010-EDIT-DATA
  1644                                 THRU 6010-EXIT
  1645        END-IF
  1646        SET M1                   UP BY +1
  1647     END-PERFORM
  1648     IF NOT EMI-NO-ERRORS
  1649        GO TO 8200-SEND-DATAONLY
  1650     END-IF
  1651     SET M1                      TO +1
  1652     PERFORM UNTIL
  1653        M1 > +10
  1654        IF RCODEL (M1) > +0
  1655           PERFORM 6060-ADD-RECORD
  1656                                 THRU 6060-EXIT
  1657        END-IF
  1658        SET M1                   UP BY +1
  1659        ADD +1                   TO CI1
  1660     END-PERFORM
  1661     SET M1                      TO +1
  1662     MOVE +1                     TO CI1
  1663     MOVE PI-CI-TOP-KEY          TO WS-CONTROL-PRIMARY
  1664     GO TO 7000-BROWSE-FWD
  1665     .
  1666*****************************************************************
  1667 6000-PROCESS-DELETE.
  1668*****************************************************************
  1669     SET M1                      TO +1
  1670** THE WAY THIS WORKS IS YOU HAVE TO SPACE OUT THE RATE  CODE
  1671** FOR THE DELETE TO WORK
  1672     PERFORM UNTIL
  1673        M1 > +10
  1674        IF ((RCODEL   (M1) > +0)
  1675           AND(RCODEI (M1) = SPACES))
  1676           PERFORM 6050-DELETE-RECORD
  1677                                 THRU 6050-EXIT
  1678        END-IF
  1679        SET M1                   UP BY +1
  1680     END-PERFORM
  1681     MOVE PI-CI-TOP-KEY          TO WS-CONTROL-PRIMARY
  1682     GO TO 7000-BROWSE-FWD
  1683     .
  1684 6010-EDIT-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL609.cbl
  1685     IF RATEL (M1) > +0
  1686
  1687* EXEC CICS BIF DEEDIT
  1688*           FIELD   (RATEI (M1))
  1689*           LENGTH  (7)
  1690*       END-EXEC
  1691     MOVE 7
  1692       TO DFHEIV11
  1693*    MOVE '@"L                   #   #00001659' TO DFHEIV0
  1694     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  1695     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1696     MOVE X'2020233030303031363539' TO DFHEIV0(25:11)
  1697     CALL 'kxdfhei1' USING DFHEIV0,
  1698           RATEI(M1),
  1699           DFHEIV11
  1700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1701        IF RATEI (M1) NOT NUMERIC
  1702           MOVE ER-7698          TO EMI-ERROR
  1703           PERFORM 9900-ERROR-FORMAT
  1704           MOVE AL-UABON         TO RATEA (M1)
  1705           MOVE -1               TO RATEL (M1)
  1706        END-IF
  1707     END-IF
  1708     .
  1709 6010-EXIT.
  1710     EXIT.
  1711 6020-EDIT-KEY-DATA.
  1712     IF (RCODEL    (M1) > +0)
  1713        CONTINUE
  1714     ELSE
  1715        MOVE ER-3810          TO EMI-ERROR
  1716        PERFORM 9900-ERROR-FORMAT
  1717        MOVE AL-UABON            TO RCODEA (M1)
  1718        MOVE -1                  TO RCODEL (M1)
  1719        GO TO 6020-EXIT
  1720     END-IF
  1721     .
  1722 6020-EXIT.
  1723     EXIT.
  1724 6030-UPDATE-RECORD.
  1725     SET CI1                     TO M1
  1726     MOVE PI-CI-KEY (CI1)        TO WS-CONTROL-PRIMARY
  1727
  1728* EXEC CICS READ
  1729*       UPDATE
  1730*       DATASET ('ELCIIR')
  1731*       SET     (ADDRESS OF CLAIM-INTEREST-IR)
  1732*       RIDFLD  (WS-CONTROL-PRIMARY)
  1733*       RESP    (WS-RESPONSE)
  1734*    END-EXEC
  1735     MOVE 'ELCIIR' TO DFHEIV1
  1736*    MOVE '&"S        EU         (  N#00001689' TO DFHEIV0
  1737     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1738     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1739     MOVE X'204E233030303031363839' TO DFHEIV0(25:11)
  1740     CALL 'kxdfhei1' USING DFHEIV0,
  1741           DFHEIV1,
  1742           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL609.cbl
  1743           DFHEIV99,
  1744           WS-CONTROL-PRIMARY,
  1745           DFHEIV99,
  1746           DFHEIV99,
  1747           DFHEIV99
  1748     SET ADDRESS OF CLAIM-INTEREST-IR TO
  1749         DFHEIV20
  1750     MOVE EIBRESP  TO WS-RESPONSE
  1751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1752     IF NOT RESP-NORMAL
  1753        GO TO 6030-UPDATE-ERROR
  1754     END-IF
  1755     IF DESCL (M1) > +0
  1756        MOVE DESCI (M1)          TO IR-DESCRIPTION
  1757     END-IF
  1758     IF RATEL (M1) > +0
  1759        MOVE RATEI (M1)          TO IR-INT-RATE
  1760     END-IF
  1761     MOVE PI-PROCESSOR-ID        TO IR-LAST-MAINT-BY
  1762     MOVE EIBTIME                TO IR-LAST-MAINT-HHMMSS
  1763     MOVE SAVE-BIN-DATE          TO IR-LAST-MAINT-DT
  1764
  1765* EXEC CICS REWRITE
  1766*       DATASET    ('ELCIIR')
  1767*       FROM       (CLAIM-INTEREST-IR)
  1768*       RESP       (WS-RESPONSE)
  1769*    END-EXEC
  1770     MOVE LENGTH OF
  1771      CLAIM-INTEREST-IR
  1772       TO DFHEIV11
  1773     MOVE 'ELCIIR' TO DFHEIV1
  1774*    MOVE '&& L                  %  N#00001708' TO DFHEIV0
  1775     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1776     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1777     MOVE X'204E233030303031373038' TO DFHEIV0(25:11)
  1778     CALL 'kxdfhei1' USING DFHEIV0,
  1779           DFHEIV1,
  1780           CLAIM-INTEREST-IR,
  1781           DFHEIV11,
  1782           DFHEIV99
  1783     MOVE EIBRESP  TO WS-RESPONSE
  1784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1785     IF RESP-NORMAL
  1786        GO TO 6030-EXIT
  1787     END-IF
  1788     .
  1789 6030-UPDATE-ERROR.
  1790     MOVE ER-3807                TO EMI-ERROR
  1791     PERFORM 9900-ERROR-FORMAT
  1792     MOVE AL-UABON               TO RCODEA (M1)
  1793     MOVE -1                     TO RCODEL (M1)
  1794     GO TO 8200-SEND-DATAONLY
  1795     .
  1796 6030-EXIT.
  1797     EXIT.
  1798 6050-DELETE-RECORD.
  1799     SET CI1                     TO M1
  1800     MOVE PI-CI-KEY (CI1)        TO WS-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL609.cbl
  1801
  1802* EXEC CICS READ
  1803*       UPDATE
  1804*       DATASET ('ELCIIR')
  1805*       SET     (ADDRESS OF CLAIM-INTEREST-IR)
  1806*       RIDFLD  (WS-CONTROL-PRIMARY)
  1807*       RESP    (WS-RESPONSE)
  1808*    END-EXEC
  1809     MOVE 'ELCIIR' TO DFHEIV1
  1810*    MOVE '&"S        EU         (  N#00001729' TO DFHEIV0
  1811     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1812     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1813     MOVE X'204E233030303031373239' TO DFHEIV0(25:11)
  1814     CALL 'kxdfhei1' USING DFHEIV0,
  1815           DFHEIV1,
  1816           DFHEIV20,
  1817           DFHEIV99,
  1818           WS-CONTROL-PRIMARY,
  1819           DFHEIV99,
  1820           DFHEIV99,
  1821           DFHEIV99
  1822     SET ADDRESS OF CLAIM-INTEREST-IR TO
  1823         DFHEIV20
  1824     MOVE EIBRESP  TO WS-RESPONSE
  1825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1826     IF NOT RESP-NORMAL
  1827        GO TO 6050-DELETE-ERROR
  1828     END-IF
  1829
  1830* EXEC CICS DELETE
  1831*       DATASET ('ELCIIR')
  1832*       RESP    (WS-RESPONSE)
  1833*    END-EXEC
  1834     MOVE 'ELCIIR' TO DFHEIV1
  1835*    MOVE '&(                    &  N#00001739' TO DFHEIV0
  1836     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1837     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1838     MOVE X'204E233030303031373339' TO DFHEIV0(25:11)
  1839     CALL 'kxdfhei1' USING DFHEIV0,
  1840           DFHEIV1,
  1841           DFHEIV99,
  1842           DFHEIV99,
  1843           DFHEIV99,
  1844           DFHEIV99
  1845     MOVE EIBRESP  TO WS-RESPONSE
  1846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1847     IF RESP-NORMAL
  1848        GO TO 6050-EXIT
  1849     END-IF
  1850     .
  1851 6050-DELETE-ERROR.
  1852     MOVE ER-1079                TO EMI-ERROR
  1853     PERFORM 9900-ERROR-FORMAT
  1854     MOVE AL-UABON               TO RCODEA (M1)
  1855     MOVE -1                     TO RCODEL (M1)
  1856     .
  1857 6050-EXIT.
  1858     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL609.cbl
  1859 6060-ADD-RECORD.
  1860     SET CI1                     TO M1
  1861     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
  1862     MOVE RCODEI (M1)            TO WS-INT-RATE-CODE
  1863
  1864* EXEC CICS READ
  1865*       DATASET ('ELCIIR')
  1866*       SET     (ADDRESS OF CLAIM-INTEREST-IR)
  1867*       RIDFLD  (WS-CONTROL-PRIMARY)
  1868*       RESP    (WS-RESPONSE)
  1869*    END-EXEC
  1870     MOVE 'ELCIIR' TO DFHEIV1
  1871*    MOVE '&"S        E          (  N#00001759' TO DFHEIV0
  1872     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1873     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1874     MOVE X'204E233030303031373539' TO DFHEIV0(25:11)
  1875     CALL 'kxdfhei1' USING DFHEIV0,
  1876           DFHEIV1,
  1877           DFHEIV20,
  1878           DFHEIV99,
  1879           WS-CONTROL-PRIMARY,
  1880           DFHEIV99,
  1881           DFHEIV99,
  1882           DFHEIV99
  1883     SET ADDRESS OF CLAIM-INTEREST-IR TO
  1884         DFHEIV20
  1885     MOVE EIBRESP  TO WS-RESPONSE
  1886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1887     IF RESP-NORMAL
  1888        GO TO 6060-ADD-ERROR
  1889     END-IF
  1890
  1891* EXEC CICS GETMAIN
  1892*       LENGTH   (ELCIIR-LENGTH)
  1893*       SET      (ADDRESS OF CLAIM-INTEREST-IR)
  1894*       INITIMG  (GETMAIN-SPACE)
  1895*    END-EXEC
  1896*    MOVE ',"IL                  $   #00001768' TO DFHEIV0
  1897     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  1898     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1899     MOVE X'2020233030303031373638' TO DFHEIV0(25:11)
  1900     CALL 'kxdfhei1' USING DFHEIV0,
  1901           DFHEIV20,
  1902           ELCIIR-LENGTH,
  1903           GETMAIN-SPACE
  1904     SET ADDRESS OF CLAIM-INTEREST-IR TO
  1905         DFHEIV20
  1906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1907     MOVE PI-COMPANY-CD          TO IR-COMPANY-CD
  1908     MOVE RCODEI (M1)            TO IR-INT-RATE-CODE
  1909     IF DESCL (M1) > +0
  1910        MOVE DESCI (M1)          TO IR-DESCRIPTION
  1911     END-IF
  1912     MOVE RATEI  (M1)            TO IR-INT-RATE
  1913     MOVE PI-PROCESSOR-ID        TO IR-LAST-MAINT-BY
  1914     MOVE EIBTIME                TO IR-LAST-MAINT-HHMMSS
  1915     MOVE SAVE-BIN-DATE          TO IR-LAST-MAINT-DT
  1916
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL609.cbl
  1917* EXEC CICS WRITE
  1918*       DATASET    ('ELCIIR')
  1919*       FROM       (CLAIM-INTEREST-IR)
  1920*       RIDFLD     (IR-CONTROL-PRIMARY)
  1921*       RESP       (WS-RESPONSE)
  1922*    END-EXEC
  1923     MOVE LENGTH OF
  1924      CLAIM-INTEREST-IR
  1925       TO DFHEIV11
  1926     MOVE 'ELCIIR' TO DFHEIV1
  1927*    MOVE '&$ L                  ''  N#00001782' TO DFHEIV0
  1928     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  1929     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1930     MOVE X'204E233030303031373832' TO DFHEIV0(25:11)
  1931     CALL 'kxdfhei1' USING DFHEIV0,
  1932           DFHEIV1,
  1933           CLAIM-INTEREST-IR,
  1934           DFHEIV11,
  1935           IR-CONTROL-PRIMARY,
  1936           DFHEIV99,
  1937           DFHEIV99
  1938     MOVE EIBRESP  TO WS-RESPONSE
  1939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1940     IF RESP-NORMAL
  1941        GO TO 6060-EXIT
  1942     END-IF
  1943     .
  1944 6060-ADD-ERROR.
  1945     MOVE ER-3806                TO EMI-ERROR
  1946     PERFORM 9900-ERROR-FORMAT
  1947     MOVE AL-UABON               TO RCODEA (M1)
  1948     MOVE -1                     TO RCODEL (M1)
  1949     .
  1950 6060-EXIT.
  1951     EXIT.
  1952 7000-BROWSE-FWD.
  1953     SET M1  TO +1
  1954
  1955* EXEC CICS STARTBR
  1956*        DATASET   ('ELCIIR')
  1957*        RIDFLD    (WS-CONTROL-PRIMARY)
  1958*        GTEQ
  1959*        RESP      (WS-RESPONSE)
  1960*    END-EXEC
  1961     MOVE 'ELCIIR' TO DFHEIV1
  1962     MOVE 0
  1963       TO DFHEIV11
  1964*    MOVE '&,         G          &  N#00001802' TO DFHEIV0
  1965     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1966     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1967     MOVE X'204E233030303031383032' TO DFHEIV0(25:11)
  1968     CALL 'kxdfhei1' USING DFHEIV0,
  1969           DFHEIV1,
  1970           WS-CONTROL-PRIMARY,
  1971           DFHEIV99,
  1972           DFHEIV11,
  1973           DFHEIV99
  1974     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL609.cbl
  1975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1976     EVALUATE TRUE
  1977        WHEN RESP-ENDFILE
  1978           GO TO 7030-END-FILE
  1979        WHEN RESP-NORMAL
  1980           CONTINUE
  1981        WHEN RESP-NOTFND
  1982           GO TO 7040-NOT-FOUND
  1983     END-EVALUATE
  1984     MOVE LOW-VALUES             TO EL609AO
  1985     MOVE ZERO                   TO PI-LINE-COUNT
  1986     MOVE +1                     TO PI-BROWSE-SW
  1987     MOVE +0                     TO CI1
  1988     .
  1989 7010-READ-NEXT.
  1990
  1991* EXEC CICS READNEXT
  1992*        SET     (ADDRESS OF CLAIM-INTEREST-IR)
  1993*        DATASET ('ELCIIR')
  1994*        RIDFLD  (WS-CONTROL-PRIMARY)
  1995*        RESP    (WS-RESPONSE)
  1996*    END-EXEC
  1997     MOVE 'ELCIIR' TO DFHEIV1
  1998     MOVE 0
  1999       TO DFHEIV11
  2000*    MOVE '&.S                   )  N#00001822' TO DFHEIV0
  2001     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2002     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2003     MOVE X'204E233030303031383232' TO DFHEIV0(25:11)
  2004     CALL 'kxdfhei1' USING DFHEIV0,
  2005           DFHEIV1,
  2006           DFHEIV20,
  2007           DFHEIV99,
  2008           WS-CONTROL-PRIMARY,
  2009           DFHEIV99,
  2010           DFHEIV11,
  2011           DFHEIV99,
  2012           DFHEIV99
  2013     SET ADDRESS OF CLAIM-INTEREST-IR TO
  2014         DFHEIV20
  2015     MOVE EIBRESP  TO WS-RESPONSE
  2016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2017     EVALUATE TRUE
  2018        WHEN RESP-ENDFILE
  2019           GO TO 7030-END-FILE
  2020        WHEN RESP-NORMAL
  2021           CONTINUE
  2022        WHEN RESP-NOTFND
  2023           GO TO 7040-NOT-FOUND
  2024     END-EVALUATE
  2025     IF IR-COMPANY-CD NOT = PI-COMPANY-CD
  2026        GO TO 7030-END-FILE
  2027     END-IF
  2028     ADD +1                      TO WS-RECORD-COUNT
  2029                                    CI1
  2030     MOVE IR-CONTROL-PRIMARY     TO PI-CI-BOT-KEY
  2031                                    PI-CI-KEY (CI1)
  2032     MOVE IR-INT-RATE-CODE       TO RCODEO (M1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL609.cbl
  2033     MOVE IR-DESCRIPTION         TO DESCO (M1)
  2034     MOVE IR-INT-RATE            TO RATEO (M1)
  2035     IF M1 = +1
  2036        MOVE IR-CONTROL-PRIMARY  TO PI-CI-TOP-KEY
  2037     END-IF
  2038     IF M1 < +10
  2039        SET M1 UP BY +1
  2040        GO TO 7010-READ-NEXT
  2041     END-IF
  2042     IF PI-BROWSE-SW = +1
  2043
  2044* EXEC CICS ENDBR
  2045*            DATASET ('ELCIIR')
  2046*       END-EXEC
  2047     MOVE 'ELCIIR' TO DFHEIV1
  2048     MOVE 0
  2049       TO DFHEIV11
  2050*    MOVE '&2                    $   #00001854' TO DFHEIV0
  2051     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2052     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2053     MOVE X'2020233030303031383534' TO DFHEIV0(25:11)
  2054     CALL 'kxdfhei1' USING DFHEIV0,
  2055           DFHEIV1,
  2056           DFHEIV11,
  2057           DFHEIV99
  2058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2059        MOVE +0                  TO PI-BROWSE-SW
  2060     END-IF
  2061     MOVE ER-0000                TO EMI-ERROR
  2062     GO TO 8100-SEND-INITIAL-MAP
  2063     .
  2064 7030-END-FILE.
  2065     IF EMI-ERROR = ER-1257
  2066        MOVE ER-7220             TO  EMI-ERROR
  2067     ELSE
  2068        MOVE ER-1258             TO  EMI-ERROR
  2069     END-IF
  2070     MOVE -1                     TO  AMAINTL
  2071     MOVE AL-UABOF               TO  AMAINTA
  2072     GO TO 8100-SEND-INITIAL-MAP
  2073     .
  2074 7040-NOT-FOUND.
  2075     MOVE ER-0006                TO  EMI-ERROR
  2076     MOVE -1                     TO  AMAINTL
  2077     MOVE AL-UABOF               TO  AMAINTA
  2078     GO TO 8200-SEND-DATAONLY
  2079     .
  2080*****************************************************************
  2081 8000-BROWSE-BWD.
  2082*****************************************************************
  2083     SET M1                      TO +10
  2084     MOVE +11                    TO CI1
  2085
  2086* EXEC CICS STARTBR
  2087*        DATASET ('ELCIIR')
  2088*        RIDFLD  (WS-CONTROL-PRIMARY)
  2089*        GTEQ
  2090*        RESP    (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL609.cbl
  2091*    END-EXEC
  2092     MOVE 'ELCIIR' TO DFHEIV1
  2093     MOVE 0
  2094       TO DFHEIV11
  2095*    MOVE '&,         G          &  N#00001883' TO DFHEIV0
  2096     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2097     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2098     MOVE X'204E233030303031383833' TO DFHEIV0(25:11)
  2099     CALL 'kxdfhei1' USING DFHEIV0,
  2100           DFHEIV1,
  2101           WS-CONTROL-PRIMARY,
  2102           DFHEIV99,
  2103           DFHEIV11,
  2104           DFHEIV99
  2105     MOVE EIBRESP  TO WS-RESPONSE
  2106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2107     EVALUATE TRUE
  2108        WHEN RESP-ENDFILE
  2109           GO TO 8020-END-FILE
  2110        WHEN RESP-NORMAL
  2111           CONTINUE
  2112        WHEN RESP-NOTFND
  2113           GO TO 8030-NOT-FOUND
  2114     END-EVALUATE
  2115     MOVE LOW-VALUES             TO EL609AO
  2116     MOVE ZERO                   TO PI-LINE-COUNT
  2117     MOVE +1                     TO PI-BROWSE-SW
  2118     .
  2119 8010-READ-PREV.
  2120
  2121* EXEC CICS READPREV
  2122*        SET     (ADDRESS OF CLAIM-INTEREST-IR)
  2123*        DATASET ('ELCIIR')
  2124*        RIDFLD  (WS-CONTROL-PRIMARY)
  2125*        RESP    (WS-RESPONSE)
  2126*    END-EXEC
  2127     MOVE 'ELCIIR' TO DFHEIV1
  2128     MOVE 0
  2129       TO DFHEIV11
  2130*    MOVE '&0S                   )  N#00001902' TO DFHEIV0
  2131     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  2132     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2133     MOVE X'204E233030303031393032' TO DFHEIV0(25:11)
  2134     CALL 'kxdfhei1' USING DFHEIV0,
  2135           DFHEIV1,
  2136           DFHEIV20,
  2137           DFHEIV99,
  2138           WS-CONTROL-PRIMARY,
  2139           DFHEIV99,
  2140           DFHEIV11,
  2141           DFHEIV99,
  2142           DFHEIV99
  2143     SET ADDRESS OF CLAIM-INTEREST-IR TO
  2144         DFHEIV20
  2145     MOVE EIBRESP  TO WS-RESPONSE
  2146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2147     EVALUATE TRUE
  2148        WHEN RESP-ENDFILE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL609.cbl
  2149           GO TO 8020-END-FILE
  2150        WHEN RESP-NORMAL
  2151           CONTINUE
  2152        WHEN RESP-NOTFND
  2153           GO TO 8030-NOT-FOUND
  2154     END-EVALUATE
  2155     IF IR-COMPANY-CD NOT = PI-COMPANY-CD
  2156        GO TO 8020-END-FILE
  2157     END-IF
  2158     ADD +1                      TO WS-RECORD-COUNT
  2159     SUBTRACT +1                 FROM CI1
  2160     MOVE IR-CONTROL-PRIMARY     TO PI-CI-TOP-KEY
  2161                                    PI-CI-KEY (CI1)
  2162     MOVE IR-INT-RATE-CODE       TO RCODEO (M1)
  2163     MOVE IR-DESCRIPTION         TO DESCO  (M1)
  2164     MOVE IR-INT-RATE            TO RATEO  (M1)
  2165     IF M1 = +10
  2166        MOVE IR-CONTROL-PRIMARY  TO PI-CI-BOT-KEY
  2167     END-IF
  2168     IF M1 > +1
  2169        SET M1                   DOWN BY +1
  2170        GO TO 8010-READ-PREV
  2171     END-IF
  2172     IF PI-BROWSE-SW = +1
  2173
  2174* EXEC CICS ENDBR
  2175*            DATASET ('ELCIIR')
  2176*       END-EXEC
  2177     MOVE 'ELCIIR' TO DFHEIV1
  2178     MOVE 0
  2179       TO DFHEIV11
  2180*    MOVE '&2                    $   #00001934' TO DFHEIV0
  2181     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2182     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2183     MOVE X'2020233030303031393334' TO DFHEIV0(25:11)
  2184     CALL 'kxdfhei1' USING DFHEIV0,
  2185           DFHEIV1,
  2186           DFHEIV11,
  2187           DFHEIV99
  2188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2189        MOVE +0                  TO PI-BROWSE-SW
  2190     END-IF
  2191     MOVE ER-0000                TO EMI-ERROR
  2192     GO TO 8100-SEND-INITIAL-MAP
  2193     .
  2194 8020-END-FILE.
  2195     IF M1 > +1
  2196        MOVE PI-CI-TOP-KEY       TO WS-CONTROL-PRIMARY
  2197        MOVE ER-1257             TO EMI-ERROR
  2198        GO TO 7000-BROWSE-FWD
  2199     END-IF
  2200     MOVE ER-1257                TO EMI-ERROR
  2201     MOVE -1                     TO  AMAINTL
  2202     MOVE AL-UABOF               TO  AMAINTA
  2203     GO TO 8100-SEND-INITIAL-MAP
  2204     .
  2205 8030-NOT-FOUND.
  2206     MOVE ER-0006                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL609.cbl
  2207     MOVE -1                     TO  AMAINTL
  2208     MOVE AL-UABOF               TO  AMAINTA
  2209     GO TO 8200-SEND-DATAONLY
  2210     .
  2211*****************************************************************
  2212 8100-SEND-INITIAL-MAP.
  2213*****************************************************************
  2214     MOVE -1                     TO  AMAINTL.
  2215     MOVE ZERO                   TO  PI-BROWSE-SW.
  2216     MOVE SAVE-DATE              TO  ADATEO.
  2217     MOVE EIBTIME                TO  TIME-IN.
  2218     MOVE TIME-OUT               TO  ATIMEO.
  2219     IF EMI-ERROR NOT = ZERO
  2220         PERFORM 9900-ERROR-FORMAT
  2221     END-IF
  2222     MOVE EMI-MESSAGE-AREA (1)    TO  AEMSG1O.
  2223     MOVE EMI-MESSAGE-AREA (2)    TO  AEMSG2O.
  2224
  2225* EXEC CICS SEND
  2226*        FROM   (EL609AO)
  2227*        MAPSET (WS-MAPSET-NAME)
  2228*        MAP    (WS-MAP-NAME)
  2229*        CURSOR ERASE
  2230*    END-EXEC.
  2231     MOVE LENGTH OF
  2232      EL609AO
  2233       TO DFHEIV12
  2234     MOVE -1
  2235       TO DFHEIV11
  2236*    MOVE '8$     CT  E    H L F ,   #00001972' TO DFHEIV0
  2237     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2238     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2239     MOVE X'2020233030303031393732' TO DFHEIV0(25:11)
  2240     CALL 'kxdfhei1' USING DFHEIV0,
  2241           WS-MAP-NAME,
  2242           EL609AO,
  2243           DFHEIV12,
  2244           WS-MAPSET-NAME,
  2245           DFHEIV99,
  2246           DFHEIV99,
  2247           DFHEIV99,
  2248           DFHEIV11,
  2249           DFHEIV99,
  2250           DFHEIV99,
  2251           DFHEIV99
  2252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2253
  2254     GO TO 9100-RETURN-TRAN
  2255     .
  2256 8100-EXIT.
  2257      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL609.cbl
  2259*****************************************************************
  2260 8200-SEND-DATAONLY.
  2261*****************************************************************
  2262     MOVE SAVE-DATE              TO  ADATEO.
  2263     MOVE EIBTIME                TO  TIME-IN.
  2264     MOVE TIME-OUT               TO  ATIMEO.
  2265     IF EMI-ERROR NOT = ZERO
  2266         PERFORM 9900-ERROR-FORMAT.
  2267     MOVE EMI-MESSAGE-AREA (1)    TO  AEMSG1O.
  2268     MOVE EMI-MESSAGE-AREA (2)    TO  AEMSG2O.
  2269
  2270* EXEC CICS SEND DATAONLY
  2271*        FROM   (EL609AO)
  2272*        MAPSET (WS-MAPSET-NAME)
  2273*        MAP    (WS-MAP-NAME)
  2274*        CURSOR
  2275*    END-EXEC.
  2276     MOVE LENGTH OF
  2277      EL609AO
  2278       TO DFHEIV12
  2279     MOVE -1
  2280       TO DFHEIV11
  2281*    MOVE '8$D    CT       H L F ,   #00001993' TO DFHEIV0
  2282     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2283     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2284     MOVE X'2020233030303031393933' TO DFHEIV0(25:11)
  2285     CALL 'kxdfhei1' USING DFHEIV0,
  2286           WS-MAP-NAME,
  2287           EL609AO,
  2288           DFHEIV12,
  2289           WS-MAPSET-NAME,
  2290           DFHEIV99,
  2291           DFHEIV99,
  2292           DFHEIV99,
  2293           DFHEIV11,
  2294           DFHEIV99,
  2295           DFHEIV99,
  2296           DFHEIV99
  2297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2298
  2299     GO TO 9100-RETURN-TRAN
  2300     .
  2301 8200-EXIT.
  2302      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL609.cbl
  2304*****************************************************************
  2305 8300-SEND-TEXT.
  2306*****************************************************************
  2307
  2308* EXEC CICS SEND TEXT
  2309*        FROM   (LOGOFF-TEXT)
  2310*        LENGTH (LOGOFF-LENGTH)
  2311*        ERASE  FREEKB
  2312*    END-EXEC.
  2313*    MOVE '8&      T  E F  H   F -   #00002007' TO DFHEIV0
  2314     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2315     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2316     MOVE X'2020233030303032303037' TO DFHEIV0(25:11)
  2317     CALL 'kxdfhei1' USING DFHEIV0,
  2318           LOGOFF-TEXT,
  2319           LOGOFF-LENGTH,
  2320           DFHEIV99,
  2321           DFHEIV99,
  2322           DFHEIV99,
  2323           DFHEIV99,
  2324           DFHEIV99,
  2325           DFHEIV99,
  2326           DFHEIV99,
  2327           DFHEIV99,
  2328           DFHEIV99,
  2329           DFHEIV99
  2330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2331
  2332
  2333* EXEC CICS RETURN
  2334*    END-EXEC.
  2335*    MOVE '.(                    &   #00002012' TO DFHEIV0
  2336     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2337     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2338     MOVE X'2020233030303032303132' TO DFHEIV0(25:11)
  2339     CALL 'kxdfhei1' USING DFHEIV0,
  2340           DFHEIV99,
  2341           DFHEIV99,
  2342           DFHEIV99,
  2343           DFHEIV99,
  2344           DFHEIV99
  2345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2346
  2347 8300-EXIT.
  2348      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL609.cbl
  2350*****************************************************************
  2351 8400-LOG-JOURNAL-RECORD.
  2352*****************************************************************
  2353     IF PI-JOURNAL-FILE-ID = 0
  2354         GO TO 8400-EXIT.
  2355     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  2356     MOVE 'ELCNTL'               TO  JP-FILE-ID.
  2357     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  2358*    EXEC CICS JOURNAL
  2359*        JFILEID (PI-JOURNAL-FILE-ID)
  2360*        JTYPEID (WS-JOURNAL-TYPE-ID)
  2361*        FROM    (JOURNAL-RECORD)
  2362*        LENGTH  (WS-JOURNAL-RECORD-LENGTH)
  2363*    END-EXEC.
  2364 8400-EXIT.
  2365      EXIT.
  2366*****************************************************************
  2367 8500-DATE-CONVERSION.
  2368*****************************************************************
  2369
  2370* EXEC CICS LINK
  2371*        PROGRAM  ('ELDATCV')
  2372*        COMMAREA (DATE-CONVERSION-DATA)
  2373*        LENGTH   (DC-COMM-LENGTH)
  2374*    END-EXEC.
  2375     MOVE 'ELDATCV' TO DFHEIV1
  2376*    MOVE '."C                   ''   #00002036' TO DFHEIV0
  2377     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2378     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2379     MOVE X'2020233030303032303336' TO DFHEIV0(25:11)
  2380     CALL 'kxdfhei1' USING DFHEIV0,
  2381           DFHEIV1,
  2382           DATE-CONVERSION-DATA,
  2383           DC-COMM-LENGTH,
  2384           DFHEIV99,
  2385           DFHEIV99,
  2386           DFHEIV99
  2387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2388
  2389 8500-EXIT.
  2390      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL609.cbl
  2392*****************************************************************
  2393 9000-RETURN-CICS.
  2394*****************************************************************
  2395     MOVE 'EL005'                TO  THIS-PGM.
  2396     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  2397     PERFORM 9300-XCTL.
  2398 9000-EXIT.
  2399      EXIT.
  2400*****************************************************************
  2401 9100-RETURN-TRAN.
  2402*****************************************************************
  2403     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  2404     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  2405
  2406* EXEC CICS RETURN
  2407*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2408*        LENGTH   (PI-COMM-LENGTH)
  2409*        TRANSID  (WS-TRANS-ID)
  2410*    END-EXEC.
  2411*    MOVE '.(CT                  &   #00002057' TO DFHEIV0
  2412     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2413     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2414     MOVE X'2020233030303032303537' TO DFHEIV0(25:11)
  2415     CALL 'kxdfhei1' USING DFHEIV0,
  2416           WS-TRANS-ID,
  2417           PROGRAM-INTERFACE-BLOCK,
  2418           PI-COMM-LENGTH,
  2419           DFHEIV99,
  2420           DFHEIV99
  2421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2422
  2423 9100-EXIT.
  2424      EXIT.
  2425*****************************************************************
  2426 9300-XCTL.
  2427*****************************************************************
  2428     MOVE DFHENTER               TO  EIBAID.
  2429
  2430* EXEC CICS XCTL
  2431*        PROGRAM  (THIS-PGM)
  2432*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2433*        LENGTH   (PI-COMM-LENGTH)
  2434*    END-EXEC.
  2435*    MOVE '.$C                   $   #00002068' TO DFHEIV0
  2436     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2437     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2438     MOVE X'2020233030303032303638' TO DFHEIV0(25:11)
  2439     CALL 'kxdfhei1' USING DFHEIV0,
  2440           THIS-PGM,
  2441           PROGRAM-INTERFACE-BLOCK,
  2442           PI-COMM-LENGTH
  2443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2444
  2445 9300-EXIT.
  2446      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL609.cbl
  2448*****************************************************************
  2449 9400-CLEAR.
  2450*****************************************************************
  2451     MOVE PI-RETURN-TO-PROGRAM  TO  THIS-PGM.
  2452     PERFORM 9300-XCTL.
  2453 9400-EXIT.
  2454      EXIT.
  2455*****************************************************************
  2456 9600-PGMIDERR.
  2457*****************************************************************
  2458
  2459* EXEC CICS HANDLE CONDITION
  2460*        PGMIDERR (8300-SEND-TEXT)
  2461*    END-EXEC.
  2462*    MOVE '"$L                   ! # #00002086' TO DFHEIV0
  2463     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2464     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2465     MOVE X'2320233030303032303836' TO DFHEIV0(25:11)
  2466     CALL 'kxdfhei1' USING DFHEIV0
  2467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2468
  2469     MOVE THIS-PGM               TO  PI-CALLING-PROGRAM
  2470                                     LOGOFF-PGM.
  2471     MOVE 'EL005'                TO  THIS-PGM.
  2472     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  2473     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  2474     PERFORM 9300-XCTL.
  2475 9600-EXIT.
  2476      EXIT.
  2477*****************************************************************
  2478 9900-ERROR-FORMAT.
  2479*****************************************************************
  2480     IF EMI-ERRORS-COMPLETE
  2481         ADD +1             TO  EMI-FATAL-CTR
  2482         MOVE ZERO          TO  EMI-ERROR
  2483         GO TO 9900-EXIT.
  2484
  2485* EXEC CICS LINK
  2486*        PROGRAM  ('EL001')
  2487*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  2488*        LENGTH   (EMI-COMM-LENGTH)
  2489*    END-EXEC.
  2490     MOVE 'EL001' TO DFHEIV1
  2491*    MOVE '."C                   ''   #00002104' TO DFHEIV0
  2492     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2493     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2494     MOVE X'2020233030303032313034' TO DFHEIV0(25:11)
  2495     CALL 'kxdfhei1' USING DFHEIV0,
  2496           DFHEIV1,
  2497           ERROR-MESSAGE-INTERFACE-BLOCK,
  2498           EMI-COMM-LENGTH,
  2499           DFHEIV99,
  2500           DFHEIV99,
  2501           DFHEIV99
  2502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2503
  2504     MOVE ZERO              TO  EMI-ERROR.
  2505 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL609.cbl
  2506      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL609.cbl
  2508*****************************************************************
  2509 9990-ERROR.
  2510*****************************************************************
  2511     MOVE DFHEIBLK               TO EMI-LINE1.
  2512
  2513* EXEC CICS LINK
  2514*        PROGRAM   ('EL004')
  2515*        COMMAREA  (EMI-LINE1)
  2516*        LENGTH    (72)
  2517*    END-EXEC.
  2518     MOVE 'EL004' TO DFHEIV1
  2519     MOVE 72
  2520       TO DFHEIV11
  2521*    MOVE '."C                   ''   #00002117' TO DFHEIV0
  2522     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2523     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2524     MOVE X'2020233030303032313137' TO DFHEIV0(25:11)
  2525     CALL 'kxdfhei1' USING DFHEIV0,
  2526           DFHEIV1,
  2527           EMI-LINE1,
  2528           DFHEIV11,
  2529           DFHEIV99,
  2530           DFHEIV99,
  2531           DFHEIV99
  2532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2533
  2534     PERFORM 8200-SEND-DATAONLY.
  2535     GO TO 9100-RETURN-TRAN.
  2536 9990-EXIT.
  2537      EXIT.
  2538*****************************************************************
  2539 9995-SECURITY-VIOLATION.
  2540*****************************************************************
  2541*           COPY ELCSCTP.
  2542******************************************************************
  2543*                                                                *
  2544*                            ELCSCTP                             *
  2545*                            VMOD=2.001                          *
  2546*                                                                *
  2547*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2548******************************************************************
  2549
  2550
  2551     MOVE EIBDATE          TO SM-JUL-DATE.
  2552     MOVE EIBTRMID         TO SM-TERMID.
  2553     MOVE THIS-PGM         TO SM-PGM.
  2554     MOVE EIBTIME          TO TIME-IN.
  2555     MOVE TIME-OUT         TO SM-TIME.
  2556     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2557
  2558
  2559* EXEC CICS LINK
  2560*         PROGRAM  ('EL003')
  2561*         COMMAREA (SECURITY-MESSAGE)
  2562*         LENGTH   (80)
  2563*    END-EXEC.
  2564     MOVE 'EL003' TO DFHEIV1
  2565     MOVE 80
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL609.cbl
  2566       TO DFHEIV11
  2567*    MOVE '."C                   ''   #00002146' TO DFHEIV0
  2568     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2569     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2570     MOVE X'2020233030303032313436' TO DFHEIV0(25:11)
  2571     CALL 'kxdfhei1' USING DFHEIV0,
  2572           DFHEIV1,
  2573           SECURITY-MESSAGE,
  2574           DFHEIV11,
  2575           DFHEIV99,
  2576           DFHEIV99,
  2577           DFHEIV99
  2578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2579
  2580
  2581******************************************************************
  2582
  2583 9995-EXIT.
  2584      EXIT.
  2585 9999-LAST-PARAGRAPH SECTION.
  2586
  2587* GOBACK.
  2588     MOVE '9%                    "   ' TO DFHEIV0
  2589     MOVE 'EL609' TO DFHEIV1
  2590     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2591     GOBACK.
  2592
  2593 9999-DFHBACK SECTION.
  2594     MOVE '9%                    "   ' TO DFHEIV0
  2595     MOVE 'EL609' TO DFHEIV1
  2596     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2597     GOBACK.
  2598 9999-DFHEXIT.
  2599     IF DFHEIGDJ EQUAL 0001
  2600         NEXT SENTENCE
  2601     ELSE IF DFHEIGDJ EQUAL 2
  2602         GO TO 9600-PGMIDERR,
  2603               9990-ERROR
  2604         DEPENDING ON DFHEIGDI
  2605     ELSE IF DFHEIGDJ EQUAL 3
  2606         GO TO 8300-SEND-TEXT
  2607         DEPENDING ON DFHEIGDI.
  2608     MOVE '9%                    "   ' TO DFHEIV0
  2609     MOVE 'EL609' TO DFHEIV1
  2610     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2611     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4872     Code:        7508
