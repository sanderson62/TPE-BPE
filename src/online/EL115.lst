* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page   1
* EL115.cbl
* Options: int("EL115.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL115.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL115.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL115.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2 PROGRAM-ID.                 EL115.
     3*                            VMOD=2.001.
     4*
     5*
     6*AUTHOR.     PABLO
     7*            COLLEYVILLE, TEXAS.
     8*DATE-COMPILED.
     9*SECURITY.   *****************************************************
    10*            *                                                   *
    11*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    12*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    13*            *   OF CENTRAL STATES IS EXPRESSLY PROHIBITED       *
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page   2
* EL115.cbl
    14*            *   WITHOUT THE PRIOR WRITTEN PERMISSION OF         *
    15*            *   CENTRAL STATES                                  *
    16*            *                                                   *
    17*            *****************************************************
    18*REMARKS.    TRANSACTION- EX40 - STATE MAINTENANCE
    19******************************************************************
    20*                   C H A N G E   L O G
    21*
    22* Changes are marked by the Change Effective date.
    23*-----------------------------------------------------------------
    24*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    25* EFFECTIVE    NUMBER
    26*-----------------------------------------------------------------
    27* 122810    2010012700001  PEMA  NEW PROGRAM
    28******************************************************************
    29 ENVIRONMENT DIVISION.
    30 DATA DIVISION.
    31 WORKING-STORAGE SECTION.
    32 01  DFH-START PIC X(04).
    33 77  FILLER  PIC X(32)  VALUE '********************************'.
    34 77  FILLER  PIC X(32)  VALUE '*    EL115 WORKING STORAGE     *'.
    35 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.001 ***********'.
    36*                                COPY ELCSCTM.
    37******************************************************************
    38*                                                                *
    39*                                                                *
    40*                            ELCSCTM                             *
    41*                            VMOD=2.001                          *
    42*                                                                *
    43*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    44*                                                                *
    45******************************************************************
    46 01  SECURITY-MESSAGE.
    47     12  FILLER                          PIC X(30)
    48            VALUE '** LOGIC SECURITY VIOLATION -'.
    49     12  SM-READ                         PIC X(6).
    50     12  FILLER                          PIC X(5)
    51            VALUE ' PGM='.
    52     12  SM-PGM                          PIC X(6).
    53     12  FILLER                          PIC X(5)
    54            VALUE ' OPR='.
    55     12  SM-PROCESSOR-ID                 PIC X(4).
    56     12  FILLER                          PIC X(6)
    57            VALUE ' TERM='.
    58     12  SM-TERMID                       PIC X(4).
    59     12  FILLER                          PIC XX   VALUE SPACE.
    60     12  SM-JUL-DATE                     PIC 9(5).
    61     12  FILLER                          PIC X    VALUE SPACE.
    62     12  SM-TIME                         PIC 99.99.
    63
    64*                                COPY ELCSCRTY.
    65******************************************************************
    66*                                                                *
    67*                                                                *
    68*                            ELCSCRTY                            *
    69*                            VMOD=2.001                          *
    70*                                                                *
    71*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page   3
* EL115.cbl
    72*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    73*        SAVED IN PI-SECURITY-ADDRESS.                           *
    74*                                                                *
    75******************************************************************
    76 01  SECURITY-CONTROL.
    77     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    78     12  FILLER                       PIC XX    VALUE 'SC'.
    79     12  SC-CREDIT-CODES.
    80         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    81             20  SC-CREDIT-DISPLAY    PIC X.
    82             20  SC-CREDIT-UPDATE     PIC X.
    83     12  SC-CLAIMS-CODES.
    84         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    85             20  SC-CLAIMS-DISPLAY    PIC X.
    86             20  SC-CLAIMS-UPDATE     PIC X.
    87 01  FILLER.
    88     12  WS-VALID-REF-CODES      PIC X VALUE SPACES.
    89         88  VALID-REF-CODE         VALUE ' ' '1' THRU '6'
    90                                          '8' '9'.
    91     12  WS-NUMVAL.
    92         16  WS-NUMVAL-OF-DEEDIT     PIC 9(11) VALUE ZEROS.
    93         16  WS-NUMVAL-V4 REDEFINES WS-NUMVAL-OF-DEEDIT
    94                                     PIC 9(7)V9999.
    95     12  DEEDIT-FIELD                PIC X(11).
    96     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
    97                                     PIC S9(11).
    98     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
    99                                     PIC S9(09)V99.
   100     12  WS-RESPONSE             PIC S9(8)   COMP.
   101         88  RESP-NORMAL              VALUE +00.
   102         88  RESP-ERROR               VALUE +01.
   103         88  RESP-TERMIDERR           VALUE +11.
   104         88  RESP-NOTFND              VALUE +13.
   105         88  RESP-DUPREC              VALUE +14.
   106         88  RESP-DUPKEY              VALUE +15.
   107         88  RESP-INVREQ              VALUE +16.
   108         88  RESP-NOTOPEN             VALUE +19.
   109         88  RESP-ENDFILE             VALUE +20.
   110         88  RESP-ILLOGIC             VALUE +21.
   111         88  RESP-LENGERR             VALUE +22.
   112 01  WS-DATE-AREA.
   113     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   114     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   115 01  WS.
   116     05  W-APPL-SCRTY-NDX    PIC S9(04) COMP   VALUE +29.
   117     05  SC-ITEM-CL-CR       PIC S9(4)         VALUE +1   COMP.
   118     05  WS-COMM-LENGTH      PIC S9(4) COMP VALUE +1500.
   119     05  WS-MAP-LENGTH       PIC S9(4) COMP VALUE +500.
   120     05  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   121     05  QID.
   122         16  QID-TERM        PIC X(4).
   123         16  FILLER          PIC X(4)    VALUE '115A'.
   124     05  WS-ST-LF-PREM-TAX   PIC S9V9(4)    VALUE +0.
   125     05  WS-ST-AH-PREM-TAX-I PIC S9V9(4)    VALUE +0.
   126     05  WS-ST-AH-PREM-TAX-G PIC S9V9(4)    VALUE +0.
   127 01  STANDARD-AREAS.
   128     12  MAP-NAME            PIC X(8)    VALUE 'EL115A'.
   129     12  MAPSET-NAME         PIC X(8)    VALUE 'EL115S'.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page   4
* EL115.cbl
   130     12  TRANS-ID            PIC X(4)    VALUE 'EX40'.
   131     12  PGM-NAME            PIC X(8).
   132     12  TIME-IN             PIC S9(7).
   133     12  TIME-OUT-R  REDEFINES TIME-IN.
   134         16  FILLER          PIC X.
   135         16  TIME-OUT        PIC 99V99.
   136         16  FILLER          PIC XX.
   137     12  XCTL-EL005          PIC X(8)    VALUE 'EL005'.
   138     12  XCTL-EL010          PIC X(8)    VALUE 'EL010'.
   139     12  XCTL-EL126          PIC X(8)    VALUE 'EL126'.
   140     12  XCTL-EL626          PIC X(8)    VALUE 'EL626'.
   141     12  XCTL-EL1151         PIC X(8)    VALUE 'EL1151'.
   142     12  XCTL-GL800          PIC X(8)    VALUE 'GL800'.
   143     12  LINK-EL001          PIC X(8)    VALUE 'EL001'.
   144     12  LINK-EL004          PIC X(8)    VALUE 'EL004'.
   145     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   146     12  THIS-PGM            PIC X(8)    VALUE 'EL115'.
   147     12  ELCNTL-ID           PIC X(8)    VALUE 'ELCNTL'.
   148     12  ELSTAT-ID           PIC X(8)    VALUE 'ELSTAT'.
   149     12  SUB                 PIC S9(4)   COMP.
   150     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   151     12  WS-FIRST-TIME-SW    PIC X       VALUE 'Y'.
   152         88  FIRST-TIME                  VALUE 'Y'.
   153     12  WS-DISPLAY-SW       PIC X       VALUE 'N'.
   154         88  RETURN-DISPLAY              VALUE 'Y'.
   155 01  ACCESS-KEYS.
   156     12  ELCNTL-KEY.
   157         16  ELCNTL-COMP-ID      PIC XXX.
   158         16  ELCNTL-REC-TYPE     PIC X.
   159         16  ELCNTL-ACCESS       PIC XXXX.
   160         16  ELCNTL-SEQ-NO       PIC S9(4)  COMP.
   161     12  COMP-KEY                PIC X(20).
   162     12  STATE-KEY.
   163         16  STATE-COMP-ID       PIC XXX.
   164         16  STATE-CARRIER       PIC X.
   165         16  STATE-GROUPING      PIC X(6).
   166         16  STATE-STATE-CD      PIC XX.
   167         16  STATE-EXP-DT        PIC X(8).
   168         16  STATE-EXP-DT-NUM REDEFINES STATE-EXP-DT
   169                                 PIC 9(8).
   170 01  ERROR-MESSAGES.
   171     12  ER-0000                 PIC X(4)  VALUE '0000'.
   172     12  ER-0004                 PIC X(4)  VALUE '0004'.
   173     12  ER-0013                 PIC X(4)  VALUE '0013'.
   174     12  ER-0023                 PIC X(4)  VALUE '0023'.
   175     12  ER-0029                 PIC X(4)  VALUE '0029'.
   176     12  ER-0042                 PIC X(4)  VALUE '0042'.
   177     12  ER-0050                 PIC X(4)  VALUE '0050'.
   178     12  ER-0068                 PIC X(4)  VALUE '0068'.
   179     12  ER-0070                 PIC X(4)  VALUE '0070'.
   180     12  ER-0131                 PIC X(4)  VALUE '0131'.
   181     12  ER-0141                 PIC X(4)  VALUE '0141'.
   182     12  ER-0144                 PIC X(4)  VALUE '0144'.
   183     12  ER-0145                 PIC X(4)  VALUE '0145'.
   184     12  ER-0146                 PIC X(4)  VALUE '0146'.
   185     12  ER-0147                 PIC X(4)  VALUE '0147'.
   186     12  ER-0148                 PIC X(4)  VALUE '0148'.
   187     12  ER-0149                 PIC X(4)  VALUE '0149'.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page   5
* EL115.cbl
   188     12  ER-0150                 PIC X(4)  VALUE '0150'.
   189     12  ER-0151                 PIC X(4)  VALUE '0151'.
   190     12  ER-0152                 PIC X(4)  VALUE '0152'.
   191     12  ER-0153                 PIC X(4)  VALUE '0153'.
   192     12  ER-0159                 PIC X(4)  VALUE '0159'.
   193     12  ER-0160                 PIC X(4)  VALUE '0160'.
   194     12  ER-0161                 PIC X(4)  VALUE '0161'.
   195     12  ER-0235                 PIC X(4)  VALUE '0235'.
   196     12  ER-0582                 PIC X(4)  VALUE '0582'.
   197     12  ER-0805                 PIC X(4)  VALUE '0805'.
   198     12  ER-1614                 PIC X(4)  VALUE '1614'.
   199     12  ER-2009                 PIC X(4)  VALUE '2009'.
   200     12  ER-2010                 PIC X(4)  VALUE '2010'.
   201     12  ER-2012                 PIC X(4)  VALUE '2012'.
   202     12  ER-2014                 PIC X(4)  VALUE '2014'.
   203     12  ER-2024                 PIC X(4)  VALUE '2024'.
   204     12  ER-2028                 PIC X(4)  VALUE '2028'.
   205     12  ER-2032                 PIC X(4)  VALUE '2032'.
   206     12  ER-2033                 PIC X(4)  VALUE '2033'.
   207     12  ER-2082                 PIC X(4)  VALUE '2082'.
   208     12  ER-2084                 PIC X(4)  VALUE '2084'.
   209     12  ER-2137                 PIC X(4)  VALUE '2137'.
   210     12  ER-2298                 PIC X(4)  VALUE '2298'.
   211     12  ER-2299                 PIC X(4)  VALUE '2299'.
   212     12  ER-2603                 PIC X(4)  VALUE '2603'.
   213     12  ER-2845                 PIC X(4)  VALUE '2845'.
   214     12  ER-3030                 PIC X(4)  VALUE '3030'.
   215     12  ER-3031                 PIC X(4)  VALUE '3031'.
   216     12  ER-3032                 PIC X(4)  VALUE '3032'.
   217     12  ER-3033                 PIC X(4)  VALUE '3033'.
   218     12  ER-3034                 PIC X(4)  VALUE '3034'.
   219     12  ER-3035                 PIC X(4)  VALUE '3035'.
   220     12  ER-3036                 PIC X(4)  VALUE '3036'.
   221     12  ER-7008                 PIC X(4)  VALUE '7008'.
   222     12  ER-7346                 PIC X(4)  VALUE '7346'.
   223     12  ER-7531                 PIC X(4)  VALUE '7531'.
   224     12  ER-7532                 PIC X(4)  VALUE '7532'.
   225     12  ER-7536                 PIC X(4)  VALUE '7536'.
   226     12  ER-7717                 PIC X(4)  VALUE '7717'.
   227     12  ER-7735                 PIC X(4)  VALUE '7735'.
   228     12  ER-8008                 PIC X(4)  VALUE '8008'.
   229     12  ER-8159                 PIC X(4)  VALUE '8159'.
   230     12  ER-9074                 PIC X(4)  VALUE '9074'.
   231     12  ER-9097                 PIC X(4)  VALUE '9097'.
   232     12  ER-9447                 PIC X(4)  VALUE '9447'.
   233     12  ER-9448                 PIC X(4)  VALUE '9448'.
   234     12  ER-9478                 PIC X(4)  VALUE '9478'.
   235     12  ER-9999                 PIC X(4)  VALUE '9999'.
   236*                                COPY ELCCNTL.
   237******************************************************************
   238*                                                                *
   239*                                                                *
   240*                            ELCCNTL.                            *
   241*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   242*                            VMOD=2.059                          *
   243*                                                                *
   244*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   245*                                                                *
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page   6
* EL115.cbl
   246*   FILE TYPE = VSAM,KSDS                                        *
   247*   RECORD SIZE = 750  RECFORM = FIXED                           *
   248*                                                                *
   249*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   250*       ALTERNATE INDEX = NONE                                   *
   251*                                                                *
   252*   LOG = YES                                                    *
   253*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   254******************************************************************
   255*                   C H A N G E   L O G
   256*
   257* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   258*-----------------------------------------------------------------
   259*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   260* EFFECTIVE    NUMBER
   261*-----------------------------------------------------------------
   262* 082503                   PEMA  ADD BENEFIT GROUP
   263* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   264* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   265* 092705    2005050300006  PEMA  ADD SPP LEASES
   266* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   267* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   268* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   269* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   270* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   271* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   272******************************************************************
   273*
   274 01  CONTROL-FILE.
   275     12  CF-RECORD-ID                       PIC XX.
   276         88  VALID-CF-ID                        VALUE 'CF'.
   277
   278     12  CF-CONTROL-PRIMARY.
   279         16  CF-COMPANY-ID                  PIC XXX.
   280         16  CF-RECORD-TYPE                 PIC X.
   281             88  CF-COMPANY-MASTER              VALUE '1'.
   282             88  CF-PROCESSOR-MASTER            VALUE '2'.
   283             88  CF-STATE-MASTER                VALUE '3'.
   284             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   285             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   286             88  CF-CARRIER-MASTER              VALUE '6'.
   287             88  CF-MORTALITY-MASTER            VALUE '7'.
   288             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   289             88  CF-TERMINAL-MASTER             VALUE '9'.
   290             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   291             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   292             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   293             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   294             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   295             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   296             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   297             88  CF-REMINDERS-MASTER            VALUE 'R'.
   298             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   299         16  CF-ACCESS-CD-GENL              PIC X(4).
   300         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   301             20  CF-PROCESSOR               PIC X(4).
   302         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   303             20  CF-STATE-CODE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page   7
* EL115.cbl
   304             20  FILLER                     PIC XX.
   305         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   306             20  FILLER                     PIC XX.
   307             20  CF-HI-BEN-IN-REC           PIC XX.
   308         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   309             20  FILLER                     PIC XXX.
   310             20  CF-CARRIER-CNTL            PIC X.
   311         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   312             20  FILLER                     PIC XX.
   313             20  CF-HI-TYPE-IN-REC          PIC 99.
   314         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   315             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   316                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   317             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   318             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   319         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   320             20  FILLER                     PIC X.
   321             20  CF-CUSTOM-REPORT-NO        PIC 999.
   322         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   323             20  FILLER                     PIC XX.
   324             20  CF-MORTGAGE-PLAN           PIC XX.
   325         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   326
   327     12  CF-LAST-MAINT-DT                   PIC XX.
   328     12  CF-LAST-MAINT-BY                   PIC X(4).
   329     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   330
   331     12  CF-RECORD-BODY                     PIC X(728).
   332
   333
   334****************************************************************
   335*             COMPANY MASTER RECORD                            *
   336****************************************************************
   337
   338     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   339         16  CF-COMPANY-ADDRESS.
   340             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   341             20  CF-CL-IN-CARE-OF           PIC X(30).
   342             20  CF-CL-ADDR-LINE-1          PIC X(30).
   343             20  CF-CL-ADDR-LINE-2          PIC X(30).
   344             20  CF-CL-CITY-STATE           PIC X(30).
   345             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   346             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   347         16  CF-COMPANY-CD                  PIC X.
   348         16  CF-COMPANY-PASSWORD            PIC X(8).
   349         16  CF-SECURITY-OPTION             PIC X.
   350             88  ALL-SECURITY                   VALUE '1'.
   351             88  COMPANY-VERIFY                 VALUE '2'.
   352             88  PROCESSOR-VERIFY               VALUE '3'.
   353             88  NO-SECURITY                    VALUE '4'.
   354             88  ALL-BUT-TERM                   VALUE '5'.
   355         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   356             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   357         16  CF-LGX-INTERFACE-CNTL          PIC X.
   358             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   359         16  CF-INFORCE-LOCATION            PIC X.
   360             88  CERTS-ARE-ONLINE               VALUE '1'.
   361             88  CERTS-ARE-OFFLINE              VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page   8
* EL115.cbl
   362             88  NO-CERTS-AVAILABLE             VALUE '3'.
   363         16  CF-LOWER-CASE-LETTERS          PIC X.
   364         16  CF-CERT-ACCESS-CONTROL         PIC X.
   365             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   366             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   367             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   368             88  CF-ACCNT-CNTL                  VALUE '3'.
   369             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   370
   371         16  CF-FORMS-PRINTER-ID            PIC X(4).
   372         16  CF-CHECK-PRINTER-ID            PIC X(4).
   373
   374         16  CF-LGX-CREDIT-USER             PIC X.
   375             88  CO-IS-NOT-USER                 VALUE 'N'.
   376             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   377
   378         16 CF-CREDIT-CALC-CODES.
   379             20  CF-CR-REM-TERM-CALC PIC X.
   380               88  CR-EARN-AFTER-15TH           VALUE '1'.
   381               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   382               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   383               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   384               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   385               88  CR-EARN-AFTER-14TH           VALUE '6'.
   386               88  CR-EARN-AFTER-16TH           VALUE '7'.
   387             20  CF-CR-R78-METHOD           PIC X.
   388               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   389               88  DONT-USE-PLUS-ONE            VALUE '1'.
   390
   391         16  CF-CLAIM-CONTROL-COUNTS.
   392             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   393                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   394
   395             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   396                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   397
   398             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   399                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   400
   401             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   402                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   403
   404         16  CF-CURRENT-MONTH-END           PIC XX.
   405
   406         16  CF-CO-CALC-QUOTE-TOLERANCE.
   407             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   408             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   409             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   410             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   411                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   412                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   413             20  CF-CO-PREM-REJECT-SW       PIC X.
   414                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   415                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   416             20  CF-CO-REF-REJECT-SW        PIC X.
   417                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   418                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   419
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page   9
* EL115.cbl
   420         16  CF-CO-REPORTING-DT             PIC XX.
   421         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   422         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   423           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   424           88  CF-CO-MONTH-END                  VALUE '1'.
   425
   426         16  CF-LGX-CLAIM-USER              PIC X.
   427             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   428             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   429
   430         16  CF-CREDIT-EDIT-CONTROLS.
   431             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   432             20  CF-MIN-AGE                 PIC 99.
   433             20  CF-DEFAULT-AGE             PIC 99.
   434             20  CF-MIN-TERM                PIC S999      COMP-3.
   435             20  CF-MAX-TERM                PIC S999      COMP-3.
   436             20  CF-DEFAULT-SEX             PIC X.
   437             20  CF-JOINT-AGE-INPUT         PIC X.
   438                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   439             20  CF-BIRTH-DATE-INPUT        PIC X.
   440                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   441             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   442                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   443                 88  CF-ZERO-CARRIER            VALUE '1'.
   444                 88  CF-ZERO-GROUPING           VALUE '2'.
   445                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   446             20  CF-EDIT-SW                 PIC X.
   447                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   448             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   449             20  CF-CR-PR-METHOD            PIC X.
   450               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   451               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   452             20  FILLER                     PIC X.
   453
   454         16  CF-CREDIT-MISC-CONTROLS.
   455             20  CF-REIN-TABLE-SW           PIC X.
   456                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   457             20  CF-COMP-TABLE-SW           PIC X.
   458                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   459             20  CF-EXPERIENCE-RETENTION-AGE
   460                                            PIC S9        COMP-3.
   461             20  CF-CONVERSION-DT           PIC XX.
   462             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   463             20  CF-RUN-FREQUENCY-SW        PIC X.
   464                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   465                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   466
   467             20  CF-CR-CHECK-NO-CONTROL.
   468                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   469                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   470                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   471                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   472                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   473                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   474
   475                 24  CF-CR-CHECK-COUNT       REDEFINES
   476                     CF-CR-CHECK-COUNTER      PIC X(4).
   477
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  10
* EL115.cbl
   478                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   479                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   480
   481                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   482                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   483                 24  CF-MAIL-PROCESSING       PIC X.
   484                     88  MAIL-PROCESSING          VALUE 'Y'.
   485
   486         16  CF-MISC-SYSTEM-CONTROL.
   487             20  CF-SYSTEM-C                 PIC X.
   488                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   489             20  CF-SYSTEM-D                 PIC X.
   490                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   491             20  CF-SOC-SEC-NO-SW            PIC X.
   492                 88  SOC-SEC-NO-USED             VALUE '1'.
   493             20  CF-MEMBER-NO-SW             PIC X.
   494                 88  MEMBER-NO-USED              VALUE '1'.
   495             20  CF-TAX-ID-NUMBER            PIC X(11).
   496             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   497             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   498                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   499                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   500                 88  CF-ALL-APPROVED             VALUE 'Y'.
   501                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   502             20  CF-SYSTEM-E                 PIC X.
   503                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   504
   505         16  CF-LGX-LIFE-USER               PIC X.
   506             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   507             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   508
   509         16  CF-CR-MONTH-END-DT             PIC XX.
   510
   511         16  CF-FILE-MAINT-DATES.
   512             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   513                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   514             20  CF-LAST-BATCH       REDEFINES
   515                 CF-LAST-BATCH-NO               PIC X(4).
   516             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   517             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   518             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   519             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   520             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   521             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
   522             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   523             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   524             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   525             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   526
   527         16  CF-NEXT-COMPANY-ID             PIC XXX.
   528         16  FILLER                         PIC X.
   529
   530         16  CF-ALT-MORT-CODE               PIC X(4).
   531         16  CF-MEMBER-CAPTION              PIC X(10).
   532
   533         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   534             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   535             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  11
* EL115.cbl
   536             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
   537             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
   538             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
   539
   540         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   541
   542         16  CF-LIFE-OVERRIDE-L1            PIC X.
   543         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   544         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   545         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
   546
   547         16  CF-AH-OVERRIDE-L1              PIC X.
   548         16  CF-AH-OVERRIDE-L2              PIC XX.
   549         16  CF-AH-OVERRIDE-L6              PIC X(6).
   550         16  CF-AH-OVERRIDE-L12             PIC X(12).
   551
   552         16  CF-REPORT-CD1-CAPTION          PIC X(10).
   553         16  CF-REPORT-CD2-CAPTION          PIC X(10).
   554
   555         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
   556         16  CF-AR-LAST-EL860-DT            PIC XX.
   557         16  CF-MP-MONTH-END-DT             PIC XX.
   558
   559         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
   560         16  CF-CLAIM-PAID-THRU-TO          PIC X.
   561             88  CF-CLAIM-PAID-TO               VALUE '1'.
   562
   563         16  CF-AR-MONTH-END-DT             PIC XX.
   564
   565         16  CF-CRDTCRD-USER                PIC X.
   566             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
   567             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
   568
   569         16  CF-CC-MONTH-END-DT             PIC XX.
   570
   571         16  CF-PRINT-ADDRESS-LABELS        PIC X.
   572
   573         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
   574             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
   575             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
   576             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
   577         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
   578         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
   579         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
   580         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
   581             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
   582             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
   583         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
   584         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
   585         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
   586             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
   587         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
   588
   589         16  CF-CL-ZIP-CODE.
   590             20  CF-CL-ZIP-PRIME.
   591                 24  CF-CL-ZIP-1ST          PIC X.
   592                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
   593                 24  FILLER                 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  12
* EL115.cbl
   594             20  CF-CL-ZIP-PLUS4            PIC X(4).
   595         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
   596             20  CF-CL-CAN-POSTAL-1         PIC XXX.
   597             20  CF-CL-CAN-POSTAL-2         PIC XXX.
   598             20  FILLER                     PIC XXX.
   599
   600         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
   601         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
   602         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
   603         16  CF-CO-OPTION-START-DATE        PIC XX.
   604         16  CF-REM-TRM-CALC-OPTION         PIC X.
   605           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
   606                                                      '3' '4'.
   607           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
   608           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
   609           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
   610           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
   611           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
   612           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
   613
   614         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
   615
   616         16  CF-PAYMENT-APPROVAL-LEVELS.
   617             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
   618             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
   619             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
   620             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
   621             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
   622             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
   623
   624         16  CF-END-USER-REPORTING-USER     PIC X.
   625             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
   626             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
   627
   628         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
   629             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
   630             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
   631
   632         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
   633
   634         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
   635         16  FILLER                         PIC X.
   636
   637         16  CF-CREDIT-ARCHIVE-CNTL.
   638             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
   639             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
   640             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
   641
   642         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
   643
   644         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
   645             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
   646             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
   647
   648         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
   649             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
   650             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
   651
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  13
* EL115.cbl
   652         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
   653
   654         16  CF-CO-ACH-ID-CODE              PIC  X.
   655             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
   656             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
   657             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
   658         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
   659         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
   660         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
   661         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
   662         16  CF-CO-ACH-RECV-NAME            PIC X(23).
   663         16  CF-CO-ACH-RECV-NO              PIC X(08).
   664         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
   665         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
   666         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
   667                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
   668         16  CF-CO-ACH-TRACE-SPACE REDEFINES
   669                 CF-CO-ACH-TRACE-NO         PIC X(4).
   670
   671         16  CF-CO-OVER-SHORT.
   672             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
   673             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
   674
   675*         16  FILLER                         PIC X(102).
   676         16  CF-PAYMENT-APPROVAL-LEVELS-2.
   677             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
   678             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
   679
   680         16  CF-AH-APPROVAL-DAYS.
   681             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
   682             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
   683             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
   684             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
   685
   686         16  FILLER                         PIC X(82).
   687****************************************************************
   688*             PROCESSOR/USER RECORD                            *
   689****************************************************************
   690
   691     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   692         16  CF-PROCESSOR-NAME              PIC X(30).
   693         16  CF-PROCESSOR-PASSWORD          PIC X(11).
   694         16  CF-PROCESSOR-TITLE             PIC X(26).
   695         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
   696                 88  MESSAGE-YES                VALUE 'Y'.
   697                 88  MESSAGE-NO                 VALUE ' ' 'N'.
   698
   699*****************************************************
   700****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
   701****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
   702****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
   703****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
   704*****************************************************
   705
   706         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
   707             20  CF-ADMINISTRATION-CONTROLS PIC XX.
   708             20  CF-APPLICATION-FORCE       PIC X.
   709             20  CF-INDIVIDUAL-APP.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  14
* EL115.cbl
   710                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
   711                     28  CF-BROWSE-APP      PIC X.
   712                     28  CF-UPDATE-APP      PIC X.
   713
   714         16  CF-CURRENT-TERM-ON             PIC X(4).
   715         16  CF-PROCESSOR-LIMITS-CLAIMS.
   716             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
   717             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
   718             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
   719             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
   720             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
   721             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
   722             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
   723         16  CF-PROCESSOR-CARRIER           PIC X.
   724             88  NO-CARRIER-SECURITY            VALUE ' '.
   725         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
   726             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
   727         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
   728             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
   729         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
   730             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
   731
   732         16  CF-PROC-SYS-ACCESS-SW.
   733             20  CF-PROC-CREDIT-CLAIMS-SW.
   734                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
   735                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
   736                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
   737                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
   738             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
   739                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
   740                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
   741             20  CF-PROC-LIFE-GNRLDGR-SW.
   742                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
   743                     88  ACCESS-TO-LIFE             VALUE 'Y'.
   744                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
   745                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
   746             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
   747                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
   748                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
   749         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
   750             CF-PROC-SYS-ACCESS-SW              PIC X(4).
   751             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
   752         16  CF-PROCESSOR-PRINTER               PIC X(4).
   753
   754         16  CF-APPROVAL-LEVEL                  PIC X.
   755             88  APPROVAL-LEVEL-1                   VALUE '1'.
   756             88  APPROVAL-LEVEL-2                   VALUE '2'.
   757             88  APPROVAL-LEVEL-3                   VALUE '3'.
   758             88  APPROVAL-LEVEL-4                   VALUE '4'.
   759
   760         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
   761
   762         16  CF-LANGUAGE-TYPE                   PIC X.
   763             88  CF-LANG-IS-ENG                     VALUE 'E'.
   764             88  CF-LANG-IS-FR                      VALUE 'F'.
   765
   766         16  CF-CSR-IND                         PIC X.
   767         16  FILLER                             PIC X(239).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  15
* EL115.cbl
   768
   769****************************************************************
   770*             PROCESSOR/REMINDERS RECORD                       *
   771****************************************************************
   772
   773     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
   774         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
   775             20  CF-START-REMIND-DT         PIC XX.
   776             20  CF-END-REMIND-DT           PIC XX.
   777             20  CF-REMINDER-TEXT           PIC X(50).
   778         16  FILLER                         PIC X(296).
   779
   780
   781****************************************************************
   782*             STATE MASTER RECORD                              *
   783****************************************************************
   784
   785     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   786         16  CF-STATE-ABBREVIATION          PIC XX.
   787         16  CF-STATE-NAME                  PIC X(25).
   788         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
   789         16  CF-ST-CALC-QUOTE-TOLERANCE.
   790             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
   791             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
   792             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
   793             20  CF-ST-CLAIM-REJECT-SW      PIC X.
   794                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
   795                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
   796             20  CF-ST-PREM-REJECT-SW       PIC X.
   797                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
   798                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
   799             20  CF-ST-REF-REJECT-SW        PIC X.
   800                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
   801                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
   802         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
   803         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
   804         16  CF-ST-REFUND-RULES.
   805             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
   806             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
   807             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
   808         16  CF-ST-FST-PMT-EXTENSION.
   809             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
   810             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
   811                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
   812                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
   813                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
   814                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
   815         16  CF-ST-STATE-CALL.
   816             20  CF-ST-CALL-UNEARNED        PIC X.
   817             20  CF-ST-CALL-RPT-CNTL        PIC X.
   818             20  CF-ST-CALL-RATE-DEV        PIC XXX.
   819         16  CF-REPLACEMENT-LAW-SW          PIC X.
   820             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
   821             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
   822         16  CF-REPLACEMENT-LETTER          PIC X(4).
   823         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
   824         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
   825         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  16
* EL115.cbl
   826         16  CF-ST-SPLIT-PAYMENT            PIC X.
   827         16  FILLER                         PIC X.
   828         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
   829             20  CF-ST-BENEFIT-CD           PIC XX.
   830             20  CF-ST-BENEFIT-KIND         PIC X.
   831                 88  CF-ST-LIFE-KIND            VALUE 'L'.
   832                 88  CF-ST-AH-KIND              VALUE 'A'.
   833             20  CF-ST-REM-TERM-CALC        PIC X.
   834                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
   835                 88  ST-EARN-AFTER-15TH         VALUE '1'.
   836                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
   837                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
   838                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
   839                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
   840                 88  ST-EARN-AFTER-14TH         VALUE '6'.
   841                 88  ST-EARN-AFTER-16TH         VALUE '7'.
   842
   843             20  CF-ST-REFUND-CALC          PIC X.
   844                 88  ST-REFUND-NOT-USED         VALUE SPACE.
   845                 88  ST-REFD-BY-R78             VALUE '1'.
   846                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
   847                 88  ST-REFD-AS-CALIF           VALUE '3'.
   848                 88  ST-REFD-AS-TEXAS           VALUE '4'.
   849                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
   850                 88  ST-REFD-ANTICIPATION       VALUE '6'.
   851                 88  ST-REFD-UTAH               VALUE '7'.
   852                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
   853                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
   854                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
   855
   856             20  CF-ST-EARNING-CALC         PIC X.
   857                 88  ST-EARNING-NOT-USED        VALUE SPACE.
   858                 88  ST-EARN-BY-R78             VALUE '1'.
   859                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
   860                 88  ST-EARN-AS-CALIF           VALUE '3'.
   861                 88  ST-EARN-AS-TEXAS           VALUE '4'.
   862                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
   863                 88  ST-EARN-ANTICIPATION       VALUE '6'.
   864                 88  ST-EARN-MEAN               VALUE '8'.
   865                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
   866
   867             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
   868                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
   869                 88  ST-OVRD-BY-R78             VALUE '1'.
   870                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
   871                 88  ST-OVRD-AS-CALIF           VALUE '3'.
   872                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
   873                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
   874                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
   875                 88  ST-OVRD-MEAN               VALUE '8'.
   876                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
   877             20  FILLER                     PIC X.
   878
   879         16  CF-ST-COMMISSION-CAPS.
   880             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
   881             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
   882             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
   883             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  17
* EL115.cbl
   884         16  CF-COMM-CAP-LIMIT-TO           PIC X.
   885                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
   886
   887         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
   888
   889         16  CF-ST-STATUTORY-INTEREST.
   890             20  CF-ST-STAT-DATE-FROM       PIC X.
   891                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
   892                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
   893             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
   894             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
   895             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
   896             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
   897             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
   898
   899         16  CF-ST-OVER-SHORT.
   900             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
   901             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
   902
   903         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
   904
   905         16  CF-ST-RT-CALC                  PIC X.
   906
   907         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
   908         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
   909         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
   910         16  CF-ST-RF-LR-CALC               PIC X.
   911         16  CF-ST-RF-LL-CALC               PIC X.
   912         16  CF-ST-RF-LN-CALC               PIC X.
   913         16  CF-ST-RF-AH-CALC               PIC X.
   914         16  CF-ST-RF-CP-CALC               PIC X.
   915*        16  FILLER                         PIC X(206).
   916*CIDMOD         16  FILLER                         PIC X(192).
   917         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
   918             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
   919         16  CF-ST-REF-AH-DEATH-IND         PIC X.
   920         16  CF-ST-VFY-2ND-BENE             PIC X.
   921         16  FILLER                         PIC X(186).
   922
   923****************************************************************
   924*             BENEFIT MASTER RECORD                            *
   925****************************************************************
   926
   927     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   928         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
   929             20  CF-BENEFIT-CODE            PIC XX.
   930             20  CF-BENEFIT-NUMERIC  REDEFINES
   931                 CF-BENEFIT-CODE            PIC XX.
   932             20  CF-BENEFIT-ALPHA           PIC XXX.
   933             20  CF-BENEFIT-DESCRIP         PIC X(10).
   934             20  CF-BENEFIT-COMMENT         PIC X(10).
   935
   936             20  CF-LF-COVERAGE-TYPE        PIC X.
   937                 88  CF-REDUCING                VALUE 'R'.
   938                 88  CF-LEVEL                   VALUE 'L' 'P'.
   939
   940             20  CF-SPECIAL-CALC-CD         PIC X.
   941                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  18
* EL115.cbl
   942                 88  CF-NP-0-MO-INT             VALUE 'A'.
   943                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
   944                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
   945                 88  CF-TERM-IN-DAYS            VALUE 'D'.
   946                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
   947                 88  CF-FARM-PLAN               VALUE 'F'.
   948                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
   949                 88  CF-2-MTH-INTEREST          VALUE 'I'.
   950                 88  CF-3-MTH-INTEREST          VALUE 'J'.
   951                 88  CF-4-MTH-INTEREST          VALUE 'K'.
   952                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
   953                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
   954                 88  CF-PRUDENTIAL              VALUE 'P'.
   955                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
   956                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
   957                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
   958                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
   959                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
   960                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
   961
   962             20  CF-JOINT-INDICATOR         PIC X.
   963                 88  CF-JOINT-COVERAGE          VALUE 'J'.
   964
   965*            20  FILLER                     PIC X(12).
   966             20  FILLER                     PIC X(11).
   967             20  CF-BENEFIT-CATEGORY        PIC X.
   968             20  CF-LOAN-TYPE               PIC X(8).
   969
   970             20  CF-CO-REM-TERM-CALC        PIC X.
   971                 88  CO-EARN-AFTER-15TH         VALUE '1'.
   972                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
   973                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
   974                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
   975                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
   976
   977             20  CF-CO-EARNINGS-CALC        PIC X.
   978                 88  CO-EARN-BY-R78             VALUE '1'.
   979                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
   980                 88  CO-EARN-AS-CALIF           VALUE '3'.
   981                 88  CO-EARN-AS-TEXAS           VALUE '4'.
   982                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
   983                 88  CO-EARN-ANTICIPATION       VALUE '6'.
   984                 88  CO-EARN-AS-MEAN            VALUE '8'.
   985                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
   986
   987             20  CF-CO-REFUND-CALC          PIC X.
   988                 88  CO-REFUND-NOT-USED         VALUE SPACE.
   989                 88  CO-REFD-BY-R78             VALUE '1'.
   990                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
   991                 88  CO-REFD-AS-CALIF           VALUE '3'.
   992                 88  CO-REFD-AS-TEXAS           VALUE '4'.
   993                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
   994                 88  CO-REFD-ANTICIPATION       VALUE '6'.
   995                 88  CO-REFD-MEAN               VALUE '8'.
   996                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
   997                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
   998                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
   999
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  19
* EL115.cbl
  1000             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1001                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1002                 88  CO-OVRD-BY-R78             VALUE '1'.
  1003                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1004                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1005                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1006                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1007                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1008                 88  CO-OVRD-MEAN               VALUE '8'.
  1009                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1010
  1011             20  CF-CO-BEN-I-G-CD           PIC X.
  1012                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1013                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1014                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1015
  1016         16  FILLER                         PIC X(304).
  1017
  1018
  1019****************************************************************
  1020*             CARRIER MASTER RECORD                            *
  1021****************************************************************
  1022
  1023     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1024         16  CF-ADDRESS-DATA.
  1025             20  CF-MAIL-TO-NAME            PIC X(30).
  1026             20  CF-IN-CARE-OF              PIC X(30).
  1027             20  CF-ADDRESS-LINE-1          PIC X(30).
  1028             20  CF-ADDRESS-LINE-2          PIC X(30).
  1029             20  CF-CITY-STATE              PIC X(30).
  1030             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1031             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1032
  1033         16  CF-CLAIM-NO-CONTROL.
  1034             20  CF-CLAIM-NO-METHOD         PIC X.
  1035                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1036                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1037                 88  CLAIM-NO-SEQ               VALUE '3'.
  1038                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1039             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1040                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1041                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1042                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1043
  1044         16  CF-CHECK-NO-CONTROL.
  1045             20  CF-CHECK-NO-METHOD         PIC X.
  1046                 88  CHECK-NO-MANUAL            VALUE '1'.
  1047                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1048                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1049                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1050             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1051                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1052
  1053         16  CF-DOMICILE-STATE              PIC XX.
  1054
  1055         16  CF-EXPENSE-CONTROLS.
  1056             20  CF-EXPENSE-METHOD          PIC X.
  1057                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  20
* EL115.cbl
  1058                 88  DOLLARS-PER-PMT            VALUE '2'.
  1059                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1060                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1061             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1062             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1063
  1064         16  CF-CORRESPONDENCE-CONTROL.
  1065             20  CF-LETTER-RESEND-OPT       PIC X.
  1066                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1067                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1068             20  FILLER                     PIC X(4).
  1069
  1070         16  CF-RESERVE-CONTROLS.
  1071             20  CF-MANUAL-SW               PIC X.
  1072                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1073             20  CF-FUTURE-SW               PIC X.
  1074                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1075             20  CF-PTC-SW                  PIC X.
  1076                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1077             20  CF-IBNR-SW                 PIC X.
  1078                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1079             20  CF-PTC-LF-SW               PIC X.
  1080                 88  CF-LF-PTC-USED             VALUE '1'.
  1081             20  CF-CDT-ACCESS-METHOD       PIC X.
  1082                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1083                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1084                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1085             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1086
  1087         16  CF-CLAIM-CALC-METHOD           PIC X.
  1088             88  360-PLUS-MONTHS                VALUE '1'.
  1089             88  365-PLUS-MONTHS                VALUE '2'.
  1090             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1091             88  360-DAILY                      VALUE '4'.
  1092             88  365-DAILY                      VALUE '5'.
  1093
  1094         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1095         16  FILLER                         PIC X(11).
  1096
  1097         16  CF-LIMIT-AMOUNTS.
  1098             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1099             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1100             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1101             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1102             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1103             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1104             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1105             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1106             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1107             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1108
  1109         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1110         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1111         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1112
  1113         16  CF-ZIP-CODE.
  1114             20  CF-ZIP-PRIME.
  1115                 24  CF-ZIP-1ST             PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  21
* EL115.cbl
  1116                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1117                 24  FILLER                 PIC X(4).
  1118             20  CF-ZIP-PLUS4               PIC X(4).
  1119         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1120             20  CF-CAN-POSTAL-1            PIC XXX.
  1121             20  CF-CAN-POSTAL-2            PIC XXX.
  1122             20  FILLER                     PIC XXX.
  1123
  1124         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1125         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1126         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1127
  1128         16  CF-RATING-SWITCH               PIC X.
  1129             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1130             88  CF-NO-RATING                   VALUE 'N'.
  1131
  1132         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1133
  1134         16  CF-CARRIER-OVER-SHORT.
  1135             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1136             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1137
  1138         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1139         16  CF-SECPAY-SWITCH               PIC X.
  1140             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1141             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1142         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1143         16  FILLER                         PIC X(448).
  1144*        16  FILLER                         PIC X(452).
  1145
  1146
  1147****************************************************************
  1148*             MORTALITY MASTER RECORD                          *
  1149****************************************************************
  1150
  1151     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1152         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1153                                INDEXED BY CF-MORT-NDX.
  1154             20  CF-MORT-TABLE              PIC X(5).
  1155             20  CF-MORT-TABLE-TYPE         PIC X.
  1156                 88  CF-MORT-JOINT              VALUE 'J'.
  1157                 88  CF-MORT-SINGLE             VALUE 'S'.
  1158                 88  CF-MORT-COMBINED           VALUE 'C'.
  1159                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1160                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1161             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1162             20  CF-MORT-AGE-METHOD         PIC XX.
  1163                 88  CF-AGE-LAST                VALUE 'AL'.
  1164                 88  CF-AGE-NEAR                VALUE 'AN'.
  1165             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1166             20  CF-MORT-ADJUSTMENT-DIRECTION
  1167                                            PIC X.
  1168                 88  CF-MINUS                   VALUE '-'.
  1169                 88  CF-PLUS                    VALUE '+'.
  1170             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1171             20  CF-MORT-JOINT-CODE         PIC X.
  1172                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1173             20  CF-MORT-PC-Q               PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  22
* EL115.cbl
  1174                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1175             20  CF-MORT-TABLE-CODE         PIC X(4).
  1176             20  CF-MORT-COMMENTS           PIC X(15).
  1177             20  FILLER                     PIC X(14).
  1178
  1179         16  FILLER                         PIC X(251).
  1180
  1181
  1182****************************************************************
  1183*             BUSSINESS TYPE MASTER RECORD                     *
  1184****************************************************************
  1185
  1186     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1187* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1188* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1189* AND RECORD 05 IS TYPES 81-99
  1190         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1191             20  CF-BUSINESS-TITLE          PIC  X(19).
  1192             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1193                                            PIC S9V9(4) COMP-3.
  1194             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1195             20  FILLER                     PIC  X.
  1196         16  FILLER                         PIC  X(248).
  1197
  1198
  1199****************************************************************
  1200*             TERMINAL MASTER RECORD                           *
  1201****************************************************************
  1202
  1203     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1204
  1205         16  CF-COMPANY-TERMINALS.
  1206             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1207                                  PIC X(4).
  1208         16  FILLER               PIC X(248).
  1209
  1210
  1211****************************************************************
  1212*             LIFE EDIT MASTER RECORD                          *
  1213****************************************************************
  1214
  1215     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1216         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1217             20  CF-LIFE-CODE-IN            PIC XX.
  1218             20  CF-LIFE-CODE-OUT           PIC XX.
  1219         16  FILLER                         PIC X(248).
  1220
  1221
  1222****************************************************************
  1223*             AH EDIT MASTER RECORD                            *
  1224****************************************************************
  1225
  1226     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1227         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1228             20  CF-AH-CODE-IN              PIC XXX.
  1229             20  CF-AH-CODE-OUT             PIC XX.
  1230         16  FILLER                         PIC X(248).
  1231
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  23
* EL115.cbl
  1232
  1233****************************************************************
  1234*             CREDIBILITY TABLES                               *
  1235****************************************************************
  1236
  1237     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1238         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1239                             INDEXED BY CF-CRDB-NDX.
  1240             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1241             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1242             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1243         16  FILLER                         PIC  X(332).
  1244
  1245
  1246****************************************************************
  1247*             REPORT CUSTOMIZATION RECORD                      *
  1248****************************************************************
  1249
  1250     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1251         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1252             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1253             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1254             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1255**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1256****       A T-TRANSFER.                                   ****
  1257             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1258
  1259         16  FILLER                         PIC XX.
  1260
  1261         16  CF-CARRIER-CNTL-OPT.
  1262             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1263                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1264                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1265             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1266                                            PIC X.
  1267         16  CF-GROUP-CNTL-OPT.
  1268             20  CF-GROUP-OPT-SEQ           PIC 9.
  1269                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1270                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1271             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1272                                            PIC X(6).
  1273         16  CF-STATE-CNTL-OPT.
  1274             20  CF-STATE-OPT-SEQ           PIC 9.
  1275                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1276                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1277             20  CF-STATE-SELECT OCCURS 3 TIMES
  1278                                            PIC XX.
  1279         16  CF-ACCOUNT-CNTL-OPT.
  1280             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1281                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1282                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1283             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1284                                            PIC X(10).
  1285         16  CF-BUS-TYP-CNTL-OPT.
  1286             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1287                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1288                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1289             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  24
* EL115.cbl
  1290                                            PIC XX.
  1291         16  CF-LF-TYP-CNTL-OPT.
  1292             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1293                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1294                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1295             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1296                                            PIC XX.
  1297         16  CF-AH-TYP-CNTL-OPT.
  1298             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1299                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1300                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1301             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1302                                            PIC XX.
  1303         16  CF-REPTCD1-CNTL-OPT.
  1304             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1305                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1306                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1307             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1308                                            PIC X(10).
  1309         16  CF-REPTCD2-CNTL-OPT.
  1310             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1311                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1312                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1313             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1314                                            PIC X(10).
  1315         16  CF-USER1-CNTL-OPT.
  1316             20  CF-USER1-OPT-SEQ           PIC 9.
  1317                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1318                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1319             20  CF-USER1-SELECT OCCURS 3 TIMES
  1320                                            PIC X(10).
  1321         16  CF-USER2-CNTL-OPT.
  1322             20  CF-USER2-OPT-SEQ           PIC 9.
  1323                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1324                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1325             20  CF-USER2-SELECT OCCURS 3 TIMES
  1326                                            PIC X(10).
  1327         16  CF-USER3-CNTL-OPT.
  1328             20  CF-USER3-OPT-SEQ           PIC 9.
  1329                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1330                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1331             20  CF-USER3-SELECT OCCURS 3 TIMES
  1332                                            PIC X(10).
  1333         16  CF-USER4-CNTL-OPT.
  1334             20  CF-USER4-OPT-SEQ           PIC 9.
  1335                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1336                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1337             20  CF-USER4-SELECT OCCURS 3 TIMES
  1338                                            PIC X(10).
  1339         16  CF-USER5-CNTL-OPT.
  1340             20  CF-USER5-OPT-SEQ           PIC 9.
  1341                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1342                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1343             20  CF-USER5-SELECT OCCURS 3 TIMES
  1344                                            PIC X(10).
  1345         16  CF-REINS-CNTL-OPT.
  1346             20  CF-REINS-OPT-SEQ           PIC 9.
  1347                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  25
* EL115.cbl
  1348                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1349             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1350                 24  CF-REINS-PRIME         PIC XXX.
  1351                 24  CF-REINS-SUB           PIC XXX.
  1352
  1353         16  CF-AGENT-CNTL-OPT.
  1354             20  CF-AGENT-OPT-SEQ           PIC 9.
  1355                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1356                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1357             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1358                                            PIC X(10).
  1359
  1360         16  FILLER                         PIC X(43).
  1361
  1362         16  CF-LOSS-RATIO-SELECT.
  1363             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1364             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1365         16  CF-ENTRY-DATE-SELECT.
  1366             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1367             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1368         16  CF-EFFECTIVE-DATE-SELECT.
  1369             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1370             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1371
  1372         16  CF-EXCEPTION-LIST-IND          PIC X.
  1373             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1374
  1375         16  FILLER                         PIC X(318).
  1376
  1377****************************************************************
  1378*                  EXCEPTION REPORTING RECORD                  *
  1379****************************************************************
  1380
  1381     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1382         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1383             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1384
  1385         16  CF-COMBINED-LIFE-AH-OPT.
  1386             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1387             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1388             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1389             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1390
  1391         16  CF-LIFE-OPT.
  1392             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1393             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1394             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1395             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1396             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1397             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1398             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1399             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1400             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1401             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1402
  1403         16  CF-AH-OPT.
  1404             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1405             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  26
* EL115.cbl
  1406             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1407             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1408             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1409             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1410             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1411             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1412             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1413             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1414
  1415         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1416             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1417             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1418             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1419
  1420         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1421
  1422         16  FILLER                         PIC X(673).
  1423
  1424
  1425****************************************************************
  1426*             MORTGAGE SYSTEM PLAN RECORD                      *
  1427****************************************************************
  1428
  1429     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1430         16  CF-PLAN-TYPE                   PIC X.
  1431             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1432             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1433             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1434         16  CF-PLAN-ABBREV                 PIC XXX.
  1435         16  CF-PLAN-DESCRIPT               PIC X(10).
  1436         16  CF-PLAN-NOTES                  PIC X(20).
  1437         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1438         16  CF-PLAN-UNDERWRITING.
  1439             20  CF-PLAN-TERM-DATA.
  1440                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1441                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1442             20  CF-PLAN-AGE-DATA.
  1443                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1444                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1445                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1446             20  CF-PLAN-BENEFIT-DATA.
  1447                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1448                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1449                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1450                                            PIC S9(7)V99  COMP-3.
  1451         16  CF-PLAN-POLICY-FORMS.
  1452             20  CF-POLICY-FORM             PIC X(12).
  1453             20  CF-MASTER-APPLICATION      PIC X(12).
  1454             20  CF-MASTER-POLICY           PIC X(12).
  1455         16  CF-PLAN-RATING.
  1456             20  CF-RATE-CODE               PIC X(5).
  1457             20  CF-SEX-RATING              PIC X.
  1458                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1459                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1460             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1461             20  CF-SUB-STD-TYPE            PIC X.
  1462                 88  CF-PCT-OF-PREM            VALUE '1'.
  1463                 88  CF-PCT-OF-BENE            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  27
* EL115.cbl
  1464         16  CF-PLAN-PREM-TOLERANCES.
  1465             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1466             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1467         16  CF-PLAN-PYMT-TOLERANCES.
  1468             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1469             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1470         16  CF-PLAN-MISC-DATA.
  1471             20  FILLER                     PIC X.
  1472             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1473             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1474         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1475         16  CF-PLAN-IND-GRP                PIC X.
  1476             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1477                                                     '1'.
  1478             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1479                                                     '2'.
  1480         16  CF-MIB-SEARCH-SW               PIC X.
  1481             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1482             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1483             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1484             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1485         16  CF-ALPHA-SEARCH-SW             PIC X.
  1486             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1487             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1488             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1489             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1490             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1491             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1492             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1493             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1494             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1495             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1496                                                     'A' 'B' 'C'
  1497                                                     'X' 'Y' 'Z'.
  1498         16  CF-EFF-DT-RULE-SW              PIC X.
  1499             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1500             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1501             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1502             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1503             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1504         16  FILLER                         PIC X(4).
  1505         16  CF-HEALTH-QUESTIONS            PIC X.
  1506             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1507         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1508         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1509         16  CF-PLAN-SNGL-JNT               PIC X.
  1510             88  CF-COMBINED-PLAN              VALUE 'C'.
  1511             88  CF-JNT-PLAN                   VALUE 'J'.
  1512             88  CF-SNGL-PLAN                  VALUE 'S'.
  1513         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1514         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1515         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1516         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1517         16  CF-RERATE-CNTL                 PIC  X.
  1518             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1519             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1520             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1521             88  CF-AUTO-RECALC                 VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  28
* EL115.cbl
  1522         16  CF-BENEFIT-TYPE                PIC  X.
  1523             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1524             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1525         16  CF-POLICY-FEE                  PIC S999V99
  1526                                                    COMP-3.
  1527         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1528         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  1529         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1530         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1531         16  FILLER                         PIC  X(32).
  1532         16  CF-TERMINATION-FORM            PIC  X(04).
  1533         16  FILLER                         PIC  X(08).
  1534         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1535                                                       COMP-3.
  1536         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  1537         16  CF-ISSUE-LETTER                PIC  X(4).
  1538         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  1539         16  CF-DEPENDENT-COVERAGE          PIC  X.
  1540             88  CF-YES-DEP-COV                 VALUE 'Y'.
  1541             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  1542         16  CF-MP-REFUND-CALC              PIC X.
  1543             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  1544             88  CF-MP-REFD-BY-R78              VALUE '1'.
  1545             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  1546             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  1547             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  1548             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  1549             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  1550             88  CF-MP-REFD-MEAN                VALUE '8'.
  1551         16  CF-ALT-RATE-CODE               PIC  X(5).
  1552
  1553
  1554         16  FILLER                         PIC X(498).
  1555****************************************************************
  1556*             MORTGAGE COMPANY MASTER RECORD                   *
  1557****************************************************************
  1558
  1559     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1560         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  1561         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  1562             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  1563             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  1564             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  1565             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  1566             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  1567
  1568         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  1569         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  1570         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  1571         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  1572         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  1573
  1574         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  1575             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  1576         16  CF-MP-RECON-USE-IND            PIC X(1).
  1577             88  CF-MP-USE-RECON             VALUE 'Y'.
  1578         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  1579             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  29
* EL115.cbl
  1580         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  1581             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  1582             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  1583         16  FILLER                         PIC X(1).
  1584         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  1585             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  1586         16  CF-MORTG-MIB-VERSION           PIC X.
  1587             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  1588             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  1589             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  1590         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  1591             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  1592                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  1593             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  1594                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  1595             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  1596                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  1597             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  1598                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  1599             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  1600                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  1601             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  1602                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  1603         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  1604         16  FILLER                         PIC X(7).
  1605         16  CF-MORTG-DESTINATION-SYMBOL.
  1606             20  CF-MORTG-MIB-COMM          PIC X(5).
  1607             20  CF-MORTG-MIB-TERM          PIC X(5).
  1608         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  1609             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  1610         16  FILLER                         PIC X(03).
  1611         16  CF-MP-CHECK-NO-CONTROL.
  1612             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  1613                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  1614                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  1615                                                ' ' LOW-VALUES.
  1616                 88  CF-MP-CHECK-NO-PRE-PRINTED
  1617                                               VALUE '3'.
  1618         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  1619         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  1620         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  1621             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  1622                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  1623             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  1624                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  1625             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  1626                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  1627             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  1628                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  1629             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  1630                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  1631             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  1632                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  1633         16  CF-MORTG-BILLING-AREA.
  1634             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  1635                                            PIC X.
  1636         16  CF-MORTG-MONTH-END-DT          PIC XX.
  1637         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  30
* EL115.cbl
  1638         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  1639         16  CF-MORTG-MIB-DEST-SW           PIC X.
  1640             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  1641             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  1642         16  FILLER                         PIC X.
  1643         16  CF-MORTG-LABEL-CONTROL         PIC X.
  1644             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  1645             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  1646         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  1647         16  FILLER                         PIC X(8).
  1648         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  1649         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  1650         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  1651         16  CF-ACH-COMPANY-ID.
  1652             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  1653                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  1654                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  1655                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  1656             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  1657         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  1658             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  1659         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  1660             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  1661             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  1662         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  1663         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  1664         16  FILLER                         PIC X(536).
  1665
  1666****************************************************************
  1667*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  1668****************************************************************
  1669
  1670     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  1671         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  1672             20  CF-FEMALE-HEIGHT.
  1673                 24  CF-FEMALE-FT           PIC 99.
  1674                 24  CF-FEMALE-IN           PIC 99.
  1675             20  CF-FEMALE-MIN-WT           PIC 999.
  1676             20  CF-FEMALE-MAX-WT           PIC 999.
  1677         16  FILLER                         PIC X(428).
  1678
  1679     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  1680         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  1681             20  CF-MALE-HEIGHT.
  1682                 24  CF-MALE-FT             PIC 99.
  1683                 24  CF-MALE-IN             PIC 99.
  1684             20  CF-MALE-MIN-WT             PIC 999.
  1685             20  CF-MALE-MAX-WT             PIC 999.
  1686         16  FILLER                         PIC X(428).
  1687******************************************************************
  1688*             AUTOMATIC ACTIVITY RECORD                          *
  1689******************************************************************
  1690     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  1691         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  1692             20  CF-SYS-ACTIVE-SW           PIC X(01).
  1693             20  CF-SYS-LETTER-ID           PIC X(04).
  1694             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  1695             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  31
* EL115.cbl
  1696             20  CF-SYS-RESET-SW            PIC X(01).
  1697             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  1698             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  1699
  1700         16  FILLER                         PIC X(50).
  1701
  1702         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  1703             20  CF-USER-ACTIVE-SW          PIC X(01).
  1704             20  CF-USER-LETTER-ID          PIC X(04).
  1705             20  CF-USER-RESEND-DAYS        PIC 9(03).
  1706             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  1707             20  CF-USER-RESET-SW           PIC X(01).
  1708             20  CF-USER-REPORT-DAYS        PIC 9(03).
  1709             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  1710             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  1711
  1712         16  FILLER                         PIC X(246).
  1713*                                COPY ELCSTATE.
  1714******************************************************************
  1715*                                                                *
  1716*                                                                *
  1717*                            ELCSTATE.                           *
  1718*                                                                *
  1719*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  1720*                                                                *
  1721*   FILE TYPE = VSAM,KSDS                                        *
  1722*   RECORD SIZE = 250  RECFORM = FIXED                           *
  1723*                                                                *
  1724*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  1725*       ALTERNATE INDEX = NONE                                   *
  1726*                                                                *
  1727*   LOG = YES                                                    *
  1728*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1729******************************************************************
  1730*                   C H A N G E   L O G
  1731*
  1732* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1733*-----------------------------------------------------------------
  1734*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1735* EFFECTIVE    NUMBER
  1736*-----------------------------------------------------------------
  1737* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  1738******************************************************************
  1739*
  1740 01  STATE-FILE.
  1741     12  SF-RECORD-ID                       PIC XX.
  1742         88  VALID-CF-ID                        VALUE 'SF'.
  1743     12  SF-CONTROL-PRIMARY.
  1744         16  SF-COMPANY-ID                  PIC XXX.
  1745         16  SF-CARRIER-CODE                PIC X.
  1746         16  SF-GROUPING                    PIC X(6).
  1747         16  SF-STATE-CODE                  PIC XX.
  1748         16  SF-EXPIRE-DATE                 PIC 9(8).
  1749****************************************************************
  1750*             STATE CONTROLS
  1751****************************************************************
  1752     12  SF-LAST-MAINT-DT                   PIC XX.
  1753     12  SF-LAST-MAINT-BY                   PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  32
* EL115.cbl
  1754     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1755     12  SF-STATE-RT-CONTROLS.
  1756         16  SF-ST-RT-CALC                  PIC X.
  1757     12  SF-ST-TAX-CONTROLS.
  1758         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1759         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1760         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1761     12  SF-ST-REFUND-OPTIONS.
  1762         16  SF-ST-RF-LR-CALC               PIC X.
  1763         16  SF-ST-RF-LL-CALC               PIC X.
  1764         16  SF-ST-RF-LN-CALC               PIC X.
  1765         16  SF-ST-RF-AH-CALC               PIC X.
  1766         16  SF-ST-RF-CP-CALC               PIC X.
  1767     12  SF-ST-UNEARN-PREM-OPTIONS.
  1768         16  SF-ST-LUEP-R78                 PIC X.
  1769         16  SF-ST-LUEP-PRO                 PIC X.
  1770         16  SF-ST-LUEP-ST                  PIC X.
  1771         16  SF-ST-LUEP-DOM                 PIC X.
  1772         16  SF-ST-AUEP-R78                 PIC X.
  1773         16  SF-ST-AUEP-PRO                 PIC X.
  1774         16  SF-ST-AUEP-ST                  PIC X.
  1775         16  SF-ST-AUEP-DOM                 PIC X.
  1776         16  SF-ST-CUEP-R78                 PIC X.
  1777         16  SF-ST-CUEP-PRO                 PIC X.
  1778         16  SF-ST-CUEP-ST                  PIC X.
  1779         16  SF-ST-CUEP-DOM                 PIC X.
  1780     12  SF-ST-EARN-PREM-OPTIONS.
  1781         16  SF-ST-LEP-R78                  PIC X.
  1782         16  SF-ST-LEP-PRO                  PIC X.
  1783         16  SF-ST-LEP-ST                   PIC X.
  1784         16  SF-ST-LEP-DOM                  PIC X.
  1785         16  SF-ST-AEP-R78                  PIC X.
  1786         16  SF-ST-AEP-PRO                  PIC X.
  1787         16  SF-ST-AEP-ST                   PIC X.
  1788         16  SF-ST-AEP-DOM                  PIC X.
  1789         16  SF-ST-CEP-R78                  PIC X.
  1790         16  SF-ST-CEP-PRO                  PIC X.
  1791         16  SF-ST-CEP-ST                   PIC X.
  1792         16  SF-ST-CEP-DOM                  PIC X.
  1793     12  SF-FOR-FUTURE-USE                  PIC X(179).
  1794*                                COPY ELCDATE.
  1795******************************************************************
  1796*                                                                *
  1797*                                                                *
  1798*                            ELCDATE.                            *
  1799*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1800*                            VMOD=2.003
  1801*                                                                *
  1802*                                                                *
  1803*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1804*                 LENGTH = 200                                   *
  1805******************************************************************
  1806
  1807 01  DATE-CONVERSION-DATA.
  1808     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1809     12  DC-OPTION-CODE                PIC X.
  1810         88  BIN-TO-GREG                VALUE ' '.
  1811         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  33
* EL115.cbl
  1812         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1813         88  YMD-GREG-TO-BIN            VALUE '3'.
  1814         88  MDY-GREG-TO-BIN            VALUE '4'.
  1815         88  JULIAN-TO-BIN              VALUE '5'.
  1816         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1817         88  FIND-CENTURY               VALUE '7'.
  1818         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1819         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1820         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1821         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1822         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1823         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1824         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1825         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1826         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1827         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1828         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1829         88  BIN-3-TO-GREG              VALUE 'I'.
  1830         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1831         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1832         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1833         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1834         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1835         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1836         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1837         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1838         88  THREE-CHARACTER-BIN
  1839                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1840         88  GREGORIAN-TO-BIN
  1841                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1842         88  BIN-TO-GREGORIAN
  1843                  VALUES ' ' '1' 'I' '8' 'G'.
  1844         88  JULIAN-TO-BINARY
  1845                  VALUES '5' 'C' 'E' 'F'.
  1846     12  DC-ERROR-CODE                 PIC X.
  1847         88  NO-CONVERSION-ERROR        VALUE ' '.
  1848         88  DATE-CONVERSION-ERROR
  1849                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1850         88  DATE-IS-ZERO               VALUE '1'.
  1851         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  1852         88  DATE-IS-INVALID            VALUE '3'.
  1853         88  DATE1-GREATER-DATE2        VALUE '4'.
  1854         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1855         88  DATE-INVALID-OPTION        VALUE '9'.
  1856         88  INVALID-CENTURY            VALUE 'A'.
  1857         88  ONLY-CENTURY               VALUE 'B'.
  1858         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1859         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1860     12  DC-END-OF-MONTH               PIC X.
  1861         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1862     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1863         88  USE-NORMAL-PROCESS         VALUE ' '.
  1864         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1865         88  ADJUST-UP-100-YRS          VALUE '2'.
  1866     12  FILLER                        PIC X.
  1867     12  DC-CONVERSION-DATES.
  1868         16  DC-BIN-DATE-1             PIC XX.
  1869         16  DC-BIN-DATE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  34
* EL115.cbl
  1870         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1871         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1872                       DC-GREG-DATE-1-EDIT.
  1873             20  DC-EDIT1-MONTH        PIC 99.
  1874             20  SLASH1-1              PIC X.
  1875             20  DC-EDIT1-DAY          PIC 99.
  1876             20  SLASH1-2              PIC X.
  1877             20  DC-EDIT1-YEAR         PIC 99.
  1878         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1879         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1880                     DC-GREG-DATE-2-EDIT.
  1881             20  DC-EDIT2-MONTH        PIC 99.
  1882             20  SLASH2-1              PIC X.
  1883             20  DC-EDIT2-DAY          PIC 99.
  1884             20  SLASH2-2              PIC X.
  1885             20  DC-EDIT2-YEAR         PIC 99.
  1886         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1887         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1888                     DC-GREG-DATE-1-YMD.
  1889             20  DC-YMD-YEAR           PIC 99.
  1890             20  DC-YMD-MONTH          PIC 99.
  1891             20  DC-YMD-DAY            PIC 99.
  1892         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1893         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1894                      DC-GREG-DATE-1-MDY.
  1895             20  DC-MDY-MONTH          PIC 99.
  1896             20  DC-MDY-DAY            PIC 99.
  1897             20  DC-MDY-YEAR           PIC 99.
  1898         16  DC-GREG-DATE-1-ALPHA.
  1899             20  DC-ALPHA-MONTH        PIC X(10).
  1900             20  DC-ALPHA-DAY          PIC 99.
  1901             20  FILLER                PIC XX.
  1902             20  DC-ALPHA-CENTURY.
  1903                 24 DC-ALPHA-CEN-N     PIC 99.
  1904             20  DC-ALPHA-YEAR         PIC 99.
  1905         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1906         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1907         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1908         16  DC-JULIAN-DATE            PIC 9(05).
  1909         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1910                                       PIC 9(05).
  1911         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1912             20  DC-JULIAN-YEAR        PIC 99.
  1913             20  DC-JULIAN-DAYS        PIC 999.
  1914         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1915         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1916         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1917     12  DATE-CONVERSION-VARIBLES.
  1918         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1919         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1920             20  FILLER                PIC 9(3).
  1921             20  HOLD-CEN-1-CCYY.
  1922                 24  HOLD-CEN-1-CC     PIC 99.
  1923                 24  HOLD-CEN-1-YY     PIC 99.
  1924             20  HOLD-CEN-1-MO         PIC 99.
  1925             20  HOLD-CEN-1-DA         PIC 99.
  1926         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1927             20  HOLD-CEN-1-R-MO       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  35
* EL115.cbl
  1928             20  HOLD-CEN-1-R-DA       PIC 99.
  1929             20  HOLD-CEN-1-R-CCYY.
  1930                 24  HOLD-CEN-1-R-CC   PIC 99.
  1931                 24  HOLD-CEN-1-R-YY   PIC 99.
  1932             20  FILLER                PIC 9(3).
  1933         16  HOLD-CENTURY-1-X.
  1934             20  FILLER                PIC X(3)  VALUE SPACES.
  1935             20  HOLD-CEN-1-X-CCYY.
  1936                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1937                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1938             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1939             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1940         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1941             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1942             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1943             20  HOLD-CEN-1-R-X-CCYY.
  1944                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1945                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1946             20  FILLER                PIC XXX.
  1947         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1948         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1949         16  DC-JULIAN-DATE-1          PIC 9(07).
  1950         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1951             20  DC-JULIAN-1-CCYY.
  1952                 24  DC-JULIAN-1-CC    PIC 99.
  1953                 24  DC-JULIAN-1-YR    PIC 99.
  1954             20  DC-JULIAN-DA-1        PIC 999.
  1955         16  DC-JULIAN-DATE-2          PIC 9(07).
  1956         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1957             20  DC-JULIAN-2-CCYY.
  1958                 24  DC-JULIAN-2-CC    PIC 99.
  1959                 24  DC-JULIAN-2-YR    PIC 99.
  1960             20  DC-JULIAN-DA-2        PIC 999.
  1961         16  DC-GREG-DATE-A-EDIT.
  1962             20  DC-EDITA-MONTH        PIC 99.
  1963             20  SLASHA-1              PIC X VALUE '/'.
  1964             20  DC-EDITA-DAY          PIC 99.
  1965             20  SLASHA-2              PIC X VALUE '/'.
  1966             20  DC-EDITA-CCYY.
  1967                 24  DC-EDITA-CENT     PIC 99.
  1968                 24  DC-EDITA-YEAR     PIC 99.
  1969         16  DC-GREG-DATE-B-EDIT.
  1970             20  DC-EDITB-MONTH        PIC 99.
  1971             20  SLASHB-1              PIC X VALUE '/'.
  1972             20  DC-EDITB-DAY          PIC 99.
  1973             20  SLASHB-2              PIC X VALUE '/'.
  1974             20  DC-EDITB-CCYY.
  1975                 24  DC-EDITB-CENT     PIC 99.
  1976                 24  DC-EDITB-YEAR     PIC 99.
  1977         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1978         16  DC-GREG-DATE-CYMD-R REDEFINES
  1979                              DC-GREG-DATE-CYMD.
  1980             20  DC-CYMD-CEN           PIC 99.
  1981             20  DC-CYMD-YEAR          PIC 99.
  1982             20  DC-CYMD-MONTH         PIC 99.
  1983             20  DC-CYMD-DAY           PIC 99.
  1984         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1985         16  DC-GREG-DATE-MDCY-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  36
* EL115.cbl
  1986                              DC-GREG-DATE-MDCY.
  1987             20  DC-MDCY-MONTH         PIC 99.
  1988             20  DC-MDCY-DAY           PIC 99.
  1989             20  DC-MDCY-CEN           PIC 99.
  1990             20  DC-MDCY-YEAR          PIC 99.
  1991    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1992        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1993    12  DC-EL310-DATE                  PIC X(21).
  1994    12  FILLER                         PIC X(28).
  1995*                                COPY ELCLOGOF.
  1996******************************************************************
  1997*                                                                *
  1998*                                                                *
  1999*                            ELCLOGOF.                           *
  2000*                            VMOD=2.001                          *
  2001*                                                                *
  2002*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2003*                                                                *
  2004******************************************************************
  2005 01  CLASIC-LOGOFF.
  2006     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2007     12  LOGOFF-TEXT.
  2008         16  FILLER          PIC X(5)    VALUE SPACES.
  2009         16  LOGOFF-MSG.
  2010             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2011             20  FILLER      PIC X       VALUE SPACES.
  2012             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2013         16  FILLER          PIC X(80)
  2014           VALUE '* YOU ARE NOW LOGGED OFF'.
  2015         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2016         16  FILLER          PIC X       VALUE QUOTE.
  2017         16  LOGOFF-SYS-MSG  PIC X(17)
  2018           VALUE 'S CLAS-IC SYSTEM '.
  2019     12  TEXT-MESSAGES.
  2020         16  UNACCESS-MSG    PIC X(29)
  2021             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2022         16  PGMIDERR-MSG    PIC X(17)
  2023             VALUE 'PROGRAM NOT FOUND'.
  2024*                                COPY ELCATTR.
  2025******************************************************************
  2026*                                                                *
  2027*                            ELCATTR.                            *
  2028*                            VMOD=2.001                          *
  2029*                                                                *
  2030*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2031*                                                                *
  2032*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2033*                                                                *
  2034*                   POS 1   P=PROTECTED                          *
  2035*                           U=UNPROTECTED                        *
  2036*                           S=ASKIP                              *
  2037*                   POS 2   A=ALPHA/NUMERIC                      *
  2038*                           N=NUMERIC                            *
  2039*                   POS 3   N=NORMAL                             *
  2040*                           B=BRIGHT                             *
  2041*                           D=DARK                               *
  2042*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2043*                           OF=MODIFIED DATA TAG OFF             *
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  37
* EL115.cbl
  2044*                                                                *
  2045*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2046******************************************************************
  2047 01  ATTRIBUTE-LIST.
  2048     12  AL-PABOF            PIC X       VALUE 'Y'.
  2049     12  AL-PABON            PIC X       VALUE 'Z'.
  2050     12  AL-PADOF            PIC X       VALUE '%'.
  2051     12  AL-PADON            PIC X       VALUE '_'.
  2052     12  AL-PANOF            PIC X       VALUE '-'.
  2053     12  AL-PANON            PIC X       VALUE '/'.
  2054     12  AL-SABOF            PIC X       VALUE '8'.
  2055     12  AL-SABON            PIC X       VALUE '9'.
  2056     12  AL-SADOF            PIC X       VALUE '@'.
  2057     12  AL-SADON            PIC X       VALUE QUOTE.
  2058     12  AL-SANOF            PIC X       VALUE '0'.
  2059     12  AL-SANON            PIC X       VALUE '1'.
  2060     12  AL-UABOF            PIC X       VALUE 'H'.
  2061     12  AL-UABON            PIC X       VALUE 'I'.
  2062     12  AL-UADOF            PIC X       VALUE '<'.
  2063     12  AL-UADON            PIC X       VALUE '('.
  2064     12  AL-UANOF            PIC X       VALUE ' '.
  2065     12  AL-UANON            PIC X       VALUE 'A'.
  2066     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2067     12  AL-UNBON            PIC X       VALUE 'R'.
  2068     12  AL-UNDOF            PIC X       VALUE '*'.
  2069     12  AL-UNDON            PIC X       VALUE ')'.
  2070     12  AL-UNNOF            PIC X       VALUE '&'.
  2071     12  AL-UNNON            PIC X       VALUE 'J'.
  2072*                                COPY ELCEMIB.
  2073******************************************************************
  2074*                                                                *
  2075*                                                                *
  2076*                            ELCEMIB.                            *
  2077*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2078*                            VMOD=2.005                          *
  2079*                                                                *
  2080*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2081*                                                                *
  2082******************************************************************
  2083 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2084     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2085     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2086     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2087     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2088     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2089     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2090     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2091     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2092     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2093         88  EMI-NO-ERRORS                    VALUE '1'.
  2094         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2095         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2096     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2097         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2098     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2099         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2100         88  EMI-AREA1-FULL                   VALUE '2'.
  2101     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  38
* EL115.cbl
  2102         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2103         88  EMI-AREA2-FULL                   VALUE '2'.
  2104     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2105         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2106         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2107         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2108         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2109         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2110     12  EMI-ERROR-LINES.
  2111         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2112         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2113         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2114         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2115             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2116                 24  EMI-ERR-NUM         PIC X(4).
  2117                 24  EMI-FILLER          PIC X.
  2118                 24  EMI-SEV             PIC X.
  2119                 24  FILLER              PIC X.
  2120             20  FILLER                  PIC X(02).
  2121     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2122         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2123             20  EMI-ERROR-NUMBER    PIC X(4).
  2124             20  EMI-FILL            PIC X.
  2125             20  EMI-SEVERITY        PIC X.
  2126             20  FILLER              PIC X.
  2127             20  EMI-ERROR-TEXT.
  2128                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2129                 24  FILLER          PIC X(55).
  2130     12  EMI-SEVERITY-SAVE           PIC X.
  2131         88  EMI-NOTE                    VALUE 'N'.
  2132         88  EMI-WARNING                 VALUE 'W'.
  2133         88  EMI-FORCABLE                VALUE 'F'.
  2134         88  EMI-FATAL                   VALUE 'X'.
  2135     12  EMI-MESSAGE-FLAG            PIC X.
  2136         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2137         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2138     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2139     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2140         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2141         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2142         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2143     12  FILLER                      PIC X(137)  VALUE SPACES.
  2144     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2145     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2146     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2147     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2148*                                COPY ELCJPFX.
  2149******************************************************************
  2150*                                                                *
  2151*                                                                *
  2152*                            ELCJPFX.                            *
  2153*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2154*                            VMOD=2.002                          *
  2155*                                                                *
  2156*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2157*                                                                *
  2158*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2159*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  39
* EL115.cbl
  2160*        ELCNTL - CONTROL FILE                                   *
  2161*        ELMSTR - CLAIM MASTERS                                  *
  2162*        ELTRLR - ACTIVITY TRAILERS                              *
  2163*        ELCHKQ - CHECK QUE                                      *
  2164******************************************************************
  2165 01  JOURNAL-RECORD.
  2166     12  JP-USER-ID                  PIC X(4).
  2167     12  JP-FILE-ID                  PIC X(8).
  2168     12  JP-PROGRAM-ID               PIC X(8).
  2169     12  JP-RECORD-TYPE              PIC X.
  2170         88 JP-ADD              VALUE 'A'.
  2171         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2172         88 JP-AFTER-CHANGE     VALUE 'C'.
  2173         88 JP-DELETE           VALUE 'D'.
  2174         88 JP-GENERIC-DELETE   VALUE 'G'.
  2175         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2176         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2177     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2178     12  JP-RECORD-AREA
  2179
  2180
  2181                                 PIC X(530).
  2182*                                COPY ELCINTF.
  2183******************************************************************
  2184*                                                                *
  2185*                                                                *
  2186*                            ELCINTF.                            *
  2187*                            VMOD=2.017                          *
  2188*                                                                *
  2189*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2190*                                                                *
  2191*       LENGTH = 1024                                            *
  2192*                                                                *
  2193******************************************************************
  2194*                   C H A N G E   L O G
  2195*
  2196* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2197*-----------------------------------------------------------------
  2198*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2199* EFFECTIVE    NUMBER
  2200*-----------------------------------------------------------------
  2201* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2202******************************************************************
  2203 01  PROGRAM-INTERFACE-BLOCK.
  2204     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2205     12  PI-CALLING-PROGRAM              PIC X(8).
  2206     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2207     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2208     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2209     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2210     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2211     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2212     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2213     12  PI-COMPANY-ID                   PIC XXX.
  2214     12  PI-COMPANY-CD                   PIC X.
  2215
  2216     12  PI-COMPANY-PASSWORD             PIC X(8).
  2217
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  40
* EL115.cbl
  2218     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2219
  2220     12  PI-CONTROL-IN-PROGRESS.
  2221         16  PI-CARRIER                  PIC X.
  2222         16  PI-GROUPING                 PIC X(6).
  2223         16  PI-STATE                    PIC XX.
  2224         16  PI-ACCOUNT                  PIC X(10).
  2225         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2226                                         PIC X(10).
  2227         16  PI-CLAIM-CERT-GRP.
  2228             20  PI-CLAIM-NO             PIC X(7).
  2229             20  PI-CERT-NO.
  2230                 25  PI-CERT-PRIME       PIC X(10).
  2231                 25  PI-CERT-SFX         PIC X.
  2232             20  PI-CERT-EFF-DT          PIC XX.
  2233         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2234             20  PI-PLAN-CODE            PIC X(2).
  2235             20  PI-REVISION-NUMBER      PIC X(3).
  2236             20  PI-PLAN-EFF-DT          PIC X(2).
  2237             20  PI-PLAN-EXP-DT          PIC X(2).
  2238             20  FILLER                  PIC X(11).
  2239         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  2240             20  PI-OE-REFERENCE-1.
  2241                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2242                 25  PI-OE-REF-1-SUFF    PIC XX.
  2243
  2244     12  PI-SESSION-IN-PROGRESS          PIC X.
  2245         88  CLAIM-SESSION                   VALUE '1'.
  2246         88  CREDIT-SESSION                  VALUE '2'.
  2247         88  WARRANTY-SESSION                VALUE '3'.
  2248         88  MORTGAGE-SESSION                VALUE '4'.
  2249         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2250
  2251
  2252*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2253
  2254     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2255     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2256
  2257     12  PI-CREDIT-USER                  PIC X.
  2258         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2259         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2260
  2261     12  PI-CLAIM-USER                   PIC X.
  2262         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2263         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2264
  2265     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2266         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2267         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2268         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2269         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2270         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2271
  2272     12  PI-PROCESSOR-ID                 PIC X(4).
  2273
  2274     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2275
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  41
* EL115.cbl
  2276     12  PI-MEMBER-CAPTION               PIC X(10).
  2277
  2278     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2279         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2280
  2281     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2282     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2283     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2284     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2285
  2286     12  PI-AH-OVERRIDE-L1               PIC X.
  2287     12  PI-AH-OVERRIDE-L2               PIC XX.
  2288     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2289     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2290
  2291     12  PI-NEW-SYSTEM                   PIC X(2).
  2292
  2293     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2294     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2295         88  PI-USES-PAID-TO                 VALUE '1'.
  2296     12  PI-CRDTCRD-SYSTEM.
  2297         16  PI-CRDTCRD-USER             PIC X.
  2298             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2299             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2300         16  PI-CC-MONTH-END-DT          PIC XX.
  2301     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2302
  2303     12  PI-OE-REFERENCE-2.
  2304         16  PI-OE-REF-2-PRIME           PIC X(10).
  2305         16  PI-OE-REF-2-SUFF            PIC X.
  2306
  2307     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2308
  2309     12  PI-LANGUAGE-TYPE                PIC X.
  2310             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2311             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2312             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2313
  2314     12  PI-POLICY-LINKAGE-IND           PIC X.
  2315         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2316         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2317                                                   LOW-VALUES.
  2318
  2319     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2320     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2321         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2322         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2323
  2324     12  PI-PROCESSOR-CSR-IND            PIC X.
  2325         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2326         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2327
  2328     12  FILLER                          PIC X(3).
  2329
  2330     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2331
  2332     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2333         PI-SYSTEM-LEVEL.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  42
* EL115.cbl
  2334
  2335         16  PI-ENTRY-CODES.
  2336             20  PI-ENTRY-CD-1           PIC X.
  2337             20  PI-ENTRY-CD-2           PIC X.
  2338
  2339         16  PI-RETURN-CODES.
  2340             20  PI-RETURN-CD-1          PIC X.
  2341             20  PI-RETURN-CD-2          PIC X.
  2342
  2343         16  PI-UPDATE-STATUS-SAVE.
  2344             20  PI-UPDATE-BY            PIC X(4).
  2345             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2346
  2347         16  PI-LOWER-CASE-LETTERS       PIC X.
  2348             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2349
  2350*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2351*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2352*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2353
  2354         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2355             88  ST-ACCNT-CNTL               VALUE ' '.
  2356             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2357             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2358             88  ACCNT-CNTL                  VALUE '3'.
  2359             88  CARR-ACCNT-CNTL             VALUE '4'.
  2360
  2361         16  PI-PROCESSOR-CAP-LIST.
  2362             20  PI-SYSTEM-CONTROLS.
  2363                24 PI-SYSTEM-DISPLAY     PIC X.
  2364                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2365                24 PI-SYSTEM-MODIFY      PIC X.
  2366                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2367             20  FILLER                  PIC XX.
  2368             20  PI-DISPLAY-CAP          PIC X.
  2369                 88  DISPLAY-CAP             VALUE 'Y'.
  2370             20  PI-MODIFY-CAP           PIC X.
  2371                 88  MODIFY-CAP              VALUE 'Y'.
  2372             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2373                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2374             20  PI-FORCE-CAP            PIC X.
  2375                 88  FORCE-CAP               VALUE 'Y'.
  2376
  2377         16  PI-PROGRAM-CONTROLS.
  2378             20  PI-PGM-PRINT-OPT        PIC X.
  2379             20  PI-PGM-FORMAT-OPT       PIC X.
  2380             20  PI-PGM-PROCESS-OPT      PIC X.
  2381             20  PI-PGM-TOTALS-OPT       PIC X.
  2382
  2383         16  PI-HELP-INTERFACE.
  2384             20  PI-LAST-ERROR-NO        PIC X(4).
  2385             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2386
  2387         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2388             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2389
  2390         16  PI-CR-CONTROL-IN-PROGRESS.
  2391             20  PI-CR-CARRIER           PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  43
* EL115.cbl
  2392             20  PI-CR-GROUPING          PIC X(6).
  2393             20  PI-CR-STATE             PIC XX.
  2394             20  PI-CR-ACCOUNT           PIC X(10).
  2395             20  PI-CR-FIN-RESP          PIC X(10).
  2396             20  PI-CR-TYPE              PIC X.
  2397
  2398         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2399
  2400         16  PI-CR-MONTH-END-DT          PIC XX.
  2401
  2402         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2403             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2404             88  PI-ZERO-CARRIER             VALUE '1'.
  2405             88  PI-ZERO-GROUPING            VALUE '2'.
  2406             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2407
  2408         16  PI-CARRIER-SECURITY         PIC X.
  2409             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2410
  2411         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2412             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2413             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  2414
  2415         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2416             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2417                                         INDEXED BY PI-ACCESS-NDX
  2418                                         PIC X.
  2419
  2420         16  PI-GA-BILLING-CONTROL       PIC X.
  2421             88  PI-GA-BILLING               VALUE '1'.
  2422
  2423         16  PI-MAIL-PROCESSING          PIC X.
  2424             88  PI-MAIL-YES                 VALUE 'Y'.
  2425
  2426         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2427
  2428         16  PI-AR-SYSTEM.
  2429             20  PI-AR-PROCESSING-CNTL   PIC X.
  2430                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2431             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2432             20  PI-AR-MONTH-END-DT      PIC XX.
  2433
  2434         16  PI-MP-SYSTEM.
  2435             20  PI-MORTGAGE-USER            PIC X.
  2436                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2437                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2438             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2439                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2440                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2441                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2442                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2443                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2444             20  PI-MP-MONTH-END-DT          PIC XX.
  2445             20  PI-MP-REFERENCE-NO.
  2446                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2447                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2448
  2449         16  PI-LABEL-CONTROL            PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  44
* EL115.cbl
  2450             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2451             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2452
  2453         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2454             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2455
  2456         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2457             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2458             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2459
  2460         16  FILLER                      PIC X(14).
  2461
  2462     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2463******************************************************************
  2464     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  2465         16  PI-PREV-KEY.
  2466             20  PI-PREV-COMP-ID PIC XXX.
  2467             20  PI-PREV-CARR    PIC X.
  2468             20  PI-PREV-GROUP   PIC X(6).
  2469             20  PI-PREV-STATE   PIC XX.
  2470             20  PI-PREV-EXP-DT  PIC 9(8).
  2471         16  FILLER              PIC X(620).
  2472*                                COPY ELCAID.
  2473******************************************************************
  2474*                                                                *
  2475*                            ELCAID.                             *
  2476*                            VMOD=2.001                          *
  2477*                                                                *
  2478*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2479*                                                                *
  2480*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2481*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2482******************************************************************
  2483
  2484 01  DFHAID.
  2485   02  DFHNULL   PIC  X  VALUE  ' '.
  2486   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2487   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2488   02  DFHPEN    PIC  X  VALUE  '='.
  2489   02  DFHOPID   PIC  X  VALUE  'W'.
  2490   02  DFHPA1    PIC  X  VALUE  '%'.
  2491   02  DFHPA2    PIC  X  VALUE  '>'.
  2492   02  DFHPA3    PIC  X  VALUE  ','.
  2493   02  DFHPF1    PIC  X  VALUE  '1'.
  2494   02  DFHPF2    PIC  X  VALUE  '2'.
  2495   02  DFHPF3    PIC  X  VALUE  '3'.
  2496   02  DFHPF4    PIC  X  VALUE  '4'.
  2497   02  DFHPF5    PIC  X  VALUE  '5'.
  2498   02  DFHPF6    PIC  X  VALUE  '6'.
  2499   02  DFHPF7    PIC  X  VALUE  '7'.
  2500   02  DFHPF8    PIC  X  VALUE  '8'.
  2501   02  DFHPF9    PIC  X  VALUE  '9'.
  2502   02  DFHPF10   PIC  X  VALUE  ':'.
  2503   02  DFHPF11   PIC  X  VALUE  '#'.
  2504   02  DFHPF12   PIC  X  VALUE  '@'.
  2505   02  DFHPF13   PIC  X  VALUE  'A'.
  2506   02  DFHPF14   PIC  X  VALUE  'B'.
  2507   02  DFHPF15   PIC  X  VALUE  'C'.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  45
* EL115.cbl
  2508   02  DFHPF16   PIC  X  VALUE  'D'.
  2509   02  DFHPF17   PIC  X  VALUE  'E'.
  2510   02  DFHPF18   PIC  X  VALUE  'F'.
  2511   02  DFHPF19   PIC  X  VALUE  'G'.
  2512   02  DFHPF20   PIC  X  VALUE  'H'.
  2513   02  DFHPF21   PIC  X  VALUE  'I'.
  2514*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2515   02  DFHPF22   PIC  X  VALUE  '['.
  2516   02  DFHPF23   PIC  X  VALUE  '.'.
  2517   02  DFHPF24   PIC  X  VALUE  '<'.
  2518   02  DFHMSRE   PIC  X  VALUE  'X'.
  2519   02  DFHSTRF   PIC  X  VALUE  'h'.
  2520   02  DFHTRIG   PIC  X  VALUE  '"'.
  2521 01  FILLER REDEFINES DFHAID.
  2522     12  FILLER              PIC X(8).
  2523     12  PF-VALUES           PIC X       OCCURS 2.
  2524*                                COPY EL115S.
  2525 01  EL115AI.
  2526     05  FILLER            PIC  X(0012).
  2527*    -------------------------------
  2528     05  RUNDTEL PIC S9(0004) COMP.
  2529     05  RUNDTEF PIC  X(0001).
  2530     05  FILLER REDEFINES RUNDTEF.
  2531         10  RUNDTEA PIC  X(0001).
  2532     05  RUNDTEI PIC  X(0008).
  2533*    -------------------------------
  2534     05  RUNTIMEL PIC S9(0004) COMP.
  2535     05  RUNTIMEF PIC  X(0001).
  2536     05  FILLER REDEFINES RUNTIMEF.
  2537         10  RUNTIMEA PIC  X(0001).
  2538     05  RUNTIMEI PIC  X(0005).
  2539*    -------------------------------
  2540     05  MAINTL PIC S9(0004) COMP.
  2541     05  MAINTF PIC  X(0001).
  2542     05  FILLER REDEFINES MAINTF.
  2543         10  MAINTA PIC  X(0001).
  2544     05  MAINTI PIC  X(0001).
  2545*    -------------------------------
  2546     05  LSTUSRL PIC S9(0004) COMP.
  2547     05  LSTUSRF PIC  X(0001).
  2548     05  FILLER REDEFINES LSTUSRF.
  2549         10  LSTUSRA PIC  X(0001).
  2550     05  LSTUSRI PIC  X(0004).
  2551*    -------------------------------
  2552     05  LSTDTEL PIC S9(0004) COMP.
  2553     05  LSTDTEF PIC  X(0001).
  2554     05  FILLER REDEFINES LSTDTEF.
  2555         10  LSTDTEA PIC  X(0001).
  2556     05  LSTDTEI PIC  X(0010).
  2557*    -------------------------------
  2558     05  LSTTIMEL PIC S9(0004) COMP.
  2559     05  LSTTIMEF PIC  X(0001).
  2560     05  FILLER REDEFINES LSTTIMEF.
  2561         10  LSTTIMEA PIC  X(0001).
  2562     05  LSTTIMEI PIC  X(0005).
  2563*    -------------------------------
  2564     05  CARRL PIC S9(0004) COMP.
  2565     05  CARRF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  46
* EL115.cbl
  2566     05  FILLER REDEFINES CARRF.
  2567         10  CARRA PIC  X(0001).
  2568     05  CARRI PIC  X(0001).
  2569*    -------------------------------
  2570     05  GROUPL PIC S9(0004) COMP.
  2571     05  GROUPF PIC  X(0001).
  2572     05  FILLER REDEFINES GROUPF.
  2573         10  GROUPA PIC  X(0001).
  2574     05  GROUPI PIC  X(0006).
  2575*    -------------------------------
  2576     05  STATEL PIC S9(0004) COMP.
  2577     05  STATEF PIC  X(0001).
  2578     05  FILLER REDEFINES STATEF.
  2579         10  STATEA PIC  X(0001).
  2580     05  STATEI PIC  X(0002).
  2581*    -------------------------------
  2582     05  EXPDTL PIC S9(0004) COMP.
  2583     05  EXPDTF PIC  X(0001).
  2584     05  FILLER REDEFINES EXPDTF.
  2585         10  EXPDTA PIC  X(0001).
  2586     05  EXPDTI PIC  X(0010).
  2587*    -------------------------------
  2588     05  LFTAXL PIC S9(0004) COMP.
  2589     05  LFTAXF PIC  X(0001).
  2590     05  FILLER REDEFINES LFTAXF.
  2591         10  LFTAXA PIC  X(0001).
  2592     05  LFTAXI PIC  X(0005).
  2593*    -------------------------------
  2594     05  AHITAXL PIC S9(0004) COMP.
  2595     05  AHITAXF PIC  X(0001).
  2596     05  FILLER REDEFINES AHITAXF.
  2597         10  AHITAXA PIC  X(0001).
  2598     05  AHITAXI PIC  X(0005).
  2599*    -------------------------------
  2600     05  AHGTAXL PIC S9(0004) COMP.
  2601     05  AHGTAXF PIC  X(0001).
  2602     05  FILLER REDEFINES AHGTAXF.
  2603         10  AHGTAXA PIC  X(0001).
  2604     05  AHGTAXI PIC  X(0005).
  2605*    -------------------------------
  2606     05  LFREDL PIC S9(0004) COMP.
  2607     05  LFREDF PIC  X(0001).
  2608     05  FILLER REDEFINES LFREDF.
  2609         10  LFREDA PIC  X(0001).
  2610     05  LFREDI PIC  X(0001).
  2611*    -------------------------------
  2612     05  LFLEVL PIC S9(0004) COMP.
  2613     05  LFLEVF PIC  X(0001).
  2614     05  FILLER REDEFINES LFLEVF.
  2615         10  LFLEVA PIC  X(0001).
  2616     05  LFLEVI PIC  X(0001).
  2617*    -------------------------------
  2618     05  LFNETL PIC S9(0004) COMP.
  2619     05  LFNETF PIC  X(0001).
  2620     05  FILLER REDEFINES LFNETF.
  2621         10  LFNETA PIC  X(0001).
  2622     05  LFNETI PIC  X(0001).
  2623*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  47
* EL115.cbl
  2624     05  AHAHL PIC S9(0004) COMP.
  2625     05  AHAHF PIC  X(0001).
  2626     05  FILLER REDEFINES AHAHF.
  2627         10  AHAHA PIC  X(0001).
  2628     05  AHAHI PIC  X(0001).
  2629*    -------------------------------
  2630     05  AHCPL PIC S9(0004) COMP.
  2631     05  AHCPF PIC  X(0001).
  2632     05  FILLER REDEFINES AHCPF.
  2633         10  AHCPA PIC  X(0001).
  2634     05  AHCPI PIC  X(0001).
  2635*    -------------------------------
  2636     05  ERRMSGL PIC S9(0004) COMP.
  2637     05  ERRMSGF PIC  X(0001).
  2638     05  FILLER REDEFINES ERRMSGF.
  2639         10  ERRMSGA PIC  X(0001).
  2640     05  ERRMSGI PIC  X(0079).
  2641*    -------------------------------
  2642     05  ENTERPFL PIC S9(0004) COMP.
  2643     05  ENTERPFF PIC  X(0001).
  2644     05  FILLER REDEFINES ENTERPFF.
  2645         10  ENTERPFA PIC  X(0001).
  2646     05  ENTERPFI PIC  9(2).
  2647 01  EL115AO REDEFINES EL115AI.
  2648     05  FILLER            PIC  X(0012).
  2649*    -------------------------------
  2650     05  FILLER            PIC  X(0003).
  2651     05  RUNDTEO PIC  X(0008).
  2652*    -------------------------------
  2653     05  FILLER            PIC  X(0003).
  2654     05  RUNTIMEO PIC  99.99.
  2655*    -------------------------------
  2656     05  FILLER            PIC  X(0003).
  2657     05  MAINTO PIC  X(0001).
  2658*    -------------------------------
  2659     05  FILLER            PIC  X(0003).
  2660     05  LSTUSRO PIC  X(0004).
  2661*    -------------------------------
  2662     05  FILLER            PIC  X(0003).
  2663     05  LSTDTEO PIC  X(0010).
  2664*    -------------------------------
  2665     05  FILLER            PIC  X(0003).
  2666     05  LSTTIMEO PIC  99.99.
  2667*    -------------------------------
  2668     05  FILLER            PIC  X(0003).
  2669     05  CARRO PIC  X(0001).
  2670*    -------------------------------
  2671     05  FILLER            PIC  X(0003).
  2672     05  GROUPO PIC  X(0006).
  2673*    -------------------------------
  2674     05  FILLER            PIC  X(0003).
  2675     05  STATEO PIC  X(0002).
  2676*    -------------------------------
  2677     05  FILLER            PIC  X(0003).
  2678     05  EXPDTO PIC  X(0010).
  2679*    -------------------------------
  2680     05  FILLER            PIC  X(0003).
  2681     05  LFTAXO PIC  .9999.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  48
* EL115.cbl
  2682*    -------------------------------
  2683     05  FILLER            PIC  X(0003).
  2684     05  AHITAXO PIC  .9999.
  2685*    -------------------------------
  2686     05  FILLER            PIC  X(0003).
  2687     05  AHGTAXO PIC  .9999.
  2688*    -------------------------------
  2689     05  FILLER            PIC  X(0003).
  2690     05  LFREDO PIC  X(0001).
  2691*    -------------------------------
  2692     05  FILLER            PIC  X(0003).
  2693     05  LFLEVO PIC  X(0001).
  2694*    -------------------------------
  2695     05  FILLER            PIC  X(0003).
  2696     05  LFNETO PIC  X(0001).
  2697*    -------------------------------
  2698     05  FILLER            PIC  X(0003).
  2699     05  AHAHO PIC  X(0001).
  2700*    -------------------------------
  2701     05  FILLER            PIC  X(0003).
  2702     05  AHCPO PIC  X(0001).
  2703*    -------------------------------
  2704     05  FILLER            PIC  X(0003).
  2705     05  ERRMSGO PIC  X(0079).
  2706*    -------------------------------
  2707     05  FILLER            PIC  X(0003).
  2708     05  ENTERPFO PIC  X(0002).
  2709*    -------------------------------
  2710****************************************************************
  2711*
  2712* Copyright (c) 2007 by Clerity Solutions, Inc.
  2713* All rights reserved.
  2714*
  2715****************************************************************
  2716 01  DFHEIV.
  2717   02  DFHEIV0               PIC X(35).
  2718   02  DFHEIV1               PIC X(08).
  2719   02  DFHEIV2               PIC X(08).
  2720   02  DFHEIV3               PIC X(08).
  2721   02  DFHEIV4               PIC X(06).
  2722   02  DFHEIV5               PIC X(04).
  2723   02  DFHEIV6               PIC X(04).
  2724   02  DFHEIV7               PIC X(02).
  2725   02  DFHEIV8               PIC X(02).
  2726   02  DFHEIV9               PIC X(01).
  2727   02  DFHEIV10              PIC S9(7) COMP-3.
  2728   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2729   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2730   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2731   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2732   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2733   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2734   02  DFHEIV17              PIC X(04).
  2735   02  DFHEIV18              PIC X(04).
  2736   02  DFHEIV19              PIC X(04).
  2737   02  DFHEIV20              USAGE IS POINTER.
  2738   02  DFHEIV21              USAGE IS POINTER.
  2739   02  DFHEIV22              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  49
* EL115.cbl
  2740   02  DFHEIV23              USAGE IS POINTER.
  2741   02  DFHEIV24              USAGE IS POINTER.
  2742   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2743   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2744   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2745   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2746   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2747   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2748   02  FILLER                PIC X(02).
  2749   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2750   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2751   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2752   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2753   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2754 LINKAGE  SECTION.
  2755*****************************************************************
  2756*                                                               *
  2757* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2758* All rights reserved.                                          *
  2759*                                                               *
  2760*****************************************************************
  2761 01  dfheiblk.
  2762     02  eibtime          pic s9(7) comp-3.
  2763     02  eibdate          pic s9(7) comp-3.
  2764     02  eibtrnid         pic x(4).
  2765     02  eibtaskn         pic s9(7) comp-3.
  2766     02  eibtrmid         pic x(4).
  2767     02  dfheigdi         pic s9(4) comp.
  2768     02  eibcposn         pic s9(4) comp.
  2769     02  eibcalen         pic s9(4) comp.
  2770     02  eibaid           pic x(1).
  2771     02  eibfiller1       pic x(1).
  2772     02  eibfn            pic x(2).
  2773     02  eibfiller2       pic x(2).
  2774     02  eibrcode         pic x(6).
  2775     02  eibfiller3       pic x(2).
  2776     02  eibds            pic x(8).
  2777     02  eibreqid         pic x(8).
  2778     02  eibrsrce         pic x(8).
  2779     02  eibsync          pic x(1).
  2780     02  eibfree          pic x(1).
  2781     02  eibrecv          pic x(1).
  2782     02  eibsend          pic x(1).
  2783     02  eibatt           pic x(1).
  2784     02  eibeoc           pic x(1).
  2785     02  eibfmh           pic x(1).
  2786     02  eibcompl         pic x(1).
  2787     02  eibsig           pic x(1).
  2788     02  eibconf          pic x(1).
  2789     02  eiberr           pic x(1).
  2790     02  eibrldbk         pic x(1).
  2791     02  eiberrcd         pic x(4).
  2792     02  eibsynrb         pic x(1).
  2793     02  eibnodat         pic x(1).
  2794     02  eibfiller5       pic x(2).
  2795     02  eibresp          pic 9(09) comp.
  2796     02  eibresp2         pic 9(09) comp.
  2797     02  dfheigdj         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  50
* EL115.cbl
  2798     02  dfheigdk         pic s9(4) comp.
  2799 01  DFHCOMMAREA             PIC X(1500).
  2800*01 PARMLIST .
  2801*    02  FILLER              PIC S9(8)   COMP.
  2802*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  2803*    02  ELLETR-POINTER      PIC S9(8)   COMP.
  2804 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  2805 0000-DFHEXIT SECTION.
  2806     MOVE '9#                    $   ' TO DFHEIV0.
  2807     MOVE 'EL115' TO DFHEIV1.
  2808     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2809     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  2810     MOVE '5'                    TO DC-OPTION-CODE
  2811     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  2812     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  2813     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  2814     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  2815     MOVE 2                      TO EMI-NUMBER-OF-LINES
  2816                                    EMI-SWITCH2
  2817     MOVE EIBTRMID               TO QID-TERM
  2818     IF EIBCALEN = 0
  2819        GO TO 8800-UNAUTHORIZED-ACCESS
  2820     END-IF
  2821     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  2822        MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  2823     ELSE
  2824        MOVE SPACES             TO RETURNED-FROM
  2825     END-IF
  2826     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2827        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2828           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  2829           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2830           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2831           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2832           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2833           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2834           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2835           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  2836           PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  2837        ELSE
  2838           MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  2839           MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  2840           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  2841           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  2842           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  2843           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  2844           MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  2845           MOVE SPACES               TO PI-SAVED-PROGRAM-6
  2846        END-IF
  2847     END-IF
  2848     MOVE 'N' TO WS-DISPLAY-SW.
  2849
  2850* EXEC CICS HANDLE CONDITION
  2851*        NOTOPEN (8870-NOTOPEN)
  2852*        PGMIDERR(9600-PGMID-ERROR)
  2853*        ERROR   (9990-ABEND)
  2854*    END-EXEC.
  2855*    MOVE '"$JL.                 ! " #00002845' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  51
* EL115.cbl
  2856     MOVE X'22244A4C2E20202020202020' TO DFHEIV0(1:12)
  2857     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2858     MOVE X'2220233030303032383435' TO DFHEIV0(25:11)
  2859     CALL 'kxdfhei1' USING DFHEIV0
  2860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2861
  2862     IF EIBTRNID NOT = TRANS-ID
  2863        MOVE LOW-VALUES          TO EL115AO
  2864        GO TO 8100-SEND-INITIAL-MAP
  2865     END-IF
  2866     IF EIBAID = DFHCLEAR
  2867        GO TO 9400-CLEAR
  2868     END-IF
  2869     IF NOT DISPLAY-CAP
  2870        MOVE 'READ'              TO SM-READ
  2871        PERFORM 9995-SECURITY-VIOLATION
  2872        MOVE ER-0070             TO EMI-ERROR
  2873        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2874        GO TO 8100-SEND-INITIAL-MAP
  2875     END-IF
  2876     .
  2877 0200-RECEIVE.
  2878     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  2879        MOVE LOW-VALUES          TO EL115AI
  2880        MOVE ER-7008             TO EMI-ERROR
  2881        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2882        MOVE -1                  TO MAINTL
  2883        GO TO 8200-SEND-DATAONLY
  2884     END-IF
  2885
  2886* EXEC CICS RECEIVE
  2887*        MAP   (MAP-NAME)
  2888*        MAPSET(MAPSET-NAME)
  2889*        INTO  (EL115AI)
  2890*    END-EXEC
  2891     MOVE LENGTH OF
  2892      EL115AI
  2893       TO DFHEIV11
  2894*    MOVE '8"T I  L              ''   #00002873' TO DFHEIV0
  2895     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2896     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2897     MOVE X'2020233030303032383733' TO DFHEIV0(25:11)
  2898     CALL 'kxdfhei1' USING DFHEIV0,
  2899           MAP-NAME,
  2900           EL115AI,
  2901           DFHEIV11,
  2902           MAPSET-NAME,
  2903           DFHEIV99,
  2904           DFHEIV99
  2905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2906     IF ENTERPFL = 0
  2907        GO TO 0300-CHECK-PFKEYS
  2908     END-IF
  2909     IF EIBAID NOT = DFHENTER
  2910        MOVE ER-0004             TO EMI-ERROR
  2911        GO TO 0320-INPUT-ERROR
  2912     END-IF
  2913     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  52
* EL115.cbl
  2914        MOVE PF-VALUES (ENTERPFI) TO EIBAID
  2915     ELSE
  2916        MOVE ER-0029             TO EMI-ERROR
  2917        GO TO 0320-INPUT-ERROR
  2918     END-IF
  2919     .
  2920 0300-CHECK-PFKEYS.
  2921     IF EIBAID = DFHPF23
  2922         GO TO 8810-PF23.
  2923     IF EIBAID = DFHPF24
  2924         GO TO 9200-RETURN-MAIN-MENU.
  2925     IF EIBAID = DFHPF12
  2926         GO TO 9500-PF12.
  2927     IF MAINTL NOT = 0  AND
  2928        EIBAID NOT = DFHENTER
  2929          MOVE ER-0050 TO EMI-ERROR
  2930          GO TO 0320-INPUT-ERROR.
  2931     IF EIBAID = DFHPF1
  2932         GO TO 5000-FIND-NEXT-STATE.
  2933     IF EIBAID = DFHPF2
  2934         GO TO 5500-FIND-PREV-STATE.
  2935     IF EIBAID = DFHENTER
  2936         GO TO 0330-EDIT-DATA.
  2937     MOVE ER-0029 TO EMI-ERROR.
  2938 0320-INPUT-ERROR.
  2939     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  2940     MOVE AL-UNBON               TO ENTERPFA
  2941     IF ENTERPFL = 0
  2942        MOVE -1                  TO MAINTL
  2943     ELSE
  2944        MOVE -1                  TO ENTERPFL
  2945     END-IF
  2946     GO TO 8200-SEND-DATAONLY
  2947     .
  2948 0330-EDIT-DATA.
  2949     IF MAINTI = 'S'
  2950        GO TO 1000-SHOW-STATE
  2951     END-IF
  2952     IF MODIFY-CAP
  2953        CONTINUE
  2954     ELSE
  2955        IF MAINTI = 'A' OR 'C' OR 'D'
  2956           MOVE 'UPDATE'         TO SM-READ
  2957           PERFORM 9995-SECURITY-VIOLATION
  2958           MOVE ER-0070          TO EMI-ERROR
  2959           PERFORM 9900-ERROR-FORMAT
  2960                                 THRU 9900-EXIT
  2961           MOVE LOW-VALUES       TO EL115AO
  2962           GO TO 8100-SEND-INITIAL-MAP
  2963        END-IF
  2964     END-IF
  2965     IF MAINTI = 'C'
  2966         GO TO 2000-CHANGE-STATE.
  2967     IF MAINTI = 'A'
  2968         GO TO 3000-ADD-STATE.
  2969     IF MAINTI = 'D'
  2970         GO TO 4000-DELETE-STATE.
  2971     MOVE ER-0023 TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  53
* EL115.cbl
  2972     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2973     MOVE -1       TO MAINTL.
  2974     MOVE AL-UABON TO MAINTA.
  2975     GO TO 8200-SEND-DATAONLY.
  2976     .
  2977 0700-BUILD-KEY.
  2978     MOVE PI-COMPANY-ID          TO STATE-COMP-ID
  2979     MOVE CARRI                  TO STATE-CARRIER
  2980     MOVE GROUPI                 TO STATE-GROUPING
  2981     MOVE STATEI                 TO STATE-STATE-CD
  2982     MOVE EXPDTI                 TO DEEDIT-FIELD
  2983     PERFORM 8600-DEEDIT         THRU 8600-EXIT
  2984     IF WS-NUMVAL-OF-DEEDIT >= 99000000
  2985        MOVE 99999999            TO STATE-EXP-DT
  2986     ELSE
  2987        STRING WS-NUMVAL (8:4) WS-NUMVAL (4:2) WS-NUMVAL (6:2)
  2988           DELIMITED BY SIZE INTO STATE-EXP-DT
  2989        END-STRING
  2990     END-IF
  2991*    display ' 0700 build ' expdti ' ' ws-numval ' ' state-exp-dt
  2992     .
  2993 0700-EXIT.
  2994     EXIT.
  2995 0750-EDIT-KEY.
  2996     MOVE SPACES                 TO ELCNTL-ACCESS
  2997     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID
  2998     MOVE '6'                    TO ELCNTL-REC-TYPE
  2999     MOVE STATE-CARRIER          TO ELCNTL-ACCESS (4:1)
  3000     MOVE +0                     TO ELCNTL-SEQ-NO
  3001
  3002* EXEC CICS READ
  3003*        DATASET (ELCNTL-ID)
  3004*        INTO    (CONTROL-FILE)
  3005*        RIDFLD  (ELCNTL-KEY)
  3006*        RESP    (WS-RESPONSE)
  3007*    END-EXEC
  3008     MOVE LENGTH OF
  3009      CONTROL-FILE
  3010       TO DFHEIV11
  3011*    MOVE '&"IL       E          (  N#00002973' TO DFHEIV0
  3012     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3013     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3014     MOVE X'204E233030303032393733' TO DFHEIV0(25:11)
  3015     CALL 'kxdfhei1' USING DFHEIV0,
  3016           ELCNTL-ID,
  3017           CONTROL-FILE,
  3018           DFHEIV11,
  3019           ELCNTL-KEY,
  3020           DFHEIV99,
  3021           DFHEIV99,
  3022           DFHEIV99
  3023     MOVE EIBRESP  TO WS-RESPONSE
  3024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3025     IF NOT RESP-NORMAL
  3026        MOVE ER-2845             TO EMI-ERROR
  3027        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3028        MOVE -1                  TO CARRL
  3029        MOVE AL-UABON            TO CARRA
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  54
* EL115.cbl
  3030     END-IF
  3031     IF (GROUPL = ZEROS)
  3032        OR (GROUPI = SPACES OR LOW-VALUES)
  3033        MOVE ER-0235             TO EMI-ERROR
  3034        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3035        MOVE -1                  TO CARRL
  3036        MOVE AL-UABON            TO CARRA
  3037     END-IF
  3038     MOVE SPACES                 TO ELCNTL-ACCESS
  3039     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID
  3040     MOVE '3'                    TO ELCNTL-REC-TYPE
  3041     MOVE STATE-STATE-CD         TO ELCNTL-ACCESS (1:2)
  3042     MOVE +0                     TO ELCNTL-SEQ-NO
  3043
  3044* EXEC CICS READ
  3045*        DATASET (ELCNTL-ID)
  3046*        INTO    (CONTROL-FILE)
  3047*        RIDFLD  (ELCNTL-KEY)
  3048*        RESP    (WS-RESPONSE)
  3049*    END-EXEC
  3050     MOVE LENGTH OF
  3051      CONTROL-FILE
  3052       TO DFHEIV11
  3053*    MOVE '&"IL       E          (  N#00002997' TO DFHEIV0
  3054     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3055     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3056     MOVE X'204E233030303032393937' TO DFHEIV0(25:11)
  3057     CALL 'kxdfhei1' USING DFHEIV0,
  3058           ELCNTL-ID,
  3059           CONTROL-FILE,
  3060           DFHEIV11,
  3061           ELCNTL-KEY,
  3062           DFHEIV99,
  3063           DFHEIV99,
  3064           DFHEIV99
  3065     MOVE EIBRESP  TO WS-RESPONSE
  3066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3067     IF NOT RESP-NORMAL
  3068        MOVE ER-2603             TO EMI-ERROR
  3069        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3070        MOVE -1                  TO STATEL
  3071        MOVE AL-UABON            TO STATEA
  3072     END-IF
  3073     IF STATE-EXP-DT-NUM NOT = 99999999
  3074        MOVE STATE-EXP-DT-NUM    TO DC-GREG-DATE-CYMD
  3075        MOVE 'L'                 TO DC-OPTION-CODE
  3076        MOVE +0                  TO DC-ELAPSED-DAYS
  3077                                    DC-ELAPSED-MONTHS
  3078        PERFORM 9700-LINK-DATE-CONVERT
  3079                                 THRU 9700-EXIT
  3080        IF NOT NO-CONVERSION-ERROR
  3081           MOVE ER-8008          TO EMI-ERROR
  3082           PERFORM 9900-ERROR-FORMAT
  3083                                 THRU 9900-EXIT
  3084           MOVE -1               TO EXPDTL
  3085           MOVE AL-UABON         TO EXPDTA
  3086        END-IF
  3087     END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  55
* EL115.cbl
  3088     .
  3089 0750-EXIT.
  3090     EXIT.
  3091 1000-SHOW-STATE.
  3092     PERFORM 0700-BUILD-KEY      THRU 0700-EXIT
  3093
  3094* EXEC CICS READ
  3095*        DATASET (ELSTAT-ID)
  3096*        INTO    (STATE-FILE)
  3097*        RIDFLD  (STATE-KEY)
  3098*        RESP    (WS-RESPONSE)
  3099*    END-EXEC
  3100     MOVE LENGTH OF
  3101      STATE-FILE
  3102       TO DFHEIV11
  3103*    MOVE '&"IL       E          (  N#00003029' TO DFHEIV0
  3104     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3105     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3106     MOVE X'204E233030303033303239' TO DFHEIV0(25:11)
  3107     CALL 'kxdfhei1' USING DFHEIV0,
  3108           ELSTAT-ID,
  3109           STATE-FILE,
  3110           DFHEIV11,
  3111           STATE-KEY,
  3112           DFHEIV99,
  3113           DFHEIV99,
  3114           DFHEIV99
  3115     MOVE EIBRESP  TO WS-RESPONSE
  3116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3117     IF RESP-NORMAL
  3118        MOVE STATE-KEY           TO PI-PREV-KEY
  3119        GO TO 7000-BUILD-OUTPUT-MAP
  3120     END-IF
  3121     MOVE ER-0149                TO EMI-ERROR
  3122     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  3123     MOVE -1                     TO STATEL
  3124     MOVE AL-UABON               TO STATEA
  3125     GO TO 8200-SEND-DATAONLY
  3126     .
  3127 1050-UPDATE-RECORD.
  3128     MOVE PI-PROCESSOR-ID        TO SF-LAST-MAINT-BY
  3129     MOVE EIBTIME                TO SF-LAST-MAINT-HHMMSS
  3130     MOVE SAVE-BIN-DATE          TO SF-LAST-MAINT-DT
  3131     IF LFREDL > ZEROS
  3132        MOVE LFREDI               TO SF-ST-RF-LR-CALC
  3133     END-IF
  3134     IF LFLEVL NOT = ZEROS
  3135        MOVE LFLEVI               TO SF-ST-RF-LL-CALC
  3136     END-IF
  3137     IF LFNETL NOT = ZEROS
  3138        MOVE LFNETI               TO SF-ST-RF-LN-CALC
  3139     END-IF
  3140     IF AHAHL NOT = ZEROS
  3141        MOVE AHAHI                TO SF-ST-RF-AH-CALC
  3142     END-IF
  3143     IF AHCPL NOT = ZEROS
  3144        MOVE AHCPI                TO SF-ST-RF-CP-CALC
  3145     END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  56
* EL115.cbl
  3146     IF LFTAXL > +0
  3147        MOVE WS-ST-LF-PREM-TAX   TO SF-ST-LF-PREM-TAX
  3148     END-IF
  3149     IF AHITAXL > +0
  3150        MOVE WS-ST-AH-PREM-TAX-I TO SF-ST-AH-PREM-TAX-I
  3151     END-IF
  3152     IF AHGTAXL > +0
  3153        MOVE WS-ST-AH-PREM-TAX-G TO SF-ST-AH-PREM-TAX-G
  3154     END-IF
  3155     .
  3156 1050-EXIT.
  3157     EXIT.
  3158 2000-CHANGE-STATE.
  3159     PERFORM 0700-BUILD-KEY      THRU 0700-EXIT
  3160     IF STATE-KEY NOT = PI-PREV-KEY
  3161        MOVE ER-0145             TO EMI-ERROR
  3162        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3163        MOVE -1                  TO STATEL
  3164        MOVE AL-UABON            TO STATEA
  3165        GO TO 8200-SEND-DATAONLY
  3166     END-IF
  3167     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  3168     IF NOT EMI-NO-ERRORS
  3169        GO TO 8200-SEND-DATAONLY
  3170     END-IF
  3171
  3172* EXEC CICS READ
  3173*        UPDATE
  3174*        DATASET(ELSTAT-ID)
  3175*        INTO   (STATE-FILE)
  3176*        RIDFLD (STATE-KEY)
  3177*        RESP   (WS-RESPONSE)
  3178*    END-EXEC
  3179     MOVE LENGTH OF
  3180      STATE-FILE
  3181       TO DFHEIV11
  3182*    MOVE '&"IL       EU         (  N#00003089' TO DFHEIV0
  3183     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3184     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3185     MOVE X'204E233030303033303839' TO DFHEIV0(25:11)
  3186     CALL 'kxdfhei1' USING DFHEIV0,
  3187           ELSTAT-ID,
  3188           STATE-FILE,
  3189           DFHEIV11,
  3190           STATE-KEY,
  3191           DFHEIV99,
  3192           DFHEIV99,
  3193           DFHEIV99
  3194     MOVE EIBRESP  TO WS-RESPONSE
  3195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3196     IF NOT RESP-NORMAL
  3197        MOVE ER-0149             TO EMI-ERROR
  3198        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3199        MOVE -1                  TO STATEL
  3200        MOVE AL-UABON            TO STATEA
  3201        GO TO 8200-SEND-DATAONLY
  3202     END-IF
  3203     IF (SF-LAST-MAINT-BY NOT = PI-UPDATE-BY)
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  57
* EL115.cbl
  3204        OR (SF-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS)
  3205
  3206* EXEC CICS UNLOCK
  3207*            DATASET(ELSTAT-ID)
  3208*        END-EXEC
  3209*    MOVE '&*                    #   #00003105' TO DFHEIV0
  3210     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  3211     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3212     MOVE X'2020233030303033313035' TO DFHEIV0(25:11)
  3213     CALL 'kxdfhei1' USING DFHEIV0,
  3214           ELSTAT-ID,
  3215           DFHEIV99
  3216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3217         MOVE ER-0068 TO EMI-ERROR
  3218         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3219         GO TO 1000-SHOW-STATE
  3220     END-IF
  3221     PERFORM 1050-UPDATE-RECORD  THRU 1050-EXIT
  3222
  3223* EXEC CICS REWRITE
  3224*        DATASET (ELSTAT-ID)
  3225*        FROM    (STATE-FILE)
  3226*        RESP    (WS-RESPONSE)
  3227*    END-EXEC
  3228     MOVE LENGTH OF
  3229      STATE-FILE
  3230       TO DFHEIV11
  3231*    MOVE '&& L                  %  N#00003113' TO DFHEIV0
  3232     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3233     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3234     MOVE X'204E233030303033313133' TO DFHEIV0(25:11)
  3235     CALL 'kxdfhei1' USING DFHEIV0,
  3236           ELSTAT-ID,
  3237           STATE-FILE,
  3238           DFHEIV11,
  3239           DFHEIV99
  3240     MOVE EIBRESP  TO WS-RESPONSE
  3241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3242     IF NOT RESP-NORMAL
  3243        GO TO 9990-ABEND
  3244     END-IF
  3245     MOVE ER-0000                TO EMI-ERROR
  3246     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  3247     GO TO 1000-SHOW-STATE
  3248     .
  3249 3000-ADD-STATE.
  3250     PERFORM 0700-BUILD-KEY      THRU 0700-EXIT
  3251     PERFORM 0750-EDIT-KEY       THRU 0750-EXIT
  3252     IF NOT EMI-NO-ERRORS
  3253         GO TO 8200-SEND-DATAONLY.
  3254     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  3255     IF NOT EMI-NO-ERRORS
  3256         GO TO 8200-SEND-DATAONLY
  3257     END-IF
  3258     MOVE 'SF'                   TO STATE-FILE
  3259     MOVE PI-COMPANY-ID          TO SF-COMPANY-ID
  3260     MOVE STATE-CARRIER          TO SF-CARRIER-CODE
  3261     MOVE STATE-GROUPING         TO SF-GROUPING
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  58
* EL115.cbl
  3262     MOVE STATE-STATE-CD         TO SF-STATE-CODE
  3263     MOVE STATE-EXP-DT-NUM       TO SF-EXPIRE-DATE
  3264     MOVE ZEROS                  TO SF-ST-LF-PREM-TAX
  3265                                    SF-ST-AH-PREM-TAX-I
  3266                                    SF-ST-AH-PREM-TAX-G
  3267     PERFORM 1050-UPDATE-RECORD  THRU 1050-EXIT
  3268
  3269* EXEC CICS WRITE
  3270*        DATASET (ELSTAT-ID)
  3271*        FROM    (STATE-FILE)
  3272*        RIDFLD  (STATE-KEY)
  3273*        RESP    (WS-RESPONSE)
  3274*    END-EXEC
  3275     MOVE LENGTH OF
  3276      STATE-FILE
  3277       TO DFHEIV11
  3278*    MOVE '&$ L                  ''  N#00003144' TO DFHEIV0
  3279     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3280     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3281     MOVE X'204E233030303033313434' TO DFHEIV0(25:11)
  3282     CALL 'kxdfhei1' USING DFHEIV0,
  3283           ELSTAT-ID,
  3284           STATE-FILE,
  3285           DFHEIV11,
  3286           STATE-KEY,
  3287           DFHEIV99,
  3288           DFHEIV99
  3289     MOVE EIBRESP  TO WS-RESPONSE
  3290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3291     IF RESP-DUPREC
  3292        MOVE ER-0147             TO EMI-ERROR
  3293        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3294        MOVE -1                  TO STATEL
  3295        MOVE AL-UABON            TO STATEA
  3296        GO TO 8200-SEND-DATAONLY
  3297     END-IF
  3298     IF NOT RESP-NORMAL
  3299        GO TO 9990-ABEND
  3300     END-IF
  3301     MOVE ER-0000                TO EMI-ERROR
  3302     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  3303     GO TO 1000-SHOW-STATE
  3304     .
  3305 4000-DELETE-STATE.
  3306     PERFORM 0700-BUILD-KEY      THRU 0700-EXIT
  3307     IF STATE-KEY NOT = PI-PREV-KEY
  3308        MOVE ER-0145             TO EMI-ERROR
  3309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3310        MOVE -1                  TO STATEL
  3311        MOVE AL-UABON            TO STATEA
  3312        GO TO 8200-SEND-DATAONLY
  3313     END-IF
  3314
  3315* EXEC CICS READ
  3316*        UPDATE
  3317*        DATASET(ELSTAT-ID)
  3318*        INTO   (STATE-FILE)
  3319*        RIDFLD (STATE-KEY)
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  59
* EL115.cbl
  3320*        RESP   (WS-RESPONSE)
  3321*    END-EXEC
  3322     MOVE LENGTH OF
  3323      STATE-FILE
  3324       TO DFHEIV11
  3325*    MOVE '&"IL       EU         (  N#00003173' TO DFHEIV0
  3326     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3327     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3328     MOVE X'204E233030303033313733' TO DFHEIV0(25:11)
  3329     CALL 'kxdfhei1' USING DFHEIV0,
  3330           ELSTAT-ID,
  3331           STATE-FILE,
  3332           DFHEIV11,
  3333           STATE-KEY,
  3334           DFHEIV99,
  3335           DFHEIV99,
  3336           DFHEIV99
  3337     MOVE EIBRESP  TO WS-RESPONSE
  3338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3339     IF NOT RESP-NORMAL
  3340        MOVE ER-0149             TO EMI-ERROR
  3341        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3342        MOVE -1                  TO STATEL
  3343        MOVE AL-UABON            TO STATEA
  3344        GO TO 8200-SEND-DATAONLY
  3345     END-IF
  3346     IF (SF-LAST-MAINT-BY NOT = PI-UPDATE-BY)
  3347        OR (SF-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS)
  3348
  3349* EXEC CICS UNLOCK
  3350*            DATASET(ELSTAT-ID)
  3351*        END-EXEC
  3352*    MOVE '&*                    #   #00003189' TO DFHEIV0
  3353     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  3354     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3355     MOVE X'2020233030303033313839' TO DFHEIV0(25:11)
  3356     CALL 'kxdfhei1' USING DFHEIV0,
  3357           ELSTAT-ID,
  3358           DFHEIV99
  3359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3360         MOVE ER-0068 TO EMI-ERROR
  3361         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3362         GO TO 1000-SHOW-STATE
  3363     END-IF
  3364     MOVE ER-0000                TO EMI-ERROR
  3365     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  3366     MOVE LOW-VALUES              TO EL115AO
  3367     GO TO 8100-SEND-INITIAL-MAP
  3368     .
  3369 5000-FIND-NEXT-STATE.
  3370     PERFORM 0700-BUILD-KEY      THRU 0700-EXIT
  3371
  3372* EXEC CICS STARTBR
  3373*        DATASET  (ELSTAT-ID)
  3374*        RIDFLD   (STATE-KEY)
  3375*        RESP     (WS-RESPONSE)
  3376*        GTEQ
  3377*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  60
* EL115.cbl
  3378     MOVE 0
  3379       TO DFHEIV11
  3380*    MOVE '&,         G          &  N#00003203' TO DFHEIV0
  3381     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3382     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3383     MOVE X'204E233030303033323033' TO DFHEIV0(25:11)
  3384     CALL 'kxdfhei1' USING DFHEIV0,
  3385           ELSTAT-ID,
  3386           STATE-KEY,
  3387           DFHEIV99,
  3388           DFHEIV11,
  3389           DFHEIV99
  3390     MOVE EIBRESP  TO WS-RESPONSE
  3391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3392     IF RESP-ENDFILE
  3393        MOVE ER-0148             TO EMI-ERROR
  3394        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3395        MOVE -1                  TO MAINTL
  3396        GO TO 8200-SEND-DATAONLY
  3397     ELSE
  3398        IF RESP-NOTFND
  3399           MOVE ER-0149          TO EMI-ERROR
  3400           PERFORM 9900-ERROR-FORMAT
  3401                                 THRU 9900-EXIT
  3402           MOVE -1               TO MAINTL
  3403           GO TO 8200-SEND-DATAONLY
  3404        END-IF
  3405     END-IF
  3406     IF NOT RESP-NORMAL
  3407        GO TO 9990-ABEND
  3408     END-IF
  3409     .
  3410 5050-READ-NEXT.
  3411
  3412* EXEC CICS READNEXT
  3413*        DATASET  (ELSTAT-ID)
  3414*        INTO     (STATE-FILE)
  3415*        RIDFLD   (STATE-KEY)
  3416*        RESP     (WS-RESPONSE)
  3417*    END-EXEC
  3418     MOVE LENGTH OF
  3419      STATE-FILE
  3420       TO DFHEIV12
  3421     MOVE 0
  3422       TO DFHEIV11
  3423*    MOVE '&.IL                  )  N#00003228' TO DFHEIV0
  3424     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3425     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3426     MOVE X'204E233030303033323238' TO DFHEIV0(25:11)
  3427     CALL 'kxdfhei1' USING DFHEIV0,
  3428           ELSTAT-ID,
  3429           STATE-FILE,
  3430           DFHEIV12,
  3431           STATE-KEY,
  3432           DFHEIV99,
  3433           DFHEIV11,
  3434           DFHEIV99,
  3435           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  61
* EL115.cbl
  3436     MOVE EIBRESP  TO WS-RESPONSE
  3437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3438     IF RESP-NORMAL AND STATE-KEY = PI-PREV-KEY
  3439        GO TO 5050-READ-NEXT
  3440     END-IF
  3441
  3442* EXEC CICS ENDBR
  3443*        DATASET   (ELSTAT-ID)
  3444*    END-EXEC
  3445     MOVE 0
  3446       TO DFHEIV11
  3447*    MOVE '&2                    $   #00003237' TO DFHEIV0
  3448     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3449     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3450     MOVE X'2020233030303033323337' TO DFHEIV0(25:11)
  3451     CALL 'kxdfhei1' USING DFHEIV0,
  3452           ELSTAT-ID,
  3453           DFHEIV11,
  3454           DFHEIV99
  3455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3456     IF (RESP-ENDFILE)
  3457        OR (PI-COMPANY-ID NOT = STATE-COMP-ID)
  3458        MOVE ER-0148             TO EMI-ERROR
  3459        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3460        MOVE -1                  TO MAINTL
  3461        GO TO 8200-SEND-DATAONLY
  3462     ELSE
  3463        IF RESP-NOTFND
  3464           MOVE ER-0149          TO EMI-ERROR
  3465           PERFORM 9900-ERROR-FORMAT
  3466                                 THRU 9900-EXIT
  3467           MOVE -1               TO MAINTL
  3468           GO TO 8200-SEND-DATAONLY
  3469        END-IF
  3470     END-IF
  3471     IF NOT RESP-NORMAL
  3472        GO TO 9990-ABEND
  3473     END-IF
  3474     MOVE STATE-KEY              TO PI-PREV-KEY
  3475     GO TO 7000-BUILD-OUTPUT-MAP
  3476     .
  3477 5500-FIND-PREV-STATE.
  3478     PERFORM 0700-BUILD-KEY      THRU 0700-EXIT
  3479
  3480* EXEC CICS STARTBR
  3481*        DATASET  (ELSTAT-ID)
  3482*        RIDFLD   (STATE-KEY)
  3483*        RESP     (WS-RESPONSE)
  3484*        GTEQ
  3485*    END-EXEC
  3486     MOVE 0
  3487       TO DFHEIV11
  3488*    MOVE '&,         G          &  N#00003263' TO DFHEIV0
  3489     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3490     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3491     MOVE X'204E233030303033323633' TO DFHEIV0(25:11)
  3492     CALL 'kxdfhei1' USING DFHEIV0,
  3493           ELSTAT-ID,
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  62
* EL115.cbl
  3494           STATE-KEY,
  3495           DFHEIV99,
  3496           DFHEIV11,
  3497           DFHEIV99
  3498     MOVE EIBRESP  TO WS-RESPONSE
  3499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3500     IF RESP-ENDFILE
  3501        MOVE ER-0131             TO EMI-ERROR
  3502        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3503        MOVE -1                  TO MAINTL
  3504        GO TO 8200-SEND-DATAONLY
  3505     ELSE
  3506        IF RESP-NOTFND
  3507           MOVE ER-0149          TO EMI-ERROR
  3508           PERFORM 9900-ERROR-FORMAT
  3509                                 THRU 9900-EXIT
  3510           MOVE -1               TO MAINTL
  3511           GO TO 8200-SEND-DATAONLY
  3512        END-IF
  3513     END-IF
  3514     IF NOT RESP-NORMAL
  3515        GO TO 9990-ABEND
  3516     END-IF
  3517     .
  3518 5600-READ-PREV.
  3519
  3520* EXEC CICS READPREV
  3521*        DATASET  (ELSTAT-ID)
  3522*        INTO     (STATE-FILE)
  3523*        RIDFLD   (STATE-KEY)
  3524*        RESP     (WS-RESPONSE)
  3525*    END-EXEC
  3526     MOVE LENGTH OF
  3527      STATE-FILE
  3528       TO DFHEIV12
  3529     MOVE 0
  3530       TO DFHEIV11
  3531*    MOVE '&0IL                  )  N#00003288' TO DFHEIV0
  3532     MOVE X'2630494C2020202020202020' TO DFHEIV0(1:12)
  3533     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3534     MOVE X'204E233030303033323838' TO DFHEIV0(25:11)
  3535     CALL 'kxdfhei1' USING DFHEIV0,
  3536           ELSTAT-ID,
  3537           STATE-FILE,
  3538           DFHEIV12,
  3539           STATE-KEY,
  3540           DFHEIV99,
  3541           DFHEIV11,
  3542           DFHEIV99,
  3543           DFHEIV99
  3544     MOVE EIBRESP  TO WS-RESPONSE
  3545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3546     IF RESP-NORMAL AND STATE-KEY = PI-PREV-KEY
  3547        GO TO 5600-READ-PREV
  3548     END-IF
  3549
  3550* EXEC CICS ENDBR
  3551*        DATASET   (ELSTAT-ID)
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  63
* EL115.cbl
  3552*    END-EXEC
  3553     MOVE 0
  3554       TO DFHEIV11
  3555*    MOVE '&2                    $   #00003297' TO DFHEIV0
  3556     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3557     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3558     MOVE X'2020233030303033323937' TO DFHEIV0(25:11)
  3559     CALL 'kxdfhei1' USING DFHEIV0,
  3560           ELSTAT-ID,
  3561           DFHEIV11,
  3562           DFHEIV99
  3563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3564     IF (RESP-ENDFILE)
  3565        OR (PI-COMPANY-ID NOT = STATE-COMP-ID)
  3566        MOVE ER-0148             TO EMI-ERROR
  3567        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3568        MOVE -1                  TO MAINTL
  3569        GO TO 8200-SEND-DATAONLY
  3570     ELSE
  3571        IF RESP-NOTFND
  3572           MOVE ER-0149          TO EMI-ERROR
  3573           PERFORM 9900-ERROR-FORMAT
  3574                                 THRU 9900-EXIT
  3575           MOVE -1               TO MAINTL
  3576           GO TO 8200-SEND-DATAONLY
  3577        END-IF
  3578     END-IF
  3579     IF NOT RESP-NORMAL
  3580        GO TO 9990-ABEND
  3581     END-IF
  3582     MOVE STATE-KEY              TO PI-PREV-KEY
  3583     GO TO 7000-BUILD-OUTPUT-MAP
  3584     .
  3585 6000-EDIT-INPUT-DATA.
  3586     IF LFTAXL > ZEROS
  3587        MOVE LFTAXI              TO DEEDIT-FIELD
  3588        PERFORM 8600-DEEDIT      THRU 8600-EXIT
  3589*       display ' lf tax ' lftaxi ' ' ws-numval ' ' deedit-field
  3590        MOVE WS-NUMVAL-V4        TO WS-ST-LF-PREM-TAX
  3591     END-IF
  3592     IF AHITAXL > ZEROS
  3593        MOVE AHITAXI             TO DEEDIT-FIELD
  3594        PERFORM 8600-DEEDIT      THRU 8600-EXIT
  3595        MOVE WS-NUMVAL-V4        TO WS-ST-AH-PREM-TAX-I
  3596     END-IF
  3597     IF AHGTAXL > ZEROS
  3598        MOVE AHGTAXI             TO DEEDIT-FIELD
  3599        PERFORM 8600-DEEDIT      THRU 8600-EXIT
  3600        MOVE WS-NUMVAL-V4        TO WS-ST-AH-PREM-TAX-G
  3601     END-IF
  3602     IF LFREDL > ZEROS
  3603        MOVE LFREDI              TO WS-VALID-REF-CODES
  3604        IF NOT VALID-REF-CODE
  3605           MOVE -1               TO LFREDL
  3606           MOVE AL-UABON         TO LFREDA
  3607           MOVE ER-0582          TO EMI-ERROR
  3608           PERFORM 9900-ERROR-FORMAT
  3609                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  64
* EL115.cbl
  3610        END-IF
  3611     END-IF
  3612     IF LFLEVL > ZEROS
  3613        MOVE LFLEVI              TO WS-VALID-REF-CODES
  3614        IF NOT VALID-REF-CODE
  3615           MOVE -1               TO LFLEVL
  3616           MOVE AL-UABON         TO LFLEVA
  3617           MOVE ER-0582          TO EMI-ERROR
  3618           PERFORM 9900-ERROR-FORMAT
  3619                                 THRU 9900-EXIT
  3620        END-IF
  3621     END-IF
  3622     IF LFNETL > ZEROS
  3623        MOVE LFNETI              TO WS-VALID-REF-CODES
  3624        IF NOT VALID-REF-CODE
  3625           MOVE -1               TO LFNETL
  3626           MOVE AL-UABON         TO LFNETA
  3627           MOVE ER-0582          TO EMI-ERROR
  3628           PERFORM 9900-ERROR-FORMAT
  3629                                 THRU 9900-EXIT
  3630        END-IF
  3631     END-IF
  3632     IF AHAHL > ZEROS
  3633        MOVE AHAHI               TO WS-VALID-REF-CODES
  3634        IF NOT VALID-REF-CODE
  3635           MOVE -1               TO AHAHL
  3636           MOVE AL-UABON         TO AHAHA
  3637           MOVE ER-0582          TO EMI-ERROR
  3638           PERFORM 9900-ERROR-FORMAT
  3639                                 THRU 9900-EXIT
  3640        END-IF
  3641     END-IF
  3642     IF AHCPL > ZEROS
  3643        MOVE AHCPI               TO WS-VALID-REF-CODES
  3644        IF NOT VALID-REF-CODE
  3645           MOVE -1               TO AHCPL
  3646           MOVE AL-UABON         TO AHCPA
  3647           MOVE ER-0582          TO EMI-ERROR
  3648           PERFORM 9900-ERROR-FORMAT
  3649                                 THRU 9900-EXIT
  3650        END-IF
  3651     END-IF
  3652     .
  3653 6000-EXIT.
  3654     EXIT.
  3655***************************************************************
  3656*                                                             *
  3657*     BUILD THE OUTPUT SCREEN TO BE DISPLAYED                 *
  3658*                                                             *
  3659***************************************************************
  3660 7000-BUILD-OUTPUT-MAP.
  3661     MOVE LOW-VALUES             TO EL115AO
  3662     MOVE SF-CARRIER-CODE        TO CARRO
  3663     MOVE SF-GROUPING            TO GROUPO
  3664     MOVE SF-STATE-CODE          TO STATEO
  3665     STRING SF-EXPIRE-DATE (5:2) '/' SF-EXPIRE-DATE (7:2) '/'
  3666        SF-EXPIRE-DATE (1:4) DELIMITED BY SIZE
  3667        INTO EXPDTO
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  65
* EL115.cbl
  3668     END-STRING
  3669     MOVE SF-LAST-MAINT-DT       TO DC-BIN-DATE-1
  3670     MOVE ' '                    TO DC-OPTION-CODE
  3671     MOVE +0                     TO DC-ELAPSED-DAYS
  3672                                    DC-ELAPSED-MONTHS
  3673     PERFORM 9700-LINK-DATE-CONVERT
  3674                                 THRU 9700-EXIT
  3675     IF NO-CONVERSION-ERROR
  3676        MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO
  3677     ELSE
  3678        MOVE LOW-VALUES          TO LSTDTEO
  3679     END-IF
  3680     MOVE SF-LAST-MAINT-BY       TO LSTUSRO
  3681                                    PI-UPDATE-BY
  3682     MOVE SF-LAST-MAINT-HHMMSS   TO TIME-IN
  3683                                    PI-UPDATE-HHMMSS
  3684     MOVE TIME-OUT            TO LSTTIMEO
  3685     MOVE SF-ST-LF-PREM-TAX      TO LFTAXO
  3686     MOVE SF-ST-AH-PREM-TAX-I    TO AHITAXO
  3687     MOVE SF-ST-AH-PREM-TAX-G    TO AHGTAXO
  3688     MOVE SF-ST-RF-LR-CALC       TO LFREDO
  3689     MOVE SF-ST-RF-LL-CALC       TO LFLEVO
  3690     MOVE SF-ST-RF-LN-CALC       TO LFNETO
  3691     MOVE SF-ST-RF-AH-CALC       TO AHAHO
  3692     MOVE SF-ST-RF-CP-CALC       TO AHCPO
  3693     MOVE -1                     TO MAINTL
  3694     MOVE AL-UANOF               TO MAINTA
  3695     MOVE AL-UANON               TO CARRA
  3696                                    GROUPA
  3697                                    STATEA
  3698                                    EXPDTA
  3699     GO TO 8200-SEND-DATAONLY
  3700     .
  3701 8100-SEND-INITIAL-MAP.
  3702     MOVE SAVE-DATE              TO RUNDTEO
  3703     MOVE EIBTIME                TO TIME-IN
  3704     MOVE TIME-OUT            TO RUNTIMEO
  3705     MOVE -1                     TO MAINTL
  3706     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
  3707
  3708* EXEC CICS SEND
  3709*        MAP   (MAP-NAME)
  3710*        MAPSET(MAPSET-NAME)
  3711*        FROM  (EL115AO)
  3712*        ERASE
  3713*        CURSOR
  3714*    END-EXEC
  3715     MOVE LENGTH OF
  3716      EL115AO
  3717       TO DFHEIV12
  3718     MOVE -1
  3719       TO DFHEIV11
  3720*    MOVE '8$     CT  E    H L F ,   #00003443' TO DFHEIV0
  3721     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3722     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3723     MOVE X'2020233030303033343433' TO DFHEIV0(25:11)
  3724     CALL 'kxdfhei1' USING DFHEIV0,
  3725           MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  66
* EL115.cbl
  3726           EL115AO,
  3727           DFHEIV12,
  3728           MAPSET-NAME,
  3729           DFHEIV99,
  3730           DFHEIV99,
  3731           DFHEIV99,
  3732           DFHEIV11,
  3733           DFHEIV99,
  3734           DFHEIV99,
  3735           DFHEIV99
  3736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3737     GO TO 9100-RETURN-TRAN
  3738     .
  3739 8200-SEND-DATAONLY.
  3740     MOVE SAVE-DATE              TO RUNDTEO
  3741     MOVE EIBTIME                TO TIME-IN
  3742     MOVE TIME-OUT            TO RUNTIMEO
  3743     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
  3744
  3745* EXEC CICS SEND
  3746*        MAP      (MAP-NAME)
  3747*        MAPSET   (MAPSET-NAME)
  3748*        FROM     (EL115AO)
  3749*        DATAONLY
  3750*        ERASEAUP
  3751*        CURSOR
  3752*    END-EXEC
  3753     MOVE LENGTH OF
  3754      EL115AO
  3755       TO DFHEIV12
  3756     MOVE -1
  3757       TO DFHEIV11
  3758*    MOVE '8$D    CT  A    H L F ,   #00003457' TO DFHEIV0
  3759     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  3760     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3761     MOVE X'2020233030303033343537' TO DFHEIV0(25:11)
  3762     CALL 'kxdfhei1' USING DFHEIV0,
  3763           MAP-NAME,
  3764           EL115AO,
  3765           DFHEIV12,
  3766           MAPSET-NAME,
  3767           DFHEIV99,
  3768           DFHEIV99,
  3769           DFHEIV99,
  3770           DFHEIV11,
  3771           DFHEIV99,
  3772           DFHEIV99,
  3773           DFHEIV99
  3774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3775     GO TO 9100-RETURN-TRAN
  3776     .
  3777 8300-SEND-TEXT.
  3778
  3779* EXEC CICS SEND TEXT
  3780*        FROM  (LOGOFF-TEXT)
  3781*        LENGTH(LOGOFF-LENGTH)
  3782*        ERASE
  3783*        FREEKB
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  67
* EL115.cbl
  3784*    END-EXEC.
  3785*    MOVE '8&      T  E F  H   F -   #00003468' TO DFHEIV0
  3786     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3787     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3788     MOVE X'2020233030303033343638' TO DFHEIV0(25:11)
  3789     CALL 'kxdfhei1' USING DFHEIV0,
  3790           LOGOFF-TEXT,
  3791           LOGOFF-LENGTH,
  3792           DFHEIV99,
  3793           DFHEIV99,
  3794           DFHEIV99,
  3795           DFHEIV99,
  3796           DFHEIV99,
  3797           DFHEIV99,
  3798           DFHEIV99,
  3799           DFHEIV99,
  3800           DFHEIV99,
  3801           DFHEIV99
  3802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3803
  3804
  3805* EXEC CICS RETURN
  3806*    END-EXEC
  3807*    MOVE '.(                    ''   #00003474' TO DFHEIV0
  3808     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3809     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3810     MOVE X'2020233030303033343734' TO DFHEIV0(25:11)
  3811     CALL 'kxdfhei1' USING DFHEIV0,
  3812           DFHEIV99,
  3813           DFHEIV99,
  3814           DFHEIV99,
  3815           DFHEIV99,
  3816           DFHEIV99,
  3817           DFHEIV99
  3818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3819     .
  3820 8600-DEEDIT.
  3821     INSPECT DEEDIT-FIELD
  3822        REPLACING ALL '.' BY SPACES
  3823     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  3824                                 TO WS-NUMVAL-OF-DEEDIT
  3825     .
  3826 8600-EXIT.
  3827     EXIT.
  3828 8800-UNAUTHORIZED-ACCESS.
  3829     MOVE UNACCESS-MSG TO LOGOFF-MSG.
  3830     GO TO 8300-SEND-TEXT.
  3831 8810-PF23.
  3832     MOVE EIBAID   TO PI-ENTRY-CD-1.
  3833     MOVE XCTL-EL005 TO PGM-NAME.
  3834     GO TO 9300-XCTL.
  3835 8870-NOTOPEN.
  3836     MOVE ER-0042 TO EMI-ERROR.
  3837     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3838     MOVE -1 TO MAINTL.
  3839     GO TO 8200-SEND-DATAONLY.
  3840 9000-RETURN-CICS.
  3841
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  68
* EL115.cbl
  3842* EXEC CICS RETURN
  3843*    END-EXEC.
  3844*    MOVE '.(                    ''   #00003498' TO DFHEIV0
  3845     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3846     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3847     MOVE X'2020233030303033343938' TO DFHEIV0(25:11)
  3848     CALL 'kxdfhei1' USING DFHEIV0,
  3849           DFHEIV99,
  3850           DFHEIV99,
  3851           DFHEIV99,
  3852           DFHEIV99,
  3853           DFHEIV99,
  3854           DFHEIV99
  3855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3856
  3857 9100-RETURN-TRAN.
  3858     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  3859     MOVE '115A'                 TO PI-CURRENT-SCREEN-NO.
  3860
  3861* EXEC CICS RETURN
  3862*        TRANSID (TRANS-ID)
  3863*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  3864*        LENGTH  (WS-COMM-LENGTH)
  3865*    END-EXEC.
  3866*    MOVE '.(CT                  ''   #00003503' TO DFHEIV0
  3867     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3868     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3869     MOVE X'2020233030303033353033' TO DFHEIV0(25:11)
  3870     CALL 'kxdfhei1' USING DFHEIV0,
  3871           TRANS-ID,
  3872           PROGRAM-INTERFACE-BLOCK,
  3873           WS-COMM-LENGTH,
  3874           DFHEIV99,
  3875           DFHEIV99,
  3876           DFHEIV99
  3877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3878
  3879 9200-RETURN-MAIN-MENU.
  3880     IF CREDIT-SESSION
  3881        MOVE XCTL-EL626          TO PGM-NAME
  3882     ELSE
  3883        IF CLAIM-SESSION
  3884           MOVE XCTL-EL126       TO PGM-NAME
  3885        ELSE
  3886           IF GENERAL-LEDGER-SESSION
  3887              MOVE XCTL-GL800    TO PGM-NAME
  3888           END-IF
  3889        END-IF
  3890     END-IF
  3891     GO TO 9300-XCTL
  3892     .
  3893 9300-XCTL.
  3894
  3895* EXEC CICS XCTL
  3896*        PROGRAM (PGM-NAME)
  3897*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  3898*        LENGTH  (WS-COMM-LENGTH)
  3899*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  69
* EL115.cbl
  3900*    MOVE '.$C                   %   #00003523' TO DFHEIV0
  3901     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3902     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3903     MOVE X'2020233030303033353233' TO DFHEIV0(25:11)
  3904     CALL 'kxdfhei1' USING DFHEIV0,
  3905           PGM-NAME,
  3906           PROGRAM-INTERFACE-BLOCK,
  3907           WS-COMM-LENGTH,
  3908           DFHEIV99
  3909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3910
  3911 9400-CLEAR.
  3912     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  3913     GO TO 9300-XCTL.
  3914 9500-PF12.
  3915     MOVE XCTL-EL010 TO PGM-NAME.
  3916     GO TO 9300-XCTL.
  3917 9600-PGMID-ERROR.
  3918
  3919* EXEC CICS HANDLE CONDITION
  3920*        PGMIDERR(8300-SEND-TEXT)
  3921*    END-EXEC.
  3922*    MOVE '"$L                   ! # #00003535' TO DFHEIV0
  3923     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3924     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3925     MOVE X'2320233030303033353335' TO DFHEIV0(25:11)
  3926     CALL 'kxdfhei1' USING DFHEIV0
  3927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3928
  3929     MOVE PGM-NAME      TO PI-CALLING-PROGRAM.
  3930     MOVE ' '           TO PI-ENTRY-CD-1.
  3931     MOVE XCTL-EL005    TO PGM-NAME.
  3932     MOVE PGM-NAME      TO LOGOFF-PGM.
  3933     MOVE PGMIDERR-MSG  TO LOGOFF-FILL.
  3934     GO TO 9300-XCTL.
  3935 9700-LINK-DATE-CONVERT.
  3936
  3937* EXEC CICS LINK
  3938*        PROGRAM    ('ELDATCV')
  3939*        COMMAREA   (DATE-CONVERSION-DATA)
  3940*        LENGTH     (DC-COMM-LENGTH)
  3941*    END-EXEC
  3942     MOVE 'ELDATCV' TO DFHEIV1
  3943*    MOVE '."C                   (   #00003545' TO DFHEIV0
  3944     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3945     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3946     MOVE X'2020233030303033353435' TO DFHEIV0(25:11)
  3947     CALL 'kxdfhei1' USING DFHEIV0,
  3948           DFHEIV1,
  3949           DATE-CONVERSION-DATA,
  3950           DC-COMM-LENGTH,
  3951           DFHEIV99,
  3952           DFHEIV99,
  3953           DFHEIV99,
  3954           DFHEIV99
  3955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3956     .
  3957 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  70
* EL115.cbl
  3958     EXIT.
  3959 9900-ERROR-FORMAT.
  3960     IF NOT EMI-ERRORS-COMPLETE
  3961         MOVE LINK-EL001 TO PGM-NAME
  3962
  3963* EXEC CICS LINK
  3964*            PROGRAM (PGM-NAME)
  3965*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  3966*            LENGTH  (EMI-COMM-LENGTH)
  3967*        END-EXEC.
  3968*    MOVE '."C                   (   #00003556' TO DFHEIV0
  3969     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3970     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3971     MOVE X'2020233030303033353536' TO DFHEIV0(25:11)
  3972     CALL 'kxdfhei1' USING DFHEIV0,
  3973           PGM-NAME,
  3974           ERROR-MESSAGE-INTERFACE-BLOCK,
  3975           EMI-COMM-LENGTH,
  3976           DFHEIV99,
  3977           DFHEIV99,
  3978           DFHEIV99,
  3979           DFHEIV99
  3980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3981
  3982 9900-EXIT.
  3983     EXIT.
  3984 9910-INITIALIZE-SECURITY.
  3985******************************************************************
  3986*                                                                *
  3987*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  3988*       USER SECURITY RECORD SET UP BY EL125.  THIS PROGRAM      *
  3989*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  3990*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  3991*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  3992*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  3993*                                                                *
  3994******************************************************************
  3995     IF PI-PROCESSOR-ID NOT = 'LGXX'
  3996
  3997* EXEC CICS  READQ TS
  3998*          QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  3999*          INTO    (SECURITY-CONTROL)
  4000*          LENGTH  (SC-COMM-LENGTH)
  4001*          ITEM    (SC-ITEM-CL-CR)
  4002*       END-EXEC
  4003*    MOVE '*$II   L              ''   #00003575' TO DFHEIV0
  4004     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4005     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4006     MOVE X'2020233030303033353735' TO DFHEIV0(25:11)
  4007     CALL 'kxdfhei1' USING DFHEIV0,
  4008           PI-SECURITY-TEMP-STORE-ID,
  4009           SECURITY-CONTROL,
  4010           SC-COMM-LENGTH,
  4011           SC-ITEM-CL-CR,
  4012           DFHEIV99,
  4013           DFHEIV99
  4014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4015        MOVE SC-CREDIT-DISPLAY (29)
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  71
* EL115.cbl
  4016                                 TO PI-DISPLAY-CAP
  4017        MOVE SC-CREDIT-UPDATE  (29)
  4018                                 TO PI-MODIFY-CAP
  4019        IF NOT DISPLAY-CAP
  4020           MOVE 'READ'           TO SM-READ
  4021           PERFORM 9995-SECURITY-VIOLATION
  4022                                 THRU 9995-EXIT
  4023           MOVE ER-0070          TO  EMI-ERROR
  4024           PERFORM 9900-ERROR-FORMAT
  4025                                 THRU 9900-EXIT
  4026           GO TO 8100-SEND-INITIAL-MAP
  4027        END-IF
  4028     END-IF
  4029     .
  4030 9910-EXIT.
  4031     EXIT.
  4032 9990-ABEND.
  4033     MOVE LINK-EL004             TO PGM-NAME.
  4034     MOVE DFHEIBLK               TO EMI-LINE1.
  4035
  4036* EXEC CICS LINK
  4037*        PROGRAM   (PGM-NAME)
  4038*        COMMAREA  (EMI-LINE1)
  4039*        LENGTH    (72)
  4040*    END-EXEC.
  4041     MOVE 72
  4042       TO DFHEIV11
  4043*    MOVE '."C                   (   #00003601' TO DFHEIV0
  4044     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4045     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4046     MOVE X'2020233030303033363031' TO DFHEIV0(25:11)
  4047     CALL 'kxdfhei1' USING DFHEIV0,
  4048           PGM-NAME,
  4049           EMI-LINE1,
  4050           DFHEIV11,
  4051           DFHEIV99,
  4052           DFHEIV99,
  4053           DFHEIV99,
  4054           DFHEIV99
  4055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4056
  4057     GO TO 8200-SEND-DATAONLY.
  4058 9995-SECURITY-VIOLATION.
  4059*           COPY ELCSCTP.
  4060******************************************************************
  4061*                                                                *
  4062*                            ELCSCTP                             *
  4063*                            VMOD=2.001                          *
  4064*                                                                *
  4065*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  4066******************************************************************
  4067
  4068
  4069     MOVE EIBDATE          TO SM-JUL-DATE.
  4070     MOVE EIBTRMID         TO SM-TERMID.
  4071     MOVE THIS-PGM         TO SM-PGM.
  4072     MOVE EIBTIME          TO TIME-IN.
  4073     MOVE TIME-OUT         TO SM-TIME.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-12 08:26 Page  72
* EL115.cbl
  4074     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  4075
  4076
  4077* EXEC CICS LINK
  4078*         PROGRAM  ('EL003')
  4079*         COMMAREA (SECURITY-MESSAGE)
  4080*         LENGTH   (80)
  4081*    END-EXEC.
  4082     MOVE 'EL003' TO DFHEIV1
  4083     MOVE 80
  4084       TO DFHEIV11
  4085*    MOVE '."C                   (   #00003625' TO DFHEIV0
  4086     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4087     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4088     MOVE X'2020233030303033363235' TO DFHEIV0(25:11)
  4089     CALL 'kxdfhei1' USING DFHEIV0,
  4090           DFHEIV1,
  4091           SECURITY-MESSAGE,
  4092           DFHEIV11,
  4093           DFHEIV99,
  4094           DFHEIV99,
  4095           DFHEIV99,
  4096           DFHEIV99
  4097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4098
  4099
  4100******************************************************************
  4101
  4102 9995-EXIT.
  4103      EXIT.
  4104
  4105 9999-DFHBACK SECTION.
  4106     MOVE '9%                    "   ' TO DFHEIV0
  4107     MOVE 'EL115' TO DFHEIV1
  4108     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4109     GOBACK.
  4110 9999-DFHEXIT.
  4111     IF DFHEIGDJ EQUAL 0001
  4112         NEXT SENTENCE
  4113     ELSE IF DFHEIGDJ EQUAL 2
  4114         GO TO 8870-NOTOPEN,
  4115               9600-PGMID-ERROR,
  4116               9990-ABEND
  4117         DEPENDING ON DFHEIGDI
  4118     ELSE IF DFHEIGDJ EQUAL 3
  4119         GO TO 8300-SEND-TEXT
  4120         DEPENDING ON DFHEIGDI.
  4121     MOVE '9%                    "   ' TO DFHEIV0
  4122     MOVE 'EL115' TO DFHEIV1
  4123     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4124     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5572     Code:        7840
