* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL1042.cbl
* Options: int("EL1042.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1042.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1042.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1042.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1042.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/21/95 13:28:51.
     7*                            VMOD=2.021
     8*
     9*
    10*AUTHOR.           LOGIC,INC.
    11*                  DALLAS,TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL1042.cbl
    14*            *****************************************************
    15*            *                                                   *
    16*            * THIS PROGRAM IS THE PROPERTY OF LOCIC, INC. *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS. TRANSACTION EX14 - TEXT FILE MAINTENANCE
    25*        THIS PROGRAM IS USED TO PERFORM MAINTENANCE TO THE HELP,
    26*        LETTER, AND FORM FILES, DEPENDING ON THE OPTION
    27*        SPECIFIED FROM THE TEXT MAINT MENU (EL104).
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 020410  CR2009061500002  AJRA  FIX HELP FILE SELECTION
    37* 082211  CR2011022800001  AJRA  NAPERSOFT ACCT SERVICES
    38******************************************************************
    39
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL1042.cbl
    41 ENVIRONMENT DIVISION.
    42 DATA DIVISION.
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*   EL1042 WORKING STORAGE     *'.
    47 77  FILLER  PIC X(32)  VALUE '******* VMOD=2.021 *************'.
    48
    49*                            COPY ELCSCTM.
    50******************************************************************
    51*                                                                *
    52*                                                                *
    53*                            ELCSCTM                             *
    54*                            VMOD=2.001                          *
    55*                                                                *
    56*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    57*                                                                *
    58******************************************************************
    59 01  SECURITY-MESSAGE.
    60     12  FILLER                          PIC X(30)
    61            VALUE '** LOGIC SECURITY VIOLATION -'.
    62     12  SM-READ                         PIC X(6).
    63     12  FILLER                          PIC X(5)
    64            VALUE ' PGM='.
    65     12  SM-PGM                          PIC X(6).
    66     12  FILLER                          PIC X(5)
    67            VALUE ' OPR='.
    68     12  SM-PROCESSOR-ID                 PIC X(4).
    69     12  FILLER                          PIC X(6)
    70            VALUE ' TERM='.
    71     12  SM-TERMID                       PIC X(4).
    72     12  FILLER                          PIC XX   VALUE SPACE.
    73     12  SM-JUL-DATE                     PIC 9(5).
    74     12  FILLER                          PIC X    VALUE SPACE.
    75     12  SM-TIME                         PIC 99.99.
    76
    77*                            COPY ELCSCRTY.
    78******************************************************************
    79*                                                                *
    80*                                                                *
    81*                            ELCSCRTY                            *
    82*                            VMOD=2.001                          *
    83*                                                                *
    84*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    85*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    86*        SAVED IN PI-SECURITY-ADDRESS.                           *
    87*                                                                *
    88******************************************************************
    89 01  SECURITY-CONTROL.
    90     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    91     12  FILLER                       PIC XX    VALUE 'SC'.
    92     12  SC-CREDIT-CODES.
    93         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    94             20  SC-CREDIT-DISPLAY    PIC X.
    95             20  SC-CREDIT-UPDATE     PIC X.
    96     12  SC-CLAIMS-CODES.
    97         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    98             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL1042.cbl
    99             20  SC-CLAIMS-UPDATE     PIC X.
   100*                            COPY MPCSCRT.
   101******************************************************************
   102*                                                                *
   103*                            MPCSCRT                             *
   104*                            VMOD=1.001                          *
   105*                                                                *
   106*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   107*        ACQUIRED BY SIGN-ON PROGRAM EL125.                      *
   108*                                      (MP MORTGAGE PROTECTION)  *
   109*                                                                *
   110******************************************************************
   111*
   112 01  SECURITY-CONTROL-E.
   113     12  SC-COMM-LENGTH-E             PIC S9(04) VALUE +144 COMP.
   114     12  FILLER                       PIC  X(02) VALUE 'SC'.
   115     12  SC-QUID-KEY.
   116         16  SC-QUID-TERMINAL         PIC  X(04).
   117         16  SC-QUID-SYSTEM           PIC  X(04).
   118     12  SC-ITEM                      PIC S9(04) VALUE +1   COMP.
   119     12  SC-SECURITY-ACCESS-CODE      PIC  X(01).
   120     12  SC-PRODUCER-AUTHORIZED-SW    PIC  X(01).
   121         88 SC-PRODUCER-AUTHORIZED               VALUE ' '.
   122         88 SC-PRODUCER-NOT-AUTHORIZED           VALUE 'N'.
   123     12  SC-MP-CODES.
   124         16  SC-MP-AUTHORIZATION OCCURS 44 TIMES.
   125             20  SC-MP-DISPLAY        PIC  X(01).
   126             20  SC-MP-UPDATE         PIC  X(01).
   127     12  FILLER                       PIC  X(40).
   128
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL1042.cbl
   130
   131 01  WS-DATE-AREA.
   132     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   133     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   134
   135 01  W-LAST-SAVE-AREA.
   136     05  W-SAVE-LAST-MAINT-BY    PIC X(4)    VALUE SPACES.
   137     05  W-SAVE-LAST-MAINT-DT    PIC X(8)    VALUE SPACES.
   138
   139 01  W-HOLD-LINE                 PIC  X(73).
   140
   141 01  WS-CONSTANTS.
   142     12  LOWER-CASE PIC X(26) VALUE 'abcdefghijklmnopqrstuvwxyz'.
   143     12  UPPER-CASE PIC X(26) VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
   144     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP VALUE +7.
   145     12  MAP-NAME.
   146         16  MAP-NAME-PRE        PIC X(2)    VALUE 'EL'.
   147         16  MAP-NUMBER          PIC X(4)    VALUE '104B'.
   148         16  MAP-NAME-FILL       PIC X(2)    VALUE SPACES.
   149
   150     12  W-SC-ITEM               PIC S9(4) COMP VALUE +1.
   151     12  MAPSET-NAME             PIC X(8)    VALUE 'EL104S'.
   152     12  TRANS-ID                PIC X(4)    VALUE 'EX14'.
   153     12  PGM-NAME                PIC X(8).
   154     12  PGM-EL152               PIC X(8)    VALUE 'EL152'.
   155     12  PGM-EM152               PIC X(8)    VALUE 'EM152'.
   156     12  PGM-EL689               PIC X(8)    VALUE 'EL689'.
   157     12  THIS-PGM                PIC X(8)    VALUE 'EL1042'.
   158     12  XCTL-CLAIM              PIC X(8)    VALUE 'EL126'.
   159     12  XCTL-CREDIT             PIC X(8)    VALUE 'EL626'.
   160     12  XCTL-WARRANTY           PIC X(8)    VALUE 'WA126'.
   161     12  XCTL-MORTGAGE           PIC X(8)    VALUE 'EM626'.
   162     12  XCTL-GEN-LEDGER         PIC X(8)    VALUE 'GL800'.
   163     12  FILE-ID                 PIC X(8).
   164     12  LETTER-ID               PIC X(8)    VALUE 'ELLETR'.
   165     12  WS-8126-ERROR-SW        PIC X       VALUE 'N'.
   166     12  W-LINE-SQUEEZE-IND      PIC X(01).
   167         88  W-LINE-SQUEEZE-VALID-VALUE      VALUE ' ' 'A'
   168             'C' 'D' 'E' 'F' 'G' 'H' 'K' 'N' 'P' 'Q' 'R' 'S'
   169             'T' 'U' 'Z' '1' '2' '3' '4' '5'.
   170     12  FORM-ID                 PIC X(8)    VALUE 'ELFORM'.
   171     12  HELP-ID                 PIC X(8)    VALUE 'ELHELP'.
   172     12  TS-NAME.
   173         16  FILLER              PIC X(4)    VALUE '104A'.
   174         16  TS-TERM             PIC X(4).
   175     12  TS-ITEM                 PIC S9(4)   COMP VALUE +0.
   176     12  FILE-LENGTH             PIC S9(4)   COMP VALUE +100.
   177     12  FILE-KEY.
   178         16  FILE-PARTIAL-KEY.
   179           18  CO-CD             PIC X.
   180           18  CNTL-AREA         PIC X(12).
   181         16  SEQ                 PIC S9(4)   COMP.
   182     12  OLD-KEY-SAVE            PIC X(13).
   183
   184     12  TIME-IN                 PIC S9(7).
   185     12  FILLER REDEFINES TIME-IN.
   186         16  FILLER              PIC X.
   187         16  TIME-OUT            PIC 99V99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL1042.cbl
   188         16  FILLER              PIC 9(2).
   189     12  MAX-LINES               PIC 999     VALUE 300.
   190     12  NUM-LINES-PER-SCREEN    PIC 99      VALUE 15.
   191     12  TS-NUM-REC-IN-GROUP     PIC 99      VALUE 50.
   192     12  TS-GROUP-WORK           PIC 9(5)    VALUE 0  COMP-3.
   193     12  TS-LENGTH               PIC S9(4)   VALUE +3650 COMP.
   194     12  ROLL-COUNTER            PIC S999    VALUE +0 COMP-3.
   195     12  TEMP-CURR-LINE          PIC S9(3)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL1042.cbl
   197*                                COPY ELCLOGOF.
   198******************************************************************
   199*                                                                *
   200*                                                                *
   201*                            ELCLOGOF.                           *
   202*                            VMOD=2.001                          *
   203*                                                                *
   204*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   205*                                                                *
   206******************************************************************
   207 01  CLASIC-LOGOFF.
   208     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   209     12  LOGOFF-TEXT.
   210         16  FILLER          PIC X(5)    VALUE SPACES.
   211         16  LOGOFF-MSG.
   212             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   213             20  FILLER      PIC X       VALUE SPACES.
   214             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   215         16  FILLER          PIC X(80)
   216           VALUE '* YOU ARE NOW LOGGED OFF'.
   217         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   218         16  FILLER          PIC X       VALUE QUOTE.
   219         16  LOGOFF-SYS-MSG  PIC X(17)
   220           VALUE 'S CLAS-IC SYSTEM '.
   221     12  TEXT-MESSAGES.
   222         16  UNACCESS-MSG    PIC X(29)
   223             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   224         16  PGMIDERR-MSG    PIC X(17)
   225             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL1042.cbl
   227*                                COPY ELCAID.
   228******************************************************************
   229*                                                                *
   230*                            ELCAID.                             *
   231*                            VMOD=2.001                          *
   232*                                                                *
   233*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   234*                                                                *
   235*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   236*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   237******************************************************************
   238
   239 01  DFHAID.
   240   02  DFHNULL   PIC  X  VALUE  ' '.
   241   02  DFHENTER  PIC  X  VALUE  QUOTE.
   242   02  DFHCLEAR  PIC  X  VALUE  '_'.
   243   02  DFHPEN    PIC  X  VALUE  '='.
   244   02  DFHOPID   PIC  X  VALUE  'W'.
   245   02  DFHPA1    PIC  X  VALUE  '%'.
   246   02  DFHPA2    PIC  X  VALUE  '>'.
   247   02  DFHPA3    PIC  X  VALUE  ','.
   248   02  DFHPF1    PIC  X  VALUE  '1'.
   249   02  DFHPF2    PIC  X  VALUE  '2'.
   250   02  DFHPF3    PIC  X  VALUE  '3'.
   251   02  DFHPF4    PIC  X  VALUE  '4'.
   252   02  DFHPF5    PIC  X  VALUE  '5'.
   253   02  DFHPF6    PIC  X  VALUE  '6'.
   254   02  DFHPF7    PIC  X  VALUE  '7'.
   255   02  DFHPF8    PIC  X  VALUE  '8'.
   256   02  DFHPF9    PIC  X  VALUE  '9'.
   257   02  DFHPF10   PIC  X  VALUE  ':'.
   258   02  DFHPF11   PIC  X  VALUE  '#'.
   259   02  DFHPF12   PIC  X  VALUE  '@'.
   260   02  DFHPF13   PIC  X  VALUE  'A'.
   261   02  DFHPF14   PIC  X  VALUE  'B'.
   262   02  DFHPF15   PIC  X  VALUE  'C'.
   263   02  DFHPF16   PIC  X  VALUE  'D'.
   264   02  DFHPF17   PIC  X  VALUE  'E'.
   265   02  DFHPF18   PIC  X  VALUE  'F'.
   266   02  DFHPF19   PIC  X  VALUE  'G'.
   267   02  DFHPF20   PIC  X  VALUE  'H'.
   268   02  DFHPF21   PIC  X  VALUE  'I'.
   269*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   270   02  DFHPF22   PIC  X  VALUE  '['.
   271   02  DFHPF23   PIC  X  VALUE  '.'.
   272   02  DFHPF24   PIC  X  VALUE  '<'.
   273   02  DFHMSRE   PIC  X  VALUE  'X'.
   274   02  DFHSTRF   PIC  X  VALUE  'h'.
   275   02  DFHTRIG   PIC  X  VALUE  '"'.
   276 01  FILLER  REDEFINES DFHAID.
   277     12  FILLER                  PIC X(8).
   278     12  PF-VALUES OCCURS 24 TIMES       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL1042.cbl
   280*                                    COPY ELCEMIB.
   281******************************************************************
   282*                                                                *
   283*                                                                *
   284*                            ELCEMIB.                            *
   285*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   286*                            VMOD=2.005                          *
   287*                                                                *
   288*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   289*                                                                *
   290******************************************************************
   291 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   292     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   293     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   294     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   295     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   296     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   297     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   298     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   299     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   300     12  EMI-SWITCH1             PIC X        VALUE '1'.
   301         88  EMI-NO-ERRORS                    VALUE '1'.
   302         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   303         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   304     12  EMI-SWITCH2             PIC X        VALUE '1'.
   305         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   306     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   307         88  EMI-AREA1-EMPTY                  VALUE '1'.
   308         88  EMI-AREA1-FULL                   VALUE '2'.
   309     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   310         88  EMI-AREA2-EMPTY                  VALUE '1'.
   311         88  EMI-AREA2-FULL                   VALUE '2'.
   312     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   313         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   314         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   315         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   316         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   317         88  EMI-BYPASS-FATALS                VALUE 'X'.
   318     12  EMI-ERROR-LINES.
   319         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   320         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   321         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   322         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   323             20  EMI-ERR-CODES OCCURS 10 TIMES.
   324                 24  EMI-ERR-NUM         PIC X(4).
   325                 24  EMI-FILLER          PIC X.
   326                 24  EMI-SEV             PIC X.
   327                 24  FILLER              PIC X.
   328             20  FILLER                  PIC X(02).
   329     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   330         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   331             20  EMI-ERROR-NUMBER    PIC X(4).
   332             20  EMI-FILL            PIC X.
   333             20  EMI-SEVERITY        PIC X.
   334             20  FILLER              PIC X.
   335             20  EMI-ERROR-TEXT.
   336                 24  EMI-TEXT-VARIABLE   PIC X(10).
   337                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL1042.cbl
   338     12  EMI-SEVERITY-SAVE           PIC X.
   339         88  EMI-NOTE                    VALUE 'N'.
   340         88  EMI-WARNING                 VALUE 'W'.
   341         88  EMI-FORCABLE                VALUE 'F'.
   342         88  EMI-FATAL                   VALUE 'X'.
   343     12  EMI-MESSAGE-FLAG            PIC X.
   344         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   345         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   346     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   347     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   348         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   349         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   350         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   351     12  FILLER                      PIC X(137)  VALUE SPACES.
   352     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   353     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   354     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   355     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   356
   357 01  WS-ERROR-MESSAGE-AREA.
   358     12  ER-0000                     PIC 9(4)   VALUE 0000.
   359     12  ER-0004                     PIC 9(4)   VALUE 0004.
   360     12  ER-0006                     PIC 9(4)   VALUE 0006.
   361     12  ER-0008                     PIC 9(4)   VALUE 0008.
   362     12  ER-0013                     PIC 9(4)   VALUE 0013.
   363     12  ER-0014                     PIC 9(4)   VALUE 0014.
   364     12  ER-0015                     PIC 9(4)   VALUE 0015.
   365     12  ER-0023                     PIC 9(4)   VALUE 0023.
   366     12  ER-0029                     PIC 9(4)   VALUE 0029.
   367     12  ER-0030                     PIC 9(4)   VALUE 0030.
   368     12  ER-0031                     PIC 9(4)   VALUE 0031.
   369     12  ER-0032                     PIC 9(4)   VALUE 0032.
   370     12  ER-0033                     PIC 9(4)   VALUE 0033.
   371     12  ER-0041                     PIC 9(4)   VALUE 0041.
   372     12  ER-0044                     PIC 9(4)   VALUE 0044.
   373     12  ER-0045                     PIC 9(4)   VALUE 0045.
   374     12  ER-0047                     PIC 9(4)   VALUE 0047.
   375     12  ER-0048                     PIC 9(4)   VALUE 0048.
   376     12  ER-0049                     PIC 9(4)   VALUE 0049.
   377     12  ER-0050                     PIC 9(4)   VALUE 0050.
   378     12  ER-0051                     PIC 9(4)   VALUE 0051.
   379     12  ER-0066                     PIC 9(4)   VALUE 0066.
   380     12  ER-0067                     PIC 9(4)   VALUE 0067.
   381     12  ER-0069                     PIC 9(4)   VALUE 0069.
   382     12  ER-0070                     PIC 9(4)   VALUE 0070.
   383     12  ER-0140                     PIC 9(4)   VALUE 0140.
   384     12  ER-0141                     PIC 9(4)   VALUE 0141.
   385     12  ER-0212                     PIC 9(4)   VALUE 0212.
   386     12  ER-7375                     PIC 9(4)   VALUE 7375.
   387     12  ER-8126                     PIC 9(4)   VALUE 8126.
   388     12  ER-9097                     PIC 9(4)   VALUE 9097.
   389     12  ER-9348                     PIC 9(4)   VALUE 9348.
   390     12  ER-9349                     PIC 9(4)   VALUE 9349.
   391 01  EMI-SAVE-AREA                   PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL1042.cbl
   393 01  FILLER                          PIC X(22)
   394                              VALUE 'INTERFACE AREA STARTS:'.
   395*                                    COPY ELCINTF.
   396******************************************************************
   397*                                                                *
   398*                                                                *
   399*                            ELCINTF.                            *
   400*                            VMOD=2.017                          *
   401*                                                                *
   402*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   403*                                                                *
   404*       LENGTH = 1024                                            *
   405*                                                                *
   406******************************************************************
   407*                   C H A N G E   L O G
   408*
   409* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   410*-----------------------------------------------------------------
   411*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   412* EFFECTIVE    NUMBER
   413*-----------------------------------------------------------------
   414* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   415******************************************************************
   416 01  PROGRAM-INTERFACE-BLOCK.
   417     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   418     12  PI-CALLING-PROGRAM              PIC X(8).
   419     12  PI-SAVED-PROGRAM-1              PIC X(8).
   420     12  PI-SAVED-PROGRAM-2              PIC X(8).
   421     12  PI-SAVED-PROGRAM-3              PIC X(8).
   422     12  PI-SAVED-PROGRAM-4              PIC X(8).
   423     12  PI-SAVED-PROGRAM-5              PIC X(8).
   424     12  PI-SAVED-PROGRAM-6              PIC X(8).
   425     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   426     12  PI-COMPANY-ID                   PIC XXX.
   427     12  PI-COMPANY-CD                   PIC X.
   428
   429     12  PI-COMPANY-PASSWORD             PIC X(8).
   430
   431     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   432
   433     12  PI-CONTROL-IN-PROGRESS.
   434         16  PI-CARRIER                  PIC X.
   435         16  PI-GROUPING                 PIC X(6).
   436         16  PI-STATE                    PIC XX.
   437         16  PI-ACCOUNT                  PIC X(10).
   438         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   439                                         PIC X(10).
   440         16  PI-CLAIM-CERT-GRP.
   441             20  PI-CLAIM-NO             PIC X(7).
   442             20  PI-CERT-NO.
   443                 25  PI-CERT-PRIME       PIC X(10).
   444                 25  PI-CERT-SFX         PIC X.
   445             20  PI-CERT-EFF-DT          PIC XX.
   446         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   447             20  PI-PLAN-CODE            PIC X(2).
   448             20  PI-REVISION-NUMBER      PIC X(3).
   449             20  PI-PLAN-EFF-DT          PIC X(2).
   450             20  PI-PLAN-EXP-DT          PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL1042.cbl
   451             20  FILLER                  PIC X(11).
   452         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   453             20  PI-OE-REFERENCE-1.
   454                 25  PI-OE-REF-1-PRIME   PIC X(18).
   455                 25  PI-OE-REF-1-SUFF    PIC XX.
   456
   457     12  PI-SESSION-IN-PROGRESS          PIC X.
   458         88  CLAIM-SESSION                   VALUE '1'.
   459         88  CREDIT-SESSION                  VALUE '2'.
   460         88  WARRANTY-SESSION                VALUE '3'.
   461         88  MORTGAGE-SESSION                VALUE '4'.
   462         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   463
   464
   465*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   466
   467     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   468     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   469
   470     12  PI-CREDIT-USER                  PIC X.
   471         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   472         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   473
   474     12  PI-CLAIM-USER                   PIC X.
   475         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   476         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   477
   478     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   479         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   480         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   481         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   482         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   483         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   484
   485     12  PI-PROCESSOR-ID                 PIC X(4).
   486
   487     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   488
   489     12  PI-MEMBER-CAPTION               PIC X(10).
   490
   491     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   492         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   493
   494     12  PI-LIFE-OVERRIDE-L1             PIC X.
   495     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   496     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   497     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   498
   499     12  PI-AH-OVERRIDE-L1               PIC X.
   500     12  PI-AH-OVERRIDE-L2               PIC XX.
   501     12  PI-AH-OVERRIDE-L6               PIC X(6).
   502     12  PI-AH-OVERRIDE-L12              PIC X(12).
   503
   504     12  PI-NEW-SYSTEM                   PIC X(2).
   505
   506     12  PI-PRIMARY-CERT-NO              PIC X(11).
   507     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   508         88  PI-USES-PAID-TO                 VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL1042.cbl
   509     12  PI-CRDTCRD-SYSTEM.
   510         16  PI-CRDTCRD-USER             PIC X.
   511             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   512             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   513         16  PI-CC-MONTH-END-DT          PIC XX.
   514     12  PI-PROCESSOR-PRINTER            PIC X(4).
   515
   516     12  PI-OE-REFERENCE-2.
   517         16  PI-OE-REF-2-PRIME           PIC X(10).
   518         16  PI-OE-REF-2-SUFF            PIC X.
   519
   520     12  PI-REM-TRM-CALC-OPTION          PIC X.
   521
   522     12  PI-LANGUAGE-TYPE                PIC X.
   523             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   524             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   525             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   526
   527     12  PI-POLICY-LINKAGE-IND           PIC X.
   528         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   529         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   530                                                   LOW-VALUES.
   531
   532     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   533     12  PI-CLAIM-PW-SESSION             PIC X(1).
   534         88  PI-CLAIM-CREDIT                 VALUE '1'.
   535         88  PI-CLAIM-CONVEN                 VALUE '2'.
   536
   537     12  PI-PROCESSOR-CSR-IND            PIC X.
   538         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   539         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   540
   541     12  FILLER                          PIC X(3).
   542
   543     12  PI-SYSTEM-LEVEL                 PIC X(145).
   544
   545     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   546         PI-SYSTEM-LEVEL.
   547
   548         16  PI-ENTRY-CODES.
   549             20  PI-ENTRY-CD-1           PIC X.
   550             20  PI-ENTRY-CD-2           PIC X.
   551
   552         16  PI-RETURN-CODES.
   553             20  PI-RETURN-CD-1          PIC X.
   554             20  PI-RETURN-CD-2          PIC X.
   555
   556         16  PI-UPDATE-STATUS-SAVE.
   557             20  PI-UPDATE-BY            PIC X(4).
   558             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   559
   560         16  PI-LOWER-CASE-LETTERS       PIC X.
   561             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   562
   563*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   564*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   565*            88  CARRIER-CLM-CNTL            VALUE '2'.
   566
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL1042.cbl
   567         16  PI-CERT-ACCESS-CONTROL      PIC X.
   568             88  ST-ACCNT-CNTL               VALUE ' '.
   569             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   570             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   571             88  ACCNT-CNTL                  VALUE '3'.
   572             88  CARR-ACCNT-CNTL             VALUE '4'.
   573
   574         16  PI-PROCESSOR-CAP-LIST.
   575             20  PI-SYSTEM-CONTROLS.
   576                24 PI-SYSTEM-DISPLAY     PIC X.
   577                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   578                24 PI-SYSTEM-MODIFY      PIC X.
   579                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   580             20  FILLER                  PIC XX.
   581             20  PI-DISPLAY-CAP          PIC X.
   582                 88  DISPLAY-CAP             VALUE 'Y'.
   583             20  PI-MODIFY-CAP           PIC X.
   584                 88  MODIFY-CAP              VALUE 'Y'.
   585             20  PI-MSG-AT-LOGON-CAP     PIC X.
   586                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   587             20  PI-FORCE-CAP            PIC X.
   588                 88  FORCE-CAP               VALUE 'Y'.
   589
   590         16  PI-PROGRAM-CONTROLS.
   591             20  PI-PGM-PRINT-OPT        PIC X.
   592             20  PI-PGM-FORMAT-OPT       PIC X.
   593             20  PI-PGM-PROCESS-OPT      PIC X.
   594             20  PI-PGM-TOTALS-OPT       PIC X.
   595
   596         16  PI-HELP-INTERFACE.
   597             20  PI-LAST-ERROR-NO        PIC X(4).
   598             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   599
   600         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   601             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   602
   603         16  PI-CR-CONTROL-IN-PROGRESS.
   604             20  PI-CR-CARRIER           PIC X.
   605             20  PI-CR-GROUPING          PIC X(6).
   606             20  PI-CR-STATE             PIC XX.
   607             20  PI-CR-ACCOUNT           PIC X(10).
   608             20  PI-CR-FIN-RESP          PIC X(10).
   609             20  PI-CR-TYPE              PIC X.
   610
   611         16  PI-CR-BATCH-NUMBER          PIC X(6).
   612
   613         16  PI-CR-MONTH-END-DT          PIC XX.
   614
   615         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   616             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   617             88  PI-ZERO-CARRIER             VALUE '1'.
   618             88  PI-ZERO-GROUPING            VALUE '2'.
   619             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   620
   621         16  PI-CARRIER-SECURITY         PIC X.
   622             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   623
   624         16  PI-ACCOUNT-SECURITY         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL1042.cbl
   625             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   626             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   627
   628         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   629             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   630                                         INDEXED BY PI-ACCESS-NDX
   631                                         PIC X.
   632
   633         16  PI-GA-BILLING-CONTROL       PIC X.
   634             88  PI-GA-BILLING               VALUE '1'.
   635
   636         16  PI-MAIL-PROCESSING          PIC X.
   637             88  PI-MAIL-YES                 VALUE 'Y'.
   638
   639         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   640
   641         16  PI-AR-SYSTEM.
   642             20  PI-AR-PROCESSING-CNTL   PIC X.
   643                 88  PI-AR-PROCESSING        VALUE 'Y'.
   644             20  PI-AR-SUMMARY-CODE      PIC X(6).
   645             20  PI-AR-MONTH-END-DT      PIC XX.
   646
   647         16  PI-MP-SYSTEM.
   648             20  PI-MORTGAGE-USER            PIC X.
   649                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   650                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   651             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   652                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   653                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   654                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   655                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   656                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   657             20  PI-MP-MONTH-END-DT          PIC XX.
   658             20  PI-MP-REFERENCE-NO.
   659                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   660                 24  PI-MP-REFERENCE-SFX     PIC XX.
   661
   662         16  PI-LABEL-CONTROL            PIC X(01).
   663             88  PI-CREATE-LABELS                    VALUE 'Y'.
   664             88  PI-BYPASS-LABELS                    VALUE 'N'.
   665
   666         16  PI-BILL-GROUPING-CODE       PIC X(01).
   667             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   668
   669         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   670             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   671             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   672
   673         16  FILLER                      PIC X(14).
   674
   675     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   676******************************************************************
   677     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   678*        COPY ELC1042.
   679******************************************************************
   680*                                                                *
   681*                                                                *
   682*                           ELC1042                              *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL1042.cbl
   683*                            VMOD=2.002                          *
   684*                                                                *
   685*    NOTE                                                        *
   686*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   687*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   688*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   689*        TO THESE PROGRAMS.                                      *
   690*                                                                *
   691*    NOTE                                                        *
   692*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   693*        USE ONLY!                                               *
   694*                                                                *
   695******************************************************************
   696
   697         16  PI-1042-WA.
   698             20  PI-ACTION       PIC  X(01).
   699                 88 PI-SHOW-MODE           VALUE '1'.
   700                 88 PI-CLEAR-MODE          VALUE '2'.
   701                 88 PI-CREATE-MODE         VALUE '3'.
   702             20  PI-COMM-CONTROL PIC  X(12).
   703             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   704             20  PI-EOF-SW       PIC  X(01).
   705                 88  PI-FILE-EOF           VALUE 'Y'.
   706             20  PI-FILETYP      PIC  X(01).
   707             20  PI-FORM-SQUEEZE-CONTROL
   708                                 PIC  X(01).
   709                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   710                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   711             20  PI-LAST-CONTROL PIC  X(12).
   712             20  PI-TEMP-STOR-ITEMS
   713                                 PIC S9(04) COMP.
   714             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   715             20  PI-UPDATE-SW    PIC  9(01).
   716                 88 ANY-UPDATES            VALUE 1.
   717             20  PI-104-SCREEN-SENT-IND
   718                                 PIC  X(01).
   719                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   720                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   721             20  PI-1042-SCREEN-SENT-IND
   722                                 PIC  X(01).
   723                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   724                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   725             20  PI-1042-ARCHIVE-IND
   726                                 PIC  X(01).
   727                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   728             20  FILLER          PIC  X(29).
   729         16  FILLER                  PIC X(573).
   730
   731 01  FILLER                          PIC X(20)
   732                              VALUE ':INTERFACE AREA ENDS'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL1042.cbl
   734*                                    COPY ELCATTR.
   735******************************************************************
   736*                                                                *
   737*                            ELCATTR.                            *
   738*                            VMOD=2.001                          *
   739*                                                                *
   740*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   741*                                                                *
   742*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   743*                                                                *
   744*                   POS 1   P=PROTECTED                          *
   745*                           U=UNPROTECTED                        *
   746*                           S=ASKIP                              *
   747*                   POS 2   A=ALPHA/NUMERIC                      *
   748*                           N=NUMERIC                            *
   749*                   POS 3   N=NORMAL                             *
   750*                           B=BRIGHT                             *
   751*                           D=DARK                               *
   752*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   753*                           OF=MODIFIED DATA TAG OFF             *
   754*                                                                *
   755*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   756******************************************************************
   757 01  ATTRIBUTE-LIST.
   758     12  AL-PABOF            PIC X       VALUE 'Y'.
   759     12  AL-PABON            PIC X       VALUE 'Z'.
   760     12  AL-PADOF            PIC X       VALUE '%'.
   761     12  AL-PADON            PIC X       VALUE '_'.
   762     12  AL-PANOF            PIC X       VALUE '-'.
   763     12  AL-PANON            PIC X       VALUE '/'.
   764     12  AL-SABOF            PIC X       VALUE '8'.
   765     12  AL-SABON            PIC X       VALUE '9'.
   766     12  AL-SADOF            PIC X       VALUE '@'.
   767     12  AL-SADON            PIC X       VALUE QUOTE.
   768     12  AL-SANOF            PIC X       VALUE '0'.
   769     12  AL-SANON            PIC X       VALUE '1'.
   770     12  AL-UABOF            PIC X       VALUE 'H'.
   771     12  AL-UABON            PIC X       VALUE 'I'.
   772     12  AL-UADOF            PIC X       VALUE '<'.
   773     12  AL-UADON            PIC X       VALUE '('.
   774     12  AL-UANOF            PIC X       VALUE ' '.
   775     12  AL-UANON            PIC X       VALUE 'A'.
   776     12  AL-UNBOF            PIC X       VALUE 'Q'.
   777     12  AL-UNBON            PIC X       VALUE 'R'.
   778     12  AL-UNDOF            PIC X       VALUE '*'.
   779     12  AL-UNDON            PIC X       VALUE ')'.
   780     12  AL-UNNOF            PIC X       VALUE '&'.
   781     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL1042.cbl
   783*                                    COPY ELCDATE.
   784******************************************************************
   785*                                                                *
   786*                                                                *
   787*                            ELCDATE.                            *
   788*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   789*                            VMOD=2.003
   790*                                                                *
   791*                                                                *
   792*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   793*                 LENGTH = 200                                   *
   794******************************************************************
   795
   796 01  DATE-CONVERSION-DATA.
   797     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   798     12  DC-OPTION-CODE                PIC X.
   799         88  BIN-TO-GREG                VALUE ' '.
   800         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   801         88  EDIT-GREG-TO-BIN           VALUE '2'.
   802         88  YMD-GREG-TO-BIN            VALUE '3'.
   803         88  MDY-GREG-TO-BIN            VALUE '4'.
   804         88  JULIAN-TO-BIN              VALUE '5'.
   805         88  BIN-PLUS-ELAPSED           VALUE '6'.
   806         88  FIND-CENTURY               VALUE '7'.
   807         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   808         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   809         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   810         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   811         88  JULIAN-TO-BIN-3            VALUE 'C'.
   812         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   813         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   814         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   815         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   816         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   817         88  CHECK-LEAP-YEAR            VALUE 'H'.
   818         88  BIN-3-TO-GREG              VALUE 'I'.
   819         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   820         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   821         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   822         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   823         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   824         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   825         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   826         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   827         88  THREE-CHARACTER-BIN
   828                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   829         88  GREGORIAN-TO-BIN
   830                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   831         88  BIN-TO-GREGORIAN
   832                  VALUES ' ' '1' 'I' '8' 'G'.
   833         88  JULIAN-TO-BINARY
   834                  VALUES '5' 'C' 'E' 'F'.
   835     12  DC-ERROR-CODE                 PIC X.
   836         88  NO-CONVERSION-ERROR        VALUE ' '.
   837         88  DATE-CONVERSION-ERROR
   838                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   839         88  DATE-IS-ZERO               VALUE '1'.
   840         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL1042.cbl
   841         88  DATE-IS-INVALID            VALUE '3'.
   842         88  DATE1-GREATER-DATE2        VALUE '4'.
   843         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   844         88  DATE-INVALID-OPTION        VALUE '9'.
   845         88  INVALID-CENTURY            VALUE 'A'.
   846         88  ONLY-CENTURY               VALUE 'B'.
   847         88  ONLY-LEAP-YEAR             VALUE 'C'.
   848         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   849     12  DC-END-OF-MONTH               PIC X.
   850         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   851     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   852         88  USE-NORMAL-PROCESS         VALUE ' '.
   853         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   854         88  ADJUST-UP-100-YRS          VALUE '2'.
   855     12  FILLER                        PIC X.
   856     12  DC-CONVERSION-DATES.
   857         16  DC-BIN-DATE-1             PIC XX.
   858         16  DC-BIN-DATE-2             PIC XX.
   859         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   860         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   861                       DC-GREG-DATE-1-EDIT.
   862             20  DC-EDIT1-MONTH        PIC 99.
   863             20  SLASH1-1              PIC X.
   864             20  DC-EDIT1-DAY          PIC 99.
   865             20  SLASH1-2              PIC X.
   866             20  DC-EDIT1-YEAR         PIC 99.
   867         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   868         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   869                     DC-GREG-DATE-2-EDIT.
   870             20  DC-EDIT2-MONTH        PIC 99.
   871             20  SLASH2-1              PIC X.
   872             20  DC-EDIT2-DAY          PIC 99.
   873             20  SLASH2-2              PIC X.
   874             20  DC-EDIT2-YEAR         PIC 99.
   875         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   876         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   877                     DC-GREG-DATE-1-YMD.
   878             20  DC-YMD-YEAR           PIC 99.
   879             20  DC-YMD-MONTH          PIC 99.
   880             20  DC-YMD-DAY            PIC 99.
   881         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   882         16  DC-GREG-DATE-1-MDY-R REDEFINES
   883                      DC-GREG-DATE-1-MDY.
   884             20  DC-MDY-MONTH          PIC 99.
   885             20  DC-MDY-DAY            PIC 99.
   886             20  DC-MDY-YEAR           PIC 99.
   887         16  DC-GREG-DATE-1-ALPHA.
   888             20  DC-ALPHA-MONTH        PIC X(10).
   889             20  DC-ALPHA-DAY          PIC 99.
   890             20  FILLER                PIC XX.
   891             20  DC-ALPHA-CENTURY.
   892                 24 DC-ALPHA-CEN-N     PIC 99.
   893             20  DC-ALPHA-YEAR         PIC 99.
   894         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   895         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   896         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   897         16  DC-JULIAN-DATE            PIC 9(05).
   898         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL1042.cbl
   899                                       PIC 9(05).
   900         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   901             20  DC-JULIAN-YEAR        PIC 99.
   902             20  DC-JULIAN-DAYS        PIC 999.
   903         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   904         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   905         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   906     12  DATE-CONVERSION-VARIBLES.
   907         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   908         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   909             20  FILLER                PIC 9(3).
   910             20  HOLD-CEN-1-CCYY.
   911                 24  HOLD-CEN-1-CC     PIC 99.
   912                 24  HOLD-CEN-1-YY     PIC 99.
   913             20  HOLD-CEN-1-MO         PIC 99.
   914             20  HOLD-CEN-1-DA         PIC 99.
   915         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   916             20  HOLD-CEN-1-R-MO       PIC 99.
   917             20  HOLD-CEN-1-R-DA       PIC 99.
   918             20  HOLD-CEN-1-R-CCYY.
   919                 24  HOLD-CEN-1-R-CC   PIC 99.
   920                 24  HOLD-CEN-1-R-YY   PIC 99.
   921             20  FILLER                PIC 9(3).
   922         16  HOLD-CENTURY-1-X.
   923             20  FILLER                PIC X(3)  VALUE SPACES.
   924             20  HOLD-CEN-1-X-CCYY.
   925                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   926                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   927             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   928             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   929         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   930             20  HOLD-CEN-1-R-X-MO     PIC XX.
   931             20  HOLD-CEN-1-R-X-DA     PIC XX.
   932             20  HOLD-CEN-1-R-X-CCYY.
   933                 24  HOLD-CEN-1-R-X-CC PIC XX.
   934                 24  HOLD-CEN-1-R-X-YY PIC XX.
   935             20  FILLER                PIC XXX.
   936         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   937         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   938         16  DC-JULIAN-DATE-1          PIC 9(07).
   939         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   940             20  DC-JULIAN-1-CCYY.
   941                 24  DC-JULIAN-1-CC    PIC 99.
   942                 24  DC-JULIAN-1-YR    PIC 99.
   943             20  DC-JULIAN-DA-1        PIC 999.
   944         16  DC-JULIAN-DATE-2          PIC 9(07).
   945         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   946             20  DC-JULIAN-2-CCYY.
   947                 24  DC-JULIAN-2-CC    PIC 99.
   948                 24  DC-JULIAN-2-YR    PIC 99.
   949             20  DC-JULIAN-DA-2        PIC 999.
   950         16  DC-GREG-DATE-A-EDIT.
   951             20  DC-EDITA-MONTH        PIC 99.
   952             20  SLASHA-1              PIC X VALUE '/'.
   953             20  DC-EDITA-DAY          PIC 99.
   954             20  SLASHA-2              PIC X VALUE '/'.
   955             20  DC-EDITA-CCYY.
   956                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL1042.cbl
   957                 24  DC-EDITA-YEAR     PIC 99.
   958         16  DC-GREG-DATE-B-EDIT.
   959             20  DC-EDITB-MONTH        PIC 99.
   960             20  SLASHB-1              PIC X VALUE '/'.
   961             20  DC-EDITB-DAY          PIC 99.
   962             20  SLASHB-2              PIC X VALUE '/'.
   963             20  DC-EDITB-CCYY.
   964                 24  DC-EDITB-CENT     PIC 99.
   965                 24  DC-EDITB-YEAR     PIC 99.
   966         16  DC-GREG-DATE-CYMD         PIC 9(08).
   967         16  DC-GREG-DATE-CYMD-R REDEFINES
   968                              DC-GREG-DATE-CYMD.
   969             20  DC-CYMD-CEN           PIC 99.
   970             20  DC-CYMD-YEAR          PIC 99.
   971             20  DC-CYMD-MONTH         PIC 99.
   972             20  DC-CYMD-DAY           PIC 99.
   973         16  DC-GREG-DATE-MDCY         PIC 9(08).
   974         16  DC-GREG-DATE-MDCY-R REDEFINES
   975                              DC-GREG-DATE-MDCY.
   976             20  DC-MDCY-MONTH         PIC 99.
   977             20  DC-MDCY-DAY           PIC 99.
   978             20  DC-MDCY-CEN           PIC 99.
   979             20  DC-MDCY-YEAR          PIC 99.
   980    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   981        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   982    12  DC-EL310-DATE                  PIC X(21).
   983    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL1042.cbl
   985 01  FILLER                          PIC X(16)
   986                              VALUE 'MAP AREA STARTS:'.
   987*                                    COPY EL104S.
   988 01  EL104BFI.
   989     05  FILLER            PIC  X(0012).
   990*    -------------------------------
   991     05  DATEBFL PIC S9(0004) COMP.
   992     05  DATEBFF PIC  X(0001).
   993     05  FILLER REDEFINES DATEBFF.
   994         10  DATEBFA PIC  X(0001).
   995     05  DATEBFI PIC  X(0008).
   996*    -------------------------------
   997     05  TIMEBFL PIC S9(0004) COMP.
   998     05  TIMEBFF PIC  X(0001).
   999     05  FILLER REDEFINES TIMEBFF.
  1000         10  TIMEBFA PIC  X(0001).
  1001     05  TIMEBFI PIC  X(0005).
  1002*    -------------------------------
  1003     05  COMPFL PIC S9(0004) COMP.
  1004     05  COMPFF PIC  X(0001).
  1005     05  FILLER REDEFINES COMPFF.
  1006         10  COMPFA PIC  X(0001).
  1007     05  COMPFI PIC  X(0003).
  1008*    -------------------------------
  1009     05  TXTTPBFL PIC S9(0004) COMP.
  1010     05  TXTTPBFF PIC  X(0001).
  1011     05  FILLER REDEFINES TXTTPBFF.
  1012         10  TXTTPBFA PIC  X(0001).
  1013     05  TXTTPBFI PIC  X(0008).
  1014*    -------------------------------
  1015     05  CNTRLBFL PIC S9(0004) COMP.
  1016     05  CNTRLBFF PIC  X(0001).
  1017     05  FILLER REDEFINES CNTRLBFF.
  1018         10  CNTRLBFA PIC  X(0001).
  1019     05  CNTRLBFI PIC  X(0012).
  1020*    -------------------------------
  1021     05  ARCHTBFL PIC S9(0004) COMP.
  1022     05  ARCHTBFF PIC  X(0001).
  1023     05  FILLER REDEFINES ARCHTBFF.
  1024         10  ARCHTBFA PIC  X(0001).
  1025     05  ARCHTBFI PIC  X(0009).
  1026*    -------------------------------
  1027     05  ARCHBFL PIC S9(0004) COMP.
  1028     05  ARCHBFF PIC  X(0001).
  1029     05  FILLER REDEFINES ARCHBFF.
  1030         10  ARCHBFA PIC  X(0001).
  1031     05  ARCHBFI PIC  X(0001).
  1032*    -------------------------------
  1033     05  FRMSTBFL PIC S9(0004) COMP.
  1034     05  FRMSTBFF PIC  X(0001).
  1035     05  FILLER REDEFINES FRMSTBFF.
  1036         10  FRMSTBFA PIC  X(0001).
  1037     05  FRMSTBFI PIC  X(0012).
  1038*    -------------------------------
  1039     05  FRMSQBFL PIC S9(0004) COMP.
  1040     05  FRMSQBFF PIC  X(0001).
  1041     05  FILLER REDEFINES FRMSQBFF.
  1042         10  FRMSQBFA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL1042.cbl
  1043     05  FRMSQBFI PIC  X(0001).
  1044*    -------------------------------
  1045     05  TOTFL PIC S9(0004) COMP.
  1046     05  TOTFF PIC  X(0001).
  1047     05  FILLER REDEFINES TOTFF.
  1048         10  TOTFA PIC  X(0001).
  1049     05  TOTFI PIC  999.
  1050*    -------------------------------
  1051     05  LNESQTFL PIC S9(0004) COMP.
  1052     05  LNESQTFF PIC  X(0001).
  1053     05  FILLER REDEFINES LNESQTFF.
  1054         10  LNESQTFA PIC  X(0001).
  1055     05  LNESQTFI PIC  X(0001).
  1056*    -------------------------------
  1057     05  L1FL PIC S9(0004) COMP.
  1058     05  L1FF PIC  X(0001).
  1059     05  FILLER REDEFINES L1FF.
  1060         10  L1FA PIC  X(0001).
  1061     05  L1FI PIC  X(0003).
  1062*    -------------------------------
  1063     05  TEXT1FL PIC S9(0004) COMP.
  1064     05  TEXT1FF PIC  X(0001).
  1065     05  FILLER REDEFINES TEXT1FF.
  1066         10  TEXT1FA PIC  X(0001).
  1067     05  TEXT1FI PIC  X(0070).
  1068*    -------------------------------
  1069     05  CF1FL PIC S9(0004) COMP.
  1070     05  CF1FF PIC  X(0001).
  1071     05  FILLER REDEFINES CF1FF.
  1072         10  CF1FA PIC  X(0001).
  1073     05  CF1FI PIC  X(0002).
  1074*    -------------------------------
  1075     05  SQ1FL PIC S9(0004) COMP.
  1076     05  SQ1FF PIC  X(0001).
  1077     05  FILLER REDEFINES SQ1FF.
  1078         10  SQ1FA PIC  X(0001).
  1079     05  SQ1FI PIC  X(0001).
  1080*    -------------------------------
  1081     05  L2FL PIC S9(0004) COMP.
  1082     05  L2FF PIC  X(0001).
  1083     05  FILLER REDEFINES L2FF.
  1084         10  L2FA PIC  X(0001).
  1085     05  L2FI PIC  X(0003).
  1086*    -------------------------------
  1087     05  TEXT2FL PIC S9(0004) COMP.
  1088     05  TEXT2FF PIC  X(0001).
  1089     05  FILLER REDEFINES TEXT2FF.
  1090         10  TEXT2FA PIC  X(0001).
  1091     05  TEXT2FI PIC  X(0070).
  1092*    -------------------------------
  1093     05  CF2FL PIC S9(0004) COMP.
  1094     05  CF2FF PIC  X(0001).
  1095     05  FILLER REDEFINES CF2FF.
  1096         10  CF2FA PIC  X(0001).
  1097     05  CF2FI PIC  X(0002).
  1098*    -------------------------------
  1099     05  SQ2FL PIC S9(0004) COMP.
  1100     05  SQ2FF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL1042.cbl
  1101     05  FILLER REDEFINES SQ2FF.
  1102         10  SQ2FA PIC  X(0001).
  1103     05  SQ2FI PIC  X(0001).
  1104*    -------------------------------
  1105     05  L3FL PIC S9(0004) COMP.
  1106     05  L3FF PIC  X(0001).
  1107     05  FILLER REDEFINES L3FF.
  1108         10  L3FA PIC  X(0001).
  1109     05  L3FI PIC  X(0003).
  1110*    -------------------------------
  1111     05  TEXT3FL PIC S9(0004) COMP.
  1112     05  TEXT3FF PIC  X(0001).
  1113     05  FILLER REDEFINES TEXT3FF.
  1114         10  TEXT3FA PIC  X(0001).
  1115     05  TEXT3FI PIC  X(0070).
  1116*    -------------------------------
  1117     05  CF3FL PIC S9(0004) COMP.
  1118     05  CF3FF PIC  X(0001).
  1119     05  FILLER REDEFINES CF3FF.
  1120         10  CF3FA PIC  X(0001).
  1121     05  CF3FI PIC  X(0002).
  1122*    -------------------------------
  1123     05  SQ3FL PIC S9(0004) COMP.
  1124     05  SQ3FF PIC  X(0001).
  1125     05  FILLER REDEFINES SQ3FF.
  1126         10  SQ3FA PIC  X(0001).
  1127     05  SQ3FI PIC  X(0001).
  1128*    -------------------------------
  1129     05  L4FL PIC S9(0004) COMP.
  1130     05  L4FF PIC  X(0001).
  1131     05  FILLER REDEFINES L4FF.
  1132         10  L4FA PIC  X(0001).
  1133     05  L4FI PIC  X(0003).
  1134*    -------------------------------
  1135     05  TEXT4FL PIC S9(0004) COMP.
  1136     05  TEXT4FF PIC  X(0001).
  1137     05  FILLER REDEFINES TEXT4FF.
  1138         10  TEXT4FA PIC  X(0001).
  1139     05  TEXT4FI PIC  X(0070).
  1140*    -------------------------------
  1141     05  CF4FL PIC S9(0004) COMP.
  1142     05  CF4FF PIC  X(0001).
  1143     05  FILLER REDEFINES CF4FF.
  1144         10  CF4FA PIC  X(0001).
  1145     05  CF4FI PIC  X(0002).
  1146*    -------------------------------
  1147     05  SQ4FL PIC S9(0004) COMP.
  1148     05  SQ4FF PIC  X(0001).
  1149     05  FILLER REDEFINES SQ4FF.
  1150         10  SQ4FA PIC  X(0001).
  1151     05  SQ4FI PIC  X(0001).
  1152*    -------------------------------
  1153     05  L5FL PIC S9(0004) COMP.
  1154     05  L5FF PIC  X(0001).
  1155     05  FILLER REDEFINES L5FF.
  1156         10  L5FA PIC  X(0001).
  1157     05  L5FI PIC  X(0003).
  1158*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL1042.cbl
  1159     05  TEXT5FL PIC S9(0004) COMP.
  1160     05  TEXT5FF PIC  X(0001).
  1161     05  FILLER REDEFINES TEXT5FF.
  1162         10  TEXT5FA PIC  X(0001).
  1163     05  TEXT5FI PIC  X(0070).
  1164*    -------------------------------
  1165     05  CF5FL PIC S9(0004) COMP.
  1166     05  CF5FF PIC  X(0001).
  1167     05  FILLER REDEFINES CF5FF.
  1168         10  CF5FA PIC  X(0001).
  1169     05  CF5FI PIC  X(0002).
  1170*    -------------------------------
  1171     05  SQ5FL PIC S9(0004) COMP.
  1172     05  SQ5FF PIC  X(0001).
  1173     05  FILLER REDEFINES SQ5FF.
  1174         10  SQ5FA PIC  X(0001).
  1175     05  SQ5FI PIC  X(0001).
  1176*    -------------------------------
  1177     05  L6FL PIC S9(0004) COMP.
  1178     05  L6FF PIC  X(0001).
  1179     05  FILLER REDEFINES L6FF.
  1180         10  L6FA PIC  X(0001).
  1181     05  L6FI PIC  X(0003).
  1182*    -------------------------------
  1183     05  TEXT6FL PIC S9(0004) COMP.
  1184     05  TEXT6FF PIC  X(0001).
  1185     05  FILLER REDEFINES TEXT6FF.
  1186         10  TEXT6FA PIC  X(0001).
  1187     05  TEXT6FI PIC  X(0070).
  1188*    -------------------------------
  1189     05  CF6FL PIC S9(0004) COMP.
  1190     05  CF6FF PIC  X(0001).
  1191     05  FILLER REDEFINES CF6FF.
  1192         10  CF6FA PIC  X(0001).
  1193     05  CF6FI PIC  X(0002).
  1194*    -------------------------------
  1195     05  SQ6FL PIC S9(0004) COMP.
  1196     05  SQ6FF PIC  X(0001).
  1197     05  FILLER REDEFINES SQ6FF.
  1198         10  SQ6FA PIC  X(0001).
  1199     05  SQ6FI PIC  X(0001).
  1200*    -------------------------------
  1201     05  L7FL PIC S9(0004) COMP.
  1202     05  L7FF PIC  X(0001).
  1203     05  FILLER REDEFINES L7FF.
  1204         10  L7FA PIC  X(0001).
  1205     05  L7FI PIC  X(0003).
  1206*    -------------------------------
  1207     05  TEXT7FL PIC S9(0004) COMP.
  1208     05  TEXT7FF PIC  X(0001).
  1209     05  FILLER REDEFINES TEXT7FF.
  1210         10  TEXT7FA PIC  X(0001).
  1211     05  TEXT7FI PIC  X(0070).
  1212*    -------------------------------
  1213     05  CF7FL PIC S9(0004) COMP.
  1214     05  CF7FF PIC  X(0001).
  1215     05  FILLER REDEFINES CF7FF.
  1216         10  CF7FA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL1042.cbl
  1217     05  CF7FI PIC  X(0002).
  1218*    -------------------------------
  1219     05  SQ7FL PIC S9(0004) COMP.
  1220     05  SQ7FF PIC  X(0001).
  1221     05  FILLER REDEFINES SQ7FF.
  1222         10  SQ7FA PIC  X(0001).
  1223     05  SQ7FI PIC  X(0001).
  1224*    -------------------------------
  1225     05  L8FL PIC S9(0004) COMP.
  1226     05  L8FF PIC  X(0001).
  1227     05  FILLER REDEFINES L8FF.
  1228         10  L8FA PIC  X(0001).
  1229     05  L8FI PIC  X(0003).
  1230*    -------------------------------
  1231     05  TEXT8FL PIC S9(0004) COMP.
  1232     05  TEXT8FF PIC  X(0001).
  1233     05  FILLER REDEFINES TEXT8FF.
  1234         10  TEXT8FA PIC  X(0001).
  1235     05  TEXT8FI PIC  X(0070).
  1236*    -------------------------------
  1237     05  CF8FL PIC S9(0004) COMP.
  1238     05  CF8FF PIC  X(0001).
  1239     05  FILLER REDEFINES CF8FF.
  1240         10  CF8FA PIC  X(0001).
  1241     05  CF8FI PIC  X(0002).
  1242*    -------------------------------
  1243     05  SQ8FL PIC S9(0004) COMP.
  1244     05  SQ8FF PIC  X(0001).
  1245     05  FILLER REDEFINES SQ8FF.
  1246         10  SQ8FA PIC  X(0001).
  1247     05  SQ8FI PIC  X(0001).
  1248*    -------------------------------
  1249     05  L9FL PIC S9(0004) COMP.
  1250     05  L9FF PIC  X(0001).
  1251     05  FILLER REDEFINES L9FF.
  1252         10  L9FA PIC  X(0001).
  1253     05  L9FI PIC  X(0003).
  1254*    -------------------------------
  1255     05  TEXT9FL PIC S9(0004) COMP.
  1256     05  TEXT9FF PIC  X(0001).
  1257     05  FILLER REDEFINES TEXT9FF.
  1258         10  TEXT9FA PIC  X(0001).
  1259     05  TEXT9FI PIC  X(0070).
  1260*    -------------------------------
  1261     05  CF9FL PIC S9(0004) COMP.
  1262     05  CF9FF PIC  X(0001).
  1263     05  FILLER REDEFINES CF9FF.
  1264         10  CF9FA PIC  X(0001).
  1265     05  CF9FI PIC  X(0002).
  1266*    -------------------------------
  1267     05  SQ9FL PIC S9(0004) COMP.
  1268     05  SQ9FF PIC  X(0001).
  1269     05  FILLER REDEFINES SQ9FF.
  1270         10  SQ9FA PIC  X(0001).
  1271     05  SQ9FI PIC  X(0001).
  1272*    -------------------------------
  1273     05  L10FL PIC S9(0004) COMP.
  1274     05  L10FF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL1042.cbl
  1275     05  FILLER REDEFINES L10FF.
  1276         10  L10FA PIC  X(0001).
  1277     05  L10FI PIC  X(0003).
  1278*    -------------------------------
  1279     05  TEXT10FL PIC S9(0004) COMP.
  1280     05  TEXT10FF PIC  X(0001).
  1281     05  FILLER REDEFINES TEXT10FF.
  1282         10  TEXT10FA PIC  X(0001).
  1283     05  TEXT10FI PIC  X(0070).
  1284*    -------------------------------
  1285     05  CF10FL PIC S9(0004) COMP.
  1286     05  CF10FF PIC  X(0001).
  1287     05  FILLER REDEFINES CF10FF.
  1288         10  CF10FA PIC  X(0001).
  1289     05  CF10FI PIC  X(0002).
  1290*    -------------------------------
  1291     05  SQ10FL PIC S9(0004) COMP.
  1292     05  SQ10FF PIC  X(0001).
  1293     05  FILLER REDEFINES SQ10FF.
  1294         10  SQ10FA PIC  X(0001).
  1295     05  SQ10FI PIC  X(0001).
  1296*    -------------------------------
  1297     05  L11FL PIC S9(0004) COMP.
  1298     05  L11FF PIC  X(0001).
  1299     05  FILLER REDEFINES L11FF.
  1300         10  L11FA PIC  X(0001).
  1301     05  L11FI PIC  X(0003).
  1302*    -------------------------------
  1303     05  TEXT11FL PIC S9(0004) COMP.
  1304     05  TEXT11FF PIC  X(0001).
  1305     05  FILLER REDEFINES TEXT11FF.
  1306         10  TEXT11FA PIC  X(0001).
  1307     05  TEXT11FI PIC  X(0070).
  1308*    -------------------------------
  1309     05  CF11FL PIC S9(0004) COMP.
  1310     05  CF11FF PIC  X(0001).
  1311     05  FILLER REDEFINES CF11FF.
  1312         10  CF11FA PIC  X(0001).
  1313     05  CF11FI PIC  X(0002).
  1314*    -------------------------------
  1315     05  SQ11FL PIC S9(0004) COMP.
  1316     05  SQ11FF PIC  X(0001).
  1317     05  FILLER REDEFINES SQ11FF.
  1318         10  SQ11FA PIC  X(0001).
  1319     05  SQ11FI PIC  X(0001).
  1320*    -------------------------------
  1321     05  L12FL PIC S9(0004) COMP.
  1322     05  L12FF PIC  X(0001).
  1323     05  FILLER REDEFINES L12FF.
  1324         10  L12FA PIC  X(0001).
  1325     05  L12FI PIC  X(0003).
  1326*    -------------------------------
  1327     05  TEXT12FL PIC S9(0004) COMP.
  1328     05  TEXT12FF PIC  X(0001).
  1329     05  FILLER REDEFINES TEXT12FF.
  1330         10  TEXT12FA PIC  X(0001).
  1331     05  TEXT12FI PIC  X(0070).
  1332*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL1042.cbl
  1333     05  CF12FL PIC S9(0004) COMP.
  1334     05  CF12FF PIC  X(0001).
  1335     05  FILLER REDEFINES CF12FF.
  1336         10  CF12FA PIC  X(0001).
  1337     05  CF12FI PIC  X(0002).
  1338*    -------------------------------
  1339     05  SQ12FL PIC S9(0004) COMP.
  1340     05  SQ12FF PIC  X(0001).
  1341     05  FILLER REDEFINES SQ12FF.
  1342         10  SQ12FA PIC  X(0001).
  1343     05  SQ12FI PIC  X(0001).
  1344*    -------------------------------
  1345     05  L13FL PIC S9(0004) COMP.
  1346     05  L13FF PIC  X(0001).
  1347     05  FILLER REDEFINES L13FF.
  1348         10  L13FA PIC  X(0001).
  1349     05  L13FI PIC  X(0003).
  1350*    -------------------------------
  1351     05  TEXT13FL PIC S9(0004) COMP.
  1352     05  TEXT13FF PIC  X(0001).
  1353     05  FILLER REDEFINES TEXT13FF.
  1354         10  TEXT13FA PIC  X(0001).
  1355     05  TEXT13FI PIC  X(0070).
  1356*    -------------------------------
  1357     05  CF13FL PIC S9(0004) COMP.
  1358     05  CF13FF PIC  X(0001).
  1359     05  FILLER REDEFINES CF13FF.
  1360         10  CF13FA PIC  X(0001).
  1361     05  CF13FI PIC  X(0002).
  1362*    -------------------------------
  1363     05  SQ13FL PIC S9(0004) COMP.
  1364     05  SQ13FF PIC  X(0001).
  1365     05  FILLER REDEFINES SQ13FF.
  1366         10  SQ13FA PIC  X(0001).
  1367     05  SQ13FI PIC  X(0001).
  1368*    -------------------------------
  1369     05  L14FL PIC S9(0004) COMP.
  1370     05  L14FF PIC  X(0001).
  1371     05  FILLER REDEFINES L14FF.
  1372         10  L14FA PIC  X(0001).
  1373     05  L14FI PIC  X(0003).
  1374*    -------------------------------
  1375     05  TEXT14FL PIC S9(0004) COMP.
  1376     05  TEXT14FF PIC  X(0001).
  1377     05  FILLER REDEFINES TEXT14FF.
  1378         10  TEXT14FA PIC  X(0001).
  1379     05  TEXT14FI PIC  X(0070).
  1380*    -------------------------------
  1381     05  CF14FL PIC S9(0004) COMP.
  1382     05  CF14FF PIC  X(0001).
  1383     05  FILLER REDEFINES CF14FF.
  1384         10  CF14FA PIC  X(0001).
  1385     05  CF14FI PIC  X(0002).
  1386*    -------------------------------
  1387     05  SQ14FL PIC S9(0004) COMP.
  1388     05  SQ14FF PIC  X(0001).
  1389     05  FILLER REDEFINES SQ14FF.
  1390         10  SQ14FA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL1042.cbl
  1391     05  SQ14FI PIC  X(0001).
  1392*    -------------------------------
  1393     05  L15FL PIC S9(0004) COMP.
  1394     05  L15FF PIC  X(0001).
  1395     05  FILLER REDEFINES L15FF.
  1396         10  L15FA PIC  X(0001).
  1397     05  L15FI PIC  X(0003).
  1398*    -------------------------------
  1399     05  TEXT15FL PIC S9(0004) COMP.
  1400     05  TEXT15FF PIC  X(0001).
  1401     05  FILLER REDEFINES TEXT15FF.
  1402         10  TEXT15FA PIC  X(0001).
  1403     05  TEXT15FI PIC  X(0070).
  1404*    -------------------------------
  1405     05  CF15FL PIC S9(0004) COMP.
  1406     05  CF15FF PIC  X(0001).
  1407     05  FILLER REDEFINES CF15FF.
  1408         10  CF15FA PIC  X(0001).
  1409     05  CF15FI PIC  X(0002).
  1410*    -------------------------------
  1411     05  SQ15FL PIC S9(0004) COMP.
  1412     05  SQ15FF PIC  X(0001).
  1413     05  FILLER REDEFINES SQ15FF.
  1414         10  SQ15FA PIC  X(0001).
  1415     05  SQ15FI PIC  X(0001).
  1416*    -------------------------------
  1417     05  ERMSGBFL PIC S9(0004) COMP.
  1418     05  ERMSGBFF PIC  X(0001).
  1419     05  FILLER REDEFINES ERMSGBFF.
  1420         10  ERMSGBFA PIC  X(0001).
  1421     05  ERMSGBFI PIC  X(0072).
  1422*    -------------------------------
  1423     05  FUNCTFL PIC S9(0004) COMP.
  1424     05  FUNCTFF PIC  X(0001).
  1425     05  FILLER REDEFINES FUNCTFF.
  1426         10  FUNCTFA PIC  X(0001).
  1427     05  FUNCTFI PIC  X(0001).
  1428*    -------------------------------
  1429     05  LINE1FL PIC S9(0004) COMP.
  1430     05  LINE1FF PIC  X(0001).
  1431     05  FILLER REDEFINES LINE1FF.
  1432         10  LINE1FA PIC  X(0001).
  1433     05  LINE1FI PIC  999.
  1434*    -------------------------------
  1435     05  LINE2FL PIC S9(0004) COMP.
  1436     05  LINE2FF PIC  X(0001).
  1437     05  FILLER REDEFINES LINE2FF.
  1438         10  LINE2FA PIC  X(0001).
  1439     05  LINE2FI PIC  999.
  1440*    -------------------------------
  1441     05  PFBFL PIC S9(0004) COMP.
  1442     05  PFBFF PIC  X(0001).
  1443     05  FILLER REDEFINES PFBFF.
  1444         10  PFBFA PIC  X(0001).
  1445     05  PFBFI PIC  99.
  1446*    -------------------------------
  1447     05  MNTBYFL PIC S9(0004) COMP.
  1448     05  MNTBYFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL1042.cbl
  1449     05  FILLER REDEFINES MNTBYFF.
  1450         10  MNTBYFA PIC  X(0001).
  1451     05  MNTBYFI PIC  X(0005).
  1452*    -------------------------------
  1453     05  MNTONFL PIC S9(0004) COMP.
  1454     05  MNTONFF PIC  X(0001).
  1455     05  FILLER REDEFINES MNTONFF.
  1456         10  MNTONFA PIC  X(0001).
  1457     05  MNTONFI PIC  X(0008).
  1458 01  EL104BFO REDEFINES EL104BFI.
  1459     05  FILLER            PIC  X(0012).
  1460*    -------------------------------
  1461     05  FILLER            PIC  X(0003).
  1462     05  DATEBFO PIC  X(0008).
  1463*    -------------------------------
  1464     05  FILLER            PIC  X(0003).
  1465     05  TIMEBFO PIC  99.99.
  1466*    -------------------------------
  1467     05  FILLER            PIC  X(0003).
  1468     05  COMPFO PIC  X(0003).
  1469*    -------------------------------
  1470     05  FILLER            PIC  X(0003).
  1471     05  TXTTPBFO PIC  X(0008).
  1472*    -------------------------------
  1473     05  FILLER            PIC  X(0003).
  1474     05  CNTRLBFO PIC  X(0012).
  1475*    -------------------------------
  1476     05  FILLER            PIC  X(0003).
  1477     05  ARCHTBFO PIC  X(0009).
  1478*    -------------------------------
  1479     05  FILLER            PIC  X(0003).
  1480     05  ARCHBFO PIC  X(0001).
  1481*    -------------------------------
  1482     05  FILLER            PIC  X(0003).
  1483     05  FRMSTBFO PIC  X(0012).
  1484*    -------------------------------
  1485     05  FILLER            PIC  X(0003).
  1486     05  FRMSQBFO PIC  X(0001).
  1487*    -------------------------------
  1488     05  FILLER            PIC  X(0003).
  1489     05  TOTFO PIC  X(0003).
  1490*    -------------------------------
  1491     05  FILLER            PIC  X(0003).
  1492     05  LNESQTFO PIC  X(0001).
  1493*    -------------------------------
  1494     05  FILLER            PIC  X(0003).
  1495     05  L1FO PIC  X(0003).
  1496*    -------------------------------
  1497     05  FILLER            PIC  X(0003).
  1498     05  TEXT1FO PIC  X(0070).
  1499*    -------------------------------
  1500     05  FILLER            PIC  X(0003).
  1501     05  CF1FO PIC  X(0002).
  1502*    -------------------------------
  1503     05  FILLER            PIC  X(0003).
  1504     05  SQ1FO PIC  X(0001).
  1505*    -------------------------------
  1506     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL1042.cbl
  1507     05  L2FO PIC  X(0003).
  1508*    -------------------------------
  1509     05  FILLER            PIC  X(0003).
  1510     05  TEXT2FO PIC  X(0070).
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
  1513     05  CF2FO PIC  X(0002).
  1514*    -------------------------------
  1515     05  FILLER            PIC  X(0003).
  1516     05  SQ2FO PIC  X(0001).
  1517*    -------------------------------
  1518     05  FILLER            PIC  X(0003).
  1519     05  L3FO PIC  X(0003).
  1520*    -------------------------------
  1521     05  FILLER            PIC  X(0003).
  1522     05  TEXT3FO PIC  X(0070).
  1523*    -------------------------------
  1524     05  FILLER            PIC  X(0003).
  1525     05  CF3FO PIC  X(0002).
  1526*    -------------------------------
  1527     05  FILLER            PIC  X(0003).
  1528     05  SQ3FO PIC  X(0001).
  1529*    -------------------------------
  1530     05  FILLER            PIC  X(0003).
  1531     05  L4FO PIC  X(0003).
  1532*    -------------------------------
  1533     05  FILLER            PIC  X(0003).
  1534     05  TEXT4FO PIC  X(0070).
  1535*    -------------------------------
  1536     05  FILLER            PIC  X(0003).
  1537     05  CF4FO PIC  X(0002).
  1538*    -------------------------------
  1539     05  FILLER            PIC  X(0003).
  1540     05  SQ4FO PIC  X(0001).
  1541*    -------------------------------
  1542     05  FILLER            PIC  X(0003).
  1543     05  L5FO PIC  X(0003).
  1544*    -------------------------------
  1545     05  FILLER            PIC  X(0003).
  1546     05  TEXT5FO PIC  X(0070).
  1547*    -------------------------------
  1548     05  FILLER            PIC  X(0003).
  1549     05  CF5FO PIC  X(0002).
  1550*    -------------------------------
  1551     05  FILLER            PIC  X(0003).
  1552     05  SQ5FO PIC  X(0001).
  1553*    -------------------------------
  1554     05  FILLER            PIC  X(0003).
  1555     05  L6FO PIC  X(0003).
  1556*    -------------------------------
  1557     05  FILLER            PIC  X(0003).
  1558     05  TEXT6FO PIC  X(0070).
  1559*    -------------------------------
  1560     05  FILLER            PIC  X(0003).
  1561     05  CF6FO PIC  X(0002).
  1562*    -------------------------------
  1563     05  FILLER            PIC  X(0003).
  1564     05  SQ6FO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL1042.cbl
  1565*    -------------------------------
  1566     05  FILLER            PIC  X(0003).
  1567     05  L7FO PIC  X(0003).
  1568*    -------------------------------
  1569     05  FILLER            PIC  X(0003).
  1570     05  TEXT7FO PIC  X(0070).
  1571*    -------------------------------
  1572     05  FILLER            PIC  X(0003).
  1573     05  CF7FO PIC  X(0002).
  1574*    -------------------------------
  1575     05  FILLER            PIC  X(0003).
  1576     05  SQ7FO PIC  X(0001).
  1577*    -------------------------------
  1578     05  FILLER            PIC  X(0003).
  1579     05  L8FO PIC  X(0003).
  1580*    -------------------------------
  1581     05  FILLER            PIC  X(0003).
  1582     05  TEXT8FO PIC  X(0070).
  1583*    -------------------------------
  1584     05  FILLER            PIC  X(0003).
  1585     05  CF8FO PIC  X(0002).
  1586*    -------------------------------
  1587     05  FILLER            PIC  X(0003).
  1588     05  SQ8FO PIC  X(0001).
  1589*    -------------------------------
  1590     05  FILLER            PIC  X(0003).
  1591     05  L9FO PIC  X(0003).
  1592*    -------------------------------
  1593     05  FILLER            PIC  X(0003).
  1594     05  TEXT9FO PIC  X(0070).
  1595*    -------------------------------
  1596     05  FILLER            PIC  X(0003).
  1597     05  CF9FO PIC  X(0002).
  1598*    -------------------------------
  1599     05  FILLER            PIC  X(0003).
  1600     05  SQ9FO PIC  X(0001).
  1601*    -------------------------------
  1602     05  FILLER            PIC  X(0003).
  1603     05  L10FO PIC  X(0003).
  1604*    -------------------------------
  1605     05  FILLER            PIC  X(0003).
  1606     05  TEXT10FO PIC  X(0070).
  1607*    -------------------------------
  1608     05  FILLER            PIC  X(0003).
  1609     05  CF10FO PIC  X(0002).
  1610*    -------------------------------
  1611     05  FILLER            PIC  X(0003).
  1612     05  SQ10FO PIC  X(0001).
  1613*    -------------------------------
  1614     05  FILLER            PIC  X(0003).
  1615     05  L11FO PIC  X(0003).
  1616*    -------------------------------
  1617     05  FILLER            PIC  X(0003).
  1618     05  TEXT11FO PIC  X(0070).
  1619*    -------------------------------
  1620     05  FILLER            PIC  X(0003).
  1621     05  CF11FO PIC  X(0002).
  1622*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL1042.cbl
  1623     05  FILLER            PIC  X(0003).
  1624     05  SQ11FO PIC  X(0001).
  1625*    -------------------------------
  1626     05  FILLER            PIC  X(0003).
  1627     05  L12FO PIC  X(0003).
  1628*    -------------------------------
  1629     05  FILLER            PIC  X(0003).
  1630     05  TEXT12FO PIC  X(0070).
  1631*    -------------------------------
  1632     05  FILLER            PIC  X(0003).
  1633     05  CF12FO PIC  X(0002).
  1634*    -------------------------------
  1635     05  FILLER            PIC  X(0003).
  1636     05  SQ12FO PIC  X(0001).
  1637*    -------------------------------
  1638     05  FILLER            PIC  X(0003).
  1639     05  L13FO PIC  X(0003).
  1640*    -------------------------------
  1641     05  FILLER            PIC  X(0003).
  1642     05  TEXT13FO PIC  X(0070).
  1643*    -------------------------------
  1644     05  FILLER            PIC  X(0003).
  1645     05  CF13FO PIC  X(0002).
  1646*    -------------------------------
  1647     05  FILLER            PIC  X(0003).
  1648     05  SQ13FO PIC  X(0001).
  1649*    -------------------------------
  1650     05  FILLER            PIC  X(0003).
  1651     05  L14FO PIC  X(0003).
  1652*    -------------------------------
  1653     05  FILLER            PIC  X(0003).
  1654     05  TEXT14FO PIC  X(0070).
  1655*    -------------------------------
  1656     05  FILLER            PIC  X(0003).
  1657     05  CF14FO PIC  X(0002).
  1658*    -------------------------------
  1659     05  FILLER            PIC  X(0003).
  1660     05  SQ14FO PIC  X(0001).
  1661*    -------------------------------
  1662     05  FILLER            PIC  X(0003).
  1663     05  L15FO PIC  X(0003).
  1664*    -------------------------------
  1665     05  FILLER            PIC  X(0003).
  1666     05  TEXT15FO PIC  X(0070).
  1667*    -------------------------------
  1668     05  FILLER            PIC  X(0003).
  1669     05  CF15FO PIC  X(0002).
  1670*    -------------------------------
  1671     05  FILLER            PIC  X(0003).
  1672     05  SQ15FO PIC  X(0001).
  1673*    -------------------------------
  1674     05  FILLER            PIC  X(0003).
  1675     05  ERMSGBFO PIC  X(0072).
  1676*    -------------------------------
  1677     05  FILLER            PIC  X(0003).
  1678     05  FUNCTFO PIC  X(0001).
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL1042.cbl
  1681     05  LINE1FO PIC  X(0003).
  1682*    -------------------------------
  1683     05  FILLER            PIC  X(0003).
  1684     05  LINE2FO PIC  X(0003).
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  PFBFO PIC  X(0002).
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  MNTBYFO PIC  X(0005).
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  MNTONFO PIC  X(0008).
  1694*    -------------------------------
  1695 01  EL104BI REDEFINES EL104BFI.
  1696     05  FILLER            PIC  X(0012).
  1697*    -------------------------------
  1698     05  DATEBL PIC S9(0004) COMP.
  1699     05  DATEBF PIC  X(0001).
  1700     05  FILLER REDEFINES DATEBF.
  1701         10  DATEBA PIC  X(0001).
  1702     05  DATEBI PIC  X(0008).
  1703*    -------------------------------
  1704     05  TIMEBL PIC S9(0004) COMP.
  1705     05  TIMEBF PIC  X(0001).
  1706     05  FILLER REDEFINES TIMEBF.
  1707         10  TIMEBA PIC  X(0001).
  1708     05  TIMEBI PIC  X(0005).
  1709*    -------------------------------
  1710     05  COMPANYL PIC S9(0004) COMP.
  1711     05  COMPANYF PIC  X(0001).
  1712     05  FILLER REDEFINES COMPANYF.
  1713         10  COMPANYA PIC  X(0001).
  1714     05  COMPANYI PIC  X(0003).
  1715*    -------------------------------
  1716     05  TEXTTPBL PIC S9(0004) COMP.
  1717     05  TEXTTPBF PIC  X(0001).
  1718     05  FILLER REDEFINES TEXTTPBF.
  1719         10  TEXTTPBA PIC  X(0001).
  1720     05  TEXTTPBI PIC  X(0008).
  1721*    -------------------------------
  1722     05  CONTRLBL PIC S9(0004) COMP.
  1723     05  CONTRLBF PIC  X(0001).
  1724     05  FILLER REDEFINES CONTRLBF.
  1725         10  CONTRLBA PIC  X(0001).
  1726     05  CONTRLBI PIC  X(0012).
  1727*    -------------------------------
  1728     05  ARCHTBL PIC S9(0004) COMP.
  1729     05  ARCHTBF PIC  X(0001).
  1730     05  FILLER REDEFINES ARCHTBF.
  1731         10  ARCHTBA PIC  X(0001).
  1732     05  ARCHTBI PIC  X(0009).
  1733*    -------------------------------
  1734     05  ARCHBL PIC S9(0004) COMP.
  1735     05  ARCHBF PIC  X(0001).
  1736     05  FILLER REDEFINES ARCHBF.
  1737         10  ARCHBA PIC  X(0001).
  1738     05  ARCHBI PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL1042.cbl
  1739*    -------------------------------
  1740     05  FORMSTBL PIC S9(0004) COMP.
  1741     05  FORMSTBF PIC  X(0001).
  1742     05  FILLER REDEFINES FORMSTBF.
  1743         10  FORMSTBA PIC  X(0001).
  1744     05  FORMSTBI PIC  X(0012).
  1745*    -------------------------------
  1746     05  FORMSQBL PIC S9(0004) COMP.
  1747     05  FORMSQBF PIC  X(0001).
  1748     05  FILLER REDEFINES FORMSQBF.
  1749         10  FORMSQBA PIC  X(0001).
  1750     05  FORMSQBI PIC  X(0001).
  1751*    -------------------------------
  1752     05  TOTL PIC S9(0004) COMP.
  1753     05  TOTF PIC  X(0001).
  1754     05  FILLER REDEFINES TOTF.
  1755         10  TOTA PIC  X(0001).
  1756     05  TOTI PIC  999.
  1757*    -------------------------------
  1758     05  LINESQTL PIC S9(0004) COMP.
  1759     05  LINESQTF PIC  X(0001).
  1760     05  FILLER REDEFINES LINESQTF.
  1761         10  LINESQTA PIC  X(0001).
  1762     05  LINESQTI PIC  X(0001).
  1763*    -------------------------------
  1764     05  L1L PIC S9(0004) COMP.
  1765     05  L1F PIC  X(0001).
  1766     05  FILLER REDEFINES L1F.
  1767         10  L1A PIC  X(0001).
  1768     05  L1I PIC  X(0003).
  1769*    -------------------------------
  1770     05  TEXT1L PIC S9(0004) COMP.
  1771     05  TEXT1F PIC  X(0001).
  1772     05  FILLER REDEFINES TEXT1F.
  1773         10  TEXT1A PIC  X(0001).
  1774     05  TEXT1I PIC  X(0070).
  1775*    -------------------------------
  1776     05  CF1L PIC S9(0004) COMP.
  1777     05  CF1F PIC  X(0001).
  1778     05  FILLER REDEFINES CF1F.
  1779         10  CF1A PIC  X(0001).
  1780     05  CF1I PIC  X(0002).
  1781*    -------------------------------
  1782     05  SQ1L PIC S9(0004) COMP.
  1783     05  SQ1F PIC  X(0001).
  1784     05  FILLER REDEFINES SQ1F.
  1785         10  SQ1A PIC  X(0001).
  1786     05  SQ1I PIC  X(0001).
  1787*    -------------------------------
  1788     05  L2L PIC S9(0004) COMP.
  1789     05  L2F PIC  X(0001).
  1790     05  FILLER REDEFINES L2F.
  1791         10  L2A PIC  X(0001).
  1792     05  L2I PIC  X(0003).
  1793*    -------------------------------
  1794     05  TEXT2L PIC S9(0004) COMP.
  1795     05  TEXT2F PIC  X(0001).
  1796     05  FILLER REDEFINES TEXT2F.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL1042.cbl
  1797         10  TEXT2A PIC  X(0001).
  1798     05  TEXT2I PIC  X(0070).
  1799*    -------------------------------
  1800     05  CF2L PIC S9(0004) COMP.
  1801     05  CF2F PIC  X(0001).
  1802     05  FILLER REDEFINES CF2F.
  1803         10  CF2A PIC  X(0001).
  1804     05  CF2I PIC  X(0002).
  1805*    -------------------------------
  1806     05  SQ2L PIC S9(0004) COMP.
  1807     05  SQ2F PIC  X(0001).
  1808     05  FILLER REDEFINES SQ2F.
  1809         10  SQ2A PIC  X(0001).
  1810     05  SQ2I PIC  X(0001).
  1811*    -------------------------------
  1812     05  L3L PIC S9(0004) COMP.
  1813     05  L3F PIC  X(0001).
  1814     05  FILLER REDEFINES L3F.
  1815         10  L3A PIC  X(0001).
  1816     05  L3I PIC  X(0003).
  1817*    -------------------------------
  1818     05  TEXT3L PIC S9(0004) COMP.
  1819     05  TEXT3F PIC  X(0001).
  1820     05  FILLER REDEFINES TEXT3F.
  1821         10  TEXT3A PIC  X(0001).
  1822     05  TEXT3I PIC  X(0070).
  1823*    -------------------------------
  1824     05  CF3L PIC S9(0004) COMP.
  1825     05  CF3F PIC  X(0001).
  1826     05  FILLER REDEFINES CF3F.
  1827         10  CF3A PIC  X(0001).
  1828     05  CF3I PIC  X(0002).
  1829*    -------------------------------
  1830     05  SQ3L PIC S9(0004) COMP.
  1831     05  SQ3F PIC  X(0001).
  1832     05  FILLER REDEFINES SQ3F.
  1833         10  SQ3A PIC  X(0001).
  1834     05  SQ3I PIC  X(0001).
  1835*    -------------------------------
  1836     05  L4L PIC S9(0004) COMP.
  1837     05  L4F PIC  X(0001).
  1838     05  FILLER REDEFINES L4F.
  1839         10  L4A PIC  X(0001).
  1840     05  L4I PIC  X(0003).
  1841*    -------------------------------
  1842     05  TEXT4L PIC S9(0004) COMP.
  1843     05  TEXT4F PIC  X(0001).
  1844     05  FILLER REDEFINES TEXT4F.
  1845         10  TEXT4A PIC  X(0001).
  1846     05  TEXT4I PIC  X(0070).
  1847*    -------------------------------
  1848     05  CF4L PIC S9(0004) COMP.
  1849     05  CF4F PIC  X(0001).
  1850     05  FILLER REDEFINES CF4F.
  1851         10  CF4A PIC  X(0001).
  1852     05  CF4I PIC  X(0002).
  1853*    -------------------------------
  1854     05  SQ4L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL1042.cbl
  1855     05  SQ4F PIC  X(0001).
  1856     05  FILLER REDEFINES SQ4F.
  1857         10  SQ4A PIC  X(0001).
  1858     05  SQ4I PIC  X(0001).
  1859*    -------------------------------
  1860     05  L5L PIC S9(0004) COMP.
  1861     05  L5F PIC  X(0001).
  1862     05  FILLER REDEFINES L5F.
  1863         10  L5A PIC  X(0001).
  1864     05  L5I PIC  X(0003).
  1865*    -------------------------------
  1866     05  TEXT5L PIC S9(0004) COMP.
  1867     05  TEXT5F PIC  X(0001).
  1868     05  FILLER REDEFINES TEXT5F.
  1869         10  TEXT5A PIC  X(0001).
  1870     05  TEXT5I PIC  X(0070).
  1871*    -------------------------------
  1872     05  CF5L PIC S9(0004) COMP.
  1873     05  CF5F PIC  X(0001).
  1874     05  FILLER REDEFINES CF5F.
  1875         10  CF5A PIC  X(0001).
  1876     05  CF5I PIC  X(0002).
  1877*    -------------------------------
  1878     05  SQ5L PIC S9(0004) COMP.
  1879     05  SQ5F PIC  X(0001).
  1880     05  FILLER REDEFINES SQ5F.
  1881         10  SQ5A PIC  X(0001).
  1882     05  SQ5I PIC  X(0001).
  1883*    -------------------------------
  1884     05  L6L PIC S9(0004) COMP.
  1885     05  L6F PIC  X(0001).
  1886     05  FILLER REDEFINES L6F.
  1887         10  L6A PIC  X(0001).
  1888     05  L6I PIC  X(0003).
  1889*    -------------------------------
  1890     05  TEXT6L PIC S9(0004) COMP.
  1891     05  TEXT6F PIC  X(0001).
  1892     05  FILLER REDEFINES TEXT6F.
  1893         10  TEXT6A PIC  X(0001).
  1894     05  TEXT6I PIC  X(0070).
  1895*    -------------------------------
  1896     05  CF6L PIC S9(0004) COMP.
  1897     05  CF6F PIC  X(0001).
  1898     05  FILLER REDEFINES CF6F.
  1899         10  CF6A PIC  X(0001).
  1900     05  CF6I PIC  X(0002).
  1901*    -------------------------------
  1902     05  SQ6L PIC S9(0004) COMP.
  1903     05  SQ6F PIC  X(0001).
  1904     05  FILLER REDEFINES SQ6F.
  1905         10  SQ6A PIC  X(0001).
  1906     05  SQ6I PIC  X(0001).
  1907*    -------------------------------
  1908     05  L7L PIC S9(0004) COMP.
  1909     05  L7F PIC  X(0001).
  1910     05  FILLER REDEFINES L7F.
  1911         10  L7A PIC  X(0001).
  1912     05  L7I PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL1042.cbl
  1913*    -------------------------------
  1914     05  TEXT7L PIC S9(0004) COMP.
  1915     05  TEXT7F PIC  X(0001).
  1916     05  FILLER REDEFINES TEXT7F.
  1917         10  TEXT7A PIC  X(0001).
  1918     05  TEXT7I PIC  X(0070).
  1919*    -------------------------------
  1920     05  CF7L PIC S9(0004) COMP.
  1921     05  CF7F PIC  X(0001).
  1922     05  FILLER REDEFINES CF7F.
  1923         10  CF7A PIC  X(0001).
  1924     05  CF7I PIC  X(0002).
  1925*    -------------------------------
  1926     05  SQ7L PIC S9(0004) COMP.
  1927     05  SQ7F PIC  X(0001).
  1928     05  FILLER REDEFINES SQ7F.
  1929         10  SQ7A PIC  X(0001).
  1930     05  SQ7I PIC  X(0001).
  1931*    -------------------------------
  1932     05  L8L PIC S9(0004) COMP.
  1933     05  L8F PIC  X(0001).
  1934     05  FILLER REDEFINES L8F.
  1935         10  L8A PIC  X(0001).
  1936     05  L8I PIC  X(0003).
  1937*    -------------------------------
  1938     05  TEXT8L PIC S9(0004) COMP.
  1939     05  TEXT8F PIC  X(0001).
  1940     05  FILLER REDEFINES TEXT8F.
  1941         10  TEXT8A PIC  X(0001).
  1942     05  TEXT8I PIC  X(0070).
  1943*    -------------------------------
  1944     05  CF8L PIC S9(0004) COMP.
  1945     05  CF8F PIC  X(0001).
  1946     05  FILLER REDEFINES CF8F.
  1947         10  CF8A PIC  X(0001).
  1948     05  CF8I PIC  X(0002).
  1949*    -------------------------------
  1950     05  SQ8L PIC S9(0004) COMP.
  1951     05  SQ8F PIC  X(0001).
  1952     05  FILLER REDEFINES SQ8F.
  1953         10  SQ8A PIC  X(0001).
  1954     05  SQ8I PIC  X(0001).
  1955*    -------------------------------
  1956     05  L9L PIC S9(0004) COMP.
  1957     05  L9F PIC  X(0001).
  1958     05  FILLER REDEFINES L9F.
  1959         10  L9A PIC  X(0001).
  1960     05  L9I PIC  X(0003).
  1961*    -------------------------------
  1962     05  TEXT9L PIC S9(0004) COMP.
  1963     05  TEXT9F PIC  X(0001).
  1964     05  FILLER REDEFINES TEXT9F.
  1965         10  TEXT9A PIC  X(0001).
  1966     05  TEXT9I PIC  X(0070).
  1967*    -------------------------------
  1968     05  CF9L PIC S9(0004) COMP.
  1969     05  CF9F PIC  X(0001).
  1970     05  FILLER REDEFINES CF9F.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL1042.cbl
  1971         10  CF9A PIC  X(0001).
  1972     05  CF9I PIC  X(0002).
  1973*    -------------------------------
  1974     05  SQ9L PIC S9(0004) COMP.
  1975     05  SQ9F PIC  X(0001).
  1976     05  FILLER REDEFINES SQ9F.
  1977         10  SQ9A PIC  X(0001).
  1978     05  SQ9I PIC  X(0001).
  1979*    -------------------------------
  1980     05  L10L PIC S9(0004) COMP.
  1981     05  L10F PIC  X(0001).
  1982     05  FILLER REDEFINES L10F.
  1983         10  L10A PIC  X(0001).
  1984     05  L10I PIC  X(0003).
  1985*    -------------------------------
  1986     05  TEXT10L PIC S9(0004) COMP.
  1987     05  TEXT10F PIC  X(0001).
  1988     05  FILLER REDEFINES TEXT10F.
  1989         10  TEXT10A PIC  X(0001).
  1990     05  TEXT10I PIC  X(0070).
  1991*    -------------------------------
  1992     05  CF10L PIC S9(0004) COMP.
  1993     05  CF10F PIC  X(0001).
  1994     05  FILLER REDEFINES CF10F.
  1995         10  CF10A PIC  X(0001).
  1996     05  CF10I PIC  X(0002).
  1997*    -------------------------------
  1998     05  SQ10L PIC S9(0004) COMP.
  1999     05  SQ10F PIC  X(0001).
  2000     05  FILLER REDEFINES SQ10F.
  2001         10  SQ10A PIC  X(0001).
  2002     05  SQ10I PIC  X(0001).
  2003*    -------------------------------
  2004     05  L11L PIC S9(0004) COMP.
  2005     05  L11F PIC  X(0001).
  2006     05  FILLER REDEFINES L11F.
  2007         10  L11A PIC  X(0001).
  2008     05  L11I PIC  X(0003).
  2009*    -------------------------------
  2010     05  TEXT11L PIC S9(0004) COMP.
  2011     05  TEXT11F PIC  X(0001).
  2012     05  FILLER REDEFINES TEXT11F.
  2013         10  TEXT11A PIC  X(0001).
  2014     05  TEXT11I PIC  X(0070).
  2015*    -------------------------------
  2016     05  CF11L PIC S9(0004) COMP.
  2017     05  CF11F PIC  X(0001).
  2018     05  FILLER REDEFINES CF11F.
  2019         10  CF11A PIC  X(0001).
  2020     05  CF11I PIC  X(0002).
  2021*    -------------------------------
  2022     05  SQ11L PIC S9(0004) COMP.
  2023     05  SQ11F PIC  X(0001).
  2024     05  FILLER REDEFINES SQ11F.
  2025         10  SQ11A PIC  X(0001).
  2026     05  SQ11I PIC  X(0001).
  2027*    -------------------------------
  2028     05  L12L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL1042.cbl
  2029     05  L12F PIC  X(0001).
  2030     05  FILLER REDEFINES L12F.
  2031         10  L12A PIC  X(0001).
  2032     05  L12I PIC  X(0003).
  2033*    -------------------------------
  2034     05  TEXT12L PIC S9(0004) COMP.
  2035     05  TEXT12F PIC  X(0001).
  2036     05  FILLER REDEFINES TEXT12F.
  2037         10  TEXT12A PIC  X(0001).
  2038     05  TEXT12I PIC  X(0070).
  2039*    -------------------------------
  2040     05  CF12L PIC S9(0004) COMP.
  2041     05  CF12F PIC  X(0001).
  2042     05  FILLER REDEFINES CF12F.
  2043         10  CF12A PIC  X(0001).
  2044     05  CF12I PIC  X(0002).
  2045*    -------------------------------
  2046     05  SQ12L PIC S9(0004) COMP.
  2047     05  SQ12F PIC  X(0001).
  2048     05  FILLER REDEFINES SQ12F.
  2049         10  SQ12A PIC  X(0001).
  2050     05  SQ12I PIC  X(0001).
  2051*    -------------------------------
  2052     05  L13L PIC S9(0004) COMP.
  2053     05  L13F PIC  X(0001).
  2054     05  FILLER REDEFINES L13F.
  2055         10  L13A PIC  X(0001).
  2056     05  L13I PIC  X(0003).
  2057*    -------------------------------
  2058     05  TEXT13L PIC S9(0004) COMP.
  2059     05  TEXT13F PIC  X(0001).
  2060     05  FILLER REDEFINES TEXT13F.
  2061         10  TEXT13A PIC  X(0001).
  2062     05  TEXT13I PIC  X(0070).
  2063*    -------------------------------
  2064     05  CF13L PIC S9(0004) COMP.
  2065     05  CF13F PIC  X(0001).
  2066     05  FILLER REDEFINES CF13F.
  2067         10  CF13A PIC  X(0001).
  2068     05  CF13I PIC  X(0002).
  2069*    -------------------------------
  2070     05  SQ13L PIC S9(0004) COMP.
  2071     05  SQ13F PIC  X(0001).
  2072     05  FILLER REDEFINES SQ13F.
  2073         10  SQ13A PIC  X(0001).
  2074     05  SQ13I PIC  X(0001).
  2075*    -------------------------------
  2076     05  L14L PIC S9(0004) COMP.
  2077     05  L14F PIC  X(0001).
  2078     05  FILLER REDEFINES L14F.
  2079         10  L14A PIC  X(0001).
  2080     05  L14I PIC  X(0003).
  2081*    -------------------------------
  2082     05  TEXT14L PIC S9(0004) COMP.
  2083     05  TEXT14F PIC  X(0001).
  2084     05  FILLER REDEFINES TEXT14F.
  2085         10  TEXT14A PIC  X(0001).
  2086     05  TEXT14I PIC  X(0070).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL1042.cbl
  2087*    -------------------------------
  2088     05  CF14L PIC S9(0004) COMP.
  2089     05  CF14F PIC  X(0001).
  2090     05  FILLER REDEFINES CF14F.
  2091         10  CF14A PIC  X(0001).
  2092     05  CF14I PIC  X(0002).
  2093*    -------------------------------
  2094     05  SQ14L PIC S9(0004) COMP.
  2095     05  SQ14F PIC  X(0001).
  2096     05  FILLER REDEFINES SQ14F.
  2097         10  SQ14A PIC  X(0001).
  2098     05  SQ14I PIC  X(0001).
  2099*    -------------------------------
  2100     05  L15L PIC S9(0004) COMP.
  2101     05  L15F PIC  X(0001).
  2102     05  FILLER REDEFINES L15F.
  2103         10  L15A PIC  X(0001).
  2104     05  L15I PIC  X(0003).
  2105*    -------------------------------
  2106     05  TEXT15L PIC S9(0004) COMP.
  2107     05  TEXT15F PIC  X(0001).
  2108     05  FILLER REDEFINES TEXT15F.
  2109         10  TEXT15A PIC  X(0001).
  2110     05  TEXT15I PIC  X(0070).
  2111*    -------------------------------
  2112     05  CF15L PIC S9(0004) COMP.
  2113     05  CF15F PIC  X(0001).
  2114     05  FILLER REDEFINES CF15F.
  2115         10  CF15A PIC  X(0001).
  2116     05  CF15I PIC  X(0002).
  2117*    -------------------------------
  2118     05  SQ15L PIC S9(0004) COMP.
  2119     05  SQ15F PIC  X(0001).
  2120     05  FILLER REDEFINES SQ15F.
  2121         10  SQ15A PIC  X(0001).
  2122     05  SQ15I PIC  X(0001).
  2123*    -------------------------------
  2124     05  ERRMSGBL PIC S9(0004) COMP.
  2125     05  ERRMSGBF PIC  X(0001).
  2126     05  FILLER REDEFINES ERRMSGBF.
  2127         10  ERRMSGBA PIC  X(0001).
  2128     05  ERRMSGBI PIC  X(0072).
  2129*    -------------------------------
  2130     05  FUNCTL PIC S9(0004) COMP.
  2131     05  FUNCTF PIC  X(0001).
  2132     05  FILLER REDEFINES FUNCTF.
  2133         10  FUNCTA PIC  X(0001).
  2134     05  FUNCTI PIC  X(0001).
  2135*    -------------------------------
  2136     05  LINE1L PIC S9(0004) COMP.
  2137     05  LINE1F PIC  X(0001).
  2138     05  FILLER REDEFINES LINE1F.
  2139         10  LINE1A PIC  X(0001).
  2140     05  LINE1I PIC  999.
  2141*    -------------------------------
  2142     05  LINE2L PIC S9(0004) COMP.
  2143     05  LINE2F PIC  X(0001).
  2144     05  FILLER REDEFINES LINE2F.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL1042.cbl
  2145         10  LINE2A PIC  X(0001).
  2146     05  LINE2I PIC  999.
  2147*    -------------------------------
  2148     05  PFENTRBL PIC S9(0004) COMP.
  2149     05  PFENTRBF PIC  X(0001).
  2150     05  FILLER REDEFINES PFENTRBF.
  2151         10  PFENTRBA PIC  X(0001).
  2152     05  PFENTRBI PIC  99.
  2153*    -------------------------------
  2154     05  MNTBYL PIC S9(0004) COMP.
  2155     05  MNTBYF PIC  X(0001).
  2156     05  FILLER REDEFINES MNTBYF.
  2157         10  MNTBYA PIC  X(0001).
  2158     05  MNTBYI PIC  X(0004).
  2159*    -------------------------------
  2160     05  MNTONL PIC S9(0004) COMP.
  2161     05  MNTONF PIC  X(0001).
  2162     05  FILLER REDEFINES MNTONF.
  2163         10  MNTONA PIC  X(0001).
  2164     05  MNTONI PIC  X(0008).
  2165 01  EL104BO REDEFINES EL104BFI.
  2166     05  FILLER            PIC  X(0012).
  2167*    -------------------------------
  2168     05  FILLER            PIC  X(0003).
  2169     05  DATEBO PIC  X(0008).
  2170*    -------------------------------
  2171     05  FILLER            PIC  X(0003).
  2172     05  TIMEBO PIC  99.99.
  2173*    -------------------------------
  2174     05  FILLER            PIC  X(0003).
  2175     05  COMPANYO PIC  X(0003).
  2176*    -------------------------------
  2177     05  FILLER            PIC  X(0003).
  2178     05  TEXTTPBO PIC  X(0008).
  2179*    -------------------------------
  2180     05  FILLER            PIC  X(0003).
  2181     05  CONTRLBO PIC  X(0012).
  2182*    -------------------------------
  2183     05  FILLER            PIC  X(0003).
  2184     05  ARCHTBO PIC  X(0009).
  2185*    -------------------------------
  2186     05  FILLER            PIC  X(0003).
  2187     05  ARCHBO PIC  X(0001).
  2188*    -------------------------------
  2189     05  FILLER            PIC  X(0003).
  2190     05  FORMSTBO PIC  X(0012).
  2191*    -------------------------------
  2192     05  FILLER            PIC  X(0003).
  2193     05  FORMSQBO PIC  X(0001).
  2194*    -------------------------------
  2195     05  FILLER            PIC  X(0003).
  2196     05  TOTO PIC  X(0003).
  2197*    -------------------------------
  2198     05  FILLER            PIC  X(0003).
  2199     05  LINESQTO PIC  X(0001).
  2200*    -------------------------------
  2201     05  FILLER            PIC  X(0003).
  2202     05  L1O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL1042.cbl
  2203*    -------------------------------
  2204     05  FILLER            PIC  X(0003).
  2205     05  TEXT1O PIC  X(0070).
  2206*    -------------------------------
  2207     05  FILLER            PIC  X(0003).
  2208     05  CF1O PIC  X(0002).
  2209*    -------------------------------
  2210     05  FILLER            PIC  X(0003).
  2211     05  SQ1O PIC  X(0001).
  2212*    -------------------------------
  2213     05  FILLER            PIC  X(0003).
  2214     05  L2O PIC  X(0003).
  2215*    -------------------------------
  2216     05  FILLER            PIC  X(0003).
  2217     05  TEXT2O PIC  X(0070).
  2218*    -------------------------------
  2219     05  FILLER            PIC  X(0003).
  2220     05  CF2O PIC  X(0002).
  2221*    -------------------------------
  2222     05  FILLER            PIC  X(0003).
  2223     05  SQ2O PIC  X(0001).
  2224*    -------------------------------
  2225     05  FILLER            PIC  X(0003).
  2226     05  L3O PIC  X(0003).
  2227*    -------------------------------
  2228     05  FILLER            PIC  X(0003).
  2229     05  TEXT3O PIC  X(0070).
  2230*    -------------------------------
  2231     05  FILLER            PIC  X(0003).
  2232     05  CF3O PIC  X(0002).
  2233*    -------------------------------
  2234     05  FILLER            PIC  X(0003).
  2235     05  SQ3O PIC  X(0001).
  2236*    -------------------------------
  2237     05  FILLER            PIC  X(0003).
  2238     05  L4O PIC  X(0003).
  2239*    -------------------------------
  2240     05  FILLER            PIC  X(0003).
  2241     05  TEXT4O PIC  X(0070).
  2242*    -------------------------------
  2243     05  FILLER            PIC  X(0003).
  2244     05  CF4O PIC  X(0002).
  2245*    -------------------------------
  2246     05  FILLER            PIC  X(0003).
  2247     05  SQ4O PIC  X(0001).
  2248*    -------------------------------
  2249     05  FILLER            PIC  X(0003).
  2250     05  L5O PIC  X(0003).
  2251*    -------------------------------
  2252     05  FILLER            PIC  X(0003).
  2253     05  TEXT5O PIC  X(0070).
  2254*    -------------------------------
  2255     05  FILLER            PIC  X(0003).
  2256     05  CF5O PIC  X(0002).
  2257*    -------------------------------
  2258     05  FILLER            PIC  X(0003).
  2259     05  SQ5O PIC  X(0001).
  2260*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL1042.cbl
  2261     05  FILLER            PIC  X(0003).
  2262     05  L6O PIC  X(0003).
  2263*    -------------------------------
  2264     05  FILLER            PIC  X(0003).
  2265     05  TEXT6O PIC  X(0070).
  2266*    -------------------------------
  2267     05  FILLER            PIC  X(0003).
  2268     05  CF6O PIC  X(0002).
  2269*    -------------------------------
  2270     05  FILLER            PIC  X(0003).
  2271     05  SQ6O PIC  X(0001).
  2272*    -------------------------------
  2273     05  FILLER            PIC  X(0003).
  2274     05  L7O PIC  X(0003).
  2275*    -------------------------------
  2276     05  FILLER            PIC  X(0003).
  2277     05  TEXT7O PIC  X(0070).
  2278*    -------------------------------
  2279     05  FILLER            PIC  X(0003).
  2280     05  CF7O PIC  X(0002).
  2281*    -------------------------------
  2282     05  FILLER            PIC  X(0003).
  2283     05  SQ7O PIC  X(0001).
  2284*    -------------------------------
  2285     05  FILLER            PIC  X(0003).
  2286     05  L8O PIC  X(0003).
  2287*    -------------------------------
  2288     05  FILLER            PIC  X(0003).
  2289     05  TEXT8O PIC  X(0070).
  2290*    -------------------------------
  2291     05  FILLER            PIC  X(0003).
  2292     05  CF8O PIC  X(0002).
  2293*    -------------------------------
  2294     05  FILLER            PIC  X(0003).
  2295     05  SQ8O PIC  X(0001).
  2296*    -------------------------------
  2297     05  FILLER            PIC  X(0003).
  2298     05  L9O PIC  X(0003).
  2299*    -------------------------------
  2300     05  FILLER            PIC  X(0003).
  2301     05  TEXT9O PIC  X(0070).
  2302*    -------------------------------
  2303     05  FILLER            PIC  X(0003).
  2304     05  CF9O PIC  X(0002).
  2305*    -------------------------------
  2306     05  FILLER            PIC  X(0003).
  2307     05  SQ9O PIC  X(0001).
  2308*    -------------------------------
  2309     05  FILLER            PIC  X(0003).
  2310     05  L10O PIC  X(0003).
  2311*    -------------------------------
  2312     05  FILLER            PIC  X(0003).
  2313     05  TEXT10O PIC  X(0070).
  2314*    -------------------------------
  2315     05  FILLER            PIC  X(0003).
  2316     05  CF10O PIC  X(0002).
  2317*    -------------------------------
  2318     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL1042.cbl
  2319     05  SQ10O PIC  X(0001).
  2320*    -------------------------------
  2321     05  FILLER            PIC  X(0003).
  2322     05  L11O PIC  X(0003).
  2323*    -------------------------------
  2324     05  FILLER            PIC  X(0003).
  2325     05  TEXT11O PIC  X(0070).
  2326*    -------------------------------
  2327     05  FILLER            PIC  X(0003).
  2328     05  CF11O PIC  X(0002).
  2329*    -------------------------------
  2330     05  FILLER            PIC  X(0003).
  2331     05  SQ11O PIC  X(0001).
  2332*    -------------------------------
  2333     05  FILLER            PIC  X(0003).
  2334     05  L12O PIC  X(0003).
  2335*    -------------------------------
  2336     05  FILLER            PIC  X(0003).
  2337     05  TEXT12O PIC  X(0070).
  2338*    -------------------------------
  2339     05  FILLER            PIC  X(0003).
  2340     05  CF12O PIC  X(0002).
  2341*    -------------------------------
  2342     05  FILLER            PIC  X(0003).
  2343     05  SQ12O PIC  X(0001).
  2344*    -------------------------------
  2345     05  FILLER            PIC  X(0003).
  2346     05  L13O PIC  X(0003).
  2347*    -------------------------------
  2348     05  FILLER            PIC  X(0003).
  2349     05  TEXT13O PIC  X(0070).
  2350*    -------------------------------
  2351     05  FILLER            PIC  X(0003).
  2352     05  CF13O PIC  X(0002).
  2353*    -------------------------------
  2354     05  FILLER            PIC  X(0003).
  2355     05  SQ13O PIC  X(0001).
  2356*    -------------------------------
  2357     05  FILLER            PIC  X(0003).
  2358     05  L14O PIC  X(0003).
  2359*    -------------------------------
  2360     05  FILLER            PIC  X(0003).
  2361     05  TEXT14O PIC  X(0070).
  2362*    -------------------------------
  2363     05  FILLER            PIC  X(0003).
  2364     05  CF14O PIC  X(0002).
  2365*    -------------------------------
  2366     05  FILLER            PIC  X(0003).
  2367     05  SQ14O PIC  X(0001).
  2368*    -------------------------------
  2369     05  FILLER            PIC  X(0003).
  2370     05  L15O PIC  X(0003).
  2371*    -------------------------------
  2372     05  FILLER            PIC  X(0003).
  2373     05  TEXT15O PIC  X(0070).
  2374*    -------------------------------
  2375     05  FILLER            PIC  X(0003).
  2376     05  CF15O PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL1042.cbl
  2377*    -------------------------------
  2378     05  FILLER            PIC  X(0003).
  2379     05  SQ15O PIC  X(0001).
  2380*    -------------------------------
  2381     05  FILLER            PIC  X(0003).
  2382     05  ERRMSGBO PIC  X(0072).
  2383*    -------------------------------
  2384     05  FILLER            PIC  X(0003).
  2385     05  FUNCTO PIC  X(0001).
  2386*    -------------------------------
  2387     05  FILLER            PIC  X(0003).
  2388     05  LINE1O PIC  X(0003).
  2389*    -------------------------------
  2390     05  FILLER            PIC  X(0003).
  2391     05  LINE2O PIC  X(0003).
  2392*    -------------------------------
  2393     05  FILLER            PIC  X(0003).
  2394     05  PFENTRBO PIC  X(0002).
  2395*    -------------------------------
  2396     05  FILLER            PIC  X(0003).
  2397     05  MNTBYO PIC  X(0004).
  2398*    -------------------------------
  2399     05  FILLER            PIC  X(0003).
  2400     05  MNTONO PIC  X(0008).
  2401*    -------------------------------
  2402 01  EL104AI REDEFINES EL104BFI.
  2403     05  FILLER            PIC  X(0012).
  2404*    -------------------------------
  2405     05  DATEL PIC S9(0004) COMP.
  2406     05  DATEF PIC  X(0001).
  2407     05  FILLER REDEFINES DATEF.
  2408         10  DATEA PIC  X(0001).
  2409     05  DATEI PIC  X(0008).
  2410*    -------------------------------
  2411     05  TIMEL PIC S9(0004) COMP.
  2412     05  TIMEF PIC  X(0001).
  2413     05  FILLER REDEFINES TIMEF.
  2414         10  TIMEA PIC  X(0001).
  2415     05  TIMEI PIC  X(0005).
  2416*    -------------------------------
  2417     05  COMPAL PIC S9(0004) COMP.
  2418     05  COMPAF PIC  X(0001).
  2419     05  FILLER REDEFINES COMPAF.
  2420         10  COMPAA PIC  X(0001).
  2421     05  COMPAI PIC  X(0003).
  2422*    -------------------------------
  2423     05  MAINTL PIC S9(0004) COMP.
  2424     05  MAINTF PIC  X(0001).
  2425     05  FILLER REDEFINES MAINTF.
  2426         10  MAINTA PIC  X(0001).
  2427     05  MAINTI PIC  X(0001).
  2428*    -------------------------------
  2429     05  TRANSFML PIC S9(0004) COMP.
  2430     05  TRANSFMF PIC  X(0001).
  2431     05  FILLER REDEFINES TRANSFMF.
  2432         10  TRANSFMA PIC  X(0001).
  2433     05  TRANSFMI PIC  X(0014).
  2434*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL1042.cbl
  2435     05  FILETYPL PIC S9(0004) COMP.
  2436     05  FILETYPF PIC  X(0001).
  2437     05  FILLER REDEFINES FILETYPF.
  2438         10  FILETYPA PIC  X(0001).
  2439     05  FILETYPI PIC  X(0001).
  2440*    -------------------------------
  2441     05  CONTROLL PIC S9(0004) COMP.
  2442     05  CONTROLF PIC  X(0001).
  2443     05  FILLER REDEFINES CONTROLF.
  2444         10  CONTROLA PIC  X(0001).
  2445     05  CONTROLI PIC  X(0012).
  2446*    -------------------------------
  2447     05  NEWCONTL PIC S9(0004) COMP.
  2448     05  NEWCONTF PIC  X(0001).
  2449     05  FILLER REDEFINES NEWCONTF.
  2450         10  NEWCONTA PIC  X(0001).
  2451     05  NEWCONTI PIC  X(0012).
  2452*    -------------------------------
  2453     05  ERRMSG1L PIC S9(0004) COMP.
  2454     05  ERRMSG1F PIC  X(0001).
  2455     05  FILLER REDEFINES ERRMSG1F.
  2456         10  ERRMSG1A PIC  X(0001).
  2457     05  ERRMSG1I PIC  X(0079).
  2458*    -------------------------------
  2459     05  ERRMSG2L PIC S9(0004) COMP.
  2460     05  ERRMSG2F PIC  X(0001).
  2461     05  FILLER REDEFINES ERRMSG2F.
  2462         10  ERRMSG2A PIC  X(0001).
  2463     05  ERRMSG2I PIC  X(0079).
  2464*    -------------------------------
  2465     05  PFENTERL PIC S9(0004) COMP.
  2466     05  PFENTERF PIC  X(0001).
  2467     05  FILLER REDEFINES PFENTERF.
  2468         10  PFENTERA PIC  X(0001).
  2469     05  PFENTERI PIC  99.
  2470*    -------------------------------
  2471     05  HDNPFAL PIC S9(0004) COMP.
  2472     05  HDNPFAF PIC  X(0001).
  2473     05  FILLER REDEFINES HDNPFAF.
  2474         10  HDNPFAA PIC  X(0001).
  2475     05  HDNPFAI PIC  X(0019).
  2476 01  EL104AO REDEFINES EL104BFI.
  2477     05  FILLER            PIC  X(0012).
  2478*    -------------------------------
  2479     05  FILLER            PIC  X(0003).
  2480     05  DATEO PIC  X(0008).
  2481*    -------------------------------
  2482     05  FILLER            PIC  X(0003).
  2483     05  TIMEO PIC  99.99.
  2484*    -------------------------------
  2485     05  FILLER            PIC  X(0003).
  2486     05  COMPAO PIC  X(0003).
  2487*    -------------------------------
  2488     05  FILLER            PIC  X(0003).
  2489     05  MAINTO PIC  X(0001).
  2490*    -------------------------------
  2491     05  FILLER            PIC  X(0003).
  2492     05  TRANSFMO PIC  X(0014).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL1042.cbl
  2493*    -------------------------------
  2494     05  FILLER            PIC  X(0003).
  2495     05  FILETYPO PIC  X(0001).
  2496*    -------------------------------
  2497     05  FILLER            PIC  X(0003).
  2498     05  CONTROLO PIC  X(0012).
  2499*    -------------------------------
  2500     05  FILLER            PIC  X(0003).
  2501     05  NEWCONTO PIC  X(0012).
  2502*    -------------------------------
  2503     05  FILLER            PIC  X(0003).
  2504     05  ERRMSG1O PIC  X(0079).
  2505*    -------------------------------
  2506     05  FILLER            PIC  X(0003).
  2507     05  ERRMSG2O PIC  X(0079).
  2508*    -------------------------------
  2509     05  FILLER            PIC  X(0003).
  2510     05  PFENTERO PIC  X(0002).
  2511*    -------------------------------
  2512     05  FILLER            PIC  X(0003).
  2513     05  HDNPFAO PIC  X(0019).
  2514*    -------------------------------
  2515 01  EL104AFI REDEFINES EL104BFI.
  2516     05  FILLER            PIC  X(0012).
  2517*    -------------------------------
  2518     05  DATEAFL PIC S9(0004) COMP.
  2519     05  DATEAFF PIC  X(0001).
  2520     05  FILLER REDEFINES DATEAFF.
  2521         10  DATEAFA PIC  X(0001).
  2522     05  DATEAFI PIC  X(0008).
  2523*    -------------------------------
  2524     05  TIMEAFL PIC S9(0004) COMP.
  2525     05  TIMEAFF PIC  X(0001).
  2526     05  FILLER REDEFINES TIMEAFF.
  2527         10  TIMEAFA PIC  X(0001).
  2528     05  TIMEAFI PIC  X(0005).
  2529*    -------------------------------
  2530     05  COMPAFL PIC S9(0004) COMP.
  2531     05  COMPAFF PIC  X(0001).
  2532     05  FILLER REDEFINES COMPAFF.
  2533         10  COMPAFA PIC  X(0001).
  2534     05  COMPAFI PIC  X(0003).
  2535*    -------------------------------
  2536     05  MAINTFL PIC S9(0004) COMP.
  2537     05  MAINTFF PIC  X(0001).
  2538     05  FILLER REDEFINES MAINTFF.
  2539         10  MAINTFA PIC  X(0001).
  2540     05  MAINTFI PIC  X(0001).
  2541*    -------------------------------
  2542     05  TRNSFMFL PIC S9(0004) COMP.
  2543     05  TRNSFMFF PIC  X(0001).
  2544     05  FILLER REDEFINES TRNSFMFF.
  2545         10  TRNSFMFA PIC  X(0001).
  2546     05  TRNSFMFI PIC  X(0014).
  2547*    -------------------------------
  2548     05  FILETPFL PIC S9(0004) COMP.
  2549     05  FILETPFF PIC  X(0001).
  2550     05  FILLER REDEFINES FILETPFF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL1042.cbl
  2551         10  FILETPFA PIC  X(0001).
  2552     05  FILETPFI PIC  X(0001).
  2553*    -------------------------------
  2554     05  CONTRLFL PIC S9(0004) COMP.
  2555     05  CONTRLFF PIC  X(0001).
  2556     05  FILLER REDEFINES CONTRLFF.
  2557         10  CONTRLFA PIC  X(0001).
  2558     05  CONTRLFI PIC  X(0012).
  2559*    -------------------------------
  2560     05  NEWCNTFL PIC S9(0004) COMP.
  2561     05  NEWCNTFF PIC  X(0001).
  2562     05  FILLER REDEFINES NEWCNTFF.
  2563         10  NEWCNTFA PIC  X(0001).
  2564     05  NEWCNTFI PIC  X(0012).
  2565*    -------------------------------
  2566     05  ERMSG1FL PIC S9(0004) COMP.
  2567     05  ERMSG1FF PIC  X(0001).
  2568     05  FILLER REDEFINES ERMSG1FF.
  2569         10  ERMSG1FA PIC  X(0001).
  2570     05  ERMSG1FI PIC  X(0079).
  2571*    -------------------------------
  2572     05  ERMSG2FL PIC S9(0004) COMP.
  2573     05  ERMSG2FF PIC  X(0001).
  2574     05  FILLER REDEFINES ERMSG2FF.
  2575         10  ERMSG2FA PIC  X(0001).
  2576     05  ERMSG2FI PIC  X(0079).
  2577*    -------------------------------
  2578     05  PFENTFL PIC S9(0004) COMP.
  2579     05  PFENTFF PIC  X(0001).
  2580     05  FILLER REDEFINES PFENTFF.
  2581         10  PFENTFA PIC  X(0001).
  2582     05  PFENTFI PIC  99.
  2583*    -------------------------------
  2584     05  HDNPFAFL PIC S9(0004) COMP.
  2585     05  HDNPFAFF PIC  X(0001).
  2586     05  FILLER REDEFINES HDNPFAFF.
  2587         10  HDNPFAFA PIC  X(0001).
  2588     05  HDNPFAFI PIC  X(0022).
  2589 01  EL104AFO REDEFINES EL104BFI.
  2590     05  FILLER            PIC  X(0012).
  2591*    -------------------------------
  2592     05  FILLER            PIC  X(0003).
  2593     05  DATEAFO PIC  X(0008).
  2594*    -------------------------------
  2595     05  FILLER            PIC  X(0003).
  2596     05  TIMEAFO PIC  99.99.
  2597*    -------------------------------
  2598     05  FILLER            PIC  X(0003).
  2599     05  COMPAFO PIC  X(0003).
  2600*    -------------------------------
  2601     05  FILLER            PIC  X(0003).
  2602     05  MAINTFO PIC  X(0001).
  2603*    -------------------------------
  2604     05  FILLER            PIC  X(0003).
  2605     05  TRNSFMFO PIC  X(0014).
  2606*    -------------------------------
  2607     05  FILLER            PIC  X(0003).
  2608     05  FILETPFO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL1042.cbl
  2609*    -------------------------------
  2610     05  FILLER            PIC  X(0003).
  2611     05  CONTRLFO PIC  X(0012).
  2612*    -------------------------------
  2613     05  FILLER            PIC  X(0003).
  2614     05  NEWCNTFO PIC  X(0012).
  2615*    -------------------------------
  2616     05  FILLER            PIC  X(0003).
  2617     05  ERMSG1FO PIC  X(0079).
  2618*    -------------------------------
  2619     05  FILLER            PIC  X(0003).
  2620     05  ERMSG2FO PIC  X(0079).
  2621*    -------------------------------
  2622     05  FILLER            PIC  X(0003).
  2623     05  PFENTFO PIC  X(0002).
  2624*    -------------------------------
  2625     05  FILLER            PIC  X(0003).
  2626     05  HDNPFAFO PIC  X(0022).
  2627*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL1042.cbl
  2629 01  EL104BR REDEFINES EL104BI.
  2630     12  FILLER                  PIC X(108).
  2631     12  SC-ALL-LINES.
  2632      14 SC-LINES OCCURS 15 TIMES INDEXED BY SC-INDX.
  2633         16  SC-LINL             PIC S9(4)   COMP.
  2634         16  SC-LINA             PIC X.
  2635         16  SC-LIN              PIC Z99.
  2636         16  SC-TEXTL            PIC S9(4)   COMP.
  2637         16  SC-TEXTA            PIC X.
  2638         16  SC-TEXT             PIC X(70).
  2639         16  SC-PCL              PIC S9(4)   COMP.
  2640         16  SC-PCA              PIC X.
  2641         16  SC-PC               PIC XX.
  2642         16  SC-SQL              PIC S9(4)   COMP.
  2643         16  SC-SQA              PIC X.
  2644         16  SC-SQ               PIC X.
  2645
  2646 01  FILLER                          PIC X(14)
  2647                              VALUE ':MAP AREA ENDS'.
  2648 01  RECORD-TABLE                PIC X(21900) VALUE SPACES.
  2649 01  REC-TABLE  REDEFINES RECORD-TABLE.
  2650     12  TS-GROUP OCCURS 6 TIMES INDEXED BY TS-INDX PIC X(3650).
  2651 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  2652     12  REC-ENT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
  2653         16  REC-TEXT            PIC X(70).
  2654         16  REC-PC              PIC XX.
  2655         16  REC-SQ              PIC X.
  2656 01  TS-WORK-AREA                PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL1042.cbl
  2658
  2659****************************************************************
  2660*
  2661* Copyright (c) 2007 by Clerity Solutions, Inc.
  2662* All rights reserved.
  2663*
  2664****************************************************************
  2665 01  DFHEIV.
  2666   02  DFHEIV0               PIC X(35).
  2667   02  DFHEIV1               PIC X(08).
  2668   02  DFHEIV2               PIC X(08).
  2669   02  DFHEIV3               PIC X(08).
  2670   02  DFHEIV4               PIC X(06).
  2671   02  DFHEIV5               PIC X(04).
  2672   02  DFHEIV6               PIC X(04).
  2673   02  DFHEIV7               PIC X(02).
  2674   02  DFHEIV8               PIC X(02).
  2675   02  DFHEIV9               PIC X(01).
  2676   02  DFHEIV10              PIC S9(7) COMP-3.
  2677   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2678   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2679   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2680   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2681   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2682   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2683   02  DFHEIV17              PIC X(04).
  2684   02  DFHEIV18              PIC X(04).
  2685   02  DFHEIV19              PIC X(04).
  2686   02  DFHEIV20              USAGE IS POINTER.
  2687   02  DFHEIV21              USAGE IS POINTER.
  2688   02  DFHEIV22              USAGE IS POINTER.
  2689   02  DFHEIV23              USAGE IS POINTER.
  2690   02  DFHEIV24              USAGE IS POINTER.
  2691   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2692   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2693   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2694   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2695   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2696   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2697   02  FILLER                PIC X(02).
  2698   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2699   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2700   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2701   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2702   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2703 LINKAGE  SECTION.
  2704*****************************************************************
  2705*                                                               *
  2706* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2707* All rights reserved.                                          *
  2708*                                                               *
  2709*****************************************************************
  2710 01  dfheiblk.
  2711     02  eibtime          pic s9(7) comp-3.
  2712     02  eibdate          pic s9(7) comp-3.
  2713     02  eibtrnid         pic x(4).
  2714     02  eibtaskn         pic s9(7) comp-3.
  2715     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL1042.cbl
  2716     02  dfheigdi         pic s9(4) comp.
  2717     02  eibcposn         pic s9(4) comp.
  2718     02  eibcalen         pic s9(4) comp.
  2719     02  eibaid           pic x(1).
  2720     02  eibfiller1       pic x(1).
  2721     02  eibfn            pic x(2).
  2722     02  eibfiller2       pic x(2).
  2723     02  eibrcode         pic x(6).
  2724     02  eibfiller3       pic x(2).
  2725     02  eibds            pic x(8).
  2726     02  eibreqid         pic x(8).
  2727     02  eibrsrce         pic x(8).
  2728     02  eibsync          pic x(1).
  2729     02  eibfree          pic x(1).
  2730     02  eibrecv          pic x(1).
  2731     02  eibsend          pic x(1).
  2732     02  eibatt           pic x(1).
  2733     02  eibeoc           pic x(1).
  2734     02  eibfmh           pic x(1).
  2735     02  eibcompl         pic x(1).
  2736     02  eibsig           pic x(1).
  2737     02  eibconf          pic x(1).
  2738     02  eiberr           pic x(1).
  2739     02  eibrldbk         pic x(1).
  2740     02  eiberrcd         pic x(4).
  2741     02  eibsynrb         pic x(1).
  2742     02  eibnodat         pic x(1).
  2743     02  eibfiller5       pic x(2).
  2744     02  eibresp          pic 9(09) comp.
  2745     02  eibresp2         pic 9(09) comp.
  2746     02  dfheigdj         pic s9(4) comp.
  2747     02  dfheigdk         pic s9(4) comp.
  2748 01  DFHCOMMAREA                 PIC X(1024).
  2749*01 PARMLIST .
  2750*    02  FILLER                  PIC S9(8)  COMP.
  2751*    02  TXT-ADDR                PIC S9(8)  COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL1042.cbl
  2753*                                COPY ELCTEXT.
  2754******************************************************************
  2755*                                                                *
  2756*                                                                *
  2757*                            ELCTEXT.                            *
  2758*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2759*                            VMOD=2.008                          *
  2760*                                                                *
  2761*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  2762*                                     FORM LETTERS,              *
  2763*                                     CERT FORM DISPLAY.
  2764*                                                                *
  2765*   FILE TYPE = VSAM,KSDS                                        *
  2766*   RECORD SIZE = 100   RECFORM = FIXED                          *
  2767*                                                                *
  2768*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  2769*       ALTERNATE INDEX = NONE                                   *
  2770*                                                                *
  2771*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  2772*       ALTERNATE INDEX = NONE                                   *
  2773*                                                                *
  2774*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  2775*       ALTERNATE INDEX = NONE                                   *
  2776*                                                                *
  2777*   LOG = NO                                                     *
  2778*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2779******************************************************************
  2780 01  TEXT-FILES.
  2781     12  TEXT-FILE-ID                PIC XX.
  2782         88  FORMS-FILE-TEXT            VALUE 'TF'.
  2783         88  LETTER-FILE-TEXT           VALUE 'TL'.
  2784         88  HELP-FILE-TEXT             VALUE 'TH'.
  2785
  2786     12  TX-CONTROL-PRIMARY.
  2787         16  TX-COMPANY-CD           PIC X.
  2788             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  2789         16  TX-ACCESS-CD-GENL       PIC X(12).
  2790
  2791         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2792             20  TX-LETTER-NO        PIC X(4).
  2793             20  FILLER              PIC X(8).
  2794
  2795         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2796             20  TX-FORM-NO          PIC X(12).
  2797
  2798         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2799             20  TX-HELP-TYPE        PIC X.
  2800                 88  HELP-FOR-GENERAL   VALUE ' '.
  2801                 88  HELP-BY-SCREEN     VALUE 'S'.
  2802                 88  HELP-BY-ERROR      VALUE 'E'.
  2803             20  TX-SCREEN-OR-ERROR  PIC X(4).
  2804                 88  GENERAL-INFO-HELP  VALUE '0000'.
  2805             20  TX-HELP-FOR-COMPANY  PIC XXX.
  2806                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  2807             20  FILLER              PIC X(4).
  2808
  2809         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  2810
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL1042.cbl
  2811     12  TX-PROCESS-CONTROL          PIC XX.
  2812         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  2813
  2814     12  TX-TEXT-LINE                PIC X(70).
  2815
  2816     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  2817         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  2818         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  2819         88  TX-VALID-FORM-SQUEEZE-VALUE
  2820                                        VALUE 'Y' ' '.
  2821
  2822     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  2823         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  2824         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  2825         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  2826         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  2827         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  2828         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  2829         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  2830                                              'K' 'N' ' '
  2831                                              'Z'.
  2832
  2833     12  TX-ARCHIVE-SW               PIC X.
  2834         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  2835         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  2836         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  2837
  2838     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  2839     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  2840
  2841     12  TX-BSR-CODE                 PIC X.
  2842         88  TX-BSR-LETTER              VALUE 'B'.
  2843         88  TX-NON-BSR-LETTER          VALUE ' '.
  2844
  2845     12  FILLER                      PIC X.
  2846*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL1042.cbl
  2848 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA TEXT-FILES.
  2849 0000-DFHEXIT SECTION.
  2850     MOVE '9#                    $   ' TO DFHEIV0.
  2851     MOVE 'EL1042' TO DFHEIV1.
  2852     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2853
  2854     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  2855
  2856     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  2857     MOVE '5'                   TO DC-OPTION-CODE.
  2858     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2859     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  2860     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  2861
  2862     IF  EIBCALEN = ZEROS
  2863         GO TO 8800-UNAUTHORIZED-ACCESS.
  2864
  2865     MOVE EIBTRMID        TO TS-TERM.
  2866     MOVE PI-COMM-CONTROL TO CNTL-AREA.
  2867     MOVE PI-COMPANY-CD   TO CO-CD.
  2868     MOVE ZEROS           TO SEQ.
  2869     MOVE LOW-VALUES      TO EL104BI.
  2870     MOVE ERROR-MESSAGE-INTERFACE-BLOCK   TO EMI-SAVE-AREA.
  2871
  2872* EXEC CICS HANDLE CONDITION
  2873*         ERROR(9990-ABEND)
  2874*         PGMIDERR(9600-PGMID-ERROR)
  2875*    END-EXEC.
  2876*    MOVE '"$.L                  ! " #00002867' TO DFHEIV0
  2877     MOVE X'22242E4C2020202020202020' TO DFHEIV0(1:12)
  2878     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2879     MOVE X'2220233030303032383637' TO DFHEIV0(25:11)
  2880     CALL 'kxdfhei1' USING DFHEIV0
  2881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2882
  2883
  2884     IF  PI-LANGUAGE-IS-FR
  2885         MOVE 'EL104BF'          TO MAP-NAME.
  2886
  2887     IF  PI-ENTRY-CD-1 = '1'
  2888         MOVE LETTER-ID TO FILE-ID
  2889
  2890     ELSE
  2891         IF  PI-ENTRY-CD-1 = '2'
  2892             MOVE FORM-ID TO FILE-ID
  2893
  2894         ELSE
  2895             MOVE HELP-ID TO FILE-ID.
  2896
  2897     IF FILE-ID = HELP-ID
  2898         MOVE LOW-VALUES TO CO-CD
  2899     END-IF.
  2900
  2901     MOVE FILE-PARTIAL-KEY TO OLD-KEY-SAVE.
  2902
  2903     IF  PI-CALLING-PROGRAM NOT = THIS-PGM
  2904        IF  PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2905           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL1042.cbl
  2906           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2907           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2908           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2909           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2910           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2911           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2912           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  2913           MOVE 'N'                  TO PI-1042-SCREEN-SENT-IND
  2914           PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  2915
  2916        ELSE
  2917           MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  2918           MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  2919           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  2920           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  2921           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  2922           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  2923           MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  2924           MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  2925
  2926     IF  EIBTRNID = 'MX27'
  2927             OR
  2928         EIBTRNID = 'EX27'
  2929             OR
  2930         EIBTRNID = 'EXH3'
  2931         PERFORM 7500-READ-TS  THRU  7599-EXIT
  2932         GO TO 7050-FORMAT-LINES.
  2933
  2934     GO TO 7000-BUILD-TABLE.
  2935
  2936
  2937 0100-PA.
  2938     MOVE ER-0008 TO EMI-ERROR
  2939     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2940     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL1042.cbl
  2942 0200-RECEIVE.
  2943
  2944* EXEC CICS HANDLE AID
  2945*         CLEAR   (9400-CLEAR)
  2946*         PA1     (0100-PA)
  2947*         PA2     (0100-PA)
  2948*         PA3     (0100-PA)
  2949*         END-EXEC.
  2950*    MOVE '"&=!"#               V! # #00002931' TO DFHEIV0
  2951     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  2952     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  2953     MOVE X'2320233030303032393331' TO DFHEIV0(25:11)
  2954     CALL 'kxdfhei1' USING DFHEIV0
  2955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2956
  2957
  2958     MOVE EMI-SAVE-AREA   TO ERROR-MESSAGE-INTERFACE-BLOCK
  2959     MOVE PI-COMM-CONTROL TO CNTL-AREA.
  2960     MOVE PI-COMPANY-CD   TO CO-CD.
  2961     IF FILE-ID = HELP-ID
  2962         MOVE LOW-VALUES TO CO-CD
  2963     END-IF.
  2964     MOVE ZEROS           TO SEQ.
  2965     MOVE ZEROS           TO ROLL-COUNTER.
  2966     MOVE LOW-VALUES      TO EL104BI.
  2967
  2968
  2969* EXEC CICS SYNCPOINT
  2970*         END-EXEC.
  2971*    MOVE '6"                    !   #00002948' TO DFHEIV0
  2972     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  2973     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2974     MOVE X'2020233030303032393438' TO DFHEIV0(25:11)
  2975     CALL 'kxdfhei1' USING DFHEIV0
  2976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2977
  2978
  2979     IF LOWER-CASE-LETTERS-USED
  2980
  2981* EXEC CICS RECEIVE
  2982*            MAP   (MAP-NAME)
  2983*            MAPSET(MAPSET-NAME)
  2984*            INTO  (EL104BI)
  2985*            ASIS
  2986*            END-EXEC
  2987     MOVE LENGTH OF
  2988      EL104BI
  2989       TO DFHEIV11
  2990*    MOVE '8"TAI  L              ''   #00002952' TO DFHEIV0
  2991     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  2992     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2993     MOVE X'2020233030303032393532' TO DFHEIV0(25:11)
  2994     CALL 'kxdfhei1' USING DFHEIV0,
  2995           MAP-NAME,
  2996           EL104BI,
  2997           DFHEIV11,
  2998           MAPSET-NAME,
  2999           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL1042.cbl
  3000           DFHEIV99
  3001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3002         ELSE
  3003
  3004* EXEC CICS RECEIVE
  3005*            MAP   (MAP-NAME)
  3006*            MAPSET(MAPSET-NAME)
  3007*            INTO  (EL104BI)
  3008*            END-EXEC.
  3009     MOVE LENGTH OF
  3010      EL104BI
  3011       TO DFHEIV11
  3012*    MOVE '8"T I  L              ''   #00002959' TO DFHEIV0
  3013     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3014     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3015     MOVE X'2020233030303032393539' TO DFHEIV0(25:11)
  3016     CALL 'kxdfhei1' USING DFHEIV0,
  3017           MAP-NAME,
  3018           EL104BI,
  3019           DFHEIV11,
  3020           MAPSET-NAME,
  3021           DFHEIV99,
  3022           DFHEIV99
  3023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3024
  3025
  3026     IF  NOT DISPLAY-CAP
  3027         MOVE 'READ'             TO SM-READ
  3028         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  3029         MOVE ER-9097            TO EMI-ERROR
  3030         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3031         GO TO 8100-SEND-INITIAL-MAP.
  3032
  3033     IF  PFENTRBL = ZEROS
  3034        GO TO 2001-CHECK-PFKEYS.
  3035
  3036     IF  EIBAID NOT = DFHENTER
  3037        MOVE ER-0004 TO EMI-ERROR
  3038        GO TO 2002-INPUT-ERROR.
  3039
  3040     IF  (PFENTRBI NUMERIC) AND (PFENTRBI GREATER 0 AND LESS 25)
  3041        MOVE PF-VALUES (PFENTRBI) TO EIBAID
  3042       ELSE
  3043        MOVE ER-0029 TO EMI-ERROR
  3044        GO TO 2002-INPUT-ERROR.
  3045
  3046 2001-CHECK-PFKEYS.
  3047     IF  EIBAID = DFHPF23
  3048        GO TO 9000-RETURN-CICS.
  3049
  3050     IF  EIBAID = DFHPF24
  3051        GO TO 9200-RETURN-MAIN-MENU.
  3052
  3053     IF  EIBAID = DFHPF12
  3054        GO TO 9500-PF12.
  3055     IF  FUNCTL NOT = ZEROS AND EIBAID NOT = DFHENTER
  3056
  3057        IF  FUNCTI = 'A' OR 'a' OR SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL1042.cbl
  3058           NEXT SENTENCE
  3059          ELSE
  3060           MOVE ER-0050 TO EMI-ERROR
  3061           MOVE -1 TO FUNCTL
  3062           MOVE AL-UABON TO FUNCTA PFENTRBA
  3063           GO TO 2002-INPUT-ERROR.
  3064
  3065     IF  EIBAID = DFHPF1
  3066        MOVE NUM-LINES-PER-SCREEN TO ROLL-COUNTER
  3067        GO TO 7400-PAGE-ROUTINE.
  3068
  3069     IF  EIBAID = DFHPF2
  3070        SUBTRACT NUM-LINES-PER-SCREEN FROM ROLL-COUNTER
  3071        GO TO 7400-PAGE-ROUTINE.
  3072
  3073     IF  EIBAID = DFHPF3
  3074        MOVE 5 TO ROLL-COUNTER
  3075        GO TO 7400-PAGE-ROUTINE.
  3076
  3077     IF  EIBAID = DFHPF4
  3078        MOVE -5 TO ROLL-COUNTER
  3079        GO TO 7400-PAGE-ROUTINE.
  3080     IF EIBAID = DFHPF5
  3081        GO TO 9450-PF5
  3082     END-IF
  3083     IF  EIBAID = DFHENTER
  3084        GO TO 2003-EDIT-DATA.
  3085
  3086     MOVE ER-0029 TO EMI-ERROR.
  3087
  3088 2002-INPUT-ERROR.
  3089     MOVE -1       TO PFENTRBL.
  3090     MOVE AL-UNBON TO PFENTRBA.
  3091     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3092     GO TO 8200-SEND-DATAONLY.
  3093
  3094 2003-EDIT-DATA.
  3095
  3096     IF  (PI-LANGUAGE-IS-FR
  3097                  AND
  3098             (FUNCTI = 'Q' OR 'q' OR 'V' OR 'v'))
  3099             OR
  3100         FUNCTI = 'Q' OR 'q' OR 'L' OR 'l'
  3101         NEXT SENTENCE
  3102
  3103     ELSE
  3104         IF  NOT MODIFY-CAP
  3105             MOVE 'UPDATE'       TO SM-READ
  3106             PERFORM 9995-SECURITY-VIOLATION
  3107             MOVE ER-0070        TO EMI-ERROR
  3108             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3109             GO TO 8200-SEND-DATAONLY.
  3110
  3111     IF  FUNCTL = ZEROS OR FUNCTI = SPACES
  3112         GO TO 4000-CHANGE-ROUTINE
  3113
  3114     ELSE
  3115         IF  (PI-LANGUAGE-IS-FR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL1042.cbl
  3116                      AND
  3117                 (FUNCTI = 'G' OR 'V' OR 'Q' OR
  3118                           'I' OR 'A' OR 'E'  OR
  3119                           'C' OR
  3120                           'g' OR 'v' OR 'q' OR
  3121                           'i' OR 'a' OR 'e'  OR
  3122                           'c'))
  3123                 OR
  3124             (FUNCTI = 'S' OR 'D' OR 'Q' OR
  3125                      'I' OR 'A' OR 'L'  OR
  3126                       'c' OR 'C' OR
  3127                       's' OR 'd' OR 'q' OR
  3128                      'i' OR 'a' OR 'l')
  3129             NEXT SENTENCE
  3130         ELSE
  3131             MOVE ER-0023 TO EMI-ERROR
  3132             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3133             MOVE AL-UABON TO FUNCTA
  3134             MOVE -1 TO FUNCTL
  3135             GO TO 8200-SEND-DATAONLY.
  3136
  3137     IF  FUNCTI = 'c' OR 'C'
  3138         PERFORM 2600-C-LINE-CHECK THRU 2600-EXIT
  3139
  3140     ELSE
  3141         IF  (PI-LANGUAGE-IS-FR
  3142                      AND
  3143                 (FUNCTI = 'E' OR 'I' OR 'V' OR
  3144                         'e' OR 'i' OR 'v'))
  3145
  3146                 OR
  3147             FUNCTI = 'D' OR 'I' OR 'L' OR
  3148                     'd' OR 'i' OR 'l'
  3149             PERFORM 2500-LINE-CHECK THRU 2599-EXIT
  3150
  3151         ELSE
  3152             IF  LINE1L NOT = ZEROS
  3153                     OR
  3154                 LINE2L NOT = ZEROS
  3155                 MOVE ER-0030 TO EMI-ERROR
  3156                 MOVE -1 TO LINE1L
  3157                 MOVE AL-UNBON TO LINE1A LINE2A
  3158                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3159                 GO TO 8200-SEND-DATAONLY.
  3160
  3161     IF  FUNCTI = 'A' OR 'a'
  3162         GO TO 5000-ADD-NEW-LINES.
  3163
  3164     IF  FUNCTI = 'Q' OR 'q'
  3165         GO TO 9410-RETURN.
  3166
  3167     IF  (PI-LANGUAGE-IS-FR
  3168                  AND
  3169             (FUNCTI = 'g' OR 'G'))
  3170             OR
  3171         FUNCTI = 's' OR 'S'
  3172         GO TO 4500-SAVE-DATA.
  3173
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL1042.cbl
  3174     IF  PI-TOTAL-LINES = 0
  3175        MOVE ER-0048 TO EMI-ERROR
  3176        MOVE -1 TO FUNCTL
  3177        MOVE AL-UNBON TO FUNCTA
  3178        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3179        GO TO 8200-SEND-DATAONLY.
  3180
  3181     IF  (PI-LANGUAGE-IS-FR
  3182                  AND
  3183             (FUNCTI = 'V' OR 'v'))
  3184             OR
  3185         FUNCTI = 'L' OR 'l'
  3186         GO TO 5500-LOOKUP.
  3187
  3188     IF  FUNCTI = 'D' OR 'd'
  3189         GO TO 3000-DELETE-LINES.
  3190
  3191     IF  FUNCTI = 'c' OR 'C'
  3192         GO TO 3700-COPY-LINES.
  3193
  3194     GO TO 3500-INSERT-LINES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL1042.cbl
  3196 2500-LINE-CHECK.
  3197     IF  LINE1L = ZEROS AND
  3198        LINE2L = ZEROS
  3199        MOVE ER-0069 TO EMI-ERROR
  3200        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3201        MOVE -1 TO LINE1L
  3202        GO TO 8200-SEND-DATAONLY.
  3203
  3204     IF  LINE1L NOT = ZEROS
  3205        IF  LINE1I NOT NUMERIC OR
  3206           LINE1I GREATER PI-TOTAL-LINES
  3207           MOVE ER-0031 TO EMI-ERROR
  3208           MOVE AL-UNBON TO LINE1A
  3209           MOVE -1 TO LINE1L
  3210           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3211           GO TO 8200-SEND-DATAONLY
  3212          ELSE
  3213           IF  LINE2L = ZEROS
  3214              MOVE 1 TO LINE2I
  3215             ELSE
  3216              IF  FUNCTI = 'I' OR 'i'
  3217                 GO TO 2510-MAX-CHECK
  3218                ELSE
  3219                 IF  LINE2I NOT NUMERIC
  3220                    MOVE AL-UNBON TO LINE2A
  3221                    MOVE ER-0032 TO EMI-ERROR
  3222                    MOVE -1      TO LINE2L
  3223                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3224                    GO TO 8200-SEND-DATAONLY
  3225                    ELSE
  3226                    NEXT SENTENCE
  3227       ELSE
  3228        IF  LINE2L = ZEROS
  3229           NEXT SENTENCE
  3230          ELSE
  3231           MOVE -1 TO LINE2L
  3232           MOVE ER-0041 TO EMI-ERROR
  3233           MOVE AL-UNBON TO LINE2A
  3234           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3235           GO TO 8200-SEND-DATAONLY.
  3236
  3237     GO TO 2599-EXIT.
  3238
  3239 2510-MAX-CHECK.
  3240     IF  LINE2I NOT NUMERIC
  3241        MOVE -1 TO LINE2L
  3242        MOVE ER-0032 TO EMI-ERROR
  3243        MOVE AL-UNBON TO LINE2A
  3244        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3245        GO TO 8200-SEND-DATAONLY
  3246       ELSE
  3247        COMPUTE ROLL-COUNTER = LINE2I + PI-TOTAL-LINES
  3248        IF  ROLL-COUNTER GREATER THAN MAX-LINES
  3249           MOVE -1 TO LINE2L
  3250           MOVE ER-0044 TO EMI-ERROR
  3251           MOVE AL-UNBON TO LINE2A
  3252           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3253           GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL1042.cbl
  3254
  3255 2599-EXIT.
  3256      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL1042.cbl
  3258
  3259 2600-C-LINE-CHECK.
  3260
  3261     IF  LINE1L = ZEROS
  3262         MOVE ER-0069 TO EMI-ERROR
  3263         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3264         MOVE -1 TO LINE1L
  3265         GO TO 8200-SEND-DATAONLY.
  3266
  3267     IF  LINE1I NOT NUMERIC
  3268             OR
  3269         LINE1I GREATER PI-TOTAL-LINES
  3270         MOVE ER-0031 TO EMI-ERROR
  3271         MOVE AL-UNBON TO LINE1A
  3272         MOVE -1 TO LINE1L
  3273         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3274         GO TO 8200-SEND-DATAONLY.
  3275
  3276     IF  LINE2L GREATER THAN ZEROS
  3277         IF  LINE2I NOT NUMERIC
  3278                 OR
  3279             LINE2I GREATER PI-TOTAL-LINES
  3280             MOVE ER-0032 TO EMI-ERROR
  3281             MOVE AL-UNBON TO LINE2A
  3282             MOVE -1 TO LINE2L
  3283             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3284             GO TO 8200-SEND-DATAONLY.
  3285
  3286 2600-EXIT.
  3287      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL1042.cbl
  3289 3000-DELETE-LINES.
  3290     IF  LINE2L = ZEROS AND LINE2I = 1
  3291        MOVE LINE1I TO LINE2I.
  3292
  3293     IF  PI-RETURN-TO-PROGRAM = PGM-EM152
  3294             OR
  3295         PI-RETURN-TO-PROGRAM = PGM-EL152
  3296             OR
  3297         PI-RETURN-TO-PROGRAM = PGM-EL689
  3298
  3299         IF  LINE1I LESS 8
  3300                  AND
  3301             PI-CREATE-LABELS
  3302             MOVE ER-0212 TO EMI-ERROR
  3303             MOVE AL-UNBON TO LINE1A
  3304             MOVE -1 TO LINE1L
  3305             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3306             GO TO 8200-SEND-DATAONLY.
  3307
  3308     IF  LINE2I GREATER PI-TOTAL-LINES OR LESS LINE1I
  3309        MOVE ER-0049 TO EMI-ERROR
  3310        MOVE AL-UNBON TO LINE2A
  3311        MOVE -1 TO LINE2L
  3312        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3313        GO TO 8200-SEND-DATAONLY.
  3314
  3315     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3316
  3317
  3318     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3319             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3320             SC-INDX GREATER NUM-LINES-PER-SCREEN.
  3321
  3322     IF  NOT EMI-NO-ERRORS
  3323        GO TO 8200-SEND-DATAONLY.
  3324
  3325     SET TB-INDX TO LINE1I.
  3326     COMPUTE ROLL-COUNTER = LINE2I - LINE1I + 1.
  3327
  3328     IF  LINE2I NOT = PI-TOTAL-LINES
  3329        SET TB-INDX1 TO LINE2I
  3330        SET TB-INDX1 UP BY 1
  3331        PERFORM 3100-DELETE-TABLE-ENTRIES
  3332                UNTIL TB-INDX1 GREATER PI-TOTAL-LINES.
  3333
  3334     PERFORM 3150-BLANK-TABLE-ENTRIES
  3335             ROLL-COUNTER TIMES.
  3336
  3337     SUBTRACT ROLL-COUNTER FROM PI-TOTAL-LINES.
  3338
  3339     IF  PI-CURRENT-LINE GREATER PI-TOTAL-LINES
  3340        MOVE PI-TOTAL-LINES       TO PI-CURRENT-LINE
  3341        SUBTRACT 1 FROM PI-CURRENT-LINE.
  3342
  3343     SET TB-INDX  TO PI-CURRENT-LINE.
  3344     MOVE LOW-VALUES TO EL104BI.
  3345
  3346     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL1042.cbl
  3347            VARYING SC-INDX FROM 1 BY 1 UNTIL
  3348            SC-INDX GREATER NUM-LINES-PER-SCREEN.
  3349
  3350     MOVE 1 TO PI-UPDATE-SW.
  3351
  3352     IF  PI-TOTAL-LINES = ZEROS
  3353        MOVE ZEROS TO PI-CURRENT-LINE.
  3354
  3355     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL1042.cbl
  3357 3100-DELETE-TABLE-ENTRIES.
  3358     MOVE REC-ENT (TB-INDX1) TO REC-ENT (TB-INDX).
  3359     SET TB-INDX TB-INDX1 UP BY 1.
  3360
  3361 3150-BLANK-TABLE-ENTRIES.
  3362     MOVE SPACES TO REC-ENT (TB-INDX).
  3363     SET TB-INDX UP BY 1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL1042.cbl
  3365 3500-INSERT-LINES.
  3366
  3367     IF  PI-RETURN-TO-PROGRAM = PGM-EM152
  3368             OR
  3369         PI-RETURN-TO-PROGRAM = PGM-EL152
  3370             OR
  3371         PI-RETURN-TO-PROGRAM = PGM-EL689
  3372
  3373         IF  LINE1I LESS 7
  3374                 AND
  3375             PI-CREATE-LABELS
  3376             MOVE ER-0212  TO EMI-ERROR
  3377             MOVE AL-UNBON TO LINE1A
  3378             MOVE -1       TO LINE1L
  3379             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3380             GO TO 8200-SEND-DATAONLY.
  3381
  3382     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3383
  3384     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3385             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3386             SC-INDX GREATER NUM-LINES-PER-SCREEN.
  3387
  3388     IF  NOT EMI-NO-ERRORS
  3389        GO TO 8200-SEND-DATAONLY.
  3390
  3391     SET TB-INDX  TO PI-TOTAL-LINES.
  3392     ADD LINE2I   TO PI-TOTAL-LINES.
  3393     SET TB-INDX1 TO PI-TOTAL-LINES.
  3394
  3395     PERFORM 3600-INSERT-TABLE-ENTRIES
  3396             UNTIL TB-INDX = LINE1I.
  3397
  3398     SET TB-INDX UP BY 1.
  3399
  3400     COMPUTE ROLL-COUNTER =
  3401                      PI-CURRENT-LINE + NUM-LINES-PER-SCREEN.
  3402
  3403     IF  TB-INDX NOT LESS ROLL-COUNTER OR
  3404                    LESS PI-CURRENT-LINE
  3405        SET SC-INDX TO 1
  3406        SET SC-INDX DOWN BY 1
  3407       ELSE
  3408        SET ROLL-COUNTER TO TB-INDX
  3409        COMPUTE ROLL-COUNTER = ROLL-COUNTER - PI-CURRENT-LINE + 1
  3410        SET SC-INDX TO ROLL-COUNTER.
  3411
  3412     PERFORM 3150-BLANK-TABLE-ENTRIES LINE2I TIMES.
  3413     SET TB-INDX     TO PI-CURRENT-LINE.
  3414     MOVE LOW-VALUES TO EL104BI.
  3415
  3416     IF  SC-INDX NOT = ZERO
  3417        MOVE -1 TO SC-TEXTL (SC-INDX).
  3418
  3419     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3420            VARYING SC-INDX FROM 1 BY 1 UNTIL
  3421            SC-INDX GREATER NUM-LINES-PER-SCREEN.
  3422
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL1042.cbl
  3423     MOVE 1 TO PI-UPDATE-SW.
  3424     GO TO 8100-SEND-INITIAL-MAP.
  3425
  3426 3600-INSERT-TABLE-ENTRIES.
  3427     MOVE REC-ENT (TB-INDX)       TO REC-ENT (TB-INDX1).
  3428     SET TB-INDX TB-INDX1 DOWN BY 1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL1042.cbl
  3430 3700-COPY-LINES.
  3431
  3432     IF  PI-RETURN-TO-PROGRAM = PGM-EM152
  3433             OR
  3434         PI-RETURN-TO-PROGRAM = PGM-EL152
  3435             OR
  3436         PI-RETURN-TO-PROGRAM = PGM-EL689
  3437
  3438         IF  LINE1I LESS 7
  3439                 AND
  3440             PI-CREATE-LABELS
  3441             MOVE ER-0212        TO EMI-ERROR
  3442             MOVE AL-UNBON       TO LINE1A
  3443             MOVE -1             TO LINE1L
  3444             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3445             GO TO 8200-SEND-DATAONLY.
  3446
  3447     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3448
  3449     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3450             VARYING
  3451         SC-INDX FROM 1 BY 1
  3452             UNTIL
  3453         SC-INDX GREATER NUM-LINES-PER-SCREEN.
  3454
  3455     IF  NOT EMI-NO-ERRORS
  3456        GO TO 8200-SEND-DATAONLY.
  3457
  3458     SET TB-INDX                  TO LINE1I.
  3459     MOVE REC-ENT (TB-INDX)       TO W-HOLD-LINE.
  3460     SET TB-INDX                  TO PI-TOTAL-LINES.
  3461     ADD +1                       TO PI-TOTAL-LINES.
  3462     SET TB-INDX1                 TO PI-TOTAL-LINES.
  3463
  3464     IF  LINE2L NOT GREATER THAN ZEROS
  3465         MOVE LINE1I              TO LINE2I.
  3466
  3467     PERFORM 3720-INSERT-TABLE-ENTRIES
  3468             UNTIL
  3469         TB-INDX = LINE2I.
  3470
  3471     SET TB-INDX UP BY 1.
  3472
  3473     COMPUTE ROLL-COUNTER
  3474         = PI-CURRENT-LINE + NUM-LINES-PER-SCREEN.
  3475
  3476     IF  TB-INDX NOT LESS ROLL-COUNTER
  3477             OR
  3478         TB-INDX LESS PI-CURRENT-LINE
  3479         SET SC-INDX              TO 1
  3480         SET SC-INDX DOWN BY 1
  3481
  3482     ELSE
  3483         SET ROLL-COUNTER TO TB-INDX
  3484         COMPUTE ROLL-COUNTER = ROLL-COUNTER - PI-CURRENT-LINE + 1
  3485         SET SC-INDX             TO ROLL-COUNTER.
  3486
  3487     MOVE W-HOLD-LINE            TO REC-ENT (TB-INDX).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL1042.cbl
  3488     SET TB-INDX                 TO PI-CURRENT-LINE.
  3489     MOVE LOW-VALUES             TO EL104BI.
  3490
  3491     IF  SC-INDX NOT = ZERO
  3492        MOVE -1                  TO SC-TEXTL (SC-INDX).
  3493
  3494     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3495             VARYING
  3496         SC-INDX FROM 1 BY 1
  3497             UNTIL
  3498         SC-INDX GREATER NUM-LINES-PER-SCREEN.
  3499
  3500     MOVE 1                      TO PI-UPDATE-SW.
  3501     GO TO 8100-SEND-INITIAL-MAP.
  3502
  3503 3720-INSERT-TABLE-ENTRIES.
  3504
  3505     MOVE REC-ENT (TB-INDX)      TO REC-ENT (TB-INDX1).
  3506     SET TB-INDX TB-INDX1 DOWN BY 1.
  3507
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL1042.cbl
  3509 4000-CHANGE-ROUTINE.
  3510
  3511     IF  ARCHBL GREATER THAN ZEROS
  3512             AND
  3513         (CREDIT-SESSION
  3514                  OR
  3515             MORTGAGE-SESSION)
  3516
  3517         IF  ARCHBI EQUAL 'Y'
  3518                 OR
  3519             ARCHBI EQUAL SPACES
  3520             MOVE ARCHBI         TO PI-1042-ARCHIVE-IND
  3521
  3522         ELSE
  3523             MOVE ER-7375        TO EMI-ERROR
  3524             MOVE -1             TO ARCHBL
  3525             MOVE AL-UABON       TO ARCHBA
  3526             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3527
  3528     IF  ARCHBL GREATER THAN ZEROS
  3529             AND
  3530         CLAIM-SESSION
  3531             AND
  3532         PI-COMPANY-ID = 'DMD'
  3533
  3534         IF ARCHBI = 'B' OR ' ' OR 'b'
  3535             INSPECT ARCHBI CONVERTING LOWER-CASE TO
  3536                                       UPPER-CASE
  3537             MOVE ARCHBI         TO PI-1042-ARCHIVE-IND
  3538             MOVE 1              TO PI-UPDATE-SW
  3539             MOVE AL-UANON       TO ARCHBA
  3540         ELSE
  3541             MOVE ER-8126        TO EMI-ERROR
  3542             MOVE -1             TO ARCHBL
  3543             MOVE AL-UABON       TO ARCHBA
  3544             MOVE 'Y'            TO WS-8126-ERROR-SW
  3545             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3546             GO TO 8200-SEND-DATAONLY.
  3547
  3548     IF  FORMSQBL GREATER THAN ZEROS
  3549             AND
  3550         (MORTGAGE-SESSION
  3551                 OR
  3552             CREDIT-SESSION)
  3553
  3554         IF  FORMSQBI EQUAL 'Y'
  3555                 OR
  3556             FORMSQBI EQUAL SPACES
  3557             MOVE FORMSQBI       TO PI-FORM-SQUEEZE-CONTROL
  3558
  3559         ELSE
  3560             MOVE ER-9349        TO EMI-ERROR
  3561             MOVE -1             TO FORMSQBL
  3562             MOVE AL-UABON       TO FORMSQBA
  3563             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3564
  3565     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3566     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL1042.cbl
  3567             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3568             SC-INDX GREATER NUM-LINES-PER-SCREEN.
  3569
  3570     IF  NOT EMI-NO-ERRORS
  3571        GO TO 8200-SEND-DATAONLY.
  3572
  3573     MOVE SPACES TO ERRMSGBO
  3574     GO TO 8200-SEND-DATAONLY.
  3575
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL1042.cbl
  3577 4500-SAVE-DATA.
  3578
  3579     IF  ARCHBL GREATER THAN ZEROS
  3580             AND
  3581         CREDIT-SESSION
  3582
  3583         IF  ARCHBI EQUAL 'Y'
  3584                 OR
  3585             ARCHBI EQUAL SPACES
  3586             MOVE ARCHBI       TO PI-1042-ARCHIVE-IND
  3587
  3588         ELSE
  3589             MOVE ER-7375      TO EMI-ERROR
  3590             MOVE -1           TO ARCHBL
  3591             MOVE AL-UABON     TO ARCHBA
  3592             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3593
  3594     IF  ARCHBL GREATER THAN ZEROS
  3595             AND
  3596         CLAIM-SESSION
  3597             AND
  3598         PI-COMPANY-ID = 'DMD'
  3599
  3600         IF ARCHBI = 'B' OR ' ' OR 'b'
  3601             INSPECT ARCHBI CONVERTING LOWER-CASE TO
  3602                                       UPPER-CASE
  3603             MOVE ARCHBI         TO PI-1042-ARCHIVE-IND
  3604             MOVE 1              TO PI-UPDATE-SW
  3605             MOVE AL-UANON      TO ARCHBA
  3606         ELSE
  3607             MOVE ER-8126        TO EMI-ERROR
  3608             MOVE -1             TO ARCHBL
  3609             MOVE AL-UABON       TO ARCHBA
  3610             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3611             GO TO 8200-SEND-DATAONLY.
  3612
  3613     IF  FORMSQBL GREATER THAN ZEROS
  3614             AND
  3615         (MORTGAGE-SESSION
  3616                 OR
  3617             CREDIT-SESSION)
  3618
  3619         IF  FORMSQBI EQUAL 'Y'
  3620                 OR
  3621             FORMSQBI EQUAL SPACES
  3622             MOVE FORMSQBI     TO PI-FORM-SQUEEZE-CONTROL
  3623
  3624         ELSE
  3625             MOVE ER-9349      TO EMI-ERROR
  3626             MOVE -1           TO FORMSQBL
  3627             MOVE AL-UABON     TO FORMSQBA
  3628             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3629
  3630     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3631
  3632     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3633             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3634             SC-INDX GREATER NUM-LINES-PER-SCREEN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL1042.cbl
  3635
  3636     IF  NOT EMI-NO-ERRORS
  3637        GO TO 8200-SEND-DATAONLY.
  3638
  3639     IF  PI-RETURN-TO-PROGRAM = PGM-EM152
  3640             OR
  3641         PI-RETURN-TO-PROGRAM = PGM-EL152
  3642             OR
  3643         PI-RETURN-TO-PROGRAM = PGM-EL689
  3644
  3645         PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT
  3646         GO TO 9410-RETURN.
  3647
  3648
  3649* EXEC CICS HANDLE CONDITION
  3650*         NOTFND  (4610-ENDBR)
  3651*         NOTOPEN (6000-NOT-OPEN)
  3652*         ENDFILE (4610-ENDBR)
  3653*     END-EXEC.
  3654*    MOVE '"$IJ''                 ! $ #00003587' TO DFHEIV0
  3655     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  3656     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3657     MOVE X'2420233030303033353837' TO DFHEIV0(25:11)
  3658     CALL 'kxdfhei1' USING DFHEIV0
  3659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3660
  3661
  3662
  3663* EXEC CICS DELETE
  3664*         DATASET   (FILE-ID)
  3665*         RIDFLD    (FILE-KEY)
  3666*         KEYLENGTH (13)
  3667*         GENERIC
  3668*     END-EXEC.
  3669     MOVE 13
  3670       TO DFHEIV11
  3671*    MOVE '&(  RKG               &   #00003593' TO DFHEIV0
  3672     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  3673     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3674     MOVE X'2020233030303033353933' TO DFHEIV0(25:11)
  3675     CALL 'kxdfhei1' USING DFHEIV0,
  3676           FILE-ID,
  3677           FILE-KEY,
  3678           DFHEIV11,
  3679           DFHEIV99,
  3680           DFHEIV99
  3681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3682
  3683
  3684 4610-ENDBR.
  3685
  3686* EXEC CICS GETMAIN
  3687*         SET(ADDRESS OF TEXT-FILES)
  3688*         LENGTH(FILE-LENGTH)
  3689*     END-EXEC.
  3690*    MOVE '," L                  $   #00003601' TO DFHEIV0
  3691     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  3692     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL1042.cbl
  3693     MOVE X'2020233030303033363031' TO DFHEIV0(25:11)
  3694     CALL 'kxdfhei1' USING DFHEIV0,
  3695           DFHEIV20,
  3696           FILE-LENGTH,
  3697           DFHEIV99
  3698     SET ADDRESS OF TEXT-FILES TO
  3699         DFHEIV20
  3700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3701
  3702
  3703     PERFORM 4700-WRITE-FILE THRU 4799-EXIT
  3704             VARYING TB-INDX FROM 1 BY 1 UNTIL
  3705             TB-INDX GREATER PI-TOTAL-LINES.
  3706
  3707     GO TO 9410-RETURN.
  3708
  3709 4700-WRITE-FILE.
  3710     ADD 1 TO SEQ.
  3711     MOVE FILE-KEY TO TX-CONTROL-PRIMARY.
  3712
  3713     IF  PI-ENTRY-CD-1 = '1'
  3714         MOVE  'TL' TO TEXT-FILE-ID
  3715     ELSE
  3716         IF  PI-ENTRY-CD-1 = '2'
  3717             MOVE 'TF' TO TEXT-FILE-ID
  3718         ELSE
  3719             MOVE 'TH' TO TEXT-FILE-ID.
  3720
  3721     MOVE REC-PC (TB-INDX)   TO TX-PROCESS-CONTROL.
  3722     MOVE REC-SQ (TB-INDX)   TO TX-LINE-SQUEEZE-CONTROL.
  3723     MOVE REC-TEXT (TB-INDX) TO TX-TEXT-LINE.
  3724     MOVE PI-PROCESSOR-ID    TO TX-LAST-MAINTENANCED-BY
  3725                                MNTBYO.
  3726     MOVE SAVE-BIN-DATE      TO TX-LAST-MAINTENANCED-DT.
  3727     MOVE SAVE-DATE          TO MNTONO.
  3728
  3729     IF  MORTGAGE-SESSION
  3730             OR
  3731         CREDIT-SESSION
  3732         MOVE PI-FORM-SQUEEZE-CONTROL
  3733                             TO TX-FORM-SQUEEZE-CONTROL
  3734         MOVE PI-1042-ARCHIVE-IND
  3735                             TO TX-ARCHIVE-SW.
  3736
  3737     IF  PI-COMPANY-ID = 'DMD'
  3738             AND
  3739         CLAIM-SESSION
  3740         MOVE PI-1042-ARCHIVE-IND
  3741                             TO TX-BSR-CODE.
  3742
  3743     IF  TX-PROCESS-CONTROL = SPACES
  3744        MOVE ZEROS TO TX-PROCESS-CONTROL.
  3745
  3746
  3747* EXEC CICS WRITE
  3748*         DATASET (FILE-ID)
  3749*         FROM    (TEXT-FILES)
  3750*         RIDFLD  (FILE-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL1042.cbl
  3751*     END-EXEC.
  3752     MOVE LENGTH OF
  3753      TEXT-FILES
  3754       TO DFHEIV11
  3755*    MOVE '&$ L                  ''   #00003649' TO DFHEIV0
  3756     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3757     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3758     MOVE X'2020233030303033363439' TO DFHEIV0(25:11)
  3759     CALL 'kxdfhei1' USING DFHEIV0,
  3760           FILE-ID,
  3761           TEXT-FILES,
  3762           DFHEIV11,
  3763           FILE-KEY,
  3764           DFHEIV99,
  3765           DFHEIV99
  3766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3767
  3768 4799-EXIT.
  3769      EXIT.
  3770
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL1042.cbl
  3772 5000-ADD-NEW-LINES.
  3773
  3774     IF  ARCHBL GREATER THAN ZEROS
  3775             AND
  3776         (CREDIT-SESSION
  3777                 OR
  3778             MORTGAGE-SESSION)
  3779
  3780         IF  ARCHBI EQUAL 'Y'
  3781                 OR
  3782             ARCHBI EQUAL SPACES
  3783             MOVE ARCHBI       TO PI-1042-ARCHIVE-IND
  3784
  3785         ELSE
  3786             MOVE ER-7375      TO EMI-ERROR
  3787             MOVE -1           TO ARCHBL
  3788             MOVE AL-UABON     TO ARCHBA
  3789             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3790*
  3791*    ELSE
  3792*        MOVE SPACES           TO PI-1042-ARCHIVE-IND.
  3793
  3794     IF  ARCHBL GREATER THAN ZEROS
  3795             AND
  3796         CLAIM-SESSION
  3797             AND
  3798         PI-COMPANY-ID = 'DMD'
  3799
  3800         IF ARCHBI = 'B' OR ' ' OR 'b'
  3801             INSPECT ARCHBI CONVERTING LOWER-CASE TO
  3802                                       UPPER-CASE
  3803             MOVE ARCHBI         TO PI-1042-ARCHIVE-IND
  3804             MOVE 1              TO PI-UPDATE-SW
  3805             MOVE AL-UANON      TO ARCHBA
  3806         ELSE
  3807             MOVE ER-8126        TO EMI-ERROR
  3808             MOVE -1             TO ARCHBL
  3809             MOVE AL-UABON       TO ARCHBA
  3810             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3811             GO TO 8200-SEND-DATAONLY.
  3812
  3813
  3814     IF  FORMSQBL GREATER THAN ZEROS
  3815             AND
  3816         (MORTGAGE-SESSION
  3817                 OR
  3818             CREDIT-SESSION)
  3819
  3820         IF  FORMSQBI EQUAL 'Y'
  3821                 OR
  3822             FORMSQBI EQUAL SPACES
  3823             MOVE FORMSQBI       TO PI-FORM-SQUEEZE-CONTROL
  3824
  3825         ELSE
  3826             MOVE ER-9349        TO EMI-ERROR
  3827             MOVE -1             TO FORMSQBL
  3828             MOVE AL-UABON       TO FORMSQBA
  3829             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL1042.cbl
  3830*
  3831*    ELSE
  3832*        MOVE SPACES             TO PI-FORM-SQUEEZE-CONTROL.
  3833
  3834     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3835
  3836     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3837             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3838             SC-INDX GREATER NUM-LINES-PER-SCREEN
  3839
  3840     IF  NOT EMI-NO-ERRORS
  3841        GO TO 8200-SEND-DATAONLY.
  3842
  3843     IF  PI-TOTAL-LINES EQUAL ZEROS
  3844         MOVE LOW-VALUES TO EL104BI
  3845         MOVE AL-UANON   TO FUNCTA
  3846         MOVE 'A'        TO FUNCTI
  3847         GO TO 8100-SEND-INITIAL-MAP.
  3848
  3849     MOVE PI-TOTAL-LINES
  3850                     TO PI-CURRENT-LINE.
  3851
  3852     MOVE LOW-VALUES TO EL104BI.
  3853     SET TB-INDX     TO PI-CURRENT-LINE.
  3854     MOVE 'A'        TO FUNCTI.
  3855     MOVE -1         TO SC-TEXTL (2).
  3856     MOVE AL-UANON   TO FUNCTA.
  3857
  3858     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3859             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3860             SC-INDX GREATER NUM-LINES-PER-SCREEN.
  3861
  3862     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL1042.cbl
  3864 5500-LOOKUP.
  3865     SET TB-INDX TO PI-CURRENT-LINE.
  3866
  3867     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3868             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3869             SC-INDX GREATER NUM-LINES-PER-SCREEN.
  3870
  3871     IF  NOT EMI-NO-ERRORS
  3872        GO TO 8200-SEND-DATAONLY.
  3873
  3874     MOVE LINE1I TO PI-CURRENT-LINE.
  3875     SET TB-INDX TO PI-CURRENT-LINE.
  3876     MOVE LOW-VALUES TO EL104BI.
  3877
  3878     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3879             VARYING SC-INDX FROM 1 BY 1
  3880             UNTIL SC-INDX GREATER NUM-LINES-PER-SCREEN.
  3881
  3882     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL1042.cbl
  3884 6000-NOT-OPEN.
  3885     IF  PI-ENTRY-CD-1 = '1'
  3886         MOVE ER-0013 TO EMI-ERROR
  3887     ELSE
  3888         IF  PI-ENTRY-CD-1 = '2'
  3889             MOVE ER-0014 TO EMI-ERROR
  3890         ELSE
  3891             MOVE ER-0015 TO EMI-ERROR.
  3892
  3893     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3894     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL1042.cbl
  3896 7000-BUILD-TABLE.
  3897     SET TB-INDX TO 1.
  3898     MOVE ZEROS TO PI-TOTAL-LINES
  3899                   PI-CURRENT-LINE
  3900                   PI-TEMP-STOR-ITEMS
  3901                   PI-UPDATE-SW.
  3902
  3903     MOVE LOW-VALUES TO EL104BI.
  3904     PERFORM 7500-READ-TS THRU 7599-EXIT.
  3905
  3906     IF  PI-TEMP-STOR-ITEMS NOT = ZERO
  3907        MOVE ER-0140 TO EMI-ERROR
  3908        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3909        MULTIPLY PI-TEMP-STOR-ITEMS BY TS-NUM-REC-IN-GROUP GIVING
  3910                 PI-TOTAL-LINES
  3911        MOVE 1 TO PI-CURRENT-LINE
  3912        SET TB-INDX TO 1
  3913        PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3914                VARYING SC-INDX FROM 1
  3915                BY 1 UNTIL SC-INDX GREATER NUM-LINES-PER-SCREEN
  3916        GO TO 8100-SEND-INITIAL-MAP.
  3917
  3918
  3919* EXEC CICS HANDLE CONDITION
  3920*         NOTFND (7010-ENDBR)
  3921*         NOTOPEN(6000-NOT-OPEN)
  3922*         ENDFILE(7010-ENDBR)
  3923*     END-EXEC.
  3924*    MOVE '"$IJ''                 ! % #00003804' TO DFHEIV0
  3925     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  3926     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3927     MOVE X'2520233030303033383034' TO DFHEIV0(25:11)
  3928     CALL 'kxdfhei1' USING DFHEIV0
  3929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3930
  3931
  3932
  3933* EXEC CICS STARTBR
  3934*         DATASET(FILE-ID)
  3935*         RIDFLD (FILE-KEY)
  3936*         KEYLENGTH(13)
  3937*         GENERIC
  3938*         GTEQ
  3939*     END-EXEC.
  3940     MOVE 13
  3941       TO DFHEIV11
  3942     MOVE 0
  3943       TO DFHEIV12
  3944*    MOVE '&,   KG    G          &   #00003810' TO DFHEIV0
  3945     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3946     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3947     MOVE X'2020233030303033383130' TO DFHEIV0(25:11)
  3948     CALL 'kxdfhei1' USING DFHEIV0,
  3949           FILE-ID,
  3950           FILE-KEY,
  3951           DFHEIV11,
  3952           DFHEIV12,
  3953           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL1042.cbl
  3954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3955
  3956
  3957 7001-LOOP.
  3958
  3959* EXEC CICS READNEXT
  3960*         SET    (ADDRESS OF TEXT-FILES)
  3961*         DATASET(FILE-ID)
  3962*         RIDFLD (FILE-KEY)
  3963*     END-EXEC.
  3964     MOVE 0
  3965       TO DFHEIV11
  3966*    MOVE '&.S                   )   #00003819' TO DFHEIV0
  3967     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3968     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3969     MOVE X'2020233030303033383139' TO DFHEIV0(25:11)
  3970     CALL 'kxdfhei1' USING DFHEIV0,
  3971           FILE-ID,
  3972           DFHEIV20,
  3973           DFHEIV99,
  3974           FILE-KEY,
  3975           DFHEIV99,
  3976           DFHEIV11,
  3977           DFHEIV99,
  3978           DFHEIV99
  3979     SET ADDRESS OF TEXT-FILES TO
  3980         DFHEIV20
  3981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3982
  3983
  3984     IF  FILE-PARTIAL-KEY NOT EQUAL OLD-KEY-SAVE
  3985         GO TO 7010-ENDBR.
  3986
  3987     MOVE TX-PROCESS-CONTROL     TO REC-PC (TB-INDX).
  3988     PERFORM 7150-TEST-SQUEEZE-LINE THRU 7150-EXIT.
  3989     MOVE TX-TEXT-LINE           TO REC-TEXT (TB-INDX).
  3990     MOVE TX-FORM-SQUEEZE-CONTROL
  3991                                 TO PI-FORM-SQUEEZE-CONTROL.
  3992
  3993     IF  PI-COMPANY-ID = 'DMD'
  3994             AND
  3995         CLAIM-SESSION
  3996         MOVE TX-BSR-CODE        TO PI-1042-ARCHIVE-IND
  3997
  3998     ELSE
  3999         MOVE TX-ARCHIVE-SW      TO PI-1042-ARCHIVE-IND.
  4000
  4001     IF  TX-LAST-MAINTENANCED-BY GREATER THAN SPACES
  4002         MOVE TX-LAST-MAINTENANCED-BY
  4003                                 TO W-SAVE-LAST-MAINT-BY
  4004         MOVE TX-LAST-MAINTENANCED-DT
  4005                                 TO DC-BIN-DATE-1
  4006         MOVE ' '                TO DC-OPTION-CODE
  4007         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  4008
  4009         IF  NO-CONVERSION-ERROR
  4010             MOVE DC-GREG-DATE-1-EDIT
  4011                                 TO W-SAVE-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL1042.cbl
  4012
  4013         ELSE
  4014             MOVE SPACES         TO W-SAVE-LAST-MAINT-DT
  4015                                    W-SAVE-LAST-MAINT-BY.
  4016
  4017     SET TB-INDX UP BY 1
  4018     GO TO 7001-LOOP.
  4019
  4020 7010-ENDBR.
  4021     IF  TB-INDX = 1
  4022        MOVE ER-0006  TO EMI-ERROR
  4023        MOVE 'A'      TO FUNCTI
  4024        MOVE -1       TO SC-TEXTL (1)
  4025        MOVE AL-UANON TO FUNCTA
  4026        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4027        GO TO 8100-SEND-INITIAL-MAP.
  4028
  4029
  4030* EXEC CICS ENDBR
  4031*         DATASET(FILE-ID)
  4032*     END-EXEC.
  4033     MOVE 0
  4034       TO DFHEIV11
  4035*    MOVE '&2                    $   #00003870' TO DFHEIV0
  4036     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4037     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4038     MOVE X'2020233030303033383730' TO DFHEIV0(25:11)
  4039     CALL 'kxdfhei1' USING DFHEIV0,
  4040           FILE-ID,
  4041           DFHEIV11,
  4042           DFHEIV99
  4043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4044
  4045
  4046     SET TB-INDX DOWN BY 1.
  4047     SET PI-TOTAL-LINES TO TB-INDX.
  4048     MOVE 1 TO PI-CURRENT-LINE.
  4049
  4050 7050-FORMAT-LINES.
  4051
  4052     SET TB-INDX TO PI-CURRENT-LINE.
  4053
  4054     IF  MORTGAGE-SESSION
  4055             OR
  4056         CREDIT-SESSION
  4057         IF  PI-1042-ARCHIVE-IND EQUAL 'Y'
  4058             MOVE PI-1042-ARCHIVE-IND
  4059                                TO ARCHBO.
  4060
  4061     IF  CLAIM-SESSION
  4062             AND
  4063         PI-COMPANY-ID = 'DMD'
  4064         IF PI-1042-ARCHIVE-IND = 'B' OR ' '
  4065             MOVE AL-UANON      TO ARCHBA
  4066             MOVE PI-1042-ARCHIVE-IND
  4067                                TO ARCHBO
  4068         END-IF
  4069     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL1042.cbl
  4070
  4071*        ELSE
  4072*            MOVE SPACES        TO PI-1042-ARCHIVE-IND
  4073*                                  ARCHBO.
  4074
  4075     IF  MORTGAGE-SESSION
  4076             OR
  4077         CREDIT-SESSION
  4078         IF  PI-FORM-SQUEEZE-CONTROL EQUAL 'Y'
  4079             MOVE PI-FORM-SQUEEZE-CONTROL
  4080                                TO FORMSQBO.
  4081
  4082     MOVE W-SAVE-LAST-MAINT-DT  TO MNTONO.
  4083     MOVE W-SAVE-LAST-MAINT-BY  TO MNTBYO.
  4084
  4085     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  4086             VARYING SC-INDX FROM 1
  4087             BY 1 UNTIL SC-INDX GREATER NUM-LINES-PER-SCREEN.
  4088
  4089     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL1042.cbl
  4091 7100-FORMAT-SCREEN.
  4092     IF REC-SQ (TB-INDX) = 'Z'
  4093        MOVE AL-PANOF            TO SC-TEXTA (SC-INDX)
  4094     END-IF
  4095     IF  TB-INDX NOT GREATER PI-TOTAL-LINES
  4096         MOVE REC-TEXT (TB-INDX) TO SC-TEXT (SC-INDX)
  4097         MOVE REC-PC (TB-INDX)   TO SC-PC (SC-INDX)
  4098         PERFORM 7151-TEST-SQUEEZE-LINE THRU 7151-EXIT
  4099         SET ROLL-COUNTER        TO TB-INDX
  4100         MOVE ROLL-COUNTER       TO SC-LIN (SC-INDX)
  4101         SET TB-INDX UP BY 1
  4102
  4103     ELSE
  4104         IF  FUNCTI = 'A' OR 'a'
  4105
  4106             IF  CLAIM-SESSION
  4107                     AND
  4108                 TB-INDX GREATER THAN +1
  4109                 MOVE AL-PANOF   TO SC-SQA (SC-INDX)
  4110
  4111             ELSE
  4112                 NEXT SENTENCE
  4113
  4114         ELSE
  4115             MOVE AL-PANOF       TO SC-TEXTA (SC-INDX)
  4116                                    SC-PCA (SC-INDX)
  4117                                    SC-SQA (SC-INDX).
  4118
  4119     IF  PI-RETURN-TO-PROGRAM = PGM-EM152
  4120             OR
  4121         PI-RETURN-TO-PROGRAM = PGM-EL152
  4122             OR
  4123         PI-RETURN-TO-PROGRAM = PGM-EL689
  4124
  4125         MOVE SPACES   TO SC-PC (SC-INDX)
  4126         MOVE AL-PANOF TO SC-PCA (SC-INDX)
  4127         MOVE SPACES   TO SC-SQ (SC-INDX)
  4128         MOVE AL-PANOF TO SC-SQA (SC-INDX).
  4129
  4130 7100-EXIT.
  4131      EXIT.
  4132
  4133 7150-TEST-SQUEEZE-LINE.
  4134
  4135     MOVE TX-LINE-SQUEEZE-CONTROL
  4136                                 TO W-LINE-SQUEEZE-IND.
  4137
  4138     IF  W-LINE-SQUEEZE-VALID-VALUE
  4139         MOVE TX-LINE-SQUEEZE-CONTROL
  4140                             TO REC-SQ (TB-INDX)
  4141
  4142     ELSE
  4143         MOVE SPACES         TO REC-SQ (TB-INDX).
  4144
  4145
  4146 7150-EXIT.
  4147      EXIT.
  4148
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL1042.cbl
  4149 7151-TEST-SQUEEZE-LINE.
  4150
  4151     MOVE REC-SQ (TB-INDX)   TO W-LINE-SQUEEZE-IND.
  4152
  4153     IF  W-LINE-SQUEEZE-VALID-VALUE
  4154         NEXT SENTENCE
  4155
  4156     ELSE
  4157         MOVE SPACES         TO REC-SQ (TB-INDX).
  4158
  4159     IF  MORTGAGE-SESSION
  4160             OR
  4161         CREDIT-SESSION
  4162         MOVE REC-SQ (TB-INDX)
  4163                             TO SC-SQ (SC-INDX)
  4164
  4165     ELSE
  4166         IF  CLAIM-SESSION
  4167                 AND
  4168             TB-INDX EQUAL +1
  4169             MOVE REC-SQ (TB-INDX)
  4170                             TO SC-SQ (SC-INDX)
  4171
  4172         ELSE
  4173             MOVE ZEROS      TO SC-SQL (SC-INDX)
  4174             MOVE AL-SADOF   TO SC-SQA (SC-INDX)
  4175             MOVE LOW-VALUES TO SC-SQ  (SC-INDX).
  4176
  4177 7151-EXIT.
  4178      EXIT.
  4179
  4180 7200-PUT-TEMP-STOR.
  4181     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  4182     SET TS-INDX TO 1.
  4183     MOVE 0 TO PI-TEMP-STOR-ITEMS.
  4184
  4185     PERFORM 7300-WRITE-TS THRU 7399-EXIT
  4186             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
  4187             UNTIL TS-GROUP-WORK NOT LESS PI-TOTAL-LINES.
  4188 7249-EXIT.
  4189      EXIT.
  4190
  4191 7250-DELETE-TEMP-STOR.
  4192
  4193* EXEC CICS HANDLE CONDITION
  4194*         QIDERR(7299-EXIT)
  4195*     END-EXEC.
  4196*    MOVE '"$N                   ! & #00004020' TO DFHEIV0
  4197     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4198     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4199     MOVE X'2620233030303034303230' TO DFHEIV0(25:11)
  4200     CALL 'kxdfhei1' USING DFHEIV0
  4201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4202
  4203
  4204
  4205* EXEC CICS DELETEQ TS
  4206*         QUEUE(TS-NAME)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL1042.cbl
  4207*     END-EXEC.
  4208*    MOVE '*&                    #   #00004024' TO DFHEIV0
  4209     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  4210     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4211     MOVE X'2020233030303034303234' TO DFHEIV0(25:11)
  4212     CALL 'kxdfhei1' USING DFHEIV0,
  4213           TS-NAME,
  4214           DFHEIV99
  4215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4216
  4217
  4218 7299-EXIT.
  4219     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL1042.cbl
  4221 7300-WRITE-TS.
  4222     MOVE TS-GROUP (TS-INDX) TO TS-WORK-AREA.
  4223     SET TS-INDX UP BY 1.
  4224     ADD 1 TO PI-TEMP-STOR-ITEMS.
  4225
  4226
  4227* EXEC CICS WRITEQ TS
  4228*         FROM  (TS-WORK-AREA)
  4229*         QUEUE (TS-NAME)
  4230*         LENGTH(TS-LENGTH)
  4231*         ITEM  (PI-TEMP-STOR-ITEMS)
  4232*     END-EXEC.
  4233*    MOVE '*" I                  ''   #00004036' TO DFHEIV0
  4234     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  4235     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4236     MOVE X'2020233030303034303336' TO DFHEIV0(25:11)
  4237     CALL 'kxdfhei1' USING DFHEIV0,
  4238           TS-NAME,
  4239           TS-WORK-AREA,
  4240           TS-LENGTH,
  4241           PI-TEMP-STOR-ITEMS,
  4242           DFHEIV99,
  4243           DFHEIV99
  4244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4245
  4246
  4247 7399-EXIT.
  4248     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL1042.cbl
  4250 7400-PAGE-ROUTINE.
  4251     IF  PFENTRBL NOT = ZEROS
  4252        MOVE -1 TO PFENTRBL
  4253       ELSE
  4254        MOVE -1 TO FUNCTL.
  4255
  4256     IF  PI-TOTAL-LINES = 0
  4257        MOVE ER-0047 TO EMI-ERROR
  4258        MOVE -1 TO FUNCTL
  4259        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4260        GO TO 8200-SEND-DATAONLY.
  4261
  4262     COMPUTE TEMP-CURR-LINE = PI-CURRENT-LINE + ROLL-COUNTER.
  4263
  4264     IF  TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  4265        MOVE ER-0067 TO EMI-ERROR
  4266        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4267        MOVE 1 TO TEMP-CURR-LINE.
  4268
  4269     IF  TEMP-CURR-LINE GREATER PI-TOTAL-LINES
  4270        MOVE ER-0066 TO EMI-ERROR
  4271        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4272        COMPUTE TEMP-CURR-LINE = PI-TOTAL-LINES + 1
  4273                               - NUM-LINES-PER-SCREEN
  4274        IF  TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  4275           MOVE 1 TO TEMP-CURR-LINE.
  4276
  4277     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  4278
  4279     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  4280             VARYING SC-INDX FROM 1 BY 1 UNTIL
  4281             SC-INDX GREATER NUM-LINES-PER-SCREEN.
  4282
  4283     IF  EMI-ERROR = ER-0066 OR ER-0067 OR ZEROS
  4284        NEXT SENTENCE
  4285       ELSE
  4286        GO TO 8200-SEND-DATAONLY.
  4287
  4288     MOVE TEMP-CURR-LINE TO PI-CURRENT-LINE.
  4289     SET TB-INDX         TO PI-CURRENT-LINE.
  4290     MOVE LOW-VALUES     TO EL104BI.
  4291
  4292     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  4293             VARYING SC-INDX FROM 1 BY 1
  4294             UNTIL SC-INDX GREATER NUM-LINES-PER-SCREEN
  4295
  4296     IF  CREDIT-SESSION
  4297         IF  PI-1042-ARCHIVE-IND EQUAL 'Y'
  4298             MOVE PI-1042-ARCHIVE-IND
  4299                                TO ARCHBO.
  4300
  4301     IF  CLAIM-SESSION
  4302             AND
  4303         PI-COMPANY-ID = 'DMD'
  4304         IF PI-1042-ARCHIVE-IND = 'B' OR ' '
  4305             MOVE AL-UANON      TO ARCHBA
  4306             MOVE PI-1042-ARCHIVE-IND
  4307                                TO ARCHBO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL1042.cbl
  4308
  4309     IF  MORTGAGE-SESSION
  4310             OR
  4311         CREDIT-SESSION
  4312         IF  PI-FORM-SQUEEZE-CONTROL EQUAL 'Y'
  4313             MOVE PI-FORM-SQUEEZE-CONTROL
  4314                                 TO FORMSQBO.
  4315
  4316     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL1042.cbl
  4318 7450-SET-INDX.
  4319     IF  PI-CURRENT-LINE = 0
  4320        SET TB-INDX TO 1
  4321       ELSE
  4322        SET TB-INDX TO PI-CURRENT-LINE.
  4323
  4324 7450-EXIT.
  4325      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL1042.cbl
  4327 7500-READ-TS.
  4328
  4329* EXEC CICS HANDLE CONDITION
  4330*         QIDERR (7590-TS-QIDERR)
  4331*         ITEMERR(7585-TS-ITEMERR)
  4332*     END-EXEC.
  4333*    MOVE '"$N<                  ! '' #00004124' TO DFHEIV0
  4334     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  4335     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4336     MOVE X'2720233030303034313234' TO DFHEIV0(25:11)
  4337     CALL 'kxdfhei1' USING DFHEIV0
  4338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4339
  4340
  4341     IF  CREDIT-SESSION
  4342         IF  PI-1042-ARCHIVE-IND EQUAL 'Y'
  4343             MOVE PI-1042-ARCHIVE-IND
  4344                                TO ARCHBO.
  4345
  4346     IF  CLAIM-SESSION
  4347             AND
  4348         PI-COMPANY-ID = 'DMD'
  4349         IF PI-1042-ARCHIVE-IND = 'B' OR ' '
  4350             MOVE AL-UANON      TO ARCHBA
  4351             MOVE PI-1042-ARCHIVE-IND
  4352                                TO ARCHBO.
  4353
  4354     IF  MORTGAGE-SESSION
  4355             OR
  4356         CREDIT-SESSION
  4357         IF  PI-FORM-SQUEEZE-CONTROL EQUAL 'Y'
  4358             MOVE PI-FORM-SQUEEZE-CONTROL
  4359                                 TO FORMSQBO.
  4360
  4361     SET TS-INDX TO 1.
  4362     MOVE 1 TO TS-ITEM.
  4363
  4364 7501-LOOP.
  4365
  4366* EXEC CICS READQ TS
  4367*         INTO  (TS-WORK-AREA)
  4368*         QUEUE (TS-NAME)
  4369*         LENGTH(TS-LENGTH)
  4370*         ITEM  (TS-ITEM)
  4371*     END-EXEC.
  4372*    MOVE '*$II   L              ''   #00004153' TO DFHEIV0
  4373     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4374     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4375     MOVE X'2020233030303034313533' TO DFHEIV0(25:11)
  4376     CALL 'kxdfhei1' USING DFHEIV0,
  4377           TS-NAME,
  4378           TS-WORK-AREA,
  4379           TS-LENGTH,
  4380           TS-ITEM,
  4381           DFHEIV99,
  4382           DFHEIV99
  4383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4384
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL1042.cbl
  4385
  4386     MOVE TS-WORK-AREA TO TS-GROUP (TS-INDX).
  4387     SET TS-INDX UP BY 1.
  4388     ADD 1 TO TS-ITEM.
  4389     GO TO 7501-LOOP.
  4390
  4391 7585-TS-ITEMERR.
  4392     IF  EIBTRNID NOT = TRANS-ID
  4393        SUBTRACT 1 FROM TS-ITEM
  4394        MOVE TS-ITEM TO PI-TEMP-STOR-ITEMS.
  4395
  4396     GO TO 7599-EXIT.
  4397
  4398 7590-TS-QIDERR.
  4399
  4400     MOVE ZEROS TO PI-TEMP-STOR-ITEMS.
  4401
  4402 7599-EXIT.
  4403      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL1042.cbl
  4405 7600-UPDATE-TABLE-FROM-SCREEN.
  4406
  4407     IF  SC-TEXTL (SC-INDX) NOT = ZEROS
  4408             OR
  4409         SC-PCL   (SC-INDX) NOT = ZEROS
  4410             OR
  4411         SC-SQL   (SC-INDX) NOT = ZEROS
  4412
  4413         IF  TB-INDX NOT GREATER PI-TOTAL-LINES
  4414             PERFORM 7700-MOVE-DATA THRU 7700-EXIT
  4415             SET TB-INDX UP BY 1
  4416
  4417         ELSE
  4418             IF  PI-TOTAL-LINES = MAX-LINES
  4419                 MOVE ER-0051 TO EMI-ERROR
  4420                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4421                 GO TO 8200-SEND-DATAONLY
  4422
  4423             ELSE
  4424                 PERFORM 7700-MOVE-DATA THRU 7700-EXIT
  4425                 SET TB-INDX UP BY 1
  4426                 ADD 1 TO PI-TOTAL-LINES
  4427
  4428     ELSE
  4429         IF  TB-INDX NOT GREATER PI-TOTAL-LINES
  4430             SET TB-INDX UP BY 1.
  4431
  4432 7699-EXIT.
  4433      EXIT.
  4434
  4435 7700-MOVE-DATA.
  4436
  4437     IF  SC-TEXTL (SC-INDX) NOT = ZEROS
  4438         MOVE 1                 TO PI-UPDATE-SW
  4439         MOVE SC-TEXT (SC-INDX) TO REC-TEXT (TB-INDX).
  4440
  4441     IF  PI-RETURN-TO-PROGRAM = PGM-EM152
  4442             OR
  4443         PI-RETURN-TO-PROGRAM = PGM-EL152
  4444             OR
  4445         PI-RETURN-TO-PROGRAM = PGM-EL689
  4446         GO TO 7700-EXIT.
  4447
  4448     IF  SC-PCL (SC-INDX) NOT = ZEROS
  4449         IF  SC-PC (SC-INDX) = SPACES OR
  4450             SC-PC (SC-INDX) NUMERIC
  4451             MOVE SC-PC (SC-INDX)
  4452                                 TO REC-PC (TB-INDX)
  4453             MOVE 1              TO PI-UPDATE-SW
  4454
  4455         ELSE
  4456             MOVE -1             TO SC-PCL (SC-INDX)
  4457             MOVE ER-0141        TO EMI-ERROR
  4458             MOVE AL-UABON       TO SC-PCA (SC-INDX)
  4459             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4460
  4461     IF  SC-SQL (SC-INDX) NOT EQUAL ZEROS
  4462             AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL1042.cbl
  4463         SC-SQ (SC-INDX) NOT EQUAL LOW-VALUES
  4464         MOVE SC-SQ (SC-INDX)    TO W-LINE-SQUEEZE-IND
  4465
  4466         IF  W-LINE-SQUEEZE-VALID-VALUE
  4467             MOVE 1              TO PI-UPDATE-SW
  4468             MOVE SC-SQ (SC-INDX)
  4469                                 TO REC-SQ (TB-INDX)
  4470
  4471         ELSE
  4472             MOVE -1             TO SC-SQL (SC-INDX)
  4473             MOVE ER-9348        TO EMI-ERROR
  4474             MOVE AL-UABON       TO SC-SQA (SC-INDX)
  4475             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4476
  4477 7700-EXIT.
  4478      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL1042.cbl
  4480 8100-SEND-INITIAL-MAP.
  4481
  4482     MOVE 'Y'                  TO PI-1042-SCREEN-SENT-IND.
  4483     MOVE PI-COMPANY-ID        TO COMPANYO.
  4484     MOVE SAVE-DATE            TO DATEBO.
  4485     MOVE EIBTIME              TO TIME-IN.
  4486     MOVE TIME-OUT             TO TIMEBO.
  4487     MOVE EMI-MESSAGE-AREA (1) TO ERRMSGBO.
  4488
  4489     IF  PI-ENTRY-CD-1 = '1'
  4490         MOVE 'LETTERS' TO TEXTTPBO
  4491     ELSE
  4492         IF  PI-ENTRY-CD-1 = '2'
  4493             MOVE 'FORMS' TO TEXTTPBO
  4494         ELSE
  4495             MOVE 'HELP' TO TEXTTPBO.
  4496
  4497     MOVE ' ARCHIVE:'                 TO ARCHTBO.
  4498
  4499     IF  CLAIM-SESSION   AND
  4500         PI-COMPANY-ID = 'DMD'
  4501             MOVE '     BSR:'         TO ARCHTBO
  4502             MOVE +13                 TO FORMSTBL
  4503             MOVE +1                  TO LINESQTL
  4504             MOVE AL-SADOF            TO FORMSTBA
  4505                                         SC-SQA (02)
  4506                                         SC-SQA (03)
  4507                                         SC-SQA (04)
  4508                                         SC-SQA (05)
  4509                                         SC-SQA (06)
  4510                                         SC-SQA (07)
  4511                                         SC-SQA (08)
  4512                                         SC-SQA (09)
  4513                                         SC-SQA (10)
  4514                                         SC-SQA (11)
  4515                                         SC-SQA (12)
  4516                                         SC-SQA (13)
  4517                                         SC-SQA (14)
  4518                                         SC-SQA (15)
  4519     ELSE
  4520
  4521     IF  MORTGAGE-SESSION
  4522         MOVE +13                     TO FORMSTBL
  4523         MOVE AL-SANOF                TO FORMSTBA
  4524         MOVE +1                      TO LINESQTL
  4525         MOVE AL-SANOF                TO LINESQTA
  4526         MOVE AL-UANON                TO FORMSQBA
  4527         MOVE AL-UANON                TO ARCHBA
  4528                                         ARCHTBA
  4529
  4530     ELSE
  4531         IF  CLAIM-SESSION
  4532             MOVE +13                 TO FORMSTBL
  4533             MOVE +1                  TO LINESQTL
  4534             MOVE AL-SADOF            TO FORMSTBA
  4535                                         ARCHBA
  4536                                         ARCHTBA
  4537                                         SC-SQA (02)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL1042.cbl
  4538                                         SC-SQA (03)
  4539                                         SC-SQA (04)
  4540                                         SC-SQA (05)
  4541                                         SC-SQA (06)
  4542                                         SC-SQA (07)
  4543                                         SC-SQA (08)
  4544                                         SC-SQA (09)
  4545                                         SC-SQA (10)
  4546                                         SC-SQA (11)
  4547                                         SC-SQA (12)
  4548                                         SC-SQA (13)
  4549                                         SC-SQA (14)
  4550                                         SC-SQA (15)
  4551
  4552         ELSE
  4553             MOVE +13                 TO FORMSTBL
  4554             MOVE AL-SANOF            TO FORMSTBA
  4555             MOVE +1                  TO LINESQTL
  4556             MOVE AL-SANOF            TO LINESQTA
  4557             MOVE AL-UANON            TO FORMSQBA
  4558                                         ARCHBA
  4559             MOVE +9                  TO ARCHTBL
  4560             MOVE AL-SANOF            TO ARCHTBA.
  4561
  4562     IF  CREDIT-SESSION
  4563             OR
  4564         MORTGAGE-SESSION
  4565
  4566         IF  PI-1042-ARCHIVE-IND EQUAL 'Y'
  4567             MOVE +1            TO ARCHBL
  4568             MOVE AL-UANON      TO ARCHBA
  4569             MOVE PI-1042-ARCHIVE-IND
  4570                                TO ARCHBO.
  4571
  4572     IF  CLAIM-SESSION
  4573             AND
  4574         PI-COMPANY-ID = 'DMD'
  4575         IF PI-1042-ARCHIVE-IND = 'B' OR ' '
  4576             MOVE +1            TO ARCHBL
  4577             MOVE AL-UANON      TO ARCHBA
  4578             MOVE PI-1042-ARCHIVE-IND
  4579                                TO ARCHBO.
  4580
  4581     IF  MORTGAGE-SESSION
  4582             OR
  4583         CREDIT-SESSION
  4584
  4585         IF  PI-FORM-SQUEEZE-CONTROL EQUAL 'Y'
  4586             MOVE PI-FORM-SQUEEZE-CONTROL
  4587                                 TO FORMSQBO
  4588             MOVE +1             TO FORMSQBL
  4589             MOVE AL-UANON       TO FORMSQBA.
  4590
  4591     MOVE PI-COMM-CONTROL TO CONTRLBI.
  4592     MOVE PI-TOTAL-LINES  TO TOTI.
  4593     MOVE -1              TO FUNCTL.
  4594
  4595
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL1042.cbl
  4596* EXEC CICS SEND
  4597*         MAPSET(MAPSET-NAME)
  4598*         MAP   (MAP-NAME)
  4599*         FROM  (EL104BO)
  4600*         ERASE
  4601*         CURSOR
  4602*     END-EXEC.
  4603     MOVE LENGTH OF
  4604      EL104BO
  4605       TO DFHEIV12
  4606     MOVE -1
  4607       TO DFHEIV11
  4608*    MOVE '8$     CT  E    H L F ,   #00004369' TO DFHEIV0
  4609     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  4610     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4611     MOVE X'2020233030303034333639' TO DFHEIV0(25:11)
  4612     CALL 'kxdfhei1' USING DFHEIV0,
  4613           MAP-NAME,
  4614           EL104BO,
  4615           DFHEIV12,
  4616           MAPSET-NAME,
  4617           DFHEIV99,
  4618           DFHEIV99,
  4619           DFHEIV99,
  4620           DFHEIV11,
  4621           DFHEIV99,
  4622           DFHEIV99,
  4623           DFHEIV99
  4624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4625
  4626
  4627     GO TO 0200-RECEIVE.
  4628
  4629 8200-SEND-DATAONLY.
  4630
  4631     IF  PI-1042-SCREEN-NOT-SENT
  4632         GO TO 8100-SEND-INITIAL-MAP.
  4633
  4634     MOVE PI-COMPANY-ID        TO COMPANYO.
  4635     MOVE EIBTIME        TO TIME-IN.
  4636     MOVE TIME-OUT       TO TIMEBO.
  4637     MOVE PI-TOTAL-LINES TO TOTI.
  4638
  4639     MOVE ' ARCHIVE:'                 TO ARCHTBO.
  4640
  4641     IF  CLAIM-SESSION   AND
  4642         PI-COMPANY-ID = 'DMD'
  4643             MOVE '     BSR:'         TO ARCHTBO
  4644             MOVE +13                 TO FORMSTBL
  4645             MOVE +1                  TO LINESQTL
  4646             MOVE AL-SADOF            TO FORMSTBA
  4647                                         SC-SQA (02)
  4648                                         SC-SQA (03)
  4649                                         SC-SQA (04)
  4650                                         SC-SQA (05)
  4651                                         SC-SQA (06)
  4652                                         SC-SQA (07)
  4653                                         SC-SQA (08)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL1042.cbl
  4654                                         SC-SQA (09)
  4655                                         SC-SQA (10)
  4656                                         SC-SQA (11)
  4657                                         SC-SQA (12)
  4658                                         SC-SQA (13)
  4659                                         SC-SQA (14)
  4660                                         SC-SQA (15)
  4661     ELSE
  4662
  4663     IF  MORTGAGE-SESSION
  4664         MOVE +13                     TO FORMSTBL
  4665         MOVE AL-SANOF                TO FORMSTBA
  4666         MOVE +1                      TO LINESQTL
  4667         MOVE AL-SANOF                TO LINESQTA
  4668         MOVE AL-UANON                TO FORMSQBA
  4669         MOVE AL-UANON                TO ARCHBA
  4670                                         ARCHTBA
  4671
  4672     ELSE
  4673         IF  CLAIM-SESSION
  4674             MOVE +13                 TO FORMSTBL
  4675             MOVE +1                  TO LINESQTL
  4676             MOVE AL-SADOF            TO FORMSTBA
  4677                                         ARCHBA
  4678                                         ARCHTBA
  4679                                         SC-SQA (02)
  4680                                         SC-SQA (03)
  4681                                         SC-SQA (04)
  4682                                         SC-SQA (05)
  4683                                         SC-SQA (06)
  4684                                         SC-SQA (07)
  4685                                         SC-SQA (08)
  4686                                         SC-SQA (09)
  4687                                         SC-SQA (10)
  4688                                         SC-SQA (11)
  4689                                         SC-SQA (12)
  4690                                         SC-SQA (13)
  4691                                         SC-SQA (14)
  4692                                         SC-SQA (15)
  4693
  4694         ELSE
  4695             MOVE +13                 TO FORMSTBL
  4696             MOVE AL-SANOF            TO FORMSTBA
  4697             MOVE +1                  TO LINESQTL
  4698             MOVE AL-SANOF            TO LINESQTA
  4699             MOVE AL-UANON            TO FORMSQBA
  4700                                         ARCHBA
  4701             MOVE +9                  TO ARCHTBL
  4702             MOVE AL-SANOF            TO ARCHTBA.
  4703
  4704     IF  CREDIT-SESSION
  4705             OR
  4706         MORTGAGE-SESSION
  4707
  4708         IF  PI-1042-ARCHIVE-IND EQUAL 'Y'
  4709             MOVE +1            TO ARCHBL
  4710             MOVE AL-UANON      TO ARCHBA
  4711             MOVE PI-1042-ARCHIVE-IND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL1042.cbl
  4712                                TO ARCHBO.
  4713
  4714     IF  CLAIM-SESSION
  4715             AND
  4716         PI-COMPANY-ID = 'DMD'
  4717             AND
  4718         WS-8126-ERROR-SW = 'N'
  4719         IF PI-1042-ARCHIVE-IND = 'B' OR ' '
  4720             MOVE +1            TO ARCHBL
  4721             MOVE AL-UANON      TO ARCHBA
  4722             MOVE PI-1042-ARCHIVE-IND
  4723                                TO ARCHBO.
  4724
  4725     IF  MORTGAGE-SESSION
  4726             OR
  4727         CREDIT-SESSION
  4728
  4729         IF  PI-FORM-SQUEEZE-CONTROL EQUAL 'Y'
  4730             MOVE PI-FORM-SQUEEZE-CONTROL
  4731                                 TO FORMSQBO
  4732             MOVE +1             TO FORMSQBL
  4733             MOVE AL-UANON       TO FORMSQBA.
  4734
  4735     IF  NOT EMI-NO-ERRORS
  4736         MOVE EMI-MESSAGE-AREA (1) TO ERRMSGBO
  4737     ELSE
  4738         MOVE -1 TO FUNCTL.
  4739
  4740
  4741* EXEC CICS SEND
  4742*         MAPSET(MAPSET-NAME)
  4743*         MAP   (MAP-NAME)
  4744*         DATAONLY
  4745*         CURSOR
  4746*         FROM  (EL104BO)
  4747*    END-EXEC.
  4748     MOVE LENGTH OF
  4749      EL104BO
  4750       TO DFHEIV12
  4751     MOVE -1
  4752       TO DFHEIV11
  4753*    MOVE '8$D    CT       H L F ,   #00004490' TO DFHEIV0
  4754     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  4755     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4756     MOVE X'2020233030303034343930' TO DFHEIV0(25:11)
  4757     CALL 'kxdfhei1' USING DFHEIV0,
  4758           MAP-NAME,
  4759           EL104BO,
  4760           DFHEIV12,
  4761           MAPSET-NAME,
  4762           DFHEIV99,
  4763           DFHEIV99,
  4764           DFHEIV99,
  4765           DFHEIV11,
  4766           DFHEIV99,
  4767           DFHEIV99,
  4768           DFHEIV99
  4769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL1042.cbl
  4770
  4771
  4772     GO TO 0200-RECEIVE.
  4773
  4774 8300-SEND-TEXT.
  4775
  4776
  4777* EXEC CICS SEND TEXT
  4778*         FROM  (LOGOFF-TEXT)
  4779*         ERASE
  4780*         FREEKB
  4781*         LENGTH(LOGOFF-LENGTH)
  4782*    END-EXEC.
  4783*    MOVE '8&      T  E F  H   F -   #00004502' TO DFHEIV0
  4784     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  4785     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  4786     MOVE X'2020233030303034353032' TO DFHEIV0(25:11)
  4787     CALL 'kxdfhei1' USING DFHEIV0,
  4788           LOGOFF-TEXT,
  4789           LOGOFF-LENGTH,
  4790           DFHEIV99,
  4791           DFHEIV99,
  4792           DFHEIV99,
  4793           DFHEIV99,
  4794           DFHEIV99,
  4795           DFHEIV99,
  4796           DFHEIV99,
  4797           DFHEIV99,
  4798           DFHEIV99,
  4799           DFHEIV99
  4800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4801
  4802
  4803     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  4804
  4805
  4806* EXEC CICS RETURN
  4807*    END-EXEC.
  4808*    MOVE '.(                    &   #00004511' TO DFHEIV0
  4809     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4810     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4811     MOVE X'2020233030303034353131' TO DFHEIV0(25:11)
  4812     CALL 'kxdfhei1' USING DFHEIV0,
  4813           DFHEIV99,
  4814           DFHEIV99,
  4815           DFHEIV99,
  4816           DFHEIV99,
  4817           DFHEIV99
  4818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4819
  4820
  4821 8800-UNAUTHORIZED-ACCESS.
  4822
  4823     MOVE UNACCESS-MSG TO LOGOFF-MSG.
  4824     GO TO 8300-SEND-TEXT.
  4825
  4826 9000-RETURN-CICS.
  4827
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL1042.cbl
  4828     IF  ANY-UPDATES
  4829         MOVE ER-0045  TO EMI-ERROR
  4830         MOVE -1       TO FUNCTL
  4831         MOVE SPACES   TO PFENTRBO
  4832         MOVE AL-UNNOF TO PFENTRBA
  4833         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4834         GO TO 8200-SEND-DATAONLY.
  4835
  4836     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  4837
  4838
  4839     MOVE EIBAID  TO PI-ENTRY-CD-1.
  4840     MOVE 'EL005' TO PGM-NAME.
  4841     GO TO 9300-XCTL.
  4842
  4843 9100-RETURN-TRAN.
  4844
  4845
  4846* EXEC CICS RETURN
  4847*         TRANSID (TRANS-ID)
  4848*         COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4849*         LENGTH  (PI-COMM-LENGTH)
  4850*    END-EXEC.
  4851*    MOVE '.(CT                  &   #00004538' TO DFHEIV0
  4852     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  4853     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4854     MOVE X'2020233030303034353338' TO DFHEIV0(25:11)
  4855     CALL 'kxdfhei1' USING DFHEIV0,
  4856           TRANS-ID,
  4857           PROGRAM-INTERFACE-BLOCK,
  4858           PI-COMM-LENGTH,
  4859           DFHEIV99,
  4860           DFHEIV99
  4861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4862
  4863
  4864 9200-RETURN-MAIN-MENU.
  4865
  4866     IF  ANY-UPDATES
  4867         MOVE -1       TO FUNCTL
  4868         MOVE SPACES   TO PFENTRBO
  4869         MOVE AL-UNNOF TO PFENTRBA
  4870         MOVE ER-0045  TO EMI-ERROR
  4871         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4872         GO TO 8200-SEND-DATAONLY.
  4873
  4874     IF  CLAIM-SESSION
  4875         MOVE XCTL-CLAIM      TO PGM-NAME
  4876
  4877     ELSE
  4878         IF  CREDIT-SESSION
  4879             MOVE XCTL-CREDIT TO PGM-NAME
  4880
  4881         ELSE
  4882             IF  WARRANTY-SESSION
  4883                 MOVE XCTL-WARRANTY TO PGM-NAME
  4884
  4885             ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL1042.cbl
  4886                 IF  MORTGAGE-SESSION
  4887                     MOVE XCTL-MORTGAGE   TO PGM-NAME
  4888
  4889                 ELSE
  4890                     MOVE XCTL-GEN-LEDGER TO PGM-NAME.
  4891
  4892 9300-XCTL.
  4893
  4894     MOVE MAP-NUMBER           TO PI-CURRENT-SCREEN-NO.
  4895     MOVE EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  4896
  4897     MOVE TRANS-ID             TO EIBTRNID
  4898
  4899     IF  PI-RETURN-TO-PROGRAM NOT EQUAL PGM-EM152
  4900             AND
  4901         PI-RETURN-TO-PROGRAM NOT EQUAL PGM-EL152
  4902             AND
  4903         PI-RETURN-TO-PROGRAM NOT EQUAL PGM-EL689
  4904
  4905         PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  4906
  4907
  4908* EXEC CICS XCTL
  4909*         PROGRAM (PGM-NAME)
  4910*         COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4911*         LENGTH  (PI-COMM-LENGTH)
  4912*     END-EXEC.
  4913*    MOVE '.$C                   $   #00004587' TO DFHEIV0
  4914     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4915     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4916     MOVE X'2020233030303034353837' TO DFHEIV0(25:11)
  4917     CALL 'kxdfhei1' USING DFHEIV0,
  4918           PGM-NAME,
  4919           PROGRAM-INTERFACE-BLOCK,
  4920           PI-COMM-LENGTH
  4921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4922
  4923
  4924 9400-CLEAR.
  4925     IF  ANY-UPDATES
  4926        MOVE ER-0045  TO EMI-ERROR
  4927        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4928        SET TB-INDX TO PI-CURRENT-LINE
  4929        PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  4930                VARYING SC-INDX FROM 1 BY 1 UNTIL
  4931                SC-INDX GREATER NUM-LINES-PER-SCREEN
  4932        GO TO 8100-SEND-INITIAL-MAP.
  4933
  4934 9410-RETURN.
  4935        MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME.
  4936        GO TO 9300-XCTL.
  4937
  4938 9450-PF5.
  4939     IF ANY-UPDATES
  4940        MOVE -1                  TO FUNCTL
  4941        MOVE SPACES              TO PFENTRBO
  4942        MOVE AL-UNNOF            TO PFENTRBA
  4943        MOVE ER-0045             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL1042.cbl
  4944        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4945        GO TO 8200-SEND-DATAONLY
  4946     END-IF
  4947     IF CREDIT-SESSION
  4948         MOVE 'EL1044'           TO PGM-NAME
  4949     ELSE
  4950         MOVE 'EL1041'           TO PGM-NAME
  4951     END-IF
  4952     GO TO 9300-XCTL
  4953     .
  4954 9500-PF12.
  4955     IF  ANY-UPDATES
  4956        MOVE -1       TO FUNCTL
  4957        MOVE SPACES   TO PFENTRBO
  4958        MOVE AL-UNNOF TO PFENTRBA
  4959        MOVE ER-0045  TO EMI-ERROR
  4960        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4961        GO TO 8200-SEND-DATAONLY.
  4962
  4963
  4964     MOVE 'EL010' TO PGM-NAME.
  4965     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL1042.cbl
  4967 9600-PGMID-ERROR.
  4968
  4969* EXEC CICS HANDLE CONDITION
  4970*         PGMIDERR(8300-SEND-TEXT)
  4971*     END-EXEC.
  4972*    MOVE '"$L                   ! ( #00004637' TO DFHEIV0
  4973     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4974     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4975     MOVE X'2820233030303034363337' TO DFHEIV0(25:11)
  4976     CALL 'kxdfhei1' USING DFHEIV0
  4977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4978
  4979
  4980     MOVE PGM-NAME     TO PI-CALLING-PROGRAM.
  4981     MOVE SPACES       TO PI-ENTRY-CD-1.
  4982     MOVE 'EL005'      TO PGM-NAME.
  4983     MOVE PGM-NAME     TO LOGOFF-PGM.
  4984     MOVE PGMIDERR-MSG TO LOGOFF-FILL.
  4985     GO TO 9300-XCTL.
  4986
  4987 9700-LINK-DATE-CONVERT.
  4988
  4989* EXEC CICS LINK
  4990*        PROGRAM    ('ELDATCV')
  4991*        COMMAREA   (DATE-CONVERSION-DATA)
  4992*        LENGTH     (DC-COMM-LENGTH)
  4993*    END-EXEC.
  4994     MOVE 'ELDATCV' TO DFHEIV1
  4995*    MOVE '."C                   ''   #00004649' TO DFHEIV0
  4996     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4997     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4998     MOVE X'2020233030303034363439' TO DFHEIV0(25:11)
  4999     CALL 'kxdfhei1' USING DFHEIV0,
  5000           DFHEIV1,
  5001           DATE-CONVERSION-DATA,
  5002           DC-COMM-LENGTH,
  5003           DFHEIV99,
  5004           DFHEIV99,
  5005           DFHEIV99
  5006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5007
  5008
  5009 9700-EXIT.
  5010     EXIT.
  5011
  5012 9900-ERROR-FORMAT.
  5013
  5014     MOVE PI-LANGUAGE-TYPE       TO EMI-LANGUAGE-IND.
  5015
  5016     IF  NOT EMI-ERRORS-COMPLETE
  5017
  5018* EXEC CICS LINK
  5019*            PROGRAM('EL001')
  5020*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  5021*            LENGTH(EMI-COMM-LENGTH)
  5022*        END-EXEC.
  5023     MOVE 'EL001' TO DFHEIV1
  5024*    MOVE '."C                   ''   #00004663' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL1042.cbl
  5025     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5026     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5027     MOVE X'2020233030303034363633' TO DFHEIV0(25:11)
  5028     CALL 'kxdfhei1' USING DFHEIV0,
  5029           DFHEIV1,
  5030           ERROR-MESSAGE-INTERFACE-BLOCK,
  5031           EMI-COMM-LENGTH,
  5032           DFHEIV99,
  5033           DFHEIV99,
  5034           DFHEIV99
  5035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5036
  5037
  5038 9900-EXIT.
  5039      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL1042.cbl
  5041 9910-INITIALIZE-SECURITY.
  5042******************************************************************
  5043*    THIS IS A COMBINED SECURITY PROCESSOR.                      *
  5044*                                                                *
  5045******************************************************************
  5046
  5047     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
  5048         GO TO 9910-EXIT.
  5049
  5050     IF  MORTGAGE-SESSION
  5051         MOVE '125E'                 TO SC-QUID-SYSTEM
  5052         MOVE EIBTRMID               TO SC-QUID-TERMINAL
  5053
  5054
  5055* EXEC CICS READQ TS
  5056*            QUEUE  (SC-QUID-KEY)
  5057*            INTO   (SECURITY-CONTROL-E)
  5058*            LENGTH (SC-COMM-LENGTH-E)
  5059*            ITEM   (SC-ITEM)
  5060*        END-EXEC
  5061*    MOVE '*$II   L              ''   #00004685' TO DFHEIV0
  5062     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5063     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5064     MOVE X'2020233030303034363835' TO DFHEIV0(25:11)
  5065     CALL 'kxdfhei1' USING DFHEIV0,
  5066           SC-QUID-KEY,
  5067           SECURITY-CONTROL-E,
  5068           SC-COMM-LENGTH-E,
  5069           SC-ITEM,
  5070           DFHEIV99,
  5071           DFHEIV99
  5072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5073
  5074         MOVE SC-MP-DISPLAY (W-APPL-SCRTY-NDX)
  5075                                     TO PI-DISPLAY-CAP
  5076         MOVE SC-MP-UPDATE (W-APPL-SCRTY-NDX)
  5077                                     TO PI-MODIFY-CAP
  5078
  5079         GO TO 9910-EXIT
  5080
  5081     ELSE
  5082
  5083* EXEC CICS READQ TS
  5084*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5085*            INTO   (SECURITY-CONTROL)
  5086*            LENGTH (SC-COMM-LENGTH)
  5087*            ITEM   (W-SC-ITEM)
  5088*        END-EXEC
  5089*    MOVE '*$II   L              ''   #00004700' TO DFHEIV0
  5090     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5091     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5092     MOVE X'2020233030303034373030' TO DFHEIV0(25:11)
  5093     CALL 'kxdfhei1' USING DFHEIV0,
  5094           PI-SECURITY-TEMP-STORE-ID,
  5095           SECURITY-CONTROL,
  5096           SC-COMM-LENGTH,
  5097           W-SC-ITEM,
  5098           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL1042.cbl
  5099           DFHEIV99
  5100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5101
  5102         MOVE SC-CREDIT-DISPLAY (03)  TO PI-DISPLAY-CAP
  5103         MOVE SC-CREDIT-UPDATE  (03)  TO PI-MODIFY-CAP.
  5104
  5105 9910-EXIT.
  5106     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL1042.cbl
  5108 9990-ABEND.
  5109     MOVE DFHEIBLK               TO EMI-LINE1.
  5110
  5111* EXEC CICS LINK
  5112*        PROGRAM   ('EL004')
  5113*        COMMAREA  (EMI-LINE1)
  5114*        LENGTH    (72)
  5115*    END-EXEC.
  5116     MOVE 'EL004' TO DFHEIV1
  5117     MOVE 72
  5118       TO DFHEIV11
  5119*    MOVE '."C                   ''   #00004715' TO DFHEIV0
  5120     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5121     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5122     MOVE X'2020233030303034373135' TO DFHEIV0(25:11)
  5123     CALL 'kxdfhei1' USING DFHEIV0,
  5124           DFHEIV1,
  5125           EMI-LINE1,
  5126           DFHEIV11,
  5127           DFHEIV99,
  5128           DFHEIV99,
  5129           DFHEIV99
  5130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5131
  5132
  5133     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGBO.
  5134     GO TO 8200-SEND-DATAONLY.
  5135
  5136
  5137* GOBACK.
  5138     MOVE '9%                    "   ' TO DFHEIV0
  5139     MOVE 'EL1042' TO DFHEIV1
  5140     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5141     GOBACK.
  5142
  5143 9995-SECURITY-VIOLATION.
  5144*                            COPY ELCSCTP.
  5145******************************************************************
  5146*                                                                *
  5147*                            ELCSCTP                             *
  5148*                            VMOD=2.001                          *
  5149*                                                                *
  5150*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5151******************************************************************
  5152
  5153
  5154     MOVE EIBDATE          TO SM-JUL-DATE.
  5155     MOVE EIBTRMID         TO SM-TERMID.
  5156     MOVE THIS-PGM         TO SM-PGM.
  5157     MOVE EIBTIME          TO TIME-IN.
  5158     MOVE TIME-OUT         TO SM-TIME.
  5159     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5160
  5161
  5162* EXEC CICS LINK
  5163*         PROGRAM  ('EL003')
  5164*         COMMAREA (SECURITY-MESSAGE)
  5165*         LENGTH   (80)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL1042.cbl
  5166*    END-EXEC.
  5167     MOVE 'EL003' TO DFHEIV1
  5168     MOVE 80
  5169       TO DFHEIV11
  5170*    MOVE '."C                   ''   #00004744' TO DFHEIV0
  5171     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5172     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5173     MOVE X'2020233030303034373434' TO DFHEIV0(25:11)
  5174     CALL 'kxdfhei1' USING DFHEIV0,
  5175           DFHEIV1,
  5176           SECURITY-MESSAGE,
  5177           DFHEIV11,
  5178           DFHEIV99,
  5179           DFHEIV99,
  5180           DFHEIV99
  5181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5182
  5183
  5184******************************************************************
  5185
  5186
  5187 9995-EXIT.
  5188     EXIT.
  5189
  5190
  5191 9999-DFHBACK SECTION.
  5192     MOVE '9%                    "   ' TO DFHEIV0
  5193     MOVE 'EL1042' TO DFHEIV1
  5194     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5195     GOBACK.
  5196 9999-DFHEXIT.
  5197     IF DFHEIGDJ EQUAL 0001
  5198         NEXT SENTENCE
  5199     ELSE IF DFHEIGDJ EQUAL 2
  5200         GO TO 9990-ABEND,
  5201               9600-PGMID-ERROR
  5202         DEPENDING ON DFHEIGDI
  5203     ELSE IF DFHEIGDJ EQUAL 3
  5204         GO TO 9400-CLEAR,
  5205               0100-PA,
  5206               0100-PA,
  5207               0100-PA
  5208         DEPENDING ON DFHEIGDI
  5209     ELSE IF DFHEIGDJ EQUAL 4
  5210         GO TO 4610-ENDBR,
  5211               6000-NOT-OPEN,
  5212               4610-ENDBR
  5213         DEPENDING ON DFHEIGDI
  5214     ELSE IF DFHEIGDJ EQUAL 5
  5215         GO TO 7010-ENDBR,
  5216               6000-NOT-OPEN,
  5217               7010-ENDBR
  5218         DEPENDING ON DFHEIGDI
  5219     ELSE IF DFHEIGDJ EQUAL 6
  5220         GO TO 7299-EXIT
  5221         DEPENDING ON DFHEIGDI
  5222     ELSE IF DFHEIGDJ EQUAL 7
  5223         GO TO 7590-TS-QIDERR,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL1042.cbl
  5224               7585-TS-ITEMERR
  5225         DEPENDING ON DFHEIGDI
  5226     ELSE IF DFHEIGDJ EQUAL 8
  5227         GO TO 8300-SEND-TEXT
  5228         DEPENDING ON DFHEIGDI.
  5229     MOVE '9%                    "   ' TO DFHEIV0
  5230     MOVE 'EL1042' TO DFHEIV1
  5231     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5232     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       31500     Code:       15776
