* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page   1
* ELRATE.cbl
* Options: int("ELRATE.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELRATE.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRATE.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRATE.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRATE.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:20:51.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.012
     9
    10*AUTHOR.     LOGIC, INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page   2
* ELRATE.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25******************************************************************
    26*  REMARKS   *                                                   *
    27*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    28*            *    OPTION SPECIFIED, COMPUTE PREMIUM AMOUNTS      *
    29*            *    AND RATES.                                     *
    30******************************************************************
    31
    32
    33******************************************************************
    34*                                                                *
    35*              INPUT FIELDS USED                                 *
    36*                                                                *
    37******************************************************************
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM    (RATING TERM)          *
    39*  CLASS CODE       - CP-CLASS-CODE                              *
    40*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    41*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    42*  RATING BENEFIT   - CP-RATING-BENEFIT-AMT (TOT BEN ON BALLOON) *
    43*  BENEFIT TYPE     - CP-BENEFIT-TYPE                            *
    44*  STATE CODE (NUM) - CP-STATE                                   *
    45*  STATE CODE       - CP-STATE-STD-ABBV                          *
    46*  COMPANY I.D.     - CP-COMPANY-ID                              *
    47*  COMPANY CD (NUM) - CP-COMPANY-CD                              *
    48*  INSURED AGE      - CP-ISSUE-AGE                               *
    49*  RATING METHOD    - CP-EARNING-METHOD                          *
    50*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    51*  A.P.R.           - CP-LOAN-APR                                *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    54*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page   3
* ELRATE.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELRATE  WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '***********VMOD 2.012 **********'.
    65
    66***  Y2K PROJ 7744
    67 01  WS-HOLD-RATE-EXP.
    68     05  WS-HOLD-RATE-EXP-AL PIC X(11).
    69     05  WS-HOLD-RATE-EXP-DT REDEFINES
    70         WS-HOLD-RATE-EXP-AL PIC 9(11).
    71***  Y2K PROJ 7744
    72
    73*                            COPY ELCRATWS.
    74******************************************************************
    75*                                                                *
    76*                                                                *
    77*                            ELCRATWS.                           *
    78*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    79*                            VMOD=2.010                          *
    80*                                                                *
    81******************************************************************
    82
    83 01  STANDARD-AREAS.
    84     12  ER-STATUS               PIC XX.
    85     12  WS-BROWSE-SW            PIC X       VALUE SPACE.
    86         88 WS-BROWSE-STARTED                VALUE 'Y'.
    87     12  WS-PREMIUM-RATE         PIC S99V9(5) COMP-3 VALUE ZERO.
    88     12  WS-FARM-TERM            PIC S9(3)    COMP-3 VALUE ZERO.
    89     12  OERATE-FILE-ID          PIC X(8)    VALUE 'OERATE'.
    90     12  ERRATE-FILE-ID          PIC X(8)    VALUE 'ERRATE'.
    91     12  ERRATE-KEY.
    92         16  RATE-COMPANY-CD     PIC X        VALUE SPACE.
    93         16  RATE-STATE-CODE.
    94             20  RATE-ST-CODE    PIC  XX      VALUE SPACES.
    95             20  RATE-ST-CLASS   PIC  XX      VALUE SPACES.
    96             20  RATE-ST-DEV     PIC  XXX     VALUE SPACES.
    97         16  RATE-L-AH-CODE.
    98             20  RATE-L-AH       PIC  X       VALUE SPACE.
    99             20  RATE-LAH-NUM    PIC  XX      VALUE ZEROS.
   100         16  RATE-LIMITS.
   101             20  RATE-HIGH-AGE   PIC  99      VALUE ZEROS.
   102             20  RATE-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   103             20  RATE-FUTURE     PIC  XX      VALUE SPACES.
   104             20  RATE-SEX        PIC  X       VALUE '9'.
   105         16  RATE-EXPIRY-DATE    PIC 9(11)    COMP-3.
   106
   107     12  SAVE-ERRATE-KEY.
   108         16  SVRT-COMPANY-CD     PIC X        VALUE SPACE.
   109         16  SVRT-STATE-CODE.
   110             20  SVRT-ST-CODE    PIC  XX      VALUE SPACES.
   111             20  SVRT-ST-CLASS   PIC  XX      VALUE SPACES.
   112             20  SVRT-ST-DEV     PIC  XXX     VALUE SPACES.
   113         16  SVRT-L-AH-CODE.
   114             20  SVRT-L-AH       PIC  X       VALUE SPACE.
   115             20  SVRT-LAH-NUM    PIC  XX      VALUE ZEROS.
   116         16  SVRT-LIMITS.
   117             20  SVRT-HIGH-AGE   PIC  99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page   4
* ELRATE.cbl
   118             20  SVRT-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   119             20  SVRT-FUTURE     PIC  XX      VALUE SPACES.
   120             20  SVRT-SEX        PIC  X       VALUE '9'.
   121         16  SVRT-EXPIRY-DATE    PIC  9(11)   COMP-3.
   122
   123     12  WS-SIN-PREM-RATE        PIC S99V9(07) VALUE +0.
   124     12  WS-TERM-MINUS-ONE       PIC S9(5)    COMP-3 VALUE +0.
   125
   126 01  CSL-WORK-AREAS          COMP-3.
   127     12  WK-C                PIC S9(3)V9(9)     VALUE ZEROS.
   128     12  WK-D                PIC S9(4)V9(9)     VALUE ZEROS.
   129     12  WK-J                PIC S999           VALUE ZEROS.
   130     12  WK-K                PIC S999           VALUE ZEROS.
   131     12  WK-L                PIC S99V9(9)       VALUE ZEROS.
   132     12  WK-S                PIC S999V9(4)      VALUE ZEROS.
   133     12  WK-T                PIC S999           VALUE ZEROS.
   134     12  WK-T1               PIC S999           VALUE ZEROS.
   135     12  WK-U                PIC S99V9(9)       VALUE ZEROS.
   136     12  WK-PREM             PIC S9(6)V999      VALUE ZEROS.
   137     12  WK-PAY-AMT          PIC S9(7)V99       VALUE ZEROS.
   138     12  WK-LEV-RATE         PIC S99V9(7)       VALUE ZEROS.
   139     12  WK-RED-RATE         PIC S99V9(7)       VALUE ZEROS.
   140     12  WK-DAILY-RATE       PIC S99V9(7)       VALUE ZEROS.
   141     12  WK-MONTHLY-RATE     PIC S99V9(7)       VALUE ZEROS.
   142     12  WK-MONTHLY-RATE-T   PIC S99V9(7)       VALUE ZEROS.
   143     12  WK-MONTHLY-RATE-J   PIC S99V9(7)       VALUE ZEROS.
   144     12  WS-MAX-TOT-BEN      PIC S9(7)V99       VALUE ZEROS.
   145     12  WS-MAX-MON-BEN      PIC S9(7)V99       VALUE ZEROS.
   146     12  WS-NUM-PAYMTS       PIC S9(5)          VALUE ZEROS.
   147     12  WS-PAY-SCH          PIC S99            VALUE ZEROS.
   148
   149 01  TEXAS-REG-WORK-AREAS.
   150     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.
   151     12  TEX-FACT-2          PIC S9(3)       COMP-3.
   152     12  TEX-FACT-3          PIC S9(3)       COMP-3.
   153     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   154     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   155     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   156     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   157     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   158     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   159
   160 01  NET-PAY-INTERFACE.
   161     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   162     12  N-P-ORIG            PIC S9(3)       COMP-3.
   163     12  N-P-REM             PIC S9(3)       COMP-3.
   164     12  N-P-OPT             PIC X.
   165     12  N-P-LOAN            PIC S9(3)       COMP-3.
   166     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   167
   168
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page   5
* ELRATE.cbl
   170*                            COPY ERCNETWS.
   171*****************************************************************
   172*                                                               *
   173*                                                               *
   174*                            ERCNETWS                           *
   175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   176*                            VMOD=2.014                         *
   177*                                                               *
   178*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   179*                                                               *
   180*****************************************************************.
   181*                   C H A N G E   L O G
   182*
   183* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   184*-----------------------------------------------------------------
   185*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   186* EFFECTIVE    NUMBER
   187*-----------------------------------------------------------------
   188* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   189* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   190* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   191* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   192* 050713  CR2008052200001  PEMA  ADD CODE FOR 0 PCT APR
   193******************************************************************
   194
   195 01  NET-PAY-WORK-AREA.
   196     12  OPTION-SW               PIC X   VALUE 'X'.
   197        88  NPO-STD         VALUE SPACE.
   198        88  NPO-ALT         VALUE 'A'.
   199        88  NPO-SIMPLE      VALUE 'S'.
   200        88  NPO-2MO         VALUE 'I'.
   201        88  NPO-3MO         VALUE 'J'.
   202        88  NPO-4MO         VALUE 'K'.
   203        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   204        88  NPO-TRUNC-0     VALUE 'T'.
   205        88  NPO-TRUNC-1     VALUE 'U'.
   206        88  NPO-TRUNC-2     VALUE 'V'.
   207        88  NPO-TRUNC-3     VALUE 'W'.
   208        88  NPO-TRUNC-4     VALUE 'X'.
   209        88  NPO-REFUND      VALUE 'R'.
   210        88  NPO-PRUDENTIAL  VALUE 'P'.
   211
   212     12  TYPE-SW             PIC X   VALUE 'N'.
   213        88  NET-STD             VALUE 'N'.
   214        88  NET-SMP             VALUE 'S'.
   215
   216     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   217        88  NP-RATING           VALUE '1'.
   218        88  NP-REFUND           VALUE '2'.
   219        88  NP-REMAIN-AMT       VALUE '3'.
   220
   221     12  COMP-3-WORK-AREA         COMP-3.
   222         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   223         16  V               PIC SV9(13)       VALUE +.0.
   224         16  J               PIC SV9(9)        VALUE +0.
   225         16  K               PIC SV9(9)        VALUE +0.
   226         16  I               PIC SV9(10)       VALUE +.0.
   227         16  D               PIC S9(5)         VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page   6
* ELRATE.cbl
   228         16  APR100          PIC SV9(9)        VALUE +.0.
   229         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   230         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   231         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
   232         16  pema            pic s9(2)v9(15)   value +0.
   233         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   234         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
   235         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   236         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   237         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   238         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   239         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   240         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   241         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   242         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   243         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   244         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   245         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   246         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   247         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   248         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   249         16  ANGLEMY         PIC S9(5)V9(13)   VALUE +.0.
   250         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   251         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   252         16  ANGLENY         PIC S9(5)V9(13)   VALUE +.0.
   253         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   254         16  ANGLEN-MP1      PIC S9(5)V9(13)   VALUE +.0.
   255         16  ANGLEN-MP1Y     PIC S9(5)V9(13)   VALUE +.0.
   256         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   257         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   258         16  ANGLEM-1Y       PIC S9(7)V9(10)   VALUE +.0.
   259         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   260         16  PVBALLOON       PIC S9(7)V99      VALUE +.0.
   261         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   262         16  K1              PIC S999          VALUE +1.
   263         16  K12             PIC S999          VALUE +12.
   264         16  K100            PIC S999          VALUE +100.
   265         16  K1000           PIC S9(7)         VALUE +1000.
   266         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   267         16  Y REDEFINES NC-LR
   268                             PIC S99V9(5).
   269         16  TI              PIC S999V9(5)     VALUE +0.
   270         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   271         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   272         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   273         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   274         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   275         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   276         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   277         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   278
   279         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   280         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   281         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   282         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   283         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   284         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   285         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page   7
* ELRATE.cbl
   286         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   287         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   288         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   289         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
   290         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   291         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   292
   293         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
   294
   295         16  ORIGINAL-TERM   PIC S999.
   296         16  M              REDEFINES ORIGINAL-TERM
   297                             PIC S999.
   298
   299         16  REMAINING-TERM  PIC S999.
   300         16  R              REDEFINES REMAINING-TERM
   301                             PIC S999.
   302
   303         16  LOAN-TERM       PIC S999.
   304         16  N              REDEFINES LOAN-TERM
   305                             PIC S999.
   306
   307         16  EXPIRED-TERM    PIC S999.
   308         16  E              REDEFINES EXPIRED-TERM
   309                             PIC S999.
   310
   311         16  PRUDENTIAL-WORK-AMT
   312                             PIC S9(7)V9(8).
   313         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   314                             PIC S9(7)V9(8).
   315
   316         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   317         16  VX              PIC S9V9(13)      VALUE +0.0.
   318         16  SV              PIC S9V9(13)      VALUE +0.0.
   319         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   320         16  SX              PIC S9V9(13)      VALUE +0.0.
   321         16  SE              PIC S9V9(10)      VALUE +0.0.
   322         16  N2              PIC S9(7)         VALUE +0.
   323         16  N3              PIC S9(7)         VALUE +0.
   324         16  K-I             PIC S9V9(8)       VALUE +0.0.
   325
   326     12  BINARY-WORK-AREA        COMP.
   327         16  X1              PIC S999        VALUE +0.
   328         16  X2              PIC S999        VALUE +0.
   329         16  MAX-X           PIC S9(5)       VALUE +0.
   330         16  B1              PIC S9(5)       VALUE +1.
   331         16  LINDX           PIC S999        VALUE ZEROS.
   332         16  AHNDX           PIC S999        VALUE ZEROS.
   333
   334     12  CSO-RATE-WORK-AREAS.
   335         16  C-PMTS-PER-YEAR     PIC S999V99 COMP-3 VALUE ZEROS.
   336         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   337         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   338     12  WS-WORK-MISC.
   339         16  ws-extra-pmts       pic s999         comp-3.
   340         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   341         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   342*        16  WS-AGE              PIC 99           VALUE ZEROS.
   343         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page   8
* ELRATE.cbl
   344         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   345         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   346         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   347         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
   348         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   349         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   350         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   351         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   352         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
   353         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   354         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   355******************************************************************
   356
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page   9
* ELRATE.cbl
   358*                            COPY ELCDATE.
   359******************************************************************
   360*                                                                *
   361*                                                                *
   362*                            ELCDATE.                            *
   363*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   364*                            VMOD=2.003
   365*                                                                *
   366*                                                                *
   367*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   368*                 LENGTH = 200                                   *
   369******************************************************************
   370
   371 01  DATE-CONVERSION-DATA.
   372     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   373     12  DC-OPTION-CODE                PIC X.
   374         88  BIN-TO-GREG                VALUE ' '.
   375         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   376         88  EDIT-GREG-TO-BIN           VALUE '2'.
   377         88  YMD-GREG-TO-BIN            VALUE '3'.
   378         88  MDY-GREG-TO-BIN            VALUE '4'.
   379         88  JULIAN-TO-BIN              VALUE '5'.
   380         88  BIN-PLUS-ELAPSED           VALUE '6'.
   381         88  FIND-CENTURY               VALUE '7'.
   382         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   383         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   384         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   385         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   386         88  JULIAN-TO-BIN-3            VALUE 'C'.
   387         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   388         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   389         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   390         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   391         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   392         88  CHECK-LEAP-YEAR            VALUE 'H'.
   393         88  BIN-3-TO-GREG              VALUE 'I'.
   394         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   395         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   396         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   397         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   398         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   399         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   400         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   401         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   402         88  THREE-CHARACTER-BIN
   403                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   404         88  GREGORIAN-TO-BIN
   405                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   406         88  BIN-TO-GREGORIAN
   407                  VALUES ' ' '1' 'I' '8' 'G'.
   408         88  JULIAN-TO-BINARY
   409                  VALUES '5' 'C' 'E' 'F'.
   410     12  DC-ERROR-CODE                 PIC X.
   411         88  NO-CONVERSION-ERROR        VALUE ' '.
   412         88  DATE-CONVERSION-ERROR
   413                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   414         88  DATE-IS-ZERO               VALUE '1'.
   415         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  10
* ELRATE.cbl
   416         88  DATE-IS-INVALID            VALUE '3'.
   417         88  DATE1-GREATER-DATE2        VALUE '4'.
   418         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   419         88  DATE-INVALID-OPTION        VALUE '9'.
   420         88  INVALID-CENTURY            VALUE 'A'.
   421         88  ONLY-CENTURY               VALUE 'B'.
   422         88  ONLY-LEAP-YEAR             VALUE 'C'.
   423         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   424     12  DC-END-OF-MONTH               PIC X.
   425         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   426     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   427         88  USE-NORMAL-PROCESS         VALUE ' '.
   428         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   429         88  ADJUST-UP-100-YRS          VALUE '2'.
   430     12  FILLER                        PIC X.
   431     12  DC-CONVERSION-DATES.
   432         16  DC-BIN-DATE-1             PIC XX.
   433         16  DC-BIN-DATE-2             PIC XX.
   434         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   435         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   436                       DC-GREG-DATE-1-EDIT.
   437             20  DC-EDIT1-MONTH        PIC 99.
   438             20  SLASH1-1              PIC X.
   439             20  DC-EDIT1-DAY          PIC 99.
   440             20  SLASH1-2              PIC X.
   441             20  DC-EDIT1-YEAR         PIC 99.
   442         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   443         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   444                     DC-GREG-DATE-2-EDIT.
   445             20  DC-EDIT2-MONTH        PIC 99.
   446             20  SLASH2-1              PIC X.
   447             20  DC-EDIT2-DAY          PIC 99.
   448             20  SLASH2-2              PIC X.
   449             20  DC-EDIT2-YEAR         PIC 99.
   450         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   451         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   452                     DC-GREG-DATE-1-YMD.
   453             20  DC-YMD-YEAR           PIC 99.
   454             20  DC-YMD-MONTH          PIC 99.
   455             20  DC-YMD-DAY            PIC 99.
   456         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   457         16  DC-GREG-DATE-1-MDY-R REDEFINES
   458                      DC-GREG-DATE-1-MDY.
   459             20  DC-MDY-MONTH          PIC 99.
   460             20  DC-MDY-DAY            PIC 99.
   461             20  DC-MDY-YEAR           PIC 99.
   462         16  DC-GREG-DATE-1-ALPHA.
   463             20  DC-ALPHA-MONTH        PIC X(10).
   464             20  DC-ALPHA-DAY          PIC 99.
   465             20  FILLER                PIC XX.
   466             20  DC-ALPHA-CENTURY.
   467                 24 DC-ALPHA-CEN-N     PIC 99.
   468             20  DC-ALPHA-YEAR         PIC 99.
   469         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   470         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   471         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   472         16  DC-JULIAN-DATE            PIC 9(05).
   473         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  11
* ELRATE.cbl
   474                                       PIC 9(05).
   475         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   476             20  DC-JULIAN-YEAR        PIC 99.
   477             20  DC-JULIAN-DAYS        PIC 999.
   478         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   479         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   480         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   481     12  DATE-CONVERSION-VARIBLES.
   482         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   483         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   484             20  FILLER                PIC 9(3).
   485             20  HOLD-CEN-1-CCYY.
   486                 24  HOLD-CEN-1-CC     PIC 99.
   487                 24  HOLD-CEN-1-YY     PIC 99.
   488             20  HOLD-CEN-1-MO         PIC 99.
   489             20  HOLD-CEN-1-DA         PIC 99.
   490         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   491             20  HOLD-CEN-1-R-MO       PIC 99.
   492             20  HOLD-CEN-1-R-DA       PIC 99.
   493             20  HOLD-CEN-1-R-CCYY.
   494                 24  HOLD-CEN-1-R-CC   PIC 99.
   495                 24  HOLD-CEN-1-R-YY   PIC 99.
   496             20  FILLER                PIC 9(3).
   497         16  HOLD-CENTURY-1-X.
   498             20  FILLER                PIC X(3)  VALUE SPACES.
   499             20  HOLD-CEN-1-X-CCYY.
   500                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   501                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   502             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   503             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   504         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   505             20  HOLD-CEN-1-R-X-MO     PIC XX.
   506             20  HOLD-CEN-1-R-X-DA     PIC XX.
   507             20  HOLD-CEN-1-R-X-CCYY.
   508                 24  HOLD-CEN-1-R-X-CC PIC XX.
   509                 24  HOLD-CEN-1-R-X-YY PIC XX.
   510             20  FILLER                PIC XXX.
   511         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   512         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   513         16  DC-JULIAN-DATE-1          PIC 9(07).
   514         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   515             20  DC-JULIAN-1-CCYY.
   516                 24  DC-JULIAN-1-CC    PIC 99.
   517                 24  DC-JULIAN-1-YR    PIC 99.
   518             20  DC-JULIAN-DA-1        PIC 999.
   519         16  DC-JULIAN-DATE-2          PIC 9(07).
   520         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   521             20  DC-JULIAN-2-CCYY.
   522                 24  DC-JULIAN-2-CC    PIC 99.
   523                 24  DC-JULIAN-2-YR    PIC 99.
   524             20  DC-JULIAN-DA-2        PIC 999.
   525         16  DC-GREG-DATE-A-EDIT.
   526             20  DC-EDITA-MONTH        PIC 99.
   527             20  SLASHA-1              PIC X VALUE '/'.
   528             20  DC-EDITA-DAY          PIC 99.
   529             20  SLASHA-2              PIC X VALUE '/'.
   530             20  DC-EDITA-CCYY.
   531                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  12
* ELRATE.cbl
   532                 24  DC-EDITA-YEAR     PIC 99.
   533         16  DC-GREG-DATE-B-EDIT.
   534             20  DC-EDITB-MONTH        PIC 99.
   535             20  SLASHB-1              PIC X VALUE '/'.
   536             20  DC-EDITB-DAY          PIC 99.
   537             20  SLASHB-2              PIC X VALUE '/'.
   538             20  DC-EDITB-CCYY.
   539                 24  DC-EDITB-CENT     PIC 99.
   540                 24  DC-EDITB-YEAR     PIC 99.
   541         16  DC-GREG-DATE-CYMD         PIC 9(08).
   542         16  DC-GREG-DATE-CYMD-R REDEFINES
   543                              DC-GREG-DATE-CYMD.
   544             20  DC-CYMD-CEN           PIC 99.
   545             20  DC-CYMD-YEAR          PIC 99.
   546             20  DC-CYMD-MONTH         PIC 99.
   547             20  DC-CYMD-DAY           PIC 99.
   548         16  DC-GREG-DATE-MDCY         PIC 9(08).
   549         16  DC-GREG-DATE-MDCY-R REDEFINES
   550                              DC-GREG-DATE-MDCY.
   551             20  DC-MDCY-MONTH         PIC 99.
   552             20  DC-MDCY-DAY           PIC 99.
   553             20  DC-MDCY-CEN           PIC 99.
   554             20  DC-MDCY-YEAR          PIC 99.
   555    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   556        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   557    12  DC-EL310-DATE                  PIC X(21).
   558    12  FILLER                         PIC X(28).
   559
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  13
* ELRATE.cbl
   561*                            COPY ELCCALC.
   562******************************************************************
   563*                                                                *
   564*                           ELCCALC.                            *
   565*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   566*                            VMOD=2.025                          *
   567*                                                                *
   568*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   569*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   570*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   571*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   572*                                                                *
   573*  PASSED TO ELRTRM                                              *
   574*  -----------------                                             *
   575*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   576*  ORIGINAL TERM                                                 *
   577*  BEGINNING DATE                                                *
   578*  ENDING DATE                                                   *
   579*  COMPANY I.D.                                                  *
   580*  ACCOUNT MASTER USER FIELD                                     *
   581*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   582*  FREE LOOK DAYS                                                *
   583*                                                                *
   584*  RETURNED FROM ELRTRM                                          *
   585*  ---------------------                                         *
   586*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   587*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   588*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   589*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   590*----------------------------------------------------------------*
   591*  PASSED TO ELRAMT                                              *
   592*  ----------------                                              *
   593*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   594*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   595*  ORIGINAL AMOUNT                                               *
   596*  ALTERNATE BENEFIT (BALLON)                                    *
   597*  A.P.R. - NET PAY ONLY                                         *
   598*  METHOD
   599*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   600*  COMPANY I.D.                                                  *
   601*  BENEFIT TYPE                                                  *
   602*                                                                *
   603*  RETURNED FROM ELRAMT                                          *
   604*  --------------------                                          *
   605*  REMAINING AMOUNT 1 - CURRENT                                  *
   606*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   607*  REMAINING AMOUNT FACTOR
   608*----------------------------------------------------------------*
   609*  PASSED TO ELRESV                                              *
   610*  -----------------                                             *
   611*  CERTIFICATE EFFECTIVE DATE                                    *
   612*  VALUATION DATE                                                *
   613*  PAID THRU DATE                                                *
   614*  BENEFIT                                                       *
   615*  INCURRED DATE                                                 *
   616*  REPORTED DATE                                                 *
   617*  ISSUE AGE                                                     *
   618*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  14
* ELRATE.cbl
   619*  CDT PERCENT                                                   *
   620*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   621* *CLAIM TYPE (LIFE, A/H)                                        *
   622* *REMAINING BENEFIT (FROM ELRAMT)                               *
   623* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   624*                                                                *
   625*  RETURNED FROM ELRESV                                          *
   626*  --------------------                                          *
   627*  CDT TABLE USED                                                *
   628*  CDT FACTOR USED                                               *
   629*  PAY TO CURRENT RESERVE                                        *
   630*  I.B.N.R. - A/H ONLY                                           *
   631*  FUTURE (ACCRUED) AH ONLY                                      *
   632*----------------------------------------------------------------*
   633*  PASSED TO ELRATE                                              *
   634*  ----------------                                              *
   635*  CERT ISSUE DATE                                               *
   636*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   637*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   638*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   639*  STATE CODE (CLIENT DEFINED)                                   *
   640*  STATE CODE (STANDARD P.O. ABBRV)                              *
   641*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   642*  DEVIATION CODE                                                *
   643*  ISSUE AGE                                                     *
   644*  ORIGINAL BENEFIT AMOUNT                                       *
   645*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   646*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   647*  BENEFIT KIND (LIFE OR A/H)                                    *
   648*  A.P.R.                                                        *
   649*  METHOD
   650*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   651*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   652*  COMPANY I.D. (3 CHARACTER)                                    *
   653*  BENEFIT CODE                                                  *
   654*  BENEFIT OVERRIDE CODE                                         *
   655*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   656*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   657*  JOINT INDICATOR (CSL ONLY)                                    *
   658*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   659*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   660*                                                                *
   661*  RETURNED FROM ELRATE                                          *
   662*  --------------------                                          *
   663*  CALCULATED PREMIUM                                            *
   664*  PREMIUM RATE                                                  *
   665*  MORTALITY CODE                                                *
   666*  MAX ATTAINED AGE                                              *
   667*  MAX AGE                                                       *
   668*  MAX TERM                                                      *
   669*  MAX MONTHLY BENEFIT                                           *
   670*  MAX TOTAL BENIFIT                                             *
   671*  COMPOSITE RATE (OPEN-END ONLY)                                *
   672*----------------------------------------------------------------*
   673*  PASSED TO ELRFND                                              *
   674*  ----------------                                              *
   675*  CERT ISSUE DATE                                               *
   676*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  15
* ELRATE.cbl
   677*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   678*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   679*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   680*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   681*  STATE CODE (CLIENT DEFINED)                                   *
   682*  STATE CODE (STANDARD P.O. ABBRV)                              *
   683*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   684*  DEVIATION CODE                                                *
   685*  ISSUE AGE                                                     *
   686*  ORIGINAL BENEFIT AMOUNT                                       *
   687*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   688*  PROCESS TYPE (CANCEL)                                         *
   689*  BENEFIT KIND (LIFE OR A/H)                                    *
   690*  A.P.R.                                                        *
   691*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   692*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   693*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   694*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   695*  COMPANY I.D. (3 CHARACTER)                                    *
   696*  BENEFIT CODE                                                  *
   697*  BENEFIT OVERRIDE CODE                                         *
   698*                                                                *
   699*  RETURNED FROM ELRFND                                          *
   700*  --------------------                                          *
   701*  CALCULATED REFUND                                             *
   702*----------------------------------------------------------------*
   703*  PASSED TO ELEARN                                              *
   704*  ----------------                                              *
   705*  CERT ISSUE DATE                                               *
   706*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   707*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   708*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   709*  STATE CODE (CLIENT DEFINED)                                   *
   710*  STATE CODE (STANDARD P.O. ABBRV)                              *
   711*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   712*  DEVIATION CODE                                                *
   713*  ISSUE AGE                                                     *
   714*  ORIGINAL BENEFIT AMOUNT                                       *
   715*  BENEFIT KIND (LIFE OR A/H)                                    *
   716*  A.P.R.                                                        *
   717*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   718*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   719*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   720*  COMPANY I.D. (3 CHARACTER)                                    *
   721*  BENEFIT CODE                                                  *
   722*  BENEFIT OVERRIDE CODE                                         *
   723*                                                                *
   724*  RETURNED FROM ELEARN                                          *
   725*  --------------------                                          *
   726*  INDICATED  EARNINGS                                           *
   727*----------------------------------------------------------------*
   728*                 LENGTH = 450                                   *
   729*                                                                *
   730******************************************************************
   731******************************************************************
   732*                   C H A N G E   L O G
   733*
   734* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  16
* ELRATE.cbl
   735*-----------------------------------------------------------------
   736*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   737* EFFECTIVE    NUMBER
   738*-----------------------------------------------------------------
   739* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   740* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   741* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   742* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   743* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   744* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   745* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   746* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   747* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   748* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   749* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   750* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.
   751******************************************************************
   752
   753 01  CALCULATION-PASS-AREA.
   754     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   755                                     COMP.
   756
   757     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   758       88  NO-CP-ERROR                             VALUE ZERO.
   759       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   760                                  '9' 'A' 'B' 'C' 'D' 'E' 'H' 'I'.
   761       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   762       88  CP-ERROR-IN-DATES                       VALUE '2'.
   763       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   764       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   765       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   766       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   767       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   768       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   769       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   770       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   771       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   772       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   773       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   774       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   775       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   776       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   777       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   778       88  CP-ERROR-TERM-BELOW-MINIMUM             VALUE 'I'.
   779
   780     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   781       88  NO-CP-ERROR-2                           VALUE ZERO.
   782***********************  INPUT AREAS ****************************
   783
   784     12  CP-CALCULATION-AREA.
   785         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   786         16  CP-CERT-EFF-DT        PIC XX.
   787         16  CP-VALUATION-DT       PIC XX.
   788         16  CP-PAID-THRU-DT       PIC XX.
   789         16  CP-BENEFIT-TYPE       PIC X.
   790           88  CP-AH                               VALUE 'A' 'D'
   791                                                   'I' 'U'.
   792           88  CP-REDUCING-LIFE                    VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  17
* ELRATE.cbl
   793           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   794         16  CP-INCURRED-DT        PIC XX.
   795         16  CP-REPORTED-DT        PIC XX.
   796         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   797         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   798         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   799                                     COMP-3.
   800         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   801                                     COMP-3.
   802         16  CP-CDT-METHOD         PIC X.
   803           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   804           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   805           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   806         16  CP-CLAIM-TYPE         PIC X.
   807           88  CP-AH-CLAIM                         VALUE 'A'.
   808           88  CP-LIFE-CLAIM                       VALUE 'L'.
   809         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   810                                     COMP-3.
   811         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   812                                     COMP-3.
   813         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   814                                     COMP-3.
   815         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   816                                     COMP-3.
   817         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   818                                     COMP-3.
   819         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   820                                     COMP-3.
   821         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   822                                     COMP-3.
   823         16  CP-REM-TERM-METHOD    PIC X.
   824           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   825           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   826           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   827           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   828           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   829           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   830           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   831         16  CP-EARNING-METHOD     PIC X.
   832           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   833           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   834           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   835           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   836           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   837           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   838           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   839           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   840           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   841           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   842           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   843           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   844           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   845           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   846         16  CP-PROCESS-TYPE       PIC X.
   847           88  CP-CLAIM                            VALUE '1'.
   848           88  CP-CANCEL                           VALUE '2'.
   849           88  CP-ISSUE                            VALUE '3'.
   850         16  CP-SPECIAL-CALC-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  18
* ELRATE.cbl
   851           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   852           88  CP-1-MTH-INTEREST               VALUE ' '.
   853           88  CP-0-MTH-INTEREST               VALUE 'A'.
   854           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   855           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   856           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   857           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   858           88  CP-FARM-PLAN                    VALUE 'F'.
   859           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   860           88  CP-2-MTH-INTEREST               VALUE 'I'.
   861           88  CP-3-MTH-INTEREST               VALUE 'J'.
   862           88  CP-4-MTH-INTEREST               VALUE 'K'.
   863           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   864           88  CP-MORTGAGE-REC                 VALUE 'M'.
   865           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   866           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   867           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   868           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   869                                                     'W' 'X'.
   870           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   871           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   872           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   873           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   874           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   875           88  CP-SUMMARY-REC                  VALUE 'Z'.
   876           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   877           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   878           88  CP-AD-D-BENEFIT                 VALUE '4'.
   879           88  CP-CSL-METH-1                   VALUE '5'.
   880           88  CP-CSL-METH-2                   VALUE '6'.
   881           88  CP-CSL-METH-3                   VALUE '7'.
   882           88  CP-CSL-METH-4                   VALUE '8'.
   883
   884         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   885                                     COMP-3.
   886         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   887         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   888         16  CP-STATE              PIC XX          VALUE SPACE.
   889         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   890         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   891           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   892               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   893         16  CP-R78-OPTION         PIC X.
   894           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   895           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   896
   897         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   898         16  CP-IBNR-RESERVE-SW    PIC X.
   899         16  CP-CLAIM-STATUS       PIC X.
   900         16  CP-RATE-FILE          PIC X.
   901         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   902                                     COMP-3.
   903
   904         16  CP-LIFE-OVERRIDE-CODE PIC X.
   905         16  CP-AH-OVERRIDE-CODE   PIC X.
   906
   907         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   908                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  19
* ELRATE.cbl
   909         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   910                                   PIC S9(5)V99 COMP-3.
   911         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   912                                     COMP-3.
   913         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   914                                     COMP-3.
   915         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   916                                     COMP-3.
   917         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   918                                  PIC S9(7)V99 COMP-3.
   919
   920         16  CP-PAID-FROM-DATE     PIC X(02).
   921         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   922         16  CP-EXT-DAYS-CALC      PIC X.
   923           88  CP-EXT-NO-CHG                   VALUE ' '.
   924           88  CP-EXT-CHG-LF                   VALUE '1'.
   925           88  CP-EXT-CHG-AH                   VALUE '2'.
   926           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   927         16  CP-DOMICILE-STATE     PIC XX.
   928         16  CP-CARRIER            PIC X.
   929         16  CP-REIN-FLAG          PIC X.
   930         16  CP-REM-TRM-CALC-OPTION PIC X.
   931           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   932                      '2' '3' '4' '5'.
   933           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   934           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   935           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   936           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   937           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   938           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   939           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   940           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   941         16  CP-SIG-SWITCH         PIC X.
   942         16  CP-RATING-METHOD      PIC X.
   943           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   944           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   945           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   946           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   947           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   948           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   949           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   950           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   951           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   952         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   953                                     COMP-3.
   954         16  CP-BEN-CATEGORY       PIC X.
   955         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   956         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   957                                   PIC S99V9(5) COMP-3.
   958         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   959         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   960                                   PIC S99V9(5) COMP-3.
   961         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   962         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   963         16  CP-EXPIRE-DT          PIC XX.
   964         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   965         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   966         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  20
* ELRATE.cbl
   967         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   968         16  CP-DDF-SPEC-CALC      PIC X.
   969             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   970             88  CP-CALC-CLP              VALUE 'C'.
   971         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   972         16  CP-CANCEL-REASON      PIC X.
   973         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   974         16  CP-PMT-MODE           PIC X.
   975         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   976         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   977         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   978         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   979         16  FILLER                PIC X.
   980
   981***************    OUTPUT FROM ELRESV   ************************
   982
   983         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   984
   985         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   986                                     COMP-3.
   987         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   988                                     COMP-3.
   989         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   990                                     COMP-3.
   991         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   992                                     COMP-3.
   993         16  FILLER                PIC X(09).
   994***************    OUTPUT FROM ELRTRM   *************************
   995
   996         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   997                                     COMP-3.
   998         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   999                                     COMP-3.
  1000         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1001                                     COMP-3.
  1002         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1003                                     COMP-3.
  1004         16  FILLER                PIC X(12).
  1005
  1006***************    OUTPUT FROM ELRAMT   *************************
  1007
  1008         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1009                                     COMP-3.
  1010         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1011                                     COMP-3.
  1012         16  FILLER                PIC X(12).
  1013
  1014***************    OUTPUT FROM ELRATE   *************************
  1015
  1016         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1017                                     COMP-3.
  1018         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1019                                     COMP-3.
  1020         16  CP-MORTALITY-CODE     PIC X(4).
  1021         16  CP-RATE-EDIT-FLAG     PIC X.
  1022             88  CP-RATES-NEED-APR                  VALUE '1'.
  1023         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1024                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  21
* ELRATE.cbl
  1025         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1026         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1027         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1028                                   PIC S9(7)V99 COMP-3.
  1029         16  FILLER                PIC X(07).
  1030
  1031***************    OUTPUT FROM ELRFND   *************************
  1032
  1033         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1034                                     COMP-3.
  1035         16  CP-REFUND-TYPE-USED   PIC X.
  1036           88  CP-R-AS-R78                         VALUE '1'.
  1037           88  CP-R-AS-PRORATA                     VALUE '2'.
  1038           88  CP-R-AS-CALIF                       VALUE '3'.
  1039           88  CP-R-AS-TEXAS                       VALUE '4'.
  1040           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1041           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1042           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1043           88  CP-R-AS-MEAN                        VALUE '8'.
  1044           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1045           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1046           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1047           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1048           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1049           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1050         16  FILLER                PIC X(12).
  1051
  1052***************    OUTPUT FROM ELEARN   *************************
  1053
  1054         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1055                                     COMP-3.
  1056         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1057                                     COMP-3.
  1058         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1059                                     COMP-3.
  1060         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1061                                     COMP-3.
  1062         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1063                                     COMP-3.
  1064         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1065                                     COMP-3.
  1066         16  CP-EARNING-TYPE-USED  PIC X.
  1067           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1068           88  CP-E-AS-R78                         VALUE '1'.
  1069           88  CP-E-AS-PRORATA                     VALUE '2'.
  1070           88  CP-E-AS-TEXAS                       VALUE '4'.
  1071           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1072           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1073           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1074           88  CP-E-AS-MEAN                        VALUE '8'.
  1075           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1076         16  FILLER                PIC X(12).
  1077
  1078***************    OUTPUT FROM ELPMNT   *************************
  1079
  1080         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1081                                     COMP-3.
  1082         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  22
* ELRATE.cbl
  1083                                     COMP-3.
  1084         16  FILLER                PIC X(12).
  1085
  1086***************   MISC WORK AREAS    *****************************
  1087         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1088                                     COMP-3.
  1089         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1090                                     COMP-3.
  1091         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1092                                     COMP-3.
  1093         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1094                                     COMP-3.
  1095         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1096                                     COMP-3.
  1097         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1098                                     COMP-3.
  1099         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1100             88  OPEN-RATE-FILE                   VALUE 'O'.
  1101             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1102             88  IO-ERROR                         VALUE 'E'.
  1103
  1104         16  CP-FIRST-PAY-DATE     PIC XX.
  1105
  1106         16  CP-JOINT-INDICATOR    PIC X.
  1107
  1108         16  CP-RESERVE-REMAINING-TERM
  1109                                   PIC S9(4)V9    VALUE ZERO
  1110                                     COMP-3.
  1111
  1112         16  CP-INSURED-BIRTH-DT   PIC XX.
  1113
  1114         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1115                                     COMP-3.
  1116
  1117         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1118                                     COMP-3.
  1119
  1120         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1121                                     COMP-3.
  1122
  1123         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1124                                     COMP-3.
  1125
  1126         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1127                                     COMP-3.
  1128
  1129         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1130                                     COMP-3.
  1131
  1132         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1133                                     COMP-3.
  1134
  1135         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1136             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1137
  1138         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1139                                     COMP-3.
  1140         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  23
* ELRATE.cbl
  1141                                     COMP-3.
  1142         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1143         16  cp-extra-periods      pic 9 value zeros.
  1144         16  cp-net-only-state     pic x value spaces.
  1145         16  FILLER                PIC X(13).
  1146******************************************************************
  1147
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  24
* ELRATE.cbl
  1149****************************************************************
  1150*
  1151* Copyright (c) 2007-2013 Dell Inc.
  1152* All rights reserved.
  1153*
  1154****************************************************************
  1155 01  DFHEIV.
  1156   02  DFHEIV0               PIC X(35).
  1157   02  DFHEIV1               PIC X(08).
  1158   02  DFHEIV2               PIC X(08).
  1159   02  DFHEIV3               PIC X(08).
  1160   02  DFHEIV4               PIC X(06).
  1161   02  DFHEIV5               PIC X(04).
  1162   02  DFHEIV6               PIC X(04).
  1163   02  DFHEIV7               PIC X(02).
  1164   02  DFHEIV8               PIC X(02).
  1165   02  DFHEIV9               PIC X(01).
  1166   02  DFHEIV10              PIC S9(7) COMP-3.
  1167   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1168   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1169   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1170   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1171   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1172   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1173   02  DFHEIV17              PIC X(04).
  1174   02  DFHEIV18              PIC X(04).
  1175   02  DFHEIV19              PIC X(04).
  1176   02  DFHEIV20              USAGE IS POINTER.
  1177   02  DFHEIV21              USAGE IS POINTER.
  1178   02  DFHEIV22              USAGE IS POINTER.
  1179   02  DFHEIV23              USAGE IS POINTER.
  1180   02  DFHEIV24              USAGE IS POINTER.
  1181   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1182   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1183   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1184   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1185   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1186   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1187   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1188   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1189   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1190   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1191   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1192   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1193   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1194   02  FILLER                PIC X(02).
  1195   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1196   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1197   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1198   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1199   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1200   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1201   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1202 LINKAGE  SECTION.
  1203*****************************************************************
  1204*                                                               *
  1205* Copyright (c) 2007-2013 Dell Inc.                             *
  1206* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  25
* ELRATE.cbl
  1207*                                                               *
  1208*****************************************************************
  1209 01  dfheiblk.
  1210     02  eibtime          pic s9(7) comp-3.
  1211     02  eibdate          pic s9(7) comp-3.
  1212     02  eibtrnid         pic x(4).
  1213     02  eibtaskn         pic s9(7) comp-3.
  1214     02  eibtrmid         pic x(4).
  1215     02  dfheigdi         pic s9(4) comp.
  1216     02  eibcposn         pic s9(4) comp.
  1217     02  eibcalen         pic s9(4) comp.
  1218     02  eibaid           pic x(1).
  1219     02  eibfiller1       pic x(1).
  1220     02  eibfn            pic x(2).
  1221     02  eibfiller2       pic x(2).
  1222     02  eibrcode         pic x(6).
  1223     02  eibfiller3       pic x(2).
  1224     02  eibds            pic x(8).
  1225     02  eibreqid         pic x(8).
  1226     02  eibrsrce         pic x(8).
  1227     02  eibsync          pic x(1).
  1228     02  eibfree          pic x(1).
  1229     02  eibrecv          pic x(1).
  1230     02  eibsend          pic x(1).
  1231     02  eibatt           pic x(1).
  1232     02  eibeoc           pic x(1).
  1233     02  eibfmh           pic x(1).
  1234     02  eibcompl         pic x(1).
  1235     02  eibsig           pic x(1).
  1236     02  eibconf          pic x(1).
  1237     02  eiberr           pic x(1).
  1238     02  eibrldbk         pic x(1).
  1239     02  eiberrcd         pic x(4).
  1240     02  eibsynrb         pic x(1).
  1241     02  eibnodat         pic x(1).
  1242     02  eibfiller5       pic x(2).
  1243     02  eibresp          pic s9(8) comp.
  1244     02  eibresp2         pic s9(8) comp.
  1245     02  dfheigdj         pic s9(4) comp.
  1246     02  dfheigdk         pic s9(4) comp.
  1247 01  DFHCOMMAREA             PIC X(450).
  1248
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  26
* ELRATE.cbl
  1250*01 PARMLIST              COMP.
  1251*    02  FILLER              PIC S9(8).
  1252*    02  ERRATE-POINTER      PIC S9(8).
  1253
  1254*                                COPY ERCRATE.
  1255******************************************************************
  1256*                                                                *
  1257*                                                                *
  1258*                            ERCRATE                             *
  1259*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1260*                            VMOD=2.008                          *
  1261*                                                                *
  1262*   ONLINE CREDIT SYSTEM                                         *
  1263*                                                                *
  1264*   FILE DESCRIPTION = RATES MASTER FILE                         *
  1265*                                                                *
  1266*   FILE TYPE = VSAM,KSDS                                        *
  1267*   RECORD SIZE = 1765  RECFORM = FIXED                          *
  1268*                                                                *
  1269*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
  1270*       ALTERNATE PATH = NONE                                    *
  1271*                                                                *
  1272*   LOG = NO                                                     *
  1273*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1274*                                                                *
  1275******************************************************************
  1276******************************************************************
  1277*                   C H A N G E   L O G
  1278*
  1279* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1280*-----------------------------------------------------------------
  1281*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1282* EFFECTIVE    NUMBER
  1283*-----------------------------------------------------------------
  1284* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1285* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.
  1286******************************************************************
  1287
  1288 01  RATE-RECORD.
  1289     12  RT-RECORD-ID                      PIC XX.
  1290         88  VALID-RT-ID                      VALUE 'RT'.
  1291
  1292     12  RT-CONTROL-PRIMARY.
  1293         16  RT-COMPANY-CD                 PIC X.
  1294         16  RT-STATE-CODE.
  1295             20  RT-ST-CODE                PIC XX.
  1296             20  RT-ST-CLASS               PIC XX.
  1297             20  RT-ST-DEV                 PIC XXX.
  1298         16  RT-L-AH-CODE.
  1299             20  RT-L-AH                   PIC X.
  1300             20  RT-LAH-NUM                PIC XX.
  1301         16  RT-LIMITS.
  1302             20  RT-HIGH-AGE               PIC 99.
  1303             20  RT-HIGH-AMT               PIC 9(6).
  1304             20  RT-FUTURE                 PIC XX.
  1305             20  RT-SEX                    PIC X.
  1306         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.
  1307
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  27
* ELRATE.cbl
  1308     12  RT-MAINT-INFORMATION.
  1309         16  RT-LAST-MAINT-DT              PIC XX.
  1310         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1311         16  RT-LAST-MAINT-USER            PIC X(4).
  1312         16  FILLER                        PIC X(10).
  1313
  1314     12  RT-STRUCTURE-COMMENT              PIC X(50).
  1315     12  RT-RATE-COMMENT                   PIC X(50).
  1316
  1317     12  CSL-RESERVED                      PIC X(10).
  1318     12  FILLER                            PIC X(12).
  1319
  1320     12  RT-MAX-AGE                        PIC 99.
  1321
  1322     12  RT-LIFE-LIMS-FLDS.
  1323         16  RT-LIFE-MORT-CODE             PIC X(4).
  1324         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
  1325             20  RT-L-EX-AGE               PIC 99.
  1326             20  RT-L-EX-TERM              PIC S999       COMP-3.
  1327             20  RT-L-EX-FACE              PIC S9(7)      COMP-3.
  1328         16  RT-LIFE-TERM-MINS OCCURS 8.
  1329             20  RT-L-MIN-TERM             PIC S999       COMP-3.
  1330         16  FILLER                        PIC X(4).
  1331*        16  FILLER                        PIC X(20).
  1332
  1333     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.
  1334         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.
  1335             20  RT-AH-AGE                 PIC 99.
  1336             20  RT-AH-TERM                PIC S999       COMP-3.
  1337             20  RT-AH-BEN-M               PIC S9(5)      COMP-3.
  1338             20  RT-AH-BEN-F               PIC S9(7)      COMP-3.
  1339
  1340     12  RT-LIFE-RATES.
  1341         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
  1342
  1343     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.
  1344         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
  1345
  1346     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.
  1347
  1348     12  RT-DISCOUNT-OPTION                PIC X.
  1349         88  RT-DO-NOT-USE                     VALUE ' '.
  1350         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.
  1351         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.
  1352
  1353     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
  1354     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
  1355
  1356     12  RT-COMPOSITE-OPTION               PIC X.
  1357         88  RT-NO-COMPOSITE                   VALUE ' '.
  1358         88  RT-USE-COMPOSITE-RATE             VALUE '1'.
  1359
  1360     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
  1361
  1362     12  RT-CANCEL-FEE                     PIC S9(3)V99   COMP-3.
  1363     12  FILLER                            PIC X(13).
  1364
  1365     12  RT-TYPE-RATE                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  28
* ELRATE.cbl
  1366         88  RT-IS-STND                        VALUE ' ' 'S'.
  1367         88  RT-IS-OB                          VALUE 'O'.
  1368
  1369     12  RT-SRT-ALPHA                      PIC X.
  1370
  1371     12  RT-CONTROL-2.
  1372         16  RTC-1                         PIC X(7).
  1373         16  RTC-3                         PIC X(11).
  1374         16  RTC-4                         PIC 9(11) COMP-3.
  1375         16  RTC-2                         PIC X(3).
  1376******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  29
* ELRATE.cbl
  1378 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA RATE-RECORD.
  1379 0000-DFHEXIT SECTION.
  1380     MOVE '9#                    $   ' TO DFHEIV0.
  1381     MOVE 'ELRATE' TO DFHEIV1.
  1382     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1383
  1384     MOVE DFHCOMMAREA            TO  CALCULATION-PASS-AREA.
  1385
  1386 000-START-PREMIUM-CALC.
  1387     MOVE ZERO                   TO CP-RETURN-CODE
  1388                                    CP-CALC-PREMIUM
  1389                                    CP-PREMIUM-RATE
  1390                                    CP-cancel-FEE.
  1391
  1392     MOVE SPACES                 TO CP-MORTALITY-CODE.
  1393     MOVE ALL '9'                TO ERRATE-KEY.
  1394
  1395*    IF CP-RATE-FILE = 'O'
  1396*        MOVE OERATE-FILE-ID     TO ERRATE-FILE-ID.
  1397
  1398     MOVE CP-COMPANY-CD          TO RATE-COMPANY-CD.
  1399     MOVE CP-STATE               TO RATE-ST-CODE.
  1400     MOVE CP-CLASS-CODE          TO RATE-ST-CLASS.
  1401     MOVE CP-DEVIATION-CODE      TO RATE-ST-DEV.
  1402     MOVE CP-ISSUE-AGE           TO RATE-HIGH-AGE.
  1403
  1404     IF CP-RATING-BENEFIT-AMT NOT NUMERIC  OR
  1405        CP-RATING-BENEFIT-AMT = ZEROS
  1406         MOVE CP-ORIGINAL-BENEFIT    TO RATE-HIGH-AMT
  1407     ELSE
  1408         MOVE CP-RATING-BENEFIT-AMT  TO RATE-HIGH-AMT.
  1409
  1410     IF CP-AH
  1411         MOVE CP-AH-OVERRIDE-CODE     TO RATE-L-AH
  1412     ELSE
  1413         MOVE CP-LIFE-OVERRIDE-CODE   TO RATE-L-AH.
  1414
  1415     MOVE CP-BENEFIT-CD          TO RATE-LAH-NUM.
  1416     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1417     MOVE SPACE                  TO DC-OPTION-CODE.
  1418
  1419     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1420
  1421*** Y2K, PROJ 7744
  1422     IF NO-CONVERSION-ERROR
  1423         MOVE ZEROS                 TO RATE-EXPIRY-DATE
  1424                                       WS-HOLD-RATE-EXP-DT
  1425         MOVE DC-GREG-DATE-CYMD     TO WS-HOLD-RATE-EXP-AL(4:8)
  1426         MOVE WS-HOLD-RATE-EXP-DT   TO RATE-EXPIRY-DATE
  1427         MOVE ERRATE-KEY            TO SAVE-ERRATE-KEY
  1428     ELSE
  1429         MOVE '2'                   TO CP-RETURN-CODE
  1430         GO TO 9999-CALC-RATE-PREM-X
  1431     END-IF.
  1432*** Y2K, PROJ 7744
  1433
  1434
  1435* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  30
* ELRATE.cbl
  1436*        NOTFND   (9999-RATE-NOTFND)
  1437*        NOTOPEN  (9999-RATE-NOTOPEN)
  1438*        ENDFILE  (9999-RATE-NOTFND)
  1439*    END-EXEC.
  1440*    MOVE '"$IJ''                 ! " #00001430' TO DFHEIV0
  1441     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  1442     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1443     MOVE X'2220233030303031343330' TO DFHEIV0(25:11)
  1444     CALL 'kxdfhei1' USING DFHEIV0
  1445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1446
  1447
  1448 0050-RATE-START-BROWSE.
  1449
  1450* EXEC CICS STARTBR
  1451*        DATASET  (ERRATE-FILE-ID)
  1452*        RIDFLD   (ERRATE-KEY)
  1453*        GTEQ
  1454*    END-EXEC.
  1455     MOVE 0
  1456       TO DFHEIV11
  1457*    MOVE '&,         G          &   #00001437' TO DFHEIV0
  1458     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1459     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1460     MOVE X'2020233030303031343337' TO DFHEIV0(25:11)
  1461     CALL 'kxdfhei1' USING DFHEIV0,
  1462           ERRATE-FILE-ID,
  1463           ERRATE-KEY,
  1464           DFHEIV99,
  1465           DFHEIV11,
  1466           DFHEIV99
  1467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1468
  1469
  1470     MOVE 'Y'                  TO WS-BROWSE-SW.
  1471
  1472 0100-READ-RATE-LOOP.
  1473
  1474* EXEC CICS READNEXT
  1475*        DATASET  (ERRATE-FILE-ID)
  1476*        SET      (ADDRESS OF RATE-RECORD)
  1477*        RIDFLD   (ERRATE-KEY)
  1478*    END-EXEC.
  1479     MOVE 0
  1480       TO DFHEIV11
  1481*    MOVE '&.S                   )   #00001446' TO DFHEIV0
  1482     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1483     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1484     MOVE X'2020233030303031343436' TO DFHEIV0(25:11)
  1485     CALL 'kxdfhei1' USING DFHEIV0,
  1486           ERRATE-FILE-ID,
  1487           DFHEIV20,
  1488           DFHEIV99,
  1489           ERRATE-KEY,
  1490           DFHEIV99,
  1491           DFHEIV11,
  1492           DFHEIV99,
  1493           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  31
* ELRATE.cbl
  1494     SET ADDRESS OF RATE-RECORD TO
  1495         DFHEIV20
  1496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1497
  1498
  1499 0110-CHECK-KEYS.
  1500*                            COPY ELCRATPD.
  1501******************************************************************
  1502*                                                                *
  1503*                                                                *
  1504*                            ELCRATPD                            *
  1505*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1506*                            VMOD=2.061                          *
  1507*                                                                *
  1508******************************************************************
  1509******************************************************************
  1510*                   C H A N G E   L O G
  1511*
  1512* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1513*-----------------------------------------------------------------
  1514*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1515* EFFECTIVE    NUMBER
  1516*-----------------------------------------------------------------
  1517* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  1518* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  1519* 032603                   PEMA  ADD SPECIAL AZ CALC
  1520* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  1521* 120403                   PEMA  ADD SPECIAL TX CALC
  1522* 092205                   PEMA  FIX CRIT PER FOR DCC
  1523* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  1524* 021207                   PEMA  ADD PA NP
  1525* 022107                   PEMA  ADD NH NP AND NP TRUNC
  1526* 032807                   PEMA  ADD VT NP PLUS 2
  1527* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  1528* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  1529* 060909    2008042300002  PEMA  ADD NEW FARM PLAN CALC
  1530* 010410    2008021200005  PEMA  ADD MN NET PAY BALLOON
  1531* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1532* 040610  CR2010010400006  PEMA  ADD IN TO VT CODE
  1533* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1534* 071211    2010012700001  PEMA  ADD SPPDD
  1535* 071511    2011021500001  PEMA  ADD CODE FOR DCC 10C
  1536* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  1537* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1538* 032612  CR2011110200001  PEMA  AHL CHANGES
  1539* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  1540* 122613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  1541* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  1542* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1543* 021519  CR2019021100001  PEMA  non-monthly al calcs
  1544* 072419  IR2019072400001  PEMA  Initialize pmt mode(AL)
  1545* 012820  CR2020012800001  PEMA  ADD EDIT FOR MINIMUM TERMS
  1546* 032020  CR2020032000001  PEMA  Use larger field for mon pmt
  1547******************************************************************
  1548
  1549 0110-CHECK-KEY.
  1550     IF SVRT-COMPANY-CD = RT-COMPANY-CD  AND
  1551        SVRT-ST-CODE    = RT-ST-CODE     AND
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  32
* ELRATE.cbl
  1552        SVRT-ST-CLASS   = RT-ST-CLASS    AND
  1553        SVRT-ST-DEV     = RT-ST-DEV      AND
  1554        SVRT-L-AH       = RT-L-AH        AND
  1555        SVRT-LAH-NUM    = RT-LAH-NUM
  1556         NEXT SENTENCE
  1557     ELSE
  1558         GO TO 9999-RATE-NOTFND.
  1559
  1560     IF  SVRT-HIGH-AGE GREATER RT-HIGH-AGE
  1561         GO TO 9999-RATE-NOTFND.
  1562
  1563     IF SVRT-HIGH-AMT NOT LESS THAN RT-HIGH-AMT
  1564        GO TO 0100-READ-RATE-LOOP.
  1565
  1566     IF SVRT-EXPIRY-DATE GREATER RT-EXPIRY-DATE
  1567         GO TO 0100-READ-RATE-LOOP.
  1568
  1569     IF SVRT-EXPIRY-DATE = RT-EXPIRY-DATE
  1570         GO TO 0100-READ-RATE-LOOP.
  1571
  1572     IF RT-MAX-AGE = ZEROS
  1573         NEXT SENTENCE
  1574     ELSE
  1575         COMPUTE WS-AGE =
  1576             (CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12))
  1577         IF WS-AGE >= RT-MAX-AGE
  1578             MOVE 'B'               TO CP-RETURN-CODE.
  1579
  1580     IF CP-LOAN-TERM NOT NUMERIC
  1581         MOVE +0                    TO CP-LOAN-TERM.
  1582
  1583     IF CP-LOAN-TERM = ZERO
  1584         MOVE CP-ORIGINAL-TERM      TO CP-LOAN-TERM.
  1585
  1586     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1587         MOVE +0                    TO CP-TERM-OR-EXT-DAYS.
  1588
  1589     MOVE CP-R-MAX-MON-BEN          TO WS-MAX-MON-BEN.
  1590     MOVE CP-R-MAX-TOT-BEN          TO WS-MAX-TOT-BEN.
  1591
  1592     IF CP-AH
  1593         GO TO 2000-TYPE-IS-AH.
  1594
  1595*    display ' ben type           ' cp-benefit-type
  1596*    display ' earn meth          ' cp-earning-method
  1597*    display ' process type       ' cp-process-type
  1598*    display ' special            ' cp-special-calc-cd
  1599*    display ' ben code           ' cp-benefit-cd
  1600*    display ' ext days calc      ' cp-ext-days-calc
  1601*    display ' rating meth        ' cp-rating-method
  1602*    display ' orig ben           ' cp-original-benefit
  1603     evaluate true
  1604        when (rt-is-ob)
  1605           and (cp-company-id not = 'CID')
  1606              move cp-loan-term  to ws-rate-term
  1607        when (cp-company-id = 'DCC' OR 'VPP')
  1608           and (cp-benefit-cd (1:1) = 'P')
  1609           move cp-loan-term     to ws-rate-term
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  33
* ELRATE.cbl
  1610        when other
  1611           move cp-original-term to ws-rate-term
  1612     end-evaluate
  1613
  1614*    IF ((RT-IS-OB)
  1615*       AND (CP-COMPANY-ID NOT EQUAL 'CID'))
  1616*                     OR
  1617*       ((CP-COMPANY-ID = 'DCC')
  1618*       AND (CP-BENEFIT-CD (1:1) = 'P'))
  1619*       MOVE CP-LOAN-TERM        TO WS-RATE-TERM
  1620*    ELSE
  1621*       MOVE CP-ORIGINAL-TERM TO WS-RATE-TERM
  1622*    END-IF
  1623
  1624     MOVE CP-CERT-EFF-DT            TO DC-BIN-DATE-1.
  1625     MOVE SPACE                     TO DC-OPTION-CODE.
  1626
  1627     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1628
  1629 1000-TYPE-IS-LIFE.
  1630     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  1631
  1632     MOVE ZERO                      TO CP-R-MAX-AGE
  1633                                       CP-R-MAX-TERM
  1634                                       CP-R-MAX-MON-BEN
  1635                                       CP-R-MAX-TOT-BEN.
  1636
  1637     MOVE RT-LIFE-MORT-CODE         TO CP-MORTALITY-CODE.
  1638
  1639     IF RT-CANCEL-FEE NUMERIC
  1640        MOVE RT-CANCEL-FEE          TO CP-CANCEL-FEE.
  1641
  1642     MOVE RT-DISCOUNT-OPTION     TO WS-DISCOUNT-OPTION.
  1643
  1644     if rt-discount-ob-rate not numeric
  1645        move zeros               to rt-discount-ob-rate
  1646     end-if
  1647     IF (RT-DISCOUNT-OPTION EQUAL
  1648                     '1' OR '2' OR '3' OR '4' OR '5') AND
  1649        (RT-DISCOUNT-OB-RATE NUMERIC)         AND
  1650        (RT-DISCOUNT-OB-RATE GREATER THAN +0)
  1651         NEXT SENTENCE
  1652     ELSE
  1653         IF (RT-DISCOUNT-OPTION EQUAL '6') AND
  1654            (CP-STATE-STD-ABBRV EQUAL 'CA')
  1655             IF RT-DISCOUNT-RATE GREATER THAN ZERO
  1656                 COMPUTE CA-DISCOUNT = RT-DISCOUNT-RATE / 100
  1657                 GO TO 1050-REGULAR-RATES
  1658             ELSE
  1659                 GO TO 1050-REGULAR-RATES
  1660         ELSE
  1661             GO TO 1050-REGULAR-RATES.
  1662
  1663*    display ' discount option ' rt-discount-option
  1664     IF RT-DISCOUNT-RATE NOT NUMERIC
  1665        MOVE +0                  TO RT-DISCOUNT-RATE.
  1666
  1667     IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  34
* ELRATE.cbl
  1668        NEXT SENTENCE
  1669     ELSE
  1670        MOVE +0                  TO CP-PREMIUM-RATE
  1671                                    CP-COMPOSITE-RATE
  1672                                    CP-CALC-PREMIUM
  1673         MOVE '4'                TO CP-RETURN-CODE
  1674         GO TO 9999-CALC-RATE-PREM-X.
  1675
  1676     IF RT-DISCOUNT-OPTION = '1' OR '3' OR '5'
  1677        MOVE RT-DISCOUNT-RATE TO WS-WORK-DIS-RATE
  1678     ELSE
  1679        MOVE CP-LOAN-APR TO WS-WORK-DIS-RATE.
  1680
  1681*    IF RT-DISCOUNT-OPTION EQUAL '4'
  1682*       MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1683*       GO TO 1075-BYPASS-REGULAR-RATE.
  1684
  1685     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  1686        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1687        COMPUTE WS-WORK-DIS-RATE EQUAL
  1688                WS-WORK-DIS-RATE / +100
  1689        GO TO 1075-BYPASS-REGULAR-RATE.
  1690
  1691     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  1692        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  1693        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1694        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1695        GO TO 1075-BYPASS-REGULAR-RATE.
  1696
  1697     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1698        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  1699        (CP-TRUNCATED-LIFE)
  1700        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1701        GO TO 1075-BYPASS-REGULAR-RATE.
  1702
  1703     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1704        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  1705        (CP-EARN-AS-NET-PAY)
  1706*       (CP-TRUNCATED-LIFE)
  1707        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1708        GO TO 1075-BYPASS-REGULAR-RATE.
  1709
  1710     IF ((CP-COMPANY-ID EQUAL 'GTL') AND
  1711        (CP-STATE-STD-ABBRV EQUAL 'RI'))
  1712                   AND
  1713        ((CP-EARN-AS-NET-PAY)
  1714               OR
  1715        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  1716        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1717        GO TO 1075-BYPASS-REGULAR-RATE.
  1718
  1719     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1720        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  1721        (CP-EARN-AS-NET-PAY) AND
  1722        (CP-SPECIAL-CALC-CD EQUAL 'H')
  1723        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1724        GO TO 1075-BYPASS-REGULAR-RATE.
  1725
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  35
* ELRATE.cbl
  1726     if (cp-company-id = 'CID')
  1727        and (cp-state-std-abbrv = 'WA' or 'AL')
  1728        and (rt-discount-option = '1')
  1729        and (cp-earn-as-farm-plan)
  1730        move rt-discount-ob-rate to cp-premium-rate
  1731        go to 1075-bypass-regular-rate
  1732     end-if
  1733     IF (CP-COMPANY-ID = 'CID')
  1734        AND (CP-STATE-STD-ABBRV = 'MN')
  1735        AND (RT-DISCOUNT-OPTION = '1')
  1736        AND ((CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1737                     OR
  1738            (CP-LEVEL-LIFE OR CP-EARN-AS-FARM-PLAN)
  1739            AND (CP-CERT-EFF-DT > X'A4FF'))
  1740        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1741        GO TO 1075-BYPASS-REGULAR-RATE
  1742     END-IF
  1743     if (cp-company-id = 'CID')
  1744        and (cp-earn-as-reg-balloon)
  1745        and (cp-ben-category = 'P' or 'I')
  1746        and (rt-discount-ob-rate not = zeros)
  1747        go to 1075-bypass-regular-rate
  1748     end-if
  1749     IF (CP-COMPANY-ID EQUAL 'CID')
  1750        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  1751                      OR
  1752            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  1753        AND (CP-EARN-AS-NET-PAY)
  1754        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1755        GO TO 1075-BYPASS-REGULAR-RATE
  1756     END-IF
  1757     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  1758        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1759        (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  1760         MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1761         GO TO 1075-BYPASS-REGULAR-RATE.
  1762
  1763     IF CP-COMPANY-ID = 'CID' or 'AHL'
  1764        CONTINUE
  1765     ELSE
  1766        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1767           (CP-EARN-AS-NET-PAY ) AND
  1768           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  1769            GO TO 1075-BYPASS-REGULAR-RATE
  1770        END-IF
  1771     END-IF
  1772     IF (CP-COMPANY-ID = 'CID') AND
  1773        (CP-EARN-AS-NET-PAY) AND
  1774        (CP-LEVEL-LIFE) AND
  1775        (CP-STATE-STD-ABBRV = 'CA') AND
  1776        (CP-STATE-STD-ABBRV = CP-STATE)
  1777        COMPUTE WS-WORK-DIS-RATE =
  1778             RT-DISCOUNT-RATE / +100
  1779        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1780        GO TO 1075-BYPASS-REGULAR-RATE
  1781     END-IF
  1782
  1783     IF (CP-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  36
* ELRATE.cbl
  1784        AND (CP-EARN-AS-NET-PAY)
  1785        AND (CP-STATE-STD-ABBRV = 'ME')
  1786        COMPUTE WS-WORK-DIS-RATE =
  1787             RT-DISCOUNT-RATE / +100
  1788        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1789        GO TO 1075-BYPASS-REGULAR-RATE
  1790     END-IF
  1791     IF (CP-COMPANY-ID = 'CID')
  1792        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1793           OR 'IN' OR 'AZ')
  1794        AND (CP-FARM-PLAN)
  1795        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1796        GO TO 1075-BYPASS-REGULAR-RATE
  1797     END-IF
  1798     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  1799        AND (CP-BEN-CATEGORY = 'D')
  1800        AND (CP-EARN-AS-NET-PAY)
  1801        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1802        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  1803           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  1804*       DISPLAY ' ACT COMM ' CP-DCC-ACT-COMM
  1805*       DISPLAY ' PMF COMM ' CP-DCC-PMF-COMM
  1806*       DISPLAY ' OB RATE  ' RT-DISCOUNT-OB-RATE
  1807*       DISPLAY ' NEW RATE ' CP-PREMIUM-RATE
  1808        GO TO 1075-BYPASS-REGULAR-RATE
  1809     END-IF
  1810     IF (CP-COMPANY-ID = 'CID') AND
  1811        (CP-EARN-AS-NET-PAY) AND
  1812        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  1813                            OR 'VT')
  1814                   OR
  1815        ((CP-STATE-STD-ABBRV = 'IN') AND
  1816        (CP-CERT-EFF-DT > X'9A7F'))
  1817                   OR
  1818        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  1819        (CP-CERT-EFF-DT > X'9ADF'))) AND
  1820        (CP-STATE-STD-ABBRV = CP-STATE)
  1821        COMPUTE WS-WORK-DIS-RATE =
  1822             RT-DISCOUNT-RATE / +100
  1823        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1824        GO TO 1075-BYPASS-REGULAR-RATE
  1825     END-IF
  1826
  1827     IF (CP-COMPANY-ID = 'CID') AND
  1828        (CP-EARN-AS-NET-PAY) AND
  1829        (CP-STATE-STD-ABBRV = 'TX') AND
  1830        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1831        (WS-DISCOUNT-OPTION NOT = ' ')
  1832        COMPUTE WS-WORK-DIS-RATE =
  1833             RT-DISCOUNT-RATE / +100
  1834        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1835        GO TO 1075-BYPASS-REGULAR-RATE
  1836     END-IF
  1837
  1838     IF (CP-COMPANY-ID = 'CID') AND
  1839        (CP-EARN-AS-NET-PAY) AND
  1840        (CP-TRUNCATED-LIFE) AND
  1841        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  37
* ELRATE.cbl
  1842        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1843        (WS-DISCOUNT-OPTION NOT = ' ')
  1844        COMPUTE WS-WORK-DIS-RATE =
  1845             RT-DISCOUNT-RATE / +100
  1846        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1847        GO TO 1075-BYPASS-REGULAR-RATE
  1848     END-IF
  1849
  1850     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1851        IF WS-WORK-DIS-RATE NOT EQUAL +0
  1852           COMPUTE WS-WORK-DIS-RATE EQUAL
  1853                   WS-WORK-DIS-RATE / +100.
  1854
  1855     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1856        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1857           IF CP-MONTHLY-PAYMENT EQUAL +0
  1858            IF CP-LOAN-APR GREATER THAN +2
  1859              COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1860              CP-ORIGINAL-BENEFIT /
  1861               ((1 - (1 + (CP-LOAN-APR / +1200)) **
  1862               (WS-RATE-TERM * -1)) / (CP-LOAN-APR / +1200))
  1863            ELSE
  1864             COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1865               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1866
  1867     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1868        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1869          IF WS-WORK-DIS-RATE GREATER THAN +0
  1870           COMPUTE WK1 ROUNDED EQUAL
  1871           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1872                              (WS-RATE-TERM - +1)) /
  1873                        (WS-WORK-DIS-RATE / +12)
  1874           COMPUTE WK2 ROUNDED EQUAL
  1875           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1876                              (WS-RATE-TERM)) /
  1877                        (WS-WORK-DIS-RATE / +12)
  1878           COMPUTE WK3 EQUAL
  1879                RT-DISCOUNT-OB-RATE *
  1880                (1 + WS-WORK-DIS-RATE / +12)
  1881                MOVE WK3 TO CP-PREMIUM-RATE
  1882                COMPUTE WK5 EQUAL WK3 / +1000
  1883           GO TO 1075-BYPASS-REGULAR-RATE.
  1884*               (RT-DISCOUNT-OB-RATE / +1000) *
  1885*               (1 + WS-WORK-DIS-RATE / +12)
  1886*          GO TO 1075-BYPASS-REGULAR-RATE.
  1887
  1888     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1889        IF RT-DISCOUNT-OB-RATE GREATER THAN +0
  1890           COMPUTE WK3 EQUAL
  1891           RT-DISCOUNT-OB-RATE *
  1892           (24 / (24 + WS-WORK-DIS-RATE * WS-RATE-TERM))
  1893           MOVE WK3 TO CP-PREMIUM-RATE
  1894           COMPUTE WK5 EQUAL WK3 / +1000
  1895           GO TO 1075-BYPASS-REGULAR-RATE.
  1896
  1897     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  1898        (CP-STATE-STD-ABBRV EQUAL 'VT' OR 'MA')
  1899        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  38
* ELRATE.cbl
  1900        GO TO 1075-BYPASS-REGULAR-RATE.
  1901
  1902     COMPUTE WS-SIN-PREM-RATE =
  1903             (RT-DISCOUNT-OB-RATE / +1000) *
  1904             ((WS-RATE-TERM + +1) / +2).
  1905
  1906     COMPUTE CP-PREMIUM-RATE =
  1907             WS-SIN-PREM-RATE /
  1908             (+1 + (((WS-WORK-DIS-RATE / +100) *
  1909             WS-RATE-TERM) / +24)).
  1910
  1911     IF CP-PREMIUM-RATE NOT = +0
  1912        MULTIPLY +100 BY CP-PREMIUM-RATE
  1913        MOVE CP-PREMIUM-RATE TO WS-PREMIUM-RATE
  1914        GO TO 1075-BYPASS-REGULAR-RATE.
  1915
  1916 1050-REGULAR-RATES.
  1917
  1918     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1919        COMPUTE WK5 EQUAL
  1920        ((WS-RATE-TERM * RT-L-RATE (+12)) / +100) /
  1921        (6 * (WS-RATE-TERM + 1))
  1922        MOVE WK5 TO CP-PREMIUM-RATE
  1923        GO TO 1075-BYPASS-REGULAR-RATE.
  1924
  1925     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  1926        (CP-CSL-VALID-NP-BENEFIT-CD)
  1927        IF CP-JOINT-INDICATOR EQUAL 'J'
  1928           MOVE RT-L-RATE (3) TO CP-PREMIUM-RATE
  1929           GO TO 1075-BYPASS-REGULAR-RATE
  1930        ELSE
  1931           MOVE RT-L-RATE (1) TO CP-PREMIUM-RATE
  1932           GO TO 1075-BYPASS-REGULAR-RATE.
  1933
  1934     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  1935        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  1936        (CP-EARN-AS-NET-PAY )
  1937        MOVE RT-L-RATE (12)      TO CP-PREMIUM-RATE
  1938        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  1939        MOVE CP-FIRST-PAY-DATE   TO DC-BIN-DATE-2
  1940        MOVE '1'                 TO DC-OPTION-CODE
  1941        PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  1942        IF DATE-CONVERSION-ERROR
  1943            MOVE '2'                TO CP-RETURN-CODE
  1944            GO TO 9999-CALC-RATE-PREM-X
  1945        ELSE
  1946            COMPUTE CP-ODD-DAYS-TO-PMT = DC-ELAPSED-MONTHS * 30 +
  1947                                         DC-ODD-DAYS-OVER
  1948            GO TO 1075-BYPASS-REGULAR-RATE.
  1949
  1950     IF RT-COMPOSITE-RATE NOT NUMERIC
  1951         MOVE ZEROS                        TO RT-COMPOSITE-RATE.
  1952
  1953*    IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1954     IF WS-RATE-TERM GREATER ZERO AND LESS 361
  1955         MOVE RT-L-RATE (WS-RATE-TERM)     TO CP-PREMIUM-RATE
  1956                                              WS-PREMIUM-RATE
  1957         MOVE RT-COMPOSITE-RATE            TO CP-COMPOSITE-RATE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  39
* ELRATE.cbl
  1958     ELSE
  1959         MOVE +0                           TO CP-PREMIUM-RATE
  1960                                              CP-COMPOSITE-RATE
  1961                                              CP-CALC-PREMIUM
  1962         GO TO 9999-CALC-RATE-PREM-X.
  1963     IF (CP-COMPANY-ID EQUAL 'CID')
  1964        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  1965        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1966        AND (CP-EARN-AS-NET-PAY)
  1967        GO TO 1075-BYPASS-REGULAR-RATE
  1968     END-IF
  1969******************************************************
  1970*    IF CP-COMPANY-ID NOT = 'LBL'
  1971     IF (CP-COMPANY-ID NOT = 'LBL' AND 'CID')
  1972                   or
  1973        ((cp-company-id = 'CID')
  1974        and (cp-earn-as-reg-balloon)
  1975        and (cp-ben-category = 'P' or 'I'))
  1976         GO TO 1075-BYPASS-REGULAR-RATE.
  1977
  1978     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1979     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.
  1980     MOVE '1'                    TO DC-OPTION-CODE.
  1981     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1982     IF DATE-CONVERSION-ERROR
  1983         MOVE '2'                TO CP-RETURN-CODE
  1984         GO TO 9999-CALC-RATE-PREM-X
  1985       ELSE
  1986         MOVE DC-ELAPSED-MONTHS  TO CP-MNTHS-TO-FIRST-PMT
  1987         MOVE DC-ODD-DAYS-OVER   TO CP-ODD-DAYS-TO-PMT.
  1988
  1989     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN 1
  1990        COMPUTE CP-ODD-DAYS-TO-PMT EQUAL CP-ODD-DAYS-TO-PMT +
  1991        ((CP-MNTHS-TO-FIRST-PMT - 1) * +30).
  1992
  1993     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH)
  1994        IF (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1995           NEXT SENTENCE
  1996         ELSE
  1997           GO TO 1075-BYPASS-REGULAR-RATE
  1998       ELSE
  1999        IF (CP-MNTHS-TO-FIRST-PMT = ZERO) AND
  2000           (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  2001           NEXT SENTENCE
  2002         ELSE
  2003           GO TO 1075-BYPASS-REGULAR-RATE.
  2004
  2005     IF CP-MNTHS-TO-FIRST-PMT GREATER ZERO
  2006        COMPUTE CP-PREMIUM-RATE =
  2007        ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  2008         * (CP-ORIGINAL-TERM + 1)) - CP-PREMIUM-RATE)
  2009         * (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2010
  2011     IF CP-MNTHS-TO-FIRST-PMT = ZEROS
  2012        COMPUTE CP-PREMIUM-RATE =
  2013        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2014        CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - 1))) *
  2015        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  40
* ELRATE.cbl
  2016        (CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  2017         * (CP-ORIGINAL-TERM - 1)).
  2018******************************************************
  2019
  2020 1075-BYPASS-REGULAR-RATE.
  2021
  2022     MOVE CP-LOAN-TERM              TO WS-RATE-TERM.
  2023
  2024     MOVE +1 TO LINDX.
  2025
  2026     IF CP-COMPANY-ID EQUAL 'CRI'
  2027        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2028           MOVE +5               TO LINDX
  2029           IF RT-L-EX-AGE (LINDX) EQUAL ZERO
  2030              MOVE 'F'           TO CP-RETURN-CODE
  2031              GO TO 1200-CALCULATE-PREMIUMS.
  2032
  2033     IF RT-L-EX-AGE (LINDX) = ZERO
  2034          GO TO 1200-CALCULATE-PREMIUMS.
  2035
  2036 1100-SEARCH-LIFE-LIMITS.
  2037
  2038     IF CP-COMPANY-ID EQUAL 'CRI'
  2039        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2040           IF LINDX GREATER THAN +4
  2041              MOVE 'A'           TO CP-RETURN-CODE
  2042              GO TO 1200-CALCULATE-PREMIUMS.
  2043
  2044     IF LINDX GREATER +8
  2045         MOVE 'A'                TO CP-RETURN-CODE
  2046         GO TO 1200-CALCULATE-PREMIUMS.
  2047     if rt-l-min-term(lindx) not numeric
  2048        move +0                  to rt-l-min-term(lindx)
  2049     end-if
  2050     IF CP-ISSUE-AGE GREATER RT-L-EX-AGE (LINDX)
  2051         IF RT-L-EX-AGE (LINDX) = ZEROS
  2052             ADD +1              TO LINDX
  2053             GO TO 1100-SEARCH-LIFE-LIMITS
  2054         ELSE
  2055             MOVE RT-L-EX-AGE (LINDX)
  2056                                 TO CP-R-MAX-AGE
  2057             MOVE RT-L-EX-TERM (LINDX)
  2058                                 TO CP-R-MAX-TERM
  2059             MOVE RT-L-EX-FACE (LINDX)
  2060                                 TO CP-R-MAX-TOT-BEN
  2061             ADD +1              TO LINDX
  2062             GO TO 1100-SEARCH-LIFE-LIMITS
  2063     ELSE
  2064         MOVE RT-L-EX-AGE (LINDX)
  2065                                 TO CP-R-MAX-AGE
  2066         MOVE RT-L-EX-TERM (LINDX)
  2067                                 TO CP-R-MAX-TERM
  2068         MOVE RT-L-EX-FACE (LINDX)
  2069                                 TO CP-R-MAX-TOT-BEN.
  2070
  2071     IF CP-ORIGINAL-TERM GREATER RT-L-EX-TERM (LINDX)
  2072         MOVE '9'                TO CP-RETURN-CODE.
  2073
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  41
* ELRATE.cbl
  2074     IF CP-ORIGINAL-BENEFIT GREATER RT-L-EX-FACE (LINDX)
  2075         MOVE '8'                TO CP-RETURN-CODE.
  2076     if rt-l-min-term(lindx) <> zeros
  2077        and CP-loan-term     < RT-L-min-TERM (LINDX)
  2078        MOVE 'I'                 TO CP-RETURN-CODE
  2079     end-if
  2080
  2081     .
  2082 1200-CALCULATE-PREMIUMS.
  2083
  2084     IF CP-COMPANY-ID = 'CSL'
  2085        IF CP-CSL-VALID-NP-BENEFIT-CD
  2086           GO TO 1240-NET-PAY-CONT
  2087        ELSE
  2088           GO TO 1250-CSL-CALC.
  2089
  2090     IF CP-COMPANY-ID = 'WDS'
  2091        IF CP-STATE-STD-ABBRV = 'MN' OR 'NC'
  2092           IF CP-EARN-AS-REG-BALLOON
  2093              GO TO 1240-NET-PAY-CONT.
  2094
  2095     IF (CP-COMPANY-ID = 'CID')
  2096        AND (CP-STATE-STD-ABBRV = 'MN')
  2097        AND (CP-EARN-AS-REG-BALLOON OR CP-EARN-AS-FARM-PLAN)
  2098        AND (CP-CERT-EFF-DT > X'A4FF')
  2099        GO TO 1240-NET-PAY-CONT
  2100     END-IF
  2101     IF (CP-COMPANY-ID = 'CID')
  2102        AND (CP-STATE-STD-ABBRV = 'WA' or 'AL')
  2103        AND (CP-FARM-PLAN)
  2104        GO TO 1240-NET-PAY-CONT
  2105     END-IF
  2106     if (cp-company-id = 'CID')
  2107        and (cp-earn-as-reg-balloon)
  2108        and (cp-ben-category = 'P' or 'I')
  2109        display ' found balloon p or i ' rt-discount-ob-rate
  2110        evaluate true
  2111           when (cp-net-only-state = 'Y')
  2112              and (rt-discount-ob-rate > zeros)
  2113              compute cp-premium-rate = rt-discount-ob-rate / 10
  2114           when (cp-net-only-state = 'Y')
  2115              and (rt-discount-ob-rate = zeros)
  2116              display ' not ob rate     ' cp-premium-rate
  2117              compute cp-premium-rate =
  2118                 cp-premium-rate / cp-original-term * 12
  2119              display ' new rate ' cp-premium-rate
  2120              display ' net only state ' cp-premium-rate
  2121              compute cp-premium-rate rounded =
  2122                (cp-premium-rate *
  2123                   (cp-original-term + 1) / 12) /
  2124                ((cp-original-term + 2) / 2)
  2125              display ' new OB rate ' cp-premium-rate
  2126           when (cp-net-only-state <> 'Y')
  2127              and (rt-discount-ob-rate = zeros)
  2128              display ' not net only st ' cp-premium-rate
  2129              compute cp-premium-rate =
  2130                 cp-premium-rate / cp-original-term * 12
  2131              display ' new rate ' cp-premium-rate
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  42
* ELRATE.cbl
  2132        end-evaluate
  2133        go to 1240-net-pay-cont
  2134     end-if
  2135     IF (CP-COMPANY-ID = 'CID')
  2136        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2137           OR 'IN' OR 'AZ')
  2138        AND (CP-FARM-PLAN)
  2139***  OK, I DID THIS SO ERCNETP WOULDN'T ERROR OUT
  2140***  THE APR ISN'T EVEN USED IN THE ROUTINE, SO SUE ME :)
  2141        MOVE +1.0                TO CP-LOAN-APR
  2142        GO TO 1240-NET-PAY-CONT
  2143     END-IF
  2144     IF CP-RATE-AS-STANDARD
  2145         GO TO 1210-REGULAR-RATE.
  2146
  2147     IF CP-CRITICAL-PERIOD
  2148         GO TO 1220-CRITICAL-PERIOD-LF-CONT.
  2149
  2150     IF CP-EARN-AS-TEXAS
  2151         GO TO 1230-TEXAS-CONT.
  2152
  2153     IF CP-EARN-AS-NET-PAY
  2154        IF CP-STATE-STD-ABBRV = 'MD'
  2155          IF CP-COMPANY-ID = 'MON'
  2156            IF CP-BENEFIT-CD = '11' OR '12' OR '13' OR
  2157                               '14' OR '26' OR '47'
  2158              GO TO 1210-REGULAR-RATE.
  2159
  2160     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2161        IF CP-MONTHLY-PAYMENT EQUAL +0
  2162           COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2163                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2164
  2165     IF CP-COMPANY-ID EQUAL 'GTL'
  2166        NEXT SENTENCE
  2167     ELSE
  2168     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2169        IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2170           COMPUTE WK3 ROUNDED EQUAL
  2171           CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2172           CP-MONTHLY-PAYMENT
  2173           COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2174           COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2175           CP-ALTERNATE-BENEFIT)
  2176           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2177           WK3 * WK5
  2178           GO TO 9999-CALC-RATE-PREM-X
  2179        ELSE
  2180           COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2181           (CP-ORIGINAL-TERM - 1 - WK1)) /
  2182           (WS-WORK-DIS-RATE / +12)
  2183           COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2184           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2185                               WK5
  2186           GO TO 9999-CALC-RATE-PREM-X.
  2187
  2188     IF CP-COMPANY-ID EQUAL 'GTL' AND
  2189        CP-STATE-STD-ABBRV EQUAL 'RI' AND
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  43
* ELRATE.cbl
  2190        CP-SPECIAL-CALC-CD EQUAL 'H' AND
  2191        CP-ORIGINAL-TERM LESS THAN +61
  2192        COMPUTE CP-CALC-PREMIUM EQUAL
  2193                        (CP-ORIGINAL-BENEFIT *
  2194           (CP-ORIGINAL-TERM + 1) * CP-PREMIUM-RATE) /
  2195           (20 * (1 + .0019 * CP-ORIGINAL-TERM) * 100)
  2196        COMPUTE CP-CALC-PREMIUM EQUAL
  2197                CP-CALC-PREMIUM +
  2198              (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE *
  2199        (CP-ORIGINAL-TERM + 1)) /
  2200        (10 * (1 + .0027 * (CP-ORIGINAL-TERM + 1)) * 100)
  2201        GO TO 9999-CALC-RATE-PREM-X.
  2202
  2203     IF CP-COMPANY-ID = 'GTL'     AND
  2204        CP-STATE-STD-ABBRV = 'PA' AND
  2205        CP-SPECIAL-CALC-CD = 'H'
  2206         GO TO 1260-GTL-PA-LEASE.
  2207
  2208     IF (CP-EARN-AS-NET-PAY)
  2209*       AND (CP-LOAN-APR > ZEROS)
  2210        GO TO 1240-NET-PAY-CONT
  2211     END-IF
  2212
  2213     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  2214         GO TO 1210-REGULAR-RATE.
  2215
  2216**** CHECK TO SEE IF THE LEVEL PORTION OF A BALLOON IS BEING
  2217**** RATED AND BYPASS NET-PAY CHECK IF NO APR HAS BEEN ENTERED.
  2218****
  2219     IF CP-DEVIATION-CODE = 'LEV' AND
  2220        CP-LOAN-APR = ZEROS
  2221         GO TO 1210-REGULAR-RATE.
  2222
  2223     IF (CP-STATE-STD-ABBRV = 'OH')
  2224        AND (CP-CLASS-CODE NOT = 'L ')
  2225        AND (CP-ORIGINAL-TERM > 60)
  2226        AND (DC-GREG-DATE-CYMD > 19831031)
  2227        AND (CP-LOAN-APR > ZEROS)
  2228        GO TO 1240-NET-PAY-CONT
  2229     END-IF
  2230
  2231     IF (CP-STATE-STD-ABBRV = 'UT')
  2232        AND (CP-ORIGINAL-TERM > 62)
  2233        AND (DC-GREG-DATE-CYMD > 19810831)
  2234        AND (DC-GREG-DATE-CYMD < 19830901)
  2235        AND (CP-LOAN-APR > ZEROS)
  2236        GO TO 1240-NET-PAY-CONT
  2237     END-IF
  2238
  2239     IF (CP-STATE-STD-ABBRV = 'RI')
  2240        AND (CP-ORIGINAL-TERM > 60)
  2241        AND (DC-GREG-DATE-CYMD > 19831231)
  2242        AND (CP-LOAN-APR > ZEROS)
  2243        GO TO 1240-NET-PAY-CONT
  2244     END-IF
  2245     .
  2246 1210-REGULAR-RATE.
  2247
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  44
* ELRATE.cbl
  2248     IF (CP-COMPANY-ID = 'CID')
  2249        AND (CP-EARN-AS-NET-PAY)
  2250        AND (CP-LOAN-APR = 0)
  2251        IF RT-L-RATE (WS-RATE-TERM) = 0
  2252           COMPUTE WS-SIN-PREM-RATE =
  2253              (RT-DISCOUNT-OB-RATE / +1000) *
  2254              ((WS-RATE-TERM + +1) / +2)
  2255           COMPUTE CP-PREMIUM-RATE =
  2256              WS-SIN-PREM-RATE /
  2257              (+1 + (((WS-WORK-DIS-RATE / +100) *
  2258              WS-RATE-TERM) / +24))
  2259        ELSE
  2260           MOVE RT-L-RATE (WS-RATE-TERM) TO CP-PREMIUM-RATE
  2261        END-IF
  2262     END-IF
  2263*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2264*       IF CP-MONTHLY-PAYMENT EQUAL +0
  2265*          COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2266*               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2267*
  2268*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2269*       IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2270*          COMPUTE WK3 ROUNDED EQUAL
  2271*          CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2272*          CP-MONTHLY-PAYMENT
  2273*          COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2274*          COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2275*          CP-ALTERNATE-BENEFIT)
  2276*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2277*          WK3 * WK5
  2278*          GO TO 9999-CALC-RATE-PREM-X
  2279*       ELSE
  2280*          COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2281*          (CP-ORIGINAL-TERM - 1 - WK1)) /
  2282*          (WS-WORK-DIS-RATE / +12)
  2283*          COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2284*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2285*                              WK5
  2286*          GO TO 9999-CALC-RATE-PREM-X.
  2287
  2288     IF CP-TERM-IS-DAYS
  2289         COMPUTE CP-PREMIUM-RATE ROUNDED =
  2290             ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM) * 12) / +365
  2291         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2292             ((CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE)
  2293                          * CP-TERM-OR-EXT-DAYS
  2294           GO TO 9999-CALC-RATE-PREM-X.
  2295
  2296     if (cp-company-id = 'AHL')
  2297        and (cp-loan-term > cp-original-term)
  2298        continue
  2299     else
  2300        IF NOT CP-TRUNCATED-LIFE
  2301           GO TO 1212-GROSS-NOT-TRUNCATED
  2302        end-if
  2303     end-if
  2304
  2305****  GROSS TRUNCATED CALCULATION
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  45
* ELRATE.cbl
  2306
  2307     IF CP-LOAN-TERM NOT GREATER THAN CP-ORIGINAL-TERM
  2308         MOVE 'H'                TO  CP-RETURN-CODE
  2309         GO TO 9999-CALC-RATE-PREM-X.
  2310     if cp-company-id = 'AHL'
  2311        if (cp-state = 'AZ' OR 'GA' OR 'IN' OR 'MT' OR 'NH'
  2312           OR 'NJ' OR 'OH' OR 'PA' OR 'TX' OR 'VA')
  2313           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2314           cp-original-term) * (cp-loan-term - cp-original-term
  2315            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2316            cp-premium-rate / 100 * cp-original-term /
  2317            cp-loan-term * cp-original-benefit
  2318        else
  2319           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2320           cp-original-term) * (cp-loan-term - cp-original-term
  2321            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2322            cp-premium-rate * cp-original-benefit / 100
  2323        end-if
  2324        go to 9999-calc-rate-prem-x
  2325     end-if
  2326
  2327     IF CP-COMPANY-ID = 'NCL'
  2328         COMPUTE WK-MONTHLY-RATE =
  2329               ((((CP-LOAN-TERM * (CP-LOAN-TERM + 1) -
  2330                  (CP-LOAN-TERM - CP-ORIGINAL-TERM) *
  2331                  (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1))
  2332                                 /
  2333                  (CP-LOAN-TERM * (CP-LOAN-TERM + 1))))
  2334                                 *
  2335                  ((RT-L-RATE (12) * CP-LOAN-TERM / 12)))
  2336         COMPUTE CP-CALC-PREMIUM =
  2337                 WK-MONTHLY-RATE * CP-ORIGINAL-BENEFIT / 100
  2338     ELSE
  2339         COMPUTE CP-R-MAX-TERM = CP-LOAN-TERM -
  2340                                 CP-ORIGINAL-TERM
  2341         COMPUTE CP-CALC-PREMIUM = CP-ORIGINAL-BENEFIT *
  2342                     ((RT-L-RATE (CP-LOAN-TERM)  -
  2343                     (1 - (CP-ORIGINAL-TERM / CP-LOAN-TERM)) *
  2344                     RT-L-RATE (CP-R-MAX-TERM)) / 100)
  2345     END-IF
  2346     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2347        COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2348           (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2349           CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS)
  2350     END-IF
  2351     GO TO 9999-CALC-RATE-PREM-X
  2352     .
  2353 1212-GROSS-NOT-TRUNCATED.
  2354*    display ' premium rate ' cp-premium-rate
  2355
  2356     IF (CP-COMPANY-ID = 'CID')
  2357        AND (CP-STATE-STD-ABBRV = 'VT' OR 'MA'
  2358           OR 'IN')
  2359        AND (CP-BENEFIT-CD = '55' OR '56')
  2360        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2361          (CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM)) *
  2362          (CP-ORIGINAL-TERM) *
  2363          ((CP-ORIGINAL-TERM) / 12) *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  46
* ELRATE.cbl
  2364          ((6.5 * RT-DISCOUNT-OB-RATE) / 1000)
  2365          GO TO 9999-CALC-RATE-PREM-X
  2366     END-IF
  2367     IF (CP-COMPANY-ID = 'CID')
  2368        AND (CP-STATE-STD-ABBRV = 'GA')
  2369        AND (CP-BENEFIT-CD = '55' OR '56' OR '2M' OR '2N')
  2370        COMPUTE WK3 ROUNDED =
  2371          CP-ORIGINAL-BENEFIT *
  2372          ((CP-ORIGINAL-TERM + 1) / 2) *
  2373          (RT-DISCOUNT-OB-RATE / 1000)
  2374          MOVE WK3 TO CP-CALC-PREMIUM
  2375          GO TO 9999-CALC-RATE-PREM-X
  2376     END-IF
  2377     IF (CP-COMPANY-ID EQUAL 'CID')
  2378        AND (CP-STATE-STD-ABBRV = 'MN')
  2379        AND (CP-LEVEL-LIFE)
  2380        AND (CP-CERT-EFF-DT > X'A4FF')
  2381        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  2382        MOVE CP-EXPIRE-DT        TO DC-BIN-DATE-2
  2383        MOVE '1'                 TO DC-OPTION-CODE
  2384        PERFORM 9100-CONVERT-DATE
  2385                                 THRU 9100-EXIT
  2386        IF DATE-CONVERSION-ERROR
  2387           MOVE '2'              TO CP-RETURN-CODE
  2388           MOVE ZEROS            TO FACTOR
  2389                                 CP-CALC-PREMIUM
  2390           GO TO 9999-CALC-RATE-PREM-X
  2391        END-IF
  2392        MOVE DC-ELAPSED-DAYS     TO D
  2393        COMPUTE wk-pay-amt = CP-ORIGINAL-BENEFIT /
  2394           (1 / (1 + (CP-LOAN-APR / 100) * D / 360) -
  2395           (CP-PREMIUM-RATE * 12 / 365 * D / 1000))
  2396        COMPUTE CP-CALC-PREMIUM = wk-pay-amt *
  2397           CP-PREMIUM-RATE * 12 / 365 * D / 1000
  2398        GO TO 9999-CALC-RATE-PREM-X
  2399     END-IF
  2400     IF (CP-COMPANY-ID = 'CID')
  2401        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2402        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2403           (CP-ORIGINAL-BENEFIT / 1000) * CP-PREMIUM-RATE
  2404     ELSE
  2405        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2406                 (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE
  2407     END-IF
  2408*    display ' calc premium ' cp-calc-premium
  2409
  2410*    IF CP-COMPANY-ID = 'LBL'
  2411     IF (CP-COMPANY-ID = 'LBL' OR 'CID')
  2412        AND (NOT CP-EARN-AS-NET-PAY)
  2413        GO TO 9999-CALC-RATE-PREM-X
  2414     END-IF
  2415
  2416     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2417         GO TO 9999-CALC-RATE-PREM-X.
  2418
  2419     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2420         COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2421            (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  47
* ELRATE.cbl
  2422               CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS).
  2423
  2424     GO TO 9999-CALC-RATE-PREM-X.
  2425
  2426 1220-CRITICAL-PERIOD-LF-CONT.
  2427     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2428               (CP-ORIGINAL-BENEFIT / +100) * CP-PREMIUM-RATE.
  2429
  2430     GO TO 9999-CALC-RATE-PREM-X.
  2431
  2432 1230-TEXAS-CONT.
  2433     IF CP-FARM-PLAN
  2434         GO TO 1235-TEXAS-FARM-CONT.
  2435
  2436     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2437               (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2438
  2439     COMPUTE TEX-FACT-9 =
  2440                 (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY) /
  2441                 (CP-ORIGINAL-TERM + 1).
  2442
  2443     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2444                 CP-CALC-PREMIUM * TEX-FACT-9.
  2445
  2446     GO TO 9999-CALC-RATE-PREM-X.
  2447
  2448 1235-TEXAS-FARM-CONT.
  2449     COMPUTE WS-FARM-TERM =
  2450               (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY).
  2451
  2452     COMPUTE WS-PREMIUM-RATE = RT-L-RATE (WS-FARM-TERM) / 2.
  2453     MOVE WS-PREMIUM-RATE         TO CP-PREMIUM-RATE.
  2454
  2455
  2456     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2457              (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2458
  2459     GO TO 9999-CALC-RATE-PREM-X.
  2460
  2461 1240-NET-PAY-CONT.
  2462
  2463     MOVE CP-LOAN-APR             TO N-P-APR.
  2464     MOVE CP-ORIGINAL-TERM        TO N-P-ORIG
  2465                                     N-P-REM
  2466                                     N-P-LOAN.
  2467
  2468     MOVE CP-SPECIAL-CALC-CD      TO N-P-OPT.
  2469
  2470     IF CP-TRUNCATED-LIFE
  2471         MOVE CP-LOAN-TERM        TO N-P-LOAN.
  2472
  2473     IF CP-COMPANY-ID EQUAL 'NCL'
  2474        NEXT SENTENCE
  2475     ELSE
  2476        GO TO 1241-NET-PAY-CONT.
  2477
  2478     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  2479     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  48
* ELRATE.cbl
  2480     MOVE '1'                    TO DC-OPTION-CODE
  2481     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2482     IF DATE-CONVERSION-ERROR
  2483         MOVE '2'                TO CP-RETURN-CODE
  2484         GO TO 9999-CALC-RATE-PREM-X
  2485     ELSE
  2486        MOVE DC-ELAPSED-MONTHS   TO CP-MNTHS-TO-FIRST-PMT
  2487        MOVE DC-ODD-DAYS-OVER    TO CP-ODD-DAYS-TO-PMT.
  2488
  2489     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2490        (CP-ODD-DAYS-TO-PMT NOT EQUAL ZEROS)
  2491        NEXT SENTENCE
  2492     ELSE
  2493        MOVE +1                  TO ODF
  2494        GO TO 1241-NET-PAY-CONT.
  2495
  2496     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN ZERO
  2497        COMPUTE CP-PREMIUM-RATE EQUAL
  2498        ((CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN + 1)) -
  2499        CP-PREMIUM-RATE) *
  2500        (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2501
  2502     IF CP-MNTHS-TO-FIRST-PMT EQUAL ZEROS
  2503        COMPUTE CP-PREMIUM-RATE EQUAL
  2504        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2505        N-P-LOAN * (N-P-LOAN - 1))) *
  2506        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2507        (CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN - 1)).
  2508
  2509     COMPUTE ODF EQUAL
  2510     ((1 + (N-P-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  2511     ((1 + (CP-ODD-DAYS-TO-PMT * 12 / 36500))).
  2512
  2513 1241-NET-PAY-CONT.
  2514
  2515     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2516
  2517*    IF CP-RETURN-CODE EQUAL '0' OR '8'
  2518     IF CP-RETURN-CODE EQUAL '0' OR '8' OR '9' OR 'B'
  2519        NEXT SENTENCE
  2520     ELSE
  2521        GO TO 9999-CALC-RATE-PREM-X.
  2522
  2523     IF RT-DISCOUNT-OPTION EQUAL '6'
  2524         GO TO 9999-CALC-RATE-PREM-X.
  2525
  2526     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2527        (CP-STATE-STD-ABBRV EQUAL 'IA')
  2528        GO TO 9999-CALC-RATE-PREM-X.
  2529
  2530     MOVE N-P-FACTOR              TO CP-CDT-FACTOR.
  2531
  2532     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  2533        GO TO 9999-CALC-RATE-PREM-X.
  2534
  2535     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2536        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2537        (CP-TRUNCATED-LIFE)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  49
* ELRATE.cbl
  2538        GO TO 9999-CALC-RATE-PREM-X.
  2539
  2540     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2541        (CP-CSL-VALID-NP-BENEFIT-CD)
  2542        GO TO 9999-CALC-RATE-PREM-X.
  2543
  2544     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  2545        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  2546        (CP-EARN-AS-NET-PAY)
  2547        GO TO 9999-CALC-RATE-PREM-X.
  2548
  2549*    IF (CP-COMPANY-ID EQUAL 'CID') AND
  2550*       (CP-STATE-STD-ABBRV EQUAL 'NV') AND
  2551*       (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  2552*       GO TO 9999-CALC-RATE-PREM-X.
  2553
  2554     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  2555        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2556        (CP-EARN-AS-NET-PAY)
  2557        GO TO 9999-CALC-RATE-PREM-X.
  2558
  2559     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  2560        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  2561        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2562        GO TO 9999-CALC-RATE-PREM-X.
  2563
  2564     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2565        (CP-EARN-AS-NET-PAY)
  2566        GO TO 9999-CALC-RATE-PREM-X.
  2567
  2568     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2569        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  2570        (CP-TRUNCATED-LIFE)
  2571        GO TO 9999-CALC-RATE-PREM-X.
  2572
  2573     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2574        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  2575        (CP-EARN-AS-NET-PAY)
  2576*       (CP-TRUNCATED-LIFE)
  2577        GO TO 9999-CALC-RATE-PREM-X.
  2578
  2579     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2580        (CP-STATE-STD-ABBRV EQUAL 'RI')
  2581                   AND
  2582        ((CP-EARN-AS-NET-PAY)
  2583               OR
  2584        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  2585        GO TO 9999-CALC-RATE-PREM-X.
  2586
  2587     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2588        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  2589        (CP-EARN-AS-NET-PAY) AND
  2590        (CP-SPECIAL-CALC-CD EQUAL 'H')
  2591        GO TO 9999-CALC-RATE-PREM-X.
  2592
  2593     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2594        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  2595        (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  50
* ELRATE.cbl
  2596        GO TO 9999-CALC-RATE-PREM-X.
  2597
  2598     IF CP-COMPANY-ID = 'CID' or 'AHL'
  2599        CONTINUE
  2600     ELSE
  2601        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2602           (CP-EARN-AS-NET-PAY) AND
  2603           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  2604           GO TO 9999-CALC-RATE-PREM-X
  2605        END-IF
  2606     END-IF
  2607
  2608     IF (CP-COMPANY-ID = 'CID')
  2609        AND (CP-EARN-AS-NET-PAY)
  2610        AND (CP-STATE-STD-ABBRV = 'ME')
  2611        GO TO 9999-CALC-RATE-PREM-X
  2612     END-IF
  2613     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2614        AND (CP-BEN-CATEGORY = 'D')
  2615        AND (CP-EARN-AS-NET-PAY)
  2616        GO TO 9999-CALC-RATE-PREM-X
  2617     END-IF
  2618     IF (CP-COMPANY-ID = 'CID')
  2619        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2620           OR 'IN' OR 'AZ')
  2621        AND (CP-FARM-PLAN)
  2622        GO TO 9999-CALC-RATE-PREM-X
  2623     END-IF
  2624     IF (CP-COMPANY-ID = 'CID') AND
  2625        (CP-EARN-AS-NET-PAY) AND
  2626        (CP-LEVEL-LIFE) AND
  2627        (CP-STATE-STD-ABBRV = 'CA' OR 'MN') AND
  2628        (CP-STATE-STD-ABBRV = CP-STATE)
  2629        GO TO 9999-CALC-RATE-PREM-X
  2630     END-IF
  2631
  2632     IF (CP-COMPANY-ID = 'CID') AND
  2633        (CP-EARN-AS-NET-PAY) AND
  2634        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  2635                            OR 'VT')
  2636                   OR
  2637        ((CP-STATE-STD-ABBRV = 'IN') AND
  2638        (CP-CERT-EFF-DT > X'9A7F'))
  2639                   OR
  2640        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  2641        (CP-CERT-EFF-DT > X'9ADF'))) AND
  2642        (CP-STATE-STD-ABBRV = CP-STATE)
  2643        GO TO 9999-CALC-RATE-PREM-X
  2644     END-IF
  2645
  2646     IF (CP-COMPANY-ID = 'CID') AND
  2647        (CP-EARN-AS-NET-PAY) AND
  2648        (CP-STATE-STD-ABBRV = 'TX') AND
  2649        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2650        (WS-DISCOUNT-OPTION NOT = ' ')
  2651        GO TO 9999-CALC-RATE-PREM-X
  2652     END-IF
  2653
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  51
* ELRATE.cbl
  2654     if (cp-company-id = 'CID')
  2655        and (cp-state-std-abbrv = 'WA' or 'AL')
  2656        and (rt-discount-option = '1')
  2657        and (cp-earn-as-farm-plan)
  2658        go to 9999-calc-rate-prem-x
  2659     end-if
  2660     if (cp-company-id = 'CID')
  2661        and (cp-earn-as-reg-balloon)
  2662        and (cp-ben-category = 'P' or 'I')
  2663        GO TO 9999-CALC-RATE-PREM-X
  2664     end-if
  2665     IF (CP-COMPANY-ID = 'CID')
  2666        AND (CP-STATE-STD-ABBRV = 'MN')
  2667        AND (RT-DISCOUNT-OPTION = '1')
  2668        AND (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON OR
  2669           CP-EARN-AS-FARM-PLAN)
  2670        GO TO 9999-CALC-RATE-PREM-X
  2671     END-IF
  2672     IF (CP-COMPANY-ID = 'CID')
  2673        AND (CP-EARN-AS-NET-PAY)
  2674        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  2675                      OR
  2676            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  2677        GO TO 9999-CALC-RATE-PREM-X
  2678     END-IF
  2679     IF (CP-COMPANY-ID = 'CID')
  2680        AND (CP-EARN-AS-NET-PAY)
  2681        AND (CP-STATE-STD-ABBRV = 'SC')
  2682        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2683        GO TO 9999-CALC-RATE-PREM-X
  2684     END-IF
  2685     IF (CP-COMPANY-ID = 'CID') AND
  2686        (CP-EARN-AS-NET-PAY) AND
  2687        (CP-TRUNCATED-LIFE) AND
  2688        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  2689        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2690        (WS-DISCOUNT-OPTION NOT = ' ')
  2691        GO TO 9999-CALC-RATE-PREM-X
  2692     END-IF
  2693
  2694     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP') AND
  2695        (CP-EARN-AS-NET-PAY)
  2696        MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE
  2697        GO TO 9999-CALC-RATE-PREM-X
  2698     END-IF
  2699
  2700     IF (CP-COMPANY-ID EQUAL 'CID')
  2701        AND (CP-EARN-AS-NET-PAY)
  2702        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2703        GO TO 9999-CALC-RATE-PREM-X
  2704     END-IF
  2705
  2706     IF (RT-IS-OB) AND
  2707        (CP-COMPANY-ID NOT EQUAL 'CID')
  2708        COMPUTE CP-PREMIUM-RATE ROUNDED =
  2709               (CP-PREMIUM-RATE * 12) / CP-LOAN-TERM
  2710      ELSE
  2711         IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  52
* ELRATE.cbl
  2712            AND (CP-RATE-DEV-PCT NOT = ZEROS)
  2713            COMPUTE CP-CALC-PREMIUM ROUNDED =
  2714*           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2715             (CP-PREMIUM-RATE * CP-RATE-DEV-PCT * 12) /
  2716               CP-ORIGINAL-TERM
  2717             MOVE CP-CALC-PREMIUM TO CP-PREMIUM-RATE
  2718             MOVE ZEROS          TO CP-RATE-DEV-PCT
  2719        ELSE
  2720           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2721               (CP-PREMIUM-RATE * 12) / CP-ORIGINAL-TERM
  2722        END-IF
  2723     END-IF
  2724
  2725     IF CP-ROA-PREM-AT-REFUND
  2726         COMPUTE NET-BEN ROUNDED =
  2727             (CP-REMAINING-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000
  2728     ELSE
  2729         COMPUTE NET-BEN ROUNDED =
  2730              (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000.
  2731
  2732     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2733        (CP-TERM-OR-EXT-DAYS NOT = ZERO)
  2734          COMPUTE NET-BEN ROUNDED =
  2735              NET-BEN * (1 + (CP-LOAN-APR / 1200) *
  2736                         (CP-TERM-OR-EXT-DAYS / 30)).
  2737
  2738     IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'CID' OR 'MON' OR 'HAN'
  2739*       OR 'DCC'
  2740*    IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'MON' OR 'HAN'
  2741     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2742       (N-P-FACTOR * CP-PREMIUM-RATE * CP-ORIGINAL-TERM / 1200) /
  2743       (1 - (N-P-FACTOR * CP-PREMIUM-RATE
  2744                        * CP-ORIGINAL-TERM / 1200))
  2745     ELSE
  2746     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2747       (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200) /
  2748       (1 - (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200)).
  2749
  2750****** THE BELOW VERSION OF THE NET PAY FORMULA IS USED WHEN NO
  2751****** INTEREST IS CHARGED ON PREMIUM.
  2752
  2753*    IF CP-STATE-STD-ABBRV = 'MI'
  2754*         COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2755*          (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200).
  2756
  2757     MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE.
  2758
  2759     GO TO 9999-CALC-RATE-PREM-X.
  2760
  2761******
  2762****** BELOW ARE PREMIUM CALCULATIONS FOR CSL
  2763******
  2764
  2765 1250-CSL-CALC.
  2766     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2767     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2768     MOVE '1' TO DC-OPTION-CODE.
  2769     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  53
* ELRATE.cbl
  2770
  2771     IF DATE-CONVERSION-ERROR
  2772         MOVE '2' TO CP-RETURN-CODE
  2773         GO TO 9999-CALC-RATE-PREM-X.
  2774
  2775     IF CP-JOINT-INDICATOR = 'J'
  2776         MOVE RT-L-RATE (3) TO WK-RED-RATE
  2777     ELSE
  2778         MOVE RT-L-RATE (1) TO WK-RED-RATE.
  2779
  2780     MOVE WK-RED-RATE TO CP-PREMIUM-RATE.
  2781     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2782
  2783     IF CP-PAY-FREQUENCY = 12
  2784         MOVE 01               TO WS-PAY-SCH.
  2785     IF CP-PAY-FREQUENCY = 04
  2786         MOVE 03               TO WS-PAY-SCH.
  2787     IF CP-PAY-FREQUENCY = 02
  2788         MOVE 06               TO WS-PAY-SCH.
  2789     IF CP-PAY-FREQUENCY = 01
  2790         MOVE 12               TO WS-PAY-SCH.
  2791
  2792     COMPUTE WS-NUM-PAYMTS = CP-ORIGINAL-TERM / WS-PAY-SCH.
  2793     IF CP-PAY-FREQUENCY NOT = 12
  2794         COMPUTE WK-PAY-AMT = CP-REMAINING-BENEFIT /
  2795                                WS-NUM-PAYMTS.
  2796
  2797     IF CP-STATE = 'SC'  AND
  2798       (CP-BENEFIT-CD = '07'  OR  '08')
  2799         GO TO 1250-CSL-CALC-LIFE-6.
  2800
  2801     IF CP-CSL-METH-1
  2802         GO TO 1250-CSL-CALC-LIFE-1.
  2803
  2804     IF CP-CSL-METH-2
  2805         IF (WK-PAY-AMT * CP-LOAN-TERM) GREATER THAN
  2806                          WS-MAX-TOT-BEN
  2807             GO TO 1250-CSL-CALC-LIFE-2
  2808         ELSE
  2809             GO TO 1250-CSL-CALC-LIFE-1.
  2810
  2811     IF CP-CSL-METH-3
  2812         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2813             GO TO 1250-CSL-CALC-LIFE-2
  2814         ELSE
  2815             GO TO 1250-CSL-CALC-LIFE-3.
  2816
  2817     IF CP-CSL-METH-4
  2818         IF (WK-PAY-AMT * WS-NUM-PAYMTS) GREATER THAN
  2819                          WS-MAX-TOT-BEN
  2820             GO TO 1250-CSL-CALC-LIFE-5
  2821         ELSE
  2822             GO TO 1250-CSL-CALC-LIFE-4.
  2823
  2824 1250-CSL-CALC-LIFE-1.
  2825     IF CP-JOINT-INDICATOR = 'J'
  2826         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2827     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  54
* ELRATE.cbl
  2828         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2829
  2830     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY) /
  2831                    365) - 1) * 365 / 12.
  2832     COMPUTE WK-S ROUNDED = ((144 * WK-D * WK-LEV-RATE) +
  2833                    (365 * WS-NUM-PAYMTS * WK-RED-RATE)) /
  2834                    4380.
  2835     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PAY-AMT *
  2836                    WS-NUM-PAYMTS * WK-S.
  2837
  2838     GO TO 9999-CALC-RATE-PREM-X.
  2839
  2840 1250-CSL-CALC-LIFE-2.
  2841     IF CP-JOINT-INDICATOR = 'J'
  2842         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2843     ELSE
  2844         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2845
  2846     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2847     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2848     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2849                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2850                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2851     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2852                    WK-S) + WK-D.
  2853
  2854     GO TO 9999-CALC-RATE-PREM-X.
  2855
  2856 1250-CSL-CALC-LIFE-3.
  2857     IF CP-JOINT-INDICATOR = 'J'
  2858         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2859     ELSE
  2860         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2861
  2862     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2863     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2864     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2865                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2866                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2867     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2868                    WK-S) + WK-D.
  2869
  2870     GO TO 9999-CALC-RATE-PREM-X.
  2871
  2872 1250-CSL-CALC-LIFE-4.
  2873     IF CP-JOINT-INDICATOR = 'J'
  2874         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2875     ELSE
  2876         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2877
  2878     COMPUTE WK-D = DC-ELAPSED-DAYS * 12 / 365.
  2879     COMPUTE WK-S ROUNDED =
  2880                    (((6 * (WS-NUM-PAYMTS - 1)) + (WK-D *
  2881                    CP-PAY-FREQUENCY)) * WK-LEV-RATE) /
  2882                    CP-PAY-FREQUENCY.
  2883     COMPUTE CP-CALC-PREMIUM ROUNDED =  WK-PAY-AMT *
  2884                    WS-NUM-PAYMTS * WK-S.
  2885
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  55
* ELRATE.cbl
  2886     GO TO 9999-CALC-RATE-PREM-X.
  2887
  2888 1250-CSL-CALC-LIFE-5.
  2889     IF CP-JOINT-INDICATOR = 'J'
  2890         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2891     ELSE
  2892         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2893
  2894     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2895     COMPUTE WK-S ROUNDED = (6 * (WK-K + 1) * WK-LEV-RATE) /
  2896                    CP-PAY-FREQUENCY.
  2897     COMPUTE WK-U = ((((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2898                    - 1) + WS-NUM-PAYMTS) * 12) /
  2899                    CP-PAY-FREQUENCY.
  2900     COMPUTE WK-L = WK-U - (12 * WK-K / CP-PAY-FREQUENCY).
  2901     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-L * WK-LEV-RATE *
  2902                    WS-MAX-TOT-BEN) + (WK-K * WK-PAY-AMT * WK-S).
  2903
  2904     GO TO 9999-CALC-RATE-PREM-X.
  2905
  2906 1250-CSL-CALC-LIFE-6.
  2907
  2908     COMPUTE CP-PREMIUM-RATE ROUNDED =
  2909                (CP-PREMIUM-RATE * CP-ORIGINAL-TERM) / 12.
  2910
  2911     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2912                    CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE.
  2913
  2914     GO TO 9999-CALC-RATE-PREM-X.
  2915
  2916******
  2917****** END OF PREMIUM CALCULATIONS FOR CSL
  2918******
  2919
  2920 1260-GTL-PA-LEASE.
  2921
  2922     IF CP-REDUCING-LIFE
  2923         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2924                                 TO  CP-PREMIUM-RATE
  2925         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2926                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / +100
  2927     ELSE
  2928         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2929                                 TO  CP-PREMIUM-RATE
  2930         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2931                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE *
  2932                 (+1 + CP-SALES-TAX) / +100.
  2933
  2934     GO TO 9999-CALC-RATE-PREM-X.
  2935
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  56
* ELRATE.cbl
  2937******************************************************************
  2938 2000-TYPE-IS-AH.
  2939     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  2940
  2941     MOVE ZERO                      TO CP-R-MAX-AGE
  2942                                       CP-R-MAX-TERM
  2943                                       CP-R-MAX-MON-BEN
  2944                                       CP-R-MAX-TOT-BEN.
  2945
  2946     IF RT-CANCEL-FEE NUMERIC
  2947        MOVE RT-CANCEL-FEE          TO CP-CANCEL-FEE.
  2948
  2949     IF RT-COMPOSITE-RATE NOT NUMERIC
  2950        MOVE ZEROS                          TO RT-COMPOSITE-RATE.
  2951
  2952     IF CP-ORIGINAL-TERM > ZERO AND < 361
  2953        MOVE RT-AH-RATE (CP-ORIGINAL-TERM)
  2954                                 TO CP-PREMIUM-RATE
  2955                                    WS-PREMIUM-RATE
  2956        MOVE RT-COMPOSITE-RATE   TO CP-COMPOSITE-RATE
  2957     ELSE
  2958         MOVE +0                 TO CP-PREMIUM-RATE
  2959                                    CP-CALC-PREMIUM
  2960         GO TO 9999-CALC-RATE-PREM-X
  2961     END-IF
  2962
  2963     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2964        AND (CP-DDF-SPEC-CALC = 'T')
  2965        AND (CP-LOAN-TERM > ZERO AND < 361)
  2966        MOVE RT-AH-RATE (CP-LOAN-TERM)
  2967                                 TO CP-PREMIUM-RATE
  2968                                    WS-PREMIUM-RATE
  2969     END-IF
  2970*    IF (CP-COMPANY-ID = 'DCC')
  2971*       AND ((CP-BENEFIT-CD (1:1) = 'P')
  2972*       OR (CP-DDF-SPEC-CALC = 'T'))
  2973*       AND (CP-LOAN-TERM > ZERO AND < 361)
  2974*       MOVE RT-AH-RATE (CP-LOAN-TERM)
  2975*                                TO CP-PREMIUM-RATE
  2976*                                   WS-PREMIUM-RATE
  2977*    END-IF
  2978     MOVE +1 TO AHNDX.
  2979
  2980     IF CP-COMPANY-ID EQUAL 'CRI'
  2981        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2982           MOVE +5               TO AHNDX
  2983           IF RT-AH-AGE (AHNDX) EQUAL ZERO
  2984              MOVE 'F'           TO CP-RETURN-CODE
  2985              GO TO 2200-CALCULATE-PREMIUMS.
  2986
  2987     IF RT-AH-AGE (AHNDX) = ZERO
  2988          GO TO 2200-CALCULATE-PREMIUMS.
  2989
  2990 2100-SEARCH-AH-LIMITS.
  2991
  2992     IF CP-COMPANY-ID EQUAL 'CRI'
  2993        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2994           IF AHNDX GREATER THAN +4
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  57
* ELRATE.cbl
  2995              MOVE 'A'             TO CP-RETURN-CODE
  2996              GO TO 2200-CALCULATE-PREMIUMS.
  2997
  2998     IF AHNDX GREATER +8
  2999         MOVE 'A'                TO CP-RETURN-CODE
  3000         GO TO 2200-CALCULATE-PREMIUMS.
  3001
  3002     IF CP-ISSUE-AGE GREATER RT-AH-AGE (AHNDX)
  3003         IF RT-AH-AGE (AHNDX) = ZEROS
  3004             ADD +1               TO AHNDX
  3005             GO TO 2100-SEARCH-AH-LIMITS
  3006         ELSE
  3007             MOVE RT-AH-AGE (AHNDX)
  3008                                 TO CP-R-MAX-AGE
  3009             MOVE RT-AH-TERM (AHNDX)
  3010                                 TO CP-R-MAX-TERM
  3011             MOVE RT-AH-BEN-M (AHNDX)
  3012                                 TO CP-R-MAX-MON-BEN
  3013             ADD +1               TO AHNDX
  3014             GO TO 2100-SEARCH-AH-LIMITS
  3015     ELSE
  3016         MOVE RT-AH-AGE  (AHNDX) TO CP-R-MAX-AGE
  3017         MOVE RT-AH-TERM (AHNDX) TO CP-R-MAX-TERM
  3018         MOVE RT-AH-BEN-M (AHNDX)
  3019                                 TO CP-R-MAX-MON-BEN.
  3020
  3021     IF CP-ORIGINAL-TERM GREATER RT-AH-TERM (AHNDX)
  3022         MOVE '9'                 TO CP-RETURN-CODE.
  3023
  3024     IF CP-ORIGINAL-BENEFIT GREATER RT-AH-BEN-M (AHNDX)
  3025         MOVE '8'                 TO CP-RETURN-CODE.
  3026
  3027     MULTIPLY CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  3028         GIVING WS-AH-FACE-BENEFIT.
  3029
  3030     IF WS-AH-FACE-BENEFIT GREATER RT-AH-BEN-F (AHNDX)
  3031         MOVE 'C'                 TO CP-RETURN-CODE.
  3032
  3033 2200-CALCULATE-PREMIUMS.
  3034
  3035     IF CP-COMPANY-ID = 'CSL'
  3036         GO TO 2250-CSL-CALC.
  3037
  3038*    IF CP-CRITICAL-PERIOD
  3039*       GO TO 2200-CRITICAL-PERIOD-AH-CONT.
  3040
  3041     IF CP-CRITICAL-PERIOD
  3042        IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3043           AND ((CP-BENEFIT-CD (1:1) = 'N' OR 'M' OR 'H'
  3044               OR 'S' OR 'P')
  3045                          OR
  3046                (CP-BEN-CATEGORY = 'G' OR 'L'))
  3047           CONTINUE
  3048        ELSE
  3049           GO TO 2200-CRITICAL-PERIOD-AH-CONT
  3050        END-IF
  3051     END-IF
  3052
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  58
* ELRATE.cbl
  3053     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3054        AND (CP-BEN-CATEGORY = 'D')
  3055        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  3056           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  3057     END-IF
  3058     IF (CP-COMPANY-ID = 'CID')
  3059        AND (CP-STATE-STD-ABBRV = 'AL')
  3060        and (cp-pmt-mode <> spaces and low-values)
  3061        continue
  3062     else
  3063        go to 2200-continue
  3064     end-if
  3065
  3066     evaluate true
  3067        when cp-pmt-mode = 'B' *> Bi-Weekly
  3068           move 26               to c-pmts-per-year
  3069           move 14               to c-days-in-pmt-per
  3070        when cp-pmt-mode = 'W' *> Weekly
  3071           move 52               to c-pmts-per-year
  3072           move 07               to c-days-in-pmt-per
  3073        when cp-pmt-mode = 'S' *> Semi-Monthly
  3074           move 24               to c-pmts-per-year
  3075           move 15               to c-days-in-pmt-per
  3076        when cp-pmt-mode = 'A' *> Annual
  3077           move 1                to c-pmts-per-year
  3078           move 360              to c-days-in-pmt-per
  3079        when cp-pmt-mode = 'T' *> Semi-Annual
  3080           move 2                to c-pmts-per-year
  3081           move 180              to c-days-in-pmt-per
  3082        when cp-pmt-mode = 'Q' *> Quarterly
  3083           move 4                to c-pmts-per-year
  3084           move 90               to c-days-in-pmt-per
  3085        when cp-pmt-mode = 'N' *> Bi-Monthly ??
  3086           move 6                to c-pmts-per-year
  3087           move 60               to c-days-in-pmt-per
  3088        when other             *> Assume Monthly
  3089           move 12               to c-pmts-per-year
  3090           move 30               to c-days-in-pmt-per
  3091     end-evaluate
  3092
  3093     compute c-tot-pmts =
  3094        cp-original-term / 12 * c-pmts-per-year
  3095
  3096     compute wk7 rounded =    *> tv3
  3097        (cp-original-benefit * +12) / c-pmts-per-year
  3098
  3099     compute wk6 rounded =
  3100        (wk7 * c-tot-pmts / 100) * cp-premium-rate
  3101
  3102     move wk6                    to cp-calc-premium
  3103
  3104     GO TO 9999-CALC-RATE-PREM-X
  3105
  3106     .
  3107 2200-continue.
  3108     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  3109        COMPUTE WS-TERM-MINUS-ONE EQUAL CP-ORIGINAL-TERM - +1
  3110        MOVE RT-AH-RATE (WS-TERM-MINUS-ONE) TO
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  59
* ELRATE.cbl
  3111                                     CP-PREMIUM-RATE
  3112        COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  3113        (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM - +1) *
  3114        CP-PREMIUM-RATE) / +100
  3115     ELSE
  3116        IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3117           AND (CP-BEN-CATEGORY NOT = 'G' AND 'L')
  3118           MOVE CP-PREMIUM-RATE  TO WK-S
  3119*          MOVE CP-PREMIUM-RATE  TO CP-CALC-PREMIUM
  3120           IF CP-RATE-DEV-PCT NOT = ZEROS
  3121              COMPUTE WK-S ROUNDED =
  3122                 (CP-PREMIUM-RATE * CP-RATE-DEV-PCT)
  3123           END-IF
  3124           IF CP-BENEFIT-CD (1:1) = 'M'
  3125              COMPUTE CP-CALC-PREMIUM ROUNDED =
  3126              CP-ORIGINAL-BENEFIT * WK-S / 100
  3127           ELSE
  3128              IF CP-BENEFIT-CD (1:1) = 'H'
  3129                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  3130                    (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  3131                    WK-S) / 1000
  3132              ELSE
  3133                 IF CP-BENEFIT-CD (1:1) = 'N' OR 'S'
  3134                    GO TO 2300-CALC-DCC-MOB-NET-AH
  3135                 ELSE
  3136                    IF CP-BEN-CATEGORY = 'D'
  3137                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  3138                        CP-ORIGINAL-BENEFIT *
  3139                        CP-ORIGINAL-TERM * WK-S / 100
  3140                    ELSE
  3141                      IF CP-BENEFIT-CD (1:1) = 'P'
  3142                         GO TO 2300-CALC-DCC-BEN-P-AH
  3143                      ELSE
  3144                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  3145                        (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  3146                        WK-S) / 100
  3147                      END-IF
  3148                    END-IF
  3149                 END-IF
  3150              END-IF
  3151           END-IF
  3152           MOVE ZEROS            TO CP-RATE-DEV-PCT
  3153        ELSE
  3154           IF CP-BENEFIT-CD (1:1) = 'M'
  3155              COMPUTE CP-CALC-PREMIUM ROUNDED =
  3156                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 100
  3157           ELSE
  3158              IF CP-BENEFIT-CD (1:1) = 'N' OR 'H'
  3159                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  3160                    (CP-NET-BENEFIT-AMT *
  3161                    CP-PREMIUM-RATE) / 1000
  3162              ELSE
  3163                 IF CP-AH-BALLOON-SW = 'Y'
  3164                    COMPUTE CP-CALC-PREMIUM ROUNDED =
  3165                      (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM) *
  3166                      CP-PREMIUM-RATE) / 100
  3167                 ELSE
  3168                   COMPUTE CP-CALC-PREMIUM ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  60
* ELRATE.cbl
  3169                    (CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM *
  3170                    CP-PREMIUM-RATE) / 100
  3171                 END-IF
  3172              END-IF
  3173           END-IF
  3174        END-IF
  3175     END-IF
  3176
  3177     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3178        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  3179        COMPUTE CP-CALC-PREMIUM = CP-PREMIUM-RATE * +1000
  3180     END-IF
  3181     IF CP-TERM-OR-EXT-DAYS = ZEROS
  3182         GO TO 9999-CALC-RATE-PREM-X.
  3183
  3184     IF CP-EXT-CHG-AH OR CP-EXT-CHG-LF-AH
  3185         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3186             CP-CALC-PREMIUM +
  3187                 (((CP-CALC-PREMIUM / CP-ORIGINAL-TERM) / 30)
  3188                                       * CP-TERM-OR-EXT-DAYS).
  3189
  3190     GO TO 9999-CALC-RATE-PREM-X.
  3191
  3192 2200-CRITICAL-PERIOD-AH-CONT.
  3193
  3194     IF CP-COMPANY-ID = 'WDS'
  3195         IF CP-ORIGINAL-TERM GREATER THAN 60
  3196             MOVE 60              TO CP-LOAN-TERM.
  3197
  3198     IF CP-COMPANY-ID EQUAL 'CVL'
  3199         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3200           ((CP-ORIGINAL-BENEFIT * CP-CRITICAL-MONTHS) / +100)
  3201                                       * CP-PREMIUM-RATE
  3202         GO TO 9999-CALC-RATE-PREM-X.
  3203
  3204     COMPUTE CP-CALC-PREMIUM ROUNDED =
  3205           ((CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM) / +100)
  3206                                       * CP-PREMIUM-RATE.
  3207
  3208     GO TO 9999-CALC-RATE-PREM-X.
  3209
  3210 2250-CSL-CALC.
  3211
  3212     IF RT-DAILY-RATE NOT NUMERIC OR
  3213        RT-DAILY-RATE = ZEROS
  3214            MOVE ZEROS TO CP-CALC-PREMIUM
  3215            MOVE '7' TO CP-RETURN-CODE
  3216            GO TO 9999-CALC-RATE-PREM-X.
  3217
  3218     COMPUTE WK-DAILY-RATE = RT-DAILY-RATE / 100.
  3219     COMPUTE WK-MONTHLY-RATE =
  3220          RT-AH-RATE (CP-ORIGINAL-TERM) / 100.
  3221
  3222     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3223     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  3224     MOVE '1' TO DC-OPTION-CODE.
  3225     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3226     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  61
* ELRATE.cbl
  3227         MOVE '2' TO CP-RETURN-CODE
  3228         GO TO 9999-CALC-RATE-PREM-X.
  3229
  3230     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  3231     IF CP-CSL-METH-1
  3232         GO TO 2250-CSL-CALC-AH-1.
  3233     IF CP-CSL-METH-2
  3234         GO TO 2250-CSL-CALC-AH-2.
  3235     IF CP-CSL-METH-3
  3236         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  3237             GO TO 2250-CSL-CALC-AH-4
  3238         ELSE
  3239             GO TO 2250-CSL-CALC-AH-3.
  3240
  3241 2250-CSL-CALC-AH-1.
  3242
  3243     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3244     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3245                    + WK-MONTHLY-RATE.
  3246     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-MONTHLY-PAYMENT *
  3247                    CP-ORIGINAL-TERM * WK-D.
  3248
  3249     GO TO 9999-CALC-RATE-PREM-X.
  3250
  3251
  3252 2250-CSL-CALC-AH-2.
  3253     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3254     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3255                    + WK-MONTHLY-RATE.
  3256     COMPUTE CP-CALC-PREMIUM ROUNDED = WS-MAX-MON-BEN *
  3257                    CP-ORIGINAL-TERM * WK-D.
  3258
  3259     GO TO 9999-CALC-RATE-PREM-X.
  3260
  3261 2250-CSL-CALC-AH-3.
  3262
  3263     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3264     COMPUTE WK-T = WK-K + 1.
  3265     COMPUTE WK-MONTHLY-RATE-T =
  3266          RT-AH-RATE (WK-T) / 100.
  3267     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3268
  3269     COMPUTE WK-T1 = WK-K * (CP-ORIGINAL-TERM - WK-T).
  3270     IF WK-T1 EQUAL ZEROS
  3271         MOVE ZEROS TO CP-CALC-PREMIUM
  3272         MOVE 'G' TO CP-RETURN-CODE
  3273         GO TO 9999-CALC-RATE-PREM-X.
  3274
  3275     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3276                    WK-MONTHLY-RATE)) / (WK-K * (CP-ORIGINAL-TERM
  3277                    - WK-T)).
  3278     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3279     COMPUTE WK-PREM = ((CP-ORIGINAL-TERM -
  3280                       (WK-K + 1) + (WK-D - 1))) * (WK-C *
  3281                       WS-MAX-TOT-BEN).
  3282     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * (WK-K + 1) *
  3283                    WK-MONTHLY-RATE-T) + WK-PREM.
  3284
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  62
* ELRATE.cbl
  3285     GO TO 9999-CALC-RATE-PREM-X.
  3286
  3287 2250-CSL-CALC-AH-4.
  3288     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3289     COMPUTE WK-J = WS-MAX-TOT-BEN / WS-MAX-MON-BEN.
  3290     COMPUTE WK-MONTHLY-RATE-J =
  3291          RT-AH-RATE (WK-J) / 100.
  3292     COMPUTE WK-T = WK-J + 1.
  3293     COMPUTE WK-MONTHLY-RATE-T =
  3294          RT-AH-RATE (WK-T) / 100.
  3295     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3296     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3297                    WK-MONTHLY-RATE)) / ((WK-T - 1) *
  3298                    (CP-ORIGINAL-TERM - WK-T)).
  3299     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3300     COMPUTE WK-PREM = (CP-ORIGINAL-TERM -
  3301                       (WK-J + 1) + (WK-D - 1)) * (WK-C *
  3302                       WS-MAX-TOT-BEN).
  3303     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PREM + ((WK-J + 1) *
  3304                   (WS-MAX-MON-BEN * WK-MONTHLY-RATE-T)).
  3305
  3306     GO TO 9999-CALC-RATE-PREM-X.
  3307
  3308 2300-CALC-DCC-BEN-P-AH.
  3309     IF CP-NO-OF-PMTS NOT NUMERIC
  3310        MOVE +0                  TO CP-NO-OF-PMTS
  3311     END-IF
  3312     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  3313        AND ' ' AND 'M'
  3314        MOVE ' '                 TO CP-PMT-MODE
  3315     END-IF
  3316******************************************************************
  3317***   Default is monthly, use loan term for rate and amort     ***
  3318******************************************************************
  3319     move cp-loan-term         to c-tot-pmts
  3320     MOVE +30                  TO C-DAYS-IN-PMT-PER
  3321     MOVE +12                  TO C-PMTS-PER-YEAR
  3322******************************************************************
  3323
  3324     evaluate true
  3325        when cp-pmt-mode = 'W'
  3326           MOVE +52              TO C-PMTS-PER-YEAR
  3327           compute c-tot-pmts = cp-loan-term /
  3328              12 * c-pmts-per-year
  3329           MOVE +7               TO C-DAYS-IN-PMT-PER
  3330        when cp-pmt-mode = 'B'
  3331           MOVE +26              TO C-PMTS-PER-YEAR
  3332           compute c-tot-pmts = cp-loan-term /
  3333              12 * c-pmts-per-year
  3334           MOVE +14              TO C-DAYS-IN-PMT-PER
  3335     end-evaluate
  3336     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3337     if i = zeros
  3338        move .0000000001         to i
  3339     end-if
  3340     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3341        C-DAYS-IN-PMT-PER)) / (1 + I)
  3342     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  63
* ELRATE.cbl
  3343     COMPUTE ANGLEN-1 = ANGLEN / Y
  3344     COMPUTE WK3 = (CP-NET-BENEFIT-AMT - CP-ORIGINAL-PREMIUM)
  3345        / ANGLEN-1
  3346     if cp-net-benefit-amt = zeros
  3347        compute wk3 = cp-original-benefit - cp-original-premium
  3348     end-if
  3349     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * WK-S
  3350     GO TO 9999-CALC-RATE-PREM-X
  3351     .
  3352 2300-CALC-DCC-MOB-NET-AH.
  3353     IF CP-ALTERNATE-BENEFIT = ZEROS
  3354        CONTINUE
  3355     ELSE
  3356        GO TO 2300-CALC-DCC-MOB-BAL-AH
  3357     END-IF
  3358     MOVE CP-ORIGINAL-TERM       TO M
  3359     MOVE CP-LOAN-TERM           TO N
  3360     IF N = ZEROS
  3361        MOVE M                   TO N
  3362     END-IF
  3363     COMPUTE I = CP-LOAN-APR / +1200
  3364     if i = zeros
  3365        move .0000000001         to i
  3366     end-if
  3367     IF CP-BENEFIT-CD (1:1) = 'S'
  3368        COMPUTE OD = CP-DAYS-TO-1ST-PMT - 30
  3369        COMPUTE WK3 = CP-ORIGINAL-BENEFIT *
  3370        ((M * (M + 1) / 2) + (M * OD / 30)) *
  3371          (WK-S / 1000)
  3372          * 1
  3373        MOVE WK3                 TO CP-CALC-PREMIUM
  3374        GO TO 9999-CALC-RATE-PREM-X
  3375     END-IF
  3376     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3377        / (1 + I)
  3378     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3379          ** ((N - M) * -1))) / I)
  3380     COMPUTE ANGLEN-M = ANGLEN-M / OD
  3381     COMPUTE J = I + (WK-S / +1000)
  3382     COMPUTE WK2 = (1 + J) ** (M * -1)
  3383     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3384     COMPUTE ANGLEM = ((1 - ((1 + J)
  3385          ** (M * -1))) / J) / OD
  3386     IF CP-NET-BENEFIT-AMT = ZEROS
  3387        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3388           * ANGLEM
  3389     END-IF
  3390     COMPUTE RA = CP-NET-BENEFIT-AMT / (ANGLEM + ANGLEN-M)
  3391     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3392          ** ((N - M) * -1))) / I)
  3393     MOVE +0                     TO WK3
  3394     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3395        (WS-COUNTER > M)
  3396        COMPUTE ANGLEM = (1 - ((1 + J)
  3397          ** ((M - WS-COUNTER + 1) * -1))) / J
  3398        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  3399        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  3400        COMPUTE WK3 = WK3 + (WK5-CSL * WK-S / +1000)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  64
* ELRATE.cbl
  3401     END-PERFORM
  3402     MOVE WK3                    TO CP-CALC-PREMIUM
  3403     GO TO 9999-CALC-RATE-PREM-X
  3404     .
  3405 2300-CALC-DCC-MOB-BAL-AH.
  3406     IF CP-BENEFIT-CD (1:1) = 'S'
  3407        GO TO 2300-CALC-DCC-MOB-BAL-AHSUM
  3408     END-IF
  3409     MOVE CP-ORIGINAL-TERM       TO M
  3410     MOVE CP-LOAN-TERM           TO N
  3411     IF N = ZEROS
  3412        MOVE M                   TO N
  3413     END-IF
  3414     COMPUTE I = CP-LOAN-APR / +1200
  3415     if i = zeros
  3416        move .0000000001         to i
  3417     end-if
  3418     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3419        / (1 + I)
  3420     COMPUTE ANGLEN-M = (WK5 / I) / OD
  3421     COMPUTE J = I + (WK-S / +1000)
  3422     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  3423     MOVE I TO K
  3424     COMPUTE WK2 = (1 + J) ** (M * -1)
  3425     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3426     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  3427          ** ((M - 1) * -1))) / J)
  3428     COMPUTE ANGLEM = ((1 - ((1 + J)
  3429          ** (M * -1))) / J) / OD
  3430     IF CP-NET-BENEFIT-AMT = ZEROS
  3431        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3432           * ANGLEM
  3433     END-IF
  3434     COMPUTE RA = (CP-NET-BENEFIT-AMT * OD -
  3435        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  3436        / ANGLEM-1
  3437     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3438          ** ((N - M) * -1))) / I)
  3439     MOVE +0                     TO WK3
  3440     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3441        (WS-COUNTER > M)
  3442        COMPUTE ANGLEM = (1 - ((1 + J)
  3443          ** ((M - WS-COUNTER) * -1))) / J
  3444        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  3445        COMPUTE WK5-CSL = (RA * ANGLEM)
  3446        + (CP-ALTERNATE-BENEFIT * WK2)
  3447        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  3448          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  3449          (WK-S / 1000)
  3450     END-PERFORM
  3451     MOVE WK3                    TO CP-CALC-PREMIUM
  3452     GO TO 9999-CALC-RATE-PREM-X
  3453     .
  3454 2300-CALC-DCC-MOB-BAL-AHSUM.
  3455     MOVE CP-ORIGINAL-TERM       TO M
  3456     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3457        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  3458        * WK-S / 1000
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  65
* ELRATE.cbl
  3459*    COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3460*       + (M - 1) * ((CP-TERM-OR-EXT-DAYS + 30) - 30) / 30)
  3461*       * WK-S / 1000
  3462     MOVE WK3                    TO CP-CALC-PREMIUM
  3463     GO TO 9999-CALC-RATE-PREM-X
  3464     .
  3465 9999-RATE-NOTFND.
  3466     MOVE '6'                    TO CP-RETURN-CODE.
  3467     GO TO 9999-CALC-RATE-PREM-X.
  3468
  3469 9999-RATE-NOTOPEN.
  3470     MOVE 'D'                    TO CP-RETURN-CODE.
  3471     GO TO 9999-CALC-RATE-PREM-X.
  3472
  3473 9999-CALC-RATE-PREM-X.
  3474     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3475        AND (CP-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
  3476        CONTINUE
  3477     ELSE
  3478        IF CP-RATE-DEV-PCT NOT = ZERO
  3479           COMPUTE CP-CALC-PREMIUM =
  3480              CP-CALC-PREMIUM * CP-RATE-DEV-PCT.
  3481
  3482
  3483     MOVE CALCULATION-PASS-AREA  TO  DFHCOMMAREA.
  3484
  3485     IF WS-BROWSE-STARTED
  3486
  3487* EXEC CICS ENDBR
  3488*            DATASET  (ERRATE-FILE-ID)
  3489*       END-EXEC.
  3490     MOVE 0
  3491       TO DFHEIV11
  3492*    MOVE '&2                    $   #00003445' TO DFHEIV0
  3493     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3494     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3495     MOVE X'2020233030303033343435' TO DFHEIV0(25:11)
  3496     CALL 'kxdfhei1' USING DFHEIV0,
  3497           ERRATE-FILE-ID,
  3498           DFHEIV11,
  3499           DFHEIV99
  3500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3501
  3502
  3503
  3504* EXEC CICS RETURN
  3505*    END-EXEC.
  3506*    MOVE '.(                    ''   #00003449' TO DFHEIV0
  3507     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3508     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3509     MOVE X'2020233030303033343439' TO DFHEIV0(25:11)
  3510     CALL 'kxdfhei1' USING DFHEIV0,
  3511           DFHEIV99,
  3512           DFHEIV99,
  3513           DFHEIV99,
  3514           DFHEIV99,
  3515           DFHEIV99,
  3516           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  66
* ELRATE.cbl
  3517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3518
  3519
  3520 9100-CONVERT-DATE.
  3521
  3522* EXEC CICS LINK
  3523*        PROGRAM  ('ELDATCV')
  3524*        COMMAREA (DATE-CONVERSION-DATA)
  3525*        LENGTH   (DC-COMM-LENGTH)
  3526*    END-EXEC.
  3527     MOVE 'ELDATCV' TO DFHEIV1
  3528*    MOVE '."C                   (   #00003453' TO DFHEIV0
  3529     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3530     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3531     MOVE X'2020233030303033343533' TO DFHEIV0(25:11)
  3532     CALL 'kxdfhei1' USING DFHEIV0,
  3533           DFHEIV1,
  3534           DATE-CONVERSION-DATA,
  3535           DC-COMM-LENGTH,
  3536           DFHEIV99,
  3537           DFHEIV99,
  3538           DFHEIV99,
  3539           DFHEIV99
  3540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3541
  3542
  3543 9100-EXIT.
  3544     EXIT.
  3545
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  67
* ELRATE.cbl
  3547 10000-NET-TERM SECTION.
  3548*                         COPY ERCNETP.
  3549*****************************************************************
  3550*                                                               *
  3551*                            ERCNETP                            *
  3552*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3553*                            VMOD=2.029                         *
  3554*                                                               *
  3555*****************************************************************.
  3556*
  3557*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  3558*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  3559*                                   ORIGINAL TERM (S999)
  3560*                                   REMAINING TERM (S999)
  3561*                                   NET PAY OPTION (X)
  3562*                                   LOAN TERM (S999)
  3563*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  3564*
  3565*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  3566*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  3567*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  3568*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  3569*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  3570*    CHARGED.
  3571*
  3572*    OPTIONS - S = NET SIMPLE
  3573*          SPACE = NET PAY  (1 MO. INTEREST)
  3574*              A = NET PAY  (0 MO. INTEREST)
  3575*              I = NET PAY  (2 MO. INTEREST)
  3576*              J = NET PAY  (3 MO. INTEREST)
  3577*              K = NET PAY  (4 MO. INTEREST)
  3578*              T = TRUNCATED  (0 MO. INTEREST)
  3579*              U = TRUNCATED  (1 MO. INTEREST)
  3580*              V = TRUNCATED  (2 MO. INTEREST)
  3581*              W = TRUNCATED  (3 MO. INTEREST)
  3582*              X = TRUNCATED  (4 MO. INTEREST)
  3583*              R = REFUNDS (REGULAR OR TRUNCATED)
  3584******************************************************************
  3585*                   C H A N G E   L O G
  3586*
  3587* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3588*-----------------------------------------------------------------
  3589*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3590* EFFECTIVE    NUMBER
  3591*-----------------------------------------------------------------
  3592* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  3593* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  3594* 120403                   PEMA  ADD SPECIAL TX CALC
  3595* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3596* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3597* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  3598* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  3599* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  3600* 021207                   PEMA  ADD PA NP
  3601* 022107                   PEMA  ADD NH NP AND NP TRUNC
  3602* 032807                   PEMA  ADD VT NP PLUS 2
  3603* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  3604* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  68
* ELRATE.cbl
  3605* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  3606* 110207      TO 'AL' NET PAY CALC
  3607* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  3608* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  3609* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  3610* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  3611* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  3612* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  3613* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  3614* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3615* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  3616* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3617* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  3618* 032612  CR2011110200001  PEMA  AHL CHANGES
  3619* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  3620* 022613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  3621* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  3622* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  3623* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS FOR NET BALLOON
  3624* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3625* 021519  CR2019021100001  PEMA  non-monthly AL calcs
  3626* 012820  CR2020010600001  PEMA  MOD TX NP FORMULA TO HANDLE TRUNC
  3627* 012820    CONTINUED   AND TO ADJ AF FOR EXTRA DAYS.
  3628******************************************************************
  3629
  3630     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  3631     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  3632     MOVE N-P-LOAN    TO LOAN-TERM.
  3633     MOVE N-P-REM     TO REMAINING-TERM.
  3634     MOVE N-P-OPT     TO OPTION-SW.
  3635
  3636     MOVE +0 TO FACTOR.
  3637     if cp-company-id = 'CID'
  3638        if annual-int-rate = +99.9999
  3639           go to 99000-error
  3640        end-if
  3641     else
  3642        if annual-int-rate = zero
  3643           go to 99000-error
  3644        end-if
  3645     end-if
  3646     IF ORIGINAL-TERM = ZERO
  3647         GO TO 99999-RETURN.
  3648     IF REMAINING-TERM = ZERO
  3649         GO TO 99999-RETURN.
  3650     IF REMAINING-TERM GREATER ORIGINAL-TERM
  3651         GO TO 99000-ERROR.
  3652     IF LOAN-TERM = ZERO
  3653         GO TO 99999-RETURN.
  3654     IF LOAN-TERM LESS ORIGINAL-TERM
  3655         GO TO 99000-ERROR.
  3656
  3657*    IF ANNUAL-INT-RATE LESS +2
  3658*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3659*    IF ANNUAL-INT-RATE LESS +2
  3660*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3661*    IF ANNUAL-INT-RATE LESS +2
  3662*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  69
* ELRATE.cbl
  3663
  3664     IF NPO-REFUND
  3665         MOVE '2' TO NP-PROCESS-SW
  3666       ELSE
  3667         IF ORIGINAL-TERM = REMAINING-TERM
  3668            MOVE '1'   TO NP-PROCESS-SW
  3669           ELSE
  3670            MOVE '3'   TO NP-PROCESS-SW.
  3671
  3672     IF NPO-SIMPLE
  3673         MOVE 'S' TO TYPE-SW
  3674     ELSE
  3675         MOVE 'N' TO TYPE-SW.
  3676
  3677     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  3678     if i = zeros
  3679        move .0000000001         to i
  3680     end-if
  3681
  3682     COMPUTE V ROUNDED = K1 / (K1 + I).
  3683
  3684     MOVE V     TO VX
  3685                   SV.
  3686
  3687     MOVE +1    TO X1
  3688                   SX.
  3689
  3690     MOVE LOAN-TERM TO MAX-X.
  3691
  3692     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  3693
  3694     IF MAX-X = +1
  3695        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  3696
  3697     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  3698
  3699     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  3700         OR 'DCC' or 'VPP' OR 'NCL') AND
  3701        (NOT NP-REFUND)
  3702        NEXT SENTENCE
  3703     ELSE
  3704     IF LOAN-TERM NOT = ORIGINAL-TERM
  3705        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  3706
  3707     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  3708
  3709 10500-VX-LOOP.
  3710
  3711***  VX = AMORT. LOAN TERM.
  3712***  SV = AMORT. INSURANCE TERM.
  3713***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  3714***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  3715***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  3716
  3717     IF X2 = 1
  3718        MOVE V         TO SX
  3719     END-IF
  3720     COMPUTE VX ROUNDED = VX * V.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  70
* ELRATE.cbl
  3721
  3722     ADD B1 TO X1.
  3723
  3724     IF X1 = REMAINING-TERM
  3725          MOVE VX    TO SV.
  3726
  3727     IF X1 EQUAL SV-MINUS-ONE
  3728        MOVE VX      TO SV-MINUS-ONE.
  3729
  3730     IF X1 = X2
  3731          MOVE VX    TO SX.
  3732
  3733     IF X1 NOT = MAX-X
  3734          GO TO 10500-VX-LOOP.
  3735
  3736 10700-COMPUTE-REMAINING-FACTOR.
  3737*****  WK1 = LOAN TERM AMORT
  3738     COMPUTE WK1 = K1 - VX.
  3739*****  WK2 = INS TERM AMORT
  3740     COMPUTE WK2 = K1 - SV.
  3741*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  3742     COMPUTE WK5 = K1 - SX.
  3743*****  WK6 = INS TERM - 1
  3744     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  3745
  3746     IF NP-RATING
  3747         GO TO 12000-PREMIUM-RATE.
  3748
  3749     IF NP-REFUND
  3750         GO TO 11000-REFUND-CALC.
  3751
  3752     IF NET-STD
  3753         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  3754
  3755     IF NET-SMP
  3756         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  3757         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  3758         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  3759         COMPUTE WK3 ROUNDED = WK3 * 1000.
  3760
  3761     IF REMAINING-TERM LESS THAN X2
  3762         MOVE +0 TO WK3.
  3763
  3764     MOVE WK3 TO FACTOR.
  3765
  3766     GO TO 99999-RETURN.
  3767
  3768 11000-REFUND-CALC.
  3769     IF REMAINING-TERM NOT LESS MAX-X
  3770        MOVE +1 TO FACTOR
  3771        GO TO 99999-RETURN.
  3772
  3773     IF REMAINING-TERM LESS +1
  3774        MOVE 0 TO FACTOR
  3775        GO TO 99999-RETURN.
  3776
  3777     COMPUTE WK2 ROUNDED = WK2 / I.
  3778     COMPUTE WK5 ROUNDED = WK5 / I.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  71
* ELRATE.cbl
  3779     COMPUTE WK1 ROUNDED = WK1 / I.
  3780
  3781     IF (CP-COMPANY-ID EQUAL 'CID')
  3782        AND (CP-STATE-STD-ABBRV = 'MN')
  3783        AND (CP-CERT-EFF-DT > X'A4FF')
  3784        AND (CP-RATE-AS-REG-BALLOON)
  3785        AND (CP-EARN-AS-NET-PAY)
  3786        AND (CP-DEVIATION-CODE NOT = 'LEV')
  3787        CONTINUE
  3788     ELSE
  3789        GO TO 11000-CHECK-MN-LEV-BALLOON
  3790     END-IF
  3791
  3792     COMPUTE R = M - E
  3793     COMPUTE FACTOR = (R - WK2 + WK5) /
  3794        (M - WK1 + WK5)
  3795
  3796     GO TO 99999-RETURN
  3797
  3798      .
  3799 11000-CHECK-MN-LEV-BALLOON.
  3800
  3801     IF (CP-COMPANY-ID EQUAL 'CID')
  3802        AND (CP-STATE-STD-ABBRV = 'MN')
  3803        AND (CP-CERT-EFF-DT > X'A4FF')
  3804        AND (CP-RATE-AS-REG-BALLOON)
  3805        AND (CP-EARN-AS-NET-PAY)
  3806        AND (CP-DEVIATION-CODE = 'LEV')
  3807        CONTINUE
  3808     ELSE
  3809        GO TO 11000-CONTINUE-REFUND
  3810     END-IF
  3811
  3812     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3813     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  3814        ** (M - E)) / I
  3815
  3816     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  3817
  3818     GO TO 99999-RETURN
  3819
  3820     .
  3821 11000-CONTINUE-REFUND.
  3822*    IF CP-GAP-ACTUARIAL
  3823*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  3824*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3825*       COMPUTE WK3 = WK2 / ANGLEN
  3826*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  3827     IF CP-GAP-ACTUARIAL
  3828        COMPUTE ANGLEN = WK1 / ((1 + I) **
  3829           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3830        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  3831     ELSE
  3832        COMPUTE WK3 ROUNDED =
  3833          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  3834     END-IF
  3835
  3836     MOVE WK3  TO FACTOR.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  72
* ELRATE.cbl
  3837
  3838     GO TO 99999-RETURN.
  3839
  3840 12000-PREMIUM-RATE.
  3841*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  3842*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  3843*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  3844*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  3845*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  3846*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  3847
  3848     COMPUTE K-I = K1 + I.
  3849     MOVE K-I TO ONE-PLUS-I.
  3850
  3851     IF NPO-ALT OR NPO-TRUNC-0
  3852         MOVE K1 TO K-I.
  3853
  3854     IF NPO-2MO OR NPO-TRUNC-2
  3855         COMPUTE K-I = K1 + (2 * I).
  3856
  3857     IF NPO-3MO OR NPO-TRUNC-3
  3858         COMPUTE K-I = K1 + (3 * I).
  3859
  3860     IF NPO-4MO OR NPO-TRUNC-4
  3861         COMPUTE K-I = K1 + (4 * I).
  3862
  3863     COMPUTE RA ROUNDED = 1 -
  3864             ((X2 * (X2 + 1)) /
  3865              (N *  (N  + 1))).
  3866
  3867     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  3868        (CP-CSL-VALID-NP-BENEFIT-CD)
  3869        NEXT SENTENCE
  3870     ELSE
  3871        GO TO XXXX-CHECK-DISCOUNT-5.
  3872
  3873     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3874     MOVE ' ' TO DC-OPTION-CODE.
  3875     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3876
  3877     IF DATE-CONVERSION-ERROR
  3878        MOVE '2'                 TO CP-RETURN-CODE
  3879        MOVE ZEROS               TO FACTOR
  3880                                    CP-CALC-PREMIUM
  3881         GO TO 99999-RETURN.
  3882
  3883     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  3884     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  3885     MOVE ' ' TO DC-OPTION-CODE
  3886     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3887
  3888     IF DATE-CONVERSION-ERROR
  3889        MOVE '2'                 TO CP-RETURN-CODE
  3890        MOVE ZEROS               TO FACTOR
  3891                                    CP-CALC-PREMIUM
  3892         GO TO 99999-RETURN.
  3893
  3894     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  73
* ELRATE.cbl
  3895
  3896     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
  3897
  3898     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  3899        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  3900        CP-PAY-FREQUENCY / 365) * I
  3901     ELSE
  3902        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  3903        CP-PAY-FREQUENCY / 365) * I.
  3904
  3905     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  3906     13).
  3907
  3908     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  3909     (N - ( ANGLEN-1 / WK3)).
  3910
  3911     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  3912
  3913     COMPUTE WS-CALC-FREQ-RATE EQUAL
  3914       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  3915
  3916     COMPUTE WS-Y-X-FACTOR EQUAL
  3917       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  3918       WS-CALC-FREQ-RATE).
  3919
  3920     COMPUTE WS-ODD-DAY-UNITS EQUAL
  3921       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  3922
  3923     COMPUTE WS-X-Y-FACTOR EQUAL
  3924       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  3925
  3926     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  3927       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  3928       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  3929
  3930     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  3931
  3932     GO TO 99999-RETURN.
  3933
  3934 XXXX-CHECK-DISCOUNT-5.
  3935
  3936     IF WS-DISCOUNT-OPTION EQUAL '5'
  3937        NEXT SENTENCE
  3938     ELSE
  3939        GO TO 12000-CHECK-CLIENT.
  3940
  3941      COMPUTE ANGLEN EQUAL WK1 / I.
  3942
  3943      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3944
  3945      COMPUTE WK3 EQUAL
  3946        (12 *
  3947        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  3948        CP-ORIGINAL-BENEFIT)) /
  3949        APR100.
  3950
  3951     COMPUTE WK3 EQUAL
  3952        (WK3 * CP-PREMIUM-RATE) / +1000.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  74
* ELRATE.cbl
  3953
  3954     COMPUTE WK3 EQUAL
  3955        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  3956
  3957      MOVE WK3 TO CP-CALC-PREMIUM.
  3958
  3959     GO TO 99999-RETURN.
  3960
  3961 12000-CHECK-CLIENT.
  3962
  3963     IF (CP-COMPANY-ID EQUAL 'MON') AND
  3964        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3965        (CP-TRUNCATED-LIFE)
  3966        NEXT SENTENCE
  3967     ELSE
  3968        GO TO 12000-CHECK-NEXT.
  3969
  3970     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3971
  3972     COMPUTE ANGLEN EQUAL WK1 / I.
  3973     COMPUTE ANGLEM EQUAL WK2 / I.
  3974
  3975     COMPUTE FM EQUAL
  3976                    (((ONE-PLUS-I ** M) * I * M) /
  3977                    ((ONE-PLUS-I ** M) - 1))
  3978                    - 1.
  3979
  3980     COMPUTE FN EQUAL
  3981                    (((ONE-PLUS-I ** N) * I * N) /
  3982                    ((ONE-PLUS-I ** N) - 1))
  3983                    - 1.
  3984
  3985     COMPUTE FNM EQUAL
  3986                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  3987                    ((ONE-PLUS-I ** (N - M)) - 1))
  3988                    - 1.
  3989
  3990     COMPUTE GR EQUAL
  3991                    (WS-WORK-RATE * ANGLEM * I) /
  3992                    (M - ANGLEM).
  3993
  3994     COMPUTE ODF EQUAL
  3995                     (1 +
  3996                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  3997                     360)) /
  3998                     ONE-PLUS-I.
  3999
  4000     COMPUTE OD EQUAL
  4001                    (1 + (ODF * (FN / I - 1))) +
  4002                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  4003
  4004     COMPUTE WK3 EQUAL
  4005*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  4006                    ((1 + FN) * ODF *
  4007                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  4008                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  4009                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  4010
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  75
* ELRATE.cbl
  4011     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  4012     COMPUTE WK3 EQUAL TRUNC-PMT * N.
  4013
  4014     COMPUTE WK3 EQUAL
  4015                    (WK3 / (ODF * (1 + FN))) -
  4016*                   CP-ORIGINAL-BENEFIT.
  4017                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  4018
  4019      MOVE WK3 TO CP-CALC-PREMIUM.
  4020
  4021     GO TO 99999-RETURN.
  4022
  4023 12000-CHECK-NEXT.
  4024
  4025     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  4026        NEXT SENTENCE
  4027     ELSE
  4028        GO TO 12000-CHECK-PA-TRUNC.
  4029
  4030      IF WS-WORK-DIS-RATE EQUAL +0
  4031         MOVE '7'                TO CP-RETURN-CODE
  4032         MOVE ZEROS              TO FACTOR
  4033                                    CP-CALC-PREMIUM
  4034         GO TO 99999-RETURN.
  4035
  4036      COMPUTE ANGLEN EQUAL WK1 / I.
  4037
  4038      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  4039
  4040      IF WS-WORK-DIS-RATE EQUAL APR100
  4041         ADD .00001 TO APR100.
  4042
  4043      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  4044      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  4045
  4046     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4047        / (1 + I)
  4048     COMPUTE ANGLEN-1 = ANGLEN / Y
  4049      IF CP-COMPANY-ID EQUAL 'CDL'
  4050         COMPUTE WK3 EQUAL
  4051
  4052          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  4053          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  4054
  4055          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  4056
  4057          ((WK8 ** N) /
  4058          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  4059
  4060          ((WK9 ** N) /
  4061          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  4062
  4063      ELSE
  4064         COMPUTE WK3 EQUAL
  4065
  4066          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  4067          (12 + WS-WORK-DIS-RATE) * 12) *
  4068
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  76
* ELRATE.cbl
  4069          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  4070
  4071          ((WK8 ** N) /
  4072          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  4073
  4074          ((WK9 ** N) /
  4075          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  4076
  4077      COMPUTE WK3 EQUAL
  4078          (WK3 * CP-PREMIUM-RATE) / +1000.
  4079
  4080      MOVE WK3 TO CP-CALC-PREMIUM.
  4081
  4082     GO TO 99999-RETURN.
  4083
  4084 12000-CHECK-PA-TRUNC.
  4085
  4086     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4087        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
  4088        (CP-EARN-AS-NET-PAY) AND
  4089        (CP-TRUNCATED-LIFE)
  4090        NEXT SENTENCE
  4091     ELSE
  4092        GO TO 12000-CHECK-MD-TRUNC.
  4093
  4094     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  4095
  4096     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4097     COMPUTE ANGLEN EQUAL WK1 / I.
  4098
  4099     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4100
  4101     COMPUTE WK3 EQUAL
  4102        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  4103        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  4104
  4105     MOVE WK3 TO CP-CALC-PREMIUM.
  4106
  4107     GO TO 99999-RETURN.
  4108
  4109 12000-CHECK-MD-TRUNC.
  4110
  4111     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4112        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  4113        (CP-EARN-AS-NET-PAY) AND
  4114        (CP-TRUNCATED-LIFE)
  4115        NEXT SENTENCE
  4116     ELSE
  4117        GO TO 12000-CHECK-MD.
  4118
  4119     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  4120
  4121     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4122     COMPUTE ANGLEM EQUAL WK2 / I.
  4123     COMPUTE ANGLEN EQUAL WK1 / I.
  4124
  4125     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4126
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  77
* ELRATE.cbl
  4127     COMPUTE WK3 EQUAL
  4128        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  4129        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  4130        (ANGLEN-1 * (M - ANGLEM))).
  4131
  4132     MOVE WK3 TO CP-CALC-PREMIUM.
  4133
  4134     GO TO 99999-RETURN.
  4135
  4136 12000-CHECK-MD.
  4137
  4138     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4139        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  4140        (CP-EARN-AS-NET-PAY)
  4141        NEXT SENTENCE
  4142     ELSE
  4143        GO TO 12000-CHECK-ME-TRUNC.
  4144
  4145     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  4146
  4147     COMPUTE WK3 EQUAL
  4148        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  4149
  4150     MOVE WK3 TO CP-CALC-PREMIUM.
  4151
  4152     GO TO 99999-RETURN.
  4153
  4154 12000-CHECK-ME-TRUNC.
  4155
  4156     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  4157        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4158        AND (CP-EARN-AS-NET-PAY)
  4159        AND (CP-TRUNCATED-LIFE)
  4160        CONTINUE
  4161     ELSE
  4162        GO TO 12000-CHECK-CID-WA-FARMPLAN
  4163     END-IF
  4164
  4165     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4166     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4167     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4168     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4169     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4170     COMPUTE ANGLEN-1 = ANGLEN / Y
  4171     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4172     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4173     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  4174     COMPUTE WK3
  4175        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  4176        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  4177            * (1 / (1.0635 ** (M / 12))))
  4178*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  4179*    COMPUTE WK9 EQUAL
  4180*       1 / (1 + (.045 * (N - M) / 24))
  4181*    COMPUTE WK7 EQUAL
  4182*       WS-WORK-RATE * 20 / (M + 1).
  4183*    COMPUTE WK3 EQUAL
  4184*       ((( N - ANGLEN) * WK7 * WK8) /
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  78
* ELRATE.cbl
  4185*       (10 * ANGLEN-1 * I)) -
  4186*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
  4187*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  4188*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  4189*
  4190     MOVE WK3 TO CP-CALC-PREMIUM.
  4191
  4192     GO TO 99999-RETURN
  4193      .
  4194 12000-CHECK-CID-WA-FARMPLAN.
  4195
  4196     IF (CP-COMPANY-ID EQUAL 'CID')
  4197        AND (CP-STATE-STD-ABBRV = 'WA')
  4198        AND (CP-FARM-PLAN)
  4199        CONTINUE
  4200     ELSE
  4201        GO TO 12000-CHECK-CID-FARMPLAN
  4202     END-IF
  4203**  This was removed due to IR 2015022300001
  4204    GO TO 12000-CHECK-CID-FARMPLAN
  4205
  4206     move cp-original-term       to n
  4207     move cp-no-of-pmts          TO C-TOT-PMTS
  4208     compute c-pmts-per-year = 12 / cp-pay-frequency
  4209     move cp-pay-frequency       to m
  4210     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  4211     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4212     if i = zeros
  4213        move .0000000001         to i
  4214     end-if
  4215     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  4216
  4217     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  4218        (m * 30))) / (1 + I)
  4219     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4220        ** CP-PAY-FREQUENCY) - 1
  4221     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  4222     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4223        ** TI) / WS-WORK-DIS-RATE
  4224     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
  4225     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  4226     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4227        ** m) / WS-WORK-DIS-RATE
  4228     COMPUTE WK2 = WK2 * (1 + J)
  4229     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4230     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4231     COMPUTE WK3 = WK3 * (1 + J)
  4232     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  4233        ** (c-tot-pmts - 1))) / J
  4234     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4235        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  4236        (CP-PREMIUM-RATE / 1000)
  4237     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  4238     COMPUTE WK6 = (WK7 * GR)
  4239
  4240     MOVE WK6 TO CP-CALC-PREMIUM
  4241
  4242     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  79
* ELRATE.cbl
  4243
  4244     .
  4245 12000-CHECK-CID-FARMPLAN.
  4246     IF (CP-COMPANY-ID EQUAL 'CID')
  4247        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  4248           OR 'IN' OR 'AZ')
  4249        AND (CP-FARM-PLAN)
  4250        CONTINUE
  4251     ELSE
  4252        GO TO 12000-CHECK-CID-AL-FARMPLAN
  4253     END-IF
  4254     COMPUTE N = M / CP-PAY-FREQUENCY
  4255     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4256     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4257        ** CP-PAY-FREQUENCY) - 1
  4258     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  4259     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4260        ** TI) / WS-WORK-DIS-RATE
  4261     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  4262     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  4263     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4264        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  4265     COMPUTE WK2 = WK2 * (1 + J)
  4266     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4267     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4268     COMPUTE WK3 = WK3 * (1 + J)
  4269     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  4270        ** (N - 1))) / J
  4271     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4272        ((N * WK2) - WK5)) + (N * WK1)) *
  4273        (CP-PREMIUM-RATE / 1000)
  4274     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  4275     COMPUTE WK6 = (WK7 * GR)
  4276     MOVE WK6 TO CP-CALC-PREMIUM
  4277     GO TO 99999-RETURN
  4278     .
  4279 12000-CHECK-CID-AL-FARMPLAN.
  4280
  4281     IF (CP-COMPANY-ID EQUAL 'CID')
  4282        AND (CP-STATE-STD-ABBRV = 'AL')
  4283        AND (CP-FARM-PLAN)
  4284        CONTINUE
  4285     ELSE
  4286        GO TO 12000-CHECK-SC-CID
  4287     END-IF
  4288
  4289     display ' made AL Farm Plan calc '
  4290
  4291     evaluate true
  4292        when cp-pmt-mode = 'B'
  4293           move 26               to c-pmts-per-year
  4294           move 14               to c-days-in-pmt-per
  4295        when cp-pmt-mode = 'W'
  4296           move 52               to c-pmts-per-year
  4297           move 07               to c-days-in-pmt-per
  4298        when cp-pmt-mode = 'S'
  4299           move 24               to c-pmts-per-year
  4300           move 15               to c-days-in-pmt-per
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  80
* ELRATE.cbl
  4301        when cp-pmt-mode = 'A'
  4302           move 1                to c-pmts-per-year
  4303           move 360              to c-days-in-pmt-per
  4304        when cp-pmt-mode = 'T'
  4305           move 2                to c-pmts-per-year
  4306           move 180              to c-days-in-pmt-per
  4307        when cp-pmt-mode = 'Q'
  4308           move 4                to c-pmts-per-year
  4309           move 90               to c-days-in-pmt-per
  4310        when cp-pmt-mode = 'N' *> Bi-Monthly ??
  4311           move 6                to c-pmts-per-year
  4312           move 60               to c-days-in-pmt-per
  4313        when other
  4314           move 12               to c-pmts-per-year
  4315           move 30               to c-days-in-pmt-per
  4316     end-evaluate
  4317
  4318     compute c-tot-pmts = n / 12 * c-pmts-per-year
  4319     compute i = cp-loan-apr / c-pmts-per-year / 100
  4320     if i = zeros
  4321        move .0000000001         to i
  4322     end-if
  4323     compute anglen  =
  4324        (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  4325
  4326     compute y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  4327        c-days-in-pmt-per)) / (1 + I)
  4328
  4329     compute angleny = anglen / y
  4330
  4331     compute wk3 rounded =   *> tv1
  4332        ((c-tot-pmts - anglen + (i * c-tot-pmts))) / i
  4333
  4334     compute wk6 =           *> tv2
  4335        cp-premium-rate / 10 * 12 / c-pmts-per-year / 100
  4336
  4337     compute wk7 =    *> tv3
  4338        (cp-original-benefit / anglen)
  4339
  4340     compute wk5 rounded = wk7 *wk3 * wk6
  4341
  4342     move wk5                    to cp-calc-premium
  4343     GO TO 99999-RETURN
  4344     .
  4345 12000-CHECK-SC-CID.
  4346     IF (CP-COMPANY-ID = 'CID')
  4347        AND (CP-STATE-STD-ABBRV = 'SC')
  4348        AND (CP-EARN-AS-NET-PAY)
  4349        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  4350        move 6                   to ws-extra-pmts
  4351     ELSE
  4352        GO TO 12000-CHECK-AL-CID
  4353     END-IF
  4354     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4355     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4356     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4357        / 12)) / ((M + 1) / 2)
  4358
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  81
* ELRATE.cbl
  4359     if i = .0000000001
  4360        compute wk4 = cp-original-benefit / n
  4361        compute wk3 = wk4 * (((n * (n + 1)) / 2 - ((n - m) *
  4362            (n - m + 1)) / 2 + ws-extra-pmts * m) * wk2 / 100)
  4363        display ' hit sc wo apr - wk2 ' wk2
  4364     else
  4365        COMPUTE ANGLEN rounded = (1 - (1 / (1 + I)) ** N) / I
  4366        COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4367        COMPUTE ANGLEN-1 = ANGLEN / Y
  4368        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4369        COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4370           + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4371     end-if
  4372*    COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4373*    COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4374*    COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4375*    COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4376*    COMPUTE ANGLEN-1 = ANGLEN / Y
  4377*    COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4378*       / 12)) / ((M + 1) / 2)
  4379*    COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4380*    COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4381*       + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4382     MOVE WK3 TO CP-CALC-PREMIUM
  4383     GO TO 99999-RETURN
  4384     .
  4385 12000-CHECK-AL-CID.
  4386     IF (CP-COMPANY-ID EQUAL 'CID')
  4387        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  4388        AND (CP-EARN-AS-NET-PAY)
  4389        CONTINUE
  4390     ELSE
  4391        GO TO 12000-CHECK-NH-CID
  4392     END-IF
  4393     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4394     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4395     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4396     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4397                   / (1 + I)
  4398     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4399     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4400     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  4401        (CP-PREMIUM-RATE / 1000)
  4402     MOVE WK3 TO CP-CALC-PREMIUM
  4403     GO TO 99999-RETURN
  4404     .
  4405 12000-CHECK-NH-CID.
  4406     IF (CP-COMPANY-ID EQUAL 'CID')
  4407        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  4408        AND (CP-EARN-AS-NET-PAY)
  4409        CONTINUE
  4410     ELSE
  4411        GO TO 12000-CHECK-PA-CID
  4412     END-IF
  4413     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4414     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4415     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4416                   / (1 + I)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  82
* ELRATE.cbl
  4417     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4418     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4419     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4420        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  4421     MOVE WK3 TO CP-CALC-PREMIUM
  4422     GO TO 99999-RETURN
  4423     .
  4424 12000-CHECK-PA-CID.
  4425     IF (CP-COMPANY-ID EQUAL 'CID')
  4426        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  4427        AND (CP-EARN-AS-NET-PAY)
  4428        CONTINUE
  4429     ELSE
  4430        GO TO 12000-CHECK-ME-CID
  4431     END-IF
  4432
  4433     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4434     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4435     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4436     COMPUTE ANGLEN-1 = ANGLEN / Y
  4437     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  4438     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4439     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  4440     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4441        * WK5
  4442     MOVE WK3 TO CP-CALC-PREMIUM
  4443     GO TO 99999-RETURN
  4444     .
  4445 12000-CHECK-ME-CID.
  4446     IF (CP-COMPANY-ID EQUAL 'CID')
  4447        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4448        AND (CP-EARN-AS-NET-PAY)
  4449        CONTINUE
  4450     ELSE
  4451        GO TO 12000-CHECK-VT-TRUNC
  4452     END-IF
  4453     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4454     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4455     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4456     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4457     COMPUTE ANGLEN-1 = ANGLEN / Y
  4458     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4459     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4460     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4461        * WK5
  4462     MOVE WK3 TO CP-CALC-PREMIUM
  4463     GO TO 99999-RETURN
  4464     .
  4465 12000-CHECK-VT-TRUNC.
  4466
  4467     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4468        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4469        (CP-EARN-AS-NET-PAY) AND
  4470        (CP-TRUNCATED-LIFE)
  4471        NEXT SENTENCE
  4472     ELSE
  4473        GO TO 12000-CHECK-VT.
  4474
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  83
* ELRATE.cbl
  4475      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4476
  4477      COMPUTE ANGLEN EQUAL WK1 / I.
  4478
  4479      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4480
  4481      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  4482      COMPUTE WK9 EQUAL
  4483        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  4484        ((.0054 - I) / (1 + I)).
  4485      COMPUTE WK7 EQUAL
  4486        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  4487      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  4488        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  4489
  4490      MOVE WK3 TO CP-CALC-PREMIUM.
  4491
  4492     GO TO 99999-RETURN.
  4493
  4494 12000-CHECK-VT.
  4495
  4496     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4497        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4498        (CP-EARN-AS-NET-PAY)
  4499        NEXT SENTENCE
  4500     ELSE
  4501        GO TO 12000-CHECK-MINN-WDS.
  4502
  4503      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4504
  4505      COMPUTE ANGLEN EQUAL WK1 / I.
  4506
  4507      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4508
  4509      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  4510                        (ANGLEN-1 * I)) *
  4511
  4512                        (((1.0054 ** N - 1) /
  4513                        (1.0054 ** (N - 1) * .0054)) -
  4514
  4515                        ((V * (1 - 1.0054 ** N * VX)) /
  4516                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  4517
  4518      MOVE WK3 TO CP-CALC-PREMIUM.
  4519
  4520     GO TO 99999-RETURN.
  4521
  4522 12000-CHECK-MINN-WDS.
  4523
  4524     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4525        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4526        (CP-EARN-AS-NET-PAY)
  4527        NEXT SENTENCE
  4528     ELSE
  4529        GO TO 12000-CHECK-MINN-BALL-LEV.
  4530
  4531     COMPUTE ANGLEN EQUAL WK1 / I.
  4532     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  84
* ELRATE.cbl
  4533              (N / +12) * (2 / (N + 1)).
  4534     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
  4535         WK3 * ((N - ANGLEN) / I).
  4536
  4537      MOVE WK3 TO CP-CALC-PREMIUM.
  4538
  4539     GO TO 99999-RETURN.
  4540
  4541 12000-CHECK-MINN-BALL-LEV.
  4542
  4543     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4544        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4545        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4546        (CP-EARN-AS-REG-BALLOON)
  4547        NEXT SENTENCE
  4548     ELSE
  4549        GO TO 12000-CHECK-MINN-BALL.
  4550
  4551     COMPUTE ANGLEN EQUAL WK1 / I.
  4552
  4553     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  4554
  4555     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4556        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  4557
  4558     MOVE WK3 TO CP-CALC-PREMIUM.
  4559
  4560     GO TO 99999-RETURN.
  4561
  4562 12000-CHECK-MINN-BALL.
  4563
  4564     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4565        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4566        (CP-EARN-AS-REG-BALLOON)
  4567        NEXT SENTENCE
  4568     ELSE
  4569        GO TO 12000-CHECK-CID-MN-BALL.
  4570
  4571     COMPUTE ANGLEN EQUAL WK1 / I.
  4572     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4573
  4574     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4575     / +100 * (N - 1) / 12 * 2 / N *
  4576     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  4577
  4578      MOVE WK3 TO CP-CALC-PREMIUM.
  4579
  4580     GO TO 99999-RETURN.
  4581
  4582 12000-CHECK-CID-MN-BALL.
  4583     IF (CP-COMPANY-ID EQUAL 'CID')
  4584        AND (CP-STATE-STD-ABBRV = 'MN')
  4585        AND (CP-CERT-EFF-DT > X'A4FF')
  4586        AND (CP-EARN-AS-REG-BALLOON)
  4587        CONTINUE
  4588     ELSE
  4589        GO TO 12000-CHECK-CID-MN-FARM
  4590     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  85
* ELRATE.cbl
  4591     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4592     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4593     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  4594     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4595     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4596     COMPUTE V = 1 / (1 + I)
  4597     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4598     COMPUTE Y = (1 + (D * I) / +30)
  4599        / (1 + I)
  4600     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  4601        * CP-PREMIUM-RATE / 1000
  4602*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  4603*       MOVE CP-MONTHLY-PAYMENT  TO GR
  4604*    ELSE
  4605*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  4606*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  4607*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  4608*       DISPLAY ' BALLOON TOP ' WK6
  4609*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  4610*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  4611*          / 100
  4612*       DISPLAY ' BALLOON BOTTOM ' WK7
  4613*       COMPUTE GR = WK6 / WK7
  4614*       DISPLAY ' BALLOON PAYMENT ' GR
  4615*    END-IF
  4616     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  4617     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  4618        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  4619     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  4620     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  4621        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  4622           (CP-ALTERNATE-BENEFIT * (M + 1)))
  4623           * CP-PREMIUM-RATE / 1000
  4624     MOVE WK3                    TO CP-CALC-PREMIUM
  4625     GO TO 99999-RETURN.
  4626     .
  4627 12000-CHECK-CID-MN-FARM.
  4628
  4629     IF (CP-COMPANY-ID EQUAL 'CID')
  4630        AND (CP-STATE-STD-ABBRV = 'MN' or 'WA')
  4631        AND (CP-CERT-EFF-DT > X'A4FF')
  4632        AND (CP-EARN-AS-FARM-PLAN)
  4633        CONTINUE
  4634     ELSE
  4635        GO TO 12000-CHECK-CID-NET-BALLoons
  4636     END-IF
  4637
  4638     EVALUATE CP-PMT-MODE
  4639        WHEN 'B'
  4640           MOVE +14              TO C-DAYS-IN-PMT-PER
  4641           MOVE +26              TO C-PMTS-PER-YEAR
  4642           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4643        WHEN 'S'
  4644           MOVE +15              TO C-DAYS-IN-PMT-PER
  4645           MOVE +24              TO C-PMTS-PER-YEAR
  4646           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4647        WHEN 'T'
  4648           MOVE +360             TO C-DAYS-IN-PMT-PER
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  86
* ELRATE.cbl
  4649           MOVE +1               TO C-PMTS-PER-YEAR
  4650           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4651        WHEN 'W'
  4652           MOVE +7               TO C-DAYS-IN-PMT-PER
  4653           MOVE +52              TO C-PMTS-PER-YEAR
  4654           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4655        WHEN OTHER
  4656           move cp-no-of-pmts    to c-tot-pmts
  4657           if cp-pay-frequency > zeros
  4658              compute c-pmts-per-year =
  4659                 12 / cp-pay-frequency
  4660              compute c-days-in-pmt-per = 360 / c-pmts-per-year
  4661           else
  4662              MOVE +30           TO C-DAYS-IN-PMT-PER
  4663              MOVE +12           TO C-PMTS-PER-YEAR
  4664              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  4665           end-if
  4666     END-EVALUATE
  4667
  4668     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4669     if i = zeros
  4670        move .0000000001         to i
  4671     end-if
  4672
  4673     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4674        C-DAYS-IN-PMT-PER)) / (1 + I)
  4675
  4676     compute cp-premium-rate =
  4677        cp-premium-rate * 12 / c-pmts-per-year / 10
  4678     move c-tot-pmts to n m
  4679     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4680     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4681     COMPUTE ANGLEN-1 = ANGLEN / Y
  4682     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4683
  4684     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  4685        (cp-premium-rate / 100)
  4686
  4687
  4688     MOVE WK3                    TO CP-CALC-PREMIUM
  4689
  4690     GO TO 99999-RETURN.
  4691
  4692     .
  4693 12000-check-cid-net-balloons.
  4694     IF (CP-COMPANY-ID EQUAL 'CID')
  4695        AND (CP-EARN-AS-REG-BALLOON)
  4696        and (CP-NET-ONLY-STATE not = 'Y')
  4697        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  4698        CONTINUE
  4699     ELSE
  4700        GO TO 12000-check-cid-net-only-balls
  4701     END-IF
  4702     display ' *** NOT NET ONLY STATE BALLOONS *** '
  4703     COMPUTE Y =
  4704        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  4705     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4706     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  87
* ELRATE.cbl
  4707     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4708     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4709     COMPUTE ANGLEMY = ANGLEM / Y
  4710     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  4711     COMPUTE ANGLENY = ANGLEN / Y
  4712     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  4713     compute cp-original-benefit =
  4714        cp-original-benefit + cp-alternate-benefit
  4715     COMPUTE PVBALLOON rounded =
  4716        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  4717     compute wk4 rounded =
  4718        cp-original-benefit - pvballoon
  4719     compute wk6 rounded =
  4720        (cp-original-benefit - cp-alternate-benefit)
  4721***  compute ra = wk4 / anglem-1y
  4722     compute ra = wk4 / anglemy
  4723     compute wk6 rounded = wk6 / anglemy
  4724     display ' rate before ' cp-premium-rate
  4725     compute cp-premium-rate =
  4726        (cp-premium-rate * ((m + (cp-days-to-1st-pmt - 30)
  4727            / 30) / 12))     /
  4728           ((m + 1) / 2)
  4729     display '************************************'
  4730     display ' orign ben    ' cp-original-benefit
  4731     display ' balloon      ' cp-alternate-benefit
  4732     display ' ra           ' ra
  4733     display ' wk6          ' wk6
  4734     display ' m            ' m
  4735     display ' anglemy      ' anglemy
  4736     display ' anglem-1     ' anglem-1y
  4737     display ' i            ' i
  4738     display ' extra per    ' cp-extra-periods
  4739     display ' prem rate    ' cp-premium-rate
  4740***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  4741***     (cp-extra-periods * i)) * cp-premium-rate / 100
  4742     compute wk3 = wk6 * (m - anglem) / i * (1 +
  4743        (cp-extra-periods * i)) * cp-premium-rate / 100
  4744     move wk3                    to cp-calc-premium
  4745     display ' wk3          ' wk3
  4746     display '************************************'
  4747*    compute wk3 rounded =
  4748*       cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  4749*    move wk3                    to cp-lf-balloon-prem
  4750     GO TO 99999-RETURN.
  4751     .
  4752 12000-check-cid-net-only-balls.
  4753     IF (CP-COMPANY-ID EQUAL 'CID')
  4754        AND (CP-EARN-AS-REG-BALLOON)
  4755        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  4756        CONTINUE
  4757     ELSE
  4758        GO TO 12000-CHECK-NC-WDS
  4759     END-IF
  4760     display ' *** NET ONLY STATE BALLOONS *** '
  4761     COMPUTE Y =
  4762        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  4763     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4764     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  88
* ELRATE.cbl
  4765     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4766     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4767     COMPUTE ANGLEMY = ANGLEM / Y
  4768     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  4769     COMPUTE ANGLENY = ANGLEN / Y
  4770     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  4771     COMPUTE PVBALLOON rounded =
  4772        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  4773     compute wk4 rounded =
  4774        cp-original-benefit - pvballoon
  4775*    compute cp-premium-rate =
  4776*       (cp-premium-rate * (m + 1) / 12)  /
  4777*          ((m + 2) / 2)
  4778***  compute ra = wk4 / anglem-1y
  4779     compute ra = (cp-original-benefit + cp-alternate-benefit -
  4780        pvballoon) / anglemy
  4781     display '************************************'
  4782     display ' ra           ' ra
  4783     display ' m            ' m
  4784     display ' anglemy      ' anglemy
  4785     display ' anglem-1     ' anglem-1y
  4786     display ' i            ' i
  4787     display ' extra per    ' cp-extra-periods
  4788     display ' prem rate    ' cp-premium-rate
  4789     display '************************************'
  4790***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  4791***     (cp-extra-periods * i)) * cp-premium-rate / 100
  4792     compute wk3 = ra * (m - anglemy) / i * (1 +
  4793        (cp-extra-periods * i)) * cp-premium-rate / 100
  4794     move wk3                    to cp-calc-premium
  4795     compute wk3 rounded =
  4796        cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  4797     move wk3                    to cp-lf-balloon-prem
  4798     GO TO 99999-RETURN.
  4799     .
  4800 12000-CHECK-NC-WDS.
  4801
  4802     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4803        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4804        (CP-EARN-AS-NET-PAY)
  4805        NEXT SENTENCE
  4806     ELSE
  4807        GO TO 12000-CHECK-NC-BALL-LEV.
  4808
  4809     COMPUTE WK4 EQUAL N * (1 + I * 2).
  4810     COMPUTE ANGLEN EQUAL WK1 / I.
  4811     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4812              CP-PREMIUM-RATE / +100 *
  4813              N / +12 * 2 / (N + 1) *
  4814              (WK4 - ANGLEN) / (I * ANGLEN).
  4815
  4816      MOVE WK3 TO CP-CALC-PREMIUM.
  4817
  4818     GO TO 99999-RETURN.
  4819
  4820 12000-CHECK-NC-BALL-LEV.
  4821
  4822     IF (CP-COMPANY-ID EQUAL 'WDS') AND
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  89
* ELRATE.cbl
  4823        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4824        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4825        (CP-EARN-AS-REG-BALLOON)
  4826        NEXT SENTENCE
  4827     ELSE
  4828        GO TO 12000-CHECK-NC-BALL.
  4829
  4830     COMPUTE ANGLEN EQUAL WK1 / I.
  4831
  4832**** VX = 1 / (1 + I)**N.
  4833
  4834     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4835        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  4836
  4837     MOVE WK3 TO CP-CALC-PREMIUM.
  4838
  4839     GO TO 99999-RETURN.
  4840
  4841 12000-CHECK-NC-BALL.
  4842
  4843     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4844        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4845        (CP-EARN-AS-REG-BALLOON)
  4846        NEXT SENTENCE
  4847     ELSE
  4848        GO TO 12000-CHECK-MINN-TRUNC.
  4849
  4850     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  4851     COMPUTE ANGLEN EQUAL WK1 / I.
  4852     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4853**** VX = 1 / (1 + I)**N.
  4854
  4855     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4856     / +100 * (N - 1) / 12 * 2 / N *
  4857     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  4858
  4859      MOVE WK3 TO CP-CALC-PREMIUM.
  4860
  4861     GO TO 99999-RETURN.
  4862
  4863 12000-CHECK-MINN-TRUNC.
  4864
  4865     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4866        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4867        (M GREATER THAN +63) AND
  4868        (CP-EARN-AS-NET-PAY) AND
  4869        (CP-TRUNCATED-LIFE)
  4870        NEXT SENTENCE
  4871     ELSE
  4872        GO TO 12000-CHECK-MINN.
  4873
  4874      COMPUTE ANGLEN EQUAL WK1 / I.
  4875      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4876
  4877      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4878
  4879      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4880       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  90
* ELRATE.cbl
  4881       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  4882
  4883      MOVE WK3 TO CP-CALC-PREMIUM.
  4884
  4885     GO TO 99999-RETURN.
  4886
  4887 12000-CHECK-MINN.
  4888
  4889     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4890        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4891        (M GREATER THAN +63) AND
  4892        (CP-EARN-AS-NET-PAY)
  4893        NEXT SENTENCE
  4894     ELSE
  4895        GO TO 12000-CHECK-MONTANA-TRUNC.
  4896
  4897      COMPUTE ANGLEN EQUAL WK1 / I.
  4898
  4899      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4900
  4901      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4902       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4903       (((N - ANGLEN) / I) + (2 * N)).
  4904
  4905      MOVE WK3 TO CP-CALC-PREMIUM.
  4906
  4907     GO TO 99999-RETURN.
  4908
  4909 12000-CHECK-MONTANA-TRUNC.
  4910
  4911     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4912        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4913        (M GREATER THAN +63) AND
  4914        (CP-EARN-AS-NET-PAY) AND
  4915        (CP-TRUNCATED-LIFE)
  4916        NEXT SENTENCE
  4917     ELSE
  4918        GO TO 12000-CHECK-MONTANA.
  4919
  4920      COMPUTE ANGLEN EQUAL WK1 / I.
  4921      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4922
  4923      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4924
  4925      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4926      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4927       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  4928
  4929      MOVE WK3 TO CP-CALC-PREMIUM.
  4930
  4931     GO TO 99999-RETURN.
  4932
  4933 12000-CHECK-MONTANA.
  4934
  4935     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4936        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4937        (M GREATER THAN +63) AND
  4938        (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  91
* ELRATE.cbl
  4939        NEXT SENTENCE
  4940     ELSE
  4941        GO TO 12001-CONTINUE-NCL-TRUNC.
  4942
  4943      COMPUTE ANGLEN EQUAL WK1 / I.
  4944
  4945      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4946
  4947      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4948       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4949       (((N - ANGLEN) / I) + (4 * N)).
  4950
  4951      MOVE WK3 TO CP-CALC-PREMIUM.
  4952
  4953     GO TO 99999-RETURN.
  4954
  4955 12001-CONTINUE-NCL-TRUNC.
  4956
  4957     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4958        (CP-EARN-AS-NET-PAY) AND
  4959        (CP-TRUNCATED-LIFE)
  4960        NEXT SENTENCE
  4961     ELSE
  4962        GO TO 12001-CONTINUE-NCL.
  4963
  4964      COMPUTE ANGLEN EQUAL WK1 / I.
  4965      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4966
  4967      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4968
  4969      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  4970      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  4971      (ANGLEN-1 * (N + 1) * I).
  4972
  4973      MOVE WK3 TO CP-CALC-PREMIUM.
  4974
  4975     GO TO 99999-RETURN.
  4976
  4977 12001-CONTINUE-NCL.
  4978
  4979     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4980        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4981        (CP-EARN-AS-NET-PAY)
  4982        GO TO 12001-CHECK-NC-NET-PLUS3.
  4983
  4984     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4985        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4986        (CP-EARN-AS-NET-PAY)
  4987        GO TO 12001-CHECK-CA.
  4988
  4989     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4990        (CP-EARN-AS-NET-PAY)
  4991        NEXT SENTENCE
  4992     ELSE
  4993        GO TO 12000-CONTINUE-NET.
  4994
  4995      COMPUTE ANGLEN EQUAL WK1 / I.
  4996      MOVE ANGLEN                TO ANGLEN-1.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  92
* ELRATE.cbl
  4997
  4998      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4999
  5000      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  5001       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  5002       ((N - ANGLEN) / I).
  5003
  5004      MOVE WK3 TO CP-CALC-PREMIUM.
  5005
  5006     GO TO 99999-RETURN.
  5007
  5008 12000-CONTINUE-NET.
  5009
  5010     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  5011        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  5012        (CP-EARN-AS-NET-PAY)
  5013        NEXT SENTENCE
  5014     ELSE
  5015        GO TO 12001-CONTINUE-MINN.
  5016
  5017      COMPUTE ANGLEN EQUAL WK6 / I.
  5018      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  5019
  5020      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  5021      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  5022      COMPUTE WK3 EQUAL (WK3 / I) *
  5023       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  5024
  5025      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  5026         MOVE +0 TO CP-R-MAX-TOT-BEN.
  5027
  5028      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  5029
  5030      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  5031         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  5032         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  5033
  5034      MOVE WK3 TO CP-CALC-PREMIUM.
  5035
  5036     GO TO 99999-RETURN.
  5037
  5038 12001-CONTINUE-MINN.
  5039
  5040     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  5041        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  5042        (CP-TRUNCATED-LIFE)
  5043        NEXT SENTENCE
  5044     ELSE
  5045        GO TO 12001-CHECK-RI-GTL.
  5046
  5047      COMPUTE ANGLEN EQUAL WK1 / I.
  5048      COMPUTE ANGLEM EQUAL WK2 / I.
  5049
  5050      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  5051       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  5052       * M / 2400) * 1000 + .5) / 1000000.
  5053
  5054      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  93
* ELRATE.cbl
  5055       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  5056
  5057     GO TO 99999-RETURN.
  5058
  5059 12001-CHECK-RI-GTL.
  5060
  5061     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  5062        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  5063        (CP-EARN-AS-NET-PAY)
  5064        NEXT SENTENCE
  5065     ELSE
  5066        GO TO 12001-CHECK-RI-LEASE-GTL.
  5067
  5068      COMPUTE ANGLEN EQUAL WK1 / I.
  5069*     COMPUTE ANGLEM EQUAL WK2 / I.
  5070
  5071      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  5072               (1 + WS-WORK-DIS-RATE * N).
  5073      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  5074         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  5075
  5076
  5077     GO TO 99999-RETURN.
  5078
  5079 12001-CHECK-RI-LEASE-GTL.
  5080
  5081     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  5082        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  5083        (CP-SPECIAL-CALC-CD EQUAL 'H')
  5084        NEXT SENTENCE
  5085     ELSE
  5086        GO TO 12001-CHECK-OR-GTL.
  5087
  5088     COMPUTE ANGLEN EQUAL WK1 / I.
  5089
  5090     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  5091        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
  5092                        /
  5093        (1000 * I * (1 + .0021 * N)).
  5094     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
  5095       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  5096                            /
  5097       (1000 * (1 + .0027 * (N + 1))).
  5098
  5099     GO TO 99999-RETURN.
  5100
  5101 12001-CHECK-OR-GTL.
  5102
  5103     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  5104        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  5105        (CP-EARN-AS-NET-PAY)
  5106        NEXT SENTENCE
  5107     ELSE
  5108        GO TO 12001-CHECK-GA-GTL.
  5109
  5110     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5111     COMPUTE ANGLEN EQUAL WK1 / I.
  5112
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  94
* ELRATE.cbl
  5113     IF M LESS THAN +64
  5114        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  5115         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  5116                   /
  5117         (I * ANGLEN * (N - (N - M) + 1) * 600)
  5118        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  5119     ELSE
  5120        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  5121        CP-PREMIUM-RATE * (1 + I))
  5122                  /
  5123        (+1000 * I * ANGLEN)
  5124        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  5125*    MOVE WK3 TO CP-CALC-PREMIUM.
  5126     GO TO 99999-RETURN.
  5127
  5128 12001-CHECK-GA-GTL.
  5129
  5130     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  5131        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  5132        (CP-EARN-AS-NET-PAY)
  5133*       (CP-TRUNCATED-LIFE)
  5134        NEXT SENTENCE
  5135     ELSE
  5136        GO TO 12001-CHECK-MA-GTL.
  5137
  5138     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5139     COMPUTE ANGLEN EQUAL WK1 / I.
  5140
  5141     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  5142     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  5143      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  5144     MOVE WK3 TO CP-CALC-PREMIUM.
  5145
  5146     GO TO 99999-RETURN.
  5147
  5148 12001-CHECK-MA-GTL.
  5149
  5150     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  5151        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  5152        (CP-EARN-AS-NET-PAY) AND
  5153        (CP-SPECIAL-CALC-CD EQUAL 'H')
  5154        NEXT SENTENCE
  5155     ELSE
  5156        GO TO 12001-CHECK-NV-NET.
  5157
  5158     COMPUTE ANGLEN EQUAL WK1 / I.
  5159
  5160     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  5161      CP-ALTERNATE-BENEFIT * N.
  5162
  5163     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  5164     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  5165
  5166     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  5167     WK7 * (N - ANGLEN) / I.
  5168     MOVE WK3 TO CP-CALC-PREMIUM.
  5169
  5170     GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  95
* ELRATE.cbl
  5171
  5172 12001-CHECK-NV-NET.
  5173     IF (CP-COMPANY-ID EQUAL 'CID')
  5174        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  5175        AND (CP-EARN-AS-NET-PAY)
  5176        CONTINUE
  5177     ELSE
  5178        GO TO 12001-CHECK-MN-NET
  5179     END-IF
  5180     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  5181     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  5182     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  5183                   / (1 + I)
  5184     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5185     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5186     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5187        (CP-PREMIUM-RATE * K-I / 1000)
  5188     MOVE WK3                    TO CP-CALC-PREMIUM
  5189     GO TO 99999-RETURN
  5190      .
  5191 12001-CHECK-MN-NET.
  5192     IF (CP-COMPANY-ID EQUAL 'CID')
  5193        AND (CP-STATE-STD-ABBRV = 'MN')
  5194        AND (CP-EARN-AS-NET-PAY)
  5195        AND (NOT CP-LEVEL-LIFE)
  5196        AND (WS-DISCOUNT-OPTION = '1')
  5197        CONTINUE
  5198     ELSE
  5199        GO TO 12001-CHECK-NC-NET
  5200     END-IF
  5201     if i = .0000000001
  5202        compute wk4 = cp-original-benefit / n
  5203        compute wk3 = wk4 * ((n * (n + 1) / 2) - ((n - m) *
  5204           (n - m + 1) / 2))*(cp-premium-rate / 1000)
  5205        move wk3 to cp-calc-premium
  5206        go to 99999-return
  5207     end-if
  5208     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  5209     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  5210     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  5211                   / (1 + I)
  5212     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5213     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5214     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5215        (CP-PREMIUM-RATE / 1000) * (1 + I)
  5216     MOVE WK3                    TO CP-CALC-PREMIUM
  5217     GO TO 99999-RETURN
  5218      .
  5219 12001-CHECK-NC-NET.
  5220
  5221     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  5222        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  5223        (CP-EARN-AS-NET-PAY)
  5224        NEXT SENTENCE
  5225     ELSE
  5226        GO TO 12001-CHECK-NC-NET-PLUS3.
  5227
  5228      COMPUTE ANGLEN EQUAL WK1 / I.
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  96
* ELRATE.cbl
  5229      COMPUTE ANGLEN-M EQUAL WK5 / I.
  5230
  5231      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  5232          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  5233          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  5234          N * (CP-PREMIUM-RATE / 1000)).
  5235
  5236      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  5237          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  5238
  5239      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  5240          ((N - ANGLEN) / I + 3) / ANGLEN) /
  5241          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  5242          (ANGLEN * 2))
  5243
  5244      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  5245
  5246      IF ANGLEN IS NOT LESS THAN WK7
  5247          COMPUTE CP-PREMIUM-RATE ROUNDED =
  5248              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  5249          COMPUTE WK3 ROUNDED =
  5250              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  5251
  5252     MOVE WK3 TO CP-CALC-PREMIUM.
  5253
  5254     GO TO 99999-RETURN.
  5255
  5256 12001-CHECK-NC-NET-PLUS3.
  5257
  5258     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  5259        (CP-EARN-AS-NET-PAY) AND
  5260        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL' AND 'VPP')
  5261        NEXT SENTENCE
  5262     ELSE
  5263        GO TO 12001-CHECK-CA.
  5264
  5265     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  5266     MOVE ' ' TO DC-OPTION-CODE.
  5267     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  5268
  5269     IF DATE-CONVERSION-ERROR
  5270        MOVE '2'                 TO CP-RETURN-CODE
  5271        MOVE ZEROS               TO FACTOR
  5272                                    CP-CALC-PREMIUM
  5273         GO TO 99999-RETURN.
  5274
  5275     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
  5276        NEXT SENTENCE
  5277     ELSE
  5278        GO TO 12001-CONTINUE-NET.
  5279
  5280     COMPUTE ANGLEN EQUAL WK1 / I.
  5281     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5282
  5283     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  5284
  5285     COMPUTE NC-R = 20 *
  5286                    ((NC-LR * ORIGINAL-TERM) / 12)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  97
* ELRATE.cbl
  5287                          / (ORIGINAL-TERM + 1).
  5288
  5289     COMPUTE NC-OB = NC-R / 1000.
  5290
  5291     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  5292                    (NC-OB * ORIGINAL-TERM * 3).
  5293
  5294     IF CP-EXT-CHG-LF
  5295         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  5296     ELSE
  5297         MOVE 30                 TO  NC-BIG-D.
  5298
  5299     COMPUTE NC-LITTLE-D = (1 + I) /
  5300             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  5301
  5302     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  5303             (ANGLEN * NC-LITTLE-D ).
  5304
  5305     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  5306
  5307     GO TO 99999-RETURN.
  5308
  5309 12001-CHECK-CA.
  5310
  5311     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5312        (WS-DISCOUNT-OPTION = '6')
  5313        NEXT SENTENCE
  5314     ELSE
  5315        GO TO 12001-CHECK-GTL-IA.
  5316
  5317     COMPUTE CA-J = CA-DISCOUNT / 12.
  5318     COMPUTE ANGLEN EQUAL WK1 / I.
  5319     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  5320     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  5321     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  5322     COMPUTE CA-VI = (1 + I)** -1.
  5323     COMPUTE CP-CALC-PREMIUM =
  5324         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  5325         ((1 + CA-J) / I) *
  5326         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  5327         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  5328         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  5329
  5330     GO TO 99999-RETURN.
  5331
  5332 12001-CHECK-GTL-IA.
  5333
  5334     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  5335        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  5336        (CP-EARN-AS-NET-PAY)
  5337        NEXT SENTENCE
  5338     ELSE
  5339        GO TO 12001-CHECK-CID-TRN-VA.
  5340
  5341***************************************************************
  5342
  5343     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  5344
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  98
* ELRATE.cbl
  5345     IF GTL-IA-ODD-DAYS = ZEROS
  5346         MOVE ZERO               TO  GTL-IA-SGN
  5347     ELSE
  5348         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  5349             MOVE +1             TO  GTL-IA-SGN
  5350         ELSE
  5351             MOVE -1             TO  GTL-IA-SGN.
  5352
  5353     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  5354     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  5355
  5356     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  5357                          GTL-IA-SGN.
  5358
  5359     COMPUTE ANGLEN EQUAL WK1 / I.
  5360     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5361
  5362     IF GTL-IA-ODF NOT = ZERO
  5363         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  5364         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  5365
  5366     COMPUTE GTL-IA-DIVIDEND =
  5367           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  5368                             (ANGLEN - ANGLEN-M))) *
  5369           ((K1 + I) * CP-PREMIUM-RATE *
  5370                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  5371
  5372     COMPUTE GTL-IA-DIVISOR =
  5373      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  5374
  5375     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  5376
  5377     COMPUTE CP-CALC-PREMIUM =
  5378                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  5379     GO TO 99999-RETURN.
  5380
  5381
  5382 12001-CHECK-CID-TRN-VA.
  5383
  5384     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5385        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  5386        (CP-EARN-AS-NET-PAY) AND
  5387        (CP-TRUNCATED-LIFE) AND
  5388        (CP-STATE-STD-ABBRV = CP-STATE)
  5389        CONTINUE
  5390     ELSE
  5391        GO TO 12001-CHECK-CID-TX
  5392     END-IF
  5393
  5394     COMPUTE ANGLEN EQUAL WK1 / I
  5395     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5396     IF WS-WORK-DIS-RATE = ZEROS
  5397        CONTINUE
  5398     ELSE
  5399        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5400        COMPUTE WK7 = (1 / I) *
  5401              (((WK4 ** M - 1) / (WK4 - 1)) -
  5402              ((WK4 ** M * SX - VX) /
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page  99
* ELRATE.cbl
  5403              (WK4 * (1 + I) - 1))) *
  5404              (CP-PREMIUM-RATE / 1000)
  5405        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5406        COMPUTE WK8 = WK7 * 100 / ANGLEN
  5407        COMPUTE CP-CALC-PREMIUM =
  5408           WK8 *  ((WK4 * ANGLEN) / 100)
  5409     END-IF
  5410
  5411     GO TO 99999-RETURN
  5412
  5413     .
  5414
  5415 12001-CHECK-CID-TX.
  5416     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5417        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  5418        (CP-EARN-AS-NET-PAY) AND
  5419        (WS-WORK-DIS-RATE > ZEROS) AND
  5420        (CP-STATE-STD-ABBRV = CP-STATE)
  5421        CONTINUE
  5422     ELSE
  5423        GO TO 12001-CHECK-CID-LEV-MN-NEW
  5424     END-IF
  5425* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  5426     COMPUTE K-I = 1 + (1 * I)
  5427     COMPUTE ANGLEm EQUAL WK1 / I   *>   Loan term
  5428     COMPUTE ANGLEn EQUAL WK2 / I   *>   Ins  term
  5429     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  5430
  5431     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  5432     COMPUTE ANGLEmy = ANGLEm / Y
  5433     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5434     IF WS-WORK-DIS-RATE = ZEROS
  5435        CONTINUE
  5436     ELSE
  5437        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5438        COMPUTE WK7 = (K-I / I) *
  5439              (((WK4 ** M - 1) / (WK4 - 1)) -
  5440*             ((WK4 ** M * SX - VX) /
  5441              ((WK4 ** M * SX) - VX) /
  5442*             (WK4 * (1 + I) - 1))) *
  5443              (WK4 * (1 + I) - 1)) *
  5444              (CP-PREMIUM-RATE / 1000)
  5445        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEmy
  5446        COMPUTE WK8 = (WK7 * 100) / (ANGLEmy * K-I)
  5447        COMPUTE CP-CALC-PREMIUM =
  5448           WK8 *  ((WK4 * ANGLEmy * K-I) / 100)
  5449     END-IF
  5450
  5451     GO TO 99999-RETURN
  5452     .
  5453 12001-CHECK-CID-LEV-MN-NEW.
  5454*    IF (CP-COMPANY-ID EQUAL 'CID')
  5455*       AND (CP-STATE-STD-ABBRV = 'MN')
  5456*       AND (CP-EARN-AS-NET-PAY)
  5457*       AND (CP-LEVEL-LIFE)
  5458*       AND (CP-CERT-EFF-DT > X'A4FF')
  5459*       CONTINUE
  5460*    ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page 100
* ELRATE.cbl
  5461*       GO TO 12001-CHECK-CID-LEV-MN
  5462*    END-IF
  5463*
  5464*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  5465*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  5466*    MOVE '1'                    TO DC-OPTION-CODE
  5467*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  5468*
  5469*    IF DATE-CONVERSION-ERROR
  5470*       MOVE '2'                 TO CP-RETURN-CODE
  5471*       MOVE ZEROS               TO FACTOR
  5472*                                   CP-CALC-PREMIUM
  5473*       GO TO 99999-RETURN
  5474*    END-IF
  5475*
  5476*    COMPUTE I = CP-LOAN-APR / 100
  5477*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  5478*
  5479*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  5480*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  5481*      * 12 / 360 * D)
  5482*
  5483*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  5484*       * 12 / 360 * D
  5485*
  5486*    GO TO 99999-RETURN
  5487      .
  5488 12001-CHECK-CID-LEV-MN.
  5489
  5490     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5491        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  5492        (CP-EARN-AS-NET-PAY) AND
  5493        (CP-LEVEL-LIFE) AND
  5494        (CP-STATE-STD-ABBRV = CP-STATE)
  5495        CONTINUE
  5496     ELSE
  5497        GO TO 12001-CHECK-CID-LEV-CA
  5498     END-IF
  5499
  5500     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  5501         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  5502         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  5503
  5504     GO TO 99999-RETURN
  5505
  5506      .
  5507 12001-CHECK-CID-LEV-CA.
  5508
  5509     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5510        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5511        (CP-EARN-AS-NET-PAY) AND
  5512        (CP-LEVEL-LIFE) AND
  5513        (CP-STATE-STD-ABBRV = CP-STATE)
  5514        CONTINUE
  5515     ELSE
  5516        GO TO 12001-CHECK-CID-TRN-CA
  5517     END-IF
  5518
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page 101
* ELRATE.cbl
  5519     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  5520     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  5521     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  5522     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  5523     COMPUTE CP-CALC-PREMIUM =
  5524          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  5525          (CP-PREMIUM-RATE / 1000)) /
  5526          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  5527
  5528     GO TO 99999-RETURN
  5529
  5530      .
  5531 12001-CHECK-CID-TRN-CA.
  5532
  5533     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5534        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5535        (CP-EARN-AS-NET-PAY) AND
  5536        (CP-TRUNCATED-LIFE) AND
  5537        (CP-STATE-STD-ABBRV = CP-STATE) AND
  5538        (WS-DISCOUNT-OPTION NOT = ' ')
  5539        CONTINUE
  5540     ELSE
  5541        GO TO 12001-CHECK-CID-TRN-MT
  5542     END-IF
  5543
  5544     COMPUTE ANGLEN EQUAL WK1 / I
  5545     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5546     IF WS-WORK-DIS-RATE = ZEROS
  5547        CONTINUE
  5548     ELSE
  5549        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5550        COMPUTE WK7 = (1 / I) *
  5551              (((WK4 ** M - 1) / (WK4 - 1)) -
  5552              ((WK4 ** M * SX - VX) /
  5553              (WK4 * (1 + I) - 1))) *
  5554              (CP-PREMIUM-RATE / 1000)
  5555        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5556        COMPUTE CP-CALC-PREMIUM =
  5557           WK4 *  WK7
  5558     END-IF
  5559
  5560     GO TO 99999-RETURN
  5561
  5562      .
  5563 12001-CHECK-CID-TRN-MT.
  5564
  5565     IF (CP-COMPANY-ID EQUAL 'CID') AND
  5566        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  5567                   OR
  5568        ((CP-STATE-STD-ABBRV = 'IN') AND
  5569        (CP-CERT-EFF-DT > X'9A7F'))
  5570                   OR
  5571        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5572        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5573        (CP-EARN-AS-NET-PAY) AND
  5574        (CP-TRUNCATED-LIFE) AND
  5575        (CP-STATE-STD-ABBRV = CP-STATE)
  5576        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page 102
* ELRATE.cbl
  5577     ELSE
  5578        GO TO 12001-CHECK-CID-MT
  5579     END-IF
  5580
  5581* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5582     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5583        MOVE 0                   TO K-I
  5584     ELSE
  5585        MOVE 2                   TO K-I
  5586     END-IF
  5587     COMPUTE CP-TERM-OR-EXT-DAYS =
  5588           CP-TERM-OR-EXT-DAYS + 30
  5589
  5590     COMPUTE ANGLEN EQUAL WK1 / I
  5591     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5592     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5593                   / (1 + I)
  5594     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5595     IF WS-WORK-DIS-RATE = ZEROS
  5596        CONTINUE
  5597     ELSE
  5598        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5599*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5600        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5601              (((WK4 ** M - 1) / (WK4 - 1)) -
  5602              ((WK4 ** M * SX - VX) /
  5603              (WK4 * (1 + I) - 1))) *
  5604              (CP-PREMIUM-RATE / 1000)
  5605        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5606*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5607        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5608        COMPUTE CP-CALC-PREMIUM =
  5609           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5610*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5611     END-IF
  5612
  5613     GO TO 99999-RETURN
  5614
  5615     .
  5616 12001-CHECK-CID-MT.
  5617
  5618     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5619        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  5620                                OR 'VT')
  5621                   OR
  5622        ((CP-STATE-STD-ABBRV = 'IN') AND
  5623        (CP-CERT-EFF-DT > X'9A7F'))
  5624                   OR
  5625        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5626        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5627        (CP-EARN-AS-NET-PAY) AND
  5628        (CP-STATE-STD-ABBRV = CP-STATE)
  5629        CONTINUE
  5630     ELSE
  5631        GO TO 12001-CHECK-DCC-DD
  5632     END-IF
  5633
  5634     COMPUTE CP-TERM-OR-EXT-DAYS =
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page 103
* ELRATE.cbl
  5635           CP-TERM-OR-EXT-DAYS + 30
  5636
  5637* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5638     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5639        MOVE 0                   TO K-I
  5640     ELSE
  5641        IF CP-STATE-STD-ABBRV = 'NJ'
  5642           MOVE 1                TO K-I
  5643        ELSE
  5644           MOVE 2                TO K-I
  5645        END-IF
  5646     END-IF
  5647     COMPUTE ANGLEN EQUAL WK1 / I
  5648     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5649     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5650                   / (1 + I)
  5651     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5652     IF WS-WORK-DIS-RATE = ZEROS
  5653        CONTINUE
  5654     ELSE
  5655        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5656*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5657        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5658              (((WK4 ** N - 1) / (WK4 - 1)) -
  5659              ((WK4 ** N - SV) /
  5660              (WK4 * (1 + I) - 1))) *
  5661              (CP-PREMIUM-RATE / 1000)
  5662        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5663*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5664        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5665        COMPUTE CP-CALC-PREMIUM =
  5666           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5667*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5668     END-IF
  5669
  5670     GO TO 99999-RETURN
  5671
  5672     .
  5673 12001-CHECK-DCC-DD.
  5674     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5675        AND (CP-EARN-AS-NET-PAY)
  5676        AND (CP-BEN-CATEGORY = 'D')
  5677        CONTINUE
  5678     ELSE
  5679        GO TO 12001-CHECK-DCC-NET
  5680     END-IF
  5681
  5682     COMPUTE CP-TERM-OR-EXT-DAYS =
  5683           CP-TERM-OR-EXT-DAYS + 30
  5684
  5685     COMPUTE ANGLEN EQUAL WK1 / I.
  5686     COMPUTE ANGLEM EQUAL WK2 / I.
  5687     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5688
  5689     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5690           / (1 + I)
  5691     COMPUTE GR     = ANGLEN / ODF
  5692*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page 104
* ELRATE.cbl
  5693*      CP-RATE-DEV-PCT
  5694     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5695     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5696       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  5697     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5698     MOVE WK3                    TO CP-CALC-PREMIUM
  5699
  5700     GO TO 99999-RETURN
  5701
  5702     .
  5703 12001-CHECK-DCC-NET.
  5704
  5705     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5706        AND (CP-EARN-AS-NET-PAY)
  5707        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  5708             AND 'H' AND 'S' AND 'P')
  5709        CONTINUE
  5710     ELSE
  5711        GO TO 12001-CHECK-DCC-PNET
  5712     END-IF
  5713
  5714     COMPUTE CP-TERM-OR-EXT-DAYS =
  5715           CP-TERM-OR-EXT-DAYS + 30
  5716
  5717     COMPUTE ANGLEN EQUAL WK1 / I.
  5718     COMPUTE ANGLEM EQUAL WK2 / I.
  5719     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5720
  5721     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5722           / (1 + I)
  5723     COMPUTE GR     = ANGLEN / ODF
  5724     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  5725     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  5726       CP-RATE-DEV-PCT
  5727     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  5728*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  5729
  5730     COMPUTE WK8 = CP-PREMIUM-RATE *
  5731        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  5732     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  5733     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5734     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5735       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  5736     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5737     MOVE WK3                    TO CP-CALC-PREMIUM
  5738
  5739     GO TO 99999-RETURN
  5740
  5741     .
  5742 12001-CHECK-DCC-PNET.
  5743     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5744        AND (CP-EARN-AS-NET-PAY)
  5745        AND (CP-BENEFIT-CD (1:1) = 'P')
  5746        CONTINUE
  5747     ELSE
  5748        GO TO 12001-CHECK-DCC-MNET
  5749     END-IF
  5750     IF CP-NO-OF-PMTS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page 105
* ELRATE.cbl
  5751        MOVE +0                  TO CP-NO-OF-PMTS
  5752     END-IF
  5753     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  5754        AND ' ' AND 'M'
  5755        MOVE ' '                 TO CP-PMT-MODE
  5756     END-IF
  5757******************************************************************
  5758***   Default is monthly, use loan term for rate and amort     ***
  5759******************************************************************
  5760     move cp-loan-term         to c-tot-pmts
  5761     MOVE +30                  TO C-DAYS-IN-PMT-PER
  5762     MOVE +12                  TO C-PMTS-PER-YEAR
  5763******************************************************************
  5764
  5765     evaluate true
  5766        when cp-pmt-mode = 'W'
  5767           MOVE +52              TO C-PMTS-PER-YEAR
  5768           compute c-tot-pmts = cp-loan-term /
  5769              12 * c-pmts-per-year
  5770           MOVE +7               TO C-DAYS-IN-PMT-PER
  5771        when cp-pmt-mode = 'B'
  5772           MOVE +26              TO C-PMTS-PER-YEAR
  5773           compute c-tot-pmts = cp-loan-term /
  5774              12 * c-pmts-per-year
  5775           MOVE +14              TO C-DAYS-IN-PMT-PER
  5776     end-evaluate
  5777     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  5778     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  5779        C-DAYS-IN-PMT-PER)) / (1 + I)
  5780     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  5781*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  5782     COMPUTE ANGLEN-1 = ANGLEN / Y
  5783     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5784     IF CP-RATE-DEV-PCT NOT = ZEROS
  5785        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5786           CP-PREMIUM-RATE
  5787     END-IF
  5788     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  5789     GO TO 99999-RETURN
  5790     .
  5791 12001-CHECK-DCC-MNET.
  5792
  5793     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5794        AND (CP-EARN-AS-NET-PAY)
  5795        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  5796        CONTINUE
  5797     ELSE
  5798        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  5799     END-IF
  5800
  5801*    COMPUTE ANGLEN EQUAL WK1 / I.
  5802*    COMPUTE ANGLEM EQUAL WK2 / I.
  5803*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  5804
  5805     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  5806     MOVE WK3                    TO CP-CALC-PREMIUM
  5807
  5808     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page 106
* ELRATE.cbl
  5809
  5810     .
  5811 12001-CHECK-DCC-MNET-LF-BAL.
  5812
  5813     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5814        AND (CP-EARN-AS-NET-PAY)
  5815        AND (CP-BENEFIT-CD (1:1) = 'N')
  5816        AND (CP-BEN-CATEGORY NOT = 'N')
  5817        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5818        CONTINUE
  5819     ELSE
  5820        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  5821     END-IF
  5822
  5823     IF CP-RATE-DEV-PCT NOT = ZEROS
  5824        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5825           CP-PREMIUM-RATE
  5826     END-IF
  5827*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5828     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5829        / (1 + I)
  5830     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5831     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5832     COMPUTE WK2 = (1 + J) ** (M * -1)
  5833     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5834     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5835          ** ((M - 1) * -1))) / J)
  5836     COMPUTE ANGLEM = ((1 - ((1 + J)
  5837          ** (M * -1))) / J) / OD
  5838     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5839        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  5840        / ANGLEM-1
  5841     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5842          ** ((N - M) * -1))) / I)
  5843     MOVE +0                     TO WK3
  5844     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5845        (WS-COUNTER > M)
  5846        COMPUTE ANGLEM = (1 - ((1 + J)
  5847          ** ((M - WS-COUNTER) * -1))) / J
  5848        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5849        COMPUTE WK5-CSL = (RA * ANGLEM)
  5850        + (CP-ALTERNATE-BENEFIT * WK2)
  5851        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5852     END-PERFORM
  5853     MOVE WK3                    TO CP-CALC-PREMIUM
  5854
  5855     GO TO 99999-RETURN
  5856
  5857     .
  5858 12001-CHECK-DCC-MNET-LFSUM-BAL.
  5859
  5860     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5861        AND (CP-EARN-AS-NET-PAY)
  5862        AND (CP-BENEFIT-CD (1:1) = 'S')
  5863        AND (CP-BEN-CATEGORY NOT = 'N')
  5864        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5865        CONTINUE
  5866     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page 107
* ELRATE.cbl
  5867        GO TO 12001-CHECK-DCC-MNET-LF
  5868     END-IF
  5869
  5870     IF CP-RATE-DEV-PCT NOT = ZEROS
  5871        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5872           CP-PREMIUM-RATE
  5873     END-IF
  5874     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5875     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5876          ** ((M - 1) * -1))) / K)
  5877     COMPUTE ANGLEM = ((1 - ((1 + K)
  5878          ** (M * -1))) / K)
  5879     MOVE CP-MONTHLY-PAYMENT     TO RA
  5880     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5881        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  5882        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5883        CP-PREMIUM-RATE / 1000
  5884     MOVE WK3                    TO CP-CALC-PREMIUM
  5885
  5886     GO TO 99999-RETURN
  5887
  5888     .
  5889 12001-CHECK-DCC-MNET-LF.
  5890
  5891     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5892        AND (CP-EARN-AS-NET-PAY)
  5893        AND (CP-BENEFIT-CD (1:1) = 'N')
  5894        AND (CP-BEN-CATEGORY NOT = 'N')
  5895        CONTINUE
  5896     ELSE
  5897        GO TO 12001-CHECK-DCC-MNET-SUMLF
  5898     END-IF
  5899
  5900     IF CP-RATE-DEV-PCT NOT = ZEROS
  5901        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5902           CP-PREMIUM-RATE
  5903     END-IF
  5904*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5905     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5906        / (1 + I)
  5907     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5908     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5909     COMPUTE WK2 = (1 + J) ** (M * -1)
  5910     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5911     COMPUTE ANGLEM = ((1 - ((1 + J)
  5912          ** (M * -1))) / J) / OD
  5913     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5914     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5915          ** ((N - M) * -1))) / I)
  5916     MOVE +0                     TO WK3
  5917     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5918        (WS-COUNTER > M)
  5919        COMPUTE ANGLEM = (1 - ((1 + J)
  5920          ** ((M - WS-COUNTER + 1) * -1))) / J
  5921        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5922        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5923        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5924     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page 108
* ELRATE.cbl
  5925     MOVE WK3                    TO CP-CALC-PREMIUM
  5926
  5927     GO TO 99999-RETURN
  5928
  5929     .
  5930 12001-CHECK-DCC-MNET-SUMLF.
  5931
  5932     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5933        AND (CP-EARN-AS-NET-PAY)
  5934        AND (CP-BENEFIT-CD (1:1) = 'S')
  5935        AND (CP-BEN-CATEGORY NOT = 'N')
  5936        CONTINUE
  5937     ELSE
  5938        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  5939     END-IF
  5940
  5941     IF CP-RATE-DEV-PCT NOT = ZEROS
  5942        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5943           CP-PREMIUM-RATE
  5944     END-IF
  5945     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5946     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5947        / (1 + K)
  5948     COMPUTE ANGLEN-M = (WK5 / I)
  5949     COMPUTE WK2 = (1 + K) ** (M * -1)
  5950     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5951     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5952     COMPUTE ANGLEM = ((1 - ((1 + K)
  5953          ** (M * -1))) / K) / Y
  5954     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5955     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  5956        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5957        - 1)) / K) * RA
  5958     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5959        + (CP-DAYS-TO-1ST-PMT - +30)
  5960        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5961        +0 / 1000 * 12 / 12)
  5962     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  5963        * (12 / 12)
  5964     MOVE WK3                    TO CP-CALC-PREMIUM
  5965
  5966     GO TO 99999-RETURN
  5967
  5968     .
  5969 12001-CHECK-DCC-MNET-TOT-BAL-N.
  5970
  5971     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5972        AND (CP-EARN-AS-NET-PAY)
  5973        AND (CP-BENEFIT-CD (1:1) = 'N')
  5974        AND (CP-BEN-CATEGORY = 'N')
  5975        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5976        CONTINUE
  5977     ELSE
  5978        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  5979     END-IF
  5980
  5981*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5982     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page 109
* ELRATE.cbl
  5983        / (1 + I)
  5984     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5985     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  5986     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5987     COMPUTE WK2 = (1 + J) ** (M * -1)
  5988     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5989     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5990          ** ((M - 1) * -1))) / J)
  5991     COMPUTE ANGLEM = ((1 - ((1 + J)
  5992          ** (M * -1))) / J) / OD
  5993     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5994        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  5995        / ANGLEM-1
  5996     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5997          ** ((N - M) * -1))) / I)
  5998     MOVE +0                     TO WK3
  5999     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  6000        (WS-COUNTER > M)
  6001        COMPUTE ANGLEM = (1 - ((1 + J)
  6002          ** ((M - WS-COUNTER) * -1))) / J
  6003        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  6004        COMPUTE WK5-CSL = (RA * ANGLEM)
  6005        + (CP-ALTERNATE-BENEFIT * WK2)
  6006        COMPUTE WK3 = WK3 +
  6007         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  6008        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  6009          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  6010          (CP-DCC-AH-RATE / 1000)
  6011     END-PERFORM
  6012     MOVE WK3                    TO CP-CALC-PREMIUM
  6013
  6014     GO TO 99999-RETURN
  6015
  6016     .
  6017 12001-CHECK-DCC-MNET-TOT-BAL-S.
  6018
  6019     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  6020        AND (CP-EARN-AS-NET-PAY)
  6021        AND (CP-BENEFIT-CD (1:1) = 'S')
  6022        AND (CP-BEN-CATEGORY = 'N')
  6023        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  6024        CONTINUE
  6025     ELSE
  6026        GO TO 12001-CHECK-DCC-MNET-TOT-N
  6027     END-IF
  6028
  6029     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  6030     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  6031          ** ((M - 1) * -1))) / K)
  6032     COMPUTE ANGLEM = ((1 - ((1 + K)
  6033          ** (M * -1))) / K)
  6034     MOVE CP-MONTHLY-PAYMENT     TO RA
  6035     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  6036        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  6037        * CP-DCC-AH-RATE / 1000))
  6038        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  6039        CP-DCC-LF-RATE / 1000
  6040     MOVE WK3                    TO CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page 110
* ELRATE.cbl
  6041     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  6042        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  6043        * CP-DCC-AH-RATE / 1000
  6044     COMPUTE WK3 = WK3 + WK5-CSL
  6045     MOVE WK3                    TO CP-CALC-PREMIUM
  6046
  6047     GO TO 99999-RETURN
  6048      .
  6049 12001-CHECK-DCC-MNET-TOT-N.
  6050
  6051     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  6052        AND (CP-EARN-AS-NET-PAY)
  6053        AND (CP-BENEFIT-CD (1:1) = 'N')
  6054        AND (CP-BEN-CATEGORY = 'N')
  6055        CONTINUE
  6056     ELSE
  6057        GO TO 12001-CHECK-DCC-MNET-TOT-S
  6058     END-IF
  6059
  6060*    I = APR/1200
  6061*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  6062*    RA = PAYMENT AMOUNT
  6063*    WK5-CSL = THE BALANCE (PAY OFF )
  6064*    WK3 = THE ACCUMULATED PREMIUM
  6065*    WK2 = (1 + I) ^ (m * -1)
  6066*    OD  = GAMMA
  6067*
  6068*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  6069     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  6070        / (1 + I)
  6071     COMPUTE ANGLEN-M = (WK5 / I) / OD
  6072     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  6073        (CP-DCC-AH-RATE / +1000)
  6074     COMPUTE WK2 = (1 + J) ** (M * -1)
  6075     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  6076     COMPUTE ANGLEM = ((1 - ((1 + J)
  6077          ** (M * -1))) / J) / OD
  6078     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  6079     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6080          ** ((N - M) * -1))) / I)
  6081     MOVE +0                     TO WK3
  6082     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  6083        (WS-COUNTER > M)
  6084        COMPUTE ANGLEM = (1 - ((1 + J)
  6085          ** ((M - WS-COUNTER + 1) * -1))) / J
  6086        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  6087        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  6088        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  6089           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  6090     END-PERFORM
  6091     MOVE WK3                    TO CP-CALC-PREMIUM
  6092
  6093     GO TO 99999-RETURN
  6094
  6095     .
  6096 12001-CHECK-DCC-MNET-TOT-S.
  6097
  6098     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page 111
* ELRATE.cbl
  6099        AND (CP-EARN-AS-NET-PAY)
  6100        AND (CP-BENEFIT-CD (1:1) = 'S')
  6101        AND (CP-BEN-CATEGORY = 'N')
  6102        CONTINUE
  6103     ELSE
  6104        GO TO 12001-CONTINUE-NET
  6105     END-IF
  6106
  6107*    I = APR/1200
  6108*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  6109*    RA = PAYMENT AMOUNT
  6110*    WK5-CSL = THE BALANCE (PAY OFF )
  6111*    WK3 = THE ACCUMULATED PREMIUM
  6112*    WK2 = (1 + I) ^ (m * -1)
  6113*    OD  = GAMMA
  6114*
  6115     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  6116     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  6117        / (1 + J)
  6118     COMPUTE ANGLEM = ((1 - ((1 + J)
  6119          ** (M * -1))) / J) / OD
  6120     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6121          ** ((N - M) * -1))) / I)
  6122          * (1 + J) ** (-1 * M)
  6123     COMPUTE ANGLEN-M = ANGLEN-M / OD
  6124     MOVE CP-MONTHLY-PAYMENT     TO RA
  6125     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  6126        / +30)
  6127     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  6128        ** (WK1) - 1)) / J) * RA
  6129     COMPUTE WK5 = (((((M * (M + 1) / 2)
  6130        + (CP-DAYS-TO-1ST-PMT - +30)
  6131        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  6132        CP-DCC-AH-RATE / +1000 * 12 / 12)
  6133     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  6134        (12 / 12)
  6135     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  6136        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  6137        (CP-DCC-AH-RATE / +1000) * 12 / 12
  6138     COMPUTE WK3 = WK3 + WK5-CSL
  6139     MOVE WK3                    TO CP-CALC-PREMIUM
  6140     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  6141     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  6142        / (1 + K)
  6143     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6144          ** ((N - M) * -1))) / I)
  6145     COMPUTE WK2 = (1 + K) ** (M * -1)
  6146     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  6147     COMPUTE ANGLEN-M = ANGLEN-M / Y
  6148     COMPUTE ANGLEM = ((1 - ((1 + K)
  6149          ** (M * -1))) / K) / Y
  6150*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  6151     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  6152        ((1 + K) ** (M + 1 / Y
  6153        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  6154        - 1)) / K) * RA
  6155     COMPUTE WK7 = (((((M * (M + 1) / 2)
  6156        + (CP-DAYS-TO-1ST-PMT - +30)
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page 112
* ELRATE.cbl
  6157        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  6158        CP-DCC-AH-RATE / 1000 * 12 / 12)
  6159     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  6160        * (12 / 12)
  6161     MOVE WK3                    TO CP-LF-PREM
  6162
  6163     GO TO 99999-RETURN
  6164
  6165     .
  6166 12001-CONTINUE-NET.
  6167
  6168     IF NET-STD
  6169        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  6170*          OR 'DCC'
  6171         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  6172         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  6173         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  6174         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  6175                               * ((1 + N) / (1 + M))
  6176         if (i = .0000000001)
  6177            and (wk3 = zeros)
  6178            move 1               to wk3
  6179         end-if
  6180        ELSE
  6181         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  6182         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  6183         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  6184         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  6185
  6186     IF NET-SMP
  6187         COMPUTE N2 = N * N
  6188         COMPUTE N3 = N2 * N
  6189         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  6190         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  6191         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  6192         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  6193         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  6194
  6195     IF NPO-PRUDENTIAL
  6196       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  6197           VARYING WS-COUNTER FROM 1 BY 1
  6198               UNTIL WS-COUNTER = N
  6199       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  6200       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  6201
  6202     MOVE WK3 TO FACTOR.
  6203
  6204     GO TO 99999-RETURN.
  6205
  6206 12100-PRU-CALC.
  6207     IF WS-COUNTER = 1
  6208         COMPUTE PWK = (I + 1)
  6209     ELSE
  6210         COMPUTE PWK = PWK * (I + 1).
  6211
  6212 12199-EXIT.
  6213      EXIT.
  6214
* Micro Focus Server Express         V5.1 revision 000 02-Apr-20 10:55 Page 113
* ELRATE.cbl
  6215 99000-ERROR.
  6216     MOVE +9999.999999999 TO N-P-FACTOR.
  6217     MOVE '4'             TO CP-RETURN-CODE.
  6218
  6219     GO TO 99999-EXIT.
  6220
  6221 99999-RETURN.
  6222     MOVE FACTOR          TO N-P-FACTOR.
  6223
  6224 99999-EXIT.
  6225      EXIT.
  6226 99999-DUMMY-STOP-RUN.
  6227
  6228* GOBACK.
  6229     MOVE '9%                    "   ' TO DFHEIV0
  6230     MOVE 'ELRATE' TO DFHEIV1
  6231     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6232     GOBACK.
  6233
  6234
  6235 9999-DFHBACK SECTION.
  6236     MOVE '9%                    "   ' TO DFHEIV0
  6237     MOVE 'ELRATE' TO DFHEIV1
  6238     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6239     GOBACK.
  6240 9999-DFHEXIT.
  6241     IF DFHEIGDJ EQUAL 0001
  6242         NEXT SENTENCE
  6243     ELSE IF DFHEIGDJ EQUAL 2
  6244         GO TO 9999-RATE-NOTFND,
  6245               9999-RATE-NOTOPEN,
  6246               9999-RATE-NOTFND
  6247         DEPENDING ON DFHEIGDI.
  6248     MOVE '9%                    "   ' TO DFHEIV0
  6249     MOVE 'ELRATE' TO DFHEIV1
  6250     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6251     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3152     Code:       57485
