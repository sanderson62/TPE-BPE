* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL146.cbl
* Options: int("EL146.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL146.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL146.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL146.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL146 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 09/27/95 14:15:18.
     7*                            VMOD=2.003
     8*
     9*
    10*AUTHOR.    LOGIC, INC.
    11*           DALLAS, TEXAS.
    12*REMARKS.
    13*        THIS PROGRAM CONTROLS THE MAINTENANCE TO THE CHECK RECON-
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL146.cbl
    14*    CILIATION RECORD.
    15*
    16*    SCREENS     - EL146S - AUTOMATIC ACTIVITY MAINTENANCE
    17*    ENTERED BY  - EL171A - ON-LINE REPORTS MENU
    18*
    19*    EXIT TO     - EL171A - RESULT OF CLEAR
    20*
    21*    INPUT FILES - ELRCON - CHECK RECONCILIATION FILE
    22*
    23*    OUTPUT FILES - ELRCON
    24*
    25*    COMMAREA    - PASSED.
    26
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL146.cbl
    28 ENVIRONMENT DIVISION.
    29
    30 DATA DIVISION.
    31
    32 WORKING-STORAGE SECTION.
    33 01  DFH-START PIC X(04).
    34
    35 77  FILLER  PIC X(32)  VALUE '********************************'.
    36 77  FILLER  PIC X(32)  VALUE '*   EL146  WORKING STORAGE     *'.
    37 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.003 *********'.
    38
    39*                                COPY ELCSCTM.
    40******************************************************************
    41*                                                                *
    42*                                                                *
    43*                            ELCSCTM                             *
    44*                            VMOD=2.001                          *
    45*                                                                *
    46*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    47*                                                                *
    48******************************************************************
    49 01  SECURITY-MESSAGE.
    50     12  FILLER                          PIC X(30)
    51            VALUE '** LOGIC SECURITY VIOLATION -'.
    52     12  SM-READ                         PIC X(6).
    53     12  FILLER                          PIC X(5)
    54            VALUE ' PGM='.
    55     12  SM-PGM                          PIC X(6).
    56     12  FILLER                          PIC X(5)
    57            VALUE ' OPR='.
    58     12  SM-PROCESSOR-ID                 PIC X(4).
    59     12  FILLER                          PIC X(6)
    60            VALUE ' TERM='.
    61     12  SM-TERMID                       PIC X(4).
    62     12  FILLER                          PIC XX   VALUE SPACE.
    63     12  SM-JUL-DATE                     PIC 9(5).
    64     12  FILLER                          PIC X    VALUE SPACE.
    65     12  SM-TIME                         PIC 99.99.
    66
    67
    68*                                COPY ELCSCRTY.
    69******************************************************************
    70*                                                                *
    71*                                                                *
    72*                            ELCSCRTY                            *
    73*                            VMOD=2.001                          *
    74*                                                                *
    75*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    76*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    77*        SAVED IN PI-SECURITY-ADDRESS.                           *
    78*                                                                *
    79******************************************************************
    80 01  SECURITY-CONTROL.
    81     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    82     12  FILLER                       PIC XX    VALUE 'SC'.
    83     12  SC-CREDIT-CODES.
    84         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    85             20  SC-CREDIT-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL146.cbl
    86             20  SC-CREDIT-UPDATE     PIC X.
    87     12  SC-CLAIMS-CODES.
    88         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    89             20  SC-CLAIMS-DISPLAY    PIC X.
    90             20  SC-CLAIMS-UPDATE     PIC X.
    91
    92 01  WS-DATE-AREA.
    93     12  SAVE-DATE               PIC X(08)       VALUE SPACES.
    94     12  SAVE-BIN-DATE           PIC X(02)       VALUE SPACES.
    95
    96 01  FILLER                      COMP-3.
    97
    98     12  TIME-IN                 PIC S9(7)       VALUE ZERO.
    99     12  TIME-OUT                REDEFINES
   100         TIME-IN                 PIC S9(3)V9(4).
   101
   102 01  FILLER.
   103     12  GETMAIN-SPACE           PIC X(01)       VALUE SPACES.
   104     12  ELRCON-DSID             PIC X(08)       VALUE 'ELRCON'.
   105
   106     12  LINK-ELDATCV            PIC X(08)       VALUE 'ELDATCV'.
   107     12  LINK-001                PIC X(08)       VALUE 'EL001'.
   108     12  LINK-004                PIC X(08)       VALUE 'EL004'.
   109
   110     12  XCTL-005                PIC X(08)       VALUE 'EL005'.
   111     12  XCTL-010                PIC X(08)       VALUE 'EL010'.
   112     12  XCTL-126                PIC X(08)       VALUE 'EL126'.
   113
   114     12  WS-MAPSET-NAME          PIC X(08)       VALUE 'EL146S'.
   115     12  WS-MAP-NAME             PIC X(08)       VALUE 'EL146A'.
   116     12  FILLER                  REDEFINES
   117         WS-MAP-NAME.
   118         16  FILLER              PIC X(02).
   119         16  WS-MAP-NUMBER       PIC X(04).
   120         16  FILLER              PIC X(02).
   121
   122     12  WS-DATE-YY              PIC 9(04).
   123
   124     12  WS-EDIT-DATE.
   125         16  WS-EDIT-MM          PIC 99.
   126         16  FILLER              PIC X(01)  VALUE '/'.
   127         16  WS-EDIT-DD          PIC 99.
   128         16  FILLER              PIC X(01)  VALUE '/'.
   129         16  WS-EDIT-YY          PIC 99.
   130
   131     12  THIS-PGM                PIC X(08)       VALUE 'EL146'.
   132     12  WS-TRANS-ID             PIC X(04)       VALUE 'E027'.
   133     12  SC-ITEM                 PIC S9(04)      VALUE +1 COMP.
   134     12  SUB                     PIC S9(02)      VALUE +0.
   135     12  SUB1                    PIC S9(02)      VALUE +0.
   136     12  WS-EDIT-CHECK-AMT       PIC 9(07)V99.
   137     12  WS-RECORDS-READ-SW      PIC X(01)       VALUE 'N'.
   138
   139     12  DEEDIT-FIELD            PIC X(12).
   140     12  DEEDIT-FIELD-CHK REDEFINES DEEDIT-FIELD  PIC 9(10)V99.
   141
   142     12  WS-WORK-DATE.
   143         16  WS-WORK-MM          PIC 9(02)       VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL146.cbl
   144         16  WS-WORK-DD          PIC 9(02)       VALUE ZEROS.
   145         16  WS-WORK-YY          PIC 9(02)       VALUE ZEROS.
   146
   147     12  WS-RCON-DATE.
   148         16  WS-RCON-YEAR.
   149             20  WS-RCON-YY-1    PIC 9(02).
   150             20  WS-RCON-YY-2    PIC 9(02).
   151         16  WS-RCON-MM          PIC 9(02).
   152         16  WS-RCON-DD          PIC 9(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL146.cbl
   154 01  ACCESS-KEYS.
   155
   156     12  ELRCON-KEY.
   157         16  RECON-COMPANY-CD    PIC X(01).
   158         16  RECON-CHECK-NO      PIC X(07).
   159         16  RECON-ORIGIN        PIC X(01).
   160         16  RECON-BANK-NO       PIC X(10).
   161
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL146.cbl
   163 01  ERROR-MESSAGES.
   164     12  ER-0000                 PIC X(04)       VALUE '0000'.
   165     12  ER-0004                 PIC X(04)       VALUE '0004'.
   166     12  ER-0008                 PIC X(04)       VALUE '0008'.
   167     12  ER-0023                 PIC X(04)       VALUE '0023'.
   168     12  ER-0029                 PIC X(04)       VALUE '0029'.
   169     12  ER-0070                 PIC X(04)       VALUE '0070'.
   170     12  ER-0130                 PIC X(04)       VALUE '0130'.
   171     12  ER-0131                 PIC X(04)       VALUE '0131'.
   172     12  ER-0772                 PIC X(04)       VALUE '0772'.
   173     12  ER-0773                 PIC X(04)       VALUE '0773'.
   174     12  ER-0774                 PIC X(04)       VALUE '0774'.
   175     12  ER-0775                 PIC X(04)       VALUE '0775'.
   176     12  ER-0776                 PIC X(04)       VALUE '0776'.
   177     12  ER-0789                 PIC X(04)       VALUE '0789'.
   178     12  ER-0795                 PIC X(04)       VALUE '0795'.
   179     12  ER-0796                 PIC X(04)       VALUE '0796'.
   180     12  ER-0827                 PIC X(04)       VALUE '0827'.
   181     12  ER-0831                 PIC X(04)       VALUE '0831'.
   182     12  ER-0850                 PIC X(04)       VALUE '0850'.
   183     12  ER-0898                 PIC X(04)       VALUE '0898'.
   184     12  ER-9999                 PIC X(04)       VALUE '9999'.
   185
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL146.cbl
   187*                                COPY ELCINTF.
   188******************************************************************
   189*                                                                *
   190*                                                                *
   191*                            ELCINTF.                            *
   192*                            VMOD=2.017                          *
   193*                                                                *
   194*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   195*                                                                *
   196*       LENGTH = 1024                                            *
   197*                                                                *
   198******************************************************************
   199 01  PROGRAM-INTERFACE-BLOCK.
   200     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   201     12  PI-CALLING-PROGRAM              PIC X(8).
   202     12  PI-SAVED-PROGRAM-1              PIC X(8).
   203     12  PI-SAVED-PROGRAM-2              PIC X(8).
   204     12  PI-SAVED-PROGRAM-3              PIC X(8).
   205     12  PI-SAVED-PROGRAM-4              PIC X(8).
   206     12  PI-SAVED-PROGRAM-5              PIC X(8).
   207     12  PI-SAVED-PROGRAM-6              PIC X(8).
   208     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   209     12  PI-COMPANY-ID                   PIC XXX.
   210     12  PI-COMPANY-CD                   PIC X.
   211
   212     12  PI-COMPANY-PASSWORD             PIC X(8).
   213
   214     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   215
   216     12  PI-CONTROL-IN-PROGRESS.
   217         16  PI-CARRIER                  PIC X.
   218         16  PI-GROUPING                 PIC X(6).
   219         16  PI-STATE                    PIC XX.
   220         16  PI-ACCOUNT                  PIC X(10).
   221         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   222                                         PIC X(10).
   223         16  PI-CLAIM-CERT-GRP.
   224             20  PI-CLAIM-NO             PIC X(7).
   225             20  PI-CERT-NO.
   226                 25  PI-CERT-PRIME       PIC X(10).
   227                 25  PI-CERT-SFX         PIC X.
   228             20  PI-CERT-EFF-DT          PIC XX.
   229         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   230             20  PI-PLAN-CODE            PIC X(2).
   231             20  PI-REVISION-NUMBER      PIC X(3).
   232             20  PI-PLAN-EFF-DT          PIC X(2).
   233             20  PI-PLAN-EXP-DT          PIC X(2).
   234             20  FILLER                  PIC X(11).
   235         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   236             20  PI-OE-REFERENCE-1.
   237                 25  PI-OE-REF-1-PRIME   PIC X(18).
   238                 25  PI-OE-REF-1-SUFF    PIC XX.
   239
   240     12  PI-SESSION-IN-PROGRESS          PIC X.
   241         88  CLAIM-SESSION                   VALUE '1'.
   242         88  CREDIT-SESSION                  VALUE '2'.
   243         88  WARRANTY-SESSION                VALUE '3'.
   244         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL146.cbl
   245         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   246
   247
   248*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   249
   250     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   251     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   252
   253     12  PI-CREDIT-USER                  PIC X.
   254         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   255         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   256
   257     12  PI-CLAIM-USER                   PIC X.
   258         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   259         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   260
   261     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   262         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   263         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   264         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   265         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   266         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   267
   268     12  PI-PROCESSOR-ID                 PIC X(4).
   269
   270     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   271
   272     12  PI-MEMBER-CAPTION               PIC X(10).
   273
   274     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   275         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   276
   277     12  PI-LIFE-OVERRIDE-L1             PIC X.
   278     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   279     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   280     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   281
   282     12  PI-AH-OVERRIDE-L1               PIC X.
   283     12  PI-AH-OVERRIDE-L2               PIC XX.
   284     12  PI-AH-OVERRIDE-L6               PIC X(6).
   285     12  PI-AH-OVERRIDE-L12              PIC X(12).
   286
   287     12  PI-NEW-SYSTEM                   PIC X(2).
   288
   289     12  PI-PRIMARY-CERT-NO              PIC X(11).
   290     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   291         88  PI-USES-PAID-TO                 VALUE '1'.
   292     12  PI-CRDTCRD-SYSTEM.
   293         16  PI-CRDTCRD-USER             PIC X.
   294             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   295             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   296         16  PI-CC-MONTH-END-DT          PIC XX.
   297     12  PI-PROCESSOR-PRINTER            PIC X(4).
   298
   299     12  PI-OE-REFERENCE-2.
   300         16  PI-OE-REF-2-PRIME           PIC X(10).
   301         16  PI-OE-REF-2-SUFF            PIC X.
   302
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL146.cbl
   303     12  PI-REM-TRM-CALC-OPTION          PIC X.
   304
   305     12  PI-LANGUAGE-TYPE                PIC X.
   306             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   307             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   308             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   309
   310     12  PI-POLICY-LINKAGE-IND           PIC X.
   311         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   312         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   313                                                   LOW-VALUES.
   314
   315     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   316     12  PI-CLAIM-PW-SESSION             PIC X(1).
   317         88  PI-CLAIM-CREDIT                 VALUE '1'.
   318         88  PI-CLAIM-CONVEN                 VALUE '2'.
   319     12  FILLER                          PIC X(4).
   320
   321     12  PI-SYSTEM-LEVEL                 PIC X(145).
   322
   323     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   324         PI-SYSTEM-LEVEL.
   325
   326         16  PI-ENTRY-CODES.
   327             20  PI-ENTRY-CD-1           PIC X.
   328             20  PI-ENTRY-CD-2           PIC X.
   329
   330         16  PI-RETURN-CODES.
   331             20  PI-RETURN-CD-1          PIC X.
   332             20  PI-RETURN-CD-2          PIC X.
   333
   334         16  PI-UPDATE-STATUS-SAVE.
   335             20  PI-UPDATE-BY            PIC X(4).
   336             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   337
   338         16  PI-LOWER-CASE-LETTERS       PIC X.
   339             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   340
   341*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   342*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   343*            88  CARRIER-CLM-CNTL            VALUE '2'.
   344
   345         16  PI-CERT-ACCESS-CONTROL      PIC X.
   346             88  ST-ACCNT-CNTL               VALUE ' '.
   347             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   348             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   349             88  ACCNT-CNTL                  VALUE '3'.
   350             88  CARR-ACCNT-CNTL             VALUE '4'.
   351
   352         16  PI-PROCESSOR-CAP-LIST.
   353             20  PI-SYSTEM-CONTROLS.
   354                24 PI-SYSTEM-DISPLAY     PIC X.
   355                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   356                24 PI-SYSTEM-MODIFY      PIC X.
   357                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   358             20  FILLER                  PIC XX.
   359             20  PI-DISPLAY-CAP          PIC X.
   360                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL146.cbl
   361             20  PI-MODIFY-CAP           PIC X.
   362                 88  MODIFY-CAP              VALUE 'Y'.
   363             20  PI-MSG-AT-LOGON-CAP     PIC X.
   364                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   365             20  PI-FORCE-CAP            PIC X.
   366                 88  FORCE-CAP               VALUE 'Y'.
   367
   368         16  PI-PROGRAM-CONTROLS.
   369             20  PI-PGM-PRINT-OPT        PIC X.
   370             20  PI-PGM-FORMAT-OPT       PIC X.
   371             20  PI-PGM-PROCESS-OPT      PIC X.
   372             20  PI-PGM-TOTALS-OPT       PIC X.
   373
   374         16  PI-HELP-INTERFACE.
   375             20  PI-LAST-ERROR-NO        PIC X(4).
   376             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   377
   378         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   379             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   380
   381         16  PI-CR-CONTROL-IN-PROGRESS.
   382             20  PI-CR-CARRIER           PIC X.
   383             20  PI-CR-GROUPING          PIC X(6).
   384             20  PI-CR-STATE             PIC XX.
   385             20  PI-CR-ACCOUNT           PIC X(10).
   386             20  PI-CR-FIN-RESP          PIC X(10).
   387             20  PI-CR-TYPE              PIC X.
   388
   389         16  PI-CR-BATCH-NUMBER          PIC X(6).
   390
   391         16  PI-CR-MONTH-END-DT          PIC XX.
   392
   393         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   394             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   395             88  PI-ZERO-CARRIER             VALUE '1'.
   396             88  PI-ZERO-GROUPING            VALUE '2'.
   397             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   398
   399         16  PI-CARRIER-SECURITY         PIC X.
   400             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   401
   402         16  PI-ACCOUNT-SECURITY         PIC X(10).
   403             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   404             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   405
   406         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   407             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   408                                         INDEXED BY PI-ACCESS-NDX
   409                                         PIC X.
   410
   411         16  PI-GA-BILLING-CONTROL       PIC X.
   412             88  PI-GA-BILLING               VALUE '1'.
   413
   414         16  PI-MAIL-PROCESSING          PIC X.
   415             88  PI-MAIL-YES                 VALUE 'Y'.
   416
   417         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   418
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL146.cbl
   419         16  PI-AR-SYSTEM.
   420             20  PI-AR-PROCESSING-CNTL   PIC X.
   421                 88  PI-AR-PROCESSING        VALUE 'Y'.
   422             20  PI-AR-SUMMARY-CODE      PIC X(6).
   423             20  PI-AR-MONTH-END-DT      PIC XX.
   424
   425         16  PI-MP-SYSTEM.
   426             20  PI-MORTGAGE-USER            PIC X.
   427                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   428                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   429             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   430                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   431                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   432                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   433                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   434                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   435             20  PI-MP-MONTH-END-DT          PIC XX.
   436             20  PI-MP-REFERENCE-NO.
   437                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   438                 24  PI-MP-REFERENCE-SFX     PIC XX.
   439
   440         16  PI-LABEL-CONTROL            PIC X(01).
   441             88  PI-CREATE-LABELS                    VALUE 'Y'.
   442             88  PI-BYPASS-LABELS                    VALUE 'N'.
   443
   444         16  PI-BILL-GROUPING-CODE       PIC X(01).
   445             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   446
   447         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   448             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   449             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   450
   451         16  FILLER                      PIC X(14).
   452
   453     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   454******************************************************************
   455     12  PI-REDEF    REDEFINES PI-PROGRAM-WORK-AREA.
   456         16  PI-PREV-KEY.
   457             20  PI-PREV-COMPANY-CD   PIC X(01).
   458             20  PI-PREV-CHECK-NO     PIC X(07).
   459             20  PI-PREV-ORGIN        PIC X(01).
   460             20  PI-PREV-BANK-NO      PIC X(10).
   461         16  PI-SAVE-KEY.
   462             20  PI-SAVE-KEY-OCCURS   OCCURS  08 TIMES.
   463                 24  PI-SAVE-COMPANY-CD   PIC X(01).
   464                 24  PI-SAVE-CHECK-NO     PIC X(07).
   465                 24  PI-SAVE-ORIGIN       PIC X(01).
   466                 24  PI-SAVE-BANK-NO      PIC X(10).
   467         16  PI-FIRST-TIME-SW             PIC X(01).
   468             88  FIRST-TIME                   VALUE 'Y'.
   469         16  PI-STOP-PAY-SW               PIC X(01).
   470             88  PI-STOP-PAY                  VALUE 'Y'.
   471         16  PI-STOP-PAY-KEY.
   472             20  PI-SPAY-COMPANY-CD   PIC X(01).
   473             20  PI-SPAY-CHECK-NO     PIC X(07).
   474             20  PI-SPAY-ORGIN        PIC X(01).
   475             20  PI-SPAY-BANK-NO      PIC X(10).
   476         16  FILLER                   PIC X(448).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL146.cbl
   478*                                COPY EL146S.
   479 01  EL146AI.
   480     05  FILLER            PIC  X(0012).
   481*    -------------------------------
   482     05  DATEL PIC S9(0004) COMP.
   483     05  DATEF PIC  X(0001).
   484     05  FILLER REDEFINES DATEF.
   485         10  DATEA PIC  X(0001).
   486     05  DATEI PIC  X(0008).
   487*    -------------------------------
   488     05  TIMEL PIC S9(0004) COMP.
   489     05  TIMEF PIC  X(0001).
   490     05  FILLER REDEFINES TIMEF.
   491         10  TIMEA PIC  X(0001).
   492     05  TIMEI PIC  X(0005).
   493*    -------------------------------
   494     05  MAINTL PIC S9(0004) COMP.
   495     05  MAINTF PIC  X(0001).
   496     05  FILLER REDEFINES MAINTF.
   497         10  MAINTA PIC  X(0001).
   498     05  MAINTI PIC  X(0001).
   499*    -------------------------------
   500     05  CHKNOL PIC S9(0004) COMP.
   501     05  CHKNOF PIC  X(0001).
   502     05  FILLER REDEFINES CHKNOF.
   503         10  CHKNOA PIC  X(0001).
   504     05  CHKNOI PIC  X(0007).
   505*    -------------------------------
   506     05  BANKNOL PIC S9(0004) COMP.
   507     05  BANKNOF PIC  X(0001).
   508     05  FILLER REDEFINES BANKNOF.
   509         10  BANKNOA PIC  X(0001).
   510     05  BANKNOI PIC  X(0010).
   511*    -------------------------------
   512     05  CSHAMTL PIC S9(0004) COMP.
   513     05  CSHAMTF PIC  X(0001).
   514     05  FILLER REDEFINES CSHAMTF.
   515         10  CSHAMTA PIC  X(0001).
   516     05  CSHAMTI PIC  X(0012).
   517*    -------------------------------
   518     05  NOTEL PIC S9(0004) COMP.
   519     05  NOTEF PIC  X(0001).
   520     05  FILLER REDEFINES NOTEF.
   521         10  NOTEA PIC  X(0001).
   522     05  NOTEI PIC  X(67).
   523*    -------------------------------
   524     05  CHKNO1L PIC S9(0004) COMP.
   525     05  CHKNO1F PIC  X(0001).
   526     05  FILLER REDEFINES CHKNO1F.
   527         10  CHKNO1A PIC  X(0001).
   528     05  CHKNO1I PIC  X(0007).
   529*    -------------------------------
   530     05  CHKDT1L PIC S9(0004) COMP.
   531     05  CHKDT1F PIC  X(0001).
   532     05  FILLER REDEFINES CHKDT1F.
   533         10  CHKDT1A PIC  X(0001).
   534     05  CHKDT1I PIC  X(0008).
   535*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL146.cbl
   536     05  STATUS1L PIC S9(0004) COMP.
   537     05  STATUS1F PIC  X(0001).
   538     05  FILLER REDEFINES STATUS1F.
   539         10  STATUS1A PIC  X(0001).
   540     05  STATUS1I PIC  X(0001).
   541*    -------------------------------
   542     05  STATDT1L PIC S9(0004) COMP.
   543     05  STATDT1F PIC  X(0001).
   544     05  FILLER REDEFINES STATDT1F.
   545         10  STATDT1A PIC  X(0001).
   546     05  STATDT1I PIC  X(0008).
   547*    -------------------------------
   548     05  CHKAMT1L PIC S9(0004) COMP.
   549     05  CHKAMT1F PIC  X(0001).
   550     05  FILLER REDEFINES CHKAMT1F.
   551         10  CHKAMT1A PIC  X(0001).
   552     05  CHKAMT1I PIC  X(0012).
   553*    -------------------------------
   554     05  CSHAMT1L PIC S9(0004) COMP.
   555     05  CSHAMT1F PIC  X(0001).
   556     05  FILLER REDEFINES CSHAMT1F.
   557         10  CSHAMT1A PIC  X(0001).
   558     05  CSHAMT1I PIC  X(0012).
   559*    -------------------------------
   560     05  CLAIM1L PIC S9(0004) COMP.
   561     05  CLAIM1F PIC  X(0001).
   562     05  FILLER REDEFINES CLAIM1F.
   563         10  CLAIM1A PIC  X(0001).
   564     05  CLAIM1I PIC  X(0007).
   565*    -------------------------------
   566     05  CHKNO2L PIC S9(0004) COMP.
   567     05  CHKNO2F PIC  X(0001).
   568     05  FILLER REDEFINES CHKNO2F.
   569         10  CHKNO2A PIC  X(0001).
   570     05  CHKNO2I PIC  X(0007).
   571*    -------------------------------
   572     05  CHKDT2L PIC S9(0004) COMP.
   573     05  CHKDT2F PIC  X(0001).
   574     05  FILLER REDEFINES CHKDT2F.
   575         10  CHKDT2A PIC  X(0001).
   576     05  CHKDT2I PIC  X(0008).
   577*    -------------------------------
   578     05  STATUS2L PIC S9(0004) COMP.
   579     05  STATUS2F PIC  X(0001).
   580     05  FILLER REDEFINES STATUS2F.
   581         10  STATUS2A PIC  X(0001).
   582     05  STATUS2I PIC  X(0001).
   583*    -------------------------------
   584     05  STATDT2L PIC S9(0004) COMP.
   585     05  STATDT2F PIC  X(0001).
   586     05  FILLER REDEFINES STATDT2F.
   587         10  STATDT2A PIC  X(0001).
   588     05  STATDT2I PIC  X(0008).
   589*    -------------------------------
   590     05  CHKAMT2L PIC S9(0004) COMP.
   591     05  CHKAMT2F PIC  X(0001).
   592     05  FILLER REDEFINES CHKAMT2F.
   593         10  CHKAMT2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL146.cbl
   594     05  CHKAMT2I PIC  X(0012).
   595*    -------------------------------
   596     05  CSHAMT2L PIC S9(0004) COMP.
   597     05  CSHAMT2F PIC  X(0001).
   598     05  FILLER REDEFINES CSHAMT2F.
   599         10  CSHAMT2A PIC  X(0001).
   600     05  CSHAMT2I PIC  X(0012).
   601*    -------------------------------
   602     05  CLAIM2L PIC S9(0004) COMP.
   603     05  CLAIM2F PIC  X(0001).
   604     05  FILLER REDEFINES CLAIM2F.
   605         10  CLAIM2A PIC  X(0001).
   606     05  CLAIM2I PIC  X(0007).
   607*    -------------------------------
   608     05  CHKNO3L PIC S9(0004) COMP.
   609     05  CHKNO3F PIC  X(0001).
   610     05  FILLER REDEFINES CHKNO3F.
   611         10  CHKNO3A PIC  X(0001).
   612     05  CHKNO3I PIC  X(0007).
   613*    -------------------------------
   614     05  CHKDT3L PIC S9(0004) COMP.
   615     05  CHKDT3F PIC  X(0001).
   616     05  FILLER REDEFINES CHKDT3F.
   617         10  CHKDT3A PIC  X(0001).
   618     05  CHKDT3I PIC  X(0008).
   619*    -------------------------------
   620     05  STATUS3L PIC S9(0004) COMP.
   621     05  STATUS3F PIC  X(0001).
   622     05  FILLER REDEFINES STATUS3F.
   623         10  STATUS3A PIC  X(0001).
   624     05  STATUS3I PIC  X(0001).
   625*    -------------------------------
   626     05  STATDT3L PIC S9(0004) COMP.
   627     05  STATDT3F PIC  X(0001).
   628     05  FILLER REDEFINES STATDT3F.
   629         10  STATDT3A PIC  X(0001).
   630     05  STATDT3I PIC  X(0008).
   631*    -------------------------------
   632     05  CHKAMT3L PIC S9(0004) COMP.
   633     05  CHKAMT3F PIC  X(0001).
   634     05  FILLER REDEFINES CHKAMT3F.
   635         10  CHKAMT3A PIC  X(0001).
   636     05  CHKAMT3I PIC  X(0012).
   637*    -------------------------------
   638     05  CSHAMT3L PIC S9(0004) COMP.
   639     05  CSHAMT3F PIC  X(0001).
   640     05  FILLER REDEFINES CSHAMT3F.
   641         10  CSHAMT3A PIC  X(0001).
   642     05  CSHAMT3I PIC  X(0012).
   643*    -------------------------------
   644     05  CLAIM3L PIC S9(0004) COMP.
   645     05  CLAIM3F PIC  X(0001).
   646     05  FILLER REDEFINES CLAIM3F.
   647         10  CLAIM3A PIC  X(0001).
   648     05  CLAIM3I PIC  X(0007).
   649*    -------------------------------
   650     05  CHKNO4L PIC S9(0004) COMP.
   651     05  CHKNO4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL146.cbl
   652     05  FILLER REDEFINES CHKNO4F.
   653         10  CHKNO4A PIC  X(0001).
   654     05  CHKNO4I PIC  X(0007).
   655*    -------------------------------
   656     05  CHKDT4L PIC S9(0004) COMP.
   657     05  CHKDT4F PIC  X(0001).
   658     05  FILLER REDEFINES CHKDT4F.
   659         10  CHKDT4A PIC  X(0001).
   660     05  CHKDT4I PIC  X(0008).
   661*    -------------------------------
   662     05  STATUS4L PIC S9(0004) COMP.
   663     05  STATUS4F PIC  X(0001).
   664     05  FILLER REDEFINES STATUS4F.
   665         10  STATUS4A PIC  X(0001).
   666     05  STATUS4I PIC  X(0001).
   667*    -------------------------------
   668     05  STATDT4L PIC S9(0004) COMP.
   669     05  STATDT4F PIC  X(0001).
   670     05  FILLER REDEFINES STATDT4F.
   671         10  STATDT4A PIC  X(0001).
   672     05  STATDT4I PIC  X(0008).
   673*    -------------------------------
   674     05  CHKAMT4L PIC S9(0004) COMP.
   675     05  CHKAMT4F PIC  X(0001).
   676     05  FILLER REDEFINES CHKAMT4F.
   677         10  CHKAMT4A PIC  X(0001).
   678     05  CHKAMT4I PIC  X(0012).
   679*    -------------------------------
   680     05  CSHAMT4L PIC S9(0004) COMP.
   681     05  CSHAMT4F PIC  X(0001).
   682     05  FILLER REDEFINES CSHAMT4F.
   683         10  CSHAMT4A PIC  X(0001).
   684     05  CSHAMT4I PIC  X(0012).
   685*    -------------------------------
   686     05  CLAIM4L PIC S9(0004) COMP.
   687     05  CLAIM4F PIC  X(0001).
   688     05  FILLER REDEFINES CLAIM4F.
   689         10  CLAIM4A PIC  X(0001).
   690     05  CLAIM4I PIC  X(0007).
   691*    -------------------------------
   692     05  CHKNO5L PIC S9(0004) COMP.
   693     05  CHKNO5F PIC  X(0001).
   694     05  FILLER REDEFINES CHKNO5F.
   695         10  CHKNO5A PIC  X(0001).
   696     05  CHKNO5I PIC  X(0007).
   697*    -------------------------------
   698     05  CHKDT5L PIC S9(0004) COMP.
   699     05  CHKDT5F PIC  X(0001).
   700     05  FILLER REDEFINES CHKDT5F.
   701         10  CHKDT5A PIC  X(0001).
   702     05  CHKDT5I PIC  X(0008).
   703*    -------------------------------
   704     05  STATUS5L PIC S9(0004) COMP.
   705     05  STATUS5F PIC  X(0001).
   706     05  FILLER REDEFINES STATUS5F.
   707         10  STATUS5A PIC  X(0001).
   708     05  STATUS5I PIC  X(0001).
   709*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL146.cbl
   710     05  STATDT5L PIC S9(0004) COMP.
   711     05  STATDT5F PIC  X(0001).
   712     05  FILLER REDEFINES STATDT5F.
   713         10  STATDT5A PIC  X(0001).
   714     05  STATDT5I PIC  X(0008).
   715*    -------------------------------
   716     05  CHKAMT5L PIC S9(0004) COMP.
   717     05  CHKAMT5F PIC  X(0001).
   718     05  FILLER REDEFINES CHKAMT5F.
   719         10  CHKAMT5A PIC  X(0001).
   720     05  CHKAMT5I PIC  X(0012).
   721*    -------------------------------
   722     05  CSHAMT5L PIC S9(0004) COMP.
   723     05  CSHAMT5F PIC  X(0001).
   724     05  FILLER REDEFINES CSHAMT5F.
   725         10  CSHAMT5A PIC  X(0001).
   726     05  CSHAMT5I PIC  X(0012).
   727*    -------------------------------
   728     05  CLAIM5L PIC S9(0004) COMP.
   729     05  CLAIM5F PIC  X(0001).
   730     05  FILLER REDEFINES CLAIM5F.
   731         10  CLAIM5A PIC  X(0001).
   732     05  CLAIM5I PIC  X(0007).
   733*    -------------------------------
   734     05  CHKNO6L PIC S9(0004) COMP.
   735     05  CHKNO6F PIC  X(0001).
   736     05  FILLER REDEFINES CHKNO6F.
   737         10  CHKNO6A PIC  X(0001).
   738     05  CHKNO6I PIC  X(0007).
   739*    -------------------------------
   740     05  CHKDT6L PIC S9(0004) COMP.
   741     05  CHKDT6F PIC  X(0001).
   742     05  FILLER REDEFINES CHKDT6F.
   743         10  CHKDT6A PIC  X(0001).
   744     05  CHKDT6I PIC  X(0008).
   745*    -------------------------------
   746     05  STATUS6L PIC S9(0004) COMP.
   747     05  STATUS6F PIC  X(0001).
   748     05  FILLER REDEFINES STATUS6F.
   749         10  STATUS6A PIC  X(0001).
   750     05  STATUS6I PIC  X(0001).
   751*    -------------------------------
   752     05  STATDT6L PIC S9(0004) COMP.
   753     05  STATDT6F PIC  X(0001).
   754     05  FILLER REDEFINES STATDT6F.
   755         10  STATDT6A PIC  X(0001).
   756     05  STATDT6I PIC  X(0008).
   757*    -------------------------------
   758     05  CHKAMT6L PIC S9(0004) COMP.
   759     05  CHKAMT6F PIC  X(0001).
   760     05  FILLER REDEFINES CHKAMT6F.
   761         10  CHKAMT6A PIC  X(0001).
   762     05  CHKAMT6I PIC  X(0012).
   763*    -------------------------------
   764     05  CSHAMT6L PIC S9(0004) COMP.
   765     05  CSHAMT6F PIC  X(0001).
   766     05  FILLER REDEFINES CSHAMT6F.
   767         10  CSHAMT6A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL146.cbl
   768     05  CSHAMT6I PIC  X(0012).
   769*    -------------------------------
   770     05  CLAIM6L PIC S9(0004) COMP.
   771     05  CLAIM6F PIC  X(0001).
   772     05  FILLER REDEFINES CLAIM6F.
   773         10  CLAIM6A PIC  X(0001).
   774     05  CLAIM6I PIC  X(0007).
   775*    -------------------------------
   776     05  CHKNO7L PIC S9(0004) COMP.
   777     05  CHKNO7F PIC  X(0001).
   778     05  FILLER REDEFINES CHKNO7F.
   779         10  CHKNO7A PIC  X(0001).
   780     05  CHKNO7I PIC  X(0007).
   781*    -------------------------------
   782     05  CHKDT7L PIC S9(0004) COMP.
   783     05  CHKDT7F PIC  X(0001).
   784     05  FILLER REDEFINES CHKDT7F.
   785         10  CHKDT7A PIC  X(0001).
   786     05  CHKDT7I PIC  X(0008).
   787*    -------------------------------
   788     05  STATUS7L PIC S9(0004) COMP.
   789     05  STATUS7F PIC  X(0001).
   790     05  FILLER REDEFINES STATUS7F.
   791         10  STATUS7A PIC  X(0001).
   792     05  STATUS7I PIC  X(0001).
   793*    -------------------------------
   794     05  STATDT7L PIC S9(0004) COMP.
   795     05  STATDT7F PIC  X(0001).
   796     05  FILLER REDEFINES STATDT7F.
   797         10  STATDT7A PIC  X(0001).
   798     05  STATDT7I PIC  X(0008).
   799*    -------------------------------
   800     05  CHKAMT7L PIC S9(0004) COMP.
   801     05  CHKAMT7F PIC  X(0001).
   802     05  FILLER REDEFINES CHKAMT7F.
   803         10  CHKAMT7A PIC  X(0001).
   804     05  CHKAMT7I PIC  X(0012).
   805*    -------------------------------
   806     05  CSHAMT7L PIC S9(0004) COMP.
   807     05  CSHAMT7F PIC  X(0001).
   808     05  FILLER REDEFINES CSHAMT7F.
   809         10  CSHAMT7A PIC  X(0001).
   810     05  CSHAMT7I PIC  X(0012).
   811*    -------------------------------
   812     05  CLAIM7L PIC S9(0004) COMP.
   813     05  CLAIM7F PIC  X(0001).
   814     05  FILLER REDEFINES CLAIM7F.
   815         10  CLAIM7A PIC  X(0001).
   816     05  CLAIM7I PIC  X(0007).
   817*    -------------------------------
   818     05  CHKNO8L PIC S9(0004) COMP.
   819     05  CHKNO8F PIC  X(0001).
   820     05  FILLER REDEFINES CHKNO8F.
   821         10  CHKNO8A PIC  X(0001).
   822     05  CHKNO8I PIC  X(0007).
   823*    -------------------------------
   824     05  CHKDT8L PIC S9(0004) COMP.
   825     05  CHKDT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL146.cbl
   826     05  FILLER REDEFINES CHKDT8F.
   827         10  CHKDT8A PIC  X(0001).
   828     05  CHKDT8I PIC  X(0008).
   829*    -------------------------------
   830     05  STATUS8L PIC S9(0004) COMP.
   831     05  STATUS8F PIC  X(0001).
   832     05  FILLER REDEFINES STATUS8F.
   833         10  STATUS8A PIC  X(0001).
   834     05  STATUS8I PIC  X(0001).
   835*    -------------------------------
   836     05  STATDT8L PIC S9(0004) COMP.
   837     05  STATDT8F PIC  X(0001).
   838     05  FILLER REDEFINES STATDT8F.
   839         10  STATDT8A PIC  X(0001).
   840     05  STATDT8I PIC  X(0008).
   841*    -------------------------------
   842     05  CHKAMT8L PIC S9(0004) COMP.
   843     05  CHKAMT8F PIC  X(0001).
   844     05  FILLER REDEFINES CHKAMT8F.
   845         10  CHKAMT8A PIC  X(0001).
   846     05  CHKAMT8I PIC  X(0012).
   847*    -------------------------------
   848     05  CSHAMT8L PIC S9(0004) COMP.
   849     05  CSHAMT8F PIC  X(0001).
   850     05  FILLER REDEFINES CSHAMT8F.
   851         10  CSHAMT8A PIC  X(0001).
   852     05  CSHAMT8I PIC  X(0012).
   853*    -------------------------------
   854     05  CLAIM8L PIC S9(0004) COMP.
   855     05  CLAIM8F PIC  X(0001).
   856     05  FILLER REDEFINES CLAIM8F.
   857         10  CLAIM8A PIC  X(0001).
   858     05  CLAIM8I PIC  X(0007).
   859*    -------------------------------
   860     05  ERRMSG1L PIC S9(0004) COMP.
   861     05  ERRMSG1F PIC  X(0001).
   862     05  FILLER REDEFINES ERRMSG1F.
   863         10  ERRMSG1A PIC  X(0001).
   864     05  ERRMSG1I PIC  X(0072).
   865*    -------------------------------
   866     05  ERRMSG2L PIC S9(0004) COMP.
   867     05  ERRMSG2F PIC  X(0001).
   868     05  FILLER REDEFINES ERRMSG2F.
   869         10  ERRMSG2A PIC  X(0001).
   870     05  ERRMSG2I PIC  X(0072).
   871*    -------------------------------
   872     05  ENTERPFL PIC S9(0004) COMP.
   873     05  ENTERPFF PIC  X(0001).
   874     05  FILLER REDEFINES ENTERPFF.
   875         10  ENTERPFA PIC  X(0001).
   876     05  ENTERPFI PIC  99.
   877 01  EL146AO REDEFINES EL146AI.
   878     05  FILLER            PIC  X(0012).
   879*    -------------------------------
   880     05  FILLER            PIC  X(0003).
   881     05  DATEO PIC  X(0008).
   882*    -------------------------------
   883     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL146.cbl
   884     05  TIMEO PIC  99.99.
   885*    -------------------------------
   886     05  FILLER            PIC  X(0003).
   887     05  MAINTO PIC  X(0001).
   888*    -------------------------------
   889     05  FILLER            PIC  X(0003).
   890     05  CHKNOO PIC  X(0007).
   891*    -------------------------------
   892     05  FILLER            PIC  X(0003).
   893     05  BANKNOO PIC  X(0010).
   894*    -------------------------------
   895     05  FILLER            PIC  X(0003).
   896     05  CSHAMTO PIC  Z,ZZZ,ZZZ.ZZ.
   897*    -------------------------------
   898     05  FILLER            PIC  X(0003).
   899     05  NOTEO PIC  X(67).
   900*    -------------------------------
   901     05  FILLER            PIC  X(0003).
   902     05  CHKNO1O PIC  X(0007).
   903*    -------------------------------
   904     05  FILLER            PIC  X(0003).
   905     05  CHKDT1O PIC  X(0008).
   906*    -------------------------------
   907     05  FILLER            PIC  X(0003).
   908     05  STATUS1O PIC  X(0001).
   909*    -------------------------------
   910     05  FILLER            PIC  X(0003).
   911     05  STATDT1O PIC  X(0008).
   912*    -------------------------------
   913     05  FILLER            PIC  X(0003).
   914     05  CHKAMT1O PIC  Z,ZZZ,ZZZ.ZZ.
   915*    -------------------------------
   916     05  FILLER            PIC  X(0003).
   917     05  CSHAMT1O PIC  Z,ZZZ,ZZZ.ZZ.
   918*    -------------------------------
   919     05  FILLER            PIC  X(0003).
   920     05  CLAIM1O PIC  X(0007).
   921*    -------------------------------
   922     05  FILLER            PIC  X(0003).
   923     05  CHKNO2O PIC  X(0007).
   924*    -------------------------------
   925     05  FILLER            PIC  X(0003).
   926     05  CHKDT2O PIC  X(0008).
   927*    -------------------------------
   928     05  FILLER            PIC  X(0003).
   929     05  STATUS2O PIC  X(0001).
   930*    -------------------------------
   931     05  FILLER            PIC  X(0003).
   932     05  STATDT2O PIC  X(0008).
   933*    -------------------------------
   934     05  FILLER            PIC  X(0003).
   935     05  CHKAMT2O PIC  Z,ZZZ,ZZZ.ZZ.
   936*    -------------------------------
   937     05  FILLER            PIC  X(0003).
   938     05  CSHAMT2O PIC  Z,ZZZ,ZZZ.ZZ.
   939*    -------------------------------
   940     05  FILLER            PIC  X(0003).
   941     05  CLAIM2O PIC  X(0007).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL146.cbl
   942*    -------------------------------
   943     05  FILLER            PIC  X(0003).
   944     05  CHKNO3O PIC  X(0007).
   945*    -------------------------------
   946     05  FILLER            PIC  X(0003).
   947     05  CHKDT3O PIC  X(0008).
   948*    -------------------------------
   949     05  FILLER            PIC  X(0003).
   950     05  STATUS3O PIC  X(0001).
   951*    -------------------------------
   952     05  FILLER            PIC  X(0003).
   953     05  STATDT3O PIC  X(0008).
   954*    -------------------------------
   955     05  FILLER            PIC  X(0003).
   956     05  CHKAMT3O PIC  Z,ZZZ,ZZZ.ZZ.
   957*    -------------------------------
   958     05  FILLER            PIC  X(0003).
   959     05  CSHAMT3O PIC  Z,ZZZ,ZZZ.ZZ.
   960*    -------------------------------
   961     05  FILLER            PIC  X(0003).
   962     05  CLAIM3O PIC  X(0007).
   963*    -------------------------------
   964     05  FILLER            PIC  X(0003).
   965     05  CHKNO4O PIC  X(0007).
   966*    -------------------------------
   967     05  FILLER            PIC  X(0003).
   968     05  CHKDT4O PIC  X(0008).
   969*    -------------------------------
   970     05  FILLER            PIC  X(0003).
   971     05  STATUS4O PIC  X(0001).
   972*    -------------------------------
   973     05  FILLER            PIC  X(0003).
   974     05  STATDT4O PIC  X(0008).
   975*    -------------------------------
   976     05  FILLER            PIC  X(0003).
   977     05  CHKAMT4O PIC  Z,ZZZ,ZZZ.ZZ.
   978*    -------------------------------
   979     05  FILLER            PIC  X(0003).
   980     05  CSHAMT4O PIC  Z,ZZZ,ZZZ.ZZ.
   981*    -------------------------------
   982     05  FILLER            PIC  X(0003).
   983     05  CLAIM4O PIC  X(0007).
   984*    -------------------------------
   985     05  FILLER            PIC  X(0003).
   986     05  CHKNO5O PIC  X(0007).
   987*    -------------------------------
   988     05  FILLER            PIC  X(0003).
   989     05  CHKDT5O PIC  X(0008).
   990*    -------------------------------
   991     05  FILLER            PIC  X(0003).
   992     05  STATUS5O PIC  X(0001).
   993*    -------------------------------
   994     05  FILLER            PIC  X(0003).
   995     05  STATDT5O PIC  X(0008).
   996*    -------------------------------
   997     05  FILLER            PIC  X(0003).
   998     05  CHKAMT5O PIC  Z,ZZZ,ZZZ.ZZ.
   999*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL146.cbl
  1000     05  FILLER            PIC  X(0003).
  1001     05  CSHAMT5O PIC  Z,ZZZ,ZZZ.ZZ.
  1002*    -------------------------------
  1003     05  FILLER            PIC  X(0003).
  1004     05  CLAIM5O PIC  X(0007).
  1005*    -------------------------------
  1006     05  FILLER            PIC  X(0003).
  1007     05  CHKNO6O PIC  X(0007).
  1008*    -------------------------------
  1009     05  FILLER            PIC  X(0003).
  1010     05  CHKDT6O PIC  X(0008).
  1011*    -------------------------------
  1012     05  FILLER            PIC  X(0003).
  1013     05  STATUS6O PIC  X(0001).
  1014*    -------------------------------
  1015     05  FILLER            PIC  X(0003).
  1016     05  STATDT6O PIC  X(0008).
  1017*    -------------------------------
  1018     05  FILLER            PIC  X(0003).
  1019     05  CHKAMT6O PIC  Z,ZZZ,ZZZ.ZZ.
  1020*    -------------------------------
  1021     05  FILLER            PIC  X(0003).
  1022     05  CSHAMT6O PIC  Z,ZZZ,ZZZ.ZZ.
  1023*    -------------------------------
  1024     05  FILLER            PIC  X(0003).
  1025     05  CLAIM6O PIC  X(0007).
  1026*    -------------------------------
  1027     05  FILLER            PIC  X(0003).
  1028     05  CHKNO7O PIC  X(0007).
  1029*    -------------------------------
  1030     05  FILLER            PIC  X(0003).
  1031     05  CHKDT7O PIC  X(0008).
  1032*    -------------------------------
  1033     05  FILLER            PIC  X(0003).
  1034     05  STATUS7O PIC  X(0001).
  1035*    -------------------------------
  1036     05  FILLER            PIC  X(0003).
  1037     05  STATDT7O PIC  X(0008).
  1038*    -------------------------------
  1039     05  FILLER            PIC  X(0003).
  1040     05  CHKAMT7O PIC  Z,ZZZ,ZZZ.ZZ.
  1041*    -------------------------------
  1042     05  FILLER            PIC  X(0003).
  1043     05  CSHAMT7O PIC  Z,ZZZ,ZZZ.ZZ.
  1044*    -------------------------------
  1045     05  FILLER            PIC  X(0003).
  1046     05  CLAIM7O PIC  X(0007).
  1047*    -------------------------------
  1048     05  FILLER            PIC  X(0003).
  1049     05  CHKNO8O PIC  X(0007).
  1050*    -------------------------------
  1051     05  FILLER            PIC  X(0003).
  1052     05  CHKDT8O PIC  X(0008).
  1053*    -------------------------------
  1054     05  FILLER            PIC  X(0003).
  1055     05  STATUS8O PIC  X(0001).
  1056*    -------------------------------
  1057     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL146.cbl
  1058     05  STATDT8O PIC  X(0008).
  1059*    -------------------------------
  1060     05  FILLER            PIC  X(0003).
  1061     05  CHKAMT8O PIC  Z,ZZZ,ZZZ.ZZ.
  1062*    -------------------------------
  1063     05  FILLER            PIC  X(0003).
  1064     05  CSHAMT8O PIC  Z,ZZZ,ZZZ.ZZ.
  1065*    -------------------------------
  1066     05  FILLER            PIC  X(0003).
  1067     05  CLAIM8O PIC  X(0007).
  1068*    -------------------------------
  1069     05  FILLER            PIC  X(0003).
  1070     05  ERRMSG1O PIC  X(0072).
  1071*    -------------------------------
  1072     05  FILLER            PIC  X(0003).
  1073     05  ERRMSG2O PIC  X(0072).
  1074*    -------------------------------
  1075     05  FILLER            PIC  X(0003).
  1076     05  ENTERPFO PIC  X(0002).
  1077*    -------------------------------
  1078 01  FILLER                      REDEFINES
  1079     EL146AI.
  1080     12  FILLER                            PIC X(35).
  1081     12  EL146A-SCREEN.
  1082         16  EL146A-TARGET-CHK-NO-LENGTH   PIC S9(04)  COMP.
  1083         16  EL146A-TARGET-CHK-NO-ATTRB    PIC X(01).
  1084         16  EL146A-TARGET-CHK-NO          PIC X(07).
  1085         16  EL146A-BANK-NO-LENGTH         PIC S9(04)  COMP.
  1086         16  EL146A-BANK-NO-ATTRB          PIC X(01).
  1087         16  EL146A-BANK-NO                PIC X(10).
  1088         16  EL146A-TARGET-CSH-AMT-LENGTH  PIC S9(04)  COMP.
  1089         16  EL146A-TARGET-CSH-AMT-ATTRB   PIC X(01).
  1090         16  EL146A-TARGET-CSH-AMT         PIC Z,ZZZ,ZZ9.99.
  1091         16  EL146A-CHK-NOTE-LENGTH        PIC S9(04)  COMP.
  1092         16  EL146A-CHK-NOTE-ATTRB         PIC X(01).
  1093         16  EL146A-CHK-NOTE               PIC X(67).
  1094         16  EL146A-CHECK-DEFINED-ACTIVITY OCCURS 08 TIMES.
  1095             20  EL146A-CHK-NO-LENGTH      PIC S9(04)  COMP.
  1096             20  EL146A-CHK-NO-ATTRB       PIC X(01).
  1097             20  EL146A-CHK-NO             PIC X(07).
  1098
  1099             20  EL146A-CHK-DATE-LENGTH    PIC S9(04)  COMP.
  1100             20  EL146A-CHK-DATE-ATTRB     PIC X(01).
  1101             20  EL146A-CHK-DATE           PIC 9(08).
  1102
  1103             20  EL146A-CHK-STAT-LENGTH    PIC S9(04)  COMP.
  1104             20  EL146A-CHK-STAT-ATTRB     PIC X(01).
  1105             20  EL146A-CHK-STAT           PIC X(01).
  1106
  1107             20  EL146A-CHK-STDT-LENGTH    PIC S9(04)  COMP.
  1108             20  EL146A-CHK-STDT-ATTRB     PIC X(01).
  1109             20  EL146A-CHK-STDT           PIC 9(08).
  1110
  1111             20  EL146A-CHK-AMT-LENGTH     PIC S9(04)  COMP.
  1112             20  EL146A-CHK-AMT-ATTRB      PIC X(01).
  1113             20  EL146A-CHK-AMT            PIC Z,ZZZ,ZZ9.99.
  1114
  1115             20  EL146A-CHK-CSH-AMT-LENGTH PIC S9(04)  COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL146.cbl
  1116             20  EL146A-CHK-CSH-AMT-ATTRB  PIC X(01).
  1117             20  EL146A-CHK-CSH-AMT        PIC Z,ZZZ,ZZ9.99.
  1118
  1119             20  EL146A-CHK-CLM-NO-LENGTH  PIC S9(04)  COMP.
  1120             20  EL146A-CHK-CLM-NO-ATTRB   PIC X(01).
  1121             20  EL146A-CHK-CLM-NO         PIC X(07).
  1122
  1123
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL146.cbl
  1125*                                COPY ELCEMIB.
  1126******************************************************************
  1127*                                                                *
  1128*                                                                *
  1129*                            ELCEMIB.                            *
  1130*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1131*                            VMOD=2.005                          *
  1132*                                                                *
  1133*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1134*                                                                *
  1135******************************************************************
  1136 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1137     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1138     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1139     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1140     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1141     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1142     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1143     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1144     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1145     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1146         88  EMI-NO-ERRORS                    VALUE '1'.
  1147         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1148         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1149     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1150         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1151     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1152         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1153         88  EMI-AREA1-FULL                   VALUE '2'.
  1154     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1155         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1156         88  EMI-AREA2-FULL                   VALUE '2'.
  1157     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1158         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1159         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1160         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1161         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1162         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1163     12  EMI-ERROR-LINES.
  1164         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1165         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1166         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1167         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1168             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1169                 24  EMI-ERR-NUM         PIC X(4).
  1170                 24  EMI-FILLER          PIC X.
  1171                 24  EMI-SEV             PIC X.
  1172                 24  FILLER              PIC X.
  1173             20  FILLER                  PIC X(02).
  1174     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1175         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1176             20  EMI-ERROR-NUMBER    PIC X(4).
  1177             20  EMI-FILL            PIC X.
  1178             20  EMI-SEVERITY        PIC X.
  1179             20  FILLER              PIC X.
  1180             20  EMI-ERROR-TEXT.
  1181                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1182                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL146.cbl
  1183     12  EMI-SEVERITY-SAVE           PIC X.
  1184         88  EMI-NOTE                    VALUE 'N'.
  1185         88  EMI-WARNING                 VALUE 'W'.
  1186         88  EMI-FORCABLE                VALUE 'F'.
  1187         88  EMI-FATAL                   VALUE 'X'.
  1188     12  EMI-MESSAGE-FLAG            PIC X.
  1189         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1190         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1191     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1192     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1193         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1194         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1195         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1196     12  FILLER                      PIC X(137)  VALUE SPACES.
  1197     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1198     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1199     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1200     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL146.cbl
  1202*                                COPY ELCDATE.
  1203******************************************************************
  1204*                                                                *
  1205*                                                                *
  1206*                            ELCDATE.                            *
  1207*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1208*                            VMOD=2.003
  1209*                                                                *
  1210*                                                                *
  1211*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1212*                 LENGTH = 200                                   *
  1213******************************************************************
  1214
  1215 01  DATE-CONVERSION-DATA.
  1216     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1217     12  DC-OPTION-CODE                PIC X.
  1218         88  BIN-TO-GREG                VALUE ' '.
  1219         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1220         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1221         88  YMD-GREG-TO-BIN            VALUE '3'.
  1222         88  MDY-GREG-TO-BIN            VALUE '4'.
  1223         88  JULIAN-TO-BIN              VALUE '5'.
  1224         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1225         88  FIND-CENTURY               VALUE '7'.
  1226         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1227         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1228         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1229         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1230         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1231         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1232         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1233         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1234         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1235         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1236         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1237         88  BIN-3-TO-GREG              VALUE 'I'.
  1238         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1239         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1240         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1241         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1242         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1243         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1244         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1245         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1246         88  THREE-CHARACTER-BIN
  1247                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1248         88  GREGORIAN-TO-BIN
  1249                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1250         88  BIN-TO-GREGORIAN
  1251                  VALUES ' ' '1' 'I' '8' 'G'.
  1252         88  JULIAN-TO-BINARY
  1253                  VALUES '5' 'C' 'E' 'F'.
  1254     12  DC-ERROR-CODE                 PIC X.
  1255         88  NO-CONVERSION-ERROR        VALUE ' '.
  1256         88  DATE-CONVERSION-ERROR
  1257                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1258         88  DATE-IS-ZERO               VALUE '1'.
  1259         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL146.cbl
  1260         88  DATE-IS-INVALID            VALUE '3'.
  1261         88  DATE1-GREATER-DATE2        VALUE '4'.
  1262         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1263         88  DATE-INVALID-OPTION        VALUE '9'.
  1264         88  INVALID-CENTURY            VALUE 'A'.
  1265         88  ONLY-CENTURY               VALUE 'B'.
  1266         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1267         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1268     12  DC-END-OF-MONTH               PIC X.
  1269         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1270     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1271         88  USE-NORMAL-PROCESS         VALUE ' '.
  1272         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1273         88  ADJUST-UP-100-YRS          VALUE '2'.
  1274     12  FILLER                        PIC X.
  1275     12  DC-CONVERSION-DATES.
  1276         16  DC-BIN-DATE-1             PIC XX.
  1277         16  DC-BIN-DATE-2             PIC XX.
  1278         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1279         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1280                       DC-GREG-DATE-1-EDIT.
  1281             20  DC-EDIT1-MONTH        PIC 99.
  1282             20  SLASH1-1              PIC X.
  1283             20  DC-EDIT1-DAY          PIC 99.
  1284             20  SLASH1-2              PIC X.
  1285             20  DC-EDIT1-YEAR         PIC 99.
  1286         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1287         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1288                     DC-GREG-DATE-2-EDIT.
  1289             20  DC-EDIT2-MONTH        PIC 99.
  1290             20  SLASH2-1              PIC X.
  1291             20  DC-EDIT2-DAY          PIC 99.
  1292             20  SLASH2-2              PIC X.
  1293             20  DC-EDIT2-YEAR         PIC 99.
  1294         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1295         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1296                     DC-GREG-DATE-1-YMD.
  1297             20  DC-YMD-YEAR           PIC 99.
  1298             20  DC-YMD-MONTH          PIC 99.
  1299             20  DC-YMD-DAY            PIC 99.
  1300         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1301         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1302                      DC-GREG-DATE-1-MDY.
  1303             20  DC-MDY-MONTH          PIC 99.
  1304             20  DC-MDY-DAY            PIC 99.
  1305             20  DC-MDY-YEAR           PIC 99.
  1306         16  DC-GREG-DATE-1-ALPHA.
  1307             20  DC-ALPHA-MONTH        PIC X(10).
  1308             20  DC-ALPHA-DAY          PIC 99.
  1309             20  FILLER                PIC XX.
  1310             20  DC-ALPHA-CENTURY.
  1311                 24 DC-ALPHA-CEN-N     PIC 99.
  1312             20  DC-ALPHA-YEAR         PIC 99.
  1313         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1314         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1315         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1316         16  DC-JULIAN-DATE            PIC 9(05).
  1317         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL146.cbl
  1318                                       PIC 9(05).
  1319         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1320             20  DC-JULIAN-YEAR        PIC 99.
  1321             20  DC-JULIAN-DAYS        PIC 999.
  1322         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1323         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1324         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1325     12  DATE-CONVERSION-VARIBLES.
  1326         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1327         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1328             20  FILLER                PIC 9(3).
  1329             20  HOLD-CEN-1-CCYY.
  1330                 24  HOLD-CEN-1-CC     PIC 99.
  1331                 24  HOLD-CEN-1-YY     PIC 99.
  1332             20  HOLD-CEN-1-MO         PIC 99.
  1333             20  HOLD-CEN-1-DA         PIC 99.
  1334         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1335             20  HOLD-CEN-1-R-MO       PIC 99.
  1336             20  HOLD-CEN-1-R-DA       PIC 99.
  1337             20  HOLD-CEN-1-R-CCYY.
  1338                 24  HOLD-CEN-1-R-CC   PIC 99.
  1339                 24  HOLD-CEN-1-R-YY   PIC 99.
  1340             20  FILLER                PIC 9(3).
  1341         16  HOLD-CENTURY-1-X.
  1342             20  FILLER                PIC X(3)  VALUE SPACES.
  1343             20  HOLD-CEN-1-X-CCYY.
  1344                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1345                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1346             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1347             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1348         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1349             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1350             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1351             20  HOLD-CEN-1-R-X-CCYY.
  1352                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1353                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1354             20  FILLER                PIC XXX.
  1355         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1356         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1357         16  DC-JULIAN-DATE-1          PIC 9(07).
  1358         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1359             20  DC-JULIAN-1-CCYY.
  1360                 24  DC-JULIAN-1-CC    PIC 99.
  1361                 24  DC-JULIAN-1-YR    PIC 99.
  1362             20  DC-JULIAN-DA-1        PIC 999.
  1363         16  DC-JULIAN-DATE-2          PIC 9(07).
  1364         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1365             20  DC-JULIAN-2-CCYY.
  1366                 24  DC-JULIAN-2-CC    PIC 99.
  1367                 24  DC-JULIAN-2-YR    PIC 99.
  1368             20  DC-JULIAN-DA-2        PIC 999.
  1369         16  DC-GREG-DATE-A-EDIT.
  1370             20  DC-EDITA-MONTH        PIC 99.
  1371             20  SLASHA-1              PIC X VALUE '/'.
  1372             20  DC-EDITA-DAY          PIC 99.
  1373             20  SLASHA-2              PIC X VALUE '/'.
  1374             20  DC-EDITA-CCYY.
  1375                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL146.cbl
  1376                 24  DC-EDITA-YEAR     PIC 99.
  1377         16  DC-GREG-DATE-B-EDIT.
  1378             20  DC-EDITB-MONTH        PIC 99.
  1379             20  SLASHB-1              PIC X VALUE '/'.
  1380             20  DC-EDITB-DAY          PIC 99.
  1381             20  SLASHB-2              PIC X VALUE '/'.
  1382             20  DC-EDITB-CCYY.
  1383                 24  DC-EDITB-CENT     PIC 99.
  1384                 24  DC-EDITB-YEAR     PIC 99.
  1385         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1386         16  DC-GREG-DATE-CYMD-R REDEFINES
  1387                              DC-GREG-DATE-CYMD.
  1388             20  DC-CYMD-CEN           PIC 99.
  1389             20  DC-CYMD-YEAR          PIC 99.
  1390             20  DC-CYMD-MONTH         PIC 99.
  1391             20  DC-CYMD-DAY           PIC 99.
  1392         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1393         16  DC-GREG-DATE-MDCY-R REDEFINES
  1394                              DC-GREG-DATE-MDCY.
  1395             20  DC-MDCY-MONTH         PIC 99.
  1396             20  DC-MDCY-DAY           PIC 99.
  1397             20  DC-MDCY-CEN           PIC 99.
  1398             20  DC-MDCY-YEAR          PIC 99.
  1399    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1400        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1401    12  DC-EL310-DATE                  PIC X(21).
  1402    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL146.cbl
  1404*                                COPY ELCLOGOF.
  1405******************************************************************
  1406*                                                                *
  1407*                                                                *
  1408*                            ELCLOGOF.                           *
  1409*                            VMOD=2.001                          *
  1410*                                                                *
  1411*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1412*                                                                *
  1413******************************************************************
  1414 01  CLASIC-LOGOFF.
  1415     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1416     12  LOGOFF-TEXT.
  1417         16  FILLER          PIC X(5)    VALUE SPACES.
  1418         16  LOGOFF-MSG.
  1419             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1420             20  FILLER      PIC X       VALUE SPACES.
  1421             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1422         16  FILLER          PIC X(80)
  1423           VALUE '* YOU ARE NOW LOGGED OFF'.
  1424         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1425         16  FILLER          PIC X       VALUE QUOTE.
  1426         16  LOGOFF-SYS-MSG  PIC X(17)
  1427           VALUE 'S CLAS-IC SYSTEM '.
  1428     12  TEXT-MESSAGES.
  1429         16  UNACCESS-MSG    PIC X(29)
  1430             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1431         16  PGMIDERR-MSG    PIC X(17)
  1432             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL146.cbl
  1434*                                COPY ELCATTR.
  1435******************************************************************
  1436*                                                                *
  1437*                            ELCATTR.                            *
  1438*                            VMOD=2.001                          *
  1439*                                                                *
  1440*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1441*                                                                *
  1442*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1443*                                                                *
  1444*                   POS 1   P=PROTECTED                          *
  1445*                           U=UNPROTECTED                        *
  1446*                           S=ASKIP                              *
  1447*                   POS 2   A=ALPHA/NUMERIC                      *
  1448*                           N=NUMERIC                            *
  1449*                   POS 3   N=NORMAL                             *
  1450*                           B=BRIGHT                             *
  1451*                           D=DARK                               *
  1452*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1453*                           OF=MODIFIED DATA TAG OFF             *
  1454*                                                                *
  1455*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1456******************************************************************
  1457 01  ATTRIBUTE-LIST.
  1458     12  AL-PABOF            PIC X       VALUE 'Y'.
  1459     12  AL-PABON            PIC X       VALUE 'Z'.
  1460     12  AL-PADOF            PIC X       VALUE '%'.
  1461     12  AL-PADON            PIC X       VALUE '_'.
  1462     12  AL-PANOF            PIC X       VALUE '-'.
  1463     12  AL-PANON            PIC X       VALUE '/'.
  1464     12  AL-SABOF            PIC X       VALUE '8'.
  1465     12  AL-SABON            PIC X       VALUE '9'.
  1466     12  AL-SADOF            PIC X       VALUE '@'.
  1467     12  AL-SADON            PIC X       VALUE QUOTE.
  1468     12  AL-SANOF            PIC X       VALUE '0'.
  1469     12  AL-SANON            PIC X       VALUE '1'.
  1470     12  AL-UABOF            PIC X       VALUE 'H'.
  1471     12  AL-UABON            PIC X       VALUE 'I'.
  1472     12  AL-UADOF            PIC X       VALUE '<'.
  1473     12  AL-UADON            PIC X       VALUE '('.
  1474     12  AL-UANOF            PIC X       VALUE ' '.
  1475     12  AL-UANON            PIC X       VALUE 'A'.
  1476     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1477     12  AL-UNBON            PIC X       VALUE 'R'.
  1478     12  AL-UNDOF            PIC X       VALUE '*'.
  1479     12  AL-UNDON            PIC X       VALUE ')'.
  1480     12  AL-UNNOF            PIC X       VALUE '&'.
  1481     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL146.cbl
  1483*                                COPY ELCAID.
  1484******************************************************************
  1485*                                                                *
  1486*                            ELCAID.                             *
  1487*                            VMOD=2.001                          *
  1488*                                                                *
  1489*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1490*                                                                *
  1491*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1492*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1493******************************************************************
  1494
  1495 01  DFHAID.
  1496   02  DFHNULL   PIC  X  VALUE  ' '.
  1497   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1498   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1499   02  DFHPEN    PIC  X  VALUE  '='.
  1500   02  DFHOPID   PIC  X  VALUE  'W'.
  1501   02  DFHPA1    PIC  X  VALUE  '%'.
  1502   02  DFHPA2    PIC  X  VALUE  '>'.
  1503   02  DFHPA3    PIC  X  VALUE  ','.
  1504   02  DFHPF1    PIC  X  VALUE  '1'.
  1505   02  DFHPF2    PIC  X  VALUE  '2'.
  1506   02  DFHPF3    PIC  X  VALUE  '3'.
  1507   02  DFHPF4    PIC  X  VALUE  '4'.
  1508   02  DFHPF5    PIC  X  VALUE  '5'.
  1509   02  DFHPF6    PIC  X  VALUE  '6'.
  1510   02  DFHPF7    PIC  X  VALUE  '7'.
  1511   02  DFHPF8    PIC  X  VALUE  '8'.
  1512   02  DFHPF9    PIC  X  VALUE  '9'.
  1513   02  DFHPF10   PIC  X  VALUE  ':'.
  1514   02  DFHPF11   PIC  X  VALUE  '#'.
  1515   02  DFHPF12   PIC  X  VALUE  '@'.
  1516   02  DFHPF13   PIC  X  VALUE  'A'.
  1517   02  DFHPF14   PIC  X  VALUE  'B'.
  1518   02  DFHPF15   PIC  X  VALUE  'C'.
  1519   02  DFHPF16   PIC  X  VALUE  'D'.
  1520   02  DFHPF17   PIC  X  VALUE  'E'.
  1521   02  DFHPF18   PIC  X  VALUE  'F'.
  1522   02  DFHPF19   PIC  X  VALUE  'G'.
  1523   02  DFHPF20   PIC  X  VALUE  'H'.
  1524   02  DFHPF21   PIC  X  VALUE  'I'.
  1525*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1526   02  DFHPF22   PIC  X  VALUE  '['.
  1527   02  DFHPF23   PIC  X  VALUE  '.'.
  1528   02  DFHPF24   PIC  X  VALUE  '<'.
  1529   02  DFHMSRE   PIC  X  VALUE  'X'.
  1530   02  DFHSTRF   PIC  X  VALUE  'h'.
  1531   02  DFHTRIG   PIC  X  VALUE  '"'.
  1532 01  FILLER                      REDEFINES
  1533     DFHAID.
  1534
  1535     12  FILLER                  PIC X(08).
  1536
  1537     12  PF-VALUES               PIC X(01)
  1538         OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL146.cbl
  1540****************************************************************
  1541*
  1542* Copyright (c) 2007 by Clerity Solutions, Inc.
  1543* All rights reserved.
  1544*
  1545****************************************************************
  1546 01  DFHEIV.
  1547   02  DFHEIV0               PIC X(35).
  1548   02  DFHEIV1               PIC X(08).
  1549   02  DFHEIV2               PIC X(08).
  1550   02  DFHEIV3               PIC X(08).
  1551   02  DFHEIV4               PIC X(06).
  1552   02  DFHEIV5               PIC X(04).
  1553   02  DFHEIV6               PIC X(04).
  1554   02  DFHEIV7               PIC X(02).
  1555   02  DFHEIV8               PIC X(02).
  1556   02  DFHEIV9               PIC X(01).
  1557   02  DFHEIV10              PIC S9(7) COMP-3.
  1558   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1559   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1560   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1561   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1562   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1563   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1564   02  DFHEIV17              PIC X(04).
  1565   02  DFHEIV18              PIC X(04).
  1566   02  DFHEIV19              PIC X(04).
  1567   02  DFHEIV20              USAGE IS POINTER.
  1568   02  DFHEIV21              USAGE IS POINTER.
  1569   02  DFHEIV22              USAGE IS POINTER.
  1570   02  DFHEIV23              USAGE IS POINTER.
  1571   02  DFHEIV24              USAGE IS POINTER.
  1572   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1573   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1574   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1575   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1576   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1577   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1578   02  FILLER                PIC X(02).
  1579   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1580   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1581   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1582   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1583   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1584 LINKAGE  SECTION.
  1585*****************************************************************
  1586*                                                               *
  1587* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1588* All rights reserved.                                          *
  1589*                                                               *
  1590*****************************************************************
  1591 01  dfheiblk.
  1592     02  eibtime          pic s9(7) comp-3.
  1593     02  eibdate          pic s9(7) comp-3.
  1594     02  eibtrnid         pic x(4).
  1595     02  eibtaskn         pic s9(7) comp-3.
  1596     02  eibtrmid         pic x(4).
  1597     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL146.cbl
  1598     02  eibcposn         pic s9(4) comp.
  1599     02  eibcalen         pic s9(4) comp.
  1600     02  eibaid           pic x(1).
  1601     02  eibfiller1       pic x(1).
  1602     02  eibfn            pic x(2).
  1603     02  eibfiller2       pic x(2).
  1604     02  eibrcode         pic x(6).
  1605     02  eibfiller3       pic x(2).
  1606     02  eibds            pic x(8).
  1607     02  eibreqid         pic x(8).
  1608     02  eibrsrce         pic x(8).
  1609     02  eibsync          pic x(1).
  1610     02  eibfree          pic x(1).
  1611     02  eibrecv          pic x(1).
  1612     02  eibsend          pic x(1).
  1613     02  eibatt           pic x(1).
  1614     02  eibeoc           pic x(1).
  1615     02  eibfmh           pic x(1).
  1616     02  eibcompl         pic x(1).
  1617     02  eibsig           pic x(1).
  1618     02  eibconf          pic x(1).
  1619     02  eiberr           pic x(1).
  1620     02  eibrldbk         pic x(1).
  1621     02  eiberrcd         pic x(4).
  1622     02  eibsynrb         pic x(1).
  1623     02  eibnodat         pic x(1).
  1624     02  eibfiller5       pic x(2).
  1625     02  eibresp          pic 9(09) comp.
  1626     02  eibresp2         pic 9(09) comp.
  1627     02  dfheigdj         pic s9(4) comp.
  1628     02  dfheigdk         pic s9(4) comp.
  1629
  1630 01  DFHCOMMAREA                 PIC X(1024).
  1631
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL146.cbl
  1633*                                COPY ELCRCON.
  1634******************************************************************
  1635*                                                                *
  1636*
  1637*   THIS COPYBOOK IS NOT BEING USED IN LOGIC
  1638*
  1639*
  1640*                                                                *
  1641*                            ELCRCON.                            *
  1642*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1643*                            VMOD=2.003                          *
  1644*                                                                *
  1645*   FILE DESCRIPTION = CHECK RECONCILIATION FILE                 *
  1646*                                                                *
  1647*   FILE TYPE = VSAM,KSDS                                        *
  1648*   RECORD SIZE = 194  RECFORM = FIXED                           *
  1649*                                                                *
  1650*   BASE CLUSTER = ELRCON                         RKP=2,LEN=19   *
  1651*                                                                *
  1652*   LOG = YES                                                    *
  1653*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1654******************************************************************
  1655
  1656 01  CHECK-RECONCILIATION.
  1657     12  RC-RECORD-ID                          PIC XX.
  1658         88  VALID-RC-ID                    VALUE 'RC'.
  1659     12  RC-CONTROL-PRIMARY.
  1660         16  RC-COMPANY-CD                     PIC X.
  1661         16  RC-CHECK-NO                       PIC X(7).
  1662         16  RC-CHECK-ORIGIN                   PIC X.
  1663         16  RC-GL-ACCOUNT-NO                  PIC X(10).
  1664
  1665     12  RC-CHECK-DATA.
  1666         16  RC-ISSUE-DATE.
  1667             20  RC-ISSUE-YYYY.
  1668               22  RC-ISSUE-CC                 PIC XX.
  1669               22  RC-ISSUE-YY                 PIC XX.
  1670             20  RC-ISSUE-MM                   PIC XX.
  1671             20  RC-ISSUE-DD                   PIC XX.
  1672         16  RC-CHECK-AMOUNT                   PIC 9(7)V99.
  1673         16  RC-CARRIER                        PIC X.
  1674         16  RC-CLAIM-NO                       PIC X(7).
  1675         16  RC-REFERENCE-NO                   PIC X(20).
  1676         16  RC-MORTGAGE-REF   REDEFINES  RC-REFERENCE-NO.
  1677             20  RC-MORT-REF-1-18              PIC X(18).
  1678             20  RC-MORT-REF-SUF-19-20         PIC XX.
  1679         16  FILLER  REDEFINES  RC-MORTGAGE-REF.
  1680             20  FILLER                        PIC X(13).
  1681             20  RC-CLAIM-REF.
  1682               22  RC-CLAIM-PREFIX             PIC X.
  1683               22  RC-CLAIM-NO-REF             PIC X(6).
  1684         16  RC-COVERAGE-TYPE                  PIC X.
  1685         16  RC-BENEFIT-CODE                   PIC XX.
  1686         16  RC-BENEFICIARY                    PIC X(10).
  1687         16  RC-PAYMENT-TYPE                   PIC X.
  1688         16  RC-STATUS                         PIC X.
  1689           88  RC-STATUS-ABANDONED                VALUE 'A'.
  1690           88  RC-STATUS-DESTROYED                VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL146.cbl
  1691           88  RC-STATUS-OUTSTANDING              VALUE 'O'.
  1692           88  RC-STATUS-REDEEMED                 VALUE 'R'.
  1693           88  RC-STATUS-STOP-PAY                 VALUE 'S'.
  1694           88  RC-STATUS-UNREDEEMED               VALUE 'U'.
  1695           88  RC-STATUS-VOIDED                   VALUE 'V'.
  1696         16  RC-STATUS-DATE.
  1697             20  RC-STATUS-YYYY.
  1698               22  RC-STATUS-CC                PIC XX.
  1699               22  RC-STATUS-YY                PIC XX.
  1700             20  RC-STATUS-MM                  PIC XX.
  1701             20  RC-STATUS-DD                  PIC XX.
  1702
  1703     12  RC-MAINT-AREA.
  1704         16  RC-LAST-MAINT-BY                  PIC X(4).
  1705         16  RC-LAST-MAINT-DT                  PIC XX.
  1706         16  RC-LAST-MAINT-HHMMSS    COMP-3    PIC S9(7).
  1707
  1708     12  RC-CHECK-MAINT-AREA.
  1709         16  RC-LAST-CHECK-BY                  PIC X(4).
  1710         16  RC-LAST-CHECK-DT                  PIC XX.
  1711         16  RC-LAST-CHECK-HHMMSS    COMP-3    PIC S9(7).
  1712     12  RC-CASHED-AMOUNT                      PIC 9(7)V99.
  1713
  1714     12  RC-CHECK-NOTE                         PIC X(67).
  1715     12  FILLER                                PIC X(11).
  1716
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL146.cbl
  1718 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  1719                          CHECK-RECONCILIATION.
  1720 0000-DFHEXIT SECTION.
  1721     MOVE '9#                    $   ' TO DFHEIV0.
  1722     MOVE 'EL146' TO DFHEIV1.
  1723     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1724
  1725     MOVE EIBDATE                TO  DC-JULIAN-YYDDD
  1726     MOVE '5'                    TO  DC-OPTION-CODE
  1727     PERFORM 8500-DATE-CONVERSION.
  1728     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE
  1729     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE
  1730
  1731     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK
  1732
  1733     MOVE +2                     TO  EMI-NUMBER-OF-LINES
  1734     MOVE '2'                    TO  EMI-SWITCH2
  1735
  1736     IF EIBCALEN IS EQUAL TO 0
  1737         GO TO 8800-UNAUTHORIZED-ACCESS
  1738     END-IF
  1739*    NOTE *******************************************************
  1740*         *      ACCESS TO THIS MODULE CAN BE ONLY FROM AN XCTL *
  1741*         *  FROM ANOTHER MODULE.                               *
  1742*         *******************************************************.
  1743
  1744
  1745* EXEC CICS HANDLE CONDITION
  1746*        ERROR    (9990-ERROR)
  1747*        NOTOPEN  (8870-NOTOPEN)
  1748*        PGMIDERR (9600-PGMIDERR)
  1749*    END-EXEC
  1750*    MOVE '"$.JL                 ! " #00001740' TO DFHEIV0
  1751     MOVE X'22242E4A4C20202020202020' TO DFHEIV0(1:12)
  1752     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1753     MOVE X'2220233030303031373430' TO DFHEIV0(25:11)
  1754     CALL 'kxdfhei1' USING DFHEIV0
  1755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1756     .
  1757
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL146.cbl
  1759 0010-MAIN-LOGIC.
  1760
  1761     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1762         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1763             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  1764             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  1765             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  1766             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  1767             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  1768             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  1769             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  1770             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  1771         ELSE
  1772             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  1773             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  1774             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  1775             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  1776             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  1777             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  1778             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  1779             MOVE SPACES               TO  PI-SAVED-PROGRAM-6
  1780         END-IF
  1781     ELSE
  1782         GO TO 0020-MAIN-LOGIC
  1783     END-IF
  1784     .
  1785
  1786 0015-MAIN-LOGIC.
  1787*    NOTE *******************************************************
  1788*         *      INITALIZE THE WORK FIELDS FOR THE PROGRAM      *
  1789*         *  INTERFACE BLOCK FOR THIS MODULE.                   *
  1790*         *******************************************************.
  1791
  1792     MOVE SPACES                 TO  PI-PROGRAM-WORK-AREA
  1793
  1794     IF EIBTRNID NOT EQUAL WS-TRANS-ID
  1795         MOVE LOW-VALUES         TO  EL146AI
  1796         MOVE LOW-VALUES         TO  PI-PREV-KEY
  1797         MOVE LOW-VALUES         TO  ELRCON-KEY
  1798                                     PI-SAVE-KEY
  1799*                                    PI-STOP-PAY-KEY
  1800*        MOVE 'N'                TO  PI-STOP-PAY-SW
  1801                                     WS-RECORDS-READ-SW
  1802         MOVE 'Y'                TO  PI-FIRST-TIME-SW
  1803         MOVE PI-COMPANY-CD      TO  PI-PREV-COMPANY-CD
  1804         GO TO 8100-SEND-INITIAL-MAP
  1805     END-IF
  1806     .
  1807
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL146.cbl
  1809 0020-MAIN-LOGIC.
  1810*    NOTE *******************************************************
  1811*         *      AFTER THE FIRST TIME THROUGH THE PROPER ATTEN- *
  1812*         *  TION KEY USAGE NEEDS TO BE CHECKED FOR VALIDITY    *
  1813*         *  BEFORE ANY FURTHER PROCESSING CAN BE DONE.         *
  1814*         *******************************************************.
  1815
  1816     IF EIBAID EQUAL DFHCLEAR
  1817         GO TO 9400-CLEAR
  1818     END-IF
  1819
  1820
  1821* EXEC CICS READQ TS
  1822*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  1823*            INTO    (SECURITY-CONTROL)
  1824*            LENGTH  (SC-COMM-LENGTH)
  1825*            ITEM    (SC-ITEM)
  1826*    END-EXEC
  1827*    MOVE '*$II   L              ''   #00001809' TO DFHEIV0
  1828     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1829     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1830     MOVE X'2020233030303031383039' TO DFHEIV0(25:11)
  1831     CALL 'kxdfhei1' USING DFHEIV0,
  1832           PI-SECURITY-TEMP-STORE-ID,
  1833           SECURITY-CONTROL,
  1834           SC-COMM-LENGTH,
  1835           SC-ITEM,
  1836           DFHEIV99,
  1837           DFHEIV99
  1838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1839     MOVE SC-CLAIMS-DISPLAY (23)  TO  PI-DISPLAY-CAP
  1840     MOVE SC-CLAIMS-UPDATE  (23)  TO  PI-MODIFY-CAP
  1841     IF NOT DISPLAY-CAP
  1842         MOVE 'READ'              TO  SM-READ
  1843         PERFORM 9995-SECURITY-VIOLATION
  1844         MOVE ER-0070             TO  EMI-ERROR
  1845         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1846         GO TO 8100-SEND-INITIAL-MAP
  1847     END-IF
  1848     .
  1849
  1850 0200-RECEIVE.
  1851
  1852     IF EIBAID EQUAL DFHPA1 OR DFHPA2 OR DFHPA3
  1853         MOVE LOW-VALUES         TO  EL146AI
  1854         MOVE ER-0008            TO  EMI-ERROR
  1855         PERFORM 8200-SEND-DATAONLY
  1856     END-IF
  1857
  1858
  1859* EXEC CICS RECEIVE
  1860*        INTO   (EL146AI)
  1861*        MAPSET (WS-MAPSET-NAME)
  1862*        MAP    (WS-MAP-NAME)
  1863*    END-EXEC
  1864     MOVE LENGTH OF
  1865      EL146AI
  1866       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL146.cbl
  1867*    MOVE '8"T I  L              ''   #00001834' TO DFHEIV0
  1868     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1869     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1870     MOVE X'2020233030303031383334' TO DFHEIV0(25:11)
  1871     CALL 'kxdfhei1' USING DFHEIV0,
  1872           WS-MAP-NAME,
  1873           EL146AI,
  1874           DFHEIV11,
  1875           WS-MAPSET-NAME,
  1876           DFHEIV99,
  1877           DFHEIV99
  1878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1879
  1880     IF ENTERPFL IS EQUAL TO +0
  1881         GO TO 0300-CHECK-PFKEYS
  1882     END-IF
  1883
  1884     IF EIBAID NOT = DFHENTER
  1885         MOVE ER-0004            TO  EMI-ERROR
  1886         GO TO 0320-INPUT-ERROR
  1887     END-IF
  1888
  1889     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  1890         MOVE PF-VALUES (ENTERPFI)   TO  EIBAID
  1891     ELSE
  1892         MOVE ER-0029                TO  EMI-ERROR
  1893         GO TO 0320-INPUT-ERROR
  1894     END-IF
  1895     .
  1896
  1897 0300-CHECK-PFKEYS.
  1898
  1899*    IF (EIBAID = DFHPF1)  OR
  1900*       (EIBAID = DFHPF2)  OR
  1901*       (EIBAID = DFHPF12) OR
  1902*       (EIBAID = DFHPF23) OR
  1903*       (EIBAID = DFHPF24)
  1904*        MOVE 'N' TO PI-STOP-PAY-SW
  1905*    END-IF
  1906
  1907     IF EIBAID EQUAL DFHPF12
  1908         MOVE XCTL-010                TO  THIS-PGM
  1909         GO TO 9300-XCTL
  1910     END-IF
  1911
  1912     IF EIBAID EQUAL DFHPF23
  1913         GO TO 9000-RETURN-CICS
  1914     END-IF
  1915
  1916     IF EIBAID EQUAL DFHPF24
  1917         MOVE XCTL-126                TO  THIS-PGM
  1918         GO TO 9300-XCTL
  1919     END-IF
  1920
  1921     IF EIBAID EQUAL DFHPF1
  1922         MOVE  +0                     TO  SUB
  1923         GO TO 4000-START-BROWSE-FORWARD
  1924     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL146.cbl
  1925
  1926     IF EIBAID EQUAL DFHPF2
  1927         MOVE  +9                     TO  SUB
  1928         GO TO 5000-START-BROWSE-BACKWARD
  1929     END-IF
  1930
  1931     IF EIBAID = DFHPF3
  1932         IF CHKNOL > +0
  1933             MOVE  +0                 TO  SUB
  1934             GO TO 4000-START-BROWSE-FORWARD
  1935         ELSE
  1936             MOVE AL-UABON            TO  MAINTA
  1937             MOVE  -1                 TO  MAINTL
  1938             MOVE  ER-0773            TO  EMI-ERROR
  1939             PERFORM 9900-ERROR-FORMAT THRU  9900-EXIT
  1940             GO TO 8200-SEND-DATAONLY
  1941         END-IF
  1942     END-IF
  1943
  1944     IF EIBAID EQUAL DFHENTER
  1945         IF MAINTL IS EQUAL TO +0
  1946             MOVE +0                  TO  SUB
  1947             GO TO 4000-START-BROWSE-FORWARD
  1948         ELSE
  1949             GO TO 0330-EDIT-DATA
  1950         END-IF
  1951     END-IF
  1952     MOVE ER-0029                TO  EMI-ERROR
  1953     .
  1954
  1955 0320-INPUT-ERROR.
  1956
  1957     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1958     MOVE AL-UNBON               TO  ENTERPFA
  1959
  1960     IF ENTERPFL IS EQUAL TO +0
  1961         MOVE -1                 TO  MAINTL
  1962     ELSE
  1963         MOVE -1                 TO  ENTERPFL
  1964     END-IF
  1965
  1966     GO TO 8200-SEND-DATAONLY
  1967     .
  1968
  1969 0330-EDIT-DATA.
  1970
  1971     IF NOT  MODIFY-CAP
  1972         MOVE 'UPDATE'         TO  SM-READ
  1973         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1974         MOVE ER-0070          TO EMI-ERROR
  1975         PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
  1976         MOVE LOW-VALUES       TO EL146AO
  1977         GO TO 8100-SEND-INITIAL-MAP
  1978     END-IF
  1979
  1980     IF (MAINTI IS EQUAL TO  'R' OR 'O' OR 'A' OR 'M')
  1981         CONTINUE
  1982     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL146.cbl
  1983         MOVE AL-UABON           TO  MAINTA
  1984         MOVE  -1                TO  MAINTL
  1985         MOVE  ER-0773           TO  EMI-ERROR
  1986         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  1987         GO TO 8200-SEND-DATAONLY
  1988     END-IF
  1989
  1990     IF (CHKNOL > +0)
  1991        AND (BANKNOL > +0)
  1992         CONTINUE
  1993     ELSE
  1994         MOVE ER-0774           TO  EMI-ERROR
  1995         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  1996         MOVE -1                TO  CHKNOL
  1997         MOVE AL-UABON          TO  CHKNOA
  1998         GO TO 8200-SEND-DATAONLY
  1999     END-IF
  2000
  2001     IF CSHAMTL > +0
  2002         MOVE CSHAMTI               TO DEEDIT-FIELD
  2003         PERFORM 8000-DEEDIT        THRU 8000-EXIT
  2004         IF DEEDIT-FIELD-CHK NUMERIC
  2005             MOVE DEEDIT-FIELD-CHK  TO CSHAMTO
  2006         ELSE
  2007             MOVE AL-UNBON          TO CSHAMTA
  2008             MOVE -1                TO CSHAMTL
  2009             MOVE ER-0775           TO EMI-ERROR
  2010             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2011         END-IF
  2012     END-IF
  2013
  2014      IF NOT EMI-NO-ERRORS
  2015          GO TO 8200-SEND-DATAONLY
  2016      ELSE
  2017          GO TO 6000-REWRITE-CHECK-RECON
  2018      END-IF
  2019      .
  2020
  2021 4000-START-BROWSE-FORWARD.
  2022
  2023     MOVE  PI-COMPANY-CD         TO RECON-COMPANY-CD
  2024
  2025     IF CHKNOL > +0
  2026         MOVE CHKNOI             TO RECON-CHECK-NO
  2027******** Origin is always 'C' indicating the check is from the
  2028******** claims system
  2029         MOVE 'C'                TO RECON-ORIGIN
  2030         IF EIBAID = DFHPF3
  2031             MOVE SPACES         TO RECON-BANK-NO
  2032         ELSE
  2033             IF BANKNOL > +0
  2034                 MOVE BANKNOI    TO RECON-BANK-NO
  2035             ELSE
  2036                 MOVE SPACES     TO RECON-BANK-NO
  2037             END-IF
  2038         END-IF
  2039     ELSE
  2040         IF PI-FIRST-TIME-SW IS EQUAL TO 'Y'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL146.cbl
  2041             MOVE 'N'                        TO PI-FIRST-TIME-SW
  2042         ELSE
  2043             IF PI-SAVE-CHECK-NO (8) = LOW-VALUES
  2044                 MOVE -1                     TO MAINTL
  2045                 MOVE ER-0130                TO EMI-ERROR
  2046                 PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  2047                 GO TO 8200-SEND-DATAONLY
  2048             ELSE
  2049                 MOVE PI-SAVE-COMPANY-CD (8) TO RECON-COMPANY-CD
  2050                 MOVE PI-SAVE-CHECK-NO (8)   TO RECON-CHECK-NO
  2051                 MOVE PI-SAVE-ORIGIN (8)     TO RECON-ORIGIN
  2052                 MOVE PI-SAVE-BANK-NO (8)    TO RECON-BANK-NO
  2053                 MOVE LOW-VALUES             TO PI-SAVE-KEY
  2054             END-IF
  2055         END-IF
  2056     END-IF
  2057
  2058     .
  2059
  2060 4000-START-BROWSE.
  2061
  2062
  2063* EXEC CICS HANDLE CONDITION
  2064*        ENDFILE   (8700-END-FILE)
  2065*        NOTFND    (8300-NOT-FOUND)
  2066*    END-EXEC
  2067*    MOVE '"$''I                  ! # #00002022' TO DFHEIV0
  2068     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  2069     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2070     MOVE X'2320233030303032303232' TO DFHEIV0(25:11)
  2071     CALL 'kxdfhei1' USING DFHEIV0
  2072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2073
  2074* EXEC CICS STARTBR
  2075*        DATASET   ('ELRCON')
  2076*        RIDFLD    (ELRCON-KEY)
  2077*    END-EXEC
  2078     MOVE 'ELRCON' TO DFHEIV1
  2079     MOVE 0
  2080       TO DFHEIV11
  2081*    MOVE '&,         G          &   #00002026' TO DFHEIV0
  2082     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2083     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2084     MOVE X'2020233030303032303236' TO DFHEIV0(25:11)
  2085     CALL 'kxdfhei1' USING DFHEIV0,
  2086           DFHEIV1,
  2087           ELRCON-KEY,
  2088           DFHEIV99,
  2089           DFHEIV11,
  2090           DFHEIV99
  2091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2092     .
  2093
  2094 4000-READ-NEXT.
  2095
  2096
  2097* EXEC CICS READNEXT
  2098*        DATASET   ('ELRCON')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL146.cbl
  2099*        SET       (ADDRESS OF CHECK-RECONCILIATION)
  2100*        RIDFLD    (ELRCON-KEY)
  2101*    END-EXEC
  2102     MOVE 'ELRCON' TO DFHEIV1
  2103     MOVE 0
  2104       TO DFHEIV11
  2105*    MOVE '&.S                   )   #00002034' TO DFHEIV0
  2106     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2107     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2108     MOVE X'2020233030303032303334' TO DFHEIV0(25:11)
  2109     CALL 'kxdfhei1' USING DFHEIV0,
  2110           DFHEIV1,
  2111           DFHEIV20,
  2112           DFHEIV99,
  2113           ELRCON-KEY,
  2114           DFHEIV99,
  2115           DFHEIV11,
  2116           DFHEIV99,
  2117           DFHEIV99
  2118     SET ADDRESS OF CHECK-RECONCILIATION TO
  2119         DFHEIV20
  2120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2121
  2122     IF PI-COMPANY-CD NOT = RC-COMPANY-CD
  2123         GO TO 8700-END-FILE
  2124     END-IF
  2125
  2126*    IF RC-CONTROL-PRIMARY = PI-PREV-KEY
  2127*        GO TO 4000-READ-NEXT
  2128*    END-IF
  2129
  2130     MOVE 'N'                      TO  PI-FIRST-TIME-SW
  2131     MOVE 'Y'                      TO  WS-RECORDS-READ-SW
  2132
  2133     ADD +1                        TO  SUB
  2134     IF EIBAID = DFHPF3 AND SUB = +1
  2135        AND RC-CHECK-NO = CHKNOI
  2136         MOVE RC-CHECK-NO          TO  EL146A-TARGET-CHK-NO
  2137         MOVE RC-GL-ACCOUNT-NO     TO  EL146A-BANK-NO
  2138         MOVE RC-CASHED-AMOUNT     TO  EL146A-TARGET-CSH-AMT
  2139         MOVE RC-CHECK-NOTE        TO  EL146A-CHK-NOTE
  2140     END-IF
  2141     IF SUB > +8
  2142        AND EIBAID NOT = DFHPF3
  2143         MOVE +0                 TO  SUB
  2144         MOVE ELRCON-KEY         TO  PI-PREV-KEY
  2145         MOVE LOW-VALUES         TO  CHKNOO
  2146         MOVE ZEROS              TO  CSHAMTO
  2147         MOVE LOW-VALUES         TO  BANKNOO
  2148         MOVE LOW-VALUES         TO  NOTEO
  2149         MOVE LOW-VALUES         TO  MAINTO
  2150         GO TO 8100-SEND-INITIAL-MAP
  2151     ELSE
  2152         IF SUB > +8
  2153            AND EIBAID = DFHPF3
  2154            GO TO 8100-SEND-INITIAL-MAP
  2155         END-IF
  2156     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL146.cbl
  2157
  2158     MOVE ELRCON-KEY             TO  PI-PREV-KEY
  2159
  2160     MOVE RC-COMPANY-CD          TO  PI-SAVE-COMPANY-CD (SUB)
  2161     MOVE RC-CHECK-ORIGIN        TO  PI-SAVE-ORIGIN (SUB)
  2162     MOVE RC-GL-ACCOUNT-NO       TO  PI-SAVE-BANK-NO (SUB)
  2163     MOVE RC-CHECK-NO            TO  EL146A-CHK-NO (SUB)
  2164                                     PI-SAVE-CHECK-NO (SUB)
  2165     MOVE RC-ISSUE-YYYY          TO  WS-DATE-YY
  2166     MOVE WS-DATE-YY             TO  WS-EDIT-YY
  2167     MOVE RC-ISSUE-MM            TO  WS-EDIT-MM
  2168     MOVE RC-ISSUE-DD            TO  WS-EDIT-DD
  2169     MOVE WS-EDIT-DATE           TO  EL146A-CHK-DATE (SUB)
  2170
  2171     MOVE RC-STATUS              TO  EL146A-CHK-STAT (SUB)
  2172
  2173     MOVE RC-STATUS-YYYY         TO  WS-DATE-YY
  2174     MOVE WS-DATE-YY             TO  WS-EDIT-YY
  2175     MOVE RC-STATUS-MM           TO  WS-EDIT-MM
  2176     MOVE RC-STATUS-DD           TO  WS-EDIT-DD
  2177     MOVE WS-EDIT-DATE           TO  EL146A-CHK-STDT (SUB)
  2178
  2179     MOVE RC-CHECK-AMOUNT        TO  EL146A-CHK-AMT (SUB)
  2180     MOVE RC-CASHED-AMOUNT       TO  EL146A-CHK-CSH-AMT (SUB)
  2181     MOVE RC-CLAIM-NO            TO  EL146A-CHK-CLM-NO (SUB)
  2182     GO TO 4000-READ-NEXT
  2183     .
  2184
  2185 4000-EXIT.
  2186     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL146.cbl
  2188 5000-START-BROWSE-BACKWARD.
  2189
  2190
  2191* EXEC CICS HANDLE CONDITION
  2192*        ENDFILE   (8710-END-FILE)
  2193*        NOTFND    (8300-NOT-FOUND)
  2194*    END-EXEC
  2195*    MOVE '"$''I                  ! $ #00002108' TO DFHEIV0
  2196     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  2197     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2198     MOVE X'2420233030303032313038' TO DFHEIV0(25:11)
  2199     CALL 'kxdfhei1' USING DFHEIV0
  2200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2201
  2202     MOVE  PI-COMPANY-CD                   TO RECON-COMPANY-CD
  2203
  2204     IF CHKNOL > +0
  2205         MOVE CHKNOI                       TO RECON-CHECK-NO
  2206         IF BANKNOL > +0
  2207             MOVE BANKNOI                  TO RECON-BANK-NO
  2208         ELSE
  2209             MOVE SPACES                   TO RECON-BANK-NO
  2210         END-IF
  2211     ELSE
  2212         IF PI-SAVE-CHECK-NO (1) = LOW-VALUES
  2213             IF PI-PREV-KEY = LOW-VALUES
  2214                 MOVE -1                   TO MAINTL
  2215                 MOVE ER-0131              TO EMI-ERROR
  2216                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2217                 GO TO 8200-SEND-DATAONLY
  2218             ELSE
  2219                 MOVE PI-PREV-KEY          TO ELRCON-KEY
  2220             END-IF
  2221         ELSE
  2222             MOVE PI-SAVE-COMPANY-CD (1)   TO RECON-COMPANY-CD
  2223             MOVE PI-SAVE-CHECK-NO (1)     TO RECON-CHECK-NO
  2224             MOVE PI-SAVE-ORIGIN (1)       TO RECON-ORIGIN
  2225             MOVE PI-SAVE-BANK-NO (1)      TO RECON-BANK-NO
  2226             MOVE LOW-VALUES               TO PI-SAVE-KEY
  2227         END-IF
  2228     END-IF
  2229
  2230
  2231* EXEC CICS STARTBR
  2232*        DATASET   ('ELRCON')
  2233*        RIDFLD    (ELRCON-KEY)
  2234*    END-EXEC
  2235     MOVE 'ELRCON' TO DFHEIV1
  2236     MOVE 0
  2237       TO DFHEIV11
  2238*    MOVE '&,         G          &   #00002141' TO DFHEIV0
  2239     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2240     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2241     MOVE X'2020233030303032313431' TO DFHEIV0(25:11)
  2242     CALL 'kxdfhei1' USING DFHEIV0,
  2243           DFHEIV1,
  2244           ELRCON-KEY,
  2245           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL146.cbl
  2246           DFHEIV11,
  2247           DFHEIV99
  2248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2249     .
  2250
  2251 5000-READ-PREV.
  2252
  2253
  2254* EXEC CICS READPREV
  2255*        DATASET   ('ELRCON')
  2256*        SET       (ADDRESS OF CHECK-RECONCILIATION)
  2257*        RIDFLD    (ELRCON-KEY)
  2258*    END-EXEC
  2259     MOVE 'ELRCON' TO DFHEIV1
  2260     MOVE 0
  2261       TO DFHEIV11
  2262*    MOVE '&0S                   )   #00002149' TO DFHEIV0
  2263     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  2264     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2265     MOVE X'2020233030303032313439' TO DFHEIV0(25:11)
  2266     CALL 'kxdfhei1' USING DFHEIV0,
  2267           DFHEIV1,
  2268           DFHEIV20,
  2269           DFHEIV99,
  2270           ELRCON-KEY,
  2271           DFHEIV99,
  2272           DFHEIV11,
  2273           DFHEIV99,
  2274           DFHEIV99
  2275     SET ADDRESS OF CHECK-RECONCILIATION TO
  2276         DFHEIV20
  2277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2278
  2279     IF PI-COMPANY-CD NOT = RC-COMPANY-CD
  2280         GO TO 8710-END-FILE
  2281     END-IF
  2282
  2283     IF RC-CONTROL-PRIMARY  EQUAL  PI-PREV-KEY
  2284         GO TO 5000-READ-PREV
  2285     END-IF
  2286
  2287     MOVE 'Y'                    TO  WS-RECORDS-READ-SW
  2288
  2289     SUBTRACT +1                 FROM  SUB
  2290     IF SUB IS LESS THAN  +1
  2291         MOVE +0                 TO  SUB
  2292         MOVE LOW-VALUES         TO  CHKNOO
  2293         MOVE LOW-VALUES         TO  BANKNOO
  2294*        MOVE ZEROS              TO  CHKAMTO
  2295         MOVE ELRCON-KEY         TO  PI-PREV-KEY
  2296         GO TO 8100-SEND-INITIAL-MAP
  2297     END-IF
  2298
  2299     MOVE ELRCON-KEY             TO  PI-PREV-KEY
  2300     MOVE RC-COMPANY-CD          TO  PI-SAVE-COMPANY-CD (SUB)
  2301     MOVE RC-CHECK-ORIGIN        TO  PI-SAVE-ORIGIN (SUB)
  2302     MOVE RC-GL-ACCOUNT-NO       TO  PI-SAVE-BANK-NO (SUB)
  2303
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL146.cbl
  2304     MOVE RC-CHECK-NO            TO  EL146A-CHK-NO (SUB)
  2305                                     PI-SAVE-CHECK-NO (SUB)
  2306
  2307     MOVE RC-ISSUE-YYYY          TO  WS-DATE-YY
  2308     MOVE WS-DATE-YY             TO  WS-EDIT-YY
  2309     MOVE RC-ISSUE-MM            TO  WS-EDIT-MM
  2310     MOVE RC-ISSUE-DD            TO  WS-EDIT-DD
  2311     MOVE WS-EDIT-DATE           TO  EL146A-CHK-DATE (SUB)
  2312
  2313     MOVE RC-STATUS              TO  EL146A-CHK-STAT (SUB)
  2314
  2315     MOVE RC-STATUS-YYYY         TO  WS-DATE-YY
  2316     MOVE WS-DATE-YY             TO  WS-EDIT-YY
  2317     MOVE RC-STATUS-MM           TO  WS-EDIT-MM
  2318     MOVE RC-STATUS-DD           TO  WS-EDIT-DD
  2319     MOVE WS-EDIT-DATE           TO  EL146A-CHK-STDT (SUB)
  2320
  2321     MOVE RC-CHECK-AMOUNT        TO  EL146A-CHK-AMT (SUB)
  2322     MOVE RC-CASHED-AMOUNT       TO  EL146A-CHK-CSH-AMT (SUB)
  2323     MOVE RC-CLAIM-NO            TO  EL146A-CHK-CLM-NO (SUB)
  2324     GO TO 5000-READ-PREV
  2325     .
  2326
  2327 5000-EXIT.
  2328     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL146.cbl
  2330 6000-REWRITE-CHECK-RECON.
  2331
  2332
  2333* EXEC CICS HANDLE CONDITION
  2334*        NOTFND    (8300-NOT-FOUND)
  2335*    END-EXEC
  2336*    MOVE '"$I                   ! % #00002208' TO DFHEIV0
  2337     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2338     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2339     MOVE X'2520233030303032323038' TO DFHEIV0(25:11)
  2340     CALL 'kxdfhei1' USING DFHEIV0
  2341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2342
  2343     MOVE  LOW-VALUES           TO  ELRCON-KEY
  2344
  2345     MOVE  PI-COMPANY-CD        TO  RECON-COMPANY-CD
  2346     MOVE  CHKNOI               TO  RECON-CHECK-NO
  2347     MOVE 'C'                   TO  RECON-ORIGIN
  2348     MOVE BANKNOI               TO  RECON-BANK-NO
  2349
  2350
  2351* EXEC CICS READ
  2352*        DATASET     ('ELRCON')
  2353*        SET         (ADDRESS OF CHECK-RECONCILIATION)
  2354*        RIDFLD      (ELRCON-KEY)
  2355*        UPDATE
  2356*    END-EXEC
  2357     MOVE 'ELRCON' TO DFHEIV1
  2358*    MOVE '&"S        EU         (   #00002219' TO DFHEIV0
  2359     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2360     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2361     MOVE X'2020233030303032323139' TO DFHEIV0(25:11)
  2362     CALL 'kxdfhei1' USING DFHEIV0,
  2363           DFHEIV1,
  2364           DFHEIV20,
  2365           DFHEIV99,
  2366           ELRCON-KEY,
  2367           DFHEIV99,
  2368           DFHEIV99,
  2369           DFHEIV99
  2370     SET ADDRESS OF CHECK-RECONCILIATION TO
  2371         DFHEIV20
  2372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2373
  2374     MOVE ELRCON-KEY         TO  PI-PREV-KEY
  2375
  2376     MOVE  SAVE-BIN-DATE     TO  RC-LAST-MAINT-DT
  2377     MOVE  EIBTIME           TO  RC-LAST-MAINT-HHMMSS
  2378     MOVE  PI-PROCESSOR-ID   TO  RC-LAST-MAINT-BY
  2379
  2380     IF (MAINTI = 'O')
  2381        AND (RC-STATUS NOT = 'R' AND 'A')
  2382         MOVE ER-0795                    TO EMI-ERROR
  2383         MOVE -1                         TO MAINTL
  2384         PERFORM 9900-ERROR-FORMAT       THRU 9900-EXIT
  2385         GO TO 8200-SEND-DATAONLY
  2386     END-IF
  2387
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL146.cbl
  2388     IF (MAINTI = 'R')
  2389        AND (RC-STATUS NOT = 'O' AND 'A' AND 'S')
  2390         MOVE ER-0850                    TO EMI-ERROR
  2391         MOVE -1                         TO MAINTL
  2392         PERFORM 9900-ERROR-FORMAT       THRU 9900-EXIT
  2393         GO TO 8200-SEND-DATAONLY
  2394     END-IF
  2395
  2396     IF (MAINTI = 'A')
  2397        AND (RC-STATUS NOT = 'O')
  2398         MOVE ER-0789                    TO EMI-ERROR
  2399         MOVE -1                         TO MAINTL
  2400         PERFORM 9900-ERROR-FORMAT       THRU 9900-EXIT
  2401         GO TO 8200-SEND-DATAONLY
  2402     END-IF
  2403
  2404     IF MAINTI = 'M'
  2405         IF CSHAMTL > +0
  2406            AND RC-STATUS NOT = 'R'
  2407             MOVE ER-0796                TO EMI-ERROR
  2408             MOVE -1                     TO MAINTL
  2409             PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  2410             GO TO 8200-SEND-DATAONLY
  2411         END-IF
  2412     END-IF
  2413
  2414*    IF MAINTI  IS EQUAL TO  'S'
  2415*       IF RC-STATUS  IS EQUAL TO  'S' OR 'V'
  2416*           NEXT SENTENCE
  2417*       ELSE
  2418*           MOVE ER-0796         TO  EMI-ERROR
  2419*           MOVE -1              TO  MAINTL
  2420*           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  2421*           GO TO 8200-SEND-DATAONLY.
  2422
  2423*    IF MAINTI IS EQUAL TO 'S'
  2424*       IF PI-STOP-PAY-KEY NOT EQUAL TO  PI-PREV-KEY
  2425*           MOVE 'N'          TO  PI-STOP-PAY-SW.
  2426
  2427*    IF MAINTI IS EQUAL TO 'S'
  2428*       IF PI-STOP-PAY-SW   IS EQUAL TO 'N'
  2429*           MOVE ER-0831      TO  EMI-ERROR
  2430*           MOVE -1           TO  MAINTL
  2431*           MOVE AL-UABON     TO  MAINTA
  2432*           MOVE SPACES       TO  MAINTO
  2433*           MOVE 'Y'          TO  PI-STOP-PAY-SW
  2434*           MOVE PI-PREV-KEY  TO  PI-STOP-PAY-KEY
  2435*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2436*           GO TO 8200-SEND-DATAONLY.
  2437
  2438     IF MAINTI = 'R'
  2439         MOVE 'R'                        TO RC-STATUS
  2440         MOVE RC-CHECK-AMOUNT            TO RC-CASHED-AMOUNT
  2441     END-IF
  2442
  2443     IF (MAINTI = 'O')
  2444         MOVE  'O'                       TO RC-STATUS
  2445         MOVE ZEROS                      TO RC-CASHED-AMOUNT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL146.cbl
  2446     END-IF
  2447     IF (MAINTI = 'A')
  2448         MOVE  'A'                       TO RC-STATUS
  2449     END-IF
  2450     IF MAINTI = 'M'
  2451        AND CSHAMTL > +0
  2452         MOVE CSHAMTO                    TO RC-CASHED-AMOUNT
  2453     END-IF
  2454
  2455     MOVE EIBDATE                        TO DC-JULIAN-YYDDD
  2456     MOVE '5'                            TO DC-OPTION-CODE
  2457     PERFORM 8500-DATE-CONVERSION
  2458     MOVE DC-GREG-DATE-1-MDY             TO WS-WORK-DATE
  2459     IF WS-WORK-YY IS GREATER THAN 50
  2460         MOVE '19'            TO  WS-RCON-YY-1
  2461         MOVE WS-WORK-YY      TO  WS-RCON-YY-2
  2462         MOVE WS-WORK-MM      TO  WS-RCON-MM
  2463         MOVE WS-WORK-DD      TO  WS-RCON-DD
  2464     ELSE
  2465         MOVE '20'            TO  WS-RCON-YY-1
  2466         MOVE WS-WORK-YY      TO  WS-RCON-YY-2
  2467         MOVE WS-WORK-MM      TO  WS-RCON-MM
  2468         MOVE WS-WORK-DD      TO  WS-RCON-DD
  2469     END-IF
  2470
  2471     IF MAINTI NOT = 'M'
  2472         MOVE WS-RCON-DATE               TO RC-STATUS-DATE
  2473     END-IF
  2474     IF NOTEL > +0
  2475         MOVE NOTEI                      TO RC-CHECK-NOTE
  2476     END-IF
  2477
  2478
  2479* EXEC CICS REWRITE
  2480*        DATASET   (ELRCON-DSID)
  2481*        FROM      (CHECK-RECONCILIATION)
  2482*    END-EXEC
  2483     MOVE LENGTH OF
  2484      CHECK-RECONCILIATION
  2485       TO DFHEIV11
  2486*    MOVE '&& L                  %   #00002330' TO DFHEIV0
  2487     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2488     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2489     MOVE X'2020233030303032333330' TO DFHEIV0(25:11)
  2490     CALL 'kxdfhei1' USING DFHEIV0,
  2491           ELRCON-DSID,
  2492           CHECK-RECONCILIATION,
  2493           DFHEIV11,
  2494           DFHEIV99
  2495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2496     IF EIBAID = DFHPF3
  2497         GO TO 6000-EXIT
  2498     END-IF
  2499
  2500*    MOVE PI-COMPANY-CD                  TO RECON-COMPANY-CD
  2501*    MOVE CHKNOI                         TO RECON-CHECK-NO
  2502*    MOVE 'C'                            TO RECON-ORIGIN
  2503*    MOVE BANKNOI                        TO RECON-BANK-NO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL146.cbl
  2504     MOVE PI-SAVE-COMPANY-CD (1) TO  RECON-COMPANY-CD
  2505     MOVE PI-SAVE-CHECK-NO (1)   TO  RECON-CHECK-NO
  2506     MOVE PI-SAVE-ORIGIN (1)     TO  RECON-ORIGIN
  2507     MOVE PI-SAVE-BANK-NO (1)    TO  RECON-BANK-NO
  2508     MOVE LOW-VALUES             TO  PI-SAVE-KEY
  2509                                     EL146AO
  2510*    MOVE 'N'                    TO  PI-STOP-PAY-SW
  2511     MOVE RC-CHECK-NO            TO  EL146A-TARGET-CHK-NO
  2512     MOVE RC-GL-ACCOUNT-NO       TO  EL146A-BANK-NO
  2513     MOVE RC-CASHED-AMOUNT       TO  EL146A-TARGET-CSH-AMT
  2514     MOVE RC-CHECK-NOTE          TO  EL146A-CHK-NOTE
  2515
  2516     GO TO 4000-START-BROWSE
  2517     .
  2518
  2519 6000-EXIT.
  2520     EXIT.
  2521 8000-DEEDIT.
  2522
  2523* EXEC CICS BIF DEEDIT
  2524*        FIELD    (DEEDIT-FIELD)
  2525*        LENGTH   (12)
  2526*    END-EXEC
  2527     MOVE 12
  2528       TO DFHEIV11
  2529*    MOVE '@"L                   #   #00002360' TO DFHEIV0
  2530     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2531     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2532     MOVE X'2020233030303032333630' TO DFHEIV0(25:11)
  2533     CALL 'kxdfhei1' USING DFHEIV0,
  2534           DEEDIT-FIELD,
  2535           DFHEIV11
  2536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2537     .
  2538
  2539 8000-EXIT.
  2540     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL146.cbl
  2542 8100-SEND-INITIAL-MAP.
  2543
  2544     MOVE -1                     TO  MAINTL
  2545     MOVE EIBTIME                TO  TIME-IN
  2546     MOVE SAVE-DATE              TO  DATEO
  2547     MOVE TIME-OUT               TO  TIMEO
  2548     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O
  2549     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O
  2550
  2551
  2552* EXEC CICS SEND
  2553*        FROM   (EL146AI)
  2554*        MAPSET (WS-MAPSET-NAME)
  2555*        MAP    (WS-MAP-NAME)
  2556*        CURSOR
  2557*        ERASE
  2558*    END-EXEC
  2559     MOVE LENGTH OF
  2560      EL146AI
  2561       TO DFHEIV12
  2562     MOVE -1
  2563       TO DFHEIV11
  2564*    MOVE '8$     CT  E    H L F ,   #00002378' TO DFHEIV0
  2565     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2566     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2567     MOVE X'2020233030303032333738' TO DFHEIV0(25:11)
  2568     CALL 'kxdfhei1' USING DFHEIV0,
  2569           WS-MAP-NAME,
  2570           EL146AI,
  2571           DFHEIV12,
  2572           WS-MAPSET-NAME,
  2573           DFHEIV99,
  2574           DFHEIV99,
  2575           DFHEIV99,
  2576           DFHEIV11,
  2577           DFHEIV99,
  2578           DFHEIV99,
  2579           DFHEIV99
  2580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2581     GO TO 9100-RETURN-TRAN
  2582     .
  2583
  2584 8200-SEND-DATAONLY.
  2585
  2586     MOVE EIBTIME                TO  TIME-IN
  2587     MOVE SAVE-DATE              TO  DATEO
  2588     MOVE TIME-OUT               TO  TIMEO
  2589     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O
  2590     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O
  2591
  2592
  2593* EXEC CICS SEND DATAONLY
  2594*        FROM   (EL146AI)
  2595*        MAPSET (WS-MAPSET-NAME)
  2596*        MAP    (WS-MAP-NAME)
  2597*        CURSOR
  2598*    END-EXEC
  2599     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL146.cbl
  2600      EL146AI
  2601       TO DFHEIV12
  2602     MOVE -1
  2603       TO DFHEIV11
  2604*    MOVE '8$D    CT       H L F ,   #00002396' TO DFHEIV0
  2605     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2606     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2607     MOVE X'2020233030303032333936' TO DFHEIV0(25:11)
  2608     CALL 'kxdfhei1' USING DFHEIV0,
  2609           WS-MAP-NAME,
  2610           EL146AI,
  2611           DFHEIV12,
  2612           WS-MAPSET-NAME,
  2613           DFHEIV99,
  2614           DFHEIV99,
  2615           DFHEIV99,
  2616           DFHEIV11,
  2617           DFHEIV99,
  2618           DFHEIV99,
  2619           DFHEIV99
  2620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2621
  2622     GO TO 9100-RETURN-TRAN
  2623     .
  2624
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL146.cbl
  2626 8300-NOT-FOUND.
  2627
  2628*    MOVE AL-UABON                TO  CHKNOA  ORIGINA.
  2629     MOVE AL-UABON                TO  CHKNOA
  2630*    MOVE AL-UNBON                TO  CHKAMTA
  2631     MOVE -1                      TO  ENTERPFL
  2632     MOVE ER-0772                 TO  EMI-ERROR
  2633     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2634     GO TO 8200-SEND-DATAONLY
  2635     .
  2636
  2637 8300-EXIT.
  2638     EXIT.
  2639 8500-DATE-CONVERSION.
  2640
  2641
  2642* EXEC CICS LINK
  2643*        PROGRAM  ('ELDATCV')
  2644*        COMMAREA (DATE-CONVERSION-DATA)
  2645*        LENGTH   (DC-COMM-LENGTH)
  2646*    END-EXEC
  2647     MOVE 'ELDATCV' TO DFHEIV1
  2648*    MOVE '."C                   ''   #00002422' TO DFHEIV0
  2649     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2650     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2651     MOVE X'2020233030303032343232' TO DFHEIV0(25:11)
  2652     CALL 'kxdfhei1' USING DFHEIV0,
  2653           DFHEIV1,
  2654           DATE-CONVERSION-DATA,
  2655           DC-COMM-LENGTH,
  2656           DFHEIV99,
  2657           DFHEIV99,
  2658           DFHEIV99
  2659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2660     .
  2661
  2662 8500-EXIT.
  2663     EXIT.
  2664
  2665 8700-END-FILE.
  2666     MOVE -1                     TO ENTERPFL
  2667     MOVE ER-0130                TO EMI-ERROR
  2668     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2669     IF WS-RECORDS-READ-SW IS EQUAL TO 'Y'
  2670         GO TO 8100-SEND-INITIAL-MAP
  2671     ELSE
  2672         GO TO 8200-SEND-DATAONLY
  2673     END-IF
  2674     .
  2675
  2676 8700-EXIT.
  2677     EXIT.
  2678
  2679 8710-END-FILE.
  2680
  2681     MOVE LOW-VALUES             TO PI-SAVE-CHECK-NO (SUB)
  2682     MOVE -1                     TO ENTERPFL
  2683     MOVE ER-0131                TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL146.cbl
  2684     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2685
  2686     IF WS-RECORDS-READ-SW IS EQUAL TO 'Y'
  2687         GO TO 8100-SEND-INITIAL-MAP
  2688     ELSE
  2689         GO TO 8200-SEND-DATAONLY
  2690     END-IF
  2691     .
  2692
  2693 8710-EXIT.
  2694     EXIT.
  2695 8800-UNAUTHORIZED-ACCESS.
  2696
  2697     MOVE UNACCESS-MSG           TO  LOGOFF-MSG
  2698     GO TO 8850-SEND-TEXT
  2699     .
  2700
  2701 8850-SEND-TEXT.
  2702
  2703
  2704* EXEC CICS SEND TEXT
  2705*        FROM   (LOGOFF-TEXT)
  2706*        LENGTH (LOGOFF-LENGTH)
  2707*        ERASE  FREEKB
  2708*    END-EXEC
  2709*    MOVE '8&      T  E F  H   F -   #00002470' TO DFHEIV0
  2710     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2711     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2712     MOVE X'2020233030303032343730' TO DFHEIV0(25:11)
  2713     CALL 'kxdfhei1' USING DFHEIV0,
  2714           LOGOFF-TEXT,
  2715           LOGOFF-LENGTH,
  2716           DFHEIV99,
  2717           DFHEIV99,
  2718           DFHEIV99,
  2719           DFHEIV99,
  2720           DFHEIV99,
  2721           DFHEIV99,
  2722           DFHEIV99,
  2723           DFHEIV99,
  2724           DFHEIV99,
  2725           DFHEIV99
  2726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2727
  2728
  2729* EXEC CICS RETURN
  2730*    END-EXEC
  2731*    MOVE '.(                    &   #00002476' TO DFHEIV0
  2732     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2733     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2734     MOVE X'2020233030303032343736' TO DFHEIV0(25:11)
  2735     CALL 'kxdfhei1' USING DFHEIV0,
  2736           DFHEIV99,
  2737           DFHEIV99,
  2738           DFHEIV99,
  2739           DFHEIV99,
  2740           DFHEIV99
  2741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL146.cbl
  2742     .
  2743
  2744 8870-NOTOPEN.
  2745
  2746     MOVE ER-0776                TO  EMI-ERROR
  2747     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2748     MOVE -1                     TO  MAINTL
  2749     GO TO 8200-SEND-DATAONLY
  2750     .
  2751
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL146.cbl
  2753 9000-RETURN-CICS.
  2754
  2755     MOVE XCTL-005               TO  THIS-PGM
  2756     MOVE EIBAID                 TO  PI-ENTRY-CD-1
  2757     GO TO 9300-XCTL
  2758     .
  2759
  2760 9100-RETURN-TRAN.
  2761
  2762     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO
  2763     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO
  2764
  2765
  2766* EXEC CICS RETURN
  2767*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2768*        LENGTH   (PI-COMM-LENGTH)
  2769*        TRANSID  (WS-TRANS-ID)
  2770*    END-EXEC
  2771*    MOVE '.(CT                  &   #00002501' TO DFHEIV0
  2772     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2773     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2774     MOVE X'2020233030303032353031' TO DFHEIV0(25:11)
  2775     CALL 'kxdfhei1' USING DFHEIV0,
  2776           WS-TRANS-ID,
  2777           PROGRAM-INTERFACE-BLOCK,
  2778           PI-COMM-LENGTH,
  2779           DFHEIV99,
  2780           DFHEIV99
  2781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2782     .
  2783
  2784 9100-EXIT.
  2785     EXIT.
  2786
  2787 9300-XCTL.
  2788
  2789     MOVE DFHENTER               TO  EIBAID
  2790
  2791
  2792* EXEC CICS XCTL
  2793*        PROGRAM  (THIS-PGM)
  2794*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2795*        LENGTH   (PI-COMM-LENGTH)
  2796*    END-EXEC
  2797*    MOVE '.$C                   $   #00002515' TO DFHEIV0
  2798     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2799     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2800     MOVE X'2020233030303032353135' TO DFHEIV0(25:11)
  2801     CALL 'kxdfhei1' USING DFHEIV0,
  2802           THIS-PGM,
  2803           PROGRAM-INTERFACE-BLOCK,
  2804           PI-COMM-LENGTH
  2805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2806     .
  2807
  2808 9300-EXIT.
  2809     EXIT.
  2810
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL146.cbl
  2812 9400-CLEAR.
  2813
  2814     MOVE PI-RETURN-TO-PROGRAM  TO  THIS-PGM
  2815     GO TO 9300-XCTL
  2816     .
  2817
  2818 9600-PGMIDERR.
  2819
  2820
  2821* EXEC CICS HANDLE CONDITION
  2822*        PGMIDERR (8200-SEND-DATAONLY)
  2823*    END-EXEC
  2824*    MOVE '"$L                   ! & #00002534' TO DFHEIV0
  2825     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2826     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2827     MOVE X'2620233030303032353334' TO DFHEIV0(25:11)
  2828     CALL 'kxdfhei1' USING DFHEIV0
  2829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2830
  2831     MOVE  THIS-PGM              TO  PI-CALLING-PROGRAM
  2832                                     LOGOFF-PGM
  2833
  2834     MOVE XCTL-005               TO  THIS-PGM
  2835     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL
  2836     MOVE SPACES                 TO  PI-ENTRY-CD-1
  2837     GO TO 9300-XCTL
  2838     .
  2839
  2840 9900-ERROR-FORMAT.
  2841
  2842     MOVE LINK-001               TO  THIS-PGM
  2843
  2844* EXEC CICS LINK
  2845*        PROGRAM  (THIS-PGM)
  2846*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  2847*        LENGTH   (EMI-COMM-LENGTH)
  2848*    END-EXEC
  2849*    MOVE '."C                   ''   #00002550' TO DFHEIV0
  2850     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2851     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2852     MOVE X'2020233030303032353530' TO DFHEIV0(25:11)
  2853     CALL 'kxdfhei1' USING DFHEIV0,
  2854           THIS-PGM,
  2855           ERROR-MESSAGE-INTERFACE-BLOCK,
  2856           EMI-COMM-LENGTH,
  2857           DFHEIV99,
  2858           DFHEIV99,
  2859           DFHEIV99
  2860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2861     .
  2862
  2863 9900-EXIT.
  2864     EXIT.
  2865
  2866 9990-ERROR.
  2867
  2868     MOVE DFHEIBLK               TO  EMI-LINE1
  2869     MOVE LINK-004               TO  THIS-PGM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL146.cbl
  2870
  2871* EXEC CICS LINK
  2872*        PROGRAM  (THIS-PGM)
  2873*        COMMAREA (EMI-LINE1)
  2874*        LENGTH   (72)
  2875*    END-EXEC
  2876     MOVE 72
  2877       TO DFHEIV11
  2878*    MOVE '."C                   ''   #00002564' TO DFHEIV0
  2879     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2880     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2881     MOVE X'2020233030303032353634' TO DFHEIV0(25:11)
  2882     CALL 'kxdfhei1' USING DFHEIV0,
  2883           THIS-PGM,
  2884           EMI-LINE1,
  2885           DFHEIV11,
  2886           DFHEIV99,
  2887           DFHEIV99,
  2888           DFHEIV99
  2889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2890
  2891     GO TO 8200-SEND-DATAONLY
  2892     .
  2893
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL146.cbl
  2895 9995-SECURITY-VIOLATION.
  2896*                            COPY ELCSCTP.
  2897******************************************************************
  2898*                                                                *
  2899*                            ELCSCTP                             *
  2900*                            VMOD=2.001                          *
  2901*                                                                *
  2902*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2903******************************************************************
  2904
  2905
  2906     MOVE EIBDATE          TO SM-JUL-DATE.
  2907     MOVE EIBTRMID         TO SM-TERMID.
  2908     MOVE THIS-PGM         TO SM-PGM.
  2909     MOVE EIBTIME          TO TIME-IN.
  2910     MOVE TIME-OUT         TO SM-TIME.
  2911     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2912
  2913
  2914* EXEC CICS LINK
  2915*         PROGRAM  ('EL003')
  2916*         COMMAREA (SECURITY-MESSAGE)
  2917*         LENGTH   (80)
  2918*    END-EXEC.
  2919     MOVE 'EL003' TO DFHEIV1
  2920     MOVE 80
  2921       TO DFHEIV11
  2922*    MOVE '."C                   ''   #00002592' TO DFHEIV0
  2923     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2924     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2925     MOVE X'2020233030303032353932' TO DFHEIV0(25:11)
  2926     CALL 'kxdfhei1' USING DFHEIV0,
  2927           DFHEIV1,
  2928           SECURITY-MESSAGE,
  2929           DFHEIV11,
  2930           DFHEIV99,
  2931           DFHEIV99,
  2932           DFHEIV99
  2933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2934
  2935
  2936******************************************************************
  2937
  2938
  2939 9995-EXIT.
  2940     EXIT.
  2941
  2942 9999-LAST-PARAGRAPH SECTION.
  2943
  2944
  2945* GOBACK.
  2946     MOVE '9%                    "   ' TO DFHEIV0
  2947     MOVE 'EL146' TO DFHEIV1
  2948     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2949     GOBACK.
  2950
  2951 9999-DFHBACK SECTION.
  2952     MOVE '9%                    "   ' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL146.cbl
  2953     MOVE 'EL146' TO DFHEIV1
  2954     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2955     GOBACK.
  2956 9999-DFHEXIT.
  2957     IF DFHEIGDJ EQUAL 0001
  2958         NEXT SENTENCE
  2959     ELSE IF DFHEIGDJ EQUAL 2
  2960         GO TO 9990-ERROR,
  2961               8870-NOTOPEN,
  2962               9600-PGMIDERR
  2963         DEPENDING ON DFHEIGDI
  2964     ELSE IF DFHEIGDJ EQUAL 3
  2965         GO TO 8700-END-FILE,
  2966               8300-NOT-FOUND
  2967         DEPENDING ON DFHEIGDI
  2968     ELSE IF DFHEIGDJ EQUAL 4
  2969         GO TO 8710-END-FILE,
  2970               8300-NOT-FOUND
  2971         DEPENDING ON DFHEIGDI
  2972     ELSE IF DFHEIGDJ EQUAL 5
  2973         GO TO 8300-NOT-FOUND
  2974         DEPENDING ON DFHEIGDI
  2975     ELSE IF DFHEIGDJ EQUAL 6
  2976         GO TO 8200-SEND-DATAONLY
  2977         DEPENDING ON DFHEIGDI.
  2978     MOVE '9%                    "   ' TO DFHEIV0
  2979     MOVE 'EL146' TO DFHEIV1
  2980     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2981     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4400     Code:        6469
