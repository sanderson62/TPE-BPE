* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL1792.cbl
* Options: int("EL1792.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1792.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1792.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1792.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1792.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/13/96 09:39:33.
     7*                            VMOD=2.008.
     8*AUTHOR.        LOGIC, INC.
     9*               DALLAS, TEXAS.
    10
    11*DATE-COMPILED.
    12
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL1792.cbl
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22
    23*REMARKS. TRANSACTION EX59 - PRINT REPORT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL1792.cbl
    25 ENVIRONMENT DIVISION.
    26 DATA DIVISION.
    27 WORKING-STORAGE SECTION.
    28 01  DFH-START PIC X(04).
    29*77  THIS-PGM PIC X(6)  VALUE 'EL1792'.
    30 77  THIS-PGM PIC X(5)  VALUE SPACES.
    31 77  FILLER  PIC X(32)  VALUE '********************************'.
    32 77  FILLER  PIC X(32)  VALUE '*   EL1792 WORKING STORAGE     *'.
    33 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.008 *********'.
    34
    35 01  LITERALS-NUMBERS.
    36     12  LIT-X                   PIC X       VALUE 'X'.
    37     12  LIT-1                   PIC X       VALUE '1'.

    39 01  REPT-KEY.
    40     12  REPT-COMPANY-CODE       PIC X.
    41     12  REPT-RECORD-TYPE        PIC X.
    42     12  REPT-REPORT-ID          PIC X(5).
    43     12  REPT-LINE-NUMBER        PIC S9(8)   COMP.

    45 01  WS-TERMINAL-ID.
    46     12  WS-TERM-PREFIX          PIC XX.
    47     12  FILLER                  PIC XX.
    48 01  REMOTE-PRINTER-CTRL.
    49     12  CTRL-BUFFER-LENGTH      PIC S9(04) COMP.
    50     12  CTRL-BUFFER-AREA        PIC X(20).

    52 01  ERROR-NUMBERS.
    53     12  ER-0275                 PIC X(4)    VALUE '0275'.
    54     12  ER-0424                 PIC X(4)    VALUE '0424'.
    55     12  ER-8332                 PIC X(4)    VALUE '8332'.
    56     12  ER-8333                 PIC X(4)    VALUE '8333'.

    58 01  COMP-LENGTHS.
    59     12  COMP-132                PIC S9(4)   COMP VALUE +132.
    60*                                COPY ELCDMD34.
    61******************************************************************
    62*                                                                *
    63*                                                                *
    64*                            ELCDMD34.                           *
    65*                            VMOD=2.001                          *
    66*                                                                *
    67*   FILE DESCRIPTION = DMD DLO034 PARAMETER AREA                 *
    68*                                                                *
    69*    LENGTH = 272    RECFRM = FIXED                              *
    70*                                                                *
    71******************************************************************
    72 01  DLO034-COMMUNICATION-AREA.
    73     12  DL34-PROCESS-TYPE             PIC X.
    74     12  DL34-COMPANY-ID               PIC XXX.
    75     12  DL34-PRINT-PROGRAM-ID         PIC X(8).
    76     12  DL34-USERID                   PIC X(4).
    77     12  DL34-PRINT-LINE               PIC X(250).
    78     12  DL34-OVERRIDE-PRINTER-ID      PIC X(4).
    79     12  DL34-RETURN-CODE              PIC XX.
    80 01  DLO034-REC-LENGTH                 PIC S9(4) COMP VALUE +272.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL1792.cbl
    82*                                COPY ELCLOGOF.
    83******************************************************************
    84*                                                                *
    85*                                                                *
    86*                            ELCLOGOF.                           *
    87*                            VMOD=2.001                          *
    88*                                                                *
    89*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
    90*                                                                *
    91******************************************************************
    92 01  CLASIC-LOGOFF.
    93     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
    94     12  LOGOFF-TEXT.
    95         16  FILLER          PIC X(5)    VALUE SPACES.
    96         16  LOGOFF-MSG.
    97             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
    98             20  FILLER      PIC X       VALUE SPACES.
    99             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   100         16  FILLER          PIC X(80)
   101           VALUE '* YOU ARE NOW LOGGED OFF'.
   102         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   103         16  FILLER          PIC X       VALUE QUOTE.
   104         16  LOGOFF-SYS-MSG  PIC X(17)
   105           VALUE 'S CLAS-IC SYSTEM '.
   106     12  TEXT-MESSAGES.
   107         16  UNACCESS-MSG    PIC X(29)
   108             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   109         16  PGMIDERR-MSG    PIC X(17)
   110             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL1792.cbl
   112*                                COPY ELCINTF.
   113******************************************************************
   114*                                                                *
   115*                                                                *
   116*                            ELCINTF.                            *
   117*                            VMOD=2.017                          *
   118*                                                                *
   119*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   120*                                                                *
   121*       LENGTH = 1024                                            *
   122*                                                                *
   123******************************************************************
   124 01  PROGRAM-INTERFACE-BLOCK.
   125     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   126     12  PI-CALLING-PROGRAM              PIC X(8).
   127     12  PI-SAVED-PROGRAM-1              PIC X(8).
   128     12  PI-SAVED-PROGRAM-2              PIC X(8).
   129     12  PI-SAVED-PROGRAM-3              PIC X(8).
   130     12  PI-SAVED-PROGRAM-4              PIC X(8).
   131     12  PI-SAVED-PROGRAM-5              PIC X(8).
   132     12  PI-SAVED-PROGRAM-6              PIC X(8).
   133     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   134     12  PI-COMPANY-ID                   PIC XXX.
   135     12  PI-COMPANY-CD                   PIC X.
   136
   137     12  PI-COMPANY-PASSWORD             PIC X(8).
   138
   139     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   140
   141     12  PI-CONTROL-IN-PROGRESS.
   142         16  PI-CARRIER                  PIC X.
   143         16  PI-GROUPING                 PIC X(6).
   144         16  PI-STATE                    PIC XX.
   145         16  PI-ACCOUNT                  PIC X(10).
   146         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   147                                         PIC X(10).
   148         16  PI-CLAIM-CERT-GRP.
   149             20  PI-CLAIM-NO             PIC X(7).
   150             20  PI-CERT-NO.
   151                 25  PI-CERT-PRIME       PIC X(10).
   152                 25  PI-CERT-SFX         PIC X.
   153             20  PI-CERT-EFF-DT          PIC XX.
   154         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   155             20  PI-PLAN-CODE            PIC X(2).
   156             20  PI-REVISION-NUMBER      PIC X(3).
   157             20  PI-PLAN-EFF-DT          PIC X(2).
   158             20  PI-PLAN-EXP-DT          PIC X(2).
   159             20  FILLER                  PIC X(11).
   160         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   161             20  PI-OE-REFERENCE-1.
   162                 25  PI-OE-REF-1-PRIME   PIC X(18).
   163                 25  PI-OE-REF-1-SUFF    PIC XX.
   164
   165     12  PI-SESSION-IN-PROGRESS          PIC X.
   166         88  CLAIM-SESSION                   VALUE '1'.
   167         88  CREDIT-SESSION                  VALUE '2'.
   168         88  WARRANTY-SESSION                VALUE '3'.
   169         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL1792.cbl
   170         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   171
   172
   173*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   174
   175     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   176     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   177
   178     12  PI-CREDIT-USER                  PIC X.
   179         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   180         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   181
   182     12  PI-CLAIM-USER                   PIC X.
   183         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   184         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   185
   186     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   187         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   188         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   189         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   190         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   191         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   192
   193     12  PI-PROCESSOR-ID                 PIC X(4).
   194
   195     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   196
   197     12  PI-MEMBER-CAPTION               PIC X(10).
   198
   199     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   200         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   201
   202     12  PI-LIFE-OVERRIDE-L1             PIC X.
   203     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   204     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   205     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   206
   207     12  PI-AH-OVERRIDE-L1               PIC X.
   208     12  PI-AH-OVERRIDE-L2               PIC XX.
   209     12  PI-AH-OVERRIDE-L6               PIC X(6).
   210     12  PI-AH-OVERRIDE-L12              PIC X(12).
   211
   212     12  PI-NEW-SYSTEM                   PIC X(2).
   213
   214     12  PI-PRIMARY-CERT-NO              PIC X(11).
   215     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   216         88  PI-USES-PAID-TO                 VALUE '1'.
   217     12  PI-CRDTCRD-SYSTEM.
   218         16  PI-CRDTCRD-USER             PIC X.
   219             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   220             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   221         16  PI-CC-MONTH-END-DT          PIC XX.
   222     12  PI-PROCESSOR-PRINTER            PIC X(4).
   223
   224     12  PI-OE-REFERENCE-2.
   225         16  PI-OE-REF-2-PRIME           PIC X(10).
   226         16  PI-OE-REF-2-SUFF            PIC X.
   227
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL1792.cbl
   228     12  PI-REM-TRM-CALC-OPTION          PIC X.
   229
   230     12  PI-LANGUAGE-TYPE                PIC X.
   231             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   232             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   233             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   234
   235     12  PI-POLICY-LINKAGE-IND           PIC X.
   236         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   237         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   238                                                   LOW-VALUES.
   239
   240     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   241     12  PI-CLAIM-PW-SESSION             PIC X(1).
   242         88  PI-CLAIM-CREDIT                 VALUE '1'.
   243         88  PI-CLAIM-CONVEN                 VALUE '2'.
   244     12  FILLER                          PIC X(4).
   245
   246     12  PI-SYSTEM-LEVEL                 PIC X(145).
   247
   248     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   249         PI-SYSTEM-LEVEL.
   250
   251         16  PI-ENTRY-CODES.
   252             20  PI-ENTRY-CD-1           PIC X.
   253             20  PI-ENTRY-CD-2           PIC X.
   254
   255         16  PI-RETURN-CODES.
   256             20  PI-RETURN-CD-1          PIC X.
   257             20  PI-RETURN-CD-2          PIC X.
   258
   259         16  PI-UPDATE-STATUS-SAVE.
   260             20  PI-UPDATE-BY            PIC X(4).
   261             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   262
   263         16  PI-LOWER-CASE-LETTERS       PIC X.
   264             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   265
   266*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   267*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   268*            88  CARRIER-CLM-CNTL            VALUE '2'.
   269
   270         16  PI-CERT-ACCESS-CONTROL      PIC X.
   271             88  ST-ACCNT-CNTL               VALUE ' '.
   272             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   273             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   274             88  ACCNT-CNTL                  VALUE '3'.
   275             88  CARR-ACCNT-CNTL             VALUE '4'.
   276
   277         16  PI-PROCESSOR-CAP-LIST.
   278             20  PI-SYSTEM-CONTROLS.
   279                24 PI-SYSTEM-DISPLAY     PIC X.
   280                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   281                24 PI-SYSTEM-MODIFY      PIC X.
   282                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   283             20  FILLER                  PIC XX.
   284             20  PI-DISPLAY-CAP          PIC X.
   285                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL1792.cbl
   286             20  PI-MODIFY-CAP           PIC X.
   287                 88  MODIFY-CAP              VALUE 'Y'.
   288             20  PI-MSG-AT-LOGON-CAP     PIC X.
   289                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   290             20  PI-FORCE-CAP            PIC X.
   291                 88  FORCE-CAP               VALUE 'Y'.
   292
   293         16  PI-PROGRAM-CONTROLS.
   294             20  PI-PGM-PRINT-OPT        PIC X.
   295             20  PI-PGM-FORMAT-OPT       PIC X.
   296             20  PI-PGM-PROCESS-OPT      PIC X.
   297             20  PI-PGM-TOTALS-OPT       PIC X.
   298
   299         16  PI-HELP-INTERFACE.
   300             20  PI-LAST-ERROR-NO        PIC X(4).
   301             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   302
   303         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   304             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   305
   306         16  PI-CR-CONTROL-IN-PROGRESS.
   307             20  PI-CR-CARRIER           PIC X.
   308             20  PI-CR-GROUPING          PIC X(6).
   309             20  PI-CR-STATE             PIC XX.
   310             20  PI-CR-ACCOUNT           PIC X(10).
   311             20  PI-CR-FIN-RESP          PIC X(10).
   312             20  PI-CR-TYPE              PIC X.
   313
   314         16  PI-CR-BATCH-NUMBER          PIC X(6).
   315
   316         16  PI-CR-MONTH-END-DT          PIC XX.
   317
   318         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   319             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   320             88  PI-ZERO-CARRIER             VALUE '1'.
   321             88  PI-ZERO-GROUPING            VALUE '2'.
   322             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   323
   324         16  PI-CARRIER-SECURITY         PIC X.
   325             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   326
   327         16  PI-ACCOUNT-SECURITY         PIC X(10).
   328             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   329             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   330
   331         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   332             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   333                                         INDEXED BY PI-ACCESS-NDX
   334                                         PIC X.
   335
   336         16  PI-GA-BILLING-CONTROL       PIC X.
   337             88  PI-GA-BILLING               VALUE '1'.
   338
   339         16  PI-MAIL-PROCESSING          PIC X.
   340             88  PI-MAIL-YES                 VALUE 'Y'.
   341
   342         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   343
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL1792.cbl
   344         16  PI-AR-SYSTEM.
   345             20  PI-AR-PROCESSING-CNTL   PIC X.
   346                 88  PI-AR-PROCESSING        VALUE 'Y'.
   347             20  PI-AR-SUMMARY-CODE      PIC X(6).
   348             20  PI-AR-MONTH-END-DT      PIC XX.
   349
   350         16  PI-MP-SYSTEM.
   351             20  PI-MORTGAGE-USER            PIC X.
   352                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   353                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   354             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   355                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   356                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   357                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   358                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   359                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   360             20  PI-MP-MONTH-END-DT          PIC XX.
   361             20  PI-MP-REFERENCE-NO.
   362                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   363                 24  PI-MP-REFERENCE-SFX     PIC XX.
   364
   365         16  PI-LABEL-CONTROL            PIC X(01).
   366             88  PI-CREATE-LABELS                    VALUE 'Y'.
   367             88  PI-BYPASS-LABELS                    VALUE 'N'.
   368
   369         16  PI-BILL-GROUPING-CODE       PIC X(01).
   370             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   371
   372         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   373             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   374             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   375
   376         16  FILLER                      PIC X(14).
   377
   378     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   379******************************************************************
   380     12  EL1792-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
   381         16  PI-PRINT-REPORT     PIC X(5).
   382         16  PI-START-COUNT      PIC S9(8)  COMP.
   383         16  PI-TOTAL-COUNT      PIC S9(8)  COMP.
   384         16  PI-START-PAGE-NO    PIC S9(4).
   385         16  PI-ACCUM-PAGE-NO    PIC S9(4).
   386         16  PI-END-PAGE-NO      PIC S9(4).
   387*        16  PI-FORMS-PRINTER-ID PIC X(4).
   388         16  PI-PRINT-ID         PIC X(4).
   389         16  FILLER              PIC X(611).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL1792.cbl
   391*                                COPY ELCEMIB.
   392******************************************************************
   393*                                                                *
   394*                                                                *
   395*                            ELCEMIB.                            *
   396*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   397*                            VMOD=2.005                          *
   398*                                                                *
   399*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   400*                                                                *
   401******************************************************************
   402 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   403     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   404     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   405     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   406     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   407     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   408     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   409     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   410     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   411     12  EMI-SWITCH1             PIC X        VALUE '1'.
   412         88  EMI-NO-ERRORS                    VALUE '1'.
   413         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   414         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   415     12  EMI-SWITCH2             PIC X        VALUE '1'.
   416         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   417     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   418         88  EMI-AREA1-EMPTY                  VALUE '1'.
   419         88  EMI-AREA1-FULL                   VALUE '2'.
   420     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   421         88  EMI-AREA2-EMPTY                  VALUE '1'.
   422         88  EMI-AREA2-FULL                   VALUE '2'.
   423     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   424         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   425         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   426         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   427         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   428         88  EMI-BYPASS-FATALS                VALUE 'X'.
   429     12  EMI-ERROR-LINES.
   430         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   431         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   432         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   433         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   434             20  EMI-ERR-CODES OCCURS 10 TIMES.
   435                 24  EMI-ERR-NUM         PIC X(4).
   436                 24  EMI-FILLER          PIC X.
   437                 24  EMI-SEV             PIC X.
   438                 24  FILLER              PIC X.
   439             20  FILLER                  PIC X(02).
   440     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   441         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   442             20  EMI-ERROR-NUMBER    PIC X(4).
   443             20  EMI-FILL            PIC X.
   444             20  EMI-SEVERITY        PIC X.
   445             20  FILLER              PIC X.
   446             20  EMI-ERROR-TEXT.
   447                 24  EMI-TEXT-VARIABLE   PIC X(10).
   448                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL1792.cbl
   449     12  EMI-SEVERITY-SAVE           PIC X.
   450         88  EMI-NOTE                    VALUE 'N'.
   451         88  EMI-WARNING                 VALUE 'W'.
   452         88  EMI-FORCABLE                VALUE 'F'.
   453         88  EMI-FATAL                   VALUE 'X'.
   454     12  EMI-MESSAGE-FLAG            PIC X.
   455         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   456         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   457     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   458     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   459         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   460         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   461         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   462     12  FILLER                      PIC X(137)  VALUE SPACES.
   463     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   464     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   465     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   466     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL1792.cbl
   468*                                COPY ELPRTCVD.
   469*****************************************************************
   470*                                                               *
   471*                            ELPRTCVD.                          *
   472*                            VMOD=2.001                         *
   473*****************************************************************.
   474
   475******************************************************************
   476***   WORK AREAS  FOR TERMINAL ONLINE PRINT ROUTINE
   477***                 -ELPRTCVD-
   478***   TO BE USED WITH PROCEDURE COPY MEMBER -ELPRTCVP-
   479******************************************************************
   480
   481 01  S-WORK-AREA                     SYNC.
   482     12  WS-LINE-LEN                 PIC S9(4)       VALUE +80
   483                                     COMP.
   484
   485     12  WS-LINE-LENGTH              PIC S9(4)       VALUE ZERO
   486                                     COMP.
   487
   488     12  WS-BUFFER-SIZE              PIC S9(4)       VALUE +1916
   489                                     COMP.
   490
   491     12  WS-BUFFER-LENGTH            PIC S9(4)       VALUE ZERO
   492                                     COMP.
   493
   494     12  WS-PROG-END                 PIC X           VALUE SPACES.
   495
   496     12  WS-PRINT-AREA.
   497         16  WS-PASSED-CNTL-CHAR     PIC X           VALUE SPACES.
   498           88  SINGLE-SPACE                          VALUE ' '.
   499           88  DOUBLE-SPACE                          VALUE '0'.
   500           88  TRIPLE-SPACE                          VALUE '-'.
   501           88  TOP-PAGE                              VALUE '1'.
   502
   503         16  WS-PASSED-DATA.
   504             20  WS-PRINT-BYTE       PIC X
   505                 OCCURS 132 TIMES    INDEXED BY PRT-INDEX.
   506
   507     12  WS-LINE-CNT                 PIC S9(3)        VALUE ZERO
   508                                     COMP-3.
   509     12  WS-WCC-CNTL                 PIC X(1)         VALUE 'H'.
   510
   511     12  WS-EM                       PIC S9(4)        VALUE +25
   512                                     COMP.
   513     12  FILLER   REDEFINES WS-EM.
   514         16  FILLER                  PIC X.
   515         16  T-EM                    PIC X.
   516
   517*    12  WS-SS                       PIC S9(4)        VALUE +21
   518     12  WS-SS                       PIC S9(4)        VALUE +10
   519                                     COMP.
   520     12  FILLER   REDEFINES WS-SS.
   521         16  FILLER                  PIC X.
   522         16  T-SS                    PIC X.
   523
   524     12  WS-TP                       PIC S9(4)      VALUE +12
   525                                     COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL1792.cbl
   526     12  FILLER   REDEFINES WS-TP.
   527         16  FILLER                  PIC X.
   528         16  T-TP                    PIC X.
   529
   530     12  WS-FIRST-TIME-SW            PIC X           VALUE '1'.
   531         88  FIRST-TIME                              VALUE '1'.
   532         88  FIRST-LINE-NEXT-BUFFER                  VALUE '2'.
   533
   534     12  WS-BUFFER-AREA.
   535         16  WS-BUFFER-BYTE          PIC X
   536             OCCURS 1920 TIMES       INDEXED BY BUFFER-INDEX
   537                                                BUFFER-INDEX2.
   538
   539******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL1792.cbl
   541****************************************************************
   542*
   543* Copyright (c) 2007 by Clerity Solutions, Inc.
   544* All rights reserved.
   545*
   546****************************************************************
   547 01  DFHEIV.
   548   02  DFHEIV0               PIC X(35).
   549   02  DFHEIV1               PIC X(08).
   550   02  DFHEIV2               PIC X(08).
   551   02  DFHEIV3               PIC X(08).
   552   02  DFHEIV4               PIC X(06).
   553   02  DFHEIV5               PIC X(04).
   554   02  DFHEIV6               PIC X(04).
   555   02  DFHEIV7               PIC X(02).
   556   02  DFHEIV8               PIC X(02).
   557   02  DFHEIV9               PIC X(01).
   558   02  DFHEIV10              PIC S9(7) COMP-3.
   559   02  DFHEIV11              PIC S9(4) COMP SYNC.
   560   02  DFHEIV12              PIC S9(4) COMP SYNC.
   561   02  DFHEIV13              PIC S9(4) COMP SYNC.
   562   02  DFHEIV14              PIC S9(4) COMP SYNC.
   563   02  DFHEIV15              PIC S9(4) COMP SYNC.
   564   02  DFHEIV16              PIC S9(9) COMP SYNC.
   565   02  DFHEIV17              PIC X(04).
   566   02  DFHEIV18              PIC X(04).
   567   02  DFHEIV19              PIC X(04).
   568   02  DFHEIV20              USAGE IS POINTER.
   569   02  DFHEIV21              USAGE IS POINTER.
   570   02  DFHEIV22              USAGE IS POINTER.
   571   02  DFHEIV23              USAGE IS POINTER.
   572   02  DFHEIV24              USAGE IS POINTER.
   573   02  DFHEIV25              PIC S9(9) COMP SYNC.
   574   02  DFHEIV26              PIC S9(9) COMP SYNC.
   575   02  DFHEIV27              PIC S9(9) COMP SYNC.
   576   02  DFHEIV28              PIC S9(9) COMP SYNC.
   577   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   578   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   579   02  FILLER                PIC X(02).
   580   02  DFHEIV99              PIC X(08) VALUE SPACE.
   581   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   582   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   583   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   584   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   585 LINKAGE  SECTION.
   586*****************************************************************
   587*                                                               *
   588* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   589* All rights reserved.                                          *
   590*                                                               *
   591*****************************************************************
   592 01  dfheiblk.
   593     02  eibtime          pic s9(7) comp-3.
   594     02  eibdate          pic s9(7) comp-3.
   595     02  eibtrnid         pic x(4).
   596     02  eibtaskn         pic s9(7) comp-3.
   597     02  eibtrmid         pic x(4).
   598     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL1792.cbl
   599     02  eibcposn         pic s9(4) comp.
   600     02  eibcalen         pic s9(4) comp.
   601     02  eibaid           pic x(1).
   602     02  eibfiller1       pic x(1).
   603     02  eibfn            pic x(2).
   604     02  eibfiller2       pic x(2).
   605     02  eibrcode         pic x(6).
   606     02  eibfiller3       pic x(2).
   607     02  eibds            pic x(8).
   608     02  eibreqid         pic x(8).
   609     02  eibrsrce         pic x(8).
   610     02  eibsync          pic x(1).
   611     02  eibfree          pic x(1).
   612     02  eibrecv          pic x(1).
   613     02  eibsend          pic x(1).
   614     02  eibatt           pic x(1).
   615     02  eibeoc           pic x(1).
   616     02  eibfmh           pic x(1).
   617     02  eibcompl         pic x(1).
   618     02  eibsig           pic x(1).
   619     02  eibconf          pic x(1).
   620     02  eiberr           pic x(1).
   621     02  eibrldbk         pic x(1).
   622     02  eiberrcd         pic x(4).
   623     02  eibsynrb         pic x(1).
   624     02  eibnodat         pic x(1).
   625     02  eibfiller5       pic x(2).
   626     02  eibresp          pic 9(09) comp.
   627     02  eibresp2         pic 9(09) comp.
   628     02  dfheigdj         pic s9(4) comp.
   629     02  dfheigdk         pic s9(4) comp.
   630 01  DFHCOMMAREA                 PIC X(1024).
   631
   632*                                COPY ELCREPT.
   633******************************************************************
   634*                                                                *
   635*                                                                *
   636*                            ELCREPT.                            *
   637*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   638*                            VMOD=2.002                          *
   639*                                                                *
   640*   FILE DESCRIPTION = REPORT STORAGE                            *
   641*                                                                *
   642*   FILE TYPE = VSAM,KSDS                                        *
   643*   RECORD SIZE = 146   RECFORM = FIX                            *
   644*                                                                *
   645*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *
   646*       ALTERNATE PATH  = NOT USED                               *
   647*                                                                *
   648*   LOG = NO                                                     *
   649*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   650******************************************************************
   651 01  REPORT-SAVE-FILE.
   652     12  RF-RECORD-ID                PIC XX.
   653         88  VALID-RF-ID                VALUE 'RF'.
   654
   655     12  RF-CONTROL-PRIMARY.
   656         16  RF-COMPANY-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL1792.cbl
   657         16  RF-RECORD-TYPE          PIC X.
   658             88  REPORT-DETAIL-RECORD   VALUE '1'.
   659             88  REPORT-TRAILER-RECORD  VALUE '2'.
   660         16  RF-REPORT-ID.
   661             20  RF-SYSTEM-CODE      PIC XX.
   662                 88  CLAS-IC-ONLINE     VALUE 'EL'.
   663                 88  CLAS-SCS-BATCH     VALUE 'EC'.
   664             20  RF-PROGRAM-SEQUENCE PIC 999.
   665         16  RF-LINE-NUMBER          PIC S9(8)       COMP.
   666     12  RF-REPORT-LINE-133.
   667         16  RF-CTL-CHAR-133         PIC X.
   668         16  RF-DATA-133             PIC X(132).
   669         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.
   670             20  RF-DATA-2-81        PIC X(80).
   671             20  FILLER              PIC X(52).
   672         16  RF-DATA-LAST   REDEFINES RF-DATA-133.
   673             20  FILLER              PIC X(53).
   674             20  RF-DATA-55-133      PIC X(79).
   675     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.
   676         16  FILLER                  PIC X.
   677         16  RF-CURRENT-DATE         PIC X(8).
   678         16  RF-PRINT-HH-MM-SS       PIC X(6).
   679         16  FILLER                  PIC X(115).
   680         16  RF-COMPANY-ID           PIC XXX.
   681******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL1792.cbl
   683 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA REPORT-SAVE-FILE.
   684 0000-DFHEXIT SECTION.
   685     MOVE '9#                    $   ' TO DFHEIV0.
   686     MOVE 'EL1792' TO DFHEIV1.
   687     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   688
   689     MOVE COMP-132               TO WS-LINE-LEN.
   690     MOVE SPACES                 TO DL34-PROCESS-TYPE.
   691*    MOVE 'N'                    TO CSO-PRINT-STARTED-SW.
   692
   693 0010-RETREIVE-REQUEST.
   694
   695
   696* EXEC CICS HANDLE CONDITION
   697*        NOTOPEN  (0100-FILE-NOT-OPEN)
   698*        ENDDATA  (9100-RETURN-CICS)
   699*        NOTFND   (0200-COMM-AREA-NOT-FOUND)
   700*        ERROR    (9990-ABEND)
   701*    END-EXEC.
   702*    MOVE '"$J&I.                ! " #00000691' TO DFHEIV0
   703     MOVE X'22244A26492E202020202020' TO DFHEIV0(1:12)
   704     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
   705     MOVE X'2220233030303030363931' TO DFHEIV0(25:11)
   706     CALL 'kxdfhei1' USING DFHEIV0
   707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   708
   709
   710
   711* EXEC CICS RETRIEVE
   712*        INTO    (PROGRAM-INTERFACE-BLOCK)
   713*        LENGTH  (PI-COMM-LENGTH)
   714*    END-EXEC.
   715*    MOVE '0*I L                 &   #00000698' TO DFHEIV0
   716     MOVE X'302A49204C20202020202020' TO DFHEIV0(1:12)
   717     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   718     MOVE X'2020233030303030363938' TO DFHEIV0(25:11)
   719     CALL 'kxdfhei1' USING DFHEIV0,
   720           PROGRAM-INTERFACE-BLOCK,
   721           PI-COMM-LENGTH,
   722           DFHEIV99,
   723           DFHEIV99,
   724           DFHEIV99
   725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   726
   727
   728     MOVE PI-PRINT-REPORT TO THIS-PGM.
   729
   730* DLO034 OPEN WHEN DMD OR CID
   731     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
   732         IF DL34-PROCESS-TYPE = SPACES
   733             MOVE 'O'                TO DL34-PROCESS-TYPE
   734             MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
   735             MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
   736             MOVE PI-PROCESSOR-ID    TO DL34-USERID
   737             MOVE SPACES             TO DL34-PRINT-LINE
   738             MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
   739
   740* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL1792.cbl
   741*                PROGRAM    ('DLO034')
   742*                COMMAREA   (DLO034-COMMUNICATION-AREA)
   743*                LENGTH     (DLO034-REC-LENGTH)
   744*            END-EXEC
   745     MOVE 'DLO034' TO DFHEIV1
   746*    MOVE '."C                   ''   #00000714' TO DFHEIV0
   747     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
   748     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
   749     MOVE X'2020233030303030373134' TO DFHEIV0(25:11)
   750     CALL 'kxdfhei1' USING DFHEIV0,
   751           DFHEIV1,
   752           DLO034-COMMUNICATION-AREA,
   753           DLO034-REC-LENGTH,
   754           DFHEIV99,
   755           DFHEIV99,
   756           DFHEIV99
   757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   758             IF DL34-RETURN-CODE NOT = 'OK'
   759                 MOVE '8332'         TO EMI-ERROR
   760                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
   761
   762* EXEC CICS RETURN
   763*                END-EXEC.
   764*    MOVE '.(                    &   #00000722' TO DFHEIV0
   765     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
   766     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   767     MOVE X'2020233030303030373232' TO DFHEIV0(25:11)
   768     CALL 'kxdfhei1' USING DFHEIV0,
   769           DFHEIV99,
   770           DFHEIV99,
   771           DFHEIV99,
   772           DFHEIV99,
   773           DFHEIV99
   774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   775
   776
   777*    MOVE 'F' TO DRS-SW.
   778*    MOVE PI-PRINT-ID TO CSO-PRINT-ID.
   779*    PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
   780*    MOVE ' ' TO DRS-SW.
   781*
   782     MOVE SPACE                  TO WS-PROG-END.
   783     MOVE PI-COMPANY-CD          TO REPT-COMPANY-CODE.
   784     MOVE LIT-1                  TO REPT-RECORD-TYPE.
   785     MOVE PI-PRINT-REPORT        TO REPT-REPORT-ID.
   786     MOVE PI-START-COUNT         TO REPT-LINE-NUMBER.
   787
   788 0020-START-BROWSE.
   789
   790
   791* EXEC CICS STARTBR
   792*        DATASET  ('ELREPT')
   793*        RIDFLD   (REPT-KEY)
   794*    END-EXEC.
   795     MOVE 'ELREPT' TO DFHEIV1
   796     MOVE 0
   797       TO DFHEIV11
   798*    MOVE '&,         G          &   #00000738' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL1792.cbl
   799     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
   800     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   801     MOVE X'2020233030303030373338' TO DFHEIV0(25:11)
   802     CALL 'kxdfhei1' USING DFHEIV0,
   803           DFHEIV1,
   804           REPT-KEY,
   805           DFHEIV99,
   806           DFHEIV11,
   807           DFHEIV99
   808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   809
   810
   811     PERFORM 1000-PRINT-REPORT THRU 1000-PRINT-REPORT-EXIT.
   812
   813
   814* EXEC CICS ENDBR
   815*        DATASET ('ELREPT')
   816*    END-EXEC.
   817     MOVE 'ELREPT' TO DFHEIV1
   818     MOVE 0
   819       TO DFHEIV11
   820*    MOVE '&2                    $   #00000745' TO DFHEIV0
   821     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
   822     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
   823     MOVE X'2020233030303030373435' TO DFHEIV0(25:11)
   824     CALL 'kxdfhei1' USING DFHEIV0,
   825           DFHEIV1,
   826           DFHEIV11,
   827           DFHEIV99
   828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   829
   830
   831     GO TO 0010-RETREIVE-REQUEST.
   832*    GO TO 9100-RETURN-CICS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL1792.cbl
   834 0100-FILE-NOT-OPEN.
   835     MOVE ER-0275                TO EMI-ERROR.
   836     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
   837     MOVE EMI-MESSAGE-AREA (1)   TO WS-PRINT-AREA.
   838     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
   839     MOVE LIT-X                  TO WS-PROG-END.
   840*
   841*    MOVE 'L' TO DRS-SW.
   842*
   843     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
   844     GO TO 9100-RETURN-CICS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL1792.cbl
   846 0200-COMM-AREA-NOT-FOUND.
   847     MOVE ER-0424                TO EMI-ERROR.
   848     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
   849     MOVE EMI-MESSAGE-AREA (1)   TO WS-PRINT-AREA.
   850     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
   851     MOVE LIT-X                  TO WS-PROG-END.
   852*
   853*    MOVE 'L' TO DRS-SW.
   854*
   855     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
   856     GO TO 9100-RETURN-CICS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL1792.cbl
   858 1000-PRINT-REPORT.
   859
   860
   861* EXEC CICS HANDLE CONDITION
   862*        ENDFILE (1000-END-OF-FILE)
   863*    END-EXEC.
   864*    MOVE '"$''                   ! # #00000778' TO DFHEIV0
   865     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
   866     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
   867     MOVE X'2320233030303030373738' TO DFHEIV0(25:11)
   868     CALL 'kxdfhei1' USING DFHEIV0
   869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   870
   871
   872
   873* EXEC CICS READNEXT
   874*        SET      (ADDRESS OF REPORT-SAVE-FILE)
   875*        DATASET  ('ELREPT')
   876*        RIDFLD   (REPT-KEY)
   877*    END-EXEC.
   878     MOVE 'ELREPT' TO DFHEIV1
   879     MOVE 0
   880       TO DFHEIV11
   881*    MOVE '&.S                   )   #00000782' TO DFHEIV0
   882     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
   883     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
   884     MOVE X'2020233030303030373832' TO DFHEIV0(25:11)
   885     CALL 'kxdfhei1' USING DFHEIV0,
   886           DFHEIV1,
   887           DFHEIV20,
   888           DFHEIV99,
   889           REPT-KEY,
   890           DFHEIV99,
   891           DFHEIV11,
   892           DFHEIV99,
   893           DFHEIV99
   894     SET ADDRESS OF REPORT-SAVE-FILE TO
   895         DFHEIV20
   896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   897
   898
   899     IF RF-COMPANY-CD  NOT = PI-COMPANY-CD  OR
   900        RF-RECORD-TYPE NOT = LIT-1          OR
   901        RF-REPORT-ID   NOT = PI-PRINT-REPORT
   902         GO TO 1000-END-OF-FILE.
   903
   904     IF PI-END-PAGE-NO GREATER ZERO
   905         IF RF-CTL-CHAR-133 = '1'
   906             ADD +1 TO PI-ACCUM-PAGE-NO
   907             IF PI-ACCUM-PAGE-NO GREATER PI-END-PAGE-NO
   908                 GO TO 1000-END-OF-FILE.
   909
   910     MOVE RF-REPORT-LINE-133     TO WS-PRINT-AREA.
   911     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
   912     GO TO 1000-PRINT-REPORT.
   913
   914 1000-END-OF-FILE.
   915     MOVE LIT-X                  TO WS-PROG-END.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL1792.cbl
   916
   917     IF PI-COMPANY-ID NOT = 'DMD' OR 'CID'
   918         PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
   919
   920 1000-PRINT-REPORT-EXIT.
   921     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL1792.cbl
   923*8000-STANDARD-PRINT-ROUTINE.    COPY ELPRTCVP.
   924 8000-STANDARD-PRINT-ROUTINE.
   925*    COPY ELPRTCVP.
   926******************************************************************
   927***                                                              *
   928***                          ELPRTCVP.                           *
   929***                          VMOD=2.003                          *
   930***                                                              *
   931***     COPY MEMBER FOR TERMINAL ONLINE PRINT ROUTINE.           *
   932***     THIS ROUTINE WILL ACCOMODATE PRINTING TO A 3270          *
   933***     TERMINAL PRINTER. A BUFFER OF UP TO 1920 CHARACTERS      *
   934***     IS ACCUMULATED AND PRINTED COLLECTIVELY.                 *
   935***                                                              *
   936***     THIS ROUTINE TO BE USED ONLY WITH ACCOMPANIMENT          *
   937***      OF THE WORKING-STORAGE COPY MEMBER ( ELPRTCVD )         *
   938***     THE HOST PROGRAM MUST INITIALIZE THE FOLLOWING 3 FIELDS  *
   939***      FROM THE ABOVE COPY MEMBER FOR THIS PROCEDURE TO BE     *
   940***      SUCCESSFUL.                                             *
   941***      05  WS-LINE-LEN    PIC  S9(4)  COMP  VALUE +80.         *
   942***                         LENGTH OF THE LINE TO BE PRINTED     *
   943***                         DEFAULT IS 80, YOU CAN USE ANY NUMBER*
   944***                         UP TO 132.  THIS FIELD IS ONLY ACCEP-*
   945***                         TED THE FIRST TIME THRU THE ROUTINE. *
   946***      05  WS-PROG-END    PIC  X  VALUE SPACES.                *
   947***                         PROGRAM END SWITCH. INITIALIZED      *
   948***                         TO SPACE-     MOVE IN ANY NONBLANK   *
   949***                         TO IT WHEN PROGRAM IS FINISHED.      *
   950***      05  WS-PRINT-AREA.                                      *
   951***          10  WS-PASSED-CNTL-CHAR     PIC X.                  *
   952***          10  WS-PASSED-DATA          PIC X(132).             *
   953***                         USE THE DATA TO BE PRINTED IN THE    *
   954***                         WS-PASSED-DATA.                      *
   955***                         USE THE STANDARD CARRIAGE CONTROL    *
   956***                         CHARACTER IN THE WS-PASSED-CNTL-CHAR *
   957***                           SINGLE-SPACE            VALUE ' '  *
   958***                           DOUBLE-SPACE            VALUE '0'  *
   959***                           TRIPLE-SPACE            VALUE '-'  *
   960***                           TOP-PAGE                VALUE '1'  *
   961***      NOTE: A LINE COUNT IS PROVIDED IN FIELDNAME -WS-LINE-CNT*
   962***            THE USE OF THIS FIELD IS OPTIONAL.                *
   963***            THIS ROUTINE WILL ONLY ADD 1, 2, OR 3             *
   964***            TO THIS COUNT DEPENDING ON THE WS-PASSED-CNTL-CHAR*
   965***            AND RESET THE COUNT TO ZERO WHEN TOP-PAGE         *
   966***            CONDITION.                                        *
   967***                                                              *
   968******************************************************************
   969
   970 ELPRTCVP.
   971
   972*    IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'CID'
   973     IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'XXX'
   974         MOVE 'P'                TO DL34-PROCESS-TYPE
   975         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
   976         MOVE PI-PROCESSOR-ID    TO DL34-USERID
   977         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
   978         MOVE WS-PRINT-AREA      TO DL34-PRINT-LINE
   979         MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
   980
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL1792.cbl
   981
   982* EXEC CICS LINK
   983*            PROGRAM    ('DLO034')
   984*            COMMAREA   (DLO034-COMMUNICATION-AREA)
   985*            LENGTH     (DLO034-REC-LENGTH)
   986*        END-EXEC
   987     MOVE 'DLO034' TO DFHEIV1
   988*    MOVE '."C                   ''   #00000870' TO DFHEIV0
   989     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
   990     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
   991     MOVE X'2020233030303030383730' TO DFHEIV0(25:11)
   992     CALL 'kxdfhei1' USING DFHEIV0,
   993           DFHEIV1,
   994           DLO034-COMMUNICATION-AREA,
   995           DLO034-REC-LENGTH,
   996           DFHEIV99,
   997           DFHEIV99,
   998           DFHEIV99
   999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1000
  1001            IF DL34-RETURN-CODE = 'OK'
  1002                GO TO ELPRTCVP-EXIT
  1003            ELSE
  1004*               MOVE '8339'     TO EMI-ERROR ?????ERROR MESSAGE???
  1005                GO TO ELPRTCVP-EXIT.
  1006
  1007     IF NOT FIRST-TIME
  1008         GO TO ELPRTCVP-020.
  1009
  1010     IF WS-LINE-LEN NOT GREATER ZERO
  1011         GO TO ELPRTCVP-EXIT.
  1012
  1013     MOVE '2'                    TO WS-FIRST-TIME-SW.
  1014     MOVE LOW-VALUES             TO WS-BUFFER-AREA.
  1015
  1016     SET BUFFER-INDEX TO +1
  1017
  1018     IF EIBTRMID IS EQUAL TO 'AFLP'
  1019         NEXT SENTENCE
  1020     ELSE
  1021         IF NOT TOP-PAGE
  1022             MOVE T-TP           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1023             SET BUFFER-INDEX UP BY +1.
  1024
  1025 ELPRTCVP-020.
  1026     IF WS-PROG-END = SPACES
  1027         GO TO ELPRTCVP-030.
  1028
  1029     MOVE SPACES                 TO WS-PROG-END.
  1030
  1031     IF BUFFER-INDEX GREATER +1
  1032         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  1033
  1034     MOVE '1'                    TO WS-FIRST-TIME-SW.
  1035
  1036     GO TO ELPRTCVP-EXIT.
  1037
  1038 ELPRTCVP-030.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL1792.cbl
  1039     IF WS-PASSED-DATA = SPACES
  1040         SET PRT-INDEX TO +1
  1041         GO TO ELPRTCVP-050.
  1042
  1043     SET PRT-INDEX TO WS-LINE-LEN.
  1044
  1045 ELPRTCVP-040.
  1046     IF WS-PRINT-BYTE (PRT-INDEX) NOT = SPACES
  1047         GO TO ELPRTCVP-050.
  1048
  1049     IF PRT-INDEX GREATER +1
  1050         SET PRT-INDEX DOWN BY +1
  1051         GO TO ELPRTCVP-040.
  1052
  1053 ELPRTCVP-050.
  1054     SET WS-LINE-LENGTH TO PRT-INDEX.
  1055     SET BUFFER-INDEX2 TO BUFFER-INDEX.
  1056     SET BUFFER-INDEX2 UP BY WS-LINE-LENGTH.
  1057
  1058     IF BUFFER-INDEX2 NOT LESS WS-BUFFER-SIZE
  1059         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  1060
  1061     IF TRIPLE-SPACE
  1062          ADD +2  TO  WS-LINE-CNT
  1063          MOVE T-SS           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1064                                 WS-BUFFER-BYTE (BUFFER-INDEX + 1)
  1065          SET BUFFER-INDEX UP BY +2.
  1066
  1067     IF DOUBLE-SPACE
  1068          ADD +1  TO  WS-LINE-CNT
  1069          MOVE T-SS             TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1070          SET BUFFER-INDEX UP BY +1.
  1071
  1072     ADD +1 TO WS-LINE-CNT
  1073************************************************************
  1074*     BYPASS NEW LINE SYMBOL                               *
  1075*        IF FIRST BUFFER SENT AND TOP-OF-FORM SET.         *
  1076*     OR IF FIRST LINE OF SUBSEQUENT BUFFERS.              *
  1077************************************************************
  1078
  1079     IF (BUFFER-INDEX GREATER +1 AND
  1080         WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-TP)  OR
  1081         FIRST-LINE-NEXT-BUFFER
  1082         MOVE ZERO               TO WS-FIRST-TIME-SW
  1083     ELSE
  1084         MOVE T-SS               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1085         SET BUFFER-INDEX UP BY +1.
  1086
  1087**   NOTE, SINGLE SPACE IS REQUIRED BEFORE TOP PAGE CHAR
  1088
  1089     IF TOP-PAGE
  1090         MOVE +1                TO WS-LINE-CNT
  1091         MOVE T-TP              TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1092         SET BUFFER-INDEX UP BY +1.
  1093
  1094     SET PRT-INDEX TO +1.
  1095
  1096 ELPRTCVP-060.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL1792.cbl
  1097     MOVE WS-PRINT-BYTE (PRT-INDEX)
  1098                                 TO WS-BUFFER-BYTE (BUFFER-INDEX).
  1099     SET BUFFER-INDEX UP BY +1.
  1100
  1101     IF PRT-INDEX LESS WS-LINE-LENGTH
  1102         SET PRT-INDEX UP BY +1
  1103         GO TO ELPRTCVP-060.
  1104
  1105 ELPRTCVP-EXIT.
  1106     EXIT.
  1107
  1108 ELPRTCVP-PRINT-BUFFER.
  1109     IF WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-SS
  1110        MOVE SPACE               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1111        SET BUFFER-INDEX UP BY 1.
  1112
  1113     MOVE  T-EM                  TO  WS-BUFFER-BYTE (BUFFER-INDEX)
  1114     SET WS-BUFFER-LENGTH TO BUFFER-INDEX.
  1115
  1116
  1117* EXEC CICS SEND
  1118*        FROM    (WS-BUFFER-AREA)
  1119*        LENGTH  (WS-BUFFER-LENGTH)
  1120*        CTLCHAR (WS-WCC-CNTL)
  1121*        ERASE
  1122*    END-EXEC.
  1123*    MOVE '$$    C E         L F ,   #00000991' TO DFHEIV0
  1124     MOVE X'242420202020432045202020' TO DFHEIV0(1:12)
  1125     MOVE X'2020202020204C2046202C20' TO DFHEIV0(13:12)
  1126     MOVE X'2020233030303030393931' TO DFHEIV0(25:11)
  1127     CALL 'kxdfhei1' USING DFHEIV0,
  1128           WS-BUFFER-AREA,
  1129           WS-BUFFER-LENGTH,
  1130           DFHEIV99,
  1131           DFHEIV99,
  1132           WS-WCC-CNTL,
  1133           DFHEIV99,
  1134           DFHEIV99,
  1135           DFHEIV99,
  1136           DFHEIV99,
  1137           DFHEIV99,
  1138           DFHEIV99
  1139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1140
  1141
  1142     SET BUFFER-INDEX TO +1.
  1143     MOVE '2'                    TO WS-FIRST-TIME-SW.
  1144
  1145 ELPRTCVP-PRINT-EXIT.
  1146     EXIT.
  1147
  1148
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL1792.cbl
  1150 9100-RETURN-CICS.
  1151******   WHEN PRINTING TO A 3275 DIAL-UP TERMINAL
  1152******   THE TRANSID AND COMMAREA MUST BE RESET
  1153******   UPON COMPLETION OF THE TASK.
  1154*
  1155*    MOVE 'L' TO DRS-SW.
  1156*    PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1157*
  1158     MOVE EIBTRMID               TO WS-TERMINAL-ID.
  1159
  1160* DLO034 CLOSE
  1161     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  1162         MOVE 'C'                TO DL34-PROCESS-TYPE
  1163         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  1164         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  1165         MOVE PI-PROCESSOR-ID    TO DL34-USERID
  1166         MOVE SPACES             TO DL34-PRINT-LINE
  1167                                    DL34-OVERRIDE-PRINTER-ID
  1168
  1169* EXEC CICS LINK
  1170*            PROGRAM    ('DLO034')
  1171*            COMMAREA   (DLO034-COMMUNICATION-AREA)
  1172*            LENGTH     (DLO034-REC-LENGTH)
  1173*        END-EXEC
  1174     MOVE 'DLO034' TO DFHEIV1
  1175*    MOVE '."C                   ''   #00001024' TO DFHEIV0
  1176     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1177     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1178     MOVE X'2020233030303031303234' TO DFHEIV0(25:11)
  1179     CALL 'kxdfhei1' USING DFHEIV0,
  1180           DFHEIV1,
  1181           DLO034-COMMUNICATION-AREA,
  1182           DLO034-REC-LENGTH,
  1183           DFHEIV99,
  1184           DFHEIV99,
  1185           DFHEIV99
  1186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1187         IF DL34-RETURN-CODE NOT = 'OK'
  1188             MOVE '8333'         TO EMI-ERROR
  1189             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1190
  1191* EXEC CICS RETURN
  1192*            END-EXEC.
  1193*    MOVE '.(                    &   #00001032' TO DFHEIV0
  1194     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1195     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1196     MOVE X'2020233030303031303332' TO DFHEIV0(25:11)
  1197     CALL 'kxdfhei1' USING DFHEIV0,
  1198           DFHEIV99,
  1199           DFHEIV99,
  1200           DFHEIV99,
  1201           DFHEIV99,
  1202           DFHEIV99
  1203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1204
  1205
  1206     IF WS-TERM-PREFIX = 'DU'
  1207
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL1792.cbl
  1208* EXEC CICS RETURN
  1209*            TRANSID  ('EX49')
  1210*            COMMAREA (PROGRAM-INTERFACE-BLOCK)
  1211*            LENGTH   (PI-COMM-LENGTH)
  1212*       END-EXEC
  1213     MOVE 'EX49' TO DFHEIV5
  1214*    MOVE '.(CT                  &   #00001036' TO DFHEIV0
  1215     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  1216     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1217     MOVE X'2020233030303031303336' TO DFHEIV0(25:11)
  1218     CALL 'kxdfhei1' USING DFHEIV0,
  1219           DFHEIV5,
  1220           PROGRAM-INTERFACE-BLOCK,
  1221           PI-COMM-LENGTH,
  1222           DFHEIV99,
  1223           DFHEIV99
  1224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1225     ELSE
  1226
  1227* EXEC CICS  RETURN
  1228*       END-EXEC.
  1229*    MOVE '.(                    &   #00001042' TO DFHEIV0
  1230     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1231     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1232     MOVE X'2020233030303031303432' TO DFHEIV0(25:11)
  1233     CALL 'kxdfhei1' USING DFHEIV0,
  1234           DFHEIV99,
  1235           DFHEIV99,
  1236           DFHEIV99,
  1237           DFHEIV99,
  1238           DFHEIV99
  1239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1240
  1241
  1242     MOVE ZEROS     TO RETURN-CODE.
  1243
  1244* GOBACK.
  1245     MOVE '9%                    "   ' TO DFHEIV0
  1246     MOVE 'EL1792' TO DFHEIV1
  1247     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1248     GOBACK.
  1249
  1250 9900-ERROR-FORMAT.
  1251
  1252     IF EMI-ERRORS-COMPLETE
  1253         GO TO 9900-EXIT.
  1254
  1255
  1256* EXEC CICS LINK
  1257*        PROGRAM   ('EL001')
  1258*        COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  1259*        LENGTH    (EMI-COMM-LENGTH)
  1260*    END-EXEC.
  1261     MOVE 'EL001' TO DFHEIV1
  1262*    MOVE '."C                   ''   #00001053' TO DFHEIV0
  1263     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1264     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1265     MOVE X'2020233030303031303533' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL1792.cbl
  1266     CALL 'kxdfhei1' USING DFHEIV0,
  1267           DFHEIV1,
  1268           ERROR-MESSAGE-INTERFACE-BLOCK,
  1269           EMI-COMM-LENGTH,
  1270           DFHEIV99,
  1271           DFHEIV99,
  1272           DFHEIV99
  1273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1274
  1275
  1276 9900-EXIT.
  1277     EXIT.
  1278
  1279 9990-ABEND.
  1280     MOVE DFHEIBLK               TO LOGOFF-FILL.
  1281
  1282
  1283* EXEC CICS LINK
  1284*        PROGRAM   ('EL004')
  1285*        COMMAREA  (LOGOFF-FILL)
  1286*        LENGTH    (66)
  1287*    END-EXEC.
  1288     MOVE 'EL004' TO DFHEIV1
  1289     MOVE 66
  1290       TO DFHEIV11
  1291*    MOVE '."C                   ''   #00001065' TO DFHEIV0
  1292     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1293     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1294     MOVE X'2020233030303031303635' TO DFHEIV0(25:11)
  1295     CALL 'kxdfhei1' USING DFHEIV0,
  1296           DFHEIV1,
  1297           LOGOFF-FILL,
  1298           DFHEIV11,
  1299           DFHEIV99,
  1300           DFHEIV99,
  1301           DFHEIV99
  1302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1303
  1304
  1305     GO TO 9100-RETURN-CICS.
  1306
  1307 9999-DFHBACK SECTION.
  1308     MOVE '9%                    "   ' TO DFHEIV0
  1309     MOVE 'EL1792' TO DFHEIV1
  1310     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1311     GOBACK.
  1312 9999-DFHEXIT.
  1313     IF DFHEIGDJ EQUAL 0001
  1314         NEXT SENTENCE
  1315     ELSE IF DFHEIGDJ EQUAL 2
  1316         GO TO 0100-FILE-NOT-OPEN,
  1317               9100-RETURN-CICS,
  1318               0200-COMM-AREA-NOT-FOUND,
  1319               9990-ABEND
  1320         DEPENDING ON DFHEIGDI
  1321     ELSE IF DFHEIGDJ EQUAL 3
  1322         GO TO 1000-END-OF-FILE
  1323         DEPENDING ON DFHEIGDI.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL1792.cbl
  1324     MOVE '9%                    "   ' TO DFHEIV0
  1325     MOVE 'EL1792' TO DFHEIV1
  1326     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1327     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5200     Code:        3476
