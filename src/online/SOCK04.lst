* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page   1
* SOCK04.cbl
* Options: int("SOCK04.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK04.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK04.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK04.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2015 by Central States Health and Life          *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK04.
     9*
    10*AUTHOR.    Cowtown.
    11*           Colleyville, TEXAS.
    12*REMARKS.
    13***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page   2
* SOCK04.cbl
    14***                                                            ***
    15***  This program acts as a Socket Server and expects a key    ***
    16***  to read an account master and a compensation master and   ***
    17***  will pass back a few items. It currently is designed to   ***
    18***  work with the Agent Signature Verification process.       ***
    19***                                                            ***
    20***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    21******************************************************************
    22*                   C H A N G E   L O G
    23*
    24* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    25*-----------------------------------------------------------------
    26*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    27* EFFECTIVE    NUMBER
    28*-----------------------------------------------------------------
    29* 031115  CR               PEMA  NEW PROGRAM
    30*-----------------------------------------------------------------
    31 environment division.
    32 data division.
    33 working-storage section.
    34 01  DFH-START PIC X(04).
    35*
    36* program buffers
    37*
    38 77 ws-send-msg-size           pic s9(8) comp value 4096.
    39 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    40 77 ws-recv-buf                pic x(4096).
    41 77 ws-send-buf                pic x(4096) VALUE SPACES.
    42 77 ws-recv-total              pic s9(8) comp value 0.
    43 77 ws-recv-left               pic s9(8) comp value 0.
    44 77 ws-seq-num                 pic s9(8) comp value 0.
    45 77 ws-flags                   pic s9(8) comp value 0.
    46 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    47 77 WS-COMP-ID                   PIC XXX VALUE 'CID'.
    48 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    49 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    50 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    51 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    52 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    53 77 a1                           PIC S999 COMP-3 VALUE +0.
    54 77 c1                           PIC S999 COMP-3 VALUE +0.
    55 77 WS-BUILD-SW                  PIC X.
    56    88  TIME-TO-BUILD               VALUE 'Y'.
    57 77 WS-SAVE-ERACCT               PIC X(2000).
    58 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    59 77 WS-PERFORM-SW                PIC X VALUE SPACES.
    60    88  GET-RATES                    VALUE 'R'.
    61    88  GET-ACT-ACCTS                VALUE 'A'.
    62 77 ws-bin-eff-dt                pic xx  value low-values.
    63 77 ws-bin-1st-pay-dt            pic xx  value low-values.
    64 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
    65 77 ws-disp-rate                 pic z9.99999.
    66 77  WS-ERACCT-SW                PIC X VALUE ' '.
    67     88  END-OF-ERACCT                 VALUE 'Y'.
    68 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    69     88  END-OF-ERCTBL                 VALUE 'Y'.
    70 77  WS-STATUS                   PIC X.
    71 77  ws-bin-cert-eff-dt          pic xx   value low-values.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page   3
* SOCK04.cbl
    72 77  ws-current-bin-dt           pic xx   value low-values.
    73 77  ws-cert-note-generic-key-len pic s9(4) comp value +34.
    74 77  note-count                  pic s999 comp-3 value +0.
    75 77  ws-build-note-sw            pic x value ' '.
    76     88  finished-with-notes      value 'Y'.
    77 77  ws-ercnot-sw                pic x  value spaces.
    78     88  ercnot-startbr            value 'Y'.
    79 01  ws-work-date.
    80     05  ws-work-ccyy            pic x(4).
    81     05  ws-work-mm              pic xx.
    82     05  ws-work-dd              pic xx.
    83 01  ws-work-date-num redefines ws-work-date
    84                                 pic 9(8).
    85 01  cert-note-records-holder.
    86     05  cert-note-record occurs 300.
    87         10  filler              pic x(48).
    88         10  cnr-rest            pic x(102).
    89 01  socket04-commarea.
    90*                                copy SOCK04-COMMAREA.
    91*****************************************************************
    92*                                                               *
    93* Copyright (c) 2015 by CSO.                                    *
    94* All rights reserved.                                          *
    95*                                                               *
    96*****************************************************************
    97****************************************
    98*  commarea for SOCK04.cl2
    99*  (business logic input & output)
   100****************************************
   101 03  socket-commarea.
   102     05 sock-IN-DATA.
   103         10  sock-CAR          PIC X.
   104         10  sock-GRP          PIC X(6).
   105         10  sock-ST           PIC XX.
   106         10  sock-ACT          PIC X(10).
   107         10  sock-EFF-DT       PIC X(8).
   108         10  sock-cert-no      pic x(11).
   109         10  sock-ID           PIC XXX.
   110         10  sock-proc-id      pic x(4).
   111         10  sock-ACTION-TAKEN PIC X.
   112         10  FILLER              PIC X(9).
   113     05  sock-return-area.
   114         10  sock-am-name        pic x(30).
   115         10  sock-am-person      pic x(30).
   116         10  sock-am-cntrl-name  pic x(30).
   117         10  sock-am-phone       pic x(10).
   118         10  sock-co-fax         pic x(10).
   119         10  sock-co-contact     pic x(30).
   120 01  WS-AM-KEY.
   121     05  WS-AM-COMPANY-CD        PIC X.
   122     05  WS-AM-CARRIER           PIC X.
   123     05  WS-AM-GROUP             PIC X(6).
   124     05  WS-AM-STATE             PIC XX.
   125     05  WS-AM-ACCOUNT           PIC X(10).
   126     05  WS-AM-EXP-DT            PIC XX.
   127     05  FILLER                  PIC X(4).
   128 01  WS-CO-KEY.
   129     05  WS-CO-COMPANY-CD        PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page   4
* SOCK04.cbl
   130     05  WS-CO-CARRIER           PIC X.
   131     05  WS-CO-GROUP             PIC X(6).
   132     05  WS-CO-FIN-RESP          PIC X(10).
   133     05  WS-CO-ACCOUNT           PIC X(10).
   134     05  WS-CO-TYPE              PIC X.
   135 01  WS-CM-KEY.
   136     05  WS-CM-COMPANY-CD        PIC X.
   137     05  WS-CM-CARRIER           PIC X.
   138     05  WS-CM-GROUP             PIC X(6).
   139     05  WS-CM-STATE             PIC XX.
   140     05  WS-CM-ACCOUNT           PIC X(10).
   141     05  WS-CM-EFF-DT            PIC XX.
   142     05  WS-CM-CERT-NO           PIC X(11).
   143 01  WS-CZ-KEY.
   144     05  WS-CZ-COMPANY-CD        PIC X.
   145     05  WS-CZ-CARRIER           PIC X.
   146     05  WS-CZ-GROUP             PIC X(6).
   147     05  WS-CZ-STATE             PIC XX.
   148     05  WS-CZ-ACCOUNT           PIC X(10).
   149     05  WS-CZ-EFF-DT            PIC XX.
   150     05  WS-CZ-CERT-NO           PIC X(11).
   151     05  WS-CZ-REC-TYPE          PIC X.
   152     05  ws-cz-note-seq          pic s9(4) comp.
   153 01  WS-CS-KEY.
   154     05  WS-CS-COMPANY-CD        PIC X.
   155     05  WS-CS-CARRIER           PIC X.
   156     05  WS-CS-GROUP             PIC X(6).
   157     05  WS-CS-STATE             PIC XX.
   158     05  WS-CS-ACCOUNT           PIC X(10).
   159     05  WS-CS-EFF-DT            PIC XX.
   160     05  WS-CS-CERT-NO           PIC X(11).
   161     05  WS-CS-TRLR-TYPE         PIC X.
   162 01  ws-return-stuff.
   163     05  ws-am-name              pic x(30).
   164     05  ws-am-person            pic x(30).
   165     05  ws-am-control-name      pic x(30).
   166     05  ws-am-phone             pic x(10).
   167     05  ws-co-fax               pic x(10).
   168     05  ws-co-contact           pic x(30).
   169 01  WS-CID-NO                   PIC X(8).
   170 01  WS-DISP-RESP                PIC 9(5).
   171 01  WS-RESPONSE                 PIC S9(8)   COMP.
   172     88  RESP-NORMAL                  VALUE +00.
   173     88  RESP-NOTFND                  VALUE +13.
   174     88  RESP-NOTOPEN                 VALUE +19.
   175     88  RESP-ENDFILE                 VALUE +20.
   176*                                 COPY ELCCERT.
   177******************************************************************
   178*                                                                *
   179*                            ELCCERT.                            *
   180*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   181*                            VMOD=2.013                          *
   182*                                                                *
   183*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   184*                                                                *
   185*   FILE TYPE = VSAM,KSDS                                        *
   186*   RECORD SIZE = 450  RECFORM = FIXED                           *
   187*                                                                *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page   5
* SOCK04.cbl
   188*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   189*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   190*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   191*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   192*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   193*                                                                *
   194*   LOG = YES                                                    *
   195*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   196******************************************************************
   197*                   C H A N G E   L O G
   198*
   199* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   200*-----------------------------------------------------------------
   201*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   202* EFFECTIVE    NUMBER
   203*-----------------------------------------------------------------
   204* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   205* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   206* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   207* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   208* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   209* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   210* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   211* 032612  CR2011110200001  PEMA  AHL CHANGES
   212* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   213******************************************************************
   214
   215 01  CERTIFICATE-MASTER.
   216     12  CM-RECORD-ID                      PIC XX.
   217         88  VALID-CM-ID                      VALUE 'CM'.
   218
   219     12  CM-CONTROL-PRIMARY.
   220         16  CM-COMPANY-CD                 PIC X.
   221         16  CM-CARRIER                    PIC X.
   222         16  CM-GROUPING.
   223             20  CM-GROUPING-PREFIX        PIC X(3).
   224             20  CM-GROUPING-PRIME         PIC X(3).
   225         16  CM-STATE                      PIC XX.
   226         16  CM-ACCOUNT.
   227             20  CM-ACCOUNT-PREFIX         PIC X(4).
   228             20  CM-ACCOUNT-PRIME          PIC X(6).
   229         16  CM-CERT-EFF-DT                PIC XX.
   230         16  CM-CERT-NO.
   231             20  CM-CERT-PRIME             PIC X(10).
   232             20  CM-CERT-SFX               PIC X.
   233
   234     12  CM-CONTROL-BY-NAME.
   235         16  CM-COMPANY-CD-A1              PIC X.
   236         16  CM-INSURED-LAST-NAME          PIC X(15).
   237         16  CM-INSURED-INITIALS.
   238             20  CM-INSURED-INITIAL1       PIC X.
   239             20  CM-INSURED-INITIAL2       PIC X.
   240
   241     12  CM-CONTROL-BY-SSN.
   242         16  CM-COMPANY-CD-A2              PIC X.
   243         16  CM-SOC-SEC-NO.
   244             20  CM-SSN-STATE              PIC XX.
   245             20  CM-SSN-ACCOUNT            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page   6
* SOCK04.cbl
   246             20  CM-SSN-LN3.
   247                 25  CM-INSURED-INITIALS-A2.
   248                     30 CM-INSURED-INITIAL1-A2   PIC X.
   249                     30 CM-INSURED-INITIAL2-A2   PIC X.
   250                 25 CM-PART-LAST-NAME-A2         PIC X.
   251
   252     12  CM-CONTROL-BY-CERT-NO.
   253         16  CM-COMPANY-CD-A4              PIC X.
   254         16  CM-CERT-NO-A4                 PIC X(11).
   255
   256     12  CM-CONTROL-BY-MEMB.
   257         16  CM-COMPANY-CD-A5              PIC X.
   258         16  CM-MEMBER-NO.
   259             20  CM-MEMB-STATE             PIC XX.
   260             20  CM-MEMB-ACCOUNT           PIC X(6).
   261             20  CM-MEMB-LN4.
   262                 25  CM-INSURED-INITIALS-A5.
   263                     30 CM-INSURED-INITIAL1-A5   PIC X.
   264                     30 CM-INSURED-INITIAL2-A5   PIC X.
   265                 25 CM-PART-LAST-NAME-A5         PIC XX.
   266
   267     12  CM-INSURED-PROFILE-DATA.
   268         16  CM-INSURED-FIRST-NAME.
   269             20  CM-INSURED-1ST-INIT       PIC X.
   270             20  FILLER                    PIC X(9).
   271         16  CM-INSURED-ISSUE-AGE          PIC 99.
   272         16  CM-INSURED-SEX                PIC X.
   273             88  CM-SEX-MALE                  VALUE 'M'.
   274             88  CM-SEX-FEMAL                 VALUE 'F'.
   275         16  CM-INSURED-JOINT-AGE          PIC 99.
   276         16  CM-JOINT-INSURED-NAME.
   277             20  CM-JT-LAST-NAME           PIC X(15).
   278             20  CM-JT-FIRST-NAME.
   279                 24  CM-JT-1ST-INIT        PIC X.
   280                 24  FILLER                PIC X(9).
   281             20  CM-JT-INITIAL             PIC X.
   282
   283     12  CM-LIFE-DATA.
   284         16  CM-LF-BENEFIT-CD              PIC XX.
   285         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   286         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   287         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   288         16  CM-LF-DEV-CODE                PIC XXX.
   289         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   290         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   291         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   292         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   293         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   294         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   295         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   296         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   297         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   298         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   299         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   300         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   301         16  cm-temp-epiq                  pic xx.
   302             88  EPIQ-CLASS                  value 'EQ'.
   303*        16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page   7
* SOCK04.cbl
   304
   305     12  CM-AH-DATA.
   306         16  CM-AH-BENEFIT-CD              PIC XX.
   307         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   308         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   309         16  CM-AH-DEV-CODE                PIC XXX.
   310         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   311         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   312         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   313         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   314         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   315         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   316         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   317         16  CM-AH-PAID-THRU-DT            PIC XX.
   318             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   319         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   320         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
   321         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   322         16  FILLER                        PIC X.
   323
   324     12  CM-LOAN-INFORMATION.
   325         16  CM-LIVES                      PIC S9(7)     COMP-3.
   326         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   327                                           PIC S9(5)V99  COMP-3.
   328         16  CM-BILLED                     PIC S9(7)     COMP-3.
   329         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   330         16  CM-PAY-FREQUENCY              PIC S99.
   331         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   332         16  CM-RATE-CLASS                 PIC XX.
   333         16  CM-BENEFICIARY                PIC X(25).
   334         16  CM-POLICY-FORM-NO             PIC X(12).
   335         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   336         16  CM-LAST-ADD-ON-DT             PIC XX.
   337         16  CM-DEDUCTIBLE-AMOUNTS.
   338             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   339             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   340         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   341             20  CM-RESIDENT-STATE         PIC XX.
   342             20  CM-RATE-CODE              PIC X(4).
   343             20  FILLER                    PIC XX.
   344         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   345             20  CM-LOAN-OFFICER           PIC X(5).
   346             20  FILLER                    PIC XXX.
   347         16  CM-CSR-CODE                   PIC XXX.
   348         16  CM-UNDERWRITING-CODE          PIC X.
   349             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   350         16  CM-POST-CARD-IND              PIC X.
   351         16  CM-NH-INTERFACE-SW            PIC X.
   352         16  CM-PREMIUM-TYPE               PIC X.
   353             88  CM-SING-PRM                  VALUE '1'.
   354             88  CM-O-B-COVERAGE              VALUE '2'.
   355             88  CM-OPEN-END                  VALUE '3'.
   356         16  CM-IND-GRP-TYPE               PIC X.
   357             88  CM-INDIVIDUAL                VALUE 'I'.
   358             88  CM-GROUP                     VALUE 'G'.
   359         16  CM-SKIP-CODE                  PIC X.
   360             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   361             88  SKIP-JULY                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page   8
* SOCK04.cbl
   362             88  SKIP-AUGUST                  VALUE '2'.
   363             88  SKIP-SEPTEMBER               VALUE '3'.
   364             88  SKIP-JULY-AUG                VALUE '4'.
   365             88  SKIP-AUG-SEPT                VALUE '5'.
   366             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   367             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   368             88  SKIP-JUNE                    VALUE '8'.
   369             88  SKIP-JUNE-JULY               VALUE '9'.
   370             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   371             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   372         16  CM-PAYMENT-MODE               PIC X.
   373             88  PAY-MONTHLY                  VALUE SPACE.
   374             88  PAY-WEEKLY                   VALUE '1'.
   375             88  PAY-SEMI-MONTHLY             VALUE '2'.
   376             88  PAY-BI-WEEKLY                VALUE '3'.
   377             88  PAY-SEMI-ANUALLY             VALUE '4'.
   378         16  CM-LOAN-NUMBER                PIC X(8).
   379         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   380         16  CM-OLD-LOF                    PIC XXX.
   381*        16  CM-LOAN-OFFICER               PIC XXX.
   382         16  CM-REIN-TABLE                 PIC XXX.
   383         16  CM-SPECIAL-REIN-CODE          PIC X.
   384         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   385         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   386         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   387
   388     12  CM-STATUS-DATA.
   389         16  CM-ENTRY-STATUS               PIC X.
   390         16  CM-ENTRY-DT                   PIC XX.
   391
   392         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   393         16  CM-LF-CANCEL-DT               PIC XX.
   394         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   395
   396         16  CM-LF-STATUS-AT-DEATH         PIC X.
   397         16  CM-LF-DEATH-DT                PIC XX.
   398         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   399
   400         16  CM-LF-CURRENT-STATUS          PIC X.
   401             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   402                                                'M' '4' '5' '9'.
   403             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   404             88  CM-LF-POLICY-PENDING         VALUE '2'.
   405             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   406             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   407             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   408             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   409             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   410             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   411             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   412             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   413             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   414             88  CM-LF-DECLINED               VALUE 'D'.
   415             88  CM-LF-VOIDED                 VALUE 'V'.
   416
   417         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   418         16  CM-AH-CANCEL-DT               PIC XX.
   419         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page   9
* SOCK04.cbl
   420
   421         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   422         16  CM-AH-SETTLEMENT-DT           PIC XX.
   423         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   424
   425         16  CM-AH-CURRENT-STATUS          PIC X.
   426             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   427                                                'M' '4' '5' '9'.
   428             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   429             88  CM-AH-POLICY-PENDING         VALUE '2'.
   430             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   431             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   432             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   433             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   434             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   435             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   436             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   437             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   438             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   439             88  CM-AH-DECLINED               VALUE 'D'.
   440             88  CM-AH-VOIDED                 VALUE 'V'.
   441
   442         16  CM-CLAIM-INTERFACE-SW         PIC X.
   443             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   444             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   445             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   446         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   447
   448         16  CM-ENTRY-BATCH                PIC X(6).
   449         16  CM-LF-EXIT-BATCH              PIC X(6).
   450         16  CM-AH-EXIT-BATCH              PIC X(6).
   451         16  CM-LAST-MONTH-END             PIC XX.
   452
   453     12  CM-NOTE-SW                        PIC X.
   454         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   455         88  CERT-NOTES-PRESENT               VALUE '1'.
   456         88  BILLING-NOTES-PRESENT            VALUE '2'.
   457         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   458         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   459         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   460         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   461         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   462     12  CM-COMP-EXCP-SW                   PIC X.
   463         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   464         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   465     12  CM-INSURED-ADDRESS-SW             PIC X.
   466         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   467         88  INSURED-ADDR-PRESENT             VALUE '1'.
   468
   469*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   470     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   471     12  FILLER                            PIC X.
   472
   473*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   474     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   475     12  FILLER                            PIC X.
   476*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   477     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  10
* SOCK04.cbl
   478
   479     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   480         88  CERT-ADDED-BATCH                 VALUE ' '.
   481         88  CERT-ADDED-ONLINE                VALUE '1'.
   482         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   483         88  CERT-PURGED-OFFLINE              VALUE '3'.
   484         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   485     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   486         88  CERT-AS-LOADED                   VALUE ' '.
   487         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   488         88  CERT-CLAIM-ONLINE                VALUE '2'.
   489         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   490         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   491         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   492         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   493         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   494
   495     12  CM-ACCOUNT-COMM-PCTS.
   496         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   497         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   498
   499     12  CM-USER-FIELD                     PIC X.
   500     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   501     12  CM-CLP-STATE                      PIC XX.
   502     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   503     12  CM-USER-RESERVED                  PIC XXX.
   504     12  FILLER REDEFINES CM-USER-RESERVED.
   505         16  CM-AH-CLASS-CD                PIC XX.
   506         16  F                             PIC X.
   507******************************************************************
   508*                                 COPY ELCCRTT.
   509******************************************************************
   510*                                                                *
   511*                            ELCCRTT.                            *
   512*                                                                *
   513*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
   514*                                                                *
   515*   FILE TYPE = VSAM,KSDS                                        *
   516*   RECORD SIZE = 552  RECFORM = FIXED                           *
   517*                                                                *
   518*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
   519*                                                                *
   520*   LOG = YES                                                    *
   521*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   522******************************************************************
   523*                   C H A N G E   L O G
   524*
   525* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   526*-----------------------------------------------------------------
   527*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   528* EFFECTIVE    NUMBER
   529*-----------------------------------------------------------------
   530* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
   531* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
   532* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   533* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   534* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
   535* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  11
* SOCK04.cbl
   536* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   537* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
   538******************************************************************
   539
   540 01  CERTIFICATE-TRAILERS.
   541     12  CS-RECORD-ID                      PIC XX.
   542         88  VALID-CS-ID                      VALUE 'CS'.
   543
   544     12  CS-CONTROL-PRIMARY.
   545         16  CS-COMPANY-CD                 PIC X.
   546         16  CS-CARRIER                    PIC X.
   547         16  CS-GROUPING                   PIC X(6).
   548         16  CS-STATE                      PIC XX.
   549         16  CS-ACCOUNT                    PIC X(10).
   550         16  CS-CERT-EFF-DT                PIC XX.
   551         16  CS-CERT-NO.
   552             20  CS-CERT-PRIME             PIC X(10).
   553             20  CS-CERT-SFX               PIC X.
   554         16  CS-TRAILER-TYPE               PIC X.
   555             88  COMM-TRLR           VALUE 'A'.
   556             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
   557             88  CERT-DATA-TRLR      VALUE 'C'.
   558
   559     12  CS-DATA-AREA                      PIC X(516).
   560
   561     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
   562         16  CS-BANK-COMMISSION-AREA.
   563             20  CS-BANK-COMMS       OCCURS 10.
   564                 24  CS-AGT                PIC X(10).
   565                 24  CS-COM-TYP            PIC X.
   566                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
   567                 24  CS-RECALC-LV-INDIC    PIC X.
   568                 24  FILLER                PIC X(10).
   569         16  FILLER                        PIC X(256).
   570
   571     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
   572****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
   573         16  CS-MB-CLAIM-DATA OCCURS 24.
   574             20  CS-CLAIM-NO               PIC X(7).
   575             20  CS-CLAIM-TYPE             PIC X.
   576                 88  CS-AH-CLM               VALUE 'A'.
   577                 88  CS-IU-CLM               VALUE 'I'.
   578                 88  CS-GP-CLM               VALUE 'G'.
   579                 88  CS-LF-CLM               VALUE 'L'.
   580                 88  CS-PR-CLM               VALUE 'P'.
   581                 88  CS-FL-CLM               VALUE 'F'.
   582             20  CS-INSURED-TYPE           PIC X.
   583                 88  CS-PRIM-INSURED          VALUE 'P'.
   584                 88  CS-CO-BORROWER           VALUE 'C'.
   585             20  CS-BENEFIT-PERIOD         PIC 99.
   586             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
   587             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
   588             20  CS-REMAINING-BENS         PIC S999 COMP-3.
   589         16  FILLER                        PIC X(12).
   590     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
   591         16  CS-VIN-NUMBER                 PIC X(17).
   592         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
   593         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  12
* SOCK04.cbl
   594         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
   595         16  cs-agent-name.
   596             20  cs-agent-fname            pic x(20).
   597             20  cs-agent-mi               pic x.
   598             20  cs-agent-lname            pic x(25).
   599         16  cs-license-no                 pic x(15).
   600         16  cs-npn-number                 pic x(10).
   601         16  cs-agent-edit-status          pic x.
   602             88  cs-ae-refer-to-manager      value 'M'.
   603             88  cs-ae-cover-sheet           value 'C'.
   604             88  cs-ae-sig-form              value 'S'.
   605             88  cs-ae-verified              value 'V'.
   606             88  cs-unidentified-signature   value 'U'.
   607             88  cs-cert-returned            value 'R'.
   608             88  cs-accept-no-commission     value 'N'.
   609         16  FILLER                        PIC X(424).
   610*        16  FILLER                        PIC X(496).
   611*                                 COPY ERCACCT.
   612******************************************************************
   613*                                                                *
   614*                                                                *
   615*                            ERCACCT                             *
   616*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   617*                            VMOD=2.031                          *
   618*                                                                *
   619*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   620*                                                                *
   621*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   622*   VSAM ACCOUNT MASTER FILES.                                   *
   623*                                                                *
   624*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   625*                                                                *
   626*   FILE TYPE = VSAM,KSDS                                        *
   627*   RECORD SIZE = 2000  RECFORM = FIX                            *
   628*                                                                *
   629*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   630*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   631*                                                                *
   632*   LOG = NO                                                     *
   633*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   634*                                                                *
   635*                                                                *
   636******************************************************************
   637*                   C H A N G E   L O G
   638*
   639* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   640*-----------------------------------------------------------------
   641*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   642* EFFECTIVE    NUMBER
   643*-----------------------------------------------------------------
   644* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   645* 092705    2005050300006  PEMA  ADD SPP LEASES
   646* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   647* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   648* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   649* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   650* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   651******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  13
* SOCK04.cbl
   652
   653 01  ACCOUNT-MASTER.
   654     12  AM-RECORD-ID                      PIC XX.
   655         88  VALID-AM-ID                      VALUE 'AM'.
   656
   657     12  AM-CONTROL-PRIMARY.
   658         16  AM-COMPANY-CD                 PIC X.
   659         16  AM-MSTR-CNTRL.
   660             20  AM-CONTROL-A.
   661                 24  AM-CARRIER            PIC X.
   662                 24  AM-GROUPING.
   663                     28 AM-GROUPING-PREFIX PIC XXX.
   664                     28 AM-GROUPING-PRIME  PIC XXX.
   665                 24  AM-STATE              PIC XX.
   666                 24  AM-ACCOUNT.
   667                     28  AM-ACCOUNT-PREFIX PIC X(4).
   668                     28  AM-ACCOUNT-PRIME  PIC X(6).
   669             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   670                                           PIC X(19).
   671             20  AM-CNTRL-B.
   672                 24  AM-EXPIRATION-DT      PIC XX.
   673                 24  FILLER                PIC X(4).
   674             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   675                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   676
   677     12  AM-CONTROL-BY-VAR-GRP.
   678         16  AM-COMPANY-CD-A1              PIC X.
   679         16  AM-VG-CARRIER                 PIC X.
   680         16  AM-VG-GROUPING                PIC X(6).
   681         16  AM-VG-STATE                   PIC XX.
   682         16  AM-VG-ACCOUNT                 PIC X(10).
   683         16  AM-VG-DATE.
   684             20  AM-VG-EXPIRATION-DT       PIC XX.
   685             20  FILLER                    PIC X(4).
   686         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   687                                           PIC 9(11)      COMP-3.
   688     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   689         16  FILLER                        PIC X(10).
   690         16  AM-VG-KEY3.
   691             20  AM-VG3-ACCOUNT            PIC X(10).
   692             20  AM-VG3-EXP-DT             PIC XX.
   693         16  FILLER                        PIC X(4).
   694     12  AM-MAINT-INFORMATION.
   695         16  AM-LAST-MAINT-DT              PIC XX.
   696         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   697         16  AM-LAST-MAINT-USER            PIC X(4).
   698         16  FILLER                        PIC XX.
   699
   700     12  AM-EFFECTIVE-DT                   PIC XX.
   701     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   702
   703     12  AM-PREV-DATES  COMP-3.
   704         16  AM-PREV-EXP-DT                PIC 9(11).
   705         16  AM-PREV-EFF-DT                PIC 9(11).
   706
   707     12  AM-REPORT-CODE-1                  PIC X(10).
   708     12  AM-REPORT-CODE-2                  PIC X(10).
   709
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  14
* SOCK04.cbl
   710     12  AM-CITY-CODE                      PIC X(4).
   711     12  AM-COUNTY-PARISH                  PIC X(6).
   712
   713     12  AM-NAME                           PIC X(30).
   714     12  AM-PERSON                         PIC X(30).
   715     12  AM-ADDRS                          PIC X(30).
   716     12  AM-CITY.
   717         16  AM-ADDR-CITY                  PIC X(28).
   718         16  AM-ADDR-STATE                 PIC XX.
   719     12  AM-ZIP.
   720         16  AM-ZIP-PRIME.
   721             20  AM-ZIP-PRI-1ST            PIC X.
   722                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   723             20  FILLER                    PIC X(4).
   724         16  AM-ZIP-PLUS4                  PIC X(4).
   725     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   726         16  AM-CAN-POSTAL-1               PIC XXX.
   727         16  AM-CAN-POSTAL-2               PIC XXX.
   728         16  FILLER                        PIC XXX.
   729     12  AM-TEL-NO.
   730         16  AM-AREA-CODE                  PIC 999.
   731         16  AM-TEL-PRE                    PIC 999.
   732         16  AM-TEL-NBR                    PIC 9(4).
   733     12  AM-TEL-LOC                        PIC X.
   734         88  AM-TEL-AT-HOME                   VALUE 'H'.
   735         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   736
   737     12  AM-COMM-STRUCTURE.
   738         16  AM-DEFN-1.
   739             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   740                 24  AM-AGT.
   741                     28  AM-AGT-PREFIX     PIC X(4).
   742                     28  AM-AGT-PRIME      PIC X(6).
   743                 24  AM-COM-TYP            PIC X.
   744                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   745                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   746                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   747                 24  AM-RECALC-LV-INDIC    PIC X.
   748                 24  AM-RETRO-LV-INDIC     PIC X.
   749                 24  AM-GL-CODES           PIC X.
   750                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   751                 24  FILLER                PIC X(01).
   752         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   753             20  AM-COM-TBLS        OCCURS 10 TIMES.
   754                 24  FILLER                PIC X(11).
   755                 24  AM-L-COMA             PIC XXX.
   756                 24  AM-J-COMA             PIC XXX.
   757                 24  AM-A-COMA             PIC XXX.
   758                 24  FILLER                PIC X(6).
   759
   760     12  AM-COMM-CHANGE-STATUS             PIC X.
   761         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   762
   763     12  AM-CSR-CODE                       PIC X(4).
   764
   765     12  AM-BILLING-STATUS                 PIC X.
   766         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   767         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  15
* SOCK04.cbl
   768     12  AM-AUTO-REFUND-SW                 PIC X.
   769         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   770         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   771     12  AM-GPCD                           PIC 99.
   772     12  AM-IG                             PIC X.
   773         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   774         88  AM-HAS-GROUP                     VALUE '2'.
   775     12  AM-STATUS                         PIC X.
   776         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   777         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
   778         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
   779         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   780         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   781         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   782     12  AM-REMIT-TO                       PIC 99.
   783     12  AM-ID-NO                          PIC X(11).
   784
   785     12  AM-CAL-TABLE                      PIC XX.
   786     12  AM-LF-DEVIATION                   PIC XXX.
   787     12  AM-AH-DEVIATION                   PIC XXX.
   788     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   789     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   790     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   791     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   792     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   793     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   794
   795     12  AM-USER-FIELDS.
   796         16  AM-FLD-1                      PIC XX.
   797         16  AM-FLD-2                      PIC XX.
   798         16  AM-FLD-3                      PIC XX.
   799         16  AM-FLD-4                      PIC XX.
   800         16  AM-FLD-5                      PIC XX.
   801
   802     12  AM-1ST-PROD-DATE.
   803         16  AM-1ST-PROD-YR                PIC XX.
   804         16  AM-1ST-PROD-MO                PIC XX.
   805         16  AM-1ST-PROD-DA                PIC XX.
   806     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   807     12  AM-CERTS-PURGED-DATE.
   808         16  AM-PUR-YR                     PIC XX.
   809         16  AM-PUR-MO                     PIC XX.
   810         16  AM-PUR-DA                     PIC XX.
   811     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   812     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
   813     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   814     12  AM-INACTIVE-DATE.
   815         16  AM-INA-MO                     PIC 99.
   816         16  AM-INA-DA                     PIC 99.
   817         16  AM-INA-YR                     PIC 99.
   818     12  AM-AR-HI-CERT-DATE                PIC XX.
   819
   820     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   821     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   822
   823     12  AM-OB-PAYMENT-MODE                PIC X.
   824         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
   825         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  16
* SOCK04.cbl
   826         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   827         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   828
   829     12  AM-AH-ONLY-INDICATOR              PIC X.
   830         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   831         88  AM-NO-AH-ONLY                    VALUE 'N'.
   832
   833     12  AM-EDIT-LOAN-OFC                  PIC X(01).
   834
   835     12  AM-OVER-SHORT.
   836         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
   837         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
   838
   839     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   840     12  AM-DCC-CLP-STATE                  PIC XX.
   841
   842     12  AM-RECALC-COMM                    PIC X.
   843     12  AM-RECALC-REIN                    PIC X.
   844
   845     12  AM-REI-TABLE                      PIC XXX.
   846     12  AM-REI-ET-LF                      PIC X.
   847     12  AM-REI-ET-AH                      PIC X.
   848     12  AM-REI-PE-LF                      PIC X.
   849     12  AM-REI-PE-AH                      PIC X.
   850     12  AM-REI-PRT-ST                     PIC X.
   851     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
   852     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   853     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   854     12  AM-REI-GROUP-A                    PIC X(6).
   855     12  AM-REI-MORT                       PIC X(4).
   856     12  AM-REI-PRT-OW                     PIC X.
   857     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   858     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   859     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   860     12  AM-REI-GROUP-B                    PIC X(6).
   861
   862     12  AM-TRUST-TYPE                     PIC X(2).
   863
   864     12  AM-EMPLOYER-STMT-USED             PIC X.
   865     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   866
   867     12  AM-STD-AH-TYPE                    PIC XX.
   868     12  AM-EARN-METHODS.
   869         16  AM-EARN-METHOD-R              PIC X.
   870             88 AM-REF-RL-R78                 VALUE 'R'.
   871             88 AM-REF-RL-PR                  VALUE 'P'.
   872             88 AM-REF-RL-MEAN                VALUE 'M'.
   873             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   874         16  AM-EARN-METHOD-L              PIC X.
   875             88 AM-REF-LL-R78                 VALUE 'R'.
   876             88 AM-REF-LL-PR                  VALUE 'P'.
   877             88 AM-REF-LL-MEAN                VALUE 'M'.
   878             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   879         16  AM-EARN-METHOD-A              PIC X.
   880             88 AM-REF-AH-R78                 VALUE 'R'.
   881             88 AM-REF-AH-PR                  VALUE 'P'.
   882             88 AM-REF-AH-MEAN                VALUE 'M'.
   883             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  17
* SOCK04.cbl
   884             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   885             88 AM-REF-AH-NET                 VALUE 'N'.
   886
   887     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
   888     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   889     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   890
   891     12  AM-RET-Y-N                        PIC X.
   892     12  AM-RET-P-E                        PIC X.
   893     12  AM-LF-RET                         PIC S9V9999    COMP-3.
   894     12  AM-AH-RET                         PIC S9V9999    COMP-3.
   895     12  AM-RET-GRP                        PIC X(6).
   896     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
   897         16  AM-POOL-PRIME                 PIC XXX.
   898         16  AM-POOL-SUB                   PIC XXX.
   899     12  AM-RETRO-EARNINGS.
   900         16  AM-RET-EARN-R                 PIC X.
   901         16  AM-RET-EARN-L                 PIC X.
   902         16  AM-RET-EARN-A                 PIC X.
   903     12  AM-RET-ST-TAX-USE                 PIC X.
   904         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
   905         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
   906     12  AM-RETRO-BEG-EARNINGS.
   907         16  AM-RET-BEG-EARN-R             PIC X.
   908         16  AM-RET-BEG-EARN-L             PIC X.
   909         16  AM-RET-BEG-EARN-A             PIC X.
   910     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
   911     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
   912
   913     12  AM-USER-SELECT-OPTIONS.
   914         16  AM-USER-SELECT-1              PIC X(10).
   915         16  AM-USER-SELECT-2              PIC X(10).
   916         16  AM-USER-SELECT-3              PIC X(10).
   917         16  AM-USER-SELECT-4              PIC X(10).
   918         16  AM-USER-SELECT-5              PIC X(10).
   919
   920     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   921
   922     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   923
   924     12  AM-RPT045A-SWITCH                 PIC X.
   925         88  RPT045A-OFF                   VALUE 'N'.
   926
   927     12  AM-INSURANCE-LIMITS.
   928         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
   929         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
   930
   931     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
   932         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
   933
   934     12  AM-DISMBR-COVERAGE-SW             PIC X.
   935         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
   936         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
   937
   938     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
   939
   940     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
   941     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  18
* SOCK04.cbl
   942     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   943     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   944     12  AM-DCC-UEF-STATE                  PIC XX.
   945     12  FILLER                            PIC XXX.
   946     12  AM-REPORT-CODE-3                  PIC X(10).
   947*    12  FILLER                            PIC X(22).
   948
   949     12  AM-RESERVE-DATE.
   950         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
   951         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
   952         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
   953
   954     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
   955     12  AM-NOTIFICATION-TYPES.
   956         16  AM-NOTIF-OF-LETTERS           PIC X.
   957         16  AM-NOTIF-OF-PAYMENTS          PIC X.
   958         16  AM-NOTIF-OF-REPORTS           PIC X.
   959         16  AM-NOTIF-OF-STATUS            PIC X.
   960
   961     12  AM-BENEFIT-TABLE-USAGE            PIC X.
   962         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
   963         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
   964         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
   965         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
   966
   967     12  AM-BENEFIT-CONTROLS.
   968         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
   969             20  AM-BENEFIT-CODE           PIC XX.
   970             20  AM-BENEFIT-TYPE           PIC X.
   971             20  AM-BENEFIT-REVISION       PIC XXX.
   972             20  AM-BENEFIT-REM-TERM       PIC X.
   973             20  AM-BENEFIT-RETRO-Y-N      PIC X.
   974             20  FILLER                    PIC XX.
   975         16  FILLER                        PIC X(80).
   976
   977     12  AM-TRANSFER-DATA.
   978         16  AM-TRANSFERRED-FROM.
   979             20  AM-TRNFROM-CARRIER        PIC X.
   980             20  AM-TRNFROM-GROUPING.
   981                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
   982                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
   983             20  AM-TRNFROM-STATE          PIC XX.
   984             20  AM-TRNFROM-ACCOUNT.
   985                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
   986                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
   987             20  AM-TRNFROM-DTE            PIC XX.
   988         16  AM-TRANSFERRED-TO.
   989             20  AM-TRNTO-CARRIER          PIC X.
   990             20  AM-TRNTO-GROUPING.
   991                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
   992                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
   993             20  AM-TRNTO-STATE            PIC XX.
   994             20  AM-TRNTO-ACCOUNT.
   995                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
   996                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
   997             20  AM-TRNTO-DTE              PIC XX.
   998         16  FILLER                        PIC X(10).
   999
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  19
* SOCK04.cbl
  1000     12  AM-SAVED-REMIT-TO                 PIC 99.
  1001
  1002     12  AM-COMM-STRUCTURE-SAVED.
  1003         16  AM-DEFN-1-SAVED.
  1004             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1005                 24  AM-AGT-SV             PIC X(10).
  1006                 24  AM-COM-TYP-SV         PIC X.
  1007                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1008                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1009                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1010                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1011                 24  FILLER                PIC X.
  1012                 24  AM-GL-CODES-SV        PIC X.
  1013                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1014                 24  FILLER                PIC X.
  1015         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1016             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1017                 24  FILLER                PIC X(11).
  1018                 24  AM-L-COMA-SV          PIC XXX.
  1019                 24  AM-J-COMA-SV          PIC XXX.
  1020                 24  AM-A-COMA-SV          PIC XXX.
  1021                 24  FILLER                PIC X(6).
  1022
  1023     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1024         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1025            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1026            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1027            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1028
  1029     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1030     12  FILLER                            PIC X(120).
  1031
  1032     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1033         16  AM-CONTROL-NAME               PIC X(30).
  1034         16  AM-EXECUTIVE-ONE.
  1035             20  AM-EXEC1-NAME             PIC X(15).
  1036             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1037                                                          COMP-3.
  1038             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1039                                                          COMP-3.
  1040         16  AM-EXECUTIVE-TWO.
  1041             20  AM-EXEC2-NAME             PIC X(15).
  1042             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1043                                                          COMP-3.
  1044             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1045                                                          COMP-3.
  1046
  1047     12  AM-RETRO-ADDITIONAL-DATA.
  1048         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1049         16  AM-RETRO-PREM-P-E             PIC X.
  1050         16  AM-RETRO-CLMS-P-I             PIC X.
  1051         16  AM-RETRO-RET-BRACKET-LF.
  1052             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1053                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1054                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1055             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1056                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1057                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  20
* SOCK04.cbl
  1058             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1059                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1060                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1061         16  AM-RETRO-RET-BRACKET-AH.
  1062             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1063                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1064                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1065                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1066             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1067                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1068                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1069             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1070                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1071                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1072
  1073     12  AM-COMMENTS.
  1074         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1075
  1076     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1077         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1078         16  AM-FLI-BILLING-CODE           PIC X.
  1079         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1080         16  AM-FLI-UNITED-IDENT           PIC X.
  1081         16  AM-FLI-INTEREST-LOST-DATA.
  1082             20  AM-FLI-BANK-NO            PIC X(5).
  1083             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1084             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1085             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1086         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1087             20  AM-FLI-AGT                PIC X(9).
  1088             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1089             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1090         16  FILLER                        PIC X(102).
  1091
  1092     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1093         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1094             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1095             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1096             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1097             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1098             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1099         16  FILLER                          PIC X(10).
  1100******************************************************************
  1101*                                 COPY ERCCOMP.
  1102******************************************************************
  1103*                                                                *
  1104*                                                                *
  1105*                            ERCCOMP                             *
  1106*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1107*                            VMOD=2.019                          *
  1108*                                                                *
  1109*   ONLINE CREDIT SYSTEM                                         *
  1110*                                                                *
  1111*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1112*                                                                *
  1113*   FILE TYPE = VSAM,KSDS                                        *
  1114*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1115*                                                                *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  21
* SOCK04.cbl
  1116*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1117*       ALTERNATE PATH = NONE                                    *
  1118*                                                                *
  1119*   LOG = NO                                                     *
  1120*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1121*                                                                *
  1122******************************************************************
  1123*                   C H A N G E   L O G
  1124*
  1125* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1126*-----------------------------------------------------------------
  1127*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1128* EFFECTIVE    NUMBER
  1129*-----------------------------------------------------------------
  1130* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1131* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1132* 092205    2005050300006  PEMA  ADD LEASE FEE
  1133* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1134* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1135* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1136* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1137* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1138* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1139******************************************************************
  1140
  1141 01  COMPENSATION-MASTER.
  1142     12  CO-RECORD-ID                          PIC XX.
  1143         88  VALID-CO-ID                          VALUE 'CO'.
  1144
  1145     12  CO-CONTROL-PRIMARY.
  1146         16  CO-COMPANY-CD                     PIC X.
  1147         16  CO-CONTROL.
  1148             20  CO-CTL-1.
  1149                 24  CO-CARR-GROUP.
  1150                     28  CO-CARRIER            PIC X.
  1151                     28  CO-GROUPING.
  1152                         32  CO-GROUP-PREFIX   PIC XXX.
  1153                         32  CO-GROUP-PRIME    PIC XXX.
  1154                 24  CO-RESP-NO.
  1155                     28  CO-RESP-PREFIX        PIC X(4).
  1156                     28  CO-RESP-PRIME         PIC X(6).
  1157             20  CO-CTL-2.
  1158                 24  CO-ACCOUNT.
  1159                     28  CO-ACCT-PREFIX        PIC X(4).
  1160                     28  CO-ACCT-PRIME         PIC X(6).
  1161         16  CO-TYPE                           PIC X.
  1162             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1163             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1164             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1165
  1166     12  CO-MAINT-INFORMATION.
  1167         16  CO-LAST-MAINT-DT                  PIC XX.
  1168         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1169         16  CO-LAST-MAINT-USER                PIC X(4).
  1170     12  FILLER                                PIC XX.
  1171     12  CO-STMT-TYPE                          PIC XXX.
  1172     12  CO-COMP-TYPE                          PIC X.
  1173         88  CO-COMP-IS-SPPDD                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  22
* SOCK04.cbl
  1174     12  CO-STMT-OWNER                         PIC X(4).
  1175     12  CO-BALANCE-CONTROL                    PIC X.
  1176         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1177         88  CO-NO-BALANCE                        VALUE 'N'.
  1178
  1179     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1180         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1181         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1182         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1183
  1184     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1185         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1186         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1187
  1188     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1189     12  CO-GA-DIRECT-DEP                      PIC X.
  1190     12  CO-FUTURE-SPACE                       PIC X.
  1191         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1192
  1193     12  CO-ACCT-NAME                          PIC X(30).
  1194     12  CO-MAIL-NAME                          PIC X(30).
  1195     12  CO-ADDR-1                             PIC X(30).
  1196     12  CO-ADDR-2                             PIC X(30).
  1197     12  CO-ADDR-3.
  1198         16  CO-ADDR-CITY                      PIC X(27).
  1199         16  CO-ADDR-STATE                     PIC XX.
  1200     12  CO-CSO-1099                           PIC X.
  1201     12  CO-ZIP.
  1202         16  CO-ZIP-PRIME.
  1203             20  CO-ZIP-PRI-1ST                PIC X.
  1204                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1205             20  FILLER                        PIC X(4).
  1206         16  CO-ZIP-PLUS4                      PIC X(4).
  1207     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1208         16  CO-CAN-POSTAL-1                   PIC XXX.
  1209         16  CO-CAN-POSTAL-2                   PIC XXX.
  1210         16  FILLER                            PIC XXX.
  1211     12  CO-SOC-SEC                            PIC X(13).
  1212     12  CO-TELEPHONE.
  1213         16  CO-AREA-CODE                      PIC XXX.
  1214         16  CO-PREFIX                         PIC XXX.
  1215         16  CO-PHONE                          PIC X(4).
  1216
  1217     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1218
  1219     12  CO-AR-BAL-LEVEL                       PIC X.
  1220         88  CO-AR-REF-LVL                        VALUE '1'.
  1221         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1222         88  CO-AR-BILL-LVL                       VALUE '2'.
  1223         88  CO-AR-AGT-LVL                        VALUE '3'.
  1224         88  CO-AR-FR-LVL                         VALUE '4'.
  1225
  1226     12  CO-AR-NORMAL-PRINT                    PIC X.
  1227         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1228         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1229
  1230     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1231
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  23
* SOCK04.cbl
  1232     12  CO-AR-REPORTING                       PIC X.
  1233         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1234         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1235
  1236     12  CO-AR-PULL-CHECK                      PIC X.
  1237         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1238         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1239
  1240     12  CO-AR-BALANCE-PRINT                   PIC X.
  1241         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1242
  1243     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1244         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1245         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1246         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1247
  1248     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1249
  1250     12  CO-USER-CODE                          PIC X.
  1251     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1252
  1253******************************************************************
  1254*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1255*    THE LAST MONTH END RUN.
  1256******************************************************************
  1257
  1258     12  CO-LAST-ACTIVITY-DATE.
  1259         16  CO-ACT-YEAR                       PIC 99.
  1260         16  CO-ACT-MONTH                      PIC 99.
  1261         16  CO-ACT-DAY                        PIC 99.
  1262
  1263     12  CO-LAST-STMT-DT.
  1264         16  CO-LAST-STMT-YEAR                 PIC 99.
  1265         16  CO-LAST-STMT-MONTH                PIC 99.
  1266         16  CO-LAST-STMT-DAY                  PIC 99.
  1267
  1268     12  CO-MO-END-TOTALS.
  1269         16  CO-MONTHLY-TOTALS.
  1270             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1271             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1272             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1273             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1274             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1275
  1276         16  CO-AGING-TOTALS.
  1277             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1278             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1279             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1280             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1281
  1282         16  CO-YTD-TOTALS.
  1283             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1284             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1285
  1286         16  CO-OVER-UNDER-TOTALS.
  1287             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1288             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1289
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  24
* SOCK04.cbl
  1290     12  CO-MISCELLANEOUS-TOTALS.
  1291         16  CO-FICA-TOTALS.
  1292             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1293             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1294
  1295         16  CO-CLAIM-TOTALS.
  1296             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1297             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1298
  1299******************************************************************
  1300*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1301*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1302******************************************************************
  1303
  1304     12  CO-CURRENT-TOTALS.
  1305         16  CO-CURRENT-LAST-STMT-DT.
  1306             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1307             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1308             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1309
  1310         16  CO-CURRENT-MONTHLY-TOTALS.
  1311             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1312             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1313             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1314             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1315             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1316
  1317         16  CO-CURRENT-AGING-TOTALS.
  1318             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1319             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1320             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1321             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1322
  1323         16  CO-CURRENT-YTD-TOTALS.
  1324             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1325             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1326
  1327     12  CO-PAID-COMM-TOTALS.
  1328         16  CO-YTD-PAID-COMMS.
  1329             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1330             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1331
  1332     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1333         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1334         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1335
  1336     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1337         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1338         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1339         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1340         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1341         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1342         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1343         88  CO-FINAL-LETTER                  VALUE 'F'.
  1344         88  CO-RECONCILING                   VALUE 'R'.
  1345         88  CO-PHONE-CALL                    VALUE 'P'.
  1346         88  CO-LEGAL                         VALUE 'L'.
  1347         88  CO-COLLECTION-AGENCY             VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  25
* SOCK04.cbl
  1348         88  CO-WRITE-OFF                     VALUE 'W'.
  1349         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1350
  1351     12  CO-CSR-CODE                       PIC X(4).
  1352
  1353     12  CO-GA-STATUS-INFO.
  1354         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1355         16  CO-GA-TERMINATION-DT          PIC XX.
  1356         16  CO-GA-STATUS-CODE             PIC X.
  1357             88  CO-GA-ACTIVE                 VALUE 'A'.
  1358             88  CO-GA-INACTIVE               VALUE 'I'.
  1359             88  CO-GA-PENDING                VALUE 'P'.
  1360         16  CO-GA-COMMENTS.
  1361             20  CO-GA-COMMENT-1           PIC X(40).
  1362             20  CO-GA-COMMENT-2           PIC X(40).
  1363             20  CO-GA-COMMENT-3           PIC X(40).
  1364             20  CO-GA-COMMENT-4           PIC X(40).
  1365
  1366     12  CO-RPTCD2                         PIC X(10).
  1367     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1368         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1369         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1370
  1371     12  CO-TYPE-AGENT                     PIC X(01).
  1372         88  CO-CORPORATION                   VALUE 'C'.
  1373         88  CO-PARTNERSHIP                   VALUE 'P'.
  1374         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1375         88  CO-TRUST                         VALUE 'T'.
  1376         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1377
  1378     12  CO-FAXNO.
  1379         16  CO-FAX-AREA-CODE                  PIC XXX.
  1380         16  CO-FAX-PREFIX                     PIC XXX.
  1381         16  CO-FAX-PHONE                      PIC X(4).
  1382
  1383     12  CO-BANK-INFORMATION.
  1384         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1385         16  CO-BANK-TRANSIT-NON REDEFINES
  1386             CO-BANK-TRANSIT-NO                PIC 9(8).
  1387
  1388         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1389     12  CO-MISC-DEDUCT-INFO REDEFINES
  1390                  CO-BANK-INFORMATION.
  1391         16  CO-MD-GL-ACCT                     PIC X(10).
  1392         16  CO-MD-DIV                         PIC XX.
  1393         16  CO-MD-CENTER                      PIC X(4).
  1394         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1395         16  CO-CREATE-AP-CHECK                PIC X.
  1396         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1397         16  FILLER                            PIC XXX.
  1398     12  CO-ACH-STATUS                         PIC X.
  1399         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1400         88  CO-ACH-PENDING                        VALUE 'P'.
  1401
  1402     12  CO-BILL-SW                            PIC X.
  1403     12  CO-CONTROL-NAME                       PIC X(30).
  1404     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1405     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  26
* SOCK04.cbl
  1406     12  CO-CLP-STATE                          PIC XX.
  1407     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1408     12  CO-SPP-REFUND-EDIT                    PIC X.
  1409
  1410******************************************************************
  1411*                                 COPY ERCCNOT.
  1412******************************************************************
  1413*                                                                *
  1414*                            ERCCNOT                             *
  1415*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1416*                            VMOD=2.003                          *
  1417*                                                                *
  1418*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  1419*                                                                *
  1420*        FILE TYPE= VSAM,KSDS                                    *
  1421*        RECORD SIZE = 150    RECFORM = FIXED                    *
  1422*                                                                *
  1423*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  1424*                                                                *
  1425*        LOG = YES                                               *
  1426*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1427*                                                                *
  1428******************************************************************
  1429*                   C H A N G E   L O G
  1430*
  1431* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1432*-----------------------------------------------------------------
  1433*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1434* EFFECTIVE    NUMBER
  1435*-----------------------------------------------------------------
  1436* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  1437******************************************************************
  1438
  1439 01  CERT-NOTE-FILE.
  1440     12  CZ-RECORD-ID                PIC  XX.
  1441         88  VALID-CZ-ID                  VALUE 'CZ'.
  1442
  1443     12  CZ-CONTROL-PRIMARY.
  1444         16  CZ-COMPANY-CD           PIC X.
  1445         16  CZ-CARRIER              PIC X.
  1446         16  CZ-GROUPING.
  1447             20 CZ-GROUPING-PREFIX   PIC XXX.
  1448             20 CZ-GROUPING-PRIME    PIC XXX.
  1449         16  CZ-STATE                PIC XX.
  1450         16  CZ-ACCOUNT.
  1451             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  1452             20 CZ-ACCOUNT-PRIME     PIC X(6).
  1453         16  CZ-CERT-EFF-DT          PIC XX.
  1454         16  CZ-CERT-NO.
  1455             20  CZ-CERT-PRIME       PIC X(10).
  1456             20  CZ-CERT-SFX         PIC X.
  1457         16  CZ-RECORD-TYPE          PIC X.
  1458             88  CERT-NOTE           VALUE '1'.
  1459             88  CLAIM-CERT-NOTE     VALUE '2'.
  1460         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  1461
  1462     12  CZ-LAST-MAINT-DT            PIC XX.
  1463     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  27
* SOCK04.cbl
  1464     12  CZ-LAST-MAINT-USER          PIC X(4).
  1465
  1466     12  CZ-NOTE-INFORMATION.
  1467         16  CZ-NOTE                 PIC X(63).
  1468         16  FILLER                  PIC X(39).
  1469******************************************************************
  1470*                                 COPY ELCDATE.
  1471******************************************************************
  1472*                                                                *
  1473*                                                                *
  1474*                            ELCDATE.                            *
  1475*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1476*                            VMOD=2.003
  1477*                                                                *
  1478*                                                                *
  1479*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1480*                 LENGTH = 200                                   *
  1481******************************************************************
  1482
  1483 01  DATE-CONVERSION-DATA.
  1484     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1485     12  DC-OPTION-CODE                PIC X.
  1486         88  BIN-TO-GREG                VALUE ' '.
  1487         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1488         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1489         88  YMD-GREG-TO-BIN            VALUE '3'.
  1490         88  MDY-GREG-TO-BIN            VALUE '4'.
  1491         88  JULIAN-TO-BIN              VALUE '5'.
  1492         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1493         88  FIND-CENTURY               VALUE '7'.
  1494         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1495         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1496         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1497         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1498         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1499         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1500         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1501         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1502         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1503         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1504         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1505         88  BIN-3-TO-GREG              VALUE 'I'.
  1506         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1507         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1508         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1509         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1510         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1511         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1512         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1513         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1514         88  THREE-CHARACTER-BIN
  1515                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1516         88  GREGORIAN-TO-BIN
  1517                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1518         88  BIN-TO-GREGORIAN
  1519                  VALUES ' ' '1' 'I' '8' 'G'.
  1520         88  JULIAN-TO-BINARY
  1521                  VALUES '5' 'C' 'E' 'F'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  28
* SOCK04.cbl
  1522     12  DC-ERROR-CODE                 PIC X.
  1523         88  NO-CONVERSION-ERROR        VALUE ' '.
  1524         88  DATE-CONVERSION-ERROR
  1525                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1526         88  DATE-IS-ZERO               VALUE '1'.
  1527         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  1528         88  DATE-IS-INVALID            VALUE '3'.
  1529         88  DATE1-GREATER-DATE2        VALUE '4'.
  1530         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1531         88  DATE-INVALID-OPTION        VALUE '9'.
  1532         88  INVALID-CENTURY            VALUE 'A'.
  1533         88  ONLY-CENTURY               VALUE 'B'.
  1534         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1535         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1536     12  DC-END-OF-MONTH               PIC X.
  1537         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1538     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1539         88  USE-NORMAL-PROCESS         VALUE ' '.
  1540         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1541         88  ADJUST-UP-100-YRS          VALUE '2'.
  1542     12  FILLER                        PIC X.
  1543     12  DC-CONVERSION-DATES.
  1544         16  DC-BIN-DATE-1             PIC XX.
  1545         16  DC-BIN-DATE-2             PIC XX.
  1546         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1547         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1548                       DC-GREG-DATE-1-EDIT.
  1549             20  DC-EDIT1-MONTH        PIC 99.
  1550             20  SLASH1-1              PIC X.
  1551             20  DC-EDIT1-DAY          PIC 99.
  1552             20  SLASH1-2              PIC X.
  1553             20  DC-EDIT1-YEAR         PIC 99.
  1554         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1555         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1556                     DC-GREG-DATE-2-EDIT.
  1557             20  DC-EDIT2-MONTH        PIC 99.
  1558             20  SLASH2-1              PIC X.
  1559             20  DC-EDIT2-DAY          PIC 99.
  1560             20  SLASH2-2              PIC X.
  1561             20  DC-EDIT2-YEAR         PIC 99.
  1562         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1563         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1564                     DC-GREG-DATE-1-YMD.
  1565             20  DC-YMD-YEAR           PIC 99.
  1566             20  DC-YMD-MONTH          PIC 99.
  1567             20  DC-YMD-DAY            PIC 99.
  1568         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1569         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1570                      DC-GREG-DATE-1-MDY.
  1571             20  DC-MDY-MONTH          PIC 99.
  1572             20  DC-MDY-DAY            PIC 99.
  1573             20  DC-MDY-YEAR           PIC 99.
  1574         16  DC-GREG-DATE-1-ALPHA.
  1575             20  DC-ALPHA-MONTH        PIC X(10).
  1576             20  DC-ALPHA-DAY          PIC 99.
  1577             20  FILLER                PIC XX.
  1578             20  DC-ALPHA-CENTURY.
  1579                 24 DC-ALPHA-CEN-N     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  29
* SOCK04.cbl
  1580             20  DC-ALPHA-YEAR         PIC 99.
  1581         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1582         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1583         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1584         16  DC-JULIAN-DATE            PIC 9(05).
  1585         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1586                                       PIC 9(05).
  1587         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1588             20  DC-JULIAN-YEAR        PIC 99.
  1589             20  DC-JULIAN-DAYS        PIC 999.
  1590         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1591         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1592         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1593     12  DATE-CONVERSION-VARIBLES.
  1594         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1595         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1596             20  FILLER                PIC 9(3).
  1597             20  HOLD-CEN-1-CCYY.
  1598                 24  HOLD-CEN-1-CC     PIC 99.
  1599                 24  HOLD-CEN-1-YY     PIC 99.
  1600             20  HOLD-CEN-1-MO         PIC 99.
  1601             20  HOLD-CEN-1-DA         PIC 99.
  1602         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1603             20  HOLD-CEN-1-R-MO       PIC 99.
  1604             20  HOLD-CEN-1-R-DA       PIC 99.
  1605             20  HOLD-CEN-1-R-CCYY.
  1606                 24  HOLD-CEN-1-R-CC   PIC 99.
  1607                 24  HOLD-CEN-1-R-YY   PIC 99.
  1608             20  FILLER                PIC 9(3).
  1609         16  HOLD-CENTURY-1-X.
  1610             20  FILLER                PIC X(3)  VALUE SPACES.
  1611             20  HOLD-CEN-1-X-CCYY.
  1612                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1613                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1614             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1615             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1616         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1617             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1618             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1619             20  HOLD-CEN-1-R-X-CCYY.
  1620                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1621                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1622             20  FILLER                PIC XXX.
  1623         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1624         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1625         16  DC-JULIAN-DATE-1          PIC 9(07).
  1626         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1627             20  DC-JULIAN-1-CCYY.
  1628                 24  DC-JULIAN-1-CC    PIC 99.
  1629                 24  DC-JULIAN-1-YR    PIC 99.
  1630             20  DC-JULIAN-DA-1        PIC 999.
  1631         16  DC-JULIAN-DATE-2          PIC 9(07).
  1632         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1633             20  DC-JULIAN-2-CCYY.
  1634                 24  DC-JULIAN-2-CC    PIC 99.
  1635                 24  DC-JULIAN-2-YR    PIC 99.
  1636             20  DC-JULIAN-DA-2        PIC 999.
  1637         16  DC-GREG-DATE-A-EDIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  30
* SOCK04.cbl
  1638             20  DC-EDITA-MONTH        PIC 99.
  1639             20  SLASHA-1              PIC X VALUE '/'.
  1640             20  DC-EDITA-DAY          PIC 99.
  1641             20  SLASHA-2              PIC X VALUE '/'.
  1642             20  DC-EDITA-CCYY.
  1643                 24  DC-EDITA-CENT     PIC 99.
  1644                 24  DC-EDITA-YEAR     PIC 99.
  1645         16  DC-GREG-DATE-B-EDIT.
  1646             20  DC-EDITB-MONTH        PIC 99.
  1647             20  SLASHB-1              PIC X VALUE '/'.
  1648             20  DC-EDITB-DAY          PIC 99.
  1649             20  SLASHB-2              PIC X VALUE '/'.
  1650             20  DC-EDITB-CCYY.
  1651                 24  DC-EDITB-CENT     PIC 99.
  1652                 24  DC-EDITB-YEAR     PIC 99.
  1653         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1654         16  DC-GREG-DATE-CYMD-R REDEFINES
  1655                              DC-GREG-DATE-CYMD.
  1656             20  DC-CYMD-CEN           PIC 99.
  1657             20  DC-CYMD-YEAR          PIC 99.
  1658             20  DC-CYMD-MONTH         PIC 99.
  1659             20  DC-CYMD-DAY           PIC 99.
  1660         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1661         16  DC-GREG-DATE-MDCY-R REDEFINES
  1662                              DC-GREG-DATE-MDCY.
  1663             20  DC-MDCY-MONTH         PIC 99.
  1664             20  DC-MDCY-DAY           PIC 99.
  1665             20  DC-MDCY-CEN           PIC 99.
  1666             20  DC-MDCY-YEAR          PIC 99.
  1667    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1668        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1669    12  DC-EL310-DATE                  PIC X(21).
  1670    12  FILLER                         PIC X(28).
  1671 01 soc-CLIENT-IN-DATA.
  1672    05  soc-CLIENT-CAR           PIC X.
  1673    05  soc-CLIENT-GRP           PIC X(6).
  1674    05  soc-CLIENT-ST            PIC XX.
  1675    05  soc-CLIENT-ACT           PIC X(10).
  1676    05  soc-CLIENT-EFF-DT        PIC X(8).
  1677    05  soc-Client-cert-no       pic x(11).
  1678    05  soc-CLIENT-ID            PIC XXX.
  1679    05  soc-client-proc-id       pic x(4).
  1680    05  soc-CLIENT-ACTION-TAKEN  PIC X.
  1681****************************************************************
  1682*
  1683* Copyright (c) 2007 by Clerity Solutions, Inc.
  1684* All rights reserved.
  1685*
  1686****************************************************************
  1687 01  DFHEIV.
  1688   02  DFHEIV0               PIC X(35).
  1689   02  DFHEIV1               PIC X(08).
  1690   02  DFHEIV2               PIC X(08).
  1691   02  DFHEIV3               PIC X(08).
  1692   02  DFHEIV4               PIC X(06).
  1693   02  DFHEIV5               PIC X(04).
  1694   02  DFHEIV6               PIC X(04).
  1695   02  DFHEIV7               PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  31
* SOCK04.cbl
  1696   02  DFHEIV8               PIC X(02).
  1697   02  DFHEIV9               PIC X(01).
  1698   02  DFHEIV10              PIC S9(7) COMP-3.
  1699   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1700   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1701   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1702   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1703   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1704   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1705   02  DFHEIV17              PIC X(04).
  1706   02  DFHEIV18              PIC X(04).
  1707   02  DFHEIV19              PIC X(04).
  1708   02  DFHEIV20              USAGE IS POINTER.
  1709   02  DFHEIV21              USAGE IS POINTER.
  1710   02  DFHEIV22              USAGE IS POINTER.
  1711   02  DFHEIV23              USAGE IS POINTER.
  1712   02  DFHEIV24              USAGE IS POINTER.
  1713   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1714   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1715   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1716   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1717   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1718   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1719   02  FILLER                PIC X(02).
  1720   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1721   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1722   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1723   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1724   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1725 LINKAGE  SECTION.
  1726*****************************************************************
  1727*                                                               *
  1728* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1729* All rights reserved.                                          *
  1730*                                                               *
  1731*****************************************************************
  1732 01  dfheiblk.
  1733     02  eibtime          pic s9(7) comp-3.
  1734     02  eibdate          pic s9(7) comp-3.
  1735     02  eibtrnid         pic x(4).
  1736     02  eibtaskn         pic s9(7) comp-3.
  1737     02  eibtrmid         pic x(4).
  1738     02  dfheigdi         pic s9(4) comp.
  1739     02  eibcposn         pic s9(4) comp.
  1740     02  eibcalen         pic s9(4) comp.
  1741     02  eibaid           pic x(1).
  1742     02  eibfiller1       pic x(1).
  1743     02  eibfn            pic x(2).
  1744     02  eibfiller2       pic x(2).
  1745     02  eibrcode         pic x(6).
  1746     02  eibfiller3       pic x(2).
  1747     02  eibds            pic x(8).
  1748     02  eibreqid         pic x(8).
  1749     02  eibrsrce         pic x(8).
  1750     02  eibsync          pic x(1).
  1751     02  eibfree          pic x(1).
  1752     02  eibrecv          pic x(1).
  1753     02  eibsend          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  32
* SOCK04.cbl
  1754     02  eibatt           pic x(1).
  1755     02  eibeoc           pic x(1).
  1756     02  eibfmh           pic x(1).
  1757     02  eibcompl         pic x(1).
  1758     02  eibsig           pic x(1).
  1759     02  eibconf          pic x(1).
  1760     02  eiberr           pic x(1).
  1761     02  eibrldbk         pic x(1).
  1762     02  eiberrcd         pic x(4).
  1763     02  eibsynrb         pic x(1).
  1764     02  eibnodat         pic x(1).
  1765     02  eibfiller5       pic x(2).
  1766     02  eibresp          pic 9(09) comp.
  1767     02  eibresp2         pic 9(09) comp.
  1768     02  dfheigdj         pic s9(4) comp.
  1769     02  dfheigdk         pic s9(4) comp.
  1770 01  DFHCOMMAREA.
  1771   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  1772   05 LSTN-NAME                PIC X(8).
  1773   05 LSTN-SUBNAME             PIC X(8).
  1774   05 CLIENT-IN-DATA           pic x(36).
  1775   05 SOCKADDR-IN-PARM.
  1776     15 SIN-FAMILY             PIC 9(4) COMP.
  1777     15 SIN-PORT               PIC 9(4) COMP.
  1778     15 SIN-ADDRESS            PIC 9(8) COMP.
  1779     15 SIN-ZERO               PIC X(8).
  1780 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1781 0000-DFHEXIT SECTION.
  1782     MOVE '9#                    $   ' TO DFHEIV0.
  1783     MOVE 'SOCK04' TO DFHEIV1.
  1784     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1785*
  1786* when calling a C function the function returns its value
  1787* in the system variable return code.
  1788*
  1789     display 'SOCK04:transaction data =', CLIENT-IN-DATA.
  1790     display 'SOCK04:socket number    =', GIVE-TAKE-SOCKET.
  1791     display 'SOCK04:socket name      =', lstn-name ' '
  1792        lstn-subname
  1793     perform 0010-init-contact   thru 0010-exit
  1794     perform 0020-receive        thru 0020-exit
  1795     perform 0030-link-business-logic
  1796                                 thru 0030-exit
  1797     string
  1798        sock-am-name          ';'
  1799        sock-am-person        ';'
  1800        sock-am-cntrl-name    ';'
  1801        sock-am-phone         ';'
  1802        sock-co-fax           ';'
  1803        sock-co-contact
  1804           DELIMITED BY SIZE INTO WS-SEND-BUF
  1805       END-STRING
  1806     display 'SOCK04:About to send      '
  1807     display 'SOCK04:sequence number  =', ws-seq-num.
  1808     display 'SOCK04:send buffer      =', ws-send-buf(1:80).
  1809     call "send" using by value GIVE-TAKE-SOCKET,
  1810         by reference ws-send-buf,
  1811         by value ws-send-msg-size,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  33
* SOCK04.cbl
  1812         by value ws-flags.
  1813     if return-code <= zero
  1814         display 'SOCK04:send error ',
  1815         go to socket-error.
  1816     GO TO SOCKET-FIN
  1817     .
  1818 0010-init-contact.
  1819     if client-in-data (1:8) = 'SOCKET04'
  1820        continue
  1821     else
  1822        display ' Unknown origin ' client-in-data
  1823        go to socket-fin
  1824     end-if
  1825     move 'SOCKET04READY'        to ws-send-buf
  1826     move +25                    to ws-send-msg-size
  1827     display 'SOCK04:sequence number  =', ws-seq-num.
  1828     display 'SOCK04:send buffer      =', ws-send-buf(1:25).
  1829     call "send" using by value GIVE-TAKE-SOCKET,
  1830         by reference ws-send-buf,
  1831         by value ws-send-msg-size,
  1832         by value ws-flags
  1833     if return-code <= zero
  1834        display 'SOCK04:send error ' return-code
  1835        go to socket-error
  1836     end-if
  1837     display 'SOCK04:About to recv '
  1838     .
  1839 0010-exit.
  1840     exit.
  1841 0020-receive.
  1842     call "recv" using by value GIVE-TAKE-SOCKET
  1843         by reference ws-recv-buf
  1844         by value ws-recv-msg-size
  1845         by value ws-flags.
  1846     if return-code < zero
  1847        display 'SOCK04:recv error ' return-code
  1848        go to socket-error
  1849     end-if
  1850     if return-code = zero
  1851        display 'SOCK04:client disconnected',
  1852        go to socket-error
  1853     end-if
  1854     display 'SOCK04:Good recv  '
  1855     display 'SOCK04:return code      = ', return-code
  1856     display 'SOCK04:receive buffer   = ', ws-recv-buf(1:42)
  1857     move +1024                  to ws-send-msg-size
  1858     move ws-recv-buf (1:46)     to soc-client-in-data
  1859     .
  1860 0020-exit.
  1861     exit.
  1862 0030-link-business-logic.
  1863     move soc-client-in-data     to sock-in-data
  1864     move spaces                 to sock-return-area
  1865
  1866* exec cics link
  1867*       program  ('SOCK04BL')
  1868*       commarea (socket-commarea)
  1869*    end-exec
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  34
* SOCK04.cbl
  1870     MOVE LENGTH OF
  1871      socket-commarea
  1872       TO DFHEIV11
  1873     MOVE 'SOCK04BL' TO DFHEIV1
  1874*    MOVE '."C                   (   #00001861' TO DFHEIV0
  1875     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1876     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1877     MOVE X'2020233030303031383631' TO DFHEIV0(25:11)
  1878     CALL 'kxdfhei1' USING DFHEIV0,
  1879           DFHEIV1,
  1880           socket-commarea,
  1881           DFHEIV11,
  1882           DFHEIV99,
  1883           DFHEIV99,
  1884           DFHEIV99,
  1885           DFHEIV99
  1886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1887     .
  1888 0030-exit.
  1889     exit.
  1890 socket-error.
  1891     if ws-seq-num <> 0
  1892         display "SOCK04:did not complete".
  1893*
  1894* flush the send buffer and deallocate
  1895*
  1896    .
  1897 socket-fin.
  1898*    call "close" using by value GIVE-TAKE-SOCKET .
  1899     display 'SOCK04:done'.
  1900
  1901* exec cics
  1902*       return
  1903*    end-exec.
  1904*    MOVE '.(                    ''   #00001878' TO DFHEIV0
  1905     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1906     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1907     MOVE X'2020233030303031383738' TO DFHEIV0(25:11)
  1908     CALL 'kxdfhei1' USING DFHEIV0,
  1909           DFHEIV99,
  1910           DFHEIV99,
  1911           DFHEIV99,
  1912           DFHEIV99,
  1913           DFHEIV99,
  1914           DFHEIV99
  1915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1916
  1917
  1918* goback.
  1919     MOVE '9%                    "   ' TO DFHEIV0
  1920     MOVE 'SOCK04' TO DFHEIV1
  1921     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1922     goback.
  1923 9700-DATE-LINK.
  1924
  1925* EXEC CICS LINK
  1926*         PROGRAM  ('ELDATCV')
  1927*         COMMAREA (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:38 Page  35
* SOCK04.cbl
  1928*         LENGTH   (DC-COMM-LENGTH)
  1929*    END-EXEC.
  1930     MOVE 'ELDATCV' TO DFHEIV1
  1931*    MOVE '."C                   (   #00001883' TO DFHEIV0
  1932     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1933     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1934     MOVE X'2020233030303031383833' TO DFHEIV0(25:11)
  1935     CALL 'kxdfhei1' USING DFHEIV0,
  1936           DFHEIV1,
  1937           DATE-CONVERSION-DATA,
  1938           DC-COMM-LENGTH,
  1939           DFHEIV99,
  1940           DFHEIV99,
  1941           DFHEIV99,
  1942           DFHEIV99
  1943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1944
  1945 9700-EXIT.
  1946      EXIT.
  1947
  1948 9999-DFHBACK SECTION.
  1949     MOVE '9%                    "   ' TO DFHEIV0
  1950     MOVE 'SOCK04' TO DFHEIV1
  1951     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1952     GOBACK.
  1953 9999-DFHEXIT.
  1954     IF DFHEIGDJ EQUAL 0001
  1955         NEXT SENTENCE.
  1956     MOVE '9%                    "   ' TO DFHEIV0
  1957     MOVE 'SOCK04' TO DFHEIV1
  1958     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1959     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       61096     Code:        1900
