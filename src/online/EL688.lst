* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL688.cbl
* Options: int("EL688.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL688.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL688.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL688.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL688 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/07/95 12:54:34.
     7*                            VMOD=2.022.
     8*
     9*AUTHOR.    LOGIC, INC.
    10*           DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL688.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.  TRANSACTION - EXG4
    25
    26*        THIS FUNCTION READS THE CHECK QUEUE FILE AND PRINTS
    27*    CHECKS FROM THOSE ENTRIES QUEUED.  QUEUEING IS DONE USING
    28*    TIME (HH.MM) BY THE CHECK PRINT RELEASE PROGRAM (EL687).
    29
    30*    SCREENS     - NONE - USERS PRINTED OUTPUT (CHECKS)
    31
    32*    ENTERED BY  - EL687  - CHECK WRITER - VIA START
    33
    34*    EXIT TO     - CICS
    35
    36*    INPUT FILES - NONE
    37
    38*    OUTPUT FILES - NONE
    39
    40*    COMMAREA    - PASSED.
    41
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL688.cbl
    43 ENVIRONMENT DIVISION.
    44
    45 DATA DIVISION.
    46
    47 WORKING-STORAGE SECTION.
    48 01  DFH-START PIC X(04).
    49
    50 77  FILLER  PIC X(32)  VALUE '********************************'.
    51 77  FILLER  PIC X(32)  VALUE '*    EL688 WORKING STORAGE     *'.
    52 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.022 *********'.
    53
    54 01  FILLER                          COMP-3.
    55     05  WS-RECORD-COUNT             PIC S9(5)       VALUE ZERO.
    56     05  WS-TIME-WORK                PIC S9(7)       VALUE ZERO.
    57     05  WS-TIME                     REDEFINES
    58         WS-TIME-WORK                PIC S9(3)V9(4).
    59     05  WS-HHMM                     REDEFINES
    60         WS-TIME-WORK                PIC S9(5)V99.
    61
    62     05  WS-DELAY-INTERVAL           PIC S9(7)       VALUE +10.
    63
    64     05  WS-DATA-SENT-SW             PIC S9          VALUE ZERO.
    65     05  WS-SW                       PIC S9          VALUE ZERO.
    66
    67     05  WS-AMT-WORK                 PIC S9(7)V99    VALUE ZERO.
    68 01  FILLER                          COMP
    69                                     SYNCHRONIZED.
    70
    71     05  WS-TS-LENGTH                PIC S9(4)       VALUE +1000.
    72     05  WS-COMM-LENGTH              PIC S9(4)       VALUE +1024.
    73     05  WS-CHECK-LINES-LENGTH       PIC S9(4)       VALUE +904.
    74
    75 01  FILLER.
    76     05  THIS-PGM                    PIC X(8)      VALUE 'EL688'.
    77
    78     05  ERMAIL-FILE-ID           PIC X(8)      VALUE 'ERMAIL'.
    79
    80     05  ERMAIL-KEY.
    81         10  ERMAIL-COMPANY-CD    PIC X         VALUE SPACES.
    82         10  ERMAIL-CARRIER       PIC X         VALUE SPACES.
    83         10  ERMAIL-GROUPING      PIC X(6)      VALUE SPACES.
    84         10  ERMAIL-STATE         PIC XX        VALUE SPACES.
    85         10  ERMAIL-ACCOUNT       PIC X(10)     VALUE SPACES.
    86         10  ERMAIL-CERT-EFF-DT   PIC XX        VALUE SPACES.
    87         10  ERMAIL-CERT-NO       PIC X(11)     VALUE SPACES.
    88
    89     05  FIRST-TIME-SW            PIC X              VALUE 'Y'.
    90         88  FIRST-ALIGNMENT                         VALUE 'Y'.
    91
    92     05  FIRST-CLIENT-SW          PIC X              VALUE 'Y'.
    93         88  FIRST-HERITAGE-CHECK                    VALUE 'Y'.
    94         88  FIRST-MADISON-CHECK                     VALUE 'Y'.
    95         88  FIRST-LAP-CHECK                         VALUE 'Y'.
    96
    97     05  WS-TEXT-MESSAGE-LENGTH      PIC S9(4)       VALUE +70
    98                                     COMP
    99                                     SYNCHRONIZED.
   100
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL688.cbl
   101     05  WS-TEXT-MESSAGE             PIC X(70)       VALUE SPACES.
   102
   103     05  WS-ZIP-CODE-LINE                            VALUE SPACES.
   104         10  WS-ZIP-CHAR             PIC X
   105             OCCURS 133 TIMES        INDEXED BY ZIP-INDEX1
   106                                                ZIP-INDEX2
   107                                                ZIP-INDEX3.
   108
   109     05  WS-DUMP-CODE.
   110         10  FILLER                  PIC X           VALUE 'S'.
   111         10  WS-DUMP-COUNT           PIC 999         VALUE ZERO.
   112
   113     05  WS-STUB4.
   114         10  WS-STUB4-1-20           PIC X(20)       VALUE SPACES.
   115         10  WS-STUB4-21-50          PIC X(30)       VALUE SPACES.
   116
   117     05  WS-CHECK-DATE.
   118         10  WS-CD-MO            PIC  9(02).
   119         10  WS-CD-DA            PIC  9(02).
   120         10  WS-CD-YR            PIC  9(02).
   121
   122     05  WS-ZIP-WORK.
   123         10  WS-ZIP-CODE         PIC  X(05).
   124         10  WS-ZIP-DASH         PIC  X(01).
   125         10  WS-ZIP-PLUS4        PIC  X(04).
   126
   127     05  WS-MONTH-TABLE.
   128         10  WS-MONTH-01         PIC  X(09)  VALUE '  JANUARY'.
   129         10  WS-MONTH-02         PIC  X(09)  VALUE ' FEBRUARY'.
   130         10  WS-MONTH-03         PIC  X(09)  VALUE '    MARCH'.
   131         10  WS-MONTH-04         PIC  X(09)  VALUE '    APRIL'.
   132         10  WS-MONTH-05         PIC  X(09)  VALUE '      MAY'.
   133         10  WS-MONTH-06         PIC  X(09)  VALUE '     JUNE'.
   134         10  WS-MONTH-07         PIC  X(09)  VALUE '     JULY'.
   135         10  WS-MONTH-08         PIC  X(09)  VALUE '   AUGUST'.
   136         10  WS-MONTH-09         PIC  X(09)  VALUE 'SEPTEMBER'.
   137         10  WS-MONTH-10         PIC  X(09)  VALUE '  OCTOBER'.
   138         10  WS-MONTH-11         PIC  X(09)  VALUE ' NOVEMBER'.
   139         10  WS-MONTH-12         PIC  X(09)  VALUE ' DECEMBER'.
   140     05  WS-MONT-TAB  REDEFINES  WS-MONTH-TABLE.
   141         10  WS-MONTH-ENTRY  OCCURS  12  TIMES
   142                                 PIC  X(09).
   143*                            COPY ELCDMD34.
   144******************************************************************
   145*                                                                *
   146*                                                                *
   147*                            ELCDMD34.                           *
   148*                            VMOD=2.001                          *
   149*                                                                *
   150*   FILE DESCRIPTION = DMD DLO034 PARAMETER AREA                 *
   151*                                                                *
   152*    LENGTH = 272    RECFRM = FIXED                              *
   153*                                                                *
   154******************************************************************
   155 01  DLO034-COMMUNICATION-AREA.
   156     12  DL34-PROCESS-TYPE             PIC X.
   157     12  DL34-COMPANY-ID               PIC XXX.
   158     12  DL34-PRINT-PROGRAM-ID         PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL688.cbl
   159     12  DL34-USERID                   PIC X(4).
   160     12  DL34-PRINT-LINE               PIC X(250).
   161     12  DL34-OVERRIDE-PRINTER-ID      PIC X(4).
   162     12  DL34-RETURN-CODE              PIC XX.
   163 01  DLO034-REC-LENGTH                 PIC S9(4) COMP VALUE +272.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL688.cbl
   165*                            COPY ELCINTF.
   166******************************************************************
   167*                                                                *
   168*                                                                *
   169*                            ELCINTF.                            *
   170*                            VMOD=2.017                          *
   171*                                                                *
   172*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   173*                                                                *
   174*       LENGTH = 1024                                            *
   175*                                                                *
   176******************************************************************
   177 01  PROGRAM-INTERFACE-BLOCK.
   178     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   179     12  PI-CALLING-PROGRAM              PIC X(8).
   180     12  PI-SAVED-PROGRAM-1              PIC X(8).
   181     12  PI-SAVED-PROGRAM-2              PIC X(8).
   182     12  PI-SAVED-PROGRAM-3              PIC X(8).
   183     12  PI-SAVED-PROGRAM-4              PIC X(8).
   184     12  PI-SAVED-PROGRAM-5              PIC X(8).
   185     12  PI-SAVED-PROGRAM-6              PIC X(8).
   186     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   187     12  PI-COMPANY-ID                   PIC XXX.
   188     12  PI-COMPANY-CD                   PIC X.
   189
   190     12  PI-COMPANY-PASSWORD             PIC X(8).
   191
   192     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   193
   194     12  PI-CONTROL-IN-PROGRESS.
   195         16  PI-CARRIER                  PIC X.
   196         16  PI-GROUPING                 PIC X(6).
   197         16  PI-STATE                    PIC XX.
   198         16  PI-ACCOUNT                  PIC X(10).
   199         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   200                                         PIC X(10).
   201         16  PI-CLAIM-CERT-GRP.
   202             20  PI-CLAIM-NO             PIC X(7).
   203             20  PI-CERT-NO.
   204                 25  PI-CERT-PRIME       PIC X(10).
   205                 25  PI-CERT-SFX         PIC X.
   206             20  PI-CERT-EFF-DT          PIC XX.
   207         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   208             20  PI-PLAN-CODE            PIC X(2).
   209             20  PI-REVISION-NUMBER      PIC X(3).
   210             20  PI-PLAN-EFF-DT          PIC X(2).
   211             20  PI-PLAN-EXP-DT          PIC X(2).
   212             20  FILLER                  PIC X(11).
   213         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   214             20  PI-OE-REFERENCE-1.
   215                 25  PI-OE-REF-1-PRIME   PIC X(18).
   216                 25  PI-OE-REF-1-SUFF    PIC XX.
   217
   218     12  PI-SESSION-IN-PROGRESS          PIC X.
   219         88  CLAIM-SESSION                   VALUE '1'.
   220         88  CREDIT-SESSION                  VALUE '2'.
   221         88  WARRANTY-SESSION                VALUE '3'.
   222         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL688.cbl
   223         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   224
   225
   226*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   227
   228     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   229     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   230
   231     12  PI-CREDIT-USER                  PIC X.
   232         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   233         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   234
   235     12  PI-CLAIM-USER                   PIC X.
   236         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   237         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   238
   239     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   240         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   241         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   242         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   243         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   244         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   245
   246     12  PI-PROCESSOR-ID                 PIC X(4).
   247
   248     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   249
   250     12  PI-MEMBER-CAPTION               PIC X(10).
   251
   252     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   253         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   254
   255     12  PI-LIFE-OVERRIDE-L1             PIC X.
   256     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   257     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   258     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   259
   260     12  PI-AH-OVERRIDE-L1               PIC X.
   261     12  PI-AH-OVERRIDE-L2               PIC XX.
   262     12  PI-AH-OVERRIDE-L6               PIC X(6).
   263     12  PI-AH-OVERRIDE-L12              PIC X(12).
   264
   265     12  PI-NEW-SYSTEM                   PIC X(2).
   266
   267     12  PI-PRIMARY-CERT-NO              PIC X(11).
   268     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   269         88  PI-USES-PAID-TO                 VALUE '1'.
   270     12  PI-CRDTCRD-SYSTEM.
   271         16  PI-CRDTCRD-USER             PIC X.
   272             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   273             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   274         16  PI-CC-MONTH-END-DT          PIC XX.
   275     12  PI-PROCESSOR-PRINTER            PIC X(4).
   276
   277     12  PI-OE-REFERENCE-2.
   278         16  PI-OE-REF-2-PRIME           PIC X(10).
   279         16  PI-OE-REF-2-SUFF            PIC X.
   280
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL688.cbl
   281     12  PI-REM-TRM-CALC-OPTION          PIC X.
   282
   283     12  PI-LANGUAGE-TYPE                PIC X.
   284             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   285             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   286             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   287
   288     12  PI-POLICY-LINKAGE-IND           PIC X.
   289         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   290         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   291                                                   LOW-VALUES.
   292
   293     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   294     12  PI-CLAIM-PW-SESSION             PIC X(1).
   295         88  PI-CLAIM-CREDIT                 VALUE '1'.
   296         88  PI-CLAIM-CONVEN                 VALUE '2'.
   297     12  FILLER                          PIC X(4).
   298
   299     12  PI-SYSTEM-LEVEL                 PIC X(145).
   300
   301     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   302         PI-SYSTEM-LEVEL.
   303
   304         16  PI-ENTRY-CODES.
   305             20  PI-ENTRY-CD-1           PIC X.
   306             20  PI-ENTRY-CD-2           PIC X.
   307
   308         16  PI-RETURN-CODES.
   309             20  PI-RETURN-CD-1          PIC X.
   310             20  PI-RETURN-CD-2          PIC X.
   311
   312         16  PI-UPDATE-STATUS-SAVE.
   313             20  PI-UPDATE-BY            PIC X(4).
   314             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   315
   316         16  PI-LOWER-CASE-LETTERS       PIC X.
   317             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   318
   319*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   320*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   321*            88  CARRIER-CLM-CNTL            VALUE '2'.
   322
   323         16  PI-CERT-ACCESS-CONTROL      PIC X.
   324             88  ST-ACCNT-CNTL               VALUE ' '.
   325             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   326             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   327             88  ACCNT-CNTL                  VALUE '3'.
   328             88  CARR-ACCNT-CNTL             VALUE '4'.
   329
   330         16  PI-PROCESSOR-CAP-LIST.
   331             20  PI-SYSTEM-CONTROLS.
   332                24 PI-SYSTEM-DISPLAY     PIC X.
   333                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   334                24 PI-SYSTEM-MODIFY      PIC X.
   335                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   336             20  FILLER                  PIC XX.
   337             20  PI-DISPLAY-CAP          PIC X.
   338                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL688.cbl
   339             20  PI-MODIFY-CAP           PIC X.
   340                 88  MODIFY-CAP              VALUE 'Y'.
   341             20  PI-MSG-AT-LOGON-CAP     PIC X.
   342                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   343             20  PI-FORCE-CAP            PIC X.
   344                 88  FORCE-CAP               VALUE 'Y'.
   345
   346         16  PI-PROGRAM-CONTROLS.
   347             20  PI-PGM-PRINT-OPT        PIC X.
   348             20  PI-PGM-FORMAT-OPT       PIC X.
   349             20  PI-PGM-PROCESS-OPT      PIC X.
   350             20  PI-PGM-TOTALS-OPT       PIC X.
   351
   352         16  PI-HELP-INTERFACE.
   353             20  PI-LAST-ERROR-NO        PIC X(4).
   354             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   355
   356         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   357             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   358
   359         16  PI-CR-CONTROL-IN-PROGRESS.
   360             20  PI-CR-CARRIER           PIC X.
   361             20  PI-CR-GROUPING          PIC X(6).
   362             20  PI-CR-STATE             PIC XX.
   363             20  PI-CR-ACCOUNT           PIC X(10).
   364             20  PI-CR-FIN-RESP          PIC X(10).
   365             20  PI-CR-TYPE              PIC X.
   366
   367         16  PI-CR-BATCH-NUMBER          PIC X(6).
   368
   369         16  PI-CR-MONTH-END-DT          PIC XX.
   370
   371         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   372             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   373             88  PI-ZERO-CARRIER             VALUE '1'.
   374             88  PI-ZERO-GROUPING            VALUE '2'.
   375             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   376
   377         16  PI-CARRIER-SECURITY         PIC X.
   378             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   379
   380         16  PI-ACCOUNT-SECURITY         PIC X(10).
   381             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   382             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   383
   384         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   385             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   386                                         INDEXED BY PI-ACCESS-NDX
   387                                         PIC X.
   388
   389         16  PI-GA-BILLING-CONTROL       PIC X.
   390             88  PI-GA-BILLING               VALUE '1'.
   391
   392         16  PI-MAIL-PROCESSING          PIC X.
   393             88  PI-MAIL-YES                 VALUE 'Y'.
   394
   395         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   396
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL688.cbl
   397         16  PI-AR-SYSTEM.
   398             20  PI-AR-PROCESSING-CNTL   PIC X.
   399                 88  PI-AR-PROCESSING        VALUE 'Y'.
   400             20  PI-AR-SUMMARY-CODE      PIC X(6).
   401             20  PI-AR-MONTH-END-DT      PIC XX.
   402
   403         16  PI-MP-SYSTEM.
   404             20  PI-MORTGAGE-USER            PIC X.
   405                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   406                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   407             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   408                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   409                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   410                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   411                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   412                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   413             20  PI-MP-MONTH-END-DT          PIC XX.
   414             20  PI-MP-REFERENCE-NO.
   415                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   416                 24  PI-MP-REFERENCE-SFX     PIC XX.
   417
   418         16  PI-LABEL-CONTROL            PIC X(01).
   419             88  PI-CREATE-LABELS                    VALUE 'Y'.
   420             88  PI-BYPASS-LABELS                    VALUE 'N'.
   421
   422         16  PI-BILL-GROUPING-CODE       PIC X(01).
   423             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   424
   425         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   426             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   427             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   428
   429         16  FILLER                      PIC X(14).
   430
   431     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   432******************************************************************
   433
   434*                            COPY ERC687PI.
   435*****************************************************************
   436*                                                               *
   437*                                                               *
   438*                            ERC687PI                           *
   439*                            VMOD=2.004                         *
   440*                                                               *
   441*****************************************************************.
   442
   443     12  FILLER                      REDEFINES
   444         PI-PROGRAM-WORK-AREA.
   445
   446         16  PI-TEMP-STORAGE-KEY.
   447             20  PI-TSK-TERM-ID      PIC X(4).
   448             20  PI-TSK-TIME         PIC S9(7)     COMP-3.
   449
   450         16  PI-PROCESSING-SW        PIC S9        COMP-3.
   451
   452         16  PI-NUMBER-OF-ALIGNMENT-CHECKS PIC S9  COMP-3.
   453
   454         16  PI-ALIGNMENT-CONTROL-GROUP  PIC S9(8) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL688.cbl
   455
   456         16  PI-ALIGNMENT-SEQUENCE-NO  PIC S9(4)   COMP.
   457
   458         16  PI-NUMBER-OF-CONTROL-GROUPS  PIC S9(4) COMP.
   459
   460         16  PI-CONTROL-GROUPS       COMP
   461             OCCURS 4 TIMES          INDEXED BY PI-INDEX.
   462
   463             20  PI-CONTROL-GROUP    PIC S9(8).
   464             20  PI-HIGH-SEQUENCE    PIC S9(4).
   465
   466         16  PI-CHECK-PRINTER-ID     PIC X(4).
   467
   468         16  PI-PRINTER-STARTED-SW   PIC S9      COMP-3.
   469
   470         16  PI-ASSIGN-CHECK-NUMBERS PIC X.
   471
   472         16  PI-COMPANY-ADDRESS.
   473             20  PI-COMPANY-NAME             PIC X(30).
   474             20  PI-COMPANY-ADDRESS-LINE1    PIC X(30).
   475             20  PI-COMPANY-ADDRESS-LINE2    PIC X(30).
   476             20  PI-COMPANY-ADDRESS-LINE3    PIC X(30).
   477             20  PI-COMPANY-CITY-ST          PIC X(30).
   478             20  PI-COMPANY-ZIP-CODE.
   479                 24  PI-COMPANY-ZIP-PRIME.
   480                     26  PI-ZIP-PRI-1ST      PIC X.
   481                         88  PI-CO-CANADIAN-POST-CODE
   482                                          VALUE 'A' THRU 'Z'.
   483                     26  FILLER              PIC X(4).
   484                 24  PI-COMPANY-ZIP-PLUS4    PIC X(4).
   485             20  PI-CANADIAN-POSTAL-CODE REDEFINES
   486                 PI-COMPANY-ZIP-CODE.
   487                 24  PI-CAN-POSTAL-1         PIC XXX.
   488                 24  PI-CAN-POSTAL-2         PIC XXX.
   489                 24  FILLER                  PIC XXX.
   490             20  PI-COMPANY-PHONE-NUMBER     PIC S9(11) COMP-3.
   491         16  PI-SYSID                PIC X(4).
   492
   493         16  PI-TEMP-STORAGE-ITEM    PIC S9(4) COMP SYNC.
   494         16  PI-LETTERS-IND          PIC X.
   495
   496         16  FILLER                  PIC X(419).
   497
   498
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL688.cbl
   500*                            COPY ELC176W2.
   501*****************************************************************
   502*                                                               *
   503*                            ELC176W2.                          *
   504*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   505*                            VMOD=2.003                         *
   506*****************************************************************.
   507
   508 01  SPELL-DOLLAR-PASS-AREA.
   509
   510     05  SD-PASS-AMOUNT              PIC S9(9)V99
   511                                     COMP-3        VALUE ZEROS.
   512
   513     05  SD-PASS-SPELLED-AMOUNT      PIC X(200)    VALUE SPACES.
   514
   515     05  FILLER.
   516         10  SD-PSA-LINE1            PIC X(100)    VALUE SPACES.
   517         10  SD-PSA-LINE2            PIC X(100)    VALUE SPACES.
   518
   519
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL688.cbl
   521*                            COPY ERC688W1.
   522*****************************************************************
   523*                                                               *
   524*                            ERC688W1                           *
   525*                            VMOD=2.002                         *
   526*                                                               *
   527*                                                               *
   528*****************************************************************.
   529 01  FILLER.
   530   05 WS-1ST-LINE-LENGTH         PIC S9(4) COMP SYNC VALUE +48.
   531   05 WS-1ST-LINE-LENGTH-PLUS-1  PIC S9(4) COMP SYNC VALUE +49.
   532   05 WS-1ST-LINE-LENGTH-PLUS-2  PIC S9(4) COMP SYNC VALUE +50.
   533   05 WS-1ST-LINE-LENGTH-MINUS-1 PIC S9(4) COMP SYNC VALUE +47.
   534   05 WS-2ND-LINE-LENGTH         PIC S9(4) COMP SYNC VALUE +48.
   535   05 WS-AMOUNT                  PIC 9(9)V99.
   536   05 FILLER REDEFINES WS-AMOUNT.
   537         10  WS-MILLIONS         PIC 999.
   538         10  WS-THOUSANDS        PIC 999.
   539         10  WS-HUNDREDS         PIC 999.
   540
   541         10  WS-CENTS            PIC 99.
   542         10  WS-CENTS-X REDEFINES WS-CENTS
   543                                 PIC XX.
   544
   545   05 WS-AMOUNT-WORK             PIC 999.
   546   05 FILLER REDEFINES WS-AMOUNT-WORK.
   547         10  WS-HUNDRED          PIC 9.
   548         10  WS-TEEN             PIC 99.
   549         10  FILLER REDEFINES WS-TEEN.
   550             15  WS-TEN          PIC 9.
   551             15  WS-ONE          PIC 9.
   552
   553   05 WS-SPELLED-AMOUNT          PIC X(200)      VALUE SPACES.
   554   05 WS-CHAR REDEFINES WS-SPELLED-AMOUNT
   555                                 PIC X OCCURS 200
   556                                       INDEXED BY SA-INDEX
   557                                                  SA-INDEX2.
   558
   559   05 WS-SPELLED-LINE1           PIC X(100)      VALUE SPACES.
   560   05 WS-SL1 REDEFINES WS-SPELLED-LINE1
   561                                 PIC X OCCURS 100
   562                                       INDEXED BY SL1-INDEX.
   563
   564   05 WS-SPELLED-LINE2           PIC X(100)      VALUE SPACES.
   565   05 WS-SL2 REDEFINES WS-SPELLED-LINE2
   566                                 PIC X OCCURS 100
   567                                       INDEXED BY SL2-INDEX.
   568
   569   05 WS-WORD                    PIC X(21)       VALUE SPACES.
   570   05 WS-CHAR2 REDEFINES WS-WORD
   571                                 PIC X OCCURS 21
   572                                       INDEXED BY CHAR-INDEX.
   573   05 WS-SINGLE-AREA.
   574         10  FILLER    PIC X(21)      VALUE 'ONE'.
   575         10  FILLER    PIC X(21)      VALUE 'TWO'.
   576         10  FILLER    PIC X(21)      VALUE 'THREE'.
   577         10  FILLER    PIC X(21)      VALUE 'FOUR'.
   578         10  FILLER    PIC X(21)      VALUE 'FIVE'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL688.cbl
   579         10  FILLER    PIC X(21)      VALUE 'SIX'.
   580         10  FILLER    PIC X(21)      VALUE 'SEVEN'.
   581         10  FILLER    PIC X(21)      VALUE 'EIGHT'.
   582         10  FILLER    PIC X(21)      VALUE 'NINE'.
   583         10  FILLER    PIC X(21)      VALUE 'TEN'.
   584         10  FILLER    PIC X(21)      VALUE 'ELEVEN'.
   585         10  FILLER    PIC X(21)      VALUE 'TWELVE'.
   586         10  FILLER    PIC X(21)      VALUE 'THIRTEEN'.
   587         10  FILLER    PIC X(21)      VALUE 'FOURTEEN'.
   588         10  FILLER    PIC X(21)      VALUE 'FIFTEEN'.
   589         10  FILLER    PIC X(21)      VALUE 'SIXTEEN'.
   590         10  FILLER    PIC X(21)      VALUE 'SEVENTEEN'.
   591         10  FILLER    PIC X(21)      VALUE 'EIGHTEEN'.
   592         10  FILLER    PIC X(21)      VALUE 'NINETEEN'.
   593   05 WS-SINGLE-DESC REDEFINES WS-SINGLE-AREA
   594                                     PIC X(21) OCCURS 19
   595                                     INDEXED BY SINGLE-INDEX.
   596
   597   05 WS-UPPER-AREA.
   598         10  FILLER    PIC X(21)      VALUE SPACES.
   599         10  FILLER    PIC X(21)      VALUE 'TWENTY'.
   600         10  FILLER    PIC X(21)      VALUE 'THIRTY'.
   601         10  FILLER    PIC X(21)      VALUE 'FORTY'.
   602         10  FILLER    PIC X(21)      VALUE 'FIFTY'.
   603         10  FILLER    PIC X(21)      VALUE 'SIXTY'.
   604         10  FILLER    PIC X(21)      VALUE 'SEVENTY'.
   605         10  FILLER    PIC X(21)      VALUE 'EIGHTY'.
   606         10  FILLER    PIC X(21)      VALUE 'NINETY'.
   607   05 WS-UPPER-DESC REDEFINES WS-UPPER-AREA
   608                                     PIC X(21) OCCURS 9
   609                                     INDEXED BY UPPER-INDEX.
   610
   611   05 WS-DOLLARS-AND-CENTS           PIC X(21)  VALUE
   612                                    'DOLLARS-AND-XX-CENTS'.
   613   05 FILLER REDEFINES WS-DOLLARS-AND-CENTS.
   614         10  FILLER                  PIC X(12).
   615         10  WS-PENNEYS              PIC XX.
   616         10  FILLER                  PIC X(07).
   617
   618
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL688.cbl
   620*                            COPY ERC688CR.
   621******************************************************************
   622*                                                                *
   623*                            ERC688CR                            *
   624*                            VMOD=2.001                          *
   625*                                                                *
   626*   DESCRIPTION:  STANDARD FORMAT CHECK PRINT LINES              *
   627*                                                                *
   628******************************************************************
   629
   630 01  CHECK-PRINT-LINES.
   631     12  CHECK-PRINT-LINE-1.
   632         16  FILLER                  PIC X     VALUE '1'.
   633
   634     12  CHECK-PRINT-LINE-3.
   635         16  FILLER                  PIC X     VALUE '0'.
   636
   637     12  CHECK-PRINT-LINE-5.
   638         16  FILLER                  PIC X(10) VALUE '0'.
   639         16  CPL5-COMPANY-NAME       PIC X(30) VALUE ALL 'X'.
   640
   641     12  CHECK-PRINT-LINE-6.
   642         16  FILLER                  PIC X(10) VALUE SPACES.
   643         16  CPL6-COMPANY-ADDRESS1   PIC X(30) VALUE ALL 'X'.
   644         16  FILLER                  PIC X(25) VALUE SPACES.
   645         16  CPL6-CHECK-NUMBER       PIC X(7)  VALUE ALL 'X'.
   646
   647     12  CHECK-PRINT-LINE-7.
   648         16  FILLER                  PIC X(10) VALUE SPACES.
   649         16  CPL7-COMPANY-ADDRESS2   PIC X(30) VALUE ALL 'X'.
   650         16  FILLER                  PIC X(5)  VALUE SPACES.
   651         16  CPL7-CHECK-DATE         PIC X(18) VALUE ALL 'X'.
   652
   653     12  CHECK-PRINT-LINE-8.
   654         16  FILLER                  PIC X(10) VALUE SPACES.
   655         16  CPL8-COMPANY-ADDRESS3   PIC X(30) VALUE ALL 'X'.
   656
   657     12  CHECK-PRINT-LINE-9.
   658         16  FILLER                  PIC X(10) VALUE SPACES.
   659         16  CPL9-COMPANY-CITY-ST    PIC X(30) VALUE ALL 'X'.
   660         16  FILLER                  PIC X     VALUE SPACES.
   661         16  CPL9-COMPANY-ZIP-CODE-X PIC X(9)  VALUE SPACES.
   662         16  CPL9-COMPANY-ZIP-CODE   REDEFINES
   663             CPL9-COMPANY-ZIP-CODE-X PIC Z(9).
   664
   665     12  CHECK-PRINT-LINE-11.
   666         16  FILLER                  PIC X     VALUE '0'.
   667         16  FILLER                  PIC X(9)  VALUE
   668                                                   '    PAY'.
   669         16  CPL11-PAY-LINE-1        PIC X(48) VALUE ALL 'X'.
   670         16  FILLER                  PIC X(7)  VALUE SPACES.
   671         16  CPL11-CHECK-AMOUNT      PIC $*,***,**9.99-.
   672
   673     12  CHECK-PRINT-LINE-12.
   674         16  FILLER                  PIC X(10) VALUE SPACES.
   675         16  CPL12-PAY-LINE-2        PIC X(48) VALUE ALL 'X'.
   676
   677     12  CHECK-PRINT-LINE-14.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL688.cbl
   678         16  FILLER                  PIC X(10) VALUE '0'.
   679         16  CPL14-PAYEE-NAME        PIC X(30) VALUE ALL 'X'.
   680
   681     12  CHECK-PRINT-LINE-15.
   682         16  FILLER                  PIC X(10) VALUE SPACES.
   683         16  CPL15-PAYEE-ADDRESS1    PIC X(30) VALUE ALL 'X'.
   684         16  FILLER                  PIC X(10) VALUE SPACES.
   685
   686     12  CHECK-PRINT-LINE-16.
   687         16  FILLER                  PIC X(10) VALUE SPACES.
   688         16  CPL16-PAYEE-ADDRESS2    PIC X(30) VALUE ALL 'X'.
   689         16  FILLER                  PIC X(10) VALUE SPACES.
   690
   691     12  CHECK-PRINT-LINE-17.
   692         16  FILLER                  PIC X(10) VALUE SPACES.
   693         16  CPL17-PAYEE-ADDRESS3    PIC X(30) VALUE ALL 'X'.
   694         16  FILLER                  PIC X(10) VALUE SPACES.
   695
   696     12  CHECK-PRINT-LINE-18.
   697         16  FILLER                  PIC X(10) VALUE SPACES.
   698         16  CPL18-PAYEE-CITY-ST     PIC X(30) VALUE ALL 'X'.
   699         16  FILLER                  PIC X     VALUE SPACES.
   700         16  CPL18-PAYEE-ZIP-CODE-X  PIC X(9)  VALUE SPACES.
   701         16  CPL18-PAYEE-ZIP-CODE    REDEFINES
   702             CPL18-PAYEE-ZIP-CODE-X  PIC Z(9).
   703
   704     12  CHECK-PRINT-LINE-21.
   705         16  FILLER                  PIC X     VALUE '-'.
   706
   707     12  CHECK-PRINT-LINE-22.
   708         16  FILLER                  PIC X     VALUE SPACE.
   709
   710     12  CHECK-PRINT-LINE-23.
   711         16  FILLER                  PIC X(7)   VALUE
   712             '-   CO-'.
   713         16  CPL23-COMPANY-ID        PIC X(3)   VALUE ALL 'X'.
   714         16  FILLER                  PIC X(8)   VALUE
   715             '  GROUP-'.
   716         16  CPL23-GROUP             PIC X(3)   VALUE ALL 'X'.
   717         16  FILLER                  PIC X(10)  VALUE
   718             '  ACCOUNT-'.
   719         16  CPL23-ACCOUNT           PIC X(6)   VALUE ALL 'X'.
   720         16  CPL23-DESC              PIC X(11)  VALUE SPACES.
   721         16  CPL23-FIN-RESP          PIC X(8)   VALUE ALL 'X'.
   722         16  FILLER                  PIC X(10)  VALUE
   723             '  DEPT NO-'.
   724         16  CPL23-DEPT-NO           PIC X(4)   VALUE ALL 'X'.
   725         16  FILLER                  PIC X(12)  VALUE SPACES.
   726
   727     12  CHECK-PRINT-LINE-25.
   728         16  CPL25-CERT-NO-DESC      PIC X(12)  VALUE
   729             '    CERT NO-'.
   730         16  CPL25-CERT-NO           PIC X(8)   VALUE ALL 'X'.
   731         16  FILLER                  PIC X(11)  VALUE
   732             '  CHECK NO-'.
   733         16  CPL25-CHECK-NO          PIC X(7)   VALUE ALL 'X'.
   734         16  FILLER                  PIC X(14)  VALUE
   735             '  AMOUNT PAID-'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL688.cbl
   736         16  CPL25-NET-PAYOFF        PIC Z,ZZZ,ZZ9.99-.
   737         16  CPL25-MONTHLY-BENEFIT   REDEFINES
   738             CPL25-NET-PAYOFF        PIC Z,ZZZ,ZZ9.99-.
   739         16  CPL25-MONTHLY-BENEFIT-X REDEFINES
   740             CPL25-NET-PAYOFF        PIC X(13).
   741
   742     12  CHECK-PRINT-LINE-26.
   743         16  FILLER                  PIC X(4)  VALUE '0'.
   744         16  CPL26-COMMENTS          PIC X(40) VALUE ALL 'X'.
   745         16  FILLER                  PIC X(18) VALUE
   746             '   GENERAL LEDGER-'.
   747         16  CPL26-GEN-LEDGER        PIC X(7)  VALUE ALL 'X'.
   748
   749     12  CHECK-PRINT-LINE-27.
   750         16  FILLER                  PIC X(4)  VALUE '0'.
   751         16  CPL27-STUB              PIC X(50) VALUE ALL 'X'.
   752
   753     12  CHECK-PRINT-LINE-28.
   754         16  FILLER                  PIC X(4)  VALUE SPACES.
   755         16  CPL28-STUB              PIC X(50) VALUE ALL 'X'.
   756
   757     12  CHECK-PRINT-LINE-29.
   758         16  FILLER                  PIC X(4)  VALUE SPACES.
   759         16  CPL29-STUB              PIC X(50) VALUE ALL 'X'.
   760
   761     12  CHECK-PRINT-LINE-30.
   762         16  FILLER                  PIC X(4)  VALUE SPACES.
   763         16  CPL30-STUB              PIC X(50) VALUE ALL 'X'.
   764
   765     12  CHECK-PRINT-LINE-31.
   766         16  FILLER                  PIC X(4)  VALUE SPACES.
   767         16  CPL31-STUB              PIC X(50) VALUE ALL 'X'.
   768
   769
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL688.cbl
   771
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL688.cbl
   773 01  CHECK-PRINT-LINES-SAVE-AREA     PIC X(1500) VALUE SPACES.
   774
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL688.cbl
   776*                            COPY ELCDATE.
   777******************************************************************
   778*                                                                *
   779*                                                                *
   780*                            ELCDATE.                            *
   781*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   782*                            VMOD=2.003
   783*                                                                *
   784*                                                                *
   785*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   786*                 LENGTH = 200                                   *
   787******************************************************************
   788
   789 01  DATE-CONVERSION-DATA.
   790     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   791     12  DC-OPTION-CODE                PIC X.
   792         88  BIN-TO-GREG                VALUE ' '.
   793         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   794         88  EDIT-GREG-TO-BIN           VALUE '2'.
   795         88  YMD-GREG-TO-BIN            VALUE '3'.
   796         88  MDY-GREG-TO-BIN            VALUE '4'.
   797         88  JULIAN-TO-BIN              VALUE '5'.
   798         88  BIN-PLUS-ELAPSED           VALUE '6'.
   799         88  FIND-CENTURY               VALUE '7'.
   800         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   801         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   802         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   803         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   804         88  JULIAN-TO-BIN-3            VALUE 'C'.
   805         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   806         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   807         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   808         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   809         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   810         88  CHECK-LEAP-YEAR            VALUE 'H'.
   811         88  BIN-3-TO-GREG              VALUE 'I'.
   812         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   813         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   814         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   815         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   816         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   817         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   818         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   819         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   820         88  THREE-CHARACTER-BIN
   821                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   822         88  GREGORIAN-TO-BIN
   823                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   824         88  BIN-TO-GREGORIAN
   825                  VALUES ' ' '1' 'I' '8' 'G'.
   826         88  JULIAN-TO-BINARY
   827                  VALUES '5' 'C' 'E' 'F'.
   828     12  DC-ERROR-CODE                 PIC X.
   829         88  NO-CONVERSION-ERROR        VALUE ' '.
   830         88  DATE-CONVERSION-ERROR
   831                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   832         88  DATE-IS-ZERO               VALUE '1'.
   833         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL688.cbl
   834         88  DATE-IS-INVALID            VALUE '3'.
   835         88  DATE1-GREATER-DATE2        VALUE '4'.
   836         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   837         88  DATE-INVALID-OPTION        VALUE '9'.
   838         88  INVALID-CENTURY            VALUE 'A'.
   839         88  ONLY-CENTURY               VALUE 'B'.
   840         88  ONLY-LEAP-YEAR             VALUE 'C'.
   841         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   842     12  DC-END-OF-MONTH               PIC X.
   843         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   844     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   845         88  USE-NORMAL-PROCESS         VALUE ' '.
   846         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   847         88  ADJUST-UP-100-YRS          VALUE '2'.
   848     12  FILLER                        PIC X.
   849     12  DC-CONVERSION-DATES.
   850         16  DC-BIN-DATE-1             PIC XX.
   851         16  DC-BIN-DATE-2             PIC XX.
   852         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   853         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   854                       DC-GREG-DATE-1-EDIT.
   855             20  DC-EDIT1-MONTH        PIC 99.
   856             20  SLASH1-1              PIC X.
   857             20  DC-EDIT1-DAY          PIC 99.
   858             20  SLASH1-2              PIC X.
   859             20  DC-EDIT1-YEAR         PIC 99.
   860         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   861         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   862                     DC-GREG-DATE-2-EDIT.
   863             20  DC-EDIT2-MONTH        PIC 99.
   864             20  SLASH2-1              PIC X.
   865             20  DC-EDIT2-DAY          PIC 99.
   866             20  SLASH2-2              PIC X.
   867             20  DC-EDIT2-YEAR         PIC 99.
   868         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   869         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   870                     DC-GREG-DATE-1-YMD.
   871             20  DC-YMD-YEAR           PIC 99.
   872             20  DC-YMD-MONTH          PIC 99.
   873             20  DC-YMD-DAY            PIC 99.
   874         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   875         16  DC-GREG-DATE-1-MDY-R REDEFINES
   876                      DC-GREG-DATE-1-MDY.
   877             20  DC-MDY-MONTH          PIC 99.
   878             20  DC-MDY-DAY            PIC 99.
   879             20  DC-MDY-YEAR           PIC 99.
   880         16  DC-GREG-DATE-1-ALPHA.
   881             20  DC-ALPHA-MONTH        PIC X(10).
   882             20  DC-ALPHA-DAY          PIC 99.
   883             20  FILLER                PIC XX.
   884             20  DC-ALPHA-CENTURY.
   885                 24 DC-ALPHA-CEN-N     PIC 99.
   886             20  DC-ALPHA-YEAR         PIC 99.
   887         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   888         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   889         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   890         16  DC-JULIAN-DATE            PIC 9(05).
   891         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL688.cbl
   892                                       PIC 9(05).
   893         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   894             20  DC-JULIAN-YEAR        PIC 99.
   895             20  DC-JULIAN-DAYS        PIC 999.
   896         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   897         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   898         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   899     12  DATE-CONVERSION-VARIBLES.
   900         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   901         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   902             20  FILLER                PIC 9(3).
   903             20  HOLD-CEN-1-CCYY.
   904                 24  HOLD-CEN-1-CC     PIC 99.
   905                 24  HOLD-CEN-1-YY     PIC 99.
   906             20  HOLD-CEN-1-MO         PIC 99.
   907             20  HOLD-CEN-1-DA         PIC 99.
   908         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   909             20  HOLD-CEN-1-R-MO       PIC 99.
   910             20  HOLD-CEN-1-R-DA       PIC 99.
   911             20  HOLD-CEN-1-R-CCYY.
   912                 24  HOLD-CEN-1-R-CC   PIC 99.
   913                 24  HOLD-CEN-1-R-YY   PIC 99.
   914             20  FILLER                PIC 9(3).
   915         16  HOLD-CENTURY-1-X.
   916             20  FILLER                PIC X(3)  VALUE SPACES.
   917             20  HOLD-CEN-1-X-CCYY.
   918                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   919                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   920             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   921             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   922         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   923             20  HOLD-CEN-1-R-X-MO     PIC XX.
   924             20  HOLD-CEN-1-R-X-DA     PIC XX.
   925             20  HOLD-CEN-1-R-X-CCYY.
   926                 24  HOLD-CEN-1-R-X-CC PIC XX.
   927                 24  HOLD-CEN-1-R-X-YY PIC XX.
   928             20  FILLER                PIC XXX.
   929         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   930         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   931         16  DC-JULIAN-DATE-1          PIC 9(07).
   932         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   933             20  DC-JULIAN-1-CCYY.
   934                 24  DC-JULIAN-1-CC    PIC 99.
   935                 24  DC-JULIAN-1-YR    PIC 99.
   936             20  DC-JULIAN-DA-1        PIC 999.
   937         16  DC-JULIAN-DATE-2          PIC 9(07).
   938         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   939             20  DC-JULIAN-2-CCYY.
   940                 24  DC-JULIAN-2-CC    PIC 99.
   941                 24  DC-JULIAN-2-YR    PIC 99.
   942             20  DC-JULIAN-DA-2        PIC 999.
   943         16  DC-GREG-DATE-A-EDIT.
   944             20  DC-EDITA-MONTH        PIC 99.
   945             20  SLASHA-1              PIC X VALUE '/'.
   946             20  DC-EDITA-DAY          PIC 99.
   947             20  SLASHA-2              PIC X VALUE '/'.
   948             20  DC-EDITA-CCYY.
   949                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL688.cbl
   950                 24  DC-EDITA-YEAR     PIC 99.
   951         16  DC-GREG-DATE-B-EDIT.
   952             20  DC-EDITB-MONTH        PIC 99.
   953             20  SLASHB-1              PIC X VALUE '/'.
   954             20  DC-EDITB-DAY          PIC 99.
   955             20  SLASHB-2              PIC X VALUE '/'.
   956             20  DC-EDITB-CCYY.
   957                 24  DC-EDITB-CENT     PIC 99.
   958                 24  DC-EDITB-YEAR     PIC 99.
   959         16  DC-GREG-DATE-CYMD         PIC 9(08).
   960         16  DC-GREG-DATE-CYMD-R REDEFINES
   961                              DC-GREG-DATE-CYMD.
   962             20  DC-CYMD-CEN           PIC 99.
   963             20  DC-CYMD-YEAR          PIC 99.
   964             20  DC-CYMD-MONTH         PIC 99.
   965             20  DC-CYMD-DAY           PIC 99.
   966         16  DC-GREG-DATE-MDCY         PIC 9(08).
   967         16  DC-GREG-DATE-MDCY-R REDEFINES
   968                              DC-GREG-DATE-MDCY.
   969             20  DC-MDCY-MONTH         PIC 99.
   970             20  DC-MDCY-DAY           PIC 99.
   971             20  DC-MDCY-CEN           PIC 99.
   972             20  DC-MDCY-YEAR          PIC 99.
   973    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   974        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   975    12  DC-EL310-DATE                  PIC X(21).
   976    12  FILLER                         PIC X(28).
   977
   978*                            COPY ELPRTCVD.
   979*****************************************************************
   980*                                                               *
   981*                            ELPRTCVD.                          *
   982*                            VMOD=2.001                         *
   983*****************************************************************.
   984
   985******************************************************************
   986***   WORK AREAS  FOR TERMINAL ONLINE PRINT ROUTINE
   987***                 -ELPRTCVD-
   988***   TO BE USED WITH PROCEDURE COPY MEMBER -ELPRTCVP-
   989******************************************************************
   990
   991 01  S-WORK-AREA                     SYNC.
   992     12  WS-LINE-LEN                 PIC S9(4)       VALUE +80
   993                                     COMP.
   994
   995     12  WS-LINE-LENGTH              PIC S9(4)       VALUE ZERO
   996                                     COMP.
   997
   998     12  WS-BUFFER-SIZE              PIC S9(4)       VALUE +1916
   999                                     COMP.
  1000
  1001     12  WS-BUFFER-LENGTH            PIC S9(4)       VALUE ZERO
  1002                                     COMP.
  1003
  1004     12  WS-PROG-END                 PIC X           VALUE SPACES.
  1005
  1006     12  WS-PRINT-AREA.
  1007         16  WS-PASSED-CNTL-CHAR     PIC X           VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL688.cbl
  1008           88  SINGLE-SPACE                          VALUE ' '.
  1009           88  DOUBLE-SPACE                          VALUE '0'.
  1010           88  TRIPLE-SPACE                          VALUE '-'.
  1011           88  TOP-PAGE                              VALUE '1'.
  1012
  1013         16  WS-PASSED-DATA.
  1014             20  WS-PRINT-BYTE       PIC X
  1015                 OCCURS 132 TIMES    INDEXED BY PRT-INDEX.
  1016
  1017     12  WS-LINE-CNT                 PIC S9(3)        VALUE ZERO
  1018                                     COMP-3.
  1019     12  WS-WCC-CNTL                 PIC X(1)         VALUE 'H'.
  1020
  1021     12  WS-EM                       PIC S9(4)        VALUE +25
  1022                                     COMP.
  1023     12  FILLER   REDEFINES WS-EM.
  1024         16  FILLER                  PIC X.
  1025         16  T-EM                    PIC X.
  1026
  1027*    12  WS-SS                       PIC S9(4)        VALUE +21
  1028     12  WS-SS                       PIC S9(4)        VALUE +10
  1029                                     COMP.
  1030     12  FILLER   REDEFINES WS-SS.
  1031         16  FILLER                  PIC X.
  1032         16  T-SS                    PIC X.
  1033
  1034     12  WS-TP                       PIC S9(4)      VALUE +12
  1035                                     COMP.
  1036     12  FILLER   REDEFINES WS-TP.
  1037         16  FILLER                  PIC X.
  1038         16  T-TP                    PIC X.
  1039
  1040     12  WS-FIRST-TIME-SW            PIC X           VALUE '1'.
  1041         88  FIRST-TIME                              VALUE '1'.
  1042         88  FIRST-LINE-NEXT-BUFFER                  VALUE '2'.
  1043
  1044     12  WS-BUFFER-AREA.
  1045         16  WS-BUFFER-BYTE          PIC X
  1046             OCCURS 1920 TIMES       INDEXED BY BUFFER-INDEX
  1047                                                BUFFER-INDEX2.
  1048
  1049******************************************************************
  1050
  1051****************************************************************
  1052*
  1053* Copyright (c) 2007 by Clerity Solutions, Inc.
  1054* All rights reserved.
  1055*
  1056****************************************************************
  1057 01  DFHEIV.
  1058   02  DFHEIV0               PIC X(35).
  1059   02  DFHEIV1               PIC X(08).
  1060   02  DFHEIV2               PIC X(08).
  1061   02  DFHEIV3               PIC X(08).
  1062   02  DFHEIV4               PIC X(06).
  1063   02  DFHEIV5               PIC X(04).
  1064   02  DFHEIV6               PIC X(04).
  1065   02  DFHEIV7               PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL688.cbl
  1066   02  DFHEIV8               PIC X(02).
  1067   02  DFHEIV9               PIC X(01).
  1068   02  DFHEIV10              PIC S9(7) COMP-3.
  1069   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1070   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1071   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1072   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1073   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1074   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1075   02  DFHEIV17              PIC X(04).
  1076   02  DFHEIV18              PIC X(04).
  1077   02  DFHEIV19              PIC X(04).
  1078   02  DFHEIV20              USAGE IS POINTER.
  1079   02  DFHEIV21              USAGE IS POINTER.
  1080   02  DFHEIV22              USAGE IS POINTER.
  1081   02  DFHEIV23              USAGE IS POINTER.
  1082   02  DFHEIV24              USAGE IS POINTER.
  1083   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1084   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1085   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1086   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1087   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1088   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1089   02  FILLER                PIC X(02).
  1090   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1091   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1092   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1093   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1094   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1095 LINKAGE  SECTION.
  1096*****************************************************************
  1097*                                                               *
  1098* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1099* All rights reserved.                                          *
  1100*                                                               *
  1101*****************************************************************
  1102 01  dfheiblk.
  1103     02  eibtime          pic s9(7) comp-3.
  1104     02  eibdate          pic s9(7) comp-3.
  1105     02  eibtrnid         pic x(4).
  1106     02  eibtaskn         pic s9(7) comp-3.
  1107     02  eibtrmid         pic x(4).
  1108     02  dfheigdi         pic s9(4) comp.
  1109     02  eibcposn         pic s9(4) comp.
  1110     02  eibcalen         pic s9(4) comp.
  1111     02  eibaid           pic x(1).
  1112     02  eibfiller1       pic x(1).
  1113     02  eibfn            pic x(2).
  1114     02  eibfiller2       pic x(2).
  1115     02  eibrcode         pic x(6).
  1116     02  eibfiller3       pic x(2).
  1117     02  eibds            pic x(8).
  1118     02  eibreqid         pic x(8).
  1119     02  eibrsrce         pic x(8).
  1120     02  eibsync          pic x(1).
  1121     02  eibfree          pic x(1).
  1122     02  eibrecv          pic x(1).
  1123     02  eibsend          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL688.cbl
  1124     02  eibatt           pic x(1).
  1125     02  eibeoc           pic x(1).
  1126     02  eibfmh           pic x(1).
  1127     02  eibcompl         pic x(1).
  1128     02  eibsig           pic x(1).
  1129     02  eibconf          pic x(1).
  1130     02  eiberr           pic x(1).
  1131     02  eibrldbk         pic x(1).
  1132     02  eiberrcd         pic x(4).
  1133     02  eibsynrb         pic x(1).
  1134     02  eibnodat         pic x(1).
  1135     02  eibfiller5       pic x(2).
  1136     02  eibresp          pic 9(09) comp.
  1137     02  eibresp2         pic 9(09) comp.
  1138     02  dfheigdj         pic s9(4) comp.
  1139     02  dfheigdk         pic s9(4) comp.
  1140
  1141 01  DFHCOMMAREA                    PIC X(1024).
  1142
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL688.cbl
  1144*                            COPY ERCCPA.
  1145******************************************************************
  1146*                                                                *
  1147*                                                                *
  1148*                            ERCCPA                              *
  1149*                            VMOD=2.005                          *
  1150*                                                                *
  1151*   DESCRIPTION:  DATA TO BE PASSED TO CHECK WRITER ROUTINE.     *
  1152*   LENGTH: 700 CHARACTERS                                       *
  1153*                                                                *
  1154******************************************************************
  1155
  1156 01  CHECK-PASS-AREA.
  1157     12  CPA-ALIGNMENT               PIC S9(3)     COMP-3.
  1158     12  CPA-CARRIER                 PIC X.
  1159     12  CPA-GROUPING                PIC X(6).
  1160     12  CPA-ACCOUNT                 PIC X(10).
  1161     12  CPA-FIN-RESP                PIC X(10).
  1162     12  CPA-STATE                   PIC XX.
  1163     12  CPA-CERT-NO                 PIC X(11).
  1164
  1165     12  CPA-CAR-NAME                PIC X(30).
  1166     12  CPA-CAR-ADDRESS-LINE1       PIC X(30).
  1167     12  CPA-CAR-ADDRESS-LINE2       PIC X(30).
  1168     12  CPA-CAR-ADDRESS-LINE3       PIC X(30).
  1169     12  CPA-CAR-CITY-STATE          PIC X(30).
  1170     12  CPA-CAR-ZIP-CODE            PIC S9(9)     COMP-3.
  1171     12  CPA-PAYMENT-TYPE            PIC X.
  1172     12  CPA-PAYMENT-BY              PIC X(4).
  1173     12  CPA-CHECK-DATE              PIC X(2).
  1174     12  CPA-CHECK-NUMBER            PIC X(7).
  1175     12  CPA-AMOUNT-PAID             PIC S9(9)V99  COMP-3.
  1176     12  CPA-AMOUNT-PAID-TO-DATE     PIC S9(9)V99  COMP-3.
  1177     12  CPA-INCURRED-DT             PIC XX.
  1178     12  CPA-REPORTED-DT             PIC XX.
  1179     12  CPA-PAID-THRU-DT            PIC XX.
  1180     12  CPA-PAID-FROM-DT            PIC XX.
  1181     12  CPA-PAID-DT                 PIC XX.
  1182
  1183     12  CPA-PAYEE-NAME              PIC X(30).
  1184     12  CPA-PAYEE-IN-CARE-OF        PIC X(30).
  1185     12  CPA-PAYEE-ADDRESS-LINE1     PIC X(30).
  1186     12  CPA-PAYEE-ADDRESS-LINE2     PIC X(30).
  1187     12  CPA-PAYEE-CITY-ST           PIC X(30).
  1188     12  CPA-PAYEE-ZIP-CODE.
  1189         16  CPA-PAYEE-ZIP-PRIME.
  1190             20  CPA-PAYEE-PRI-1ST   PIC X.
  1191                 88  CPA-PAYEE-CAN-POST-CODE   VALUE 'A' THRU 'Z'.
  1192             20  FILLER              PIC X(4).
  1193         16  CPA-PAYEE-ZIP-PLUS4     PIC X(4).
  1194     12  CPA-PAYEE-CAN-POSTAL-CODE  REDEFINES  CPA-PAYEE-ZIP-CODE.
  1195         16  CPA-PAYEE-POST-1        PIC XXX.
  1196         16  CPA-PAYEE-POST-2        PIC XXX.
  1197         16  FILLER                  PIC XXX.
  1198     12  CPA-PAYEE-PHONE-NO          PIC S9(11)   COMP-3.
  1199
  1200     12  CPA-SOC-SEC-NO              PIC X(11).
  1201     12  CPA-MEMBER-NUMBER           PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL688.cbl
  1202     12  CPA-NO-OF-PMTS-MADE         PIC S9(3)    COMP-3.
  1203     12  CPA-GENERAL-LEDGER          PIC X(7).
  1204     12  CPA-CANC-DT                 PIC XX.
  1205     12  CPA-LF-REFUND               PIC S9(7)V99  COMP-3.
  1206     12  CPA-AH-REFUND               PIC S9(7)V99  COMP-3.
  1207     12  CPA-INSURED-NAME            PIC X(28).
  1208     12  CPA-CERT-EFF-DT             PIC XX.
  1209     12  CPA-DEDUCT-WITHHELD         PIC S9(5)V99  COMP-3.
  1210     12  CPA-ADDITIONAL-CHARGE       PIC S9(5)V99  COMP-3.
  1211     12  FILLER                      PIC X(26).
  1212     12  CPA-REST-OF-RECORD          PIC X(250).
  1213
  1214     12  CPA-CHECK-STUBS             REDEFINES
  1215         CPA-REST-OF-RECORD.
  1216         16  CPA-STUB1               PIC X(50).
  1217         16  CPA-STUB2               PIC X(50).
  1218         16  CPA-STUB3               PIC X(50).
  1219         16  CPA-STUB4               PIC X(50).
  1220         16  CPA-STUB5               PIC X(50).
  1221
  1222
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL688.cbl
  1224*                            COPY ERCMAIL.
  1225******************************************************************
  1226*                                                                *
  1227*                                                                *
  1228*                            ERCMAIL                             *
  1229*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1230*                            VMOD=2.003                          *
  1231*                                                                *
  1232*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  1233*                                                                *
  1234*   FILE TYPE = VSAM,KSDS                                        *
  1235*   RECORD SIZE = 374   RECFORM = FIX                            *
  1236*                                                                *
  1237*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  1238*   ALTERNATE PATH    = NOT USED                                 *
  1239*                                                                *
  1240*   LOG = YES                                                    *
  1241*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1242******************************************************************
  1243*                   C H A N G E   L O G
  1244*
  1245* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1246*-----------------------------------------------------------------
  1247*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1248* EFFECTIVE    NUMBER
  1249*-----------------------------------------------------------------
  1250* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  1251* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1252* 111108                   PEMA  ADD CRED BENE ADDR2
  1253******************************************************************
  1254
  1255 01  MAILING-DATA.
  1256     12  MA-RECORD-ID                      PIC XX.
  1257         88  VALID-MA-ID                       VALUE 'MA'.
  1258
  1259     12  MA-CONTROL-PRIMARY.
  1260         16  MA-COMPANY-CD                 PIC X.
  1261         16  MA-CARRIER                    PIC X.
  1262         16  MA-GROUPING.
  1263             20  MA-GROUPING-PREFIX        PIC XXX.
  1264             20  MA-GROUPING-PRIME         PIC XXX.
  1265         16  MA-STATE                      PIC XX.
  1266         16  MA-ACCOUNT.
  1267             20  MA-ACCOUNT-PREFIX         PIC X(4).
  1268             20  MA-ACCOUNT-PRIME          PIC X(6).
  1269         16  MA-CERT-EFF-DT                PIC XX.
  1270         16  MA-CERT-NO.
  1271             20  MA-CERT-PRIME             PIC X(10).
  1272             20  MA-CERT-SFX               PIC X.
  1273
  1274     12  FILLER                            PIC XX.
  1275
  1276     12  MA-ACCESS-CONTROL.
  1277         16  MA-SOURCE-SYSTEM              PIC XX.
  1278             88  MA-FROM-CREDIT                VALUE 'CR'.
  1279             88  MA-FROM-VSI                   VALUE 'VS'.
  1280             88  MA-FROM-WARRANTY              VALUE 'WA'.
  1281             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL688.cbl
  1282         16  MA-RECORD-ADD-DT              PIC XX.
  1283         16  MA-RECORD-ADDED-BY            PIC XXXX.
  1284         16  MA-LAST-MAINT-DT              PIC XX.
  1285         16  MA-LAST-MAINT-BY              PIC XXXX.
  1286         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  1287
  1288     12  MA-PROFILE-INFO.
  1289         16  MA-QUALIFY-CODE-1             PIC XX.
  1290         16  MA-QUALIFY-CODE-2             PIC XX.
  1291         16  MA-QUALIFY-CODE-3             PIC XX.
  1292         16  MA-QUALIFY-CODE-4             PIC XX.
  1293         16  MA-QUALIFY-CODE-5             PIC XX.
  1294
  1295         16  MA-INSURED-LAST-NAME          PIC X(15).
  1296         16  MA-INSURED-FIRST-NAME         PIC X(10).
  1297         16  MA-INSURED-MIDDLE-INIT        PIC X.
  1298         16  MA-INSURED-ISSUE-AGE          PIC 99.
  1299         16  MA-INSURED-BIRTH-DT           PIC XX.
  1300         16  MA-INSURED-SEX                PIC X.
  1301             88  MA-SEX-MALE                   VALUE 'M'.
  1302             88  MA-SEX-FEMALE                 VALUE 'F'.
  1303         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  1304
  1305         16  MA-ADDRESS-CORRECTED          PIC X.
  1306         16  MA-JOINT-BIRTH-DT             PIC XX.
  1307*        16  FILLER                        PIC X(12).
  1308
  1309         16  MA-ADDRESS-LINE-1             PIC X(30).
  1310         16  MA-ADDRESS-LINE-2             PIC X(30).
  1311         16  MA-CITY-STATE.
  1312             20  MA-CITY                   PIC X(28).
  1313             20  MA-ADDR-STATE             PIC XX.
  1314         16  MA-ZIP.
  1315             20  MA-ZIP-CODE.
  1316                 24  MA-ZIP-CODE-1ST       PIC X(1).
  1317                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1318                 24  FILLER                PIC X(4).
  1319             20  MA-ZIP-PLUS4              PIC X(4).
  1320         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  1321             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  1322             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  1323             20  FILLER                    PIC X(3).
  1324
  1325         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  1326
  1327         16  FILLER                        PIC XXX.
  1328*        16  FILLER                        PIC X(10).
  1329
  1330     12  MA-CRED-BENE-INFO.
  1331         16  MA-CRED-BENE-NAME                 PIC X(25).
  1332         16  MA-CRED-BENE-ADDR                 PIC X(30).
  1333         16  MA-CRED-BENE-ADDR2                PIC X(30).
  1334         16  MA-CRED-BENE-CTYST.
  1335             20  MA-CRED-BENE-CITY             PIC X(28).
  1336             20  MA-CRED-BENE-STATE            PIC XX.
  1337         16  MA-CRED-BENE-ZIP.
  1338             20  MA-CB-ZIP-CODE.
  1339                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL688.cbl
  1340                     88  MA-CB-CANADIAN-POST-CODE
  1341                                           VALUE 'A' THRU 'Z'.
  1342                 24  FILLER                    PIC X(4).
  1343             20  MA-CB-ZIP-PLUS4               PIC X(4).
  1344         16  MA-CB-CANADIAN-POSTAL-CODE
  1345                            REDEFINES MA-CRED-BENE-ZIP.
  1346             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  1347             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  1348             20  FILLER                        PIC X(3).
  1349     12  MA-POST-CARD-MAIL-DATA.
  1350         16  MA-MAIL-DATA OCCURS 7.
  1351             20  MA-MAIL-TYPE              PIC X.
  1352                 88  MA-12MO-MAILING           VALUE '1'.
  1353                 88  MA-EXP-MAILING            VALUE '2'.
  1354             20  MA-MAIL-STATUS            PIC X.
  1355                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  1356                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  1357                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  1358             20  MA-MAIL-DATE              PIC XX.
  1359     12  FILLER                            PIC XX.
  1360     12  FILLER                            PIC XX.
  1361*    12  FILLER                            PIC X(30).
  1362******************************************************************
  1363
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL688.cbl
  1365 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-PASS-AREA
  1366                          MAILING-DATA.
  1367 0000-DFHEXIT SECTION.
  1368     MOVE '9#                    $   ' TO DFHEIV0.
  1369     MOVE 'EL688' TO DFHEIV1.
  1370     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1371
  1372
  1373* EXEC CICS HANDLE CONDITION
  1374*        QIDERR  (5000-MAIN-LOGIC)
  1375*        ITEMERR (5000-MAIN-LOGIC)
  1376*        ERROR   (9990-ERROR) END-EXEC.
  1377*    MOVE '"$N<.                 ! " #00001368' TO DFHEIV0
  1378     MOVE X'22244E3C2E20202020202020' TO DFHEIV0(1:12)
  1379     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1380     MOVE X'2220233030303031333638' TO DFHEIV0(25:11)
  1381     CALL 'kxdfhei1' USING DFHEIV0
  1382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1383
  1384
  1385     MOVE +132                   TO  WS-LINE-LEN.
  1386     MOVE SPACES                 TO DL34-PROCESS-TYPE.
  1387
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL688.cbl
  1389 0010-MAIN-LOGIC.
  1390
  1391* EXEC CICS RETRIEVE
  1392*        INTO   (PROGRAM-INTERFACE-BLOCK)
  1393*        LENGTH (PI-COMM-LENGTH) END-EXEC
  1394*    MOVE '0*I L                 &   #00001378' TO DFHEIV0
  1395     MOVE X'302A49204C20202020202020' TO DFHEIV0(1:12)
  1396     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1397     MOVE X'2020233030303031333738' TO DFHEIV0(25:11)
  1398     CALL 'kxdfhei1' USING DFHEIV0,
  1399           PROGRAM-INTERFACE-BLOCK,
  1400           PI-COMM-LENGTH,
  1401           DFHEIV99,
  1402           DFHEIV99,
  1403           DFHEIV99
  1404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1405
  1406     MOVE +1                     TO  PI-TEMP-STORAGE-ITEM.
  1407
  1408* DLO034 OPEN WHEN DMD OR CID
  1409     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  1410         IF DL34-PROCESS-TYPE IS EQUAL TO SPACES
  1411             MOVE 'O'                TO DL34-PROCESS-TYPE
  1412             MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  1413             MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  1414             MOVE PI-PROCESSOR-ID    TO DL34-USERID
  1415             MOVE SPACES             TO DL34-PRINT-LINE
  1416             MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
  1417
  1418
  1419* EXEC CICS LINK
  1420*                PROGRAM    ('DLO034')
  1421*                COMMAREA   (DLO034-COMMUNICATION-AREA)
  1422*                LENGTH     (DLO034-REC-LENGTH)
  1423*            END-EXEC
  1424     MOVE 'DLO034' TO DFHEIV1
  1425*    MOVE '."C                   ''   #00001394' TO DFHEIV0
  1426     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1427     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1428     MOVE X'2020233030303031333934' TO DFHEIV0(25:11)
  1429     CALL 'kxdfhei1' USING DFHEIV0,
  1430           DFHEIV1,
  1431           DLO034-COMMUNICATION-AREA,
  1432           DLO034-REC-LENGTH,
  1433           DFHEIV99,
  1434           DFHEIV99,
  1435           DFHEIV99
  1436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1437
  1438             IF DL34-RETURN-CODE NOT = 'OK'
  1439                 MOVE  '**DLO034 OPEN ERROR - ABORT**'
  1440                                     TO WS-TEXT-MESSAGE
  1441                 PERFORM 0120-SEND-TEXT
  1442
  1443* EXEC CICS RETURN
  1444*                END-EXEC.
  1445*    MOVE '.(                    &   #00001404' TO DFHEIV0
  1446     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL688.cbl
  1447     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1448     MOVE X'2020233030303031343034' TO DFHEIV0(25:11)
  1449     CALL 'kxdfhei1' USING DFHEIV0,
  1450           DFHEIV99,
  1451           DFHEIV99,
  1452           DFHEIV99,
  1453           DFHEIV99,
  1454           DFHEIV99
  1455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1456
  1457
  1458 0100-MAIN-LOGIC.
  1459
  1460* EXEC CICS READQ TS
  1461*        QUEUE  (PI-TEMP-STORAGE-KEY)
  1462*        ITEM   (PI-TEMP-STORAGE-ITEM)
  1463*        LENGTH (WS-TS-LENGTH)
  1464*        SET    (ADDRESS OF CHECK-PASS-AREA) END-EXEC
  1465*    MOVE '*$SI   L              ''   #00001408' TO DFHEIV0
  1466     MOVE X'2A2453492020204C20202020' TO DFHEIV0(1:12)
  1467     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1468     MOVE X'2020233030303031343038' TO DFHEIV0(25:11)
  1469     CALL 'kxdfhei1' USING DFHEIV0,
  1470           PI-TEMP-STORAGE-KEY,
  1471           DFHEIV20,
  1472           WS-TS-LENGTH,
  1473           PI-TEMP-STORAGE-ITEM,
  1474           DFHEIV99,
  1475           DFHEIV99
  1476     SET ADDRESS OF CHECK-PASS-AREA TO
  1477         DFHEIV20
  1478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1479
  1480     IF WS-TS-LENGTH NOT GREATER THAN +1
  1481         MOVE ZERO               TO  WS-PROG-END
  1482         PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  1483         PERFORM 0110-CLOSE-DLO034
  1484
  1485* EXEC CICS DELETEQ TS
  1486*            QUEUE (PI-TEMP-STORAGE-KEY) END-EXEC
  1487*    MOVE '*&                    #   #00001418' TO DFHEIV0
  1488     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  1489     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1490     MOVE X'2020233030303031343138' TO DFHEIV0(25:11)
  1491     CALL 'kxdfhei1' USING DFHEIV0,
  1492           PI-TEMP-STORAGE-KEY,
  1493           DFHEIV99
  1494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1495
  1496* EXEC CICS RETURN
  1497*            END-EXEC.
  1498*    MOVE '.(                    &   #00001420' TO DFHEIV0
  1499     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1500     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1501     MOVE X'2020233030303031343230' TO DFHEIV0(25:11)
  1502     CALL 'kxdfhei1' USING DFHEIV0,
  1503           DFHEIV99,
  1504           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL688.cbl
  1505           DFHEIV99,
  1506           DFHEIV99,
  1507           DFHEIV99
  1508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1509
  1510
  1511
  1512     IF CPA-ALIGNMENT = ZERO
  1513         GO TO 0200-MAIN-LOGIC.
  1514
  1515     IF FIRST-ALIGNMENT
  1516         MOVE 'N'                TO  FIRST-TIME-SW
  1517         MOVE +999999.99         TO  CPL11-CHECK-AMOUNT
  1518                                     SD-PASS-AMOUNT
  1519                                     CPL25-NET-PAYOFF
  1520         PERFORM SPELL-DOLLAR
  1521         MOVE SD-PSA-LINE1       TO  CPL11-PAY-LINE-1
  1522         MOVE SD-PSA-LINE2       TO  CPL12-PAY-LINE-2.
  1523
  1524     IF PI-ASSIGN-CHECK-NUMBERS = 'N'
  1525         MOVE CPA-CHECK-NUMBER   TO  CPL6-CHECK-NUMBER
  1526       ELSE
  1527         MOVE ALL 'X'            TO  CPL6-CHECK-NUMBER.
  1528
  1529
  1530     GO TO 0300-MAIN-LOGIC.
  1531 0110-CLOSE-DLO034.
  1532
  1533* DLO034 CLOSE
  1534     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  1535         MOVE 'C'                TO DL34-PROCESS-TYPE
  1536         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  1537         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  1538         MOVE PI-PROCESSOR-ID    TO DL34-USERID
  1539         MOVE SPACES             TO DL34-PRINT-LINE
  1540                                    DL34-OVERRIDE-PRINTER-ID
  1541
  1542* EXEC CICS LINK
  1543*            PROGRAM    ('DLO034')
  1544*            COMMAREA   (DLO034-COMMUNICATION-AREA)
  1545*            LENGTH     (DLO034-REC-LENGTH)
  1546*        END-EXEC
  1547     MOVE 'DLO034' TO DFHEIV1
  1548*    MOVE '."C                   ''   #00001453' TO DFHEIV0
  1549     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1550     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1551     MOVE X'2020233030303031343533' TO DFHEIV0(25:11)
  1552     CALL 'kxdfhei1' USING DFHEIV0,
  1553           DFHEIV1,
  1554           DLO034-COMMUNICATION-AREA,
  1555           DLO034-REC-LENGTH,
  1556           DFHEIV99,
  1557           DFHEIV99,
  1558           DFHEIV99
  1559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1560
  1561         IF DL34-RETURN-CODE NOT = 'OK'
  1562             MOVE  '**DLO034 CLOSE ERROR - ABORT**'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL688.cbl
  1563                                 TO WS-TEXT-MESSAGE
  1564             PERFORM  0120-SEND-TEXT
  1565
  1566* EXEC CICS RETURN
  1567*            END-EXEC.
  1568*    MOVE '.(                    &   #00001463' TO DFHEIV0
  1569     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1570     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1571     MOVE X'2020233030303031343633' TO DFHEIV0(25:11)
  1572     CALL 'kxdfhei1' USING DFHEIV0,
  1573           DFHEIV99,
  1574           DFHEIV99,
  1575           DFHEIV99,
  1576           DFHEIV99,
  1577           DFHEIV99
  1578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1579
  1580
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL688.cbl
  1582
  1583 0120-SEND-TEXT.
  1584
  1585* EXEC CICS SEND TEXT
  1586*         FROM    (WS-TEXT-MESSAGE)
  1587*         LENGTH  (70)
  1588*         END-EXEC.
  1589     MOVE 70
  1590       TO DFHEIV11
  1591*    MOVE '8&      T       H   F -   #00001469' TO DFHEIV0
  1592     MOVE X'382620202020202054202020' TO DFHEIV0(1:12)
  1593     MOVE X'202020204820202046202D20' TO DFHEIV0(13:12)
  1594     MOVE X'2020233030303031343639' TO DFHEIV0(25:11)
  1595     CALL 'kxdfhei1' USING DFHEIV0,
  1596           WS-TEXT-MESSAGE,
  1597           DFHEIV11,
  1598           DFHEIV99,
  1599           DFHEIV99,
  1600           DFHEIV99,
  1601           DFHEIV99,
  1602           DFHEIV99,
  1603           DFHEIV99,
  1604           DFHEIV99,
  1605           DFHEIV99,
  1606           DFHEIV99,
  1607           DFHEIV99
  1608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1609
  1610
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL688.cbl
  1612 0200-MAIN-LOGIC.
  1613     IF CPA-ALIGNMENT NOT = ZERO
  1614        MOVE SPACES              TO  CPL5-COMPANY-NAME
  1615                                     CPL6-COMPANY-ADDRESS1
  1616                                     CPL7-COMPANY-ADDRESS2
  1617                                     CPL8-COMPANY-ADDRESS3
  1618                                     CPL9-COMPANY-CITY-ST
  1619                                     CPL9-COMPANY-ZIP-CODE-X
  1620        MOVE CPA-CHECK-NUMBER    TO  CPL6-CHECK-NUMBER
  1621        MOVE +9999999.99         TO  CPL11-CHECK-AMOUNT
  1622                                     CPL25-NET-PAYOFF
  1623                                     SD-PASS-AMOUNT
  1624        MOVE +48                 TO  WS-1ST-LINE-LENGTH
  1625                                     WS-2ND-LINE-LENGTH
  1626        PERFORM SPELL-DOLLAR
  1627        MOVE SD-PSA-LINE1        TO  CPL11-PAY-LINE-1
  1628        MOVE SD-PSA-LINE2        TO  CPL12-PAY-LINE-2
  1629        GO TO 0300-MAIN-LOGIC.
  1630
  1631     IF FIRST-ALIGNMENT
  1632         MOVE 'N'                TO  FIRST-TIME-SW
  1633     ELSE
  1634         GO TO 0210-MAIN-LOGIC.
  1635
  1636     MOVE SPACES                 TO  CPL5-COMPANY-NAME
  1637                                     CPL6-COMPANY-ADDRESS1
  1638                                     CPL7-COMPANY-ADDRESS2
  1639                                     CPL8-COMPANY-ADDRESS3
  1640                                     CPL9-COMPANY-CITY-ST
  1641                                     CPL9-COMPANY-ZIP-CODE-X.
  1642
  1643     IF CPL8-COMPANY-ADDRESS3 = SPACES
  1644         MOVE CPL9-COMPANY-CITY-ST  TO  CPL8-COMPANY-ADDRESS3
  1645         MOVE SPACES                TO  CPL9-COMPANY-CITY-ST.
  1646
  1647     IF CPL7-COMPANY-ADDRESS2 = SPACES
  1648         MOVE CPL8-COMPANY-ADDRESS3 TO  CPL7-COMPANY-ADDRESS2
  1649         MOVE CPL9-COMPANY-CITY-ST  TO  CPL8-COMPANY-ADDRESS3
  1650         MOVE SPACES                TO  CPL9-COMPANY-CITY-ST.
  1651
  1652     IF CPL6-COMPANY-ADDRESS1 = SPACES
  1653         MOVE CPL7-COMPANY-ADDRESS2 TO  CPL6-COMPANY-ADDRESS1
  1654         MOVE CPL8-COMPANY-ADDRESS3 TO  CPL7-COMPANY-ADDRESS2
  1655         MOVE CPL9-COMPANY-CITY-ST  TO  CPL8-COMPANY-ADDRESS3
  1656         MOVE SPACES                TO  CPL9-COMPANY-CITY-ST.
  1657
  1658     MOVE CHECK-PRINT-LINES      TO  CHECK-PRINT-LINES-SAVE-AREA.
  1659
  1660 0210-MAIN-LOGIC.
  1661     MOVE CHECK-PRINT-LINES-SAVE-AREA  TO  CHECK-PRINT-LINES.
  1662
  1663     MOVE CPA-CHECK-NUMBER        TO  CPL6-CHECK-NUMBER
  1664                                      CPL25-CHECK-NO.
  1665
  1666     IF CPA-CHECK-DATE NOT = LOW-VALUES
  1667         MOVE CPA-CHECK-DATE      TO  DC-BIN-DATE-1
  1668         MOVE SPACES              TO  DC-OPTION-CODE
  1669         PERFORM 8500-DATE-CONVERSION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL688.cbl
  1670         IF DC-ERROR-CODE = SPACES
  1671         MOVE DC-GREG-DATE-1-ALPHA  TO  CPL7-CHECK-DATE.
  1672
  1673     MOVE CPA-AMOUNT-PAID         TO  SD-PASS-AMOUNT
  1674                                      CPL11-CHECK-AMOUNT
  1675                                      CPL25-NET-PAYOFF.
  1676     PERFORM SPELL-DOLLAR.
  1677     MOVE SD-PSA-LINE1            TO  CPL11-PAY-LINE-1.
  1678     MOVE SD-PSA-LINE2            TO  CPL12-PAY-LINE-2.
  1679
  1680     MOVE CPA-PAYEE-NAME          TO  CPL14-PAYEE-NAME.
  1681     MOVE CPA-PAYEE-IN-CARE-OF    TO  CPL15-PAYEE-ADDRESS1.
  1682     MOVE CPA-PAYEE-ADDRESS-LINE1 TO  CPL16-PAYEE-ADDRESS2.
  1683     MOVE CPA-PAYEE-ADDRESS-LINE2 TO  CPL17-PAYEE-ADDRESS3.
  1684     MOVE CPA-PAYEE-CITY-ST       TO  CPL18-PAYEE-CITY-ST.
  1685     MOVE CPA-PAYEE-ZIP-CODE      TO  CPL18-PAYEE-ZIP-CODE-X.
  1686
  1687     MOVE CHECK-PRINT-LINE-18     TO  WS-ZIP-CODE-LINE.
  1688     SET ZIP-INDEX1 TO +40.
  1689     SET ZIP-INDEX2 TO +42.
  1690     PERFORM 5100-MOVE-ZIP-CODE.
  1691     MOVE WS-ZIP-CODE-LINE        TO  CHECK-PRINT-LINE-18.
  1692
  1693     IF CPL17-PAYEE-ADDRESS3 = SPACES
  1694         MOVE CHECK-PRINT-LINE-18  TO  CHECK-PRINT-LINE-17
  1695         MOVE SPACES              TO  CHECK-PRINT-LINE-18.
  1696
  1697     IF CPL16-PAYEE-ADDRESS2 = SPACES
  1698         MOVE CHECK-PRINT-LINE-17  TO  CHECK-PRINT-LINE-16
  1699         MOVE CHECK-PRINT-LINE-18  TO  CHECK-PRINT-LINE-17
  1700         MOVE SPACES             TO  CHECK-PRINT-LINE-18.
  1701
  1702     IF CPL15-PAYEE-ADDRESS1 = SPACES
  1703         MOVE CHECK-PRINT-LINE-16  TO  CHECK-PRINT-LINE-15
  1704         MOVE CHECK-PRINT-LINE-17  TO  CHECK-PRINT-LINE-16
  1705         MOVE CHECK-PRINT-LINE-18  TO  CHECK-PRINT-LINE-17
  1706         MOVE SPACES             TO  CHECK-PRINT-LINE-18.
  1707
  1708     IF CPA-CERT-NO = SPACES
  1709         MOVE SPACES             TO  CPL25-CERT-NO-DESC.
  1710
  1711     MOVE PI-COMPANY-ID          TO  CPL23-COMPANY-ID.
  1712     MOVE CPA-GROUPING           TO  CPL23-GROUP.
  1713     MOVE CPA-ACCOUNT            TO  CPL23-ACCOUNT.
  1714     MOVE CPA-CERT-NO            TO  CPL25-CERT-NO.
  1715     MOVE CPA-GENERAL-LEDGER     TO  CPL26-GEN-LEDGER.
  1716     MOVE ZEROS                  TO  CPL23-DEPT-NO.
  1717     MOVE SPACES                 TO  CPL26-COMMENTS.
  1718
  1719     IF CPA-FIN-RESP = SPACES
  1720         MOVE '    STATE -'      TO  CPL23-DESC
  1721         MOVE CPA-STATE          TO  CPL23-FIN-RESP
  1722     ELSE
  1723         MOVE '  FIN-RESP-'      TO  CPL23-DESC
  1724         MOVE CPA-FIN-RESP       TO  CPL23-FIN-RESP.
  1725
  1726     MOVE CPA-STUB1              TO  CPL27-STUB.
  1727     MOVE CPA-STUB2              TO  CPL28-STUB.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL688.cbl
  1728     MOVE CPA-STUB3              TO  CPL29-STUB.
  1729     MOVE CPA-STUB4              TO  CPL30-STUB.
  1730     MOVE CPA-STUB5              TO  CPL31-STUB.
  1731
  1732 0300-MAIN-LOGIC.
  1733     MOVE CHECK-PRINT-LINE-1     TO  WS-PRINT-AREA.
  1734     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1735
  1736     MOVE CHECK-PRINT-LINE-3     TO  WS-PRINT-AREA.
  1737     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1738
  1739     MOVE CHECK-PRINT-LINE-5     TO  WS-PRINT-AREA.
  1740     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1741
  1742     MOVE CHECK-PRINT-LINE-6     TO  WS-PRINT-AREA.
  1743     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1744
  1745     MOVE CHECK-PRINT-LINE-7     TO  WS-PRINT-AREA.
  1746     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1747
  1748     MOVE CHECK-PRINT-LINE-8     TO  WS-PRINT-AREA.
  1749     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1750
  1751     MOVE CHECK-PRINT-LINE-9     TO  WS-PRINT-AREA.
  1752     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1753
  1754     MOVE CHECK-PRINT-LINE-11    TO  WS-PRINT-AREA.
  1755     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1756
  1757     MOVE CHECK-PRINT-LINE-12    TO  WS-PRINT-AREA.
  1758     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1759
  1760     MOVE CHECK-PRINT-LINE-14    TO  WS-PRINT-AREA.
  1761     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1762
  1763     MOVE CHECK-PRINT-LINE-15    TO  WS-PRINT-AREA.
  1764     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1765
  1766     MOVE CHECK-PRINT-LINE-16    TO  WS-PRINT-AREA.
  1767     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1768
  1769     MOVE CHECK-PRINT-LINE-17    TO  WS-PRINT-AREA.
  1770     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1771
  1772     MOVE CHECK-PRINT-LINE-18    TO  WS-PRINT-AREA.
  1773     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1774
  1775     MOVE CHECK-PRINT-LINE-21    TO  WS-PRINT-AREA.
  1776     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1777
  1778     MOVE CHECK-PRINT-LINE-22    TO  WS-PRINT-AREA.
  1779     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1780
  1781     MOVE CHECK-PRINT-LINE-23    TO  WS-PRINT-AREA.
  1782     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1783
  1784     MOVE CHECK-PRINT-LINE-25    TO  WS-PRINT-AREA.
  1785     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL688.cbl
  1786
  1787     MOVE CHECK-PRINT-LINE-26    TO  WS-PRINT-AREA.
  1788     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1789
  1790     MOVE CHECK-PRINT-LINE-27    TO  WS-PRINT-AREA.
  1791     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1792
  1793     MOVE CHECK-PRINT-LINE-28    TO  WS-PRINT-AREA.
  1794     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1795
  1796     MOVE CHECK-PRINT-LINE-29    TO  WS-PRINT-AREA.
  1797     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1798
  1799     MOVE CHECK-PRINT-LINE-30    TO  WS-PRINT-AREA.
  1800     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1801
  1802     MOVE CHECK-PRINT-LINE-31    TO  WS-PRINT-AREA.
  1803     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1804
  1805     MOVE +1                     TO  WS-DATA-SENT-SW.
  1806
  1807     ADD +1  TO  PI-TEMP-STORAGE-ITEM.
  1808
  1809     GO TO 0100-MAIN-LOGIC.
  1810
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL688.cbl
  1812
  1813
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL688.cbl
  1815 5000-MAIN-LOGIC  SECTION.
  1816     IF WS-DATA-SENT-SW NOT = ZERO
  1817         MOVE ZERO               TO  WS-PROG-END
  1818                                     WS-DATA-SENT-SW
  1819         PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1820
  1821
  1822* EXEC CICS DELAY
  1823*        INTERVAL (WS-DELAY-INTERVAL) END-EXEC.
  1824*    MOVE '0$I                   &   #00001684' TO DFHEIV0
  1825     MOVE X'302449202020202020202020' TO DFHEIV0(1:12)
  1826     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1827     MOVE X'2020233030303031363834' TO DFHEIV0(25:11)
  1828     CALL 'kxdfhei1' USING DFHEIV0,
  1829           WS-DELAY-INTERVAL,
  1830           DFHEIV99,
  1831           DFHEIV99,
  1832           DFHEIV99,
  1833           DFHEIV99
  1834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1835
  1836
  1837     GO TO 0100-MAIN-LOGIC.
  1838
  1839 5000-EXIT.
  1840      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL688.cbl
  1842 5100-MOVE-ZIP-CODE SECTION.
  1843
  1844     SET ZIP-INDEX3 TO ZIP-INDEX2.
  1845     SET ZIP-INDEX3 UP BY +10.
  1846
  1847 5110-MOVE-ZIP-CODE.
  1848     IF WS-ZIP-CHAR (ZIP-INDEX1) NOT = SPACES
  1849         SET ZIP-INDEX1 UP BY +2
  1850         GO TO 5120-MOVE-ZIP-CODE.
  1851
  1852     IF ZIP-INDEX1 GREATER THAN +1
  1853         SET ZIP-INDEX1 DOWN BY +1
  1854         GO TO 5110-MOVE-ZIP-CODE.
  1855
  1856     GO TO 5190-MOVE-ZIP-CODE-EXIT.
  1857
  1858 5120-MOVE-ZIP-CODE.
  1859     MOVE WS-ZIP-CHAR (ZIP-INDEX2) TO WS-ZIP-CHAR (ZIP-INDEX1).
  1860     MOVE SPACES                   TO WS-ZIP-CHAR (ZIP-INDEX2).
  1861
  1862     IF ZIP-INDEX2 LESS THAN ZIP-INDEX3
  1863         SET ZIP-INDEX1
  1864             ZIP-INDEX2 UP BY +1
  1865         GO TO 5120-MOVE-ZIP-CODE.
  1866
  1867 5190-MOVE-ZIP-CODE-EXIT.
  1868     EXIT.
  1869
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL688.cbl
  1871 6000-PRINT-CHECK SECTION.
  1872
  1873*                         COPY ELPRTCVP.
  1874******************************************************************
  1875***                                                              *
  1876***                          ELPRTCVP.                           *
  1877***                          VMOD=2.003                          *
  1878***                                                              *
  1879***     COPY MEMBER FOR TERMINAL ONLINE PRINT ROUTINE.           *
  1880***     THIS ROUTINE WILL ACCOMODATE PRINTING TO A 3270          *
  1881***     TERMINAL PRINTER. A BUFFER OF UP TO 1920 CHARACTERS      *
  1882***     IS ACCUMULATED AND PRINTED COLLECTIVELY.                 *
  1883***                                                              *
  1884***     THIS ROUTINE TO BE USED ONLY WITH ACCOMPANIMENT          *
  1885***      OF THE WORKING-STORAGE COPY MEMBER ( ELPRTCVD )         *
  1886***     THE HOST PROGRAM MUST INITIALIZE THE FOLLOWING 3 FIELDS  *
  1887***      FROM THE ABOVE COPY MEMBER FOR THIS PROCEDURE TO BE     *
  1888***      SUCCESSFUL.                                             *
  1889***      05  WS-LINE-LEN    PIC  S9(4)  COMP  VALUE +80.         *
  1890***                         LENGTH OF THE LINE TO BE PRINTED     *
  1891***                         DEFAULT IS 80, YOU CAN USE ANY NUMBER*
  1892***                         UP TO 132.  THIS FIELD IS ONLY ACCEP-*
  1893***                         TED THE FIRST TIME THRU THE ROUTINE. *
  1894***      05  WS-PROG-END    PIC  X  VALUE SPACES.                *
  1895***                         PROGRAM END SWITCH. INITIALIZED      *
  1896***                         TO SPACE-     MOVE IN ANY NONBLANK   *
  1897***                         TO IT WHEN PROGRAM IS FINISHED.      *
  1898***      05  WS-PRINT-AREA.                                      *
  1899***          10  WS-PASSED-CNTL-CHAR     PIC X.                  *
  1900***          10  WS-PASSED-DATA          PIC X(132).             *
  1901***                         USE THE DATA TO BE PRINTED IN THE    *
  1902***                         WS-PASSED-DATA.                      *
  1903***                         USE THE STANDARD CARRIAGE CONTROL    *
  1904***                         CHARACTER IN THE WS-PASSED-CNTL-CHAR *
  1905***                           SINGLE-SPACE            VALUE ' '  *
  1906***                           DOUBLE-SPACE            VALUE '0'  *
  1907***                           TRIPLE-SPACE            VALUE '-'  *
  1908***                           TOP-PAGE                VALUE '1'  *
  1909***      NOTE: A LINE COUNT IS PROVIDED IN FIELDNAME -WS-LINE-CNT*
  1910***            THE USE OF THIS FIELD IS OPTIONAL.                *
  1911***            THIS ROUTINE WILL ONLY ADD 1, 2, OR 3             *
  1912***            TO THIS COUNT DEPENDING ON THE WS-PASSED-CNTL-CHAR*
  1913***            AND RESET THE COUNT TO ZERO WHEN TOP-PAGE         *
  1914***            CONDITION.                                        *
  1915***                                                              *
  1916******************************************************************
  1917
  1918 ELPRTCVP.
  1919
  1920*    IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'CID'
  1921     IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'XXX'
  1922         MOVE 'P'                TO DL34-PROCESS-TYPE
  1923         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  1924         MOVE PI-PROCESSOR-ID    TO DL34-USERID
  1925         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  1926         MOVE WS-PRINT-AREA      TO DL34-PRINT-LINE
  1927         MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
  1928
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL688.cbl
  1929
  1930* EXEC CICS LINK
  1931*            PROGRAM    ('DLO034')
  1932*            COMMAREA   (DLO034-COMMUNICATION-AREA)
  1933*            LENGTH     (DLO034-REC-LENGTH)
  1934*        END-EXEC
  1935     MOVE 'DLO034' TO DFHEIV1
  1936*    MOVE '."C                   ''   #00001779' TO DFHEIV0
  1937     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1938     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1939     MOVE X'2020233030303031373739' TO DFHEIV0(25:11)
  1940     CALL 'kxdfhei1' USING DFHEIV0,
  1941           DFHEIV1,
  1942           DLO034-COMMUNICATION-AREA,
  1943           DLO034-REC-LENGTH,
  1944           DFHEIV99,
  1945           DFHEIV99,
  1946           DFHEIV99
  1947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1948
  1949            IF DL34-RETURN-CODE = 'OK'
  1950                GO TO ELPRTCVP-EXIT
  1951            ELSE
  1952*               MOVE '8339'     TO EMI-ERROR ?????ERROR MESSAGE???
  1953                GO TO ELPRTCVP-EXIT.
  1954
  1955     IF NOT FIRST-TIME
  1956         GO TO ELPRTCVP-020.
  1957
  1958     IF WS-LINE-LEN NOT GREATER ZERO
  1959         GO TO ELPRTCVP-EXIT.
  1960
  1961     MOVE '2'                    TO WS-FIRST-TIME-SW.
  1962     MOVE LOW-VALUES             TO WS-BUFFER-AREA.
  1963
  1964     SET BUFFER-INDEX TO +1
  1965
  1966     IF EIBTRMID IS EQUAL TO 'AFLP'
  1967         NEXT SENTENCE
  1968     ELSE
  1969         IF NOT TOP-PAGE
  1970             MOVE T-TP           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1971             SET BUFFER-INDEX UP BY +1.
  1972
  1973 ELPRTCVP-020.
  1974     IF WS-PROG-END = SPACES
  1975         GO TO ELPRTCVP-030.
  1976
  1977     MOVE SPACES                 TO WS-PROG-END.
  1978
  1979     IF BUFFER-INDEX GREATER +1
  1980         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  1981
  1982     MOVE '1'                    TO WS-FIRST-TIME-SW.
  1983
  1984     GO TO ELPRTCVP-EXIT.
  1985
  1986 ELPRTCVP-030.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL688.cbl
  1987     IF WS-PASSED-DATA = SPACES
  1988         SET PRT-INDEX TO +1
  1989         GO TO ELPRTCVP-050.
  1990
  1991     SET PRT-INDEX TO WS-LINE-LEN.
  1992
  1993 ELPRTCVP-040.
  1994     IF WS-PRINT-BYTE (PRT-INDEX) NOT = SPACES
  1995         GO TO ELPRTCVP-050.
  1996
  1997     IF PRT-INDEX GREATER +1
  1998         SET PRT-INDEX DOWN BY +1
  1999         GO TO ELPRTCVP-040.
  2000
  2001 ELPRTCVP-050.
  2002     SET WS-LINE-LENGTH TO PRT-INDEX.
  2003     SET BUFFER-INDEX2 TO BUFFER-INDEX.
  2004     SET BUFFER-INDEX2 UP BY WS-LINE-LENGTH.
  2005
  2006     IF BUFFER-INDEX2 NOT LESS WS-BUFFER-SIZE
  2007         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  2008
  2009     IF TRIPLE-SPACE
  2010          ADD +2  TO  WS-LINE-CNT
  2011          MOVE T-SS           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2012                                 WS-BUFFER-BYTE (BUFFER-INDEX + 1)
  2013          SET BUFFER-INDEX UP BY +2.
  2014
  2015     IF DOUBLE-SPACE
  2016          ADD +1  TO  WS-LINE-CNT
  2017          MOVE T-SS             TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2018          SET BUFFER-INDEX UP BY +1.
  2019
  2020     ADD +1 TO WS-LINE-CNT
  2021************************************************************
  2022*     BYPASS NEW LINE SYMBOL                               *
  2023*        IF FIRST BUFFER SENT AND TOP-OF-FORM SET.         *
  2024*     OR IF FIRST LINE OF SUBSEQUENT BUFFERS.              *
  2025************************************************************
  2026
  2027     IF (BUFFER-INDEX GREATER +1 AND
  2028         WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-TP)  OR
  2029         FIRST-LINE-NEXT-BUFFER
  2030         MOVE ZERO               TO WS-FIRST-TIME-SW
  2031     ELSE
  2032         MOVE T-SS               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2033         SET BUFFER-INDEX UP BY +1.
  2034
  2035**   NOTE, SINGLE SPACE IS REQUIRED BEFORE TOP PAGE CHAR
  2036
  2037     IF TOP-PAGE
  2038         MOVE +1                TO WS-LINE-CNT
  2039         MOVE T-TP              TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2040         SET BUFFER-INDEX UP BY +1.
  2041
  2042     SET PRT-INDEX TO +1.
  2043
  2044 ELPRTCVP-060.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL688.cbl
  2045     MOVE WS-PRINT-BYTE (PRT-INDEX)
  2046                                 TO WS-BUFFER-BYTE (BUFFER-INDEX).
  2047     SET BUFFER-INDEX UP BY +1.
  2048
  2049     IF PRT-INDEX LESS WS-LINE-LENGTH
  2050         SET PRT-INDEX UP BY +1
  2051         GO TO ELPRTCVP-060.
  2052
  2053 ELPRTCVP-EXIT.
  2054     EXIT.
  2055
  2056 ELPRTCVP-PRINT-BUFFER.
  2057     IF WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-SS
  2058        MOVE SPACE               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2059        SET BUFFER-INDEX UP BY 1.
  2060
  2061     MOVE  T-EM                  TO  WS-BUFFER-BYTE (BUFFER-INDEX)
  2062     SET WS-BUFFER-LENGTH TO BUFFER-INDEX.
  2063
  2064
  2065* EXEC CICS SEND
  2066*        FROM    (WS-BUFFER-AREA)
  2067*        LENGTH  (WS-BUFFER-LENGTH)
  2068*        CTLCHAR (WS-WCC-CNTL)
  2069*        ERASE
  2070*    END-EXEC.
  2071*    MOVE '$$    C E         L F ,   #00001900' TO DFHEIV0
  2072     MOVE X'242420202020432045202020' TO DFHEIV0(1:12)
  2073     MOVE X'2020202020204C2046202C20' TO DFHEIV0(13:12)
  2074     MOVE X'2020233030303031393030' TO DFHEIV0(25:11)
  2075     CALL 'kxdfhei1' USING DFHEIV0,
  2076           WS-BUFFER-AREA,
  2077           WS-BUFFER-LENGTH,
  2078           DFHEIV99,
  2079           DFHEIV99,
  2080           WS-WCC-CNTL,
  2081           DFHEIV99,
  2082           DFHEIV99,
  2083           DFHEIV99,
  2084           DFHEIV99,
  2085           DFHEIV99,
  2086           DFHEIV99
  2087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2088
  2089
  2090     SET BUFFER-INDEX TO +1.
  2091     MOVE '2'                    TO WS-FIRST-TIME-SW.
  2092
  2093 ELPRTCVP-PRINT-EXIT.
  2094     EXIT.
  2095
  2096
  2097******************************************************************
  2098***                 -ELPRTCVP-                                   *
  2099***     COPY MEMBER FOR TERMINAL ONLINE PRINT ROUTINE.           *
  2100***     THIS ROUTINE WILL ACCOMODATE PRINTING TO A 3270          *
  2101***     TERMINAL PRINTER. A BUFFER OF UP TO 1920 CHARACTERS      *
  2102***     IS ACCUMULATED AND PRINTED COLLECTIVELY.                 *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL688.cbl
  2103***                                                              *
  2104***     THIS ROUTINE TO BE USED ONLY WITH ACCOMPANIMENT          *
  2105***      OF THE WORKING-STORAGE COPY MEMBER ( ELPRTCVD )         *
  2106***     THE HOST PROGRAM MUST INITIALIZE THE FOLLOWING 3 FIELDS  *
  2107***      FROM THE ABOVE COPY MEMBER FOR THIS PROCEDURE TO BE     *
  2108***      SUCCESSFUL.                                             *
  2109***      05  WS-LINE-LEN    PIC  S9(4)  COMP  VALUE +80.         *
  2110***                         LENGTH OF THE LINE TO BE PRINTED     *
  2111***                         DEFAULT IS 80, YOU CAN USE ANY NUMBER*
  2112***                         UP TO 132.  THIS FIELD IS ONLY ACCEP-*
  2113***                         TED THE FIRST TIME THRU THE ROUTINE. *
  2114***      05  WS-PROG-END    PIC  X  VALUE SPACES.                *
  2115***                         PROGRAM END SWITCH. INITIALIZED      *
  2116***                         TO SPACE-     MOVE IN ANY NONBLANK   *
  2117***                         TO IT WHEN PROGRAM IS FINISHED.      *
  2118***      05  WS-PRINT-AREA.                                      *
  2119***          10  WS-PASSED-CNTL-CHAR     PIC X.                  *
  2120***          10  WS-PASSED-DATA          PIC X(132).             *
  2121***                         USE THE DATA TO BE PRINTED IN THE    *
  2122***                         WS-PASSED-DATA.                      *
  2123***                         USE THE STANDARD CARRIAGE CONTROL    *
  2124***                         CHARACTER IN THE WS-PASSED-CNTL-CHAR *
  2125***                           SINGLE-SPACE            VALUE ' '  *
  2126***                           DOUBLE-SPACE            VALUE '0'  *
  2127***                           TRIPLE-SPACE            VALUE '-'  *
  2128***                           TOP-PAGE                VALUE '1'  *
  2129***      NOTE: A LINE COUNT IS PROVIDED IN FIELDNAME -WS-LINE-CNT*
  2130***            THE USE OF THIS FIELD IS OPTIONAL.                *
  2131***            THIS ROUTINE WILL ONLY ADD 1, 2, OR 3             *
  2132***            TO THIS COUNT DEPENDING ON THE WS-PASSED-CNTL-CHAR*
  2133***            AND RESET THE COUNT TO ZERO WHEN TOP-PAGE         *
  2134***            CONDITION.                                        *
  2135***                                                              *
  2136******************************************************************
  2137*
  2138*ELPRTCVP.
  2139*
  2140*    IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'CID'
  2141*        MOVE 'P'                TO DL34-PROCESS-TYPE
  2142*        MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  2143*        MOVE PI-PROCESSOR-ID    TO DL34-USERID
  2144*        MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  2145*        MOVE WS-PRINT-AREA      TO DL34-PRINT-LINE
  2146*        MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
  2147*
  2148*        EXEC CICS LINK
  2149*            PROGRAM    ('DLO034')
  2150*            COMMAREA   (DLO034-COMMUNICATION-AREA)
  2151*            LENGTH     (DLO034-REC-LENGTH)
  2152*        END-EXEC
  2153*
  2154*           IF DL34-RETURN-CODE = 'OK'
  2155*               GO TO ELPRTCVP-EXIT
  2156*           ELSE
  2157*               MOVE '8339'     TO EMI-ERROR ?????ERROR MESSAGE???
  2158*               GO TO ELPRTCVP-EXIT.
  2159*
  2160*    IF NOT FIRST-TIME
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL688.cbl
  2161*        GO TO ELPRTCVP-020.
  2162*
  2163*    IF WS-LINE-LEN NOT GREATER THAN ZERO
  2164*        GO TO ELPRTCVP-EXIT.
  2165*
  2166*    MOVE '2'           TO WS-FIRST-TIME-SW.
  2167*    MOVE LOW-VALUES    TO WS-BUFFER-AREA.
  2168*
  2169*    SET BUFFER-INDEX TO +1.
  2170*
  2171*    IF PI-COMPANY-ID EQUAL 'HER' OR 'TIH' OR 'LAP' OR 'RMC' OR
  2172*                           'CVL' OR 'HAN' OR 'NSL' OR 'CNL'
  2173*        NEXT SENTENCE
  2174*    ELSE
  2175*       IF NOT TOP-PAGE
  2176*           MOVE T-TP       TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2177*           SET BUFFER-INDEX UP BY +1.
  2178*
  2179*ELPRTCVP-020.
  2180*    IF WS-PROG-END = SPACES
  2181*        GO TO ELPRTCVP-030.
  2182*
  2183*    MOVE '1'               TO WS-FIRST-TIME-SW.
  2184*    MOVE SPACES            TO WS-PROG-END.
  2185*
  2186*    IF BUFFER-INDEX GREATER THAN +1
  2187*        PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  2188*
  2189*    GO TO ELPRTCVP-EXIT.
  2190*
  2191*ELPRTCVP-030.
  2192*    IF WS-PASSED-DATA = SPACES
  2193*        SET PRT-INDEX TO +1
  2194*        GO TO ELPRTCVP-050.
  2195*
  2196*    SET PRT-INDEX TO WS-LINE-LEN.
  2197*
  2198*ELPRTCVP-040.
  2199*    IF WS-PRINT-BYTE (PRT-INDEX) NOT = SPACES
  2200*        GO TO ELPRTCVP-050.
  2201*
  2202*    IF PRT-INDEX GREATER THAN +1
  2203*        SET PRT-INDEX DOWN BY +1
  2204*        GO TO ELPRTCVP-040.
  2205*
  2206*ELPRTCVP-050.
  2207*    SET WS-LINE-LENGTH TO PRT-INDEX.
  2208*    SET BUFFER-INDEX2 TO BUFFER-INDEX.
  2209*    SET BUFFER-INDEX2 UP BY WS-LINE-LENGTH.
  2210*
  2211*    IF BUFFER-INDEX2 IS NOT LESS THAN WS-BUFFER-SIZE
  2212*        PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  2213*
  2214*    IF TRIPLE-SPACE
  2215*         ADD +2  TO  WS-LINE-CNT
  2216*         MOVE T-SS           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2217*                                WS-BUFFER-BYTE (BUFFER-INDEX + 1)
  2218*         SET BUFFER-INDEX UP BY +2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL688.cbl
  2219*
  2220*    IF DOUBLE-SPACE
  2221*         ADD +1  TO  WS-LINE-CNT
  2222*         MOVE T-SS             TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2223*         SET BUFFER-INDEX UP BY +1.
  2224*
  2225*    ADD +1 TO WS-LINE-CNT
  2226************************************************************
  2227*     BYPASS NEW LINE SYMBOL                               *
  2228*        IF FIRST BUFFER SENT AND TOP-OF-FORM SET.         *
  2229*     OR IF FIRST LINE OF SUBSEQUENT BUFFERS.              *
  2230************************************************************
  2231*
  2232*    IF (BUFFER-INDEX GREATER THAN +1 AND
  2233*        WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-TP)
  2234*        OR   FIRST-LINE-NEXT-BUFFER
  2235*        MOVE ZERO               TO WS-FIRST-TIME-SW
  2236*       ELSE
  2237*        MOVE T-SS          TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2238*        SET BUFFER-INDEX UP BY +1.
  2239*
  2240*    IF TOP-PAGE
  2241**        NOTE, SINGLE SPACE IS REQUIRED BEFORE TOP PAGE CHAR
  2242*         MOVE +1                TO WS-LINE-CNT
  2243*         MOVE T-TP              TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2244*         SET BUFFER-INDEX UP BY +1.
  2245*
  2246*    IF WS-PASSED-DATA = SPACES
  2247*        GO TO ELPRTCVP-EXIT.
  2248*
  2249*    SET PRT-INDEX TO +1.
  2250*
  2251*ELPRTCVP-060.
  2252*    MOVE WS-PRINT-BYTE (PRT-INDEX)
  2253*                                TO WS-BUFFER-BYTE (BUFFER-INDEX).
  2254*    SET BUFFER-INDEX UP BY +1.
  2255*
  2256*    IF PRT-INDEX LESS THAN WS-LINE-LENGTH
  2257*        SET PRT-INDEX UP BY +1
  2258*        GO TO ELPRTCVP-060.
  2259*
  2260*    SET WS-BUFFER-LENGTH TO BUFFER-INDEX.
  2261*
  2262*ELPRTCVP-EXIT.
  2263*    EXIT.
  2264*
  2265*ELPRTCVP-PRINT-BUFFER.
  2266*    IF WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-SS
  2267*       MOVE SPACE               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2268*       SET BUFFER-INDEX UP BY 1.
  2269*
  2270*    MOVE  T-EM                  TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2271*    SET WS-BUFFER-LENGTH TO BUFFER-INDEX.
  2272*
  2273*    ADD +1  TO  WS-DUMP-COUNT.
  2274*
  2275*    EXEC CICS SEND
  2276*        FROM    (WS-BUFFER-AREA)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL688.cbl
  2277*        LENGTH  (WS-BUFFER-LENGTH)
  2278*        CTLCHAR (WS-WCC-CNTL)
  2279*        ERASE   END-EXEC
  2280*
  2281*    EXEC CICS SYNCPOINT
  2282*        END-EXEC.
  2283*
  2284*    SET BUFFER-INDEX TO +1.
  2285*    MOVE '2'                    TO WS-FIRST-TIME-SW.
  2286*
  2287*ELPRTCVP-PRINT-EXIT.
  2288*    EXIT.
  2289*
  2290*    EJECT
  2291 8500-DATE-CONVERSION SECTION.
  2292
  2293* EXEC CICS LINK
  2294*        PROGRAM  ('ELDATCV')
  2295*        COMMAREA (DATE-CONVERSION-DATA)
  2296*        LENGTH   (DC-COMM-LENGTH) END-EXEC.
  2297     MOVE 'ELDATCV' TO DFHEIV1
  2298*    MOVE '."C                   ''   #00002109' TO DFHEIV0
  2299     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2300     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2301     MOVE X'2020233030303032313039' TO DFHEIV0(25:11)
  2302     CALL 'kxdfhei1' USING DFHEIV0,
  2303           DFHEIV1,
  2304           DATE-CONVERSION-DATA,
  2305           DC-COMM-LENGTH,
  2306           DFHEIV99,
  2307           DFHEIV99,
  2308           DFHEIV99
  2309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2310
  2311
  2312 8500-EXIT.
  2313     EXIT.
  2314
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL688.cbl
  2316 SPELL-DOLLAR SECTION.
  2317*                      COPY ELC176P1.
  2318*****************************************************************
  2319*                                                               *
  2320*                            ELC176P1.                          *
  2321*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2322*                            VMOD=2.003                         *
  2323*                                                               *
  2324* THIS SECTION CONVERTS A DOLLAR FIGURE INTO A SPELLED OUT AMT. *
  2325*                                                               *
  2326*****************************************************************
  2327
  2328 SDS-010.
  2329     MOVE SPACES                 TO  WS-SPELLED-AMOUNT
  2330                                     SD-PASS-SPELLED-AMOUNT
  2331                                     WS-SPELLED-LINE1
  2332                                     WS-SPELLED-LINE2.
  2333
  2334     SET SA-INDEX TO +1.
  2335
  2336     MOVE SD-PASS-AMOUNT         TO  WS-AMOUNT.
  2337
  2338     IF WS-MILLIONS GREATER ZERO
  2339         MOVE WS-MILLIONS        TO  WS-AMOUNT-WORK
  2340         PERFORM SPELL-AMOUNT
  2341         MOVE 'MILLION'          TO  WS-WORD
  2342         PERFORM MOVE-WORD.
  2343
  2344     IF WS-THOUSANDS GREATER ZERO
  2345         MOVE WS-THOUSANDS       TO  WS-AMOUNT-WORK
  2346         PERFORM SPELL-AMOUNT
  2347         MOVE 'THOUSAND'         TO  WS-WORD
  2348         PERFORM MOVE-WORD.
  2349
  2350     IF WS-HUNDREDS GREATER ZERO
  2351         MOVE WS-HUNDREDS        TO  WS-AMOUNT-WORK
  2352         PERFORM SPELL-AMOUNT.
  2353
  2354     IF WS-AMOUNT LESS +1.00
  2355         MOVE 'NO'               TO  WS-WORD
  2356         PERFORM MOVE-WORD.
  2357
  2358     IF WS-CENTS NOT GREATER ZERO
  2359         MOVE 'NO'               TO  WS-CENTS-X.
  2360
  2361     MOVE WS-CENTS-X             TO  WS-PENNEYS.
  2362
  2363     MOVE WS-DOLLARS-AND-CENTS   TO  WS-WORD.
  2364     PERFORM MOVE-WORD.
  2365
  2366     INSPECT WS-SPELLED-AMOUNT REPLACING ALL '-' BY SPACES.
  2367
  2368     MOVE WS-SPELLED-AMOUNT      TO  SD-PASS-SPELLED-AMOUNT.
  2369
  2370     PERFORM MOVE-SPELLED-AMOUNT.
  2371
  2372 SDS-EXIT.
  2373     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL688.cbl
  2374
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL688.cbl
  2376 SPELL-AMOUNT SECTION.
  2377
  2378*SAS-NOTE.
  2379*
  2380*    NOTE *******************************************************
  2381*         *      THIS SECTION CONVERTS A THREE DIGIT NUMBER     *
  2382*         *  INTO A SPELLED AMOUNT.                             *
  2383*         *******************************************************
  2384
  2385 SAS-010.
  2386     IF WS-HUNDRED GREATER ZERO
  2387         SET SINGLE-INDEX        TO  WS-HUNDRED
  2388         MOVE WS-SINGLE-DESC (SINGLE-INDEX)  TO  WS-WORD
  2389         PERFORM MOVE-WORD
  2390         MOVE 'HUNDRED'          TO  WS-WORD
  2391         PERFORM MOVE-WORD.
  2392
  2393     IF WS-TEEN GREATER ZERO
  2394         IF WS-TEEN LESS +20
  2395             SET SINGLE-INDEX TO WS-TEEN
  2396             MOVE WS-SINGLE-DESC (SINGLE-INDEX)  TO  WS-WORD
  2397             PERFORM MOVE-WORD
  2398           ELSE
  2399             SET UPPER-INDEX TO WS-TEN
  2400             MOVE WS-UPPER-DESC (UPPER-INDEX)  TO  WS-WORD
  2401             PERFORM MOVE-WORD
  2402             IF WS-ONE GREATER ZERO
  2403                 SET SINGLE-INDEX TO WS-ONE
  2404                 MOVE WS-SINGLE-DESC (SINGLE-INDEX)  TO  WS-WORD
  2405                 PERFORM MOVE-WORD.
  2406
  2407 SAS-EXIT.
  2408     EXIT.
  2409
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL688.cbl
  2411 MOVE-WORD SECTION.
  2412
  2413*MWS-NOTE.
  2414*
  2415*    NOTE *******************************************************
  2416*         *      THIS SECTION MOVES ONE WORD TO THE SPELLED     *
  2417*         *  AMOUNT OUTPUT LINE.                                *
  2418*         *******************************************************.
  2419
  2420 MWD-010.
  2421     PERFORM MOVE-CHARACTERS
  2422         VARYING CHAR-INDEX FROM +1 BY +1
  2423             UNTIL WS-CHAR2 (CHAR-INDEX) = SPACES.
  2424
  2425     SET SA-INDEX UP BY +1.
  2426
  2427 MWD-EXIT.
  2428     EXIT.
  2429
  2430 MOVE-CHARACTERS SECTION.
  2431
  2432*MCS-NOTE.
  2433*
  2434*    NOTE *******************************************************
  2435*         *      THIS SECTION MOVES ONE CHARACTER TO THE SPELLED*
  2436*         *  AMOUNT OUTPUT LINE.                                *
  2437*         *******************************************************.
  2438
  2439 MCD-010.
  2440     MOVE WS-CHAR2 (CHAR-INDEX)  TO  WS-CHAR (SA-INDEX).
  2441
  2442     SET SA-INDEX UP BY +1.
  2443
  2444 MCD-EXIT.
  2445     EXIT.
  2446
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL688.cbl
  2448 MOVE-SPELLED-AMOUNT SECTION.
  2449
  2450*MSA-NOTE.
  2451*
  2452*    NOTE *******************************************************
  2453*         *      THIS SECTION MOVES THE SPELLED DOLLAR AMOUNT   *
  2454*         *  TO TWO LINES IF NECESSARY.                         *
  2455*         *******************************************************.
  2456
  2457 MSA-010.
  2458     ADD WS-1ST-LINE-LENGTH +1 GIVING WS-1ST-LINE-LENGTH-PLUS-1.
  2459     ADD WS-1ST-LINE-LENGTH +2 GIVING WS-1ST-LINE-LENGTH-PLUS-2.
  2460     ADD WS-1ST-LINE-LENGTH -1 GIVING WS-1ST-LINE-LENGTH-MINUS-1.
  2461
  2462     MOVE WS-SPELLED-AMOUNT  TO  WS-SPELLED-LINE1.
  2463
  2464     IF SA-INDEX GREATER WS-1ST-LINE-LENGTH-PLUS-1
  2465         SET SL2-INDEX TO +1
  2466         IF WS-CHAR (WS-1ST-LINE-LENGTH-PLUS-1) = SPACES
  2467             PERFORM MOVE-LINE2 VARYING SA-INDEX2
  2468               FROM WS-1ST-LINE-LENGTH-PLUS-2 BY +1
  2469                 UNTIL SL2-INDEX GREATER WS-2ND-LINE-LENGTH
  2470           ELSE
  2471             PERFORM CLEAR-LINE1 VARYING SL1-INDEX
  2472                 FROM WS-1ST-LINE-LENGTH BY -1
  2473                     UNTIL WS-SL1 (SL1-INDEX) = SPACES
  2474             SET SL1-INDEX UP BY +1
  2475             PERFORM MOVE-LINE2
  2476               VARYING SA-INDEX2 FROM SL1-INDEX BY +1
  2477                 UNTIL SL2-INDEX GREATER WS-2ND-LINE-LENGTH.
  2478
  2479     MOVE WS-SPELLED-LINE1       TO  SD-PSA-LINE1.
  2480     MOVE WS-SPELLED-LINE2       TO  SD-PSA-LINE2.
  2481
  2482 MSA-EXIT.
  2483     EXIT.
  2484
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL688.cbl
  2486 CLEAR-LINE1 SECTION.
  2487
  2488*CLS-NOTE.
  2489*
  2490*    NOTE *******************************************************
  2491*         *      THIS SECTION CLEARS THE TRAILING WORD IN THE   *
  2492*         *  SPELLED LINE 1 IF THE AMOUNT IS GREATER THAN 78.   *
  2493*         *******************************************************.
  2494
  2495 CLS-010.
  2496     MOVE SPACES                 TO  WS-SL1 (SL1-INDEX).
  2497
  2498 CLS-EXIT.
  2499     EXIT.
  2500
  2501 MOVE-LINE2 SECTION.
  2502
  2503*MLS-NOTE.
  2504*
  2505*    NOTE *******************************************************
  2506*         *      THIS SECTION MOVES ONE CHARACTER TO THE SPELLED*
  2507*         *  AMOUNT OUTPUT LINE.                                *
  2508*         *******************************************************.
  2509
  2510 MLS-010.
  2511     MOVE WS-CHAR (SA-INDEX2)    TO  WS-SL2 (SL2-INDEX).
  2512
  2513     SET SL2-INDEX UP BY +1.
  2514
  2515     IF WS-CHAR (SA-INDEX2)     = SPACES   AND
  2516        WS-CHAR (SA-INDEX2 + 1) = SPACES
  2517         SET SL2-INDEX TO +99.
  2518
  2519 MLS-EXIT.
  2520     EXIT.
  2521
  2522
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL688.cbl
  2524 POS-SPELL-DOLLAR SECTION.
  2525
  2526*SDS-NOTE.
  2527*
  2528*    NOTE *******************************************************
  2529*         *      THIS SECTION CONVERTS A DOLLAR FIGURE INTO A   *
  2530*         *  SPELLED OUT AMOUNT.                                *
  2531*         *******************************************************.
  2532
  2533 SDS-010.
  2534     MOVE SPACES                 TO  WS-SPELLED-AMOUNT
  2535                                     SD-PASS-SPELLED-AMOUNT
  2536                                     WS-SPELLED-LINE1
  2537                                     WS-SPELLED-LINE2.
  2538     MOVE ZERO                   TO  WS-SW.
  2539
  2540     SET SA-INDEX TO +1.
  2541
  2542     MOVE SD-PASS-AMOUNT         TO  WS-AMOUNT.
  2543
  2544     IF WS-MILLIONS IS GREATER THAN ZERO
  2545         MOVE WS-MILLIONS        TO  WS-AMOUNT-WORK
  2546         PERFORM POS-SPELL-AMOUNT
  2547         MOVE +1                 TO  WS-SW.
  2548
  2549     IF WS-THOUSANDS IS GREATER THAN ZERO
  2550         MOVE WS-THOUSANDS       TO  WS-AMOUNT-WORK
  2551         PERFORM POS-SPELL-AMOUNT
  2552         MOVE +1                 TO  WS-SW
  2553       ELSE
  2554         IF WS-MILLIONS IS GREATER THAN ZERO
  2555             MOVE 'ZERO'         TO  WS-WORD
  2556             PERFORM MOVE-WORD 3 TIMES.
  2557
  2558     IF WS-HUNDREDS IS GREATER THAN ZERO
  2559         MOVE WS-HUNDREDS        TO  WS-AMOUNT-WORK
  2560         PERFORM POS-SPELL-AMOUNT
  2561         MOVE +1                 TO  WS-SW
  2562       ELSE
  2563         IF WS-MILLIONS IS GREATER THAN ZERO
  2564           OR WS-THOUSANDS IS GREATER THAN ZERO
  2565             MOVE 'ZERO'         TO  WS-WORD
  2566             PERFORM MOVE-WORD 3 TIMES.
  2567
  2568     IF WS-AMOUNT IS LESS THAN +1.00
  2569         MOVE 'NO'               TO  WS-WORD
  2570         PERFORM MOVE-WORD.
  2571
  2572     IF WS-CENTS IS NOT GREATER THAN ZERO
  2573         MOVE 'NO'               TO  WS-CENTS-X.
  2574
  2575     MOVE WS-CENTS-X             TO  WS-PENNEYS.
  2576
  2577     MOVE WS-DOLLARS-AND-CENTS   TO  WS-WORD.
  2578     PERFORM MOVE-WORD.
  2579
  2580     INSPECT WS-SPELLED-AMOUNT CONVERTING '-' TO ' '.
  2581
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL688.cbl
  2582     MOVE WS-SPELLED-AMOUNT      TO  SD-PASS-SPELLED-AMOUNT.
  2583
  2584     PERFORM MOVE-SPELLED-AMOUNT.
  2585
  2586 SDS-EXIT.
  2587     EXIT.
  2588
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL688.cbl
  2590 POS-SPELL-AMOUNT SECTION.
  2591
  2592*SAS-NOTE.
  2593*
  2594*    NOTE *******************************************************
  2595*         *      THIS SECTION CONVERTS A THREE DIGIT NUMBER     *
  2596*         *  INTO A SPELLED AMOUNT.                             *
  2597*         *******************************************************.
  2598
  2599 SAS-010.
  2600     IF WS-HUNDRED IS GREATER THAN ZERO
  2601         SET SINGLE-INDEX        TO  WS-HUNDRED
  2602         MOVE WS-SINGLE-DESC (SINGLE-INDEX)  TO  WS-WORD
  2603         PERFORM MOVE-WORD
  2604       ELSE
  2605         IF WS-SW NOT = ZERO
  2606             MOVE 'ZERO'         TO  WS-WORD
  2607             PERFORM MOVE-WORD.
  2608
  2609     IF WS-TEN IS GREATER THAN ZERO
  2610         SET SINGLE-INDEX TO WS-TEN
  2611         MOVE WS-SINGLE-DESC (SINGLE-INDEX)  TO  WS-WORD
  2612         PERFORM MOVE-WORD
  2613       ELSE
  2614         IF WS-HUNDRED IS GREATER THAN ZERO
  2615           OR WS-SW NOT = ZERO
  2616             MOVE 'ZERO'         TO  WS-WORD
  2617             PERFORM MOVE-WORD.
  2618
  2619     IF WS-ONE IS GREATER THAN ZERO
  2620         SET SINGLE-INDEX TO WS-ONE
  2621         MOVE WS-SINGLE-DESC (SINGLE-INDEX)  TO  WS-WORD
  2622         PERFORM MOVE-WORD
  2623       ELSE
  2624         IF WS-HUNDRED IS GREATER THAN ZERO
  2625           OR WS-TEN IS GREATER THAN ZERO
  2626           OR WS-SW NOT = ZERO
  2627             MOVE 'ZERO'         TO  WS-WORD
  2628             PERFORM MOVE-WORD.
  2629
  2630 SAS-EXIT.
  2631     EXIT.
  2632
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL688.cbl
  2634 9990-ERROR SECTION.
  2635
  2636* EXEC CICS LINK
  2637*        PROGRAM  ('EL004')
  2638*        COMMAREA (DFHEIBLK)
  2639*        LENGTH   (64) END-EXEC.
  2640     MOVE 'EL004' TO DFHEIV1
  2641     MOVE 64
  2642       TO DFHEIV11
  2643*    MOVE '."C                   ''   #00002437' TO DFHEIV0
  2644     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2645     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2646     MOVE X'2020233030303032343337' TO DFHEIV0(25:11)
  2647     CALL 'kxdfhei1' USING DFHEIV0,
  2648           DFHEIV1,
  2649           DFHEIBLK,
  2650           DFHEIV11,
  2651           DFHEIV99,
  2652           DFHEIV99,
  2653           DFHEIV99
  2654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2655
  2656
  2657 9990-EXIT.
  2658     EXIT.
  2659
  2660 9999-LAST-PARAGRAPH SECTION.
  2661
  2662
  2663* GOBACK.
  2664     MOVE '9%                    "   ' TO DFHEIV0
  2665     MOVE 'EL688' TO DFHEIV1
  2666     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2667     GOBACK.
  2668
  2669 9999-DFHBACK SECTION.
  2670     MOVE '9%                    "   ' TO DFHEIV0
  2671     MOVE 'EL688' TO DFHEIV1
  2672     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2673     GOBACK.
  2674 9999-DFHEXIT.
  2675     IF DFHEIGDJ EQUAL 0001
  2676         NEXT SENTENCE
  2677     ELSE IF DFHEIGDJ EQUAL 2
  2678         GO TO 5000-MAIN-LOGIC,
  2679               5000-MAIN-LOGIC,
  2680               9990-ERROR
  2681         DEPENDING ON DFHEIGDI.
  2682     MOVE '9%                    "   ' TO DFHEIV0
  2683     MOVE 'EL688' TO DFHEIV1
  2684     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2685     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        9356     Code:        6630
