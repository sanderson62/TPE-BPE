* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL110.cbl
* Options: int("EL110.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL110.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL110.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL110.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL110 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/02/95 10:36:31.
     7*                            VMOD=2.006.
     8*AUTHOR.        LOGIC, INC.
     9*               DALLAS, TEXAS.
    10
    11*DATE-COMPILED.
    12
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL110.cbl
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*                                                                *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS. TRANSACTION EX35 - ERROR FILE MAINTENANCE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL110.cbl
    26 ENVIRONMENT DIVISION.
    27 DATA DIVISION.
    28
    29 WORKING-STORAGE SECTION.
    30 01  DFH-START PIC X(04).
    31 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    32 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    33                                   USAGE POINTER.
    34 01  LCP-TIME-OF-DAY-XX.
    35     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    36     05  FILLER                    PIC 99.
    37 01  LCP-CICS-TIME                 PIC 9(15).
    38 77  FILLER  PIC X(32)  VALUE '********************************'.
    39 77  FILLER  PIC X(32)  VALUE '*    EL110 WORKING STORAGE     *'.
    40 77  FILLER  PIC X(32)  VALUE '*********** VMOD 2.006 *********'.
    41
    42 01  WS-DATE-AREA.
    43     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    44     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
    45
    46 01  LITERALS-NUMBERS.
    47     12  LIT-SPACE               PIC X       VALUE SPACE.
    48     12  LIT-A                   PIC X       VALUE 'A'.
    49     12  LIT-B                   PIC X       VALUE 'B'.
    50     12  LIT-C                   PIC X       VALUE 'C'.
    51     12  LIT-D                   PIC X       VALUE 'D'.
    52     12  LIT-E                   PIC X       VALUE 'E'.
    53     12  LIT-F                   PIC X       VALUE 'F'.
    54     12  LIT-S                   PIC X       VALUE 'S'.
    55     12  LIT-X                   PIC X       VALUE 'X'.
    56     12  LIT-EM                  PIC XX      VALUE 'EM'.
    57     12  LIT-PGM                 PIC X(8)    VALUE 'EL110'.
    58     12  MAP-EL110A              PIC X(8)    VALUE 'EL110A'.
    59     12  LIT-SYS                 PIC X(4)    VALUE 'SYS'.
    60     12  LIT-TRAN                PIC X(4)    VALUE 'EX35'.
    61     12  LIT-MAP                 PIC X(4)    VALUE '110A'.
    62     12  LIT-HELP                PIC X(8)    VALUE 'EL010'.
    63     12  CALL-PGM                PIC X(8).
    64     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
    65     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
    66     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
    67     12  XCTL-EM626              PIC X(8)    VALUE 'EM626'.
    68     12  XCTL-GL800              PIC X(8)    VALUE 'GL800'.
    69
    70 01  COUNT-FIELDS.
    71     12  COUNT-1                 PIC 99.
    72     12  COUNT-2                 PIC 99.
    73     12  COUNT-3                 PIC 99.
    74
    75 01  EDIT-WORK-AREA.
    76     12  CHECK-MAINT             PIC X.
    77         88  SHOW-OPTION                     VALUE 'S'.
    78         88  ADD-OPTION                      VALUE 'A'.
    79         88  CHANGE-OPTION                   VALUE 'C'.
    80         88  DELETE-OPTION                   VALUE 'D'.
    81         88  VALID-OPTION                  VALUE 'A' 'C' 'D' 'S'.
    82     12  CHECK-SEV               PIC X.
    83         88  VALID-SEV                     VALUE 'N' 'W' 'F' 'X'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL110.cbl
    84     12  CHECK-PFKEYS            PIC 99.
    85     12  SCREEN-SWITCH           PIC X.
    86         88  END-OF-FILE                     VALUE 'E'.
    87         88  SCREEN-FULL                     VALUE 'F'.
    88         88  SCREEN-ERROR                    VALUE 'X'.
    89     12  BROWSE-KEY              PIC X(4).
    90
    91 01  DISPLAY-LINE.
    92     12  ERR-CD                  PIC X(4).
    93     12  FILLER                  PIC X.
    94     12  ERR-SEV                 PIC X.
    95     12  FILLER                  PIC XX.
    96     12  ERR-TEXT                PIC X(65).
    97
    98 01  TIME-UNFORMATTED.
    99     12  UN-HOURS                PIC XX.
   100     12  UN-MINUTES              PIC XX.
   101     12  FILLER                  PIC X(4).
   102
   103 01  TIME-FORMATTED.
   104     12  FOR-HOURS               PIC XX.
   105     12  FILLER                  PIC X       VALUE '.'.
   106     12  FOR-MINUTES             PIC XX.
   107
   108 01  ERROR-MESSAGES.
   109     12  MAINT-MIS.
   110         16  FILLER              PIC X(39)
   111             VALUE 'MAINTENANCE FUNCTION INVALID OR UNAUTHO'.
   112         16  FILLER              PIC X(18)
   113             VALUE 'RIZED             '.
   114     12  LANG-MIS.
   115         16  FILLER              PIC X(39)
   116             VALUE 'LANGUAGE CODE INVALID OR NOT YET SUPPOR'.
   117         16  FILLER              PIC X(18)
   118             VALUE 'TED               '.
   119     12  ERROR-MIS               PIC X(46)
   120         VALUE 'ERROR NUMBER MISSING OR INVALID - PLEASE ENTER'.
   121     12  ERROR-INV               PIC X(38)
   122         VALUE 'ERROR NUMBER INVALID - PLEASE RE-ENTER'.
   123     12  ERROR-DUP               PIC X(40)
   124         VALUE 'ERROR NUMBER DUPLICATE - PLEASE RE-ENTER'.
   125     12  TEXT-MIS                PIC X(40)
   126         VALUE 'TEXT IS A MANDATORY FIELD - PLEASE ENTER'.
   127     12  SEV-MIS                 PIC X(42)
   128         VALUE 'SEVERITY MISSING OR INVALID - PLEASE ENTER'.
   129     12  INVALID-PFKEY           PIC X(45)
   130         VALUE 'INVALID PF-OPTION REQUESTED - PLEASE RE-ENTER'.
   131     12  END-MSG                 PIC X(11)
   132         VALUE 'END OF FILE'.
   133     12  END-UPDATE              PIC X(16)
   134         VALUE 'UPDATE COMPLETED'.
   135     12  SCREEN-TERM             PIC X(40)
   136           VALUE '     CLAS-IC ERROR MAINTENANCE COMPLETED'.
   137     12  FILE-MSG                PIC X(25)
   138           VALUE '     FILE ELERRS NOT OPEN'.
   139     12  FILE-MSG-FR             PIC X(25)
   140           VALUE '     FILE MPFERR NOT OPEN'.
   141
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL110.cbl
   142 01  COMP-LENGTHS.
   143     12  LIT-IC                  PIC S9(4)  COMP VALUE -1.
   144     12  FILE-LENGTH             PIC S9(4)  COMP VALUE +25.
   145     12  TERM-LENGTH             PIC S9(4)  COMP VALUE +40.
   146     12  COMM-LENGTH             PIC S9(4)  COMP VALUE +10.
   147     12  JOURNAL-LENGTH          PIC S9(4)  COMP VALUE +95.
   148     12  ERRS-LENGTH             PIC S9(4)  COMP VALUE +72.
   149
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL110.cbl
   151*                                COPY ELCDATE.
   152******************************************************************
   153*                                                                *
   154*                                                                *
   155*                            ELCDATE.                            *
   156*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   157*                            VMOD=2.003
   158*                                                                *
   159*                                                                *
   160*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   161*                 LENGTH = 200                                   *
   162******************************************************************
   163
   164 01  DATE-CONVERSION-DATA.
   165     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   166     12  DC-OPTION-CODE                PIC X.
   167         88  BIN-TO-GREG                VALUE ' '.
   168         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   169         88  EDIT-GREG-TO-BIN           VALUE '2'.
   170         88  YMD-GREG-TO-BIN            VALUE '3'.
   171         88  MDY-GREG-TO-BIN            VALUE '4'.
   172         88  JULIAN-TO-BIN              VALUE '5'.
   173         88  BIN-PLUS-ELAPSED           VALUE '6'.
   174         88  FIND-CENTURY               VALUE '7'.
   175         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   176         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   177         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   178         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   179         88  JULIAN-TO-BIN-3            VALUE 'C'.
   180         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   181         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   182         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   183         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   184         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   185         88  CHECK-LEAP-YEAR            VALUE 'H'.
   186         88  BIN-3-TO-GREG              VALUE 'I'.
   187         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   188         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   189         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   190         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   191         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   192         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   193         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   194         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   195         88  THREE-CHARACTER-BIN
   196                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   197         88  GREGORIAN-TO-BIN
   198                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   199         88  BIN-TO-GREGORIAN
   200                  VALUES ' ' '1' 'I' '8' 'G'.
   201         88  JULIAN-TO-BINARY
   202                  VALUES '5' 'C' 'E' 'F'.
   203     12  DC-ERROR-CODE                 PIC X.
   204         88  NO-CONVERSION-ERROR        VALUE ' '.
   205         88  DATE-CONVERSION-ERROR
   206                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   207         88  DATE-IS-ZERO               VALUE '1'.
   208         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL110.cbl
   209         88  DATE-IS-INVALID            VALUE '3'.
   210         88  DATE1-GREATER-DATE2        VALUE '4'.
   211         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   212         88  DATE-INVALID-OPTION        VALUE '9'.
   213         88  INVALID-CENTURY            VALUE 'A'.
   214         88  ONLY-CENTURY               VALUE 'B'.
   215         88  ONLY-LEAP-YEAR             VALUE 'C'.
   216         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   217     12  DC-END-OF-MONTH               PIC X.
   218         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   219     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   220         88  USE-NORMAL-PROCESS         VALUE ' '.
   221         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   222         88  ADJUST-UP-100-YRS          VALUE '2'.
   223     12  FILLER                        PIC X.
   224     12  DC-CONVERSION-DATES.
   225         16  DC-BIN-DATE-1             PIC XX.
   226         16  DC-BIN-DATE-2             PIC XX.
   227         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   228         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   229                       DC-GREG-DATE-1-EDIT.
   230             20  DC-EDIT1-MONTH        PIC 99.
   231             20  SLASH1-1              PIC X.
   232             20  DC-EDIT1-DAY          PIC 99.
   233             20  SLASH1-2              PIC X.
   234             20  DC-EDIT1-YEAR         PIC 99.
   235         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   236         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   237                     DC-GREG-DATE-2-EDIT.
   238             20  DC-EDIT2-MONTH        PIC 99.
   239             20  SLASH2-1              PIC X.
   240             20  DC-EDIT2-DAY          PIC 99.
   241             20  SLASH2-2              PIC X.
   242             20  DC-EDIT2-YEAR         PIC 99.
   243         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   244         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   245                     DC-GREG-DATE-1-YMD.
   246             20  DC-YMD-YEAR           PIC 99.
   247             20  DC-YMD-MONTH          PIC 99.
   248             20  DC-YMD-DAY            PIC 99.
   249         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   250         16  DC-GREG-DATE-1-MDY-R REDEFINES
   251                      DC-GREG-DATE-1-MDY.
   252             20  DC-MDY-MONTH          PIC 99.
   253             20  DC-MDY-DAY            PIC 99.
   254             20  DC-MDY-YEAR           PIC 99.
   255         16  DC-GREG-DATE-1-ALPHA.
   256             20  DC-ALPHA-MONTH        PIC X(10).
   257             20  DC-ALPHA-DAY          PIC 99.
   258             20  FILLER                PIC XX.
   259             20  DC-ALPHA-CENTURY.
   260                 24 DC-ALPHA-CEN-N     PIC 99.
   261             20  DC-ALPHA-YEAR         PIC 99.
   262         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   263         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   264         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   265         16  DC-JULIAN-DATE            PIC 9(05).
   266         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL110.cbl
   267                                       PIC 9(05).
   268         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   269             20  DC-JULIAN-YEAR        PIC 99.
   270             20  DC-JULIAN-DAYS        PIC 999.
   271         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   272         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   273         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   274     12  DATE-CONVERSION-VARIBLES.
   275         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   276         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   277             20  FILLER                PIC 9(3).
   278             20  HOLD-CEN-1-CCYY.
   279                 24  HOLD-CEN-1-CC     PIC 99.
   280                 24  HOLD-CEN-1-YY     PIC 99.
   281             20  HOLD-CEN-1-MO         PIC 99.
   282             20  HOLD-CEN-1-DA         PIC 99.
   283         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   284             20  HOLD-CEN-1-R-MO       PIC 99.
   285             20  HOLD-CEN-1-R-DA       PIC 99.
   286             20  HOLD-CEN-1-R-CCYY.
   287                 24  HOLD-CEN-1-R-CC   PIC 99.
   288                 24  HOLD-CEN-1-R-YY   PIC 99.
   289             20  FILLER                PIC 9(3).
   290         16  HOLD-CENTURY-1-X.
   291             20  FILLER                PIC X(3)  VALUE SPACES.
   292             20  HOLD-CEN-1-X-CCYY.
   293                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   294                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   295             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   296             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   297         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   298             20  HOLD-CEN-1-R-X-MO     PIC XX.
   299             20  HOLD-CEN-1-R-X-DA     PIC XX.
   300             20  HOLD-CEN-1-R-X-CCYY.
   301                 24  HOLD-CEN-1-R-X-CC PIC XX.
   302                 24  HOLD-CEN-1-R-X-YY PIC XX.
   303             20  FILLER                PIC XXX.
   304         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   305         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   306         16  DC-JULIAN-DATE-1          PIC 9(07).
   307         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   308             20  DC-JULIAN-1-CCYY.
   309                 24  DC-JULIAN-1-CC    PIC 99.
   310                 24  DC-JULIAN-1-YR    PIC 99.
   311             20  DC-JULIAN-DA-1        PIC 999.
   312         16  DC-JULIAN-DATE-2          PIC 9(07).
   313         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   314             20  DC-JULIAN-2-CCYY.
   315                 24  DC-JULIAN-2-CC    PIC 99.
   316                 24  DC-JULIAN-2-YR    PIC 99.
   317             20  DC-JULIAN-DA-2        PIC 999.
   318         16  DC-GREG-DATE-A-EDIT.
   319             20  DC-EDITA-MONTH        PIC 99.
   320             20  SLASHA-1              PIC X VALUE '/'.
   321             20  DC-EDITA-DAY          PIC 99.
   322             20  SLASHA-2              PIC X VALUE '/'.
   323             20  DC-EDITA-CCYY.
   324                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL110.cbl
   325                 24  DC-EDITA-YEAR     PIC 99.
   326         16  DC-GREG-DATE-B-EDIT.
   327             20  DC-EDITB-MONTH        PIC 99.
   328             20  SLASHB-1              PIC X VALUE '/'.
   329             20  DC-EDITB-DAY          PIC 99.
   330             20  SLASHB-2              PIC X VALUE '/'.
   331             20  DC-EDITB-CCYY.
   332                 24  DC-EDITB-CENT     PIC 99.
   333                 24  DC-EDITB-YEAR     PIC 99.
   334         16  DC-GREG-DATE-CYMD         PIC 9(08).
   335         16  DC-GREG-DATE-CYMD-R REDEFINES
   336                              DC-GREG-DATE-CYMD.
   337             20  DC-CYMD-CEN           PIC 99.
   338             20  DC-CYMD-YEAR          PIC 99.
   339             20  DC-CYMD-MONTH         PIC 99.
   340             20  DC-CYMD-DAY           PIC 99.
   341         16  DC-GREG-DATE-MDCY         PIC 9(08).
   342         16  DC-GREG-DATE-MDCY-R REDEFINES
   343                              DC-GREG-DATE-MDCY.
   344             20  DC-MDCY-MONTH         PIC 99.
   345             20  DC-MDCY-DAY           PIC 99.
   346             20  DC-MDCY-CEN           PIC 99.
   347             20  DC-MDCY-YEAR          PIC 99.
   348    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   349        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   350    12  DC-EL310-DATE                  PIC X(21).
   351    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL110.cbl
   353*                                COPY ELCERRS.
   354******************************************************************
   355*                                                                *
   356*                                                                *
   357*                            ELCERRS.                            *
   358*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   359*                            VMOD 2.002                          *
   360*                                                                *
   361*   FILE DESCRIPTION = SYSTEM ERROR MESSAGES                     *
   362*                                                                *
   363*   FILE TYPE = VSAM,KSDS                                        *
   364*   RECORD SIZE = 72    RECFORM = FIX                            *
   365*                                                                *
   366*   BASE CLUSTER NAME = ELERRS                   RKP=2,LEN=4     *
   367*       ALTERNATE PATH  = NOT USED                               *
   368*                                                                *
   369*   LOG = NO                                                     *
   370*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   371******************************************************************
   372 01  ERROR-MESSAGE-FILE.
   373     12  EM-RECORD-ID                PIC XX.
   374         88  VALID-EM-ID                VALUE 'EM'.
   375
   376     12  EM-CONTROL-PRIMARY.
   377         16  EM-MESSAGE-NUMBER       PIC 9(4).
   378
   379     12  EM-ERROR-TEXT.
   380         16  EM-ERROR-TEXT-PREFIX    PIC X(6).
   381         16  FILLER                  PIC X(59).
   382
   383     12  EM-ERROR-SEVERITY           PIC X.
   384         88  ERROR-IS-NOTE              VALUE 'N'.
   385         88  ERROR-IS-WARNING           VALUE 'W'.
   386         88  ERROR-IS-FORCABLE          VALUE 'F'.
   387         88  ERROR-IS-FATAL             VALUE 'X'.
   388
   389******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL110.cbl
   391*                                COPY ELCATTR.
   392******************************************************************
   393*                                                                *
   394*                            ELCATTR.                            *
   395*                            VMOD=2.001                          *
   396*                                                                *
   397*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   398*                                                                *
   399*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   400*                                                                *
   401*                   POS 1   P=PROTECTED                          *
   402*                           U=UNPROTECTED                        *
   403*                           S=ASKIP                              *
   404*                   POS 2   A=ALPHA/NUMERIC                      *
   405*                           N=NUMERIC                            *
   406*                   POS 3   N=NORMAL                             *
   407*                           B=BRIGHT                             *
   408*                           D=DARK                               *
   409*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   410*                           OF=MODIFIED DATA TAG OFF             *
   411*                                                                *
   412*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   413******************************************************************
   414 01  ATTRIBUTE-LIST.
   415     12  AL-PABOF            PIC X       VALUE 'Y'.
   416     12  AL-PABON            PIC X       VALUE 'Z'.
   417     12  AL-PADOF            PIC X       VALUE '%'.
   418     12  AL-PADON            PIC X       VALUE '_'.
   419     12  AL-PANOF            PIC X       VALUE '-'.
   420     12  AL-PANON            PIC X       VALUE '/'.
   421     12  AL-SABOF            PIC X       VALUE '8'.
   422     12  AL-SABON            PIC X       VALUE '9'.
   423     12  AL-SADOF            PIC X       VALUE '@'.
   424     12  AL-SADON            PIC X       VALUE QUOTE.
   425     12  AL-SANOF            PIC X       VALUE '0'.
   426     12  AL-SANON            PIC X       VALUE '1'.
   427     12  AL-UABOF            PIC X       VALUE 'H'.
   428     12  AL-UABON            PIC X       VALUE 'I'.
   429     12  AL-UADOF            PIC X       VALUE '<'.
   430     12  AL-UADON            PIC X       VALUE '('.
   431     12  AL-UANOF            PIC X       VALUE ' '.
   432     12  AL-UANON            PIC X       VALUE 'A'.
   433     12  AL-UNBOF            PIC X       VALUE 'Q'.
   434     12  AL-UNBON            PIC X       VALUE 'R'.
   435     12  AL-UNDOF            PIC X       VALUE '*'.
   436     12  AL-UNDON            PIC X       VALUE ')'.
   437     12  AL-UNNOF            PIC X       VALUE '&'.
   438     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL110.cbl
   440*                                COPY ELCLOGOF.
   441******************************************************************
   442*                                                                *
   443*                                                                *
   444*                            ELCLOGOF.                           *
   445*                            VMOD=2.001                          *
   446*                                                                *
   447*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   448*                                                                *
   449******************************************************************
   450 01  CLASIC-LOGOFF.
   451     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   452     12  LOGOFF-TEXT.
   453         16  FILLER          PIC X(5)    VALUE SPACES.
   454         16  LOGOFF-MSG.
   455             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   456             20  FILLER      PIC X       VALUE SPACES.
   457             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   458         16  FILLER          PIC X(80)
   459           VALUE '* YOU ARE NOW LOGGED OFF'.
   460         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   461         16  FILLER          PIC X       VALUE QUOTE.
   462         16  LOGOFF-SYS-MSG  PIC X(17)
   463           VALUE 'S CLAS-IC SYSTEM '.
   464     12  TEXT-MESSAGES.
   465         16  UNACCESS-MSG    PIC X(29)
   466             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   467         16  PGMIDERR-MSG    PIC X(17)
   468             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL110.cbl
   470
   471*                                COPY ELCAID.
   472******************************************************************
   473*                                                                *
   474*                            ELCAID.                             *
   475*                            VMOD=2.001                          *
   476*                                                                *
   477*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   478*                                                                *
   479*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   480*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   481******************************************************************
   482
   483 01  DFHAID.
   484   02  DFHNULL   PIC  X  VALUE  ' '.
   485   02  DFHENTER  PIC  X  VALUE  QUOTE.
   486   02  DFHCLEAR  PIC  X  VALUE  '_'.
   487   02  DFHPEN    PIC  X  VALUE  '='.
   488   02  DFHOPID   PIC  X  VALUE  'W'.
   489   02  DFHPA1    PIC  X  VALUE  '%'.
   490   02  DFHPA2    PIC  X  VALUE  '>'.
   491   02  DFHPA3    PIC  X  VALUE  ','.
   492   02  DFHPF1    PIC  X  VALUE  '1'.
   493   02  DFHPF2    PIC  X  VALUE  '2'.
   494   02  DFHPF3    PIC  X  VALUE  '3'.
   495   02  DFHPF4    PIC  X  VALUE  '4'.
   496   02  DFHPF5    PIC  X  VALUE  '5'.
   497   02  DFHPF6    PIC  X  VALUE  '6'.
   498   02  DFHPF7    PIC  X  VALUE  '7'.
   499   02  DFHPF8    PIC  X  VALUE  '8'.
   500   02  DFHPF9    PIC  X  VALUE  '9'.
   501   02  DFHPF10   PIC  X  VALUE  ':'.
   502   02  DFHPF11   PIC  X  VALUE  '#'.
   503   02  DFHPF12   PIC  X  VALUE  '@'.
   504   02  DFHPF13   PIC  X  VALUE  'A'.
   505   02  DFHPF14   PIC  X  VALUE  'B'.
   506   02  DFHPF15   PIC  X  VALUE  'C'.
   507   02  DFHPF16   PIC  X  VALUE  'D'.
   508   02  DFHPF17   PIC  X  VALUE  'E'.
   509   02  DFHPF18   PIC  X  VALUE  'F'.
   510   02  DFHPF19   PIC  X  VALUE  'G'.
   511   02  DFHPF20   PIC  X  VALUE  'H'.
   512   02  DFHPF21   PIC  X  VALUE  'I'.
   513*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   514   02  DFHPF22   PIC  X  VALUE  '['.
   515   02  DFHPF23   PIC  X  VALUE  '.'.
   516   02  DFHPF24   PIC  X  VALUE  '<'.
   517   02  DFHMSRE   PIC  X  VALUE  'X'.
   518   02  DFHSTRF   PIC  X  VALUE  'h'.
   519   02  DFHTRIG   PIC  X  VALUE  '"'.
   520 01  FILLER REDEFINES DFHAID.
   521     12  FILLER                  PIC X(8).
   522     12  AID-KEYS OCCURS 24 TIMES.
   523         16  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL110.cbl
   525*                                COPY ELCJPFX.
   526******************************************************************
   527*                                                                *
   528*                                                                *
   529*                            ELCJPFX.                            *
   530*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   531*                            VMOD=2.002                          *
   532*                                                                *
   533*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   534*                                                                *
   535*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   536*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   537*        ELCNTL - CONTROL FILE                                   *
   538*        ELMSTR - CLAIM MASTERS                                  *
   539*        ELTRLR - ACTIVITY TRAILERS                              *
   540*        ELCHKQ - CHECK QUE                                      *
   541******************************************************************
   542 01  JOURNAL-RECORD.
   543     12  JP-USER-ID                  PIC X(4).
   544     12  JP-FILE-ID                  PIC X(8).
   545     12  JP-PROGRAM-ID               PIC X(8).
   546     12  JP-RECORD-TYPE              PIC X.
   547         88 JP-ADD              VALUE 'A'.
   548         88 JP-BEFORE-CHANGE    VALUE 'B'.
   549         88 JP-AFTER-CHANGE     VALUE 'C'.
   550         88 JP-DELETE           VALUE 'D'.
   551         88 JP-GENERIC-DELETE   VALUE 'G'.
   552         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   553         88 JP-KEY-CHG-ADD      VALUE 'N'.
   554     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   555     12  JP-RECORD-AREA
   556
   557
   558                                 PIC X(72).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL110.cbl
   560*                                COPY ELCINTF.
   561******************************************************************
   562*                                                                *
   563*                                                                *
   564*                            ELCINTF.                            *
   565*                            VMOD=2.017                          *
   566*                                                                *
   567*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   568*                                                                *
   569*       LENGTH = 1024                                            *
   570*                                                                *
   571******************************************************************
   572 01  PROGRAM-INTERFACE-BLOCK.
   573     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   574     12  PI-CALLING-PROGRAM              PIC X(8).
   575     12  PI-SAVED-PROGRAM-1              PIC X(8).
   576     12  PI-SAVED-PROGRAM-2              PIC X(8).
   577     12  PI-SAVED-PROGRAM-3              PIC X(8).
   578     12  PI-SAVED-PROGRAM-4              PIC X(8).
   579     12  PI-SAVED-PROGRAM-5              PIC X(8).
   580     12  PI-SAVED-PROGRAM-6              PIC X(8).
   581     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   582     12  PI-COMPANY-ID                   PIC XXX.
   583     12  PI-COMPANY-CD                   PIC X.
   584
   585     12  PI-COMPANY-PASSWORD             PIC X(8).
   586
   587     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   588
   589     12  PI-CONTROL-IN-PROGRESS.
   590         16  PI-CARRIER                  PIC X.
   591         16  PI-GROUPING                 PIC X(6).
   592         16  PI-STATE                    PIC XX.
   593         16  PI-ACCOUNT                  PIC X(10).
   594         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   595                                         PIC X(10).
   596         16  PI-CLAIM-CERT-GRP.
   597             20  PI-CLAIM-NO             PIC X(7).
   598             20  PI-CERT-NO.
   599                 25  PI-CERT-PRIME       PIC X(10).
   600                 25  PI-CERT-SFX         PIC X.
   601             20  PI-CERT-EFF-DT          PIC XX.
   602         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   603             20  PI-PLAN-CODE            PIC X(2).
   604             20  PI-REVISION-NUMBER      PIC X(3).
   605             20  PI-PLAN-EFF-DT          PIC X(2).
   606             20  PI-PLAN-EXP-DT          PIC X(2).
   607             20  FILLER                  PIC X(11).
   608         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   609             20  PI-OE-REFERENCE-1.
   610                 25  PI-OE-REF-1-PRIME   PIC X(18).
   611                 25  PI-OE-REF-1-SUFF    PIC XX.
   612
   613     12  PI-SESSION-IN-PROGRESS          PIC X.
   614         88  CLAIM-SESSION                   VALUE '1'.
   615         88  CREDIT-SESSION                  VALUE '2'.
   616         88  WARRANTY-SESSION                VALUE '3'.
   617         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL110.cbl
   618         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   619
   620
   621*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   622
   623     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   624     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   625
   626     12  PI-CREDIT-USER                  PIC X.
   627         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   628         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   629
   630     12  PI-CLAIM-USER                   PIC X.
   631         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   632         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   633
   634     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   635         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   636         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   637         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   638         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   639         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   640
   641     12  PI-PROCESSOR-ID                 PIC X(4).
   642
   643     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   644
   645     12  PI-MEMBER-CAPTION               PIC X(10).
   646
   647     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   648         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   649
   650     12  PI-LIFE-OVERRIDE-L1             PIC X.
   651     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   652     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   653     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   654
   655     12  PI-AH-OVERRIDE-L1               PIC X.
   656     12  PI-AH-OVERRIDE-L2               PIC XX.
   657     12  PI-AH-OVERRIDE-L6               PIC X(6).
   658     12  PI-AH-OVERRIDE-L12              PIC X(12).
   659
   660     12  PI-NEW-SYSTEM                   PIC X(2).
   661
   662     12  PI-PRIMARY-CERT-NO              PIC X(11).
   663     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   664         88  PI-USES-PAID-TO                 VALUE '1'.
   665     12  PI-CRDTCRD-SYSTEM.
   666         16  PI-CRDTCRD-USER             PIC X.
   667             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   668             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   669         16  PI-CC-MONTH-END-DT          PIC XX.
   670     12  PI-PROCESSOR-PRINTER            PIC X(4).
   671
   672     12  PI-OE-REFERENCE-2.
   673         16  PI-OE-REF-2-PRIME           PIC X(10).
   674         16  PI-OE-REF-2-SUFF            PIC X.
   675
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL110.cbl
   676     12  PI-REM-TRM-CALC-OPTION          PIC X.
   677
   678     12  PI-LANGUAGE-TYPE                PIC X.
   679             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   680             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   681             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   682
   683     12  PI-POLICY-LINKAGE-IND           PIC X.
   684         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   685         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   686                                                   LOW-VALUES.
   687
   688     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   689     12  PI-CLAIM-PW-SESSION             PIC X(1).
   690         88  PI-CLAIM-CREDIT                 VALUE '1'.
   691         88  PI-CLAIM-CONVEN                 VALUE '2'.
   692     12  FILLER                          PIC X(4).
   693
   694     12  PI-SYSTEM-LEVEL                 PIC X(145).
   695
   696     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   697         PI-SYSTEM-LEVEL.
   698
   699         16  PI-ENTRY-CODES.
   700             20  PI-ENTRY-CD-1           PIC X.
   701             20  PI-ENTRY-CD-2           PIC X.
   702
   703         16  PI-RETURN-CODES.
   704             20  PI-RETURN-CD-1          PIC X.
   705             20  PI-RETURN-CD-2          PIC X.
   706
   707         16  PI-UPDATE-STATUS-SAVE.
   708             20  PI-UPDATE-BY            PIC X(4).
   709             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   710
   711         16  PI-LOWER-CASE-LETTERS       PIC X.
   712             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   713
   714*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   715*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   716*            88  CARRIER-CLM-CNTL            VALUE '2'.
   717
   718         16  PI-CERT-ACCESS-CONTROL      PIC X.
   719             88  ST-ACCNT-CNTL               VALUE ' '.
   720             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   721             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   722             88  ACCNT-CNTL                  VALUE '3'.
   723             88  CARR-ACCNT-CNTL             VALUE '4'.
   724
   725         16  PI-PROCESSOR-CAP-LIST.
   726             20  PI-SYSTEM-CONTROLS.
   727                24 PI-SYSTEM-DISPLAY     PIC X.
   728                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   729                24 PI-SYSTEM-MODIFY      PIC X.
   730                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   731             20  FILLER                  PIC XX.
   732             20  PI-DISPLAY-CAP          PIC X.
   733                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL110.cbl
   734             20  PI-MODIFY-CAP           PIC X.
   735                 88  MODIFY-CAP              VALUE 'Y'.
   736             20  PI-MSG-AT-LOGON-CAP     PIC X.
   737                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   738             20  PI-FORCE-CAP            PIC X.
   739                 88  FORCE-CAP               VALUE 'Y'.
   740
   741         16  PI-PROGRAM-CONTROLS.
   742             20  PI-PGM-PRINT-OPT        PIC X.
   743             20  PI-PGM-FORMAT-OPT       PIC X.
   744             20  PI-PGM-PROCESS-OPT      PIC X.
   745             20  PI-PGM-TOTALS-OPT       PIC X.
   746
   747         16  PI-HELP-INTERFACE.
   748             20  PI-LAST-ERROR-NO        PIC X(4).
   749             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   750
   751         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   752             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   753
   754         16  PI-CR-CONTROL-IN-PROGRESS.
   755             20  PI-CR-CARRIER           PIC X.
   756             20  PI-CR-GROUPING          PIC X(6).
   757             20  PI-CR-STATE             PIC XX.
   758             20  PI-CR-ACCOUNT           PIC X(10).
   759             20  PI-CR-FIN-RESP          PIC X(10).
   760             20  PI-CR-TYPE              PIC X.
   761
   762         16  PI-CR-BATCH-NUMBER          PIC X(6).
   763
   764         16  PI-CR-MONTH-END-DT          PIC XX.
   765
   766         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   767             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   768             88  PI-ZERO-CARRIER             VALUE '1'.
   769             88  PI-ZERO-GROUPING            VALUE '2'.
   770             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   771
   772         16  PI-CARRIER-SECURITY         PIC X.
   773             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   774
   775         16  PI-ACCOUNT-SECURITY         PIC X(10).
   776             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   777             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   778
   779         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   780             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   781                                         INDEXED BY PI-ACCESS-NDX
   782                                         PIC X.
   783
   784         16  PI-GA-BILLING-CONTROL       PIC X.
   785             88  PI-GA-BILLING               VALUE '1'.
   786
   787         16  PI-MAIL-PROCESSING          PIC X.
   788             88  PI-MAIL-YES                 VALUE 'Y'.
   789
   790         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   791
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL110.cbl
   792         16  PI-AR-SYSTEM.
   793             20  PI-AR-PROCESSING-CNTL   PIC X.
   794                 88  PI-AR-PROCESSING        VALUE 'Y'.
   795             20  PI-AR-SUMMARY-CODE      PIC X(6).
   796             20  PI-AR-MONTH-END-DT      PIC XX.
   797
   798         16  PI-MP-SYSTEM.
   799             20  PI-MORTGAGE-USER            PIC X.
   800                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   801                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   802             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   803                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   804                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   805                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   806                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   807                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   808             20  PI-MP-MONTH-END-DT          PIC XX.
   809             20  PI-MP-REFERENCE-NO.
   810                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   811                 24  PI-MP-REFERENCE-SFX     PIC XX.
   812
   813         16  PI-LABEL-CONTROL            PIC X(01).
   814             88  PI-CREATE-LABELS                    VALUE 'Y'.
   815             88  PI-BYPASS-LABELS                    VALUE 'N'.
   816
   817         16  PI-BILL-GROUPING-CODE       PIC X(01).
   818             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   819
   820         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   821             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   822             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   823
   824         16  FILLER                      PIC X(14).
   825
   826     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   827******************************************************************
   828     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
   829         16  MENU-SWITCH         PIC X.
   830         16  SAVE-BEGIN          PIC X(4).
   831         16  SAVE-ENDING         PIC X(4).
   832         16  SHOW-SWITCH         PIC X.
   833             88   NOT-SHOWN                 VALUE 'X'.
   834         16  PI-FILE-ID          PIC X(8).
   835             88 PI-FRENCH-FILE              VALUE 'MPFERR'.
   836             88 PI-ENGLISH-FILE             VALUE 'ELERRS'.
   837         16  PI-POINTER          PIC S9(8)  COMP.
   838         16  FILLER              PIC X(618).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL110.cbl
   840*                                COPY EL110S.
   841 01  EL110AI.
   842     05  FILLER            PIC  X(0012).
   843*    -------------------------------
   844     05  DATEL PIC S9(0004) COMP.
   845     05  DATEF PIC  X(0001).
   846     05  FILLER REDEFINES DATEF.
   847         10  DATEA PIC  X(0001).
   848     05  DATEI PIC  X(0008).
   849*    -------------------------------
   850     05  TIMEL PIC S9(0004) COMP.
   851     05  TIMEF PIC  X(0001).
   852     05  FILLER REDEFINES TIMEF.
   853         10  TIMEA PIC  X(0001).
   854     05  TIMEI PIC  X(0005).
   855*    -------------------------------
   856     05  MAINTL PIC S9(0004) COMP.
   857     05  MAINTF PIC  X(0001).
   858     05  FILLER REDEFINES MAINTF.
   859         10  MAINTA PIC  X(0001).
   860     05  MAINTI PIC  X(0001).
   861*    -------------------------------
   862     05  ERRORL PIC S9(0004) COMP.
   863     05  ERRORF PIC  X(0001).
   864     05  FILLER REDEFINES ERRORF.
   865         10  ERRORA PIC  X(0001).
   866     05  ERRORI PIC  X(0004).
   867*    -------------------------------
   868     05  LANGL PIC S9(0004) COMP.
   869     05  LANGF PIC  X(0001).
   870     05  FILLER REDEFINES LANGF.
   871         10  LANGA PIC  X(0001).
   872     05  LANGI PIC  X(0001).
   873*    -------------------------------
   874     05  TEXTL PIC S9(0004) COMP.
   875     05  TEXTF PIC  X(0001).
   876     05  FILLER REDEFINES TEXTF.
   877         10  TEXTA PIC  X(0001).
   878     05  TEXTI PIC  X(0065).
   879*    -------------------------------
   880     05  SEVL PIC S9(0004) COMP.
   881     05  SEVF PIC  X(0001).
   882     05  FILLER REDEFINES SEVF.
   883         10  SEVA PIC  X(0001).
   884     05  SEVI PIC  X(0001).
   885     05  ERRMSGD OCCURS 11  TIMES.
   886*    -------------------------------
   887         10  ERRMSGL PIC S9(0004) COMP.
   888         10  ERRMSGF PIC  X(0001).
   889         10  FILLER REDEFINES ERRMSGF.
   890             15  ERRMSGA PIC  X(0001).
   891         10  ERRMSGI PIC  X(0079).
   892*    -------------------------------
   893     05  MSGL PIC S9(0004) COMP.
   894     05  MSGF PIC  X(0001).
   895     05  FILLER REDEFINES MSGF.
   896         10  MSGA PIC  X(0001).
   897     05  MSGI PIC  X(0070).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL110.cbl
   898*    -------------------------------
   899     05  PFKEYL PIC S9(0004) COMP.
   900     05  PFKEYF PIC  X(0001).
   901     05  FILLER REDEFINES PFKEYF.
   902         10  PFKEYA PIC  X(0001).
   903     05  PFKEYI PIC  X(0002).
   904 01  EL110AO REDEFINES EL110AI.
   905     05  FILLER            PIC  X(0012).
   906*    -------------------------------
   907     05  FILLER            PIC  X(0003).
   908     05  DATEO PIC  X(0008).
   909*    -------------------------------
   910     05  FILLER            PIC  X(0003).
   911     05  TIMEO PIC  X(0005).
   912*    -------------------------------
   913     05  FILLER            PIC  X(0003).
   914     05  MAINTO PIC  X(0001).
   915*    -------------------------------
   916     05  FILLER            PIC  X(0003).
   917     05  ERRORO PIC  X(0004).
   918*    -------------------------------
   919     05  FILLER            PIC  X(0003).
   920     05  LANGO PIC  X(0001).
   921*    -------------------------------
   922     05  FILLER            PIC  X(0003).
   923     05  TEXTO PIC  X(0065).
   924*    -------------------------------
   925     05  FILLER            PIC  X(0003).
   926     05  SEVO PIC  X(0001).
   927*    -------------------------------
   928     05  ERRMSGD OCCURS 11  TIMES.
   929         10  FILLER        PIC  X(0003).
   930         10  ERRMSGO PIC  X(0079).
   931*    -------------------------------
   932     05  FILLER            PIC  X(0003).
   933     05  MSGO PIC  X(0070).
   934*    -------------------------------
   935     05  FILLER            PIC  X(0003).
   936     05  PFKEYO PIC  X(0002).
   937*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL110.cbl
   939 01  ERROR-MESSAGE-FILE-REST     PIC X(72).
   940 01  ERROR-MESSAGE-FILE-FR       PIC X(72).
   941****************************************************************
   942*
   943* Copyright (c) 2007 by Clerity Solutions, Inc.
   944* All rights reserved.
   945*
   946****************************************************************
   947 01  DFHEIV.
   948   02  DFHEIV0               PIC X(35).
   949   02  DFHEIV1               PIC X(08).
   950   02  DFHEIV2               PIC X(08).
   951   02  DFHEIV3               PIC X(08).
   952   02  DFHEIV4               PIC X(06).
   953   02  DFHEIV5               PIC X(04).
   954   02  DFHEIV6               PIC X(04).
   955   02  DFHEIV7               PIC X(02).
   956   02  DFHEIV8               PIC X(02).
   957   02  DFHEIV9               PIC X(01).
   958   02  DFHEIV10              PIC S9(7) COMP-3.
   959   02  DFHEIV11              PIC S9(4) COMP SYNC.
   960   02  DFHEIV12              PIC S9(4) COMP SYNC.
   961   02  DFHEIV13              PIC S9(4) COMP SYNC.
   962   02  DFHEIV14              PIC S9(4) COMP SYNC.
   963   02  DFHEIV15              PIC S9(4) COMP SYNC.
   964   02  DFHEIV16              PIC S9(9) COMP SYNC.
   965   02  DFHEIV17              PIC X(04).
   966   02  DFHEIV18              PIC X(04).
   967   02  DFHEIV19              PIC X(04).
   968   02  DFHEIV20              USAGE IS POINTER.
   969   02  DFHEIV21              USAGE IS POINTER.
   970   02  DFHEIV22              USAGE IS POINTER.
   971   02  DFHEIV23              USAGE IS POINTER.
   972   02  DFHEIV24              USAGE IS POINTER.
   973   02  DFHEIV25              PIC S9(9) COMP SYNC.
   974   02  DFHEIV26              PIC S9(9) COMP SYNC.
   975   02  DFHEIV27              PIC S9(9) COMP SYNC.
   976   02  DFHEIV28              PIC S9(9) COMP SYNC.
   977   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   978   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   979   02  FILLER                PIC X(02).
   980   02  DFHEIV99              PIC X(08) VALUE SPACE.
   981   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   982   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   983   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   984   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   985 LINKAGE  SECTION.
   986*****************************************************************
   987*                                                               *
   988* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   989* All rights reserved.                                          *
   990*                                                               *
   991*****************************************************************
   992 01  dfheiblk.
   993     02  eibtime          pic s9(7) comp-3.
   994     02  eibdate          pic s9(7) comp-3.
   995     02  eibtrnid         pic x(4).
   996     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL110.cbl
   997     02  eibtrmid         pic x(4).
   998     02  dfheigdi         pic s9(4) comp.
   999     02  eibcposn         pic s9(4) comp.
  1000     02  eibcalen         pic s9(4) comp.
  1001     02  eibaid           pic x(1).
  1002     02  eibfiller1       pic x(1).
  1003     02  eibfn            pic x(2).
  1004     02  eibfiller2       pic x(2).
  1005     02  eibrcode         pic x(6).
  1006     02  eibfiller3       pic x(2).
  1007     02  eibds            pic x(8).
  1008     02  eibreqid         pic x(8).
  1009     02  eibrsrce         pic x(8).
  1010     02  eibsync          pic x(1).
  1011     02  eibfree          pic x(1).
  1012     02  eibrecv          pic x(1).
  1013     02  eibsend          pic x(1).
  1014     02  eibatt           pic x(1).
  1015     02  eibeoc           pic x(1).
  1016     02  eibfmh           pic x(1).
  1017     02  eibcompl         pic x(1).
  1018     02  eibsig           pic x(1).
  1019     02  eibconf          pic x(1).
  1020     02  eiberr           pic x(1).
  1021     02  eibrldbk         pic x(1).
  1022     02  eiberrcd         pic x(4).
  1023     02  eibsynrb         pic x(1).
  1024     02  eibnodat         pic x(1).
  1025     02  eibfiller5       pic x(2).
  1026     02  eibresp          pic 9(09) comp.
  1027     02  eibresp2         pic 9(09) comp.
  1028     02  dfheigdj         pic s9(4) comp.
  1029     02  dfheigdk         pic s9(4) comp.
  1030 01  DFHCOMMAREA                 PIC X(1024).
  1031
  1032*01 PARM-LIST .
  1033*    12  FILLER                  PIC S9(8)  COMP.
  1034*    12  ERRS-PNT                PIC S9(8)  COMP.
  1035*    12  FERR-PNT                PIC S9(8)  COMP.
  1036
  1037******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL110.cbl
  1039 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1040 0000-DFHEXIT SECTION.
  1041     MOVE '9#                    $   ' TO DFHEIV0.
  1042     MOVE 'EL110' TO DFHEIV1.
  1043     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1044     CONTINUE.
  1045
  1046     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  1047     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1048     MOVE '5'                    TO DC-OPTION-CODE.
  1049     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  1050     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  1051     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  1052
  1053     IF EIBCALEN = ZERO
  1054         GO TO 8800-UNAUTHORIZED-ACCESS.
  1055
  1056     IF PI-CALLING-PROGRAM NOT = LIT-PGM
  1057         IF PI-RETURN-TO-PROGRAM NOT = LIT-PGM
  1058             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  1059             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  1060             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  1061             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  1062             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  1063             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  1064             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  1065             MOVE LIT-PGM               TO  PI-CALLING-PROGRAM
  1066             MOVE LOW-VALUES            TO  EL110AO
  1067             GO TO 8100-SEND-MAP
  1068         ELSE
  1069             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  1070             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  1071             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  1072             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  1073             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  1074             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  1075             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  1076             MOVE SPACES                TO  PI-SAVED-PROGRAM-6
  1077             MOVE LOW-VALUES            TO  EL110AO
  1078             GO TO 8100-SEND-MAP.
  1079
  1080     IF EIBAID = DFHCLEAR
  1081         GO TO 9000-XCTL.
  1082
  1083     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1084         MOVE LIT-IC             TO PFKEYL
  1085         MOVE INVALID-PFKEY      TO MSGO
  1086         GO TO 8110-SEND-DATA.
  1087
  1088
  1089* EXEC CICS RECEIVE
  1090*        MAP ('EL110A')
  1091*        MAPSET ('EL110S')
  1092*    END-EXEC.
  1093     MOVE 'EL110A' TO DFHEIV1
  1094     MOVE 'EL110S' TO DFHEIV2
  1095*    MOVE '8"T                   ''   #00001084' TO DFHEIV0
  1096     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL110.cbl
  1097     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1098     MOVE X'2020233030303031303834' TO DFHEIV0(25:11)
  1099     CALL 'kxdfhei1' USING DFHEIV0,
  1100           DFHEIV1,
  1101           EL110AI,
  1102           DFHEIV99,
  1103           DFHEIV2,
  1104           DFHEIV99,
  1105           DFHEIV99
  1106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1107
  1108
  1109     MOVE SPACE                  TO SCREEN-SWITCH.
  1110
  1111     IF PFKEYL GREATER ZERO
  1112         PERFORM 0300-TRANS-PF THRU 0310-EXIT.
  1113
  1114     IF SCREEN-ERROR
  1115         MOVE LIT-IC             TO PFKEYL
  1116         GO TO 8110-SEND-DATA.
  1117
  1118 0010-MAPFAIL-CONTINUE.
  1119     IF EIBAID = DFHPF23
  1120         GO TO 9100-XCTL.
  1121
  1122     IF EIBAID = DFHPF24
  1123         GO TO 9200-XCTL.
  1124
  1125     IF  LANGL NOT EQUAL ZEROS
  1126
  1127         IF  LANGI EQUAL 'F'
  1128             MOVE 'MPFERR'       TO PI-FILE-ID
  1129             MOVE LCP-WS-ADDR-COMP TO PI-POINTER
  1130
  1131         ELSE
  1132             MOVE 'ELERRS'       TO PI-FILE-ID
  1133             MOVE LCP-WS-ADDR-COMP TO PI-POINTER
  1134
  1135             IF  LANGI EQUAL 'E' OR SPACES OR LOW-VALUES
  1136                 MOVE 'E'        TO LANGI
  1137
  1138             ELSE
  1139                 MOVE LIT-IC     TO LANGL
  1140                 MOVE AL-UABON   TO LANGA
  1141                 MOVE LANG-MIS   TO MSGO
  1142                 MOVE LIT-X      TO SCREEN-SWITCH
  1143                 GO TO 8110-SEND-DATA
  1144
  1145     ELSE
  1146         MOVE 'ELERRS'           TO PI-FILE-ID
  1147         MOVE LCP-WS-ADDR-COMP TO PI-POINTER.
  1148
  1149     IF EIBAID = DFHPF1
  1150         GO TO 0100-PAGE-FORWARD.
  1151
  1152     IF EIBAID = DFHPF2
  1153         GO TO 0200-PAGE-BACKWARD.
  1154
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL110.cbl
  1155     IF EIBAID = DFHPF12
  1156         GO TO 8300-GET-HELP.
  1157
  1158     IF EIBAID NOT = DFHENTER
  1159         MOVE INVALID-PFKEY      TO MSGO
  1160         MOVE LIT-IC             TO MAINTL
  1161         GO TO 8110-SEND-DATA.
  1162
  1163     PERFORM 0400-SET-ATTRB THRU 0410-EXIT.
  1164     MOVE SPACE                  TO SCREEN-SWITCH.
  1165     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  1166
  1167     IF SCREEN-ERROR
  1168         GO TO 8110-SEND-DATA.
  1169
  1170     PERFORM 1100-UPDATE-FILE THRU 1110-EXIT.
  1171     MOVE LIT-IC                 TO MAINTL.
  1172
  1173     IF SHOW-OPTION
  1174         MOVE SPACES             TO MSGO
  1175         GO TO 8110-SEND-DATA
  1176     ELSE
  1177         MOVE LIT-X              TO SHOW-SWITCH
  1178         MOVE LOW-VALUES         TO EL110AO
  1179         MOVE LIT-IC             TO MAINTL
  1180         MOVE END-UPDATE         TO MSGO
  1181         MOVE HIGH-VALUES        TO SAVE-BEGIN
  1182         MOVE LOW-VALUES         TO SAVE-ENDING
  1183         GO TO 8100-SEND-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL110.cbl
  1185
  1186 0100-PAGE-FORWARD.
  1187     MOVE ZEROS                  TO COUNT-1.
  1188     MOVE SPACES                 TO SCREEN-SWITCH MSGO.
  1189
  1190     IF ERRORL = ZEROS
  1191         MOVE SAVE-ENDING        TO BROWSE-KEY
  1192     ELSE
  1193         MOVE AL-UNNOF           TO ERRORA
  1194         MOVE ERRORI             TO BROWSE-KEY.
  1195
  1196     MOVE SPACES                 TO MAINTO
  1197                                    TEXTO
  1198                                    SEVO.
  1199
  1200* EXEC CICS HANDLE CONDITION
  1201*        NOTOPEN (8230-NOT-OPEN)
  1202*        NOTFND (0110-REC-NOT-FND)
  1203*    END-EXEC.
  1204*    MOVE '"$JI                  ! " #00001179' TO DFHEIV0
  1205     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  1206     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1207     MOVE X'2220233030303031313739' TO DFHEIV0(25:11)
  1208     CALL 'kxdfhei1' USING DFHEIV0
  1209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1210
  1211
  1212
  1213* EXEC CICS STARTBR
  1214*        DATASET (PI-FILE-ID)
  1215*        RIDFLD (BROWSE-KEY)
  1216*    END-EXEC.
  1217     MOVE 0
  1218       TO DFHEIV11
  1219*    MOVE '&,         G          &   #00001184' TO DFHEIV0
  1220     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1221     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1222     MOVE X'2020233030303031313834' TO DFHEIV0(25:11)
  1223     CALL 'kxdfhei1' USING DFHEIV0,
  1224           PI-FILE-ID,
  1225           BROWSE-KEY,
  1226           DFHEIV99,
  1227           DFHEIV11,
  1228           DFHEIV99
  1229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1230
  1231
  1232     PERFORM 3000-BUILD-FWD-PAGE THRU 3020-EXIT
  1233         UNTIL SCREEN-FULL OR END-OF-FILE.
  1234
  1235
  1236* EXEC CICS ENDBR
  1237*        DATASET (PI-FILE-ID)
  1238*    END-EXEC.
  1239     MOVE 0
  1240       TO DFHEIV11
  1241*    MOVE '&2                    $   #00001192' TO DFHEIV0
  1242     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL110.cbl
  1243     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1244     MOVE X'2020233030303031313932' TO DFHEIV0(25:11)
  1245     CALL 'kxdfhei1' USING DFHEIV0,
  1246           PI-FILE-ID,
  1247           DFHEIV11,
  1248           DFHEIV99
  1249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1250
  1251
  1252     MOVE LIT-IC                 TO MAINTL.
  1253     GO TO 8110-SEND-DATA.
  1254
  1255 0110-REC-NOT-FND.
  1256     MOVE HIGH-VALUES            TO SAVE-BEGIN SAVE-ENDING.
  1257
  1258     PERFORM 3100-FILL-SCREEN THRU 3110-EXIT
  1259         UNTIL SCREEN-FULL.
  1260     MOVE LIT-IC                 TO MAINTL.
  1261     MOVE END-MSG                TO MSGO.
  1262     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL110.cbl
  1264 0200-PAGE-BACKWARD.
  1265     MOVE 11                     TO COUNT-1.
  1266     MOVE SPACES                 TO SCREEN-SWITCH MSGO.
  1267
  1268     IF ERRORL = ZEROS
  1269         MOVE SAVE-BEGIN         TO BROWSE-KEY
  1270     ELSE
  1271         MOVE AL-UNNOF           TO ERRORA
  1272         MOVE ERRORI             TO BROWSE-KEY SAVE-BEGIN.
  1273         MOVE SPACES             TO MAINTO
  1274                                    TEXTO
  1275                                    SEVO.
  1276
  1277
  1278* EXEC CICS HANDLE CONDITION
  1279*        NOTOPEN (8230-NOT-OPEN)
  1280*        NOTFND (0210-REC-NOT-FND)
  1281*    END-EXEC.
  1282*    MOVE '"$JI                  ! # #00001221' TO DFHEIV0
  1283     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  1284     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1285     MOVE X'2320233030303031323231' TO DFHEIV0(25:11)
  1286     CALL 'kxdfhei1' USING DFHEIV0
  1287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1288
  1289
  1290
  1291* EXEC CICS STARTBR
  1292*        DATASET (PI-FILE-ID)
  1293*        RIDFLD (BROWSE-KEY)
  1294*    END-EXEC.
  1295     MOVE 0
  1296       TO DFHEIV11
  1297*    MOVE '&,         G          &   #00001226' TO DFHEIV0
  1298     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1299     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1300     MOVE X'2020233030303031323236' TO DFHEIV0(25:11)
  1301     CALL 'kxdfhei1' USING DFHEIV0,
  1302           PI-FILE-ID,
  1303           BROWSE-KEY,
  1304           DFHEIV99,
  1305           DFHEIV11,
  1306           DFHEIV99
  1307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1308
  1309
  1310     IF BROWSE-KEY = HIGH-VALUES
  1311         GO TO 0205-SKIP-RESET.
  1312
  1313
  1314* EXEC CICS READNEXT
  1315*        DATASET (PI-FILE-ID)
  1316*        RIDFLD (BROWSE-KEY)
  1317*        INTO (ERROR-MESSAGE-FILE)
  1318*    END-EXEC.
  1319     MOVE LENGTH OF
  1320      ERROR-MESSAGE-FILE
  1321       TO DFHEIV12
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL110.cbl
  1322     MOVE 0
  1323       TO DFHEIV11
  1324*    MOVE '&.IL                  )   #00001234' TO DFHEIV0
  1325     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1326     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1327     MOVE X'2020233030303031323334' TO DFHEIV0(25:11)
  1328     CALL 'kxdfhei1' USING DFHEIV0,
  1329           PI-FILE-ID,
  1330           ERROR-MESSAGE-FILE,
  1331           DFHEIV12,
  1332           BROWSE-KEY,
  1333           DFHEIV99,
  1334           DFHEIV11,
  1335           DFHEIV99,
  1336           DFHEIV99
  1337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1338
  1339
  1340
  1341* EXEC CICS RESETBR
  1342*        DATASET (PI-FILE-ID)
  1343*        RIDFLD (BROWSE-KEY)
  1344*        EQUAL
  1345*    END-EXEC.
  1346     MOVE 0
  1347       TO DFHEIV11
  1348*    MOVE '&4         E          &   #00001240' TO DFHEIV0
  1349     MOVE X'263420202020202020202045' TO DFHEIV0(1:12)
  1350     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1351     MOVE X'2020233030303031323430' TO DFHEIV0(25:11)
  1352     CALL 'kxdfhei1' USING DFHEIV0,
  1353           PI-FILE-ID,
  1354           BROWSE-KEY,
  1355           DFHEIV99,
  1356           DFHEIV11,
  1357           DFHEIV99
  1358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1359
  1360
  1361 0205-SKIP-RESET.
  1362     PERFORM 3030-BUILD-BCK-PAGE THRU 3050-EXIT
  1363         UNTIL SCREEN-FULL OR END-OF-FILE.
  1364
  1365
  1366* EXEC CICS ENDBR
  1367*        DATASET (PI-FILE-ID)
  1368*    END-EXEC.
  1369     MOVE 0
  1370       TO DFHEIV11
  1371*    MOVE '&2                    $   #00001250' TO DFHEIV0
  1372     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1373     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1374     MOVE X'2020233030303031323530' TO DFHEIV0(25:11)
  1375     CALL 'kxdfhei1' USING DFHEIV0,
  1376           PI-FILE-ID,
  1377           DFHEIV11,
  1378           DFHEIV99
  1379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL110.cbl
  1380
  1381
  1382     MOVE COUNT-1                TO COUNT-3.
  1383     PERFORM 3060-RAISE-PAGE THRU 3070-EXIT
  1384         COUNT-3 TIMES.
  1385     MOVE LIT-IC                 TO MAINTL.
  1386     GO TO 8110-SEND-DATA.
  1387
  1388 0210-REC-NOT-FND.
  1389     MOVE HIGH-VALUES            TO SAVE-BEGIN.
  1390     MOVE ZEROS                  TO ERRORL.
  1391     GO TO 0200-PAGE-BACKWARD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL110.cbl
  1393 0300-TRANS-PF.
  1394     IF EIBAID NOT = DFHENTER
  1395         MOVE INVALID-PFKEY      TO MSGO
  1396         MOVE LIT-X              TO SCREEN-SWITCH
  1397         GO TO 0310-EXIT.
  1398
  1399     IF PFKEYI NOT NUMERIC
  1400         MOVE INVALID-PFKEY      TO MSGO
  1401         MOVE LIT-X              TO SCREEN-SWITCH
  1402         GO TO 0310-EXIT.
  1403
  1404     IF PFKEYI LESS 1 OR GREATER 24
  1405         MOVE INVALID-PFKEY      TO MSGO
  1406         MOVE LIT-X              TO SCREEN-SWITCH
  1407         GO TO 0310-EXIT.
  1408
  1409     MOVE PFKEYI                 TO CHECK-PFKEYS.
  1410     MOVE AID-KEYS (CHECK-PFKEYS)                    TO EIBAID.
  1411
  1412 0310-EXIT.
  1413     EXIT.
  1414
  1415 0400-SET-ATTRB.
  1416     MOVE AL-UANON               TO MAINTA
  1417                                    TEXTA
  1418                                    LANGA
  1419                                    SEVA.
  1420     MOVE AL-UNNON               TO ERRORA.
  1421
  1422 0410-EXIT.
  1423     EXIT.
  1424
  1425 1000-EDIT-SCREEN.
  1426*
  1427*    IF  LANGL NOT EQUAL ZEROS
  1428*
  1429*        IF  LANGI EQUAL 'F'
  1430*            MOVE 'MPFERR'       TO PI-FILE-ID
  1431*            MOVE FERR-PNT       TO PI-POINTER
  1432*
  1433*        ELSE
  1434*            MOVE 'ELERRS'       TO PI-FILE-ID
  1435*            MOVE ERRS-PNT       TO PI-POINTER
  1436*
  1437*            IF  LANGI EQUAL 'E' OR SPACES OR LOW-VALUES
  1438*                MOVE 'E'        TO LANGI
  1439*
  1440*            ELSE
  1441*                MOVE LIT-IC     TO LANGL
  1442*                MOVE AL-UABON   TO LANGA
  1443*                MOVE LANG-MIS   TO MSGO
  1444*                MOVE LIT-X      TO SCREEN-SWITCH
  1445*                GO TO 1010-EXIT
  1446*    ELSE
  1447*        MOVE 'ELERRS'           TO PI-FILE-ID
  1448*        MOVE ERRS-PNT           TO PI-POINTER.
  1449
  1450     MOVE MAINTI                 TO CHECK-MAINT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL110.cbl
  1451
  1452     IF PI-COMPANY-ID = 'MON'
  1453      IF NOT VALID-OPTION
  1454         MOVE LIT-IC             TO MAINTL
  1455         MOVE AL-UABON           TO MAINTA
  1456         MOVE MAINT-MIS          TO MSGO
  1457         MOVE LIT-X              TO SCREEN-SWITCH
  1458         GO TO 1010-EXIT.
  1459
  1460     IF PI-COMPANY-ID = 'LII'
  1461            AND
  1462        PI-PROCESSOR-ID EQUAL 'TPT'
  1463        NEXT SENTENCE
  1464
  1465     ELSE
  1466     IF PI-COMPANY-ID NOT = 'MON'
  1467      IF (NOT VALID-OPTION)
  1468               OR
  1469        ((PI-PROCESSOR-ID NOT = 'EMER' AND 'PEMA')
  1470        AND (NOT SHOW-OPTION))
  1471**      (PI-PROCESSOR-ID NOT = 'LGXX' AND NOT SHOW-OPTION)
  1472         MOVE LIT-IC             TO MAINTL
  1473         MOVE AL-UABON           TO MAINTA
  1474         MOVE MAINT-MIS          TO MSGO
  1475         MOVE LIT-X              TO SCREEN-SWITCH
  1476         GO TO 1010-EXIT.
  1477
  1478     IF ERRORI = LOW-VALUES
  1479         MOVE LIT-IC             TO ERRORL
  1480         MOVE AL-UNBON           TO ERRORA
  1481         MOVE ERROR-MIS          TO MSGO
  1482         MOVE LIT-X              TO SCREEN-SWITCH
  1483         GO TO 1010-EXIT.
  1484
  1485     IF DELETE-OPTION AND NOT-SHOWN
  1486         MOVE SPACES             TO SHOW-SWITCH SCREEN-SWITCH
  1487         MOVE ZEROES             TO COUNT-1
  1488         PERFORM 3100-FILL-SCREEN THRU 3110-EXIT
  1489             UNTIL SCREEN-FULL
  1490         MOVE LIT-S              TO CHECK-MAINT.
  1491
  1492     IF CHANGE-OPTION AND NOT-SHOWN
  1493         MOVE SPACES             TO SHOW-SWITCH SCREEN-SWITCH
  1494         MOVE ZEROES             TO COUNT-1
  1495         PERFORM 3100-FILL-SCREEN THRU 3110-EXIT
  1496             UNTIL SCREEN-FULL
  1497         MOVE LIT-S              TO CHECK-MAINT.
  1498
  1499     PERFORM 1020-VERIFY-ERROR THRU 1050-EXIT.
  1500
  1501     IF SCREEN-ERROR OR DELETE-OPTION
  1502         GO TO 1010-EXIT.
  1503
  1504     IF SHOW-OPTION
  1505         MOVE SPACES             TO SHOW-SWITCH SCREEN-SWITCH
  1506         MOVE ZEROES             TO COUNT-1
  1507         PERFORM 3100-FILL-SCREEN THRU 3110-EXIT
  1508             UNTIL SCREEN-FULL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL110.cbl
  1509         GO TO 1010-EXIT.
  1510
  1511     IF TEXTI = SPACES OR LOW-VALUES
  1512         MOVE LIT-IC             TO TEXTL
  1513         MOVE AL-UABON           TO TEXTA
  1514         MOVE TEXT-MIS           TO MSGO
  1515         MOVE LIT-X              TO SCREEN-SWITCH
  1516         GO TO 1010-EXIT.
  1517
  1518     MOVE SEVI                   TO CHECK-SEV.
  1519
  1520     IF NOT VALID-SEV
  1521         MOVE LIT-IC             TO SEVL
  1522         MOVE AL-UABON           TO SEVA
  1523         MOVE SEV-MIS            TO MSGO
  1524         MOVE LIT-X              TO SCREEN-SWITCH.
  1525
  1526 1010-EXIT.
  1527     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL110.cbl
  1529 1020-VERIFY-ERROR.
  1530
  1531* EXEC CICS HANDLE CONDITION
  1532*        NOTOPEN (1040-RECORD-NOT-FOUND)
  1533*        NOTFND (1040-RECORD-NOT-FOUND)
  1534*    END-EXEC.
  1535*    MOVE '"$JI                  ! $ #00001402' TO DFHEIV0
  1536     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  1537     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1538     MOVE X'2420233030303031343032' TO DFHEIV0(25:11)
  1539     CALL 'kxdfhei1' USING DFHEIV0
  1540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1541
  1542
  1543     MOVE ERRORI TO BROWSE-KEY.
  1544
  1545* EXEC CICS READ
  1546*        DATASET (PI-FILE-ID)
  1547*        RIDFLD (BROWSE-KEY)
  1548*        INTO (ERROR-MESSAGE-FILE)
  1549*    END-EXEC.
  1550     MOVE LENGTH OF
  1551      ERROR-MESSAGE-FILE
  1552       TO DFHEIV11
  1553*    MOVE '&"IL       E          (   #00001408' TO DFHEIV0
  1554     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1555     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1556     MOVE X'2020233030303031343038' TO DFHEIV0(25:11)
  1557     CALL 'kxdfhei1' USING DFHEIV0,
  1558           PI-FILE-ID,
  1559           ERROR-MESSAGE-FILE,
  1560           DFHEIV11,
  1561           BROWSE-KEY,
  1562           DFHEIV99,
  1563           DFHEIV99,
  1564           DFHEIV99
  1565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1566
  1567*
  1568*    IF  PI-FRENCH-FILE
  1569*        SERVICE RELOAD ERROR-MESSAGE-FILE-FR
  1570*
  1571*    ELSE
  1572*        SERVICE RELOAD ERROR-MESSAGE-FILE-REST.
  1573
  1574     IF ADD-OPTION
  1575         MOVE ERROR-DUP          TO MSGO
  1576         MOVE AL-UNBON           TO ERRORA
  1577         MOVE LIT-IC             TO ERRORL
  1578         MOVE LIT-X              TO SCREEN-SWITCH
  1579         GO TO 1050-EXIT.
  1580
  1581     IF NOT SHOW-OPTION
  1582         GO TO 1050-EXIT.
  1583
  1584     MOVE EM-ERROR-TEXT          TO TEXTO.
  1585     MOVE EM-ERROR-SEVERITY      TO SEVO.
  1586     GO TO 1050-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL110.cbl
  1587
  1588 1040-RECORD-NOT-FOUND.
  1589     IF NOT ADD-OPTION
  1590         MOVE ERROR-INV          TO MSGO
  1591         MOVE AL-UNBON           TO ERRORA
  1592         MOVE LIT-IC             TO ERRORL
  1593         MOVE LIT-X              TO SCREEN-SWITCH.
  1594
  1595 1050-EXIT.
  1596     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL110.cbl
  1598 1100-UPDATE-FILE.
  1599     IF SHOW-OPTION
  1600         GO TO 1110-EXIT.
  1601
  1602     IF ADD-OPTION
  1603         PERFORM 1120-ADD-OPTION THRU 1140-EXIT.
  1604
  1605     IF CHANGE-OPTION
  1606         PERFORM 1150-CHANGE-OPTION THRU 1160-EXIT.
  1607
  1608     IF DELETE-OPTION
  1609         PERFORM 1170-DELETE-OPTION THRU 1180-EXIT.
  1610
  1611 1110-EXIT.
  1612     EXIT.
  1613
  1614 1120-ADD-OPTION.
  1615
  1616* EXEC CICS HANDLE CONDITION
  1617*        NOTOPEN (8230-NOT-OPEN)
  1618*        NOSPACE (1130-FILE-FULL)
  1619*    END-EXEC.
  1620*    MOVE '"$JE                  ! % #00001461' TO DFHEIV0
  1621     MOVE X'22244A452020202020202020' TO DFHEIV0(1:12)
  1622     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1623     MOVE X'2520233030303031343631' TO DFHEIV0(25:11)
  1624     CALL 'kxdfhei1' USING DFHEIV0
  1625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1626
  1627
  1628
  1629* EXEC CICS GETMAIN
  1630*        SET (PI-POINTER)
  1631*        LENGTH (ERRS-LENGTH)
  1632*        INITIMG (LIT-SPACE)
  1633*    END-EXEC.
  1634*    MOVE ',"IL                  $   #00001466' TO DFHEIV0
  1635     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  1636     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1637     MOVE X'2020233030303031343636' TO DFHEIV0(25:11)
  1638     CALL 'kxdfhei1' USING DFHEIV0,
  1639           PI-POINTER,
  1640           ERRS-LENGTH,
  1641           LIT-SPACE
  1642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1643
  1644
  1645     IF  PI-FRENCH-FILE
  1646         CONTINUE
  1647
  1648     ELSE
  1649         CONTINUE.
  1650
  1651     MOVE SPACES                 TO ERROR-MESSAGE-FILE.
  1652     MOVE LIT-EM                 TO EM-RECORD-ID.
  1653     MOVE ERRORI                 TO EM-MESSAGE-NUMBER BROWSE-KEY.
  1654     MOVE TEXTI                  TO EM-ERROR-TEXT.
  1655     MOVE SEVI                   TO EM-ERROR-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL110.cbl
  1656     MOVE LIT-A                  TO JP-RECORD-TYPE.
  1657     MOVE ERROR-MESSAGE-FILE     TO JP-RECORD-AREA.
  1658
  1659* EXEC CICS WRITE
  1660*        DATASET (PI-FILE-ID)
  1661*        FROM (ERROR-MESSAGE-FILE)
  1662*        RIDFLD (BROWSE-KEY)
  1663*    END-EXEC.
  1664     MOVE LENGTH OF
  1665      ERROR-MESSAGE-FILE
  1666       TO DFHEIV11
  1667*    MOVE '&$ L                  ''   #00001485' TO DFHEIV0
  1668     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  1669     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1670     MOVE X'2020233030303031343835' TO DFHEIV0(25:11)
  1671     CALL 'kxdfhei1' USING DFHEIV0,
  1672           PI-FILE-ID,
  1673           ERROR-MESSAGE-FILE,
  1674           DFHEIV11,
  1675           BROWSE-KEY,
  1676           DFHEIV99,
  1677           DFHEIV99
  1678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1679
  1680
  1681     PERFORM 2000-JOURNAL-WRITE THRU 2010-EXIT.
  1682
  1683 1130-FILE-FULL.
  1684     MOVE LIT-X                  TO SCREEN-SWITCH.
  1685
  1686 1140-EXIT.
  1687     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL110.cbl
  1689 1150-CHANGE-OPTION.
  1690
  1691* EXEC CICS HANDLE CONDITION
  1692*        NOTOPEN (8230-NOT-OPEN)
  1693*    END-EXEC.
  1694*    MOVE '"$J                   ! & #00001500' TO DFHEIV0
  1695     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
  1696     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1697     MOVE X'2620233030303031353030' TO DFHEIV0(25:11)
  1698     CALL 'kxdfhei1' USING DFHEIV0
  1699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1700
  1701
  1702     MOVE ERRORI                 TO BROWSE-KEY.
  1703     PERFORM 1190-READ-FILE THRU 1200-EXIT.
  1704     MOVE LIT-B                  TO JP-RECORD-TYPE.
  1705     MOVE ERROR-MESSAGE-FILE     TO JP-RECORD-AREA.
  1706     PERFORM 2000-JOURNAL-WRITE THRU 2010-EXIT.
  1707     MOVE TEXTI                  TO EM-ERROR-TEXT.
  1708     MOVE SEVI                   TO EM-ERROR-SEVERITY.
  1709     MOVE LIT-C                  TO JP-RECORD-TYPE.
  1710     MOVE ERROR-MESSAGE-FILE     TO JP-RECORD-AREA.
  1711
  1712* EXEC CICS REWRITE
  1713*        DATASET (PI-FILE-ID)
  1714*        FROM (ERROR-MESSAGE-FILE)
  1715*    END-EXEC.
  1716     MOVE LENGTH OF
  1717      ERROR-MESSAGE-FILE
  1718       TO DFHEIV11
  1719*    MOVE '&& L                  %   #00001513' TO DFHEIV0
  1720     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1721     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1722     MOVE X'2020233030303031353133' TO DFHEIV0(25:11)
  1723     CALL 'kxdfhei1' USING DFHEIV0,
  1724           PI-FILE-ID,
  1725           ERROR-MESSAGE-FILE,
  1726           DFHEIV11,
  1727           DFHEIV99
  1728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1729
  1730
  1731     PERFORM 2000-JOURNAL-WRITE THRU 2010-EXIT.
  1732
  1733 1160-EXIT.
  1734     EXIT.
  1735
  1736 1170-DELETE-OPTION.
  1737
  1738* EXEC CICS HANDLE CONDITION
  1739*        NOTOPEN (8230-NOT-OPEN)
  1740*    END-EXEC.
  1741*    MOVE '"$J                   ! '' #00001524' TO DFHEIV0
  1742     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
  1743     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1744     MOVE X'2720233030303031353234' TO DFHEIV0(25:11)
  1745     CALL 'kxdfhei1' USING DFHEIV0
  1746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL110.cbl
  1747
  1748     MOVE ERRORI                 TO BROWSE-KEY.
  1749     PERFORM 1190-READ-FILE THRU 1200-EXIT.
  1750     MOVE LIT-D                  TO JP-RECORD-TYPE.
  1751     MOVE ERROR-MESSAGE-FILE     TO JP-RECORD-AREA.
  1752
  1753* EXEC CICS DELETE
  1754*        DATASET (PI-FILE-ID)
  1755*    END-EXEC.
  1756*    MOVE '&(                    &   #00001531' TO DFHEIV0
  1757     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1758     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1759     MOVE X'2020233030303031353331' TO DFHEIV0(25:11)
  1760     CALL 'kxdfhei1' USING DFHEIV0,
  1761           PI-FILE-ID,
  1762           DFHEIV99,
  1763           DFHEIV99,
  1764           DFHEIV99,
  1765           DFHEIV99
  1766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1767
  1768     PERFORM 2000-JOURNAL-WRITE THRU 2010-EXIT.
  1769 1180-EXIT.
  1770     EXIT.
  1771
  1772 1190-READ-FILE.
  1773
  1774* EXEC CICS READ
  1775*        DATASET (PI-FILE-ID)
  1776*        RIDFLD  (BROWSE-KEY)
  1777*        INTO    (ERROR-MESSAGE-FILE)
  1778*        UPDATE
  1779*    END-EXEC.
  1780     MOVE LENGTH OF
  1781      ERROR-MESSAGE-FILE
  1782       TO DFHEIV11
  1783*    MOVE '&"IL       EU         (   #00001539' TO DFHEIV0
  1784     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1785     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1786     MOVE X'2020233030303031353339' TO DFHEIV0(25:11)
  1787     CALL 'kxdfhei1' USING DFHEIV0,
  1788           PI-FILE-ID,
  1789           ERROR-MESSAGE-FILE,
  1790           DFHEIV11,
  1791           BROWSE-KEY,
  1792           DFHEIV99,
  1793           DFHEIV99,
  1794           DFHEIV99
  1795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1796
  1797*
  1798*    IF  PI-FRENCH-FILE
  1799*        SERVICE RELOAD ERROR-MESSAGE-FILE-FR
  1800*
  1801*    ELSE
  1802*        SERVICE RELOAD ERROR-MESSAGE-FILE-REST.
  1803
  1804 1200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL110.cbl
  1805     EXIT.
  1806
  1807 2000-JOURNAL-WRITE.
  1808     MOVE LIT-SYS                TO JP-USER-ID.
  1809     MOVE PI-FILE-ID             TO JP-FILE-ID.
  1810     MOVE LIT-PGM                TO JP-PROGRAM-ID.
  1811*    IF PI-JOURNAL-FILE-ID NOT = ZERO
  1812*        EXEC CICS JOURNAL
  1813*            JFILEID (1)
  1814*            JTYPEID ('EL')
  1815*            FROM    (JOURNAL-RECORD)
  1816*            LENGTH  (JOURNAL-LENGTH)
  1817*        END-EXEC.
  1818
  1819 2010-EXIT.
  1820     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL110.cbl
  1822 3000-BUILD-FWD-PAGE.
  1823
  1824* EXEC CICS HANDLE CONDITION
  1825*        ENDFILE (3010-END-FILE)
  1826*        NOTFND  (3010-END-FILE)
  1827*    END-EXEC.
  1828*    MOVE '"$''I                  ! ( #00001571' TO DFHEIV0
  1829     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  1830     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1831     MOVE X'2820233030303031353731' TO DFHEIV0(25:11)
  1832     CALL 'kxdfhei1' USING DFHEIV0
  1833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1834
  1835
  1836
  1837* EXEC CICS READNEXT
  1838*        DATASET (PI-FILE-ID)
  1839*        RIDFLD (BROWSE-KEY)
  1840*        INTO (ERROR-MESSAGE-FILE)
  1841*    END-EXEC.
  1842     MOVE LENGTH OF
  1843      ERROR-MESSAGE-FILE
  1844       TO DFHEIV12
  1845     MOVE 0
  1846       TO DFHEIV11
  1847*    MOVE '&.IL                  )   #00001576' TO DFHEIV0
  1848     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1849     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1850     MOVE X'2020233030303031353736' TO DFHEIV0(25:11)
  1851     CALL 'kxdfhei1' USING DFHEIV0,
  1852           PI-FILE-ID,
  1853           ERROR-MESSAGE-FILE,
  1854           DFHEIV12,
  1855           BROWSE-KEY,
  1856           DFHEIV99,
  1857           DFHEIV11,
  1858           DFHEIV99,
  1859           DFHEIV99
  1860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1861
  1862*
  1863*    IF  PI-FRENCH-FILE
  1864*        SERVICE RELOAD ERROR-MESSAGE-FILE-FR
  1865*
  1866*    ELSE
  1867*        SERVICE RELOAD ERROR-MESSAGE-FILE-REST.
  1868
  1869     MOVE SPACES                 TO DISPLAY-LINE.
  1870     MOVE EM-CONTROL-PRIMARY     TO ERR-CD.
  1871     MOVE EM-ERROR-SEVERITY      TO ERR-SEV.
  1872     MOVE EM-ERROR-TEXT          TO ERR-TEXT.
  1873     ADD 1 TO COUNT-1.
  1874     MOVE DISPLAY-LINE           TO ERRMSGO (COUNT-1).
  1875
  1876     IF COUNT-1 = 1
  1877         MOVE ERR-CD             TO SAVE-BEGIN.
  1878
  1879     IF COUNT-1 = 11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL110.cbl
  1880         MOVE ERR-CD             TO SAVE-ENDING
  1881         MOVE LIT-F              TO SCREEN-SWITCH.
  1882
  1883     GO TO 3020-EXIT.
  1884
  1885 3010-END-FILE.
  1886     PERFORM 3100-FILL-SCREEN THRU 3110-EXIT
  1887         UNTIL SCREEN-FULL.
  1888     MOVE ERR-CD                 TO SAVE-ENDING.
  1889     MOVE END-MSG                TO MSGO.
  1890     MOVE LIT-E                  TO SCREEN-SWITCH.
  1891
  1892 3020-EXIT.
  1893     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL110.cbl
  1895 3030-BUILD-BCK-PAGE.
  1896
  1897* EXEC CICS HANDLE CONDITION
  1898*        ENDFILE (3040-END-FILE)
  1899*        NOTFND  (3040-END-FILE)
  1900*    END-EXEC.
  1901*    MOVE '"$''I                  ! ) #00001615' TO DFHEIV0
  1902     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  1903     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1904     MOVE X'2920233030303031363135' TO DFHEIV0(25:11)
  1905     CALL 'kxdfhei1' USING DFHEIV0
  1906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1907
  1908
  1909
  1910* EXEC CICS READPREV
  1911*        DATASET (PI-FILE-ID)
  1912*        RIDFLD  (BROWSE-KEY)
  1913*        INTO (ERROR-MESSAGE-FILE)
  1914*    END-EXEC.
  1915     MOVE LENGTH OF
  1916      ERROR-MESSAGE-FILE
  1917       TO DFHEIV12
  1918     MOVE 0
  1919       TO DFHEIV11
  1920*    MOVE '&0IL                  )   #00001620' TO DFHEIV0
  1921     MOVE X'2630494C2020202020202020' TO DFHEIV0(1:12)
  1922     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1923     MOVE X'2020233030303031363230' TO DFHEIV0(25:11)
  1924     CALL 'kxdfhei1' USING DFHEIV0,
  1925           PI-FILE-ID,
  1926           ERROR-MESSAGE-FILE,
  1927           DFHEIV12,
  1928           BROWSE-KEY,
  1929           DFHEIV99,
  1930           DFHEIV11,
  1931           DFHEIV99,
  1932           DFHEIV99
  1933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1934
  1935*
  1936*    IF  PI-FRENCH-FILE
  1937*        SERVICE RELOAD ERROR-MESSAGE-FILE-FR
  1938*
  1939*    ELSE
  1940*        SERVICE RELOAD ERROR-MESSAGE-FILE-REST.
  1941
  1942     IF EM-MESSAGE-NUMBER GREATER SAVE-BEGIN
  1943         GO TO 3050-EXIT.
  1944
  1945     MOVE SPACES                 TO DISPLAY-LINE.
  1946     MOVE EM-CONTROL-PRIMARY     TO ERR-CD.
  1947     MOVE EM-ERROR-SEVERITY      TO ERR-SEV.
  1948     MOVE EM-ERROR-TEXT          TO ERR-TEXT.
  1949     MOVE DISPLAY-LINE           TO ERRMSGO (COUNT-1).
  1950
  1951     IF COUNT-1 = 11
  1952         MOVE ERR-CD             TO SAVE-ENDING.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL110.cbl
  1953
  1954     IF COUNT-1 = 1
  1955         MOVE ERR-CD             TO SAVE-BEGIN
  1956         MOVE LIT-F              TO SCREEN-SWITCH.
  1957
  1958     SUBTRACT 1 FROM COUNT-1.
  1959     GO TO 3050-EXIT.
  1960
  1961 3040-END-FILE.
  1962     MOVE ERR-CD                 TO SAVE-BEGIN.
  1963     MOVE END-MSG                TO MSGO.
  1964     MOVE LIT-E                  TO SCREEN-SWITCH.
  1965
  1966 3050-EXIT.
  1967     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL110.cbl
  1969 3060-RAISE-PAGE.
  1970     MOVE 1                      TO COUNT-1.
  1971     MOVE 2                      TO COUNT-2.
  1972     PERFORM 3080-SHIFT-SCREEN THRU 3090-EXIT
  1973          UNTIL COUNT-1 = 11.
  1974     MOVE SPACES                 TO ERRMSGO (COUNT-1).
  1975
  1976 3070-EXIT.
  1977     EXIT.
  1978
  1979 3080-SHIFT-SCREEN.
  1980     MOVE ERRMSGO (COUNT-2)      TO ERRMSGO (COUNT-1).
  1981     ADD 1 TO COUNT-1 COUNT-2.
  1982
  1983 3090-EXIT.
  1984     EXIT.
  1985
  1986 3100-FILL-SCREEN.
  1987     ADD 1 TO COUNT-1.
  1988     MOVE SPACES                 TO ERRMSGO (COUNT-1).
  1989
  1990     IF COUNT-1 GREATER 10
  1991         MOVE LIT-F TO SCREEN-SWITCH.
  1992
  1993 3110-EXIT.
  1994     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL110.cbl
  1996 8100-SEND-MAP.
  1997     PERFORM 8130-FORMAT-DATE-TIME THRU 8140-EXIT.
  1998     MOVE LIT-IC                 TO MAINTL.
  1999
  2000* EXEC CICS SEND
  2001*        MAP    ('EL110A')
  2002*        MAPSET ('EL110S')
  2003*        ERASE
  2004*        FREEKB
  2005*        CURSOR
  2006*    END-EXEC.
  2007     MOVE 'EL110A' TO DFHEIV1
  2008     MOVE -1
  2009       TO DFHEIV11
  2010     MOVE 'EL110S' TO DFHEIV2
  2011*    MOVE '8$     CT  E F  H     ,   #00001689' TO DFHEIV0
  2012     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2013     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
  2014     MOVE X'2020233030303031363839' TO DFHEIV0(25:11)
  2015     CALL 'kxdfhei1' USING DFHEIV0,
  2016           DFHEIV1,
  2017           EL110AO,
  2018           DFHEIV99,
  2019           DFHEIV2,
  2020           DFHEIV99,
  2021           DFHEIV99,
  2022           DFHEIV99,
  2023           DFHEIV11,
  2024           DFHEIV99,
  2025           DFHEIV99,
  2026           DFHEIV99
  2027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2028
  2029
  2030     GO TO 8120-RETURN-TRANS.
  2031
  2032 8110-SEND-DATA.
  2033     PERFORM 8130-FORMAT-DATE-TIME THRU 8140-EXIT.
  2034
  2035* EXEC CICS SEND
  2036*        MAP    ('EL110A')
  2037*        MAPSET ('EL110S')
  2038*        DATAONLY
  2039*        ERASEAUP
  2040*        FREEKB
  2041*        CURSOR
  2042*    END-EXEC.
  2043     MOVE 'EL110A' TO DFHEIV1
  2044     MOVE -1
  2045       TO DFHEIV11
  2046     MOVE 'EL110S' TO DFHEIV2
  2047*    MOVE '8$D    CT  A F  H     ,   #00001701' TO DFHEIV0
  2048     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  2049     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
  2050     MOVE X'2020233030303031373031' TO DFHEIV0(25:11)
  2051     CALL 'kxdfhei1' USING DFHEIV0,
  2052           DFHEIV1,
  2053           EL110AO,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL110.cbl
  2054           DFHEIV99,
  2055           DFHEIV2,
  2056           DFHEIV99,
  2057           DFHEIV99,
  2058           DFHEIV99,
  2059           DFHEIV11,
  2060           DFHEIV99,
  2061           DFHEIV99,
  2062           DFHEIV99
  2063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2064
  2065
  2066 8120-RETURN-TRANS.
  2067
  2068* EXEC CICS RETURN
  2069*        TRANSID  (LIT-TRAN)
  2070*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2071*        LENGTH   (PI-COMM-LENGTH)
  2072*    END-EXEC.
  2073*    MOVE '.(CT                  &   #00001711' TO DFHEIV0
  2074     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2075     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2076     MOVE X'2020233030303031373131' TO DFHEIV0(25:11)
  2077     CALL 'kxdfhei1' USING DFHEIV0,
  2078           LIT-TRAN,
  2079           PROGRAM-INTERFACE-BLOCK,
  2080           PI-COMM-LENGTH,
  2081           DFHEIV99,
  2082           DFHEIV99
  2083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2084
  2085
  2086* GOBACK.
  2087     MOVE '9%                    "   ' TO DFHEIV0
  2088     MOVE 'EL110' TO DFHEIV1
  2089     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2090     GOBACK.
  2091
  2092 8130-FORMAT-DATE-TIME.
  2093     MOVE SAVE-DATE              TO DATEO.
  2094
  2095* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
  2096*    END-EXEC
  2097*    MOVE '0"A                   "   #00001720' TO DFHEIV0
  2098     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
  2099     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  2100     MOVE X'2020233030303031373230' TO DFHEIV0(25:11)
  2101     CALL 'kxdfhei1' USING DFHEIV0,
  2102           LCP-CICS-TIME
  2103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2104
  2105* EXEC CICS FORMATTIME
  2106*              ABSTIME(LCP-CICS-TIME)
  2107*              TIME(LCP-TIME-OF-DAY-XX)
  2108*    END-EXEC
  2109*    MOVE 'j$(     (             #   #00001722' TO DFHEIV0
  2110     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
  2111     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL110.cbl
  2112     MOVE X'2020233030303031373232' TO DFHEIV0(25:11)
  2113     CALL 'kxdfhei1' USING DFHEIV0,
  2114           LCP-CICS-TIME,
  2115           LCP-TIME-OF-DAY-XX
  2116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2117     MOVE  LCP-TIME-OF-DAY-68 TO TIME-UNFORMATTED.
  2118     MOVE UN-HOURS               TO FOR-HOURS.
  2119     MOVE UN-MINUTES             TO FOR-MINUTES.
  2120     MOVE TIME-FORMATTED         TO TIMEO.
  2121     MOVE LIT-MAP                TO PI-CURRENT-SCREEN-NO.
  2122
  2123 8140-EXIT.
  2124     EXIT.
  2125
  2126
  2127 8220-RETURN-CICS.
  2128
  2129* EXEC CICS RETURN
  2130*    END-EXEC.
  2131*    MOVE '.(                    &   #00001737' TO DFHEIV0
  2132     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2133     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2134     MOVE X'2020233030303031373337' TO DFHEIV0(25:11)
  2135     CALL 'kxdfhei1' USING DFHEIV0,
  2136           DFHEIV99,
  2137           DFHEIV99,
  2138           DFHEIV99,
  2139           DFHEIV99,
  2140           DFHEIV99
  2141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2142
  2143
  2144* GOBACK.
  2145     MOVE '9%                    "   ' TO DFHEIV0
  2146     MOVE 'EL110' TO DFHEIV1
  2147     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2148     GOBACK.
  2149
  2150 8230-NOT-OPEN.
  2151     IF  PI-FRENCH-FILE
  2152
  2153* EXEC CICS SEND TEXT
  2154*            FROM (FILE-MSG-FR)
  2155*            LENGTH (FILE-LENGTH)
  2156*            ERASE
  2157*            FREEKB
  2158*        END-EXEC
  2159*    MOVE '8&      T  E F  H   F -   #00001743' TO DFHEIV0
  2160     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2161     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2162     MOVE X'2020233030303031373433' TO DFHEIV0(25:11)
  2163     CALL 'kxdfhei1' USING DFHEIV0,
  2164           FILE-MSG-FR,
  2165           FILE-LENGTH,
  2166           DFHEIV99,
  2167           DFHEIV99,
  2168           DFHEIV99,
  2169           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL110.cbl
  2170           DFHEIV99,
  2171           DFHEIV99,
  2172           DFHEIV99,
  2173           DFHEIV99,
  2174           DFHEIV99,
  2175           DFHEIV99
  2176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2177
  2178     ELSE
  2179
  2180* EXEC CICS SEND TEXT
  2181*            FROM (FILE-MSG)
  2182*            LENGTH (FILE-LENGTH)
  2183*            ERASE
  2184*            FREEKB
  2185*        END-EXEC.
  2186*    MOVE '8&      T  E F  H   F -   #00001751' TO DFHEIV0
  2187     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2188     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2189     MOVE X'2020233030303031373531' TO DFHEIV0(25:11)
  2190     CALL 'kxdfhei1' USING DFHEIV0,
  2191           FILE-MSG,
  2192           FILE-LENGTH,
  2193           DFHEIV99,
  2194           DFHEIV99,
  2195           DFHEIV99,
  2196           DFHEIV99,
  2197           DFHEIV99,
  2198           DFHEIV99,
  2199           DFHEIV99,
  2200           DFHEIV99,
  2201           DFHEIV99,
  2202           DFHEIV99
  2203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2204
  2205
  2206     GO TO 8220-RETURN-CICS.
  2207
  2208 8300-GET-HELP.
  2209     MOVE LIT-HELP TO CALL-PGM.
  2210     GO TO 9400-XCTL.
  2211
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL110.cbl
  2213 8800-UNAUTHORIZED-ACCESS.
  2214     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  2215     GO TO 8800-SEND-TEXT.
  2216
  2217 8800-SEND-TEXT.
  2218
  2219* EXEC CICS SEND TEXT
  2220*        FROM    (LOGOFF-TEXT)
  2221*        LENGTH  (LOGOFF-LENGTH)
  2222*        ERASE
  2223*        FREEKB
  2224*    END-EXEC.
  2225*    MOVE '8&      T  E F  H   F -   #00001770' TO DFHEIV0
  2226     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2227     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2228     MOVE X'2020233030303031373730' TO DFHEIV0(25:11)
  2229     CALL 'kxdfhei1' USING DFHEIV0,
  2230           LOGOFF-TEXT,
  2231           LOGOFF-LENGTH,
  2232           DFHEIV99,
  2233           DFHEIV99,
  2234           DFHEIV99,
  2235           DFHEIV99,
  2236           DFHEIV99,
  2237           DFHEIV99,
  2238           DFHEIV99,
  2239           DFHEIV99,
  2240           DFHEIV99,
  2241           DFHEIV99
  2242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2243
  2244
  2245     GO TO 8220-RETURN-CICS.
  2246
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL110.cbl
  2248 9000-XCTL.
  2249     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
  2250     GO TO 9400-XCTL.
  2251
  2252 9100-XCTL.
  2253     MOVE XCTL-005               TO CALL-PGM.
  2254     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  2255     GO TO 9400-XCTL.
  2256
  2257 9200-XCTL.
  2258
  2259     IF  CREDIT-SESSION
  2260         MOVE XCTL-EL626         TO CALL-PGM
  2261
  2262     ELSE
  2263         IF  CLAIM-SESSION
  2264             MOVE XCTL-EL126     TO CALL-PGM
  2265
  2266         ELSE
  2267             IF  MORTGAGE-SESSION
  2268                 MOVE XCTL-EM626 TO CALL-PGM
  2269
  2270             ELSE
  2271                 IF  GENERAL-LEDGER-SESSION
  2272                     MOVE XCTL-GL800
  2273                                 TO CALL-PGM.
  2274
  2275     GO TO 9400-XCTL.
  2276
  2277 9400-XCTL.
  2278
  2279* EXEC CICS XCTL
  2280*        PROGRAM  (CALL-PGM)
  2281*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2282*        LENGTH   (PI-COMM-LENGTH)
  2283*    END-EXEC.
  2284*    MOVE '.$C                   $   #00001810' TO DFHEIV0
  2285     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2286     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2287     MOVE X'2020233030303031383130' TO DFHEIV0(25:11)
  2288     CALL 'kxdfhei1' USING DFHEIV0,
  2289           CALL-PGM,
  2290           PROGRAM-INTERFACE-BLOCK,
  2291           PI-COMM-LENGTH
  2292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2293
  2294
  2295
  2296* GOBACK.
  2297     MOVE '9%                    "   ' TO DFHEIV0
  2298     MOVE 'EL110' TO DFHEIV1
  2299     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2300     GOBACK.
  2301
  2302 9700-LINK-DATE-CONVERT.
  2303
  2304* EXEC CICS LINK
  2305*        PROGRAM    ('ELDATCV')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL110.cbl
  2306*        COMMAREA   (DATE-CONVERSION-DATA)
  2307*        LENGTH     (DC-COMM-LENGTH)
  2308*        END-EXEC.
  2309     MOVE 'ELDATCV' TO DFHEIV1
  2310*    MOVE '."C                   ''   #00001819' TO DFHEIV0
  2311     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2312     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2313     MOVE X'2020233030303031383139' TO DFHEIV0(25:11)
  2314     CALL 'kxdfhei1' USING DFHEIV0,
  2315           DFHEIV1,
  2316           DATE-CONVERSION-DATA,
  2317           DC-COMM-LENGTH,
  2318           DFHEIV99,
  2319           DFHEIV99,
  2320           DFHEIV99
  2321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2322
  2323 9700-EXIT.
  2324     EXIT.
  2325
  2326 9999-DFHBACK SECTION.
  2327     MOVE '9%                    "   ' TO DFHEIV0
  2328     MOVE 'EL110' TO DFHEIV1
  2329     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2330     GOBACK.
  2331 9999-DFHEXIT.
  2332     IF DFHEIGDJ EQUAL 0001
  2333         NEXT SENTENCE
  2334     ELSE IF DFHEIGDJ EQUAL 2
  2335         GO TO 8230-NOT-OPEN,
  2336               0110-REC-NOT-FND
  2337         DEPENDING ON DFHEIGDI
  2338     ELSE IF DFHEIGDJ EQUAL 3
  2339         GO TO 8230-NOT-OPEN,
  2340               0210-REC-NOT-FND
  2341         DEPENDING ON DFHEIGDI
  2342     ELSE IF DFHEIGDJ EQUAL 4
  2343         GO TO 1040-RECORD-NOT-FOUND,
  2344               1040-RECORD-NOT-FOUND
  2345         DEPENDING ON DFHEIGDI
  2346     ELSE IF DFHEIGDJ EQUAL 5
  2347         GO TO 8230-NOT-OPEN,
  2348               1130-FILE-FULL
  2349         DEPENDING ON DFHEIGDI
  2350     ELSE IF DFHEIGDJ EQUAL 6
  2351         GO TO 8230-NOT-OPEN
  2352         DEPENDING ON DFHEIGDI
  2353     ELSE IF DFHEIGDJ EQUAL 7
  2354         GO TO 8230-NOT-OPEN
  2355         DEPENDING ON DFHEIGDI
  2356     ELSE IF DFHEIGDJ EQUAL 8
  2357         GO TO 3010-END-FILE,
  2358               3010-END-FILE
  2359         DEPENDING ON DFHEIGDI
  2360     ELSE IF DFHEIGDJ EQUAL 9
  2361         GO TO 3040-END-FILE,
  2362               3040-END-FILE
  2363         DEPENDING ON DFHEIGDI.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL110.cbl
  2364     MOVE '9%                    "   ' TO DFHEIV0
  2365     MOVE 'EL110' TO DFHEIV1
  2366     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2367     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4760     Code:        7261
