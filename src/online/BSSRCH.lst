* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page   1
* BSSRCH.cbl
* Options: int("BSSRCH.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("BSSRCH.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"BSSRCH.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"BSSRCH.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2013 by Central States Health and Life          *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. BSSRCH.
     9*
    10*AUTHOR.    Pablo.
    11*           Colleyville, TEXAS.
    12********************************************
    13*   Balance sheet for month end balancing
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page   2
* BSSRCH.cbl
    14********************************************
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 082013  CR2013060600001  PEMA  ADJ TOL TO 10% FOR NON-PROC
    24* 100813  IR2013100100001  PEMA INCREASE NON-PROC REF TOL
    25* 101713  CR2013060600001  PEMA AUTOMATE AHL MORT RESERVE CALC
    26* 031714  IR2014030200002  PEMA INCREASE NON-PROC REF TOL
    27* 040214  IR2014040200002  PEMA FIX NON-PROC REF TOL
    28* 123014  CR2014123000001  PEMA CHG AHL MORT RESV TOL
    29* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    30* 071816  CR2016062900001  PEMA CHG AHL MORT RESV TOL
    31* 041417  CR2016022400002  PEMA  TPE/BPE Upgrade
    32* 100220  CR2020092400001  PEMA  Add calc of est mort resv for CID
    33* 110220  IR2020110200001  PEMA  Correct mort estimate
    34******************************************************************
    35 environment division.
    36 INPUT-OUTPUT SECTION.
    37 FILE-CONTROL.
    38 SELECT ECS010-IN ASSIGN TO dynamic ws-ecs010-in
    39    FILE STATUS IS ECS010-STATUS.
    40 SELECT ECS080-IN ASSIGN TO dynamic ws-ecs080-in
    41    FILE STATUS IS ECS080-STATUS
    42                            ORGANIZATION IS LINE SEQUENTIAL.
    43 SELECT CHKPOINT-OUT ASSIGN TO dynamic ws-checkpoint-out
    44    FILE STATUS IS CHKPNT-STATUS
    45                            ORGANIZATION IS LINE SEQUENTIAL.
    46 data division.
    47 FILE SECTION.
    48 FD  ECS010-IN
    49     BLOCK CONTAINS 0
    50     RECORDING MODE F.
    51 01  ECS010-IN-REC               pic x(94).
    52 FD  ECS080-IN
    53     BLOCK CONTAINS 0
    54     RECORDING MODE F.
    55 01  ECS080-IN-REC               pic x(83).
    56 FD  CHKPOINT-OUT
    57     BLOCK CONTAINS 0
    58     RECORDING MODE F.
    59 01  CHKPOINT-OUT-REC            pic x(94).
    60 working-storage section.
    61 01  DFH-START PIC X(04).
    62 77  s1 pic s999 comp-3 value +0.
    63 77  s2 pic s999 comp-3 value +0.
    64 77  ws-pass-amount              pic s9(11) comp-3 value +0.
    65 77  ws-low-amount               pic s9(11) value zeros.
    66 77  ws-hi-amount                pic s9(11) value zeros.
    67 77  ws-low-pct                  pic s9v9(4) value zeros comp-3.
    68 77  ws-high-pct                 pic s9v9(4) value zeros comp-3.
    69************************************************
    70* commarea passed to the business logic
    71************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page   3
* BSSRCH.cbl
    72 01  srch-commarea.
    73*                                copy BSSRCH-COMMAREA.
    74*****************************************************************
    75*                                                               *
    76* Copyright (c) 2013 by CSO.                                    *
    77* All rights reserved.                                          *
    78*                                                               *
    79*****************************************************************
    80****************************************
    81*  commarea for QUERY by eom date and company id
    82*  (business logic input & output)
    83****************************************
    84******************************************************************
    85*                   C H A N G E   L O G
    86*
    87* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    88*-----------------------------------------------------------------
    89*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    90* EFFECTIVE    NUMBER
    91*-----------------------------------------------------------------
    92* 100220  CR2020092400001  PEMA  Add calc of est mort resv for CID
    93******************************************************************
    94     03  bl-input.
    95         05  bl-input-eom-date   pic x(10).
    96         05  bl-input-comp-id    pic xxx.
    97         05  bl-input-lo-resv    pic 9(9).
    98         05  bl-input-hi-resv    pic 9(9).
    99         05  bl-input-bld-file   pic xxx.
   100     03  bl-output.
   101         05  bl-status           pic x.
   102             88  bl-ok                 value "p".
   103             88  bl-fail               value "f".
   104         05  bl-output-message   pic x(50).
   105         05  bl-output-record.
   106            07  bl-out-company-name
   107                                 pic x(30).
   108            07  bl-out-formated-date
   109                                 pic x(20).
   110            07  filler occurs 3.
   111                09  bl-out-lf-prem  pic s9(9)v99 comp-3 value +0.
   112                09  bl-out-ah-prem  pic s9(9)v99 comp-3 value +0.
   113                09  bl-out-lf-ref   pic s9(9)v99 comp-3 value +0.
   114                09  bl-out-ah-ref   pic s9(9)v99 comp-3 value +0.
   115                09  bl-out-lf-net   pic s9(9)v99 comp-3 value +0.
   116                09  bl-out-ah-net   pic s9(9)v99 comp-3 value +0.
   117                09  bl-out-lf-iss-com
   118                                    pic s9(9)v99 comp-3 value +0.
   119                09  bl-out-ah-iss-com
   120                                    pic s9(9)v99 comp-3 value +0.
   121                09  bl-out-lf-ref-com
   122                                    pic s9(9)v99 comp-3 value +0.
   123                09  bl-out-ah-ref-com
   124                                    pic s9(9)v99 comp-3 value +0.
   125                09  bl-out-lf-net-com
   126                                    pic s9(9)v99 comp-3 value +0.
   127                09  bl-out-ah-net-com
   128                                    pic s9(9)v99 comp-3 value +0.
   129                09  bl-out-iss-com  pic s9(9)v99 comp-3 value +0.
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page   4
* BSSRCH.cbl
   130                09  bl-out-ref-com  pic s9(9)v99 comp-3 value +0.
   131                09  bl-out-net-com  pic s9(9)v99 comp-3 value +0.
   132                09  bl-out-iss-cnt  pic s9(9)    comp-3 value +0.
   133                09  bl-out-can-cnt  pic s9(9)    comp-3 value +0.
   134                09  bl-out-net-cnt  pic s9(9)    comp-3 value +0.
   135                09  bl-out-tot-prm  pic s9(9)v99 comp-3 value +0.
   136                09  bl-out-tot-ref  pic s9(9)v99 comp-3 value +0.
   137                09  bl-out-net-tot  pic s9(9)v99 comp-3 value +0.
   138            07  bl-out-cm-cnt    pic s9(9)     comp-3 value +0.
   139            07  bl-out-lf-clms-pd
   140                                 pic s9(9)v99  comp-3 value +0.
   141            07  bl-out-lf-clms-void
   142                                 pic s9(9)v99  comp-3 value +0.
   143            07  bl-out-lf-tot-clms
   144                                 pic s9(9)v99  comp-3 value +0.
   145            07  bl-out-ah-clms-pd
   146                                 pic s9(9)v99  comp-3 value +0.
   147            07  bl-out-ah-clms-void
   148                                 pic s9(9)v99  comp-3 value +0.
   149            07  bl-out-ah-tot-clms
   150                                 pic s9(9)v99  comp-3 value +0.
   151            07  bl-out-clms-pd   pic s9(9)v99  comp-3 value +0.
   152            07  bl-out-clms-void pic s9(9)v99  comp-3 value +0.
   153            07  bl-out-tot-clms  pic s9(9)v99  comp-3 value +0.
   154            07  bl-out-lf-clms-cur
   155                                 pic s9(9)v99  comp-3 value +0.
   156            07  bl-out-ah-clms-cur
   157                                 pic s9(9)v99  comp-3 value +0.
   158            07  bl-out-tot-clms-cur
   159                                 pic s9(9)v99  comp-3 value +0.
   160            07  bl-tot-inforce   pic s9(11)v99 comp-3 value +0.
   161*                                copy ELCFUNDT.
   162*****************************************************************
   163*                                                               *
   164*                            ELCFUNDT.                          *
   165*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   166*                            VMOD=2.001                         *
   167*                                                               *
   168*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   169*                                                               *
   170*****************************************************************
   171
   172
   173 01  FUNCTION-DATE.
   174     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   175     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   176         10  WS-FN-CCYR            PIC 9(4).
   177         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   178             15  WS-FN-CC          PIC 99.
   179             15  WS-FN-YR          PIC 99.
   180         10  WS-FN-MO              PIC 99.
   181         10  WS-FN-DA              PIC 99.
   182     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   183     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   184     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   185     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   186     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   187         88  WS-BEHIND-GMT                     VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page   5
* BSSRCH.cbl
   188         88  WS-AFTER-GMT                      VALUE '+'.
   189         88  WS-NO-GMT                         VALUE ZERO.
   190     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   191     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   192*                                COPY ELCDATE.
   193******************************************************************
   194*                                                                *
   195*                                                                *
   196*                            ELCDATE.                            *
   197*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   198*                            VMOD=2.003
   199*                                                                *
   200*                                                                *
   201*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   202*                 LENGTH = 200                                   *
   203******************************************************************
   204
   205 01  DATE-CONVERSION-DATA.
   206     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   207     12  DC-OPTION-CODE                PIC X.
   208         88  BIN-TO-GREG                VALUE ' '.
   209         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   210         88  EDIT-GREG-TO-BIN           VALUE '2'.
   211         88  YMD-GREG-TO-BIN            VALUE '3'.
   212         88  MDY-GREG-TO-BIN            VALUE '4'.
   213         88  JULIAN-TO-BIN              VALUE '5'.
   214         88  BIN-PLUS-ELAPSED           VALUE '6'.
   215         88  FIND-CENTURY               VALUE '7'.
   216         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   217         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   218         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   219         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   220         88  JULIAN-TO-BIN-3            VALUE 'C'.
   221         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   222         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   223         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   224         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   225         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   226         88  CHECK-LEAP-YEAR            VALUE 'H'.
   227         88  BIN-3-TO-GREG              VALUE 'I'.
   228         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   229         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   230         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   231         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   232         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   233         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   234         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   235         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   236         88  THREE-CHARACTER-BIN
   237                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   238         88  GREGORIAN-TO-BIN
   239                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   240         88  BIN-TO-GREGORIAN
   241                  VALUES ' ' '1' 'I' '8' 'G'.
   242         88  JULIAN-TO-BINARY
   243                  VALUES '5' 'C' 'E' 'F'.
   244     12  DC-ERROR-CODE                 PIC X.
   245         88  NO-CONVERSION-ERROR        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page   6
* BSSRCH.cbl
   246         88  DATE-CONVERSION-ERROR
   247                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   248         88  DATE-IS-ZERO               VALUE '1'.
   249         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   250         88  DATE-IS-INVALID            VALUE '3'.
   251         88  DATE1-GREATER-DATE2        VALUE '4'.
   252         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   253         88  DATE-INVALID-OPTION        VALUE '9'.
   254         88  INVALID-CENTURY            VALUE 'A'.
   255         88  ONLY-CENTURY               VALUE 'B'.
   256         88  ONLY-LEAP-YEAR             VALUE 'C'.
   257         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   258     12  DC-END-OF-MONTH               PIC X.
   259         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   260     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   261         88  USE-NORMAL-PROCESS         VALUE ' '.
   262         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   263         88  ADJUST-UP-100-YRS          VALUE '2'.
   264     12  FILLER                        PIC X.
   265     12  DC-CONVERSION-DATES.
   266         16  DC-BIN-DATE-1             PIC XX.
   267         16  DC-BIN-DATE-2             PIC XX.
   268         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   269         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   270                       DC-GREG-DATE-1-EDIT.
   271             20  DC-EDIT1-MONTH        PIC 99.
   272             20  SLASH1-1              PIC X.
   273             20  DC-EDIT1-DAY          PIC 99.
   274             20  SLASH1-2              PIC X.
   275             20  DC-EDIT1-YEAR         PIC 99.
   276         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   277         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   278                     DC-GREG-DATE-2-EDIT.
   279             20  DC-EDIT2-MONTH        PIC 99.
   280             20  SLASH2-1              PIC X.
   281             20  DC-EDIT2-DAY          PIC 99.
   282             20  SLASH2-2              PIC X.
   283             20  DC-EDIT2-YEAR         PIC 99.
   284         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   285         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   286                     DC-GREG-DATE-1-YMD.
   287             20  DC-YMD-YEAR           PIC 99.
   288             20  DC-YMD-MONTH          PIC 99.
   289             20  DC-YMD-DAY            PIC 99.
   290         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   291         16  DC-GREG-DATE-1-MDY-R REDEFINES
   292                      DC-GREG-DATE-1-MDY.
   293             20  DC-MDY-MONTH          PIC 99.
   294             20  DC-MDY-DAY            PIC 99.
   295             20  DC-MDY-YEAR           PIC 99.
   296         16  DC-GREG-DATE-1-ALPHA.
   297             20  DC-ALPHA-MONTH        PIC X(10).
   298             20  DC-ALPHA-DAY          PIC 99.
   299             20  FILLER                PIC XX.
   300             20  DC-ALPHA-CENTURY.
   301                 24 DC-ALPHA-CEN-N     PIC 99.
   302             20  DC-ALPHA-YEAR         PIC 99.
   303         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page   7
* BSSRCH.cbl
   304         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   305         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   306         16  DC-JULIAN-DATE            PIC 9(05).
   307         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   308                                       PIC 9(05).
   309         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   310             20  DC-JULIAN-YEAR        PIC 99.
   311             20  DC-JULIAN-DAYS        PIC 999.
   312         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   313         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   314         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   315     12  DATE-CONVERSION-VARIBLES.
   316         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   317         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   318             20  FILLER                PIC 9(3).
   319             20  HOLD-CEN-1-CCYY.
   320                 24  HOLD-CEN-1-CC     PIC 99.
   321                 24  HOLD-CEN-1-YY     PIC 99.
   322             20  HOLD-CEN-1-MO         PIC 99.
   323             20  HOLD-CEN-1-DA         PIC 99.
   324         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   325             20  HOLD-CEN-1-R-MO       PIC 99.
   326             20  HOLD-CEN-1-R-DA       PIC 99.
   327             20  HOLD-CEN-1-R-CCYY.
   328                 24  HOLD-CEN-1-R-CC   PIC 99.
   329                 24  HOLD-CEN-1-R-YY   PIC 99.
   330             20  FILLER                PIC 9(3).
   331         16  HOLD-CENTURY-1-X.
   332             20  FILLER                PIC X(3)  VALUE SPACES.
   333             20  HOLD-CEN-1-X-CCYY.
   334                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   335                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   336             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   337             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   338         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   339             20  HOLD-CEN-1-R-X-MO     PIC XX.
   340             20  HOLD-CEN-1-R-X-DA     PIC XX.
   341             20  HOLD-CEN-1-R-X-CCYY.
   342                 24  HOLD-CEN-1-R-X-CC PIC XX.
   343                 24  HOLD-CEN-1-R-X-YY PIC XX.
   344             20  FILLER                PIC XXX.
   345         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   346         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   347         16  DC-JULIAN-DATE-1          PIC 9(07).
   348         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   349             20  DC-JULIAN-1-CCYY.
   350                 24  DC-JULIAN-1-CC    PIC 99.
   351                 24  DC-JULIAN-1-YR    PIC 99.
   352             20  DC-JULIAN-DA-1        PIC 999.
   353         16  DC-JULIAN-DATE-2          PIC 9(07).
   354         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   355             20  DC-JULIAN-2-CCYY.
   356                 24  DC-JULIAN-2-CC    PIC 99.
   357                 24  DC-JULIAN-2-YR    PIC 99.
   358             20  DC-JULIAN-DA-2        PIC 999.
   359         16  DC-GREG-DATE-A-EDIT.
   360             20  DC-EDITA-MONTH        PIC 99.
   361             20  SLASHA-1              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page   8
* BSSRCH.cbl
   362             20  DC-EDITA-DAY          PIC 99.
   363             20  SLASHA-2              PIC X VALUE '/'.
   364             20  DC-EDITA-CCYY.
   365                 24  DC-EDITA-CENT     PIC 99.
   366                 24  DC-EDITA-YEAR     PIC 99.
   367         16  DC-GREG-DATE-B-EDIT.
   368             20  DC-EDITB-MONTH        PIC 99.
   369             20  SLASHB-1              PIC X VALUE '/'.
   370             20  DC-EDITB-DAY          PIC 99.
   371             20  SLASHB-2              PIC X VALUE '/'.
   372             20  DC-EDITB-CCYY.
   373                 24  DC-EDITB-CENT     PIC 99.
   374                 24  DC-EDITB-YEAR     PIC 99.
   375         16  DC-GREG-DATE-CYMD         PIC 9(08).
   376         16  DC-GREG-DATE-CYMD-R REDEFINES
   377                              DC-GREG-DATE-CYMD.
   378             20  DC-CYMD-CEN           PIC 99.
   379             20  DC-CYMD-YEAR          PIC 99.
   380             20  DC-CYMD-MONTH         PIC 99.
   381             20  DC-CYMD-DAY           PIC 99.
   382         16  DC-GREG-DATE-MDCY         PIC 9(08).
   383         16  DC-GREG-DATE-MDCY-R REDEFINES
   384                              DC-GREG-DATE-MDCY.
   385             20  DC-MDCY-MONTH         PIC 99.
   386             20  DC-MDCY-DAY           PIC 99.
   387             20  DC-MDCY-CEN           PIC 99.
   388             20  DC-MDCY-YEAR          PIC 99.
   389    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   390        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   391    12  DC-EL310-DATE                  PIC X(21).
   392    12  FILLER                         PIC X(28).
   393* 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
   394*     'BEGINJOB mode=''MVS'''.
   395* 01  TRAN-DATA-LINE2             PIC X(80)    VALUE
   396*     'LABEL name=PERL1'.
   397* 01  TRAN-DATA-LINE3             PIC X(80)    VALUE
   398*     'ASSGNDD ddname=''SYSIN'' type=''INSTREAM''  << !'.
   399* 01  TRAN-DATA-LINE4             PIC X(80)    VALUE
   400*     'perl /export/home/pema/bin/bal_sheet_ss.pl $SEQFILES/a1.txt
   401*-    '$SEQFILES/a2.xlsx'
   402* 01  TRAN-DATA-LINE5             PIC X(80)    VALUE '!'.
   403* 01  TRAN-DATA-LINE6             PIC X(80)    VALUE
   404*    'EXECPGM pgmname=''BPXBATCH'' stepname=''PERL1'' parm=''SH'''
   405* 01  TRAN-DATA-LINE7             PIC X(80)    VALUE
   406*     'LABEL name=EMAIL'.
   407* 01  TRAN-DATA-LINE8             PIC X(80)    VALUE
   408*     'ASSGNDD ddname=''SYSIN'' type=''INSTREAM''  << !'.
   409* 01  TRAN-DATA-LINE9             PIC X(80)    VALUE
   410*     'mutt -s ''AHL chkpts'' -a $SEQFILES/ahlmechkpts.xlsx pema@c
   411*-    'o.com < /dev/null'.
   412* 01  TRAN-DATA-LINE10            PIC X(80)    VALUE '!'.
   413* 01  TRAN-DATA-LINE11            PIC X(80)    VALUE
   414*    'EXECPGM pgmname=''BPXBATCH'' stepname=''EMAIL'' parm=''SH'''
   415* 01  TRAN-DATA-LINE12            PIC X(80)    VALUE
   416*     'ENDJOB'.
   417 01  ws-work-dynamic.
   418     05  ws-seqfiles-dir         pic x(27) value spaces.
   419     05  ws-jcllib-dir           pic x(27) value spaces.
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page   9
* BSSRCH.cbl
   420     05  ws-work-env             pic x(8)  value spaces.
   421     05  ws-work-comp-id         pic xxx   value spaces.
   422     05  ws-work-file-in         pic x(16) value spaces.
   423     05  ws-work-rpt-out         pic x(13) value spaces.
   424     05  ws-ecs010-jobname       pic x(10)  value spaces.
   425     05  ws-ecs080-jobname       pic x(10)  value spaces.
   426
   427 01  ws-ecs010-in                pic x(58).
   428 01  ws-ecs080-in                pic x(58).
   429 01  ws-checkpoint-out           pic x(58).
   430
   431 01  P pointer.
   432 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   433 01  var-ptr pointer.
   434 01  env-var-len                 pic 9(4)  binary.
   435 01  rc                          pic 9(9)  binary.
   436
   437 01  WS-KIXSYS.
   438     05  WS-KIX-FIL1             PIC X(10).
   439     05  WS-KIX-APPS             PIC X(10).
   440     05  WS-KIX-ENV              PIC X(10).
   441     05  WS-KIX-MYENV            PIC X(10).
   442     05  WS-KIX-SYS              PIC X(10).
   443 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
   444     'cd /apps/prod/cid1p/jcl'.
   445 01  TRAN-DATA-LINE2.
   446     05  filler                  pic x(10) value 'unikixjob '.
   447     05  tran-comp-id            pic xxx   value '   '.
   448     05  filler                 pic x(15) value 'chkpts -k cid1p'.
   449     05  filler                  pic x(52) value spaces.
   450 01  filler.
   451     12  WS-RESPONSE2            PIC S9(8)   COMP.
   452     12  WS-RESPONSE             PIC S9(8)   COMP.
   453         88  RESP-NORMAL                  VALUE +00.
   454         88  RESP-NOTFND                  VALUE +13.
   455         88  RESP-DUPREC                  VALUE +14.
   456         88  RESP-DUPKEY                  VALUE +15.
   457         88  RESP-NOTOPEN                 VALUE +19.
   458         88  RESP-ENDFILE                 VALUE +20.
   459 01  ws-ECS010-IN-REC.
   460     05  filler                  pic x(21).
   461     05  ecs010-cert-cnt         pic x(11).
   462     05  filler                  pic x(62).
   463 01  ws-ECS080-IN-REC.
   464     05  filler                  pic x(21).
   465     05  ecs080-mort-resv        pic x(13).
   466     05  filler                  pic x(49).
   467 01  cpo-out-record.
   468     05  cpo-jobname             pic x(10)  value spaces.
   469     05  f                       pic x value ';'.
   470     05  cpo-stepname            pic x(6)   value spaces.
   471     05  f                       pic x value ';'.
   472     05  cpo-low-amount          pic -9(9)  value zeros.
   473     05  f                       pic x value ';'.
   474     05  cpo-hi-amount           pic -9(9)  value zeros.
   475     05  f                       pic x value ';'.
   476     05  cpo-desc                pic x(50)  value spaces.
   477 01  ahl-table.
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  10
* BSSRCH.cbl
   478     05 f                        pic x(68) value
   479         'AHLGM10   ;EL524 ;Total Claims Paid
   480-        '            '.
   481     05 f                        pic x(68) value
   482         'AHLGM10   ;EL523 ;Processable Written & Outstanding Bala
   483-        'nce         '.
   484     05 f                        pic x(68) value
   485         'AHLGM10   ;EL523 ;Non-Processable Written & Outstanding
   486-        'Balance     '.
   487     05 f                        pic x(68) value
   488         'AHLGM10   ;EL523 ;Total Written & Outstanding Balance
   489-        '            '.
   490     05 f                        pic x(68) value
   491         'AHLGM10   ;EL523 ;Processable Cancelled
   492-        '            '.
   493     05 f                        pic x(68) value
   494         'AHLGM10   ;EL523 ;Non-Processable Cancelled
   495-        '            '.
   496     05 f                        pic x(68) value
   497         'AHLGM10   ;EL523 ;Total Cancelled
   498-        '            '.
   499     05 f                        pic x(68) value
   500         'AHLGM10   ;EL523 ;Processable Net Premium
   501-        '            '.
   502     05 f                        pic x(68) value
   503         'AHLGM10   ;EL523 ;Non-Processable Net Premium
   504-        '            '.
   505     05 f                        pic x(68) value
   506         'AHLGM10   ;EL523 ;Total Net Premium
   507-        '            '.
   508     05 f                        pic x(68) value
   509         'AHLGM10   ;EL523 ;Processable Net Commission
   510-        '            '.
   511     05 f                        pic x(68) value
   512         'AHLGM10   ;EL523 ;Non-Processable Net Commission
   513-        '            '.
   514     05 f                        pic x(68) value
   515         'AHLGM10   ;EL523 ;Total Net Commission
   516-        '            '.
   517     05 f                        pic x(68) value
   518         'AHLGM15   ;ECS010;Life Claims Paid
   519-        '            '.
   520     05 f                        pic x(68) value
   521         'AHLGM15   ;ECS010;A&H Claims Paid
   522-        '            '.
   523     05 f                        pic x(68) value
   524         'AHLGM15   ;ECS010;Output Certificate Master Records Prio
   525-        'r Month     '.
   526     05 f                        pic x(68) value
   527         'AHLGM17   ;ECS080;Gross Reserve
   528-        '            '.
   529 01  dcc-table.
   530     05 f                        pic x(68) value
   531         'CIDCLGM10 ;EL524 ;Total Claims Paid
   532-        '            '.
   533     05 f                        pic x(68) value
   534         'CIDCLGM10 ;EL523 ;Processable Written & Outstanding Bala
   535-        'nce         '.
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  11
* BSSRCH.cbl
   536     05 f                        pic x(68) value
   537         'CIDCLGM10 ;EL523 ;Non-Processable Written & Outstanding
   538-        'Balance     '.
   539     05 f                        pic x(68) value
   540         'CIDCLGM10 ;EL523 ;Total Written & Outstanding Balance
   541-        '            '.
   542     05 f                        pic x(68) value
   543         'CIDCLGM10 ;EL523 ;Processable Cancelled
   544-        '            '.
   545     05 f                        pic x(68) value
   546         'CIDCLGM10 ;EL523 ;Non-Processable Cancelled
   547-        '            '.
   548     05 f                        pic x(68) value
   549         'CIDCLGM10 ;EL523 ;Total Cancelled
   550-        '            '.
   551     05 f                        pic x(68) value
   552         'CIDCLGM10 ;EL523 ;Processable Net Premium
   553-        '            '.
   554     05 f                        pic x(68) value
   555         'CIDCLGM10 ;EL523 ;Non-Processable Net Premium
   556-        '            '.
   557     05 f                        pic x(68) value
   558         'CIDCLGM10 ;EL523 ;Total Net Premium
   559-        '            '.
   560     05 f                        pic x(68) value
   561         'CIDCLGM10 ;EL523 ;Processable Net Commission
   562-        '            '.
   563     05 f                        pic x(68) value
   564         'CIDCLGM10 ;EL523 ;Non-Processable Net Commission
   565-        '            '.
   566     05 f                        pic x(68) value
   567         'CIDCLGM10 ;EL523 ;Total Net Commission
   568-        '            '.
   569     05 f                        pic x(68) value
   570         'CIDCLGM15 ;ECS010;Life Claims Paid
   571-        '            '.
   572     05 f                        pic x(68) value
   573         'CIDCLGM15 ;ECS010;A&H Claims Paid
   574-        '            '.
   575     05 f                        pic x(68) value
   576         'CIDCLGM15 ;ECS010;Output Certificate Master Records Prio
   577-        'r Month     '.
   578     05 f                        pic x(68) value
   579         'CIDCLGM17 ;ECS080;Gross Reserve
   580-        '            '.
   581 01  VPP-table.
   582     05 f                        pic x(68) value
   583         'CIVPLGM10 ;EL524 ;Total Claims Paid
   584-        '            '.
   585     05 f                        pic x(68) value
   586         'CIVPLGM10 ;EL523 ;Processable Written & Outstanding Bala
   587-        'nce         '.
   588     05 f                        pic x(68) value
   589         'CIVPLGM10 ;EL523 ;Non-Processable Written & Outstanding
   590-        'Balance     '.
   591     05 f                        pic x(68) value
   592         'CIVPLGM10 ;EL523 ;Total Written & Outstanding Balance
   593-        '            '.
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  12
* BSSRCH.cbl
   594     05 f                        pic x(68) value
   595         'CIVPLGM10 ;EL523 ;Processable Cancelled
   596-        '            '.
   597     05 f                        pic x(68) value
   598         'CIVPLGM10 ;EL523 ;Non-Processable Cancelled
   599-        '            '.
   600     05 f                        pic x(68) value
   601         'CIVPLGM10 ;EL523 ;Total Cancelled
   602-        '            '.
   603     05 f                        pic x(68) value
   604         'CIVPLGM10 ;EL523 ;Processable Net Premium
   605-        '            '.
   606     05 f                        pic x(68) value
   607         'CIVPLGM10 ;EL523 ;Non-Processable Net Premium
   608-        '            '.
   609     05 f                        pic x(68) value
   610         'CIVPLGM10 ;EL523 ;Total Net Premium
   611-        '            '.
   612     05 f                        pic x(68) value
   613         'CIVPLGM10 ;EL523 ;Processable Net Commission
   614-        '            '.
   615     05 f                        pic x(68) value
   616         'CIVPLGM10 ;EL523 ;Non-Processable Net Commission
   617-        '            '.
   618     05 f                        pic x(68) value
   619         'CIVPLGM10 ;EL523 ;Total Net Commission
   620-        '            '.
   621     05 f                        pic x(68) value
   622         'CIVPLGM15 ;ECS010;Life Claims Paid
   623-        '            '.
   624     05 f                        pic x(68) value
   625         'CIVPLGM15 ;ECS010;A&H Claims Paid
   626-        '            '.
   627     05 f                        pic x(68) value
   628         'CIVPLGM15 ;ECS010;Output Certificate Master Records Prio
   629-        'r Month     '.
   630     05 f                        pic x(68) value
   631         'CIVPLGM17 ;ECS080;Gross Reserve
   632-        '            '.
   633 01  cid-table.
   634     05 f                        pic x(68) value
   635         'CILGM10   ;EL524 ;Total Claims Paid
   636-        '            '.
   637     05 f                        pic x(68) value
   638         'CILGM10   ;EL523 ;Processable Written & Outstanding Bala
   639-        'nce         '.
   640     05 f                        pic x(68) value
   641         'CILGM10   ;EL523 ;Non-Processable Written & Outstanding
   642-        'Balance     '.
   643     05 f                        pic x(68) value
   644         'CILGM10   ;EL523 ;Total Written & Outstanding Balance
   645-        '            '.
   646     05 f                        pic x(68) value
   647         'CILGM10   ;EL523 ;Processable Cancelled
   648-        '            '.
   649     05 f                        pic x(68) value
   650         'CILGM10   ;EL523 ;Non-Processable Cancelled
   651-        '            '.
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  13
* BSSRCH.cbl
   652     05 f                        pic x(68) value
   653         'CILGM10   ;EL523 ;Total Cancelled
   654-        '            '.
   655     05 f                        pic x(68) value
   656         'CILGM10   ;EL523 ;Processable Net Premium
   657-        '            '.
   658     05 f                        pic x(68) value
   659         'CILGM10   ;EL523 ;Non-Processable Net Premium
   660-        '            '.
   661     05 f                        pic x(68) value
   662         'CILGM10   ;EL523 ;Total Net Premium
   663-        '            '.
   664     05 f                        pic x(68) value
   665         'CILGM10   ;EL523 ;Processable Net Commission
   666-        '            '.
   667     05 f                        pic x(68) value
   668         'CILGM10   ;EL523 ;Non-Processable Net Commission
   669-        '            '.
   670     05 f                        pic x(68) value
   671         'CILGM10   ;EL523 ;Total Net Commission
   672-        '            '.
   673     05 f                        pic x(68) value
   674         'CILGM15   ;ECS010;Life Claims Paid
   675-        '            '.
   676     05 f                        pic x(68) value
   677         'CILGM15   ;ECS010;A&H Claims Paid
   678-        '            '.
   679     05 f                        pic x(68) value
   680         'CILGM15   ;ECS010;Output Certificate Master Records Prio
   681-        'r Month     '.
   682     05 f                        pic x(68) value
   683         'CILGM17   ;ECS080;Gross Reserve
   684-        '            '.
   685 01  filler redefines cid-table.
   686     05  filler occurs 17.
   687         10  tbl-jobname             pic x(10).
   688         10  f                       pic x.
   689         10  tbl-stepname            pic x(6).
   690         10  f                       pic x.
   691         10  tbl-desc                pic x(50).
   692 01  filler.
   693     05  filler occurs 17.
   694         10  tbl-low-amount      pic s9(9).
   695         10  tbl-hi-amount       pic s9(9).
   696************************************
   697* fields used to read web data
   698************************************
   699 01  w-form-name       pic x(80).
   700 01  w-form-value      pic x(80).
   701 01  w-form-name-len   pic s9(8) comp.
   702 01  w-form-value-len  pic s9(8) comp.
   703 01  w-resp            pic s9(8) comp.
   704 01  w-doctoken        pic x(16).
   705 01  w-template-name   pic x(48) value spaces.
   706 01  ws-res-per-thousand         pic 9(5)v9(4) value zeros comp-3.
   707 01  ws-new-mort-reserve         pic 9(9) value zeros comp-3.
   708 01  filler.
   709     05  ECS010-STATUS           PIC XX VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  14
* BSSRCH.cbl
   710     05  ECS080-STATUS           PIC XX VALUE ZEROS.
   711     05  CHKPNT-STATUS           pic xx value zeros.
   712     05  work-cert-cnt           pic x(11).
   713     05  numeric-cert-cnt        pic 9(9).
   714     05  work-mort-resv          pic x(13).
   715     05  work-mort-resv-lo       pic x(11).
   716     05  work-mort-resv-hi       pic x(11).
   717     05  numeric-mort-resv       pic 9(11).
   718     05  work-in-force           pic x(13).
   719     05  numeric-in-force        pic 9(11).
   720*****************************************
   721* symbol list for the BSDETAIL template
   722*****************************************
   723 01 output-data.
   724    05  filler                   pic x(7) value"COMPID=".
   725    05  out-comp-id              pic xxx.
   726    05  filler                   pic x(8) value"&EOMDTE=".
   727    05  out-eom-date             pic x(10).
   728    05  filler                   pic x(9) value"&COMPNME=".
   729    05  out-comp-name            pic x(30).
   730    05  filler                   pic x(7) value"&FDATE=".
   731    05  out-format-date          pic x(20).
   732    05  filler                   pic x(10) value"&LFISSPRM=".
   733    05  out-lf-iss-prem          pic zz,z99,999.99.
   734    05  filler                   pic x(10) value"&LFREFPRM=".
   735    05  out-lf-ref-prem          pic zz,z99,999.99.
   736    05  filler                   pic x(10) value"&LFNETPRM=".
   737    05  out-lf-net-prem          pic -zz,zz9,999.99.
   738    05  filler                   pic x(10) value"&AHISSPRM=".
   739    05  out-ah-iss-prem          pic zz,zz9,999.99.
   740    05  filler                   pic x(10) value"&AHREFPRM=".
   741    05  out-ah-ref-prem          pic zz,z99,999.99.
   742    05  filler                   pic x(10) value"&AHNETPRM=".
   743    05  out-ah-net-prem          pic -zz,z99,999.99.
   744    05  filler                   pic x(10) value"&LFISSCOM=".
   745    05  out-lf-iss-comm          pic zz,zz9,999.99.
   746    05  filler                   pic x(10) value"&LFREFCOM=".
   747    05  out-lf-ref-comm          pic zz,zz9,999.99.
   748    05  filler                   pic x(10) value"&LFNETCOM=".
   749    05  out-lf-net-comm          pic -zz,zz9,999.99.
   750    05  filler                   pic x(10) value"&AHISSCOM=".
   751    05  out-ah-iss-comm          pic zz,zzz,999.99.
   752    05  filler                   pic x(10) value"&AHREFCOM=".
   753    05  out-ah-ref-comm          pic zz,z99,999.99.
   754    05  filler                   pic x(10) value"&AHNETCOM=".
   755    05  out-ah-net-comm          pic -zz,z99,999.99.
   756    05  filler                   pic x(9) value "&TOTPREM=".
   757    05  out-tot-prem             pic zz,z99,999.99.
   758    05  filler                   pic x(9) value "&TOTREFS=".
   759    05  out-tot-refs             pic zz,z99,999.99.
   760    05  filler                   pic x(9) value"&TOTNETP=".
   761    05  out-tot-netp             pic -zz,z99,999.99.
   762    05  filler                   pic x(8) value"&ISSCOM=".
   763    05  out-iss-comm             pic zz,zz9,999.99.
   764    05  filler                   pic x(8) value"&REFCOM=".
   765    05  out-ref-comm             pic zz,z99,999.99.
   766    05  filler                   pic x(9) value"&TOTNCOM=".
   767    05  out-net-comm             pic -zz,z99,999.99.
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  15
* BSSRCH.cbl
   768    05  filler                   pic x(8) value "&ISSCNT=".
   769    05  out-iss-cnt              pic zzzz,z99.
   770    05  filler                   pic x(8) value "&REFCNT=".
   771    05  out-ref-cnt              pic zzzz,999.
   772    05  filler                   pic x(8) value "&NETCNT=".
   773    05  out-net-cnt              pic -zzzz,999.
   774    05  filler                   pic x(8) value"&LFCLMS=".
   775    05  out-lf-clms-pd           pic zz,z99,999.99.
   776    05  filler                   pic x(9) value"&LFVOIDS=".
   777    05  out-lf-clms-void         pic zz,zz9,999.99.
   778    05  filler                   pic x(11) value"&TOTLFCLMS=".
   779    05  out-lf-tot-clms          pic -zz,z99,999.99.
   780    05  filler                   pic x(8) value"&AHCLMS=".
   781    05  out-ah-clms-pd           pic zz,z99,999.99.
   782    05  filler                   pic x(9) value"&AHVOIDS=".
   783    05  out-ah-clms-void         pic zz,zz9,999.99.
   784    05  filler                   pic x(11) value"&TOTAHCLMS=".
   785    05  out-ah-tot-clms          pic -zz,z99,999.99.
   786    05  filler                   pic x(8) value"&PDCLMS=".
   787    05  out-clms-pd              pic zz,z99,999.99.
   788    05  filler                   pic x(8) value"&VDCLMS=".
   789    05  out-clms-void            pic zz,z99,999.99.
   790    05  filler                   pic x(9) value"&TOTCLMS=".
   791    05  out-tot-clms             pic -zz,z99,999.99.
   792    05  filler                   pic x(8) value"&LORESV=".
   793    05  out-lo-resv              pic zzz,z99,999.
   794    05  filler                   pic x(8) value"&HIRESV=".
   795    05  out-hi-resv              pic zzz,z99,999.
   796    05  filler                   pic x(8) value"&CRTCNT=".
   797    05  out-crt-cnt              pic z,zz9,999.
   798    05  filler                   pic x(5) value "&MSG=".
   799    05  output-msg               pic x(50).
   800 01 bl-index               pic s9(8) comp.
   801****************************************************************
   802*
   803* Copyright (c) 2007-2013 Dell Inc.
   804* All rights reserved.
   805*
   806****************************************************************
   807 01  DFHEIV.
   808   02  DFHEIV0               PIC X(35).
   809   02  DFHEIV1               PIC X(08).
   810   02  DFHEIV2               PIC X(08).
   811   02  DFHEIV3               PIC X(08).
   812   02  DFHEIV4               PIC X(06).
   813   02  DFHEIV5               PIC X(04).
   814   02  DFHEIV6               PIC X(04).
   815   02  DFHEIV7               PIC X(02).
   816   02  DFHEIV8               PIC X(02).
   817   02  DFHEIV9               PIC X(01).
   818   02  DFHEIV10              PIC S9(7) COMP-3.
   819   02  DFHEIV11              PIC S9(4) COMP SYNC.
   820   02  DFHEIV12              PIC S9(4) COMP SYNC.
   821   02  DFHEIV13              PIC S9(4) COMP SYNC.
   822   02  DFHEIV14              PIC S9(4) COMP SYNC.
   823   02  DFHEIV15              PIC S9(4) COMP SYNC.
   824   02  DFHEIV16              PIC S9(9) COMP SYNC.
   825   02  DFHEIV17              PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  16
* BSSRCH.cbl
   826   02  DFHEIV18              PIC X(04).
   827   02  DFHEIV19              PIC X(04).
   828   02  DFHEIV20              USAGE IS POINTER.
   829   02  DFHEIV21              USAGE IS POINTER.
   830   02  DFHEIV22              USAGE IS POINTER.
   831   02  DFHEIV23              USAGE IS POINTER.
   832   02  DFHEIV24              USAGE IS POINTER.
   833   02  DFHEIV25              PIC S9(9) COMP SYNC.
   834   02  DFHEIV26              PIC S9(9) COMP SYNC.
   835   02  DFHEIV27              PIC S9(9) COMP SYNC.
   836   02  DFHEIV28              PIC S9(9) COMP SYNC.
   837   02  DFHEIV29              PIC S9(9) COMP SYNC.
   838   02  DFHEIV30              PIC S9(9) COMP SYNC.
   839   02  DFHEIV31              PIC S9(9) COMP SYNC.
   840   02  DFHEIV32              PIC S9(4) COMP SYNC.
   841   02  DFHEIV33              PIC S9(4) COMP SYNC.
   842   02  DFHEIV34              PIC S9(4) COMP SYNC.
   843   02  DFHEIV35              PIC S9(4) COMP SYNC.
   844   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   845   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   846   02  FILLER                PIC X(02).
   847   02  DFHEIV99              PIC X(08) VALUE SPACE.
   848   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   849   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   850   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   851   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   852   02  DFHEIVL4              PIC X(255) VALUE SPACE.
   853   02  DFHEIVL5              PIC X(255) VALUE SPACE.
   854 LINKAGE  SECTION.
   855*****************************************************************
   856*                                                               *
   857* Copyright (c) 2007-2013 Dell Inc.                             *
   858* All rights reserved.                                          *
   859*                                                               *
   860*****************************************************************
   861 01  dfheiblk.
   862     02  eibtime          pic s9(7) comp-3.
   863     02  eibdate          pic s9(7) comp-3.
   864     02  eibtrnid         pic x(4).
   865     02  eibtaskn         pic s9(7) comp-3.
   866     02  eibtrmid         pic x(4).
   867     02  dfheigdi         pic s9(4) comp.
   868     02  eibcposn         pic s9(4) comp.
   869     02  eibcalen         pic s9(4) comp.
   870     02  eibaid           pic x(1).
   871     02  eibfiller1       pic x(1).
   872     02  eibfn            pic x(2).
   873     02  eibfiller2       pic x(2).
   874     02  eibrcode         pic x(6).
   875     02  eibfiller3       pic x(2).
   876     02  eibds            pic x(8).
   877     02  eibreqid         pic x(8).
   878     02  eibrsrce         pic x(8).
   879     02  eibsync          pic x(1).
   880     02  eibfree          pic x(1).
   881     02  eibrecv          pic x(1).
   882     02  eibsend          pic x(1).
   883     02  eibatt           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  17
* BSSRCH.cbl
   884     02  eibeoc           pic x(1).
   885     02  eibfmh           pic x(1).
   886     02  eibcompl         pic x(1).
   887     02  eibsig           pic x(1).
   888     02  eibconf          pic x(1).
   889     02  eiberr           pic x(1).
   890     02  eibrldbk         pic x(1).
   891     02  eiberrcd         pic x(4).
   892     02  eibsynrb         pic x(1).
   893     02  eibnodat         pic x(1).
   894     02  eibfiller5       pic x(2).
   895     02  eibresp          pic s9(8) comp.
   896     02  eibresp2         pic s9(8) comp.
   897     02  dfheigdj         pic s9(4) comp.
   898     02  dfheigdk         pic s9(4) comp.
   899 01  DFHCOMMAREA       PIC X(01).
   900 01  var                         pic x(30).
   901 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
   902 0000-DFHEXIT SECTION.
   903     MOVE '9#                    $   ' TO DFHEIV0.
   904     MOVE 'BSSRCH' TO DFHEIV1.
   905     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   906     set P to address of KIXSYS
   907     CALL "getenv" using by value P returning var-ptr
   908     if var-ptr = null then
   909        display ' kixsys not set '
   910     else
   911        set address of var to var-ptr
   912        move 0 to env-var-len
   913        inspect var tallying env-var-len
   914          for characters before X'00'
   915        unstring var (1:env-var-len) delimited by '/'
   916           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
   917              WS-KIX-SYS
   918        end-unstring
   919     end-if
   920     display ' ws-kixsys ' ws-kixsys
   921     display ' my env    ' ws-kix-myenv
   922     .
   923 0000-begin.
   924     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
   925
   926* exec cics web
   927*       startbr formfield resp(w-resp)
   928*    end-exec
   929*    MOVE 'X(f                   &  N#00000921' TO DFHEIV0
   930     MOVE X'582866202020202020202020' TO DFHEIV0(1:12)
   931     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   932     MOVE X'204E233030303030393231' TO DFHEIV0(25:11)
   933     CALL 'kxdfhei1' USING DFHEIV0,
   934           DFHEIV99,
   935           DFHEIV99,
   936           DFHEIV99,
   937           DFHEIV99,
   938           DFHEIV99
   939     MOVE EIBRESP  TO w-resp
   940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   941     perform 0200-read-form      thru 0200-exit until
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  18
* BSSRCH.cbl
   942        w-resp not = 0
   943*   dfhresp(normal)
   944
   945* exec cics web
   946*       endbr formfield
   947*    end-exec
   948*    MOVE 'X,f                   #   #00000926' TO DFHEIV0
   949     MOVE X'582C66202020202020202020' TO DFHEIV0(1:12)
   950     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
   951     MOVE X'2020233030303030393236' TO DFHEIV0(25:11)
   952     CALL 'kxdfhei1' USING DFHEIV0,
   953           DFHEIV99,
   954           DFHEIV99
   955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   956     display ' input date   ' bl-input-eom-date
   957     display ' comp id      ' bl-input-comp-id
   958     display ' mort resv lo ' work-mort-resv-lo
   959     display ' mort resv hi ' work-mort-resv-hi
   960     display ' build file   ' bl-input-bld-file
   961     evaluate bl-input-comp-id
   962        when 'CID'
   963           move 'cilgm15'        to ws-ecs010-jobname
   964           move 'cilgm17'        to ws-ecs080-jobname
   965        when 'AHL'
   966           move 'ahlgm15'        to ws-ecs010-jobname
   967           move 'ahlgm17'        to ws-ecs080-jobname
   968        when 'DCC'
   969           move 'cidclgm15'      to ws-ecs010-jobname
   970        when 'VPP'
   971           move 'vplgm15'        to ws-ecs010-jobname
   972     end-evaluate
   973     move bl-input-comp-id       to ws-work-comp-id
   974     move ws-kix-myenv           to ws-work-env
   975     if ws-kix-myenv = 'cid1p'
   976        move '/data/seqfiles/'   to ws-seqfiles-dir
   977        move ' cd /apps/prod/cid1p/jcl'
   978                                 to tran-data-line1
   979     else
   980        string
   981           '/data/test/'  delimited by size
   982           ws-work-env    delimited by space
   983           '/seqfiles/'   delimited by size
   984              into ws-seqfiles-dir
   985        end-string
   986        string
   987           ' cd /apps/test/'  delimited by size
   988           ws-work-env        delimited by space
   989           '/jcl'             delimited by size
   990              into tran-data-line1
   991        end-string
   992     end-if
   993     move spaces to tran-data-line2
   994     string
   995         'unikixjob '     delimited by size
   996         function lower-case(bl-input-comp-id) delimited by size
   997         'chkpts -k '     delimited by size
   998         ws-work-env      delimited by space
   999            into tran-data-line2
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  19
* BSSRCH.cbl
  1000      end-string
  1001
  1002     string
  1003        ws-seqfiles-dir delimited by space
  1004        ws-ecs010-jobname delimited by space
  1005        '.ECS010.ME50.BAL.AMTS' delimited by size
  1006           into ws-ecs010-in
  1007     end-string
  1008     string
  1009        ws-seqfiles-dir delimited by space
  1010        ws-ecs080-jobname delimited by space
  1011        '.ECS080.ME.BAL.AMTS' delimited by size
  1012           into ws-ecs080-in
  1013     end-string
  1014     string
  1015        ws-seqfiles-dir delimited by space
  1016        function lower-case(bl-input-comp-id) delimited by size
  1017        'mechkpts.txt' delimited by size
  1018           into ws-checkpoint-out
  1019     end-string
  1020     open input ecs010-in
  1021     if ecs010-status not = '00'
  1022        move ' cant open ecs010 file '
  1023                                 to bl-output-message
  1024        go to 0100-send-document
  1025     end-if
  1026     read ecs010-in into ws-ecs010-in-rec
  1027     move ecs010-cert-cnt        to work-cert-cnt
  1028     close ecs010-in
  1029     if bl-input-comp-id = 'CID' or 'AHL'
  1030        open input ecs080-in
  1031        if ecs080-status not = '00'
  1032           move ' cant open ecs080 file '
  1033                                 to bl-output-message
  1034           go to 0100-send-document
  1035        end-if
  1036        read ecs080-in into ws-ecs080-in-rec
  1037        move ecs080-mort-resv       to work-mort-resv
  1038        if bl-input-comp-id = 'CID'
  1039           read ecs080-in into ws-ecs080-in-rec
  1040           move ecs080-mort-resv    to work-in-force
  1041        end-if
  1042        close ecs080-in
  1043     end-if
  1044     move zeros                  to numeric-cert-cnt
  1045     inspect work-cert-cnt replacing all spaces by zeros
  1046     move +9 to s2
  1047     perform varying s1 from +11 by -1 until s1 < +1
  1048        if work-cert-cnt (s1:1) numeric
  1049           move work-cert-cnt (s1:1)
  1050                                 to numeric-cert-cnt (s2:1)
  1051           subtract +1 from s2
  1052        end-if
  1053     end-perform
  1054     move numeric-cert-cnt       to bl-out-cm-cnt
  1055     if bl-input-comp-id = 'CID'
  1056        move zeros               to numeric-mort-resv
  1057        inspect work-mort-resv replacing all spaces by zeros
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  20
* BSSRCH.cbl
  1058        display ' work mort reserve  **' work-mort-resv '**'
  1059        move +11 to s2
  1060        perform varying s1 from +13 by -1 until s1 < +1
  1061           if work-mort-resv (s1:1) numeric
  1062              move work-mort-resv (s1:1)
  1063                                 to numeric-mort-resv (s2:1)
  1064              subtract +1 from s2
  1065           end-if
  1066        end-perform
  1067        move zeros               to numeric-in-force
  1068        inspect work-in-force  replacing all spaces by zeros
  1069        move +11 to s2
  1070        perform varying s1 from +13 by -1 until s1 < +1
  1071           if work-in-force  (s1:1) numeric
  1072              move work-in-force  (s1:1)
  1073                                 to numeric-in-force (s2:1)
  1074              subtract +1 from s2
  1075           end-if
  1076        end-perform
  1077     else
  1078        if bl-input-comp-id = 'AHL'
  1079           move zeros            to numeric-mort-resv
  1080           inspect work-mort-resv replacing all spaces by zeros
  1081           move +11 to s2
  1082           perform varying s1 from +13 by -1 until s1 < +1
  1083              if work-mort-resv (s1:1) numeric
  1084                 move work-mort-resv (s1:1)
  1085                                 to numeric-mort-resv (s2:1)
  1086                 subtract +1 from s2
  1087              end-if
  1088           end-perform
  1089           move numeric-mort-resv to bl-input-hi-resv
  1090           if bl-input-hi-resv < 100000
  1091              move zeros         to bl-input-lo-resv
  1092           else
  1093              compute bl-input-lo-resv =
  1094                  bl-input-hi-resv - 100000
  1095           end-if
  1096        else
  1097           move zeros            to numeric-mort-resv
  1098****       inspect work-mort-resv replacing all spaces by zeros
  1099           move +9 to s2
  1100           perform varying s1 from +11 by -1 until s1 < +1
  1101              if work-mort-resv-lo (s1:1) numeric
  1102                 move work-mort-resv-lo (s1:1)
  1103                                 to numeric-mort-resv (s2:1)
  1104                 subtract +1 from s2
  1105              end-if
  1106           end-perform
  1107           move numeric-mort-resv to bl-input-lo-resv
  1108           move zeros            to numeric-mort-resv
  1109****       inspect work-mort-resv replacing all spaces by zeros
  1110           move +9 to s2
  1111           perform varying s1 from +11 by -1 until s1 < +1
  1112              if work-mort-resv-hi (s1:1) numeric
  1113                 move work-mort-resv-hi (s1:1)
  1114                                 to numeric-mort-resv (s2:1)
  1115                 subtract +1 from s2
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  21
* BSSRCH.cbl
  1116              end-if
  1117           end-perform
  1118           move numeric-mort-resv to bl-input-hi-resv
  1119        end-if
  1120     end-if
  1121     if bl-input-comp-id = 'CID'
  1122
  1123* exec cics link
  1124*          program  ('BSRAMTBL')
  1125*          commarea (srch-commarea)
  1126*       end-exec
  1127     MOVE LENGTH OF
  1128      srch-commarea
  1129       TO DFHEIV11
  1130     MOVE 'BSRAMTBL' TO DFHEIV1
  1131*    MOVE '."C                   (   #00001095' TO DFHEIV0
  1132     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1133     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1134     MOVE X'2020233030303031303935' TO DFHEIV0(25:11)
  1135     CALL 'kxdfhei1' USING DFHEIV0,
  1136           DFHEIV1,
  1137           srch-commarea,
  1138           DFHEIV11,
  1139           DFHEIV99,
  1140           DFHEIV99,
  1141           DFHEIV99,
  1142           DFHEIV99
  1143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1144     end-if
  1145     DISPLAY ' REM AMOUNT ' BL-tot-inforce
  1146     if bl-input-comp-id = 'CID'
  1147        compute ws-res-per-thousand = numeric-mort-resv /
  1148           (numeric-in-force / 1000)
  1149        compute ws-new-mort-reserve =
  1150           ws-res-per-thousand * (bl-tot-inforce / 1000)
  1151        compute bl-input-lo-resv = ws-new-mort-reserve * .95
  1152        compute bl-input-hi-resv = ws-new-mort-reserve * 1.05
  1153     end-if
  1154
  1155* exec cics link
  1156*       program  ('BSSRCHBL')
  1157*       commarea (srch-commarea)
  1158*    end-exec
  1159     MOVE LENGTH OF
  1160      srch-commarea
  1161       TO DFHEIV11
  1162     MOVE 'BSSRCHBL' TO DFHEIV1
  1163*    MOVE '."C                   (   #00001109' TO DFHEIV0
  1164     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1165     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1166     MOVE X'2020233030303031313039' TO DFHEIV0(25:11)
  1167     CALL 'kxdfhei1' USING DFHEIV0,
  1168           DFHEIV1,
  1169           srch-commarea,
  1170           DFHEIV11,
  1171           DFHEIV99,
  1172           DFHEIV99,
  1173           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  22
* BSSRCH.cbl
  1174           DFHEIV99
  1175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1176     .
  1177 0100-send-document.
  1178***********************************************************
  1179* Build output document.
  1180***********************************************************
  1181     move bl-input-comp-id       to out-comp-id
  1182     move bl-input-eom-date      to out-eom-date
  1183     move bl-input-lo-resv       to out-lo-resv
  1184     move bl-input-hi-resv       to out-hi-resv
  1185     move bl-out-company-name    to out-comp-name
  1186     move bl-out-formated-date   to out-format-date
  1187     move bl-out-lf-prem (1)     to out-lf-iss-prem
  1188     move bl-out-ah-prem (1)     to out-ah-iss-prem
  1189     move bl-out-tot-prm (1)     to out-tot-prem
  1190     move bl-out-lf-ref  (1)     to out-lf-ref-prem
  1191     move bl-out-ah-ref  (1)     to out-ah-ref-prem
  1192     move bl-out-tot-ref (1)     to out-tot-refs
  1193     move bl-out-lf-net  (1)     to out-lf-net-prem
  1194     move bl-out-ah-net  (1)     to out-ah-net-prem
  1195     move bl-out-lf-iss-com (1)  to out-lf-iss-comm
  1196     move bl-out-ah-iss-com (1)  to out-ah-iss-comm
  1197     move bl-out-lf-ref-com (1)  to out-lf-ref-comm
  1198     move bl-out-ah-ref-com (1)  to out-ah-ref-comm
  1199     move bl-out-lf-net-com (1)  to out-lf-net-comm
  1200     move bl-out-ah-net-com (1)  to out-ah-net-comm
  1201     move bl-out-iss-com    (1)  to out-iss-comm
  1202     move bl-out-ref-com    (1)  to out-ref-comm
  1203     move bl-out-net-com    (1)  to out-net-comm
  1204     move bl-out-iss-cnt    (1)  to out-iss-cnt
  1205     move bl-out-can-cnt    (1)  to out-ref-cnt
  1206     move bl-out-net-cnt    (1)  to out-net-cnt
  1207     move bl-out-net-tot    (1)  to out-tot-netp
  1208     move bl-out-cm-cnt          to out-crt-cnt
  1209     move bl-out-lf-clms-pd      to out-lf-clms-pd
  1210     move bl-out-lf-clms-void    to out-lf-clms-void
  1211     move bl-out-lf-tot-clms     to out-lf-tot-clms
  1212     move bl-out-ah-clms-pd      to out-ah-clms-pd
  1213     move bl-out-ah-clms-void    to out-ah-clms-void
  1214     move bl-out-ah-tot-clms     to out-ah-tot-clms
  1215     move bl-out-clms-pd         to out-clms-pd
  1216     move bl-out-clms-void       to out-clms-void
  1217     move bl-out-tot-clms        to out-tot-clms
  1218     move bl-output-message      to output-msg
  1219     if bl-input-bld-file = 'YES'
  1220        move 'Balance File Created'
  1221                                 to output-msg
  1222     end-if
  1223     move 'BSDETAIL'             to w-template-name
  1224
  1225* exec cics document create
  1226*       doctoken   (w-doctoken)
  1227*       template   (w-template-name)
  1228*       template   ('BSDETAIL')
  1229*       symbollist (output-data)
  1230*       resp       (ws-response)
  1231*       resp2      (ws-response2)
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  23
* BSSRCH.cbl
  1232*       listlength (length of output-data)
  1233*    end-exec
  1234     MOVE LENGTH OF
  1235      output-data TO DFHEIV16
  1236*    MOVE '\"D tSL               )  N#00001161' TO DFHEIV0
  1237     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1238     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1239     MOVE X'204E233030303031313631' TO DFHEIV0(25:11)
  1240     CALL 'kxdfhei1' USING DFHEIV0,
  1241           w-doctoken,
  1242           DFHEIV99,
  1243           w-template-name,
  1244           output-data,
  1245           DFHEIV16,
  1246           DFHEIV99,
  1247           DFHEIV99,
  1248           DFHEIV99
  1249     MOVE EIBRESP  TO ws-response
  1250     MOVE EIBRESP2 TO ws-response2
  1251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1252*    display ' af doc create ' ws-response ' ' ws-response2
  1253     move 1                      to bl-index
  1254*    exec cics document insert
  1255*       doctoken (w-doctoken)
  1256*       template ('BSFTR')
  1257*    end-exec
  1258    if bl-fail
  1259
  1260* exec cics syncpoint rollback
  1261*      end-exec
  1262*    MOVE '6"R                   !   #00001177' TO DFHEIV0
  1263     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  1264     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1265     MOVE X'2020233030303031313737' TO DFHEIV0(25:11)
  1266     CALL 'kxdfhei1' USING DFHEIV0
  1267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1268    end-if
  1269****************************************
  1270* Send the document and return.
  1271****************************************
  1272
  1273* exec cics web send
  1274*       doctoken(w-doctoken)
  1275*    end-exec
  1276*    MOVE 'X$D                   *   #00001183' TO DFHEIV0
  1277     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  1278     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  1279     MOVE X'2020233030303031313833' TO DFHEIV0(25:11)
  1280     CALL 'kxdfhei1' USING DFHEIV0,
  1281           w-doctoken,
  1282           DFHEIV99,
  1283           DFHEIV99,
  1284           DFHEIV99,
  1285           DFHEIV99,
  1286           DFHEIV99,
  1287           DFHEIV99,
  1288           DFHEIV99,
  1289           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  24
* BSSRCH.cbl
  1290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1291     if bl-input-bld-file = 'YES'
  1292        evaluate bl-input-comp-id
  1293           when 'AHL'
  1294              move ahl-table     to cid-table
  1295              perform 0300-build-cid
  1296                                 thru 0300-exit
  1297              perform 0400-write-ahl
  1298                                 thru 0400-exit
  1299           when 'CID'
  1300              perform 0300-build-cid
  1301                                 thru 0300-exit
  1302              perform 0500-write-cid
  1303                                 thru 0500-exit
  1304           when 'DCC'
  1305              move dcc-table     to cid-table
  1306              perform 0300-build-cid
  1307                                 thru 0300-exit
  1308              perform 0600-write-dcc
  1309                                 thru 0600-exit
  1310           when 'VPP'
  1311              move VPP-table     to cid-table
  1312              perform 0300-build-cid
  1313                                 thru 0300-exit
  1314              perform 0650-write-vpp
  1315                                 thru 0650-exit
  1316        end-evaluate
  1317     end-if
  1318
  1319* exec cics return
  1320*    end-exec
  1321*    MOVE '.(                    ''   #00001213' TO DFHEIV0
  1322     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1323     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1324     MOVE X'2020233030303031323133' TO DFHEIV0(25:11)
  1325     CALL 'kxdfhei1' USING DFHEIV0,
  1326           DFHEIV99,
  1327           DFHEIV99,
  1328           DFHEIV99,
  1329           DFHEIV99,
  1330           DFHEIV99,
  1331           DFHEIV99
  1332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1333     .
  1334 0200-read-form.
  1335     move spaces                 to w-form-name
  1336     move length of w-form-name  to w-form-name-len
  1337     move spaces                 to w-form-value
  1338     move length of w-form-value to w-form-value-len
  1339
  1340* exec cics web readnext
  1341*       formfield   (w-form-name)
  1342*       namelength  (w-form-name-len)
  1343*       value       (w-form-value)
  1344*       valuelength (w-form-value-len)
  1345*       resp        (w-resp)
  1346*    end-exec
  1347*    MOVE 'X*FLVL                &  N#00001221' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  25
* BSSRCH.cbl
  1348     MOVE X'582A464C564C202020202020' TO DFHEIV0(1:12)
  1349     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1350     MOVE X'204E233030303031323231' TO DFHEIV0(25:11)
  1351     CALL 'kxdfhei1' USING DFHEIV0,
  1352           w-form-name,
  1353           w-form-name-len,
  1354           w-form-value,
  1355           w-form-value-len,
  1356           DFHEIV99
  1357     MOVE EIBRESP  TO w-resp
  1358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1359     evaluate w-resp
  1360        when 0
  1361*   dfhresp(normal)
  1362           evaluate w-form-name(1:w-form-name-len)
  1363              when 'eom_dte'
  1364                 if w-form-value-len not = 0
  1365                    move w-form-value(1:w-form-value-len)
  1366                                 to bl-input-eom-date
  1367                 else
  1368                    move spaces  to bl-input-eom-date
  1369                end-if
  1370              when 'comp_id'
  1371                 if w-form-value-len not = 0
  1372                    move w-form-value(1:w-form-value-len)
  1373                                 to bl-input-comp-id
  1374                 else
  1375                    move spaces  to bl-input-comp-id
  1376                end-if
  1377              when 'lo_resv'
  1378                 if w-form-value-len not = 0
  1379                    move w-form-value(1:w-form-value-len)
  1380                                 to work-mort-resv-lo
  1381                 else
  1382                    move zeros   to work-mort-resv-lo
  1383                end-if
  1384              when 'hi_resv'
  1385                 if w-form-value-len not = 0
  1386                    move w-form-value(1:w-form-value-len)
  1387                                 to work-mort-resv-hi
  1388                 else
  1389                    move zeros   to work-mort-resv-hi
  1390                end-if
  1391              when 'bld_file'
  1392                 if w-form-value-len not = 0
  1393                    move w-form-value(1:w-form-value-len)
  1394                                 to bl-input-bld-file
  1395                 else
  1396                    move spaces  to bl-input-bld-file
  1397                end-if
  1398           end-evaluate
  1399        when other
  1400           continue
  1401     end-evaluate
  1402     .
  1403 0200-exit.
  1404     exit.
  1405 0300-build-cid.
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  26
* BSSRCH.cbl
  1406     move +.98                   to ws-low-pct
  1407     move +1.02                  to ws-high-pct
  1408     perform varying s1 from +1 by +1 until s1 > +17
  1409        move -999999999          to tbl-low-amount (s1)
  1410        move +999999999          to tbl-hi-amount  (s1)
  1411     end-perform
  1412     move bl-out-tot-clms        to ws-pass-amount
  1413     perform 0310-calc-tol       thru 0310-exit
  1414     move ws-low-amount          to tbl-low-amount (1)
  1415     move ws-hi-amount           to tbl-hi-amount (1)
  1416*** processable gross premium
  1417     move bl-out-tot-prm (1)     to ws-pass-amount
  1418     perform 0310-calc-tol       thru 0310-exit
  1419     move ws-low-amount          to tbl-low-amount (2)
  1420     move ws-hi-amount           to tbl-hi-amount (2)
  1421*** non-processable gross premium
  1422     move +.90                   to ws-low-pct
  1423     move +1.10                  to ws-high-pct
  1424     move bl-out-tot-prm (2)     to ws-pass-amount
  1425     perform 0310-calc-tol       thru 0310-exit
  1426     move ws-low-amount          to tbl-low-amount (3)
  1427     move ws-hi-amount           to tbl-hi-amount (3)
  1428*** total gross premium
  1429     move +.98                   to ws-low-pct
  1430     move +1.02                  to ws-high-pct
  1431     compute tbl-low-amount (4) =
  1432        tbl-low-amount (2) + tbl-low-amount (3)
  1433     compute tbl-hi-amount (4) =
  1434        tbl-hi-amount (2) + tbl-hi-amount (3)
  1435*** processable refunded premium
  1436     move bl-out-tot-ref (1)     to ws-pass-amount
  1437     perform 0310-calc-tol       thru 0310-exit
  1438     move ws-low-amount          to tbl-low-amount (5)
  1439     move ws-hi-amount           to tbl-hi-amount (5)
  1440*** non-processable refunded premium
  1441     move +.60                   to ws-low-pct
  1442     move +1.40                  to ws-high-pct
  1443     move bl-out-tot-ref (2)     to ws-pass-amount
  1444     perform 0310-calc-tol       thru 0310-exit
  1445     if (ws-pass-amount - ws-low-amount) < 5000
  1446        compute ws-low-amount = ws-low-amount - 5000
  1447        compute ws-hi-amount = ws-hi-amount + 5000
  1448     end-if
  1449     move ws-low-amount          to tbl-low-amount (6)
  1450     move ws-hi-amount           to tbl-hi-amount (6)
  1451*** total refunded premium
  1452     move +.98                   to ws-low-pct
  1453     move +1.02                  to ws-high-pct
  1454     compute tbl-low-amount (7) =
  1455        tbl-low-amount (5) + tbl-low-amount (6)
  1456     compute tbl-hi-amount (7) =
  1457        tbl-hi-amount (5) + tbl-hi-amount (6)
  1458*** processable net premium
  1459     move bl-out-net-tot (1)     to ws-pass-amount
  1460     perform 0310-calc-tol       thru 0310-exit
  1461     move ws-low-amount          to tbl-low-amount (8)
  1462     move ws-hi-amount           to tbl-hi-amount (8)
  1463*** non-processable net premium
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  27
* BSSRCH.cbl
  1464     move +.90                   to ws-low-pct
  1465     move +1.10                  to ws-high-pct
  1466     move bl-out-net-tot (2)     to ws-pass-amount
  1467     perform 0310-calc-tol       thru 0310-exit
  1468     move ws-low-amount          to tbl-low-amount (9)
  1469     move ws-hi-amount           to tbl-hi-amount (9)
  1470*** total net premium
  1471     move +.98                   to ws-low-pct
  1472     move +1.02                  to ws-high-pct
  1473     compute tbl-low-amount (10) =
  1474        tbl-low-amount (8) + tbl-low-amount (9)
  1475     compute tbl-hi-amount (10) =
  1476        tbl-hi-amount (8) + tbl-hi-amount (9)
  1477*** processable commission
  1478     move bl-out-net-com (1)     to ws-pass-amount
  1479     perform 0310-calc-tol       thru 0310-exit
  1480     move ws-low-amount          to tbl-low-amount (11)
  1481     move ws-hi-amount           to tbl-hi-amount (11)
  1482*** non-processable commission
  1483     move +.90                   to ws-low-pct
  1484     move +1.10                  to ws-high-pct
  1485     move bl-out-net-com (2)     to ws-pass-amount
  1486     perform 0310-calc-tol       thru 0310-exit
  1487     move ws-low-amount          to tbl-low-amount (12)
  1488     move ws-hi-amount           to tbl-hi-amount (12)
  1489*** total commission
  1490     move +.98                   to ws-low-pct
  1491     move +1.02                  to ws-high-pct
  1492     compute tbl-low-amount (13) =
  1493        tbl-low-amount (11) + tbl-low-amount (12)
  1494     compute tbl-hi-amount (13) =
  1495        tbl-hi-amount (11) + tbl-hi-amount (12)
  1496     move bl-out-lf-tot-clms     to ws-pass-amount
  1497     perform 0310-calc-tol       thru 0310-exit
  1498     move ws-low-amount          to tbl-low-amount (14)
  1499     move ws-hi-amount           to tbl-hi-amount (14)
  1500     move bl-out-ah-tot-clms     to ws-pass-amount
  1501     perform 0310-calc-tol       thru 0310-exit
  1502     move ws-low-amount          to tbl-low-amount (15)
  1503     move ws-hi-amount           to tbl-hi-amount (15)
  1504     move bl-out-cm-cnt          to tbl-low-amount (16)
  1505                                    tbl-hi-amount  (16)
  1506     move bl-input-lo-resv       to tbl-low-amount (17)
  1507     move bl-input-hi-resv       to tbl-hi-amount (17)
  1508     .
  1509 0300-exit.
  1510     exit.
  1511 0310-calc-tol.
  1512     if ws-pass-amount > zeros
  1513        compute ws-low-amount = ws-pass-amount * ws-low-pct
  1514        compute ws-hi-amount  = ws-pass-amount * ws-high-pct
  1515     else
  1516        compute ws-low-amount = ws-pass-amount * ws-high-pct
  1517        compute ws-hi-amount  = ws-pass-amount * ws-low-pct
  1518     end-if
  1519     .
  1520 0310-exit.
  1521     exit.
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  28
* BSSRCH.cbl
  1522 0400-write-ahl.
  1523     open output chkpoint-out
  1524     if chkpnt-status not = '00'
  1525        move ' Cant open AHL CHKPNT file '
  1526           to bl-output-message
  1527        go to 0100-send-document
  1528     end-if
  1529     move bl-input-eom-date      to cpo-jobname
  1530     move 'AHL'                  to cpo-stepname
  1531     string ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  1532        ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  1533        delimited by size into cpo-desc
  1534     end-string
  1535     write chkpoint-out-rec  from cpo-out-record
  1536     move spaces                 to cpo-jobname
  1537                                    cpo-stepname
  1538     move 'Proc Cnt'             to cpo-desc
  1539     move bl-out-iss-cnt (1)     to cpo-low-amount
  1540     move bl-out-can-cnt (1)     to cpo-hi-amount
  1541     write chkpoint-out-rec  from cpo-out-record
  1542     move 'NonProcCnt'           to cpo-desc
  1543     move bl-out-iss-cnt (2)     to cpo-low-amount
  1544     move bl-out-can-cnt (2)     to cpo-hi-amount
  1545     write chkpoint-out-rec  from cpo-out-record
  1546     move 'Total Cnt'            to cpo-desc
  1547     move bl-out-iss-cnt (3)     to cpo-low-amount
  1548     move bl-out-can-cnt (3)     to cpo-hi-amount
  1549     write chkpoint-out-rec  from cpo-out-record
  1550     move bl-out-lf-clms-cur     to ws-pass-amount
  1551     perform 0310-calc-tol       thru 0310-exit
  1552     move 'LF Claims Paid Curr'  to cpo-desc
  1553     move ws-low-amount          to cpo-low-amount
  1554     move ws-hi-amount           to cpo-hi-amount
  1555     write chkpoint-out-rec  from cpo-out-record
  1556     move bl-out-ah-clms-cur     to ws-pass-amount
  1557     perform 0310-calc-tol       thru 0310-exit
  1558     move 'AH Claims Paid Curr'  to cpo-desc
  1559     move ws-low-amount          to cpo-low-amount
  1560     move ws-hi-amount           to cpo-hi-amount
  1561     write chkpoint-out-rec  from cpo-out-record
  1562     move bl-out-tot-clms-cur    to ws-pass-amount
  1563     perform 0310-calc-tol       thru 0310-exit
  1564     move 'TOT Claims Paid Curr' to cpo-desc
  1565     move ws-low-amount          to cpo-low-amount
  1566     move ws-hi-amount           to cpo-hi-amount
  1567     write chkpoint-out-rec  from cpo-out-record
  1568     perform varying s1 from 1 by 1 until s1 > 17
  1569        move tbl-jobname    (s1) to cpo-jobname
  1570        move tbl-stepname   (s1) to cpo-stepname
  1571        move tbl-desc       (s1) to cpo-desc
  1572        move tbl-low-amount (s1) to cpo-low-amount
  1573        move tbl-hi-amount  (s1) to cpo-hi-amount
  1574        write chkpoint-out-rec from cpo-out-record
  1575     end-perform
  1576     close chkpoint-out
  1577     perform 0700-submit-job     thru 0700-exit
  1578     .
  1579 0400-exit.
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  29
* BSSRCH.cbl
  1580     exit.
  1581 0500-write-cid.
  1582     open output chkpoint-out
  1583     if chkpnt-status not = '00'
  1584        move ' Cant open CID CHKPNT file '
  1585           to bl-output-message
  1586        go to 0100-send-document
  1587     end-if
  1588     move bl-input-eom-date      to cpo-jobname
  1589     move 'CID'                  to cpo-stepname
  1590     string ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  1591        ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  1592        delimited by size into cpo-desc
  1593     end-string
  1594     write chkpoint-out-rec  from cpo-out-record
  1595     move spaces                 to cpo-jobname
  1596                                    cpo-stepname
  1597     move 'Proc Cnt'             to cpo-desc
  1598     move bl-out-iss-cnt (1)     to cpo-low-amount
  1599     move bl-out-can-cnt (1)     to cpo-hi-amount
  1600     write chkpoint-out-rec  from cpo-out-record
  1601     move 'NonProcCnt'           to cpo-desc
  1602     move bl-out-iss-cnt (2)     to cpo-low-amount
  1603     move bl-out-can-cnt (2)     to cpo-hi-amount
  1604     write chkpoint-out-rec  from cpo-out-record
  1605     move 'Total Cnt'            to cpo-desc
  1606     move bl-out-iss-cnt (3)     to cpo-low-amount
  1607     move bl-out-can-cnt (3)     to cpo-hi-amount
  1608     write chkpoint-out-rec  from cpo-out-record
  1609     move bl-out-lf-clms-cur     to ws-pass-amount
  1610     perform 0310-calc-tol       thru 0310-exit
  1611     move 'LF Claims Paid Curr'  to cpo-desc
  1612     move ws-low-amount          to cpo-low-amount
  1613     move ws-hi-amount           to cpo-hi-amount
  1614     write chkpoint-out-rec  from cpo-out-record
  1615     move bl-out-ah-clms-cur     to ws-pass-amount
  1616     perform 0310-calc-tol       thru 0310-exit
  1617     move 'AH Claims Paid Curr'  to cpo-desc
  1618     move ws-low-amount          to cpo-low-amount
  1619     move ws-hi-amount           to cpo-hi-amount
  1620     write chkpoint-out-rec  from cpo-out-record
  1621     move bl-out-tot-clms-cur    to ws-pass-amount
  1622     perform 0310-calc-tol       thru 0310-exit
  1623     move 'TOT Claims Paid Curr' to cpo-desc
  1624     move ws-low-amount          to cpo-low-amount
  1625     move ws-hi-amount           to cpo-hi-amount
  1626     write chkpoint-out-rec  from cpo-out-record
  1627     perform varying s1 from 1 by 1 until s1 > 17
  1628        move tbl-jobname    (s1) to cpo-jobname
  1629        move tbl-stepname   (s1) to cpo-stepname
  1630        move tbl-desc       (s1) to cpo-desc
  1631        move tbl-low-amount (s1) to cpo-low-amount
  1632        move tbl-hi-amount  (s1) to cpo-hi-amount
  1633        write chkpoint-out-rec   from cpo-out-record
  1634     end-perform
  1635     close chkpoint-out
  1636     perform 0700-submit-job     thru 0700-exit
  1637     .
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  30
* BSSRCH.cbl
  1638 0500-exit.
  1639     exit.
  1640 0600-write-dcc.
  1641     open output chkpoint-out
  1642     if chkpnt-status not = '00'
  1643        move ' Cant open DCC CHKPNT file '
  1644           to bl-output-message
  1645        go to 0100-send-document
  1646     end-if
  1647     move bl-input-eom-date      to cpo-jobname
  1648     move 'DCC'                  to cpo-stepname
  1649     string ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  1650        ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  1651        delimited by size into cpo-desc
  1652     end-string
  1653     write chkpoint-out-rec  from cpo-out-record
  1654     move spaces                 to cpo-jobname
  1655                                    cpo-stepname
  1656     move 'Proc Cnt'             to cpo-desc
  1657     move bl-out-iss-cnt (1)     to cpo-low-amount
  1658     move bl-out-can-cnt (1)     to cpo-hi-amount
  1659     write chkpoint-out-rec  from cpo-out-record
  1660     move 'NonProcCnt'           to cpo-desc
  1661     move bl-out-iss-cnt (2)     to cpo-low-amount
  1662     move bl-out-can-cnt (2)     to cpo-hi-amount
  1663     write chkpoint-out-rec  from cpo-out-record
  1664     move 'Total Cnt'            to cpo-desc
  1665     move bl-out-iss-cnt (3)     to cpo-low-amount
  1666     move bl-out-can-cnt (3)     to cpo-hi-amount
  1667     write chkpoint-out-rec  from cpo-out-record
  1668     move bl-out-lf-clms-cur     to ws-pass-amount
  1669     perform 0310-calc-tol       thru 0310-exit
  1670     move 'LF Claims Paid Curr'  to cpo-desc
  1671     move ws-low-amount          to cpo-low-amount
  1672     move ws-hi-amount           to cpo-hi-amount
  1673     write chkpoint-out-rec  from cpo-out-record
  1674     move bl-out-ah-clms-cur     to ws-pass-amount
  1675     perform 0310-calc-tol       thru 0310-exit
  1676     move 'AH Claims Paid Curr'  to cpo-desc
  1677     move ws-low-amount          to cpo-low-amount
  1678     move ws-hi-amount           to cpo-hi-amount
  1679     write chkpoint-out-rec  from cpo-out-record
  1680     move bl-out-tot-clms-cur    to ws-pass-amount
  1681     perform 0310-calc-tol       thru 0310-exit
  1682     move 'TOT Claims Paid Curr' to cpo-desc
  1683     move ws-low-amount          to cpo-low-amount
  1684     move ws-hi-amount           to cpo-hi-amount
  1685     write chkpoint-out-rec  from cpo-out-record
  1686     perform varying s1 from 1 by 1 until s1 > 16
  1687        move tbl-jobname    (s1) to cpo-jobname
  1688        move tbl-stepname   (s1) to cpo-stepname
  1689        move tbl-desc       (s1) to cpo-desc
  1690        move tbl-low-amount (s1) to cpo-low-amount
  1691        move tbl-hi-amount  (s1) to cpo-hi-amount
  1692        write chkpoint-out-rec from cpo-out-record
  1693     end-perform
  1694     close chkpoint-out
  1695     perform 0700-submit-job     thru 0700-exit
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  31
* BSSRCH.cbl
  1696     .
  1697 0600-exit.
  1698     exit.
  1699 0650-write-vpp.
  1700
  1701     open output chkpoint-out
  1702
  1703     if chkpnt-status not = '00'
  1704        move ' Cant open vpp CHKPNT file '
  1705           to bl-output-message
  1706        go to 0100-send-document
  1707     end-if
  1708
  1709     move bl-input-eom-date      to cpo-jobname
  1710     move 'VPP'                  to cpo-stepname
  1711     string ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  1712        ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  1713        delimited by size into cpo-desc
  1714     end-string
  1715     write chkpoint-out-rec  from cpo-out-record
  1716
  1717     move spaces                 to cpo-jobname
  1718                                    cpo-stepname
  1719
  1720     move 'Proc Cnt'             to cpo-desc
  1721     move bl-out-iss-cnt (1)     to cpo-low-amount
  1722     move bl-out-can-cnt (1)     to cpo-hi-amount
  1723     write chkpoint-out-rec  from cpo-out-record
  1724     move 'NonProcCnt'           to cpo-desc
  1725     move bl-out-iss-cnt (2)     to cpo-low-amount
  1726     move bl-out-can-cnt (2)     to cpo-hi-amount
  1727     write chkpoint-out-rec  from cpo-out-record
  1728     move 'Total Cnt'            to cpo-desc
  1729     move bl-out-iss-cnt (3)     to cpo-low-amount
  1730     move bl-out-can-cnt (3)     to cpo-hi-amount
  1731     write chkpoint-out-rec  from cpo-out-record
  1732
  1733
  1734     move bl-out-lf-clms-cur     to ws-pass-amount
  1735     perform 0310-calc-tol       thru 0310-exit
  1736     move 'LF Claims Paid Curr'  to cpo-desc
  1737     move ws-low-amount          to cpo-low-amount
  1738     move ws-hi-amount           to cpo-hi-amount
  1739     write chkpoint-out-rec  from cpo-out-record
  1740
  1741     move bl-out-ah-clms-cur     to ws-pass-amount
  1742     perform 0310-calc-tol       thru 0310-exit
  1743     move 'AH Claims Paid Curr'  to cpo-desc
  1744     move ws-low-amount          to cpo-low-amount
  1745     move ws-hi-amount           to cpo-hi-amount
  1746     write chkpoint-out-rec  from cpo-out-record
  1747
  1748     move bl-out-tot-clms-cur    to ws-pass-amount
  1749     perform 0310-calc-tol       thru 0310-exit
  1750     move 'TOT Claims Paid Curr' to cpo-desc
  1751     move ws-low-amount          to cpo-low-amount
  1752     move ws-hi-amount           to cpo-hi-amount
  1753     write chkpoint-out-rec  from cpo-out-record
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  32
* BSSRCH.cbl
  1754
  1755     perform varying s1 from 1 by 1 until s1 > 16
  1756        move tbl-jobname    (s1) to cpo-jobname
  1757        move tbl-stepname   (s1) to cpo-stepname
  1758        move tbl-desc       (s1) to cpo-desc
  1759        move tbl-low-amount (s1) to cpo-low-amount
  1760        move tbl-hi-amount  (s1) to cpo-hi-amount
  1761        write chkpoint-out-rec from cpo-out-record
  1762     end-perform
  1763
  1764     close chkpoint-out
  1765
  1766     perform 0700-submit-job     thru 0700-exit
  1767
  1768     .
  1769 0650-exit.
  1770     exit.
  1771 0700-submit-job.
  1772     move function lower-case(bl-input-comp-id)
  1773                                 to tran-comp-id
  1774
  1775* EXEC CICS WRITEQ TD
  1776*       QUEUE ('BTCH')
  1777*       FROM (TRAN-DATA-LINE1)
  1778*       LENGTH (80)
  1779*    END-EXEC
  1780     MOVE 80
  1781       TO DFHEIV11
  1782     MOVE 'BTCH' TO DFHEIV5
  1783*    MOVE '(" L   L              &   #00001642' TO DFHEIV0
  1784     MOVE X'2822204C2020204C20202020' TO DFHEIV0(1:12)
  1785     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1786     MOVE X'2020233030303031363432' TO DFHEIV0(25:11)
  1787     CALL 'kxdfhei1' USING DFHEIV0,
  1788           DFHEIV5,
  1789           TRAN-DATA-LINE1,
  1790           DFHEIV11,
  1791           DFHEIV99,
  1792           DFHEIV99
  1793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1794
  1795* EXEC CICS WRITEQ TD
  1796*       QUEUE ('BTCH')
  1797*       FROM (TRAN-DATA-LINE2)
  1798*       LENGTH (80)
  1799*    END-EXEC
  1800     MOVE 80
  1801       TO DFHEIV11
  1802     MOVE 'BTCH' TO DFHEIV5
  1803*    MOVE '(" L   L              &   #00001647' TO DFHEIV0
  1804     MOVE X'2822204C2020204C20202020' TO DFHEIV0(1:12)
  1805     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1806     MOVE X'2020233030303031363437' TO DFHEIV0(25:11)
  1807     CALL 'kxdfhei1' USING DFHEIV0,
  1808           DFHEIV5,
  1809           TRAN-DATA-LINE2,
  1810           DFHEIV11,
  1811           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Nov-20 07:32 Page  33
* BSSRCH.cbl
  1812           DFHEIV99
  1813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1814     .
  1815 0700-exit.
  1816     exit.
  1817
  1818 9999-DFHBACK SECTION.
  1819     MOVE '9%                    "   ' TO DFHEIV0
  1820     MOVE 'BSSRCH' TO DFHEIV1
  1821     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1822     GOBACK.
  1823 9999-DFHEXIT.
  1824     IF DFHEIGDJ EQUAL 0001
  1825         NEXT SENTENCE.
  1826     MOVE '9%                    "   ' TO DFHEIV0
  1827     MOVE 'BSSRCH' TO DFHEIV1
  1828     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1829     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       10952     Code:       11026
