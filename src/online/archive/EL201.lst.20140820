* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page   1
* EL201.cbl
* Options: int("EL201.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL201.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL201.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL201.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2*****************************************************************
     3*                                                               *
     4* Copyright (c) 2014 by Central States Health and Life          *
     5* All rights reserved.                                          *
     6*                                                               *
     7*****************************************************************
     8 identification division.
     9 program-id. EL201.
    10*
    11*AUTHOR.    Pablo.
    12*           Colleyville, TEXAS.
    13*REMARKS.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page   2
* EL201.cbl
    14***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
    15***                                                            ***
    16***  Post check number and check written date to refund checks ***
    17***                                                            ***
    18***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    19******************************************************************
    20*                   C H A N G E   L O G
    21*
    22* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    23*-----------------------------------------------------------------
    24*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    25* EFFECTIVE    NUMBER
    26*-----------------------------------------------------------------
    27* 011714  CR2013053000001  PEMA  NEW PROGRAM
    28* 022014  IR2014022000001  PEMA  chg process when file is empty
    29 environment division.
    30 INPUT-OUTPUT SECTION.
    31 FILE-CONTROL.
    32 SELECT CPS-WRITTEN-IN ASSIGN TO dynamic ws-written-in
    33    FILE STATUS IS WRITTEN-STATUS
    34                            ORGANIZATION IS LINE SEQUENTIAL.
    35 SELECT CPS-WRITTEN-RPT ASSIGN TO dynamic ws-written-rpt
    36    FILE STATUS IS WRITRPT-STATUS
    37                            ORGANIZATION IS LINE SEQUENTIAL.
    38 data division.
    39 FILE SECTION.
    40 FD  CPS-WRITTEN-IN
    41     BLOCK CONTAINS 0
    42     RECORDING MODE F.
    43 01  CPS-WRITTEN-IN-REC          pic x(200).
    44 FD  CPS-WRITTEN-RPT
    45     BLOCK CONTAINS 0
    46     RECORDING MODE F.
    47 01  CPS-WRITTEN-RPT-REC         pic x(132).
    48 working-storage section.
    49 01  DFH-START PIC X(04).
    50 77  ws-process-sw               pic x value ' '.
    51     88  process-cashed            value 'C'.
    52     88  process-written           value 'W'.
    53 77  ws-writ-cnt                 pic 9(5) value zeros.
    54 77  ws-tot-writ-amt             pic s9(9)v99 comp-3 value +0.
    55 77  s1                          pic s999 comp-3 value +0.
    56 77  s2                          pic s999 comp-3 value +0.
    57 77  ws-bin-cashed-dt            pic xx  value low-values.
    58 77  ws-bin-check-dt             pic xx  value low-values.
    59 77  ws-page-cntr                pic 999  value zeros.
    60 77  ws-line-cntr                pic 999  value 070.
    61 77  ws-max-lines                pic 999  value 060.
    62 77  ws-erchek-sw                pic x    value spaces.
    63     88  erchek-found              value 'Y'.
    64 77  ws-table-sw                 pic x    value spaces.
    65     88  table-found               value 'Y'.
    66 77  ws-continue-sw              pic x  value 'Y'.
    67     88  ok-to-continue            value 'Y'.
    68     88  not-ok-to-continue        value 'N'.
    69 77  ws-in-recs                  pic 9(5) value zeros.
    70 77  ws-eof-sw                   pic x  value spaces.
    71     88  end-of-input                  value 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page   3
* EL201.cbl
    72 77  ws-sql-code                 pic s9(7) value zeros.
    73 77  ws-dis-sql-code             pic -9999999 value zeros.
    74 01  ws-written-in.
    75     05  ws-writ-in-dir          pic x(15)  value
    76         '/data/seqfiles/'.
    77     05  ws-writ-in-name         pic x(16) value
    78         'miscpymts.csv   '.
    79 01  ws-written-rpt.
    80     05  ws-writ-rpt-dir         pic x(15)  value
    81         '/data/seqfiles/'.
    82     05  ws-writ-rpt-comp-id     pic xxx  value spaces.
    83     05  ws-writ-rpt-name        pic x(13) value
    84         'miscpymts.rpt'.
*   85 EXEC SQL
*   86    INCLUDE SQLDA
*   87 END-EXEC
    88 01 SQLDA sync.
    89    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    90    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    91    05 SQLN                  PIC S9(4) COMP-5 value 0.
    92    05 SQLD                  PIC S9(4) COMP-5 value 0.
    93    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    94       10 SQLTYPE            PIC S9(4) COMP-5.
    95       10 SQLLEN             PIC S9(4) COMP-5.
    96$IF P64 SET
    97X      *> For 64-bit environments, ensure that SQLDATA is
    98X      *> aligned on an 8-byte boundary.
    99X      10 FILLER             PIC S9(9) COMP-5.
   100$END
   101       10 SQLDATA            USAGE POINTER.
   102       10 SQLIND             USAGE POINTER.
   103       10 SQLNAME.
   104          15 SQLNAMEL        PIC S9(4) COMP-5.
   105          15 SQLNAMEC        PIC X(30).
   106
   107* Values for SQLTYPE
   108
   109 78  ESQL-DATE-CHAR              VALUE 384.
   110 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   111 78  ESQL-DATE-REC               VALUE 386.
   112 78  ESQL-DATE-REC-NULL          VALUE 387.
   113 78  ESQL-TIME-CHAR              VALUE 388.
   114 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   115 78  ESQL-TIME-REC               VALUE 390.
   116 78  ESQL-TIME-REC-NULL          VALUE 391.
   117 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   118 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   119 78  ESQL-TIMESTAMP-REC          VALUE 394.
   120 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   121 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   122 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   123 78  ESQL-TS-OFFSET-REC          VALUE 398.
   124 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   125 78  ESQL-LONGVARBINARY          VALUE 404.
   126 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   127 78  ESQL-LONGVARCHAR            VALUE 408.
   128 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   129 78  ESQL-BINARY                 VALUE 444.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page   4
* EL201.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-BINARY-NULL            VALUE 445.
   131 78  ESQL-VARBINARY              VALUE 446.
   132 78  ESQL-VARBINARY-NULL         VALUE 447.
   133 78  ESQL-VARCHAR                VALUE 448.
   134 78  ESQL-VARCHAR-NULL           VALUE 449.
   135
   136 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   137 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   138
   139 78  ESQL-CHAR                   VALUE 452.
   140 78  ESQL-CHAR-NULL              VALUE 453.
   141
   142 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   143 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   144
   145 78  ESQL-DOUBLE                 VALUE 480.
   146 78  ESQL-DOUBLE-NULL            VALUE 481.
   147 78  ESQL-REAL                   VALUE 482.
   148 78  ESQL-REAL-NULL              VALUE 483.
   149 78  ESQL-DECIMAL                VALUE 484.
   150 78  ESQL-DECIMAL-NULL           VALUE 485.
   151 78  ESQL-INTEGER                VALUE 496.
   152 78  ESQL-INTEGER-NULL           VALUE 497.
   153 78  ESQL-SMALLINT               VALUE 500.
   154 78  ESQL-SMALLINT-NULL          VALUE 501.
   155 78  ESQL-TINYINT                VALUE 502.
   156 78  ESQL-TINYINT-NULL           VALUE 503.
*  157 EXEC SQL
*  158    INCLUDE SQLCA
*  159 END-EXEC
   160 01 SQLCA.
   161     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   162     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   163     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   164     05  SQLERRM.
   165         49  SQLERRML    PIC S9(4) COMP-5.
   166         49  SQLERRMC    PIC X(70).
   167     05  SQLERRP         PIC X(8).
   168     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   169     05  SQLWARN.
   170         10  SQLWARN0    PIC X.
   171         10  SQLWARN1    PIC X.
   172         10  SQLWARN2    PIC X.
   173         10  SQLWARN3    PIC X.
   174         10  SQLWARN4    PIC X.
   175         10  SQLWARN5    PIC X.
   176         10  SQLWARN6    PIC X.
   177         10  SQLWARN7    PIC X.
   178     05  SQLEXT.
   179         10  SQLWARN8    PIC X.
   180         10  SQLWARN9    PIC X.
   181         10  SQLWARN10   PIC X.
   182         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   183     05  SQLSTATE    PIC X(5).
   184 EXEC SQL
   185    BEGIN DECLARE SECTION
   186 END-EXEC
   187 01  ws-key-stuff.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page   5
* EL201.cbl
   188     05  ws-check-key            pic 9(7).
   189     05  ws-check-no             pic x(7).
   190     05  ws-compid               pic xxx.
   191     05  ws-carrier              pic x.
   192     05  ws-grouping             pic x(6).
   193     05  ws-state                pic xx.
   194     05  ws-account              pic x(10).
   195     05  ws-eff-date             pic x(10).
   196     05  ws-certificate          pic x(10).
   197     05  ws-cert-sfx             pic x.
   198     05  ws-seq-no               pic 999.
   199     05  ws-type                 pic 999.
   200 01  sqlcmd                      pic x(1024).
   201 01  WS-MOE-DATE                 pic x(10).
   202 01  svr                         pic x(32).
   203 01  usr                         pic x(32).
   204 01  pass                        pic x(32).
   205 01  usr-pass                    pic x(64).
   206 01  ws-disp-code                pic s9(11).
   207***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   208***                                                            ***
   209***  These indicators are used to determine if a variable      ***
   210***  is passed nulls from sql. The indicator will be -1        ***
   211***  if the value on sql is nulls and +0 if the value is       ***
   212***  something other than nulls. Here is an example on how     ***
   213***  to use the indicator variables.                           ***
   214***                                                            ***
   215***     EXEC SQL                                               ***
   216***        fetch checkapp into                                 ***
   217***           :db-app-status :nu-app-status,                   ***
   218***           :db-app-by     :nu-app-by,                       ***
   219***           :db-app-date   :nu-app-date,                     ***
   220***           :db-app-batch  :nu-app-batch                     ***
   221***     END-EXEC                                               ***
   222***                                                            ***
   223***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   224 01  indicator-vaiables-for-nulls.
   225     05  nu-app-status           pic s9(4) comp value +0.
   226     05  nu-app-by               pic s9(4) comp value +0.
   227     05  nu-app-date             pic s9(4) comp value +0.
   228     05  nu-app-batch            pic s9(4) comp value +0.
   229     05  nu-fincar               pic s9(4) comp value +0.
   230     05  nu-checkno              pic s9(4) comp value +0.
   231 01  daily-check-request-rec.
   232     05  db-checkkey             pic x(7).
   233     05  db-compid               pic xxx.
   234     05  db-carrier              pic x.
   235     05  db-grouping             pic x(6).
   236     05  db-state                pic xx.
   237     05  db-account              pic x(10).
   238     05  db-effdate              pic x(24).
   239     05  db-certificate          pic x(10).
   240     05  db-cert-sfx             pic x.
   241     05  db-seq-no               pic x(7).
   242     05  db-type                 pic x(7).
   243     05  db-amount               pic x(10).
   244     05  db-amount-n redefines
   245         db-amount               pic 9(7).99.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page   6
* EL201.cbl
   246     05  db-checkno              pic x(15).
   247     05  db-checkdate            pic x(10).
   248     05  db-checkstatus          pic 9(5).
   249     05  db-releasebatch         pic 9(5).
   250     05  db-releasedt            pic x(10).
   251     05  db-releaseby            pic x(4).
   252     05  db-payeename1           pic x(30).
   253     05  db-payeename2           pic x(30).
   254     05  db-payeeaddr1           pic x(30).
   255     05  db-payeeaddr2           pic x(30).
   256     05  db-payeecity            pic x(30).
   257     05  db-payeest              pic xx.
   258     05  db-payeezip             pic x(10).
   259     05  db-fincar               pic x.
   260     05  db-fingrp               pic x(6).
   261     05  db-finresp              pic x(10).
   262     05  db-finacct              pic x(10).
   263     05  db-preparer             pic x(4).
   264     05  db-app-status           pic x(9).
   265     05  dp-app-status-n redefines db-app-status
   266                                 pic 9(9).
   267     05  db-app-by               pic x(20).
   268     05  db-app-date             pic x(30).
   269     05  db-app-batch            pic x(10).
   270     05  db-return-to            pic x(30).
   271 EXEC SQL
   272    END DECLARE SECTION
   273 END-EXEC
   274 01  FILE-KEYS.
   275     12  ELCNTL-KEY.
   276         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   277         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   278         16 ELCNTL-ACCESS.
   279             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   280             20  FILLER              PIC X       VALUE SPACES.
   281             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   282         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   283 01  f.
   284     05  ws-connect-sw               pic x  value ' '.
   285         88  connected-to-db             value 'Y'.
   286     05  written-status          pic xx.
   287     05  writrpt-status          pic xx.
   288     05  ws-comp-id              pic xxx.
   289     05  ws-comp-cd              pic x.
   290 01  ws-written-rec.
   291     05  wsw-check-no            pic x(20).
   292     05  wsw-check-dt            pic x(20).
   293     05  wsw-check-amt           pic x(15).
   294     05  wsw-vendor-id           pic x(20).
   295     05  wsw-user-defined        pic x(30).
   296     05  wsw-voucher-ref         pic x(35).
   297 01  filler.
   298     05  wsw-check-key           pic x(7).
   299     05  wsw-check-key-num redefines wsw-check-key
   300                                 pic 9(7).
   301 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   302     88  RESP-NORMAL                    VALUE +0.
   303     88  resp-file-notfnd               value +12.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page   7
* EL201.cbl
   304     88  RESP-NOTFND                    VALUE +13.
   305     88  resp-duprec                    value +14.
   306     88  resp-dupkey                    value +15.
   307     88  resp-invreq                    value +16.
   308     88  RESP-NOTOPEN                   VALUE +19.
   309     88  RESP-ENDFILE                   VALUE +20.
   310     88  resp-lengtherr                 value +22.
   311 01  ws-work-amt-alpha           pic x(10).
   312 01  ws-work-amt-num redefines ws-work-amt-alpha
   313                                 pic 9(8)v99.
   314 01  ws-qry-string               pic x(80) value spaces.
   315 01  ws-qrystr-len               pic s9(8) comp value +60.
   316 01  ws-seq-alpha                pic x(5).
   317 01  ws-seq-no-num redefines ws-seq-alpha
   318                                 pic 9(5).
   319*                                copy ERCCHEK.
   320******************************************************************
   321*                                                                *
   322*                                                                *
   323*                            ERCCHEK                             *
   324*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   325*                            VMOD=2.008                          *
   326*                                                                *
   327*   FILE DESCRIPTION = CHECK RECORDS                             *
   328*                                                                *
   329*   FILE TYPE = VSAM,KSDS                                        *
   330*   RECORD SIZE = 600    RECFORM = FIXED                         *
   331*                                                                *
   332*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
   333*       ALTERNATE INDEX = NONE                                   *
   334*                                                                *
   335*   LOG = YES                                                    *
   336*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   337******************************************************************
   338*                   C H A N G E   L O G
   339*
   340* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   341*-----------------------------------------------------------------
   342*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   343* EFFECTIVE    NUMBER
   344*-----------------------------------------------------------------
   345* 021414    2003053000001  PEMA  changes for auto chk request
   346******************************************************************
   347 01  CHECK-RECORDS.
   348     12  CH-RECORD-ID                      PIC XX.
   349         88  VALID-CH-ID                      VALUE 'CH'.
   350
   351     12  CH-CONTROL-PRIMARY.
   352         16  CH-COMPANY-CD                 PIC X.
   353         16  CH-CARRIER                    PIC X.
   354         16  CH-GROUPING                   PIC X(6).
   355         16  CH-STATE                      PIC XX.
   356         16  CH-ACCOUNT                    PIC X(10).
   357         16  CH-CERT-EFF-DT                PIC XX.
   358         16  CH-CERT-NO.
   359             20  CH-CERT-PRIME             PIC X(10).
   360             20  CH-CERT-SFX               PIC X.
   361         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page   8
* EL201.cbl
   362
   363     12  CH-RECORDED-DT                    PIC XX.
   364     12  CH-RECORDED-BY                    PIC X(4).
   365     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
   366
   367     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
   368     12  CH-CHECK-NO                       PIC X(7).
   369     12  CH-REASON-FOR-CHECK               PIC X(25).
   370     12  CH-CHECK-WRITTEN-DT               PIC XX.
   371     12  FILLER                            PIC X.
   372
   373     12  CH-PAYEE-INFO.
   374         16  CH-PAYEE-NAME-1               PIC X(30).
   375         16  CH-PAYEE-NAME-2               PIC X(30).
   376         16  CH-PAYEE-ADDRESS-1            PIC X(30).
   377         16  CH-PAYEE-ADDRESS-2            PIC X(30).
   378         16  CH-PAYEE-CITY-ST.
   379             20  CH-PAYEE-CITY             PIC X(28).
   380             20  CH-PAYEE-STATE            PIC XX.
   381         16  CH-PAYEE-ZIP-CODE.
   382             20  CH-PAYEE-ZIP.
   383                 24  CH-ZIP-PRI-1ST        PIC X.
   384                     88  CH-CANADIAN-POST-CODE
   385                                           VALUES 'A' THRU 'Z'.
   386                 24  FILLER                PIC X(4).
   387             20  CH-PAYEE-ZIP-EXT          PIC X(4).
   388         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
   389             20  CH-CAN-POSTAL-1           PIC XXX.
   390             20  CH-CAN-POSTAL-2           PIC XXX.
   391             20  FILLER                    PIC XXX.
   392
   393     12  CH-CHECK-STUB-TEXT.
   394         16  CH-STUB-LINE-1                PIC X(30).
   395         16  CH-TEXT-LINE-1                PIC X(50).
   396         16  CH-TEXT-LINE-2                PIC X(50).
   397         16  CH-TEXT-LINE-3                PIC X(40).
   398     12  CH-RETURN-TO                      PIC X(30).
   399
   400     12  CH-COMPENSATION-CONTROL.
   401         16  CH-COMP-CARRIER               PIC X.
   402         16  CH-COMP-GROUPING              PIC X(6).
   403         16  CH-COMP-FIN-RESP              PIC X(10).
   404         16  CH-COMP-ACCOUNT               PIC X(10).
   405
   406     12  CH-CREDIT-SELECT-DT               PIC XX.
   407     12  CH-CREDIT-ACCEPT-DT               PIC XX.
   408     12  CH-PAYEE-CODE                     PIC X(6).
   409
   410     12  CH-VOID-DATA.
   411         20  CH-VOID-DT                    PIC XX.
   412         20  CH-VOID-BY                    PIC X(4).
   413         20  CH-VOID-REASON                PIC X(25).
   414
   415     12  CH-APPROVAL-DATA.
   416         20  CH-APPROVAL-DT                PIC XX.
   417         20  CH-APPROVAL-STATUS            PIC X.
   418             88  CH-IN-LIMBO                  VALUE ' '.
   419             88  CH-APPROV-PENDING            VALUE 'P' '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page   9
* EL201.cbl
   420             88  CH-APPROVED                  VALUE 'A'.
   421             88  CH-DENIED                    VALUE 'D'.
   422         20  CH-APPROVED-BY                PIC XXXX.
   423     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
   424             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
   425     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
   426
   427     12  ch-released-dt                    pic xx.
   428     12  ch-check-cashed-dt                pic xx.
   429     12  FILLER                            PIC X.
   430*    12  CH-CHECK-REFERENCE                PIC X(12).
   431     12  CH-CHECK-ORIGIN-SW                PIC X.
   432             88  CH-REFUND-CHECK              VALUE 'R'.
   433             88  CH-MAINT-CHECK               VALUE 'M'.
   434
   435     12  CH-CANC-DT                        PIC XX.
   436     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
   437     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
   438
   439     12  CH-INSURED-NAME                   PIC X(28).
   440
   441     12  ch-released-by                    pic x(4).
   442     12  ch-csr                            pic x(4).
   443     12  ch-deduct-commission              pic x.
   444         88  ch-deduct-comm                  value 'Y'.
   445         88  ch-do-not-deduct-comm           value 'N'.
   446
   447     12  FILLER                            PIC X(11).
   448*    12  CH-LETTER-TABLE.
   449*        16  CH-LETTERS OCCURS 3 TIMES
   450*                       INDEXED BY CH-LT-NDX
   451*                                          PIC X(04).
   452
   453     12  FILLER                            PIC X(07).
   454
   455*                                copy ELCFUNDT.
   456*****************************************************************
   457*                                                               *
   458*                            ELCFUNDT.                          *
   459*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   460*                            VMOD=2.001                         *
   461*                                                               *
   462*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   463*                                                               *
   464*****************************************************************
   465
   466
   467 01  FUNCTION-DATE.
   468     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   469     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   470         10  WS-FN-CCYR            PIC 9(4).
   471         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   472             15  WS-FN-CC          PIC 99.
   473             15  WS-FN-YR          PIC 99.
   474         10  WS-FN-MO              PIC 99.
   475         10  WS-FN-DA              PIC 99.
   476     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   477     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  10
* EL201.cbl
   478     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   479     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   480     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   481         88  WS-BEHIND-GMT                     VALUE '-'.
   482         88  WS-AFTER-GMT                      VALUE '+'.
   483         88  WS-NO-GMT                         VALUE ZERO.
   484     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   485     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   486*                                COPY ELCDATE.
   487******************************************************************
   488*                                                                *
   489*                                                                *
   490*                            ELCDATE.                            *
   491*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   492*                            VMOD=2.003
   493*                                                                *
   494*                                                                *
   495*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   496*                 LENGTH = 200                                   *
   497******************************************************************
   498
   499 01  DATE-CONVERSION-DATA.
   500     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   501     12  DC-OPTION-CODE                PIC X.
   502         88  BIN-TO-GREG                VALUE ' '.
   503         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   504         88  EDIT-GREG-TO-BIN           VALUE '2'.
   505         88  YMD-GREG-TO-BIN            VALUE '3'.
   506         88  MDY-GREG-TO-BIN            VALUE '4'.
   507         88  JULIAN-TO-BIN              VALUE '5'.
   508         88  BIN-PLUS-ELAPSED           VALUE '6'.
   509         88  FIND-CENTURY               VALUE '7'.
   510         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   511         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   512         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   513         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   514         88  JULIAN-TO-BIN-3            VALUE 'C'.
   515         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   516         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   517         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   518         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   519         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   520         88  CHECK-LEAP-YEAR            VALUE 'H'.
   521         88  BIN-3-TO-GREG              VALUE 'I'.
   522         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   523         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   524         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   525         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   526         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   527         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   528         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   529         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   530         88  THREE-CHARACTER-BIN
   531                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   532         88  GREGORIAN-TO-BIN
   533                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   534         88  BIN-TO-GREGORIAN
   535                  VALUES ' ' '1' 'I' '8' 'G'.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  11
* EL201.cbl
   536         88  JULIAN-TO-BINARY
   537                  VALUES '5' 'C' 'E' 'F'.
   538     12  DC-ERROR-CODE                 PIC X.
   539         88  NO-CONVERSION-ERROR        VALUE ' '.
   540         88  DATE-CONVERSION-ERROR
   541                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   542         88  DATE-IS-ZERO               VALUE '1'.
   543         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   544         88  DATE-IS-INVALID            VALUE '3'.
   545         88  DATE1-GREATER-DATE2        VALUE '4'.
   546         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   547         88  DATE-INVALID-OPTION        VALUE '9'.
   548         88  INVALID-CENTURY            VALUE 'A'.
   549         88  ONLY-CENTURY               VALUE 'B'.
   550         88  ONLY-LEAP-YEAR             VALUE 'C'.
   551         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   552     12  DC-END-OF-MONTH               PIC X.
   553         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   554     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   555         88  USE-NORMAL-PROCESS         VALUE ' '.
   556         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   557         88  ADJUST-UP-100-YRS          VALUE '2'.
   558     12  FILLER                        PIC X.
   559     12  DC-CONVERSION-DATES.
   560         16  DC-BIN-DATE-1             PIC XX.
   561         16  DC-BIN-DATE-2             PIC XX.
   562         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   563         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   564                       DC-GREG-DATE-1-EDIT.
   565             20  DC-EDIT1-MONTH        PIC 99.
   566             20  SLASH1-1              PIC X.
   567             20  DC-EDIT1-DAY          PIC 99.
   568             20  SLASH1-2              PIC X.
   569             20  DC-EDIT1-YEAR         PIC 99.
   570         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   571         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   572                     DC-GREG-DATE-2-EDIT.
   573             20  DC-EDIT2-MONTH        PIC 99.
   574             20  SLASH2-1              PIC X.
   575             20  DC-EDIT2-DAY          PIC 99.
   576             20  SLASH2-2              PIC X.
   577             20  DC-EDIT2-YEAR         PIC 99.
   578         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   579         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   580                     DC-GREG-DATE-1-YMD.
   581             20  DC-YMD-YEAR           PIC 99.
   582             20  DC-YMD-MONTH          PIC 99.
   583             20  DC-YMD-DAY            PIC 99.
   584         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   585         16  DC-GREG-DATE-1-MDY-R REDEFINES
   586                      DC-GREG-DATE-1-MDY.
   587             20  DC-MDY-MONTH          PIC 99.
   588             20  DC-MDY-DAY            PIC 99.
   589             20  DC-MDY-YEAR           PIC 99.
   590         16  DC-GREG-DATE-1-ALPHA.
   591             20  DC-ALPHA-MONTH        PIC X(10).
   592             20  DC-ALPHA-DAY          PIC 99.
   593             20  FILLER                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  12
* EL201.cbl
   594             20  DC-ALPHA-CENTURY.
   595                 24 DC-ALPHA-CEN-N     PIC 99.
   596             20  DC-ALPHA-YEAR         PIC 99.
   597         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   598         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   599         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   600         16  DC-JULIAN-DATE            PIC 9(05).
   601         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   602                                       PIC 9(05).
   603         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   604             20  DC-JULIAN-YEAR        PIC 99.
   605             20  DC-JULIAN-DAYS        PIC 999.
   606         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   607         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   608         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   609     12  DATE-CONVERSION-VARIBLES.
   610         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   611         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   612             20  FILLER                PIC 9(3).
   613             20  HOLD-CEN-1-CCYY.
   614                 24  HOLD-CEN-1-CC     PIC 99.
   615                 24  HOLD-CEN-1-YY     PIC 99.
   616             20  HOLD-CEN-1-MO         PIC 99.
   617             20  HOLD-CEN-1-DA         PIC 99.
   618         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   619             20  HOLD-CEN-1-R-MO       PIC 99.
   620             20  HOLD-CEN-1-R-DA       PIC 99.
   621             20  HOLD-CEN-1-R-CCYY.
   622                 24  HOLD-CEN-1-R-CC   PIC 99.
   623                 24  HOLD-CEN-1-R-YY   PIC 99.
   624             20  FILLER                PIC 9(3).
   625         16  HOLD-CENTURY-1-X.
   626             20  FILLER                PIC X(3)  VALUE SPACES.
   627             20  HOLD-CEN-1-X-CCYY.
   628                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   629                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   630             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   631             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   632         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   633             20  HOLD-CEN-1-R-X-MO     PIC XX.
   634             20  HOLD-CEN-1-R-X-DA     PIC XX.
   635             20  HOLD-CEN-1-R-X-CCYY.
   636                 24  HOLD-CEN-1-R-X-CC PIC XX.
   637                 24  HOLD-CEN-1-R-X-YY PIC XX.
   638             20  FILLER                PIC XXX.
   639         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   640         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   641         16  DC-JULIAN-DATE-1          PIC 9(07).
   642         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   643             20  DC-JULIAN-1-CCYY.
   644                 24  DC-JULIAN-1-CC    PIC 99.
   645                 24  DC-JULIAN-1-YR    PIC 99.
   646             20  DC-JULIAN-DA-1        PIC 999.
   647         16  DC-JULIAN-DATE-2          PIC 9(07).
   648         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   649             20  DC-JULIAN-2-CCYY.
   650                 24  DC-JULIAN-2-CC    PIC 99.
   651                 24  DC-JULIAN-2-YR    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  13
* EL201.cbl
   652             20  DC-JULIAN-DA-2        PIC 999.
   653         16  DC-GREG-DATE-A-EDIT.
   654             20  DC-EDITA-MONTH        PIC 99.
   655             20  SLASHA-1              PIC X VALUE '/'.
   656             20  DC-EDITA-DAY          PIC 99.
   657             20  SLASHA-2              PIC X VALUE '/'.
   658             20  DC-EDITA-CCYY.
   659                 24  DC-EDITA-CENT     PIC 99.
   660                 24  DC-EDITA-YEAR     PIC 99.
   661         16  DC-GREG-DATE-B-EDIT.
   662             20  DC-EDITB-MONTH        PIC 99.
   663             20  SLASHB-1              PIC X VALUE '/'.
   664             20  DC-EDITB-DAY          PIC 99.
   665             20  SLASHB-2              PIC X VALUE '/'.
   666             20  DC-EDITB-CCYY.
   667                 24  DC-EDITB-CENT     PIC 99.
   668                 24  DC-EDITB-YEAR     PIC 99.
   669         16  DC-GREG-DATE-CYMD         PIC 9(08).
   670         16  DC-GREG-DATE-CYMD-R REDEFINES
   671                              DC-GREG-DATE-CYMD.
   672             20  DC-CYMD-CEN           PIC 99.
   673             20  DC-CYMD-YEAR          PIC 99.
   674             20  DC-CYMD-MONTH         PIC 99.
   675             20  DC-CYMD-DAY           PIC 99.
   676         16  DC-GREG-DATE-MDCY         PIC 9(08).
   677         16  DC-GREG-DATE-MDCY-R REDEFINES
   678                              DC-GREG-DATE-MDCY.
   679             20  DC-MDCY-MONTH         PIC 99.
   680             20  DC-MDCY-DAY           PIC 99.
   681             20  DC-MDCY-CEN           PIC 99.
   682             20  DC-MDCY-YEAR          PIC 99.
   683    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   684        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   685    12  DC-EL310-DATE                  PIC X(21).
   686    12  FILLER                         PIC X(28).
   687*                                COPY ELCCNTL.
   688******************************************************************
   689*                                                                *
   690*                                                                *
   691*                            ELCCNTL.                            *
   692*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   693*                            VMOD=2.059                          *
   694*                                                                *
   695*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   696*                                                                *
   697*   FILE TYPE = VSAM,KSDS                                        *
   698*   RECORD SIZE = 750  RECFORM = FIXED                           *
   699*                                                                *
   700*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   701*       ALTERNATE INDEX = NONE                                   *
   702*                                                                *
   703*   LOG = YES                                                    *
   704*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   705******************************************************************
   706*                   C H A N G E   L O G
   707*
   708* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   709*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  14
* EL201.cbl
   710*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   711* EFFECTIVE    NUMBER
   712*-----------------------------------------------------------------
   713* 082503                   PEMA  ADD BENEFIT GROUP
   714* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   715* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   716* 092705    2005050300006  PEMA  ADD SPP LEASES
   717* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   718* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   719* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   720* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   721* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   722* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   723* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   724* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   725* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   726******************************************************************
   727*
   728 01  CONTROL-FILE.
   729     12  CF-RECORD-ID                       PIC XX.
   730         88  VALID-CF-ID                        VALUE 'CF'.
   731
   732     12  CF-CONTROL-PRIMARY.
   733         16  CF-COMPANY-ID                  PIC XXX.
   734         16  CF-RECORD-TYPE                 PIC X.
   735             88  CF-COMPANY-MASTER              VALUE '1'.
   736             88  CF-PROCESSOR-MASTER            VALUE '2'.
   737             88  CF-STATE-MASTER                VALUE '3'.
   738             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   739             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   740             88  CF-CARRIER-MASTER              VALUE '6'.
   741             88  CF-MORTALITY-MASTER            VALUE '7'.
   742             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   743             88  CF-TERMINAL-MASTER             VALUE '9'.
   744             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   745             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   746             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   747             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   748             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   749             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   750             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   751             88  CF-REMINDERS-MASTER            VALUE 'R'.
   752             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   753         16  CF-ACCESS-CD-GENL              PIC X(4).
   754         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   755             20  CF-PROCESSOR               PIC X(4).
   756         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   757             20  CF-STATE-CODE              PIC XX.
   758             20  FILLER                     PIC XX.
   759         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   760             20  FILLER                     PIC XX.
   761             20  CF-HI-BEN-IN-REC           PIC XX.
   762         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   763             20  FILLER                     PIC XXX.
   764             20  CF-CARRIER-CNTL            PIC X.
   765         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   766             20  FILLER                     PIC XX.
   767             20  CF-HI-TYPE-IN-REC          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  15
* EL201.cbl
   768         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   769             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   770                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   771             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   772             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   773         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   774             20  FILLER                     PIC X.
   775             20  CF-CUSTOM-REPORT-NO        PIC 999.
   776         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   777             20  FILLER                     PIC XX.
   778             20  CF-MORTGAGE-PLAN           PIC XX.
   779         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   780
   781     12  CF-LAST-MAINT-DT                   PIC XX.
   782     12  CF-LAST-MAINT-BY                   PIC X(4).
   783     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   784
   785     12  CF-RECORD-BODY                     PIC X(728).
   786
   787
   788****************************************************************
   789*             COMPANY MASTER RECORD                            *
   790****************************************************************
   791
   792     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   793         16  CF-COMPANY-ADDRESS.
   794             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   795             20  CF-CL-IN-CARE-OF           PIC X(30).
   796             20  CF-CL-ADDR-LINE-1          PIC X(30).
   797             20  CF-CL-ADDR-LINE-2          PIC X(30).
   798             20  CF-CL-CITY-STATE           PIC X(30).
   799             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   800             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   801         16  CF-COMPANY-CD                  PIC X.
   802         16  CF-COMPANY-PASSWORD            PIC X(8).
   803         16  CF-SECURITY-OPTION             PIC X.
   804             88  ALL-SECURITY                   VALUE '1'.
   805             88  COMPANY-VERIFY                 VALUE '2'.
   806             88  PROCESSOR-VERIFY               VALUE '3'.
   807             88  NO-SECURITY                    VALUE '4'.
   808             88  ALL-BUT-TERM                   VALUE '5'.
   809         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   810             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   811         16  CF-LGX-INTERFACE-CNTL          PIC X.
   812             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   813         16  CF-INFORCE-LOCATION            PIC X.
   814             88  CERTS-ARE-ONLINE               VALUE '1'.
   815             88  CERTS-ARE-OFFLINE              VALUE '2'.
   816             88  NO-CERTS-AVAILABLE             VALUE '3'.
   817         16  CF-LOWER-CASE-LETTERS          PIC X.
   818         16  CF-CERT-ACCESS-CONTROL         PIC X.
   819             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   820             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   821             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   822             88  CF-ACCNT-CNTL                  VALUE '3'.
   823             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   824
   825         16  CF-FORMS-PRINTER-ID            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  16
* EL201.cbl
   826         16  CF-CHECK-PRINTER-ID            PIC X(4).
   827
   828         16  CF-LGX-CREDIT-USER             PIC X.
   829             88  CO-IS-NOT-USER                 VALUE 'N'.
   830             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   831
   832         16 CF-CREDIT-CALC-CODES.
   833             20  CF-CR-REM-TERM-CALC PIC X.
   834               88  CR-EARN-AFTER-15TH           VALUE '1'.
   835               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   836               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   837               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   838               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   839               88  CR-EARN-AFTER-14TH           VALUE '6'.
   840               88  CR-EARN-AFTER-16TH           VALUE '7'.
   841             20  CF-CR-R78-METHOD           PIC X.
   842               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   843               88  DONT-USE-PLUS-ONE            VALUE '1'.
   844
   845         16  CF-CLAIM-CONTROL-COUNTS.
   846             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   847                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   848
   849             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   850                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   851
   852             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   853                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   854
   855             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   856                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   857
   858         16  CF-CURRENT-MONTH-END           PIC XX.
   859
   860         16  CF-CO-CALC-QUOTE-TOLERANCE.
   861             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   862             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   863             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   864             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   865                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   866                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   867             20  CF-CO-PREM-REJECT-SW       PIC X.
   868                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   869                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   870             20  CF-CO-REF-REJECT-SW        PIC X.
   871                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   872                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   873
   874         16  CF-CO-REPORTING-DT             PIC XX.
   875         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   876         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   877           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   878           88  CF-CO-MONTH-END                  VALUE '1'.
   879
   880         16  CF-LGX-CLAIM-USER              PIC X.
   881             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   882             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   883
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  17
* EL201.cbl
   884         16  CF-CREDIT-EDIT-CONTROLS.
   885             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   886             20  CF-MIN-AGE                 PIC 99.
   887             20  CF-DEFAULT-AGE             PIC 99.
   888             20  CF-MIN-TERM                PIC S999      COMP-3.
   889             20  CF-MAX-TERM                PIC S999      COMP-3.
   890             20  CF-DEFAULT-SEX             PIC X.
   891             20  CF-JOINT-AGE-INPUT         PIC X.
   892                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   893             20  CF-BIRTH-DATE-INPUT        PIC X.
   894                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   895             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   896                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   897                 88  CF-ZERO-CARRIER            VALUE '1'.
   898                 88  CF-ZERO-GROUPING           VALUE '2'.
   899                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   900             20  CF-EDIT-SW                 PIC X.
   901                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   902             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   903             20  CF-CR-PR-METHOD            PIC X.
   904               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   905               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   906             20  FILLER                     PIC X.
   907
   908         16  CF-CREDIT-MISC-CONTROLS.
   909             20  CF-REIN-TABLE-SW           PIC X.
   910                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   911             20  CF-COMP-TABLE-SW           PIC X.
   912                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   913             20  CF-EXPERIENCE-RETENTION-AGE
   914                                            PIC S9        COMP-3.
   915             20  CF-CONVERSION-DT           PIC XX.
   916             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   917             20  CF-RUN-FREQUENCY-SW        PIC X.
   918                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   919                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   920
   921             20  CF-CR-CHECK-NO-CONTROL.
   922                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   923                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   924                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   925                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   926                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   927                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   928
   929                 24  CF-CR-CHECK-COUNT       REDEFINES
   930                     CF-CR-CHECK-COUNTER      PIC X(4).
   931
   932                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   933                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   934
   935                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   936                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   937                 24  CF-MAIL-PROCESSING       PIC X.
   938                     88  MAIL-PROCESSING          VALUE 'Y'.
   939
   940         16  CF-MISC-SYSTEM-CONTROL.
   941             20  CF-SYSTEM-C                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  18
* EL201.cbl
   942                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   943             20  CF-SYSTEM-D                 PIC X.
   944                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   945             20  CF-SOC-SEC-NO-SW            PIC X.
   946                 88  SOC-SEC-NO-USED             VALUE '1'.
   947             20  CF-MEMBER-NO-SW             PIC X.
   948                 88  MEMBER-NO-USED              VALUE '1'.
   949             20  CF-TAX-ID-NUMBER            PIC X(11).
   950             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   951             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   952                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   953                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   954                 88  CF-ALL-APPROVED             VALUE 'Y'.
   955                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   956             20  CF-SYSTEM-E                 PIC X.
   957                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   958
   959         16  CF-LGX-LIFE-USER               PIC X.
   960             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   961             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   962
   963         16  CF-CR-MONTH-END-DT             PIC XX.
   964
   965         16  CF-FILE-MAINT-DATES.
   966             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   967                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   968             20  CF-LAST-BATCH       REDEFINES
   969                 CF-LAST-BATCH-NO               PIC X(4).
   970             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   971             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   972             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   973             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   974             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   975             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
   976             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   977             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   978             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   979             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   980
   981         16  CF-NEXT-COMPANY-ID             PIC XXX.
   982         16  FILLER                         PIC X.
   983
   984         16  CF-ALT-MORT-CODE               PIC X(4).
   985         16  CF-MEMBER-CAPTION              PIC X(10).
   986
   987         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   988             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   989             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
   990             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
   991             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
   992             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
   993
   994         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   995
   996         16  CF-LIFE-OVERRIDE-L1            PIC X.
   997         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   998         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   999         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  19
* EL201.cbl
  1000
  1001         16  CF-AH-OVERRIDE-L1              PIC X.
  1002         16  CF-AH-OVERRIDE-L2              PIC XX.
  1003         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1004         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1005
  1006         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1007         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1008
  1009         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1010         16  CF-AR-LAST-EL860-DT            PIC XX.
  1011         16  CF-MP-MONTH-END-DT             PIC XX.
  1012
  1013         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1014         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1015             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1016
  1017         16  CF-AR-MONTH-END-DT             PIC XX.
  1018
  1019         16  CF-CRDTCRD-USER                PIC X.
  1020             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1021             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1022
  1023         16  CF-CC-MONTH-END-DT             PIC XX.
  1024
  1025         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1026
  1027         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1028             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1029             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1030             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1031         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1032         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1033         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1034         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1035             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1036             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1037         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1038         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1039         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1040             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1041         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1042
  1043         16  CF-CL-ZIP-CODE.
  1044             20  CF-CL-ZIP-PRIME.
  1045                 24  CF-CL-ZIP-1ST          PIC X.
  1046                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1047                 24  FILLER                 PIC X(4).
  1048             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1049         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1050             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1051             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1052             20  FILLER                     PIC XXX.
  1053
  1054         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1055         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1056         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1057         16  CF-CO-OPTION-START-DATE        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  20
* EL201.cbl
  1058         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1059           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1060                                                      '3' '4'.
  1061           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1062           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1063           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1064           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1065           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1066           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1067
  1068         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1069
  1070         16  CF-PAYMENT-APPROVAL-LEVELS.
  1071             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1072             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1073             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1074             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1075             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1076             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1077
  1078         16  CF-END-USER-REPORTING-USER     PIC X.
  1079             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1080             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1081
  1082         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1083             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1084             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1085
  1086         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1087
  1088         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1089         16  FILLER                         PIC X.
  1090
  1091         16  CF-CREDIT-ARCHIVE-CNTL.
  1092             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1093             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1094             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1095
  1096         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1097
  1098         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1099             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1100             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1101
  1102         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1103             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1104             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1105
  1106         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1107
  1108         16  CF-CO-ACH-ID-CODE              PIC  X.
  1109             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1110             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1111             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1112         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1113         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1114         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1115         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  21
* EL201.cbl
  1116         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1117         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1118         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1119         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1120         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1121                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1122         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1123                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1124
  1125         16  CF-CO-OVER-SHORT.
  1126             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1127             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1128
  1129*         16  FILLER                         PIC X(102).
  1130         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1131             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1132             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1133
  1134         16  CF-AH-APPROVAL-DAYS.
  1135             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1136             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1137             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1138             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1139
  1140         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1141
  1142         16  CF-APPROV-LEV-5.
  1143             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1144             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1145             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1146
  1147         16  FILLER                         PIC X(68).
  1148****************************************************************
  1149*             PROCESSOR/USER RECORD                            *
  1150****************************************************************
  1151
  1152     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1153         16  CF-PROCESSOR-NAME              PIC X(30).
  1154         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1155         16  CF-PROCESSOR-TITLE             PIC X(26).
  1156         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1157                 88  MESSAGE-YES                VALUE 'Y'.
  1158                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1159
  1160*****************************************************
  1161****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1162****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1163****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1164****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1165*****************************************************
  1166
  1167         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1168             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1169             20  CF-APPLICATION-FORCE       PIC X.
  1170             20  CF-INDIVIDUAL-APP.
  1171                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1172                     28  CF-BROWSE-APP      PIC X.
  1173                     28  CF-UPDATE-APP      PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  22
* EL201.cbl
  1174
  1175         16  CF-CURRENT-TERM-ON             PIC X(4).
  1176         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1177             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1178             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1179             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1180             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1181             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1182             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1183             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1184         16  CF-PROCESSOR-CARRIER           PIC X.
  1185             88  NO-CARRIER-SECURITY            VALUE ' '.
  1186         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1187             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1188         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1189             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1190         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1191             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1192
  1193         16  CF-PROC-SYS-ACCESS-SW.
  1194             20  CF-PROC-CREDIT-CLAIMS-SW.
  1195                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1196                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1197                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1198                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1199             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1200                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1201                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1202             20  CF-PROC-LIFE-GNRLDGR-SW.
  1203                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1204                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1205                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1206                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1207             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1208                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1209                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1210         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1211             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1212             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1213         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1214
  1215         16  CF-APPROVAL-LEVEL                  PIC X.
  1216             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1217             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1218             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1219             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1220             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1221
  1222         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1223
  1224         16  CF-LANGUAGE-TYPE                   PIC X.
  1225             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1226             88  CF-LANG-IS-FR                      VALUE 'F'.
  1227
  1228         16  CF-CSR-IND                         PIC X.
  1229         16  FILLER                             PIC X(239).
  1230
  1231****************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  23
* EL201.cbl
  1232*             PROCESSOR/REMINDERS RECORD                       *
  1233****************************************************************
  1234
  1235     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1236         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1237             20  CF-START-REMIND-DT         PIC XX.
  1238             20  CF-END-REMIND-DT           PIC XX.
  1239             20  CF-REMINDER-TEXT           PIC X(50).
  1240         16  FILLER                         PIC X(296).
  1241
  1242
  1243****************************************************************
  1244*             STATE MASTER RECORD                              *
  1245****************************************************************
  1246
  1247     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1248         16  CF-STATE-ABBREVIATION          PIC XX.
  1249         16  CF-STATE-NAME                  PIC X(25).
  1250         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1251         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1252             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1253             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1254             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1255             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1256                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1257                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1258             20  CF-ST-PREM-REJECT-SW       PIC X.
  1259                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1260                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1261             20  CF-ST-REF-REJECT-SW        PIC X.
  1262                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1263                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1264         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1265         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1266         16  CF-ST-REFUND-RULES.
  1267             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1268             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1269             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1270         16  CF-ST-FST-PMT-EXTENSION.
  1271             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1272             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1273                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1274                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1275                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1276                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1277         16  CF-ST-STATE-CALL.
  1278             20  CF-ST-CALL-UNEARNED        PIC X.
  1279             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1280             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1281         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1282             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1283             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1284         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1285         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1286         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1287         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1288         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1289         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  24
* EL201.cbl
  1290         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1291             20  CF-ST-BENEFIT-CD           PIC XX.
  1292             20  CF-ST-BENEFIT-KIND         PIC X.
  1293                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1294                 88  CF-ST-AH-KIND              VALUE 'A'.
  1295             20  CF-ST-REM-TERM-CALC        PIC X.
  1296                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1297                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1298                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1299                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1300                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1301                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1302                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1303                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1304
  1305             20  CF-ST-REFUND-CALC          PIC X.
  1306                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1307                 88  ST-REFD-BY-R78             VALUE '1'.
  1308                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1309                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1310                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1311                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1312                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1313                 88  ST-REFD-UTAH               VALUE '7'.
  1314                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1315                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1316                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1317
  1318             20  CF-ST-EARNING-CALC         PIC X.
  1319                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1320                 88  ST-EARN-BY-R78             VALUE '1'.
  1321                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1322                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1323                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1324                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1325                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1326                 88  ST-EARN-MEAN               VALUE '8'.
  1327                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1328
  1329             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1330                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1331                 88  ST-OVRD-BY-R78             VALUE '1'.
  1332                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1333                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1334                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1335                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1336                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1337                 88  ST-OVRD-MEAN               VALUE '8'.
  1338                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1339             20  FILLER                     PIC X.
  1340
  1341         16  CF-ST-COMMISSION-CAPS.
  1342             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1343             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1344             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1345             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1346         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1347                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  25
* EL201.cbl
  1348
  1349         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1350
  1351         16  CF-ST-STATUTORY-INTEREST.
  1352             20  CF-ST-STAT-DATE-FROM       PIC X.
  1353                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1354                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1355             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1356             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1357             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1358             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1359             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1360
  1361         16  CF-ST-OVER-SHORT.
  1362             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1363             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1364
  1365         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1366
  1367         16  CF-ST-RT-CALC                  PIC X.
  1368
  1369         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1370         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1371         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1372         16  CF-ST-RF-LR-CALC               PIC X.
  1373         16  CF-ST-RF-LL-CALC               PIC X.
  1374         16  CF-ST-RF-LN-CALC               PIC X.
  1375         16  CF-ST-RF-AH-CALC               PIC X.
  1376         16  CF-ST-RF-CP-CALC               PIC X.
  1377*        16  FILLER                         PIC X(206).
  1378*CIDMOD         16  FILLER                         PIC X(192).
  1379         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1380             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1381         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1382         16  CF-ST-VFY-2ND-BENE             PIC X.
  1383         16  CF-ST-CAUSAL-STATE             PIC X.
  1384         16  FILLER                         PIC X(185).
  1385
  1386****************************************************************
  1387*             BENEFIT MASTER RECORD                            *
  1388****************************************************************
  1389
  1390     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1391         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1392             20  CF-BENEFIT-CODE            PIC XX.
  1393             20  CF-BENEFIT-NUMERIC  REDEFINES
  1394                 CF-BENEFIT-CODE            PIC XX.
  1395             20  CF-BENEFIT-ALPHA           PIC XXX.
  1396             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1397             20  CF-BENEFIT-COMMENT         PIC X(10).
  1398
  1399             20  CF-LF-COVERAGE-TYPE        PIC X.
  1400                 88  CF-REDUCING                VALUE 'R'.
  1401                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1402
  1403             20  CF-SPECIAL-CALC-CD         PIC X.
  1404                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1405                 88  CF-NP-0-MO-INT             VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  26
* EL201.cbl
  1406                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1407                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1408                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1409                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1410                 88  CF-FARM-PLAN               VALUE 'F'.
  1411                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1412                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1413                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1414                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1415                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1416                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1417                 88  CF-PRUDENTIAL              VALUE 'P'.
  1418                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1419                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1420                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1421                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1422                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1423                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1424
  1425             20  CF-JOINT-INDICATOR         PIC X.
  1426                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1427
  1428*            20  FILLER                     PIC X(12).
  1429             20  FILLER                     PIC X(11).
  1430             20  CF-BENEFIT-CATEGORY        PIC X.
  1431             20  CF-LOAN-TYPE               PIC X(8).
  1432
  1433             20  CF-CO-REM-TERM-CALC        PIC X.
  1434                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1435                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1436                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1437                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1438                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1439
  1440             20  CF-CO-EARNINGS-CALC        PIC X.
  1441                 88  CO-EARN-BY-R78             VALUE '1'.
  1442                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1443                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1444                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1445                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1446                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1447                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1448                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1449
  1450             20  CF-CO-REFUND-CALC          PIC X.
  1451                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1452                 88  CO-REFD-BY-R78             VALUE '1'.
  1453                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1454                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1455                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1456                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1457                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1458                 88  CO-REFD-MEAN               VALUE '8'.
  1459                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1460                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1461                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1462
  1463             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  27
* EL201.cbl
  1464                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1465                 88  CO-OVRD-BY-R78             VALUE '1'.
  1466                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1467                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1468                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1469                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1470                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1471                 88  CO-OVRD-MEAN               VALUE '8'.
  1472                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1473
  1474             20  CF-CO-BEN-I-G-CD           PIC X.
  1475                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1476                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1477                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1478
  1479         16  FILLER                         PIC X(304).
  1480
  1481
  1482****************************************************************
  1483*             CARRIER MASTER RECORD                            *
  1484****************************************************************
  1485
  1486     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1487         16  CF-ADDRESS-DATA.
  1488             20  CF-MAIL-TO-NAME            PIC X(30).
  1489             20  CF-IN-CARE-OF              PIC X(30).
  1490             20  CF-ADDRESS-LINE-1          PIC X(30).
  1491             20  CF-ADDRESS-LINE-2          PIC X(30).
  1492             20  CF-CITY-STATE              PIC X(30).
  1493             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1494             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1495
  1496         16  CF-CLAIM-NO-CONTROL.
  1497             20  CF-CLAIM-NO-METHOD         PIC X.
  1498                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1499                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1500                 88  CLAIM-NO-SEQ               VALUE '3'.
  1501                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1502             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1503                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1504                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1505                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1506
  1507         16  CF-CHECK-NO-CONTROL.
  1508             20  CF-CHECK-NO-METHOD         PIC X.
  1509                 88  CHECK-NO-MANUAL            VALUE '1'.
  1510                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1511                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1512                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1513             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1514                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1515
  1516         16  CF-DOMICILE-STATE              PIC XX.
  1517
  1518         16  CF-EXPENSE-CONTROLS.
  1519             20  CF-EXPENSE-METHOD          PIC X.
  1520                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1521                 88  DOLLARS-PER-PMT            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  28
* EL201.cbl
  1522                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1523                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1524             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1525             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1526
  1527         16  CF-CORRESPONDENCE-CONTROL.
  1528             20  CF-LETTER-RESEND-OPT       PIC X.
  1529                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1530                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1531             20  FILLER                     PIC X(4).
  1532
  1533         16  CF-RESERVE-CONTROLS.
  1534             20  CF-MANUAL-SW               PIC X.
  1535                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1536             20  CF-FUTURE-SW               PIC X.
  1537                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1538             20  CF-PTC-SW                  PIC X.
  1539                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1540             20  CF-IBNR-SW                 PIC X.
  1541                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1542             20  CF-PTC-LF-SW               PIC X.
  1543                 88  CF-LF-PTC-USED             VALUE '1'.
  1544             20  CF-CDT-ACCESS-METHOD       PIC X.
  1545                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1546                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1547                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1548             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1549
  1550         16  CF-CLAIM-CALC-METHOD           PIC X.
  1551             88  360-PLUS-MONTHS                VALUE '1'.
  1552             88  365-PLUS-MONTHS                VALUE '2'.
  1553             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1554             88  360-DAILY                      VALUE '4'.
  1555             88  365-DAILY                      VALUE '5'.
  1556
  1557         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1558         16  FILLER                         PIC X(11).
  1559
  1560         16  CF-LIMIT-AMOUNTS.
  1561             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1562             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1563             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1564             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1565             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1566             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1567             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1568             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1569             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1570             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1571
  1572         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1573         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1574         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1575
  1576         16  CF-ZIP-CODE.
  1577             20  CF-ZIP-PRIME.
  1578                 24  CF-ZIP-1ST             PIC X.
  1579                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  29
* EL201.cbl
  1580                 24  FILLER                 PIC X(4).
  1581             20  CF-ZIP-PLUS4               PIC X(4).
  1582         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1583             20  CF-CAN-POSTAL-1            PIC XXX.
  1584             20  CF-CAN-POSTAL-2            PIC XXX.
  1585             20  FILLER                     PIC XXX.
  1586
  1587         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1588         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1589         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1590
  1591         16  CF-RATING-SWITCH               PIC X.
  1592             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1593             88  CF-NO-RATING                   VALUE 'N'.
  1594
  1595         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1596
  1597         16  CF-CARRIER-OVER-SHORT.
  1598             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1599             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1600
  1601         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1602         16  CF-SECPAY-SWITCH               PIC X.
  1603             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1604             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1605         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1606         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1607         16  FILLER                         PIC X(444).
  1608*        16  FILLER                         PIC X(452).
  1609
  1610
  1611****************************************************************
  1612*             MORTALITY MASTER RECORD                          *
  1613****************************************************************
  1614
  1615     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1616         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1617                                INDEXED BY CF-MORT-NDX.
  1618             20  CF-MORT-TABLE              PIC X(5).
  1619             20  CF-MORT-TABLE-TYPE         PIC X.
  1620                 88  CF-MORT-JOINT              VALUE 'J'.
  1621                 88  CF-MORT-SINGLE             VALUE 'S'.
  1622                 88  CF-MORT-COMBINED           VALUE 'C'.
  1623                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1624                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1625             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1626             20  CF-MORT-AGE-METHOD         PIC XX.
  1627                 88  CF-AGE-LAST                VALUE 'AL'.
  1628                 88  CF-AGE-NEAR                VALUE 'AN'.
  1629             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1630             20  CF-MORT-ADJUSTMENT-DIRECTION
  1631                                            PIC X.
  1632                 88  CF-MINUS                   VALUE '-'.
  1633                 88  CF-PLUS                    VALUE '+'.
  1634             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1635             20  CF-MORT-JOINT-CODE         PIC X.
  1636                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1637             20  CF-MORT-PC-Q               PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  30
* EL201.cbl
  1638                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1639             20  CF-MORT-TABLE-CODE         PIC X(4).
  1640             20  CF-MORT-COMMENTS           PIC X(15).
  1641             20  FILLER                     PIC X(14).
  1642
  1643         16  FILLER                         PIC X(251).
  1644
  1645
  1646****************************************************************
  1647*             BUSSINESS TYPE MASTER RECORD                     *
  1648****************************************************************
  1649
  1650     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1651* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1652* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1653* AND RECORD 05 IS TYPES 81-99
  1654         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1655             20  CF-BUSINESS-TITLE          PIC  X(19).
  1656             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1657                                            PIC S9V9(4) COMP-3.
  1658             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1659             20  FILLER                     PIC  X.
  1660         16  FILLER                         PIC  X(248).
  1661
  1662
  1663****************************************************************
  1664*             TERMINAL MASTER RECORD                           *
  1665****************************************************************
  1666
  1667     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1668
  1669         16  CF-COMPANY-TERMINALS.
  1670             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1671                                  PIC X(4).
  1672         16  FILLER               PIC X(248).
  1673
  1674
  1675****************************************************************
  1676*             LIFE EDIT MASTER RECORD                          *
  1677****************************************************************
  1678
  1679     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1680         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1681             20  CF-LIFE-CODE-IN            PIC XX.
  1682             20  CF-LIFE-CODE-OUT           PIC XX.
  1683         16  FILLER                         PIC X(248).
  1684
  1685
  1686****************************************************************
  1687*             AH EDIT MASTER RECORD                            *
  1688****************************************************************
  1689
  1690     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1691         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1692             20  CF-AH-CODE-IN              PIC XXX.
  1693             20  CF-AH-CODE-OUT             PIC XX.
  1694         16  FILLER                         PIC X(248).
  1695
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  31
* EL201.cbl
  1696
  1697****************************************************************
  1698*             CREDIBILITY TABLES                               *
  1699****************************************************************
  1700
  1701     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1702         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1703                             INDEXED BY CF-CRDB-NDX.
  1704             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1705             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1706             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1707         16  FILLER                         PIC  X(332).
  1708
  1709
  1710****************************************************************
  1711*             REPORT CUSTOMIZATION RECORD                      *
  1712****************************************************************
  1713
  1714     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1715         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1716             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1717             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1718             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1719**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1720****       A T-TRANSFER.                                   ****
  1721             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1722
  1723         16  FILLER                         PIC XX.
  1724
  1725         16  CF-CARRIER-CNTL-OPT.
  1726             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1727                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1728                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1729             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1730                                            PIC X.
  1731         16  CF-GROUP-CNTL-OPT.
  1732             20  CF-GROUP-OPT-SEQ           PIC 9.
  1733                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1734                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1735             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1736                                            PIC X(6).
  1737         16  CF-STATE-CNTL-OPT.
  1738             20  CF-STATE-OPT-SEQ           PIC 9.
  1739                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1740                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1741             20  CF-STATE-SELECT OCCURS 3 TIMES
  1742                                            PIC XX.
  1743         16  CF-ACCOUNT-CNTL-OPT.
  1744             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1745                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1746                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1747             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1748                                            PIC X(10).
  1749         16  CF-BUS-TYP-CNTL-OPT.
  1750             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1751                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1752                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1753             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  32
* EL201.cbl
  1754                                            PIC XX.
  1755         16  CF-LF-TYP-CNTL-OPT.
  1756             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1757                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1758                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1759             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1760                                            PIC XX.
  1761         16  CF-AH-TYP-CNTL-OPT.
  1762             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1763                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1764                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1765             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1766                                            PIC XX.
  1767         16  CF-REPTCD1-CNTL-OPT.
  1768             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1769                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1770                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1771             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1772                                            PIC X(10).
  1773         16  CF-REPTCD2-CNTL-OPT.
  1774             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1775                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1776                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1777             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1778                                            PIC X(10).
  1779         16  CF-USER1-CNTL-OPT.
  1780             20  CF-USER1-OPT-SEQ           PIC 9.
  1781                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1782                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1783             20  CF-USER1-SELECT OCCURS 3 TIMES
  1784                                            PIC X(10).
  1785         16  CF-USER2-CNTL-OPT.
  1786             20  CF-USER2-OPT-SEQ           PIC 9.
  1787                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1788                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1789             20  CF-USER2-SELECT OCCURS 3 TIMES
  1790                                            PIC X(10).
  1791         16  CF-USER3-CNTL-OPT.
  1792             20  CF-USER3-OPT-SEQ           PIC 9.
  1793                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1794                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1795             20  CF-USER3-SELECT OCCURS 3 TIMES
  1796                                            PIC X(10).
  1797         16  CF-USER4-CNTL-OPT.
  1798             20  CF-USER4-OPT-SEQ           PIC 9.
  1799                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1800                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1801             20  CF-USER4-SELECT OCCURS 3 TIMES
  1802                                            PIC X(10).
  1803         16  CF-USER5-CNTL-OPT.
  1804             20  CF-USER5-OPT-SEQ           PIC 9.
  1805                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1806                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1807             20  CF-USER5-SELECT OCCURS 3 TIMES
  1808                                            PIC X(10).
  1809         16  CF-REINS-CNTL-OPT.
  1810             20  CF-REINS-OPT-SEQ           PIC 9.
  1811                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  33
* EL201.cbl
  1812                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1813             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1814                 24  CF-REINS-PRIME         PIC XXX.
  1815                 24  CF-REINS-SUB           PIC XXX.
  1816
  1817         16  CF-AGENT-CNTL-OPT.
  1818             20  CF-AGENT-OPT-SEQ           PIC 9.
  1819                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1820                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1821             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1822                                            PIC X(10).
  1823
  1824         16  FILLER                         PIC X(43).
  1825
  1826         16  CF-LOSS-RATIO-SELECT.
  1827             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1828             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1829         16  CF-ENTRY-DATE-SELECT.
  1830             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1831             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1832         16  CF-EFFECTIVE-DATE-SELECT.
  1833             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1834             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1835
  1836         16  CF-EXCEPTION-LIST-IND          PIC X.
  1837             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1838
  1839         16  FILLER                         PIC X(318).
  1840
  1841****************************************************************
  1842*                  EXCEPTION REPORTING RECORD                  *
  1843****************************************************************
  1844
  1845     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1846         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1847             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1848
  1849         16  CF-COMBINED-LIFE-AH-OPT.
  1850             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1851             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1852             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1853             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1854
  1855         16  CF-LIFE-OPT.
  1856             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1857             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1858             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1859             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1860             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1861             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1862             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1863             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1864             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1865             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1866
  1867         16  CF-AH-OPT.
  1868             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1869             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  34
* EL201.cbl
  1870             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1871             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1872             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1873             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1874             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1875             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1876             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1877             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1878
  1879         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1880             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1881             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1882             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1883
  1884         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1885
  1886         16  FILLER                         PIC X(673).
  1887
  1888
  1889****************************************************************
  1890*             MORTGAGE SYSTEM PLAN RECORD                      *
  1891****************************************************************
  1892
  1893     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1894         16  CF-PLAN-TYPE                   PIC X.
  1895             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1896             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1897             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1898         16  CF-PLAN-ABBREV                 PIC XXX.
  1899         16  CF-PLAN-DESCRIPT               PIC X(10).
  1900         16  CF-PLAN-NOTES                  PIC X(20).
  1901         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1902         16  CF-PLAN-UNDERWRITING.
  1903             20  CF-PLAN-TERM-DATA.
  1904                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1905                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1906             20  CF-PLAN-AGE-DATA.
  1907                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1908                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1909                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1910             20  CF-PLAN-BENEFIT-DATA.
  1911                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1912                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1913                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1914                                            PIC S9(7)V99  COMP-3.
  1915         16  CF-PLAN-POLICY-FORMS.
  1916             20  CF-POLICY-FORM             PIC X(12).
  1917             20  CF-MASTER-APPLICATION      PIC X(12).
  1918             20  CF-MASTER-POLICY           PIC X(12).
  1919         16  CF-PLAN-RATING.
  1920             20  CF-RATE-CODE               PIC X(5).
  1921             20  CF-SEX-RATING              PIC X.
  1922                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1923                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1924             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1925             20  CF-SUB-STD-TYPE            PIC X.
  1926                 88  CF-PCT-OF-PREM            VALUE '1'.
  1927                 88  CF-PCT-OF-BENE            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  35
* EL201.cbl
  1928         16  CF-PLAN-PREM-TOLERANCES.
  1929             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1930             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1931         16  CF-PLAN-PYMT-TOLERANCES.
  1932             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1933             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1934         16  CF-PLAN-MISC-DATA.
  1935             20  FILLER                     PIC X.
  1936             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1937             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1938         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1939         16  CF-PLAN-IND-GRP                PIC X.
  1940             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1941                                                     '1'.
  1942             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1943                                                     '2'.
  1944         16  CF-MIB-SEARCH-SW               PIC X.
  1945             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1946             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1947             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1948             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1949         16  CF-ALPHA-SEARCH-SW             PIC X.
  1950             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1951             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1952             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1953             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1954             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1955             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1956             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1957             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1958             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1959             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1960                                                     'A' 'B' 'C'
  1961                                                     'X' 'Y' 'Z'.
  1962         16  CF-EFF-DT-RULE-SW              PIC X.
  1963             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1964             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1965             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1966             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1967             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1968         16  FILLER                         PIC X(4).
  1969         16  CF-HEALTH-QUESTIONS            PIC X.
  1970             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1971         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1972         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1973         16  CF-PLAN-SNGL-JNT               PIC X.
  1974             88  CF-COMBINED-PLAN              VALUE 'C'.
  1975             88  CF-JNT-PLAN                   VALUE 'J'.
  1976             88  CF-SNGL-PLAN                  VALUE 'S'.
  1977         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1978         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1979         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1980         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1981         16  CF-RERATE-CNTL                 PIC  X.
  1982             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1983             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1984             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1985             88  CF-AUTO-RECALC                 VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  36
* EL201.cbl
  1986         16  CF-BENEFIT-TYPE                PIC  X.
  1987             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1988             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1989         16  CF-POLICY-FEE                  PIC S999V99
  1990                                                    COMP-3.
  1991         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1992         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  1993         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1994         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1995         16  FILLER                         PIC  X(32).
  1996         16  CF-TERMINATION-FORM            PIC  X(04).
  1997         16  FILLER                         PIC  X(08).
  1998         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1999                                                       COMP-3.
  2000         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2001         16  CF-ISSUE-LETTER                PIC  X(4).
  2002         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2003         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2004             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2005             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2006         16  CF-MP-REFUND-CALC              PIC X.
  2007             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2008             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2009             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2010             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2011             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2012             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2013             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2014             88  CF-MP-REFD-MEAN                VALUE '8'.
  2015         16  CF-ALT-RATE-CODE               PIC  X(5).
  2016
  2017
  2018         16  FILLER                         PIC X(498).
  2019****************************************************************
  2020*             MORTGAGE COMPANY MASTER RECORD                   *
  2021****************************************************************
  2022
  2023     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2024         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2025         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2026             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2027             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2028             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2029             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2030             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2031
  2032         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2033         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2034         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2035         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2036         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2037
  2038         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2039             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2040         16  CF-MP-RECON-USE-IND            PIC X(1).
  2041             88  CF-MP-USE-RECON             VALUE 'Y'.
  2042         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2043             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  37
* EL201.cbl
  2044         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2045             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2046             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2047         16  FILLER                         PIC X(1).
  2048         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2049             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2050         16  CF-MORTG-MIB-VERSION           PIC X.
  2051             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2052             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2053             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2054         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2055             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2056                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2057             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2058                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2059             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2060                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2061             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2062                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2063             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2064                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2065             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2066                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2067         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2068         16  FILLER                         PIC X(7).
  2069         16  CF-MORTG-DESTINATION-SYMBOL.
  2070             20  CF-MORTG-MIB-COMM          PIC X(5).
  2071             20  CF-MORTG-MIB-TERM          PIC X(5).
  2072         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2073             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2074         16  FILLER                         PIC X(03).
  2075         16  CF-MP-CHECK-NO-CONTROL.
  2076             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2077                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2078                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2079                                                ' ' LOW-VALUES.
  2080                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2081                                               VALUE '3'.
  2082         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2083         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2084         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2085             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2086                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2087             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2088                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2089             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2090                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2091             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2092                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2093             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2094                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2095             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2096                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2097         16  CF-MORTG-BILLING-AREA.
  2098             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2099                                            PIC X.
  2100         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2101         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  38
* EL201.cbl
  2102         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2103         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2104             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2105             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2106         16  FILLER                         PIC X.
  2107         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2108             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2109             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2110         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2111         16  FILLER                         PIC X(8).
  2112         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2113         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2114         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2115         16  CF-ACH-COMPANY-ID.
  2116             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2117                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2118                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2119                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2120             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2121         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2122             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2123         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2124             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2125             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2126         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2127         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2128         16  FILLER                         PIC X(536).
  2129
  2130****************************************************************
  2131*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2132****************************************************************
  2133
  2134     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2135         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2136             20  CF-FEMALE-HEIGHT.
  2137                 24  CF-FEMALE-FT           PIC 99.
  2138                 24  CF-FEMALE-IN           PIC 99.
  2139             20  CF-FEMALE-MIN-WT           PIC 999.
  2140             20  CF-FEMALE-MAX-WT           PIC 999.
  2141         16  FILLER                         PIC X(428).
  2142
  2143     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2144         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2145             20  CF-MALE-HEIGHT.
  2146                 24  CF-MALE-FT             PIC 99.
  2147                 24  CF-MALE-IN             PIC 99.
  2148             20  CF-MALE-MIN-WT             PIC 999.
  2149             20  CF-MALE-MAX-WT             PIC 999.
  2150         16  FILLER                         PIC X(428).
  2151******************************************************************
  2152*             AUTOMATIC ACTIVITY RECORD                          *
  2153******************************************************************
  2154     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2155         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2156             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2157             20  CF-SYS-LETTER-ID           PIC X(04).
  2158             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2159             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  39
* EL201.cbl
  2160             20  CF-SYS-RESET-SW            PIC X(01).
  2161             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2162             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2163
  2164         16  FILLER                         PIC X(50).
  2165
  2166         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2167             20  CF-USER-ACTIVE-SW          PIC X(01).
  2168             20  CF-USER-LETTER-ID          PIC X(04).
  2169             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2170             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2171             20  CF-USER-RESET-SW           PIC X(01).
  2172             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2173             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2174             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2175
  2176         16  FILLER                         PIC X(246).
  2177 01  ws-heading1.
  2178     05  ws-head1                pic x(120)  value '
  2179-     '                                   DAILY CHECK RECONCILIATI
  2180-     'ON                                            '.
  2181     05  ws-h1-rpt-id            pic x(6)  value 'EL201A'.
  2182 01  ws-heading2.
  2183     05  filler                  pic x(51) value spaces.
  2184     05  WS-H2-CLIENT-NAME       PIC X(59) VALUE SPACES.
  2185     05  WS-H2-DATE              PIC X(10).
  2186     05  ws-h2-time              pic x(8).
  2187 01  ws-heading3.
  2188     05  filler                  pic x(53) value spaces.
  2189     05  WS-H3-DATE              PIC X(67) VALUE SPACES.
  2190     05  FILLER                  PIC X(5)  VALUE 'PAGE '.
  2191     05  WS-H3-PAGE              PIC ZZ,ZZ9.
  2192 01  ws-heading4.
  2193     05  filler                  pic x(117)   value ' CAR  GROUP
  2194-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2195-        '  CHECK CASHED DT   PREPARER   AMOUNT    MESSAGE'.
  2196 01  ws-hd1-written.
  2197     05  filler                  pic x(120)  value '
  2198-     '                                   DAILY WRITTEN CHECKS REP
  2199-     'ORT                                           '.
  2200 01  ws-hd4-written.
  2201     05  filler                  pic x(117)   value ' CAR  GROUP
  2202-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2203-        '  CHECK WRITTEN DT  PREPARER   AMOUNT    MESSAGE'.
  2204 01  ws-detail1.
  2205     05  filler                  pic xx value '  '.
  2206     05  ws-d1-carr              pic x(4).
  2207     05  ws-d1-grp               pic x(7).
  2208     05  ws-d1-state             pic x(4).
  2209     05  ws-d1-account           pic x(12).
  2210     05  ws-d1-eff-dt            pic x(12).
  2211     05  ws-d1-cert-no           pic x(14).
  2212     05  ws-d1-chk-type          pic x(5).
  2213     05  ws-d1-chk-no            pic x(12).
  2214     05  f                       pic xx.
  2215     05  ws-d1-writ-cash-dt      pic x(16).
  2216     05  ws-d1-preparer          pic x(8).
  2217     05  ws-d1-chk-amt-a         pic x(10).
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  40
* EL201.cbl
  2218     05  ws-d1-chk-amt redefines
  2219         ws-d1-chk-amt-a         pic $$$,$$9.99.
  2220     05  filler                  pic xx.
  2221     05  ws-d1-message           pic x(20).
  2222 01  ws-detail2.
  2223     05  filler                  pic x(12) value '    PAYEE - '.
  2224     05  ws-d2-addr-line         pic x(120) value spaces.
  2225 01  ws-total1.
  2226     05  filler                  pic x(5) value '     '.
  2227     05  ws-t1-cnt               pic zzzz9  value zeros.
  2228     05  ws-t1-chks              pic x(24)  value spaces.
  2229     05  ws-t1-amount            pic $$,$$$,$$9.99 value zeros.
  2230 01  w-doctoken                  pic x(16).
  2231 01 output-data.
  2232    05  filler                   pic x(6) value "TITLE=".
  2233    05  output-title             pic x(26) value 'Check Posting'.
  2234    05  filler                   pic x(8) value "&COMPID=".
  2235    05  out-comp-id              pic xxx.
  2236    05  filler                   pic x(5) value "&MSG=".
  2237    05  output-msg               pic x(50).
  2238 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
  2239     'cd /apps/prod/cid1p/jcl'.
  2240 01  TRAN-DATA-LINE2.
  2241     05  filler                  pic x(10) value 'unikixjob '.
  2242     05  tdl2-job                pic x(8) value 'cilg201b'.
  2243     05  filler                  pic x(9) value ' -k cid1p'.
  2244     05  filler                  pic x(51) value spaces.
  2245****************************************************************
  2246*
  2247* Copyright (c) 2007 by Clerity Solutions, Inc.
  2248* All rights reserved.
  2249*
  2250****************************************************************
  2251 01  DFHEIV.
  2252   02  DFHEIV0               PIC X(35).
  2253   02  DFHEIV1               PIC X(08).
  2254   02  DFHEIV2               PIC X(08).
  2255   02  DFHEIV3               PIC X(08).
  2256   02  DFHEIV4               PIC X(06).
  2257   02  DFHEIV5               PIC X(04).
  2258   02  DFHEIV6               PIC X(04).
  2259   02  DFHEIV7               PIC X(02).
  2260   02  DFHEIV8               PIC X(02).
  2261   02  DFHEIV9               PIC X(01).
  2262   02  DFHEIV10              PIC S9(7) COMP-3.
  2263   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2264   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2265   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2266   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2267   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2268   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2269   02  DFHEIV17              PIC X(04).
  2270   02  DFHEIV18              PIC X(04).
  2271   02  DFHEIV19              PIC X(04).
  2272   02  DFHEIV20              USAGE IS POINTER.
  2273   02  DFHEIV21              USAGE IS POINTER.
  2274   02  DFHEIV22              USAGE IS POINTER.
  2275   02  DFHEIV23              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  41
* EL201.cbl
  2276   02  DFHEIV24              USAGE IS POINTER.
  2277   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2278   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2279   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2280   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2281   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2282   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2283   02  FILLER                PIC X(02).
  2284   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2285   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2286   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2287   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2288   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2289 LINKAGE  SECTION.
  2290*****************************************************************
  2291*                                                               *
  2292* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2293* All rights reserved.                                          *
  2294*                                                               *
  2295*****************************************************************
  2296 01  dfheiblk.
  2297     02  eibtime          pic s9(7) comp-3.
  2298     02  eibdate          pic s9(7) comp-3.
  2299     02  eibtrnid         pic x(4).
  2300     02  eibtaskn         pic s9(7) comp-3.
  2301     02  eibtrmid         pic x(4).
  2302     02  dfheigdi         pic s9(4) comp.
  2303     02  eibcposn         pic s9(4) comp.
  2304     02  eibcalen         pic s9(4) comp.
  2305     02  eibaid           pic x(1).
  2306     02  eibfiller1       pic x(1).
  2307     02  eibfn            pic x(2).
  2308     02  eibfiller2       pic x(2).
  2309     02  eibrcode         pic x(6).
  2310     02  eibfiller3       pic x(2).
  2311     02  eibds            pic x(8).
  2312     02  eibreqid         pic x(8).
  2313     02  eibrsrce         pic x(8).
  2314     02  eibsync          pic x(1).
  2315     02  eibfree          pic x(1).
  2316     02  eibrecv          pic x(1).
  2317     02  eibsend          pic x(1).
  2318     02  eibatt           pic x(1).
  2319     02  eibeoc           pic x(1).
  2320     02  eibfmh           pic x(1).
  2321     02  eibcompl         pic x(1).
  2322     02  eibsig           pic x(1).
  2323     02  eibconf          pic x(1).
  2324     02  eiberr           pic x(1).
  2325     02  eibrldbk         pic x(1).
  2326     02  eiberrcd         pic x(4).
  2327     02  eibsynrb         pic x(1).
  2328     02  eibnodat         pic x(1).
  2329     02  eibfiller5       pic x(2).
  2330     02  eibresp          pic 9(09) comp.
  2331     02  eibresp2         pic 9(09) comp.
  2332     02  dfheigdj         pic s9(4) comp.
  2333     02  dfheigdk         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  42
* EL201.cbl
  2334 01  DFHCOMMAREA       PIC X(01).
  2335 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  2336 0000-DFHEXIT SECTION.
  2337     MOVE '9#                    $   ' TO DFHEIV0.
  2338     MOVE 'EL201' TO DFHEIV1.
  2339     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2340***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2341***                                                            ***
  2342***  Even though this program is using WEB Servies we don't    ***
  2343***  have any form fields to browse through, we are getting    ***
  2344***  the information we need through the variables that are    ***
  2345***  included in the URL. These variables are retrieved by     ***
  2346***  the           exec cics web extract                       ***
  2347***                   querystring  (data-value)                ***
  2348***                   querystrlen  (data-value)                ***
  2349***                end-exec                                    ***
  2350***  BTW, you must provide the length it isn't passed to you.  ***
  2351***  Allow for extra on the length or you will get a length    ***
  2352***  error instead of just truncation.                         ***
  2353***                                                            ***
  2354***  This program is expecting                                 ***
  2355*** http://slunikix:7001/cics/cwba/EL201?comp=CID&file=written***
  2356***                                                            ***
  2357***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2358     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  2359     move ws-fn-cymd             to dc-greg-date-cymd
  2360     move 'L'                    to dc-option-code
  2361     perform 9700-date-convert   thru 9700-exit
  2362     if no-conversion-error
  2363        move dc-greg-date-1-alpha to ws-h3-date
  2364        move dc-greg-date-1-edit to ws-h2-date
  2365     else
  2366        display ' error current dt invalid ' dc-error-code
  2367     end-if
  2368     string ws-fn-hours   ':'
  2369            ws-fn-minutes ':'
  2370            ws-fn-seconds
  2371        delimited by size into ws-h2-time
  2372     end-string
  2373
  2374* exec cics web extract
  2375*       querystring  (ws-qry-string)
  2376*       querystrlen  (ws-qrystr-len)
  2377*    end-exec
  2378*    MOVE 'X0  QL                .   #00002276' TO DFHEIV0
  2379     MOVE X'58302020514C202020202020' TO DFHEIV0(1:12)
  2380     MOVE X'202020202020202020202E20' TO DFHEIV0(13:12)
  2381     MOVE X'2020233030303032323736' TO DFHEIV0(25:11)
  2382     CALL 'kxdfhei1' USING DFHEIV0,
  2383           DFHEIV99,
  2384           DFHEIV99,
  2385           ws-qry-string,
  2386           ws-qrystr-len,
  2387           DFHEIV99,
  2388           DFHEIV99,
  2389           DFHEIV99,
  2390           DFHEIV99,
  2391           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  43
* EL201.cbl
  2392           DFHEIV99,
  2393           DFHEIV99,
  2394           DFHEIV99,
  2395           DFHEIV99
  2396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2397     move ws-qry-string (6:3)    to ws-comp-id
  2398                                    out-comp-id
  2399     move 'Successful Run   '    to output-msg
  2400     move ws-comp-id             to elcntl-key
  2401     move '1'                    to elcntl-rec-type
  2402     move +0                     to elcntl-seq
  2403
  2404* exec cics read
  2405*       dataset  ('ELCNTL')
  2406*       into     (control-file)
  2407*       ridfld   (elcntl-key)
  2408*       resp     (ws-response)
  2409*    end-exec
  2410     MOVE LENGTH OF
  2411      control-file
  2412       TO DFHEIV11
  2413     MOVE 'ELCNTL' TO DFHEIV1
  2414*    MOVE '&"IL       E          (  N#00002286' TO DFHEIV0
  2415     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2416     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2417     MOVE X'204E233030303032323836' TO DFHEIV0(25:11)
  2418     CALL 'kxdfhei1' USING DFHEIV0,
  2419           DFHEIV1,
  2420           control-file,
  2421           DFHEIV11,
  2422           elcntl-key,
  2423           DFHEIV99,
  2424           DFHEIV99,
  2425           DFHEIV99
  2426     MOVE EIBRESP  TO ws-response
  2427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2428     if resp-normal
  2429        move cf-cl-mail-to-name  to ws-h2-client-name
  2430        move cf-company-cd       to ws-comp-cd
  2431     else
  2432        move 'Company Rec not found ' to ws-h2-client-name
  2433                                         output-msg
  2434        display ' error elcntl read ' ws-response ' '
  2435           elcntl-key (1:8)
  2436        go to 0000-return
  2437     end-if
  2438     evaluate true
  2439        when ws-qry-string (15:7) = 'written' or 'WRITTEN'
  2440           set process-written      to true
  2441           perform 2000-process-written
  2442                                 thru 2000-exit
  2443        when other
  2444           move 'Invalid File ' to output-msg
  2445     end-evaluate
  2446     if connected-to-db
  2447        EXEC SQL
  2448            commit work release
  2449        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  44
* EL201.cbl
  2450        if sqlcode not = 0
  2451           move ' Failed to Commit DB '
  2452                                 to output-msg
  2453           display "Error: commit release "
  2454           display ' sql return code ' sqlcode
  2455           display ' sql err mess    ' sqlerrmc
  2456        end-if
  2457     end-if
  2458     .
  2459 0000-return.
  2460     perform 1030-send-form      thru 1030-exit
  2461
  2462* exec cics
  2463*       return
  2464*    end-exec
  2465*    MOVE '.(                    ''   #00002325' TO DFHEIV0
  2466     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2467     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2468     MOVE X'2020233030303032333235' TO DFHEIV0(25:11)
  2469     CALL 'kxdfhei1' USING DFHEIV0,
  2470           DFHEIV99,
  2471           DFHEIV99,
  2472           DFHEIV99,
  2473           DFHEIV99,
  2474           DFHEIV99,
  2475           DFHEIV99
  2476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2477     .
  2478 1000-CONNECT-DB.
  2479     move 'NTCSO2_ChkApprv'      to svr
  2480     move 'sa'                   to usr
  2481     move 'ntcso2'               to pass
  2482     string
  2483         usr delimited space
  2484         "." delimited size
  2485         pass delimited space into usr-pass
  2486     end-string
  2487     EXEC SQL
  2488        CONNECT TO :svr USER :usr-pass
  2489     END-EXEC
  2490     if sqlcode not = 0
  2491        display "Error: cannot connect "
  2492        display sqlcode
  2493        display sqlerrmc
  2494        move 'Failed to connect to DB'
  2495                                 to output-msg
  2496        go to 0000-return
  2497     else
  2498        set connected-to-db to true
  2499     end-if
  2500     .
  2501 1000-EXIT.
  2502     EXIT.
  2503 1020-read-erchek.
  2504     move ws-comp-cd             to ch-company-cd
  2505     move db-carrier             to ch-carrier
  2506     move db-grouping            to ch-grouping
  2507     move db-state               to ch-state
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  45
* EL201.cbl
  2508     move db-account             to ch-account
  2509     move db-certificate         to ch-cert-prime
  2510     move db-cert-sfx            to ch-cert-sfx
  2511     string db-effdate (1:4)
  2512            db-effdate (6:2)
  2513            db-effdate (9:2)
  2514        delimited by size into dc-greg-date-cymd-r
  2515     end-string
  2516     move 'L'                    to dc-option-code
  2517     perform 9700-date-convert   thru 9700-exit
  2518     if no-conversion-error
  2519        move dc-bin-date-1       to ch-cert-eff-dt
  2520     else
  2521        display ' error cvtdte eff dt ' db-effdate ' '
  2522           dc-error-code
  2523     end-if
  2524     move zeros                  to ws-seq-alpha
  2525     move +5                     to s2
  2526     perform varying s1 from +5 by -1 until s1 < +1
  2527        if db-seq-no (s1:1) numeric
  2528           move db-seq-no (s1:1) to ws-seq-alpha (s2:1)
  2529           subtract +1 from s2
  2530        end-if
  2531     end-perform
  2532     move ws-seq-no-num          to ch-sequence-no
  2533*    display ' dte   **' db-effdate '**'
  2534*    display ' carrier ' ch-carrier
  2535*    display ' group   ' ch-grouping
  2536*    display ' state   ' ch-state
  2537*    display ' acct    ' ch-account
  2538*    display ' cert  **' ch-cert-no '**'
  2539*    display ' seq     ' ch-sequence-no
  2540
  2541* exec cics read
  2542*       update
  2543*       dataset    ('ERCHEK')
  2544*       into       (check-records)
  2545*       ridfld     (ch-control-primary)
  2546*       resp       (ws-response)
  2547*    end-exec
  2548     MOVE LENGTH OF
  2549      check-records
  2550       TO DFHEIV11
  2551     MOVE 'ERCHEK' TO DFHEIV1
  2552*    MOVE '&"IL       EU         (  N#00002391' TO DFHEIV0
  2553     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2554     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2555     MOVE X'204E233030303032333931' TO DFHEIV0(25:11)
  2556     CALL 'kxdfhei1' USING DFHEIV0,
  2557           DFHEIV1,
  2558           check-records,
  2559           DFHEIV11,
  2560           ch-control-primary,
  2561           DFHEIV99,
  2562           DFHEIV99,
  2563           DFHEIV99
  2564     MOVE EIBRESP  TO ws-response
  2565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  46
* EL201.cbl
  2566     .
  2567 1020-exit.
  2568     exit.
  2569 1030-send-form.
  2570
  2571* exec cics document create
  2572*       doctoken   (w-doctoken)
  2573*       template   ('WCHECKS')
  2574*       symbollist (output-data)
  2575*       listlength (length of output-data)
  2576*    end-exec
  2577     MOVE 'WCHECKS'
  2578      TO DFHEIVL0
  2579     MOVE LENGTH OF
  2580      output-data TO DFHEIV16
  2581*    MOVE '\"D tSL               )   #00002402' TO DFHEIV0
  2582     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  2583     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2584     MOVE X'2020233030303032343032' TO DFHEIV0(25:11)
  2585     CALL 'kxdfhei1' USING DFHEIV0,
  2586           w-doctoken,
  2587           DFHEIV99,
  2588           DFHEIVL0,
  2589           output-data,
  2590           DFHEIV16,
  2591           DFHEIV99,
  2592           DFHEIV99,
  2593           DFHEIV99
  2594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2595
  2596* exec cics web send
  2597*       doctoken(w-doctoken)
  2598*    end-exec
  2599*    MOVE 'X$D                   *   #00002408' TO DFHEIV0
  2600     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  2601     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  2602     MOVE X'2020233030303032343038' TO DFHEIV0(25:11)
  2603     CALL 'kxdfhei1' USING DFHEIV0,
  2604           w-doctoken,
  2605           DFHEIV99,
  2606           DFHEIV99,
  2607           DFHEIV99,
  2608           DFHEIV99,
  2609           DFHEIV99,
  2610           DFHEIV99,
  2611           DFHEIV99,
  2612           DFHEIV99
  2613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2614     .
  2615 1030-exit.
  2616     exit.
  2617 1050-disconnect.
  2618     if connected-to-db
  2619        EXEC SQL
  2620            disconnect all
  2621        END-EXEC
  2622        move ' ' to ws-connect-sw
  2623     end-if
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  47
* EL201.cbl
  2624     .
  2625 1050-exit.
  2626     exit.
  2627 2000-process-written.
  2628     perform 2010-open-files     thru 2010-exit
  2629     perform 2020-init           thru 2020-exit
  2630     perform 2050-process-input  thru 2050-exit until
  2631        end-of-input
  2632     if ws-writ-cnt > zeros
  2633        move ws-writ-cnt         to ws-t1-cnt
  2634        move ' Written '         to ws-t1-chks
  2635        move ws-tot-writ-amt     to ws-t1-amount
  2636     else
  2637        perform 4010-write-headings
  2638                                 thru 4010-exit
  2639        move spaces              to ws-total1
  2640        string ' No checks for '
  2641           ws-writ-rpt-comp-id
  2642           ' today. ' delimited by size into ws-total1
  2643        end-string
  2644     end-if
  2645     move spaces                 to cps-written-rpt-rec
  2646     perform 4020-write-a-line   thru 4020-exit
  2647     move ws-total1              to cps-written-rpt-rec
  2648     perform 4020-write-a-line   thru 4020-exit
  2649     perform 2500-close-files    thru 2500-exit
  2650     perform 5000-submit-job     thru 5000-exit
  2651     .
  2652 2000-exit.
  2653     exit.
  2654 2010-open-files.
  2655     move function upper-case(ws-comp-id)
  2656                                 to ws-writ-rpt-comp-id
  2657     if ws-writ-rpt-comp-id = 'AHL'
  2658        move 'miscpymtsahl.csv'  to ws-writ-in-name
  2659     end-if
  2660     open input CPS-WRITTEN-IN
  2661         output CPS-WRITTEN-RPT
  2662     if written-status not = '00'
  2663        display 'error written open ' written-status
  2664        move ' Invalid or missing file '
  2665                                 to output-msg
  2666        go to 0000-return
  2667     end-if
  2668     .
  2669 2010-exit.
  2670     exit.
  2671 2020-init.
  2672     move spaces                 to ws-detail1
  2673     move ws-hd1-written         to ws-head1
  2674     move 'EL201B'               to ws-h1-rpt-id
  2675     move ws-hd4-written         to ws-heading4
  2676     move 'Posting of Written Checks '
  2677                                 to output-title
  2678     if ws-comp-id = 'AHL'
  2679        move 'ahlg201b'          to tdl2-job
  2680     else
  2681        move 'cilg201b'          to tdl2-job
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  48
* EL201.cbl
  2682     end-if
  2683     if not connected-to-db
  2684        perform 1000-connect-db  thru 1000-exit
  2685     end-if
  2686***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2687***                                                            ***
  2688**     I do 2 reads to bypass the header record                ***
  2689***                                                            ***
  2690***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2691     perform 2040-read-input     thru 2040-exit
  2692     perform 2040-read-input     thru 2040-exit
  2693     .
  2694 2020-exit.
  2695     exit.
  2696 2040-read-input.
  2697     read CPS-WRITTEN-IN at end
  2698        set end-of-input   to true
  2699     end-read
  2700     if not end-of-input
  2701        add 1 to ws-in-recs
  2702     end-if
  2703     .
  2704 2040-exit.
  2705     exit.
  2706 2050-process-input.
  2707     unstring cps-written-in-rec
  2708        delimited by ',' into
  2709           wsw-check-no
  2710           wsw-check-dt
  2711           wsw-check-amt
  2712           wsw-vendor-id
  2713           wsw-user-defined
  2714           wsw-voucher-ref
  2715     end-unstring
  2716*    display ' chk no    **' wsw-check-no '**'
  2717*    display ' chk dt    **' wsw-check-dt '**'
  2718*    display ' chk amt   **' wsw-check-amt '**'
  2719*    display ' vend id   **' wsw-vendor-id '**'
  2720*    display ' user def  **' wsw-user-defined '**'
  2721*    display ' vouch ref **' wsw-voucher-ref '**'
  2722     if (wsw-check-no = spaces)
  2723        and (wsw-check-dt = spaces)
  2724        and (wsw-check-amt = spaces)
  2725        display ' empty record ' cps-written-in-rec
  2726        go to 2050-read
  2727     end-if
  2728     string wsw-check-dt (1:4)
  2729            wsw-check-dt (6:2)
  2730            wsw-check-dt (9:2)
  2731        delimited by size into dc-greg-date-cymd-r
  2732     end-string
  2733     move 'L'                    to dc-option-code
  2734     perform 9700-date-convert   thru 9700-exit
  2735     if no-conversion-error
  2736        move dc-bin-date-1       to ws-bin-check-dt
  2737     else
  2738        display ' error cvtdte chek dt ' wsw-check-dt ' '
  2739           dc-error-code
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  49
* EL201.cbl
  2740     end-if
  2741     move spaces                 to wsw-check-key
  2742     perform varying s1 from +30 by -1 until
  2743        (s1 < +1)
  2744        or (wsw-user-defined (s1:1) numeric)
  2745     end-perform
  2746     if s1 > +7
  2747        move wsw-user-defined (s1 - 6:7)
  2748                                 to wsw-check-key
  2749     else
  2750        move 'invalid input '    to ws-d1-message
  2751        go to 2050-continue
  2752     end-if
  2753*    go to 2050-read
  2754     move ' '                    to ws-erchek-sw
  2755                                    ws-table-sw
  2756     perform 2200-get-tbl-row    thru 2200-exit
  2757     if sqlcode = 0
  2758        set table-found          to true
  2759        perform 1020-read-erchek thru 1020-exit
  2760        if resp-normal
  2761           set erchek-found to true
  2762           perform 2310-upd-erchek
  2763                                 thru 2310-exit
  2764           perform 2320-upd-table thru 2320-exit
  2765        else
  2766           display ' erchek not fnd ' ch-carrier ' ' ch-state ' '
  2767              ch-account ' ' db-effdate (1:10) ' ' db-certificate
  2768              ' ' ws-response
  2769           move ' chk rec not found ' to ws-d1-message
  2770        end-if
  2771     else
  2772        move ' tbl row not found ' to ws-d1-message
  2773     end-if
  2774     .
  2775 2050-continue.
  2776     perform 2400-build-print-line thru 2400-exit
  2777     .
  2778 2050-read.
  2779     perform 2040-read-input     thru 2040-exit
  2780     .
  2781 2050-exit.
  2782     exit.
  2783 2200-get-tbl-row.
  2784***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2785***                                                            ***
  2786***  I'm only expecting one row so no cursor is declared       ***
  2787***                                                            ***
  2788***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2789     move ws-comp-id             to ws-compid
  2790     move wsw-check-key-num      to ws-check-key
  2791     move 1                      to ws-type
  2792     exec sql
  2793        SELECT
  2794           CheckKey,
  2795           Company,
  2796           CertCarrier,
  2797           CertGroup,
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  50
* EL201.cbl
  2798           CertState,
  2799           CertAccount,
  2800           CertEffDate,
  2801           CertNumber,
  2802           CertNumberSuf,
  2803           CheckSeqNbr,
  2804           CheckType,
  2805           CheckAmount,
  2806           Preparer
  2807        INTO
  2808           :db-checkkey,
  2809           :db-compid,
  2810           :db-carrier,
  2811           :db-grouping,
  2812           :db-state,
  2813           :db-account,
  2814           :db-effdate,
  2815           :db-certificate,
  2816           :db-cert-sfx,
  2817           :db-seq-no,
  2818           :db-type,
  2819           :db-amount,
  2820           :db-preparer
  2821        FROM
  2822           ChkApp_Check
  2823        WHERE
  2824           (CheckKey    = :ws-check-key)
  2825           and (Company = :ws-compid)
  2826     end-exec
  2827     if sqlcode not = 0
  2828        move sqlcode to ws-sql-code
  2829        move ws-sql-code to ws-dis-sql-code
  2830        display ' dis sql code ' ws-dis-sql-code
  2831        display "Error: cannot read row "
  2832        display ' sql return code ' sqlcode
  2833        display ' sql err mess    ' sqlerrmc
  2834     end-if
  2835     .
  2836 2200-exit.
  2837     exit.
  2838 2310-upd-erchek.
  2839     move ws-bin-check-dt        to ch-check-written-dt
  2840     if wsw-check-no (1:1) = '"'
  2841        move wsw-check-no (5:7)  to ch-check-no
  2842     else
  2843        move wsw-check-no (4:7)  to ch-check-no
  2844     end-if
  2845*    move zeros                  to ws-response
  2846
  2847* exec cics rewrite
  2848*       dataset     ('ERCHEK')
  2849*       from        (check-records)
  2850*       resp        (ws-response)
  2851*    end-exec
  2852     MOVE LENGTH OF
  2853      check-records
  2854       TO DFHEIV11
  2855     MOVE 'ERCHEK' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  51
* EL201.cbl
  2856*    MOVE '&& L                  %  N#00002643' TO DFHEIV0
  2857     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2858     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2859     MOVE X'204E233030303032363433' TO DFHEIV0(25:11)
  2860     CALL 'kxdfhei1' USING DFHEIV0,
  2861           DFHEIV1,
  2862           check-records,
  2863           DFHEIV11,
  2864           DFHEIV99
  2865     MOVE EIBRESP  TO ws-response
  2866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2867     if resp-normal
  2868        add 1 to ws-writ-cnt
  2869        compute ws-tot-writ-amt =
  2870           ws-tot-writ-amt + ch-amount-paid
  2871        move 'Successful Post '  to ws-d1-message
  2872     else
  2873        move '*** ERROR - NOT POSTED ***' TO ws-d1-message
  2874     end-if
  2875     .
  2876 2310-exit.
  2877     exit.
  2878 2320-upd-table.
  2879     string wsw-check-dt (6:2) '/'
  2880            wsw-check-dt (9:2) '/'
  2881            wsw-check-dt (1:4)
  2882        delimited by size into db-checkdate
  2883     move ch-check-no            to db-checkno
  2884*    move zeros to sqlcode
  2885     EXEC SQL
  2886        UPDATE
  2887           ChkApp_Check
  2888        SET
  2889           CheckNumber = :db-checkno,
  2890           CheckDate = :db-checkdate
  2891        WHERE
  2892           CheckKey = :db-checkkey
  2893     END-EXEC
  2894     if sqlcode not = 0
  2895        move 'Table not updated ' to ws-d1-message
  2896        display "Error: cannot update table   "
  2897        display ' sql retrun code ' sqlcode
  2898        display ' sql err mess    ' sqlerrmc
  2899     end-if
  2900     .
  2901 2320-exit.
  2902     exit.
  2903 2400-build-print-line.
  2904     if table-found
  2905        move db-carrier          to ws-d1-carr
  2906        move db-grouping         to ws-d1-grp
  2907        move db-state            to ws-d1-state
  2908        move db-account          to ws-d1-account
  2909        string
  2910           db-effdate (6:2)   '/'
  2911           db-effdate (9:2)   '/'
  2912           db-effdate (1:4)
  2913           delimited by size into ws-d1-eff-dt
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  52
* EL201.cbl
  2914        end-string
  2915        move db-certificate      to ws-d1-cert-no
  2916        move db-cert-sfx         to ws-d1-cert-no (11:1)
  2917        move 'REF'               to ws-d1-chk-type
  2918        move +10                 to s2
  2919        move zeros               to ws-work-amt-alpha
  2920        perform varying s1 from +10 by -1 until s1 < +1
  2921           if db-amount (s1:1) numeric
  2922              move db-amount (s1:1)
  2923                                 to ws-work-amt-alpha (s2:1)
  2924              subtract +1 from s2
  2925           end-if
  2926        end-perform
  2927        move ws-work-amt-num     to ws-d1-chk-amt
  2928        move db-preparer         to ws-d1-preparer
  2929        move db-checkno          to ws-d1-chk-no
  2930        move db-checkdate        to ws-d1-writ-cash-dt
  2931     else
  2932        move wsw-check-no        to ws-d1-chk-no
  2933     end-if
  2934     perform 4000-write-report   thru 4000-exit
  2935     move spaces                 to ws-detail1
  2936     .
  2937 2400-exit.
  2938     exit.
  2939 2500-close-files.
  2940     close cps-written-in cps-written-rpt
  2941     .
  2942 2500-exit.
  2943     exit.
  2944 4000-write-report.
  2945     if ws-line-cntr > ws-max-lines
  2946        move zeros               to ws-line-cntr
  2947        perform 4010-write-headings thru 4010-exit
  2948     end-if
  2949     move ws-detail1             to cps-written-rpt-rec
  2950     perform 4020-write-a-line   thru 4020-exit
  2951     .
  2952 4000-exit.
  2953     exit.
  2954 4010-write-headings.
  2955     add 1 to ws-page-cntr
  2956     move ws-page-cntr           to ws-h3-page
  2957     move ws-heading1            to cps-written-rpt-rec
  2958     perform 4020-write-a-line   thru 4020-exit
  2959     move ws-heading2            to cps-written-rpt-rec
  2960     perform 4020-write-a-line   thru 4020-exit
  2961     move ws-heading3            to cps-written-rpt-rec
  2962     perform 4020-write-a-line   thru 4020-exit
  2963     move spaces                 to cps-written-rpt-rec
  2964     perform 4020-write-a-line   thru 4020-exit
  2965     move spaces                 to cps-written-rpt-rec
  2966     perform 4020-write-a-line   thru 4020-exit
  2967     move ws-heading4            to cps-written-rpt-rec
  2968     perform 4020-write-a-line   thru 4020-exit
  2969     move spaces                 to cps-written-rpt-rec
  2970     perform 4020-write-a-line   thru 4020-exit
  2971     .
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  53
* EL201.cbl
  2972 4010-exit.
  2973     exit.
  2974 4020-write-a-line.
  2975     write cps-written-rpt-rec
  2976     add 1 to ws-line-cntr
  2977     .
  2978 4020-exit.
  2979     exit.
  2980 5000-submit-job.
  2981
  2982* EXEC CICS WRITEQ TD
  2983*       QUEUE ('BTCH')
  2984*       FROM (TRAN-DATA-LINE1)
  2985*       LENGTH (80)
  2986*    END-EXEC
  2987     MOVE 80
  2988       TO DFHEIV11
  2989     MOVE 'BTCH' TO DFHEIV5
  2990*    MOVE '(" L                  &   #00002762' TO DFHEIV0
  2991     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  2992     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2993     MOVE X'2020233030303032373632' TO DFHEIV0(25:11)
  2994     CALL 'kxdfhei1' USING DFHEIV0,
  2995           DFHEIV5,
  2996           TRAN-DATA-LINE1,
  2997           DFHEIV11,
  2998           DFHEIV99,
  2999           DFHEIV99
  3000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3001
  3002* EXEC CICS WRITEQ TD
  3003*       QUEUE ('BTCH')
  3004*       FROM (TRAN-DATA-LINE2)
  3005*       LENGTH (80)
  3006*    END-EXEC
  3007     MOVE 80
  3008       TO DFHEIV11
  3009     MOVE 'BTCH' TO DFHEIV5
  3010*    MOVE '(" L                  &   #00002767' TO DFHEIV0
  3011     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  3012     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3013     MOVE X'2020233030303032373637' TO DFHEIV0(25:11)
  3014     CALL 'kxdfhei1' USING DFHEIV0,
  3015           DFHEIV5,
  3016           TRAN-DATA-LINE2,
  3017           DFHEIV11,
  3018           DFHEIV99,
  3019           DFHEIV99
  3020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3021     .
  3022 5000-exit.
  3023     exit.
  3024 9700-DATE-CONVERT.
  3025
  3026* EXEC CICS LINK
  3027*         PROGRAM  ('ELDATCV')
  3028*         COMMAREA (DATE-CONVERSION-DATA)
  3029*         LENGTH   (DC-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 20-Feb-14 13:00 Page  54
* EL201.cbl
  3030*    END-EXEC.
  3031     MOVE 'ELDATCV' TO DFHEIV1
  3032*    MOVE '."C                   (   #00002776' TO DFHEIV0
  3033     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3034     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3035     MOVE X'2020233030303032373736' TO DFHEIV0(25:11)
  3036     CALL 'kxdfhei1' USING DFHEIV0,
  3037           DFHEIV1,
  3038           DATE-CONVERSION-DATA,
  3039           DC-COMM-LENGTH,
  3040           DFHEIV99,
  3041           DFHEIV99,
  3042           DFHEIV99,
  3043           DFHEIV99
  3044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3045
  3046 9700-EXIT.
  3047      EXIT.
  3048
  3049 9999-DFHBACK SECTION.
  3050     MOVE '9%                    "   ' TO DFHEIV0
  3051     MOVE 'EL201' TO DFHEIV1
  3052     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3053     GOBACK.
  3054 9999-DFHEXIT.
  3055     IF DFHEIGDJ EQUAL 0001
  3056         NEXT SENTENCE.
  3057     MOVE '9%                    "   ' TO DFHEIV0
  3058     MOVE 'EL201' TO DFHEIV1
  3059     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3060     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      139268     Code:        8534
