* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   1
* ELRATE.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"ELRATE.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRATE.lst" LISTPATH
*          "" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRATE.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:20:51.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.012
     9
    10*AUTHOR.     LOGIC, INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   2
* ELRATE.cbl
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25******************************************************************
    26*  REMARKS   *                                                   *
    27*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    28*            *    OPTION SPECIFIED, COMPUTE PREMIUM AMOUNTS      *
    29*            *    AND RATES.                                     *
    30******************************************************************
    31
    32
    33******************************************************************
    34*                                                                *
    35*              INPUT FIELDS USED                                 *
    36*                                                                *
    37******************************************************************
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM    (RATING TERM)          *
    39*  CLASS CODE       - CP-CLASS-CODE                              *
    40*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    41*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    42*  RATING BENEFIT   - CP-RATING-BENEFIT-AMT (TOT BEN ON BALLOON) *
    43*  BENEFIT TYPE     - CP-BENEFIT-TYPE                            *
    44*  STATE CODE (NUM) - CP-STATE                                   *
    45*  STATE CODE       - CP-STATE-STD-ABBV                          *
    46*  COMPANY I.D.     - CP-COMPANY-ID                              *
    47*  COMPANY CD (NUM) - CP-COMPANY-CD                              *
    48*  INSURED AGE      - CP-ISSUE-AGE                               *
    49*  RATING METHOD    - CP-EARNING-METHOD                          *
    50*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    51*  A.P.R.           - CP-LOAN-APR                                *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    54*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   3
* ELRATE.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELRATE  WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '***********VMOD 2.012 **********'.
    65
    66***  Y2K PROJ 7744
    67 01  WS-HOLD-RATE-EXP.
    68     05  WS-HOLD-RATE-EXP-AL PIC X(11).
    69     05  WS-HOLD-RATE-EXP-DT REDEFINES
    70         WS-HOLD-RATE-EXP-AL PIC 9(11).
    71***  Y2K PROJ 7744
    72
    73*                            COPY ELCRATWS.
    74******************************************************************
    75*                                                                *
    76*                                                                *
    77*                            ELCRATWS.                           *
    78*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    79*                            VMOD=2.010                          *
    80*                                                                *
    81******************************************************************
    82
    83 01  STANDARD-AREAS.
    84     12  ER-STATUS               PIC XX.
    85     12  WS-BROWSE-SW            PIC X       VALUE SPACE.
    86         88 WS-BROWSE-STARTED                VALUE 'Y'.
    87     12  WS-PREMIUM-RATE         PIC S99V9(5) COMP-3 VALUE ZERO.
    88     12  WS-FARM-TERM            PIC S9(3)    COMP-3 VALUE ZERO.
    89     12  OERATE-FILE-ID          PIC X(8)    VALUE 'OERATE'.
    90     12  ERRATE-FILE-ID          PIC X(8)    VALUE 'ERRATE'.
    91     12  ERRATE-KEY.
    92         16  RATE-COMPANY-CD     PIC X        VALUE SPACE.
    93         16  RATE-STATE-CODE.
    94             20  RATE-ST-CODE    PIC  XX      VALUE SPACES.
    95             20  RATE-ST-CLASS   PIC  XX      VALUE SPACES.
    96             20  RATE-ST-DEV     PIC  XXX     VALUE SPACES.
    97         16  RATE-L-AH-CODE.
    98             20  RATE-L-AH       PIC  X       VALUE SPACE.
    99             20  RATE-LAH-NUM    PIC  XX      VALUE ZEROS.
   100         16  RATE-LIMITS.
   101             20  RATE-HIGH-AGE   PIC  99      VALUE ZEROS.
   102             20  RATE-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   103             20  RATE-FUTURE     PIC  XX      VALUE SPACES.
   104             20  RATE-SEX        PIC  X       VALUE '9'.
   105         16  RATE-EXPIRY-DATE    PIC 9(11)    COMP-3.
   106
   107     12  SAVE-ERRATE-KEY.
   108         16  SVRT-COMPANY-CD     PIC X        VALUE SPACE.
   109         16  SVRT-STATE-CODE.
   110             20  SVRT-ST-CODE    PIC  XX      VALUE SPACES.
   111             20  SVRT-ST-CLASS   PIC  XX      VALUE SPACES.
   112             20  SVRT-ST-DEV     PIC  XXX     VALUE SPACES.
   113         16  SVRT-L-AH-CODE.
   114             20  SVRT-L-AH       PIC  X       VALUE SPACE.
   115             20  SVRT-LAH-NUM    PIC  XX      VALUE ZEROS.
   116         16  SVRT-LIMITS.
   117             20  SVRT-HIGH-AGE   PIC  99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   4
* ELRATE.cbl
   118             20  SVRT-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   119             20  SVRT-FUTURE     PIC  XX      VALUE SPACES.
   120             20  SVRT-SEX        PIC  X       VALUE '9'.
   121         16  SVRT-EXPIRY-DATE    PIC  9(11)   COMP-3.
   122
   123     12  WS-SIN-PREM-RATE        PIC S99V9(07) VALUE +0.
   124     12  WS-TERM-MINUS-ONE       PIC S9(5)    COMP-3 VALUE +0.
   125
   126 01  CSL-WORK-AREAS          COMP-3.
   127     12  WK-C                PIC S9(3)V9(9)     VALUE ZEROS.
   128     12  WK-D                PIC S9(4)V9(9)     VALUE ZEROS.
   129     12  WK-J                PIC S999           VALUE ZEROS.
   130     12  WK-K                PIC S999           VALUE ZEROS.
   131     12  WK-L                PIC S99V9(9)       VALUE ZEROS.
   132     12  WK-S                PIC S999V9(4)      VALUE ZEROS.
   133     12  WK-T                PIC S999           VALUE ZEROS.
   134     12  WK-T1               PIC S999           VALUE ZEROS.
   135     12  WK-U                PIC S99V9(9)       VALUE ZEROS.
   136     12  WK-PREM             PIC S9(6)V999      VALUE ZEROS.
   137     12  WK-PAY-AMT          PIC S9(7)V99       VALUE ZEROS.
   138     12  WK-LEV-RATE         PIC S99V9(7)       VALUE ZEROS.
   139     12  WK-RED-RATE         PIC S99V9(7)       VALUE ZEROS.
   140     12  WK-DAILY-RATE       PIC S99V9(7)       VALUE ZEROS.
   141     12  WK-MONTHLY-RATE     PIC S99V9(7)       VALUE ZEROS.
   142     12  WK-MONTHLY-RATE-T   PIC S99V9(7)       VALUE ZEROS.
   143     12  WK-MONTHLY-RATE-J   PIC S99V9(7)       VALUE ZEROS.
   144     12  WS-MAX-TOT-BEN      PIC S9(7)V99       VALUE ZEROS.
   145     12  WS-MAX-MON-BEN      PIC S9(7)V99       VALUE ZEROS.
   146     12  WS-NUM-PAYMTS       PIC S9(5)          VALUE ZEROS.
   147     12  WS-PAY-SCH          PIC S99            VALUE ZEROS.
   148
   149 01  TEXAS-REG-WORK-AREAS.
   150     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.
   151     12  TEX-FACT-2          PIC S9(3)       COMP-3.
   152     12  TEX-FACT-3          PIC S9(3)       COMP-3.
   153     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   154     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   155     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   156     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   157     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   158     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   159
   160 01  NET-PAY-INTERFACE.
   161     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   162     12  N-P-ORIG            PIC S9(3)       COMP-3.
   163     12  N-P-REM             PIC S9(3)       COMP-3.
   164     12  N-P-OPT             PIC X.
   165     12  N-P-LOAN            PIC S9(3)       COMP-3.
   166     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   167
   168
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   5
* ELRATE.cbl
   170*                            COPY ERCNETWS.
   171*****************************************************************
   172*                                                               *
   173*                                                               *
   174*                            ERCNETWS                           *
   175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   176*                            VMOD=2.014                         *
   177*                                                               *
   178*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   179*                                                               *
   180*****************************************************************.
   181*                   C H A N G E   L O G
   182*
   183* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   184*-----------------------------------------------------------------
   185*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   186* EFFECTIVE    NUMBER
   187*-----------------------------------------------------------------
   188* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   189* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   190* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   191******************************************************************
   192
   193 01  NET-PAY-WORK-AREA.
   194     12  OPTION-SW               PIC X   VALUE 'X'.
   195        88  NPO-STD         VALUE SPACE.
   196        88  NPO-ALT         VALUE 'A'.
   197        88  NPO-SIMPLE      VALUE 'S'.
   198        88  NPO-2MO         VALUE 'I'.
   199        88  NPO-3MO         VALUE 'J'.
   200        88  NPO-4MO         VALUE 'K'.
   201        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   202        88  NPO-TRUNC-0     VALUE 'T'.
   203        88  NPO-TRUNC-1     VALUE 'U'.
   204        88  NPO-TRUNC-2     VALUE 'V'.
   205        88  NPO-TRUNC-3     VALUE 'W'.
   206        88  NPO-TRUNC-4     VALUE 'X'.
   207        88  NPO-REFUND      VALUE 'R'.
   208        88  NPO-PRUDENTIAL  VALUE 'P'.
   209
   210     12  TYPE-SW             PIC X   VALUE 'N'.
   211        88  NET-STD             VALUE 'N'.
   212        88  NET-SMP             VALUE 'S'.
   213
   214     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   215        88  NP-RATING           VALUE '1'.
   216        88  NP-REFUND           VALUE '2'.
   217        88  NP-REMAIN-AMT       VALUE '3'.
   218
   219     12  COMP-3-WORK-AREA         COMP-3.
   220         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   221         16  V               PIC SV9(13)       VALUE +.0.
   222         16  J               PIC SV9(9)        VALUE +0.
   223         16  K               PIC SV9(9)        VALUE +0.
   224         16  I               PIC SV9(10)       VALUE +.0.
   225         16  D               PIC S9(5)         VALUE +.0.
   226         16  APR100          PIC SV9(9)        VALUE +.0.
   227         16  RA              PIC S9(6)V9(9)    VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   6
* ELRATE.cbl
   228         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   229         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
   230         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   231         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
   232         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   233         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   234         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   235         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   236         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   237         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   238         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   239         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   240         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   241         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   242         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   243         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   244         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   245         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   246         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   247         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   248         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   249         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   250         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   251         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   252         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   253         16  K1              PIC S999          VALUE +1.
   254         16  K12             PIC S999          VALUE +12.
   255         16  K100            PIC S999          VALUE +100.
   256         16  K1000           PIC S9(7)         VALUE +1000.
   257         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   258         16  Y REDEFINES NC-LR
   259                             PIC S99V9(5).
   260         16  TI              PIC S999V9(5)     VALUE +0.
   261         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   262         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   263         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   264         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   265         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   266         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   267         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   268         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   269
   270         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   271         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   272         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   273         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   274         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   275         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   276         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
   277         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   278         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   279         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   280         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
   281         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   282         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   283
   284         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
   285
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   7
* ELRATE.cbl
   286         16  ORIGINAL-TERM   PIC S999.
   287         16  M              REDEFINES ORIGINAL-TERM
   288                             PIC S999.
   289
   290         16  REMAINING-TERM  PIC S999.
   291         16  R              REDEFINES REMAINING-TERM
   292                             PIC S999.
   293
   294         16  LOAN-TERM       PIC S999.
   295         16  N              REDEFINES LOAN-TERM
   296                             PIC S999.
   297
   298         16  EXPIRED-TERM    PIC S999.
   299         16  E              REDEFINES EXPIRED-TERM
   300                             PIC S999.
   301
   302         16  PRUDENTIAL-WORK-AMT
   303                             PIC S9(7)V9(8).
   304         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   305                             PIC S9(7)V9(8).
   306
   307         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   308         16  VX              PIC S9V9(13)      VALUE +0.0.
   309         16  SV              PIC S9V9(13)      VALUE +0.0.
   310         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   311         16  SX              PIC S9V9(13)      VALUE +0.0.
   312         16  SE              PIC S9V9(10)      VALUE +0.0.
   313         16  N2              PIC S9(7)         VALUE +0.
   314         16  N3              PIC S9(7)         VALUE +0.
   315         16  K-I             PIC S9V9(8)       VALUE +0.0.
   316
   317     12  BINARY-WORK-AREA        COMP.
   318         16  X1              PIC S999        VALUE +0.
   319         16  X2              PIC S999        VALUE +0.
   320         16  MAX-X           PIC S9(5)       VALUE +0.
   321         16  B1              PIC S9(5)       VALUE +1.
   322         16  LINDX           PIC S999        VALUE ZEROS.
   323         16  AHNDX           PIC S999        VALUE ZEROS.
   324
   325     12  WS-WORK-MISC.
   326         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   327         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   328*        16  WS-AGE              PIC 99           VALUE ZEROS.
   329         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   330         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   331         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   332         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   333         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
   334         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   335         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   336         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   337         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   338         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
   339         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   340         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   341******************************************************************
   342
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   8
* ELRATE.cbl
   344*                            COPY ELCDATE.
   345******************************************************************
   346*                                                                *
   347*                                                                *
   348*                            ELCDATE.                            *
   349*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   350*                            VMOD=2.003
   351*                                                                *
   352*                                                                *
   353*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   354*                 LENGTH = 200                                   *
   355******************************************************************
   356
   357 01  DATE-CONVERSION-DATA.
   358     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   359     12  DC-OPTION-CODE                PIC X.
   360         88  BIN-TO-GREG                VALUE ' '.
   361         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   362         88  EDIT-GREG-TO-BIN           VALUE '2'.
   363         88  YMD-GREG-TO-BIN            VALUE '3'.
   364         88  MDY-GREG-TO-BIN            VALUE '4'.
   365         88  JULIAN-TO-BIN              VALUE '5'.
   366         88  BIN-PLUS-ELAPSED           VALUE '6'.
   367         88  FIND-CENTURY               VALUE '7'.
   368         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   369         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   370         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   371         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   372         88  JULIAN-TO-BIN-3            VALUE 'C'.
   373         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   374         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   375         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   376         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   377         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   378         88  CHECK-LEAP-YEAR            VALUE 'H'.
   379         88  BIN-3-TO-GREG              VALUE 'I'.
   380         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   381         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   382         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   383         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   384         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   385         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   386         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   387         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   388         88  THREE-CHARACTER-BIN
   389                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   390         88  GREGORIAN-TO-BIN
   391                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   392         88  BIN-TO-GREGORIAN
   393                  VALUES ' ' '1' 'I' '8' 'G'.
   394         88  JULIAN-TO-BINARY
   395                  VALUES '5' 'C' 'E' 'F'.
   396     12  DC-ERROR-CODE                 PIC X.
   397         88  NO-CONVERSION-ERROR        VALUE ' '.
   398         88  DATE-CONVERSION-ERROR
   399                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   400         88  DATE-IS-ZERO               VALUE '1'.
   401         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   9
* ELRATE.cbl
   402         88  DATE-IS-INVALID            VALUE '3'.
   403         88  DATE1-GREATER-DATE2        VALUE '4'.
   404         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   405         88  DATE-INVALID-OPTION        VALUE '9'.
   406         88  INVALID-CENTURY            VALUE 'A'.
   407         88  ONLY-CENTURY               VALUE 'B'.
   408         88  ONLY-LEAP-YEAR             VALUE 'C'.
   409         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   410     12  DC-END-OF-MONTH               PIC X.
   411         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   412     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   413         88  USE-NORMAL-PROCESS         VALUE ' '.
   414         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   415         88  ADJUST-UP-100-YRS          VALUE '2'.
   416     12  FILLER                        PIC X.
   417     12  DC-CONVERSION-DATES.
   418         16  DC-BIN-DATE-1             PIC XX.
   419         16  DC-BIN-DATE-2             PIC XX.
   420         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   421         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   422                       DC-GREG-DATE-1-EDIT.
   423             20  DC-EDIT1-MONTH        PIC 99.
   424             20  SLASH1-1              PIC X.
   425             20  DC-EDIT1-DAY          PIC 99.
   426             20  SLASH1-2              PIC X.
   427             20  DC-EDIT1-YEAR         PIC 99.
   428         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   429         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   430                     DC-GREG-DATE-2-EDIT.
   431             20  DC-EDIT2-MONTH        PIC 99.
   432             20  SLASH2-1              PIC X.
   433             20  DC-EDIT2-DAY          PIC 99.
   434             20  SLASH2-2              PIC X.
   435             20  DC-EDIT2-YEAR         PIC 99.
   436         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   437         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   438                     DC-GREG-DATE-1-YMD.
   439             20  DC-YMD-YEAR           PIC 99.
   440             20  DC-YMD-MONTH          PIC 99.
   441             20  DC-YMD-DAY            PIC 99.
   442         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   443         16  DC-GREG-DATE-1-MDY-R REDEFINES
   444                      DC-GREG-DATE-1-MDY.
   445             20  DC-MDY-MONTH          PIC 99.
   446             20  DC-MDY-DAY            PIC 99.
   447             20  DC-MDY-YEAR           PIC 99.
   448         16  DC-GREG-DATE-1-ALPHA.
   449             20  DC-ALPHA-MONTH        PIC X(10).
   450             20  DC-ALPHA-DAY          PIC 99.
   451             20  FILLER                PIC XX.
   452             20  DC-ALPHA-CENTURY.
   453                 24 DC-ALPHA-CEN-N     PIC 99.
   454             20  DC-ALPHA-YEAR         PIC 99.
   455         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   456         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   457         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   458         16  DC-JULIAN-DATE            PIC 9(05).
   459         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  10
* ELRATE.cbl
   460                                       PIC 9(05).
   461         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   462             20  DC-JULIAN-YEAR        PIC 99.
   463             20  DC-JULIAN-DAYS        PIC 999.
   464         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   465         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   466         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   467     12  DATE-CONVERSION-VARIBLES.
   468         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   469         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   470             20  FILLER                PIC 9(3).
   471             20  HOLD-CEN-1-CCYY.
   472                 24  HOLD-CEN-1-CC     PIC 99.
   473                 24  HOLD-CEN-1-YY     PIC 99.
   474             20  HOLD-CEN-1-MO         PIC 99.
   475             20  HOLD-CEN-1-DA         PIC 99.
   476         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   477             20  HOLD-CEN-1-R-MO       PIC 99.
   478             20  HOLD-CEN-1-R-DA       PIC 99.
   479             20  HOLD-CEN-1-R-CCYY.
   480                 24  HOLD-CEN-1-R-CC   PIC 99.
   481                 24  HOLD-CEN-1-R-YY   PIC 99.
   482             20  FILLER                PIC 9(3).
   483         16  HOLD-CENTURY-1-X.
   484             20  FILLER                PIC X(3)  VALUE SPACES.
   485             20  HOLD-CEN-1-X-CCYY.
   486                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   487                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   488             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   489             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   490         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   491             20  HOLD-CEN-1-R-X-MO     PIC XX.
   492             20  HOLD-CEN-1-R-X-DA     PIC XX.
   493             20  HOLD-CEN-1-R-X-CCYY.
   494                 24  HOLD-CEN-1-R-X-CC PIC XX.
   495                 24  HOLD-CEN-1-R-X-YY PIC XX.
   496             20  FILLER                PIC XXX.
   497         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   498         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   499         16  DC-JULIAN-DATE-1          PIC 9(07).
   500         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   501             20  DC-JULIAN-1-CCYY.
   502                 24  DC-JULIAN-1-CC    PIC 99.
   503                 24  DC-JULIAN-1-YR    PIC 99.
   504             20  DC-JULIAN-DA-1        PIC 999.
   505         16  DC-JULIAN-DATE-2          PIC 9(07).
   506         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   507             20  DC-JULIAN-2-CCYY.
   508                 24  DC-JULIAN-2-CC    PIC 99.
   509                 24  DC-JULIAN-2-YR    PIC 99.
   510             20  DC-JULIAN-DA-2        PIC 999.
   511         16  DC-GREG-DATE-A-EDIT.
   512             20  DC-EDITA-MONTH        PIC 99.
   513             20  SLASHA-1              PIC X VALUE '/'.
   514             20  DC-EDITA-DAY          PIC 99.
   515             20  SLASHA-2              PIC X VALUE '/'.
   516             20  DC-EDITA-CCYY.
   517                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  11
* ELRATE.cbl
   518                 24  DC-EDITA-YEAR     PIC 99.
   519         16  DC-GREG-DATE-B-EDIT.
   520             20  DC-EDITB-MONTH        PIC 99.
   521             20  SLASHB-1              PIC X VALUE '/'.
   522             20  DC-EDITB-DAY          PIC 99.
   523             20  SLASHB-2              PIC X VALUE '/'.
   524             20  DC-EDITB-CCYY.
   525                 24  DC-EDITB-CENT     PIC 99.
   526                 24  DC-EDITB-YEAR     PIC 99.
   527         16  DC-GREG-DATE-CYMD         PIC 9(08).
   528         16  DC-GREG-DATE-CYMD-R REDEFINES
   529                              DC-GREG-DATE-CYMD.
   530             20  DC-CYMD-CEN           PIC 99.
   531             20  DC-CYMD-YEAR          PIC 99.
   532             20  DC-CYMD-MONTH         PIC 99.
   533             20  DC-CYMD-DAY           PIC 99.
   534         16  DC-GREG-DATE-MDCY         PIC 9(08).
   535         16  DC-GREG-DATE-MDCY-R REDEFINES
   536                              DC-GREG-DATE-MDCY.
   537             20  DC-MDCY-MONTH         PIC 99.
   538             20  DC-MDCY-DAY           PIC 99.
   539             20  DC-MDCY-CEN           PIC 99.
   540             20  DC-MDCY-YEAR          PIC 99.
   541    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   542        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   543    12  DC-EL310-DATE                  PIC X(21).
   544    12  FILLER                         PIC X(28).
   545
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  12
* ELRATE.cbl
   547*                            COPY ELCCALC.
   548******************************************************************
   549*                                                                *
   550*                           ELCCALC.                            *
   551*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   552*                            VMOD=2.025                          *
   553*                                                                *
   554*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   555*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   556*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   557*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   558*                                                                *
   559*  PASSED TO ELRTRM                                              *
   560*  -----------------                                             *
   561*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   562*  ORIGINAL TERM                                                 *
   563*  BEGINNING DATE                                                *
   564*  ENDING DATE                                                   *
   565*  COMPANY I.D.                                                  *
   566*  ACCOUNT MASTER USER FIELD                                     *
   567*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   568*  FREE LOOK DAYS                                                *
   569*                                                                *
   570*  RETURNED FROM ELRTRM                                          *
   571*  ---------------------                                         *
   572*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   573*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   574*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   575*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   576*----------------------------------------------------------------*
   577*  PASSED TO ELRAMT                                              *
   578*  ----------------                                              *
   579*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   580*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   581*  ORIGINAL AMOUNT                                               *
   582*  ALTERNATE BENEFIT (BALLON)                                    *
   583*  A.P.R. - NET PAY ONLY                                         *
   584*  METHOD
   585*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   586*  COMPANY I.D.                                                  *
   587*  BENEFIT TYPE                                                  *
   588*                                                                *
   589*  RETURNED FROM ELRAMT                                          *
   590*  --------------------                                          *
   591*  REMAINING AMOUNT 1 - CURRENT                                  *
   592*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   593*  REMAINING AMOUNT FACTOR
   594*----------------------------------------------------------------*
   595*  PASSED TO ELRESV                                              *
   596*  -----------------                                             *
   597*  CERTIFICATE EFFECTIVE DATE                                    *
   598*  VALUATION DATE                                                *
   599*  PAID THRU DATE                                                *
   600*  BENEFIT                                                       *
   601*  INCURRED DATE                                                 *
   602*  REPORTED DATE                                                 *
   603*  ISSUE AGE                                                     *
   604*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  13
* ELRATE.cbl
   605*  CDT PERCENT                                                   *
   606*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   607* *CLAIM TYPE (LIFE, A/H)                                        *
   608* *REMAINING BENEFIT (FROM ELRAMT)                               *
   609* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   610*                                                                *
   611*  RETURNED FROM ELRESV                                          *
   612*  --------------------                                          *
   613*  CDT TABLE USED                                                *
   614*  CDT FACTOR USED                                               *
   615*  PAY TO CURRENT RESERVE                                        *
   616*  I.B.N.R. - A/H ONLY                                           *
   617*  FUTURE (ACCRUED) AH ONLY                                      *
   618*----------------------------------------------------------------*
   619*  PASSED TO ELRATE                                              *
   620*  ----------------                                              *
   621*  CERT ISSUE DATE                                               *
   622*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   623*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   624*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   625*  STATE CODE (CLIENT DEFINED)                                   *
   626*  STATE CODE (STANDARD P.O. ABBRV)                              *
   627*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   628*  DEVIATION CODE                                                *
   629*  ISSUE AGE                                                     *
   630*  ORIGINAL BENEFIT AMOUNT                                       *
   631*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   632*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   633*  BENEFIT KIND (LIFE OR A/H)                                    *
   634*  A.P.R.                                                        *
   635*  METHOD
   636*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   637*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   638*  COMPANY I.D. (3 CHARACTER)                                    *
   639*  BENEFIT CODE                                                  *
   640*  BENEFIT OVERRIDE CODE                                         *
   641*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   642*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   643*  JOINT INDICATOR (CSL ONLY)                                    *
   644*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   645*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   646*                                                                *
   647*  RETURNED FROM ELRATE                                          *
   648*  --------------------                                          *
   649*  CALCULATED PREMIUM                                            *
   650*  PREMIUM RATE                                                  *
   651*  MORTALITY CODE                                                *
   652*  MAX ATTAINED AGE                                              *
   653*  MAX AGE                                                       *
   654*  MAX TERM                                                      *
   655*  MAX MONTHLY BENEFIT                                           *
   656*  MAX TOTAL BENIFIT                                             *
   657*  COMPOSITE RATE (OPEN-END ONLY)                                *
   658*----------------------------------------------------------------*
   659*  PASSED TO ELRFND                                              *
   660*  ----------------                                              *
   661*  CERT ISSUE DATE                                               *
   662*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  14
* ELRATE.cbl
   663*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   664*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   665*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   666*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   667*  STATE CODE (CLIENT DEFINED)                                   *
   668*  STATE CODE (STANDARD P.O. ABBRV)                              *
   669*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   670*  DEVIATION CODE                                                *
   671*  ISSUE AGE                                                     *
   672*  ORIGINAL BENEFIT AMOUNT                                       *
   673*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   674*  PROCESS TYPE (CANCEL)                                         *
   675*  BENEFIT KIND (LIFE OR A/H)                                    *
   676*  A.P.R.                                                        *
   677*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   678*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   679*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   680*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   681*  COMPANY I.D. (3 CHARACTER)                                    *
   682*  BENEFIT CODE                                                  *
   683*  BENEFIT OVERRIDE CODE                                         *
   684*                                                                *
   685*  RETURNED FROM ELRFND                                          *
   686*  --------------------                                          *
   687*  CALCULATED REFUND                                             *
   688*----------------------------------------------------------------*
   689*  PASSED TO ELEARN                                              *
   690*  ----------------                                              *
   691*  CERT ISSUE DATE                                               *
   692*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   693*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   694*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   695*  STATE CODE (CLIENT DEFINED)                                   *
   696*  STATE CODE (STANDARD P.O. ABBRV)                              *
   697*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   698*  DEVIATION CODE                                                *
   699*  ISSUE AGE                                                     *
   700*  ORIGINAL BENEFIT AMOUNT                                       *
   701*  BENEFIT KIND (LIFE OR A/H)                                    *
   702*  A.P.R.                                                        *
   703*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   704*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   705*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   706*  COMPANY I.D. (3 CHARACTER)                                    *
   707*  BENEFIT CODE                                                  *
   708*  BENEFIT OVERRIDE CODE                                         *
   709*                                                                *
   710*  RETURNED FROM ELEARN                                          *
   711*  --------------------                                          *
   712*  INDICATED  EARNINGS                                           *
   713*----------------------------------------------------------------*
   714*                 LENGTH = 450                                   *
   715*                                                                *
   716******************************************************************
   717******************************************************************
   718*                   C H A N G E   L O G
   719*
   720* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  15
* ELRATE.cbl
   721*-----------------------------------------------------------------
   722*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   723* EFFECTIVE    NUMBER
   724*-----------------------------------------------------------------
   725* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   726* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   727* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   728* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   729* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   730* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   731* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   732******************************************************************
   733
   734 01  CALCULATION-PASS-AREA.
   735     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   736                                     COMP.
   737
   738     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   739       88  NO-CP-ERROR                             VALUE ZERO.
   740       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   741                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   742       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   743       88  CP-ERROR-IN-DATES                       VALUE '2'.
   744       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   745       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   746       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   747       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   748       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   749       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   750       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   751       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   752       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   753       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   754       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   755       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   756       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   757       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   758       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   759
   760     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   761       88  NO-CP-ERROR-2                           VALUE ZERO.
   762***********************  INPUT AREAS ****************************
   763
   764     12  CP-CALCULATION-AREA.
   765         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   766         16  CP-CERT-EFF-DT        PIC XX.
   767         16  CP-VALUATION-DT       PIC XX.
   768         16  CP-PAID-THRU-DT       PIC XX.
   769         16  CP-BENEFIT-TYPE       PIC X.
   770           88  CP-AH                               VALUE 'A' 'D'
   771                                                   'I' 'U'.
   772           88  CP-REDUCING-LIFE                    VALUE 'R'.
   773           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   774         16  CP-INCURRED-DT        PIC XX.
   775         16  CP-REPORTED-DT        PIC XX.
   776         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   777         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   778         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  16
* ELRATE.cbl
   779                                     COMP-3.
   780         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   781                                     COMP-3.
   782         16  CP-CDT-METHOD         PIC X.
   783           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   784           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   785           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   786         16  CP-CLAIM-TYPE         PIC X.
   787           88  CP-AH-CLAIM                         VALUE 'A'.
   788           88  CP-LIFE-CLAIM                       VALUE 'L'.
   789         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   790                                     COMP-3.
   791         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   792                                     COMP-3.
   793         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   794                                     COMP-3.
   795         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   796                                     COMP-3.
   797         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   798                                     COMP-3.
   799         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   800                                     COMP-3.
   801         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   802                                     COMP-3.
   803         16  CP-REM-TERM-METHOD    PIC X.
   804           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   805           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   806           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   807           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   808           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   809           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   810           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   811         16  CP-EARNING-METHOD     PIC X.
   812           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   813           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   814           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   815           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   816           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   817           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   818           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   819           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   820           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   821           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   822           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   823           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   824         16  CP-PROCESS-TYPE       PIC X.
   825           88  CP-CLAIM                            VALUE '1'.
   826           88  CP-CANCEL                           VALUE '2'.
   827           88  CP-ISSUE                            VALUE '3'.
   828         16  CP-SPECIAL-CALC-CD    PIC X.
   829           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   830           88  CP-1-MTH-INTEREST               VALUE ' '.
   831           88  CP-0-MTH-INTEREST               VALUE 'A'.
   832           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   833           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   834           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   835           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   836           88  CP-FARM-PLAN                    VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  17
* ELRATE.cbl
   837           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   838           88  CP-2-MTH-INTEREST               VALUE 'I'.
   839           88  CP-3-MTH-INTEREST               VALUE 'J'.
   840           88  CP-4-MTH-INTEREST               VALUE 'K'.
   841           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   842           88  CP-MORTGAGE-REC                 VALUE 'M'.
   843           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   844           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   845           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   846           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   847                                                     'W' 'X'.
   848           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   849           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   850           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   851           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   852           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   853           88  CP-SUMMARY-REC                  VALUE 'Z'.
   854           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   855           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   856           88  CP-AD-D-BENEFIT                 VALUE '4'.
   857           88  CP-CSL-METH-1                   VALUE '5'.
   858           88  CP-CSL-METH-2                   VALUE '6'.
   859           88  CP-CSL-METH-3                   VALUE '7'.
   860           88  CP-CSL-METH-4                   VALUE '8'.
   861
   862         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   863                                     COMP-3.
   864         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   865         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   866         16  CP-STATE              PIC XX          VALUE SPACE.
   867         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   868         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   869           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   870               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   871         16  CP-R78-OPTION         PIC X.
   872           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   873           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   874
   875         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   876         16  CP-IBNR-RESERVE-SW    PIC X.
   877         16  CP-CLAIM-STATUS       PIC X.
   878         16  CP-RATE-FILE          PIC X.
   879         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   880                                     COMP-3.
   881
   882         16  CP-LIFE-OVERRIDE-CODE PIC X.
   883         16  CP-AH-OVERRIDE-CODE   PIC X.
   884
   885         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   886                                     COMP-3.
   887         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   888                                     COMP-3.
   889         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   890                                     COMP-3.
   891         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   892                                     COMP-3.
   893
   894         16  CP-PAID-FROM-DATE     PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  18
* ELRATE.cbl
   895         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   896         16  CP-EXT-DAYS-CALC      PIC X.
   897           88  CP-EXT-NO-CHG                   VALUE ' '.
   898           88  CP-EXT-CHG-LF                   VALUE '1'.
   899           88  CP-EXT-CHG-AH                   VALUE '2'.
   900           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   901         16  CP-DOMICILE-STATE     PIC XX.
   902         16  CP-CARRIER            PIC X.
   903         16  CP-REIN-FLAG          PIC X.
   904         16  CP-REM-TRM-CALC-OPTION PIC X.
   905           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   906                      '2' '3' '4' '5'.
   907           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   908           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   909           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   910           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   911           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   912           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   913           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   914           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   915         16  CP-SIG-SWITCH         PIC X.
   916         16  CP-RATING-METHOD      PIC X.
   917           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   918           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   919           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   920           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   921           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   922           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   923           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   924           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   925           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   926         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   927                                     COMP-3.
   928         16  CP-BEN-CATEGORY       PIC X.
   929         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   930         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   931                                   PIC S99V9(5) COMP-3.
   932         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   933         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   934                                   PIC S99V9(5) COMP-3.
   935         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   936         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   937         16  CP-EXPIRE-DT          PIC XX.
   938         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   939         16  FILLER                PIC X(35).
   940*        16  FILLER                PIC X(50).
   941
   942***************    OUTPUT FROM ELRESV   ************************
   943
   944         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   945
   946         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   947                                     COMP-3.
   948         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   949                                     COMP-3.
   950         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   951                                     COMP-3.
   952         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  19
* ELRATE.cbl
   953                                     COMP-3.
   954         16  FILLER                PIC X(09).
   955***************    OUTPUT FROM ELRTRM   *************************
   956
   957         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   958                                     COMP-3.
   959         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   960                                     COMP-3.
   961         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   962                                     COMP-3.
   963         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   964                                     COMP-3.
   965         16  FILLER                PIC X(12).
   966
   967***************    OUTPUT FROM ELRAMT   *************************
   968
   969         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   970                                     COMP-3.
   971         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   972                                     COMP-3.
   973         16  FILLER                PIC X(12).
   974
   975***************    OUTPUT FROM ELRATE   *************************
   976
   977         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   978                                     COMP-3.
   979         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   980                                     COMP-3.
   981         16  CP-MORTALITY-CODE     PIC X(4).
   982         16  CP-RATE-EDIT-FLAG     PIC X.
   983             88  CP-RATES-NEED-APR                  VALUE '1'.
   984         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   985                                     COMP-3.
   986         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   987         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   988         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   989                                   PIC S9(7)V99 COMP-3.
   990         16  FILLER                PIC X(07).
   991
   992***************    OUTPUT FROM ELRFND   *************************
   993
   994         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   995                                     COMP-3.
   996         16  CP-REFUND-TYPE-USED   PIC X.
   997           88  CP-R-AS-R78                         VALUE '1'.
   998           88  CP-R-AS-PRORATA                     VALUE '2'.
   999           88  CP-R-AS-CALIF                       VALUE '3'.
  1000           88  CP-R-AS-TEXAS                       VALUE '4'.
  1001           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1002           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1003           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1004           88  CP-R-AS-MEAN                        VALUE '8'.
  1005           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1006           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1007           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1008         16  FILLER                PIC X(12).
  1009
  1010***************    OUTPUT FROM ELEARN   *************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  20
* ELRATE.cbl
  1011
  1012         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1013                                     COMP-3.
  1014         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1015                                     COMP-3.
  1016         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1017                                     COMP-3.
  1018         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1019                                     COMP-3.
  1020         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1021                                     COMP-3.
  1022         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1023                                     COMP-3.
  1024         16  CP-EARNING-TYPE-USED  PIC X.
  1025           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1026           88  CP-E-AS-R78                         VALUE '1'.
  1027           88  CP-E-AS-PRORATA                     VALUE '2'.
  1028           88  CP-E-AS-TEXAS                       VALUE '4'.
  1029           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1030           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1031           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1032           88  CP-E-AS-MEAN                        VALUE '8'.
  1033           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1034         16  FILLER                PIC X(12).
  1035
  1036***************    OUTPUT FROM ELPMNT   *************************
  1037
  1038         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1039                                     COMP-3.
  1040         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1041                                     COMP-3.
  1042         16  FILLER                PIC X(12).
  1043
  1044***************   MISC WORK AREAS    *****************************
  1045         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1046                                     COMP-3.
  1047         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1048                                     COMP-3.
  1049         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1050                                     COMP-3.
  1051         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1052                                     COMP-3.
  1053         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1054                                     COMP-3.
  1055         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1056                                     COMP-3.
  1057         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1058             88  OPEN-RATE-FILE                   VALUE 'O'.
  1059             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1060             88  IO-ERROR                         VALUE 'E'.
  1061
  1062         16  CP-FIRST-PAY-DATE     PIC XX.
  1063
  1064         16  CP-JOINT-INDICATOR    PIC X.
  1065
  1066         16  CP-RESERVE-REMAINING-TERM
  1067                                   PIC S9(4)V9    VALUE ZERO
  1068                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  21
* ELRATE.cbl
  1069
  1070         16  CP-INSURED-BIRTH-DT   PIC XX.
  1071
  1072         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1073                                     COMP-3.
  1074
  1075         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1076                                     COMP-3.
  1077
  1078         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1079                                     COMP-3.
  1080
  1081         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1082                                     COMP-3.
  1083
  1084         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1085                                     COMP-3.
  1086
  1087         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1088                                     COMP-3.
  1089
  1090         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1091                                     COMP-3.
  1092
  1093         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1094             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1095
  1096         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1097                                     COMP-3.
  1098         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1099                                     COMP-3.
  1100         16  FILLER                PIC X(17).
  1101******************************************************************
  1102
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  22
* ELRATE.cbl
  1104****************************************************************
  1105*
  1106* Copyright (c) 2007 by Clerity Solutions, Inc.
  1107* All rights reserved.
  1108*
  1109****************************************************************
  1110 01  DFHEIV.
  1111   02  DFHEIV0               PIC X(35).
  1112   02  DFHEIV1               PIC X(08).
  1113   02  DFHEIV2               PIC X(08).
  1114   02  DFHEIV3               PIC X(08).
  1115   02  DFHEIV4               PIC X(06).
  1116   02  DFHEIV5               PIC X(04).
  1117   02  DFHEIV6               PIC X(04).
  1118   02  DFHEIV7               PIC X(02).
  1119   02  DFHEIV8               PIC X(02).
  1120   02  DFHEIV9               PIC X(01).
  1121   02  DFHEIV10              PIC S9(7) COMP-3.
  1122   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1123   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1124   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1125   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1126   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1127   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1128   02  DFHEIV17              PIC X(04).
  1129   02  DFHEIV18              PIC X(04).
  1130   02  DFHEIV19              PIC X(04).
  1131   02  DFHEIV20              USAGE IS POINTER.
  1132   02  DFHEIV21              USAGE IS POINTER.
  1133   02  DFHEIV22              USAGE IS POINTER.
  1134   02  DFHEIV23              USAGE IS POINTER.
  1135   02  DFHEIV24              USAGE IS POINTER.
  1136   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1137   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1138   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1139   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1140   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1141   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1142   02  FILLER                PIC X(02).
  1143   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1144   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1145   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1146   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1147   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1148 LINKAGE  SECTION.
  1149*****************************************************************
  1150*                                                               *
  1151* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1152* All rights reserved.                                          *
  1153*                                                               *
  1154*****************************************************************
  1155 01  dfheiblk.
  1156     02  eibtime          pic s9(7) comp-3.
  1157     02  eibdate          pic s9(7) comp-3.
  1158     02  eibtrnid         pic x(4).
  1159     02  eibtaskn         pic s9(7) comp-3.
  1160     02  eibtrmid         pic x(4).
  1161     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  23
* ELRATE.cbl
  1162     02  eibcposn         pic s9(4) comp.
  1163     02  eibcalen         pic s9(4) comp.
  1164     02  eibaid           pic x(1).
  1165     02  eibfiller1       pic x(1).
  1166     02  eibfn            pic x(2).
  1167     02  eibfiller2       pic x(2).
  1168     02  eibrcode         pic x(6).
  1169     02  eibfiller3       pic x(2).
  1170     02  eibds            pic x(8).
  1171     02  eibreqid         pic x(8).
  1172     02  eibrsrce         pic x(8).
  1173     02  eibsync          pic x(1).
  1174     02  eibfree          pic x(1).
  1175     02  eibrecv          pic x(1).
  1176     02  eibsend          pic x(1).
  1177     02  eibatt           pic x(1).
  1178     02  eibeoc           pic x(1).
  1179     02  eibfmh           pic x(1).
  1180     02  eibcompl         pic x(1).
  1181     02  eibsig           pic x(1).
  1182     02  eibconf          pic x(1).
  1183     02  eiberr           pic x(1).
  1184     02  eibrldbk         pic x(1).
  1185     02  eiberrcd         pic x(4).
  1186     02  eibsynrb         pic x(1).
  1187     02  eibnodat         pic x(1).
  1188     02  eibfiller5       pic x(2).
  1189     02  eibresp          pic 9(09) comp.
  1190     02  eibresp2         pic 9(09) comp.
  1191     02  dfheigdj         pic s9(4) comp.
  1192     02  dfheigdk         pic s9(4) comp.
  1193 01  DFHCOMMAREA             PIC X(450).
  1194
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  24
* ELRATE.cbl
  1196*01 PARMLIST              COMP.
  1197*    02  FILLER              PIC S9(8).
  1198*    02  ERRATE-POINTER      PIC S9(8).
  1199
  1200*                                COPY ERCRATE.
  1201******************************************************************
  1202*                                                                *
  1203*                                                                *
  1204*                            ERCRATE                             *
  1205*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1206*                            VMOD=2.008                          *
  1207*                                                                *
  1208*   ONLINE CREDIT SYSTEM                                         *
  1209*                                                                *
  1210*   FILE DESCRIPTION = RATES MASTER FILE                         *
  1211*                                                                *
  1212*   FILE TYPE = VSAM,KSDS                                        *
  1213*   RECORD SIZE = 1765  RECFORM = FIXED                          *
  1214*                                                                *
  1215*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
  1216*       ALTERNATE PATH = NONE                                    *
  1217*                                                                *
  1218*   LOG = NO                                                     *
  1219*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1220*                                                                *
  1221******************************************************************
  1222
  1223 01  RATE-RECORD.
  1224     12  RT-RECORD-ID                      PIC XX.
  1225         88  VALID-RT-ID                      VALUE 'RT'.
  1226
  1227     12  RT-CONTROL-PRIMARY.
  1228         16  RT-COMPANY-CD                 PIC X.
  1229         16  RT-STATE-CODE.
  1230             20  RT-ST-CODE                PIC XX.
  1231             20  RT-ST-CLASS               PIC XX.
  1232             20  RT-ST-DEV                 PIC XXX.
  1233         16  RT-L-AH-CODE.
  1234             20  RT-L-AH                   PIC X.
  1235             20  RT-LAH-NUM                PIC XX.
  1236         16  RT-LIMITS.
  1237             20  RT-HIGH-AGE               PIC 99.
  1238             20  RT-HIGH-AMT               PIC 9(6).
  1239             20  RT-FUTURE                 PIC XX.
  1240             20  RT-SEX                    PIC X.
  1241         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.
  1242
  1243     12  RT-MAINT-INFORMATION.
  1244         16  RT-LAST-MAINT-DT              PIC XX.
  1245         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1246         16  RT-LAST-MAINT-USER            PIC X(4).
  1247         16  FILLER                        PIC X(10).
  1248
  1249     12  RT-STRUCTURE-COMMENT              PIC X(50).
  1250     12  RT-RATE-COMMENT                   PIC X(50).
  1251
  1252     12  CSL-RESERVED                      PIC X(10).
  1253     12  FILLER                            PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  25
* ELRATE.cbl
  1254
  1255     12  RT-MAX-AGE                        PIC 99.
  1256
  1257     12  RT-LIFE-LIMS-FLDS.
  1258         16  RT-LIFE-MORT-CODE             PIC X(4).
  1259         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
  1260             20  RT-L-EX-AGE               PIC 99.
  1261             20  RT-L-EX-TERM              PIC S999       COMP-3.
  1262             20  RT-L-EX-FACE              PIC S9(7)      COMP-3.
  1263         16  FILLER                        PIC X(20).
  1264
  1265     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.
  1266         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.
  1267             20  RT-AH-AGE                 PIC 99.
  1268             20  RT-AH-TERM                PIC S999       COMP-3.
  1269             20  RT-AH-BEN-M               PIC S9(5)      COMP-3.
  1270             20  RT-AH-BEN-F               PIC S9(7)      COMP-3.
  1271
  1272     12  RT-LIFE-RATES.
  1273         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
  1274
  1275     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.
  1276         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
  1277
  1278     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.
  1279
  1280     12  RT-DISCOUNT-OPTION                PIC X.
  1281         88  RT-DO-NOT-USE                     VALUE ' '.
  1282         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.
  1283         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.
  1284
  1285     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
  1286     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
  1287
  1288     12  RT-COMPOSITE-OPTION               PIC X.
  1289         88  RT-NO-COMPOSITE                   VALUE ' '.
  1290         88  RT-USE-COMPOSITE-RATE             VALUE '1'.
  1291
  1292     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
  1293
  1294     12  RT-POLICY-FEE                     PIC S9(3)V99   COMP-3.
  1295     12  FILLER                            PIC X(13).
  1296
  1297     12  RT-TYPE-RATE                      PIC X.
  1298         88  RT-IS-STND                        VALUE ' ' 'S'.
  1299         88  RT-IS-OB                          VALUE 'O'.
  1300
  1301     12  RT-SRT-ALPHA                      PIC X.
  1302
  1303     12  RT-CONTROL-2.
  1304         16  RTC-1                         PIC X(7).
  1305         16  RTC-3                         PIC X(11).
  1306         16  RTC-4                         PIC 9(11) COMP-3.
  1307         16  RTC-2                         PIC X(3).
  1308******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  26
* ELRATE.cbl
  1310 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA RATE-RECORD.
  1311 0000-DFHEXIT SECTION.
  1312     MOVE '9#                    $   ' TO DFHEIV0.
  1313     MOVE 'ELRATE' TO DFHEIV1.
  1314     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1315
  1316     MOVE DFHCOMMAREA            TO  CALCULATION-PASS-AREA.
  1317
  1318 000-START-PREMIUM-CALC.
  1319     MOVE ZERO                   TO CP-RETURN-CODE
  1320                                    CP-CALC-PREMIUM
  1321                                    CP-PREMIUM-RATE
  1322                                    CP-POLICY-FEE.
  1323
  1324     MOVE SPACES                 TO CP-MORTALITY-CODE.
  1325     MOVE ALL '9'                TO ERRATE-KEY.
  1326
  1327*    IF CP-RATE-FILE = 'O'
  1328*        MOVE OERATE-FILE-ID     TO ERRATE-FILE-ID.
  1329
  1330     MOVE CP-COMPANY-CD          TO RATE-COMPANY-CD.
  1331     MOVE CP-STATE               TO RATE-ST-CODE.
  1332     MOVE CP-CLASS-CODE          TO RATE-ST-CLASS.
  1333     MOVE CP-DEVIATION-CODE      TO RATE-ST-DEV.
  1334     MOVE CP-ISSUE-AGE           TO RATE-HIGH-AGE.
  1335
  1336     IF CP-RATING-BENEFIT-AMT NOT NUMERIC  OR
  1337        CP-RATING-BENEFIT-AMT = ZEROS
  1338         MOVE CP-ORIGINAL-BENEFIT    TO RATE-HIGH-AMT
  1339     ELSE
  1340         MOVE CP-RATING-BENEFIT-AMT  TO RATE-HIGH-AMT.
  1341
  1342     IF CP-AH
  1343         MOVE CP-AH-OVERRIDE-CODE     TO RATE-L-AH
  1344     ELSE
  1345         MOVE CP-LIFE-OVERRIDE-CODE   TO RATE-L-AH.
  1346
  1347     MOVE CP-BENEFIT-CD          TO RATE-LAH-NUM.
  1348     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1349     MOVE SPACE                  TO DC-OPTION-CODE.
  1350
  1351     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1352
  1353*** Y2K, PROJ 7744
  1354     IF NO-CONVERSION-ERROR
  1355         MOVE ZEROS                 TO RATE-EXPIRY-DATE
  1356                                       WS-HOLD-RATE-EXP-DT
  1357         MOVE DC-GREG-DATE-CYMD     TO WS-HOLD-RATE-EXP-AL(4:8)
  1358         MOVE WS-HOLD-RATE-EXP-DT   TO RATE-EXPIRY-DATE
  1359         MOVE ERRATE-KEY            TO SAVE-ERRATE-KEY
  1360     ELSE
  1361         MOVE '2'                   TO CP-RETURN-CODE
  1362         GO TO 9999-CALC-RATE-PREM-X
  1363     END-IF.
  1364*** Y2K, PROJ 7744
  1365
  1366
  1367* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  27
* ELRATE.cbl
  1368*        NOTFND   (9999-RATE-NOTFND)
  1369*        NOTOPEN  (9999-RATE-NOTOPEN)
  1370*        ENDFILE  (9999-RATE-NOTFND)
  1371*    END-EXEC.
  1372*    MOVE '"$IJ''                 ! " #00001362' TO DFHEIV0
  1373     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  1374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1375     MOVE X'2220233030303031333632' TO DFHEIV0(25:11)
  1376     CALL 'kxdfhei1' USING DFHEIV0
  1377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1378
  1379
  1380 0050-RATE-START-BROWSE.
  1381
  1382* EXEC CICS STARTBR
  1383*        DATASET  (ERRATE-FILE-ID)
  1384*        RIDFLD   (ERRATE-KEY)
  1385*        GTEQ
  1386*    END-EXEC.
  1387     MOVE 0
  1388       TO DFHEIV11
  1389*    MOVE '&,         G          &   #00001369' TO DFHEIV0
  1390     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1391     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1392     MOVE X'2020233030303031333639' TO DFHEIV0(25:11)
  1393     CALL 'kxdfhei1' USING DFHEIV0,
  1394           ERRATE-FILE-ID,
  1395           ERRATE-KEY,
  1396           DFHEIV99,
  1397           DFHEIV11,
  1398           DFHEIV99
  1399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1400
  1401
  1402     MOVE 'Y'                  TO WS-BROWSE-SW.
  1403
  1404 0100-READ-RATE-LOOP.
  1405
  1406* EXEC CICS READNEXT
  1407*        DATASET  (ERRATE-FILE-ID)
  1408*        SET      (ADDRESS OF RATE-RECORD)
  1409*        RIDFLD   (ERRATE-KEY)
  1410*    END-EXEC.
  1411     MOVE 0
  1412       TO DFHEIV11
  1413*    MOVE '&.S                   )   #00001378' TO DFHEIV0
  1414     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1415     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1416     MOVE X'2020233030303031333738' TO DFHEIV0(25:11)
  1417     CALL 'kxdfhei1' USING DFHEIV0,
  1418           ERRATE-FILE-ID,
  1419           DFHEIV20,
  1420           DFHEIV99,
  1421           ERRATE-KEY,
  1422           DFHEIV99,
  1423           DFHEIV11,
  1424           DFHEIV99,
  1425           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  28
* ELRATE.cbl
  1426     SET ADDRESS OF RATE-RECORD TO
  1427         DFHEIV20
  1428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1429
  1430
  1431 0110-CHECK-KEYS.
  1432*                            COPY ELCRATPD.
  1433******************************************************************
  1434*                                                                *
  1435*                                                                *
  1436*                            ELCRATPD                            *
  1437*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1438*                            VMOD=2.061                          *
  1439*                                                                *
  1440******************************************************************
  1441******************************************************************
  1442*                   C H A N G E   L O G
  1443*
  1444* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1445*-----------------------------------------------------------------
  1446*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1447* EFFECTIVE    NUMBER
  1448*-----------------------------------------------------------------
  1449* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  1450* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  1451* 032603                   PEMA  ADD SPECIAL AZ CALC
  1452* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  1453* 120403                   PEMA  ADD SPECIAL TX CALC
  1454* 092205                   PEMA  FIX CRIT PER FOR DCC
  1455* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  1456* 021207                   PEMA  ADD PA NP
  1457* 022107                   PEMA  ADD NH NP AND NP TRUNC
  1458* 032807                   PEMA  ADD VT NP PLUS 2
  1459* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  1460* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  1461* 060909    2008042300002  PEMA  ADD NEW FARM PLAN CALC
  1462* 010410    2008021200005  PEMA  ADD MN NET PAY BALLOON
  1463* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1464* 040610  CR2010010400006  PEMA  ADD IN TO VT CODE
  1465* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1466******************************************************************
  1467
  1468 0110-CHECK-KEY.
  1469     IF SVRT-COMPANY-CD = RT-COMPANY-CD  AND
  1470        SVRT-ST-CODE    = RT-ST-CODE     AND
  1471        SVRT-ST-CLASS   = RT-ST-CLASS    AND
  1472        SVRT-ST-DEV     = RT-ST-DEV      AND
  1473        SVRT-L-AH       = RT-L-AH        AND
  1474        SVRT-LAH-NUM    = RT-LAH-NUM
  1475         NEXT SENTENCE
  1476     ELSE
  1477         GO TO 9999-RATE-NOTFND.
  1478
  1479     IF  SVRT-HIGH-AGE GREATER RT-HIGH-AGE
  1480         GO TO 9999-RATE-NOTFND.
  1481
  1482     IF SVRT-HIGH-AMT NOT LESS THAN RT-HIGH-AMT
  1483        GO TO 0100-READ-RATE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  29
* ELRATE.cbl
  1484
  1485     IF SVRT-EXPIRY-DATE GREATER RT-EXPIRY-DATE
  1486         GO TO 0100-READ-RATE-LOOP.
  1487
  1488     IF SVRT-EXPIRY-DATE = RT-EXPIRY-DATE
  1489         GO TO 0100-READ-RATE-LOOP.
  1490
  1491     IF RT-MAX-AGE = ZEROS
  1492         NEXT SENTENCE
  1493     ELSE
  1494         COMPUTE WS-AGE =
  1495             (CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12))
  1496         IF WS-AGE >= RT-MAX-AGE
  1497             MOVE 'B'               TO CP-RETURN-CODE.
  1498
  1499     IF CP-LOAN-TERM NOT NUMERIC
  1500         MOVE +0                    TO CP-LOAN-TERM.
  1501
  1502     IF CP-LOAN-TERM = ZERO
  1503         MOVE CP-ORIGINAL-TERM      TO CP-LOAN-TERM.
  1504
  1505     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1506         MOVE +0                    TO CP-TERM-OR-EXT-DAYS.
  1507
  1508     MOVE CP-R-MAX-MON-BEN          TO WS-MAX-MON-BEN.
  1509     MOVE CP-R-MAX-TOT-BEN          TO WS-MAX-TOT-BEN.
  1510
  1511     IF CP-AH
  1512         GO TO 2000-TYPE-IS-AH.
  1513
  1514     IF (RT-IS-OB) AND
  1515        (CP-COMPANY-ID NOT EQUAL 'CID')
  1516          MOVE CP-LOAN-TERM         TO WS-RATE-TERM
  1517       ELSE
  1518          MOVE CP-ORIGINAL-TERM     TO WS-RATE-TERM.
  1519
  1520     MOVE CP-CERT-EFF-DT            TO DC-BIN-DATE-1.
  1521     MOVE SPACE                     TO DC-OPTION-CODE.
  1522
  1523     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1524
  1525 1000-TYPE-IS-LIFE.
  1526     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  1527
  1528     MOVE ZERO                      TO CP-R-MAX-AGE
  1529                                       CP-R-MAX-TERM
  1530                                       CP-R-MAX-MON-BEN
  1531                                       CP-R-MAX-TOT-BEN.
  1532
  1533     MOVE RT-LIFE-MORT-CODE         TO CP-MORTALITY-CODE.
  1534
  1535     IF RT-POLICY-FEE NUMERIC
  1536        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  1537
  1538     MOVE RT-DISCOUNT-OPTION     TO WS-DISCOUNT-OPTION.
  1539
  1540     IF (RT-DISCOUNT-OPTION EQUAL
  1541                     '1' OR '2' OR '3' OR '4' OR '5') AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  30
* ELRATE.cbl
  1542        (RT-DISCOUNT-OB-RATE NUMERIC)         AND
  1543        (RT-DISCOUNT-OB-RATE GREATER THAN +0)
  1544         NEXT SENTENCE
  1545     ELSE
  1546         IF (RT-DISCOUNT-OPTION EQUAL '6') AND
  1547            (CP-STATE-STD-ABBRV EQUAL 'CA')
  1548             IF RT-DISCOUNT-RATE GREATER THAN ZERO
  1549                 COMPUTE CA-DISCOUNT = RT-DISCOUNT-RATE / 100
  1550                 GO TO 1050-REGULAR-RATES
  1551             ELSE
  1552                 GO TO 1050-REGULAR-RATES
  1553         ELSE
  1554             GO TO 1050-REGULAR-RATES.
  1555
  1556*    display ' discount option ' rt-discount-option
  1557     IF RT-DISCOUNT-RATE NOT NUMERIC
  1558        MOVE +0                  TO RT-DISCOUNT-RATE.
  1559
  1560     IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1561        NEXT SENTENCE
  1562     ELSE
  1563        MOVE +0                  TO CP-PREMIUM-RATE
  1564                                    CP-COMPOSITE-RATE
  1565                                    CP-CALC-PREMIUM
  1566         MOVE '4'                TO CP-RETURN-CODE
  1567         GO TO 9999-CALC-RATE-PREM-X.
  1568
  1569     IF RT-DISCOUNT-OPTION = '1' OR '3' OR '5'
  1570        MOVE RT-DISCOUNT-RATE TO WS-WORK-DIS-RATE
  1571     ELSE
  1572        MOVE CP-LOAN-APR TO WS-WORK-DIS-RATE.
  1573
  1574*    IF RT-DISCOUNT-OPTION EQUAL '4'
  1575*       MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1576*       GO TO 1075-BYPASS-REGULAR-RATE.
  1577
  1578     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  1579        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1580        COMPUTE WS-WORK-DIS-RATE EQUAL
  1581                WS-WORK-DIS-RATE / +100
  1582        GO TO 1075-BYPASS-REGULAR-RATE.
  1583
  1584     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  1585        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  1586        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1587        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1588        GO TO 1075-BYPASS-REGULAR-RATE.
  1589
  1590     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1591        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  1592        (CP-TRUNCATED-LIFE)
  1593        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1594        GO TO 1075-BYPASS-REGULAR-RATE.
  1595
  1596     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1597        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  1598        (CP-EARN-AS-NET-PAY)
  1599*       (CP-TRUNCATED-LIFE)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  31
* ELRATE.cbl
  1600        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1601        GO TO 1075-BYPASS-REGULAR-RATE.
  1602
  1603     IF ((CP-COMPANY-ID EQUAL 'GTL') AND
  1604        (CP-STATE-STD-ABBRV EQUAL 'RI'))
  1605                   AND
  1606        ((CP-EARN-AS-NET-PAY)
  1607               OR
  1608        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  1609        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1610        GO TO 1075-BYPASS-REGULAR-RATE.
  1611
  1612     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1613        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  1614        (CP-EARN-AS-NET-PAY) AND
  1615        (CP-SPECIAL-CALC-CD EQUAL 'H')
  1616        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1617        GO TO 1075-BYPASS-REGULAR-RATE.
  1618
  1619     IF (CP-COMPANY-ID = 'CID')
  1620        AND (CP-STATE-STD-ABBRV = 'MN')
  1621        AND (RT-DISCOUNT-OPTION = '1')
  1622        AND ((CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1623                     OR
  1624            (CP-LEVEL-LIFE)
  1625            AND (CP-CERT-EFF-DT > X'A4FF'))
  1626        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1627        GO TO 1075-BYPASS-REGULAR-RATE
  1628     END-IF
  1629     IF (CP-COMPANY-ID EQUAL 'CID')
  1630        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  1631                      OR
  1632            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  1633        AND (CP-EARN-AS-NET-PAY)
  1634        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1635        GO TO 1075-BYPASS-REGULAR-RATE
  1636     END-IF
  1637     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  1638        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1639        (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  1640         MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1641         GO TO 1075-BYPASS-REGULAR-RATE.
  1642
  1643     IF CP-COMPANY-ID = 'CID'
  1644        CONTINUE
  1645     ELSE
  1646        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1647           (CP-EARN-AS-NET-PAY ) AND
  1648           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  1649            GO TO 1075-BYPASS-REGULAR-RATE
  1650        END-IF
  1651     END-IF
  1652     IF (CP-COMPANY-ID = 'CID') AND
  1653        (CP-EARN-AS-NET-PAY) AND
  1654        (CP-LEVEL-LIFE) AND
  1655        (CP-STATE-STD-ABBRV = 'CA') AND
  1656        (CP-STATE-STD-ABBRV = CP-STATE)
  1657        COMPUTE WS-WORK-DIS-RATE =
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  32
* ELRATE.cbl
  1658             RT-DISCOUNT-RATE / +100
  1659        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1660        GO TO 1075-BYPASS-REGULAR-RATE
  1661     END-IF
  1662
  1663     IF (CP-COMPANY-ID = 'CID')
  1664        AND (CP-EARN-AS-NET-PAY)
  1665        AND (CP-STATE-STD-ABBRV = 'ME')
  1666        COMPUTE WS-WORK-DIS-RATE =
  1667             RT-DISCOUNT-RATE / +100
  1668        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1669        GO TO 1075-BYPASS-REGULAR-RATE
  1670     END-IF
  1671     IF (CP-COMPANY-ID = 'CID')
  1672        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1673           OR 'IN' OR 'AZ')
  1674        AND (CP-FARM-PLAN)
  1675        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1676        GO TO 1075-BYPASS-REGULAR-RATE
  1677     END-IF
  1678     IF (CP-COMPANY-ID = 'DCC')
  1679        AND (CP-BEN-CATEGORY = 'D')
  1680        AND (CP-EARN-AS-NET-PAY)
  1681        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1682        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  1683           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  1684*       DISPLAY ' ACT COMM ' CP-DCC-ACT-COMM
  1685*       DISPLAY ' PMF COMM ' CP-DCC-PMF-COMM
  1686*       DISPLAY ' OB RATE  ' RT-DISCOUNT-OB-RATE
  1687*       DISPLAY ' NEW RATE ' CP-PREMIUM-RATE
  1688        GO TO 1075-BYPASS-REGULAR-RATE
  1689     END-IF
  1690     IF (CP-COMPANY-ID = 'CID') AND
  1691        (CP-EARN-AS-NET-PAY) AND
  1692        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  1693                            OR 'VT')
  1694                   OR
  1695        ((CP-STATE-STD-ABBRV = 'IN') AND
  1696        (CP-CERT-EFF-DT > X'9A7F'))
  1697                   OR
  1698        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  1699        (CP-CERT-EFF-DT > X'9ADF'))) AND
  1700        (CP-STATE-STD-ABBRV = CP-STATE)
  1701        COMPUTE WS-WORK-DIS-RATE =
  1702             RT-DISCOUNT-RATE / +100
  1703        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1704        GO TO 1075-BYPASS-REGULAR-RATE
  1705     END-IF
  1706
  1707     IF (CP-COMPANY-ID = 'CID') AND
  1708        (CP-EARN-AS-NET-PAY) AND
  1709        (CP-STATE-STD-ABBRV = 'TX') AND
  1710        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1711        (WS-DISCOUNT-OPTION NOT = ' ')
  1712        COMPUTE WS-WORK-DIS-RATE =
  1713             RT-DISCOUNT-RATE / +100
  1714        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1715        GO TO 1075-BYPASS-REGULAR-RATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  33
* ELRATE.cbl
  1716     END-IF
  1717
  1718     IF (CP-COMPANY-ID = 'CID') AND
  1719        (CP-EARN-AS-NET-PAY) AND
  1720        (CP-TRUNCATED-LIFE) AND
  1721        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  1722        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1723        (WS-DISCOUNT-OPTION NOT = ' ')
  1724        COMPUTE WS-WORK-DIS-RATE =
  1725             RT-DISCOUNT-RATE / +100
  1726        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1727        GO TO 1075-BYPASS-REGULAR-RATE
  1728     END-IF
  1729
  1730     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1731        IF WS-WORK-DIS-RATE NOT EQUAL +0
  1732           COMPUTE WS-WORK-DIS-RATE EQUAL
  1733                   WS-WORK-DIS-RATE / +100.
  1734
  1735     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1736        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1737           IF CP-MONTHLY-PAYMENT EQUAL +0
  1738            IF CP-LOAN-APR GREATER THAN +2
  1739              COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1740              CP-ORIGINAL-BENEFIT /
  1741               ((1 - (1 + (CP-LOAN-APR / +1200)) **
  1742               (WS-RATE-TERM * -1)) / (CP-LOAN-APR / +1200))
  1743            ELSE
  1744             COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1745               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1746
  1747     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1748        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1749          IF WS-WORK-DIS-RATE GREATER THAN +0
  1750           COMPUTE WK1 ROUNDED EQUAL
  1751           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1752                              (WS-RATE-TERM - +1)) /
  1753                        (WS-WORK-DIS-RATE / +12)
  1754           COMPUTE WK2 ROUNDED EQUAL
  1755           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1756                              (WS-RATE-TERM)) /
  1757                        (WS-WORK-DIS-RATE / +12)
  1758           COMPUTE WK3 EQUAL
  1759                RT-DISCOUNT-OB-RATE *
  1760                (1 + WS-WORK-DIS-RATE / +12)
  1761                MOVE WK3 TO CP-PREMIUM-RATE
  1762                COMPUTE WK5 EQUAL WK3 / +1000
  1763           GO TO 1075-BYPASS-REGULAR-RATE.
  1764*               (RT-DISCOUNT-OB-RATE / +1000) *
  1765*               (1 + WS-WORK-DIS-RATE / +12)
  1766*          GO TO 1075-BYPASS-REGULAR-RATE.
  1767
  1768     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1769        IF RT-DISCOUNT-OB-RATE GREATER THAN +0
  1770           COMPUTE WK3 EQUAL
  1771           RT-DISCOUNT-OB-RATE *
  1772           (24 / (24 + WS-WORK-DIS-RATE * WS-RATE-TERM))
  1773           MOVE WK3 TO CP-PREMIUM-RATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  34
* ELRATE.cbl
  1774           COMPUTE WK5 EQUAL WK3 / +1000
  1775           GO TO 1075-BYPASS-REGULAR-RATE.
  1776
  1777     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  1778        (CP-STATE-STD-ABBRV EQUAL 'VT' OR 'MA')
  1779        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1780        GO TO 1075-BYPASS-REGULAR-RATE.
  1781
  1782     COMPUTE WS-SIN-PREM-RATE =
  1783             (RT-DISCOUNT-OB-RATE / +1000) *
  1784             ((WS-RATE-TERM + +1) / +2).
  1785
  1786     COMPUTE CP-PREMIUM-RATE =
  1787             WS-SIN-PREM-RATE /
  1788             (+1 + (((WS-WORK-DIS-RATE / +100) *
  1789             WS-RATE-TERM) / +24)).
  1790
  1791     IF CP-PREMIUM-RATE NOT = +0
  1792        MULTIPLY +100 BY CP-PREMIUM-RATE
  1793        MOVE CP-PREMIUM-RATE TO WS-PREMIUM-RATE
  1794        GO TO 1075-BYPASS-REGULAR-RATE.
  1795
  1796 1050-REGULAR-RATES.
  1797
  1798     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1799        COMPUTE WK5 EQUAL
  1800        ((WS-RATE-TERM * RT-L-RATE (+12)) / +100) /
  1801        (6 * (WS-RATE-TERM + 1))
  1802        MOVE WK5 TO CP-PREMIUM-RATE
  1803        GO TO 1075-BYPASS-REGULAR-RATE.
  1804
  1805     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  1806        (CP-CSL-VALID-NP-BENEFIT-CD)
  1807        IF CP-JOINT-INDICATOR EQUAL 'J'
  1808           MOVE RT-L-RATE (3) TO CP-PREMIUM-RATE
  1809           GO TO 1075-BYPASS-REGULAR-RATE
  1810        ELSE
  1811           MOVE RT-L-RATE (1) TO CP-PREMIUM-RATE
  1812           GO TO 1075-BYPASS-REGULAR-RATE.
  1813
  1814     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  1815        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  1816        (CP-EARN-AS-NET-PAY )
  1817        MOVE RT-L-RATE (12)      TO CP-PREMIUM-RATE
  1818        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  1819        MOVE CP-FIRST-PAY-DATE   TO DC-BIN-DATE-2
  1820        MOVE '1'                 TO DC-OPTION-CODE
  1821        PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  1822        IF DATE-CONVERSION-ERROR
  1823            MOVE '2'                TO CP-RETURN-CODE
  1824            GO TO 9999-CALC-RATE-PREM-X
  1825        ELSE
  1826            COMPUTE CP-ODD-DAYS-TO-PMT = DC-ELAPSED-MONTHS * 30 +
  1827                                         DC-ODD-DAYS-OVER
  1828            GO TO 1075-BYPASS-REGULAR-RATE.
  1829
  1830     IF RT-COMPOSITE-RATE NOT NUMERIC
  1831         MOVE ZEROS                        TO RT-COMPOSITE-RATE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  35
* ELRATE.cbl
  1832
  1833*    IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1834     IF WS-RATE-TERM GREATER ZERO AND LESS 361
  1835         MOVE RT-L-RATE (WS-RATE-TERM)     TO CP-PREMIUM-RATE
  1836                                              WS-PREMIUM-RATE
  1837         MOVE RT-COMPOSITE-RATE            TO CP-COMPOSITE-RATE
  1838     ELSE
  1839         MOVE +0                           TO CP-PREMIUM-RATE
  1840                                              CP-COMPOSITE-RATE
  1841                                              CP-CALC-PREMIUM
  1842         GO TO 9999-CALC-RATE-PREM-X.
  1843
  1844     IF (CP-COMPANY-ID EQUAL 'CID')
  1845        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  1846        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1847        AND (CP-EARN-AS-NET-PAY)
  1848        GO TO 1075-BYPASS-REGULAR-RATE
  1849     END-IF
  1850******************************************************
  1851*    IF CP-COMPANY-ID NOT = 'LBL'
  1852     IF CP-COMPANY-ID NOT = 'LBL' AND 'CID'
  1853         GO TO 1075-BYPASS-REGULAR-RATE.
  1854
  1855     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1856     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.
  1857     MOVE '1'                    TO DC-OPTION-CODE.
  1858     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1859     IF DATE-CONVERSION-ERROR
  1860         MOVE '2'                TO CP-RETURN-CODE
  1861         GO TO 9999-CALC-RATE-PREM-X
  1862       ELSE
  1863         MOVE DC-ELAPSED-MONTHS  TO CP-MNTHS-TO-FIRST-PMT
  1864         MOVE DC-ODD-DAYS-OVER   TO CP-ODD-DAYS-TO-PMT.
  1865
  1866     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN 1
  1867        COMPUTE CP-ODD-DAYS-TO-PMT EQUAL CP-ODD-DAYS-TO-PMT +
  1868        ((CP-MNTHS-TO-FIRST-PMT - 1) * +30).
  1869
  1870     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH)
  1871        IF (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1872           NEXT SENTENCE
  1873         ELSE
  1874           GO TO 1075-BYPASS-REGULAR-RATE
  1875       ELSE
  1876        IF (CP-MNTHS-TO-FIRST-PMT = ZERO) AND
  1877           (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1878           NEXT SENTENCE
  1879         ELSE
  1880           GO TO 1075-BYPASS-REGULAR-RATE.
  1881
  1882     IF CP-MNTHS-TO-FIRST-PMT GREATER ZERO
  1883        COMPUTE CP-PREMIUM-RATE =
  1884        ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1885         * (CP-ORIGINAL-TERM + 1)) - CP-PREMIUM-RATE)
  1886         * (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  1887
  1888     IF CP-MNTHS-TO-FIRST-PMT = ZEROS
  1889        COMPUTE CP-PREMIUM-RATE =
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  36
* ELRATE.cbl
  1890        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  1891        CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - 1))) *
  1892        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  1893        (CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1894         * (CP-ORIGINAL-TERM - 1)).
  1895******************************************************
  1896
  1897 1075-BYPASS-REGULAR-RATE.
  1898
  1899     MOVE CP-LOAN-TERM              TO WS-RATE-TERM.
  1900
  1901     MOVE +1 TO LINDX.
  1902
  1903     IF CP-COMPANY-ID EQUAL 'CRI'
  1904        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  1905           MOVE +5               TO LINDX
  1906           IF RT-L-EX-AGE (LINDX) EQUAL ZERO
  1907              MOVE 'F'           TO CP-RETURN-CODE
  1908              GO TO 1200-CALCULATE-PREMIUMS.
  1909
  1910     IF RT-L-EX-AGE (LINDX) = ZERO
  1911          GO TO 1200-CALCULATE-PREMIUMS.
  1912
  1913 1100-SEARCH-LIFE-LIMITS.
  1914
  1915     IF CP-COMPANY-ID EQUAL 'CRI'
  1916        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  1917           IF LINDX GREATER THAN +4
  1918              MOVE 'A'           TO CP-RETURN-CODE
  1919              GO TO 1200-CALCULATE-PREMIUMS.
  1920
  1921     IF LINDX GREATER +8
  1922         MOVE 'A'                TO CP-RETURN-CODE
  1923         GO TO 1200-CALCULATE-PREMIUMS.
  1924
  1925     IF CP-ISSUE-AGE GREATER RT-L-EX-AGE (LINDX)
  1926         IF RT-L-EX-AGE (LINDX) = ZEROS
  1927             ADD +1              TO LINDX
  1928             GO TO 1100-SEARCH-LIFE-LIMITS
  1929         ELSE
  1930             MOVE RT-L-EX-AGE (LINDX)
  1931                                 TO CP-R-MAX-AGE
  1932             MOVE RT-L-EX-TERM (LINDX)
  1933                                 TO CP-R-MAX-TERM
  1934             MOVE RT-L-EX-FACE (LINDX)
  1935                                 TO CP-R-MAX-TOT-BEN
  1936             ADD +1              TO LINDX
  1937             GO TO 1100-SEARCH-LIFE-LIMITS
  1938     ELSE
  1939         MOVE RT-L-EX-AGE (LINDX)
  1940                                 TO CP-R-MAX-AGE
  1941         MOVE RT-L-EX-TERM (LINDX)
  1942                                 TO CP-R-MAX-TERM
  1943         MOVE RT-L-EX-FACE (LINDX)
  1944                                 TO CP-R-MAX-TOT-BEN.
  1945
  1946     IF CP-ORIGINAL-TERM GREATER RT-L-EX-TERM (LINDX)
  1947         MOVE '9'                TO CP-RETURN-CODE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  37
* ELRATE.cbl
  1948
  1949     IF CP-ORIGINAL-BENEFIT GREATER RT-L-EX-FACE (LINDX)
  1950         MOVE '8'                TO CP-RETURN-CODE.
  1951
  1952 1200-CALCULATE-PREMIUMS.
  1953
  1954     IF CP-COMPANY-ID = 'CSL'
  1955        IF CP-CSL-VALID-NP-BENEFIT-CD
  1956           GO TO 1240-NET-PAY-CONT
  1957        ELSE
  1958           GO TO 1250-CSL-CALC.
  1959
  1960     IF CP-COMPANY-ID = 'WDS'
  1961        IF CP-STATE-STD-ABBRV = 'MN' OR 'NC'
  1962           IF CP-EARN-AS-REG-BALLOON
  1963              GO TO 1240-NET-PAY-CONT.
  1964
  1965     IF (CP-COMPANY-ID = 'CID')
  1966        AND (CP-STATE-STD-ABBRV = 'MN')
  1967        AND (CP-EARN-AS-REG-BALLOON)
  1968        AND (CP-CERT-EFF-DT > X'A4FF')
  1969        GO TO 1240-NET-PAY-CONT
  1970     END-IF
  1971     IF (CP-COMPANY-ID = 'CID')
  1972        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1973           OR 'IN' OR 'AZ')
  1974        AND (CP-FARM-PLAN)
  1975***  OK, I DID THIS SO ERCNETP WOULDN'T ERROR OUT
  1976***  THE APR ISN'T EVEN USED IN THE ROUTINE, SO SUE ME :)
  1977        MOVE +1.0                TO CP-LOAN-APR
  1978        GO TO 1240-NET-PAY-CONT
  1979     END-IF
  1980     IF CP-RATE-AS-STANDARD
  1981         GO TO 1210-REGULAR-RATE.
  1982
  1983     IF CP-CRITICAL-PERIOD
  1984         GO TO 1220-CRITICAL-PERIOD-LF-CONT.
  1985
  1986     IF CP-EARN-AS-TEXAS
  1987         GO TO 1230-TEXAS-CONT.
  1988
  1989     IF CP-EARN-AS-NET-PAY
  1990        IF CP-STATE-STD-ABBRV = 'MD'
  1991          IF CP-COMPANY-ID = 'MON'
  1992            IF CP-BENEFIT-CD = '11' OR '12' OR '13' OR
  1993                               '14' OR '26' OR '47'
  1994              GO TO 1210-REGULAR-RATE.
  1995
  1996     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1997        IF CP-MONTHLY-PAYMENT EQUAL +0
  1998           COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1999                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2000
  2001     IF CP-COMPANY-ID EQUAL 'GTL'
  2002        NEXT SENTENCE
  2003     ELSE
  2004     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2005        IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  38
* ELRATE.cbl
  2006           COMPUTE WK3 ROUNDED EQUAL
  2007           CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2008           CP-MONTHLY-PAYMENT
  2009           COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2010           COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2011           CP-ALTERNATE-BENEFIT)
  2012           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2013           WK3 * WK5
  2014           GO TO 9999-CALC-RATE-PREM-X
  2015        ELSE
  2016           COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2017           (CP-ORIGINAL-TERM - 1 - WK1)) /
  2018           (WS-WORK-DIS-RATE / +12)
  2019           COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2020           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2021                               WK5
  2022           GO TO 9999-CALC-RATE-PREM-X.
  2023
  2024     IF CP-COMPANY-ID EQUAL 'GTL' AND
  2025        CP-STATE-STD-ABBRV EQUAL 'RI' AND
  2026        CP-SPECIAL-CALC-CD EQUAL 'H' AND
  2027        CP-ORIGINAL-TERM LESS THAN +61
  2028        COMPUTE CP-CALC-PREMIUM EQUAL
  2029                        (CP-ORIGINAL-BENEFIT *
  2030           (CP-ORIGINAL-TERM + 1) * CP-PREMIUM-RATE) /
  2031           (20 * (1 + .0019 * CP-ORIGINAL-TERM) * 100)
  2032        COMPUTE CP-CALC-PREMIUM EQUAL
  2033                CP-CALC-PREMIUM +
  2034              (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE *
  2035        (CP-ORIGINAL-TERM + 1)) /
  2036        (10 * (1 + .0027 * (CP-ORIGINAL-TERM + 1)) * 100)
  2037        GO TO 9999-CALC-RATE-PREM-X.
  2038
  2039     IF CP-COMPANY-ID = 'GTL'     AND
  2040        CP-STATE-STD-ABBRV = 'PA' AND
  2041        CP-SPECIAL-CALC-CD = 'H'
  2042         GO TO 1260-GTL-PA-LEASE.
  2043
  2044     IF (CP-EARN-AS-NET-PAY)
  2045        AND (CP-LOAN-APR > ZEROS)
  2046        GO TO 1240-NET-PAY-CONT
  2047     END-IF
  2048
  2049     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  2050         GO TO 1210-REGULAR-RATE.
  2051
  2052**** CHECK TO SEE IF THE LEVEL PORTION OF A BALLOON IS BEING
  2053**** RATED AND BYPASS NET-PAY CHECK IF NO APR HAS BEEN ENTERED.
  2054****
  2055     IF CP-DEVIATION-CODE = 'LEV' AND
  2056        CP-LOAN-APR = ZEROS
  2057         GO TO 1210-REGULAR-RATE.
  2058
  2059     IF (CP-STATE-STD-ABBRV = 'OH')
  2060        AND (CP-CLASS-CODE NOT = 'L ')
  2061        AND (CP-ORIGINAL-TERM > 60)
  2062        AND (DC-GREG-DATE-CYMD > 19831031)
  2063        AND (CP-LOAN-APR > ZEROS)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  39
* ELRATE.cbl
  2064        GO TO 1240-NET-PAY-CONT
  2065     END-IF
  2066
  2067     IF (CP-STATE-STD-ABBRV = 'UT')
  2068        AND (CP-ORIGINAL-TERM > 62)
  2069        AND (DC-GREG-DATE-CYMD > 19810831)
  2070        AND (DC-GREG-DATE-CYMD < 19830901)
  2071        AND (CP-LOAN-APR > ZEROS)
  2072        GO TO 1240-NET-PAY-CONT
  2073     END-IF
  2074
  2075     IF (CP-STATE-STD-ABBRV = 'RI')
  2076        AND (CP-ORIGINAL-TERM > 60)
  2077        AND (DC-GREG-DATE-CYMD > 19831231)
  2078        AND (CP-LOAN-APR > ZEROS)
  2079        GO TO 1240-NET-PAY-CONT
  2080     END-IF
  2081     .
  2082 1210-REGULAR-RATE.
  2083
  2084     IF (CP-COMPANY-ID = 'CID')
  2085        AND (CP-EARN-AS-NET-PAY)
  2086        AND (CP-LOAN-APR = 0)
  2087        IF RT-L-RATE (WS-RATE-TERM) = 0
  2088           COMPUTE WS-SIN-PREM-RATE =
  2089              (RT-DISCOUNT-OB-RATE / +1000) *
  2090              ((WS-RATE-TERM + +1) / +2)
  2091           COMPUTE CP-PREMIUM-RATE =
  2092              WS-SIN-PREM-RATE /
  2093              (+1 + (((WS-WORK-DIS-RATE / +100) *
  2094              WS-RATE-TERM) / +24))
  2095        ELSE
  2096           MOVE RT-L-RATE (WS-RATE-TERM) TO CP-PREMIUM-RATE
  2097        END-IF
  2098     END-IF
  2099*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2100*       IF CP-MONTHLY-PAYMENT EQUAL +0
  2101*          COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2102*               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2103*
  2104*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2105*       IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2106*          COMPUTE WK3 ROUNDED EQUAL
  2107*          CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2108*          CP-MONTHLY-PAYMENT
  2109*          COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2110*          COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2111*          CP-ALTERNATE-BENEFIT)
  2112*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2113*          WK3 * WK5
  2114*          GO TO 9999-CALC-RATE-PREM-X
  2115*       ELSE
  2116*          COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2117*          (CP-ORIGINAL-TERM - 1 - WK1)) /
  2118*          (WS-WORK-DIS-RATE / +12)
  2119*          COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2120*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2121*                              WK5
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  40
* ELRATE.cbl
  2122*          GO TO 9999-CALC-RATE-PREM-X.
  2123
  2124     IF CP-TERM-IS-DAYS
  2125         COMPUTE CP-PREMIUM-RATE ROUNDED =
  2126             ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM) * 12) / +365
  2127         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2128             ((CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE)
  2129                          * CP-TERM-OR-EXT-DAYS
  2130           GO TO 9999-CALC-RATE-PREM-X.
  2131
  2132     IF NOT CP-TRUNCATED-LIFE
  2133         GO TO 1212-GROSS-NOT-TRUNCATED.
  2134
  2135****  GROSS TRUNCATED CALCULATION
  2136
  2137     IF CP-LOAN-TERM NOT GREATER THAN CP-ORIGINAL-TERM
  2138         MOVE 'H'                TO  CP-RETURN-CODE
  2139         GO TO 9999-CALC-RATE-PREM-X.
  2140
  2141     IF CP-COMPANY-ID = 'NCL'
  2142         COMPUTE WK-MONTHLY-RATE =
  2143               ((((CP-LOAN-TERM * (CP-LOAN-TERM + 1) -
  2144                  (CP-LOAN-TERM - CP-ORIGINAL-TERM) *
  2145                  (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1))
  2146                                 /
  2147                  (CP-LOAN-TERM * (CP-LOAN-TERM + 1))))
  2148                                 *
  2149                  ((RT-L-RATE (12) * CP-LOAN-TERM / 12)))
  2150         COMPUTE CP-CALC-PREMIUM =
  2151                 WK-MONTHLY-RATE * CP-ORIGINAL-BENEFIT / 100
  2152     ELSE
  2153         COMPUTE CP-R-MAX-TERM = CP-LOAN-TERM -
  2154                                 CP-ORIGINAL-TERM
  2155         COMPUTE CP-CALC-PREMIUM = CP-ORIGINAL-BENEFIT *
  2156                     ((RT-L-RATE (CP-LOAN-TERM)  -
  2157                     (1 - (CP-ORIGINAL-TERM / CP-LOAN-TERM)) *
  2158                     RT-L-RATE (CP-R-MAX-TERM)) / 100)
  2159     END-IF
  2160     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2161        COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2162           (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2163           CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS)
  2164     END-IF
  2165     GO TO 9999-CALC-RATE-PREM-X
  2166     .
  2167 1212-GROSS-NOT-TRUNCATED.
  2168*    DISPLAY ' ELCRATPD '
  2169*    DISPLAY ' MADE IT TO 1212-GROSS-NOT '
  2170*    display ' premium rate ' cp-premium-rate
  2171
  2172     IF (CP-COMPANY-ID = 'CID')
  2173        AND (CP-STATE-STD-ABBRV = 'VT' OR 'MA'
  2174           OR 'IN')
  2175        AND (CP-BENEFIT-CD = '55' OR '56')
  2176        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2177          (CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM)) *
  2178          (CP-ORIGINAL-TERM) *
  2179          ((CP-ORIGINAL-TERM) / 12) *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  41
* ELRATE.cbl
  2180          ((6.5 * RT-DISCOUNT-OB-RATE) / 1000)
  2181          GO TO 9999-CALC-RATE-PREM-X
  2182     END-IF
  2183     IF (CP-COMPANY-ID = 'CID')
  2184        AND (CP-STATE-STD-ABBRV = 'GA')
  2185        AND (CP-BENEFIT-CD = '55' OR '56' OR '2M' OR '2N')
  2186        COMPUTE WK3 ROUNDED =
  2187          CP-ORIGINAL-BENEFIT *
  2188          ((CP-ORIGINAL-TERM + 1) / 2) *
  2189          (RT-DISCOUNT-OB-RATE / 1000)
  2190          MOVE WK3 TO CP-CALC-PREMIUM
  2191          GO TO 9999-CALC-RATE-PREM-X
  2192     END-IF
  2193     IF (CP-COMPANY-ID EQUAL 'CID')
  2194        AND (CP-STATE-STD-ABBRV = 'MN')
  2195        AND (CP-LEVEL-LIFE)
  2196        AND (CP-CERT-EFF-DT > X'A4FF')
  2197        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  2198        MOVE CP-EXPIRE-DT        TO DC-BIN-DATE-2
  2199        MOVE '1'                 TO DC-OPTION-CODE
  2200        PERFORM 9100-CONVERT-DATE
  2201                                 THRU 9100-EXIT
  2202        IF DATE-CONVERSION-ERROR
  2203           MOVE '2'              TO CP-RETURN-CODE
  2204           MOVE ZEROS            TO FACTOR
  2205                                 CP-CALC-PREMIUM
  2206           GO TO 9999-CALC-RATE-PREM-X
  2207        END-IF
  2208        MOVE DC-ELAPSED-DAYS     TO D
  2209        COMPUTE CP-MONTHLY-PAYMENT = CP-ORIGINAL-BENEFIT /
  2210           (1 / (1 + (CP-LOAN-APR / 100) * D / 360) -
  2211           (CP-PREMIUM-RATE * 12 / 365 * D / 1000))
  2212        COMPUTE CP-CALC-PREMIUM = CP-MONTHLY-PAYMENT *
  2213           CP-PREMIUM-RATE * 12 / 365 * D / 1000
  2214        GO TO 9999-CALC-RATE-PREM-X
  2215     END-IF
  2216     IF (CP-COMPANY-ID = 'CID')
  2217        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2218        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2219           (CP-ORIGINAL-BENEFIT / 1000) * CP-PREMIUM-RATE
  2220     ELSE
  2221        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2222                 (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE
  2223     END-IF
  2224*    display ' calc premium ' cp-calc-premium
  2225
  2226*    IF CP-COMPANY-ID = 'LBL'
  2227     IF (CP-COMPANY-ID = 'LBL' OR 'CID')
  2228        AND (NOT CP-EARN-AS-NET-PAY)
  2229        GO TO 9999-CALC-RATE-PREM-X
  2230     END-IF
  2231
  2232*    display ' fell through to ext days '
  2233     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2234         GO TO 9999-CALC-RATE-PREM-X.
  2235
  2236     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2237         COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  42
* ELRATE.cbl
  2238            (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2239               CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS).
  2240
  2241     GO TO 9999-CALC-RATE-PREM-X.
  2242
  2243 1220-CRITICAL-PERIOD-LF-CONT.
  2244     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2245               (CP-ORIGINAL-BENEFIT / +100) * CP-PREMIUM-RATE.
  2246
  2247     GO TO 9999-CALC-RATE-PREM-X.
  2248
  2249 1230-TEXAS-CONT.
  2250     IF CP-FARM-PLAN
  2251         GO TO 1235-TEXAS-FARM-CONT.
  2252
  2253     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2254               (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2255
  2256     COMPUTE TEX-FACT-9 =
  2257                 (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY) /
  2258                 (CP-ORIGINAL-TERM + 1).
  2259
  2260     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2261                 CP-CALC-PREMIUM * TEX-FACT-9.
  2262
  2263     GO TO 9999-CALC-RATE-PREM-X.
  2264
  2265 1235-TEXAS-FARM-CONT.
  2266     COMPUTE WS-FARM-TERM =
  2267               (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY).
  2268
  2269     COMPUTE WS-PREMIUM-RATE = RT-L-RATE (WS-FARM-TERM) / 2.
  2270     MOVE WS-PREMIUM-RATE         TO CP-PREMIUM-RATE.
  2271
  2272
  2273     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2274              (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2275
  2276     GO TO 9999-CALC-RATE-PREM-X.
  2277
  2278 1240-NET-PAY-CONT.
  2279
  2280     MOVE CP-LOAN-APR             TO N-P-APR.
  2281     MOVE CP-ORIGINAL-TERM        TO N-P-ORIG
  2282                                     N-P-REM
  2283                                     N-P-LOAN.
  2284
  2285     MOVE CP-SPECIAL-CALC-CD      TO N-P-OPT.
  2286
  2287     IF CP-TRUNCATED-LIFE
  2288         MOVE CP-LOAN-TERM        TO N-P-LOAN.
  2289
  2290     IF CP-COMPANY-ID EQUAL 'NCL'
  2291        NEXT SENTENCE
  2292     ELSE
  2293        GO TO 1241-NET-PAY-CONT.
  2294
  2295     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  43
* ELRATE.cbl
  2296     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2
  2297     MOVE '1'                    TO DC-OPTION-CODE
  2298     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2299     IF DATE-CONVERSION-ERROR
  2300         MOVE '2'                TO CP-RETURN-CODE
  2301         GO TO 9999-CALC-RATE-PREM-X
  2302     ELSE
  2303        MOVE DC-ELAPSED-MONTHS   TO CP-MNTHS-TO-FIRST-PMT
  2304        MOVE DC-ODD-DAYS-OVER    TO CP-ODD-DAYS-TO-PMT.
  2305
  2306     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2307        (CP-ODD-DAYS-TO-PMT NOT EQUAL ZEROS)
  2308        NEXT SENTENCE
  2309     ELSE
  2310        MOVE +1                  TO ODF
  2311        GO TO 1241-NET-PAY-CONT.
  2312
  2313     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN ZERO
  2314        COMPUTE CP-PREMIUM-RATE EQUAL
  2315        ((CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN + 1)) -
  2316        CP-PREMIUM-RATE) *
  2317        (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2318
  2319     IF CP-MNTHS-TO-FIRST-PMT EQUAL ZEROS
  2320        COMPUTE CP-PREMIUM-RATE EQUAL
  2321        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2322        N-P-LOAN * (N-P-LOAN - 1))) *
  2323        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2324        (CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN - 1)).
  2325
  2326     COMPUTE ODF EQUAL
  2327     ((1 + (N-P-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  2328     ((1 + (CP-ODD-DAYS-TO-PMT * 12 / 36500))).
  2329
  2330 1241-NET-PAY-CONT.
  2331
  2332     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2333
  2334*    IF CP-RETURN-CODE EQUAL '0' OR '8'
  2335     IF CP-RETURN-CODE EQUAL '0' OR '8' OR '9' OR 'B'
  2336        NEXT SENTENCE
  2337     ELSE
  2338        GO TO 9999-CALC-RATE-PREM-X.
  2339
  2340     IF RT-DISCOUNT-OPTION EQUAL '6'
  2341         GO TO 9999-CALC-RATE-PREM-X.
  2342
  2343     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2344        (CP-STATE-STD-ABBRV EQUAL 'IA')
  2345        GO TO 9999-CALC-RATE-PREM-X.
  2346
  2347     MOVE N-P-FACTOR              TO CP-CDT-FACTOR.
  2348
  2349     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  2350        GO TO 9999-CALC-RATE-PREM-X.
  2351
  2352     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2353        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  44
* ELRATE.cbl
  2354        (CP-TRUNCATED-LIFE)
  2355        GO TO 9999-CALC-RATE-PREM-X.
  2356
  2357     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2358        (CP-CSL-VALID-NP-BENEFIT-CD)
  2359        GO TO 9999-CALC-RATE-PREM-X.
  2360
  2361     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  2362        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  2363        (CP-EARN-AS-NET-PAY)
  2364        GO TO 9999-CALC-RATE-PREM-X.
  2365
  2366*    IF (CP-COMPANY-ID EQUAL 'CID') AND
  2367*       (CP-STATE-STD-ABBRV EQUAL 'NV') AND
  2368*       (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  2369*       GO TO 9999-CALC-RATE-PREM-X.
  2370
  2371     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  2372        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2373        (CP-EARN-AS-NET-PAY)
  2374        GO TO 9999-CALC-RATE-PREM-X.
  2375
  2376     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  2377        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  2378        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2379        GO TO 9999-CALC-RATE-PREM-X.
  2380
  2381     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2382        (CP-EARN-AS-NET-PAY)
  2383        GO TO 9999-CALC-RATE-PREM-X.
  2384
  2385     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2386        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  2387        (CP-TRUNCATED-LIFE)
  2388        GO TO 9999-CALC-RATE-PREM-X.
  2389
  2390     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2391        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  2392        (CP-EARN-AS-NET-PAY)
  2393*       (CP-TRUNCATED-LIFE)
  2394        GO TO 9999-CALC-RATE-PREM-X.
  2395
  2396     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2397        (CP-STATE-STD-ABBRV EQUAL 'RI')
  2398                   AND
  2399        ((CP-EARN-AS-NET-PAY)
  2400               OR
  2401        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  2402        GO TO 9999-CALC-RATE-PREM-X.
  2403
  2404     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2405        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  2406        (CP-EARN-AS-NET-PAY) AND
  2407        (CP-SPECIAL-CALC-CD EQUAL 'H')
  2408        GO TO 9999-CALC-RATE-PREM-X.
  2409
  2410     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2411        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  45
* ELRATE.cbl
  2412        (CP-EARN-AS-NET-PAY)
  2413        GO TO 9999-CALC-RATE-PREM-X.
  2414
  2415     IF CP-COMPANY-ID = 'CID'
  2416        CONTINUE
  2417     ELSE
  2418        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2419           (CP-EARN-AS-NET-PAY) AND
  2420           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  2421           GO TO 9999-CALC-RATE-PREM-X
  2422        END-IF
  2423     END-IF
  2424
  2425     IF (CP-COMPANY-ID = 'CID')
  2426        AND (CP-EARN-AS-NET-PAY)
  2427        AND (CP-STATE-STD-ABBRV = 'ME')
  2428        GO TO 9999-CALC-RATE-PREM-X
  2429     END-IF
  2430     IF (CP-COMPANY-ID = 'DCC')
  2431        AND (CP-BEN-CATEGORY = 'D')
  2432        AND (CP-EARN-AS-NET-PAY)
  2433        GO TO 9999-CALC-RATE-PREM-X
  2434     END-IF
  2435     IF (CP-COMPANY-ID = 'CID')
  2436        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2437           OR 'IN' OR 'AZ')
  2438        AND (CP-FARM-PLAN)
  2439        GO TO 9999-CALC-RATE-PREM-X
  2440     END-IF
  2441     IF (CP-COMPANY-ID = 'CID') AND
  2442        (CP-EARN-AS-NET-PAY) AND
  2443        (CP-LEVEL-LIFE) AND
  2444        (CP-STATE-STD-ABBRV = 'CA' OR 'MN') AND
  2445        (CP-STATE-STD-ABBRV = CP-STATE)
  2446        GO TO 9999-CALC-RATE-PREM-X
  2447     END-IF
  2448
  2449     IF (CP-COMPANY-ID = 'CID') AND
  2450        (CP-EARN-AS-NET-PAY) AND
  2451        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  2452                            OR 'VT')
  2453                   OR
  2454        ((CP-STATE-STD-ABBRV = 'IN') AND
  2455        (CP-CERT-EFF-DT > X'9A7F'))
  2456                   OR
  2457        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  2458        (CP-CERT-EFF-DT > X'9ADF'))) AND
  2459        (CP-STATE-STD-ABBRV = CP-STATE)
  2460        GO TO 9999-CALC-RATE-PREM-X
  2461     END-IF
  2462
  2463     IF (CP-COMPANY-ID = 'CID') AND
  2464        (CP-EARN-AS-NET-PAY) AND
  2465        (CP-STATE-STD-ABBRV = 'TX') AND
  2466        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2467        (WS-DISCOUNT-OPTION NOT = ' ')
  2468        GO TO 9999-CALC-RATE-PREM-X
  2469     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  46
* ELRATE.cbl
  2470
  2471     IF (CP-COMPANY-ID = 'CID')
  2472        AND (CP-STATE-STD-ABBRV = 'MN')
  2473        AND (RT-DISCOUNT-OPTION = '1')
  2474        AND (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2475        GO TO 9999-CALC-RATE-PREM-X
  2476     END-IF
  2477     IF (CP-COMPANY-ID = 'CID')
  2478        AND (CP-EARN-AS-NET-PAY)
  2479        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  2480                      OR
  2481            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  2482        GO TO 9999-CALC-RATE-PREM-X
  2483     END-IF
  2484     IF (CP-COMPANY-ID = 'CID')
  2485        AND (CP-EARN-AS-NET-PAY)
  2486        AND (CP-STATE-STD-ABBRV = 'SC')
  2487        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2488        GO TO 9999-CALC-RATE-PREM-X
  2489     END-IF
  2490     IF (CP-COMPANY-ID = 'CID') AND
  2491        (CP-EARN-AS-NET-PAY) AND
  2492        (CP-TRUNCATED-LIFE) AND
  2493        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  2494        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2495        (WS-DISCOUNT-OPTION NOT = ' ')
  2496        GO TO 9999-CALC-RATE-PREM-X
  2497     END-IF
  2498
  2499     IF (CP-COMPANY-ID EQUAL 'DCC') AND
  2500        (CP-EARN-AS-NET-PAY)
  2501        MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE
  2502        GO TO 9999-CALC-RATE-PREM-X
  2503     END-IF
  2504
  2505     IF (CP-COMPANY-ID EQUAL 'CID')
  2506        AND (CP-EARN-AS-NET-PAY)
  2507        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2508        GO TO 9999-CALC-RATE-PREM-X
  2509     END-IF
  2510
  2511     IF (RT-IS-OB) AND
  2512        (CP-COMPANY-ID NOT EQUAL 'CID')
  2513        COMPUTE CP-PREMIUM-RATE ROUNDED =
  2514               (CP-PREMIUM-RATE * 12) / CP-LOAN-TERM
  2515      ELSE
  2516         IF (CP-COMPANY-ID = 'DCC')
  2517            AND (CP-RATE-DEV-PCT NOT = ZEROS)
  2518            COMPUTE CP-CALC-PREMIUM ROUNDED =
  2519*           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2520             (CP-PREMIUM-RATE * CP-RATE-DEV-PCT * 12) /
  2521               CP-ORIGINAL-TERM
  2522             MOVE CP-CALC-PREMIUM TO CP-PREMIUM-RATE
  2523             MOVE ZEROS          TO CP-RATE-DEV-PCT
  2524        ELSE
  2525           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2526               (CP-PREMIUM-RATE * 12) / CP-ORIGINAL-TERM
  2527        END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  47
* ELRATE.cbl
  2528     END-IF
  2529
  2530     IF CP-ROA-PREM-AT-REFUND
  2531         COMPUTE NET-BEN ROUNDED =
  2532             (CP-REMAINING-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000
  2533     ELSE
  2534         COMPUTE NET-BEN ROUNDED =
  2535              (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000.
  2536
  2537     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2538        (CP-TERM-OR-EXT-DAYS NOT = ZERO)
  2539          COMPUTE NET-BEN ROUNDED =
  2540              NET-BEN * (1 + (CP-LOAN-APR / 1200) *
  2541                         (CP-TERM-OR-EXT-DAYS / 30)).
  2542
  2543     IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'CID' OR 'MON' OR 'HAN'
  2544*       OR 'DCC'
  2545*    IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'MON' OR 'HAN'
  2546     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2547       (N-P-FACTOR * CP-PREMIUM-RATE * CP-ORIGINAL-TERM / 1200) /
  2548       (1 - (N-P-FACTOR * CP-PREMIUM-RATE
  2549                        * CP-ORIGINAL-TERM / 1200))
  2550     ELSE
  2551     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2552       (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200) /
  2553       (1 - (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200)).
  2554
  2555****** THE BELOW VERSION OF THE NET PAY FORMULA IS USED WHEN NO
  2556****** INTEREST IS CHARGED ON PREMIUM.
  2557
  2558*    IF CP-STATE-STD-ABBRV = 'MI'
  2559*         COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2560*          (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200).
  2561
  2562     MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE.
  2563
  2564     GO TO 9999-CALC-RATE-PREM-X.
  2565
  2566******
  2567****** BELOW ARE PREMIUM CALCULATIONS FOR CSL
  2568******
  2569
  2570 1250-CSL-CALC.
  2571     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2572     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2573     MOVE '1' TO DC-OPTION-CODE.
  2574     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2575
  2576     IF DATE-CONVERSION-ERROR
  2577         MOVE '2' TO CP-RETURN-CODE
  2578         GO TO 9999-CALC-RATE-PREM-X.
  2579
  2580     IF CP-JOINT-INDICATOR = 'J'
  2581         MOVE RT-L-RATE (3) TO WK-RED-RATE
  2582     ELSE
  2583         MOVE RT-L-RATE (1) TO WK-RED-RATE.
  2584
  2585     MOVE WK-RED-RATE TO CP-PREMIUM-RATE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  48
* ELRATE.cbl
  2586     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2587
  2588     IF CP-PAY-FREQUENCY = 12
  2589         MOVE 01               TO WS-PAY-SCH.
  2590     IF CP-PAY-FREQUENCY = 04
  2591         MOVE 03               TO WS-PAY-SCH.
  2592     IF CP-PAY-FREQUENCY = 02
  2593         MOVE 06               TO WS-PAY-SCH.
  2594     IF CP-PAY-FREQUENCY = 01
  2595         MOVE 12               TO WS-PAY-SCH.
  2596
  2597     COMPUTE WS-NUM-PAYMTS = CP-ORIGINAL-TERM / WS-PAY-SCH.
  2598     IF CP-PAY-FREQUENCY NOT = 12
  2599         COMPUTE WK-PAY-AMT = CP-REMAINING-BENEFIT /
  2600                                WS-NUM-PAYMTS.
  2601
  2602     IF CP-STATE = 'SC'  AND
  2603       (CP-BENEFIT-CD = '07'  OR  '08')
  2604         GO TO 1250-CSL-CALC-LIFE-6.
  2605
  2606     IF CP-CSL-METH-1
  2607         GO TO 1250-CSL-CALC-LIFE-1.
  2608
  2609     IF CP-CSL-METH-2
  2610         IF (WK-PAY-AMT * CP-LOAN-TERM) GREATER THAN
  2611                          WS-MAX-TOT-BEN
  2612             GO TO 1250-CSL-CALC-LIFE-2
  2613         ELSE
  2614             GO TO 1250-CSL-CALC-LIFE-1.
  2615
  2616     IF CP-CSL-METH-3
  2617         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2618             GO TO 1250-CSL-CALC-LIFE-2
  2619         ELSE
  2620             GO TO 1250-CSL-CALC-LIFE-3.
  2621
  2622     IF CP-CSL-METH-4
  2623         IF (WK-PAY-AMT * WS-NUM-PAYMTS) GREATER THAN
  2624                          WS-MAX-TOT-BEN
  2625             GO TO 1250-CSL-CALC-LIFE-5
  2626         ELSE
  2627             GO TO 1250-CSL-CALC-LIFE-4.
  2628
  2629 1250-CSL-CALC-LIFE-1.
  2630     IF CP-JOINT-INDICATOR = 'J'
  2631         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2632     ELSE
  2633         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2634
  2635     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY) /
  2636                    365) - 1) * 365 / 12.
  2637     COMPUTE WK-S ROUNDED = ((144 * WK-D * WK-LEV-RATE) +
  2638                    (365 * WS-NUM-PAYMTS * WK-RED-RATE)) /
  2639                    4380.
  2640     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PAY-AMT *
  2641                    WS-NUM-PAYMTS * WK-S.
  2642
  2643     GO TO 9999-CALC-RATE-PREM-X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  49
* ELRATE.cbl
  2644
  2645 1250-CSL-CALC-LIFE-2.
  2646     IF CP-JOINT-INDICATOR = 'J'
  2647         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2648     ELSE
  2649         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2650
  2651     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2652     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2653     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2654                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2655                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2656     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2657                    WK-S) + WK-D.
  2658
  2659     GO TO 9999-CALC-RATE-PREM-X.
  2660
  2661 1250-CSL-CALC-LIFE-3.
  2662     IF CP-JOINT-INDICATOR = 'J'
  2663         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2664     ELSE
  2665         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2666
  2667     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2668     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2669     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2670                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2671                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2672     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2673                    WK-S) + WK-D.
  2674
  2675     GO TO 9999-CALC-RATE-PREM-X.
  2676
  2677 1250-CSL-CALC-LIFE-4.
  2678     IF CP-JOINT-INDICATOR = 'J'
  2679         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2680     ELSE
  2681         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2682
  2683     COMPUTE WK-D = DC-ELAPSED-DAYS * 12 / 365.
  2684     COMPUTE WK-S ROUNDED =
  2685                    (((6 * (WS-NUM-PAYMTS - 1)) + (WK-D *
  2686                    CP-PAY-FREQUENCY)) * WK-LEV-RATE) /
  2687                    CP-PAY-FREQUENCY.
  2688     COMPUTE CP-CALC-PREMIUM ROUNDED =  WK-PAY-AMT *
  2689                    WS-NUM-PAYMTS * WK-S.
  2690
  2691     GO TO 9999-CALC-RATE-PREM-X.
  2692
  2693 1250-CSL-CALC-LIFE-5.
  2694     IF CP-JOINT-INDICATOR = 'J'
  2695         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2696     ELSE
  2697         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2698
  2699     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2700     COMPUTE WK-S ROUNDED = (6 * (WK-K + 1) * WK-LEV-RATE) /
  2701                    CP-PAY-FREQUENCY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  50
* ELRATE.cbl
  2702     COMPUTE WK-U = ((((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2703                    - 1) + WS-NUM-PAYMTS) * 12) /
  2704                    CP-PAY-FREQUENCY.
  2705     COMPUTE WK-L = WK-U - (12 * WK-K / CP-PAY-FREQUENCY).
  2706     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-L * WK-LEV-RATE *
  2707                    WS-MAX-TOT-BEN) + (WK-K * WK-PAY-AMT * WK-S).
  2708
  2709     GO TO 9999-CALC-RATE-PREM-X.
  2710
  2711 1250-CSL-CALC-LIFE-6.
  2712
  2713     COMPUTE CP-PREMIUM-RATE ROUNDED =
  2714                (CP-PREMIUM-RATE * CP-ORIGINAL-TERM) / 12.
  2715
  2716     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2717                    CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE.
  2718
  2719     GO TO 9999-CALC-RATE-PREM-X.
  2720
  2721******
  2722****** END OF PREMIUM CALCULATIONS FOR CSL
  2723******
  2724
  2725 1260-GTL-PA-LEASE.
  2726
  2727     IF CP-REDUCING-LIFE
  2728         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2729                                 TO  CP-PREMIUM-RATE
  2730         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2731                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / +100
  2732     ELSE
  2733         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2734                                 TO  CP-PREMIUM-RATE
  2735         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2736                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE *
  2737                 (+1 + CP-SALES-TAX) / +100.
  2738
  2739     GO TO 9999-CALC-RATE-PREM-X.
  2740
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  51
* ELRATE.cbl
  2742******************************************************************
  2743 2000-TYPE-IS-AH.
  2744     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  2745
  2746     MOVE ZERO                      TO CP-R-MAX-AGE
  2747                                       CP-R-MAX-TERM
  2748                                       CP-R-MAX-MON-BEN
  2749                                       CP-R-MAX-TOT-BEN.
  2750
  2751     IF RT-POLICY-FEE NUMERIC
  2752        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  2753
  2754     IF RT-COMPOSITE-RATE NOT NUMERIC
  2755        MOVE ZEROS                          TO RT-COMPOSITE-RATE.
  2756
  2757     IF CP-ORIGINAL-TERM > ZERO AND < 361
  2758        MOVE RT-AH-RATE (CP-ORIGINAL-TERM)
  2759                                 TO CP-PREMIUM-RATE
  2760                                    WS-PREMIUM-RATE
  2761        MOVE RT-COMPOSITE-RATE   TO CP-COMPOSITE-RATE
  2762     ELSE
  2763         MOVE +0                 TO CP-PREMIUM-RATE
  2764                                    CP-CALC-PREMIUM
  2765         GO TO 9999-CALC-RATE-PREM-X
  2766     END-IF
  2767
  2768     MOVE +1 TO AHNDX.
  2769
  2770     IF CP-COMPANY-ID EQUAL 'CRI'
  2771        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2772           MOVE +5               TO AHNDX
  2773           IF RT-AH-AGE (AHNDX) EQUAL ZERO
  2774              MOVE 'F'           TO CP-RETURN-CODE
  2775              GO TO 2200-CALCULATE-PREMIUMS.
  2776
  2777     IF RT-AH-AGE (AHNDX) = ZERO
  2778          GO TO 2200-CALCULATE-PREMIUMS.
  2779
  2780 2100-SEARCH-AH-LIMITS.
  2781
  2782     IF CP-COMPANY-ID EQUAL 'CRI'
  2783        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2784           IF AHNDX GREATER THAN +4
  2785              MOVE 'A'             TO CP-RETURN-CODE
  2786              GO TO 2200-CALCULATE-PREMIUMS.
  2787
  2788     IF AHNDX GREATER +8
  2789         MOVE 'A'                TO CP-RETURN-CODE
  2790         GO TO 2200-CALCULATE-PREMIUMS.
  2791
  2792     IF CP-ISSUE-AGE GREATER RT-AH-AGE (AHNDX)
  2793         IF RT-AH-AGE (AHNDX) = ZEROS
  2794             ADD +1               TO AHNDX
  2795             GO TO 2100-SEARCH-AH-LIMITS
  2796         ELSE
  2797             MOVE RT-AH-AGE (AHNDX)
  2798                                 TO CP-R-MAX-AGE
  2799             MOVE RT-AH-TERM (AHNDX)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  52
* ELRATE.cbl
  2800                                 TO CP-R-MAX-TERM
  2801             MOVE RT-AH-BEN-M (AHNDX)
  2802                                 TO CP-R-MAX-MON-BEN
  2803             ADD +1               TO AHNDX
  2804             GO TO 2100-SEARCH-AH-LIMITS
  2805     ELSE
  2806         MOVE RT-AH-AGE  (AHNDX) TO CP-R-MAX-AGE
  2807         MOVE RT-AH-TERM (AHNDX) TO CP-R-MAX-TERM
  2808         MOVE RT-AH-BEN-M (AHNDX)
  2809                                 TO CP-R-MAX-MON-BEN.
  2810
  2811     IF CP-ORIGINAL-TERM GREATER RT-AH-TERM (AHNDX)
  2812         MOVE '9'                 TO CP-RETURN-CODE.
  2813
  2814     IF CP-ORIGINAL-BENEFIT GREATER RT-AH-BEN-M (AHNDX)
  2815         MOVE '8'                 TO CP-RETURN-CODE.
  2816
  2817     MULTIPLY CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  2818         GIVING WS-AH-FACE-BENEFIT.
  2819
  2820     IF WS-AH-FACE-BENEFIT GREATER RT-AH-BEN-F (AHNDX)
  2821         MOVE 'C'                 TO CP-RETURN-CODE.
  2822
  2823 2200-CALCULATE-PREMIUMS.
  2824
  2825     IF CP-COMPANY-ID = 'CSL'
  2826         GO TO 2250-CSL-CALC.
  2827
  2828*    IF CP-CRITICAL-PERIOD
  2829*       GO TO 2200-CRITICAL-PERIOD-AH-CONT.
  2830
  2831     IF CP-CRITICAL-PERIOD
  2832        IF (CP-COMPANY-ID = 'DCC')
  2833           AND ((CP-BENEFIT-CD (1:1) = 'N' OR 'M' OR 'H' OR 'S')
  2834                          OR
  2835                (CP-BEN-CATEGORY = 'G' OR 'L'))
  2836           CONTINUE
  2837        ELSE
  2838           GO TO 2200-CRITICAL-PERIOD-AH-CONT
  2839        END-IF
  2840     END-IF
  2841
  2842     IF (CP-COMPANY-ID = 'DCC')
  2843        AND (CP-BEN-CATEGORY = 'D')
  2844        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  2845           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  2846     END-IF
  2847     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2848        COMPUTE WS-TERM-MINUS-ONE EQUAL CP-ORIGINAL-TERM - +1
  2849        MOVE RT-AH-RATE (WS-TERM-MINUS-ONE) TO
  2850                                     CP-PREMIUM-RATE
  2851        COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2852        (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM - +1) *
  2853        CP-PREMIUM-RATE) / +100
  2854     ELSE
  2855        IF (CP-COMPANY-ID = 'DCC')
  2856           AND (CP-BEN-CATEGORY NOT = 'G' AND 'L')
  2857           MOVE CP-PREMIUM-RATE  TO WK-S
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  53
* ELRATE.cbl
  2858*          MOVE CP-PREMIUM-RATE  TO CP-CALC-PREMIUM
  2859           IF CP-RATE-DEV-PCT NOT = ZEROS
  2860              COMPUTE WK-S ROUNDED =
  2861                 (CP-PREMIUM-RATE * CP-RATE-DEV-PCT)
  2862           END-IF
  2863           IF CP-BENEFIT-CD (1:1) = 'M'
  2864              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2865              CP-ORIGINAL-BENEFIT * WK-S / 100
  2866           ELSE
  2867              IF CP-BENEFIT-CD (1:1) = 'H'
  2868                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2869                    (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2870                    WK-S) / 1000
  2871              ELSE
  2872                 IF CP-BENEFIT-CD (1:1) = 'N' OR 'S'
  2873                    GO TO 2300-CALC-DCC-MOB-NET-AH
  2874                 ELSE
  2875                    IF CP-BEN-CATEGORY = 'D'
  2876                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2877                        CP-ORIGINAL-BENEFIT *
  2878                        CP-ORIGINAL-TERM * WK-S / 100
  2879                    ELSE
  2880                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2881                        (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2882                        WK-S) / 100
  2883                    END-IF
  2884                 END-IF
  2885              END-IF
  2886           END-IF
  2887           MOVE ZEROS            TO CP-RATE-DEV-PCT
  2888        ELSE
  2889           IF CP-BENEFIT-CD (1:1) = 'M'
  2890              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2891                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 100
  2892           ELSE
  2893              IF CP-BENEFIT-CD (1:1) = 'N' OR 'H'
  2894                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2895                    (CP-NET-BENEFIT-AMT *
  2896                    CP-PREMIUM-RATE) / 1000
  2897              ELSE
  2898                 IF CP-AH-BALLOON-SW = 'Y'
  2899                    COMPUTE CP-CALC-PREMIUM ROUNDED =
  2900                      (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM) *
  2901                      CP-PREMIUM-RATE) / 100
  2902                 ELSE
  2903                   COMPUTE CP-CALC-PREMIUM ROUNDED =
  2904                    (CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM *
  2905                    CP-PREMIUM-RATE) / 100
  2906                 END-IF
  2907              END-IF
  2908           END-IF
  2909        END-IF
  2910     END-IF
  2911
  2912     IF (CP-COMPANY-ID = 'DCC')
  2913        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  2914        COMPUTE CP-CALC-PREMIUM = CP-PREMIUM-RATE * +1000
  2915     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  54
* ELRATE.cbl
  2916     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2917         GO TO 9999-CALC-RATE-PREM-X.
  2918
  2919     IF CP-EXT-CHG-AH OR CP-EXT-CHG-LF-AH
  2920         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2921             CP-CALC-PREMIUM +
  2922                 (((CP-CALC-PREMIUM / CP-ORIGINAL-TERM) / 30)
  2923                                       * CP-TERM-OR-EXT-DAYS).
  2924
  2925     GO TO 9999-CALC-RATE-PREM-X.
  2926
  2927 2200-CRITICAL-PERIOD-AH-CONT.
  2928
  2929     IF CP-COMPANY-ID = 'WDS'
  2930         IF CP-ORIGINAL-TERM GREATER THAN 60
  2931             MOVE 60              TO CP-LOAN-TERM.
  2932
  2933     IF CP-COMPANY-ID EQUAL 'CVL'
  2934         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2935           ((CP-ORIGINAL-BENEFIT * CP-CRITICAL-MONTHS) / +100)
  2936                                       * CP-PREMIUM-RATE
  2937         GO TO 9999-CALC-RATE-PREM-X.
  2938
  2939     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2940           ((CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM) / +100)
  2941                                       * CP-PREMIUM-RATE.
  2942
  2943     GO TO 9999-CALC-RATE-PREM-X.
  2944
  2945 2250-CSL-CALC.
  2946
  2947     IF RT-DAILY-RATE NOT NUMERIC OR
  2948        RT-DAILY-RATE = ZEROS
  2949            MOVE ZEROS TO CP-CALC-PREMIUM
  2950            MOVE '7' TO CP-RETURN-CODE
  2951            GO TO 9999-CALC-RATE-PREM-X.
  2952
  2953     COMPUTE WK-DAILY-RATE = RT-DAILY-RATE / 100.
  2954     COMPUTE WK-MONTHLY-RATE =
  2955          RT-AH-RATE (CP-ORIGINAL-TERM) / 100.
  2956
  2957     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2958     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2959     MOVE '1' TO DC-OPTION-CODE.
  2960     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2961     IF DATE-CONVERSION-ERROR
  2962         MOVE '2' TO CP-RETURN-CODE
  2963         GO TO 9999-CALC-RATE-PREM-X.
  2964
  2965     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2966     IF CP-CSL-METH-1
  2967         GO TO 2250-CSL-CALC-AH-1.
  2968     IF CP-CSL-METH-2
  2969         GO TO 2250-CSL-CALC-AH-2.
  2970     IF CP-CSL-METH-3
  2971         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2972             GO TO 2250-CSL-CALC-AH-4
  2973         ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  55
* ELRATE.cbl
  2974             GO TO 2250-CSL-CALC-AH-3.
  2975
  2976 2250-CSL-CALC-AH-1.
  2977
  2978     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  2979     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  2980                    + WK-MONTHLY-RATE.
  2981     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-MONTHLY-PAYMENT *
  2982                    CP-ORIGINAL-TERM * WK-D.
  2983
  2984     GO TO 9999-CALC-RATE-PREM-X.
  2985
  2986
  2987 2250-CSL-CALC-AH-2.
  2988     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  2989     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  2990                    + WK-MONTHLY-RATE.
  2991     COMPUTE CP-CALC-PREMIUM ROUNDED = WS-MAX-MON-BEN *
  2992                    CP-ORIGINAL-TERM * WK-D.
  2993
  2994     GO TO 9999-CALC-RATE-PREM-X.
  2995
  2996 2250-CSL-CALC-AH-3.
  2997
  2998     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2999     COMPUTE WK-T = WK-K + 1.
  3000     COMPUTE WK-MONTHLY-RATE-T =
  3001          RT-AH-RATE (WK-T) / 100.
  3002     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3003
  3004     COMPUTE WK-T1 = WK-K * (CP-ORIGINAL-TERM - WK-T).
  3005     IF WK-T1 EQUAL ZEROS
  3006         MOVE ZEROS TO CP-CALC-PREMIUM
  3007         MOVE 'G' TO CP-RETURN-CODE
  3008         GO TO 9999-CALC-RATE-PREM-X.
  3009
  3010     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3011                    WK-MONTHLY-RATE)) / (WK-K * (CP-ORIGINAL-TERM
  3012                    - WK-T)).
  3013     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3014     COMPUTE WK-PREM = ((CP-ORIGINAL-TERM -
  3015                       (WK-K + 1) + (WK-D - 1))) * (WK-C *
  3016                       WS-MAX-TOT-BEN).
  3017     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * (WK-K + 1) *
  3018                    WK-MONTHLY-RATE-T) + WK-PREM.
  3019
  3020     GO TO 9999-CALC-RATE-PREM-X.
  3021
  3022 2250-CSL-CALC-AH-4.
  3023     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3024     COMPUTE WK-J = WS-MAX-TOT-BEN / WS-MAX-MON-BEN.
  3025     COMPUTE WK-MONTHLY-RATE-J =
  3026          RT-AH-RATE (WK-J) / 100.
  3027     COMPUTE WK-T = WK-J + 1.
  3028     COMPUTE WK-MONTHLY-RATE-T =
  3029          RT-AH-RATE (WK-T) / 100.
  3030     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3031     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  56
* ELRATE.cbl
  3032                    WK-MONTHLY-RATE)) / ((WK-T - 1) *
  3033                    (CP-ORIGINAL-TERM - WK-T)).
  3034     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3035     COMPUTE WK-PREM = (CP-ORIGINAL-TERM -
  3036                       (WK-J + 1) + (WK-D - 1)) * (WK-C *
  3037                       WS-MAX-TOT-BEN).
  3038     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PREM + ((WK-J + 1) *
  3039                   (WS-MAX-MON-BEN * WK-MONTHLY-RATE-T)).
  3040
  3041     GO TO 9999-CALC-RATE-PREM-X.
  3042
  3043 2300-CALC-DCC-MOB-NET-AH.
  3044     IF CP-ALTERNATE-BENEFIT = ZEROS
  3045        CONTINUE
  3046     ELSE
  3047        GO TO 2300-CALC-DCC-MOB-BAL-AH
  3048     END-IF
  3049     MOVE CP-ORIGINAL-TERM       TO M
  3050     MOVE CP-LOAN-TERM           TO N
  3051     IF N = ZEROS
  3052        MOVE M                   TO N
  3053     END-IF
  3054     COMPUTE I = CP-LOAN-APR / +1200
  3055     IF CP-BENEFIT-CD (1:1) = 'S'
  3056        COMPUTE OD = CP-DAYS-TO-1ST-PMT - 30
  3057        COMPUTE WK3 = CP-ORIGINAL-BENEFIT *
  3058        ((M * (M + 1) / 2) + (M * OD / 30)) *
  3059          (WK-S / 1000)
  3060          * 1
  3061        MOVE WK3                 TO CP-CALC-PREMIUM
  3062        GO TO 9999-CALC-RATE-PREM-X
  3063     END-IF
  3064     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3065        / (1 + I)
  3066     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3067          ** ((N - M) * -1))) / I)
  3068     COMPUTE ANGLEN-M = ANGLEN-M / OD
  3069     COMPUTE J = I + (WK-S / +1000)
  3070     COMPUTE WK2 = (1 + J) ** (M * -1)
  3071     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3072     COMPUTE ANGLEM = ((1 - ((1 + J)
  3073          ** (M * -1))) / J) / OD
  3074     IF CP-NET-BENEFIT-AMT = ZEROS
  3075        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3076           * ANGLEM
  3077     END-IF
  3078     COMPUTE RA = CP-NET-BENEFIT-AMT / (ANGLEM + ANGLEN-M)
  3079     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3080          ** ((N - M) * -1))) / I)
  3081     MOVE +0                     TO WK3
  3082     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3083        (WS-COUNTER > M)
  3084        COMPUTE ANGLEM = (1 - ((1 + J)
  3085          ** ((M - WS-COUNTER + 1) * -1))) / J
  3086        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  3087        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  3088        COMPUTE WK3 = WK3 + (WK5-CSL * WK-S / +1000)
  3089     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  57
* ELRATE.cbl
  3090     MOVE WK3                    TO CP-CALC-PREMIUM
  3091     GO TO 9999-CALC-RATE-PREM-X
  3092     .
  3093 2300-CALC-DCC-MOB-BAL-AH.
  3094     IF CP-BENEFIT-CD (1:1) = 'S'
  3095        GO TO 2300-CALC-DCC-MOB-BAL-AHSUM
  3096     END-IF
  3097     MOVE CP-ORIGINAL-TERM       TO M
  3098     MOVE CP-LOAN-TERM           TO N
  3099     IF N = ZEROS
  3100        MOVE M                   TO N
  3101     END-IF
  3102     COMPUTE I = CP-LOAN-APR / +1200
  3103     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3104        / (1 + I)
  3105     COMPUTE ANGLEN-M = (WK5 / I) / OD
  3106     COMPUTE J = I + (WK-S / +1000)
  3107     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  3108     MOVE I TO K
  3109     COMPUTE WK2 = (1 + J) ** (M * -1)
  3110     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3111     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  3112          ** ((M - 1) * -1))) / J)
  3113     COMPUTE ANGLEM = ((1 - ((1 + J)
  3114          ** (M * -1))) / J) / OD
  3115     IF CP-NET-BENEFIT-AMT = ZEROS
  3116        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3117           * ANGLEM
  3118     END-IF
  3119     COMPUTE RA = (CP-NET-BENEFIT-AMT * OD -
  3120        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  3121        / ANGLEM-1
  3122     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3123          ** ((N - M) * -1))) / I)
  3124     MOVE +0                     TO WK3
  3125     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3126        (WS-COUNTER > M)
  3127        COMPUTE ANGLEM = (1 - ((1 + J)
  3128          ** ((M - WS-COUNTER) * -1))) / J
  3129        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  3130        COMPUTE WK5-CSL = (RA * ANGLEM)
  3131        + (CP-ALTERNATE-BENEFIT * WK2)
  3132        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  3133          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  3134          (WK-S / 1000)
  3135     END-PERFORM
  3136     MOVE WK3                    TO CP-CALC-PREMIUM
  3137     GO TO 9999-CALC-RATE-PREM-X
  3138     .
  3139 2300-CALC-DCC-MOB-BAL-AHSUM.
  3140     MOVE CP-ORIGINAL-TERM       TO M
  3141     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3142        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  3143        * WK-S / 1000
  3144*    COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3145*       + (M - 1) * ((CP-TERM-OR-EXT-DAYS + 30) - 30) / 30)
  3146*       * WK-S / 1000
  3147     MOVE WK3                    TO CP-CALC-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  58
* ELRATE.cbl
  3148     GO TO 9999-CALC-RATE-PREM-X
  3149     .
  3150 9999-RATE-NOTFND.
  3151     MOVE '6'                    TO CP-RETURN-CODE.
  3152     GO TO 9999-CALC-RATE-PREM-X.
  3153
  3154 9999-RATE-NOTOPEN.
  3155     MOVE 'D'                    TO CP-RETURN-CODE.
  3156     GO TO 9999-CALC-RATE-PREM-X.
  3157
  3158 9999-CALC-RATE-PREM-X.
  3159     IF (CP-COMPANY-ID = 'DCC')
  3160        AND (CP-BENEFIT-CD (1:1) = 'N'OR 'S')
  3161        CONTINUE
  3162     ELSE
  3163        IF CP-RATE-DEV-PCT NOT = ZERO
  3164           COMPUTE CP-CALC-PREMIUM =
  3165              CP-CALC-PREMIUM * CP-RATE-DEV-PCT.
  3166
  3167
  3168     MOVE CALCULATION-PASS-AREA  TO  DFHCOMMAREA.
  3169
  3170     IF WS-BROWSE-STARTED
  3171
  3172* EXEC CICS ENDBR
  3173*            DATASET  (ERRATE-FILE-ID)
  3174*       END-EXEC.
  3175     MOVE 0
  3176       TO DFHEIV11
  3177*    MOVE '&2                    $   #00003124' TO DFHEIV0
  3178     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3179     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3180     MOVE X'2020233030303033313234' TO DFHEIV0(25:11)
  3181     CALL 'kxdfhei1' USING DFHEIV0,
  3182           ERRATE-FILE-ID,
  3183           DFHEIV11,
  3184           DFHEIV99
  3185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3186
  3187
  3188
  3189* EXEC CICS RETURN
  3190*    END-EXEC.
  3191*    MOVE '.(                    &   #00003128' TO DFHEIV0
  3192     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3193     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3194     MOVE X'2020233030303033313238' TO DFHEIV0(25:11)
  3195     CALL 'kxdfhei1' USING DFHEIV0,
  3196           DFHEIV99,
  3197           DFHEIV99,
  3198           DFHEIV99,
  3199           DFHEIV99,
  3200           DFHEIV99
  3201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3202
  3203
  3204 9100-CONVERT-DATE.
  3205
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  59
* ELRATE.cbl
  3206* EXEC CICS LINK
  3207*        PROGRAM  ('ELDATCV')
  3208*        COMMAREA (DATE-CONVERSION-DATA)
  3209*        LENGTH   (DC-COMM-LENGTH)
  3210*    END-EXEC.
  3211     MOVE 'ELDATCV' TO DFHEIV1
  3212*    MOVE '."C                   ''   #00003132' TO DFHEIV0
  3213     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3214     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3215     MOVE X'2020233030303033313332' TO DFHEIV0(25:11)
  3216     CALL 'kxdfhei1' USING DFHEIV0,
  3217           DFHEIV1,
  3218           DATE-CONVERSION-DATA,
  3219           DC-COMM-LENGTH,
  3220           DFHEIV99,
  3221           DFHEIV99,
  3222           DFHEIV99
  3223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3224
  3225
  3226 9100-EXIT.
  3227     EXIT.
  3228
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  60
* ELRATE.cbl
  3230 10000-NET-TERM SECTION.
  3231*                         COPY ERCNETP.
  3232*****************************************************************
  3233*                                                               *
  3234*                            ERCNETP                            *
  3235*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3236*                            VMOD=2.029                         *
  3237*                                                               *
  3238*****************************************************************.
  3239*
  3240*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  3241*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  3242*                                   ORIGINAL TERM (S999)
  3243*                                   REMAINING TERM (S999)
  3244*                                   NET PAY OPTION (X)
  3245*                                   LOAN TERM (S999)
  3246*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  3247*
  3248*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  3249*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  3250*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  3251*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  3252*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  3253*    CHARGED.
  3254*
  3255*    OPTIONS - S = NET SIMPLE
  3256*          SPACE = NET PAY  (1 MO. INTEREST)
  3257*              A = NET PAY  (0 MO. INTEREST)
  3258*              I = NET PAY  (2 MO. INTEREST)
  3259*              J = NET PAY  (3 MO. INTEREST)
  3260*              K = NET PAY  (4 MO. INTEREST)
  3261*              T = TRUNCATED  (0 MO. INTEREST)
  3262*              U = TRUNCATED  (1 MO. INTEREST)
  3263*              V = TRUNCATED  (2 MO. INTEREST)
  3264*              W = TRUNCATED  (3 MO. INTEREST)
  3265*              X = TRUNCATED  (4 MO. INTEREST)
  3266*              R = REFUNDS (REGULAR OR TRUNCATED)
  3267******************************************************************
  3268*                   C H A N G E   L O G
  3269*
  3270* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3271*-----------------------------------------------------------------
  3272*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3273* EFFECTIVE    NUMBER
  3274*-----------------------------------------------------------------
  3275* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  3276* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  3277* 120403                   PEMA  ADD SPECIAL TX CALC
  3278* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3279* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3280* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  3281* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  3282* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  3283* 021207                   PEMA  ADD PA NP
  3284* 022107                   PEMA  ADD NH NP AND NP TRUNC
  3285* 032807                   PEMA  ADD VT NP PLUS 2
  3286* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  3287* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  61
* ELRATE.cbl
  3288* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  3289* 110207      TO 'AL' NET PAY CALC
  3290* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  3291* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  3292* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  3293* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  3294* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  3295* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  3296* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  3297* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3298* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  3299******************************************************************
  3300
  3301     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  3302     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  3303     MOVE N-P-LOAN    TO LOAN-TERM.
  3304     MOVE N-P-REM     TO REMAINING-TERM.
  3305     MOVE N-P-OPT     TO OPTION-SW.
  3306
  3307     MOVE +0 TO FACTOR.
  3308
  3309     IF ANNUAL-INT-RATE = ZERO
  3310         GO TO 99000-ERROR.
  3311     IF ORIGINAL-TERM = ZERO
  3312         GO TO 99999-RETURN.
  3313     IF REMAINING-TERM = ZERO
  3314         GO TO 99999-RETURN.
  3315     IF REMAINING-TERM GREATER ORIGINAL-TERM
  3316         GO TO 99000-ERROR.
  3317     IF LOAN-TERM = ZERO
  3318         GO TO 99999-RETURN.
  3319     IF LOAN-TERM LESS ORIGINAL-TERM
  3320         GO TO 99000-ERROR.
  3321
  3322*    IF ANNUAL-INT-RATE LESS +2
  3323*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3324*    IF ANNUAL-INT-RATE LESS +2
  3325*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3326*    IF ANNUAL-INT-RATE LESS +2
  3327*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3328
  3329     IF NPO-REFUND
  3330         MOVE '2' TO NP-PROCESS-SW
  3331       ELSE
  3332         IF ORIGINAL-TERM = REMAINING-TERM
  3333            MOVE '1'   TO NP-PROCESS-SW
  3334           ELSE
  3335            MOVE '3'   TO NP-PROCESS-SW.
  3336
  3337     IF NPO-SIMPLE
  3338         MOVE 'S' TO TYPE-SW
  3339     ELSE
  3340         MOVE 'N' TO TYPE-SW.
  3341
  3342     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  3343
  3344     COMPUTE V ROUNDED = K1 / (K1 + I).
  3345
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  62
* ELRATE.cbl
  3346     MOVE V     TO VX
  3347                   SV.
  3348
  3349     MOVE +1    TO X1
  3350                   SX.
  3351
  3352     MOVE LOAN-TERM TO MAX-X.
  3353
  3354     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  3355
  3356     IF MAX-X = +1
  3357        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  3358
  3359     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  3360
  3361     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  3362         OR 'DCC'        OR 'NCL') AND
  3363        (NOT NP-REFUND)
  3364        NEXT SENTENCE
  3365     ELSE
  3366     IF LOAN-TERM NOT = ORIGINAL-TERM
  3367        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  3368
  3369     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  3370
  3371 10500-VX-LOOP.
  3372
  3373***  VX = AMORT. LOAN TERM.
  3374***  SV = AMORT. INSURANCE TERM.
  3375***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  3376***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  3377***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  3378
  3379     IF X2 = 1
  3380        MOVE V         TO SX
  3381     END-IF
  3382     COMPUTE VX ROUNDED = VX * V.
  3383
  3384     ADD B1 TO X1.
  3385
  3386     IF X1 = REMAINING-TERM
  3387          MOVE VX    TO SV.
  3388
  3389     IF X1 EQUAL SV-MINUS-ONE
  3390        MOVE VX      TO SV-MINUS-ONE.
  3391
  3392     IF X1 = X2
  3393          MOVE VX    TO SX.
  3394
  3395     IF X1 NOT = MAX-X
  3396          GO TO 10500-VX-LOOP.
  3397
  3398 10700-COMPUTE-REMAINING-FACTOR.
  3399*****  WK1 = LOAN TERM AMORT
  3400     COMPUTE WK1 = K1 - VX.
  3401*****  WK2 = INS TERM AMORT
  3402     COMPUTE WK2 = K1 - SV.
  3403*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  63
* ELRATE.cbl
  3404     COMPUTE WK5 = K1 - SX.
  3405*****  WK6 = INS TERM - 1
  3406     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  3407
  3408     IF NP-RATING
  3409         GO TO 12000-PREMIUM-RATE.
  3410
  3411     IF NP-REFUND
  3412         GO TO 11000-REFUND-CALC.
  3413
  3414     IF NET-STD
  3415         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  3416
  3417     IF NET-SMP
  3418         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  3419         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  3420         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  3421         COMPUTE WK3 ROUNDED = WK3 * 1000.
  3422
  3423     IF REMAINING-TERM LESS THAN X2
  3424         MOVE +0 TO WK3.
  3425
  3426     MOVE WK3 TO FACTOR.
  3427
  3428     GO TO 99999-RETURN.
  3429
  3430 11000-REFUND-CALC.
  3431     IF REMAINING-TERM NOT LESS MAX-X
  3432        MOVE +1 TO FACTOR
  3433        GO TO 99999-RETURN.
  3434
  3435     IF REMAINING-TERM LESS +1
  3436        MOVE 0 TO FACTOR
  3437        GO TO 99999-RETURN.
  3438
  3439     COMPUTE WK2 ROUNDED = WK2 / I.
  3440     COMPUTE WK5 ROUNDED = WK5 / I.
  3441     COMPUTE WK1 ROUNDED = WK1 / I.
  3442
  3443     IF (CP-COMPANY-ID EQUAL 'CID')
  3444        AND (CP-STATE-STD-ABBRV = 'MN')
  3445        AND (CP-CERT-EFF-DT > X'A4FF')
  3446        AND (CP-RATE-AS-REG-BALLOON)
  3447        AND (CP-EARN-AS-NET-PAY)
  3448        AND (CP-DEVIATION-CODE NOT = 'LEV')
  3449        CONTINUE
  3450     ELSE
  3451        GO TO 11000-CHECK-MN-LEV-BALLOON
  3452     END-IF
  3453
  3454     COMPUTE R = M - E
  3455     COMPUTE FACTOR = (R - WK2 + WK5) /
  3456        (M - WK1 + WK5)
  3457
  3458     GO TO 99999-RETURN
  3459
  3460      .
  3461 11000-CHECK-MN-LEV-BALLOON.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  64
* ELRATE.cbl
  3462
  3463     IF (CP-COMPANY-ID EQUAL 'CID')
  3464        AND (CP-STATE-STD-ABBRV = 'MN')
  3465        AND (CP-CERT-EFF-DT > X'A4FF')
  3466        AND (CP-RATE-AS-REG-BALLOON)
  3467        AND (CP-EARN-AS-NET-PAY)
  3468        AND (CP-DEVIATION-CODE = 'LEV')
  3469        CONTINUE
  3470     ELSE
  3471        GO TO 11000-CONTINUE-REFUND
  3472     END-IF
  3473
  3474     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3475     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  3476        ** (M - E)) / I
  3477
  3478     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  3479
  3480     GO TO 99999-RETURN
  3481
  3482     .
  3483 11000-CONTINUE-REFUND.
  3484*    IF CP-GAP-ACTUARIAL
  3485*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  3486*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3487*       COMPUTE WK3 = WK2 / ANGLEN
  3488*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  3489     IF CP-GAP-ACTUARIAL
  3490        COMPUTE ANGLEN = WK1 / ((1 + I) **
  3491           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3492        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  3493     ELSE
  3494        COMPUTE WK3 ROUNDED =
  3495          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  3496     END-IF
  3497
  3498     MOVE WK3  TO FACTOR.
  3499
  3500     GO TO 99999-RETURN.
  3501
  3502 12000-PREMIUM-RATE.
  3503*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  3504*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  3505*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  3506*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  3507*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  3508*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  3509
  3510     COMPUTE K-I = K1 + I.
  3511     MOVE K-I TO ONE-PLUS-I.
  3512
  3513     IF NPO-ALT OR NPO-TRUNC-0
  3514         MOVE K1 TO K-I.
  3515
  3516     IF NPO-2MO OR NPO-TRUNC-2
  3517         COMPUTE K-I = K1 + (2 * I).
  3518
  3519     IF NPO-3MO OR NPO-TRUNC-3
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  65
* ELRATE.cbl
  3520         COMPUTE K-I = K1 + (3 * I).
  3521
  3522     IF NPO-4MO OR NPO-TRUNC-4
  3523         COMPUTE K-I = K1 + (4 * I).
  3524
  3525     COMPUTE RA ROUNDED = 1 -
  3526             ((X2 * (X2 + 1)) /
  3527              (N *  (N  + 1))).
  3528
  3529     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  3530        (CP-CSL-VALID-NP-BENEFIT-CD)
  3531        NEXT SENTENCE
  3532     ELSE
  3533        GO TO XXXX-CHECK-DISCOUNT-5.
  3534
  3535     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3536     MOVE ' ' TO DC-OPTION-CODE.
  3537     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3538
  3539     IF DATE-CONVERSION-ERROR
  3540        MOVE '2'                 TO CP-RETURN-CODE
  3541        MOVE ZEROS               TO FACTOR
  3542                                    CP-CALC-PREMIUM
  3543         GO TO 99999-RETURN.
  3544
  3545     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  3546     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  3547     MOVE ' ' TO DC-OPTION-CODE
  3548     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3549
  3550     IF DATE-CONVERSION-ERROR
  3551        MOVE '2'                 TO CP-RETURN-CODE
  3552        MOVE ZEROS               TO FACTOR
  3553                                    CP-CALC-PREMIUM
  3554         GO TO 99999-RETURN.
  3555
  3556     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
  3557
  3558     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
  3559
  3560     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  3561        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  3562        CP-PAY-FREQUENCY / 365) * I
  3563     ELSE
  3564        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  3565        CP-PAY-FREQUENCY / 365) * I.
  3566
  3567     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  3568     13).
  3569
  3570     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  3571     (N - ( ANGLEN-1 / WK3)).
  3572
  3573     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  3574
  3575     COMPUTE WS-CALC-FREQ-RATE EQUAL
  3576       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  3577
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  66
* ELRATE.cbl
  3578     COMPUTE WS-Y-X-FACTOR EQUAL
  3579       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  3580       WS-CALC-FREQ-RATE).
  3581
  3582     COMPUTE WS-ODD-DAY-UNITS EQUAL
  3583       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  3584
  3585     COMPUTE WS-X-Y-FACTOR EQUAL
  3586       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  3587
  3588     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  3589       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  3590       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  3591
  3592     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  3593
  3594     GO TO 99999-RETURN.
  3595
  3596 XXXX-CHECK-DISCOUNT-5.
  3597
  3598     IF WS-DISCOUNT-OPTION EQUAL '5'
  3599        NEXT SENTENCE
  3600     ELSE
  3601        GO TO 12000-CHECK-CLIENT.
  3602
  3603      COMPUTE ANGLEN EQUAL WK1 / I.
  3604
  3605      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3606
  3607      COMPUTE WK3 EQUAL
  3608        (12 *
  3609        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  3610        CP-ORIGINAL-BENEFIT)) /
  3611        APR100.
  3612
  3613     COMPUTE WK3 EQUAL
  3614        (WK3 * CP-PREMIUM-RATE) / +1000.
  3615
  3616     COMPUTE WK3 EQUAL
  3617        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  3618
  3619      MOVE WK3 TO CP-CALC-PREMIUM.
  3620
  3621     GO TO 99999-RETURN.
  3622
  3623 12000-CHECK-CLIENT.
  3624
  3625     IF (CP-COMPANY-ID EQUAL 'MON') AND
  3626        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3627        (CP-TRUNCATED-LIFE)
  3628        NEXT SENTENCE
  3629     ELSE
  3630        GO TO 12000-CHECK-NEXT.
  3631
  3632     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3633
  3634     COMPUTE ANGLEN EQUAL WK1 / I.
  3635     COMPUTE ANGLEM EQUAL WK2 / I.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  67
* ELRATE.cbl
  3636
  3637     COMPUTE FM EQUAL
  3638                    (((ONE-PLUS-I ** M) * I * M) /
  3639                    ((ONE-PLUS-I ** M) - 1))
  3640                    - 1.
  3641
  3642     COMPUTE FN EQUAL
  3643                    (((ONE-PLUS-I ** N) * I * N) /
  3644                    ((ONE-PLUS-I ** N) - 1))
  3645                    - 1.
  3646
  3647     COMPUTE FNM EQUAL
  3648                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  3649                    ((ONE-PLUS-I ** (N - M)) - 1))
  3650                    - 1.
  3651
  3652     COMPUTE GR EQUAL
  3653                    (WS-WORK-RATE * ANGLEM * I) /
  3654                    (M - ANGLEM).
  3655
  3656     COMPUTE ODF EQUAL
  3657                     (1 +
  3658                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  3659                     360)) /
  3660                     ONE-PLUS-I.
  3661
  3662     COMPUTE OD EQUAL
  3663                    (1 + (ODF * (FN / I - 1))) +
  3664                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  3665
  3666     COMPUTE WK3 EQUAL
  3667*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  3668                    ((1 + FN) * ODF *
  3669                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  3670                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  3671                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  3672
  3673     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  3674     COMPUTE WK3 EQUAL TRUNC-PMT * N.
  3675
  3676     COMPUTE WK3 EQUAL
  3677                    (WK3 / (ODF * (1 + FN))) -
  3678*                   CP-ORIGINAL-BENEFIT.
  3679                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  3680
  3681      MOVE WK3 TO CP-CALC-PREMIUM.
  3682
  3683     GO TO 99999-RETURN.
  3684
  3685 12000-CHECK-NEXT.
  3686
  3687     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  3688        NEXT SENTENCE
  3689     ELSE
  3690        GO TO 12000-CHECK-PA-TRUNC.
  3691
  3692      IF WS-WORK-DIS-RATE EQUAL +0
  3693         MOVE '7'                TO CP-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  68
* ELRATE.cbl
  3694         MOVE ZEROS              TO FACTOR
  3695                                    CP-CALC-PREMIUM
  3696         GO TO 99999-RETURN.
  3697
  3698      COMPUTE ANGLEN EQUAL WK1 / I.
  3699
  3700      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3701
  3702      IF WS-WORK-DIS-RATE EQUAL APR100
  3703         ADD .00001 TO APR100.
  3704
  3705      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  3706      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  3707
  3708     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3709        / (1 + I)
  3710     COMPUTE ANGLEN-1 = ANGLEN / Y
  3711      IF CP-COMPANY-ID EQUAL 'CDL'
  3712         COMPUTE WK3 EQUAL
  3713
  3714          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  3715          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  3716
  3717          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3718
  3719          ((WK8 ** N) /
  3720          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3721
  3722          ((WK9 ** N) /
  3723          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  3724
  3725      ELSE
  3726         COMPUTE WK3 EQUAL
  3727
  3728          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  3729          (12 + WS-WORK-DIS-RATE) * 12) *
  3730
  3731          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3732
  3733          ((WK8 ** N) /
  3734          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3735
  3736          ((WK9 ** N) /
  3737          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  3738
  3739      COMPUTE WK3 EQUAL
  3740          (WK3 * CP-PREMIUM-RATE) / +1000.
  3741
  3742      MOVE WK3 TO CP-CALC-PREMIUM.
  3743
  3744     GO TO 99999-RETURN.
  3745
  3746 12000-CHECK-PA-TRUNC.
  3747
  3748     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3749        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
  3750        (CP-EARN-AS-NET-PAY) AND
  3751        (CP-TRUNCATED-LIFE)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  69
* ELRATE.cbl
  3752        NEXT SENTENCE
  3753     ELSE
  3754        GO TO 12000-CHECK-MD-TRUNC.
  3755
  3756     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3757
  3758     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3759     COMPUTE ANGLEN EQUAL WK1 / I.
  3760
  3761     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3762
  3763     COMPUTE WK3 EQUAL
  3764        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  3765        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  3766
  3767     MOVE WK3 TO CP-CALC-PREMIUM.
  3768
  3769     GO TO 99999-RETURN.
  3770
  3771 12000-CHECK-MD-TRUNC.
  3772
  3773     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3774        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3775        (CP-EARN-AS-NET-PAY) AND
  3776        (CP-TRUNCATED-LIFE)
  3777        NEXT SENTENCE
  3778     ELSE
  3779        GO TO 12000-CHECK-MD.
  3780
  3781     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3782
  3783     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3784     COMPUTE ANGLEM EQUAL WK2 / I.
  3785     COMPUTE ANGLEN EQUAL WK1 / I.
  3786
  3787     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3788
  3789     COMPUTE WK3 EQUAL
  3790        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3791        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  3792        (ANGLEN-1 * (M - ANGLEM))).
  3793
  3794     MOVE WK3 TO CP-CALC-PREMIUM.
  3795
  3796     GO TO 99999-RETURN.
  3797
  3798 12000-CHECK-MD.
  3799
  3800     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3801        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3802        (CP-EARN-AS-NET-PAY)
  3803        NEXT SENTENCE
  3804     ELSE
  3805        GO TO 12000-CHECK-ME-TRUNC.
  3806
  3807     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3808
  3809     COMPUTE WK3 EQUAL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  70
* ELRATE.cbl
  3810        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  3811
  3812     MOVE WK3 TO CP-CALC-PREMIUM.
  3813
  3814     GO TO 99999-RETURN.
  3815
  3816 12000-CHECK-ME-TRUNC.
  3817
  3818     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  3819        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3820        AND (CP-EARN-AS-NET-PAY)
  3821        AND (CP-TRUNCATED-LIFE)
  3822        CONTINUE
  3823     ELSE
  3824        GO TO 12000-CHECK-CID-FARMPLAN
  3825     END-IF
  3826
  3827     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3828     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3829     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3830     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3831     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3832     COMPUTE ANGLEN-1 = ANGLEN / Y
  3833     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3834     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3835     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  3836     COMPUTE WK3
  3837        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  3838        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  3839            * (1 / (1.0635 ** (M / 12))))
  3840*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  3841*    COMPUTE WK9 EQUAL
  3842*       1 / (1 + (.045 * (N - M) / 24))
  3843*    COMPUTE WK7 EQUAL
  3844*       WS-WORK-RATE * 20 / (M + 1).
  3845*    COMPUTE WK3 EQUAL
  3846*       ((( N - ANGLEN) * WK7 * WK8) /
  3847*       (10 * ANGLEN-1 * I)) -
  3848*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
  3849*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  3850*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  3851*
  3852     MOVE WK3 TO CP-CALC-PREMIUM.
  3853
  3854     GO TO 99999-RETURN.
  3855 12000-CHECK-CID-FARMPLAN.
  3856     IF (CP-COMPANY-ID EQUAL 'CID')
  3857        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  3858           OR 'IN' OR 'AZ')
  3859        AND (CP-FARM-PLAN)
  3860        CONTINUE
  3861     ELSE
  3862        GO TO 12000-CHECK-SC-CID
  3863     END-IF
  3864     COMPUTE N = M / CP-PAY-FREQUENCY
  3865     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3866     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3867        ** CP-PAY-FREQUENCY) - 1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  71
* ELRATE.cbl
  3868     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  3869     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3870        ** TI) / WS-WORK-DIS-RATE
  3871     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  3872     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  3873     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3874        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  3875     COMPUTE WK2 = WK2 * (1 + J)
  3876     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3877     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3878     COMPUTE WK3 = WK3 * (1 + J)
  3879     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  3880        ** (N - 1))) / J
  3881     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3882        ((N * WK2) - WK5)) + (N * WK1)) *
  3883        (CP-PREMIUM-RATE / 1000)
  3884     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  3885     COMPUTE WK6 = (WK7 * GR)
  3886     MOVE WK6 TO CP-CALC-PREMIUM
  3887     GO TO 99999-RETURN
  3888     .
  3889 12000-CHECK-SC-CID.
  3890     IF (CP-COMPANY-ID EQUAL 'CID')
  3891        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  3892        AND (CP-EARN-AS-NET-PAY)
  3893        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  3894        CONTINUE
  3895     ELSE
  3896        GO TO 12000-CHECK-AL-CID
  3897     END-IF
  3898     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3899     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3900     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3901     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3902     COMPUTE ANGLEN-1 = ANGLEN / Y
  3903     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3904        / 12)) / ((M + 1) / 2)
  3905     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3906     COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3907        + 6 * M) * (WK2 / 100) * (1 + I)
  3908     MOVE WK3 TO CP-CALC-PREMIUM
  3909     GO TO 99999-RETURN
  3910     .
  3911 12000-CHECK-AL-CID.
  3912     IF (CP-COMPANY-ID EQUAL 'CID')
  3913        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  3914        AND (CP-EARN-AS-NET-PAY)
  3915        CONTINUE
  3916     ELSE
  3917        GO TO 12000-CHECK-NH-CID
  3918     END-IF
  3919     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3920     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3921     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3922     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3923                   / (1 + I)
  3924     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3925     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  72
* ELRATE.cbl
  3926     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  3927        (CP-PREMIUM-RATE / 1000)
  3928     MOVE WK3 TO CP-CALC-PREMIUM
  3929     GO TO 99999-RETURN
  3930     .
  3931 12000-CHECK-NH-CID.
  3932     IF (CP-COMPANY-ID EQUAL 'CID')
  3933        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  3934        AND (CP-EARN-AS-NET-PAY)
  3935        CONTINUE
  3936     ELSE
  3937        GO TO 12000-CHECK-PA-CID
  3938     END-IF
  3939     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3940     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3941     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3942                   / (1 + I)
  3943     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3944     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3945     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3946        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  3947     MOVE WK3 TO CP-CALC-PREMIUM
  3948     GO TO 99999-RETURN
  3949     .
  3950 12000-CHECK-PA-CID.
  3951     IF (CP-COMPANY-ID EQUAL 'CID')
  3952        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  3953        AND (CP-EARN-AS-NET-PAY)
  3954        CONTINUE
  3955     ELSE
  3956        GO TO 12000-CHECK-ME-CID
  3957     END-IF
  3958
  3959     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3960     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3961     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3962     COMPUTE ANGLEN-1 = ANGLEN / Y
  3963     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  3964     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3965     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  3966     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3967        * WK5
  3968     MOVE WK3 TO CP-CALC-PREMIUM
  3969     GO TO 99999-RETURN
  3970     .
  3971 12000-CHECK-ME-CID.
  3972     IF (CP-COMPANY-ID EQUAL 'CID')
  3973        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3974        AND (CP-EARN-AS-NET-PAY)
  3975        CONTINUE
  3976     ELSE
  3977        GO TO 12000-CHECK-VT-TRUNC
  3978     END-IF
  3979     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3980     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3981     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3982     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3983     COMPUTE ANGLEN-1 = ANGLEN / Y
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  73
* ELRATE.cbl
  3984     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3985     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3986     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3987        * WK5
  3988     MOVE WK3 TO CP-CALC-PREMIUM
  3989     GO TO 99999-RETURN
  3990     .
  3991 12000-CHECK-VT-TRUNC.
  3992
  3993     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3994        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  3995        (CP-EARN-AS-NET-PAY) AND
  3996        (CP-TRUNCATED-LIFE)
  3997        NEXT SENTENCE
  3998     ELSE
  3999        GO TO 12000-CHECK-VT.
  4000
  4001      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4002
  4003      COMPUTE ANGLEN EQUAL WK1 / I.
  4004
  4005      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4006
  4007      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  4008      COMPUTE WK9 EQUAL
  4009        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  4010        ((.0054 - I) / (1 + I)).
  4011      COMPUTE WK7 EQUAL
  4012        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  4013      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  4014        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  4015
  4016      MOVE WK3 TO CP-CALC-PREMIUM.
  4017
  4018     GO TO 99999-RETURN.
  4019
  4020 12000-CHECK-VT.
  4021
  4022     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4023        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4024        (CP-EARN-AS-NET-PAY)
  4025        NEXT SENTENCE
  4026     ELSE
  4027        GO TO 12000-CHECK-MINN-WDS.
  4028
  4029      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4030
  4031      COMPUTE ANGLEN EQUAL WK1 / I.
  4032
  4033      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4034
  4035      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  4036                        (ANGLEN-1 * I)) *
  4037
  4038                        (((1.0054 ** N - 1) /
  4039                        (1.0054 ** (N - 1) * .0054)) -
  4040
  4041                        ((V * (1 - 1.0054 ** N * VX)) /
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  74
* ELRATE.cbl
  4042                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  4043
  4044      MOVE WK3 TO CP-CALC-PREMIUM.
  4045
  4046     GO TO 99999-RETURN.
  4047
  4048 12000-CHECK-MINN-WDS.
  4049
  4050     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4051        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4052        (CP-EARN-AS-NET-PAY)
  4053        NEXT SENTENCE
  4054     ELSE
  4055        GO TO 12000-CHECK-MINN-BALL-LEV.
  4056
  4057     COMPUTE ANGLEN EQUAL WK1 / I.
  4058     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
  4059              (N / +12) * (2 / (N + 1)).
  4060     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
  4061         WK3 * ((N - ANGLEN) / I).
  4062
  4063      MOVE WK3 TO CP-CALC-PREMIUM.
  4064
  4065     GO TO 99999-RETURN.
  4066
  4067 12000-CHECK-MINN-BALL-LEV.
  4068
  4069     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4070        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4071        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4072        (CP-EARN-AS-REG-BALLOON)
  4073        NEXT SENTENCE
  4074     ELSE
  4075        GO TO 12000-CHECK-MINN-BALL.
  4076
  4077     COMPUTE ANGLEN EQUAL WK1 / I.
  4078
  4079     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  4080
  4081     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4082        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  4083
  4084     MOVE WK3 TO CP-CALC-PREMIUM.
  4085
  4086     GO TO 99999-RETURN.
  4087
  4088 12000-CHECK-MINN-BALL.
  4089
  4090     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4091        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4092        (CP-EARN-AS-REG-BALLOON)
  4093        NEXT SENTENCE
  4094     ELSE
  4095        GO TO 12000-CHECK-CID-MN-BALL.
  4096
  4097     COMPUTE ANGLEN EQUAL WK1 / I.
  4098     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4099
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  75
* ELRATE.cbl
  4100     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4101     / +100 * (N - 1) / 12 * 2 / N *
  4102     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  4103
  4104      MOVE WK3 TO CP-CALC-PREMIUM.
  4105
  4106     GO TO 99999-RETURN.
  4107
  4108 12000-CHECK-CID-MN-BALL.
  4109     IF (CP-COMPANY-ID EQUAL 'CID')
  4110        AND (CP-STATE-STD-ABBRV = 'MN')
  4111        AND (CP-CERT-EFF-DT > X'A4FF')
  4112        AND (CP-EARN-AS-REG-BALLOON)
  4113        CONTINUE
  4114     ELSE
  4115        GO TO 12000-CHECK-NC-WDS
  4116     END-IF
  4117     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4118     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4119     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  4120     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4121     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4122     COMPUTE V = 1 / (1 + I)
  4123     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4124     COMPUTE Y = (1 + (D * I) / +30)
  4125        / (1 + I)
  4126     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  4127        * CP-PREMIUM-RATE / 1000
  4128*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  4129*       MOVE CP-MONTHLY-PAYMENT  TO GR
  4130*    ELSE
  4131*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  4132*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  4133*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  4134*       DISPLAY ' BALLOON TOP ' WK6
  4135*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  4136*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  4137*          / 100
  4138*       DISPLAY ' BALLOON BOTTOM ' WK7
  4139*       COMPUTE GR = WK6 / WK7
  4140*       DISPLAY ' BALLOON PAYMENT ' GR
  4141*    END-IF
  4142     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  4143     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  4144        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  4145     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  4146     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  4147        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  4148           (CP-ALTERNATE-BENEFIT * (M + 1)))
  4149           * CP-PREMIUM-RATE / 1000
  4150     MOVE WK3                    TO CP-CALC-PREMIUM
  4151     GO TO 99999-RETURN.
  4152     .
  4153 12000-CHECK-NC-WDS.
  4154
  4155     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4156        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4157        (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  76
* ELRATE.cbl
  4158        NEXT SENTENCE
  4159     ELSE
  4160        GO TO 12000-CHECK-NC-BALL-LEV.
  4161
  4162     COMPUTE WK4 EQUAL N * (1 + I * 2).
  4163     COMPUTE ANGLEN EQUAL WK1 / I.
  4164     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4165              CP-PREMIUM-RATE / +100 *
  4166              N / +12 * 2 / (N + 1) *
  4167              (WK4 - ANGLEN) / (I * ANGLEN).
  4168
  4169      MOVE WK3 TO CP-CALC-PREMIUM.
  4170
  4171     GO TO 99999-RETURN.
  4172
  4173 12000-CHECK-NC-BALL-LEV.
  4174
  4175     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4176        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4177        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4178        (CP-EARN-AS-REG-BALLOON)
  4179        NEXT SENTENCE
  4180     ELSE
  4181        GO TO 12000-CHECK-NC-BALL.
  4182
  4183     COMPUTE ANGLEN EQUAL WK1 / I.
  4184
  4185**** VX = 1 / (1 + I)**N.
  4186
  4187     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4188        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  4189
  4190     MOVE WK3 TO CP-CALC-PREMIUM.
  4191
  4192     GO TO 99999-RETURN.
  4193
  4194 12000-CHECK-NC-BALL.
  4195
  4196     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4197        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4198        (CP-EARN-AS-REG-BALLOON)
  4199        NEXT SENTENCE
  4200     ELSE
  4201        GO TO 12000-CHECK-MINN-TRUNC.
  4202
  4203     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  4204     COMPUTE ANGLEN EQUAL WK1 / I.
  4205     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4206**** VX = 1 / (1 + I)**N.
  4207
  4208     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4209     / +100 * (N - 1) / 12 * 2 / N *
  4210     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  4211
  4212      MOVE WK3 TO CP-CALC-PREMIUM.
  4213
  4214     GO TO 99999-RETURN.
  4215
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  77
* ELRATE.cbl
  4216 12000-CHECK-MINN-TRUNC.
  4217
  4218     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4219        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4220        (M GREATER THAN +63) AND
  4221        (CP-EARN-AS-NET-PAY) AND
  4222        (CP-TRUNCATED-LIFE)
  4223        NEXT SENTENCE
  4224     ELSE
  4225        GO TO 12000-CHECK-MINN.
  4226
  4227      COMPUTE ANGLEN EQUAL WK1 / I.
  4228      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4229
  4230      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4231
  4232      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4233       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4234       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  4235
  4236      MOVE WK3 TO CP-CALC-PREMIUM.
  4237
  4238     GO TO 99999-RETURN.
  4239
  4240 12000-CHECK-MINN.
  4241
  4242     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4243        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4244        (M GREATER THAN +63) AND
  4245        (CP-EARN-AS-NET-PAY)
  4246        NEXT SENTENCE
  4247     ELSE
  4248        GO TO 12000-CHECK-MONTANA-TRUNC.
  4249
  4250      COMPUTE ANGLEN EQUAL WK1 / I.
  4251
  4252      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4253
  4254      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4255       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4256       (((N - ANGLEN) / I) + (2 * N)).
  4257
  4258      MOVE WK3 TO CP-CALC-PREMIUM.
  4259
  4260     GO TO 99999-RETURN.
  4261
  4262 12000-CHECK-MONTANA-TRUNC.
  4263
  4264     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4265        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4266        (M GREATER THAN +63) AND
  4267        (CP-EARN-AS-NET-PAY) AND
  4268        (CP-TRUNCATED-LIFE)
  4269        NEXT SENTENCE
  4270     ELSE
  4271        GO TO 12000-CHECK-MONTANA.
  4272
  4273      COMPUTE ANGLEN EQUAL WK1 / I.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  78
* ELRATE.cbl
  4274      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4275
  4276      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4277
  4278      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4279      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4280       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  4281
  4282      MOVE WK3 TO CP-CALC-PREMIUM.
  4283
  4284     GO TO 99999-RETURN.
  4285
  4286 12000-CHECK-MONTANA.
  4287
  4288     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4289        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4290        (M GREATER THAN +63) AND
  4291        (CP-EARN-AS-NET-PAY)
  4292        NEXT SENTENCE
  4293     ELSE
  4294        GO TO 12001-CONTINUE-NCL-TRUNC.
  4295
  4296      COMPUTE ANGLEN EQUAL WK1 / I.
  4297
  4298      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4299
  4300      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4301       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4302       (((N - ANGLEN) / I) + (4 * N)).
  4303
  4304      MOVE WK3 TO CP-CALC-PREMIUM.
  4305
  4306     GO TO 99999-RETURN.
  4307
  4308 12001-CONTINUE-NCL-TRUNC.
  4309
  4310     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4311        (CP-EARN-AS-NET-PAY) AND
  4312        (CP-TRUNCATED-LIFE)
  4313        NEXT SENTENCE
  4314     ELSE
  4315        GO TO 12001-CONTINUE-NCL.
  4316
  4317      COMPUTE ANGLEN EQUAL WK1 / I.
  4318      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4319
  4320      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4321
  4322      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  4323      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  4324      (ANGLEN-1 * (N + 1) * I).
  4325
  4326      MOVE WK3 TO CP-CALC-PREMIUM.
  4327
  4328     GO TO 99999-RETURN.
  4329
  4330 12001-CONTINUE-NCL.
  4331
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  79
* ELRATE.cbl
  4332     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4333        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4334        (CP-EARN-AS-NET-PAY)
  4335        GO TO 12001-CHECK-NC-NET-PLUS3.
  4336
  4337     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4338        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4339        (CP-EARN-AS-NET-PAY)
  4340        GO TO 12001-CHECK-CA.
  4341
  4342     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4343        (CP-EARN-AS-NET-PAY)
  4344        NEXT SENTENCE
  4345     ELSE
  4346        GO TO 12000-CONTINUE-NET.
  4347
  4348      COMPUTE ANGLEN EQUAL WK1 / I.
  4349      MOVE ANGLEN                TO ANGLEN-1.
  4350
  4351      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4352
  4353      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4354       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4355       ((N - ANGLEN) / I).
  4356
  4357      MOVE WK3 TO CP-CALC-PREMIUM.
  4358
  4359     GO TO 99999-RETURN.
  4360
  4361 12000-CONTINUE-NET.
  4362
  4363     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  4364        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  4365        (CP-EARN-AS-NET-PAY)
  4366        NEXT SENTENCE
  4367     ELSE
  4368        GO TO 12001-CONTINUE-MINN.
  4369
  4370      COMPUTE ANGLEN EQUAL WK6 / I.
  4371      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  4372
  4373      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  4374      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  4375      COMPUTE WK3 EQUAL (WK3 / I) *
  4376       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  4377
  4378      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  4379         MOVE +0 TO CP-R-MAX-TOT-BEN.
  4380
  4381      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  4382
  4383      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  4384         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  4385         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  4386
  4387      MOVE WK3 TO CP-CALC-PREMIUM.
  4388
  4389     GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  80
* ELRATE.cbl
  4390
  4391 12001-CONTINUE-MINN.
  4392
  4393     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4394        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  4395        (CP-TRUNCATED-LIFE)
  4396        NEXT SENTENCE
  4397     ELSE
  4398        GO TO 12001-CHECK-RI-GTL.
  4399
  4400      COMPUTE ANGLEN EQUAL WK1 / I.
  4401      COMPUTE ANGLEM EQUAL WK2 / I.
  4402
  4403      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  4404       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  4405       * M / 2400) * 1000 + .5) / 1000000.
  4406
  4407      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
  4408       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  4409
  4410     GO TO 99999-RETURN.
  4411
  4412 12001-CHECK-RI-GTL.
  4413
  4414     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4415        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4416        (CP-EARN-AS-NET-PAY)
  4417        NEXT SENTENCE
  4418     ELSE
  4419        GO TO 12001-CHECK-RI-LEASE-GTL.
  4420
  4421      COMPUTE ANGLEN EQUAL WK1 / I.
  4422*     COMPUTE ANGLEM EQUAL WK2 / I.
  4423
  4424      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  4425               (1 + WS-WORK-DIS-RATE * N).
  4426      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  4427         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  4428
  4429
  4430     GO TO 99999-RETURN.
  4431
  4432 12001-CHECK-RI-LEASE-GTL.
  4433
  4434     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4435        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4436        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4437        NEXT SENTENCE
  4438     ELSE
  4439        GO TO 12001-CHECK-OR-GTL.
  4440
  4441     COMPUTE ANGLEN EQUAL WK1 / I.
  4442
  4443     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  4444        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
  4445                        /
  4446        (1000 * I * (1 + .0021 * N)).
  4447     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  81
* ELRATE.cbl
  4448       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  4449                            /
  4450       (1000 * (1 + .0027 * (N + 1))).
  4451
  4452     GO TO 99999-RETURN.
  4453
  4454 12001-CHECK-OR-GTL.
  4455
  4456     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4457        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  4458        (CP-EARN-AS-NET-PAY)
  4459        NEXT SENTENCE
  4460     ELSE
  4461        GO TO 12001-CHECK-GA-GTL.
  4462
  4463     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4464     COMPUTE ANGLEN EQUAL WK1 / I.
  4465
  4466     IF M LESS THAN +64
  4467        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4468         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  4469                   /
  4470         (I * ANGLEN * (N - (N - M) + 1) * 600)
  4471        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  4472     ELSE
  4473        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4474        CP-PREMIUM-RATE * (1 + I))
  4475                  /
  4476        (+1000 * I * ANGLEN)
  4477        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  4478*    MOVE WK3 TO CP-CALC-PREMIUM.
  4479     GO TO 99999-RETURN.
  4480
  4481 12001-CHECK-GA-GTL.
  4482
  4483     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4484        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  4485        (CP-EARN-AS-NET-PAY)
  4486*       (CP-TRUNCATED-LIFE)
  4487        NEXT SENTENCE
  4488     ELSE
  4489        GO TO 12001-CHECK-MA-GTL.
  4490
  4491     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4492     COMPUTE ANGLEN EQUAL WK1 / I.
  4493
  4494     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  4495     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  4496      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  4497     MOVE WK3 TO CP-CALC-PREMIUM.
  4498
  4499     GO TO 99999-RETURN.
  4500
  4501 12001-CHECK-MA-GTL.
  4502
  4503     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4504        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  4505        (CP-EARN-AS-NET-PAY) AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  82
* ELRATE.cbl
  4506        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4507        NEXT SENTENCE
  4508     ELSE
  4509        GO TO 12001-CHECK-NV-NET.
  4510
  4511     COMPUTE ANGLEN EQUAL WK1 / I.
  4512
  4513     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  4514      CP-ALTERNATE-BENEFIT * N.
  4515
  4516     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  4517     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  4518
  4519     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  4520     WK7 * (N - ANGLEN) / I.
  4521     MOVE WK3 TO CP-CALC-PREMIUM.
  4522
  4523     GO TO 99999-RETURN.
  4524
  4525 12001-CHECK-NV-NET.
  4526     IF (CP-COMPANY-ID EQUAL 'CID')
  4527        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  4528        AND (CP-EARN-AS-NET-PAY)
  4529        CONTINUE
  4530     ELSE
  4531        GO TO 12001-CHECK-MN-NET
  4532     END-IF
  4533     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4534     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4535     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4536                   / (1 + I)
  4537     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4538     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4539     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4540        (CP-PREMIUM-RATE * K-I / 1000)
  4541     MOVE WK3                    TO CP-CALC-PREMIUM
  4542     GO TO 99999-RETURN
  4543      .
  4544 12001-CHECK-MN-NET.
  4545     IF (CP-COMPANY-ID EQUAL 'CID')
  4546        AND (CP-STATE-STD-ABBRV = 'MN')
  4547        AND (CP-EARN-AS-NET-PAY)
  4548        AND (NOT CP-LEVEL-LIFE)
  4549        AND (WS-DISCOUNT-OPTION = '1')
  4550        CONTINUE
  4551     ELSE
  4552        GO TO 12001-CHECK-NC-NET
  4553     END-IF
  4554     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4555     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4556     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4557                   / (1 + I)
  4558     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4559     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4560     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4561        (CP-PREMIUM-RATE / 1000) * (1 + I)
  4562     MOVE WK3                    TO CP-CALC-PREMIUM
  4563     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  83
* ELRATE.cbl
  4564      .
  4565 12001-CHECK-NC-NET.
  4566
  4567     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  4568        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4569        (CP-EARN-AS-NET-PAY)
  4570        NEXT SENTENCE
  4571     ELSE
  4572        GO TO 12001-CHECK-NC-NET-PLUS3.
  4573
  4574      COMPUTE ANGLEN EQUAL WK1 / I.
  4575      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4576
  4577      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  4578          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  4579          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  4580          N * (CP-PREMIUM-RATE / 1000)).
  4581
  4582      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  4583          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  4584
  4585      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  4586          ((N - ANGLEN) / I + 3) / ANGLEN) /
  4587          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  4588          (ANGLEN * 2))
  4589
  4590      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  4591
  4592      IF ANGLEN IS NOT LESS THAN WK7
  4593          COMPUTE CP-PREMIUM-RATE ROUNDED =
  4594              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  4595          COMPUTE WK3 ROUNDED =
  4596              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  4597
  4598     MOVE WK3 TO CP-CALC-PREMIUM.
  4599
  4600     GO TO 99999-RETURN.
  4601
  4602 12001-CHECK-NC-NET-PLUS3.
  4603
  4604     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4605        (CP-EARN-AS-NET-PAY) AND
  4606        (CP-COMPANY-ID NOT = 'CID' AND 'DCC')
  4607        NEXT SENTENCE
  4608     ELSE
  4609        GO TO 12001-CHECK-CA.
  4610
  4611     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  4612     MOVE ' ' TO DC-OPTION-CODE.
  4613     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  4614
  4615     IF DATE-CONVERSION-ERROR
  4616        MOVE '2'                 TO CP-RETURN-CODE
  4617        MOVE ZEROS               TO FACTOR
  4618                                    CP-CALC-PREMIUM
  4619         GO TO 99999-RETURN.
  4620
  4621     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  84
* ELRATE.cbl
  4622        NEXT SENTENCE
  4623     ELSE
  4624        GO TO 12001-CONTINUE-NET.
  4625
  4626     COMPUTE ANGLEN EQUAL WK1 / I.
  4627     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4628
  4629     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  4630
  4631     COMPUTE NC-R = 20 *
  4632                    ((NC-LR * ORIGINAL-TERM) / 12)
  4633                          / (ORIGINAL-TERM + 1).
  4634
  4635     COMPUTE NC-OB = NC-R / 1000.
  4636
  4637     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  4638                    (NC-OB * ORIGINAL-TERM * 3).
  4639
  4640     IF CP-EXT-CHG-LF
  4641         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  4642     ELSE
  4643         MOVE 30                 TO  NC-BIG-D.
  4644
  4645     COMPUTE NC-LITTLE-D = (1 + I) /
  4646             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  4647
  4648     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  4649             (ANGLEN * NC-LITTLE-D ).
  4650
  4651     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  4652
  4653     GO TO 99999-RETURN.
  4654
  4655 12001-CHECK-CA.
  4656
  4657     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4658        (WS-DISCOUNT-OPTION = '6')
  4659        NEXT SENTENCE
  4660     ELSE
  4661        GO TO 12001-CHECK-GTL-IA.
  4662
  4663     COMPUTE CA-J = CA-DISCOUNT / 12.
  4664     COMPUTE ANGLEN EQUAL WK1 / I.
  4665     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  4666     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  4667     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  4668     COMPUTE CA-VI = (1 + I)** -1.
  4669     COMPUTE CP-CALC-PREMIUM =
  4670         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  4671         ((1 + CA-J) / I) *
  4672         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  4673         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  4674         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  4675
  4676     GO TO 99999-RETURN.
  4677
  4678 12001-CHECK-GTL-IA.
  4679
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  85
* ELRATE.cbl
  4680     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  4681        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  4682        (CP-EARN-AS-NET-PAY)
  4683        NEXT SENTENCE
  4684     ELSE
  4685        GO TO 12001-CHECK-CID-TRN-VA.
  4686
  4687***************************************************************
  4688
  4689     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  4690
  4691     IF GTL-IA-ODD-DAYS = ZEROS
  4692         MOVE ZERO               TO  GTL-IA-SGN
  4693     ELSE
  4694         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  4695             MOVE +1             TO  GTL-IA-SGN
  4696         ELSE
  4697             MOVE -1             TO  GTL-IA-SGN.
  4698
  4699     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  4700     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  4701
  4702     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  4703                          GTL-IA-SGN.
  4704
  4705     COMPUTE ANGLEN EQUAL WK1 / I.
  4706     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4707
  4708     IF GTL-IA-ODF NOT = ZERO
  4709         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  4710         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  4711
  4712     COMPUTE GTL-IA-DIVIDEND =
  4713           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  4714                             (ANGLEN - ANGLEN-M))) *
  4715           ((K1 + I) * CP-PREMIUM-RATE *
  4716                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  4717
  4718     COMPUTE GTL-IA-DIVISOR =
  4719      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  4720
  4721     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  4722
  4723     COMPUTE CP-CALC-PREMIUM =
  4724                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  4725     GO TO 99999-RETURN.
  4726
  4727
  4728 12001-CHECK-CID-TRN-VA.
  4729
  4730     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4731        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  4732        (CP-EARN-AS-NET-PAY) AND
  4733        (CP-TRUNCATED-LIFE) AND
  4734        (CP-STATE-STD-ABBRV = CP-STATE)
  4735        CONTINUE
  4736     ELSE
  4737        GO TO 12001-CHECK-CID-TX
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  86
* ELRATE.cbl
  4738     END-IF
  4739
  4740     COMPUTE ANGLEN EQUAL WK1 / I
  4741     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4742     IF WS-WORK-DIS-RATE = ZEROS
  4743        CONTINUE
  4744     ELSE
  4745        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4746        COMPUTE WK7 = (1 / I) *
  4747              (((WK4 ** M - 1) / (WK4 - 1)) -
  4748              ((WK4 ** M * SX - VX) /
  4749              (WK4 * (1 + I) - 1))) *
  4750              (CP-PREMIUM-RATE / 1000)
  4751        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4752        COMPUTE WK8 = WK7 * 100 / ANGLEN
  4753        COMPUTE CP-CALC-PREMIUM =
  4754           WK8 *  ((WK4 * ANGLEN) / 100)
  4755     END-IF
  4756
  4757     GO TO 99999-RETURN
  4758
  4759     .
  4760
  4761 12001-CHECK-CID-TX.
  4762     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4763        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  4764        (CP-EARN-AS-NET-PAY) AND
  4765        (WS-WORK-DIS-RATE > ZEROS) AND
  4766        (CP-STATE-STD-ABBRV = CP-STATE)
  4767        CONTINUE
  4768     ELSE
  4769        GO TO 12001-CHECK-CID-LEV-MN-NEW
  4770     END-IF
  4771* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  4772     COMPUTE K-I = 1 + (1 * I)
  4773     COMPUTE ANGLEN EQUAL WK1 / I
  4774     COMPUTE ANGLEM EQUAL WK2 / I
  4775     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4776     IF WS-WORK-DIS-RATE = ZEROS
  4777        CONTINUE
  4778     ELSE
  4779        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4780        COMPUTE WK7 = (K-I / I) *
  4781              (((WK4 ** M - 1) / (WK4 - 1)) -
  4782*             ((WK4 ** M * SX - VX) /
  4783              ((WK4 ** M * SX) - VX) /
  4784*             (WK4 * (1 + I) - 1))) *
  4785              (WK4 * (1 + I) - 1)) *
  4786              (CP-PREMIUM-RATE / 1000)
  4787        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4788        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  4789        COMPUTE CP-CALC-PREMIUM =
  4790           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  4791     END-IF
  4792
  4793     GO TO 99999-RETURN
  4794     .
  4795 12001-CHECK-CID-LEV-MN-NEW.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  87
* ELRATE.cbl
  4796*    IF (CP-COMPANY-ID EQUAL 'CID')
  4797*       AND (CP-STATE-STD-ABBRV = 'MN')
  4798*       AND (CP-EARN-AS-NET-PAY)
  4799*       AND (CP-LEVEL-LIFE)
  4800*       AND (CP-CERT-EFF-DT > X'A4FF')
  4801*       CONTINUE
  4802*    ELSE
  4803*       GO TO 12001-CHECK-CID-LEV-MN
  4804*    END-IF
  4805*
  4806*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  4807*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  4808*    MOVE '1'                    TO DC-OPTION-CODE
  4809*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  4810*
  4811*    IF DATE-CONVERSION-ERROR
  4812*       MOVE '2'                 TO CP-RETURN-CODE
  4813*       MOVE ZEROS               TO FACTOR
  4814*                                   CP-CALC-PREMIUM
  4815*       GO TO 99999-RETURN
  4816*    END-IF
  4817*
  4818*    COMPUTE I = CP-LOAN-APR / 100
  4819*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  4820*
  4821*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  4822*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  4823*      * 12 / 360 * D)
  4824*
  4825*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  4826*       * 12 / 360 * D
  4827*
  4828*    GO TO 99999-RETURN
  4829      .
  4830 12001-CHECK-CID-LEV-MN.
  4831
  4832     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4833        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4834        (CP-EARN-AS-NET-PAY) AND
  4835        (CP-LEVEL-LIFE) AND
  4836        (CP-STATE-STD-ABBRV = CP-STATE)
  4837        CONTINUE
  4838     ELSE
  4839        GO TO 12001-CHECK-CID-LEV-CA
  4840     END-IF
  4841
  4842     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  4843         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  4844         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  4845
  4846     GO TO 99999-RETURN
  4847
  4848      .
  4849 12001-CHECK-CID-LEV-CA.
  4850
  4851     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4852        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4853        (CP-EARN-AS-NET-PAY) AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  88
* ELRATE.cbl
  4854        (CP-LEVEL-LIFE) AND
  4855        (CP-STATE-STD-ABBRV = CP-STATE)
  4856        CONTINUE
  4857     ELSE
  4858        GO TO 12001-CHECK-CID-TRN-CA
  4859     END-IF
  4860
  4861     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  4862     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  4863     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  4864     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  4865     COMPUTE CP-CALC-PREMIUM =
  4866          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  4867          (CP-PREMIUM-RATE / 1000)) /
  4868          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  4869
  4870     GO TO 99999-RETURN
  4871
  4872      .
  4873 12001-CHECK-CID-TRN-CA.
  4874
  4875     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4876        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4877        (CP-EARN-AS-NET-PAY) AND
  4878        (CP-TRUNCATED-LIFE) AND
  4879        (CP-STATE-STD-ABBRV = CP-STATE) AND
  4880        (WS-DISCOUNT-OPTION NOT = ' ')
  4881        CONTINUE
  4882     ELSE
  4883        GO TO 12001-CHECK-CID-TRN-MT
  4884     END-IF
  4885
  4886     COMPUTE ANGLEN EQUAL WK1 / I
  4887     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4888     IF WS-WORK-DIS-RATE = ZEROS
  4889        CONTINUE
  4890     ELSE
  4891        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4892        COMPUTE WK7 = (1 / I) *
  4893              (((WK4 ** M - 1) / (WK4 - 1)) -
  4894              ((WK4 ** M * SX - VX) /
  4895              (WK4 * (1 + I) - 1))) *
  4896              (CP-PREMIUM-RATE / 1000)
  4897        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4898        COMPUTE CP-CALC-PREMIUM =
  4899           WK4 *  WK7
  4900     END-IF
  4901
  4902     GO TO 99999-RETURN
  4903
  4904      .
  4905 12001-CHECK-CID-TRN-MT.
  4906
  4907     IF (CP-COMPANY-ID EQUAL 'CID') AND
  4908        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  4909                   OR
  4910        ((CP-STATE-STD-ABBRV = 'IN') AND
  4911        (CP-CERT-EFF-DT > X'9A7F'))
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  89
* ELRATE.cbl
  4912                   OR
  4913        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4914        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4915        (CP-EARN-AS-NET-PAY) AND
  4916        (CP-TRUNCATED-LIFE) AND
  4917        (CP-STATE-STD-ABBRV = CP-STATE)
  4918        CONTINUE
  4919     ELSE
  4920        GO TO 12001-CHECK-CID-MT
  4921     END-IF
  4922
  4923* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4924     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4925        MOVE 0                   TO K-I
  4926     ELSE
  4927        MOVE 2                   TO K-I
  4928     END-IF
  4929     COMPUTE CP-TERM-OR-EXT-DAYS =
  4930           CP-TERM-OR-EXT-DAYS + 30
  4931
  4932     COMPUTE ANGLEN EQUAL WK1 / I
  4933     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4934     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4935                   / (1 + I)
  4936     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4937     IF WS-WORK-DIS-RATE = ZEROS
  4938        CONTINUE
  4939     ELSE
  4940        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4941*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4942        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4943              (((WK4 ** M - 1) / (WK4 - 1)) -
  4944              ((WK4 ** M * SX - VX) /
  4945              (WK4 * (1 + I) - 1))) *
  4946              (CP-PREMIUM-RATE / 1000)
  4947        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4948*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4949        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4950        COMPUTE CP-CALC-PREMIUM =
  4951           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4952*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4953     END-IF
  4954
  4955     GO TO 99999-RETURN
  4956
  4957     .
  4958 12001-CHECK-CID-MT.
  4959
  4960     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4961        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  4962                                OR 'VT')
  4963                   OR
  4964        ((CP-STATE-STD-ABBRV = 'IN') AND
  4965        (CP-CERT-EFF-DT > X'9A7F'))
  4966                   OR
  4967        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4968        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4969        (CP-EARN-AS-NET-PAY) AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  90
* ELRATE.cbl
  4970        (CP-STATE-STD-ABBRV = CP-STATE)
  4971        CONTINUE
  4972     ELSE
  4973        GO TO 12001-CHECK-DCC-DD
  4974     END-IF
  4975
  4976     COMPUTE CP-TERM-OR-EXT-DAYS =
  4977           CP-TERM-OR-EXT-DAYS + 30
  4978
  4979* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4980     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4981        MOVE 0                   TO K-I
  4982     ELSE
  4983        IF CP-STATE-STD-ABBRV = 'NJ'
  4984           MOVE 1                TO K-I
  4985        ELSE
  4986           MOVE 2                TO K-I
  4987        END-IF
  4988     END-IF
  4989     COMPUTE ANGLEN EQUAL WK1 / I
  4990     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4991     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4992                   / (1 + I)
  4993     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4994     IF WS-WORK-DIS-RATE = ZEROS
  4995        CONTINUE
  4996     ELSE
  4997        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4998*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4999        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5000              (((WK4 ** N - 1) / (WK4 - 1)) -
  5001              ((WK4 ** N - SV) /
  5002              (WK4 * (1 + I) - 1))) *
  5003              (CP-PREMIUM-RATE / 1000)
  5004        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5005*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5006        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5007        COMPUTE CP-CALC-PREMIUM =
  5008           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5009*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5010     END-IF
  5011
  5012     GO TO 99999-RETURN
  5013
  5014     .
  5015 12001-CHECK-DCC-DD.
  5016     IF (CP-COMPANY-ID EQUAL 'DCC')
  5017        AND (CP-EARN-AS-NET-PAY)
  5018        AND (CP-BEN-CATEGORY = 'D')
  5019        CONTINUE
  5020     ELSE
  5021        GO TO 12001-CHECK-DCC-NET
  5022     END-IF
  5023
  5024     COMPUTE CP-TERM-OR-EXT-DAYS =
  5025           CP-TERM-OR-EXT-DAYS + 30
  5026
  5027     COMPUTE ANGLEN EQUAL WK1 / I.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  91
* ELRATE.cbl
  5028     COMPUTE ANGLEM EQUAL WK2 / I.
  5029     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5030
  5031     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5032           / (1 + I)
  5033     COMPUTE GR     = ANGLEN / ODF
  5034*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  5035*      CP-RATE-DEV-PCT
  5036     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5037     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5038       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  5039     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5040     MOVE WK3                    TO CP-CALC-PREMIUM
  5041
  5042     GO TO 99999-RETURN
  5043
  5044     .
  5045 12001-CHECK-DCC-NET.
  5046
  5047     IF (CP-COMPANY-ID EQUAL 'DCC')
  5048        AND (CP-EARN-AS-NET-PAY)
  5049        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  5050             AND 'H' AND 'S')
  5051        CONTINUE
  5052     ELSE
  5053        GO TO 12001-CHECK-DCC-MNET
  5054     END-IF
  5055
  5056     COMPUTE CP-TERM-OR-EXT-DAYS =
  5057           CP-TERM-OR-EXT-DAYS + 30
  5058
  5059     COMPUTE ANGLEN EQUAL WK1 / I.
  5060     COMPUTE ANGLEM EQUAL WK2 / I.
  5061     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5062
  5063     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5064           / (1 + I)
  5065     COMPUTE GR     = ANGLEN / ODF
  5066     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  5067     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  5068       CP-RATE-DEV-PCT
  5069     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  5070*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  5071
  5072     COMPUTE WK8 = CP-PREMIUM-RATE *
  5073        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  5074     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  5075     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5076     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5077       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  5078     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5079     MOVE WK3                    TO CP-CALC-PREMIUM
  5080
  5081     GO TO 99999-RETURN
  5082
  5083     .
  5084 12001-CHECK-DCC-MNET.
  5085
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  92
* ELRATE.cbl
  5086     IF (CP-COMPANY-ID EQUAL 'DCC')
  5087        AND (CP-EARN-AS-NET-PAY)
  5088        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  5089        CONTINUE
  5090     ELSE
  5091        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  5092     END-IF
  5093
  5094*    COMPUTE ANGLEN EQUAL WK1 / I.
  5095*    COMPUTE ANGLEM EQUAL WK2 / I.
  5096*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  5097
  5098     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  5099     MOVE WK3                    TO CP-CALC-PREMIUM
  5100
  5101     GO TO 99999-RETURN
  5102
  5103     .
  5104 12001-CHECK-DCC-MNET-LF-BAL.
  5105
  5106     IF (CP-COMPANY-ID EQUAL 'DCC')
  5107        AND (CP-EARN-AS-NET-PAY)
  5108        AND (CP-BENEFIT-CD (1:1) = 'N')
  5109        AND (CP-BEN-CATEGORY NOT = 'N')
  5110        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5111        CONTINUE
  5112     ELSE
  5113        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  5114     END-IF
  5115
  5116     IF CP-RATE-DEV-PCT NOT = ZEROS
  5117        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5118           CP-PREMIUM-RATE
  5119     END-IF
  5120*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5121     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5122        / (1 + I)
  5123     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5124     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5125     COMPUTE WK2 = (1 + J) ** (M * -1)
  5126     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5127     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5128          ** ((M - 1) * -1))) / J)
  5129     COMPUTE ANGLEM = ((1 - ((1 + J)
  5130          ** (M * -1))) / J) / OD
  5131     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5132        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  5133        / ANGLEM-1
  5134     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5135          ** ((N - M) * -1))) / I)
  5136     MOVE +0                     TO WK3
  5137     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5138        (WS-COUNTER > M)
  5139        COMPUTE ANGLEM = (1 - ((1 + J)
  5140          ** ((M - WS-COUNTER) * -1))) / J
  5141        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5142        COMPUTE WK5-CSL = (RA * ANGLEM)
  5143        + (CP-ALTERNATE-BENEFIT * WK2)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  93
* ELRATE.cbl
  5144        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5145     END-PERFORM
  5146     MOVE WK3                    TO CP-CALC-PREMIUM
  5147
  5148     GO TO 99999-RETURN
  5149
  5150     .
  5151 12001-CHECK-DCC-MNET-LFSUM-BAL.
  5152
  5153     IF (CP-COMPANY-ID EQUAL 'DCC')
  5154        AND (CP-EARN-AS-NET-PAY)
  5155        AND (CP-BENEFIT-CD (1:1) = 'S')
  5156        AND (CP-BEN-CATEGORY NOT = 'N')
  5157        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5158        CONTINUE
  5159     ELSE
  5160        GO TO 12001-CHECK-DCC-MNET-LF
  5161     END-IF
  5162
  5163     IF CP-RATE-DEV-PCT NOT = ZEROS
  5164        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5165           CP-PREMIUM-RATE
  5166     END-IF
  5167     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5168     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5169          ** ((M - 1) * -1))) / K)
  5170     COMPUTE ANGLEM = ((1 - ((1 + K)
  5171          ** (M * -1))) / K)
  5172     MOVE CP-MONTHLY-PAYMENT     TO RA
  5173     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5174        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  5175        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5176        CP-PREMIUM-RATE / 1000
  5177     MOVE WK3                    TO CP-CALC-PREMIUM
  5178
  5179     GO TO 99999-RETURN
  5180
  5181     .
  5182 12001-CHECK-DCC-MNET-LF.
  5183
  5184     IF (CP-COMPANY-ID EQUAL 'DCC')
  5185        AND (CP-EARN-AS-NET-PAY)
  5186        AND (CP-BENEFIT-CD (1:1) = 'N')
  5187        AND (CP-BEN-CATEGORY NOT = 'N')
  5188        CONTINUE
  5189     ELSE
  5190        GO TO 12001-CHECK-DCC-MNET-SUMLF
  5191     END-IF
  5192
  5193     IF CP-RATE-DEV-PCT NOT = ZEROS
  5194        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5195           CP-PREMIUM-RATE
  5196     END-IF
  5197*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5198     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5199        / (1 + I)
  5200     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5201     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  94
* ELRATE.cbl
  5202     COMPUTE WK2 = (1 + J) ** (M * -1)
  5203     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5204     COMPUTE ANGLEM = ((1 - ((1 + J)
  5205          ** (M * -1))) / J) / OD
  5206     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5207     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5208          ** ((N - M) * -1))) / I)
  5209     MOVE +0                     TO WK3
  5210     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5211        (WS-COUNTER > M)
  5212        COMPUTE ANGLEM = (1 - ((1 + J)
  5213          ** ((M - WS-COUNTER + 1) * -1))) / J
  5214        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5215        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5216        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5217     END-PERFORM
  5218     MOVE WK3                    TO CP-CALC-PREMIUM
  5219
  5220     GO TO 99999-RETURN
  5221
  5222     .
  5223 12001-CHECK-DCC-MNET-SUMLF.
  5224
  5225     IF (CP-COMPANY-ID EQUAL 'DCC')
  5226        AND (CP-EARN-AS-NET-PAY)
  5227        AND (CP-BENEFIT-CD (1:1) = 'S')
  5228        AND (CP-BEN-CATEGORY NOT = 'N')
  5229        CONTINUE
  5230     ELSE
  5231        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  5232     END-IF
  5233
  5234     IF CP-RATE-DEV-PCT NOT = ZEROS
  5235        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5236           CP-PREMIUM-RATE
  5237     END-IF
  5238     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5239     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5240        / (1 + K)
  5241     COMPUTE ANGLEN-M = (WK5 / I)
  5242     COMPUTE WK2 = (1 + K) ** (M * -1)
  5243     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5244     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5245     COMPUTE ANGLEM = ((1 - ((1 + K)
  5246          ** (M * -1))) / K) / Y
  5247     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5248     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  5249        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5250        - 1)) / K) * RA
  5251     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5252        + (CP-DAYS-TO-1ST-PMT - +30)
  5253        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5254        +0 / 1000 * 12 / 12)
  5255     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  5256        * (12 / 12)
  5257     MOVE WK3                    TO CP-CALC-PREMIUM
  5258
  5259     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  95
* ELRATE.cbl
  5260
  5261     .
  5262 12001-CHECK-DCC-MNET-TOT-BAL-N.
  5263
  5264     IF (CP-COMPANY-ID EQUAL 'DCC')
  5265        AND (CP-EARN-AS-NET-PAY)
  5266        AND (CP-BENEFIT-CD (1:1) = 'N')
  5267        AND (CP-BEN-CATEGORY = 'N')
  5268        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5269        CONTINUE
  5270     ELSE
  5271        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  5272     END-IF
  5273
  5274*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5275     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5276        / (1 + I)
  5277     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5278     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  5279     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5280     COMPUTE WK2 = (1 + J) ** (M * -1)
  5281     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5282     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5283          ** ((M - 1) * -1))) / J)
  5284     COMPUTE ANGLEM = ((1 - ((1 + J)
  5285          ** (M * -1))) / J) / OD
  5286     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5287        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  5288        / ANGLEM-1
  5289     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5290          ** ((N - M) * -1))) / I)
  5291     MOVE +0                     TO WK3
  5292     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5293        (WS-COUNTER > M)
  5294        COMPUTE ANGLEM = (1 - ((1 + J)
  5295          ** ((M - WS-COUNTER) * -1))) / J
  5296        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  5297        COMPUTE WK5-CSL = (RA * ANGLEM)
  5298        + (CP-ALTERNATE-BENEFIT * WK2)
  5299        COMPUTE WK3 = WK3 +
  5300         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  5301        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  5302          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  5303          (CP-DCC-AH-RATE / 1000)
  5304     END-PERFORM
  5305     MOVE WK3                    TO CP-CALC-PREMIUM
  5306
  5307     GO TO 99999-RETURN
  5308
  5309     .
  5310 12001-CHECK-DCC-MNET-TOT-BAL-S.
  5311
  5312     IF (CP-COMPANY-ID EQUAL 'DCC')
  5313        AND (CP-EARN-AS-NET-PAY)
  5314        AND (CP-BENEFIT-CD (1:1) = 'S')
  5315        AND (CP-BEN-CATEGORY = 'N')
  5316        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5317        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  96
* ELRATE.cbl
  5318     ELSE
  5319        GO TO 12001-CHECK-DCC-MNET-TOT-N
  5320     END-IF
  5321
  5322     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5323     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5324          ** ((M - 1) * -1))) / K)
  5325     COMPUTE ANGLEM = ((1 - ((1 + K)
  5326          ** (M * -1))) / K)
  5327     MOVE CP-MONTHLY-PAYMENT     TO RA
  5328     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5329        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  5330        * CP-DCC-AH-RATE / 1000))
  5331        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5332        CP-DCC-LF-RATE / 1000
  5333     MOVE WK3                    TO CP-LF-PREM
  5334     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  5335        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  5336        * CP-DCC-AH-RATE / 1000
  5337     COMPUTE WK3 = WK3 + WK5-CSL
  5338     MOVE WK3                    TO CP-CALC-PREMIUM
  5339
  5340     GO TO 99999-RETURN
  5341      .
  5342 12001-CHECK-DCC-MNET-TOT-N.
  5343
  5344     IF (CP-COMPANY-ID EQUAL 'DCC')
  5345        AND (CP-EARN-AS-NET-PAY)
  5346        AND (CP-BENEFIT-CD (1:1) = 'N')
  5347        AND (CP-BEN-CATEGORY = 'N')
  5348        CONTINUE
  5349     ELSE
  5350        GO TO 12001-CHECK-DCC-MNET-TOT-S
  5351     END-IF
  5352
  5353*    I = APR/1200
  5354*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  5355*    RA = PAYMENT AMOUNT
  5356*    WK5-CSL = THE BALANCE (PAY OFF )
  5357*    WK3 = THE ACCUMULATED PREMIUM
  5358*    WK2 = (1 + I) ^ (m * -1)
  5359*    OD  = GAMMA
  5360*
  5361*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5362     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5363        / (1 + I)
  5364     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5365     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  5366        (CP-DCC-AH-RATE / +1000)
  5367     COMPUTE WK2 = (1 + J) ** (M * -1)
  5368     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5369     COMPUTE ANGLEM = ((1 - ((1 + J)
  5370          ** (M * -1))) / J) / OD
  5371     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5372     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5373          ** ((N - M) * -1))) / I)
  5374     MOVE +0                     TO WK3
  5375     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  97
* ELRATE.cbl
  5376        (WS-COUNTER > M)
  5377        COMPUTE ANGLEM = (1 - ((1 + J)
  5378          ** ((M - WS-COUNTER + 1) * -1))) / J
  5379        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5380        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5381        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  5382           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  5383     END-PERFORM
  5384     MOVE WK3                    TO CP-CALC-PREMIUM
  5385
  5386     GO TO 99999-RETURN
  5387
  5388     .
  5389 12001-CHECK-DCC-MNET-TOT-S.
  5390
  5391     IF (CP-COMPANY-ID EQUAL 'DCC')
  5392        AND (CP-EARN-AS-NET-PAY)
  5393        AND (CP-BENEFIT-CD (1:1) = 'S')
  5394        AND (CP-BEN-CATEGORY = 'N')
  5395        CONTINUE
  5396     ELSE
  5397        GO TO 12001-CONTINUE-NET
  5398     END-IF
  5399
  5400*    I = APR/1200
  5401*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  5402*    RA = PAYMENT AMOUNT
  5403*    WK5-CSL = THE BALANCE (PAY OFF )
  5404*    WK3 = THE ACCUMULATED PREMIUM
  5405*    WK2 = (1 + I) ^ (m * -1)
  5406*    OD  = GAMMA
  5407*
  5408     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  5409     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  5410        / (1 + J)
  5411     COMPUTE ANGLEM = ((1 - ((1 + J)
  5412          ** (M * -1))) / J) / OD
  5413     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5414          ** ((N - M) * -1))) / I)
  5415          * (1 + J) ** (-1 * M)
  5416     COMPUTE ANGLEN-M = ANGLEN-M / OD
  5417     MOVE CP-MONTHLY-PAYMENT     TO RA
  5418     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  5419        / +30)
  5420     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  5421        ** (WK1) - 1)) / J) * RA
  5422     COMPUTE WK5 = (((((M * (M + 1) / 2)
  5423        + (CP-DAYS-TO-1ST-PMT - +30)
  5424        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  5425        CP-DCC-AH-RATE / +1000 * 12 / 12)
  5426     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  5427        (12 / 12)
  5428     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  5429        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  5430        (CP-DCC-AH-RATE / +1000) * 12 / 12
  5431     COMPUTE WK3 = WK3 + WK5-CSL
  5432     MOVE WK3                    TO CP-CALC-PREMIUM
  5433     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  98
* ELRATE.cbl
  5434     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5435        / (1 + K)
  5436     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5437          ** ((N - M) * -1))) / I)
  5438     COMPUTE WK2 = (1 + K) ** (M * -1)
  5439     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5440     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5441     COMPUTE ANGLEM = ((1 - ((1 + K)
  5442          ** (M * -1))) / K) / Y
  5443*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5444     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  5445        ((1 + K) ** (M + 1 / Y
  5446        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5447        - 1)) / K) * RA
  5448     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5449        + (CP-DAYS-TO-1ST-PMT - +30)
  5450        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5451        CP-DCC-AH-RATE / 1000 * 12 / 12)
  5452     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  5453        * (12 / 12)
  5454     MOVE WK3                    TO CP-LF-PREM
  5455
  5456     GO TO 99999-RETURN
  5457
  5458     .
  5459 12001-CONTINUE-NET.
  5460
  5461     IF NET-STD
  5462        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  5463*          OR 'DCC'
  5464         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5465         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5466         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5467         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  5468                               * ((1 + N) / (1 + M))
  5469        ELSE
  5470         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5471         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5472         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5473         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  5474
  5475     IF NET-SMP
  5476         COMPUTE N2 = N * N
  5477         COMPUTE N3 = N2 * N
  5478         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  5479         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  5480         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  5481         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  5482         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  5483
  5484     IF NPO-PRUDENTIAL
  5485       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  5486           VARYING WS-COUNTER FROM 1 BY 1
  5487               UNTIL WS-COUNTER = N
  5488       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  5489       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  5490
  5491     MOVE WK3 TO FACTOR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  99
* ELRATE.cbl
  5492
  5493     GO TO 99999-RETURN.
  5494
  5495 12100-PRU-CALC.
  5496     IF WS-COUNTER = 1
  5497         COMPUTE PWK = (I + 1)
  5498     ELSE
  5499         COMPUTE PWK = PWK * (I + 1).
  5500
  5501 12199-EXIT.
  5502      EXIT.
  5503
  5504 99000-ERROR.
  5505     MOVE +9999.999999999 TO N-P-FACTOR.
  5506     MOVE '4'             TO CP-RETURN-CODE.
  5507
  5508     GO TO 99999-EXIT.
  5509
  5510 99999-RETURN.
  5511     MOVE FACTOR          TO N-P-FACTOR.
  5512
  5513 99999-EXIT.
  5514      EXIT.
  5515 99999-DUMMY-STOP-RUN.
  5516
  5517* GOBACK.
  5518     MOVE '9%                    "   ' TO DFHEIV0
  5519     MOVE 'ELRATE' TO DFHEIV1
  5520     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5521     GOBACK.
  5522
  5523
  5524 9999-DFHBACK SECTION.
  5525     MOVE '9%                    "   ' TO DFHEIV0
  5526     MOVE 'ELRATE' TO DFHEIV1
  5527     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5528     GOBACK.
  5529 9999-DFHEXIT.
  5530     IF DFHEIGDJ EQUAL 0001
  5531         NEXT SENTENCE
  5532     ELSE IF DFHEIGDJ EQUAL 2
  5533         GO TO 9999-RATE-NOTFND,
  5534               9999-RATE-NOTOPEN,
  5535               9999-RATE-NOTFND
  5536         DEPENDING ON DFHEIGDI.
  5537     MOVE '9%                    "   ' TO DFHEIV0
  5538     MOVE 'ELRATE' TO DFHEIV1
  5539     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5540     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        2548     Code:       47950
